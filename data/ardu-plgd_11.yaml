- en: '**10'
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**10'
- en: THE CHROMATIC THERMOMETER**
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '**色度温度计**'
- en: '![image](../images/common-01.jpg)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/common-01.jpg)'
- en: This project was initially created to provide a quick visual indication of local
    temperature. At its simplest, it is a thermometer that displays the temperature
    by turning on a sequence of LEDs of different colors. During development, however,
    the project gained more features, including an LCD readout to supplement the basic
    color readout. And while experimenting, I came across an IC that provides extremely
    accurate measurement without special calibration, which improved the device greatly.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 这个项目最初是为了提供一个快速的本地温度视觉指示。最简单的形式，它是一个通过依次点亮不同颜色的LED来显示温度的温度计。然而，在开发过程中，项目增加了更多的功能，包括一个LCD显示屏来补充基本的颜色显示。在实验过程中，我遇到了一个IC，它提供了极为准确的测量而无需特殊校准，从而大大提高了设备的性能。
- en: The Chromatic Thermometer includes 10 different colored LEDs, each of which
    lights up when the sensor detects a particular temperature. The original version
    was designed to measure from 68 to 78°F, and each LED represented a 1-degree Fahrenheit
    change in temperature. I subsequently varied that for different applications.
    The finished project shown in [Figure 10-1](ch10.xhtml#ch10fig10-1) can measure
    a wide range of temperatures. It also includes a waterproof probe for measuring
    the temperature in liquids, which is useful for fish tanks, swimming pools, and
    so forth, and can be constructed in a variety of physical configurations. In the
    version that appears in the sketch, the temperature ranges from 76 to 86°F in
    1-degree increments.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 色度温度计包括10个不同颜色的LED，当传感器检测到特定温度时，每个LED都会亮起。原始版本设计用于测量68到78°F的温度，每个LED表示1°F的温度变化。后来，我根据不同的应用对其进行了调整。完成的项目如[图10-1](ch10.xhtml#ch10fig10-1)所示，可以测量广泛的温度范围。它还包括一个防水探头，用于测量液体中的温度，这对于鱼缸、游泳池等非常有用，并且可以构建成各种物理配置。在草图中显示的版本，温度范围从76到86°F，温度变化为1°F的增量。
- en: '![image](../images/fig10_1.jpg)'
  id: totrans-5
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/fig10_1.jpg)'
- en: '*Figure 10-1: The finished Chromatic Thermometer*'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '*图10-1：完成的色度温度计*'
- en: You could also program an alarm by flashing a lamp at a specific temperature,
    or with a minor hardware addition, you could add an audible alarm. I am sure you
    can think of even more hardware or software modifications to make this thermometer
    a very practical device.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以通过在特定温度下闪烁灯光来编程设置警报，或者通过增加一些硬件，你可以加一个可听警报。我相信你能想出更多的硬件或软件修改，使这个温度计成为一个非常实用的设备。
- en: '**Choosing a Temperature Sensor**'
  id: totrans-8
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**选择温度传感器**'
- en: The key ingredient in any electronic thermometer is the temperature sensor.
    There are many kinds of temperature sensors available to choose from.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 任何电子温度计的关键成分是温度传感器。市面上有许多种温度传感器可供选择。
- en: '*Thermistors* change resistance with temperature and range from inexpensive
    to very pricey, depending on how they are made and tested. *Resistance temperature
    detectors (RTDs)* employ a coil of pure wire, such as silver, platinum, or copper,
    wrapped around a glass core. Combined in a resistance bridge, RTDs can be extremely
    accurate, but they’re somewhat expensive. *Thermocouples* are still an industry-standard
    sensing technology, particularly at higher temperatures (that is, greater than
    500°C). At lower temperatures, thermocouples are being replaced by RTDs because
    of accuracy, precision, consistency, and linearity.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '*热敏电阻*随着温度的变化而改变电阻，其价格范围从便宜到非常昂贵，具体取决于它们的制造和测试方式。*电阻温度探测器 (RTDs)*使用纯金属线圈，如银、铂或铜，绕在玻璃核心周围。将RTD组合在一个电阻桥中，可以达到非常高的精度，但它们的价格相对较贵。*热电偶*仍然是行业标准的传感技术，特别是在高温下（即超过500°C）。在较低温度下，由于准确性、精度、一致性和线性，热电偶正被RTD所取代。'
- en: '*Semiconductor temperature sensors*—that is, dedicated integrated silicon sensor
    circuits—continue to gain popularity because of their accuracy, precision, ruggedness,
    and convenience. In preparing for this project, I looked at virtually all the
    approaches and elected to use a semiconductor sensor, as it provided sufficient
    accuracy with a relatively simple hookup and a modest price.'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '*半导体温度传感器*——即专用的集成硅传感器电路——因其精度、可靠性、坚固性和便利性而持续受到欢迎。在准备这个项目时，我几乎看遍了所有的方案，并选择使用了半导体传感器，因为它提供了足够的准确性，同时连接简单，价格也适中。'
- en: With any thermometer, *accuracy* and *precision* are issues. Consider accuracy
    the ability to measure temperature as close to some standard value established
    by the NIST, with some deviation. For this casual definition, precision can be
    referred to as *repeatability*—that is, the ability to read the same temperature
    consistently in the same environment.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 对于任何温度计，*精度*和*分辨率*都是问题。可以将精度视为测量温度的能力，其接近由NIST（美国国家标准技术研究院）建立的某个标准值，带有一些偏差。对于这个简化的定义，分辨率可以称为*重复性*——即在相同环境下，能够稳定地读取相同的温度。
- en: The Custom pH Meter in [Chapter 7](ch07.xhtml#ch07) used the temperature of
    boiling water and ice in solution to set boundaries of 100°C and 0°C, respectively,
    to calibrate a thermometer. I checked the Chromatic Thermometer with the same
    approach, but I used the high-accuracy MCP9808 module described here as a standard
    because it was extremely close.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '[第7章](ch07.xhtml#ch07)中的自定义pH计使用了沸水和冰水溶液的温度，分别设定了100°C和0°C的边界，以校准温度计。我使用相同的方法检查了色差温度计，但我使用了这里描述的高精度MCP9808模块作为标准，因为它非常接近。'
- en: Accuracy and precision are ultimately a system—not necessarily a sensor—issue.
    This project discusses two different sensors with essentially the same accuracy
    and precision. The simplest sensor, an LM35 analog temperature sensor, depends
    on other parts of the system for its accuracy and precision. The second sensor,
    an MCP9808 IC, provides accurate results with or without the associated breakout
    board because it includes the other variable components as an on-chip subsystem.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 精度和分辨率最终是一个系统问题——并不一定是传感器的问题。这个项目讨论了两种具有基本相同精度和分辨率的不同传感器。最简单的传感器，LM35模拟温度传感器，依赖于系统的其他部分来保证其精度和分辨率。第二种传感器，MCP9808芯片，无论是否使用附带的分离板，都能提供精确的结果，因为它将其他可变组件集成到了芯片内部的子系统中。
- en: Both the LM35 and the MCP9808 boast a maximum accuracy of 0.25°C and a precision
    of 0.0625°C. To achieve this kind of accuracy, they use a *silicon band-gap temperature
    sensor*, which takes advantage of the forward voltage of a silicon diode. However,
    in addition to the sensor, the MCP9808 includes its own on-chip ADC, voltage reference,
    and other internal circuitry to assure accuracy.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: LM35和MCP9808都具有0.25°C的最大精度和0.0625°C的分辨率。为了实现这种精度，它们使用*硅带隙温度传感器*，该传感器利用了硅二极管的正向电压。然而，除了传感器外，MCP9808还包括其自带的芯片内ADC、电压参考和其他内部电路，以确保精度。
- en: '**NOTE**'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*If you want to dig deeper on the band-gap sensor technology, there is a wealth
    of information on the web, including background on Bob Widler, who is largely
    credited with discovering the phenomenon*.'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '*如果你想深入了解带隙传感器技术，网上有大量相关信息，包括Bob Widler的背景资料，他通常被认为是发现这一现象的关键人物*。'
- en: In this project, the LM35 depends on the ADC and voltage reference of the Arduino,
    which, while pretty good, does not match that of the MCP9808’s monolithic system
    and thus can require calibration, as illustrated in “[Sketch for the LM35 System](ch10.xhtml#ch10lev2sec1)”
    on [page 289](ch10.xhtml#page_289). When I built a version with the MCP9808 instead,
    I used an Adafruit breakout board for the chip because it significantly simplified
    assembly—no need to fuss with the MicroSMT package’s tiny leads.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个项目中，LM35依赖于Arduino的ADC和电压参考，虽然其性能相当不错，但与MCP9808的单片系统不匹配，因此可能需要进行校准，正如在[《LM35系统示例》](ch10.xhtml#ch10lev2sec1)中所展示的，[第289页](ch10.xhtml#page_289)中提到的。当我使用MCP9808构建一个版本时，我使用了Adafruit的芯片分离板，因为它极大简化了组装——无需为MicroSMT封装的小引脚而烦恼。
- en: While the MCP9808 does cost more than the LM35D, it’s worked out well. I included
    traces in the project’s PCB shield for the chip itself, if you elect to solder
    it using one of the techniques suggested in “[Using SOICs](ch00.xhtml#ch00lev1sec7)”
    on [page 20](ch00.xhtml#page_20).
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然MCP9808的价格高于LM35D，但它的表现相当好。我在项目的PCB护盾板中包括了用于该芯片的引线，如果你选择使用[《使用SOIC封装》](ch00.xhtml#ch00lev1sec7)中建议的某种技术来焊接它，[第20页](ch00.xhtml#page_20)提供了详细说明。
- en: '**Required Tools**'
  id: totrans-20
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**所需工具**'
- en: Soldering iron and solder (Optional) Electric drill with bits for 1/4 inches
    (used to drill a hole for the jack in order to connect a remote temperature sensor
    or to make a hole for a power adapter)
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 焊接铁和焊锡（可选）电钻和1/4英寸钻头（用于钻孔以连接远程温度传感器或为电源适配器打孔）
- en: '**Parts List**'
  id: totrans-22
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**零件清单**'
- en: 'First, decide which temperature sensor you want to use: the LM35 or the MCP9808\.
    If you just want to use an LM35, here’s what you’ll need to make a basic Chromatic
    Thermometer:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，决定你想使用哪种温度传感器：LM35还是MCP9808。如果你只想使用LM35，这里是制作基本色差温度计所需的配件：
- en: One Arduino Nano or clone
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 一块Arduino Nano或其克隆版
- en: One LM35 temperature sensor
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 一个LM35温度传感器
- en: 'Ten different colored LEDs (see “[Mod: Try Different LEDs](ch10.xhtml#ch10sd1)”
    on [page 300](ch10.xhtml#page_300))'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 十个不同颜色的LED（见“[模块：尝试不同的LED](ch10.xhtml#ch10sd1)”在[第300页](ch10.xhtml#page_300)）
- en: Ten ZTX649 transistors Ten 470-ohm resistors
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 十个ZTX649晶体管，十个470欧电阻
- en: One 7.5 to 9V wall adapter, or equivalent (or 9V battery)
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 一个7.5至9V的墙壁适配器，或等效的（或9V电池）
- en: One plastic enclosure (see “[Construction](ch01.xhtml#ch01lev1sec9)” on [page
    298](ch10.xhtml#page_298)) 28- or 30-gauge hookup wire
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 一个塑料外壳（见“[构建](ch01.xhtml#ch01lev1sec9)”在[第298页](ch10.xhtml#page_298)），28或30号的连接线
- en: One printed circuit board (Use the provided shield template, design your own
    shield, or use any other prototyping board you feel comfortable working with.)
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 一块印刷电路板（使用提供的保护板模板，设计自己的保护板，或者使用任何你熟悉的原型板。）
- en: 'I also describe several variations on the Chromatic Thermometer in this chapter.
    Give the project a skim before you go shopping, and if you want to make one of
    the variations, also buy the following:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我还描述了几种色度温度计的变体。购物之前可以先快速浏览一下项目，如果你想制作其中一种变体，也需要购买以下物品：
- en: 'If you plan to use the temperature sensor as described in “Design Decision:
    Remote the Temperature Sensor,” get one 3.5 mm stereo jack. For a Chromatic Thermometer
    with a digital readout, also buy one 16×2 I²C LCD.'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你计划按照“设计决策：远程温度传感器”中描述的方式使用温度传感器，购买一个3.5mm立体声插孔。如果你的色度温度计需要数字显示屏，还需要购买一个16×2
    I²C LCD。
- en: For a high-accuracy Chromatic Thermometer, replace the LM35 with either one
    MCP9808 Adafruit Breakout Board or one Microchip MCP9808 IC with a 100 nF capacitor
    and two 10-kilohm resistors.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 对于高精度色度温度计，将LM35替换为一个MCP9808 Adafruit Breakout板，或一个带100nF电容和两个10千欧电阻的Microchip
    MCP9808芯片。
- en: For the breadboard prototype, make sure you have one large breadboard (as opposed
    to the smaller ones used in much of this book) and at least 30 jumper wires.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 对于面包板原型，请确保你有一块大型面包板（与本书中使用的大部分小型面包板不同）和至少30根跳线。
- en: '**DESIGN DECISION: REMOTE THE TEMPER ATURE SENSOR**'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '**设计决策：远程温度传感器**'
- en: If your application takes you in another direction, you can modify the shield
    to *remote the chip*. That is, you can connect long wires directly to the chip
    (you’d need only four wires) and place the chip in a location separate from the
    readout. If you remote the chip, just include a small capacitor (around 100 nF)
    between pins 4 and 8, very close to the chip, as shown in [Figure 10-2](ch10.xhtml#ch10fig10-2).
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的应用需要走不同的方向，可以修改保护板以*远程连接芯片*。也就是说，你可以直接将长电线连接到芯片（只需要四根电线），并将芯片放置在与显示屏分开的地方。如果你远程连接芯片，只需在芯片附近的引脚4和8之间添加一个小电容（约100nF），如[图10-2](ch10.xhtml#ch10fig10-2)所示。
- en: '![image](../images/fig10_2.jpg)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/fig10_2.jpg)'
- en: '*Figure 10-2: The MCP9808 with wires soldered directly*'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '*图10-2：MCP9808与直接焊接的电线*'
- en: However, remember that I²C stands for *inter-integrated circuit* and is intended
    for chip-to-chip communications. Therefore, the MCP9808 can be moved only a limited
    distance from the Arduino. While some hobbyists online claim success with wires
    as long as 100 cm, the longest that I have been able to do reliably is about 50
    cm. The LM35, on the other hand, can be remoted and made waterproof for longer
    distances with only three wires and without needing miniature hands and the dexterity
    of a watchmaker. (If you can tolerate only two wires, there’s a solution to that;
    check the data sheet for the LM35.)
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，请记住，I²C代表*集成电路间通信*，用于芯片间通信。因此，MCP9808只能与Arduino保持有限的距离。虽然一些在线爱好者声称成功使用长达100cm的电缆，但我能够稳定使用的最长距离约为50cm。另一方面，LM35可以通过三根电线实现远程连接并且可防水，适用于更长的距离，而不需要微型工具和像钟表匠那样的灵活手指。（如果你只能容忍两根电线，可以参考LM35的数据表，它有解决方案。）
- en: The MCP9808 could likely be encapsulated as I did with the LM35 in the Custom
    pH Meter from [Chapter 7](ch07.xhtml#ch07), though I have not tried that. Trying
    to insulate the connections from each other and keep the delicate pins of the
    chip from breaking off can be a problem when making a remote sensor with the MCP9808.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: MCP9808可能像我在[第7章](ch07.xhtml#ch07)中的定制pH计中用LM35那样进行封装，尽管我没有尝试过。制作远程传感器时，尝试将连接点隔离开，并保持芯片的精密引脚不被折断，可能会成为使用MCP9808时的一个问题。
- en: This is a design decision to make before you build the final Chromatic Thermometer,
    so I suggest reading through the full chapter to decide before you put the device
    together.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 这是在制作最终色度温度计之前需要做出的设计决策，因此我建议你在组装设备之前，通读本章以便做出决定。
- en: '**Downloads**'
  id: totrans-42
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**下载**'
- en: '**Sketch for the LM35 version** *LM35Thermo.ino*'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '**LM35 版本的代码** *LM35Thermo.ino*'
- en: '**Sketch for the MCP9808 version** *9808Thermo.ino*'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '**MCP9808 版本的代码** *9808Thermo.ino*'
- en: '***Adafruit_MCP9808*** **library** *[https://www.adafruit.com/product/1782](https://www.adafruit.com/product/1782)*(for
    the MCP9808 temperature sensor only)'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '***Adafruit_MCP9808*** **库** *[https://www.adafruit.com/product/1782](https://www.adafruit.com/product/1782)*（仅适用于
    MCP9808 温度传感器）'
- en: '**PCB pattern for the shield** *Thermo.pcb*'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '**电路板模式（用于扩展板）** *Thermo.pcb*'
- en: '**How the Chromatic Thermometer Works**'
  id: totrans-47
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**Chromatic Thermometer（彩色温度计）的工作原理**'
- en: In operation, the Chromatic Thermometer is quite straightforward. For starters,
    let’s look at the basic configuration using the LM35 sensor.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在实际操作中，Chromatic Thermometer（彩色温度计）相当简单。首先，我们来看看使用 LM35 传感器的基本配置。
- en: The sensor generates a voltage of 10mV/°C. For example, at 28°C (around 82°F),
    the chip outputs 0.280V. You can easily check that with your multimeter. To make
    a usable Arduino thermometer, all you have to do is change that voltage to something
    the Arduino can understand and then have the Arduino translate it to something
    you want to see on the LEDs or LCD.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 该传感器产生的电压为 10mV/°C。例如，在 28°C（约 82°F）时，芯片输出 0.280V。你可以用万用表轻松检查这个值。要制作一个可用的 Arduino
    温度计，你所要做的就是将这个电压转换为 Arduino 能理解的值，然后让 Arduino 将其转换为你希望在 LED 或 LCD 上显示的内容。
- en: The first step is to convert the analog voltage to a digital value so the Arduino
    can work with it. To do that, connect the output of the sensor to one of the Nano’s
    analog inputs. (I tend to use A0, but any analog input can be used. Just don’t
    use analog pins A4 or A5, which are used for the I²C portion of this project.)
    The output voltage of the LM35 is pretty low compared with the 5V the Nano is
    working with, and the ADC divides the 5V of the supply into 1,024 parts (range
    = 0 to 1,023) to determine the analog value of an incoming voltage. If you use
    the LM35 output as is, each degree Celsius change in temperature will change the
    output voltage by 0.010V and therefore change the result of the ADC by 2.046 parts
    (units) out of the 1,024 total.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 第一步是将模拟电压转换为数字值，以便 Arduino 能处理。为此，将传感器的输出连接到 Nano 的一个模拟输入端口。（我通常使用 A0，但任何模拟输入都可以使用。只要不要使用
    A4 或 A5，因为这两个端口用于本项目的 I²C 部分。）与 Nano 使用的 5V 电压相比，LM35 的输出电压相对较低，ADC 将 5V 电压分为
    1,024 部分（范围 = 0 到 1,023）来确定输入电压的模拟值。如果直接使用 LM35 的输出，每变化 1 摄氏度，输出电压就会变化 0.010V，从而使
    ADC 的结果在 1,024 总单位中变化 2.046 个单位。
- en: That works, but small increments of the ADC at the very low end of the reference
    voltage are subject to random amounts of error. There is also significant error
    from rounding, as the Nano’s ADC outputs only whole digits.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 这样工作正常，但参考电压非常低端时 ADC 的小增量容易受到随机误差的影响。由于 Nano 的 ADC 只输出整数，因此也会有显著的四舍五入误差。
- en: To reduce the impact of error, you’ll change the reference voltage of the ADC
    from 5V, where each increment in the 1,024 represents 0.004882V, to 1.1V, where
    each increment represents only 0.00107V. A single degree Celsius change will then
    represent only 9.345 of the 1,024 units. Thus, the 0.280V the LM35 outputs at
    28°C will correspond to about 261 of the 1,024 units, rather than only 52.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 为了减少误差的影响，你将把 ADC 的参考电压从 5V 更改为 1.1V，其中 1,024 个增量的每一个在 5V 时表示 0.004882V，而在 1.1V
    时每个增量仅表示 0.00107V。这样，温度每变化 1 摄氏度，只会对应 1,024 单位中的 9.345 个增量。因此，LM35 在 28°C 时输出的
    0.280V 将对应大约 261 个单位，而不是 52 个。
- en: '**The Schematic**'
  id: totrans-53
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**原理图**'
- en: '[Figure 10-3](ch10.xhtml#ch10fig10-3) shows the schematic for this project.'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 10-3](ch10.xhtml#ch10fig10-3) 显示了该项目的原理图。'
- en: '![image](../images/fig10_3.jpg)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/fig10_3.jpg)'
- en: '*Figure 10-3: Schematic for the Chromatic Thermometer*'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 10-3：彩色温度计的原理图*'
- en: Note that both the LM35 and the MCP9808 sensors are wired up in this sketch.
    That is not a problem, as you can select which one to use in software by changing
    the code that you upload to the Arduino. You can wire up either one or both. This
    schematic also shows the Chromatic Thermometer with an LCD, though that is optional
    if you just want to read the temperature based on the LEDs.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，在这个代码中，LM35 和 MCP9808 两个传感器都已经连接。这并不成问题，因为你可以通过修改上传到 Arduino 的代码，在软件中选择使用哪个传感器。你可以连接其中一个或两个传感器。该原理图还显示了带有
    LCD 的彩色温度计，但如果你只想根据 LED 读取温度，这部分是可选的。
- en: The Arduino processor could probably drive the LEDs unaided, but I elected to
    use transistor drivers for each LED. This assures that if you elect to use higher-output
    LEDs—or even incandescent lamps—there will be no problem driving them. The transistors
    used are capable of sinking as much as 1 A.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: Arduino处理器可能能够单独驱动LED，但我选择为每个LED使用晶体管驱动器。这可以确保如果你选择使用更高输出的LED，甚至白炽灯泡时，也不会有驱动问题。所使用的晶体管能够承受最高1A的电流。
- en: An 11th LED-transistor-resistor group (Q11) is shown connected to pin D12 on
    the Nano, though the final Chromatic Thermometer uses only 10 LEDs. I show this
    extra pair and even include it in the shield PCB file to give you a built-in customization
    option. You can add another temperature digit, a buzzer alarm, or any other output
    you like.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 一个第11个LED-晶体管-电阻组（Q11）被连接到Nano的D12引脚，尽管最终的色温计仅使用10个LED。我展示了这个额外的配对，甚至将其包含在了屏蔽PCB文件中，给你一个内置的自定义选项。你可以添加另一个温度数字、蜂鸣器报警或任何其他输出设备。
- en: '**The Breadboard**'
  id: totrans-60
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**面包板**'
- en: As in the other projects in this book, I suggest starting with a breadboard
    to sound out the design and exercise the sketch before committing to the final
    assembly. Because the project uses 10 LEDs and 10 driver transistors, I used a
    large-format breadboard to comfortably fit all the components (see [Figure 10-4](ch10.xhtml#ch10fig10-4)).
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 和本书中的其他项目一样，我建议先使用面包板来测试设计并运行草图，然后再进行最终的组装。因为该项目使用了10个LED和10个驱动晶体管，所以我使用了一个大尺寸面包板，以便能舒适地放置所有组件（见[图10-4](ch10.xhtml#ch10fig10-4)）。
- en: '![image](../images/fig10_4.jpg)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/fig10_4.jpg)'
- en: '*Figure 10-4: The Chromatic Thermometer’s completed breadboard*'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '*图10-4：完成的色温计面包板*'
- en: The LEDs are along the middle of the breadboard, and one is shown lit. I assembled
    a wire harness for the LCD. The LM35 temperature sensor (left) is on a tether
    and held in heat shrink tubing so it is waterproof.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: LED位于面包板的中间，其中一个LED亮起。为了LCD，我组装了一条线束。LM35温度传感器（左）通过绳索连接，并被热缩管固定，这样它就防水了。
- en: 'These are the steps I used to assemble the breadboard:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是我用来组装面包板的步骤：
- en: Place the Arduino Nano toward the top left of the breadboard.
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Arduino Nano放置在面包板的左上角。
- en: Connect VIN (pin 30) of the Nano to where the 9V input from the battery or other
    power source will go.
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Nano的VIN（引脚30）连接到来自电池或其他电源的9V输入位置。
- en: Connect the 5V pin of the Nano to the red positive rail.
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Nano的5V引脚连接到红色正极轨道。
- en: Connect GND (pin 4) of the Nano to the blue negative rail on the breadboard.
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Nano的GND（引脚4）连接到面包板上的蓝色负极轨道。
- en: Identify locations for the 10 driver transistors (Q1 to Q10), and place them
    on the breadboard. I placed them so the beveled edge of the transistor faced right
    when looking from the bottom of the board.
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定10个驱动晶体管（Q1到Q10）的放置位置，并将它们放置在面包板上。我将它们放置成晶体管的斜边朝右，当从板子的底部看时。
- en: Connect the collector of all the transistors to where the 9V input will go (VIN
    of the Nano). See [Figure 10-5](ch10.xhtml#ch10fig10-5) for the pinout of the
    transistor.
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将所有晶体管的集电极连接到9V输入所在的位置（Nano的VIN）。请参见[图10-5](ch10.xhtml#ch10fig10-5)查看晶体管的引脚图。
- en: '![image](../images/fig10_5.jpg)'
  id: totrans-72
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![image](../images/fig10_5.jpg)'
- en: '*Figure 10-5: Pinout of the ZTX649 transistor*'
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*图10-5：ZTX649晶体管的引脚图*'
- en: Connect the base of Q1 to D2 (pin 5) on the Nano.
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Q1的基极连接到Nano的D2（引脚5）。
- en: Connect the base of Q2 to D3 (pin 6) on the Nano.
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Q2的基极连接到Nano的D3（引脚6）。
- en: Connect the base of Q3 to D4 (pin 7) on the Nano.
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Q3的基极连接到Nano的D4（引脚7）。
- en: Connect the base of Q4 to D5 (pin 8) on the Nano.
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Q4的基极连接到Nano的D5（引脚8）。
- en: Connect the base of Q5 to D6 (pin 9) on the Nano.
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Q5的基极连接到Nano的D6（引脚9）。
- en: Connect the base of Q6 to D7 (pin 10) on the Nano.
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Q6的基极连接到Nano的D7（引脚10）。
- en: Connect the base of Q7 to D8 (pin 11) on the Nano.
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Q7的基极连接到Nano的D8（引脚11）。
- en: Connect the base of Q8 to D9 (pin 12) on the Nano.
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Q8的基极连接到Nano的D9（引脚12）。
- en: Connect the base of Q9 to D10 (pin 13) on the Nano.
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Q9的基极连接到Nano的D10（引脚13）。
- en: Connect the base of Q10 to D11 (pin 14) on the Nano.
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Q10的基极连接到Nano的D11（引脚14）。
- en: Connect each of the emitters for all the transistors Q1 through Q10 to the positive
    lead of each colored LED.
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Q1到Q10的所有晶体管的发射极连接到每个有色LED的正极引脚。
- en: Connect the negative lead of the LEDs to an empty location on the breadboard.
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LED的负极引脚连接到面包板上的一个空位置。
- en: Connect one side of the 470-ohm resistors to the negative leads of each LED.
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将470欧姆电阻的一端连接到每个LED的负极引脚。
- en: Connect the other side of the 470-ohm resistors to ground (the blue negative
    rail).
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将470欧姆电阻的另一端连接到地（蓝色负极轨道）。
- en: Connect pin 1 (4–20V) of the LM35 to the red positive rail. (See [Figure 10-6](ch10.xhtml#ch10fig10-6)
    for the pinout of the LM35.)
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LM35的引脚1（4–20V）连接到红色正极轨。（请参见[图10-6](ch10.xhtml#ch10fig10-6)查看LM35的引脚图。）
- en: '![image](../images/fig10_6.jpg)'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![image](../images/fig10_6.jpg)'
- en: '*Figure 10-6: Pinout of the LM35 temperature sensor*'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*图10-6：LM35温度传感器的引脚图*'
- en: Connect pin 3 (GND) of the LM35 to the blue negative rail.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LM35的引脚3（GND）连接到蓝色负极轨。
- en: Connect the output pin (center) of the LM35 to pin A0 (26) on the Nano.
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LM35的输出引脚（中间）连接到Nano的A0（26）引脚。
- en: 24\. Connect power and ground to the respective red positive and blue negative
    rails.
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 24. 将电源和接地分别连接到红色正极轨和蓝色负极轨。
- en: 'Now, you’re all set to go with the most basic configuration. To add the digital
    display:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你已经完成了最基本的配置。要添加数字显示屏：
- en: Connect the power and ground of the LCD’s I²C adapter to the respective red
    positive and blue negative rails.
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的I²C适配器的电源和接地引脚分别连接到红色正极轨和蓝色负极轨。
- en: Connect the SDA pin of the LCD’s I²C adapter to A4 (22) on the Nano.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的I²C适配器的SDA引脚连接到Nano的A4（22）引脚。
- en: Connect the SCL pin of the LCD’s I²C adapter to A5 (21) of the Nano.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将LCD的I²C适配器的SCL引脚连接到Nano的A5（21）引脚。
- en: Upload the appropriate software code to the Nano.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将适当的软件代码上传到Nano。
- en: 'If you want to play with the high-accuracy temperature sensor:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想使用高精度温度传感器：
- en: Remove the LM35 from the circuit (or you can leave it in—it will not affect
    anything).
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从电路中移除LM35（或者你也可以将其保留在电路中——它不会影响任何东西）。
- en: Place the high-accuracy sensor in a location where the pins will not be affected
    by anything.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将高精度传感器放置在一个位置，以避免引脚受到任何影响。
- en: Connect the power pins of the I²C connection on the MCP9808 sensor to the blue
    negative rail and 5V—pin 27, or the red positive rail—on the Nano, respectively.
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将MCP9808传感器的I²C连接的电源引脚分别连接到Nano的蓝色负极轨和5V——引脚27，或者红色正极轨。
- en: Connect the SDA pin of the I²C connection on the MCP9808 sensor to A4 (22) on
    the Nano.
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将MCP9808传感器的I²C连接的SDA引脚连接到Nano的A4（22）引脚。
- en: Connect the SCL pin of the I²C connection on the MCP9808 sensor to A5 (21) on
    the Nano.
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将MCP9808传感器的I²C连接的SCL引脚连接到Nano的A5（21）引脚。
- en: Upload the software to the Nano with the high-accuracy sensor version of code.
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用高精度传感器版本的代码上传软件到Nano。
- en: Now you’re all set to go.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经准备好开始了。
- en: '**NOTE**'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*This particular breadboard’s positive and negative power rails are not continuous.
    The first 15 are connected, the next 20 are connected, and the last 15 are connected—but
    not to each other. I used jumpers to connect the rails as needed*.'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '*这个面包板的正负电源轨不连续。前15个连接在一起，接下来的20个连接在一起，最后15个连接在一起——但它们之间没有连接。我使用跳线根据需要连接这些电源轨。*'
- en: '**The Sketches**'
  id: totrans-109
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**草图**'
- en: 'There are two versions of the sketch: one for the LM35 version of this project
    and one for the MCP9808 version. You can pick a sketch to use based on which version
    of the Chromatic Thermometer you’d like to build, but both sketches comprise three
    basic sections.'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 这个草图有两个版本：一个是LM35版本的项目，另一个是MCP9808版本的项目。你可以根据想要构建的色谱温度计版本选择草图，但两个草图都包括三个基本部分。
- en: After the boilerplate section of loading libraries and preliminary setup, the
    first component of each sketch deals with the temperature sensor itself. The second
    section deals with setting up the temperature and LCD readout (if used). The final
    element of each sketch details the conditions to turn the LEDs on and off to indicate
    the temperature. I have annotated the code with comments where appropriate.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 在加载库和初步设置的样板代码部分之后，每个草图的第一部分涉及温度传感器本身。第二部分涉及设置温度和LCD显示（如果使用）。每个草图的最后部分详细说明了打开和关闭LED的条件，以指示温度。我已在代码中适当地添加了注释。
- en: '***Sketch for the LM35 System***'
  id: totrans-112
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***LM35系统的草图***'
- en: Here is the sketch for the Chromatic Thermometer with the LM35 sensor, including
    the digital LCD readout.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 这是使用LM35传感器的色谱温度计草图，包括数字LCD显示。
- en: '[PRE0]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: After including libraries, the LM35 sketch defines the number of samples to
    keep track of at ➊. The higher the number, the more the readings will be smoothed,
    but the longer it will take to settle. Using a constant rather than a normal variable
    for the number of samples allows this value to determine the size of the `readings`
    array.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 在包括库之后，LM35草图在➊处定义了要跟踪的样本数量。样本数量越高，读数越平滑，但稳定下来所需的时间也越长。使用常量而不是普通变量来表示样本数量，使得该值能够决定`readings`数组的大小。
- en: The `setup()` code initializes the LCD, turns on serial communication for debugging,
    initializes the readings array with all zeros (because the sketch hasn’t read
    anything yet), and sets the ADC reference voltage to 1.1V. The `loop()` code stores
    sensor data in the `readings` array and averages the readings to calculate a temperature
    to display. If you have an LCD, the sketch shows the temperature on it, and then
    it checks various temperature ranges with `if` statements to see which LEDs to
    turn on.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '`setup()` 代码初始化 LCD，打开串行通信以进行调试，将读取数组初始化为全零（因为草图尚未读取任何数据），并将 ADC 参考电压设置为 1.1V。`loop()`
    代码将传感器数据存储在 `readings` 数组中，并通过平均这些读数来计算要显示的温度。如果你有 LCD，草图会在其上显示温度，然后检查各种温度范围，并通过
    `if` 语句决定哪些 LED 需要打开。'
- en: The big difference between this sketch and the next is that the LM35 version
    sets up the system to accept the analog voltage from the sensor and direct it
    to an analog input. It also establishes a reference voltage of 1.1V with the `analogReference(INTERNAL)`
    command.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 这个草图和下一个草图之间的最大区别在于，LM35 版本设置系统以接受来自传感器的模拟电压，并将其引导到模拟输入。它还通过 `analogReference(INTERNAL)`
    命令建立了一个 1.1V 的参考电压。
- en: '***Sketch for the MCP9808 System***'
  id: totrans-118
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***MCP9808 系统的草图***'
- en: 'The sketch for the version with the high-accuracy MCP9808 chip (or the board
    from Adafruit) uses much of the same code; the conditional statements that turn
    on the LEDs are identical. The only part that differs is how the Arduino gets
    the temperature information from the sensor. Here is the full sketch:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 高精度 MCP9808 芯片版本（或 Adafruit 的开发板）的草图使用了大部分相同的代码；用于打开 LED 的条件语句是相同的。唯一不同的部分是
    Arduino 如何从传感器获取温度信息。以下是完整的草图：
- en: '[PRE1]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The MCP9808 sketch’s version of the `setup()` code checks to make sure you
    have the MCP9808 temperature sensor plugged in. In the `loop()` section, it calls
    the `readTempC()` function from the *Adafruit_MCP9808* library to fetch the current
    temperature, instead of calling `analogRead()` directly, as the LM35 code does.
    Unlike the LM35 code, this sketch doesn’t need to set up an external voltage reference:
    one advantage of using the MCP9808 is that the chip contains its own internal
    reference. Otherwise, apart from a few differences in variable names, the rest
    of the sketch is the same as the LM35 code.'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: MCP9808 草图版本的 `setup()` 代码检查确保你已连接 MCP9808 温度传感器。在 `loop()` 部分，它调用 *Adafruit_MCP9808*
    库中的 `readTempC()` 函数来获取当前温度，而不是像 LM35 代码那样直接调用 `analogRead()`。与 LM35 代码不同，这个草图不需要设置外部电压参考：使用
    MCP9808 的一个优点是该芯片自带内部参考电压。否则，除了几个变量名的不同外，其余的草图与 LM35 代码相同。
- en: '***How the Temperature Readouts Work***'
  id: totrans-122
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***温度显示的工作原理***'
- en: In both sketches, the basic temperature readout comprises a series of 10 different
    colored LEDs with transistors driven in an emitter-follower configuration from
    outputs D2 through D11 on the Nano.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 在这两个草图中，基本的温度显示由 10 个不同颜色的 LED 组成，LED 通过从 Nano 的 D2 到 D11 的输出端驱动的发射极跟随配置的晶体管来控制。
- en: The outputs of the Nano are activated by the sketch, and each output corresponds
    to a conditional statement of the form, “If temperature is between *X* degrees
    and *Y* degrees, turn on an LED. If not, turn off the LED.” The `if` statements
    for these commands are the same in both the LM35 and the MCP9808 high-accuracy
    version.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: Nano 的输出由草图激活，每个输出对应一个条件语句，格式为：“如果温度在 *X* 度和 *Y* 度之间，开启 LED。如果不是，关闭 LED。”这些命令的
    `if` 语句在 LM35 和高精度版本的 MCP9808 中是相同的。
- en: 'When I first completed the project, I used it in a saltwater fish tank, where
    I wanted to accurately view the temperature at a glance and at a distance. I set
    up the LEDs to blink at unacceptable temperature extremes to get my attention
    so I could take corrective action. The blinking effect required only turning the
    LED off and on with a delay in between. I modified the sketch to read as follows
    for the warning condition:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 当我第一次完成这个项目时，我将它用于一个盐水鱼缸，在那里我希望能够准确地远程查看温度。我设置了 LED 在温度达到不可接受的极限时闪烁，以引起我的注意，这样我就可以采取纠正措施。闪烁效果只需要在
    LED 关闭和打开之间加入延迟。我修改了草图，使其在警告条件下如下所示：
- en: '[PRE2]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This example blinks the display when, and only when, the temperature is between
    78 and 79°F, as indicated in the full sketch. The length of the delay, combined
    with any further delays you might add, determines the blinking rate.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 这个示例仅当温度在 78°F 和 79°F 之间时才会闪烁显示，如完整草图所示。延迟的长度，再加上你可能添加的其他延迟，决定了闪烁的速率。
- en: The general readout system and this simple, silent alarm worked extremely well
    together. I could set alarms to make sure that the temperature was above or below
    the threshold temperature.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 一般的读数系统和这个简单、安静的报警器一起工作得非常好。我可以设置报警，确保温度高于或低于阈值温度。
- en: 'I also thought it might be valuable to have a digital readout, however, for
    two reasons:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 我还认为拥有一个数字读数可能很有价值，原因有两个：
- en: I wanted the option to see exactly what the temperature was.
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我想要能够准确查看温度。
- en: Should the temperature go out of range and the “blink” alarm execute, I wanted
    to see how far from the limit the temperature was.
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果温度超出范围并且“闪烁”报警执行，我希望能够看到温度距离限制有多远。
- en: Adding the digital display was relatively easy, as I used a standard 16×2 LCD
    with I²C interface requiring only four wires. I bought an LCD with a built-in
    I²C adapter this time. It was larger than I had hoped for, but I was unable to
    find a smaller display easily. If you can find one, go for it.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 添加数字显示屏相对简单，因为我使用了一个标准的 16×2 LCD 带有 I²C 接口，只需要四根线。这次我买了一个内置 I²C 适配器的 LCD。它比我希望的要大，但我很难找到一个更小的显示屏。如果你能找到一个更小的，尽管去买。
- en: '**The Shield**'
  id: totrans-133
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**屏蔽**'
- en: The PCB shield for this project was designed with two copper layers rather than
    a single layer. The extra layer makes fabricating the board a little more difficult,
    but it saves a lot of effort in identifying and wiring jumpers. I initially etched
    the board in-house, but I had the finished board produced by Express PCB. The
    plated through-holes on the professionally finished board made assembly a lot
    easier. The layers of the PCB are shown in [Figure 10-7](ch10.xhtml#ch10fig10-7).
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 这个项目的 PCB 屏蔽板设计采用了两层铜而非单层。额外的层使得制造板子变得有些困难，但它在识别和连接跳线时节省了很多精力。我最初在内部蚀刻了板子，但最终是通过
    Express PCB 制作了完成的板子。专业完成的板子上的电镀过孔使得组装更加容易。PCB 的层次结构在[图 10-7](ch10.xhtml#ch10fig10-7)中展示。
- en: Notice that the LED driver transistors are located below the Nano board to save
    on surface area. The only penalty to this is that the Nano sits a little higher
    on the board. You can see the transistors in [Figure 10-8](ch10.xhtml#ch10fig10-8),
    which shows the populated PCB with the Nano board next to it.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，LED 驱动晶体管位于 Nano 板下方，以节省表面面积。这样做的唯一缺点是 Nano 板稍微提高了一些。你可以在[图 10-8](ch10.xhtml#ch10fig10-8)中看到这些晶体管，图中展示了带有
    Nano 板的装配完毕的 PCB。
- en: The shield also includes provisions for two I²C devices—one at either end of
    the board. Because I thought this board might find its way into many different
    projects, I made it as flexible as possible. The I²C connections make it easy
    to hook up both the high-accuracy Adafruit breakout board as well as a digital
    display. You can either wire them in directly or solder a straight or right-angle
    female header into the board for use with a crimped-connector housing with cable
    (see [Figure 10-9](ch10.xhtml#ch10fig10-9)).
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 这个屏蔽板还包括了两个 I²C 设备的接口——每端一个。因为我认为这个板子可能会用到很多不同的项目中，所以我尽量让它尽可能灵活。I²C 连接使得连接高精度的
    Adafruit breakout 板和数字显示屏变得非常容易。你可以直接接线，也可以将一个直角或直头的母头插座焊接到板子上，然后使用带有压接连接器外壳和电缆的方式（参见[图
    10-9](ch10.xhtml#ch10fig10-9)）。
- en: '![image](../images/fig10_7.jpg)'
  id: totrans-137
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/fig10_7.jpg)'
- en: '*Figure 10-7: The top layer of the PCB shield with silkscreen image. You can
    see the pattern for the MCP9808 in the bottom left*.'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 10-7：带有丝网印刷图像的 PCB 屏蔽板的顶层。你可以看到底部左侧的 MCP9808 图案*。'
- en: '![image](../images/fig10_8.jpg)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/fig10_8.jpg)'
- en: '*Figure 10-8: Populated shield next to an Arduino Nano. Notice that I used
    full-length female headers for the Nano. Also note the holes and traces for an
    11th LED in the top right*.'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 10-8：装配完毕的屏蔽板，旁边是一个 Arduino Nano。注意我为 Nano 使用了全长母头插座。还请注意右上角的第 11 个 LED
    的孔和迹线*。'
- en: '![image](../images/fig10_9.jpg)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/fig10_9.jpg)'
- en: '*Figure 10-9: The assembled thermometer using the MCP9808 chip soldered directly
    to the shield (lower right). One I²C connector is above and to the right of the
    MCP9808 chip; connections for another I²C connector are at the lower left*.'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 10-9：使用 MCP9808 芯片直接焊接到屏蔽板上的组装温度计（右下角）。一个 I²C 连接器位于 MCP9808 芯片的上方和右侧；另一个
    I²C 连接器的连接点位于左下角*。'
- en: The shield includes pads for the MCP9808 chip (installed in [Figure 10-9](ch10.xhtml#ch10fig10-9))
    if you elect to solder the chip directly to the board. If you use the MCP9808
    chip rather than the breakout board without another connection to the I²C interface,
    you will have to provide 10-kilohm pull-up resistors to the SDA and SCL lines.
    These are not included in the shield layout but can easily be added to the I²C
    port connections since they would be unused. In the implementation in [Figure
    10-9](ch10.xhtml#ch10fig10-9), the 10-kilohm resistors are on the LCD adapter
    because there will be an LCD adapter plugged into the I²C port, eliminating the
    need for the pull-up resistors.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你选择将MCP9808芯片直接焊接到板上，屏蔽板上有为MCP9808芯片预留的焊盘（见[图10-9](ch10.xhtml#ch10fig10-9)）。如果你使用的是MCP9808芯片而不是带有I²C接口的分离板，你将需要为SDA和SCL线路提供10千欧姆的上拉电阻。这些电阻没有包含在屏蔽板布局中，但可以很容易地添加到I²C端口连接中，因为这些连接本来是没有使用的。在[图10-9](ch10.xhtml#ch10fig10-9)中的实现中，10千欧姆的电阻安装在LCD适配器上，因为会有一个LCD适配器插入到I²C端口，从而不需要额外的上拉电阻。
- en: While the shield files included for this project provide for direct attachment
    of the LEDs to the PCB, there are many instances where you may want to separate
    the PCB from the LEDs. For example, I made one version where I spaced out high-intensity,
    10 mm LEDs an inch apart on a decorative piece of wood to create a more dramatic
    look. To do something like that, you’d want to solder long wires to the LED leads
    and then solder those to the PCB. The cathodes of all the LEDs can be wired together,
    and only the anodes need be connected to the board individually.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管为本项目提供的屏蔽板文件支持将LED直接安装到PCB板上，但在许多情况下，你可能希望将PCB板与LED分开。例如，我做了一个版本，将高强度的10毫米LED按一英寸的间距排列在一块装饰木板上，以创造更具戏剧性的效果。要实现这种效果，你需要将长电线焊接到LED引脚上，然后再将这些电线焊接到PCB板上。所有LED的阴极可以连接在一起，只有阳极需要单独连接到电路板上。
- en: '**Construction**'
  id: totrans-145
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**构建**'
- en: If you haven’t soldered your components to the shield PCB or a prototyping board,
    do so now, and remember to assemble the LEDs with the correct polarity. The final
    configuration of the Chromatic Thermometer depends very much on your final application,
    so I will not go into a lot of specific detail on constructing this project.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你还没有将组件焊接到屏蔽板PCB或原型板上，现在就开始焊接，并记得按照正确的极性安装LED。Chromatic Thermometer的最终配置很大程度上取决于你的最终应用，因此我不会在构建此项目时提供过多的具体细节。
- en: For example, if you want to use a remote temperature sensor, you will want a
    jack or another appropriate connector. You may also want to cut a slit in the
    enclosure to accommodate a wire for the sensor, as well as another for a long
    power connection. And if you are going to build the Chromatic Thermometer with
    only the LEDs and no LCD, you would probably mount the electronics inside the
    enclosure differently. Similarly, if you build the high-accuracy version, you
    may need to adjust how you fit your parts into the enclosure. The Chromatic Thermometer
    shown in [Figure 10-10](ch10.xhtml#ch10fig10-10) uses the LM35 sensor with the
    16×2 LCD.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果你想使用远程温度传感器，你需要一个插孔或者其他适当的连接器。你可能还需要在外壳上切一个缝隙，以容纳传感器的电线，以及另一条用于长电源连接的线。如果你打算只使用LED而不使用LCD来构建Chromatic
    Thermometer，你可能会以不同的方式将电子元件安装到外壳内。类似地，如果你构建的是高精度版本，你可能需要调整零件在外壳中的布局。图[10-10](ch10.xhtml#ch10fig10-10)中的Chromatic
    Thermometer使用了LM35传感器和16×2 LCD。
- en: I used a small box I found on Amazon (originally sold to hold baseball cards)
    to enclose the whole thing and mounted the sensor directly to the shield in the
    three holes to accommodate it in the PCB. If you don’t want the LED on the Nano
    to show, you can unsolder it, or simply cover it with a small piece of black electrical
    tape.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 我使用了在亚马逊上找到的一款小盒子（最初是用来放棒球卡的）将整个装置封装起来，并将传感器直接安装到三个孔位的屏蔽板上，以便将其适配到PCB板中。如果你不想让Nano板上的LED显示出来，可以将其拆除，或者简单地用一小块黑色电工胶带将其遮住。
- en: Whether you use the 3 mm LEDs or the heftier, high-output 5 mm LEDs, using some
    kind of spacer works well for making sure the LEDs are lined up at the height
    you like. When I mounted the readout LEDs to the shield, I placed a sliver of
    unused PCB material to hold all of the LEDs at a uniform height (see [Figure 10-11](ch10.xhtml#ch10fig10-11)).
    You could use cardboard just as easily, and if you want a different height, just
    use a taller or shorter spacer.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 无论你使用3毫米LED还是更重的高输出5毫米LED，使用某种间隔器都有助于确保LED按照你喜欢的高度对齐。当我将读数LED安装到护盾上时，我放置了一块未使用的PCB材料，将所有LED保持在一个统一的高度（见[图10-11](ch10.xhtml#ch10fig10-11)）。你也可以使用纸板，若想要不同的高度，只需使用更高或更矮的间隔器即可。
- en: '![image](../images/fig10_10.jpg)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/fig10_10.jpg)'
- en: '*Figure 10-10: The completed Chromatic Thermometer in an acrylic enclosure,
    monitoring the temperature of medicine in a cooler when traveling. This version
    uses a 9V battery, which is inside the enclosure. I used a display with a backlight,
    but the battery will last a lot longer without the backlight. Turn on/off thresholds
    for LEDs were modified for cold temperature use*.'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: '*图10-10：完成的色度温度计放置在亚克力外壳中，用于在旅行中监控冷却器中药物的温度。这个版本使用了9V电池，电池在外壳内部。我使用了带背光的显示器，但没有背光时电池寿命会更长。LED的开关阈值被修改为适应低温使用*。'
- en: '![image](../images/fig10_11.jpg)'
  id: totrans-152
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/fig10_11.jpg)'
- en: '*Figure 10-11: I used a discarded strip of PCB material to hold LEDs at uniform
    height*'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '*图10-11：我使用了废弃的PCB材料条来保持LED的统一高度*'
- en: If you use 5 mm LEDs, you may have difficulty fitting them through the holes
    in a standard PCB, as some 5 mm LEDs have wider leads. I expanded the holes with
    a drill to fit the larger LEDs; because there were no connections on the other
    side of the PCB, the plate-through was not needed.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用5毫米LED，可能会发现它们难以通过标准PCB的孔洞，因为一些5毫米LED的引脚较宽。我使用钻头扩孔以适应较大的LED；由于PCB的另一面没有连接，所以不需要镶嵌孔。
- en: '**MOD: TRY DIFFERENT LEDS**'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '**MOD：尝试不同的LED**'
- en: The Chromatic Thermometer shown in [Figure 10-8](ch10.xhtml#ch10fig10-8) uses
    3 mm LEDs. I ordered 3 mm LEDs on eBay in 10 different colors, but the leads were
    a little short. Subsequently, I ordered 200 5 mm LEDs in a selection of 10 different
    colors. These also had short leads, but they were brighter and worked well. I
    did have to file the edges of some of the LEDs where there was a little extra
    flashing from the mold so they would fit within the 0.200-inch spacing (a little
    more than 5 mm) on the PCB. However, I could not find enough different-colored
    high-output 5 mm LEDs.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '[图10-8](ch10.xhtml#ch10fig10-8)中所示的色度温度计使用了3毫米LED。我在eBay上订购了10种不同颜色的3毫米LED，但引脚有点短。随后，我订购了200颗5毫米LED，包含10种不同的颜色。这些LED的引脚同样较短，但亮度更强，并且效果不错。我确实需要修整一些LED的边缘，去掉模具上留下的一些多余闪光，以便它们能适应PCB上0.200英寸（略大于5毫米）的间距。然而，我没能找到足够多不同颜色的高输出5毫米LED。'
- en: For one experimental version, I used six different-colored high-output 5 mm
    LEDs, repeated the colors at the extremes, and went back to the sketch to create
    blinking patterns to differentiate the similar colors. That version of the Chromatic
    Thermometer worked well, and the high-output LEDs made it quite noticeable.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 对于一个实验版本，我使用了六种不同颜色的高输出5毫米LED，在极端位置重复这些颜色，并返回草图，创造了闪烁模式以区分相似的颜色。这个版本的色度温度计效果很好，而且高输出的LED让它非常显眼。
- en: To attract even more attention, you can use high-output 10 mm LEDs. They will
    not fit on the shield PCB shown here, however, as I only spaced the LEDs out by
    0.200 inches. That spacing allows for most 3 mm and 5 mm LEDs, but not 10 mm ones.
    See [Figure 10-12](ch10.xhtml#ch10fig10-12) for a size comparison.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 为了吸引更多的注意力，你可以使用高输出的10毫米LED。 但是，它们无法安装在此处所示的护盾PCB上，因为我只将LED间距设置为0.200英寸。这个间距适用于大多数3毫米和5毫米LED，但不适用于10毫米LED。有关尺寸比较，请参见[图10-12](ch10.xhtml#ch10fig10-12)。
- en: '![image](../images/fig10_12.jpg)'
  id: totrans-159
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/fig10_12.jpg)'
- en: '*Figure 10-12: From left to right, 10 mm, 5 mm, and 3 mm LEDs shown next to
    a metric ruler*'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '*图10-12：从左到右，10毫米、5毫米和3毫米LED显示在一个米制尺旁*'
- en: To use 10 mm LEDs, you will have to mount them elsewhere and connect them to
    the PCB with wires. For inspiration, look at the lightbar for the Watch Winder
    in [Chapter 4](ch04.xhtml#ch04).
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用10毫米LED，你必须将它们安装在其他地方，并用导线将它们连接到PCB上。可以参考[第4章](ch04.xhtml#ch04)中的手表绕线器的灯条获取灵感。
- en: '**Using the Chromatic Thermometer**'
  id: totrans-162
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**使用色度温度计**'
- en: How you place the thermometer in the environment you want to monitor is limited
    only by your imagination. The version I use on my fish tank had no LCD at first,
    so I simply attached a couple of wire hooks to the bare board and hung it from
    the edge of the tank with the LEDs facing out. (I could have mounted the entire
    thing in a small acrylic box, but I had difficulty finding a box with the right
    dimensions.) This configuration worked well.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 如何将温度计放置在你想要监控的环境中，只有你的想象力可以限制。最初我在鱼缸上使用的版本没有LCD显示屏，所以我只是将几个金属线钩固定在裸板上，然后把它挂在水箱的边缘，LED灯朝外。（我本可以把整个装置安装在一个小的丙烯酸盒子里，但我很难找到合适尺寸的盒子。）这种配置效果很好。
- en: I eventually replaced that Chromatic Thermometer with a version including an
    LCD that I enclosed in an acrylic box. I’m thinking of modifying it again to use
    high-intensity LEDs that shine through the tank. That should create an interesting
    effect!
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 最终，我将那个色差温度计替换成了一个带有LCD显示屏的版本，并将其封装在一个丙烯酸盒子里。我正在考虑再次修改它，使用高强度的LED灯照射水箱，这应该能创造出一个有趣的效果！
