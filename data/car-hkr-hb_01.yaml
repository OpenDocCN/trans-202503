- en: '**1**'
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**1**'
- en: '**UNDERSTANDING THREAT MODELS**'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '**理解威胁模型**'
- en: '![image](graphics/common-01.jpg)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![image](graphics/common-01.jpg)'
- en: If you come from the software penetrationtesting world, you’re probably already
    familiar with attack surfaces. For the rest of us, *attack surface* refers to
    all the possible ways to attack a target, from vulnerabilities in individual components
    to those that affect the entire vehicle.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你来自软件渗透测试领域，你可能已经熟悉攻击面。对于我们其他人来说，*攻击面*指的是所有可能攻击目标的方式，从单个组件的漏洞到影响整个车辆的漏洞。
- en: When discussing the attack surface, we’re not considering how to exploit a target;
    we’re concerned only with the entry points into it. You might think of the attack
    surface like the surface area versus the volume of an object. Two objects can
    have the same volume but radically different surface areas. The greater the surface
    area, the higher the exposure to risk. If you consider an object’s volume its
    value, our goal in hardening security is to create a low ratio of risk to value.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在讨论攻击面时，我们并不是考虑如何利用目标，而只是关心进入目标的入口点。你可以将攻击面想象成物体的表面积与体积的关系。两个物体可能有相同的体积，但表面积却大不相同。表面积越大，暴露于风险的可能性就越高。如果你把物体的体积看作它的价值，那么我们在强化安全时的目标就是创造一个低风险与价值比率。
- en: '**Finding Attack Surfaces**'
  id: totrans-5
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**寻找攻击面**'
- en: When evaluating a vehicle’s attack surface, think of yourself as an evil spy
    who’s trying to do bad things to a vehicle. To find weaknesses in the vehicle’s
    security, evaluate the vehicle’s perimeter, and document the vehicle’s environment.
    Be sure to consider all the ways that data can get into a vehicle, which are all
    the ways that a vehicle communicates with the outside world.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在评估车辆的攻击面时，想象自己是一个恶意间谍，试图对车辆进行破坏。为了找到车辆安全性上的弱点，评估车辆的周边环境，并记录车辆的外部环境。确保考虑所有数据可能进入车辆的方式，这些方式都是车辆与外部世界进行通信的途径。
- en: 'As you examine the exterior of the vehicle, ask yourself these questions:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在检查车辆外部时，问自己以下问题：
- en: • What signals are received? Radio waves? Key fobs? Distance sensors?
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: • 接收了哪些信号？无线电波？钥匙扣？距离传感器？
- en: • Is there physical keypad access?
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: • 是否有物理键盘访问？
- en: • Are there touch or motion sensors?
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: • 是否有触摸或运动传感器？
- en: • If the vehicle is electric, how does it charge?
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: • 如果车辆是电动的，它是如何充电的？
- en: 'As you examine the interior, consider the following:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在检查内部时，考虑以下事项：
- en: '• What are the audio input options: CD? USB? Bluetooth?'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: • 音频输入选项有哪些：CD？USB？蓝牙？
- en: • Are there diagnostic ports?
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: • 是否有诊断端口？
- en: • What are the capabilities of the dashboard? Is there a GPS? Bluetooth? Internet?
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: • 仪表盘有哪些功能？是否有GPS？蓝牙？互联网？
- en: As you can see, there are many ways data can enter the vehicle. If any of this
    data is malformed or intentionally malicious, what happens? This is where threat
    modeling comes in.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，数据进入车辆的方式有很多。如果这些数据被破坏或故意恶意操作，会发生什么？这就是威胁建模的作用所在。
- en: '**Threat Modeling**'
  id: totrans-17
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**威胁建模**'
- en: Entire books have been written about threat modeling, but I’m going to give
    you just a quick tour so you can build your own threat models. (If you have further
    questions or if this section excites you, by all means, grab another book on the
    subject!)
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 关于威胁建模已经写了整本书，但我将给你一个快速的概览，以便你能够构建自己的威胁模型。（如果你有更多问题，或者这一部分让你感兴趣，请毫不犹豫地再读一本关于这个主题的书！）
- en: When threat modeling a car, you collect information about the architecture of
    your target and create a diagram to illustrate how parts of the car communicate.
    You then use these maps to identify higher-risk inputs and to keep a checklist
    of things to audit; this will help you prioritize entry points that could yield
    the most return.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在对汽车进行威胁建模时，你需要收集目标架构的信息，并创建图表来说明汽车各部分如何进行通信。然后，利用这些图来识别高风险输入，并保持审计清单；这将帮助你优先考虑可能带来最大回报的入口点。
- en: Threat models are typically made during the product development and design process.
    If the company producing a particular product has a good development life cycle,
    it creates the threat model when product development begins and continuously updates
    the model as the product moves through the development life cycle. Threat models
    are living documents that change as the target changes and as you learn more about
    a target, so you should update your threat model often.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁模型通常是在产品开发和设计过程中创建的。如果生产特定产品的公司有良好的开发生命周期，它会在产品开发开始时创建威胁模型，并在产品通过开发生命周期时不断更新该模型。威胁模型是活文档，随着目标的变化以及你对目标了解的深入而变化，因此你应该经常更新你的威胁模型。
- en: Your threat model can consist of different levels; if a process in your model
    is complicated, you should consider breaking it down further by adding more levels
    to your diagrams. In the beginning, however, Level 2 is about as far as you’ll
    be able to go. We’ll discuss the various levels in the following sections, beginning
    with Threat Level 0.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 你的威胁模型可以包含不同的层次；如果模型中的某个过程很复杂，你应该考虑通过添加更多层次来进一步拆解图表。然而，在开始时，Level 2是你能够达到的最远层次。我们将在接下来的章节中讨论不同的层次，从威胁Level
    0开始。
- en: '***Level 0: Bird’s-Eye View***'
  id: totrans-22
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***Level 0：鸟瞰图***'
- en: At this level, we use the checklist we built when considering attack surfaces.
    Think about how data can enter the vehicle. Draw the vehicle in the center, and
    then label the external and internal spaces. [Figure 1-1](ch01.html#ch1fig1) illustrates
    a possible Level 0 diagram.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一层，我们使用了在考虑攻击面时建立的清单。想一想数据如何进入车辆。将车辆画在中心，然后标记外部和内部空间。[图 1-1](ch01.html#ch1fig1)展示了一个可能的Level
    0图示。
- en: The rectangular boxes are the inputs, and the circle in the center represents
    the entire vehicle. On their way to the vehicle, the inputs cross two dotted lines,
    which represent external and internal threats.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 矩形框表示输入，中心的圆圈代表整个车辆。在它们到达车辆之前，输入会穿过两条虚线，表示外部和内部威胁。
- en: The vehicle circle doesn’t represent an input but rather a complex process—that
    is, a series of tasks that could be broken down further. Processes are numbered,
    and as you can see, this one is number 1.0\. If you had more than one complex
    piece in your threat model, you would number those in succession. For instance,
    you would label a second process 2.0; a third, 3.0; and so on. As you learn about
    your vehicle’s features, you update the diagram. It’s okay if you don’t recognize
    all of the acronyms in the diagram yet; you will soon.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 车辆圆圈并不代表一个输入，而是一个复杂的过程——即一系列可以进一步拆解的任务。流程有编号，正如你所看到的，这个是1.0。如果你的威胁模型中有多个复杂的部分，你将按顺序为它们编号。例如，第二个流程为2.0，第三个为3.0，以此类推。当你了解车辆的功能时，你会更新图表。如果你现在还不认识图表中的所有缩写词，也没关系；你很快就会认识了。
- en: '![image](graphics/f01-01.jpg)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![image](graphics/f01-01.jpg)'
- en: '*Figure 1-1: Level 0 inputs*'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-1：Level 0 输入*'
- en: '***Level 1: Receivers***'
  id: totrans-28
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***Level 1：接收器***'
- en: To move on to the Level 1 diagram, pick a process to explore. Because we have
    only the one process in our diagram, let’s dig in to the vehicle process and focus
    on what each input talks to.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 要继续查看Level 1图表，选择一个流程进行探索。由于我们的图表中只有一个流程，让我们深入研究车辆流程，并专注于每个输入所连接的内容。
- en: The Level 1 map shown in [Figure 1-2](ch01.html#ch1fig2) is almost identical
    to that in Level 0\. The only difference is that here we specify the vehicle connections
    that receive the Level 0 input. We won’t look at the receivers in depth just yet;
    we’re looking only at the basic device or area that the input talks to.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 1-2](ch01.html#ch1fig2)中显示的Level 1地图几乎与Level 0的相同。唯一的区别是这里我们指定了接收Level 0输入的车辆连接。我们暂时不会深入查看接收器；我们只关注输入所连接的基本设备或区域。'
- en: '![image](graphics/f01-02.jpg)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![image](graphics/f01-02.jpg)'
- en: '*Figure 1-2: Level 1 map of inputs and vehicle connections*'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-2：Level 1 输入与车辆连接图*'
- en: 'Notice in [Figure 1-2](ch01.html#ch1fig2) that we number each receiver. The
    first digit represents the process label from the Level 0 diagram in [Figure 1-1](ch01.html#ch1fig1),
    and the second digit is the number of the receiver. Because the infotainment unit
    is both a complex process and an input, we’ve given it a process circle. We now
    have three other processes: immobilizer, ECU, and TPMS Receiver.'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 注意在[图 1-2](ch01.html#ch1fig2)中，我们为每个接收器编号。第一位数字表示来自[图 1-1](ch01.html#ch1fig1)中的Level
    0图的流程标签，第二位数字是接收器的编号。由于娱乐信息单元既是一个复杂的过程又是一个输入，我们为其提供了一个流程圆圈。现在我们有了其他三个流程：防盗器、ECU和TPMS接收器。
- en: The dotted lines in the Level 1 map represent divisions between trust boundaries.
    The inputs at the top of the diagram are the least trusted, and the ones at the
    bottom are the most trusted. The more trust boundaries that a communication channel
    crosses, the more risky that channel becomes.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: Level 1图中的虚线表示信任边界之间的划分。图表顶部的输入是最不可信的，而底部的输入是最可信的。通信通道穿越的信任边界越多，该通道的风险就越大。
- en: '***Level 2: Receiver Breakdown***'
  id: totrans-35
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***Level 2：接收器拆解***'
- en: At Level 2, we examine the communication taking place inside the vehicle. Our
    sample diagram ([Figure 1-3](ch01.html#ch1fig3)) focuses on a Linux-based infotainment
    console, receiver 1.1\. This is one of the more complicated receivers, and it’s
    often directly connected to the vehicle’s internal network.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 在二级层级中，我们检查车辆内部发生的通信。我们的示例图（[图 1-3](ch01.html#ch1fig3)）集中在一个基于 Linux 的信息娱乐控制台，接收器
    1.1\。这是其中一个较为复杂的接收器，通常直接连接到车辆的内部网络。
- en: In [Figure 1-3](ch01.html#ch1fig3), we group the communications channels into
    boxes with dashed lines to once again represent trust boundaries. Now there’s
    a new trust boundary inside the infotainment console called kernel space. Systems
    that talk directly to the kernel hold higher risk than ones that talk to system
    applications because they may bypass any access control mechanisms on the infotainment
    unit. Therefore, the cellular channel is higher risk than the Wi-Fi channel because
    it crosses a trust boundary into kernel space; the Wi-Fi channel, on the other
    hand, communicates with the WPA supplicant process in user space.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在[图 1-3](ch01.html#ch1fig3)中，我们将通信通道分组为带虚线的框，代表信任边界。现在，信息娱乐控制台内部有一个新的信任边界，称为内核空间。与内核直接通信的系统风险较高，因为它们可能绕过信息娱乐单元的任何访问控制机制。因此，蜂窝通道的风险高于
    Wi-Fi 通道，因为它跨越了一个进入内核空间的信任边界；而 Wi-Fi 通道则与用户空间中的 WPA supplicant 进程进行通信。
- en: '![image](graphics/f01-03.jpg)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![image](graphics/f01-03.jpg)'
- en: '*Figure 1-3: Level 2 map of the infotainment console*'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-3：信息娱乐控制台的二级地图*'
- en: This system is a Linux-based in-vehicle infotainment (IVI) system, and it uses
    parts common to a Linux environment. In the kernel space, you see references to
    the kernel modules udev, HSI, and Kvaser, which receive input from our threat
    model. The udev module loads USB devices, HSI is a serial driver that handles
    cellular communication, and Kvaser is the vehicle’s network driver.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 该系统是一个基于 Linux 的车载信息娱乐（IVI）系统，使用了与 Linux 环境通用的部件。在内核空间中，你会看到对内核模块 udev、HSI 和
    Kvaser 的引用，它们接收来自我们威胁模型的输入。udev 模块加载 USB 设备，HSI 是处理蜂窝通信的串行驱动程序，而 Kvaser 是车辆的网络驱动程序。
- en: The numbering pattern for Level 2 is now *X*.*X*.*X*, and the identification
    system is the same as before. At Level 0, we took the vehicle process that was
    1.0 and dove deeper into it. We then marked all processes within Level 1 as 1.1,
    1.2, and so on. Next, we selected the infotainment process marked 1.1 and broke
    it down further for the Level 2 diagram. At Level 2, therefore, we labeled all
    complex processes as 1.1.1, 1.1.2, and so on. (You can continue the same numbering
    scheme as you dive even deeper into the processes. The numbering scheme is for
    documentation purposes; it allows you to reference the exact process at the appropriate
    level.)
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 二级的编号模式现在是 *X*.*X*.*X*，识别系统与之前相同。在零级时，我们选择了车辆进程 1.0 并进行了更深入的分析。然后，我们将一级内的所有进程标记为
    1.1、1.2 等等。接着，我们选择了标记为 1.1 的信息娱乐进程，并进一步拆解，生成二级图。因此，在二级中，我们将所有复杂的进程标记为 1.1.1、1.1.2
    等等。（你可以继续使用相同的编号方案，进一步深入到各个进程中。该编号方案用于文档化目的，能够让你在适当的层级中引用准确的进程。）
- en: '**NOTE**'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*Ideally at this stage, you’d map out which processes handle which inputs,
    but we’ll have to guess for now. In the real world, you’d need to reverse engineer
    the infotainment system to find this information.*'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '*理想情况下，在这个阶段，你应该映射出哪些进程处理哪些输入，但我们现在只能进行猜测。在现实世界中，你需要反向工程信息娱乐系统才能找到这些信息。*'
- en: When building or designing an automotive system, you should continue to drill
    down into as many complex processes as possible. Bring in the development team,
    and start discussing the methods and libraries used by each application so you
    can incorporate them into their own threat diagrams. You’ll likely find that the
    trust boundaries at the application level will usually be between the application
    and the kernel, between the application and the libraries, between the application
    and other applications, and even between functions. When exploring these connections,
    mark methods that have higher privileges or that handle more sensitive information.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在构建或设计汽车系统时，你应该尽可能深入挖掘尽可能多的复杂过程。将开发团队引入，并开始讨论每个应用程序使用的方法和库，以便将它们纳入各自的威胁图中。你很可能会发现，应用层的信任边界通常位于应用程序与内核、应用程序与库、应用程序与其他应用程序，甚至是各个功能之间。在探索这些连接时，标记出具有更高权限或处理更敏感信息的方法。
- en: '**Threat Identification**'
  id: totrans-45
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**威胁识别**'
- en: Now that we’ve gone two levels deep into our threat modeling maps, we can begin
    to identify potential threats. Threat identification is often more fun to do with
    a group of people and a whiteboard, but you can do it on your own as a thought
    exercise.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经深入分析了两层威胁建模图，我们可以开始识别潜在的威胁。威胁识别通常和一群人以及白板一起做会更有趣，但你也可以单独做作为思考练习。
- en: Let’s try this exercise together. Start at Level 0—the bird’s-eye view—and consider
    potential high-level problems with inputs, receivers, and threat boundaries. Now
    let’s list all potential threats with our threat models.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们一起做这个练习。从级别 0——鸟瞰视角开始，考虑输入、接收器和威胁边界的潜在高层问题。现在，让我们列出所有潜在的威胁，并用我们的威胁模型进行分析。
- en: '***Level 0: Bird’s-Eye View***'
  id: totrans-48
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***级别 0：鸟瞰视角***'
- en: When determining potential threats at Level 0, try to stay high level. Some
    of these threats may seem unrealistic because you’re aware of additional hurdles
    or protections, but it’s important to include all possible threats in this list,
    even if some have already been addressed. The point here is to brainstorm all
    the risks of each process and input.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 在确定级别 0 的潜在威胁时，尽量保持高层次。一些威胁可能看起来不现实，因为你知道额外的障碍或保护措施，但重要的是在这个列表中包含所有可能的威胁，即使一些已经被解决了。这里的重点是头脑风暴每个过程和输入的所有风险。
- en: 'The high-level threats at Level 0 are that an attacker could:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 级别 0 的高层威胁是，攻击者可能会：
- en: • Remotely take over a vehicle
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: • 远程接管车辆
- en: • Shut down a vehicle
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: • 关闭车辆
- en: • Spy on vehicle occupants
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: • 窃听车内乘客
- en: • Unlock a vehicle
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: • 解锁车辆
- en: • Steal a vehicle
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: • 偷盗车辆
- en: • Track a vehicle
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: • 跟踪车辆
- en: • Thwart safety systems
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: • 妨碍安全系统
- en: • Install malware on the vehicle
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: • 在车辆上安装恶意软件
- en: At first, it may be difficult to come up with a bunch of attack scenarios. It’s
    often good to have people who are not engineers also participate at this stage
    because as a developer or an engineer, you tend to be so involved in the inner
    workings that it’s natural to discredit ideas without even meaning to.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 起初，可能很难想到很多攻击场景。在这个阶段，让非工程师参与通常是有益的，因为作为开发者或工程师，你可能会过于专注于内部工作，以至于自然而然地不经意地否定一些想法。
- en: Be creative; try to come up with the most James Bond–villain attack you can
    think of. Maybe think of other attack scenarios and whether they could also apply
    to vehicles. For example, consider ransomware, a malicious software that can encrypt
    or lock you out of your computer or phone until you pay money to someone controlling
    the software remotely. Could this be used on vehicles? The answer is yes. Write
    *ransomware* down.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 发挥创造力，尽量想出你能想到的最像詹姆斯·邦德反派的攻击方式。也许想想其他攻击场景，看看它们是否也适用于车辆。例如，考虑勒索软件，这是一种恶意软件，能够加密或锁定你的电脑或手机，直到你支付给远程控制该软件的人。这个方法能用于车辆吗？答案是肯定的。把*勒索软件*写下来。
- en: '***Level 1: Receivers***'
  id: totrans-61
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***级别 1：接收器***'
- en: Threat identification at Level 1 focuses more on the connections of each piece
    rather than connections that might be made directly to an input. The vulnerabilities
    that we posit at this level relate to vulnerabilities that affect what connects
    to the devices in a vehicle.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 级别 1 的威胁识别更侧重于每个部分的连接，而不是可能直接连接到输入的连接。我们在这一层所假设的漏洞，涉及影响与车辆设备连接的那些部分。
- en: We’ll break these down into threat groupings that relate to cellular, Wi-Fi,
    key fob (KES), tire pressure monitor sensor (TPMS), infotainment console, USB,
    Bluetooth, and controller area network (CAN) bus connections. As you can see in
    the following lists, there are many potential ways into a vehicle.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将这些威胁分解为与蜂窝网络、Wi-Fi、钥匙扣（KES）、轮胎压力监测传感器（TPMS）、信息娱乐控制台、USB、蓝牙和控制器局域网（CAN）总线连接相关的威胁分组。如你在以下列表中所见，进入车辆的潜在方式有很多。
- en: '**Cellular**'
  id: totrans-64
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**蜂窝网络**'
- en: 'An attacker could exploit the cellular connection in a vehicle to:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可能会利用车辆中的蜂窝网络连接来：
- en: • Access the internal vehicle network from anywhere
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: • 从任何地方访问车辆的内部网络
- en: • Exploit the application in the infotainment unit that handles incoming calls
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: • 利用信息娱乐单元中处理来电的应用程序
- en: • Access the subscriber identity module (SIM) through the infotainment unit
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: • 通过信息娱乐单元访问用户身份模块（SIM）
- en: • Use a cellular network to connect to the remote diagnostic system (OnStar)
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: • 利用蜂窝网络连接到远程诊断系统（如 OnStar）
- en: • Eavesdrop on cellular communications
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: • 窃听蜂窝通信
- en: • Jam distress calls
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: • 干扰求救呼叫
- en: • Track the vehicle’s movements
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: • 跟踪车辆的运动
- en: • Set up a fake Global System for Mobile Communications (GSM) base station
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: • 设置一个伪造的全球移动通信系统（GSM）基站
- en: '**Wi-Fi**'
  id: totrans-74
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**Wi-Fi**'
- en: 'An attacker could exploit the Wi-Fi connection to:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以利用Wi-Fi连接来：
- en: • Access the vehicle network from up to 300 yards away or more
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: • 从300码（约274米）或更远的距离访问车辆网络
- en: • Find an exploit for the software that handles incoming connections
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: • 找到处理传入连接的软件漏洞
- en: • Install malicious code on the infotainment unit
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: • 在娱乐信息单元上安装恶意代码
- en: • Break the Wi-Fi password
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: • 破解Wi-Fi密码
- en: • Set up a fake dealer access point to trick the vehicle into thinking it’s
    being serviced
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: • 设置假冒经销商接入点，欺骗车辆以为正在接受服务
- en: • Intercept communications passing through the Wi-Fi network
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: • 截取通过Wi-Fi网络传输的通信
- en: • Track the vehicle
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: • 跟踪车辆
- en: '**Key Fob**'
  id: totrans-83
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**钥匙扣**'
- en: 'An attacker could exploit the key fob connection to:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以利用钥匙扣连接来：
- en: • Send malformed key fob requests that put the vehicle’s immobilizer in an unknown
    state. (The immobilizer is supposed to keep the vehicle locked so it can’t be
    hotwired. We need to ensure that it maintains proper functionality.)
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: • 发送格式错误的钥匙扣请求，将车辆的防盗系统置于未知状态。（防盗系统应确保车辆处于锁定状态，防止被改装。我们需要确保其保持正常功能。）
- en: • Actively probe an immobilizer to drain the car battery
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: • 主动探测防盗系统以耗尽车载电池
- en: • Lock out a key
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: • 锁定钥匙
- en: • Capture cryptographic information leaked from the immobilizer during the handshake
    process
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: • 捕获在握手过程中从防盗系统泄露的加密信息
- en: • Brute-force the key fob algorithm
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: • 暴力破解钥匙扣算法
- en: • Clone the key fob
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: • 克隆钥匙扣
- en: • Jam the key fob signal
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: • 干扰钥匙扣信号
- en: • Drain the power from the key fob
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: • 耗尽钥匙扣的电池电量
- en: '**Tire Pressure Monitor Sensor**'
  id: totrans-93
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**轮胎压力监测传感器**'
- en: 'An attacker could exploit the TPMS connection to:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以利用TPMS连接来：
- en: • Send an impossible condition to the engine control unit (ECU), causing a fault
    that could then be exploited
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: • 向发动机控制单元（ECU）发送不可能的条件，导致故障，从而可能被利用
- en: • Trick the ECU into overcorrecting for spoofed road conditions
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: • 欺骗ECU过度修正假冒的路况
- en: • Put the TPMS receiver or the ECU into an unrecoverable state that might cause
    a driver to pull over to check for a reported flat or that might even shut down
    the vehicle
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: • 使TPMS接收器或ECU进入无法恢复的状态，可能导致驾驶员停车检查报告的故障轮胎，甚至可能关闭车辆
- en: • Track a vehicle based on the TPMS unique IDs
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: • 根据TPMS唯一ID跟踪车辆
- en: • Spoof the TPMS signal to set off internal alarms
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: • 假冒TPMS信号，引发内部警报
- en: '**Infotainment Console**'
  id: totrans-100
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**娱乐信息控制台**'
- en: 'An attacker could exploit the infotainment console connection to:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以利用娱乐信息控制台连接来：
- en: • Put the console into debug mode
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: • 将控制台置于调试模式
- en: • Alter diagnostic settings
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: • 修改诊断设置
- en: • Find an input bug that causes unexpected results
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: • 找到导致意外结果的输入漏洞
- en: • Install malware to the console
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: • 向控制台安装恶意软件
- en: • Use a malicious application to access the internal CAN bus network
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: • 使用恶意应用程序访问内部CAN总线网络
- en: • Use a malicious application to eavesdrop on actions taken by vehicle occupants
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: • 使用恶意应用程序窃听车辆乘员的操作
- en: • Use a malicious application to spoof data displayed to the user, such as the
    vehicle location
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: • 使用恶意应用程序假冒显示给用户的数据，如车辆位置
- en: '**USB**'
  id: totrans-109
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**USB**'
- en: 'An attacker could use a USB port connection to:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以利用USB端口连接来：
- en: • Install malware on the infotainment unit
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: • 在娱乐信息单元上安装恶意软件
- en: • Exploit a flaw in the USB stack of the infotainment unit
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: • 利用娱乐信息单元USB堆栈中的漏洞
- en: • Attach a malicious USB device with specially crafted files designed to break
    importers on the infotainment unit, such as the address book and MP3 decoders
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: • 连接带有特别制作文件的恶意USB设备，设计用来破坏娱乐信息单元上的导入器，如通讯录和MP3解码器
- en: • Install modified update software on the vehicle
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: • 在车辆上安装修改过的更新软件
- en: • Short the USB port, thus damaging the infotainment system
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: • 短路USB端口，从而损坏娱乐信息系统
- en: '**Bluetooth**'
  id: totrans-116
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**蓝牙**'
- en: 'An attacker could use a Bluetooth connection to:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以利用蓝牙连接来：
- en: • Execute code on the infotainment unit
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: • 在娱乐信息单元上执行代码
- en: • Exploit a flaw in the Bluetooth stack of the infotainment unit
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: • 利用娱乐信息单元蓝牙堆栈中的漏洞
- en: • Upload malformed information, such as a corrupted address book designed to
    execute code
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: • 上传格式错误的信息，例如设计用于执行代码的损坏通讯录
- en: • Access the vehicle from close ranges (less than 300 feet)
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: • 从近距离（300英尺以内）访问车辆
- en: • Jam the Bluetooth device
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: • 干扰蓝牙设备
- en: '**Controller Area Network**'
  id: totrans-123
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**控制器局域网络**'
- en: 'An attacker could exploit the CAN bus connection to:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以利用CAN总线连接来：
- en: • Install a malicious diagnostic device to send packets to the CAN bus
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: • 安装恶意诊断设备向CAN总线发送数据包
- en: • Plug directly in to a CAN bus to attempt to start a vehicle without a key
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: • 可直接插入 CAN 总线，尝试在没有钥匙的情况下启动车辆
- en: • Plug directly in to a CAN bus to upload malware
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: • 可直接插入 CAN 总线以上传恶意软件
- en: • Install a malicious diagnostic device to track the vehicle
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: • 安装恶意诊断设备以追踪车辆
- en: • Install a malicious diagnostic device to enable remote communications directly
    to the CAN bus, making a normally internal attack now an external threat
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: • 安装恶意诊断设备直接连接到 CAN 总线，启用远程通信，将原本内部的攻击变成外部威胁
- en: '***Level 2: Receiver Breakdown***'
  id: totrans-130
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***级别 2：接收器故障***'
- en: At Level 2, we can talk more about identifying specific threats. As we look
    at exactly which application handles which connection, we can start to perform
    validation based on possible threats.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 在级别 2，我们可以进一步讨论如何识别特定的威胁。通过查看具体的应用程序处理了哪些连接，我们可以开始根据可能的威胁执行验证。
- en: 'We’ll break up threats into five groups: Bluez (the Bluetooth daemon), the
    wpa_supplicant (the Wi-Fi daemon), HSI (high-speed synchronous interface cellular
    kernel module), udev (kernel device manager), and the Kvaser driver (CAN transceiver
    driver). In the following lists, I’ve specified threats to each program.'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将把威胁分为五个组：Bluez（蓝牙守护进程）、wpa_supplicant（Wi-Fi 守护进程）、HSI（高速同步接口蜂窝内核模块）、udev（内核设备管理器）和
    Kvaser 驱动程序（CAN 收发器驱动程序）。在以下列表中，我已指定了每个程序的威胁。
- en: '**Bluez**'
  id: totrans-133
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**Bluez**'
- en: 'Older or unpatched versions of the Bluez daemon:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 旧版或未打补丁的 Bluez 守护进程：
- en: • May be exploitable
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: • 可能存在可利用的漏洞
- en: • May be unable to handle corrupt address books
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: • 可能无法处理损坏的地址簿
- en: • May not be configured to ensure proper encryption
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: • 可能没有配置以确保适当的加密
- en: • May not be configured to handle secure handshaking
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: • 可能未配置以处理安全握手
- en: • May use default passkeys
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: • 可能使用默认密码
- en: '**wpa_supplicant**'
  id: totrans-140
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**wpa_supplicant**'
- en: • Older versions may be exploitable
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: • 旧版本可能存在可利用的漏洞
- en: • May not enforce proper WPA2 style wireless encryption
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: • 可能没有强制执行适当的 WPA2 样式无线加密
- en: • May connect to malicious access points
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: • 可能连接到恶意接入点
- en: • May leak information on the driver via BSSID (network interface)
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: • 可能通过 BSSID（网络接口）泄露驱动程序信息
- en: '**HSI**'
  id: totrans-145
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**HSI**'
- en: • Older versions may be exploitable
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: • 旧版本可能存在可利用的漏洞
- en: • May be susceptible to injectable serial communication (man-in-the-middle attacks
    in which the attacker inserts serial commands into the data stream)
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: • 可能容易受到可注入的串行通信（中间人攻击，其中攻击者将串行命令插入数据流）攻击
- en: '**udev**'
  id: totrans-148
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**udev**'
- en: • Older, unpatched versions may be susceptible to attack
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: • 旧版、未打补丁的版本可能容易受到攻击
- en: • May not have a maintained whitelist of devices, allowing an attacker to load
    additional drivers or USB devices that were not tested or intended for use
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: • 可能没有维护的设备白名单，允许攻击者加载未测试或不打算使用的附加驱动程序或 USB 设备
- en: • May allow an attacker to load foreign devices, such as a keyboard to access
    the infotainment system
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: • 可能允许攻击者加载外部设备，例如键盘，以访问娱乐信息系统
- en: '**Kvaser Driver**'
  id: totrans-152
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**Kvaser 驱动程序**'
- en: • Older, unpatched versions may be exploitable
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: • 旧版、未打补丁的版本可能存在可利用的漏洞
- en: • May allow an attacker to upload malicious firmware to the Kvaser device
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: • 可能允许攻击者向 Kvaser 设备上传恶意固件
- en: These lists of potential vulnerabilities are by no means exhaustive, but they
    should give you an idea of how this brainstorming session works. If you were to
    go to a Level 3 map of potential threats to your vehicle, you would pick one of
    the processes, like HSI, and start to look at its kernel source to identify sensitive
    methods and dependencies that might be vulnerable to attack.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 这些潜在漏洞列表绝不是详尽无遗的，但它们应该能让你了解这一头脑风暴过程是如何进行的。如果你要查看车辆潜在威胁的三级地图，你将选择其中一个过程，如 HSI，并开始查看其内核源代码，以识别可能容易受到攻击的敏感方法和依赖项。
- en: '**Threat Rating Systems**'
  id: totrans-156
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**威胁评级系统**'
- en: Having documented many of our threats, we can now rate them with a risk level.
    Common rating systems include DREAD, ASIL, and MIL-STD-882E. DREAD is commonly
    used in web testing, while the automotive industry and government use ISO 26262
    ASIL and MIL-STD-882E, respectively, for threat rating. Unfortunately, ISO 26262
    ASIL and MIL-STD-882E are focused on safety failures and are not adequate to handle
    malicious threats. More details on these standards can be found at *[http://opengarages.org/index.php/Policies_and_Guidelines](http://opengarages.org/index.php/Policies_and_Guidelines)*.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 在记录了许多威胁之后，我们现在可以根据风险等级对它们进行评分。常见的评分系统包括 DREAD、ASIL 和 MIL-STD-882E。DREAD 常用于网页测试，而汽车行业和政府则分别使用
    ISO 26262 ASIL 和 MIL-STD-882E 进行威胁评分。不幸的是，ISO 26262 ASIL 和 MIL-STD-882E 聚焦于安全故障，并不足以应对恶意威胁。关于这些标准的更多细节可以参考
    *[http://opengarages.org/index.php/Policies_and_Guidelines](http://opengarages.org/index.php/Policies_and_Guidelines)*。
- en: '***The DREAD Rating System***'
  id: totrans-158
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***DREAD 评分系统***'
- en: 'DREAD stands for the following:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: DREAD 代表以下内容：
- en: '**Damage potential** How great is the damage?'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '**损害潜力** 损害的程度有多大？'
- en: '**Reproducibility** How easy is it to reproduce?'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '**可重复性** 复现的难易程度如何？'
- en: '**Exploitability** How easy is it to attack?'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: '**可利用性** 攻击的难易程度如何？'
- en: '**Affected users** How many users are affected?'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '**受影响用户** 有多少用户受到影响？'
- en: '**Discoverabilty** How easy is it to find the vulnerability?'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: '**可发现性** 漏洞容易被发现吗？'
- en: '[Table 1-1](ch01.html#ch1tab1) lists the risk levels from 1 to 3 for each rating
    category.'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: '[表 1-1](ch01.html#ch1tab1) 列出了每个评级类别的风险等级（从 1 到 3）。'
- en: '**Table 1-1:** DREAD Rating System'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '**表 1-1：** DREAD 评分系统'
- en: '|  | **Rating category** | **High (3)** | **Medium (2)** | **Low (1)** |'
  id: totrans-167
  prefs: []
  type: TYPE_TB
  zh: '|  | **评级类别** | **高 (3)** | **中 (2)** | **低 (1)** |'
- en: '| --- | --- | --- | --- | --- |'
  id: totrans-168
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- |'
- en: '| **D** | Damage potential | Could subvert the security system and gain full
    trust, ultimately taking over the environment | Could leak sensitive information
    | Could leak trivial information |'
  id: totrans-169
  prefs: []
  type: TYPE_TB
  zh: '| **D** | 损害潜力 | 可能颠覆安全系统并获得完全信任，最终接管环境 | 可能泄露敏感信息 | 可能泄露无关紧要的信息 |'
- en: '| **R** | Reproducibility | Is always reproducible | Can be reproduced only
    during a specific condition or window of time | Is very difficult to reproduce,
    even given specific information about the vulnerability |'
  id: totrans-170
  prefs: []
  type: TYPE_TB
  zh: '| **R** | 可重复性 | 总是可以复现 | 仅在特定条件或时间窗口下可复现 | 即使提供有关漏洞的具体信息，也很难复现 |'
- en: '| **E** | Exploitability | Allows a novice attacker to execute the exploit
    | Allows a skilled attacker to create an attack that could be used repeatedly
    | Allows only a skilled attacker with in-depth knowledge to perform the attack
    |'
  id: totrans-171
  prefs: []
  type: TYPE_TB
  zh: '| **E** | 可利用性 | 允许新手攻击者执行该漏洞利用 | 允许熟练的攻击者创建一个可以反复使用的攻击 | 仅允许具备深入知识的熟练攻击者执行攻击
    |'
- en: '| **A** | Affected users | Affects all users, including the default setup user
    and key customers | Affects some users or specific setups | Affects a very small
    percentage of users; typically affects an obscure feature |'
  id: totrans-172
  prefs: []
  type: TYPE_TB
  zh: '| **A** | 受影响用户 | 影响所有用户，包括默认设置用户和关键客户 | 影响部分用户或特定设置 | 仅影响极少数用户；通常影响一个不常用的功能
    |'
- en: '| **D** | Discoverability | Can be easily found in a published explanation
    of the attack | Affects a seldom-used part, meaning an attacker would need to
    be very creative to discover a malicious use for it | Is obscure, meaning it’s
    unlikely attackers would find a way to exploit it |'
  id: totrans-173
  prefs: []
  type: TYPE_TB
  zh: '| **D** | 可发现性 | 可以在公开的攻击说明中轻松找到 | 影响一个很少使用的部分，意味着攻击者需要非常有创意才能发现其恶意用途 | 很难被发现，意味着攻击者不太可能找到利用它的方式
    |'
- en: 'Now we can apply each DREAD category from [Table 1-1](ch01.html#ch1tab1) to
    an identified threat from earlier in the chapter and score the threat from low
    to high (1–3). For instance, if we take the Level 2 HSI threats discussed in “[Level
    2: Receiver Breakdown](ch01.html#ch01lev2sec3)” on [page 10](ch01.html#page_10),
    we can come up with threat ratings like the ones shown in [Table 1-2](ch01.html#ch1tab2).'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '现在我们可以将前面章节中识别的威胁与 [表 1-1](ch01.html#ch1tab1) 中的每个 DREAD 类别进行匹配，并根据威胁的高低进行评分（1-3）。例如，如果我们查看在
    “[Level 2: Receiver Breakdown](ch01.html#ch01lev2sec3)” 中讨论的 Level 2 HSI 威胁，位于
    [第10页](ch01.html#page_10)，我们可以得出如 [表 1-2](ch01.html#ch1tab2) 所示的威胁评分。'
- en: '**Table 1-2:** HSI Level 2 Threats with DREAD Scores'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: '**表 1-2：** HSI Level 2 威胁与 DREAD 评分'
- en: '| **HSI threats** | **D** | **R** | **E** | **A** | **D** | **Total** |'
  id: totrans-176
  prefs: []
  type: TYPE_TB
  zh: '| **HSI 威胁** | **D** | **R** | **E** | **A** | **D** | **总计** |'
- en: '| --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-177
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- |'
- en: '| An older, unpatched version of HSI that may be exploitable | 3 | 3 | 2 |
    3 | 3 | 14 |'
  id: totrans-178
  prefs: []
  type: TYPE_TB
  zh: '| 一个可能被利用的老旧未打补丁的 HSI 版本 | 3 | 3 | 2 | 3 | 3 | 14 |'
- en: '| An HSI that may be susceptible to injectable serial communication | 2 | 2
    | 2 | 3 | 3 | 12 |'
  id: totrans-179
  prefs: []
  type: TYPE_TB
  zh: '| 可能容易受到注入串行通信攻击的 HSI | 2 | 2 | 2 | 3 | 3 | 12 |'
- en: You can identify the overall rating by using the values in the Total column,
    as shown in [Table 1-3](ch01.html#ch1tab3).
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过使用总计栏中的数值来识别整体评分，如 [表格 1-3](ch01.html#ch1tab3) 所示。
- en: '**Table 1-3:** DREAD Risk Scoring Chart'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: '**表格 1-3：** DREAD 风险评分表'
- en: '| **Total** | **Risk level** |'
  id: totrans-182
  prefs: []
  type: TYPE_TB
  zh: '| **总计** | **风险等级** |'
- en: '| --- | --- |'
  id: totrans-183
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| 5–7 | Low |'
  id: totrans-184
  prefs: []
  type: TYPE_TB
  zh: '| 5–7 | 低 |'
- en: '| 8–11 | Medium |'
  id: totrans-185
  prefs: []
  type: TYPE_TB
  zh: '| 8–11 | 中等 |'
- en: '| 12–15 | High |'
  id: totrans-186
  prefs: []
  type: TYPE_TB
  zh: '| 12–15 | 高 |'
- en: When performing a risk assessment, it’s good practice to leave the scoring results
    visible so that the person reading the results can better understand the risks.
    In the case of the HSI threats, we can assign high risk to each of these threats,
    as shown in [Table 1-4](ch01.html#ch1tab4).
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行风险评估时，最好将评分结果保持可见，以便读者能够更好地理解风险。在 HSI 威胁的情况下，我们可以为每个威胁分配高风险，如 [表格 1-4](ch01.html#ch1tab4)
    所示。
- en: '**Table 1-4:** HSI Level 2 Threats with DREAD Risk Levels Applied'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: '**表格 1-4：** 应用 DREAD 风险等级的 HSI 2级威胁'
- en: '| **HSI threats** | **D** | **R** | **E** | **A** | **D** | **Total** | **Risk**
    |'
  id: totrans-189
  prefs: []
  type: TYPE_TB
  zh: '| **HSI 威胁** | **D** | **R** | **E** | **A** | **D** | **总计** | **风险** |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-190
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- |'
- en: '| An older, unpatched version of HSI that may be exploitable | 3 | 3 | 2 |
    3 | 3 | 14 | High |'
  id: totrans-191
  prefs: []
  type: TYPE_TB
  zh: '| 可能存在漏洞且未修补的旧版 HSI | 3 | 3 | 2 | 3 | 3 | 14 | 高 |'
- en: '| An HSI that may be susceptible to injectable serial communication | 2 | 2
    | 2 | 3 | 3 | 12 | High |'
  id: totrans-192
  prefs: []
  type: TYPE_TB
  zh: '| 可能容易受到注入串行通信攻击的 HSI | 2 | 2 | 2 | 3 | 3 | 12 | 高 |'
- en: Although both risks are marked as high, we can see that the older version of
    the HSI model poses a slightly higher risk than do the injectable serial attacks,
    so we can make it a priority to address this risk first. We can also see that
    the reason why the injectable serial communication risk is lower is that the damage
    is less severe and the exploit is harder to reproduce than that of an old version
    of HSI.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管这两种风险都标记为高风险，但我们可以看到旧版 HSI 模型的风险略高于可注入串行攻击，因此我们可以优先处理这个风险。我们还可以看到，注入串行通信风险较低的原因是其破坏程度较轻，而且其利用难度比旧版
    HSI 更高。
- en: '***CVSS: An Alternative to DREAD***'
  id: totrans-194
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***CVSS：DREAD 的替代方案***'
- en: 'If DREAD isn’t detailed enough for you, consider the more detailed risk methodology
    known as the *common vulnerability scoring system (CVSS)*. CVSS offers many more
    categories and details than DREAD in three groups: base, temporal, and environmental.
    Each group is subdivided into sub areas—six for base, three for temporal, and
    five for environmental—for a total of 14 scoring areas! (For detailed information
    on how CVSS works, see *[http://www.first.org/cvss/cvss-guide](http://www.first.org/cvss/cvss-guide)*.)'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 DREAD 对你来说不够详细，可以考虑更详细的风险评估方法，称为 *通用漏洞评分系统（CVSS）*。与 DREAD 相比，CVSS 提供了更多的分类和细节，分为三个组：基础、时间和环境。每个组进一步细分为子领域——基础组有六个，时间组有三个，环境组有五个，总共有
    14 个评分领域！（有关 CVSS 如何工作的详细信息，请参阅 *[http://www.first.org/cvss/cvss-guide](http://www.first.org/cvss/cvss-guide)*。）
- en: '**NOTE**'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*While we could use ISO 26262 ASIL or MIL-STD-882E when rating threats, we
    want more detail than just Risk = Probability × Severity. If you have to pick
    between these two systems for a security review, go with MIL-STD-882E from the
    Department of Defense (DoD). The Automotive Safety Integrity Level (ASIL) system
    will too often have a risk fall into the QM ranking, which basically translates
    to “meh.” The DoD’s system tends to result in a higher ranking, which equates
    to a higher value for the cost of a life. Also, MIL-STD-882E is designed to be
    applied throughout the life cycle of a system, including disposal, which is a
    nice fit with a secure development life cycle.*'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: '*虽然我们可以使用 ISO 26262 ASIL 或 MIL-STD-882E 来评估威胁，但我们需要比“风险 = 概率 × 严重性”更详细的信息。如果你在进行安全审查时必须在这两种系统中选择一个，建议选择美国国防部（DoD）的
    MIL-STD-882E。汽车安全完整性等级（ASIL）系统过于频繁地将风险评为 QM 等级，基本上意味着“无关紧要”。而 DoD 系统则更倾向于给出较高的排名，等同于更高的生命价值。此外，MIL-STD-882E
    设计用于贯穿系统生命周期的应用，包括处置，且与安全开发生命周期很好契合。*'
- en: '**Working with Threat Model Results**'
  id: totrans-198
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**与威胁模型结果的合作**'
- en: At this point, we have a layout of many of the potential threats to our vehicle,
    and we have them ranked by risk. Now what? Well, that depends on what team you’re
    on. To use military jargon, the attacker side is the “red team,” and the defender
    side is the “blue team.” If you’re on the red team, your next step is to start
    attacking the highest risk areas that are likely to have the best chance of success.
    If you’re on the blue team, go back to your risk chart and modify each threat
    with a countermeasure.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经列出了许多潜在的威胁，并按照风险对它们进行了排序。那么接下来呢？这取决于你所在的团队。如果使用军事术语，攻击方是“红队”，防守方是“蓝队”。如果你在红队，你的下一步是开始攻击那些风险最高且最有可能成功的区域。如果你在蓝队，回到风险图表，针对每个威胁采取相应的对策。
- en: For example, if we were to take the two risks in “[The DREAD Rating System](ch01.html#ch01lev2sec7)”
    on [page 11](ch01.html#page_11), we could add a countermeasure section to each.
    [Table 1-5](ch01.html#ch1tab5) includes the countermeasure for the HSI code execution
    risk, and [Table 1-6](ch01.html#ch1tab6) includes the countermeasure for the risk
    of HSI interception.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果我们以“[DREAD 评级系统](ch01.html#ch01lev2sec7)”中第11页的两个风险为例，我们可以为每个风险添加一个对策部分。[表
    1-5](ch01.html#ch1tab5)包含了 HSI 代码执行风险的对策，而[表 1-6](ch01.html#ch1tab6)则包含了 HSI 截取风险的对策。
- en: '**Table 1-5:** HSI Code Execution Risk'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: '**表 1-5:** HSI 代码执行风险'
- en: '| **Threat** | **Executes code in the kernel space** |'
  id: totrans-202
  prefs: []
  type: TYPE_TB
  zh: '| **威胁** | **在内核空间执行代码** |'
- en: '| --- | --- |'
  id: totrans-203
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| Risk | High |'
  id: totrans-204
  prefs: []
  type: TYPE_TB
  zh: '| 风险 | 高 |'
- en: '| Attack technique | Exploit vulnerability in older versions of HSI |'
  id: totrans-205
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 利用 HSI 的旧版本漏洞 |'
- en: '| Countermeasures | Kernel and kernel modules should be updated with the latest
    kernel releases |'
  id: totrans-206
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | 应该用最新的内核版本更新内核及内核模块 |'
- en: '**Table 1-6:** Intercepting HSI Commands'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: '**表 1-6:** 截取 HSI 命令'
- en: '| **Threat** | **Intercepts and injects commands from the cellular network**
    |'
  id: totrans-208
  prefs: []
  type: TYPE_TB
  zh: '| **威胁** | **截取并注入来自蜂窝网络的命令** |'
- en: '| --- | --- |'
  id: totrans-209
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| Risk | High |'
  id: totrans-210
  prefs: []
  type: TYPE_TB
  zh: '| 风险 | 高 |'
- en: '| Attack technique | Intercept serial communications over HSI |'
  id: totrans-211
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 截取 HSI 上的串行通信 |'
- en: '| Countermeasures | All commands sent over cellular are cryptographically signed
    |'
  id: totrans-212
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | 所有通过蜂窝网络发送的命令都经过加密签名 |'
- en: Now you have a documented list of high-risk vulnerabilities with solutions.
    You can prioritize any solutions not currently implemented based on the risk of
    not implementing that solution.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经有了一份包含高风险漏洞和解决方案的文档。你可以根据未实施该解决方案的风险，优先考虑那些尚未实现的解决方案。
- en: '**Summary**'
  id: totrans-214
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**总结**'
- en: In this chapter you learned the importance of using threat models to identify
    and document your security posture, and of getting both technical and nontechnical
    people to brainstorm possible scenarios. We then drilled down into these scenarios
    to identify all potential risks. Using a scoring system, we ranked and categorized
    each potential risk. After assessing threats in this way, we ended up with a document
    that defined our current product security posture, any countermeasure currently
    in place, and a task list of high-priority items that still need to be addressed.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你学习了使用威胁模型来识别和记录你的安全姿态的重要性，并且需要让技术人员和非技术人员一起头脑风暴可能的场景。接着我们深入分析了这些场景，以识别所有潜在的风险。通过打分系统，我们对每个潜在风险进行了排名和分类。通过这种方式评估威胁后，我们最终得到了一个文档，定义了我们当前的产品安全姿态、已实施的任何对策，以及仍需处理的高优先级任务列表。
