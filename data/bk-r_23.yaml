- en: '**19**'
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**19**'
- en: '**ANALYSIS OF VARIANCE**'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '**方差分析**'
- en: '![image](../images/common-01.jpg)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/common-01.jpg)'
- en: '*Analysis of variance (ANOVA)*, in its simplest form, is used to compare multiple
    means in a test for equivalence. In that sense, it’s a straightforward extension
    of the hypothesis test comparing two means. There’s a continuous variable from
    which the means of interest are calculated, and there’s at least one categorical
    variable that tells you how to define the groups for those means. In this chapter,
    you’ll explore the ideas surrounding ANOVA and look at comparing means first split
    by one categorical variable (one-way ANOVA) and then split by multiple categorical
    variables (multiple-factor ANOVA).'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '*方差分析（ANOVA）*，其最简单的形式，用于比较多个均值是否相等的检验。从这个意义上讲，它是对比两个均值的假设检验的直接扩展。这里有一个连续变量，通过它计算出感兴趣的均值，且至少有一个分类变量告诉你如何为这些均值定义组。在本章中，你将探索关于方差分析的相关概念，首先看看通过一个分类变量（单向ANOVA）划分组的均值比较，然后再看看通过多个分类变量（多因素ANOVA）划分组的均值比较。'
- en: '**19.1 One-Way ANOVA**'
  id: totrans-4
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**19.1 单向ANOVA**'
- en: The simplest version of ANOVA is referred to as *one-way* or *one-factor* analysis.
    Simply put, the one-way ANOVA is used to test two or more means for equality.
    Those means are split by a categorical *group* or *factor* variable. ANOVA is
    often used to analyze experimental data to assess the impact of an intervention.
    You might, for example, be interested in comparing the mean weights of the chicks
    in the built-in `chickwts` data set, split according to the different food types
    they were fed.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 最简单版本的方差分析（ANOVA）被称为*单因素*或*单向*分析。简而言之，单向ANOVA用于检验两个或更多均值是否相等。这些均值通过一个分类的*组*或*因子*变量来划分。方差分析通常用于分析实验数据，以评估干预措施的影响。例如，你可能有兴趣比较内置`chickwts`数据集中，按照它们所喂食的不同食物类型划分的小鸡的平均体重。
- en: '***19.1.1 Hypotheses and Diagnostic Checking***'
  id: totrans-6
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***19.1.1 假设与诊断检查***'
- en: 'Say you have a categorical-nominal variable that splits a total of *N* numeric
    observations into *k* distinct groups, where *k* ≥ 2\. You’re looking to statistically
    compare the *k* groups’ means, *μ[1]*,...,*μ[k]*, to see whether they can be claimed
    to be equal. The standard hypotheses are as follows:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你有一个分类的名义型变量，它将总共*N*个数值型观测分为*k*个不同的组，其中*k* ≥ 2。你想要统计地比较这*k*个组的均值，*μ[1]*,...,*μ[k]*，看看它们是否可以声称是相等的。标准的假设如下：
- en: 'H[0] : *μ[1]* = *μ[2]* = ... = *μ[k]*'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[0] : *μ[1]* = *μ[2]* = ... = *μ[k]*'
- en: 'H[A] : *μ[1]*, *μ[2]*, ... , *μ[k]* are not all equal'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[A] : *μ[1]*, *μ[2]*, ... , *μ[k]* 并不相等'
- en: (alternatively, at least one mean differs).
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: （或者，至少有一个均值不同）。
- en: In fact, when *k* = 2, the two-sample *t*-test is equivalent to ANOVA; for that
    reason, ANOVA is most frequently employed when *k* > 2.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，当*k* = 2时，两样本*t*检验等同于方差分析；因此，方差分析最常用于*k* > 2的情况。
- en: 'The following assumptions need to be satisfied in order for the results of
    the basic one-way ANOVA test to be considered reliable:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使基本的单向ANOVA测试结果被认为是可靠的，以下假设需要满足：
- en: '**Independence** The samples making up the *k* groups must be independent of
    one another, and the observations in each group must be independent and identically
    distributed (iid).'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '**独立性** 组成*k*组的样本必须相互独立，每个组中的观测值必须是独立且同分布的（iid）。'
- en: '**Normality** The observations in each group should be normally distributed,
    or at least approximately so.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '**正态性** 每个组中的观测值应该服从正态分布，或者至少是大致如此。'
- en: '**Equality of variances** The variance of the observations in each group should
    be equal, or at least approximately so.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '**方差齐性** 每个组中的观测值方差应该相等，或者至少是大致相等的。'
- en: If the assumptions of equality of variances or normality are violated, it doesn’t
    necessarily mean your results will be completely worthless, but it will impact
    the overall effectiveness of detecting a true difference in the means (refer to
    the discussion on statistical power in [Section 18.5.4](ch18.xhtml#ch18lev2sec167)).
    It’s always a good idea to assess the validity of these assumptions before using
    ANOVA; I’ll do this informally for the upcoming example.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 如果方差齐性或正态性假设被违反，这并不意味着你的结果完全没有价值，但会影响检测均值差异的整体有效性（请参阅[第18.5.4节](ch18.xhtml#ch18lev2sec167)关于统计功效的讨论）。在使用ANOVA之前，评估这些假设的有效性始终是个好主意；我将在接下来的示例中非正式地进行这种评估。
- en: It’s also worth noting that you don’t need to have an equal number of observations
    in each group to perform the test (in which case it is referred to as *unbalanced*).
    However, having unbalanced groups does render the test more sensitive to potentially
    detrimental effects if your assumptions of equality of variances and normality
    are not sound.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 另外值得注意的是，进行检验时，组内观察值数量不必完全相等（此时称为*不平衡*）。然而，组不平衡会使检验对方差相等性和正态性假设不成立时产生潜在不利影响时更加敏感。
- en: 'Let’s return to the `chickwts` data for the example—the weights of chicks based
    on *k* = 6 different feeds. You’re interested in comparing the mean weights according
    to feed type to see whether they’re all equal. Use `table` to summarize the six
    sample sizes and use `tapply` (see, for example, [Section 13.2.1](ch13.xhtml#ch13lev2sec116))
    to get each group mean, as follows:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们回到`chickwts`数据作为本例——这是根据* k * = 6种不同饲料的小鸡体重数据。你希望比较不同饲料类型下的均值体重，看看它们是否相等。使用`table`来总结六个样本的大小，使用`tapply`（例如参见[第13.2.1节](ch13.xhtml#ch13lev2sec116)）来获取每个组的均值，如下所示：
- en: '[PRE0]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Your skills from [Section 14.3.2](ch14.xhtml#ch14lev2sec125) allow you to produce
    side-by-side box-plots of the distributions of weights. The next two lines give
    you the plot on the left of [Figure 19-1](ch19.xhtml#ch19fig1):'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 你在[第14.3.2节](ch14.xhtml#ch14lev2sec125)中的技能使你能够生成并排显示的箱形图，比较不同喂养方式下的小鸡体重分布。接下来的两行代码将生成[图19-1](ch19.xhtml#ch19fig1)左侧的图表：
- en: '[PRE1]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '![image](../images/f19-01.jpg)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f19-01.jpg)'
- en: '*Figure 19-1: Exploring the* `chickwts` *data. Left: Side-by-side boxplots
    of chick weight split by feed type, with the mean marked by* ×*. Right: Normal
    QQ plot of the mean-centered data of each feed group.*'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '*图19-1：探索* `chickwts` *数据。左图：按饲料类型划分的小鸡体重并排箱形图，均值由* ×*标出。右图：每个饲料组的均值中心化数据的正态QQ图。*'
- en: Because boxplots display the median, not the mean, the second line of code adds
    the feed-specific means (stored in the `chick.means` object you just created)
    to each box using `points`.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 由于箱形图显示的是中位数而不是均值，第二行代码通过`points`将每个箱形图的喂养特定均值（存储在你刚刚创建的`chick.means`对象中）添加到箱形图中。
- en: 'Inspecting the left plot of [Figure 19-1](ch19.xhtml#ch19fig1), it certainly
    looks as though there’s a difference in the mean weights. Is any apparent difference
    statistically significant, though? To find out, the ANOVA test for this example
    concerns the following hypotheses:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 检查[图19-1](ch19.xhtml#ch19fig1)左侧的图表，显然看起来均值体重有所不同。然而，这种明显的差异是否具有统计学意义呢？为了弄清楚这一点，本例的方差分析（ANOVA）测试涉及以下假设：
- en: 'H[0] : *μ*[casein] = *μ*[horsebean] = *μ*[linseed] = *μ*[meatmeal] = *μ*[soybean]
    = *μ*[sunflower]'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[0] : *μ*[casein] = *μ*[horsebean] = *μ*[linseed] = *μ*[meatmeal] = *μ*[soybean]
    = *μ*[sunflower]'
- en: 'H[A] : The means are not all equal.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[A] : 均值不全相等。'
- en: 'Assuming independence of the data, before implementing the test, you must first
    check that the other assumptions are valid. To examine equality of variances,
    you can use the same informal rule of thumb as used in the two-sample *t*-test.
    That is, you can assume equality of variances if the ratio of the largest sample
    standard deviation to the smallest is less than 2\. For the chick weights data,
    the following code will determine this:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 假设数据独立，在执行测试之前，首先必须检查其他假设是否有效。为了检查方差是否相等，你可以使用与两样本*t*检验中相同的非正式经验法则。也就是说，如果最大样本标准差与最小样本标准差之比小于2，就可以假设方差相等。对于小鸡体重数据，以下代码将帮助你进行这一检查：
- en: '[PRE2]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This informal result indicates that it’s reasonable to make the assumption.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 这个非正式结果表明，做出这个假设是合理的。
- en: Next, consider the assumption of normality of the raw observations. This can
    be difficult to determine in many real-data examples. At the least, though, it’s
    worthwhile to inspect histograms and QQ plots for signs of non-normality. You
    already inspected histograms and QQ plots for all 71 weights in [Section 16.2.2](ch16.xhtml#ch16lev2sec142),
    but for an ANOVA, you need to do this with respect to the grouping of the observations
    (that is, not just “overall” for the whole set of weights regardless of groups).
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，考虑原始观测值的正态性假设。在许多真实数据的例子中，这可能很难确定。然而，至少值得检查直方图和QQ图，寻找非正态性的迹象。你已经在[第16.2.2节](ch16.xhtml#ch16lev2sec142)中检查了所有71个权重的直方图和QQ图，但对于方差分析（ANOVA），你需要针对观测值的分组进行此操作（也就是说，不仅仅是对所有权重的“总体”进行检查，而不考虑分组）。
- en: 'To achieve this for the `chickwts` data, you need to first *mean-center* each
    weight by its respective sample mean. You can do this by taking the original vector
    of weights and subtracting from it the `chick.means` vector, but first you must
    rearrange and replicate the latter elements to correspond to the elements in the
    former. This is done by using `as.numeric` on the factor vector that represents
    feed type, giving the numeric value of the levels of `chickwts$feed` for each
    record in the original data frame. When that numeric vector is passed via the
    square brackets to `chick.means`, you get the correct group mean matched to each
    observation. As an exercise, you can inspect all the ingredients that go into
    creating the following `chick.meancen` object to satisfy yourself of what’s going
    on:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 为了对`chickwts`数据进行此操作，你需要首先通过各自的样本均值*均值中心化*每个重量。你可以通过取原始的体重向量并从中减去`chick.means`向量来做到这一点，但首先你必须重新排列并复制后者的元素，以使其与前者的元素对应。这可以通过对表示饲料类型的因子向量使用`as.numeric`来完成，从而获得每条记录在原始数据框中`chickwts$feed`水平的数值。当将该数值向量通过方括号传递给`chick.means`时，你会得到正确的组均值与每个观察值匹配。作为练习，你可以检查创建以下`chick.meancen`对象所涉及的所有元素，以确保你理解其中的过程：
- en: '[PRE3]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: In the context of the current analysis, these group-wise, mean-centered values
    are also referred to as *residuals*, a term you’ll come across frequently when
    you study regression methods in the next few chapters.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在当前分析的背景下，这些按组均值中心化的值也被称为*残差*，这是你在接下来的几章中研究回归方法时经常会遇到的术语。
- en: You can now assess normality of the observations as a whole using the residuals.
    To inspect a normal QQ plot, the relevant functions are `qqnorm` and `qqline`,
    which you first met in [Section 16.2.2](ch16.xhtml#ch16lev2sec142). The following
    two lines produce the image on the right of [Figure 19-1](ch19.xhtml#ch19fig1).
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你可以使用残差评估整体观察值的正态性。要检查正态QQ图，相关的函数是`qqnorm`和`qqline`，你在[第16.2.2节](ch16.xhtml#ch16lev2sec142)中首次遇到这两个函数。以下两行代码生成[图19-1](ch19.xhtml#ch19fig1)右侧的图像。
- en: '[PRE4]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Based on this plot (the proximity of the plotted points to the perfect straight
    line), it doesn’t seem unreasonable to assume normality for these data, particularly
    when compared to QQ plots of generated normal data of the same sample size (an
    example was given on the left of [Figure 16-9](ch16.xhtml#ch16fig9) on [page 355](ch16.xhtml#page_355)).
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 基于这个图（绘制点与完美直线的接近程度），假设这些数据呈正态分布似乎是合理的，特别是当与相同样本大小的生成正态数据的QQ图进行比较时（一个例子在[图16-9](ch16.xhtml#ch16fig9)的左侧，[第355页](ch16.xhtml#page_355)提供了说明）。
- en: Investigating the validity of any required assumptions is referred to as *diagnostic
    checking*. If you wanted to perform a more rigorous diagnostic check for an ANOVA,
    other visual diagnostics could involve inspecting QQ plots split by group (you’ll
    do this in an example in [Section 19.3](ch19.xhtml#ch19lev1sec61)) or plotting
    the sample standard deviation for each group against the corresponding sample
    means. Indeed, there are also general hypothesis tests for normality (such as
    the Shapiro-Wilk test or Anderson-Darling test—you’ll see the former used in [Section
    22.3.2](ch22.xhtml#ch22lev2sec215)), as well as tests for equality of variances
    (such as Levene’s test), but I’ll stick with the basic rule of thumb and visual
    checks in this example.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 调查任何所需假设的有效性被称为*诊断检查*。如果你想对ANOVA进行更严格的诊断检查，其他的视觉诊断可能包括检查按组划分的QQ图（你将在[第19.3节](ch19.xhtml#ch19lev1sec61)的示例中进行此操作）或绘制每个组的样本标准差与对应样本均值的关系。实际上，也有一些通用的正态性假设检验（例如Shapiro-Wilk检验或Anderson-Darling检验——你将在[第22.3.2节](ch22.xhtml#ch22lev2sec215)中看到前者的使用），以及方差齐性检验（例如Levene检验），但在这个例子中，我将坚持使用基本的经验法则和视觉检查。
- en: '***19.1.2 One-Way ANOVA Table Construction***'
  id: totrans-39
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***19.1.2 单因素方差分析表构建***'
- en: Turning your attention back to the left of [Figure 19-1](ch19.xhtml#ch19fig1),
    remember that the goal is to statistically evaluate the equality of the means
    marked by ×. This task will therefore require you to consider not only the variability
    *within* each of the *k* samples but the variability *between* the samples; this
    is why the test is referred to as an analysis of variance.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 回到[图19-1](ch19.xhtml#ch19fig1)的左侧，记住，目标是统计地评估标记为×的均值是否相等。因此，这项任务需要你考虑的不仅是每个*k*样本*内部*的变异性，还需要考虑样本间的变异性；这就是为什么这个检验被称为方差分析。
- en: The test proceeds by first calculating various metrics associated with the overall
    variability and then calculating the within- and between-group variability. These
    figures involve sums of squared quantities and associated degrees of freedom values.
    All this culminates in a single test statistic and *p*-value targeting the aforementioned
    hypotheses. These ingredients are typically presented in a table, which is defined
    as follows.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 测试的过程首先通过计算与总体变异性相关的各种指标，然后计算组内和组间的变异性。这些数字涉及平方和量及其相关的自由度值。所有这些最终汇总成一个单一的检验统计量和*p*-值，针对上述假设。这些成分通常以表格的形式呈现，定义如下。
- en: Let *x*[1], ... , *x[N]* represent all *N* observations, regardless of group;
    let *x*[1][(][*j*][)], ... , *x[nj](j)* denote the specific group observations
    in group *j* = 1, ... , *k* such that *n[1]* + ... + *n[k]* = *N*. Let the “grand
    mean” of all observations be defined as ![image](../images/f0439-01.jpg). The
    ANOVA table is then constructed, where SS stands for sum-of-squares, df stands
    for degrees of freedom, MS stands for mean square, *F* refers to the *F* test
    statistic, and *p* refers to the *p*-value.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 设 *x*[1], ... , *x[N]* 代表所有的 *N* 次观察，无论是哪个组；设 *x*[1][(][*j*][)], ... , *x[nj](j)*
    表示第 *j* 组中的特定组观察，其中 *j* = 1, ... , *k*，且 *n[1]* + ... + *n[k]* = *N*。定义所有观察的“总体均值”为
    ![image](../images/f0439-01.jpg)。然后构建ANOVA表，其中SS代表平方和，df代表自由度，MS代表均方，*F*表示*F*检验统计量，*p*表示*p*-值。
- en: '|  | df | SS | MS | *F* | *p* |'
  id: totrans-43
  prefs: []
  type: TYPE_TB
  zh: '|  | df | SS | MS | *F* | *p* |'
- en: '| Overall | 1 | **(1)** |  |  |  |'
  id: totrans-44
  prefs: []
  type: TYPE_TB
  zh: '| 总体 | 1 | **(1)** |  |  |  |'
- en: '| Group (or “[Factor](ch04.xhtml#ch04lev1sec18)”) | *k* − 1 | **(2)** | **(5)**
    | **(5)÷(6)** | *p*-value |'
  id: totrans-45
  prefs: []
  type: TYPE_TB
  zh: '| 组（或“[因素](ch04.xhtml#ch04lev1sec18)”） | *k* − 1 | **(2)** | **(5)** | **(5)÷(6)**
    | *p*-值 |'
- en: '| Error (or “Residual”) | *N* − *k* | **(3)** | **(6)** |  |  |'
  id: totrans-46
  prefs: []
  type: TYPE_TB
  zh: '| 误差（或“残差”） | *N* − *k* | **(3)** | **(6)** |  |  |'
- en: '| TOTAL | *N* | **(4)** |  |  |  |'
  id: totrans-47
  prefs: []
  type: TYPE_TB
  zh: '| 总和 | *N* | **(4)** |  |  |  |'
- en: 'You calculate the values with these formulas:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用这些公式来计算数值：
- en: '*Nx̄*²'
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*Nx̄*²'
- en: '![image](../images/f0439-02.jpg)'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_IMG
  zh: '![image](../images/f0439-02.jpg)'
- en: '**(4)–(2)–(1)**'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**(4)–(2)–(1)**'
- en: '![image](../images/f0439-03.jpg)'
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_IMG
  zh: '![image](../images/f0439-03.jpg)'
- en: '**(2)**÷(*k* – 1)'
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**(2)** ÷ (*k* – 1)'
- en: '**(3)**÷(*N* – *k*)'
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**(3)** ÷ (*N* – *k*)'
- en: 'There are three input sources that are assumed to make up the observed data,
    which, when added together, result in the TOTAL row. Let’s think about these in
    a little more detail:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 假设有三个输入来源，它们构成了观察数据，当加在一起时，结果会得到总和行。让我们更详细地思考这些：
- en: '**Overall row** This relates to the scale on which the data as a whole sit.
    It doesn’t affect the outcome of the hypothesis test (since you’re interested
    only in the relative differences between means) and is sometimes removed from
    the table, affecting the TOTAL values accordingly.'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: '**总体行** 这与数据整体所在的尺度有关。它不会影响假设检验的结果（因为你只关心均值之间的相对差异），有时会从表格中移除，从而相应影响总和值。'
- en: '**Group row/Factor row** This relates to the data in the individual groups
    of interest, thereby accounting for the *between-group variability*.'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '**组行/因素行** 这与各个感兴趣组的数据相关，从而解释了*组间变异性*。'
- en: '**Error row/Residual row** This accounts for the random deviation from the
    estimated means of each group, thereby accounting for the *within-group variability*.'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '**误差行/残差行** 这解释了每个组的估计均值的随机偏差，从而解释了*组内变异性*。'
- en: '**TOTAL row** This represents the raw data, based on the previous three ingredients.
    It is used to find the Error SS by differencing.'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '**总和行** 这表示原始数据，基于前三个元素。通过差分计算误差SS。'
- en: The three input sources each have a corresponding degrees of freedom (df) value
    in the first column and a sum-of-squares (SS) value attached to the df in the
    second column. Between- and within-group variability is averaged by dividing the
    SS by the df, giving the mean squared (MS) component for these two items. The
    test statistic, *F*, is found by dividing the mean squared group (MSG) effect
    by the mean squared error (MSE) effect. This test statistic follows the *F*-distribution
    (refer to [Section 16.2.5](ch16.xhtml#ch16lev2sec145)), which itself requires
    a pair of degrees of freedom values ordered as df[1] (which represents the Group
    df, *k*−1) and df[2] (which represents the Error df, *N*−*k*). Like the chi-squared
    distribution, the *F*-distribution is unidirectional in nature, and the *p*-value
    is obtained as the upper-tail area from the test statistic *F*.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 三个输入源每个都在第一列有一个对应的自由度（df）值，并且在第二列附有一个与df相关的平方和（SS）值。组间和组内的变异性通过将平方和（SS）除以自由度（df）来平均，从而得到这两个项目的均方（MS）值。测试统计量*F*是通过将均方组（MSG）效应除以均方误差（MSE）效应来计算的。这个测试统计量遵循*F*-分布（参见[第16.2.5节](ch16.xhtml#ch16lev2sec145)），该分布需要一对自由度值，按df[1]（表示组别自由度，*k*−1）和df[2]（表示误差自由度，*N*−*k*）的顺序排列。像卡方分布一样，*F*-分布是单向的，并且*p*-值是从测试统计量*F*的上尾区域中获得的。
- en: '***19.1.3 Building ANOVA Tables with the aov Function***'
  id: totrans-61
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***19.1.3 使用aov函数构建ANOVA表***'
- en: 'As you might expect, R allows you to easily construct an ANOVA table for the
    chick weight test using the built-in `aov` function as follows:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你可能预期的那样，R允许你使用内置的`aov`函数轻松构建小鸡体重测试的ANOVA表，方法如下：
- en: '[PRE5]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Then, the table is printed to the console screen using `summary`.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，使用`summary`命令将表格打印到控制台屏幕上。
- en: '[PRE6]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: There are several comments to make here. Note that you employ formula notation
    `weight~feed` to specify the measurement variable of interest, weight, as modeled
    by the categorical-nominal variable of interest, feed type. In this case, the
    variable names `weight` and `feed` are not required to be prefaced by `chickwts$`
    since the optional `data` argument has been passed the data frame of interest.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有几个需要说明的地方。请注意，你使用公式表示法`weight~feed`来指定感兴趣的测量变量体重，它由感兴趣的类别-名义变量喂养类型来建模。在这种情况下，变量名`weight`和`feed`不需要以`chickwts$`为前缀，因为可选的`data`参数已经传入了相关数据框。
- en: Remember from [Section 14.3.2](ch14.xhtml#ch14lev2sec125) that for the notation
    in the expression `weight~feed`, the “outcome” of interest must always appear
    on the left of the `~` (this notation will become particularly relevant in [Chapters
    20](ch20.xhtml#ch20) to [22](ch22.xhtml#ch22)).
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，来自[第14.3.2节](ch14.xhtml#ch14lev2sec125)的内容，对于表达式`weight~feed`中的符号表示法，感兴趣的“结果”变量必须始终出现在`~`的左侧（这种符号表示法将在[第20章](ch20.xhtml#ch20)到[第22章](ch22.xhtml#ch22)中特别重要）。
- en: To actually view the table, you must apply the `summary` command to the object
    resulting from the call to `aov`. R omits the first and last rows (Overall and
    TOTAL) since these are not directly involved in calculating the *p*-value. Other
    than that, it’s easy to identify that the `feed` row refers to the Group row and
    the `Residuals` row refers to the Error row.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 要实际查看表格，必须对调用`aov`函数后返回的对象应用`summary`命令。R会省略第一行和最后一行（总体和总计），因为这些行与计算*p*-值没有直接关系。除此之外，很容易识别出`feed`行指的是组别行，而`Residuals`行指的是误差行。
- en: '**NOTE**'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*By default, R annotates model-based* `summary` *output like this with* significance
    stars*. These show intervals of significance, and the number of stars increases
    as the p-value decreases beyond a cutoff mark of 0.1\. This can be useful when
    you’re examining more complicated analyses where multiple p-values are summarized,
    though not everyone likes this feature. If you want, you can turn off this feature
    in a given R session by entering* `options(show.signif.stars=FALSE)` *at the prompt.
    Alternatively, you can turn off the feature directly in the call to* `summary`
    *by setting the additional argument* `signif.stars=FALSE`*. In this book, I’ll
    leave them be.*'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '*默认情况下，R会在模型基础的*`summary`*输出中添加显著性星号*。这些星号表示显著性区间，星号的数量会随着*p*-值的减小而增加，当*p*-值低于0.1的临界值时。这对于你检查多个*p*-值汇总的更复杂分析可能很有用，尽管并非每个人都喜欢这个功能。如果你愿意，可以通过在提示符下输入*`options(show.signif.stars=FALSE)`*来关闭此功能，或者你也可以直接在调用`summary`时，通过设置附加参数*`signif.stars=FALSE`*来关闭此功能。在本书中，我将保留这一功能。*'
- en: From the contents of the ANOVA for this example, you can quickly confirm the
    calculations. Note that the MSE, 3009, was defined as the Error SS divided by
    the Error df. Indeed, in R, the same result is achieved manually (the table output
    has been rounded to the nearest integer).
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 从这个例子的ANOVA内容中，你可以快速确认计算结果。注意，MSE（均方误差）为3009，它被定义为误差平方和（Error SS）除以误差自由度（Error
    df）。实际上，在R中，手动计算也能得出相同的结果（表格输出已四舍五入到最接近的整数）。
- en: '[PRE7]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: You can confirm all the other results in the table output using the relevant
    equations from earlier.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过使用前面提到的相关公式，确认表格输出中的所有其他结果。
- en: Interpreting a hypothesis test based on ANOVA follows the same rules as any
    other test. With the understanding of a *p*-value as “the probability that you
    observe the sample statistics at hand or something more extreme, if H[0] is true,”
    a small *p*-value indicates evidence against the null hypothesis. In the current
    example, a tiny *p*-value provides strong evidence against the null that the mean
    chick weights are the same for the different diets. In other words, you reject
    H[0] in favor of H[A]; the latter states that there is a difference.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 解释基于ANOVA的假设检验遵循与其他任何检验相同的规则。通过理解*p*-值为“如果原假设H[0]为真，你观察到当前样本统计量或更极端的情况的概率”，一个小的*p*-值表明反对原假设的证据。在当前的例子中，一个极小的*p*-值提供了强有力的证据，反对均值相同的原假设，即不同饮食对小鸡体重的影响相同。换句话说，你拒绝原假设H[0]，支持备择假设H[A]；后者表示存在差异。
- en: In a similar fashion as in the chi-squared tests, rejection of the null in one-way
    ANOVA doesn’t tell you exactly where a difference lies, merely that there’s evidence
    one exists. Further scrutiny of the data in the individual groups is necessary
    to identify the offending means. At the simplest level, you could turn back to
    pairwise two-sample *t*-tests, in which case you could also use the MSE from the
    ANOVA table as an estimate of the pooled variance. The substitution is valid if
    the assumption of equal variance holds, and such a step is beneficial because
    the corresponding *t*-based sampling distribution will utilize the Error df (this
    is naturally higher than would otherwise be the case if the df was based on just
    the sample sizes of the two groups of specific interest).
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 与卡方检验类似，一元ANOVA中的原假设被拒绝并不能告诉你差异到底在哪里，仅仅表明有证据表明存在差异。需要对各个组的数据进行进一步审查，以确定存在问题的均值。在最简单的层面上，你可以回到成对的两样本*t*-检验，在这种情况下，你也可以使用ANOVA表中的MSE作为合并方差的估计。如果方差相等的假设成立，则这种替代是有效的，这一步是有益的，因为相应的基于*t*的抽样分布将利用误差自由度（Error
    df）（如果自由度仅基于两个特定组的样本大小，通常情况下该自由度会较低）。
- en: '**Exercise 19.1**'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '**习题 19.1**'
- en: 'Consider the following data:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑以下数据：
- en: '| **Site I** | **Site II** | **Site III** | **Site IV** |'
  id: totrans-78
  prefs: []
  type: TYPE_TB
  zh: '| **遗址 I** | **遗址 II** | **遗址 III** | **遗址 IV** |'
- en: '| --- | --- | --- | --- |'
  id: totrans-79
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| 93 | 85 | 100 | 96 |'
  id: totrans-80
  prefs: []
  type: TYPE_TB
  zh: '| 93 | 85 | 100 | 96 |'
- en: '| 120 | 45 | 75 | 58 |'
  id: totrans-81
  prefs: []
  type: TYPE_TB
  zh: '| 120 | 45 | 75 | 58 |'
- en: '| 65 | 80 | 65 | 95 |'
  id: totrans-82
  prefs: []
  type: TYPE_TB
  zh: '| 65 | 80 | 65 | 95 |'
- en: '| 105 | 28 | 40 | 90 |'
  id: totrans-83
  prefs: []
  type: TYPE_TB
  zh: '| 105 | 28 | 40 | 90 |'
- en: '| 115 | 75 | 73 | 65 |'
  id: totrans-84
  prefs: []
  type: TYPE_TB
  zh: '| 115 | 75 | 73 | 65 |'
- en: '| 82 | 70 | 65 | 80 |'
  id: totrans-85
  prefs: []
  type: TYPE_TB
  zh: '| 82 | 70 | 65 | 80 |'
- en: '| 99 | 65 | 50 | 85 |'
  id: totrans-86
  prefs: []
  type: TYPE_TB
  zh: '| 99 | 65 | 50 | 85 |'
- en: '| 87 | 55 | 30 | 95 |'
  id: totrans-87
  prefs: []
  type: TYPE_TB
  zh: '| 87 | 55 | 30 | 95 |'
- en: '| 100 | 50 | 45 | 82 |'
  id: totrans-88
  prefs: []
  type: TYPE_TB
  zh: '| 100 | 50 | 45 | 82 |'
- en: '| 90 | 40 | 50 |  |'
  id: totrans-89
  prefs: []
  type: TYPE_TB
  zh: '| 90 | 40 | 50 |  |'
- en: '| 78 |  | 45 |  |'
  id: totrans-90
  prefs: []
  type: TYPE_TB
  zh: '| 78 |  | 45 |  |'
- en: '| 95 |  | 55 |  |'
  id: totrans-91
  prefs: []
  type: TYPE_TB
  zh: '| 95 |  | 55 |  |'
- en: '| 93 |  |  |  |'
  id: totrans-92
  prefs: []
  type: TYPE_TB
  zh: '| 93 |  |  |  |'
- en: '| 88 |  |  |  |'
  id: totrans-93
  prefs: []
  type: TYPE_TB
  zh: '| 88 |  |  |  |'
- en: '| 110 |  |  |  |'
  id: totrans-94
  prefs: []
  type: TYPE_TB
  zh: '| 110 |  |  |  |'
- en: These figures provide the depths (in centimeters) at which important archaeological
    finds were made at four sites in New Mexico (see [Woosley and Mcintyre, 1996](ref.xhtml#ref77)).
    Store these data in your R workspace, with one vector containing depth and the
    other vector containing the site of each observation.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 这些图表提供了在新墨西哥州四个遗址上发现重要考古学发现的深度（单位：厘米）（参见[Woosley 和 Mcintyre, 1996](ref.xhtml#ref77)）。将这些数据存储在你的R工作区，其中一个向量包含深度，另一个向量包含每个观察点的遗址。
- en: Produce side-by-side boxplots of the depths split by group, and use additional
    points to mark the locations of the sample means.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 生成按组分割的深度箱型图，并使用额外的点来标出样本均值的位置。
- en: Assuming independence, execute diagnostic checks for normality and equality
    of variances.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 假设独立性成立，执行正态性和方差齐性的诊断检查。
- en: Perform and conclude a one-way ANOVA test for evidence of a difference between
    the means.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行并得出一元ANOVA检验的结论，以确认均值之间是否存在差异。
- en: In [Section 14.4](ch14.xhtml#ch14lev1sec47), you looked at the data set providing
    measurements on petal and sepal sizes for three species of iris flowers. This
    is available in R as `iris`.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第14.4节](ch14.xhtml#ch14lev1sec47)中，你查看了一个数据集，提供了三种鸢尾花物种的花瓣和花萼大小的测量数据。该数据集在R中可以通过`iris`访问。
- en: Based on diagnostic checks for normality and equality of variances, decide which
    of the four outcome measurements (sepal length/width and petal length/width) would
    be suitable for ANOVA (using the species as the group variable).
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基于正态性和方差齐性的诊断检查，决定哪四个结果测量（萼片长度/宽度和花瓣长度/宽度）适合方差分析（使用物种作为组变量）。
- en: Carry out one-way ANOVA for any suitable measurement variables.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对任何合适的测量变量执行单因素方差分析。
- en: '**19.2 Two-Way ANOVA**'
  id: totrans-102
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**19.2 二因素方差分析**'
- en: In many studies, the numeric outcome variable you’re interested in will be categorized
    by more than just one grouping variable. In these cases, you would use the *multiple-factor*
    ANOVA rather than the one-way ANOVA. This technique is directly referred to by
    the number of grouping variables used, with two- and three-way ANOVA being the
    next and most common extensions.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多研究中，您感兴趣的数值结果变量将不仅由一个分组变量进行分类。在这些情况下，您将使用*多因素*方差分析而不是单因素方差分析。这种技术直接通过使用的分组变量数量来指代，二因素和三因素方差分析是其下一个和最常见的扩展。
- en: Increasing the number of grouping variables complicates matters somewhat—performing
    just a one-way ANOVA for each variable separately is inadequate. In dealing with
    more than one categorical grouping factor, you must consider the *main effects*
    of each factor on the numeric outcome, while simultaneously accounting for the
    presence of the other grouping factor(s). That’s not all, though. It’s just as
    important to additionally investigate the idea of an *interactive effect*; if
    an interactive effect exists, then it suggests that the impact one of the grouping
    variables has on the outcome of interest, specified by its main effect, varies
    according to the levels of the other grouping variable(s).
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 增加分组变量的数量会使情况变得复杂一些——仅对每个变量分别执行单因素方差分析是不够的。在处理多个分类分组因素时，您必须考虑每个因素对数值结果的*主效应*，同时考虑其他分组因素的存在。但这还不是全部。同样重要的是额外研究*交互效应*的概念；如果存在交互效应，则表明一个分组变量对感兴趣的结果的影响（由其主效应指定）会根据其他分组变量的水平变化而变化。
- en: '***19.2.1 A Suite of Hypotheses***'
  id: totrans-105
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***19.2.1 一组假设***'
- en: 'For this explanation, denote your numeric outcome variable with *O* and your
    two grouping variables as *G[1]* and *G*[2]. In two-way ANOVA, the hypotheses
    should be set along the following lines:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 对于此说明，请用 *O* 表示您的数值结果变量，用 *G[1]* 和 *G*[2] 表示您的两个分组变量。在二因素方差分析中，假设应设置如下：
- en: 'H[0] : *G[1]* has no main (marginal) effect on the mean of *O*.'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: H[0]：*G[1]* 对 *O* 的均值没有主要（边际）影响。
- en: '*G*[2] has no main (marginal) effect on the mean of *O*.'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '*G*[2] 对 *O* 的均值没有主要（边际）影响。'
- en: There is no interactive effect of *G[1]* with *G[2]* on the mean of *O*.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '*G[1]* 与 *G*[2] 对 *O* 的均值没有交互效应。'
- en: 'H[A] : Separately, each statement in H[0] is incorrect.'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: H[A]：在H[0]中，各个声明分别不正确。
- en: You can see from these general hypotheses that you now have to obtain a *p*-value
    for each of the three components.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从这些一般性假设中看出，现在您必须为这三个组成部分中的每一个获取一个*p*-值。
- en: 'For the example, let’s use the built-in `warpbreaks` data frame ([Tippett,
    1950](ref.xhtml#ref65)), which provides the number of “warp break” imperfections
    (column `breaks`) observed in 54 pieces of yarn of equal length. Each piece of
    yarn is classified according to two categorical variables: `wool` (the type of
    yarn, with levels `A` and `B`) and `tension` (the level of tension applied to
    that piece—`L`, `M`, or `H` for low, medium, or high). Using `tapply`, you can
    inspect the mean number of warp breaks for each classification.'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，让我们使用内置的 `warpbreaks` 数据框架（[Tippett, 1950](ref.xhtml#ref65)），它提供了观察到的54根相同长度的纱线中的“断裂”缺陷数量（列
    `breaks`）。每根纱线根据两个分类变量进行分类：`wool`（纱线类型，具有 `A` 和 `B` 两个水平）和 `tension`（施加在该纱线上的张力水平，分别为
    `L`、`M` 或 `H`，分别代表低、中、高）。使用 `tapply`，您可以查看每个分类的平均断裂数。
- en: '[PRE8]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: You can supply more than one grouping variable to the `INDEX` argument as separate
    members of a list (any factor vectors given to this argument should be the same
    length as the first argument that specifies the data of interest). The results
    are returned as a matrix for two grouping variables, a 3D array for three grouping
    variables, and so on.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以将多个分组变量作为列表的单独成员提供给 `INDEX` 参数（此参数给定的任何因子向量应与指定感兴趣的数据的第一个参数的长度相同）。结果作为矩阵返回给两个分组变量，作为三个分组变量的3D数组返回给，依此类推。
- en: For some analyses, however, you might need the same information provided earlier
    in a different format. The `aggregate` function is similar to `tapply`, but it
    returns a data frame, the results in *stacked* format according to the specified
    grouping variables (as opposed to an array as returned by `tapply`). It’s called
    in much the same way. The first argument takes the data vector of interest. The
    second argument, `by`, should be a list of the desired grouping variables, and
    in `FUN`, you specify the function to operate on each subset.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，对于某些分析，你可能需要以不同的格式提供之前的信息。`aggregate`函数与`tapply`类似，但它返回的是一个数据框，结果按照指定的分组变量以*堆叠*格式呈现（与`tapply`返回的数组不同）。它的调用方式基本相同。第一个参数是你感兴趣的数据向量。第二个参数`by`应是所需分组变量的列表，而在`FUN`中，你指定要对每个子集操作的函数。
- en: '[PRE9]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Here I’ve stored the result of the call to `aggregate` as the object `wb.means`
    for later use.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我将对`aggregate`的调用结果存储为对象`wb.means`以供后续使用。
- en: '***19.2.2 Main Effects and Interactions***'
  id: totrans-118
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***19.2.2 主效应和交互效应***'
- en: 'I mentioned earlier that you could perform just a one-way ANOVA on each grouping
    variable separately, but this, in general, isn’t a good idea. I’ll demonstrate
    this now with the `warpbreaks` data (a quick inspection of the relevant diagnostics
    shows no obvious cause for concern):'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 我之前提到过，你可以分别对每个分组变量执行单因素方差分析，但通常这不是一个好主意。我现在将使用`warpbreaks`数据演示这一点（对相关诊断的快速检查显示没有明显的原因需要担忧）：
- en: '[PRE10]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: This output tells you that if you ignore `tension`, there is no evidence to
    suggest that there is any difference in the mean number of imperfections based
    on the type of `wool` alone (*p*-value 0.108). If you ignore `wool`, however,
    there *is* evidence to suggest a difference in warp breaks according to `tension`
    only.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 该输出告诉你，如果忽略`tension`，没有证据表明仅根据`wool`类型对经纱断裂的平均数量有任何差异（*p*-值为0.108）。然而，如果忽略`wool`，则*有*证据表明仅根据`tension`存在经纱断裂的差异。
- en: The problem here is that by ignoring one of the variables, you lose the ability
    to detect differences (or, more generally, statistical relationships) that may
    occur at a finer level. For example, though the `wool` type alone seems to have
    no remarkable impact on the mean number of warp breaks, you cannot tell whether
    this would be the case if you just looked at `wool` types at one particular level
    of `tension`.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的问题在于，忽略了其中一个变量后，你就失去了在更细致的层面上检测差异（或更一般地说，统计关系）的能力。例如，虽然单独看`wool`类型似乎对经纱断裂的平均数量没有显著影响，但你无法知道如果仅仅在某一特定的`tension`水平下查看`wool`类型时，情况是否会不同。
- en: 'Instead, you investigate this kind of question using two-way ANOVA. The following
    executes a two-way ANOVA for the warp breaks data based only on the main effects
    of the two grouping variables:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 相反，你使用双因素方差分析（two-way ANOVA）来研究这个问题。以下代码执行基于两个分组变量主效应的双因素方差分析，针对的是经纱断裂数据：
- en: '[PRE11]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Take a look at the formula. Specifying `wool+tension` to the right of the outcome
    variable and the `~` allows you to take both grouping variables into account at
    the same time. The results reveal a small drop in the size of the *p*-values now
    attached to each grouping variable; indeed, the *p*-value for `wool` is around
    0.073, approaching the conventional cutoff significance level of *α* = 0.05\.
    To interpret the results, you hold one grouping variable constant—if you focus
    on just one type of wool, there is still statistically significant evidence to
    suggest a difference in the mean number of warp breaks between the different `tension`
    levels. If you focus on just one level of `tension`, the evidence of a difference
    considering the two `wool` types has increased a little but is still not statistically
    significant (assuming the aforementioned *α* = 0.05).
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 看一下公式。指定`wool+tension`在结果变量右侧，`~`符号允许你同时考虑这两个分组变量。结果显示，现在附加在每个分组变量上的*p*-值略有下降；实际上，`wool`的*p*-值约为0.073，接近传统的显著性水平*α*
    = 0.05。为了解释结果，你保持一个分组变量不变——如果你只关注某一种类型的羊毛，仍然有统计学显著的证据表明不同`tension`水平之间的经纱断裂均值存在差异。如果你只关注某一特定的`tension`水平，考虑到两种`wool`类型的差异证据有所增加，但仍然不显著（假设上述的*α*
    = 0.05）。
- en: There’s still a limitation with considering only main effects. While the previous
    analysis shows that there’s variation in the outcome between the different levels
    of the two categorical variables, it doesn’t address the possibility that a difference
    in the mean number of warp breaks might vary further according to precisely *which*
    level of either `tension` or `wool` is being used when holding the other variable
    constant. This relatively subtle yet important consideration is known as an *interaction*.
    Specifically, if there is an interactive effect present between `tension` and
    `wool` with respect to warp breaks, then this would imply that the magnitude and/or
    direction of the difference in the mean number of warp breaks *is not the same*
    at different levels of the two grouping factors.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 仅考虑主效应仍然存在一定的局限性。虽然先前的分析表明在不同类别变量的各个水平之间，结果存在差异，但它并没有考虑这样一种可能性：在保持另一个变量不变时，*哪一个*`tension`或`wool`水平的变化可能会进一步影响经线断裂的均值差异。这个相对微妙但重要的考虑被称为*交互作用*。具体而言，如果在`tension`和`wool`之间对于经线断裂存在交互效应，那么这意味着均值差异的幅度和/或方向*在两个分组因子的不同水平下是不相同的*。
- en: To account for interactions, you make a slight adjustment to the two-way ANOVA
    model code.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 为了考虑交互作用，你需要对双因素方差分析模型代码做出小的调整。
- en: '[PRE12]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: You can explicitly specify the interaction as the main effects model formula
    *plus* the notation `wool:tension`, where the two grouping variables are separated
    by a `:`. (Note, in this setting, the `:` operator has nothing to do with the
    shortcut for creating an integer sequence first discussed in [Section 2.3.2](ch02.xhtml#ch02lev2sec21).)
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以明确指定交互作用作为主要效应模型公式的*加*上符号`wool:tension`，其中两个分组变量通过`:`分隔。（注意，在这种设置下，`:`运算符与[第2.3.2节](ch02.xhtml#ch02lev2sec21)中首次讨论的创建整数序列的快捷方式无关。）
- en: You can see from the ANOVA table output that, statistically, there is evidence
    of an interactive effect; that is, the very nature of the difference in the means
    is dependent upon the factor levels themselves, even though that evidence is relatively
    weak. Of course, the *p*-value of around 0.021 tells you only that, overall, there
    might be an interaction but not the precise features of the interaction.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 从方差分析表的输出可以看到，统计上存在交互效应的证据；也就是说，均值差异的本质依赖于因子水平本身，即使这个证据相对较弱。当然，约为0.021的*p*-值只告诉你总体上可能存在交互作用，但并没有提供交互作用的具体特征。
- en: To help with this, you can interpret such a two-way interaction effect in more
    detail with an *interaction plot*, provided in R with `interaction.plot`.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助理解，你可以通过*交互作用图*更加详细地解释这样的二项交互作用效应，R中的`interaction.plot`可以提供此图。
- en: '[PRE13]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: When `interaction.plot` is called, the outcome means should be supplied to the
    argument `response`, and the vectors providing the corresponding levels of each
    of the two factors should be supplied to the arguments `x.factor` (for the variable
    on the horizontal axis that refers to moving between levels from the left to the
    right) and `trace.factor` (each level of which will produce a different line,
    referenced in an automatically produced legend; the title of this legend is passed
    to `trace.label`). It doesn’t matter which grouping variable is which; the appearance
    of the plot will change accordingly, but your interpretations will (should!) be
    the same. The result is shown in [Figure 19-2](ch19.xhtml#ch19fig2).
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 当调用`interaction.plot`时，需要将结果的均值传递给参数`response`，并将提供每个因子不同水平的向量分别传递给参数`x.factor`（表示水平从左到右变化的水平轴变量）和`trace.factor`（每个水平将产生不同的线，并在自动生成的图例中进行引用；该图例的标题会传递给`trace.label`）。分组变量的顺序并不重要；图形的外观会相应变化，但你的解释（应该是！）会保持一致。结果显示在[图19-2](ch19.xhtml#ch19fig2)中。
- en: The two-way interaction plot displays the outcome variable on the vertical axis
    and splits the recorded means by the levels of the two grouping variables. This
    allows you to inspect the potential effect that varying the levels of the grouping
    variables has on the outcome. In general, when the lines (or segments thereof)
    are not parallel, it suggests an interaction could be present. Vertical separations
    between the plotted locations indicate the individual main effects of the grouping
    variables.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 双向交互图显示了纵轴上的结果变量，并根据两个分组变量的不同水平对记录的均值进行分组。这让你可以检查改变分组变量水平对结果的潜在影响。通常，当线条（或其中的某些部分）不平行时，表明可能存在交互作用。绘制点之间的垂直分隔线表示分组变量的个别主效应。
- en: It turns out that the columns returned by a call to `aggregate` are actually
    perfectly suited to `interaction.plot`. As usual, you can specify the common graphical
    parameters, like those you initially encountered in [Section 7.2](ch07.xhtml#ch07lev1sec24),
    to control specific features of the plot and axis annotation. For [Figure 19-2](ch19.xhtml#ch19fig2),
    you’ve specified that `x.factor` should be the second column of the `wb.means`
    matrix, meaning that the `tension` levels vary horizontally. The `trace.factor`
    here is the type of `wool`, so there are only two distinct lines corresponding
    to the two levels `A` and `B`. The `response` is that third column of `wb.means`,
    extracted using `$x` (take a look at the `wb.means` object; you’ll see the column
    containing the results of interest is labeled `x` by default after a call to `aggregate`).
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 事实证明，`aggregate`函数返回的列非常适合用来绘制`interaction.plot`。像往常一样，你可以指定常见的图形参数，比如在[第7.2节](ch07.xhtml#ch07lev1sec24)中首次遇到的那些，来控制图表和轴注释的特定功能。在[图19-2](ch19.xhtml#ch19fig2)中，你指定了`x.factor`应该是`wb.means`矩阵的第二列，这意味着`张力`水平在水平轴上变化。`trace.factor`是`wool`的类型，所以这里只有两条对应于`A`和`B`的不同水平的线。`response`是`wb.means`矩阵的第三列，可以通过`$x`提取（查看`wb.means`对象；你会看到，在调用`aggregate`之后，包含感兴趣结果的列默认标记为`x`）。
- en: '![image](../images/f19-02.jpg)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f19-02.jpg)'
- en: '*Figure 19-2: An interaction plot for the full two-way ANOVA model of the*
    `warpbreaks` *data set*'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: '*图19-2：完整双向ANOVA模型的交互作用图，用于* `warpbreaks` *数据集*'
- en: Considering the actual appearance of the plot in [Figure 19-2](ch19.xhtml#ch19fig2),
    it does indeed appear that the mean number of warp breaks for wool type `A` is
    higher if `tension` is low, but the nature of the difference changes if you move
    to a medium tension, where `B` has a higher point estimate than `A`. Moving to
    a high tension, type `A` again has a higher estimate of the mean number of breaks
    than `B`, though here the difference between `A` and `B` is nowhere near as big
    as it is at a low tension. (Note, however, that the interaction plot does not
    display any kind of standard error measurements, so you must remember that all
    point estimates of the means are subject to variability.)
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到[图19-2](ch19.xhtml#ch19fig2)中图表的实际外观，的确可以看到，如果`张力`较低，羊毛类型`A`的平均断裂数较高，但当张力变为中等时，`B`的点估计值高于`A`。当张力变为高时，`A`的平均断裂数再次高于`B`，尽管在高张力下，`A`和`B`之间的差异远不如低张力时那么大。（但请注意，交互作用图没有显示任何标准误差的度量，因此你必须记住，所有均值的点估计都存在变异性。）
- en: Interactions are certainly not a concept unique to multiple-factor ANOVA; they
    form an important consideration in many different types of statistical models.
    For the moment, it’s good just to gain a basic appreciation of interactions.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 交互作用显然不是多因素方差分析（ANOVA）特有的概念；它们在许多不同类型的统计模型中都是一个重要的考虑因素。目前，了解交互作用的基本概念就足够了。
- en: '**19.3 Kruskal-Wallis Test**'
  id: totrans-140
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**19.3 Kruskal-Wallis检验**'
- en: When comparing multiple means, there may be situations when you’re unwilling
    to assume normality or have even found the assumption of normality invalid in
    diagnostic checks. In this case, you can use the *Kruskal-Wallis test*, an alternative
    to the one-way ANOVA that relaxes the dependence on the necessity for normality.
    This method tests for “equality of distributions” of the measurements in each
    level of the grouping factor. If you make the usual assumption of equal variances
    across these groups, you can therefore think of this test as one that compares
    multiple medians rather than means.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 在比较多个均值时，可能会遇到你不愿意假设正态性，或者在诊断检查中发现正态性假设无效的情况。在这种情况下，你可以使用*Kruskal-Wallis检验*，这是一个放宽正态性要求的单因素ANOVA替代方法。该方法检验每个分组因素水平中测量值的“分布是否相等”。如果你假设这些组的方差相等，那么你可以将此检验视为比较多个中位数而非均值的检验。
- en: The hypotheses governing the test alter accordingly.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 测试的假设因此相应地发生变化。
- en: 'H[0] : Group medians are all equal.'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[0] : 各组的中位数相等。'
- en: 'H[A] : Group medians are not all equal'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[A] : 各组的中位数不全相等'
- en: (alternatively, at least one group median differs).
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: （或者，至少有一个组的中位数不同）。
- en: The Kruskal-Wallis test is a *nonparametric* approach since it does not rely
    on quantiles of a standardized parametric distribution (in other words, the normal
    distribution) or any of its functions. In the same way that the ANOVA is a generalization
    of the two-sample *t*-test, the Kruskal-Wallis ANOVA is a generalization of the
    Mann-Whitney test for two medians. It’s also referred to as the Kruskal-Wallis
    *rank sum* test, and you use the chi-squared distribution to calculate the *p*-value.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: Kruskal-Wallis检验是一种*非参数*方法，因为它不依赖于标准化参数分布的分位数（换句话说，即正态分布）或其任何函数。与ANOVA是两样本*t*检验的推广一样，Kruskal-Wallis
    ANOVA是Mann-Whitney检验对两个中位数的推广。它也被称为Kruskal-Wallis*秩和*检验，且你使用卡方分布来计算*p*值。
- en: Turn your attention to the data frame `survey`, located in the `MASS` package.
    These data record particular characteristics of 237 first-year undergraduate statistics
    students collected from a class at the University of Adelaide, South Australia.
    Load the required package first with a call to `library("MASS")` and then enter
    `?survey` at the prompt. You can read the help file to understand which variables
    are present in the data frame.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 将注意力转向位于`MASS`包中的数据框`survey`。这些数据记录了来自南澳大利亚阿德莱德大学一门统计学课程的237名大一本科生的特定特征。首先通过调用`library("MASS")`加载所需的包，然后在提示符下输入`?survey`。你可以阅读帮助文件以了解数据框中包含了哪些变量。
- en: 'Suppose you’re interested to see whether the age of the students, `Age`, tends
    to differ with respect to four smoking categories reported in `Smoke`. An inspection
    of the relevant side-by-side boxplots and a normal QQ plot of the residuals (mean-centered
    observations with respect to each group) suggests a straightforward one-way ANOVA
    isn’t necessarily a good idea. The following code (which mimics the steps you
    saw in [Section 19.1.1](ch19.xhtml#ch19lev2sec168)) produces the two images in
    [Figure 19-3](ch19.xhtml#ch19fig3), which show normality is questionable:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你有兴趣查看学生的年龄（`Age`）是否在四个吸烟类别（`Smoke`）之间存在差异。通过检查相关的并排箱线图和残差的正态QQ图（以每组为基础的均值中心化观察值），可以看出，简单的一元方差分析（ANOVA）不一定是一个好主意。以下代码（模拟了你在[第19.1.1节](ch19.xhtml#ch19lev2sec168)中看到的步骤）生成了[图19-3](ch19.xhtml#ch19fig3)中的两幅图，表明正态性存在疑问：
- en: '[PRE14]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: With this possible violation of normality, you could therefore apply the Kruskal-Wallis
    test instead of the parametric ANOVA. A quick check for equality of variances
    further supports this, with the ratio of the largest to the smallest group standard
    deviations clearly being less than 2.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 由于可能存在正态性假设的违反，你因此可以选择使用Kruskal-Wallis检验，而不是参数化的ANOVA。通过方差齐性检验可以进一步支持这一点，最大和最小组的标准差比率明显小于2。
- en: '[PRE15]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '![image](../images/f19-03.jpg)'
  id: totrans-152
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f19-03.jpg)'
- en: '*Figure 19-3: Side-by-side boxplots (left) and a normal QQ plot of the residuals
    (right) for the student age observations split by smoking status*'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '*图19-3：并排箱线图（左）和残差的正态QQ图（右），根据吸烟状态划分的学生年龄观察值*'
- en: In R, a Kruskal-Wallis test is performed using `kruskal.test`.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在R中，Kruskal-Wallis检验可以通过`kruskal.test`来执行。
- en: '[PRE16]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: The syntax for this test is the same as for `aov`. As you might suspect from
    [Figure 19-3](ch19.xhtml#ch19fig3), the large *p*-value suggests there’s no evidence
    against the null hypothesis that states that the medians are all equal. In other
    words, there doesn’t seem to be an overall age difference between the students
    in the four smoking categories.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 这个检验的语法与`aov`相同。正如你可能从[图19-3](ch19.xhtml#ch19fig3)中猜到的那样，较大的* p *值表明没有反驳原假设的证据，原假设认为中位数都相等。换句话说，在四个吸烟类别的学生之间，似乎没有明显的年龄差异。
- en: '**Exercise 19.2**'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: '**练习19.2**'
- en: Bring up the `quakes` data frame again, which describes the locations, magnitudes,
    depths, and number of observation stations that detected 1,000 seismic events
    off the coast of Fiji.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 再次提取`quakes`数据框，它描述了在斐济海岸附近发生的1,000次地震事件的地点、震级、深度以及检测到这些地震事件的观测站数量。
- en: 'Use `cut` (see [Section 4.3.3](ch04.xhtml#ch04lev2sec48)) to create a new factor
    vector defining the depths of each event according to the following three categories:
    (0,200], (200,400], and (400,680].'
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`cut`（参见[第4.3.3节](ch04.xhtml#ch04lev2sec48)）创建一个新的因子向量，根据以下三个类别定义每个事件的深度：（0,200]、（200,400]和（400,680]。
- en: Decide whether a one-way ANOVA or a Kruskal-Wallis test is more appropriate
    to use to compare the distributions of the number of detecting stations, split
    according to the three categories in (a).
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 决定是使用单因素方差分析还是克鲁斯克尔-瓦利斯检验来比较根据(a)中三个类别拆分的检测站数量的分布，更为合适。
- en: Perform your choice of test in (b) (assume a *α* = 0.01 level of significance)
    and conclude.
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行你在(b)中选择的检验（假设* α * = 0.01的显著性水平），并得出结论。
- en: Load the `MASS` package with a call to `library("MASS")` if you haven’t already
    done so in the current R session. This package includes the ready-to-use `Cars93`
    data frame, which contains detailed data on 93 cars for sale in the United States
    in 1993 ([Lock, 1993](ref.xhtml#ref43); [Venables and Ripley, 2002](ref.xhtml#ref69)).
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你还没有在当前R会话中加载，使用`library("MASS")`加载`MASS`包。这个包包括现成的`Cars93`数据框，包含了1993年在美国出售的93辆汽车的详细数据（[Lock,
    1993](ref.xhtml#ref43); [Venables和Ripley, 2002](ref.xhtml#ref69)）。
- en: 'Use `aggregate` to compute the mean length of the 93 cars, split by two categorical
    variables: `AirBags` (type of airbags available—levels are `Driver & Passenger`,
    `Driver only`, and `None`), and `Man.trans.avail` (whether the car comes in a
    manual transmission—levels are `Yes` and `No`).'
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`aggregate`计算93辆汽车的平均长度，按两个分类变量拆分：`AirBags`（气囊类型—级别有`Driver & Passenger`、`Driver
    only`和`None`），以及`Man.trans.avail`（是否提供手动变速箱—级别为`Yes`和`No`）。
- en: Produce an interaction plot using the results in (d). Does there appear to be
    an interactive effect of `AirBags` with `Man.trans.avail` on the mean length of
    these cars (if you consider only these variables)?
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用(d)中的结果生成一个交互图。是否可以观察到`AirBags`与`Man.trans.avail`在这些汽车的平均长度上存在交互效应（如果只考虑这些变量的话）？
- en: Fit a full two-way ANOVA model for the mean lengths according to the two grouping
    variables (assume satisfaction of all relevant assumptions). Is the interactive
    effect statistically significant? Is there evidence of any main effects?
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为平均长度拟合一个完整的双因素方差分析模型，根据两个分组变量（假设所有相关假设均满足）。交互效应在统计上显著吗？是否有任何主效应的证据？
- en: '**Important Code in This Chapter**'
  id: totrans-166
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**本章重要代码**'
- en: '| **Function/operator** | **Brief description** | **First occurrence** |'
  id: totrans-167
  prefs: []
  type: TYPE_TB
  zh: '| **函数/运算符** | **简要描述** | **首次出现** |'
- en: '| --- | --- | --- |'
  id: totrans-168
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| `aov` | Produce ANOVA table | [Section 19.1.3](ch19.xhtml#ch19lev2sec170),
    [p. 440](ch19.xhtml#page_440) |'
  id: totrans-169
  prefs: []
  type: TYPE_TB
  zh: '| `aov` | 生成方差分析表 | [第19.1.3节](ch19.xhtml#ch19lev2sec170), [第440页](ch19.xhtml#page_440)
    |'
- en: '| `aggregate` | Stacked statistics by factor | [Section 19.2.1](ch19.xhtml#ch19lev2sec171),
    [p. 444](ch19.xhtml#page_444) |'
  id: totrans-170
  prefs: []
  type: TYPE_TB
  zh: '| `aggregate` | 按因子堆叠统计数据 | [第19.2.1节](ch19.xhtml#ch19lev2sec171), [第444页](ch19.xhtml#page_444)
    |'
- en: '| `interaction.plot` | Two-factor interaction plot | [Section 19.2.2](ch19.xhtml#ch19lev2sec172),
    [p. 446](ch19.xhtml#page_446) |'
  id: totrans-171
  prefs: []
  type: TYPE_TB
  zh: '| `interaction.plot` | 双因素交互图 | [第19.2.2节](ch19.xhtml#ch19lev2sec172), [第446页](ch19.xhtml#page_446)
    |'
- en: '| `kruskal.test` | Kruskal-Wallis test | [Section 19.3](ch19.xhtml#ch19lev1sec61),
    [p. 449](ch19.xhtml#page_449) |'
  id: totrans-172
  prefs: []
  type: TYPE_TB
  zh: '| `kruskal.test` | 克鲁斯克尔-瓦利斯检验 | [第19.3节](ch19.xhtml#ch19lev1sec61), [第449页](ch19.xhtml#page_449)
    |'
