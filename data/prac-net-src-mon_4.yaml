- en: Now we visit the PuTTY download website, shown in Figure 12-3, and
  id: totrans-0
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们访问 PuTTY 下载网站，如图 12-3 所示，
- en: download *putty.exe* via HTTP and then FTP.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 HTTP 下载 *putty.exe*，然后通过 FTP。
- en: '*Figure 12-3: PuTTY website download*'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 12-3：PuTTY 网站下载*'
- en: Once the download is finished, stop each Tcpdump instance by press-
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 下载完成后，通过按下 ctrl-C 停止每个 Tcpdump 实例，
- en: ing ctrl-C, and then use Capinfos to look at the metadata for each trace,
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 按下 ctrl-C 后，然后使用 Capinfos 查看每个跟踪的元数据，
- en: as shown in Listing 12-6\.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 如列表 12-6 所示。
- en: $ **capinfos putty-http.pcap putty-ftp.pcap**
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: $ **capinfos putty-http.pcap putty-ftp.pcap**
- en: 'File name: putty-http.pcap'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 文件名：putty-http.pcap
- en: 'File type: Wireshark/tcpdump/... - libpcap'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 文件类型：Wireshark/tcpdump/... - libpcap
- en: 'File encapsulation: Ethernet'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 文件封装：以太网
- en: 'Packet size limit: file hdr: 65535 bytes'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 包大小限制：文件头：65535 字节
- en: 'Number of packets: 509'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 数据包数量：509
- en: 'File size: 521880 bytes'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 文件大小：521880 字节
- en: 'Data size: 513712 bytes'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 数据大小：513712 字节
- en: '*-- snip --*'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '*-- 剪辑 --*'
- en: '**268** Chapter 12'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '**268** 第 12 章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: 'File name: putty-ftp.pcap'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 文件名：putty-ftp.pcap
- en: 'File type: Wireshark/tcpdump/... - libpcap'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 文件类型：Wireshark/tcpdump/... - libpcap
- en: 'File encapsulation: Ethernet'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 文件封装：以太网
- en: 'Packet size limit: file hdr: 65535 bytes'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 包大小限制：文件头：65535 字节
- en: 'Number of packets: 558'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 数据包数量：558
- en: 'File size: 525649 bytes'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 文件大小：525649 字节
- en: 'Data size: 516697 bytes'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 数据大小：516697 字节
- en: '*-- snip --*'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '*-- 剪辑 --*'
- en: '*Listing 12-6: Capinfos output for the HTTP and FTP traces*'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 12-6：HTTP 和 FTP 跟踪的 Capinfos 输出*'
- en: '***Testing Bro to Extract Binaries from HTTP Traffic***'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '***测试 Bro 提取 HTTP 流量中的二进制文件***'
- en: With the test traffic data ready, let’s run Bro against each trace to see what
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 准备好测试流量数据后，让我们运行 Bro 处理每个跟踪，看看
- en: logs it creates. Listing 12-7 runs Bro against the *putty-http.pcap* file u
    and tells Bro to reference our modified *local.bro* file v. (Notice that I run
    these commands in a directory called *bro-http* to separate the output from the
    second test for FTP.)
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成的日志。列表 12-7 运行 Bro 处理 *putty-http.pcap* 文件，并告诉 Bro 引用我们修改过的 *local.bro* 文件
    v。（注意，我在一个名为 *bro-http* 的目录中运行这些命令，以便将第二次测试 FTP 的输出与其分开。）
- en: $ sudo bro -r putty-http.pcapu /opt/bro/share/bro/site/local.brov
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: $ sudo bro -r putty-http.pcapu /opt/bro/share/bro/site/local.brov
- en: 'WARNING: No Site::local_nets have been defined. It''s usually a good idea to'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：未定义 Site::local_nets。通常建议
- en: define your local networks.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 定义你的本地网络。
- en: 'WARNING: Template value remaining in BPFConf filename: /etc/nsm/{{hostname}}-'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：BPFConf 文件名中剩余的模板值：/etc/nsm/{{hostname}}-
- en: '{{interface}}/bpf-bro.conf (/opt/bro/share/bro/securityonion/./bpfconf.bro,'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: '{{interface}}/bpf-bro.conf (/opt/bro/share/bro/securityonion/./bpfconf.bro,'
- en: line 99)
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 行 99)
- en: '*Listing 12-7: Running Bro against the saved HTTP traffic*'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 12-7：运行 Bro 处理保存的 HTTP 流量*'
- en: We can now see which logs Bro generated. First, we’ll look at the contents
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以看到 Bro 生成了哪些日志。首先，我们来看一下内容
- en: of the current working directory, as shown in Listing 12-8\.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 当前工作目录，如列表 12-8 所示。
- en: $ **ls -al**
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: $ **ls -al**
- en: total 560
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 总计 560
- en: drwxrwxr-x 3 sov sov 4096 Apr 17 19:33 .
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: drwxrwxr-x 3 sov sov 4096 4月 17 19:33 .
- en: drwxr-xr-x 29 sov sov 4096 Apr 17 19:32 ..
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: drwxr-xr-x 29 sov sov 4096 4月 17 19:32 ..
- en: -rw-r--r-- 1 root root 280 Apr 17 19:33 capture_loss.log
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 280 4月 17 19:33 capture_loss.log
- en: -rw-r--r-- 1 root root 763 Apr 17 19:33 conn.log
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 763 4月 17 19:33 conn.log
- en: -rw-r--r-- 1 root root 1376 Apr 17 19:33 http.logu
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 1376 4月 17 19:33 http.logu
- en: -rw-r--r-- 1 root root 7888 Apr 17 19:33 loaded_scripts.log
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 7888 4月 17 19:33 loaded_scripts.log
- en: -rw-r--r-- 1 root root 938 Apr 17 19:33 notice.log
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 938 4月 17 19:33 notice.log
- en: -rw-r--r-- 1 root root 1128 Apr 17 19:33 notice_policy.log
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 1128 4月 17 19:33 notice_policy.log
- en: -rw-r--r-- 1 root root 251 Apr 17 19:33 packet_filter.log
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 251 4月 17 19:33 packet_filter.log
- en: -rw-r--r-- 1 root root 521880 Apr 17 17:53 putty-http.pcap
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 521880 4月 17 17:53 putty-http.pcap
- en: -rw-r--r-- 1 root root 951 Apr 17 19:33 reporter.log
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 951 4月 17 19:33 reporter.log
- en: drwx------ 3 root root 4096 Apr 17 19:33 .state
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: drwx------ 3 root root 4096 4月 17 19:33 .state
- en: '*Listing 12-8: Logs created by running Bro against the saved HTTP traffic*'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 12-8：通过运行 Bro 处理保存的 HTTP 流量生成的日志*'
- en: Now let’s examine the *http.log* file u in more detail with the cat and
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们更详细地查看 *http.log* 文件，使用 cat 和
- en: bro-cut commands in tandem, as shown in Listing 12-9\. The -d flags
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 同时运行 bro-cut 命令，如列表 12-9 所示。-d 标志
- en: tells bro-cut to display a human-readable timestamp, and -C tells it to pre-
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 告诉 bro-cut 显示一个人类可读的时间戳，-C 告诉它预处理
- en: serve the file headers to show the fields that are present.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 保留文件头，以显示当前存在的字段。
- en: Extending SO **269**
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展 SO **269**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: $ **cat http.log | bro-cut -d -C**
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: $ **cat http.log | bro-cut -d -C**
- en: '#separator \x09'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '#separator \x09'
- en: '#set_separator ,'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '#set_separator ,'
- en: '#empty_field (empty)'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '#empty_field (空)'
- en: '#unset_field -'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '#unset_field -'
- en: '#path http'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '#path http'
- en: '#open 2013-04-17-19-33-23'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '#open 2013-04-17-19-33-23'
- en: '#fields ts uid id.orig_h id.orig_p id.resp_h id.resp_p trans_'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '#fields ts uid id.orig_h id.orig_p id.resp_h id.resp_p trans_'
- en: depth method host uri referrer user_agent request_body_len
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: depth method host uri referrer user_agent request_body_len
- en: response_body_len status_code status_msg info_code info_msg filename tags username
    password proxied mime_type md5 extraction_file
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: response_body_len status_code status_msg info_code info_msg filename tags username
    password proxied mime_type md5 extraction_file
- en: '#types string string addr port addr port count string string string string
    string count count count string count string string table[enum] string string
    table[string] string string file'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '#types string string addr port addr port count string string string string
    string count count count string count string string table[enum] string string
    table[string] string string file'
- en: 2013-04-17T17:53:28+0000u cSb1GfCIIL9w 192.168.2.108 53999 46.43.34.31
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 2013-04-17T17:53:28+0000u cSb1GfCIIL9w 192.168.2.108 53999 46.43.34.31
- en: 80 1 GET the.earth.li /~sgtatham/putty/latest/x86/putty.exez http://
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 80 1 GET the.earth.li /~sgtatham/putty/latest/x86/putty.exez http://
- en: www.chiark.greenend.org.uk/~sgtatham/putty/download.html Mozilla/5.0 (Windows
    NT 6.1; WOW64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.64 Safari/537.31
    0 300 302y Found - - - (empty) - - - text/html - -
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: www.chiark.greenend.org.uk/~sgtatham/putty/download.html Mozilla/5.0 (Windows
    NT 6.1; WOW64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.64 Safari/537.31
    0 300 302y Found - - - (空) - - - text/html - -
- en: 2013-04-17T17:53:28+0000v cSb1GfCIIL9x 192.168.2.108 53999 46.43.34.31
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 2013-04-17T17:53:28+0000v cSb1GfCIIL9x 192.168.2.108 53999 46.43.34.31
- en: 80 2 GET the.earth.li /~sgtatham/putty/0.62/x86/putty.exe{ http://
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 80 2 GET the.earth.li /~sgtatham/putty/0.62/x86/putty.exe{ http://
- en: www.chiark.greenend.org.uk/~sgtatham/putty/download.html Mozilla/5.0 (Windows
    NT 6.1; WOW64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.64 Safari/537.31
    0 483328
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: www.chiark.greenend.org.uk/~sgtatham/putty/download.html Mozilla/5.0 (Windows
    NT 6.1; WOW64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.64 Safari/537.31
    0 483328
- en: 200| OK - - - (empty) - - - application/
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 200| OK - - - (空) - - - application/
- en: x-dosexec a3ccfd0aa0b17fd23aa9fd0d84b86c05~ /nsm/bro/extracted/http/http-
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: x-dosexec a3ccfd0aa0b17fd23aa9fd0d84b86c05~ /nsm/bro/extracted/http/http-
- en: item_192.168.2.108:53999-46.43.34.31:80_resp_2.dat}
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: item_192.168.2.108:53999-46.43.34.31:80_resp_2.dat}
- en: '#close 2013-04-17-19-33-23'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: '#close 2013-04-17-19-33-23'
- en: '*Listing 12-9: Bro ht p.log for HTTP transfer*'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: '*列出 12-9：Bro ht p.log 的 HTTP 传输*'
- en: The two log entries u and v show traffic over a single web connec-
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 两个日志条目 u 和 v 显示了通过单一的 Web 连接传输的流量
- en: tion, because Bro assigned the same tracking ID w and x to both records.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 Bro 将相同的跟踪 ID w 和 x 分配给了两个记录，因此该事务
- en: In the first record u, the web server replies with a 302 code y that directed
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 在第一个记录 u 中，网络服务器回复了一个 302 代码 y，指示
- en: the download from */~sgtatham/putty/latest/x86/putty.exe* z to */~sgtatham/*
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 从 */~sgtatham/putty/latest/x86/putty.exe* z 下载到 */~sgtatham/*
- en: '*putty/0.62/x86/putty.exe* {. In the second record v, the web server replies
    with a 200 code | showing that it has the requested file. Finally, the second
    record'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: '*putty/0.62/x86/putty.exe* {. 在第二个记录 v 中，网络服务器回复了一个 200 代码 |，显示它拥有请求的文件。最后，第二个记录'
- en: shows that Bro extracted *putty.exe* to a specific directory and file, */nsm/bro/*
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 显示 Bro 将 *putty.exe* 提取到特定的目录和文件，*/nsm/bro/*
- en: '*extracted/http/http-item_192.168.2.108:53999-46.43.34.31:80_resp_2.dat* }.
    We'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '*extracted/http/http-item_192.168.2.108:53999-46.43.34.31:80_resp_2.dat* }。我们'
- en: also have an MD5 hash for the file, a3ccfd0aa0b17fd23aa9fd0d84b86c05 ~.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也有该文件的 MD5 哈希，a3ccfd0aa0b17fd23aa9fd0d84b86c05 ~。
- en: Bro is processing this HTTP traffic as we expected.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: Bro 正在处理我们预期的 HTTP 流量。
- en: '***Examining the Binary Extracted from HTTP***'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '***检查从 HTTP 中提取的二进制文件***'
- en: Now that we have indicators that Bro extracted a file from the HTTP traffic,
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有了指示 Bro 从 HTTP 流量中提取文件的标识符，
- en: we can examine it on disk. Listing 12-10 shows the results of that analysis.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在磁盘上检查它。列表 12-10 显示了该分析的结果。
- en: '**270** Chapter 12'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '**270** 第12章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '![Image 149](index-305_1.png)'
  id: totrans-95
  prefs: []
  type: TYPE_IMG
  zh: '![Image 149](index-305_1.png)'
- en: $ **ls -al /nsm/bro/extracted/http/http-item_192.168.2.108:53999-46.43.34.31:80_**
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: $ **ls -al /nsm/bro/extracted/http/http-item_192.168.2.108:53999-46.43.34.31:80_**
- en: '**resp_2.dat**'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '**resp_2.dat**'
- en: -rw-r--r-- 1 root root 483328u Apr 17 19:33 /nsm/bro/extracted/http/http-
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 483328u Apr 17 19:33 /nsm/bro/extracted/http/http-
- en: item_192.168.2.108:53999-46.43.34.31:80_resp_2.dat
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: item_192.168.2.108:53999-46.43.34.31:80_resp_2.dat
- en: $ **file /nsm/bro/extracted/http/http-item_192.168.2.108:53999-46.43.34.31:80_**
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: $ **file /nsm/bro/extracted/http/http-item_192.168.2.108:53999-46.43.34.31:80_**
- en: '**resp_2.dat**'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '**resp_2.dat**'
- en: /nsm/bro/extracted/http/http-item_192.168.2.108:53999-46.43.34.31:80_resp_2\.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: /nsm/bro/extracted/http/http-item_192.168.2.108:53999-46.43.34.31:80_resp_2\.
- en: 'dat: PE32 executable (GUI) Intel 80386, for MS Windowsv'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 'dat: PE32 可执行文件（GUI）Intel 80386，适用于 MS Windowsv'
- en: $ **md5sum /nsm/bro/extracted/http/http-item_192.168.2.108:53999-46.43.34.31:80_**
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: $ **md5sum /nsm/bro/extracted/http/http-item_192.168.2.108:53999-46.43.34.31:80_**
- en: '**resp_2.dat**'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '**resp_2.dat**'
- en: a3ccfd0aa0b17fd23aa9fd0d84b86c05w /nsm/bro/extracted/http/http-
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: a3ccfd0aa0b17fd23aa9fd0d84b86c05w /nsm/bro/extracted/http/http-
- en: item_192.168.2.108:53999-46.43.34.31:80_resp_2.dat
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: item_192.168.2.108:53999-46.43.34.31:80_resp_2.dat
- en: '*Listing 12-10: Examining the binary extracted from HTTP traffic*'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 12-10：检查从 HTTP 流量中提取的二进制文件*'
- en: Here, we see that the extracted file is 483,328 bytes u, with file
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，我们看到提取的文件大小为 483,328 字节 u，文件
- en: type PE32 executable (GUI) Intel 80386, for MS Windows v and a hash
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 类型为 PE32 可执行文件（GUI）Intel 80386，适用于 MS Windows v 和一个哈希值
- en: (a3ccfd0aa0b17fd23aa9fd0d84b86c05 w) that matches the values Bro
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: (a3ccfd0aa0b17fd23aa9fd0d84b86c05 w) 与 Bro 匹配的值
- en: reported in Listing 12-9\.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在列表 12-9 中报告的结果。
- en: To confirm that the hash matches the values of the binary downloaded
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确认哈希值与下载的二进制文件的值是否匹配
- en: to the Windows system, we look at the file properties, as shown in Figure 12-4\.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 Windows 系统，我们查看文件属性，如图 12-4 所示\。
- en: I used HashTab by Implbits ( *http://www.implbits.com/hashtab.aspx*) to gener-
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 我使用了 Implbits 的 HashTab（*http://www.implbits.com/hashtab.aspx*）来生成-
- en: ate these hashes in the File Hashes tab of the Properties dialog.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 在属性对话框的文件哈希选项卡中生成了这些哈希值。
- en: '*Figure 12-4: File properties of* putty .exe *showing the*'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 12-4：putty .exe 的文件属性，显示*'
- en: '*same MD5 hash*'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: '*相同的 MD5 哈希值*'
- en: Extending SO **271**
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展 SO **271**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '***Testing Bro to Extract Binaries from FTP Traffic***'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: '***测试 Bro 从 FTP 流量中提取二进制文件***'
- en: As with our HTTP test, we can run Bro against the FTP example to see the
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 与我们的 HTTP 测试一样，我们可以运行 Bro 对 FTP 示例进行分析，以查看
- en: logs it creates. Listing 12-11 demonstrates running Bro against *putty-ftp.pcap*
    u and telling Bro to again reference our modified *local.bro* v file. (Notice
    that I run these commands in a directory called *bro-ftp* to keep the output separate
    from the HTTP test results.)
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 它创建的日志。列表 12-11 演示了运行 Bro 对 *putty-ftp.pcap* u 进行分析，并告诉 Bro 再次引用我们修改过的 *local.bro*
    v 文件。（注意，我在一个名为 *bro-ftp* 的目录中运行这些命令，以便将输出与 HTTP 测试结果分开。）
- en: $ sudo bro -r putty-ftp.pcapu /opt/bro/share/bro/site/local.brov
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: $ sudo bro -r putty-ftp.pcapu /opt/bro/share/bro/site/local.brov
- en: 'WARNING: No Site::local_nets have been defined. It''s usually a good idea to'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：未定义任何 Site::local_nets。通常最好
- en: define your local networks.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 定义你的本地网络。
- en: 'WARNING: Template value remaining in BPFConf filename: /etc/nsm/{{hostname}}-'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：BPFConf 文件名中仍有模板值：/etc/nsm/{{hostname}}-
- en: '{{interface}}/bpf-bro.conf (/opt/bro/share/bro/securityonion/./bpfconf.bro,'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '{{interface}}/bpf-bro.conf (/opt/bro/share/bro/securityonion/./bpfconf.bro,'
- en: line 99)
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: line 99)
- en: '*Listing 12-11: Running Bro against the saved HTTP traffic*'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 12-11：运行 Bro 对保存的 HTTP 流量进行分析*'
- en: We can now see which logs Bro generated. First, we examine the con-
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在可以看到 Bro 生成了哪些日志。首先，我们检查 con-
- en: tents of the current working directory, as shown in Listing 12-12\.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 当前工作目录的内容，如列表 12-12 所示\。
- en: $ **ls -al**
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: $ **ls -al**
- en: total 560
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: total 560
- en: drwxrwxr-x 3 sov sov 4096 Apr 17 20:30 .
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: drwxrwxr-x 3 sov sov 4096 4月 17 20:30 .
- en: drwxr-xr-x 29 sov sov 4096 Apr 17 20:30 ..
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: drwxr-xr-x 29 sov sov 4096 4月 17 20:30 ..
- en: -rw-r--r-- 1 root root 281 Apr 17 20:30 capture_loss.log
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 281 4月 17 20:30 capture_loss.log
- en: -rw-r--r-- 1 root root 1531 Apr 17 20:30 conn.log
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 1531 4月 17 20:30 conn.log
- en: -rw-r--r-- 1 root root 731 Apr 17 20:30 ftp.logu
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 731 4月 17 20:30 ftp.logu
- en: -rw-r--r-- 1 root root 7888 Apr 17 20:30 loaded_scripts.log
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 7888 4月 17 20:30 loaded_scripts.log
- en: -rw-r--r-- 1 root root 1128 Apr 17 20:30 notice_policy.log
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 1128 4月 17 20:30 notice_policy.log
- en: -rw-r--r-- 1 root root 251 Apr 17 20:30 packet_filter.log
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 251 4月 17 20:30 packet_filter.log
- en: -rw-r--r-- 1 root root 525649 Apr 17 18:07 putty-ftp.pcap
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 525649 4月 17 18:07 putty-ftp.pcap
- en: -rw-r--r-- 1 root root 951 Apr 17 20:30 reporter.log
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 951 4月 17 20:30 reporter.log
- en: drwx------ 3 root root 4096 Apr 17 20:30 .state
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: drwx------ 3 root root 4096 4月 17 20:30 .state
- en: '*Listing 12-12: Logs created by running Bro against the saved FTP traffic*'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 12-12：运行 Bro 对保存的 FTP 流量进行分析时生成的日志*'
- en: Let’s look at the *ftp.log* u. Listing 12-13 shows the results of using the
    cat and bro-cut commands in tandem.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看一下 *ftp.log* u。列表 12-13 显示了同时使用 cat 和 bro-cut 命令的结果。
- en: $ **cat ftp.log | bro-cut -d -C**
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: $ **cat ftp.log | bro-cut -d -C**
- en: '#separator \x09'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: '#separator \x09'
- en: '#set_separator ,'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: '#set_separator ,'
- en: '#empty_field (empty)'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: '#empty_field (empty)'
- en: '#unset_field -'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: '#unset_field -'
- en: '#path ftp'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '#path ftp'
- en: '#open 2013-04-17-20-30-56'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: '#open 2013-04-17-20-30-56'
- en: '#fields ts uid id.orig_h id.orig_p id.resp_h id.resp_p user password command
    arg mime_type mime_desc file_size reply_code reply_msg tags extraction_file'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '#fields ts uid id.orig_h id.orig_p id.resp_h id.resp_p user password command
    arg mime_type mime_desc file_size reply_code reply_msg tags extraction_file'
- en: '**272** Chapter 12'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '**272** 第 12 章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '#types string string addr port addr port string string string string string
    string count count string table[string] file'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '#types string string addr port addr port string string string string string
    string count count string table[string] file'
- en: 2013-04-17T18:06:59+0000u 3JGazzdNGmev 192.168.2.108 54104 212.13.197.229
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 2013-04-17T18:06:59+0000u 3JGazzdNGmev 192.168.2.108 54104 212.13.197.229
- en: 21 anonymousw chrome@example.comx RETR ftp://212.13.197.229/users/
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 21 匿名用户 w chrome@example.comx RETR ftp://212.13.197.229/users/
- en: sgtatham/putty-latest/x86/putty.exey application/x-dosexec MS-DOS executable,
    MZ for MS-DOSz 86 226 Transfer complete{ - /nsm/bro/extracted/ftp/ftp-file_192.168.2.108:54106-212.13.197.229:38177_1.dat|
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: sgtatham/putty-latest/x86/putty.exey 应用程序/x-dosexec MS-DOS 可执行文件，MZ 适用于 MS-DOSz
    86 226 传输完成{ - /nsm/bro/extracted/ftp/ftp-file_192.168.2.108:54106-212.13.197.229:38177_1.dat|
- en: '#close 2013-04-17-20-30-56'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: '#close 2013-04-17-20-30-56'
- en: '*Listing 12-13: Bro* ftp .log *for FTP transfer*'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '*清单 12-13：Bro* ftp .log *用于 FTP 传输*'
- en: This one log entry at u tracks a single FTP session, because Bro
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 这一条日志记录追踪了一个单独的 FTP 会话，因为 Bro
- en: assigns one tracking ID v to the session. Here, we see the artifacts of
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 分配了一个跟踪 ID v 给该会话。这里，我们看到
- en: downloading a binary via Google Chrome. The username supplied is
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 Google Chrome 下载二进制文件。提供的用户名是
- en: anonymous w, and the password is chrome@example.com x. We see that the
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 匿名用户 w，密码是 chrome@example.com x。我们看到
- en: file retrieved, *putty-latest/x86/putty.exe* y, is of type MS-DOS executable,
    MZ
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 检索的文件，*putty-latest/x86/putty.exe* y，是 MS-DOS 可执行文件类型，MZ
- en: for MS-DOS z. We also see that the transfer completed successfully { and
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: MS-DOS z。我们还看到传输成功完成 { 和
- en: 'that Bro extracted the binary that it observed: */nsm/bro/extracted/ftp/*'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 表明 Bro 提取了它观察到的二进制文件：*/nsm/bro/extracted/ftp/*
- en: '*ftp-file_192.168.2.108:54106-212.13.197.229:38177_1.dat* |.'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: '*ftp-file_192.168.2.108:54106-212.13.197.229:38177_1.dat* |下载的。'
- en: '***Examining the Binary Extracted from FTP***'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: '***检查从 FTP 提取的二进制文件***'
- en: Now that we have indicators that Bro extracted a file from the FTP traffic,
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有了指示，表明 Bro 从 FTP 流量中提取了一个文件，
- en: we can examine it on disk. Listing 12-14 shows the results of that analysis.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在磁盘上查看它。清单 12-14 显示了该分析的结果。
- en: In this example, we’ll only confirm that the MD5 hash matches what we
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们只确认 MD5 哈希值与我们
- en: saw earlier.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们之前看到的。
- en: $ **md5sum /nsm/bro/extracted/ftp/ftp-file_192.168.2.108:54106-212.13.197.229:38177_1.dat**
    a3ccfd0aa0b17fd23aa9fd0d84b86c05u /nsm/bro/extracted/ftp/ftp-file_192.168.2.108:54106-212.13.197.229:38177_1.dat
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: $ **md5sum /nsm/bro/extracted/ftp/ftp-file_192.168.2.108:54106-212.13.197.229:38177_1.dat**
    a3ccfd0aa0b17fd23aa9fd0d84b86c05u /nsm/bro/extracted/ftp/ftp-file_192.168.2.108:54106-212.13.197.229:38177_1.dat
- en: '*Listing 12-14: Examining the binary extracted from FTP traffic*'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: '*清单 12-14：检查从 FTP 流量提取的二进制文件*'
- en: Notice that the MD5 hash u matches the values listed in the HTTP
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 注意到 MD5 哈希值 u 与 HTTP 中列出的值匹配
- en: examples, Listing 12-10 and Figure 12-4\.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 示例，清单 12-10 和图 12-4\。
- en: '***Submitting a Hash and Binary to VirusTotal***'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: '***提交哈希值和二进制文件到 VirusTotal***'
- en: Now that we have both the hash of a binary and the binary itself (recov-
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们既有二进制文件的哈希值，也有该二进制文件本身（已恢复）
- en: ered from network traffic), we can submit them to VirusTotal for analysis.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 从网络流量中恢复的文件），我们可以将其提交到 VirusTotal 进行分析。
- en: Whereas in Figure 12-1 we submitted only a hash of a binary for analysis, in
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 而在图 12-1 中，我们仅提交了一个二进制文件的哈希值进行分析，
- en: this section, we’ll submit the hash and then the binary in order to compare
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一节中，我们将提交哈希值，然后是二进制文件，以便进行比较
- en: the results. In Figure 12-5, we submit the hash.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 结果。在图 12-5 中，我们提交了哈希值。
- en: Figure 12-6 shows what VirusTotal knows about this hash.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 图 12-6 显示 VirusTotal 知道这个哈希值的信息。
- en: The results of this analysis are a little mixed, with two antivirus engines
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 该分析的结果有些混合，两个杀毒引擎
- en: (in the Detection Ratio field) reporting the file associated with this hash
    as
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: （在检测率字段中）报告与此哈希值关联的文件为
- en: malicious! We know this file is legitimate, however, because we downloaded
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意的！不过，我们知道这个文件是合法的，因为我们是从
- en: it from the publisher’s website. If we’re still suspicious, we could use the
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 从发布者的网站下载的。如果我们仍然怀疑，可以使用
- en: cryptographic signatures published on the PuTTY download page to verify
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 PuTTY 下载页面上发布的加密签名来验证
- en: Extending SO **273**
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展 SO **273**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '![Image 150](index-308_1.png)'
  id: totrans-195
  prefs: []
  type: TYPE_IMG
  zh: '![图像 150](index-308_1.png)'
- en: '![Image 151](index-308_2.png)'
  id: totrans-196
  prefs: []
  type: TYPE_IMG
  zh: '![图像 151](index-308_2.png)'
- en: that the file we downloaded is the file posted on the website, but that would
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 我们下载的文件就是网站上发布的文件，但这将是
- en: only confirm that someone with access to the private key posted a binary
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 只确认有人访问了私钥并发布了一个二进制文件
- en: signed by that key. (Trust only goes so far in the digital world.)
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 由该密钥签名。（在数字世界中，信任也是有限的。）
- en: '*Figure 12-5: Submitting the* putty .exe *hash to VirusTotal*'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: '*图12-5：提交* putty .exe *哈希值给VirusTotal*'
- en: '*Figure 12-6: VirusTotal results for the submit ed MD5 hash*'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: '*图12-6：VirusTotal对提交的MD5哈希值的结果*'
- en: VirusTotal publishes other information along with antivirus results,
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: VirusTotal发布了其他信息以及病毒扫描结果，
- en: such as the output of running Mark Russinovich’s Sigcheck ( *http://technet*
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 如运行Mark Russinovich的Sigcheck的输出（*http://technet*
- en: '*.microsoft.com/en-us/sysinternals/bb897441.aspx*), which checks to confirm'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: '*.microsoft.com/en-us/sysinternals/bb897441.aspx*），它检查确认'
- en: that a file is digitally signed, as shown in Listing 12-15\.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 一个文件是否被数字签名，正如在列表12-15中所示。
- en: Sigcheck
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: Sigcheck
- en: 'publisher................: Simon Tatham'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: '发布者................: Simon Tatham'
- en: 'product..................: PuTTY suite'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: '产品..................: PuTTY套件'
- en: 'internal name............: PuTTY'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: '内部名称............: PuTTY'
- en: 'copyright................: Copyright (c) 1997-2011 Simon Tatham.'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: '版权................: Copyright (c) 1997-2011 Simon Tatham。'
- en: 'original name............: PuTTY'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: '原始名称............: PuTTY'
- en: 'file version.............: Release 0.62'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: '文件版本.............: Release 0.62'
- en: 'description..............: SSH, Telnet and Rlogin client'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: '描述..............: SSH、Telnet和Rlogin客户端'
- en: '*Listing 12-15: VirusTotal reports Sigcheck results.*'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表12-15：VirusTotal报告Sigcheck结果。*'
- en: Sigcheck’s results appear to confirm that the hash we submitted matches
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: Sigcheck的结果似乎确认我们提交的哈希值与
- en: a PuTTY binary uploaded by previous VirusTotal users.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 这是由之前的VirusTotal用户上传的PuTTY二进制文件。
- en: We can also upload the binary Bro extracted for us, as shown in
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以上传Bro为我们提取的二进制文件，如所示
- en: Figure 12-7\.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 图12-7\。
- en: '**274** Chapter 12'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: '**274** 第12章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '![Image 152](index-309_1.png)'
  id: totrans-221
  prefs: []
  type: TYPE_IMG
  zh: '![Image 152](index-309_1.png)'
- en: '*Figure 12-7: Submit ing the binary extracted from HTTP traffic*'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: '*图12-7：提交从HTTP流量中提取的二进制文件*'
- en: 'VirusTotal knows about this binary, and it should: it’s the binary Bro'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: VirusTotal已经知道这个二进制文件，它应该知道：它是Bro的二进制文件
- en: extracted, and we just saw that the hash for it was already known to VirusTotal.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 提取出来，我们刚刚看到它的哈希值已经为VirusTotal所知。
- en: This general approach shows a powerful way to extend Bro to extract
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 这种通用的方法展示了如何扩展Bro，以提取
- en: Windows binaries from HTTP and FTP traffic. However, the current instance
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 来自HTTP和FTP流量的Windows二进制文件。然而，当前实例
- en: of Bro is running with the previous configuration files in memory. Unless
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: Bro正在运行，并且内存中有之前的配置文件。除非
- en: we restart Bro, it won’t know to apply the new *local.bro* configuration file
    to the running configuration.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们重新启动Bro，它不会知道将新的*local.bro*配置文件应用到运行中的配置。
- en: '***Restarting Bro***'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: '***重启Bro***'
- en: Until you restart Bro, or reboot the SO system, Bro will continue running
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 直到你重新启动Bro，或者重启SO系统，Bro将继续运行
- en: with the original *local.bro* script loaded. In order to benefit from Bro’s
    ability to extract Windows executables from network traffic, we need to have
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 使用原始*local.bro*脚本加载的情况下。为了利用Bro从网络流量中提取Windows可执行文件的能力，我们需要
- en: Bro reread its *local.bro* script. To tell Bro to process the script, use the
    broctl interface, as shown in Listing 12-16\.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: Bro重新读取其*local.bro*脚本。为了告诉Bro处理该脚本，使用broctl界面，如列表12-16所示。
- en: $ **sudo broctl**u
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo broctl**u
- en: Welcome to BroControl 1.1
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 欢迎来到BroControl 1.1
- en: Type "help" for help.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 输入"help"以获取帮助。
- en: '[BroControl] > **check**v'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: '[BroControl] > **check**v'
- en: manager is ok.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 管理员一切正常。
- en: proxy is ok.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 代理一切正常。
- en: sov-eth0-1 is ok.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: sov-eth0-1一切正常。
- en: '[BroControl] > **install**w'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: '[BroControl] > **install**w'
- en: removing old policies in /nsm/bro/spool/installed-scripts-do-not-touch/site
    ... done.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 删除旧政策，在/nsm/bro/spool/installed-scripts-do-not-touch/site中... 完成。
- en: removing old policies in /nsm/bro/spool/installed-scripts-do-not-touch/auto
    ... done.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 删除旧政策，在/nsm/bro/spool/installed-scripts-do-not-touch/auto中... 完成。
- en: creating policy directories ... done.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 创建政策目录... 完成。
- en: installing site policies ... done.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 安装站点政策... 完成。
- en: generating cluster-layout.bro ... done.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 生成cluster-layout.bro... 完成。
- en: generating local-networks.bro ... done.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 生成local-networks.bro... 完成。
- en: Extending SO **275**
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展SO **275**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: generating broctl-config.bro ... done.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 生成broctl-config.bro... 完成。
- en: updating nodes ... done.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 更新节点... 完成。
- en: '[BroControl] > **restart**x'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: '[BroControl] > **restart**x'
- en: stopping ...
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 停止...
- en: stopping sov-eth0-1 ...
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 停止sov-eth0-1 ...
- en: stopping proxy ...
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 停止代理...
- en: stopping manager ...
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 停止管理员...
- en: starting ...
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 启动中...
- en: starting manager ...
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 启动管理员...
- en: starting proxy ...
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 启动代理...
- en: starting sov-eth0-1 ...
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 启动sov-eth0-1 ...
- en: .
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 。
- en: '[BroControl] > **exit**y'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: '[BroControl] > **exit**y'
- en: '*Listing 12-16: Reconfiguring Bro using broctl*'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表12-16：使用broctl重新配置Bro*'
- en: In Listing 12-16, broctl is started u from a terminal that launches the
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 在列表12-16中，broctl是从启动的终端运行的
- en: broctl interface and accepts commands. Next, we run the check command v
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: broctl 接口并接受命令。接下来，我们运行检查命令 v
- en: to determine if the configuration files Bro reads are formatted properly. If
    so,
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 用来确定 Bro 读取的配置文件是否格式正确。如果是的话，
- en: Bro reports the status as ok, and we install them w. Next, we restart Bro x,
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: Bro 报告状态为正常，我们将其安装并继续。接下来，我们重启 Bro x，
- en: and after seeing the components restart, we exit the broctl interface y.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 在看到组件重启后，我们退出 broctl 接口 y。
- en: The last step is to confirm Bro’s status using the NSM scripts shipped
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一步是使用 NSM 脚本确认 Bro 的状态
- en: with SO, as shown in Listing 12-17\. (You could do the same thing with the
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 与 SO 一起使用，如清单 12-17 所示。 (你也可以使用相同的方法)
- en: sudo broctl status command.)
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: sudo broctl status 命令。)
- en: $ **sudo nsm_sensor_ps-status --only-bro**
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo nsm_sensor_ps-status --only-bro**
- en: 'Status: Bro'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 状态：Bro
- en: Name Type Host Status Pid Peers Started
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 名称 类型 主机 状态 Pid 同行 启动时间
- en: manager manager 192.168.2.102 running 19555 2 18 Apr 00:29:37
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: manager manager 192.168.2.102 正在运行 19555 2 18 4月 00:29:37
- en: proxy proxy 192.168.2.102 running 19603 2 18 Apr 00:29:40
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: proxy proxy 192.168.2.102 正在运行 19603 2 18 4月 00:29:40
- en: sov-eth0-1 worker 192.168.2.102 running 19647 2 18 Apr 00:29:42
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: sov-eth0-1 worker 192.168.2.102 正在运行 19647 2 18 4月 00:29:42
- en: 'Status: sov-eth0'
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 状态：sov-eth0
- en: '*Listing 12-17: Confirming Bro status using NSM scripts*'
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: '*清单 12-17：使用 NSM 脚本确认 Bro 状态*'
- en: According to the output of the nsm_sensor_ps-status --only-bro command,
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 根据 nsm_sensor_ps-status --only-bro 命令的输出，
- en: Bro is running properly with the new configuration.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: Bro 正常运行，并采用新配置。
- en: To test the live configuration, we’ll download another executable and
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 为了测试实时配置，我们将下载另一个可执行文件并
- en: watch for entries in the Bro logs. Listing 12-18 shows commands to test
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 观察 Bro 日志中的条目。清单 12-18 显示了测试命令
- en: the new functionality on a production SO sensor configured to extract
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 在配置为提取的生产 SO 传感器上启用新功能
- en: Windows executables.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: Windows 可执行文件。
- en: $ **wget http://www.etree.org/cgi-bin/counter.cgi/software/md5sum.exe**u
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: $ **wget http://www.etree.org/cgi-bin/counter.cgi/software/md5sum.exe**u
- en: --2013-04-18 00:44:06-- http://www.etree.org/cgi-bin/counter.cgi/software/md5sum.exe
    Resolving www.etree.org (www.etree.org)... 152.19.134.46
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: --2013-04-18 00:44:06-- http://www.etree.org/cgi-bin/counter.cgi/software/md5sum.exe
    正在解析 www.etree.org (www.etree.org)… 152.19.134.46
- en: Connecting to www.etree.org (www.etree.org)|152.19.134.46|:80... connected.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 正在连接到 www.etree.org (www.etree.org)|152.19.134.46|:80… 已连接。
- en: HTTP request sent, awaiting response... 200 OK
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 已发送 HTTP 请求，等待响应…… 200 OK
- en: 'Length: 49152 (48K) [application/octet-stream]'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 长度：49152 (48K) [application/octet-stream]
- en: 'Saving to: `md5sum.exe'''
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 保存到：`md5sum.exe'
- en: '**276** Chapter 12'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: '**276** 第12章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: 100%[======================================>] 49,152 --.-K/s in 0.1s 2013-04-18
    00:44:07 (398 KB/s) - `md5sum.exe' saved [49152/49152]
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 100%[======================================>] 49,152 --.-K/s 在 0.1 秒内 2013-04-18
    00:44:07 (398 KB/s) - `md5sum.exe' 已保存 [49152/49152]
- en: $ **grep md5sum.exe /nsm/bro/logs/current/***v
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: $ **grep md5sum.exe /nsm/bro/logs/current/***v
- en: /nsm/bro/logs/current/http_eth0.log:1366245846.879854 8AwBGe9EpX 192.168.2.102
    55409
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: /nsm/bro/logs/current/http_eth0.log:1366245846.879854 8AwBGe9EpX 192.168.2.102
    55409
- en: 152.19.134.46 80 1 GET www.etree.org /cgi-bin/counter.cgi/software/md5sum.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 152.19.134.46 80 1 GET www.etree.org /cgi-bin/counter.cgi/software/md5sum。
- en: exew - Wget/1.13.4 (linux-gnu) 0 49152 200 OK - - -
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: exew - Wget/1.13.4 (linux-gnu) 0 49152 200 OK - - -
- en: (empty) - - - application/x-dosexecx eb574b236133e60c989c6f472f07827by
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: (empty) - - - application/x-dosexecx eb574b236133e60c989c6f472f07827by
- en: /nsm/bro/extracted/http/http-item_192.168.2.102:55409-152.19.134.46:80_resp_1.datz
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: /nsm/bro/extracted/http/http-item_192.168.2.102:55409-152.19.134.46:80_resp_1.datz
- en: /nsm/bro/logs/current/notice.log:1366245847.087877 8AwBGe9EpX 192.168.2.102
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: /nsm/bro/logs/current/notice.log:1366245847.087877 8AwBGe9EpX 192.168.2.102
- en: 55409 152.19.134.46 80 tcp HTTP::MD5 192.168.2.102
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 55409 152.19.134.46 80 tcp HTTP::MD5 192.168.2.102
- en: eb574b236133e60c989c6f472f07827b{ http://www.etree.org/cgi-bin/counter.cgi/software/md5sum.
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: eb574b236133e60c989c6f472f07827b{ http://www.etree.org/cgi-bin/counter.cgi/software/md5sum.
- en: exe| eb574b236133e60c989c6f472f07827b 192.168.2.102 152.19.134.46 80 -
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: exe| eb574b236133e60c989c6f472f07827b 192.168.2.102 152.19.134.46 80 -
- en: sov-eth0-1 Notice::ACTION_LOG 6 3600.000000 F - - -
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: sov-eth0-1 Notice::ACTION_LOG 6 3600.000000 F - - -
- en: '- - - - -'
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: '- - - - -'
- en: '*Listing 12-18: Testing the new file extraction capability*'
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: '*清单 12-18：测试新的文件提取功能*'
- en: Listing 12-18 shows two commands to validate Windows executable
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 清单 12-18 显示了验证 Windows 可执行文件的两个命令
- en: extraction on a production sensor. First, we download a Windows executable
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 在生产传感器上提取。首先，我们下载一个 Windows 可执行文件
- en: called *md5sum.exe* using the wget tool u. Once the download is complete, we
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 wget 工具 u 调用 *md5sum.exe*。下载完成后，我们
- en: use grep to look for instances of the string md5sum in the current Bro logs
    v.
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 grep 在当前 Bro 日志中查找 md5sum 字符串的实例 v。
- en: 'There are two results:'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 结果有两个：
- en: • The first, from *http.log*, shows the download of the file w, file type x,
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: • 第一个来自*http.log*，显示了文件w的下载，文件类型x，
- en: MD5 hash y, and path to the extracted binary z.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: MD5哈希y和提取的二进制文件路径z。
- en: • The second, from *notice.log*, reproduces many of the same elements from
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: • 第二个来自*notice.log*，重现了许多相同的元素
- en: earlier examples, like the MD5 hash { and URL for the binary |.
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 早期的示例，如MD5哈希{和二进制文件的URL|。
- en: The presence of these logs indicates that Bro is extracting Windows
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 这些日志的存在表明Bro正在从HTTP流量中提取Windows
- en: executables from HTTP traffic, thanks to our configuration changes and
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 可执行文件，这要归功于我们的配置更改和
- en: application restart.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 应用程序重启。
- en: '**using aPT1 intelligence**'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: '**使用aPT1情报**'
- en: In February 2013, Mandiant released a report on a Chinese military unit
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: 2013年2月，Mandiant发布了一份关于中国军队单位的报告
- en: known as Advanced Persistent Threat 1 (APT1). Within China, APT1 is the
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 通常称为高级持久威胁1（APT1）。在中国，APT1是
- en: Second Bureau of the Third Department of the General Staff Directorate
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 总参谋部第三部门第二局
- en: of the People’s Liberation Army. Also known by its Military Unit Cover
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 解放军，也称为其军事单位掩护。
- en: Designator, 61398, this Army team targets English-speaking companies and
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 设计器，61398，该军队团队针对讲英语的公司和
- en: steals trade secrets, intellectual property, and other sensitive information.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 偷窃商业机密、知识产权和其他敏感信息。
- en: In its report, Mandiant released 3000 IOCs (discussed in Chapter 9),
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 在报告中，Mandiant发布了3000个IOC（在第9章中讨论），
- en: including domain names, IP addresses, X.509 encryption certificates, and
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 包括域名、IP地址、X.509加密证书等。
- en: MD5 hashes of malware used by APT1\. Mandiant also published video of
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: MD5哈希值，用于APT1使用的恶意软件。Mandiant还发布了
- en: Extending SO **277**
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展SO **277**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: the intruders interacting with victim Western computers to send phishing email,
    establish command-and-control channels, and exfiltrate data.
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵者与受害者的西方计算机交互，发送钓鱼邮件，建立命令和控制通道，并窃取数据。
- en: Although Mandiant published intelligence in OpenIOC ( *http://www*
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管Mandiant以OpenIOC格式发布了情报（*http://www*）
- en: '*.openioc.org/*) format, it was not immediately clear how network defenders'
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: '*.openioc.org/*）格式，网络防御者并未立即清楚如何应对'
- en: and NSM analysts could apply those indicators to their network. Within two
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: NSM分析师可以将这些指标应用到他们的网络中。在报告发布后的两天内，
- en: days of the report’s arrival, Seth Hall from the Bro project published one
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: 报告发布后的几天，Seth Hall来自Bro项目发布了一个
- en: 'answer: a new Bro module called APT1, incorporating Mandiant’s APT1'
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 回答：一个新的Bro模块，称为APT1，整合了Mandiant的APT1
- en: intelligence ( *https://github.com/sethhall/bro-apt1/*). Network defenders running
    NSM shops using SO now had an easy way to search for APT1 indicators on
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: 情报（*https://github.com/sethhall/bro-apt1/*）。使用SO的网络防御者在NSM商店中现在可以轻松搜索APT1指标
- en: the network.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 网络。
- en: '**Proof-of-coNcePT vS. ProDucTioN**'
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: '**概念验证vS.生产**'
- en: Seth Hall wrote the APT1 Bro module as a proof-of-concept in the interest of
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: Seth Hall编写了APT1 Bro模块，作为概念验证，目的是
- en: publishing something quickly for the benefit of the community . However, SO
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 快速发布一些内容以造福社区。然而，SO
- en: users should be aware of several aspects of this module when using it in pro-
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 用户在使用此模块时应注意几个方面。
- en: duction . (Seth would be the first to warn you of all these issues, but I include
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 生产。（Seth会首先提醒你这些问题，但我在此列出它们以便澄清）
- en: them here for clarity!)
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 在此列出它们以便澄清！
- en: As writ en, the module identifies the use of APT1 domains in DNS traffic, but
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 如写明，模块识别出DNS流量中APT1域名的使用，但
- en: it does not detect APT1 domains in the Host element of HTTP headers (such as
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: 它无法检测HTTP头部中的Host元素中的APT1域名（如
- en: 'Host: advanbusiness.com) or proxy-style URIs (such as *GET ht p://advanbusiness*'
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 主机：advanbusiness.com）或代理式URI（例如*GET http://advanbusiness*）
- en: '*.com/some/file*) . Also, the module doesn’t look for activity involving subdomains
    (such as *subdomain.advanbusiness.com*) .'
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: '*.com/some/file*)。此外，模块不查找涉及子域名的活动（如*subdomain.advanbusiness.com*）。'
- en: In addition to using the features in the APT1 Bro module, you could also
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: 除了使用APT1 Bro模块中的功能外，你还可以
- en: look for interesting domains in other traffic, such as SMTP, or other content
    . As
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 在其他流量中查找有趣的域名，如SMTP或其他内容。正如
- en: of this writing, the module doesn’t include those functions, but you can use
    the
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 截至目前，模块没有包含这些功能，但你可以使用
- en: Bro network programming language to write scripts to meet those needs . Seth
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Bro网络编程语言编写脚本以满足这些需求。Seth
- en: reminds users that Bro is constantly evolving, and his module will likely change
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 提醒用户Bro不断发展，他的模块可能会发生变化
- en: as Bro incorporates new features .
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: 因为 Bro 正在加入新特性。
- en: '***Using the APT1 Module***'
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: '***使用 APT1 模块***'
- en: So far, we’ve explored how Bro works with SO to create a variety of use-
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经探讨了 Bro 如何与 SO 配合使用，创建多种用途。
- en: ful logs, and we’ve modified *local.bro* to enable the extraction of Windows
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: 完整日志，我们已修改 *local.bro* 来启用 Windows
- en: executables from HTTP and FTP traffic. Now we will extend Bro by adding
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 从 HTTP 和 FTP 流量中提取可执行文件。现在，我们将通过添加新功能来扩展 Bro。
- en: a new module to its configuration.
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 一个新模块的配置。
- en: 'Seth’s APT1 module consists of three policy scripts:'
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: Seth 的 APT1 模块由三个策略脚本组成：
- en: '***data.bro*** This script contains a list of the domain names, MD5 hashes,
    and elements of the X.509 certificates Mandiant provided, formatted'
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: '***data.bro*** 这个脚本包含了 Mandiant 提供的域名、MD5 哈希值和 X.509 证书元素的列表，格式化为'
- en: for consumption by Bro.
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 供 Bro 使用。
- en: '***main.bro*** This script tells Bro’s notice framework to watch for matches
    against elements in *data.bro*.'
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: '***main.bro*** 这个脚本告诉 Bro 的通知框架监控是否与 *data.bro* 中的元素匹配。'
- en: '***load__.bro*** This script tells Bro to load *data.bro* and *main.bro*.'
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: '***load__.bro*** 这个脚本告诉 Bro 加载 *data.bro* 和 *main.bro*。'
- en: '**278** Chapter 12'
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: '**278** 第 12 章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: The module also includes a file called *README.rst*, which contains instructions
    on how to install the script, discusses new notices generated
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 该模块还包括一个名为 *README.rst* 的文件，里面包含有关如何安装脚本的说明，讨论生成的新通知
- en: by Bro, and offers related information.
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 由 Bro 提供，并提供相关信息。
- en: The IOCs in *data.bro* are formatted as shown in Listing 12-19\.
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: '*data.bro* 中的 IOCs 按照 Listing 12-19 所示的格式进行排列。'
- en: umodule APT1;
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: umodule APT1;
- en: 'vconst x509_serials_and_subjects: set[string, string] = {'
  id: totrans-371
  prefs: []
  type: TYPE_NORMAL
  zh: 'vconst x509_serials_and_subjects: set[string, string] = {'
- en: '["01", "C=US, ST=Some-State, O=www.virtuallythere.com, OU=new, CN=new"],'
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: '["01", "C=US, ST=Some-State, O=www.virtuallythere.com, OU=new, CN=new"],'
- en: '["0122", "C=US, ST=Some-State, O=Internet Widgits Pty Ltd, CN=IBM"],'
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: '["0122", "C=US, ST=Some-State, O=Internet Widgits Pty Ltd, CN=IBM"],'
- en: '*-- snip --*'
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: '*-- snip --*'
- en: '};'
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: '};'
- en: 'wconst domains: set[string] = {'
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: wconst 域名：set[string] = {
- en: '"advanbusiness.com",'
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
  zh: '"advanbusiness.com",'
- en: '"aoldaily.com",'
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: '"aoldaily.com",'
- en: '"aolon1ine.com",'
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: '"aolon1ine.com",'
- en: '"applesoftupdate.com",'
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: '"applesoftupdate.com",'
- en: '*-- snip --*'
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: '*-- snip --*'
- en: '};'
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: '};'
- en: 'xconst file_md5s: set[string] = {'
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 'xconst file_md5s: set[string] = {'
- en: '"001dd76872d80801692ff942308c64e6",'
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: '"001dd76872d80801692ff942308c64e6",'
- en: '"002325a0a67fded0381b5648d7fe9b8e",'
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: '"002325a0a67fded0381b5648d7fe9b8e",'
- en: '"00dbb9e1c09dbdafb360f3163ba5a3de",'
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: '"00dbb9e1c09dbdafb360f3163ba5a3de",'
- en: '*-- snip --*'
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: '*-- snip --*'
- en: '};'
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: '};'
- en: '*Listing 12-19: Excerpt from APT1* data .bro'
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: '*Listing 12-19: 来自 APT1 的数据摘录 .bro*'
- en: 'The *data.bro* file contains four main parts:'
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
  zh: '*data.bro* 文件包含四个主要部分：'
- en: • Part u declares that this is the APT1 module.
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: • 第 u 部分声明这是 APT1 模块。
- en: • Part v includes X509 encryption certificate details recognized by Bro
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: • 第 v 部分包含 Bro 识别的 X509 加密证书详细信息
- en: and used by APT1\.
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: 并被 APT1 使用。
- en: • Part w contains a list of malicious domains associated with APT1 activity.
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: • 第 w 部分包含与 APT1 活动相关的恶意域名列表。
- en: • Part x features a list of MD5 hashes of malware used by APT1\.
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: • 第 x 部分列出了 APT1 使用的恶意软件的 MD5 哈希值。
- en: As you can see, it’s very easy to add IOCs to this file or a copy, in order
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，非常容易将 IOCs 添加到这个文件或它的副本中，以便
- en: to detect different activities. The *main.bro* file generates alert data in
    the Bro *notice.log* file, as shown in Listing 12-20\.
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: 以检测不同的活动。*main.bro* 文件会在 Bro 的 *notice.log* 文件中生成警报数据，如 Listing 12-20 所示。
- en: APT1::Domain_Hit
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: APT1::域名命中
- en: APT1::Certificate_Hit
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: APT1::证书命中
- en: APT1::File_MD5_Hit
  id: totrans-400
  prefs: []
  type: TYPE_NORMAL
  zh: APT1::文件_MD5_命中
- en: '*Listing 12-20: Alert data generated by the APT1 module*'
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: '*Listing 12-20: APT1 模块生成的警报数据*'
- en: We’ll see one of these alerts in a live example when we test the APT1
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在实际示例中看到这些警报，当我们测试 APT1 时
- en: module, but first we need to get that module and install it.
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: 但首先我们需要获取该模块并安装它。
- en: Extending SO **279**
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展 SO **279**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '***Instal ing the APT1 Module***'
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: '***安装 APT1 模块***'
- en: We can test the APT1 module using techniques like the ones we tried when
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用之前尝试过的技术来测试 APT1 模块，
- en: enabling binary extraction from HTTP and FTP traffic. Listing 12-21 shows
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
  zh: 启用从 HTTP 和 FTP 流量中提取二进制文件。Listing 12-21 显示了
- en: this process in action.
  id: totrans-409
  prefs: []
  type: TYPE_NORMAL
  zh: 这个过程正在进行中。
- en: $ **sudo apt-get install git**u
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo apt-get install git**u
- en: -- *snip* --
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
  zh: -- *snip* --
- en: $ **cd /opt/bro/share/bro/site/**
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
  zh: $ **cd /opt/bro/share/bro/site/**
- en: $ **sudo git clone git://github.com/sethhall/bro-apt1.git apt1**v
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo git clone git://github.com/sethhall/bro-apt1.git apt1**v
- en: Cloning into 'apt1'...
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
  zh: 克隆到 'apt1'...
- en: 'remote: Counting objects: 12, done.'
  id: totrans-415
  prefs: []
  type: TYPE_NORMAL
  zh: 远程：统计对象：12，完成。
- en: 'remote: Compressing objects: 100% (10/10), done.'
  id: totrans-416
  prefs: []
  type: TYPE_NORMAL
  zh: 远程：压缩对象：100%（10/10），完成。
- en: 'remote: Total 12 (delta 2), reused 11 (delta 1)'
  id: totrans-417
  prefs: []
  type: TYPE_NORMAL
  zh: 远程：总计 12（增量 2），重用 11（增量 1）
- en: 'Receiving objects: 100% (12/12), 32.82 KiB, done.'
  id: totrans-418
  prefs: []
  type: TYPE_NORMAL
  zh: 接收对象：100% (12/12)，32.82 KiB，完成。
- en: 'Resolving deltas: 100% (2/2), done.'
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: 解决差异：100% (2/2)，完成。
- en: $ **ls**
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: $ **ls**
- en: apt1 local.bro.orig local-proxy.bro
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
  zh: apt1 local.bro.orig local-proxy.bro
- en: local.bro local-manager.bro local-worker.bro
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: local.bro local-manager.bro local-worker.bro
- en: $ **cd apt1**
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
  zh: $ **cd apt1**
- en: $ **ls**
  id: totrans-424
  prefs: []
  type: TYPE_NORMAL
  zh: $ **ls**
- en: data.bro __load__.bro main.bro README.rst
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: data.bro __load__.bro main.bro README.rst
- en: '*Listing 12-21: Instal ing Git and obtaining the APT1 module*'
  id: totrans-426
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 12-21：安装 Git 并获取 APT1 模块*'
- en: To acquire the APT1 module, first install the Git version control soft-
  id: totrans-427
  prefs: []
  type: TYPE_NORMAL
  zh: 要获取 APT1 模块，首先安装 Git 版本控制软件—
- en: ware u, and then clone the Git repository of Seth Hall’s APT module v.
  id: totrans-428
  prefs: []
  type: TYPE_NORMAL
  zh: 获取软件包 u，并克隆 Seth Hall 的 APT 模块 v 的 Git 仓库。
- en: Once the APT1 module has been downloaded into the */opt/bro/share/*
  id: totrans-429
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦 APT1 模块被下载到 */opt/bro/share/* 中
- en: '*bro/site/* directory, tell Bro about it by adding the following line to the
    bottom of *local.bro*:'
  id: totrans-430
  prefs: []
  type: TYPE_NORMAL
  zh: '*bro/site/* 目录，如果需要告知 Bro，可以通过在 *local.bro* 的底部添加以下行来实现：'
- en: '@load apt1'
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
  zh: '@load apt1'
- en: With *local.bro* modified, we’re almost ready to test the APT1 module, but
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: 修改了 *local.bro* 后，我们几乎准备好测试 APT1 模块了，但
- en: we still need to take one more step.
  id: totrans-433
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还需要再执行一步。
- en: '***Generating Traffic to Test the APT1 Module***'
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
  zh: '***生成流量以测试 APT1 模块***'
- en: To test the APT1 module, we launch a terminal on our sensor and tell
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
  zh: 要测试 APT1 模块，我们在传感器上启动一个终端并告诉
- en: Tcpdump to capture traffic. We apply a BPF to focus on traffic to and from
  id: totrans-436
  prefs: []
  type: TYPE_NORMAL
  zh: Tcpdump 捕获流量。我们应用一个 BPF 来专注于来自和前往
- en: port 53 that involves our test system 192.168.2.102\. Tcpdump will save what
  id: totrans-437
  prefs: []
  type: TYPE_NORMAL
  zh: 涉及我们的测试系统 192.168.2.102 的端口 53。Tcpdump 会保存这些
- en: it sees to a trace file called *port53.pcap*.
  id: totrans-438
  prefs: []
  type: TYPE_NORMAL
  zh: 它会看到一个名为 *port53.pcap* 的跟踪文件。
- en: $ **sudo tcpdump -n -i eth0 -s 0 -w port53.pcap port 53 and host 192.168.2.102**
  id: totrans-439
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo tcpdump -n -i eth0 -s 0 -w port53.pcap port 53 and host 192.168.2.102**
- en: '**280** Chapter 12'
  id: totrans-440
  prefs: []
  type: TYPE_NORMAL
  zh: '**280** 第 12 章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-441
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: In a second terminal, query for one of the domains listed in the APT1
  id: totrans-442
  prefs: []
  type: TYPE_NORMAL
  zh: 在第二个终端中，查询 APT1 中列出的一些域名
- en: '*data.bro* policy script *advanbusiness.com*, as shown in Listing 12-22\.'
  id: totrans-443
  prefs: []
  type: TYPE_NORMAL
  zh: '*data.bro* 策略脚本 *advanbusiness.com*，如列表 12-22 所示。'
- en: $ **host advanbusiness.com**u
  id: totrans-444
  prefs: []
  type: TYPE_NORMAL
  zh: $ **host advanbusiness.com**u
- en: advanbusiness.com has address 50.63.202.91v
  id: totrans-445
  prefs: []
  type: TYPE_NORMAL
  zh: advanbusiness.com 的地址是 50.63.202.91v
- en: advanbusiness.com mail is handled by 0 smtp.secureserver.net.
  id: totrans-446
  prefs: []
  type: TYPE_NORMAL
  zh: advanbusiness.com 的邮件由 0 smtp.secureserver.net 处理。
- en: advanbusiness.com mail is handled by 10 mailstore1.secureserver.net.
  id: totrans-447
  prefs: []
  type: TYPE_NORMAL
  zh: advanbusiness.com 的邮件由 10 mailstore1.secureserver.net 处理。
- en: '*Listing 12-22: Performing a DNS query for* advanbusiness .com'
  id: totrans-448
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 12-22：对* advanbusiness .com 执行 DNS 查询'
- en: Next, we use the Linux utility host to query for *advanbusiness.com* u, and
  id: totrans-449
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们使用 Linux 工具 host 查询 *advanbusiness.com* u，并且
- en: see that the result is the IP address 50.63.202.91 v.
  id: totrans-450
  prefs: []
  type: TYPE_NORMAL
  zh: 看到结果是 IP 地址 50.63.202.91 v。
- en: Returning to Tcpdump, we stop the capture with ctrl-C and review the
  id: totrans-451
  prefs: []
  type: TYPE_NORMAL
  zh: 返回 Tcpdump，我们使用 ctrl-C 停止捕获并查看
- en: results, as shown in Listing 12-23\.
  id: totrans-452
  prefs: []
  type: TYPE_NORMAL
  zh: 结果，如列表 12-23 所示。
- en: $ **tcpdump -n -r port53.pcap**
  id: totrans-453
  prefs: []
  type: TYPE_NORMAL
  zh: $ **tcpdump -n -r port53.pcap**
- en: reading from file port53.pcap, link-type EN10MB (Ethernet)
  id: totrans-454
  prefs: []
  type: TYPE_NORMAL
  zh: 从文件 port53.pcap 读取，链路类型 EN10MB（以太网）
- en: '14:30:15.622379 IP 192.168.2.102.57097 > 172.16.2.1.53: 57373+ A? advanbusiness.com.u
    (35) 14:30:15.762833 IP 172.16.2.1.53 > 192.168.2.102.57097: 57373 1/0/0 A 50.63.202.91v
    (51) 14:30:15.765342 IP 192.168.2.102.58378 > 172.16.2.1.53: 42025+ AAAA? advanbusiness.com.
    (35) 14:30:15.870230 IP 172.16.2.1.53 > 192.168.2.102.58378: 42025 0/1/0 (103)'
  id: totrans-455
  prefs: []
  type: TYPE_NORMAL
  zh: '14:30:15.622379 IP 192.168.2.102.57097 > 172.16.2.1.53: 57373+ A? advanbusiness.com.u
    (35) 14:30:15.762833 IP 172.16.2.1.53 > 192.168.2.102.57097: 57373 1/0/0 A 50.63.202.91v
    (51) 14:30:15.765342 IP 192.168.2.102.58378 > 172.16.2.1.53: 42025+ AAAA? advanbusiness.com.
    (35) 14:30:15.870230 IP 172.16.2.1.53 > 192.168.2.102.58378: 42025 0/1/0 (103)'
- en: '14:30:15.872373 IP 192.168.2.102.42336 > 172.16.2.1.53: 29779+ MX? advanbusiness.com.
    (35) 14:30:15.989506 IP 172.16.2.1.53 > 192.168.2.102.42336: 29779 2/0/2 MX smtp.secureserver.net.'
  id: totrans-456
  prefs: []
  type: TYPE_NORMAL
  zh: '14:30:15.872373 IP 192.168.2.102.42336 > 172.16.2.1.53: 29779+ MX? advanbusiness.com.
    (35) 14:30:15.989506 IP 172.16.2.1.53 > 192.168.2.102.42336: 29779 2/0/2 MX smtp.secureserver.net.'
- en: 0, MX mailstore1.secureserver.net. 10 (131)
  id: totrans-457
  prefs: []
  type: TYPE_NORMAL
  zh: 0, MX mailstore1.secureserver.net. 10 (131)
- en: '*Listing 12-23: DNS query for* advanbusiness .com'
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 12-23：针对* advanbusiness .com 的 DNS 查询'
- en: Listing 12-23 shows the query for *advanbusiness.com* u, followed by the
  id: totrans-459
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 12-23 显示了对 *advanbusiness.com* u 的查询，接着是
- en: 'result: IP address 50.63.202.91 v. With this traffic, we can now test the'
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
  zh: 结果：IP 地址 50.63.202.91 v。借助这个流量，我们现在可以测试
- en: APT1 module.
  id: totrans-461
  prefs: []
  type: TYPE_NORMAL
  zh: APT1 模块。
- en: '***Testing the APT1 Module***'
  id: totrans-462
  prefs: []
  type: TYPE_NORMAL
  zh: '***测试 APT1 模块***'
- en: To test the APT1 module, we run Bro against the trace file we just captured.
  id: totrans-463
  prefs: []
  type: TYPE_NORMAL
  zh: 要测试 APT1 模块，我们运行 Bro，分析我们刚刚捕获的跟踪文件。
- en: Listing 12-24 shows the result.
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 12-24 显示了结果。
- en: $ sudo bro -r port53.pcapu /opt/bro/share/bro/site/local.brov
  id: totrans-465
  prefs: []
  type: TYPE_NORMAL
  zh: $ sudo bro -r port53.pcapu /opt/bro/share/bro/site/local.brov
- en: 'WARNING: No Site::local_nets have been defined. It''s usually a good idea to'
  id: totrans-466
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：未定义任何 Site::local_nets。通常建议您
- en: define your local networks.
  id: totrans-467
  prefs: []
  type: TYPE_NORMAL
  zh: 定义您的本地网络。
- en: 'WARNING: Template value remaining in BPFConf filename: /etc/nsm/{{hostname}}-'
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：BPFConf 文件名中仍然有模板值：/etc/nsm/{{hostname}}-
- en: '{{interface}}/bpf-bro.conf (/opt/bro/share/bro/securityonion/./bpfconf.bro,'
  id: totrans-469
  prefs: []
  type: TYPE_NORMAL
  zh: '{{interface}}/bpf-bro.conf (/opt/bro/share/bro/securityonion/./bpfconf.bro,'
- en: line 99)
  id: totrans-470
  prefs: []
  type: TYPE_NORMAL
  zh: 第99行)
- en: '*Listing 12-24: Running Bro against the saved DNS traffic*'
  id: totrans-471
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 12-24：运行 Bro 处理保存的 DNS 流量*'
- en: Listing 12-24 shows Bro reading a network trace u, while the pres-
  id: totrans-472
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 12-24 显示了 Bro 读取网络追踪 u，而之前的
- en: ence of the *local.bro* v file in the command line tells Bro to read that file
  id: totrans-473
  prefs: []
  type: TYPE_NORMAL
  zh: 在命令行中指定*local.bro* v 文件会告诉 Bro 读取该文件
- en: for additional configuration information. We can now see which logs Bro
  id: totrans-474
  prefs: []
  type: TYPE_NORMAL
  zh: 获取更多的配置信息。现在我们可以看到 Bro 创建了哪些日志。
- en: generated.
  id: totrans-475
  prefs: []
  type: TYPE_NORMAL
  zh: 已生成。
- en: Extending SO **281**
  id: totrans-476
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展 SO **281**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-477
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: First, we examine the contents of the current working directory, as
  id: totrans-478
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们检查当前工作目录的内容，因为
- en: shown in Listing 12-25\.
  id: totrans-479
  prefs: []
  type: TYPE_NORMAL
  zh: 如列表 12-25 所示。
- en: $ **ls -al**
  id: totrans-480
  prefs: []
  type: TYPE_NORMAL
  zh: $ **ls -al**
- en: total 52
  id: totrans-481
  prefs: []
  type: TYPE_NORMAL
  zh: 总计 52
- en: drwxrwxr-x 3 soe soe 4096 Apr 18 14:52 .
  id: totrans-482
  prefs: []
  type: TYPE_NORMAL
  zh: drwxrwxr-x 3 soe soe 4096 4月 18 14:52 .
- en: drwxr-xr-x 33 soe soe 4096 Apr 18 14:52 ..
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
  zh: drwxr-xr-x 33 soe soe 4096 4月 18 14:52 ..
- en: -rw-r--r-- 1 root root 278 Apr 18 14:52 capture_loss.log
  id: totrans-484
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 278 4月 18 14:52 capture_loss.log
- en: -rw-r--r-- 1 root root 865 Apr 18 14:52 conn.log
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 865 4月 18 14:52 conn.log
- en: -rw-r--r-- 1 root root 932 Apr 18 14:52 dns.log
  id: totrans-486
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 932 4月 18 14:52 dns.log
- en: -rw-r--r-- 1 root root 8020 Apr 18 14:52 loaded_scripts.log
  id: totrans-487
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 8020 4月 18 14:52 loaded_scripts.log
- en: -rw-r--r-- 1 root root 864 Apr 18 14:52 notice.logu
  id: totrans-488
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 864 4月 18 14:52 notice.logu
- en: -rw-r--r-- 1 root root 1128 Apr 18 14:52 notice_policy.log
  id: totrans-489
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 1128 4月 18 14:52 notice_policy.log
- en: -rw-r--r-- 1 root root 251 Apr 18 14:52 packet_filter.log
  id: totrans-490
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 251 4月 18 14:52 packet_filter.log
- en: -rw-rw-r-- 1 soe soe 762 Apr 18 14:52 port53.pcap
  id: totrans-491
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-rw-r-- 1 soe soe 762 4月 18 14:52 port53.pcap
- en: -rw-r--r-- 1 root root 951 Apr 18 14:52 reporter.log
  id: totrans-492
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 951 4月 18 14:52 reporter.log
- en: drwx------ 3 root root 4096 Apr 18 14:52 .state
  id: totrans-493
  prefs: []
  type: TYPE_NORMAL
  zh: drwx------ 3 root root 4096 4月 18 14:52 .state
- en: '*Listing 12-25: Logs created by running Bro against the saved HTTP traffic*'
  id: totrans-494
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 12-25：运行 Bro 处理保存的 HTTP 流量时创建的日志*'
- en: Listing 12-25 shows a variety of files created when Bro processed the net-
  id: totrans-495
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 12-25 显示了 Bro 处理网络追踪时创建的各种文件。
- en: work trace. Let’s look at the *notice.log* u to see if the APT1 module detected
    the DNS query we made for the reportedly malicious *advanbusiness .com*
  id: totrans-496
  prefs: []
  type: TYPE_NORMAL
  zh: 网络追踪。让我们查看一下*notice.log* u，看看 APT1 模块是否检测到了我们为报告中的恶意*advanbusiness.com* 做的 DNS
    查询。
- en: domain. Listing 12-26 shows the output.
  id: totrans-497
  prefs: []
  type: TYPE_NORMAL
  zh: 域名。列表 12-26 显示了输出。
- en: $ **cat notice.log | bro-cut -C -d**
  id: totrans-498
  prefs: []
  type: TYPE_NORMAL
  zh: $ **cat notice.log | bro-cut -C -d**
- en: '#separator \x09'
  id: totrans-499
  prefs: []
  type: TYPE_NORMAL
  zh: '#separator \x09'
- en: '#set_separator ,'
  id: totrans-500
  prefs: []
  type: TYPE_NORMAL
  zh: '#set_separator ,'
- en: '#empty_field (empty)'
  id: totrans-501
  prefs: []
  type: TYPE_NORMAL
  zh: '#empty_field (空)'
- en: '#unset_field -'
  id: totrans-502
  prefs: []
  type: TYPE_NORMAL
  zh: '#unset_field -'
- en: '#path notice'
  id: totrans-503
  prefs: []
  type: TYPE_NORMAL
  zh: '#path notice'
- en: '#open 2013-04-18-14-52-57'
  id: totrans-504
  prefs: []
  type: TYPE_NORMAL
  zh: '#open 2013-04-18-14-52-57'
- en: '#fields ts uid id.orig_h id.orig_p id.resp_h id.resp_p proto note msg sub src
    dst p n peer_descr actions policy_items suppress_for dropped remote_location.country_code
    remote_location.region remote_'
  id: totrans-505
  prefs: []
  type: TYPE_NORMAL
  zh: '#fields ts uid id.orig_h id.orig_p id.resp_h id.resp_p proto note msg sub src
    dst p n peer_descr actions policy_items suppress_for dropped remote_location.country_code
    remote_location.region remote_'
- en: location.city remote_location.latitude remote_location.longitude metric_
  id: totrans-506
  prefs: []
  type: TYPE_NORMAL
  zh: location.city remote_location.latitude remote_location.longitude metric_
- en: index.host metric_index.str metric_index.network
  id: totrans-507
  prefs: []
  type: TYPE_NORMAL
  zh: index.host metric_index.str metric_index.network
- en: '#types string string addr port addr port enum enum string string addr addr
    port count string table[enum] table[count] interval bool string string string
    double double addr string subnet'
  id: totrans-508
  prefs: []
  type: TYPE_NORMAL
  zh: '#types string string addr port addr port enum enum string string addr addr
    port count string table[enum] table[count] interval bool string string string
    double double addr string subnet'
- en: 2013-04-18T14:30:15+0000 IVCYGEfpRya 192.168.2.102 57097 172.16.2.1 53
  id: totrans-509
  prefs: []
  type: TYPE_NORMAL
  zh: 2013-04-18T14:30:15+0000 IVCYGEfpRya 192.168.2.102 57097 172.16.2.1 53
- en: 'udp APT1::Domain_Hitu A domain from the APT1 report seen: advanbusiness.comv'
  id: totrans-510
  prefs: []
  type: TYPE_NORMAL
  zh: udp APT1::Domain_Hitu 从 APT1 报告中看到的一个域名：advanbusiness.comv
- en: '- 192.168.2.102 172.16.2.1 53 - bro Notice::ACTION_LOG 6'
  id: totrans-511
  prefs: []
  type: TYPE_NORMAL
  zh: '- 192.168.2.102 172.16.2.1 53 - bro Notice::ACTION_LOG 6'
- en: 3600.000000 F - - - - - - - -
  id: totrans-512
  prefs: []
  type: TYPE_NORMAL
  zh: 3600.000000 F - - - - - - - -
- en: '#close 2013-04-18-14-52-57'
  id: totrans-513
  prefs: []
  type: TYPE_NORMAL
  zh: '#close 2013-04-18-14-52-57'
- en: '*Listing 12-26: Contents of the Bro* notice .log *file*'
  id: totrans-514
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 12-26：Bro* notice .log *文件*的内容'
- en: '**282** Chapter 12'
  id: totrans-515
  prefs: []
  type: TYPE_NORMAL
  zh: '**282** 第12章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-516
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: Listing 12-26 shows Bro reporting an APT::Domain_hit alert u, followed by information
    about the domain seen, *advanbusiness.com* v. Our test was
  id: totrans-517
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 12-26 显示了 Bro 报告一个 APT::Domain_hit 警报 u，后面跟着看到的域名信息，*advanbusiness.com* v。我们的测试是
- en: successful, but this was only a test. To make Bro run the new configuration,
  id: totrans-518
  prefs: []
  type: TYPE_NORMAL
  zh: 成功了，但这只是一个测试。要让 Bro 运行新的配置，
- en: we need to restart Bro, as shown in Listing 12-27\.
  id: totrans-519
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要重新启动 Bro，正如列表 12-27 所示。
- en: $ **sudo broctl install && sudo broctl restart**
  id: totrans-520
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo broctl install && sudo broctl restart**
- en: removing old policies in /nsm/bro/spool/installed-scripts-do-not-touch/site
    ... done.
  id: totrans-521
  prefs: []
  type: TYPE_NORMAL
  zh: 移除 /nsm/bro/spool/installed-scripts-do-not-touch/site 中的旧政策 ... 完成。
- en: removing old policies in /nsm/bro/spool/installed-scripts-do-not-touch/auto
    ... done.
  id: totrans-522
  prefs: []
  type: TYPE_NORMAL
  zh: 移除 /nsm/bro/spool/installed-scripts-do-not-touch/auto 中的旧政策 ... 完成。
- en: creating policy directories ... done.
  id: totrans-523
  prefs: []
  type: TYPE_NORMAL
  zh: 创建政策目录 ... 完成。
- en: installing site policies ... done.
  id: totrans-524
  prefs: []
  type: TYPE_NORMAL
  zh: 安装站点政策 ... 完成。
- en: generating cluster-layout.bro ... done.
  id: totrans-525
  prefs: []
  type: TYPE_NORMAL
  zh: 生成 cluster-layout.bro ... 完成。
- en: generating local-networks.bro ... done.
  id: totrans-526
  prefs: []
  type: TYPE_NORMAL
  zh: 生成 local-networks.bro ... 完成。
- en: generating broctl-config.bro ... done.
  id: totrans-527
  prefs: []
  type: TYPE_NORMAL
  zh: 生成 broctl-config.bro ... 完成。
- en: updating nodes ... done.
  id: totrans-528
  prefs: []
  type: TYPE_NORMAL
  zh: 更新节点 ... 完成。
- en: stopping ...
  id: totrans-529
  prefs: []
  type: TYPE_NORMAL
  zh: 停止 ...
- en: stopping soe-eth0-1 ...
  id: totrans-530
  prefs: []
  type: TYPE_NORMAL
  zh: 停止 soe-eth0-1 ...
- en: stopping proxy ...
  id: totrans-531
  prefs: []
  type: TYPE_NORMAL
  zh: 停止代理 ...
- en: stopping manager ...
  id: totrans-532
  prefs: []
  type: TYPE_NORMAL
  zh: 停止管理器 ...
- en: starting ...
  id: totrans-533
  prefs: []
  type: TYPE_NORMAL
  zh: 启动中 ...
- en: starting manager ...
  id: totrans-534
  prefs: []
  type: TYPE_NORMAL
  zh: 启动管理器 ...
- en: starting proxy ...
  id: totrans-535
  prefs: []
  type: TYPE_NORMAL
  zh: 启动代理 ...
- en: starting soe-eth0-1 ...
  id: totrans-536
  prefs: []
  type: TYPE_NORMAL
  zh: 启动 soe-eth0-1 ...
- en: '*Listing 12-27: Restarting Bro from the command line*'
  id: totrans-537
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 12-27：从命令行重启 Bro*'
- en: Remember to check Bro’s status using the **sudo nsm_sensor_ps-status**
  id: totrans-538
  prefs: []
  type: TYPE_NORMAL
  zh: 记得使用 **sudo nsm_sensor_ps-status** 检查 Bro 的状态
- en: '**--only-bro** command as well.'
  id: totrans-539
  prefs: []
  type: TYPE_NORMAL
  zh: '**--only-bro** 命令也可以使用。'
- en: '**reporting downloads of Malicious binaries**'
  id: totrans-540
  prefs: []
  type: TYPE_NORMAL
  zh: '**报告恶意二进制文件的下载**'
- en: As you learned earlier, Bro can calculate MD5 hashes of Windows executa-
  id: totrans-541
  prefs: []
  type: TYPE_NORMAL
  zh: 如你之前所学，Bro 可以计算 Windows 可执行文件的 MD5 哈希值。
- en: bles downloaded over HTTP. In this section, we’ll examine how SO and Bro
  id: totrans-542
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 HTTP 下载的二进制文件。在本节中，我们将检查 SO 和 Bro
- en: integrate with a third-party malware hash registry to warn analysts when
  id: totrans-543
  prefs: []
  type: TYPE_NORMAL
  zh: 与第三方恶意软件哈希注册表集成，以便在分析人员发现时发出警告
- en: users download malicious software using a database offered by the Team
  id: totrans-544
  prefs: []
  type: TYPE_NORMAL
  zh: 用户通过 Team 提供的数据库下载恶意软件
- en: Cymru organization.
  id: totrans-545
  prefs: []
  type: TYPE_NORMAL
  zh: Cymru 组织。
- en: '***Using the Team Cymru Malware Hash Registry***'
  id: totrans-546
  prefs: []
  type: TYPE_NORMAL
  zh: '***使用 Team Cymru 恶意软件哈希注册表***'
- en: Team Cymru, formally known as *Team Cymru Research NFP*, describes itself
  id: totrans-547
  prefs: []
  type: TYPE_NORMAL
  zh: Team Cymru，正式名称为 *Team Cymru Research NFP*，自我描述为
- en: as “a specialized Internet security research firm and 501(c)3 non-profit
  id: totrans-548
  prefs: []
  type: TYPE_NORMAL
  zh: 作为“一个专门从事互联网安全研究的公司和 501(c)3 非营利组织”
- en: dedicated to making the Internet more secure” ( *http://www.team-cymru.*
  id: totrans-549
  prefs: []
  type: TYPE_NORMAL
  zh: 致力于使互联网更安全” ( *http://www.team-cymru.*
- en: '*org/About/*). We can use their free Malware Hash Registry (MHR, at *http://*'
  id: totrans-550
  prefs: []
  type: TYPE_NORMAL
  zh: '*org/About/*)。我们可以使用他们免费的恶意软件哈希注册表 (MHR，位于 *http://*'
- en: '*www.team-cymru.org/Services/MHR/*) to match MD5 hashes against known'
  id: totrans-551
  prefs: []
  type: TYPE_NORMAL
  zh: '*www.team-cymru.org/Services/MHR/*) 用于将 MD5 哈希与已知值进行匹配'
- en: malware.
  id: totrans-552
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件。
- en: Most analysts query the MHR via DNS. Listing 12-28 shows how to use
  id: totrans-553
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数分析人员通过 DNS 查询 MHR。列表 12-28 展示了如何使用
- en: the Linux dig command to run DNS TXT record queries for a malware hash
  id: totrans-554
  prefs: []
  type: TYPE_NORMAL
  zh: Linux dig 命令用于运行 DNS TXT 记录查询，查找恶意软件哈希值
- en: against MHR.
  id: totrans-555
  prefs: []
  type: TYPE_NORMAL
  zh: 与 MHR 对比。
- en: Extending SO **283**
  id: totrans-556
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展 SO **283**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-557
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: $ **dig +short 733a48a9cb49651d72fe824ca91e8d00.malware.hash.cymru.com TXT**u
  id: totrans-558
  prefs: []
  type: TYPE_NORMAL
  zh: $ **dig +short 733a48a9cb49651d72fe824ca91e8d00.malware.hash.cymru.com TXT**u
- en: '"1277221946v 79w"'
  id: totrans-559
  prefs: []
  type: TYPE_NORMAL
  zh: '"1277221946v 79w"'
- en: $ **date -d @1277221946**x
  id: totrans-560
  prefs: []
  type: TYPE_NORMAL
  zh: $ **date -d @1277221946**x
- en: Tue Jun 22 15:52:26 UTC 2010y
  id: totrans-561
  prefs: []
  type: TYPE_NORMAL
  zh: 2010年6月22日 15:52:26 UTC
- en: $ **dig +short 1e39efe30b02fd96b10785b49e23913b.malware.hash.cymru.com TXT**z
  id: totrans-562
  prefs: []
  type: TYPE_NORMAL
  zh: $ **dig +short 1e39efe30b02fd96b10785b49e23913b.malware.hash.cymru.com TXT**z
- en: $ **whois -h hash.cymru.com 1e39efe30b02fd96b10785b49e23913b**{
  id: totrans-563
  prefs: []
  type: TYPE_NORMAL
  zh: $ **whois -h hash.cymru.com 1e39efe30b02fd96b10785b49e23913b**{
- en: 1e39efe30b02fd96b10785b49e23913b 1366297928 NO_DATA|
  id: totrans-564
  prefs: []
  type: TYPE_NORMAL
  zh: 1e39efe30b02fd96b10785b49e23913b 1366297928 NO_DATA|
- en: '*Listing 12-28: Querying the MHR via TXT and whois records*'
  id: totrans-565
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 12-28：通过 TXT 和 whois 记录查询 MHR*'
- en: The first example shows a DNS TXT records query for malware with hash
  id: totrans-566
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个示例展示了一个针对恶意软件的 DNS TXT 记录查询，使用了哈希值
- en: 733a48a9cb49651d72fe824ca91e8d00 u. (Search VirusTotal to see what it is!) The
  id: totrans-567
  prefs: []
  type: TYPE_NORMAL
  zh: 733a48a9cb49651d72fe824ca91e8d00 u. （搜索 VirusTotal 查看它是什么！）这个
- en: first part of the response shows the date when the MHR last saw the sample v.
  id: totrans-568
  prefs: []
  type: TYPE_NORMAL
  zh: 响应的第一部分显示了 MHR 上次看到该样本的日期 v.
- en: The second part of the response is a rough antivirus detection metric, as
  id: totrans-569
  prefs: []
  type: TYPE_NORMAL
  zh: 响应的第二部分是一个粗略的杀毒检测指标，如
- en: a percentage w. We convert the timestamp from Unix epoch time to
  id: totrans-570
  prefs: []
  type: TYPE_NORMAL
  zh: 一个百分比 w。我们将时间戳从 Unix 时间戳转换为
- en: human-readable format with the date command x, and see that it was
  id: totrans-571
  prefs: []
  type: TYPE_NORMAL
  zh: 使用日期命令 x 以人类可读的格式查看，并看到它是
- en: June 22, 2010 y.
  id: totrans-572
  prefs: []
  type: TYPE_NORMAL
  zh: 2010年6月22日 y.
- en: The second example shows what happens when you query the MHR
  id: totrans-573
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个示例展示了查询 MHR 时发生的情况
- en: and it sends no response z. The hash supplied is the value for the Firefox
  id: totrans-574
  prefs: []
  type: TYPE_NORMAL
  zh: 它没有发送响应 z。提供的哈希值是 Firefox 的值
- en: binary. Because the MHR has no data on this hash, we switch to the MHR
  id: totrans-575
  prefs: []
  type: TYPE_NORMAL
  zh: 二进制文件。因为 MHR 没有关于此哈希的信息，我们切换到 MHR
- en: WHOIS query functionality {. The NO_DATA | response proves the MHR
  id: totrans-576
  prefs: []
  type: TYPE_NORMAL
  zh: WHOIS 查询功能 {. NO_DATA | 响应证明 MHR
- en: doesn’t know the supplied hash.
  id: totrans-577
  prefs: []
  type: TYPE_NORMAL
  zh: 不知道提供的哈希值。
- en: The example in Listing 12-29 shows another query using dig, but not
  id: totrans-578
  prefs: []
  type: TYPE_NORMAL
  zh: Listing 12-29中的示例显示了另一种使用dig的查询方式，但没有
- en: requesting a TXT record.
  id: totrans-579
  prefs: []
  type: TYPE_NORMAL
  zh: 请求TXT记录。
- en: $ **dig +short 733a48a9cb49651d72fe824ca91e8d00.malware.hash.cymru.com**
  id: totrans-580
  prefs: []
  type: TYPE_NORMAL
  zh: $ **dig +short 733a48a9cb49651d72fe824ca91e8d00.malware.hash.cymru.com**
- en: 127.0.0.2
  id: totrans-581
  prefs: []
  type: TYPE_NORMAL
  zh: 127.0.0.2
- en: '*Listing 12-29: Querying the MHR via the default A record*'
  id: totrans-582
  prefs: []
  type: TYPE_NORMAL
  zh: '*Listing 12-29：通过默认A记录查询MHR*'
- en: We query for the same first hash from Listing 12-28, but we let the
  id: totrans-583
  prefs: []
  type: TYPE_NORMAL
  zh: 我们查询Listing 12-28中的相同第一个哈希值，但我们让
- en: default be an A record.
  id: totrans-584
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下应该是A记录。
- en: A query for an A record asks a DNS server to return an IP address for
  id: totrans-585
  prefs: []
  type: TYPE_NORMAL
  zh: 查询A记录要求DNS服务器返回该域名的IP地址。
- en: the requested fully qualified domain name. In contrast, a query for a PTR
  id: totrans-586
  prefs: []
  type: TYPE_NORMAL
  zh: 请求的完全合格域名。相比之下，查询PTR记录
- en: record asks a DNS server to return a fully qualified domain name for the
  id: totrans-587
  prefs: []
  type: TYPE_NORMAL
  zh: 记录请求DNS服务器返回完全合格的域名，
- en: requested IP address. A query for a TXT record asks a DNS server to reply
  id: totrans-588
  prefs: []
  type: TYPE_NORMAL
  zh: 请求的IP地址。查询TXT记录请求DNS服务器回复
- en: with any text records associated with a domain name.
  id: totrans-589
  prefs: []
  type: TYPE_NORMAL
  zh: 包含与域名相关的任何文本记录。
- en: Our only result is the IP address 127.0.0.2\. This is the MHR’s way of
  id: totrans-590
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的唯一结果是IP地址127.0.0.2。这是MHR的方式，
- en: responding to A record queries that have a match. If we want more informa-
  id: totrans-591
  prefs: []
  type: TYPE_NORMAL
  zh: 响应匹配的A记录查询。如果我们想要更多信息—
- en: tion about a match, we need to run a DNS query for a TXT record, as shown
  id: totrans-592
  prefs: []
  type: TYPE_NORMAL
  zh: 如果要获取更多关于匹配的信息，我们需要运行DNS查询以获取TXT记录，如下所示
- en: earlier in Listing 12-28\.
  id: totrans-593
  prefs: []
  type: TYPE_NORMAL
  zh: 在Listing 12-28中提到的。
- en: '**284** Chapter 12'
  id: totrans-594
  prefs: []
  type: TYPE_NORMAL
  zh: '**284** 第12章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-595
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '![Image 153](index-319_1.jpg)'
  id: totrans-596
  prefs: []
  type: TYPE_IMG
  zh: '![Image 153](index-319_1.jpg)'
- en: '***The MHR and SO: Active by Default***'
  id: totrans-597
  prefs: []
  type: TYPE_NORMAL
  zh: '***MHR和SO：默认启用***'
- en: By default, Bro on SO is configured to work with the MHR to help detect
  id: totrans-598
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，SO上的Bro已配置与MHR配合工作，帮助检测
- en: malicious downloads. SO relies on Bro to calculate MD5 hashes of Windows
  id: totrans-599
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意下载。SO依赖于Bro计算Windows可执行文件的MD5哈希值
- en: executables downloaded over HTTP, and that Bro automatically submits
  id: totrans-600
  prefs: []
  type: TYPE_NORMAL
  zh: 通过HTTP下载的可执行文件，Bro会自动提交
- en: those hashes to the MHR. We can see this activity in action if we query Bro
  id: totrans-601
  prefs: []
  type: TYPE_NORMAL
  zh: 这些哈希值对应于MHR。如果我们查询Bro，可以看到这个活动的执行情况。
- en: logs via ELSA, as shown in Figure 12-8\.
  id: totrans-602
  prefs: []
  type: TYPE_NORMAL
  zh: 通过ELSA的日志，如图12-8所示。
- en: '*Figure 12-8: Querying ELSA for MHR lookup*'
  id: totrans-603
  prefs: []
  type: TYPE_NORMAL
  zh: '*图12-8：查询ELSA获取MHR查询结果*'
- en: In Figure 12-8, we query ELSA for 1e39efe30b02fd96b10785b49e23913b
  id: totrans-604
  prefs: []
  type: TYPE_NORMAL
  zh: 在图12-8中，我们查询ELSA获取1e39efe30b02fd96b10785b49e23913b
- en: .malware.hash.cymru.com—the MD5 hash of the Firefox binary from an earlier
  id: totrans-605
  prefs: []
  type: TYPE_NORMAL
  zh: .malware.hash.cymru.com——这是之前提到的Firefox二进制文件的MD5哈希值。
- en: example (1e39efe30b02fd196b10785b49e23913b), plus the domain *malware.hash*
  id: totrans-606
  prefs: []
  type: TYPE_NORMAL
  zh: 示例（1e39efe30b02fd196b10785b49e23913b），加上域名 *malware.hash*
- en: '*.cymru.com*. Figure 12-8 shows eight results, all of which are pairs. The
    first entry in the pair is a lookup for an A record for IPv4, and the second entry
    is'
  id: totrans-607
  prefs: []
  type: TYPE_NORMAL
  zh: '*.cymru.com*。图12-8显示了八个结果，所有结果都是配对的。配对中的第一个条目是查询IPv4的A记录，第二个条目是'
- en: a lookup for an AAAA record for IPv6\. Thus, we have four unique queries for
  id: totrans-608
  prefs: []
  type: TYPE_NORMAL
  zh: 查询IPv6的AAAA记录。因此，我们有四个独特的查询
- en: this particular MD5 hash.
  id: totrans-609
  prefs: []
  type: TYPE_NORMAL
  zh: 这是特定的MD5哈希值。
- en: We can use one of two approaches to determine if any of the lookups
  id: totrans-610
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用两种方法来确定任何查询结果是否
- en: 'returned results:'
  id: totrans-611
  prefs: []
  type: TYPE_NORMAL
  zh: 返回的结果：
- en: • Inspect the results returned by ELSA directly. For example, a result
  id: totrans-612
  prefs: []
  type: TYPE_NORMAL
  zh: • 直接检查ELSA返回的结果。例如，结果
- en: with no indication of malicious entries in the MHR looks like |1
  id: totrans-613
  prefs: []
  type: TYPE_NORMAL
  zh: 没有在MHR中显示恶意条目的结果看起来像是|1
- en: '|C_INTERNET|1|A|-|-|F|F|T|F|0|-|- for IPv4 and |1|C_INTERNET|28|AAAA|-'
  id: totrans-614
  prefs: []
  type: TYPE_NORMAL
  zh: '|C_INTERNET|1|A|-|-|F|F|T|F|0|-|- 适用于IPv4，并且 |1|C_INTERNET|28|AAAA|-'
- en: '|-|F|F|T|F|0|-|- for IPv6\. We see these results for each of the entries'
  id: totrans-615
  prefs: []
  type: TYPE_NORMAL
  zh: '|-|F|F|T|F|0|-|- 适用于IPv6。我们可以看到这些结果对于每个条目'
- en: in Figure 12-8, indicating that there are no matches in the MHR. This
  id: totrans-616
  prefs: []
  type: TYPE_NORMAL
  zh: 如图12-8所示，表明在MHR中没有匹配项。
- en: tells us that the MHR doesn’t think the download of a binary with MD5
  id: totrans-617
  prefs: []
  type: TYPE_NORMAL
  zh: 这告诉我们MHR认为下载具有MD5
- en: 1e39efe30b02fd96b10785b49e23913b is malicious.
  id: totrans-618
  prefs: []
  type: TYPE_NORMAL
  zh: 1e39efe30b02fd96b10785b49e23913b是恶意的。
- en: • Query ELSA for Malware_Hash_Registry_Match. This is part of the event
  id: totrans-619
  prefs: []
  type: TYPE_NORMAL
  zh: • 查询ELSA以获取Malware_Hash_Registry_Match。这是事件的一部分，
- en: returned by Bro when it queries the MHR and gets a positive response.
  id: totrans-620
  prefs: []
  type: TYPE_NORMAL
  zh: 由Bro在查询MHR并获得积极响应时返回。
- en: In this case, the query finds no records in ELSA for a binary with hash
  id: totrans-621
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，查询在ELSA中没有找到对应哈希的二进制记录。
- en: 1e39efe30b02fd96b10785b49e23913b.
  id: totrans-622
  prefs: []
  type: TYPE_NORMAL
  zh: 1e39efe30b02fd96b10785b49e23913b。
- en: Extending SO **285**
  id: totrans-623
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展SO **285**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-624
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '![Image 154](index-320_1.png)'
  id: totrans-625
  prefs: []
  type: TYPE_IMG
  zh: '![Image 154](index-320_1.png)'
- en: '***The MHR and SO vs. a Malicious Download***'
  id: totrans-626
  prefs: []
  type: TYPE_NORMAL
  zh: '***MHR和SO与恶意下载***'
- en: Because SO and Bro query the MHR by default, in production, any match
  id: totrans-627
  prefs: []
  type: TYPE_NORMAL
  zh: 因为SO和Bro默认查询MHR，在生产环境中，任何匹配项
- en: for a malicious download will appear in ELSA and the underlying Bro logs.
  id: totrans-628
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意下载将在 ELSA 和底层 Bro 日志中出现。
- en: For example, suppose that one day you’re working with SO and your
  id: totrans-629
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，假设有一天你正在与 SO 一起工作，而你的
- en: NSM data, and you run a query for Malware_Hash_Registry_Match. You get the
  id: totrans-630
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 数据，你执行了一个查询，获取 Malware_Hash_Registry_Match。你得到的
- en: result shown in Figure 12-9\.
  id: totrans-631
  prefs: []
  type: TYPE_NORMAL
  zh: 如图 12-9 所示的结果。
- en: '*Figure 12-9: Query result for Malware_Hash_Registry_Match*'
  id: totrans-632
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 12-9：查询结果，针对 Malware_Hash_Registry_Match*'
- en: I’ve reproduced the same log entry as text only in Listing 12-30 for easy
  id: totrans-633
  prefs: []
  type: TYPE_NORMAL
  zh: 我已经将相同的日志条目以文本形式重现，在列表 12-30 中以便于阅读
- en: reference.
  id: totrans-634
  prefs: []
  type: TYPE_NORMAL
  zh: 参考。
- en: 1366293016.555895 - 192.168.2.108u 62585 205.186.148.46v 80 tcp HTTP::Malware_Hash_Registry_Matchw
    192.168.2.108 b4f990cad1d20efab410e98fc7a6c81bx http://www.taosecurity.com/helpdesk.exey
    - 192.168.2.108 205.186.148.46
  id: totrans-635
  prefs: []
  type: TYPE_NORMAL
  zh: 1366293016.555895 - 192.168.2.108u 62585 205.186.148.46v 80 tcp HTTP::Malware_Hash_Registry_Matchw
    192.168.2.108 b4f990cad1d20efab410e98fc7a6c81bx http://www.taosecurity.com/helpdesk.exey
    - 192.168.2.108 205.186.148.46
- en: 80- soe-eth0-1 Notice::ACTION_LOG 6 3600.000000 F
  id: totrans-636
  prefs: []
  type: TYPE_NORMAL
  zh: 80- soe-eth0-1 Notice::ACTION_LOG 6 3600.000000 F
- en: '- - --- - - -'
  id: totrans-637
  prefs: []
  type: TYPE_NORMAL
  zh: '- - --- - - -'
- en: '*Listing 12-30: Log entry for Malware_Hash_Registry_Match*'
  id: totrans-638
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 12-30：Malware_Hash_Registry_Match 的日志条目*'
- en: This log result from the Bro *notice.log* file indicates that a com-
  id: totrans-639
  prefs: []
  type: TYPE_NORMAL
  zh: 这个来自 Bro *notice.log* 文件的日志结果表明了一次计算机-
- en: puter with IP address 192.168.2.108 u visited 205.186.148.46 v and
  id: totrans-640
  prefs: []
  type: TYPE_NORMAL
  zh: 计算机的 IP 地址为 192.168.2.108，访问了 205.186.148.46，并且
- en: triggered an HTTP::Malware_Hash_Registry_Match w alert for MD5 hash
  id: totrans-641
  prefs: []
  type: TYPE_NORMAL
  zh: 触发了一个 HTTP::Malware_Hash_Registry_Match w 警报，针对 MD5 哈希值
- en: b4f990cad1d20efab410e98fc7a6c81b x from *www.taosecurity.com* and the
  id: totrans-642
  prefs: []
  type: TYPE_NORMAL
  zh: b4f990cad1d20efab410e98fc7a6c81b 来自 *www.taosecurity.com* 和该
- en: '*helpdesk.exe* file y. We can learn more about this connection if we'
  id: totrans-643
  prefs: []
  type: TYPE_NORMAL
  zh: '*helpdesk.exe* 文件。我们可以进一步了解这个连接，如果我们'
- en: query ELSA for the filename *helpdesk.exe*, as shown in Figure 12-10\.
  id: totrans-644
  prefs: []
  type: TYPE_NORMAL
  zh: 查询 ELSA 以获取文件名 *helpdesk.exe*，如图 12-10 所示。
- en: 'The results show three records:'
  id: totrans-645
  prefs: []
  type: TYPE_NORMAL
  zh: 结果显示三条记录：
- en: • The first record in Figure 12-10 is Bro’s way of telling us that it com-
  id: totrans-646
  prefs: []
  type: TYPE_NORMAL
  zh: • 图 12-10 中的第一条记录是 Bro 告诉我们它计算了
- en: puted an MD5 hash of the *helpdesk.exe* binary.
  id: totrans-647
  prefs: []
  type: TYPE_NORMAL
  zh: 计算出了 *helpdesk.exe* 二进制文件的 MD5 哈希值。
- en: • The second record is the same as what we saw in the MD5 lookup.
  id: totrans-648
  prefs: []
  type: TYPE_NORMAL
  zh: • 第二条记录与我们在 MD5 查找中看到的内容相同。
- en: • The third record shows that Bro extracted the binary from the HTTP
  id: totrans-649
  prefs: []
  type: TYPE_NORMAL
  zh: • 第三条记录显示 Bro 从 HTTP 中提取了该二进制文件
- en: traffic and saved it as */nsm/bro/extracted/http/http-item_192.168.2.108:*
  id: totrans-650
  prefs: []
  type: TYPE_NORMAL
  zh: 流量并将其保存为 */nsm/bro/extracted/http/http-item_192.168.2.108:*
- en: '*62585-205.186.148.46:80_resp_1.dat*.'
  id: totrans-651
  prefs: []
  type: TYPE_NORMAL
  zh: '*62585-205.186.148.46:80_resp_1.dat*。'
- en: '**286** Chapter 12'
  id: totrans-652
  prefs: []
  type: TYPE_NORMAL
  zh: '**286** 第 12 章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-653
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '![Image 155](index-321_1.png)'
  id: totrans-654
  prefs: []
  type: TYPE_IMG
  zh: '![Image 155](index-321_1.png)'
- en: '![Image 156](index-321_2.jpg)'
  id: totrans-655
  prefs: []
  type: TYPE_IMG
  zh: '![Image 156](index-321_2.jpg)'
- en: '*Figure 12-10: Querying ELSA for* helpdesk .exe'
  id: totrans-656
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 12-10：查询 ELSA 获取* helpdesk .exe'
- en: '***Identifying the Binary***'
  id: totrans-657
  prefs: []
  type: TYPE_NORMAL
  zh: '***识别二进制文件***'
- en: We know that Bro and SO performed a lookup for the binary based on an
  id: totrans-658
  prefs: []
  type: TYPE_NORMAL
  zh: 我们知道 Bro 和 SO 根据一个
- en: MD5 hash, and we know that a match was found because Bro reported a
  id: totrans-659
  prefs: []
  type: TYPE_NORMAL
  zh: MD5 哈希值，我们知道找到了匹配项，因为 Bro 报告了一个
- en: Malware_Hash_Registry_Match event. We can take a different look at this result
  id: totrans-660
  prefs: []
  type: TYPE_NORMAL
  zh: Malware_Hash_Registry_Match 事件。我们可以以不同的角度查看这个结果
- en: by querying ELSA using the hash and domain method demonstrated ear-
  id: totrans-661
  prefs: []
  type: TYPE_NORMAL
  zh: 通过查询 ELSA，使用前面展示的哈希值和域名方法
- en: lier in Figure 12-8\.
  id: totrans-662
  prefs: []
  type: TYPE_NORMAL
  zh: 如图 12-8 所示。
- en: We’ll modify the query slightly by adding a +127.0.0.2 after the hash
  id: totrans-663
  prefs: []
  type: TYPE_NORMAL
  zh: 我们稍微修改查询，通过在哈希值后添加 +127.0.0.2
- en: and domain. The plus sign (+) tells ELSA to query for the term after it—
  id: totrans-664
  prefs: []
  type: TYPE_NORMAL
  zh: 和域名。加号（+）告诉 ELSA 查询加号后面的术语——
- en: specifically 127.0.0.2, which is the IP address that the MHR returns when
  id: totrans-665
  prefs: []
  type: TYPE_NORMAL
  zh: 特别是 127.0.0.2，这是 MHR 返回的 IP 地址，当
- en: Bro queries it for malware hashes. (We saw this difference in Listing 12-28.)
  id: totrans-666
  prefs: []
  type: TYPE_NORMAL
  zh: Bro 查询它以获取恶意软件哈希值。（我们在列表 12-28 中看到过这个差异。）
- en: Figure 12-11 shows the result of looking for MHR matches for the hash and
  id: totrans-667
  prefs: []
  type: TYPE_NORMAL
  zh: 图 12-11 显示了针对哈希值和
- en: domain b4f990cad1d20efab410e98fc7a6c81b.malware.hash.cymru.com.
  id: totrans-668
  prefs: []
  type: TYPE_NORMAL
  zh: 域名 b4f990cad1d20efab410e98fc7a6c81b.malware.hash.cymru.com。
- en: '*Figure 12-11: Querying ELSA for b4f990cad1d20efab410e98fc7a6c81b.malware.hash.cymru
    .com +127.0.0.2*'
  id: totrans-669
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 12-11：查询 ELSA 获取 b4f990cad1d20efab410e98fc7a6c81b.malware.hash.cymru .com
    +127.0.0.2*'
- en: Extending SO **287**
  id: totrans-670
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展 SO **287**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-671
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '![Image 157](index-322_1.png)'
  id: totrans-672
  prefs: []
  type: TYPE_IMG
  zh: '![Image 157](index-322_1.png)'
- en: We get one result. The presence of the 127.0.0.2 reply tells us that the
  id: totrans-673
  prefs: []
  type: TYPE_NORMAL
  zh: 我们得到一个结果。127.0.0.2 的回复表明
- en: MHR recognized the hash.
  id: totrans-674
  prefs: []
  type: TYPE_NORMAL
  zh: MHR 识别了该哈希值的结果。
- en: 'At this point, we could take a few different paths to identify the binary:'
  id: totrans-675
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，我们可以采取几条不同的路径来识别二进制文件：
- en: • Because the binary is stored in */nsm/bro/extracted/http/http-item_*
  id: totrans-676
  prefs: []
  type: TYPE_NORMAL
  zh: • 因为二进制文件存储在 */nsm/bro/extracted/http/http-item_*
- en: '*192.168.2.108:62585-205.186.148.46:80_resp_1.dat*, we could perform'
  id: totrans-677
  prefs: []
  type: TYPE_NORMAL
  zh: '*192.168.2.108:62585-205.186.148.46:80_resp_1.dat*，我们可以执行'
- en: manual analysis.
  id: totrans-678
  prefs: []
  type: TYPE_NORMAL
  zh: 手动分析。
- en: • We could submit the extracted binary to a third-party engine like VirusTotal.
  id: totrans-679
  prefs: []
  type: TYPE_NORMAL
  zh: • 我们可以将提取的二进制文件提交给像 VirusTotal 这样的第三方引擎。
- en: • We could submit the hash to VirusTotal, which returns the results
  id: totrans-680
  prefs: []
  type: TYPE_NORMAL
  zh: • 我们可以将哈希提交到 VirusTotal，VirusTotal 返回结果
- en: shown in Figure 12-12\.
  id: totrans-681
  prefs: []
  type: TYPE_NORMAL
  zh: 如图 12-12 所示\。
- en: '*Figure 12-12: VirusTotal results for submit ing hash b4f990cad1d20efab410e98fc7a6c81b*
    VirusTotal identifies the malware as a Poison Ivy variant—a popular'
  id: totrans-682
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 12-12：提交哈希 b4f990cad1d20efab410e98fc7a6c81b 的 VirusTotal 结果* VirusTotal
    将该恶意软件识别为 Poison Ivy 变种——一种流行的'
- en: remote-access Trojan (RAT) available from several websites. We hope the
  id: totrans-683
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一种远程访问木马（RAT），可以从多个网站获取。我们希望
- en: user identified through this case downloaded the tool only for testing pur-
  id: totrans-684
  prefs: []
  type: TYPE_NORMAL
  zh: 用户通过此案例识别下载了该工具，仅用于测试目的
- en: poses. If not, it’s time to begin looking for signs of outbound command-
  id: totrans-685
  prefs: []
  type: TYPE_NORMAL
  zh: 如果没有，那么是时候开始寻找出站命令复制的迹象了。
- en: and-control traffic, as described in Chapters 10 and 11\. Good hunting!
  id: totrans-686
  prefs: []
  type: TYPE_NORMAL
  zh: 控制流量，如第 10 和第 11 章所述。祝你好运！
- en: '**conclusion**'
  id: totrans-687
  prefs: []
  type: TYPE_NORMAL
  zh: '**结论**'
- en: This chapter has introduced you to four ways to extend and make better
  id: totrans-688
  prefs: []
  type: TYPE_NORMAL
  zh: 本章向你介绍了四种扩展并改进的方式
- en: use of functions packaged with SO. We covered how Bro creates MD5
  id: totrans-689
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 SO 打包的函数。我们介绍了 Bro 如何创建 MD5
- en: hashes for executables, and showed how to use them with VirusTotal. We
  id: totrans-690
  prefs: []
  type: TYPE_NORMAL
  zh: 为可执行文件计算哈希，并展示了如何使用 VirusTotal。我们
- en: configured Bro to extract executable binaries from network traffic, and
  id: totrans-691
  prefs: []
  type: TYPE_NORMAL
  zh: 配置了 Bro 以从网络流量中提取可执行二进制文件，并
- en: demonstrated how to integrate external intelligence from Mandiant’s APT1
  id: totrans-692
  prefs: []
  type: TYPE_NORMAL
  zh: 演示了如何从 Mandiant 的 APT1 外部智能源进行集成
- en: report. We also generated alerts in Bro to simulate suspicious DNS lookups
  id: totrans-693
  prefs: []
  type: TYPE_NORMAL
  zh: 报告。我们还在 Bro 中生成了警报，以模拟可疑的 DNS 查找
- en: for an APT1 domain. We finished the chapter by showing how SO reports
  id: totrans-694
  prefs: []
  type: TYPE_NORMAL
  zh: 用于 APT1 域的恶意软件。我们通过展示 SO 报告的结构结束了这一章，
- en: and extracts the download of a malicious binary in production, which we
  id: totrans-695
  prefs: []
  type: TYPE_NORMAL
  zh: 并提取生产环境中恶意二进制文件的下载内容，我们
- en: learned was the Poison Ivy RAT.
  id: totrans-696
  prefs: []
  type: TYPE_NORMAL
  zh: 学到的恶意软件是 Poison Ivy RAT。
- en: In the next chapter, we’ll take a look at two challenges to conducting
  id: totrans-697
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将查看进行
- en: 'NSM: proxies and checksums.'
  id: totrans-698
  prefs: []
  type: TYPE_NORMAL
  zh: NSM：代理和校验和。
- en: '**288** Chapter 12'
  id: totrans-699
  prefs: []
  type: TYPE_NORMAL
  zh: '**288** 第 12 章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-700
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '**13**'
  id: totrans-701
  prefs: []
  type: TYPE_NORMAL
  zh: '**13**'
- en: '**P r o x i e S a N D c h e c k S u M S**'
  id: totrans-702
  prefs: []
  type: TYPE_NORMAL
  zh: '**代理和校验和**'
- en: This chapter, aptly number 13, examines
  id: totrans-703
  prefs: []
  type: TYPE_NORMAL
  zh: 本章，恰逢第 13 章，探讨了
- en: two unlucky features of conducting NSM
  id: totrans-704
  prefs: []
  type: TYPE_NORMAL
  zh: 进行 NSM 的两个不幸特征
- en: 'on real networks: proxies and checksums.'
  id: totrans-705
  prefs: []
  type: TYPE_NORMAL
  zh: 在真实网络上：代理和校验和。
- en: The term *proxy* refers to a piece of network infra-
  id: totrans-706
  prefs: []
  type: TYPE_NORMAL
  zh: '*代理* 这个术语指的是网络基础设施的一部分'
- en: structure that some companies use to observe, control,
  id: totrans-707
  prefs: []
  type: TYPE_NORMAL
  zh: 结构是一些公司用来观察、控制、
- en: and accelerate Internet usage. The term *checksum*,
  id: totrans-708
  prefs: []
  type: TYPE_NORMAL
  zh: 加速互联网使用。术语 *校验和*，
- en: in the context of this chapter, refers to an error detection mechanism
  id: totrans-709
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的上下文中，指的是一种错误检测机制
- en: offered by the Internet Protocol (IP). This chapter describes some ways
  id: totrans-710
  prefs: []
  type: TYPE_NORMAL
  zh: 由互联网协议（IP）提供的服务。本章描述了一些方法
- en: to cope with the problems caused by each of these features in operational
  id: totrans-711
  prefs: []
  type: TYPE_NORMAL
  zh: 以应对操作中每个特征所带来的问题
- en: environments.
  id: totrans-712
  prefs: []
  type: TYPE_NORMAL
  zh: 环境。
- en: '**Proxies**'
  id: totrans-713
  prefs: []
  type: TYPE_NORMAL
  zh: '**代理**'
- en: Web proxies are especially popular in corporate environments. One type
  id: totrans-714
  prefs: []
  type: TYPE_NORMAL
  zh: Web 代理在企业环境中特别流行。一种类型
- en: of web proxy is tuned to handle traffic from web clients destined for web
  id: totrans-715
  prefs: []
  type: TYPE_NORMAL
  zh: Web 代理的配置被调整为处理来自 Web 客户端的流量，目标是 Web
- en: servers.
  id: totrans-716
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器。
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-717
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: Some network and security administrators like proxies because they
  id: totrans-718
  prefs: []
  type: TYPE_NORMAL
  zh: 一些网络和安全管理员喜欢代理，因为它们
- en: provide performance and security benefits. With proxies, users sometimes
  id: totrans-719
  prefs: []
  type: TYPE_NORMAL
  zh: 提供性能和安全的好处。使用代理时，用户有时
- en: enjoy better access to content because that content is cached the first time
  id: totrans-720
  prefs: []
  type: TYPE_NORMAL
  zh: 更好地访问内容，因为该内容第一次访问时被缓存
- en: any user views it, with subsequent users enjoying fast access to the cached
  id: totrans-721
  prefs: []
  type: TYPE_NORMAL
  zh: 任何用户查看它后，随后的用户可以享受快速访问缓存
- en: copy. When users must send traffic through a proxy, administrators can try
  id: totrans-722
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户必须通过代理发送流量时，管理员可以尝试
- en: to protect the network by limiting their access to malicious sites.
  id: totrans-723
  prefs: []
  type: TYPE_NORMAL
  zh: 通过限制他们访问恶意网站来保护网络。
- en: Figure 13-1 shows how a web proxy might work in a corporate environ-
  id: totrans-724
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13-1 展示了 Web 代理在企业环境中可能如何工作
- en: ment. Here, a web client with IP address 192.168.2.108 visits a web server
  id: totrans-725
  prefs: []
  type: TYPE_NORMAL
  zh: 在企业环境中，这里有一个 Web 客户端，IP 地址为 192.168.2.108，访问 Web 服务器
- en: at 205.186.148.46\. The web client first establishes a session with the proxy,
  id: totrans-726
  prefs: []
  type: TYPE_NORMAL
  zh: 位于 205.186.148.46。Web 客户端首先与代理建立会话，
- en: labeled CONNECTION 1\. The proxy then connects to the web server on
  id: totrans-727
  prefs: []
  type: TYPE_NORMAL
  zh: 被标记为 CONNECTION 1\。代理然后连接到 Web 服务器
- en: behalf of the client. That session is labeled CONNECTION 2\. All traffic
  id: totrans-728
  prefs: []
  type: TYPE_NORMAL
  zh: 代表客户端的会话。这一会话被标记为连接 2。所有流量
- en: between the client and server occurs over independent connections like
  id: totrans-729
  prefs: []
  type: TYPE_NORMAL
  zh: 客户端与服务器之间的通信通过独立连接发生，像
- en: these.
  id: totrans-730
  prefs: []
  type: TYPE_NORMAL
  zh: 这些。
- en: CONNECTION 1
  id: totrans-731
  prefs: []
  type: TYPE_NORMAL
  zh: 连接 1
- en: CONNECTION 2
  id: totrans-732
  prefs: []
  type: TYPE_NORMAL
  zh: 连接 2
- en: Location X
  id: totrans-733
  prefs: []
  type: TYPE_NORMAL
  zh: 位置 X
- en: Location Y
  id: totrans-734
  prefs: []
  type: TYPE_NORMAL
  zh: 位置 Y
- en: Internet
  id: totrans-735
  prefs: []
  type: TYPE_NORMAL
  zh: 互联网
- en: Web Client
  id: totrans-736
  prefs: []
  type: TYPE_NORMAL
  zh: Web 客户端
- en: Proxy
  id: totrans-737
  prefs: []
  type: TYPE_NORMAL
  zh: 代理
- en: Web Server
  id: totrans-738
  prefs: []
  type: TYPE_NORMAL
  zh: 网络服务器
- en: 192.168.2.108
  id: totrans-739
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.2.108
- en: 'Internal: 192.168.2.1'
  id: totrans-740
  prefs: []
  type: TYPE_NORMAL
  zh: '内部: 192.168.2.1'
- en: 205.186.148.46
  id: totrans-741
  prefs: []
  type: TYPE_NORMAL
  zh: 205.186.148.46
- en: 'External: 172.16.2.1'
  id: totrans-742
  prefs: []
  type: TYPE_NORMAL
  zh: '外部: 172.16.2.1'
- en: '*Figure 13-1: Sample web proxy setup*'
  id: totrans-743
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 13-1：示例 Web 代理设置*'
- en: '***Proxies and Visibility***'
  id: totrans-744
  prefs: []
  type: TYPE_NORMAL
  zh: '***代理与可见性***'
- en: As you can see in Figure 13-1, some elements of visibility are lost when
  id: totrans-745
  prefs: []
  type: TYPE_NORMAL
  zh: 如图 13-1 所示，当部署代理时，一些可见性元素会丧失。
- en: administrators deploy proxies. Instead of seeing only a true source IP
  id: totrans-746
  prefs: []
  type: TYPE_NORMAL
  zh: 管理员部署代理。这样就不再看到真正的源 IP 地址。
- en: address for the web client and a true destination IP address for the web
  id: totrans-747
  prefs: []
  type: TYPE_NORMAL
  zh: 为 Web 客户端提供的地址和 Web 服务器的真正目标 IP 地址
- en: server, we also see internal and external IP addresses for the proxy. The
  id: totrans-748
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器时，我们还会看到代理的内部和外部 IP 地址。该
- en: web client speaks to the proxy, which then speaks to the web server. When
  id: totrans-749
  prefs: []
  type: TYPE_NORMAL
  zh: Web 客户端与代理服务器通信，代理服务器再与 Web 服务器通信。当
- en: the web server replies, the direction is reversed.
  id: totrans-750
  prefs: []
  type: TYPE_NORMAL
  zh: Web 服务器回复时，方向会反转。
- en: For example, an NSM platform watching traffic at location X in
  id: totrans-751
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，在位置 X 监视流量的 NSM 平台，
- en: Figure 13-1 sees traffic with source IP address 192.168.2.108 and destina-
  id: totrans-752
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13-1 显示的流量源 IP 地址为 192.168.2.108，目标 IP 地址为
- en: tion IP address 192.168.2.1\. An NSM platform at location Y sees traffic with
  id: totrans-753
  prefs: []
  type: TYPE_NORMAL
  zh: tion IP 地址 192.168.2.1。位置 Y 的 NSM 平台看到源 IP 地址为
- en: source IP address 172.16.2.1 and destination IP address 205.186.148.46\.
  id: totrans-754
  prefs: []
  type: TYPE_NORMAL
  zh: 源 IP 地址 172.16.2.1 和目标 IP 地址 205.186.148.46。
- en: There doesn’t seem to be a single location where one sensor can see both
  id: totrans-755
  prefs: []
  type: TYPE_NORMAL
  zh: 似乎没有一个单一位置可以让一个传感器同时看到两个
- en: the true source IP address (192.168.2.108) and true destination IP address
  id: totrans-756
  prefs: []
  type: TYPE_NORMAL
  zh: 真实的源 IP 地址（192.168.2.108）和真实的目标 IP 地址
- en: (205.186.148.46) at once. This is a problem for analysts who rely on this
  id: totrans-757
  prefs: []
  type: TYPE_NORMAL
  zh: (205.186.148.46) 一次性连接。这对依赖该信息的分析人员来说是一个问题。
- en: information to detect and respond to intruders.
  id: totrans-758
  prefs: []
  type: TYPE_NORMAL
  zh: 信息用于检测并响应入侵者。
- en: Without access to sufficient logs, NSM analysts may actually see *less*
  id: totrans-759
  prefs: []
  type: TYPE_NORMAL
  zh: 如果没有足够的日志访问权限，NSM 分析人员实际上可能看到的 *更少*。
- en: when proxies are deployed. Sometimes they can access proxy logs, but those
  id: totrans-760
  prefs: []
  type: TYPE_NORMAL
  zh: 部署代理时，有时他们可以访问代理日志，但这些日志
- en: may not be easy to read. Sometimes analysts can capture network traffic
  id: totrans-761
  prefs: []
  type: TYPE_NORMAL
  zh: 可能不容易读取。有时分析人员可以捕获网络流量。
- en: directly on the proxy itself. For example, the proxy in Figure 13-1 is run-
  id: totrans-762
  prefs: []
  type: TYPE_NORMAL
  zh: 直接在代理本身上收集流量。例如，图 13-1 中的代理是运行在
- en: ning the pfSense ( *http://www.pfsense.org/*) firewall with the Squid ( *http://*
  id: totrans-763
  prefs: []
  type: TYPE_NORMAL
  zh: 配置 pfSense（*http://www.pfsense.org/*）防火墙与 Squid（*http://*）
- en: '*www.squid-cache.org/*) web proxy. Because the specific platform is a FreeBSD'
  id: totrans-764
  prefs: []
  type: TYPE_NORMAL
  zh: '*www.squid-cache.org/*) Web 代理。由于特定平台是 FreeBSD'
- en: system in this example, we can collect traffic directly on the server. That
    is
  id: totrans-765
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个示例中，我们可以直接在服务器上收集流量。也就是说，
- en: not usually the case in production, but we will leverage this situation in this
  id: totrans-766
  prefs: []
  type: TYPE_NORMAL
  zh: 这在生产环境中通常不常见，但我们将在本例中利用这种情况。
- en: chapter to gather network traffic and better understand the situation.
  id: totrans-767
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将收集网络流量，以更好地理解情况。
- en: '**290** Chapter 13'
  id: totrans-768
  prefs: []
  type: TYPE_NORMAL
  zh: '**290** 第 13 章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-769
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: Suppose you want to troubleshoot a perceived problem with the proxy
  id: totrans-770
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你想排查代理可能出现的问题
- en: in Figure 13-1\. You decide to log full content traffic in pcap format using
  id: totrans-771
  prefs: []
  type: TYPE_NORMAL
  zh: 如图 13-1 所示。你决定以 pcap 格式记录完整的流量内容，
- en: Tcpdump. You collect traffic from the internal interface in one trace file
  id: totrans-772
  prefs: []
  type: TYPE_NORMAL
  zh: Tcpdump。你从内部接口收集流量，并将其存储在一个跟踪文件中
- en: called *bej-int.pcap*. You then collect traffic in a separate session from the
  id: totrans-773
  prefs: []
  type: TYPE_NORMAL
  zh: 叫做 *bej-int.pcap*。然后，你在与代理服务器分开的会话中收集流量。
- en: external interface in *bej-ext.pcap*. While sniffing each interface, you use
    a
  id: totrans-774
  prefs: []
  type: TYPE_NORMAL
  zh: 外部接口的流量存储在 *bej-ext.pcap* 中。在嗅探每个接口时，你使用
- en: web client on 192.168.2.108 to visit the *www.bejtlich.net* web server.
  id: totrans-775
  prefs: []
  type: TYPE_NORMAL
  zh: Web 客户端在 192.168.2.108 上访问 *www.bejtlich.net* Web 服务器。
- en: In order to look at the contents of the trace file, you manually generate
  id: totrans-776
  prefs: []
  type: TYPE_NORMAL
  zh: 为了查看跟踪文件的内容，你手动生成
- en: a transcript using Tcpflow ( *https://github.com/simsong/tcpflow/*), as shown
    in Listing 13-1\.
  id: totrans-777
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Tcpflow 生成的转储（*https://github.com/simsong/tcpflow/*），如清单 13-1 所示。
- en: $ **tcpflow -r bej-int.pcap**
  id: totrans-778
  prefs: []
  type: TYPE_NORMAL
  zh: $ **tcpflow -r bej-int.pcap**
- en: $ **ls -al**
  id: totrans-779
  prefs: []
  type: TYPE_NORMAL
  zh: $ **ls -al**
- en: total 56
  id: totrans-780
  prefs: []
  type: TYPE_NORMAL
  zh: 总计 56
- en: drwxrwxr-x 3 ds61so ds61so 4096 Apr 23 20:14 .
  id: totrans-781
  prefs: []
  type: TYPE_NORMAL
  zh: drwxrwxr-x 3 ds61so ds61so 4096 Apr 23 20:14 .
- en: drwxrwxr-x 4 ds61so ds61so 4096 Apr 23 20:05 ..
  id: totrans-782
  prefs: []
  type: TYPE_NORMAL
  zh: drwxrwxr-x 4 ds61so ds61so 4096 Apr 23 20:05 ..
- en: -rw-rw-r-- 1 ds61so ds61so 3605 Apr 21 20:53 172.016.002.001.03128-192.168.002.108.50949u
  id: totrans-783
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-rw-r-- 1 ds61so ds61so 3605 Apr 21 20:53 172.016.002.001.03128-192.168.002.108.50949u
- en: '-rw-rw-r-- 1 ds61so ds61so 376 Apr 21 20:53 192.168.002.108.50949-172.016.002.001.03128v
    *Listing 13-1: Using Tcpflow to generate transcripts manual y on the* bej-int
    .pcap *trace file* When run in this manner, Tcpflow generates two files. The first
    is traffic from the proxy to the client u. The second is traffic from the client
    to'
  id: totrans-784
  prefs: []
  type: TYPE_NORMAL
  zh: "-rw-rw-r-- 1 ds61so ds61so 376 Apr 21 20:53 192.168.002.108.50949-172.016.002.001.03128v\
    \ *Listing 13-1: ä½¿ç\x94¨ Tcpflow ç\x94\x9Fæ\x88\x90è½¬å½\x95æ\x89\x8Bå\x8A¨\
    \ y å\x9C¨* bej-int .pcap *è·\x9Fè¸ªæ\x96\x87ä»¶* è¿\x90è¡\x8Cæ\x97¶ï¼\x8CTcpflow\
    \ ä¼\x9Aç\x94\x9Fæ\x88\x90ä¸¤ä¸ªæ\x96\x87ä»¶ã\x80\x82ç¬¬ä¸\x80ä¸ªæ\x98¯ä»\x8E\
    ä»£ç\x90\x86å\x88°å®¢æ\x88·ç«¯ç\x9A\x84æµ\x81é\x87\x8F uã\x80\x82ç¬¬äº\x8Cä¸ªæ\x98\
    ¯ä»\x8Eå®¢æ\x88·ç«¯å\x88°"
- en: the proxy v.
  id: totrans-785
  prefs: []
  type: TYPE_NORMAL
  zh: "ä»£ç\x90\x86 v."
- en: '**traffic from the Client to the Proxy**'
  id: totrans-786
  prefs: []
  type: TYPE_NORMAL
  zh: "**å®¢æ\x88·ç«¯å\x88°ä»£ç\x90\x86ç\x9A\x84æµ\x81é\x87\x8F**"
- en: Listing 13-2 shows the traffic from the client to the proxy in this example.
  id: totrans-787
  prefs: []
  type: TYPE_NORMAL
  zh: "Listing 13-2 æ\x98¾ç¤ºäº\x86å®¢æ\x88·ç«¯å\x88°ä»£ç\x90\x86ç\x9A\x84æµ\x81é\x87\
    \x8Fã\x80\x82"
- en: $ **cat 192.168.002.108.50949-172.016.002.001.03128**
  id: totrans-788
  prefs: []
  type: TYPE_NORMAL
  zh: $ **cat 192.168.002.108.50949-172.016.002.001.03128**
- en: GET http://www.bejtlich.net/u HTTP/1.1
  id: totrans-789
  prefs: []
  type: TYPE_NORMAL
  zh: GET http://www.bejtlich.net/u HTTP/1.1
- en: 'Host: www.bejtlich.net'
  id: totrans-790
  prefs: []
  type: TYPE_NORMAL
  zh: 'Host: www.bejtlich.net'
- en: 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:20.0) Gecko/20100101
    Firefox/20.0'
  id: totrans-791
  prefs: []
  type: TYPE_NORMAL
  zh: 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:20.0) Gecko/20100101
    Firefox/20.0'
- en: 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'
  id: totrans-792
  prefs: []
  type: TYPE_NORMAL
  zh: 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'
- en: 'Accept-Language: en-US,en;q=0.5'
  id: totrans-793
  prefs: []
  type: TYPE_NORMAL
  zh: 'Accept-Language: en-US,en;q=0.5'
- en: 'Accept-Encoding: gzip, deflate'
  id: totrans-794
  prefs: []
  type: TYPE_NORMAL
  zh: 'Accept-Encoding: gzip, deflate'
- en: 'DNT: 1'
  id: totrans-795
  prefs: []
  type: TYPE_NORMAL
  zh: 'DNT: 1'
- en: 'Referer: http://www.taosecurity.com/training.html'
  id: totrans-796
  prefs: []
  type: TYPE_NORMAL
  zh: 'Referer: http://www.taosecurity.com/training.html'
- en: 'Connection: keep-alive'
  id: totrans-797
  prefs: []
  type: TYPE_NORMAL
  zh: 'Connection: keep-alive'
- en: '*Listing 13-2: Traffic from the client to the proxy*'
  id: totrans-798
  prefs: []
  type: TYPE_NORMAL
  zh: "*Listing 13-2: å®¢æ\x88·ç«¯å\x88°ä»£ç\x90\x86ç\x9A\x84æµ\x81é\x87\x8F*"
- en: At location X, notice that the GET request for *http://www.bejtlich.net/* u
    is a bit different from normal GET requests. Unproxied web traffic would make
    a
  id: totrans-799
  prefs: []
  type: TYPE_NORMAL
  zh: "å\x9C¨ä½\x8Dç½® Xï¼\x8Cè¯·æ³¨æ\x84\x8Fï¼\x8CGET è¯·æ±\x82 *http://www.bejtlich.net/*\
    \ u ä¸\x8Eæ­£å¸¸ç\x9A\x84 GET è¯·æ±\x82ç¨\x8Dæ\x9C\x89ä¸\x8Då\x90\x8Cã\x80\x82\
    æ\x9Cªç»\x8Fè¿\x87ä»£ç\x90\x86ç\x9A\x84 Web æµ\x81é\x87\x8Få°\x86ä¼\x9Aæ\x98¯"
- en: GET request to the / directory, not the entire URL, with something like GET
    /.
  id: totrans-800
  prefs: []
  type: TYPE_NORMAL
  zh: "GET è¯·æ±\x82å\x88° / ç\x9B®å½\x95ï¼\x8Cè\x80\x8Cä¸\x8Dæ\x98¯æ\x95´ä¸ª URLï¼\x8C\
    ç±»ä¼¼äº\x8E GET /ã\x80\x82"
- en: Listing 13-3 shows the response from the proxy.
  id: totrans-801
  prefs: []
  type: TYPE_NORMAL
  zh: "Listing 13-3 æ\x98¾ç¤ºäº\x86æ\x9D¥è\x87ªä»£ç\x90\x86ç\x9A\x84å\x93\x8Dåº\x94\
    ã\x80\x82"
- en: Proxies and Checksums **291**
  id: totrans-802
  prefs: []
  type: TYPE_NORMAL
  zh: "ä»£ç\x90\x86å\x92\x8Cæ ¡éª\x8Cå\x92\x8C **291**"
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-803
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: $ **cat 172.016.002.001.03128-192.168.002.108.50949**
  id: totrans-804
  prefs: []
  type: TYPE_NORMAL
  zh: $ **cat 172.016.002.001.03128-192.168.002.108.50949**
- en: HTTP/1.0 200 OK
  id: totrans-805
  prefs: []
  type: TYPE_NORMAL
  zh: HTTP/1.0 200 OK
- en: 'Date: Sun, 21 Apr 2013 20:53:38 GMT'
  id: totrans-806
  prefs: []
  type: TYPE_NORMAL
  zh: 'Date: Sun, 21 Apr 2013 20:53:38 GMT'
- en: 'Server: Apache/2'
  id: totrans-807
  prefs: []
  type: TYPE_NORMAL
  zh: 'Server: Apache/2'
- en: 'Last-Modified: Wed, 02 Jan 2013 15:49:44 GMT'
  id: totrans-808
  prefs: []
  type: TYPE_NORMAL
  zh: 'Last-Modified: Wed, 02 Jan 2013 15:49:44 GMT'
- en: 'ETag: "2e800ed-c713-4d25031f1f600"'
  id: totrans-809
  prefs: []
  type: TYPE_NORMAL
  zh: 'ETag: "2e800ed-c713-4d25031f1f600"'
- en: 'Accept-Ranges: bytes'
  id: totrans-810
  prefs: []
  type: TYPE_NORMAL
  zh: 'Accept-Ranges: bytes'
- en: 'Content-Length: 3195'
  id: totrans-811
  prefs: []
  type: TYPE_NORMAL
  zh: 'Content-Length: 3195'
- en: 'Content-Type: text/html; charset=UTF-8'
  id: totrans-812
  prefs: []
  type: TYPE_NORMAL
  zh: 'Content-Type: text/html; charset=UTF-8'
- en: 'X-Cache: MISS from localhostu'
  id: totrans-813
  prefs: []
  type: TYPE_NORMAL
  zh: 'X-Cache: MISS from localhostu'
- en: 'X-Cache-Lookup: MISS from localhost:3128v'
  id: totrans-814
  prefs: []
  type: TYPE_NORMAL
  zh: 'X-Cache-Lookup: MISS from localhost:3128v'
- en: 'Via: 1.1 localhost:3128 (squid/2.7.STABLE9)w'
  id: totrans-815
  prefs: []
  type: TYPE_NORMAL
  zh: 'Via: 1.1 localhost:3128 (squid/2.7.STABLE9)w'
- en: 'Connection: keep-alive'
  id: totrans-816
  prefs: []
  type: TYPE_NORMAL
  zh: 'Connection: keep-alive'
- en: 'Proxy-Connection: keep-alivex'
  id: totrans-817
  prefs: []
  type: TYPE_NORMAL
  zh: 'Proxy-Connection: keep-alivex'
- en: y<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/
  id: totrans-818
  prefs: []
  type: TYPE_NORMAL
  zh: y<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/
- en: xhtml1-strict.dtd">
  id: totrans-819
  prefs: []
  type: TYPE_NORMAL
  zh: xhtml1-strict.dtd">
- en: <html xml:lang="en">
  id: totrans-820
  prefs: []
  type: TYPE_NORMAL
  zh: <html xml:lang="en">
- en: <head>
  id: totrans-821
  prefs: []
  type: TYPE_NORMAL
  zh: <head>
- en: <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
  id: totrans-822
  prefs: []
  type: TYPE_NORMAL
  zh: <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
- en: <meta name="Richard Bejtlich" content="Home page of TaoSecurity founder Richard
    Bejtlich" />
  id: totrans-823
  prefs: []
  type: TYPE_NORMAL
  zh: "<meta name=\"Richard Bejtlich\" content=\"TaoSecurity å\x88\x9Bå§\x8Bäºº Richard\
    \ Bejtlich ç\x9A\x84ä¸»é¡µ\" />"
- en: <meta name="keywords" content="bejtlich,taosecurity,network,security" />
  id: totrans-824
  prefs: []
  type: TYPE_NORMAL
  zh: <meta name="keywords" content="bejtlich,taosecurity,network,security" />
- en: '*-- snip --*'
  id: totrans-825
  prefs: []
  type: TYPE_NORMAL
  zh: '*-- snip --*'
- en: '*Listing 13-3: Traffic from proxy to client as seen at location X*'
  id: totrans-826
  prefs: []
  type: TYPE_NORMAL
  zh: "*Listing 13-3: ä»£ç\x90\x86å\x88°å®¢æ\x88·ç«¯ç\x9A\x84æµ\x81é\x87\x8Fï¼\x8C\
    å¦\x82ä½\x8Dç½® X æ\x89\x80è§\x81*"
- en: Listing 13-3 includes four headers indicating that a proxy is involved.
  id: totrans-827
  prefs: []
  type: TYPE_NORMAL
  zh: "Listing 13-3 å\x8C\Nå\x90«å\x9B\x9Bä¸ªå¤´é\x83¨ï¼\x8Cè¡¨ç¤ºä»£ç\x90\x86å\x9C\
    ¨å\N¶ä¸­èµ·ä½\x9Cç\x94¨ã\x80\x82"
- en: The headers at u and v show that the proxy didn’t have a locally cached
  id: totrans-828
  prefs: []
  type: TYPE_NORMAL
  zh: "u å\x92\x8C v ä¸­ç\x9A\x84å¤´é\x83¨æ\x98¾ç¤ºä»£ç\x90\x86æ²¡æ\x9C\x89æ\x9C¬å\x9C\
    °ç¼\x93å­\x98ã\x80\x82"
- en: copy of the requested content. The headers at w and x report the nature
  id: totrans-829
  prefs: []
  type: TYPE_NORMAL
  zh: "è¯·æ±\x82å\x86\Nå®¹ç\x9A\x84å\x89¯æ\x9C¬ã\x80\x82w å\x92\x8C x ä¸­ç\x9A\x84\
    å¤´é\x83¨æ\x8A¥å\x91\x8Aäº\x86ä»£ç\x90\x86è¿\x9Eæ\x8E¥ç\x9A\x84æ\x80§è´¨ã\x80\x82"
- en: of the proxy connection. The last part, at y, shows the beginning of the
  id: totrans-830
  prefs: []
  type: TYPE_NORMAL
  zh: "ä»£ç\x90\x86è¿\x9Eæ\x8E¥ç\x9A\x84æ\x9C\x80å\x90\x8Eé\x83¨å\x88\x86ï¼\x8Cä½\x8D\
    äº\x8E yï¼\x8Cæ\x98¾ç¤ºäº\x86å\x93\x8Dåº\x94ç\x9A\x84å¼\x80å§\x8Bã\x80\x82"
- en: web page hosted at 205.186.148.46\.
  id: totrans-831
  prefs: []
  type: TYPE_NORMAL
  zh: "æ\x89\x98ç®¡å\x9C¨ 205.186.148.46 ç\x9A\x84ç½\x91é¡µ\\ã\x80\x82"
- en: '**traffic from the Proxy to the Web Server**'
  id: totrans-832
  prefs: []
  type: TYPE_NORMAL
  zh: "**ä»£ç\x90\x86å\x88° Web æ\x9C\x8Då\x8A¡å\x99¨ç\x9A\x84æµ\x81é\x87\x8F**"
- en: Now let’s use Tcpflow to see what traffic looks like when it goes from the
  id: totrans-833
  prefs: []
  type: TYPE_NORMAL
  zh: "ç\x8E°å\x9C¨è®©æ\x88\x91ä»¬ä½¿ç\x94¨ Tcpflow æ\x9D¥æ\x9F¥ç\x9C\x8Bä»\x8Eä»£ç\x90\
    \x86å\x88°å®¢æ\x88·ç«¯ç\x9A\x84æµ\x81é\x87\x8Fã\x80\x82"
- en: proxy to a web server, as seen at location Y. Listing 13-4 shows how to gener-
  id: totrans-834
  prefs: []
  type: TYPE_NORMAL
  zh: "ä»£ç\x90\x86å\x88° Web æ\x9C\x8Då\x8A¡å\x99¨ï¼\x8Cå¦\x82ä½\x8Dç½® Y æ\x89\x80\
    è§\x81ã\x80\x82Listing 13-4 æ\x98¾ç¤ºäº\x86å¦\x82ä½\x95ç\x94\x9Fæ\x88\x90"
- en: ate the transcripts against trace file *bej-ext.pcap*, which was captured on
    the proxy interface facing the web server.
  id: totrans-835
  prefs: []
  type: TYPE_NORMAL
  zh: "å°\x86è½¬å½\x95æ\x96\x87ä»¶ä¸\x8E trace æ\x96\x87ä»¶ *bej-ext.pcap* è¿\x9B\
    è¡\x8Cæ¯\x94å¯¹ï¼\x8Cå\x90\x8Eè\x80\Næ\x98¯å\x9C¨é\x9D¢å\x90\x91 Web æ\x9C\x8D\
    å\x8A¡å\x99¨ç\x9A\x84ä»£ç\x90\x86æ\x8E¥å\x8F£ä¸\x8Aæ\x8D\x95è\x8E·ç\x9A\x84ã\x80\
    \x82"
- en: $ **tcpflow -r bej-ext.pcap**
  id: totrans-836
  prefs: []
  type: TYPE_NORMAL
  zh: $ **tcpflow -r bej-ext.pcap**
- en: $ **ls -al**
  id: totrans-837
  prefs: []
  type: TYPE_NORMAL
  zh: $ **ls -al**
- en: total 20
  id: totrans-838
  prefs: []
  type: TYPE_NORMAL
  zh: total 20
- en: drwxrwxr-x 2 ds61so ds61so 4096 Apr 23 20:33 .
  id: totrans-839
  prefs: []
  type: TYPE_NORMAL
  zh: drwxrwxr-x 2 ds61so ds61so 4096 Apr 23 20:33 .
- en: drwxrwxr-x 3 ds61so ds61so 4096 Apr 23 20:32 ..
  id: totrans-840
  prefs: []
  type: TYPE_NORMAL
  zh: drwxrwxr-x 3 ds61so ds61so 4096 Apr 23 20:32 ..
- en: -rw-rw-r-- 1 ds61so ds61so 461 Apr 21 20:53 192.168.001.002.02770-205.186.148.046.00080u
  id: totrans-841
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-rw-r-- 1 ds61so ds61so 461 Apr 21 20:53 192.168.001.002.02770-205.186.148.046.00080u
- en: '-rw-rw-r-- 1 ds61so ds61so 3453 Apr 21 20:53 205.186.148.046.00080-192.168.001.002.02770v
    *Listing 13-4: Using Tcpflow to generate transcripts manual y on the* bej-ext
    .pcap *trace file* **292** Chapter 13'
  id: totrans-842
  prefs: []
  type: TYPE_NORMAL
  zh: "-rw-rw-r-- 1 ds61so ds61so 3453 Apr 21 20:53 205.186.148.046.00080-192.168.001.002.02770v\
    \ *å\x88\x97è¡¨ 13-4ï¼\x9Aä½¿ç\x94¨ Tcpflow ç\x94\x9Fæ\x88\x90è½¬å½\x95æ\x89\x8B\
    å\x86\x8Cä¸­ç\x9A\x84 bej-ext .pcap *è·\x9Fè¸ªæ\x96\x87ä»¶* **292** ç¬¬ 13 ç« "
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-843
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: 'Again, Tcpflow generates two files: traffic from the proxy to the'
  id: totrans-844
  prefs: []
  type: TYPE_NORMAL
  zh: "å\x86\x8Dæ¬¡ï¼\x8CTcpflow ç\x94\x9Fæ\x88\x90äº\x86ä¸¤ä¸ªæ\x96\x87ä»¶ï¼\x9A\
    é¦\x96å\N\x88æ\x98¯ä»\x8Eä»£ç\x90\x86å\x88°"
- en: server u and traffic from the server to the proxy v. Let’s look at traffic
  id: totrans-845
  prefs: []
  type: TYPE_NORMAL
  zh: "æ\x9C\x8Då\x8A¡å\x99¨ u å\x92\x8Cä»\x8Eæ\x9C\x8Då\x8A¡å\x99¨å\x88°ä»£ç\x90\x86\
    ç\x9A\x84æµ\x81é\x87\x8F vã\x80\x82è®©æ\x88\x91ä»¬æ\x9D¥ç\x9C\x8Bç\x9C\x8Bæµ\x81\
    é\x87\x8F"
- en: from the proxy to the server first, as shown in Listing 13-5\.
  id: totrans-846
  prefs: []
  type: TYPE_NORMAL
  zh: "ä»\x8Eä»£ç\x90\x86å\x88°æ\x9C\x8Då\x8A¡å\x99¨ç\x9A\x84æµ\x81é\x87\x8Fï¼\x8C\
    é¦\x96å\N\x88å¦\x82å\x88\x97è¡¨ 13-5 æ\x89\x80ç¤º\\ã\x80\x82"
- en: $ **cat 192.168.001.002.02770-205.186.148.046.00080**
  id: totrans-847
  prefs: []
  type: TYPE_NORMAL
  zh: $ **cat 192.168.001.002.02770-205.186.148.046.00080**
- en: GET /u HTTP/1.0
  id: totrans-848
  prefs: []
  type: TYPE_NORMAL
  zh: GET /u HTTP/1.0
- en: 'Host: www.bejtlich.net'
  id: totrans-849
  prefs: []
  type: TYPE_NORMAL
  zh: 'Host: www.bejtlich.net'
- en: 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:20.0) Gecko/20100101
    Firefox/20.0'
  id: totrans-850
  prefs: []
  type: TYPE_NORMAL
  zh: 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:20.0) Gecko/20100101
    Firefox/20.0'
- en: 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'
  id: totrans-851
  prefs: []
  type: TYPE_NORMAL
  zh: 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'
- en: 'Accept-Language: en-US,en;q=0.5'
  id: totrans-852
  prefs: []
  type: TYPE_NORMAL
  zh: 'Accept-Language: en-US,en;q=0.5'
- en: 'Accept-Encoding: gzip, deflate'
  id: totrans-853
  prefs: []
  type: TYPE_NORMAL
  zh: 'Accept-Encoding: gzip, deflate'
- en: 'DNT: 1'
  id: totrans-854
  prefs: []
  type: TYPE_NORMAL
  zh: 'DNT: 1'
- en: 'Referer: http://www.taosecurity.com/training.html'
  id: totrans-855
  prefs: []
  type: TYPE_NORMAL
  zh: 'Referer: http://www.taosecurity.com/training.html'
- en: 'Via: 1.1 localhost:3128 (squid/2.7.STABLE9)v'
  id: totrans-856
  prefs: []
  type: TYPE_NORMAL
  zh: 'Via: 1.1 localhost:3128 (squid/2.7.STABLE9)v'
- en: 'X-Forwarded-For: 192.168.2.108w'
  id: totrans-857
  prefs: []
  type: TYPE_NORMAL
  zh: 'X-Forwarded-For: 192.168.2.108w'
- en: 'Cache-Control: max-age=259200'
  id: totrans-858
  prefs: []
  type: TYPE_NORMAL
  zh: 'Cache-Control: max-age=259200'
- en: 'Connection: keep-alive'
  id: totrans-859
  prefs: []
  type: TYPE_NORMAL
  zh: 'Connection: keep-alive'
- en: '*Listing 13-5: Traffic from the proxy to the server as seen at location Y*'
  id: totrans-860
  prefs: []
  type: TYPE_NORMAL
  zh: "*å\x88\x97è¡¨ 13-5ï¼\x9Aå\x9C¨ä½\x8Dç½® Y ç\x9C\x8Bå\x88°ç\x9A\x84ä»\x8Eä»£ç\x90\
    \x86å\x88°æ\x9C\x8Då\x8A¡å\x99¨ç\x9A\x84æµ\x81é\x87\x8F*"
- en: 'Listing 13-5 includes several interesting features:'
  id: totrans-861
  prefs: []
  type: TYPE_NORMAL
  zh: "å\x88\x97è¡¨ 13-5 å\x8C\Nå\x90«å\x87 ä¸ªæ\x9C\x89è¶£ç\x9A\x84ç\x89¹æ\x80§ï¼\x9A"
- en: • The resource visited by the proxy via the GET / request u resembles nor-
  id: totrans-862
  prefs: []
  type: TYPE_NORMAL
  zh: "â\x80¢ é\x80\x9Aè¿\x87 GET / è¯·æ±\x82 uï¼\x8Cä»£ç\x90\x86è®¿é\x97®ç\x9A\x84\
    èµ\x84æº\x90ç±»ä¼¼äº\x8Eå¸¸è§\x81ç\x9A\x84"
- en: mal web traffic seen elsewhere in the book. However, it differs from the
  id: totrans-863
  prefs: []
  type: TYPE_NORMAL
  zh: "ä¹¦ä¸­å\N¶ä»\x96å\x9C°æ\x96¹ç\x9C\x8Bå\x88°ç\x9A\x84æ\x81¶æ\x84\x8Fç½\x91é¡µæµ\x81\
    é\x87\x8Fã\x80\x82ç\x84¶è\x80\x8Cï¼\x8Cå®\x83ä¸\x8E"
- en: proxied request shown in Listing 13-2\.
  id: totrans-864
  prefs: []
  type: TYPE_NORMAL
  zh: "å¦\x82å\x88\x97è¡¨ 13-2 æ\x89\x80ç¤ºç\x9A\x84ä»£ç\x90\x86è¯·æ±\x82\\ã\x80\x82"
- en: • The proxy includes a Via statement v indicating the involvement of a
  id: totrans-865
  prefs: []
  type: TYPE_NORMAL
  zh: "â\x80¢ ä»£ç\x90\x86å\x8C\Næ\x8B¬ä¸\x80ä¸ª Via å£°æ\x98\x8E vï¼\x8Cè¡¨æ\x98\x8E\
    æ¶\x89å\x8F\x8Aäº\x86ä¸\x80ä¸ª"
- en: Squid proxy.
  id: totrans-866
  prefs: []
  type: TYPE_NORMAL
  zh: "Squid ä»£ç\x90\x86ã\x80\x82"
- en: • The proxy reveals the true source IP address of the client making the
  id: totrans-867
  prefs: []
  type: TYPE_NORMAL
  zh: "â\x80¢ ä»£ç\x90\x86æ\x9A´é\x9C²äº\x86å®¢æ\x88·ç«¯ç\x9A\x84ç\x9C\x9Få®\x9Eæº\x90\
    \ IP å\x9C°å\x9D\x80"
- en: web request in the X-Forwarded-For statement w.
  id: totrans-868
  prefs: []
  type: TYPE_NORMAL
  zh: "å\x9C¨ X-Forwarded-For å£°æ\x98\x8E w ä¸­ç\x9A\x84ç½\x91é¡µè¯·æ±\x82ã\x80\x82"
- en: '**N o T e**'
  id: totrans-869
  prefs: []
  type: TYPE_NORMAL
  zh: '**æ³¨**'
- en: '*Some security analysts worry that these “features,” especially the X-Forwarded-For*
    *statement, will allow intruders operating malicious websites to see these headers
    and* *learn how a company’s internal network is configured. Security teams must
    balance* *the added visibility they gain against a perceived leakage of potentially
    sensitive information to outsiders.*'
  id: totrans-870
  prefs: []
  type: TYPE_NORMAL
  zh: "*ä¸\x80äº\x9Bå®\x89å\N¨å\x88\x86æ\x9E\x90å¸\x88æ\x8B\Nå¿\x83è¿\x99äº\x9Bâ\x80\
    \x9Cç\x89¹æ\x80§â\x80\x9Dï¼\x8Cç\x89¹å\x88«æ\x98¯ X-Forwarded-For* *å£°æ\x98\x8E\
    ï¼\x8Cä¼\x9Aå\N\x81è®¸æ\x93\x8Dä½\x9Cæ\x81¶æ\x84\x8Fç½\x91ç«\x99ç\x9A\x84å\N¥ä¾µè\x80\
    \Nç\x9C\x8Bå\x88°è¿\x99äº\x9Bå¤´ä¿¡æ\x81¯ï¼\x8Cå¹¶* *äº\x86è§£å\N¬å\x8F¸ç\x9A\x84\
    å\x86\Né\x83¨ç½\x91ç»\x9Cæ\x98¯å¦\x82ä½\x95é\N\x8Dç½®ç\x9A\x84ã\x80\x82å®\x89\
    å\N¨å\x9B¢é\x98\x9Få¿\Né¡»å¹³è¡¡* *ä»\x96ä»¬è\x8E·å¾\x97ç\x9A\x84å\x8F¯è§\x81\
    æ\x80§ä¸\x8Eå\x8F¯è\x83½æ³\x84é\x9C²ç\x9A\x84æ\x95\x8Fæ\x84\x9Fä¿¡æ\x81¯ä¹\x8B\
    é\x97´ç\x9A\x84é£\x8Eé\x99©ã\x80\x82*"
- en: Listing 13-6 shows the response from the server.
  id: totrans-871
  prefs: []
  type: TYPE_NORMAL
  zh: "å\x88\x97è¡¨ 13-6 æ\x98¾ç¤ºäº\x86æ\x9D¥è\x87ªæ\x9C\x8Då\x8A¡å\x99¨ç\x9A\x84\
    å\x93\x8Dåº\x94ã\x80\x82"
- en: $ **cat 205.186.148.046.00080-192.168.001.002.02770**
  id: totrans-872
  prefs: []
  type: TYPE_NORMAL
  zh: $ **cat 205.186.148.046.00080-192.168.001.002.02770**
- en: HTTP/1.1 200 OK
  id: totrans-873
  prefs: []
  type: TYPE_NORMAL
  zh: HTTP/1.1 200 OK
- en: 'Date: Sun, 21 Apr 2013 20:53:38 GMT'
  id: totrans-874
  prefs: []
  type: TYPE_NORMAL
  zh: 'Date: Sun, 21 Apr 2013 20:53:38 GMT'
- en: 'Server: Apache/2'
  id: totrans-875
  prefs: []
  type: TYPE_NORMAL
  zh: 'Server: Apache/2'
- en: 'Last-Modified: Wed, 02 Jan 2013 15:49:44 GMT'
  id: totrans-876
  prefs: []
  type: TYPE_NORMAL
  zh: 'Last-Modified: Wed, 02 Jan 2013 15:49:44 GMT'
- en: 'ETag: "2e800ed-c713-4d25031f1f600"'
  id: totrans-877
  prefs: []
  type: TYPE_NORMAL
  zh: 'ETag: "2e800ed-c713-4d25031f1f600"'
- en: 'Accept-Ranges: bytes'
  id: totrans-878
  prefs: []
  type: TYPE_NORMAL
  zh: 'Accept-Ranges: bytes'
- en: 'Content-Length: 3195'
  id: totrans-879
  prefs: []
  type: TYPE_NORMAL
  zh: 'Content-Length: 3195'
- en: 'Connection: close'
  id: totrans-880
  prefs: []
  type: TYPE_NORMAL
  zh: 'Connection: close'
- en: 'Content-Type: text/html; charset=UTF-8'
  id: totrans-881
  prefs: []
  type: TYPE_NORMAL
  zh: 'Content-Type: text/html; charset=UTF-8'
- en: Proxies and Checksums **293**
  id: totrans-882
  prefs: []
  type: TYPE_NORMAL
  zh: "ä»£ç\x90\x86å\x92\x8Cæ ¡éª\x8Cå\x92\x8C **293**"
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-883
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/
  id: totrans-884
  prefs: []
  type: TYPE_NORMAL
  zh: <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/
- en: xhtml1-strict.dtd">
  id: totrans-885
  prefs: []
  type: TYPE_NORMAL
  zh: xhtml1-strict.dtd">
- en: <html xml:lang="en">
  id: totrans-886
  prefs: []
  type: TYPE_NORMAL
  zh: <html xml:lang="en">
- en: <head>
  id: totrans-887
  prefs: []
  type: TYPE_NORMAL
  zh: <head>
- en: <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
  id: totrans-888
  prefs: []
  type: TYPE_NORMAL
  zh: <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
- en: <meta name="Richard Bejtlich" content="Home page of TaoSecurity founder Richard
    Bejtlich" />
  id: totrans-889
  prefs: []
  type: TYPE_NORMAL
  zh: "<meta name=\"Richard Bejtlich\" content=\"TaoSecurity å\x88\x9Bå§\x8Bäºº Richard\
    \ Bejtlich ç\x9A\x84ä¸»é¡µ\" />"
- en: <meta name="keywords" content="bejtlich,taosecurity,network,security" />
  id: totrans-890
  prefs: []
  type: TYPE_NORMAL
  zh: <meta name="keywords" content="bejtlich,taosecurity,network,security" />
- en: '*-- snip --*'
  id: totrans-891
  prefs: []
  type: TYPE_NORMAL
  zh: "*-- æ\x88ªæ\x96­ --*"
- en: '*Listing 13-6: Traffic from the server to the proxy as seen at location Y*'
  id: totrans-892
  prefs: []
  type: TYPE_NORMAL
  zh: "*å\x88\x97è¡¨ 13-6ï¼\x9Aå\x9C¨ä½\x8Dç½® Y ç\x9C\x8Bå\x88°ç\x9A\x84ä»\x8Eæ\x9C\
    \x8Då\x8A¡å\x99¨å\x88°ä»£ç\x90\x86ç\x9A\x84æµ\x81é\x87\x8F*"
- en: As far as the web server in Listing 13-6 is concerned, the proxy is the sys-
  id: totrans-893
  prefs: []
  type: TYPE_NORMAL
  zh: "å°±å\x88\x97è¡¨ 13-6 ä¸­ç\x9A\x84ç½\x91é¡µæ\x9C\x8Då\x8A¡å\x99¨è\x80\x8Cè¨\x80\
    ï¼\x8Cä»£ç\x90\x86æ\x98¯ sys-"
- en: tem making the request. There is nothing special about what it sends back.
  id: totrans-894
  prefs: []
  type: TYPE_NORMAL
  zh: 发起请求的系统。它返回的内容没有特别之处。
- en: (Notice in Listing 13-3 how the two differ, paying particular attention to
  id: totrans-895
  prefs: []
  type: TYPE_NORMAL
  zh: （请注意，在Listing 13-3中如何比较二者，特别是要关注
- en: the headers added by the proxy.)
  id: totrans-896
  prefs: []
  type: TYPE_NORMAL
  zh: 代理添加的头部信息。）
- en: '***Dealing with Proxies in Production Networks***'
  id: totrans-897
  prefs: []
  type: TYPE_NORMAL
  zh: '***处理生产网络中的代理***'
- en: 'CIRTs have four options when dealing with proxies in production networks:'
  id: totrans-898
  prefs: []
  type: TYPE_NORMAL
  zh: CIRTs在处理生产网络中的代理时有四种选择：
- en: 1\. Try to gain access to the logs generated by a proxy in order to see traf-
  id: totrans-899
  prefs: []
  type: TYPE_NORMAL
  zh: 1. 尝试获取由代理生成的日志，以便查看流量。
- en: fic from the proxy’s perspective.
  id: totrans-900
  prefs: []
  type: TYPE_NORMAL
  zh: 从代理的角度来看。
- en: 2\. Use the techniques described in Chapter 2 to deploy multiple sensors
  id: totrans-901
  prefs: []
  type: TYPE_NORMAL
  zh: 2. 使用第二章中描述的技术部署多个传感器。
- en: with appropriate visibility. In this respect, a proxy is like a NAT issue—
  id: totrans-902
  prefs: []
  type: TYPE_NORMAL
  zh: 这方面，代理就像NAT问题——
- en: put sensors where you need them in order to see true source and desti-
  id: totrans-903
  prefs: []
  type: TYPE_NORMAL
  zh: 将传感器放置在需要的位置，以便查看真实的源和目的。
- en: nation IP addresses.
  id: totrans-904
  prefs: []
  type: TYPE_NORMAL
  zh: 国家IP地址。
- en: 3\. Make more extensive use of the information kept inside logs generated
  id: totrans-905
  prefs: []
  type: TYPE_NORMAL
  zh: 3. 更广泛地利用生成的日志中保存的信息。
- en: by proxy-aware NSM software. As shown in the transcripts in Listings 13-2,
  id: totrans-906
  prefs: []
  type: TYPE_NORMAL
  zh: 由支持代理的网络安全监控（NSM）软件处理。如Listings 13-2中的转录所示，
- en: 13-3, and 13-5, information about proxy use is available for review.
  id: totrans-907
  prefs: []
  type: TYPE_NORMAL
  zh: 在13-3和13-5中，关于代理使用的信息可以供审查。
- en: 4\. Use software that can enable special features to track X-Forwarded-For
  id: totrans-908
  prefs: []
  type: TYPE_NORMAL
  zh: 4. 使用能够启用特殊功能的软件来跟踪X-Forwarded-For
- en: headers and extract the client IP address when reporting alert data.
  id: totrans-909
  prefs: []
  type: TYPE_NORMAL
  zh: 提取客户端IP地址并报告警报数据时，需要适当的可见性。
- en: (See the enable_xff configuration option in Snort, for example.)
  id: totrans-910
  prefs: []
  type: TYPE_NORMAL
  zh: （例如，请参见Snort中的enable_xff配置选项。）
- en: The next part of this chapter will take the third approach. We’ll use
  id: totrans-911
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的下一部分将采取第三种方法。我们将使用
- en: Bro to examine the traffic in these sample traces to see whether it can gen-
  id: totrans-912
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Bro检查这些示例流量，看看它是否能生成有用的
- en: erate information that helps us deal with proxies. Before dealing with our
  id: totrans-913
  prefs: []
  type: TYPE_NORMAL
  zh: 生成有助于我们处理代理的信息。在处理我们的
- en: proxy problem, however, we need to take a slight detour into the world of
  id: totrans-914
  prefs: []
  type: TYPE_NORMAL
  zh: 代理问题，但是我们需要稍微绕道进入代理的世界。
- en: IP checksums.
  id: totrans-915
  prefs: []
  type: TYPE_NORMAL
  zh: IP校验和。
- en: '**checksums**'
  id: totrans-916
  prefs: []
  type: TYPE_NORMAL
  zh: '**校验和**'
- en: IP headers contain a checksum as an error detection mechanism. Network
  id: totrans-917
  prefs: []
  type: TYPE_NORMAL
  zh: IP头包含一个校验和作为错误检测机制。网络
- en: devices calculate and insert checksums when they process packets. When
  id: totrans-918
  prefs: []
  type: TYPE_NORMAL
  zh: 设备在处理数据包时会计算并插入校验和。当
- en: a downstream device receives an IP packet, it calculates a checksum for
  id: totrans-919
  prefs: []
  type: TYPE_NORMAL
  zh: 下游设备接收到IP数据包后，会计算该数据包的校验和，
- en: that packet based on the contents of the IP header. For the purposes of the
  id: totrans-920
  prefs: []
  type: TYPE_NORMAL
  zh: 基于IP头的内容生成该数据包。为了我们的目的，
- en: calculation, the equation sets the IP checksum field itself to zero. If the
    cal-
  id: totrans-921
  prefs: []
  type: TYPE_NORMAL
  zh: 计算时，方程将IP校验和字段本身设为零。如果计算出的校验和
- en: culated checksum fails to match the checksum in the IP packet, the device
  id: totrans-922
  prefs: []
  type: TYPE_NORMAL
  zh: 如果计算出的校验和与IP数据包中的校验和不匹配，设备
- en: may discard the packet. The device senses an error and deals with it by
  id: totrans-923
  prefs: []
  type: TYPE_NORMAL
  zh: 可能会丢弃该数据包。设备检测到错误并通过
- en: dropping the IP packet.
  id: totrans-924
  prefs: []
  type: TYPE_NORMAL
  zh: 丢弃IP数据包。
- en: '**294** Chapter 13'
  id: totrans-925
  prefs: []
  type: TYPE_NORMAL
  zh: '**294** 第13章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-926
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '![Image 158](index-329_1.png)'
  id: totrans-927
  prefs: []
  type: TYPE_IMG
  zh: '![图像158](index-329_1.png)'
- en: '![Image 159](index-329_2.png)'
  id: totrans-928
  prefs: []
  type: TYPE_IMG
  zh: '![图像159](index-329_2.png)'
- en: '***A Good Checksum***'
  id: totrans-929
  prefs: []
  type: TYPE_NORMAL
  zh: '***一个良好的校验和***'
- en: Figure 13-2 shows a checksum that is correct for the contents of a packet.
  id: totrans-930
  prefs: []
  type: TYPE_NORMAL
  zh: 图13-2显示了一个与数据包内容匹配的正确校验和。
- en: '*Figure 13-2: Correct IP checksum of 0x81a4 in a TCP packet*'
  id: totrans-931
  prefs: []
  type: TYPE_NORMAL
  zh: '*图13-2：TCP数据包的正确IP校验和0x81a4*'
- en: The IP checksum is 0x81a4 (0x means the value is represented in hexa-
  id: totrans-932
  prefs: []
  type: TYPE_NORMAL
  zh: IP校验和是0x81a4（0x表示该值以十六进制表示）。
- en: decimal). Wireshark appends the word [correct] after the checksum value
  id: totrans-933
  prefs: []
  type: TYPE_NORMAL
  zh: 十进制）。Wireshark在校验和值后附加了词汇[正确]。
- en: to show that it calculated a checksum and found that it matched the value
  id: totrans-934
  prefs: []
  type: TYPE_NORMAL
  zh: 显示它计算了一个校验和，并发现它与所期望的值一致
- en: reported in the packet. (Note this is a TCP segment, but we are concerned
  id: totrans-935
  prefs: []
  type: TYPE_NORMAL
  zh: 数据包中报告的内容。（请注意，这是一个TCP段，但我们关注的是
- en: only with the IP checksum here.)
  id: totrans-936
  prefs: []
  type: TYPE_NORMAL
  zh: 这里只涉及IP校验和。）
- en: '***A Bad Checksum***'
  id: totrans-937
  prefs: []
  type: TYPE_NORMAL
  zh: '***一个错误的校验和***'
- en: Figure 13-3 shows a checksum that is not correct for the contents of a packet.
  id: totrans-938
  prefs: []
  type: TYPE_NORMAL
  zh: 图13-3显示了一个不正确的校验和，无法与数据包内容匹配。
- en: '*Figure 13-3: Incorrect IP checksum of 0x0000 in a TCP packet*'
  id: totrans-939
  prefs: []
  type: TYPE_NORMAL
  zh: '*图13-3：TCP数据包中错误的IP校验和0x0000*'
- en: Here, we see that the IP checksum is 0x0000\. Wireshark doesn’t like
  id: totrans-940
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们看到IP校验和是0x0000。Wireshark不喜欢
- en: this value. It reports concern via a red bar over the IP header entry and the
  id: totrans-941
  prefs: []
  type: TYPE_NORMAL
  zh: 该值。它通过在IP头条目上方显示红条来报告问题，且
- en: words [incorrect, should be 0x1529 (may be caused by “IP checksum offload”?)].
  id: totrans-942
  prefs: []
  type: TYPE_NORMAL
  zh: 词汇[不正确，应该是0x1529（可能由“IP校验和卸载”引起？）]。
- en: Wireshark shows that it calculated a checksum that didn’t match the value
  id: totrans-943
  prefs: []
  type: TYPE_NORMAL
  zh: Wireshark 显示它计算的校验和与值不匹配
- en: reported in the packet. (This is also a TCP segment.)
  id: totrans-944
  prefs: []
  type: TYPE_NORMAL
  zh: 在包中报告的。（这也是一个 TCP 段。）
- en: Proxies and Checksums **295**
  id: totrans-945
  prefs: []
  type: TYPE_NORMAL
  zh: 代理与校验和 **295**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-946
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '***Identifying Bad and Good Checksums with Tshark***'
  id: totrans-947
  prefs: []
  type: TYPE_NORMAL
  zh: '***使用 Tshark 标识错误和正确的校验和***'
- en: Tshark offers a few helpful ways to quickly review checksums. We’ll use
  id: totrans-948
  prefs: []
  type: TYPE_NORMAL
  zh: Tshark 提供了几种有用的方法来快速查看校验和。我们将使用
- en: the traffic we collected i[n “Proxies” on page 289 a](#p323)s our sample data.
    We’re supposed to be troubleshooting performance, and we expect to rely on
  id: totrans-949
  prefs: []
  type: TYPE_NORMAL
  zh: 我们收集的流量中，i[n “代理”第289页](#p323) 是我们的示例数据。我们应该是在进行性能故障排除，预计会依赖
- en: those traces to answer our questions. First, look at the trace file recorded
  id: totrans-950
  prefs: []
  type: TYPE_NORMAL
  zh: 这些跟踪数据来回答我们的问题。首先，查看录制的跟踪文件
- en: at location X, as shown in Listing 13-7\.
  id: totrans-951
  prefs: []
  type: TYPE_NORMAL
  zh: 如列表 13-7 所示，位于位置 X。
- en: $ **tshark -n -r bej-int.pcap -T fields -E separator=/t -e ip.src -e tcp.srcport**
  id: totrans-952
  prefs: []
  type: TYPE_NORMAL
  zh: $ **tshark -n -r bej-int.pcap -T fields -E separator=/t -e ip.src -e tcp.srcport**
- en: '**-e ip.dst -e tcp.dstport -e ip.checksum**'
  id: totrans-953
  prefs: []
  type: TYPE_NORMAL
  zh: '**-e ip.dst -e tcp.dstport -e ip.checksum**'
- en: Source IP SrcPort Destination IP DstPort IP Checksum
  id: totrans-954
  prefs: []
  type: TYPE_NORMAL
  zh: 源 IP SrcPort 目标 IP DstPort IP 校验和
- en: 192.168.2.108 50949 172.16.2.1 3128 0x81a4
  id: totrans-955
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.2.108 50949 172.16.2.1 3128 0x81a4
- en: 172.16.2.1 3128 192.168.2.108 50949 0x0000
  id: totrans-956
  prefs: []
  type: TYPE_NORMAL
  zh: 172.16.2.1 3128 192.168.2.108 50949 0x0000
- en: 192.168.2.108 50949 172.16.2.1 3128 0x81af
  id: totrans-957
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.2.108 50949 172.16.2.1 3128 0x81af
- en: 192.168.2.108 50949 172.16.2.1 3128 0x8036
  id: totrans-958
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.2.108 50949 172.16.2.1 3128 0x8036
- en: 172.16.2.1 3128 192.168.2.108 50949 0x0000
  id: totrans-959
  prefs: []
  type: TYPE_NORMAL
  zh: 172.16.2.1 3128 192.168.2.108 50949 0x0000
- en: 172.16.2.1 3128 192.168.2.108 50949 0x0000
  id: totrans-960
  prefs: []
  type: TYPE_NORMAL
  zh: 172.16.2.1 3128 192.168.2.108 50949 0x0000
- en: 192.168.2.108 50949 172.16.2.1 3128 0x81ad
  id: totrans-961
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.2.108 50949 172.16.2.1 3128 0x81ad
- en: 172.16.2.1 3128 192.168.2.108 50949 0x0000
  id: totrans-962
  prefs: []
  type: TYPE_NORMAL
  zh: 172.16.2.1 3128 192.168.2.108 50949 0x0000
- en: 192.168.2.108 50949 172.16.2.1 3128 0x81a5
  id: totrans-963
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.2.108 50949 172.16.2.1 3128 0x81a5
- en: 172.16.2.1 3128 192.168.2.108 50949 0x0000
  id: totrans-964
  prefs: []
  type: TYPE_NORMAL
  zh: 172.16.2.1 3128 192.168.2.108 50949 0x0000
- en: 172.16.2.1 3128 192.168.2.108 50949 0x0000
  id: totrans-965
  prefs: []
  type: TYPE_NORMAL
  zh: 172.16.2.1 3128 192.168.2.108 50949 0x0000
- en: 192.168.2.108 50949 172.16.2.1 3128 0x81a4
  id: totrans-966
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.2.108 50949 172.16.2.1 3128 0x81a4
- en: '*Listing 13-7: Custom Tshark output for the* bej-int .pcap *trace file*'
  id: totrans-967
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 13-7：bej-int .pcap 跟踪文件的自定义 Tshark 输出*'
- en: Listing 13-7 invokes a few new switches to display only the information
  id: totrans-968
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 13-7 调用了几个新选项，仅显示我们想要的信息
- en: that concerns us. We used the -T fields and -E separator=/t switches to tell
  id: totrans-969
  prefs: []
  type: TYPE_NORMAL
  zh: 这正是我们关心的。我们使用了 -T fields 和 -E separator=/t 选项来告诉
- en: Tshark we wanted specific parts of the packets to be displayed and we wanted
  id: totrans-970
  prefs: []
  type: TYPE_NORMAL
  zh: Tshark 我们希望显示包的特定部分，并且希望
- en: those fields printed with tabs between them. Using the -e switches, we told
  id: totrans-971
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 -e 选项，我们告诉
- en: Tshark just which parts of the packets we wanted. (I added the headers after
  id: totrans-972
  prefs: []
  type: TYPE_NORMAL
  zh: Tshark 仅显示我们需要的包的部分内容。（我在后面添加了标题）
- en: the command line to make it easier for you to recognize the fields.)
  id: totrans-973
  prefs: []
  type: TYPE_NORMAL
  zh: 命令行使你更容易识别字段。)
- en: Looking at the last column, it seems odd that every packet from
  id: totrans-974
  prefs: []
  type: TYPE_NORMAL
  zh: 看最后一列，似乎很奇怪的是每个包从
- en: 172.16.2.1 has a checksum of 0x0000\. When we saw that same occurrence
  id: totrans-975
  prefs: []
  type: TYPE_NORMAL
  zh: 172.16.2.1 的校验和是 0x0000。当我们看到相同的情况时
- en: in Wireshark, the tool reported a checksum error.
  id: totrans-976
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Wireshark 中，该工具报告了一个校验和错误。
- en: We can invoke Tshark again to tell us which packets have miscalculated
  id: totrans-977
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以再次调用 Tshark 来告诉我们哪些包的校验和计算错误
- en: checksums, as shown in Listing 13-8\.
  id: totrans-978
  prefs: []
  type: TYPE_NORMAL
  zh: 如列表 13-8 所示，校验和
- en: $ **tshark -n -r bej-int.pcap -T fields -E separator=/t -e ip.src -e tcp.srcport**
  id: totrans-979
  prefs: []
  type: TYPE_NORMAL
  zh: $ **tshark -n -r bej-int.pcap -T fields -E separator=/t -e ip.src -e tcp.srcport**
- en: '**-e ip.dst -e tcp.dstport -e ip.proto -e ip.checksum -R "ip.checksum_bad==1"**'
  id: totrans-980
  prefs: []
  type: TYPE_NORMAL
  zh: '**-e ip.dst -e tcp.dstport -e ip.proto -e ip.checksum -R "ip.checksum_bad==1"**'
- en: 172.16.2.1 3128 192.168.2.108 50949 6 0x0000
  id: totrans-981
  prefs: []
  type: TYPE_NORMAL
  zh: 172.16.2.1 3128 192.168.2.108 50949 6 0x0000
- en: 172.16.2.1 3128 192.168.2.108 50949 6 0x0000
  id: totrans-982
  prefs: []
  type: TYPE_NORMAL
  zh: 172.16.2.1 3128 192.168.2.108 50949 6 0x0000
- en: 172.16.2.1 3128 192.168.2.108 50949 6 0x0000
  id: totrans-983
  prefs: []
  type: TYPE_NORMAL
  zh: 172.16.2.1 3128 192.168.2.108 50949 6 0x0000
- en: 172.16.2.1 3128 192.168.2.108 50949 6 0x0000
  id: totrans-984
  prefs: []
  type: TYPE_NORMAL
  zh: 172.16.2.1 3128 192.168.2.108 50949 6 0x0000
- en: 172.16.2.1 3128 192.168.2.108 50949 6 0x0000
  id: totrans-985
  prefs: []
  type: TYPE_NORMAL
  zh: 172.16.2.1 3128 192.168.2.108 50949 6 0x0000
- en: 172.16.2.1 3128 192.168.2.108 50949 6 0x0000
  id: totrans-986
  prefs: []
  type: TYPE_NORMAL
  zh: 172.16.2.1 3128 192.168.2.108 50949 6 0x0000
- en: '*Listing 13-8: Tshark output for sample trace file showing only bad checksums*'
  id: totrans-987
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 13-8：显示只含有错误校验和的 Tshark 输出样本*'
- en: '**296** Chapter 13'
  id: totrans-988
  prefs: []
  type: TYPE_NORMAL
  zh: '**296** 第 13 章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-989
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: In Listing 13-8, we add the display filter **-R "ip.checksum_bad==1"** . This
    tells Tshark to show only packets whose checksums do not match the values
  id: totrans-990
  prefs: []
  type: TYPE_NORMAL
  zh: 在列表 13-8 中，我们添加了显示过滤器 **-R "ip.checksum_bad==1"**。这告诉 Tshark 只显示那些校验和不匹配的包
- en: Tshark thinks they should have. If you want to see only packets with good
  id: totrans-991
  prefs: []
  type: TYPE_NORMAL
  zh: Tshark 认为它们应该是这样的。如果你只想查看检查合格的包
- en: checksums, try the command shown in Listing 13-9\.
  id: totrans-992
  prefs: []
  type: TYPE_NORMAL
  zh: 校验和，试试列表 13-9 中显示的命令。
- en: $ **tshark -n -r bej-int.pcap -T fields -E separator=/t -e ip.src -e tcp.srcport**
  id: totrans-993
  prefs: []
  type: TYPE_NORMAL
  zh: $ **tshark -n -r bej-int.pcap -T fields -E separator=/t -e ip.src -e tcp.srcport**
- en: '**-e ip.dst -e tcp.dstport -e ip.proto -e ip.checksum -R "ip.checksum_good==1"**'
  id: totrans-994
  prefs: []
  type: TYPE_NORMAL
  zh: '**-e ip.dst -e tcp.dstport -e ip.proto -e ip.checksum -R "ip.checksum_good==1"**'
- en: 192.168.2.108 50949 172.16.2.1 3128 6 0x81a4
  id: totrans-995
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.2.108 50949 172.16.2.1 3128 6 0x81a4
- en: 192.168.2.108 50949 172.16.2.1 3128 6 0x81af
  id: totrans-996
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.2.108 50949 172.16.2.1 3128 6 0x81af
- en: 192.168.2.108 50949 172.16.2.1 3128 6 0x8036
  id: totrans-997
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.2.108 50949 172.16.2.1 3128 6 0x8036
- en: 192.168.2.108 50949 172.16.2.1 3128 6 0x81ad
  id: totrans-998
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.2.108 50949 172.16.2.1 3128 6 0x81ad
- en: 192.168.2.108 50949 172.16.2.1 3128 6 0x81a5
  id: totrans-999
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.2.108 50949 172.16.2.1 3128 6 0x81a5
- en: 192.168.2.108 50949 172.16.2.1 3128 6 0x81a4
  id: totrans-1000
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.2.108 50949 172.16.2.1 3128 6 0x81a4
- en: '*Listing 13-9: Tshark output for sample trace file showing only good checksums*'
  id: totrans-1001
  prefs: []
  type: TYPE_NORMAL
  zh: '*示例 13-9：仅显示有效校验和的 Tshark 输出*'
- en: In Listing 13-9, we add the display filter -R "ip.checksum_good==1". This
  id: totrans-1002
  prefs: []
  type: TYPE_NORMAL
  zh: 在示例 13-9 中，我们添加了显示过滤器 -R "ip.checksum_good==1"。这
- en: tells Tshark to show only packets whose checksums match the values Tshark
  id: totrans-1003
  prefs: []
  type: TYPE_NORMAL
  zh: 告诉 Tshark 仅显示那些校验和匹配 Tshark 预期值的数据包
- en: thinks they should have. You could get the same results for Listing 13-8
  id: totrans-1004
  prefs: []
  type: TYPE_NORMAL
  zh: 认为它们应该如此。你可以得到与示例 13-8 相同的结果
- en: using the display filter -R "ip.checksum_good==0" and the same results for
  id: totrans-1005
  prefs: []
  type: TYPE_NORMAL
  zh: 使用显示过滤器 -R "ip.checksum_good==0" 并获得相同的结果
- en: Listing 13-9 using the display filter -R "ip.checksum_bad==0".
  id: totrans-1006
  prefs: []
  type: TYPE_NORMAL
  zh: 示例 13-9 使用显示过滤器 -R "ip.checksum_bad==0"。
- en: Before investigating why we’re getting these bad checksums, let’s see
  id: totrans-1007
  prefs: []
  type: TYPE_NORMAL
  zh: 在调查为什么我们会得到这些错误的校验和之前，让我们看看
- en: whether they also appear in *bej-ext.pcap*. As we did with Listing 13-7, we
    can show the key elements of a trace file using Tshark. Listing 13-10 provides
  id: totrans-1008
  prefs: []
  type: TYPE_NORMAL
  zh: 是否也出现在*bej-ext.pcap*中。如同我们在示例 13-7 中所做的，我们可以使用 Tshark 显示追踪文件的关键元素。示例 13-10 提供了
- en: the syntax and output.
  id: totrans-1009
  prefs: []
  type: TYPE_NORMAL
  zh: 语法和输出。
- en: $ **tshark -n -r ../bej-ext.pcap -T fields -E separator=/t -e ip.src -e tcp.**
  id: totrans-1010
  prefs: []
  type: TYPE_NORMAL
  zh: $ **tshark -n -r ../bej-ext.pcap -T fields -E separator=/t -e ip.src -e tcp.**
- en: '**srcport -e ip.dst -e tcp.dstport -e ip.checksum**'
  id: totrans-1011
  prefs: []
  type: TYPE_NORMAL
  zh: '**srcport -e ip.dst -e tcp.dstport -e ip.checksum**'
- en: 192.168.1.2 2770 205.186.148.46 80 0x0000
  id: totrans-1012
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.1.2 2770 205.186.148.46 80 0x0000
- en: 205.186.148.46 80 192.168.1.2 2770 0x5b28
  id: totrans-1013
  prefs: []
  type: TYPE_NORMAL
  zh: 205.186.148.46 80 192.168.1.2 2770 0x5b28
- en: 192.168.1.2 2770 205.186.148.46 80 0x0000
  id: totrans-1014
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.1.2 2770 205.186.148.46 80 0x0000
- en: 192.168.1.2 2770 205.186.148.46 80 0x0000
  id: totrans-1015
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.1.2 2770 205.186.148.46 80 0x0000
- en: 205.186.148.46 80 192.168.1.2 2770 0x9597
  id: totrans-1016
  prefs: []
  type: TYPE_NORMAL
  zh: 205.186.148.46 80 192.168.1.2 2770 0x9597
- en: 205.186.148.46 80 192.168.1.2 2770 0x8fee
  id: totrans-1017
  prefs: []
  type: TYPE_NORMAL
  zh: 205.186.148.46 80 192.168.1.2 2770 0x8fee
- en: 192.168.1.2 2770 205.186.148.46 80 0x0000
  id: totrans-1018
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.1.2 2770 205.186.148.46 80 0x0000
- en: 205.186.148.46 80 192.168.1.2 2770 0x8fed
  id: totrans-1019
  prefs: []
  type: TYPE_NORMAL
  zh: 205.186.148.46 80 192.168.1.2 2770 0x8fed
- en: 192.168.1.2 2770 205.186.148.46 80 0x0000
  id: totrans-1020
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.1.2 2770 205.186.148.46 80 0x0000
- en: 205.186.148.46 80 192.168.1.2 2770 0x9367
  id: totrans-1021
  prefs: []
  type: TYPE_NORMAL
  zh: 205.186.148.46 80 192.168.1.2 2770 0x9367
- en: 192.168.1.2 2770 205.186.148.46 80 0x0000
  id: totrans-1022
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.1.2 2770 205.186.148.46 80 0x0000
- en: 192.168.1.2 2770 205.186.148.46 80 0x0000
  id: totrans-1023
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.1.2 2770 205.186.148.46 80 0x0000
- en: 192.168.1.2 2770 205.186.148.46 80 0x0000
  id: totrans-1024
  prefs: []
  type: TYPE_NORMAL
  zh: 192.168.1.2 2770 205.186.148.46 80 0x0000
- en: 205.186.148.46 80 192.168.1.2 2770 0x9593
  id: totrans-1025
  prefs: []
  type: TYPE_NORMAL
  zh: 205.186.148.46 80 192.168.1.2 2770 0x9593
- en: '*Listing 13-10: Custom Tshark output for the* bej-ext .pcap *trace file*'
  id: totrans-1026
  prefs: []
  type: TYPE_NORMAL
  zh: '*示例 13-10：针对 bej-ext.pcap 追踪文件的自定义 Tshark 输出*'
- en: In Listing 13-10, the proxy is 192.168.1.2, and the server is 205.186.148.46,
  id: totrans-1027
  prefs: []
  type: TYPE_NORMAL
  zh: 在示例 13-10 中，代理是 192.168.1.2，服务器是 205.186.148.46，
- en: offering web services on port 80 TCP. Again, we see suspicious IP checksums
  id: totrans-1028
  prefs: []
  type: TYPE_NORMAL
  zh: 提供 Web 服务的端口为 80 TCP。再次，我们看到可疑的 IP 校验和
- en: (0x0000) on all packets from the proxy to the web server. As with *bej-int.pcap*,
    the system generating IP traffic with bad checksums is the proxy. Why?
  id: totrans-1029
  prefs: []
  type: TYPE_NORMAL
  zh: （0x0000）表示从代理到 Web 服务器的所有数据包。与*bej-int.pcap*一样，生成 IP 流量且校验和错误的系统是代理。为什么？
- en: Proxies and Checksums **297**
  id: totrans-1030
  prefs: []
  type: TYPE_NORMAL
  zh: 代理和校验和 **297**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1031
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '***How Bad Checksums Happen***'
  id: totrans-1032
  prefs: []
  type: TYPE_NORMAL
  zh: '***校验和错误如何发生***'
- en: IP checksums occasionally fail to match the intended values due to errors
  id: totrans-1033
  prefs: []
  type: TYPE_NORMAL
  zh: IP 校验和偶尔因错误而未能匹配预期值
- en: introduced over the Internet. These errors are exceptionally rare, however,
  id: totrans-1034
  prefs: []
  type: TYPE_NORMAL
  zh: 这些错误通过互联网传输时极为罕见，但
- en: unless a real network problem is involved. How did so many checksums
  id: totrans-1035
  prefs: []
  type: TYPE_NORMAL
  zh: 除非涉及到实际的网络问题，否则为什么这么多校验和
- en: fail in Listings 13-7 and 13-10, and why are those failures so consistent?
  id: totrans-1036
  prefs: []
  type: TYPE_NORMAL
  zh: 在示例 13-7 和 13-10 中出现失败，为什么这些失败如此一致？
- en: The error reported by Wireshark in Figure 13-3, [incorrect, should be
  id: totrans-1037
  prefs: []
  type: TYPE_NORMAL
  zh: Wireshark 在图 13-3 中报告的错误，[不正确，应为
- en: 0x1529 (may be caused by "IP checksum offload"?)], can help us answer those
    questions.
  id: totrans-1038
  prefs: []
  type: TYPE_NORMAL
  zh: 0x1529（可能是由于“IP 校验和卸载”？）]，可以帮助我们回答这些问题。
- en: Traditionally, the operating system and network stack were responsible
  id: totrans-1039
  prefs: []
  type: TYPE_NORMAL
  zh: 传统上，操作系统和网络协议栈负责
- en: for calculating IP checksums, but modern network drivers and some NICs
  id: totrans-1040
  prefs: []
  type: TYPE_NORMAL
  zh: 用于计算 IP 校验和，但现代网络驱动程序和一些网卡
- en: assume that burden. This process, called *offloading*, allows the network stack
    to send traffic quickly. Calculating checksums can be done quickly in the
  id: totrans-1041
  prefs: []
  type: TYPE_NORMAL
  zh: 假设这个负担。这一过程称为*卸载*，它使网络堆栈能够快速发送流量。在
- en: driver or, better yet, by dedicated hardware.
  id: totrans-1042
  prefs: []
  type: TYPE_NORMAL
  zh: 驱动程序，或者更好的是，通过专用硬件来快速计算校验和。
- en: Frequent IP checksum errors like those in Listings 13-7 and 13-10 will
  id: totrans-1043
  prefs: []
  type: TYPE_NORMAL
  zh: 像列表 13-7 和 13-10 中的频繁 IP 校验和错误将
- en: interfere with your ability to conduct NSM. Traces with bad checksums are
  id: totrans-1044
  prefs: []
  type: TYPE_NORMAL
  zh: 干扰你进行 NSM 的能力。带有坏校验和的跟踪文件会
- en: often the result of capturing network traffic on a platform that offloads the
  id: totrans-1045
  prefs: []
  type: TYPE_NORMAL
  zh: 通常是因为在卸载了网络流量捕获的平台上捕获数据包
- en: checksum process to a driver or hardware. The packet seen by the network
  id: totrans-1046
  prefs: []
  type: TYPE_NORMAL
  zh: 将校验和过程交给驱动程序或硬件。网络看到的包
- en: security tool has a 0x0000, or empty, checksum, but the “real” packet sent
  id: totrans-1047
  prefs: []
  type: TYPE_NORMAL
  zh: 安全工具有一个 0x0000 或空的校验和，但“真实”的包已发送
- en: on the wire has a true checksum calculated and added to the packet by the
  id: totrans-1048
  prefs: []
  type: TYPE_NORMAL
  zh: 在传输链路上有一个真实的校验和，它是由网络
- en: driver or hardware. (When SO configures network interfaces, the setup
  id: totrans-1049
  prefs: []
  type: TYPE_NORMAL
  zh: 驱动程序或硬件。（当 SO 配置网络接口时，设置
- en: script disables driver and hardware checksum offloading in an effort to
  id: totrans-1050
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本禁用驱动程序和硬件的校验和卸载，试图
- en: avoid these issues.)
  id: totrans-1051
  prefs: []
  type: TYPE_NORMAL
  zh: 避免这些问题。）
- en: In our scenario, the proxy relies on checksum offloading to speed up
  id: totrans-1052
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的场景中，代理依赖于校验和卸载来加速
- en: the transmission of network traffic. Unfortunately, the software on the
  id: totrans-1053
  prefs: []
  type: TYPE_NORMAL
  zh: 这会影响网络流量的传输。不幸的是，平台上的软件
- en: proxy sets a 0x0000 IP checksum on all outgoing packets. Before the packet
  id: totrans-1054
  prefs: []
  type: TYPE_NORMAL
  zh: 代理在所有传出的包上设置 0x0000 的 IP 校验和。发送之前，数据包
- en: hits the wire, though, the driver or NIC hardware calculates and inserts
  id: totrans-1055
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦数据包发送到链路上，驱动程序或 NIC 硬件就会计算并插入
- en: a proper checksum. Packets received from other devices have the correct
  id: totrans-1056
  prefs: []
  type: TYPE_NORMAL
  zh: 拥有正确的校验和。来自其他设备的包有正确的
- en: checksums.
  id: totrans-1057
  prefs: []
  type: TYPE_NORMAL
  zh: 校验和。
- en: '***Bro and Bad Checksums***'
  id: totrans-1058
  prefs: []
  type: TYPE_NORMAL
  zh: '***Bro 和坏的校验和***'
- en: Now that we’ve looked at good and bad IP checksums, let’s examine why
  id: totrans-1059
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经查看了好和坏的 IP 校验和，让我们研究一下为什么
- en: they matter. Some network security tools assume that packets with a bad IP
  id: totrans-1060
  prefs: []
  type: TYPE_NORMAL
  zh: 它们很重要。一些网络安全工具假设带有坏 IP
- en: checksum will never be processed by the receiving network endpoint. The
  id: totrans-1061
  prefs: []
  type: TYPE_NORMAL
  zh: 校验和将永远不会被接收端处理。网络
- en: network security tool drops the packet. Unfortunately, these bad checksums
  id: totrans-1062
  prefs: []
  type: TYPE_NORMAL
  zh: 网络安全工具会丢弃该包。不幸的是，这些坏的校验和
- en: might simply be caused by offloading.
  id: totrans-1063
  prefs: []
  type: TYPE_NORMAL
  zh: 可能仅仅是由卸载引起的。
- en: Bro ignores traffic with bad IP checksums. For example, notice how it
  id: totrans-1064
  prefs: []
  type: TYPE_NORMAL
  zh: Bro 会忽略带有坏 IP 校验和的流量。例如，注意它是如何
- en: processes the *bej-int.pcap* trace file, as shown in Listing 13-11\.
  id: totrans-1065
  prefs: []
  type: TYPE_NORMAL
  zh: 处理 *bej-int.pcap* 跟踪文件，如列表 13-11 所示\。
- en: $ **sudo bro -r bej-int.pcap /opt/bro/share/bro/site/local.bro**
  id: totrans-1066
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo bro -r bej-int.pcap /opt/bro/share/bro/site/local.bro**
- en: 'WARNING: No Site::local_nets have been defined. It''s usually a good idea to
    define your local networks.'
  id: totrans-1067
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：没有定义 Site::local_nets。通常，定义本地网络是个好主意。
- en: 'WARNING: Template value remaining in BPFConf filename: /etc/nsm/{{hostname}}-{{interface}}/bpf-bro.conf
    (/opt/bro/share/bro/securityonion/./bpfconf.bro, line 99)'
  id: totrans-1068
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：BPFConf 文件名中仍有模板值：/etc/nsm/{{hostname}}-{{interface}}/bpf-bro.conf (/opt/bro/share/bro/securityonion/./bpfconf.bro，第99行)
- en: 'WARNING: Template value remaining in BPFConf filename: /etc/nsm/ds61so-{{interface}}/bpf-bro.'
  id: totrans-1069
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：BPFConf 文件名中仍有模板值：/etc/nsm/ds61so-{{interface}}/bpf-bro。
- en: conf (/opt/bro/share/bro/securityonion/./bpfconf.bro, line 99)
  id: totrans-1070
  prefs: []
  type: TYPE_NORMAL
  zh: conf (/opt/bro/share/bro/securityonion/./bpfconf.bro，第99行)
- en: '*Listing 13-11: Bro reads the* bej-int .pcap *trace file.*'
  id: totrans-1071
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 13-11: Bro 读取 *bej-int.pcap* 跟踪文件。*'
- en: '**298** Chapter 13'
  id: totrans-1072
  prefs: []
  type: TYPE_NORMAL
  zh: '**298** 第13章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1073
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: Nothing odd appears by default, but take a look at *weird.log*, shown in Listing
    13-12\.
  id: totrans-1074
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下没有什么奇怪的东西，但看看 *weird.log*，如列表 13-12 所示\。
- en: $ **cat weird.log**
  id: totrans-1075
  prefs: []
  type: TYPE_NORMAL
  zh: $ **cat weird.log**
- en: '#separator \x09'
  id: totrans-1076
  prefs: []
  type: TYPE_NORMAL
  zh: '#separator \x09'
- en: '#set_separator ,'
  id: totrans-1077
  prefs: []
  type: TYPE_NORMAL
  zh: '#set_separator ,'
- en: '#empty_field (empty)'
  id: totrans-1078
  prefs: []
  type: TYPE_NORMAL
  zh: '#empty_field (空)'
- en: '#unset_field -'
  id: totrans-1079
  prefs: []
  type: TYPE_NORMAL
  zh: '#unset_field -'
- en: '#path weird'
  id: totrans-1080
  prefs: []
  type: TYPE_NORMAL
  zh: '#path weird'
- en: '#open 2013-04-23-19-40-10'
  id: totrans-1081
  prefs: []
  type: TYPE_NORMAL
  zh: '#open 2013-04-23-19-40-10'
- en: '#fields ts uid id.orig_h id.orig_p id.resp_h id.resp_p name addl notice peer'
  id: totrans-1082
  prefs: []
  type: TYPE_NORMAL
  zh: '#fields ts uid id.orig_h id.orig_p id.resp_h id.resp_p name addl notice peer'
- en: '#types time string addr port addr port string string bool string 1366577618.249515
    - - - - - bad_IP_checksum - F'
  id: totrans-1083
  prefs: []
  type: TYPE_NORMAL
  zh: '#types time string addr port addr port string string bool string 1366577618.249515
    - - - - - bad_IP_checksum - F'
- en: bro
  id: totrans-1084
  prefs: []
  type: TYPE_NORMAL
  zh: bro
- en: 1366577618.251250 rhdNNjfMGkc 192.168.2.108 50949 172.16.2.1 3128
  id: totrans-1085
  prefs: []
  type: TYPE_NORMAL
  zh: 1366577618.251250 rhdNNjfMGkc 192.168.2.108 50949 172.16.2.1 3128
- en: upossible_split_routing - F bro
  id: totrans-1086
  prefs: []
  type: TYPE_NORMAL
  zh: upossible_split_routing - F bro
- en: 1366577618.251867 rhdNNjfMGkc 192.168.2.108 50949 172.16.2.1 3128
  id: totrans-1087
  prefs: []
  type: TYPE_NORMAL
  zh: 1366577618.251867 rhdNNjfMGkc 192.168.2.108 50949 172.16.2.1 3128
- en: vdata_before_established - F bro
  id: totrans-1088
  prefs: []
  type: TYPE_NORMAL
  zh: vdata_before_established - F bro
- en: '#close 2013-04-23-19-40-10'
  id: totrans-1089
  prefs: []
  type: TYPE_NORMAL
  zh: '#close 2013-04-23-19-40-10'
- en: '*Listing 13-12: Bro* weird .log *file*'
  id: totrans-1090
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 13-12: Bro* weird.log *文件*'
- en: The first entry reports possible_split_routing u because Bro is seeing only
  id: totrans-1091
  prefs: []
  type: TYPE_NORMAL
  zh: 第一条记录报告可能的分割路由 u，因为 Bro 只看到了
- en: half the traffic, namely packets from 192.168.2.108 to 172.16.2.1\. These were
  id: totrans-1092
  prefs: []
  type: TYPE_NORMAL
  zh: 一半的流量，即从 192.168.2.108 到 172.16.2.1 的数据包。这些数据包
- en: the packets in Listing 13-9 with good IP checksums. The second entry reports
  id: totrans-1093
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 13-9 中的数据包具有良好的 IP 校验和。第二条记录报告
- en: data_before_established v because Bro didn’t see a complete TCP three-way
  id: totrans-1094
  prefs: []
  type: TYPE_NORMAL
  zh: data_before_established v，因为 Bro 没有看到完整的 TCP 三次握手
- en: handshake. When Bro misses the three-way handshake, it’s confused when it
  id: totrans-1095
  prefs: []
  type: TYPE_NORMAL
  zh: 握手。当 Bro 错过三次握手时，它会感到困惑，
- en: sees data transmitted before the session was properly established.
  id: totrans-1096
  prefs: []
  type: TYPE_NORMAL
  zh: 在会话尚未完全建立时看到数据被传输。
- en: The Bro *http.log* file is also odd, as shown in Listing 13-13\.
  id: totrans-1097
  prefs: []
  type: TYPE_NORMAL
  zh: Bro 的 *http.log* 文件也很奇怪，如列表 13-13 所示\。
- en: $ **cat http.log**
  id: totrans-1098
  prefs: []
  type: TYPE_NORMAL
  zh: $ **cat http.log**
- en: '#separator \x09'
  id: totrans-1099
  prefs: []
  type: TYPE_NORMAL
  zh: '#separator \x09'
- en: '#set_separator ,'
  id: totrans-1100
  prefs: []
  type: TYPE_NORMAL
  zh: '#set_separator ,'
- en: '#empty_field (empty)'
  id: totrans-1101
  prefs: []
  type: TYPE_NORMAL
  zh: '#empty_field (空)'
- en: '#unset_field -'
  id: totrans-1102
  prefs: []
  type: TYPE_NORMAL
  zh: '#unset_field -'
- en: '#path http'
  id: totrans-1103
  prefs: []
  type: TYPE_NORMAL
  zh: '#path http'
- en: '#open 2013-04-23-19-40-10'
  id: totrans-1104
  prefs: []
  type: TYPE_NORMAL
  zh: '#open 2013-04-23-19-40-10'
- en: '#fields ts uid id.orig_h id.orig_p id.resp_h id.resp_p trans_'
  id: totrans-1105
  prefs: []
  type: TYPE_NORMAL
  zh: '#fields ts uid id.orig_h id.orig_p id.resp_h id.resp_p trans_'
- en: depth method host uri referrer user_agent request_body_len
  id: totrans-1106
  prefs: []
  type: TYPE_NORMAL
  zh: depth method host uri referrer user_agent request_body_len
- en: response_body_len status_code status_msg info_code info_msg filename tags username
    password proxied mime_type md5 extraction_file
  id: totrans-1107
  prefs: []
  type: TYPE_NORMAL
  zh: response_body_len status_code status_msg info_code info_msg filename tags username
    password proxied mime_type md5 extraction_file
- en: '#types time string addr port addr port count string string string string string
    count count count string count string string table[enum] string string table[string]
    string string file'
  id: totrans-1108
  prefs: []
  type: TYPE_NORMAL
  zh: '#types time string addr port addr port count string string string string string
    count count count string count string string table[enum] string string table[string]
    string string file'
- en: Proxies and Checksums **299**
  id: totrans-1109
  prefs: []
  type: TYPE_NORMAL
  zh: 代理和校验和 **299**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1110
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: 1366577618.251867 rhdNNjfMGkc 192.168.2.108 50949 172.16.2.1 3128 1
  id: totrans-1111
  prefs: []
  type: TYPE_NORMAL
  zh: 1366577618.251867 rhdNNjfMGkc 192.168.2.108 50949 172.16.2.1 3128 1
- en: GETu www.bejtlich.net http://www.bejtlich.net/ http://www.taosecurity.
  id: totrans-1112
  prefs: []
  type: TYPE_NORMAL
  zh: GETu www.bejtlich.net http://www.bejtlich.net/ http://www.taosecurity.
- en: com/training.html Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:20.0) Gecko/20100101
  id: totrans-1113
  prefs: []
  type: TYPE_NORMAL
  zh: com/training.html Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:20.0) Gecko/20100101
- en: Firefox/20.0 0 0 - - - - - (empty) - - -
  id: totrans-1114
  prefs: []
  type: TYPE_NORMAL
  zh: Firefox/20.0 0 0 - - - - - (空) - - -
- en: '- - -'
  id: totrans-1115
  prefs: []
  type: TYPE_NORMAL
  zh: '- - -'
- en: '#close 2013-04-23-19-40-10'
  id: totrans-1116
  prefs: []
  type: TYPE_NORMAL
  zh: '#close 2013-04-23-19-40-10'
- en: '*Listing 13-13: Bro* http .log *file*'
  id: totrans-1117
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 13-13：Bro* http .log *文件*'
- en: We see a GET request here u, but no indication of a reply.
  id: totrans-1118
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到这里有一个 GET 请求 u，但没有回复的迹象。
- en: '***Setting Bro to Ignore Bad Checksums***'
  id: totrans-1119
  prefs: []
  type: TYPE_NORMAL
  zh: '***设置 Bro 忽略坏的校验和***'
- en: We can tell Bro to shut off its checksum verification and process all traffic
  id: totrans-1120
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以告诉 Bro 关闭其校验和验证，并处理所有流量
- en: using the -C switch, as shown in Listing 13-14\.
  id: totrans-1121
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 -C 开关，如列表 13-14 所示\。
- en: $ **sudo bro -r bej-int.pcap -C /opt/bro/share/bro/site/local.bro**
  id: totrans-1122
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo bro -r bej-int.pcap -C /opt/bro/share/bro/site/local.bro**
- en: 'WARNING: No Site::local_nets have been defined. It''s usually a good idea to
    define your local networks.'
  id: totrans-1123
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：没有定义 Site::local_nets。通常建议定义你的本地网络。
- en: 'WARNING: Template value remaining in BPFConf filename: /etc/nsm/{{hostname}}-{{interface}}/bpf-bro.conf
    (/opt/bro/share/bro/securityonion/./bpfconf.bro, line 99)'
  id: totrans-1124
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：模板值仍然存在于 BPFConf 文件名中：/etc/nsm/{{hostname}}-{{interface}}/bpf-bro.conf (/opt/bro/share/bro/securityonion/./bpfconf.bro，第
    99 行)
- en: 'WARNING: 1366577618.694909 Template value remaining in BPFConf filename: /etc/nsm/ds61so-'
  id: totrans-1125
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：1366577618.694909 模板值仍然存在于 BPFConf 文件名中：/etc/nsm/ds61so-
- en: '{{interface}}/bpf-bro.conf (/opt/bro/share/bro/securityonion/./bpfconf.bro,
    line 99)'
  id: totrans-1126
  prefs: []
  type: TYPE_NORMAL
  zh: '{{interface}}/bpf-bro.conf (/opt/bro/share/bro/securityonion/./bpfconf.bro，第
    99 行)'
- en: '*Listing 13-14: Bro reads the trace file and ignores checksums.*'
  id: totrans-1127
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表 13-14：Bro 读取跟踪文件并忽略校验和。*'
- en: Now there is no *weird.log*. If we look at *http.log*, we’ll see that it’s what
    we’ve come to expect. Listing 13-15 shows the results.
  id: totrans-1128
  prefs: []
  type: TYPE_NORMAL
  zh: 现在没有 *weird.log* 文件。如果我们查看 *http.log*，我们会看到它正是我们所期待的。列表 13-15 显示了结果。
- en: $ **cat http.log**
  id: totrans-1129
  prefs: []
  type: TYPE_NORMAL
  zh: $ **cat http.log**
- en: '#separator \x09'
  id: totrans-1130
  prefs: []
  type: TYPE_NORMAL
  zh: '#separator \x09'
- en: '#set_separator ,'
  id: totrans-1131
  prefs: []
  type: TYPE_NORMAL
  zh: '#set_separator ,'
- en: '#empty_field (empty)'
  id: totrans-1132
  prefs: []
  type: TYPE_NORMAL
  zh: '#empty_field (空)'
- en: '#unset_field -'
  id: totrans-1133
  prefs: []
  type: TYPE_NORMAL
  zh: '#unset_field -'
- en: '#path http'
  id: totrans-1134
  prefs: []
  type: TYPE_NORMAL
  zh: '#path http'
- en: '#open 2013-04-23-20-06-19'
  id: totrans-1135
  prefs: []
  type: TYPE_NORMAL
  zh: '#open 2013-04-23-20-06-19'
- en: '#fields ts uid id.orig_h id.orig_p id.resp_h id.resp_p trans_'
  id: totrans-1136
  prefs: []
  type: TYPE_NORMAL
  zh: '#fields ts uid id.orig_h id.orig_p id.resp_h id.resp_p trans_'
- en: depth method host uri referrer user_agent request_body_len
  id: totrans-1137
  prefs: []
  type: TYPE_NORMAL
  zh: depth method host uri referrer user_agent request_body_len
- en: response_body_len status_code status_msg info_code info_msg filename tags username
    password proxied mime_type md5 extraction_file
  id: totrans-1138
  prefs: []
  type: TYPE_NORMAL
  zh: response_body_len status_code status_msg info_code info_msg filename tags username
    password proxied mime_type md5 extraction_file
- en: '#types time string addr port addr port count string string string string string
    count count count string count string string table[enum] string string table[string]
    string string file'
  id: totrans-1139
  prefs: []
  type: TYPE_NORMAL
  zh: '#types time string addr port addr port count string string string string string
    count count count string count string string table[enum] string string table[string]
    string string file'
- en: '**300** Chapter 13'
  id: totrans-1140
  prefs: []
  type: TYPE_NORMAL
  zh: '**300** 第 13 章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1141
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: 1366577618.251867 aqjpeHaXm7f 192.168.2.108 50949 172.16.2.1 3128 1
  id: totrans-1142
  prefs: []
  type: TYPE_NORMAL
  zh: 1366577618.251867 aqjpeHaXm7f 192.168.2.108 50949 172.16.2.1 3128 1
- en: GETu www.bejtlich.net http://www.bejtlich.net/v http://www.taosecurity.
  id: totrans-1143
  prefs: []
  type: TYPE_NORMAL
  zh: GETu www.bejtlich.net http://www.bejtlich.net/v http://www.taosecurity.
- en: com/training.html Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:20.0) Gecko/20100101
  id: totrans-1144
  prefs: []
  type: TYPE_NORMAL
  zh: com/training.html Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:20.0) Gecko/20100101
- en: Firefox/20.0 0 3195 200 OKw - - - (empty) - -
  id: totrans-1145
  prefs: []
  type: TYPE_NORMAL
  zh: Firefox/20.0 0 3195 200 OKw - - - (empty) - -
- en: '- text/htmlx - -'
  id: totrans-1146
  prefs: []
  type: TYPE_NORMAL
  zh: '- text/htmlx - -'
- en: '#close 2013-04-23-20-06-19'
  id: totrans-1147
  prefs: []
  type: TYPE_NORMAL
  zh: '#close 2013-04-23-20-06-19'
- en: '*Listing 13-15: Bro* http .log *file for* bej-int .pcap *with checksum validation
    disabled* Now we see not only the GET request u for *http://www.bejtlich.net/*
    v but'
  id: totrans-1148
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表13-15: Bro* http.log *文件用于* bej-int .pcap *禁用校验和验证* 现在我们不仅看到GET请求u访问*http://www.bejtlich.net/*
    v，但'
- en: also a record of the server’s 200 OK reply w and indication that the page
  id: totrans-1149
  prefs: []
  type: TYPE_NORMAL
  zh: 也是服务器200 OK回复的记录w，表示页面
- en: returned was *text/html* x. You could perform similar analysis concerning
  id: totrans-1150
  prefs: []
  type: TYPE_NORMAL
  zh: 返回的是*text/html* x。你可以进行类似的分析，涉及
- en: Bro’s handling of *bej-ext.pcap* to see how it works when processing and ignor-
  id: totrans-1151
  prefs: []
  type: TYPE_NORMAL
  zh: Bro处理*bej-ext.pcap*的方式可以查看它在处理并忽略
- en: ing checksums. Listing 13-16 shows the results of the *http.log* file when Bro
  id: totrans-1152
  prefs: []
  type: TYPE_NORMAL
  zh: 校验和检查。列表13-16展示了当Bro处理*http.log*文件时的结果
- en: reads the *bej-ext.pcap* trace file with checksum processing disabled.
  id: totrans-1153
  prefs: []
  type: TYPE_NORMAL
  zh: 读取*bej-ext.pcap*跟踪文件，禁用校验和处理。
- en: $ **cat http.log**
  id: totrans-1154
  prefs: []
  type: TYPE_NORMAL
  zh: $ **cat http.log**
- en: '#separator \x09'
  id: totrans-1155
  prefs: []
  type: TYPE_NORMAL
  zh: '#separator \x09'
- en: '#set_separator ,'
  id: totrans-1156
  prefs: []
  type: TYPE_NORMAL
  zh: '#set_separator ,'
- en: '#empty_field (empty)'
  id: totrans-1157
  prefs: []
  type: TYPE_NORMAL
  zh: '#empty_field (empty)'
- en: '#unset_field -'
  id: totrans-1158
  prefs: []
  type: TYPE_NORMAL
  zh: '#unset_field -'
- en: '#path http'
  id: totrans-1159
  prefs: []
  type: TYPE_NORMAL
  zh: '#path http'
- en: '#open 2013-04-24-00-36-03'
  id: totrans-1160
  prefs: []
  type: TYPE_NORMAL
  zh: '#open 2013-04-24-00-36-03'
- en: '#fields ts uid id.orig_h id.orig_p id.resp_h id.resp_p trans_'
  id: totrans-1161
  prefs: []
  type: TYPE_NORMAL
  zh: '#fields ts uid id.orig_h id.orig_p id.resp_h id.resp_p trans_'
- en: depth method host uri referrer user_agent request_body_len
  id: totrans-1162
  prefs: []
  type: TYPE_NORMAL
  zh: depth method host uri referrer user_agent request_body_len
- en: response_body_len status_code status_msg info_code info_msg filename tags username
    password proxied mime_type md5 extraction_file
  id: totrans-1163
  prefs: []
  type: TYPE_NORMAL
  zh: response_body_len status_code status_msg info_code info_msg filename tags username
    password proxied mime_type md5 extraction_file
- en: '#types time string addr port addr port count string string string string string
    count count count string count string string table[enum] string string table[string]
    string string file'
  id: totrans-1164
  prefs: []
  type: TYPE_NORMAL
  zh: '#types time string addr port addr port count string string string string string
    count count count string count string string table[enum] string string table[string]
    string string file'
- en: 1366577618.269074 ua3JI6YJIxh 192.168.1.2 2770 205.186.148.46 80
  id: totrans-1165
  prefs: []
  type: TYPE_NORMAL
  zh: 1366577618.269074 ua3JI6YJIxh 192.168.1.2 2770 205.186.148.46 80
- en: 1 GET www.bejtlich.net /u http://www.taosecurity.com/training.html Mozilla/5.0
    (X11; Ubuntu; Linux x86_64; rv:20.0) Gecko/20100101 Firefox/20.0 0 3195
  id: totrans-1166
  prefs: []
  type: TYPE_NORMAL
  zh: 1 GET www.bejtlich.net /u http://www.taosecurity.com/training.html Mozilla/5.0
    (X11; Ubuntu; Linux x86_64; rv:20.0) Gecko/20100101 Firefox/20.0 0 3195
- en: 200 OKv - - - (empty) - - wVIA -> 1.1 localhost:3128
  id: totrans-1167
  prefs: []
  type: TYPE_NORMAL
  zh: 200 OKv - - - (empty) - - wVIA -> 1.1 localhost:3128
- en: (squid/2.7.STABLE9),X-FORWARDED-FOR -> 192.168.2.108x text/html - -
  id: totrans-1168
  prefs: []
  type: TYPE_NORMAL
  zh: (squid/2.7.STABLE9)，X-FORWARDED-FOR -> 192.168.2.108x text/html - -
- en: '#close 2013-04-24-00-36-04'
  id: totrans-1169
  prefs: []
  type: TYPE_NORMAL
  zh: '#close 2013-04-24-00-36-04'
- en: '*Listing 13-16: Bro* http .log *file for* bej-ext .pcap *with checksum validation
    disabled* In Listing 13-16, the interesting fields are the GET request for / u,
    the'
  id: totrans-1170
  prefs: []
  type: TYPE_NORMAL
  zh: '*列表13-16: Bro* http.log *文件用于* bej-ext .pcap *禁用校验和验证* 在列表13-16中，有趣的字段是GET请求/u，的'
- en: 200 OK reply v from the server, the Via statement w revealing the presence
  id: totrans-1171
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器返回的200 OK回复v，Via语句w揭示了存在
- en: of the Squid proxy, and the X-Forwarded-For field x showing the true source
  id: totrans-1172
  prefs: []
  type: TYPE_NORMAL
  zh: Squid代理的记录，以及X-Forwarded-For字段x显示真实的源
- en: IP address of the web client. With access only to logs of this nature, you
  id: totrans-1173
  prefs: []
  type: TYPE_NORMAL
  zh: Web客户端的IP地址。仅通过访问此类日志，你
- en: could use the X-Forwarded-For field to identify the true source IP address
  id: totrans-1174
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用X-Forwarded-For字段来识别真实的源IP地址
- en: of a client if you saw activity only at location Y and needed to know which
  id: totrans-1175
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你只看到位置Y的活动，并且需要知道哪个客户端
- en: browser was surfing to the web server in question.
  id: totrans-1176
  prefs: []
  type: TYPE_NORMAL
  zh: 浏览器正在访问相关的Web服务器。
- en: Proxies and Checksums **301**
  id: totrans-1177
  prefs: []
  type: TYPE_NORMAL
  zh: 代理和校验和 **301**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1178
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: 'The moral of the checksum story is this: If you must collect traffic from a
    system that transmits traffic with checksum offloading, be sure your tools'
  id: totrans-1179
  prefs: []
  type: TYPE_NORMAL
  zh: 校验和故事的寓意是这样的：如果你必须从一个使用校验和卸载传输流量的系统中收集流量，确保你的工具
- en: know how to handle the situation. Remember that you can tell Bro to ignore
  id: totrans-1180
  prefs: []
  type: TYPE_NORMAL
  zh: 知道如何处理这种情况。记住，你可以告诉Bro忽略
- en: bad checksums with the -C switch. See the SO mailing list and wiki or the
  id: totrans-1181
  prefs: []
  type: TYPE_NORMAL
  zh: 使用-C开关处理坏校验和。请参阅SO邮件列表和Wiki或
- en: manual pages for details on equivalent features in other tools. Snort, for
  id: totrans-1182
  prefs: []
  type: TYPE_NORMAL
  zh: 其他工具的手册页中有关于等效功能的详细信息。Snort，对于
- en: 'example, offers the following options to handle checksum processing:'
  id: totrans-1183
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，提供了以下选项来处理校验和处理：
- en: -k <mode> Checksum mode (all,noip,notcp,noudp,noicmp,none)
  id: totrans-1184
  prefs: []
  type: TYPE_NORMAL
  zh: -k <模式> 校验和模式（all, noip, notcp, noudp, noicmp, none）
- en: Now that you know how to handle the checksum offloading character-
  id: totrans-1185
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你知道如何处理校验和卸载特性了
- en: istics of collecting traffic on this pfSense box running a Squid proxy, you
  id: totrans-1186
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个运行Squid代理的pfSense盒子上收集流量的特点，你
- en: can use the data collected here for troubleshooting. Without taking into
  id: totrans-1187
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用这里收集的数据进行故障排除。没有考虑到
- en: account the checksum issue, you may have interpreted the traffic incor-
  id: totrans-1188
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到校验和问题，你可能已经错误地解释了流量
- en: rectly and arrived at odd conclusions about network performance.
  id: totrans-1189
  prefs: []
  type: TYPE_NORMAL
  zh: 直接处理并得出了有关网络性能的奇怪结论。
- en: '**conclusion**'
  id: totrans-1190
  prefs: []
  type: TYPE_NORMAL
  zh: '**结论**'
- en: This chapter introduced two features of networks that might trouble ana-
  id: totrans-1191
  prefs: []
  type: TYPE_NORMAL
  zh: 本章介绍了两个可能让分析师感到困扰的网络特性
- en: 'lysts: proxies and checksums. Proxies are problematic because they intro-'
  id: totrans-1192
  prefs: []
  type: TYPE_NORMAL
  zh: 列表：代理和校验和。代理存在问题，因为它们引入了另一个中间设备，增加了网络的复杂性。
- en: duce another middlebox, adding complexity to the network.
  id: totrans-1193
  prefs: []
  type: TYPE_NORMAL
  zh: 它们引入了另一个中间设备，增加了网络的复杂性。
- en: Like NAT, proxies obscure true source and destination IP addresses.
  id: totrans-1194
  prefs: []
  type: TYPE_NORMAL
  zh: 像NAT一样，代理会隐藏真实的源和目标IP地址。
- en: Although this chapter showed only one proxy at work, some organizations
  id: totrans-1195
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管本章只展示了一个代理在工作，但一些组织
- en: chain multiple proxies! Such a multiproxy scenario makes the supposed
  id: totrans-1196
  prefs: []
  type: TYPE_NORMAL
  zh: 链接多个代理！这样的多代理场景使得所谓的
- en: Holy Grail of NSM and proxies—proxy logs—unattainable. When multiple
  id: totrans-1197
  prefs: []
  type: TYPE_NORMAL
  zh: NSM和代理的圣杯——代理日志——无法获得。当多个
- en: proxies are involved, no single log shows all the activity analysts need to
    see.
  id: totrans-1198
  prefs: []
  type: TYPE_NORMAL
  zh: 代理涉及时，没有单一日志可以显示分析师需要查看的所有活动。
- en: If proxy logs were available, however, they would make a useful addition to
  id: totrans-1199
  prefs: []
  type: TYPE_NORMAL
  zh: 如果代理日志可用，它们将成为有用的补充
- en: the data collected by an application like ELSA.
  id: totrans-1200
  prefs: []
  type: TYPE_NORMAL
  zh: 应用程序如ELSA收集的数据。
- en: We also discussed checksums and odd results caused by offloading.
  id: totrans-1201
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还讨论了校验和和因卸载而导致的异常结果。
- en: 'This feature, designed to speed up networking, reveals a downside: zeroed'
  id: totrans-1202
  prefs: []
  type: TYPE_NORMAL
  zh: 这个功能旨在加速网络连接，但也暴露了一个缺点：零化
- en: checksums when reported by a traffic capture tool. Although it’s easier to
  id: totrans-1203
  prefs: []
  type: TYPE_NORMAL
  zh: 当由流量捕获工具报告校验和时。虽然这更容易
- en: engineer around this challenge, don’t be surprised if an eager analyst pro-
  id: totrans-1204
  prefs: []
  type: TYPE_NORMAL
  zh: 在解决这个挑战时，工程师不要惊讶于一位热心的分析师
- en: vides a trace file with one or both sides of a conversation containing 0x0000
  id: totrans-1205
  prefs: []
  type: TYPE_NORMAL
  zh: 提供了一个包含对话的一方或双方的跟踪文件，其中包含0x0000
- en: for the IP checksums. With the help of this chapter, you should understand
  id: totrans-1206
  prefs: []
  type: TYPE_NORMAL
  zh: 对于IP校验和。在本章的帮助下，你应该能够理解
- en: why that occurs and how to handle the issue.
  id: totrans-1207
  prefs: []
  type: TYPE_NORMAL
  zh: 发生的原因以及如何处理这个问题。
- en: '**302** Chapter 13'
  id: totrans-1208
  prefs: []
  type: TYPE_NORMAL
  zh: '**302** 第13章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1209
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '**c o N c l u S i o N**'
  id: totrans-1210
  prefs: []
  type: TYPE_NORMAL
  zh: '**结论**'
- en: I wrote this book to help readers start a net-
  id: totrans-1211
  prefs: []
  type: TYPE_NORMAL
  zh: 我写这本书是为了帮助读者开始一个网络
- en: work security monitoring operation within
  id: totrans-1212
  prefs: []
  type: TYPE_NORMAL
  zh: 在网络安全监控操作中
- en: their organization. I used the open source
  id: totrans-1213
  prefs: []
  type: TYPE_NORMAL
  zh: 他们的组织。我使用了开源
- en: SO suite to show how to put NSM to work in a
  id: totrans-1214
  prefs: []
  type: TYPE_NORMAL
  zh: SO套件展示如何在
- en: rapid and cost-effective manner. This final section
  id: totrans-1215
  prefs: []
  type: TYPE_NORMAL
  zh: 快速且具有成本效益的方式。最后这一部分
- en: of the book shows several other options for NSM and
  id: totrans-1216
  prefs: []
  type: TYPE_NORMAL
  zh: 本书展示了NSM的其他几个选项
- en: related operations. My goal is to show how NSM applies to other areas of
  id: totrans-1217
  prefs: []
  type: TYPE_NORMAL
  zh: 相关操作。我的目标是展示NSM如何应用于其他领域
- en: digital defense and how I think NSM will adapt to increasingly complex
  id: totrans-1218
  prefs: []
  type: TYPE_NORMAL
  zh: 数字防御以及我认为NSM将如何适应日益复杂的
- en: information processing requirements.
  id: totrans-1219
  prefs: []
  type: TYPE_NORMAL
  zh: 信息处理需求。
- en: First, I discuss how cloud computing affects NSM. The cloud presents
  id: totrans-1220
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我讨论了云计算如何影响NSM。云计算呈现出
- en: challenges and opportunities, and awareness of both will help security man-
  id: totrans-1221
  prefs: []
  type: TYPE_NORMAL
  zh: 挑战和机遇，意识到这两者将帮助安全管理
- en: agers better defend their data. Second, I talk about the importance of work-
  id: totrans-1222
  prefs: []
  type: TYPE_NORMAL
  zh: 管理人员更好地保护他们的数据。其次，我谈到了工作的重要性
- en: flow and why an operational, metrics-driven model is a key to CIRT success.
  id: totrans-1223
  prefs: []
  type: TYPE_NORMAL
  zh: 流量以及为什么一个操作性、以指标为驱动的模型是CIRT成功的关键。
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1224
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '**cloud computing**'
  id: totrans-1225
  prefs: []
  type: TYPE_NORMAL
  zh: '**云计算**'
- en: The National Institute of Standards and Technology (NIST) defines cloud
  id: totrans-1226
  prefs: []
  type: TYPE_NORMAL
  zh: 美国国家标准与技术研究院（NIST）定义了云计算
- en: computing as
  id: totrans-1227
  prefs: []
  type: TYPE_NORMAL
  zh: 计算时
- en: a model for enabling ubiquitous, convenient, on-demand net-
  id: totrans-1228
  prefs: []
  type: TYPE_NORMAL
  zh: 启用无处不在、方便、按需网络的模型
- en: work access to a shared pool of configurable computing resources
  id: totrans-1229
  prefs: []
  type: TYPE_NORMAL
  zh: 为工作访问共享的可配置计算资源池
- en: (e.g., networks, servers, storage, applications, and services) that
  id: totrans-1230
  prefs: []
  type: TYPE_NORMAL
  zh: （例如，网络、服务器、存储、应用程序和服务）可以
- en: can be rapidly provisioned and released with minimal manage-
  id: totrans-1231
  prefs: []
  type: TYPE_NORMAL
  zh: 可以快速配置并释放，管理最小化
- en: ment effort or service provider interaction.1
  id: totrans-1232
  prefs: []
  type: TYPE_NORMAL
  zh: 管理工作或服务提供商交互的努力。1
- en: 'NIST describes three service models:'
  id: totrans-1233
  prefs: []
  type: TYPE_NORMAL
  zh: NIST描述了三种服务模型：
- en: '***Software as a Service (SaaS)*** Allows the consumer to use the provider’s
    applications running on a cloud infrastructure.'
  id: totrans-1234
  prefs: []
  type: TYPE_NORMAL
  zh: '***软件即服务 (SaaS)*** 允许消费者使用在云基础设施上运行的提供商应用程序。'
- en: '***Platform as a Service (PaaS)*** Allows the consumer to deploy consumer-'
  id: totrans-1235
  prefs: []
  type: TYPE_NORMAL
  zh: '***平台即服务 (PaaS)*** 允许消费者部署提供商运行在云基础设施上的应用程序，'
- en: created applications or acquired applications created using program-
  id: totrans-1236
  prefs: []
  type: TYPE_NORMAL
  zh: 创建的应用程序或使用程序构建的已获取应用程序——
- en: ming languages, libraries, services, and tools supported by the provider
  id: totrans-1237
  prefs: []
  type: TYPE_NORMAL
  zh: 提供商支持的编程语言、库、服务和工具，
- en: onto the cloud infrastructure.
  id: totrans-1238
  prefs: []
  type: TYPE_NORMAL
  zh: 被移植到云基础设施上。
- en: '***Infrastructure as a Service (IaaS)*** Gives the consumer access to processing,
    storage, networks, and other fundamental computing resources'
  id: totrans-1239
  prefs: []
  type: TYPE_NORMAL
  zh: '***基础设施即服务 (IaaS)*** 允许消费者访问处理、存储、网络和其他基本计算资源，'
- en: where the consumer is able to deploy and run arbitrary software, which
  id: totrans-1240
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种模式下，消费者能够部署并运行任意软件，
- en: can include operating systems and applications.
  id: totrans-1241
  prefs: []
  type: TYPE_NORMAL
  zh: 可以包括操作系统和应用程序。
- en: A SaaS offering, like Salesforce.com ( *http://www.salesforce.com/*), gives
  id: totrans-1242
  prefs: []
  type: TYPE_NORMAL
  zh: 一项 SaaS 提供服务，如 Salesforce.com（*http://www.salesforce.com/*），为
- en: customers an application that provides certain capabilities, such as cus-
  id: totrans-1243
  prefs: []
  type: TYPE_NORMAL
  zh: 客户提供一个能够提供特定功能的应用程序，如客户关系管理。
- en: tomer relationship management. A PaaS offering, like Heroku ( *http://*
  id: totrans-1244
  prefs: []
  type: TYPE_NORMAL
  zh: 客户关系管理。PaaS 提供服务，如 Heroku（*http://*
- en: '*www.heroku.com/*), gives customers a set of programming languages and'
  id: totrans-1245
  prefs: []
  type: TYPE_NORMAL
  zh: '*www.heroku.com/*)，为客户提供一套编程语言和'
- en: related capabilities to build their own applications. An IaaS offering, like
  id: totrans-1246
  prefs: []
  type: TYPE_NORMAL
  zh: 具备构建自己应用程序的相关能力。IaaS 提供服务，如
- en: Amazon Elastic Compute Cloud (EC2, *https://aws.amazon.com/ec2*), gives
  id: totrans-1247
  prefs: []
  type: TYPE_NORMAL
  zh: 亚马逊弹性计算云 (EC2，*https://aws.amazon.com/ec2*)，为
- en: customers a virtual machine and related supporting infrastructure upon
  id: totrans-1248
  prefs: []
  type: TYPE_NORMAL
  zh: 客户可以通过虚拟机及相关支持基础设施来使用，
- en: which they can install their own software.
  id: totrans-1249
  prefs: []
  type: TYPE_NORMAL
  zh: 他们可以安装自己的软件。
- en: From an NSM perspective, a key feature of cloud computing is the fact
  id: totrans-1250
  prefs: []
  type: TYPE_NORMAL
  zh: 从 NSM 的角度看，云计算的一个关键特征是
- en: that information processing is being done “somewhere else.” One excep-
  id: totrans-1251
  prefs: []
  type: TYPE_NORMAL
  zh: 这个信息处理是“在别处”完成的。一个例外可能是
- en: tion may be a “private” cloud, operated by an organization for internal use,
  id: totrans-1252
  prefs: []
  type: TYPE_NORMAL
  zh: 这个例外可能是由一个组织为内部使用而运营的“私有”云，
- en: or a “community” cloud, operated by an organization cooperating with
  id: totrans-1253
  prefs: []
  type: TYPE_NORMAL
  zh: 或者是由一个合作组织运营的“社区”云，
- en: partners. When a cloud is “public” or “hybrid,” though, it means an orga-
  id: totrans-1254
  prefs: []
  type: TYPE_NORMAL
  zh: 合作伙伴。当云是“公共”或“混合”的时候，意味着一个组织的
- en: nization’s data is stored, manipulated, and transmitted beyond the normal
  id: totrans-1255
  prefs: []
  type: TYPE_NORMAL
  zh: 数据被存储、处理和传输到常规企业边界之外。
- en: enterprise boundaries. While many security professionals have debated
  id: totrans-1256
  prefs: []
  type: TYPE_NORMAL
  zh: 跨越企业边界。虽然许多安全专业人士对这一点进行了辩论，
- en: cloud security and related topics, this section examines visibility challenges
  id: totrans-1257
  prefs: []
  type: TYPE_NORMAL
  zh: 本节讨论了云安全和相关话题中的可见性挑战，
- en: posed by cloud computing.
  id: totrans-1258
  prefs: []
  type: TYPE_NORMAL
  zh: 云计算所带来的挑战。
- en: '***Cloud Computing Challenges***'
  id: totrans-1259
  prefs: []
  type: TYPE_NORMAL
  zh: '***云计算挑战***'
- en: With data processing occurring outside an organization, a CIRT cannot
  id: totrans-1260
  prefs: []
  type: TYPE_NORMAL
  zh: 数据处理发生在组织外部时，CIRT 无法
- en: rely on the network instrumentation models introduced in Chapter 2\.
  id: totrans-1261
  prefs: []
  type: TYPE_NORMAL
  zh: 依赖于第二章介绍的网络仪表模型。
- en: 1\. Peter Mell and Timothy Grance, “The NIST Definition of Cloud Computing,”
    NIST Special Publication 800-145, National Institute of Standards and Technology,
    U.S. Department of Commerce, September 2011, *http://csrc.nist.gov/publications/nistpubs/800-145/SP800-145.pdf*.
  id: totrans-1262
  prefs: []
  type: TYPE_NORMAL
  zh: 1\. Peter Mell 和 Timothy Grance，《NIST 云计算定义》，NIST 特别出版物 800-145，美国国家标准与技术研究院，2011
    年 9 月，*http://csrc.nist.gov/publications/nistpubs/800-145/SP800-145.pdf*。
- en: '**304** Conclusion'
  id: totrans-1263
  prefs: []
  type: TYPE_NORMAL
  zh: '**304** 结论'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1264
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '![Image 160](index-339_1.jpg)'
  id: totrans-1265
  prefs: []
  type: TYPE_IMG
  zh: '![Image 160](index-339_1.jpg)'
- en: Cloud users are not normally able to deploy taps or configure SPAN ports
  id: totrans-1266
  prefs: []
  type: TYPE_NORMAL
  zh: 云用户通常无法部署网络探针或配置 SPAN 端口，
- en: to see traffic to or from a cloud provider’s infrastructure. By its very nature,
  id: totrans-1267
  prefs: []
  type: TYPE_NORMAL
  zh: 查看云提供商基础设施的流量进出。凭其本质，
- en: cloud infrastructures tend to be multitenant environments catering to hun-
  id: totrans-1268
  prefs: []
  type: TYPE_NORMAL
  zh: 云基础设施往往是多租户环境，服务于数百个
- en: dreds or thousands of customers on shared platforms. Even though you may
  id: totrans-1269
  prefs: []
  type: TYPE_NORMAL
  zh: 服务上共享平台上的成百上千客户。尽管你可能
- en: want to see network traffic to and from the platforms processing your data,
  id: totrans-1270
  prefs: []
  type: TYPE_NORMAL
  zh: 想查看处理你数据的云平台的进出流量，
- en: your cloud neighbors may not want you to see their traffic!
  id: totrans-1271
  prefs: []
  type: TYPE_NORMAL
  zh: 你的云邻居可能不希望你看到他们的流量！
- en: NSM is generally not an option for SaaS offerings because customers
  id: totrans-1272
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 通常不是 SaaS 提供服务的选择，因为客户
- en: interact with an application provided by a cloud company. Customers are
  id: totrans-1273
  prefs: []
  type: TYPE_NORMAL
  zh: 与云公司提供的应用程序交互。客户可以
- en: limited to relying upon whatever logs the cloud provider makes available.
  id: totrans-1274
  prefs: []
  type: TYPE_NORMAL
  zh: 限制于依赖云提供商提供的日志。
- en: NSM is also rarely possible for PaaS offerings, although customers can choose
  id: totrans-1275
  prefs: []
  type: TYPE_NORMAL
  zh: 对于PaaS服务，NSM也很难实现，尽管客户可以选择
- en: to build application-level logging capabilities into the software they build
  id: totrans-1276
  prefs: []
  type: TYPE_NORMAL
  zh: 将应用程序级日志记录功能内建到他们构建的软件中。
- en: on the PaaS platform. NSM may be possible on IaaS offerings, but the visi-
  id: totrans-1277
  prefs: []
  type: TYPE_NORMAL
  zh: 在PaaS平台上。NSM可能在IaaS服务中实现，但可视性
- en: bility is generally limited to specific virtual machines. NSM on IaaS requires
  id: totrans-1278
  prefs: []
  type: TYPE_NORMAL
  zh: 功能通常限于特定虚拟机。IaaS上的NSM需要
- en: lightweight approaches where agents on the specific VM collect and analyze
  id: totrans-1279
  prefs: []
  type: TYPE_NORMAL
  zh: 轻量级方法，代理在特定虚拟机上收集和分析
- en: network-centric data.
  id: totrans-1280
  prefs: []
  type: TYPE_NORMAL
  zh: 网络中心的数据。
- en: Threat Stack ( *http://www.threatstack.com/*) is an example of a commercial
  id: totrans-1281
  prefs: []
  type: TYPE_NORMAL
  zh: Threat Stack（*http://www.threatstack.com/*）是一个基于云的商业
- en: offering to meet the need for NSM on IaaS cloud platforms. Dustin Webber,
  id: totrans-1282
  prefs: []
  type: TYPE_NORMAL
  zh: 提供NSM功能的IaaS云平台。Dustin Webber，
- en: author of the Snorby tool, founded Threat Stackwith Jen Andre to extend
  id: totrans-1283
  prefs: []
  type: TYPE_NORMAL
  zh: Snorby工具的作者，与Jen Andre共同创立了Threat Stack，以扩展
- en: Snorby beyond the enterprise. Threat Stack provides a lightweight agent that
  id: totrans-1284
  prefs: []
  type: TYPE_NORMAL
  zh: Snorby超越企业之外。Threat Stack提供了一个轻量级代理，
- en: collects and generates NSM information on individual endpoints, whether
  id: totrans-1285
  prefs: []
  type: TYPE_NORMAL
  zh: 收集并生成关于各个终端的NSM信息，无论
- en: in the enterprise or on IaaS cloud platforms. The Threat Stack agent reports
  id: totrans-1286
  prefs: []
  type: TYPE_NORMAL
  zh: 在企业中或IaaS云平台上的示例。Threat Stack代理报告
- en: its findings to a cloud-based controller operated by the Threat Stack team.
  id: totrans-1287
  prefs: []
  type: TYPE_NORMAL
  zh: 将其结果传输到由Threat Stack团队运营的基于云的控制器。
- en: When analysts want to investigate NSM data from the agents, they log into
  id: totrans-1288
  prefs: []
  type: TYPE_NORMAL
  zh: 当分析师想要调查来自代理的NSM数据时，他们登录到
- en: a cloud application published by Threat Stack. Figure 1 depicts the Threat
  id: totrans-1289
  prefs: []
  type: TYPE_NORMAL
  zh: 由Threat Stack发布的云应用程序。图1展示了Threat
- en: Stack dashboard, showing data from an agent deployed on a virtual private
  id: totrans-1290
  prefs: []
  type: TYPE_NORMAL
  zh: Stack仪表盘，显示来自部署在虚拟私人
- en: server.
  id: totrans-1291
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器。
- en: '*Figure 1: Threat Stack dashboard*'
  id: totrans-1292
  prefs: []
  type: TYPE_NORMAL
  zh: '*图1：Threat Stack仪表盘*'
- en: Conclusion **305**
  id: totrans-1293
  prefs: []
  type: TYPE_NORMAL
  zh: 结论 **305**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1294
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '![Image 161](index-340_1.jpg)'
  id: totrans-1295
  prefs: []
  type: TYPE_IMG
  zh: '![图161](index-340_1.jpg)'
- en: Threat Stack demonstrates how a cloud-based challenge, like monitor-
  id: totrans-1296
  prefs: []
  type: TYPE_NORMAL
  zh: Threat Stack展示了云端挑战如何应对监控-
- en: ing IaaS platforms, can be met by using the cloud to collect and present
  id: totrans-1297
  prefs: []
  type: TYPE_NORMAL
  zh: 运行IaaS平台，可以通过使用云来收集和呈现
- en: NSM data from agents. This hints at some of the benefits cloud computing
  id: totrans-1298
  prefs: []
  type: TYPE_NORMAL
  zh: 来自代理的NSM数据。这暗示了云计算的一些优势。
- en: brings to NSM operators.
  id: totrans-1299
  prefs: []
  type: TYPE_NORMAL
  zh: 给NSM操作员带来的优势。
- en: '***Cloud Computing Benefits***'
  id: totrans-1300
  prefs: []
  type: TYPE_NORMAL
  zh: '***云计算的优势***'
- en: Cloud environments give analysts powerful and expandable environments
  id: totrans-1301
  prefs: []
  type: TYPE_NORMAL
  zh: 云环境为分析师提供了强大且可扩展的工作环境
- en: to process and mine NSM data. By putting NSM data in the cloud, storage
  id: totrans-1302
  prefs: []
  type: TYPE_NORMAL
  zh: 处理和挖掘NSM数据。通过将NSM数据放到云中，存储
- en: and analytical power become less of an issue. Analysts must be comfort-
  id: totrans-1303
  prefs: []
  type: TYPE_NORMAL
  zh: 分析能力问题会变得不那么突出。分析师必须感到舒适-
- en: able with the security controls applied by the cloud provider before putting
  id: totrans-1304
  prefs: []
  type: TYPE_NORMAL
  zh: 在云提供商应用安全控制后再进行处理。
- en: sensitive information in the hands of another company. If the provider can
  id: totrans-1305
  prefs: []
  type: TYPE_NORMAL
  zh: 敏感信息掌握在另一家公司手中。如果服务提供商能够
- en: meet those concerns, the cloud offers exciting possibilities.
  id: totrans-1306
  prefs: []
  type: TYPE_NORMAL
  zh: 满足这些需求，云提供了令人兴奋的可能性。
- en: Packetloop ( *http://www.packetloop.com/*) is an example of another com-
  id: totrans-1307
  prefs: []
  type: TYPE_NORMAL
  zh: Packetloop（*http://www.packetloop.com/*）是另一个基于云的商业
- en: mercial offering built on the cloud, but with a different focus. Michael Baker
  id: totrans-1308
  prefs: []
  type: TYPE_NORMAL
  zh: 基于云的商业提供，聚焦点不同。Michael Baker
- en: and his team in Australia built Packetloop as a cloud-based application to
  id: totrans-1309
  prefs: []
  type: TYPE_NORMAL
  zh: 以及他在澳大利亚的团队开发了Packetloop，作为一个基于云的应用
- en: analyze network traffic uploaded by users. Analysts can send network traffic
  id: totrans-1310
  prefs: []
  type: TYPE_NORMAL
  zh: 分析用户上传的网络流量。分析师可以发送网络流量
- en: in bulk to Packetloop, which then processes and displays that traffic in various
  id: totrans-1311
  prefs: []
  type: TYPE_NORMAL
  zh: 批量传输到Packetloop，后者处理并以各种方式展示这些流量。
- en: ways. Figure 2 shows a Packetloop dashboard for the network traffic asso-
  id: totrans-1312
  prefs: []
  type: TYPE_NORMAL
  zh: 多种方式。图2展示了Packetloop仪表盘，显示与网络流量相关的
- en: ciated with a Digital Corpora sample case ( *http://digitalcorpora.org/corpora/*
  id: totrans-1313
  prefs: []
  type: TYPE_NORMAL
  zh: 关联于数字语料库样本案例（*http://digitalcorpora.org/corpora/*
- en: '*scenarios/m57-patents-scenario/*).'
  id: totrans-1314
  prefs: []
  type: TYPE_NORMAL
  zh: '*场景/m57-patents-scenario/*)。'
- en: '*Figure 2: Packetloop dashboard for sample network traffic*'
  id: totrans-1315
  prefs: []
  type: TYPE_NORMAL
  zh: '*图2：Packetloop仪表盘，显示示例网络流量*'
- en: Threat Stack and Packetloop are options for enterprise users comfort-
  id: totrans-1316
  prefs: []
  type: TYPE_NORMAL
  zh: Threat Stack和Packetloop是企业用户的选择，令人放心-
- en: able with sending local data to cloud providers. Perhaps more importantly,
  id: totrans-1317
  prefs: []
  type: TYPE_NORMAL
  zh: 可以将本地数据发送给云服务提供商。或许更重要的是，
- en: these two offerings are suitable for customers who already do computing
  id: totrans-1318
  prefs: []
  type: TYPE_NORMAL
  zh: 这两种服务适合那些已经进行计算的客户。
- en: in the cloud. In other words, customers doing work in the cloud are likely
  id: totrans-1319
  prefs: []
  type: TYPE_NORMAL
  zh: 在云端。换句话说，云上工作的客户可能
- en: '**306** Conclusion'
  id: totrans-1320
  prefs: []
  type: TYPE_NORMAL
  zh: '**306** 结论'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1321
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '![Image 162](index-341_1.png)'
  id: totrans-1322
  prefs: []
  type: TYPE_IMG
  zh: '![Image 162](index-341_1.png)'
- en: to be comfortable sending logs or network traffic or both to another cloud
  id: totrans-1323
  prefs: []
  type: TYPE_NORMAL
  zh: 感到舒适将日志或网络流量或两者发送到另一个云端
- en: offering, such as a security vendor. As more computing work shifts from the
  id: totrans-1324
  prefs: []
  type: TYPE_NORMAL
  zh: 提供商，如安全供应商的效果。随着越来越多的计算工作从
- en: enterprise to the cloud, I expect this sort of “cloud-to-cloud” relationship
    to
  id: totrans-1325
  prefs: []
  type: TYPE_NORMAL
  zh: 企业迁移到云端时，我预计这种“云对云”关系会
- en: become more important for security and monitoring needs.
  id: totrans-1326
  prefs: []
  type: TYPE_NORMAL
  zh: 对安全和监控需求变得越来越重要。
- en: '**workflow, Metrics, and collaboration**'
  id: totrans-1327
  prefs: []
  type: TYPE_NORMAL
  zh: '**工作流、度量和协作**'
- en: NSM isn’t just about tools. NSM is an operation, and that concept implies
  id: totrans-1328
  prefs: []
  type: TYPE_NORMAL
  zh: NSM不仅仅是工具。NSM是一种操作，而这一概念意味着
- en: workflow, metrics, and collaboration. A *workflow* establishes a series of steps
    that an analyst follows to perform the detection and response mission.
  id: totrans-1329
  prefs: []
  type: TYPE_NORMAL
  zh: 工作流、度量和协作。*工作流*确定了分析员执行检测和响应任务时所遵循的一系列步骤。
- en: '*Metrics*, like the classification and count of incidents and the time elapsed'
  id: totrans-1330
  prefs: []
  type: TYPE_NORMAL
  zh: '*度量*，如事件的分类和数量，以及经过的时间'
- en: from incident detection to containment, measure the effectiveness of the
  id: totrans-1331
  prefs: []
  type: TYPE_NORMAL
  zh: 从事件检测到遏制，衡量
- en: workflow. *Collaboration* enables analysts to work smarter and faster.
  id: totrans-1332
  prefs: []
  type: TYPE_NORMAL
  zh: 工作流。*协作*使分析员能更聪明、更快速地工作。
- en: '***Workflow and Metrics***'
  id: totrans-1333
  prefs: []
  type: TYPE_NORMAL
  zh: '***工作流与度量***'
- en: The next generation of NSM tools will incorporate these key features.
  id: totrans-1334
  prefs: []
  type: TYPE_NORMAL
  zh: 下一代NSM工具将融合这些关键功能。
- en: Mandiant provides these capabilities in several of its commercial offerings.
  id: totrans-1335
  prefs: []
  type: TYPE_NORMAL
  zh: Mandiant在其多个商业产品中提供了这些功能。
- en: The goal is to help customers more rapidly scope an intrusion, manage
  id: totrans-1336
  prefs: []
  type: TYPE_NORMAL
  zh: 目标是帮助客户更快地确定入侵范围，管理
- en: the escalation and resolution process, and highlight areas of improvement.
  id: totrans-1337
  prefs: []
  type: TYPE_NORMAL
  zh: 升级和解决过程，并突出改进的领域。
- en: Figure 3 shows a graph of two key incident response measurements.
  id: totrans-1338
  prefs: []
  type: TYPE_NORMAL
  zh: 图3显示了两个关键事件响应指标的图表。
- en: '*Figure 3: Tracking open incidents versus the average time to close an incident*'
  id: totrans-1339
  prefs: []
  type: TYPE_NORMAL
  zh: '*图3：跟踪未解决事件与关闭事件的平均时间*'
- en: In Figure 3, we see a series of dots connected into a line, showing the
  id: totrans-1340
  prefs: []
  type: TYPE_NORMAL
  zh: 在图3中，我们看到一系列连接成线的点，显示了
- en: average time, in hours, required to close an incident. In this case, “closing”
  id: totrans-1341
  prefs: []
  type: TYPE_NORMAL
  zh: 关闭一个事件所需的平均时间，以小时计算。在这种情况下，“关闭”
- en: means conducting short-term incident containment (STIC) to mitigate the
  id: totrans-1342
  prefs: []
  type: TYPE_NORMAL
  zh: 进行短期事件遏制（STIC）以减轻
- en: risk posed by an intruder who has compromised a computer. The bars show
  id: totrans-1343
  prefs: []
  type: TYPE_NORMAL
  zh: 被入侵者攻击的计算机所带来的风险。柱状图显示了
- en: the number of open incidents on a daily basis. The spike in open incidents
  id: totrans-1344
  prefs: []
  type: TYPE_NORMAL
  zh: 每日未解决事件的数量。未解决事件的激增
- en: on April 23 caused the average closure time to spike as well. This indicates
  id: totrans-1345
  prefs: []
  type: TYPE_NORMAL
  zh: 4月23日的事件导致平均关闭时间也急剧上升。这表明
- en: that the CIRT was overwhelmed by the number of incidents it had to man-
  id: totrans-1346
  prefs: []
  type: TYPE_NORMAL
  zh: CIRT因处理的事件数量过多而不堪重负
- en: age. If the organization’s goal for average closure time is 10 hours or less,
  id: totrans-1347
  prefs: []
  type: TYPE_NORMAL
  zh: 如果组织的目标是平均关闭时间为10小时或更短，
- en: this spike demonstrates that the CIRT cannot meet such a goal when the
  id: totrans-1348
  prefs: []
  type: TYPE_NORMAL
  zh: 这个激增表明，当
- en: number of open incidents exceeds 10 daily cases. CIRT managers can use
  id: totrans-1349
  prefs: []
  type: TYPE_NORMAL
  zh: 未解决事件的数量超过每日10个案件。CIRT经理可以利用
- en: these metrics to justify additional headcount or to adjust processes or tools
  id: totrans-1350
  prefs: []
  type: TYPE_NORMAL
  zh: 使用这些度量来证明额外人员的需求，或调整流程或工具
- en: to keep the CIRT on track.
  id: totrans-1351
  prefs: []
  type: TYPE_NORMAL
  zh: 以保持CIRT的正常运作。
- en: Conclusion **307**
  id: totrans-1352
  prefs: []
  type: TYPE_NORMAL
  zh: 结论 **307**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1353
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '![Image 163](index-342_1.jpg)'
  id: totrans-1354
  prefs: []
  type: TYPE_IMG
  zh: '![Image 163](index-342_1.jpg)'
- en: '***Collaboration***'
  id: totrans-1355
  prefs: []
  type: TYPE_NORMAL
  zh: '***协作***'
- en: CIRTs that can manage many simultaneous intrusions often benefit from
  id: totrans-1356
  prefs: []
  type: TYPE_NORMAL
  zh: 能够管理多个同时入侵的CIRT通常能从
- en: powerful collaboration tools. Many analysts are familiar with wikis, chat
  id: totrans-1357
  prefs: []
  type: TYPE_NORMAL
  zh: 强大的协作工具。许多分析员熟悉维基、聊天
- en: channels and clients, and other tools for exchanging incident data. A new
  id: totrans-1358
  prefs: []
  type: TYPE_NORMAL
  zh: 渠道和客户端，以及其他用于交换事件数据的工具。一个新的
- en: sort of collaboration tool combines processing NSM data with shared ana-
  id: totrans-1359
  prefs: []
  type: TYPE_NORMAL
  zh: 这种协作工具结合了处理NSM数据和共享分析
- en: lytical capabilities. Just as online word processing applications like Google
  id: totrans-1360
  prefs: []
  type: TYPE_NORMAL
  zh: 分析能力。就像在线文字处理应用程序Google Docs一样
- en: Docs allow multiple users to collaborate simultaneously, some tools are
  id: totrans-1361
  prefs: []
  type: TYPE_NORMAL
  zh: 文档允许多个用户同时协作，某些工具是
- en: emerging to provide similar features to NSM operators.
  id: totrans-1362
  prefs: []
  type: TYPE_NORMAL
  zh: 正在涌现，提供类似的功能给NSM操作员。
- en: CloudShark ( *http://www.cloudshark.org/*) is an example of a collabora-
  id: totrans-1363
  prefs: []
  type: TYPE_NORMAL
  zh: CloudShark（ *http://www.cloudshark.org/*）是一个协作
- en: tive packet analysis tool. The team at QA Cafe ( *http://www.qacafe.com/*)
  id: totrans-1364
  prefs: []
  type: TYPE_NORMAL
  zh: 具有创新的包分析工具。QA Cafe的团队（ *http://www.qacafe.com/*）
- en: built CloudShark as a platform that customers could deploy on-premise
  id: totrans-1365
  prefs: []
  type: TYPE_NORMAL
  zh: 构建了CloudShark，作为客户可以在本地部署的平台
- en: and share among multiple team members. (Despite its name, CloudShark
  id: totrans-1366
  prefs: []
  type: TYPE_NORMAL
  zh: 和多个团队成员共享。（尽管其名称为 CloudShark
- en: doesn’t reside in the cloud; customers buy the software and deploy it within
  id: totrans-1367
  prefs: []
  type: TYPE_NORMAL
  zh: 不存在于云端；客户购买软件并在其内部部署
- en: their enterprise.2) Analysts upload packet captures to the local appliance
  id: totrans-1368
  prefs: []
  type: TYPE_NORMAL
  zh: 他们的企业。2）分析师将数据包捕获上传到本地设备
- en: and then manipulate packet captures via a web browser. Figure 4 shows
  id: totrans-1369
  prefs: []
  type: TYPE_NORMAL
  zh: 然后通过网页浏览器操作数据包捕获。图 4 展示了
- en: an example of CloudShark rendering DNS and Online Certificate Status
  id: totrans-1370
  prefs: []
  type: TYPE_NORMAL
  zh: 一个 CloudShark 渲染 DNS 和在线证书状态的示例
- en: Protocol (OCSP) traffic.
  id: totrans-1371
  prefs: []
  type: TYPE_NORMAL
  zh: 协议（OCSP）流量。
- en: '*Figure 4: CloudShark displaying DNS and OCSP traffic*'
  id: totrans-1372
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 4：CloudShark 显示 DNS 和 OCSP 流量*'
- en: CloudShark appears very similar to Wireshark, so analysts will feel at
  id: totrans-1373
  prefs: []
  type: TYPE_NORMAL
  zh: CloudShark 看起来非常类似于 Wireshark，因此分析师会感到很
- en: home in the interface. A CIRT could maintain a local CloudShark appli-
  id: totrans-1374
  prefs: []
  type: TYPE_NORMAL
  zh: 在界面中定位。CIRT 可以维护一个本地的 CloudShark 应用程序
- en: ance as a repository of key network traces derived from various intrusions.
  id: totrans-1375
  prefs: []
  type: TYPE_NORMAL
  zh: 作为从各种入侵中提取的关键网络跟踪的存储库。
- en: 2\. The example in this section appears courtesy of CloudShark and Jeremy Stretch,
    who publish sample traces online at *http://packetlife.net/captures/protocol/dns/*
    and *http://www.cloudshark*
  id: totrans-1376
  prefs: []
  type: TYPE_NORMAL
  zh: 2\. 本节中的示例由 CloudShark 和 Jeremy Stretch 提供，他们在线发布样本跟踪数据，地址为 *http://packetlife.net/captures/protocol/dns/*
    和 *http://www.cloudshark*
- en: '*.org/captures/46b2c8403863/* to demonstrate CloudShark’s capabilities.'
  id: totrans-1377
  prefs: []
  type: TYPE_NORMAL
  zh: '*.org/captures/46b2c8403863/* 用于展示 CloudShark 的能力。'
- en: '**308** Conclusion'
  id: totrans-1378
  prefs: []
  type: TYPE_NORMAL
  zh: '**308** 结论'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1379
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: For example, when Sguil retrieves traffic from a sensor to build a transcript,
    the server retains a local archive of the traffic. A CIRT could upload all of
  id: totrans-1380
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，当 Sguil 从传感器检索流量以构建记录时，服务器会保留该流量的本地存档。CIRT 可以将所有
- en: those captures to CloudShark, making them easily available and browsable
  id: totrans-1381
  prefs: []
  type: TYPE_NORMAL
  zh: 将这些捕获数据上传到 CloudShark，使其易于获取和浏览
- en: by analysts. These analysts could also add comments to the trace via the
  id: totrans-1382
  prefs: []
  type: TYPE_NORMAL
  zh: 由分析师进行。这些分析师还可以通过
- en: Info and Comments features and tag the trace with key names for later
  id: totrans-1383
  prefs: []
  type: TYPE_NORMAL
  zh: 信息和评论功能，并为跟踪数据添加关键标签，便于后续
- en: reference. Being a local appliance, CloudShark may address some of the
  id: totrans-1384
  prefs: []
  type: TYPE_NORMAL
  zh: 参考。作为一个本地设备，CloudShark 可能解决一些
- en: concerns presented by pure cloud-based offerings as well.
  id: totrans-1385
  prefs: []
  type: TYPE_NORMAL
  zh: 纯云端产品所带来的问题也需要关注。
- en: '**conclusion**'
  id: totrans-1386
  prefs: []
  type: TYPE_NORMAL
  zh: '**结论**'
- en: This final part of the book showed examples of some of the NSM capabil-
  id: totrans-1387
  prefs: []
  type: TYPE_NORMAL
  zh: 本书的最后部分展示了 NSM 功能的一些示例
- en: ities found outside the SO suite. As CIRTs realize that the power of NSM
  id: totrans-1388
  prefs: []
  type: TYPE_NORMAL
  zh: 在 SO 套件之外发现的功能。随着 CIRT 意识到 NSM 的强大功能
- en: must be applied to cloud environments and can be augmented by cloud
  id: totrans-1389
  prefs: []
  type: TYPE_NORMAL
  zh: 必须应用于云环境，并且可以通过云
- en: and collaborative platforms, I expect to see more offerings leveraging
  id: totrans-1390
  prefs: []
  type: TYPE_NORMAL
  zh: 和协作平台，我预计会看到更多利用
- en: those capabilities. Threat Stack, Packetloop, Mandiant, and CloudShark
  id: totrans-1391
  prefs: []
  type: TYPE_NORMAL
  zh: 这些功能。Threat Stack、Packetloop、Mandiant 和 CloudShark
- en: are a few examples of companies integrating NSM-related services into
  id: totrans-1392
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一些公司将 NSM 相关服务整合进
- en: their core offerings. With luck, these and other solution providers will
  id: totrans-1393
  prefs: []
  type: TYPE_NORMAL
  zh: 他们的核心产品。幸运的话，这些及其他解决方案提供商将
- en: continue to put tools and processes into the hands of CIRTs worldwide.
  id: totrans-1394
  prefs: []
  type: TYPE_NORMAL
  zh: 继续将工具和流程交到全球 CIRT 手中。
- en: It is possible to defeat adversaries if we stop them before they accomplish
  id: totrans-1395
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们在对手完成任务之前阻止他们，就有可能战胜对手
- en: their mission. As it has been since the early 1990s, NSM will continue to
  id: totrans-1396
  prefs: []
  type: TYPE_NORMAL
  zh: 他们的任务。正如自 1990 年代初以来的情况一样，NSM 将继续
- en: be a powerful, cost-effective way to counter intruders. Take heart, CIRTs;
  id: totrans-1397
  prefs: []
  type: TYPE_NORMAL
  zh: 是对抗入侵者的一种强大且具成本效益的方式。振作起来，CIRT；
- en: the future remains bright!
  id: totrans-1398
  prefs: []
  type: TYPE_NORMAL
  zh: 未来依然光明！
- en: Conclusion **309**
  id: totrans-1399
  prefs: []
  type: TYPE_NORMAL
  zh: 结论 **309**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1400
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1401
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '**S o S c r i P T S**'
  id: totrans-1402
  prefs: []
  type: TYPE_NORMAL
  zh: '**SO 脚本**'
- en: '**a N D c o N f i g u r aT i o N**'
  id: totrans-1403
  prefs: []
  type: TYPE_NORMAL
  zh: '**A N D 配置**'
- en: '*by Doug Burks, creator of Security Onion*'
  id: totrans-1404
  prefs: []
  type: TYPE_NORMAL
  zh: '*由 Security Onion 的创建者 Doug Burks 提供*'
- en: This appendix provides a quick reference
  id: totrans-1405
  prefs: []
  type: TYPE_NORMAL
  zh: 本附录提供了一个快速参考
- en: to the Security Onion (SO) control scripts
  id: totrans-1406
  prefs: []
  type: TYPE_NORMAL
  zh: 到 Security Onion (SO) 控制脚本
- en: and configuration files. This material will
  id: totrans-1407
  prefs: []
  type: TYPE_NORMAL
  zh: 和配置文件。该材料将
- en: help SO users better administer and optimize
  id: totrans-1408
  prefs: []
  type: TYPE_NORMAL
  zh: 帮助 SO 用户更好地管理和优化
- en: their sensor deployments.
  id: totrans-1409
  prefs: []
  type: TYPE_NORMAL
  zh: 他们的传感器部署。
- en: '**So control Scripts**'
  id: totrans-1410
  prefs: []
  type: TYPE_NORMAL
  zh: '**SO 控制脚本**'
- en: The NSM control scripts are one of the core components of SO. These
  id: totrans-1411
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 控制脚本是 SO 的核心组件之一。这些
- en: scripts were originally a part of the NSMnow package developed by the
  id: totrans-1412
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本最初是 NSMnow 软件包的一部分，该软件包由
- en: SecurixLive team ( *http://www.securixlive.com/nsmnow/docs/index.php*), but
  id: totrans-1413
  prefs: []
  type: TYPE_NORMAL
  zh: SecurixLive 团队（*http://www.securixlive.com/nsmnow/docs/index.php*），但是
- en: they have been heavily modified for use in SO.
  id: totrans-1414
  prefs: []
  type: TYPE_NORMAL
  zh: 它们已被重度修改，以便在 SO 中使用。
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1415
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: The NSM scripts were first developed to control a Sguil server (sguild), its
    agents (snort_agent, pads_agent, sancp_agent, and pcap_agent), and its sensor
  id: totrans-1416
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 脚本最初是为控制 Sguil 服务器（sguild）、其代理（snort_agent、pads_agent、sancp_agent 和 pcap_agent）及其传感器而开发的
- en: components (snort, pads, sancp, and daemonlogger). The following are some of
  id: totrans-1417
  prefs: []
  type: TYPE_NORMAL
  zh: 组件（snort、pads、sancp 和 daemonlogger）。以下是其中的一些
- en: 'the changes we’ve made to SO:'
  id: totrans-1418
  prefs: []
  type: TYPE_NORMAL
  zh: 我们对 SO 所做的更改：
- en: • Added the ability to use Suricata instead of Snort
  id: totrans-1419
  prefs: []
  type: TYPE_NORMAL
  zh: • 添加了使用 Suricata 代替 Snort 的功能
- en: • Added the ability to spin up multiple instances of Snort via PF_RING (and
  id: totrans-1420
  prefs: []
  type: TYPE_NORMAL
  zh: • 添加了通过 PF_RING 启动多个 Snort 实例的功能（并且
- en: an equal number of instances of barnyard2 and snort_agent)
  id: totrans-1421
  prefs: []
  type: TYPE_NORMAL
  zh: barnyard2 和 snort_agent 的实例数目相同）
- en: • Added control of Argus
  id: totrans-1422
  prefs: []
  type: TYPE_NORMAL
  zh: • 添加了对 Argus 组件的控制
- en: • Added control of Bro
  id: totrans-1423
  prefs: []
  type: TYPE_NORMAL
  zh: • 添加了对 Bro 的控制
- en: • Added control of Sguil’s OSSEC agent
  id: totrans-1424
  prefs: []
  type: TYPE_NORMAL
  zh: • 添加了对 Sguil 的 OSSEC 代理的控制
- en: • Added control of Sguil’s HTTP agent
  id: totrans-1425
  prefs: []
  type: TYPE_NORMAL
  zh: • 添加了对 Sguil 的 HTTP 代理的控制
- en: • Replaced pads and sancp with prads
  id: totrans-1426
  prefs: []
  type: TYPE_NORMAL
  zh: • 用 prads 替换了 pads 和 sancp
- en: • Replaced daemonlogger with netsniff-ng
  id: totrans-1427
  prefs: []
  type: TYPE_NORMAL
  zh: • 用 netsniff-ng 替换了 daemonlogger
- en: The NSM scripts are installed at */usr/sbin/nsm** and require root privi-
  id: totrans-1428
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 脚本安装在 */usr/sbin/nsm**，并需要 root 权限
- en: leges, so they should be run using sudo. The directory */usr/sbin/* should be
  id: totrans-1429
  prefs: []
  type: TYPE_NORMAL
  zh: 权限，所以它们应该使用 sudo 运行。目录 */usr/sbin/* 应该
- en: in your PATH variable, so you shouldn’t need to include the full path when
  id: totrans-1430
  prefs: []
  type: TYPE_NORMAL
  zh: 在你的 PATH 变量中，因此你不需要包含完整路径
- en: executing the commands. The full path is included in the examples here
  id: totrans-1431
  prefs: []
  type: TYPE_NORMAL
  zh: 执行这些命令时，示例中包含了完整路径
- en: for completeness.
  id: totrans-1432
  prefs: []
  type: TYPE_NORMAL
  zh: 完整性。
- en: We won’t cover every option for every script, but you can explore each
  id: totrans-1433
  prefs: []
  type: TYPE_NORMAL
  zh: 我们不会涵盖每个脚本的所有选项，但你可以探索每个
- en: of these scripts using --help to learn more about them. For example, to see
  id: totrans-1434
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 --help 查看这些脚本的更多信息。例如，查看
- en: 'more information about /usr/sbin/nsm, enter this command:'
  id: totrans-1435
  prefs: []
  type: TYPE_NORMAL
  zh: 若要获取有关 /usr/sbin/nsm 的更多信息，请输入此命令：
- en: $ **sudo /usr/sbin/nsm --help**
  id: totrans-1436
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm --help**
- en: The NSMnow Administration scripts are designed to easily configure and manage
  id: totrans-1437
  prefs: []
  type: TYPE_NORMAL
  zh: NSMnow 管理脚本旨在轻松配置和管理
- en: your NSM installation. Bugs, comments and flames can be directed to the
  id: totrans-1438
  prefs: []
  type: TYPE_NORMAL
  zh: 你的 NSM 安装情况。错误、评论和火焰可以发送到
- en: SXL team at dev@securixlive.com
  id: totrans-1439
  prefs: []
  type: TYPE_NORMAL
  zh: SXL 团队联系方式：dev@securixlive.com
- en: The NSMnow Administration scripts come with ABSOLUTELY NO WARRANTY.
  id: totrans-1440
  prefs: []
  type: TYPE_NORMAL
  zh: NSMnow 管理脚本不提供任何形式的保证。
- en: 'Usage: /usr/sbin/nsm [options]'
  id: totrans-1441
  prefs: []
  type: TYPE_NORMAL
  zh: 使用：/usr/sbin/nsm [选项]
- en: 'Options:'
  id: totrans-1442
  prefs: []
  type: TYPE_NORMAL
  zh: 选项：
- en: -U Check and apply any available upgrades
  id: totrans-1443
  prefs: []
  type: TYPE_NORMAL
  zh: -U 检查并应用任何可用的升级
- en: -V Show version information
  id: totrans-1444
  prefs: []
  type: TYPE_NORMAL
  zh: -V 显示版本信息
- en: -? Show usage information
  id: totrans-1445
  prefs: []
  type: TYPE_NORMAL
  zh: -? 显示使用信息
- en: 'Long Options:'
  id: totrans-1446
  prefs: []
  type: TYPE_NORMAL
  zh: 长选项：
- en: --sensor See nsm_sensor
  id: totrans-1447
  prefs: []
  type: TYPE_NORMAL
  zh: --sensor 见 nsm_sensor
- en: --server See nsm_server
  id: totrans-1448
  prefs: []
  type: TYPE_NORMAL
  zh: --server 见 nsm_server
- en: --all Performs actions on both sensor and server
  id: totrans-1449
  prefs: []
  type: TYPE_NORMAL
  zh: --all 在传感器和服务器上执行操作
- en: --upgrade Same as -U
  id: totrans-1450
  prefs: []
  type: TYPE_NORMAL
  zh: --upgrade 与 -U 相同
- en: --version Same as -V
  id: totrans-1451
  prefs: []
  type: TYPE_NORMAL
  zh: --version 与 -V 相同
- en: --help Same as -?
  id: totrans-1452
  prefs: []
  type: TYPE_NORMAL
  zh: --help 与 -? 相同
- en: '**312** Appendix'
  id: totrans-1453
  prefs: []
  type: TYPE_NORMAL
  zh: '**312** 附录'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1454
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '***/usr/sbin/nsm***'
  id: totrans-1455
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm***'
- en: The high-level /usr/sbin/nsm script can pass options to some of the under-
  id: totrans-1456
  prefs: []
  type: TYPE_NORMAL
  zh: 高级的 /usr/sbin/nsm 脚本可以将选项传递给某些下级
- en: lying scripts such as nsm_server and nsm_sensor. To check the status of all
  id: totrans-1457
  prefs: []
  type: TYPE_NORMAL
  zh: 伪造脚本，如 nsm_server 和 nsm_sensor。要检查所有
- en: 'server and sensor processes, enter the following:'
  id: totrans-1458
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器和传感器进程，请输入以下命令：
- en: $ **sudo /usr/sbin/nsm --all --status**
  id: totrans-1459
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm --all --status**
- en: 'Status: securityonion'
  id: totrans-1460
  prefs: []
  type: TYPE_NORMAL
  zh: 状态：securityonion
- en: '* sguil server [ OK ]'
  id: totrans-1461
  prefs: []
  type: TYPE_NORMAL
  zh: '* sguil 服务器 [ OK ]'
- en: 'Status: HIDS'
  id: totrans-1462
  prefs: []
  type: TYPE_NORMAL
  zh: 状态：HIDS
- en: '* ossec_agent (sguil) [ OK ]'
  id: totrans-1463
  prefs: []
  type: TYPE_NORMAL
  zh: '* ossec_agent（sguil）[ OK ]'
- en: 'Status: Bro'
  id: totrans-1464
  prefs: []
  type: TYPE_NORMAL
  zh: 状态：Bro
- en: Name Type Host Status Pid Peers Started
  id: totrans-1465
  prefs: []
  type: TYPE_NORMAL
  zh: 名称 类型 主机 状态 进程 ID 同行 启动时间
- en: bro standalone localhost running 13015 0 18 Feb 16:35:40
  id: totrans-1466
  prefs: []
  type: TYPE_NORMAL
  zh: bro 独立 localhost 正在运行 13015 0 18 Feb 16:35:40
- en: 'Status: securityonion-eth1'
  id: totrans-1467
  prefs: []
  type: TYPE_NORMAL
  zh: 状态：securityonion-eth1
- en: '* netsniff-ng (full packet data) [ OK ]'
  id: totrans-1468
  prefs: []
  type: TYPE_NORMAL
  zh: '* netsniff-ng（完整数据包）[ OK ]'
- en: '* pcap_agent (sguil) [ OK ]'
  id: totrans-1469
  prefs: []
  type: TYPE_NORMAL
  zh: '* pcap_agent（sguil）[ OK ]'
- en: '* snort_agent-1 (sguil) [ OK ]'
  id: totrans-1470
  prefs: []
  type: TYPE_NORMAL
  zh: '* snort_agent-1（sguil）[ OK ]'
- en: '* snort-1 (alert data) [ OK ]'
  id: totrans-1471
  prefs: []
  type: TYPE_NORMAL
  zh: '* snort-1（警报数据）[ OK ]'
- en: '* barnyard2-1 (spooler, unified2 format) [ OK ]'
  id: totrans-1472
  prefs: []
  type: TYPE_NORMAL
  zh: '* barnyard2-1（spooler，统一2格式）[ OK ]'
- en: '* prads (sessions/assets) [ OK ]'
  id: totrans-1473
  prefs: []
  type: TYPE_NORMAL
  zh: '* prads（会话/资产）[ OK ]'
- en: '* sancp_agent (sguil) [ OK ]'
  id: totrans-1474
  prefs: []
  type: TYPE_NORMAL
  zh: '* sancp_agent（sguil）[ OK ]'
- en: '* pads_agent (sguil) [ OK ]'
  id: totrans-1475
  prefs: []
  type: TYPE_NORMAL
  zh: '* pads_agent（sguil）[ OK ]'
- en: '* argus [ OK ]'
  id: totrans-1476
  prefs: []
  type: TYPE_NORMAL
  zh: '* argus [ OK ]'
- en: '* http_agent (sguil) [ OK ]'
  id: totrans-1477
  prefs: []
  type: TYPE_NORMAL
  zh: '* http_agent（sguil）[ OK ]'
- en: '/etc/init.d/nsm is a wrapper for “/usr/sbin/nsm –all”, so you can also do:'
  id: totrans-1478
  prefs: []
  type: TYPE_NORMAL
  zh: /etc/init.d/nsm 是“/usr/sbin/nsm –all”的包装器，因此你也可以这样做：
- en: sudo service nsm status
  id: totrans-1479
  prefs: []
  type: TYPE_NORMAL
  zh: sudo service nsm status
- en: In addition to status, you can use other process control keywords, such
  id: totrans-1480
  prefs: []
  type: TYPE_NORMAL
  zh: 除了状态外，你还可以使用其他进程控制关键字，如
- en: as start, stop, and restart.
  id: totrans-1481
  prefs: []
  type: TYPE_NORMAL
  zh: 如启动、停止和重启。
- en: '***/usr/sbin/nsm_al _del***'
  id: totrans-1482
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_al _del***'
- en: The high-level /usr/sbin/nsm_all_del script will prompt for user confirmation,
  id: totrans-1483
  prefs: []
  type: TYPE_NORMAL
  zh: 高级脚本/usr/sbin/nsm_all_del将提示用户确认，
- en: and then call nsm_all_del_quick to delete all NSM data and configuration.
  id: totrans-1484
  prefs: []
  type: TYPE_NORMAL
  zh: 然后调用nsm_all_del_quick删除所有NSM数据和配置。
- en: $ **sudo /usr/sbin/nsm_all_del**
  id: totrans-1485
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm_all_del**
- en: WARNING!
  id: totrans-1486
  prefs: []
  type: TYPE_NORMAL
  zh: 警告！
- en: Continuing will permanently delete all NSM configuration and data!
  id: totrans-1487
  prefs: []
  type: TYPE_NORMAL
  zh: 继续将永久删除所有NSM配置和数据！
- en: Press Ctrl-C to cancel.
  id: totrans-1488
  prefs: []
  type: TYPE_NORMAL
  zh: 按Ctrl-C取消。
- en: OR
  id: totrans-1489
  prefs: []
  type: TYPE_NORMAL
  zh: 或
- en: Press Enter to continue.
  id: totrans-1490
  prefs: []
  type: TYPE_NORMAL
  zh: 按Enter继续。
- en: 'Stopping: securityonion'
  id: totrans-1491
  prefs: []
  type: TYPE_NORMAL
  zh: 停止：securityonion
- en: '* stopping: sguil server [ OK ]'
  id: totrans-1492
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：sguil服务器 [ OK ]'
- en: 'Stopping: HIDS'
  id: totrans-1493
  prefs: []
  type: TYPE_NORMAL
  zh: 停止：HIDS
- en: '* stopping: ossec_agent (sguil) [ OK ]'
  id: totrans-1494
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：ossec_agent (sguil) [ OK ]'
- en: 'Stopping: Bro'
  id: totrans-1495
  prefs: []
  type: TYPE_NORMAL
  zh: 停止：Bro
- en: stopping bro ...
  id: totrans-1496
  prefs: []
  type: TYPE_NORMAL
  zh: 停止bro ...
- en: SO Scripts and Configuration **313**
  id: totrans-1497
  prefs: []
  type: TYPE_NORMAL
  zh: SO脚本和配置 **313**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1498
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: 'Stopping: securityonion-eth1'
  id: totrans-1499
  prefs: []
  type: TYPE_NORMAL
  zh: 停止：securityonion-eth1
- en: '* stopping: netsniff-ng (full packet data) [ OK ]'
  id: totrans-1500
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：netsniff-ng (完整数据包) [ OK ]'
- en: '* stopping: pcap_agent (sguil) [ OK ]'
  id: totrans-1501
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：pcap_agent (sguil) [ OK ]'
- en: '* stopping: snort_agent-1 (sguil) [ OK ]'
  id: totrans-1502
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：snort_agent-1 (sguil) [ OK ]'
- en: '* stopping: snort-1 (alert data) [ OK ]'
  id: totrans-1503
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：snort-1 (警报数据) [ OK ]'
- en: '* stopping: barnyard2-1 (spooler, unified2 format) [ OK ]'
  id: totrans-1504
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：barnyard2-1 (排队器，unified2格式) [ OK ]'
- en: '* stopping: prads (sessions/assets) [ OK ]'
  id: totrans-1505
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：prads (会话/资产) [ OK ]'
- en: '* stopping: sancp_agent (sguil) [ OK ]'
  id: totrans-1506
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：sancp_agent (sguil) [ OK ]'
- en: '* stopping: pads_agent (sguil) [ OK ]'
  id: totrans-1507
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：pads_agent (sguil) [ OK ]'
- en: '* stopping: argus [ OK ]'
  id: totrans-1508
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：argus [ OK ]'
- en: '* stopping: http_agent (sguil) [ OK ]'
  id: totrans-1509
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：http_agent (sguil) [ OK ]'
- en: Delete Sensor
  id: totrans-1510
  prefs: []
  type: TYPE_NORMAL
  zh: 删除传感器
- en: All configurations and collected data for sensor "securityonion-eth1" will be
    deleted.
  id: totrans-1511
  prefs: []
  type: TYPE_NORMAL
  zh: 所有关于传感器“securityonion-eth1”的配置和收集的数据将被删除。
- en: 'Deleting sensor: securityonion-eth1'
  id: totrans-1512
  prefs: []
  type: TYPE_NORMAL
  zh: 删除传感器：securityonion-eth1
- en: '* removing configuration files [ OK ]'
  id: totrans-1513
  prefs: []
  type: TYPE_NORMAL
  zh: '* 移除配置文件 [ OK ]'
- en: '* removing collected data files [ OK ]'
  id: totrans-1514
  prefs: []
  type: TYPE_NORMAL
  zh: '* 移除收集的数据文件 [ OK ]'
- en: '* updating the sensor table [ OK ]'
  id: totrans-1515
  prefs: []
  type: TYPE_NORMAL
  zh: '* 更新传感器表 [ OK ]'
- en: Delete Server
  id: totrans-1516
  prefs: []
  type: TYPE_NORMAL
  zh: 删除服务器
- en: All configurations and collected data for server "securityonion" will be
  id: totrans-1517
  prefs: []
  type: TYPE_NORMAL
  zh: 所有关于服务器“securityonion”的配置和收集的数据将被
- en: deleted.
  id: totrans-1518
  prefs: []
  type: TYPE_NORMAL
  zh: 已删除。
- en: 'Deleting server:ontinue? (Y/N) [N]:'
  id: totrans-1519
  prefs: []
  type: TYPE_NORMAL
  zh: '删除服务器：继续吗？ (Y/N) [N]:'
- en: '* removing configuration files [ OK ]'
  id: totrans-1520
  prefs: []
  type: TYPE_NORMAL
  zh: '* 移除配置文件 [ OK ]'
- en: '* removing collected data files [ OK ]'
  id: totrans-1521
  prefs: []
  type: TYPE_NORMAL
  zh: '* 移除收集的数据文件 [ OK ]'
- en: '* removing database [ OK ]'
  id: totrans-1522
  prefs: []
  type: TYPE_NORMAL
  zh: '* 移除数据库 [ OK ]'
- en: '* updating the server table [ OK ]'
  id: totrans-1523
  prefs: []
  type: TYPE_NORMAL
  zh: '* 更新服务器表 [ OK ]'
- en: '***/usr/sbin/nsm_al _del_quick***'
  id: totrans-1524
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_al _del_quick***'
- en: The high-level /usr/sbin/nsm_all_del_quick script will call nsm_sensor_del and
  id: totrans-1525
  prefs: []
  type: TYPE_NORMAL
  zh: 高级脚本/usr/sbin/nsm_all_del_quick将调用nsm_sensor_del并
- en: nsm_server_del to delete all NSM data and configuration, but will *not* prompt
  id: totrans-1526
  prefs: []
  type: TYPE_NORMAL
  zh: nsm_server_del用于删除所有NSM数据和配置，但*不会*提示
- en: for user confirmation. Be careful with this one!
  id: totrans-1527
  prefs: []
  type: TYPE_NORMAL
  zh: 需要用户确认。请小心使用！
- en: $ **sudo nsm_all_del_quick**
  id: totrans-1528
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo nsm_all_del_quick**
- en: 'Stopping: securityonion'
  id: totrans-1529
  prefs: []
  type: TYPE_NORMAL
  zh: 停止：securityonion
- en: '* stopping: sguil server [ OK ]'
  id: totrans-1530
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：sguil服务器 [ OK ]'
- en: 'Stopping: HIDS'
  id: totrans-1531
  prefs: []
  type: TYPE_NORMAL
  zh: 停止：HIDS
- en: '* stopping: ossec_agent (sguil) [ OK ]'
  id: totrans-1532
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：ossec_agent (sguil) [ OK ]'
- en: 'Stopping: Bro'
  id: totrans-1533
  prefs: []
  type: TYPE_NORMAL
  zh: 停止：Bro
- en: stopping bro ...
  id: totrans-1534
  prefs: []
  type: TYPE_NORMAL
  zh: 停止bro ...
- en: 'Stopping: securityonion-eth1'
  id: totrans-1535
  prefs: []
  type: TYPE_NORMAL
  zh: 停止：securityonion-eth1
- en: '* stopping: netsniff-ng (full packet data) [ OK ]'
  id: totrans-1536
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：netsniff-ng (完整数据包) [ OK ]'
- en: '* stopping: pcap_agent (sguil) [ OK ]'
  id: totrans-1537
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：pcap_agent (sguil) [ OK ]'
- en: '* stopping: snort_agent-1 (sguil) [ OK ]'
  id: totrans-1538
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：snort_agent-1 (sguil) [ OK ]'
- en: '* stopping: snort-1 (alert data) [ OK ]'
  id: totrans-1539
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：snort-1 (警报数据) [ OK ]'
- en: '**314** Appendix'
  id: totrans-1540
  prefs: []
  type: TYPE_NORMAL
  zh: '**314** 附录'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1541
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '* stopping: barnyard2-1 (spooler, unified2 format) [ OK ]'
  id: totrans-1542
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：barnyard2-1 (排队器，unified2格式) [ OK ]'
- en: '* stopping: prads (sessions/assets) [ OK ]'
  id: totrans-1543
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：prads (会话/资产) [ OK ]'
- en: '* stopping: sancp_agent (sguil) [ OK ]'
  id: totrans-1544
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：sancp_agent (sguil) [ OK ]'
- en: '* stopping: pads_agent (sguil) [ OK ]'
  id: totrans-1545
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：pads_agent (sguil) [ OK ]'
- en: '* stopping: argus [ OK ]'
  id: totrans-1546
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：argus [ OK ]'
- en: '* stopping: http_agent (sguil) [ OK ]'
  id: totrans-1547
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：http_agent (sguil) [ OK ]'
- en: Delete Sensor
  id: totrans-1548
  prefs: []
  type: TYPE_NORMAL
  zh: 删除传感器
- en: All configurations and collected data for sensor "securityonion-eth1" will be
    deleted.
  id: totrans-1549
  prefs: []
  type: TYPE_NORMAL
  zh: 所有关于传感器“securityonion-eth1”的配置和收集的数据将被删除。
- en: 'Deleting sensor: securityonion-eth1'
  id: totrans-1550
  prefs: []
  type: TYPE_NORMAL
  zh: 删除传感器：securityonion-eth1
- en: '* removing configuration files [ OK ]'
  id: totrans-1551
  prefs: []
  type: TYPE_NORMAL
  zh: '* 移除配置文件 [ OK ]'
- en: '* removing collected data files [ OK ]'
  id: totrans-1552
  prefs: []
  type: TYPE_NORMAL
  zh: '* 移除收集的数据文件 [ OK ]'
- en: '* updating the sensor table [ OK ]'
  id: totrans-1553
  prefs: []
  type: TYPE_NORMAL
  zh: '* 更新传感器表 [ OK ]'
- en: Delete Server
  id: totrans-1554
  prefs: []
  type: TYPE_NORMAL
  zh: 删除服务器
- en: All configurations and collected data for server "securityonion" will be
  id: totrans-1555
  prefs: []
  type: TYPE_NORMAL
  zh: 所有关于服务器“securityonion”的配置和收集的数据将被
- en: deleted.
  id: totrans-1556
  prefs: []
  type: TYPE_NORMAL
  zh: 已删除。
- en: 'Deleting server:ontinue? (Y/N) [N]:'
  id: totrans-1557
  prefs: []
  type: TYPE_NORMAL
  zh: '删除服务器：继续吗？ (Y/N) [N]:'
- en: '* removing configuration files [ OK ]'
  id: totrans-1558
  prefs: []
  type: TYPE_NORMAL
  zh: '* 移除配置文件 [ OK ]'
- en: '* removing collected data files [ OK ]'
  id: totrans-1559
  prefs: []
  type: TYPE_NORMAL
  zh: '* 移除收集的数据文件 [ OK ]'
- en: '* removing database [ OK ]'
  id: totrans-1560
  prefs: []
  type: TYPE_NORMAL
  zh: '* 移除数据库 [ OK ]'
- en: '* updating the server table [ OK ]'
  id: totrans-1561
  prefs: []
  type: TYPE_NORMAL
  zh: '* 更新服务器表 [ OK ]'
- en: '***/usr/sbin/nsm_sensor***'
  id: totrans-1562
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_sensor***'
- en: The high-level /usr/sbin/nsm_sensor script can pass options to some of the
  id: totrans-1563
  prefs: []
  type: TYPE_NORMAL
  zh: 高级 /usr/sbin/nsm_sensor 脚本可以将选项传递给一些
- en: underlying nsm_sensor_* scripts.
  id: totrans-1564
  prefs: []
  type: TYPE_NORMAL
  zh: 基础的 nsm_sensor_* 脚本。
- en: $ **sudo /usr/sbin/nsm_sensor --status**
  id: totrans-1565
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm_sensor --status**
- en: 'Status: HIDS'
  id: totrans-1566
  prefs: []
  type: TYPE_NORMAL
  zh: '状态: HIDS'
- en: '* ossec_agent (sguil) [ OK ]'
  id: totrans-1567
  prefs: []
  type: TYPE_NORMAL
  zh: '* ossec_agent (sguil) [ OK ]'
- en: 'Status: Bro'
  id: totrans-1568
  prefs: []
  type: TYPE_NORMAL
  zh: '状态: Bro'
- en: Name Type Host Status Pid Peers Started
  id: totrans-1569
  prefs: []
  type: TYPE_NORMAL
  zh: 名称 类型 主机 状态 Pid 同伴 启动时间
- en: bro standalone localhost running 13015 0 18 Feb 16:35:40
  id: totrans-1570
  prefs: []
  type: TYPE_NORMAL
  zh: bro 独立 localhost 运行 13015 0 18 2月 16:35:40
- en: 'Status: securityonion-eth1'
  id: totrans-1571
  prefs: []
  type: TYPE_NORMAL
  zh: '状态: securityonion-eth1'
- en: '* netsniff-ng (full packet data) [ OK ]'
  id: totrans-1572
  prefs: []
  type: TYPE_NORMAL
  zh: '* netsniff-ng (完整数据包数据) [ OK ]'
- en: '* pcap_agent (sguil) [ OK ]'
  id: totrans-1573
  prefs: []
  type: TYPE_NORMAL
  zh: '* pcap_agent (sguil) [ OK ]'
- en: '* snort_agent-1 (sguil) [ OK ]'
  id: totrans-1574
  prefs: []
  type: TYPE_NORMAL
  zh: '* snort_agent-1 (sguil) [ OK ]'
- en: '* snort-1 (alert data) [ OK ]'
  id: totrans-1575
  prefs: []
  type: TYPE_NORMAL
  zh: '* snort-1 (警报数据) [ OK ]'
- en: '* barnyard2-1 (spooler, unified2 format) [ OK ]'
  id: totrans-1576
  prefs: []
  type: TYPE_NORMAL
  zh: '* barnyard2-1 (spooler, unified2 格式) [ OK ]'
- en: '* prads (sessions/assets) [ OK ]'
  id: totrans-1577
  prefs: []
  type: TYPE_NORMAL
  zh: '* prads (会话/资产) [ OK ]'
- en: '* sancp_agent (sguil) [ OK ]'
  id: totrans-1578
  prefs: []
  type: TYPE_NORMAL
  zh: '* sancp_agent (sguil) [ OK ]'
- en: '* pads_agent (sguil) [ OK ]'
  id: totrans-1579
  prefs: []
  type: TYPE_NORMAL
  zh: '* pads_agent (sguil) [ OK ]'
- en: '* argus [ OK ]'
  id: totrans-1580
  prefs: []
  type: TYPE_NORMAL
  zh: '* argus [ OK ]'
- en: '* http_agent (sguil) [ OK ]'
  id: totrans-1581
  prefs: []
  type: TYPE_NORMAL
  zh: '* http_agent (sguil) [ OK ]'
- en: SO Scripts and Configuration **315**
  id: totrans-1582
  prefs: []
  type: TYPE_NORMAL
  zh: SO 脚本和配置 **315**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1583
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '***/usr/sbin/nsm_sensor_add***'
  id: totrans-1584
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_sensor_add***'
- en: The /usr/sbin/nsm_sensor_add script is called by the setup wizard to add a new
  id: totrans-1585
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_sensor_add 脚本由设置向导调用，以添加新的
- en: sensor. You shouldn’t need to run this script manually.
  id: totrans-1586
  prefs: []
  type: TYPE_NORMAL
  zh: 传感器。你不需要手动运行此脚本。
- en: '***/usr/sbin/nsm_sensor_backup-config***'
  id: totrans-1587
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_sensor_backup-config***'
- en: The /usr/sbin/nsm_sensor_backup-config script will back up sensor configura-
  id: totrans-1588
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_sensor_backup-config 脚本将备份传感器配置-
- en: tion files to a user-specified tarball.
  id: totrans-1589
  prefs: []
  type: TYPE_NORMAL
  zh: 将文件归档为用户指定的 tarball。
- en: '***/usr/sbin/nsm_sensor_backup-data***'
  id: totrans-1590
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_sensor_backup-data***'
- en: The /usr/sbin/nsm_sensor_backup-data script will back up sensor datafiles to
    a
  id: totrans-1591
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_sensor_backup-data 脚本将备份传感器数据文件到一个
- en: user-specified tarball. Keep in mind that datafiles consist of full packet cap-
  id: totrans-1592
  prefs: []
  type: TYPE_NORMAL
  zh: 用户指定的 tarball。请注意，数据文件包括完整的数据包捕获，
- en: ture and could be many gigabytes or terabytes.
  id: totrans-1593
  prefs: []
  type: TYPE_NORMAL
  zh: 真正的大小可能达到数十GB或TB。
- en: '***/usr/sbin/nsm_sensor_clean***'
  id: totrans-1594
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_sensor_clean***'
- en: The /usr/sbin/nsm_sensor_clean script is called by an hourly cronjob. If disk
  id: totrans-1595
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_sensor_clean 脚本由每小时的 cronjob 调用。如果磁盘
- en: usage is at 90 percent or higher, the oldest day’s worth of NSM data (pcaps,
  id: totrans-1596
  prefs: []
  type: TYPE_NORMAL
  zh: 使用率达到 90% 或更高，最旧一天的 NSM 数据（pcaps，
- en: Bro logs, and so on) will be deleted until disk usage is below 90 percent. The
  id: totrans-1597
  prefs: []
  type: TYPE_NORMAL
  zh: Bro 日志等) 将被删除，直到磁盘使用率低于 90%。如果磁盘
- en: process is repeated until disk usage falls below 90 percent.
  id: totrans-1598
  prefs: []
  type: TYPE_NORMAL
  zh: 该过程将重复，直到磁盘使用率低于 90%。
- en: '***/usr/sbin/nsm_sensor_clear***'
  id: totrans-1599
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_sensor_clear***'
- en: The /usr/sbin/nsm_sensor_clear script clears all data from a sensor.
  id: totrans-1600
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_sensor_clear 脚本清除传感器的所有数据。
- en: $ **sudo /usr/sbin/nsm_sensor_clear --sensor-name=securityonion-eth1**
  id: totrans-1601
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm_sensor_clear --sensor-name=securityonion-eth1**
- en: Clear Sensor
  id: totrans-1602
  prefs: []
  type: TYPE_NORMAL
  zh: 清除传感器
- en: All collected data for sensor "securityonion-eth1" will be cleared.
  id: totrans-1603
  prefs: []
  type: TYPE_NORMAL
  zh: 所有传感器 "securityonion-eth1" 收集的数据将被清除。
- en: 'Do you want to continue? (Y/N) [N]: **y**'
  id: totrans-1604
  prefs: []
  type: TYPE_NORMAL
  zh: '您要继续吗？(Y/N) [N]: **y**'
- en: 'Clearing sensor: securityonion-eth1'
  id: totrans-1605
  prefs: []
  type: TYPE_NORMAL
  zh: '清除传感器: securityonion-eth1'
- en: '* removing bookmarks [ OK ]'
  id: totrans-1606
  prefs: []
  type: TYPE_NORMAL
  zh: '* 删除书签 [ OK ]'
- en: '* removing collected data files [ OK ]'
  id: totrans-1607
  prefs: []
  type: TYPE_NORMAL
  zh: '* 删除收集的数据文件 [ OK ]'
- en: '* removing collected log directories [ OK ]'
  id: totrans-1608
  prefs: []
  type: TYPE_NORMAL
  zh: '* 删除收集的日志目录 [ OK ]'
- en: '***/usr/sbin/nsm_sensor_del***'
  id: totrans-1609
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_sensor_del***'
- en: The /usr/sbin/nsm_sensor_del script removes all data and configuration for a
  id: totrans-1610
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_sensor_del 脚本会删除传感器的所有数据和配置。
- en: user-specified sensor, permanently disabling it.
  id: totrans-1611
  prefs: []
  type: TYPE_NORMAL
  zh: 用户指定的传感器，永久禁用它。
- en: $ **sudo /usr/sbin/nsm_sensor_del --sensor-name=securityonion-eth1**
  id: totrans-1612
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm_sensor_del --sensor-name=securityonion-eth1**
- en: Delete Sensor
  id: totrans-1613
  prefs: []
  type: TYPE_NORMAL
  zh: 删除传感器
- en: All configurations and collected data for sensor "securityonion-eth1" will be
    deleted.
  id: totrans-1614
  prefs: []
  type: TYPE_NORMAL
  zh: 所有配置和传感器 "securityonion-eth1" 收集的数据将被删除。
- en: 'Do you want to continue? (Y/N) [N]: **y**'
  id: totrans-1615
  prefs: []
  type: TYPE_NORMAL
  zh: '您要继续吗？(Y/N) [N]: **y**'
- en: '**316** Appendix'
  id: totrans-1616
  prefs: []
  type: TYPE_NORMAL
  zh: '**316** 附录'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1617
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: 'Deleting sensor: securityonion-eth1'
  id: totrans-1618
  prefs: []
  type: TYPE_NORMAL
  zh: '删除传感器: securityonion-eth1'
- en: '* removing configuration files [ OK ]'
  id: totrans-1619
  prefs: []
  type: TYPE_NORMAL
  zh: '* 删除配置文件 [ OK ]'
- en: '* removing collected data files [ OK ]'
  id: totrans-1620
  prefs: []
  type: TYPE_NORMAL
  zh: '* 删除收集的数据文件 [ OK ]'
- en: '* updating the sensor table [ OK ]'
  id: totrans-1621
  prefs: []
  type: TYPE_NORMAL
  zh: '* 更新传感器表 [ OK ]'
- en: '***/usr/sbin/nsm_sensor_edit***'
  id: totrans-1622
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_sensor_edit***'
- en: The /usr/sbin/nsm_sensor_edit script allows you to edit certain details of a
  id: totrans-1623
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_sensor_edit 脚本允许您编辑传感器的某些细节。
- en: sensor’s configuration.
  id: totrans-1624
  prefs: []
  type: TYPE_NORMAL
  zh: 传感器的配置。
- en: '***/usr/sbin/nsm_sensor_ps-daily-restart***'
  id: totrans-1625
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_sensor_ps-daily-restart***'
- en: The /usr/sbin/nsm_sensor_ps-daily-restart script is called by a daily cronjob
    at
  id: totrans-1626
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_sensor_ps-daily-restart 脚本由每天的 cronjob 调用，
- en: midnight to restart any services that may be dealing with date-based output
  id: totrans-1627
  prefs: []
  type: TYPE_NORMAL
  zh: 午夜时分重新启动任何可能处理基于日期输出的服务
- en: and need to roll to a new date stamp.
  id: totrans-1628
  prefs: []
  type: TYPE_NORMAL
  zh: 并且需要滚动到新的日期戳。
- en: '***/usr/sbin/nsm_sensor_ps-restart***'
  id: totrans-1629
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_sensor_ps-restart***'
- en: The /usr/sbin/nsm_sensor_ps-restart script is used to restart sensor processes.
  id: totrans-1630
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_sensor_ps-restart 脚本用于重启传感器进程。
- en: $ **sudo /usr/sbin/nsm_sensor_ps-restart**
  id: totrans-1631
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm_sensor_ps-restart**
- en: 'Restarting: HIDS'
  id: totrans-1632
  prefs: []
  type: TYPE_NORMAL
  zh: '正在重启: HIDS'
- en: '* stopping: ossec_agent (sguil) [ OK ]'
  id: totrans-1633
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中: ossec_agent (sguil) [ OK ]'
- en: '* starting: ossec_agent (sguil) [ OK ]'
  id: totrans-1634
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中: ossec_agent (sguil) [ OK ]'
- en: 'Restarting: Bro'
  id: totrans-1635
  prefs: []
  type: TYPE_NORMAL
  zh: '正在重启: Bro'
- en: stopping bro ...
  id: totrans-1636
  prefs: []
  type: TYPE_NORMAL
  zh: 停止 bro ...
- en: starting bro ...
  id: totrans-1637
  prefs: []
  type: TYPE_NORMAL
  zh: 启动 bro ...
- en: 'Restarting: securityonion-eth1'
  id: totrans-1638
  prefs: []
  type: TYPE_NORMAL
  zh: '正在重启: securityonion-eth1'
- en: '* restarting with overlap: netsniff-ng (full packet data)'
  id: totrans-1639
  prefs: []
  type: TYPE_NORMAL
  zh: '* 正在重启并有重叠: netsniff-ng (完整数据包数据)'
- en: '* starting: netsniff-ng (full packet data) [ OK ]'
  id: totrans-1640
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中: netsniff-ng (完整数据包数据) [ OK ]'
- en: '- stopping old process: netsniff-ng (full packet data) [ OK ]'
  id: totrans-1641
  prefs: []
  type: TYPE_NORMAL
  zh: '- 停止旧进程: netsniff-ng (完整数据包数据) [ OK ]'
- en: '* stopping: pcap_agent (sguil) [ OK ]'
  id: totrans-1642
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中: pcap_agent (sguil) [ OK ]'
- en: '* starting: pcap_agent (sguil) [ OK ]'
  id: totrans-1643
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中: pcap_agent (sguil) [ OK ]'
- en: '* stopping: snort_agent-1 (sguil) [ OK ]'
  id: totrans-1644
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中: snort_agent-1 (sguil) [ OK ]'
- en: '* starting: snort_agent-1 (sguil) [ OK ]'
  id: totrans-1645
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中: snort_agent-1 (sguil) [ OK ]'
- en: '* stopping: snort-1 (alert data) [ OK ]'
  id: totrans-1646
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中: snort-1 (警报数据) [ OK ]'
- en: '* starting: snort-1 (alert data) [ OK ]'
  id: totrans-1647
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中: snort-1 (警报数据) [ OK ]'
- en: '* stopping: barnyard2-1 (spooler, unified2 format) [ OK ]'
  id: totrans-1648
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中: barnyard2-1 (spooler, unified2 格式) [ OK ]'
- en: '* starting: barnyard2-1 (spooler, unified2 format) [ OK ]'
  id: totrans-1649
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中: barnyard2-1 (spooler, unified2 格式) [ OK ]'
- en: '* stopping: prads (sessions/assets) [ OK ]'
  id: totrans-1650
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中: prads (会话/资产) [ OK ]'
- en: '* starting: prads (sessions/assets) [ OK ]'
  id: totrans-1651
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中: prads (会话/资产) [ OK ]'
- en: '* stopping: pads_agent (sguil) [ OK ]'
  id: totrans-1652
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中: pads_agent (sguil) [ OK ]'
- en: '* starting: pads_agent (sguil) [ OK ]'
  id: totrans-1653
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中: pads_agent (sguil) [ OK ]'
- en: '* stopping: sancp_agent (sguil) [ OK ]'
  id: totrans-1654
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中: sancp_agent (sguil) [ OK ]'
- en: '* starting: sancp_agent (sguil) [ OK ]'
  id: totrans-1655
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中: sancp_agent (sguil) [ OK ]'
- en: '* stopping: argus [ OK ]'
  id: totrans-1656
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中: argus [ OK ]'
- en: '* starting: argus [ OK ]'
  id: totrans-1657
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中: argus [ OK ]'
- en: '* stopping: http_agent (sguil) [ OK ]'
  id: totrans-1658
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中: http_agent (sguil) [ OK ]'
- en: '* starting: http_agent (sguil) [ OK ]'
  id: totrans-1659
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中: http_agent (sguil) [ OK ]'
- en: SO Scripts and Configuration **317**
  id: totrans-1660
  prefs: []
  type: TYPE_NORMAL
  zh: SO 脚本和配置 **317**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1661
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: Note that this and the remaining nsm_sensor_ps-* scripts allow you to be very
    granular in what sensors or processes you control. For example, notice
  id: totrans-1662
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，这些以及其余的 nsm_sensor_ps-* 脚本可以非常精细地控制你所管理的传感器或进程。例如，请注意
- en: 'the --only-, --skip-, and --sensor-name= options in the following --help listing:'
  id: totrans-1663
  prefs: []
  type: TYPE_NORMAL
  zh: '以下 --help 列表中的 --only-、--skip- 和 --sensor-name= 选项:'
- en: $ **sudo /usr/sbin/nsm_sensor_ps-restart --help**
  id: totrans-1664
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm_sensor_ps-restart --help**
- en: The NSMnow Administration scripts come with ABSOLUTELY NO WARRANTY.
  id: totrans-1665
  prefs: []
  type: TYPE_NORMAL
  zh: NSMnow 管理脚本没有任何保证。
- en: 'Usage: /usr/sbin/nsm_sensor_ps-restart [options]'
  id: totrans-1666
  prefs: []
  type: TYPE_NORMAL
  zh: '用法: /usr/sbin/nsm_sensor_ps-restart [选项]'
- en: 'Options:'
  id: totrans-1667
  prefs: []
  type: TYPE_NORMAL
  zh: '选项:'
- en: -d Use dialog mode
  id: totrans-1668
  prefs: []
  type: TYPE_NORMAL
  zh: -d 使用对话框模式
- en: -y Force yes
  id: totrans-1669
  prefs: []
  type: TYPE_NORMAL
  zh: -y 强制是
- en: -V Show version information
  id: totrans-1670
  prefs: []
  type: TYPE_NORMAL
  zh: -V 显示版本信息
- en: -? Show usage information
  id: totrans-1671
  prefs: []
  type: TYPE_NORMAL
  zh: -? 显示用法信息
- en: 'Long Options:'
  id: totrans-1672
  prefs: []
  type: TYPE_NORMAL
  zh: '长选项:'
- en: --sensor-name=<name> Define specific sensor <name> to process
  id: totrans-1673
  prefs: []
  type: TYPE_NORMAL
  zh: --sensor-name=<name> 定义要处理的特定传感器 <name>
- en: --only-barnyard2 Only process barnyard2
  id: totrans-1674
  prefs: []
  type: TYPE_NORMAL
  zh: --only-barnyard2 仅处理 barnyard2
- en: --only-snort-alert Only process snort alert
  id: totrans-1675
  prefs: []
  type: TYPE_NORMAL
  zh: --only-snort-alert 仅处理 snort 警报
- en: --only-pcap Only process packet logger
  id: totrans-1676
  prefs: []
  type: TYPE_NORMAL
  zh: --only-pcap 仅处理数据包日志
- en: --only-argus Only process argus
  id: totrans-1677
  prefs: []
  type: TYPE_NORMAL
  zh: --only-argus 仅处理 argus
- en: --only-prads Only process prads
  id: totrans-1678
  prefs: []
  type: TYPE_NORMAL
  zh: --only-prads 仅处理 prads
- en: --only-bro Only process bro
  id: totrans-1679
  prefs: []
  type: TYPE_NORMAL
  zh: --only-bro 仅处理 bro
- en: --only-pcap-agent Only process pcap_agent
  id: totrans-1680
  prefs: []
  type: TYPE_NORMAL
  zh: --only-pcap-agent 仅处理 pcap_agent
- en: --only-sancp-agent Only process sancp_agent
  id: totrans-1681
  prefs: []
  type: TYPE_NORMAL
  zh: --only-sancp-agent 仅处理 sancp_agent
- en: --only-snort-agent Only process snort_agent
  id: totrans-1682
  prefs: []
  type: TYPE_NORMAL
  zh: --only-snort-agent 仅处理 snort_agent
- en: --only-http-agent Only process http_agent
  id: totrans-1683
  prefs: []
  type: TYPE_NORMAL
  zh: --only-http-agent 仅处理 http_agent
- en: --only-pads-agent Only process pads_agent
  id: totrans-1684
  prefs: []
  type: TYPE_NORMAL
  zh: --only-pads-agent 仅处理 pads_agent
- en: --only-ossec-agent Only process ossec_agent
  id: totrans-1685
  prefs: []
  type: TYPE_NORMAL
  zh: --only-ossec-agent 仅处理 ossec_agent
- en: --skip-barnyard2 Skip processing of barnyard2
  id: totrans-1686
  prefs: []
  type: TYPE_NORMAL
  zh: --skip-barnyard2 跳过 barnyard2 的处理
- en: --skip-snort-alert Skip processing of snort alert
  id: totrans-1687
  prefs: []
  type: TYPE_NORMAL
  zh: --skip-snort-alert 跳过 snort 警报的处理
- en: --skip-pcap Skip processing of packet logger
  id: totrans-1688
  prefs: []
  type: TYPE_NORMAL
  zh: --skip-pcap 跳过数据包日志的处理
- en: --skip-argus Skip processing of argus
  id: totrans-1689
  prefs: []
  type: TYPE_NORMAL
  zh: --skip-argus 跳过 argus 的处理
- en: --skip-prads Skip processing of prads
  id: totrans-1690
  prefs: []
  type: TYPE_NORMAL
  zh: --skip-prads 跳过 prads 的处理
- en: --skip-bro Skip processing of bro
  id: totrans-1691
  prefs: []
  type: TYPE_NORMAL
  zh: --skip-bro 跳过 bro 的处理
- en: --skip-pcap-agent Skip processing of pcap_agent
  id: totrans-1692
  prefs: []
  type: TYPE_NORMAL
  zh: --skip-pcap-agent 跳过 pcap_agent 的处理
- en: --skip-sancp-agent Skip processing of sancp_agent
  id: totrans-1693
  prefs: []
  type: TYPE_NORMAL
  zh: --skip-sancp-agent 跳过 sancp_agent 的处理
- en: --skip-snort-agent Skip processing of snort_agent
  id: totrans-1694
  prefs: []
  type: TYPE_NORMAL
  zh: --skip-snort-agent 跳过 snort_agent 的处理
- en: --skip-http-agent Skip processing of http_agent
  id: totrans-1695
  prefs: []
  type: TYPE_NORMAL
  zh: --skip-http-agent 跳过 http_agent 的处理
- en: --skip-pads-agent Skip processing of pads_agent
  id: totrans-1696
  prefs: []
  type: TYPE_NORMAL
  zh: --skip-pads-agent 跳过 pads_agent 的处理
- en: --skip-ossec-agent Skip processing of ossec_agent
  id: totrans-1697
  prefs: []
  type: TYPE_NORMAL
  zh: --skip-ossec-agent 跳过 ossec_agent 的处理
- en: --if-stale Only restart processes that have crashed
  id: totrans-1698
  prefs: []
  type: TYPE_NORMAL
  zh: --if-stale 仅重启已崩溃的进程
- en: --dialog Same as -d
  id: totrans-1699
  prefs: []
  type: TYPE_NORMAL
  zh: --dialog 同 -d
- en: --force-yes Same as -y
  id: totrans-1700
  prefs: []
  type: TYPE_NORMAL
  zh: --force-yes 同 -y
- en: --version Same as -V
  id: totrans-1701
  prefs: []
  type: TYPE_NORMAL
  zh: --version 同 -V
- en: --help Same as -?
  id: totrans-1702
  prefs: []
  type: TYPE_NORMAL
  zh: --help 同 -?
- en: '**318** Appendix'
  id: totrans-1703
  prefs: []
  type: TYPE_NORMAL
  zh: '**318** 附录'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1704
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: 'For example, suppose you’ve just made changes to *snort.conf*, and you want
    to restart Snort to make those changes take effect. Instead of restarting the
    entire stack, you could restart just the Snort process, as follows:'
  id: totrans-1705
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，假设你刚刚更改了 *snort.conf* 文件，并且想要重启 Snort 以使这些更改生效。你可以仅重启 Snort 进程，而不需要重启整个堆栈，如下所示：
- en: $ **sudo /usr/sbin/nsm_sensor_ps-restart --only-snort-alert**
  id: totrans-1706
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm_sensor_ps-restart --only-snort-alert**
- en: 'Restarting: securityonion-eth1'
  id: totrans-1707
  prefs: []
  type: TYPE_NORMAL
  zh: 重启中：securityonion-eth1
- en: '* stopping: snort-1 (alert data) [ OK ]'
  id: totrans-1708
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：snort-1 (警报数据) [ OK ]'
- en: '* starting: snort-1 (alert data) [ OK ]'
  id: totrans-1709
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：snort-1 (警报数据) [ OK ]'
- en: '***/usr/sbin/nsm_sensor_ps-start***'
  id: totrans-1710
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_sensor_ps-start***'
- en: The /usr/sbin/nsm_sensor_ps-start script is used to start sensor processes.
  id: totrans-1711
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_sensor_ps-start 脚本用于启动传感器进程。
- en: $ **sudo /usr/sbin/nsm_sensor_ps-start**
  id: totrans-1712
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm_sensor_ps-start**
- en: 'Starting: HIDS'
  id: totrans-1713
  prefs: []
  type: TYPE_NORMAL
  zh: 启动中：HIDS
- en: '* starting: ossec_agent (sguil) [ OK ]'
  id: totrans-1714
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：ossec_agent (sguil) [ OK ]'
- en: 'Starting: Bro'
  id: totrans-1715
  prefs: []
  type: TYPE_NORMAL
  zh: 启动中：Bro
- en: starting bro ...
  id: totrans-1716
  prefs: []
  type: TYPE_NORMAL
  zh: 启动 bro ...
- en: 'Starting: securityonion-eth1'
  id: totrans-1717
  prefs: []
  type: TYPE_NORMAL
  zh: 启动中：securityonion-eth1
- en: '* starting: netsniff-ng (full packet data) [ OK ]'
  id: totrans-1718
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：netsniff-ng (完整数据包数据) [ OK ]'
- en: '* starting: pcap_agent (sguil) [ OK ]'
  id: totrans-1719
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：pcap_agent (sguil) [ OK ]'
- en: '* starting: snort_agent-1 (sguil) [ OK ]'
  id: totrans-1720
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：snort_agent-1 (sguil) [ OK ]'
- en: '* starting: snort-1 (alert data) [ OK ]'
  id: totrans-1721
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：snort-1 (警报数据) [ OK ]'
- en: '* starting: barnyard2-1 (spooler, unified2 format) [ OK ]'
  id: totrans-1722
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：barnyard2-1 (spooler, unified2 格式) [ OK ]'
- en: '* starting: prads (sessions/assets) [ OK ]'
  id: totrans-1723
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：prads (会话/资产) [ OK ]'
- en: '* starting: pads_agent (sguil) [ OK ]'
  id: totrans-1724
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：pads_agent (sguil) [ OK ]'
- en: '* starting: sancp_agent (sguil) [ OK ]'
  id: totrans-1725
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：sancp_agent (sguil) [ OK ]'
- en: '* starting: argus [ OK ]'
  id: totrans-1726
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：argus [ OK ]'
- en: '* starting: http_agent (sguil) [ OK ]'
  id: totrans-1727
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：http_agent (sguil) [ OK ]'
- en: '* disk space currently at 26%'
  id: totrans-1728
  prefs: []
  type: TYPE_NORMAL
  zh: '* 磁盘空间当前为 26%'
- en: '***/usr/sbin/nsm_sensor_ps-status***'
  id: totrans-1729
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_sensor_ps-status***'
- en: The /usr/sbin/nsm_sensor_ps-status script is used to check the status of sensor
  id: totrans-1730
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_sensor_ps-status 脚本用于检查传感器的状态。
- en: processes.
  id: totrans-1731
  prefs: []
  type: TYPE_NORMAL
  zh: 进程。
- en: $ **sudo /usr/sbin/nsm_sensor_ps-status**
  id: totrans-1732
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm_sensor_ps-status**
- en: 'Status: HIDS'
  id: totrans-1733
  prefs: []
  type: TYPE_NORMAL
  zh: 状态：HIDS
- en: '* ossec_agent (sguil) [ OK ]'
  id: totrans-1734
  prefs: []
  type: TYPE_NORMAL
  zh: '* ossec_agent (sguil) [ OK ]'
- en: 'Status: Bro'
  id: totrans-1735
  prefs: []
  type: TYPE_NORMAL
  zh: 状态：Bro
- en: Name Type Host Status Pid Peers Started
  id: totrans-1736
  prefs: []
  type: TYPE_NORMAL
  zh: 名称 类型 主机 状态 进程ID 对等方 启动时间
- en: bro standalone localhost running 15426 0 18 Feb 16:40:23
  id: totrans-1737
  prefs: []
  type: TYPE_NORMAL
  zh: bro 独立运行的本地主机，端口号 15426，0，18 Feb 16:40:23
- en: 'Status: securityonion-eth1'
  id: totrans-1738
  prefs: []
  type: TYPE_NORMAL
  zh: 状态：securityonion-eth1
- en: '* netsniff-ng (full packet data) [ OK ]'
  id: totrans-1739
  prefs: []
  type: TYPE_NORMAL
  zh: '* netsniff-ng (完整数据包数据) [ OK ]'
- en: '* pcap_agent (sguil) [ OK ]'
  id: totrans-1740
  prefs: []
  type: TYPE_NORMAL
  zh: '* pcap_agent (sguil) [ OK ]'
- en: '* snort_agent-1 (sguil) [ OK ]'
  id: totrans-1741
  prefs: []
  type: TYPE_NORMAL
  zh: '* snort_agent-1 (sguil) [ OK ]'
- en: '* snort-1 (alert data) [ OK ]'
  id: totrans-1742
  prefs: []
  type: TYPE_NORMAL
  zh: '* snort-1 (警报数据) [ OK ]'
- en: '* barnyard2-1 (spooler, unified2 format) [ OK ]'
  id: totrans-1743
  prefs: []
  type: TYPE_NORMAL
  zh: '* barnyard2-1 (spooler, unified2 格式) [ OK ]'
- en: SO Scripts and Configuration **319**
  id: totrans-1744
  prefs: []
  type: TYPE_NORMAL
  zh: SO 脚本和配置 **319**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1745
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '* prads (sessions/assets) [ OK ]'
  id: totrans-1746
  prefs: []
  type: TYPE_NORMAL
  zh: '* prads (会话/资产) [ OK ]'
- en: '* sancp_agent (sguil) [ OK ]'
  id: totrans-1747
  prefs: []
  type: TYPE_NORMAL
  zh: '* sancp_agent (sguil) [ OK ]'
- en: '* pads_agent (sguil) [ OK ]'
  id: totrans-1748
  prefs: []
  type: TYPE_NORMAL
  zh: '* pads_agent (sguil) [ OK ]'
- en: '* argus [ OK ]'
  id: totrans-1749
  prefs: []
  type: TYPE_NORMAL
  zh: '* argus [ OK ]'
- en: '* http_agent (sguil) [ OK ]'
  id: totrans-1750
  prefs: []
  type: TYPE_NORMAL
  zh: '* http_agent (sguil) [ OK ]'
- en: '***/usr/sbin/nsm_sensor_ps-stop***'
  id: totrans-1751
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_sensor_ps-stop***'
- en: The /usr/sbin/nsm_sensor_ps-stop script is used to stop sensor processes.
  id: totrans-1752
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_sensor_ps-stop 脚本用于停止传感器进程。
- en: $ **sudo /usr/sbin/nsm_sensor_ps-stop**
  id: totrans-1753
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm_sensor_ps-stop**
- en: 'Stopping: HIDS'
  id: totrans-1754
  prefs: []
  type: TYPE_NORMAL
  zh: 停止中：HIDS
- en: '* stopping: ossec_agent (sguil) [ OK ]'
  id: totrans-1755
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：ossec_agent (sguil) [ OK ]'
- en: 'Stopping: Bro'
  id: totrans-1756
  prefs: []
  type: TYPE_NORMAL
  zh: 停止中：Bro
- en: stopping bro ...
  id: totrans-1757
  prefs: []
  type: TYPE_NORMAL
  zh: 停止 bro ...
- en: 'Stopping: securityonion-eth1'
  id: totrans-1758
  prefs: []
  type: TYPE_NORMAL
  zh: 停止中：securityonion-eth1
- en: '* stopping: netsniff-ng (full packet data) [ OK ]'
  id: totrans-1759
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：netsniff-ng (完整数据包数据) [ OK ]'
- en: '* stopping: pcap_agent (sguil) [ OK ]'
  id: totrans-1760
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：pcap_agent (sguil) [ OK ]'
- en: '* stopping: snort_agent-1 (sguil) [ OK ]'
  id: totrans-1761
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：snort_agent-1 (sguil) [ OK ]'
- en: '* stopping: snort-1 (alert data) [ OK ]'
  id: totrans-1762
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：snort-1 (警报数据) [ OK ]'
- en: '* stopping: barnyard2-1 (spooler, unified2 format) [ OK ]'
  id: totrans-1763
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：barnyard2-1 (spooler, unified2 格式) [ OK ]'
- en: '* stopping: prads (sessions/assets) [ OK ]'
  id: totrans-1764
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：prads (会话/资产) [ OK ]'
- en: '* stopping: sancp_agent (sguil) [ OK ]'
  id: totrans-1765
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：sancp_agent (sguil) [ OK ]'
- en: '* stopping: pads_agent (sguil) [ OK ]'
  id: totrans-1766
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：pads_agent (sguil) [ OK ]'
- en: '* stopping: argus [ OK ]'
  id: totrans-1767
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：argus [ OK ]'
- en: '* stopping: http_agent (sguil) [ OK ]'
  id: totrans-1768
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：http_agent (sguil) [ OK ]'
- en: '***/usr/sbin/nsm_server***'
  id: totrans-1769
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_server***'
- en: The high-level /usr/sbin/nsm_server script can pass options to some of the
  id: totrans-1770
  prefs: []
  type: TYPE_NORMAL
  zh: 高级 /usr/sbin/nsm_server 脚本可以将选项传递给一些
- en: underlying nsm_server_* scripts.
  id: totrans-1771
  prefs: []
  type: TYPE_NORMAL
  zh: 底层 nsm_server_* 脚本。
- en: $ **sudo /usr/sbin/nsm_server --status**
  id: totrans-1772
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm_server --status**
- en: 'Status: securityonion'
  id: totrans-1773
  prefs: []
  type: TYPE_NORMAL
  zh: 状态：securityonion
- en: '* sguil server [ OK ]'
  id: totrans-1774
  prefs: []
  type: TYPE_NORMAL
  zh: '* sguil 服务器 [ OK ]'
- en: '***/usr/sbin/nsm_server_add***'
  id: totrans-1775
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_server_add***'
- en: The /usr/sbin/nsm_server_add script is used by the setup wizard to create a
  id: totrans-1776
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_server_add 脚本由设置向导使用，用于创建一个
- en: new Sguil server (sguild). You shouldn’t need to run this script manually.
  id: totrans-1777
  prefs: []
  type: TYPE_NORMAL
  zh: 新的 Sguil 服务器（sguild）。您不应该手动运行此脚本。
- en: '***/usr/sbin/nsm_server_backup-config***'
  id: totrans-1778
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_server_backup-config***'
- en: The /usr/sbin/nsm_server_backup-config script backs up the sguild configura-
  id: totrans-1779
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_server_backup-config 脚本将 sguild 配置文件备份
- en: tion files to a user-specified tarball.
  id: totrans-1780
  prefs: []
  type: TYPE_NORMAL
  zh: 配置文件到用户指定的 tarball。
- en: '***/usr/sbin/nsm_server_backup-data***'
  id: totrans-1781
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_server_backup-data***'
- en: The /usr/sbin/nsm_server_backup-data script backs up the sguild data to a
  id: totrans-1782
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_server_backup-data 脚本将 sguild 数据备份到一个
- en: user-specified tarball.
  id: totrans-1783
  prefs: []
  type: TYPE_NORMAL
  zh: 用户指定的 tarball。
- en: '**320** Appendix'
  id: totrans-1784
  prefs: []
  type: TYPE_NORMAL
  zh: '**320** 附录'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1785
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '***/usr/sbin/nsm_server_clear***'
  id: totrans-1786
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_server_clear***'
- en: The /usr/sbin/nsm_server_clear script clears all sguild data.
  id: totrans-1787
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_server_clear 脚本清除所有 sguild 数据。
- en: '***/usr/sbin/nsm_server_del***'
  id: totrans-1788
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_server_del***'
- en: The /usr/sbin/nsm_server_del script permanently deletes the Sguil server
  id: totrans-1789
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_server_del 脚本永久删除 Sguil 服务器
- en: (sguild).
  id: totrans-1790
  prefs: []
  type: TYPE_NORMAL
  zh: （sguild）。
- en: '***/usr/sbin/nsm_server_edit***'
  id: totrans-1791
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_server_edit***'
- en: The /usr/sbin/nsm_server_edit script can be used to edit certain details of
    the
  id: totrans-1792
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_server_edit 脚本可以用来编辑某些详细信息
- en: sguild configuration.
  id: totrans-1793
  prefs: []
  type: TYPE_NORMAL
  zh: sguild 配置。
- en: '***/usr/sbin/nsm_server_ps-restart***'
  id: totrans-1794
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_server_ps-restart***'
- en: The /usr/sbin/nsm_server_ps-restart script can be used to restart sguild.
  id: totrans-1795
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_server_ps-restart 脚本可以用来重启 sguild。
- en: $ **sudo /usr/sbin/nsm_server_ps-restart**
  id: totrans-1796
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm_server_ps-restart**
- en: 'Restarting: securityonion'
  id: totrans-1797
  prefs: []
  type: TYPE_NORMAL
  zh: 重启中：securityonion
- en: '* stopping: sguil server [ OK ]'
  id: totrans-1798
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：sguil 服务器 [ OK ]'
- en: '* starting: sguil server [ OK ]'
  id: totrans-1799
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：sguil 服务器 [ OK ]'
- en: '***/usr/sbin/nsm_server_ps-start***'
  id: totrans-1800
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_server_ps-start***'
- en: The /usr/sbin/nsm_server_ps-start script can be used to start sguild.
  id: totrans-1801
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_server_ps-start 脚本可用于启动 sguild。
- en: $ **sudo /usr/sbin/nsm_server_ps-start**
  id: totrans-1802
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm_server_ps-start**
- en: 'Starting: securityonion'
  id: totrans-1803
  prefs: []
  type: TYPE_NORMAL
  zh: 启动中：securityonion
- en: '* starting: sguil server [ OK ]'
  id: totrans-1804
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：sguil 服务器 [ OK ]'
- en: '***/usr/sbin/nsm_server_ps-status***'
  id: totrans-1805
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_server_ps-status***'
- en: The /usr/sbin/nsm_server_ps-status script can be used to check the status of
  id: totrans-1806
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_server_ps-status 脚本可用于检查
- en: sguild.
  id: totrans-1807
  prefs: []
  type: TYPE_NORMAL
  zh: sguild。
- en: $ **sudo /usr/sbin/nsm_server_ps-status**
  id: totrans-1808
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm_server_ps-status**
- en: 'Status: securityonion'
  id: totrans-1809
  prefs: []
  type: TYPE_NORMAL
  zh: 状态：securityonion
- en: '* sguil server [ OK ]'
  id: totrans-1810
  prefs: []
  type: TYPE_NORMAL
  zh: '* sguil 服务器 [ OK ]'
- en: '***/usr/sbin/nsm_server_ps-stop***'
  id: totrans-1811
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_server_ps-stop***'
- en: The /usr/sbin/nsm_server_ps-stop script can be used to stop sguild.
  id: totrans-1812
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_server_ps-stop 脚本可以用来停止 sguild。
- en: $ **sudo /usr/sbin/nsm_server_ps-stop**
  id: totrans-1813
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm_server_ps-stop**
- en: 'Stopping: securityonion'
  id: totrans-1814
  prefs: []
  type: TYPE_NORMAL
  zh: 停止中：securityonion
- en: '* stopping: sguil server [ OK ]'
  id: totrans-1815
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：sguil 服务器 [ OK ]'
- en: SO Scripts and Configuration **321**
  id: totrans-1816
  prefs: []
  type: TYPE_NORMAL
  zh: SO 脚本和配置 **321**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1817
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '***/usr/sbin/nsm_server_sensor-add***'
  id: totrans-1818
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_server_sensor-add***'
- en: The /usr/sbin/nsm_server_sensor-add script is used to add a sensor to the
  id: totrans-1819
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_server_sensor-add 脚本用于向
- en: sguild configuration.
  id: totrans-1820
  prefs: []
  type: TYPE_NORMAL
  zh: sguild 配置。
- en: '***/usr/sbin/nsm_server_sensor-del***'
  id: totrans-1821
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_server_sensor-del***'
- en: The /usr/sbin/nsm_server_sensor-del script is used to delete a sensor from the
  id: totrans-1822
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_server_sensor-del 脚本用于删除传感器
- en: sguild configuration.
  id: totrans-1823
  prefs: []
  type: TYPE_NORMAL
  zh: sguild 配置。
- en: '***/usr/sbin/nsm_server_user-add***'
  id: totrans-1824
  prefs: []
  type: TYPE_NORMAL
  zh: '***/usr/sbin/nsm_server_user-add***'
- en: The /usr/sbin/nsm_server_user-add script is used to add a new sguild user.
  id: totrans-1825
  prefs: []
  type: TYPE_NORMAL
  zh: /usr/sbin/nsm_server_user-add 脚本用于添加新的 sguild 用户。
- en: $ **sudo /usr/sbin/nsm_server_user-add**
  id: totrans-1826
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo /usr/sbin/nsm_server_user-add**
- en: User Name
  id: totrans-1827
  prefs: []
  type: TYPE_NORMAL
  zh: 用户名
- en: Enter the name of the new user that will be granted privilege to connect to
  id: totrans-1828
  prefs: []
  type: TYPE_NORMAL
  zh: 输入将被授予连接权限的新用户名称
- en: 'this server.: **richard**'
  id: totrans-1829
  prefs: []
  type: TYPE_NORMAL
  zh: 此服务器。：**richard**
- en: User Pass
  id: totrans-1830
  prefs: []
  type: TYPE_NORMAL
  zh: 用户密码
- en: Enter the password for the new user that will be granted privilege to connect
  id: totrans-1831
  prefs: []
  type: TYPE_NORMAL
  zh: 输入将被授予连接权限的新用户密码
- en: 'to this server.:'
  id: totrans-1832
  prefs: []
  type: TYPE_NORMAL
  zh: 连接到此服务器。：
- en: 'Verify:'
  id: totrans-1833
  prefs: []
  type: TYPE_NORMAL
  zh: 验证：
- en: Add User to Server
  id: totrans-1834
  prefs: []
  type: TYPE_NORMAL
  zh: 将用户添加到服务器
- en: 'The following information has been collected:'
  id: totrans-1835
  prefs: []
  type: TYPE_NORMAL
  zh: 以下信息已被收集：
- en: 'server: securityonion'
  id: totrans-1836
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器：securityonion
- en: 'user: richard'
  id: totrans-1837
  prefs: []
  type: TYPE_NORMAL
  zh: 用户：richard
- en: 'Do you want to create? (Y/N) [Y]: **y**'
  id: totrans-1838
  prefs: []
  type: TYPE_NORMAL
  zh: 您是否要创建？（Y/N）[Y]：**y**
- en: 'Adding user to server: richard => securityonion'
  id: totrans-1839
  prefs: []
  type: TYPE_NORMAL
  zh: 将用户添加到服务器：richard => securityonion
- en: '**So configuration files**'
  id: totrans-1840
  prefs: []
  type: TYPE_NORMAL
  zh: '**So 配置文件**'
- en: Configuration files control how SO applications operate. Administrators
  id: totrans-1841
  prefs: []
  type: TYPE_NORMAL
  zh: 配置文件控制 SO 应用程序的操作方式。管理员
- en: can change the contents of some of these files to tailor how SO collects and
  id: totrans-1842
  prefs: []
  type: TYPE_NORMAL
  zh: 可以更改某些文件的内容，以定制 SO 收集和
- en: interprets NSM data.
  id: totrans-1843
  prefs: []
  type: TYPE_NORMAL
  zh: 解释 NSM 数据。
- en: The SO team configures SO with sensible defaults, but in some cases,
  id: totrans-1844
  prefs: []
  type: TYPE_NORMAL
  zh: SO 团队以合理的默认值配置 SO，但在某些情况下，
- en: changes may be appropriate. This section describes SO’s configuration files,
  id: totrans-1845
  prefs: []
  type: TYPE_NORMAL
  zh: 变更可能是合适的。本节描述了 SO 的配置文件，
- en: including whether the SO team believes that administrators may sometimes
  id: totrans-1846
  prefs: []
  type: TYPE_NORMAL
  zh: 包括 SO 团队是否认为管理员有时可能
- en: need to make changes to them.
  id: totrans-1847
  prefs: []
  type: TYPE_NORMAL
  zh: 不需要对它们进行修改。
- en: '***/etc/nsm/***'
  id: totrans-1848
  prefs: []
  type: TYPE_NORMAL
  zh: '***/etc/nsm/***'
- en: '*/etc/nsm/* is the main configuration directory. It contains the following:'
  id: totrans-1849
  prefs: []
  type: TYPE_NORMAL
  zh: '*/etc/nsm/* 是主要的配置目录。它包含以下内容：'
- en: administration.conf
  id: totrans-1850
  prefs: []
  type: TYPE_NORMAL
  zh: administration.conf
- en: ossec/
  id: totrans-1851
  prefs: []
  type: TYPE_NORMAL
  zh: ossec/
- en: pulledpork/
  id: totrans-1852
  prefs: []
  type: TYPE_NORMAL
  zh: pulledpork/
- en: rules/
  id: totrans-1853
  prefs: []
  type: TYPE_NORMAL
  zh: rules/
- en: '**322** Appendix'
  id: totrans-1854
  prefs: []
  type: TYPE_NORMAL
  zh: '**322** 附录'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1855
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: securityonion/
  id: totrans-1856
  prefs: []
  type: TYPE_NORMAL
  zh: securityonion/
- en: securityonion.conf
  id: totrans-1857
  prefs: []
  type: TYPE_NORMAL
  zh: securityonion.conf
- en: sensortab
  id: totrans-1858
  prefs: []
  type: TYPE_NORMAL
  zh: sensortab
- en: servertab
  id: totrans-1859
  prefs: []
  type: TYPE_NORMAL
  zh: servertab
- en: templates/
  id: totrans-1860
  prefs: []
  type: TYPE_NORMAL
  zh: templates/
- en: $HOSTNAME-$INTERFACE
  id: totrans-1861
  prefs: []
  type: TYPE_NORMAL
  zh: $HOSTNAME-$INTERFACE
- en: The final entry in this list will vary based on your hostname and the
  id: totrans-1862
  prefs: []
  type: TYPE_NORMAL
  zh: 列表中的最后一项将根据你的主机名和
- en: interfaces you choose to monitor. For example, the following is output from
  id: totrans-1863
  prefs: []
  type: TYPE_NORMAL
  zh: 你选择监控的接口。例如，以下是来自
- en: 'my sensor named securityonion with a single monitored interface (eth1):'
  id: totrans-1864
  prefs: []
  type: TYPE_NORMAL
  zh: 我的小传感器命名为 securityonion，拥有一个监控接口（eth1）：
- en: -rw-r--r-- 1 root root 247 Jul 24 2012 administration.conf
  id: totrans-1865
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 247 2012年 7月 24日 administration.conf
- en: drwxr-xr-x 2 root root 4.0K Feb 18 16:16 ossec
  id: totrans-1866
  prefs: []
  type: TYPE_NORMAL
  zh: drwxr-xr-x 2 root root 4.0K 2月 18 16:16 ossec
- en: drwxr-xr-x 2 root root 4.0K Dec 18 11:15 pulledpork
  id: totrans-1867
  prefs: []
  type: TYPE_NORMAL
  zh: drwxr-xr-x 2 root root 4.0K 12月 18 11:15 pulledpork
- en: drwxr-xr-x 3 root root 4.0K Feb 18 16:16 rules
  id: totrans-1868
  prefs: []
  type: TYPE_NORMAL
  zh: drwxr-xr-x 3 root root 4.0K 2月 18 16:16 rules
- en: drwxrwxr-x 3 sguil sguil 4.0K Feb 18 16:16 securityonion
  id: totrans-1869
  prefs: []
  type: TYPE_NORMAL
  zh: drwxrwxr-x 3 sguil sguil 4.0K 2月 18 16:16 securityonion
- en: -rw-r--r-- 1 root root 37 Feb 18 16:16 securityonion.conf
  id: totrans-1870
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 37 2月 18 16:16 securityonion.conf
- en: drwxrwxr-x 2 sguil sguil 4.0K Feb 18 16:17 securityonion-eth1
  id: totrans-1871
  prefs: []
  type: TYPE_NORMAL
  zh: drwxrwxr-x 2 sguil sguil 4.0K 2月 18 16:17 securityonion-eth1
- en: -rw-r--r-- 1 root root 31 Feb 18 16:16 sensortab
  id: totrans-1872
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 31 2月 18 16:16 sensortab
- en: -rw-r--r-- 1 root root 349 Feb 18 16:16 servertab
  id: totrans-1873
  prefs: []
  type: TYPE_NORMAL
  zh: -rw-r--r-- 1 root root 349 2月 18 16:16 servertab
- en: drwxr-xr-x 8 root root 4.0K Dec 18 11:14 templates
  id: totrans-1874
  prefs: []
  type: TYPE_NORMAL
  zh: drwxr-xr-x 8 root root 4.0K 12月 18 11:14 templates
- en: Let’s look at each of these files and directories in turn.
  id: totrans-1875
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们逐一查看这些文件和目录。
- en: '***/etc/nsm/administration.conf***'
  id: totrans-1876
  prefs: []
  type: TYPE_NORMAL
  zh: '***/etc/nsm/administration.conf***'
- en: The */etc/nsm/administration.conf* file defines some filesystem locations for
    the NSM scripts. You should never need to change anything in this file.
  id: totrans-1877
  prefs: []
  type: TYPE_NORMAL
  zh: '*/etc/nsm/administration.conf* 文件定义了 NSM 脚本的一些文件系统位置。你通常不需要更改这个文件中的任何内容。'
- en: '***/etc/nsm/ossec/***'
  id: totrans-1878
  prefs: []
  type: TYPE_NORMAL
  zh: '***/etc/nsm/ossec/***'
- en: The */etc/nsm/ossec/* directory contains the OSSEC agent for Sguil (ossec_
  id: totrans-1879
  prefs: []
  type: TYPE_NORMAL
  zh: '*/etc/nsm/ossec/* 目录包含用于 Sguil 的 OSSEC 代理（ossec_'
- en: agent.tcl) and its configuration file ( *ossec_agent.conf* ). You probably won’t
    need to modify these files.
  id: totrans-1880
  prefs: []
  type: TYPE_NORMAL
  zh: agent.tcl) 及其配置文件（ *ossec_agent.conf* ）。你可能不需要修改这些文件。
- en: '***/etc/nsm/pul edpork/***'
  id: totrans-1881
  prefs: []
  type: TYPE_NORMAL
  zh: '***/etc/nsm/pulledpork/***'
- en: The */etc/nsm/pulledpork/* directory contains the configuration files for
  id: totrans-1882
  prefs: []
  type: TYPE_NORMAL
  zh: '*/etc/nsm/pulledpork/* 目录包含 PulledPork 配置文件'
- en: PulledPork, which is responsible for downloading IDS rulesets from the
  id: totrans-1883
  prefs: []
  type: TYPE_NORMAL
  zh: PulledPork，负责从
- en: Internet. The main configuration file for PulledPork is *pulledpork.conf*, but
  id: totrans-1884
  prefs: []
  type: TYPE_NORMAL
  zh: 互联网。PulledPork 的主要配置文件是 *pulledpork.conf*，但是
- en: you’ll probably spend most of your time modifying *disablesid.conf*, *enablesid*
  id: totrans-1885
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能大部分时间都会修改 *disablesid.conf*、*enablesid*
- en: '*.conf*, and *modifysid.conf* to tune your ruleset.'
  id: totrans-1886
  prefs: []
  type: TYPE_NORMAL
  zh: '*.conf* 和 *modifysid.conf* 用于调整你的规则集。'
- en: '***/etc/nsm/rules/***'
  id: totrans-1887
  prefs: []
  type: TYPE_NORMAL
  zh: '***/etc/nsm/rules/***'
- en: The */etc/nsm/rules/* directory contains the IDS ruleset(s) downloaded
  id: totrans-1888
  prefs: []
  type: TYPE_NORMAL
  zh: '*/etc/nsm/rules/* 目录包含已下载的 IDS 规则集'
- en: by PulledPork and associated files that control the sensor processes. When
  id: totrans-1889
  prefs: []
  type: TYPE_NORMAL
  zh: 由 PulledPork 和与之相关的文件控制传感器进程。当
- en: PulledPork runs, it stores the rules in *downloaded.rules*. Don’t modify this
    file manually because PulledPork will overwrite it automatically the next time
    it
  id: totrans-1890
  prefs: []
  type: TYPE_NORMAL
  zh: PulledPork 运行时，它将规则存储在 *downloaded.rules* 中。不要手动修改此文件，因为 PulledPork 会在下一次运行时自动覆盖它
- en: runs. Instead, tune your ruleset using the files in */etc/nsm/pulledpork/*.
  id: totrans-1891
  prefs: []
  type: TYPE_NORMAL
  zh: 运行。相反，使用 */etc/nsm/pulledpork/* 中的文件调整你的规则集。
- en: You can write your own rules and store them in *local.rules*. To tune a
  id: totrans-1892
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以编写自己的规则并将其存储在 *local.rules* 中。要调整一个
- en: particular rule without totally disabling it, use *threshold.conf*. To specify
    a SO Scripts and Configuration **323**
  id: totrans-1893
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你只想禁用特定规则而不是完全禁用它，请使用 *threshold.conf*。要指定 SO 脚本和配置 **323**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1894
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: Berkeley Packet Filter (BPF) so that the sniffing processes will selectively
    ignore traffic from certain IP addresses, use *bpf.conf*. Bro automatically
  id: totrans-1895
  prefs: []
  type: TYPE_NORMAL
  zh: Berkeley 数据包过滤器（BPF），使嗅探进程可以选择性地忽略来自某些 IP 地址的流量，使用 *bpf.conf*。Bro 会自动
- en: monitors this file for changes and will update it as needed. Other services
  id: totrans-1896
  prefs: []
  type: TYPE_NORMAL
  zh: 监控此文件的服务会根据需要更新它。其他服务
- en: (such as Snort and Suricata, PRADS, and Netsniff-ng) will need to be
  id: totrans-1897
  prefs: []
  type: TYPE_NORMAL
  zh: （如 Snort 和 Suricata，PRADS，和 Netsniff-ng）需要
- en: restarted for the change to take effect.
  id: totrans-1898
  prefs: []
  type: TYPE_NORMAL
  zh: 必须重新启动才能使更改生效。
- en: '***/etc/nsm/securityonion/***'
  id: totrans-1899
  prefs: []
  type: TYPE_NORMAL
  zh: '***/etc/nsm/securityonion/***'
- en: The */etc/nsm/securityonion/* directory contains the following Sguil server
  id: totrans-1900
  prefs: []
  type: TYPE_NORMAL
  zh: '*/etc/nsm/securityonion/* 目录包含以下 Sguil 服务器'
- en: '(sguild) configuration files:'
  id: totrans-1901
  prefs: []
  type: TYPE_NORMAL
  zh: （sguild）配置文件：
- en: '***autocat.conf*** Used to configure Sguil to automatically categorize'
  id: totrans-1902
  prefs: []
  type: TYPE_NORMAL
  zh: '***autocat.conf*** 用于配置 Sguil 自动分类'
- en: certain events.
  id: totrans-1903
  prefs: []
  type: TYPE_NORMAL
  zh: 某些事件。
- en: '***certs*** Contains the files used to secure communications between the'
  id: totrans-1904
  prefs: []
  type: TYPE_NORMAL
  zh: '***certs*** 包含用于保护通信的文件'
- en: Sguil server (sguild) and its agents and clients.
  id: totrans-1905
  prefs: []
  type: TYPE_NORMAL
  zh: Sguil 服务器（sguild）及其代理和客户端。
- en: '***server.conf*** Contains some general settings used to start sguild and'
  id: totrans-1906
  prefs: []
  type: TYPE_NORMAL
  zh: '***server.conf*** 包含一些用于启动 sguild 的通用设置'
- en: should not need to be modified.
  id: totrans-1907
  prefs: []
  type: TYPE_NORMAL
  zh: 不需要修改。
- en: '***sguild.access*** Used to control access to sguild.'
  id: totrans-1908
  prefs: []
  type: TYPE_NORMAL
  zh: '***sguild.access*** 用于控制对 sguild 的访问。'
- en: '***sguild.conf*** Contains general settings for sguild and probably doesn’t
    need to be changed.'
  id: totrans-1909
  prefs: []
  type: TYPE_NORMAL
  zh: '***sguild.conf*** 包含 sguild 的通用设置，通常不需要更改。'
- en: '***sguild.email*** Allows you to configure Sguil to automatically send email
    when certain events occur.'
  id: totrans-1910
  prefs: []
  type: TYPE_NORMAL
  zh: '***sguild.email*** 允许你配置 Sguil 在发生某些事件时自动发送电子邮件。'
- en: '***sguild.queries*** Contains queries that can be accessed from the Sguil'
  id: totrans-1911
  prefs: []
  type: TYPE_NORMAL
  zh: '***sguild.queries*** 包含可从 Sguil 访问的查询'
- en: client by selecting **Query**4**Standard Queries**.
  id: totrans-1912
  prefs: []
  type: TYPE_NORMAL
  zh: 客户端通过选择 **查询**4**标准查询**。
- en: '***sguild.users*** This file should not be modified.'
  id: totrans-1913
  prefs: []
  type: TYPE_NORMAL
  zh: '***sguild.users*** 该文件不应修改。'
- en: '***/etc/nsm/securityonion.conf***'
  id: totrans-1914
  prefs: []
  type: TYPE_NORMAL
  zh: '***/etc/nsm/securityonion.conf***'
- en: The */etc/nsm/securityonion.conf* file contains the IDS_ENGINE, DAYSTOKEEP,
    and ELSA settings, which let you change the intrusion detection system (IDS)
  id: totrans-1915
  prefs: []
  type: TYPE_NORMAL
  zh: '*/etc/nsm/securityonion.conf* 文件包含 IDS_ENGINE、DAYSTOKEEP 和 ELSA 设置，允许你更改入侵检测系统（IDS）'
- en: engine, the amount of time data is kept in the Sguil database, and whether
  id: totrans-1916
  prefs: []
  type: TYPE_NORMAL
  zh: 引擎，数据在 Sguil 数据库中保存的时间，以及是否
- en: ELSA is enabled, respectively.
  id: totrans-1917
  prefs: []
  type: TYPE_NORMAL
  zh: ELSA 已启用。
- en: If you run the setup wizard and select Quick Setup, SO will default to
  id: totrans-1918
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你运行设置向导并选择快速设置，SO 将默认
- en: using Snort as the IDS engine. If you choose Advanced Setup, SO will ask if
  id: totrans-1919
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Snort 作为 IDS 引擎。如果选择高级设置，SO 会询问是否
- en: you want to run Snort or Suricata. In either case, the setup wizard will set
  id: totrans-1920
  prefs: []
  type: TYPE_NORMAL
  zh: 你想运行 Snort 还是 Suricata。在任何一种情况下，设置向导将设置
- en: the IDS_ENGINE variable. If you later decide to change your IDS engine, you
  id: totrans-1921
  prefs: []
  type: TYPE_NORMAL
  zh: IDS_ENGINE 变量。如果你后来决定更改 IDS 引擎，
- en: can stop all sensor processes, change the IDS_ENGINE setting, execute rule-
  id: totrans-1922
  prefs: []
  type: TYPE_NORMAL
  zh: 可以停止所有传感器进程，修改 IDS_ENGINE 设置，执行规则更新，
- en: update, and then restart all sensor processes.
  id: totrans-1923
  prefs: []
  type: TYPE_NORMAL
  zh: 更新，并重新启动所有传感器进程。
- en: For example, suppose you ran the Quick Setup, giving you the default
  id: totrans-1924
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，假设你运行了快速设置，它会为你提供默认的
- en: 'of Snort. If you want to try Suricata, do the following:'
  id: totrans-1925
  prefs: []
  type: TYPE_NORMAL
  zh: Snort。如果你想尝试 Suricata，请执行以下操作：
- en: $ **sudo nsm_sensor_ps-stop**
  id: totrans-1926
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo nsm_sensor_ps-stop**
- en: 'Stopping: HIDS'
  id: totrans-1927
  prefs: []
  type: TYPE_NORMAL
  zh: 停止中：HIDS
- en: '* stopping: ossec_agent (sguil) [ OK ]'
  id: totrans-1928
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：ossec_agent（sguil）[ OK ]'
- en: 'Stopping: Bro'
  id: totrans-1929
  prefs: []
  type: TYPE_NORMAL
  zh: 停止中：Bro
- en: waiting for lock ........ ok
  id: totrans-1930
  prefs: []
  type: TYPE_NORMAL
  zh: 正在等待锁定 ........ ok
- en: stopping bro ...
  id: totrans-1931
  prefs: []
  type: TYPE_NORMAL
  zh: 停止 bro ...
- en: '**324** Appendix'
  id: totrans-1932
  prefs: []
  type: TYPE_NORMAL
  zh: '**324** 附录'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1933
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: 'Stopping: securityonion-eth1'
  id: totrans-1934
  prefs: []
  type: TYPE_NORMAL
  zh: 停止中：securityonion-eth1
- en: '* stopping: netsniff-ng (full packet data) [ OK ]'
  id: totrans-1935
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：netsniff-ng（完整数据包）[ OK ]'
- en: '* stopping: pcap_agent (sguil) [ OK ]'
  id: totrans-1936
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：pcap_agent（sguil）[ OK ]'
- en: '* stopping: snort_agent-1 (sguil) [ OK ]'
  id: totrans-1937
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：snort_agent-1（sguil）[ OK ]'
- en: '* stopping: snort-1 (alert data) [ OK ]'
  id: totrans-1938
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：snort-1（警报数据）[ OK ]'
- en: '* stopping: barnyard2-1 (spooler, unified2 format) [ OK ]'
  id: totrans-1939
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：barnyard2-1（队列器，unified2 格式）[ OK ]'
- en: '* stopping: prads (sessions/assets) [ OK ]'
  id: totrans-1940
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：prads（会话/资产）[ OK ]'
- en: '* stopping: sancp_agent (sguil) [ OK ]'
  id: totrans-1941
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：sancp_agent（sguil）[ OK ]'
- en: '* stopping: pads_agent (sguil) [ OK ]'
  id: totrans-1942
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：pads_agent（sguil）[ OK ]'
- en: '* stopping: argus [ OK ]'
  id: totrans-1943
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：argus [ OK ]'
- en: '* stopping: http_agent (sguil) [ OK ]'
  id: totrans-1944
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：http_agent（sguil）[ OK ]'
- en: $ **sudo sed -i 's|ENGINE=snort|ENGINE=suricata|g' /etc/nsm/securityonion.conf**
  id: totrans-1945
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo sed -i 's|ENGINE=snort|ENGINE=suricata|g' /etc/nsm/securityonion.conf**
- en: $ **sudo rule-update > /dev/null**
  id: totrans-1946
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo rule-update > /dev/null**
- en: $ **sudo nsm_sensor_ps-start**
  id: totrans-1947
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo nsm_sensor_ps-start**
- en: 'Starting: HIDS'
  id: totrans-1948
  prefs: []
  type: TYPE_NORMAL
  zh: 启动中：HIDS
- en: '* starting: ossec_agent (sguil) [ OK ]'
  id: totrans-1949
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：ossec_agent（sguil）[ OK ]'
- en: 'Starting: Bro'
  id: totrans-1950
  prefs: []
  type: TYPE_NORMAL
  zh: 启动中：Bro
- en: starting bro ...
  id: totrans-1951
  prefs: []
  type: TYPE_NORMAL
  zh: 启动中：bro ...
- en: 'Starting: securityonion-eth1'
  id: totrans-1952
  prefs: []
  type: TYPE_NORMAL
  zh: 启动中：securityonion-eth1
- en: '* starting: netsniff-ng (full packet data) [ OK ]'
  id: totrans-1953
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：netsniff-ng（完整数据包）[ OK ]'
- en: '* starting: pcap_agent (sguil) [ OK ]'
  id: totrans-1954
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：pcap_agent（sguil）[ OK ]'
- en: '* starting: snort_agent (sguil) [ OK ]'
  id: totrans-1955
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：snort_agent（sguil）[ OK ]'
- en: '* starting: suricata (alert data) [ OK ]'
  id: totrans-1956
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：suricata（警报数据）[ OK ]'
- en: '* starting: barnyard2 (spooler, unified2 format) [ OK ]'
  id: totrans-1957
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：barnyard2（队列器，unified2 格式）[ OK ]'
- en: '* starting: prads (sessions/assets) [ OK ]'
  id: totrans-1958
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：prads（会话/资产）[ OK ]'
- en: '* starting: pads_agent (sguil) [ OK ]'
  id: totrans-1959
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：pads_agent（sguil）[ OK ]'
- en: '* starting: sancp_agent (sguil) [ OK ]'
  id: totrans-1960
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：sancp_agent（sguil）[ OK ]'
- en: '* starting: argus [ OK ]'
  id: totrans-1961
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：argus [ OK ]'
- en: '* starting: http_agent (sguil) [ OK ]'
  id: totrans-1962
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：http_agent（sguil）[ OK ]'
- en: '* disk space currently at 26%'
  id: totrans-1963
  prefs: []
  type: TYPE_NORMAL
  zh: '* 磁盘空间当前为 26%'
- en: The DAYSTOKEEP variable allows you to define the retention policy for the
  id: totrans-1964
  prefs: []
  type: TYPE_NORMAL
  zh: DAYSTOKEEP 变量允许你定义
- en: Sguil database. A daily cronjob deletes any data in securityonion_db older than
  id: totrans-1965
  prefs: []
  type: TYPE_NORMAL
  zh: Sguil 数据库。一个每日的 cronjob 会删除任何在 securityonion_db 中超过的旧数据
- en: $DAYSTOKEEP. The default is 365\.
  id: totrans-1966
  prefs: []
  type: TYPE_NORMAL
  zh: $DAYSTOKEEP。默认值是365\。
- en: The ELSA variable is set when the setup wizard asks if you want to
  id: totrans-1967
  prefs: []
  type: TYPE_NORMAL
  zh: 单独的设备，使其仅作为服务器而非传感器。
- en: enable ELSA.
  id: totrans-1968
  prefs: []
  type: TYPE_NORMAL
  zh: 启用ELSA。
- en: '***/etc/nsm/sensortab***'
  id: totrans-1969
  prefs: []
  type: TYPE_NORMAL
  zh: '***/etc/nsm/sensortab***'
- en: If the box is configured to monitor interfaces, this file contains the list
    of
  id: totrans-1970
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：sancp_agent（sguil）[ OK ]'
- en: interfaces to be monitored. To disable the sniffing processes on an interface,
  id: totrans-1971
  prefs: []
  type: TYPE_NORMAL
  zh: 如果该设备配置为监控接口，则该文件包含要监控的接口列表。要禁用接口上的嗅探进程，
- en: you can temporarily stop interfaces as follows (replacing *HOSTNAME-INTERFACE*
  id: totrans-1972
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以临时停止接口，如下所示（替换 *HOSTNAME-INTERFACE*
- en: 'with your actual hostname and interface name):'
  id: totrans-1973
  prefs: []
  type: TYPE_NORMAL
  zh: 使用你的实际主机名和接口名称）：
- en: '**sudo nsm_sensor_ps-stop --sensor-name= *HOSTNAME-INTERFACE***'
  id: totrans-1974
  prefs: []
  type: TYPE_NORMAL
  zh: '**sudo nsm_sensor_ps-stop --sensor-name= *HOSTNAME-INTERFACE***'
- en: SO Scripts and Configuration **325**
  id: totrans-1975
  prefs: []
  type: TYPE_NORMAL
  zh: SO 脚本和配置 **325**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1976
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: To disable an interface permanently, comment out the relevant line in
  id: totrans-1977
  prefs: []
  type: TYPE_NORMAL
  zh: 要永久禁用一个接口，请注释掉相关行
- en: '*/etc/nsm/sensortab*. For example, suppose you ran the Quick Setup and were'
  id: totrans-1978
  prefs: []
  type: TYPE_NORMAL
  zh: '*/etc/nsm/sensortab*。例如，假设你运行了快速设置并且'
- en: monitoring eth1, but then decided to move the sensor components off to a
  id: totrans-1979
  prefs: []
  type: TYPE_NORMAL
  zh: '* sguil 服务器 [ OK ]'
- en: separate box, making this just a server and not a sensor.
  id: totrans-1980
  prefs: []
  type: TYPE_NORMAL
  zh: 保留策略对于
- en: $ **sudo nsm_sensor_ps-stop --sensor-name=securityonion-eth1**
  id: totrans-1981
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo nsm_sensor_ps-stop --sensor-name=securityonion-eth1**
- en: 'Stopping: HIDS'
  id: totrans-1982
  prefs: []
  type: TYPE_NORMAL
  zh: 停止：HIDS
- en: '* stopping: ossec_agent (sguil) [ OK ]'
  id: totrans-1983
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：http_agent（sguil）[ OK ]'
- en: 'Stopping: Bro'
  id: totrans-1984
  prefs: []
  type: TYPE_NORMAL
  zh: 停止：Bro
- en: stopping bro ...
  id: totrans-1985
  prefs: []
  type: TYPE_NORMAL
  zh: 停止 bro ...
- en: 'Stopping: securityonion-eth1'
  id: totrans-1986
  prefs: []
  type: TYPE_NORMAL
  zh: 停止：securityonion-eth1
- en: '* stopping: netsniff-ng (full packet data) [ OK ]'
  id: totrans-1987
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：netsniff-ng（完整数据包）[ OK ]'
- en: '* stopping: pcap_agent (sguil) [ OK ]'
  id: totrans-1988
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：pcap_agent（sguil）[ OK ]'
- en: '* stopping: snort_agent-1 (sguil) [ OK ]'
  id: totrans-1989
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：snort_agent-1（sguil）[ OK ]'
- en: '* stopping: snort-1 (alert data) [ OK ]'
  id: totrans-1990
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：snort-1（警报数据）[ OK ]'
- en: '* stopping: barnyard2-1 (spooler, unified2 format) [ OK ]'
  id: totrans-1991
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：barnyard2-1（spooler，unified2 格式）[ OK ]'
- en: '* stopping: prads (sessions/assets) [ OK ]'
  id: totrans-1992
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：prads（会话/资产）[ OK ]'
- en: '* stopping: sancp_agent (sguil) [ OK ]'
  id: totrans-1993
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo service nsm status**
- en: '* stopping: pads_agent (sguil) [ OK ]'
  id: totrans-1994
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：pads_agent（sguil）[ OK ]'
- en: '* stopping: argus [ OK ]'
  id: totrans-1995
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：argus [ OK ]'
- en: '* stopping: http_agent (sguil) [ OK ]'
  id: totrans-1996
  prefs: []
  type: TYPE_NORMAL
  zh: 监控 eth1，但之后决定将传感器组件移至
- en: $ **sudo sed -i 's|securityonion-eth1|#securityonion-eth1|g' /etc/nsm/sensortab**
  id: totrans-1997
  prefs: []
  type: TYPE_NORMAL
  zh: 设置向导询问你是否要启用 ELSA 变量时进行设置，
- en: $ **sudo service nsm status**
  id: totrans-1998
  prefs: []
  type: TYPE_NORMAL
  zh: '**barnyard2.conf**'
- en: 'Status: securityonion'
  id: totrans-1999
  prefs: []
  type: TYPE_NORMAL
  zh: 状态：securityonion
- en: '* sguil server [ OK ]'
  id: totrans-2000
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo sed -i 's|securityonion-eth1|#securityonion-eth1|g' /etc/nsm/sensortab**
- en: '***/etc/nsm/servertab***'
  id: totrans-2001
  prefs: []
  type: TYPE_NORMAL
  zh: '***/etc/nsm/servertab***'
- en: If the box is configured as a server, the */etc/nsm/servertab* file contains
    the internal name of the server (securityonion).
  id: totrans-2002
  prefs: []
  type: TYPE_NORMAL
  zh: 如果该设备被配置为服务器，*/etc/nsm/servertab* 文件包含服务器的内部名称（securityonion）。
- en: '***/etc/nsm/templates/***'
  id: totrans-2003
  prefs: []
  type: TYPE_NORMAL
  zh: '***/etc/nsm/templates/***'
- en: The */etc/nsm/templates/* directory contains template files for barnyard2,
  id: totrans-2004
  prefs: []
  type: TYPE_NORMAL
  zh: '*/etc/nsm/templates/* 目录包含 barnyard2 的模板文件，'
- en: http_agent, prads, pulledpork, snort, and suricata. The setup wizard copies
    the
  id: totrans-2005
  prefs: []
  type: TYPE_NORMAL
  zh: http_agent、prads、pulledpork、snort 和 suricata。设置向导会复制
- en: template files from these directories into the target directories and custom-
  id: totrans-2006
  prefs: []
  type: TYPE_NORMAL
  zh: 从这些目录中的模板文件到目标目录，并自定义
- en: izes them using the choices you made during setup. You shouldn’t modify
  id: totrans-2007
  prefs: []
  type: TYPE_NORMAL
  zh: 它们使用你在设置过程中做出的选择进行配置。你不应该修改
- en: these files.
  id: totrans-2008
  prefs: []
  type: TYPE_NORMAL
  zh: 这些文件。
- en: '***/etc/nsm/$HOSTNAME-$INTERFACE/***'
  id: totrans-2009
  prefs: []
  type: TYPE_NORMAL
  zh: '***/etc/nsm/$HOSTNAME-$INTERFACE/***'
- en: You’ll have an /etc/nsm/$ *HOSTNAME*-$ *INTERFACE*/ directory for each interface
    that you choose to monitor. For example, suppose your hostname is securityonion
  id: totrans-2010
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止：ossec_agent（sguil）[ OK ]'
- en: and you have a quad-port network interface card (eth0, eth1, eth2, and eth3),
  id: totrans-2011
  prefs: []
  type: TYPE_NORMAL
  zh: 并且你有一个四端口网络接口卡（eth0、eth1、eth2 和 eth3），
- en: but you choose to monitor only eth1 and eth2\. You will have the following
  id: totrans-2012
  prefs: []
  type: TYPE_NORMAL
  zh: 但你选择只监控 eth1 和 eth2\。你将拥有以下内容
- en: 'sensor configuration directories:'
  id: totrans-2013
  prefs: []
  type: TYPE_NORMAL
  zh: 传感器配置目录：
- en: '**326** Appendix'
  id: totrans-2014
  prefs: []
  type: TYPE_NORMAL
  zh: '**326** 附录'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2015
  prefs: []
  type: TYPE_NORMAL
  zh: 你将拥有一个 /etc/nsm/$ *HOSTNAME*-$ *INTERFACE*/ 目录，用于你选择监控的每个接口。例如，假设你的主机名是 securityonion
- en: /etc/nsm/securityonion-eth1/
  id: totrans-2016
  prefs: []
  type: TYPE_NORMAL
  zh: /etc/nsm/securityonion-eth1/
- en: /etc/nsm/securityonion-eth2/
  id: totrans-2017
  prefs: []
  type: TYPE_NORMAL
  zh: /etc/nsm/securityonion-eth2/
- en: Let’s look at the files in each of these directories.
  id: totrans-2018
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看一下这些目录中的文件。
- en: '**barnyard2.conf**'
  id: totrans-2019
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: The *barnyard2.conf* file configures barnyard2, the process used to pick up
  id: totrans-2020
  prefs: []
  type: TYPE_NORMAL
  zh: '*barnyard2.conf* 文件配置了 barnyard2，这是用来获取'
- en: unified2 output from Snort or Suricata and insert the alerts into Sguil,
  id: totrans-2021
  prefs: []
  type: TYPE_NORMAL
  zh: 从 Snort 或 Suricata 的 unified2 输出并将警报插入到 Sguil，
- en: Snorby, or ELSA. There may be multiple *barnyard2.conf* files to handle
  id: totrans-2022
  prefs: []
  type: TYPE_NORMAL
  zh: Snorby或ELSA。可能有多个*barnyard2.conf*文件来处理
- en: multiple instances of Snort.
  id: totrans-2023
  prefs: []
  type: TYPE_NORMAL
  zh: Snort的多个实例。
- en: You generally don’t need to modify this file unless you decide to add or
  id: totrans-2024
  prefs: []
  type: TYPE_NORMAL
  zh: 除非你决定添加或
- en: remove some of the outputs. For example, you might decide to stop sending
  id: totrans-2025
  prefs: []
  type: TYPE_NORMAL
  zh: 移除一些输出。例如，你可能决定停止发送
- en: IDS alerts to ELSA, and forward them to a corporate security information
  id: totrans-2026
  prefs: []
  type: TYPE_NORMAL
  zh: 将IDS警报发送到ELSA，并将其转发到企业安全信息
- en: event management platform instead.
  id: totrans-2027
  prefs: []
  type: TYPE_NORMAL
  zh: 事件管理平台而不是其他。
- en: '**bpf.conf files**'
  id: totrans-2028
  prefs: []
  type: TYPE_NORMAL
  zh: '**bpf.conf文件**'
- en: A global configuration file called *bpf.conf* at */etc/nsm/rules/bpf.conf* applies
    to all processes on all interfaces by default. Each process on each interface
  id: totrans-2029
  prefs: []
  type: TYPE_NORMAL
  zh: 一个名为*bpf.conf*的全局配置文件，位于*/etc/nsm/rules/bpf.conf*，默认适用于所有接口上的所有进程。每个接口上的每个进程
- en: 'has its own *.bpf* file, but by default, the per-process *.bpf* files are symlinked
    to the interface bpf, and the interface bpf is symlinked to the global *bpf.conf*,
    as shown here:'
  id: totrans-2030
  prefs: []
  type: TYPE_NORMAL
  zh: 每个实例都有自己的*.bpf*文件，但默认情况下，每个进程的*.bpf*文件都通过符号链接指向接口的bpf文件，而接口的bpf文件又通过符号链接指向全局的*bpf.conf*，如图所示：
- en: lrwxrwxrwx 1 root root 8 Feb 18 16:16 bpf-bro.conf -> bpf.conf
  id: totrans-2031
  prefs: []
  type: TYPE_NORMAL
  zh: lrwxrwxrwx 1 root root 8 2月 18日 16:16 bpf-bro.conf -> bpf.conf
- en: lrwxrwxrwx 1 root root 23 Feb 18 16:16 bpf.conf -> /etc/nsm/rules/bpf.conf
  id: totrans-2032
  prefs: []
  type: TYPE_NORMAL
  zh: lrwxrwxrwx 1 root root 23 2月 18日 16:16 bpf.conf -> /etc/nsm/rules/bpf.conf
- en: lrwxrwxrwx 1 root root 8 Feb 18 16:16 bpf-ids.conf -> bpf.conf
  id: totrans-2033
  prefs: []
  type: TYPE_NORMAL
  zh: lrwxrwxrwx 1 root root 8 2月 18日 16:16 bpf-ids.conf -> bpf.conf
- en: lrwxrwxrwx 1 root root 8 Feb 18 16:16 bpf-pcap.conf -> bpf.conf
  id: totrans-2034
  prefs: []
  type: TYPE_NORMAL
  zh: lrwxrwxrwx 1 root root 8 2月 18日 16:16 bpf-pcap.conf -> bpf.conf
- en: lrwxrwxrwx 1 root root 8 Feb 18 16:16 bpf-prads.conf -> bpf.conf
  id: totrans-2035
  prefs: []
  type: TYPE_NORMAL
  zh: lrwxrwxrwx 1 root root 8 2月 18日 16:16 bpf-prads.conf -> bpf.conf
- en: To specify a bpf per-interface or per-process, simply replace the default
  id: totrans-2036
  prefs: []
  type: TYPE_NORMAL
  zh: 要指定每个接口或每个进程的bpf，只需替换默认
- en: symlinks with the desired bpf files and restart services as necessary.
  id: totrans-2037
  prefs: []
  type: TYPE_NORMAL
  zh: 用符号链接连接到所需的bpf文件，并根据需要重启服务。
- en: '**http_agent.conf**'
  id: totrans-2038
  prefs: []
  type: TYPE_NORMAL
  zh: '**http_agent.conf**'
- en: '*http_agent* sends Bro HTTP logs into the Sguil database, and *http_agent.conf*
    allows you to configure which HTTP logs are included. For example, you'
  id: totrans-2039
  prefs: []
  type: TYPE_NORMAL
  zh: '*http_agent*将Bro HTTP日志发送到Sguil数据库，*http_agent.conf*允许你配置包含哪些HTTP日志。例如，你'
- en: may want to exclude high-traffic sites that your users normally visit in order
  id: totrans-2040
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能想排除用户通常访问的高流量网站，以便
- en: to avoid bloating the Sguil database.
  id: totrans-2041
  prefs: []
  type: TYPE_NORMAL
  zh: 以避免使Sguil数据库膨胀。
- en: If you’re running ELSA, you may want to disable http_agent altogether to
  id: totrans-2042
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你运行的是ELSA，你可能想完全禁用http_agent，以便
- en: prevent duplication of effort, since all Bro HTTP logs can be found in ELSA.
  id: totrans-2043
  prefs: []
  type: TYPE_NORMAL
  zh: 防止重复工作，因为所有Bro HTTP日志都可以在ELSA中找到。
- en: '**pads_agent.conf**'
  id: totrans-2044
  prefs: []
  type: TYPE_NORMAL
  zh: '**pads_agent.conf**'
- en: The *pads_agent.conf* file configures pads_agent, which takes asset data from
  id: totrans-2045
  prefs: []
  type: TYPE_NORMAL
  zh: '*pads_agent.conf*文件配置pads_agent，它从'
- en: PRADS and inserts it into Sguil. You generally don’t need to change any-
  id: totrans-2046
  prefs: []
  type: TYPE_NORMAL
  zh: PRADS并将其插入到Sguil中。通常你不需要更改任何
- en: thing here.
  id: totrans-2047
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的任何内容。
- en: SO Scripts and Configuration **327**
  id: totrans-2048
  prefs: []
  type: TYPE_NORMAL
  zh: SO脚本和配置 **327**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2049
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '**pcap_agent.conf**'
  id: totrans-2050
  prefs: []
  type: TYPE_NORMAL
  zh: '**pcap_agent.conf**'
- en: The *pcap_agent.conf* file configures the pcap_agent, which allows the Sguil
  id: totrans-2051
  prefs: []
  type: TYPE_NORMAL
  zh: '*pcap_agent.conf*文件配置pcap_agent，它允许Sguil'
- en: server to request a pcap from the sensor’s pcap store. You probably won’t
  id: totrans-2052
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器请求从传感器的pcap存储中获取一个pcap文件。你可能不会
- en: need to change anything here.
  id: totrans-2053
  prefs: []
  type: TYPE_NORMAL
  zh: 这里可能需要更改的内容。
- en: '**prads.conf**'
  id: totrans-2054
  prefs: []
  type: TYPE_NORMAL
  zh: '**prads.conf**'
- en: The *prads.conf* file configures PRADS, a replacement for PADS and SANCP.
  id: totrans-2055
  prefs: []
  type: TYPE_NORMAL
  zh: '*prads.conf*文件配置PRADS，它是PADS和SANCP的替代品。'
- en: PRADS creates both asset data and session data. If you’re monitoring
  id: totrans-2056
  prefs: []
  type: TYPE_NORMAL
  zh: PRADS创建了资产数据和会话数据。如果你正在监控
- en: anything other than RFC 1918 address ranges, update the home_nets variable
  id: totrans-2057
  prefs: []
  type: TYPE_NORMAL
  zh: 如果是RFC 1918地址范围以外的内容，请更新home_nets变量。
- en: in this file.
  id: totrans-2058
  prefs: []
  type: TYPE_NORMAL
  zh: 在此文件中。
- en: '**sancp_agent.conf**'
  id: totrans-2059
  prefs: []
  type: TYPE_NORMAL
  zh: '**sancp_agent.conf**'
- en: The *sancp_agent.conf* file configures the sancp_agent, which takes session
    data from PRADS and inserts it into Sguil. You probably won’t need to change
  id: totrans-2060
  prefs: []
  type: TYPE_NORMAL
  zh: '*sancp_agent.conf*文件配置sancp_agent，它从PRADS获取会话数据并将其插入到Sguil中。你可能不需要更改'
- en: anything here.
  id: totrans-2061
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的任何内容。
- en: '**sensor.conf**'
  id: totrans-2062
  prefs: []
  type: TYPE_NORMAL
  zh: '**sensor.conf**'
- en: The *sensor.conf* file contains a few different variables referenced by the
    NSM
  id: totrans-2063
  prefs: []
  type: TYPE_NORMAL
  zh: '*sensor.conf*文件包含NSM引用的几个不同变量。'
- en: scripts when starting processes. Most settings should remain at their default,
  id: totrans-2064
  prefs: []
  type: TYPE_NORMAL
  zh: 启动进程时使用的脚本。大多数设置应该保持默认状态。
- en: but you may need to tune IDS_LB_PROCS, which controls how many PF_RING
  id: totrans-2065
  prefs: []
  type: TYPE_NORMAL
  zh: 但是，你可能需要调整IDS_LB_PROCS，它控制PF_RING的数量。
- en: load-balanced processes are instantiated for Snort and Suricata. The setup
  id: totrans-2066
  prefs: []
  type: TYPE_NORMAL
  zh: 为Snort和Suricata实例化负载均衡进程。设置
- en: wizard will automatically ask you how many PF_RING instances you would like
  id: totrans-2067
  prefs: []
  type: TYPE_NORMAL
  zh: 向导会自动询问你希望创建多少个PF_RING实例。
- en: for Snort or Suricata and Bro (assuming you choose Advanced Setup and
  id: totrans-2068
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 Snort 或 Suricata 和 Bro（假设你选择了高级设置并且
- en: you have multiple cores).
  id: totrans-2069
  prefs: []
  type: TYPE_NORMAL
  zh: 你有多个核心）。
- en: If you need to adjust this setting after setup, stop the NSM processes,
  id: totrans-2070
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你在设置后需要调整这个设置，停止 NSM 进程，
- en: modify the IDS_LB_PROCS variable in *sensor.conf*, and then restart the NSM
    processes. If you’re running Snort, the script automatically spawns $IDS_LB_PROCS
  id: totrans-2071
  prefs: []
  type: TYPE_NORMAL
  zh: 修改 *sensor.conf* 中的 IDS_LB_PROCS 变量，然后重新启动 NSM 进程。如果你正在运行 Snort，脚本会自动生成 $IDS_LB_PROCS
- en: instances of Snort (using PF_RING), barnyard2, and snort_agent. If you’re run-
  id: totrans-2072
  prefs: []
  type: TYPE_NORMAL
  zh: 运行 Snort 实例（使用 PF_RING）、barnyard2 和 snort_agent。如果你正在运行，
- en: ning Suricata, the script automatically copies $IDS_LB_PROCS into *suricata*
  id: totrans-2073
  prefs: []
  type: TYPE_NORMAL
  zh: 运行 Suricata 时，脚本会自动将 $IDS_LB_PROCS 复制到 *suricata*
- en: '*.yaml*, and then Suricata spins up the PF_RING instances itself. Since Suricata
    is managing the PF_RING instances, it creates only one unified2 output, and'
  id: totrans-2074
  prefs: []
  type: TYPE_NORMAL
  zh: '*.yaml*，然后 Suricata 会自动启动 PF_RING 实例。由于 Suricata 管理 PF_RING 实例，它只会创建一个 unified2
    输出，'
- en: therefore only one instance of barnyard2 and snort_agent are needed.
  id: totrans-2075
  prefs: []
  type: TYPE_NORMAL
  zh: 因此只需要一个 barnyard2 和 snort_agent 实例。
- en: In the following example, we start with the default of IDS_LB_PROCS=1,
  id: totrans-2076
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下示例中，我们从 IDS_LB_PROCS=1 的默认设置开始，
- en: increase the setting to 2, and then restart the NSM processes. Notice that we
  id: totrans-2077
  prefs: []
  type: TYPE_NORMAL
  zh: 增加设置为 2，然后重新启动 NSM 进程。请注意，我们
- en: end up with two snort processes, two snort_agent processes, and two barnyard2
  id: totrans-2078
  prefs: []
  type: TYPE_NORMAL
  zh: 最终会有两个 snort 进程，两个 snort_agent 进程和两个 barnyard2
- en: processes.
  id: totrans-2079
  prefs: []
  type: TYPE_NORMAL
  zh: 进程。
- en: $ **sudo nsm_sensor_ps-stop**
  id: totrans-2080
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo nsm_sensor_ps-stop**
- en: 'Stopping: HIDS'
  id: totrans-2081
  prefs: []
  type: TYPE_NORMAL
  zh: 停止中：HIDS
- en: '* stopping: ossec_agent (sguil) [ OK ]'
  id: totrans-2082
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：ossec_agent (sguil) [ OK ]'
- en: 'Stopping: Bro'
  id: totrans-2083
  prefs: []
  type: TYPE_NORMAL
  zh: 停止中：Bro
- en: stopping bro ...
  id: totrans-2084
  prefs: []
  type: TYPE_NORMAL
  zh: 停止 bro ...
- en: 'Stopping: securityonion-eth1'
  id: totrans-2085
  prefs: []
  type: TYPE_NORMAL
  zh: 停止中：securityonion-eth1
- en: '* stopping: netsniff-ng (full packet data) [ OK ]'
  id: totrans-2086
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：netsniff-ng (完整数据包) [ OK ]'
- en: '* stopping: pcap_agent (sguil) [ OK ]'
  id: totrans-2087
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：pcap_agent (sguil) [ OK ]'
- en: '* stopping: snort_agent-1 (sguil) [ OK ]'
  id: totrans-2088
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：snort_agent-1 (sguil) [ OK ]'
- en: '**328** Appendix'
  id: totrans-2089
  prefs: []
  type: TYPE_NORMAL
  zh: '**328** 附录'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2090
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '* stopping: snort-1 (alert data) [ OK ]'
  id: totrans-2091
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：snort-1 (alert data) [ OK ]'
- en: '* stopping: barnyard2-1 (spooler, unified2 format) [ OK ]'
  id: totrans-2092
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：barnyard2-1 (spooler, unified2 格式) [ OK ]'
- en: '* stopping: prads (sessions/assets) [ OK ]'
  id: totrans-2093
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：prads (sessions/assets) [ OK ]'
- en: '* stopping: sancp_agent (sguil) [ OK ]'
  id: totrans-2094
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：sancp_agent (sguil) [ OK ]'
- en: '* stopping: pads_agent (sguil) [ OK ]'
  id: totrans-2095
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：pads_agent (sguil) [ OK ]'
- en: '* stopping: argus [ OK ]'
  id: totrans-2096
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：argus [ OK ]'
- en: '* stopping: http_agent (sguil) [ OK ]'
  id: totrans-2097
  prefs: []
  type: TYPE_NORMAL
  zh: '* 停止中：http_agent (sguil) [ OK ]'
- en: $ **sudo sed -i 's|IDS_LB_PROCS=1|IDS_LB_PROCS=2|g' /etc/nsm/securityonion-eth1/**
  id: totrans-2098
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo sed -i 's|IDS_LB_PROCS=1|IDS_LB_PROCS=2|g' /etc/nsm/securityonion-eth1/**
- en: '**sensor.conf**'
  id: totrans-2099
  prefs: []
  type: TYPE_NORMAL
  zh: '**sensor.conf**'
- en: $ **sudo nsm_sensor_ps-start**
  id: totrans-2100
  prefs: []
  type: TYPE_NORMAL
  zh: $ **sudo nsm_sensor_ps-start**
- en: 'Starting: HIDS'
  id: totrans-2101
  prefs: []
  type: TYPE_NORMAL
  zh: 启动中：HIDS
- en: '* starting: ossec_agent (sguil) [ OK ]'
  id: totrans-2102
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：ossec_agent (sguil) [ OK ]'
- en: 'Starting: Bro'
  id: totrans-2103
  prefs: []
  type: TYPE_NORMAL
  zh: 启动中：Bro
- en: starting bro ...
  id: totrans-2104
  prefs: []
  type: TYPE_NORMAL
  zh: 启动 bro ...
- en: 'Starting: securityonion-eth1'
  id: totrans-2105
  prefs: []
  type: TYPE_NORMAL
  zh: 启动中：securityonion-eth1
- en: '* starting: netsniff-ng (full packet data) [ OK ]'
  id: totrans-2106
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：netsniff-ng (完整数据包) [ OK ]'
- en: '* starting: pcap_agent (sguil) [ OK ]'
  id: totrans-2107
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：pcap_agent (sguil) [ OK ]'
- en: '* starting: snort_agent-1 (sguil) [ OK ]'
  id: totrans-2108
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：snort_agent-1 (sguil) [ OK ]'
- en: '* starting: snort_agent-2 (sguil) [ OK ]'
  id: totrans-2109
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：snort_agent-2 (sguil) [ OK ]'
- en: '* starting: snort-1 (alert data) [ OK ]'
  id: totrans-2110
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：snort-1 (alert data) [ OK ]'
- en: '* starting: snort-2 (alert data) [ OK ]'
  id: totrans-2111
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：snort-2 (alert data) [ OK ]'
- en: '* starting: barnyard2-1 (spooler, unified2 format) [ OK ]'
  id: totrans-2112
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：barnyard2-1 (spooler, unified2 格式) [ OK ]'
- en: '* starting: barnyard2-2 (spooler, unified2 format) [ OK ]'
  id: totrans-2113
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：barnyard2-2 (spooler, unified2 格式) [ OK ]'
- en: '* starting: prads (sessions/assets) [ OK ]'
  id: totrans-2114
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：prads (sessions/assets) [ OK ]'
- en: '* starting: pads_agent (sguil) [ OK ]'
  id: totrans-2115
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：pads_agent (sguil) [ OK ]'
- en: '* starting: sancp_agent (sguil) [ OK ]'
  id: totrans-2116
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：sancp_agent (sguil) [ OK ]'
- en: '* starting: argus [ OK ]'
  id: totrans-2117
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：argus [ OK ]'
- en: '* starting: http_agent (sguil) [ OK ]'
  id: totrans-2118
  prefs: []
  type: TYPE_NORMAL
  zh: '* 启动中：http_agent (sguil) [ OK ]'
- en: '* disk space currently at 26%'
  id: totrans-2119
  prefs: []
  type: TYPE_NORMAL
  zh: '* 当前磁盘空间 26%'
- en: As a sidenote, if you want to change the number of load-balanced pro-
  id: totrans-2120
  prefs: []
  type: TYPE_NORMAL
  zh: 顺便说一下，如果你想改变负载均衡的数量，
- en: cesses for Bro, edit */opt/bro/etc/node.cfg* and change the lb_procs variable,
  id: totrans-2121
  prefs: []
  type: TYPE_NORMAL
  zh: 要改变 Bro 的进程，编辑 */opt/bro/etc/node.cfg* 并更改 lb_procs 变量，
- en: 'and then issue the following commands:'
  id: totrans-2122
  prefs: []
  type: TYPE_NORMAL
  zh: 然后执行以下命令：
- en: '**sudo broctl install**'
  id: totrans-2123
  prefs: []
  type: TYPE_NORMAL
  zh: '**sudo broctl install**'
- en: '**sudo broctl restart**'
  id: totrans-2124
  prefs: []
  type: TYPE_NORMAL
  zh: '**sudo broctl restart**'
- en: '**snort_agent.conf**'
  id: totrans-2125
  prefs: []
  type: TYPE_NORMAL
  zh: '**snort_agent.conf**'
- en: The *snort_agent.conf* file configures the snort_agent, which takes alerts from
    barnyard2 and inserts them into the Sguil database. You probably don’t need
  id: totrans-2126
  prefs: []
  type: TYPE_NORMAL
  zh: '*snort_agent.conf* 文件配置了 snort_agent，它从 barnyard2 获取警报并将其插入 Sguil 数据库。你可能不需要'
- en: to change anything here.
  id: totrans-2127
  prefs: []
  type: TYPE_NORMAL
  zh: 不需要在这里更改任何内容。
- en: There may be multiple *snort_agent.conf* files to handle multiple instances
  id: totrans-2128
  prefs: []
  type: TYPE_NORMAL
  zh: 可能有多个 *snort_agent.conf* 文件来处理多个实例
- en: of Snort.
  id: totrans-2129
  prefs: []
  type: TYPE_NORMAL
  zh: Snort 的
- en: '**snort.conf**'
  id: totrans-2130
  prefs: []
  type: TYPE_NORMAL
  zh: '**snort.conf**'
- en: The *snort.conf* file configures Snort. Even if you’ve set IDS_LB_PROCS greater
    than 1, there will be only one *snort.conf* file, to ensure that Snort instances
    on the same interface are configured identically.
  id: totrans-2131
  prefs: []
  type: TYPE_NORMAL
  zh: '*snort.conf* 文件配置了 Snort。即使你将 IDS_LB_PROCS 设置为大于 1，仍然只有一个 *snort.conf* 文件，以确保同一接口上的
    Snort 实例配置一致。'
- en: SO Scripts and Configuration **329**
  id: totrans-2132
  prefs: []
  type: TYPE_NORMAL
  zh: SO 脚本和配置 **329**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2133
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '**suricata.yaml**'
  id: totrans-2134
  prefs: []
  type: TYPE_NORMAL
  zh: '**suricata.yaml**'
- en: The *suricata.yaml* file configures Suricata. The NSM scripts copy $IDS_LB_PROCS
  id: totrans-2135
  prefs: []
  type: TYPE_NORMAL
  zh: '*suricata.yaml* 文件配置了 Suricata。NSM 脚本会复制 $IDS_LB_PROCS'
- en: from *sensor.conf* into *suricata.yaml*, and then Suricata spins up the PF_RING
  id: totrans-2136
  prefs: []
  type: TYPE_NORMAL
  zh: 从 *sensor.conf* 转移到 *suricata.yaml*，然后 Suricata 启动 PF_RING
- en: instances itself.
  id: totrans-2137
  prefs: []
  type: TYPE_NORMAL
  zh: 实例本身。
- en: '***/etc/cron.d/***'
  id: totrans-2138
  prefs: []
  type: TYPE_NORMAL
  zh: '***/etc/cron.d/***'
- en: The */etc/cron.d/* directory contains some important cronjobs, so let’s look
    at each of these.
  id: totrans-2139
  prefs: []
  type: TYPE_NORMAL
  zh: '*/etc/cron.d/* 目录包含一些重要的定时任务，我们来看一下每个任务。'
- en: '**bro** This cronjob runs the recommended broctl cron every five minutes'
  id: totrans-2140
  prefs: []
  type: TYPE_NORMAL
  zh: '**bro** 这个定时任务每五分钟运行一次推荐的 broctl 定时任务'
- en: to ensure that Bro is running properly.
  id: totrans-2141
  prefs: []
  type: TYPE_NORMAL
  zh: 以确保 Bro 正常运行。
- en: '**elsa** This cronjob runs the default ELSA cronjob every minute.'
  id: totrans-2142
  prefs: []
  type: TYPE_NORMAL
  zh: '**elsa** 这个定时任务每分钟运行默认的 ELSA 定时任务。'
- en: '**nsm-watchdog** This cronjob checks the NSM sensor processes every five'
  id: totrans-2143
  prefs: []
  type: TYPE_NORMAL
  zh: '**nsm-watchdog** 该定时任务每五分钟检查一次 NSM 传感器进程'
- en: minutes, and restarts them if they have failed.
  id: totrans-2144
  prefs: []
  type: TYPE_NORMAL
  zh: 分钟，如果它们失败，则重新启动它们。
- en: '**rule-update** This cronjob runs rule-update at 7:01 am Universal Coordinated'
  id: totrans-2145
  prefs: []
  type: TYPE_NORMAL
  zh: '**rule-update** 这个定时任务在协调世界时 7:01 AM 运行规则更新'
- en: Time (UTC). If the NSM box is a stand-alone or server, rule-update will
  id: totrans-2146
  prefs: []
  type: TYPE_NORMAL
  zh: 时间（UTC）。如果 NSM 盒子是独立或服务器模式，规则更新将
- en: use PulledPork to download a new IDS ruleset from the Internet. If the
  id: totrans-2147
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 PulledPork 从互联网下载新的 IDS 规则集。如果
- en: box is a sensor, it will wait a few minutes for the server download to com-
  id: totrans-2148
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 NSM 盒子是传感器，它会等待几分钟，直到服务器下载完成
- en: plete, and then use scp to copy the new IDS ruleset from the server to the
  id: totrans-2149
  prefs: []
  type: TYPE_NORMAL
  zh: 完成后，使用 scp 从服务器将新的 IDS 规则集复制到
- en: local sensor. This script also copies tuning files such as *threshold.conf*
    and *bpf.conf*, allowing you to make changes in one place (your central server)
  id: totrans-2150
  prefs: []
  type: TYPE_NORMAL
  zh: 本地传感器。该脚本还会复制调优文件，如 *threshold.conf* 和 *bpf.conf*，让你可以在一个地方（你的中央服务器）进行更改
- en: that will apply to all of your distributed sensors automatically.
  id: totrans-2151
  prefs: []
  type: TYPE_NORMAL
  zh: 将自动应用于你所有分布式传感器的规则。
- en: '**sensor-clean** This is an hourly cronjob that prevents full packet capture'
  id: totrans-2152
  prefs: []
  type: TYPE_NORMAL
  zh: '**sensor-clean** 这是一个每小时运行的定时任务，用于防止完整数据包捕获'
- en: and other logfiles from filling your disk. If disk usage is above 90 per-
  id: totrans-2153
  prefs: []
  type: TYPE_NORMAL
  zh: 以及其他日志文件，防止它们占满你的磁盘。如果磁盘使用率超过 90%，
- en: cent, the oldest day’s worth of NSM data (pcaps, Bro logs, and so on)
  id: totrans-2154
  prefs: []
  type: TYPE_NORMAL
  zh: 如果磁盘使用率超过 90%，则会删除最旧的一天的 NSM 数据（pcaps、Bro 日志等）
- en: are deleted. This is repeated until the disk usage is below 90 percent.
  id: totrans-2155
  prefs: []
  type: TYPE_NORMAL
  zh: 被删除。这一过程会重复，直到磁盘使用率降到 90% 以下。
- en: '**sensor-newday** This daily cronjob runs at midnight to restart any services'
  id: totrans-2156
  prefs: []
  type: TYPE_NORMAL
  zh: '**sensor-newday** 这个每天运行的定时任务在午夜重启任何服务'
- en: that may be dealing with date-based output and need to roll to a new
  id: totrans-2157
  prefs: []
  type: TYPE_NORMAL
  zh: 可能需要处理基于日期的输出，并需要切换到新的一天
- en: date stamp.
  id: totrans-2158
  prefs: []
  type: TYPE_NORMAL
  zh: 日期戳。
- en: '**sguil-db-purge** This daily cronjob runs at 5:01 am UTC and performs'
  id: totrans-2159
  prefs: []
  type: TYPE_NORMAL
  zh: '**sguil-db-purge** 这个每天运行的定时任务在 UTC 时间 5:01 AM 运行并执行'
- en: database maintenance, including deleting any data older than $DAYSTOKEEP
  id: totrans-2160
  prefs: []
  type: TYPE_NORMAL
  zh: 数据库维护，包括删除任何超过 $DAYSTOKEEP 的旧数据
- en: (as defined in */etc/nsm/securityonion.conf*) and repairing any corrupted
  id: totrans-2161
  prefs: []
  type: TYPE_NORMAL
  zh: （如在 */etc/nsm/securityonion.conf* 中定义）并修复任何损坏的
- en: MySQL tables.
  id: totrans-2162
  prefs: []
  type: TYPE_NORMAL
  zh: MySQL 表。
- en: '**squert-ip2c** This cronjob updates Squert’s IP-to-country (GeoIP)'
  id: totrans-2163
  prefs: []
  type: TYPE_NORMAL
  zh: '**squert-ip2c** 这个定时任务更新 Squert 的 IP 到国家（GeoIP）映射'
- en: mappings.
  id: totrans-2164
  prefs: []
  type: TYPE_NORMAL
  zh: 映射。
- en: '***Bro***'
  id: totrans-2165
  prefs: []
  type: TYPE_NORMAL
  zh: '***Bro***'
- en: Bro is installed in */opt/bro/* and its configuration files can be found in
  id: totrans-2166
  prefs: []
  type: TYPE_NORMAL
  zh: Bro 安装在 */opt/bro/* 目录下，其配置文件可以在以下位置找到
- en: '*/opt/bro/etc/*.'
  id: totrans-2167
  prefs: []
  type: TYPE_NORMAL
  zh: '*/opt/bro/etc/*。'
- en: '**330** Appendix'
  id: totrans-2168
  prefs: []
  type: TYPE_NORMAL
  zh: '**330** 附录'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2169
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '***CapMe***'
  id: totrans-2170
  prefs: []
  type: TYPE_NORMAL
  zh: '***CapMe***'
- en: CapMe is a PHP-based web interface used to pull ASCII transcripts of TCP
  id: totrans-2171
  prefs: []
  type: TYPE_NORMAL
  zh: CapMe 是一个基于 PHP 的 Web 界面，用于提取 TCP 的 ASCII 转录
- en: sessions. Its PHP scripts and other resource files can be found in */var/www/*
  id: totrans-2172
  prefs: []
  type: TYPE_NORMAL
  zh: 会话。其 PHP 脚本和其他资源文件可以在 */var/www/* 目录下找到
- en: '*capme/*. Generally, these files do not need to be modified.'
  id: totrans-2173
  prefs: []
  type: TYPE_NORMAL
  zh: '*capme/*。通常，这些文件无需修改。'
- en: '***ELSA***'
  id: totrans-2174
  prefs: []
  type: TYPE_NORMAL
  zh: '***ELSA***'
- en: ELSA’s core files can be found in */opt/elsa/*. Generally, you may need to
  id: totrans-2175
  prefs: []
  type: TYPE_NORMAL
  zh: ELSA 的核心文件位于 */opt/elsa/* 目录下。通常你可能需要
- en: 'modify settings in its two main configuration files:'
  id: totrans-2176
  prefs: []
  type: TYPE_NORMAL
  zh: 修改其两个主要配置文件中的设置：
- en: '***/etc/elsa_web.conf*** This file configures the Apache web frontend of'
  id: totrans-2177
  prefs: []
  type: TYPE_NORMAL
  zh: '***/etc/elsa_web.conf*** 该文件配置了 ELSA 的 Apache Web 前端'
- en: ELSA. It will be present if you chose a stand-alone or server installation
  id: totrans-2178
  prefs: []
  type: TYPE_NORMAL
  zh: ELSA。如果你选择了独立或服务器安装，它将出现
- en: and chose to enable ELSA.
  id: totrans-2179
  prefs: []
  type: TYPE_NORMAL
  zh: 并选择启用 ELSA。
- en: '***/etc/elsa_node.conf*** This file configures the log node backend of ELSA.'
  id: totrans-2180
  prefs: []
  type: TYPE_NORMAL
  zh: '***/etc/elsa_node.conf*** 此文件配置 ELSA 的日志节点后端。'
- en: It will be present if you chose a stand-alone or sensor installation and
  id: totrans-2181
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你选择了独立或传感器安装，它将会存在
- en: enabled ELSA.
  id: totrans-2182
  prefs: []
  type: TYPE_NORMAL
  zh: 已启用 ELSA。
- en: '***Squert***'
  id: totrans-2183
  prefs: []
  type: TYPE_NORMAL
  zh: '***Squert***'
- en: Squert is a web interface for the Sguil database written in PHP. The PHP
  id: totrans-2184
  prefs: []
  type: TYPE_NORMAL
  zh: Squert 是一个为 Sguil 数据库编写的 Web 界面，使用 PHP。PHP
- en: scripts and other resource files can be found in */var/www/squert/*. You gen-
  id: totrans-2185
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本和其他资源文件可以在 */var/www/squert/* 中找到。你通常
- en: erally don’t need to modify anything in this directory.
  id: totrans-2186
  prefs: []
  type: TYPE_NORMAL
  zh: 通常不需要修改该目录中的任何内容。
- en: '***Snorby***'
  id: totrans-2187
  prefs: []
  type: TYPE_NORMAL
  zh: '***Snorby***'
- en: Snorby is a web interface for IDS alerts written using Ruby on Rails. Its
  id: totrans-2188
  prefs: []
  type: TYPE_NORMAL
  zh: Snorby 是一个使用 Ruby on Rails 编写的 IDS 警报的 Web 界面。它的
- en: scripts and other resource files can be found in */opt/snorby/*. Configuration
  id: totrans-2189
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本和其他资源文件可以在 */opt/snorby/* 中找到。配置
- en: files can be found in */opt/snorby/config/*.
  id: totrans-2190
  prefs: []
  type: TYPE_NORMAL
  zh: 配置文件可以在 */opt/snorby/config/* 找到。
- en: '***Syslog-ng***'
  id: totrans-2191
  prefs: []
  type: TYPE_NORMAL
  zh: '***Syslog-ng***'
- en: Syslog-ng is used by ELSA, and its configuration files can be found in
  id: totrans-2192
  prefs: []
  type: TYPE_NORMAL
  zh: Syslog-ng 被 ELSA 使用，其配置文件可以在
- en: '*/etc/syslog-ng/*.'
  id: totrans-2193
  prefs: []
  type: TYPE_NORMAL
  zh: '*/etc/syslog-ng/*。'
- en: '***/etc/network/interfaces***'
  id: totrans-2194
  prefs: []
  type: TYPE_NORMAL
  zh: '***/etc/network/interfaces***'
- en: The */etc/network/interfaces* file configures your network interfaces. The
  id: totrans-2195
  prefs: []
  type: TYPE_NORMAL
  zh: '*/etc/network/interfaces* 文件配置你的网络接口。该'
- en: setup wizard will automatically configure this file for you if you choose
  id: totrans-2196
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你选择该选项，设置向导将自动为你配置此文件
- en: '**Yes, configure /etc/network/interfaces**.'
  id: totrans-2197
  prefs: []
  type: TYPE_NORMAL
  zh: '**是的，配置 /etc/network/interfaces**。'
- en: You’ll want a management interface (preferably connected to a dedi-
  id: totrans-2198
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要一个管理接口（最好连接到一个专用的
- en: cated management network) using either DHCP or preferably static IP. If
  id: totrans-2199
  prefs: []
  type: TYPE_NORMAL
  zh: cated 管理网络）使用 DHCP 或更好的是静态 IP。如果
- en: your management interface uses DHCP and you have Bro in cluster mode,
  id: totrans-2200
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的管理接口使用 DHCP 并且你在集群模式下运行 Bro，
- en: it will complain whenever your DHCP address changes, and you’ll need
  id: totrans-2201
  prefs: []
  type: TYPE_NORMAL
  zh: 它会抱怨每次 DHCP 地址变化时，你需要
- en: to update your IP address in Bro’s *node.cfg* file. A static IP is highly recommended
    to prevent this problem.
  id: totrans-2202
  prefs: []
  type: TYPE_NORMAL
  zh: 更新 Bro 的 *node.cfg* 文件中的 IP 地址。强烈建议使用静态 IP 以防止此问题。
- en: SO Scripts and Configuration **331**
  id: totrans-2203
  prefs: []
  type: TYPE_NORMAL
  zh: SO 脚本和配置 **331**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2204
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: You’ll want one or more interfaces dedicated to sniffing, with no
  id: totrans-2205
  prefs: []
  type: TYPE_NORMAL
  zh: 你将需要一个或多个专门用于嗅探的接口，没有
- en: IP addresses. Network interface card offloading functions such as tso,
  id: totrans-2206
  prefs: []
  type: TYPE_NORMAL
  zh: IP 地址。网络接口卡卸载功能，如 tso，
- en: gso, and gro should be disabled to ensure that Snort and Suricata get an
  id: totrans-2207
  prefs: []
  type: TYPE_NORMAL
  zh: gso 和 gro 应该被禁用，以确保 Snort 和 Suricata 能够得到
- en: accurate view of the traffic (see *http://securityonion.blogspot.com/2011/10/*
  id: totrans-2208
  prefs: []
  type: TYPE_NORMAL
  zh: 准确查看流量（参见 *http://securityonion.blogspot.com/2011/10/*
- en: '*when-is-full-packet-capture-not-full.html*).'
  id: totrans-2209
  prefs: []
  type: TYPE_NORMAL
  zh: '*when-is-full-packet-capture-not-full.html*）。'
- en: The following are some sample *network/interfaces* entries.
  id: totrans-2210
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一些示例 *network/interfaces* 条目。
- en: auto lo
  id: totrans-2211
  prefs: []
  type: TYPE_NORMAL
  zh: 自动 lo
- en: iface lo inet loopback
  id: totrans-2212
  prefs: []
  type: TYPE_NORMAL
  zh: iface lo inet loopback
- en: Management interface using DHCP (not recommended due to Bro issue described
    above)
  id: totrans-2213
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 DHCP 的管理接口（由于上述 Bro 问题，不推荐使用）
- en: auto eth0
  id: totrans-2214
  prefs: []
  type: TYPE_NORMAL
  zh: 自动 eth0
- en: iface eth0 inet dhcp
  id: totrans-2215
  prefs: []
  type: TYPE_NORMAL
  zh: iface eth0 inet dhcp
- en: OR
  id: totrans-2216
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 或
- en: Management interface using STATIC IP (instead of DHCP)
  id: totrans-2217
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用静态 IP 的管理接口（代替 DHCP）
- en: auto eth0
  id: totrans-2218
  prefs: []
  type: TYPE_NORMAL
  zh: 自动 eth0
- en: iface eth0 inet static
  id: totrans-2219
  prefs: []
  type: TYPE_NORMAL
  zh: iface eth0 inet static
- en: address 192.168.1.14
  id: totrans-2220
  prefs: []
  type: TYPE_NORMAL
  zh: 地址 192.168.1.14
- en: gateway 192.168.1.1
  id: totrans-2221
  prefs: []
  type: TYPE_NORMAL
  zh: 网关 192.168.1.1
- en: netmask 255.255.255.0
  id: totrans-2222
  prefs: []
  type: TYPE_NORMAL
  zh: 子网掩码 255.255.255.0
- en: network 192.168.1.0
  id: totrans-2223
  prefs: []
  type: TYPE_NORMAL
  zh: 网络 192.168.1.0
- en: broadcast 192.168.1.255
  id: totrans-2224
  prefs: []
  type: TYPE_NORMAL
  zh: 广播 192.168.1.255
- en: dns-nameservers 192.168.1.1 192.168.1.2
  id: totrans-2225
  prefs: []
  type: TYPE_NORMAL
  zh: dns-nameservers 192.168.1.1 192.168.1.2
- en: AND one or more of the following
  id: totrans-2226
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 和以下之一或多个
- en: Connected to TAP or SPAN port for traffic monitoring
  id: totrans-2227
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 连接到 TAP 或 SPAN 端口进行流量监控
- en: auto eth1
  id: totrans-2228
  prefs: []
  type: TYPE_NORMAL
  zh: 自动 eth1
- en: iface eth1 inet manual
  id: totrans-2229
  prefs: []
  type: TYPE_NORMAL
  zh: iface eth1 inet manual
- en: up ifconfig $IFACE -arp up
  id: totrans-2230
  prefs: []
  type: TYPE_NORMAL
  zh: 上 ifconfig $IFACE -arp up
- en: up ip link set $IFACE promisc on
  id: totrans-2231
  prefs: []
  type: TYPE_NORMAL
  zh: 上 ip 链接设置 $IFACE promisc on
- en: down ip link set $IFACE promisc off
  id: totrans-2232
  prefs: []
  type: TYPE_NORMAL
  zh: 关闭 ip 链接设置 $IFACE promisc off
- en: down ifconfig $IFACE down
  id: totrans-2233
  prefs: []
  type: TYPE_NORMAL
  zh: 关闭 ifconfig $IFACE down
- en: post-up for i in rx tx sg tso ufo gso gro lro; do ethtool -K $IFACE $i off;
    done
  id: totrans-2234
  prefs: []
  type: TYPE_NORMAL
  zh: post-up 对于 i in rx tx sg tso ufo gso gro lro; do ethtool -K $IFACE $i off; done
- en: post-up echo 1 > /proc/sys/net/ipv6/conf/$IFACE/disable_ipv6
  id: totrans-2235
  prefs: []
  type: TYPE_NORMAL
  zh: post-up echo 1 > /proc/sys/net/ipv6/conf/$IFACE/disable_ipv6
- en: '**updating So**'
  id: totrans-2236
  prefs: []
  type: TYPE_NORMAL
  zh: '**更新 So**'
- en: 'Two aspects of updating SO deserve mention: keeping the platform up-to-'
  id: totrans-2237
  prefs: []
  type: TYPE_NORMAL
  zh: 更新 SO 的两个方面值得一提：保持平台的更新，
- en: date and keeping MySQL up-to-date.
  id: totrans-2238
  prefs: []
  type: TYPE_NORMAL
  zh: 日期并保持 MySQL 更新。
- en: '***Updating the SO Distribution***'
  id: totrans-2239
  prefs: []
  type: TYPE_NORMAL
  zh: '***更新 SO 分发版***'
- en: Since all SO packages are in a standard Ubuntu Launchpad Personal Package
  id: totrans-2240
  prefs: []
  type: TYPE_NORMAL
  zh: 由于所有 SO 包都在标准的 Ubuntu Launchpad Personal Package
- en: Archive (PPA), you can use standard Ubuntu package management tools to
  id: totrans-2241
  prefs: []
  type: TYPE_NORMAL
  zh: 存档 (PPA)，你可以使用标准的 Ubuntu 包管理工具来
- en: update all packages. You can use the graphical Update Manager, or update
  id: totrans-2242
  prefs: []
  type: TYPE_NORMAL
  zh: 更新所有软件包。你可以使用图形化的更新管理器，或者更新
- en: 'from the command line like this:'
  id: totrans-2243
  prefs: []
  type: TYPE_NORMAL
  zh: 从命令行像这样操作：
- en: '**sudo apt-get update && sudo apt-get dist-upgrade**'
  id: totrans-2244
  prefs: []
  type: TYPE_NORMAL
  zh: '**sudo apt-get update && sudo apt-get dist-upgrade**'
- en: '**332** Appendix'
  id: totrans-2245
  prefs: []
  type: TYPE_NORMAL
  zh: '**332** 附录'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2246
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '***Updating MySQL***'
  id: totrans-2247
  prefs: []
  type: TYPE_NORMAL
  zh: '***更新 MySQL***'
- en: Updating the Ubuntu MySQL packages can be problematic due to autossh
  id: totrans-2248
  prefs: []
  type: TYPE_NORMAL
  zh: 更新 Ubuntu MySQL 软件包可能因 autossh 而出现问题
- en: port forwarding and other issues. Here’s the recommended procedure to
  id: totrans-2249
  prefs: []
  type: TYPE_NORMAL
  zh: 端口转发和其他问题。以下是推荐的操作程序
- en: ensure a smooth MySQL update.
  id: totrans-2250
  prefs: []
  type: TYPE_NORMAL
  zh: 确保顺利的 MySQL 更新。
- en: '1\. Stop all services:'
  id: totrans-2251
  prefs: []
  type: TYPE_NORMAL
  zh: 1\. 停止所有服务：
- en: '**sudo service nsm stop**'
  id: totrans-2252
  prefs: []
  type: TYPE_NORMAL
  zh: '**sudo service nsm stop**'
- en: '**sudo service syslog-ng stop**'
  id: totrans-2253
  prefs: []
  type: TYPE_NORMAL
  zh: '**sudo service syslog-ng stop**'
- en: '**sudo service apache2 stop**'
  id: totrans-2254
  prefs: []
  type: TYPE_NORMAL
  zh: '**sudo service apache2 stop**'
- en: '**sudo pkill autossh**'
  id: totrans-2255
  prefs: []
  type: TYPE_NORMAL
  zh: '**sudo pkill autossh**'
- en: '**sudo pkill perl**'
  id: totrans-2256
  prefs: []
  type: TYPE_NORMAL
  zh: '**sudo pkill perl**'
- en: 2\. Check the process listing and verify that all *nsm/syslog-ng/apache/autossh/*
  id: totrans-2257
  prefs: []
  type: TYPE_NORMAL
  zh: 2\. 检查进程列表，确认所有 *nsm/syslog-ng/apache/autossh/*
- en: '*perl* processes have stopped:'
  id: totrans-2258
  prefs: []
  type: TYPE_NORMAL
  zh: '*perl* 进程已停止：'
- en: '**ps aux**'
  id: totrans-2259
  prefs: []
  type: TYPE_NORMAL
  zh: '**ps aux**'
- en: 3\. Install the MySQL updates. Other updates (such as *securityonion-snorby*)
  id: totrans-2260
  prefs: []
  type: TYPE_NORMAL
  zh: 3\. 安装 MySQL 更新。其他更新（如 *securityonion-snorby*）
- en: 'may require MySQL to be running, so update MySQL by itself:'
  id: totrans-2261
  prefs: []
  type: TYPE_NORMAL
  zh: 可能需要 MySQL 运行，因此单独更新 MySQL：
- en: '**sudo apt-get update && sudo apt-get install mysql-server mysql-server-core-5.5
    mysql-server-5.5**'
  id: totrans-2262
  prefs: []
  type: TYPE_NORMAL
  zh: '**sudo apt-get update && sudo apt-get install mysql-server mysql-server-core-5.5
    mysql-server-5.5**'
- en: '4\. Reboot the system:'
  id: totrans-2263
  prefs: []
  type: TYPE_NORMAL
  zh: 4\. 重启系统：
- en: '**sudo reboot**'
  id: totrans-2264
  prefs: []
  type: TYPE_NORMAL
  zh: '**sudo reboot**'
- en: SO Scripts and Configuration **333**
  id: totrans-2265
  prefs: []
  type: TYPE_NORMAL
  zh: SO 脚本和配置 **333**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2266
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2267
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '**i N D e x**'
  id: totrans-2268
  prefs: []
  type: TYPE_NORMAL
  zh: '**i N D e x**'
- en: '**a**'
  id: totrans-2269
  prefs: []
  type: TYPE_NORMAL
  zh: '**a**'
- en: Argus
  id: totrans-2270
  prefs: []
  type: TYPE_NORMAL
  zh: Argus
- en: as alternative to NetFlow, 202
  id: totrans-2271
  prefs: []
  type: TYPE_NORMAL
  zh: 作为 NetFlow 的替代，202
- en: Address Resolution Protocol (ARP),
  id: totrans-2272
  prefs: []
  type: TYPE_NORMAL
  zh: 地址解析协议（ARP），
- en: counting bytes in session data
  id: totrans-2273
  prefs: []
  type: TYPE_NORMAL
  zh: 计数会话数据中的字节
- en: 16, 140–142
  id: totrans-2274
  prefs: []
  type: TYPE_NORMAL
  zh: 16，140–142
- en: using, 169
  id: totrans-2275
  prefs: []
  type: TYPE_NORMAL
  zh: 使用中，169
- en: address translation, 42–45
  id: totrans-2276
  prefs: []
  type: TYPE_NORMAL
  zh: 地址转换，42–45
- en: as data collection tool, 115
  id: totrans-2277
  prefs: []
  type: TYPE_NORMAL
  zh: 作为数据收集工具，115
- en: '*administration.conf*, 322–323'
  id: totrans-2278
  prefs: []
  type: TYPE_NORMAL
  zh: '*administration.conf*，322–323'
- en: log storage location, 106
  id: totrans-2279
  prefs: []
  type: TYPE_NORMAL
  zh: 日志存储位置，106
- en: administrators, as within IDC, 203–204
  id: totrans-2280
  prefs: []
  type: TYPE_NORMAL
  zh: 管理员，如同 IDC 中，203–204
- en: and Ra client, 128–133
  id: totrans-2281
  prefs: []
  type: TYPE_NORMAL
  zh: 和 Ra 客户端，128–133
- en: Advanced Package Tool (APT), 65
  id: totrans-2282
  prefs: []
  type: TYPE_NORMAL
  zh: 高级包管理工具（APT），65
- en: and Racluster client, 130–132, 248
  id: totrans-2283
  prefs: []
  type: TYPE_NORMAL
  zh: 和 Racluster 客户端，130–132，248
- en: Advanced Persistent Threat (APT), 193
  id: totrans-2284
  prefs: []
  type: TYPE_NORMAL
  zh: 高级持续威胁（APT），193
- en: as source of session data, 22, 248
  id: totrans-2285
  prefs: []
  type: TYPE_NORMAL
  zh: 作为会话数据的来源，22，248
- en: APT1, 193, 202, 277–278\. *See also*
  id: totrans-2286
  prefs: []
  type: TYPE_NORMAL
  zh: APT1，193，202，277–278。*另见*
- en: ARIN (American Registry for Internet
  id: totrans-2287
  prefs: []
  type: TYPE_NORMAL
  zh: ARIN（美国互联网注册机构）
- en: APT1 module
  id: totrans-2288
  prefs: []
  type: TYPE_NORMAL
  zh: APT1 模块
- en: Numbers), 40
  id: totrans-2289
  prefs: []
  type: TYPE_NORMAL
  zh: 数字），40
- en: resources, 190
  id: totrans-2290
  prefs: []
  type: TYPE_NORMAL
  zh: 资源，190
- en: ARP (Address Resolution Protocol),
  id: totrans-2291
  prefs: []
  type: TYPE_NORMAL
  zh: ARP（地址解析协议），
- en: adversary simulation, 187
  id: totrans-2292
  prefs: []
  type: TYPE_NORMAL
  zh: 对手模拟，187
- en: 16, 140–142
  id: totrans-2293
  prefs: []
  type: TYPE_NORMAL
  zh: 16，140–142
- en: Air Force Computer Emergency
  id: totrans-2294
  prefs: []
  type: TYPE_NORMAL
  zh: 空军计算机应急
- en: AS (autonomous system), 28
  id: totrans-2295
  prefs: []
  type: TYPE_NORMAL
  zh: AS（自治系统），28
- en: Response Team
  id: totrans-2296
  prefs: []
  type: TYPE_NORMAL
  zh: 响应团队
- en: ASIM (Automated Security Incident
  id: totrans-2297
  prefs: []
  type: TYPE_NORMAL
  zh: ASIM（自动化安全事件）
- en: (AFCERT), 3
  id: totrans-2298
  prefs: []
  type: TYPE_NORMAL
  zh: （AFCERT），3
- en: Measurement), 3
  id: totrans-2299
  prefs: []
  type: TYPE_NORMAL
  zh: 测量），3
- en: alert data, 28–30
  id: totrans-2300
  prefs: []
  type: TYPE_NORMAL
  zh: 警报数据，28–30
- en: asset-centric security, 199
  id: totrans-2301
  prefs: []
  type: TYPE_NORMAL
  zh: 资产为中心的安全，199
- en: American Registry for Internet
  id: totrans-2302
  prefs: []
  type: TYPE_NORMAL
  zh: 美国互联网注册机构
- en: associate analyst, in ATI, 203–204
  id: totrans-2303
  prefs: []
  type: TYPE_NORMAL
  zh: 在 ATI 中的联席分析师，203–204
- en: Numbers (ARIN), 40
  id: totrans-2304
  prefs: []
  type: TYPE_NORMAL
  zh: 数字（ARIN），40
- en: ATI (Applied Threat Intelligence)
  id: totrans-2305
  prefs: []
  type: TYPE_NORMAL
  zh: ATI（应用威胁情报）
- en: Amin, Rohan, 190
  id: totrans-2306
  prefs: []
  type: TYPE_NORMAL
  zh: 阿敏，罗汉，190
- en: Center, 203–204
  id: totrans-2307
  prefs: []
  type: TYPE_NORMAL
  zh: 中心，203–204
- en: analysis, as element of detection phase,
  id: totrans-2308
  prefs: []
  type: TYPE_NORMAL
  zh: 分析，作为检测阶段的一个元素，
- en: '*autocat.conf*, 324'
  id: totrans-2309
  prefs: []
  type: TYPE_NORMAL
  zh: '*autocat.conf*，324'
- en: 188, 193–195
  id: totrans-2310
  prefs: []
  type: TYPE_NORMAL
  zh: 188，193–195
- en: autonomous system (AS), 28
  id: totrans-2311
  prefs: []
  type: TYPE_NORMAL
  zh: 自治系统（AS），28
- en: “anatomy of a hack,” 190–191
  id: totrans-2312
  prefs: []
  type: TYPE_NORMAL
  zh: “黑客的解剖”，190–191
- en: autossh, as tunnel for SO data, 84,
  id: totrans-2313
  prefs: []
  type: TYPE_NORMAL
  zh: autossh，作为 SO 数据的隧道，84，
- en: Andre, Jen, 305
  id: totrans-2314
  prefs: []
  type: TYPE_NORMAL
  zh: 安德烈，詹，305
- en: 97, 333
  id: totrans-2315
  prefs: []
  type: TYPE_NORMAL
  zh: 97，333
- en: Applied Threat Intelligence (ATI)
  id: totrans-2316
  prefs: []
  type: TYPE_NORMAL
  zh: 应用威胁情报（ATI）
- en: Automated Security Incident
  id: totrans-2317
  prefs: []
  type: TYPE_NORMAL
  zh: 自动化安全事件
- en: Center, 203–204
  id: totrans-2318
  prefs: []
  type: TYPE_NORMAL
  zh: 中心，203–204
- en: Measurement (ASIM), 3
  id: totrans-2319
  prefs: []
  type: TYPE_NORMAL
  zh: 测量（ASIM），3
- en: APT (Advanced Package Tool), 65
  id: totrans-2320
  prefs: []
  type: TYPE_NORMAL
  zh: APT（高级包管理工具），65
- en: APT (Advanced Persistent Threat), 193
  id: totrans-2321
  prefs: []
  type: TYPE_NORMAL
  zh: APT（高级持续威胁），193
- en: APT1, 193, 202, 277–278\. *See also*
  id: totrans-2322
  prefs: []
  type: TYPE_NORMAL
  zh: APT1，193，202，277–278。*另见*
- en: '**B**'
  id: totrans-2323
  prefs: []
  type: TYPE_NORMAL
  zh: '**B**'
- en: APT1 module
  id: totrans-2324
  prefs: []
  type: TYPE_NORMAL
  zh: APT1 模块
- en: Baker, Michael, 306
  id: totrans-2325
  prefs: []
  type: TYPE_NORMAL
  zh: 贝克，迈克尔，306
- en: resources, 190
  id: totrans-2326
  prefs: []
  type: TYPE_NORMAL
  zh: 资源，190
- en: '*barnyard2.conf*, 327'
  id: totrans-2327
  prefs: []
  type: TYPE_NORMAL
  zh: '*barnyard2.conf*，327'
- en: APT1 module, 278
  id: totrans-2328
  prefs: []
  type: TYPE_NORMAL
  zh: APT1 模块，278
- en: Berkeley Packet Filter (BPF), 118–123,
  id: totrans-2329
  prefs: []
  type: TYPE_NORMAL
  zh: 伯克利数据包过滤器（BPF），118–123，
- en: installing, 280
  id: totrans-2330
  prefs: []
  type: TYPE_NORMAL
  zh: 安装中，280
- en: 130, 230, 280
  id: totrans-2331
  prefs: []
  type: TYPE_NORMAL
  zh: 130，230，280
- en: testing, 280–283
  id: totrans-2332
  prefs: []
  type: TYPE_NORMAL
  zh: 测试，280–283
- en: Bianco, David, 32, 193
  id: totrans-2333
  prefs: []
  type: TYPE_NORMAL
  zh: 比安科，大卫，32，193
- en: using, 278–279
  id: totrans-2334
  prefs: []
  type: TYPE_NORMAL
  zh: 使用中，278–279
- en: BPF (Berkeley Packet Filter), 118–123,
  id: totrans-2335
  prefs: []
  type: TYPE_NORMAL
  zh: BPF（伯克利数据包过滤器），118–123，
- en: apt-get
  id: totrans-2336
  prefs: []
  type: TYPE_NORMAL
  zh: apt-get
- en: 130, 230, 280
  id: totrans-2337
  prefs: []
  type: TYPE_NORMAL
  zh: 130，230，280
- en: and configuring SO sensor, 94
  id: totrans-2338
  prefs: []
  type: TYPE_NORMAL
  zh: 和配置 SO 传感器，94
- en: '*bpf-bro.conf*, 327'
  id: totrans-2339
  prefs: []
  type: TYPE_NORMAL
  zh: '*bpf-bro.conf*，327'
- en: installing APT1 module, 280
  id: totrans-2340
  prefs: []
  type: TYPE_NORMAL
  zh: 安装 APT1 模块，280
- en: '*bpf.conf*, 324, 327'
  id: totrans-2341
  prefs: []
  type: TYPE_NORMAL
  zh: '*bpf.conf*，324，327'
- en: and setting up an SO server, 89–90
  id: totrans-2342
  prefs: []
  type: TYPE_NORMAL
  zh: 和设置 SO 服务器，89–90
- en: breaches
  id: totrans-2343
  prefs: []
  type: TYPE_NORMAL
  zh: 漏洞
- en: for updating packages, 64, 77, 80,
  id: totrans-2344
  prefs: []
  type: TYPE_NORMAL
  zh: 更新包的过程，64，77，80，
- en: classification of, 194, 208, 219,
  id: totrans-2345
  prefs: []
  type: TYPE_NORMAL
  zh: 分类，194，208，219，
- en: 88–90, 94, 101
  id: totrans-2346
  prefs: []
  type: TYPE_NORMAL
  zh: 88–90，94，101
- en: 232, 237
  id: totrans-2347
  prefs: []
  type: TYPE_NORMAL
  zh: 232，237
- en: upgrade vs. dist-upgrade, 65–66
  id: totrans-2348
  prefs: []
  type: TYPE_NORMAL
  zh: 升级与 dist-upgrade，65–66
- en: inevitability of, 5
  id: totrans-2349
  prefs: []
  type: TYPE_NORMAL
  zh: 不可避免性，5
- en: architects, as within IDC, 203–204
  id: totrans-2350
  prefs: []
  type: TYPE_NORMAL
  zh: 建筑师，如同 IDC 中，203–204
- en: and notifications, 196–197
  id: totrans-2351
  prefs: []
  type: TYPE_NORMAL
  zh: 和通知，196–197
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2352
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: Bro
  id: totrans-2353
  prefs: []
  type: TYPE_NORMAL
  zh: Bro
- en: cloud computing, 304–307
  id: totrans-2354
  prefs: []
  type: TYPE_NORMAL
  zh: 云计算，304–307
- en: as alternative to NetFlow, 202
  id: totrans-2355
  prefs: []
  type: TYPE_NORMAL
  zh: 作为 NetFlow 的替代方案，202
- en: CloudShark, 308
  id: totrans-2356
  prefs: []
  type: TYPE_NORMAL
  zh: CloudShark，308
- en: APT1 module, 278
  id: totrans-2357
  prefs: []
  type: TYPE_NORMAL
  zh: APT1 模块，278
- en: collection, as element of detection
  id: totrans-2358
  prefs: []
  type: TYPE_NORMAL
  zh: 收集，作为检测元素
- en: installing, 280
  id: totrans-2359
  prefs: []
  type: TYPE_NORMAL
  zh: 安装，280
- en: phase, 188–191
  id: totrans-2360
  prefs: []
  type: TYPE_NORMAL
  zh: 阶段，188–191
- en: testing, 280–283
  id: totrans-2361
  prefs: []
  type: TYPE_NORMAL
  zh: 测试，280–283
- en: Combs, Gerald, 122
  id: totrans-2362
  prefs: []
  type: TYPE_NORMAL
  zh: Combs, Gerald, 122
- en: using, 278–279
  id: totrans-2363
  prefs: []
  type: TYPE_NORMAL
  zh: 使用，278–279
- en: command-and-control (C2) channel,
  id: totrans-2364
  prefs: []
  type: TYPE_NORMAL
  zh: 命令与控制（C2）通道，
- en: '*capture_loss.log*, 243–244'
  id: totrans-2365
  prefs: []
  type: TYPE_NORMAL
  zh: '*capture_loss.log*，243–244'
- en: 190–194, 208, 237, 250–251
  id: totrans-2366
  prefs: []
  type: TYPE_NORMAL
  zh: 190–194, 208, 237, 250–251
- en: checksum validation with, 298–302
  id: totrans-2367
  prefs: []
  type: TYPE_NORMAL
  zh: 校验和验证，298–302
- en: compromises
  id: totrans-2368
  prefs: []
  type: TYPE_NORMAL
  zh: 妥协
- en: creating hashes of executables
  id: totrans-2369
  prefs: []
  type: TYPE_NORMAL
  zh: 创建可执行文件的哈希值
- en: client-side, 235–237
  id: totrans-2370
  prefs: []
  type: TYPE_NORMAL
  zh: 客户端，235–237
- en: with, 264
  id: totrans-2371
  prefs: []
  type: TYPE_NORMAL
  zh: 与，264
- en: phases of, 190
  id: totrans-2372
  prefs: []
  type: TYPE_NORMAL
  zh: 阶段，190
- en: counting bytes in session data, 169
  id: totrans-2373
  prefs: []
  type: TYPE_NORMAL
  zh: 计算会话数据中的字节数，169
- en: server-side, 207–208
  id: totrans-2374
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器端，207–208
- en: as data collection tool, 115
  id: totrans-2375
  prefs: []
  type: TYPE_NORMAL
  zh: 作为数据收集工具，115
- en: computer incident response team
  id: totrans-2376
  prefs: []
  type: TYPE_NORMAL
  zh: 计算机事件响应团队
- en: DNS logs generated by, 225–226,
  id: totrans-2377
  prefs: []
  type: TYPE_NORMAL
  zh: DNS 日志由其生成，225–226,
- en: (CIRT), 4, 203–205
  id: totrans-2378
  prefs: []
  type: TYPE_NORMAL
  zh: （CIRT），4, 203–205
- en: 244–246
  id: totrans-2379
  prefs: []
  type: TYPE_NORMAL
  zh: 244–246
- en: '*conn.log*, as generated by Bro, 21,'
  id: totrans-2380
  prefs: []
  type: TYPE_NORMAL
  zh: '*conn.log*，由 Bro 生成，21,'
- en: extracting binaries with, 266–273
  id: totrans-2381
  prefs: []
  type: TYPE_NORMAL
  zh: 提取二进制文件，266–273
- en: 242–243
  id: totrans-2382
  prefs: []
  type: TYPE_NORMAL
  zh: 242–243
- en: FTP logs generated by, 228–229
  id: totrans-2383
  prefs: []
  type: TYPE_NORMAL
  zh: FTP 日志由其生成，228–229
- en: Constituent Relations Team, 203, 205
  id: totrans-2384
  prefs: []
  type: TYPE_NORMAL
  zh: 成员关系团队，203, 205
- en: integration with Malware Hash
  id: totrans-2385
  prefs: []
  type: TYPE_NORMAL
  zh: 与恶意软件哈希的集成
- en: containment
  id: totrans-2386
  prefs: []
  type: TYPE_NORMAL
  zh: 隔离
- en: Registry, 285–288
  id: totrans-2387
  prefs: []
  type: TYPE_NORMAL
  zh: 注册表，285–288
- en: speed of, 199–200
  id: totrans-2388
  prefs: []
  type: TYPE_NORMAL
  zh: 速度，199–200
- en: log storage location for, 106
  id: totrans-2389
  prefs: []
  type: TYPE_NORMAL
  zh: 日志存储位置，106
- en: techniques for, 198
  id: totrans-2390
  prefs: []
  type: TYPE_NORMAL
  zh: 技术，198
- en: restarting with broctl, 275–277, 283,
  id: totrans-2391
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 broctl 重新启动，275–277, 283,
- en: continuous monitoring, 8–9
  id: totrans-2392
  prefs: []
  type: TYPE_NORMAL
  zh: 持续监控，8–9
- en: 329–330
  id: totrans-2393
  prefs: []
  type: TYPE_NORMAL
  zh: 329–330
- en: Costa, Gianluca, 147
  id: totrans-2394
  prefs: []
  type: TYPE_NORMAL
  zh: Costa, Gianluca, 147
- en: as source of HTTP transaction data
  id: totrans-2395
  prefs: []
  type: TYPE_NORMAL
  zh: 作为 HTTP 事务数据的来源
- en: cron, for periodic execution of
  id: totrans-2396
  prefs: []
  type: TYPE_NORMAL
  zh: cron，用于定期执行
- en: in Sguil, 165, 167
  id: totrans-2397
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Sguil 中，165, 167
- en: commands, 107, 330
  id: totrans-2398
  prefs: []
  type: TYPE_NORMAL
  zh: 命令，107, 330
- en: as source of logs in ELSA, 178–180,
  id: totrans-2399
  prefs: []
  type: TYPE_NORMAL
  zh: 作为 ELSA 中日志的来源，178–180,
- en: cronjobs, to execute commands,
  id: totrans-2400
  prefs: []
  type: TYPE_NORMAL
  zh: cronjobs，用于执行命令，
- en: 240, 242
  id: totrans-2401
  prefs: []
  type: TYPE_NORMAL
  zh: 240, 242
- en: 316–317, 325, 330
  id: totrans-2402
  prefs: []
  type: TYPE_NORMAL
  zh: 316–317, 325, 330
- en: as source of session data, 21
  id: totrans-2403
  prefs: []
  type: TYPE_NORMAL
  zh: 作为会话数据来源，21
- en: as source of transaction data, 22–23
  id: totrans-2404
  prefs: []
  type: TYPE_NORMAL
  zh: 作为事务数据来源，22–23
- en: '**D**'
  id: totrans-2405
  prefs: []
  type: TYPE_NORMAL
  zh: '**D**'
- en: SSH logs generated by, 226–227
  id: totrans-2406
  prefs: []
  type: TYPE_NORMAL
  zh: SSH 日志由其生成，226–227
- en: Bullard, Carter, 128
  id: totrans-2407
  prefs: []
  type: TYPE_NORMAL
  zh: Bullard, Carter, 128
- en: datatypes, 16, 160
  id: totrans-2408
  prefs: []
  type: TYPE_NORMAL
  zh: 数据类型，16, 160
- en: Burks, Doug, 55, 167
  id: totrans-2409
  prefs: []
  type: TYPE_NORMAL
  zh: Burks, Doug, 55, 167
- en: alert data, 28–30
  id: totrans-2410
  prefs: []
  type: TYPE_NORMAL
  zh: 警报数据，28–30
- en: extracted content data, 19–20
  id: totrans-2411
  prefs: []
  type: TYPE_NORMAL
  zh: 提取的内容数据，19–20
- en: '**C**'
  id: totrans-2412
  prefs: []
  type: TYPE_NORMAL
  zh: '**C**'
- en: full content data, 16–18
  id: totrans-2413
  prefs: []
  type: TYPE_NORMAL
  zh: 完整的内容数据，16–18
- en: metadata, 26–28
  id: totrans-2414
  prefs: []
  type: TYPE_NORMAL
  zh: 元数据，26–28
- en: campaigns, for tracking adversary
  id: totrans-2415
  prefs: []
  type: TYPE_NORMAL
  zh: 用于跟踪对手的活动
- en: session data, 21–22
  id: totrans-2416
  prefs: []
  type: TYPE_NORMAL
  zh: 会话数据，21–22
- en: activity, 199–201
  id: totrans-2417
  prefs: []
  type: TYPE_NORMAL
  zh: 活动，199–201
- en: statistical data, 24–26
  id: totrans-2418
  prefs: []
  type: TYPE_NORMAL
  zh: 统计数据，24–26
- en: CapMe
  id: totrans-2419
  prefs: []
  type: TYPE_NORMAL
  zh: CapMe
- en: transaction data, 22–23
  id: totrans-2420
  prefs: []
  type: TYPE_NORMAL
  zh: 事务数据，22–23
- en: as accessed from ELSA, 180,
  id: totrans-2421
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 ELSA 访问，180,
- en: date command, translating Unix
  id: totrans-2422
  prefs: []
  type: TYPE_NORMAL
  zh: 日期命令，翻译 Unix
- en: 250–251
  id: totrans-2423
  prefs: []
  type: TYPE_NORMAL
  zh: 250–251
- en: epoch to human readable
  id: totrans-2424
  prefs: []
  type: TYPE_NORMAL
  zh: 从纪元到人类可读格式
- en: as accessed from Snorby, 174–177
  id: totrans-2425
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 Snorby 访问，174–177
- en: format, 106
  id: totrans-2426
  prefs: []
  type: TYPE_NORMAL
  zh: 格式，106
- en: as data delivery tool, 115
  id: totrans-2427
  prefs: []
  type: TYPE_NORMAL
  zh: 作为数据传输工具，115
- en: DAYSTOKEEP variable, 108
  id: totrans-2428
  prefs: []
  type: TYPE_NORMAL
  zh: DAYSTOKEEP 变量，108
- en: CIRT (computer incident response
  id: totrans-2429
  prefs: []
  type: TYPE_NORMAL
  zh: CIRT（计算机事件响应团队）
- en: De Francheschi, Andrea, 147
  id: totrans-2430
  prefs: []
  type: TYPE_NORMAL
  zh: De Francheschi, Andrea, 147
- en: team), 4, 203–205
  id: totrans-2431
  prefs: []
  type: TYPE_NORMAL
  zh: 团队），4, 203–205
- en: defensible network architecture, 196
  id: totrans-2432
  prefs: []
  type: TYPE_NORMAL
  zh: 可防御的网络架构，196
- en: checksums
  id: totrans-2433
  prefs: []
  type: TYPE_NORMAL
  zh: 校验和
- en: demilitarized zone (DMZ), 11, 37–46
  id: totrans-2434
  prefs: []
  type: TYPE_NORMAL
  zh: 非军事区（DMZ），11, 37–46
- en: bad checksums, 298
  id: totrans-2435
  prefs: []
  type: TYPE_NORMAL
  zh: 错误的校验和，298
- en: df, to check partition utilization, 108
  id: totrans-2436
  prefs: []
  type: TYPE_NORMAL
  zh: df，用于检查分区使用情况，108
- en: telling Bro to ignore, 298–301
  id: totrans-2437
  prefs: []
  type: TYPE_NORMAL
  zh: 告诉 Bro 忽略，298–301
- en: Digital Corpora, 147, 151, 154
  id: totrans-2438
  prefs: []
  type: TYPE_NORMAL
  zh: Digital Corpora，147, 151, 154
- en: telling Snort to ignore, 302
  id: totrans-2439
  prefs: []
  type: TYPE_NORMAL
  zh: 告诉 Snort 忽略，302
- en: Director of Incident Response, 203–204
  id: totrans-2440
  prefs: []
  type: TYPE_NORMAL
  zh: 事件响应总监，203–204
- en: for error detection in IP
  id: totrans-2441
  prefs: []
  type: TYPE_NORMAL
  zh: 用于 IP 错误检测
- en: '*disablesid.conf*, 323'
  id: totrans-2442
  prefs: []
  type: TYPE_NORMAL
  zh: '*disablesid.conf*，323'
- en: packets, 304
  id: totrans-2443
  prefs: []
  type: TYPE_NORMAL
  zh: 数据包，304
- en: display filters, as used in Wireshark and
  id: totrans-2444
  prefs: []
  type: TYPE_NORMAL
  zh: 显示过滤器，用于 Wireshark 和
- en: using Tshark to identify, 297–298
  id: totrans-2445
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Tshark 识别，297–298
- en: Tshark, 125–128
  id: totrans-2446
  prefs: []
  type: TYPE_NORMAL
  zh: Tshark，125–128
- en: Cisco, as switch vendor, 12, 48
  id: totrans-2447
  prefs: []
  type: TYPE_NORMAL
  zh: Cisco，作为交换机供应商，12, 48
- en: DMZ (demilitarized zone), 11, 37–46
  id: totrans-2448
  prefs: []
  type: TYPE_NORMAL
  zh: DMZ（非军事区），11, 37–46
- en: client-side compromises, 235–237
  id: totrans-2449
  prefs: []
  type: TYPE_NORMAL
  zh: 客户端妥协，235–237
- en: '*dns.log*, as generated by Bro, 23,'
  id: totrans-2450
  prefs: []
  type: TYPE_NORMAL
  zh: '*dns.log*，由 Bro 生成，23,'
- en: Cloppert, Michael, 190
  id: totrans-2451
  prefs: []
  type: TYPE_NORMAL
  zh: Cloppert, Michael, 190
- en: 243–246, 282
  id: totrans-2452
  prefs: []
  type: TYPE_NORMAL
  zh: 243–246, 282
- en: '**336** Index'
  id: totrans-2453
  prefs: []
  type: TYPE_NORMAL
  zh: '**336** 索引'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2454
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: du, to check directory utilization, 108
  id: totrans-2455
  prefs: []
  type: TYPE_NORMAL
  zh: du，用于检查目录使用情况，108
- en: and transaction data, 22–23
  id: totrans-2456
  prefs: []
  type: TYPE_NORMAL
  zh: 以及事务数据，22–23
- en: Dumpcap, usage of, 123–124
  id: totrans-2457
  prefs: []
  type: TYPE_NORMAL
  zh: Dumpcap，用法，123–124
- en: and URL events, 167
  id: totrans-2458
  prefs: []
  type: TYPE_NORMAL
  zh: 以及 URL 事件，167
- en: hunting (IOC-free analysis), 193
  id: totrans-2459
  prefs: []
  type: TYPE_NORMAL
  zh: 猎杀（无 IOC 分析），193
- en: '**E**'
  id: totrans-2460
  prefs: []
  type: TYPE_NORMAL
  zh: '**E**'
- en: Hutchins, Eric, 190
  id: totrans-2461
  prefs: []
  type: TYPE_NORMAL
  zh: Hutchins, Eric, 190
- en: ELSA (Enterprise Log Search and
  id: totrans-2462
  prefs: []
  type: TYPE_NORMAL
  zh: ELSA（企业日志搜索与分析）
- en: Archive), usage of, 178–182
  id: totrans-2463
  prefs: []
  type: TYPE_NORMAL
  zh: 存档)，用法，178–182
- en: '**I**'
  id: totrans-2464
  prefs: []
  type: TYPE_NORMAL
  zh: '**I**'
- en: '*elsa_node.conf*, 108, 323, 331'
  id: totrans-2465
  prefs: []
  type: TYPE_NORMAL
  zh: '*elsa_node.conf*，108, 323, 331'
- en: ICMP (Internet Control Message
  id: totrans-2466
  prefs: []
  type: TYPE_NORMAL
  zh: ICMP（互联网控制消息协议）
- en: '*elsa_web.conf*, 331'
  id: totrans-2467
  prefs: []
  type: TYPE_NORMAL
  zh: '*elsa_web.conf*，331'
- en: Protocol)
  id: totrans-2468
  prefs: []
  type: TYPE_NORMAL
  zh: 协议）
- en: '*enablesid.conf*, 323'
  id: totrans-2469
  prefs: []
  type: TYPE_NORMAL
  zh: '*enablesid.conf*，323'
- en: example intrusion, 212, 214
  id: totrans-2470
  prefs: []
  type: TYPE_NORMAL
  zh: 示例入侵，212, 214
- en: engineers, as within IDC, 203–204
  id: totrans-2471
  prefs: []
  type: TYPE_NORMAL
  zh: 工程师，作为 IDC 内的角色，203–204
- en: searching Bro SSH logs, 226
  id: totrans-2472
  prefs: []
  type: TYPE_NORMAL
  zh: 搜索 Bro SSH 日志，226
- en: Enterprise Log Search and Archive
  id: totrans-2473
  prefs: []
  type: TYPE_NORMAL
  zh: 企业日志搜索和归档
- en: and Tcpdump, 119–128
  id: totrans-2474
  prefs: []
  type: TYPE_NORMAL
  zh: 和 Tcpdump，119–128
- en: (ELSA), usage of, 178–182
  id: totrans-2475
  prefs: []
  type: TYPE_NORMAL
  zh: （ELSA），使用，178–182
- en: and Wireshark, 142
  id: totrans-2476
  prefs: []
  type: TYPE_NORMAL
  zh: 和 Wireshark，142
- en: enterprise security cycle, 5, 186
  id: totrans-2477
  prefs: []
  type: TYPE_NORMAL
  zh: 企业安全周期，5，186
- en: incident analyst role, 203–204
  id: totrans-2478
  prefs: []
  type: TYPE_NORMAL
  zh: 事件分析员角色，203–204
- en: phases of, 187
  id: totrans-2479
  prefs: []
  type: TYPE_NORMAL
  zh: 阶段，187
- en: Incident Detection and Response
  id: totrans-2480
  prefs: []
  type: TYPE_NORMAL
  zh: 事件检测与响应
- en: escalation, as element of response
  id: totrans-2481
  prefs: []
  type: TYPE_NORMAL
  zh: 升级，作为响应的要素
- en: Center, 203–204
  id: totrans-2482
  prefs: []
  type: TYPE_NORMAL
  zh: 中心，203–204
- en: phase, 188, 193–197
  id: totrans-2483
  prefs: []
  type: TYPE_NORMAL
  zh: 阶段，188，193–197
- en: incident handler role, 203–204
  id: totrans-2484
  prefs: []
  type: TYPE_NORMAL
  zh: 事件处理员角色，203–204
- en: '*/etc/network/interfaces*, 87–88'
  id: totrans-2485
  prefs: []
  type: TYPE_NORMAL
  zh: '*/etc/network/interfaces*，87–88'
- en: indicator of compromise (IOC)
  id: totrans-2486
  prefs: []
  type: TYPE_NORMAL
  zh: 危害指示符（IOC）
- en: event analyst role, 203–204
  id: totrans-2487
  prefs: []
  type: TYPE_NORMAL
  zh: 事件分析员角色，203–204
- en: as intelligence format, 188–189,
  id: totrans-2488
  prefs: []
  type: TYPE_NORMAL
  zh: 作为情报格式，188–189，
- en: event classification, 195
  id: totrans-2489
  prefs: []
  type: TYPE_NORMAL
  zh: 事件分类，195
- en: 193, 202, 277, 279
  id: totrans-2490
  prefs: []
  type: TYPE_NORMAL
  zh: 193，202，277，279
- en: extracted content data, 19–20
  id: totrans-2491
  prefs: []
  type: TYPE_NORMAL
  zh: 提取的内容数据，19–20
- en: OpenIOC, as schema for IOC, 278
  id: totrans-2492
  prefs: []
  type: TYPE_NORMAL
  zh: OpenIOC，作为 IOC 的架构，278
- en: Infrastructure and Development
  id: totrans-2493
  prefs: []
  type: TYPE_NORMAL
  zh: 基础设施和开发
- en: '**F**'
  id: totrans-2494
  prefs: []
  type: TYPE_NORMAL
  zh: '**F**'
- en: Center, 203–204
  id: totrans-2495
  prefs: []
  type: TYPE_NORMAL
  zh: 中心，203–204
- en: Internet Control Message Protocol.
  id: totrans-2496
  prefs: []
  type: TYPE_NORMAL
  zh: Internet 控制消息协议。
- en: Fenner, Bill, 116
  id: totrans-2497
  prefs: []
  type: TYPE_NORMAL
  zh: Fenner，Bill，116
- en: '*See* ICMP (Internet Control'
  id: totrans-2498
  prefs: []
  type: TYPE_NORMAL
  zh: '*参见* ICMP（Internet 控制'
- en: find command, to process traffic,
  id: totrans-2499
  prefs: []
  type: TYPE_NORMAL
  zh: 查找命令，用于处理流量，
- en: Message Protocol)
  id: totrans-2500
  prefs: []
  type: TYPE_NORMAL
  zh: 消息协议）
- en: 122, 128
  id: totrans-2501
  prefs: []
  type: TYPE_NORMAL
  zh: 122，128
- en: intrusion categories, 194
  id: totrans-2502
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵类别，194
- en: for command, to process traffic,
  id: totrans-2503
  prefs: []
  type: TYPE_NORMAL
  zh: 用于命令，处理流量，
- en: intrusion kill chain, 190–192
  id: totrans-2504
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵杀链，190–192
- en: 122, 128
  id: totrans-2505
  prefs: []
  type: TYPE_NORMAL
  zh: 122，128
- en: intrusion prevention, 5
  id: totrans-2506
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵防御，5
- en: F-Response, 189
  id: totrans-2507
  prefs: []
  type: TYPE_NORMAL
  zh: F-Response，189
- en: IOC (indicator of compromise)
  id: totrans-2508
  prefs: []
  type: TYPE_NORMAL
  zh: IOC（危害指示符）
- en: '*ftp.log*, as generated by Bro, 228–229,'
  id: totrans-2509
  prefs: []
  type: TYPE_NORMAL
  zh: '*ftp.log*，由 Bro 生成，228–229，'
- en: as intelligence format, 188–189,
  id: totrans-2510
  prefs: []
  type: TYPE_NORMAL
  zh: 作为情报格式，188–189，
- en: 272–273
  id: totrans-2511
  prefs: []
  type: TYPE_NORMAL
  zh: 272–273
- en: 193, 202, 277, 279
  id: totrans-2512
  prefs: []
  type: TYPE_NORMAL
  zh: 193，202，277，279
- en: full content data, 16–18
  id: totrans-2513
  prefs: []
  type: TYPE_NORMAL
  zh: 完整内容数据，16–18
- en: OpenIOC, as schema for IOC, 278
  id: totrans-2514
  prefs: []
  type: TYPE_NORMAL
  zh: OpenIOC，作为 IOC 的架构，278
- en: IOC-centric analysis (matching),
  id: totrans-2515
  prefs: []
  type: TYPE_NORMAL
  zh: IOC 为中心的分析（匹配），
- en: '**G**'
  id: totrans-2516
  prefs: []
  type: TYPE_NORMAL
  zh: '**G**'
- en: 193, 202
  id: totrans-2517
  prefs: []
  type: TYPE_NORMAL
  zh: 193，202
- en: IOC-free analysis (hunting), 193
  id: totrans-2518
  prefs: []
  type: TYPE_NORMAL
  zh: 无 IOC 分析（狩猎），193
- en: Garfinkel, Simson, 147, 229, 291
  id: totrans-2519
  prefs: []
  type: TYPE_NORMAL
  zh: Garfinkel，Simson，147，229，291
- en: Iodine covert tunnel tool, 255–259
  id: totrans-2520
  prefs: []
  type: TYPE_NORMAL
  zh: Iodine 隐蔽通道工具，255–259
- en: Gredler, Hannes, 116
  id: totrans-2521
  prefs: []
  type: TYPE_NORMAL
  zh: Gredler，Hannes，116
- en: IP addresses, 39–41
  id: totrans-2522
  prefs: []
  type: TYPE_NORMAL
  zh: IP 地址，39–41
- en: '**H**'
  id: totrans-2523
  prefs: []
  type: TYPE_NORMAL
  zh: '**H**'
- en: '**M**'
  id: totrans-2524
  prefs: []
  type: TYPE_NORMAL
  zh: '**M**'
- en: Halliday, Paul, 173, 174
  id: totrans-2525
  prefs: []
  type: TYPE_NORMAL
  zh: Halliday，Paul，173，174
- en: Malware Hash Registry (MHR),
  id: totrans-2526
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件哈希注册表（MHR），
- en: Harris, Guy, 116
  id: totrans-2527
  prefs: []
  type: TYPE_NORMAL
  zh: Harris，Guy，116
- en: 283–288
  id: totrans-2528
  prefs: []
  type: TYPE_NORMAL
  zh: 283–288
- en: Heberlein, Todd, 3
  id: totrans-2529
  prefs: []
  type: TYPE_NORMAL
  zh: Heberlein，Todd，3
- en: Mandia, Kevin, 193
  id: totrans-2530
  prefs: []
  type: TYPE_NORMAL
  zh: Mandia，Kevin，193
- en: Hjelmvik, Erik, 153
  id: totrans-2531
  prefs: []
  type: TYPE_NORMAL
  zh: Hjelmvik，Erik，153
- en: Mandiant
  id: totrans-2532
  prefs: []
  type: TYPE_NORMAL
  zh: Mandiant
- en: Holste, Martin, 178, 245
  id: totrans-2533
  prefs: []
  type: TYPE_NORMAL
  zh: Holste，Martin，178，245
- en: APT1 report, 190, 193, 202,
  id: totrans-2534
  prefs: []
  type: TYPE_NORMAL
  zh: APT1 报告，190，193，202，
- en: '*http_agent.conf*, 327'
  id: totrans-2535
  prefs: []
  type: TYPE_NORMAL
  zh: '*http_agent.conf*，327'
- en: 277–278
  id: totrans-2536
  prefs: []
  type: TYPE_NORMAL
  zh: 277–278
- en: '*http.log*, as generated by Bro'
  id: totrans-2537
  prefs: []
  type: TYPE_NORMAL
  zh: '*http.log*，由 Bro 生成'
- en: involvement with South Carolina
  id: totrans-2538
  prefs: []
  type: TYPE_NORMAL
  zh: 与南卡罗来纳州的合作
- en: and bad checksums, 299, 300–301
  id: totrans-2539
  prefs: []
  type: TYPE_NORMAL
  zh: 和错误的校验和，299，300–301
- en: DoR, 6–8
  id: totrans-2540
  prefs: []
  type: TYPE_NORMAL
  zh: DoR，6–8
- en: extracting binaries from HTTP
  id: totrans-2541
  prefs: []
  type: TYPE_NORMAL
  zh: 从 HTTP 提取二进制文件
- en: M-Trends Report, 190
  id: totrans-2542
  prefs: []
  type: TYPE_NORMAL
  zh: M-Trends 报告，190
- en: traffic, 269–270, 277
  id: totrans-2543
  prefs: []
  type: TYPE_NORMAL
  zh: 流量，269–270，277
- en: as platform for tracking key
  id: totrans-2544
  prefs: []
  type: TYPE_NORMAL
  zh: 作为跟踪关键平台
- en: querying, 243
  id: totrans-2545
  prefs: []
  type: TYPE_NORMAL
  zh: 查询，243
- en: incident measurements, 307
  id: totrans-2546
  prefs: []
  type: TYPE_NORMAL
  zh: 事件测量，307
- en: tracking executables, 264
  id: totrans-2547
  prefs: []
  type: TYPE_NORMAL
  zh: 跟踪可执行文件，264
- en: Index **337**
  id: totrans-2548
  prefs: []
  type: TYPE_NORMAL
  zh: 索引 **337**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2549
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: Mandiant for Intelligent Response
  id: totrans-2550
  prefs: []
  type: TYPE_NORMAL
  zh: Mandiant 为智能响应
- en: network visibility
  id: totrans-2551
  prefs: []
  type: TYPE_NORMAL
  zh: 网络可见性
- en: (MIR), 189
  id: totrans-2552
  prefs: []
  type: TYPE_NORMAL
  zh: （MIR），189
- en: capturing traffic on a client or
  id: totrans-2553
  prefs: []
  type: TYPE_NORMAL
  zh: 捕获客户端或
- en: matching (IOC-centric analysis),
  id: totrans-2554
  prefs: []
  type: TYPE_NORMAL
  zh: 匹配（IOC 为中心的分析），
- en: server, 49
  id: totrans-2555
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器，49
- en: 193, 202
  id: totrans-2556
  prefs: []
  type: TYPE_NORMAL
  zh: 193，202
- en: locations for, 45–46
  id: totrans-2557
  prefs: []
  type: TYPE_NORMAL
  zh: 位置，45–46
- en: metadata, 26–28
  id: totrans-2558
  prefs: []
  type: TYPE_NORMAL
  zh: 元数据，26–28
- en: network taps for, 48
  id: totrans-2559
  prefs: []
  type: TYPE_NORMAL
  zh: 网络 TAPs 用于，48
- en: Metasploit, 239–241, 248, 251
  id: totrans-2560
  prefs: []
  type: TYPE_NORMAL
  zh: Metasploit，239–241，248，251
- en: switching SPAN ports for, 47–48
  id: totrans-2561
  prefs: []
  type: TYPE_NORMAL
  zh: 切换 SPAN 端口，47–48
- en: Metasploitable, 221
  id: totrans-2562
  prefs: []
  type: TYPE_NORMAL
  zh: Metasploitable，221
- en: vs. network taps, 50
  id: totrans-2563
  prefs: []
  type: TYPE_NORMAL
  zh: 与网络 TAPs 的比较，50
- en: Meterpreter, as Metasploit component,
  id: totrans-2564
  prefs: []
  type: TYPE_NORMAL
  zh: Meterpreter，作为 Metasploit 组件，
- en: NIST (National Institute of Standards
  id: totrans-2565
  prefs: []
  type: TYPE_NORMAL
  zh: NIST（国家标准与技术研究院）
- en: 240–241, 248, 251–255
  id: totrans-2566
  prefs: []
  type: TYPE_NORMAL
  zh: 240–241，248，251–255
- en: and Technology), 304
  id: totrans-2567
  prefs: []
  type: TYPE_NORMAL
  zh: 和技术），304
- en: MHR (Malware Hash Registry),
  id: totrans-2568
  prefs: []
  type: TYPE_NORMAL
  zh: MHR（恶意软件哈希注册表），
- en: '*notice.log*, as generated by Bro'
  id: totrans-2569
  prefs: []
  type: TYPE_NORMAL
  zh: '*notice.log*，由 Bro 生成'
- en: 283–288
  id: totrans-2570
  prefs: []
  type: TYPE_NORMAL
  zh: 283–288
- en: analyzing with ELSA, 242–243
  id: totrans-2571
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 ELSA 分析，242–243
- en: '*modifysid.conf*, 323'
  id: totrans-2572
  prefs: []
  type: TYPE_NORMAL
  zh: '*modifysid.conf*，323'
- en: with APT1 module, 279, 282
  id: totrans-2573
  prefs: []
  type: TYPE_NORMAL
  zh: 与 APT1 模块，279，282
- en: MySQL
  id: totrans-2574
  prefs: []
  type: TYPE_NORMAL
  zh: MySQL
- en: extracting binaries from HTTP
  id: totrans-2575
  prefs: []
  type: TYPE_NORMAL
  zh: 从 HTTP 提取二进制文件
- en: database storage location, 105
  id: totrans-2576
  prefs: []
  type: TYPE_NORMAL
  zh: 数据库存储位置，105
- en: traffic, 277
  id: totrans-2577
  prefs: []
  type: TYPE_NORMAL
  zh: 流量，277
- en: keeping software up-to-date, 333
  id: totrans-2578
  prefs: []
  type: TYPE_NORMAL
  zh: 保持软件最新，333
- en: hashing downloaded executables
  id: totrans-2579
  prefs: []
  type: TYPE_NORMAL
  zh: 哈希化下载的可执行文件
- en: query to determine storage
  id: totrans-2580
  prefs: []
  type: TYPE_NORMAL
  zh: 查询以确定存储
- en: with Bro, 264
  id: totrans-2581
  prefs: []
  type: TYPE_NORMAL
  zh: 与 Bro，264
- en: usage, 107
  id: totrans-2582
  prefs: []
  type: TYPE_NORMAL
  zh: 使用，107
- en: and malicious downloads, 286
  id: totrans-2583
  prefs: []
  type: TYPE_NORMAL
  zh: 和恶意下载，286
- en: setting up on SO using PPA, 89, 94
  id: totrans-2584
  prefs: []
  type: TYPE_NORMAL
  zh: 在 SO 上使用 PPA 设置，89，94
- en: NPAT (network port address
  id: totrans-2585
  prefs: []
  type: TYPE_NORMAL
  zh: NPAT（网络端口地址）
- en: as SO database, 76, 115, 167–169,
  id: totrans-2586
  prefs: []
  type: TYPE_NORMAL
  zh: 作为 SO 数据库，76，115，167–169，
- en: translation), 43–46
  id: totrans-2587
  prefs: []
  type: TYPE_NORMAL
  zh: 翻译），43–46
- en: 178, 180
  id: totrans-2588
  prefs: []
  type: TYPE_NORMAL
  zh: 178，180
- en: NSM (network security monitoring)
  id: totrans-2589
  prefs: []
  type: TYPE_NORMAL
  zh: NSM（网络安全监控）
- en: as target of data theft, 228–232
  id: totrans-2590
  prefs: []
  type: TYPE_NORMAL
  zh: 作为数据窃取的目标，228–232
- en: benefit to CIRTs, 4
  id: totrans-2591
  prefs: []
  type: TYPE_NORMAL
  zh: 对 CIRTs 的好处，4
- en: as continuous business process, 4
  id: totrans-2592
  prefs: []
  type: TYPE_NORMAL
  zh: 作为持续业务过程，4
- en: '**N**'
  id: totrans-2593
  prefs: []
  type: TYPE_NORMAL
  zh: '**N**'
- en: datatypes, 16, 160
  id: totrans-2594
  prefs: []
  type: TYPE_NORMAL
  zh: 数据类型，16，160
- en: definition of, 3
  id: totrans-2595
  prefs: []
  type: TYPE_NORMAL
  zh: 定义，3
- en: NAT (network address translation),
  id: totrans-2596
  prefs: []
  type: TYPE_NORMAL
  zh: NAT（网络地址转换），
- en: efficacy of, 12–13, 31
  id: totrans-2597
  prefs: []
  type: TYPE_NORMAL
  zh: 效能，12–13，31
- en: 42–43
  id: totrans-2598
  prefs: []
  type: TYPE_NORMAL
  zh: 42–43
- en: how to win with, 10
  id: totrans-2599
  prefs: []
  type: TYPE_NORMAL
  zh: 如何胜出，10
- en: drawback with NSM, 31
  id: totrans-2600
  prefs: []
  type: TYPE_NORMAL
  zh: 与 NSM 的缺点，31
- en: legality of, 13–14
  id: totrans-2601
  prefs: []
  type: TYPE_NORMAL
  zh: 合法性，13–14
- en: network visibility, 45–46
  id: totrans-2602
  prefs: []
  type: TYPE_NORMAL
  zh: 网络可见性，45–46
- en: protecting user privacy when
  id: totrans-2603
  prefs: []
  type: TYPE_NORMAL
  zh: 保护用户隐私时
- en: vs. proxy, 294
  id: totrans-2604
  prefs: []
  type: TYPE_NORMAL
  zh: 与代理的对比，294
- en: conducting, 14
  id: totrans-2605
  prefs: []
  type: TYPE_NORMAL
  zh: 执行，14
- en: National Institute of Standards and
  id: totrans-2606
  prefs: []
  type: TYPE_NORMAL
  zh: 国家标准与技术研究院
- en: purchasing, 31–32
  id: totrans-2607
  prefs: []
  type: TYPE_NORMAL
  zh: 购买，31–32
- en: Technology (NIST), 304
  id: totrans-2608
  prefs: []
  type: TYPE_NORMAL
  zh: 技术（NIST），304
- en: relationship to other approaches,
  id: totrans-2609
  prefs: []
  type: TYPE_NORMAL
  zh: 与其他方法的关系，
- en: net blocks, 39–41
  id: totrans-2610
  prefs: []
  type: TYPE_NORMAL
  zh: 网络块，39–41
- en: 9–10
  id: totrans-2611
  prefs: []
  type: TYPE_NORMAL
  zh: 9–10
- en: Net Optics, as tap vendor, 12, 48
  id: totrans-2612
  prefs: []
  type: TYPE_NORMAL
  zh: Net Optics，作为 tap 供应商，12, 48
- en: resources, 32
  id: totrans-2613
  prefs: []
  type: TYPE_NORMAL
  zh: 资源，32
- en: Netsniff-ng, as data collection tool, 115,
  id: totrans-2614
  prefs: []
  type: TYPE_NORMAL
  zh: Netsniff-ng，作为数据收集工具，115，
- en: simple setup, 10–11
  id: totrans-2615
  prefs: []
  type: TYPE_NORMAL
  zh: 简单设置，10–11
- en: 170, 172, 244
  id: totrans-2616
  prefs: []
  type: TYPE_NORMAL
  zh: 170, 172, 244
- en: NSMNow, 311
  id: totrans-2617
  prefs: []
  type: TYPE_NORMAL
  zh: NSMNow，311
- en: network address translation (NAT),
  id: totrans-2618
  prefs: []
  type: TYPE_NORMAL
  zh: 网络地址转换（NAT），
- en: '*/nsm/sensor_data/<sensorname>/dailylogs*'
  id: totrans-2619
  prefs: []
  type: TYPE_NORMAL
  zh: '*/nsm/sensor_data/<sensorname>/dailylogs*'
- en: 42–43
  id: totrans-2620
  prefs: []
  type: TYPE_NORMAL
  zh: 42–43
- en: directory, 105–106, 116,
  id: totrans-2621
  prefs: []
  type: TYPE_NORMAL
  zh: 目录，105–106, 116,
- en: drawback with NSM, 31
  id: totrans-2622
  prefs: []
  type: TYPE_NORMAL
  zh: 与 NSM 的缺点，31
- en: 122, 128–129, 136–137
  id: totrans-2623
  prefs: []
  type: TYPE_NORMAL
  zh: 122, 128–129, 136–137
- en: network visibility, 45–46
  id: totrans-2624
  prefs: []
  type: TYPE_NORMAL
  zh: 网络可见性，45–46
- en: vs. proxy, 294
  id: totrans-2625
  prefs: []
  type: TYPE_NORMAL
  zh: 与代理的对比，294
- en: NetworkMiner
  id: totrans-2626
  prefs: []
  type: TYPE_NORMAL
  zh: NetworkMiner
- en: '**O**'
  id: totrans-2627
  prefs: []
  type: TYPE_NORMAL
  zh: '**O**'
- en: counting bytes in session data
  id: totrans-2628
  prefs: []
  type: TYPE_NORMAL
  zh: 计算会话数据中的字节
- en: OpenIOC format, 278
  id: totrans-2629
  prefs: []
  type: TYPE_NORMAL
  zh: OpenIOC 格式，278
- en: using, 169
  id: totrans-2630
  prefs: []
  type: TYPE_NORMAL
  zh: 使用，169
- en: OpenSSH
  id: totrans-2631
  prefs: []
  type: TYPE_NORMAL
  zh: OpenSSH
- en: usage of, 153–157
  id: totrans-2632
  prefs: []
  type: TYPE_NORMAL
  zh: 使用，153–157
- en: for communications among
  id: totrans-2633
  prefs: []
  type: TYPE_NORMAL
  zh: 用于通信
- en: network port address translation
  id: totrans-2634
  prefs: []
  type: TYPE_NORMAL
  zh: 网络端口地址转换
- en: distributed SO platforms,
  id: totrans-2635
  prefs: []
  type: TYPE_NORMAL
  zh: 分布式 SO 平台，
- en: (NPAT), 43–46
  id: totrans-2636
  prefs: []
  type: TYPE_NORMAL
  zh: （NPAT），43–46
- en: 82–83
  id: totrans-2637
  prefs: []
  type: TYPE_NORMAL
  zh: 82–83
- en: network security monitoring. *See*
  id: totrans-2638
  prefs: []
  type: TYPE_NORMAL
  zh: 网络安全监控。*另见*
- en: for connecting via SOCKS
  id: totrans-2639
  prefs: []
  type: TYPE_NORMAL
  zh: 用于通过 SOCKS 连接
- en: NSM (network security
  id: totrans-2640
  prefs: []
  type: TYPE_NORMAL
  zh: NSM（网络安全
- en: proxy, 103
  id: totrans-2641
  prefs: []
  type: TYPE_NORMAL
  zh: 代理，103
- en: monitoring)
  id: totrans-2642
  prefs: []
  type: TYPE_NORMAL
  zh: 监控）
- en: as logged by Bro, 277
  id: totrans-2643
  prefs: []
  type: TYPE_NORMAL
  zh: 被 Bro 记录的，277
- en: network taps, 48, 49
  id: totrans-2644
  prefs: []
  type: TYPE_NORMAL
  zh: 网络采样器，48, 49
- en: for sensor administration, 51, 88,
  id: totrans-2645
  prefs: []
  type: TYPE_NORMAL
  zh: 用于传感器管理，51, 88,
- en: 94, 124
  id: totrans-2646
  prefs: []
  type: TYPE_NORMAL
  zh: 94, 124
- en: '**338** Index'
  id: totrans-2647
  prefs: []
  type: TYPE_NORMAL
  zh: '**338** 索引'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2648
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: for X forwarding, 95–97
  id: totrans-2649
  prefs: []
  type: TYPE_NORMAL
  zh: 用于 X 转发，95–97
- en: retrospective security analysis, 30
  id: totrans-2650
  prefs: []
  type: TYPE_NORMAL
  zh: 回顾性安全分析，30
- en: as used by an intruder, 232–233
  id: totrans-2651
  prefs: []
  type: TYPE_NORMAL
  zh: 被入侵者使用的，232–233
- en: Richardson, Michael, 116
  id: totrans-2652
  prefs: []
  type: TYPE_NORMAL
  zh: Richardson, Michael，116
- en: OSSEC, 115, 165, 182, 227
  id: totrans-2653
  prefs: []
  type: TYPE_NORMAL
  zh: OSSEC，115, 165, 182, 227
- en: RIR (Regional Internet Registry), 40
  id: totrans-2654
  prefs: []
  type: TYPE_NORMAL
  zh: RIR（区域互联网注册局），40
- en: '*ossec_agent.conf*, 323'
  id: totrans-2655
  prefs: []
  type: TYPE_NORMAL
  zh: '*ossec_agent.conf*，323'
- en: Risso, Fulvio, 116
  id: totrans-2656
  prefs: []
  type: TYPE_NORMAL
  zh: Risso, Fulvio，116
- en: RobTex, 28, 132
  id: totrans-2657
  prefs: []
  type: TYPE_NORMAL
  zh: RobTex，28, 132
- en: '**P**'
  id: totrans-2658
  prefs: []
  type: TYPE_NORMAL
  zh: '**P**'
- en: routing, 28, 34, 49, 198, 299
  id: totrans-2659
  prefs: []
  type: TYPE_NORMAL
  zh: 路由，28, 34, 49, 198, 299
- en: Packetloop, 306
  id: totrans-2660
  prefs: []
  type: TYPE_NORMAL
  zh: Packetloop，306
- en: '*pads_agent.conf*, 327'
  id: totrans-2661
  prefs: []
  type: TYPE_NORMAL
  zh: '*pads_agent.conf*，327'
- en: '**S**'
  id: totrans-2662
  prefs: []
  type: TYPE_NORMAL
  zh: '**S**'
- en: Passive Real-Time Asset Detection
  id: totrans-2663
  prefs: []
  type: TYPE_NORMAL
  zh: 被动实时资产检测
- en: SANCP (Security Analyst Network
  id: totrans-2664
  prefs: []
  type: TYPE_NORMAL
  zh: SANCP（安全分析员网络
- en: System. *See* PRADS (Passive
  id: totrans-2665
  prefs: []
  type: TYPE_NORMAL
  zh: 系统。*另见* PRADS（被动
- en: Connection Profiler)
  id: totrans-2666
  prefs: []
  type: TYPE_NORMAL
  zh: 连接分析器）
- en: Real-Time Asset Detection
  id: totrans-2667
  prefs: []
  type: TYPE_NORMAL
  zh: 实时资产检测
- en: database table, 167
  id: totrans-2668
  prefs: []
  type: TYPE_NORMAL
  zh: 数据库表，167
- en: System)
  id: totrans-2669
  prefs: []
  type: TYPE_NORMAL
  zh: 系统）
- en: querying via Sguil, 167–169,
  id: totrans-2670
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 Sguil 查询，167–169，
- en: '*pcap_agent.conf*, 328'
  id: totrans-2671
  prefs: []
  type: TYPE_NORMAL
  zh: '*pcap_agent.conf*，328'
- en: 211–212, 223
  id: totrans-2672
  prefs: []
  type: TYPE_NORMAL
  zh: 211–212, 223
- en: pcap file format, 50, 76, 114, 115
  id: totrans-2673
  prefs: []
  type: TYPE_NORMAL
  zh: pcap 文件格式，50, 76, 114, 115
- en: as source of session data, 22, 167
  id: totrans-2674
  prefs: []
  type: TYPE_NORMAL
  zh: 作为会话数据来源，22, 167
- en: pcap-filter man page, 120
  id: totrans-2675
  prefs: []
  type: TYPE_NORMAL
  zh: pcap-filter 手册页，120
- en: '*sancp_agent.conf*, 328'
  id: totrans-2676
  prefs: []
  type: TYPE_NORMAL
  zh: '*sancp_agent.conf*，328'
- en: penetration testing, 187
  id: totrans-2677
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试，187
- en: SANS Internet Storm Center (ISC)
  id: totrans-2678
  prefs: []
  type: TYPE_NORMAL
  zh: SANS 网络风暴中心（ISC）
- en: People’s Liberation Army. *See* APT
  id: totrans-2679
  prefs: []
  type: TYPE_NORMAL
  zh: 解放军。*另见* APT
- en: Port Report, 132
  id: totrans-2680
  prefs: []
  type: TYPE_NORMAL
  zh: 端口报告，132
- en: (Advanced Persistent
  id: totrans-2681
  prefs: []
  type: TYPE_NORMAL
  zh: （高级持久
- en: Security Analyst Network Connection
  id: totrans-2682
  prefs: []
  type: TYPE_NORMAL
  zh: 安全分析员网络连接
- en: Threat)
  id: totrans-2683
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁）
- en: Profiler. *See* SANCP
  id: totrans-2684
  prefs: []
  type: TYPE_NORMAL
  zh: 分析器。*另见* SANCP
- en: Poison Ivy, 288
  id: totrans-2685
  prefs: []
  type: TYPE_NORMAL
  zh: Poison Ivy，288
- en: (Security Analyst Network
  id: totrans-2686
  prefs: []
  type: TYPE_NORMAL
  zh: （安全分析员网络
- en: PPA (Personal Package Archive), 59\.
  id: totrans-2687
  prefs: []
  type: TYPE_NORMAL
  zh: PPA（个人软件包归档），59\.
- en: Connection Profiler)
  id: totrans-2688
  prefs: []
  type: TYPE_NORMAL
  zh: 连接分析器）
- en: '*See also* SO (Security'
  id: totrans-2689
  prefs: []
  type: TYPE_NORMAL
  zh: '*另见* SO（安全洋葱）'
- en: Security Onion. *See* SO (Security
  id: totrans-2690
  prefs: []
  type: TYPE_NORMAL
  zh: 安全洋葱。*另见* SO（安全
- en: 'Onion): installation of'
  id: totrans-2691
  prefs: []
  type: TYPE_NORMAL
  zh: 洋葱）：安装
- en: Onion)
  id: totrans-2692
  prefs: []
  type: TYPE_NORMAL
  zh: 洋葱）
- en: PRADS (Passive Real-Time Asset
  id: totrans-2693
  prefs: []
  type: TYPE_NORMAL
  zh: PRADS（被动实时资产
- en: '*securityonion.conf*, 108, 324–325'
  id: totrans-2694
  prefs: []
  type: TYPE_NORMAL
  zh: '*securityonion.conf*，108, 324–325'
- en: Detection System)
  id: totrans-2695
  prefs: []
  type: TYPE_NORMAL
  zh: 检测系统）
- en: SecurixLive, 311
  id: totrans-2696
  prefs: []
  type: TYPE_NORMAL
  zh: SecurixLive，311
- en: counting bytes in session data
  id: totrans-2697
  prefs: []
  type: TYPE_NORMAL
  zh: 计算会话数据中的字节
- en: senior analyst, in ATI, 203–204
  id: totrans-2698
  prefs: []
  type: TYPE_NORMAL
  zh: 高级分析员，在 ATI 中，203–204
- en: using, 169
  id: totrans-2699
  prefs: []
  type: TYPE_NORMAL
  zh: 使用，169
- en: sensor hardware
  id: totrans-2700
  prefs: []
  type: TYPE_NORMAL
  zh: 传感器硬件
- en: as source of NSM data, 115
  id: totrans-2701
  prefs: []
  type: TYPE_NORMAL
  zh: 作为 NSM 数据的来源，115
- en: estimating hard drive space for, 51
  id: totrans-2702
  prefs: []
  type: TYPE_NORMAL
  zh: 估算硬盘空间，51
- en: with Sguil, 165, 167–169,
  id: totrans-2703
  prefs: []
  type: TYPE_NORMAL
  zh: 与 Sguil 一起使用，165, 167–169，
- en: requirements for, 49–50
  id: totrans-2704
  prefs: []
  type: TYPE_NORMAL
  zh: 对应要求，49–50
- en: 210–211
  id: totrans-2705
  prefs: []
  type: TYPE_NORMAL
  zh: 210–211
- en: '*sensor.conf*, 328'
  id: totrans-2706
  prefs: []
  type: TYPE_NORMAL
  zh: '*sensor.conf*，328'
- en: similarity to Bro’s connection
  id: totrans-2707
  prefs: []
  type: TYPE_NORMAL
  zh: 类似于 Bro 的连接
- en: sensor_cleandisk() function, 107
  id: totrans-2708
  prefs: []
  type: TYPE_NORMAL
  zh: sensor_cleandisk() 函数，107
- en: logs, 180
  id: totrans-2709
  prefs: []
  type: TYPE_NORMAL
  zh: 日志，180
- en: sensor management, recommendations
  id: totrans-2710
  prefs: []
  type: TYPE_NORMAL
  zh: 传感器管理，建议
- en: '*prads.conf*, 328'
  id: totrans-2711
  prefs: []
  type: TYPE_NORMAL
  zh: '*prads.conf*，328'
- en: for, 51–52
  id: totrans-2712
  prefs: []
  type: TYPE_NORMAL
  zh: 用于，51–52
- en: principal analyst, in ATI, 203–204
  id: totrans-2713
  prefs: []
  type: TYPE_NORMAL
  zh: 主分析员，在 ATI 中，203–204
- en: '*server.conf*, 324'
  id: totrans-2714
  prefs: []
  type: TYPE_NORMAL
  zh: '*server.conf*，324'
- en: Prosise, Chris, 193
  id: totrans-2715
  prefs: []
  type: TYPE_NORMAL
  zh: Prosise, Chris，193
- en: server-side compromises, 207–208
  id: totrans-2716
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器端妥协，207–208
- en: protecting user privacy, 14
  id: totrans-2717
  prefs: []
  type: TYPE_NORMAL
  zh: 保护用户隐私，14
- en: session data, 21–22
  id: totrans-2718
  prefs: []
  type: TYPE_NORMAL
  zh: 会话数据，21–22
- en: protocol analyzer, 116
  id: totrans-2719
  prefs: []
  type: TYPE_NORMAL
  zh: 协议分析器，116
- en: Sguil
  id: totrans-2720
  prefs: []
  type: TYPE_NORMAL
  zh: Sguil
- en: proxies, 289–294
  id: totrans-2721
  prefs: []
  type: TYPE_NORMAL
  zh: 代理，289–294
- en: agents, 115, 312
  id: totrans-2722
  prefs: []
  type: TYPE_NORMAL
  zh: 代理，115, 312
- en: '*pulledpork.conf*, 323'
  id: totrans-2723
  prefs: []
  type: TYPE_NORMAL
  zh: '*pulledpork.conf*，323'
- en: for analyzing a client-side intrusion,
  id: totrans-2724
  prefs: []
  type: TYPE_NORMAL
  zh: 用于分析客户端入侵，
- en: PuTTY, for SOCKS proxy access,
  id: totrans-2725
  prefs: []
  type: TYPE_NORMAL
  zh: PuTTY，用于 SOCKS 代理访问，
- en: 210–224
  id: totrans-2726
  prefs: []
  type: TYPE_NORMAL
  zh: 210–224
- en: 103–105
  id: totrans-2727
  prefs: []
  type: TYPE_NORMAL
  zh: 103–105
- en: databases used by, 107–108
  id: totrans-2728
  prefs: []
  type: TYPE_NORMAL
  zh: 使用的数据库，107–108
- en: incident category definitions in, 172
  id: totrans-2729
  prefs: []
  type: TYPE_NORMAL
  zh: 事件类别定义，在其中，172
- en: '**r**'
  id: totrans-2730
  prefs: []
  type: TYPE_NORMAL
  zh: '**r**'
- en: key functions, 164
  id: totrans-2731
  prefs: []
  type: TYPE_NORMAL
  zh: 关键功能，164
- en: managing the Sguil database, 108
  id: totrans-2732
  prefs: []
  type: TYPE_NORMAL
  zh: 管理Sguil数据库，108
- en: '*ra.conf*. See */tmp/ra.conf*'
  id: totrans-2733
  prefs: []
  type: TYPE_NORMAL
  zh: '*ra.conf*。参见 */tmp/ra.conf*'
- en: transcript data storage, 172
  id: totrans-2734
  prefs: []
  type: TYPE_NORMAL
  zh: 转录数据存储，172
- en: RAT (remote access trojan), 288
  id: totrans-2735
  prefs: []
  type: TYPE_NORMAL
  zh: RAT（远程访问木马），288
- en: usage of
  id: totrans-2736
  prefs: []
  type: TYPE_NORMAL
  zh: 使用情况
- en: red teaming, 187
  id: totrans-2737
  prefs: []
  type: TYPE_NORMAL
  zh: 红队，187
- en: categorizing alert data, 172–173
  id: totrans-2738
  prefs: []
  type: TYPE_NORMAL
  zh: 分类警报数据，172–173
- en: Regional Internet Registry (RIR), 40
  id: totrans-2739
  prefs: []
  type: TYPE_NORMAL
  zh: 区域互联网注册中心（RIR），40
- en: metadata and related data,
  id: totrans-2740
  prefs: []
  type: TYPE_NORMAL
  zh: 元数据和相关数据，
- en: remote access trojan (RAT), 288
  id: totrans-2741
  prefs: []
  type: TYPE_NORMAL
  zh: 远程访问木马（RAT），288
- en: 164–165
  id: totrans-2742
  prefs: []
  type: TYPE_NORMAL
  zh: 164–165
- en: resolution, as element of response
  id: totrans-2743
  prefs: []
  type: TYPE_NORMAL
  zh: 响应的元素，作为解决方案
- en: pivoting to full content data,
  id: totrans-2744
  prefs: []
  type: TYPE_NORMAL
  zh: 转向完整内容数据，
- en: phase, 188, 198–201
  id: totrans-2745
  prefs: []
  type: TYPE_NORMAL
  zh: 阶段，188, 198–201
- en: 169–171
  id: totrans-2746
  prefs: []
  type: TYPE_NORMAL
  zh: 169–171
- en: Index **339**
  id: totrans-2747
  prefs: []
  type: TYPE_NORMAL
  zh: 索引 **339**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2748
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: Sguil, usage of *(continued)*
  id: totrans-2749
  prefs: []
  type: TYPE_NORMAL
  zh: Sguil，使用情况（续）
- en: limiting access to, 102–103
  id: totrans-2750
  prefs: []
  type: TYPE_NORMAL
  zh: 限制访问，102–103
- en: querying alert data, 165–167
  id: totrans-2751
  prefs: []
  type: TYPE_NORMAL
  zh: 查询警报数据，165–167
- en: managing Sguil database
  id: totrans-2752
  prefs: []
  type: TYPE_NORMAL
  zh: 管理Sguil数据库
- en: querying session data, 167–169
  id: totrans-2753
  prefs: []
  type: TYPE_NORMAL
  zh: 查询会话数据，167–169
- en: configuration of, 108
  id: totrans-2754
  prefs: []
  type: TYPE_NORMAL
  zh: 配置，108
- en: running, 161–163
  id: totrans-2755
  prefs: []
  type: TYPE_NORMAL
  zh: 正在运行，161–163
- en: requirements for server
  id: totrans-2756
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器要求
- en: simple aggregation, 164
  id: totrans-2757
  prefs: []
  type: TYPE_NORMAL
  zh: 简单聚合，164
- en: hardware, 76
  id: totrans-2758
  prefs: []
  type: TYPE_NORMAL
  zh: 硬件，76
- en: username and password during
  id: totrans-2759
  prefs: []
  type: TYPE_NORMAL
  zh: 用户名和密码期间
- en: selecting method to deploy code, 59
  id: totrans-2760
  prefs: []
  type: TYPE_NORMAL
  zh: 选择部署代码的方法，59
- en: SO setup, 68–69, 79
  id: totrans-2761
  prefs: []
  type: TYPE_NORMAL
  zh: SO设置，68–69, 79
- en: as server-plus-sensors system,
  id: totrans-2762
  prefs: []
  type: TYPE_NORMAL
  zh: 作为服务器加传感器系统，
- en: sguil-db-purge script, 108
  id: totrans-2763
  prefs: []
  type: TYPE_NORMAL
  zh: sguil-db-purge脚本，108
- en: 56–58, 76
  id: totrans-2764
  prefs: []
  type: TYPE_NORMAL
  zh: 56–58, 76
- en: '*sguild.conf*, 324'
  id: totrans-2765
  prefs: []
  type: TYPE_NORMAL
  zh: '*sguild.conf*，324'
- en: as stand-alone system, 56–57
  id: totrans-2766
  prefs: []
  type: TYPE_NORMAL
  zh: 作为独立系统，56–57
- en: Snorby
  id: totrans-2767
  prefs: []
  type: TYPE_NORMAL
  zh: Snorby
- en: storage, estimating full content
  id: totrans-2768
  prefs: []
  type: TYPE_NORMAL
  zh: 存储，估算完整内容
- en: as console to view alert data, 29,
  id: totrans-2769
  prefs: []
  type: TYPE_NORMAL
  zh: 作为查看警报数据的控制台，29,
- en: data requirements, 51
  id: totrans-2770
  prefs: []
  type: TYPE_NORMAL
  zh: 数据需求，51
- en: 71–73
  id: totrans-2771
  prefs: []
  type: TYPE_NORMAL
  zh: 71–73
- en: updating
  id: totrans-2772
  prefs: []
  type: TYPE_NORMAL
  zh: 更新
- en: email address requirement during
  id: totrans-2773
  prefs: []
  type: TYPE_NORMAL
  zh: 电子邮件地址要求期间
- en: via command line, 101
  id: totrans-2774
  prefs: []
  type: TYPE_NORMAL
  zh: 通过命令行，101
- en: SO setup, 69, 79
  id: totrans-2775
  prefs: []
  type: TYPE_NORMAL
  zh: SO设置，69, 79
- en: via graphical user interface,
  id: totrans-2776
  prefs: []
  type: TYPE_NORMAL
  zh: 通过图形用户界面，
- en: usage of, 174–178
  id: totrans-2777
  prefs: []
  type: TYPE_NORMAL
  zh: 使用情况，174–178
- en: 100–101
  id: totrans-2778
  prefs: []
  type: TYPE_NORMAL
  zh: 100–101
- en: Snort
  id: totrans-2779
  prefs: []
  type: TYPE_NORMAL
  zh: Snort
- en: SOCKS proxy, 103–104
  id: totrans-2780
  prefs: []
  type: TYPE_NORMAL
  zh: SOCKS代理，103–104
- en: alerts within ELSA generated by,
  id: totrans-2781
  prefs: []
  type: TYPE_NORMAL
  zh: 在ELSA中生成的警报，
- en: '*sosetup.log*, 70'
  id: totrans-2782
  prefs: []
  type: TYPE_NORMAL
  zh: '*sosetup.log*，70'
- en: 180, 240–243, 248
  id: totrans-2783
  prefs: []
  type: TYPE_NORMAL
  zh: 180, 240–243, 248
- en: South Carolina, intrusion example,
  id: totrans-2784
  prefs: []
  type: TYPE_NORMAL
  zh: 南卡罗来纳州，入侵示例，
- en: alerts within Sguil generated by,
  id: totrans-2785
  prefs: []
  type: TYPE_NORMAL
  zh: 在Sguil中生成的警报，
- en: 6–8
  id: totrans-2786
  prefs: []
  type: TYPE_NORMAL
  zh: 6–8
- en: 210, 215–216
  id: totrans-2787
  prefs: []
  type: TYPE_NORMAL
  zh: 210, 215–216
- en: SPAN ports, 49, 50
  id: totrans-2788
  prefs: []
  type: TYPE_NORMAL
  zh: SPAN端口，49, 50
- en: configuring checksum mode in, 302
  id: totrans-2789
  prefs: []
  type: TYPE_NORMAL
  zh: 在中配置校验和模式，302
- en: Sphinx, 115–116, 178
  id: totrans-2790
  prefs: []
  type: TYPE_NORMAL
  zh: Sphinx，115–116, 178
- en: configuring X-Forwarded-For in, 294
  id: totrans-2791
  prefs: []
  type: TYPE_NORMAL
  zh: 在中配置X-Forwarded-For，294
- en: Squert, usage of, 173–174
  id: totrans-2792
  prefs: []
  type: TYPE_NORMAL
  zh: Squert，使用情况，173–174
- en: as console to view alert data, 29–30,
  id: totrans-2793
  prefs: []
  type: TYPE_NORMAL
  zh: 作为查看警报数据的控制台，29–30,
- en: '*ssh.log*, as generated by Bro, 226–227'
  id: totrans-2794
  prefs: []
  type: TYPE_NORMAL
  zh: '*ssh.log*，由Bro生成，226–227'
- en: 210–11, 214–216
  id: totrans-2795
  prefs: []
  type: TYPE_NORMAL
  zh: 210–11, 214–216
- en: statistical data, 24–26
  id: totrans-2796
  prefs: []
  type: TYPE_NORMAL
  zh: 统计数据，24–26
- en: as console to view session data, 22,
  id: totrans-2797
  prefs: []
  type: TYPE_NORMAL
  zh: 作为查看会话数据的控制台，22,
- en: Suricata
  id: totrans-2798
  prefs: []
  type: TYPE_NORMAL
  zh: Suricata
- en: 211–214
  id: totrans-2799
  prefs: []
  type: TYPE_NORMAL
  zh: 211–214
- en: alerts generated by, 169, 174,
  id: totrans-2800
  prefs: []
  type: TYPE_NORMAL
  zh: 由此生成的警报，169, 174,
- en: as element in pcap log file name,
  id: totrans-2801
  prefs: []
  type: TYPE_NORMAL
  zh: 作为pcap日志文件名中的元素，
- en: 325–325, 328
  id: totrans-2802
  prefs: []
  type: TYPE_NORMAL
  zh: 325–325, 328
- en: 105–106
  id: totrans-2803
  prefs: []
  type: TYPE_NORMAL
  zh: 105–106
- en: as SO configuration choice, 79
  id: totrans-2804
  prefs: []
  type: TYPE_NORMAL
  zh: 作为SO配置选项，79
- en: as source of alert data, 28, 30, 115,
  id: totrans-2805
  prefs: []
  type: TYPE_NORMAL
  zh: 作为警报数据源，28, 30, 115,
- en: as source of alert data, 28, 115,
  id: totrans-2806
  prefs: []
  type: TYPE_NORMAL
  zh: 作为警报数据源，28, 115,
- en: 164–165
  id: totrans-2807
  prefs: []
  type: TYPE_NORMAL
  zh: 164–165
- en: 164–165
  id: totrans-2808
  prefs: []
  type: TYPE_NORMAL
  zh: 164–165
- en: '*snort_agent.conf*, 329'
  id: totrans-2809
  prefs: []
  type: TYPE_NORMAL
  zh: '*snort_agent.conf*，329'
- en: '*suricata.yaml*, 328, 330'
  id: totrans-2810
  prefs: []
  type: TYPE_NORMAL
  zh: '*suricata.yaml*，328, 330'
- en: '*snort.conf*, 319, 329'
  id: totrans-2811
  prefs: []
  type: TYPE_NORMAL
  zh: '*snort.conf*，319, 329'
- en: Sysinternals PsExec, 189
  id: totrans-2812
  prefs: []
  type: TYPE_NORMAL
  zh: Sysinternals PsExec，189
- en: '*snort.log.<Unix timestamp>* , as full'
  id: totrans-2813
  prefs: []
  type: TYPE_NORMAL
  zh: '*snort.log.<Unix timestamp>*，作为完整内容'
- en: Syslog-ng, as data delivery tool, 115,
  id: totrans-2814
  prefs: []
  type: TYPE_NORMAL
  zh: Syslog-ng，作为数据传输工具，115,
- en: content data generated
  id: totrans-2815
  prefs: []
  type: TYPE_NORMAL
  zh: 生成的内容数据
- en: 178, 189, 331
  id: totrans-2816
  prefs: []
  type: TYPE_NORMAL
  zh: 178, 189, 331
- en: by Netsniff-ng, 105
  id: totrans-2817
  prefs: []
  type: TYPE_NORMAL
  zh: 由Netsniff-ng，105
- en: SO (Security Onion)
  id: totrans-2818
  prefs: []
  type: TYPE_NORMAL
  zh: SO（Security Onion）
- en: '**t**'
  id: totrans-2819
  prefs: []
  type: TYPE_NORMAL
  zh: '**t**'
- en: core tools, 116
  id: totrans-2820
  prefs: []
  type: TYPE_NORMAL
  zh: 核心工具，116
- en: data collection tool category of, 115
  id: totrans-2821
  prefs: []
  type: TYPE_NORMAL
  zh: 数据采集工具类别的，115
- en: Tcpdump
  id: totrans-2822
  prefs: []
  type: TYPE_NORMAL
  zh: Tcpdump
- en: data delivery tool category of, 115
  id: totrans-2823
  prefs: []
  type: TYPE_NORMAL
  zh: 数据传输工具类别的，115
- en: for collecting sample traffic, 268,
  id: totrans-2824
  prefs: []
  type: TYPE_NORMAL
  zh: 用于收集样本流量，268,
- en: data presentation tool
  id: totrans-2825
  prefs: []
  type: TYPE_NORMAL
  zh: 数据展示工具
- en: 280–281, 291
  id: totrans-2826
  prefs: []
  type: TYPE_NORMAL
  zh: 280–281, 291
- en: category of, 114
  id: totrans-2827
  prefs: []
  type: TYPE_NORMAL
  zh: 类别的，114
- en: as packet analysis tool, 114
  id: totrans-2828
  prefs: []
  type: TYPE_NORMAL
  zh: 作为数据包分析工具，114
- en: data storage with, 105–106
  id: totrans-2829
  prefs: []
  type: TYPE_NORMAL
  zh: 与之数据存储，105–106
- en: as source of full content data, 16–18
  id: totrans-2830
  prefs: []
  type: TYPE_NORMAL
  zh: 作为完整内容数据的来源，16–18
- en: estimating database storage of,
  id: totrans-2831
  prefs: []
  type: TYPE_NORMAL
  zh: 估算数据库存储的，
- en: usage of, 116–122
  id: totrans-2832
  prefs: []
  type: TYPE_NORMAL
  zh: 使用情况，116–122
- en: 107–108
  id: totrans-2833
  prefs: []
  type: TYPE_NORMAL
  zh: 107–108
- en: Tcpflow, 229–230, 291–293
  id: totrans-2834
  prefs: []
  type: TYPE_NORMAL
  zh: Tcpflow，229–230, 291–293
- en: estimating filesystem
  id: totrans-2835
  prefs: []
  type: TYPE_NORMAL
  zh: 估算文件系统
- en: Team Cymru, 283
  id: totrans-2836
  prefs: []
  type: TYPE_NORMAL
  zh: Team Cymru，283
- en: storage of, 108
  id: totrans-2837
  prefs: []
  type: TYPE_NORMAL
  zh: 存储，108
- en: threat-centric security, 199
  id: totrans-2838
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁中心安全，199
- en: installation of,
  id: totrans-2839
  prefs: []
  type: TYPE_NORMAL
  zh: 安装，
- en: Threat Stack, 305
  id: totrans-2840
  prefs: []
  type: TYPE_NORMAL
  zh: Threat Stack，305
- en: sensor system via *.iso*, 80–84
  id: totrans-2841
  prefs: []
  type: TYPE_NORMAL
  zh: 通过*.iso*的传感器系统，80–84
- en: '*threshold.conf*, 323, 330'
  id: totrans-2842
  prefs: []
  type: TYPE_NORMAL
  zh: '*threshold.conf*，323, 330'
- en: sensor system via PPA, 92–96
  id: totrans-2843
  prefs: []
  type: TYPE_NORMAL
  zh: 通过PPA的传感器系统，92–96
- en: time
  id: totrans-2844
  prefs: []
  type: TYPE_NORMAL
  zh: 时间
- en: server system via *.iso*, 77–80
  id: totrans-2845
  prefs: []
  type: TYPE_NORMAL
  zh: 通过*.iso*的服务器系统，77–80
- en: events to record, 201
  id: totrans-2846
  prefs: []
  type: TYPE_NORMAL
  zh: 需要记录的事件，201
- en: server system via PPA, 85–91
  id: totrans-2847
  prefs: []
  type: TYPE_NORMAL
  zh: 通过PPA的服务器系统，85–91
- en: importance of, 5
  id: totrans-2848
  prefs: []
  type: TYPE_NORMAL
  zh: 重要性，5
- en: stand-alone system, 59–73
  id: totrans-2849
  prefs: []
  type: TYPE_NORMAL
  zh: 独立系统，59–73
- en: '*/tmp/ra.conf*, 131–132'
  id: totrans-2850
  prefs: []
  type: TYPE_NORMAL
  zh: '*/tmp/ra.conf*，131–132'
- en: '**340** Index'
  id: totrans-2851
  prefs: []
  type: TYPE_NORMAL
  zh: '**340** 索引'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2852
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '*/tmp/.xkey.log*, as logged keystrokes,'
  id: totrans-2853
  prefs: []
  type: TYPE_NORMAL
  zh: '*/tmp/.xkey.log*，作为记录的按键，'
- en: Webber, Dustin, 174, 177, 305
  id: totrans-2854
  prefs: []
  type: TYPE_NORMAL
  zh: Webber, Dustin，174, 177, 305
- en: 253–255
  id: totrans-2855
  prefs: []
  type: TYPE_NORMAL
  zh: 253–255
- en: '*weird.log*, as generated by Bro, 299'
  id: totrans-2856
  prefs: []
  type: TYPE_NORMAL
  zh: '*weird.log*，由Bro生成，299'
- en: traffic
  id: totrans-2857
  prefs: []
  type: TYPE_NORMAL
  zh: 流量
- en: WHOIS
  id: totrans-2858
  prefs: []
  type: TYPE_NORMAL
  zh: WHOIS
- en: capturing on a client or server, 49
  id: totrans-2859
  prefs: []
  type: TYPE_NORMAL
  zh: 在客户端或服务器上捕获，49
- en: as form of metadata, 26–27
  id: totrans-2860
  prefs: []
  type: TYPE_NORMAL
  zh: 作为元数据的一种形式，26-27
- en: processing, 122, 128
  id: totrans-2861
  prefs: []
  type: TYPE_NORMAL
  zh: 处理，122，128
- en: as used in Sguil, 164–165
  id: totrans-2862
  prefs: []
  type: TYPE_NORMAL
  zh: 在Sguil中的应用，164-165
- en: and Tcpdump, 268, 280-281, 291
  id: totrans-2863
  prefs: []
  type: TYPE_NORMAL
  zh: 以及Tcpdump，268，280-281，291
- en: whois, as tool to query Malware Hash
  id: totrans-2864
  prefs: []
  type: TYPE_NORMAL
  zh: whois，作为查询恶意软件哈希的工具
- en: understanding flow, 35–38
  id: totrans-2865
  prefs: []
  type: TYPE_NORMAL
  zh: 理解流量流向，35-38
- en: Registry, 284
  id: totrans-2866
  prefs: []
  type: TYPE_NORMAL
  zh: 注册表，284
- en: transaction data, 22–23
  id: totrans-2867
  prefs: []
  type: TYPE_NORMAL
  zh: 交易数据，22-23
- en: Windows Management Instrumen-
  id: totrans-2868
  prefs: []
  type: TYPE_NORMAL
  zh: Windows管理工具
- en: Tshark,
  id: totrans-2869
  prefs: []
  type: TYPE_NORMAL
  zh: Tshark，
- en: tation Command-line
  id: totrans-2870
  prefs: []
  type: TYPE_NORMAL
  zh: 命令行标注
- en: reviewing checksums with, 296–297
  id: totrans-2871
  prefs: []
  type: TYPE_NORMAL
  zh: 校验和复审，296-297
- en: (WMIC), 189
  id: totrans-2872
  prefs: []
  type: TYPE_NORMAL
  zh: (WMIC)，189
- en: reviewing full content data with,
  id: totrans-2873
  prefs: []
  type: TYPE_NORMAL
  zh: 完整内容数据的复审，
- en: wireless local area network (WLAN),
  id: totrans-2874
  prefs: []
  type: TYPE_NORMAL
  zh: 无线局域网（WLAN），
- en: 216–218, 249
  id: totrans-2875
  prefs: []
  type: TYPE_NORMAL
  zh: 216-218，249
- en: 12–13, 34–35, 38–46,
  id: totrans-2876
  prefs: []
  type: TYPE_NORMAL
  zh: 12-13，34-35，38-46，
- en: usage of, 122–128
  id: totrans-2877
  prefs: []
  type: TYPE_NORMAL
  zh: 使用，122-128
- en: 238, 246
  id: totrans-2878
  prefs: []
  type: TYPE_NORMAL
  zh: 238，246
- en: Twitter, as compromise vector, 238–239
  id: totrans-2879
  prefs: []
  type: TYPE_NORMAL
  zh: Twitter，作为攻击向量，238-239
- en: Wireshark
  id: totrans-2880
  prefs: []
  type: TYPE_NORMAL
  zh: Wireshark
- en: 256, 261–262
  id: totrans-2881
  prefs: []
  type: TYPE_NORMAL
  zh: 256，261-262
- en: counting bytes in session data
  id: totrans-2882
  prefs: []
  type: TYPE_NORMAL
  zh: 计算会话数据中的字节
- en: using, 169
  id: totrans-2883
  prefs: []
  type: TYPE_NORMAL
  zh: 使用，169
- en: '**U**'
  id: totrans-2884
  prefs: []
  type: TYPE_NORMAL
  zh: '**U**'
- en: decoding protocols in, 144–145
  id: totrans-2885
  prefs: []
  type: TYPE_NORMAL
  zh: 解码协议，144-145
- en: following streams in, 143–144
  id: totrans-2886
  prefs: []
  type: TYPE_NORMAL
  zh: 跟踪流，143-144
- en: Ubuntu, as NSM platform operating
  id: totrans-2887
  prefs: []
  type: TYPE_NORMAL
  zh: Ubuntu，作为NSM平台操作系统
- en: modifying default column
  id: totrans-2888
  prefs: []
  type: TYPE_NORMAL
  zh: 修改默认列
- en: system, 59, 64–65, 85–94
  id: totrans-2889
  prefs: []
  type: TYPE_NORMAL
  zh: 系统，59，64-65，85-94
- en: layout of, 137–140
  id: totrans-2890
  prefs: []
  type: TYPE_NORMAL
  zh: 布局，137-140
- en: UFW (Uncomplicated Firewall),
  id: totrans-2891
  prefs: []
  type: TYPE_NORMAL
  zh: UFW（简单防火墙），
- en: as packet analysis tool, 18–19
  id: totrans-2892
  prefs: []
  type: TYPE_NORMAL
  zh: 作为数据包分析工具，18-19
- en: 102–103, 105
  id: totrans-2893
  prefs: []
  type: TYPE_NORMAL
  zh: 102-103，105
- en: problems when sniffing traffic
  id: totrans-2894
  prefs: []
  type: TYPE_NORMAL
  zh: 捕获流量时的问题
- en: Unit 61398\. *See* APT (Advanced
  id: totrans-2895
  prefs: []
  type: TYPE_NORMAL
  zh: 61398单元。*见* APT（高级持续威胁）
- en: as root with, 123–124
  id: totrans-2896
  prefs: []
  type: TYPE_NORMAL
  zh: 作为root使用，123-124
- en: Persistent Threat)
  id: totrans-2897
  prefs: []
  type: TYPE_NORMAL
  zh: 持续威胁）
- en: as source of extracted content data,
  id: totrans-2898
  prefs: []
  type: TYPE_NORMAL
  zh: 作为提取内容数据的来源，
- en: Universal Coordinated Time (UTC),
  id: totrans-2899
  prefs: []
  type: TYPE_NORMAL
  zh: 协调世界时（UTC），
- en: 19–20
  id: totrans-2900
  prefs: []
  type: TYPE_NORMAL
  zh: 19-20
- en: 62, 70, 118
  id: totrans-2901
  prefs: []
  type: TYPE_NORMAL
  zh: 62，70，118
- en: as source of statistical data, 24–26
  id: totrans-2902
  prefs: []
  type: TYPE_NORMAL
  zh: 作为统计数据源，24-26
- en: Unix epoch time, 118
  id: totrans-2903
  prefs: []
  type: TYPE_NORMAL
  zh: Unix纪元时间，118
- en: usage of, 136–147
  id: totrans-2904
  prefs: []
  type: TYPE_NORMAL
  zh: 使用，136-147
- en: understanding traffic flow, 35–38
  id: totrans-2905
  prefs: []
  type: TYPE_NORMAL
  zh: 理解流量流向，35-38
- en: Wiretap Act, 13
  id: totrans-2906
  prefs: []
  type: TYPE_NORMAL
  zh: 《窃听法》，13
- en: UTC (Universal Coordinated Time),
  id: totrans-2907
  prefs: []
  type: TYPE_NORMAL
  zh: UTC（协调世界时），
- en: WLAN (wireless local area network),
  id: totrans-2908
  prefs: []
  type: TYPE_NORMAL
  zh: WLAN（无线局域网），
- en: 62, 70, 118
  id: totrans-2909
  prefs: []
  type: TYPE_NORMAL
  zh: 62，70，118
- en: 12–13, 34–35, 38–46,
  id: totrans-2910
  prefs: []
  type: TYPE_NORMAL
  zh: 12-13，34-35，38-46，
- en: 238, 246
  id: totrans-2911
  prefs: []
  type: TYPE_NORMAL
  zh: 238，246
- en: '**V**'
  id: totrans-2912
  prefs: []
  type: TYPE_NORMAL
  zh: '**V**'
- en: WMIC (Windows Management
  id: totrans-2913
  prefs: []
  type: TYPE_NORMAL
  zh: WMIC（Windows管理工具）
- en: VERIS (Vocabulary for Event
  id: totrans-2914
  prefs: []
  type: TYPE_NORMAL
  zh: VERIS（事件词汇表）
- en: Instrumentation
  id: totrans-2915
  prefs: []
  type: TYPE_NORMAL
  zh: 仪器化
- en: Recording and Incident
  id: totrans-2916
  prefs: []
  type: TYPE_NORMAL
  zh: 记录与事件
- en: Command-line), 189
  id: totrans-2917
  prefs: []
  type: TYPE_NORMAL
  zh: 命令行），189
- en: Sharing), 196
  id: totrans-2918
  prefs: []
  type: TYPE_NORMAL
  zh: 共享），196
- en: '*www.testmyids.com*, 15–16, 20–23, 28–29,'
  id: totrans-2919
  prefs: []
  type: TYPE_NORMAL
  zh: '*www.testmyids.com*，15-16，20-23，28-29，'
- en: virtual private network (VPN), 31, 58,
  id: totrans-2920
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟私人网络（VPN），31，58，
- en: 71, 84, 179
  id: totrans-2921
  prefs: []
  type: TYPE_NORMAL
  zh: 71，84，179
- en: '258'
  id: totrans-2922
  prefs: []
  type: TYPE_NORMAL
  zh: '258'
- en: VirusTotal
  id: totrans-2923
  prefs: []
  type: TYPE_NORMAL
  zh: VirusTotal
- en: '**X**'
  id: totrans-2924
  prefs: []
  type: TYPE_NORMAL
  zh: '**X**'
- en: submitting a binary to, 273–275
  id: totrans-2925
  prefs: []
  type: TYPE_NORMAL
  zh: 提交二进制文件至，273-275
- en: X forwarding via Secure Shell, 95
  id: totrans-2926
  prefs: []
  type: TYPE_NORMAL
  zh: 通过安全外壳转发X，95
- en: submitting a hash to, 264–266,
  id: totrans-2927
  prefs: []
  type: TYPE_NORMAL
  zh: 提交哈希至，264-266，
- en: Xplico, usage of, 147–153
  id: totrans-2928
  prefs: []
  type: TYPE_NORMAL
  zh: Xplico，使用，147-153
- en: 273–274, 288
  id: totrans-2929
  prefs: []
  type: TYPE_NORMAL
  zh: 273-274，288
- en: Xubuntu, as NSM platform operating
  id: totrans-2930
  prefs: []
  type: TYPE_NORMAL
  zh: Xubuntu，作为NSM平台操作系统
- en: Visscher, Bamm, 3
  id: totrans-2931
  prefs: []
  type: TYPE_NORMAL
  zh: Visscher，Bamm，3
- en: system, 59–60, 63–65
  id: totrans-2932
  prefs: []
  type: TYPE_NORMAL
  zh: 系统，59-60，63-65
- en: Vocabulary for Event Recording
  id: totrans-2933
  prefs: []
  type: TYPE_NORMAL
  zh: 事件记录词汇表
- en: and Incident Sharing
  id: totrans-2934
  prefs: []
  type: TYPE_NORMAL
  zh: 以及事件共享
- en: '**Y**'
  id: totrans-2935
  prefs: []
  type: TYPE_NORMAL
  zh: '**Y**'
- en: (VERIS), 196
  id: totrans-2936
  prefs: []
  type: TYPE_NORMAL
  zh: (VERIS)，196
- en: VPN (virtual private network), 31,
  id: totrans-2937
  prefs: []
  type: TYPE_NORMAL
  zh: VPN（虚拟私人网络），31，
- en: Young, David, 116
  id: totrans-2938
  prefs: []
  type: TYPE_NORMAL
  zh: Young，David，116
- en: 58, 258
  id: totrans-2939
  prefs: []
  type: TYPE_NORMAL
  zh: 58，258
- en: '*YYYY-MM-DD.log*, as session data'
  id: totrans-2940
  prefs: []
  type: TYPE_NORMAL
  zh: '*YYYY-MM-DD.log*，作为会话数据'
- en: generated by Argus, 129
  id: totrans-2941
  prefs: []
  type: TYPE_NORMAL
  zh: 由Argus生成，129
- en: '**W**'
  id: totrans-2942
  prefs: []
  type: TYPE_NORMAL
  zh: '**W**'
- en: Wade, Aaron, 193
  id: totrans-2943
  prefs: []
  type: TYPE_NORMAL
  zh: Wade，Aaron，193
- en: waves, for tracking CIRT activity,
  id: totrans-2944
  prefs: []
  type: TYPE_NORMAL
  zh: 波形，用于跟踪CIRT活动，
- en: 200–201
  id: totrans-2945
  prefs: []
  type: TYPE_NORMAL
  zh: 200-201
- en: Index **341**
  id: totrans-2946
  prefs: []
  type: TYPE_NORMAL
  zh: 索引 **341**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2947
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2948
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '*The Practice of Network Security Monitoring* is set in New Baskerville, TheSansMono
    Condensed, Futura, and Dogma.'
  id: totrans-2949
  prefs: []
  type: TYPE_NORMAL
  zh: '*《网络安全监控实践》*使用了New Baskerville、TheSansMono Condensed、Futura和Dogma字体。'
- en: This book was printed and bound at Edwards Brothers Malloy in
  id: totrans-2950
  prefs: []
  type: TYPE_NORMAL
  zh: 本书由Edwards Brothers Malloy印刷并装订
- en: Ann Arbor, Michigan. The paper is 70# Williamsburg Smooth, which is
  id: totrans-2951
  prefs: []
  type: TYPE_NORMAL
  zh: 密歇根州安阿伯。本文使用的是70# Williamsburg Smooth纸张，特点是
- en: certified by the Sustainable Forestry Initiative (SFI).
  id: totrans-2952
  prefs: []
  type: TYPE_NORMAL
  zh: 由可持续森林倡议（SFI）认证。
- en: The book uses a RepKover binding, in which the pages are bound
  id: totrans-2953
  prefs: []
  type: TYPE_NORMAL
  zh: 本书使用了RepKover装订方式，页面通过
- en: together with a cold-set, flexible glue and the first and last pages of the
  id: totrans-2954
  prefs: []
  type: TYPE_NORMAL
  zh: 配合冷设定的柔性胶水以及书的首尾页面一起使用
- en: resulting book block are attached to the cover with tape. The cover is
  id: totrans-2955
  prefs: []
  type: TYPE_NORMAL
  zh: 生成的书籍块通过胶带附着在封面上。封面是
- en: not actually glued to the book’s spine, and when open, the book lies flat
  id: totrans-2956
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上并未将其粘贴在书脊上，打开时，书籍会平躺
- en: and the spine doesn’t crack.
  id: totrans-2957
  prefs: []
  type: TYPE_NORMAL
  zh: 并且脊背不会断裂。
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-2958
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '![Image 164](index-378_1.jpg)'
  id: totrans-2959
  prefs: []
  type: TYPE_IMG
  zh: '![Image 164](index-378_1.jpg)'
- en: '![Image 165](index-378_2.jpg)'
  id: totrans-2960
  prefs: []
  type: TYPE_IMG
  zh: '![Image 165](index-378_2.jpg)'
- en: '![Image 166](index-378_3.png)'
  id: totrans-2961
  prefs: []
  type: TYPE_IMG
  zh: '![Image 166](index-378_3.png)'
- en: '![Image 167](index-378_4.jpg)'
  id: totrans-2962
  prefs: []
  type: TYPE_IMG
  zh: '![Image 167](index-378_4.jpg)'
- en: '![Image 168](index-378_5.jpg)'
  id: totrans-2963
  prefs: []
  type: TYPE_IMG
  zh: '![Image 168](index-378_5.jpg)'
- en: '![Image 169](index-378_6.png)'
  id: totrans-2964
  prefs: []
  type: TYPE_IMG
  zh: '![Image 169](index-378_6.png)'
- en: Updates
  id: totrans-2965
  prefs: []
  type: TYPE_NORMAL
  zh: 更新
- en: Visit *http://nostarch.com/nsm/* for updates, errata, and other information.
  id: totrans-2966
  prefs: []
  type: TYPE_NORMAL
  zh: 访问*http://nostarch.com/nsm/*获取更新、勘误和其他信息。
- en: '*More no-nonsense books from*'
  id: totrans-2967
  prefs: []
  type: TYPE_NORMAL
  zh: '*更多直接了当的书籍来自*'
- en: nO starcH press
  id: totrans-2968
  prefs: []
  type: TYPE_NORMAL
  zh: No Starch Press
- en: practical Malware analysis
  id: totrans-2969
  prefs: []
  type: TYPE_NORMAL
  zh: 实践恶意软件分析
- en: MetasplOit
  id: totrans-2970
  prefs: []
  type: TYPE_NORMAL
  zh: Metasploit
- en: practical packet analysis,
  id: totrans-2971
  prefs: []
  type: TYPE_NORMAL
  zh: 实用的包分析，
- en: the Hands-On Guide to
  id: totrans-2972
  prefs: []
  type: TYPE_NORMAL
  zh: 动手实践指南
- en: the penetration tester’s Guide
  id: totrans-2973
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试者指南
- en: 2nd editiOn
  id: totrans-2974
  prefs: []
  type: TYPE_NORMAL
  zh: 第二版
- en: dissecting Malicious software
  id: totrans-2975
  prefs: []
  type: TYPE_NORMAL
  zh: 解剖恶意软件
- en: '*by* david kennedy, jim o’gorman,'
  id: totrans-2976
  prefs: []
  type: TYPE_NORMAL
  zh: '*由* david kennedy, jim o’gorman,'
- en: Using wireshark to solve real-world
  id: totrans-2977
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Wireshark解决实际问题
- en: '*by* michael sikorski *and*'
  id: totrans-2978
  prefs: []
  type: TYPE_NORMAL
  zh: '*由* michael sikorski *和*'
- en: devon kearns, *and* mati aharoni
  id: totrans-2979
  prefs: []
  type: TYPE_NORMAL
  zh: devon kearns, *和* mati aharoni
- en: network problems
  id: totrans-2980
  prefs: []
  type: TYPE_NORMAL
  zh: 网络问题
- en: andrew honig
  id: totrans-2981
  prefs: []
  type: TYPE_NORMAL
  zh: andrew honig
- en: july 2011, 328 pp., $49.95
  id: totrans-2982
  prefs: []
  type: TYPE_NORMAL
  zh: 2011年7月，328页，$49.95
- en: '*by* chris sanders'
  id: totrans-2983
  prefs: []
  type: TYPE_NORMAL
  zh: '*由* chris sanders'
- en: february 2012, 800 pp., $59.95
  id: totrans-2984
  prefs: []
  type: TYPE_NORMAL
  zh: 2012年2月，800页，$59.95
- en: isbn 978-1-59327-288-3
  id: totrans-2985
  prefs: []
  type: TYPE_NORMAL
  zh: isbn 978-1-59327-288-3
- en: july 2011, 280 pp., $49.95
  id: totrans-2986
  prefs: []
  type: TYPE_NORMAL
  zh: 2011年7月，280页，$49.95
- en: isbn 978-1-59327-290-6
  id: totrans-2987
  prefs: []
  type: TYPE_NORMAL
  zh: isbn 978-1-59327-290-6
- en: isbn 978-1-59327-266-1
  id: totrans-2988
  prefs: []
  type: TYPE_NORMAL
  zh: isbn 978-1-59327-266-1
- en: HackinG, 2nd editiOn
  id: totrans-2989
  prefs: []
  type: TYPE_NORMAL
  zh: 黑客入门，第二版
- en: tHe tanGled web
  id: totrans-2990
  prefs: []
  type: TYPE_NORMAL
  zh: 错综复杂的网络
- en: absOlUte Openbsd,
  id: totrans-2991
  prefs: []
  type: TYPE_NORMAL
  zh: 绝对的OpenBSD，
- en: the art of exploitation
  id: totrans-2992
  prefs: []
  type: TYPE_NORMAL
  zh: 利用漏洞的艺术
- en: a Guide to securing Modern
  id: totrans-2993
  prefs: []
  type: TYPE_NORMAL
  zh: 现代安全指南
- en: 2nd editiOn
  id: totrans-2994
  prefs: []
  type: TYPE_NORMAL
  zh: 第二版
- en: '*by* jon erickson'
  id: totrans-2995
  prefs: []
  type: TYPE_NORMAL
  zh: '*由* jon erickson'
- en: web applications
  id: totrans-2996
  prefs: []
  type: TYPE_NORMAL
  zh: Web应用程序
- en: Unix for the practical paranoid
  id: totrans-2997
  prefs: []
  type: TYPE_NORMAL
  zh: Unix实用手册
- en: february 2008, 488 pp. w/cd, $49.95
  id: totrans-2998
  prefs: []
  type: TYPE_NORMAL
  zh: 2008年2月，488页，带CD，$49.95
- en: '*by* michal zalewski'
  id: totrans-2999
  prefs: []
  type: TYPE_NORMAL
  zh: '*由* michal zalewski'
- en: '*by* michael w. lucas'
  id: totrans-3000
  prefs: []
  type: TYPE_NORMAL
  zh: '*由* michael w. lucas'
- en: isbn 978-1-59327-144-2
  id: totrans-3001
  prefs: []
  type: TYPE_NORMAL
  zh: isbn 978-1-59327-144-2
- en: november 2011, 320 pp., $49.95
  id: totrans-3002
  prefs: []
  type: TYPE_NORMAL
  zh: 2011年11月，320页，$49.95
- en: april 2013, 536 pp., $59.95
  id: totrans-3003
  prefs: []
  type: TYPE_NORMAL
  zh: 2013年4月，536页，$59.95
- en: isbn 978-1-59327-388-0
  id: totrans-3004
  prefs: []
  type: TYPE_NORMAL
  zh: isbn 978-1-59327-388-0
- en: isbn 978-1-59327-476-4
  id: totrans-3005
  prefs: []
  type: TYPE_NORMAL
  zh: isbn 978-1-59327-476-4
- en: 'phone:'
  id: totrans-3006
  prefs: []
  type: TYPE_NORMAL
  zh: 电话：
- en: 'email:'
  id: totrans-3007
  prefs: []
  type: TYPE_NORMAL
  zh: 邮箱：
- en: 800.420.7240 or
  id: totrans-3008
  prefs: []
  type: TYPE_NORMAL
  zh: 800.420.7240 或
- en: sales@nostarch.com
  id: totrans-3009
  prefs: []
  type: TYPE_NORMAL
  zh: sales@nostarch.com
- en: 415.863.9900
  id: totrans-3010
  prefs: []
  type: TYPE_NORMAL
  zh: 415.863.9900
- en: 'web:'
  id: totrans-3011
  prefs: []
  type: TYPE_NORMAL
  zh: 网站：
- en: www.nostarch.com
  id: totrans-3012
  prefs: []
  type: TYPE_NORMAL
  zh: www.nostarch.com
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-3013
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-3014
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '![Image 170](index-380_1.png)'
  id: totrans-3015
  prefs: []
  type: TYPE_IMG
  zh: '![Image 170](index-380_1.png)'
- en: '**C O L L E C T**'
  id: totrans-3016
  prefs: []
  type: TYPE_NORMAL
  zh: '**C O L L E C T**'
- en: '**Foreword by Todd Heberlein,**'
  id: totrans-3017
  prefs: []
  type: TYPE_NORMAL
  zh: '**序言由Todd Heberlein**'
- en: '**A N A L Y Z E**'
  id: totrans-3018
  prefs: []
  type: TYPE_NORMAL
  zh: '**A N A L Y Z E**'
- en: '**Developer of the Network**'
  id: totrans-3019
  prefs: []
  type: TYPE_NORMAL
  zh: '**网络开发者**'
- en: '**E S C A L A T E**'
  id: totrans-3020
  prefs: []
  type: TYPE_NORMAL
  zh: '**E S C A L A T E**'
- en: '**Security Monitor System**'
  id: totrans-3021
  prefs: []
  type: TYPE_NORMAL
  zh: '**安全监控系统**'
- en: '**N**'
  id: totrans-3022
  prefs: []
  type: TYPE_NORMAL
  zh: '**N**'
- en: '**T H E P R A C T I C E O F**'
  id: totrans-3023
  prefs: []
  type: TYPE_NORMAL
  zh: '**网络安全实践**'
- en: '**ETW**'
  id: totrans-3024
  prefs: []
  type: TYPE_NORMAL
  zh: '**ETW**'
- en: '**N E T W O R K S E C U R I T Y**'
  id: totrans-3025
  prefs: []
  type: TYPE_NORMAL
  zh: '**网络安全**'
- en: '**OR**'
  id: totrans-3026
  prefs: []
  type: TYPE_NORMAL
  zh: '**或**'
- en: Network security is not simply about building impene-
  id: totrans-3027
  prefs: []
  type: TYPE_NORMAL
  zh: 网络安全不仅仅是建立无法渗透的
- en: • Interpret network evidence from server-side and
  id: totrans-3028
  prefs: []
  type: TYPE_NORMAL
  zh: • 解释服务器端和
- en: '**M O N I T O R I N G**'
  id: totrans-3029
  prefs: []
  type: TYPE_NORMAL
  zh: '**监控**'
- en: trable walls—determined attackers *will* eventually over-
  id: totrans-3030
  prefs: []
  type: TYPE_NORMAL
  zh: 因为坚决的攻击者*终将*突破
- en: client-side intrusions
  id: totrans-3031
  prefs: []
  type: TYPE_NORMAL
  zh: 客户端入侵
- en: '**K T**'
  id: totrans-3032
  prefs: []
  type: TYPE_NORMAL
  zh: '**K T**'
- en: come traditional defenses. The most effective computer
  id: totrans-3033
  prefs: []
  type: TYPE_NORMAL
  zh: 传统防御体系已经不再有效。最有效的计算机
- en: • Integrate threat intelligence into NSM software to
  id: totrans-3034
  prefs: []
  type: TYPE_NORMAL
  zh: • 将威胁情报整合进NSM软件
- en: '**H**'
  id: totrans-3035
  prefs: []
  type: TYPE_NORMAL
  zh: '**H**'
- en: security strategies integrate network security monitoring
  id: totrans-3036
  prefs: []
  type: TYPE_NORMAL
  zh: 安全策略整合网络安全监控
- en: '**SEC**'
  id: totrans-3037
  prefs: []
  type: TYPE_NORMAL
  zh: '**SEC**'
- en: '**U N D E R S T A N D I N G I N C I D E N T D E T E C T I O N**'
  id: totrans-3038
  prefs: []
  type: TYPE_NORMAL
  zh: '**理解事件检测**'
- en: '**SEC**'
  id: totrans-3039
  prefs: []
  type: TYPE_NORMAL
  zh: '**SEC**'
- en: identify sophisticated adversaries
  id: totrans-3040
  prefs: []
  type: TYPE_NORMAL
  zh: 识别复杂的对手
- en: '**E P**'
  id: totrans-3041
  prefs: []
  type: TYPE_NORMAL
  zh: '**E P**'
- en: '(NSM): the collection and analysis of data to help you'
  id: totrans-3042
  prefs: []
  type: TYPE_NORMAL
  zh: (NSM)：收集和分析数据以帮助你
- en: '**A N D R E S P O N S E**'
  id: totrans-3043
  prefs: []
  type: TYPE_NORMAL
  zh: '**应对响应**'
- en: detect and respond to intrusions.
  id: totrans-3044
  prefs: []
  type: TYPE_NORMAL
  zh: 检测和响应入侵。
- en: There’s no foolproof way to keep attackers out of
  id: totrans-3045
  prefs: []
  type: TYPE_NORMAL
  zh: 没有任何万无一失的方法能让攻击者无法进入
- en: your network. But when they get in, you’ll be prepared.
  id: totrans-3046
  prefs: []
  type: TYPE_NORMAL
  zh: 你的网络。但当他们入侵时，你将做好准备。
- en: In *The Practice of Network Security Monitoring*,
  id: totrans-3047
  prefs: []
  type: TYPE_NORMAL
  zh: 在*《网络安全监控实践》*中，
- en: '**R**'
  id: totrans-3048
  prefs: []
  type: TYPE_NORMAL
  zh: '**R**'
- en: '*The Practice of Network Security Monitoring* will show'
  id: totrans-3049
  prefs: []
  type: TYPE_NORMAL
  zh: '*《网络安全监控实践》*将向你展示'
- en: '**U**'
  id: totrans-3050
  prefs: []
  type: TYPE_NORMAL
  zh: '**U**'
- en: Mandiant CSO Richard Bejtlich shows you how to
  id: totrans-3051
  prefs: []
  type: TYPE_NORMAL
  zh: Mandiant的首席安全官Richard Bejtlich展示了如何
- en: you how to build a security net to detect, contain, and
  id: totrans-3052
  prefs: []
  type: TYPE_NORMAL
  zh: 如何建立一个安全网来检测、遏制并
- en: '**R A**'
  id: totrans-3053
  prefs: []
  type: TYPE_NORMAL
  zh: '**R A**'
- en: '**R I C H A R D B E J T L I C H**'
  id: totrans-3054
  prefs: []
  type: TYPE_NORMAL
  zh: '**R I C H A R D B E J T L I C H**'
- en: use NSM to add a robust layer of protection around
  id: totrans-3055
  prefs: []
  type: TYPE_NORMAL
  zh: 使用NSM为你的网络添加一层强大的保护
- en: '**R**'
  id: totrans-3056
  prefs: []
  type: TYPE_NORMAL
  zh: '**R**'
- en: control them. Attacks are inevitable, but losing sensitive
  id: totrans-3057
  prefs: []
  type: TYPE_NORMAL
  zh: 控制它们。攻击是不可避免的，但丧失敏感数据
- en: '**C**'
  id: totrans-3058
  prefs: []
  type: TYPE_NORMAL
  zh: '**C**'
- en: your networks—no prior experience required. To help
  id: totrans-3059
  prefs: []
  type: TYPE_NORMAL
  zh: 你的网络——无需任何经验。为了帮助
- en: '**I**'
  id: totrans-3060
  prefs: []
  type: TYPE_NORMAL
  zh: '**我**'
- en: data shouldn’t be.
  id: totrans-3061
  prefs: []
  type: TYPE_NORMAL
  zh: 数据不应该是。
- en: you avoid costly and inflexible solutions, he teaches you
  id: totrans-3062
  prefs: []
  type: TYPE_NORMAL
  zh: 你将学会如何避免昂贵且不灵活的解决方案
- en: '**T T**'
  id: totrans-3063
  prefs: []
  type: TYPE_NORMAL
  zh: '**T T**'
- en: how to deploy, build, and run an NSM operation using
  id: totrans-3064
  prefs: []
  type: TYPE_NORMAL
  zh: 如何部署、构建和运行NSM操作
- en: '**Y I**'
  id: totrans-3065
  prefs: []
  type: TYPE_NORMAL
  zh: '**Y I**'
- en: open source software and vendor-neutral tools.
  id: totrans-3066
  prefs: []
  type: TYPE_NORMAL
  zh: 开源软件和供应商中立工具。
- en: '**A B O U T T H E A U T H O R**'
  id: totrans-3067
  prefs: []
  type: TYPE_NORMAL
  zh: '**关于作者**'
- en: '**MONI CE O**'
  id: totrans-3068
  prefs: []
  type: TYPE_NORMAL
  zh: '**MONI CE O**'
- en: 'You’ll learn how to:'
  id: totrans-3069
  prefs: []
  type: TYPE_NORMAL
  zh: 你将学会如何：
- en: Richard Bejtlich is Chief Security Officer at Mandiant
  id: totrans-3070
  prefs: []
  type: TYPE_NORMAL
  zh: Richard Bejtlich是Mandiant的首席安全官
- en: and was previously Director of Incident Response for
  id: totrans-3071
  prefs: []
  type: TYPE_NORMAL
  zh: 曾任Mandiant事件响应总监
- en: • Determine where to deploy NSM platforms, and
  id: totrans-3072
  prefs: []
  type: TYPE_NORMAL
  zh: • 确定 NSM 平台的部署位置，并
- en: General Electric. He is a graduate of Harvard University
  id: totrans-3073
  prefs: []
  type: TYPE_NORMAL
  zh: 通用电气公司。他是哈佛大学的毕业生
- en: size them for the monitored networks
  id: totrans-3074
  prefs: []
  type: TYPE_NORMAL
  zh: 为被监控的网络配置适当的规模
- en: and the United States Air Force Academy. His previous
  id: totrans-3075
  prefs: []
  type: TYPE_NORMAL
  zh: 以及美国空军学院。他之前
- en: '**F**'
  id: totrans-3076
  prefs: []
  type: TYPE_NORMAL
  zh: '**F**'
- en: • Deploy stand-alone or distributed NSM installations
  id: totrans-3077
  prefs: []
  type: TYPE_NORMAL
  zh: • 部署独立或分布式的 NSM 安装
- en: works include *The Tao of Network Security Monitoring*,
  id: totrans-3078
  prefs: []
  type: TYPE_NORMAL
  zh: 他的作品包括 *网络安全监控的道*，
- en: '**T**'
  id: totrans-3079
  prefs: []
  type: TYPE_NORMAL
  zh: '**T**'
- en: '*Extrusion Detection*, and *Real Digital Forensics*. He writes'
  id: totrans-3080
  prefs: []
  type: TYPE_NORMAL
  zh: '*挤出检测* 和 *真实数字取证*。他写道'
- en: • Use command line and graphical packet analysis
  id: totrans-3081
  prefs: []
  type: TYPE_NORMAL
  zh: • 使用命令行和图形化数据包分析
- en: '**OR**'
  id: totrans-3082
  prefs: []
  type: TYPE_NORMAL
  zh: '**OR**'
- en: on his blog ( *http://taosecurity.blogspot.com*) and on
  id: totrans-3083
  prefs: []
  type: TYPE_NORMAL
  zh: 在他的博客上（ *http://taosecurity.blogspot.com*）以及
- en: tools and NSM consoles
  id: totrans-3084
  prefs: []
  type: TYPE_NORMAL
  zh: 工具和 NSM 控制台
- en: Twitter as @taosecurity.
  id: totrans-3085
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Twitter 上使用 @taosecurity。
- en: '**ING**'
  id: totrans-3086
  prefs: []
  type: TYPE_NORMAL
  zh: '**ING**'
- en: '***TH E FI N EST I N G E E K E NTE RTAI N M E NT™***'
  id: totrans-3087
  prefs: []
  type: TYPE_NORMAL
  zh: '***TH E FI N EST I N G E E K E NTE RTAI N M E NT™***'
- en: '**B**'
  id: totrans-3088
  prefs: []
  type: TYPE_NORMAL
  zh: '**B**'
- en: www.nostarch.com
  id: totrans-3089
  prefs: []
  type: TYPE_NORMAL
  zh: www.nostarch.com
- en: '**EJTL**'
  id: totrans-3090
  prefs: []
  type: TYPE_NORMAL
  zh: '**EJTL**'
- en: '**$49.95 *($52.95 CDN)***'
  id: totrans-3091
  prefs: []
  type: TYPE_NORMAL
  zh: '**$49.95 *($52.95 CDN)***'
- en: '**IC**'
  id: totrans-3092
  prefs: []
  type: TYPE_NORMAL
  zh: '**IC**'
- en: '***“I LIE FLAT.”***'
  id: totrans-3093
  prefs: []
  type: TYPE_NORMAL
  zh: '***“我平躺。”***'
- en: '**C S**'
  id: totrans-3094
  prefs: []
  type: TYPE_NORMAL
  zh: '**C S**'
- en: '**O H**'
  id: totrans-3095
  prefs: []
  type: TYPE_NORMAL
  zh: '**O H**'
- en: '**H**'
  id: totrans-3096
  prefs: []
  type: TYPE_NORMAL
  zh: '**H**'
- en: '**M ELV**'
  id: totrans-3097
  prefs: []
  type: TYPE_NORMAL
  zh: '**M ELV**'
- en: '*This book uses RepKover —a durable binding that won’t snap shut.*'
  id: totrans-3098
  prefs: []
  type: TYPE_NORMAL
  zh: '*本书采用 RepKover 装订 —— 一种耐用的绑定方式，不易合拢。*'
- en: '**PU E**'
  id: totrans-3099
  prefs: []
  type: TYPE_NORMAL
  zh: '**PU E**'
- en: '**T I**'
  id: totrans-3100
  prefs: []
  type: TYPE_NORMAL
  zh: '**T I**'
- en: '**E N**'
  id: totrans-3101
  prefs: []
  type: TYPE_NORMAL
  zh: '**E N**'
- en: '**R :**'
  id: totrans-3102
  prefs: []
  type: TYPE_NORMAL
  zh: '**R :**'
- en: '*“An invaluable resource for anyone detecting*'
  id: totrans-3103
  prefs: []
  type: TYPE_NORMAL
  zh: '*“对任何从事检测工作的人来说，都是一种宝贵的资源”*'
- en: '**S/SEC**'
  id: totrans-3104
  prefs: []
  type: TYPE_NORMAL
  zh: '**S/SEC**'
- en: '**U**'
  id: totrans-3105
  prefs: []
  type: TYPE_NORMAL
  zh: '**U**'
- en: '*and responding to security breaches.”*'
  id: totrans-3106
  prefs: []
  type: TYPE_NORMAL
  zh: '*并响应安全漏洞。”*'
- en: '**RITY**'
  id: totrans-3107
  prefs: []
  type: TYPE_NORMAL
  zh: '**RITY**'
- en: '***—Kevin Mandia, Mandiant CEO***'
  id: totrans-3108
  prefs: []
  type: TYPE_NORMAL
  zh: '***—凯文·曼迪亚，Mandiant CEO***'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-3109
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: Document Outline
  id: totrans-3110
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 文档大纲
- en: '[About the Author](index_split_000.html#p19)'
  id: totrans-3111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[关于作者](index_split_000.html#p19)'
- en: '[Foreword](index_split_000.html#p21)'
  id: totrans-3112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[前言](index_split_000.html#p21)'
- en: '[Preface](index_split_000.html#p27)'
  id: totrans-3113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[前言](index_split_000.html#p27)'
- en: '[Audience](index_split_000.html#p28)'
  id: totrans-3114
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[受众](index_split_000.html#p28)'
- en: '[Prerequisites](index_split_000.html#p29)'
  id: totrans-3115
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[前提条件](index_split_000.html#p29)'
- en: '[A Note on Software and Protocols](index_split_000.html#p29)'
  id: totrans-3116
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[软件与协议说明](index_split_000.html#p29)'
- en: '[Scope](index_split_000.html#p30)'
  id: totrans-3117
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[范围](index_split_000.html#p30)'
- en: '[Acknowledgements](index_split_000.html#p31)'
  id: totrans-3118
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[致谢](index_split_000.html#p31)'
- en: '[Part I: Getting Started](index_split_000.html#p35)'
  id: totrans-3119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第一部分：入门](index_split_000.html#p35)'
- en: '[Chapter 1: Network Security Monitoring Rationale](index_split_000.html#p37)'
  id: totrans-3120
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第1章：网络安全监控的基本原理](index_split_000.html#p37)'
- en: '[An Introduction to NSM](index_split_000.html#p38)'
  id: totrans-3121
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[NSM 入门](index_split_000.html#p38)'
- en: '[Does NSM Prevent Intrusions?](index_split_000.html#p39)'
  id: totrans-3122
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[NSM 是否能防止入侵？](index_split_000.html#p39)'
- en: '[What Is the Difference Between NSM and Continuous Monitoring?](index_split_000.html#p42)'
  id: totrans-3123
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[NSM 和持续监控有什么区别？](index_split_000.html#p42)'
- en: '[How Does NSM Compare with Other Approaches?](index_split_000.html#p43)'
  id: totrans-3124
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[NSM 与其他方法相比如何？](index_split_000.html#p43)'
- en: '[Why Does NSM Work?](index_split_000.html#p44)'
  id: totrans-3125
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[为什么 NSM 有效？](index_split_000.html#p44)'
- en: '[How NSM Is Set Up](index_split_000.html#p45)'
  id: totrans-3126
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[如何设置 NSM](index_split_000.html#p45)'
- en: '[When NSM Won’t Work](index_split_000.html#p46)'
  id: totrans-3127
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[NSM 不适用的情况](index_split_000.html#p46)'
- en: '[Is NSM Legal?](index_split_000.html#p47)'
  id: totrans-3128
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[NSM 合法吗？](index_split_000.html#p47)'
- en: '[How Can You Protect User Privacy During NSM Operations?](index_split_000.html#p48)'
  id: totrans-3129
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[如何在 NSM 操作中保护用户隐私？](index_split_000.html#p48)'
- en: '[A Sample NSM Test](index_split_000.html#p49)'
  id: totrans-3130
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[NSM 测试示例](index_split_000.html#p49)'
- en: '[The Range of NSM Data](index_split_000.html#p50)'
  id: totrans-3131
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[NSM 数据的范围](index_split_000.html#p50)'
- en: '[Full Content Data](index_split_000.html#p50)'
  id: totrans-3132
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[完整内容数据](index_split_000.html#p50)'
- en: '[Extracted Content Data](index_split_001.html#p53)'
  id: totrans-3133
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[提取的内容数据](index_split_001.html#p53)'
- en: '[Session Data](index_split_001.html#p55)'
  id: totrans-3134
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[会话数据](index_split_001.html#p55)'
- en: '[Transaction Data](index_split_001.html#p56)'
  id: totrans-3135
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[交易数据](index_split_001.html#p56)'
- en: '[Statistical Data](index_split_001.html#p58)'
  id: totrans-3136
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[统计数据](index_split_001.html#p58)'
- en: '[Metadata](index_split_001.html#p60)'
  id: totrans-3137
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[元数据](index_split_001.html#p60)'
- en: '[Alert Data](index_split_001.html#p62)'
  id: totrans-3138
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[告警数据](index_split_001.html#p62)'
- en: '[What’s the Point of All This Data?](index_split_001.html#p64)'
  id: totrans-3139
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[所有这些数据的意义何在？](index_split_001.html#p64)'
- en: '[NSM Drawbacks](index_split_001.html#p65)'
  id: totrans-3140
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[NSM 的缺点](index_split_001.html#p65)'
- en: '[Where Can I Buy NSM?](index_split_001.html#p65)'
  id: totrans-3141
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[我在哪里可以购买 NSM？](index_split_001.html#p65)'
- en: '[Where Can I Go for Support or More Information?](index_split_001.html#p66)'
  id: totrans-3142
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[我可以去哪里获得支持或更多信息？](index_split_001.html#p66)'
- en: '[Conclusion](index_split_001.html#p66)'
  id: totrans-3143
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[结论](index_split_001.html#p66)'
- en: '[Chapter 2: Collecting Network Traffic: Access, Storage, and Management](index_split_001.html#p67)'
  id: totrans-3144
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第2章：收集网络流量：访问、存储和管理](index_split_001.html#p67)'
- en: '[A Sample Network for a Pilot NSM System](index_split_001.html#p67)'
  id: totrans-3145
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[试点 NSM 系统的示例网络](index_split_001.html#p67)'
- en: '[Traffic Flow in a Simple Network](index_split_001.html#p69)'
  id: totrans-3146
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[简单网络中的流量](index_split_001.html#p69)'
- en: '[Possible Locations for NSM](index_split_001.html#p72)'
  id: totrans-3147
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[NSM 可能的部署位置](index_split_001.html#p72)'
- en: '[IP Addresses and Network Address Translation](index_split_001.html#p73)'
  id: totrans-3148
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[IP 地址与网络地址转换](index_split_001.html#p73)'
- en: '[Net Blocks](index_split_001.html#p73)'
  id: totrans-3149
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[网络块](index_split_001.html#p73)'
- en: '[IP Address Assignments](index_split_001.html#p75)'
  id: totrans-3150
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[IP 地址分配](index_split_001.html#p75)'
- en: '[Address Translation](index_split_001.html#p76)'
  id: totrans-3151
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[地址转换](index_split_001.html#p76)'
- en: '[Choosing the Best Place to Obtain Network Visibility](index_split_001.html#p79)'
  id: totrans-3152
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[选择最佳位置以获取网络可见性](index_split_001.html#p79)'
- en: '[Location for DMZ Network Traffic](index_split_001.html#p79)'
  id: totrans-3153
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[DMZ 网络流量的位置](index_split_001.html#p79)'
- en: '[Locations for Viewing the Wireless and Internal Network Traffic](index_split_001.html#p79)'
  id: totrans-3154
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[查看无线和内部网络流量的位置](index_split_001.html#p79)'
- en: '[Getting Physical Access to the Traffic](index_split_001.html#p81)'
  id: totrans-3155
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[获取流量的物理访问权限](index_split_001.html#p81)'
- en: '[Using Switches for Traffic Monitoring](index_split_001.html#p81)'
  id: totrans-3156
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用交换机进行流量监控](index_split_001.html#p81)'
- en: '[Using a Network Tap](index_split_001.html#p82)'
  id: totrans-3157
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用网络 Tap](index_split_001.html#p82)'
- en: '[Capturing Traffic Directly on a Client or Server](index_split_001.html#p83)'
  id: totrans-3158
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[直接在客户端或服务器上捕获流量](index_split_001.html#p83)'
- en: '[Choosing an NSM Platform](index_split_001.html#p83)'
  id: totrans-3159
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[选择一个 NSM 平台](index_split_001.html#p83)'
- en: '[Ten NSM Platform Management Recommendations](index_split_001.html#p85)'
  id: totrans-3160
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[十条 NSM 平台管理建议](index_split_001.html#p85)'
- en: '[Conclusion](index_split_001.html#p86)'
  id: totrans-3161
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[结论](index_split_001.html#p86)'
- en: '[Part II: Security Onion Deployment](index_split_001.html#p87)'
  id: totrans-3162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第二部分：Security Onion 部署](index_split_001.html#p87)'
- en: '[Chapter 3: Stand-alone NSM Deployment and Installation](index_split_001.html#p89)'
  id: totrans-3163
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第3章：独立 NSM 部署与安装](index_split_001.html#p89)'
- en: '[Stand-alone or Server Plus Sensors?](index_split_001.html#p90)'
  id: totrans-3164
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[独立使用还是服务器加传感器？](index_split_001.html#p90)'
- en: '[Choosing How to Get SO Code onto Hardware](index_split_001.html#p93)'
  id: totrans-3165
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[选择如何将 SO 代码传输到硬件](index_split_001.html#p93)'
- en: '[Installing a Stand-alone System](index_split_001.html#p93)'
  id: totrans-3166
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[安装独立系统](index_split_001.html#p93)'
- en: '[Installing SO to a Hard Drive](index_split_001.html#p94)'
  id: totrans-3167
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[将 SO 安装到硬盘](index_split_001.html#p94)'
- en: '[Configuring SO Software](index_split_001.html#p98)'
  id: totrans-3168
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[配置 SO 软件](index_split_001.html#p98)'
- en: '[Choosing the Management Interface](index_split_001.html#p100)'
  id: totrans-3169
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[选择管理接口](index_split_001.html#p100)'
- en: '[Installing the NSM Software Components](index_split_001.html#p102)'
  id: totrans-3170
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[安装 NSM 软件组件](index_split_001.html#p102)'
- en: '[Checking Your Installation](index_split_002.html#p104)'
  id: totrans-3171
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[检查你的安装](index_split_002.html#p104)'
- en: '[Conclusion](index_split_002.html#p108)'
  id: totrans-3172
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[结论](index_split_002.html#p108)'
- en: '[Chapter 4: Distributed Deployment](index_split_002.html#p109)'
  id: totrans-3173
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第4章：分布式部署](index_split_002.html#p109)'
- en: '[Installing an SO Server Using the SO .iso File](index_split_002.html#p110)'
  id: totrans-3174
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 SO .iso 文件安装 SO 服务器](index_split_002.html#p110)'
- en: '[SO Server Considerations](index_split_002.html#p110)'
  id: totrans-3175
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[SO 服务器注意事项](index_split_002.html#p110)'
- en: '[Building Your SO Server](index_split_002.html#p111)'
  id: totrans-3176
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[搭建 SO 服务器](index_split_002.html#p111)'
- en: '[Configuring Your SO Server](index_split_002.html#p112)'
  id: totrans-3177
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[配置你的 SO 服务器](index_split_002.html#p112)'
- en: '[Installing an SO Sensor Using the SO .iso Image](index_split_002.html#p114)'
  id: totrans-3178
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 SO .iso 镜像安装 SO 传感器](index_split_002.html#p114)'
- en: '[Configuring the SO Sensor](index_split_002.html#p115)'
  id: totrans-3179
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[配置 SO 传感器](index_split_002.html#p115)'
- en: '[Completing Setup](index_split_002.html#p117)'
  id: totrans-3180
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[完成设置](index_split_002.html#p117)'
- en: '[Verifying that the Sensors Are Working](index_split_002.html#p118)'
  id: totrans-3181
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[验证传感器是否正常工作](index_split_002.html#p118)'
- en: '[Verifying that the Autossh Tunnel Is Working](index_split_002.html#p118)'
  id: totrans-3182
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[验证 Autossh 隧道是否工作](index_split_002.html#p118)'
- en: '[Building an SO Server Using PPAs](index_split_002.html#p119)'
  id: totrans-3183
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 PPA 构建 SO 服务器](index_split_002.html#p119)'
- en: '[Installing Ubuntu Server as the SO Server Operating System](index_split_002.html#p119)'
  id: totrans-3184
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[将 Ubuntu Server 安装为 SO 服务器操作系统](index_split_002.html#p119)'
- en: '[Choosing a Static IP Address](index_split_002.html#p121)'
  id: totrans-3185
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[选择静态 IP 地址](index_split_002.html#p121)'
- en: '[Updating the Software](index_split_002.html#p122)'
  id: totrans-3186
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[更新软件](index_split_002.html#p122)'
- en: '[Beginning MySQL and PPA Setup on the SO Server](index_split_002.html#p123)'
  id: totrans-3187
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[开始在 SO 服务器上设置 MySQL 和 PPA](index_split_002.html#p123)'
- en: '[Configuring Your SO Server via PPA](index_split_002.html#p124)'
  id: totrans-3188
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[通过 PPA 配置你的 SO 服务器](index_split_002.html#p124)'
- en: '[Building an SO Sensor Using PPAs](index_split_002.html#p126)'
  id: totrans-3189
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 PPA 构建 SO 传感器](index_split_002.html#p126)'
- en: '[Installing Ubuntu Server as the SO Sensor Operating System](index_split_002.html#p126)'
  id: totrans-3190
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[将 Ubuntu Server 安装为 SO 传感器操作系统](index_split_002.html#p126)'
- en: '[Configuring the System as a Sensor](index_split_002.html#p128)'
  id: totrans-3191
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[将系统配置为传感器](index_split_002.html#p128)'
- en: '[Running the Setup Wizard](index_split_002.html#p129)'
  id: totrans-3192
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[运行设置向导](index_split_002.html#p129)'
- en: '[Conclusion](index_split_002.html#p132)'
  id: totrans-3193
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[结论](index_split_002.html#p132)'
- en: '[Chapter 5: SO Platform Housekeeping](index_split_002.html#p133)'
  id: totrans-3194
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第5章：SO 平台日常维护](index_split_002.html#p133)'
- en: '[Keeping SO Up-to-Date](index_split_002.html#p133)'
  id: totrans-3195
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[保持 SO 更新](index_split_002.html#p133)'
- en: '[Updating via the GUI](index_split_002.html#p134)'
  id: totrans-3196
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[通过 GUI 更新](index_split_002.html#p134)'
- en: '[Updating via the Command Line](index_split_002.html#p135)'
  id: totrans-3197
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[通过命令行更新](index_split_002.html#p135)'
- en: '[Limiting Access to SO](index_split_002.html#p136)'
  id: totrans-3198
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[限制对 SO 的访问](index_split_002.html#p136)'
- en: '[Connecting via a SOCKS Proxy](index_split_002.html#p137)'
  id: totrans-3199
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[通过 SOCKS 代理连接](index_split_002.html#p137)'
- en: '[Changing the Firewall Policy](index_split_002.html#p139)'
  id: totrans-3200
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[更改防火墙策略](index_split_002.html#p139)'
- en: '[Managing SO Data Storage](index_split_002.html#p139)'
  id: totrans-3201
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[管理 SO 数据存储](index_split_002.html#p139)'
- en: '[Managing Sensor Storage](index_split_002.html#p140)'
  id: totrans-3202
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[管理传感器存储](index_split_002.html#p140)'
- en: '[Checking Database Drive Usage](index_split_002.html#p141)'
  id: totrans-3203
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[检查数据库磁盘使用情况](index_split_002.html#p141)'
- en: '[Managing the Sguil Database](index_split_002.html#p142)'
  id: totrans-3204
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[管理 Sguil 数据库](index_split_002.html#p142)'
- en: '[Tracking Disk Usage](index_split_002.html#p142)'
  id: totrans-3205
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[跟踪磁盘使用情况](index_split_002.html#p142)'
- en: '[Conclusion](index_split_002.html#p143)'
  id: totrans-3206
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[结论](index_split_002.html#p143)'
- en: '[Part III: Tools](index_split_002.html#p145)'
  id: totrans-3207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第三部分：工具](index_split_002.html#p145)'
- en: '[Chapter 6: Command Line Packet Analysis Tools](index_split_002.html#p147)'
  id: totrans-3208
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第6章：命令行数据包分析工具](index_split_002.html#p147)'
- en: '[SO Tool Categories](index_split_002.html#p148)'
  id: totrans-3209
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[SO 工具类别](index_split_002.html#p148)'
- en: '[Data Presentation](index_split_002.html#p148)'
  id: totrans-3210
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[数据展示](index_split_002.html#p148)'
- en: '[SO Data Collection Tools](index_split_002.html#p149)'
  id: totrans-3211
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[SO 数据收集工具](index_split_002.html#p149)'
- en: '[SO Data Delivery Tools](index_split_002.html#p149)'
  id: totrans-3212
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[SO 数据交付工具](index_split_002.html#p149)'
- en: '[Running Tcpdump](index_split_002.html#p150)'
  id: totrans-3213
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[运行 Tcpdump](index_split_002.html#p150)'
- en: '[Displaying, Writing, and Reading Traffic with Tcpdump](index_split_002.html#p151)'
  id: totrans-3214
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 Tcpdump 显示、写入和读取流量](index_split_002.html#p151)'
- en: '[Using Filters with Tcpdump](index_split_002.html#p152)'
  id: totrans-3215
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[在 Tcpdump 中使用过滤器](index_split_002.html#p152)'
- en: '[Extracting Details from Tcpdump Output](index_split_002.html#p155)'
  id: totrans-3216
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[从 Tcpdump 输出中提取详细信息](index_split_002.html#p155)'
- en: '[Examining Full Content Data with Tcpdump](index_split_003.html#p156)'
  id: totrans-3217
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 Tcpdump 检查完整内容数据](index_split_003.html#p156)'
- en: '[Using Dumpcap and Tshark](index_split_003.html#p156)'
  id: totrans-3218
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 Dumpcap 和 Tshark](index_split_003.html#p156)'
- en: '[Running Tshark](index_split_003.html#p157)'
  id: totrans-3219
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[运行 Tshark](index_split_003.html#p157)'
- en: '[Running Dumpcap](index_split_003.html#p157)'
  id: totrans-3220
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[运行 Dumpcap](index_split_003.html#p157)'
- en: '[Running Tshark on Dumpcap’s Traffic](index_split_003.html#p159)'
  id: totrans-3221
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[在 Dumpcap 流量上运行 Tshark](index_split_003.html#p159)'
- en: '[Using Display Filters with Tshark](index_split_003.html#p159)'
  id: totrans-3222
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[在 Tshark 中使用显示过滤器](index_split_003.html#p159)'
- en: '[Tshark Display Filters in Action](index_split_003.html#p161)'
  id: totrans-3223
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Tshark 显示过滤器应用示例](index_split_003.html#p161)'
- en: '[Running Argus and the Ra Client](index_split_003.html#p162)'
  id: totrans-3224
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[运行 Argus 和 Ra 客户端](index_split_003.html#p162)'
- en: '[Stopping and Starting Argus](index_split_003.html#p163)'
  id: totrans-3225
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[停止和启动 Argus](index_split_003.html#p163)'
- en: '[The Argus File Format](index_split_003.html#p163)'
  id: totrans-3226
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Argus 文件格式](index_split_003.html#p163)'
- en: '[Examining Argus Data](index_split_003.html#p164)'
  id: totrans-3227
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[检查 Argus 数据](index_split_003.html#p164)'
- en: '[Conclusion](index_split_003.html#p167)'
  id: totrans-3228
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[结论](index_split_003.html#p167)'
- en: '[Chapter 7: Graphical Packet Analysis Tools](index_split_003.html#p169)'
  id: totrans-3229
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第7章：图形化数据包分析工具](index_split_003.html#p169)'
- en: '[Using Wireshark](index_split_003.html#p170)'
  id: totrans-3230
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 Wireshark](index_split_003.html#p170)'
- en: '[Running Wireshark](index_split_003.html#p170)'
  id: totrans-3231
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[运行 Wireshark](index_split_003.html#p170)'
- en: '[Viewing a Packet Capture in Wireshark](index_split_003.html#p171)'
  id: totrans-3232
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[在 Wireshark 中查看数据包捕获](index_split_003.html#p171)'
- en: '[Modifying the Default Wireshark Layout](index_split_003.html#p171)'
  id: totrans-3233
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[修改默认的 Wireshark 布局](index_split_003.html#p171)'
- en: '[Some Useful Wireshark Features](index_split_003.html#p174)'
  id: totrans-3234
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[一些有用的 Wireshark 功能](index_split_003.html#p174)'
- en: '[Using Xplico](index_split_003.html#p181)'
  id: totrans-3235
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 Xplico](index_split_003.html#p181)'
- en: '[Running Xplico](index_split_003.html#p181)'
  id: totrans-3236
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[运行 Xplico](index_split_003.html#p181)'
- en: '[Creating Xplico Cases and Sessions](index_split_003.html#p182)'
  id: totrans-3237
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[创建 Xplico 案例和会话](index_split_003.html#p182)'
- en: '[Processing Network Traffic](index_split_003.html#p183)'
  id: totrans-3238
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[处理网络流量](index_split_003.html#p183)'
- en: '[Understanding the Decoded Traffic](index_split_003.html#p184)'
  id: totrans-3239
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[理解解码后的流量](index_split_003.html#p184)'
- en: '[Getting Metadata and Summarizing Traffic](index_split_003.html#p187)'
  id: totrans-3240
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[获取元数据并总结流量](index_split_003.html#p187)'
- en: '[Examining Content with NetworkMiner](index_split_003.html#p187)'
  id: totrans-3241
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 NetworkMiner 检查内容](index_split_003.html#p187)'
- en: '[Running NetworkMiner](index_split_003.html#p188)'
  id: totrans-3242
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[运行 NetworkMiner](index_split_003.html#p188)'
- en: '[Collecting and Organizing Traffic Details](index_split_003.html#p189)'
  id: totrans-3243
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[收集和组织流量详情](index_split_003.html#p189)'
- en: '[Rendering Content](index_split_003.html#p190)'
  id: totrans-3244
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[渲染内容](index_split_003.html#p190)'
- en: '[Conclusion](index_split_003.html#p191)'
  id: totrans-3245
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[结论](index_split_003.html#p191)'
- en: '[Chapter 8: NSM Consoles](index_split_003.html#p193)'
  id: totrans-3246
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第8章：NSM 控制台](index_split_003.html#p193)'
- en: '[An NSM-centric Look at Network Traffic](index_split_003.html#p194)'
  id: totrans-3247
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[从 NSM 视角看网络流量](index_split_003.html#p194)'
- en: '[Using Sguil](index_split_003.html#p195)'
  id: totrans-3248
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 Sguil](index_split_003.html#p195)'
- en: '[Running Sguil](index_split_003.html#p195)'
  id: totrans-3249
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[运行 Sguil](index_split_003.html#p195)'
- en: '[Sguil’s Six Key Functions](index_split_003.html#p198)'
  id: totrans-3250
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Sguil 的六个关键功能](index_split_003.html#p198)'
- en: '[Using Squert](index_split_003.html#p207)'
  id: totrans-3251
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 Squert](index_split_003.html#p207)'
- en: '[Snorby](index_split_003.html#p208)'
  id: totrans-3252
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Snorby](index_split_003.html#p208)'
- en: '[ELSA](index_split_003.html#p212)'
  id: totrans-3253
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[ELSA](index_split_003.html#p212)'
- en: '[Conclusion](index_split_004.html#p215)'
  id: totrans-3254
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[结论](index_split_004.html#p215)'
- en: '[Part IV: NSM in Action](index_split_004.html#p217)'
  id: totrans-3255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第四部分：NSM 实践](index_split_004.html#p217)'
- en: '[Chapter 9: NSM Operations](index_split_004.html#p219)'
  id: totrans-3256
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第 9 章：NSM 操作](index_split_004.html#p219)'
- en: '[The Enterprise Security Cycle](index_split_004.html#p220)'
  id: totrans-3257
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[企业安全周期](index_split_004.html#p220)'
- en: '[The Planning Phase](index_split_004.html#p221)'
  id: totrans-3258
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[规划阶段](index_split_004.html#p221)'
- en: '[The Resistance Phase](index_split_004.html#p221)'
  id: totrans-3259
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[抵抗阶段](index_split_004.html#p221)'
- en: '[The Detection and Response Phases](index_split_004.html#p221)'
  id: totrans-3260
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[检测与响应阶段](index_split_004.html#p221)'
- en: '[Collection, Analysis, Escalation, and Resolution](index_split_004.html#p222)'
  id: totrans-3261
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[收集、分析、权限提升与解决](index_split_004.html#p222)'
- en: '[Collection](index_split_004.html#p223)'
  id: totrans-3262
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[收集](index_split_004.html#p223)'
- en: '[Analysis](index_split_004.html#p227)'
  id: totrans-3263
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[分析](index_split_004.html#p227)'
- en: '[Escalation](index_split_004.html#p229)'
  id: totrans-3264
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[权限提升](index_split_004.html#p229)'
- en: '[Resolution](index_split_004.html#p232)'
  id: totrans-3265
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[解决](index_split_004.html#p232)'
- en: '[Remediation](index_split_004.html#p235)'
  id: totrans-3266
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[修复](index_split_004.html#p235)'
- en: '[Using NSM to Improve Security](index_split_004.html#p236)'
  id: totrans-3267
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 NSM 改善安全性](index_split_004.html#p236)'
- en: '[Building a CIRT](index_split_004.html#p237)'
  id: totrans-3268
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[建立 CIRT](index_split_004.html#p237)'
- en: '[Conclusion](index_split_004.html#p239)'
  id: totrans-3269
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[结论](index_split_004.html#p239)'
- en: '[Chapter 10: Server-side Compromise](index_split_004.html#p241)'
  id: totrans-3270
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第 10 章：服务器端妥协](index_split_004.html#p241)'
- en: '[Server-side Compromise Defined](index_split_004.html#p242)'
  id: totrans-3271
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[定义服务器端妥协](index_split_004.html#p242)'
- en: '[Server-side Compromise in Action](index_split_004.html#p243)'
  id: totrans-3272
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[服务器端妥协示例](index_split_004.html#p243)'
- en: '[Starting with Sguil](index_split_004.html#p244)'
  id: totrans-3273
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[从 Sguil 开始](index_split_004.html#p244)'
- en: '[Querying Sguil for Session Data](index_split_004.html#p245)'
  id: totrans-3274
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[查询 Sguil 获取会话数据](index_split_004.html#p245)'
- en: '[Returning to Alert Data](index_split_004.html#p248)'
  id: totrans-3275
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[返回警报数据](index_split_004.html#p248)'
- en: '[Reviewing Full Content Data with Tshark](index_split_004.html#p250)'
  id: totrans-3276
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 Tshark 审查完整内容数据](index_split_004.html#p250)'
- en: '[Understanding the Backdoor](index_split_004.html#p252)'
  id: totrans-3277
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[理解后门](index_split_004.html#p252)'
- en: '[What Did the Intruder Do?](index_split_004.html#p253)'
  id: totrans-3278
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[入侵者做了什么？](index_split_004.html#p253)'
- en: '[What Else Did the Intruder Do?](index_split_004.html#p256)'
  id: totrans-3279
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[入侵者还做了什么？](index_split_004.html#p256)'
- en: '[Exploring the Session Data](index_split_005.html#p258)'
  id: totrans-3280
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[探索会话数据](index_split_005.html#p258)'
- en: '[Searching Bro DNS Logs](index_split_005.html#p259)'
  id: totrans-3281
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[搜索 Bro DNS 日志](index_split_005.html#p259)'
- en: '[Searching Bro SSH Logs](index_split_005.html#p260)'
  id: totrans-3282
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[搜索 Bro SSH 日志](index_split_005.html#p260)'
- en: '[Searching Bro FTP Logs](index_split_005.html#p262)'
  id: totrans-3283
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[搜索 Bro FTP 日志](index_split_005.html#p262)'
- en: '[Decoding the Theft of Sensitive Data](index_split_005.html#p263)'
  id: totrans-3284
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[解码敏感数据的盗窃](index_split_005.html#p263)'
- en: '[Extracting the Stolen Archive](index_split_005.html#p264)'
  id: totrans-3285
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[提取被盗档案](index_split_005.html#p264)'
- en: '[Stepping Back](index_split_005.html#p265)'
  id: totrans-3286
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[后退一步](index_split_005.html#p265)'
- en: '[Summarizing Stage 1](index_split_005.html#p265)'
  id: totrans-3287
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[总结阶段 1](index_split_005.html#p265)'
- en: '[Summarizing Stage 2](index_split_005.html#p266)'
  id: totrans-3288
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[总结阶段 2](index_split_005.html#p266)'
- en: '[Next Steps](index_split_005.html#p266)'
  id: totrans-3289
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[下一步](index_split_005.html#p266)'
- en: '[Conclusion](index_split_005.html#p267)'
  id: totrans-3290
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[结论](index_split_005.html#p267)'
- en: '[Chapter 11: Client-side Compromise](index_split_005.html#p269)'
  id: totrans-3291
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第 11 章：客户端妥协](index_split_005.html#p269)'
- en: '[Client-side Compromise Defined](index_split_005.html#p270)'
  id: totrans-3292
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[定义客户端妥协](index_split_005.html#p270)'
- en: '[Client-side Compromise in Action](index_split_005.html#p271)'
  id: totrans-3293
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[客户端妥协示例](index_split_005.html#p271)'
- en: '[Getting the Incident Report from a User](index_split_005.html#p272)'
  id: totrans-3294
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[从用户获取事件报告](index_split_005.html#p272)'
- en: '[Starting Analysis with ELSA](index_split_005.html#p273)'
  id: totrans-3295
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 ELSA 开始分析](index_split_005.html#p273)'
- en: '[Looking for Missing Traffic](index_split_005.html#p277)'
  id: totrans-3296
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[查找丢失的流量](index_split_005.html#p277)'
- en: '[Analyzing the Bro dns.log File](index_split_005.html#p279)'
  id: totrans-3297
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[分析 Bro dns.log 文件](index_split_005.html#p279)'
- en: '[Checking Destination Ports](index_split_005.html#p280)'
  id: totrans-3298
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[检查目标端口](index_split_005.html#p280)'
- en: '[Examining the Command-and-Control Channel](index_split_005.html#p284)'
  id: totrans-3299
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[检查命令与控制通道](index_split_005.html#p284)'
- en: '[Initial Access](index_split_005.html#p285)'
  id: totrans-3300
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[初始访问](index_split_005.html#p285)'
- en: '[Improving the Shell](index_split_005.html#p289)'
  id: totrans-3301
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[改进 Shell](index_split_005.html#p289)'
- en: '[Summarizing Stage 1](index_split_005.html#p290)'
  id: totrans-3302
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[总结阶段 1](index_split_005.html#p290)'
- en: '[Pivoting to a Second Victim](index_split_005.html#p291)'
  id: totrans-3303
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[转向第二个受害者](index_split_005.html#p291)'
- en: '[Installing a Covert Tunnel](index_split_005.html#p291)'
  id: totrans-3304
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[安装隐蔽隧道](index_split_005.html#p291)'
- en: '[Enumerating the Victim](index_split_005.html#p293)'
  id: totrans-3305
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[枚举受害者](index_split_005.html#p293)'
- en: '[Summarizing Stage 2](index_split_005.html#p294)'
  id: totrans-3306
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[总结阶段 2](index_split_005.html#p294)'
- en: '[Conclusion](index_split_005.html#p295)'
  id: totrans-3307
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[结论](index_split_005.html#p295)'
- en: '[Chapter 12: Extending Security Onion](index_split_005.html#p297)'
  id: totrans-3308
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第12章：扩展 Security Onion](index_split_005.html#p297)'
- en: '[Using Bro to Track Executables](index_split_005.html#p298)'
  id: totrans-3309
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 Bro 跟踪可执行文件](index_split_005.html#p298)'
- en: '[Hashing Downloaded Executables with Bro](index_split_005.html#p298)'
  id: totrans-3310
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 Bro 对下载的可执行文件进行哈希计算](index_split_005.html#p298)'
- en: '[Submitting a Hash to VirusTotal](index_split_005.html#p298)'
  id: totrans-3311
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[将哈希提交给 VirusTotal](index_split_005.html#p298)'
- en: '[Using Bro to Extract Binaries from Traffic](index_split_005.html#p300)'
  id: totrans-3312
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 Bro 从流量中提取二进制文件](index_split_005.html#p300)'
- en: '[Configuring Bro to Extract Binaries from Traffic](index_split_005.html#p300)'
  id: totrans-3313
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[配置 Bro 从流量中提取二进制文件](index_split_005.html#p300)'
- en: '[Collecting Traffic to Test Bro](index_split_005.html#p301)'
  id: totrans-3314
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[收集流量来测试 Bro](index_split_005.html#p301)'
- en: '[Testing Bro to Extract Binaries from HTTP Traffic](index_split_006.html#p303)'
  id: totrans-3315
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[测试 Bro 从 HTTP 流量中提取二进制文件](index_split_006.html#p303)'
- en: '[Examining the Binary Extracted from HTTP](index_split_006.html#p304)'
  id: totrans-3316
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[检查从 HTTP 提取的二进制文件](index_split_006.html#p304)'
- en: '[Testing Bro to Extract Binaries from FTP Traffic](index_split_006.html#p306)'
  id: totrans-3317
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[测试 Bro 从 FTP 流量中提取二进制文件](index_split_006.html#p306)'
- en: '[Examining the Binary Extracted from FTP](index_split_006.html#p307)'
  id: totrans-3318
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[检查从 FTP 提取的二进制文件](index_split_006.html#p307)'
- en: '[Submitting a Hash and Binary to VirusTotal](index_split_006.html#p307)'
  id: totrans-3319
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[将哈希和二进制文件提交给 VirusTotal](index_split_006.html#p307)'
- en: '[Restarting Bro](index_split_006.html#p309)'
  id: totrans-3320
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[重启 Bro](index_split_006.html#p309)'
- en: '[Using APT1 Intelligence](index_split_006.html#p311)'
  id: totrans-3321
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 APT1 情报](index_split_006.html#p311)'
- en: '[Using the APT1 Module](index_split_006.html#p312)'
  id: totrans-3322
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 APT1 模块](index_split_006.html#p312)'
- en: '[Installing the APT1 Module](index_split_006.html#p314)'
  id: totrans-3323
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[安装 APT1 模块](index_split_006.html#p314)'
- en: '[Generating Traffic to Test the APT1 Module](index_split_006.html#p314)'
  id: totrans-3324
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[生成流量来测试 APT1 模块](index_split_006.html#p314)'
- en: '[Testing the APT1 Module](index_split_006.html#p315)'
  id: totrans-3325
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[测试 APT1 模块](index_split_006.html#p315)'
- en: '[Reporting Downloads of Malicious Binaries](index_split_006.html#p317)'
  id: totrans-3326
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[报告恶意二进制文件的下载](index_split_006.html#p317)'
- en: '[Using the Team Cymru Malware Hash Registry](index_split_006.html#p317)'
  id: totrans-3327
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 Team Cymru 恶意软件哈希注册表](index_split_006.html#p317)'
- en: '[The MHR and SO: Active by Default](index_split_006.html#p319)'
  id: totrans-3328
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[MHR 和 SO：默认启用](index_split_006.html#p319)'
- en: '[The MHR and SO vs. a Malicious Download](index_split_006.html#p320)'
  id: totrans-3329
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[MHR 和 SO 对比恶意下载](index_split_006.html#p320)'
- en: '[Identifying the Binary](index_split_006.html#p321)'
  id: totrans-3330
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[识别二进制文件](index_split_006.html#p321)'
- en: '[Conclusion](index_split_006.html#p322)'
  id: totrans-3331
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[结论](index_split_006.html#p322)'
- en: '[Chapter 13: Proxies and Checksums](index_split_006.html#p323)'
  id: totrans-3332
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第13章：代理与校验和](index_split_006.html#p323)'
- en: '[Proxies](index_split_006.html#p323)'
  id: totrans-3333
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[代理](index_split_006.html#p323)'
- en: '[Proxies and Visibility](index_split_006.html#p324)'
  id: totrans-3334
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[代理与可见性](index_split_006.html#p324)'
- en: '[Dealing with Proxies in Production Networks](index_split_006.html#p328)'
  id: totrans-3335
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[在生产网络中处理代理](index_split_006.html#p328)'
- en: '[Checksums](index_split_006.html#p328)'
  id: totrans-3336
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[校验和](index_split_006.html#p328)'
- en: '[A Good Checksum](index_split_006.html#p329)'
  id: totrans-3337
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[一个好的校验和](index_split_006.html#p329)'
- en: '[A Bad Checksum](index_split_006.html#p329)'
  id: totrans-3338
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[一个不良校验和](index_split_006.html#p329)'
- en: '[Identifying Bad and Good Checksums with Tshark](index_split_006.html#p330)'
  id: totrans-3339
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[使用 Tshark 识别不良和良好的校验和](index_split_006.html#p330)'
- en: '[How Bad Checksums Happen](index_split_006.html#p332)'
  id: totrans-3340
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[不良校验和如何发生](index_split_006.html#p332)'
- en: '[Bro and Bad Checksums](index_split_006.html#p332)'
  id: totrans-3341
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Bro 和不良校验和](index_split_006.html#p332)'
- en: '[Setting Bro to Ignore Bad Checksums](index_split_006.html#p334)'
  id: totrans-3342
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[设置 Bro 忽略不良校验和](index_split_006.html#p334)'
- en: '[Conclusion](index_split_006.html#p336)'
  id: totrans-3343
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[结论](index_split_006.html#p336)'
- en: '[Conclusion](index_split_006.html#p337)'
  id: totrans-3344
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[结论](index_split_006.html#p337)'
- en: '[Cloud Computing](index_split_006.html#p338)'
  id: totrans-3345
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[云计算](index_split_006.html#p338)'
- en: '[Cloud Computing Challenges](index_split_006.html#p338)'
  id: totrans-3346
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[云计算挑战](index_split_006.html#p338)'
- en: '[Cloud Computing Benefits](index_split_006.html#p340)'
  id: totrans-3347
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[云计算的好处](index_split_006.html#p340)'
- en: '[Workflow, Metrics, and Collaboration](index_split_006.html#p341)'
  id: totrans-3348
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[工作流、指标与协作](index_split_006.html#p341)'
- en: '[Workflow and Metrics](index_split_006.html#p341)'
  id: totrans-3349
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[工作流和指标](index_split_006.html#p341)'
- en: '[Collaboration](index_split_006.html#p342)'
  id: totrans-3350
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[协作](index_split_006.html#p342)'
- en: '[Conclusion](index_split_006.html#p343)'
  id: totrans-3351
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[结论](index_split_006.html#p343)'
- en: '[Security Onion Scripts and Configuration](index_split_006.html#p345)'
  id: totrans-3352
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Security Onion 脚本和配置](index_split_006.html#p345)'
- en: '[Security Onion Control Scripts](index_split_006.html#p345)'
  id: totrans-3353
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Security Onion 控制脚本](index_split_006.html#p345)'
- en: '[/usr/sbin/nsm](index_split_006.html#p347)'
  id: totrans-3354
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm](index_split_006.html#p347)'
- en: '[/usr/sbin/nsm_all_del](index_split_006.html#p347)'
  id: totrans-3355
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_all_del](index_split_006.html#p347)'
- en: '[/usr/sbin/nsm_all_del_quick](index_split_006.html#p348)'
  id: totrans-3356
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_all_del_quick](index_split_006.html#p348)'
- en: '[/usr/sbin/nsm_sensor](index_split_006.html#p349)'
  id: totrans-3357
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_sensor](index_split_006.html#p349)'
- en: '[/usr/sbin/nsm_sensor_add](index_split_006.html#p350)'
  id: totrans-3358
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_sensor_add](index_split_006.html#p350)'
- en: '[/usr/sbin/nsm_sensor_backup-config](index_split_006.html#p350)'
  id: totrans-3359
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_sensor_backup-config](index_split_006.html#p350)'
- en: '[/usr/sbin/nsm_sensor_backup-data](index_split_006.html#p350)'
  id: totrans-3360
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_sensor_backup-data](index_split_006.html#p350)'
- en: '[/usr/sbin/nsm_sensor_clean](index_split_006.html#p350)'
  id: totrans-3361
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_sensor_clean](index_split_006.html#p350)'
- en: '[/usr/sbin/nsm_sensor_clear](index_split_006.html#p350)'
  id: totrans-3362
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_sensor_clear](index_split_006.html#p350)'
- en: '[/usr/sbin/nsm_sensor_del](index_split_006.html#p350)'
  id: totrans-3363
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_sensor_del](index_split_006.html#p350)'
- en: '[/usr/sbin/nsm_sensor_edit](index_split_006.html#p351)'
  id: totrans-3364
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_sensor_edit](index_split_006.html#p351)'
- en: '[/usr/sbin/nsm_sensor_ps-daily-restart](index_split_006.html#p351)'
  id: totrans-3365
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_sensor_ps-daily-restart](index_split_006.html#p351)'
- en: '[/usr/sbin/nsm_sensor_ps-restart](index_split_006.html#p351)'
  id: totrans-3366
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_sensor_ps-restart](index_split_006.html#p351)'
- en: '[/usr/sbin/nsm_sensor_ps-start](index_split_006.html#p353)'
  id: totrans-3367
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_sensor_ps-start](index_split_006.html#p353)'
- en: '[/usr/sbin/nsm_sensor_ps-status](index_split_006.html#p353)'
  id: totrans-3368
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_sensor_ps-status](index_split_006.html#p353)'
- en: '[/usr/sbin/nsm_sensor_ps-stop](index_split_006.html#p354)'
  id: totrans-3369
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_sensor_ps-stop](index_split_006.html#p354)'
- en: '[/usr/sbin/nsm_server](index_split_006.html#p354)'
  id: totrans-3370
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_server](index_split_006.html#p354)'
- en: '[/usr/sbin/nsm_server_add](index_split_006.html#p354)'
  id: totrans-3371
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_server_add](index_split_006.html#p354)'
- en: '[/usr/sbin/nsm_server_backup-config](index_split_006.html#p354)'
  id: totrans-3372
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_server_backup-config](index_split_006.html#p354)'
- en: '[/usr/sbin/nsm_server_backup-data](index_split_006.html#p354)'
  id: totrans-3373
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_server_backup-data](index_split_006.html#p354)'
- en: '[/usr/sbin/nsm_server_clear](index_split_006.html#p355)'
  id: totrans-3374
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_server_clear](index_split_006.html#p355)'
- en: '[/usr/sbin/nsm_server_del](index_split_006.html#p355)'
  id: totrans-3375
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_server_del](index_split_006.html#p355)'
- en: '[/usr/sbin/nsm_server_edit](index_split_006.html#p355)'
  id: totrans-3376
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_server_edit](index_split_006.html#p355)'
- en: '[/usr/sbin/nsm_server_ps-restart](index_split_006.html#p355)'
  id: totrans-3377
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_server_ps-restart](index_split_006.html#p355)'
- en: '[/usr/sbin/nsm_server_ps-start](index_split_006.html#p355)'
  id: totrans-3378
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_server_ps-start](index_split_006.html#p355)'
- en: '[/usr/sbin/nsm_server_ps-status](index_split_006.html#p355)'
  id: totrans-3379
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_server_ps-status](index_split_006.html#p355)'
- en: '[/usr/sbin/nsm_server_ps-stop](index_split_006.html#p355)'
  id: totrans-3380
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_server_ps-stop](index_split_006.html#p355)'
- en: '[/usr/sbin/nsm_server_sensor-add](index_split_006.html#p356)'
  id: totrans-3381
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_server_sensor-add](index_split_006.html#p356)'
- en: '[/usr/sbin/nsm_server_sensor-del](index_split_006.html#p356)'
  id: totrans-3382
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_server_sensor-del](index_split_006.html#p356)'
- en: '[/usr/sbin/nsm_server_user-add](index_split_006.html#p356)'
  id: totrans-3383
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/usr/sbin/nsm_server_user-add](index_split_006.html#p356)'
- en: '[Security Onion Configuration Files](index_split_006.html#p356)'
  id: totrans-3384
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Security Onion 配置文件](index_split_006.html#p356)'
- en: '[/etc/nsm/](index_split_006.html#p356)'
  id: totrans-3385
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/etc/nsm/](index_split_006.html#p356)'
- en: '[/etc/nsm/administration.conf](index_split_006.html#p357)'
  id: totrans-3386
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/etc/nsm/administration.conf](index_split_006.html#p357)'
- en: '[/etc/nsm/ossec/](index_split_006.html#p357)'
  id: totrans-3387
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/etc/nsm/ossec/](index_split_006.html#p357)'
- en: '[/etc/nsm/pulledpork/](index_split_006.html#p357)'
  id: totrans-3388
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/etc/nsm/pulledpork/](index_split_006.html#p357)'
- en: '[/etc/nsm/rules/](index_split_006.html#p357)'
  id: totrans-3389
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/etc/nsm/rules/](index_split_006.html#p357)'
- en: '[/etc/nsm/securityonion/](index_split_006.html#p358)'
  id: totrans-3390
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/etc/nsm/securityonion/](index_split_006.html#p358)'
- en: '[/etc/nsm/securityonion.conf](index_split_006.html#p358)'
  id: totrans-3391
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/etc/nsm/securityonion.conf](index_split_006.html#p358)'
- en: '[/etc/nsm/sensortab](index_split_006.html#p359)'
  id: totrans-3392
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/etc/nsm/sensortab](index_split_006.html#p359)'
- en: '[/etc/nsm/servertab](index_split_006.html#p360)'
  id: totrans-3393
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/etc/nsm/servertab](index_split_006.html#p360)'
- en: '[/etc/nsm/templates/](index_split_006.html#p360)'
  id: totrans-3394
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/etc/nsm/templates/](index_split_006.html#p360)'
- en: '[/etc/nsm/$HOSTNAME-$INTERFACE/](index_split_006.html#p360)'
  id: totrans-3395
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/etc/nsm/$HOSTNAME-$INTERFACE/](index_split_006.html#p360)'
- en: '[/etc/cron.d/](index_split_006.html#p364)'
  id: totrans-3396
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/etc/cron.d/](index_split_006.html#p364)'
- en: '[Bro](index_split_006.html#p364)'
  id: totrans-3397
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Bro](index_split_006.html#p364)'
- en: '[CapMe](index_split_006.html#p365)'
  id: totrans-3398
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[CapMe](index_split_006.html#p365)'
- en: '[ELSA](index_split_006.html#p365)'
  id: totrans-3399
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[ELSA](index_split_006.html#p365)'
- en: '[Squert](index_split_006.html#p365)'
  id: totrans-3400
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Squert](index_split_006.html#p365)'
- en: '[Snorby](index_split_006.html#p365)'
  id: totrans-3401
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Snorby](index_split_006.html#p365)'
- en: '[Syslog-ng](index_split_006.html#p365)'
  id: totrans-3402
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[Syslog-ng](index_split_006.html#p365)'
- en: '[/etc/network/interfaces](index_split_006.html#p365)'
  id: totrans-3403
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[/etc/network/interfaces](index_split_006.html#p365)'
- en: '[Updating Security Onion](index_split_006.html#p366)'
  id: totrans-3404
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[更新 Security Onion](index_split_006.html#p366)'
- en: '[Updating the Security Onion Distribution](index_split_006.html#p366)'
  id: totrans-3405
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[更新 Security Onion 发行版](index_split_006.html#p366)'
- en: '[Updating MySQL](index_split_006.html#p367)'
  id: totrans-3406
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[更新 MySQL](index_split_006.html#p367)'
