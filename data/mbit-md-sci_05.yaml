- en: '![Image](../images/common1.jpg)'
  id: totrans-0
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/common1.jpg)'
- en: '**5**'
  id: totrans-1
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**5**'
- en: '**AMAZING ACCELERATION**'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '**神奇的加速度**'
- en: The accelerometer is arguably the most useful of the BBC micro:bit’s built-in
    sensors. It lets you measure the direction and strength of a force, such as gravity,
    that is acting on the micro:bit.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 加速度计可以说是BBC micro:bit内置传感器中最有用的一个。它可以让你测量作用在micro:bit上的力的方向和强度，比如重力。
- en: 'You can use the accelerometer for many things, including:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以用加速度计做很多事情，包括：
- en: '![Image](../images/play.jpg)  Detecting gestures like shaking, or even finding
    out that your micro:bit is falling'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '![图片](../images/play.jpg)  检测摇晃等手势，甚至检测到你的micro:bit正在掉落'
- en: '![Image](../images/play.jpg)  Learning which way and how much the micro:bit
    is tilted and using this to control your micro:bit'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '![图片](../images/play.jpg)  学习micro:bit的倾斜方向和幅度，并使用这些控制你的micro:bit'
- en: '![Image](../images/play.jpg)  Measuring how quickly your micro:bit is accelerating
    when it moves. (For example, you might use it in a pedometer to see how many steps
    you take in a day.)'
  id: totrans-7
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/play.jpg)  测量micro:bit加速的速度（例如，你可以在计步器中使用它来查看你一天走了多少步。）'
- en: '![Image](../images/f0106-01.jpg)'
  id: totrans-8
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/f0106-01.jpg)'
- en: '**EXPERIMENT 5: GESTURES**'
  id: totrans-9
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**实验 5：手势**'
- en: '![Image](../images/common2.jpg)'
  id: totrans-10
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/common2.jpg)'
- en: The micro:bit’s software includes gesture recognition, so it can respond to
    certain motions, like tilting or shaking, that are picked up by the accelerometer.
    In this section, you’ll program the micro:bit to display a smile whenever you
    shake it.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: micro:bit的软体包括手势识别，因此它可以响应加速度计感应到的特定动作，如倾斜或摇晃。在本节中，你将编写程序，使micro:bit在摇动时显示一个笑脸。
- en: Later in this chapter, you’ll learn how to deal with the raw data that comes
    straight from the accelerometer chip so you can measure acceleration.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章稍后的部分，你将学习如何处理直接来自加速度计芯片的原始数据，以便你可以测量加速度。
- en: '**What You’ll Need**'
  id: totrans-13
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**你需要的东西**'
- en: In this experiment, you’ll just need your micro:bit.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在本实验中，你只需要你的micro:bit。
- en: '**Construction**'
  id: totrans-15
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**构建**'
- en: 'Go to *[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*
    to access the book’s code repository and click the link for **Experiment 5: Gestures**.
    Once the program has opened, click **Download** and then copy the hex file onto
    your micro:bit. If you prefer to use Python, then download the code from the same
    website. For instructions for downloading and using the book’s examples, see “Downloading
    the Code” on [page 34](ch01.xhtml#page_34). The Python file for this experiment
    is *Experiment_05.py*.'
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问 *[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*
    获取书中的代码库，并点击链接进入 **实验 5：手势**。程序打开后，点击 **下载**，然后将hex文件复制到你的micro:bit上。如果你更喜欢使用Python，可以从同一网站下载代码。关于下载和使用书中的示例的说明，请参见
    [第34页](ch01.xhtml#page_34) 的“下载代码”部分。本实验的Python文件是 *Experiment_05.py*。
- en: Once the program starts, shake your micro:bit, and you should see a smile appear,
    then disappear, on the display.
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 程序启动后，摇动你的micro:bit，你应该能看到一个笑脸出现在屏幕上，然后消失。
- en: '**Code**'
  id: totrans-18
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**代码**'
- en: Using gestures in your program is similar in both Blocks and MicroPython. Both
    languages have the same set of gesture types. The main difference is that in MicroPython
    there is no event mechanism for handling events; instead, you have to keep checking
    for gestures in a loop.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在程序中使用手势在Blocks和MicroPython中是相似的。两种语言都有相同的手势类型。主要的区别在于，MicroPython没有事件机制来处理事件；相反，你需要在循环中不断检查手势。
- en: '**Blocks Code**'
  id: totrans-20
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**Blocks代码**'
- en: Here is the Blocks code for this experiment.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 这是本实验的Blocks代码。
- en: '![Image](../images/f0107-01.jpg)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/f0107-01.jpg)'
- en: The acceleration gestures available in the Blocks code work as events, just
    as pressing a button does. Start with an `on` block. Click the triangle in to
    access a drop-down menu of possible gestures, shown in [Figure 5-1](ch05.xhtml#ch5fig1),
    and select `shake`.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在Blocks代码中可用的加速度手势作为事件工作，就像按按钮一样。首先使用一个`on`块。点击三角形以访问可能手势的下拉菜单，如[图5-1](ch05.xhtml#ch5fig1)所示，选择`shake`。
- en: '![Image](../images/05fig01.jpg)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/05fig01.jpg)'
- en: '*Figure 5-1: Selecting different gestures*'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '*图5-1：选择不同的手势*'
- en: '**THE DIFFERENT GESTURES**'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '**不同的手势**'
- en: The shake gesture responds to any significant shaking of your micro:bit. The
    next two gestures, logo up and logo down, respond to tilting the micro:bit front
    to back. The logo this code refers to is the icon printed on the micro:bit board,
    near the USB socket.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 摇晃手势会响应任何显著的摇晃动作。接下来的两个手势，logo向上和logo向下，分别响应micro:bit前后倾斜。此代码所指的logo是印刷在micro:bit板上、靠近USB接口的图标。
- en: The screen up and screen down gestures respond to the micro:bit’s orientation.
    For example, if you placed it screen side down, you’d trigger the screen down
    event.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 屏幕向上和屏幕向下的手势响应 micro:bit 的方向。例如，如果你将其屏幕朝下放置，你就会触发屏幕向下事件。
- en: The tilt left and tilt right events respond when you tilt the micro:bit from
    side to side by more than about 60 degrees. You have to tilt it quite a lot to
    trigger these events.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 左倾和右倾事件在你将 micro:bit 向左右倾斜超过约 60 度时触发。你需要大幅度倾斜它才能触发这些事件。
- en: The final four events relate to the overall force acting on the accelerometer
    rather than the force in any particular direction. For example, if the micro:bit
    is in free fall, then the fall will trigger the free fall event. The gestures
    3g, 6g, and 8g detect different amounts of force acting on the accelerometer,
    measured in *g* (the acceleration due to gravity, or the *g-force*). For example,
    you could detect a finger tap on the micro:bit. Tapping the micro:bit doesn’t
    move it much, so you might think that not much force is involved, but in fact
    tapping can exert quite a high g-force.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 最后的四个事件与加速度计上的总力有关，而不是某个特定方向的力。例如，如果 micro:bit 处于自由落体状态，那么自由落体将触发自由落体事件。手势 3g、6g
    和 8g 检测加速度计上作用的不同力，单位为*g*（即重力加速度，或称*g力*）。例如，你可以检测到手指轻拍 micro:bit。轻拍 micro:bit
    时并不会使其移动很多，因此你可能认为涉及的力不大，但事实上，轻拍可以施加相当高的g力。
- en: '**MicroPython Code**'
  id: totrans-31
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**MicroPython 代码**'
- en: 'Here’s the MicroPython code for this experiment:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是此实验的 MicroPython 代码：
- en: from microbit import *
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 来自 microbit 的 import *
- en: 'while True:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 'while True:'
- en: 'if accelerometer.was_gesture(''shake''):'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 'if accelerometer.was_gesture(''shake''):'
- en: display.show(Image.HAPPY)
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: display.show(Image.HAPPY)
- en: sleep(500)
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: sleep(500)
- en: display.clear()
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: display.clear()
- en: You’ll recognize most of the code here. We import the usual library and then
    start a `while True` loop so the main code runs continually. This loop checks
    whether the micro:bit has detected shaking and, if it has, shows the happy face!
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 你会认出大部分代码。我们导入了常见的库，然后启动一个`while True`循环，使主代码持续运行。这个循环检查 micro:bit 是否检测到摇晃，如果检测到，则显示笑脸！
- en: Because MicroPython doesn’t have the concept of “events,” you have to use the
    `was_gesture` function inside a `while` loop to check for the shake gesture. You
    can also replace the `shake` block with `up`, `down`, `left`, `right`, `face up`,
    `face down`, `freefall`, `3g`, `6g`, or `8g`.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 因为 MicroPython 没有“事件”这个概念，所以你必须在 `while` 循环中使用 `was_gesture` 函数来检查摇晃手势。你还可以将
    `shake` 替换为 `up`、`down`、`left`、`right`、`face up`、`face down`、`freefall`、`3g`、`6g`
    或 `8g`。
- en: '**Things to Try**'
  id: totrans-41
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**可以尝试的事项**'
- en: Try adding more gestures to the program for Experiment 5\. You can even make
    each gesture trigger a different icon on the screen.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 尝试在实验 5 中为程序添加更多手势。你甚至可以让每个手势触发屏幕上的不同图标。
- en: In [Chapter 10](ch10.xhtml#ch10), you’ll use gesture detection again to steer
    a micro:bit-controlled robot rover!
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 在 [第 10 章](ch10.xhtml#ch10)中，你将再次使用手势检测来控制 micro:bit 驱动的机器人漫游车！
- en: '**How It Works: Force, Acceleration, and Gravity**'
  id: totrans-44
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**工作原理：力、加速度与重力**'
- en: We’ve been talking about force, acceleration, and gravity as if the accelerometer
    measures all of these things, but it really just measures the distance a certain
    mass moves. Then it computes the other measurements. Let’s take a look at what
    the accelerometer chip actually does to get a better idea of what these three
    terms mean.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 我们一直在谈论力、加速度和重力，好像加速度计能测量所有这些，但它实际上只是测量某个质量的位移距离。然后它计算出其他相关的测量值。让我们看一看加速度计芯片实际执行的操作，以更好地理解这三个术语的含义。
- en: '![Image](../images/05fig02.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/05fig02.jpg)'
- en: '*Figure 5-2: The micro:bit’s accelerometer*'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 5-2：micro:bit 的加速度计*'
- en: '[Figure 5-2](ch05.xhtml#ch5fig2) shows a rough sketch of what’s inside the
    tiny accelerometer chip attached to your micro:bit.'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 5-2](ch05.xhtml#ch5fig2) 展示了微型加速度计芯片的大致示意图，该芯片附加在你的 micro:bit 上。'
- en: Imagine a tiny mass *m* attached to a spring. (The mass is drawn as a ball in
    [Figure 5-2](ch05.xhtml#ch5fig2), but its shape isn’t important.) Normally, the
    mass is in position A, but if it’s being pulled against the spring by some force
    (for example, gravity), then it will move to some other position, which we’ll
    call position B. The stronger the force, the bigger the difference between A and
    B. By measuring this distance, the accelerometer calculates the force acting on
    the mass.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 想象一下，一个小质量 *m* 附着在弹簧上。（这个质量在 [图 5-2](ch05.xhtml#ch5fig2) 中画成一个球形，但它的形状并不重要。）通常情况下，质量处于位置
    A，但如果它受到某种力（例如重力）的拉动，便会移动到其他位置，我们称之为位置 B。力越强，A 和 B 之间的差距越大。通过测量这个距离，加速度计可以计算作用在质量上的力。
- en: Looking at [Figure 5-2](ch05.xhtml#ch5fig2), you can see that the force of gravity
    alone will pull the mass down. But the more the spring is stretched, the more
    the spring pulls the mass in the opposite direction to gravity. So gravity applies
    downward force to the mass, stretching the spring, which then applies upward force.
    When the two forces are equal but acting in opposite directions, the difference
    between the distances B and A is a measure of the gravitational force acting on
    the micro:bit. The larger the distance between A and B, the greater the force
    acting on the mass.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 通过查看 [图 5-2](ch05.xhtml#ch5fig2)，你可以看到仅重力的作用会使质量向下拉。但弹簧被拉伸得越多，它对质量的反向拉力也就越大。所以，重力对质量施加向下的力，拉伸弹簧，而弹簧则施加向上的力。当这两股力相等但方向相反时，B
    和 A 之间的距离就能衡量作用在 micro:bit 上的重力大小。A 和 B 之间的距离越大，作用在质量上的力就越大。
- en: Remember that the g-force relates to the acceleration that occurs due to gravity.
    Acceleration is an increase in speed. In other words, if you drop your micro:bit
    off a tall building, the acceleration *g* is the number of meters per second the
    micro:bit’s speed increases by every second. If you dropped your micro:bit off
    a tall building in a vacuum, there wouldn’t be any air to slow down the micro:bit,
    and in this case, the speed of the micro:bit would increase by about 9.8 meters
    per second for every second it fell. So, if it were to start at a speed of 0 (as
    you’re holding it in your hand) and then fall for 10 seconds, it would reach a
    speed of 98 meters per second (about 220 miles per hour).
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，重力加速度与由于重力作用而发生的加速度有关。加速度是速度的增加。换句话说，如果你把 micro:bit 从高楼上扔下，加速度 *g* 是指每秒 micro:bit
    的速度增加的米数。如果你把 micro:bit 扔进真空中，没有空气来减慢它的速度，在这种情况下，micro:bit 的速度每秒增加约 9.8 米。所以，如果它从
    0 速度（就像你手里拿着它一样）开始，然后自由下落 10 秒钟，它的速度将达到 98 米每秒（约 220 英里每小时）。
- en: Also, when the micro:bit meets the ground after traveling at 220 miles per hour,
    it will probably be smashed to bits.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，当 micro:bit 以 220 英里每小时的速度撞击地面时，它可能会被摔得粉碎。
- en: However, if you dropped your micro:bit in a vacuum, then its accelerometer would
    read 0 even though it was clearly accelerating at 9.8 meters a second. This is
    because the accelerometer is not really measuring acceleration. As you saw in
    [Figure 5-3](ch05.xhtml#ch5fig3), it’s measuring the force acting on the mass
    inside of the micro:bit. That force would be zero if the mass and the spring were
    accelerating at the same rate, which they would be since they’re both in the micro:bit.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，如果你在真空中丢下 micro:bit，它的加速度计会显示 0，尽管它明显在以每秒 9.8 米的加速度加速。这是因为加速度计实际上并没有测量加速度。如你在
    [图 5-3](ch05.xhtml#ch5fig3) 中所看到的，它是在测量作用在 micro:bit 内部质量上的力。如果质量和弹簧的加速度相同，那么加速度计读取的力将为零，因为它们的加速度相同。
- en: If you were in space, well away from the gravitational pull of celestial bodies,
    then the acceleration would be equal to the force acting on the object divided
    by the mass of the object. Because the mass is always the same, the accelerometer
    can tell us the acceleration of the micro:bit as long as some force, any force,
    is acting on it.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你处在太空中，远离天体的引力作用，那么加速度将等于作用在物体上的力除以物体的质量。由于质量始终不变，只要有任何力量作用在 micro:bit 上，加速度计就能告诉我们它的加速度。
- en: The accelerometer chip is actually more advanced than [Figure 5-2](ch05.xhtml#ch5fig2)
    suggests because it has three force-measuring devices in it, set to measure force
    in three directions, all at right angles to each other. In other words, the chip
    measures the force acting on it in three dimensions, X, Y, and Z, as shown in
    [Figure 5-3](ch05.xhtml#ch5fig3).
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 加速度计芯片实际上比 [图 5-2](ch05.xhtml#ch5fig2) 所示的更先进，因为它内含三个测量力的装置，分别测量三个方向上的力，这些方向互相垂直。换句话说，芯片测量作用在它上面的三维力，分别是
    X、Y 和 Z 方向，如 [图 5-3](ch05.xhtml#ch5fig3) 所示。
- en: '![Image](../images/05fig03.jpg)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/05fig03.jpg)'
- en: '*Figure 5-3: The micro:bit’s accelerometer measures force in three dimensions.*'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 5-3：micro:bit 的加速度计测量三维力。*'
- en: If your micro:bit were sitting flat on a table, the X dimension would run left
    to right, the Y dimension would run front to back, and the Z dimension would run
    above and below the tabletop. So, if the micro:bit is completely horizontal on
    a flat tabletop, the force of gravity will only be acting on the Z (up-down) dimension,
    while the X and Y dimensions will measure 0 acceleration. Now, if you tilt the
    micro:bit forward a little, then some of the force due to gravity will act on
    the Y dimension, so the Y value will no longer be 0\. This also means that slightly
    less gravitational force is acting on the Z dimension, so the value of Z will
    decrease slightly.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的micro:bit平放在桌面上，X维度将沿左右方向，Y维度将沿前后方向，Z维度将沿桌面上下方向。所以，如果micro:bit完全水平放在平坦的桌面上，重力的作用力只会作用在Z（上下）维度，而X和Y维度的加速度为0。现在，如果你稍微倾斜micro:bit，那么部分重力将作用在Y维度上，因此Y值将不再是0。这也意味着，作用在Z维度上的重力会稍微减少，因此Z值会略微下降。
- en: From the description so far, you might think that the accelerometer is only
    useful for measuring the force of gravity. In fact, looking at [Figure 5-2](ch05.xhtml#ch5fig2),
    it is easy to imagine how shaking the micro:bit or causing any kind of acceleration
    on it would change the position of the mass.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 从目前的描述来看，你可能认为加速度计仅用于测量重力。然而，看看[图 5-2](ch05.xhtml#ch5fig2)，很容易想象，当你摇动micro:bit或对其施加任何类型的加速度时，会改变质量的位置。
- en: '**EXPERIMENT 6: REAL-TIME ACCELERATION PLOTTING**'
  id: totrans-60
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**实验6：实时加速度绘图**'
- en: '![Image](../images/common2.jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/common2.jpg)'
- en: Mu has a great feature that will plot data coming from your micro:bit in real
    time. In this experiment, you’ll use the Plotter feature to see how the acceleration
    data changes when you move your micro:bit.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: Mu有一个很棒的功能，可以实时绘制来自micro:bit的数据。在这个实验中，你将使用绘图仪功能查看当你移动micro:bit时加速度数据如何变化。
- en: '**NOTE** *At the time of writing, the Plotter feature is available only on
    the Windows and Mac versions of the Mu Editor. The experiment also shows you how
    to get an overall measurement of acceleration, as well as separate readings for
    each of the X, Y, and Z dimensions.*'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意** *在撰写时，绘图仪功能仅在Windows和Mac版本的Mu编辑器中可用。该实验还向你展示了如何获取加速度的整体测量值，以及X、Y和Z维度的单独读数。*'
- en: '**What You’ll Need**'
  id: totrans-64
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**所需材料**'
- en: For this experiment, you just need a micro:bit connected to your computer by
    a USB cable.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个实验，你只需要一块通过USB线连接到计算机的micro:bit。
- en: '**Construction**'
  id: totrans-66
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**构建**'
- en: This project uses Mu’s Plotter feature, which you’ll need Python for, so there’s
    no Blocks code for this. Find the code at *[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*.
    The Python file for this experiment is *Experiment_06.py*. Flash the program onto
    your micro:bit.
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 本项目使用了Mu的绘图仪功能，这需要使用Python，因此这里没有Blocks代码。你可以在*[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*找到代码。这个实验的Python文件是*Experiment_06.py*。将程序刷入你的micro:bit。
- en: Click the **Plotter icon** in the Mu toolbar to open Mu’s Plotter, shown in
    [Figure 5-4](ch05.xhtml#ch5fig4). If you want to see the raw data that Mu is using
    to create graphs, click the **REPL** button.![Image](../images/05fig04.jpg)
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击Mu工具栏中的**绘图仪图标**以打开Mu的绘图仪，显示在[图 5-4](ch05.xhtml#ch5fig4)中。如果你想查看Mu用于创建图表的原始数据，请点击**REPL**按钮。![Image](../images/05fig04.jpg)
- en: '*Figure 5-4: Plotting accelerometer data using Mu*'
  id: totrans-69
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*图 5-4：使用Mu绘制加速度计数据*'
- en: Tilt the micro:bit this way and that to see the changes in the Plotter.
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将micro:bit朝不同方向倾斜，观察绘图仪中的变化。
- en: 'As you can see in [Figure 5-4](ch05.xhtml#ch5fig4), there are four plots, each
    drawn in a different color. There is one plot for each dimension (blue for X,
    green for Y, and orange for Z). There is also a purple plot for the *net acceleration*,
    which is the combination of the forces in all three dimensions. We’ll explain
    how the net acceleration is calculated in “How It Works: Calculating Net Acceleration”
    on [page 11](ch01.xhtml#page_11).'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 如[图 5-4](ch05.xhtml#ch5fig4)所示，有四个图形，每个图形用不同的颜色绘制。每个维度有一个图形（X为蓝色，Y为绿色，Z为橙色）。还有一个紫色图形代表*总加速度*，它是所有三个维度的力的组合。我们将在“工作原理：计算总加速度”部分的[第11页](ch01.xhtml#page_11)解释如何计算总加速度。
- en: If you find that readings don’t appear in the REPL area of the screen, you may
    have an old micro:bit that needs an update for this to work. If this is the case,
    follow the instructions at *[https://support.microbit.org/support/solutions/articles/19000019131-how-to-upgrade-the-firmware-on-the-micro-bit/](https://support.microbit.org/support/solutions/articles/19000019131-how-to-upgrade-the-firmware-on-the-micro-bit/)*
    to update your device.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你发现屏幕上的REPL区域没有显示读数，可能是你的micro:bit版本较旧，需要更新才能正常工作。如果是这种情况，请按照*[https://support.microbit.org/support/solutions/articles/19000019131-how-to-upgrade-the-firmware-on-the-micro-bit/](https://support.microbit.org/support/solutions/articles/19000019131-how-to-upgrade-the-firmware-on-the-micro-bit/)*上的说明更新你的设备。
- en: '**Code**'
  id: totrans-73
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**代码**'
- en: 'Here’s the Python code that sends the accelerometer data to Mu’s plotter:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 这是将加速度计数据发送到Mu的绘图工具的Python代码：
- en: from microbit import *
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: from microbit import *
- en: from math import sqrt
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: from math import sqrt
- en: 'while True:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 'while True:'
- en: x, y, z = accelerometer.get_values()
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: x, y, z = accelerometer.get_values()
- en: net = sqrt(x*x + y*y + z*z)
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: net = sqrt(x*x + y*y + z*z)
- en: all = (x, y, z, net)
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: all = (x, y, z, net)
- en: print(all)
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: print(all)
- en: sleep(100)
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: sleep(100)
- en: Import the usual micro:bit library. Then import the square root function `sqrt`
    from the Python math library. We’ll use this function to calculate net acceleration.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 导入常规的micro:bit库。然后从Python的math库中导入平方根函数`sqrt`。我们将使用这个函数来计算净加速度。
- en: 'Add a `while` loop, which gets the readings for the X, Y, and Z dimensions
    from the accelerometer in one go using the `get_values` method. This line will
    return a *tuple*, which is a data structure capable of holding multiple values.
    Assign this tuple to three variables: `x`, `y`, and `z`. These will hold the three
    values, respectively. We use these variables to calculate the net acceleration,
    which we assign to the variable `net`.'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 添加一个`while`循环，使用`get_values`方法一次性从加速度计获取X、Y和Z三个维度的读数。这一行将返回一个*元组*，它是一种可以容纳多个值的数据结构。将这个元组赋值给三个变量：`x`、`y`和`z`，分别存储三个值。我们使用这些变量来计算净加速度，并将其赋值给变量`net`。
- en: Next, send the net acceleration value along with the individual values for the
    X, Y, and Z accelerations to Mu for plotting. Mu expects the values you want to
    plot to be in the form of a tuple, so create a new tuple, `all`, that contains
    all four values.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，将净加速度值以及X、Y和Z三个维度的单独加速度值发送给Mu进行绘图。Mu要求你要绘制的值以元组的形式传递，因此创建一个新的元组`all`，包含这四个值。
- en: Finally, print the tuple, which not only shows the values on Mu’s REPL (for
    more information on this, see “The REPL” on [page 23](ch01.xhtml#page_23)) but
    also provides these values to the Plotter. You can see the values printed in the
    bottom left of [Figure 5-6](ch05.xhtml#ch5fig6).
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，打印元组，这不仅会在Mu的REPL中显示这些值（有关详细信息，请参见[第23页](ch01.xhtml#page_23)的《REPL》），还会将这些值提供给Plotter。你可以在[图
    5-6](ch05.xhtml#ch5fig6)的左下角看到打印出来的值。
- en: '**How It Works: Calculating Net Acceleration**'
  id: totrans-87
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**工作原理：计算净加速度**'
- en: 'To calculate the net acceleration on the X, Y, and Z dimensions, you need to
    use some ancient Greek technology: the *Pythagorean theorem*.'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 要计算X、Y和Z三个维度上的净加速度，你需要使用一些古老的希腊技术：*毕达哥拉斯定理*。
- en: To understand how this works, picture an acceleration force as a line with an
    arrow on the end. The arrow indicates the direction of the force, and the length
    of the line indicates how strong the force is. Lines like these are called *vectors*,
    and they are used often in physics.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 为了理解这一点，可以把加速度力想象成一条带箭头的线。箭头表示力的方向，线的长度表示力的强度。像这样的线称为*向量*，在物理学中经常使用它们。
- en: '![Image](../images/05fig05.jpg)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/05fig05.jpg)'
- en: '*Figure 5-5: Two-dimensional vectors*'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 5-5：二维向量*'
- en: Vectors are easier to understand in two dimensions than in three. [Figure 5-5](ch05.xhtml#ch5fig5)
    shows some two-dimensional vectors on the X and Y dimensions. The blue vector
    along the X axis has a strength of 4, and the green vector along the Y axis has
    a strength of 3.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 在二维空间中，向量比在三维空间中更容易理解。[图 5-5](ch05.xhtml#ch5fig5)显示了X和Y维度上的一些二维向量。沿X轴的蓝色向量强度为4，沿Y轴的绿色向量强度为3。
- en: The purple vector, equivalent to the combined effect of the green and blue vectors,
    is the *net vector* our program calculated earlier. The net vector is useful because
    its length tells you the overall strength of the force. To calculate the strength
    of the net vector, you can use the Pythagorean theorem.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 紫色向量，等于绿色和蓝色向量的合成效应，就是我们程序之前计算出来的*净向量*。净向量非常有用，因为它的长度告诉你力的整体强度。要计算净向量的强度，你可以使用毕达哥拉斯定理。
- en: The Pythagorean theorem says that in a right triangle (a triangle that has a
    right angle), the square of the *hypotenuse* (the triangle’s longest side) equals
    the sum of the squares of the other two sides.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 勾股定理指出，在直角三角形中（即有一个直角的三角形），*斜边*（三角形的最长边）的平方等于其他两边的平方和。
- en: Looking at [Figure 5-5](ch05.xhtml#ch5fig5), you can see that we do indeed have
    a right triangle, because the blue and green vectors intersect at a right angle.
    Using the Pythagorean theorem, we can say that the square of the length of the
    purple line is equal to 32 + 42\. That’s 9 + 16, which equals 25\. So, the length
    of the purple line is the square root of 25, which is 5.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 看[图 5-5](ch05.xhtml#ch5fig5)，你可以看到我们确实有一个直角三角形，因为蓝色和绿色向量在一个直角处交汇。利用勾股定理，我们可以说紫色线的长度平方等于32
    + 42。即9 + 16，结果是25。所以，紫色线的长度是25的平方根，等于5。
- en: The math works in three dimensions as well as two. To find the length of a net
    vector for the dimensions X, Y, and Z, take the square root of the sum of the
    squares of all three X, Y, and Z vectors.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 这个数学原理不仅适用于二维，也适用于三维。要计算 X、Y 和 Z 维度的网向量的长度，只需将这三个向量的平方和开方。
- en: '[Figure 5-6](ch05.xhtml#ch5fig6) shows the three forces in the X, Y, and Z
    dimensions at some point in time.'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 5-6](ch05.xhtml#ch5fig6)展示了在某一时刻，X、Y 和 Z 维度中的三个力。'
- en: '![Image](../images/05fig06.jpg)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/05fig06.jpg)'
- en: '*Figure 5-6: Acceleration forces as vectors in three dimensions*'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 5-6：三维空间中的加速度力向量*'
- en: Here’s the line of code that calculates the length of the single vector that
    would replace the X, Y, and Z vectors.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 这是计算替代 X、Y 和 Z 向量的单一向量长度的代码行。
- en: net = sqrt(x*x + y*y + z*z)
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: net = sqrt(x*x + y*y + z*z)
- en: The X, Y, and Z values are found in `a[0]`, `a[1]`, and `a[2]`, respectively,
    in the tuple returned by `accelerometer.get_values().`
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: X、Y 和 Z 值分别可以在由`accelerometer.get_values()`返回的元组中的`a[0]`、`a[1]`和`a[2]`找到。
- en: 'If the X, Y, and Z vectors were of lengths 4, 3, and 2, as shown in [Figure
    5-6](ch05.xhtml#ch5fig6), then calculating the square of the length of the net
    vector would look like this:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 X、Y 和 Z 向量的长度分别为4、3和2，如[图 5-6](ch05.xhtml#ch5fig6)所示，那么计算网向量的长度平方应如下：
- en: 4 × 4 + 3 × 3 + 2 × 2 = 16 + 9 + 4 = 29
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 4 × 4 + 3 × 3 + 2 × 2 = 16 + 9 + 4 = 29
- en: So, the length of the vector would be the square root of 29, or about 5.4.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，向量的长度将是29的平方根，约为5.4。
- en: '**PROJECT: TOOTHBRUSHING MONITOR**'
  id: totrans-106
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**项目：牙刷监测器**'
- en: '![Image](../images/common3.jpg)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/common3.jpg)'
- en: '*Difficulty: Easy*'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '*难度：简单*'
- en: The Mad Scientist is usually a bit distracted by all the interesting experiments
    going on, so they need some help brushing their teeth thoroughly. That’s why the
    Mad Scientist has used a micro:bit to create a toothbrush monitor ([Figure 5-7](ch05.xhtml#ch5fig7))
    that counts the number of strokes of the toothbrush.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 疯狂科学家通常会被进行中的有趣实验分散注意力，因此他们需要一些帮助，以彻底刷牙。这就是为什么疯狂科学家使用 micro:bit 创建了一个牙刷监测器（[图
    5-7](ch05.xhtml#ch5fig7)），它可以计算牙刷刷动的次数。
- en: '![Image](../images/05fig07.jpg)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/05fig07.jpg)'
- en: '*Figure 5-7: A toothbrush monitor*'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 5-7：牙刷监测器*'
- en: The toothbrush monitor displays a score that ranges from 0 to 9 on the display.
    It increases the score by 1 for every 50 strokes of the toothbrush. When it counts
    a score of 10, it displays the happy face icon to show the Mad Scientist that
    toothbrushing is all done—until next time.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 牙刷监测器在显示屏上显示一个从0到9的得分。每刷50次牙刷，得分增加1。当得分达到10时，它会显示一个笑脸图标，表示疯狂科学家已经刷完牙——直到下次。
- en: '**WARNING** *Don’t let your micro:bit get wet—it might break!*'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: '**警告** *不要让你的 micro:bit 沾水—它可能会坏掉！*'
- en: '**What You’ll Need**'
  id: totrans-114
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**你需要的材料**'
- en: 'For this project, you will need the following items:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个项目，你将需要以下物品：
- en: '**Micro:bit**'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '**Micro:bit**'
- en: '**3V battery pack** To power the micro:bit. (The switched type battery box
    is preferred.)'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: '**3V 电池包** 为 micro:bit 提供电源。（建议使用可开关类型的电池盒。）'
- en: '**Manual toothbrush** Not the electric type'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: '**手动牙刷** 不是电动牙刷'
- en: '**2 × Elastic bands** To attach the micro:bit and battery pack to the toothbrush'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: '**2 × 弹性带** 用于将 micro:bit 和电池包固定在牙刷上'
- en: This project is intended for a manual toothbrush. Electric toothbrushes won’t
    work with this project.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 该项目是针对手动牙刷设计的。电动牙刷无法用于此项目。
- en: '**Construction**'
  id: totrans-121
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**构建**'
- en: Go to *[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*
    to access the book’s code repository and click the link for **Toothbrushing Monitor**.
    Once the program has opened, click **Download** and then copy the hex file onto
    your micro:bit.
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问*[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*以获取本书的代码仓库，然后点击**Toothbrushing
    Monitor**的链接。程序打开后，点击**下载**，然后将hex文件复制到你的micro:bit上。
- en: If you prefer to use Python, then download the code from the same website. For
    instructions for downloading and using the book’s examples, see “Downloading the
    Code” on [page 34](ch01.xhtml#page_34). The Python file for this experiment is
    *ch_05_Toothbrush_Monitor.py*.
  id: totrans-123
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你更喜欢使用Python，可以从同一个网站下载代码。有关如何下载和使用本书示例的说明，请参见[第34页](ch01.xhtml#page_34)的“下载代码”。本实验的Python文件为*ch_05_Toothbrush_Monitor.py*。
- en: Plug the battery pack into the micro:bit and attach the battery and micro:bit
    to the toothbrush using elastic bands, as shown in [Figure 5-7](ch05.xhtml#ch5fig7).
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将电池包插入micro:bit，并使用橡皮带将电池和micro:bit固定在牙刷上，如[图5-7](ch05.xhtml#ch5fig7)所示。
- en: When positioning the bands, make sure they don’t hide the display and that you
    can still reach the battery pack’s on/off switch. Also, check that the bands aren’t
    over the reset switch on the back of the micro:bit.
  id: totrans-125
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在固定带子时，确保它们不会遮挡显示屏，并且你仍然可以触及电池包的开/关开关。此外，检查带子是否覆盖了micro:bit背面的重置开关。
- en: Switch on the battery pack. Once it’s on, the micro:bit should show 0\. Brush
    vigorously, and after a little while, the display should show 1.
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开电池包。一旦电池包开启，micro:bit应该显示0。用力刷牙，过一会儿，显示应该变为1。
- en: '**Code**'
  id: totrans-127
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**代码**'
- en: The programs for this project measure the acceleration and, if it is above a
    certain level, they add 1 to a count variable to record the number of brush strokes.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 该项目的程序会测量加速度，如果加速度超过某个特定水平，它会将计数变量加1，以记录刷牙次数。
- en: When the count of brush strokes becomes big enough to qualify as another point
    in the tooth-brushing score, then the score is also incremented and displayed.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 当刷牙次数足够多，达到另一个积分要求时，得分会增加并显示出来。
- en: Eventually, when the score gets to 10, the smiley face icon is shown on the
    micro:bit’s display.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 最终，当得分达到10时，微笑图标会显示在micro:bit的显示屏上。
- en: '**Blocks Code**'
  id: totrans-131
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**Blocks代码**'
- en: Here is the Blocks code for the project.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 这是该项目的Blocks代码。
- en: '![Image](../images/f0118-01.jpg)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/f0118-01.jpg)'
- en: 'This is probably the most complex program so far in the book. The `on start`
    block defines four variables. Here’s what each of them does:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 这可能是本书中最复杂的程序。`on start`模块定义了四个变量。以下是它们各自的作用：
- en: '**strokes per point** This specifies the number of brush strokes needed to
    advance your score by a point. If you are a lazy brusher, then you can decrease
    this number so that the points increase more quickly and you get your smiley-face
    reward faster. Note, however, that your next visit to the dentist may not be fun.'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: '**每个积分的刷牙次数** 这指定了提高你得分所需的刷牙次数。如果你是一个懒得刷牙的人，那么你可以减少这个数字，这样积分会更快增加，且你能更快得到微笑奖励。然而，请注意，你下次去看牙医时可能不会很愉快。'
- en: '**score** This is the number that increases as you complete each set of 50
    brush strokes until it reaches 10.'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: '**得分** 这是一个随着你完成每50次刷牙而增加的数字，直到达到10。'
- en: '**count** This is used to track the number of strokes completed since you earned
    a point. It starts at 0 and resets each time the score goes up.'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: '**计数** 这个变量用于跟踪自从你获得积分以来完成的刷牙次数。它从0开始，每次得分增加时会重置。'
- en: '**old mg** This variable holds the acceleration value in milli-gravities the
    last time it checked for a brush stroke. The program will compare this value to
    the new value to detect brush strokes.'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: '**旧mg** 该变量保存上次检查刷牙次数时的加速度值（以毫重力为单位）。程序将比较这个值和新值，以检测刷牙动作。'
- en: We make a `forever` block, and inside we have a `set XX to` block. From the
    drop-down, we select `mg` so that that this block puts the overall acceleration
    reading into a variable called `mg`. In the `acceleration (mg)` block’s drop-down
    menu, choose `strength`, which does the Pythagorean theorem calculation for you.
    (If you’re using MicroPython, you’ll have to calculate it yourself.)
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 我们创建一个`forever`模块，并在其中使用一个`set XX to`模块。从下拉菜单中选择`mg`，这样这个模块会将整体加速度读数放入名为`mg`的变量中。在`加速度
    (mg)`模块的下拉菜单中，选择`strength`，它会为你计算勾股定理。（如果你使用MicroPython，你需要自己计算。）
- en: Then a `set change in mg` block calculates the change in acceleration strength
    by subtracting the current strength from the previous strength (held in `old mg`).
    If the change is greater than 800—indicating the start of a brushing movement—the
    `count` increases by 1\. The value of 800 was chosen by looking at [Figure 5-8](ch05.xhtml#ch5fig8),
    which is a plot of the net acceleration for a short period of vigorous toothbrushing.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，`set change in mg` 块通过将当前的加速度强度与之前的加速度强度（存储在`old mg`中）相减，计算加速度强度的变化。如果变化大于800—表示开始刷牙动作—则`count`增加1。800的值是通过查看[图5-8](ch05.xhtml#ch5fig8)选定的，图中展示的是短时间剧烈刷牙的净加速度曲线。
- en: '![Image](../images/05fig08.jpg)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/05fig08.jpg)'
- en: '*Figure 5-8: A plot of net acceleration during toothbrushing*'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: '*图5-8：刷牙过程中的净加速度曲线*'
- en: On the plot, each peak represents one brush stroke, with the maximum net acceleration
    occurring when the brush changes direction. The value of 800 is enough to capture
    most strokes, since most strokes produce a change in acceleration of around 1,000\.
    If you brush your teeth quite gently, you might need to decrease this threshold,
    or you could be left brushing your teeth forever, never racking up a large enough
    score to stop.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 在图表中，每一个峰值代表一次刷牙动作，最大净加速度出现在刷牙改变方向时。800的值足以捕捉大部分刷牙动作，因为大多数刷牙动作产生的加速度变化约为1000。如果你刷牙的力度较轻，可能需要降低这个阈值，否则你可能会永远刷牙，得不到足够的分数来停止。
- en: Next, place the first `if` block to detect acceleration large enough to indicate
    a brush stroke and, inside that, place a second `if` block that checks the value
    of `count`. If the value has exceeded the number you set earlier in `strokes per
    point`, then the program adds 1 to `score` and displays the new `score` value.
    Finally, the program checks whether `score` is greater than 9 and, if it is, displays
    a smiley-face icon.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，放置第一个`if`块来检测足够大的加速度，表示刷牙动作，并在其中放置第二个`if`块来检查`count`的值。如果值超过了你在`strokes
    per point`中设置的数量，程序会将`score`加1，并显示新的`score`值。最后，程序会检查`score`是否大于9，如果是，它会显示一个笑脸图标。
- en: '**MicroPython Code**'
  id: totrans-145
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**MicroPython代码**'
- en: Here is the MicroPython version of the code.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是MicroPython版本的代码。
- en: from microbit import *
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: from microbit import *
- en: from math import sqrt
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: from math import sqrt
- en: strokes_per_point = 50
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: strokes_per_point = 50
- en: old_mg = 0
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: old_mg = 0
- en: count = 0
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: count = 0
- en: change_in_mg = 0
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: change_in_mg = 0
- en: score = 0
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: score = 0
- en: mg = 0
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: mg = 0
- en: display.show(str(score))
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: display.show(str(score))
- en: 'while True:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 'while True:'
- en: x, y, z = accelerometer.get_values()
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: x, y, z = accelerometer.get_values()
- en: mg = sqrt(x*x + y*y + z*z)
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: mg = sqrt(x*x + y*y + z*z)
- en: change_in_mg = mg - old_mg
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: change_in_mg = mg - old_mg
- en: old_mg = mg
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: old_mg = mg
- en: 'if change_in_mg > 800:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 'if change_in_mg > 800:'
- en: count += 1
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: count += 1
- en: 'if count > strokes_per_point:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 'if count > strokes_per_point:'
- en: score += 1
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: score += 1
- en: display.show(str(score))
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: display.show(str(score))
- en: count = 0
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: count = 0
- en: 'if score > 9:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 'if score > 9:'
- en: display.show(Image.HAPPY)
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: display.show(Image.HAPPY)
- en: The MicroPython code mirrors the Blocks code almost exactly, except that the
    overall strength of the force has to be calculated since MicroPython has no built-in
    function for this for the micro:bit.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: MicroPython代码几乎完全复制了Blocks代码，不同之处在于需要计算力的总强度，因为MicroPython没有内建函数来处理micro:bit的这个功能。
- en: '**Things to Try**'
  id: totrans-170
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**尝试的事项**'
- en: You could use this project as a *pedometer*—a device that measures how many
    steps you take when walking or running. To do this, try simplifying the code to
    get rid of the score variable, because we are now only interested in the number
    of steps (equivalent to the strokes when toothbrushing). You’ll want your code
    to keep track of steps and then, when you press button A, display the number of
    steps you’ve taken. To test it, tuck the project into your sock (remove the toothbrush
    first) and walk around while counting your steps in your head. Then see how many
    steps the pedometer says you’ve taken. If the measurement isn’t accurate, you
    may need to change the acceleration threshold from 800 to make the pedometer more
    or less sensitive.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以将这个项目用作*计步器*—一种测量你走路或跑步时步数的设备。为此，尝试简化代码，去掉`score`变量，因为我们现在只关心步数（等同于刷牙时的刷次数）。你需要让代码记录步数，并在按下A按钮时显示你走了多少步。为了测试，试着把这个项目放进你的袜子里（先拿掉牙刷），然后走动，同时在脑海中计算步数。然后看看计步器显示你走了多少步。如果测量不准确，可能需要调整加速度阈值，从800调整，来使计步器更或更少灵敏。
- en: '**EXPERIMENT 7: LOGGING ACCELERATION TO A FILE**'
  id: totrans-172
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**实验7：将加速度记录到文件**'
- en: '![Image](../images/common2.jpg)'
  id: totrans-173
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/common2.jpg)'
- en: The Plotter built into Mu is great if you don’t mind keeping your micro:bit
    tethered to your computer with a USB cable. However, sometimes the Mad Scientist
    finds it useful to record readings on the micro:bit remotely for later analysis.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: Mu 内置的绘图工具非常适合如果你不介意将 micro:bit 通过 USB 数据线连接到计算机。然而，有时疯狂科学家会发现远程记录 micro:bit
    上的读数，以便后续分析，非常有用。
- en: In this experiment, you’ll use your micro:bit to record accelerometer readings
    in a file saved on the micro:bit. You can wave the micro:bit around and do various
    other tests on it and then look at charts of the measured acceleration.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个实验中，你将使用 micro:bit 在保存到 micro:bit 上的文件中记录加速度计读数。你可以挥动 micro:bit 并进行各种测试，然后查看测量到的加速度的图表。
- en: '![Image](../images/f0122-01.jpg)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/f0122-01.jpg)'
- en: The program will take about 60 readings per second, and it can record about
    45 seconds’ worth of samples before the micro:bit runs out of memory.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 该程序每秒会进行大约 60 次读数，它可以记录约 45 秒的样本，直到 micro:bit 的内存用尽。
- en: '**What You’ll Need**'
  id: totrans-178
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**你需要的工具**'
- en: 'For this experiment, you’ll need:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个实验，你需要：
- en: '**Micro:bit**'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: '**Micro:bit**'
- en: '**3V battery pack**'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: '**3V 电池组**'
- en: '**Construction**'
  id: totrans-182
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**构造**'
- en: This project uses the micro:bit’s local filesystem, which is not available in
    Blocks code at the time of this writing. That means you’ll have to use Python
    for this experiment. Download the code from *[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*,
    along with instructions for downloading and using the book examples. The Python
    file for this experiment is *Experiment_07.py*. Load the program onto your micro:bit.
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 本项目使用 micro:bit 的本地文件系统，而在本文编写时，Blocks 代码无法使用该功能。这意味着你需要使用 Python 来进行这个实验。从
    *[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)* 下载代码，并查看下载和使用书中示例的说明。这个实验的
    Python 文件是 *Experiment_07.py*。将程序加载到你的 micro:bit 上。
- en: When you turn on the micro:bit, its display will show an X. This means it isn’t
    recording any readings. When you click button A, the icon will change to a check
    mark, and the micro:bit will start recording. It will stop recording when you
    press button A again, at which point it will save the accelerometer readings in
    a file that you can transfer to your computer.
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当你打开 micro:bit 时，它的显示屏将显示一个 X。这意味着它没有记录任何读数。当你点击 A 按钮时，图标将变为对勾，micro:bit 开始记录。再次按下
    A 按钮时，它将停止记录，并将加速度计读数保存到一个文件中，你可以将该文件传输到你的计算机。
- en: To test this out, press **button A**, wave the micro:bit around, and press **button
    A** again.
  id: totrans-185
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 为了测试这一点，按下 **A 按钮**，挥动 micro:bit，然后再次按下 **A 按钮**。
- en: To transfer the file containing the readings to your computer, use Mu’s *Files*
    feature. Connect your micro:bit to your computer with a USB cable and click the
    **Files** icon in Mu’s toolbar ([Figure 5-9](ch05.xhtml#ch5fig9)).
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要将包含读数的文件传输到你的计算机，请使用 Mu 的 *Files* 功能。用 USB 数据线将 micro:bit 连接到你的计算机，然后点击 Mu
    工具栏中的 **Files** 图标（见 [图 5-9](ch05.xhtml#ch5fig9)）。
- en: The bottom of the window now has two columns. On the left are the files saved
    on the micro:bit. In [Figure 5-9](ch05.xhtml#ch5fig9), there is only one file,
    *data.txt*. On the right are the files in Mu’s code directory, which is in your
    home directory under *mu code*.
  id: totrans-187
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 窗口底部现在有两列。左侧是保存在 micro:bit 上的文件。在 [图 5-9](ch05.xhtml#ch5fig9) 中，只有一个文件，*data.txt*。右侧是
    Mu 的代码目录中的文件，该目录位于你的主目录下的 *mu code* 文件夹中。
- en: '![Image](../images/05fig09.jpg)'
  id: totrans-188
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![Image](../images/05fig09.jpg)'
- en: '*Figure 5-9: Mu’s File feature in action*'
  id: totrans-189
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*图 5-9: Mu 的文件功能操作*'
- en: To copy the file from the micro:bit, just drag it from the left area to the
    right area in the Mu window.
  id: totrans-190
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 要从 micro:bit 复制文件，只需将其从 Mu 窗口左侧区域拖到右侧区域。
- en: As with Experiment 6, earlier in the chapter, if the Files feature doesn’t work
    in Mu, you may have an old micro:bit that needs an update. In this case, follow
    the instructions at *[https://support.microbit.org/support/solutions/articles/19000019131-how-to-upgrade-the-firmware-on-the-micro-bit/](https://support.microbit.org/support/solutions/articles/19000019131-how-to-upgrade-the-firmware-on-the-micro-bit/)*
    to update your device.
  id: totrans-191
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如同本章前面实验 6 中提到的，如果 Mu 中的 Files 功能无法使用，可能是你使用的 micro:bit 需要更新。此时，按照 *[https://support.microbit.org/support/solutions/articles/19000019131-how-to-upgrade-the-firmware-on-the-micro-bit/](https://support.microbit.org/support/solutions/articles/19000019131-how-to-upgrade-the-firmware-on-the-micro-bit/)*
    中的说明更新你的设备。
- en: Once you’ve transferred the data from the micro:bit to your computer, you’ll
    plot the data by importing the file into a spreadsheet, such as Excel or Google
    Sheets.
  id: totrans-192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦你将数据从 micro:bit 传输到你的计算机，你将通过将文件导入电子表格（如 Excel 或 Google Sheets）来绘制数据。
- en: The procedure is a bit different depending on which spreadsheet software you
    use. I’ll show you how to use Google Sheets since it’s free. You just need to
    be logged into a Google account.
  id: totrans-193
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 根据你使用的电子表格软件，程序的步骤会有所不同。我将向你展示如何使用免费的 Google Sheets。你只需要登录到 Google 帐号即可。
- en: Visit *[https://docs.google.com/spreadsheets/](https://docs.google.com/spreadsheets/)*
    and click the **Blank** option in the *Start a new spreadsheet* area. Then, from
    the Google Sheets menu, select **File**▸ **Import**. From the pop-up window that
    appears, select the **Upload** tab and navigate to the *data.txt* file that you
    copied onto your computer.
  id: totrans-194
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 访问 *[https://docs.google.com/spreadsheets/](https://docs.google.com/spreadsheets/)*，然后点击
    *开始新电子表格* 区域中的 **空白** 选项。接着，在 Google Sheets 菜单中选择 **文件**▸**导入**。在弹出的窗口中，选择 **上传**
    标签并导航到你已经复制到电脑中的 *data.txt* 文件。
- en: The recorded data should appear in the first column of your spreadsheet. Select
    the column and click **Insert**▸**Chart** to create a chart of the data, like
    the one shown in [Figure 5-10](ch05.xhtml#ch5fig10).
  id: totrans-195
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 录制的数据应该出现在电子表格的第一列中。选择这一列并点击 **插入**▸**图表**，就能生成数据图表，像 [图 5-10](ch05.xhtml#ch5fig10)
    中显示的那样。
- en: '![Image](../images/05fig10.jpg)'
  id: totrans-196
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/05fig10.jpg)'
- en: '*Figure 5-10: Charting data recorded on the micro:bit*'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 5-10：在 micro:bit 上绘制的数据图表*'
- en: '**Code**'
  id: totrans-198
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**代码**'
- en: 'Here is the MicroPython code for this experiment:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 这是此实验的 MicroPython 代码：
- en: from microbit import *
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: from microbit import *
- en: from math import sqrt
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: from math import sqrt
- en: import os
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: import os
- en: filename = 'data.txt'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: filename = 'data.txt'
- en: recording = False
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: recording = False
- en: display.show(Image.NO)
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: display.show(Image.NO)
- en: 'while True:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 'while True:'
- en: 'if button_a.was_pressed():'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 'if button_a.was_pressed():'
- en: recording = not recording
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: recording = not recording
- en: 'if recording:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 'if recording:'
- en: display.show(Image.YES)
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: display.show(Image.YES)
- en: 'try:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 'try:'
- en: os.remove(filename)
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: os.remove(filename)
- en: 'except:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 'except:'
- en: pass
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: pass
- en: fs = open(filename, 'w')
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: fs = open(filename, 'w')
- en: 'else:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 'else:'
- en: display.show(Image.NO)
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: display.show(Image.NO)
- en: fs.close()
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: fs.close()
- en: 'if recording:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 'if recording:'
- en: x, y, z = accelerometer.get_values()
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: x, y, z = accelerometer.get_values()
- en: net = sqrt(x*x + y*y + z*z)
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: net = sqrt(x*x + y*y + z*z)
- en: fs.write(str(net))
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: fs.write(str(net))
- en: fs.write('\n')
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: fs.write('\n')
- en: sleep(10)
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: sleep(10)
- en: The micro:bit can save only a limited amount of data, so import the `os` package,
    which will let you delete any data already on your micro:bit.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: micro:bit 只能保存有限量的数据，因此需要导入 `os` 包，这样你就可以删除 micro:bit 上已经存在的任何数据。
- en: Set the data filename as `data.txt`. You can change the name of this file by
    altering the value of the `filename` variable, though I recommend keeping it as
    is until you’ve gotten the program working.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 将数据文件名设置为 `data.txt`。你可以通过修改 `filename` 变量的值来更改文件名，但我建议在程序工作正常之前保持原名。
- en: 'Make a variable called `recording` to keep track of whether the project is
    recording or not. This is toggled between `True` and `False` in the main `while`
    loop every time button A is pressed to start and stop the recording of data. That’s
    what the line `recording = not recording` does: if `recording` is `True`, the
    code sets it to `False`, and vice versa.'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个名为 `recording` 的变量来跟踪项目是否正在录制数据。每次按下 A 按钮时，这个变量会在 `True` 和 `False` 之间切换，从而控制数据的录制开始和停止。这就是
    `recording = not recording` 这一行的作用：如果 `recording` 为 `True`，代码会将其设置为 `False`，反之亦然。
- en: Create a `while True` loop to run forever. Inside this loop are two `if` statements.
    The first tells the micro:bit what to do when button A is pressed, and the second
    checks whether we are in recording mode. When button A is first pressed, recording
    starts, the screen displays the `YES` image, and the `os.remove` method deletes
    the existing data file.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个 `while True` 循环，让程序永远运行。在这个循环中有两个 `if` 语句。第一个指示 micro:bit 在按下 A 按钮时该做什么，第二个检查我们是否处于录制模式。当第一次按下
    A 按钮时，录制开始，屏幕显示 `YES` 图像，`os.remove` 方法会删除现有的数据文件。
- en: 'We’ve put the `remove` command within a `try: except:` Python structure. This
    ensures that if any error occurs (in particular, if the data file can’t be deleted
    because it’s not there), the program ignores the error and doesn’t crash the program.'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: '我们将 `remove` 命令放入了 `try: except:` Python 结构中。这样可以确保如果发生任何错误（特别是如果数据文件无法删除，因为它不存在），程序会忽略这个错误并继续运行，而不会崩溃。'
- en: The program then opens the file with a mode of `w`, which means you can write
    in it. When button A is pressed again, the screen displays the `NO` image and
    the file closes.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 程序接着以 `w` 模式打开文件，这意味着你可以在文件中写入内容。当按下 A 按钮时，屏幕会显示 `NO` 图像，文件随之关闭。
- en: Also contained in the main `while` loop is another `if` block that writes a
    reading from the accelerometer to the file as long as `recording` is `True`. If
    the program runs for too long and fills up all the file space, it will give an
    error. However, the data that it wrote before it ran out of room will still be
    available.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 主 `while` 循环中还包含另一个 `if` 块，只要 `recording` 为 `True`，就会将加速度计的读数写入文件。如果程序运行时间过长，填满所有文件空间，它会给出错误。但是，它在空间不足之前写入的数据仍然可用。
- en: The `sleep` command at the end of the recording slows down the recording process
    so that you don’t run out of memory too quickly.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 录制结束时的 `sleep` 命令会减缓录制过程，这样你就不会太快耗尽内存。
- en: '**Things to Try**'
  id: totrans-233
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**尝试的事情**'
- en: 'This experiment will let you measure accelerations in various practical situations.
    You could, for example, record the accelerations on your micro:bit when you throw
    it into the air. If you plan to try this, then it’s wise to take a few precautions:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 这个实验可以让你在各种实际情况下测量加速度。例如，你可以记录在将 micro:bit 扔到空中时它的加速度。如果你打算尝试这一点，最好采取一些预防措施：
- en: '![Image](../images/play.jpg)  Choose an environment with soft ground. That
    way, if you fail to catch your micro:bit, it might survive. During experiments
    like this, it’s not unusual for a battery to come loose or fall out of its holder.'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: '![Image](../images/play.jpg)  选择一个软的地面环境。这样，如果你没能接住 micro:bit，它可能会幸存下来。在这样的实验中，电池松动或从支架中掉出的情况并不罕见。'
- en: '![Image](../images/play.jpg)  Don’t throw your micro:bit somewhere where it
    may hit someone in the head.'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: '![Image](../images/play.jpg)  不要把你的 micro:bit 随便扔到可能会打到别人头部的地方。'
- en: '![Image](../images/play.jpg)  Attach the micro:bit to the battery pack. Elastic
    bands are good for this.'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: '![Image](../images/play.jpg)  将 micro:bit 附着在电池包上。弹力带是个不错的选择。'
- en: '![Image](../images/play.jpg)  Put your micro:bit in a case. A Kitronik MI:pro
    case with MI:power battery backpack, shown in [Figure 5-11](ch05.xhtml#ch5fig11),
    is a great choice. If you use this case, you won’t need a battery pack, because
    the case contains a tiny 3V battery.'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: '![Image](../images/play.jpg)  把你的 micro:bit 放进一个外壳里。带有 MI:power 电池背包的 Kitronik
    MI:pro 外壳（如 [图 5-11](ch05.xhtml#ch5fig11) 所示）是一个很好的选择。如果你使用这个外壳，你就不需要额外的电池包，因为外壳里已经包含了一个小型的
    3V 电池。'
- en: '![Image](../images/05fig11.jpg)'
  id: totrans-239
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/05fig11.jpg)'
- en: '*Figure 5-11: Kitronik MI:pro case with MI:power battery backpack*'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 5-11: 带 MI:power 电池背包的 Kitronik MI:pro 外壳*'
- en: You could also measure acceleration by securely attaching a string to the micro:bit
    and swinging it gently in circles. Again, be careful as the micro:bit could easily
    become detached from its string, breaking or hurting someone nearby.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以通过将一根绳子牢固地绑在 micro:bit 上，并轻轻地在空中做圆周摆动来测量加速度。但同样要小心，因为 micro:bit 很容易从绳子上脱落，可能会损坏或伤害到周围的人。
- en: The filesystem used by the micro:bit is very limited; it has only about 40KB
    available for storage. Therefore, previous files may be erased every time you
    flash a new program onto the micro:bit.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: micro:bit 使用的文件系统非常有限，它的存储空间大约只有 40KB。因此，每次你向 micro:bit 刷写新程序时，之前的文件可能会被擦除。
- en: '**PROJECT: ACCELERATION DISPLAY**'
  id: totrans-243
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**项目：加速度显示**'
- en: '![Image](../images/common3.jpg)'
  id: totrans-244
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/common3.jpg)'
- en: '*Difficulty: Easy*'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: '*难度：简单*'
- en: This project, shown in [Figure 5-12](ch05.xhtml#ch5fig12), allows you to see
    the micro:bit’s acceleration on its display. When the micro:bit is at rest, the
    middle row of LEDs on the display will be lit. If you rapidly move the micro:bit
    up, then the line of LEDs will move up the display, like an elevator, in response
    to the increase in the net force. Similarly, if you quickly move the micro:bit
    down, the line will move down, indicating the reduced effect of gravity, as if
    you were accelerating downward in an elevator.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 如 [图 5-12](ch05.xhtml#ch5fig12) 所示，这个项目允许你在显示屏上看到 micro:bit 的加速度。当 micro:bit
    处于静止状态时，显示屏的中间一行 LED 会亮起。如果你快速将 micro:bit 向上移动，LED 行会像电梯一样在显示屏上向上移动，响应净力的增加。类似地，如果你快速将
    micro:bit 向下移动，LED 行会向下移动，表示重力效应减弱，仿佛你在电梯里向下加速。
- en: '![Image](../images/05fig12.jpg)'
  id: totrans-247
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/05fig12.jpg)'
- en: '*Figure 5-12: A Micro:bit acceleration display*'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 5-12: Micro:bit 加速度显示*'
- en: '**What You’ll Need**'
  id: totrans-249
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**你将需要的东西**'
- en: For this project, you just need a micro:bit. However, it’s useful to have a
    battery pack if you want to make this project more mobile.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个项目，你只需要一个 micro:bit。然而，如果你想让这个项目更具移动性，带上电池包会更方便。
- en: You could also use the MI:pro case and MI:power combination shown in [Figure
    5-11](ch05.xhtml#ch5fig11).
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以使用 [图 5-11](ch05.xhtml#ch5fig11) 中展示的 MI:pro 外壳和 MI:power 电池包组合。
- en: '**Construction**'
  id: totrans-252
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**构造**'
- en: Go to *[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*
    to access the book’s code repository and click the link for **Acceleration Display**.
    Once the program has opened, **Download** and then copy the hex file onto your
    micro:bit.
  id: totrans-253
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问* [https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*来访问书本的代码库，并点击**加速度显示**的链接。程序打开后，**下载**并将hex文件复制到你的micro:bit上。
- en: If you prefer to use Python, then download the code from the same website. For
    instructions for downloading and using the book’s examples, see “Downloading the
    Code” on [page 34](ch01.xhtml#page_34). The Python file for this experiment is
    *ch_05_Acceleration_Display.py*.
  id: totrans-254
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你更喜欢使用Python，可以从同一个网站下载代码。有关下载和使用书中示例的说明，请参见[第34页](ch01.xhtml#page_34)的“下载代码”部分。此实验的Python文件是*ch_05_Acceleration_Display.py*。
- en: Try moving your micro:bit up and down, watching how acceleration in various
    directions affects the reading. If you can take your micro:bit for a ride in an
    elevator, watch as the display shows whether you’re going up or down.
  id: totrans-255
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 尝试将你的micro:bit上下移动，观察加速度在各个方向上如何影响读数。如果你能带着micro:bit乘电梯，观察显示屏上是否显示你在上升或下降。
- en: '**Code**'
  id: totrans-256
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**代码**'
- en: The code first takes a reading of acceleration and then uses a bit of math to
    decide which row of the display to light up.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码首先读取加速度数据，然后使用一些数学运算来决定显示屏上点亮哪一行。
- en: '**Blocks Code**'
  id: totrans-258
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**Blocks代码**'
- en: Here is the Blocks code for this project.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 这是本项目的Blocks代码。
- en: '![Image](../images/f0129-01.jpg)'
  id: totrans-260
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/f0129-01.jpg)'
- en: All the code for this project is contained in the `forever` block. It first
    reads the net acceleration and then calculates a value for `y`. Here, `y` represents
    the row of the display that will light up. When the micro:bit is stationary, the
    only force acting on it is gravity, at a net force of 1,000 mg (1 g). Therefore,
    the program subtracts 1,000 from the net acceleration and divides the result by
    100, so that each 1/10 of g will cause a change of 1 row in the display. Finally,
    we add 2 to this result to display row 2 (the middle row of LEDs, if you start
    counting at 0) by default.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 本项目的所有代码都包含在`forever`区块中。它首先读取净加速度，然后计算`y`的值。这里，`y`代表显示屏上将点亮的行。当micro:bit静止时，唯一作用于它的力是重力，净力为1,000
    mg（1 g）。因此，程序从净加速度中减去1,000，然后将结果除以100，这样每1/10的g会导致显示屏上的一行变化。最后，我们将2加到这个结果，以默认显示第2行（如果从0开始计数的话，就是LED的中间行）。
- en: Use two `if` blocks to make sure that the value of `y` remains between 0 and
    4 (for the 5 rows). To draw the correct row, first clear the screen so the old
    row isn’t displayed along with the new reading. Then use a `for` loop to loop
    over each of the five LEDs for that row, which are represented by values of `x`,
    to turn them on.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 使用两个`if`区块来确保`y`的值保持在0和4之间（对应5行）。为了绘制正确的行，首先清除屏幕，以免旧的行与新的读数一起显示。然后，使用`for`循环遍历该行的每个LED，这些LED由`x`值表示，用于点亮它们。
- en: '**MicroPython Code**'
  id: totrans-263
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**MicroPython代码**'
- en: 'Here’s the MicroPython equivalent of the code:'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 这是代码的MicroPython等效版本：
- en: from microbit import *
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 来自microbit的导入*
- en: from math import sqrt
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: from math import sqrt
- en: 'while True:'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 'while True:'
- en: x, y, z = accelerometer.get_values()
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: x, y, z = accelerometer.get_values()
- en: acc = sqrt(x*x + y*y + z*z)
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: acc = sqrt(x*x + y*y + z*z)
- en: y = int(2 + (acc - 1000) / 100)
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: y = int(2 + (acc - 1000) / 100)
- en: display.clear()
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: display.clear()
- en: 'if y < 0:'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 'if y < 0:'
- en: y = 0
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: y = 0
- en: 'if y > 4:'
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 'if y > 4:'
- en: y = 4
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: y = 4
- en: 'for x in range(0, 5):'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 'for x in range(0, 5):'
- en: display.set_pixel(x, y, 9)
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: display.set_pixel(x, y, 9)
- en: This code is similar to the Blocks code, but you have to calculate the net acceleration
    yourself.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码类似于Blocks代码，但你需要自己计算净加速度。
- en: '**SUMMARY**'
  id: totrans-279
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**总结**'
- en: The micro:bit’s accelerometer opens up a lot of opportunities for projects that
    detect the movement or orientation of a micro:bit. In this chapter, you’ve explored
    some interesting ways you can use the accelerometer.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: micro:bit的加速度计为检测micro:bit的运动或方向提供了许多项目的机会。在这一章中，你已经探索了使用加速度计的一些有趣方法。
- en: You’ve also learned how to plot data coming from the micro:bit using Mu’s Plotter
    and record readings into a file to chart and analyze later.
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 你还学会了如何使用Mu的绘图工具绘制来自micro:bit的数据，并将读数记录到文件中，稍后可以绘图并进行分析。
