- en: '15'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '15'
- en: The Art of the Fireflies
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 萤火虫之术
- en: The art of fireflies should be performed only after you know everything about
    the enemy in great detail so that you can construct your deception in accordance
    with the target’s mindset.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 只有在你对敌人有非常详细的了解后，才能执行萤火虫之术，这样你才能根据目标的心态构建你的欺骗。
- en: Before you carry out surveillance or a covert shinobi activity, you should leave
    a note for your future reputation.
  id: totrans-3
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在执行监视或秘密忍者活动之前，你应该为未来的声誉留下一个字条。
- en: ''
  id: totrans-4
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '—Yoshimori Hyakushu #54'
  id: totrans-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '—吉守百首 #54'
- en: The *Bansenshūkai* describes an open-disguise infiltration technique for shinobi
    called “the art of fireflies” (*hotarubi no jutsu*).^([1](b01.xhtml#endnote-96))
    I like to think that this technique was named based on how the flash of light
    from a firefly lingers in your night vision after the fly has moved, causing you
    to grasp at empty space. *Shōninki* describes the same technique as “the art of
    camouflage” (*koto wo magirakasu no narai*).^([2](b01.xhtml#endnote-97)) Using
    this technique, shinobi plant physical evidence that baits an enemy into taking
    some desired action, including misattributing whom the shinobi works for, making
    false assumptions about the shinobi’s motives, and reacting rashly to the attempted
    attack, exposing themselves to further offensive actions.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '*万川集海* 描述了一种名为“萤火虫之术”（*hotarubi no jutsu*）的忍者开放伪装渗透技巧。^([1](b01.xhtml#endnote-96))
    我喜欢这样想，这个技巧之所以命名，是因为萤火虫的闪光在它飞走后会在你的夜视中留下余光，让你抓空了。*胜忍记*将这一技巧描述为“伪装艺术”（*koto wo
    magirakasu no narai*）。^([2](b01.xhtml#endnote-97)) 使用这一技巧，忍者通过布置物理证据，引诱敌人采取一些期望的行动，包括误判忍者的雇主，做出对忍者动机的错误假设，并草率反应，暴露自己，进一步引发攻击。'
- en: A forged letter with incriminating details or misleading evidence about the
    enemy was the most common *hotarubi no jutsu* technique, with several variations.
    The scrolls describe shinobi sewing a letter into their collar so that it would
    be found quickly if they were caught or searched.^([3](b01.xhtml#endnote-98))
    Or, a shinobi might recruit a willing but inept person to be a “ninja,” give them
    a letter detailing the exact opposite of the shinobi’s true plans, and send them
    on a mission into the adversary’s environment, knowing that this “doomed agent”
    would certainly be captured. Importantly, the recruit themselves would not be
    aware of this part of the plan. Upon searching the recruit, guards would find
    the forged letter, which implicated a high-value target—such as the adversary’s
    most capable commander—in a treasonous plot. The “ninja” would likely break under
    torture and attest to the authenticity of the message, further damning the target.^([4](b01.xhtml#endnote-99))
    This all served to deceive the enemy into attacking or disposing of their own
    allies.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 一封伪造的信件，内含关于敌人的犯罪细节或误导性证据，是最常见的*萤火虫之术*技巧，并且有多种变体。卷轴中描述了忍者将信件缝进自己的衣领，这样如果他们被抓住或搜查，信件就能被迅速找到。^([3](b01.xhtml#endnote-98))
    或者，忍者可能会招募一个愿意但无能的人当“忍者”，给他们一封写着与忍者真正计划完全相反的信件，并将他们派遣到敌人的环境中，知道这个“注定失败的特工”肯定会被抓住。重要的是，这个招募者自己不会意识到这一部分计划。经过搜查，守卫们会发现这封伪造的信件，信中将某个高价值目标——比如敌方最有能力的指挥官——牵涉到叛国阴谋中。这个“忍者”在酷刑下很可能会崩溃，并证明消息的真实性，进一步加重了目标的罪名。^([4](b01.xhtml#endnote-99))
    这一切都旨在欺骗敌人，迫使他们攻击或处置自己的盟友。
- en: In an even more elaborate variation, prior to the mission, the shinobi would
    carefully plant evidence that supported the letter’s false story and place the
    forged letter in an incriminating location, such as the quarters of the enemy
    commander’s trusted adviser. The forged letter then became a safeguard. If the
    shinobi were caught, they would withstand torture until they could determine the
    enemy’s objectives, and then reveal their secret knowledge of the letter. The
    enemy would then find the letter and the connected evidence. Having built credibility,
    the shinobi would then pledge to become a double agent or share secrets about
    their employer in exchange for not being executed.^([5](b01.xhtml#endnote-100))
    This technique left the enemy confused about the shinobi’s motives, concerned
    about potential betrayal, and in doubt about who the real adversary was.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 在一个更加复杂的变种中，在任务开始之前，忍者会小心地种下支持信件虚假故事的证据，并将伪造的信件放置在一个有罪证据的地方，例如敌方指挥官的亲信顾问的住处。伪造的信件随后成为一种保护手段。如果忍者被捕，他们会忍受拷打，直到能够确定敌人的目标，然后透露自己对信件的秘密知识。敌人接着会找到信件和相关证据。在建立了可信度之后，忍者会承诺成为双重间谍或分享关于雇主的秘密，以换取不被处决的机会。^([5](b01.xhtml#endnote-100))
    这一技巧使敌人对忍者的动机产生困惑，担心潜在的背叛，并怀疑谁才是实际的对手。
- en: In this chapter, we will review the challenges associated with attributing threats
    to a specific adversary and/or source. We’ll cover attribution investigations
    using threat analytics, observable evidence, and behavior-based intelligence assessments.
    We’ll also discuss the problem of sophisticated adversaries who are aware of these
    attribution methods and thus take countermeasures. The more emphasis a defender
    places on attribution, the more difficult and risky cyber threat actors can make
    pursuing leads, so we’ll also discuss ways to address this increased risk.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将回顾将威胁归因于特定对手和/或来源的挑战。我们将讨论使用威胁分析、可观察证据和基于行为的情报评估进行归因调查。我们还将讨论复杂对手的问题，这些对手了解这些归因方法，因此会采取对策。防御者越重视归因，网络威胁行为者就越能通过设法追踪线索来增加困难和风险，因此我们还将讨论应对这种增加风险的方法。
- en: Attribution
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 归因
- en: '*Attribution*, in a cybersecurity context, refers to an assessment of observable
    evidence that can be used to identify actors in cyberspace. The evidence can take
    many forms. A threat actor’s behavior, tools, techniques, tactics, procedures,
    capabilities, motives, opportunities, and intent, among other information, all
    provide valuable context and drive responses to security events.'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '*归因*，在网络安全的上下文中，是指对可观察证据的评估，这些证据可以用来识别网络空间中的行为者。这些证据可以有多种形式。威胁行为者的行为、工具、技术、战术、程序、能力、动机、机会和意图等信息，都提供了宝贵的背景信息，并推动对安全事件的响应。'
- en: 'For example, suppose your home alarm went off, indicating a window had been
    broken. Your response would vary drastically based on your level of attribution
    knowledge: a firefighter entering your home to extinguish a blaze would evoke
    a different response than a robber breaking in to steal your belongings, or an
    errant golf ball crashing through the window. Of course, attribution isn’t always
    simple to attain. A thief can exercise some control over observable evidence by
    wearing gloves and a mask. They could even wear a firefighter outfit to disguise
    their identity and deceive homeowners into acquiescing to their entry. A thief
    could plant, destroy, or avoid creating evidence of the crime during or after
    the act, impeding the subsequent work of forensic investigators. A truly sophisticated
    criminal might even frame another criminal using spoofed fingerprint pads; stolen
    hair, blood, or clothing samples; a realistic 3D-printed mask; or a weapon acquired
    from the unsuspecting patsy. If the framed individual has no alibi, or the crime
    is committed against a target consistent with their motivations, then authorities
    would have every reason to suspect or arrest the patsy.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，假设您的家庭报警器响起，表明窗户被打破了。根据您的归因知识水平，您的反应会有很大的不同：消防员进入您家扑灭火焰的反应与抢劫犯闯入盗窃财物的反应，或是一个误打的高尔夫球撞破窗户的反应截然不同。当然，归因并不总是容易得到。小偷可以通过戴手套和面具来控制可观察的证据。他们甚至可以穿消防员服装来掩饰身份，并欺骗房主同意让他们进入。小偷可以在犯罪过程中或之后制造、销毁或避免留下证据，从而妨碍后续的法医调查工作。一个真正复杂的罪犯甚至可能通过伪造的指纹垫、被盗的头发、血液或衣物样本、逼真的3D打印面具，或从毫无戒心的冤枉人那里获得的武器来嫁祸给另一个罪犯。如果被冤枉的人没有不在场证明，或者犯罪的目标与他们的动机一致，那么当局就有充分的理由怀疑或逮捕这个冤枉的人。
- en: Cybersecurity professionals face these types of attribution problems and then
    some. Attribution is particularly difficult due to the inherent anonymity of the
    cyber environment. Even after executing the difficult task of tracking an attack
    or event to a source computer and physical address, cybersecurity professionals
    can find it exceedingly hard to verify the identity of the human attacker. Attempts
    to trace the threat actor’s origin on the compromised machine often lead to tunnels,
    VPNs, encryption, and rented infrastructure with no meaningful logs or evidence.
    Sophisticated threat actors may even compromise and remotely connect to foreign
    machines, using them as platforms to launch attacks against other systems. Even
    after detecting the adversary, it may be advisable in certain cases to not immediately
    block them or remove their access; instead, it may be beneficial to monitor them
    for a while to determine their goals and identifying characteristics.^([6](b01.xhtml#endnote-101))
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 网络安全专家面临这些类型的归因问题，甚至更多。归因尤其困难，因为网络环境本身具有匿名性。即使在完成追踪攻击或事件来源计算机和物理地址的困难任务之后，网络安全专家仍然可能发现很难验证攻击者的身份。在受损计算机上追踪威胁行为者的来源往往会导致隧道、VPN、加密和租用的基础设施，且没有有意义的日志或证据。复杂的威胁行为者甚至可能通过远程连接外国计算机，将其作为平台攻击其他系统。即使在发现敌人之后，在某些情况下也可能建议不要立即阻止他们或移除他们的访问权限；相反，可能更有利的是暂时监控他们，了解他们的目标和识别特征。^([6](b01.xhtml#endnote-101))
- en: In some cases, threat groups deliberately leave behind tools or other observables
    to push an attribution narrative. The United States, Russia, and North Korea have
    reportedly altered or copied code segments, strings, infrastructure, and artifacts
    in their cybertools to cause misattribution.^([7](b01.xhtml#endnote-102)) When
    cybersecurity professionals discover and reverse engineer particularly stealthy
    malware, they occasionally observe unique, superfluous strings in the malware
    traces. Perhaps these strings were overlooked—a tradecraft error by the operator
    or developer. But they could also be “the art of fireflies”—evidence designed
    to be discovered and used for (mis)attribution.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些情况下，威胁组织故意留下工具或其他可观察的迹象，以推动归因叙事。报道称，美国、俄罗斯和朝鲜已经修改或复制了他们的网络工具中的代码片段、字符串、基础设施和工件，以导致错误归因。^([7](b01.xhtml#endnote-102))
    当网络安全专家发现并逆向工程特别隐蔽的恶意软件时，他们有时会在恶意软件痕迹中观察到独特且多余的字符串。也许这些字符串被忽视了——这可能是操作员或开发者的技术失误。但它们也可能是“萤火虫的艺术”——故意设计为被发现并用于（错误）归因的证据。
- en: Note that the same mechanisms that make deception possible also provide powerful
    means of identification. Memory dumps, disk images, registries, caches, network
    captures, logs, net flows, file analyses, strings, metadata, and more help identify
    cyber threat actors. Various intelligence disciplines, such as signal intelligence
    (SIGINT), cyber intelligence (CYBINT), and open source intelligence (OSINT), also
    contribute to attribution, while human intelligence (HUMINT) capabilities collect
    data from specific sources that, once processed and analyzed, helps indicate who
    may have conducted cyberattacks. These capabilities are typically kept secret,
    as disclosing their existence would inform targets how to avoid, deny, or deceive
    these systems, stunting the ability to generate useful intelligence and threat
    attribution.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，使欺骗成为可能的机制也提供了强大的识别手段。内存转储、磁盘镜像、注册表、缓存、网络捕获、日志、网络流量、文件分析、字符串、元数据等有助于识别网络威胁行为者。各种情报学科，如信号情报（SIGINT）、网络情报（CYBINT）和开放源情报（OSINT），也为归因提供了帮助，而人力情报（HUMINT）能力则从特定来源收集数据，经过处理和分析后有助于指示谁可能进行了网络攻击。这些能力通常是保密的，因为披露它们的存在会告诉目标如何避开、否认或欺骗这些系统，从而阻碍产生有用情报和威胁归因的能力。
- en: Approaches to Handling Attribution
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 归因处理方法
- en: 'It is reasonable for organizations to want to know the identity and origin
    of threat actors who compromise their systems and networks. It’s understandable
    that many want to take action, such as hacking back, to discover who these threat
    actors are. However, threat actors, like the shinobi, will always find ways to
    conduct covert malicious actions through denial and deception, making attribution
    uncertain. Furthermore, to take a lesson from history, the need to conduct shinobi
    attribution only ceased once Japan was unified under peaceful rule and shinobi
    were no more. The world is unlikely to experience unity in the foreseeable future,
    so nation-state cyberattacks are likely to continue. Until world peace happens,
    the following approaches to attribution can help you identify what, if anything,
    you can do about ongoing cyber conflict:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 组织希望了解破坏其系统和网络的威胁行为者的身份和来源是合理的。许多人希望采取行动，比如反击黑客，以发现这些威胁行为者的身份，这是可以理解的。然而，威胁行为者就像忍者一样，总能通过否认和欺骗的方式进行隐秘的恶意行动，从而使归因变得不确定。此外，从历史中汲取教训，只有在日本统一并进入和平统治后，才停止了对忍者的归因。全球在可预见的未来不太可能实现统一，因此国家级网络攻击很可能会继续发生。直到世界和平到来，以下归因方法可以帮助你识别是否能对持续的网络冲突采取措施：
- en: '*Shed your cognitive biases.* Reflect on your own cognitive biases and flawed
    logic. Everybody has holes in their thinking, but we can be mindful of them and
    work to correct them. Construct your own case studies. Review prior judgments
    that turned out to be incorrect, identify the mistakes made, and consider how
    to improve your analytical ability. This important work can be done in small steps
    (logic puzzles, crosswords, and brainteasers are a great way to improve cognitive
    function) or big strides. You can study articles and books on psychology that
    discuss known cognitive biases and logical fallacies and learn structured analytical
    techniques to overcome your own.^([8](b01.xhtml#endnote-103))'
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*摆脱你的认知偏差。* 反思自己的认知偏差和错误的逻辑。每个人的思维中都有漏洞，但我们可以意识到这些问题并努力改正。构建你自己的案例研究。回顾过去的错误判断，找出其中的错误，并思考如何提升自己的分析能力。这项重要工作可以通过小步骤完成（逻辑难题、填字游戏和脑筋急转弯是提升认知功能的好方法），也可以通过大步伐实现。你可以研究讨论已知认知偏差和逻辑谬误的心理学文章和书籍，学习克服自己偏差的结构化分析技巧。^([8](b01.xhtml#endnote-103))'
- en: '*Build attribution capabilities.* Examine what data sources, systems, knowledge,
    and controls you can use to influence attribution at your organization. Are you
    running open, unprotected Wi-Fi that allows unregistered, unauthenticated, and
    unidentified threat actors to anonymously connect to your network and launch attacks?
    Are you managing routers that allow spoofed IPs, or do they use reverse-path forwarding
    (RFP) protection technologies to prevent anonymized attacks from within your network?
    Are you correctly publishing a sender policy framework to prevent threat actors
    from spoofing email addresses and assuming your organization’s identity?'
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*建立归因能力。* 检查你可以使用哪些数据源、系统、知识和控制措施来影响你所在组织的归因。你是否运行开放且未保护的 Wi-Fi，使得未注册、未认证和未识别的威胁行为者可以匿名连接到你的网络并发起攻击？你是否管理允许伪造
    IP 地址的路由器，或者它们是否使用反向路径转发（RFP）保护技术来防止网络内的匿名攻击？你是否正确发布了发件人策略框架，以防止威胁行为者伪造电子邮件地址并冒充你组织的身份？'
- en: While many of these configuration changes incur no direct costs, the time and
    labor (and opportunity costs) to implement such wide-reaching changes can give
    management pause. However, consider whether a prior decision to invest in good
    cameras and lighting helps a storekeeper correctly identify a vandal. Establishing
    sound logging, documentation, and evidence collection practices improves attribution
    capabilities, enforces greater technological accountability, and provides end
    users with better visibility into network threats.
  id: totrans-20
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 尽管这些配置更改中的许多不会产生直接费用，但实施如此广泛的更改所需的时间和劳动（以及机会成本）可能会让管理层犹豫。然而，考虑一下之前是否决定投资于良好的摄像头和照明，帮助店主正确识别破坏者。建立健全的日志记录、文档和证据收集实践可以提高归因能力，增强技术问责制，并为最终用户提供更好的网络威胁可视性。
- en: '*. . . Or forget about attribution.* Work with your organization’s stakeholders
    to determine the scope of attribution efforts necessary to mitigate risk. For
    organizations with the ability to arrest threat actors or launch counteroffensive
    attacks, attribution is a necessity. However, most organizations cannot or should
    not attempt to catch or attack threat actors, learn their identities, or map their
    capabilities. In reality, attribution to a specific threat actor is not always
    necessary. Awareness of the threat can be enough to analyze and defend against
    it.'
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*. . . 或者忘记归因。* 与你组织的利益相关者合作，确定为降低风险所需的归因努力范围。对于那些能够逮捕威胁行为者或发起反攻的组织来说，归因是必须的。然而，大多数组织无法或不应试图抓捕或攻击威胁行为者，了解他们的身份或映射他们的能力。实际上，对特定威胁行为者的归因并不总是必要的。意识到威胁就足以分析和防御它。'
- en: For example, suppose two threat actors target your organization’s intellectual
    property. One wants to sell the information on the black market to make money,
    and the other wants the information to help build weapons systems for their country.
    It actually doesn’t matter. Regardless of the threat actors’ purpose and an organization’s
    capability to track them down, defenders must ultimately restrict or deny opportunities
    to exploit their security flaws. The organization does not necessarily need to
    assess a threat actor’s motivation to avoid the threat.
  id: totrans-22
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 例如，假设有两个威胁行为者针对你组织的知识产权。一个想将信息卖到黑市上赚钱，另一个想利用这些信息为他们的国家建设武器系统。实际上，这并不重要。无论威胁行为者的目的是什么，以及组织是否有能力追踪他们，防御者最终都必须限制或拒绝利用安全漏洞的机会。组织不必评估威胁行为者的动机就能避免威胁。
- en: Recommended Security Controls and Mitigations
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 推荐的安全控制和缓解措施
- en: Where relevant, recommendations are presented with applicable security controls
    from the NIST 800-53 standard. Each should be evaluated with the concept of attribution
    in mind.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 在相关的情况下，建议会结合 NIST 800-53 标准中的适用安全控制措施进行呈现。每个建议都应在考虑归因的概念下进行评估。
- en: 'Map accounts to user identities. Verify the identity of the individual associated
    with the user account via biometrics, identification, logical or physical evidence,
    or access controls. [SA-12: Supply Chain Protection | (14) Identity and Traceability]'
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '将账户映射到用户身份。通过生物识别、身份证明、逻辑或物理证据或访问控制验证与用户账户相关联的个人身份。[SA-12: 供应链保护 | (14) 身份与可追溯性]'
- en: 'Develop a plan that defines how your organization handles attribution assessments
    of threat agents. [IR-8: Incident Response]'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '制定一个计划，定义你组织如何处理威胁行为者的归因评估。[IR-8: 事件响应]'
- en: 'Establish threat awareness programs that collect and share information on the
    characteristics of threat actors, how to identify them in your environment, evidence
    of attribution, and other observables. Use specific collection capabilities such
    as honeypots for attribution purposes. [PM-16: Threat Awareness Program; SC-26:
    HoneyPots]'
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '建立威胁意识项目，收集并共享关于威胁行为特征的信息，以及如何在您的环境中识别它们，归因证据和其他可观察因素。 使用特定的收集能力，如诱饵罐，用于归因目的。
    [PM-16: 威胁意识项目; SC-26: 诱饵罐]'
- en: 'Apply security and collection controls. Perform threat modeling to identify
    threat agents. [SA-8: Security and Privacy Engineering Principles]'
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '应用安全和收集控制。执行威胁建模以识别威胁代理人。 [SA-8: 安全与隐私工程原则]'
- en: Debrief
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 详细报告
- en: In this chapter, we reviewed the art of the fireflies—a misattribution technique
    used by the shinobi. Cyber threat groups are continually evolving in sophistication,
    and they are likely to incorporate this technique into their operations security
    procedures, if they haven’t already. We noted that several threat groups are believed
    to be using misattribution techniques already and discussed approaches to handling
    attribution, and how the future for attribution is bleak.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们回顾了萤火虫之术——一种由忍者使用的误归因技术。网络威胁组织在复杂度上不断发展，并且很可能将这种技术纳入其操作安全程序中，如果他们还没有这样做的话。我们注意到，已有几个威胁组织被认为正在使用误归因技术，并讨论了处理归因的方法，以及未来归因的前景不容乐观。
- en: In the next chapter, we will discuss shinobi tactics for maintaining plausible
    deniability when defenders interrogated them. The chapter will also discuss advanced
    shinobi interrogation techniques and tools used when capturing enemy shinobi.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将讨论忍者在被审问时如何保持合理否认的战术。 该章节还将讨论捕获敌人忍者时使用的高级忍者审问技术和工具。
