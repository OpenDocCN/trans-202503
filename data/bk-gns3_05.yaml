- en: Chapter 5. Integrating Hosts and Using Wireshark
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第五章：集成主机和使用 Wireshark
- en: Up to this point, you’ve learned how to create networks using Cisco devices,
    but GNS3 can do so much more! It uses a robust set of network tools that allow
    you to integrate external applications into your GNS3 projects. In this chapter,
    you’ll explore some of these tools by learning how to integrate PC hosts into
    projects using Virtual PC Simulator and VirtualBox. The chapter will also cover
    basic packet sniffing using Wireshark.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，你已经学习了如何使用思科设备创建网络，但 GNS3 还能做更多！它提供了一套强大的网络工具，允许你将外部应用程序集成到 GNS3 项目中。在本章中，你将通过学习如何使用虚拟
    PC 模拟器和 VirtualBox 将 PC 主机集成到项目中，来探索这些工具。章节还将介绍如何使用 Wireshark 进行基本的包嗅探。
- en: Virtual PC Simulator
  id: totrans-2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 虚拟 PC 模拟器
- en: One way to add hosts to your projects is with VPCS, a small application that
    simulates up to nine DOS-like PCs. VPCS hosts have a limited set of commands but
    are well suited for testing end-to-end connectivity across your GNS3 networks.
    VPCS uses very few PC resources, which allows you to add numerous hosts to projects
    without bogging down your PC.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 向项目中添加主机的一种方式是使用 VPCS，这是一款小型应用程序，最多可模拟九台类似 DOS 的计算机。VPCS 主机命令集有限，但非常适合用于测试 GNS3
    网络中的端到端连接性。VPCS 占用的 PC 资源非常少，这使得你可以在项目中添加大量主机而不会拖慢计算机速度。
- en: Installing VPCS
  id: totrans-4
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装 VPCS
- en: 'If you’re running Windows or OS X, VPCS should have been included when you
    installed GNS3\. If you’re using a Linux system, VPCS source code should have
    been included in your GNS3 for Linux download, but it will need to be compiled
    before you can use it. Compile and install it using the following commands, replacing
    *`x`* with the version number of your VPCS source file:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用的是 Windows 或 OS X 系统，VPCS 应该已经包含在安装 GNS3 时。如果你使用的是 Linux 系统，VPCS 的源代码应该包含在你的
    GNS3 for Linux 下载包中，但需要先编译才能使用。使用以下命令进行编译和安装，*`x`* 替换为你 VPCS 源文件的版本号：
- en: '[PRE0]'
  id: totrans-6
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: To use VPCS, drag a VPCS host node from End Devices on the Devices toolbar to
    your workspace. Before you can start a VPCS host, it must be connected to another
    device in your project. After starting a VPCS host and opening a console, you’ll
    be presented with a window similar to [Figure 5-1](ch05.html#vpcs_console "Figure 5-1. The
    VPCS console").
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用 VPCS，首先从设备工具栏中的“终端设备”拖动一个 VPCS 主机节点到工作空间中。在启动 VPCS 主机之前，它必须先连接到你项目中的其他设备。启动
    VPCS 主机并打开控制台后，你将看到一个类似于 [图 5-1](ch05.html#vpcs_console "图 5-1. VPCS 控制台") 的窗口。
- en: '![The VPCS console](httpatomoreillycomsourcenostarchimages2208945.png.jpg)'
  id: totrans-8
  prefs: []
  type: TYPE_IMG
  zh: '![VPCS 控制台](httpatomoreillycomsourcenostarchimages2208945.png.jpg)'
- en: Figure 5-1. The VPCS console
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5-1. VPCS 控制台
- en: If you don’t see the VPCS console or if your application displays errors, verify
    that the program resides in */usr/local/bin/* (on Linux) and that the path has
    been set correctly in the GNS3 preferences. The developer provides very little
    in the way of support or documentation, so if you continue to have problems, you
    may want to visit the GNS3 forums (*[http://community.gns3.com/](http://community.gns3.com/)*)
    for a possible solution.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你没有看到 VPCS 控制台，或者应用程序显示错误，请检查程序是否位于 Linux 系统中的 */usr/local/bin/* 目录下，并确保在
    GNS3 的偏好设置中正确设置了路径。开发者提供的支持和文档非常有限，如果问题持续存在，你可能需要访问 GNS3 论坛 (*[http://community.gns3.com/](http://community.gns3.com/)*)
    寻找可能的解决方案。
- en: VPCS Commands
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: VPCS 命令
- en: The commands in VPCS are mostly self-explanatory, but I’ll cover a couple of
    them here to get you started. To see a full list of supported commands, you can
    enter a question mark, `?`. To display the configuration of your hosts, you can
    enter the `show` command. To display the parameters for a specific command, enter
    the command name followed by a question mark. For example, entering `ping ?` would
    display all the options of the `ping` command.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: VPCS 中的命令大多数是自解释的，但这里我会介绍其中几个命令，帮助你入门。要查看支持的命令列表，可以输入问号 `?`。要显示主机的配置，可以输入 `show`
    命令。要显示特定命令的参数，可以输入命令名称后跟一个问号。例如，输入 `ping ?` 将显示 `ping` 命令的所有选项。
- en: Note
  id: totrans-13
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*Like Cisco IOS, VPCS supports abbreviated command syntax. For example, the
    `ping` command can be entered as `p`. You can abbreviate any VPCS command, but
    you must enter enough letters of the command so that it’s unique from other commands
    that begin with the same letters.*'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '*像思科 IOS 一样，VPCS 支持命令的简写语法。例如，`ping` 命令可以简写为 `p`。你可以简写任何 VPCS 命令，但必须输入足够的字母，使得命令能够与其他以相同字母开头的命令区分开来。*'
- en: VPCS IP Addressing
  id: totrans-15
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: VPCS IP 地址配置
- en: After launching VPCS, you need to configure the host for use with GNS3\. Typically,
    this only requires setting the IP address, subnet mask, and gateway address.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 启动 VPCS 后，您需要配置主机以便与 GNS3 一起使用。通常，这只需要设置 IP 地址、子网掩码和网关地址。
- en: 'VPCS supports IPv4 and IPv6 addressing. You can manually configure an IP address
    or acquire one automatically if a Dynamic Host Configuration Protocol (DHCP) server
    is running in your GNS3 project. To manually configure an IPv4 address, you would
    enter *`ip-address mask gateway`*. The following example sets an IPv4 address
    to 192.168.1.50 using a subnet mask of 255.255.255.0 and sets the default gateway
    to 192.168.1.1:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: VPCS 支持 IPv4 和 IPv6 地址。您可以手动配置 IP 地址，或者如果 GNS3 项目中运行了动态主机配置协议（DHCP）服务器，您也可以自动获取
    IP 地址。要手动配置 IPv4 地址，您需要输入 *`ip-address mask gateway`*。以下示例将 IPv4 地址设置为 192.168.1.50，子网掩码设置为
    255.255.255.0，默认网关设置为 192.168.1.1：
- en: '[PRE1]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'You can enter the same IPv4 address using Classless Inter-Domain Routing (CIDR)
    notation in place of a standard subnet mask, as shown here:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用无类域间路由（CIDR）表示法输入相同的 IPv4 地址，代替标准的子网掩码，如下所示：
- en: '[PRE2]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'To manually configure an IPv6 address, enter the `ip` command followed by a
    valid IPv6 address and mask. The following example sets the IPv6 address to 2014:12:1a::50
    using a 64-bit subnet mask:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 要手动配置 IPv6 地址，请输入`ip`命令后跟有效的 IPv6 地址和掩码。以下示例将 IPv6 地址设置为 2014:12:1a::50，并使用
    64 位子网掩码：
- en: '[PRE3]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'To configure a host automatically using DHCP, enter the `dhcp` command for
    each host that requires an address, as in this example:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用 DHCP 自动配置主机，请为每个需要地址的主机输入`dhcp`命令，如下所示：
- en: '[PRE4]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Use the `save` command to save your VPCS settings with your GNS3 project.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`save`命令保存您的 VPCS 设置与 GNS3 项目一起使用。
- en: '[PRE5]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The settings will be saved in the GNS3 projects folder under *GNS3/projects/<project_name>/project-files/vpcs/<vpcs_uuid>*.
    Later, when you load your GNS3 project, the configuration settings will automatically
    be applied to the host.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 设置将保存在 GNS3 项目文件夹中的*GNS3/projects/<project_name>/project-files/vpcs/<vpcs_uuid>*路径下。稍后，当您加载
    GNS3 项目时，配置设置将自动应用到主机上。
- en: 'To test VPCS, create a project using a VPCS host node and link it to some other
    device, like a router. Assign an IP address to your VPCS host and the other device,
    and then use `ping` or `trace` to test connectivity. If all goes well, you should
    receive a reply like the one in this example:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 要测试 VPCS，请创建一个包含 VPCS 主机节点的项目，并将其连接到其他设备，如路由器。为您的 VPCS 主机和其他设备分配 IP 地址，然后使用`ping`或`trace`测试连通性。如果一切正常，您应该会收到类似以下的回复：
- en: '[PRE6]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'After successfully pinging devices, you can examine the ARP cache (MAC address
    to IP table) using the `arp` command, as in the following:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 成功 ping 通设备后，您可以使用`arp`命令检查 ARP 缓存（MAC 地址到 IP 表），如以下所示：
- en: '[PRE7]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'If a ping is unsuccessful, VPCS displays a “host not reachable” message:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 ping 不成功，VPCS 会显示“主机不可达”消息：
- en: '[PRE8]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: You can troubleshoot this by verifying that your router interfaces are up in
    GNS3 and checking that all the IP addresses and subnet masks have been correctly
    assigned.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过验证 GNS3 中的路由器接口是否正常工作，并检查所有的 IP 地址和子网掩码是否已正确分配，来排除故障。
- en: Another cause may be your PC’s firewall settings, especially if you’re using
    a Windows PC. In general, disabling your firewall entirely while working with
    GNS3 is a good idea and might resolve this and other issues.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个原因可能是您计算机的防火墙设置，特别是如果您使用的是 Windows 计算机。通常，在使用 GNS3 时完全禁用防火墙是一个好主意，并可能解决此问题以及其他问题。
- en: VirtualBox
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: VirtualBox
- en: VPCS is a great tool for adding simple hosts to GNS3 and testing connectivity,
    but sometimes you need a host that’s running a real operating system rather than
    a simulated one. This is where VirtualBox comes in. VirtualBox can run most PC-based
    operating systems, including Windows, Linux, FreeBSD, and others. It’s also useful
    for running network operating systems such as Arista vEOS, Juniper Firefly, and
    NX-OSv.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: VPCS 是一个非常适合在 GNS3 中添加简单主机并测试连通性的工具，但有时您需要一个运行真实操作系统的主机，而不是模拟操作系统。这时，VirtualBox
    就派上用场了。VirtualBox 可以运行大多数基于 PC 的操作系统，包括 Windows、Linux、FreeBSD 等。它还适用于运行网络操作系统，如
    Arista vEOS、Juniper Firefly 和 NX-OSv。
- en: The upside to using VirtualBox is that it provides you with hosts running actual
    operating systems; the downside is that those operating systems may need substantial
    resources from your PC. If all you need to do is test connectivity, then stick
    with VPCS, but if you need a host that provides a robust set of network utilities
    (to test the security of your GNS3 network, for example) or to run some other
    router or switch OS, then you might want to use VirtualBox.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 使用VirtualBox的好处是它为您提供了运行实际操作系统的主机；但缺点是，这些操作系统可能需要您PC的大量资源。如果您只需要测试连通性，那么继续使用VPCS就可以，但如果您需要一个提供强大网络实用工具的主机（例如，测试GNS3网络的安全性），或者运行其他路由器或交换机操作系统，那么您可能需要使用VirtualBox。
- en: Installing on Windows
  id: totrans-39
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在Windows上安装
- en: To install VirtualBox on Windows, download the appropriate installer from the
    VirtualBox website (*[http://www.virtualbox.org/](http://www.virtualbox.org/)*).
    Launch the installer and click **Next** when you see the Welcome screen to bring
    up a customization window. Make any desired customizations here and follow the
    onscreen instructions to complete the installation. I recommend accepting the
    default values to ensure that VirtualBox runs correctly with GNS3.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 要在Windows上安装VirtualBox，请从VirtualBox网站下载适当的安装程序（* [http://www.virtualbox.org/](http://www.virtualbox.org/)*）。启动安装程序并在看到欢迎屏幕后点击**下一步**，以打开自定义窗口。在此处进行任何所需的自定义设置，并按照屏幕上的说明完成安装。我建议接受默认值，以确保VirtualBox与GNS3正确运行。
- en: After the installation completes, you can launch the application by using the
    Windows Start menu or by clicking the VirtualBox icon.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完成后，您可以通过使用Windows开始菜单或点击VirtualBox图标来启动该应用程序。
- en: Installing on OS X
  id: totrans-42
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在OS X上安装
- en: To install VirtualBox on OS X, download the appropriate installer from the VirtualBox
    website (*[http://www.virtualbox.org/](http://www.virtualbox.org/)*) and launch
    it. When the VirtualBox installation screen appears, double-click the **VirtualBox.pkg**
    icon and follow the onscreen instructions. The installation requires elevated
    privileges, so have your administrator password handy. Once the package is installed,
    you can launch it from your *Applications* folder by double-clicking the VirtualBox
    icon.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 要在OS X上安装VirtualBox，请从VirtualBox网站下载适当的安装程序（* [http://www.virtualbox.org/](http://www.virtualbox.org/)*）并启动它。当VirtualBox安装屏幕出现时，双击**VirtualBox.pkg**图标并按照屏幕上的说明进行操作。安装需要提升权限，因此请准备好您的管理员密码。安装包安装完成后，您可以通过双击VirtualBox图标从*应用程序*文件夹中启动它。
- en: Installing on Linux
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在Linux上安装
- en: 'VirtualBox is supported on most Linux distributions, but check your Linux package
    manager to verify that it’s supported on your specific platform. On Ubuntu and
    most other Debian-based Linux systems, use the `apt-get` utility to update your
    package manager and install the latest version of VirtualBox. Be sure that you
    have Internet access and enter the following from a terminal window:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: VirtualBox支持大多数Linux发行版，但请检查您的Linux包管理器，以验证它是否在您的特定平台上受支持。在Ubuntu和大多数其他基于Debian的Linux系统上，使用`apt-get`工具更新包管理器并安装VirtualBox的最新版本。确保您可以访问互联网，然后在终端窗口中输入以下命令：
- en: '[PRE9]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Once the utility is installed, you can launch it either by opening a terminal
    window and entering `virtualbox` or by launching it from your Linux window manager.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦工具安装完成，您可以通过打开终端窗口并输入`virtualbox`来启动它，或者通过Linux窗口管理器启动它。
- en: Importing Appliances
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 导入设备
- en: A VirtualBox *appliance* is a preconfigured virtual machine, often running a
    custom Linux distribution, that you can use in your GNS3 projects. Using a real
    operating system gives you more commands and greater flexibility than using a
    simulator like VPCS. You can download preconfigured VirtualBox appliances from
    the GNS3 website under the Download section.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: VirtualBox的*设备*是一个预配置的虚拟机，通常运行定制的Linux发行版，您可以在GNS3项目中使用它。使用真实的操作系统比使用像VPCS这样的模拟器提供更多的命令和更大的灵活性。您可以从GNS3网站的下载部分下载预配置的VirtualBox设备。
- en: Appliances need to be imported into VirtualBox before you can use them. Appliance
    package names end in *.ova*, which stands for *Open Virtual Appliance*, and are
    often referred to as [*OVA*](apd.html#gloss01_047) files. To import an appliance,
    launch VirtualBox, and you’ll be presented with the VirtualBox Manager window.
    From the VirtualBox Manager, you can import or create new virtual machine guests
    and manage all of your installed guest operating systems. Importing an appliance
    is a fast and easy way to add a guest because the configuration and installation
    of the operating system has already been done for you.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用之前，必须先将虚拟设备导入到 VirtualBox 中。虚拟设备包的文件名以 *.ova* 结尾，表示 *Open Virtual Appliance*，通常被称为
    [*OVA*](apd.html#gloss01_047) 文件。要导入虚拟设备，启动 VirtualBox，你将看到 VirtualBox 管理器窗口。在
    VirtualBox 管理器中，你可以导入或创建新的虚拟机客户操作系统，并管理所有已安装的客户操作系统。导入虚拟设备是添加客户操作系统的快速且简便的方法，因为操作系统的配置和安装工作已经为你完成。
- en: The appliances found on the GNS3 website are often optimized to use fewer PC
    resources than a standard installation of the same operating system. Unfortunately,
    this means your appliance might not have all the commands or tools you need, but
    you should be able to update or install additional software through its software
    package manager.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 在 GNS3 网站上找到的虚拟设备通常经过优化，能够比标准安装的同一操作系统使用更少的计算机资源。不幸的是，这意味着你的虚拟设备可能没有你所需的所有命令或工具，但你应该能够通过其软件包管理器来更新或安装额外的软件。
- en: In [Figure 5-2](ch05.html#virtualbox_manager_showing_an_imported_l "Figure 5-2. VirtualBox
    Manager showing an imported Linux guest OS"), you can see that VirtualBox has
    been configured with one guest (Linux Microcore).
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 在[图 5-2](ch05.html#virtualbox_manager_showing_an_imported_l "图 5-2. VirtualBox
    管理器显示导入的 Linux 客户操作系统")中，你可以看到 VirtualBox 已经配置了一个客户操作系统（Linux Microcore）。
- en: '![VirtualBox Manager showing an imported Linux guest OS](httpatomoreillycomsourcenostarchimages2208947.png.jpg)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![VirtualBox 管理器显示导入的 Linux 客户操作系统](httpatomoreillycomsourcenostarchimages2208947.png.jpg)'
- en: Figure 5-2. VirtualBox Manager showing an imported Linux guest OS
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5-2. VirtualBox 管理器显示导入的 Linux 客户操作系统
- en: Selecting the guest OS displays basic information about the guest’s configuration,
    such as the base memory and how much disk space has been assigned to the virtual
    machine. To modify the settings of a virtual machine, highlight the guest and
    click **Settings** in the toolbar. Just like real PCs, virtual PC guests often
    run better when given more resources, such as memory or additional CPU cores.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 选择客户操作系统时，会显示关于客户操作系统配置的基本信息，例如基础内存和分配给虚拟机的磁盘空间。要修改虚拟机的设置，选中客户操作系统并点击工具栏中的 **Settings**。就像真实的
    PC 一样，虚拟 PC 客户操作系统通常在分配更多资源（如内存或额外的 CPU 核心）后运行得更好。
- en: To import a VirtualBox guest appliance, download an image file and copy it to
    a folder in your user directory. Launch VirtualBox and select **File** ▸ **Import
    Appliance**; then click **Open Appliance** and browse to the location where you
    saved the file. Select the image file and click **Continue** followed by **Import**
    to complete the process. To test your VirtualBox guest, click **Start**, and your
    OS should boot up and run like a normal PC.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 要导入 VirtualBox 客户操作系统，下载一个镜像文件并将其复制到用户目录中的一个文件夹。启动 VirtualBox，选择 **File** ▸
    **Import Appliance**，然后点击 **Open Appliance** 并浏览到你保存文件的位置。选择镜像文件并点击 **Continue**，然后点击
    **Import** 完成导入过程。要测试你的 VirtualBox 客户操作系统，点击 **Start**，操作系统应当像正常的 PC 一样启动并运行。
- en: After testing your newly imported OS, you’re ready to configure the GNS3 VirtualBox
    preferences.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 测试完新导入的操作系统后，你就可以开始配置 GNS3 的 VirtualBox 偏好设置了。
- en: VirtualBox Preferences
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: VirtualBox 偏好设置
- en: To manage VirtualBox guests, GNS3 uses the VBoxManage application. This program
    is automatically installed when you install VirtualBox. Before adding a VirtualBox
    guest to GNS3, verify the path to VBoxManage. Launch GNS3, select **GNS3** ▸ **Preferences**
    on OS X or **Edit** ▸ **Preferences** on Windows and Linux, and then click **VirtualBox**
    to reach the window shown in [Figure 5-3](ch05.html#virtualbox_general_settings_tab
    "Figure 5-3. VirtualBox General Settings tab").
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 为了管理 VirtualBox 客户操作系统，GNS3 使用 VBoxManage 应用程序。这个程序在你安装 VirtualBox 时会自动安装。在将
    VirtualBox 客户操作系统添加到 GNS3 之前，请验证 VBoxManage 的路径。启动 GNS3，选择 **GNS3** ▸ **Preferences**（在
    OS X 上）或 **Edit** ▸ **Preferences**（在 Windows 和 Linux 上），然后点击 **VirtualBox**，以打开如[图
    5-3](ch05.html#virtualbox_general_settings_tab "图 5-3. VirtualBox 常规设置标签页")所示的窗口。
- en: '![VirtualBox General Settings tab](httpatomoreillycomsourcenostarchimages2208949.png.jpg)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![VirtualBox 常规设置标签页](httpatomoreillycomsourcenostarchimages2208949.png.jpg)'
- en: Figure 5-3. VirtualBox General Settings tab
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5-3. VirtualBox 常规设置标签页
- en: On Ubuntu Linux, the path on the General Settings tab should be set to */usr/bin/vboxmanage*.
    Adjust the path as necessary and then click **Apply** and **OK**. On Windows and
    OS X, the VBoxManage path shouldn’t need to be changed.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 在Ubuntu Linux中，常规设置选项卡中的路径应设置为*/usr/bin/vboxmanage*。根据需要调整路径，然后点击**应用**和**确定**。在Windows和OS
    X中，VBoxManage路径通常不需要更改。
- en: Unchecking **Use the local server** will allow you to choose a local or remote
    GNS3 server when creating a VirtualBox host. Leaving the box checked ensures that
    VirtualBox guest will always run locally on your PC.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 取消勾选**使用本地服务器**将允许你在创建VirtualBox主机时选择本地或远程GNS3服务器。保持勾选框选中，确保VirtualBox虚拟机始终在你的PC上本地运行。
- en: If you experience problems while starting a VirtualBox host or opening a console
    connection to a host, one or more of the default console port numbers may already
    be in use by another application running on your PC. To fix this, try closing
    the offending application or disabling your PC firewall. Another possible cause
    might be that the VirtualBox guest you’re using isn’t configured to accept console
    connections.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 如果在启动VirtualBox主机或打开主机的控制台连接时遇到问题，可能是一个或多个默认控制台端口号已被你PC上正在运行的另一个应用程序占用。要解决此问题，尝试关闭该应用程序或禁用PC防火墙。另一个可能的原因是你使用的VirtualBox虚拟机未配置为接受控制台连接。
- en: VirtualBox Virtual Machine Settings
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: VirtualBox虚拟机设置
- en: After configuring (or at least reviewing) the VirtualBox preferences in GNS3,
    you need to set up one or more VirtualBox hosts to use in your projects. Begin
    by selecting **VirtualBox VM** from the left pane. Click **New** and select your
    VirtualBox virtual machine from the VM list drop-down menu, as shown in [Figure 5-4](ch05.html#new_virtualbox_vm_screen
    "Figure 5-4. New VirtualBox VM screen").
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 配置（或至少审查）GNS3中的VirtualBox首选项后，你需要设置一个或多个VirtualBox主机以供项目使用。首先在左侧面板中选择**VirtualBox虚拟机**。点击**新建**，从虚拟机列表的下拉菜单中选择你的VirtualBox虚拟机，如[图5-4](ch05.html#new_virtualbox_vm_screen
    "图5-4. 新建VirtualBox虚拟机屏幕")所示。
- en: '![New VirtualBox VM screen](httpatomoreillycomsourcenostarchimages2208951.png.jpg)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![新建VirtualBox虚拟机屏幕](httpatomoreillycomsourcenostarchimages2208951.png.jpg)'
- en: Figure 5-4. New VirtualBox VM screen
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图5-4. 新建VirtualBox虚拟机屏幕
- en: Click **Finish** to complete the installation. You should see the currently
    assigned settings for the virtual machine, as shown in [Figure 5-5](ch05.html#virtualbox_vms_preferences
    "Figure 5-5. VirtualBox VMs preferences").
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 单击**完成**以完成安装。你应该可以看到虚拟机当前分配的设置，如[图5-5](ch05.html#virtualbox_vms_preferences
    "图5-5. VirtualBox虚拟机首选项")所示。
- en: '![VirtualBox VMs preferences](httpatomoreillycomsourcenostarchimages2208953.png.jpg)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![VirtualBox虚拟机首选项](httpatomoreillycomsourcenostarchimages2208953.png.jpg)'
- en: Figure 5-5. VirtualBox VMs preferences
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 图5-5. VirtualBox虚拟机首选项
- en: By default your virtual machine device can be found under End Devices in the
    Devices toolbar. By right-clicking the virtual machine icon in the Preferences
    window (Linux Microcore in this example), you can assign a different icon to the
    virtual machine and choose where it will reside in the Devices toolbar. This allows
    you to better organize all your GNS3 devices.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，你的虚拟机设备可以在设备工具栏的“终端设备”下找到。通过右键点击首选项窗口中的虚拟机图标（此示例为Linux Microcore），你可以为虚拟机分配不同的图标，并选择它将驻留在设备工具栏的位置。这样可以帮助你更好地组织所有的GNS3设备。
- en: To modify the settings of a virtual machine, select the virtual machine and
    click **Edit**. In most cases you’ll want to go to the General settings tab and
    select the **Enable remote console** and **Start VM in headless mode** boxes,
    as shown in [Figure 5-6](ch05.html#virtualbox_vm_configurationapostrophes_g "Figure 5-6. VirtualBox
    VM configuration’s General settings tab"). The first option allows you to access
    the console of a running virtual machine from GNS3’s assigned terminal application;
    the second option suppresses VirtualBox from opening a console window when you
    start a virtual machine in GNS3.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 要修改虚拟机的设置，选择虚拟机并点击**编辑**。在大多数情况下，你需要进入常规设置选项卡，勾选**启用远程控制台**和**以无头模式启动虚拟机**框，如[图5-6](ch05.html#virtualbox_vm_configurationapostrophes_g
    "图5-6. VirtualBox虚拟机配置的常规设置选项卡")所示。第一个选项允许你从GNS3分配的终端应用程序访问运行中的虚拟机控制台；第二个选项会在你在GNS3中启动虚拟机时，防止VirtualBox打开控制台窗口。
- en: '![VirtualBox VM configuration’s General settings tab](httpatomoreillycomsourcenostarchimages2208955.png.jpg)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![VirtualBox虚拟机配置的常规设置选项卡](httpatomoreillycomsourcenostarchimages2208955.png.jpg)'
- en: Figure 5-6. VirtualBox VM configuration’s General settings tab
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 图5-6. VirtualBox虚拟机配置的常规设置选项卡
- en: To modify network settings, click the **Network** tab. You can change the number
    of adapters installed in the virtual machine, the starting adapter number (usually
    0 or 1), and the type of adapter installed in the virtual machine. When you’re
    finished, click **Apply** and **OK** to save the modifications.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 要修改网络设置，请点击**网络**选项卡。你可以更改虚拟机中安装的适配器数量、起始适配器编号（通常是 0 或 1），以及安装在虚拟机中的适配器类型。完成后，点击**应用**和**确定**以保存修改。
- en: After you have configured a virtual machine guest operating system, you can
    use it in your GNS3 projects.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 配置完虚拟机客户操作系统后，你可以在 GNS3 项目中使用它。
- en: Using VirtualBox Hosts in a Project
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在项目中使用 VirtualBox 主机
- en: To add a VirtualBox host to a project, drag a VirtualBox host node icon from
    the End Devices window to your GNS3 workspace.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 要将 VirtualBox 主机添加到项目中，从“终端设备”窗口拖动 VirtualBox 主机节点图标到你的 GNS3 工作区。
- en: A VirtualBox host can be used only one time per GNS3 project. If you want to
    use a particular VirtualBox host more than once, launch VirtualBox and use the
    Clone feature to create a cloned copy of the virtual machine.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 每个 GNS3 项目中只能使用一次 VirtualBox 主机。如果你希望在一个项目中多次使用特定的 VirtualBox 主机，请启动 VirtualBox
    并使用克隆功能创建虚拟机的克隆副本。
- en: Then, launch GNS3 and follow the same steps outlined earlier to configure the
    cloned host under VirtualBox Preferences. The next time you add a VirtualBox host
    node to your workspace, the cloned OS will be available.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，启动 GNS3，按照之前概述的步骤在 VirtualBox 偏好设置中配置克隆的主机。下次你将 VirtualBox 主机节点添加到工作区时，克隆的操作系统将可用。
- en: After a VirtualBox host node has been added to your workspace, you’re ready
    to link it to other GNS3 devices.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 在将 VirtualBox 主机节点添加到工作区后，你可以将其链接到其他 GNS3 设备。
- en: Linking VirtualBox Host Nodes to Other Devices
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将 VirtualBox 主机节点链接到其他设备
- en: To add a link between a VirtualBox host node and another device, click the **Add
    a Link** toolbar icon; then click your VirtualBox host node and choose an interface
    to use for the link. Select another device and choose an interface to complete
    the connection.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 要在 VirtualBox 主机节点和其他设备之间添加链接，请点击**添加链接**工具栏图标；然后点击你的 VirtualBox 主机节点并选择要用于该链接的接口。选择另一个设备并选择一个接口以完成连接。
- en: To boot the host, right-click the VirtualBox host node icon and select **Start**.
    Test the connection by configuring an IP address on your VirtualBox host and the
    device to which it’s linked; then use the `ping` command to verify connectivity.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 要启动主机，右键点击 VirtualBox 主机节点图标并选择**启动**。通过在 VirtualBox 主机和它连接的设备上配置 IP 地址来测试连接；然后使用`ping`命令验证连通性。
- en: On most Linux systems, like Microcore, you can manually configure an IP address
    and default gateway using the `ifconfig` and `route` commands. To see a list of
    available network interface cards (NICs) in Linux, use the `ifconfig` command
    without any configuration options.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 在大多数 Linux 系统中，如 Microcore，你可以使用`ifconfig`和`route`命令手动配置 IP 地址和默认网关。要查看 Linux
    中可用的网络接口卡（NIC），请使用不带任何配置选项的`ifconfig`命令。
- en: '[PRE10]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Note
  id: totrans-88
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*Not all Linux systems use the `ifconfig` or `route` command to configure TCP/IP,
    but most do. If these commands aren’t available with your distribution, check
    your Linux documentation to see how to configure an interface.*'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '*并非所有 Linux 系统都使用`ifconfig`或`route`命令来配置 TCP/IP，但大多数系统使用。如果你的发行版中没有这些命令，请查看
    Linux 文档，了解如何配置接口。*'
- en: If you’re using a Windows PC virtual machine, you can manually configure an
    IP address by opening the Network and Sharing Center and clicking **Change Adapter
    Settings**. Right-click the adapter you want to configure and select **Properties**
    to modify the TCP/IP settings, as shown in [Figure 5-7](ch05.html#windows_tcpsolidusip_interface_propertie
    "Figure 5-7. Windows TCP/IP interface properties").
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用的是 Windows PC 虚拟机，你可以通过打开“网络和共享中心”并点击**更改适配器设置**来手动配置 IP 地址。右键点击你想配置的适配器，选择**属性**以修改
    TCP/IP 设置，如[图 5-7](ch05.html#windows_tcpsolidusip_interface_propertie "图 5-7.
    Windows TCP/IP 接口属性")所示。
- en: '![Windows TCP/IP interface properties](httpatomoreillycomsourcenostarchimages2208957.png.jpg)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![Windows TCP/IP 接口属性](httpatomoreillycomsourcenostarchimages2208957.png.jpg)'
- en: Figure 5-7. Windows TCP/IP interface properties
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5-7. Windows TCP/IP 接口属性
- en: Enter your IP address information and click **OK** when finished. If you have
    a DHCP server configured in your GNS3 project, you can leave the fields blank
    and choose **Obtain an IP address automatically** instead.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 输入你的 IP 地址信息并在完成后点击**确定**。如果你的 GNS3 项目中配置了 DHCP 服务器，你可以留空这些字段，并选择**自动获取 IP 地址**。
- en: Simple VirtualBox Project Using a Linux Virtual Machine
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 Linux 虚拟机的简单 VirtualBox 项目
- en: Now that you’ve added a Linux VirtualBox virtual machine to GNS3, let’s create
    a simple project that networks the host to a Cisco IOS router. Begin by creating
    the project in [Figure 5-8](ch05.html#virtualbox_host_and_cisco_ios_router_pro
    "Figure 5-8. VirtualBox host and Cisco IOS router project"). Drag a VirtualBox
    Linux host and Dynamips router to your workspace and link them together using
    an Ethernet switch node.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您已将一个 Linux VirtualBox 虚拟机添加到 GNS3 中，让我们创建一个简单的项目，将主机与 Cisco IOS 路由器连接。首先创建一个项目，如
    [图 5-8](ch05.html#virtualbox_host_and_cisco_ios_router_pro "图 5-8. VirtualBox
    主机和 Cisco IOS 路由器项目") 所示。将一个 VirtualBox Linux 主机和一个 Dynamips 路由器拖到工作区，并使用以太网交换机节点将它们连接起来。
- en: '![VirtualBox host and Cisco IOS router project](httpatomoreillycomsourcenostarchimages2208959.png.jpg)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![VirtualBox 主机和 Cisco IOS 路由器项目](httpatomoreillycomsourcenostarchimages2208959.png.jpg)'
- en: Figure 5-8. VirtualBox host and Cisco IOS router project
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5-8. VirtualBox 主机和 Cisco IOS 路由器项目
- en: 'Start the devices and begin configuring your project by assigning an IP address
    to interface eth0 of the VirtualBox Linux host. Right-click the Linux Microcore
    node and select **Console** to open the terminal. From the Linux terminal shell,
    enter the following command to assign the IP address:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 启动设备并开始配置您的项目，通过为 VirtualBox Linux 主机的接口 eth0 分配 IP 地址。右键点击 Linux Microcore
    节点并选择 **控制台** 打开终端。然后，在 Linux 终端中输入以下命令来分配 IP 地址：
- en: '[PRE11]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Next, open a console to router R1, assign an IP address to interface f0/0, and
    bring up the interface.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，打开 R1 路由器的控制台，为接口 f0/0 分配 IP 地址并启动接口。
- en: '[PRE12]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Finally, test connectivity by pinging your Linux host’s IP address from router
    R1.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，通过从 R1 路由器 ping 您 Linux 主机的 IP 地址来测试连通性。
- en: '[PRE13]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Now let’s take a look at how you can use Wireshark to analyze packets on your
    GNS3 networks.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们来看看如何使用 Wireshark 分析您在 GNS3 网络中的数据包。
- en: Wireshark
  id: totrans-105
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Wireshark
- en: Wireshark is one of the most robust packet analysis tools available to network
    engineers, and it’s free! A *packet analyzer*, sometimes called a *packet sniffer*,
    is software that allows you to capture IP packets as they traverse your network.
    You can then open the packets to reveal and analyze their contents. Packet sniffers
    like Wireshark are used to troubleshoot networking protocols, thwart hackers,
    and even identify viruses, but they are often overlooked by beginners. If you’re
    an aspiring networking engineer, using GNS3 and Wireshark together is an excellent
    way to learn the ins and outs of networking and how network protocols work.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: Wireshark 是网络工程师最强大的数据包分析工具之一，而且是免费的！*数据包分析器*，有时也叫做 *数据包嗅探器*，是一款可以捕获 IP 数据包的软件，当数据包在您的网络中传输时，它能够捕捉到。然后，您可以打开数据包并分析其内容。像
    Wireshark 这样的数据包嗅探器用于故障排除网络协议、阻止黑客攻击，甚至识别病毒，但初学者往往忽视它们。如果您是一个有抱负的网络工程师，将 GNS3
    和 Wireshark 一起使用，是学习网络工作原理和网络协议运作的绝佳方式。
- en: Installing on Windows
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在 Windows 上安装
- en: If you installed GNS3 using the Windows all-in-one installer, then Wireshark
    should already be installed. If you’re using OS X or Linux, then you need to download
    and install Wireshark manually.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您使用 Windows 一体化安装程序安装了 GNS3，则 Wireshark 应该已经安装。如果您使用的是 OS X 或 Linux，则需要手动下载并安装
    Wireshark。
- en: Installing on OS X
  id: totrans-109
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在 OS X 上安装
- en: Before installing Wireshark on OS X, you need to install XQuartz, an OS X version
    of the X Window System that’s similar to X.Org on Linux systems.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 在 OS X 上安装 Wireshark 之前，您需要安装 XQuartz，它是一个类似于 Linux 系统中 X.Org 的 OS X 版本 X Window
    系统。
- en: Download the appropriate version of XQuartz from the Mac OS Forge website (*[http://xquartz.macosforge.org/](http://xquartz.macosforge.org/)*).
    Double-click the installer and then click the *XQuartz.dmg* installer package.
    Click **Continue** until you reach the welcome screen, and then click **I Agree**
    and **Install** to complete the installation.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 从 Mac OS Forge 网站下载适合的 XQuartz 版本 (*[http://xquartz.macosforge.org/](http://xquartz.macosforge.org/)*)。双击安装程序，然后点击
    *XQuartz.dmg* 安装包。点击 **继续**，直到您到达欢迎界面，然后点击 **我同意** 和 **安装** 完成安装。
- en: Next, download and install Wireshark from the developer website (*[http://www.wireshark.org/](http://www.wireshark.org/)*).
    Double-click the downloaded file, followed by the *wireshark.dmg* installer package.
    At the welcome screen, click **Continue, I Agree**, and **Install** to complete
    the installation.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，从开发者网站下载并安装 Wireshark (*[http://www.wireshark.org/](http://www.wireshark.org/)*)。双击下载的文件，然后点击
    *wireshark.dmg* 安装包。在欢迎界面点击 **继续，我同意**，然后点击 **安装** 完成安装。
- en: The first time you launch Wireshark, OS X will ask for the location of the X
    Window program. From the File window, click **Browse**, navigate to the *Applications/Utilities*
    folder, and then select **XQuartz**.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 第一次启动Wireshark时，OS X会询问X Window程序的位置。在文件窗口中，点击**浏览**，进入*应用程序/实用工具*文件夹，然后选择**XQuartz**。
- en: Note
  id: totrans-114
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*The first time you launch Wireshark, XQuartz opens an Xterm window but not
    Wireshark. This strange quirk is easily corrected by closing XQuartz and relaunching
    Wireshark. It may take a moment to open, but this is normal. When the application
    starts, you should see the Wireshark welcome screen.*'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: '*第一次启动Wireshark时，XQuartz会打开一个Xterm窗口，但不会启动Wireshark。这个奇怪的现象可以通过关闭XQuartz并重新启动Wireshark来轻松解决。打开Wireshark可能需要一些时间，但这是正常现象。当应用程序启动时，您应该看到Wireshark的欢迎界面。*'
- en: Now that Wireshark is installed, let’s look at how to capture packets from devices
    in your projects.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 现在Wireshark已经安装，我们来看看如何从项目中的设备捕获数据包。
- en: Installing on Linux
  id: totrans-117
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在Linux上安装
- en: 'To install the latest version of Wireshark using the Advanced Package Tools
    on Ubuntu Linux, open a terminal program and enter the following commands:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用Ubuntu Linux上的高级包工具安装最新版本的Wireshark，打开终端程序并输入以下命令：
- en: '[PRE14]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Confirm the installation when prompted, and the package will be installed. After
    the process has completed, Wireshark should be ready to use.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 在提示时确认安装，包将会被安装。安装过程完成后，Wireshark应该可以使用了。
- en: Capturing Packets in GNS3
  id: totrans-121
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在GNS3中捕获数据包
- en: To begin capturing packets, right-click a link between two devices and select
    **Start Capture**, as shown in [Figure 5-9](ch05.html#start_capturing_packets
    "Figure 5-9. Start capturing packets."). (To stop a capture, right-click the same
    link and select **Stop Capture**.)
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始捕获数据包，请右键点击两个设备之间的链接并选择**开始捕获**，如[图5-9](ch05.html#start_capturing_packets
    "图5-9. 开始捕获数据包")所示。（要停止捕获，右键点击相同的链接并选择**停止捕获**。）
- en: '![Start capturing packets.](httpatomoreillycomsourcenostarchimages2208961.png.jpg)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![开始捕获数据包。](httpatomoreillycomsourcenostarchimages2208961.png.jpg)'
- en: Figure 5-9. Start capturing packets.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 图5-9。开始捕获数据包。
- en: 'GNS3 prompts you for the source device, the interface name, and the encapsulation
    type to use for capturing data. You can capture data on Ethernet and serial interfaces.
    On Ethernet connections, you can choose only Ethernet encapsulation: DLT_EN10MB,
    but on serial connections, you can choose Cisco HDLC encapsulation: DLT_C_HDLC,
    Cisco PPP encapsulation: DLT PPP_SERIAL, or Frame Relay encapsulation: DLT_FRELAY.'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: GNS3会提示您选择源设备、接口名称以及用于捕获数据的封装类型。您可以在以太网和串行接口上捕获数据。在以太网连接上，您只能选择以太网封装：DLT_EN10MB，但在串行连接上，您可以选择Cisco
    HDLC封装：DLT_C_HDLC、Cisco PPP封装：DLT_PPP_SERIAL或帧中继封装：DLT_FRELAY。
- en: To capture standard Cisco serial data (High-Level DataLink Control), choose
    **HDLC**; to capture serial Point-to-Point Protocol data, choose **PPP**; and
    to capture Frame-Relay data, select **FRELAY**. Use the drop-down menu to make
    your selection, as shown in [Figure 5-10](ch05.html#source_selection_for_capturing_serial_pa
    "Figure 5-10. Source selection for capturing serial packets").
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 要捕获标准的Cisco串行数据（高级数据链路控制），选择**HDLC**；要捕获串行点对点协议数据，选择**PPP**；要捕获帧中继数据，选择**FRELAY**。使用下拉菜单进行选择，如[图5-10](ch05.html#source_selection_for_capturing_serial_pa
    "图5-10. 选择串行数据包捕获源")所示。
- en: '![Source selection for capturing serial packets](httpatomoreillycomsourcenostarchimages2208963.png.jpg)'
  id: totrans-127
  prefs: []
  type: TYPE_IMG
  zh: '![选择数据源以捕获串行数据包](httpatomoreillycomsourcenostarchimages2208963.png.jpg)'
- en: Figure 5-10. Source selection for capturing serial packets
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 图5-10。选择串行数据包捕获源
- en: After making a selection and clicking **OK**, GNS3 will open Wireshark and begin
    capturing packets, as shown in [Figure 5-11](ch05.html#simple_wireshark_capture_from_gns3
    "Figure 5-11. Simple Wireshark capture from GNS3"). Notice that the Wireshark
    window is divided into three distinct panes.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 在做出选择并点击**确定**后，GNS3将打开Wireshark并开始捕获数据包，如[图5-11](ch05.html#simple_wireshark_capture_from_gns3
    "图5-11. GNS3中简单的Wireshark捕获")所示。请注意，Wireshark窗口被分为三个不同的面板。
- en: '****➊ Packet List pane**** The top pane of the window is dedicated to displaying
    individual packets as they’re being captured. Packet fields are displayed across
    the top and include the packet sequence number (No.), timestamp (Time), source
    IP address (Source), destination IP address (Destination), protocol name (Protocol),
    frame length size (Length), and information field (Info). Packets containing different
    protocol types are displayed in different colors to help identify them.'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '****➊ 数据包列表窗格**** 窗口的顶部窗格专门用于显示正在捕获的单个数据包。数据包字段显示在顶部，包括数据包序列号（No.）、时间戳（Time）、源IP地址（Source）、目标IP地址（Destination）、协议名称（Protocol）、帧长度（Length）和信息字段（Info）。包含不同协议类型的数据包以不同颜色显示，帮助识别它们。'
- en: '****➋ Packet Details pane**** After a packet is selected from the packet list,
    details about the protocols and protocol fields of the packet are displayed in
    the middle pane. You can expand and collapse the fields to show or hide their
    details. The displayed field names are specific to the type of packet being captured
    and will change from one packet type to another.'
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '****➋ 数据包详情窗格**** 在从数据包列表中选择一个数据包后，数据包的协议和协议字段的详细信息将显示在中间窗格中。你可以展开或折叠字段，以显示或隐藏它们的详细信息。显示的字段名称是特定于捕获的数据包类型的，会根据不同的数据包类型而变化。'
- en: '****➌ Packet Bytes pane**** The lower pane of the main window displays the
    raw data in hexadecimal format, with ASCII characters displayed to the right.
    This is what the data looks like natively as it crosses the network. Wireshark
    allows you to view this information in either hexadecimal or binary.'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '****➌ 数据包字节窗格**** 主窗口的下部窗格以十六进制格式显示原始数据，右侧显示ASCII字符。这是数据在网络上传输时的原始样子。Wireshark允许你以十六进制或二进制格式查看这些信息。'
- en: '![Simple Wireshark capture from GNS3](httpatomoreillycomsourcenostarchimages2208965.png.jpg)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![GNS3中的简单Wireshark捕获](httpatomoreillycomsourcenostarchimages2208965.png.jpg)'
- en: Figure 5-11. Simple Wireshark capture from GNS3
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5-11. 来自GNS3的简单Wireshark捕获
- en: If you don’t see any packets displayed in the packet list, close Wireshark and
    stop the capture. Be sure your router interfaces are up and have been assigned
    IP addresses and then restart a capture and start Wireshark again.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你在数据包列表中没有看到任何数据包，关闭Wireshark并停止捕获。确保你的路由器接口已启用并分配了IP地址，然后重新启动捕获并再次启动Wireshark。
- en: Note
  id: totrans-136
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*To learn more about using Wireshark, I highly recommend reading* Practical
    Packet Analysis, 2nd Edition *by Chris Sanders (No Starch Press, 2011). You could
    even become a Wireshark Certified Network Analyst (WCNA).*'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: '*要了解更多关于使用Wireshark的内容，我强烈推荐阅读* Practical Packet Analysis, 第二版 *，作者Chris Sanders（No
    Starch Press，2011）。你甚至可以成为Wireshark认证网络分析师（WCNA）。*'
- en: To change the default behavior of Wireshark in GNS3, go to **Preferences** and
    select **Packet Capture**. To prevent GNS3 from automatically starting Wireshark
    when you capture packets, uncheck **Automatically start the packet capture application**,
    as shown in [Figure 5-12](ch05.html#wireshark_capture_preferences "Figure 5-12. Wireshark
    capture preferences").
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 要更改Wireshark在GNS3中的默认行为，请进入**首选项**并选择**数据包捕获**。为了防止GNS3在捕获数据包时自动启动Wireshark，请取消选中**自动启动数据包捕获应用程序**，如[图5-12](ch05.html#wireshark_capture_preferences
    "图5-12. Wireshark捕获首选项")所示。
- en: You have the option to save packet captures and analyze them later. To do so,
    select **Wireshark Traditional Capture** from the drop-down menu (under Preconfigured
    packet capture reader commands) and then click **Set, Apply**, and **OK**. Now
    when GNS3 captures data, it will automatically save the captured files in a directory
    named *captures* within your project folder, as in *GNS3/projects/<project_name>/project-files/captures/*.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以选择保存数据包捕获并稍后分析。为此，选择下拉菜单中的**Wireshark传统捕获**（在预配置的数据包捕获读取命令下），然后点击**设置、应用**和**确定**。现在，当GNS3捕获数据时，它会自动将捕获的文件保存在项目文件夹中的一个名为*captures*的目录下，如*GNS3/projects/<project_name>/project-files/captures/*。
- en: To review saved packet captures, launch Wireshark on your PC, select **File**
    ▸ **Open**, browse to the *captures* folder, and select a capture file. The *.pcap*
    capture files will be named after the GNS3 devices involved in the capture, as
    in *R1_FastEthernet0-0_to_R2_FastEthernet0-0.pcap*.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看已保存的数据包捕获，请在PC上启动Wireshark，选择**文件** ▸ **打开**，浏览到*captures*文件夹，选择一个捕获文件。*.pcap*
    捕获文件会以参与捕获的GNS3设备命名，如*R1_FastEthernet0-0_to_R2_FastEthernet0-0.pcap*。
- en: '![Wireshark capture preferences](httpatomoreillycomsourcenostarchimages2208967.png.jpg)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![Wireshark捕获首选项](httpatomoreillycomsourcenostarchimages2208967.png.jpg)'
- en: Figure 5-12. Wireshark capture preferences
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5-12. Wireshark捕获首选项
- en: To learn more about Wireshark, check out the online User’s Guide (*[http://www.wireshark.org/docs/wsug_html_chunked/](http://www.wireshark.org/docs/wsug_html_chunked/)*).
    It’s well organized and provides a lot of information about using the software.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于Wireshark的信息，可以查看在线用户指南 (*[http://www.wireshark.org/docs/wsug_html_chunked/](http://www.wireshark.org/docs/wsug_html_chunked/)*)。它结构清晰，提供了大量关于使用该软件的信息。
- en: Final Thoughts
  id: totrans-144
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 最后的思考
- en: One key aspect of GNS3 is its modular design and ability to expand projects
    using other open source software. Using VPCS, you can add a large number of simple
    PC hosts, and with VirtualBox you can run hosts using full-blown operating systems
    such as Linux. This feature makes GNS3 very expandable because any network operating
    system that runs in VirtualBox can be added to your GNS3 projects.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: GNS3的一个关键特点是其模块化设计及使用其他开源软件扩展项目的能力。通过VPCS，你可以添加大量简单的PC主机，而使用VirtualBox，你可以运行像Linux这样的完整操作系统。这一特性使得GNS3具有很强的扩展性，因为任何在VirtualBox中运行的网络操作系统都可以被添加到你的GNS3项目中。
- en: Wireshark is one of the most underutilized tools around, but it’s also one of
    the most powerful. With Wireshark, you can dig deep and really see what’s happening
    on your networks. Whether you’re new to networking or already network certified,
    breaking out Wireshark and examining packets is a great way to hone your skills
    and increase your understanding of network protocols.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: Wireshark是最常被低估的工具之一，但它也是最强大的工具之一。通过Wireshark，你可以深入挖掘，真正看到你网络上发生的事情。无论你是网络新手还是已经获得网络认证，使用Wireshark并检查数据包是一个磨练技能、加深对网络协议理解的好方法。
- en: In [Chapter 6](ch06.html "Chapter 6. Juniper Olive and VSRX Firefly"), you’ll
    look at Quick Emulator, another open source PC emulator, and use it to create
    a special PC version of Juniper’s Junos OS known as Juniper Olive. Juniper Olive
    allows you to add fully functional Juniper routers to your GNS3 projects.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第6章](ch06.html "第6章. Juniper Olive和VSRX Firefly")中，你将学习到Quick Emulator，另一种开源PC模拟器，并用它创建一个特别的PC版本的Juniper
    Junos操作系统，名为Juniper Olive。Juniper Olive允许你将功能完整的Juniper路由器添加到你的GNS3项目中。
