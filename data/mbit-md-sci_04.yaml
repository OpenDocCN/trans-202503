- en: '![Image](../images/common1.jpg)'
  id: totrans-0
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/common1.jpg)'
- en: '**4**'
  id: totrans-1
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**4**'
- en: '**MAGICAL MAGNETISM**'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '**神奇的磁力**'
- en: As you saw in [Chapter 1](ch01.xhtml#ch01), the micro:bit has a built-in magnetometer
    that serves a variety of purposes. In this chapter, we’ll use it to turn your
    micro:bit into a compass that tells you which direction you’re facing. We’ll also
    measure the magnetic fields of neodymium magnets. Then, we’ll make a magnetic
    alarm that rings whenever someone opens the door.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你在[第1章](ch01.xhtml#ch01)中看到的，micro:bit有一个内建的磁力计，可以用于多种目的。在这一章中，我们将用它将你的micro:bit变成一个指南针，告诉你你面朝哪个方向。我们还将测量钕磁铁的磁场。接着，我们将制作一个磁力报警器，门一打开就响。
- en: '**PROJECT: COMPASS**'
  id: totrans-4
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**项目：指南针**'
- en: '![Image](../images/common3.jpg)'
  id: totrans-5
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/common3.jpg)'
- en: '*Difficulty: Easy*'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '*难度：简单*'
- en: In this project, shown in [Figure 4-1](ch04.xhtml#ch4fig1), you’ll use the micro:bit’s
    built-in magnetometer as a compass. It will display an arrow on the screen that
    points toward magnetic north.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个项目中，如[图 4-1](ch04.xhtml#ch4fig1)所示，你将使用micro:bit内建的磁力计作为指南针。它会在屏幕上显示一个箭头，指向磁北。
- en: '![Image](../images/04fig01.jpg)'
  id: totrans-8
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/04fig01.jpg)'
- en: '*Figure 4-1: Finding north with a micro:bit compass*'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 4-1：用micro:bit指南针寻找北方*'
- en: Unlike a conventional compass, this compass doesn’t always point north. Instead,
    it shows you which way to turn in order to be facing north.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 与传统的指南针不同，这款指南针并不总是指向北方。相反，它会显示你需要转向哪个方向才能面朝北方。
- en: Rotate until the arrow is facing straight ahead, and you’re looking north!
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 转动直到箭头正对前方，且你正面朝北！
- en: '**What You’ll Need**'
  id: totrans-12
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**所需材料**'
- en: 'For this experiment, you will need:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个实验，你将需要：
- en: '**Micro:bit**'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '**Micro:bit**'
- en: '**Battery pack**'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '**电池组**'
- en: You only need a micro:bit to make this compass, but if you plan to navigate
    outdoors, then you’ll need a battery pack as well.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 你只需要一个micro:bit就可以制作这个指南针，但如果你计划在户外导航，那么你还需要一个电池组。
- en: '![Image](../images/f0087-01.jpg)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/f0087-01.jpg)'
- en: '**Construction**'
  id: totrans-18
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**构建**'
- en: Go to *[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*
    to access the book’s code repository and click the link for **Compass**. Once
    the program has opened, click **Download** and then copy the hex file onto your
    micro:bit. If you get stuck on this section, head back to [Chapter 1](ch01.xhtml#ch01),
    where the process of getting programs onto your micro:bit is explained in full.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问*[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*来访问本书的代码库，并点击**Compass**链接。程序打开后，点击**下载**，然后将.hex文件复制到你的micro:bit上。如果你在这部分遇到问题，请返回[第1章](ch01.xhtml#ch01)，那里有完整的将程序加载到micro:bit的过程说明。
- en: If you prefer to use Python, then download the code from the same website, along
    with instructions for downloading and using the book’s examples. The Python file
    for this experiment is *ch_04_Compass.py*.
  id: totrans-20
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你更喜欢使用Python，那么可以从同一网站下载代码，并附带下载和使用本书示例的说明。此实验的Python文件是*ch_04_Compass.py*。
- en: Once you’ve loaded the program onto your micro:bit, you’ll see a message prompting
    you to move your micro:bit in a certain way. Follow the instructions. This will
    happen every time you flash a program onto the micro:bit that uses the magnetometer.
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦你将程序加载到micro:bit上，你将看到一个提示信息，指示你以某种方式移动micro:bit。请按照指示进行操作。每次你将使用磁力计的程序闪存到micro:bit上时，这个提示都会出现。
- en: The purpose of moving your micro:bit this way is to calibrate its magnetometer.
    The magnetometer chip on the micro:bit is sensitive to local magnetic field variations.
    By moving the magnetometer in different directions, you help its internal filtering
    software to compensate for the local distortions to Earth’s magnetic field. This
    is why it’s a good idea to calibrate your compass again if you take it outside,
    away from the metal objects commonly found indoors. Also, a battery pack can affect
    the magnetometer, so it’s best to calibrate with the same hardware you’ll use
    on the final project.
  id: totrans-22
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 以这种方式移动你的micro:bit的目的是为了校准其磁力计。micro:bit上的磁力计芯片对局部磁场变化非常敏感。通过改变磁力计的方向，你帮助它的内部过滤软件补偿地球磁场的局部扭曲。这就是为什么如果你把micro:bit带到室外，远离常见的室内金属物体时，最好重新校准你的指南针。另外，电池组可能会影响磁力计，因此最好使用最终项目中将要使用的硬件进行校准。
- en: Calibrating your micro:bit’s magnetometer is a bit like doing a puzzle. As you
    move your micro:bit, more LEDs will light up ([Figure 4-2](ch04.xhtml#ch4fig2)).
  id: totrans-23
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 校准micro:bit的磁力计有点像做拼图。当你移动micro:bit时，更多的LED灯会亮起（参见[图 4-2](ch04.xhtml#ch4fig2)）。
- en: '![Image](../images/04fig02.jpg)'
  id: totrans-24
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![Image](../images/04fig02.jpg)'
- en: '*Figure 4-2: Calibrating your micro:bit’s magnetometer*'
  id: totrans-25
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*图 4-2：校准你的micro:bit磁力计*'
- en: To use the compass, attach a battery pack to your micro:bit and take it outside,
    well away from items such as computers and household appliances. Hold the micro:bit
    level (so it’s flat). If the arrow points to the right or left, slowly turn in
    that direction until the arrow points straight ahead. When it does, you’re facing
    magnetic north.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要使用指南针，请将电池包连接到micro:bit，并将其带到户外，远离计算机和家用电器等物品。保持micro:bit水平（即平放）。如果箭头指向右或左，慢慢转动，直到箭头指向正前方。当箭头指向正前方时，表示你正面朝磁北。
- en: If the compass isn’t pointing north, try calibrating it again by pressing **button
    A**.
  id: totrans-27
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果指南针未指向北方，请尝试再次按**A键**进行校准。
- en: '**Code**'
  id: totrans-28
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**代码**'
- en: The Blocks and MicroPython versions of the code follow the same pattern. The
    *heading*, or *bearing*, (the direction the micro:bit is pointing) is measured
    and then the program decides which of the three arrows (north, west, or east)
    it should display in order to direct the user in the right direction.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: Blocks和MicroPython版本的代码遵循相同的模式。*heading*或*bearing*（micro:bit指向的方向）被测量，然后程序决定应该显示哪一个箭头（北、东或西）来引导用户朝正确的方向前进。
- en: '**Blocks Code**'
  id: totrans-30
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**Blocks代码**'
- en: Here is the Blocks code for this project.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 这是这个项目的Blocks代码。
- en: '![Image](../images/f0089-01.jpg)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/f0089-01.jpg)'
- en: In this project, we’ll set up the code so that you can calibrate the magnetometer
    any time you want by pressing button A.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个项目中，我们将设置代码，以便你可以随时通过按A键来校准磁力计。
- en: The `calibrate compass` block is inside the `on button A pressed` block. The
    `calibrate compass` block will display the dot we used to calibrate the magnetometer
    earlier. You can then roll it around the display, as we did at the start of this
    project.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: '`calibrate compass`块位于`on button A pressed`块内。`calibrate compass`块将显示我们之前用于校准磁力计的点。你可以像我们在项目开始时那样，围绕显示屏旋转它。'
- en: In the `forever` block, assign the value of `compass heading` (degrees from
    0 to 359) to a variable called `heading`, which will contain this heading.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 在`forever`语句块中，将`compass heading`的值（0到359度）赋给名为`heading`的变量，该变量将保存这个方向值。
- en: Then create a large `if` block that consists of an `if`, an `else if`, and an
    `else`. This big block will test which direction the micro:bit is facing and display
    an arrow on the LED display showing you which way to turn to be facing north.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 然后创建一个大的`if`语句块，其中包含`if`、`else if`和`else`。这个大语句块将测试micro:bit的朝向，并在LED显示屏上显示一个箭头，告诉你应该转向哪个方向以面朝北方。
- en: 'If you’re writing this code yourself, you will notice that the Blocks code
    library seems to offer only two kinds of `if` blocks: `if then` and `else`. To
    add the `else if then` section, click the `+` circled in [Figure 4-3](ch04.xhtml#ch4fig3).'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你自己编写这段代码，你会注意到Blocks代码库似乎只提供两种类型的`if`语句块：`if then`和`else`。要添加`else if then`部分，请点击[图
    4-3](ch04.xhtml#ch4fig3)中的`+`号。
- en: '![Image](../images/04fig03.jpg)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/04fig03.jpg)'
- en: '*Figure 4-3: Adding another section to* if *blocks*'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 4-3：向if语句块添加另一部分*'
- en: The first line of the large `if` block tests whether `heading` is between 10
    and 180 degrees, where 0 degrees is north. Thus, a `heading` value between 10
    and 180 would indicate that you were facing east. In this case, the micro:bit
    would display the west arrow, which points left. This arrow tells you to turn
    to the left in order to face north.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 大的`if`语句块的第一行用于测试`heading`是否在10到180度之间，其中0度表示北方。因此，`heading`值在10到180之间表示你正面朝东。在这种情况下，micro:bit会显示指向左侧的西方箭头。这个箭头告诉你向左转，以便面朝北方。
- en: If `heading` is not between 10 and 180, then the `else if` part of the block
    tests whether `heading` is greater than or equal to 180 and less than 350 degrees.
    If it is, then the micro:bit displays the east arrow, which tells you to go right.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 如果`heading`不在10到180之间，则`else if`部分会测试`heading`是否大于等于180并且小于350度。如果是，那么micro:bit会显示东箭头，告诉你向右走。
- en: If `heading` is between 350 and 10 degrees, the `else` part of the `if` block
    will display the north arrow, which points forward—you’re on the right track!
    [Figure 4-4](ch04.xhtml#ch4fig4) shows how this works (the numbers are possible
    values of `heading`).
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 如果`heading`在350到10度之间，那么`if`语句块的`else`部分会显示指向前方的北方箭头——你走在正确的道路上！[图 4-4](ch04.xhtml#ch4fig4)展示了这一工作原理（数字是`heading`的可能值）。
- en: '![Image](../images/04fig04.jpg)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/04fig04.jpg)'
- en: '*Figure 4-4: The arrow will point in one of three directions, guiding you north.*'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 4-4：箭头将指向三个方向之一，引导你朝北方。*'
- en: '**MicroPython Code**'
  id: totrans-45
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**MicroPython代码**'
- en: 'Here is the MicroPython code for the project:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 这是该项目的 MicroPython 代码：
- en: from microbit import *
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: from microbit import *
- en: 'while True:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 'while True:'
- en: heading = compass.heading()
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: heading = compass.heading()
- en: 'if heading > 10 and heading < 180:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 'if heading > 10 and heading < 180:'
- en: display.show(Image.ARROW_W)
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: display.show(Image.ARROW_W)
- en: 'elif heading >= 180 and heading < 350:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 'elif heading >= 180 and heading < 350:'
- en: display.show(Image.ARROW_E)
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: display.show(Image.ARROW_E)
- en: 'else:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 'else:'
- en: display.show(Image.ARROW_N)
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: display.show(Image.ARROW_N)
- en: 'if button_a.was_pressed():'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 'if button_a.was_pressed():'
- en: compass.calibrate()
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: compass.calibrate()
- en: 'This code uses the same logic as its Blocks code equivalent: it checks the
    reading of the magnetometer and tells the micro:bit to display an arrow. Again,
    if the heading is between 10 and 180 degrees from north, the micro:bit shows a
    west arrow; if it’s between 180 and 350 degrees, the micro:bit displays an east
    arrow; and if the heading is within 20 degrees of north, an arrow points straight
    up, telling you to keep going in the same direction.'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码使用与其块编程等效的逻辑：它检查磁力计的读数，并告诉 micro:bit 显示箭头。同样，如果方向在北方 10 到 180 度之间，micro:bit
    会显示一个指向西方的箭头；如果在 180 到 350 度之间，micro:bit 会显示一个指向东方的箭头；如果方向在北方 20 度以内，箭头会指向正上方，告诉你继续沿着这个方向前进。
- en: '**Things to Try**'
  id: totrans-59
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**可尝试的操作**'
- en: See whether you can use a magnet to confuse the compass about which direction
    is north.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 看看你能否用一个磁铁让指南针混淆北方的方向。
- en: '**How It Works: The Earth’s Magnetic Field**'
  id: totrans-61
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**工作原理：地球的磁场**'
- en: Earth’s magnetic north and south poles have strong charges, creating a magnetic
    field all around the globe, as shown in [Figure 4-5](ch04.xhtml#ch4fig5).
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 地球的磁北极和磁南极具有强大的电荷，形成了一个环绕地球的磁场，如在[图 4-5](ch04.xhtml#ch4fig5)中所示。
- en: '![Image](../images/04fig05.jpg)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/04fig05.jpg)'
- en: '*Figure 4-5: Earth’s magnetic field*'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 4-5：地球的磁场*'
- en: The micro:bit’s magnetometer measures the strength of Earth’s magnetic field
    to deduce the direction the micro:bit is facing.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: micro:bit 的磁力计测量地球磁场的强度，从而推断出 micro:bit 面对的方向。
- en: Interestingly, the magnetic north pole is not exactly at the top of the spinning
    ball that is Earth. The magnetic field can be centered up to 20 degrees away from
    the geographic poles, depending on where you are in the world.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 有趣的是，磁北极并不完全位于地球自转球体的顶部。根据你所在的位置，磁场的中心可能会偏离地理北极多达 20 度。
- en: Another interesting fact about the magnetic poles is that they’re shifting at
    a rate of about 6 miles (10 km) a year. One day, the poles will flip completely,
    meaning that magnetic north will be at the southern end of the globe. This process
    happens on Earth about every 450,000 years.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 关于磁极的另一个有趣事实是，它们每年以大约 6 英里（10 公里）的速度移动。某一天，磁极将完全翻转，意味着磁北将位于地球的南端。这个过程大约每 45
    万年发生一次。
- en: '**EXPERIMENT 4: MEASURING MAGNETIC FIELDS**'
  id: totrans-68
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**实验 4：测量磁场**'
- en: '![Image](../images/common2.jpg)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/common2.jpg)'
- en: '*Difficulty: Medium*'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '*难度：中等*'
- en: As we just saw, the micro:bit’s built-in magnetometer is sensitive enough that
    you can use it as a compass to find north. It’s also a great tool for measuring
    the strength of a nearby magnet. In this experiment (shown in [Figure 4-6](ch04.xhtml#ch4fig6)),
    you’ll measure the strength of a magnetic field at various distances.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们刚刚看到的，micro:bit 内置的磁力计足够灵敏，你可以用它作为指南针来找到北方。它还是测量附近磁铁强度的好工具。在这个实验中（如[图 4-6](ch04.xhtml#ch4fig6)所示），你将测量不同距离下磁场的强度。
- en: '**What You’ll Need**'
  id: totrans-72
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**你将需要的材料**'
- en: 'In this experiment, you’ll need the following:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个实验中，你将需要以下设备：
- en: '**Micro:bit**'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '**Micro:bit**'
- en: '**Strong neodymium magnet**'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '**强力钕磁铁**'
- en: '**Ruler (preferably showing millimeters)**'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '**直尺（最好能显示毫米）**'
- en: You’ll find all sorts of shapes and sizes of magnets on eBay. As you can see
    in [Figure 4-6](ch04.xhtml#ch4fig6), I’m using a disk-shaped one with a diameter
    of 10 mm, but any neodymium magnet of a similar size should work. Note that I’ve
    put a bit of tape labeled *N* on one side of the magnet (more on this later).
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在 eBay 上找到各种形状和大小的磁铁。正如在[图 4-6](ch04.xhtml#ch4fig6)中所示，我使用的是一个直径为 10 毫米的圆盘形磁铁，但任何类似大小的钕磁铁都应该可以使用。请注意，我在磁铁的一侧贴了一小块标有*N*的胶带（稍后会详细介绍）。
- en: '![Image](../images/04fig06.jpg)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/04fig06.jpg)'
- en: '*Figure 4-6: The neodymium magnet used for Experiment 4*'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 4-6：用于实验 4 的钕磁铁*'
- en: '**WARNING** *Neodynmium magnets are very strong, so be careful when handling
    them. If two of them get stuck together, it can be hard to separate them.*'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: '**警告** *钕磁铁非常强大，处理时要小心。如果两个磁铁粘在一起，分开它们可能会很困难。*'
- en: '**Construction**'
  id: totrans-81
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**构建**'
- en: The program repeatedly scrolls a number across the micro:bit’s display. This
    number represents the overall magnetic field strength detected by the magnetometer.
    We are going to measure the field strength at various distances from the magnet.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 该程序会反复在micro:bit的显示屏上滚动一个数字。这个数字表示磁力计检测到的整体磁场强度。我们将测量磁铁在不同距离下的磁场强度。
- en: 'Go to *[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*
    to access the book’s code repository and click the link for **Experiment 4: Magnetic
    Fields**. Once the program has opened, click **Download** and then copy the hex
    file onto your micro:bit. If you get stuck on this, head back to [Chapter 1](ch01.xhtml#ch01),
    where the process of getting programs onto your micro:bit is explained in full.'
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 请访问 *[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*
    以访问书籍的代码库，并点击 **实验4：磁场** 的链接。程序打开后，点击 **下载**，然后将 hex 文件复制到你的micro:bit中。如果在这个过程中遇到困难，请返回[第1章](ch01.xhtml#ch01)，那里详细解释了如何将程序传输到micro:bit。
- en: If you prefer to use Python, download the code for this project from the same
    website, along with instructions for downloading and using the book examples.
    The Python file for this experiment is *Experiment_04.py*.
  id: totrans-84
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你更喜欢使用Python，可以从同一网站下载此项目的代码，并按照说明下载和使用书中的示例。此实验的Python文件是 *Experiment_04.py*。
- en: Set your magnet on a flat surface so that it’s balanced on its curved edge.
    A neodymium magnet is so strong that if you set it down in this way, it will align
    itself with Earth’s magnetic field (by spinning until one side is facing north),
    just like a compass needle. Allow your magnet to do this and then put a piece
    of tape on the side that’s facing north. (You might need to use the Compass project,
    described earlier in this chapter, to find north so you don’t accidentally mark
    south instead.)
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将磁铁放置在平坦的表面上，使其平衡地摆放在弯曲的边缘上。由于钕磁铁的磁力非常强，如果将它这样放置，它会自行与地球的磁场对齐（通过旋转直到一面朝北），就像指南针的指针一样。让磁铁自行对齐，然后在朝北的一侧贴上胶带。（你可能需要使用本章早些时候提到的指南针项目来找到北方，避免误标记南方。）
- en: Align your ruler so the 0 cm mark is pointing north and the 30 cm mark is pointing
    south, as shown in [Figure 4-7](ch04.xhtml#ch4fig7). The ruler allows you to make
    sure the magnet continues to face north so that the effect of Earth’s magnetic
    field remains constant.![Image](../images/04fig07.jpg)
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 调整尺子，使0厘米标记指向北方，30厘米标记指向南方，如[图4-7](ch04.xhtml#ch4fig7)所示。尺子帮助确保磁铁持续朝北，以保持地球磁场的影响不变。![图片](../images/04fig07.jpg)
- en: '*Figure 4-7: Place the ruler in the north–south direction to make sure your
    magnet continues to face north.*'
  id: totrans-87
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*图4-7：将尺子放置在南北方向，确保磁铁持续朝北。*'
- en: Set the magnet on its curved edge next to the 1 cm mark on the ruler. Make sure
    the north side is facing the micro:bit. Point the micro:bit south and align its
    edge with the 0 cm mark. Record the reading displayed on the micro:bit in the
    following table, in the 1 cm row. The unit of magnetic field strength is a *tesla*
    (which is a very, very strong magnetic field), so the readings from the micro:bit
    are in *microtesla* or millionths of a Tesla, represented by µT).
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将磁铁放置在尺子上的1厘米标记旁边，确保北面朝向micro:bit。将micro:bit朝南并使其边缘与0厘米标记对齐。记录显示在micro:bit上的读数，并将其写入下表的1厘米行。磁场强度的单位是
    *特斯拉*（非常非常强的磁场），因此micro:bit的读数以 *微特斯拉*（即特斯拉的百万分之一，符号为µT）表示。
- en: '|  **Distance from micro:bit to magnet (cm)**  | **Magnetic field strength
    (µT)** |'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '|  **micro:bit到磁铁的距离（厘米）**  | **磁场强度（µT）** |'
- en: '| --- | --- |'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| 1 | **___________________________________** |'
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 1 | **___________________________________** |'
- en: '| 2 | **___________________________________** |'
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 2 | **___________________________________** |'
- en: '| 3 | **___________________________________** |'
  id: totrans-93
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 3 | **___________________________________** |'
- en: '| 4 | **___________________________________** |'
  id: totrans-94
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 4 | **___________________________________** |'
- en: '| 5 | **___________________________________** |'
  id: totrans-95
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 5 | **___________________________________** |'
- en: '| 6 | **___________________________________** |'
  id: totrans-96
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 6 | **___________________________________** |'
- en: '| 7 | **___________________________________** |'
  id: totrans-97
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 7 | **___________________________________** |'
- en: '| 8 | **___________________________________** |'
  id: totrans-98
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 8 | **___________________________________** |'
- en: '| 9 | **___________________________________** |'
  id: totrans-99
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 9 | **___________________________________** |'
- en: '| 10 | **___________________________________** |'
  id: totrans-100
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 10 | **___________________________________** |'
- en: Move the magnet so it’s next to the 2 cm mark on the ruler. Enter the new number
    displayed on the micro:bit in the corresponding row in the table. Repeat this
    process for all the readings up to 10 cm. Notice that the field strength decreases
    quickly as you move the magnet away from the micro:bit.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将磁铁移动到刻度尺上的 2 cm 标记旁边。在表格中的相应行输入 micro:bit 上显示的新数字。对于所有的读数，直到 10 cm，都重复这个过程。请注意，当你将磁铁从
    micro:bit 移开时，磁场强度会迅速减小。
- en: Once you’ve taken all the readings, try plotting a chart of your results. Make
    the vertical axis, or *Y axis*, show the field strength in µT and plot the distance
    of the magnet from the micro:bit in cm against the horizontal axis, or *X axis*.
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦你完成了所有的读数，试着绘制一个结果图。让纵轴，即*Y轴*，显示磁场强度（单位：µT），并将磁铁距离 micro:bit 的距离（单位：cm）绘制在横轴，即*X轴*上。
- en: You can plot this graph by hand on paper, or, if you prefer, you can make a
    copy of the Google Sheets spreadsheet I’ve created for this experiment and then
    replace my readings with the numbers you have just written down. You will find
    a link to this spreadsheet at *[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*.
    Open this link and, from the spreadsheet menu, select **File**▸**Make a Copy**
    to make your own copy. [Figure 4-8](ch04.xhtml#ch4fig8) shows the completed spreadsheet
    with a chart of the readings underneath it.
  id: totrans-103
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你可以手动在纸上绘制这个图表，或者，如果你愿意，你可以复制我为这个实验创建的 Google 表格，并将我的读数替换为你刚刚记录下的数字。你可以在 *[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*
    上找到这个表格的链接。打开这个链接后，在表格菜单中选择 **文件**▸**创建副本** 来创建你自己的副本。[图 4-8](ch04.xhtml#ch4fig8)
    显示了完成的表格，下面是一个包含读数的图表。
- en: Note that your readings might be different, as your magnet may be weaker or
    stronger.
  id: totrans-104
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 请注意，你的读数可能不同，因为你的磁铁可能比我的强或弱。
- en: '![Image](../images/04fig08.jpg)'
  id: totrans-105
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图片](../images/04fig08.jpg)'
- en: '*Figure 4-8: Make a graph of your results.*'
  id: totrans-106
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*图 4-8：绘制你的结果图表。*'
- en: 'We’ll discuss these results in “How It Works: The Strength of Magnets” on [page
    99](ch04.xhtml#page_99).'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在“工作原理：磁铁的强度”部分讨论这些结果，详见 [第99页](ch04.xhtml#page_99)。
- en: '**Code**'
  id: totrans-108
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**代码**'
- en: The code for this experiment is simple. It takes a reading, displays it, and
    then repeats.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 这个实验的代码很简单。它读取数据，显示结果，然后重复。
- en: '**Blocks Code**'
  id: totrans-110
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**积木代码**'
- en: Here is the Blocks code for this project.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 这是这个项目的积木代码。
- en: '![Image](../images/f0098-01.jpg)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/f0098-01.jpg)'
- en: The `show number` block displays the result of the `magnetic force` block inside
    the `forever` block.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: '`show number` 块显示 `magnetic force` 块的结果，并且位于 `forever` 块内。'
- en: The `magnet force` block has four options, which you can see in the drop-down
    menu of this block. You can either get a separate reading for the force in one
    of the three dimensions X, Y, or Z, or you can get the combined force measurement
    from all three dimensions. We will use the combined measurement, which is the
    `strength` option in the drop-down menu.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: '`magnet force` 块有四个选项，你可以在该块的下拉菜单中查看。你可以选择获取 X、Y 或 Z 维度中任意一个维度的单独读数，或者获取三个维度的组合力测量值。我们将使用组合测量值，即下拉菜单中的
    `strength` 选项。'
- en: '**MicroPython Code**'
  id: totrans-115
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**MicroPython 代码**'
- en: 'Here is the MicroPython version of the code:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 这是该项目的 MicroPython 版本代码：
- en: from microbit import *
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: from microbit import *
- en: 'while True:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 'while True:'
- en: display.scroll(str(int(compass.get_field_strength() / 1300)))
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: display.scroll(str(int(compass.get_field_strength() / 1300)))
- en: In MicroPython, the `get_field_strength` function takes readings from the micro:bit’s
    magnetometer. Unlike the `magnetic force` block of the Blocks code, the MicroPython
    code does not specify the units for the measurement it returns, but the reading
    we get back is about 1,300 times the reading reported by the equivalent `magnetic
    force` block. Therefore, divide the number by 1,300 and then convert this value
    with the `int` function to make it an integer.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 在 MicroPython 中，`get_field_strength` 函数从 micro:bit 的磁力计中获取读数。与积木代码中的 `magnetic
    force` 块不同，MicroPython 代码没有指定返回结果的单位，但我们得到的读数大约是 `magnetic force` 块返回读数的 1,300
    倍。因此，需要将该数值除以 1,300，然后使用 `int` 函数将其转换为整数。
- en: Use the `str` function to convert the number to a text string so the `scroll`
    function can display it on the micro:bit screen.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `str` 函数将数字转换为文本字符串，以便 `scroll` 函数能够将其显示在 micro:bit 屏幕上。
- en: '**Things to Try**'
  id: totrans-122
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**可尝试的操作**'
- en: Using the program for Experiment 4, try moving the magnet farther and farther
    away to see how far away the magnet can be and still show up on your micro:bit.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 使用实验 4 的程序，尝试将磁铁移得更远，以查看磁铁能移多远，但仍能在 micro:bit 上显示。
- en: '**How It Works: The Strength of Magnets**'
  id: totrans-124
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**工作原理：磁铁的强度**'
- en: The chart in [Figure 4-8](ch04.xhtml#ch4fig8) shows that as you move the magnet
    away from the micro:bit, the magnetic field strength falls very rapidly at first
    and then gradually levels off. In fact, the relationship between magnetic field
    strength and distance from the magnet follows something called the *inverse square
    rule*. That is, the field strength is proportional to 1 divided by the square
    root of the distance from the magnet.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-8](ch04.xhtml#ch4fig8) 中的图表显示，当你将磁铁移远 micro:bit 时，磁场强度最初会迅速下降，然后逐渐趋于平稳。事实上，磁场强度和磁铁之间的距离之间的关系遵循所谓的
    *反平方定律*。也就是说，磁场强度与磁铁距离的平方根的倒数成正比。'
- en: What this means is that when the distance between the magnet and the micro:bit
    doubles, the field strength falls to a quarter of its previous strength.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着，当磁铁与 micro:bit 之间的距离加倍时，磁场强度将下降到之前强度的四分之一。
- en: The strength of Earth’s magnetic field when measured on the ground ranges from
    25 to 65 µT. When you measure the magnetic force without a magnet nearby, you
    should get readings in this range. Even the super-strong neodymium magnet used
    in this experiment has a field strength of only a few hundred µT at a distance
    of a few centimeters. Magnets that are used to look inside human bodies during
    magnetic resonance imaging (MRI) scans typically have a field strength (where
    the person lies) of 0.5 to 1.5 T. That’s several thousand times stronger than
    the neodymium magnet. This is why you have to take off any metal you are wearing
    when you go into an MRI scanner!
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 地球的磁场强度在地面上测量时范围为 25 至 65 微特斯拉（µT）。当你测量没有附近磁铁时的磁场力，应该会得到这个范围内的读数。即使是实验中使用的超强钕磁铁，在几厘米的距离下，磁场强度也只有几百微特斯拉。用于磁共振成像（MRI）扫描时查看人体内部的磁铁，通常其磁场强度（即人躺的位置）为
    0.5 至 1.5 特斯拉（T）。这比钕磁铁强几千倍。这就是为什么你进入 MRI 扫描仪时必须摘下身上的所有金属物品！
- en: '**PROJECT: MAGNETIC DOOR ALARM**'
  id: totrans-128
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**项目：磁性门铃报警器**'
- en: '![Image](../images/common3.jpg)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/common3.jpg)'
- en: '*Difficulty: Medium*'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '*难度：中等*'
- en: We’re going to create a door alarm! By attaching a magnet to a door and a micro:bit
    to a door frame, the Mad Scientist can be alerted to the arrival of guests. The
    micro:bit will sound an alarm when it detects a change in the strength of the
    magnetic field. This is exactly what happens when someone opens the door, moving
    the magnet farther away.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将创建一个门铃报警系统！通过将磁铁安装在门上，并将 micro:bit 安装在门框上，疯狂科学家就能在客人到达时收到提醒。当 micro:bit 检测到磁场强度变化时，它将发出报警声音。这正是当有人打开门时，磁铁远离时发生的情况。
- en: '[Figure 4-9](ch04.xhtml#ch4fig9) shows the project attached to the Mad Scientist’s
    door.'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-9](ch04.xhtml#ch4fig9) 显示了项目安装在疯狂科学家门上的样子。'
- en: '![Image](../images/04fig09.jpg)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/04fig09.jpg)'
- en: '*Figure 4-9: A magnetic door alarm*'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 4-9：磁性门铃报警器*'
- en: '**What You’ll Need**'
  id: totrans-135
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**所需材料**'
- en: 'For this project, you will need the following items:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个项目，您将需要以下物品：
- en: '**Micro:bit**'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: '**Micro:bit**'
- en: '**3 × Alligator clip cables** To connect the micro:bit to the speaker. These
    cables should be at least 15 cm (6 inches) long.'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: '**3 × 鳄鱼夹连接线** 用于将 micro:bit 与扬声器连接。这些线缆至少应该长 15 厘米（6 英寸）。'
- en: '**USB power adapter or switched 3V battery pack** To power the micro:bit and
    speaker. See the [appendix](app01.xhtml) for other options for powering your micro:bit.'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: '**USB 电源适配器或带开关的 3V 电池包** 用于为 micro:bit 和扬声器供电。有关为 micro:bit 提供电源的其他选项，请参见[附录](app01.xhtml)。'
- en: '**Speaker** You can use any of the methods for getting sound out of a micro:bit
    discussed in [Chapter 2](ch02.xhtml#ch02). Here, I used a Monk Makes Speaker for
    micro:bit.'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: '**扬声器** 您可以使用在[第二章](ch02.xhtml#ch02)中讨论的任何方法将声音从 micro:bit 输出。在这里，我使用了一个 Monk
    Makes 扬声器。'
- en: '**Adhesive putty or self-adhesive pads** To attach the micro:bit and speaker
    to the door frame and the magnet to the door'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: '**粘性腻子或自粘垫片** 用于将 micro:bit 和扬声器固定到门框上，并将磁铁固定到门上'
- en: '**Neodymium magnet** As used in Experiment 4'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: '**钕磁铁** 如实验 4 中使用的磁铁'
- en: '**Construction**'
  id: totrans-143
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**构建**'
- en: Make sure to test the project before you install it on your door, since you’ll
    need to experiment a little to determine the right field strength to use. You’ll
    also need to calibrate the magnetometer before sticking it to a door frame.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 在将项目安装到门上之前，确保先进行测试，因为你需要进行一些实验来确定使用的正确磁场强度。你还需要在将其粘贴到门框之前校准磁力计。
- en: Connect the speaker to the micro:bit using the three alligator cables, as shown
    in [Figure 4-9](ch04.xhtml#ch4fig9).
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如[图 4-9](ch04.xhtml#ch4fig9)所示，使用三根鳄鱼夹连接线将扬声器连接到 micro:bit。
- en: It’s a good idea to color-code your cables by using black for GND, red for 3V,
    and any other color for the audio connection from pin 0 of the micro:bit. That
    way, you won’t forget which cable is which. You’ll need to place the speaker at
    least 15 cm away from the micro:bit, as speakers have strong magnets that can
    disrupt the micro:bit’s magnetometer.
  id: totrans-146
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 最好通过使用黑色电缆连接 GND，红色电缆连接 3V，其他颜色连接 micro:bit 的引脚 0 来进行电缆配色。这样，你就不会忘记哪个电缆是哪个。你需要将扬声器至少放置
    15 厘米远离 micro:bit，因为扬声器有强大的磁铁，会干扰 micro:bit 的磁力计。
- en: Go to *[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*
    to access the book’s code repository and click the link for **Magnetic Alarm**.
    Once the program has opened, click **Download** and then copy the hex file onto
    your micro:bit. If you get stuck on this, head back to [Chapter 1](ch01.xhtml#ch01).
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问 *[https://github.com/simonmonk/mbms/](https://github.com/simonmonk/mbms/)*
    获取书籍的代码仓库，并点击 **磁性报警** 的链接。一旦程序打开，点击 **下载**，然后将 hex 文件复制到你的 micro:bit 上。如果在此过程中遇到问题，可以返回到
    [第 1 章](ch01.xhtml#ch01)。
- en: If you prefer to use Python, you’ll find the code for this at the same website,
    along with instructions for downloading and using the book’s examples. The Python
    file for this experiment is *ch_04_Magnetic_Alarm.py*.
  id: totrans-148
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你更喜欢使用 Python，你可以在同一网站上找到该代码，并查看如何下载和使用书中的示例。这个实验的 Python 文件是 *ch_04_Magnetic_Alarm.py*。
- en: Once you have programmed the micro:bit, when you put the magnet close to the
    micro:bit, the speaker should be silent. Then when you move the magnet more than
    a few inches away, the alarm should sound. Once the program is working, disconnect
    the micro:bit from your computer and attach it to either a USB power adapter or
    battery pack. Then attach the micro:bit and speaker to your door frame. Fix the
    magnet to the door itself, within an inch (2.5 cm) of the micro:bit.
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦你编程完成 micro:bit，当你将磁铁靠近 micro:bit 时，扬声器应该保持静音。然后当你将磁铁移开几英寸时，警报应该响起。程序正常工作后，断开
    micro:bit 与计算机的连接，并将其连接到 USB 电源适配器或电池包上。然后将 micro:bit 和扬声器固定在门框上。将磁铁固定在门上，距离 micro:bit
    不超过一英寸（2.5 厘米）。
- en: '**WARNING** *Adhesive putty can make a mess, so make sure you get permission
    before you start sticking things to the door and frame.*'
  id: totrans-150
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**警告** *粘合剂可能会弄得一团糟，因此在开始将物品粘贴到门和门框上之前，确保获得许可。*'
- en: If you’re using a USB power adapter, you’ll need an electrical outlet close
    enough to the door for the USB power adapter to reach.
  id: totrans-151
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你使用的是 USB 电源适配器，确保有一个靠近门的电源插座，以便 USB 电源适配器能连接。
- en: '![Image](../images/f0102-01.jpg)'
  id: totrans-152
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/f0102-01.jpg)'
- en: '**Code**'
  id: totrans-153
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**代码**'
- en: In both versions of the code, the magnetic field strength is first read and
    then compared with a threshold. If the threshold is exceeded, then a note is played.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在这两个版本的代码中，首先读取磁场强度，然后与阈值进行比较。如果超过阈值，就会播放一个音符。
- en: '**Blocks Code**'
  id: totrans-155
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**块代码**'
- en: Here is the Blocks code for the project.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 这是该项目的块代码。
- en: '![Image](../images/f0102-02.jpg)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![Image](../images/f0102-02.jpg)'
- en: This code is basically saying that if the micro:bit reads a magnetic force strength
    of less than 100 µT, it should play a particular note for 4 beats. Since the strength
    of Earth’s magnetic field at the surface has a range of 25 to 65 µT, setting a
    threshold at 100 µT should ensure we’re detecting the magnet and not just picking
    up Earth’s magnetic field.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码基本上是说，如果 micro:bit 读取到的磁力强度小于 100 µT，它应该播放一个特定的音符，持续 4 拍。由于地球表面的磁场强度范围是
    25 到 65 µT，将阈值设置为 100 µT 应该能确保我们检测到的是磁铁，而不是地球的磁场。
- en: '**MicroPython Code**'
  id: totrans-159
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**MicroPython 代码**'
- en: 'Here’s the MicroPython version of the program:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 这是该程序的 MicroPython 版本：
- en: from microbit import *
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: from microbit import *
- en: import music
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: import music
- en: 'while True:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 'while True:'
- en: 'if compass.get_field_strength() < 160000:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 'if compass.get_field_strength() < 160000:'
- en: music.pitch(523, 1000)
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: music.pitch(523, 1000)
- en: This code works in the same way as the Blocks code, but because the units of
    `get_field_strength` are different from those of the `magnetic force` block, the
    threshold for sounding the alarm is different than in the Blocks code version.
    The units of the field strength returned by `get_field_strength` are not specified
    in its documentation (*[https://microbit-micropython.readthedocs.io/en/latest/compass.html](https://microbit-micropython.readthedocs.io/en/latest/compass.html)*),
    so I chose the threshold value of 160,000 by trial and error.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码与Blocks代码的工作方式相同，但由于`get_field_strength`的单位与`magnetic force`块的单位不同，触发警报的阈值与Blocks代码版本不同。`get_field_strength`返回的磁场强度单位在其文档中没有明确说明
    (*[https://microbit-micropython.readthedocs.io/en/latest/compass.html](https://microbit-micropython.readthedocs.io/en/latest/compass.html)*)，因此我通过反复试验选择了160,000作为阈值。
- en: We supply the command `music.pitch` with a frequency of tone to produce. Unlike
    with the Blocks code, here we have to specify the frequency of the sound wave
    rather than a note. A frequency of 523 hertz (Hz) is the frequency of high C.
    The `music.pitch` command also requires a length of time to play the note. Here
    we’ve told the micro:bit to play the note for 1,000 milliseconds, or 1 second.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通过命令 `music.pitch` 来指定产生的音调频率。与Blocks代码不同，在这里我们需要指定声音波的频率，而不是音符的名称。523赫兹（Hz）是高C的频率。`music.pitch`命令还需要指定播放音符的时间长度。在这里，我们告诉micro:bit播放这个音符1,000毫秒，即1秒。
- en: '**Things to Try**'
  id: totrans-168
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '**尝试的事项**'
- en: Could a thief defeat your new alarm? Try placing a second magnet on the other
    side of the door frame, opposite the micro:bit. If the second magnet is close
    enough to the micro:bit, you may be able to open the door without triggering the
    alarm.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 小偷能突破你的新警报吗？试着将第二个磁铁放在门框的另一侧，正对着micro:bit。如果第二个磁铁足够接近micro:bit，你可能能够在不触发警报的情况下打开门。
- en: You could also change the alarm tone by changing the frequency to some other
    value. The following table shows some notes and their corresponding frequencies
    (to the nearest whole number).
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以通过改变频率来更改警报音调。下表显示了一些音符及其对应的频率（四舍五入到最接近的整数）。
- en: '| **Note** | **Frequency (Hz)** |'
  id: totrans-171
  prefs: []
  type: TYPE_TB
  zh: '| **音符** | **频率（Hz）** |'
- en: '| --- | --- |'
  id: totrans-172
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| Middle C | 262 |'
  id: totrans-173
  prefs: []
  type: TYPE_TB
  zh: '| 中央C | 262 |'
- en: '| D | 294 |'
  id: totrans-174
  prefs: []
  type: TYPE_TB
  zh: '| D | 294 |'
- en: '| E | 330 |'
  id: totrans-175
  prefs: []
  type: TYPE_TB
  zh: '| E | 330 |'
- en: '| F | 349 |'
  id: totrans-176
  prefs: []
  type: TYPE_TB
  zh: '| F | 349 |'
- en: '| G | 392 |'
  id: totrans-177
  prefs: []
  type: TYPE_TB
  zh: '| G | 392 |'
- en: '| A | 440 |'
  id: totrans-178
  prefs: []
  type: TYPE_TB
  zh: '| A | 440 |'
- en: '| B | 494 |'
  id: totrans-179
  prefs: []
  type: TYPE_TB
  zh: '| B | 494 |'
- en: '| High C | 523 |'
  id: totrans-180
  prefs: []
  type: TYPE_TB
  zh: '| 高C | 523 |'
- en: You can find a full table of musical notes and their frequencies at *[https://www.liutaiomottola.com/formulae/freqtab.htm](https://www.liutaiomottola.com/formulae/freqtab.htm)*.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在 *[https://www.liutaiomottola.com/formulae/freqtab.htm](https://www.liutaiomottola.com/formulae/freqtab.htm)*
    找到完整的音符及其频率表。
- en: '**SUMMARY**'
  id: totrans-182
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**总结**'
- en: The micro:bit’s magnetometer is useful for more than working out which direction
    you’re facing. In this chapter, we’ve explored how you can use it to sense the
    presence of a magnet and even to do some science by measuring magnetic field strength.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: micro:bit的磁力计不仅可以用来判断你朝哪个方向。 在这一章中，我们探索了如何利用它感应磁铁的存在，甚至通过测量磁场强度来做一些科学实验。
- en: In the next chapter, we’ll explore one of the micro:bit’s other built-in sensors—its
    accelerometer.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章，我们将探索micro:bit的另一个内置传感器——加速度计。
