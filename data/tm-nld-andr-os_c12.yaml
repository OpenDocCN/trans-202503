- en: '12'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '12'
- en: Media
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 媒体
- en: When software engineers talk about media, they’re usually referring to *multimedia*,
    meaning audio and video. These technologies are very distinct from each other
    and both require deep domain expertise. So engineers usually work on one or the
    other, not both. Nevertheless, audio and video engineers are usually collected
    into the same “media” team. Maybe it’s because they both require such power and
    memory from the device—and such extreme optimizations in the software—in order
    to work reliably for the user.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 当软件工程师谈论媒体时，他们通常指的是*多媒体*，即音频和视频。这些技术彼此非常不同，并且都需要深入的领域专业知识。因此，工程师通常只专注于其中一种，而不是两者都做。然而，音频和视频工程师通常会被集合到同一个“媒体”团队中。也许是因为它们都需要设备提供强大的性能和内存——并且在软件中进行极端的优化——才能确保为用户可靠地工作。
- en: Dave Sparks and Ringtones
  id: totrans-3
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 戴夫·斯帕克斯与铃声
- en: Dave Sparks only took one programming course in his life, a Fortran class when
    he was a sophomore in high school. Writing programs in that class consisted of
    typing the code onto punch cards, which were then wrapped with a rubber band and
    couriered to the district office, where they would be executed on the computer
    there. Students would get the results of their program on a printout a few days
    later.^([1](#c12-footnote-1))
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 戴夫·斯帕克斯一生只上过一门编程课，那就是他高中二年级时的Fortran课程。在那门课上，编写程序的方式是将代码输入穿孔卡片，然后用橡皮筋包裹起来，快递到区办公室，程序在那里执行。几天后，学生们会收到程序的打印输出结果。^([1](#c12-footnote-1))
- en: Dave was more intrigued by the old Monrobot XI system in the back of the classroom,
    a circa 1960 machine that used a rotating magnetic drum for storage. He learned
    how to program machine code on that old system, nearly failing the Fortran class
    in the process.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 戴夫对教室后面那台老旧的Monrobot XI系统更感兴趣，这是一台大约1960年左右的机器，使用旋转磁鼓进行存储。他学会了如何在那台老系统上编写机器代码，在这个过程中几乎没通过Fortran课程。
- en: His programming career began after high school, while he was working in a RadioShack.
    Ray Dolby^([2](#c12-footnote-2)) came into the store one day looking for help;
    he wanted a program to download his stock data into a spreadsheet. The manager
    pointed at Dave as someone who could help. One program and $50 later, Dave was
    a professional programmer.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 他的编程生涯始于高中毕业后，那时他在RadioShack工作。有一天，雷·杜尔比^([2](#c12-footnote-2))来到商店寻求帮助；他想要一款程序，将自己的股票数据下载到电子表格中。经理指着戴夫说，他可以帮忙。写完一个程序并收取50美元后，戴夫成为了一名职业程序员。
- en: In the early 2000s, carriers required mobile phones to support a variety of
    ringtone formats. Complicating the requirement more was the fact that different
    carriers used different formats, so phone manufacturers would have to support
    multiple formats in order to be able to sell their devices into different markets.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在2000年代初，运营商要求手机支持各种铃声格式。更复杂的是，不同运营商使用不同的格式，因此手机制造商必须支持多种格式，以便能够将设备销往不同的市场。
- en: Yamaha offered a dedicated synthesizer chip that could handle the requirements,
    for a cost of a couple dollars per handset. Manufacturers are always looking for
    ways to cut costs, so a company called Sonivox introduced a software-based solution
    instead, selling it for just a dollar per handset.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 雅马哈提供了一款专用的合成器芯片，能够处理这些要求，每部手机的成本为几美元。制造商总是寻找降低成本的方法，于是Sonivox公司推出了一种基于软件的解决方案，每部手机只卖一美元。
- en: Dave Sparks was in charge of that product at Sonivox when Andy Rubin came calling.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 戴夫·斯帕克斯当时负责Sonivox的那个产品，当安迪·鲁宾打来电话时。
- en: With Android’s plans to open source the OS, Andy’s needs were different from
    Sonivox’s typical customers; he wanted the product, but also to publish the source
    code for it, effectively eliminating future sales. Dave remembered the deal as,
    “This is going to be open sourced in the future. Here’s a pile of money.”
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 随着Android计划开源操作系统，安迪的需求与Sonivox的典型客户不同；他不仅想要这个产品，还希望发布源代码，从而有效地消除未来的销售机会。戴夫记得这笔交易时说：“这将来会开源。这里有一大笔钱。”
- en: The deal happened in early 2007\. In March, Dave came to Google and spent a
    couple hours with Ficus Kirkpatrick to integrate that software into the system.
    Suddenly, Android could play ringtones.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 这笔交易发生在2007年初。3月，戴夫来到了Google，并与Ficus Kirkpatrick一起花了几个小时将那款软件集成到系统中。突然，Android可以播放铃声了。
- en: Months later, Andy called Dave, who was still at Sonivox, and asked him to join
    Android to build a media team. Dave joined Android in August of 2007.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 几个月后，安迪打电话给还在Sonivox的戴夫，邀请他加入Android团队建立媒体团队。戴夫于2007年8月加入了Android。
- en: Marco Nelissen and Audio
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 马尔科·内利森与音频
- en: 'After Ficus got ringtones working with the Sonivox software, he also got a
    single MP3 ringtone working: “Crazy” by Gnarls Barkley. Joe Onorato explained,
    “mp3 playback was a ton of work. As soon as he got that working, we needed a ringtone.
    He checked in an MP3 of ‘Crazy’ and that was The Ringtone.”'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在Ficus使Sonivox软件能够支持铃声后，他还成功让一首MP3铃声播放起来：“Crazy”——Gnarls Barkley的歌。Joe Onorato解释道：“mp3播放是非常繁琐的工作。等他把那个功能搞定后，我们需要一个铃声。他提交了‘Crazy’的MP3文件，那就成了最终的铃声。”
- en: With all Android phones playing that same ringtone for every phone call, the
    song was driving everyone . . . well, you know.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 随着所有Android手机在每个电话中播放相同的铃声，这首歌让每个人都快受不了了……你明白的。
- en: 'The team needed help generalizing the ringtone system, so they hired someone
    that had been writing audio software for years: Marco Nelissen.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 团队需要帮助将铃声系统普及化，因此他们雇佣了一个已经从事音频软件开发多年的专家：Marco Nelissen。
- en: When he was in high school in the Netherlands, Marco’s parents bought him a
    Commodore 64\. Initially, he just played games on it, but he soon started programming
    on it, learning BASIC and then assembly. He wrote text editors and then began
    playing with multimedia applications as well, including a music sequencing app
    called SoundTracker Pro.^([3](#c12-footnote-3))
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在荷兰上高中时，Marco的父母给他买了一台Commodore 64。最初他只是玩游戏，但很快他就开始在上面编程，学习BASIC语言，然后是汇编语言。他写了文本编辑器，接着开始玩多媒体应用程序，包括一个名为SoundTracker
    Pro的音乐序列应用程序。^([3](#c12-footnote-3))
- en: After college, he continued working in multimedia, first at a company writing
    software for Philips CD-i platform, and then at Be. Like many colleagues at Be,
    he joined Palm after its acquisition of Be. He stuck around at PalmSource longer
    than most of his team, who had mostly joined Google to work on Android by early
    2006\. Marco finally joined the Android team in January of 2007.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 大学毕业后，他继续从事多媒体工作，首先在一家为Philips CD-i平台编写软件的公司工作，随后加入了Be公司。像许多Be的同事一样，他在Be被Palm收购后加入了Palm。Marco在PalmSource待得比大多数团队成员都长，因为大多数人早在2006年初就已经加入了Google，开始在Android项目中工作。Marco最终于2007年1月加入了Android团队。
- en: Marco dove into Android’s audio functionality. His first project was to add
    the increasingly important ability to select a different ringtone. “Not that I
    didn’t like that song, but when you heard the same thing every few minutes when
    someone’s phone rang, it got tiring.”
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: Marco深入研究了Android的音频功能。他的第一个项目是增加日益重要的选择不同铃声的功能。“不是我不喜欢那首歌，而是当你听到每隔几分钟别人电话响起时都听到同样的声音，实在是让人烦。”
- en: He continued working on sound and multimedia in general. He added sound capabilities
    to the simulator (which was used by the team for debugging their software), and
    eventually wrote the first music app for Android. He also later wrote a couple
    of the first Live Wallpapers (sound and music visualizers) for the Eclair (Android
    2.1) release, which shipped with the Nexus One.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 他继续从事声音和多媒体方面的工作。他为模拟器（团队用于调试软件的工具）增加了音频功能，并最终编写了Android的第一个音乐应用程序。他还为Eclair（Android
    2.1）版本编写了几个首批动态壁纸（声音和音乐可视化效果），这些壁纸与Nexus One一同发布。
- en: AudioFlinger
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: AudioFlinger
- en: Another audio problem that had to be solved was for the G1\. The original HTC
    audio drivers for that device were so buggy that even doing something as simple
    as trying to play a second sound while one was already playing would reboot the
    device. The Android team didn’t have access to the source code for that driver,
    so they worked around the problem by introducing a layer on top of the driver
    called AudioFlinger.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个需要解决的音频问题是G1的音频问题。该设备的原HTC音频驱动程序有很多BUG，甚至像在已经播放的声音上同时播放第二个声音这样简单的操作都会导致设备重启。Android团队无法访问该驱动程序的源代码，因此他们通过在驱动程序之上增加一个名为AudioFlinger的层来规避这个问题。
- en: Mathias came up with the name, based on his experience writing SurfaceFlinger.
    SufaceFlinger solved a related problem on the graphics side, where many applications
    produced buffers of pixel data that SurfaceFlinger displayed on the screen. Similarly,
    AudioFlinger combined multiple audio streams across the system into a single stream
    which would then be sent to the driver without (and this is the key part) causing
    the device to reboot. Mathias worked with Marco, Arve, and Ficus to get it working
    for the G1\. It was only supposed to be a temporary workaround in the platform
    for that specific device, but as often happens in software, it lived on far past
    its usefulness until it was finally rewritten so that the system could talk more
    directly to drivers that didn’t have those historical problems.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: Mathias根据自己编写SurfaceFlinger的经验想出了这个名字。SurfaceFlinger解决了图形方面的一个相关问题，许多应用程序生成像素数据缓冲区，SurfaceFlinger将这些缓冲区显示在屏幕上。类似地，AudioFlinger将系统中的多个音频流合并成一个流，然后发送到驱动程序，而不会（这是关键部分）导致设备重启。Mathias与Marco、Arve和Ficus合作，成功地为G1实现了它。它本应只是该平台针对特定设备的临时解决方案，但正如软件中常见的情况一样，它在超出其有效性之后仍然存在，直到最终被重写，以便系统能够更直接地与没有这些历史问题的驱动程序进行通信。
- en: The Video Code Nobody Liked
  id: totrans-24
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 没人喜欢的视频代码
- en: Handling video is complicated. For one thing, video needs codecs^([4](#c12-footnote-4))
    to load and save video files. Video software also needs the capability to play
    content that has been loaded by a codec. And once you have all of that working,
    you need to optimize it to happen quickly, because a video that can’t play smoothly
    is less “video” and more “frustrating.”
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 处理视频很复杂。首先，视频需要编解码器^([4](#c12-footnote-4))来加载和保存视频文件。视频软件还需要能够播放由编解码器加载的内容。一旦这些工作都完成，你还需要对其进行优化，以便快速完成，因为无法流畅播放的视频就不再是“视频”，而更像是“让人沮丧”。
- en: Meanwhile, the software needs to be able to talk to the hardware, which is tricky
    because video-specific hardware can vary widely between devices.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 与此同时，软件需要能够与硬件进行通信，这很棘手，因为专用视频硬件在不同设备之间可能差异很大。
- en: With such a small team, it would have been difficult to implement everything
    that video required. So Andy made the decision to buy the necessary technology
    instead of writing it in-house. He asked Ficus Kirkpatrick to check out some options,
    but had him focus on a company called PacketVideo. PacketVideo, at the time, licensed
    an entire suite of software to do all of what Android needed.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 由于团队规模如此之小，实施视频所需的一切会非常困难。所以Andy决定购买必要的技术，而不是自己编写。他让Ficus Kirkpatrick查看一些选项，但让他专注于一家名为PacketVideo的公司。当时，PacketVideo许可了一个完整的软件套件，可以实现Android所需要的所有功能。
- en: 'The deal was going to happen; Ficus’s investigation was more like a sanity-check
    than a deep analysis. Ficus remembered, “Andy told me he was going to do the deal
    no matter what.” Like the rest of the team, he was busy with other things at the
    time, and it seemed like a foregone conclusion, so he didn’t spend a lot of time
    evaluating the situation: “I didn’t think it mattered. I didn’t think the code
    was good, but didn’t speak up.”'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 交易即将达成；Ficus的调查更像是一次理智检查，而非深入分析。Ficus记得，“Andy告诉我，无论如何他都会做这笔交易。”像团队其他成员一样，他当时忙于其他事情，看起来这笔交易是板上钉钉的结论，所以他没有花太多时间去评估情况：“我当时觉得这无关紧要。我认为代码不好，但没有提出异议。”
- en: He briefly investigated other options. He vetoed one of the alternatives because
    of the state of their code. That other company was so focused on making their
    product work on Windows that they baked assumptions into the software that made
    it unusable on any other OS (such as Linux, which was what Android needed). Comparatively,
    PacketVideo was a better choice. “It was probably the least awful of the media
    frameworks I looked at.”
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 他简要调查了其他选项。他否决了一个替代方案，因为他们的代码状态。那家公司过于专注于让他们的产品在Windows上运行，以至于在软件中埋入了假设，使其无法在任何其他操作系统上使用（比如Linux，这是Android所需要的）。相比之下，PacketVideo是一个更好的选择。“它可能是我看过的所有媒体框架中最不糟糕的。”
- en: The deal that Andy was proposing was awkward for PacketVideo; he was proposing
    to give away the core of their business. The company made its money from licensing
    their video software. Android needed not only the functionality of their code,
    but also the code itself. Android was planning to open source all of the code
    for the platform, including PacketVideo’s code. So the deal Andy proposed was
    that Android would take their software and publish it in the open, essentially
    destroying any future licensing possibilities they might have had, because any
    potential clients could just copy the Android code. Ficus said, “Andy’s pitch
    to them was, ‘Your business is going to change from licensing to professional
    services. We will give you some money to bridge the transition.’”
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: Andy提出的交易对PacketVideo来说很尴尬；他提出的方案是将他们业务的核心部分交出去。这家公司通过许可他们的视频软件赚钱。Android不仅需要他们代码的功能，还需要代码本身。Android计划将平台的所有代码开源，包括PacketVideo的代码。所以Andy提出的交易是，Android将拿走他们的软件并公开发布，实质上摧毁了他们未来的任何许可可能性，因为任何潜在客户都可以直接复制Android代码。Ficus说：“Andy向他们推销的说法是，‘你们的业务将从许可转向专业服务。我们会给你们一些钱，以帮助你们过渡。’”
- en: The deal was done (with the help of Tom Moss^([5](#c12-footnote-5))), the code
    was integrated, and the Android team was . . . not happy.^([6](#c12-footnote-6))
    Ficus remembered, “The code was not very good. Optimizing it was really hard.”
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 交易达成了（在Tom Moss^([5](#c12-footnote-5)))的帮助下），代码已经集成，而Android团队却……不高兴。^([6](#c12-footnote-6))
    Ficus 记得说：“代码不是很好，优化起来真的很困难。”
- en: 'Mathias Agopian agreed. “It was a disaster, from a technical standpoint. PacketVideo
    on paper was really good: tons of codecs, playback, recording, video, audio. On
    paper, problem solved. But we spent many, many, many years fixing and eventually
    rewriting everything.”'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: Mathias Agopian 同意了。“从技术角度来看，这是个灾难。PacketVideo在纸面上看起来真的很不错：大量的编解码器、播放、录制、视频、音频。从纸面上看，问题解决了。但我们花了许多许多年修复，最终重写了一切。”
- en: 'Ficus continued: “Probably my only good contribution was refusing to ship their
    API and only shipping the extremely simple MediaPlayer/MediaRecorder [APIs]. This
    was a low complexity, low capability API that made it possible to move a lot of
    the stuff around under the hood.” That is, by offering only simple and generic
    video capabilities to application developers, instead of exposing more advanced
    PacketVideo features directly, Ficus ensured that the details of how video was
    implemented could change later, when the team had more time to deal with the problem.'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: Ficus 继续说道：“可能我唯一的好贡献就是拒绝发布他们的API，只发布了极其简单的 MediaPlayer/MediaRecorder [API]。这是一个低复杂度、低能力的API，它使得很多内部工作得以重构。”也就是说，通过只向应用开发者提供简单且通用的视频功能，而不是直接暴露更先进的PacketVideo功能，Ficus
    确保了视频实现的细节可以在之后发生变化，当团队有更多时间处理这个问题时。
- en: In fact, this was what eventually happened. Years later, this layer of the system
    was completely rewritten as a component called *stagefright*. Andreas Huber, an
    engineer on the media team at the time, had been steadily rewriting portions of
    the PacketVideo code. Eventually he realized that the old code wasn’t being called
    anymore, so he deleted it and the PacketVideo code was no more.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 事实上，最终确实发生了这种情况。几年后，这一层系统被完全重写，成为了一个名为*stagefright*的组件。Andreas Huber，当时媒体团队的一名工程师，一直在稳步重写PacketVideo代码的部分内容。最终他意识到旧代码再也没有被调用，于是他删除了它，PacketVideo的代码也就此消失了。
