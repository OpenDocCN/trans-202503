- en: '12'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '12'
- en: Moon on the Water
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 水面上的月亮
- en: After making an agreement with your lord, you should lure the enemy out with
    bait to infiltrate their defenses.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 与你的主公达成协议后，你应该用诱饵引诱敌人，潜入他们的防线。
- en: In this technique, you should lure the enemy with tempting bait, like fishing
    in the sea or a river, so as to make an enemy who will not normally come out in
    fact leave its defenses.
  id: totrans-3
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在此技巧中，你应该像在海中或河里钓鱼一样，用诱人的诱饵引诱敌人，以使原本不会现身的敌人最终离开防线。
- en: ''
  id: totrans-4
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: —Bansenshūkai, Yo-nin II ^([1](b01.xhtml#endnote-83))
  id: totrans-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: —《万川集海》，Yo-nin II ^([1](b01.xhtml#endnote-83))
- en: With an image straight out of a haiku, *Bansenshūkai* calls an open-disguise
    infiltration technique *suigetsu no jutsu*—the art of the “moon on the water.”^([2](b01.xhtml#endnote-84))
    While the technique had many uses, shinobi used it primarily to target heavily
    fortified enemy camps—the kind that restricted people from leaving, entering,
    or even approaching. Instead of penetrating the camp’s defenses by force, shinobi
    would lure out their target, effectively tricking them into giving away ingress
    protocols such as insignias and other identifying marks, passwords, code words,
    and challenge-response signals. This technique also let shinobi tail targets as
    they returned to camp, lure defenders from their guard posts and infiltrate without
    resistance, or interact directly with targets and infiltrate through deception
    or offensive measures.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在如同俳句般的意境中，*万川集海*称开放伪装潜入技巧为*水月之术*——“水面上的月亮”之术。^([2](b01.xhtml#endnote-84)) 尽管该术有多种用途，但忍者主要用于攻击那些防守森严的敌人营地——这种营地限制了人员的进出，甚至无法接近。忍者并不是通过强行突破营地防线，而是诱使目标现身，巧妙地引诱目标泄露入营的相关规定，例如徽章及其他身份标志、密码、口令和挑战应答信号。此术还允许忍者尾随目标返回营地，诱使守卫离开岗哨并无阻渗透，或者直接与目标接触并通过欺骗或攻击手段渗透。
- en: For targets especially reluctant to leave their heavily fortified defenses,
    the scroll instructs shinobi to seek help from their commanders to conduct advanced
    deceptions.^([3](b01.xhtml#endnote-85)) For example, a commander could move forces
    into vulnerable positions, enticing the enemy to attack and thereby depleting
    the enemy’s defenses enough for shinobi to infiltrate. Alternatively, the shinobi
    would overpower the enemy when they returned, battle weary. The commander might
    even stage something more elaborate, like the beginning of a full-on, long-term
    castle siege. Then, shinobi might send a soldier posing as an allied general’s
    messenger to convince the enemy to leave their castle, join in a counteroffensive,
    and break the siege. To complete the ruse, the shinobi commander would send a
    small force to masquerade as allied reinforcements, both luring the target from
    their encampment and allowing shinobi to infiltrate while the gates were open.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 对于那些特别不愿离开防守严密的目标，卷轴指示忍者寻求指挥官的帮助，进行高级的欺骗策略。^([3](b01.xhtml#endnote-85)) 例如，指挥官可以将部队调动到脆弱位置，诱使敌人攻击，从而消耗敌人的防御，使忍者得以渗透。或者，忍者在敌人疲惫归营时击败他们。指挥官甚至可能安排更为复杂的方案，比如开始一场全面的长期城堡围攻。然后，忍者可能派遣一名伪装成盟军将军使者的士兵，劝说敌人离开城堡，参与反攻并打破围攻。为了完成这个诡计，忍者指挥官会派遣一支小队伪装成盟军增援，不仅引诱目标离开营地，也让忍者在城门打开时得以渗透。
- en: 'According to the scroll, after shinobi successfully infiltrated the target
    using *suigetsu no jutsu*, they had to keep these thoughts in mind:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 根据卷轴内容，在忍者成功使用*水月之术*潜入目标后，他们必须牢记以下思维：
- en: Remain calm. Do not appear lost.
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 保持冷静，不要表现出迷失。
- en: Mimic the people in the castle.
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模仿城中人。
- en: Prioritize collecting code words, passwords, challenge responses, and insignias.
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 优先收集口令、密码、挑战应答、徽章等信息。
- en: Signal to allies as soon as possible.^([4](b01.xhtml#endnote-86))
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 尽快向盟友发出信号。^([4](b01.xhtml#endnote-86))
- en: In this chapter, we will explore the ways this ancient technique could be deployed
    by a cyber threat actor and compare it to commonly used social engineering tactics.
    We’ll introduce a way to think abstractly about network communication signals
    as entering and/or leaving perimeters—despite the computer system’s not physically
    moving—and detail concepts for countering the moon on the water technique and
    social engineering attacks in general. Lastly, we’ll attempt a thought exercise
    scenario that mimics the conundrum ancient Japanese generals must have faced when
    targeted by moon on the water.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一章中，我们将探讨这种古老技术如何被网络威胁行为者部署，并与常见的社会工程学战术进行比较。我们将介绍一种抽象思考网络通信信号的方式，认为它们进入和/或离开防火墙——尽管计算机系统本身并未发生物理移动——并详细讲解应对“水面月亮”技术和社会工程学攻击的概念。最后，我们将尝试一个思维练习场景，模拟古代日本将军们在遭遇“水面月亮”攻击时可能面临的困境。
- en: Social Engineering
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 社会工程学
- en: 'The shinobi moon on the water attack bears a striking similarity to today’s
    *social engineering* attacks, which exploit a human target’s decision-making processes
    and cognitive biases to manipulate them into revealing sensitive information or
    performing self-defeating actions. In cybersecurity, most social engineering tactics
    are used by adversaries operating inside enemy territory to exploit the target’s
    trust. Examples of typical social engineering attacks include:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 忍者“水面月亮”攻击与今天的*社会工程学*攻击有惊人的相似之处，它们利用人类目标的决策过程和认知偏差，操控目标泄露敏感信息或执行自毁性行动。在网络安全中，大多数社会工程学战术是敌方在敌人阵地内部操作，利用目标的信任进行攻击。典型的社会工程学攻击示例包括：
- en: Phishing The adversary sends an email that convinces its recipients to open
    a dangerous document or visit a malicious hyperlink, resulting in malware infection,
    ransomware execution, data theft, or other attacks.
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 网络钓鱼 敌方发送一封邮件，诱使收件人打开危险的文档或访问恶意链接，导致恶意软件感染、勒索软件执行、数据盗窃或其他攻击。
- en: Pretexting The adversary calls or emails with invented scenarios designed to
    convince a target to reveal sensitive information or perform malicious actions.
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 伪装攻击 敌方通过电话或电子邮件，以编造的情景说服目标泄露敏感信息或执行恶意行动。
- en: Baiting The adversary strategically plants malicious portable media, such as
    a USB drive, in a physical location to entice the target to pick it up and connect
    it to internal systems, creating an opening for system compromise.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 诱饵攻击 敌方策略性地将恶意的可移动媒体（如 USB 驱动器）放置在物理位置上，诱使目标捡起并将其连接到内部系统，从而为系统入侵创造机会。
- en: Social engineering is a particularly challenging security problem because it
    exploits human nature in ways that technological controls cannot always defend
    against. As targets and victims become more aware of social engineering threats,
    many organizations lean on focused technical controls, security protocols, and
    user education to protect their valuable assets. Employees are trained in how
    to properly handle and care for sensitive information and systems, while security
    teams document procedures to verify the identity of unknown or unsolicited visitors
    and require physical escorts for non-employees on company grounds. Red teams conduct
    internal phishing and tailgating tests, among other exercises, to gauge employee
    awareness of and instill resistance to social engineering tactics. Administrators
    implement technical controls to block malicious documents and hyperlinks, employ
    data loss prevention (DLP) software, prevent unauthorized system changes, blacklist
    unregistered systems and external media, and use caller ID.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 社会工程学是一个特别具有挑战性的安全问题，因为它利用了人性上的弱点，而这些弱点是技术控制措施无法始终防范的。随着目标和受害者对社会工程学威胁的认识不断提高，许多组织依赖于专注的技术控制、安全协议和用户教育来保护其宝贵资产。员工接受如何正确处理和保护敏感信息和系统的培训，同时安全团队记录程序以验证陌生或未受邀请的访客身份，并要求非员工在公司场地内由员工陪同。红队进行内部钓鱼攻击和尾随测试等演练，以评估员工对社会工程学战术的意识并增强他们的抵抗力。管理员实施技术控制措施，以阻止恶意文档和链接，使用数据丢失防护（DLP）软件，防止未授权的系统变更，黑名单未注册的系统和外部媒体，并使用来电显示。
- en: While these are all good and necessary security measures, the way people work
    has changed. And thinking around social engineering attacks has not yet evolved
    to fully consider defending against moon on the water–style attacks—the kind that
    attempt to lure the target outside its own defenses.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管这些都是很好的、必要的安全措施，但人们的工作方式已经发生了变化。而且，围绕社会工程学攻击的思维尚未完全发展，无法充分考虑防御“月亮水面”式攻击——即试图诱使目标脱离自身防御的攻击。
- en: Today, things like bring your own device (BYOD) policies, full-time remote work,
    and multitenant clouds make workers and organizations more flexible. However,
    they also weaken traditionally strong perimeter security architectures and expose
    employees to new social engineering threats. For example, in most cases, stateful
    firewall rules do not permit external (internet) communication to pass through
    the firewall to an internal host. Instead, the firewall requires the internal
    (intranet) system to initiate contact before it allows responses from the external
    system to pass through to the internal host. So, while the internal host does
    not physically leave the organization’s defenses, doing so virtually—say, by visiting
    a malicious website—could allow threat actors to infiltrate within the responding
    communications. Essentially, this is digital tailgating.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 今天，像自带设备（BYOD）政策、全职远程工作和多租户云等，使得员工和组织更加灵活。然而，它们也削弱了传统的强大外围安全架构，并使员工暴露于新的社会工程学威胁中。例如，在大多数情况下，状态防火墙规则不允许外部（互联网）通信通过防火墙传递到内部主机。相反，防火墙要求内部（内网）系统发起联系，然后才允许外部系统的响应通过防火墙传递到内部主机。因此，虽然内部主机物理上没有离开组织的防御，但如果通过虚拟方式——比如访问恶意网站——就可能使威胁行为者通过响应通信渗透进来。本质上，这就是数字尾随。
- en: 'In addition to directly compromising traditional security architectures, threat
    actors could use a number of moon on the water–style techniques to infiltrate
    heavily fortified organizations. Consider the following scenarios:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 除了直接破坏传统的安全架构，威胁行为者还可以使用多种“月亮水面”式的技术渗透重防御组织。考虑以下场景：
- en: An adversary triggers a fire alarm within a secure facility, causing employees
    to exit en masse. While firefighters clear the building, the adversary blends
    into the crowd of employees to steal or document badges, keys, tokens, faces,
    fingerprints, and more. To ease the flow of employees returning to work, the facility
    temporarily turns off badge readers, turnstiles, or other physical access controls,
    or security is so overwhelmed by the flood of people that they don’t notice tailgating.
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一名攻击者在一个安全设施中触发火灾报警，导致员工大量撤离。当消防员清理建筑物时，攻击者混入员工人群中，窃取或记录徽章、钥匙、令牌、面孔、指纹等信息。为了顺畅处理员工返回工作，设施暂时关闭徽章读取器、旋转门或其他物理访问控制，或者由于人员涌入，安全人员被压得喘不过气来，未能注意到尾随进入。
- en: An adversary uses a food truck to lure employees from a secure facility. Then
    they leverage their own status as a non-initiator to perform quid pro quo social
    engineering on a target, eventually developing a rapport and convincing the target
    to perform actions they would not in a traditional social engineering scenario.
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一名攻击者使用餐车诱使员工离开安全设施。然后，他们利用自己作为非发起者的身份，通过互惠互利的社会工程学手段对目标进行操作，最终与目标建立关系，并说服目标执行他们在传统社会工程学场景中不会执行的行为。
- en: An adversary compromises the Wi-Fi network at a café across the street from
    a business conference to steal the credentials of a target organization’s employees.
    By entering the café with their devices, those employees have left their organization’s
    defenses and unknowingly exposed themselves to an environment controlled by the
    adversary.
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一名攻击者在街对面的咖啡馆破坏了 Wi-Fi 网络，以窃取目标组织员工的凭证。通过进入咖啡馆并使用他们的设备，这些员工无意间脱离了组织的防御，暴露在攻击者控制的环境中。
- en: An adversary conducts large-scale disruptive, denial, or destructive attacks
    against targeted people, systems, and data, prompting them to move to a less secure
    disaster recovery operation site that is easier to infiltrate than the organization’s
    permanent headquarters.
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一名攻击者对目标人物、系统和数据进行大规模的破坏性、拒绝服务或破坏性攻击，迫使他们转移到一个不如组织永久总部安全的灾难恢复站点，易于被渗透。
- en: Note that while these attacks might not necessarily achieve an adversary’s end
    goal, they could provide means or information that, in conjunction with other
    exploits, accomplishes malicious objectives.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，虽然这些攻击不一定能达到对手的最终目标，但它们可能提供手段或信息，结合其他漏洞，达成恶意目的。
- en: Defenses Against Social Engineering
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 防御社会工程学攻击
- en: Most organizations perform social engineering awareness training and routinely
    phish test internal staff. While this strategy improves resiliency to such attacks,
    a significant percentage of personnel always fail. Unfortunately, most organizations
    leave staff vulnerable to social engineering. We need to do more to give employees
    the tools they need to guard against such deceptions.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数组织进行社会工程学意识培训，并定期对内部员工进行钓鱼测试。虽然这种策略提高了对这种攻击的抵抗力，但仍有相当一部分人员总是会失败。不幸的是，大多数组织仍然让员工面临社会工程学的漏洞。我们需要做更多的工作，为员工提供防范这种欺骗的工具。
- en: '*Establish safeguards.* Implement standard trust frameworks for employees to
    reduce the risk of compromise by social engineering. Identify high-value targets
    in your environment, and then establish security protocols, policies, and procedures
    for the appropriate control and handling of sensitive information on those systems
    (expand these to all systems over time). Conduct training, awareness, and test
    exercises within your organization to raise the level of employee awareness around
    social engineering, along with iterative threat modeling to review and improve
    related security controls.'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*建立保护措施*。为员工实施标准的信任框架，以减少社会工程学带来的风险。识别您环境中的高价值目标，然后为这些系统上敏感信息的适当控制和处理建立安全协议、政策和程序（并随着时间的推移将这些扩展到所有系统）。在您的组织内部进行培训、意识提升和测试演习，以提高员工对社会工程学的认识，并通过反复的威胁建模来审查和改进相关的安全控制。'
- en: '*Implement “slow thinking.”* Distribute and discuss Daniel Kahneman’s book
    *Thinking, Fast and Slow*^([5](b01.xhtml#endnote-87))with your security team.
    The book describes two systems of thought: the quicker, more impulsive “System
    1” and the slower, more logical “System 2.” Develop solutions that force your
    employees to slow down and think in System 2 terms, thereby avoiding the cognitive
    biases and shortcuts social engineers most often exploit. Possible examples include:'
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*实施“慢思考”*。与您的安全团队一起分发并讨论丹尼尔·卡尼曼的书《思考，快与慢》^([5](b01.xhtml#endnote-87))。这本书描述了两种思维系统：较快且更具冲动性的“系统1”和较慢且更具逻辑性的“系统2”。制定强迫员工放慢速度并以系统2的方式思考的解决方案，从而避免社会工程师最常利用的认知偏差和捷径。可能的例子包括：'
- en: Configuring your phone-switching system to require an employee who receives
    an external call to punch in the even digits of the caller’s phone number before
    the system can connect.
  id: totrans-32
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置您的电话交换系统，要求接到外部电话的员工在系统连接之前输入来电者电话号码的偶数位数字。
- en: Configuring your mail client so that employees must type the “from” email address
    backward before they can open external email attachments.
  id: totrans-33
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置您的邮件客户端，要求员工必须将“发件人”邮箱地址倒着输入，才能打开外部邮件附件。
- en: Requiring users visiting non-whitelisted URLs to correctly enter the number
    of characters in the domain before the browser performs a DNS query.
  id: totrans-34
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要求访问非白名单URL的用户，在浏览器执行DNS查询之前，正确输入域名中的字符数。
- en: All these measures will slow down business operations, but they also help mitigate
    social engineering attacks.
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 所有这些措施都会减缓业务操作，但也有助于缓解社会工程学攻击。
- en: Recommended Security Controls and Mitigations
  id: totrans-36
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 推荐的安全控制和缓解措施
- en: Where relevant, recommendations are presented with applicable security controls
    from the NIST 800-53 standard. Each should be evaluated with the concept of moon
    on the water in mind.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在相关情况下，提出的建议会结合NIST 800-53标准中的适用安全控制进行展示。每个建议都应在心中考虑“月亮在水面”的概念来进行评估。
- en: 'Because security systems and controls can protect information only within established
    boundaries, implement safeguards that stop information and systems from passing
    beyond those boundaries and falling into the hands of social engineers. [AC-3:
    Access Enforcement | (9) Controlled Release; PE-3: Physical Access Control | (2)
    Facility/Information System Boundaries; SC-7: Boundary Protection]'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '因为安全系统和控制只能在已设定的边界内保护信息，所以需要实施保护措施，防止信息和系统超出这些边界，落入社会工程师手中。[AC-3: 访问执行 | (9)
    受控释放; PE-3: 物理访问控制 | (2) 设施/信息系统边界; SC-7: 边界保护]'
- en: 'Control your information flow so that even when data goes beyond the normal
    protective boundaries, it is not allowed to travel to or between unauthorized
    information systems. [AC-4: Information Flow Enforcement; PL-8: Information Security
    Architecture; SC-8: Transmission Confidentiality and Integrity]'
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '控制信息流动，以确保即使数据超出了正常的保护边界，也不会被传输到未授权的信息系统之间或其中。[AC-4: 信息流执行；PL-8: 信息安全架构；SC-8:
    传输机密性与完整性]'
- en: 'For all non-local (that is, through a network) system maintenance, establish
    approval protocols, require strong authenticators and documented policies, and
    implement monitoring. [MA-4: Nonlocal Maintenance]'
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '对于所有非本地（即通过网络）系统维护，建立审批协议，要求使用强身份验证器和记录政策，并实施监控。[MA-4: 非本地维护]'
- en: 'Establish protections for data outside controlled areas and restrict data-handling
    activities to authorized persons. [MP-5: Media Transport | (1) Protection Outside
    Controlled Areas]'
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '为受控区域外的数据建立保护措施，并将数据处理活动限制在授权人员之间。[MP-5: 媒体传输 | (1) 受控区域外的保护]'
- en: Debrief
  id: totrans-42
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 简报
- en: In this chapter, we described the advanced shinobi technique of moon on the
    water. We looked at various scenarios in which the moon on the water technique
    could be modernized to target businesses. We explored the challenges that social
    engineering presents and the various forms it can take. We reviewed existing security
    practices designed to handle social engineering and examined new defense concepts.
    And we lifted a thought exercise from the shinobi scrolls to demonstrate how fragile
    our trust model is and how hard it can be to safeguard against social engineering.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们描述了“水面月光”这一高级忍者技艺。我们探讨了如何将这一技艺现代化，以便针对商业目标进行应用的各种场景。我们讨论了社交工程所带来的挑战及其可能呈现的多种形式。我们回顾了现有的安全实践，旨在应对社交工程攻击，并审视了新的防御概念。我们还从忍者卷轴中提取了一项思维练习，展示了我们的信任模型是多么脆弱，以及如何防范社交工程攻击的难度。
- en: In the next chapter, we will discuss insider threats—one of the most fascinating
    topics in security. The shinobi scrolls provide detailed instructions on how to
    identify people who could be recruited as insiders with the help of some social
    engineering techniques—and they suggest a way to defend against insider threats
    that is contrary to modern best practices.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将讨论内部威胁——这是安全领域最引人入胜的话题之一。忍者卷轴提供了关于如何识别可能被招募为内部人员的详细指南，并指出了与现代最佳实践相悖的一种防御内部威胁的方法。
