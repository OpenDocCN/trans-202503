- en: '**1**'
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**1**'
- en: '**STORAGE MEDIA OVERVIEW**'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '**存储介质概述**'
- en: '![image](../images/common-01.jpg)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/common-01.jpg)'
- en: This chapter serves as an overview of PC bus systems, common mass storage media,
    physical connectors and interfaces, and the low-level protocol commands used to
    communicate with attached storage devices. It also provides the background for
    understanding the forensic acquisition of storage media described in the rest
    of the book.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章提供了PC总线系统、常见大容量存储介质、物理连接器和接口的概述，并介绍了用于与附加存储设备通信的低级协议命令。它还为理解本书其余部分中描述的存储介质的取证获取提供了背景。
- en: 'In general, mass storage technologies are grouped into three broad categories:
    magnetic media, non-volatile memory (flash), and optical media. Storage media
    can be built into a device or be removable. The device also contains the drive
    electronics needed to interface with the media. Storage devices are accessed by
    a system through an internal or external bus or interface.'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 一般来说，大容量存储技术分为三大类：磁性介质、非易失性存储器（闪存）和光学介质。存储介质可以集成到设备中，也可以是可拆卸的。设备还包含与介质接口所需的驱动电子组件。系统通过内部或外部总线或接口访问存储设备。
- en: The chapter begins with overviews of these three storage technologies and touches
    on key points related to digital forensics. The final two sections describe how
    these storage devices attach to and communicate with a Linux system, and I discuss
    items of particular interest to a forensic examiner.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章首先概述这三种存储技术，并简要介绍与数字取证相关的关键点。最后两节描述了这些存储设备如何连接并与Linux系统进行通信，我还讨论了对取证审查员特别感兴趣的项目。
- en: This chapter primarily focuses on modern PC architectures and components. Former
    popular legacy technologies might be mentioned but not covered in depth. I’ve
    also limited this overview to computer equipment used in small server environments
    and by individuals (employees, home users, and so on) rather than covering large
    enterprise technology. Storage technologies in large enterprise environments are
    not always suited for traditional disk media forensic imaging; in some cases,
    the sheer volume of storage space makes traditional acquisition infeasible, and
    business-critical enterprise systems typically can’t be taken offline like smaller
    PC-based systems.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 本章主要关注现代PC架构和组件。曾经流行的老旧技术可能会提到，但不会深入讨论。我还将本概述限制在小型服务器环境和个人（员工、家庭用户等）使用的计算机设备上，而不会涉及大型企业技术。大型企业环境中的存储技术通常不适合传统磁盘介质的取证成像；在某些情况下，由于存储空间的庞大，传统的获取方法不可行，而企业级的关键系统通常无法像小型PC系统那样下线。
- en: '**Magnetic Storage Media**'
  id: totrans-7
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**磁性存储介质**'
- en: Magnetic media is the oldest of the three basic storage technologies (preceded
    by paper tape and punch cards) and is the current leader in capacity. The two
    primary magnetic storage media types in use today are hard disks and tapes; both
    provide high capacity and reliability for online storage and offline archival
    storage.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 磁性介质是三种基本存储技术中最古老的一种（之前是纸带和打孔卡片），并且目前在容量上处于领先地位。当前使用的两种主要磁性存储介质类型是硬盘和磁带；这两者都为在线存储和离线归档存储提供了高容量和高可靠性。
- en: '**NOTE**'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*The capacity race between magnetic disks and solid state drives (SSDs) is
    heating up. During the writing of this book, a 16TB SSD was announced and, when
    released, could be the world’s largest disk.*'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '*磁盘和固态硬盘（SSD）之间的容量竞争正在加剧。在本书编写过程中，宣布发布了一款16TB的SSD，并且一旦发布，它可能成为全球容量最大的磁盘。*'
- en: '***Hard Disks***'
  id: totrans-11
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***硬盘***'
- en: Hard disks have consistently provided higher capacities than other media, such
    as SSD or optical. As of this writing, 10TB hard disks are available on the consumer
    market, and higher capacities are expected.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 硬盘一贯提供比其他介质（如SSD或光盘）更高的容量。截至目前，10TB硬盘已经在消费者市场上有售，并且预计会有更大容量的硬盘发布。
- en: Hard disks are built with rotating platters coated with magnetized material,
    as shown in [Figure 1-1](ch01.xhtml#ch1fig1). Multiple platters are stacked on
    a spindle, and read/write heads on a movable arm (the *actuator*) can read/write
    encoded data from/to the magnetic surface. Currently, common hard disk form factor
    sizes include 3.5 inch, 2.5 inch, and 1.8 inch. Because hard disks are mechanical
    devices, they’re sensitive to shock, dropping, dust, moisture, and other environmental
    factors. Typical hard disk failures involve scratched platter surfaces, stuck
    or damaged heads, motor failure, and failed electronic circuitry.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 硬盘由涂有磁性材料的旋转盘片构成，如[图1-1](ch01.xhtml#ch1fig1)所示。多个盘片堆叠在主轴上，读写磁头通过一个可移动的臂（*执行器*）从磁性表面读取/写入编码数据。目前，常见的硬盘外形尺寸包括3.5英寸、2.5英寸和1.8英寸。由于硬盘是机械设备，它们对震动、跌落、灰尘、湿气和其他环境因素非常敏感。典型的硬盘故障包括划伤的盘片表面、卡住或损坏的磁头、电机故障和电子电路故障。
- en: The real physical geometry (heads, platters, tracks, sectors per track) of the
    disk is abstracted from the computer and is accessible as a sequence of sectors
    using Logical Block Addresses (LBA). A sector is the smallest addressable disk
    unit for reading and writing data. Historically, the standard physical hard disk
    sector size was 512 bytes; however, modern disks have transitioned to 4K sector
    sizes. Most current drives continue to provide a 512-byte emulation of the sector
    size, but drives with a native 4K sector size (known as 4Kn drives) are already
    on the market. Using 4Kn disks has performance advantages, and it’s likely they’ll
    someday overtake traditional 512-byte emulated drives. Refer to “[Advanced Format
    4Kn](ch01.xhtml#ch01lev2sec25)” on [page 41](ch01.xhtml#page_41) for more detail
    about 4Kn disk drives.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 硬盘的真实物理几何结构（磁头、盘片、磁道、每个磁道的扇区）对计算机进行了抽象，并通过逻辑块地址（LBA）作为一系列扇区进行访问。扇区是用于读写数据的最小可寻址磁盘单元。历史上，标准的物理硬盘扇区大小为512字节；然而，现代硬盘已转向4K扇区大小。大多数当前的硬盘仍提供512字节的扇区大小仿真，但具有原生4K扇区大小（称为4Kn硬盘）的驱动器已经上市。使用4Kn硬盘具有性能优势，未来它们可能会取代传统的512字节仿真硬盘。有关4Kn硬盘驱动器的更多细节，请参阅[“高级格式4Kn”](ch01.xhtml#ch01lev2sec25)，见[第41页](ch01.xhtml#page_41)。
- en: '![image](../images/f01-01.jpg)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-01.jpg)'
- en: '*Figure 1-1: Magnetic hard disk*'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '*图1-1：磁性硬盘*'
- en: Traditional computer forensics originated from the need to analyze hard disks,
    which continue to be significant evidence sources today. In particular, when an
    OS “deletes” a file, it simply unlinks any references to the data blocks on the
    disk (unlike SSDs, which use a TRIM command to clear unallocated blocks). Those
    blocks are not erased from the magnetic platters, remaining on the disk where
    forensic tools can recover them (until they’re overwritten).
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 传统的计算机取证起源于需要分析硬盘，而硬盘至今仍然是重要的证据来源。特别是，当操作系统“删除”文件时，它只是取消了对磁盘上数据块的引用（与固态硬盘不同，固态硬盘使用TRIM命令清除未分配的块）。这些数据块并不会从磁性盘片中删除，而是保留在磁盘上，取证工具可以恢复它们（直到它们被覆盖）。
- en: '***Magnetic Tapes***'
  id: totrans-18
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***磁带***'
- en: The use of magnetic tapes in the home user marketplace has nearly disappeared,
    but small business and enterprise environments continue to use magnetic tapes
    for backups and archiving. Tapes, as shown in [Figure 1-2](ch01.xhtml#ch1fig2),
    are one of the earlier forms of digital storage and have a reputation as a mature
    technology, reliable for long-term offline storage. Unlike disks, SSD/flash, or
    optical disks, tapes can only read or write data sequentially. Randomly accessing
    different blocks on a tape requires the user to rewind or forward the tape to
    the desired location before it can be read or written. This lack of random block
    access prevents tapes from being used as regular filesystems. Data is stored on
    tapes as a sequence of tape files; each file is typically an archive containing
    a filesystem or group of files and directories (using archive formats, such as
    TAR, DUMP, and so on.). Tape drives are controlled using SCSI tape commands to
    read and write data, position or rewind the tape, and eject the tape.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 磁带在家庭用户市场中的使用几乎已经消失，但小型企业和企业环境仍然使用磁带进行备份和归档。如[图1-2](ch01.xhtml#ch1fig2)所示，磁带是早期数字存储形式之一，并且有着成熟技术的声誉，可靠用于长期离线存储。与磁盘、固态硬盘/闪存或光盘不同，磁带只能按顺序读取或写入数据。在磁带上随机访问不同的块，需要用户将磁带倒带或快进到所需的位置才能进行读取或写入。这种缺乏随机块访问的特性使得磁带无法作为常规文件系统使用。数据以磁带文件的序列存储在磁带上；每个文件通常是一个包含文件系统或文件和目录组的归档文件（使用诸如TAR、DUMP等归档格式）。磁带驱动器使用SCSI磁带命令来控制读写数据、定位或倒带磁带，并弹出磁带。
- en: '**NOTE**'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*Newer Linear Tape-Open, or LTO, drives can simulate a regular filesystem with
    the Linear Tape File System (LTFS), but this is not random access and files are
    still sequentially read and written.*'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '*更新的线性磁带开放（LTO）驱动器可以通过线性磁带文件系统（LTFS）模拟常规文件系统，但这仍然不是随机访问，文件依然是按顺序读取和写入的。*'
- en: '![image](../images/f01-02.jpg)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-02.jpg)'
- en: '*Figure 1-2: Magnetic tapes*'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '*图1-2：磁带*'
- en: 'Here are some examples of a Fibre Channel LTO5 tape drive and a USB DAT160
    tape drive; both are attached to a Linux system. The dmesg output of the tape
    drives looks like this:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是Fibre Channel LTO5磁带驱动器和USB DAT160磁带驱动器的示例；它们都连接到Linux系统上。磁带驱动器的dmesg输出如下所示：
- en: '[PRE0]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Once tape archive files have been written, an *End Of Data (EOD)* marker is
    also written to the tape. This informs the drive that the end of the tape data
    has arrived and prevents the drive from reading any further. From a forensics
    perspective, however, any data beyond the EOD marker is of interest because it
    may contain data from previous tape writes. No generic SCSI commands are available
    to acquire data beyond the EOD marker. Specialized tape drives and equipment are
    needed to complete this task.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦磁带归档文件被写入，*数据结束（EOD）*标记也会写入磁带。这通知驱动器磁带数据已经结束，防止驱动器继续读取。 然而，从取证的角度来看，EOD标记之后的任何数据都值得关注，因为它可能包含先前磁带写入的数据。没有通用的SCSI命令可以获取EOD标记之后的数据。需要专用的磁带驱动器和设备来完成此任务。
- en: '***Legacy Magnetic Storage***'
  id: totrans-27
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***传统磁存储***'
- en: There are many legacy magnetic storage types, especially among removable media.
    Floppy diskettes evolved over several generations before becoming obsolete. A
    number of proprietary storage products, such as Jaz, Zip, Syquest, and so on,
    were popular on the market during the ’80s and ’90s. A large variety of magnetic
    tapes are no longer in use, for example, 4mm DAT, 8mm Exabyte, and QIC. The forensic
    acquisition of these storage types is beyond the scope of this book. However,
    if functioning hardware and interfaces are available, you can acquire the data
    on most of these older devices using the same techniques described in this book.
    If the Linux kernel recognizes the sector-based media and it’s made available
    as a block device, you can acquire it. If the Linux kernel recognizes tape drives
    as SCSI tape devices, you can access them using standard SCSI tape commands. For
    proprietary storage, kernel drivers or userspace tools might be available, which
    can provide you with access to legacy storage products.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 许多传统的磁性存储类型，尤其是在可移动介质中，仍然存在。软盘经历了多个世代的发展后最终被淘汰。一些专有存储产品，如Jaz、Zip、Syquest等，在80年代和90年代曾在市场上广受欢迎。许多种类的磁带已不再使用，例如4mm
    DAT、8mm Exabyte和QIC。这些存储类型的取证获取超出了本书的讨论范围。然而，如果有功能正常的硬件和接口，您可以使用本书中描述的相同技术获取这些较旧设备上的数据。如果Linux内核能够识别基于扇区的介质并将其作为块设备提供，您就可以进行获取。如果Linux内核识别磁带驱动器为SCSI磁带设备，您可以使用标准SCSI磁带命令进行访问。对于专有存储，可能会有内核驱动或用户空间工具，这些工具可以为您提供访问传统存储产品的能力。
- en: '**Non-Volatile Memory**'
  id: totrans-29
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**非易失性内存**'
- en: Non-volatile memory, typically using NAND flash technology, is growing in popularity
    and starting to replace magnetic hard disks in situations where very large capacities
    are not needed. (*NAND* refers to transistors operating as a logical NAND gate.)
    This type of memory creates a new set of challenges for forensic investigators
    because it doesn’t exhibit the same low-level properties as magnetic disks.^([1](footnote.xhtml#fn05))
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 非易失性内存，通常使用NAND闪存技术，正在逐渐普及，并开始在不需要非常大容量的情况下替代磁性硬盘。（*NAND*指的是作为逻辑NAND门工作的晶体管。）这种类型的内存给取证调查员带来了新的挑战，因为它不具备与磁盘相同的低级特性。^([1](footnote.xhtml#fn05))
- en: SSD and flash media are typically NAND-based storage and have no moving parts.
    Data is stored in an array of memory cells, and a layer of abstraction, the *Flash
    Translation Layer (FTL)*, makes the drive behave as a linear sequence of sectors
    similar to a hard disk. Because non-volatile memory disks are implemented in circuitry
    and are not mechanical, they are silent, use less power, and do not suffer from
    the same risk of physical damage as hard disks do. In terms of performance, they
    can randomly access and write data faster because there are no physical heads
    seeking to locations on a disk. (This also means there’s no performance advantage
    to defragmenting filesystems.) The memory in SSD/flash drives doesn’t have the
    same longevity as the magnetic platters in hard disks. Certain methods, such as
    wear leveling and over-provisioning, are used to prolong the life of SSD media.
    *Wear leveling* refers to the mechanism used to distribute reads and writes across
    the drive, ensuring blocks are evenly used during the lifetime of the drive. As
    blocks deteriorate or become unwritable, they’re removed from use by the FTL and
    replaced with blocks from a pool of reserved (over-provisioned) blocks. These
    “retired” blocks can be read by removing (desoldering) the physical chips and
    reading out the memory. Some professional forensic laboratories perform this process,
    sometimes called *chip-off*, for various flash-based storage. Over-provisioning
    of blocks during manufacture can take up to 10 to 25 percent of a flash disk (which
    is inaccessible to the user). Currently, an open source SSD firmware project exists
    that is useful for learning and researching the underlying SSD technology. You
    can find more information about it at *[http://www.openssd-project.org/wiki/The_OpenSSD_Project](http://www.openssd-project.org/wiki/The_OpenSSD_Project)*.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: SSD和闪存媒体通常基于NAND存储，并且没有活动部件。数据存储在一组内存单元中，抽象层*闪存翻译层（FTL）*使得硬盘的行为像硬盘一样，表现为一系列线性的扇区。由于非易失性存储磁盘是通过电路实现的，而不是机械的，因此它们无声、功耗低，并且不像硬盘那样容易受到物理损坏。在性能方面，它们可以更快地随机访问和写入数据，因为没有物理磁头在硬盘上寻找位置。（这也意味着碎片整理文件系统并没有性能上的优势。）SSD/闪存驱动器中的内存寿命不如硬盘中的磁性盘片。采用一些方法，如磨损均衡和过度配置，用于延长SSD媒体的使用寿命。*磨损均衡*指的是将读取和写入操作均匀分布到整个硬盘的机制，确保在硬盘的使用寿命内块得到均匀使用。随着块的老化或无法写入，它们会被FTL移除，并由一池保留（过度配置）块替换。这些“退役”块可以通过移除（拆焊）物理芯片并读取内存来进行读取。一些专业的取证实验室会执行这一过程，有时称为*芯片取出*，用于各种基于闪存的存储设备。制造过程中对块的过度配置可以占用闪存磁盘的10%到25%（用户无法访问）。目前，有一个开源的SSD固件项目，对于学习和研究SSD技术非常有用。你可以在*
    [http://www.openssd-project.org/wiki/The_OpenSSD_Project](http://www.openssd-project.org/wiki/The_OpenSSD_Project)
    *上找到更多信息。
- en: '***Solid State Drives***'
  id: totrans-32
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***固态硬盘（SSD）***'
- en: The SSD, as shown in [Figure 1-3](ch01.xhtml#ch1fig3), was designed as a drop-in
    replacement for regular SATA disks. (*SATA*, or *Serial AT Attachment*, is the
    standard interface for disks.) SSDs have standard SATA interfaces and Self-Monitoring,
    Analysis and Reporting Technology (SMART) capability and use regular ATA commands
    (with some additions). Even the physical form factor of common consumer SSDs is
    the same as that of magnetic hard disks. Newer SSDs pose several challenges to
    digital forensic examiners, partly in the possibility to recover data from unallocated
    sectors on the drive and partly in the inability to access over-provisioned areas.
    SSD devices and OSes that support the ATA TRIM command can cause the erasure of
    unallocated disk blocks in preparation for the next use (SSD blocks must be erased
    before they can be written to or modified). This reduces the potential recovery
    of data in unallocated blocks, which are typically a valuable source of evidence
    on magnetic disks.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 如[图 1-3](ch01.xhtml#ch1fig3)所示，SSD被设计为常规SATA磁盘的直接替代品。（*SATA*，或称为*串行ATA连接*，是磁盘的标准接口。）SSD具有标准的SATA接口和自监控、分析与报告技术（SMART）功能，并使用常规的ATA命令（带有一些扩展）。即使是常见消费级SSD的物理形态，也与磁性硬盘相同。较新的SSD给数字取证检查员带来了几个挑战，部分原因在于可能从磁盘上的未分配扇区恢复数据，部分原因则是无法访问过度配置的区域。支持ATA
    TRIM命令的SSD设备和操作系统可能会在下次使用前擦除未分配的磁盘块（SSD块必须在写入或修改之前被擦除）。这减少了从未分配块中恢复数据的可能性，而这些未分配块通常是磁性硬盘上宝贵的证据来源。
- en: '![image](../images/f01-03.jpg)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../images/f01-03.jpg)'
- en: '*Figure 1-3: SSD*'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-3: 固态硬盘（SSD）*'
- en: 'You can use the `hdparm` command to determine the TRIM features supported by
    an SSD. For example:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用`hdparm`命令来确定SSD支持的TRIM功能。例如：
- en: '[PRE1]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: A modern generation of SSDs, based on new standards called SATA Express and
    NVM Express, interface directly with the PCI Express bus.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 现代一代SSD，基于名为SATA Express和NVM Express的新标准，直接与PCI Express总线接口。
- en: '***USB Flash Drives***'
  id: totrans-39
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***USB闪存驱动器***'
- en: 'Small, portable USB flash drives, as shown in [Figure 1-4](ch01.xhtml#ch1fig4),
    are referred to by many names: thumb drives, USB sticks, flash dongles, or simply
    USB flash drives. Flash drives initially became the replacement for floppy disks
    and, due to their low price and high capacity, are now replacing CDs and DVDs.'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 小型便携式USB闪存驱动器，如[图1-4](ch01.xhtml#ch1fig4)所示，有许多名称：U盘、USB闪存棒、闪存狗条，或者仅称为USB闪存驱动器。闪存驱动器最初成为软盘的替代品，并且由于其低价和大容量，现在正在取代CD和DVD。
- en: '![image](../images/f01-04.jpg)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-04.jpg)'
- en: '*Figure 1-4: USB flash drive*'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '*图1-4：USB闪存驱动器*'
- en: But the small size and large capacity of USB flash drives make them an information
    security risk. As a result, most vendors offer security solutions involving encryption.
    The most common encryption is software based and optional. The drive’s owner must
    explicitly install the encryption software provided by the vendor (or use alternative
    software, such as BitLocker or TrueCrypt). Some USB sticks provide mandatory hardware-based
    encryption systems. However, the added work and complexity of software encryption
    and the significantly higher cost of hardware encryption have impeded their widespread
    use. Plain, unencrypted USB devices are still most commonly used.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 但USB闪存驱动器的小尺寸和大容量使其成为信息安全的风险。因此，大多数供应商提供涉及加密的安全解决方案。最常见的加密是基于软件的，并且是可选的。驱动器的所有者必须明确安装供应商提供的加密软件（或者使用替代软件，如BitLocker或TrueCrypt）。一些USB闪存驱动器提供强制性的基于硬件的加密系统。然而，软件加密的附加工作和复杂性，以及硬件加密显著更高的成本，阻碍了其广泛使用。未加密的普通USB设备仍然是最常用的。
- en: '***Removable Memory Cards***'
  id: totrans-44
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***可移动存储卡***'
- en: The popularity of portable devices, such as mobile phones, tablets, cameras,
    and so on, has created a market for removable memory cards that you can swap out
    when they’re full or when copying to a PC or another device. A variety of memory
    cards are shown in [Figure 1-5](ch01.xhtml#ch1fig5). These are typically flash
    based and, when placed in a card reader, appear as a linear sequence of sectors
    similar to a hard disk.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 移动设备的流行，如手机、平板电脑、相机等，创造了一个可移动存储卡的市场，你可以在它们满了或复制到PC或其他设备时交换这些卡。[图1-5](ch01.xhtml#ch1fig5)展示了各种存储卡。这些通常是基于闪存的，当它们放入读卡器时，呈现出类似硬盘的线性扇区序列。
- en: '![image](../images/f01-05.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-05.jpg)'
- en: '*Figure 1-5: Flash memory cards*'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '*图1-5：闪存卡*'
- en: The most common memory card is the Secure Digital (SD) standard, which is available
    in several form factors and speeds. The CompactFlash (CF) card is popular in high-end
    camera equipment and is essentially a PATA/IDE interface with a smaller form factor.
    You can access it using a PATA/IDE interface adapter. A card reader connected
    via USB provides access to both memory card types (see [Figure 1-6](ch01.xhtml#ch1fig6)).
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 最常见的存储卡是安全数字（SD）标准，它有多种外形和速度。CompactFlash（CF）卡在高端摄影设备中很受欢迎，本质上是PATA/IDE接口，并具有更小的外形。你可以使用PATA/IDE接口适配器访问它。通过USB连接的卡读卡器可以访问这两种类型的存储卡（见[图1-6](ch01.xhtml#ch1fig6)）。
- en: '![image](../images/f01-06.jpg)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-06.jpg)'
- en: '*Figure 1-6: USB card reader*'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '*图1-6：USB读卡器*'
- en: '**NOTE**'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: Parallel ATA (PATA) *and* Integrated Drive Electronics (IDE) *are older standards
    defining a parallel interface between a drive and a computer system.*
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 并行ATA（PATA）*和*集成驱动电子（IDE）*是定义驱动器与计算机系统之间并行接口的旧标准。*
- en: '***Legacy Non-Volatile Memory***'
  id: totrans-53
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***传统非易失性存储***'
- en: Many legacy memory cards became obsolete as the market lost interest in their
    maximum capacity or proprietary interfaces. Some examples include Sony Memory
    Sticks, Panasonic P2 cards, SmartMedia cards, and other PCMCIA/PCcard media. Typically,
    these memory cards attach to a Linux system as block devices with a linear sequence
    of sectors, and you can image them using the same techniques as for other memory
    cards (if a physical reader is available).
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 随着市场对其最大容量或专有接口失去兴趣，许多传统内存卡已变得过时。一些例子包括索尼记忆棒、松下P2卡、SmartMedia卡和其他PCMCIA/PC卡介质。通常，这些内存卡会作为块设备连接到Linux系统，具有线性顺序的扇区，你可以使用与其他内存卡相同的技术对其进行映像（如果有物理读卡器）。
- en: '**Optical Storage Media**'
  id: totrans-55
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**光学存储介质**'
- en: Common optical disc storage media in use today includes CD-ROMs, DVD-ROMs, and
    Blu-ray discs. The different types of optical media vary in their physical and
    chemical properties. Their visible differences are shown in [Figure 1-7](ch01.xhtml#ch1fig7).
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 当前常用的光盘存储介质包括 CD-ROM、DVD-ROM 和蓝光光盘。不同类型的光学媒介在物理和化学性质上有所不同。它们的可见差异在[图1-7](ch01.xhtml#ch1fig7)中展示。
- en: '![image](../images/f01-07.jpg)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-07.jpg)'
- en: '*Figure 1-7: Top to bottom: DVD-ROM, Blu-ray, CD-ROM*'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-7：从上到下：DVD-ROM、蓝光、CD-ROM*'
- en: Optical discs are usually read-only, write-once, or read-writable. Professionally
    mastered discs are stamped rather than burned. Although they’re slowly becoming
    obsolete, writable optical discs are still a common source of digital evidence.
    Many forensic labs still use them for transfer and storage of compressed forensic
    images.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 光盘通常有只读、一次写入或可读写类型。专业制作的光盘是通过压模制作，而不是通过刻录。尽管它们正在慢慢变得过时，可写光盘仍然是数字证据的常见来源。许多法医实验室仍然使用它们来传输和存储压缩的法医图像。
- en: An optical disc contains a single spiral track with a sequence of *pits* and
    *lands* on a reflective surface, which can be read by a laser and interpreted
    as data bits. Data is written to the surface using a laser to burn points on the
    surface, which affects the reflectivity and causes the burned areas to be interpreted
    as data bits. This sequence of bits is separated into sectors, which after encoding
    and error correction contain 2048 bytes of user-accessible data.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 一张光盘包含一个单一的螺旋轨道，轨道上有一系列*凹坑*和*高地*，这些可以被激光读取并解读为数据位。数据通过激光在表面烧录点，影响反射率，从而使烧录的区域被解读为数据位。这些位序列被分为扇区，经过编码和错误校正后，包含2048字节的用户可访问数据。
- en: 'Optical discs have one similarity to magnetic tapes: data is written as a single
    linear string of bytes—files are not fragmented. Unlike tapes, it’s possible to
    easily jump to random areas of the disc, making it feasible to mount the disc
    as a read-only filesystem. However, writing to an optical disc is still cumbersome
    and, as with a tape, must be done in a sequential order of bytes.'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 光盘与磁带有一个相似之处：数据是以单一的线性字节串写入的——文件不会被碎片化。与磁带不同，光盘可以轻松跳转到磁盘的随机位置，这使得将光盘挂载为只读文件系统成为可能。然而，写入光盘仍然是繁琐的，并且像磁带一样，必须按字节的顺序顺序进行写入。
- en: '***Compact Discs***'
  id: totrans-62
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***紧凑光盘***'
- en: The oldest of the three optical discs, CD-ROM/CDR discs, were once the most
    popular optical media for home user backups, personal archives, and exchanging
    information. But as the use of convenient, high-capacity USB flash drives has
    grown, the use of CDs for storage has declined.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 作为三种光盘中最古老的一种，CD-ROM/CDR 光盘曾是家庭用户备份、个人档案存储和信息交换最流行的光学媒介。但随着方便且大容量的USB闪存驱动器的使用日益普及，光盘在存储上的使用逐渐减少。
- en: A collection of standards called the *Rainbow Books* describes various CD specifications,
    and a number of common CD standards exist. (See the Philips intellectual property
    page at *[http://www.ip.philips.com/licensing/program/16/](http://www.ip.philips.com/licensing/program/16/)*
    for more information.)
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 一系列标准被称为*彩虹书*，描述了各种 CD 规格，存在许多常见的 CD 标准。（有关更多信息，请参阅飞利浦知识产权页面 *[http://www.ip.philips.com/licensing/program/16/](http://www.ip.philips.com/licensing/program/16/)*）
- en: • Music CDs, or Compact Disc-Digital Audio (CD-DA), are specified in the *Red
    Book* and IEC 60908 standard. Data in this format is divided into multiple audio
    tracks.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: • 音乐 CD，或称紧凑光盘-数字音频（CD-DA），按照*红皮书*和IEC 60908标准进行规范。此格式中的数据被划分为多个音频轨道。
- en: • Data CDs, or Compact Disc-Read Only Memory (CD-ROM), are covered in the *Yellow
    Book*, ISO/IEC 10149, and ECMA 130 standard (*[http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-130.pdf](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-130.pdf)*).
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: • 数据 CD，或称紧凑光盘-只读存储（CD-ROM），在*黄皮书*、ISO/IEC 10149 和 ECMA 130 标准中有规定 (*[http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-130.pdf](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-130.pdf)*).
- en: • Writable CDs, or Compact Disc-Recordable/ReWritable (CD-R/CD-RW), are part
    of the *Orange Book* standard and allow data to be written (CD-R) or rewritten
    (CD-RW) to a CD.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: • 可写光盘，或称紧凑光盘-可记录/可重写（CD-R/CD-RW），属于*橙皮书*标准，允许数据写入（CD-R）或重写（CD-RW）到光盘。
- en: • Less common standards include Photo-CD, Video CD (VCD), and other obscure
    variations, extensions, and enhancements of the common standards.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: • 不太常见的标准包括Photo-CD、视频 CD（VCD）以及其他不太常见的变种、扩展和常见标准的增强版。
- en: Every CD has a linear stream of bits (pits and lands) that are abstracted into
    a linear sequence of sectors. Abstracted further, above these sectors, are *sessions*,
    which contain a lead-in area and a table of contents (TOC) for the session. Multisession
    CDs can exist, and each session has its own TOC.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 每张CD都有一条线性的比特流（坑和陆地），这些比特流被抽象为一个线性扇区序列。进一步抽象，这些扇区之上是*会话*，其中包含会话的引导区和目录表（TOC）。可以存在多会话CD，每个会话都有自己的TOC。
- en: 'Data CDs can have filesystems residing on a session, which can contain files
    and a directory structure. Some examples of CD-ROM filesystems include:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 数据CD可以在一个会话中拥有文件系统，其中包含文件和目录结构。一些CD-ROM文件系统的示例包括：
- en: '**High Sierra** Original standard for PCs (8.3, uppercase)'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '**High Sierra** 最初的PC标准（8.3，全部大写）'
- en: '**ISO9660** Updated High Sierra for cross-platform'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '**ISO9660** 更新版High Sierra，用于跨平台'
- en: '**Joliet** ISO9660 extensions; from Microsoft for Win95 and later'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: '**Joliet** ISO9660扩展；微软为Win95及更高版本提供'
- en: '**HFS** Macintosh'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '**HFS** Macintosh'
- en: '**Rock Ridge** Extensions to ISO9660 for POSIX'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '**Rock Ridge** 为POSIX设计的ISO9660扩展'
- en: '**El Torito** Standard for bootable discs'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '**El Torito** 可引导光盘标准'
- en: From a forensics perspective, user data on the entire CD can be read. There
    is no equivalent to the EOD found on tapes or DCO/HPA (user-inaccessible areas
    of a hard disk) found on disks. But there are filesystem-specific artifacts that
    might require special analysis to interpret.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 从法医学角度来看，整个CD上的用户数据都可以被读取。没有类似于磁带上的EOD或硬盘上的DCO/HPA（用户不可访问区域）的等价物。但有些文件系统特定的伪像可能需要特殊分析才能解读。
- en: Forensic write blockers, which are forensic hardware designed to prevent tampering
    and contaminating evidence found on drives, are unnecessary for CD-ROMs, given
    their default read-only properties. The OS will not update timestamps or modify
    data on a CD simply by putting it into the CD drive and accessing it.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 法医学写保护器是专为防止篡改和污染驱动器上发现的证据而设计的硬件，对于CD-ROM而言是不必要的，因为其默认的只读属性。操作系统不会通过将CD放入CD驱动器并访问它来更新时间戳或修改CD上的数据。
- en: CDs do have some unique identifiers that are useful in a forensic context. A
    *Source Unique Identifier (SID)* is stamped on the disc and contains information
    about the optical disc production facility that produced that particular disc.
    This code begins with *IFPI* and is physically stamped on the inner area of the
    disc (which can be easily read with the human eye). The *Recorder Identification
    Code (RID)* is written to system sectors of a disc and links a burned CD to the
    drive that created it. The RID is not easily accessible without specialized hardware.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: CD确实有一些独特的标识符，在法医学背景下非常有用。*源唯一标识符（SID）* 被印刻在光盘上，包含有关生产该光盘的光盘生产设施的信息。该代码以*IFPI*
    开头，并被物理印刻在光盘的内圈区域（人眼可轻松读取）。*记录器标识码（RID）* 被写入光盘的系统扇区，并将烧录的CD与创建它的驱动器关联。没有专门硬件，RID不容易访问。
- en: Other physical attributes, such as those indicative of piracy and counter-feit
    copies, are outside the scope of this book, but you can access a guide from the
    International Federation of the Phonographic Industry (IFPI) at *[http://www.ifpi.org/content/library/manual-of-guidance-chap3-english.pdf](http://www.ifpi.org/content/library/manual-of-guidance-chap3-english.pdf)*.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 其他物理属性，如表明盗版和伪造副本的特征，不在本书的范围内，但你可以访问国际唱片制品协会（IFPI）提供的指南，网址是* [http://www.ifpi.org/content/library/manual-of-guidance-chap3-english.pdf](http://www.ifpi.org/content/library/manual-of-guidance-chap3-english.pdf)*。
- en: '***Digital Versatile Discs***'
  id: totrans-81
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***数字多功能光盘***'
- en: DVDs have different physical attributes from but are logically similar to CDs.
    A DVD has a single spiral track of bits split into 2048-byte sectors.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: DVD与CD在物理属性上有所不同，但在逻辑上类似。DVD有一个单一的螺旋轨道，将比特分割成2048字节的扇区。
- en: 'DVDs can be single sided or double sided. They can also be single layer or
    double layer. Doubling a side or a layer effectively doubles the data capacity.
    They have similar standards as CDs but with some additions, discussed here: *[http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-382.pdf](http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-382.pdf)*.
    DVD-Video, DVD-ROM, DVD-R, and DVD-RW correspond to their CD equivalents, but
    an additional DVD-RAM standard is also available. An alternative set of standards
    was created with DVD+R and DVD+RW, which have the same data capacities as DVD-R
    and DVD-RW, but the “+” and “-” formats are incompatible (although most modern
    drives can read both).'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: DVD 可以是单面或双面，也可以是单层或双层。增加一个面或一层会有效地将数据容量翻倍。它们与 CD 有相似的标准，但有所扩展，详见：[http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-382.pdf](http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-382.pdf)*。DVD-Video、DVD-ROM、DVD-R
    和 DVD-RW 对应于 CD 的相应格式，但还新增了 DVD-RAM 标准。同时，DVD+R 和 DVD+RW 也有一套替代标准，它们的容量与 DVD-R
    和 DVD-RW 相同，但“+”和“-”格式不兼容（尽管大多数现代驱动器可以读取两者）。
- en: The most common filesystem for DVD drives is the Universal Disk Format (UDF),
    which is designed as a packet-writing replacement for ISO9660.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: DVD 驱动器最常用的文件系统是通用磁盘格式（UDF），它被设计为 ISO9660 的包写替代方案。
- en: '***Blu-ray Discs***'
  id: totrans-85
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***蓝光光盘***'
- en: Blu-ray discs (BDs) use new physical manufacturing processes to further increase
    the data capacity of the discs. BD is still similar to CD and DVD in that it uses
    the spiral track of data split into 2048-byte sectors.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 蓝光光盘（BD）采用新的物理制造工艺，进一步提高了光盘的数据容量。BD 与 CD 和 DVD 相似，依然使用螺旋数据轨道，并将数据分割为 2048 字节的扇区。
- en: Its standards have close counterparts to CD and DVD and include BD-ROM (Read
    only), BD-R (Recordable), BD-RE (ReWritable), BD-XL (double capacity ReWritable).
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 它的标准与 CD 和 DVD 有相似之处，包括 BD-ROM（只读）、BD-R（可录制）、BD-RE（可重写）、BD-XL（双倍容量可重写）。
- en: DVD and BD allow for content protection using encryption, which can potentially
    cause difficulties when acquiring a protected disc during a forensic investigation.
    Tools and methods to decrypt DRM-protected content exist but are left outside
    the scope of this book.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: DVD 和 BD 通过加密技术实现内容保护，这在进行取证调查时可能会导致获取受保护光盘时出现困难。虽然存在解密 DRM 保护内容的工具和方法，但这些内容超出了本书的讨论范围。
- en: '***Legacy Optical Storage***'
  id: totrans-89
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***传统光学存储***'
- en: A number of legacy optical drives exist, in particular, the cartridge-based
    Write Once, Read Many (WORM) times drive. The legacy optical drives were more
    commonly used in enterprise environments, typically used SCSI interfaces, and
    were accessible as a linear sequence of sectors. If the drive and a compatible
    controller card are still available, and the Linux kernel recognizes the media,
    you can read and analyze the media in the same manner as other optical discs.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 存在一些传统的光学驱动器，尤其是基于卡带的只写多次读取（WORM）驱动器。传统光学驱动器在企业环境中使用较为广泛，通常使用 SCSI 接口，且可以作为线性扇区序列访问。如果驱动器和兼容的控制卡仍然可用，并且
    Linux 内核识别该介质，你可以像处理其他光盘一样读取和分析该介质。
- en: '**Interfaces and Physical Connectors**'
  id: totrans-91
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**接口和物理连接器**'
- en: In this section, I’ll provide an overview of common drive interfaces from the
    perspective of a forensic examiner. A forensic examiner working in a well-equipped
    forensics laboratory can acquire and analyze storage media using a variety of
    device interfaces.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我将从取证检查员的角度概述常见的驱动器接口。一个在设备齐全的取证实验室工作的取证检查员，可以通过多种设备接口获取和分析存储介质。
- en: A general trend in computing (especially with storage interfaces) is the shift
    from parallel and shared buses to serial point-to-point connections. PATA/IDE,
    a once-popular parallel interface with two disks sharing a single cable, has been
    replaced by SATA, which has one disk on a serial cable. SCSI was a parallel shared
    bus that supported multiple disks and has now been replaced by SAS with individual
    serial connectors for each disk. The original PCI bus was parallel and shared
    by multiple interface cards but has been replaced by PCI Express, a serial bus
    with dedicated lanes per interface (also used to attach SATA Express and NVM Express
    drives). The parallel printer interface has been replaced by USB (a serial protocol,
    but using a shared bus). As transmission speeds increased, the timing of parallel
    electrical signals became difficult to manage. Performing serialization/deserialization
    of data over dedicated serial lines enabled faster transmission speeds than managing
    the coordination of multiple parallel data lines.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 计算机领域（尤其是存储接口）的一个普遍趋势是，从并行和共享总线转向串行点对点连接。PATA/IDE，曾是一个流行的并行接口，两个硬盘共享一根电缆，现已被SATA取代，SATA将一个硬盘连接在串行电缆上。SCSI曾是一个并行共享总线，支持多个硬盘，现在已经被SAS替代，每个硬盘都有独立的串行连接器。最初的PCI总线是并行的，多个接口卡共享同一个总线，但它已被PCI
    Express取代，后者是一个串行总线，每个接口都有专用通道（还用于连接SATA Express和NVM Express驱动器）。并行打印机接口已被USB取代（USB是一个串行协议，但使用共享总线）。随着传输速度的提高，管理并行电信号的时序变得越来越困难。通过专用串行线路进行数据的序列化/反序列化使得传输速度比管理多个并行数据线路的协调更快。
- en: '***Serial ATA***'
  id: totrans-94
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***串行ATA***'
- en: The most popular internal storage media interface in use today is SATA. Inside
    PCs, most hard disks, SSDs, and optical drives connect to SATA interfaces on the
    mainboard or add-on host bus adapters. The serial architecture of SATA has replaced
    parallel ATA (PATA or IDE), which used to be the dominant consumer disk interface.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 当前最流行的内部存储介质接口是SATA。在PC内部，大多数硬盘、SSD和光驱都连接到主板或附加主机总线适配器上的SATA接口。SATA的串行架构已取代了并行ATA（PATA或IDE），后者曾是主流的消费级硬盘接口。
- en: The SATA standard is managed by The Serial ATA International Organization (*[http://www.sata-io.org/](http://www.sata-io.org/)*).
    Currently in revision 3, SATA provides speeds of up to 6Gbps (revisions 1 and
    2 had speeds of 1.5Gbps and 3.0Gbps, respectively). In addition to the internal
    interface, an external interface (eSATA) exists that allows you to directly attach
    external SATA disks. [Figure 1-8](ch01.xhtml#ch1fig8) shows the SATA interface.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: SATA标准由串行ATA国际组织管理（*[http://www.sata-io.org/](http://www.sata-io.org/)*）。当前是3版，SATA提供最高6Gbps的速度（1版和2版的速度分别为1.5Gbps和3.0Gbps）。除了内部接口外，还有一个外部接口（eSATA），允许你直接连接外部SATA硬盘。[图
    1-8](ch01.xhtml#ch1fig8)展示了SATA接口。
- en: '![image](../images/f01-08.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-08.jpg)'
- en: '*Figure 1-8: SATA disk interface*'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-8：SATA硬盘接口*'
- en: A smaller form factor, mini-SATA (mSATA), was designed for small portable devices.
    mSATA, shown in [Figure 1-9](ch01.xhtml#ch1fig9), allows small SSD SATA drives
    to attach directly to a mainboard without separate SATA cabling.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 更小的表单因子，迷你SATA（mSATA），是为小型便携设备设计的。mSATA，如[图 1-9](ch01.xhtml#ch1fig9)所示，允许小型SSD
    SATA驱动器直接连接到主板，无需单独的SATA电缆。
- en: '![image](../images/f01-09.jpg)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-09.jpg)'
- en: '*Figure 1-9: mSATA disk interface*'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-9：mSATA硬盘接口*'
- en: 'Mainboards typically allow you to install SATA disks in either Advanced Host
    Controller Interface (AHCI) mode or IDE mode. AHCI defines a standard SATA adapter
    interface here: *[http://www.intel.com/content/dam/www/public/us/en/documents/technical-specifications/serial-ata-ahci-spec-rev1-3-1.pdf](http://www.intel.com/content/dam/www/public/us/en/documents/technical-specifications/serial-ata-ahci-spec-rev1-3-1.pdf)*.
    IDE mode provides a legacy disk interface for older OSes that don’t support the
    AHCI standard (old versions of Windows XP, for example). The mode you use doesn’t
    affect the cryptographic hash of a forensic image. You can remove a disk from
    a subject PC in IDE mode, attach it to an examiner machine in AHCI mode, and acquire
    it without data loss or modification.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 主板通常允许你以高级主机控制器接口（AHCI）模式或IDE模式安装SATA硬盘。AHCI在此定义了一个标准的SATA适配器接口：*[http://www.intel.com/content/dam/www/public/us/en/documents/technical-specifications/serial-ata-ahci-spec-rev1-3-1.pdf](http://www.intel.com/content/dam/www/public/us/en/documents/technical-specifications/serial-ata-ahci-spec-rev1-3-1.pdf)*。IDE模式为不支持AHCI标准的旧操作系统（例如旧版Windows
    XP）提供传统的磁盘接口。你使用的模式不会影响取证图像的加密哈希值。你可以在IDE模式下将硬盘从目标PC中取出，在AHCI模式下连接到检查机，并在不丢失数据或修改数据的情况下进行采集。
- en: Another interface, micro SATA (not to be confused with mSATA), is shown in [Figure
    1-10](ch01.xhtml#ch1fig10). It was designed for 1.8-inch disk drives and slim
    CD/DVD players but is less commonly used today. You can combine regular SATA write
    blockers with various adapters to acquire mSATA and micro SATA drives.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种接口是micro SATA（不要与mSATA混淆），如[图 1-10](ch01.xhtml#ch1fig10)所示。它是为1.8英寸磁盘驱动器和瘦型CD/DVD播放器设计的，但如今使用较少。你可以将常规SATA写保护器与各种适配器结合使用，以获取mSATA和micro
    SATA驱动器。
- en: '![image](../images/f01-10.jpg)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-10.jpg)'
- en: '*Figure 1-10: Micro SATA disk interface*'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-10：Micro SATA磁盘接口*'
- en: A more advanced form factor gaining in popularity is the M.2 interface, shown
    in [Figure 4-4](ch04.xhtml#ch4fig4). Introduced with the SATA 3.2 specification,
    M.2 provides two standards in one interface. An M.2 card can use either AHCI/SATA
    or NVMHCI/NVME interfaces, depending on compatibility requirements. When you’re
    using M.2 cards, be sure to confirm which interface the card uses (as of this
    writing, most M.2 cards on the market use ACHI/SATA mode).
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 一种越来越流行的更先进的外形因子是M.2接口，如[图 4-4](ch04.xhtml#ch4fig4)所示。M.2接口随着SATA 3.2规格的推出而出现，提供了两种标准于一个接口中。M.2卡可以使用AHCI/SATA或NVMHCI/NVME接口，具体取决于兼容性要求。在使用M.2卡时，请务必确认卡使用的是哪种接口（截至目前，市场上大多数M.2卡使用ACHI/SATA模式）。
- en: '![image](../images/f01-11.jpg)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-11.jpg)'
- en: '*Figure 1-11: M.2 disk interface*'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-11：M.2磁盘接口*'
- en: The SATA Express disk interface, shown in [Figure 1-12](ch01.xhtml#ch1fig12),
    eliminates several layers of the SATA protocol stack, allowing storage (primarily
    SSDs) to attach directly to the PCI Express bus. These drives continue to use
    the AHCI standard and are different from NVME.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: SATA Express磁盘接口，如[图 1-12](ch01.xhtml#ch1fig12)所示，消除了SATA协议栈的多个层次，使存储（主要是SSD）能够直接连接到PCI
    Express总线。这些驱动器继续使用AHCI标准，并且与NVME不同。
- en: '![image](../images/f01-12.jpg)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-12.jpg)'
- en: '*Figure 1-12: SATA Express disk interface*'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-12：SATA Express磁盘接口*'
- en: The SATA 3.2 specification supports two PCI Express lanes for 16Gbps SATA Express
    speeds. Write blockers exist for PCI- and M.2-based SATA Express drives.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: SATA 3.2规格支持两个PCI Express通道，提供16Gbps的SATA Express速度。存在用于PCI和M.2基础的SATA Express驱动器的写保护器。
- en: '***Serial Attached SCSI and Fibre Channel***'
  id: totrans-113
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***串行附加SCSI和光纤通道***'
- en: The parallel SCSI interface has largely disappeared in both consumer and enterprise
    markets. SATA has replaced it in the consumer market, and *Serial Attached SCSI
    (SAS)* and *Fibre Channel (FC)* have replaced it in the enterprise market. The
    physical connector of the SAS interface, shown in [Figure 1-13](ch01.xhtml#ch1fig13),
    allows both SAS and SATA disks to be attached and accessed on a SAS backplane.
    The physical connector on SAS disk drives is slightly different from that on SATA
    disks, and various fan-out connectors are available for attaching multiple disks
    to the host bus adapter. The current speed of SAS-3 disks is 12Gbps, twice that
    of SATA-3\. SAS-4 will provide speeds of 22.5Gbps.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 并行SCSI接口在消费市场和企业市场中已基本消失。SATA已在消费市场中取而代之，而*串行附加SCSI（SAS）*和*光纤通道（FC）*则在企业市场中取代了它。SAS接口的物理连接器，如[图
    1-13](ch01.xhtml#ch1fig13)所示，允许SAS和SATA磁盘连接并在SAS背板上访问。SAS磁盘驱动器的物理连接器与SATA磁盘的连接器略有不同，并且提供各种扇出连接器以将多个磁盘连接到主机总线适配器。当前SAS-3磁盘的速度为12Gbps，是SATA-3的两倍。SAS-4将提供22.5Gbps的速度。
- en: '![image](../images/f01-13.jpg)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-13.jpg)'
- en: '*Figure 1-13: SAS disk interface*'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-13：SAS磁盘接口*'
- en: A Mini-SAS HD 4i receptacle connector is shown in [Figure 1-14](ch01.xhtml#ch1fig14).
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 一个Mini-SAS HD 4i插座连接器如[图 1-14](ch01.xhtml#ch1fig14)所示。
- en: '![image](../images/f01-14.jpg)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-14.jpg)'
- en: '*Figure 1-14: SFF-8632/Mini-SAS HD interface*'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-14：SFF-8632/Mini-SAS HD接口*'
- en: The SAS standard is maintained by the T10 technical committee of the International
    Committee for Information Technology Standards (INCITS). The current standards
    document is “Serial Attached SCSI -3 (SAS-3) INCITS 519-2014.” More information,
    including drafts of upcoming standards, is available at *[http://t10.org/](http://t10.org/)*.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: SAS标准由国际信息技术标准委员会（INCITS）的T10技术委员会维护。目前的标准文档是《串行附加SCSI-3（SAS-3）INCITS 519-2014》。更多信息，包括即将发布的标准草案，可在*[http://t10.org/](http://t10.org/)*网站获取。
- en: SAS drives cannot be connected to SATA host bus adapters, and separate SAS write
    blockers are needed to image SAS disks.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: SAS驱动器不能连接到SATA主机总线适配器，成像SAS磁盘需要使用单独的SAS写保护器。
- en: The Fibre Channel interface is often used to connect enterprise storage arrays.
    Shown in [Figure 1-15](ch01.xhtml#ch1fig15) are copper and optical-based Fibre
    Channel connectors.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 光纤通道接口通常用于连接企业存储阵列。[图 1-15](ch01.xhtml#ch1fig15) 展示了铜基和光纤基的光纤通道连接器。
- en: '![image](../images/f01-15.jpg)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-15.jpg)'
- en: '*Figure 1-15: Fibre Channel interfaces*'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-15：光纤通道接口*'
- en: Hard disks with integrated Fibre Channel interfaces are becoming legacy and
    have largely been replaced with SAS drives. As of this writing, no hardware write
    blockers for Fibre Channel disk interfaces are available on the market.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 带有集成光纤通道接口的硬盘正逐渐成为过时的技术，已被 SAS 驱动器大量取代。截至目前，市场上尚未有用于光纤通道磁盘接口的硬件写保护器。
- en: '***Non-Volatile Memory Express***'
  id: totrans-126
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***非易失性存储器快车***'
- en: '*Non-Volatile Memory Express (NVME)* was designed from the ground up as an
    alternative to the AHCI-based SATA drive interface. It was designed to attach
    directly to the PCI Express bus, eliminating the need for an AHCI/SATA host bus
    adapter and the associated SATA physical interfaces and protocol layers. The NVME
    architecture focuses specifically on SSD storage, and a simpler, more efficient
    command set was created. NVME devices can attach either directly to a mainboard
    in a PCIE slot, using the PCIE NVMe mode of an M.2 interface, or with a U.2 (SFF-8639)
    interface.'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '*非易失性存储器快车（NVME）* 是从零开始设计的，作为替代基于 AHCI 的 SATA 驱动器接口。它旨在直接连接到 PCI Express 总线，从而消除了对
    AHCI/SATA 主机总线适配器的需求，省去了与 SATA 物理接口和协议层相关的复杂性。NVME 架构特别专注于 SSD 存储，并创建了一个更简单、更高效的命令集。NVME
    设备可以直接插入主板的 PCIE 插槽，使用 M.2 接口的 PCIE NVMe 模式，或通过 U.2（SFF-8639）接口连接。'
- en: The physical interface is directly attached to the PCIE bus, as shown in [Figure
    1-16](ch01.xhtml#ch1fig16).
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 物理接口直接连接到 PCIE 总线，如 [图 1-16](ch01.xhtml#ch1fig16) 所示。
- en: '![image](../images/f01-16.jpg)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-16.jpg)'
- en: '*Figure 1-16: NVME SSD with a PCIE interface*'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-16：带有 PCIE 接口的 NVME SSD*'
- en: An M.2 or Next Generation Form Factor (NGFF) version is also available. These
    are either directly inserted into mainboard M.2 slots or using PCIE slot adapter
    cards, both with NVME mode (not AHCI/SATA mode). Currently, most M.2 SSD disks
    are AHCI/SATA, not NVME, but this may change because the performance benefits
    of NVME are compelling. [Figure 1-17](ch01.xhtml#ch1fig17) shows an NVME M.2 disk.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 也有 M.2 或下一代外形因素（NGFF）版本可供选择。这些通常直接插入主板的 M.2 插槽，或者通过使用 PCIE 插槽适配卡，两者都支持 NVME
    模式（而非 AHCI/SATA 模式）。目前，大多数 M.2 SSD 硬盘是 AHCI/SATA 模式，而非 NVME，但由于 NVME 的性能优势，未来这种情况可能会发生变化。[图
    1-17](ch01.xhtml#ch1fig17) 展示了一款 NVME M.2 硬盘。
- en: '![image](../images/f01-17.jpg)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-17.jpg)'
- en: '*Figure 1-17: NVME SSD with an M.2 interface*'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-17：带有 M.2 接口的 NVME SSD*'
- en: The NVME U.2 interface (see [Figure 1-18](ch01.xhtml#ch1fig18)) allows drives
    with traditional 2.5-inch physical form factors to connect via cable or backplane.
    The U.2 (SFF-8639) interface and cable (mechanically similar to SAS but with additional
    pins for PCIE lanes) connect the drive enclosure to a mini-SAS HD plug on an M.2
    adapter, which is attached to the mainboard.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: NVME U.2 接口（见 [图 1-18](ch01.xhtml#ch1fig18)）允许传统 2.5 英寸物理外形的硬盘通过电缆或背板连接。U.2（SFF-8639）接口和电缆（机械上类似于
    SAS，但有额外的针脚用于 PCIE 通道）将硬盘外壳连接到 M.2 适配器上的 mini-SAS HD 插头，而该适配器则连接到主板上。
- en: '![image](../images/f01-18.jpg)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-18.jpg)'
- en: '*Figure 1-18: A 2.5-inch SSD with a U.2 interface, a U.2 to mini-SAS HD cable,
    and a mini-SAS HD to M.2 adapter for a mainboard*'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-18：带有 U.2 接口的 2.5 英寸 SSD、U.2 到 mini-SAS HD 电缆和用于主板的 mini-SAS HD 到 M.2
    适配器*'
- en: 'NVME disks are not visible using typical SCSI or SATA command tools because
    they don’t use SCSI or SATA commands. Linux tools designed to interact with ATA
    or SCSI disk interfaces will generally not work with NVME disks and require added
    support for compatibility. The device names for NVME disks are not the familiar
    */dev/sd** files but */dev/nvme*n**. An NVME device is created with an additional
    `namespace` number. The namespace, denoted with *n*, is a lower layer (below the
    OS) allocation of space on an NVME drive. The */dev/nvme*n** disk devices are
    block devices and should function normally when applied to the Linux device file.
    For example, here is the Sleuth Kit `mmls` command operating on an NVME disk:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: NVME 磁盘无法通过典型的 SCSI 或 SATA 命令工具查看，因为它们不使用 SCSI 或 SATA 命令。设计用于与 ATA 或 SCSI 磁盘接口交互的
    Linux 工具通常无法与 NVME 磁盘兼容，且需要额外的支持以确保兼容性。NVME 磁盘的设备名称不是我们熟悉的 */dev/sd** 文件，而是 */dev/nvme*n**。NVME
    设备通过一个附加的 `namespace` 编号来创建。该命名空间（以 *n* 表示）是 NVME 硬盘上操作系统以下的空间分配层级。*/dev/nvme*n**
    磁盘设备是块设备，在应用到 Linux 设备文件时应能正常工作。例如，以下是 Sleuth Kit `mmls` 命令在 NVME 磁盘上执行的示例：
- en: '[PRE2]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: As of this writing, the use of NVME is relatively new, and Tableau has just
    created the first PCI Express forensic hardware write blocker with NVME support.
    The difficulty intercepting NVME commands on the PCIE bus makes write blockers
    expensive and complex to implement. For more information, see my paper “NVM Express
    Drives and Digital Forensics,” which discusses this challenge in more detail.^([2](footnote.xhtml#fn06))
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 截至目前，NVME 的使用相对较新，Tableau 刚刚创建了首个支持 NVME 的 PCI Express 法医硬件写保护器。由于在 PCIE 总线上拦截
    NVME 命令的难度，使得写保护器的价格昂贵且实现复杂。有关更多信息，请参阅我的论文《NVM Express 驱动器与数字法医学》，该论文详细讨论了这一挑战。^([2](footnote.xhtml#fn06))
- en: '***Universal Serial Bus***'
  id: totrans-140
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***通用串行总线***'
- en: USB was created to consolidate and replace aging external peripheral interfaces,
    such as RS-232, the parallel printer interface, PS/2 keyboard and mouse, and other
    proprietary PC interfaces. It was designed to accommodate multipurpose functionality,
    such as disks, keyboards, mice, sound, network connections, printers and scanners,
    and connected small devices (mobile phones and so on). A growing number of Internet-of-Things
    (IoT) devices can be attached to a PC via USB and may contain data useful as forensic
    evidence. Because the focus of this book is on the forensic acquisition of mass
    storage devices, I’ll limit this discussion to USB mass storage devices.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: USB 被创建的目的是整合并取代老旧的外部外围接口，如 RS-232、并行打印机接口、PS/2 键盘和鼠标以及其他专有的 PC 接口。它的设计考虑了多用途的功能支持，如磁盘、键盘、鼠标、声音、网络连接、打印机和扫描仪，以及连接的小型设备（如手机等）。越来越多的物联网（IoT）设备可以通过
    USB 连接到 PC，并且可能包含作为法医证据的有用数据。由于本书的重点是对大容量存储设备的法医采集，因此我将把讨论限定于 USB 大容量存储设备。
- en: Flash drives, optical drives, some tape drives, and even magnetic hard disks
    (see [Figure 1-19](ch01.xhtml#ch1fig19)) may have a USB interface directly integrated
    into the drive electronics. The most common uses of the USB mass storage class
    are the consumer USB stick, or thumb drive, and external hard disk enclosures.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 闪存驱动器、光驱、一些磁带驱动器，甚至磁性硬盘（参见 [图 1-19](ch01.xhtml#ch1fig19)）可能会将 USB 接口直接集成到驱动器电子组件中。USB
    大容量存储类的最常见应用是消费者使用的 USB 闪存盘或拇指盘，以及外置硬盘盒。
- en: '![image](../images/f01-19.jpg)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-19.jpg)'
- en: '*Figure 1-19: A 1.8-inch magnetic hard disk with integrated USB interface*'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-19：集成 USB 接口的 1.8 英寸磁性硬盘*'
- en: The original USB protocol for the mass storage class of devices is known as
    Bulk-Only Transport (BOT). BOT is currently the most common USB transport protocol;
    however, with increasing disk speeds and the arrival of USB3, the BOT protocol
    is becoming a bottleneck and may be replaced by the USB Attached SCSI Protocol
    (UASP). Similar to AHCI for SATA, USB also has a defined standard for the host
    controller interface. The Extensible Host Controller Interface (xHCI) replaces
    several older USB standards (in particular, OHCI, UHCI, and EHCI). Its specification
    can be found at *[http://www.intel.com/content/dam/www/public/us/en/documents/technical-specifications/extensible-host-controler-interface-usb-xhci.pdf](http://www.intel.com/content/dam/www/public/us/en/documents/technical-specifications/extensible-host-controler-interface-usb-xhci.pdf)*.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 原始的 USB 协议用于大容量存储设备类别，称为 Bulk-Only Transport (BOT)。BOT 是当前最常见的 USB 传输协议；然而，随着磁盘速度的提高以及
    USB3 的到来，BOT 协议正成为瓶颈，可能会被 USB 附加 SCSI 协议（UASP）所取代。类似于 SATA 的 AHCI，USB 也为主机控制器接口定义了标准。可扩展主机控制器接口（xHCI）取代了多个较老的
    USB 标准（特别是 OHCI、UHCI 和 EHCI）。其规范可以在 *[http://www.intel.com/content/dam/www/public/us/en/documents/technical-specifications/extensible-host-controler-interface-usb-xhci.pdf](http://www.intel.com/content/dam/www/public/us/en/documents/technical-specifications/extensible-host-controler-interface-usb-xhci.pdf)*
    上找到。
- en: The latest USB interface for USB 3.1 is Type C, shown in [Figure 1-20](ch01.xhtml#ch1fig20).
    The Type C interface is multifunctional and can be used for USB 3.1 devices and
    Thunderbolt 3 devices, and as a power supply. The physical plug is reversible,
    meaning it does not have a top or bottom to align when plugging in to a system.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 最新的 USB 3.1 接口是 Type C，如 [图 1-20](ch01.xhtml#ch1fig20) 所示。Type C 接口具有多功能性，可用于
    USB 3.1 设备和 Thunderbolt 3 设备，并可用作电源供应。物理插头是可逆的，这意味着在插入系统时，它没有上或下之分。
- en: '![image](../images/f01-20.jpg)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-20.jpg)'
- en: '*Figure 1-20: USB Type C interface*'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-20：USB Type C 接口*'
- en: External USB disk enclosures typically contain one or more SATA drives. If feasible,
    you should remove SATA disks to gain direct access to the ATA interface. This
    allows you to directly query the drive interface and may have performance advantages
    in some cases (for example, USB 2.0 enclosures containing a SATA disk).
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 外部 USB 磁盘外壳通常包含一个或多个 SATA 驱动器。如果可行，你应当拆卸 SATA 磁盘以直接访问 ATA 接口。这可以让你直接查询驱动器接口，并且在某些情况下可能带来性能优势（例如，包含
    SATA 磁盘的 USB 2.0 外壳）。
- en: Forensic write blockers designed specifically for imaging USB devices exist
    and can be used for drives (flash or otherwise) that have integrated USB interfaces.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 专门为成像 USB 设备设计的法医写入阻止器已经存在，可以用于具有集成 USB 接口的驱动器（无论是闪存驱动器还是其他驱动器）。
- en: '***Thunderbolt***'
  id: totrans-151
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***Thunderbolt***'
- en: Thunderbolt was developed jointly by Apple and Intel as a high-speed external
    interface to connect disks, video displays, and PCI Express devices using a single
    interface (see [Figure 1-21](ch01.xhtml#ch1fig21)). Using the code name Light
    Peak, it was originally intended to be a fiber optic connection. The physical
    interface uses Mini DisplayPort for Thunderbolt 1 and Thunderbolt 2, and it transitions
    to the USB Type C cable and connector for Thunderbolt 3\. Apple is largely responsible
    for the popularity of Thunderbolt (primarily among Apple users), promoting it
    with Apple hardware. The Thunderbolt 3 interface combines PCI Express, DisplayPort,
    and USB3 into a single interface. Thunderbolt 1, 2, and 3 offer speeds of 10,
    20, and 40Gbps, respectively.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: Thunderbolt 是由 Apple 和 Intel 联合开发的高速外部接口，用于通过单一接口连接磁盘、视频显示器和 PCI Express 设备（参见
    [图 1-21](ch01.xhtml#ch1fig21)）。其代号为 Light Peak，最初计划作为光纤连接。物理接口在 Thunderbolt 1
    和 Thunderbolt 2 中使用 Mini DisplayPort，而在 Thunderbolt 3 中则过渡为 USB Type C 电缆和连接器。Apple
    在 Thunderbolt 的普及上发挥了重要作用（尤其是在 Apple 用户中），通过 Apple 硬件进行推广。Thunderbolt 3 接口将 PCI
    Express、DisplayPort 和 USB3 集成到单一接口中。Thunderbolt 1、2 和 3 分别提供 10、20 和 40Gbps 的传输速度。
- en: '![image](../images/f01-21.jpg)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-21.jpg)'
- en: '*Figure 1-21: Thunderbolt interface*'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-21：Thunderbolt 接口*'
- en: For Apple computer systems, you can use *Target Disk Mode (TDM)* with Thunderbolt
    (as with FireWire) to make the system behave as an external disk enclosure to
    another connected system. TDM instructs the Apple firmware to make the internal
    disks available as block devices, which can be accessed as external SCSI drives
    (useful when using forensic tools). I’ll demonstrate the forensic acquisition
    of an Apple computer using TDM in “[Apple Target Disk Mode](ch05.xhtml#ch05lev2sec17)”
    on [page 137](ch05.xhtml#page_137).
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 对于苹果计算机系统，你可以使用*目标磁盘模式（TDM）*与Thunderbolt一起使用（如同FireWire一样），使系统表现为连接的另一个系统的外部磁盘机箱。TDM指示苹果固件将内部磁盘作为块设备提供，可以像外部SCSI驱动器一样访问（在使用取证工具时非常有用）。我将在[第137页](ch05.xhtml#page_137)的《[苹果目标磁盘模式](ch05.xhtml#ch05lev2sec17)》中演示如何使用TDM进行苹果计算机的取证采集。
- en: Thunderbolt external disks typically contain one or more SATA drives. In large
    thunderbolt RAID enclosures, the interface may use a SAS controller together with
    multiple SATA or SAS disks.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: Thunderbolt外部磁盘通常包含一个或多个SATA驱动器。在大型Thunderbolt RAID机箱中，该接口可能使用SAS控制器与多个SATA或SAS磁盘配合使用。
- en: 'The Linux dmesg output of an external disk attached with a Thunderbolt interface
    looks like this:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 连接Thunderbolt接口的外部磁盘的Linux dmesg输出如下所示：
- en: '[PRE3]'
  id: totrans-158
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: At the time of this writing, the Linux kernel supports Thunderbolt interfaces
    on Apple computers. Add-in cards for PC mainboards, such as ASUS ThunderboltEX
    II, do not support the hot plugging of devices. However, booting the PC with the
    Thunderbolt disk attached allows the PC’s BIOS/firmware to initialize the Thunderbolt
    adapter before the OS loads, making external disks visible to the kernel.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 在撰写本文时，Linux内核支持苹果计算机上的Thunderbolt接口。PC主板的附加卡，如ASUS ThunderboltEX II，不支持设备热插拔。但是，启动PC时将Thunderbolt磁盘连接上，可以让PC的BIOS/固件在操作系统加载之前初始化Thunderbolt适配器，使外部磁盘对内核可见。
- en: As of this writing, no write blockers are on the market for Thunderbolt interfaces.
    Also, no disks are currently available with directly integrated Thunderbolt interfaces
    (enclosures only).
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 截至本文撰写时，市面上没有用于Thunderbolt接口的写保护器。此外，目前没有直接集成Thunderbolt接口的磁盘（仅有机箱）。
- en: '***Legacy Interfaces***'
  id: totrans-161
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***遗留接口***'
- en: This section does not discuss the long history of computer disk interfaces;
    instead, it briefly covers the recently obsoleted IDE, parallel SCSI, and FireWire
    technologies. These interfaces may still be relevant in the context of a forensic
    investigation as older hardware is discovered or seized as evidence.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 本节不讨论计算机磁盘接口的悠久历史；而是简要介绍了最近已过时的IDE、并行SCSI和FireWire技术。这些接口在取证调查中可能仍然具有相关性，因为可能会发现或查获作为证据的旧硬件。
- en: The IDE interface (see [Figure 1-22](ch01.xhtml#ch1fig22)) and Enhanced version
    (EIDE) typically used for 3.5-inch disks were popular interfaces until they were
    replaced by SATA.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: IDE接口（参见[图1-22](ch01.xhtml#ch1fig22)）和增强版（EIDE）通常用于3.5英寸磁盘，在被SATA取代之前是流行的接口。
- en: '![image](../images/f01-22.jpg)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-22.jpg)'
- en: '*Figure 1-22: IDE disk interface*'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: '*图1-22：IDE磁盘接口*'
- en: The mini IDE interface (see [Figure 1-23](ch01.xhtml#ch1fig23)) was developed
    for 2.5-inch disks for use in notebook computers until it was replaced by SATA.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 迷你IDE接口（参见[图1-23](ch01.xhtml#ch1fig23)）是为2.5英寸磁盘开发的，用于笔记本电脑，直到被SATA取代。
- en: '![image](../images/f01-23.jpg)'
  id: totrans-167
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-23.jpg)'
- en: '*Figure 1-23: Mini IDE disk interface*'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: '*图1-23：迷你IDE磁盘接口*'
- en: The micro IDE ZIF interface (see [Figure 1-24](ch01.xhtml#ch1fig24)) was developed
    for 1.8-inch hard disks in sub-notebooks and other small electronic devices until
    it was replaced by mSATA and M.2 interfaces.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 微型IDE ZIF接口（参见[图1-24](ch01.xhtml#ch1fig24)）是为1.8英寸硬盘在超便携笔记本和其他小型电子设备中开发的，直到被mSATA和M.2接口取代。
- en: '![image](../images/f01-24.jpg)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-24.jpg)'
- en: '*Figure 1-24: Micro IDE ZIF interface*'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: '*图1-24：微型IDE ZIF接口*'
- en: The FireWire, or IEEE1394, interface (see [Figure 1-25](ch01.xhtml#ch1fig25))
    was developed by Apple to provide a high-speed external bus to connect video equipment
    and disk drives. This interface has largely been replaced by Thunderbolt and USB3.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: FireWire，或称IEEE1394接口（参见[图1-25](ch01.xhtml#ch1fig25)），由苹果公司开发，旨在提供高速外部总线，连接视频设备和磁盘驱动器。该接口目前已主要被Thunderbolt和USB3取代。
- en: '![image](../images/f01-25.jpg)'
  id: totrans-173
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-25.jpg)'
- en: '*Figure 1-25: Firewire interfaces*'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '*图1-25：Firewire接口*'
- en: The parallel SCSI interface (see [Figure 1-26](ch01.xhtml#ch1fig26)) has largely
    disappeared from the consumer market and has been replaced primarily by SATA (or
    SAS in the enterprise market).
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 并行SCSI接口（参见[图1-26](ch01.xhtml#ch1fig26)）在消费市场上基本消失，主要被SATA（或在企业市场上被SAS）取代。
- en: '![image](../images/f01-26.jpg)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-26.jpg)'
- en: '*Figure 1-26: SCSI interfaces*'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-26：SCSI 接口*'
- en: Forensic write blockers for IDE, SCSI, and FireWire are common and also function
    with adapters for mini IDE, micro IDE ZIF, and various SCSI interface adapters.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 用于 IDE、SCSI 和 FireWire 的取证写入阻止器很常见，并且也适用于 mini IDE、micro IDE ZIF 以及各种 SCSI 接口适配器的适配器。
- en: '**Commands, Protocols, and Bridges**'
  id: totrans-179
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**命令、协议和桥接**'
- en: The communication between storage devices and computer systems has some conceptual
    similarities to LAN/WAN layered networking.^([3](footnote.xhtml#fn07)) The communication
    between storage devices and computer systems can be similarly organized into several
    layers of abstraction. There is a physical layer consisting of cables, wires,
    and electrical signals. Above that, there is a link layer where digital bits and
    bytes are transmitted in an organized manner using frames or link layer packets.
    On top of the link layer, protocols and commands are exchanged between a sender
    and receiver to request and receive data. In previous sections, I described the
    physical connections and disk interfaces. Here, I’ll describe the higher-layer
    command sets for ATA, SCSI, and NVME. [Figure 1-27](ch01.xhtml#ch1fig27) puts
    the different layers of abstraction into better perspective.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 存储设备与计算机系统之间的通信在概念上与局域网/广域网分层网络有些相似。^([3](footnote.xhtml#fn07)) 存储设备与计算机系统之间的通信可以类似地组织成几个抽象层。物理层由电缆、导线和电气信号组成。其上是链路层，数字比特和字节通过帧或链路层数据包有序地传输。在链路层之上，协议和命令在发送方和接收方之间交换，以请求和接收数据。在前面的部分中，我描述了物理连接和磁盘接口。这里，我将描述
    ATA、SCSI 和 NVME 的更高层命令集。[图 1-27](ch01.xhtml#ch1fig27) 更好地展示了不同的抽象层。
- en: '***ATA Commands***'
  id: totrans-181
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***ATA 命令***'
- en: The current Advanced Technology Attachment (ATA) commands originally evolved
    from the American National Standards Institute (ANSI) standard, which defined
    the AT Attachment interface for disk drives.^([4](footnote.xhtml#fn07a)) The original
    standard described the physical interface (cables, pins, and so on), electrical
    signals, and logical commands that could be issued. The current standard^([5](footnote.xhtml#fn08))
    describes feature sets that drives may have and the ATA commands available to
    control each drive. The ATA Packet Interface (ATAPI) adds a packet command feature
    set to the ATA standard, allowing additional commands not specific to disk drive
    functionality (for example, ejecting media, encapsulating SCSI commands, and so
    on).
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 当前的高级技术附件（ATA）命令最初是由美国国家标准学会（ANSI）标准演变而来的，该标准定义了磁盘驱动器的 AT 附件接口。^([4](footnote.xhtml#fn07a))
    原始标准描述了物理接口（电缆、引脚等）、电气信号和可以发出的逻辑命令。当前的标准^([5](footnote.xhtml#fn08)) 描述了驱动器可能具备的功能集以及用于控制每个驱动器的
    ATA 命令。ATA 包装接口（ATAPI）将一个数据包命令功能集添加到 ATA 标准中，允许额外的命令，这些命令并不特定于磁盘驱动器功能（例如，弹出媒体、封装
    SCSI 命令等）。
- en: '![image](../images/f01-27.jpg)'
  id: totrans-183
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-27.jpg)'
- en: '*Figure 1-27: Abstraction layers as applied to disk interfaces*'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 1-27：应用于磁盘接口的抽象层*'
- en: The ATA Command Set (ACS) defines a set of commands and parameters that can
    be loaded into ATA registers and sent to a drive for execution. Some common ATA
    commands are shown in [Table 1-1](ch01.xhtml#ch1table1).
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: ATA 命令集（ACS）定义了一组命令和参数，这些命令和参数可以加载到 ATA 寄存器中，并发送到驱动器执行。一些常见的 ATA 命令列在 [表 1-1](ch01.xhtml#ch1table1)
    中。
- en: '**Table 1-1:** Common ATA Commands'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: '**表 1-1：** 常见的 ATA 命令'
- en: '| **Command** | **Command code** |'
  id: totrans-187
  prefs: []
  type: TYPE_TB
  zh: '| **命令** | **命令代码** |'
- en: '| --- | --- |'
  id: totrans-188
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| DEVICE RESET | 08h |'
  id: totrans-189
  prefs: []
  type: TYPE_TB
  zh: '| 设备重置 | 08h |'
- en: '| READ SECTOR(S) | 20h |'
  id: totrans-190
  prefs: []
  type: TYPE_TB
  zh: '| 读取扇区 | 20h |'
- en: '| WRITE SECTOR(S) | 30h |'
  id: totrans-191
  prefs: []
  type: TYPE_TB
  zh: '| 写入扇区 | 30h |'
- en: '| SEEK | 70h |'
  id: totrans-192
  prefs: []
  type: TYPE_TB
  zh: '| 寻址 | 70h |'
- en: '| DOWNLOAD MICROCODE | 92h |'
  id: totrans-193
  prefs: []
  type: TYPE_TB
  zh: '| 下载微码 | 92h |'
- en: '| MEDIA EJECT | EDh |'
  id: totrans-194
  prefs: []
  type: TYPE_TB
  zh: '| 媒体弹出 | EDh |'
- en: '| SECURITY UNLOCK | F2h |'
  id: totrans-195
  prefs: []
  type: TYPE_TB
  zh: '| 安全解锁 | F2h |'
- en: A number of ATA and ATAPI commands can be issued using the hdparm and smartctls
    utilities. T13 (*[http://t13.org/](http://t13.org/)*) publishes the standard that
    defines the full set of commands. You can find additional resources at *[http://sata-io.org/](http://sata-io.org/)*.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 一些 ATA 和 ATAPI 命令可以使用 hdparm 和 smartctls 工具发布。T13 (*[http://t13.org/](http://t13.org/)*)
    发布了定义完整命令集的标准。你可以在 *[http://sata-io.org/](http://sata-io.org/)* 上找到更多资源。
- en: Understanding the basic operation of ATA/ATAPI commands provides the background
    knowledge you need to understand how SATA and IDE forensic write blockers function
    (preventing ATA/ATAPI commands from modifying disks). Knowing how these commands
    operate also improves your understanding of how a forensic examiner can query
    the attributes of a disk and ultimately perform a successful forensic acquisition.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 理解ATA/ATAPI命令的基本操作为你提供了必要的背景知识，帮助你理解SATA和IDE取证写阻断器的工作原理（防止ATA/ATAPI命令修改磁盘）。了解这些命令的操作方式也能提升你对取证检查员如何查询磁盘属性并最终进行成功取证采集的理解。
- en: '***SCSI Commands***'
  id: totrans-198
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***SCSI命令***'
- en: SCSI commands from a host bus adapter to a disk follow a client/server model.
    The host bus adapter (HBA) is the client, or *initiator*, and the disk is the
    server, or *target*. The initiator sends commands (possibly together with data)
    to the target, and the target returns a response (possibly together with data).
    SCSI was originally designed for use with a variety of devices, including scanners,
    tapes, printers, and so on, not just hard disks. Therefore, SCSI has a rich command
    set. Commands are sent from the initiator (HBA) to the target (drive) using a
    *command descriptor block (CDB)*, which is a block of data containing the command
    and its parameters. The target receives the CDB, carries out the request, and
    returns a response. The interaction is somewhat similar to a UDP-based request/response
    in a TCP/IP client/server architecture.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 从主机总线适配器到磁盘的SCSI命令遵循客户端/服务器模型。主机总线适配器（HBA）是客户端或*发起者*，而磁盘是服务器或*目标*。发起者向目标发送命令（可能还附带数据），目标则返回响应（可能还附带数据）。SCSI最初是为多种设备设计的，包括扫描仪、磁带、打印机等，而不仅仅是硬盘。因此，SCSI具有丰富的命令集。命令通过*命令描述符块（CDB）*从发起者（HBA）发送到目标（磁盘）。CDB是一个包含命令及其参数的数据块。目标接收CDB，执行请求并返回响应。这个过程有些类似于基于UDP的请求/响应机制，在TCP/IP客户端/服务器架构中使用。
- en: 'SCSI commands exist to read and write blocks of data from/to a disk, control
    hardware (ejecting CDs or changing tapes), report status and diagnostic information,
    and so on. These commands are generally hidden from the end user, but various
    utilities are available to issue SCSI commands from user space. It’s even possible
    to submit arbitrary commands from the Linux command line using tools from the
    sg3_utils software package. For example, the following command submits a low-level
    SCSI command to read the first sector of a SCSI disk:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: SCSI命令用于从磁盘读写数据块、控制硬件（如弹出CD或更换磁带）、报告状态和诊断信息等。这些命令通常对终端用户隐藏，但有多种实用工具可以从用户空间发出SCSI命令。甚至可以使用`sg3_utils`软件包中的工具，从Linux命令行提交任意命令。例如，以下命令会提交一个低级的SCSI命令，读取SCSI磁盘的第一个扇区：
- en: '[PRE4]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: In this example `sg_raw` is given a CDB command to be sent to */dev/sda*, a
    SAS disk. The first byte, `0x08`, specifies the 6-byte long SCSI `READ` command.
    The subsequent zeros specify the LUN and starting sector. The `0x01` specifies
    the number of sectors to read, and `-r 512` tells `sg_raw` how many bytes to display.
    This example should also work on SAS-, SATA-, and USB-attached drives.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，`sg_raw`接收到一个CDB命令，向*/dev/sda*（一块SAS磁盘）发送命令。第一个字节`0x08`指定了6字节长的SCSI `READ`命令。随后的零指定了LUN和起始扇区。`0x01`指定了要读取的扇区数，`-r
    512`告诉`sg_raw`显示多少字节。这个示例也应该适用于SAS、SATA和USB连接的磁盘。
- en: Technical standards for SCSI and SAS commands are maintained by the Technical
    Committee T10 of INCITS (InterNational Committee for Information Technology Standards).
    You can find these standards at *[http://t10.org/](http://t10.org/)*. Books on
    SCSI programming are useful to better understand the SCSI command protocol.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: SCSI和SAS命令的技术标准由INCITS（国际信息技术标准委员会）下属的技术委员会T10维护。你可以在* [http://t10.org/](http://t10.org/)*找到这些标准。关于SCSI编程的书籍有助于更好地理解SCSI命令协议。
- en: Understanding the basic operation of SAS/SCSI commands is relevant to this book.
    It provides the background knowledge to understand how SAS/SCSI forensic write
    blockers function (preventing SAS/SCSI commands from modifying disks). Knowing
    how SAS/SCSI commands operate improves your understanding of how a forensic examiner
    can query the attributes of a disk and ultimately perform a forensic acquisition.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 理解SAS/SCSI命令的基本操作与本书相关。它为你提供了理解SAS/SCSI取证写阻断器如何工作的背景知识（防止SAS/SCSI命令修改磁盘）。了解SAS/SCSI命令的操作方式提高了你对取证检查员如何查询磁盘属性并最终执行取证采集的理解。
- en: SCSI commands are also used to control tapes and optical devices.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: SCSI命令还用于控制磁带和光学设备。
- en: '***NVME Commands***'
  id: totrans-206
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***NVME命令***'
- en: The NVME command set was created from scratch without providing backward compatibility
    for existing SCSI or ATA command sets. It was designed to support SSD media directly
    attached to the PCI express bus and to take advantage of parallelization with
    multiple CPUs and instant SSD seek times (no latency overhead from moving disk
    heads). The standard’s developers also recognized that with the drive connected
    directly to the PCIE bus, much of the protocol overhead in ATA or SCSI could be
    eliminated. A new minimal command set was created, free of legacy commands or
    backward compatibility requirements. The performance and efficiency of NVME drives
    is a significant improvement over SATA or SAS. An extensive command queuing system
    provides up to 64k queues able to hold 64k commands each (in contrast, SATA had
    32 queues with one command each).
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: NVME命令集是从零开始创建的，没有为现有的SCSI或ATA命令集提供向后兼容性。它的设计目的是直接支持连接到PCI Express总线的SSD介质，并利用多CPU并行化以及即时的SSD寻址时间（没有磁头移动的延迟开销）。标准的开发者还认识到，通过将驱动器直接连接到PCIE总线，ATA或SCSI中的许多协议开销可以被消除。于是，创建了一个新的最小命令集，摆脱了传统命令或向后兼容性的要求。NVME驱动器的性能和效率相比SATA或SAS有了显著提升。一个广泛的命令排队系统支持最多64k个队列，每个队列可以容纳64k个命令（相比之下，SATA只有32个队列，每个队列只有一个命令）。
- en: A translation reference between SCSI and NVME commands is available at *[http://nvmexpress.org/](http://nvmexpress.org/)*.
    [Table 1-2](ch01.xhtml#ch1table2) shows the more common examples.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 可以参考*SCSI*和*NVME*命令之间的翻译参考资料，地址为*[http://nvmexpress.org/](http://nvmexpress.org/)*。[表
    1-2](ch01.xhtml#ch1table2)展示了更常见的示例。
- en: '**Table 1-2:** SCSI and NVME Command Comparison'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: '**表 1-2：** SCSI和NVME命令比较'
- en: '| **SCSI** | **NVME** |'
  id: totrans-210
  prefs: []
  type: TYPE_TB
  zh: '| **SCSI** | **NVME** |'
- en: '| --- | --- |'
  id: totrans-211
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| COMPARE AND WRITE | Compare and Write |'
  id: totrans-212
  prefs: []
  type: TYPE_TB
  zh: '| COMPARE AND WRITE | 比较和写入 |'
- en: '| READ | Read |'
  id: totrans-213
  prefs: []
  type: TYPE_TB
  zh: '| READ | 读取 |'
- en: '| WRITE | Write |'
  id: totrans-214
  prefs: []
  type: TYPE_TB
  zh: '| WRITE | 写入 |'
- en: '| WRITE BUFFER | Firmware Image Download, Firmware Image Activate |'
  id: totrans-215
  prefs: []
  type: TYPE_TB
  zh: '| WRITE BUFFER | 固件镜像下载，固件镜像激活 |'
- en: '| INQUIRY | Identify |'
  id: totrans-216
  prefs: []
  type: TYPE_TB
  zh: '| INQUIRY | 识别 |'
- en: '| READ CAPACITY | Identify |'
  id: totrans-217
  prefs: []
  type: TYPE_TB
  zh: '| READ CAPACITY | 识别 |'
- en: '| REPORT LUNS | Identify |'
  id: totrans-218
  prefs: []
  type: TYPE_TB
  zh: '| REPORT LUNS | 识别 |'
- en: '| MODE SENSE | Identify, Get Features |'
  id: totrans-219
  prefs: []
  type: TYPE_TB
  zh: '| MODE SENSE | 识别，获取功能 |'
- en: '| LOG SENSE | Get Features, Get Log Page |'
  id: totrans-220
  prefs: []
  type: TYPE_TB
  zh: '| LOG SENSE | 获取功能，获取日志页 |'
- en: '| SYNCHRONIZE CACHE | Flush |'
  id: totrans-221
  prefs: []
  type: TYPE_TB
  zh: '| SYNCHRONIZE CACHE | 刷新 |'
- en: '| FORMAT UNIT | Format NVM |'
  id: totrans-222
  prefs: []
  type: TYPE_TB
  zh: '| FORMAT UNIT | 格式化NVM |'
- en: Disk devices can be attached to a PC system through various bus systems and
    bridges. Performance can be increased by attaching the drive as close as possible
    to the CPU and memory. Today, the closest a drive can get to the CPU and memory
    is through dedicated lanes of the PCI express 3.0 bus using the NVME interface
    (RAM disks are faster and more efficient, but they are created by the OS and are
    not non-volatile storage media devices). An NVME device can be directly attached
    to the CPU without using a southbridge chipset or any traditional disk protocol
    overhead, such as ATA or SCSI.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 磁盘设备可以通过各种总线系统和桥接器连接到PC系统。通过将驱动器尽可能靠近CPU和内存，可以提高性能。目前，驱动器可以通过使用NVME接口的PCI Express
    3.0总线专用通道与CPU和内存连接（RAM磁盘更快、更高效，但它们由操作系统创建，并非非易失性存储介质设备）。NVME设备可以直接连接到CPU，而不需要使用南桥芯片组或任何传统的磁盘协议开销，如ATA或SCSI。
- en: '***Bridging, Tunneling, and Pass-Through***'
  id: totrans-224
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***桥接、隧道化和透传***'
- en: ATA and SCSI are the two most common protocols for interacting with storage
    media. The commands can be sent over a variety of physical layer buses or transport
    layers, or even tunneled or encapsulated within other protocols. This complexity
    is hidden from the user, and attached devices can simply be accessed through standard
    block devices that the Linux kernel makes available.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: ATA和SCSI是与存储介质交互的两种最常见的协议。这些命令可以通过多种物理层总线或传输层发送，甚至可以通过其他协议隧道化或封装。这些复杂性对用户是透明的，附加设备可以通过Linux内核提供的标准块设备进行访问。
- en: To illustrate, consider a SATA hard disk plugged into a stand-alone USB docking
    station, which is plugged into an external port of a USB3 PCI express card installed
    in a PC. The communication between the disk interface and the dock is a lower-layer
    SATA protocol, using SATA Frame Information Structures (FIS) packets. The communication
    between the dock and the USB3 card is a lower-layer USB protocol, using BOT or
    USAP. The communication between the USB3 card and the PC is a lower-layer PCI
    express protocol, using PCIE Transaction Layer Packets (TLP) and Data Link Layer
    Packets (DLLP). Finally, the disk is accessed across all these bridges using the
    SCSI command protocol. In this example, multiple physical and link layers are
    used to connect the disk. To the user, the disk appears directly accessible, and
    the lower protocol layers are hidden or abstracted from view.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 为了说明，考虑一个SATA硬盘插入一个独立的USB对接站，而这个对接站又插入到PC中安装的USB3 PCI Express卡的外部端口。硬盘接口和对接站之间的通信是较低层次的SATA协议，使用SATA帧信息结构（FIS）数据包。对接站和USB3卡之间的通信是较低层次的USB协议，使用BOT或USAP。USB3卡和PC之间的通信是较低层次的PCI
    Express协议，使用PCIE事务层数据包（TLP）和数据链路层数据包（DLLP）。最后，硬盘通过这些桥接层使用SCSI命令协议进行访问。在这个示例中，使用了多个物理和链路层来连接硬盘。对用户来说，硬盘看起来是直接可访问的，较低层次的协议层被隐藏或抽象化。
- en: '**NOTE**'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*FIS are part of the SATA protocol. PCI Express has its own set of protocols,
    which include TLP and DLLP.*'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: '*FIS是SATA协议的一部分。PCI Express有自己的一套协议，包括TLP和DLLP。*'
- en: For each of the different physical buses, a device called a *PHY* (for *physical*)
    facilitates communication between devices connected to a bus (the PHYs on a bus
    work a bit like two modems communicating over a WAN cable). The PHY converts the
    digital ones and zeros into compliant electrical signals expected for that bus.
    After the PHY has taken care of the physical layer, a link layer protocol manages
    the stream of bits/bytes that is being transferred back and forth on the bus.
    This link layer organizes the data stream into frames or discrete packets of information
    that upper layers can process.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 对于每种不同的物理总线，称为*PHY*（物理层）的设备促进了连接到总线的设备之间的通信（总线上的PHY工作方式有点像两个调制解调器通过WAN电缆进行通信）。PHY将数字的1和0转换为该总线所期望的符合电气信号要求的信号。在PHY处理完物理层之后，链路层协议管理在总线上来回传输的比特/字节流。这个链路层将数据流组织成帧或离散的数据包，供上层处理。
- en: There are physical and link layer descriptions for USB, PCIE, Thunderbolt, SAS,
    SATA, Fibre Channel, and so on. Typically, standards exist that allow generic
    OS drivers to use the physical hardware in a device-independent way. For example,
    USB adapters are defined by the xHCI standard, SATA adapters are defined by the
    AHCI standard, NVME devices are defined by the NVMHCI standard (now simply called
    the NVME standard), and so on. Compliance with these standards allows hardware
    to be supported without the need for additional proprietary drivers.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 存在USB、PCIE、Thunderbolt、SAS、SATA、光纤通道等的物理层和链路层描述。通常，存在一些标准，允许通用操作系统驱动程序以与硬件无关的方式使用设备中的物理硬件。例如，USB适配器由xHCI标准定义，SATA适配器由AHCI标准定义，NVME设备由NVMHCI标准定义（现在简称为NVME标准）等等。符合这些标准允许硬件在不需要额外专有驱动程序的情况下得到支持。
- en: Although ATA/ATAPI and SCSI are distinct command sets, they both support some
    degree of tunneling and pass-through of each other’s commands. ATA uses the ATAPI
    interface to encapsulate SCSI commands for communication with devices, such as
    optical drives, tape drives, and other devices that understand SCSI commands for
    ejecting media and other commands not found in the ATA protocol. SCSI supports
    ATA pass-through, which allows ATA commands to be sent over the SCSI protocol.
    SAT (SCSI-ATA Translation) creates a bilateral translation between SCSI and ATA
    commands where the commands interact with storage media. This translation is implemented
    as a Linux kernel API within the libata library. (The libata library, sometimes
    spelled *libATA*, provides a number of features for interfacing with ATA controllers
    and devices.)
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管ATA/ATAPI和SCSI是不同的命令集，但它们都支持某种程度的隧道传输和相互通过对方的命令。ATA使用ATAPI接口封装SCSI命令，与诸如光驱、磁带驱动器以及其他理解SCSI命令（如弹出介质及ATA协议中没有的其他命令）的设备进行通信。SCSI支持ATA通行，这允许ATA命令通过SCSI协议发送。SAT（SCSI-ATA转换）在SCSI和ATA命令之间创建了双向转换，其中命令与存储介质交互。这种转换作为Linux内核API在libata库中实现。（libata库，有时拼写为*libATA*，提供了与ATA控制器和设备接口的许多功能。）
- en: Bridges play an important role in forensic acquisition because they’re the basis
    for implementing hardware write blockers. A hardware write blocker is typically
    a bridge capable of intercepting ATA or SCSI commands sent to the disk, preventing
    commands from modifying sectors on a disk.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 桥接设备在法医采集中发挥着重要作用，因为它们是实现硬件写入阻止器的基础。硬件写入阻止器通常是一个能够拦截发送到磁盘的ATA或SCSI命令的桥接设备，防止这些命令修改磁盘上的扇区。
- en: '**Special Topics**'
  id: totrans-233
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**专题**'
- en: This section covers a number of special topics related to mass storage and digital
    forensics. Some areas, such as UASP and SSHD, are briefly commented on regarding
    their relevance to digital forensics. Other areas, such as DCO, HPA, and NVME
    drives, are introduced here and discussed in more detail later in the book.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 本节涉及与大容量存储和数字取证相关的多个专题。某些领域，例如UASP和SSHD，简要讨论了它们与数字取证的相关性。其他领域，如DCO、HPA和NVME驱动器，在这里介绍，并在本书后续部分进行更详细的讨论。
- en: '***DCO and HPA Drive Areas***'
  id: totrans-235
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***DCO和HPA驱动器区域***'
- en: As the ATA/ATAPI standards evolved, certain features were created to benefit
    system vendors. The *Host Protected Area (HPA)* was introduced in the ATA/ATAPI-4
    standard and allowed system vendors to reserve portions of the disk for use outside
    the normal OS. For example, the HPA can be used to store persistent data, system
    recovery data, hibernation data, and so on. Access to this data is controlled
    by the system firmware rather than the installed OS. The *Device Configuration
    Overlay (DCO)* feature was introduced in the ATA/ATAPI-6 standard and provided
    the ability to control reported disk features and capacity. This allowed system
    vendors to ship disks from multiple manufacturers while maintaining identical
    numbers of user-accessible sectors and features across the disks. This facilitated
    easier support and drive replacement. Both the HPA and DCO can coexist; however,
    the DCO must be created first, followed by the HPA.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 随着ATA/ATAPI标准的演进，某些特性被创建以便惠及系统供应商。*主机保护区（HPA）*是在ATA/ATAPI-4标准中引入的，它允许系统供应商为操作系统外部使用保留磁盘的部分空间。例如，HPA可以用于存储持久数据、系统恢复数据、休眠数据等。对这些数据的访问由系统固件控制，而非安装的操作系统。*设备配置覆盖（DCO）*特性是在ATA/ATAPI-6标准中引入的，它提供了控制报告的磁盘特性和容量的能力。这使得系统供应商能够从多个制造商处运输磁盘，同时在各磁盘间保持相同数量的用户可访问扇区和特性。这促进了支持和驱动器更换的简化。HPA和DCO可以共存；然而，DCO必须首先创建，然后是HPA。
- en: 'The HPA and DCO have been misused by criminals and malicious actors to hide
    illicit files and malware code. I describe how to detect and remove the HPA and
    DCO, revealing sectors hidden from normal user view, in “[Enable Access to Hidden
    Sectors](ch05.xhtml#ch05lev1sec04)” on [page 118](ch05.xhtml#page_118). You’ll
    find a more detailed description of the HPA and DCO related to forensics in the
    paper “Hidden Disk Areas: HPA and DCO.”^([6](footnote.xhtml#fn09)) Information
    is also available about nation state exploitation using the HPA at *[https://www.schneier.com/blog/archives/2014/02/swap_nsa_exploi.html](https://www.schneier.com/blog/archives/2014/02/swap_nsa_exploi.html)*
    and *[https://leaksource.files.wordpress.com/2013/12/nsa-ant-swap.jpg](https://leaksource.files.wordpress.com/2013/12/nsa-ant-swap.jpg)*.'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: HPA和DCO已被犯罪分子和恶意行为者滥用，用于隐藏非法文件和恶意代码。我在《[启用对隐藏扇区的访问](ch05.xhtml#ch05lev1sec04)》中描述了如何检测和删除HPA和DCO，揭示隐藏在普通用户视野中的扇区，具体见[第118页](ch05.xhtml#page_118)。关于HPA和DCO在法医领域的更详细描述，请参阅论文《隐藏磁盘区域：HPA和DCO》。^([6](footnote.xhtml#fn09))
    关于国家级利用HPA的更多信息，可以参考* [https://www.schneier.com/blog/archives/2014/02/swap_nsa_exploi.html](https://www.schneier.com/blog/archives/2014/02/swap_nsa_exploi.html)
    *和* [https://leaksource.files.wordpress.com/2013/12/nsa-ant-swap.jpg](https://leaksource.files.wordpress.com/2013/12/nsa-ant-swap.jpg)
    *。
- en: '***Drive Service and Maintenance Areas***'
  id: totrans-238
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***驱动器服务与维护区域***'
- en: Certain maintenance areas of a hard disk are generally not accessible using
    standard Linux tools. These areas contain bad sectors lists and vendor service
    sectors (sometimes referred to as negative sectors). To access these areas of
    the disk, you’ll need specialized disk diagnostic software and hardware. I show
    an example of accessing the service area of a disk and provide some additional
    resources in “[Drive Service Area Access](ch05.xhtml#ch05lev2sec10)” on [page
    122](ch05.xhtml#page_122). Don’t confuse the service area of a disk with the HPA
    or DCO. You can easily access HPA and DCO areas using standard ATA commands and
    methods, but not the service areas of a disk.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 硬盘的某些维护区域通常无法使用标准Linux工具访问。这些区域包含坏道列表和厂商服务扇区（有时称为负扇区）。要访问这些区域，你需要专门的磁盘诊断软件和硬件。我在“[驱动器服务区域访问](ch05.xhtml#ch05lev2sec10)”中提供了一个访问磁盘服务区域的示例，并在[第122页](ch05.xhtml#page_122)提供了一些额外的资源。不要将磁盘的服务区域与HPA或DCO混淆。你可以使用标准的ATA命令和方法轻松访问HPA和DCO区域，但无法访问磁盘的服务区域。
- en: '***USB Attached SCSI Protocol***'
  id: totrans-240
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***USB附加SCSI协议***'
- en: 'USB provides two modes for accessing mass storage class devices: the more common
    BOT and the newer UASP. With the increased speeds of USB3 and USB3.1, a new and
    more efficient USB mass storage class transport protocol was developed called
    *USB Attached SCSI Protocol (UASP)*. This new protocol is also referred to as
    *UAS* and the product-marketing nicknames USB3 Boost, USB3 Turbo, or USB3 Extreme
    are sometimes used. You’ll find more information at *[http://usb.org/](http://usb.org/)*
    and *[http://t10.org/](http://t10.org/)*, the organizations that jointly developed
    the standard. UASP improves performance by providing command queuing and asynchronous
    processing and by improving task and command control capability.'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: USB提供了两种访问大容量存储设备的模式：更常见的BOT模式和更新的UASP模式。随着USB3和USB3.1速度的提升，开发了一种新的、更高效的USB大容量存储协议，称为*USB附加SCSI协议（UASP）*。这个新协议也被称为*UAS*，并且有时会使用USB3
    Boost、USB3 Turbo或USB3 Extreme等产品营销别名。你可以在* [http://usb.org/](http://usb.org/)*
    和 *[http://t10.org/](http://t10.org/)* 找到更多信息，这些组织共同开发了这个标准。UASP通过提供命令排队和异步处理，并且改善任务和命令控制能力，来提高性能。
- en: 'The dmesg output of an attached UASP-enabled USB disk uses the `uas` protocol
    for operation:'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 附加UASP支持的USB磁盘的dmesg输出使用`uas`协议进行操作：
- en: '[PRE5]'
  id: totrans-243
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'In contrast, the same disk connected with a traditional BOT USB interface loads
    the `usb-storage` protocol for operation:'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 相比之下，使用传统BOT USB接口连接的相同磁盘会加载`usb-storage`协议进行操作：
- en: '[PRE6]'
  id: totrans-245
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: From a forensics perspective, it’s important to note that the transport protocol
    used does not affect the contents of the USB disk and has no effect on the cryptographic
    hash of the forensic image. In fact, it is advantageous to use UAS-based write
    blockers for the performance benefits (Tableau USB3 write blockers use UAS, for
    example).
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 从取证的角度来看，需要注意的是，所使用的传输协议不会影响USB磁盘的内容，也不会影响取证镜像的加密哈希值。实际上，使用基于UAS的写保护器在性能上是有优势的（例如，Tableau的USB3写保护器使用的是UAS）。
- en: '**NOTE**'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*One word of advice: when you’re using the higher speeds of USB3, the quality
    of the USB cables becomes an issue. Longer, lower-quality USB3 cables can produce
    read errors during acquisition. For those working in a professional forensic laboratory,
    it’s worth investing in short, high-quality USB3 cables.*'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: '*一句建议：当你使用USB3的更高速度时，USB电缆的质量就变得非常重要。较长且质量较差的USB3电缆可能会在数据采集过程中产生读取错误。对于那些在专业取证实验室工作的人来说，值得投资购买短小且高质量的USB3电缆。*'
- en: '***Advanced Format 4Kn***'
  id: totrans-249
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***高级格式 4Kn***'
- en: 'As disk capacities increased, the industry discovered that it could improve
    disk efficiency by switching from 512-byte sectors to 4096-byte sectors. The International
    Disk Drive Equipment and Materials Association (IDEMA) developed the Advanced
    Format standard for 4096-byte physcial sectors (see *[http://www.idema.org/?page_id=2369](http://www.idema.org/?page_id=2369)*).
    Since 2009, hard disk manufacturers have committed to using IDEMA’s Advanced Format
    standard to produce 4K sector disks. Even with 4K physical sectors, most disks
    today emulate 512-byte sectors and are called *Advanced Format 512e* disks. Disks
    that provide the host system and OS with native 4K-sized sectors are called *Advanced
    Format 4Kn* disks. Advanced Format 4Kn disks are still rare in the low-end marketplace
    but are used in enterprise environments. For higher-capacity enterprise disks,
    most enterprise disk manufacturers offer two models: 512e and 4Kn. [Figure 1-28](ch01.xhtml#ch1fig28)
    shows the official logo for 4Kn disks.'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 随着磁盘容量的增加，业界发现通过将磁盘从512字节扇区切换到4096字节扇区，可以提高磁盘效率。国际磁盘驱动设备与材料协会（IDEMA）为4096字节物理扇区制定了高级格式标准（见
    *[http://www.idema.org/?page_id=2369](http://www.idema.org/?page_id=2369)*）。自2009年以来，硬盘制造商承诺使用IDEMA的高级格式标准生产4K扇区磁盘。即使是使用4K物理扇区的磁盘，今天的大多数磁盘仍然模拟512字节扇区，这些磁盘被称为*高级格式512e*磁盘。那些为主机系统和操作系统提供原生4K大小扇区的磁盘被称为*高级格式4Kn*磁盘。高级格式4Kn磁盘在低端市场仍然稀有，但在企业环境中使用广泛。对于更大容量的企业磁盘，大多数企业磁盘制造商提供两种型号：512e和4Kn。[图1-28](ch01.xhtml#ch1fig28)展示了4Kn磁盘的官方标志。
- en: You’ll find a good overview of Advanced Format and 4K sectors on YouTube at
    *[https://www.youtube.com/watch?v=TmH3iRLhZ-A/](https://www.youtube.com/watch?v=TmH3iRLhZ-A/)*.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在YouTube上找到关于高级格式和4K扇区的良好概述，网址为 *[https://www.youtube.com/watch?v=TmH3iRLhZ-A/](https://www.youtube.com/watch?v=TmH3iRLhZ-A/)*。
- en: '![image](../images/f01-28.jpg)'
  id: totrans-252
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f01-28.jpg)'
- en: '*Figure 1-28: Advanced Format 4Kn logo*'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: '*图1-28：高级格式4Kn标志*'
- en: When the Linux kernel detects an attached disk, it displays the number of sectors
    and the logical sector size (in some cases, it may also explicitly display the
    physical size). The following partial dmesg output shows two equal-sized disks,
    one with Advanced Format 512e and the other with 4Kn. Dividing the number of 512-byte
    sectors by 8 or multiplying the number of 4K sectors by 8 shows the disks are
    equal in capacity but have different sector counts.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 当Linux内核检测到附加的磁盘时，它会显示扇区数量和逻辑扇区大小（在某些情况下，它还可能明确显示物理大小）。以下部分dmesg输出显示了两个相同大小的磁盘，一个是高级格式512e，另一个是4Kn。将512字节扇区的数量除以8，或者将4K扇区的数量乘以8，可以显示这两个磁盘容量相同，但扇区数不同。
- en: '[PRE7]'
  id: totrans-255
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'On a Linux system, you can use the */sys* pseudo filesystem to find the logical
    and physical sector sizes of a disk. For example, you can determine the physical
    and logical sector sizes of the attached disk */dev/sda* as follows:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 在Linux系统上，您可以使用*/sys*伪文件系统来查找磁盘的逻辑和物理扇区大小。例如，您可以按如下方式确定附加磁盘*/dev/sda*的物理和逻辑扇区大小：
- en: '[PRE8]'
  id: totrans-257
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: These two methods show reading from the */sys* pseudo filesystem (which you
    can also do as a non-root user) and using the `blockdev` command.
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 这两种方法展示了从*/sys*伪文件系统读取（您也可以作为非根用户执行此操作）并使用`blockdev`命令。
- en: Some SSDs allow you to choose the physical sector size with a firmware tool.
    For example, some recent Intel SSDs can change sector size between 512 and 4096
    using a command line tool provided by Intel (*[https://downloadcenter.intel.com/download/23931/](https://downloadcenter.intel.com/download/23931/)*).
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 一些SSD允许您使用固件工具选择物理扇区大小。例如，一些最新的英特尔SSD可以使用英特尔提供的命令行工具在512和4096之间切换扇区大小（* [https://downloadcenter.intel.com/download/23931/](https://downloadcenter.intel.com/download/23931/)*）。
- en: Several aspects of 4K disks are of interest to the digital forensics community
    and are discussed in the rest of this section. Some early Western Digital Advanced
    Format 512e disks had a jumper setting (jumpers 7 and 8) to internally offset
    the sectors to align the beginning of default XP partitions with the start of
    a 4K sector. This jumper setting to realign the disk greatly improved performance.
    Changing such sector alignment jumpers will affect forensic acquisition hash and
    potentially affect the analysis of a disk. When forensically imaging or verifying
    a disk, it is crucial to use the same jumper settings as when the drive was first
    seized.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 4K 磁盘的几个方面对数字取证社区具有重要意义，并将在本节剩余部分进行讨论。一些早期的西部数据高级格式 512e 磁盘有一个跳线设置（跳线 7 和 8），用于内部偏移扇区，使默认的
    XP 分区的起始位置与 4K 扇区的起始位置对齐。这个跳线设置重新对齐磁盘极大提高了性能。更改这样的扇区对齐跳线会影响取证获取哈希值，并可能影响磁盘的分析。在进行取证成像或验证磁盘时，必须使用与磁盘首次扣押时相同的跳线设置。
- en: The use of 4Kn disks will affect the value of *slack space*. RAM slack or memory
    slack is the unused part of the last sector of a file (not to be confused with
    *file slack*, which is the unused part of the last filesystem block of a file).
    When you’re using 4Kn disks with filesystems that use 4K blocks, the RAM slack
    and file slack are the same. OSes that pad the unused portion of a 4K sector with
    zeros before writing will eliminate the possibility of any useful data in file
    slack on filesystems with 4K blocks.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 4Kn 磁盘将影响*剩余空间*的值。RAM 剩余空间或内存剩余空间是文件最后一个扇区中未使用的部分（不要与*文件剩余空间*混淆，后者是文件系统中文件最后一个块中未使用的部分）。当你使用
    4Kn 磁盘且文件系统使用 4K 块时，RAM 剩余空间和文件剩余空间是相同的。操作系统在写入之前会用零填充 4K 扇区的未使用部分，这样就消除了文件系统中
    4K 块上的文件剩余空间中可能存在有用数据的可能性。
- en: Forensic software that assumes a 512-byte sector size may fail or, worse, produce
    incorrect results. When you’re using 4Kn disks, it’s important to confirm that
    the forensic software recognizes and uses 4Kn sectors. Sleuth Kit will default
    to 512-byte sectors and must be explicitly told to use 4K sectors for 4Kn disks.
    The following example shows `mmls` producing incorrect results by default and
    correct results when specifying the correct sector size.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 假设扇区大小为 512 字节的取证软件可能会失败，或者更糟糕的是，产生不正确的结果。当使用 4Kn 磁盘时，重要的是确认取证软件是否识别并使用 4Kn
    扇区。Sleuth Kit 默认使用 512 字节扇区，必须明确告知它使用 4K 扇区来处理 4Kn 磁盘。以下示例展示了 `mmls` 默认情况下产生不正确结果，而在指定正确扇区大小时产生正确结果。
- en: '[PRE9]'
  id: totrans-263
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: After specifying the 4096-byte sector size with the `-b` flag, the sectors of
    the Linux partition are represented as 4K units, and there is no unallocated area
    at the end of the drive. An example of successfully acquiring a native 4K sector
    disk is shown in “[The dcfldd and dc3dd Tools](ch06.xhtml#ch06lev2sec02)” on [page
    144](ch06.xhtml#page_144).
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用 `-b` 标志指定 4096 字节扇区大小后，Linux 分区的扇区被表示为 4K 单位，磁盘末尾没有未分配区域。成功获取原生 4K 扇区磁盘的示例如“[dcfldd
    和 dc3dd 工具](ch06.xhtml#ch06lev2sec02)”中第 [144 页](ch06.xhtml#page_144)所示。
- en: The use of Advanced Format 4Kn disks is still uncommon. It’s unclear how 4Kn
    sector disks will impact existing forensic acquisition and analysis software currently
    on the market, in particular where forensic tools fundamentally assume a 512-byte
    sector size. This is an area where more research by the digital forensics community
    is needed.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 高级格式 4Kn 磁盘的使用仍然不常见。目前尚不清楚 4Kn 扇区磁盘会如何影响现有的取证获取和分析软件，特别是那些基本假设扇区大小为 512 字节的取证工具。这是数字取证领域需要进一步研究的一个方向。
- en: '***NVME Namespaces***'
  id: totrans-266
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***NVME 命名空间***'
- en: The NVME specification introduces the concept of *namespaces*, which allow you
    to partition a drive at a lower layer, abstracted from the normal OS. Forensic
    imaging of a drive with multiple namespaces must be done separately for each namespace.
    You can determine the number of namespaces in several ways.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: NVME 规范引入了*命名空间*的概念，允许在较低层次上对磁盘进行分区，抽象化地与普通操作系统分离。对于具有多个命名空间的磁盘进行取证成像时，必须分别对每个命名空间进行处理。你可以通过几种方式确定命名空间的数量。
- en: 'By sending an identify controller `admin` command using the nvme-cli tool,
    you can check the number of namespaces supported and used. The following example
    shows various information about namespace support:'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 通过使用 nvme-cli 工具发送识别控制器 `admin` 命令，你可以检查支持和使用的命名空间数量。以下示例显示了有关命名空间支持的各种信息：
- en: '[PRE10]'
  id: totrans-269
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Here, Optional Admin Command Support (OACS) indicates that namespace management
    is not supported on this particular drive. The Number of Namespaces field (`nn`)
    shows the number of namespaces on the controller—one on this particular device.
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，可选的管理员命令支持（OACS）表示该特定硬盘不支持命名空间管理。命名空间数量字段（`nn`）显示控制器上的命名空间数量——该设备上只有一个。
- en: 'You can also check the size of the namespace by using nvme-cli and compare
    it with the manufacturer’s specifications, as follows:'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以使用 nvme-cli 检查命名空间的大小，并将其与制造商的规格进行比较，如下所示：
- en: '[PRE11]'
  id: totrans-272
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Here, `nsze` refers to the namespace size, `ncap` is the namespace capacity,
    and `nuse` is the namespace utilization. If these values match the vendor’s documented
    drive size, they confirm that a single namespace is being used.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，`nsze` 指的是命名空间大小，`ncap` 是命名空间容量，`nuse` 是命名空间使用情况。如果这些值与厂商文档中的硬盘大小匹配，则确认正在使用单一命名空间。
- en: A third check for the existence of multiple namespace devices can be to simply
    list the devices (*/dev/nvme0n2**, */dev/nvme0n3**, and so on) detected by the
    OS.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 检查是否存在多个命名空间设备的第三种方法是简单列出操作系统检测到的设备（*/dev/nvme0n2**、*/dev/nvme0n3** 等）。
- en: As of this writing, there were no consumer drives available for testing that
    supported multiple namespaces. The information in this section is derived from
    the NVME specification and tool documentation.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 截至目前，尚未有支持多命名空间的消费级硬盘可供测试。本节中的信息来源于 NVME 规范和工具文档。
- en: '***Solid State Hybrid Disks***'
  id: totrans-276
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***固态混合硬盘***'
- en: A hybrid of a solid state and traditional magnetic disk was developed to provide
    larger disk capacities, with performance comparable to SSDs, at an affordable
    price.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 开发了一种固态与传统磁盘的混合型硬盘，以提供更大的磁盘容量，且性能可与 SSD 相媲美，且价格更为实惠。
- en: These hybrid drives, known as *Solid State Hybrid Disks (SSHDs)*, provide additional
    solid state caching of frequently used sectors. SSHDs can operate fully independently
    of the OS or accept “hints” from the OS to help decide which blocks to cache.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 这些混合硬盘，被称为*固态混合硬盘（SSHDs）*，提供额外的固态缓存，缓存经常使用的扇区。SSHDs 可以完全独立于操作系统运行，或者接受操作系统的“提示”，帮助决定哪些块需要缓存。
- en: As of SATA 3.2, a hybrid information feature has been added to allow a host
    to communicate caching information to a hybrid drive using ATA commands.
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 从 SATA 3.2 起，新增了一项混合信息功能，允许主机通过 ATA 命令与混合硬盘通信缓存信息。
- en: To date, little research has been done on the forensics of SSHDs, and the implications
    for acquisition are unclear. SSHDs contain a small SSD disk that must perform
    wear leveling. A hybrid drive that does not support TRIM commands is not likely
    to erase data in unallocated filesystem blocks.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 迄今为止，关于 SSHDs 的取证研究较少，对于数据采集的影响尚不明确。SSHDs 包含一个小型的 SSD 硬盘，必须进行磨损平衡。一个不支持 TRIM
    命令的混合硬盘不太可能删除未分配文件系统块中的数据。
- en: 'The hybrid systems described here are built into the electronics of a single
    drive. It is also possible to have a hybrid system with two separate drives: a
    smaller SSD and a larger magnetic hard drive. Using OS drivers or proprietary
    systems such as Intel’s Smart Response Technology, equivalent hybrid caching is
    achieved.'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 这里描述的混合系统内建于单个硬盘的电子元件中。也可以拥有一个由两个独立硬盘组成的混合系统：一个较小的 SSD 和一个较大的磁性硬盘。通过操作系统驱动程序或像英特尔的智能响应技术这样的专有系统，可以实现等效的混合缓存功能。
- en: '**Closing Thoughts**'
  id: totrans-282
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**总结思考**'
- en: In this chapter, I reviewed the various types of storage media—magnetic, non-volatile,
    and optical—and I examined different drive types. I described internal and external
    interfaces for attaching storage devices to a examiner host system. I also explained
    the protocols used to access the drives and covered a number of less common specialty
    topics. I presented the material in this chapter from the perspective of a forensic
    examiner. You should now have a solid foundation for understanding the next chapter
    on using Linux as a forensic acquisition platform.
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我回顾了各种类型的存储介质——磁介质、非易失性介质和光学介质——并考察了不同的硬盘类型。我描述了将存储设备连接到检查主机系统的内部和外部接口。还解释了访问硬盘的协议，并涵盖了一些不太常见的专业主题。我从取证检查员的角度呈现了本章内容。你现在应该已建立起坚实的基础，以理解下一章关于使用
    Linux 作为取证采集平台的内容。
