- en: '9'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '9'
- en: Fuzzing
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: æ¨¡ç³Šæµ‹è¯•
- en: '![](image_fi/book_art/chapterart.png)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/book_art/chapterart.png)'
- en: In this chapter, youâ€™ll explore using fuzzing techniques to discover several
    of the top API vulnerabilities discussed in Chapter 3. The secret to successfully
    discovering most API vulnerabilities is knowing where to fuzz and what to fuzz
    with. In fact, youâ€™ll likely discover many API vulnerabilities by fuzzing input
    sent to API endpoints.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æœ¬ç« ä¸­ï¼Œä½ å°†æ¢ç´¢ä½¿ç”¨æ¨¡ç³Šæµ‹è¯•æŠ€æœ¯æ¥å‘ç°ç¬¬ 3 ç« ä¸­è®¨è®ºçš„å‡ ä¸ªé¡¶çº§ API æ¼æ´ã€‚æˆåŠŸå‘ç°å¤§å¤šæ•° API æ¼æ´çš„å…³é”®æ˜¯çŸ¥é“åœ¨å“ªäº›åœ°æ–¹è¿›è¡Œæ¨¡ç³Šæµ‹è¯•ï¼Œä»¥åŠç”¨ä»€ä¹ˆè¿›è¡Œæ¨¡ç³Šæµ‹è¯•ã€‚å®é™…ä¸Šï¼Œä½ å¾ˆå¯èƒ½é€šè¿‡å¯¹
    API ç«¯ç‚¹å‘é€è¾“å…¥çš„æ¨¡ç³Šæµ‹è¯•å‘ç°è®¸å¤š API æ¼æ´ã€‚
- en: 'Using Wfuzz, Burp Suite Intruder, and Postmanâ€™s Collection Runner, weâ€™ll cover
    two strategies to increase your success: fuzzing wide and fuzzing deep. Weâ€™ll
    also discuss how to fuzz for improper assets management vulnerabilities, find
    the accepted HTTP methods for a request, and bypass input sanitization.'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ Wfuzzã€Burp Suite Intruder å’Œ Postman çš„ Collection Runnerï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸¤ç§æé«˜æˆåŠŸç‡çš„ç­–ç•¥ï¼šå¹¿æ³›æ¨¡ç³Šæµ‹è¯•å’Œæ·±åº¦æ¨¡ç³Šæµ‹è¯•ã€‚æˆ‘ä»¬è¿˜å°†è®¨è®ºå¦‚ä½•é€šè¿‡æ¨¡ç³Šæµ‹è¯•å¯»æ‰¾ä¸å½“çš„èµ„äº§ç®¡ç†æ¼æ´ï¼Œæ‰¾åˆ°è¯·æ±‚çš„æ¥å—
    HTTP æ–¹æ³•ï¼Œå¹¶ç»•è¿‡è¾“å…¥å‡€åŒ–ã€‚
- en: Effective Fuzzing
  id: totrans-5
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æœ‰æ•ˆçš„æ¨¡ç³Šæµ‹è¯•
- en: In earlier chapters, we defined API fuzzing as the process of sending requests
    with various types of input to an endpoint in order to provoke an unintended result.
    While â€œvarious types of inputâ€ and â€œunintended resultâ€ might sound vague, thatâ€™s
    only because there are so many possibilities. Your input could include symbols,
    numbers, emojis, decimals, hexadecimal, system commands, SQL input, and NoSQL
    input, for instance. If the API has not implemented validation checks to handle
    harmful input, you could end up with a verbose error, a unique response, or (in
    the worst case) some sort of internal server error indicating that your fuzz caused
    a denial of service, killing the app.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨å‰å‡ ç« ä¸­ï¼Œæˆ‘ä»¬å°† API æ¨¡ç³Šæµ‹è¯•å®šä¹‰ä¸ºå‘ç«¯ç‚¹å‘é€å„ç§ç±»å‹çš„è¾“å…¥è¯·æ±‚ï¼Œä»¥å¼•å‘éé¢„æœŸçš„ç»“æœã€‚è™½ç„¶â€œå„ç§ç±»å‹çš„è¾“å…¥â€å’Œâ€œéé¢„æœŸçš„ç»“æœâ€å¬èµ·æ¥å¯èƒ½æœ‰äº›æ¨¡ç³Šï¼Œä½†è¿™ä»…ä»…æ˜¯å› ä¸ºå¯èƒ½æ€§å¤ªå¤šã€‚ä½ çš„è¾“å…¥å¯èƒ½åŒ…æ‹¬ç¬¦å·ã€æ•°å­—ã€è¡¨æƒ…ç¬¦å·ã€å°æ•°ã€åå…­è¿›åˆ¶ã€ç³»ç»Ÿå‘½ä»¤ã€SQL
    è¾“å…¥å’Œ NoSQL è¾“å…¥ç­‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ API æ²¡æœ‰å®æ–½éªŒè¯æ£€æŸ¥æ¥å¤„ç†æœ‰å®³è¾“å…¥ï¼Œä½ å¯èƒ½ä¼šå¾—åˆ°å†—é•¿çš„é”™è¯¯ã€ç‹¬ç‰¹çš„å“åº”ï¼Œæˆ–è€…ï¼ˆæœ€åçš„æƒ…å†µï¼‰æŸç§å†…éƒ¨æœåŠ¡å™¨é”™è¯¯ï¼Œè¡¨æ˜ä½ çš„æ¨¡ç³Šæµ‹è¯•å¯¼è‡´äº†æœåŠ¡æ‹’ç»ï¼Œå¯¼è‡´åº”ç”¨ç¨‹åºå´©æºƒã€‚
- en: 'Fuzzing successfully requires a careful consideration of the appâ€™s likely expectations.
    For example, take a banking API call intended to allow users to transfer money
    from one account to another. The request could look something like this:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: æˆåŠŸçš„æ¨¡ç³Šæµ‹è¯•éœ€è¦ä»”ç»†è€ƒè™‘åº”ç”¨ç¨‹åºå¯èƒ½çš„æœŸæœ›ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªé“¶è¡Œ API è°ƒç”¨ï¼Œç›®çš„æ˜¯å…è®¸ç”¨æˆ·ä»ä¸€ä¸ªè´¦æˆ·è½¬è´¦åˆ°å¦ä¸€ä¸ªè´¦æˆ·ã€‚è¯¥è¯·æ±‚å¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š
- en: '[PRE0]'
  id: totrans-8
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: To fuzz this request, you could easily set up Burp Suite or Wfuzz to submit
    huge payloads as the `userid`, `account`, and `transfer-amount` values. However,
    this could set off defensive mechanisms, resulting in stronger rate limiting or
    your token being blocked. If the API lacks these security controls, by all means
    release the krakens. Otherwise, your best bet is to send a few targeted requests
    to only one of the values at a time.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: è¦å¯¹è¿™ä¸ªè¯·æ±‚è¿›è¡Œæ¨¡ç³Šæµ‹è¯•ï¼Œä½ å¯ä»¥è½»æ¾åœ°è®¾ç½® Burp Suite æˆ– Wfuzz æäº¤å·¨å¤§çš„æœ‰æ•ˆè½½è·ä½œä¸º `userid`ã€`account` å’Œ `transfer-amount`
    çš„å€¼ã€‚ç„¶è€Œï¼Œè¿™å¯èƒ½ä¼šè§¦å‘é˜²å¾¡æœºåˆ¶ï¼Œå¯¼è‡´æ›´å¼ºçš„é€Ÿç‡é™åˆ¶æˆ–ä½ çš„ä»¤ç‰Œè¢«å°é”ã€‚å¦‚æœ API æ²¡æœ‰è¿™äº›å®‰å…¨æ§åˆ¶ï¼Œå°½ç®¡æ”¾å¼€æ‰‹è„šå»åšã€‚å¦åˆ™ï¼Œä½ æœ€å¥½çš„é€‰æ‹©æ˜¯ä¸€æ¬¡åªå‘å…¶ä¸­ä¸€ä¸ªå€¼å‘é€å‡ ä¸ªæœ‰é’ˆå¯¹æ€§çš„è¯·æ±‚ã€‚
- en: 'Consider the fact that the `transfer-amount` value likely expects a relatively
    small number. Bank.com isnâ€™t anticipating an individual user to transfer an amount
    larger than the global GDP. It also likely expects a decimal value. Thus, you
    might want to evaluate what happens when you send the following:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: è¯·è€ƒè™‘ `transfer-amount` å€¼å¯èƒ½æœŸæœ›ä¸€ä¸ªç›¸å¯¹è¾ƒå°çš„æ•°å­—ã€‚Bank.com å¹¶ä¸é¢„è®¡ç”¨æˆ·ä¼šè½¬è´¦è¶…è¿‡å…¨çƒ GDP çš„é‡‘é¢ã€‚å®ƒä¹Ÿå¾ˆå¯èƒ½æœŸæœ›ä¸€ä¸ªå°æ•°å€¼ã€‚å› æ­¤ï¼Œä½ å¯èƒ½æƒ³è¯„ä¼°å‘é€ä»¥ä¸‹å†…å®¹æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼š
- en: A value in the quadrillions
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ•°å€¼è¾¾åˆ°åƒä¸‡äº¿
- en: String of letters instead of numbers
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å­—æ¯ä¸²è€Œéæ•°å­—
- en: A large decimal number or a negative number
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªå¤§æ•°å€¼æˆ–è´Ÿæ•°
- en: Null values like `null`, `(null)`, `%00`, and `0x00`
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç©ºå€¼ï¼Œå¦‚ `null`ã€`(null)`ã€`%00` å’Œ `0x00`
- en: 'Symbols like the following: `!@#$%^&*();'':''''|,./?>`'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç±»ä¼¼ä»¥ä¸‹ç¬¦å·ï¼š`!@#$%^&*();':''|,./?>`
- en: These requests could easily lead to verbose errors that reveal more about the
    application. A value in the quadrillions could additionally cause an unhandled
    SQL database error to be sent back as a response. This one piece of information
    could help you target values across the API for SQL injection vulnerabilities.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™äº›è¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´å†—é•¿çš„é”™è¯¯ä¿¡æ¯ï¼Œæš´éœ²æ›´å¤šå…³äºåº”ç”¨ç¨‹åºçš„ç»†èŠ‚ã€‚æ•°å€¼è¾¾åˆ°åƒä¸‡äº¿æ—¶ï¼Œè¿˜å¯èƒ½å¯¼è‡´æœªå¤„ç†çš„ SQL æ•°æ®åº“é”™è¯¯ä½œä¸ºå“åº”è¿”å›ã€‚è¿™ä¸€æ¡ä¿¡æ¯å¯èƒ½å¸®åŠ©ä½ è¯†åˆ«
    API ä¸­çš„ SQL æ³¨å…¥æ¼æ´ã€‚
- en: Thus, the success of your fuzzing will depend on where you are fuzzing and what
    you are fuzzing with. The trick is to look for API inputs that are leveraged for
    a consumer to interact with the application and send input that is likely to result
    in errors. If these inputs do not have sufficient input handling and error handling,
    they can often lead to exploitation. Examples of this sort of API input include
    the fields involved in requests used for authentication forms, account registration,
    uploading files, editing web application content, editing user profile information,
    editing account information, managing users, searching for content, and so on.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œæ¨¡ç³Šæµ‹è¯•çš„æˆåŠŸå°†å–å†³äºä½ è¿›è¡Œæ¨¡ç³Šæµ‹è¯•çš„ä½ç½®ä»¥åŠä½ ä½¿ç”¨çš„æ¨¡ç³Šæµ‹è¯•å†…å®¹ã€‚å…³é”®æ˜¯å¯»æ‰¾APIè¾“å…¥ï¼Œè¿™äº›è¾“å…¥ä¾›æ¶ˆè´¹è€…ä¸åº”ç”¨ç¨‹åºäº¤äº’ï¼Œå¹¶å‘é€å¯èƒ½å¯¼è‡´é”™è¯¯çš„è¾“å…¥ã€‚å¦‚æœè¿™äº›è¾“å…¥æ²¡æœ‰è¶³å¤Ÿçš„è¾“å…¥å¤„ç†å’Œé”™è¯¯å¤„ç†ï¼Œå®ƒä»¬é€šå¸¸ä¼šå¯¼è‡´æ¼æ´åˆ©ç”¨ã€‚è¿™ç±»APIè¾“å…¥çš„ç¤ºä¾‹åŒ…æ‹¬ç”¨äºè®¤è¯è¡¨å•ã€è´¦æˆ·æ³¨å†Œã€ä¸Šä¼ æ–‡ä»¶ã€ç¼–è¾‘Webåº”ç”¨å†…å®¹ã€ç¼–è¾‘ç”¨æˆ·ä¿¡æ¯ã€ç¼–è¾‘è´¦æˆ·ä¿¡æ¯ã€ç”¨æˆ·ç®¡ç†ã€æœç´¢å†…å®¹ç­‰è¯·æ±‚ä¸­æ¶‰åŠçš„å­—æ®µã€‚
- en: 'The types of input to send really depend on the type of input you are attacking.
    Generically, you can send all sorts of symbols, strings, and numbers that could
    cause errors, and then you could pivot your attack based on the errors received.
    All of the following could result in interesting responses:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: å‘é€çš„è¾“å…¥ç±»å‹å®é™…ä¸Šå–å†³äºä½ æ”»å‡»çš„è¾“å…¥ç±»å‹ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä½ å¯ä»¥å‘é€å„ç§ç¬¦å·ã€å­—ç¬¦ä¸²å’Œæ•°å­—ï¼Œè¿™äº›å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯ï¼Œç„¶åä½ å¯ä»¥æ ¹æ®æ”¶åˆ°çš„é”™è¯¯æ¥è°ƒæ•´æ”»å‡»æ–¹æ³•ã€‚ä»¥ä¸‹æ‰€æœ‰å†…å®¹éƒ½å¯èƒ½å¯¼è‡´æœ‰è¶£çš„å“åº”ï¼š
- en: Sending an exceptionally large number when a small number is expected
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å½“é¢„æœŸä¸ºå°æ•°å­—æ—¶å‘é€å¼‚å¸¸å¤§çš„æ•°å­—
- en: Sending database queries, system commands, and other code
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‘é€æ•°æ®åº“æŸ¥è¯¢ã€ç³»ç»Ÿå‘½ä»¤å’Œå…¶ä»–ä»£ç 
- en: Sending a string of letters when a number is expected
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å½“é¢„æœŸä¸ºæ•°å­—æ—¶å‘é€ä¸€ä¸²å­—æ¯
- en: Sending a large string of letters when a small string is expected
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å½“é¢„æœŸä¸ºçŸ­å­—ç¬¦ä¸²æ—¶å‘é€ä¸€ä¸²é•¿å­—æ¯
- en: Sending various symbols (`-_\!@#$%^&*();':''|,./?>`)
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‘é€å„ç§ç¬¦å·ï¼ˆ`-_\!@#$%^&*();':''|,./?>`ï¼‰
- en: Sending characters from unexpected languages (æ¼¢, ã•, Ğ–, Ñª, Ñ¬, Ñ¦, Ñ¨, Ñ®)
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‘é€æ¥è‡ªæ„å¤–è¯­è¨€çš„å­—ç¬¦ï¼ˆæ¼¢, ã•, Ğ–, Ñª, Ñ¬, Ñ¦, Ñ¨, Ñ®ï¼‰
- en: If you are blocked or banned while fuzzing, you might want to deploy evasion
    techniques discussed in Chapter 13 or else further limit the number of fuzzing
    requests you send.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœåœ¨æ¨¡ç³Šæµ‹è¯•è¿‡ç¨‹ä¸­è¢«é˜»æ­¢æˆ–ç¦æ­¢ï¼Œä½ å¯èƒ½éœ€è¦éƒ¨ç½²ç¬¬13ç« ä¸­è®¨è®ºçš„è§„é¿æŠ€æœ¯ï¼Œæˆ–è€…è¿›ä¸€æ­¥é™åˆ¶ä½ å‘é€çš„æ¨¡ç³Šè¯·æ±‚æ•°é‡ã€‚
- en: Choosing Fuzzing Payloads
  id: totrans-26
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: é€‰æ‹©æ¨¡ç³Šæµ‹è¯•æœ‰æ•ˆè´Ÿè½½
- en: Different fuzzing payloads can incite various types of responses. You can use
    either generic fuzzing payloads or more targeted ones. *Generic payloads* are
    those weâ€™ve discussed so far and contain symbols, null bytes, directory traversal
    strings, encoded characters, large numbers, long strings, and so on.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸åŒçš„æ¨¡ç³Šæµ‹è¯•æœ‰æ•ˆè´Ÿè½½å¯ä»¥å¼•å‘ä¸åŒç±»å‹çš„å“åº”ã€‚ä½ å¯ä»¥ä½¿ç”¨é€šç”¨çš„æ¨¡ç³Šæµ‹è¯•æœ‰æ•ˆè´Ÿè½½ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ›´æœ‰é’ˆå¯¹æ€§çš„æ¨¡ç³Šæµ‹è¯•æœ‰æ•ˆè´Ÿè½½ã€‚*é€šç”¨æœ‰æ•ˆè´Ÿè½½*æ˜¯æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢è®¨è®ºçš„å†…å®¹ï¼ŒåŒ…å«ç¬¦å·ã€ç©ºå­—èŠ‚ã€ç›®å½•éå†å­—ç¬¦ä¸²ã€ç¼–ç å­—ç¬¦ã€å¤§æ•°å­—ã€é•¿å­—ç¬¦ä¸²ç­‰ã€‚
- en: '*Targeted* fuzzing payloads are aimed at provoking a response from specific
    technologies and types of vulnerabilities. Targeted fuzzing payload types might
    include API object or variable names, cross-site scripting (XSS) payloads, directories,
    file extensions, HTTP request methods, JSON or XML data, SQL or No SQL commands,
    or commands for particular operating systems. Weâ€™ll cover examples of fuzzing
    with these payloads in this and future chapters.'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '*é’ˆå¯¹æ€§*æ¨¡ç³Šæµ‹è¯•æœ‰æ•ˆè´Ÿè½½æ—¨åœ¨é’ˆå¯¹ç‰¹å®šæŠ€æœ¯å’Œæ¼æ´ç±»å‹å¼•å‘å“åº”ã€‚é’ˆå¯¹æ€§æ¨¡ç³Šæµ‹è¯•æœ‰æ•ˆè´Ÿè½½å¯èƒ½åŒ…æ‹¬APIå¯¹è±¡æˆ–å˜é‡åç§°ã€è·¨ç«™è„šæœ¬ï¼ˆXSSï¼‰æœ‰æ•ˆè´Ÿè½½ã€ç›®å½•ã€æ–‡ä»¶æ‰©å±•åã€HTTPè¯·æ±‚æ–¹æ³•ã€JSONæˆ–XMLæ•°æ®ã€SQLæˆ–NoSQLå‘½ä»¤ï¼Œæˆ–è€…ç‰¹å®šæ“ä½œç³»ç»Ÿçš„å‘½ä»¤ã€‚åœ¨æœ¬ç« åŠæœªæ¥ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä½¿ç”¨è¿™äº›æœ‰æ•ˆè´Ÿè½½çš„æ¨¡ç³Šæµ‹è¯•ç¤ºä¾‹ã€‚'
- en: Youâ€™ll typically move from generic to targeted fuzzing based on the information
    received in API responses. Similar to reconnaissance efforts in Chapter 6, you
    will want to adapt your fuzzing and focus your efforts based on the results of
    generic testing. Targeted fuzzing payloads are more useful once you know the technologies
    being used. If youâ€™re sending SQL fuzzing payloads to an API that leverages only
    NoSQL databases, your testing wonâ€™t be as effective.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: é€šå¸¸ï¼Œä½ ä¼šæ ¹æ®APIå“åº”ä¸­æ”¶åˆ°çš„ä¿¡æ¯ï¼Œä»é€šç”¨æ¨¡ç³Šæµ‹è¯•è½¬å‘æ›´å…·é’ˆå¯¹æ€§çš„æ¨¡ç³Šæµ‹è¯•ã€‚ç±»ä¼¼äºç¬¬6ç« ä¸­çš„ä¾¦å¯Ÿå·¥ä½œï¼Œä½ éœ€è¦æ ¹æ®é€šç”¨æµ‹è¯•çš„ç»“æœè°ƒæ•´æ¨¡ç³Šæµ‹è¯•å¹¶é›†ä¸­ç²¾åŠ›ã€‚çŸ¥é“ä½¿ç”¨çš„æŠ€æœ¯åï¼Œé’ˆå¯¹æ€§çš„æ¨¡ç³Šæµ‹è¯•æœ‰æ•ˆæ€§æ›´å¼ºã€‚å¦‚æœä½ å‘ä¸€ä¸ªåªä½¿ç”¨NoSQLæ•°æ®åº“çš„APIå‘é€SQLæ¨¡ç³Šæµ‹è¯•æœ‰æ•ˆè´Ÿè½½ï¼Œé‚£ä¹ˆä½ çš„æµ‹è¯•å°†ä¸ä¼šé‚£ä¹ˆæœ‰æ•ˆã€‚
- en: One of the best sources for fuzzing payloads is SecLists ([https://github.com/danielmiessler/SecLists](https://github.com/danielmiessler/SecLists)).
    SecLists has a whole section dedicated to fuzzing, and its *big-list-of-naughty-strings.txt*
    wordlist is excellent at causing useful responses. The fuzzdb project is another
    good source for fuzzing payloads ([https://github.com/fuzzdb-project/fuzzdb](https://github.com/fuzzdb-project/fuzzdb)).
    Also, Wfuzz has many useful payloads ([https://github.com/xmendez/wfuzz](https://github.com/xmendez/wfuzz)),
    including a great list that combines several targeted payloads in their injection
    directory, called *All_attack.txt*.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: æ¨¡ç³Šæµ‹è¯•è´Ÿè½½çš„æœ€ä½³æ¥æºä¹‹ä¸€æ˜¯SecListsï¼ˆ[https://github.com/danielmiessler/SecLists](https://github.com/danielmiessler/SecLists)ï¼‰ã€‚SecListsæœ‰ä¸€ä¸ªä¸“é—¨çš„æ¨¡ç³Šæµ‹è¯•éƒ¨åˆ†ï¼Œå…¶*big-list-of-naughty-strings.txt*è¯è¡¨åœ¨å¼•å‘æœ‰ç”¨å“åº”æ–¹é¢è¡¨ç°å‡ºè‰²ã€‚fuzzdbé¡¹ç›®æ˜¯å¦ä¸€ä¸ªå¾ˆå¥½çš„æ¨¡ç³Šæµ‹è¯•è´Ÿè½½æ¥æºï¼ˆ[https://github.com/fuzzdb-project/fuzzdb](https://github.com/fuzzdb-project/fuzzdb)ï¼‰ã€‚æ­¤å¤–ï¼ŒWfuzzä¹Ÿæœ‰è®¸å¤šæœ‰ç”¨çš„è´Ÿè½½ï¼ˆ[https://github.com/xmendez/wfuzz](https://github.com/xmendez/wfuzz)ï¼‰ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€ä¸ªå¾ˆæ£’çš„åˆ—è¡¨ï¼Œç»“åˆäº†å¤šä¸ªç›®æ ‡è´Ÿè½½ï¼Œä½äºå…¶æ³¨å…¥ç›®å½•ä¸­ï¼Œåä¸º*All_attack.txt*ã€‚
- en: 'Additionally, you can always quickly and easily create your own generic fuzzing
    payload list. In a text file, combine symbols, numbers, and characters to create
    each payload as line-separated entries, like this:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¤å¤–ï¼Œä½ å¯ä»¥å¿«é€Ÿè½»æ¾åœ°åˆ›å»ºè‡ªå·±çš„é€šç”¨æ¨¡ç³Šæµ‹è¯•è´Ÿè½½åˆ—è¡¨ã€‚åœ¨æ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œç»“åˆç¬¦å·ã€æ•°å­—å’Œå­—ç¬¦ï¼Œå°†æ¯ä¸ªè´Ÿè½½ä½œä¸ºä»¥æ¢è¡Œç¬¦åˆ†éš”çš„æ¡ç›®åˆ›å»ºï¼Œåƒè¿™æ ·ï¼š
- en: '`AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA`'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA`'
- en: '`9999999999999999999999999999999999999999`'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`9999999999999999999999999999999999999999`'
- en: '`~''!@#$%^&*()-_+`'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`~''!@#$%^&*()-_+`'
- en: '`{}[]|\:''''; ''<>?,./`'
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`{}[]|\:''''; ''<>?,./`'
- en: '`%00`'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`%00`'
- en: '`0x00`'
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`0x00`'
- en: '`$ne`'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`$ne`'
- en: '`%24ne`'
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`%24ne`'
- en: '`$gt`'
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`$gt`'
- en: '`%24gt`'
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`%24gt`'
- en: '`|whoami`'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`|whoami`'
- en: '`-- -`'
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`-- -`'
- en: '`'' ''''`'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`'' ''''`'
- en: '`'' OR 1=1-- -`'
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`'' OR 1=1-- -`'
- en: '`'''' ''''''''''''`'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`'''' ''''''''''''`'
- en: '`æ¼¢, ã•, Ğ–, Ñª, Ñ¬, Ñ¦, Ñ¨, Ñ®`'
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`æ¼¢, ã•, Ğ–, Ñª, Ñ¬, Ñ¦, Ñ¨, Ñ®`'
- en: ğŸ˜€ ğŸ˜ƒ ğŸ˜„ ğŸ˜ ğŸ˜†
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ğŸ˜€ ğŸ˜ƒ ğŸ˜„ ğŸ˜ ğŸ˜†
- en: Note that instead of 40 instances of `A` or `9`, you could write payloads consisting
    of hundreds them. Using a small list like this as a fuzzing payload can cause
    all sorts of useful and interesting responses from an API.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: è¯·æ³¨æ„ï¼Œä¸ä½ ä½¿ç”¨40ä¸ª`A`æˆ–`9`çš„æƒ…å†µä¸åŒï¼Œä½ å¯ä»¥ç¼–å†™åŒ…å«æˆç™¾ä¸Šåƒä¸ªè¿™äº›å­—ç¬¦çš„è´Ÿè½½ã€‚åƒè¿™æ ·çš„ç®€å•åˆ—è¡¨ä½œä¸ºæ¨¡ç³Šæµ‹è¯•è´Ÿè½½ï¼Œå¯èƒ½ä¼šä»APIä¸­å¼•å‘å„ç§æœ‰ç”¨å’Œæœ‰è¶£çš„å“åº”ã€‚
- en: Detecting Anomalies
  id: totrans-50
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ£€æµ‹å¼‚å¸¸
- en: 'When fuzzing, youâ€™re attempting to cause the API or its supporting technologies
    to send you information that you can leverage in additional attacks. When an API
    request payload is handled properly, you should receive some sort of HTTP response
    code and message indicating that your fuzzing did not work. For example, sending
    a request with a string of letters when numbers are expected could result in a
    simple response like the following:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿›è¡Œæ¨¡ç³Šæµ‹è¯•æ—¶ï¼Œä½ çš„ç›®æ ‡æ˜¯è®©APIæˆ–å…¶æ”¯æŒçš„æŠ€æœ¯å‘é€ä¿¡æ¯ç»™ä½ ï¼Œè¿™äº›ä¿¡æ¯å¯ä»¥è¢«ç”¨æ¥è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚å½“APIè¯·æ±‚è´Ÿè½½è¢«æ­£ç¡®å¤„ç†æ—¶ï¼Œä½ åº”è¯¥æ”¶åˆ°æŸç§HTTPå“åº”ä»£ç å’Œæ¶ˆæ¯ï¼Œè¡¨æ˜ä½ çš„æ¨¡ç³Šæµ‹è¯•æœªèƒ½æˆåŠŸã€‚ä¾‹å¦‚ï¼Œå½“é¢„æœŸæ¥æ”¶æ•°å­—æ—¶ï¼Œå‘é€ä¸€ä¸²å­—æ¯å¯èƒ½ä¼šå¯¼è‡´å¦‚ä¸‹ç®€å•çš„å“åº”ï¼š
- en: '[PRE1]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: From this response, you can deduce that the developers configured the API to
    properly handle requests like yours and prepared a tailored response.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: ä»è¿™ä¸ªå“åº”ä¸­ï¼Œä½ å¯ä»¥æ¨æ–­å‡ºå¼€å‘è€…å·²é…ç½®APIæ¥æ­£ç¡®å¤„ç†åƒä½ è¿™æ ·çš„è¯·æ±‚ï¼Œå¹¶å‡†å¤‡äº†ä¸€ä¸ªå®šåˆ¶çš„å“åº”ã€‚
- en: 'When input is not handled properly and causes an error, the server will often
    return that error in the response. For example, if you sent input like `~''!@#$%^&*()-_+`
    to an endpoint that improperly handles it, you could receive an error like this:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: å½“è¾“å…¥æœªæ­£ç¡®å¤„ç†å¹¶å¯¼è‡´é”™è¯¯æ—¶ï¼ŒæœåŠ¡å™¨é€šå¸¸ä¼šåœ¨å“åº”ä¸­è¿”å›è¯¥é”™è¯¯ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å‘ä¸€ä¸ªå¤„ç†ä¸å½“çš„ç«¯ç‚¹å‘é€äº†ç±»ä¼¼`~'!@#$%^&*()-_+`çš„è¾“å…¥ï¼Œä½ å¯èƒ½ä¼šæ”¶åˆ°ç±»ä¼¼ä¸‹é¢çš„é”™è¯¯ï¼š
- en: '[PRE2]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This response immediately reveals that youâ€™re interacting with an API request
    that does not handle input properly and that the backend of the application is
    utilizing a SQL database.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªå“åº”ç«‹åˆ»æ­ç¤ºäº†ä½ æ­£åœ¨ä¸ä¸€ä¸ªæœªæ­£ç¡®å¤„ç†è¾“å…¥çš„APIè¯·æ±‚äº¤äº’ï¼Œå¹¶ä¸”è¯¥åº”ç”¨ç¨‹åºçš„åç«¯æ­£åœ¨ä½¿ç”¨SQLæ•°æ®åº“ã€‚
- en: Youâ€™ll typically be analyzing hundreds or thousands of responses, not just two
    or three. Therefore, you need to filter your responses in order to detect anomalies.
    One way to do this is to understand what ordinary responses look like. You can
    establish this baseline by sending a set of expected requests or, as youâ€™ll see
    later in the lab, by sending requests that you expect to fail. Then you can review
    the results to see if a majority of them are identical. For example, if you issue
    100 API requests and 98 of those result in an HTTP 200 response code with a similar
    response size, you can consider those requests to be your baseline. Also examine
    a few of the baseline responses to get a sense of their content. Once you know
    that the baseline responses have been properly handled, review the two anomalous
    responses. Figure out what input caused the difference, paying particular attention
    to the HTTP response code, response size, and the content of the response.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: é€šå¸¸ï¼Œä½ å°†åˆ†ææ•°ç™¾æˆ–æ•°åƒä¸ªå“åº”ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸¤ä¸ªæˆ–ä¸‰ä¸ªã€‚å› æ­¤ï¼Œä½ éœ€è¦è¿‡æ»¤å“åº”ä»¥ä¾¿æ£€æµ‹å¼‚å¸¸ã€‚åšåˆ°è¿™ä¸€ç‚¹çš„ä¸€ç§æ–¹æ³•æ˜¯äº†è§£æ™®é€šå“åº”çš„æ ·å­ã€‚ä½ å¯ä»¥é€šè¿‡å‘é€ä¸€ç»„é¢„æœŸçš„è¯·æ±‚æ¥å»ºç«‹è¿™ä¸ªåŸºå‡†ï¼Œæˆ–è€…å¦‚ä½ ç¨ååœ¨å®éªŒä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œå‘é€ä½ é¢„è®¡ä¼šå¤±è´¥çš„è¯·æ±‚ã€‚ç„¶åï¼Œä½ å¯ä»¥æŸ¥çœ‹ç»“æœï¼Œçœ‹çœ‹å¤§å¤šæ•°æ˜¯å¦æ˜¯ç›¸åŒçš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å‘å‡º
    100 ä¸ª API è¯·æ±‚ï¼Œå…¶ä¸­ 98 ä¸ªè¿”å› HTTP 200 å“åº”ç ä¸”å“åº”å¤§å°ç›¸ä¼¼ï¼Œä½ å¯ä»¥å°†è¿™äº›è¯·æ±‚è§†ä¸ºåŸºå‡†ã€‚åŒæ—¶ï¼Œæ£€æŸ¥ä¸€äº›åŸºå‡†å“åº”çš„å†…å®¹ï¼Œä»¥äº†è§£å®ƒä»¬çš„å†…å®¹ã€‚ä¸€æ—¦ä½ çŸ¥é“åŸºå‡†å“åº”å·²è¢«æ­£ç¡®å¤„ç†ï¼Œå†æ£€æŸ¥ä¸¤ä¸ªå¼‚å¸¸å“åº”ã€‚æ‰¾å‡ºå¯¼è‡´å·®å¼‚çš„è¾“å…¥ï¼Œç‰¹åˆ«å…³æ³¨
    HTTP å“åº”ç ã€å“åº”å¤§å°å’Œå“åº”å†…å®¹ã€‚
- en: In some cases, the differences between baseline and anomalous requests will
    be miniscule. For example, the HTTP response codes might all be identical, but
    a few requests might result in a response size that is a few bytes larger than
    the baseline responses. When small differences like this come up, use Burp Suiteâ€™s
    Comparer to get a side-by-side comparison of the differences within the responses.
    Right-click the result youâ€™re interested in and choose **Send to Comparer (Response)**.
    You can send as many responses as youâ€™d like to Comparer, but youâ€™ll at least
    need to send two. Then migrate to the Comparer tab, as shown in [Figure 9-1](#figure9-1).
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒåŸºå‡†è¯·æ±‚å’Œå¼‚å¸¸è¯·æ±‚ä¹‹é—´çš„å·®å¼‚å¯èƒ½å¾®ä¹å…¶å¾®ã€‚ä¾‹å¦‚ï¼ŒHTTP å“åº”ç å¯èƒ½å®Œå…¨ç›¸åŒï¼Œä½†æŸäº›è¯·æ±‚çš„å“åº”å¤§å°å¯èƒ½æ¯”åŸºå‡†å“åº”å¤§å‡ å­—èŠ‚ã€‚å½“å‡ºç°è¿™æ ·çš„å°å·®å¼‚æ—¶ï¼Œä½¿ç”¨
    Burp Suite çš„æ¯”è¾ƒå™¨æ¥è¿›è¡Œå“åº”å·®å¼‚çš„å¹¶æ’æ¯”è¾ƒã€‚å³é”®ç‚¹å‡»ä½ æ„Ÿå…´è¶£çš„ç»“æœå¹¶é€‰æ‹©**å‘é€åˆ°æ¯”è¾ƒå™¨ï¼ˆå“åº”ï¼‰**ã€‚ä½ å¯ä»¥å°†ä»»æ„å¤šä¸ªå“åº”å‘é€åˆ°æ¯”è¾ƒå™¨ï¼Œä½†è‡³å°‘éœ€è¦å‘é€ä¸¤ä¸ªã€‚ç„¶ååˆ‡æ¢åˆ°æ¯”è¾ƒå™¨æ ‡ç­¾ï¼Œå¦‚[å›¾
    9-1](#figure9-1)æ‰€ç¤ºã€‚
- en: '![screenshot of the burp suite comparer tab that lists results to be selected
    for comparison](image_fi/502444c09/F09001.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![æ˜¾ç¤º burp suite æ¯”è¾ƒå™¨æ ‡ç­¾çš„æˆªå›¾ï¼Œåˆ—å‡ºäº†å¾…é€‰æ‹©è¿›è¡Œæ¯”è¾ƒçš„ç»“æœ](image_fi/502444c09/F09001.png)'
- en: 'Figure 9-1: Burp Suiteâ€™s Comparer'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 9-1ï¼šBurp Suite çš„æ¯”è¾ƒå™¨
- en: Select the two results you would like to compare and use the **Compare Words**
    button (located at the bottom right of the window) to pull up a side-by-side comparison
    of the responses (see [Figure 9-2](#figure9-2)).
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: é€‰æ‹©ä½ æƒ³è¦æ¯”è¾ƒçš„ä¸¤ä¸ªç»“æœï¼Œå¹¶ä½¿ç”¨**æ¯”è¾ƒå•è¯**æŒ‰é’®ï¼ˆä½äºçª—å£å³ä¸‹è§’ï¼‰æ¥æ˜¾ç¤ºå“åº”çš„å¹¶æ’æ¯”è¾ƒï¼ˆå‚è§[å›¾ 9-2](#figure9-2)ï¼‰ã€‚
- en: '![screenshot of the burp suite compare words window that shows the responses
    for the results previously selected](image_fi/502444c09/F09002.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![æ˜¾ç¤ºå·²é€‰æ‹©ç»“æœå“åº”çš„ burp suite æ¯”è¾ƒå•è¯çª—å£æˆªå›¾](image_fi/502444c09/F09002.png)'
- en: 'Figure 9-2: Comparing two API responses with Comparer'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 9-2ï¼šä½¿ç”¨æ¯”è¾ƒå™¨æ¯”è¾ƒä¸¤ä¸ª API å“åº”
- en: A useful option located at the bottom-right corner, called Sync Views, will
    help you synchronize the two responses. Sync Views is especially useful when youâ€™re
    looking for small differences in large responses, as it will automatically highlight
    differences between the two responses. The highlights signify whether the difference
    has been modified, deleted, or added.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªä½äºå³ä¸‹è§’çš„æœ‰ç”¨é€‰é¡¹ï¼Œç§°ä¸ºâ€œåŒæ­¥è§†å›¾â€ï¼ˆSync Viewsï¼‰ï¼Œå°†å¸®åŠ©ä½ åŒæ­¥ä¸¤ä¸ªå“åº”ã€‚å½“ä½ åœ¨å¯»æ‰¾å¤§å“åº”ä¸­çš„ç»†å¾®å·®å¼‚æ—¶ï¼ŒSync Views ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä¼šè‡ªåŠ¨çªå‡ºæ˜¾ç¤ºä¸¤ä¸ªå“åº”ä¹‹é—´çš„å·®å¼‚ã€‚è¿™äº›é«˜äº®æ ‡è®°è¡¨ç¤ºå·®å¼‚æ˜¯å¦å·²è¢«ä¿®æ”¹ã€åˆ é™¤æˆ–æ·»åŠ ã€‚
- en: Fuzzing Wide and Deep
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ¨¡ç³Šæµ‹è¯•å¹¿æ³›ä¸æ·±å…¥
- en: 'This section will introduce you to two fuzzing techniques: fuzzing wide and
    fuzzing deep. *Fuzzing wide* is the act of sending an input across all of an APIâ€™s
    unique requests in an attempt to discover a vulnerability. *Fuzzing deep* is the
    act of thoroughly testing an individual request with a variety of inputs, replacing
    headers, parameters, query strings, endpoint paths, and the body of the request
    with your payloads. You can think of fuzzing wide as testing a mile wide but an
    inch deep and fuzzing deep as testing an inch wide but a mile deep.'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬èŠ‚å°†å‘ä½ ä»‹ç»ä¸¤ç§æ¨¡ç³Šæµ‹è¯•æŠ€æœ¯ï¼šå¹¿æ³›æ¨¡ç³Šæµ‹è¯•å’Œæ·±å…¥æ¨¡ç³Šæµ‹è¯•ã€‚*å¹¿æ³›æ¨¡ç³Šæµ‹è¯•*æ˜¯æŒ‡å°†è¾“å…¥å‘é€åˆ° API çš„æ‰€æœ‰ç‹¬ç‰¹è¯·æ±‚ï¼Œä»¥å°è¯•å‘ç°æ¼æ´ã€‚*æ·±å…¥æ¨¡ç³Šæµ‹è¯•*æ˜¯æŒ‡å¯¹å•ä¸ªè¯·æ±‚è¿›è¡Œå½»åº•æµ‹è¯•ï¼Œä½¿ç”¨å„ç§è¾“å…¥æ›¿æ¢è¯·æ±‚ä¸­çš„å¤´éƒ¨ã€å‚æ•°ã€æŸ¥è¯¢å­—ç¬¦ä¸²ã€ç«¯ç‚¹è·¯å¾„å’Œè¯·æ±‚ä½“ã€‚ä½ å¯ä»¥å°†å¹¿æ³›æ¨¡ç³Šæµ‹è¯•ç†è§£ä¸ºæµ‹è¯•ä¸€è‹±é‡Œå®½ä½†åªæœ‰ä¸€è‹±å¯¸æ·±ï¼Œè€Œæ·±å…¥æ¨¡ç³Šæµ‹è¯•åˆ™æ˜¯æµ‹è¯•ä¸€è‹±å¯¸å®½ä½†æœ‰ä¸€è‹±é‡Œæ·±ã€‚
- en: Wide and deep fuzzing can help you adequately evaluate every feature of larger
    APIs. When youâ€™re hacking, youâ€™ll quickly discover that APIs can greatly vary
    in size. Certain APIs could have only a few endpoints and a handful of unique
    requests, so you may be able to easily test them by sending a few requests. An
    API can have many endpoints and unique requests, however. Alternatively, a single
    request could be filled with many headers and parameters.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: å¹¿æ³›å’Œæ·±å…¥çš„æ¨¡ç³Šæµ‹è¯•å¯ä»¥å¸®åŠ©ä½ å……åˆ†è¯„ä¼°å¤§å‹ API çš„æ¯ä¸ªåŠŸèƒ½ã€‚å½“ä½ è¿›è¡Œé»‘å®¢æ”»å‡»æ—¶ï¼Œä½ ä¼šå¾ˆå¿«å‘ç° API çš„è§„æ¨¡å·®å¼‚å¾ˆå¤§ã€‚æŸäº› API å¯èƒ½åªæœ‰å‡ ä¸ªç«¯ç‚¹å’Œå°‘æ•°ç‹¬ç‰¹çš„è¯·æ±‚ï¼Œå› æ­¤ä½ å¯ä»¥é€šè¿‡å‘é€å°‘é‡è¯·æ±‚è½»æ¾è¿›è¡Œæµ‹è¯•ã€‚ç„¶è€Œï¼Œä¸€ä¸ª
    API å¯èƒ½æœ‰è®¸å¤šç«¯ç‚¹å’Œç‹¬ç‰¹çš„è¯·æ±‚ã€‚æ­¤å¤–ï¼Œå•ä¸ªè¯·æ±‚å¯èƒ½åŒ…å«è®¸å¤šå¤´éƒ¨å’Œå‚æ•°ã€‚
- en: This is where the two fuzzing techniques come into play. Fuzzing wide is best
    used to test for issues across all unique requests. Typically, you can fuzz wide
    to test for improper assets management (more on this later in this chapter), finding
    all valid request methods, token-handling issues, and other information disclosure
    vulnerabilities. Fuzzing deep is best used for testing many aspects of individual
    requests. Most other vulnerability discovery will be done by fuzzing deep. In
    later chapters, we will use the fuzzing-deep technique to discover different types
    of vulnerabilities, including BOLA, BFLA, injection, and mass assignment.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å°±æ˜¯ä¸¤ç§æ¨¡ç³Šæµ‹è¯•æŠ€æœ¯å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚å¹¿æ³›æ¨¡ç³Šæµ‹è¯•æœ€é€‚åˆç”¨äºæµ‹è¯•æ‰€æœ‰ç‹¬ç‰¹è¯·æ±‚ä¸­çš„é—®é¢˜ã€‚é€šå¸¸ï¼Œä½ å¯ä»¥ä½¿ç”¨å¹¿æ³›æ¨¡ç³Šæµ‹è¯•æ¥æ£€æµ‹ä¸å½“çš„èµ„äº§ç®¡ç†ï¼ˆç¨ååœ¨æœ¬ç« ä¸­è¯¦ç»†è®¨è®ºï¼‰ï¼ŒæŸ¥æ‰¾æ‰€æœ‰æœ‰æ•ˆçš„è¯·æ±‚æ–¹æ³•ã€ä»¤ç‰Œå¤„ç†é—®é¢˜å’Œå…¶ä»–ä¿¡æ¯æ³„éœ²æ¼æ´ã€‚æ·±å…¥æ¨¡ç³Šæµ‹è¯•æœ€é€‚åˆç”¨äºæµ‹è¯•å•ä¸ªè¯·æ±‚çš„å¤šä¸ªæ–¹é¢ã€‚å…¶ä»–å¤§å¤šæ•°æ¼æ´å‘ç°å°†é€šè¿‡æ·±å…¥æ¨¡ç³Šæµ‹è¯•å®Œæˆã€‚åœ¨åç»­ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ·±å…¥æ¨¡ç³Šæµ‹è¯•æŠ€æœ¯å‘ç°ä¸åŒç±»å‹çš„æ¼æ´ï¼ŒåŒ…æ‹¬
    BOLAã€BFLAã€æ³¨å…¥æ¼æ´å’Œæ‰¹é‡èµ‹å€¼æ¼æ´ã€‚
- en: Fuzzing Wide with Postman
  id: totrans-69
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ Postman è¿›è¡Œå¹¿æ³›æ¨¡ç³Šæµ‹è¯•
- en: I recommend using Postman to fuzz wide for vulnerabilities across an API, as
    the toolâ€™s Collection Runner makes it easy to run tests against all API requests.
    If an API includes 150 unique requests across all the endpoints, you can set a
    variable to a fuzzing payload entry and test it across all 150 requests. This
    is particularly easy to do when youâ€™ve built a collection or imported API requests
    into Postman. For example, you might use this strategy to test whether any of
    the requests fail to handle various â€œbadâ€ characters. Send a single payload across
    the API and check for anomalies.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘æ¨èä½¿ç”¨ Postman è¿›è¡Œå¹¿æ³›çš„æ¨¡ç³Šæµ‹è¯•ï¼Œä»¥æ£€æŸ¥ API ä¸­çš„æ¼æ´ï¼Œå› ä¸ºè¯¥å·¥å…·çš„é›†åˆè¿è¡Œå™¨ä½¿å¾—å¯¹æ‰€æœ‰ API è¯·æ±‚è¿›è¡Œæµ‹è¯•å˜å¾—å®¹æ˜“ã€‚å¦‚æœä¸€ä¸ª API
    åŒ…å« 150 ä¸ªç‹¬ç‰¹çš„è¯·æ±‚ï¼Œä½ å¯ä»¥è®¾ç½®ä¸€ä¸ªå˜é‡ä¸ºæ¨¡ç³Šæµ‹è¯•è½½è·ï¼Œå¹¶åœ¨æ‰€æœ‰ 150 ä¸ªè¯·æ±‚ä¸­è¿›è¡Œæµ‹è¯•ã€‚å½“ä½ å·²ç»æ„å»ºäº†ä¸€ä¸ªé›†åˆæˆ–å°† API è¯·æ±‚å¯¼å…¥åˆ° Postman
    æ—¶ï¼Œè¿™æ ·åšå°¤å…¶ç®€å•ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨æ­¤ç­–ç•¥æ¥æµ‹è¯•æ˜¯å¦æœ‰ä»»ä½•è¯·æ±‚æœªèƒ½å¤„ç†å„ç§â€œåâ€å­—ç¬¦ã€‚å‘é€ä¸€ä¸ªå•ä¸€çš„è½½è·åˆ°æ•´ä¸ª APIï¼Œå¹¶æ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸ã€‚
- en: Create a Postman environment in which to save a set of fuzzing variables. This
    lets you seamlessly use the environmental variables from one collection to the
    next. Once the fuzzing variables are set, just as they are in [Figure 9-3](#figure9-3),
    you can save or update the environment.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ›å»ºä¸€ä¸ª Postman ç¯å¢ƒï¼Œç”¨äºä¿å­˜ä¸€ç»„æ¨¡ç³Šæµ‹è¯•å˜é‡ã€‚è¿™æ ·ï¼Œä½ å°±å¯ä»¥æ— ç¼åœ°å°†ç¯å¢ƒå˜é‡ä»ä¸€ä¸ªé›†åˆä¼ é€’åˆ°ä¸‹ä¸€ä¸ªé›†åˆã€‚ä¸€æ—¦è®¾ç½®äº†æ¨¡ç³Šæµ‹è¯•å˜é‡ï¼Œå°±åƒåœ¨[å›¾
    9-3](#figure9-3)ä¸­æ‰€ç¤ºï¼Œä½ å¯ä»¥ä¿å­˜æˆ–æ›´æ–°è¯¥ç¯å¢ƒã€‚
- en: At the top right, select the fuzzing environment and then use the variable shortcut
    `{{``variable name``}}` wherever you would like to test a value in a given collection.
    In [Figure 9-4](#figure9-4), Iâ€™ve replaced the `x-access-token` header with the
    first fuzzing variable.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨å³ä¸Šè§’é€‰æ‹©æ¨¡ç³Šæµ‹è¯•ç¯å¢ƒï¼Œç„¶ååœ¨ä»»ä½•ä½ å¸Œæœ›æµ‹è¯•å€¼çš„åœ°æ–¹ä½¿ç”¨å˜é‡å¿«æ·æ–¹å¼ `{{``å˜é‡å``}}`ã€‚åœ¨[å›¾ 9-4](#figure9-4)ä¸­ï¼Œæˆ‘å°† `x-access-token`
    å¤´éƒ¨æ›¿æ¢ä¸ºç¬¬ä¸€ä¸ªæ¨¡ç³Šæµ‹è¯•å˜é‡ã€‚
- en: '![screenshot of postmanâ€™s manage environments window that lists fuzzing variables,
    their initial values, and their current values](image_fi/502444c09/F09003.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![Postman ç®¡ç†ç¯å¢ƒçª—å£çš„æˆªå›¾ï¼Œåˆ—å‡ºäº†æ¨¡ç³Šæµ‹è¯•å˜é‡ã€å®ƒä»¬çš„åˆå§‹å€¼å’Œå½“å‰å€¼](image_fi/502444c09/F09003.png)'
- en: 'Figure 9-3: Creating fuzzing variables in the Postman environment editor'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 9-3ï¼šåœ¨ Postman ç¯å¢ƒç¼–è¾‘å™¨ä¸­åˆ›å»ºæ¨¡ç³Šæµ‹è¯•å˜é‡
- en: '![screenshot of the postmanâ€™s edit collection windowâ€™s authorization tab that
    shows the x-access-token header is replaced with fuzz1](image_fi/502444c09/F09004.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![Postman ç¼–è¾‘é›†åˆçª—å£çš„æˆæƒæ ‡ç­¾æˆªå›¾ï¼Œæ˜¾ç¤º x-access-token å¤´è¢« fuzz1 æ›¿æ¢](image_fi/502444c09/F09004.png)'
- en: 'Figure 9-4: Fuzzing a collection token header'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 9-4ï¼šå¯¹é›†åˆä»¤ç‰Œå¤´è¿›è¡Œæ¨¡ç³Šæµ‹è¯•
- en: Additionally, you could replace parts of the URL, the other headers, or any
    custom variables youâ€™ve set in the collection. Then you use the Collection Runner
    to test every request within the collection.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¤å¤–ï¼Œä½ è¿˜å¯ä»¥æ›¿æ¢ URL ä¸­çš„éƒ¨åˆ†å†…å®¹ã€å…¶ä»–å¤´éƒ¨ï¼Œæˆ–ä½ åœ¨é›†åˆä¸­è®¾ç½®çš„ä»»ä½•è‡ªå®šä¹‰å˜é‡ã€‚ç„¶åï¼Œä½ ä½¿ç”¨é›†åˆè¿è¡Œå™¨æ¥æµ‹è¯•é›†åˆä¸­çš„æ¯ä¸ªè¯·æ±‚ã€‚
- en: Another useful Postman feature when fuzzing wide is Find and Replace, found
    at the bottom left of Postman. Find and Replace lets you search a collection (or
    all collections) and replace certain terms with a replacement of your choice.
    If you were attacking the Pixi API, for example, you might notice that many placeholder
    parameters use tags like `<email>`, `<number>`, `<string>`, and `<boolean>`. This
    makes it easy to search for these values and replace them with either legitimate
    ones or one of your fuzzing variables, like `{{fuzz1}}`.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: å¦ä¸€ä¸ªåœ¨å¹¿æ³›æ¨¡ç³Šæµ‹è¯•æ—¶æœ‰ç”¨çš„ Postman ç‰¹æ€§æ˜¯â€œæŸ¥æ‰¾å’Œæ›¿æ¢â€ï¼Œå®ƒä½äº Postman å·¦ä¸‹è§’ã€‚æŸ¥æ‰¾å’Œæ›¿æ¢è®©ä½ æœç´¢é›†åˆï¼ˆæˆ–æ‰€æœ‰é›†åˆï¼‰ï¼Œå¹¶å°†æŸäº›æœ¯è¯­æ›¿æ¢ä¸ºä½ é€‰æ‹©çš„æ›¿ä»£é¡¹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æ­£åœ¨æ”»å‡»
    Pixi APIï¼Œä½ å¯èƒ½ä¼šæ³¨æ„åˆ°è®¸å¤šå ä½ç¬¦å‚æ•°ä½¿ç”¨åƒ `<email>`ã€`<number>`ã€`<string>` å’Œ `<boolean>` è¿™æ ·çš„æ ‡ç­¾ã€‚è¿™ä½¿å¾—æœç´¢è¿™äº›å€¼å¹¶å°†å…¶æ›¿æ¢ä¸ºåˆæ³•å€¼æˆ–ä½ çš„ä¸€äº›æ¨¡ç³Šæµ‹è¯•å˜é‡ï¼ˆå¦‚
    `{{fuzz1}}`ï¼‰å˜å¾—éå¸¸å®¹æ˜“ã€‚
- en: 'Next, try creating a simple test in the Tests panel to help you detect anomalies.
    For instance, you could set up the test covered in Chapter 4 for a status code
    of 200 across a collection:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: æ¥ä¸‹æ¥ï¼Œå°è¯•åœ¨â€œTestsâ€é¢æ¿ä¸­åˆ›å»ºä¸€ä¸ªç®€å•çš„æµ‹è¯•ï¼Œå¸®åŠ©ä½ æ£€æµ‹å¼‚å¸¸ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥è®¾ç½®ç¬¬ 4 ç« ä¸­æåˆ°çš„æµ‹è¯•ï¼Œæ£€æŸ¥é›†åˆä¸­çš„æ‰€æœ‰è¯·æ±‚æ˜¯å¦è¿”å›çŠ¶æ€ç  200ï¼š
- en: '[PRE3]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: With this test, Postman will check that responses have a status code of 200,
    and when a response is 200, it will pass the test. You can easily customize this
    test by replacing 200 with your preferred status code.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ä¸ªæµ‹è¯•ä¸­ï¼ŒPostman å°†æ£€æŸ¥å“åº”æ˜¯å¦è¿”å›çŠ¶æ€ç  200ï¼Œå½“å“åº”ä¸º 200 æ—¶ï¼Œå®ƒå°†é€šè¿‡æµ‹è¯•ã€‚ä½ å¯ä»¥é€šè¿‡å°† 200 æ›¿æ¢ä¸ºä½ å–œæ¬¢çš„çŠ¶æ€ç æ¥è½»æ¾å®šåˆ¶è¿™ä¸ªæµ‹è¯•ã€‚
- en: There are several ways to launch the Collection Runner. You can click the **Runner
    Overview** button, the arrow next to a collection, or the **Run** button. As mentioned
    earlier, youâ€™ll need to develop a baseline of normal responses by sending requests
    with no values or expected values to the targeted field. An easy way to get such
    a baseline is to unselect the checkbox **Keep Variable Values**. With this option
    turned off, your variables wonâ€™t be used in the first collection run.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: å¯åŠ¨é›†åˆè¿è¡Œå™¨æœ‰å‡ ç§æ–¹å¼ã€‚ä½ å¯ä»¥ç‚¹å‡» **Runner Overview** æŒ‰é’®ã€é›†åˆæ—è¾¹çš„ç®­å¤´ï¼Œæˆ–ç‚¹å‡» **Run** æŒ‰é’®ã€‚å¦‚å‰æ‰€è¿°ï¼Œä½ éœ€è¦é€šè¿‡å‘é€æ²¡æœ‰å€¼æˆ–é¢„æœŸå€¼çš„è¯·æ±‚åˆ°ç›®æ ‡å­—æ®µï¼Œæ¥å¼€å‘ä¸€ä¸ªæ­£å¸¸å“åº”çš„åŸºçº¿ã€‚è·å¾—è¿™æ ·çš„åŸºçº¿çš„ä¸€ç§ç®€å•æ–¹æ³•æ˜¯å–æ¶ˆå‹¾é€‰
    **Keep Variable Values** å¤é€‰æ¡†ã€‚å…³é—­æ­¤é€‰é¡¹åï¼Œå˜é‡å°†åœ¨ç¬¬ä¸€æ¬¡é›†åˆè¿è¡Œæ—¶ä¸ä¼šè¢«ä½¿ç”¨ã€‚
- en: When we run this sample collection with the original request values, 13 requests
    pass our status code test and 5 fail. There is nothing extraordinary about this.
    The 5 failed attempts may be missing parameters or other input values, or they
    may just have response codes that are not 200\. Without us making additional changes,
    this test result could function as a baseline.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æˆ‘ä»¬ä½¿ç”¨åŸå§‹è¯·æ±‚å€¼è¿è¡Œè¿™ä¸ªç¤ºä¾‹é›†åˆæ—¶ï¼Œ13 ä¸ªè¯·æ±‚é€šè¿‡äº†çŠ¶æ€ç æµ‹è¯•ï¼Œ5 ä¸ªè¯·æ±‚å¤±è´¥äº†ã€‚è¿™å¹¶ä¸å¥‡æ€ªã€‚å¤±è´¥çš„ 5 æ¬¡å°è¯•å¯èƒ½ç¼ºå°‘å‚æ•°æˆ–å…¶ä»–è¾“å…¥å€¼ï¼Œæˆ–è€…å®ƒä»¬çš„å“åº”ä»£ç ä¸æ˜¯
    200ã€‚åœ¨æˆ‘ä»¬æ²¡æœ‰åšé¢å¤–ä¿®æ”¹çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæµ‹è¯•ç»“æœå¯ä»¥ä½œä¸ºåŸºå‡†ã€‚
- en: Now letâ€™s try fuzzing the collection. Make sure your environment is set up correctly,
    responses are saved for our review, that **Keep Variable Values** is checked,
    and that any responses that generate new tokens are disabled (we can test those
    requests with deep fuzzing techniques). In [Figure 9-5](#figure9-5), you can see
    these settings applied.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨è®©æˆ‘ä»¬å°è¯•å¯¹é›†åˆè¿›è¡Œæ¨¡ç³Šæµ‹è¯•ã€‚ç¡®ä¿ä½ çš„ç¯å¢ƒè®¾ç½®æ­£ç¡®ï¼Œå“åº”å·²ä¿å­˜ä»¥ä¾›å®¡æŸ¥ï¼Œ**Keep Variable Values** é€‰é¡¹å·²é€‰ä¸­ï¼Œå¹¶ä¸”ä»»ä½•ç”Ÿæˆæ–°ä»¤ç‰Œçš„å“åº”éƒ½å·²ç¦ç”¨ï¼ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ·±åº¦æ¨¡ç³Šæµ‹è¯•æŠ€æœ¯æµ‹è¯•è¿™äº›è¯·æ±‚ï¼‰ã€‚åœ¨
    [å›¾ 9-5](#figure9-5) ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°è¿™äº›è®¾ç½®å·²åº”ç”¨ã€‚
- en: '![screenshot of postmanâ€™s collection runner results that shows requests and
    their responses](image_fi/502444c09/F09005.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![Postman é›†åˆè¿è¡Œå™¨ç»“æœæˆªå›¾ï¼Œæ˜¾ç¤ºè¯·æ±‚åŠå…¶å“åº”](image_fi/502444c09/F09005.png)'
- en: 'Figure 9-5: Postman Collection Runner results'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 9-5ï¼šPostman é›†åˆè¿è¡Œå™¨ç»“æœ
- en: Run the collection and then look for deviations from the baseline responses.
    Also watch for changes in the request behavior. For example, when we ran the requests
    using the value `Fuzz1('OR 1=1-- -)`, the Collection Runner passed three tests
    and then failed to process any additional requests. This is an indication that
    the web application took issue with the fuzzing attempt involved in the fourth
    request. Although we did not receive an interesting response, the behavior itself
    is an indication that you may have discovered a vulnerability.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: è¿è¡Œé›†åˆåï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰åç¦»åŸºå‡†å“åº”çš„æƒ…å†µã€‚è¿˜è¦æ³¨æ„è¯·æ±‚è¡Œä¸ºçš„å˜åŒ–ã€‚ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨å€¼`Fuzz1('OR 1=1-- -)`è¿è¡Œè¯·æ±‚æ—¶ï¼Œé›†åˆè¿è¡Œå™¨é€šè¿‡äº†ä¸‰æ¬¡æµ‹è¯•ï¼Œç„¶åæœªèƒ½å¤„ç†ä»»ä½•é¢å¤–è¯·æ±‚ã€‚è¿™è¡¨æ˜
    Web åº”ç”¨ç¨‹åºå¯¹ç¬¬å››ä¸ªè¯·æ±‚ä¸­çš„æ¨¡ç³Šå°è¯•äº§ç”Ÿäº†é—®é¢˜ã€‚è™½ç„¶æˆ‘ä»¬æ²¡æœ‰æ”¶åˆ°æœ‰è¶£çš„å“åº”ï¼Œä½†è¡Œä¸ºæœ¬èº«è¡¨æ˜ä½ å¯èƒ½å‘ç°äº†ä¸€ä¸ªæ¼æ´ã€‚
- en: Once youâ€™ve cycled through a collection run, update the fuzzing value to the
    next variable you would like to test, perform another collection run, and compare
    results. You could detect several vulnerabilities by fuzzing wide with Postman,
    such as improper assets management, injection weaknesses, and other information
    disclosures that could lead to more interesting findings. When youâ€™ve exhausted
    your fuzzing-wide attempts or found an interesting response, it is time to pivot
    your testing to fuzzing deep.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦ä½ å¾ªç¯å®Œæˆä¸€æ¬¡é›†åˆè¿è¡Œï¼Œæ›´æ–°æ¨¡ç³Šå€¼ä¸ºä¸‹ä¸€ä¸ªä½ æƒ³æµ‹è¯•çš„å˜é‡ï¼Œæ‰§è¡Œå¦ä¸€æ¬¡é›†åˆè¿è¡Œï¼Œå¹¶æ¯”è¾ƒç»“æœã€‚ä½ å¯ä»¥é€šè¿‡åœ¨ Postman ä¸­å¹¿æ³›è¿›è¡Œæ¨¡ç³Šæµ‹è¯•æ¥å‘ç°å‡ ä¸ªæ¼æ´ï¼Œæ¯”å¦‚ä¸å½“çš„èµ„äº§ç®¡ç†ã€æ³¨å…¥æ¼æ´ä»¥åŠå…¶ä»–å¯èƒ½å¯¼è‡´æ›´æœ‰è¶£å‘ç°çš„ä¿¡æ¯æ³„éœ²ã€‚å½“ä½ è€—å°½äº†å¹¿æ³›æ¨¡ç³Šæµ‹è¯•çš„å°è¯•æˆ–å‘ç°äº†æœ‰è¶£çš„å“åº”æ—¶ï¼Œæ˜¯æ—¶å€™å°†æµ‹è¯•è½¬å‘æ·±å…¥æ¨¡ç³Šæµ‹è¯•äº†ã€‚
- en: Fuzzing Deep with Burp Suite
  id: totrans-89
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ Burp Suite è¿›è¡Œæ·±å…¥æ¨¡ç³Šæµ‹è¯•
- en: You should fuzz deep whenever you want to drill down into specific requests.
    The technique is especially useful for thoroughly testing each individual API
    request. For this task, I recommend using Burp Suite or Wfuzz.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ä½ æƒ³è¦æ·±å…¥åˆ†æç‰¹å®šè¯·æ±‚æ—¶ï¼Œåº”è¯¥è¿›è¡Œæ·±å…¥æ¨¡ç³Šæµ‹è¯•ã€‚è¿™é¡¹æŠ€æœ¯å¯¹äºå½»åº•æµ‹è¯•æ¯ä¸ªå•ç‹¬çš„ API è¯·æ±‚å°¤å…¶æœ‰ç”¨ã€‚å¯¹äºè¿™ä¸ªä»»åŠ¡ï¼Œæˆ‘å»ºè®®ä½¿ç”¨ Burp Suite
    æˆ– Wfuzzã€‚
- en: In Burp Suite, you can use Intruder to fuzz every header, parameter, query string,
    and endpoint path, along with any item included in the body of the request. For
    example, in a request like the one in [Figure 9-6](#figure9-6), shown in Postman,
    with many fields in the request body, you can perform a deep fuzz that passes
    hundreds or even thousands of fuzzing inputs into each value to see how the API
    responds.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ Burp Suite ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ Intruder å¯¹æ¯ä¸ªå¤´éƒ¨ã€å‚æ•°ã€æŸ¥è¯¢å­—ç¬¦ä¸²å’Œç«¯ç‚¹è·¯å¾„è¿›è¡Œæ¨¡ç³Šæµ‹è¯•ï¼Œä»¥åŠè¯·æ±‚ä½“ä¸­åŒ…å«çš„ä»»ä½•é¡¹ã€‚ä¾‹å¦‚ï¼Œåœ¨å¦‚[å›¾
    9-6](#figure9-6)æ‰€ç¤ºçš„ Postman è¯·æ±‚ä¸­ï¼Œè¯·æ±‚ä½“åŒ…å«è®¸å¤šå­—æ®µï¼Œä½ å¯ä»¥è¿›è¡Œæ·±å…¥çš„æ¨¡ç³Šæµ‹è¯•ï¼Œå°†æˆç™¾ä¸Šåƒçš„æ¨¡ç³Šè¾“å…¥ä¼ å…¥æ¯ä¸ªå€¼ï¼Œä»¥æŸ¥çœ‹ API
    å¦‚ä½•å“åº”ã€‚
- en: '![screenshot of a request in postman under edit user information; the body
    of the request contains the following: â€œuserâ€: â€œ<email>â€, / â€œpassâ€: â€œ<string>â€,
    / â€œidâ€: â€œ<number>â€, â€œnameâ€: â€œ<string>â€, â€œis_adminâ€: â€œ<boolean>â€, â€œaccount_balanceâ€:
    â€œ<number>â€](image_fi/502444c09/F09006.png)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![åœ¨ Postman ä¸­ç¼–è¾‘ç”¨æˆ·ä¿¡æ¯çš„è¯·æ±‚æˆªå›¾ï¼›è¯·æ±‚ä½“åŒ…å«ä»¥ä¸‹å†…å®¹ï¼šâ€œuserâ€: â€œ<email>â€, / â€œpassâ€: â€œ<string>â€,
    / â€œidâ€: â€œ<number>â€, â€œnameâ€: â€œ<string>â€, â€œis_adminâ€: â€œ<boolean>â€, â€œaccount_balanceâ€:
    â€œ<number>â€](image_fi/502444c09/F09006.png)'
- en: 'Figure 9-6: A PUT request in Postman'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 9-6ï¼šPostman ä¸­çš„ PUT è¯·æ±‚
- en: While you might initially craft your requests in Postman, make sure to proxy
    the traffic to Burp Suite. Start Burp Suite, configure the Postman proxy settings,
    send the request, and make sure it was intercepted. Then forward it to Intruder.
    Using the payload position markers, select every fieldâ€™s value to send a payload
    list as each of those values. A sniper attack will cycle a single wordlist through
    each attack position. The payload for an initial fuzzing attack could be similar
    to the list described in the â€œChoosing Fuzzing Payloadsâ€ section of this chapter.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: è™½ç„¶ä½ æœ€åˆå¯èƒ½åœ¨ Postman ä¸­æ„å»ºè¯·æ±‚ï¼Œä½†ç¡®ä¿å°†æµé‡ä»£ç†åˆ° Burp Suiteã€‚å¯åŠ¨ Burp Suiteï¼Œé…ç½® Postman çš„ä»£ç†è®¾ç½®ï¼Œå‘é€è¯·æ±‚ï¼Œå¹¶ç¡®ä¿å®ƒå·²è¢«æ‹¦æˆªã€‚ç„¶åå°†å…¶è½¬å‘åˆ°
    Intruderã€‚ä½¿ç”¨è´Ÿè½½ä½ç½®æ ‡è®°ï¼Œé€‰æ‹©æ¯ä¸ªå­—æ®µçš„å€¼ï¼Œå°†è´Ÿè½½åˆ—è¡¨ä½œä¸ºæ¯ä¸ªå€¼å‘é€ã€‚ç‹™å‡»æ”»å‡»ä¼šå°†å•ä¸€çš„å­—å…¸åˆ—è¡¨å¾ªç¯é€šè¿‡æ¯ä¸ªæ”»å‡»ä½ç½®ã€‚åˆæ­¥æ¨¡ç³Šæ”»å‡»çš„è´Ÿè½½å¯èƒ½ç±»ä¼¼äºæœ¬ç« â€œé€‰æ‹©æ¨¡ç³Šè´Ÿè½½â€éƒ¨åˆ†æè¿°çš„åˆ—è¡¨ã€‚
- en: 'Before you begin, consider whether a requestâ€™s field expects any particular
    value. For example, take a look at the following PUT request, where the tags (`<
    >`) suggest that the API is configured to expect certain values:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨å¼€å§‹ä¹‹å‰ï¼Œè€ƒè™‘è¯·æ±‚çš„å­—æ®µæ˜¯å¦æœŸæœ›æŸäº›ç‰¹å®šçš„å€¼ã€‚ä¾‹å¦‚ï¼ŒæŸ¥çœ‹ä»¥ä¸‹ PUT è¯·æ±‚ï¼Œå…¶ä¸­æ ‡ç­¾ï¼ˆ`< >`ï¼‰è¡¨æ˜ API é…ç½®ä¸ºæœŸæœ›æŸäº›å€¼ï¼š
- en: '[PRE4]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'When youâ€™re fuzzing, it is always worthwhile to request the unexpected. If
    a field expects an email, send numbers. If it expects numbers, send a string.
    If it expects a small string, send a huge string. If it expects a Boolean value
    (true/false), send anything else. Another useful tip is to send the expected value
    and include a fuzzing attempt following that value. For example, email fields
    are fairly predictable, and developers often nail down the input validation to
    make sure that you are sending a valid-looking email. Since this is the case,
    when you fuzz an email field, you may receive the same response for all your attempts:
    â€œnot a valid email.â€ In this case, check to see what happens if you send a valid-looking
    email followed by a fuzzing payload. That would look something like this:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ä½ è¿›è¡Œæ¨¡ç³Šæµ‹è¯•æ—¶ï¼Œå§‹ç»ˆå€¼å¾—è¯·æ±‚æ„å¤–çš„å†…å®¹ã€‚å¦‚æœä¸€ä¸ªå­—æ®µæœŸæœ›ç”µå­é‚®ä»¶ï¼Œå‘é€æ•°å­—ã€‚å¦‚æœå®ƒæœŸæœ›æ•°å­—ï¼Œå‘é€å­—ç¬¦ä¸²ã€‚å¦‚æœå®ƒæœŸæœ›ä¸€ä¸ªå°å­—ç¬¦ä¸²ï¼Œå‘é€ä¸€ä¸ªå·¨å¤§çš„å­—ç¬¦ä¸²ã€‚å¦‚æœå®ƒæœŸæœ›å¸ƒå°”å€¼ï¼ˆtrue/falseï¼‰ï¼Œå‘é€å…¶ä»–ä»»ä½•å†…å®¹ã€‚å¦ä¸€ä¸ªæœ‰ç”¨çš„æŠ€å·§æ˜¯å‘é€é¢„æœŸå€¼å¹¶åœ¨è¯¥å€¼åæ·»åŠ ä¸€ä¸ªæ¨¡ç³Šæµ‹è¯•å°è¯•ã€‚ä¾‹å¦‚ï¼Œç”µå­é‚®ä»¶å­—æ®µæ˜¯ç›¸å½“å¯é¢„æµ‹çš„ï¼Œå¼€å‘äººå‘˜é€šå¸¸ä¼šå¯¹è¾“å…¥éªŒè¯è¿›è¡Œä¸¥æ ¼æ£€æŸ¥ï¼Œä»¥ç¡®ä¿ä½ å‘é€çš„æ˜¯æœ‰æ•ˆçš„ç”µå­é‚®ä»¶ã€‚å› ä¸ºæ˜¯è¿™ç§æƒ…å†µï¼Œå½“ä½ å¯¹ç”µå­é‚®ä»¶å­—æ®µè¿›è¡Œæ¨¡ç³Šæµ‹è¯•æ—¶ï¼Œä½ å¯èƒ½ä¼šæ”¶åˆ°ç›¸åŒçš„å“åº”ï¼šâ€œæ— æ•ˆçš„ç”µå­é‚®ä»¶â€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ£€æŸ¥å¦‚æœä½ å‘é€ä¸€ä¸ªçœ‹èµ·æ¥æœ‰æ•ˆçš„ç”µå­é‚®ä»¶ï¼Œå¹¶åœ¨å…¶åæ·»åŠ æ¨¡ç³Šæµ‹è¯•æœ‰æ•ˆè½½è·ä¼šå‘ç”Ÿä»€ä¹ˆã€‚è¿™å°†çœ‹èµ·æ¥åƒè¿™æ ·ï¼š
- en: '[PRE5]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: If you receive the same response (â€œnot a valid emailâ€), it is likely time to
    try a different payload or move on to a different field.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ æ”¶åˆ°ç›¸åŒçš„å“åº”ï¼ˆâ€œæ— æ•ˆçš„ç”µå­é‚®ä»¶â€ï¼‰ï¼Œå¾ˆå¯èƒ½æ˜¯æ—¶å€™å°è¯•ä¸åŒçš„æœ‰æ•ˆè½½è·æˆ–è½¬åˆ°å…¶ä»–å­—æ®µäº†ã€‚
- en: When fuzzing deep, be aware of how many requests youâ€™ll be sending. A sniper
    attack containing a list of 12 payloads across 6 payload positions will result
    in 72 total requests. This is a relatively small number of requests.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿›è¡Œæ·±åº¦æ¨¡ç³Šæµ‹è¯•æ—¶ï¼Œæ³¨æ„ä½ å°†å‘é€å¤šå°‘è¯·æ±‚ã€‚ä¸€ä¸ªåŒ…å«12ä¸ªæœ‰æ•ˆè½½è·ã€è·¨6ä¸ªæœ‰æ•ˆè½½è·ä½ç½®çš„ç‹™å‡»æ”»å‡»å°†å¯¼è‡´72ä¸ªæ€»è¯·æ±‚ã€‚è¿™æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒå°çš„è¯·æ±‚æ•°é‡ã€‚
- en: When you receive your results, Burp Suite has a few tools to help detect anomalies.
    First, organize the requests by column, such as status code, length of the response,
    and request number, each of which can yield useful information. Additionally,
    Burp Suite Pro allows you to filter by search terms.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ä½ æ”¶åˆ°ç»“æœæ—¶ï¼ŒBurp Suite æä¾›äº†ä¸€äº›å·¥å…·æ¥å¸®åŠ©æ£€æµ‹å¼‚å¸¸ã€‚é¦–å…ˆï¼ŒæŒ‰åˆ—ç»„ç»‡è¯·æ±‚ï¼Œä¾‹å¦‚çŠ¶æ€ç ã€å“åº”é•¿åº¦å’Œè¯·æ±‚ç¼–å·ï¼Œè¿™äº›éƒ½èƒ½æä¾›æœ‰ç”¨çš„ä¿¡æ¯ã€‚æ­¤å¤–ï¼ŒBurp
    Suite Pro å…è®¸ä½ æŒ‰æœç´¢è¯è¿›è¡Œç­›é€‰ã€‚
- en: 'If you notice an interesting response, select the result and choose the **Response**
    tab to dissect how the API provider responded. In [Figure 9-7](#figure9-7), fuzzing
    any field with the payload `{}[]|\:";''<>?,./` resulted in an HTTP 400 response
    code and the response `SyntaxError: Unexpected token in JSON at position 32`.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 'å¦‚æœä½ æ³¨æ„åˆ°ä¸€ä¸ªæœ‰è¶£çš„å“åº”ï¼Œé€‰æ‹©è¯¥ç»“æœå¹¶é€‰æ‹©**å“åº”**æ ‡ç­¾ï¼Œåˆ†æ API æä¾›æ–¹å¦‚ä½•å“åº”ã€‚åœ¨[å›¾ 9-7](#figure9-7)ä¸­ï¼Œä½¿ç”¨æœ‰æ•ˆè½½è·
    `{}[]|\:";''<>?,./` å¯¹ä»»ä½•å­—æ®µè¿›è¡Œæ¨¡ç³Šæµ‹è¯•ï¼Œç»“æœæ˜¯ HTTP 400 å“åº”ä»£ç å’Œå“åº” `SyntaxError: Unexpected
    token in JSON at position 32`ã€‚'
- en: '![screenshot of burp suite showing an http 400 response code and a syntaxerror](image_fi/502444c09/F09007.png)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![burp suite æˆªå›¾ï¼Œæ˜¾ç¤º HTTP 400 å“åº”ä»£ç å’Œè¯­æ³•é”™è¯¯](image_fi/502444c09/F09007.png)'
- en: 'Figure 9-7: Burp Suite attack results'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 9-7ï¼šBurp Suite æ”»å‡»ç»“æœ
- en: Once you have an interesting error like this one, you could improve your payloads
    to narrow down exactly what is causing the error. If you figure out the exact
    symbol or combination of symbols causing the issue, attempt to pair other payloads
    with it to see if you can get additional interesting responses. For instance,
    if the resulting responses indicate a database error, you could use payloads that
    target those databases. If the error indicates an operating system or specific
    programming language, use a payload targeting it. In this situation, the error
    is related to an unexpected JSON token, so it would be interesting to see how
    this endpoint handles JSON fuzzing payloads and what happens when additional payloads
    are added.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦ä½ å¾—åˆ°åƒè¿™æ ·çš„æœ‰è¶£é”™è¯¯ï¼Œä½ å¯ä»¥æ”¹è¿›æœ‰æ•ˆè½½è·ï¼Œä»¥ç²¾ç¡®ç¡®å®šå¯¼è‡´é”™è¯¯çš„åŸå› ã€‚å¦‚æœä½ æ‰¾å‡ºå¯¼è‡´é—®é¢˜çš„ç¡®åˆ‡ç¬¦å·æˆ–ç¬¦å·ç»„åˆï¼Œå°è¯•å°†å…¶ä»–æœ‰æ•ˆè½½è·ä¸å…¶é…å¯¹ï¼Œçœ‹çœ‹èƒ½å¦è·å¾—æ›´å¤šæœ‰è¶£çš„å“åº”ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¿”å›çš„å“åº”æŒ‡ç¤ºæ•°æ®åº“é”™è¯¯ï¼Œä½ å¯ä»¥ä½¿ç”¨é’ˆå¯¹è¿™äº›æ•°æ®åº“çš„æœ‰æ•ˆè½½è·ã€‚å¦‚æœé”™è¯¯æŒ‡ç¤ºæ“ä½œç³»ç»Ÿæˆ–ç‰¹å®šçš„ç¼–ç¨‹è¯­è¨€ï¼Œä½¿ç”¨é’ˆå¯¹å®ƒçš„æœ‰æ•ˆè½½è·ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé”™è¯¯ä¸æ„å¤–çš„
    JSON ä»¤ç‰Œæœ‰å…³ï¼Œå› æ­¤çœ‹åˆ°è¯¥ç«¯ç‚¹å¦‚ä½•å¤„ç† JSON æ¨¡ç³Šæµ‹è¯•æœ‰æ•ˆè½½è·ï¼Œä»¥åŠå½“æ·»åŠ æ›´å¤šæœ‰æ•ˆè½½è·æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œå°†ä¼šå¾ˆæœ‰è¶£ã€‚
- en: Fuzzing Deep with Wfuzz
  id: totrans-106
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ Wfuzz è¿›è¡Œæ·±åº¦æ¨¡ç³Šæµ‹è¯•
- en: If youâ€™re using Burp Suite CE, Intruder will limit the rate you can send requests,
    so you should use Wfuzz when sending a larger number of payloads. Using Wfuzz
    to send a large POST or PUT request can be intimidating at first due to the amount
    of information youâ€™ll need to correctly add to the command line. However, with
    a few tips, you should be able to migrate back and forth between Burp Suite CE
    and Wfuzz without too many challenges.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Burp Suite CEï¼ŒIntruder ä¼šé™åˆ¶ä½ å‘é€è¯·æ±‚çš„é€Ÿç‡ï¼Œå› æ­¤åœ¨å‘é€å¤§é‡æœ‰æ•ˆè´Ÿè½½æ—¶ï¼Œä½ åº”è¯¥ä½¿ç”¨ Wfuzzã€‚æœ€åˆï¼Œä½¿ç”¨ Wfuzz
    å‘é€ä¸€ä¸ªå¤§çš„ POST æˆ– PUT è¯·æ±‚å¯èƒ½ä¼šè®©äººæ„Ÿåˆ°æœ‰äº›å¤æ‚ï¼Œå› ä¸ºä½ éœ€è¦åœ¨å‘½ä»¤è¡Œä¸­æ­£ç¡®åœ°æ·»åŠ å¤§é‡ä¿¡æ¯ã€‚ç„¶è€Œï¼Œåªè¦æŒæ¡å‡ ä¸ªæŠ€å·§ï¼Œä½ åº”è¯¥èƒ½å¤Ÿåœ¨ Burp Suite
    CE å’Œ Wfuzz ä¹‹é—´æ¥å›åˆ‡æ¢ï¼Œè€Œä¸ä¼šé‡åˆ°å¤ªå¤šæŒ‘æˆ˜ã€‚
- en: 'One advantage of Wfuzz is that itâ€™s considerably faster than Burp Suite, so
    we can increase our payload size. The following example uses a SecLists payload
    called *big-list-of-naughty-strings.txt*, which contains over 500 values:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: Wfuzz çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯å®ƒæ¯” Burp Suite å¿«å¾—å¤šï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¢åŠ æœ‰æ•ˆè´Ÿè½½çš„å¤§å°ã€‚ä»¥ä¸‹ç¤ºä¾‹ä½¿ç”¨äº†ä¸€ä¸ªåä¸º *big-list-of-naughty-strings.txt*
    çš„ SecLists æœ‰æ•ˆè´Ÿè½½ï¼Œå…¶ä¸­åŒ…å«è¶…è¿‡ 500 ä¸ªå€¼ï¼š
- en: '[PRE6]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Letâ€™s build our Wfuzz command step-by-step. First, to match the Burp Suite example
    covered in the previous section, we will need to include the `Content-Type` and
    `x-access-token` headers in order to receive authenticated results from the API.
    Each header is specified with the option `-H` and surrounded by quotes.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ„å»º Wfuzz å‘½ä»¤ã€‚é¦–å…ˆï¼Œä¸ºäº†åŒ¹é…å‰ä¸€èŠ‚ä¸­è®¨è®ºçš„ Burp Suite ç¤ºä¾‹ï¼Œæˆ‘ä»¬éœ€è¦åŒ…å« `Content-Type` å’Œ `x-access-token`
    å¤´ï¼Œä»¥ä¾¿ä» API è·å–è®¤è¯åçš„ç»“æœã€‚æ¯ä¸ªå¤´éƒ¨é€šè¿‡ `-H` é€‰é¡¹æŒ‡å®šï¼Œå¹¶ç”¨å¼•å·æ‹¬èµ·æ¥ã€‚
- en: '[PRE7]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Next, note that the request method is PUT. You can specify it with the `-X`
    option. Also, to filter out responses with a status code of 400, use the `--hc
    400` option:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: æ¥ä¸‹æ¥ï¼Œè¯·æ³¨æ„è¯·æ±‚æ–¹æ³•æ˜¯ PUTã€‚ä½ å¯ä»¥é€šè¿‡ `-X` é€‰é¡¹æŒ‡å®šå®ƒã€‚æ­¤å¤–ï¼Œä¸ºäº†è¿‡æ»¤æ‰çŠ¶æ€ç ä¸º 400 çš„å“åº”ï¼Œå¯ä»¥ä½¿ç”¨ `--hc 400` é€‰é¡¹ï¼š
- en: '[PRE8]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Now, to fuzz a request body using Wfuzz, specify the request body with the
    `-d` option and paste the body into the command, surrounded by quotes. Note that
    Wfuzz will normally remove quotes, so use backslashes to keep them in the request
    body. As usual, we replace the parameters we would like to fuzz with the term
    `FUZZ`. Finally, we use `-u` to specify the URL weâ€™re attacking:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œä½¿ç”¨ Wfuzz æ¨¡ç³Šæµ‹è¯•è¯·æ±‚ä½“æ—¶ï¼Œé€šè¿‡ `-d` é€‰é¡¹æŒ‡å®šè¯·æ±‚ä½“ï¼Œå¹¶å°†è¯·æ±‚ä½“ç²˜è´´åˆ°å‘½ä»¤ä¸­ï¼Œç”¨å¼•å·æ‹¬èµ·æ¥ã€‚è¯·æ³¨æ„ï¼ŒWfuzz é€šå¸¸ä¼šåˆ é™¤å¼•å·ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨åæ–œæ æ¥ä¿ç•™å®ƒä»¬ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†è¦æ¨¡ç³Šæµ‹è¯•çš„å‚æ•°æ›¿æ¢ä¸º
    `FUZZ`ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨ `-u` æ¥æŒ‡å®šæˆ‘ä»¬è¦æ”»å‡»çš„ URLï¼š
- en: '[PRE9]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'This is a decent-sized command with plenty of room to make mistakes. If you
    need to troubleshoot it, I recommend proxying the requests to Burp Suite, which
    should help you visualize the requests youâ€™re sending. To proxy traffic back to
    Burp, use the `-p` proxy option with your IP address and the port on which Burp
    Suite is running:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ä¸ªç›¸å½“å¤æ‚çš„å‘½ä»¤ï¼Œæœ‰è¶³å¤Ÿçš„ç©ºé—´è®©äººå‡ºé”™ã€‚å¦‚æœä½ éœ€è¦æ•…éšœæ’é™¤ï¼Œå»ºè®®å°†è¯·æ±‚ä»£ç†åˆ° Burp Suiteï¼Œè¿™å°†å¸®åŠ©ä½ å¯è§†åŒ–å‘é€çš„è¯·æ±‚ã€‚è¦å°†æµé‡ä»£ç†å› Burpï¼Œä½¿ç”¨
    `-p` ä»£ç†é€‰é¡¹ï¼Œå¹¶æŒ‡å®š Burp Suite è¿è¡Œæ‰€åœ¨çš„ IP åœ°å€å’Œç«¯å£ï¼š
- en: '[PRE10]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'In Burp Suite, inspect the intercepted request and send it to Repeater to see
    if there are any typos or mistakes. If your Wfuzz command is operating properly,
    run it and review the results, which should look like this:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ Burp Suite ä¸­ï¼Œæ£€æŸ¥æ‹¦æˆªçš„è¯·æ±‚å¹¶å°†å…¶å‘é€åˆ° Repeaterï¼Œä»¥æŸ¥çœ‹æ˜¯å¦æœ‰ä»»ä½•æ‹¼å†™é”™è¯¯æˆ–å…¶ä»–é—®é¢˜ã€‚å¦‚æœä½ çš„ Wfuzz å‘½ä»¤æ­£å¸¸è¿è¡Œï¼Œæ‰§è¡Œå®ƒå¹¶æŸ¥çœ‹ç»“æœï¼Œåº”è¯¥åƒè¿™æ ·ï¼š
- en: '[PRE11]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Now you can seek out the anomalies and conduct additional requests to analyze
    what youâ€™ve found. In this case, it would be worth seeing how the API provider
    responds to the payload that caused a 302 response code. Use this payload in Burp
    Suiteâ€™s Repeater or Postman.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œä½ å¯ä»¥å¯»æ‰¾å¼‚å¸¸å¹¶æ‰§è¡Œé¢å¤–çš„è¯·æ±‚æ¥åˆ†æä½ å‘ç°çš„å†…å®¹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå€¼å¾—è§‚å¯Ÿ API æä¾›æ–¹å¦‚ä½•å›åº”å¯¼è‡´ 302 å“åº”ä»£ç çš„æœ‰æ•ˆè´Ÿè½½ã€‚ä½¿ç”¨è¿™ä¸ªæœ‰æ•ˆè´Ÿè½½åœ¨
    Burp Suite çš„ Repeater æˆ– Postman ä¸­è¿›è¡Œæµ‹è¯•ã€‚
- en: Fuzzing Wide for Improper Assets Management
  id: totrans-121
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: å¹¿æ³›æ¨¡ç³Šæµ‹è¯•ä¸å½“èµ„äº§ç®¡ç†
- en: Improper assets management vulnerabilities arise when an organization exposes
    APIs that are either retired, in a test environment, or still in development.
    In any of these cases, there is a good chance the API has fewer protections than
    its supported production counterparts. Improper assets management might affect
    only a single endpoint or request, so itâ€™s often useful to fuzz wide to test if
    improper assets management exists for any request across an API.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸å½“èµ„äº§ç®¡ç†æ¼æ´é€šå¸¸å‘ç”Ÿåœ¨ç»„ç»‡æš´éœ²äº†å·²é€€å½¹ã€å¤„äºæµ‹è¯•ç¯å¢ƒä¸­æˆ–ä»åœ¨å¼€å‘ä¸­çš„ APIã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼ŒAPI å¯èƒ½æ¯”å…¶æ”¯æŒçš„ç”Ÿäº§ç¯å¢ƒç‰ˆæœ¬å…·æœ‰æ›´å°‘çš„ä¿æŠ¤ã€‚ä¸å½“èµ„äº§ç®¡ç†å¯èƒ½ä»…å½±å“å•ä¸ªç«¯ç‚¹æˆ–è¯·æ±‚ï¼Œå› æ­¤é€šå¸¸éœ€è¦å¹¿æ³›æ¨¡ç³Šæµ‹è¯•ï¼Œä»¥æ£€æŸ¥
    API ä¸­çš„ä»»ä½•è¯·æ±‚æ˜¯å¦å­˜åœ¨ä¸å½“èµ„äº§ç®¡ç†ã€‚
- en: As discussed in Chapter 3, you can find improper assets management vulnerabilities
    by paying close attention to outdated API documentation. If an organizationâ€™s
    API documentation has not been updated along with the organizationâ€™s API endpoints,
    it could contain references to portions of the API that are no longer supported.
    Also, check any sort of changelog or GitHub repository. A changelog that says
    something along the lines of â€œresolved broken object level authorization vulnerability
    in v3â€ will make finding an endpoint still using v1 or v2 all the sweeter.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚ç¬¬ 3 ç« æ‰€è¿°ï¼Œä½ å¯ä»¥é€šè¿‡å¯†åˆ‡å…³æ³¨è¿‡æ—¶çš„ API æ–‡æ¡£æ¥å‘ç°ä¸å½“çš„èµ„äº§ç®¡ç†æ¼æ´ã€‚å¦‚æœä¸€ä¸ªç»„ç»‡çš„ API æ–‡æ¡£æ²¡æœ‰éšç€ç»„ç»‡çš„ API ç«¯ç‚¹æ›´æ–°ï¼Œå®ƒå¯èƒ½ä¼šåŒ…å«æŒ‡å‘ä¸å†å—æ”¯æŒçš„
    API éƒ¨åˆ†çš„å¼•ç”¨ã€‚æ­¤å¤–ï¼Œæ£€æŸ¥ä»»ä½•ç±»å‹çš„å˜æ›´æ—¥å¿—æˆ– GitHub ä»“åº“ã€‚å¦‚æœå˜æ›´æ—¥å¿—ä¸­æåˆ°â€œè§£å†³äº† v3 ä¸­çš„å¯¹è±¡çº§æˆæƒæ¼æ´â€ï¼Œé‚£ä¹ˆæ‰¾åˆ°ä»åœ¨ä½¿ç”¨ v1 æˆ–
    v2 çš„ç«¯ç‚¹å°†å˜å¾—æ›´åŠ å®¹æ˜“ã€‚
- en: Other than using documentation, you can discover improper assets vulnerabilities
    through the use of fuzzing. One of the best ways to do this is to watch for patterns
    in the business logic and test your assumptions. For example, in [Figure 9-8](#figure9-8),
    you can see that the `baseURL` variable used within all requests for this collection
    is *https://petstore.swagger.io/v2*. Try replacing *v2* with *v1* and using Postmanâ€™s
    Collection Runner.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: é™¤äº†ä½¿ç”¨æ–‡æ¡£ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡æ¨¡ç³Šæµ‹è¯•ï¼ˆfuzzingï¼‰æ¥å‘ç°ä¸å½“çš„èµ„äº§æ¼æ´ã€‚æœ€å¥½çš„æ–¹æ³•ä¹‹ä¸€æ˜¯è§‚å¯Ÿä¸šåŠ¡é€»è¾‘ä¸­çš„æ¨¡å¼å¹¶æµ‹è¯•ä½ çš„å‡è®¾ã€‚ä¾‹å¦‚ï¼Œåœ¨[å›¾ 9-8](#figure9-8)ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°åœ¨è¯¥é›†åˆçš„æ‰€æœ‰è¯·æ±‚ä¸­ä½¿ç”¨çš„`baseURL`å˜é‡æ˜¯*https://petstore.swagger.io/v2*ã€‚å°è¯•å°†*v2*æ›¿æ¢ä¸º*v1*ï¼Œç„¶åä½¿ç”¨
    Postman çš„é›†åˆè¿è¡Œå™¨ï¼ˆCollection Runnerï¼‰è¿›è¡Œæµ‹è¯•ã€‚
- en: '![screenshot of postman showing the variables tab within a collection](image_fi/502444c09/F09008.png)'
  id: totrans-125
  prefs: []
  type: TYPE_IMG
  zh: '![Postman ä¸­æ˜¾ç¤ºé›†åˆå†…å˜é‡é€‰é¡¹å¡çš„æˆªå›¾](image_fi/502444c09/F09008.png)'
- en: 'Figure 9-8: Editing the collection variables within Postman'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 9-8ï¼šåœ¨ Postman ä¸­ç¼–è¾‘é›†åˆå˜é‡
- en: 'The production version of the sample API is *v2*, so it would be a good idea
    to test a few keywords, like *v1*, *v3*, *test*, *mobile*, *uat*, *dev*, and *old*,
    as well as any interesting paths discovered during analysis or reconnaissance
    testing. Additionally, some API providers will allow access to administrative
    functionality by adding */internal/* to the path before or after the versioning,
    which would look like this:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: ç¤ºä¾‹ API çš„ç”Ÿäº§ç‰ˆæœ¬æ˜¯*v2*ï¼Œå› æ­¤ï¼Œæµ‹è¯•ä¸€äº›å…³é”®è¯ä¼šæ˜¯ä¸ªå¥½ä¸»æ„ï¼Œå¦‚*v1*ã€*v3*ã€*test*ã€*mobile*ã€*uat*ã€*dev*å’Œ*old*ï¼Œä»¥åŠåœ¨åˆ†ææˆ–ä¾¦å¯Ÿæµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°çš„ä»»ä½•æœ‰è¶£è·¯å¾„ã€‚æ­¤å¤–ï¼Œä¸€äº›
    API æä¾›å•†é€šè¿‡åœ¨ç‰ˆæœ¬å·å‰åæ·»åŠ */internal/*ï¼Œå…è®¸è®¿é—®ç®¡ç†åŠŸèƒ½ï¼Œè·¯å¾„å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š
- en: '*/api/v2/****internal****/users*'
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*/api/v2/****internal****/users*'
- en: '*/api/****internal****/v2/users*'
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*/api/****internal****/v2/users*'
- en: As discussed earlier in the section, begin by developing a baseline for how
    the API responds to typical requests using the Collection Runner with the APIâ€™s
    expected version path. Figure out how an API responds to a successful request
    and how it responds to bad ones (or requests for resources that do not exist).
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚å‰æ‰€è¿°ï¼Œé¦–å…ˆä½¿ç”¨ API é¢„æœŸçš„ç‰ˆæœ¬è·¯å¾„ï¼Œé€šè¿‡é›†åˆè¿è¡Œå™¨ï¼ˆCollection Runnerï¼‰å¼€å‘ä¸€ä¸ªåŸºå‡†ï¼Œäº†è§£ API å¯¹å…¸å‹è¯·æ±‚çš„å“åº”ã€‚å¼„æ¸…æ¥š API
    å¦‚ä½•å“åº”æˆåŠŸçš„è¯·æ±‚ä»¥åŠå¦‚ä½•å“åº”é”™è¯¯çš„è¯·æ±‚ï¼ˆæˆ–å¯¹ä¸å­˜åœ¨çš„èµ„æºçš„è¯·æ±‚ï¼‰ã€‚
- en: To make our testing easier, weâ€™ll set up the same test for status codes of 200
    we used earlier in this chapter. If the API provider typically responds with status
    code 404 for nonexistent resources, a 200 response for those resources would likely
    indicate that the API is vulnerable. Make sure to insert this test at the collection
    level so that it will be run on every request when you use the Collection Runner.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†ç®€åŒ–æˆ‘ä»¬çš„æµ‹è¯•ï¼Œæˆ‘ä»¬å°†è®¾ç½®ä¸æœ¬ç« å‰é¢ä½¿ç”¨çš„ç›¸åŒçš„çŠ¶æ€ç ä¸º 200 çš„æµ‹è¯•ã€‚å¦‚æœ API æä¾›å•†é€šå¸¸å¯¹ä¸å­˜åœ¨çš„èµ„æºè¿”å›çŠ¶æ€ç  404ï¼Œé‚£ä¹ˆå¯¹äºè¿™äº›èµ„æºè¿”å›
    200 çŠ¶æ€ç å¾ˆå¯èƒ½è¡¨æ˜è¯¥ API å­˜åœ¨æ¼æ´ã€‚ç¡®ä¿åœ¨é›†åˆçº§åˆ«æ’å…¥æ­¤æµ‹è¯•ï¼Œä»¥ä¾¿åœ¨ä½¿ç”¨é›†åˆè¿è¡Œå™¨æ—¶åœ¨æ¯ä¸ªè¯·æ±‚ä¸Šè¿è¡Œå®ƒã€‚
- en: Now save and run your collection. Inspect the results for any requests that
    pass this test. Once youâ€™ve reviewed the results, rinse and repeat with a new
    keyword. If you discover an improper asset management vulnerability, your next
    step will be to test the non-production endpoint for additional weaknesses. This
    is where your information-gathering skills will be put to good use. On the targetâ€™s
    GitHub or in a changelog, you might discover that the older version of the API
    was vulnerable to a BOLA attack, so you could attempt such an attack on the vulnerable
    endpoint. If you donâ€™t find any leads during reconnaissance, combine the other
    techniques found in this book to leverage the vulnerability.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ä¿å­˜å¹¶è¿è¡Œä½ çš„é›†åˆã€‚æ£€æŸ¥é€šè¿‡æ­¤æµ‹è¯•çš„è¯·æ±‚çš„ç»“æœã€‚æŸ¥çœ‹ç»“æœåï¼Œæ¢ä¸€ä¸ªæ–°å…³é”®å­—ç»§ç»­æµ‹è¯•ã€‚å¦‚æœä½ å‘ç°äº†ä¸å½“çš„èµ„äº§ç®¡ç†æ¼æ´ï¼Œä¸‹ä¸€æ­¥å°†æ˜¯æµ‹è¯•éç”Ÿäº§ç¯å¢ƒç«¯ç‚¹ï¼Œå¯»æ‰¾æ›´å¤šå¼±ç‚¹ã€‚è¿™æ—¶ï¼Œä½ çš„ä¿¡æ¯æ”¶é›†æŠ€å·§å°†æ´¾ä¸Šç”¨åœºã€‚åœ¨ç›®æ ‡çš„GitHubæˆ–æ›´æ–°æ—¥å¿—ä¸­ï¼Œä½ å¯èƒ½ä¼šå‘ç°APIçš„æ—§ç‰ˆæœ¬æ›¾é­å—BOLAæ”»å‡»ï¼Œå› æ­¤ä½ å¯ä»¥å°è¯•å¯¹è¯¥æ¼æ´ç«¯ç‚¹è¿›è¡Œæ”»å‡»ã€‚å¦‚æœåœ¨ä¾¦å¯Ÿè¿‡ç¨‹ä¸­æ²¡æœ‰æ‰¾åˆ°ä»»ä½•çº¿ç´¢ï¼Œå¯ä»¥ç»“åˆæœ¬ä¹¦ä¸­çš„å…¶ä»–æŠ€æœ¯æ¥åˆ©ç”¨æ¼æ´ã€‚
- en: Testing Request Methods with Wfuzz
  id: totrans-133
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä½¿ç”¨Wfuzzæµ‹è¯•è¯·æ±‚æ–¹æ³•
- en: One practical way to use fuzzing is to determine all the HTTP request methods
    available for a given API request. You can use several of the tools weâ€™ve introduced
    to perform this task, but this section will demonstrate it with Wfuzz.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ç§å®é™…ä½¿ç”¨æ¨¡ç³Šæµ‹è¯•çš„æ–¹æ³•æ˜¯ç¡®å®šç»™å®šAPIè¯·æ±‚çš„æ‰€æœ‰å¯ç”¨HTTPè¯·æ±‚æ–¹æ³•ã€‚ä½ å¯ä»¥ä½¿ç”¨æˆ‘ä»¬ä»‹ç»çš„å‡ ç§å·¥å…·æ¥æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ï¼Œä½†è¿™ä¸€èŠ‚å°†ä½¿ç”¨Wfuzzæ¼”ç¤ºå¦‚ä½•è¿›è¡Œã€‚
- en: 'First, capture or craft the API request whose acceptable HTTP methods you would
    like to test. In this example, weâ€™ll use the following:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œæ•è·æˆ–æ„é€ ä½ å¸Œæœ›æµ‹è¯•çš„APIè¯·æ±‚åŠå…¶å¯æ¥å—çš„HTTPæ–¹æ³•ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹è¯·æ±‚ï¼š
- en: '[PRE12]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Next, create your request with Wfuzz, using `-X FUZZ` to specifically fuzz
    the HTTP method. Run Wfuzz and review the results:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: æ¥ä¸‹æ¥ï¼Œä½¿ç”¨Wfuzzåˆ›å»ºè¯·æ±‚ï¼Œä½¿ç”¨`-X FUZZ`æ¥ä¸“é—¨æ¨¡ç³Šæµ‹è¯•HTTPæ–¹æ³•ã€‚è¿è¡ŒWfuzzå¹¶æŸ¥çœ‹ç»“æœï¼š
- en: '[PRE13]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Based on these results, you can see that the baseline response tends to include
    a 405 status code (Method Not Allowed) and a response length of 163 characters.
    The anomalous responses include the two request methods with 200 response codes.
    This confirms that GET and HEAD requests both work, which doesnâ€™t reveal much
    of anything new. However, this test also reveals that you can use a POST request
    to the *api/v2/account* endpoint. If you were testing an API that did not include
    this request method in its documentation, there is a chance you may have discovered
    functionality that was not intended for end users. Undocumented functionality
    is a good find that should be tested for additional vulnerabilities.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®è¿™äº›ç»“æœï¼Œä½ å¯ä»¥çœ‹åˆ°åŸºç¡€å“åº”é€šå¸¸åŒ…æ‹¬405çŠ¶æ€ç ï¼ˆæ–¹æ³•ä¸è¢«å…è®¸ï¼‰å’Œ163ä¸ªå­—ç¬¦çš„å“åº”é•¿åº¦ã€‚å¼‚å¸¸å“åº”åŒ…æ‹¬ä¸¤ä¸ªè¯·æ±‚æ–¹æ³•ï¼Œå®ƒä»¬è¿”å›200çŠ¶æ€ç ã€‚è¿™è¯å®äº†GETå’ŒHEADè¯·æ±‚éƒ½æœ‰æ•ˆï¼Œä½†æ²¡æœ‰é€éœ²ä»€ä¹ˆæ–°çš„ä¿¡æ¯ã€‚ç„¶è€Œï¼Œè¿™ä¸ªæµ‹è¯•ä¹Ÿè¡¨æ˜ï¼Œä½ å¯ä»¥å¯¹*api/v2/account*ç«¯ç‚¹ä½¿ç”¨POSTè¯·æ±‚ã€‚å¦‚æœä½ æ­£åœ¨æµ‹è¯•çš„APIæ–‡æ¡£ä¸­æ²¡æœ‰åŒ…æ‹¬è¿™ç§è¯·æ±‚æ–¹æ³•ï¼Œé‚£ä¹ˆä½ å¯èƒ½å‘ç°äº†ä¸€ä¸ªä¸åº”å¯¹æœ€ç»ˆç”¨æˆ·å¼€æ”¾çš„åŠŸèƒ½ã€‚æœªè®°å½•çš„åŠŸèƒ½æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å‘ç°ï¼Œåº”è¯¥è¿›ä¸€æ­¥æµ‹è¯•æ˜¯å¦å­˜åœ¨å…¶ä»–æ¼æ´ã€‚
- en: Fuzzing â€œDeeperâ€ to Bypass Input Sanitization
  id: totrans-140
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¯¹è¾“å…¥æ¸…æ´—è¿›è¡Œâ€œæ›´æ·±â€æ¨¡ç³Šæµ‹è¯•ä»¥ç»•è¿‡é™åˆ¶
- en: When fuzzing deep, youâ€™ll want to be strategic about setting payload positions.
    For example, for an email field in a PUT request, an API provider may do a pretty
    decent job at requiring that the contents of the request body match the format
    of an email address. In other words, anything sent as a value that isnâ€™t an email
    address might result in the same 400 Bad Request error. Similar restrictions likely
    apply to integer and Boolean values. If youâ€™ve thoroughly tested a field and it
    doesnâ€™t yield any interesting results, you may want to leave it out of additional
    tests or save it for more thorough testing in a separate attack.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿›è¡Œæ·±åº¦æ¨¡ç³Šæµ‹è¯•æ—¶ï¼Œä½ éœ€è¦æœ‰ç­–ç•¥åœ°è®¾ç½®æœ‰æ•ˆè½½è·ä½ç½®ã€‚ä¾‹å¦‚ï¼Œå¯¹äºPUTè¯·æ±‚ä¸­çš„é‚®ç®±å­—æ®µï¼ŒAPIæä¾›è€…å¯èƒ½ä¼šé€šè¿‡è¦æ±‚è¯·æ±‚ä½“çš„å†…å®¹ç¬¦åˆé‚®ç®±åœ°å€çš„æ ¼å¼æ¥åšå¾—ç›¸å½“ä¸é”™ã€‚æ¢å¥è¯è¯´ï¼Œä»»ä½•ä¸æ˜¯é‚®ç®±åœ°å€çš„å€¼å‘é€åˆ°è¯¥å­—æ®µå¯èƒ½ä¼šå¯¼è‡´ç›¸åŒçš„400é”™è¯¯ï¼ˆé”™è¯¯è¯·æ±‚ï¼‰ã€‚ç±»ä¼¼çš„é™åˆ¶å¯èƒ½ä¹Ÿé€‚ç”¨äºæ•´æ•°å’Œå¸ƒå°”å€¼ã€‚å¦‚æœä½ å·²ç»å½»åº•æµ‹è¯•äº†æŸä¸ªå­—æ®µå¹¶ä¸”æ²¡æœ‰å¾—åˆ°ä»»ä½•æœ‰è¶£çš„ç»“æœï¼Œä½ å¯èƒ½ä¼šé€‰æ‹©å°†å…¶æ’é™¤åœ¨åç»­æµ‹è¯•ä¹‹å¤–ï¼Œæˆ–è€…å°†å…¶ä¿ç•™ç”¨äºåœ¨å•ç‹¬çš„æ”»å‡»ä¸­è¿›è¡Œæ›´æ·±å…¥çš„æµ‹è¯•ã€‚
- en: Alternatively, to fuzz even deeper into a specific field, you could try to escape
    whatever restrictions are in place. By *escaping*, I mean tricking the serverâ€™s
    input sanitization code into processing a payload it should normally restrict.
    There are a few tricks you could use against restricted fields.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: å¦å¤–ï¼Œä¸ºäº†å¯¹ç‰¹å®šå­—æ®µè¿›è¡Œæ›´æ·±å±‚æ¬¡çš„æ¨¡ç³Šæµ‹è¯•ï¼Œä½ å¯ä»¥å°è¯•ç»•è¿‡ä»»ä½•å·²æœ‰çš„é™åˆ¶ã€‚æ‰€è°“çš„*ç»•è¿‡*ï¼Œæ˜¯æŒ‡æ¬ºéª—æœåŠ¡å™¨çš„è¾“å…¥æ¸…æ´—ä»£ç ï¼Œä½¿å…¶å¤„ç†åŸæœ¬åº”å½“é™åˆ¶çš„æœ‰æ•ˆè½½è·ã€‚ä½ å¯ä»¥ä½¿ç”¨ä¸€äº›æŠ€å·§æ¥é’ˆå¯¹å—é™å­—æ®µè¿›è¡Œæ”»å‡»ã€‚
- en: 'First, try sending something that takes the form of the restricted field (if
    itâ€™s an email field, include a valid-looking email), add a null byte, and then
    add another payload position for fuzzing payloads to be inserted. Hereâ€™s an example:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œå°è¯•å‘é€ä¸€ä¸ªçœ‹èµ·æ¥åƒæ˜¯å—é™å­—æ®µçš„å†…å®¹ï¼ˆå¦‚æœæ˜¯ç”µå­é‚®ä»¶å­—æ®µï¼ŒåŒ…å«ä¸€ä¸ªçœ‹èµ·æ¥æœ‰æ•ˆçš„ç”µå­é‚®ä»¶ï¼‰ï¼Œç„¶åæ·»åŠ ç©ºå­—èŠ‚ï¼Œå†æ·»åŠ å¦ä¸€ä¸ªæœ‰æ•ˆè½½è·ä½ç½®ï¼Œç”¨äºæ’å…¥æ¨¡ç³Šæµ‹è¯•çš„æœ‰æ•ˆè½½è·ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š
- en: '[PRE14]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Instead of a null byte, try sending a pipe (`|`), quotes, spaces, and other
    escape symbols. Better yet, there are enough possible symbols to send that you
    could add a second payload position for typical escape characters, like this:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸è¦ä½¿ç”¨ç©ºå­—èŠ‚ï¼Œè¯•ç€å‘é€ç®¡é“ç¬¦å·ï¼ˆ`|`ï¼‰ã€å¼•å·ã€ç©ºæ ¼ä»¥åŠå…¶ä»–è½¬ä¹‰ç¬¦å·ã€‚æ›´å¥½çš„æ˜¯ï¼Œæœ‰è¶³å¤Ÿå¤šçš„ç¬¦å·å¯ä»¥å‘é€ï¼Œä½ å¯ä»¥ä¸ºå…¸å‹çš„è½¬ä¹‰å­—ç¬¦æ·»åŠ ç¬¬äºŒä¸ªæœ‰æ•ˆè½½è·ä½ç½®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
- en: '[PRE15]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Use a set of potential escape symbols for the `Â§escapeÂ§`payload and the payload
    you want to execute as the `Â§testÂ§`. To perform this test, use Burp Suiteâ€™s cluster
    bomb attack, which will cycle through multiple payload lists and attempt every
    other payload against it:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ä¸€ç»„æ½œåœ¨çš„è½¬ä¹‰ç¬¦å·ä½œä¸º `Â§escapeÂ§` æœ‰æ•ˆè½½è·ï¼Œä»¥åŠä½ å¸Œæœ›æ‰§è¡Œçš„ `Â§testÂ§` æœ‰æ•ˆè½½è·ã€‚è¿›è¡Œæ­¤æµ‹è¯•æ—¶ï¼Œä½¿ç”¨ Burp Suite çš„é›†ç¾¤ç‚¸å¼¹æ”»å‡»ï¼Œå®ƒä¼šå¾ªç¯é€šè¿‡å¤šä¸ªæœ‰æ•ˆè½½è·åˆ—è¡¨ï¼Œå¹¶å¯¹æ¯ä¸ªæœ‰æ•ˆè½½è·è¿›è¡Œå°è¯•ï¼š
- en: Escape1
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Escape1
- en: Escape1
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Escape1
- en: Escape1
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Escape1
- en: Escape2
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Escape2
- en: Escape2
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Escape2
- en: Escape2
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Escape2
- en: Payload1
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Payload1
- en: Payload2
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Payload2
- en: Payload3
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Payload3
- en: Payload1
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Payload1
- en: Payload2
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Payload2
- en: Payload3
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Payload3
- en: The cluster bomb fuzzing attack is excellent at exhausting certain combinations
    of payloads, but be aware that the request quantity will grow exponentially. We
    will spend more time with the style of fuzzing when we are attempting injection
    attacks in Chapter 12.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: é›†ç¾¤ç‚¸å¼¹æ¨¡ç³Šæµ‹è¯•æ”»å‡»éå¸¸æ“…é•¿è€—å°½æŸäº›æœ‰æ•ˆè½½è·ç»„åˆï¼Œä½†è¦æ³¨æ„ï¼Œè¯·æ±‚æ•°é‡å°†å‘ˆæŒ‡æ•°å¢é•¿ã€‚å½“æˆ‘ä»¬åœ¨ç¬¬ 12 ç« å°è¯•æ³¨å…¥æ”»å‡»æ—¶ï¼Œæˆ‘ä»¬ä¼šèŠ±æ›´å¤šæ—¶é—´è®²è§£è¿™ç§æ¨¡ç³Šæµ‹è¯•é£æ ¼ã€‚
- en: Fuzzing for Directory Traversal
  id: totrans-161
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç›®å½•éå†æ¨¡ç³Šæµ‹è¯•
- en: 'Another weakness you can fuzz for is directory traversal. Also known as path
    traversal, *directory traversal* is a vulnerability that allows an attacker to
    direct the web application to move to a parent directory using some form of the
    expression `../` and then read arbitrary files. You could leverage a series of
    path traversal dots and slashes in place of the escape symbols described in the
    previous section, like the following ones:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: å¦ä¸€ä¸ªå¯ä»¥è¿›è¡Œæ¨¡ç³Šæµ‹è¯•çš„å¼±ç‚¹æ˜¯ç›®å½•éå†ã€‚ç›®å½•éå†ï¼Œä¹Ÿç§°ä¸ºè·¯å¾„éå†ï¼Œ*ç›®å½•éå†* æ˜¯ä¸€ç§æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒè®© Web åº”ç”¨ç¨‹åºé€šè¿‡æŸç§å½¢å¼çš„ `../`
    è¡¨è¾¾å¼è½¬åˆ°çˆ¶ç›®å½•ï¼Œç„¶åè¯»å–ä»»æ„æ–‡ä»¶ã€‚ä½ å¯ä»¥åˆ©ç”¨ä¸€ç³»åˆ—è·¯å¾„éå†çš„ç‚¹å’Œæ–œæ æ¥ä»£æ›¿å‰ä¸€èŠ‚ä¸­æè¿°çš„è½¬ä¹‰ç¬¦å·ï¼Œä¾‹å¦‚ä»¥ä¸‹è¿™äº›ï¼š
- en: '`..`'
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`..`'
- en: '`..\`'
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`..\`'
- en: '`../`'
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`../`'
- en: '`\..\`'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`\..\`'
- en: '`\..\.\`'
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`\..\.\`'
- en: This weakness has been around for many years, and all sorts of security controls,
    including user input sanitization, are normally in place to prevent it, but with
    the right payload, you might be able to avoid these controls and web application
    firewalls. If youâ€™re able to exit the API path, you may be able to access sensitive
    information such as application logic, usernames, passwords, and additional personally
    identifiable information (like names, phone numbers, emails, and addresses).
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ç§å¼±ç‚¹å·²ç»å­˜åœ¨å¤šå¹´ï¼Œé€šå¸¸ä¼šé‡‡å–å„ç§å®‰å…¨æ§åˆ¶æªæ–½ï¼ŒåŒ…æ‹¬ç”¨æˆ·è¾“å…¥å‡€åŒ–ï¼Œä»¥é˜²æ­¢æ­¤ç±»é—®é¢˜çš„å‘ç”Ÿï¼Œä½†å¦‚æœä½¿ç”¨åˆé€‚çš„æœ‰æ•ˆè½½è·ï¼Œä½ å¯èƒ½èƒ½å¤Ÿç»•è¿‡è¿™äº›æ§åˆ¶æªæ–½å’Œ Web
    åº”ç”¨é˜²ç«å¢™ã€‚å¦‚æœä½ èƒ½å¤Ÿé€€å‡º API è·¯å¾„ï¼Œå¯èƒ½å°±èƒ½è®¿é—®åˆ°æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚åº”ç”¨é€»è¾‘ã€ç”¨æˆ·åã€å¯†ç ä»¥åŠé¢å¤–çš„ä¸ªäººèº«ä»½ä¿¡æ¯ï¼ˆå¦‚å§“åã€ç”µè¯å·ç ã€ç”µå­é‚®ä»¶å’Œåœ°å€ï¼‰ã€‚
- en: Directory traversal can be conducted using both wide and deep fuzzing techniques.
    Ideally, you would fuzz deeply across all of an APIâ€™s requests, but since this
    can be an enormous task, try fuzzing wide and then focusing in on specific request
    values. Make sure to enrich your payloads with information collected from reconnaissance,
    endpoint analysis, and API responses containing errors or other information disclosures.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: ç›®å½•éå†å¯ä»¥ä½¿ç”¨å¹¿åº¦å’Œæ·±åº¦æ¨¡ç³Šæµ‹è¯•æŠ€æœ¯è¿›è¡Œã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œä½ ä¼šå¯¹æ•´ä¸ª API çš„æ‰€æœ‰è¯·æ±‚è¿›è¡Œæ·±åº¦æ¨¡ç³Šæµ‹è¯•ï¼Œä½†ç”±äºè¿™å¯èƒ½æ˜¯ä¸€é¡¹åºå¤§çš„ä»»åŠ¡ï¼Œå› æ­¤å¯ä»¥å…ˆè¿›è¡Œå¹¿åº¦æ¨¡ç³Šæµ‹è¯•ï¼Œç„¶åå†ä¸“æ³¨äºç‰¹å®šçš„è¯·æ±‚å€¼ã€‚ç¡®ä¿åˆ©ç”¨ä»ä¾¦å¯Ÿã€ç«¯ç‚¹åˆ†æå’ŒåŒ…å«é”™è¯¯æˆ–å…¶ä»–ä¿¡æ¯æŠ«éœ²çš„
    API å“åº”ä¸­æ”¶é›†çš„ä¿¡æ¯æ¥ä¸°å¯Œä½ çš„æœ‰æ•ˆè½½è·ã€‚
- en: Summary
  id: totrans-170
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ€»ç»“
- en: This chapter covered the art of fuzzing APIs, one of the most important attack
    techniques youâ€™ll need to master. By sending the right inputs to the right parts
    of an API request, you can discover a variety of API weaknesses. We covered two
    strategies, fuzzing wide and deep, useful for testing the entire attack surface
    of large APIs. In the following chapters, weâ€™ll return to the fuzzing deep technique
    to discover and attack many API vulnerabilities.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬ç« ä»‹ç»äº†æ¨¡ç³Šæµ‹è¯• API çš„æŠ€æœ¯ï¼Œè¿™æ˜¯ä½ éœ€è¦æŒæ¡çš„æœ€é‡è¦çš„æ”»å‡»æŠ€æœ¯ä¹‹ä¸€ã€‚é€šè¿‡å‘ API è¯·æ±‚çš„æ­£ç¡®éƒ¨åˆ†å‘é€æ­£ç¡®çš„è¾“å…¥ï¼Œä½ å¯ä»¥å‘ç°å„ç§ API å¼±ç‚¹ã€‚æˆ‘ä»¬è®¨è®ºäº†ä¸¤ç§ç­–ç•¥ï¼šå¹¿åº¦æ¨¡ç³Šæµ‹è¯•å’Œæ·±åº¦æ¨¡ç³Šæµ‹è¯•ï¼Œå®ƒä»¬æœ‰åŠ©äºæµ‹è¯•å¤§å‹
    API çš„æ•´ä¸ªæ”»å‡»é¢ã€‚åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å›åˆ°æ·±åº¦æ¨¡ç³Šæµ‹è¯•æŠ€å·§ï¼Œå‘ç°å¹¶æ”»å‡»æ›´å¤šçš„ API æ¼æ´ã€‚
- en: 'Lab #6: Fuzzing for Improper Assets Management Vulnerabilities'
  id: totrans-172
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 'å®éªŒ #6ï¼šæ¨¡ç³Šæµ‹è¯•ä¸å½“èµ„äº§ç®¡ç†æ¼æ´'
- en: In this lab, youâ€™ll put your fuzzing skills to the test against crAPI. If you
    havenâ€™t done so already, build a crAPI Postman collection, as we did in Chapter
    7, and obtain a valid token. Now we can start by fuzzing wide and then pivot to
    fuzzing deep based on our findings.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æœ¬å®éªŒä¸­ï¼Œä½ å°†é’ˆå¯¹ crAPI æµ‹è¯•ä½ çš„æ¨¡ç³Šæµ‹è¯•æŠ€èƒ½ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰è¿™ä¹ˆåšï¼Œè¯·æŒ‰ç…§ç¬¬ä¸ƒç« çš„æ­¥éª¤æ„å»ºä¸€ä¸ª crAPI Postman é›†åˆï¼Œå¹¶è·å–ä¸€ä¸ªæœ‰æ•ˆçš„ä»¤ç‰Œã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹è¿›è¡Œå¹¿æ³›çš„æ¨¡ç³Šæµ‹è¯•ï¼Œç„¶åæ ¹æ®æˆ‘ä»¬çš„å‘ç°è½¬å‘æ·±åº¦æ¨¡ç³Šæµ‹è¯•ã€‚
- en: Letâ€™s begin by fuzzing for improper assets management vulnerabilities. First,
    weâ€™ll use Postman to fuzz wide for various API versions. Open Postman and navigate
    to the environmental variables (use the eye icon located at the top right of Postman
    as a shortcut). Add a variable named `path` to your Postman environment and set
    the value to *v3*. Now you can update to test for various versioning-related paths
    (such as *v1*, *v2, internal*, and so on).
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å¼€å§‹è¿›è¡Œä¸å½“èµ„äº§ç®¡ç†æ¼æ´çš„æ¨¡ç³Šæµ‹è¯•ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Postman å¯¹ä¸åŒçš„ API ç‰ˆæœ¬è¿›è¡Œå¹¿æ³›çš„æ¨¡ç³Šæµ‹è¯•ã€‚æ‰“å¼€ Postmanï¼Œå¯¼èˆªåˆ°ç¯å¢ƒå˜é‡ï¼ˆä½¿ç”¨ä½äº
    Postman å³ä¸Šè§’çš„çœ¼ç›å›¾æ ‡ä½œä¸ºå¿«æ·æ–¹å¼ï¼‰ã€‚å‘ Postman ç¯å¢ƒæ·»åŠ ä¸€ä¸ªåä¸º `path` çš„å˜é‡ï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸º *v3*ã€‚ç°åœ¨ï¼Œä½ å¯ä»¥æ›´æ–°å¹¶æµ‹è¯•ä¸ç‰ˆæœ¬ç›¸å…³çš„è·¯å¾„ï¼ˆå¦‚
    *v1*ã€*v2*ã€*internal* ç­‰ï¼‰ã€‚
- en: 'To get better results from the Postman Collection Runner, weâ€™ll configure a
    test using the Collection Editor. Select the crAPI collection options, choose
    **Edit**, and select the **Tests** tab. Add a test that will detect when a status
    code 404 is returned so that anything that does not result in a 404 Not Found
    response will stick out as anomalous. You can use the following test:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†ä» Postman Collection Runner ä¸­è·å¾—æ›´å¥½çš„ç»“æœï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Collection Editor é…ç½®ä¸€ä¸ªæµ‹è¯•ã€‚é€‰æ‹© crAPI
    é›†åˆé€‰é¡¹ï¼Œç‚¹å‡» **ç¼–è¾‘**ï¼Œç„¶åé€‰æ‹© **æµ‹è¯•** æ ‡ç­¾ã€‚æ·»åŠ ä¸€ä¸ªæ£€æµ‹çŠ¶æ€ç  404 è¿”å›çš„æµ‹è¯•ï¼Œè¿™æ ·ä»»ä½•ä¸è¿”å› 404 Not Found å“åº”çš„å†…å®¹éƒ½ä¼šè¢«è§†ä¸ºå¼‚å¸¸ã€‚ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æµ‹è¯•ï¼š
- en: '[PRE16]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Run a baseline scan of the crAPI collection with the Collection Runner. First,
    make sure that your environment is up-to-date and **Save Responses** is checked
    (see [Figure 9-9](#figure9-9)).
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ Collection Runner å¯¹ crAPI é›†åˆè¿›è¡ŒåŸºçº¿æ‰«æã€‚é¦–å…ˆï¼Œç¡®ä¿ä½ çš„ç¯å¢ƒæ˜¯æœ€æ–°çš„ï¼Œå¹¶ä¸” **ä¿å­˜å“åº”** å·²å‹¾é€‰ï¼ˆå‚è§ [å›¾ 9-9](#figure9-9)ï¼‰ã€‚
- en: '![screenshot of postmanâ€™s collection runner window that shows save responses
    as checked](image_fi/502444c09/F09009.png)'
  id: totrans-178
  prefs: []
  type: TYPE_IMG
  zh: '![Postman é›†åˆè¿è¡Œå™¨çª—å£æˆªå›¾ï¼Œæ˜¾ç¤ºä¿å­˜å“åº”å·²é€‰ä¸­](image_fi/502444c09/F09009.png)'
- en: 'Figure 9-9: Postman Collection Runner'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 9-9ï¼šPostman é›†åˆè¿è¡Œå™¨
- en: Since weâ€™re on the hunt for improper assets management vulnerabilities, weâ€™ll
    only test API requests that contain versioning information in the path. Using
    Postmanâ€™s Find and Replace feature, replace the values *v2* and *v3* across the
    collection with the `path` variable (see [Figure 9-10](#figure9-10)).
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºæˆ‘ä»¬æ­£åœ¨å¯»æ‰¾ä¸å½“çš„èµ„äº§ç®¡ç†æ¼æ´ï¼Œæˆ‘ä»¬å°†ä»…æµ‹è¯•è·¯å¾„ä¸­åŒ…å«ç‰ˆæœ¬ä¿¡æ¯çš„ API è¯·æ±‚ã€‚ä½¿ç”¨ Postman çš„æŸ¥æ‰¾å’Œæ›¿æ¢åŠŸèƒ½ï¼Œå°†é›†åˆä¸­çš„ *v2* å’Œ *v3*
    æ›¿æ¢ä¸º `path` å˜é‡ï¼ˆå‚è§ [å›¾ 9-10](#figure9-10)ï¼‰ã€‚
- en: '![screenshot of postmanâ€™s find and replace window that shows v2 in the find
    box and {{path}} in the replace box](image_fi/502444c09/F09010.png)'
  id: totrans-181
  prefs: []
  type: TYPE_IMG
  zh: '![Postman æŸ¥æ‰¾å’Œæ›¿æ¢çª—å£æˆªå›¾ï¼Œæ˜¾ç¤ºæŸ¥æ‰¾æ¡†ä¸­çš„ v2 å’Œæ›¿æ¢æ¡†ä¸­çš„ {{path}}](image_fi/502444c09/F09010.png)'
- en: 'Figure 9-10: Replacing version information in the path with a Postman variable'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ 9-10ï¼šç”¨ Postman å˜é‡æ›¿æ¢è·¯å¾„ä¸­çš„ç‰ˆæœ¬ä¿¡æ¯
- en: 'You may have noticed a matter of interest regarding our collection: all of
    the endpoints have *v2* in their paths except for the password reset endpoint,
    */identity/api/auth/v3/check-otp*, which is using *v3*.'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°æˆ‘ä»¬é›†åˆä¸­çš„ä¸€ä¸ªæœ‰è¶£äº‹é¡¹ï¼šé™¤äº†å¯†ç é‡ç½®ç«¯ç‚¹ */identity/api/auth/v3/check-otp* ä½¿ç”¨ *v3*ï¼Œæ‰€æœ‰å…¶ä»–ç«¯ç‚¹çš„è·¯å¾„ä¸­éƒ½åŒ…å«
    *v2*ã€‚
- en: Now that the variable is set, run a baseline scan with a path that we expect
    to fail across the board. As shown in [Figure 9-11](#figure9-11), the `path` variable
    is set to a current value of `fail12345`, which is not likely to be a valid value
    in any endpoint. Knowing how the API reacts when it fails will help us understand
    how the API responds to requests for nonexistent paths. This baseline will aid
    our attempts to fuzz wide with the Collection Runner (see [Figure 9-12](#figure9-12)).
    If requests to paths that do not exist result in Success 200 responses, weâ€™ll
    have to look out for other indicators to use to detect anomalies.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: å˜é‡è®¾ç½®å¥½åï¼Œä½¿ç”¨æˆ‘ä»¬é¢„è®¡åœ¨æ‰€æœ‰ç«¯ç‚¹ä¸­éƒ½ä¼šå¤±è´¥çš„è·¯å¾„è¿è¡ŒåŸºçº¿æ‰«æã€‚å¦‚ [å›¾ 9-11](#figure9-11) æ‰€ç¤ºï¼Œ`path` å˜é‡çš„å½“å‰å€¼è®¾ç½®ä¸º
    `fail12345`ï¼Œè¿™ä¸ªå€¼åœ¨ä»»ä½•ç«¯ç‚¹ä¸­éƒ½ä¸å¤ªå¯èƒ½æœ‰æ•ˆã€‚äº†è§£ API åœ¨å¤±è´¥æ—¶çš„ååº”å°†å¸®åŠ©æˆ‘ä»¬ç†è§£ API å¯¹ä¸å­˜åœ¨è·¯å¾„çš„è¯·æ±‚çš„å“åº”æ–¹å¼ã€‚è¿™ä¸€åŸºçº¿å°†æœ‰åŠ©äºæˆ‘ä»¬ä½¿ç”¨
    Collection Runner è¿›è¡Œå¹¿æ³›æ¨¡ç³Šæµ‹è¯•ï¼ˆå‚è§ [å›¾ 9-12](#figure9-12)ï¼‰ã€‚å¦‚æœè¯·æ±‚ä¸å­˜åœ¨çš„è·¯å¾„æ—¶è¿”å›æˆåŠŸçš„ 200 å“åº”ï¼Œæˆ‘ä»¬å°±éœ€è¦æ³¨æ„å…¶ä»–æŒ‡æ ‡ï¼Œä»¥å¸®åŠ©æ£€æµ‹å¼‚å¸¸ã€‚
- en: '![screenshot of postmanâ€™s manage environments window that shows the variable
    as path, the initial value as v2, and the current value as fail12345](image_fi/502444c09/F09011.png)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
  zh: '![Postmançš„ç¯å¢ƒç®¡ç†çª—å£æˆªå›¾ï¼Œæ˜¾ç¤ºå˜é‡ä¸ºpathï¼Œåˆå§‹å€¼ä¸ºv2ï¼Œå½“å‰å€¼ä¸ºfail12345](image_fi/502444c09/F09011.png)'
- en: 'Figure 9-11: The improper assets management variable'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾9-11ï¼šä¸å½“çš„èµ„äº§ç®¡ç†æ¼æ´
- en: '![screenshot of postmanâ€™s collection runner test that shows all nine requests
    have failed](image_fi/502444c09/F09012.png)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![Postmançš„Collection Runneræµ‹è¯•æˆªå›¾ï¼Œæ˜¾ç¤ºæ‰€æœ‰ä¹ä¸ªè¯·æ±‚éƒ½å¤±è´¥äº†](image_fi/502444c09/F09012.png)'
- en: 'Figure 9-12: A baseline Postman Collection Runner test'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾9-12ï¼šä¸€ä¸ªåŸºç¡€çš„Postman Collection Runneræµ‹è¯•
- en: As expected, [Figure 9-12](#figure9-12) shows that all nine requests failed
    the test, as the API provider returned a status code 404\. Now we can easily spot
    anomalies when testing for paths such as *test*, *mobile*, *uat*, *v1*, *v2*,
    and *v3*. Update the current value of the `path` variable to these other potentially
    unsupported paths and run the Collection Runner again. To quickly update a variable,
    click the eye icon found at the top right of Postman.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚é¢„æœŸçš„é‚£æ ·ï¼Œ[å›¾9-12](#figure9-12)æ˜¾ç¤ºæ‰€æœ‰ä¹ä¸ªè¯·æ±‚éƒ½å¤±è´¥äº†ï¼Œå› ä¸ºAPIæä¾›è€…è¿”å›äº†404çŠ¶æ€ç ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å‘ç°æµ‹è¯•è·¯å¾„æ—¶çš„å¼‚å¸¸ï¼Œæ¯”å¦‚*test*ã€*mobile*ã€*uat*ã€*v1*ã€*v2*å’Œ*v3*ã€‚å°†`path`å˜é‡çš„å½“å‰å€¼æ›´æ–°ä¸ºè¿™äº›å…¶ä»–å¯èƒ½ä¸å—æ”¯æŒçš„è·¯å¾„ï¼Œç„¶åå†æ¬¡è¿è¡ŒCollection
    Runnerã€‚è¦å¿«é€Ÿæ›´æ–°å˜é‡ï¼Œè¯·ç‚¹å‡»Postmanå³ä¸Šè§’çš„çœ¼ç›å›¾æ ‡ã€‚
- en: Things should start to get interesting when you return to the path values */v2*
    and */v3*. When the `path` variable is set to */v3*, all requests fail the test.
    This is slightly odd, because we noted earlier that the password reset request
    was using */v3*. Why is that request failing now? Well, based on the Collection
    Runner, the password reset request is actually receiving a 500 Internal Server
    Error, while all other requests are receiving a 404 Not Found status code. Anomaly!
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ä½ è¿”å›åˆ°è·¯å¾„å€¼*/v2*å’Œ*/v3*æ—¶ï¼Œäº‹æƒ…åº”è¯¥å¼€å§‹å˜å¾—æœ‰è¶£ã€‚å½“`path`å˜é‡è®¾ç½®ä¸º*/v3*æ—¶ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½ä¼šå¤±è´¥ã€‚è¿™æœ‰ç‚¹å¥‡æ€ªï¼Œå› ä¸ºæˆ‘ä»¬ä¹‹å‰æåˆ°è¿‡å¯†ç é‡ç½®è¯·æ±‚æ˜¯ä½¿ç”¨*/v3*è·¯å¾„çš„ã€‚ä¸ºä»€ä¹ˆè¿™ä¸ªè¯·æ±‚ç°åœ¨å¤±è´¥äº†å‘¢ï¼Ÿæ ¹æ®Collection
    Runnerï¼Œå¯†ç é‡ç½®è¯·æ±‚å®é™…ä¸Šæ”¶åˆ°äº†ä¸€ä¸ª500å†…éƒ¨æœåŠ¡å™¨é”™è¯¯ï¼Œè€Œæ‰€æœ‰å…¶ä»–è¯·æ±‚éƒ½æ”¶åˆ°äº†404æœªæ‰¾åˆ°çŠ¶æ€ç ã€‚å¼‚å¸¸ï¼
- en: Investigating the password reset request further will show that an HTTP 500
    error is issued using the */v3* path because the application has a control that
    limits the number of times you can attempt to send the one-time passcode (OTP).
    Sending the same request to */v2* also results in an HTTP 500 error, but the response
    is slightly larger. It may be worth retrying the two requests back in Burp Suite
    and using Comparer to see the small differences. The */v3* password reset request
    responds with `{"message":"ERROR..","status":500}`. The */v2* password reset request
    responds with `{"message":"Invalid OTP! Please try again..","status":500}`.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: è¿›ä¸€æ­¥è°ƒæŸ¥å¯†ç é‡ç½®è¯·æ±‚ä¼šå‘ç°ï¼Œä½¿ç”¨*/v3*è·¯å¾„æ—¶å‘å‡ºäº†HTTP 500é”™è¯¯ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºæœ‰ä¸€ä¸ªé™åˆ¶ï¼Œé™åˆ¶äº†ä½ å°è¯•å‘é€ä¸€æ¬¡æ€§éªŒè¯ç ï¼ˆOTPï¼‰çš„æ¬¡æ•°ã€‚å°†ç›¸åŒçš„è¯·æ±‚å‘é€åˆ°*/v2*ä¹Ÿä¼šå¯¼è‡´HTTP
    500é”™è¯¯ï¼Œä½†å“åº”ç¨å¾®å¤§ä¸€äº›ã€‚ä¹Ÿè®¸å¯ä»¥å°è¯•åœ¨Burp Suiteä¸­é‡æ–°å‘é€è¿™ä¸¤ä¸ªè¯·æ±‚ï¼Œå¹¶ä½¿ç”¨CompareræŸ¥çœ‹å…¶ä¸­çš„ç»†å¾®å·®å¼‚ã€‚*/v3*å¯†ç é‡ç½®è¯·æ±‚å“åº”ä¸º`{"message":"ERROR..","status":500}`ã€‚*/v2*å¯†ç é‡ç½®è¯·æ±‚å“åº”ä¸º`{"message":"Invalid
    OTP! Please try again..","status":500}`ã€‚
- en: 'The password reset request does not align with the baseline we have developed
    by responding with a 404 status code when a URL path is not in use. Instead, we
    have discovered an improper assets management vulnerability! The impact of this
    vulnerability is that */v2* does not have a limitation on the number of times
    we can guess the OTP. With a four-digit OTP, we should be able to fuzz deep and
    discover any OTP within 10,000 requests. Eventually, youâ€™ll receive a message
    indicating your victory: `{"message":"OTP verified","status":200}`.'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: å¯†ç é‡ç½®è¯·æ±‚å¹¶æœªæŒ‰ç…§æˆ‘ä»¬å¼€å‘çš„åŸºå‡†æ¥å“åº”ï¼Œå½“URLè·¯å¾„æœªä½¿ç”¨æ—¶ï¼Œåº”è¯¥è¿”å›404çŠ¶æ€ç ã€‚ç›¸åï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªä¸å½“çš„èµ„äº§ç®¡ç†æ¼æ´ï¼è¿™ä¸ªæ¼æ´çš„å½±å“æ˜¯*/v2*è·¯å¾„æ²¡æœ‰é™åˆ¶æˆ‘ä»¬çŒœæµ‹OTPçš„æ¬¡æ•°ã€‚ä½¿ç”¨å››ä½æ•°çš„OTPï¼Œæˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿé€šè¿‡æ¨¡ç³Šæµ‹è¯•æ·±å…¥å¹¶åœ¨10,000ä¸ªè¯·æ±‚å†…å‘ç°ä»»ä½•OTPã€‚æœ€ç»ˆï¼Œä½ ä¼šæ”¶åˆ°ä¸€æ¡è¡¨æ˜ä½ æˆåŠŸçš„æ¶ˆæ¯ï¼š`{"message":"OTP
    verified","status":200}`ã€‚
