- en: Chapter 8. Cisco ASA, IDS/IPS, and IOS-XRv
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 8 章。Cisco ASA、IDS/IPS 和 IOS-XRv
- en: You’ve already seen some of the ways GNS3 can interact with other software and
    operating systems. In this chapter, you’ll delve deeper into the advanced features
    of GNS3 and explore how you can expand your projects by interacting with additional
    Quick Emulator (QEMU) virtual devices and software.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 你已经看到了一些 GNS3 如何与其他软件和操作系统交互的方法。在本章中，你将深入了解 GNS3 的高级功能，并探索如何通过与额外的 Quick Emulator（QEMU）虚拟设备和软件进行交互来扩展你的项目。
- en: Knowing about technologies such as Cisco’s ASAs, Intrusion Detection Systems/Intrusion
    Prevention Systems (IDSs/IPSs), and IOS-XR broadens your view of Cisco and GNS3
    and can be useful when choosing a network certification path. Plus, it’s a lot
    of fun to play with virtualized Cisco products that are otherwise inaccessible
    to most people. It’s also important to learn how to use some of Cisco’s GUI-based
    tools.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 了解像 Cisco 的 ASA、入侵检测系统/入侵防御系统（IDS/IPS）和 IOS-XR 这样的技术，可以拓宽你对 Cisco 和 GNS3 的视野，并在选择网络认证路径时有所帮助。此外，操作虚拟化的
    Cisco 产品也很有趣，而这些产品通常是大多数人无法接触到的。学习如何使用一些 Cisco 的基于图形界面的工具也是非常重要的。
- en: I’ll begin by showing you how to install Cisco Configuration Professional (CCP)
    software, a web-based alternative to configuring routers via the Cisco command
    line interface. Next, you’ll learn how to configure and run an ASA. I’ll discuss
    using Cisco’s Adaptive Security Device Manager (ASDM) software, which is similar
    to the CCP software mentioned earlier but used to configure ASAs. By the end of
    the chapter, you’ll learn that patience is not only a virtue but a prerequisite
    when you set up a Cisco IDS/IPS. Finally, I’ll show you how to configure and use
    Cisco IOS-XRv devices in GNS3.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 我将首先向你展示如何安装 Cisco 配置专业版（CCP）软件，这是一个基于 Web 的配置路由器的替代方法，替代了使用 Cisco 命令行接口的传统方式。接下来，你将学习如何配置和运行
    ASA。我还会讨论如何使用 Cisco 的自适应安全设备管理器（ASDM）软件，这与前面提到的 CCP 软件类似，但用于配置 ASA。到本章结束时，你将了解到，耐心不仅是一种美德，更是设置
    Cisco IDS/IPS 时的必要条件。最后，我将向你展示如何在 GNS3 中配置和使用 Cisco IOS-XRv 设备。
- en: Cisco Configuration Professional
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Cisco 配置专业版
- en: Most engineers use IOS commands to configure routers and switches, but there
    are other ways. CCP is a web-based alternative that uses “smart wizards” to simplify
    router configuration, and it provides tools to help you monitor and troubleshoot
    networks and VPNs. In a nutshell, CCP allows less experienced users to get their
    equipment up and running.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数工程师使用 IOS 命令来配置路由器和交换机，但也有其他方法。CCP 是一种基于 Web 的替代方案，它使用“智能向导”来简化路由器配置，并提供工具帮助你监控和排查网络和
    VPN 的故障。简而言之，CCP 允许经验较少的用户让他们的设备快速启动并运行。
- en: Project Configuration
  id: totrans-6
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 项目配置
- en: To use CCP with GNS3, you’ll create a simple project using one router and a
    VirtualBox virtual machine running Microsoft Windows, as in [Figure 8-1](ch08.html#ccp_topology_with_a_router_and_windows_h
    "Figure 8-1. CCP topology with a router and Windows host"). Although there are
    other methods to do this, I’ve chosen to demonstrate this method because it should
    work on any PC that’s running GNS3 (Windows, Linux, and OS X).
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 要在 GNS3 中使用 CCP，你需要创建一个简单的项目，使用一台路由器和一台运行 Microsoft Windows 的 VirtualBox 虚拟机，如[图
    8-1](ch08.html#ccp_topology_with_a_router_and_windows_h "图 8-1. 使用路由器和 Windows
    主机的 CCP 拓扑")所示。虽然有其他方法可以实现这一点，但我选择演示这种方法，因为它应该适用于任何运行 GNS3 的 PC（Windows、Linux
    和 OS X）。
- en: '![CCP topology with a router and Windows host](httpatomoreillycomsourcenostarchimages2209059.png.jpg)'
  id: totrans-8
  prefs: []
  type: TYPE_IMG
  zh: '![使用路由器和 Windows 主机的 CCP 拓扑](httpatomoreillycomsourcenostarchimages2209059.png.jpg)'
- en: Figure 8-1. CCP topology with a router and Windows host
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-1。使用路由器和 Windows 主机的 CCP 拓扑
- en: Log on to the Windows computer and disable the firewall to ensure that CCP has
    unrestricted communication with your router. (This isn’t mandatory, but it may
    prevent headaches later.) Assign the Windows guest an IP address on the same subnet
    as your router (in this example, 10.10.10.100).
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 登录到 Windows 计算机并禁用防火墙，以确保 CCP 可以与路由器进行无障碍通信。（这不是强制性的，但可能会避免后续的麻烦。）为 Windows
    客户机分配一个与路由器在同一子网中的 IP 地址（在此示例中为 10.10.10.100）。
- en: Next, create a basic configuration on your router.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，在你的路由器上创建一个基本配置。
- en: '[PRE0]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: You need to enable the router’s web server ➊, create a user with full EXEC mode
    privileges ➋, and assign an IP address to the interface ➌. In this example, the
    router is assigned IP address 10.10.10.1.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要启用路由器的 Web 服务器 ➊，创建一个具有完全 EXEC 模式权限的用户 ➋，并为接口分配一个 IP 地址 ➌。在这个示例中，路由器被分配了
    IP 地址 10.10.10.1。
- en: Note
  id: totrans-14
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*You have to create a Cisco admin account with full EXEC mode privileges (privilege
    15) so that later you’ll have sufficient rights to configure the router using
    CCP.*'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '*你必须创建一个具有完全 EXEC 模式权限（权限 15）的 Cisco 管理员账户，以便后续使用 CCP 配置路由器时拥有足够的权限。*'
- en: After configuring the router, test connectivity between the Windows guest and
    the router using a `ping` command.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 配置完路由器后，使用 `ping` 命令测试 Windows 客户机与路由器之间的连接。
- en: '[PRE1]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: If you can successfully ping the router, then it’s safe to proceed. If you cannot
    ping the router, check your IP addresses and interfaces.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你能成功 ping 通路由器，那么可以安全地继续。如果无法 ping 通路由器，请检查你的 IP 地址和接口设置。
- en: CCP Installation
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CCP 安装
- en: CCP is a Java-based application that interacts with a web browser, so before
    you begin, download and install Java if you don’t have it already (*[http://www.java.com/](http://www.java.com/)*).
    Make sure you also have the latest version of Adobe Flash Player (*[http://www.adobe.com/](http://www.adobe.com/)*).
    You can download Cisco Configuration Professional from the Cisco website (*[http://www.cisco.com/](http://www.cisco.com/)*).
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: CCP 是一个基于 Java 的应用程序，它与 Web 浏览器交互，因此在开始之前，如果你尚未安装 Java，请先下载并安装 Java（* [http://www.java.com/](http://www.java.com/)*）。确保你也安装了最新版本的
    Adobe Flash Player（* [http://www.adobe.com/](http://www.adobe.com/)*）。你可以从 Cisco
    网站（* [http://www.cisco.com/](http://www.cisco.com/)*）下载 Cisco 配置专业版。
- en: To install CCP, log on to your Windows virtual machine and launch the setup
    program; you should see the CCP installation wizard. Click **Next** and follow
    the instructions to complete the setup.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装 CCP，登录到你的 Windows 虚拟机并启动安装程序；你应该能看到 CCP 安装向导。点击**下一步**并按照提示完成安装。
- en: Running CCP
  id: totrans-22
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 运行 CCP
- en: Launch Cisco Configuration Professional by right-clicking the program icon and
    choosing **Run as Administrator**. When the program opens, you’ll be asked for
    the IP address of a router you want to manage. You should see the CCP Device Manager,
    shown in [Figure 8-2](ch08.html#ccp_device_manager "Figure 8-2. CCP Device Manager").
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 通过右键点击程序图标并选择**以管理员身份运行**，启动 Cisco 配置专业版。当程序打开后，系统会要求输入你想要管理的路由器的 IP 地址。你应该能看到
    CCP 设备管理器，如[图 8-2](ch08.html#ccp_device_manager "图 8-2. CCP 设备管理器")所示。
- en: '![CCP Device Manager](httpatomoreillycomsourcenostarchimages2209061.png.jpg)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![CCP 设备管理器](httpatomoreillycomsourcenostarchimages2209061.png.jpg)'
- en: Figure 8-2. CCP Device Manager
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-2. CCP 设备管理器
- en: Enter the IP address you assigned to the router (**10.10.10.1**), enter the
    administrator username and password you assigned earlier (**admin** and **cisco**),
    and then click **OK**. After logging on, you should see the CCP management screen,
    shown in [Figure 8-3](ch08.html#cisco_ccp_management_screen "Figure 8-3. Cisco
    CCP management screen").
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 输入你分配给路由器的 IP 地址（**10.10.10.1**），输入你之前设置的管理员用户名和密码（**admin** 和 **cisco**），然后点击**确定**。登录后，你应该能看到
    CCP 管理界面，如[图 8-3](ch08.html#cisco_ccp_management_screen "图 8-3. Cisco CCP 管理界面")所示。
- en: '![Cisco CCP management screen](httpatomoreillycomsourcenostarchimages2209063.png.jpg)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![Cisco CCP 管理界面](httpatomoreillycomsourcenostarchimages2209063.png.jpg)'
- en: Figure 8-3. Cisco CCP management screen
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-3. Cisco CCP 管理界面
- en: Before you can manage your router, you have to select it by first clicking the
    router hostname R1 ➊ and then clicking **Discover** ➋ so CCP can discover its
    features and capabilities. After it’s been discovered, you can set up your router
    by clicking **Configure** ➌ in the toolbar. The advantage of using CCP is that
    it guides you through the process of assigning IP addresses, NAT, VPNs, and other
    Cisco features without you having to know any IOS commands. Be aware that Cisco
    certification exams primarily focus on IOS commands, and not CCP, to configure
    devices.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在你能够管理路由器之前，首先需要通过点击路由器主机名 R1 ➊，然后点击**发现** ➋，以便 CCP 能够发现其特性和功能。发现后，你可以通过点击工具栏中的**配置**
    ➌ 来设置路由器。使用 CCP 的优点是，它会引导你完成分配 IP 地址、NAT、VPN 和其他 Cisco 功能的过程，而无需你了解任何 IOS 命令。请注意，Cisco
    认证考试主要关注 IOS 命令，而不是使用 CCP 配置设备。
- en: Cisco ASA Firewall
  id: totrans-30
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Cisco ASA 防火墙
- en: Cisco’s ASA is an improved version of the old PIX firewall. GNS3 emulates a
    Cisco ASA model 5520\. Although it’s not a router, you may be surprised to learn
    that the ASA supports several routing protocols, including RIP, EIGRP, and OSPF,
    allowing you to easily network them with other GNS3 routed devices.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: Cisco 的 ASA 是旧款 PIX 防火墙的改进版本。GNS3 模拟了 Cisco ASA 5520 型号。虽然它不是路由器，但你可能会惊讶地发现，ASA
    支持多种路由协议，包括 RIP、EIGRP 和 OSPF，这使得你可以轻松地将其与其他 GNS3 路由设备联网。
- en: Acquiring an Image
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 获取镜像
- en: 'Before you can use an ASA virtual machine with GNS3, you need an image file
    of the ASA operating system. The fastest way to get an image of the ASA operating
    system is to copy it from an ASA you already own (that is, from the ASA installation
    CD or directly from an ASA device). Copying files from a Cisco ASA works the same
    way as copying files from a Cisco router: you can use FTP or TFTP. In this example,
    you’ll use a TFTP server. There are plenty of free TFTP servers to choose from,
    so find one you like and install it on your PC.'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 在你可以在 GNS3 中使用 ASA 虚拟机之前，你需要一个 ASA 操作系统的镜像文件。获取 ASA 操作系统镜像的最快方法是从你已经拥有的 ASA
    设备中复制它（即从 ASA 安装光盘或直接从 ASA 设备复制）。从 Cisco ASA 复制文件的方式与从 Cisco 路由器复制文件的方式相同：你可以使用
    FTP 或 TFTP。在这个示例中，你将使用 TFTP 服务器。市面上有很多免费的 TFTP 服务器可供选择，所以可以选择一个你喜欢的并安装到你的 PC 上。
- en: 'After you have a TFTP server running on your network, log on to your physical
    ASA and copy your ASA image file to your PC. In the following listing, my ASA
    image file is named *asa824-k8.bin*, and my TFTP server is running on a PC at
    IP address 192.168.1.100:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在你的网络上运行 TFTP 服务器后，登录到你的物理 ASA，并将 ASA 镜像文件复制到你的 PC 上。在下面的列表中，我的 ASA 镜像文件名为 *asa824-k8.bin*，而我的
    TFTP 服务器运行在 IP 地址为 192.168.1.100 的 PC 上：
- en: '[PRE2]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: After you have an ASA image file, you need to make some modifications to the
    file before you can use it with GNS3.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 在你获得 ASA 镜像文件后，你需要对文件进行一些修改，才能在 GNS3 中使用它。
- en: Prepping the ASA Image for GNS3
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 为 GNS3 准备 ASA 镜像
- en: The Cisco ASA is really just a small Linux PC, and ASA image files like *asa824-k8.bin*
    contain a compact Linux operating system designed to run on ASA hardware.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: Cisco ASA 实际上只是一台小型的 Linux 计算机，像 *asa824-k8.bin* 这样的 ASA 镜像文件包含了一个紧凑型的 Linux
    操作系统，专为在 ASA 硬件上运行而设计。
- en: 'The image file includes a Linux kernel and other support software for the appliance.
    To run the ASA software using GNS3, you have to unpack the *.bin* file, make some
    modifications, and repack it in a way that’s suitable for QEMU. Fortunately, there
    are plenty of clever people in the Linux and Cisco communities who have written
    image unpacker software that does this for you. You can download Cisco Image Unpacker
    for Windows from the GNS3 website, or you can use a Linux shell script like *repack.v4.sh*.
    Regardless of which unpacker you choose, you’ll need to find one designed for
    your version of ASA software. After running the script, you should be left with
    two files: *asa-vmlinuz* (a Linux kernel) and *asa-initrd.gz* (a RAM disk file).
    These are the files used by QEMU and GNS3.'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 镜像文件包括一个 Linux 内核和为该设备提供支持的软件。要使用 GNS3 运行 ASA 软件，你需要解压 *.bin* 文件，进行一些修改，并将其重新打包成适合
    QEMU 的格式。幸运的是，Linux 和 Cisco 社区中有很多聪明人写了图像解包软件，帮你完成这项工作。你可以从 GNS3 网站下载适用于 Windows
    的 Cisco 图像解包工具，或者使用像 *repack.v4.sh* 这样的 Linux shell 脚本。无论你选择哪个解包工具，都需要找到适合你的 ASA
    软件版本的工具。运行脚本后，你应该得到两个文件：*asa-vmlinuz*（一个 Linux 内核）和 *asa-initrd.gz*（一个 RAM 磁盘文件）。这些就是
    QEMU 和 GNS3 使用的文件。
- en: If you don’t want to modify your own ASA image file, a quick Internet search
    should turn up plenty of ready-to-use ASA files. These images usually come in
    a *.zip* file that contains the two files (*asa-vmlinux* and *asa-initrd.gz*).
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你不想修改自己的 ASA 镜像文件，可以通过快速的互联网搜索找到许多现成可用的 ASA 镜像文件。这些镜像文件通常以 *.zip* 文件的形式提供，包含两个文件（*asa-vmlinux*
    和 *asa-initrd.gz*）。
- en: Configuring GNS3 for ASA
  id: totrans-41
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置 GNS3 以使用 ASA
- en: Before configuring an ASA in GNS3, check that QEMU is installed and tested on
    your PC. (See the QEMU installation information for your particular operating
    system in [Chapter 6](ch06.html "Chapter 6. Juniper Olive and VSRX Firefly").)
    Next, launch GNS3, select **Edit** ▸ **Preferences** on Linux and Windows or **GNS3**
    ▸ **Preferences** on OS X, and choose **QEMU VMs** from the panel on the left,
    as shown in [Figure 8-4](ch08.html#qemu_vms_preferences "Figure 8-4. QEMU VMs
    preferences").
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 在配置 GNS3 中的 ASA 之前，请确认 QEMU 已经在你的 PC 上安装并通过测试。（请参考[第 6 章](ch06.html "第 6 章.
    Juniper Olive 和 VSRX Firefly")中针对你操作系统的 QEMU 安装信息。）接下来，启动 GNS3，在 Linux 和 Windows
    中选择 **编辑** ▸ **首选项**，或在 OS X 中选择 **GNS3** ▸ **首选项**，然后从左侧面板中选择 **QEMU 虚拟机**，如[图
    8-4](ch08.html#qemu_vms_preferences "图 8-4. QEMU 虚拟机首选项")所示。
- en: '![QEMU VMs preferences](httpatomoreillycomsourcenostarchimages2209065.png.jpg)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![QEMU 虚拟机首选项](httpatomoreillycomsourcenostarchimages2209065.png.jpg)'
- en: Figure 8-4. QEMU VMs preferences
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-4. QEMU 虚拟机首选项
- en: To create a new ASA in GNS3, click **New** to start the New QEMU VM wizard.
    Select **ASA 8.4(2)** from the Type drop-down menu, as shown in [Figure 8-5](ch08.html#creating_a_new_qemu_virtual_machine_and
    "Figure 8-5. Creating a new QEMU virtual machine and setting Type to ASA 8.4(2)").
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 要在 GNS3 中创建新的 ASA，请点击**新建**以启动新的 QEMU VM 向导。从类型下拉菜单中选择**ASA 8.4(2)**，如[图 8-5](ch08.html#creating_a_new_qemu_virtual_machine_and
    "图 8-5. 创建新的 QEMU 虚拟机并将类型设置为 ASA 8.4(2)")所示。
- en: '![Creating a new QEMU virtual machine and setting Type to ASA 8.4(2)](httpatomoreillycomsourcenostarchimages2209067.png.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![创建新的 QEMU 虚拟机并将类型设置为 ASA 8.4(2)](httpatomoreillycomsourcenostarchimages2209067.png.jpg)'
- en: Figure 8-5. Creating a new QEMU virtual machine and setting Type to ASA 8.4(2)
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-5. 创建新的 QEMU 虚拟机并将类型设置为 ASA 8.4(2)
- en: By default your device is automatically named [*ASA*](apd.html#gloss01_004),
    but you can rename it whatever you prefer. When you’re done naming your ASA, click
    **Next** to continue.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，您的设备会自动命名为[*ASA*](apd.html#gloss01_004)，但您可以根据需要重新命名。命名完成后，点击**下一步**继续。
- en: The wizard should automatically locate and choose the correct QEMU binary file
    for your PC, as shown in [Figure 8-6](ch08.html#selecting_the_asa_virtual_machineapostro
    "Figure 8-6. Selecting the ASA virtual machine’s QEMU binary and memory").
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 向导应自动定位并选择适合您 PC 的 QEMU 二进制文件，如[图 8-6](ch08.html#selecting_the_asa_virtual_machineapostro
    "图 8-6. 选择 ASA 虚拟机的 QEMU 二进制文件和内存")所示。
- en: '![Selecting the ASA virtual machine’s QEMU binary and memory](httpatomoreillycomsourcenostarchimages2209069.png.jpg)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![选择 ASA 虚拟机的 QEMU 二进制文件和内存](httpatomoreillycomsourcenostarchimages2209069.png.jpg)'
- en: Figure 8-6. Selecting the ASA virtual machine’s QEMU binary and memory
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-6. 选择 ASA 虚拟机的 QEMU 二进制文件和内存
- en: If it does not find a QEMU binary, verify that QEMU is installed correctly on
    your PC and try again. The default RAM value is 1024MB, but this is the minimum
    amount required to run the ASA image. You can increase the value by entering a
    new value in the field. When you’re done, click **Next** to continue the wizard.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 如果没有找到 QEMU 二进制文件，请验证您的 PC 上是否正确安装了 QEMU，然后重试。默认的 RAM 值是 1024MB，但这是运行 ASA 镜像所需的最小值。您可以通过在字段中输入新值来增加该值。完成后，点击**下一步**继续向导。
- en: The last step is to browse and select your initial RAM disk and kernel image,
    as shown in [Figure 8-7](ch08.html#linux_boot-specific_settings_for_an_asa "Figure 8-7. Linux
    boot-specific settings for an ASA virtual machine").
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 最后的步骤是浏览并选择您的初始 RAM 磁盘和内核镜像，如[图 8-7](ch08.html#linux_boot-specific_settings_for_an_asa
    "图 8-7. Linux 启动特定设置的 ASA 虚拟机")所示。
- en: '![Linux boot-specific settings for an ASA virtual machine](httpatomoreillycomsourcenostarchimages2209071.png.jpg)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![Linux 启动特定设置的 ASA 虚拟机](httpatomoreillycomsourcenostarchimages2209071.png.jpg)'
- en: Figure 8-7. Linux boot-specific settings for an ASA virtual machine
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-7. Linux 启动特定设置的 ASA 虚拟机
- en: Set Initial Ram disk (initrd) and Kernel image to the correct files for your
    computer; these are usually named *asa842-initrd.gz* and *asa842-vmlinuz*, respectively.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 将初始 RAM 磁盘（initrd）和内核镜像设置为您计算机的正确文件；这些文件通常命名为 *asa842-initrd.gz* 和 *asa842-vmlinuz*。
- en: When you’re done choosing the two images, click **Finish** to complete the installation.
    After successfully adding your ASA, the ASA device should be displayed in the
    QEMU VM Preferences window, as shown in [Figure 8-8](ch08.html#qemu_vms_preferences_for_an_asa_virtual
    "Figure 8-8. QEMU VMs preferences for an ASA virtual machine").
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 选择完这两个镜像后，点击**完成**以完成安装。成功添加 ASA 后，ASA 设备应显示在 QEMU VM 偏好设置窗口中，如[图 8-8](ch08.html#qemu_vms_preferences_for_an_asa_virtual
    "图 8-8. QEMU 虚拟机偏好设置的 ASA 虚拟机")所示。
- en: '![QEMU VMs preferences for an ASA virtual machine](httpatomoreillycomsourcenostarchimages2209073.png.jpg)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![QEMU 虚拟机的 ASA 偏好设置](httpatomoreillycomsourcenostarchimages2209073.png.jpg)'
- en: Figure 8-8. QEMU VMs preferences for an ASA virtual machine
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-8. QEMU 虚拟机偏好设置的 ASA 虚拟机
- en: The current settings of your ASA should be displayed in the panel on the right,
    and one setting you should note is CPU throttling (located under Optimizations).
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 您当前的 ASA 设置应显示在右侧面板中，您需要注意的一项设置是 CPU 限制（位于优化选项下）。
- en: Unlike Dynamips devices, the ASA does not have an Idle-PC option to control
    CPU consumption. This means that an ASA can consume your entire CPU, much like
    a Dynamips router does when no Idle-PC value has been set. To prevent this, GNS3
    uses another open source application (cpulimit) to adjust the maximum amount of
    CPU that a QEMU/ASA instance can consume. The default value is 80 percent, which
    works well in most situations. You can edit your ASA settings and raise or lower
    the value, but be careful; using too little of your CPU, by decreasing the percentage,
    can result in poor ASA performance and frequent ASA crashes, and setting the percentage
    too high can result in slower overall PC performance.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 与Dynamips设备不同，ASA没有闲置PC选项来控制CPU消耗。这意味着ASA可能会占用整个CPU，就像没有设置闲置PC值的Dynamips路由器一样。为了避免这种情况，GNS3使用另一个开源应用程序（cpulimit）来调整QEMU/ASA实例可以消耗的最大CPU量。默认值为80%，在大多数情况下效果良好。你可以编辑ASA设置，增加或减少该值，但要小心；通过降低百分比使用太少的CPU可能会导致ASA性能不佳并频繁崩溃，而将百分比设置得太高则可能导致整体PC性能变慢。
- en: Another setting to note under Optimizations is the Process priority. The default
    value in GNS3 is low, but it can be set to low, medium, or high. The Process priority
    determines when the QEMU/ASA instance gets CPU time. Processes with a high priority
    gain access to the CPU before processes with a low priority. In general, changing
    the priority should have little or no effect on your system, but to be safe, keep
    it set to low to prevent your ASA from potentially overriding important system
    processes.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 在优化设置中，另一个需要注意的设置是进程优先级。GNS3中的默认值为低，但可以设置为低、中或高。进程优先级决定了QEMU/ASA实例何时获得CPU时间。高优先级的进程会在低优先级的进程之前获得CPU。通常，改变优先级应该对系统几乎没有影响，但为了安全起见，保持设置为低，以防ASA可能覆盖重要的系统进程。
- en: 'On Windows and OS X, the cpulimit program should have been installed with GNS3\.
    On Ubuntu Linux you need to install cpulimit using the following command:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 在Windows和OS X上，cpulimit程序应该已经随着GNS3一起安装。在Ubuntu Linux上，你需要使用以下命令安装cpulimit：
- en: '[PRE3]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Now that your ASA virtual machine won’t take over your system, let’s log on
    to an ASA and perform a basic configuration.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你的ASA虚拟机不会接管你的系统，让我们登录到一个ASA并进行基本配置。
- en: Testing an ASA in GNS3
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在GNS3中测试ASA
- en: 'Drag an ASA firewall node from the Devices toolbar to your workspace. Your
    ASA should be located in the Security Devices section of the toolbar. Start the
    ASA and open a GNS3 console connection. While it loads, you should see standard
    ASA startup messages followed by the ASA command prompt:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 从设备工具栏中将ASA防火墙节点拖到工作区。你的ASA应该位于工具栏的安全设备部分。启动ASA并打开GNS3控制台连接。在加载过程中，你应该看到标准的ASA启动消息，随后是ASA命令提示符：
- en: '[PRE4]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: A few error messages before the prompt are perfectly normal, but if your ASA
    fails to start or you see a lot of errors, check your settings or try a different
    ASA image file.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 在提示符前出现一些错误消息是完全正常的，但如果ASA无法启动或你看到很多错误，请检查设置或尝试使用不同的ASA镜像文件。
- en: Note
  id: totrans-70
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*It’s not uncommon for an ASA in GNS3 to hang or stall during the boot cycle,
    especially on older hardware. If this happens, stop and restart the ASA. It may
    take a couple attempts before you get a successful boot.*'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '*在GNS3中，ASA在启动过程中挂起或停滞并不罕见，尤其是在较旧的硬件上。如果发生这种情况，停止并重新启动ASA。可能需要尝试几次才能成功启动。*'
- en: To test simple network connectivity, create a link from your ASA to another
    GNS3 device in your workspace. Next, open a console connection to the ASA and
    configure an interface with an IP address.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 为了测试简单的网络连接性，创建一个连接，将你的ASA与工作区中的另一个GNS3设备连接。接下来，打开ASA的控制台连接，并为接口配置一个IP地址。
- en: '[PRE5]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: After you’ve configured an interface, use a `ping` command to test connectivity
    from your ASA to other devices in your project.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 配置完接口后，使用`ping`命令测试从你的ASA到项目中其他设备的连接。
- en: Warning
  id: totrans-75
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 警告
- en: '*Even with CPU throttling enabled, ASA devices are processor intensive, so
    you may want to use them sparingly in your projects, especially if you have a
    low-end PC.*'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '*即使启用了CPU限制，ASA设备仍然是处理器密集型的，因此你可能希望在项目中谨慎使用它们，特别是当你使用低端PC时。*'
- en: After verifying that your ASA device is running properly, you’re ready to begin
    adding them to your projects. This can be helpful for learning how to configure
    the ASA or to prepare for a Cisco certification exam.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 在验证你的ASA设备正常运行后，你可以开始将其添加到项目中。这对学习如何配置ASA或准备思科认证考试很有帮助。
- en: ASDM Installation
  id: totrans-78
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ASDM安装
- en: Cisco’s ASDM is similar to the CCP software that was covered in [Cisco Configuration
    Professional](ch08.html#cisco_configuration_professional "Cisco Configuration
    Professional"), so many of the details are the same. Like CCP, ASDM provides a
    point-and-click Java-based web interface. The key difference between CCP and ASDM
    is that ASDM is designed to configure only the Cisco ASA, not other Cisco devices.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: Cisco的ASDM类似于在[Cisco配置专业工具](ch08.html#cisco_configuration_professional "Cisco
    Configuration Professional")中介绍的CCP软件，因此许多细节是相同的。像CCP一样，ASDM提供了一个基于Java的图形化网页界面。CCP和ASDM的主要区别在于，ASDM仅用于配置Cisco
    ASA设备，而不用于配置其他Cisco设备。
- en: Before you install the ASDM software, create a project like the one in [Figure 8-9](ch08.html#asdm_topology_with_an_asa_firewall_and_w
    "Figure 8-9. ASDM topology with an ASA firewall and Windows guest"). You’ll use
    the Windows virtual machine to install and run the ASDM application, and then
    you’ll launch ASDM and use it to take a look at the ASA.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 在安装ASDM软件之前，创建一个类似于[图8-9](ch08.html#asdm_topology_with_an_asa_firewall_and_w
    "Figure 8-9. ASDM topology with an ASA firewall and Windows guest")中的项目。你将使用Windows虚拟机来安装和运行ASDM应用程序，然后启动ASDM并用它来查看ASA设备。
- en: '![ASDM topology with an ASA firewall and Windows guest](httpatomoreillycomsourcenostarchimages2209075.png.jpg)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![ASDM拓扑，包含ASA防火墙和Windows虚拟机](httpatomoreillycomsourcenostarchimages2209075.png.jpg)'
- en: Figure 8-9. ASDM topology with an ASA firewall and Windows guest
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 图8-9. ASDM拓扑，包含ASA防火墙和Windows虚拟机
- en: 'There are two ways to acquire the ASDM software: copy it from the flash memory
    of a real ASA or find it online. After you have the ASDM software, it needs to
    be stored on your virtual ASA’s flash drive; from there you’ll install it on your
    Windows virtual machine PC using a web browser. I recommend Mozilla Firefox because
    I’ve found that it runs ASDM better than Internet Explorer. (Just be sure to disable
    any pop-up blockers and firewalls and install the latest version of Java.) You’ll
    also need FTP or TFTP server software to copy the ASDM software from the GNS3
    Windows virtual machine to your ASA.'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 获取ASDM软件有两种方法：从真实ASA的闪存中复制，或者在线查找。在获得ASDM软件后，需要将其存储在虚拟ASA的闪存驱动器上；然后通过网页浏览器在Windows虚拟机PC上安装它。我推荐使用Mozilla
    Firefox，因为我发现它比Internet Explorer更能顺畅运行ASDM。（只要确保禁用任何弹出窗口拦截器和防火墙，并安装最新版本的Java。）你还需要FTP或TFTP服务器软件，将ASDM软件从GNS3
    Windows虚拟机复制到ASA设备。
- en: 'After you have an ASDM image, there’s some prep work to do on the ASA device
    so you can copy over the ASDM image. Enter these commands on the ASA:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 在获得ASDM镜像后，需要在ASA设备上进行一些准备工作，以便将ASDM镜像复制过来。请在ASA上输入以下命令：
- en: '[PRE6]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Just like when you set up CCP, start by assigning an IP address to an inside
    interface ➊. Then, create a local user account ➋, and enable the HTTP server ➌.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 就像设置CCP时一样，首先为内部接口分配一个IP地址➊。然后，创建一个本地用户账户➋，并启用HTTP服务器➌。
- en: After the ASA is configured and you have the ASDM software on your FTP or TFTP
    server, copy the software from your Windows virtual machine to the flash memory
    of the ASA.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 在ASA配置完成且你已将ASDM软件放到FTP或TFTP服务器上后，将软件从Windows虚拟机复制到ASA的闪存内存中。
- en: '[PRE7]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: This example copies a file named *asdm-641.bin* from my GNS3 Windows virtual
    machine to my ASA device using TFTP.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 本例通过TFTP将一个名为*asdm-641.bin*的文件从我的GNS3 Windows虚拟机复制到我的ASA设备。
- en: After copying the ASDM file, you need to install the software on your Windows
    virtual machine. Launch your web browser and open an HTTP Secure (HTTPS) connection
    to the IP address of your ASA. You should be presented with a screen similar to
    [Figure 8-10](ch08.html#cisco_asdm_install_screen "Figure 8-10. Cisco ASDM install
    screen").
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 复制ASDM文件后，你需要在Windows虚拟机上安装该软件。启动你的网页浏览器，并打开到ASA的IP地址的HTTPS连接。你应该会看到一个类似于[图8-10](ch08.html#cisco_asdm_install_screen
    "Figure 8-10. Cisco ASDM install screen")的屏幕。
- en: '![Cisco ASDM install screen](httpatomoreillycomsourcenostarchimages2209077.png.jpg)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![Cisco ASDM安装屏幕](httpatomoreillycomsourcenostarchimages2209077.png.jpg)'
- en: Figure 8-10. Cisco ASDM install screen
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 图8-10. Cisco ASDM安装屏幕
- en: Because you’ll be using the Java Web Start option, click **Run ASDM**. Your
    PC should download Java software and present you with a few security warnings,
    which you can safely click past until you see the Cisco ASDM-IDM Launcher, shown
    in [Figure 8-11](ch08.html#windows_asdm-idm_launcher "Figure 8-11. Windows ASDM-IDM
    Launcher").
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 由于你将使用Java Web Start选项，请点击**运行ASDM**。你的PC应该会下载Java软件，并向你展示一些安全警告，你可以安全地点击跳过，直到看到Cisco
    ASDM-IDM启动器，如[图8-11](ch08.html#windows_asdm-idm_launcher "Figure 8-11. Windows
    ASDM-IDM Launcher")所示。
- en: '![Windows ASDM-IDM Launcher](httpatomoreillycomsourcenostarchimages2209079.png.jpg)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![Windows ASDM-IDM启动器](httpatomoreillycomsourcenostarchimages2209079.png.jpg)'
- en: Figure 8-11. Windows ASDM-IDM Launcher
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-11. Windows ASDM-IDM 启动器
- en: Enter your ASA username and password (**admin** and **cisco**) and select **OK**
    to log on to your ASA. After you have successfully logged on, you can begin configuring
    the system from the ASDM Device Dashboard, shown in [Figure 8-12](ch08.html#asdm_device_dashboard
    "Figure 8-12. ASDM Device Dashboard").
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 输入你的 ASA 用户名和密码（**admin** 和 **cisco**），然后选择 **OK** 以登录到 ASA。成功登录后，你可以从 ASDM
    设备仪表盘开始配置系统，见[图 8-12](ch08.html#asdm_device_dashboard "图 8-12. ASDM 设备仪表盘")。
- en: '![ASDM Device Dashboard](httpatomoreillycomsourcenostarchimages2209081.png.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![ASDM 设备仪表盘](httpatomoreillycomsourcenostarchimages2209081.png.jpg)'
- en: Figure 8-12. ASDM Device Dashboard
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-12. ASDM 设备仪表盘
- en: The ASDM Device Dashboard includes several wizards that provide guided setups
    for creating common network and virtual private network (VPN) configurations.
    It also provides many real-time statistics to assist you in monitoring your network
    performance. Although not necessarily useful in GNS3, this information could be
    invaluable for maintaining a healthy network in real life.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: ASDM 设备仪表盘包含了几个向导，提供了创建常见网络和虚拟私人网络（VPN）配置的引导设置。它还提供了许多实时统计数据，帮助你监控网络性能。虽然在 GNS3
    中不一定有用，但这些信息对于维持现实中的健康网络可能非常宝贵。
- en: Cisco IDS/IPS
  id: totrans-100
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Cisco IDS/IPS
- en: The Cisco IDS/IPS identifies and prevents malicious activity on a network. In
    the real world, an IDS/IPS can be a stand-alone Cisco device or a module that
    you plug into an ASA or integrated service router.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: Cisco IDS/IPS 可以识别并阻止网络上的恶意活动。在现实中，IDS/IPS 可以是一个独立的 Cisco 设备，也可以是你插入 ASA 或集成服务路由器的模块。
- en: Creating an IDS/IPS virtual machine for GNS3 is a real pain compared to most
    tasks, so before you begin, you may want to set aside a couple of hours.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 在 GNS3 中创建 IDS/IPS 虚拟机相比于大多数任务来说确实比较麻烦，因此在开始之前，你可能需要腾出几个小时。
- en: Acquiring an IDS/IPS Image
  id: totrans-103
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 获取 IDS/IPS 镜像
- en: Like PIX and ASA, IDS/IPS runs on special Linux software. If you own a physical
    IDS/IPS appliance, then an upgrade/recovery CD containing the software should
    have come with your device.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 与 PIX 和 ASA 一样，IDS/IPS 运行在特殊的 Linux 软件上。如果你拥有物理 IDS/IPS 设备，那么应该会随设备附带一个包含软件的升级/恢复
    CD。
- en: To install IDS/IPS using a QEMU virtual machine, you need an ISO image of the
    CD. You can create your own ISO image file using your CD or find one on the Internet.
    In this example, I used an IOS image file named *IPS-K9-cd-1.1-a-6.0-6-E3.iso*.
    Other versions of the software may work fine, but this version has proven to work
    well for creating a GNS3-compatible IDS/IPS.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用 QEMU 虚拟机安装 IDS/IPS，你需要一个 CD 的 ISO 镜像文件。你可以使用你的 CD 创建自己的 ISO 镜像文件，或者在网上找到一个。在这个示例中，我使用了一个名为
    *IPS-K9-cd-1.1-a-6.0-6-E3.iso* 的 IOS 镜像文件。其他版本的软件可能也可以正常工作，但这个版本已经证明在创建兼容 GNS3
    的 IDS/IPS 时效果良好。
- en: Creating a QEMU-Ready IDS/IPS System
  id: totrans-106
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建一个适用于 QEMU 的 IDS/IPS 系统
- en: IDS/IPS software runs using QEMU, so be sure you have installed it on your PC
    and have tested it with GNS3 before you begin. Then, create a build directory
    for your IDS/IPS and copy your ISO file to the directory. This is where you’ll
    create the IDS/IPS virtual machine.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: IDS/IPS 软件通过 QEMU 运行，因此在开始之前，请确保你已经在 PC 上安装了 QEMU，并且已在 GNS3 中测试过它。然后，为你的 IDS/IPS
    创建一个构建目录，并将 ISO 文件复制到该目录。这里就是你将创建 IDS/IPS 虚拟机的地方。
- en: 'To install IDS/IPS software on a QEMU virtual machine, you have to create two
    QEMU virtual hard disk image files. Open a terminal window and enter the following
    commands to create the images:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 要在 QEMU 虚拟机上安装 IDS/IPS 软件，你需要创建两个 QEMU 虚拟硬盘镜像文件。打开终端窗口并输入以下命令来创建镜像：
- en: '[PRE8]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Note
  id: totrans-110
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*On Windows and OS X you may need to set your system path to include the location
    of your QEMU installation. Please refer to [Installing QEMU on Windows and OS
    X](ch06.html#installing_qemu_on_windows_and_os_x "Installing QEMU on Windows and
    OS X") for details.*'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '*在 Windows 和 OS X 上，你可能需要设置系统路径，以包含 QEMU 安装的位置。请参考 [在 Windows 和 OS X 上安装 QEMU](ch06.html#installing_qemu_on_windows_and_os_x
    "在 Windows 和 OS X 上安装 QEMU") 获取详细信息。*'
- en: 'Now that you’ve created the virtual disks, enter the following command to boot
    your virtual machine from the ISO image file:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 既然你已经创建了虚拟磁盘，输入以下命令以从 ISO 镜像文件启动你的虚拟机：
- en: '[PRE9]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: On Windows systems, replace `qemu-system-i386` in this command with `qemu-system-i386w`.
    After the system boots, you should see a screen similar to [Figure 8-13](ch08.html#idssolidusips_installation_screen
    "Figure 8-13. IDS/IPS installation screen").
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Windows 系统中，将此命令中的 `qemu-system-i386` 替换为 `qemu-system-i386w`。系统启动后，你应该看到一个类似于
    [图 8-13](ch08.html#idssolidusips_installation_screen "图 8-13. IDS/IPS 安装屏幕") 的画面。
- en: '![IDS/IPS installation screen](httpatomoreillycomsourcenostarchimages2209083.png.jpg)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![IDS/IPS 安装屏幕](httpatomoreillycomsourcenostarchimages2209083.png.jpg)'
- en: Figure 8-13. IDS/IPS installation screen
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-13. IDS/IPS 安装屏幕
- en: 'At the `boot:` prompt, enter **`k`** to perform a full system recovery. During
    the recovery process, your QEMU virtual machine will boot Linux from the ISO image,
    install a GRUB boot loader, and install the IDS/IPS software. When the install
    finishes copying files, the virtual machine will reboot automatically and end
    with a “FATAL” boot error message, as shown in [Figure 8-14](ch08.html#fatal_no_bootable_device
    "Figure 8-14. FATAL: No bootable device").'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `boot:` 提示符下，输入 **`k`** 执行完整系统恢复。在恢复过程中，你的 QEMU 虚拟机会从 ISO 镜像启动 Linux，安装 GRUB
    引导加载器，并安装 IDS/IPS 软件。当安装完成并复制文件后，虚拟机会自动重启，并显示一个 “FATAL” 启动错误信息，如图 [8-14](ch08.html#fatal_no_bootable_device
    "图 8-14. 致命错误：没有可启动设备") 所示。
- en: '![FATAL: No bootable device](httpatomoreillycomsourcenostarchimages2209085.png.jpg)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![致命错误：没有可启动设备](httpatomoreillycomsourcenostarchimages2209085.png.jpg)'
- en: 'Figure 8-14. FATAL: No bootable device'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-14. 致命错误：没有可启动设备
- en: 'Don’t worry, this error is perfectly normal and expected. Quit QEMU and enter
    the following command to boot the IDS/IPS again:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 不用担心，这个错误是完全正常并且预期的。退出 QEMU 并输入以下命令再次启动 IDS/IPS：
- en: '[PRE10]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: The IDS/IPS virtual machine will boot to a Linux GRUB boot menu. At the boot
    menu, enter **`e`** to edit an entry. Use the arrow key to move down to highlight
    the `kernel` entry and enter **`e`** again to edit this entry.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: IDS/IPS 虚拟机会启动进入 Linux GRUB 启动菜单。在启动菜单中，输入 **`e`** 来编辑条目。使用箭头键向下移动，突出显示 `kernel`
    条目，再次输入 **`e`** 来编辑该条目。
- en: Use the back arrow key to locate and change **`init=/loadrc`** to **`init=1`**.
    Press ENTER to accept the change and press **`b`** to boot from the modified GRUB
    menu. The system should now boot, bypassing the IDS/IPS startup, and bring you
    to a Linux console. From the console command line, you’ll use the vi editor to
    modify some IDS/IPS configuration files.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 使用回退箭头键定位并将 **`init=/loadrc`** 修改为 **`init=1`**。按下 ENTER 接受更改，然后按 **`b`** 从修改后的
    GRUB 菜单启动。系统应该现在能够启动，绕过 IDS/IPS 启动，进入 Linux 控制台。从控制台命令行，你将使用 vi 编辑器修改一些 IDS/IPS
    配置文件。
- en: Note
  id: totrans-124
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*You have to use the vi editor to modify files because no other editor is installed.
    If you are unfamiliar with vi, you’ll want to brush up on it before you continue.
    Just search for `man vi` online or enter `man vi` at the command line to view
    the man page.*'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: '*你必须使用 vi 编辑器来修改文件，因为没有安装其他编辑器。如果你不熟悉 vi，最好在继续之前复习一下它。只需在线搜索 `man vi` 或在命令行输入
    `man vi` 查看手册页。*'
- en: After you’re familiar with vi editing commands, you’re ready to continue.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 在你熟悉了 vi 编辑命令之后，就可以继续进行下一步了。
- en: Hijacking the Hardware
  id: totrans-127
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 劫持硬件
- en: 'First, you’ll need to trick the IDS/IPS software into thinking your QEMU virtual
    machine is a real Cisco IDS-4215 Appliance Sensor. To fool the software, you have
    to modify two files: *ids_functions* and *interface.conf*. Modifying these files
    is pretty tedious, and the smallest mistake will prevent you from creating a working
    IDS/IPS device.'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，你需要通过欺骗 IDS/IPS 软件，让它认为你的 QEMU 虚拟机是一个真实的 Cisco IDS-4215 Appliance Sensor。为了欺骗软件，你需要修改两个文件：*ids_functions*
    和 *interface.conf*。修改这些文件相当繁琐，最小的错误都会导致你无法创建一个正常工作的 IDS/IPS 设备。
- en: 'Start by entering the following commands from the shell prompt:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 从 shell 提示符开始，输入以下命令：
- en: '[PRE11]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: This will mount the Linux file systems used by the IDS/IPS and initialize the
    system. Next, use vi to open the *ids_functions* file.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 这将挂载 IDS/IPS 使用的 Linux 文件系统并初始化系统。接下来，使用 vi 打开 *ids_functions* 文件。
- en: '[PRE12]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'After opening the file, enter the command `/845` to have vi locate the following
    entry:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 打开文件后，输入命令 `/845` 让 vi 定位到以下条目：
- en: '[PRE13]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Next, edit the `elif` statement and `DEFAULT_MGT` statements so they read as
    follows:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，编辑 `elif` 语句和 `DEFAULT_MGT` 语句，使其如下所示：
- en: '[PRE14]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: When you’re finished editing and certain that you have made the correct changes,
    save the file and exit the vi editor.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 当你完成编辑并确定已经做出正确修改时，保存文件并退出 vi 编辑器。
- en: Next, you’ll edit the *interface.conf* file.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，你需要编辑 *interface.conf* 文件。
- en: '[PRE15]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Use the arrow key to move down to the section that begins with `####### IDS-4215
    ########`, modify each of the interface entries starting at `[models/IDS-4215/interfaces/1]`
    and ending with `[models/IDS-4215/interfaces/6]`. Each entry must look exactly
    like the following six entries:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: '使用箭头键向下移动到以 `####### IDS-4215 ########` 开头的部分，修改每个接口条目，从 `[models/IDS-4215/interfaces/1]`
    开始，到 `[models/IDS-4215/interfaces/6]` 结束。每个条目必须完全与以下六个条目一致：'
- en: '[PRE16]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: After you’ve finished editing the interfaces, scroll through the entries and
    verify that each interface is correctly configured. If you’re certain everything
    is correct, save the file and quit vi. Reboot the IDS/IPS virtual machine using
    the `reboot` command.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 在你编辑完接口之后，滚动浏览条目并确认每个接口是否配置正确。如果你确定一切正确，保存文件并退出vi。使用`reboot`命令重启IDS/IPS虚拟机。
- en: '[PRE17]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: The system should boot, configure a few things, and reboot again automatically.
    After the automatic reboot, immediately quit QEMU when you see the GRUB boot manager,
    shown in [Figure 8-15](ch08.html#grub_boot_manager_screen "Figure 8-15. GRUB boot
    manager screen"). If you fail to quit and relaunch QEMU without using the proper
    options, the install will fail, and you’ll have to start over.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 系统应该会启动，配置一些内容，并自动重启。在自动重启后，当你看到GRUB引导管理器时，立即退出QEMU，参见[图 8-15](ch08.html#grub_boot_manager_screen
    "图 8-15. GRUB 引导管理器屏幕")。如果你未能退出并且在没有使用正确选项的情况下重新启动QEMU，安装将失败，你将不得不从头开始。
- en: 'After quitting QEMU, restart your IDS/IPS virtual machine with the following
    command options:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 退出QEMU后，使用以下命令选项重新启动你的IDS/IPS虚拟机：
- en: '[PRE18]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '![GRUB boot manager screen](httpatomoreillycomsourcenostarchimages2209087.png.jpg)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![GRUB引导管理器屏幕](httpatomoreillycomsourcenostarchimages2209087.png.jpg)'
- en: Figure 8-15. GRUB boot manager screen
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-15. GRUB引导管理器屏幕
- en: Your IDS/IPS should now boot to the login prompt shown in [Figure 8-16](ch08.html#idssolidusips_login_prompt
    "Figure 8-16. IDS/IPS login prompt").
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 你的IDS/IPS现在应该已经启动，进入登录提示界面，如[图 8-16](ch08.html#idssolidusips_login_prompt "图
    8-16. IDS/IPS 登录提示")所示。
- en: '![IDS/IPS login prompt](httpatomoreillycomsourcenostarchimages2209089.png.jpg)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![IDS/IPS 登录提示](httpatomoreillycomsourcenostarchimages2209089.png.jpg)'
- en: Figure 8-16. IDS/IPS login prompt
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-16. IDS/IPS 登录提示
- en: You’re almost done! Log on to the system by entering the default username **`cisco`**
    and password **`cisco`**, and you should be directed to reset the password. If
    any part of the IDS/IPS setup has gone wrong, you may see the message “UNSUPPORTED
    HARDWARE DETECTED,” as in [Figure 8-17](ch08.html#quotation_markunsupported_hardware_detec
    "Figure 8-17. “UNSUPPORTED HARDWARE DETECTED” error").
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 你快完成了！通过输入默认用户名**`cisco`**和密码**`cisco`**登录系统，你应该会被引导重置密码。如果IDS/IPS设置中的任何部分出现问题，你可能会看到“检测到不受支持的硬件”的消息，如[图
    8-17](ch08.html#quotation_markunsupported_hardware_detec "图 8-17. “检测到不受支持的硬件”错误")所示。
- en: At this point, you could continue using the IDS/IPS virtual machine, or you
    could start over. I recommend you start over and create a new IDS/IPS until you
    can log on without errors. If you continue, the IDS/IPS system may produce further
    errors and not work as expected.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，你可以继续使用IDS/IPS虚拟机，或者从头开始。我建议你重新开始并创建一个新的IDS/IPS，直到你能够无错误地登录。如果继续操作，IDS/IPS系统可能会产生进一步的错误并无法正常工作。
- en: '![“UNSUPPORTED HARDWARE DETECTED” error](httpatomoreillycomsourcenostarchimages2209091.png.jpg)'
  id: totrans-154
  prefs: []
  type: TYPE_IMG
  zh: '![“检测到不受支持的硬件”错误](httpatomoreillycomsourcenostarchimages2209091.png.jpg)'
- en: Figure 8-17. “UNSUPPORTED HARDWARE DETECTED” error
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-17. “检测到不受支持的硬件”错误
- en: When you can log on without errors, you’re ready to continue.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 当你能够无错误地登录时，你就可以继续了。
- en: Testing IDS/IPS (or Patience Is a Virtue)
  id: totrans-157
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 测试IDS/IPS（或耐心是一种美德）
- en: The first time you log on to the IDS/IPS virtual machine, you will have to wait
    approximately 20 minutes or so while the system rebuilds its regex cache tables.
    This is normal even for an actual IDS/IPS appliance, and you should not interrupt
    it. You can check the progress periodically using the `iplog-status` command.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 第一次登录到IDS/IPS虚拟机时，你需要等待大约20分钟左右，系统将重建其正则表达式缓存表。这是正常现象，即使是实际的IDS/IPS设备也是如此，你不应打断它。你可以使用`iplog-status`命令定期检查进度。
- en: '[PRE19]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'If the status message reads “Error: getIpLogList: Analysis Engine is busy rebuilding
    regex tables. This may take a while.” then the system is still working and should
    not be interrupted. After the rebuild is finished, you should instead see “No
    IP logs available.”'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 如果状态消息显示“错误：getIpLogList：分析引擎正在忙于重建正则表达式表。这可能需要一些时间。”，那么系统仍在工作中，切勿中断它。重建完成后，你应该看到“No
    IP logs available”。
- en: When the rebuild is finished, enter the **`reset`** command to shut down and
    reboot the virtual machine. Unfortunately, there’s no elegant way to shut down
    the system. To avoid file corruption, you should quit QEMU when the reboot reaches
    the GRUB boot menu.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 当重建完成后，输入**`reset`**命令关闭并重启虚拟机。不幸的是，目前没有优雅的方式来关闭系统。为了避免文件损坏，当重启进入GRUB启动菜单时，应该退出QEMU。
- en: Configuring GNS3 for IDS/IPS
  id: totrans-162
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置GNS3用于IDS/IPS
- en: Adding an IDS/IPS to GNS3 is similar to adding an ASA. To add an IDS/IPS device,
    launch GNS3, select **Edit** ▸ **Preferences** on Linux and Windows or **GNS3**
    ▸ **Preferences** on OS X, and select **QEMU VMs** from the sidebar, as shown
    in [Figure 8-18](ch08.html#ids_preferences "Figure 8-18. IDS Preferences").
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 将 IDS/IPS 添加到 GNS3 的方式类似于添加 ASA。要添加 IDS/IPS 设备，启动 GNS3，在 Linux 和 Windows 中选择**编辑**
    ▸ **首选项**，或在 OS X 中选择**GNS3** ▸ **首选项**，然后从侧边栏选择**QEMU 虚拟机**，如[图 8-18](ch08.html#ids_preferences
    "图 8-18. IDS 首选项")所示。
- en: '![IDS Preferences](httpatomoreillycomsourcenostarchimages2209093.png.jpg)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![IDS 首选项](httpatomoreillycomsourcenostarchimages2209093.png.jpg)'
- en: Figure 8-18. IDS Preferences
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-18. IDS 首选项
- en: To create a new IDS/IPS in GNS3, click **New** to start the New QEMU VM wizard.
    Select **IDS** from the Type drop-down menu, as shown in [Figure 8-19](ch08.html#selecting_ids_in_the_new_qemu_vm_wizard
    "Figure 8-19. Selecting IDS in the New QEMU VM wizard").
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 要在 GNS3 中创建一个新的 IDS/IPS，点击**新建**启动新 QEMU 虚拟机向导。从类型下拉菜单中选择**IDS**，如[图 8-19](ch08.html#selecting_ids_in_the_new_qemu_vm_wizard
    "图 8-19. 在新 QEMU 虚拟机向导中选择 IDS")所示。
- en: '![Selecting IDS in the New QEMU VM wizard](httpatomoreillycomsourcenostarchimages2209095.png.jpg)'
  id: totrans-167
  prefs: []
  type: TYPE_IMG
  zh: '![在新 QEMU 虚拟机向导中选择 IDS](httpatomoreillycomsourcenostarchimages2209095.png.jpg)'
- en: Figure 8-19. Selecting IDS in the New QEMU VM wizard
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-19. 在新 QEMU 虚拟机向导中选择 IDS
- en: By default your device is automatically named *IDS*. Click **Next** to continue.
    GNS3 should automatically locate and choose the correct QEMU binary file for your
    PC, shown in [Figure 8-20](ch08.html#qemu_binary_and_memory_screen "Figure 8-20. QEMU
    binary and memory screen").
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，设备会自动命名为*IDS*。点击**下一步**继续。GNS3 应该会自动定位并选择适合你电脑的 QEMU 二进制文件，如[图 8-20](ch08.html#qemu_binary_and_memory_screen
    "图 8-20. QEMU 二进制文件和内存界面")所示。
- en: '![QEMU binary and memory screen](httpatomoreillycomsourcenostarchimages2209097.png.jpg)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![QEMU 二进制文件和内存界面](httpatomoreillycomsourcenostarchimages2209097.png.jpg)'
- en: Figure 8-20. QEMU binary and memory screen
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-20. QEMU 二进制文件和内存界面
- en: Set the RAM field to **1024 MB** or greater, and click **Next** to continue
    to the Disk image (hda) selection, shown in [Figure 8-21](ch08.html#chooseing_a_disk_image
    "Figure 8-21. Chooseing a disk image").
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 将内存设置为**1024 MB**或更大，然后点击**下一步**进入磁盘映像（hda）选择界面，如[图 8-21](ch08.html#chooseing_a_disk_image
    "图 8-21. 选择磁盘映像")所示。
- en: '![Chooseing a disk image](httpatomoreillycomsourcenostarchimages2209099.png.jpg)'
  id: totrans-173
  prefs: []
  type: TYPE_IMG
  zh: '![选择磁盘映像](httpatomoreillycomsourcenostarchimages2209099.png.jpg)'
- en: Figure 8-21. Chooseing a disk image
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-21. 选择磁盘映像
- en: Browse and select the file named *ipsdisk1.img* that was created when you built
    your QEMU-ready IDS system. Click **Next** to continue to the Disk image (hdb)
    selection screen and choose *ipsdisk2.img*. Click **Finish** to complete the installation.
    You’re now ready to test your IDS.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 浏览并选择在构建 QEMU 就绪 IDS 系统时创建的名为*ipsdisk1.img*的文件。点击**下一步**进入磁盘映像（hdb）选择界面，并选择*ipsdisk2.img*。点击**完成**以完成安装。现在你可以开始测试你的
    IDS。
- en: Verifying IDS/IPS in GNS3
  id: totrans-176
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 验证 GNS3 中的 IDS/IPS
- en: To verify that your IDS/IPS is working, drag an IDS/IPS node to your workspace
    and start the device. GNS3 cannot open a console connection to an IDS/IPS device
    until after it has fully booted. This means you will not see any IDS/IPS messages
    prior to the login prompt. After the login prompt appears, you should be able
    to log in and configure the IDS/IPS. To prevent file corruption from occurring,
    use the `reset` command whenever you shut down the device.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 要验证你的 IDS/IPS 是否正常工作，将一个 IDS/IPS 节点拖入工作区并启动设备。GNS3 在设备完全启动之前无法打开 IDS/IPS 设备的控制台连接。这意味着在登录提示出现之前，你将看不到任何
    IDS/IPS 消息。登录提示出现后，你应该能够登录并配置 IDS/IPS。为了防止文件损坏，在关闭设备时使用`reset`命令。
- en: After determining that your IDS/IPS is in good working order, you should make
    a backup copy of the QEMU disk image files. If something happens to your working
    IDS/IPS device, a backup copy of the files can save you hours of work later.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 在确认你的 IDS/IPS 正常工作后，你应该备份 QEMU 磁盘映像文件。如果你的 IDS/IPS 设备出现问题，备份文件可以节省你大量的工作时间。
- en: Cisco IOS-XRv
  id: totrans-179
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Cisco IOS-XRv
- en: Cisco offers a version of IOS-XR in the form of a 32-bit virtual machine called
    IOS-XRv. The cool thing about IOS-XRv is that it’s not an emulator like IOU or
    NX-OSv. Instead, it’s a “hamstrung” version of IOS-XR that contains only a single
    route processor (RP). Network throughput is limited to 2Mbps, and there’s a hard-coded
    AAA user named *cisco* with the password *cisco*, making it impossible to use
    in a production environment, unless you want a slow and insecure network. Despite
    these limitations, the operating system includes management features, routing,
    and forwarding capabilities.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: Cisco提供了一种名为IOS-XRv的32位虚拟机版本。IOS-XRv的特点是，它不是像IOU或NX-OSv那样的模拟器，而是一个“受限版”的IOS-XR，只包含一个路由处理器（RP）。网络吞吐量限制为2Mbps，并且有一个硬编码的AAA用户，用户名为*cisco*，密码为*cisco*，这使得它无法在生产环境中使用，除非你想要一个缓慢且不安全的网络。尽管有这些限制，操作系统仍包含管理功能、路由和转发能力。
- en: The software is designed to run using VMware ESXi or QEMU, making it a breeze
    to use with GNS3\. If you have a Cisco CCO account, you should be able to download
    the software from the Cisco file exchange.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 该软件设计为使用VMware ESXi或QEMU运行，因此在GNS3中使用非常方便。如果你有一个Cisco CCO帐户，你应该能够从Cisco文件交换下载该软件。
- en: Configuring GNS3 for IOS-XRv
  id: totrans-182
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置GNS3以支持IOS-XRv
- en: Cisco IOS-XRv files come in two image formats; the first is an OVA, and the
    second is a Virtual Machine Disk (VMDK) file. The OVA image (ending in .*ova*)
    is suitable for use with VMware ESXi; the VMDK file (ending in .*vmdk*) is ready
    to use with QEMU, and it’s the file you’ll use in GNS3\. In this example, I’ll
    be using an image file named *iosxrv-k9-demo-5.2.2.vmdk*.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: Cisco IOS-XRv文件有两种镜像格式；第一种是OVA文件，第二种是虚拟机磁盘（VMDK）文件。OVA镜像（以.*ova*结尾）适用于VMware
    ESXi；VMDK文件（以.*vmdk*结尾）已经准备好用于QEMU，并且是你将在GNS3中使用的文件。在这个例子中，我将使用一个名为*iosxrv-k9-demo-5.2.2.vmdk*的镜像文件。
- en: Adding an IOS-XRv device to GNS3 is pretty straightforward. You’ll launch the
    New QEMU VM wizard and follow the prompts; then you’ll edit the device, making
    a small change to increase the number of adapters. To add an IOS-XRv device, select
    **Edit** ▸ **Preferences** on Linux and Windows or **GNS3** ▸ **Preferences**
    on OS X and then select **QEMU VMs** from the panel on the left. Click **New**
    to start the configuration and open the dialog in [Figure 8-22](ch08.html#new_qemu_vm_wizard
    "Figure 8-22. New QEMU VM wizard").
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 将IOS-XRv设备添加到GNS3非常简单。你只需启动新的QEMU虚拟机向导并按照提示操作；然后编辑设备，做一个小修改以增加适配器数量。要添加IOS-XRv设备，在Linux和Windows上选择**编辑**
    ▸ **首选项**，在OS X上选择**GNS3** ▸ **首选项**，然后从左侧面板选择**QEMU虚拟机**。点击**新建**开始配置，并打开[图8-22](ch08.html#new_qemu_vm_wizard
    "图8-22. 新的QEMU虚拟机向导")中的对话框。
- en: '![New QEMU VM wizard](httpatomoreillycomsourcenostarchimages2209101.png.jpg)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
  zh: '![新的QEMU虚拟机向导](httpatomoreillycomsourcenostarchimages2209101.png.jpg)'
- en: Figure 8-22. New QEMU VM wizard
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 图8-22. 新的QEMU虚拟机向导
- en: Set Type to **Default** and enter a name for your device; I’ve entered **IOS-XRv**.
    When you’re finished, click **Next** to proceed to the QEMU binary and memory
    settings, shown in [Figure 8-23](ch08.html#configuring_ios-xrv_for_64-bit_systems
    "Figure 8-23. Configuring IOS-XRv for 64-bit systems").
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 将类型设置为**默认**并为您的设备输入名称；我输入的是**IOS-XRv**。完成后，点击**下一步**以继续进行QEMU二进制文件和内存设置，如[图8-23](ch08.html#configuring_ios-xrv_for_64-bit_systems
    "图8-23. 配置64位系统上的IOS-XRv")所示。
- en: '![Configuring IOS-XRv for 64-bit systems](httpatomoreillycomsourcenostarchimages2209103.png.jpg)'
  id: totrans-188
  prefs: []
  type: TYPE_IMG
  zh: '![配置64位系统上的IOS-XRv](httpatomoreillycomsourcenostarchimages2209103.png.jpg)'
- en: Figure 8-23. Configuring IOS-XRv for 64-bit systems
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 图8-23. 配置64位系统上的IOS-XRv
- en: IOS-XRv can run using 32-bit or 64-bit QEMU hardware emulation. Because I’m
    running a 64-bit operating system on my PC, I’ve chosen to use a 64-bit QEMU binary,
    named *qemu-system-x86_64* (shown in [Figure 8-23](ch08.html#configuring_ios-xrv_for_64-bit_systems
    "Figure 8-23. Configuring IOS-XRv for 64-bit systems")), and I’ve set RAM to **2048
    MB**, which is the recommended amount. However, if you run a 32-bit operating
    system, such as Windows, you’ll have to set the RAM to less than 2048MB. This
    is because the 32-bit QEMU program is unable to allocate that much memory to the
    IOS-XRv virtual machine. In this case, you should enter **1920 MB** and use the
    drop-down menu to choose the QEMU binary named *qemu-system-i386w.exe*, as shown
    in [Figure 8-24](ch08.html#configuring_ios-xrv_for_32-bit_windows_s "Figure 8-24. Configuring
    IOS-XRv for 32-bit Windows systems").
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: IOS-XRv可以使用32位或64位QEMU硬件仿真运行。由于我在PC上运行的是64位操作系统，所以我选择使用64位QEMU二进制文件，名为*qemu-system-x86_64*（如[图8-23](ch08.html#configuring_ios-xrv_for_64-bit_systems
    "图8-23. 配置IOS-XRv以支持64位系统")所示），并将RAM设置为**2048 MB**，这是推荐的内存大小。然而，如果你运行的是32位操作系统，例如Windows，你需要将RAM设置为小于2048MB。这是因为32位QEMU程序无法为IOS-XRv虚拟机分配这么多内存。在这种情况下，你应该输入**1920
    MB**并使用下拉菜单选择名为*qemu-system-i386w.exe*的QEMU二进制文件，如[图8-24](ch08.html#configuring_ios-xrv_for_32-bit_windows_s
    "图8-24. 配置IOS-XRv以支持32位Windows系统")所示。
- en: '![Configuring IOS-XRv for 32-bit Windows systems](httpatomoreillycomsourcenostarchimages2209105.png.jpg)'
  id: totrans-191
  prefs: []
  type: TYPE_IMG
  zh: '![配置IOS-XRv以支持32位Windows系统](httpatomoreillycomsourcenostarchimages2209105.png.jpg)'
- en: Figure 8-24. Configuring IOS-XRv for 32-bit Windows systems
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 图8-24. 配置IOS-XRv以支持32位Windows系统
- en: After configuring your QEMU binary and RAM, click **Next** to proceed to the
    Disk Image selection screen in [Figure 8-25](ch08.html#selecting_a_disk_image
    "Figure 8-25. Selecting a disk image").
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 配置完QEMU二进制文件和RAM后，点击**下一步**进入[图8-25](ch08.html#selecting_a_disk_image "图8-25.
    选择磁盘镜像")所示的磁盘镜像选择界面。
- en: '![Selecting a disk image](httpatomoreillycomsourcenostarchimages2209107.png.jpg)'
  id: totrans-194
  prefs: []
  type: TYPE_IMG
  zh: '![选择磁盘镜像](httpatomoreillycomsourcenostarchimages2209107.png.jpg)'
- en: Figure 8-25. Selecting a disk image
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 图8-25. 选择磁盘镜像
- en: Click the **Browse** button to locate and choose your IOS-XRv *.vmdk* image
    file. I’ve selected a disk image named *iosxrv-k9-demo-5.2.2.vmdk*.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**浏览**按钮以定位并选择你的IOS-XRv *.vmdk*镜像文件。我选择了一个名为*iosxrv-k9-demo-5.2.2.vmdk*的磁盘镜像文件。
- en: When you’re done selecting your image, click **Finish** to close the wizard.
    Next, select your newly created IOS-XRv device and click **Edit**. Select the
    **Network** tab and increase the number of adapters to **4**. Click **OK** to
    close the window and then click **Apply** and **OK** to commit the change. You
    can set the number of adapters to whatever best suits your needs, but four should
    be suitable for most GNS3 projects.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 选择完镜像后，点击**完成**以关闭向导。接下来，选择你刚创建的IOS-XRv设备并点击**编辑**。选择**网络**标签，增加适配器数量至**4**。点击**确定**关闭窗口，然后点击**应用**和**确定**以提交更改。你可以根据需要设置适配器数量，但四个适配器对于大多数GNS3项目来说应该是足够的。
- en: Creating a Simple IOS-XR Project
  id: totrans-198
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建一个简单的IOS-XR项目
- en: Cisco IOS-XR is very IOS-like, but it’s not IOS. In this section, you’ll configure
    a simple project using one Dynamips router and one IOS-XRv device, shown in [Figure 8-26](ch08.html#simple_ios-xrv_project
    "Figure 8-26. A simple IOS-XRv project").
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: Cisco IOS-XR非常像IOS，但它并不是IOS。在本节中，你将使用一个Dynamips路由器和一个IOS-XRv设备配置一个简单的项目，如[图8-26](ch08.html#simple_ios-xrv_project
    "图8-26. 一个简单的IOS-XRv项目")所示。
- en: '![A simple IOS-XRv project](httpatomoreillycomsourcenostarchimages2209109.png)'
  id: totrans-200
  prefs: []
  type: TYPE_IMG
  zh: '![一个简单的IOS-XRv项目](httpatomoreillycomsourcenostarchimages2209109.png)'
- en: Figure 8-26. A simple IOS-XRv project
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 图8-26. 一个简单的IOS-XRv项目
- en: You’ll use EIGRP to advertise three networks from router R1 to the IOS-XRv1
    device. Finally, you’ll verify the routes using some IOS-XR commands. This is
    only a basic introduction to IOS-XR. If you truly want to learn IOS-XR, you’ll
    have to dig deep into Cisco’s documentation.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 你将使用EIGRP从路由器R1广告三个网络到IOS-XRv1设备。最后，你将使用一些IOS-XR命令验证路由。这只是对IOS-XR的一个基础介绍。如果你想真正学习IOS-XR，你需要深入研究Cisco的文档。
- en: Configuring the Router
  id: totrans-203
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 配置路由器
- en: Begin by configuring router R1\. Configure an IP address on the Ethernet interface
    that’s linked to IOS-XRv1.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 首先配置路由器R1。为与IOS-XRv1相连的以太网接口配置一个IP地址。
- en: '[PRE20]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Next, configure the three IP addresses on router R1’s loopback interfaces.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，配置路由器R1环回接口上的三个IP地址。
- en: '[PRE21]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: These addresses will be advertised to your IOS-XRv1 device using EIGRP. Finally,
    configure EIGRP and advertise all the networks.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 这些地址将通过EIGRP广告到你的IOS-XRv1设备。最后，配置EIGRP并广告所有网络。
- en: '[PRE22]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: After you’ve finished configuring router R1, configure the IOS-XR device.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 配置完路由器R1后，配置IOS-XR设备。
- en: Configuring the IOS-XR Device
  id: totrans-211
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 配置IOS-XR设备
- en: Log on to IOS-XRv1 and create a similar configuration to the one you created
    on router R1\. You’ll configure an IP address and enable EIGRP to allow IOS-XRv1
    and router R1 to exchange routing information.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 登录到IOS-XRv1，并创建一个与在路由器R1上创建的配置类似的配置。你将配置一个IP地址，并启用EIGRP，以便IOS-XRv1和路由器R1可以交换路由信息。
- en: '[PRE23]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: The first notable difference between IOS and IOS-RX is the command prompt. The
    IOS-XRv1 command prompt ➊ indicates that your context is the first route processor
    (RP/0/0/CPU0). Because this is a demo version of IOS-XRv, it’s limited to this
    single route processor.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: IOS与IOS-XR之间的第一个显著区别是命令提示符。IOS-XRv1的命令提示符 ➊ 表示你的上下文是第一个路由处理器（RP/0/0/CPU0）。由于这是IOS-XRv的演示版本，因此它仅限于这个单一的路由处理器。
- en: Next, when an IP address is configured on an Ethernet interface, you have to
    specify the family of the IP address you’re using (IPv4 or IPv6), and the subnet
    mask is represented in CIDR notation (/24) ➋. Similarly, you have to specify IPv4
    or IPv6 when configuring the EIGRP route process ➌. Lastly, you advertise networks
    by placing an IP-configured interface under the EIGRP route process ➍. When you’re
    done, be sure to commit your changes ➎.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，当在以太网接口上配置IP地址时，必须指定你使用的IP地址的类型（IPv4或IPv6），并且子网掩码以CIDR表示法（/24）表示 ➋。类似地，在配置EIGRP路由进程时，也需要指定IPv4或IPv6
    ➌。最后，通过将已配置IP的接口放入EIGRP路由进程中来广播网络 ➍。完成后，确保提交你的更改 ➎。
- en: 'Once you’ve configured everything, enter the `show eigrp neighbors` command,
    and you should see this output:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你配置完所有内容，输入`show eigrp neighbors`命令，你应该会看到以下输出：
- en: '[PRE24]'
  id: totrans-217
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: In a correct configuration, an EIGRP neighbor adjacency will form with router
    R1 at IP address 10.1.1.1 ➊ from interface Gi0/0/0/0 ➋.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 在正确的配置下，EIGRP邻居关系将与IP地址为10.1.1.1的路由器R1建立邻接 ➊，并来自接口Gi0/0/0/0 ➋。
- en: Now, verify that all the 172.16.0.0 networks have been advertised from router
    R1 to IOS-XRv1 using the `show route` command.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，使用`show route`命令验证所有172.16.0.0网络是否已经从路由器R1广播到IOS-XRv1。
- en: '[PRE25]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: All of the 172.16.0.0 networks have been successfully added to the IOS-XR routing
    table ➊. You can test connectivity by pinging one of the addresses.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 所有的172.16.0.0网络已经成功添加到IOS-XR路由表中 ➊。你可以通过ping其中一个地址来测试连接性。
- en: '[PRE26]'
  id: totrans-222
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Here, the ping was 100 percent successful ➊. Now, save the configuration.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，ping测试是100%成功的 ➊。现在，保存配置。
- en: '[PRE27]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: By now it should be obvious that IOS-XR is a little different from traditional
    IOS, but it’s also similar. IOS-XRv is a reliable platform, and it’s a lot of
    fun to play with in GNS3\. Perhaps someday Cisco will port a version of IOS-XR
    from their carrier class routers down to their smaller commercial routers. If
    so, practicing with IOS-XRv in GNS3 will help prepare you for it.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，应该很明显，IOS-XR与传统的IOS有些不同，但也有相似之处。IOS-XRv是一个可靠的平台，并且在GNS3中玩起来非常有趣。或许有一天，思科会将IOS-XR的一个版本从它们的运营商级路由器移植到更小型的商业路由器上。如果那样的话，在GNS3中练习IOS-XRv将有助于为此做准备。
- en: Final Thoughts
  id: totrans-226
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 最后的思考
- en: Using GNS3, you can quickly become proficient at configuring and installing
    ASA firewalls. Having worked with Cisco gear for more than a decade, I’ve learned
    that ASAs are rock solid and work great for small network installations. Understanding
    how to configure the ASA is a must for anyone involved in small business networking.
    They’re one of the few nonenterprise Cisco products that are reasonably priced,
    feature rich, and easy to install.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 使用GNS3，你可以迅速掌握配置和安装ASA防火墙的技能。我从事思科设备工作已有十多年，我了解到ASAs非常稳定，并且非常适合小型网络安装。对于任何从事小型企业网络工作的人来说，了解如何配置ASA是必不可少的。它们是少数几个价格合理、功能丰富且易于安装的非企业级思科产品之一。
- en: Using ASDM, you can quickly configure an ASA to allow remote users to connect
    to their corporate networks through an IPSec VPN. Several cross-platform VPN clients
    are compatible with Cisco ASAs and routers; OS X has a built-in Cisco VPN client.
    On Windows, you have to install the Cisco VPN Client or Cisco AnyConnect software.
    On Linux, you can use Virtual Private Network Connection (VPNC), which works great.
    I use VPNC on a daily basis with Linux to access VPNs all across the country.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 使用ASDM，你可以快速配置ASA，允许远程用户通过IPSec VPN连接到他们的企业网络。许多跨平台的VPN客户端都兼容思科的ASA和路由器；OS X内置了思科VPN客户端。在Windows上，你需要安装思科VPN客户端或思科AnyConnect软件。在Linux上，你可以使用Virtual
    Private Network Connection（VPNC），它工作得非常好。我每天在Linux上使用VPNC访问全国各地的VPN。
- en: In the next chapter, you’ll look at Cisco IOU and learn how to integrate IOU
    devices into GNS3 projects. It’s an exciting new advancement that broadens the
    future of GNS3.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，你将学习Cisco IOU，并了解如何将IOU设备集成到GNS3项目中。这是一个令人兴奋的新进展，拓宽了GNS3的未来。
