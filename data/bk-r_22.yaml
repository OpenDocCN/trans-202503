- en: '**18**'
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**18**'
- en: '**HYPOTHESIS TESTING**'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '**假设检验**'
- en: '![image](../images/common-01.jpg)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/common-01.jpg)'
- en: In this chapter, you’ll build on your experience with confidence intervals and
    sampling distributions to make more formal statements about the value of a true,
    unknown parameter of interest. For this, you’ll learn about frequentist *hypothesis
    testing*, where a probability from a relevant sampling distribution is used as
    evidence against some claim about the true value. When a probability is used in
    this way, it is referred to as a *p*-value. In this chapter, I talk about interpreting
    results for relatively basic statistics, but you can apply the same concepts to
    statistics arising from more complicated methods (such as regression modeling
    in [Chapter 19](ch19.xhtml#ch19)).
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你将基于你在置信区间和抽样分布方面的经验，进一步正式阐述一个真实未知参数的值。为此，你将学习频率派的*假设检验*，通过使用来自相关抽样分布的概率作为反对某个关于真实值的主张的证据。当以这种方式使用概率时，它被称为*p*-值。在本章中，我讲解了如何解释相对基础的统计结果，但你可以将相同的概念应用于更复杂方法（如回归建模，[第19章](ch19.xhtml#ch19)）中的统计数据。
- en: '**18.1 Components of a Hypothesis Test**'
  id: totrans-4
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**18.1 假设检验的组成部分**'
- en: To give you an example of hypothesis testing, suppose I told you that 7 percent
    of a certain population was allergic to peanuts. You then randomly selected 20
    individuals from that population and found that 18 of them were allergic to peanuts.
    Assuming your sample was unbiased and truly reflective of the population, what
    would you then think about my claim that the true proportion of allergic individuals
    is 7 percent?
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 举个假设检验的例子，假设我告诉你某个特定人群中有7%的人对花生过敏。然后，你从该人群中随机选择了20个人，发现其中18人对花生过敏。如果假设你的样本没有偏差，且真正反映了整个群体，那么你会如何看待我声称过敏人群比例为7%的说法？
- en: Naturally, you would doubt the correctness of my claim. In other words, there
    is such a small probability of observing 18 or more successes out of 20 trials
    for a set success rate of 0.07 that you can state that you have statistical evidence
    against the claim that the true rate is 0.07\. Indeed, when defining *X* as the
    number of allergic individuals out of 20 by assuming *X* ∼ BIN(20,0.07), evaluating
    Pr(*X* ≥ 18) gives you the precise *p*-value, which is tiny.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 自然地，你会怀疑我的说法的正确性。换句话说，如果假设成功率为0.07，那么从20次试验中观察到18次或更多成功的概率非常小，足以说明你有统计证据反对我的说法，即真实的过敏率为0.07。事实上，当将*X*定义为20个样本中过敏个体的数量，并假设*X*
    ∼ BIN(20,0.07)，通过评估Pr(*X* ≥ 18)，你将得到一个非常小的*p*-值。
- en: '[PRE0]'
  id: totrans-7
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: This *p*-value represents the probability of observing the results in your sample,
    *X* = 18, or a more extreme outcome (*X* = 19 or *X* = 20), if the chance of success
    was truly 7 percent.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 这个*p*-值代表的是在你的样本中观察到结果的概率，*X* = 18，或更极端的结果（*X* = 19 或 *X* = 20），如果成功的机会真的为7%。
- en: Before looking at specific hypothesis tests and their implementation in R, this
    section will introduce terminology that you’ll come across often in the reporting
    of such tests.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在查看具体的假设检验及其在R中的实现之前，本节将介绍一些术语，这些术语是你在报告此类检验时经常会遇到的。
- en: '***18.1.1 Hypotheses***'
  id: totrans-10
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***18.1.1 假设***'
- en: As the name would suggest, in hypothesis testing, formally stating a claim and
    the subsequent hypothesis test is done with a *null* and an *alternative* hypothesis.
    The null hypothesis is interpreted as the *baseline* or *no-change* hypothesis
    and is the claim that is assumed to be true. The alternative hypothesis is the
    conjecture that you’re testing for, against the null hypothesis.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 正如其名称所示，在假设检验中，正式陈述一个主张以及随后的假设检验是通过*零假设*和*备择假设*来完成的。零假设被解释为*基线*或*无变化*的假设，是被假定为真的主张。备择假设是你要检验的假设，它与零假设相对立。
- en: 'In general, null and alternative hypotheses are denoted H[0] and H[A], respectively,
    and they are written as follows:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，零假设和备择假设分别用H[0]和H[A]表示，它们的写法如下：
- en: 'H[0] : . . .'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[0] : . . .'
- en: 'H[A] : . . .'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[A] : . . .'
- en: The null hypothesis is often (but not always) defined as an equality, =, to
    a null value. Conversely, the alternative hypothesis (the situation you’re testing
    for) is often defined in terms of an inequality to the null value.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 原假设通常（但并不总是）被定义为等式 =，与零值相等。相反，备择假设（即你正在检验的情况）通常被定义为与零值的不等式。
- en: • When H[A] is defined in terms of a less-than statement, with <, it is *one-sided*;
    this is also called a *lower-tailed test*.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: • 当H[A]以小于符号<定义时，它是*单尾*的；这也被称为*左尾检验*。
- en: • When H[A] is defined in terms of a greater-than statement, with >, it is *one-sided*;
    this is also called an *upper-tailed test*.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: • 当H[A]通过“大于”声明（>）定义时，这是*单尾*的；这也称为*上尾检验*。
- en: • When H[A] is merely defined in terms of a different-to statement, with ≠,
    it is *two-sided*; this is also called a *two-tailed test*.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: • 当H[A]仅通过“不等于”声明（≠）定义时，这是*双尾*的；这也称为*双尾检验*。
- en: These test variants are entirely situation specific and depend upon the problem
    at hand.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 这些测试变体完全是特定于情况的，取决于当前面临的问题。
- en: '***18.1.2 Test Statistic***'
  id: totrans-20
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***18.1.2 测试统计量***'
- en: Once the hypotheses are formed, sample data are collected, and statistics are
    calculated according to the parameters detailed in the hypotheses. The *test statistic*
    is the statistic that’s compared to the appropriate standardized sampling distribution
    to yield the *p*-value.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦假设形成，样本数据被收集，并根据假设中详细描述的参数计算统计量。*测试统计量*是与适当的标准化采样分布进行比较的统计量，用以得出*p*-值。
- en: A test statistic is typically a standardized or rescaled version of the sample
    statistic of interest. The distribution and extremity (that is, distance from
    zero) of the test statistic are the sole drivers of the smallness of the *p*-value
    (which indicates the strength of the evidence against the null hypothesis—see
    [Section 18.1.3](ch18.xhtml#ch18lev2sec155)). Specifically, the test statistic
    is determined by both the difference between the original sample statistic and
    the null value and the standard error of the sample statistic.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 测试统计量通常是所关注的样本统计量的标准化或重新缩放版本。测试统计量的分布和极端性（即与零的距离）是决定*p*-值小的唯一因素（*p*-值表示反对原假设的证据强度——详见[第18.1.3节](ch18.xhtml#ch18lev2sec155)）。具体来说，测试统计量由原始样本统计量与原假设值之间的差异以及样本统计量的标准误差共同决定。
- en: '***18.1.3 p-value***'
  id: totrans-23
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***18.1.3 p值***'
- en: The *p*-value is the probability value that’s used to quantify the amount of
    evidence, if any, against the null hypothesis. More formally, the *p*-value is
    found to be the probability of observing the test statistic, or something more
    extreme, assuming the null hypothesis is true.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '*p*-值是用于量化证据量的概率值，用来衡量是否有证据反对原假设。如果更正式地说，*p*-值是指在假设原假设为真的情况下，观察到测试统计量或更极端情况的概率。'
- en: 'The exact nature of calculating a *p*-value is dictated by the type of statistics
    being tested and the nature of H[A]. In reference to this, you’ll see the following
    terms:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 计算*p*-值的确切方式取决于所测试的统计量类型和H[A]的性质。关于这一点，你将看到以下术语：
- en: • A lower-tailed test implies the *p*-value is a left-hand tail probability
    from the sampling distribution of interest.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: • 下尾检验意味着*p*-值是来自所关注采样分布的左尾概率。
- en: • For an upper-tailed test, the *p*-value is a right-hand tail probability.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: • 对于上尾检验，*p*-值是右尾概率。
- en: • For a two-sided test, the *p*-value is the sum of a left-hand tail probability
    and right-hand tail probability. When the sampling distribution is symmetric (for
    example, normal or *t*, as in all examples coming up in [Sections 18.2](ch18.xhtml#ch18lev1sec55)
    and [18.3](ch18.xhtml#ch18lev1sec56)), this is equivalent to two times the area
    in one of those tails.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: • 对于双尾检验，*p*-值是左尾概率和右尾概率的总和。当采样分布是对称的（例如，正态分布或*t*分布，如[第18.2节](ch18.xhtml#ch18lev1sec55)和[第18.3节](ch18.xhtml#ch18lev1sec56)中的所有示例所示），这等同于两倍于其中一条尾部的面积。
- en: Put simply, the more extreme the test statistic, the smaller the *p*-value.
    The smaller the *p*-value, the greater the amount of statistical evidence against
    the assumed truth of H[0].
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 简单来说，测试统计量越极端，*p*-值越小。*p*-值越小，反对原假设H[0]的统计证据越强。
- en: '***18.1.4 Significance Level***'
  id: totrans-30
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***18.1.4 显著性水平***'
- en: For every hypothesis test, a *significance level*, denoted *α*, is assumed.
    This is used to qualify the result of the test. The significance level defines
    a cutoff point, at which you decide whether there is sufficient evidence to view
    H[0] as incorrect and favor H[A] instead.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 对于每个假设检验，假定一个*显著性水平*，记作*α*。这个值用于判定测试结果的显著性。显著性水平定义了一个临界点，用来决定是否有足够的证据认为H[0]是错误的，并支持H[A]。
- en: • If the *p*-value is greater than or equal to *α*, then you conclude there
    is insufficient evidence against the null hypothesis, and therefore you *retain*
    H[0] when compared to H[A].
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: • 如果*p*-值大于或等于*α*，那么你得出结论，无法反对原假设，因此你在与H[A]比较时*保留*H[0]。
- en: • If the *p*-value is less than *α*, then the result of the test is *statistically
    significant*. This implies there is sufficient evidence against the null hypothesis,
    and therefore you *reject* H[0] in favor of H[A].
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: • 如果 *p*-值小于 *α*，那么测试结果是 *统计显著的*。这意味着反对原假设的证据充分，因此你 *拒绝* H[0]，支持 H[A]。
- en: Common or conventional values of *α* are *α* = 0.1, *α* = 0.05, and *α* = 0.01.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 常见或传统的 *α* 值包括 *α* = 0.1，*α* = 0.05，和 *α* = 0.01。
- en: '***18.1.5 Criticisms of Hypothesis Testing***'
  id: totrans-35
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***18.1.5 假设检验的批评***'
- en: The terminology just presented becomes easier to understand once you look at
    some examples in the upcoming sections. However, even at this early stage, it’s
    important to recognize that hypothesis testing is susceptible to justifiable criticism.
    The end result of any hypothesis test is to either retain or reject the null hypothesis,
    a decision that is solely dependent upon the rather arbitrary choice of significance
    level *α*; this is most often simply set at one of the conventionally used values.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 当你查看接下来的章节中的一些例子时，上述术语会变得更容易理解。然而，即使在这一早期阶段，认识到假设检验是容易受到合理批评的也很重要。任何假设检验的最终结果要么是保留原假设，要么是拒绝原假设，而这一决定完全依赖于一个相当随意的显著性水平
    *α* 的选择；通常，这个值就是传统使用的某个数值。
- en: Before you begin looking at examples, it is also important to note that a *p*-value
    never provides “proof” of either H[0] or H[A] being truly correct. It can only
    ever quantify evidence against the null hypothesis, which one rejects given a
    sufficiently small *p*-value < *α*. In other words, rejecting a null hypothesis
    is not the same as disproving it. Rejecting H[0] merely implies that the sample
    data suggest H[A] ought to be preferred, and the *p*-value merely indicates the
    strength of this preference.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在你开始查看例子之前，同样重要的是要注意，*p*-值从来不能提供 H[0] 或 H[A] 真的正确的“证据”。它只能量化反对原假设的证据，当 *p*-值小于
    *α* 时，可以拒绝原假设。换句话说，拒绝原假设并不等于证明它是错误的。拒绝 H[0] 仅仅意味着样本数据表明应该更倾向于 H[A]，而 *p*-值仅表示这种倾向的强度。
- en: In recent years, there has been a push against emphasizing these aspects of
    statistical inference in some introductory statistics courses owing at least in
    part to the overuse, and even misuse, of *p*-values in some areas of applied research.
    A particularly good article by Sterne and Smith ([2001](ref.xhtml#ref63)) discusses
    the role of, and problems surrounding, hypothesis testing from the point of view
    of medical research. Another good reference is Reinhart ([2015](ref.xhtml#ref53)),
    which discusses common misinterpretations of *p*-values in statistics.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 近年来，由于在某些应用研究领域过度使用甚至误用 *p*-值，部分入门统计学课程开始反对过度强调统计推断的这些方面。Sterne 和 Smith（[2001](ref.xhtml#ref63)）的一篇特别好的文章从医学研究的角度讨论了假设检验的作用及其相关问题。另一个不错的参考文献是
    Reinhart（[2015](ref.xhtml#ref53)），它讨论了统计学中对 *p*-值的常见误解。
- en: That being said, probabilistic inference with respect to sampling distributions
    is, and will always remain, a cornerstone of frequentist statistical practice.
    The best way to improve the use and interpretation of statistical tests and modeling
    is with a sound introduction to the relevant ideas and methods so that, from the
    outset, you understand statistical significance and what it can and cannot tell
    you.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管如此，关于抽样分布的概率推断是，且永远将是，频率统计实践的基石。提高统计测试和建模使用及解释的最佳方式是通过对相关思想和方法的合理介绍，这样从一开始你就能理解统计显著性及其能告诉你和不能告诉你的内容。
- en: '**18.2 Testing Means**'
  id: totrans-40
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**18.2 测试方法**'
- en: The validity of hypothesis tests involving sample means is dependent upon the
    same assumptions and conditions mentioned in [Section 17.1.1](ch17.xhtml#ch17lev2sec146).
    In particular, throughout this section you should assume that the central limit
    theorem holds, and if the sample sizes are small (in other words, roughly less
    than 30), the raw data are normally distributed. You’ll also focus on examples
    where the sample standard deviation *s* is used to estimate the true standard
    deviation, *σ*[*X*], because this is the most common situation you’ll encounter
    in practice. Again, mirroring [Section 17.1.1](ch17.xhtml#ch17lev2sec146), this
    means you need to use the *t*-distribution instead of the normal distribution
    when calculating the critical values and *p*-values.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 涉及样本均值的假设检验的有效性依赖于[第17.1.1节](ch17.xhtml#ch17lev2sec146)中提到的相同假设和条件。特别是，在本节中，你应该假设中心极限定理成立，并且如果样本量较小（换句话说，大约小于30），原始数据是正态分布的。你还将重点关注使用样本标准差*s*来估计真实标准差*σ*[*X*]的例子，因为这是你在实践中最常遇到的情况。同样，参照[第17.1.1节](ch17.xhtml#ch17lev2sec146)，这意味着在计算临界值和*p*-值时，你需要使用*t*-分布而不是正态分布。
- en: '***18.2.1 Single Mean***'
  id: totrans-42
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***18.2.1 单一均值***'
- en: As you’ve already met the standard error formula, ![image](../images/f0379-01.jpg),
    and the R functionality needed to obtain quantiles and probabilities from the
    *t*-distribution (`qt` and `pt`), the only new concepts to introduce here are
    related to the definition of the hypotheses themselves and the interpretation
    of the result.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 由于你已经接触过标准误差公式，![image](../images/f0379-01.jpg)，以及需要使用的R功能来从*t*-分布中获得分位数和概率（`qt`和`pt`），这里唯一需要引入的新概念是关于假设本身的定义以及结果的解释。
- en: '**Calculation: One-Sample t-Test**'
  id: totrans-44
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**计算：单样本 t 检验**'
- en: 'Let’s dive straight into an example—a one-sample *t*-test. Recall the problem
    in [Section 16.2.2](ch16.xhtml#ch16lev2sec142) where a manufacturer of a snack
    was interested in the mean net weight of contents in an advertised 80-gram pack.
    Say that a consumer calls in with a complaint—over time they have bought and precisely
    weighed the contents of 44 randomly selected 80-gram packs from different stores
    and recorded the weights as follows:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们直接进入一个例子——单样本*t*-检验。回想一下在[第16.2.2节](ch16.xhtml#ch16lev2sec142)中的问题，其中某零食生产商对广告中80克包装的内容物净重均值感兴趣。假设有消费者打电话投诉——他们在一段时间内购买并精确称量了44个随机选择的80克包装（来自不同商店），并记录了以下重量：
- en: '[PRE1]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: The customer claims that they’ve been shortchanged because their data cannot
    have arisen from a distribution with mean *μ* = 80, so the true mean weight must
    be less than 80\. To investigate this claim, the manufacturer conducts a hypothesis
    test using a significance level of *α* = 0.05.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 客户声称他们被少给了，因为他们的数据不能来自均值为*μ* = 80的分布，因此真实的均值必须小于80。为了调查这一主张，制造商使用显著性水平*α* =
    0.05进行假设检验。
- en: 'First, the hypotheses must be defined, with a null value of 80 grams. Remember,
    the alternative hypothesis is “what you’re testing for”; in this case, H[A] is
    that *μ* is smaller than 80\. The null hypothesis, interpreted as “no change,”
    will be defined as *μ* = 80: that the true mean is in fact 80 grams. These hypotheses
    are formalized like this:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，必须定义假设，零假设为80克。记住，备择假设是“你所要检验的内容”；在本例中，H[A]是*μ*小于80。零假设，解释为“没有变化”，将定义为*μ*
    = 80：即真实的均值实际上是80克。这些假设形式化如下：
- en: '![image](../images/e18-1.jpg)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e18-1.jpg)'
- en: Second, the mean and standard deviation must be estimated from the sample.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 其次，必须从样本中估计均值和标准差。
- en: '[PRE2]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The question your hypotheses seek to answer is this: given the estimated standard
    deviation, what’s the probability of observing a sample mean (when *n* = 44) of
    78.91 grams or less if the true mean is 80 grams? To answer this, you need to
    calculate the relevant test statistic.'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 你的假设所要回答的问题是：在估计的标准差下，如果真实均值为80克，那么观察到样本均值（当*n* = 44）为78.91克或更低的概率是多少？为了回答这个问题，你需要计算相关的检验统计量。
- en: Formally, the test statistic *T* in a hypothesis test for a single mean with
    respect to a null value of *μ*[0] is given as
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 在假设检验中，对于单一均值相对于零假设值*μ*[0]的检验统计量*T*正式表示为：
- en: '![image](../images/e18-2.jpg)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e18-2.jpg)'
- en: based on a sample of size *n*, a sample mean of *x̄*, and a sample standard
    deviation of *s* (the denominator is the estimated standard error of the mean).
    Assuming the relevant conditions have been met, *T* follows a *t*-distribution
    with *ν* = *n* − 1 degrees of freedom.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 基于大小为 *n* 的样本，样本均值为 *x̄*，样本标准差为 *s*（分母是均值的估计标准误）。假设相关条件已满足，*T* 服从自由度为 *ν* =
    *n* − 1 的 *t* 分布。
- en: 'In R, the following provides you with the standard error of the sample mean
    for the snacks data:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在 R 中，以下代码可以为零食数据提供样本均值的标准误：
- en: '[PRE3]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Then, *T* can be calculated as follows:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，*T* 可以按以下方式计算：
- en: '[PRE4]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Finally, the test statistic is used to obtain the *p*-value. Recall that the
    *p*-value is the probability that you observe *T* or something more extreme. The
    nature of “more extreme” is determined by the alternative hypothesis H[A], which,
    as a less-than statement, directs you to find a left-hand, lower-tail probability
    as the *p*-value. In other words, the *p*-value is provided as the area under
    the sampling distribution (a *t*-distribution with 43 df in the current example)
    to the left of a vertical line at *T*. From [Section 16.2.3](ch16.xhtml#ch16lev2sec143),
    this is easily done, as shown here:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，检验统计量用于获得 *p*-值。回想一下，*p*-值是观察到 *T* 或更极端值的概率。 “更极端”的性质由备择假设 H[A] 决定，作为一个小于的声明，它引导你找到一个左尾的、下侧概率作为
    *p*-值。换句话说，*p*-值是作为样本分布下方的面积（当前例中是自由度为 43 的 *t* 分布）在 *T* 的垂直线左侧的面积。从[第16.2.3节](ch16.xhtml#ch16lev2sec143)可以轻松完成此操作，如下所示：
- en: '[PRE5]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Your result states that if the H[0] were true, there would be only a little
    more than a 1 percent chance that you’d observe the customer’s sample mean of
    *x̄* = 78.91, or less, as a random phenomenon. Since this *p*-value is smaller
    than the predefined significance level of *α* = 0.05, the manufacturer concludes
    that there is sufficient evidence to reject the null hypothesis in favor of the
    alternative, suggesting the true value of *μ* is in fact less than 80 grams.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 你的结果表明，如果零假设 H[0] 为真，那么观察到客户样本均值 *x̄* = 78.91 或更小的概率仅有 1% 多一点。由于这个 *p*-值小于预定义的显著性水平
    *α* = 0.05，制造商得出结论，足够的证据可以拒绝零假设，支持备择假设，表明真实的 *μ* 值实际上小于 80 克。
- en: Note that if you find the corresponding 95 percent CI for the single sample
    mean, as described in [Section 17.2.1](ch17.xhtml#ch17lev2sec149) and given by
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，如果你找到单样本均值的相应 95% CI，如[第17.2.1节](ch17.xhtml#ch17lev2sec149)所描述并给出：
- en: '[PRE6]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: it does *not* include the null value of 80, mirroring the result of the hypothesis
    test at the 0.05 level.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 它*不*包括零假设值 80，这与在 0.05 水平下的假设检验结果一致。
- en: '**R Function: t.test**'
  id: totrans-66
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**R 函数：t.test**'
- en: The result of the one-sample *t*-test can also be found with the built-in `t.test`
    function.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 单样本的 *t*-检验结果也可以通过内置的`t.test`函数找到。
- en: '[PRE7]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The function takes the raw data vector as `x`, the null value for the mean
    as `mu`, and the direction of the test (in other words, how to find the *p*-value
    under the appropriate *t*-curve) as `alternative`. The `alternative` argument
    has three available options: `"less"` for H[A] with <; `"greater"` for H[A] with
    >; and `"two.sided"` for H[A] with ≠. The default value of *α* is 0.05\. If you
    want a different significance level than 0.05, this must be provided to `t.test`
    as 1 − *α*, passed to the argument `conf.level`.'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 该函数将原始数据向量作为 `x`，均值的零假设值作为 `mu`，以及检验的方向（即如何在适当的 *t* 曲线下找到 *p*-值）作为 `alternative`。`alternative`
    参数有三种可用选项：“`less`” 表示 H[A] 小于；“`greater`” 表示 H[A] 大于；“`two.sided`” 表示 H[A] 不等于。*α*
    的默认值为 0.05。如果你想要不同于 0.05 的显著性水平，必须将 1 − *α* 传递给 `t.test` 的 `conf.level` 参数。
- en: Note that the value of *T* is reported in the output of `t.test`, as are the
    degrees of freedom and the *p*-value. You also get a 95 percent “interval,” but
    its values of `-Inf` and `79.68517` do not match the interval calculated just
    a moment ago. The manually calculated interval is in fact a two-sided interval—a
    bounded interval formed by using an error component that’s equal on both sides.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，*T* 的值会在 `t.test` 的输出中报告，同时还包括自由度和 *p*-值。你还会得到一个 95% 的“区间”，但其值 `-Inf` 和 `79.68517`
    与之前手动计算的区间不匹配。手动计算的区间实际上是一个双侧区间——一个使用等量误差组件的有界区间。
- en: The CI in the `t.test` output, on the other hand, takes instruction from the
    `alternative` argument. It provides a *one-sided confidence bound*. For a lower-tailed
    test, it provides an upper bound on the statistic such that the entire lower-tail
    area of the sampling distribution of interest is 0.95, as opposed to a *central*
    area as the traditional two-sided interval does. One-sided bounds are less frequently
    used than the fully bounded two-sided interval, which can be obtained (as the
    component `conf.int`) from a relevant call to `t.test` by setting `alternative="two.sided"`.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '`t.test` 输出中的置信区间，则根据`alternative`参数进行设置。它提供了*单侧置信界限*。对于下尾检验，它提供了统计量的上界，使得兴趣的采样分布的整个下尾区域为0.95，而传统的双侧区间则是*中心*区域。单侧界限的使用频率低于完全界定的双侧区间，该区间可以通过相关调用`t.test`并设置`alternative="two.sided"`来获得（作为组件`conf.int`）。'
- en: '[PRE8]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: This result matches your manually computed version from earlier. Note also that
    the corresponding confidence level, 1 − *α*, is stored alongside this component
    as an attribute (refer to [Section 6.2.1](ch06.xhtml#ch06lev2sec59)).
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 这个结果与之前手动计算的版本一致。还要注意，相应的置信水平1 − *α*作为一个属性与该组件一起存储（参见[第6.2.1节](ch06.xhtml#ch06lev2sec59)）。
- en: In examining the result for the snack example, with a *p*-value of around 0.011,
    remember to be careful when interpreting hypothesis tests. With *α* set at 0.05
    for this particular test, H[0] is rejected. But what if the test were carried
    out with *α* = 0.01? The *p*-value is greater than 0.01, so in that case, H[0]
    would be retained, for no reason other than the arbitrary movement of the value
    of *α*. In these situations, it’s helpful to comment on the perceived strength
    of the evidence against the null hypothesis. For the current example, you could
    reasonably state that there exists some evidence to support H[A] but that this
    evidence is not especially strong.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在检查零食例子的结果时，*p*-值约为0.011，请记住在解释假设检验时要小心。对于此特定检验，当*α*设置为0.05时，H[0]被拒绝。但如果检验是在*α*
    = 0.01下进行的呢？*p*-值大于0.01，所以在那种情况下，H[0]将被保留，仅仅因为*α*值的任意变化。在这些情况下，帮助对反对原假设的证据的强度进行评论会很有帮助。对于当前的例子，你可以合理地认为存在某些证据支持H[A]，但这些证据并不特别强。
- en: '**Exercise 18.1**'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '**练习 18.1**'
- en: Adult domestic cats of a certain breed are said to have an average weight of
    3.5 kilograms. A feline enthusiast disagrees and collects a sample of 73 weights
    of cats of this breed. From her sample, she calculates a mean of 3.97 kilograms
    and a standard deviation of 2.21 kilograms. Perform a hypothesis test to test
    her claim that the true mean weight *μ* is *not* 3.5 kilograms by setting up the
    appropriate hypothesis, carrying out the analysis, and interpreting the *p*-value
    (assume the significance level is *α* = 0.05).
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 某些品种的成年家猫据说平均体重大约为3.5千克。一位猫迷对此表示不同意见，并收集了73只该品种猫的体重样本。根据她的样本，她计算出平均体重为3.97千克，标准差为2.21千克。进行假设检验，以验证她关于真实平均体重*μ*不等于3.5千克的主张，设置适当的假设，进行分析，并解释*p*-值（假设显著性水平为*α*
    = 0.05）。
- en: Suppose it was previously believed that the mean magnitude of seismic events
    off the coast of Fiji is 4.3 on the Richter scale. Use the data in the `mag` variable
    of the ready-to-use `quakes` data set, providing 1,000 sampled seismic events
    in that area, to test the claim that the true mean magnitude is in fact *greater*
    than 4.3\. Set up appropriate hypotheses, use `t.test` (conduct the test at a
    significance level of *α* = 0.01), and draw a conclusion.
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 假设之前认为斐济海岸地震事件的平均震级为4.3里氏震级。使用现成的`quakes`数据集中`mag`变量的数据，该数据集提供了1000个该地区的地震事件样本，来检验真实震级是否确实*大于*4.3。设置适当的假设，使用`t.test`（在显著性水平*α*
    = 0.01下进行检验），并得出结论。
- en: Manually compute a two-sided confidence interval for the true mean of (b).
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 手动计算(b)部分真实均值的双侧置信区间。
- en: '***18.2.2 Two Means***'
  id: totrans-79
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***18.2.2 两个均值***'
- en: Often, testing a single sample mean isn’t enough to answer the question you’re
    interested in. In many settings, a researcher wants to directly compare the means
    of two distinct groups of measurements, which boils down to a hypothesis test
    for the true difference between two means; call them **μ[1]** and **μ[2]**.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，单一样本均值的检验不足以回答你关心的问题。在许多场景中，研究者希望直接比较两个不同组别的均值，这归结为对两个均值之间真实差异的假设检验；称它们为**μ[1]**和**μ[2]**。
- en: The way in which two groups of data relate to each other affects the specific
    form of standard error for the difference between two sample means and therefore
    the test statistic itself. The actual comparison of the two means, however, is
    often of the same nature—the typical null hypothesis is usually defined as **μ[1]**
    and **μ[2]** being equal. In other words, the null value of the difference between
    the two means is often zero.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 两组数据之间的关系影响两个样本均值差异的标准误差的具体形式，因此也影响检验统计量本身。然而，实际的均值比较通常具有相同的性质——典型的原假设通常定义为**μ[1]**和**μ[2]**相等。换句话说，两个均值之间差异的原假设值通常为零。
- en: '**Unpaired/Independent Samples: Unpooled Variances**'
  id: totrans-82
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**非配对/独立样本：非合并方差**'
- en: The most general case is where the two sets of measurements are based on two
    independent, separate groups (also referred to as *unpaired* samples). You compute
    the sample means and sample standard deviations of both data sets, define the
    hypotheses of interest, and then calculate the test statistic.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 最一般的情况是，两个数据集基于两个独立的、分开的组（也称为*非配对*样本）。你计算两个数据集的样本均值和样本标准差，定义感兴趣的假设，然后计算检验统计量。
- en: When you cannot assume the variances of the two populations are equal, then
    you perform the *unpooled* version of the two-sample *t*-test; this will be discussed
    first. If, however, you can safely assume equal variances, then you can perform
    a *pooled* two-sample *t*-test, which improves the precision of the results. You’ll
    look at the pooled version of the test in a moment.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 当你不能假设两个总体的方差相等时，就需要进行*非合并*版本的两样本*t*检验；这一部分将首先讨论。如果你能够安全地假设方差相等，那么你可以进行*合并*的两样本*t*检验，这样可以提高结果的精确度。稍后你将会看到合并版本的检验。
- en: For an unpooled example, return to the 80-gram snack packet example from [Section
    18.2.1](ch18.xhtml#ch18lev2sec158). After collecting a sample of 44 packs from
    the original manufacturer (label this sample size *n*[1]), the disgruntled consumer
    goes out and collects *n[2]* = 31 randomly selected 80-gram packs from a rival
    snack manufacturer. This second set of measurements is stored as `snacks2`.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 对于非合并的例子，回到[第18.2.1节](ch18.xhtml#ch18lev2sec158)中的80克零食包装示例。收集了原制造商44包零食样本（将此样本大小标记为*n*[1]），然后不满的消费者去收集了竞争对手零食制造商的*n[2]*
    = 31包随机选择的80克零食包装。第二组测量数据存储为`snacks2`。
- en: '[PRE9]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: From [Section 18.2.1](ch18.xhtml#ch18lev2sec158), you already know the mean
    and standard deviation of the first sample of size *n[1]* = 44—these are stored
    as `snack.mean` (around 78.91) and `snack.sd` (around 3.06), respectively—think
    of these as *x̄[1]* and *s*[1]. Compute the same quantities, *x̄[2]* and *s*[2],
    respectively, for the new data.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 从[第18.2.1节](ch18.xhtml#ch18lev2sec158)开始，你已经知道了第一个样本（大小为*n[1]* = 44）的均值和标准差——这些分别存储为`snack.mean`（大约78.91）和`snack.sd`（大约3.06）——可以把它们看作是*x̄[1]*和*s*[1]。现在计算新数据的相同量值，分别是*x̄[2]*和*s*[2]。
- en: '[PRE10]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Let the true mean of the original sample be denoted with **μ[1]** and the true
    mean of the new sample from the rival company packs be denoted with **μ[2]**.
    You’re now interested in testing whether there is statistical evidence to support
    the claim that **μ[2]** is greater than **μ[1]**. This suggests the hypotheses
    of H[0] : **μ[1]** = **μ[2]** and H[A] : **μ[1]** < **μ[2]**, which can be written
    as follows:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '设原始样本的真实均值用**μ[1]**表示，竞争对手公司包装的新样本的真实均值用**μ[2]**表示。现在，你关注的是测试是否有统计证据支持**μ[2]**大于**μ[1]**的说法。这意味着假设为H[0]
    : **μ[1]** = **μ[2]** 和 H[A] : **μ[1]** < **μ[2]**，可以写成如下形式：'
- en: 'H[0] : **μ[2]** − **μ[1]** = 0'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[0] : **μ[2]** − **μ[1]** = 0'
- en: 'H[A] : **μ[2]** − **μ[1]** > 0'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[A] : **μ[2]** − **μ[1]** > 0'
- en: That is, the difference between the true mean of the rival company packs and
    the original manufacturer’s packs, when the original is subtracted from the rival,
    is bigger than zero. The “no-change” scenario, the null hypothesis, is that the
    two means are the same, so their difference is truly zero.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 也就是说，竞争对手公司包装的真实均值与原制造商包装的均值之间的差异，当从竞争对手的均值中减去原制造商的均值时，结果大于零。“无变化”场景，即原假设，是两个均值相同，所以它们的差异为零。
- en: Now that you’ve constructed the hypotheses, let’s look at how to actually test
    them. The difference between two means is the quantity of interest. For two independent
    samples arising from populations with true means **μ[1]** and **μ[2]**, sample
    means *x̄[1]* and *x̄*[2], and sample standard deviations *s[1]* and *s*[2], respectively
    (and that meet the relevant conditions for the validity of the *t*-distribution),
    the standardized test statistic *T* for testing the difference between **μ[2]**
    and **μ[1]**, in that order, is given as
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经构建了假设，接下来我们来看如何实际检验它们。两个均值的差异是我们关注的量。对于来自具有真实均值**μ[1]**和**μ[2]**的总体的两个独立样本，样本均值*x̄[1]*和*x̄*[2]，样本标准差*s[1]*和*s*[2]*（并且满足*t*分布的有效性条件），检验**μ[2]**和**μ[1]**之间差异的标准化检验统计量*T*，按顺序给出如下：
- en: '![image](../images/e18-3.jpg)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e18-3.jpg)'
- en: whose distribution is approximated by a *t*-distribution with *ν* degrees of
    freedom, where
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 其分布可以近似为具有*ν*自由度的*t*分布，其中
- en: '![image](../images/e18-4.jpg)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e18-4.jpg)'
- en: In (18.3), *μ*[0] is the null value of interest—typically zero in tests concerned
    with “difference” statistics. This term would therefore disappear from the numerator
    of the test statistic. The denominator of *T* is the standard error of the difference
    between two means in this setting.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 在(18.3)中，*μ*[0]是感兴趣的零假设值——通常在“差异”统计量的检验中为零。因此，这一项将在检验统计量的分子中消失。*T*的分母是这种设置下两个均值差异的标准误。
- en: The └ · ┘ on the right of [Equation (18.4)](ch18.xhtml#ch18eq4) denotes a *floor*
    operation—rounding strictly down to the nearest integer.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '[方程(18.4)](ch18.xhtml#ch18eq4)右侧的└ · ┘表示一个*floor*操作——严格向下舍入到最接近的整数。'
- en: '**NOTE**'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*This two-sample* t*-test, conducted using [Equation (18.3)](ch18.xhtml#ch18eq3),
    is also called* Welch’s *t-*test*. This refers to use of [Equation (18.4)](ch18.xhtml#ch18eq4),
    called the* Welch-Satterthwaite equation*. Crucially, it assumes that the two
    samples have different true variances, which is why it’s called the* unpooled
    variance *version of the test.*'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '*此两样本*t*-检验，使用[方程(18.3)](ch18.xhtml#ch18eq3)进行，也称为*Welch的*t*-检验*。这指的是使用[方程(18.4)](ch18.xhtml#ch18eq4)，称为*Welch-Satterthwaite方程*。至关重要的是，它假设两个样本具有不同的真实方差，这就是为什么它被称为*非合并方差*版本的检验。'
- en: It’s important to be consistent when defining your two sets of parameters and
    when constructing the hypotheses. In this example, since the test aims to find
    evidence for **μ[2]** being greater than **μ[1]**, a difference of **μ[2]**−**μ[1]**
    > 0 forms H[A] (a greater-than, upper-tailed test), and this order of subtraction
    is mirrored when calculating *T*. The same test could be carried out if you defined
    the difference the other way around. In that case, your alternative hypothesis
    would suggest a lower-tailed test because if you’re testing for **μ[2]** being
    bigger than **μ[1]**, H[A] would correctly be written as **μ[1]** − **μ[2]** <
    0\. Again, this would modify the order of subtraction in the numerator of [Equation
    (18.3)](ch18.xhtml#ch18eq3) accordingly.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 在定义两个参数集并构建假设时，一致性非常重要。在这个例子中，由于检验的目的是寻找**μ[2]**大于**μ[1]**的证据，因此**μ[2]**−**μ[1]**
    > 0形成了H[A]（一个大于的、右尾检验），这种减法顺序在计算*T*时被镜像反转。如果你将差异定义为相反的顺序，同样的检验也可以进行。在这种情况下，你的备择假设将暗示一个左尾检验，因为如果你检验的是**μ[2]**大于**μ[1]**，那么H[A]应当正确写作**μ[1]**−**μ[2]**
    < 0。同样，这将相应地修改[方程(18.3)](ch18.xhtml#ch18eq3)中分子减法的顺序。
- en: 'The same care must apply to the use of `t.test` for two-sample comparisons.
    The two samples must be supplied as the arguments `x` and `y`, but the function
    interprets `x` as greater than `y` when doing an upper-tailed test and interprets
    `x` as less than `y` when doing a lower-tailed test. Therefore, when performing
    the test with `alternative="greater"` for the snack pack example, it’s `snacks2`
    that must be supplied to `x`:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 同样的注意事项也适用于使用`t.test`进行两样本比较。必须将两个样本作为参数`x`和`y`传递，但该函数在进行右尾检验时将`x`解释为大于`y`，在进行左尾检验时将`x`解释为小于`y`。因此，在对零食包装的例子进行`alternative="greater"`检验时，必须将`snacks2`传递给`x`：
- en: '[PRE11]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: With a small *p*-value of 0.008706, you’d conclude that there is sufficient
    evidence to reject H[0] in favor of H[A] (indeed, the *p*-value is certainly smaller
    than the stipulated *α* = 0.1 significance level as implied by `conf.level=0.9`).
    The evidence suggests that the mean net weight of snacks from the rival manufacturer’s
    80-gram packs is greater than the mean net weight for the original manufacturer.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 由于*p*-值为0.008706，你可以得出结论，存在足够的证据拒绝零假设H[0]，支持备择假设H[A]（事实上，*p*-值显然小于规定的*α* = 0.1显著性水平，这是由`conf.level=0.9`所隐含的）。证据表明，竞争对手制造商80克包装的零食的平均净重大于原制造商的平均净重。
- en: Note that the output from `t.test` has reported a df value of 60.091, which
    is the unfloored result of (18.4). You also receive a one-sided confidence bound
    (based on the aforementioned confidence level), triggered by the one-sided nature
    of this test. Again, the more common two-sided 90 percent interval is also useful;
    knowing that *ν* = └ 60.091 ┘ = 60 and using the statistic and the standard error
    of interest (numerator and denominator of [Equation (18.3)](ch18.xhtml#ch18eq3),
    respectively), you can calculate it.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，`t.test`的输出报告了一个自由度值60.091，这是公式（18.4）的未下取整结果。你还会收到一个单边置信区间（基于上述置信水平），这是由于本检验的单边性质所触发的。再次提醒，常见的双边90%置信区间也是有用的；知道*ν*
    = └ 60.091 ┘ = 60，并使用检验统计量和标准误差（分别为[公式（18.3）](ch18.xhtml#ch18eq3)的分子和分母），你可以进行计算。
- en: '[PRE12]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Here, you’ve used the previously stored sample statistics `snack.mean`, `snack.sd`
    (the mean and standard deviation of the 44 raw measurements from the original
    manufacturer’s sample), `snack2.mean`, and `snack2.sd` (the same quantities for
    the 31 observations corresponding to the rival manufacturer). Note that the CI
    takes the same form as detailed by [Equation (17.2)](ch17.xhtml#ch17eq2) on [page
    378](ch17.xhtml#page_378) and that to provide the correct 1 − *α* central area,
    the `q`-function for the appropriate *t*-distribution requires 1 − *α*/2 as its
    supplied probability value. You can interpret this as being “90 percent confident
    that the true difference in mean net weight between the rival and the original
    manufacturer (in that order) is somewhere between 0.395 and 2.098 grams.” The
    fact that zero isn’t included in the interval, and that the interval is wholly
    positive, supports the conclusion from the hypothesis test.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，你使用了之前存储的样本统计量`snack.mean`、`snack.sd`（原制造商样本的44个原始测量值的均值和标准差），`snack2.mean`和`snack2.sd`（与竞争对手制造商的31个观测值相对应的均值和标准差）。请注意，置信区间与[公式（17.2）](ch17.xhtml#ch17eq2)在[第378页](ch17.xhtml#page_378)中详细说明的形式相同，并且为了提供正确的1
    − *α*中心区域，适当的*t*分布的`q`函数需要以1 − *α*/2作为其输入的概率值。你可以理解为“90%的置信度认为，竞争对手和原制造商之间的真实平均净重差异（按此顺序）介于0.395克和2.098克之间。”由于零不在区间内，并且区间完全为正，这支持了假设检验的结论。
- en: '**Unpaired/Independent Samples: Pooled Variance**'
  id: totrans-108
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**独立/无配对样本：合并方差**'
- en: In the unpooled variance example just passed, there was no assumption that the
    variances of the two populations whose means were being compared were equal. This
    is an important note to make because it leads to the use of (18.3) for the test
    statistic calculation and (18.4) for the associated degrees of freedom in the
    corresponding *t*-distribution. However, if you *can* assume equivalence of variances,
    the precision of the test is improved—you use a different formula for the standard
    error of the difference and for calculating the associated df.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 在刚才提到的未合并方差示例中，并没有假设正在比较的两个总体的方差相等。这是一个重要的说明，因为它导致在计算检验统计量时使用了公式（18.3），并在相应的*t*分布中使用了公式（18.4）来计算自由度。然而，如果你*可以*假设方差相等，检验的精度将得到提高——你需要使用不同的标准误差公式来计算差异，并计算相关的自由度（df）。
- en: Again, the quantity of interest is the difference between two means, written
    as **μ[2]** − **μ[1]**. Assume you have two independent samples of sizes *n[1]*
    and *n[2]* arising from populations with true means **μ[1]** and **μ[2]**, sample
    means *x̄[1]* and *x̄*[2], and sample standard deviations *s[1]* and *s*[2], respectively,
    and assume that the relevant conditions for the validity of the *t*-distribution
    have been met. Additionally, assume that the true variances of the samples, ![image](../images/f0396-01.jpg)
    and ![image](../images/f0396-02.jpg), are equal such that ![image](../images/f0396-03.jpg).
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，感兴趣的量是两个均值的差，表示为**μ[2]** − **μ[1]**。假设你有两个独立的样本，样本量分别为*n[1]*和*n[2]*，来自具有真实均值**μ[1]**和**μ[2]**的总体，样本均值*x̄[1]*和*x̄[2]*，以及样本标准差*s[1]*和*s[2]*，并假设满足*t*-分布的有效性条件。此外，假设样本的真实方差![image](../images/f0396-01.jpg)和![image](../images/f0396-02.jpg)相等，即![image](../images/f0396-03.jpg)。
- en: '**NOTE**'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*There is a simple rule of thumb to check the validity of the “equal variance”
    assumption. If the ratio of the larger sample standard deviation to the smaller
    sample standard deviation is less than* 2*, you can assume equal variances. For
    example, if s*[1] > *s*[2]*, then if* ![image](../images/f0396-07.jpg) < 2, *you
    can use the pooled variance test statistic that follows.*'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: '*有一个简单的经验法则可以检查“方差相等”假设的有效性。如果较大样本标准差与较小样本标准差的比值小于* 2*，那么可以假设方差相等。例如，如果s*[1]
    > *s*[2]*，那么如果* ![image](../images/f0396-07.jpg) < 2, *你可以使用合并方差的检验统计量。*'
- en: The standardized test statistic *T* for this scenario is given as
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 该场景下的标准化检验统计量*T*为：
- en: '![image](../images/e18-5.jpg)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e18-5.jpg)'
- en: whose distribution is a *t*-distribution with *ν* = *n[1]* + *n[2]* − 2 degrees
    of freedom, where
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 其分布为*t*-分布，*ν* = *n[1]* + *n[2]* − 2自由度，其中：
- en: '![image](../images/e18-6.jpg)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e18-6.jpg)'
- en: is the *pooled estimate of the variance* of all the raw measurements. This is
    substituted in place of *s[1]* and *s[2]* in the denominator of [Equation (18.3)](ch18.xhtml#ch18eq3),
    resulting in [Equation (18.5)](ch18.xhtml#ch18eq5).
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 是所有原始测量值方差的*合并估计*。这个值替代了[公式(18.3)](ch18.xhtml#ch18eq3)中分母的*s[1]*和*s[2]*，从而得出了[公式(18.5)](ch18.xhtml#ch18eq5)。
- en: All other aspects of the two-sample *t*-test remain as earlier, including the
    construction of appropriate hypotheses, the typical null value of *μ*[0], and
    the calculation and interpretation of the *p*-value.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 两样本*t*-检验的其他所有方面与之前相同，包括适当假设的构建、*μ*[0]的典型零值以及*p*-值的计算和解释。
- en: For the comparison of the two means in the snack pack example, you’d find it
    difficult to justify using the pooled version of the *t*-test. Applying the rule
    of thumb, the two estimated standard deviations (*s*[1] ≊ 3.06 and *s[2]* ≊ 1.21
    for the original and rival manufacturer’s samples, respectively) have a large-to-small
    ratio that is greater than 2.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 对于小吃包示例中的两个均值比较，你会发现很难为使用合并版本的*t*-检验辩护。根据经验法则，两个估算的标准差（*s*[1] ≊ 3.06 和 *s[2]*
    ≊ 1.21，分别代表原始和竞争厂家样本）具有一个大到小的比率，超过了2。
- en: '[PRE13]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Though this is rather informal, if the assumption cannot reasonably be made,
    it’s best to stick with the unpooled version of the test.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管这相当非正式，如果无法合理假设这一点，最好坚持使用未合并版本的检验。
- en: 'To illustrate this, let’s consider a new example. The intelligence quotient
    (IQ) is a quantity commonly used to measure how clever a person is. IQ scores
    are reasonably assumed to be normally distributed, and the average IQ of the population
    is said to be 100\. Say that you’re interested in assessing whether there is a
    difference in mean IQ scores between men and women, suggesting the following hypotheses
    where you have *n[men]* = 12 and *n*[women] = 20:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 为了说明这一点，让我们考虑一个新例子。智商（IQ）是常用来衡量一个人聪明程度的量。IQ分数合理地假设为正态分布，并且人群的平均智商被认为是100。假设你有兴趣评估男性和女性之间的平均IQ分数是否存在差异，提出以下假设，其中*n[男]*
    = 12和*n[女]* = 20：
- en: 'H[0] : *μ[men]* − *μ*women = 0'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[0] : *μ[男]* − *μ[女]* = 0'
- en: 'H[A] : *μ[men]* − *μ*women ≠ 0'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[A] : *μ[男]* − *μ[女]* ≠ 0'
- en: 'You randomly sample the following data:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 你随机抽取了以下数据：
- en: '[PRE14]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: As usual, let’s calculate the basic statistics required.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 和往常一样，我们来计算所需的基本统计量。
- en: '[PRE15]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'These give the sample averages *x̄[men]* and *x̄*[women], as well as their
    respective sample standard deviations *s[men]* and *s*[women]. Enter the following
    to quickly check the ratio of the standard deviations:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 这些给出了样本均值*x̄[男]*和*x̄[女]*，以及它们各自的样本标准差*s[男]*和*s[女]*。输入以下内容快速检查标准差的比率：
- en: '[PRE16]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: You can see that the ratio of the larger sample standard deviation to the smaller
    is less than 2, so you could assume equal variances in carrying out the hypothesis
    test.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以看到，较大样本标准差与较小样本标准差的比值小于2，因此你可以假设在进行假设检验时，方差是相等的。
- en: The `t.test` command also enables the pooled two-sample *t*-test as per [Equations
    (18.5)](ch18.xhtml#ch18eq5) and [(18.6)](ch18.xhtml#ch18eq6). To execute it, you
    provide the optional argument `var.equal=TRUE` (as opposed to the default `var.equal=FALSE`,
    which triggers Welch’s *t*-test).
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: '`t.test`命令还可以执行合并的两样本 *t*-检验，按照[公式(18.5)](ch18.xhtml#ch18eq5)和[(18.6)](ch18.xhtml#ch18eq6)。要执行该检验，你需要提供可选参数`var.equal=TRUE`（与默认的`var.equal=FALSE`相对，后者会触发Welch的*t*-检验）。'
- en: '[PRE17]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Note also that H[A] for this example implies a two-tailed test, hence the provision
    of `alternative="two.sided"`.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 还要注意，对于这个例子，H[A]意味着一个双尾检验，因此提供了`alternative="two.sided"`。
- en: The resulting *p*-value of this test, 0.3559, is certainly larger than the conventional
    cutoff level of 0.05\. Thus, your conclusion here is that there is no evidence
    to reject H[0]—there is insufficient evidence to support a true difference in
    the mean IQ scores of men compared to women.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 该检验的结果*p*-值为0.3559，显然大于常规的0.05截止水平。因此，你的结论是没有足够的证据拒绝H[0]——即没有足够的证据支持男性与女性在平均IQ得分上存在显著差异。
- en: '**Paired/Dependent Samples**'
  id: totrans-136
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**配对/相关样本**'
- en: Finally, we’ll look comparing two means in *paired* data. This setting is distinctly
    different from that of both unpaired *t*-tests because it concerns the way the
    data have been collected. The issue concerns *dependence* between pairs of observations
    across the two groups of interest—previously, the measurements in each group have
    been defined as independent. This notion has important consequences for how the
    test can be carried out.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们将看看如何比较*配对*数据中的两个均值。这个设置与两独立样本*t*-检验明显不同，因为它关注的是数据的收集方式。问题在于两组观测之间的*依赖性*——之前，每组中的测量值被定义为独立的。这个概念对于如何执行检验有着重要的影响。
- en: Paired data occur if the measurements forming the two sets of observations are
    recorded on the same individual or if they are related in some other important
    or obvious way. A classic example of this is “before” and “after” observations,
    such as two measurements made on each person before and after some kind of intervention
    treatment. These situations still focus on the difference between the mean outcomes
    in each group, but rather than working with the two data sets separately, a paired
    *t*-test works with a single mean—the true mean of the individual paired differences
    *μ[d]*.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 配对数据出现于形成两组观测数据的测量值是在同一个个体身上记录的，或者它们在某种重要或明显的方式上相关。一个经典的例子是“前后”观测，比如在某种干预治疗前后对每个个体进行的两次测量。这些情况依然关注每组中均值之间的差异，但与其分别处理两个数据集，配对*t*-检验则是通过单一均值来处理——即个体配对差异的真实均值
    *μ[d]*。
- en: 'As an example, consider a company interested in the efficacy of a drug designed
    to reduce resting heart rates in beats per minute (bpm). The resting heart rates
    of 16 individuals are measured. The individuals are then administered a course
    of the treatment, and their resting heart rates are again measured. The data are
    provided in the two vectors `rate.before` and `rate.after` as follows:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 作为一个例子，考虑一家关注于一种药物的效果的公司，该药物旨在降低静息心率（以每分钟跳动次数（bpm）表示）。测量了16个个体的静息心率。然后，这些个体接受了一疗程的治疗，随后再次测量他们的静息心率。数据存储在两个向量`rate.before`和`rate.after`中，具体如下：
- en: '[PRE18]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: It quickly becomes clear why any test comparing these two groups must take dependence
    into account. Heart rate is affected by an individual’s age, build, and level
    of physical fitness. An unfit individual older than 60 is likely to have a higher
    baseline resting heart rate than a fit 20-year-old, and if both are given the
    same drug to lower their heart rate, their final heart rates are still likely
    to reflect the baselines. Any true effect of the drug therefore has the potential
    to be hidden if you approached the analysis using either of the unpaired *t*-tests.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 很快就能清楚地看到，为什么任何比较这两组的检验都必须考虑依赖性。心率受个体年龄、体型和身体健康状况的影响。一个60岁以上的身体不太健康的人，静息心率基线可能高于一个健康的20岁年轻人，即使两人都服用了相同的药物来降低心率，他们的最终心率仍可能反映出各自的基线。如果使用任何独立样本*t*-检验来分析，这种药物的真实效果很可能被掩盖。
- en: 'To overcome this problem, the paired two-sample *t*-test considers the difference
    between each pair of values. Labeling one set of *n* measurements as *x*[1], ...,
    *x*[*n*] and the other set of *n* observations as *y*[1], ..., *y*[*n*], the difference,
    *d*, is defined as *d*[*i*] = *y*[*i*] − *x*[*i*]; *i* = 1, ..., *n*. In R, you
    can easily compute the pairwise differences:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 为了克服这个问题，配对的两样本 *t* 检验考虑每对值之间的差异。将一组 *n* 测量值标记为 *x*[1]，...，*x*[*n*]，另一组 *n*
    观测值标记为 *y*[1]，...，*y*[*n*]，则差异 *d* 定义为 *d*[*i*] = *y*[*i*] − *x*[*i*]；*i* = 1，...，*n*。在
    R 中，您可以轻松计算成对差异：
- en: '[PRE19]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The following code calculates the sample mean ![image](../images/d.jpg) and
    standard deviation *s[d]* of these differences:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码计算这些差异的样本均值 ![image](../images/d.jpg) 和标准差 *s[d]*：
- en: '[PRE20]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'You want to see how much the heart rate is reduced by, so the test at hand
    will be concerned with the following hypotheses:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 您希望查看心率减少的程度，因此此检验将关注以下假设：
- en: 'H[0] : *μ[d]* = 0'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[0] : *μ[d]* = 0'
- en: 'H[A] : *μ[d]* < 0'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[A] : *μ[d]* < 0'
- en: Given the order or subtraction used to obtain the differences, detection of
    a successful reduction in heart rate will be represented by an “after” mean that
    is smaller than the “before” mean.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 给定用来获得差异的顺序或减法，心率成功降低的检测将表现为“之后”的均值小于“之前”的均值。
- en: Expressing all this mathematically, the value of interest is the true mean difference,
    *μ[d]*, between two means of dependent pairs of measurements. There are two sets
    of *n* measurements, *x*[1], ..., *x*[*n*] and *y*[1], ..., *y*[*n*], with pairwise
    differences *d*[1], ..., *d*[*n*]. The relevant conditions for the validity of
    the *t*-distribution must be met; in this case, if the number of pairs *n* is
    less than 30, then you must be able to assume the raw data are normally distributed.
    The test statistic *T* is given as
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 将所有这些用数学语言表达，感兴趣的值是两个依赖测量对之间的真实均值差异，*μ[d]*。这里有两组* n * 测量值，*x*[1]，...，*x*[*n*]
    和 *y*[1]，...，*y*[*n*]，它们的成对差异是 *d*[1]，...，*d*[*n*]。必须满足*t*分布有效性的相关条件；在这种情况下，如果成对数
    *n* 小于30，则必须假设原始数据是正态分布的。检验统计量 *T* 由以下公式给出：
- en: '![image](../images/e18-7.jpg)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e18-7.jpg)'
- en: where ![image](../images/d.jpg) is the mean of the pairwise differences, *s[d]*
    is the sample standard deviation of the pairwise differences, and *μ*[0] is the
    null value (usually zero). The statistic *T* follows a *t*-distribution with *n*
    − 1 df.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 ![image](../images/d.jpg) 是成对差异的均值，*s[d]* 是成对差异的样本标准差，而 *μ*[0] 是原假设值（通常为零）。统计量
    *T* 遵循 *t* 分布，具有 *n* − 1 自由度。
- en: The form of [Equation (18.7)](ch18.xhtml#ch18eq7) is actually the same as the
    form of the test statistic in (18.2), once the sample statistics for the individual
    paired differences have been calculated. Furthermore, it’s important to note that
    *n* represents the total number of *pairs*, not the total number of individual
    observations.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '[方程式 (18.7)](ch18.xhtml#ch18eq7) 的形式实际上与 (18.2) 中的检验统计量的形式相同，一旦计算了个别配对差异的样本统计量。进一步需要注意的是，*n*
    代表的是配对的总数，而不是单个观测值的总数。'
- en: For the current example hypotheses, you can find the test statistic and *p*-value
    with `rate.dbar` and `rate.sd`.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 对于当前的假设检验，可以通过 `rate.dbar` 和 `rate.sd` 计算检验统计量和 *p* 值。
- en: '[PRE21]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: These results suggest evidence to reject H[0]. In `t.test`, the optional logical
    argument `paired` must be set to `TRUE`.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 这些结果表明有证据拒绝 H[0]。在 `t.test` 中，必须将可选的逻辑参数 `paired` 设置为 `TRUE`。
- en: '[PRE22]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Note that the order you supply your data vectors to the `x` and `y` arguments
    follows the same rules as for the unpaired tests, given the desired value of `alternative`.
    The same *p*-value as was calculated manually is confirmed through the use of
    `t.test`, and since this is less than an assumed conventional significance level
    of *α* = 0.05, a valid conclusion would be to state that there is statistical
    evidence that the medication does reduce the mean resting heart rate. You could
    go on to say you’re 95 percent confident that the true mean difference in heart
    rate after taking the course of medication lies somewhere between
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，您提供给 `x` 和 `y` 参数的数据向量的顺序遵循与非配对检验相同的规则，具体取决于所需的 `alternative` 值。通过使用 `t.test`
    确认与手动计算的相同的 *p* 值，并且由于此值小于假设的常规显著性水平 *α* = 0.05，因此有效的结论是，您可以声明有统计证据表明药物确实减少了均值静息心率。你还可以进一步说你有95%的信心，药物治疗后，真实的心率均值差异位于以下区间之间：
- en: '[PRE23]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: and
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 和
- en: '[PRE24]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '**NOTE**'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*On some occasions, such as when your data strongly indicate non-normality,
    you may not be comfortable assuming the validity of the CLT (refer back to [Section
    17.1.1](ch17.xhtml#ch17lev2sec146)). An alternative approach to the tests discussed
    here is to employ a* nonparametric *technique that relaxes these distributional
    requirements. In the two-sample case, you could employ the* Mann-Whitney U test
    *(also known as the* Wilcoxon rank-sum test*). This is a hypothesis test that
    compares two medians, as opposed to two means. You can use the R function* `wilcox.test`
    *to access this methodology; its help page provides useful commentary and references
    on the particulars of the technique.*'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '*在某些情况下，例如当你的数据强烈表明不符合正态分布时，你可能不愿意假设中央极限定理的有效性（请参考 [第 17.1.1 节](ch17.xhtml#ch17lev2sec146)）。对于此处讨论的检验方法的替代方法，可以采用*
    非参数 *技术，放宽这些分布要求。在双样本情况下，可以使用* Mann-Whitney U 检验*（也称为*Wilcoxon 秩和检验*）。这是一个比较两个中位数的假设检验，而不是两个均值。你可以使用
    R 函数* `wilcox.test` *来访问此方法，其帮助页面提供了有用的评论和该方法的详细参考。*'
- en: '**Exercise 18.2**'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: '**练习 18.2**'
- en: In the package `MASS` you’ll find the data set `anorexia`, which contains data
    on pre- and post-treatment weights (in pounds) of 72 young women suffering from
    the disease, obtained from Hand et al. ([1994](ref.xhtml#ref28)). One group of
    women is the control group (in other words, no intervention), and the other two
    groups are the cognitive behavioral program and family support intervention program
    groups. Load the library and ensure you can access the data frame and understand
    its contents. Let *μ[d]* denote the mean difference in weight, computed as (*post-weight*
    − *pre-weight*).
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `MASS` 包中，你会找到数据集 `anorexia`，该数据集包含了 72 名患病年轻女性的治疗前后体重数据（单位为磅），这些数据来自 Hand
    等人（[1994](ref.xhtml#ref28)）。其中一组女性为对照组（即无干预），另外两组分别为认知行为治疗组和家庭支持干预组。加载该库，并确保你能访问数据框并理解其内容。令
    *μ[d]* 表示体重差的均值，计算方法为（*治疗后体重* − *治疗前体重*）。
- en: 'Regardless of which treatment group the participants fall into, conduct and
    conclude an appropriate hypothesis test with *α* = 0.05 for the entire set of
    weights for the following hypotheses:'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 无论参与者属于哪个治疗组，都需要针对所有体重数据进行适当的假设检验，并以 *α* = 0.05 得出结论，检验以下假设：
- en: 'H[0] : *μ[d]* = 0'
  id: totrans-167
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'H[0] : *μ[d]* = 0'
- en: 'H[A] : *μ[d]* > 0'
  id: totrans-168
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'H[A] : *μ[d]* > 0'
- en: Next, conduct three separate hypothesis tests using the same defined hypotheses,
    based on which treatment group the participants fall into. What do you notice?
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，根据参与者所属的治疗组，进行三次独立的假设检验，使用相同的已定义假设。你注意到了什么？
- en: Another ready-to-use data set in R is `PlantGrowth` ([Dobson, 1983](ref.xhtml#ref19)),
    which records a continuous measure of the yields of a certain plant, looking at
    the potential effect of two supplements administered during growth to increase
    the yield when compared to a control group with no supplement.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: R 中另一个现成可用的数据集是 `PlantGrowth`（[Dobson, 1983](ref.xhtml#ref19)），该数据集记录了某种植物的连续产量，并比较了在生长过程中施用两种补充剂对产量的潜在影响，目的是提高与对照组（无补充剂）相比的产量。
- en: Set up hypotheses to test whether the mean yield for the control group is less
    than the mean yield from a plant given either of the treatments. Determine whether
    this test should proceed using a pooled estimate of the variance or whether Welch’s
    *t*-test would be more appropriate.
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置假设来检验对照组的平均产量是否低于接受任一治疗的植物的平均产量。确定这个检验是应该使用合并方差估计，还是 Welch 的 *t* 检验更为合适。
- en: Conduct the test and make a conclusion (assuming normality of the raw observations).
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 进行测试并得出结论（假设原始观察值符合正态分布）。
- en: As discussed, there is a rule of thumb for deciding whether to use a pooled
    estimate of the variance in an unpaired *t*-test.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，决定是否在无配对的 *t* 检验中使用合并方差估计的经验法则。
- en: 'Your task is to write a *wrapper* function that calls `t.test` after deciding
    whether it should be executed with `var.equal=FALSE` according to the rule of
    thumb. Use the following guidelines:'
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你的任务是编写一个 *包装器* 函数，在根据经验法则决定是否应以 `var.equal=FALSE` 执行后，调用 `t.test`。请遵循以下指导原则：
- en: '– Your function should take four defined arguments: `x` and `y` with no defaults,
    to be treated in the same way as the same arguments in `t.test`; and `var.equal`
    and `paired`, with defaults that are the same as the defaults of `t.test`.'
  id: totrans-175
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: – 你的函数应该接受四个已定义的参数：`x` 和 `y`，没有默认值，处理方式与 `t.test` 中相同；`var.equal` 和 `paired`，其默认值与
    `t.test` 的默认值相同。
- en: – An ellipsis ([Section 9.2.5](ch09.xhtml#ch09lev2sec86)) should be included
    to represent any additional arguments to be passed to `t.test`.
  id: totrans-176
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: – 应该包含一个省略号（[第9.2.5节](ch09.xhtml#ch09lev2sec86)）来表示传递给`t.test`的任何附加参数。
- en: – Upon execution, the function should determine whether `paired=FALSE`.
  id: totrans-177
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: – 执行时，函数应确定`paired=FALSE`。
- en: '* If `paired` is `TRUE`, then there is no need to proceed with the check of
    a pooled variance.'
  id: totrans-178
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*如果`paired`为`TRUE`，则无需继续进行合并方差的检验。*'
- en: '* If `paired` is `FALSE`, then the function should determine the value for
    `var.equal` automatically by using the rule of thumb.'
  id: totrans-179
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*如果`paired`为`FALSE`，那么函数应根据经验法则自动确定`var.equal`的值。*'
- en: – If the value of `var.equal` was set automatically, you can assume it will
    override any value of this argument initially supplied by the user.
  id: totrans-180
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: – 如果`var.equal`的值是自动设置的，你可以假设它会覆盖用户最初提供的该参数的任何值。
- en: – Then, call `t.test` appropriately.
  id: totrans-181
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: – 然后，适当地调用`t.test`。
- en: Try your new function on all three examples in the text of [Section 18.2.2](ch18.xhtml#ch18lev2sec159),
    ensuring you reach identical results.
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在[第18.2.2节](ch18.xhtml#ch18lev2sec159)的文本中，尝试在所有三个示例上使用你的新函数，确保结果一致。
- en: '**18.3 Testing Proportions**'
  id: totrans-183
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**18.3 检验比例**'
- en: A focus on means is especially common in statistical modeling and hypothesis
    testing, and therefore you must also consider sample proportions, interpreted
    as the mean of a series of *n* binary trials, in which the results are success
    (1) or failure (0). This section focuses on the parametric tests of proportions,
    which assume normality of the target sampling distributions (otherwise referred
    to as *Z*-tests).
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 在统计建模和假设检验中，重点关注均值尤其常见，因此你还必须考虑样本比例，解释为一系列*n*次二项试验的均值，其中结果是成功（1）或失败（0）。本节重点介绍比例的参数检验，假设目标抽样分布服从正态分布（通常称为*Z*检验）。
- en: The general rules regarding the setup and interpretation of hypothesis tests
    for sample proportions remain the same as for sample means. In this introduction
    to *Z*-tests, you can consider these as tests regarding the true value of a single
    proportion or the difference between two proportions.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 关于样本比例假设检验的设置和解释的一般规则与样本均值的假设检验相同。在本节介绍的*Z*检验中，你可以将这些视为关于单一比例的真实值或两个比例之间差异的检验。
- en: '***18.3.1 Single Proportion***'
  id: totrans-186
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***18.3.1 单一比例***'
- en: '[Section 17.1.2](ch17.xhtml#ch17lev2sec147) introduced the sampling distribution
    of a single sample proportion to be normally distributed, with a mean centered
    on the true proportion *π* and with a standard error of ![image](../images/f0402-01.jpg).
    Provided the trials are independent and that *n* isn’t “too small” and *π* isn’t
    “too close” to 0 or 1, those formulas are applicable here.'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: '[第17.1.2节](ch17.xhtml#ch17lev2sec147)介绍了单个样本比例的抽样分布应服从正态分布，其均值以真实比例*π*为中心，标准误差为![image](../images/f0402-01.jpg)。假设试验是独立的，并且*n*不“太小”，*π*也不“太接近”0或1，这些公式在这里适用。'
- en: '**NOTE**'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*A rule of thumb to check the latter condition on n and* *π* *simply involves
    checking that n* ![image](../images/p.jpg) *and n*(1 − ![image](../images/p.jpg))
    *are both greater than 5, where* ![image](../images/p.jpg) *is the sample estimate
    of* *π.*'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: '*检查n和*π*后者条件的经验法则简单地包括检查n*![image](../images/p.jpg)*和n*(1 − ![image](../images/p.jpg))*都大于5，其中*![image](../images/p.jpg)*是*π*的样本估计值。*'
- en: It’s worth noting that the standard error in the case of hypothesis tests involving
    proportions is itself dependent upon *π*. This is important—remember that any
    hypothesis test assumes satisfaction of H[0] in the relevant calculations. In
    dealing with proportions, that means when computing the test statistic, the standard
    error must make use of the null value *π*[0] rather than the estimated sample
    proportion ![image](../images/p.jpg).
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 值得注意的是，在涉及比例的假设检验中，标准误差本身依赖于*π*。这一点很重要——记住，任何假设检验都假设H[0]在相关计算中成立。在处理比例时，这意味着在计算检验统计量时，标准误差必须使用零假设值*π*[0]，而不是估计的样本比例![image](../images/p.jpg)。
- en: 'I’ll clarify this in an example. Suppose an individual fond of a particular
    fast-food chain notices that he tends to have an upset stomach within a certain
    amount of time after having his usual lunch. He comes across the website of a
    blogger who believes that the chance of getting an upset stomach shortly after
    eating that particular food is 20 percent. The individual is curious to determine
    whether his true rate of stomach upset *π* is any different from the blogger’s
    quoted value and, over time, visits these fast-food outlets for lunch on *n* =
    29 separate occasions, recording the success (`TRUE`) or failure (`FALSE`) of
    experiencing an upset stomach. This suggests the following pair of hypotheses:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 我将在一个例子中澄清这一点。假设一个喜爱某快餐连锁的个体注意到，他在吃了自己平常的午餐后，总是在一定时间内感到胃部不适。他偶然看到一个博客，博主认为吃这种特定食物后胃不适的几率是20%。这个人很想知道他自己实际的胃不适率*π*是否与博主的值不同，因此他在*29*次不同的就餐中记录下自己是否经历胃不适（成功为`TRUE`，失败为`FALSE`）。这表明以下假设：
- en: 'H[0] : *π* = 0.2'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[0] : *π* = 0.2'
- en: 'H[A] : *π* ≠ 0.2'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[A] : *π* ≠ 0.2'
- en: These may be tested according to the general rules discussed in the following
    sections.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 这些可以根据接下来章节中讨论的通用规则进行检验。
- en: '**Calculation: One-Sample Z-Test**'
  id: totrans-195
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**计算：单样本Z检验**'
- en: 'In testing for the true value of some proportion of success, *π*, let ![image](../images/p.jpg)
    be the sample proportion over *n* trials, and let the null value be denoted with
    *π*[0]. You find the test statistic with the following:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 在检验某个成功比例*π*的真实值时，设![image](../images/p.jpg)为*n*次试验中的样本比例，零假设值记作*π*[0]。你可以通过以下方式找到检验统计量：
- en: '![image](../images/e18-8.jpg)'
  id: totrans-197
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e18-8.jpg)'
- en: Provided the aforementioned conditions on the size of *n* and the value of *π*
    can be assumed, *Z* ∼ N(0,1).
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 在假设前述关于*π*和*n*大小的条件成立的情况下，*Z* ~ N(0,1)。
- en: The denominator of [Equation (18.8)](ch18.xhtml#ch18eq8), the standard error
    of the proportion, is calculated with respect to the null value *π*[0], not ![image](../images/p.jpg).
    As mentioned just a moment ago, this is to satisfy the assumption of “truth” of
    H[0] as the test is carried out, so it allows interpretation of the resulting
    *p*-value as usual. The standard normal distribution is used to find the *p*-value
    with respect to *Z*; the direction underneath this curve is governed by the nature
    of H[A] just as before.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: '[方程 (18.8)](ch18.xhtml#ch18eq8)中的分母，即比例的标准误差，是相对于零假设值*π*[0]计算的，而不是![image](../images/p.jpg)。正如刚才提到的，这是为了满足“真值”假设H[0]，以便在进行检验时，使得最终的*p*-值的解释与平常一致。标准正态分布用于根据*Z*找到*p*-值；此曲线下的方向由H[A]的性质决定，和之前一样。'
- en: Getting back to the fast-food example, suppose these are the observed data,
    where `1` is recorded for an upset stomach and is `0` otherwise.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 回到快餐例子，假设这些是观测数据，其中`1`表示胃不适，`0`表示其他情况。
- en: '[PRE25]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'The number of successes and probability of success in this sample are as follows:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 该样本中的成功次数和成功概率如下所示：
- en: '[PRE26]'
  id: totrans-203
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'A quick check indicates that as per the rule of thumb, the test is reasonable
    to carry out:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 快速检查表明，按照经验法则，进行检验是合理的：
- en: '[PRE27]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Following [Equation (18.8)](ch18.xhtml#ch18eq8), the test statistic *Z* for
    this example is as follows:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 根据[方程 (18.8)](ch18.xhtml#ch18eq8)，本例中的检验统计量*Z*如下所示：
- en: '[PRE28]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: The alternative hypothesis is two-sided, so you compute the corresponding *p*-value
    as a two-tailed area under the standard normal curve. With a positive test statistic,
    this can be evaluated by doubling the upper-tailed area from *Z*.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 备择假设是双尾的，因此你需要计算对应的*p*-值，作为标准正态曲线下的双尾区域。对于正的检验统计量，可以通过将*Z*的上尾面积乘以2来评估。
- en: '[PRE29]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Assume a conventional *α* level of 0.05\. The high *p*-value given as 0.307
    suggests the results in the sample of size 29 are not unusual enough, under the
    assumption that the null hypothesis is true, to reject H[0]. There is insufficient
    evidence to suggest that the proportion of instances of an upset stomach that
    this individual experiences is any different from 0.2 as noted by the blogger.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 假设采用常规的*α*水平0.05。给出的较高*p*-值0.307表明，在假设零假设成立的情况下，样本大小为29的结果并不足够不寻常，因此不能拒绝H[0]。没有足够的证据表明该个体经历胃不适的比例与0.2有显著不同，正如博主所指出的那样。
- en: 'You can support this conclusion with a confidence interval. At the level of
    95 percent, you calculate the CI:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过置信区间来支持这个结论。在95%的置信度水平下，你可以计算置信区间（CI）：
- en: '[PRE30]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: This interval easily includes the null value of 0.2.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 这个区间轻松地包含了零假设值0.2。
- en: '**R Function: prop.test**'
  id: totrans-214
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**R 函数：prop.test**'
- en: Once more, R rescues you from tedious step-by-step calculation. The ready-to-use
    `prop.test` function allows you to perform, among other things, a single sample
    proportion test. The function actually performs the test in a slightly different
    way, using the chi-squared distribution (which will be explored more in [Section
    18.4](ch18.xhtml#ch18lev1sec57)). However, the test is equivalent, and the resulting
    *p*-value from `prop.test` is identical to the one reached using the *Z-*based
    test.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 再次，R拯救了你免于繁琐的逐步计算。现成的`prop.test`函数使你可以进行单样本比例检验等多项操作。该函数实际上以稍微不同的方式执行检验，使用卡方分布（将在[第18.4节](ch18.xhtml#ch18lev1sec57)中进一步探讨）。然而，检验是等效的，`prop.test`返回的*p*-值与使用*Z*检验得到的值相同。
- en: To the `prop.test` function, as used for a single sample test of a proportion,
    you provide the number of successes observed as `x`, the total number of trials
    as `n`, and the null value as `p`. The two further arguments, `alternative` (defining
    the nature of H[A]) and `conf.level` (defining 1 − *α*), are identical to the
    same arguments in `t.test` and have defaults of `"two.sided"` and `0.95`, respectively.
    Lastly, it is recommended to explicitly set the optional argument `correct=FALSE`
    if your data satisfy the *n* ![image](../images/p.jpg) and *n*(1 − ![image](../images/p.jpg))
    rule of thumb.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 对于`prop.test`函数，用于单样本比例检验时，你需要提供观察到的成功次数`x`，总试验次数`n`，以及原假设值`p`。另外两个参数，`alternative`（定义H[A]的性质）和`conf.level`（定义1
    − *α*），与`t.test`中的参数相同，默认值分别是`"two.sided"`和`0.95`。最后，建议在数据满足*n* ![image](../images/p.jpg)和*n*(1
    − ![image](../images/p.jpg))的经验法则时，显式设置可选参数`correct=FALSE`。
- en: 'For the current example, you perform the test with this code:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 对于当前的例子，你可以通过以下代码进行测试：
- en: '[PRE31]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: The *p*-value is the same as you got earlier. Note, however, that the reported
    CI is not quite the same (the normal-based interval, dependent upon the CLT).
    The CI produced by `prop.test` is referred to as the *Wilson score interval*,
    which takes into account the direct association that a “probability of success”
    has with the binomial distribution. For simplicity, you’ll continue to work with
    normal-based intervals when performing hypothesis tests involving proportions
    here.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: '*p*-值与之前得到的相同。不过，注意到报告的置信区间（CI）略有不同（基于正态分布的区间，依赖于中心极限定理）。`prop.test`生成的CI被称为*威尔逊得分区间*，它考虑了“成功概率”与二项分布之间的直接关联。为了简化起见，在执行涉及比例的假设检验时，你将继续使用基于正态分布的区间。'
- en: Note also that, just like `t.test`, any one-sided test performed with `prop.test`
    will provide only a single-limit confidence bound; you’ll see this in the following
    example.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 同样需要注意的是，像`t.test`一样，任何使用`prop.test`进行的一边检验只会提供一个单边的置信区间；你将在下面的例子中看到这一点。
- en: '***18.3.2 Two Proportions***'
  id: totrans-221
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***18.3.2 两个比例***'
- en: With a basic extension to the previous procedure, by way of a modification to
    the standard error, you can compare *two* estimated proportions from independent
    populations. As with the difference between two means, you’re often testing whether
    the two proportions are the same and thus have a difference of zero. Therefore,
    the typical null value is zero.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 通过对标准误差的修改，基本扩展之前的过程，你可以比较来自独立总体的*两个*估计比例。就像两个均值的差异一样，你通常是在检验两个比例是否相同，从而使其差异为零。因此，典型的原假设值是零。
- en: For an example, consider a group of students taking a statistics exam. In this
    group are *n[1]* = 233 students majoring in psychology, of whom *x[1]* = 180 pass,
    and *n[2]* = 197 students majoring in geography, of whom 175 pass. Suppose it
    is claimed that the geography students have a higher pass rate in statistics than
    the psychology students.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 举个例子，考虑一个统计学考试的学生群体。在这个群体中，有*n[1]* = 233名心理学专业的学生，其中*x[1]* = 180名通过考试；另外有*n[2]*
    = 197名地理学专业的学生，其中175名通过考试。假设有人声称地理学专业的学生在统计学考试中的通过率高于心理学专业的学生。
- en: 'Representing the true pass rates for psychology students as *π*[1] and geography
    students as *π*[2], this claim can be statistically tested using a pair of hypotheses
    defined as follows:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 将心理学学生的真实通过率表示为*π*[1]，将地理学学生的通过率表示为*π*[2]，该假设可以通过以下定义的假设对进行统计检验：
- en: 'H[0] : *π*[2] − *π*[1] = 0'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[0] : *π*[2] − *π*[1] = 0'
- en: 'H[A] : *π*[2] − *π*[1] > 0'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[A] : *π*[2] − *π*[1] > 0'
- en: Just as with a comparison between two means, it’s important to keep the order
    of differencing consistent throughout the test calculations. This example shows
    an upper-tailed test.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 就像比较两个均值一样，保持差异计算的一致顺序在整个测试计算中是非常重要的。这个例子展示了一个右尾检验。
- en: '**Calculation: Two-Sample Z-Test**'
  id: totrans-228
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**计算：双样本 Z 检验**'
- en: 'In testing for the true difference between two proportions mathematically,
    *π*[1] and *π*[2], let ![image](../images/p.jpg)[1] = *x*[1]/*n*[1] be the sample
    proportion for *x[1]* successes in *n[1]* trials corresponding to *π*[1], and
    the same quantities as ![image](../images/p.jpg)[2] = *x*[2]/*n*[2] for *π*[2].
    With a null value of the difference denoted *π*[0], the test statistic is given
    by the following:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 在数学上测试两比例之间的真实差异 *π*[1] 和 *π*[2] 时，令 ![image](../images/p.jpg)[1] = *x*[1]/*n*[1]
    为 *π*[1] 对应的 *x[1]* 成功次数和 *n[1]* 次试验的样本比例，类似地，令 ![image](../images/p.jpg)[2] =
    *x*[2]/*n*[2] 为 *π*[2] 的比例。假设差异的原假设值为 *π*[0]，则检验统计量为：
- en: '![image](../images/e18-9.jpg)'
  id: totrans-230
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e18-9.jpg)'
- en: Provided you can assume to apply the aforementioned conditions for a proportion
    with respect to *n*[1], *n[2]* and *π*[1], *π*[2], you can treat *Z* ∼ N(0,1).
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你可以应用上述关于 *n*[1]、*n*[2] 和 *π*[1]、*π*[2]* 的条件，你可以将 *Z* 视为符合正态分布 N(0,1)。
- en: 'There is a new quantity, *p*^∗, present in the denominator of (18.9). This
    is a *pooled* proportion, given as follows:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 在 (18.9) 的分母中有一个新的量 *p*^∗。这是一个 *合并* 比例，计算如下：
- en: '![image](../images/e18-10.jpg)'
  id: totrans-233
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e18-10.jpg)'
- en: As noted, in this kind of test it is common for the null value, the true difference
    in proportions, to be set to zero (in other words, *π*[0] = 0).
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，在这种类型的检验中，常常将原假设值，即两比例之间的真实差异，设定为零（换句话说，*π*[0] = 0）。
- en: The denominator of [Equation (18.9)](ch18.xhtml#ch18eq9) is itself the standard
    error of the difference between two proportions as used in a hypothesis test.
    The need to use *p*^∗ lies once more in the fact that H[0] is assumed to be true.
    Using ![image](../images/p1.jpg) and ![image](../images/p2.jpg) separately in
    the denominator of (18.9), in the form of ![image](../images/f0406-01.jpg) (the
    standard error of the difference between two proportions outside the confines
    of a hypothesis test), would violate the assumed “truth” of H[0].
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: '[公式 (18.9)](ch18.xhtml#ch18eq9) 的分母本身是用在假设检验中的两比例差异的标准误差。需要使用 *p*^∗ 再次体现了 H[0]
    被假设为真的事实。在 (18.9) 的分母中分别使用 ![image](../images/p1.jpg) 和 ![image](../images/p2.jpg)，以
    ![image](../images/f0406-01.jpg) 的形式（即在假设检验之外的两比例差异的标准误差）会违反假设 H[0] 的“真实性”。'
- en: 'So, returning to the statistics exam taken by the psychology and geography
    students, you can evaluate the required quantities as such:'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，回到心理学和地理学学生参加的统计学考试，你可以按照以下方式计算所需的各个量：
- en: '[PRE32]'
  id: totrans-237
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: The results indicate sample pass rates of around 77.2 percent for the psychology
    students and 88.8 percent for the geography students; this is a difference of
    roughly 11.6 percent. From examining the values of ![image](../images/p1.jpg),
    *n[1]* and ![image](../images/p2.jpg), *n*[2], you can see that the rule of thumb
    is satisfied for this test; again, assume a standard significance level of *α*
    = 0.05.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 结果表明，心理学学生的样本通过率约为 77.2%，地理学学生的通过率为 88.8%；两者的差异约为 11.6%。通过检查 ![image](../images/p1.jpg)、*n[1]*
    和 ![image](../images/p2.jpg)、*n*[2] 的值，你可以看到该测试满足经验法则；同样，假设标准显著性水平为 *α* = 0.05。
- en: 'The pooled proportion *p*^∗, following (18.10), is as follows:'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 根据公式 (18.10)，合并后的比例 *p*^∗ 如下所示：
- en: '[PRE33]'
  id: totrans-240
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'With that you calculate the test statistic *Z* as per [Equation (18.9)](ch18.xhtml#ch18eq9)
    with the following:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 然后你按照 [公式 (18.9)](ch18.xhtml#ch18eq9) 计算检验统计量 *Z*，具体如下：
- en: '[PRE34]'
  id: totrans-242
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'In light of the hypotheses, you find the corresponding *p*-value as a right-hand,
    upper-tail area from *Z* underneath the standard normal curve as follows:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 根据假设，你可以找到对应的 *p*-值，作为标准正态曲线下右侧上尾区域的 *Z* 值，如下所示：
- en: '[PRE35]'
  id: totrans-244
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: You observe a *p*-value that’s substantially smaller than *α*, so the formal
    decision is of course to reject the null hypothesis in favor of the alternative.
    The sample data provide sufficient evidence against H[0] such that you can conclude
    that evidence exists to support the pass rate for geography students being higher
    than the pass rate for psychology students.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 你观察到一个显著小于 *α* 的 *p*-值，因此正式决策当然是拒绝原假设，支持备择假设。样本数据提供了足够的证据反驳 H[0]，因此你可以得出结论，支持地理学学生的通过率高于心理学学生的通过率。
- en: '**R Function: prop.test**'
  id: totrans-246
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**R 函数：prop.test**'
- en: Once more, R allows you to perform the test with one line of code using `prop.test`.
    For comparisons of two proportions, you pass the number of successes in each group
    as a vector of length 2 to `x` and the respective sample sizes as another vector
    of length 2 to `n`. Note that the order of the entries must reflect the order
    of `alternative` if this is one-sided (in other words, here, the proportion that
    is to be tested as “greater” corresponds to the first elements of `x` and `n`).
    Once more, `correct` is set to `FALSE`.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 再次使用R，你可以通过一行代码使用`prop.test`来进行检验。对于两个比例的比较，你将每组成功的次数作为长度为2的向量传递给`x`，并将各自的样本大小作为另一个长度为2的向量传递给`n`。请注意，条目的顺序必须与`alternative`的顺序一致（换句话说，在这里，“大于”要检验的比例对应`x`和`n`的第一个元素）。再次地，`correct`被设置为`FALSE`。
- en: '[PRE36]'
  id: totrans-248
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'The *p*-value is identical to the one generated by the previous series of calculations,
    suggesting a rejection of H[0]. Since `prop.test` was called as a one-sided test,
    the confidence interval returned provides a single bound. To provide a two-sided
    CI for the true difference, it makes sense, considering the outcome of the test,
    to construct this using the separate ![image](../images/p1.jpg) and ![image](../images/p2.jpg)
    instead of using the denominator of (18.9) specifically (which assumes truth of
    H[0]). The “separate-estimate” version of the standard error of the difference
    between two proportions was given earlier (in the text beneath [Equation (18.10)](ch18.xhtml#ch18eq10)),
    and a 95 percent CI is therefore calculated with the following:'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: '*p*-值与之前一系列计算得出的值相同，表明拒绝H[0]。由于`prop.test`作为单侧检验调用，返回的置信区间提供了一个单侧边界。为了提供真实差异的双侧置信区间，考虑到检验结果，使用单独的![image](../images/p1.jpg)和![image](../images/p2.jpg)来构造，而不是专门使用(18.9)中的分母（假设H[0]为真）。两个比例差异的标准误的“单独估计”版本之前已经给出（见[方程（18.10）](ch18.xhtml#ch18eq10)下的文字），因此可以根据以下公式计算95%的置信区间：'
- en: '[PRE37]'
  id: totrans-250
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: With that, you’re 95 percent confident that the true difference between the
    proportion of geography students passing the exam and the proportion of psychology
    students passing the exam lies somewhere between 0.046 and 0.185\. Naturally,
    the interval also reflects the result of the hypothesis test—it doesn’t include
    the null value of zero and is wholly positive.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 由此，你可以有95%的信心，地理学学生通过考试的比例和心理学学生通过考试的比例之间的真实差异位于0.046到0.185之间。自然，这个区间也反映了假设检验的结果——它不包括零的原假设值，且完全是正的。
- en: '**Exercise 18.3**'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: '**练习 18.3**'
- en: An advertisement for a skin cream claims nine out of ten women who use it would
    recommend it to a friend. A skeptical salesperson in a department store believes
    the true proportion of women users who’d recommend it, *π*, is much smaller than
    0.9\. She follows up with 89 random customers who had purchased the skin cream
    and asks if they would recommend it to others, to which 71 answer yes.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 一则护肤霜广告声称，九成使用该产品的女性会将其推荐给朋友。一位在百货商店工作的怀疑的销售员认为，愿意推荐该产品的女性用户真实比例*π*远小于0.9。她随后向89位随机选取的购买了护肤霜的顾客询问她们是否会推荐给他人，其中71人回答是。
- en: Set up an appropriate pair of hypotheses for this test and determine whether
    it will be valid to carry out using the normal distribution.
  id: totrans-254
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为此检验设置一个合适的假设对，并确定是否可以使用正态分布进行检验。
- en: Compute the test statistic and the *p*-value and state your conclusion for the
    test using a significance level of *α* = 0.1.
  id: totrans-255
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算检验统计量和*p*-值，并使用显著性水平*α* = 0.1给出你的检验结论。
- en: Using your estimated sample proportion, construct a two-sided 90 percent confidence
    interval for the true proportion of women who would recommend the skin cream.
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用你估算的样本比例，构建一个双侧90%的置信区间，用于估计推荐该护肤霜的女性真实比例。
- en: The political leaders of a particular country are curious as to the proportion
    of citizens in two of its states that support the decriminalization of marijuana.
    A small pilot survey taken by officials reveals that 97 out of 445 randomly sampled
    voting-age citizens residing in state 1 support the decriminalization and that
    90 out of 419 voting-age citizens residing in state 2 support the same notion.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 某国家的政治领导人好奇该国两个州的公民中支持大麻去刑化的比例。政府官员进行的小规模试调查显示，在州1中，445名随机抽取的选民中有97人支持去刑化，而在州2中，419名选民中有90人支持同一观点。
- en: 'Letting *π*[1] denote the true proportion of citizens in support of decriminalization
    in state 1, and *π*[2] the same measure in state 2, conduct and conclude a hypothesis
    test under a significance level of *α* = 0.05 with reference to the following
    hypotheses:'
  id: totrans-258
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设*π*[1]为州1中支持非刑事化的公民的真实比例，*π*[2]为州2中的相同比例，进行并得出假设检验的结论，显著性水平为*α*=0.05，参考以下假设：
- en: 'H[0] : *π*[2] − *π*[1] = 0'
  id: totrans-259
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'H[0] : *π*[2] − *π*[1] = 0'
- en: 'H[A] : *π*[2] − *π*[1] ≠ 0'
  id: totrans-260
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'H[A] : *π*[2] − *π*[1] ≠ 0'
- en: Compute and interpret a corresponding CI.
  id: totrans-261
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算并解释相应的置信区间。
- en: Though there is standard, ready-to-use R functionality for the *t*-test, at
    the time of this writing, there is no similar function for the *Z*-test (in other
    words, the normal-based test of proportions described here) except in contributed
    packages.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管在R中有标准的现成的*t*-检验功能，但在写作本文时，还没有类似的功能来进行*Z*-检验（换句话说，即本文中描述的基于正态分布的比例检验），除非使用贡献包。
- en: 'Your task is to write a relatively simple R function, `Z.test`, that can perform
    a one- or two-sample *Z*-test, using the following guidelines:'
  id: totrans-263
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您的任务是编写一个相对简单的R函数`Z.test`，该函数可以执行单样本或双样本*Z*-检验，遵循以下指南：
- en: '– The function should take the following arguments: `p1` and `n1` (no default)
    to pose as the estimated proportion and sample size; `p2` and `n2` (both defaulting
    to `NULL`) that contain the second sample proportion and sample size in the event
    of a two-sample test; `p0` (no default) as the null value; and `alternative` (default
    `"two.sided"`) and `conf.level` (default `0.95`), to be used in the same way as
    in `t.test`.'
  id: totrans-264
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: – 该函数应包含以下参数：`p1`和`n1`（无默认值），作为估计的比例和样本大小；`p2`和`n2`（默认值为`NULL`），在进行双样本检验时，包含第二个样本的比例和样本大小；`p0`（无默认值）作为零假设值；以及`alternative`（默认为`"two.sided"`）和`conf.level`（默认为`0.95`），它们的使用方式与`t.test`中的相同。
- en: – When conducting a two-sample test, it should be `p1` that is tested as being
    smaller or larger than `p2` when `alternative="less"` or `alternative="greater"`,
    the same as in the use of `x` and `y` in `t.test`.
  id: totrans-265
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: – 在进行双样本检验时，当`alternative="less"`或`alternative="greater"`时，应测试`p1`是否小于或大于`p2`，这与在`t.test`中使用`x`和`y`是一样的。
- en: – The function should perform a one-sample *Z*-test using `p1`, `n1`, and `p0`
    if either `p2` or `n2` (or both) is `NULL`.
  id: totrans-266
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: – 如果`p2`或`n2`（或两者）为`NULL`，则该函数应使用`p1`、`n1`和`p0`执行单样本*Z*-检验。
- en: – The function should contain a check for the rule of thumb to ensure the validity
    of the normal distribution in both one- and two-sample settings. If this is violated,
    the function should still complete but should issue an appropriate warning message
    (see [Section 12.1.1](ch12.xhtml#ch12lev2sec106)).
  id: totrans-267
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: – 该函数应包含检查法则的功能，以确保在单样本和双样本设置中正态分布的有效性。如果违反了这一点，函数仍然可以完成，但应发出适当的警告信息（参见[第12.1.1节](ch12.xhtml#ch12lev2sec106)）。
- en: – All that need be returned is a list containing the members `Z` (test statistic),
    `P` (appropriate *p*-value—this can be determined by `alternative`; for a two-sided
    test, determining whether `Z` is positive or not can help), and `CI` (two-sided
    CI with respect to `conf.level`).
  id: totrans-268
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: – 需要返回的只是一个列表，其中包含成员`Z`（检验统计量）、`P`（适当的*p*-值——这个值可以通过`alternative`来确定；对于双边检验，通过判断`Z`是否为正值可以帮助确定），以及`CI`（关于`conf.level`的双边置信区间）。
- en: Replicate the two examples in the text of [Sections 18.3.1](ch18.xhtml#ch18lev2sec160)
    and [18.3.2](ch18.xhtml#ch18lev2sec161) using `Z.test`; ensure you reach identical
    results.
  id: totrans-269
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重复[18.3.1节](ch18.xhtml#ch18lev2sec160)和[18.3.2节](ch18.xhtml#ch18lev2sec161)中的两个示例，使用`Z.test`；确保您得出相同的结果。
- en: Call `Z.test(p1=0.11,n1=10,p0=0.1)` to try your warning message in the one-sample
    setting.
  id: totrans-270
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 调用`Z.test(p1=0.11,n1=10,p0=0.1)`来在单样本设置中尝试您的警告信息。
- en: '**18.4 Testing Categorical Variables**'
  id: totrans-271
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**18.4 测试类别变量**'
- en: The normal-based *Z*-test is particular to data that are binary in nature. To
    statistically test claims regarding more general categorical variables, with more
    than two distinct levels, you use the ubiquitous *chi-squared test*. Pronounced
    *kai*, “chi” refers to the Greek symbol χ and is sometimes noted in shorthand
    as the χ² *test*.
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 基于正态分布的*Z*检验特别适用于二元数据。对于更一般的类别变量（具有两个以上不同水平的变量）的统计检验，您需要使用广泛应用的*卡方检验*。*卡方*发音为*kai*，代表希腊字母χ，有时简写为χ²*检验*。
- en: There are two common variants of the chi-squared test. The first—a chi-squared
    test of distribution, also called a *goodness of fit (GOF)* test—is used when
    assessing the frequencies in the levels of a single categorical variable. The
    second—a chi-squared test of *independence*—is employed when you’re investigating
    the relationship between frequencies in the levels of two such variables.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 卡方检验有两种常见变体。第一种是卡方分布检验，也叫*拟合优度（GOF）*检验，它用于评估单一类别变量的各个水平的频率。第二种是卡方*独立性*检验，当你调查两个类别变量之间的频率关系时使用。
- en: '***18.4.1 Single Categorical Variable***'
  id: totrans-274
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***18.4.1 单一类别变量***'
- en: Like the *Z*-test, the one-dimensional chi-squared test is also concerned with
    comparing proportions but in a setting where there are more than two proportions.
    A chi-squared test is used when you have *k* levels (or categories) of a categorical
    variable and want to hypothesize about their relative frequencies to find out
    what proportion of *n* observations fall into each defined category. In the following
    examples, it must be assumed that the categories are *mutually exclusive* (in
    other words, an observation cannot take more than one of the possible categories)
    and *exhaustive* (in other words, the *k* categories cover all possible outcomes).
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 与*Z*检验类似，单维卡方检验也涉及比例比较，但它适用于类别数大于二的情境。当你有*k*个类别（或等级）的类别变量，并希望假设它们的相对频率，从而找出有多少*n*个观察值落入每个定义的类别时，就使用卡方检验。在接下来的例子中，必须假设这些类别是*互斥的*（换句话说，一个观察值不能属于多个类别）和*完备的*（换句话说，这*k*个类别涵盖了所有可能的结果）。
- en: 'I’ll illustrate how hypotheses are constructed and introduce the relevant ideas
    and methods with the following example. Suppose a researcher in sociology is interested
    in the dispersion of rates of facial hair in men of his local city and whether
    they are uniformly represented in the male population. He defines a categorical
    variable with three levels: clean shaven (1), beard only *or* moustache only (2),
    and beard *and* moustache (3). He collects data on 53 randomly selected men and
    finds the following outcomes:'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 我将通过以下示例来说明如何构建假设并介绍相关的思想和方法。假设一位社会学研究员对他所在城市男性面部毛发的分布情况感兴趣，并希望了解这些面部毛发类型是否在男性人群中均匀分布。他定义了一个三层次的类别变量：干净剃须（1），仅有胡须*或*仅有胡子（2），以及胡须*和*胡子（3）。他收集了53名随机选取的男性数据，发现以下结果：
- en: '[PRE38]'
  id: totrans-277
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'Now, the research question asks whether the proportions in each category are
    equally represented. Let *π*[1], *π*[2], and *π*[3] represent the true proportion
    of men in the city who fall into groups 1, 2, and 3, respectively. You therefore
    seek to test these hypotheses:'
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，研究问题是是否每个类别中的比例均衡代表。设*π*[1], *π*[2], 和*π*[3]分别表示城市中属于1、2、3组的男性的真实比例。因此，你需要检验以下假设：
- en: '![image](../images/f0411-01.jpg)'
  id: totrans-279
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f0411-01.jpg)'
- en: For this test, use a standard significance level of 0.05.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个检验，使用标准显著性水平0.05。
- en: The appearance of the alternative hypothesis is a little different from what
    you’ve seen so far but is an accurate reflection of the interpretation of a chi-squared
    goodness of fit test. In these types of problems, H[0] is always that the proportions
    in each group are equal to the stated values, and H[A] is that the data, as a
    whole, do not match the proportions defined in the null. The test is conducted
    assuming the null hypothesis is true, and evidence against the no-change, baseline
    setting will be represented as a small *p*-value.
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 替代假设的形式与之前看到的稍有不同，但它准确反映了卡方拟合优度检验的解释。在这类问题中，H[0]始终是每个组的比例等于声明的值，H[A]是数据整体与零假设中定义的比例不匹配。假设检验是在假设零假设成立的前提下进行的，反对零假设的证据将以较小的*P*值呈现。
- en: '**Calculation: Chi-Squared Test of Distribution**'
  id: totrans-282
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**计算：卡方分布检验**'
- en: The quantities of interest are the proportion of *n* observations in each of
    *k* categories, *π*[1], ..., *π*[k], for a single mutually exclusive and exhaustive
    categorical variable. The null hypothesis defines hypothesized null values for
    each proportion; label these respectively as *π*[0][(][1][)], ..., *π*[0][(][k][)].
    The test statistic χ² is given as
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 感兴趣的量是每个*k*类别中*n*个观察值的比例，*π*[1], ..., *π*[k]，这是针对单一的互斥且完备的类别变量。原假设定义了每个比例的假定零值；分别将这些标签为*π*[0][(][1][)],
    ..., *π*[0][(][k][)]。检验统计量χ²定义为
- en: '![image](../images/e18-11.jpg)'
  id: totrans-284
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e18-11.jpg)'
- en: where *O[i]* is the *observed* count and *E[i]* is the *expected* count in the
    *i*th category; *i* = 1, ..., *k*. The *O[i]* are obtained directly from the raw
    data, and the expected counts, *E[i]* = *nπ*[0]*[(][i][)]*, are merely the product
    of the overall sample size *n* with the respective null proportion for each category.
    The result of χ² follows a *chi-squared distribution* (explained further momentarily)
    with *ν* = *k* − 1 degrees of freedom. You usually consider the test to be valid
    based on an informal rule of thumb stating that at least 80 percent of the expected
    counts *E[i]* should be at least 5.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 *O[i]* 是第 *i* 类别的 *观察* 计数，*E[i]* 是第 *i* 类别的 *期望* 计数；*i* = 1, ..., *k*。*O[i]*
    直接从原始数据中获得，期望计数 *E[i]* = *nπ*[0]*[(][i][)]*，仅仅是总体样本量 *n* 与每个类别相应的零假设比例的乘积。χ² 的结果遵循
    *卡方分布*（稍后会进一步解释），自由度为 *ν* = *k* − 1。通常情况下，根据一个非正式的经验法则，检验被认为有效，当期望计数 *E[i]* 中至少
    80% 的值应大于或等于 5。
- en: 'In this type of chi-squared test, it is important to note the following:'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种卡方检验中，需要注意以下几点：
- en: • The term *goodness of fit* refers to the proximity of the observed data to
    the distribution hypothesized in H[0].
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: • *拟合优度* 一词指的是观察数据与 H[0] 中假定分布的接近程度。
- en: • Positive extremity of the result of (18.11) provides evidence against H[0].
    As such, the corresponding *p-value is always computed as an upper-tail area*.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: • 结果 (18.11) 的正端提供了反对 H[0] 的证据。因此，相应的 *p-值总是作为上尾面积计算*。
- en: • As in the current example, a test for uniformity simplifies the null hypothesis
    slightly by having equivalent null proportions *π*[0] = *π*[0][(][1][)] = ...
    = *π*[0]*[(][k][)]*.
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: • 正如当前示例中所示，均匀性检验通过将零假设比例 *π*[0] = *π*[0][(][1][)] = ... = *π*[0]*[(][k][)]*
    稍微简化了零假设。
- en: • A rejected H[0] doesn’t tell you about the true values of *π[i]*. It merely
    suggests that they do not follow H[0] specifically.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: • 拒绝 H[0] 并不能告诉你 *π[i]* 的真实值。它仅仅表明它们并不完全符合 H[0]。
- en: The chi-squared distribution relies on specification of a degree of freedom,
    much like the *t*-distribution. Unlike a *t* curve, however, a chi-squared curve
    is unidirectional in nature, being defined for non-negative values and with a
    positive (right-hand) horizontal asymptote (tail going to zero).
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 卡方分布依赖于自由度的指定，就像 *t* 分布一样。然而，与 *t* 曲线不同，卡方曲线本质上是单向的，只定义为非负值，并具有正的（右侧）水平渐近线（尾部趋向零）。
- en: It’s this unidirectional distribution that leads to *p*-values being defined
    as upper-tail areas only; decisions like one- or two-tailed areas have no relevance
    in these types of chi-squared tests. To get an idea of what the density functions
    actually look like, [Figure 18-1](ch18.xhtml#ch18fig1) shows three particular
    curves defined with *ν* = 1, *ν* = 5, and *ν* = 10 degrees of freedom.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 正是这种单向分布导致了 *p*-值仅定义为上尾面积；一尾或二尾面积在这类卡方检验中没有相关性。为了了解密度函数的实际形态， [图 18-1](ch18.xhtml#ch18fig1)
    展示了三条特定的曲线，定义了 *ν* = 1, *ν* = 5 和 *ν* = 10 的自由度。
- en: '![image](../images/f18-01.jpg)'
  id: totrans-293
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f18-01.jpg)'
- en: '*Figure 18-1: Three instances of the chi-squared density function using differing
    degrees of freedom values. Note the positive domain of the function and the “flattening”
    and “right-extending” behavior as* *ν* *is increased.*'
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 18-1：使用不同自由度值的三种卡方密度函数实例。请注意该函数的正域及其“平坦化”和“右延展”行为，随着*ν*的增加。*'
- en: This image was produced using the relevant `d`-function, `dchisq`, with *ν*
    passed to the argument `df`.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 该图像是使用相关的 `d` 函数 `dchisq` 生成的，*ν* 被传递给 `df` 参数。
- en: '[PRE39]'
  id: totrans-296
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: The current facial hair example is a test for the uniformity of the distribution
    of frequencies in the three categories. You can obtain the observed counts and
    corresponding proportions with `table`.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 当前的面部毛发示例是检验三类频率分布均匀性的测试。你可以通过 `table` 获取观察到的计数和相应的比例。
- en: '[PRE40]'
  id: totrans-298
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: For computation of the test statistic χ², you have the observed counts *O[i]*
    in `hairy.tab`. The expected count *E[i]* is a straightforward arithmetic calculation
    of the total number of observations multiplied by the null proportion 1/3 (the
    result stored as `expected`), giving you the same value for each category.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 计算检验统计量 χ² 时，观察到的计数 *O[i]* 存储在 `hairy.tab` 文件中。期望计数 *E[i]* 是一个直接的算术计算，计算方式为总观察数乘以零假设比例
    1/3（结果存储在 `expected` 中），这样你可以为每个类别得到相同的值。
- en: These, as well as the contribution of each category to the test statistic, are
    nicely presented in a matrix constructed with `cbind` ([Section 3.1.2](ch03.xhtml#ch03lev2sec25)).
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 这些，以及每个类别对检验统计量的贡献，都以矩阵形式很好地呈现出来，该矩阵是通过`cbind`构造的（见[第3.1.2节](ch03.xhtml#ch03lev2sec25)）。
- en: '[PRE41]'
  id: totrans-301
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Note that all the expected counts are comfortably greater than 5, which satisfies
    the informal rule of thumb mentioned earlier. In terms of R coding, note also
    that the single number `expected` is implicitly recycled to match the length of
    the other vectors supplied to `cbind` and that you’ve used the `dimnames` attribute
    (refer to [Section 6.2.1](ch06.xhtml#ch06lev2sec59)) to annotate the rows and
    columns.
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，所有期望频数都大于5，这满足之前提到的非正式经验法则。在R编码方面，还需要注意，单个数字`expected`会被隐式回收，以匹配传递给`cbind`的其他向量的长度，并且你使用了`dimnames`属性（参见[第6.2.1节](ch06.xhtml#ch06lev2sec59)）来注释行和列。
- en: The test statistic, as per (18.11), is given as the sum of the (*O[i]* − *E[i]*)²/*E*[i]
    contributions in the fourth column of `hairy.matrix`.
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 根据公式（18.11），检验统计量是通过第四列`hairy.matrix`中(*O[i]* − *E[i]*)²/*E*[i]的贡献计算得出的。
- en: '[PRE42]'
  id: totrans-304
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: The corresponding *p*-value is the appropriate upper-tail area from the chi-squared
    distribution with *ν* = 3 − 1 = 2 degrees of freedom.
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 对应的*p*-值是从卡方分布中取出的适当的上尾区域，*ν* = 3 − 1 = 2个自由度。
- en: '[PRE43]'
  id: totrans-306
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: This small *p*-value provides evidence to suggest that the true frequencies
    in the defined categories of male facial hair are not uniformly distributed in
    a 1/3,1/3,1/3 fashion. Remember that the test result doesn’t give you the true
    proportions but only suggests that they do not follow those in H[0].
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 这个非常小的*p*-值提供了证据，表明在定义的男性面部毛发类别中的真实频率并没有均匀分布为1/3, 1/3, 1/3的比例。请记住，检验结果并不会给出真实的比例，而只是表明这些比例并不符合H[0]中的假设。
- en: '**R Function: chisq.test**'
  id: totrans-308
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**R函数：chisq.test**'
- en: 'Like `t.test` and `prop.test`, R provides a quick-use function for performing
    a chi-squared GOF test. The `chisq.test` function takes the vector of observed
    frequencies as its first argument `x`. For the facial hair example, this simple
    line therefore provides the same results as found previously:'
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 与` t.test`和`prop.test`类似，R提供了一个用于执行卡方拟合优度（GOF）测试的快速函数。`chisq.test`函数将观察到的频率向量作为第一个参数`x`。对于面部毛发的例子，这一简单的代码行提供了与之前相同的结果：
- en: '[PRE44]'
  id: totrans-310
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'By default, the function performs a test for uniformity, taking the number
    of categories as the length of the vector supplied to `x`. However, suppose that
    the researcher collecting the facial hair data realizes that he was doing so in
    November, a month during which many men grow mustaches in support of “Mo-vember”
    to raise awareness of men’s health. This changes thoughts on the true rates in
    terms of his clean-shaven (1), beard-only *or* moustache-only (2), and beard *and*
    moustache (3) categories. He now wants to test the following:'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，函数执行的是均匀性检验，认为类别的数量等于传递给`x`的向量的长度。然而，假设收集面部毛发数据的研究人员意识到他是在11月收集数据的，那是一个许多男性为了支持“Mo-vember”运动而蓄胡须的月份，以提高对男性健康的关注。这改变了他对清洁剃须（1）、仅有胡须或仅有小胡子（2）、以及胡须和小胡子同时存在（3）类别的真实比例的看法。他现在想测试以下内容：
- en: 'H[0] : *π*[0][(][1][)] = 0.25; *π*[0][(][2][)] = 0.5; *π*[0][(][3][)] = 0.25'
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[0] : *π*[0][(][1][)] = 0.25； *π*[0][(][2][)] = 0.5； *π*[0][(][3][)] = 0.25'
- en: 'H[A] : H[0] is incorrect.'
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[A] : H[0] 是错误的。'
- en: If a GOF test of uniformity is not desired, when the “true” rates across the
    categories are not all the same, the `chisq.test` function requires you to supply
    the null proportions as a vector of the same length as `x` to the `p` argument.
    Naturally, each entry in `p` must correspond to the categories tabulated in `x`.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 如果不想进行均匀性的拟合优度（GOF）检验，在类别的“真实”比例不相同的情况下，`chisq.test`函数要求你将原假设比例作为与`x`长度相同的向量传递给`p`参数。自然地，`p`中的每个条目必须与`x`中列出的类别相对应。
- en: '[PRE45]'
  id: totrans-315
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: With a very high *p*-value, there is no evidence to reject H[0] in this scenario.
    In other words, there is no evidence to suggest that the proportions hypothesized
    in H[0] are incorrect.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 在*p*-值非常高的情况下，没有证据可以拒绝H[0]。换句话说，没有证据表明H[0]中的假设比例是错误的。
- en: '***18.4.2 Two Categorical Variables***'
  id: totrans-317
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***18.4.2 两个分类变量***'
- en: 'The chi-squared test can also apply to the situation in which you have *two*
    mutually exclusive and exhaustive categorical variables at hand—call them variable
    *A* and variable *B*. It is used to detect whether there might be some influential
    relationship (in other words, *dependence*) between *A* and *B* by looking at
    the way in which the distribution of frequencies change together with respect
    to their categories. If there is no relationship, the distribution of frequencies
    in variable *A* will have nothing to do with the distribution of frequencies in
    variable *B*. As such, this particular variant of the chi-squared test is called
    a *test of independence* and is always performed with the following hypotheses:'
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 卡方检验也适用于具有*两个*互斥且穷尽的分类变量的情况——将它们称为变量*A*和*B*。它用于检测变量*A*和*B*之间是否存在某种影响关系（换句话说，*依赖性*），通过观察频数分布如何随着类别的变化而共同变化。如果没有关系，变量*A*的频数分布将与变量*B*的频数分布无关。因此，这种特定形式的卡方检验被称为*独立性检验*，并始终假设以下假设：
- en: 'H[0] : Variables *A* and *B* are independent.'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[0] : 变量*A*和*B*是独立的。'
- en: (*or*, There is no relationship between *A* and *B*.)
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: (*或者*，*A*和*B*之间没有关系。)
- en: 'H[A] : Variables *A* and *B* are *not* independent.'
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[A] : 变量*A*和*B*是*不*独立的。'
- en: (*or*, There *is* a relationship between *A* and *B*.)
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: (*或者*，*A*和*B*之间*有*关系。)
- en: To carry out the test, therefore, you compare the observed data to the counts
    you’d expect to see if the distributions were completely unrelated (satisfying
    the assumption that H[0] is true). An overall large departure from the expected
    frequencies will result in a small *p*-value and thus provide evidence against
    the null.
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，为了进行检验，你需要将观察到的数据与在分布完全无关（即假设H[0]为真）时期望看到的频数进行比较。若实际频数与期望频数偏差较大，则会导致较小的*p*-值，从而提供反对原假设的证据。
- en: So, how are such data best presented? For two categorical variables, a two-dimensional
    structure is appropriate; in R, this is a standard matrix. For example, suppose
    some dermatologists at a certain clinical practice are interested in their successes
    in treating a common skin affliction. Their records show *N* = 355 patients have
    been treated at their clinic using one of four possible treatments—a course of
    tablets, a series of injections, a laser treatment, and an herbal-based remedy.
    The level of success in curing the affliction is also recorded—none, partial success,
    and full success. The data are given in the constructed matrix `skin`.
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，如何最好地呈现这类数据呢？对于两个分类变量，二维结构是合适的；在R中，这是一种标准矩阵。例如，假设某些皮肤科医生对治疗常见皮肤病的成功率感兴趣。它们的记录显示*N*
    = 355名患者在他们的诊所接受了四种可能治疗中的一种——一疗程药片、系列注射、激光治疗和草药治疗。治愈情况也被记录——无效、部分成功和完全成功。数据以构建的矩阵`skin`给出。
- en: '[PRE46]'
  id: totrans-325
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: A two-dimensional table presenting frequencies in this fashion is called a *contingency
    table*.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 以这种方式呈现频数的二维表格称为*列联表*。
- en: '**Calculation: Chi-Squared Test of Independence**'
  id: totrans-327
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**计算：卡方独立性检验**'
- en: To compute the test statistic, presume data are presented as a *k[r]* × *k[c]*
    contingency table, in other words, a matrix of counts, based on two categorical
    variables (both mutually exclusive and exhaustive). The focus of the test is the
    way in which the frequencies of *N* observations between the *k[r]* levels of
    the “row” variable and the *k[c]* levels of the “column” variable are jointly
    distributed. The test statistic χ² is given with
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 为了计算检验统计量，假设数据以*k[r]* × *k[c]*的列联表形式呈现，换句话说，是基于两个分类变量（均为互斥且穷尽的）的计数矩阵。检验的重点是观察*N*个观测值在“行”变量的*k[r]*个水平和“列”变量的*k[c]*个水平之间频数的联合分布。检验统计量χ²计算公式如下：
- en: '![image](../images/e18-12.jpg)'
  id: totrans-329
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e18-12.jpg)'
- en: where *O*[[]*[i][,] [j]*] is the observed count and *E*[[]*[i][,] [j]*] is the
    expected count at row position *i* and column position *j*. Each *E*[[]*[i][,]
    [j]*] is found as the sum total of row *i* multiplied by the sum total of column
    *j*, all divided by *N*.
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，*O*[[]*[i][,] [j]*] 是观察到的频数，*E*[[]*[i][,] [j]*] 是第*i*行第*j*列的预期频数。每个*E*[[]*[i][,]
    [j]*]是将第*i*行的总和乘以第*j*列的总和，再除以*N*得到的。
- en: '![image](../images/e18-13.jpg)'
  id: totrans-331
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e18-13.jpg)'
- en: The result, χ², follows a chi-squared distribution with *ν* = (*k[r]* − 1) ×
    (*k[c]* − 1) degrees of freedom. Again, the *p*-value is always an upper-tailed
    area, and you can consider the test valid with the satisfaction of the condition
    that at least 80 percent of the *E*[[]*[i][,] [j]*] are at least 5.
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 结果，χ²，遵循卡方分布，*ν* = (*k[r]* − 1) × (*k[c]* − 1)的自由度。同样，*p*-值始终是一个上尾区域，当至少80%的*E*[[]*[i][,]
    [j]*]大于等于5时，你可以认为该检验是有效的。
- en: 'For this calculation, it’s important to note the following:'
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个计算，需要注意以下几点：
- en: • It’s not necessary to assume that *k[r]* = *k[c]*.
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: • 不必假设*k[r]* = *k[c]*。
- en: • The functionality of [Equation (18.12)](ch18.xhtml#ch18eq12) is the same as
    that of (18.11)—an overall sum involving the squared differences between the observed
    and expected values of each cell.
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: • [方程 (18.12)](ch18.xhtml#ch18eq12)的功能与(18.11)相同——它涉及到每个单元格观察值和期望值之间的平方差的总和。
- en: • The double-sum in (18.12) just represents the total sum over all the cells,
    in the sense that you can compute the total sample size *N* with ![image](../images/f0416-03.jpg).
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: • (18.12)中的双重求和仅表示所有单元格的总和，意思是你可以通过![image](../images/f0416-03.jpg)来计算总样本量*N*。
- en: • A rejected H[0] doesn’t tell you about the nature of *how* the frequencies
    depend on one another, just that there is evidence to suggest that some kind of
    dependency between the two categorical variables exists.
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: • 拒绝H[0]并不能告诉你频率之间相互依赖的性质，只是表明有证据表明这两个分类变量之间可能存在某种依赖关系。
- en: Continuing with the example, the dermatologists want to determine whether their
    records suggest there is statistical evidence to indicate some relationship between
    the type of treatment and the level of success in curing the skin affliction.
    For convenience, store the total number of categories *k[r]* and *k[c]* for the
    row and column variables, respectively.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 继续这个例子，皮肤科医生希望确定他们的记录是否表明有统计证据表明治疗类型与皮肤疾病治愈成功率之间存在某种关系。为了方便，分别存储行变量和列变量的类别总数*k[r]*和*k[c]*。
- en: '[PRE47]'
  id: totrans-339
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: You have the *O*[[]*[i][,] [j]*] in `skin`, so now you must now compute the
    *E*[[]*[i][,] [j]*]. In light of [Equation (18.13)](ch18.xhtml#ch18eq13), which
    deals with row and column sums, you can evaluate these using the built-in `rowSums`
    and `colSums` functions.
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 你在`skin`中有*O*[[]*[i][,] [j]*]，所以现在你必须计算*E*[[]*[i][,] [j]*]。根据[方程 (18.13)](ch18.xhtml#ch18eq13)，它涉及行和列的总和，你可以使用内建的`rowSums`和`colSums`函数来评估这些。
- en: '[PRE48]'
  id: totrans-341
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'These results indicate the totals in each group, regardless of the other variable.
    To get the expected counts for all cells of the matrix, [Equation (18.13)](ch18.xhtml#ch18eq13)
    requires each row sum to be multiplied by each column sum once. You could write
    a `for` loop, but this would be inefficient and rather inelegant. It is better
    to use `rep` with the optional `each` argument (refer to [Section 2.3.2](ch02.xhtml#ch02lev2sec21)).
    By repeating each element of the column totals (level of success) four times,
    you can then use vector-oriented behavior to multiply that repeated vector by
    the shorter vector produced by `rowSums`. You can then call `sum(skin)` to divide
    this by *N* and rearrange it into a matrix. The following lines show how this
    example works step-by-step:'
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 这些结果表示每组中的总数，不考虑其他变量。要获取矩阵中所有单元格的期望频数，[方程 (18.13)](ch18.xhtml#ch18eq13)要求将每行和每列的总和相乘一次。你可以写一个`for`循环，但这会低效且不优雅。更好的做法是使用带有可选`each`参数的`rep`（参考[第2.3.2节](ch02.xhtml#ch02lev2sec21)）。通过将列总和（成功的水平）中的每个元素重复四次，你可以利用向量化行为，将这个重复的向量与`rowSums`产生的较短向量相乘。然后，你可以调用`sum(skin)`将其除以*N*并重新排列成矩阵。以下几行展示了这个示例是如何一步步实现的：
- en: '[PRE49]'
  id: totrans-343
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: Note that all the expected values are greater than 5, as preferred.
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，所有期望值都大于5，这是首选的情况。
- en: It’s best to construct a single object to hold the results of the different
    stages of calculations leading to the test statistic, as you did for the one-dimensional
    example. Since each stage is a matrix, you can bind the relevant matrices together
    with `cbind` and produce an array of the appropriate dimensions (refer to [Section
    3.4](ch03.xhtml#ch03lev1sec15) for a refresher).
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 最好构造一个单一的对象来保存计算不同阶段的结果，以得到检验统计量，就像你在一维示例中所做的那样。由于每个阶段都是一个矩阵，你可以使用`cbind`将相关矩阵结合在一起，并生成具有适当维度的数组（详细参考[第3.4节](ch03.xhtml#ch03lev1sec15)）。
- en: '[PRE50]'
  id: totrans-346
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: The final steps are easy—the test statistic given by (18.12) is just the grand
    total of all elements of the matrix that is the third layer of `skin.array`.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 最后的步骤很简单——由 (18.12) 给出的检验统计量仅仅是 `skin.array` 第三层矩阵所有元素的总和。
- en: '[PRE51]'
  id: totrans-348
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'The corresponding *p*-value for this test of independence is as follows:'
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: 此独立性检验的相应 *p*-值如下：
- en: '[PRE52]'
  id: totrans-350
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: Recall that the relevant degrees of freedom are defined as *ν* = (*k[r]* − 1)
    × (*k[c]* − 1).
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 回想一下，相关的自由度定义为 *ν* = (*k[r]* − 1) × (*k[c]* − 1)。
- en: The extremely small *p*-value provides strong evidence against the null hypothesis.
    The appropriate conclusion would be to reject H[0] and state that there does appear
    to be a relationship between the type of treatment for the skin affliction and
    the level of success in curing it.
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 极小的 *p*-值为反对原假设提供了强有力的证据。适当的结论是拒绝 H[0]，并指出皮肤疾病治疗类型与治愈成功率之间似乎存在关系。
- en: '**R Function: chisq.test**'
  id: totrans-353
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**R 函数：chisq.test**'
- en: 'Yet once more, no section in this chapter would be complete without showcasing
    the built-in functionality R possesses for these fundamental procedures. The default
    behavior of `chisq.test`, when supplied a matrix as `x`, is to perform a chi-squared
    test of independence with respect to the row and column frequencies—just as performed
    manually here for the skin affliction example. The following result easily confirms
    your previous calculations:'
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，再一次，本章的任何部分如果没有展示 R 在这些基本程序中内置的功能，将不完整。当 `chisq.test` 接受一个矩阵作为 `x` 时，其默认行为是执行一个卡方独立性检验，检验行和列频率的独立性——就像这里对皮肤疾病示例进行的手动计算一样。以下结果轻松验证了你之前的计算：
- en: '[PRE53]'
  id: totrans-355
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: '**Exercise 18.4**'
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: '**练习 18.4**'
- en: '`HairEyeColor` is a ready-to-use data set in R that you haven’t yet come across.
    This 4 × 4 × 2 array provides frequencies of hair and eye colors of 592 statistics
    students, split by sex ([Snee, 1974](ref.xhtml#ref61)).'
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: '`HairEyeColor` 是 R 中的一个现成数据集，你可能还没遇到过。这个 4 × 4 × 2 的数组提供了 592 名统计学学生的发色和眼色频率，按性别划分（[Snee,
    1974](ref.xhtml#ref61)）。'
- en: Perform and interpret, at a significance level of *α* = 0.01, a chi-squared
    test of independence for hair against eye color for all students, regardless of
    their sex.
  id: totrans-358
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在显著性水平 *α* = 0.01 下，对所有学生（无论性别）进行发色与眼色的卡方独立性检验，并进行解释。
- en: In [Exercise 8.1](ch08.xhtml#ch8exc1) on [page 161](ch08.xhtml#page_161), you
    accessed the `Duncan` data set of the contributed package `car`, which contains
    markers of job prestige collected in 1950\. Install the package if you haven’t
    already and load the data frame.
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 在 [练习 8.1](ch08.xhtml#ch8exc1) 中，你访问了贡献包 `car` 中的 `Duncan` 数据集，包含了 1950 年收集的工作声望标记。如果你还没有安装该包，请安装并加载数据框。
- en: 'The first column of `Duncan` is the variable `type`, recording the type of
    job as a factor with three levels: `prof` (professional or managerial), `bc` (blue
    collar), and `wc` (white collar). Construct appropriate hypotheses and perform
    a chi-squared GOF test to determine whether the three job types are equally represented
    in the data set.'
  id: totrans-360
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`Duncan` 的第一列是变量 `type`，记录作为因子具有三种水平的工作类型：`prof`（专业或管理）、`bc`（蓝领）和 `wc`（白领）。构造适当的假设并执行卡方拟合优度检验，以确定三种工作类型在数据集中是否平等地分布。'
- en: Interpret the resulting *p*-value with respect to a significance level of *α*
    = 0.05.
  id: totrans-361
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据显著性水平 *α* = 0.05 解释结果中的 *p*-值。
- en: What conclusion would you reach if you used a significance level of *α* = 0.01?
  id: totrans-362
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你使用显著性水平 *α* = 0.01，会得出什么结论？
- en: '**18.5 Errors and Power**'
  id: totrans-363
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**18.5 误差与检验力**'
- en: 'In discussing all these forms of statistical hypothesis testing, there has
    been one common thread: the interpretation of a *p*-value and what it tells you
    about your problem in terms of the hypotheses. Frequentist statistical hypothesis
    testing is ubiquitous in many fields of research, so it is important to at least
    briefly explore directly related concepts.'
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 在讨论所有这些形式的统计假设检验时，有一个共同的主题：对 *p*-值的解释，以及它在假设检验中的意义。频率学派统计假设检验在许多研究领域中广泛应用，因此至少要简要探索与之直接相关的概念。
- en: '***18.5.1 Hypothesis Test Errors***'
  id: totrans-365
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***18.5.1 假设检验误差***'
- en: Hypothesis testing is performed with the objective of obtaining a *p*-value
    in order to quantify evidence against the null statement H[0]. This is rejected
    in favor of the alternative, H[A], if the *p*-value is itself less than a predefined
    significance level *α*, which is conventionally 0.05 or 0.01\. As touched upon,
    this approach is justifiably criticized since the choice of *α* is essentially
    arbitrary; a decision to reject or retain H[0] can change depending solely upon
    the *α* value.
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 假设检验的目的是获得一个*p*值，以量化反对原假设H[0]的证据。如果*p*值小于预先定义的显著性水平*α*（通常为0.05或0.01），则拒绝原假设，接受备择假设H[A]。如前所述，这种方法被批评是正当的，因为*α*的选择基本上是任意的；拒绝或保留H[0]的决定可以仅仅依赖于*α*值的变化。
- en: Consider for the moment, given a specific test, what the *correct* outcome is.
    If H[0] is really true, then you’d want to retain it. If H[A] is really true,
    you’d want to reject the null. This “truth,” one way or another, is impossible
    to know in practice. That being said, it’s useful to consider in a theoretical
    sense just how good (or bad) a given hypothesis test is at yielding a result that
    leads to the correct conclusion.
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 设想一下，在某个特定的检验中，*正确*的结果是什么。如果H[0]是真的，那么你就应该保留它。如果H[A]是真的，那么你应该拒绝原假设。这种“真理”，无论如何，在实践中是无法知道的。话虽如此，从理论上考虑给定假设检验在得出正确结论方面的效果（好或坏）仍然是有意义的。
- en: 'To be able to test the validity of your rejection or retention of the null
    hypothesis, you must be able to identify two kinds of errors:'
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 为了能够测试你拒绝或保留原假设的有效性，你必须能够识别两种类型的错误：
- en: • A *Type I error* occurs when you incorrectly reject a true H[0]. In any given
    hypothesis test, the probability of a Type I error is equivalent to the significance
    level *α*.
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: • 当你错误地拒绝一个真实的H[0]时，就会发生*第一类错误*。在任何给定的假设检验中，第一类错误的概率等同于显著性水平*α*。
- en: • A *Type II error* occurs when you incorrectly retain a false H[0] (in other
    words, fail to accept a true H[A]). Since this depends upon what the true H[A]
    actually is, the probability of committing such an error, labeled *β*, is not
    usually known in practice.
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: • 当你错误地保留一个错误的H[0]（换句话说，未能接受一个真实的H[A]）时，就会发生*第二类错误*。由于这取决于真实的H[A]是什么，因此，发生这种错误的概率，标记为*β*，在实践中通常是无法知道的。
- en: '***18.5.2 Type I Errors***'
  id: totrans-371
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***18.5.2 第一类错误***'
- en: If your *p*-value is less than *α*, you reject the null statement. If the null
    is really true, though, the *α* directly defines the probability that you *incorrectly*
    reject it. This is referred to as a *Type I error*.
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的*p*值小于*α*，则拒绝原假设。但是，如果原假设实际上是真的，*α*直接定义了你*错误*拒绝它的概率。这被称为*第一类错误*。
- en: '[Figure 18-2](ch18.xhtml#ch18fig2) provides a conceptual illustration of a
    Type I error probability for a supposed hypothesis test of a sample mean, where
    the hypotheses are set up as H[0] : *μ* = *μ*[0] and H[A] : *μ* > *μ*[0].'
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: '[图18-2](ch18.xhtml#ch18fig2)提供了一个假设检验中第一类错误概率的概念性示意图，其中假设设定为H[0] : *μ* = *μ*[0]
    和 H[A] : *μ* > *μ*[0]。'
- en: '![image](../images/f18-02.jpg)'
  id: totrans-374
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f18-02.jpg)'
- en: '*Figure 18-2: A conceptual diagram of the Type I error probability* *α*'
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: '*图18-2：第一类错误概率* *α*的概念图'
- en: The null hypothesis distribution is centered on the null value *μ*[0]; the alternative
    hypothesis distribution is centered to its right at some mean *μ*[A] in [Figure
    18-2](ch18.xhtml#ch18fig2). As you can see, if the null hypothesis is really true,
    then the probability it is incorrectly rejected for this test will be equal to
    the significance level *α*, located in the upper tail of the null distribution.
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 原假设分布以原值*μ*[0]为中心；备择假设分布以其右侧的某个均值*μ*[A]为中心，如[图18-2](ch18.xhtml#ch18fig2)所示。如你所见，如果原假设是真的，那么在此检验中错误地拒绝它的概率将等于显著性水平*α*，位于原假设分布的右尾部。
- en: '**Simulating Type I Errors**'
  id: totrans-377
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**模拟第一类错误**'
- en: 'To demonstrate the Type I error rate via *numerical simulation* (here, this
    refers to randomly generating hypothetical data samples), you can write code that
    does the equivalent of repeating a hypothesis test under known conditions. So
    that you can use this code multiple times, in the R script editor define the following
    function:'
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: 为了通过*数值模拟*演示第一类错误率（这里指的是随机生成假设数据样本），你可以编写代码，执行等效的重复假设检验。为了能够多次使用此代码，可以在R脚本编辑器中定义以下函数：
- en: '[PRE54]'
  id: totrans-379
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 'The `typeI.tester` function is designed to generate `ITERATIONS` samples from
    a particular normal distribution. With each sample, you’ll perform an upper-tailed
    test of the mean (refer to [Section 18.2.1](ch18.xhtml#ch18lev2sec158)) in the
    spirit of [Figure 18-2](ch18.xhtml#ch18fig2), assuming the hypotheses of H[0]
    : *μ* = *μ*[0] and H[A] : *μ* > *μ*[0].'
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: '`typeI.tester`函数旨在从特定的正态分布中生成`ITERATIONS`个样本。对于每个样本，你将进行一个关于均值的右尾检验（参考[第18.2.1节](ch18.xhtml#ch18lev2sec158)），遵循[图18-2](ch18.xhtml#ch18fig2)中的思路，假设原假设H[0]
    : *μ* = *μ*[0]和备择假设H[A] : *μ* > *μ*[0]。'
- en: You can decrease `ITERATIONS` to generate fewer entire samples, and this will
    speed up computation time but will result in simulated rates that are more variable.
    Each entire sample of size `n` of hypothetical raw measurements is generated using
    `rnorm` with the mean equal to the `mu0` argument (and standard deviation equal
    to the `sigma` argument). The desired significance level is set by `alpha`. In
    the `for` loop, the sample mean and sample standard deviation are calculated for
    each generated sample.
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以减少`ITERATIONS`以生成较少的完整样本，这样可以加速计算时间，但会导致模拟的错误率更为波动。每个大小为`n`的假设原始测量的完整样本都是使用`rnorm`生成的，均值为`mu0`参数（标准差为`sigma`参数）。所需的显著性水平由`alpha`设置。在`for`循环中，为每个生成的样本计算样本均值和样本标准差。
- en: Were each sample subjected to a “real” hypothesis test, the *p*-value would
    be taken from the right-hand area of the *t*-distribution with `n-1` degrees of
    freedom (using `pt`), with respect to the standardized test statistic given earlier
    in [Equation (18.2)](ch18.xhtml#ch18eq2).
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: 如果每个样本都经过“真实”的假设检验，*p*值将取自自由度为`n-1`的*t*分布的右侧区域（使用`pt`），并依据之前在[公式 (18.2)](ch18.xhtml#ch18eq2)中给出的标准化检验统计量。
- en: The calculated *p*-value, at each iteration, is stored in a predefined vector
    `pvals`. The logical vector `pvals<alpha` therefore contains corresponding `TRUE`/`FALSE`
    values; the former logical value flags rejection of the null hypothesis, and the
    latter flags retention. The Type I error rate is determined by calling `mean`
    on that logical vector, which yields the proportion of `TRUE`s (in other words,
    the overall proportion of “null hypothesis rejections”) arising from the simulated
    samples. Remember, the samples are generated randomly, so your results are liable
    to change slightly each time you run the function.
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 在每次迭代中计算出的*p*值存储在预定义的向量`pvals`中。因此，逻辑向量`pvals<alpha`包含相应的`TRUE`/`FALSE`值；前者逻辑值标志着原假设的拒绝，后者标志着原假设的保留。I型错误率是通过对该逻辑向量调用`mean`得到的，它返回`TRUE`的比例（换句话说，就是“原假设被拒绝”的总体比例），该比例来自模拟的样本。请记住，样本是随机生成的，因此每次运行函数时，结果可能会稍微有所变化。
- en: This function works because, by definition of the problem, the samples that
    are being generated come from a distribution that truly has the mean set at the
    null value, in other words, *μ*[A] = *μ*[0]. Therefore, any statistical rejection
    of this statement, obtained with a *p*-value less than the significance level
    *α*, is clearly incorrect and is purely a result of random variation.
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: 该函数之所以有效，是因为根据问题的定义，正在生成的样本来自一个均值确实设定为原假设值的分布，换句话说，*μ*[A] = *μ*[0]。因此，任何对该陈述的统计拒绝，如果*p*值小于显著性水平*α*，显然是错误的，完全是随机变异的结果。
- en: 'To try this, import the function and execute it generating the default `ITERATIONS=10000`
    samples. Use the standard normal as the null (and “true” in this case!) distribution;
    make each sample of size 40 and set the significance level at the conventional
    *α* = 0.05\. Here’s an example:'
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: 要尝试此操作，导入该函数并执行，生成默认的`ITERATIONS=10000`个样本。使用标准正态分布作为原假设分布（在此情况下为“真实”分布）；使每个样本的大小为40，并将显著性水平设置为常规的*α*
    = 0.05。以下是一个示例：
- en: '[PRE55]'
  id: totrans-386
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: This indicates that 10,000 × 0.0489 = 489 of the samples taken yielded a corresponding
    test statistic that provided a *p*-value, which would incorrectly result in rejection
    of H[0]. This simulated Type I error rate lies close to the preset `alpha=0.05`.
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: 这表明，取自样本的10,000 × 0.0489 = 489个样本，得到了一个相应的检验统计量，提供了一个*p*值，这将错误地导致拒绝H[0]。这个模拟的I型错误率接近预设的`alpha=0.05`。
- en: 'Here’s another example, this time for nonstandard normal data samples with
    *α* = 0.01:'
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 这是另一个示例，这次使用非标准正态数据样本，*α* = 0.01：
- en: '[PRE56]'
  id: totrans-389
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: Note that again, the numerically simulated rate of Type I error reflects the
    significance level.
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，再次提醒，数值模拟的I型错误率反映了显著性水平。
- en: These results are not difficult to understand theoretically—if the true distribution
    does indeed have a mean equal to the null value, you’ll naturally observe those
    “extreme” test statistic values in practice at a rate equal to *α*. The catch,
    of course, is that in practice the true distribution is unknown, highlighting
    once more the fact that a rejection of any H[0] can never be interpreted as proof
    of the truth of H[A]. It might simply be that the sample you observed followed
    the null hypothesis but produced an extreme test statistic value by chance, however
    small that chance might be.
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: 这些结果在理论上并不难理解——如果真实分布确实具有等于零假设值的均值，您将自然地在实践中以等于*α*的频率观察到这些“极端”的检验统计量值。当然，问题在于，在实践中真实分布是未知的，这再次强调了拒绝任何H[0]不能被解读为H[A]为真的证明。可能仅仅是您观察到的样本遵循了零假设，但由于偶然原因（无论这种偶然性多么小），产生了极端的检验统计量值。
- en: '**Bonferroni Correction**'
  id: totrans-392
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**邦费罗尼校正**'
- en: The fact that Type I errors naturally occur because of random variation is particularly
    important and leads us to consider the *multiple testing problem*. If you’re conducting
    many hypothesis tests, you should be cautious in simply reporting the “number
    of statistically significant outcomes”—as you increase the number of hypothesis
    tests, you increase the chance of receiving an erroneous result. In, say, 20 tests
    conducted under *α* = 0.05, on average one will be a so-called false positive;
    if you conduct 40 or 60 tests, you are inevitably more likely to find more false
    positives.
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: 第一类错误自然由于随机变异而发生这一事实尤其重要，这促使我们考虑*多重检验问题*。如果您进行许多假设检验，您应该小心仅报告“统计显著的结果数量”——随着假设检验数量的增加，您得到错误结果的机会也会增加。例如，在进行20次*α*
    = 0.05的检验时，平均会有一次是所谓的假阳性；如果您进行40或60次检验，您不可避免地会得到更多的假阳性结果。
- en: When several hypothesis tests are conducted, you can curb the multiple testing
    problem with respect to committing a Type I error by using the *Bonferroni correction*.
    The Bonferroni correction suggests that when performing a total of *N* independent
    hypothesis tests, each under a significance level of *α*, you should instead use
    *α*[B] = *α*/*N* for any interpretation of statistical significance. Be aware,
    however, that this correction to the level of significance represents the simplest
    solution to the multiple testing problem and can be criticized for its conservative
    nature, which is potentially problematic when *N* is large.
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: 当进行多个假设检验时，您可以通过使用*邦费罗尼校正*来控制与犯第一类错误相关的多重检验问题。邦费罗尼校正建议，当执行总共*N*个独立的假设检验时，每个检验的显著性水平为*α*，您应该使用*α*[B]
    = *α*/*N*来进行任何统计显著性的解释。然而，需注意的是，这种显著性水平的校正代表了多重检验问题的最简单解决方案，并且由于其保守性，可能会受到批评，尤其当*N*值较大时可能会带来问题。
- en: The Bonferroni and other corrective measures were developed in an attempt to
    formalize remedies to making a Type I error in multiple tests. In general, though,
    it suffices to be aware of the possibility that H[0] may be true, even if the
    *p*-value is considered small.
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: 邦费罗尼校正及其他校正措施是为了正式化修正多重检验中第一类错误的办法。然而，通常情况下，仅意识到零假设（H[0]）可能为真，即使*p*值被认为较小，也足够了。
- en: '***18.5.3 Type II Errors***'
  id: totrans-396
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***18.5.3 第一类错误***'
- en: The issues with Type I errors might suggest that it’s desirable to perform a
    hypothesis test with a smaller *α* value. Unfortunately, it’s not quite so simple;
    reducing the significance level for any given test leads directly to an increase
    in the chance of committing a Type II error.
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: 第一类错误的问题可能会让人认为应该用更小的*α*值进行假设检验。不幸的是，事情并非如此简单；减少任何给定检验的显著性水平将直接导致犯第一类错误的机会增加。
- en: A Type II error refers to incorrect retention of the null hypothesis—in other
    words, obtaining a *p*-value greater than the significance level when it’s the
    alternative hypothesis that’s actually true. For the same scenario you’ve been
    looking at so far (an upper-tailed test for a single sample mean), [Figure 18-3](ch18.xhtml#ch18fig3)
    illustrates the probability of a Type II error, shaded and denoted *β*.
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: 第一类错误（Type II Error）指的是错误地保留原假设——换句话说，当实际为备择假设为真时，得到的*p*值大于显著性水平。对于您至今所看的相同情境（单样本均值的上尾检验），[图18-3](ch18.xhtml#ch18fig3)显示了第一类错误的概率，以阴影标示并表示为*β*。
- en: '![image](../images/f18-03.jpg)'
  id: totrans-399
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f18-03.jpg)'
- en: '*Figure 18-3: A conceptual diagram of the Type II error probability *β**'
  id: totrans-400
  prefs: []
  type: TYPE_NORMAL
  zh: '*图18-3：第一类错误概率*β*的概念图*'
- en: It’s not as easy to find *β* as it is to find the probability of making a Type
    I error because *β* depends, among other things, on what the true value of *μ*[A]
    is (which in general you won’t know). If *μ*[A] is closer to the hypothesized
    null value of *μ*[0], you can imagine the alternative distribution in [Figure
    18-3](ch18.xhtml#ch18fig3) translating (shifting) to the left, resulting in an
    increase in *β*. Similarly, staying with [Figure 18-3](ch18.xhtml#ch18fig3), imagine
    decreasing the significance level *α*. Doing so means the vertical dashed line
    (denoting the corresponding critical value) moves to the right, also increasing
    the shaded area of *β*. Intuitively, this makes sense—the closer the true alternative
    value is to the null and/or the smaller the significance level, the harder H[A]
    is to detect by rejection of H[0].
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: 找到*β*并不像找到I型错误概率那么容易，因为*β*依赖于多个因素，其中之一是*μ*[A]的真实值（通常你是无法知道的）。如果*μ*[A]接近假设的零值*μ*[0]，你可以想象替代分布在[图18-3](ch18.xhtml#ch18fig3)中向左平移（偏移），从而导致*β*的增大。同样地，继续参考[图18-3](ch18.xhtml#ch18fig3)，假设减少显著性水平*α*。这样做意味着垂直虚线（表示相应的临界值）向右移动，也会增加*β*的阴影区域。直观上，这是有道理的——真实的替代值越接近零值和/或显著性水平越小，通过拒绝H[0]检测到H[A]的难度就越大。
- en: 'As noted, *β* usually can’t be calculated in practice because of the need to
    know what the true distribution actually is. This quantity is, however, useful
    in giving you an idea of how prone a test is to the incorrect retention of a null
    hypothesis under particular conditions. Suppose, for example, you’re performing
    a one-sample *t*-test for H[0] : *μ* = *μ*[0] and H[A] : *μ* > *μ*[0] with *μ*[0]
    = 0 but that the (true) alternative distribution of the raw measurements has mean
    *μ*[A] = 0.5 and standard deviation *σ* = 1\. Given a random sample of size *n*
    = 30 and using *α* = 0.05, what is the probability of committing a Type II error
    in any given hypothesis test (using the same standard deviation for the null distribution)?
    To answer this, look again at [Figure 18-3](ch18.xhtml#ch18fig3); you need the
    critical value marked off by the significance level (the dashed vertical line).
    If you assume *σ* is known, then the sampling distribution of interest will be
    normal with mean *μ*[0] = 0 and a standard error of ![image](../images/f0425-01a.jpg)
    (see [Section 17.1.1](ch17.xhtml#ch17lev2sec146)). Therefore, with an upper-tail
    area of 0.05, you can find the critical value with the following:'
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，*β*通常无法在实践中计算出来，因为需要知道真实分布是什么。然而，这个量在给出测试在特定条件下错误保留零假设的倾向时是有用的。例如，假设你正在进行一个单样本*t*-检验，零假设H[0]：*μ*
    = *μ*[0]，备择假设H[A]：*μ* > *μ*[0]，其中*μ*[0] = 0，但原始测量的（真实）备择分布具有均值*μ*[A] = 0.5和标准差*σ*
    = 1。假设随机样本大小为*n* = 30，并使用显著性水平*α* = 0.05，那么在任何给定的假设检验中，犯II型错误的概率是多少（使用零分布的相同标准差）？为了回答这个问题，重新查看[图18-3](ch18.xhtml#ch18fig3)；你需要临界值，这个临界值由显著性水平（虚线垂直线）标出。如果假设*σ*已知，那么感兴趣的抽样分布将是正态分布，均值为*μ*[0]
    = 0，标准误差为![image](../images/f0425-01a.jpg)（参见[第17.1.1节](ch17.xhtml#ch17lev2sec146)）。因此，假设上尾面积为0.05，你可以通过以下方法找到临界值：
- en: '[PRE57]'
  id: totrans-403
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: 'This represents the vertical dashed line in this specific setting (see [Section
    16.2.2](ch16.xhtml#ch16lev2sec142) for a refresher on use of `qnorm`). The Type
    II error in this example is found as the left-hand tail area under the alternative,
    “true” distribution, from that critical value:'
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: 这表示在该特定情况下的垂直虚线（有关`qnorm`使用的复习请见[第16.2.2节](ch16.xhtml#ch16lev2sec142)）。这个例子中的II型错误是指在替代“真实”分布下，从临界值开始，左侧尾部区域的面积：
- en: '[PRE58]'
  id: totrans-405
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: From this, you can see that a hypothesis test under these conditions has roughly
    a 13.7 percent chance of incorrect retention of the null.
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: 从这里可以看出，在这些条件下进行假设检验时，错误保留零假设的概率大约为13.7%。
- en: '**Simulating Type II Errors**'
  id: totrans-407
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**模拟II型错误**'
- en: 'Simulation is especially useful here. In the editor, consider the function
    `typeII.tester` defined as follows:'
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，模拟特别有用。在编辑器中，考虑以下定义的函数`typeII.tester`：
- en: '[PRE59]'
  id: totrans-409
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: This function is similar to `typeI.tester`. The null value, standard deviation
    of raw measurements, sample size, significance level, and number of iterations
    are all as before. Additionally, you now have `muA`, providing the “true” mean
    *μ*[A] under which to generate the samples. Again, at each iteration, a random
    sample of size `n` is generated, its mean and standard deviation are calculated,
    and the appropriate *p*-value for the test is computed using `pt` from the usual
    standardized test statistic with `df=n-1`. (Remember, since you’re estimating
    the true standard deviation of the measurements *σ* with the sample standard deviation
    *s*, it’s technically correct to use the *t*-distribution.) Following completion
    of the `for` loop, the proportion of *p*-values that were greater than or equal
    to the significance level `alpha` is returned.
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
  zh: 这个函数类似于`typeI.tester`。零值、原始测量的标准差、样本大小、显著性水平和迭代次数与之前相同。此外，你现在有了`muA`，提供了生成样本时所使用的“真实”均值*μ*[A]。同样，在每次迭代时，都会生成一个大小为`n`的随机样本，计算其均值和标准差，并使用`pt`从通常的标准化检验统计量中计算出适当的*p*值，`df=n-1`。（记住，由于你正在使用样本标准差*s*来估计测量的真实标准差*σ*，因此技术上使用*t*分布是正确的。）完成`for`循环后，返回*p*值大于或等于显著性水平`alpha`的比例。
- en: After importing the function into the workspace, you can simulate *β* for this
    test.
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
  zh: 在将函数导入工作空间后，你可以为这个测试模拟*β*。
- en: '[PRE60]'
  id: totrans-412
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: My result indicates something close to the theoretical *β* evaluated previously,
    albeit slightly larger because of the additional uncertainty that is naturally
    present when using a *t*-based sampling distribution instead of a normal. Again,
    each time you run `typeII.tester`, the results will vary slightly since everything
    is based on randomly generated hypothetical data samples.
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: 我的结果表明，与之前评估的理论*β*值接近，尽管因为使用基于*t*的采样分布而非正态分布，额外的不确定性使得结果稍微偏大。再次强调，每次运行`typeII.tester`时，由于所有结果都基于随机生成的假设数据样本，结果都会略有不同。
- en: Turning your attention to [Figure 18-3](ch18.xhtml#ch18fig3), you can see (in
    line with a comment made earlier) that if, in an effort to decrease the chance
    of a Type I error, you use *α* = 0.01 instead of 0.05, the vertical line moves
    to the right, thereby increasing the probability of a Type II error, with all
    other conditions being held constant.
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
  zh: 转向[图18-3](ch18.xhtml#ch18fig3)，你可以看到（与之前的评论一致），如果为了减少一型错误的可能性，使用*α* = 0.01而非0.05，垂直线会向右移动，从而增加二型错误的概率，其他条件保持不变。
- en: '[PRE61]'
  id: totrans-415
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: '**Other Influences on the Type II Error Rate**'
  id: totrans-416
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**影响二型错误率的其他因素**'
- en: The significance level isn’t the only contributing factor in driving *β*. Keeping
    *α* at 0.01, this time see what happens if the standard deviation of the raw measurements
    is increased from *σ* = 1 to *σ* = 1.1 and then *σ* = 1.2.
  id: totrans-417
  prefs: []
  type: TYPE_NORMAL
  zh: 显著性水平不是唯一影响*β*的因素。保持*α*为0.01，看看当原始测量的标准差从*σ* = 1增加到*σ* = 1.1，再到*σ* = 1.2时，会发生什么变化。
- en: '[PRE62]'
  id: totrans-418
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: Increasing the variability of the measurements, without touching anything else
    in the scenario, also increases the chance of a Type II error. You can imagine
    the curves in [Figure 18-3](ch18.xhtml#ch18fig3) becoming flatter and more widely
    dispersed owing to a larger standard error of the mean, which would result in
    more probability weight in the left-hand tail marked off by the critical value.
    Conversely, if the variability of the raw measurements is smaller, then the sampling
    distributions of the sample mean will be taller and skinnier, meaning a reduction
    in *β*.
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: 增加测量的变异性，而不改变情境中的其他任何内容，也会增加二型错误的机会。你可以想象，[图18-3](ch18.xhtml#ch18fig3)中的曲线会因为均值的标准误增大而变得更加平坦且分散，这将导致在由临界值标记的左侧尾部有更多的概率权重。相反，如果原始测量的变异性较小，那么样本均值的采样分布会变得更高更窄，这意味着*β*值会降低。
- en: A smaller or larger sample size will have a similar impact. Located in the denominator
    of the standard error formula, a smaller *n* will result in a larger standard
    error and hence that flatter curve and an increased *β*; a larger sample size
    will have the opposite effect. If you remain with the latest values of *μ*[0]
    = 0, *μ*[A] = 0.5, *σ* = 1.2, and *α* = 0.01, note that reducing the sample size
    to 20 (from 30) results in an increased simulated Type II error rate compared
    with the most recent result of 0.5501, but increasing the sample size to 40 improves
    the rate.
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: 更小或更大的样本量将产生类似的影响。由于位于标准误差公式的分母，更小的*n*会导致更大的标准误差，从而使曲线变得更平坦，*β*增加；而更大的样本量会产生相反的效果。如果你保持最新的*μ*[0]
    = 0，*μ*[A] = 0.5，*σ* = 1.2，和*α* = 0.01，注意将样本量从30减少到20会导致模拟的第二类错误率增加，较最近结果0.5501相比，增加样本量到40则会改善该比率。
- en: '[PRE63]'
  id: totrans-421
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: Finally, as noted at the beginning of the discussion, the specific value of
    *μ*[A] itself affects *β* just as you’d expect. Again, keeping the latest values
    for all other components, which resulted in my case in *β* = 0.4219, note that
    shifting the “true” mean closer to *μ*[0] by changing from *μ*[A] = 0.5 to *μ*[A]
    = 0.4 means the probability of committing a Type II error is increased; the opposite
    is true if the difference is increased to *μ*[A] = 0.6.
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，如讨论开始时所述，*μ*[A]的具体值本身会影响*β*，正如你所期望的那样。同样，保持其他所有组件的最新值，在我的案例中，*β* = 0.4219，注意通过将“真实”均值从*μ*[A]
    = 0.5改变为*μ*[A] = 0.4，将*μ*[0]的均值拉近，意味着第二类错误的概率增加；如果差异增加到*μ*[A] = 0.6，则情况正好相反。
- en: '[PRE64]'
  id: totrans-423
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: To summarize, although these simulated rates have been applied to the specific
    situation in which the hypothesis test is an upper-tailed test for a single mean,
    the general concepts and ideas discussed here hold for any hypothesis test. It’s
    easy to establish that the Type I error rate matches the predefined significance
    level and so can be decreased by reducing *α*. In contrast, controlling the Type
    II error rate is a complex balancing act that can involve sample size, significance
    level, observation variability, and magnitude of the difference between the true
    value and the null. This problem is largely academic since the “truth” is typically
    unknown in practice. However, the Type II error rate’s direct relationship to
    statistical power often plays a critical role in preparing for data collection,
    especially when you’re considering sample size requirements, as you’ll see in
    the next section.
  id: totrans-424
  prefs: []
  type: TYPE_NORMAL
  zh: 总结一下，尽管这些模拟的比率应用于假设检验是针对单一均值的上尾检验的特定情况，但这里讨论的基本概念和思想适用于任何假设检验。很容易得出第一类错误率与预定义的显著性水平相匹配，因此可以通过减小*α*来降低。相反，控制第二类错误率是一项复杂的平衡工作，涉及样本量、显著性水平、观察变异性以及真实值与原假设之间的差异大小。这个问题在学术上较为重要，因为在实际中，“真实”通常是未知的。然而，第二类错误率与统计功效的直接关系通常在数据收集准备中起着至关重要的作用，特别是在你考虑样本量需求时，正如你将在下一部分中看到的那样。
- en: '**Exercise 18.5**'
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: '**练习 18.5**'
- en: 'Write a new version of `typeI.tester` called `typeI.mean`. The new function
    should be able to simulate the Type I error rate for tests of a single mean in
    any direction (in other words, one-or two-sided). The new function should take
    an additional argument, `test`, which takes a character string `"less"`, `"greater"`,
    or `"two.sided"` depending on the type of desired test. You can achieve this by
    modifying `typeI.tester` as follows:'
  id: totrans-426
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编写一个新的`typeI.tester`版本，命名为`typeI.mean`。新函数应能够模拟单一均值测试的第一类错误率，支持任意方向（换句话说，单尾或双尾）。新函数应接受一个额外的参数`test`，该参数取字符字符串`"less"`、`"greater"`或`"two.sided"`，以指定所需的测试类型。你可以通过如下修改`typeI.tester`来实现：
- en: – Instead of calculating and storing the *p*-values directly in the `for` loop,
    simply store the test statistic.
  id: totrans-427
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: – 不要直接在`for`循环中计算并存储*p*-值，而是只存储测试统计量。
- en: – When the loop is complete, set up stacked `if`-`else` statements that cater
    to each of the three types of test, calculating the *p*-value as appropriate.
  id: totrans-428
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: – 当循环完成时，设置堆叠的`if`-`else`语句，以适应三种测试类型，根据需要计算*p*-值。
- en: – For the two-sided test, remember that the *p*-value is defined as twice the
    area “more extreme” than the null. Computationally, this means you must use the
    upper-tail area if the test statistic is positive and the lower-tail area otherwise.
    If this area is less than half of *α* (since it is subsequently multiplied by
    2 in a “real” hypothesis test), then a rejection of the null should be flagged.
  id: totrans-429
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: – 对于双尾检验，请记住*p*-值定义为零假设之外“更极端”的区域的两倍。在计算上，这意味着如果检验统计量为正，必须使用上尾区域，反之则使用下尾区域。如果该区域小于*α*的一半（因为它在“真实”假设检验中会被乘以2），则应标记为拒绝零假设。
- en: – If the value of `test` is not one of the three possibilities, the function
    should throw an appropriate error using `stop`.
  id: totrans-430
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: – 如果`test`的值不是三种可能值之一，函数应使用`stop`抛出适当的错误。
- en: Experiment with your function using the first example setting in the text with
    *μ*[0] = 0, *σ* = 1, *n* = 40, and *α* = 0.05\. Call `typeI.mean` three times,
    using each of the three possible options for `test`. You should find that all
    simulated results sit close to 0.05.
  id: totrans-431
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用文本中的第一个示例设置进行实验，*μ*[0] = 0，*σ* = 1，*n* = 40，以及*α* = 0.05。调用`typeI.mean`三次，使用`test`的三种可能选项中的每一种。你应该会发现所有模拟结果都接近0.05。
- en: Repeat (i) using the second example setting in the text with *μ*[0] = −4, *σ*
    = 0.3, *n* = 60, and *α* = 0.01\. Again, you should find that all simulated results
    sit close to the value of *α*.
  id: totrans-432
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重复 (i) 使用文本中的第二个示例设置，*μ*[0] = −4，*σ* = 0.3，*n* = 60，以及*α* = 0.01。你应该会发现所有模拟结果都接近*α*的值。
- en: Modify `typeII.tester` in the same way as you did `typeI.tester`; call the new
    function `typeII.mean`. Simulate the Type II error rates for the following hypothesis
    tests. As per the text, assume *μ*[A], *σ*, *α*, and *n* denote the true mean,
    standard deviation of raw observations, significance level, and sample size, respectively.
  id: totrans-433
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修改`typeII.tester`，与修改`typeI.tester`的方式相同；将新函数命名为`typeII.mean`。模拟以下假设检验的类型 II
    错误率。根据文本，假设*μ*[A]，*σ*，*α*和*n*分别表示真实均值、原始观测的标准差、显著性水平和样本大小。
- en: 'H[0] : *μ* = −3.2; H[A] : *μ* ≠ −3.2'
  id: totrans-434
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 'H[0] : *μ* = −3.2；H[A] : *μ* ≠ −3.2'
- en: with *μ*[A] = −3.3, *σ* = 0.1, *α* = 0.05, and *n* = 25.
  id: totrans-435
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 其中*μ*[A] = −3.3，*σ* = 0.1，*α* = 0.05，*n* = 25。
- en: 'H[0] : *μ* = 8994; H[A] : *μ* < 8994'
  id: totrans-436
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 'H[0] : *μ* = 8994；H[A] : *μ* < 8994'
- en: with *μ*[A] = 5600, *σ* = 3888, *α* = 0.01, and *n* = 9.
  id: totrans-437
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 其中*μ*[A] = 5600，*σ* = 3888，*α* = 0.01，*n* = 9。
- en: 'H[0] : *μ* = 0.44; H[A] : *μ* > 0.44'
  id: totrans-438
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 'H[0] : *μ* = 0.44；H[A] : *μ* > 0.44'
- en: with *μ*[A] = 0.4, *σ* = 2.4, *α* = 0.05, and *n* = 68.
  id: totrans-439
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 其中*μ*[A] = 0.4，*σ* = 2.4，*α* = 0.05，*n* = 68。
- en: '***18.5.4 Statistical Power***'
  id: totrans-440
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***18.5.4 统计功效***'
- en: For any hypothesis test, it is useful to consider its potential statistical
    power. *Power* is the probability of correctly rejecting a null hypothesis that
    is untrue. For a test that has a Type II error rate of *β*, the statistical power
    is found simply with 1 − *β*. It’s desirable for a test to have a power that’s
    as high as possible. The simple relationship with the Type II error probability
    means that all factors impacting the value of *β* also directly affect power.
  id: totrans-441
  prefs: []
  type: TYPE_NORMAL
  zh: 对于任何假设检验，考虑其潜在的统计功效是非常有用的。*功效*是正确拒绝一个不真实的零假设的概率。对于一个具有类型 II 错误率*β*的检验，统计功效通过
    1 − *β* 计算得出。一个检验的功效越高越好。与类型 II 错误概率的简单关系意味着所有影响*β*值的因素也直接影响功效。
- en: 'For the same one-sided H[0] : *μ* = *μ*[0] and H[A] : *μ* > *μ*[0] example
    discussed in the previous section, [Figure 18-4](ch18.xhtml#ch18fig4) shades the
    power of the test—the complement to the Type II error rate. By convention, a hypothesis
    test that has a power greater than 0.8 is considered *statistically powerful*.'
  id: totrans-442
  prefs: []
  type: TYPE_NORMAL
  zh: '对于前一节中讨论的相同单尾H[0] : *μ* = *μ*[0]和H[A] : *μ* > *μ*[0]的例子，[图18-4](ch18.xhtml#ch18fig4)显示了检验的功效——即类型
    II 错误率的补数。按照惯例，假设检验的功效大于0.8被认为是*统计显著*的。'
- en: '![image](../images/f18-04.jpg)'
  id: totrans-443
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f18-04.jpg)'
- en: '*Figure 18-4: A conceptual diagram of statistical power 1 − *β**'
  id: totrans-444
  prefs: []
  type: TYPE_NORMAL
  zh: '*图18-4：统计功效1 − *β**的概念图'
- en: You can numerically evaluate power under specific testing conditions using simulation.
    For the previous discussion on Type II errors, you’re able to subtract all simulated
    results of *β* from 1 to evaluate the power of that particular test. For example,
    the power of detection of *μ*[A] = 0.6 when *μ*[0] = 0, taking samples of size
    *n* = 40 and with *σ* = 1.2 and *α* = 0.01, is simulated as 1 − 0.2287 = 0.7713
    (using my most recent result of *β* from earlier). This means there’s roughly
    a 77 percent chance of correctly detecting the true mean of 0.6 in a hypothesis
    test based on a sample of measurements generated under those conditions.
  id: totrans-445
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过模拟在特定检验条件下数值化地评估效能。关于第二类错误的前面讨论，您可以通过从1中减去所有模拟结果的*β*来评估该特定检验的效能。例如，当*μ*[0]
    = 0，*μ*[A] = 0.6时，样本大小为*n* = 40，*σ* = 1.2，*α* = 0.01时，检测效能为1 − 0.2287 = 0.7713（使用我之前得到的*β*的最新结果）。这意味着，在基于这些条件生成的测量样本的假设检验中，正确检测到真实均值0.6的概率大约为77%。
- en: Researchers are often interested in the relationship between power and sample
    size (though it is important to bear in mind that this is only one of the influential
    ingredients in the determination of power). Before you begin to collect data to
    examine a particular hypothesis, you might have an idea of the potential true
    value of the parameter of interest from past research or pilot studies. This is
    useful in helping to determine your sample size, such as in helping to answer
    questions like “How big does my sample need to be in order to be able to conduct
    a statistically powerful test to correctly reject H[0], if the true mean is actually
    *μ*[A]?”
  id: totrans-446
  prefs: []
  type: TYPE_NORMAL
  zh: 研究人员通常对效能与样本大小之间的关系感兴趣（尽管重要的是要记住，这只是决定效能的影响因素之一）。在开始收集数据以检验某个特定假设之前，您可能会从过去的研究或初步研究中获得关于感兴趣参数潜在真实值的想法。这对于确定样本大小非常有用，例如帮助回答类似“如果真实均值实际上是*μ*[A]，我需要多大的样本才能进行一个统计学上有效的检验，以正确拒绝H[0]？”这样的问题。
- en: '**Simulating Power**'
  id: totrans-447
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**模拟效能**'
- en: 'For the most recent testing conditions, with a sample size of *n* = 40, you’ve
    seen that there’s a power of around 0.77 of detecting *μ*[A] = 0.6\. For the purposes
    of this example, let’s say you want to find how much you should increase *n* by
    in order to conduct a statistically powerful test. To answer this, define the
    following function `power.tester` in the editor:'
  id: totrans-448
  prefs: []
  type: TYPE_NORMAL
  zh: 在最近的检验条件下，样本大小为*n* = 40，您已经发现检测*μ*[A] = 0.6的效能大约为0.77。为了这个例子，假设您想找出应当如何增加*n*的值，以便进行一个统计学上有效的检验。为了回答这个问题，在编辑器中定义以下`power.tester`函数：
- en: '[PRE65]'
  id: totrans-449
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: The `power.tester` function uses the `typeII.tester` function defined in [Section
    18.5.3](ch18.xhtml#ch18lev2sec166) to evaluate the power of a given upper-tailed
    hypothesis test of a single sample mean. It takes a vector of sample sizes supplied
    as the `nvec` argument (you pass all other arguments to `typeII.tester` using
    an ellipsis—refer to [Section 11.2.4](ch11.xhtml#ch11lev2sec102)). A `for` loop
    defined in `power.tester` cycles through the entries of `nvec` one at a time,
    simulates the power for each sample size, and stores them in a corresponding vector
    that’s returned to the user. Remember, through `typeII.tester`, this function
    is using random generation of hypothetical data samples, so there may be some
    fluctuation in the results you observe each time you run `power.tester`.
  id: totrans-450
  prefs: []
  type: TYPE_NORMAL
  zh: '`power.tester`函数使用[第18.5.3节](ch18.xhtml#ch18lev2sec166)中定义的`typeII.tester`函数来评估单一样本均值的给定上尾假设检验的效能。它接受一个作为`nvec`参数传入的样本大小向量（所有其他参数通过省略号传递给`typeII.tester`——请参见[第11.2.4节](ch11.xhtml#ch11lev2sec102)）。`power.tester`中的`for`循环依次遍历`nvec`中的每一项，为每个样本大小模拟效能，并将结果存储在一个相应的向量中，该向量会返回给用户。请记住，通过`typeII.tester`，该函数使用假设数据样本的随机生成，因此每次运行`power.tester`时，您观察到的结果可能会有所波动。'
- en: There can be a slight delay when evaluating the power for many individual sample
    sizes, so this function also provides a good opportunity to showcase a progress
    bar in a practical implementation (refer to [Section 12.2.1](ch12.xhtml#ch12lev2sec108)
    for details).
  id: totrans-451
  prefs: []
  type: TYPE_NORMAL
  zh: 在评估许多独立样本大小的效能时可能会有轻微的延迟，因此这个函数也提供了一个很好的机会来展示进度条的实际应用（有关详细信息，请参见[第12.2.1节](ch12.xhtml#ch12lev2sec108)）。
- en: 'Set up the following vector, which uses the colon operator (see [Section 2.3.2](ch02.xhtml#ch02lev2sec21))
    to construct a sequence of integers between 5 and 100 inclusive for the sample
    sizes to be examined:'
  id: totrans-452
  prefs: []
  type: TYPE_NORMAL
  zh: 设置以下向量，使用冒号操作符（参见[第2.3.2节](ch02.xhtml#ch02lev2sec21)）构造一个包含从5到100（包括100）之间的整数序列，用于检查的样本大小：
- en: '[PRE66]'
  id: totrans-453
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: Importing the `power.tester` function, you can then simulate the power for each
    of these integers for this particular test (`ITERATIONS` is halved to `5000` to
    reduce the overall completion time).
  id: totrans-454
  prefs: []
  type: TYPE_NORMAL
  zh: 导入`power.tester`函数后，你可以模拟这些整数的功效，用于此特定测试（`ITERATIONS`被减半为`5000`以减少整体完成时间）。
- en: '[PRE67]'
  id: totrans-455
  prefs: []
  type: TYPE_PRE
  zh: '[PRE67]'
- en: 'As expected, the power of detection rises steadily as *n* increases; the conventional
    cutoff of 80 percent is visible in these results as lying between 0.7950 and 0.8050\.
    If you don’t want to identify the value visually, you can find which entry of
    `sample.sizes` corresponds to the 80 percent cutoff by first using `which` to
    identify the indexes of `pow` that are at least 0.8 and then returning the lowest
    value in that category with `min`. The identified index may then be specified
    in square brackets to `sample.sizes` to give you the value of *n* that corresponds
    to that simulated power (0.8050 in this case). These commands can be nested as
    follows:'
  id: totrans-456
  prefs: []
  type: TYPE_NORMAL
  zh: 正如预期的那样，随着*n*的增加，检出功效稳步上升；这些结果中，常规的80%临界值出现在0.7950和0.8050之间。如果你不想通过视觉来识别该值，你可以使用`which`先找到`pow`中至少为0.8的条目的索引，然后使用`min`返回该类别中的最小值。然后，可以在方括号中指定该索引到`sample.sizes`中，以得到与该模拟功效对应的*n*值（在此情况下为0.8050）。这些命令可以像这样嵌套：
- en: '[PRE68]'
  id: totrans-457
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: The result indicates that if your sample size is at least 43, a hypothesis test
    under these particular conditions should be statistically powerful (based on the
    randomly simulated output in `pow` in this instance).
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
  zh: 结果表明，如果你的样本量至少为43，在这些特定条件下进行假设检验应该是具有统计功效的（基于此次`pow`中随机模拟的输出）。
- en: What if the significance level for this test were relaxed? Say you wanted to
    conduct the test (still upper-tailed under the condition of *μ*[0] = 0, *μ*[A]
    = 0.6, and *σ* = 1.2) using a significance level of *α* = 0.05 rather than 0.01\.
    If you look again at [Figure 18-4](ch18.xhtml#ch18fig4), this alteration means
    the vertical line (critical value) moves to the left, decreasing *β* and so increasing
    power. That would therefore suggest you’d require a smaller sample size than earlier,
    in other words, *n* < 43, in order to perform a statistically powerful test when
    *α* is increased.
  id: totrans-459
  prefs: []
  type: TYPE_NORMAL
  zh: 如果这个测试的显著性水平放宽了会怎样呢？假设你想在显著性水平为*α* = 0.05而非0.01的情况下进行测试（仍然是在*μ*[0] = 0，*μ*[A]
    = 0.6，*σ* = 1.2的条件下进行上尾检验）。如果你再次查看[图18-4](ch18.xhtml#ch18fig4)，这个变化意味着垂直线（临界值）会向左移动，从而减少*β*并增加功效。因此，这表明你需要比之前更小的样本量，换句话说，在*α*增加时，进行统计上有力的测试时，*n*
    < 43。
- en: 'To simulate this situation for the same range of sample sizes and store the
    resulting powers in `pow2`, examine the following:'
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
  zh: 为了模拟这个情况，使用相同范围的样本量并将结果功效存储在`pow2`中，查看以下内容：
- en: '[PRE69]'
  id: totrans-461
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: This result indicates a sample size of at least 27 is required, which is a noticeable
    reduction from the 43 noted if *α* = 0.01\. However, relaxing *α* means an increased
    risk of committing a Type I error!
  id: totrans-462
  prefs: []
  type: TYPE_NORMAL
  zh: 这个结果表明，至少需要27个样本量，这是相比于*α* = 0.01时所需的43个样本量的显著减少。然而，放宽*α*意味着增加犯第一类错误的风险！
- en: '**Power Curves**'
  id: totrans-463
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**功效曲线**'
- en: 'For comparison, you can plot your simulated powers as a kind of power curve
    using both `pow` and `pow2` with the following code:'
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
  zh: 为了比较，你可以通过使用`pow`和`pow2`绘制你的模拟功效，生成一种功效曲线，使用以下代码：
- en: '[PRE70]'
  id: totrans-465
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: My particular image is given in [Figure 18-5](ch18.xhtml#ch18fig5). A horizontal
    line marks off the power of 0.8, and the vertical line marks the minimum sample
    size values identified and stored in `minimum.n` and `minimum.n2`. As a final
    touch, a legend is added to reference the *α* values of each curve.
  id: totrans-466
  prefs: []
  type: TYPE_NORMAL
  zh: 我的特定图像见[图18-5](ch18.xhtml#ch18fig5)。一条水平线标出了0.8的功效值，垂直线标出了在`minimum.n`和`minimum.n2`中存储的最小样本量值。最后，添加了图例来参考每条曲线的*α*值。
- en: '![image](../images/f18-05.jpg)'
  id: totrans-467
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f18-05.jpg)'
- en: '*Figure 18-5: Simulated power curves for the upper-tailed hypothesis test of
    a single sample mean*'
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
  zh: '*图18-5：单一样本均值上尾假设检验的模拟功效曲线*'
- en: The curves themselves indicate exactly what you’d expect—the power of detection
    increases as the sample size is incremented. You can also note the flattening
    off occurring as the power rises ever closer to the “perfect” rate of 1, which
    is typical of a power curve. For *α* = 0.05, the curve sits almost consistently
    above the curve for *α* = 0.01, though the difference looks negligible as *n*
    rises above 75 or so.
  id: totrans-469
  prefs: []
  type: TYPE_NORMAL
  zh: 曲线本身显示了你所期望的情况——随着样本量的增加，检出功效也增加。你还可以注意到，当功效接近1时，曲线趋于平稳，这通常是功效曲线的典型特征。对于*α*
    = 0.05，曲线几乎始终位于*α* = 0.01曲线之上，尽管当*n*超过75左右时，差异变得微不足道。
- en: The preceding discussion of errors and power highlights the need for care in
    interpreting the results of even the most basic of statistical tests. A *p*-value
    is merely a probability, and as such, no matter how small it may be in any circumstance,
    it can never prove or disprove a claim on its own. Issues surrounding the quality
    of a hypothesis test (parametric or otherwise) should be considered, though this
    is arguably difficult in practice. Nevertheless, an awareness of Type I and Type
    II errors, as well as the concept of statistical power, is extremely useful in
    the implementation and appraisal of any formal statistical testing procedure.
  id: totrans-470
  prefs: []
  type: TYPE_NORMAL
  zh: 之前关于错误和功效的讨论突出了在解释即便是最基础的统计检验结果时需要小心。*p*值仅仅是一个概率，因此，无论它在任何情况下有多小，都无法单独证明或反驳一个假设。应考虑与假设检验质量相关的问题（无论是参数性检验还是非参数性检验），尽管在实践中这可能是一个挑战。然而，了解I型和II型错误，以及统计功效的概念，对于任何正式统计检验程序的实施和评估都极为有用。
- en: '**Exercise 18.6**'
  id: totrans-471
  prefs: []
  type: TYPE_NORMAL
  zh: '**练习18.6**'
- en: For this exercise you’ll need to have written `typeII.mean` from [Exercise 18.5](ch18.xhtml#ch18exc5)
    (b). Using this function, modify `power.tester` so that a new function, `power.mean`,
    calls `typeII.mean` instead of calling `typeII.tester`.
  id: totrans-472
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这个练习中，您需要写出来自[练习18.5](ch18.xhtml#ch18exc5)（b）中的`typeII.mean`函数。使用该函数，修改`power.tester`，使得新函数`power.mean`调用`typeII.mean`，而不是调用`typeII.tester`。
- en: 'Confirm that the power of the test given by H[0] : *μ* = 10; H[A] : *μ* ≠ 10,
    with *μ*[A] = 10.5, *σ* = 0.9, *α* = 0.01, and *n* = 50, is roughly 88 percent.'
  id: totrans-473
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '确认假设检验H[0] : *μ* = 10; H[A] : *μ* ≠ 10，且*μ*[A] = 10.5，*σ* = 0.9，*α* = 0.01，*n*
    = 50的检验功效大约为88%。'
- en: 'Remember the hypothesis test in [Section 18.2.1](ch18.xhtml#ch18lev2sec158)
    for the mean net weight of an 80-gram pack of snacks, based on the *n* = 44 observations
    provided in the `snack` vector. The hypotheses were as follows:'
  id: totrans-474
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 记得[第18.2.1节](ch18.xhtml#ch18lev2sec158)中关于80克零食包净重的假设检验，基于`snack`向量中提供的*n* =
    44个观察值。假设如下：
- en: 'H[0] : *μ* = 80'
  id: totrans-475
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'H[0] : *μ* = 80'
- en: 'H[A] : *μ* < 80'
  id: totrans-476
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'H[A] : *μ* < 80'
- en: If the true mean is *μ*[A] = 78.5 g and the true standard deviation of the weights
    is *σ* = 3.1 g, use `power.mean` to determine whether the test is statistically
    powerful, assuming *α* = 0.05\. Does your answer to this change if *α* = 0.01?
  id: totrans-477
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果真实均值是*μ*[A] = 78.5克，且真实的体重标准差是*σ* = 3.1克，使用`power.mean`来判断该检验是否在统计上有效，假设*α*
    = 0.05。如果*α* = 0.01，您的答案是否会改变？
- en: Staying with the snacks hypothesis test, using the `sample.sizes` vector from
    the text, determine the minimum sample size required for a statistically powerful
    test using both *α* = 0.05 and *α* = 0.01\. Produce a plot showing the two power
    curves.
  id: totrans-478
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 继续使用零食假设检验，利用文本中的`sample.sizes`向量，确定使用*α* = 0.05和*α* = 0.01时，统计学上有效的最低样本量。绘制显示两条功效曲线的图表。
- en: '**Important Code in This Chapter**'
  id: totrans-479
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**本章中的重要代码**'
- en: '| **Function/operator** | **Brief description** | **First occurrence** |'
  id: totrans-480
  prefs: []
  type: TYPE_TB
  zh: '| **函数/操作符** | **简要描述** | **首次出现** |'
- en: '| --- | --- | --- |'
  id: totrans-481
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| `t.test` | One- and two-sample *t*-test | [Section 18.2.1](ch18.xhtml#ch18lev2sec158),
    [p. 391](ch18.xhtml#page_391) |'
  id: totrans-482
  prefs: []
  type: TYPE_TB
  zh: '| `t.test` | 单样本和双样本*t*检验 | [第18.2.1节](ch18.xhtml#ch18lev2sec158), [第391页](ch18.xhtml#page_391)
    |'
- en: '| `prop.test` | One- and two-sample *Z*-test | [Section 18.3.1](ch18.xhtml#ch18lev2sec160),
    [p. 405](ch18.xhtml#page_405) |'
  id: totrans-483
  prefs: []
  type: TYPE_TB
  zh: '| `prop.test` | 单样本和双样本*Z*检验 | [第18.3.1节](ch18.xhtml#ch18lev2sec160), [第405页](ch18.xhtml#page_405)
    |'
- en: '| `pchisq` | χ² cumulative problems | [Section 18.4.1](ch18.xhtml#ch18lev2sec162),
    [p. 414](ch18.xhtml#page_414) |'
  id: totrans-484
  prefs: []
  type: TYPE_TB
  zh: '| `pchisq` | 卡方累积分布问题 | [第18.4.1节](ch18.xhtml#ch18lev2sec162), [第414页](ch18.xhtml#page_414)
    |'
- en: '| `chisq.test` | χ² test of distribution/independence | [Section 18.4.1](ch18.xhtml#ch18lev2sec162),
    [p. 414](ch18.xhtml#page_414) |'
  id: totrans-485
  prefs: []
  type: TYPE_TB
  zh: '| `chisq.test` | 卡方分布/独立性检验 | [第18.4.1节](ch18.xhtml#ch18lev2sec162), [第414页](ch18.xhtml#page_414)
    |'
- en: '| `rowSums` | Matrix row totals | [Section 18.4.2](ch18.xhtml#ch18lev2sec163),
    [p. 417](ch18.xhtml#page_417) |'
  id: totrans-486
  prefs: []
  type: TYPE_TB
  zh: '| `rowSums` | 矩阵行总和 | [第18.4.2节](ch18.xhtml#ch18lev2sec163), [第417页](ch18.xhtml#page_417)
    |'
- en: '| `colSums` | Matrix column totals | [Section 18.4.2](ch18.xhtml#ch18lev2sec163),
    [p. 417](ch18.xhtml#page_417) |'
  id: totrans-487
  prefs: []
  type: TYPE_TB
  zh: '| `colSums` | 矩阵列总和 | [第18.4.2节](ch18.xhtml#ch18lev2sec163), [第417页](ch18.xhtml#page_417)
    |'
