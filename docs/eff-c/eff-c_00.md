<hgroup>

# <samp class="SANS_Dogma_OT_Bold_B_11">简介</samp>

</hgroup>

![](img/opener.jpg)

C 语言是在 1970 年代作为系统编程语言开发的，即使经过了这么长时间，它仍然非常流行。系统语言旨在提供高效的性能，并便捷地访问底层硬件，同时提供高级编程特性。虽然其他语言可能提供更新的语言特性，但它们的编译器和库通常是用 C 语言编写的。

卡尔·萨根曾说过：“如果你想从头开始做一个苹果派，你必须首先发明宇宙。”C 语言的发明者并没有发明宇宙；他们设计了 C 语言，使其能够与各种计算硬件和架构协同工作，而这些硬件和架构又受限于物理学和数学。C 语言直接建立在计算硬件之上，使得它比那些通常依赖于 C 来实现高效的高级语言更能敏感地适应硬件特性的发展，例如向量化指令。

根据 TIOBE 指数（* [`<wbr>www<wbr>.tiobe<wbr>.com<wbr>/tiobe<wbr>-index<wbr>/`](https://www.tiobe.com/tiobe-index/) *）——该排名基于每种语言的熟练工程师数量、课程和第三方供应商——C 语言自 2001 年起一直是最流行的编程语言或第二流行语言。C 语言的流行可能最能归因于该语言的一些基本原则，被称为*C 语言精神*：

+   信任程序员。C 语言假设你知道自己在做什么，并允许你这样做。这并不总是好事（例如，如果你不知道自己在做什么）。

+   不要阻止程序员做他们需要做的事情。由于 C 是系统编程语言，它需要处理各种低级任务。

+   保持语言的小巧和简单。该语言设计紧密贴近硬件，且占用空间小。

+   只提供一种方法来完成操作。也被称为*机制的保守性*，C 语言力求限制引入重复机制。

+   让它运行得更快，即使无法保证它具有可移植性。允许你编写最优化的高效代码是首要任务。确保代码可移植、安全和安全的责任交给你，程序员。

C 语言被用作编译器的目标语言，用于构建操作系统、教授计算机基础知识，以及用于嵌入式和通用编程。

有大量用 C 语言编写的遗留代码。C 语言标准委员会非常小心，不会破坏现有代码，为现代化这些代码以利用现代语言特性提供了平稳的过渡。

C 语言通常用于嵌入式系统，因为它是一种小巧高效的语言。嵌入式系统是嵌入到其他设备中的小型计算机，如汽车、家电和医疗设备。

你最喜欢的编程语言和库是用 C 编写的（或曾经是）。C 有许多可用的库，这使得可以轻松找到可用于执行常见任务的库。

总体而言，C 语言是一种强大而多用途的语言，至今仍被广泛使用。它是需要快速、高效和可移植语言的程序员的良好选择。

## <samp class="SANS_Futura_Std_Bold_B_11">C 的简史</samp>

C 编程语言是在 1970 年代初期于贝尔实验室开发的，作为新兴 Unix 操作系统的系统实现语言，并且今天仍然非常流行（Ritchie 1993）。系统语言旨在提供高性能并易于访问底层硬件，同时提供高级编程功能。尽管其他语言可能提供更新的语言特性，但它们的编译器和库通常是用 C 编写的。它充当了在各种系统和语言之间翻译的“通用语”。

C 语言首次由 Kernighan 和 Ritchie 于 1978 年在《*C 程序设计语言*》一书中描述（Kernighan 和 Ritchie 1988）。现在，C 语言由 ISO/IEC 9899 标准（ISO/IEC 2024）和其他技术规范的修订版定义。C 标准委员会负责 C 编程语言的管理，致力于与更广泛的社区合作，以维护和发展 C 语言。1983 年，美国国家标准协会（ANSI）成立了 X3J11 委员会，旨在制定 C 语言的标准规范，并于 1989 年通过了 C 标准，定名为 ANSI X3.159-1989，“编程语言 C”。这一 1989 版本的语言被称为 *ANSI C* 或 *C89*。

1990 年，ANSI C 标准被国际标准化组织（ISO）和国际电工委员会（IEC）联合技术委员会采纳（未作更改），并作为第一版 C 标准发布，命名为 C90（ISO/IEC 9899:1990）。第二版 C 标准 C99 于 1999 年发布（ISO/IEC 9899:1999），第三版 C11 于 2011 年发布（ISO/IEC 9899:2011）。第四版于 2018 年发布，称为 C17（ISO/IEC 9899:2018），修复了 C11 中的缺陷。C 标准的最新版本（截至本文撰写时）为第五版，于 2024 年发布，称为 C23（ISO/IEC 9899:2024）。截至 2023 年 9 月，我是 ISO/IEC JTC1/SC22/WG14 的召集人，该工作组负责 C 编程语言的国际标准化。

在 TIOBE 编程社区指数跟踪编程语言流行度的 20 年中，C 一直位居第一或第二位（TIOBE Index 2022）。

## <samp class="SANS_Futura_Std_Bold_B_11">C 标准</samp>

C 标准（ISO/IEC 9899:2024）定义了该语言，并且是语言行为的最终权威。尽管标准可能晦涩难懂，甚至难以理解，但如果你打算编写可移植、安全和可靠的代码，就需要理解它。C 标准为实现提供了相当大的灵活性，以便它们能够在不同的硬件平台上达到最优的效率。*实现*是 C 标准用来指代编译器的术语，定义如下：

一套特定的软件，在特定的翻译环境中，按照特定的控制选项运行，执行程序翻译并支持在特定执行环境中运行功能。

这个定义表明，任何带有特定命令行标志的编译器，以及 C 标准库，都被视为一个独立的实现，不同的实现可能具有显著不同的*实现定义行为*。这一点在 GNU 编译器集合（GCC）中尤为明显，GCC 使用 -<samp class="SANS_TheSansMonoCd_W5Regular_11">std=</samp> 标志来确定语言标准。该选项的可能值包括 <samp class="SANS_TheSansMonoCd_W5Regular_11">c89</samp>、<samp class="SANS_TheSansMonoCd_W5Regular_11">c90</samp>、<samp class="SANS_TheSansMonoCd_W5Regular_11">c99</samp>、<samp class="SANS_TheSansMonoCd_W5Regular_11">c11</samp>、<samp class="SANS_TheSansMonoCd_W5Regular_11">c17</samp> 和 <samp class="SANS_TheSansMonoCd_W5Regular_11">c23</samp>。默认值取决于编译器的版本。如果没有指定 C 语言方言选项，GCC 13 的默认值是 <samp class="SANS_TheSansMonoCd_W5Regular_11">-std=gnu17</samp>，它为 C 语言提供了扩展。为了保证移植性，应该指定使用的标准。为了访问新的语言特性，应指定较新的标准。C23 的特性自 GCC 11 起就已提供。要启用 C23 支持，请添加编译器选项 <samp class="SANS_TheSansMonoCd_W5Regular_11">-std=c23</samp>（或可能是 <samp class="SANS_TheSansMonoCd_W5Regular_11">-std=c2x</samp>）。本书中的所有示例都采用 C23 编写。

由于实现有各种不同的行为，且其中一些行为是未定义的，因此你不能仅通过编写简单的测试程序来理解 C 语言的行为。（如果你想尝试这个，编译器探索器是一个非常好的工具；请参见 *[`<wbr>godbolt<wbr>.org`](https://godbolt.org)*。）代码的行为可能会在不同的平台上由不同的实现编译时发生变化，甚至在同一个实现上，使用不同的标志或不同的 C 标准库实现时，行为也可能不同。代码行为甚至可能因编译器的*版本*不同而有所变化。C 标准规定了哪些行为对于所有实现是保证的，以及哪些地方需要考虑到可变性。这个问题主要在开发可移植代码时需要关注，但也可能影响代码的安全性和可靠性。

## <samp class="SANS_Futura_Std_Bold_B_11">CERT C 语言编码标准</samp>

*CERT**^®* *C 语言编码标准：开发安全、可靠和安全系统的 98 条规则*，第二版（Addison-Wesley Professional，2014 年），是我在卡内基梅隆大学软件工程研究所管理安全编码团队时编写的参考书。书中包含了常见的 C 编程错误及其修正方法。在整本书中，我们引用了一些规则，作为特定 C 语言编程主题的详细信息来源。

## <samp class="SANS_Futura_Std_Bold_B_11">常见弱点枚举</samp>

MITRE 的常见弱点枚举（CWE）是一个列出常见硬件和软件弱点的清单，可用于识别源代码和操作系统中的弱点。CWE 清单由一个社区项目维护，旨在理解软件和硬件中的缺陷，并创建可用于识别、修复和防止这些缺陷的自动化工具。在本书中，我们偶尔会引用具体的 CWE，当讨论可能导致安全漏洞的缺陷类别时。欲了解更多关于 CWE 的信息，请参见 *[`<wbr>cwe<wbr>.mitre<wbr>.org`](https://cwe.mitre.org)*。

## <samp class="SANS_Futura_Std_Bold_B_11">本书适用对象</samp>

本书是 C 语言的入门书籍。它写得尽可能易于理解，适合任何希望学习 C 语言编程的人，而不降低难度。换句话说，我们没有像许多其他入门书籍和课程那样过度简化 C 语言编程。这些过度简化的教材可能会教你如何编译和运行代码，但代码可能仍然是错误的。从这些来源学习 C 编程的开发人员通常会编写出不合格、存在缺陷、不安全的代码，这些代码最终需要重写（通常比预期的要早）。希望这些开发人员最终能够从他们组织中的资深开发人员那里受益，帮助他们摒弃这些关于 C 语言编程的有害误解，开始编写专业质量的 C 代码。另一方面，本书将迅速教会你如何开发正确、可移植、专业质量的代码；为开发安全关键和安全关键系统打下基础；并可能教你一些即便是你组织中的资深开发人员也不知道的知识。

*《有效的 C：专业 C 编程简介》*（第二版）是一本简洁的 C 语言编程入门书籍，它将帮助你迅速编写程序、解决问题并构建工作系统。书中的代码示例具有惯用表达且直截了当。你还将学习开发正确、安全 C 代码的良好软件工程实践。

在本书中，你将学习 C 语言的基本编程概念，并通过每个主题的练习来实践编写高质量代码。书中的代码示例和其他资料可以在 GitHub 上找到，地址为*[`<wbr>github<wbr>.com<wbr>/rcseacord<wbr>/effective<wbr>-c`](https://github.com/rcseacord/effective-c)*。你可以访问本书的页面*[`<wbr>nostarch<wbr>.com<wbr>/effective<wbr>-c<wbr>-2nd<wbr>-edition`](https://nostarch.com/effective-c-2nd-edition)*，或者访问*[`<wbr>www<wbr>.robertseacord<wbr>.com`](http://www.robertseacord.com)*，查看更新和附加材料，或者如果你有额外问题或对培训感兴趣，可以联系我。

## <samp class="SANS_Futura_Std_Bold_B_11">本书内容</samp>

本书从一个介绍性章节开始，涵盖足够的内容，使你从一开始就能开始编程。之后，我们将回顾并研究语言的基本构建块。本书的高潮部分是两个章节，它们将向你展示如何从这些基本构建块组成实际系统，以及如何调试、测试和分析你编写的代码。章节安排如下：

**第一章：C 语言入门** 你将编写一个简单的 C 程序，熟悉使用<samp class="SANS_TheSansMonoCd_W5Regular_11">main</samp>函数。你还将了解一些编辑器和编译器的选择。

**第二章：对象、函数与类型** 本章探讨了声明变量和函数等基础知识。你还将研究如何使用基本类型的原则。

**第三章：算术类型** 你将学习整数和浮点数算术数据类型。

**第四章：表达式与运算符** 你将学习运算符，以及如何编写简单的表达式对各种对象类型进行操作。

**第五章：控制流** 你将学习如何控制各个语句的评估顺序。我们将介绍表达式和复合语句，它们定义了要执行的工作。然后，我们将涵盖控制语句，它们决定哪些代码块将被执行，以及执行的顺序：选择、迭代和跳转语句。

**第六章：动态分配内存** 你将学习动态分配内存，它在运行时从堆中分配。动态分配内存在程序的精确存储需求在运行前未知时非常有用。

**第七章：字符与字符串** 本章涵盖了可以用于组成字符串的各种字符集，包括 ASCII 和 Unicode。你将学习如何使用 C 标准库中的遗留函数、边界检查接口以及 POSIX 和 Windows 应用程序编程接口（API）来表示和操作字符串。

**第八章：输入/输出** 本章将教你如何执行输入/输出（I/O）操作，从终端和文件系统读取数据或写入数据。I/O 涉及所有信息进入或退出程序的方式。我们将涵盖使用 C 标准流和 POSIX 文件描述符的技术。

**第九章：预处理器** 你将学习如何使用预处理器来包含文件、定义类似对象和函数的宏，并根据特定实现特性有条件地包含代码。

**第十章：程序结构** 你将学习如何将程序结构化为多个翻译单元，这些单元由源文件和包含文件组成。你还将学习如何将多个目标文件链接在一起，创建库文件和可执行文件。

**第十一章：调试、测试与分析** 本章介绍了用于生成无错程序的工具和技术，包括编译时和运行时断言、调试、测试、静态分析和动态分析。章节还讨论了在软件开发过程中不同阶段推荐使用的编译器标志。

**附录: C 标准第五版 (C23)** 本附录列举了 C23 中的一些新增内容和变化。这是学习 C 新特性以及识别与上一版 C 标准（C17）变化的一种便捷方式。本书更新自之前的版本，涵盖了 C23 的新特性和行为。根据 JetBrains 2022 年的调查数据 (*[`www.jetbrains.com/lp/devecosystem-2022/c/`](https://www.jetbrains.com/lp/devecosystem-2022/c/)*)，44% 的 C 程序员使用 C99，33% 使用 C11，16% 使用 C17，15% 使用嵌入式版本的 C。

你即将踏上一段旅程，经过这段旅程后，你将成为一名全新的专业 C 开发者。
