# 前言

游戏无处不在，而且它们越来越多地在连接的网页设备以及桌面和移动浏览器环境中进行游戏。随着基于浏览器的游戏越来越受欢迎，玩家们开始转向像 Facebook 这样的网站，发现一些无需光盘或过多前期设置即可玩的简单休闲游戏。一款游戏也不过是另一个可以点击的链接。

在过去的十年里，Adobe 的 Flash 插件的改进促进了网络浏览器作为游戏平台的发展。大多数浏览器都支持 Flash，这为游戏开发者提供了一个强大的平台，接近了*一次编写，到处运行*的梦想。基于 HTML 的游戏也已经存在了相当长的时间，你可能甚至玩过一些（可能没有注意到）。然而，直到最近，由于图形、音频和速度的限制，HTML 和 JavaScript 作为游戏平台的使用一直处于 Flash 的“配角”地位。但浏览器和移动游戏平台已经得到了极大的改进，现状正在发生变化。移动操作系统已不再支持 Flash 插件，因此，游戏开发者需要能够提供类似性能和灵活性同时又能保持 Flash 普及性的工具。

浏览器在过去几年中，图形和音频能力也得到了快速提升。HTML 的强大功能与日益增长的对提供丰富游戏体验的跨平台需求相对应，且得到了多个平台提供商的支持。一个得到良好支持的开放平台被认为不太可能受制于商业控制或封闭的“花园围墙”心态，而 HTML5 正是这样一个平台。

然而，根据我的经验，许多游戏开发者在接触 HTML5 时，都是希望构建他们曾在 Flash 中开发的那种类型的游戏。HTML5 无疑是最好的选择之一：它有着庞大的用户基础（任何拥有现代浏览器的人都可以使用），并且 HTML5 与 Flash 有许多相似的功能和限制。尽管如此，将 HTML5 视为 Flash 的替代品，可能会导致令人失望的产品发布和错失的机会。这是因为，二者的优点并不完全重合。而且，HTML5 仍处于相对早期的发展阶段。这个平台在快速发展，且每个月支持的新功能变化很快，保持同步可能会变得困难。

就像构建一个好的 Web 应用程序一样，制作一款成功的游戏的关键是理解你平台的能力和限制。你必须设计和构建能够最大化平台潜力的游戏，同时避免或最小化其局限性。本书旨在作为理解如何利用 JavaScript、HTML 和 CSS 实现目标的第一步，并介绍你可以使用的方法。

# 为什么要构建 HTML5 游戏？

在我深入本书的具体内容之前，先让我们回过头来思考一下，你为什么要在 HTML5 平台上创建一款游戏。

## 利用你已有的技能

精通 JavaScript 和 CSS 的 Web 开发者会更有信心进入 HTML5 游戏开发领域。部署 HTML 和 JavaScript 文件也是一个熟悉的过程，你可以使用与 Web 开发重叠的服务器端语言来构建在线组件。

但如果你投身于编写 C++ 或 Objective-C，新的编程语言、新的开发环境以及游戏开发所需的新思维方式可能会导致陡峭的学习曲线。简而言之，与其他游戏技术相比，从 Web 开发转向 HTML5 游戏开发所需的概念跃迁相对较小。

## 多环境开发

许多平台承诺实现“一次编写，随处运行”的能力，在我看来，HTML5 是任何技术中最接近实现这一目标的。无论是为桌面浏览器还是打包的移动应用开发，你的编码风格不会有太大差异，屏幕上展示对象和用户与之互动的基本技术也没有变化。当然，总会有一些特定环境的差异，特别是如果代码需要利用某个环境提供的特性和优势时。

尽管如此，用 HTML5 和 JavaScript 编写的游戏仍然有很大的机会能在多个操作系统上以最小的修改正常运行。这使得可以同时发布并由一个开发团队负责，而不是为每个系统配备一个团队。即使最终环境不同，你也可以在桌面浏览器中进行编码和测试。

## 快速发展的平台

HTML5 正在不断快速改进。JavaScript 的处理速度也在提升，一些复杂的解释器正在接近本地代码的执行速度。考虑到过去 10 年 CPU 速度的提升，使用 JavaScript 编写的游戏可以比几年前许多本地代码编写的游戏表现得更好。

在浏览器厂商和硬件制造商的努力下，这一改进趋势只会继续下去，毫无疑问，HTML5 正在成长为一个可行的游戏平台。无论 HTML5 游戏开发是否会作为一种快速开发环境，在移动或桌面浏览器上开发沉浸式 3D 游戏，还是作为一个快速原型开发环境供休闲游戏开发者使用，甚至通过 Android 或其他设备进入主机环境，现在都是 JavaScript 程序员的激动时刻。现在正是建立在本书所学知识的基础上，并尝试 HTML5 和 JavaScript 作为开放式游戏开发平台的能力的时候。

# 本书介绍

本书无法展示所有可能的 HTML5 游戏，因此也未能全面探索 HTML5 和 JavaScript 的所有功能。相反，我专注于创建一个简单的休闲游戏，类似于许多开发者多年来使用 Adobe Flash 制作的游戏。这些游戏通常是二维的，单人游戏，并且具有相对较短的游戏循环。3D 技术的进步，如 WebGL，意味着大型、复杂、沉浸式的多人游戏现在已经可能或者即将实现，但对于游戏开发者而言，休闲游戏项目是一个更自然的起点。简单的项目也更容易展示在制作游戏过程中涉及的基本原理。

## 本书适合谁阅读

本书适合那些熟悉 HTML、CSS 和 JavaScript 的 web 开发者，尤其是那些想将现有技能转化为游戏开发的开发者。最低要求是你应该会编程，理想情况下你应该了解 JavaScript 的基础知识。你还应该有一个自己的 web 服务器和开发环境，或者能够为自己设置这些环境。

如果你有一定的 web 或游戏技术背景，想要了解 HTML5 能做什么，并且有学习和实验的热情，你应该能够顺利完成本书的内容。到最后，你将清楚如何开展 HTML5 游戏开发项目，并对制作游戏的核心流程有一个全面的了解。

## 概述

在整本书中，你将开发一个简单的气泡弹射游戏，目的是让它在浏览器中运行。每一章我都会通过实践介绍新的概念。

在 **第一部分: 使用 HTML、CSS 和 JavaScript 构建游戏** 中，你将使用 HTML、CSS 和 JavaScript 构建一个完整的游戏，这一部分包括本书的前四章。

+   **第一章: 准备和设置** 介绍了我们需要的工具，包括 jQuery 和 Modernizr 脚本库，如何调试，以及如何建立游戏的文件结构。

+   **第二章: 使用 jQuery 和 CSS 进行精灵动画** 描述了如何响应鼠标点击移动 HTML 元素。在游戏中，这意味着将图像从起始位置射向玩家点击的坐标。

+   **第三章: 游戏逻辑** 让你绘制游戏板并设置大部分游戏逻辑，包括发射气泡和碰撞检测。

+   **第四章：将游戏状态变化转换为显示** 教你如何让游戏响应我们在第三章中检测到的碰撞，并增加更多的游戏逻辑来弹出泡泡组。这引入了通过爆炸效果在对象内进行基本动画的概念。

在**第二部分**中，你将使用 HTML5 和 Canvas 中的新特性改进在第一部分中创建的游戏。

+   **第五章：CSS 过渡与变换** 向你展示如何使用 CSS3 实现一些你在之前章节中使用 jQuery 来完成的效果。

+   **第六章：渲染 Canvas 精灵** 向你展示如何在 HTML5 的 canvas 中完全渲染游戏，包括在屏幕上移动物体和动画效果。

+   **第七章：关卡、声音及更多内容** 解决了游戏逻辑中的一些问题，引入了更流畅的动画技术，并展示了如何实现声音效果以及保存玩家的分数。

+   **第八章：HTML5 的下一步** 讨论了一些你在开发休闲游戏时不需要使用的有用技术。它建议了未来的学习领域，如 Web Workers 和用于 3D 游戏的 WebGL，并讨论了重要问题，如内存管理和速度优化。

+   最后，**后记** 提供了一些提升你 HTML5 游戏编程技能的思路。例如，你可以继续改进你在本书中构建的游戏，或者开始开发自己的游戏创意。

本书中的所有代码都可以从 *[`buildanhtml5game.com/`](http://buildanhtml5game.com/)* 下载，在那里你也可以看到你将要构建的游戏的演示版本。并且在每章的结尾，我都会提供练习题，以测试你的技能并激发改进*泡泡射手*游戏的创意。

## 覆盖深度

由于本书专注于休闲游戏开发，我不会详细讲解 WebGL、三维建模、着色器、纹理、光照以及其他与更复杂的游戏（如第一人称射击游戏或大型多人在线角色扮演游戏 MMORPG）相关的技术。这些主题本身就足以写成书。然而，你会发现构建休闲游戏的大部分原则在更具技术挑战的场景中同样适用。我建议保持初期项目的可实现性，在完成几个版本之后，再向更复杂的项目迈进。一旦你完成了几个使用 HTML、CSS 和 canvas 的项目，你将有能力学习更多关于 WebGL 的知识，如果你有意朝这个方向发展；然而，你可能会发现休闲游戏领域已经提供了足够多的开发机会。

本书向你介绍了游戏开发技术，但它并不是你将要使用的应用程序接口（API）的详尽参考，也不是 HTML5 的完整指南：它仅涵盖了与游戏开发最相关的功能。互联网上充满了不仅提供更多细节的材料，而且这些材料也会随时更新，以适应不断变化的浏览器环境。我会在适当的时候突出有用的资源和文档。

同样地，这本书不是关于游戏设计的书。我会教你*如何*构建，但不会告诉你*构建什么*。你学到的技能应该为你提供一个起点，让你能够实现自己的创意，或者开始处理其他人设计的项目。

## 如何使用本书

在本书中，我将帮助你创建构成*Bubble Shooter*游戏的 HTML、CSS 和 JavaScript 文件。在你完成教程时，应该始终保持*index.html*文件（在第一章中创建）至少在一个浏览器中打开。这样，你可以刷新页面，查看代码的修改如何改变游戏。

我鼓励你在本地开发 Web 服务器上运行*Bubble Shooter*，而不是从文件系统中查看，这样你就能像真实用户一样访问它，并查看它在移动设备上的显示效果。

### 注意

*如果你不想手动输入示例代码，可以直接下载源代码（来自* [`buildanhtml5game.com/`](http://buildanhtml5game.com/)*)，然后在你正在阅读的章节的游戏文件中进行操作。*

一旦你决定了如何加载*Bubble Shooter*文件进行测试，就可以跳转到第一章开始制作你的第一个游戏！
