## —28—

难解的搜索问题

“离开，”卢普博士重复道。

“我是来处理公务的，”弗兰克回答道，依然没有从椅子上动弹。他听到身后传来轻微的脚步声，显然持弩的人正在向前走。

“不太可能，”卢普博士说，“我认识多诺万队长很久了，他不是那种依赖私人侦探的人。据我所知，他特别喜欢创造新型威胁，以此来让外人远离正在进行的案件。”

弗兰克开始伸手进衣袋。

“不要做出突然的动作，”身后传来一个粗哑的声音。

弗兰克感觉到怒火上涌。他讨厌有人将弩对准自己，虽然这在他的职业生涯中是个常见的经历。“我要去拿一张羊皮纸，”他说着咬紧牙关。

“慢慢来，”声音说道，“如果你动作太快，我*会*开枪。”

弗兰克默默地呻吟了一声。只有一种人说话像这样——布尔人。布尔人以黑白分明的世界观，使他们在做保安时特别有效。你无法通过言辞说服布尔人脱困。你要么违反了规则，要么没有。

弗兰克在取出队长的信时动作格外缓慢。他前倾身体，花了整整一分钟将信放到桌子上。他没有后退。动作越少越好。

卢普博士研究了那张便条一会儿，点了点头示意她的警卫。弗兰克听到弩的保险卡上了。他松了口气，靠在椅背上。卢普博士挥手让警卫离开了房间。

“你让多诺万队长给你写了介绍信？”卢普博士问道。

“正如你所说，这是一个敏感话题，”弗兰克回答道。

“你大概听说过我的名声。”卢普博士笑了。

“*我上过你的课*，”弗兰克嘀咕道，但卢普博士并没有听到。

“所以你在调查盗窃案件。你想知道什么？”

顿时，她的态度完全改变了。她的眼睛迅速扫过弗兰克的脸，好像在分析他的每一个反应。所有的客套话瞬间消失了；她的声音变得完全是工作式的。弗兰克不禁想知道，她那番和气的闲聊究竟有多少是演出来的。魔法犯罪学是一个危险的领域，而卢普博士已经在其中生存了很长时间。

“警察局有什么魔法保护？”弗兰克问道。

“基本警报咒语，”卢普博士说道，“它们会告诉你是否有人在局内使用魔法，但不会阻止魔法的使用。”

“为什么不用魔法屏障？”

“不实际，”教授解释道，“警察局的魔法顾问太多了。他们需要能够对证据施展占卜魔法，对囚犯施展真相魔法，对档案施展魔法镜像咒语，还需要为午餐加热。”

弗兰克点了点头，回忆起关于魔法优先队列的对话。

“反正太贵了，”卢普博士补充道，“只有皇宫和监狱有比基本警报咒语更高级的保护魔法。皇宫有一堆保护魔法，但没有抑制魔法。马库斯在那儿为国王工作太多了。”

“所以有人可以在城堡里使用魔法？”弗兰克确认道。

![image](img/f0225-01.jpg)

“可以，”卢普博士回答，“但那可不明智。城堡有十几道保护咒语可以阻挡攻击性魔法。弗雷德里克国王还雇佣了六名巫师守卫。虽然他们级别较低，但足以解开基础的诅咒。还有马库斯。没有多少巫师愿意与他为敌。”

“那神器呢？”

“啊，这个问题问得好。它取决于神器。城堡当然有防御武器化神器的保护，但没有任何东西能防得了所有神器。神器种类实在太多了。由于大多数神器不需要新的魔法（因为之前已经被施过魔法），连监狱里的防魔法咒语也无法起作用。”

“什么？”弗兰克问道，“我以为监狱对所有魔法免疫。难道他们不关押邪恶的巫师吗？事实上，‘指数者’不也在那吗？他曾试图用魔法摧毁整个王国。为什么他们不干脆阻止所有魔法神器的作用？”

卢普博士干笑了一声。“抱歉让你失望了，但你不能阻止所有的神器。别担心，皇家巫师会把最强大的神器严密保护着。而且所有囚犯在到达时都会接受彻底的搜查。”

“监狱还有什么其他保护措施？”弗兰克问道，随着真相逐渐明朗，恐慌感不断加剧。

“让我们看看，”卢普博士说。她开始用手指列举。 “石墙、一条充满暴躁獾的护城河、一百名守卫、沉重的橡木门、几扇装饰性的松木门、每条走廊都有‘轻微恶心咒’、‘困难搜索咒’，还有—”

“‘困难搜索咒’？”弗兰克打断道。

“并不是新的，”卢普博士解释道，“他们在施下‘阻止咒’之前，已经在监狱里施下了许多保护性魔法。”

“‘困难搜索咒’有什么作用？”弗兰克问道，胸口涌起一股不安的感觉。

“这让找到某个囚犯的囚室变得困难。更准确地说，它会神奇地交换囚室。如果你把囚室想象成一个巨大的数组，那么‘困难搜索咒’就像是一个交换数组索引的算法。它每天午夜都会随机交换一切。”

“它让任何人都很难帮朋友越狱。没有结构的数组值让闯入者只能依赖穷举法进行搜索。而且，由于囚室每天都会被洗牌，你不能把搜索工作分几晚来做。守卫们抱怨说这种随机性很烦人。他们每天要花好几个小时点名。虽然我听说他们最近做了个游戏，叫做‘下一扇门后面是谁？’每扇门的赌注最高可以达到一枚银币。”

“他们会记录下新的囚室位置吗？”

“那样做就完全违背了目的！如果他们保持着囚犯与牢房的映射关系，就像倒排索引一样，那么你就可以直接查找囚犯。假如你能够闯入首都警察局的档案室偷走牢房分配记录，那咒语有什么用？目标是让闯入者在监狱中搜索几个小时，而这显然是不可能的。所有的守卫彼此都认识。”

弗兰克看到最后一块拼图落到位。队长曾说过，无用复杂性联盟是那个邪恶巫师指数（Exponentious）的追随者或同谋——他是皇家监狱中最危险的罪犯。大家都担心联盟再次出击，甚至可能攻击城堡。但计划远比这简单得多。联盟打算越狱；他们要解救他们的头目。他从椅子上跳了起来，庆幸带弩的布尔埃恩不再站在他身后，冲向了门口。

“谢谢，”他在下楼梯时对她喊道。

_____________________

当弗兰克找到诺泰先时，他气喘吁吁，腰侧剧烈地疼痛。他几乎只能喘着气说出“需要你的帮助……越狱……今晚……巫师。”

诺泰先带着关切、兴趣和轻微的恼怒，看着他整整五分钟。“快说，弗兰克，”她终于说道。

弗兰克依然弯着腰，双手撑在膝盖上，朝她投去警告的眼神。

“是你自己跑到这里来的，”她反驳道。“我记得听到你喘着气说需要我的帮助。”

弗兰克忽略了她的评论。“我搞明白了，”他最终脱口而出。“那些巫师今晚要闯进监狱。”

诺泰先看起来很惊讶。“监狱？袜子在监狱里想做什么？”

“等等，你怎么知道袜子（Socks）的事？”弗兰克被问得愣住了。

诺泰先给了弗兰克一个困惑的眼神。“什么意思？我以为你怀疑他有一段时间了。不是吗？他可一点也不隐晦。”

“是的，确实有线索，”弗兰克含糊其辞。

诺泰先沉默了，低头盯着地面，她的脑海中飞速转动，拼接着剩下的线索。突然，她的表情变得阴沉，抬头看着弗兰克。“你为什么告诉我这些？”她问。“我已经退出案件了，记得吗？”

弗兰克瞪着她，难以置信。“你怎么能让这种事阻止你？”他问道。“难道你不想抓住那些小偷吗？”

“当然想，”诺泰先锐利地说。“但是队长说——”

“忘了队长，”弗兰克打断道。“这是你的案子，不管他说不说。不是吗？”

诺泰先看起来很矛盾，弗兰克抓住了这个机会。

“听着，”他补充道，“我需要帮助抓住小偷，但我不能在这件事上调动力量。至少现在不能。我几乎确定其中一个罪犯伪装成了警察，但我不知道是哪一个。在弄清楚这一点之前，我不能相信任何人。”

“那为什么要相信我？”诺泰先问道。

“因为你在这里，”弗兰克说道。

“这不是个好理由，”Notation 显然被这个暗示激怒了。

“不是那样的，”弗兰克挥挥手，打断了她的反驳。“我是说，因为你在这家店里，自己用钱买了一个价格过高的堆。显然你在乎你的工作。更重要的是，如果你参与了某个巫师越狱的事情，你完全可以让邪恶巫师联盟为你做一个魔法堆。要是有更好的选择，谁会走到 Orb 区呢？”

Notation 盯着弗兰克怒视。他后退了一步，看到她的表情从“非常生气”转为“你犯了个大错”。

“你*告诉*我来这里的，”她咬着牙说道。

“幸好如此，”弗兰克说。“我知道在哪里能找到你。这是世界上最简单的搜索问题——就像在知道索引的情况下在数组中查找值。我直接来到 Heaperous 的店里。不过我确实跑了些，”他承认道。“我以为你会早到，我不想错过你。”

Notation 看起来并没有松口气。“你把我送到这里是为了测试我是否参与了阴谋？”

“不，我是把你送到这里来把你弄开，”弗兰克承认道。“这个测试是在我跑到这里的时候才想起来的。我当时想——”

“你不信任我？”Notation 问，声音冰冷。每个字似乎都是一个独立的指控。

“别往心里去，”弗兰克说道。“我不信任任何人。”

“你……你……”Notation 哽咽着，脸色越来越红，显然无法完成侮辱的话语。

过了几分钟，弗兰克问道：“你加入吗？”

她僵硬地点了点头。

“很好，”弗兰克说道。“两个小时后在监狱见面，带上十字弓。”

Notation 又点了点头。

“还有一碗，”弗兰克补充道。

“一碗？”Notation 问，愣了一下，暂时从愤怒中解脱出来。

弗兰克露出灿烂的笑容。“监狱走廊里有一些轻微恶心的法术。你可能需要一个地方呕吐。”

**警察算法 101：期末考试复习课**

***摘自德雷克教授的讲座***

如果你从这门课中只学到了一件事，那应该是*高效算法的关键是信息*。在解决新问题时，花时间理解问题及其数据的结构。问题的结构越清晰，你就越有机会利用这些信息。正如你所见，在一个已排序的数组中查找一个值比在一个完全随机的数组中查找要容易得多。有时候，你甚至可以构建辅助数据结构，如堆或倒排索引，以提供所需的结构。无论如何，你的第一步应该始终是理解问题。
