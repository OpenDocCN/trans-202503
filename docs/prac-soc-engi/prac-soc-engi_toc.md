# 详细目录

1.  封面页

1.  版权

1.  献辞

1.  关于作者

1.  致谢

1.  介绍

    1.  本书的适读人群

    1.  你将在本书中找到的内容

    1.  总结

1.  第一部分：基础知识

    1.  第一章：什么是社会工程学？

        1.  社会工程学中的重要概念

            1.  伪装

            1.  开放源代码情报

            1.  钓鱼攻击

            1.  鱼叉式钓鱼

            1.  捕鲸

            1.  语音钓鱼

            1.  诱饵

            1.  垃圾桶翻找

        1.  社会工程学中的心理学概念

            1.  影响力

            1.  操控

            1.  建立关系

            1.  Cialdini 博士的六大劝说原则

            1.  同情与共情

        1.  结论

    1.  第二章：社会工程学中的道德考虑

        1.  道德的社会工程学

            1.  设立边界

            1.  理解法律考虑因素

            1.  理解服务考虑因素

            1.  事后汇报

        1.  案例分析：社会工程学走得太远

        1.  道德的 OSINT 收集

            1.  数据保护

            1.  遵守法律和法规

        1.  案例分析：社会工程学的道德界限

        1.  结论

1.  第二部分：进攻性社会工程学

    1.  第三章：准备攻击

        1.  与客户协调

            1.  范围界定

            1.  定义目标

            1.  定义方法

        1.  建立成功的伪装

        1.  使用专用操作系统进行社会工程学

        1.  遵循攻击阶段

        1.  案例分析：为什么范围界定很重要

        1.  结论

    1.  第四章：收集商业 OSINT

        1.  案例分析：为什么 OSINT 很重要

        1.  理解 OSINT 类型

        1.  商业 OSINT

            1.  从 Crunchbase 获取基本的商业信息

            1.  使用 WHOIS 识别网站所有者

            1.  通过命令行使用 Recon-ng 收集 OSINT

            1.  使用其他工具：theHarvester 和 OSINT 框架

            1.  使用 Hunter 查找电子邮件地址

            1.  利用地图和地理定位工具

        1.  结论

    1.  第五章：社交媒体和公共文档

        1.  分析社交媒体以获取 OSINT

            1.  LinkedIn

            1.  招聘网站和职业网站

            1.  Facebook

            1.  Instagram

        1.  利用 Shodan 进行 OSINT 分析

            1.  使用 Shodan 搜索参数

            1.  搜索 IP 地址

            1.  搜索域名

            1.  搜索主机名和子域

        1.  使用 Hunchly 自动截图

        1.  盗取 SEC 表格

        1.  结论

    1.  第六章：收集关于人的 OSINT

        1.  使用 OSINT 工具分析电子邮件地址

            1.  使用 Have I Been Pwned 查找用户是否被泄露

            1.  使用 Sherlock 枚举社交媒体账户

            1.  使用 WhatsMyName 枚举网站账户

        1.  使用 Pwdlogy 分析密码

        1.  分析目标的图像

            1.  手动分析 EXIF 数据

            1.  通过 ExifTool 分析图像

        1.  分析社交媒体无需工具

            1.  LinkedIn

            1.  Instagram

            1.  Facebook

            1.  Twitter

        1.  案例研究：那场赠送所有黄金的晚餐

        1.  结论

    1.  第七章：钓鱼

        1.  设置钓鱼攻击

            1.  为钓鱼登陆页面设置安全的 VPS 实例

            1.  选择电子邮件平台

            1.  购买发送和登陆页面域名

            1.  设置钓鱼攻击和基础设施 Web 服务器

        1.  钓鱼的额外步骤

            1.  使用跟踪像素衡量电子邮件被打开的频率

            1.  使用 Gophish 自动化钓鱼攻击

            1.  为钓鱼登陆页面添加 HTTPS 支持

            1.  在钓鱼中使用 URL 缩短工具

            1.  使用 SpoofCard 进行来电伪装

        1.  时间和交付考虑

        1.  案例研究：25 美元的高级持久网络钓鱼

        1.  结论

    1.  第八章：克隆登录页面

        1.  克隆网站的示例

            1.  登录页面

            1.  敏感问题页面

            1.  错误页面

            1.  收集信息

        1.  克隆网站

            1.  查找登录页和用户页面

            1.  使用 HTTrack 克隆页面

            1.  修改登录字段代码

            1.  将网页添加到 Apache 服务器

        1.  结论

    1.  第九章：检测、测量与报告

        1.  检测

        1.  测量

            1.  度量标准的选择

            1.  比率、中位数、均值和标准差

            1.  邮件被打开的次数

            1.  点击次数

            1.  表单中的信息输入

            1.  受害者采取的措施

            1.  检测时间

            1.  纠正措施的时效性

            1.  纠正措施的成功

            1.  风险评估

        1.  报告

            1.  知道何时打电话

            1.  撰写报告

        1.  结论

1.  第三部分：防御社交工程

    1.  第十章：主动防御技术

        1.  意识提升项目

            1.  如何以及何时进行培训

            1.  非惩罚性政策

            1.  奖励良好行为

            1.  运行网络钓鱼攻击

        1.  声誉与开放源信息（OSINT）监控

            1.  实施监控程序

            1.  外包

        1.  事件响应

            1.  SANS 事件响应流程

            1.  回应网络钓鱼

            1.  回应语音钓鱼

            1.  回应开放源信息收集

            1.  处理媒体关注

            1.  用户应如何报告事件

            1.  技术控制与隔离

        1.  结论

    1.  第十一章：技术邮件控制

        1.  标准

            1.  “发件人”字段

            1.  域名密钥识别邮件

            1.  发件人政策框架

            1.  基于域名的消息认证、报告与一致性

        1.  机会主义 TLS

        1.  MTA-STS

        1.  TLS-RPT

        1.  邮件过滤技术

        1.  其他保护措施

        1.  结论

    1.  第十二章：生成威胁情报

        1.  使用 Alien Labs OTX

        1.  在 OTX 中分析钓鱼邮件

            1.  创建脉搏

            1.  分析邮件源

            1.  输入指标

            1.  在 Burp 中测试潜在恶意域名

            1.  分析可下载的文件

        1.  进行威胁情报的 OSINT

            1.  搜索 VirusTotal

            1.  识别 WHOIS 上的恶意网站

            1.  通过 PhishTank 发现钓鱼网站

            1.  浏览 ThreatCrowd

            1.  在 ThreatMiner 中整合信息

        1.  结论

1.  附录 A：范围界定工作表

1.  附录 B：报告模板

1.  附录 C：信息收集工作表

1.  附录 D：欺骗样本

    1.  困惑的员工

    1.  IT 库存

    1.  透明度调查

1.  附录 E：提高社会工程学技巧的练习

    1.  帮助一个陌生人并寻找“标志”

    1.  即兴表演

    1.  单口喜剧

    1.  公共演讲/吐司大师

    1.  对家人和朋友进行 OSINT 操作

    1.  参加社会工程学和 OSINT CTF

1.  索引

## **表格列表**

1.  表 2-1：要求双方同意电话录音的州

1.  表 12-1：OTX 接受的指标

## **插图列表**

1.  图 3-1：社会工程学过程

1.  图 3-2：OODA 循环

1.  图 4-1：Walmart 在 Crunchbase 简介标签中的摘要

1.  图 4-2：Walmart 在 Crunchbase 财务标签中的股票信息

1.  图 4-3：Walmart 在 Crunchbase 财务标签中的投资信息

1.  图 4-4：Walmart 在 Crunchbase 财务标签中的收购信息

1.  图 4-5：Walmart 在 Crunchbase 简介标签中的人物信息

1.  图 4-6：Walmart 在 Crunchbase 简介标签中的信号与新闻

1.  图 4-7：Walmart 通过 DomainTools 的 WHOIS 记录

1.  图 4-8: OSINT 框架

1.  图 4-9: 未认证用户的 Hunter 搜索结果。（注：Hunter 对这些结果进行了审查。）

1.  图 4-10: 已认证用户的 Hunter 搜索结果。（注：作者对这些结果进行了审查。）

1.  图 5-1: 沃尔玛在 LinkedIn 上的公司详情

1.  图 5-2: 沃尔玛员工的 LinkedIn 资料

1.  图 5-3: 沃尔玛员工在 LinkedIn 上的资料

1.  图 5-4: 过于冗长的职位发布

1.  图 5-5: 沃尔玛 Facebook 上的登录页面

1.  图 5-6: 沃尔玛 Facebook 上的关于我们页面

1.  图 5-7: 沃尔玛 Facebook 上的社区页面

1.  图 5-8: 沃尔玛 Instagram 页面关注的账户列表

1.  图 5-9: 沃尔玛在 Instagram 上关注的标签

1.  图 5-10: 在 Instagram 上找到的沃尔玛供应商徽章

1.  图 5-11: 在 Instagram 上找到的多个沃尔玛员工徽章

1.  图 5-12: 在 Instagram 上找到的沃尔玛员工工作隔间

1.  图 5-13: Shodan 对 IP 地址和运行端口及服务的枚举，带有横幅

1.  图 5-14: 按 *Wal**-M**art* *Stores* 过滤的 Shodan 域名和 IP 地址枚举

1.  图 5-15: 进一步的 Shodan IP 地址枚举

1.  图 5-16: 创建新案件

1.  图 5-17: 带有证据的 Hunchly 控制面板

1.  图 6-1: 学生发送给我进行分析的图片

1.  图 6-2: 在 MacBook 上获取 EXIF 信息

1.  图 6-3: 从 EXIF 数据中提取的经纬度在 Google Maps 中的条目

1.  图 7-1: PuTTYgen

1.  图 7-2: 创建 PPK

1.  图 7-3: PuTTY 配置

1.  图 7-4: 配置 PuTTY 使用 PPK

1.  图 7-5: 设置 DigitalOcean 防火墙

1.  图 7-6: 创建 DigitalOcean 防火墙

1.  图 7-7: 在 Gophish 中设置新的登录页面

1.  图 7-8: 在 Gophish 中设置新的发送配置

1.  图 7-9: 在 Gophish 中设置新的电子邮件模板

1.  图 7-10: 在 Gophish 中设置活动

1.  图 8-1: 克隆站点的第一页 (*i**ndex.html*)

1.  图 8-2: 网站的 HTTPS 版本（显示明确的安全评分）

1.  图 8-3: 克隆站点的第二页，带有从 *i**ndex.html* 传递的 URL 参数 (*q**uestions.html*)

1.  图 8-4: SurveyMonkey 钓鱼网站的错误页面

1.  图 8-5：No Starch 登录页面的克隆

1.  图 8-6：真实的 No Starch 登录页面

1.  图 8-7：在 No Starch 注册页面克隆上显示自定义错误信息

1.  图 10-1：SANS 事件响应过程

1.  图 11-1：选择认证电子邮件选项

1.  图 11-2：开始 DKIM 配置

1.  图 11-3：生成 DKIM 记录和 RSA 密钥

1.  图 11-4：Google Workspace 中的 DKIM 记录

1.  图 12-1：OTX 仪表板

1.  图 12-2：在 OTX 中创建脉冲

1.  图 12-3：在 Thunderbird 中查看电子邮件的源代码

1.  图 12-4：钓鱼邮件的来源

1.  图 12-5：OTX 指标提取

1.  图 12-6：包含的指标

1.  图 12-7：排除的指标

1.  图 12-8：在 Firefox 中配置网络代理

1.  图 12-9：使用 Burp 截获流量

1.  图 12-10：钓鱼示例登陆页面

1.  图 12-11：损坏的钓鱼重定向

1.  图 12-12：*esy.es* 的 WHOIS 记录

1.  图 12-13：NoStarch 的 WHOIS 记录

1.  图 12-14：PhishTank 搜索 *nurrahmahgroup.esy.es* 钓鱼

1.  图 12-15：*PhishTank.com* 上的有效钓鱼

1.  图 12-16：提交钓鱼样本到 PhishTank

1.  图 12-17：*nurrahmahgroup.esy.es* 的 ThreatCrowd 可视化

1.  图 12-18：*nurrahmahgroup.esy.es* 的 ThreatMiner 结果

## 指南

1.  封面

1.  前言

1.  献辞

1.  介绍

1.  开始阅读

1.  索引

## 页码

1.  iii

1.  iv

1.  v

1.  vii

1.  xvii

1.  xviii

1.  xix

1.  xx

1.  xxi

1.  1

1.  3

1.  4

1.  5

1.  6

1.  7

1.  8

1.  9

1.  10

1.  11

1.  12

1.  13

1.  14

1.  15

1.  16

1.  17

1.  18

1.  19

1.  20

1.  21

1.  22

1.  23

1.  25

1.  26

1.  27

1.  28

1.  29

1.  30

1.  31

1.  32

1.  33

1.  34

1.  35

1.  36

1.  37

1.  38

1.  39

1.  40

1.  41

1.  42

1.  43

1.  44

1.  45

1.  46

1.  47

1.  48

1.  49

1.  50

1.  51

1.  53

1.  54

1.  55

1.  56

1.  57

1.  58

1.  59

1.  60

1.  61

1.  62

1.  63

1.  64

1.  65

1.  66

1.  67

1.  68

1.  69

1.  70

1.  71

1.  72

1.  73

1.  74

1.  75

1.  76

1.  77

1.  78

1.  79

1.  80

1.  81

1.  82

1.  83

1.  84

1.  85

1.  86

1.  87

1.  88

1.  89

1.  90

1.  91

1.  92

1.  93

1.  94

1.  95

1.  96

1.  97

1.  98

1.  99

1.  100

1.  101

1.  102

1.  103

1.  104

1.  105

1.  107

1.  108

1.  109

1.  110

1.  111

1.  112

1.  113

1.  114

1.  115

1.  116

1.  117

1.  118

1.  119

1.  121

1.  122

1.  123

1.  124

1.  125

1.  126

1.  127

1.  128

1.  129

1.  130

1.  131

1.  132

1.  133

1.  135

1.  137

1.  138

1.  139

1.  140

1.  141

1.  142

1.  143

1.  144

1.  145

1.  146

1.  147

1.  149

1.  150

1.  151

1.  152

1.  153

1.  154

1.  155

1.  156

1.  157

1.  158

1.  159

1.  160

1.  161

1.  162

1.  163

1.  164

1.  165

1.  166

1.  167

1.  168

1.  169

1.  170

1.  171

1.  172

1.  173

1.  174

1.  175

1.  176

1.  177

1.  178

1.  179

1.  180

1.  181

1.  182

1.  183

1.  184

1.  185

1.  186

1.  187

1.  188

1.  189

1.  190

1.  191

1.  192

1.  193

1.  194

1.  195

1.  196

1.  197

1.  198

1.  199

1.  201

1.  202

1.  203

1.  205

1.  206

1.  207

1.  208

1.  209

1.  210

1.  211
