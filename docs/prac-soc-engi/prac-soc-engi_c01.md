# 什么是社会工程学？

![](img/chapterart.png)

*社会工程学*是指利用人类心理学影响目标，使其执行某个动作或提供某些信息的任何攻击。这些攻击在信息安全行业和黑客社区中扮演着重要角色，但你可能也在生活中见过类似的行为。

例如，销售和营销团队经常使用社会工程学战术。一个进行冷电话推销的销售人员可能会通过向潜在客户推荐解决方案来影响电话那头的人。孩子们经常提到“酷小孩”正在做的事情，以此来获得父母的认同，而父母可能会夸大警告某些行为的后果（想想《圣诞故事》中大人们无数次告诫拉尔菲，他会把眼睛射瞎）。

阅读本书的人中，许多人可能接到过来自“微软公司”的电话，或收到过来自“尼日利亚王子”的电子邮件。我自己也曾收到过类似的“性勒索”或“炸弹威胁”比特币钓鱼邮件。

本书将从渗透测试者的角度教你社会工程学的基础知识。这里提供的概念将帮助你从道德的角度更好地理解如何进行社会工程学，通过模仿恶意对手的战术，发现安全漏洞，然后加以修复。与真正的罪犯不同，你在进行社会工程学攻击时会获得许可，并且不会故意对目标造成伤害。

## 社会工程学中的重要概念

以下章节描述了社会工程学的组成部分，包括最常见的社会工程学攻击类型。作为一名渗透测试员，你可以使用这些攻击手段，但我通常会在针对员工个人资源（如他们的移动设备、社交媒体账户和家庭计算机）时划定道德界限。坏人可能不会这么讲究，但我们在第二章中会讨论，你不应该在测试中完全模仿他们。

### 虚假身份

根据社会工程学框架，*虚假身份*是指冒充他人。你可以通过穿上制服、编造背景故事或提供*联系背景*来进行虚假身份。我用“联系背景”一词来指代你与受害者交谈时的借口。例如，如果你自称是垃圾回收公司的一员，手持写字板，穿着公司制服，那你就是在进行虚假身份。

### 开源情报

*开源情报（OSINT）*是指从公开资源收集的关于目标的信息。开源情报的来源包括报纸、搜索引擎、美国证券交易委员会（SEC）或其他监管机构的文件、社交媒体、招聘网站、评论网站等。开源情报帮助你创造与目标接触的背景。

OSINT（开源情报）可以决定你的社交工程是否成功，因为为了成功，你通常需要了解目标公司及其员工的重要细节。比如他们使用的是什么类型的虚拟私人网络（VPN）？他们还使用了哪些其他技术？组织建筑的物理布局是怎样的？了解这些信息可以帮助整个过程更加顺利地进行。一些领先的渗透测试人员告诉我，收集 OSINT 与实际执行渗透测试的时间比例通常在 30/70 到 70/30 之间。

### 钓鱼攻击

可能是最常见的社交工程形式，*钓鱼攻击*是指发送欺诈邮件，以影响或胁迫目标提供信息、打开文件或点击链接。我将在本书后面介绍你可能使用的各种技术。

传统的钓鱼邮件通常不会发送给特定的收件人。相反，它们通常是发送给骗子和犯罪分子购买的电子邮件地址列表。这意味着你可能会将邮件发送给大量的人，而没有收集关于他们的 OSINT。例如，在没有关于目标的任何背景信息的情况下，你可能会拼凑一封通用邮件，试图让用户登录一个虚假的网站或下载一个文件。当目标打开该文件时，可能会在他们的计算机上打开一个远程命令行，或者目标可能会安装恶意软件。一旦攻击者安装了命令行或恶意软件，他们就可以与系统进行交互式通信，执行后期攻击和特权升级，继续侵入系统和网络。

有时，*利用工具包*（用于实施其他攻击并投放恶意软件的软件）会利用钓鱼来传播其恶意软件。根据 2018 年赛门铁克互联网安全威胁报告（ISTR），0.5%的所有 URL 流量是钓鱼，且其中 5.8%的流量是恶意的。也就是说，每 224 个 URL 中就有 1 个是恶意的！

话虽如此，像这里描述的简单钓鱼攻击在伦理黑客和渗透测试中并不常见。如果客户雇佣你进行渗透测试，可以合理假设客户可能已经具备足够的安全成熟度，能够避免受到简单钓鱼攻击的欺骗。

### 鱼叉式钓鱼攻击

*鱼叉式钓鱼攻击*是传统钓鱼攻击的一种变种，其中社交工程师专注于一个特定目标。如果你是一个使用鱼叉而不是渔网的渔夫，你可能需要了解每种鱼类的行为以及如何接近它们。类似地，作为一个社交工程师，你需要收集、综合并武器化关于目标公司或个人的开源情报（OSINT），以便正确地将其诱捕。

ISTR 声明，矛盾钓鱼（spear phishing）是针对性攻击中的主要攻击方式。报告估计，在 2018 年，71%的有组织团体，包括国家级黑客、网络犯罪分子和黑客活动分子，都利用矛盾钓鱼来帮助实现他们的目标。这个比例在 2019 年降至 65%。

如果你曾作为社会工程学渗透测试人员（或者作为某个公司的顾问，提供建议或模拟对手的角色），你可能会大部分时间都在模拟矛盾钓鱼攻击。这是公司最常面临的攻击类型，并且它们需要最少的直接互动，使其对于潜在客户来说更加实惠。

你会从对目标公司或个人的开源情报（OSINT）调查开始。这可能包括了解他们使用的服务提供商。例如，你可以制作一封伪装成他们人力资源服务提供商的钓鱼邮件，假装提供与 W-2 或保险开放注册相关的资料。你会在邮件中插入人力资源公司 logo，并使用公司特定的术语，然后将目标引导到实际公司网站的克隆站点，以试图获取他们的凭证或引诱他们下载文件。

### 捕鲸攻击

*捕鲸攻击*是针对“大鱼”进行钓鱼——通常是公司高级高层。在我进行社会工程学渗透测试的过程中，我发现这些目标比其他许多人更具信任感。他们通常比普通用户拥有更多的访问权限。例如，他们更可能是公司系统的本地管理员。你需要以不同于钓鱼或矛盾钓鱼的方式进行这些攻击，因为这些人有着不同的动机，比如帮助台或销售团队。

假设你的目标是公司 CFO。你可能会试图修改之前发送的伪造人力资源矛盾钓鱼邮件，以与目标建立更多的关系。你可以个性化邮件中的名字，添加他们的职位，或者提及目标公司在平台实施中的其他关键信息，这些信息只有他们应该知道。或者，你可能需要使用一个完全不同的情境，涉及目标所在的贸易组织或专业团体。开源情报（OSINT）可以帮助你了解该团体的内部术语。

### 语音钓鱼

在 *语音钓鱼* 攻击中，攻击者会拨打目标的电话并与其通话。语音钓鱼比钓鱼攻击通常更难，因为它需要即兴应变的能力。虽然钓鱼攻击给你提供了思考你想说什么的时间，但语音钓鱼要求你从一开始就准备好故事，并迅速回忆起其中的抽象细节。你还可能会遇到让人接电话的困难；误解工作空间的布局；或者犯下重大错误，比如冒充受害者旁边隔间的人，或者使用错误的性别或口音。

语音钓鱼的好处在于你能立即看到攻击的结果。当你发送电子邮件时，你必须等待信息被打开、链接被点击、数据被输入。而语音钓鱼虽然比钓鱼攻击更耗时（尤其是按每个用户计算），但如果语音钓鱼活动成功，你可以在较短的时间内造成更多的损害。

在这些操作中，你很可能会使用移动应用程序或其他软件 *伪造* 或伪装一个电话号码，并以某个借口拨打电话。在通话过程中，你将与目标建立融洽关系，然后试图让他们执行某个动作或提供信息。你可能会说自己是被委托进行调查，或者声称自己是客户、供应商或顾客。你会要求他们提供与预设借口相关的信息，并将其记录在报告中。

在录音时要小心。一些州是单方州，其他州则是双方州。*单方州* 只要求电话中的一方同意录音即可。*双方州* 则要求双方都同意录音。如果你正在针对客户拥有的资源进行操作，客户可以作为第二方提供录音授权。如果你与目标的个人设备进行互动，则必须得到目标本人的同意，这会破坏渗透测试的目的。在以这种方式进行任何测试之前，谨慎的测试人员或公司应咨询法律顾问，以确保所有活动是合法的。

### 诱饵攻击

*诱饵攻击* 是指使用某种诱饵让目标执行某个动作。这通常涉及使用 USB 设备或像二维码这样的创新替代品，让目标运行恶意计算机代码。为了理解二维码的有效性，可以考虑它们在 2020 年的普及，当时许多餐馆开始使用二维码来提供“无接触”菜单。

你可能会将虚假的文件加载到 USB 闪存驱动器或 Hak5 Rubber Ducky 上，然后将这些文件标记为裁员、加薪、奖金或 CEO 的个人财产。（*Rubber Ducky* 是一种内置计算机的设备，外形与许多 USB 驱动器相同，充当键盘，能够向系统输入数据，仿佛用户正在亲自输入。）然后，你会将这些驱动器或 Rubber Ducky 散布在目标校园周围，让人们发现。

使用 Rubber Ducky 有其优势。如果你使用 Rubber Ducky，你可以将恶意脚本与实际的合法文件一起加载到设备中。当有人将其插入电脑时，它会绕过任何*数据丢失防护工具*（防止文件通过 USB 存储设备、电子邮件或像 FTP 或 SCP 这样的协议被移动的软硬件解决方案），因为它伪装成 USB 键盘。如果你使用普通的 USB 设备，数据丢失防护软件可能会拦截你。如果没有，目标会打开文件并部署*有效载荷*（有助于实现预期结果的脚本或工具）。

你可以使用诱饵攻击来获取系统上的远程 shell，这样你就可以开始直接与主机计算机互动。但诱饵攻击很棘手，因为很难确保诱饵能到达目标位置，并且确保从工作计算机获得的任何 shell、连接或其他信息都在活动范围内。人们可能会把驱动器带回家并插入家庭计算机，而你并没有攻击家庭计算机的权限。

### 垃圾箱翻找

可能是最不性感的社会工程学类型就是*垃圾箱翻找*，即从目标办公室收集垃圾袋，然后带到外面解剖获取信息。你可能会了解到更多关于组织的信息，甚至找到你正在寻找的东西。想想你扔掉的东西。一些是非常个人化的。然而，其他的则可能与目标无关（例如，你收集的垃圾袋可能来自公司厕所）。

在这种类型的活动中，你通常会假扮成目标垃圾公司的员工，并编造一个故事来引导你进入垃圾箱。当你到达时，收集几袋垃圾，带到其他地方，并进行检查。

在进行垃圾箱翻找时，你可能需要戴手套，甚至可能需要戴上呼吸器。你还可以刺激当地经济，雇佣高中生或大学生来做这些脏活。记下你所看到的，阅读任何书面材料，并将任何撕碎的文件粘回去。这可能是最终目标，或者是通往更大目标的垫脚石。

## 社会工程学中的心理学概念

与信息安全领域的其他部分不同，后者借用了计算机科学、系统管理、编程和数据库管理等概念，社会工程学主要借用了心理学的许多概念。因此，社会工程师必须保持对心理学和人类行为发展的最新了解。

当我在做博士论文研究时（虽然我从未完成），我花了更多时间阅读心理学和社会学期刊，而不是技术期刊。我时不时会翻阅一本厚三英寸的文件夹，里面满是同行评审的文章，并且我还会利用校友身份访问学术期刊来查找新的信息。在这一部分，我回顾一些对社会工程师有用的基本心理学概念。

### 影响力

*影响力*是一个中性术语，用来驱使某人的行为以产生特定结果。影响力可以是积极的，也可以是消极的。例如，医生与患者谈论他们的健康状况、可能采取的纠正措施以及面临的风险，从而激励他们采取更健康的生活方式，这就是一个影响力的例子。

### 操控

在心理学领域之外，人们通常将*操控*与影响力定义为相同的概念。但在该领域内，这两个术语有着明显不同的含义。操控是影响力的一种有害实施方式，通常是为了造成伤害。在社会工程中，坏演员和出于善意的人经常会使用操控而非影响力，无论是由于缺乏训练还是目光短浅。

### 融洽关系

*融洽关系*简而言之，就是相互信任。梅里亚姆-韦伯斯特词典将融洽关系定义为“一种友好、和谐的关系”，并补充道，这种关系通常“以协议、相互理解或同理心为特征，这使得沟通变得可能或容易”。美国心理学会（APA）在此基础上进一步指出，“在心理治疗中，与客户建立融洽关系常常是治疗师为了促进和深化治疗经验并推动最佳进展和改善的一个重要中介目标。”

就像治疗师一样，社会工程师也会尝试与他们的目标建立融洽关系以赢得信任。为了建立融洽关系，他们常常依赖共同的经历（无论是真实的还是虚构的），迎合目标的兴趣，并强调自己的个性特征。你可以利用开源情报（OSINT）了解目标的喜好与厌恶。

### 西奥迪尼博士的六个说服原则

在他的书《*影响力：说服心理学*》（哈珀，1983 年）中，心理学家罗伯特·西奥迪尼详细阐述了影响力与操控之间的关系。在这篇文章中，西奥迪尼博士概述了六个核心说服原则：权威、喜好、紧迫感和稀缺性、承诺和一致性、社会证明、以及互惠。

让我们更仔细地看看这些原则及其适用性。

#### 权威

当某个权威人物告诉别人做某事时，或者当人们被引导相信（无论是真的还是虚假的）一个权威人物也在做这件事时，他们往往会去执行某个特定的行为。我喜欢在语音钓鱼中使用权威诉求。例如，我可能会打电话说我是按照首席执行官、首席信息安全官或某个特定法律的授权在行动。

这种技巧可能非常有效。不过，请记住，你绝不应该声称自己是政府的代理人。这包括任何联邦调查局（FBI）、国际刑警组织（INTERPOL）、州警察、地方警察或警长办公室成员；美国国税局（IRS）或其他税务征收机构；中央情报局（CIA）、国家安全局（NSA）或联邦应急管理局（FEMA）等机构的成员。这样做是犯罪！

#### 讨人喜欢

人们往往愿意帮助令人喜爱的人。你曾遇到过不试图让自己变得讨人喜欢的销售员吗？他们常常会夸奖你的衣着、外貌和智力，以赢得你的青睐。

#### 紧迫感和稀缺性

人类天生喜欢稀缺的东西。我最近在一家本地健身房利用了一个优惠。在注册过程中，出现了一个计时器，提示我如果在一分钟内不完成交易，我将被从符合资格的名单中移除。我重复了三次这个过程。前两次，我在同一 IP 地址下一分钟内完成了交易。第三次，我浪费了大约五分钟，每次一分钟一到，计时器都会重置。

故事的道德寓意是：健身房试图利用紧迫感让我签署可能对我有利也可能无益的东西。计时器给潜在客户带来了人为的时间限制，并让他们产生如果不迅速行动就会错失机会的感觉。

在网络钓鱼中，许多骗子声称自己正在出售或赠送某些稀缺的物品。为了诱使受害人采取行动，无论是点击还是输入信息，他们会以一个太过美好的交易，提供一些昂贵的商品，并附带警告，受害人必须在短时间内行动。

在其他情况下，犯罪分子可能会通过威胁给受害人仅留几个小时的时间来付赎金，从而迫使受害人支付赎金，声称如果不快速行动，就会永久删除、窃取或释放数据——无论他们是否真的会照做。罪犯希望通过恐吓受害人，让他们在未曾思考清楚之前就采取行动。

#### 承诺和一致性

人们重视一致性。我们通常不喜欢变化。有时，社会工程师要么保持一致性，要么打破一致性来影响目标。销售员可能会声称自己对客户的成功比对佣金更有承诺，像是说：“我一直在为我的客户着想。我理解你和你的组织。我是那种‘你看到什么，就是什么’的人。”这在依赖长期关系开展工作的销售员中很常见。

#### 社会认同

我们常常被施压要“赶上别人”。换句话说，我们做某些事只是因为别人认为那是正常的、适当的，或者是地位的象征。社交工程师可能会让目标相信某件事具有很高的地位，或者他们可能会说所有其他高绩效的员工都在做他们试图让目标做的事。提供某件事情受欢迎的证据被称为*社交证明*。例如，汽车销售员可能会试图通过告诉你同龄的成功人士都在开豪华车来让你购买一辆。

在一次社交工程活动中，攻击者可能会通过花时间收集一些开放源信息（OSINT）来依赖社交证明。他们可能会找出公司中有影响力的人。然后他们会发邮件给你，声称他们与那位有影响力的人交谈过，那个人称赞你并提供了你的联系方式，帮助他们解决“问题”。我曾收到几封“招聘者”的邮件，声称是朋友给了他们我的联系方式，但不希望被透露身份。这些职位是 Java 开发的，而我的简历和 LinkedIn 上都没有提到过这种技能。这种行为让我直接拉黑他们。

#### 互惠

我们都会尝试帮助那些帮助我们的人。通常，社交工程师会帮助别人完成某个任务，然后要求对方回报做一些可能不符合其最佳利益的事情。一个例子是在我参加位于罗德岛纽波特的 Layer 8 会议时发生的，那是一个社交工程学会议。在一个码头旁，我看到一对情侣试图拍一张有帆船背景的照片。我主动提出帮他们拍照。

“哦，你会吗？”他们问。

“当然。你知道吗？这是我的手机。你可以拿着它，这样你就知道我不会跑掉拿走你的手机。”我回答道，试图与他们建立关系。

我拍了张照片。就在那时，另一艘壮观的船直接从他们背后经过。我告诉他们稍等一下。“让我给你拍一张背景有这艘船的照片。”我说。

他们同意了。“那太棒了。”

我又拍了几张照片。一旦拍完，我把手机递给他们，让他们查看，随后他们感谢了我。

“嘿，不客气。顺便问一下，你有时间帮我做个关于人类学的调查吗？这是我夏季课程的一部分。”我问道。

“当然，是什么？”他们回答道。

因为我为他们拍了照片，他们觉得有义务回报我，尽管回答我问的问题对他们的最佳利益并没有帮助。

“我在做一个关于人们迁徙模式和不同民族群体如何与其他民族群体融合的调查。我收集了关于名字、旅行地点和模式之类的信息。我收集了大量关于家庭父系的信息。你母亲结婚前叫什么名字？”注意，我并没有说，“你母亲的娘家姓是什么？”因为这个问题会引起警觉。这是一个常见的密码重置问题，人们已经被训练成要保护这个信息。

他们俩都告诉了我，然后告诉我他们来自哪里。我告诉他们我在那里有一些朋友。这是个谎言；实际上，我只是对那个地方有些模糊的了解。我说我的朋友在他们城市的一所高中上学。他们回答说那是一个竞争对手的高中。我鼓励他们。

“吉祥物是什么？”我问道。

他们告诉了我吉祥物的名字。我本可以继续下去……

### 同情与同理心

建立融洽关系的一个优秀方式是，*同情*是关心某个人感到难过或处于某种困境中，比如在失去亲人或宠物之后。有时与*同理心*混淆，*同理心*是理解他人感受，就像你处于他们的处境一样。同理心依赖共享的情感或视角，而同情只是表达*你*自己的感受。

这两者在某些情况下对建立融洽关系都很重要。你需要能够表达自己的感受，以及受害者的感受，才能施加影响并知道何时过度。当与受害者互动时，你可以分享一个类似的故事（无论是真实的、虚假的，还是两者的某种夸大组合），以及这件事是如何让你感受的。这可以让他们对你的处境产生同理心，并增强你们之间的融洽关系。或者，如果有人告诉你一些你无法感同身受的事情，问他们关于这件事的问题，或者告诉他们你很抱歉发生了这样的事，就是在表达同情。然而要小心：如果你对别人说的每件事都有回答或故事，他们可能会变得怀疑，所以要谨慎使用这种方法。

## 结论

社会工程学可以成为一个非常强大的工具，用于获取访问权限。本章向你介绍了一些技术，其中许多我们将在全书中进一步探讨。

记住，建立融洽关系是关键。一旦建立了融洽关系，后续的互动就会变得更加容易。理解心理学概念和潜在的人类行为是一种有助于与他人建立联系的方式。此外，你收集的开源情报（OSINT）越多，你就能越聪明地谈论一个组织。你可以在了解文化、运营和技术的同时，找到与员工建立融洽关系的线索，这将使得后续在渗透测试或红队活动中的工作更加轻松。这些信息将帮助你，无论是在进行钓鱼攻击、定向钓鱼、捕鲸攻击、语音钓鱼、诱饵攻击，还是垃圾桶搜寻。
