# 第二章：社交工程中的伦理考虑

![](img/chapterart.png)

与网络和 Web 应用渗透测试不同，社交工程的影响可能超出笔记本电脑或服务器的范围。当您与真实的人互动时，必须采取特别的预防措施，以避免伤害他们。

您还必须确保遵守您所在地区的法律，以及您将要针对的任何人或企业所在地区的法律。尽管可能没有法律先例要求您以特定方式收集开源情报（OSINT）——或限制您根本不能收集 OSINT——但一些法律，如欧盟的通用数据保护条例（GDPR），对您收集的数据施加了具体的责任和后果，并规定了如何保护这些数据。本章概述了如何合法和道德地进行社交工程和收集开源情报的指南。

## 伦理社交工程

让我们从讨论社交工程攻击本身开始。在社交工程活动中，您必须敏感地考虑目标因您的行为而产生的感受。这可能很棘手，因为您必须找到一种方法，证明一个公司是脆弱的，通常是因为员工缺乏适当的培训或流程，而不是让揭露这些漏洞的人感到受害或被妖魔化。

保护人们的一种方式是让他们对客户保持相对匿名。例如，不要报告会计部的 Ed 点击了一个钓鱼邮件中的链接，而是说会计部或财务部的某个员工成为了钓鱼攻击的受害者。在这样做时，您应该考虑组织的规模以及同行能否通过您提供的细节猜测受害者的身份。如果您在一家小公司工作——比如本书的出版商 No Starch Press——您可能会避免说公司创始人 Bill Pollock 在 Facebook 上公开发布了过多的权限信息，而选择说某个经理在社交媒体上缺乏隐私和访问控制。

实际的坏人可能不会遵守类似的边界。然而，在渗透测试中，我们不应当复制坏人做的*所有事情*。如果我们这么做了，我们就会对渗透测试客户使用*拒绝服务攻击*（针对网络和系统的攻击，导致合法用户和服务无法访问它们）；通过公开泄露客户的个人信息，如地址、电子邮件地址和电话号码，来进行*人肉搜索*；还可能部署*勒索软件*（一种恶意软件，要求受害者支付赎金才能解锁它）。

以下是一些在社交工程活动中保护他人的技巧。

### 确定边界

以下内容无需多言：如果有人要求你停止与他们交谈，或是他们结束了对话，你应该停止。同时，虽然你可以查看目标在社交媒体上的公开帖子并建立他们的个人档案，但你绝不应该做以下事情：

+   针对他们的个人账户（包括与他们建立联系）

+   在工作之外针对他们

想象一下，如果有人在你在家时不断向你询问工作问题，你会喜欢吗？收集开源情报（OSINT）时，社交媒体的可接受使用包括寻找关于工作的信息、提及特定软件或技术，或者出现常用用户名的情况。

### 理解法律考量

在进行社会工程学时，有两个主要的法律考量：伪造和录音。除此之外，避免法律问题的一项最佳实践是确保你针对的是客户拥有的资产，而不是员工自带设备（BYOD）系统。

一些州，例如田纳西州，有法律规定使得伪造电话号码成为非法行为。如果你是以客户公司授权的对手模拟身份进行伪造，并且只针对公司拥有的资产，那么通常是合法的。至于录音，一些州要求双方法同意，即你和受害者都必须同意，而另一些州则要求单方法同意，只需你同意即可。是否可以将公司视为员工在公司拥有设备上的第二方同意人是一个法律灰色区域。表 2-1 列出了双方同意州。如果被要求录音，请向法律顾问咨询，以明确你所在地区的具体法律要求。

表 2-1：要求双方同意才能录音的州

| **双方同意州** | **备注** |
| --- | --- |
| 加利福尼亚州  |  |
| 康涅狄格州 | 从刑事案件的角度来看，除了发送方或接收方，其他人录音是非法的；从民事案件的角度来看，康涅狄格州是双方同意州。 |
| 特拉华州  |  |
| 佛罗里达州  |  |
| 伊利诺伊州 | 拥有最为复杂的同意法律。它是一个双方同意州，但对像法庭这样的公共场所有特殊的豁免。该法律适用于“私人电子通信”，包括通过电话、计算机和其他通信设备发送的消息。 |
| 马里兰州  |  |
| 马萨诸塞州  |  |
| 蒙大拿州  |  |
| 内华达州 | 根据法律，内华达州是一个单方同意州，只要录音方参与了通信。然而，根据内华达州最高法院在*Lane v. Allstate*一案中的先例，你应该将内华达州视为双方同意州。 |
| 新罕布什尔州  |  |
| 俄勒冈州 | 录音电话时，俄勒冈州是单方同意州；但在面对面沟通的录音时，俄勒冈州是双方同意州。 |
| 宾夕法尼亚州  |  |
| 华盛顿州  |  |

### 理解服务的考虑因素

如果你违反了服务的使用条款，也可能会遇到麻烦。2019 年，Black Hills Information Security 的 Mike Felch 发布了两篇关于在钓鱼攻击中选择软件服务的博客文章。这两篇文章名为《如何清除 Google 并重新开始》第一部分和第二部分，讨论了他在使用 G Suite（现称 Google Workspace 的谷歌生产力平台）作为目标和攻击工具时的经验。Felch 解释了他是如何获取凭证并使用 CredSniper 绕过多因素认证的。

故事在此发生了有趣的转折。他被客户的安全运营中心（SOC）和谷歌的 SOC 都检测到。作为副产品，谷歌不仅采取了措施禁用他所使用的账户，还（可能通过使用一些开放源情报和自身的检测算法）开始锁定他和妻子在其他与谷歌服务无关的账户。这个故事的教训是，确保在进行攻击之前与你的客户可能使用的其他服务提供商协调，以确保你不会被锁定在所有账户之外，包括像 Mike 一样，连你的温控器也被锁定了。

### 参与后的总结

在进行社会工程学操作后，*总结*对组织和受害员工至关重要。总结包括让受害者了解你使用的技巧和收集的信息，广义上来说。你不需要告诉整个组织 Finance 部门的 Jane 用她丈夫 John 的名字作为密码，或者 Madison 与她的叔叔之间的关系问题。向客户提供的报告应该保持匿名，省略细节；你只需要告诉他们你发现*一些*员工使用配偶的名字作为密码，或者你轻松地发现了他们个人关系的相关信息。

解决这个伦理问题的一种方法是保持一份受害者名单，并记录他们在评估中失败的原因，同时将他们的姓名从报告中删除。如果贵公司联络人要求获取这些信息，你可以提供名字，只要公司同意不解雇这些员工。这种谈判有时会成为社会工程师与客户之间合同中的一个条款。如果公司未能对员工进行适当培训，解雇他们因安全疏忽是不公平的。另一方面，报告中应该提到那些阻止攻击成功的人。这些人采取了行动来保护组织，他们应当得到认可和奖励。

从组织角度看，管理层应让员工知道，公司本身并没有对他们进行窃听。相反，应该明确表示公司雇佣了外部人员来进行监听，然后将数据筛选出与业务相关的信息，以保护员工的个人生活隐私。此外，组织应使用你提供的报告以及推荐意见和示例情景来对员工进行培训，使他们能够更加安全。

在参加像 DerbyCon、Hacker Halted 和各种 Security BSides 等会议时，我遵循与报告相同的规则。你永远不知道是否有一个曾是攻击受害者的人在场，因此避免公开羞辱他人。公开表扬，私下批评。鼓励人们更加警惕，并向适当的人报告问题。

## 案例研究：社会工程学过度使用

2012 年，当凯特·米德尔顿公爵夫人怀着剑桥王子乔治时，因严重的晨吐症状住进了医院。公众和媒体很快得知了这一消息，凌晨 5:30，澳大利亚一家电台的两名 DJ 打电话到医院，假扮成英国女王和查尔斯王子。主持人模仿他们的口音，要求提供米德尔顿的最新情况。接待的护士接听了电话。她相信电话是真实的，于是将他们转接到了米德尔顿的私人护士处，后者提供了她的病情的各种细节。

这两名 DJ 录下了电话并在节目中播放。这档节目引起了国际关注。在医院采取任何行动之前，那名护士被发现死于疑似自杀。威廉王子和凯特·米德尔顿公爵夫人发布了声明，表达了对这一事件的深切悲痛，并向护士的亲友表示哀悼。

这是社会工程学过度使用的一个例子。恶作剧就是恶作剧，但在电话的某个时刻，恶作剧者应该暴露自己的身份。他们也不应该将这些恶作剧公之于众，向广泛的观众公开。广播节目似乎已经被取消，节目和主持人的 Twitter 账户也似乎被删除了。主持人发表了正式的公开道歉——但这一切来得太晚，没能避免一场本可以避免的悲剧。

尽管这一行为更像是一种无聊的恶作剧而非攻击，但这一事件符合 APA 对*操控*的定义，因为 DJ 们的行为并没有考虑到受害者的最佳利益。如果他们没有广播这通电话，他们的行为可能更接近于影响力，但最佳的解决方案应该是在一开始就不打这通电话。

## 道德的 OSINT 收集

现在我已经为社会工程学建立了法律和道德边界，我们也应该为开源情报（OSINT）做同样的事情。许多相同的考虑因素会发挥作用，但风险通常较低，因为虽然你通过 OSINT 收集到的信息可能会影响目标的福祉，但你并未直接与他们互动。尽管如此，这并不意味着你应该收集关于每个目标的所有数据。

### 保护数据

你应该评估保留你收集的数据的时间，如何销毁数据，如何为数据赋予价值，丢失数据的后果会导致什么，以及有人可能如何试图破坏数据。

数字取证和执法部门在处理数据时通常依赖于*证据链*的概念。证据链旨在保持所有收集到的证据处于安全状态，从收集时到销毁时。这个过程要求将所有证据保存在安全和受控的地点，比如你在电视上的警察节目中看到的证据保管柜。访问证据的人必须证明有正当需要，并签署取出和归还证据，以便追责。

在数字领域，执行证据链要稍微困难一些，但如果你采取某些预防措施，是可以实现的。首先是保持良好的安全卫生，我们接下来会讨论。对于每个调查，你需要一台专门的虚拟机，仅用于该任务。这台机器需要用强密码加密。一旦调查结束，确定数据保留要求。将虚拟机的文件存储在磁盘上。CD 或 DVD 可能足够大，或者你可能需要更大的驱动器，例如 USB 闪存驱动器或外部硬盘。作为额外的安全层，你可以加密驱动器本身，并安全存储它，远离任何计算机，并采取某种物理访问控制措施，比如锁和钥匙。

*数字卫生*不过是安全最佳实践的持续应用。在你的设备上安装某种形式的恶意软件保护，并且不要重复使用密码（并使用强密码）。你还应该在每个机会设置密码管理器和多因素认证。这只是冰山一角，但这些步骤可以帮助确保没有人能够质疑你数据的完整性，尤其是当你收集的 OSINT 用于诉讼时。

为数据分配价值时，考虑该数据可能对公司或个人造成的损害。我从不收集社会保障号码，但如果收集的话，我会赋予它们非常高的价值。如果我收集一个姓名或电子邮件以及密码，我会赋予它们最高的级别。找到这些信息表明某个组织或员工可能已经遭遇数据泄露，因此需要谨慎处理。话虽如此，如果该组织能够证明某个用户在技术上被禁止使用该密码，那么你可以将该问题的严重性降级为低级或仅为信息性提示。仅有密码而没有与之关联的用户，则价值较低，尽管你可以用它对公司进行密码喷洒攻击。（在*密码喷洒*攻击中，攻击者使用一个单一密码试图暴力破解多个账户，例如使用一个默认密码尝试所有观察到的账户。）

总结来说，通过最小化对存储敏感数据的系统的访问，保持系统的修补和更新，禁用不必要的服务，使用强密码，并在可能时启用多因素认证来保护你的敏感数据。同时，尽可能对数据进行加密。如果数据被他人获取并且他们无法破解加密密钥，那么这些数据对他们来说将毫无价值。

### 遵循法律和法规

本节介绍了收集开源情报（OSINT）时可能涉及的法律问题。虽然《通用数据保护条例》（GDPR）是影响开源情报的主要法律，但其他国家、州和地区也出台了类似的法律，针对数据泄露后个人信息的丧失进行规制。收集开源情报本身并不构成数据泄露，但由于尚未有法律先例明确 GDPR 和类似法律在应用于开源情报时的结果，因此你应该将这些法律视为与你的活动相关的。

#### 通用数据保护条例

自 2018 年 5 月 25 日起，GDPR 对欧盟公民的数据使用进行了监管。该法规旨在保护欧盟公民和居民在其数据收集和使用方面的权益。本质上，它赋予了欧盟公民和居民作为消费者的主权，让他们能够控制从他们那里收集的以及关于他们的数据。GDPR 在 2016 年通过后，企业有两年的时间进行合规调整。2018 年 5 月 25 日是全球所有公司必须遵守 GDPR 的最后期限。违反 GDPR 的公司可能面临其全球年收入的 4%的罚款。这应该成为保护任何关于欧盟公民（无论在欧盟境内还是境外）和访欧人员信息的动力。

GDPR（通用数据保护条例）对社会工程学和 OSINT 的主要影响在于，它赋予人们限制他人收集其个人信息（PI）和敏感个人信息（SPI）的能力，从而减少了他们的 OSINT 攻击面。此外，GDPR 对收集和存储属于欧盟公民的 PI 和 SPI 的公司设立了处罚措施，如果数据遭到泄露并公开可访问。  

GDPR 的另一项重要条款是“被遗忘权”。这一条款允许私人公民查询数据所有者或数据处理者持有的关于他们的个人信息，并要求及时删除其个人信息（PI）或敏感个人信息（SPI）。  

#### 作为执法人员收集数据  

如果你是执法人员（联邦、州、地方等）或持牌私人侦探，特定的道德规范和法律先例会指导你收集和使用 OSINT 的参数。在进行任何 OSINT 收集操作之前，务必查阅相关法律或咨询法律顾问。  

美国公民自由联盟（ACLU）在 2012 年发布了一份文件，警告使用大数据和其他技术（包括 OSINT）试图在犯罪行为发生前识别潜在罪犯的滑坡效应。ACLU 讨论了收集执法机构关于个人的大规模数据，然后利用这些数据将他们卷入可能并未犯下的罪行，通常通过数据科学进行预测。ACLU 文章的作者 Jay Stanley 认为，这种数据收集和分析将鼓励更多的收集，无论是否有正当理由。这可能导致人们在没有正当程序的情况下进入刑事司法系统。

#### 作为私人公民收集数据  

私人公民：你还没有摆脱困境。一些国家和地区有法律规范所有公民进行 OSINT 收集，即便是执法人员以外的人。例如，在南卡罗来纳州，你必须是持牌私人侦探，才能使数字取证研究在法庭上作为证据。*数字取证研究*包括从计算机系统分析中获得的任何信息，无论是硬盘还是网络。  

底线：你有责任了解你和你的目标所在地区的法律。在进行任何开放源代码情报（OSINT）收集之前，最好咨询一位具有网络法律知识的律师，特别是涉及商业和咨询领域的法律，以确保安全。  

## 案例研究：社会工程学的道德界限  

以下情境发生在我作为顾问，协助渗透测试团队对一个组织进行测试时。我被要求联系最多 25 个目标并撰写通话报告。公司没有提供给我任何背景信息。（一些客户喜欢提供背景信息，尽管我更倾向于自己创设情境，以确保员工没有被提前告知。）  

我假装进行一项*组织透明度调查*，这是我编造的，目的是让我能在 CEO 的所谓授权下向受害者提出一些相当私人化的问题。我没有通过开源情报（OSINT）去找电话号码，而是组织提供了一份号码列表，没有名字或部门。因为盲目拨打号码通常不会成功，我需要做更多的调查。在这些电话号码中，一个是警察调度，另外两个是当地法院的电话号码。我和经理讨论过这些号码，我们决定出于谨慎起见，不进行钓鱼电话。

为了拨打这些电话，我伪造了我的号码，让它显示为尼尔森公司（Nielsen）的电话，尼尔森是一家为其他组织进行调查的公司。我声称自己在进行一项由目标组织的负责人授权的调查，目的是了解员工对工作场所和其他部门的了解。我问了一些类似于以下的问题：

1.  你工作了多久了？

1.  你可以使用无线互联网吗？如果可以，网络名称或服务集标识符（SSID）是什么？

1.  你有自动售货机吗？

1.  你使用什么类型的电脑？操作系统是什么？

1.  你使用哪个品牌和类型的防病毒软件？

1.  你的清洁工是谁？

1.  你母亲婚前的名字是什么？

1.  你能提供一个你曾使用的旧密码或当前密码的例子吗？

作为缓解措施，我没有录音通话，并且在一个私密的地方进行。过了一段时间，有几个人给了我她母亲的婚前姓氏，但还没有人给我任何密码。

接下来，我打了一个公共事业电话。一个 60 多岁的女士接听了电话。我们互相寒暄了一下，我解释了调查内容。她同意尽可能提供帮助，但告诉我她不太懂技术。

“我也是，”我说。“我在 ACME 社区学院学习心理学，做这个工作是兼职的。”我们笑了笑，我开始了调查。

我逐一查看了列表。她回答了前六个问题，但当我问她婚前母亲的名字时，她告诉我那是密码重置问题，她真的不该告诉任何人。我同意继续问下去，告诉她我并不总是喜欢必须问这些问题。我提醒她，她完全可以拒绝回答任何问题。当我问她常用的密码时，她犹豫了一下，然后叹了口气告诉我“酪乳”。

“酪乳？”我重复道。

为了与她建立关系，我分享了一个真实的故事，讲述了小时候我如何喜欢和已故的祖父一起吃碎玉米面包浸在酪乳里。

那位女士开始抽泣。当我问她是否没事时，她告诉我，玉米面包加酪乳是她已故丈夫最喜欢的食物。我立刻感到低落。她告诉我，接下来的感恩节是她丈夫的生日，而她大约三年前因癌症失去了他。

在这种情况下应该怎么做？我选择保持角色，但我与她聊天直到确认她已经恢复到一个好的心理状态。如果我直接挂掉电话继续进行，那将是不道德的。我们聊到了已故的家人、她所在地区的人、天气以及其他一些闲聊话题。

在断开电话之前，我问她是否还好。断开电话后，我和实践负责人进行了交谈，重复了整个事件，并告诉他我不想再做更多的电话访问。他同意了，于是我转向了另一个不涉及打电话的项目。

主要收获：

+   始终允许人们选择退出参与。你可以尝试影响他们继续进行，但不要过于强求。如果他们说不，就放手。如果你有信心，可以稍后再问一次，但如果他们再次拒绝，就放弃。强迫不会对你的目标有帮助。

+   在提问敏感问题时，确保你处在安静和安全的环境中。如果提问这些问题时，避免录音通话。

+   如果你察觉到自己触动了某人的敏感神经，要花时间与他们进行总结或将他们带回稳定的状态，具体取决于你的任务是否适合这种做法。

+   如果你陷入像我这样的情况，应该与管理层沟通。他们应该知道发生了事故，以防目标联系他们，但他们也需要了解你的心理状态以及可能影响你表现的任何因素。

## 结论

社会工程学和开源情报（OSINT）对参与者的个人生活有影响，甚至影响到工作之外的生活。在这一点上，它不同于传统的渗透测试，因为传统渗透测试大多数情况下允许受害者把工作留在工作中。执行这些任务时，务必小心谨慎，确保目标人物不会遭受心理上的负面影响或其他伤害。做到这一点的最佳方法是设定明确的边界，就像本章中所描述的那样。否则，我给从业者的最佳建议是相信自己的直觉。在与国际客户合作时，不要犹豫联系法律顾问。如果你做的事情会让你自己感到不安，那很可能说明你不该这样做。
