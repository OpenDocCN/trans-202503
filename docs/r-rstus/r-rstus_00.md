

# 引言



![](img/chapter.jpg)

在 2020 年初，全球努力遏制 COVID-19 的传播时，有一个国家在其他国家未能做到的地方取得了成功：新西兰。新西兰能够应对 COVID-19 的原因有很多，其中之一就是 R 编程语言（没错，真的）。

这个谦逊的数据分析工具帮助新西兰应对 COVID-19，支持卫生部团队生成全国范围内的每日病例报告。基于这些报告中的信息，政府官员能够制定政策，保持该国基本免于 COVID-19 的影响。然而，团队规模很小，因此如果使用像 Excel 这样的工具每天生成报告是不可能的。正如团队领导 Chris Knox 告诉我：“试图在一个点选式环境中做我们所做的事是不可能的。”

相反，一些工作人员编写了 R 代码，可以每天运行以生成更新的报告。这些报告并不涉及任何复杂的统计数据；它们只是 COVID-19 病例的统计数字。它们的价值来自于 R 能够做的其他事情：数据分析和可视化、报告创建以及工作流自动化。

本书探讨了人们使用 R 来沟通和自动化任务的多种方式。你将学习如何做到以下几点：

+   制作专业质量的数据可视化、地图和表格

+   使用 R Markdown 替代繁琐的多工具工作流来创建报告

+   使用参数化报告一次生成多个报告

+   使用 R Markdown 制作幻灯片演示文稿和网站

+   自动化从 Google Sheets 和美国人口普查局导入在线数据的过程

+   创建自己的函数来自动化你反复执行的任务

+   将你的函数打包成一个可以与他人分享的包

最棒的是，你可以在不进行比计算平均值更复杂的统计分析的情况下完成这一切

## 难道 R 仅仅是用来做统计分析的吗？

很多人认为 R 只是一个用于硬核统计分析的工具，但它能做的不仅仅是处理数值数据。毕竟，每个 R 用户都必须以某种方式展示他们的发现并传达他们的结果，无论是通过数据可视化、报告、网站还是演示文稿。而且，使用 R 越多，你会发现自己越希望自动化那些目前手动完成的任务。

作为一名接受定性训练的社会学人类学家，且没有定量背景，我曾经对使用 R 进行可视化和沟通任务感到羞愧。但事实是，R 在这些工作中表现得非常出色。ggplot2 包是许多顶级信息设计师的首选工具。全球的用户已经利用 R 的自动化报告功能使他们的工作变得更加高效。R 不仅仅是替代其他工具，它能够*更好地*执行你现在可能已经在做的任务，比如生成报告和表格。

## 本书适合谁阅读

无论你的背景如何，使用 R 都能改变你的工作方式。如果你是一个当前正在使用 R 的用户，渴望探索其在可视化和沟通方面的应用，或者你是一个尚未使用 R 的用户，正在考虑 R 是否适合你，那么这本书适合你。我写《R for the Rest of Us》这本书时，力求无论你是否写过 R 代码，都能轻松理解。但即使你已经编写过完整的 R 程序，本书也能帮助你学习许多新技巧，让你的技能更上一层楼。

R 是任何从事数据工作的人都能受益的强大工具。也许你是一名研究人员，正在寻找一种新的方式来分享你的研究成果。也许你是一名记者，想更高效地分析公共数据。或者你是一名数据分析师，厌倦了在昂贵的专有工具中工作。如果你需要处理数据，R 将为你提供价值。

## 本书介绍

每一章都专注于 R 语言的一个应用，并包括了实际 R 项目的示例，这些项目采用了本书所涉及的技术。我将深入分析项目代码，逐步讲解程序的工作原理，并建议如何在示例基础上进一步拓展。本书分为三部分，如下所示。

在第一部分中，你将学习如何使用 R 进行数据可视化。

**第一章: R 编程速成课程**  介绍了 RStudio 编程环境和理解本书其余内容所需的 R 基础语法。

**第二章: 数据可视化原则**  本章分析了《Scientific American》为美国干旱状况制作的可视化内容。在这个过程中，本章介绍了 ggplot2 数据可视化包，并阐述了帮助你制作高质量图形的重要原则。

**第三章: 自定义数据可视化主题**  本章介绍了 BBC 的记者如何为 ggplot2 数据可视化包制作一个自定义主题。随着本章内容的展开，你将学习如何制作自己的主题。

**第四章: 地图与地理空间数据**  探索如何使用简单特征数据在 R 中制作地图的过程。你将学习如何编写制图代码、查找地理空间数据、选择适当的投影，并应用数据可视化原则使你的地图更具吸引力。

**第五章: 设计有效的表格**  本章将展示如何使用 gt 包在 R 中制作高质量的表格。在 R 表格专家 Tom Mock 的指导下，你将学习如何遵循设计原则，呈现你的表格数据。

第二部分聚焦于如何使用 R Markdown 高效地进行沟通。你将学习如何将第一部分中讨论的可视化内容整合到报告、幻灯片演示和完全通过 R 代码生成的静态网站中。

**第六章：R Markdown 报告** 介绍了 R Markdown，一种可以生成专业报告的 R 工具。本章涵盖了 R Markdown 文档的结构，展示了如何使用内联代码在数据值发生变化时自动更新报告文本，并讨论了该工具的多种导出选项。

**第七章：参数化报告** 介绍了使用 R Markdown 的一个优势：使用名为*参数化报告*的技术，同时生成多个报告。你将看到城市研究所的工作人员如何利用 R 为美国 50 个州生成财政简报。在这个过程中，你将了解参数化报告的工作原理，以及如何使用它。

**第八章：幻灯片演示** 解释了如何使用 R Markdown 和 xaringan 包制作幻灯片。你将学习如何制作自己的演示文稿，调整内容以适应幻灯片，并为幻灯片添加特效。

**第九章：网站** 展示了如何使用 R Markdown 和 distill 包创建你自己的网站。通过研究关于纽约州韦斯特切斯特县 COVID-19 病例率的网站，你将了解如何创建网站页面，如何通过 R 包添加互动性，以及如何通过多种方式部署你的网站。

**第十章：Quarto** 解释了如何使用 Quarto，R Markdown 的下一代版本。你将学习如何使用 Quarto 来完成以前使用 R Markdown 进行的所有项目（报告、参数化报告、幻灯片演示和网站）。

第三部分专注于如何使用 R 自动化工作并与他人共享。

**第十一章：自动访问在线数据** 探讨了两个 R 包，允许你自动从互联网导入数据：googlesheets4 用于处理 Google Sheets，tidycensus 用于处理美国人口普查局数据。你将学习这些包如何工作，以及如何使用它们自动化数据访问过程。

**第十二章：创建函数和包** 展示了如何创建自己的函数和包并与他人共享，这是 R 的一个主要优势。将自定义函数打包成一个包，可以让其他 R 用户简化工作，就像你在阅读 R 开发者为莫菲特癌症中心的研究人员构建的包时所了解到的那样。

本书结束时，你应该能够使用 R 完成各种非统计任务。你将知道如何有效地可视化数据，并通过地图和表格传达你的发现。你将能够将结果整合到报告中，使用 R Markdown 高效地生成幻灯片演示和网站。你还将理解如何使用其他人开发的包或你自己开发的包来自动化许多繁琐的任务。让我们开始吧！
