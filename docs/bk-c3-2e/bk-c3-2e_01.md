## 1

**介绍 CSS3**

![Image](img/common-01.jpg)

在第一章中，我将介绍本书中使用的代码约定，并讨论一些 CSS3 独有的语法，但在进入这些内容之前，让我先讲讲 CSS3 的历史。显然，你不需要了解它的历史就能使用 CSS3，但我认为了解一些关于当前 CSS3 状况的背景信息是很重要的。

CSS3 是一个不断变化的规范。规范中的一些部分被认为是稳定的，并且在现代浏览器中得到了良好的实现；其他部分应该被视为实验性的，已部分实现但程度不一；还有一些部分仍然是理论提案，根本没有实现。一些浏览器创建了自己的 CSS 属性，这些属性在任何 CSS3 规范中都没有描述，或许永远不会被描述。

所有这些意味着，了解标准化过程是如何工作的，以及每个新属性的实现级别，对于理解如何在现在和未来的代码中使用 CSS3 是至关重要的。

### 什么是 CSS3 以及它是如何诞生的

首先，我想讨论一下什么是 CSS3——以及它不是——以及它的形式。W3C 对 CSS3 的处理方式与对 CSS2 的处理方式大相径庭，因此这个概述应该能帮助你理解如何以及何时使用 CSS3，并且为什么它在不同浏览器中的实现如此多样。

#### *CSS3 的简要历史*

CSS 的最后一个主要版本是 CSS2.1，这是对最初于 1997 年发布的 CSS2 规范的修订版。尽管自那时以来一直在进行开发和审查，但许多人会惊讶地发现，直到 2011 年，CSS2 才成为 W3C 的“正式”推荐标准。（稍后我会详细讲解推荐过程。）更令人惊讶的是，2009 年发布的 Internet Explorer 8（IE8）号称是第一个完整支持 CSS2.1 规范的浏览器。

在过去几年中，关于新修订版——CSS3 的讨论愈发增多。我说是“新”，但实际上，CSS3 的工作始于 1998 年，也就是 CSS2 发布的次年。然而，浏览器对 CSS2 的实现一直令人沮丧地不一致，以至于 W3C 决定暂停所有新版本的工作，转而改为开发 CSS2.1，标准化现实中 CSS 的实现方式。2005 年，所有 CSS3 模块被重新归为工作草案状态，编辑和审查过程重新开始。

多年来，Internet Explorer 主导了不断扩展的互联网用户市场，并且没有表现出任何想要实现 CSS3 的迹象。然而，在过去十年左右，出现了一系列新的浏览器来竞争用户，这种选择的多样性导致了功能上的军备竞赛。而 CSS3 正是这一竞赛的受益者之一。每个浏览器都希望为开发者和用户提供最新的网络技术，而随着 CSS3 规范大部分已经编写完成，实现甚至添加新功能就变得不言而喻。

所以今天我们已经来到了这里，CSS3 规范正在积极开发中，各种浏览器正在实现它，广大开发者社区正在使用它、研究它并撰写相关文章。这是一个健康的局面，也是几年前我们无法预见到的情况。

#### *CSS3 是模块化的*

为每个基于标记的文档创建默认的样式语言是一项巨大的工作，W3C 意识到这将需要许多年才能完成。W3C 成员意识到，在考虑和讨论一些更为深奥的特性时，他们不想耽误一些更加明显、需求较高的功能，因此决定将 CSS3 拆分为多个模块。每个模块可以由不同的作者以不同的速度进行工作，实施和推荐过程——我稍后会讨论——可以错开进行。

这就是为什么，不是有一个单一的、庞大的 CSS3 规范文档，而是有 CSS3 基础用户界面模块、选择器第 3 级、媒体查询等等。这些模块中有些是 CSS2.1 的修订版本，有些是新创建的，但都属于 CSS3 的范畴。

我觉得让人烦恼的少数事情之一（我是个随和的人）是，许多博客上会有人抱怨：“我想使用 CSS3，但它需要几年才能准备好。”这简直是胡说八道；一些 CSS3 模块在所有现代浏览器中已经有相当稳定的实现，更多的模块也只需要几个月就能投入使用。如果你想等到所有模块在每个浏览器中都 100%实现，你将永远在等待。

所以 CSS3 已经到来了，其中一些已经可以立即使用——你只需要小心使用它。

#### *没有 CSS3*

好吧，我意识到这句话有点挑衅性，但从技术上讲它是正确的。随着 CSS 变得模块化，每个模块都会被指定一个级别数字，以标明它已经经历了多少次修订。一些成熟的模块，比如选择器，已经达到了第 4 级；本书中涉及的许多模块，比如字体，达到了第 3 级；而一些非常新的模块，比如 Flexbox，只有第 1 级，或者可能正进入第 2 级。

这意味着 CSS 是一个活标准：正如我之前提到的，不再会有单一的版本发布；每个模块将以自己的节奏推进；并且随着新功能的范围确定，新模块将不断加入。CSS3 仅仅是一个便捷的简写，表示“自 CSS2.1 以来开发的 CSS 特性。”CSS4 永远不会存在。最终，版本编号将不再使用，我们将只有 CSS，并且不同模块会有不同的级别。

但是让我们不要气馁！我将在本书中继续使用上文所定义的 CSS3 这个术语，作为新 CSS 特性的便捷简写。这种标签有助于理解，并且意味着我不需要更改本书的标题！

### 模块状态和推荐过程

当我在本书中讨论各个模块时，我有时会提到该模块的状态。状态由 W3C 设定，表示模块在推荐过程中所处的进度；但请注意，状态*并不*一定表示某个模块在任何浏览器中的实现程度。

当一个提议文档首次被接受为 CSS3 的一部分时，它的状态会被指定为*工作草案（Working Draft）*。这个状态意味着文档已经发布，现在可以供社区审查——在此情况下，社区指的是浏览器厂商、工作组和其他相关方。文档可能会作为工作草案停留很长时间，经过多次修订，并不是所有文档都会通过这一阶段，且文档可能会多次返回此状态。

在文档从工作草案（Working Draft）进入下一个阶段之前，它的状态会变为*最后通牒（Last Call）*，这意味着审查期即将结束，通常也表明文档准备好进入下一个阶段。

下一个阶段是*候选推荐（Candidate Recommendation）*，这意味着 W3C 认为该文档是合理的，最新的审查没有发现重大问题，并且所有技术要求都已得到满足。此时，浏览器厂商可以开始在浏览器中实现文档中的属性，以收集真实世界的反馈。

当两个或更多浏览器以相同的方式实现了某些属性，且没有出现严重的技术问题时，文档可能会进展为*提议推荐（Proposed Recommendation）*状态。这个状态意味着该提案已经成熟并实现，准备接受 W3C 顾问委员会的批准。一旦获得批准，提案就会成为*推荐（Recommendation）*。

重申一下我之前简要提到的内容，推荐过程和实现过程并不总是以相同的方式进行。一个模块可以在所有浏览器中得到良好实现，但仍然保持工作草案状态——例如，我写这本书时，过渡（Transitions）模块（第十四章）正是这一状态。相反，一个模块可能处于候选推荐状态，但实现仅限于部分浏览器——例如，CSS 形状（第十九章）目前正符合这一描述。

因此，我在编写这本书时，按照实现的顺序而非推荐状态的顺序进行排列。早期章节讨论了在所有浏览器中完全实现的特性（或者至少在本书发布时应当实现）；后续章节讨论了仅在某些浏览器中实现的特性——通常带有浏览器特定的前缀；而书的后面章节则涉及属性的潜在、猜测性或部分实现。

### 介绍语法

在介绍和解释完毕后，让我们进入 CSS3 的核心内容。整本书中，我会使用一种特定的语法约定来展示每一条新的规则和属性，格式大致如下：

```
*E* { property: *value*; }
```

在这个代码示例中，选择器用*E*表示。当然，在 HTML 中并不存在这个选择器；我只是用它来表示选择器不重要；这里可以使用任何选择器。

接下来是属性本身；在这个例子中，我使用了一个虚构的属性，称为`property`。接下来是该属性的值。对此，我使用了一个斜体别名来表示值，在这种情况下我称其为`*value*`。

如果一个属性接受多个值，我会列出每个值，并为其指定一个独特的别名。所以一个需要三个值的新属性可能会这样定义：

```
*E* { property: *first second third*; }
```

话虽如此，假设我们有一个名为`monkeys`的新属性（我一直想要一个`monkeys`属性），它只接受一个单一值。使用本书的语法，我会这样引入它：

```
*E* { monkeys: *value*; }
```

当我提供一个实际示例时，我可能会用一个有效的值来展示——比如一个数字值——像这样：

```
*E* { monkeys: 12; }
```

### 厂商前缀

当一个模块仍在积极评审中时，就像 CSS3 的许多部分一样，很多内容可能会发生变化；一个属性的语法可能会被修改，或者一个属性可能会被完全删除。有时，草案本身的措辞甚至有些模糊，且存在一定的解释空间。

同时，浏览器需要实现这些功能，以便我们能看到它们在实际中的效果。但如果两个不同的浏览器实现了相同的属性，却对其解释不一致，可能会出现哪些困难呢？你的代码结果可能会在每个浏览器中显得不同——甚至可能是极为不同的。为了防止这种情况的发生，每个浏览器厂商开始在实验性属性的前面加上一个短代码作为前缀。假设我们梦寐以求的`monkeys`属性已经在一个规范中新定义，所有主要的浏览器厂商都决定实现它，看看它如何工作。在这种情况下，你会使用以下代码：

```
E {
    -moz-monkeys: value; /* Firefox */
    -ms-monkeys: value; /* Internet Explorer */
    -webkit-monkeys: value; /* Chrome/Safari */
}
```

重复的次数可能看起来有些不必要，但重复是为了我们自己的好处；你最不希望的事情就是所有浏览器对`monkeys`属性的实现各不相同，导致完全的混乱。

尽管出于好意，使用厂商前缀却导致了许多问题——开发人员在生产网站中使用了它们，但在浏览器实现更改后没有及时移除它们。这反过来意味着浏览器厂商不得不永远支持实验性功能，以避免使用这些功能的网站出现崩溃。因此，Chrome 和 Firefox 现在正逐渐放弃使用前缀属性，而是更倾向于实现新的功能，这些功能默认是禁用的，必须由开发人员主动启用，直到它们稳定到足以广泛使用为止。话虽如此，仍然有很多带前缀的属性存在，我会在本书中指出何时必须使用它们。

### 开始吧

这些应该是你开始阅读本书所需要的所有内容——当然，除了好奇心。我需要在 CSS3 上覆盖很多内容，所以我会比较快速地进行讲解，但每一章都应该能为你提供必要的知识，让你能够创建自己的测试、演示和网站，充分利用 CSS3 提供的灵活性和丰富的功能。

我们将从其中一个最简单的——同时也是最具颠覆性（而且我指的是正面的颠覆）——新特性开始：媒体查询。
