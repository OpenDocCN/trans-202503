## 前言

![Image](img/com.jpg)

我们写这本书的目标是提供一个资源，介绍 Ghidra 给当前和未来的逆向工程师。在熟练的逆向工程师手中，Ghidra 可以简化分析过程，并允许用户定制和扩展其功能，以满足个人需求并改善工作流程。Ghidra 对新手逆向工程师也非常友好，尤其是它内置的反编译器，可以帮助他们更清楚地理解高级语言与反汇编清单之间的关系，尤其是在他们开始探索二进制分析的世界时。

编写关于 Ghidra 的书籍是一个具有挑战性的任务。Ghidra 是一个复杂的开源逆向工程工具套件，持续不断地在发展中。我们的文字描述的是一个不断变化的目标，因为 Ghidra 社区在不断改进和扩展其功能。和许多新的开源项目一样，Ghidra 以一系列快速演化的版本开始了它的公开历程。在撰写本书时，主要目标之一是确保随着 Ghidra 的发展，本书的内容能继续为读者提供广泛而深入的知识基础，以便他们能够理解并有效利用当前和未来的 Ghidra 版本，来应对他们的逆向工程挑战。我们尽可能使本书保持与版本无关。幸运的是，Ghidra 的新版本有详细的文档说明，列出了变更内容，提供了版本特定的指导，以防你在使用过程中遇到与书中内容的差异。

### 关于本书

本书是关于 Ghidra 的第一本全面书籍。它旨在成为一本全方位的逆向工程资源，涵盖了 Ghidra 的各个方面。它提供了介绍性内容，帮助新手进入逆向工程领域，提供了高级内容，扩展了经验丰富的逆向工程师的世界观，并提供了例子，供新手和资深 Ghidra 开发者一起继续扩展 Ghidra 的强大功能，并成为 Ghidra 社区的贡献者。

### 谁应该阅读本书？

本书面向有志和经验丰富的软件逆向工程师。如果你没有逆向工程经验，也没关系，因为前几章提供了必要的背景材料，介绍了逆向工程，并使你能够使用 Ghidra 探索和分析二进制文件。经验丰富的逆向工程师如果想将 Ghidra 添加到他们的工具包中，可能会选择快速浏览前两部分，以便对 Ghidra 有一个基本的了解，然后跳到他们感兴趣的具体章节。经验丰富的 Ghidra 用户和开发者可能会选择集中精力阅读后面的章节，以便他们能够创建新的 Ghidra 扩展，并运用他们的经验和知识，为 Ghidra 项目贡献新内容。

### 本书内容是什么？

本书分为五部分。第一部分介绍反汇编、逆向工程以及 Ghidra 项目。第二部分涵盖基本的 Ghidra 使用。第三部分展示了如何定制和自动化 Ghidra，使其更好地为你服务。第四部分深入解释了 Ghidra 模块的具体类型和相关概念。第五部分展示了 Ghidra 在逆向工程师可能遇到的实际应用场景中的应用。

#### *第一部分：简介*

**第一章：反汇编简介**

本章是介绍性章节，将带你了解反汇编的理论与实践，并讨论两种常见反汇编算法的优缺点。

**第二章：反汇编与逆向工具**

本章讨论了用于逆向工程和反汇编的主要工具类别。

**第三章：认识 Ghidra**

在这里，你将认识 Ghidra，了解它的起源，以及如何获得并开始使用这个免费的开源工具套件。

#### *第二部分：基本的 Ghidra 使用*

**第四章：开始使用 Ghidra**

本章将开始你的 Ghidra 之旅。你将首次看到 Ghidra 的实际操作，创建一个项目，分析文件，并开始了解 Ghidra 的图形用户界面（GUI）。

**第五章：Ghidra 数据展示**

在这里，你将首次接触到 CodeBrowser，这是 Ghidra 用于文件分析的主要工具。你还将探索 CodeBrowser 的主要显示窗口。

**第六章：理解 Ghidra 反汇编**

本章探讨了理解和导航 Ghidra 反汇编中基本概念的内容。

**第七章：反汇编操作**

本章中，你将学习如何补充 Ghidra 的分析并操作 Ghidra 的反汇编作为自己分析过程的一部分。

**第八章：数据类型和数据结构**

在本章中，你将学习如何操作和定义在编译程序中发现的简单和复杂数据结构。

**第九章：交叉引用**

本章详细介绍了交叉引用，如何支持图形化显示，以及它们在理解程序行为中的关键作用。

**第十章：图形**

本章介绍了 Ghidra 的图形功能以及如何将图形作为二进制分析工具使用。

#### *第三部分：让 Ghidra 为你服务*

**第十一章：协作式 SRE**

本章介绍了 Ghidra 中的一个独特功能——将 Ghidra 作为协作工具使用。你将学习如何配置 Ghidra 服务器，并与其他分析员共享项目。

**第十二章：定制 Ghidra**

在这里，你将开始看到如何通过配置项目和工具来定制 Ghidra，以支持你个人的分析工作流程。

**第十三章：扩展 Ghidra 的世界观**

本章教你如何生成和应用库签名及其他专用内容，以便 Ghidra 识别新的二进制结构。

**第十四章：基础 Ghidra 脚本**

在本章中，你将接触到 Ghidra 的基本脚本能力，包括使用 Ghidra 内联编辑器编写 Python 和 Java 脚本。

**第十五章：Eclipse 与 GhidraDev**

本章将通过将 Eclipse 集成到 Ghidra 中，提升你的 Ghidra 脚本水平，并探索这一组合提供的强大脚本功能，包括构建新分析器的实际示例。

**第十六章：Ghidra 无头模式**

你将学习如何在无头模式下使用 Ghidra，在这种模式下不需要图形界面。你会迅速理解这种模式在常见的大规模重复任务中的优势。

#### *第 IV 部分：深入探讨*

**第十七章：Ghidra 加载器**

在本章中，你将深入了解 Ghidra 如何导入和加载文件。你将有机会构建新的加载器，以处理之前无法识别的文件类型。

**第十八章：Ghidra 处理器**

本章介绍了 Ghidra 的 SLEIGH 语言，用于定义处理器架构。你将探讨如何向 Ghidra 添加新的处理器和指令。

**第十九章：Ghidra 反编译器**

本章将深入探讨 Ghidra 最受欢迎的功能之一：Ghidra 反编译器。你将了解它在幕后是如何工作的，以及它如何为你的分析过程提供帮助。

**第二十章：编译器变种**

本章帮助你理解使用不同编译器和面向不同平台编译的代码可能出现的变化。

#### *第 V 部分：实际应用*

**第二十一章：混淆代码分析**

你将学习如何使用 Ghidra 分析静态上下文中的混淆代码，而不需要执行代码。

**第二十二章：二进制修补**

本章教你一些方法，使用 Ghidra 在分析过程中修补二进制文件，包括在 Ghidra 内部修补以及创建新的修补版本的原始二进制文件。

**第二十三章: 二进制差异与版本跟踪**

本章提供了 Ghidra 功能的概述，介绍了如何识别两个二进制文件之间的差异，以及 Ghidra 的高级版本跟踪功能的简要介绍。

**附录: IDA 用户的 Ghidra**

如果你是经验丰富的 IDA 用户，本附录将为你提供将 IDA 术语和用法映射到 Ghidra 中类似功能的技巧和窍门。

**注意**

*访问配套网站*， [`nostarch.com/GhidraBook/`](https://nostarch.com/GhidraBook/) *和* [`ghidrabook.com/`](https://ghidrabook.com/)， *以访问本书中的代码列表。*
