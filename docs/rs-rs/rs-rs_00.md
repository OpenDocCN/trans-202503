# 前言

![](img/chapterart.png)

在任何语言中，入门教材教授的内容和你通过多年的实践经验积累的知识之间，总是存在着巨大的差距。随着时间的推移，你会逐渐熟悉各种习惯用语，建立起更好的核心概念的思维模型，了解哪些设计和模式有效，哪些无效，并发现周边生态中的有用库和工具。综上所述，这些经验使你能够在更短的时间内编写出更好的代码。

本书旨在将我多年来编写 Rust 代码的经验浓缩成一本易于消化的资源。*Rust for Rustaceans* 是在 *The Rust Programming Language*（“Rust 书籍”）的基础上继续深入的内容，尽管它非常适合任何希望超越基础知识的 Rust 程序员，无论你在哪里学习这门技术。本书深入探讨了像是不安全代码、特性系统、`no_std` 代码和宏等概念，还涉及了新的领域，如异步 I/O、测试、嵌入式开发和人体工程学的 API 设计。我旨在解释并解开这些更高级且强大的 Rust 特性的神秘面纱，帮助你构建更快、更符合人体工学且更健壮的应用程序。

## 本书内容

本书既是一本指南，也是一本参考书。各章内容基本独立，因此你可以直接跳到特别感兴趣的（或当前令你头疼的）主题，或者从头到尾阅读，获得更全面的体验。话虽如此，我还是建议你从第一章和第二章开始阅读，因为它们为后续章节和你日常 Rust 开发中会遇到的许多主题奠定了基础。以下是每一章内容的简要概述：

1.  第一章，*基础*，对 Rust 中的基本概念进行了更深入、更全面的描述，包括变量、内存、所有权、借用和生命周期等，你需要熟悉这些内容才能继续阅读本书的其他部分。

1.  第二章，*类型*，同样提供了关于 Rust 类型和特性的更详尽的解释，包括编译器如何推理它们、它们的特性和限制，以及许多高级应用。

1.  第三章，*设计接口*，讨论如何设计直观、灵活且能防止误用的 API，包括如何命名事物、如何利用类型系统来强制执行 API 合约，以及何时使用泛型与特性对象。

1.  第四章，*错误处理*，探讨了两种主要的错误类型（枚举型和不透明型），何时使用每种错误类型，以及如何定义、构造、传播和处理这些错误。

1.  第五章，*项目结构*，聚焦于 Rust 项目中非代码部分，如 Cargo 元数据和配置、crate 特性以及版本控制。

1.  第六章，*测试*，详细讲解了标准 Rust 测试工具的工作原理，并介绍了一些超越标准单元测试和集成测试的测试工具和技术，如模糊测试和性能测试。

1.  第七章，*宏*，介绍了声明式宏和过程式宏，包括它们的编写方法、用途以及一些陷阱。

1.  第八章，*异步编程*，介绍了同步与异步接口的区别，然后深入探讨了 Rust 中如何表示异步性，既包括低层次的`Future`和`Pin`，也包括高层次的`async`和`await`。本章还解释了异步执行器的角色，以及它如何让整个异步机制协同工作。

1.  第九章，*不安全代码*，解释了`unsafe`关键字所解锁的强大能力，以及伴随而来的巨大责任。你将了解不安全代码中的常见陷阱，并学会使用一些工具和技术来降低编写不正确不安全代码的风险。

1.  第十章，*并发（与并行）*，探讨了 Rust 中并发的表现形式，以及为什么在正确性和性能上做到并发编程是如此困难。它讲解了并发和异步的关系（但并非完全相同），当你更接近硬件时并发是如何工作的，以及如何保持理智，尽量编写正确的并发程序。

1.  第十一章，*外部函数接口*，讲解了如何让 Rust 与其他语言良好合作，以及像`extern`关键字这样的 FFI 原语到底是做什么的。

1.  第十二章，*没有标准库的 Rust*，讲述了在没有完整标准库的情况下使用 Rust 的情况，例如在嵌入式设备或其他受限平台上，这些地方只提供`core`和`alloc`模块。

1.  第十三章，*Rust 生态系统*，并没有涵盖某个特定的 Rust 主题，而是旨在提供关于如何在 Rust 生态系统中工作的广泛指导。它包含了常见设计模式的描述、关于保持语言更新和最佳实践的建议、关于有用工具的技巧以及我多年来积累的其他有用小知识，这些内容在任何单一地方都没有详细描述。

本书有一个网站，[`rust-for-rustaceans.com`](https://rust-for-rustaceans.com)，提供书中的资源链接、未来的勘误等信息。你还可以在本书的页面上找到相关信息，网址是[`nostarch.com/rust-rustaceans/`](https://nostarch.com/rust-rustaceans/)。

现在，所有的内容已经讲完，剩下的只有一件事要做：

```
fn main() {
```
