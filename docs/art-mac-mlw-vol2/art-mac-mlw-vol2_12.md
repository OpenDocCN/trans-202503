

# 第三部分 工具开发



你可以把 第一部分 和 第二部分 中涵盖的内容看作是一个更大难题的组成部分。例如，第七章展示了你可以利用 *NetworkExtension* 框架来检测尝试访问网络的新进程，但要判断一个进程是恶意软件还是无害的，你可能需要回到 第一部分 中讨论的主题，包括提取其进程参数（第一章）、提取其代码签名信息（第三章）以及检查进程是否持久化（第五章）。你甚至可能需要解析其 Mach-O 二进制文件以查找异常（第二章）。

现在，我已经详细介绍了所有这些方法，接下来是将它们整合起来的时候了。在 第三部分，我将介绍 Objective-See 工具的设计和内部结构，这些工具提供强大的基于启发式的恶意软件检测能力。这些工具是免费的开源工具，且有着检测复杂恶意软件以及前所未见威胁的记录。

第三部分首先聚焦于能够实时枚举和检测持久性恶意软件的工具（KnockKnock 和 BlockBlock）。然后，我将通过展示如何构建一个能够检测恶意软件的工具，来讨论 OverSight，这种恶意软件悄悄访问麦克风或摄像头来监视用户。最后，我将详细介绍如何构建一个完整的 DNS 监控器，能够检测和阻止试图访问远程域名的恶意软件。在讨论这些工具的内部结构和构建时，我将提到它们可以检测到的现实世界中 macOS 恶意软件的例子。

测试所有的安全措施，看看它们如何应对各种现实世界中的威胁，这一点至关重要。因此，我将在书的结尾通过将我们的工具和检测方法与最近针对 macOS 系统的威胁进行对比，来做一个总结。究竟哪种方法会获胜呢？

如果你每章都下载相关工具的源代码，你将从本书这一部分中获得最大的收益。特别需要注意的是，有些章节出于简洁考虑，省略了部分代码。

本部分提到的所有工具都可以在 Objective-See 的 GitHub 仓库中找到：[*https://<wbr>github<wbr>.com<wbr>/objective<wbr>-see*](https://github.com/objective-see)。如果你想自己构建这些工具，请注意，你需要使用自己的 Apple Developer ID，并且对于需要授权的工具，还需要使用你自己的配置文件。
