

# INDEX



+   A

+   活动监视器实用工具，8，30–31，33–34，46

+   addObserver:selector:name:object: 方法，286–287

+   持久性高级威胁（APTs），13–14，104–105。*另见* persistence

+   AF 套接字，105

+   Alchimist 攻击框架，103

+   AMFI。*参见* Apple Mobile File Integrity

+   安全分析恶意软件，xxvii–xxviii

+   *锚点苹果通用*要求，94

+   *锚点苹果*要求，94，96–97

+   应用程序 ID，注册，254–255

+   苹果文件系统（APFS），xxviii

+   苹果移动文件完整性（AMFI），181，254

+   禁用，xxvii，160，181

+   权限和，xxvii

+   应用程序服务 API，17–19

+   APTs（持久性高级威胁），13–14，104–105。*另见* persistence

+   ARC（自动引用计数），18，211

+   进程参数，9–13，197–199

+   ARM 二进制文件，32

+   *Mac 恶意软件的艺术*，第 1 卷（Wardle），xxv

+   音频监控

+   Oversight 工具，282–285

+   Shazam 小部件，313–315

+   审计令牌，5–6

+   端点安全进程监视器，192

+   静音反转通过，210

+   通过获取代码对象引用，95–96

+   XPC 和，266–268

+   授权事件，端点安全，213–222

+   阻止后台任务管理绕过，219–222

+   检查二进制文件来源，217–219

+   会议消息截止日期，215–217

+   起源，183

+   订阅，213–215

+   自动引用计数（ARC），18，211

+   桥接，80

+   AutoRuns 工具，233

+   AVFoundationAudioObjectAddProperty ListenerBlock API，282

+   *AVFoundation* 框架，58

+   添加属性监听器，283–284

+   设备枚举，281

+   提取属性值，285

+   属性监听器块，282

+   删除属性监听器，294

+   B

+   后台任务管理 (BTM)，2，123–136

+   访问元数据，134–135

+   BlockBlock 工具，261–265

+   阻止绕过，219–222

+   反序列化，130–134

+   *DumpBTM* 项目，130–137

+   事件监控逻辑，263

+   查找数据库路径，130–131

+   识别恶意软件，135–136

+   initWithCoder: 方法，132–134

+   与数据库交互，124–127

+   ItemRecord 类，131–133

+   itemsByUserIdentifier 字典，131

+   KnockKnock 工具，241–242

+   序列化，126–127

+   sfltool 工具，127–130

+   基于行为的启发式方法。*另见* 基于启发式的检测方法

+   定义，xxii

+   假阳性，75

+   二进制文件。*另见* Mach-O 二进制文件

+   加密，70–71

+   打包的二进制文件，62–70

+   通用二进制文件，39–50

+   *黑镜*（电视节目），279

+   BlockBlock 工具，253–276

+   警报，257

+   后台任务管理，261–265

+   DazzleSpy 和，319

+   端点安全与，181

+   权限，254–256

+   启动守护进程，257–258

+   登录项，257

+   消息截止时间，216

+   公证模式，213

+   插件，258–261

+   3CX 供应链攻击，324–325

+   XPC，265–276

+   阻止 DNS 流量，307–310

+   关闭本地流，309

+   关闭远程流，309

+   从 A 记录中提取答案，308–309

+   名称错误，309

+   NXDOMAIN 响应，309–310

+   响应数据包，308

+   将 DNS 查询和回答保存到缓存，305

+   桥接，80

+   浏览器扩展，242–245

+   BTM。*另见* 后台任务管理

+   C

+   *CalendarFree.app*，10–13

+   回调逻辑，114–115

+   摄像头监控，285–286。*另见* Oversight 工具

+   网络摄像头，142，279–280

+   案例研究，313–326

+   DazzleSpy 恶意软件，315–319

+   Shazam，313–315

+   3CX 供应链攻击，319–326

+   证书授权链，80

+   CFBundleCopyExecutableArchitectures ForURL API，250

+   链式供应链攻击，320

+   *checkSignature* 项目，76，79，84，88，94–95

+   Chropex (ChromeLoader)，9

+   客户端

+   Endpoint Security，185，199–200

+   XPC，269–271

+   CloudMensis 恶意软件，40–41，44–49，52，54，56

+   代码签名，75–76

+   特定签名，81–82

+   Apple 对于的要求，xxvi–xxvii

+   定义，24

+   磁盘映像和，78–84

+   Endpoint Security 进程监视器，195–197

+   错误代码，97

+   假阳性和，75，96–97

+   恶意软件检测中的重要性，76–78

+   公证，77，82–84

+   硬盘上的 Mach-O 二进制文件和，93–95

+   包中的，84–93

+   撤销，77

+   运行进程和，95–96

+   XPC 和，268–271

+   codesign 工具，78–79，85，93，129，256

+   CoinMiner 恶意软件，8，33

+   CoinTicker 恶意软件，317

+   Coldroot 恶意软件，28–29，63

+   *com.apple.developer.endpoint-security.client* 权限，xxvii，180

+   com.apple.quarantine 扩展属性，316–317

+   *Contents/Library/SystemExtensions/* 目录，299，303

+   *CoreMediaIO* 框架，285–286

+   添加属性监听器，285

+   核心媒体 I/O 子系统，142，151–152，289–291

+   CPU 利用率，进程，35–36

+   计算 CPU 使用百分比，35–36

+   风味参数，35

+   流式日志消息，151

+   CreativeUpdate 恶意软件，79，84

+   Crisis 恶意软件，142，280，314

+   CrowdStrike，9，320

+   *CSCommon.h* 文件，97

+   D

+   DA* API，56–57

+   数据收集, 1–2. *另见* 代码签名; 网络状态和统计; 解析二进制文件; 进程

+   持久化, 119–137

+   背景任务管理, 123–136

+   DazzleSpy 恶意软件, 121–123

+   *DumpBTM* 项目, 130–137

+   *LaunchAgents* 目录, 121–123

+   WindTail 恶意软件, 120–121

+   DazzleSpy 恶意软件, 7, 23, 33, 127, 220

+   代码签名, 324

+   漏洞检测, 315–317

+   提取符号, 59–60, 62

+   网络访问, 319

+   持久化和, 121–123, 317–319

+   默认静音设置, 210

+   委托和委托方法

+   DNSMonitor, 301

+   网络监控, 168, 172

+   系统扩展, 161, 163

+   XPC, 266

+   依赖关系, 二进制

+   分析, 56–59

+   查找依赖路径, 54–56

+   打包器检测和, 63

+   反序列化, 130–134

+   检测启发式方法. *另见* 基于启发式的检测方法

+   设备连接和断开, 286–288

+   禁用

+   Apple 移动文件完整性, xxvii, 160, 181

+   系统完整性保护, xxvii, 160, 181

+   *DiskArbitration* 框架, 54, 56

+   磁盘映像

+   临时签名, 80

+   证书颁发机构链, 81

+   代码对象引用, 80–81

+   代码签名和, 78–84

+   提取代码签名信息, 79–82

+   手动验证签名, 78–79

+   公证状态, 82–84

+   静态代码引用, 80

+   详细输出, 79

+   dispatch_semaphore_wait API, 216

+   DNS 缓存转储, 304–307

+   DNSMonitor, 297–311

+   阻止 DNS 流量, 307–310

+   分类终端, 310

+   DNS 缓存转储, 304–307

+   域名注册商, 310

+   历史 DNS 记录, 310

+   进程间通信, 303–304

+   网络扩展, 298–303

+   打印 DNS 数据包到通用日志, 303–304

+   配置文件, 298–299

+   DNS 监控, 157–169

+   激活系统扩展, 160–161

+   识别责任进程, 168–169

+   *NetworkExtension* 框架, 159–160

+   解析 DNS 请求, 164–165

+   解析 DNS 响应, 165–168

+   编写系统扩展, 162–169

+   DNSProxyProvider 类, 303

+   Dock, 19, 301

+   *Documents* 目录

+   监控文件打开事件, 211–212

+   WindTail 恶意软件及, 227

+   域名注册商, 310

+   虚拟恶意软件, 102–103, 111, 117, 159, 169

+   *DumpBTM* 项目, 130–137

+   访问元数据, 134–135

+   反序列化文件, 131–134

+   查找数据库路径, 130–131

+   识别恶意项, 135–136

+   KnockKnock 工具及, 241

+   在你自己的代码中使用 DumpBTM, 136–137

+   *dyld* 缓存, 86–87, 145

+   *dyld-shared-cache-extractor* 工具, 87

+   dylib 劫持, 217, 249

+   dylib 插入, 246–248

+   dylib 代理, 249–252

+   E

+   Eleanor 恶意软件, 280

+   *Electron* 框架, 249

+   ElectroRAT, 8

+   加密二进制文件, 70–71

+   字节序, 41, 43, 50–51

+   终端, DNSMonitor, 310

+   终端安全, 179–203

+   授权事件, 213–222

+   客户端, 185

+   检测隔离属性的移除, 316

+   权限, 254–256

+   事件, 182–184

+   授权事件, 183, 213–222

+   事件处理, 185–190

+   静音反转, 209–212

+   静音, 206–212

+   打印文件打开的终端安全事件, 212

+   概念验证文件保护器, 223–228

+   文件监控, 200–203

+   处理块, 185

+   头文件, 182–183

+   静音反转, 209–212

+   静音事件，206–212

+   前提条件，191

+   进程监控，190–200

+   概念验证文件保护器，223–228

+   工作流，180–190

+   *EndpointSecurity.h* 头文件, 182

+   权限

+   申请，254

+   BlockBlock 工具，254–256

+   *com.apple.developer.endpoint-security .client*, xxvii，180

+   在 Xcode 中启用，255–256

+   配置文件，255

+   注册应用 ID，254–255

+   熵

+   加密二进制文件，70

+   打包的二进制文件，67–70

+   *enumerateProcesses* 项目，4。 *参见* 进程

+   环境信息，进程，19–24

+   将进程信息转换为字符串对象，22–23

+   创建共享内存对象，20

+   声明所需变量，20

+   提取全局数据，21

+   提取响应数据的大小，22

+   解析函数指针，21

+   跟踪进程 ID 回到启动项属性列表，23–24

+   e_ppid 成员，进程层级，14–15

+   错误代码，代码签名，97

+   *ESClient.h* 头文件，182

+   ES_EVENT_TYPE_AUTH_DELETEEXTATTR 事件，219

+   ES_EVENT_TYPE_AUTH_* 事件，201–202

+   ES_EVENT_TYPE_NOTIFY_BTM_LAUNCH_ITEM _ADD 事件，261–262

+   ES_EVENT_TYPE_NOTIFY_BTM_LAUNCH_ITEM _REMOVE 事件，261

+   ES_EVENT_TYPE_NOTIFY_CLOSE 事件，202

+   ES_EVENT_TYPE_NOTIFY_CREATE 事件，201

+   ES_EVENT_TYPE_NOTIFY_EXEC 事件，184–186，193–194，197–198，221

+   ES_EVENT_TYPE_NOTIFY_RENAME 事件，202

+   ES_EVENT_TYPE_NOTIFY_UNLINK 事件，202

+   es_invert_muting API，210

+   eslogger 工具，183–184，186

+   *ESMessage.h* 头文件，182，185，201

+   es_message_t 结构体，185–186，201，216

+   es_muted_paths_events API，210

+   es_mute_process API, 208

+   es_mute_process_events API，208

+   *ESPlayground* 项目，180–182，190，205，207，211–213，215，223，227

+   *ESTypes.h* 头文件，182，206，210，215

+   EvilQuest 恶意软件，79，84–85，93

+   可执行压缩程序，xxii，62–67

+   执行架构，进程，32–34

+   执行状态，进程，32

+   数据外泄，157，326

+   退出状态，端点安全进程监控，199

+   漏洞检测，315–317

+   F

+   错误警报，代码签名，75，96–97

+   大型二进制文件。*见* 通用二进制文件

+   文件监控

+   端点安全，200–203

+   3CX 供应链攻击，320–322

+   文件保护器，端点安全，223–228

+   允许所有文件访问，224–225

+   拒绝所有文件访问，225

+   提取进程路径和文件路径，225–226

+   授予平台和公证进程文件访问权限，226–227

+   文件工具，40

+   数据提供者过滤器，159，170–176

+   启用，170–171

+   查询流，173–174

+   运行监控，174–176

+   为其编写扩展，171–172

+   Finder，19，212，301

+   闪回恶意软件，246，248

+   FruitFly 恶意软件，xxii，142，279–280，314

+   完全限定域名（FQDN），164

+   G

+   Genieo 恶意软件，11

+   getaddrinfo API，110

+   GetProcessForPID API，17–19

+   H

+   HackingTeam 安装程序，70–71

+   处理程序块，端点安全，185

+   头文件，端点安全，182–183

+   基于启发式的检测方法。*另见* 代码签名；Objective-See 工具

+   代码签名和，76

+   CPU 使用率，35–36

+   检测混淆，62

+   其缺点，xxii

+   假阳性，xxii，75，96–97

+   文件监控，200

+   隐藏目录和，6–7

+   网络监控，174

+   保护用户主目录中的文件，225

+   层级，进程，13–19

+   Endpoint Security 进程监控，193

+   父级，14–17

+   使用应用程序服务 API 检索信息，17–19

+   历史 DNS 记录，310

+   Hopper，87，145

+   主机级数据收集，102

+   *如何在不感染的情况下逆向分析恶意软件*（Stokes），xxviii

+   I

+   *Info.plist* 文件

+   浏览器扩展，245–246

+   检查二进制文件来源，218

+   DNSMonitor，299–300，303

+   动态库插入，248

+   编写系统扩展，171

+   集成开发环境（IDE），xxvi

+   Intel 二进制文件，32

+   Internet Protocol（IP）套接字，107，109–110

+   进程间通信（IPC）

+   AF 套接字，105

+   DNSMonitor，303–304

+   XPC，265

+   隐形互联网项目（I2P），8

+   IPStorm 恶意软件，63，66，69，142

+   *iWebUpdate* 二进制文件，11，158，167–168

+   J

+   JSON

+   构建 JSON 格式的字符串，240

+   将对象属性转换为，238–240

+   KnockKnock 输出，247

+   K

+   KeRanger 恶意软件，7

+   KERN_PROCARGS2 值，11–12

+   KeySteal 恶意软件，86，93

+   kill 系统 API，32

+   kinfo_proc 结构体，进程层级，14–15

+   KnockKnock 工具，233–252

+   背景任务管理，241–242

+   浏览器扩展，242–245

+   使用构建已加载库列表，249

+   命令行选项，235

+   DazzleSpy 和，319

+   确定项目是否为二进制文件，250

+   dylib 劫持，249

+   dylib 插入，246–248

+   dylib 代理，249–252

+   枚举运行进程的依赖，251

+   ItemBase 类，238

+   持久项类型, 238–240

+   插件, 235–237, 240–252

+   正向检测/杀毒引擎, 240

+   system_profiler 方法, 247

+   用户界面, 234–235

+   kNStatSrcKeyRxBytes 键, 117

+   kNStatSrcKeyTxBytes 键, 117

+   kp_eproc 结构体, 进程层次结构, 14–15

+   kSecCodeInfoCertificates 键, 81–82

+   kSecCodeInfoFlags 键, 82

+   L

+   *LaunchAgents* 目录, 121–123

+   launchctl 工具, 19–20

+   启动守护进程, 121, 257–258。*另见* 持久性

+   Launch Services API, 243, 246

+   Lazarus APT 组, 13–14

+   LC_SYMTAB 加载命令, 60

+   叶子签名, 90

+   libproc API, 4

+   */Library/SystemExtensions/<UUID>/* 库, 303

+   监听器, XPC, 265–266

+   加载命令, Mach-O 二进制文件, 53

+   已加载的库

+   使用 KnockKnock 构建列表, 249

+   枚举, 24–28

+   *LoggingSupport* 框架, 145–146, 148, 152, 289

+   日志监控, 141–152

+   提取日志对象属性, 148–151

+   远程登录, 142

+   资源消耗, 151–152

+   流式日志数据, 146–148

+   TCC 机制, 142–143

+   统一日志系统, 143–146

+   网络摄像头访问, 142

+   lsof 工具, 30–31

+   LSSharedFileListCreate API, 120

+   LSSharedFileListInsertItemURL API, 120

+   LuLu 软件, 78–79, 84, 170, 307, 319, 326

+   M

+   Macho* API, 47–50

+   Mach-O 二进制文件

+   代码签名及, 93–95

+   提取依赖关系, 54–59

+   提取符号, 59–62

+   加载命令, 53

+   Mach-O 头部, 50–52

+   切片, 40, 43, 47–50

+   通用二进制文件, 39–50

+   mach_timebase_info API, 216

+   MacStealer 恶意软件, 209–210, 212, 225

+   恶意网络活动, 102–105

+   恶意软件清除工具 (MRT), 76–77

+   管理信息库 (MIB) 数组, 11

+   元数据, 访问, 134–135

+   麦克风, 282–285。*另见* 音频监控

+   Microsoft AutoRuns 工具, 233

+   Mokes 恶意软件, 57–58, 142, 280, 314

+   MRT (恶意软件清除工具), 76–77

+   静音反转, Endpoint Security, 209–212

+   审计令牌和, 210

+   默认静音设置和, 210

+   监控目录访问, 211–212

+   静音事件, Endpoint Security, 206–212

+   N

+   名称错误, DNS 流量, 309

+   名称, 进程, 8–9

+   NEDNSProxyManager 对象, 161–162

+   NEFilterFlow 对象, 172–174

+   NEFilterManager 对象, 170–171

+   NEFilterSocketFlow 对象, 174

+   NENetworkRule 对象, 172

+   netbottom 命令行工具, 112

+   Netiquette 工具, 104

+   nettop 工具, 112, 156

+   网络访问, DazzleSpy, 319

+   基于网络的数据收集, 102

+   网络扩展, DNSMonitor, 302–303

+   *NetworkExtension* 框架, xxiii, 111–117, 159–160, 297–301

+   激活, 159–160

+   DNS 监控, 157–169

+   过滤数据提供者, 169–175

+   识别责任进程, 168–169

+   方法, 163

+   前提条件, 159, 298

+   网络监控, 155–176

+   DNS 监控, 157–169

+   过滤数据提供者, 169–175

+   快照, 156–157

+   3CX 供应链攻击, 322–323

+   网络套接字, 106–111

+   网络状态和统计数据, 101–118。*另见* *NetworkStatistics* 框架

+   捕获, 105–111

+   提取网络套接字, 106–107

+   基于主机与基于网络的收集, 102

+   恶意网络活动, 102–105

+   检索进程文件描述符, 106

+   套接字详情, 107–111

+   *NetworkStatistics* 框架, 111–112

+   回调逻辑, 114–115

+   创建网络统计管理器, 113–114

+   kNStatSrcKeyRxBytes 键, 117

+   kNStatSrcKeyTxBytes 键, 117

+   链接到, 113

+   查询, 115

+   公证

+   检测, 77

+   磁盘镜像, 82–84

+   包, 91–92

+   通知事件, 183–184, 200–203

+   添加设备, 286–287

+   移除设备, 286–287

+   NSRunningApplication 对象, 8–9

+   NSTask API, 26

+   NStatManagerCreate API, 113

+   NStatManagerQueryAllSources 描述 API, 156–157

+   NSUserDefaults 类, 292

+   NSXPCConnection 类, 267

+   NSXPCListenerDelegate 协议, 265–266

+   NukeSped 恶意软件, 7

+   NX* API, 42–47

+   NXDOMAIN 响应, DNS 流量, 309–310

+   O

+   Objective-C 语言, xxvi, 59

+   提取日志对象属性, 148–151

+   performSelector: 方法, 134

+   私有类, 89

+   Objective-See 工具, xxiv, 231–232

+   BlockBlock 工具, 253–276

+   DNSMonitor, 297–311

+   KnockKnock 工具, 233–252

+   LuLu 软件, 78–79, 84, 170, 307, 319, 326

+   Oversight 工具, 280–295

+   TaskExplorer, 25

+   OceanLotus 恶意软件, 317

+   打开的文件, 28–31

+   lsof 工具, 30–31

+   proc_pidinfo API, 29–30

+   oRAT 恶意软件, 33, 63, 104–105

+   os_log_create API, 303

+   OSLogEventProxy 对象属性, 150–151

+   OSSystemExtensionRequest 类, 161

+   OSSystemExtensionRequestDelegate 协议, 161

+   otool 命令

+   确认代码准确性, 45

+   检测加密的二进制文件, 70

+   枚举网络连接, 112

+   查找依赖路径, 56

+   Mach-O 头部和, 52

+   逆向工程日志 API, 145

+   OverSight 工具, 280–295

+   Block 选项, 280

+   摄像头监控, 285–286

+   设备连接和断开, 286–288

+   禁用, 293–294

+   执行用户操作, 292–293

+   提取属性值, 285

+   过滤 cmio 和 coremedia 消息, 290

+   LogMonitor 类, 289–290

+   麦克风监控, 282–284

+   解析消息以检测负责进程, 291

+   谓词评估, 151–152

+   属性监听器, 281–286

+   负责进程识别, 288–291

+   示例工具, 288

+   脚本和, 291–293

+   停止, 293

+   P

+   *PackageKit* 框架, 86–89

+   包

+   访问框架函数, 88–89

+   代码签名和, 84–93

+   公证状态, 91–92

+   逆向工程 pkgutil 工具, 86–88

+   验证, 90–91

+   打包的二进制文件, 62–70

+   计算熵, 67–70

+   依赖关系, 63

+   区段和段名称, 63–67

+   符号, 63

+   压缩器（可执行压缩器）, xxii, 62–67

+   Palomino Labs, 105

+   Parallels, xxviii

+   父层级, 14–17

+   ParentPSN 键, 19

+   解析二进制文件

+   提取依赖关系, 54–59

+   提取符号, 59–62

+   加载命令, 53

+   Mach-O 二进制文件, 50

+   打包的二进制文件, 62–70

+   通用二进制文件, 39–50

+   路径, 进程, 6–8

+   已删除的二进制文件, 7–8

+   识别隐藏的文件和目录, 6–7

+   持久性, 119–137

+   后台任务管理, 123–136

+   BlockBlock, 258–264

+   DazzleSpy 恶意软件, 121–123, 317–319

+   *DumpBTM* 项目, 130–137

+   KnockKnock, 240–251

+   LSSharedFileListCreate API, 120

+   LSSharedFileListInsertItemURL API, 120

+   ProgramArguments 键, 122

+   RunAtLoad 键, 122–123

+   WindTail 恶意软件, 120–121

+   持久性枚举器。*参见* KnockKnock 工具

+   持久性监控器。*参见* BlockBlock 工具

+   持久性项类型, KnockKnock 工具, 238–240

+   pkgutil 工具, 78

+   包的公证, 91

+   逆向工程, 86–89

+   验证签名, 84–86

+   插件

+   BlockBlock 工具, 258–261

+   KnockKnock 工具, 235–237

+   基础扫描方法, 236

+   通过名称初始化, 237

+   基类插件方法, 236

+   基类插件的属性, 236

+   更新持久项的全局列表, 237

+   正检测/病毒引擎, 240

+   进程, 3–38

+   参数, 9–13

+   审计令牌, 5–6

+   代码签名和, 24, 95–96

+   CPU 使用率, 35–36

+   枚举, 4–5

+   环境信息, 19–24

+   执行架构, 32–34

+   执行状态, 32

+   已加载的库, 24–28

+   打开的文件, 28–31

+   路径, 6–8

+   进程层次结构, 13–19

+   启动时间, 34–35

+   验证名称, 8–9

+   进程文件描述符, 检索, 106

+   ProcessInformationCopyDictionary API, 18–19

+   进程监控, Endpoint Security, 190–200

+   参数, 197–199

+   审计令牌, 192

+   二进制架构, 194–195

+   代码签名, 195–197

+   退出状态, 199

+   提取进程信息, 192

+   提取进程对象, 191–192

+   层次结构, 193

+   进程路径, 192–193

+   脚本路径, 193–194

+   停止客户端, 199–200

+   订阅事件, 191

+   进程监控, 3CX 供应链攻击, 323–325

+   进程序列号, 17–19

+   procinfo 命令行选项, 19–20

+   proc_listallpids API, 4–5

+   proc_pid* API, 102, 105–107, 111

+   proc_pidinfo API, 29–30

+   PROC_PIDPATHINFO_MAXSIZE 常量, 6

+   proc_pid_rusage API, 35

+   ProgramArguments 键, 122

+   属性监听器, 281–286

+   音频监控, 282–285

+   摄像头监控, 285–286

+   配置文件

+   BlockBlock 工具, 255–256

+   DNSMonitor, 298–299

+   *NetworkExtension* 框架, 160

+   psi 结构, 108

+   Q

+   qtn_file_* API，218

+   R

+   勒索软件，7，120，139，200

+   被编辑的 WHOIS 数据，310

+   远程访问工具（RATs）

+   CoinMiner，8

+   ColdRoot，28–29，63

+   ElectroRAT，8

+   启用远程连接，271–272

+   remoteEndpoint 实例变量，173–174

+   远程登录，142

+   远程方法，XPC，275–276

+   request:actionForReplacingExtension:withExtension: 委托方法，161

+   request:didFailWithError: 委托方法，161

+   request:didFinishWithResult: 委托方法，161

+   requestNeedsUserApproval: 委托方法，161

+   资源，xxix

+   respondsToSelector: 方法，89

+   响应包，DNS 流量，308

+   responsibility_get_pid_responsible _for_pid API，16–17

+   负责任的过程识别，16–19，168–169，174，188–189，193，226，288–291

+   逆向工程

+   活动监视器工具，30

+   日志 API，145–146

+   pkgutil 工具，86–89

+   撤销，77

+   rShell 恶意软件，33

+   RunAtLoad 键，122–123

+   S

+   Safari 浏览器扩展，243–245

+   枚举，243

+   解析包含的输出，245

+   URLsForApplicationsToOpenURL: 方法，243

+   示例工具，288

+   SCDynamicStoreCopyConsoleUser API，211

+   脚本，193–194，291–293

+   SecAssessmentCreate API，83，94

+   SecAssessmentTicketLookup API，83，91–92

+   SecCodeCopyGuestWithAttributes API，95

+   SecCodeCopyPath API，96

+   SecCodeCopySigningInformation API，81

+   SecRequirementCreateWithString API，82

+   SecStaticCodeCheckValidity API，81–83，93–94，97

+   SecStaticCodeCreateWithPath API，80

+   段名和节名，打包的二进制文件，63–67

+   SecTranslocateIsTranslocatedURL API，217–218

+   自删除恶意软件，325

+   序列化，126–127

+   sfltool 工具, 127–130

+   Shazam, 313–315

+   Shlayer 恶意软件, 9, 213, 242

+   SIGUSR1 信号，DNS 流量, 305–306

+   SIP. *参见* 系统完整性保护

+   切片，Mach-O 二进制文件, 40, 43, 47–50

+   快照, xxviii, 101, 112, 115, 139, 155–157

+   soi_proto 结构，套接字, 108

+   Spotlight 服务, 206–207, 246

+   startSystemExtensionMode 方法, 162–163

+   启动时间，进程, 34–35

+   swap_* APIs, 43–44

+   Swift 语言, xxvi

+   符号，二进制

+   提取, 59–62

+   压缩的二进制文件, 63

+   sysctl API, 11, 15, 34

+   sysctlbyname API, 4

+   sysctlnametomib API, 34

+   系统扩展. *另见* *NetworkStatistics* 框架

+   激活, 160–161

+   权限, 298–300

+   确定责任进程, 168–169

+   前置条件, 160

+   写入, 162–169

+   系统完整性保护（SIP）, 254

+   禁用, xxvii, 160, 181

+   权限与, xxvii

+   在恢复模式下重新启用, xxviii

+   系统监控. *参见* 终端安全; 日志监控; 网络监控

+   系统偏好设置应用程序, 123–124

+   system_profiler, 247

+   T

+   TAOMM 仓库, xxv

+   TaskExplorer 工具, 25

+   TCC（透明性、同意与控制）机制, 142–143, 223, 292

+   TCP 协议

+   查询网络事件统计信息, 115

+   套接字, 105, 108

+   3CX 供应链攻击, 310, 319–326

+   BlockBlock 工具, 324–325

+   代码签名, 323–324

+   DNS 监控与, 158–159

+   外泄, 326

+   文件监控, 320–322

+   网络监控, 322–323

+   进程监控, 323–325

+   自删除, 325

+   转移, 217–218

+   传输层安全性 (TLS) 包, 105

+   U

+   UDP 协议

+   DNS 流量, 163

+   查询网络事件统计信息, 115

+   套接字, 105, 108

+   通用二进制文件, 39–50

+   fat_arch 结构, 41–47

+   FAT_CIGAM 值, 41, 43–44

+   fat_header 结构, 40–41, 43–47

+   检查, 40–42

+   Macho* API, 47–50

+   NX* API, 42–47

+   解析, 42

+   swap_* API, 43–44

+   通用日志子系统, 143–146

+   DNSMonitor, 303–304

+   手动接口交互, 144–145

+   监管工具和, 288–289

+   逆向工程日志 API, 145–146

+   URLsForApplicationsToOpenURL: 方法, 243

+   V

+   verifyReturningError: 方法, 90

+   虚拟机

+   安全地分析恶意软件, xxvii–xxviii

+   禁用 SIM 和 AMFI, 160

+   VirusTotal, 168, 234, 239–240, 242, 319

+   vmmap 工具, 24–26

+   VMware, xxviii

+   W

+   网络摄像头访问, 142. *另请参阅* 监管工具

+   WindTail 恶意软件, 95, 120–121, 227, 242

+   Wireshark, 127, 135, 158

+   工作流, 端点安全, 180–190

+   客户端, 185

+   事件处理, 185–190

+   感兴趣的事件, 182–184

+   处理程序块, 185

+   X

+   Xcode, xxvi, 255–256

+   XCSSET 恶意软件, 142, 223, 317

+   XPC, 265–275

+   授权客户端, 269–271

+   客户端要求, 270–271

+   委托, 266

+   提取审计令牌, 266–268

+   启动连接, 274

+   监听器, 265–266

+   方法, 272–274

+   协议, 271–273

+   远程连接, 271–272

+   远程方法, 275–276

+   验证客户端, 268–271

+   XProtect, 150, 183, 280

+   Y

+   Yort 恶意软件, 13–14

+   Z

+   僵尸进程, 32

+   ZuRu 恶意软件, 24–28, 58–59, 63
