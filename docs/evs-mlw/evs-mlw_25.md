<hgroup>

# <samp class="SANS_Dogma_OT_Bold_B_11">索引</samp>

</hgroup>

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">A</samp>

+   Abrams, Lawrence, 245

+   加速检查，121–122

+   访问令牌，253–254

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AddAtom</samp> 函数，209，424

+   地址空间布局随机化（ASLR），15–16，62–63

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AddVectoredExceptionHandler</samp> 函数，192，424

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AdjustTokenPrivileges</samp> 函数，269，424

+   管理员账户，249

+   Agent Tesla，xxiv

+   可警报状态，208

+   Al-Khaser，415–416

+   Allievi, Andrea, 436

+   替代数据流（ADS），307–309

+   Andriesse, Dennis, 436

+   反附加技术，167，180

+   反 Cuckoo，143

+   反调试，167

+   检查父进程，173

+   反制，181

+   在 Joe Sandbox 中，34

+   定时检查，171–172

+   反反汇编，151

+   反取证，289–290，306–317

+   反钩取，137–144，238

+   工具集，143–144

+   反恶意软件排除项，236

+   反恶意软件，224

+   基于云的沙盒，226

+   基于哈希的检测，225

+   基于启发式的检测，226

+   限制和挑战，226–227

+   基于签名的检测，225

+   反解包，383–385

+   杀毒软件（AV），224

+   Any.Run，20，437

+   APC（异步过程调用）注入，207–208

+   API。*参见* 应用程序编程接口

+   apihashes 插件，165

+   API 监视器，201–202，206–207。*另见* 跟踪 API 调用

+   应用程序日志，313

+   应用程序编程接口（API）。*另见* 钩取；Windows API

+   调用混淆，160–165

+   敲击，135

+   间接调用，161–163

+   跟踪调用，69–71

+   应用程序, 4

+   AppLocker, 221, 294

+   任意代码保护, 221

+   Pieter Arntz, 246

+   工件

+   文件系统, 234

+   隐藏, 306–312

+   操作系统, 75

+   进程, 233

+   注册表, 234

+   ASCII, 27

+   ASLR（地址空间布局随机化）, 15–16, 62–63

+   内存损坏, 15–16

+   *aspnet_compiler.exe*, 305

+   汇编代码

+   x64（64 位）, 44

+   x86（32 位）, 44

+   汇编指令

+   算术操作, 48–49

+   调用和返回操作, 50

+   跳转操作, 50

+   移动操作, 49

+   空操作, 51, 69

+   栈操作, 47–48

+   值比较, 49–50

+   华硕, xxii

+   异步过程调用（APC）注入, 207–208

+   AsyncRAT, xxiii

+   原子, 209

+   Autochk, 279–280

+   AV（杀毒）软件, 224

+   Ave Maria, 25

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">B</samp>

+   后台智能传输服务（BITS）, 299

+   反向链接（blink）, 9, 273–274

+   银行木马, xxiii

+   裸金属分析系统, 419

+   *base64dump.py*, 322, 405

+   Base64 编码, 319–322

+   Bashlite, 257

+   Adrien Bataille, 309

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Bcrypt*</samp> 函数, 30, 335–336, 343, 424

+   信标, 295

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">BeingDebugged</samp> 值, 10, 168

+   定制恶意软件, xxiv

+   二进制仪器化, 382, 420–421

+   动态, 420

+   静态, 420

+   Binwalk, 310

+   BITS（后台智能传输服务）, 299

+   BITSAdmin（*bitsadmin.exe*）, 299

+   位操作, 310. *参见* 隐写术

+   位测试（<samp class="SANS_TheSansMonoCd_W5Regular_11">bt</samp>）指令, 125

+   Black Hat 大会, 212, 246

+   blink（反向链接）, 9, 273–274

+   块加密算法, 326

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">BlockInput</samp> 函数, 179, 424

+   BluePill, 421

+   启动工具包, xxiv, 285

+   引导代码, 204

+   僵尸网络, 261

+   BPHs（防弹主机）, 262

+   Bratus, Sergey, 437

+   断点

+   在调试器中, 58

+   检测与规避, 174–176

+   在硬件中, 365

+   内存中, 66–68, 175–176

+   陷阱, 174, 177–187

+   自带漏洞驱动程序（BYOVD）技术, 271–272

+   浏览历史, 96

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">bt</samp>（位测试）指令, 125

+   防弹主机（BPHs）, 262

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">C</samp>

+   C2（命令与控制）

+   框架, 136, 259

+   服务器, 39

+   缓存, 96

+   回调函数, 106, 186

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CallNamedPipe</samp> 函数, 86

+   CAPA, 56–57, 336–337, 405

+   CAPE, 31

+   Carbanak 后门, 217

+   进位标志寄存器, 125

+   Case, Andrew, 436

+   中央调度代码块, 157

+   证书信任与签名滥用, 245–246

+   证书信任存储, 245

+   certmgr, 246

+   *certutil.exe*, 290, 299–300

+   CFF Explorer, 23, 62, 350, 353

+   CGG, 305

+   Chappell, Geoff, 7

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CheckRemoteDebuggerPresent</samp> 函数, 168–169, 424

+   校验和, 178–179

+   Chlumecký, Martin, 284

+   Chrome 浏览器文件位置, 96

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CloseHandle</samp> 函数, 170, 424

+   Cloudburst, 146

+   *cmd.exe*，29，250–251，300–301，369

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CmRegisterCallback(Ex)</samp> 回调，231，284–285

+   Cobalt Strike，204，295–297

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CoCreateInstance</samp> 命令，253

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CoInitialize</samp> 函数，253

+   coinminers, xxiv

+   COM。*参见* 组件对象模型

+   命令与控制（C2）

+   框架，136，259

+   服务器，39

+   命令行参数，119

+   已提交内存，13

+   商品恶意软件，xxiv

+   组件对象模型（COM）

+   滥用，252

+   类 ID，253

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">COMAutoApproval</samp> 属性，253

+   接口，253

+   对象，253

+   注册表篡改，253

+   上下文感知，xxii

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CONTEXT</samp> 结构，176

+   控制流，45，50，154–160

+   扁平化，156

+   使用索引和指针寄存器进行维护，45

+   使用跳转指令修改，50

+   混淆，154

+   对策，159–160

+   控制流保护，221

+   转换代码和数据，153

+   cookies，96

+   Cornelis，243

+   CosmicStrand，285

+   隐蔽执行，185

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">cpuid</samp> 指令，57，125，413

+   CPU 寄存器，44–51

+   摇篮，PowerShell，302–303

+   CRC-32 哈希，325

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateFile</samp> 函数，86，211，278，424

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateFileTransacted</samp> 函数，213，424

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateMutex</samp> 函数，85，424

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateProcess</samp> 函数, 173, 206–208, 213, 254, 296, 366, 370, 425

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateProcessInternal</samp> 函数, 366, 425

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateProcessNotifyRoutine</samp> 函数, 283, 432

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateProcessWithToken</samp> 函数, 254, 425

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateRemoteThread</samp> 函数, 30, 199–201, 203, 296, 367, 425

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateService</samp> 函数, 269–270, 425

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CREATE_SUSPENDED</samp> 标志, 206–207

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateToolhelp32Snapshot</samp> 函数, 76, 145, 173, 233, 425

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateTransaction</samp> 函数, 213, 425

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateWindow(Ex)</samp> 函数, 7–8

+   凭证，提取和重用, 254

+   加密工具, 346

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Crypt*</samp> 函数, 162–163, 332–335, 337, 343, 378, 425. *另见* 解密; 加密

+   CryptoAPI, 324–325, 332–335

+   加密提供者类型, 334

+   加密服务提供者 (CSP) 模块, 332

+   加密 API：下一代 (CNG), 332, 335–336

+   *cscript.exe*, 300

+   *csrss.exe*, 249

+   Cuckoo, 20, 31–32, 75, 78–79, 115, 143–144, 437

+   CVE-2021-36934, 255

+   CVEdetails, 419

+   CyberChef，322–324，330，339

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">D</samp>

+   d4rksystem，410–411

+   数据执行保护，221

+   DDoS（分布式拒绝服务），261

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DebugActiveProcess</samp> 函数，58，173，180，425

+   调试阻塞，180

+   调试，58–69，167–180

+   使用 x64dbg 进行分析，62

+   x64dbg 中的参数面板，60

+   断点，58

+   使用调试器检测，174

+   硬件中，66–68

+   内存中，66–68，175–176

+   软件中，65–66

+   选择调试器，58

+   x64dbg 中的 CPU 寄存器面板，60

+   x64dbg 中的 CPU 标签，59

+   崩溃，179

+   调试对象，170

+   禁用 ASLR，62–63

+   x64dbg 中的转储面板，61

+   利用，179

+   x64dbg 中的内存映射标签，61–62

+   修补和修改代码，68–69

+   进程，173

+   在 x64dbg 中运行代码，64–65

+   x64dbg 中的堆栈面板，61

+   Windows，172–173

+   欺骗数据，134

+   欺骗网络通信，136

+   解密，325–330，338–343

+   非对称，326–327

+   动态，339–343

+   密钥，325–327，333

+   静态，339

+   Deep Freeze，419

+   Dekel, Kasif，287

+   延迟执行，130–134

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DeleteFile</samp> 函数，307，425

+   拒绝服务（DoS）漏洞，239

+   Desai, Deepen，271

+   Detect It Easy (DIE)，160，353

+   设备驱动，266

+   设备枚举，88–90

+   VirtualBox，90

+   VMware，90

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DeviceIOControl</samp> 函数，270–272，279，425

+   DGAs（域名生成算法），260–261

+   数字签名, 245–246

+   强制, 286–287

+   直接注入, 199

+   直接内核对象操作 (DKOM), 272–274

+   目录和文件枚举, 98

+   虚拟机, 78–79

+   直接系统调用, 239–243

+   DirtyMoe, 284

+   禁用主机防御, 235–236

+   禁用服务, 237

+   反汇编工具, 51

+   选择, 52–53

+   Ghidra, 52–53

+   IDA, 52–55

+   反汇编, 44, 51–52

+   代码与数据问题, 52

+   线性（又名线性扫描）, 51

+   递归（又名流向导向）, 52

+   派发表, 275

+   破坏手动调查, 144–145

+   分布式拒绝服务（DDoS）攻击, 261

+   DKOM（直接内核对象操作）, 272–274

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DllCharacteristics</samp> 字段, 63

+   DLLs. *参见* 动态链接库

+   DNS. *参见* 域名系统

+   域配置枚举, 110

+   域生成算法 (DGAs), 260–261

+   域名系统 (DNS)

+   流量, 40

+   隧道传输, 257–258

+   冒名顶替, 212

+   DoS（服务拒绝攻击）, 239

+   双重快速流量技术, 262

+   Dridex, 133, 177–178, 381

+   驱动程序

+   枚举, 88–90

+   硬件设备, 5

+   非硬件设备, 5

+   驱动程序签名强制 (DSE), 286–287

+   投放工具, xxiii

+   DR 寄存器, 175–176

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DsGetDcName</samp> 函数, 110, 426

+   虚假代码, 132–133, 156

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DuplicateToken(Ex)</samp> 函数, 254, 426

+   Duqu, 309

+   dword（数据类型）, 44

+   动态编译恶意代码, 304–305

+   动态 API 函数解析, 161

+   动态代码分析, 58–71

+   动态链接库 (DLLs), 8

+   劫持, 214–216, 251

+   注入, 203

+   模块，120

+   搜索顺序，214

+   DynamoRIO，420

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">E</samp>

+   Eagle, Chris，435–436

+   早期启动反恶意软件（ELAM）驱动程序，231，287

+   Eclypsium，288

+   Edge 浏览器文件位置，97

+   EDR。*参见* 终端检测与响应

+   EFLAGS 寄存器，46，126

+   电子邮件保护技术，257

+   Emotet，127，297

+   Emsisoft，333

+   模拟，代码，382，420–421

+   模拟引擎，226

+   编码，319–323

+   加密，256–257，319–320，325–343

+   非对称，326–327

+   解密加密恶意软件数据，339–343

+   定位和识别恶意软件中的加密例程，336–338

+   对称，326–327

+   终端防御

+   积极规避，235–239

+   引擎限制，246–247

+   历史，224

+   识别，232–235

+   被动规避，239

+   漏洞，238–239

+   终端检测与响应（EDR），224，227–246，262–263，272，283

+   代理，227–230

+   文件系统工件，234

+   内核驱动程序和回调，230–231

+   日志记录与分析，231–232

+   进程工件，233

+   注册表工件，234

+   遥测，227

+   终端保护平台（EPPs），224

+   熵，352–353

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">EnumChildWindows</samp> 函数，186

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">EnumDateFormatsEx</samp> 函数，186

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">EnumDisplayMonitors</samp> 函数，106，186，426

+   枚举，操作系统

+   设备和驱动程序，88–90。*另见* 硬件与设备配置枚举

+   目录和文件，78–79，98

+   域配置，110

+   已安装软件，84–85

+   IP 地址配置，109–110

+   语言设置，90–92

+   加载模块，119–120，173

+   区域设置，90–92

+   互斥量，85–86

+   开放端口，115

+   进程，76–78

+   注册表，80–83

+   运行路径，118

+   服务，83–84

+   用户名和主机名，90

+   版本信息，92–93

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">EnumServiceStatus</samp> 函数，83，426

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">EnumSystemFirmwareTables</samp> 函数，108，426

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">EnumSystemLanguageGroups</samp> 函数，186

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">EnumWindows</samp> 函数，99，146，172，426

+   端点保护平台（EPPs），224

+   EPROCESS 结构，9，180，272

+   反向链接（blink），9，273–274

+   正向链接（flink），9，273–274

+   ESET

+   软件，233，236

+   威胁研究，248，259，271，309

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">EtwEventWrite</samp> 函数，238

+   规避，xxii–xxvi。*另见* 沙箱

+   Windows 事件跟踪（ETW），229，238

+   异常处理程序，189。*另见* 结构化异常处理程序

+   异常，124

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">EXCEPTION_ACCESS_VIOLATION</samp> 错误，191

+   异或（XOR），327–331，340

+   执行层，内核，5

+   Exeinfo，160，353–354

+   数据外泄，39

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ExitProcess</samp> 函数，130，426

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ExitWindows</samp> 函数，134，426

+   漏洞攻击，虚拟机监控程序，146

+   导出地址表，14

+   导出，30，204

+   ExpressVPN, 112

+   扩展检测与响应（XDR）, 232

+   外部 IP 地址, 112

+   验证, 112–114

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">F</samp>

+   FakeDNS, 389

+   FakeNet, 389

+   快速流技术, 261–262

+   Fiddler, 36, 39

+   文件追加, 309

+   文件命令, 22–23

+   文件仿真, 226

+   无文件恶意软件, 289–294

+   无文件攻击, 290

+   悖论, 292

+   文件元数据, 247

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">FILE_OBJECT</samp> 属性, 214

+   文件时间结构, 315

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">FileTimeToSystemTime</samp> 函数, 315

+   文件类型，识别, 22

+   过滤驱动程序, 266, 281–282

+   高度, 282

+   FIN7, 216–217

+   FindCrypt, 337–338

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">FindFirstFile</samp> 函数, 78, 426

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">FindFirstUrlCacheEntry</samp> 函数, 97, 426

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">FindNextFile</samp> 函数, 78, 426

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">FindNextUrlCacheEntry</samp> 函数, 97, 426

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">FindWindow</samp> 函数, 99, 172–173, 426

+   Firefox 文件位置, 96

+   防火墙配置, 237

+   固件, 107

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">FirmwareTablesView</samp> 函数, 107

+   表格枚举, 107

+   标志，CPU 寄存器, 46–47

+   FLARE-VM, 401–402, 405

+   flinks（前向链接）, 9, 273–274

+   FLOSS, 29, 164, 342, 405

+   面向流的反汇编（即递归反汇编）, 52

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">FltEnumerateFilters</samp> 函数, 283, 427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">FltEnumerateInstances</samp> 函数, 283, 427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">FltGetFilterFromName</samp> 函数, 283, 427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">FltRegisterFilter</samp> 函数, 282–283, 427

+   前台窗口枚举, 98–99

+   Formbook, 136–137

+   转发链接 (flinks), 9, 273–274

+   Fox-IT, 252

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">FreeLibrary</samp> 函数, 139

+   频率, 性能计数器, 123

+   FRIDA, 420

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">FsRtlRegisterFileSystemFilterCallbacks</samp> 函数, 231

+   FudModule, 271

+   函数指针滥用, 159

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">G</samp>

+   Gafgyt, 257

+   地理围栏, 259

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetAdaptersAddresses</samp> 函数, 109–111, 427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetAsyncKeyState</samp> 函数, 101, 427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetComputerName</samp> 函数, 110, 334, 427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetCurrentProcess</samp> 函数, 130

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetCurrentProcessId</samp> 函数, 173

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetCursorPos</samp> 函数, 100, 427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetDiskFreeSpace</samp> 函数, 105, 427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetForegroundWindow</samp> 函数, 98–99, 427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetKeyboardLayout</samp> 函数, 91, 427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetKeyboardLayoutList</samp> 函数, 91, 427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetLastError</samp> 函数, 169–170, 427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetLocalTime</samp> 函数, 172, 428

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetLogicalDrives</samp> 函数，7

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetLogicalProcessorInformation</samp> 函数，104，428

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetModuleFileName</samp> 函数，118，428

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetModuleHandle</samp> 函数，120，173，203，428

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetNativeSystemInfo</samp> 函数，104

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetPhysicallyInstalledSystemMemory</samp> 函数，105，428

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetProcAddress</samp> 函数，133，140–141，161–162，165，203–204，349–351，370，428

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetProcessPreferredUILanguages</samp> 函数，91，429

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetSystemDefaultLCID</samp> 函数，91，429

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetSystemDefaultUILanguage</samp> 函数，91，429

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetSystemFirmwareTable</samp> 函数，108，428

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetSystemInfo</samp> 函数，104，428

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetSystemMetrics</samp> 函数，106，428

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetSystemTime</samp> 函数，172，428

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetTcpTable</samp> 函数，114–115，429

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetThreadContext</samp> 函数，176，429

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetThreadLocale</samp> 函数，91，429

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetTickCount64</samp> 函数，429

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetTickCount</samp> 函数，101–102，121–123，171–172，429

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetUserDefaultLCID</samp> 函数, 91, 429

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetUserDefaultUILanguage</samp> 函数, 91, 429

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetVersionEx</samp> 函数, 92–93

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetWindowText</samp> 函数, 146, 429

+   Ghidra, 52–53, 153, 160, 337–338, 402, 436

+   GhostHook, 287

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GlobalAddAtom</samp> 函数, 209, 429

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GlobalGetAtomName</samp> 函数, 209, 429

+   Go (Golang), 245

+   Goodin, Daniel, 309

+   Google, 25, 113, 131, 245, 259

+   Gould, Tara, 305

+   GuLoader, 180, 325

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">H</samp>

+   hacktools, xxiv

+   Hahn, Karsten, 209

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">HalPrivateDispatchTable</samp> 结构, 287

+   Hand, Matt, 436

+   Windows 中的句柄, 6

+   加固, 虚拟机和虚拟机监控器, 412–414. *参见* 恶意软件分析实验室

+   硬件抽象层, 5

+   硬件和设备配置枚举, 103–115

+   CPU, 104

+   硬盘, 105–106

+   显示器配置, 106

+   RAM, 105

+   USB 控制器, 107

+   硬件断点

+   绕过, 175–176

+   在 x64dbg 中的设置, 365

+   基于哈希的检测, 225

+   hasherezade, 271

+   哈希, 23

+   级联, 324

+   冲突, 24

+   数据, 164–165, 323–325

+   MD5, 23–24

+   小节, 178–179

+   SHA-1, 23–24

+   SHA256, 23–24

+   Hatching Triage, 31, 437

+   堆, 内存, 11

+   堆标志, 170

+   HermeticWiper, xxiv, 267–271

+   基于启发式的检测, 225

+   隐藏线程, 193

+   HideProcess, 274

+   隐藏伪装与代码, 306–312

+   Higgins, Kelly Jackson, 248

+   劫持 DLL 和 Shim, 214–218, 251

+   Hinchliffe, Alex, 307

+   HiveNightmare, 255

+   注册表 hives, 16–17, 255–256, 292, 294

+   HKEY 根键, 16

+   空洞进程注入, 205–207

+   HollowsHunter, 379–380

+   Honig, Andrew, 436

+   挂钩, 100–101, 121, 137–141, 218–222, 378, 433

+   规避, 沙箱规避, 140

+   检测, 沙箱规避, 138

+   导入地址表, 221

+   注入, 缓解方法, 221

+   内联, 219

+   键盘钩子, 101

+   鼠标钩子, 100

+   移除, 沙箱规避, 139–140

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetWindowsHookEx</samp> 函数, 100–101, 218–219, 433

+   主机机器, 恶意软件实验室, 388

+   主机名更改工具, 411

+   主机名, 90, 411

+   枚举, 90

+   HTML 应用程序（.*hta*）文件, 298

+   HTTP 流量, 40

+   Hybrid Analysis, 31, 437

+   HyperHide, 182–183

+   虚拟机监控程序, 20

+   漏洞利用, 146

+   实验室设置, 388–389, 390–391

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">I</samp>

+   IDA Pro, 52–55, 160, 248, 436

+   使用分析, 53–55

+   IDA Signsrch, 337

+   IDT（中断描述符表）寄存器, 124

+   图像（IMG）内存, 13

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ImpersonateLoggedOnUser</samp> 函数, 254, 429

+   导入地址表（IAT）, 14

+   挂钩, 221

+   导入

+   打包工具, 350–352

+   PE 文件, 30

+   威胁指示器 (IOCs), 35

+   间接 API 调用, 161–163

+   间接系统调用, 242

+   InetSim, 389

+   无限循环, 132–133

+   InfinityHook, 287

+   信息窃取者, xxiii

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">InitiateShutdown</samp> 函数, 134, 429

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">InitiateSystemShutdown</samp> 函数, 134, 429

+   InjectDLL 补丁, 216

+   内联钩子, 219

+   内核钩子, 276–278

+   输入/输出 (IO) 端口, 124–125

+   检查恶意软件网络流量, 39–40

+   已安装软件枚举, 84–85

+   安装 Windows, 393–394

+   InstallUtil (*installutil.exe*), 299

+   完整性级别, 249

+   英特尔 Pin, 420–421

+   交互式行为分析, 36–40

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">InternetConnect</samp> 函数, 113, 378, 430

+   Internet Explorer 文件位置, 96

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">InternetOpen</samp> 函数, 54–55, 65–66, 69, 430

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">InternetReadFile</samp> 函数, 113, 430

+   中断描述符表 (IDT) 寄存器, 124

+   中断, 124

+   Intezer, 31

+   入侵防御系统 (IPS), 256

+   IO 管理器, 278, 281. *另见* IO 请求包端口, 124–125

+   Ionescu, Alex, 436

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">IoRegisterBootDriverCallback</samp> 回调, 231

+   IO 请求包 (IRPs), 275–282

+   代码, 278–279

+   函数表, 279

+   钩子, 278

+   拦截（即过滤）, 281–282

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">IoWMISetNotificationCallback</samp> 回调, 231

+   IP 地址配置枚举, 109–110

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">IsDebuggerPresent</samp> 函数, 161, 168, 430

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">IsNativeVhdBoot</samp> 函数, 106

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">IsProcessorFeaturePresent</samp> 函数, 104, 430

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">J</samp>

+   JavaScript, 263

+   Joe Sandbox, 20, 31–35, 297–298, 437

+   跳转表, 161–163

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">K</samp>

+   卡巴斯基, 224–225, 233–234, 239, 285–286, 315

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">KeBugCheckEx</samp> 函数, 287

+   内核, Windows

+   回调, 283–285

+   调试器, 169

+   驱动程序, 230, 266

+   执行层, 5

+   钩子技术, 274–315

+   内核模式 API, 7

+   内存管理器, 5

+   模式, 3

+   模块, 266

+   进程管理器, 5

+   *kernel32.dll*, 7–8, 14, 161–162, 202, 228, 240

+   *kernelbase.dll*, 8

+   基于内核的虚拟机（KVM）, 390

+   内核补丁保护（KPP）, 274, 286–288

+   键盘记录, xxiv, 255

+   KillAV, 235

+   杀毒软件, xxiii

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">KiUserExceptionDispatcher</samp> 函数, 192

+   Kleymenov, Alexey, 436

+   Kosayev, Uriel, 247, 437

+   Kuznetsov, Igor, 286

+   KVM（基于内核的虚拟机）, 390

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">L</samp>

+   实验室。*另见* 恶意软件分析实验室

+   语言标识符, 91

+   语言设置枚举, 90–92

+   后进先出（LIFO）, 47–48

+   Lazarus 小组, 271

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LdrLoadDll</samp> 函数, 228

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">lea</samp>（加载有效地址）指令, 88

+   最低有效位（LSB）技术, 311–312。*另见* 隐写术

+   Lechtik, Mark, 286

+   传统过滤器驱动程序，281。*另见* 过滤器驱动程序

+   Legezo, Denis，315

+   Lesueur, Jean-Pierre，437

+   Levy, Jamie，436

+   Ligh, Michael Hale，436

+   线性反汇编（即线性扫描），51

+   Linux，389–390

+   Living Off The Land Binaries（LOLBins），292，294–306

+   已加载模块枚举，119–120，173

+   加载有效地址（<samp class="SANS_TheSansMonoCd_W5Regular_11">lea</samp>）指令，88

+   加载器，xxiii

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LoadLibrary</samp> 函数，133，142，161，164–165，203，219，349–351，370，428，430

+   本地描述符表（LDT），124

+   区域设置和语言枚举，90–92

+   本地安全机构子系统服务（LSASS），254

+   Lockbit，325

+   逻辑炸弹，132

+   日志篡改，312–316

+   Lokibot，xxiv，299

+   LOLBins（Living Off The Land Binaries），292，294–306

+   低级功能，141–142

+   *lsass.exe*，254

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">M</samp>

+   MAC 地址，110–112，397–399

+   机器代码，44

+   宏，295

+   魔法字节，22

+   主要功能表，279

+   MalShare，438

+   Mal_Unpack，380–381

+   恶意软件

+   分析概述，xxv，19–21

+   行为分析，36–40

+   配置信息提取自，35

+   使用 Yara 检测，26–27

+   监控行为，37–40

+   搜索引擎，25–26，28

+   分诊，21

+   类型，xxii–xxv

+   恶意软件分析实验室，387–422

+   高级虚拟机和虚拟化管理程序加固，412–414

+   架构，388–390

+   本地分析，419–420

+   构建和配置，390–414

+   操作安全和有效性，416–419

+   模拟网络服务，416–418

+   对虚拟机进行压力测试，414–416

+   MalwareBazaar，25，438

+   Malwarebytes，213

+   恶意软件流量分析，438

+   Mandiant，56，217，309，401

+   手动加载库并调用函数，142–143

+   映射内存，13

+   假冒，247

+   主引导记录（MBR），xxiv，316

+   Matrosov, Alex，437

+   McAfee，22，214，224，233

+   MD5，23–24，323

+   媒体访问控制（MAC）地址，110–112，397–399

+   Mele, Gage，305

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">memcmp</samp> 函数，121

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">memcpy</samp> 函数，140

+   内存

+   炸弹攻击，247

+   断点，66–68，175–176

+   已提交，13

+   损坏，15–16

+   释放，362

+   堆，11

+   镜像，13

+   映射，13

+   页面保护，177

+   物理，11

+   私有，13

+   保护，359，363–364

+   可读写可执行，228

+   保留，13

+   字符串，120

+   虚拟，11–13

+   内存管理器，内核，5

+   内存常驻恶意软件，289。*参见* 无文件恶意软件

+   文件中的元数据，30–31，315

+   Microsoft Build Engine，305

+   Microsoft 加密 API。*参见* CryptoAPI

+   Microsoft Defender，232，236，401

+   Microsoft Hyper-V，390

+   Microsoft Office，229

+   Microsoft 安全中心，232，235

+   Microsoft 易受攻击的驱动程序阻止列表，287

+   Mimikatz，255

+   MinGW 编译器，305

+   微型过滤器驱动，231，267，281

+   Mitre CVE 数据库，238

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">MmProtectMdlSystemAddress</samp> 函数, 277

+   Windows 中的模式, 3

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Module32First</samp> 函数, 120, 173, 235, 430

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Module32Next</samp> 函数, 120, 173, 235, 430

+   Mofang, 252

+   监控恶意软件行为, 37–40

+   Moriya, 266

+   MosaicRegressor, 285–286

+   鼠标坐标, 100

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">movdqa</samp>（移动对齐的双四字双字）指令, 126

+   *msbuild.exe*, 305

+   *msconfig.exe*, 250–252

+   Mshta（*mshta.exe*）, 298

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">MsiEnumProducts</samp> 函数, 84

+   多阶段攻击, 262–263

+   突变, 243–244

+   代码块重排序, 243

+   引擎, 244

+   寄存器重分配, 244

+   互斥体, 6

+   枚举, 85–86

+   VirtualBox, 86

+   VMware, 86

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">MZ</samp> 头, 22

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">N</samp>

+   Nance, Kara, 436

+   原生 API, 7

+   NCC Group, 252

+   Necurs, 284

+   .NET 框架, 144, 245, 305

+   *netstat.exe*, 114

+   网络控制, 256

+   网络防御，规避, 256–262

+   网络检测与响应（NDR）, 257

+   网络入侵检测系统（NIDS）, 256–257

+   网络流量

+   恶意软件分析, 39–40

+   混淆和掩盖, 257

+   Nim, 245

+   Nirsoft, 107

+   No Pill 技术, 123–124

+   NordVPN, 112

+   Norton, 224

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtAllocateVirtualMemory</samp> 函数, 7, 139–140, 199, 240–241, 361–362

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtClose</samp> 函数, 170, 424

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtCreateFile</samp> 函数, 143, 219–221, 278–280, 424

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtCreateProcess</samp> 函数, 8, 211, 213, 425

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtCreateSection</samp> 函数, 143

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtCreateThreadEx</samp> 函数, 193, 200–201, 211–212, 425

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtCreateTransaction</samp> 函数, 430

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtCreateUserProcess</samp> 函数, 211, 228, 425

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtDeleteFile</samp> 函数, 425

+   *ntdll.dll*, 7–8, 14, 143, 161, 219–221, 228, 240–243

+   NTFS 文件系统, 300, 307–308, 315

+   ntinternals, 7

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtLoadDriver</samp> 函数, 270, 430

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtMapViewOfSection</samp> 函数, 143, 242, 430

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtOpenDirectoryObject</samp> 函数, 88, 430

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtOpenProcess</samp> 函数, 199, 431

+   *ntoskrnl.exe*, 5, 7, 275–278, 280, 283

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtProtectVirtualMemory</samp> 函数, 141, 363

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtQueryDirectoryObject</samp> 函数, 88, 430

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtQueryInformationProcess</samp> 函数, 169, 430

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtQueryObject</samp> 函数, 170, 430

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtQuerySystemInformation</samp> 函数, 108, 169, 431

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtQuerySystemTime</samp> 函数, 172, 431

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtQueryVirtualMemory</samp> 函数, 176, 434

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtQueueApcThread</samp> 函数, 208–209, 432

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtReadVirtualMemory</samp> 函数, 138, 432

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtResumeThread</samp> 函数, 207, 242, 381, 432

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtSetInformationFile</samp> 函数, 316

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtSetInformationThread</samp> 函数, 179, 193, 431

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtUnmapViewOfSection</samp> 函数, 206, 229, 431

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtWriteVirtualMemory</samp> 函数, 200–201, 207, 242, 434

+   PEB 中的 <samp class="SANS_TheSansMonoCd_W5Regular_11">NumberOfProcessors</samp> 值, 10

+   Nvidia, 246

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">O</samp>

+   Windows 中的对象, 6

+   OEP（原始入口点）, 347–350, 371–374, 377

+   Office 最近文件列表, 97

+   OllyDbg, 179

+   不透明谓词, 157–158

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">OpenMutex</samp> 函数, 85–86, 431

+   开放端口枚举, 115

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">OpenProcess</samp> 函数, 145, 198–199, 201, 203–204, 208, 254, 431

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">OpenProcessToken</samp> 函数, 431

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">OpenService</samp> 函数, 83, 431

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">OpenThread</samp> 函数，207–209，431

+   操作系统伪迹，75

+   操作安全（OPSEC），416–419

+   Orion（SolarWinds），xxii

+   Osipov, Arnold，251

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">OutputDebugString</samp> 函数，169–170，427，431

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">P</samp>

+   打包器，244，346–354

+   架构和功能

+   解决导入，349–350

+   将执行转移到 OEP，350

+   解包恶意软件有效载荷，348–349

+   识别打包的恶意软件，350–354

+   自动化打包器检测，353–354

+   熵，352–353

+   导入，350–352

+   PE 部分，353

+   字符串，352

+   类型，346

+   Pafish，414–416

+   虚拟内存中的页面表，11

+   Parshin, Yury，286

+   PatchGuard，274，286–288

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">PathFindFileName</samp> 函数，118

+   PEB。*参见* 进程环境块

+   PE-bear，181，350

+   PE Detective，353

+   PE 文件格式。*参见* 可移植可执行文件格式

+   持久性，134，292–294

+   PE-Sieve，379–380

+   Pestr，164

+   PEStudio，28–29，181，187，350

+   物理内存，11

+   PID（进程 ID），10

+   *ping.exe*，131

+   管道，86–87

+   管道列表，86–87

+   在 VirtualBox 中，87

+   在 VMware 中，87

+   可移植可执行（PE）文件格式

+   导出地址表，14

+   头部，13

+   DOS，13

+   可选的，13，62–63

+   导入地址表，14

+   加载过程，14–15

+   部分，13–14，353

+   筛查工具，23

+   Windows PE 加载器，13

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">PostMessage</samp> 函数，145–146，431

+   PowerShell, 29, 229–230, 236–237, 290–293, 302–305, 409

+   支架, 302–303

+   执行策略, 237

+   混淆, 303

+   查询 WMI, 303–304

+   主数据流, 307

+   进程优先级, 236

+   私钥, 326

+   私有（PRV）内存, 13

+   特权提升, 248

+   漏洞, 255–256

+   ProcDump, 296

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Process32First</samp> 函数, 76, 173

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Process32Next</samp> 函数, 76–77, 173

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ProcessDebugPort</samp> 函数, 169

+   进程双重化, 212–213

+   进程枚举, 76–78

+   进程环境块（PEB）, 9–10, 104–105, 167–168, 170–171, 204

+   反调试, 167–168

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">BeingDebugged</samp> 函数, 10, 168

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtGlobalFlag</samp> 函数, 168

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ProcessHeap</samp> 函数, 168

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NumberOfProcessors</samp> 值, 10

+   偏移量, 10

+   进程资源管理器, 38

+   进程幽灵化, 214

+   进程黑客, 12, 36, 38, 249, 267, 402

+   进程 herpaderping, 211–212

+   进程空洞化, 205–207

+   进程 ID（PID）, 10

+   进程镜像操作, 197, 210–214

+   双重化, 212–213

+   herpaderping, 211–212

+   幽灵化, 214

+   重成像, 214

+   进程注入, 138, 193, 197–210, 366–370

+   异步过程调用, 207–208

+   原子炸弹, 209

+   直接, 199

+   DLL, 203

+   针对 RATs 的缓解措施，221

+   监控，366–369

+   进程空洞化，205–207

+   反射式 DLL，204–205

+   反射式 shellcode，205

+   阶段式，205

+   无阶段，205

+   自我注入，199

+   shellcode，199–202

+   线程劫持，207

+   跟踪，369–370

+   进程管理器，内核，5

+   进程重新映像，214

+   进程替换，205–207

+   恶意软件沙箱中的进程树，33

+   Procmon（进程监视器），36–38，233–234，402

+   可编程逻辑控制器，xxi

+   程序设计语言，非主流，244–245

+   Proofpoint，248，259

+   提供者签名，108

+   PSExec，296

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">PsLookupProcessByProcessID</samp> 函数，273，431

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">PsSetCreateProcessNotifyRoutine</samp> 函数，210，212，432

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">PsSetCreateThreadNotifyRoutine</samp> 函数，231，283–284，432

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">PsSetLoadImageNotifyRoutine</samp> 函数，231，432

+   公钥，326

+   PyCrypto，338

+   Python，245

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">Q</samp>

+   Qbot，215

+   Qiling 框架，421

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">QueryPerformanceCounter</samp> 函数，123，432

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">QueueUserAPC</samp> 函数，208，432

+   qwords（数据类型），44

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">R</samp>

+   竞态条件，6

+   RAM，11

+   勒索软件，xxiii

+   RATs（远程访问木马），xxiii

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">rdtsc</samp>（读取时间戳计数器）指令，122–123，171–172

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ReadFile</samp> 函数，138，140

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ReadProcessMemory</samp> 函数, 120–121, 138–139, 221, 432

+   可读写执行（RWX）内存, 228

+   递归反汇编（即面向流程的反汇编）, 52

+   红色药丸技术, 123–124

+   红队笔记, 243

+   反射式 DLL 注入, 204–205

+   Regedit（注册表编辑器）, 17

+   *regedit.exe*, 82

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RegEnumKey</samp> 函数, 81, 133, 141, 432

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RegEnumValue</samp> 函数, 80–81, 432

+   寄存器，CPU, 44–51

+   注册表，Windows。*参见* Windows 注册表

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RegOpenKey</samp> 函数, 80–81, 284, 432

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RegQueryValue</samp> 函数, 38

+   regsvr32 (*regsvr32.exe*), 297–298

+   Remcos, xxii–xiii, 242

+   Remnux, 389, 404–408, 416–417

+   远程访问木马（RATs）, xxiii

+   修复未打包的可执行文件, 375–377

+   保留内存, 13

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ResumeThread</samp> 函数, 206–207, 366, 381–382, 432

+   返回指针滥用, 158

+   RFLAGS 寄存器, 46

+   Rivest 密码 4（RC4）, 327, 331–332, 340–241

+   罗奇亚（Roccia），托马斯, 271, 437

+   罗迪奥诺夫（Rodionov），尤金, 437

+   恶意字节技术, 152–153。*另见* 反汇编

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RollbackTransaction</samp> 函数, 213, 432

+   rootkits, xxiv, 265–267

+   针对的防御, 286–288

+   直接内核对象操作, 272–274

+   检查 EPROCESS 块, 180

+   安装, 269–270

+   ROR-13 哈希, 164–165, 325

+   轮询技术, 261

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RtlAddVectoredExceptionHandler</samp> 函数，424

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RtlCopyMemory</samp> 函数，277，432

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RtlCreateUserThread</samp> 函数，200，425

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RtlDecompressBuffer</samp> 函数，378

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RtlQueryProcessDebugInformation</samp> 函数，171

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RtlQueryProcessHeapInformation</samp> 函数，171，433

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RtlSetCurrentTransaction</samp> 函数，213

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RtlZeroMemory</samp> 函数，307，433

+   rundll32（*rundll32.exe*），37–38，295–298

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RunOnce</samp> 注册表键，293

+   运行路径枚举，118

+   RunPE，205–207

+   RunPE 解压器，381–382

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Run</samp> 注册表键，293–294

+   Russinovich, Mark E., 436

+   Rust，245

+   RWX（可读写可执行）内存，228

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">S</samp>

+   Saini, Ankur，271

+   Salinas, Rotem，283

+   沙箱，20

+   自动化恶意软件分类，31–36

+   绕过分析，144

+   基于云的，226

+   商业，31

+   检测

+   函数执行时间，123

+   性能和时间指标，122–123

+   使用检测技术的风险，127

+   不支持的指令集，125–126

+   规避

+   对策，146–147

+   防御规避，35

+   登出，134

+   重启，134

+   自我终止，130

+   不必要的进程生成，136

+   自由和开源，31

+   进程树，33

+   Sandboxie，120

+   Sandworm，248

+   SANS SIFT 工作站，389

+   Santos, Doel，307

+   Santos, Roberto，271

+   Scylla, 358–359, 374–377

+   ScyllaHide, 181–182

+   SDB Explorer, 217

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeBackupPrivilege</samp> 函数, 253

+   段哈希, 178–179

+   段对象, 143

+   安全启动, 288

+   安全日志, 313

+   Security Onion, 390

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeDebugPrivilege</samp> 函数, 254

+   SEH. *参见* 结构化异常处理器

+   自愈技术, 178–179

+   自我注入技术, 199

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeLoadDriverPrivilege</samp> 函数, 254, 270

+   服务控制管理器, 83, 249

+   服务, 83–84

+   枚举, 83–84

+   VirtualBox, 84

+   VMWare, 84

+   *services.exe*, 83, 249

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeShutdownPrivilege</samp> 函数, 254

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetFileAttributes</samp> 函数, 306, 433

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetFileInformationByHandle</samp> 函数, 316

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetFileTime</samp> 函数, 316, 433

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetLastError</samp> 函数, 169–170, 427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetPriorityClass</samp> 函数, 236, 433

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetThreadContext</samp> 函数, 176, 206–207, 433

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetUnhandledExceptionFilter</samp> 函数, 178, 433

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetWindowsHookEx</samp> 函数, 100–101, 218–219, 433

+   SHA-1, 23–24, 323

+   SHA256, 23–24, 323

+   ShadowHammer, xxii, 111

+   共享文件夹, 79–80, 400–401, 418

+   shellcode

+   注入, 199–202, 296

+   反射注入, 205

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SHEnumKeyEx</samp> 函数, 141

+   垫片, 214–216

+   劫持, 214, 216–218

+   *shutdown.exe*, 134

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">sidt</samp> 指令, 124

+   西门子可编程逻辑控制器, xxi

+   基于签名的检测, 225

+   绕过, 243

+   文件的签名, 22

+   Sikander, Usman, 243

+   Sikorski, Michael, 436

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">sldt</samp> 指令, 124

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Sleep</samp> 函数, 98–100, 121–122, 131, 433

+   睡眠例程, 131, 247, 263, 411

+   快照, 388–389, 408–409

+   SocGholish, 418

+   社会工程学, 247

+   套接字, 142

+   SolarWinds Orion, xxii

+   Solomon, David A., 436

+   Speakeasy, 382, 405, 421

+   间谍软件, xxiv

+   Squiblydoo, 298

+   SSDT (系统服务描述符表), 275–276

+   SSE 指令集, 126

+   栈，内存, 11, 47–48

+   栈字符串, 163–164

+   栈展开, 193

+   Stancill, Blaine, 309

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">StartService</samp> 函数, 269–270, 433

+   静态代码分析, 23, 51–57

+   静态属性，分析, 27

+   Stegano, 309

+   隐写术, 309–312

+   Steghide, 312

+   Stevens, Didier, 322, 329, 405

+   Stone-Gloss, Brett, 271

+   流密码, 326

+   字符串混淆, 160–165

+   字符串

+   ASCII, 27

+   提取与分析, 27–28

+   在恶意软件样本中的检查, 352

+   在内存中, 120

+   Unicode（即宽字符）字符串, 27

+   StringSifter, 29–30

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">strings</samp> 工具，27–28

+   结构体，104

+   结构化异常处理程序（SEH），158–159，178，189–193

+   帧，189

+   处理程序滥用，158–159

+   记录，189–191

+   Stuxnet，xxi，92

+   Sunburst，xxii

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SuspendThread</samp> 函数，207，433

+   对称加密，326–327

+   系统调用，7

+   直接，239–243

+   间接，242

+   编号（系统调用 ID），241

+   存根，240

+   sysenter，241

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">sysinfo</samp> 命令，102

+   Sysinternals 套件，37，88

+   系统二进制代理执行，296

+   系统摧毁，316–317

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SystemFirmwareTableInformation</samp> 参数，108

+   系统日志，313

+   系统服务描述符表（SSDT），275–276

+   系统服务号（SSN），241

+   系统运行时间，101

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">T</samp>

+   TA547，259

+   尾跳，350，372

+   篡改日志和证据，312–316

+   篡改保护，401

+   坦纳，阿曼达，307

+   TCP 连接状态，114

+   遥测，227

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">TerminateProcess</samp> 函数，91，130，145，228，235，433

+   塔贝特，阿姆尔，436

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">THREAD_CREATE_FLAGS_HIDE_FROM_DEBUGGER</samp> 标志，193

+   线程环境块（TEB），10–11，186，188–189

+   偏移量，10

+   进程 ID，10

+   线程 ID，11

+   线程局部存储，186

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ThreadHideFromDebugger</samp> 值，179，193

+   线程劫持，207

+   线程信息块（TIB）。*参见* 线程环境块

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ThreadInformationClass</samp> 参数，193

+   线程局部存储（TLS）回调，186–189

+   时钟滴答，101，122

+   时间炸弹，132

+   超时，沙箱规避，131

+   时间戳篡改，315

+   tiny_tracer，421

+   令牌窃取，254

+   TOR（洋葱路由），112

+   跟踪 API 调用，69–71

+   跳板，221

+   事务化空洞注入，213

+   事务化 NTFS，212–213

+   陷阱标志（TF），47，50，126，181

+   陷阱，174，177–187

+   初步处理（技术），21，23

+   Trickbot，245，251

+   Tripathi，Rahul Dev，283

+   木马（trojans），xxiv

+   在银行业，xxiii

+   远程访问，xxiii

+   Turla，259

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">U</samp>

+   UAC。*参见* 用户账户控制

+   UACME，253

+   UEFI（统一可扩展固件接口），285–288

+   未对齐的函数调用，140–141

+   不常见的函数，141–142

+   未处理的异常，178

+   卸载钩子，139，238，137

+   unicode（即宽字符）字符串，27

+   Unicorn，421

+   不必要的代码，155–156

+   不必要的跳转语句，154–155

+   解包

+   在没有分析的情况下，383

+   反解包技术，383–385

+   自动化，354–383

+   完全自动化，355

+   沙箱辅助，355–357

+   手动动态，357–382

+   手动静态，382–383

+   进程概述，348–349

+   修复可执行文件，375–377

+   UnpacMe，31，356，437

+   Upclicker，100

+   正常运行时间，101

+   *uptime.exe*，102

+   UPX，346，348，353

+   USB 控制器，107

+   *user32.dll*，8，138

+   用户账户控制（UAC）

+   绕过，248–254，269

+   提示，250，253

+   用户模式 API，7

+   用户名枚举，90

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">V</samp>

+   值，Windows 注册表，16

+   VBA（Visual Basic for Applications），290

+   基于 VBA 宏的恶意软件，295

+   VboxCloak，403，410

+   VboxHardenedLoader，414

+   VBScript，300

+   向量化异常处理（VEH），192–193

+   版本信息枚举，92–93

+   Windows 版本，93

+   Virlock，244

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">VirtualAlloc</samp> 函数，7，13，199–208，296，359–362，366，434

+   VirtualBox，79–81

+   隐蔽，410

+   在中创建虚拟机，392–400，404–406

+   默认 IP 地址范围，109–110

+   设备，90

+   驱动程序，88–89，272

+   客户机附加服务，83–86，401–404

+   强化，414

+   在实验室设置中，390–391

+   互斥体，86

+   路径，79

+   管道，87

+   前缀，107，112，397

+   进程名称，77

+   注册表项，82

+   快照，408，419

+   字符串，83，108，125，410

+   更新，419

+   验证设置，391

+   在 WMI 输出中，304

+   虚拟机（VMs），20

+   创建，392–393

+   目录和文件枚举，78–79

+   转义，146

+   基于内核，390

+   在打包器中，385

+   进程在，77

+   快照，388–389，408–409

+   工具，402–404

+   虚拟内存，11–13

+   虚拟 PC，120，126

+   虚拟专用网络（VPNs），112，418

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">VirtualProtect</samp> 函数, 139–141, 177, 221, 362–363

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">VirtualQuery</samp> 函数, 176, 434

+   病毒, xxiv

+   VirusShare, 438

+   VirusSign, 438

+   VirusTotal, xxix, 24–25, 31, 39, 119, 437–438

+   Visual Basic for Applications (VBA), 290

+   虚拟机。*参见* 虚拟机

+   VMProtect, 346

+   VMRay, 31, 356

+   VMware

+   Carbon Black, 233

+   在中创建虚拟机, 391, 393–400, 404–406

+   默认 IP 地址范围, 109

+   设备, 90

+   驱动程序, 78, 89

+   Fusion, 390–391

+   客户机认证服务, 84

+   加固, 412–414

+   IO 端口, 124–125

+   互斥锁, 85–86

+   路径, 79

+   管道, 87

+   前缀, 111, 397

+   进程名称, 77

+   注册表项, 81–82

+   快照, 408–409

+   字符串, 108, 125, 410

+   工具服务, 84, 402–404

+   更新, 419

+   存在的漏洞, 146

+   工作站, 80, 86–87, 89–90, 125, 390–391

+   VMwareCloak, 403, 410

+   VMX (.*vmx*) 文件, 413

+   VMX IO 端口, 124–125

+   波动性, 279–280

+   卷影复制服务 (VSS), 255–256

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">vpcext</samp> 指令, 126

+   VPN（虚拟私人网络）, 112, 418

+   漏洞, 提权利用, 255–256

+   vx-underground, 438

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">W</samp>

+   壁纸枚举, 98

+   Walters, Aaron, 436

+   Warzone RAT, 26

+   观察表达式，192

+   Web 代理，39

+   宽字符（即 Unicode）字符串，27

+   Windows，桌面，98

+   Windows API (WinAPI)，4，6–9

+   格式，8

+   函数名中的后缀，8

+   Windows 命令行，300。 *另见* *cmd.exe*

+   Windows 事件日志，312–315

+   Windows 事件查看器，312

+   Windows 镜像下载，391–392

+   Windows 管理工具 (WMI)，81，231，236，279，303–304

+   Windows 管理工具控制台 (WMIC)，29，83，102，304

+   Windows 本机 API

+   与 WinApi 的交互，7

+   函数名中的后缀，8

+   Windows PE 加载程序，13

+   Windows 注册表

+   隐藏配置，409–410

+   枚举，80–83

+   注册表项，VirtualBox， 82

+   注册表项，VMware，81

+   Hive，16

+   恶意软件行为分析，38

+   注册表编辑器 (Regedit)，17

+   注册表驻留的恶意软件，291–292

+   值，16

+   Windows 脚本宿主，300

+   Windows 服务控制器，270

+   Windows 启动修复，316

+   Windows 子系统进程，249

+   Windows 更新，401

+   Windows 更新服务，237

+   *Winhttp.dll*，8，30，142

+   WinObj，88

+   *Winusb.dll*，107

+   擦除工具，xxiii

+   Wireshark，36，39

+   WMI（Windows 管理工具），81，231，236，279，303–304

+   WMIC（Windows 管理工具控制台），29，83，102，304

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WNetGetProviderName</samp> 函数，79

+   字（数据类型），44

+   蠕虫，xxiv

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Wow64SetThreadContext</samp> 函数，176，429

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Wow64SuspendThread</samp> 函数, 207, 433

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WriteFile</samp> 函数, 30, 37

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WriteProcessMemory</samp> 函数, 30, 175, 199–201, 203, 206–208, 220–221, 296, 434

+   *wscript.exe*, 300

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">X</samp>

+   x64（64 位）汇编代码, 44, 47, 192–193

+   64 位 SEH, 192–193

+   x64dbg. *另见* 调试

+   向中添加观察表达式, 192

+   使用分析, 62–68

+   断点设置, 175, 365

+   转储内存到文件, 375

+   补丁, 68–69

+   插件, 181–183, 358, 375, 382

+   在中启动会话, 58–62

+   和系统工件, 172–173

+   与反汇编器一起使用, 160

+   x86（32 位）汇编代码, 44, 47

+   XDR（扩展检测与响应）, 232. *另见* 端点检测与响应

+   XMM 寄存器, 126

+   XOR（异或）, 327–331, 340

+   XORSearch, 329

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">Y</samp>

+   Yara, 24, 26–27, 32, 405

+   Yason, Mark Vincent, 180, 437

+   Yehoshua, Nir, 247, 437

+   Yomi, 437

+   Yosifovich, Pavel, 436

+   <samp class="SANS_Futura_Std_Bold_Condensed_B_11">Z</samp>

+   零标志（ZF）, 47–50

+   Zeus, 309

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ZwCreateFile</samp> 函数, 213

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ZwCreateTransaction</samp> 函数, 213

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ZwNotifyChangeKey</samp> 函数, 8
