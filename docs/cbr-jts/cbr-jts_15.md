# 第十五章：萤火虫之术

只有在你对敌人有非常详细的了解后，才能执行萤火虫之术，这样你才能根据目标的心态构建你的欺骗。

> 在执行监视或秘密忍者活动之前，你应该为未来的声誉留下一个字条。
> 
> —吉守百首 #54

*万川集海* 描述了一种名为“萤火虫之术”（*hotarubi no jutsu*）的忍者开放伪装渗透技巧。^(1) 我喜欢这样想，这个技巧之所以命名，是因为萤火虫的闪光在它飞走后会在你的夜视中留下余光，让你抓空了。*胜忍记*将这一技巧描述为“伪装艺术”（*koto wo magirakasu no narai*）。^(2) 使用这一技巧，忍者通过布置物理证据，引诱敌人采取一些期望的行动，包括误判忍者的雇主，做出对忍者动机的错误假设，并草率反应，暴露自己，进一步引发攻击。

一封伪造的信件，内含关于敌人的犯罪细节或误导性证据，是最常见的*萤火虫之术*技巧，并且有多种变体。卷轴中描述了忍者将信件缝进自己的衣领，这样如果他们被抓住或搜查，信件就能被迅速找到。^(3) 或者，忍者可能会招募一个愿意但无能的人当“忍者”，给他们一封写着与忍者真正计划完全相反的信件，并将他们派遣到敌人的环境中，知道这个“注定失败的特工”肯定会被抓住。重要的是，这个招募者自己不会意识到这一部分计划。经过搜查，守卫们会发现这封伪造的信件，信中将某个高价值目标——比如敌方最有能力的指挥官——牵涉到叛国阴谋中。这个“忍者”在酷刑下很可能会崩溃，并证明消息的真实性，进一步加重了目标的罪名。^(4) 这一切都旨在欺骗敌人，迫使他们攻击或处置自己的盟友。

在一个更加复杂的变种中，在任务开始之前，忍者会小心地种下支持信件虚假故事的证据，并将伪造的信件放置在一个有罪证据的地方，例如敌方指挥官的亲信顾问的住处。伪造的信件随后成为一种保护手段。如果忍者被捕，他们会忍受拷打，直到能够确定敌人的目标，然后透露自己对信件的秘密知识。敌人接着会找到信件和相关证据。在建立了可信度之后，忍者会承诺成为双重间谍或分享关于雇主的秘密，以换取不被处决的机会。^(5) 这一技巧使敌人对忍者的动机产生困惑，担心潜在的背叛，并怀疑谁才是实际的对手。

在本章中，我们将回顾将威胁归因于特定对手和/或来源的挑战。我们将讨论使用威胁分析、可观察证据和基于行为的情报评估进行归因调查。我们还将讨论复杂对手的问题，这些对手了解这些归因方法，因此会采取对策。防御者越重视归因，网络威胁行为者就越能通过设法追踪线索来增加困难和风险，因此我们还将讨论应对这种增加风险的方法。

## 归因

*归因*，在网络安全的上下文中，是指对可观察证据的评估，这些证据可以用来识别网络空间中的行为者。这些证据可以有多种形式。威胁行为者的行为、工具、技术、战术、程序、能力、动机、机会和意图等信息，都提供了宝贵的背景信息，并推动对安全事件的响应。

例如，假设您的家庭报警器响起，表明窗户被打破了。根据您的归因知识水平，您的反应会有很大的不同：消防员进入您家扑灭火焰的反应与抢劫犯闯入盗窃财物的反应，或是一个误打的高尔夫球撞破窗户的反应截然不同。当然，归因并不总是容易得到。小偷可以通过戴手套和面具来控制可观察的证据。他们甚至可以穿消防员服装来掩饰身份，并欺骗房主同意让他们进入。小偷可以在犯罪过程中或之后制造、销毁或避免留下证据，从而妨碍后续的法医调查工作。一个真正复杂的罪犯甚至可能通过伪造的指纹垫、被盗的头发、血液或衣物样本、逼真的 3D 打印面具，或从毫无戒心的冤枉人那里获得的武器来嫁祸给另一个罪犯。如果被冤枉的人没有不在场证明，或者犯罪的目标与他们的动机一致，那么当局就有充分的理由怀疑或逮捕这个冤枉的人。

网络安全专家面临这些类型的归因问题，甚至更多。归因尤其困难，因为网络环境本身具有匿名性。即使在完成追踪攻击或事件来源计算机和物理地址的困难任务之后，网络安全专家仍然可能发现很难验证攻击者的身份。在受损计算机上追踪威胁行为者的来源往往会导致隧道、VPN、加密和租用的基础设施，且没有有意义的日志或证据。复杂的威胁行为者甚至可能通过远程连接外国计算机，将其作为平台攻击其他系统。即使在发现敌人之后，在某些情况下也可能建议不要立即阻止他们或移除他们的访问权限；相反，可能更有利的是暂时监控他们，了解他们的目标和识别特征。^(6)

在某些情况下，威胁组织故意留下工具或其他可观察的迹象，以推动归因叙事。报道称，美国、俄罗斯和朝鲜已经修改或复制了他们的网络工具中的代码片段、字符串、基础设施和工件，以导致错误归因。^(7) 当网络安全专家发现并逆向工程特别隐蔽的恶意软件时，他们有时会在恶意软件痕迹中观察到独特且多余的字符串。也许这些字符串被忽视了——这可能是操作员或开发者的技术失误。但它们也可能是“萤火虫的艺术”——故意设计为被发现并用于（错误）归因的证据。

请注意，使欺骗成为可能的机制也提供了强大的识别手段。内存转储、磁盘镜像、注册表、缓存、网络捕获、日志、网络流量、文件分析、字符串、元数据等有助于识别网络威胁行为者。各种情报学科，如信号情报（SIGINT）、网络情报（CYBINT）和开放源情报（OSINT），也为归因提供了帮助，而人力情报（HUMINT）能力则从特定来源收集数据，经过处理和分析后有助于指示谁可能进行了网络攻击。这些能力通常是保密的，因为披露它们的存在会告诉目标如何避开、否认或欺骗这些系统，从而阻碍产生有用情报和威胁归因的能力。

## 归因处理方法

组织希望了解破坏其系统和网络的威胁行为者的身份和来源是合理的。许多人希望采取行动，比如反击黑客，以发现这些威胁行为者的身份，这是可以理解的。然而，威胁行为者就像忍者一样，总能通过否认和欺骗的方式进行隐秘的恶意行动，从而使归因变得不确定。此外，从历史中汲取教训，只有在日本统一并进入和平统治后，才停止了对忍者的归因。全球在可预见的未来不太可能实现统一，因此国家级网络攻击很可能会继续发生。直到世界和平到来，以下归因方法可以帮助你识别是否能对持续的网络冲突采取措施：

1.  *摆脱你的认知偏差。* 反思自己的认知偏差和错误的逻辑。每个人的思维中都有漏洞，但我们可以意识到这些问题并努力改正。构建你自己的案例研究。回顾过去的错误判断，找出其中的错误，并思考如何提升自己的分析能力。这项重要工作可以通过小步骤完成（逻辑难题、填字游戏和脑筋急转弯是提升认知功能的好方法），也可以通过大步伐实现。你可以研究讨论已知认知偏差和逻辑谬误的心理学文章和书籍，学习克服自己偏差的结构化分析技巧。^(8)

1.  *建立归因能力。* 检查你可以使用哪些数据源、系统、知识和控制措施来影响你所在组织的归因。你是否运行开放且未保护的 Wi-Fi，使得未注册、未认证和未识别的威胁行为者可以匿名连接到你的网络并发起攻击？你是否管理允许伪造 IP 地址的路由器，或者它们是否使用反向路径转发（RFP）保护技术来防止网络内的匿名攻击？你是否正确发布了发件人策略框架，以防止威胁行为者伪造电子邮件地址并冒充你组织的身份？

    尽管这些配置更改中的许多不会产生直接费用，但实施如此广泛的更改所需的时间和劳动（以及机会成本）可能会让管理层犹豫。然而，考虑一下之前是否决定投资于良好的摄像头和照明，帮助店主正确识别破坏者。建立健全的日志记录、文档和证据收集实践可以提高归因能力，增强技术问责制，并为最终用户提供更好的网络威胁可视性。

1.  *. . . 或者忘记归因。* 与你组织的利益相关者合作，确定为降低风险所需的归因努力范围。对于那些能够逮捕威胁行为者或发起反攻的组织来说，归因是必须的。然而，大多数组织无法或不应试图抓捕或攻击威胁行为者，了解他们的身份或映射他们的能力。实际上，对特定威胁行为者的归因并不总是必要的。意识到威胁就足以分析和防御它。

    例如，假设有两个威胁行为者针对你组织的知识产权。一个想将信息卖到黑市上赚钱，另一个想利用这些信息为他们的国家建设武器系统。实际上，这并不重要。无论威胁行为者的目的是什么，以及组织是否有能力追踪他们，防御者最终都必须限制或拒绝利用安全漏洞的机会。组织不必评估威胁行为者的动机就能避免威胁。

## 推荐的安全控制和缓解措施

在相关的情况下，建议会结合 NIST 800-53 标准中的适用安全控制措施进行呈现。每个建议都应在考虑归因的概念下进行评估。

1.  将账户映射到用户身份。通过生物识别、身份证明、逻辑或物理证据或访问控制验证与用户账户相关联的个人身份。[SA-12: 供应链保护 | (14) 身份与可追溯性]

1.  制定一个计划，定义你组织如何处理威胁行为者的归因评估。[IR-8: 事件响应]

1.  建立威胁意识项目，收集并共享关于威胁行为特征的信息，以及如何在您的环境中识别它们，归因证据和其他可观察因素。 使用特定的收集能力，如诱饵罐，用于归因目的。 [PM-16: 威胁意识项目; SC-26: 诱饵罐]

1.  应用安全和收集控制。执行威胁建模以识别威胁代理人。 [SA-8: 安全与隐私工程原则]

## 详细报告

在本章中，我们回顾了萤火虫之术——一种由忍者使用的误归因技术。网络威胁组织在复杂度上不断发展，并且很可能将这种技术纳入其操作安全程序中，如果他们还没有这样做的话。我们注意到，已有几个威胁组织被认为正在使用误归因技术，并讨论了处理归因的方法，以及未来归因的前景不容乐观。

在下一章中，我们将讨论忍者在被审问时如何保持合理否认的战术。 该章节还将讨论捕获敌人忍者时使用的高级忍者审问技术和工具。
