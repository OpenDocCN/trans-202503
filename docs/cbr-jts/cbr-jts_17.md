# 第十七章：火攻

首先，点火容易；其次，敌人很难扑灭火焰；第三，如果你的盟友同时来攻城，敌人将失去任何优势，因为防线将会人手不足。

> 如果你打算放火烧敌人的城堡或营地，你需要与盟友提前商定点火时间。
> 
> ——义盛百首 #83

忍者潜入城堡或防御工事后，最具破坏力的行动之一就是放火——理想情况下是在火药仓库、木材储存处、粮食或供应仓库或桥梁周围。点燃的火源传播迅速且隐蔽；不容易扑灭；并且对城堡的完整性、物资和居民构成了即时威胁。城堡的防守者必须在扑灭火焰和应对由纵火者发出的进攻信号之间做出选择。如果同时要应对两场战斗，目标的防御能力将大打折扣。那些试图扑灭火焰的防守者很容易被前进的敌军赶超，而忽视火源去应战的人，无论如何勇敢作战，最终都会失去战斗。^(1)

这些卷轴详细讨论了火攻，包括执行火攻时使用的各种工具、战术和技巧。在发起攻击之前，忍者会研究城堡内居民的作息，确定他们何时睡觉或哪些关键位置无人守卫。然后，他们与其他入侵者协调时机。忍者为这些攻击设计了许多专用工具，例如火箭、隐蔽的火持筒、地雷、炸弹和可投掷火炬。^(2) 其中最具视觉冲击力的武器是“火马”——将特殊火炬绑在马鞍上的马匹，被放入防御工事内，四处奔跑，散播火焰，混乱地吸引守卫和居民的注意，且难以扑灭。在混乱中，忍者与隐藏在城堡外的部队进行沟通，一旦火势足够蔓延，便发起攻击。^(3)

尽管中世纪的军队具备从远处发起火攻的能力——例如通过弓箭手射火箭——*《万川集海》*建议指挥官应派遣忍者来点燃火源。与外部攻击相比，忍者设置的火源不容易被发现和扑灭。而且，忍者可以将火源设置在易燃物品或具有战略价值的物品附近，甚至可以在火势蔓延之前加以加燃。^(4)

火攻的成功使其在日本封建时期变得无处不在，因此许多城堡开始实施针对性的反制措施。这些措施包括用*土造作*（“用石膏进行防火处理”）防火、使用防火或耐火材料如粘土或岩石建造、使用防火屋顶瓦、建立防火巡逻队，并通过指定不重要的建筑（即那些可以被牺牲来防止火灾蔓延到关键基础设施的建筑）来创建防火带。^(5)。守卫们还被警告，火灾可能是故意制造的 distractions，目的是为了促进盗窃、攻击或其他行动^(7)（这一建议后来在*《军法事要书》*中得到了反映^(8)）。

重要的是要记住，忍者没有自动打火机，而防守者则始终保持警惕，以防纵火者（就像现代组织始终维持着防病毒和威胁检测一样）。忍者设计了巧妙的方式来秘密地传递火源、将其武器化，并利用易燃目标。在想象网络攻击如何传递并对目标进行武器化时，记得忍者在火攻方面的巧妙方法。

在本章中，我们将回顾在网络战争的背景下，忍者火攻与现代混合战术的惊人相似之处。火是蠕虫式/自我传播网络攻击的一个很好的类比，因为它会蔓延到能接触到的一切。我们将回顾一些破坏性网络攻击的案例，以及现代对手如何协调和定时这些攻击。我们还会探讨组织用来预防、缓解、遏制和从网络攻击中恢复的各种防御措施。本章的要点可以应用于防火墙，以及更新、更先进的网络防御策略。

## 破坏性网络攻击

在计算机能够相互连接并进行通信后不久，自我传播的病毒和蠕虫就诞生了。随着时间的推移，破坏性攻击变得愈加猖獗。如今，一个组织网络上的破坏性攻击可以像火一样迅速蔓延，摧毁整个互联网中的系统和数据。考虑到网络空间中系统之间日益增长的互联性以及固有的安全漏洞，任何没有补丁或其他安全防护的互联网连接网络或机器，基本上就是一堆等着点燃的干草。

在 2000 年代初，行业首次出现了勒索软件攻击。在这些攻击中，恶意软件会加密系统或网络的数据（并删除备份），直到目标支付赎金以解密数据。这些病毒迅速从系统传播到网络存储，再到云端，将数据劫持，或者在未支付赎金的情况下通过加密摧毁数据。像忍者火攻击一样，勒索软件通常用来转移对更大计划的注意力。例如，据信是朝鲜发动的攻击者部署了 FEIB Hermes 勒索软件攻击，目的是分散网络防御者的注意力，而攻击者则执行了 SWIFT 金融攻击，给他们带来了数百万美元的收益。^(9)

随后出现了擦除型恶意软件攻击，敌方在多个系统中植入“定时炸弹”病毒，在指定的合适时机删除所有系统数据并擦除备份。一个例子是 Shamoon 病毒，据信由伊朗的威胁行为者对沙特阿拉伯发动，并在周末假期开始时启动，目的是销毁数据并使工业石油系统瘫痪。^(10)

最近，攻击者已针对工业控制系统部署了破坏性恶意软件，使得攻击者能够读取传感器或控制机械开关、电磁阀或操作高炉、^(11) 电网、^(12) 防空系统、^(13) 以及核离心机。^(14) 此类攻击可能使这些关键系统瘫痪或发生故障，进而导致爆炸、其他物理破坏或同时发生的动能攻击。

防止攻击传播的管理工作包括通过加固系统来减少攻击面，这样当系统受到攻击时，经过精细调优的安全控制可以限制损害。此外，弹性也很有用，通过在其他地点和网络中对系统和数据进行多重备份，可以在网络攻击成功破坏主要系统时为组织提供备选方案。（有时这些备份甚至是模拟的或手动的系统。）

更为技术性的防御解决方案包括在网络边界上部署防火墙。然而，如果攻击者绕过防火墙，渗透到网络并启动自我传播的破坏性攻击，防火墙可能会让攻击超出其网络范围；换句话说，防火墙通常设计用于阻止传入的攻击，而不是传出的攻击。其他用于检测和阻止破坏性攻击的工作包括防病毒软件、入侵防御系统（IPS）、主机入侵检测系统（HIDS）和组策略对象（GPO）。这些技术性保障措施可能会立即识别破坏性攻击、响应并中和攻击，但通常是基于特征的，因此并不总是有效。

一种较新的方法是网络保险，它是一种保护组织免受安全漏洞法律和财务后果的协议。虽然这种保险政策可以减轻组织在网络攻击中的责任，但它并不能防御攻击，就像火灾保险并不防火一样。

可以说，防范破坏性攻击的最佳选项包括严格的网络隔离和分割（空气隔离），以限制资源访问并防止自我传播的病毒扩散。虽然这是阻止网络攻击的极有效方式，但鉴于它可能对业务功能产生重大影响，实施起来并不总是可行的。此外，它还可能被“滑板网”和内部威胁绕过。

## (网络)火灾攻击的防护措施

组织通常会购买火灾保险，并采取防火和灭火策略。然而，出于某种原因，一些组织购买了网络保险，却没有采取防范网络攻击的安全措施。也许是因为他们没有把网络攻击的风险与实际火灾的风险看得同等严重，毕竟火灾会危及财产，甚至是人命。但随着物联网（IoT）的发展和物理世界与网络空间的日益融合，风险只会增加。采取以下防御措施可能对你的组织帮助巨大：

1.  *进行网络火灾演练*。模拟破坏性攻击来测试备份、故障转移、响应能力、恢复能力以及在及时的情况下“撤离”数据或系统的能力。这项演练不同于灾难恢复或备份测试，因为它不是想象中的威胁场景，而是一个活跃的模拟威胁正在与网络互动。（采取加密数据并使用已知密钥等措施，确保在演练过程中不破坏任何数据。）

    Netflix 运行着一个名为“混乱猴子”的长期演练，它会随机断开服务器连接、破坏配置和关闭服务。因此，该组织不断测试自己是否能顺利、及时地进行负载均衡或切换到备份系统。发生真实问题时，安全团队已经设计并测试了可行的解决方案。Netflix 已将“混乱猴子”免费公开，任何组织都可以使用它来提高检测、抵抗、响应和恢复破坏性攻击的能力。^(15)

1.  *(网络)防火系统。* 将资源专门用于研究所选破坏性攻击的传播方式、它摧毁的内容以及系统的脆弱性。实现只读硬盘适配器，通过在硬盘缓冲区进行操作，使数据“隔离在玻璃后面”，无法被摧毁，因为在只读状态下，数据无法与外界交互。移除“可燃”软件：已知会传播破坏性攻击的应用程序、库、功能和其他系统组件。

    存在一个商业机会，即开发专门的软件、硬件和设备，以防止网络系统受攻击。这些应用程序可能会对市场产生巨大影响，使服务器或数据能够抵御破坏性攻击，或者至少减缓或阻止它们的进展。

1.  *设置网络火力陷阱。* 创建自动化的拒绝和欺骗“网络火力陷阱”来引诱对手或恶意程序进入无限循环或触发机制，使攻击能够自我隔离、扑灭或控制，是一个巨大的市场机会。一个聪明的公开报告防御方法是设置网络共享中的文件夹，包含无限递归的目录；当恶意软件尝试遍历文件夹以寻找更多数据时，它会被卡在一个无尽的循环中。^(16) 可以部署专用传感器来检测这种行为，随后它们可以警告事件响应团队或触发命令终止启动无限目录的进程。

1.  *创建动态网络防火隔离/切断线。* 网络攻击之所以传播如此迅速，是因为系统通常处于开启状态并彼此连接。尽管攻击可能无法直接危及某个系统，但它可以传播到其他互联的系统。这一点通过成千上万（甚至数百万）在网络空间中自我传播的僵尸网络、蠕虫和其他恶意软件屡次得到证明。

    虽然大多数网络隔离和分割是通过静态设计的架构完成的，但 IT 组织可以实施额外的手动和基于软件的“断开”线。有些组织已知会安装主电磁阀开关，手动将组织与互联网断开。内部局域网通信仍然继续，但所有外部网络连接立即断开，形成物理隔离。这个功能的需求可能看起来极端或不太可能，但在全球“网络火灾”发生时，组织可以选择快速而轻松地脱离威胁，而无需用斧头切断电缆。

    该实施方法的变体是，每个系统、房间、楼层和建筑物都有自己的主开关，使安全人员能够迅速做出决策以阻止破坏性攻击。在收到领导层的攻击通报后，工作人员可以迅速下载任何关键工作文档，然后切换开关，将计算机与网络隔离，防止攻击传播。

## 推荐的安全控制和缓解措施

在相关情况下，推荐措施将配合 NIST 800-53 标准中的适用安全控制呈现。每一项都应根据火灾攻击的概念进行评估。

1.  监控组织内部破坏性行为的迹象。通过将数据转发至分段事件收集器，防止篡改系统监控日志、审计事件和传感器数据。[AU-6: 审计审查、分析和报告 | (7) 允许的操作；AU-9: 审计信息保护；SI-4: 系统监控]

1.  实施网络、系统和流程的隔离/分隔，减少破坏性攻击在网络中传播的可能性。[CA-3: 系统互联；SC-3: 安全功能隔离；SC-7: 边界保护 | (21) 系统组件隔离；SC-11: 可信路径 | (1) 逻辑隔离；SC-39: 进程隔离]

1.  进行备份测试和恢复力演练，以确定恢复机制和故障保护措施是否按预期工作。[CP-9: 系统备份 | (1) 可靠性和完整性测试 | (2) 使用采样测试恢复；CP-10: 系统恢复和重建 | (1) 应急计划测试]

1.  在允许删除或销毁数据的命令之前，要求经过合格、授权人员的双重授权。[CP-9: 系统备份 | (7) 双重授权]

1.  实施措施以维持组织的安全，在发生导致安全系统失效的破坏性攻击时。例如，配置防火墙断开连接后阻止所有通信，而不是允许所有通信，或在检测到攻击时将系统配置为进入“安全模式”。[CP-12: 安全模式；SC-24: 以已知状态失败]

1.  维护受保护的媒体传输机制，防止破坏性攻击。例如，确保包含敏感数据的硬盘保持离线、断开连接，并存储在一个安全的地方，以防止诸如火灾等物理性破坏性攻击的威胁。[MP-5: 媒体传输；PE-18: 系统组件位置；SC-28: 静态信息保护]

1.  在将可移动媒体或设备连接到组织的系统或网络之前，进行测试并扫描是否存在恶意软件的证据。[MP-6: 媒体清理；SC-41: 端口和 I/O 设备访问]

1.  进行风险评估，以确定如果数据和系统遭到破坏，哪些将对组织造成最大危害。对这些系统和数据采取高级预防措施并安装特殊保护。[RA-3: 风险评估；SA-20: 关键组件的定制开发]

1.  构建防御机制，如恶意代码保护和引爆室，以寻找破坏性攻击能力的证据。[SC-44: 引爆室；SI-3: 恶意代码保护]

## 总结

在这一章中，我们回顾了火攻以及忍者们如何秘密携带火种并将火作为武器的各种技巧。我们还分析了几起具有广泛影响的网络攻击，并讨论了应对这些攻击的方法。我们还更广泛地探讨了网络威胁如何像火攻的数字双胞胎一样发挥作用。

在下一章中，我们将详细讨论忍者如何与外部盟友沟通与协调，以发起火攻。忍者通过多种巧妙的方式实现了隐蔽的指挥和控制（C2）通信，这些方式与一些恶意软件用来执行 C2 通信的方法相似。
