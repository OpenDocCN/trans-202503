# 第十三章：虫间谍

制造一个*minomushi*，或者说虫间谍（即内部威胁），利用敌方。

> **Minomushi**（虫间谍）是指那些为敌方效力，但最终转变为为你方效力的忍者。因此，这个间谍就像是在敌人肚子里的虫子，从内部吞噬敌人。
> 
> —《万善集解》, 四人 I ^(1)

《万善集解》从不吝啬生动的形象描绘，描述了一种名为“肚腹中的虫子艺术”（或“虫间谍”）的伪装渗透技术，要求忍者招募敌方内部人员为己方执行任务。这种招募需要高超的情商。忍者必须选择合适的目标；创造接近目标的机会；并悄悄分析目标对其雇主、个人价值和秘密野心的看法。^(2) 这卷书警告，候选人选拔必须极为小心，因为招募错误的人员成为虫间谍——即*minomushi*——可能会严重影响忍者的任务。为了提高成功招募的几率，忍者发展出了八种可能的虫间谍原型：^(3)

+   曾因过去的过错受到现任雇主不公或过度惩罚的个人，并因此心生深沉的怨恨。

+   尽管出生在优渥家庭或具有出色能力，但却被安排在低于自己地位的职位，且未曾获得晋升，感到自己被低估的员工。

+   习惯性超额完成任务的员工，他们持续为雇主交出优秀的业绩，却只获得象征性的职位、少量奖金或不足的加薪，甚至什么也没有。由于他们的贡献被轻视，他们认为如果是由其他雇主雇佣，他们的职业生涯可能会更加丰硕。他们还认为组织做出的决策愚蠢，因为领导层更看重马屁精和政治人物，而非那些有实际成就的忠诚员工。

+   聪明且有才华的员工，但与领导层关系不好。因为这些人容易招致不满，并被视为麻烦，他们的雇主会给他们低级职位，为解雇铺路，并让他们感到不受欢迎。

+   在自己领域内的专家，他们的雇主利用他们的忠诚誓言或家庭责任等情况，把他们困在较低职位。

+   个人的工作职能与他们的身份、家庭需求或信仰直接对立，导致他们后悔所从事的工作。

+   贪婪且狡诈的人，缺乏忠诚或道德指南针。

+   因过去的不端行为而声名狼藉的“黑羊”员工，因地位降低而感到沮丧。

在选择了潜在的*蟋蟀*之后，忍者会制定计划，主动接近并与目标建立关系。《万川集海》指导忍者表现得富有，并通过金钱赢得目标的好感；利用友好的玩笑话了解他们的喜好、信仰和幽默感；并通过轻松的调侃巧妙地发现目标的内心想法。如果目标的性格符合“蠕虫代理人”的典型特征，那么忍者会通过承诺财富、声望以及帮助实现秘密雄心——或者更直接地，提供酒精和性——来利用这些*蟋蟀*特征，以此换取目标背叛其雇主。^(4)

在利用新转变的*蟋蟀*之前，忍者被建议获得背叛誓言，收集担保资产以确保蠕虫代理人的忠诚，并建立信号和其他操作安全（OPSEC）。^(5)

本章将回顾内鬼威胁。我们将对比心怀不满的员工和被招募的内鬼威胁。我们还将讨论组织用来应对内鬼威胁的检测和威慑方法，以及一种新的、量身定制的防范措施——受到忍者卷轴启发——旨在积极防止有风险的员工成为内鬼威胁。最后，一项思维练习将要求你设想哪些前任和/或现任员工可能成为内鬼威胁，并检查你与他们的互动方式。

## 内鬼威胁

*内鬼威胁*是指员工、用户或其他内部资源，其行为可能对组织造成损害——无论是否故意。由于他们并非故意进行恶意行为，一个不幸的员工如果打开了钓鱼邮件并让其工作站感染了恶意软件，就是一个无意的内鬼威胁。另一方面，一个心怀不满的员工故意将病毒释放到组织内部，无论是出于个人原因还是为对手效力，都构成了有意的内鬼威胁。由于内鬼威胁是合法的、有权限的用户，拥有认证、特权和访问信息系统与数据的权限，因此它们是网络安全中最难以防范的问题之一。

许多组织依靠技术控制和威胁猎手进行内鬼威胁的早期检测。技术检测技术——如行为启发式——可以帮助识别潜在的内鬼威胁。警觉的网络防御者和猎手可能会调查那些做出不符合常规或不当行为的用户，包括将所有文件下载到外部便携媒体、搜索与工作无关的敏感或专有数据、在周末或假期登录进行非优先工作的任务、访问蜜罐系统和明确标记为受限访问的文件，或下载和使用类似黑客的工具执行超出其工作职能的操作。

但技术控制只是一个稳固防御策略的组成部分，即使对于成熟的组织也是如此。通过检查参考资料、进行背景调查，包括犯罪记录和财务历史的审查；以及筛查毒品使用情况，雇主可以验证员工是否容易受到不正当影响。人力资源部门在识别潜在的内部威胁方面起着关键作用。一些人力资源部门会进行年度员工调查以识别潜在问题，而其他部门则主动解雇有风险的员工或根据问题调查结果推荐撤销某些访问权限。不幸的是，许多组织仅采取最低限度的预防措施。大多数信任他们的员工，另一些则忽视这一问题，还有一些则接受内部威胁的风险，以保证业务运营的顺利进行。

更加积极应对内部威胁的实体，例如国防行业和情报界的组织，实施先进的检测和预防措施，如测谎仪、常规安保检查、反间谍计划、分隔控制以及严厉的法律惩罚——更不用说尖端的技术控制。然而，即使是这些控制措施，也无法保证所有内部威胁的恶意行为，尤其是那些得到复杂对手支持的威胁，会被及时检测和预防。它们还带来了独特的实施和运营挑战。

## 应对内部威胁的新方法

聚焦于审查员工并试图在他们犯错时捉住他们的组织，往往是在为时已晚。更为积极的做法是，培养一个不会制造内部威胁滋生条件的工作环境。以下一些建议是针对修复特定内部威胁类型的。

1.  *制定检测和缓解技术。* 检查你所在组织使用的产品和技术控制，以识别和缓解内部威胁。开展员工培训和意识提升会议，审查安全事件报告，并进行红队演练，如钓鱼测试，以识别重复发生的非故意内部威胁。然后，通过实施额外的安全控制措施，训练、警告并缓解这些个人的风险，例如，你的安全团队可以通过严格的控制和政策，限制员工执行内部威胁行为的能力和机会。一些例子包括：

    +   强制执行一个策略，禁止在系统上启用或执行宏。

    +   配置所有电子邮件以纯文本形式接收，禁用超链接。

    +   默认情况下，对所有外部电子邮件附件进行隔离。

    +   禁用网页浏览，或者仅通过一个与组织内网不相连的隔离互联网系统提供浏览功能。

    +   禁用某些系统上的 USB 端口和外部媒体驱动器。

    监控有意的内部威胁需要先进的检测技术和能够进行欺骗与保密的技术。根据适当的组织威胁建模和风险评估来选择这些技术。

1.  *实施基于人力资源的反-*minomushi* 政策。* 在实施和测试之前的技术控制和检测技术后，解决人员控制问题。确保人力资源部门保持当前员工、前员工和候选人的记录，其中包括*minomushi* 个人特征的指标。在候选人筛选、绩效评审和离职面谈时提出尖锐问题，以捕捉这些诊断信息。

1.  *特别注意防止造成* minomushi *员工的情况。* 你的人力资源团队应该考虑以下全公司范围的政策，按八种*minomushi* 原型的顺序呈现：

    +   审查员工纪律处分程序，防止对员工进行不公平或过度的惩罚——无论是真实的还是感知上的。要求员工和申请者披露是否有家庭成员曾在贵公司工作。鼓励人力资源评估员工是否认为对他们的纪律处分不公平或过度，然后共同寻找解决方案，以缓解员工的敌意。

    +   定期分发员工调查，评估士气并识别低级员工中未被充分利用的人才。与员工和管理层进行透明的面谈，以确定：某员工是否准备好晋升、是否因为近期成就未被认可，或者是否需要成长某些特定的技能；公司是否有合适的职位来晋升他们，或是否有预算给他们加薪；或者某些员工是否认为自己比同事更优秀或更有价值——是否需要进行现实检查。与管理层合作，考虑如何缓解员工的不满，并纠正组织并非一个按能力分配奖赏的环境的认知。

    +   作为绩效评审的一部分，征求同事的反馈，识别出哪些管理者被低级员工认为最有价值，以及哪些员工认为自己没有得到应有的认可。通过奖励和/或让员工看到公司领导决策的透明度来解决这些不满。

    +   鼓励领导亲自指导那些聪明但社交笨拙的员工， discreetly 告诉他们自己是如何被看待的，目的是帮助这些员工感受到更多的社交接受，而不是孤立。

    +   审查并取消那些阻碍顶尖人才的公司政策。这些政策可能包括竞业禁止协议、不公平地占用员工的知识产权、以及不充分的绩效奖金或留任激励。尽管这些政策旨在保护公司，但可能会产生相反的效果。

    +   对当前员工和应聘者进行开源分析，了解他们是否公开表达过强烈的观点，或是否在贵组织的使命上存在利益冲突。如果有，重新安排这些员工到更能让他们的个人价值观与工作产生共鸣的岗位，或便于他们离开组织。

    +   开发角色分析技巧，寻找员工和应聘者可能容易受贿的迹象。考虑降低这些员工的系统访问权限和特权等级，从而减少他们对对手的利用价值。

    与高风险*迷之虫*状况的员工密切合作。为他们提供额外的资源、时间和动力，帮助他们克服可能的怨恨，把握个人成长机会，并培养自尊心。最小化或停止强化不良记忆的组织行为，或继续因过去的过错惩罚员工。

## 推荐的安全控制措施和缓解措施

在相关情况下，提出的建议与 NIST 800-53 标准中的适用安全控制措施一同呈现。每项建议都应在考虑招募内鬼威胁的背景下进行评估。（更多信息，参见 PM-12：内鬼威胁程序。）

1.  让 SOC 与人力资源私下合作，关联可能具有*迷之虫*特征的潜在内鬼威胁的信息。SOC 应更加密切地监控、审计和限制这些高风险个体。SOC 还可以与人力资源合作，建立内鬼威胁蜜罐——例如，网络共享中的文件写着“限制：禁止打开”——以识别执行与内鬼威胁一致的行为的员工。[AC-2: 账户管理 | (13) 禁用高风险个体的账户; AU-6: 审计审查、分析与报告 | (9) 与非技术来源信息的关联; SC-26: 蜜罐]

1.  使用你自己的账户在你已知不会对组织造成危害的文件和系统上执行内部威胁行为（不需要红队能力）。行为可能包括修改或删除数据、插入虚假数据或窃取数据。记录你的账户可以访问的系统和数据，然后使用特权账户如管理员或 root 账户执行恶意的特权行为。例如，你可以创建一个不存在的员工姓名的管理员用户。询问你的 SOC 是否能够发现你在特定日期范围内窃取、删除或修改的数据，以测试你的 SOC 是否能够正确审计你所执行的特权操作。[AC-6: 离开特权 | (9) 审计特权功能使用; CA-2: 安全评估 | (2) 专门评估]

1.  培训员工识别*蚂蚁虫*特征和内部威胁行为。让员工能够轻松且匿名地报告潜在的*蚂蚁虫*情况，类似于他们报告钓鱼欺诈的方式。将内部威胁意识训练纳入定期安全培训中。[AT-2: 安全意识 | (2) 内部威胁]

## 汇报

在本章中，我们回顾了忍者技巧，通过招募目标组织内的脆弱人员执行恶意行动。我们详细介绍了八种内部威胁候选人原型，并讨论了目前组织使用的各种内部威胁检测和保护程序。我们描述了一种基于忍者卷轴中信息的新防御方法——一种对不满员工表现出同情的策略。本章中的思维训练挑战参与者评估不仅是潜在的内部威胁，还要反思自己对同事的行为；它鼓励他们思考采取更合作的方式来应对潜在的内部威胁。

在下一章中，我们将讨论长期内部人员：在加入贵组织之前就已被对手招募的员工。而且，由于长期内部人员故意隐藏对组织的任何怨恨或恶意，因此识别他们更加困难。
