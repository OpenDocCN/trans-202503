# **数字取证概览**

![Image](img/common01.jpg)

本章概述了阅读本书其他章节时假设的数字取证背景知识。对于一些读者来说，这将是一个介绍；而对于其他读者，则是一个回顾。这里描述了数字取证的历史以及未来十年的一些预期。当前的趋势和挑战也被讨论，重点是操作系统的数字取证分析。还涵盖了计算机取证分析的基本原则和行业最佳实践。

### 数字取证历史

了解数字取证领域的历史背景，直至今天，将有助于解释该领域如何演变，并为一些在取证行业中面临的问题和挑战提供额外的背景信息。

#### *千年虫前*

与其他科学领域相比，数字取证的历史相对较短。最早的计算机相关取证工作始于 1980 年代，那时的从业者几乎全是来自执法或军事组织。1980 年代，家用计算机和拨号电子公告板服务的增长引发了执法机构对计算机取证的早期兴趣。1984 年，FBI 开发了一个开创性的计算机证据分析程序。此外，滥用行为和基于互联网的攻击的增加促成了 1988 年首个计算机紧急响应小组（CERT）的成立。CERT 由美国国防高级研究计划局（DARPA）成立，位于匹兹堡的卡内基梅隆大学。

1990 年代，互联网接入经历了重大增长，个人计算机进入家庭并变得普及。在这段时间里，计算机取证成为执法机构的主要话题。1993 年，FBI 举办了首届国际执法机关计算机证据会议，并且到 1995 年，国际计算机证据组织（IOCE）成立，并开始提出标准建议。“计算机犯罪”的概念不仅在美国成为现实，而且在国际间也得到了广泛认可。1999 年，英国首席警察官协会为英国执法机构处理计算机证据制定了良好的实践指南。在 1990 年代末期，第一款开源取证软件——《验尸官工具包》由 Dan Farmer 和 Wietse Venema 创建，这款软件发展成为今天的 Sleuthkit。

#### *2000–2010*

千年之交之后，多个因素增加了对数字法医学的需求。2001 年 9 月 11 日的悲剧对世界如何看待安全和事件响应产生了巨大影响。安然公司和安达信会计丑闻导致了美国萨班斯-奥克斯利法案的制定，旨在通过提高企业披露的准确性和可靠性来保护投资者。该法案要求组织必须具备正式的事件响应和调查流程，通常包括某种形式的数字法医学或证据收集能力。知识产权问题的增长也对民间组织产生了影响。互联网欺诈、钓鱼攻击以及其他与知识产权和品牌相关的事件进一步推动了调查和证据收集的需求。点对点文件共享（从 Napster 开始），以及数字版权法案《数字千年版权法》的出台，导致了对调查数字版权侵权案件的需求增加。

自 2000 年以来，数字法医学界在将自己转变为科学学科方面取得了巨大进展。2001 年 DFRWS 会议为法医界提供了重要的定义和挑战，并将数字法医学定义如下：

使用科学派生和验证的方法来保护、收集、验证、识别、分析、解释、记录和展示来自数字源的数字证据，目的是促进或推进重建被认为是犯罪的事件，或帮助预测被证明对计划中的操作具有破坏性的未经授权的行为。^(1)

在法医界确定了其范围和目标，致力于成为公认的科学研究领域的同时，实践者层面的标准、指南和最佳实践程序也在逐步规范化。数字证据科学工作组（SWGDE）规定了定义和标准，包括执法机关的标准操作程序要求。2000 年法国 IOCE 会议致力于通过指南和检查表为执法实践者规范化程序。第 13 届国际刑警法医学科学研讨会（同样在法国）概述了参与数字法医学的各方要求，并为政府和执法部门制定了一套全面的标准和原则。2001 年《第 13 届国际刑警法医学科学研讨会纪要》提到，美国司法部发布了详细的执法人员应急指南（《电子犯罪现场调查：应急人员指南》），国家标准与技术研究院（NIST）计算机法医学工具测试项目（CFTT）编写了第一版*磁盘成像工具规范*。

#### *2010–2020*

自 2010 年以来，多个事件促使数字取证的焦点转向调查和收集来自网络攻击和数据泄露的证据。

Wikileaks (*[`www.wikileaks.org/`](https://www.wikileaks.org/)*) 开始发布泄露的材料，包括来自美国政府的视频和外交电报。匿名者因分布式拒绝服务（DDoS）攻击和其他黑客活动而声名狼藉。LulzSec 入侵并泄露了 HBGary Federal 及其他公司的数据。

高级持续性威胁（APT）恶意软件的调查成为业界的主要话题。政府使用恶意软件对其他政府和私人行业进行间谍活动的程度被公之于众。Stuxnet 蠕虫，特别是针对伊朗核计划中控制系统的 SCADA 系统的攻击被发现。Mandiant 发布了对 APT1 的调查报告，APT1 是中国军队的网络战争单位。爱德华·斯诺登泄露了一大批文件，揭示了 NSA 的黑客活动范围。意大利黑客团队的泄露事件揭示了一个向政府、执法机构和私营公司出售的专业漏洞利用市场。Vault7 泄露提供了关于 CIA 黑客活动的技术信息。

主要的数据泄露事件成为了私营企业的关注点，其中包括索尼、Target、JP 摩根大通、Equifax、Anthem 等公司的数据盗窃和信用卡盗窃事件。全球银行业面临着银行恶意软件（如 Zeus、Sinowal/Torpig、SpyEye、GOZI、Dyre、Dridex 等）的快速增长，这些恶意软件成功地瞄准了银行客户，进行金融欺诈。最近，涉及赎金的攻击变得流行（如勒索软件、比特币 DDoS 攻击等）。

这一系列的黑客行为、攻击和滥用行为使得数字取证的重点扩展到了网络流量捕获与分析以及感染系统的实时系统内存获取等领域。

在 2010 年代末期，罪犯开始转向互联网社交工程。由于硬件制造商和操作系统供应商越来越注重安全默认设置，加之云计算的兴起使得安全控制交由云服务提供商，因此技术漏洞利用变得更加具有挑战性。然而，利用人类的信任仍然非常有效，尤其是在网络欺诈方面。诸如商业邮件诈骗（BEC）和伪装成 CEO 的欺诈行为变得越来越普遍。我发表了一篇名为《金融科技取证：金融技术中的刑事调查与数字证据》的论文^(2)，详细描述了这一现象。

#### *2020 年及以后的发展*

值得思考的是数字取证的未来，包括数字取证分析的相关性以及 Linux 系统的影响。

物联网（IoT）设备的增加，加上近期硬件漏洞，将推动硬件取证分析的需求。犯罪现场正变成大量电子设备的集合，所有设备都有少量本地存储以及更大规模的云存储。这些物联网设备中的许多运行着嵌入式 Linux 系统。

在未来的十年里，我们可能会看到对人类的社交工程攻击持续增加。再加上人工智能的普及，“深伪”技术有可能成为下一代社交工程手段。这些音视频伪造将精细到让人们难以察觉它们是假的。

COVID-19 健康危机导致在线会议、会议和人际互动剧增。同时，也促使了更多员工接受远程工作。视频会议和员工远程访问成为社会常态，这推动了音视频取证分析的需求。

对 COVID-19 感染的恐惧也加速了从实物货币（纸币和硬币）向无现金支付方式（如非接触支付）和移动支付的转变，成为犯罪分子探索新型金融欺诈手段的一个有吸引力的目标。

云服务将继续取代企业和家庭中的本地 IT 基础设施。云服务提供商将成为犯罪分子的目标，他们能够在不被云租户知情的情况下访问虚拟基础设施。大量云服务提供商将 Linux 系统作为其首选平台。

新的*金融技术（FinTech）*，例如使用移动设备、新的支付系统（如 GNU Taler）、加密货币（如比特币）、区块链账本等，需要分析其中的欺诈、洗钱和其他金融犯罪。

### 取证分析趋势和挑战

数字取证领域由于技术和犯罪行为的变化与进步而不断发展。这促使了对新取证分析技术的需求。

#### *证据的大小、位置和复杂性发生变化*

嵌入式 Linux 系统，特别是物联网设备，正在快速增长。此外，Linux 桌面操作系统正变得与 Windows 和 Mac 系统一样易于使用，且安全性和隐私问题较少。基于 Linux 的廉价上网本和平板电脑在市场上越来越普遍。Linux 的使用增长促进了对 Linux 取证分析技能的需求。

访问使用锁定技术（受信计算、安全元素和保护区）、加密和嵌入式硬件的基于 Linux 的设备正在为分析带来挑战。在某些情况下，硬件取证（如芯片提取、JTAG 等）可能是从嵌入式设备中提取数据的唯一方法。

客户端云计算的兴起（VDI 技术）导致了基于 Linux 的瘦客户端设备的使用增加。我们熟知的通用操作系统正在转向一种简单的客户端设备，仅提供云环境的窗口，并作为本地硬件的桥梁。即使是“登录”这一传统概念也正在消失，因为与远程云的永久连接已经成为常态。

另一个影响法证分析的变化是存储容量。目前，18TB 的消费级硬盘并不罕见，企业级固态硬盘（SSD）的容量已超过 50TB。这些大容量硬盘挑战了传统的数字法证分析过程。

另一个挑战是犯罪现场发现的或涉及的众多存储设备。曾经是家庭使用的单一计算机，如今已经变成了各种各样的计算机、笔记本电脑、平板电脑、手机、外部硬盘、USB 闪存驱动器、存储卡、CD 和 DVD，以及物联网设备，这些设备都存储着大量数据。挑战在于如何找到并扣押所有相关的存储介质，并以一种使所有数据都能同时被法证分析工具访问的方式获取图像。

证据转移到云端的趋势也带来了多个挑战。在某些情况下，终端设备上可能只保留数据的缓存副本，而大量数据则存储在云服务提供商那里。客户端/用户与云提供商之间的互动将涉及诸如访问或网络流量日志等元数据。如果数据存储在超出法律管辖区的地方，执法机构收集这些数据可能会变得复杂；而对于没有法证支持条款的外包云服务提供商来说，私营组织在收集这些数据时也可能面临困难。

物联网（IoT）是一个快速发展的趋势，预计将对法医学界带来挑战。各种小型的互联网连接电子设备（如健康监测器、时钟、显示器、安全摄像头等）通常不包含大量存储空间，但它们可能包含有用的遥测数据，例如时间戳、位置信息、运动数据、环境条件等。识别和访问这些数据最终将成为法证证据收集的标准部分。

可以说，当今法医调查员面临的最困难挑战之一是专有设备的趋势和加密技术的使用。个人计算机架构和磁盘设备历来是开放的，并且有充分的文档支持，从而促使了标准法医工具的创建，用以访问数据。然而，专有软件和硬件的使用增加，加上加密数据的出现，使得法医工具的开发变得困难。尤其是在移动设备领域，设备可能需要先被“越狱”（实际上是进行黑客攻击）才能访问更低级的文件系统块。

#### *多管辖区的方面*

网络犯罪的国际跨境性质是法医调查员面临的另一个挑战。假设一个位于 A 国的公司成为了 B 国攻击者的目标，攻击者通过 C 国的中继代理服务器入侵基础设施，进而通过 D 国的外包合作伙伴进行攻击，并将被盗数据传输到 E 国的存储区域。在这种情况下，涉及了五个不同的国家，这意味着可能需要协调五个不同的执法机构，并且至少需要五家公司在五个不同的法律管辖区内进行合作。今天，这种跨国情形并不罕见，事实上，它相当常见。

#### *行业、学术界和执法机构的合作*

网络犯罪活动日益复杂和先进，促使了情报收集、证据获取和调查协调的增加合作与协作。

行业同行之间的这种合作可以看作是在共同对抗敌人（例如银行业对抗银行恶意软件、互联网服务提供商行业对抗 DDoS 攻击和垃圾邮件等）。合作也已经跨越了公私部门的界限，执法机构与行业合作，共同打击公共–私人伙伴关系中的犯罪活动。这种多方面的合作创造了识别、收集和转移数字证据的机会。挑战在于确保私人合作伙伴了解数字证据的性质，并能够满足执法部门在公共部门中的标准。这将增加基于私营部门收集的证据成功起诉的可能性。

另一个与工业界和执法部门合作的群体是学术研究社区。这个社区通常由大学的法医实验室和安全研究部门组成，它们深入研究计算机犯罪的理论和高度技术化的方面。这些研究人员能够花时间分析问题并深入了解新的犯罪手段。在某些情况下，他们能够为执法部门提供帮助，在标准的法医工具无法提取所需证据时。这些学术团体还必须理解管理和保存数字证据的需求和期望。

### 死后计算机法医分析原则

作为一门科学学科，数字取证的原则受到多个因素的影响，包括正式定义的标准、同行评审的研究、行业规章和最佳实践。

#### *数字取证标准*

与法医学采集相比，针对通用操作系统分析的标准较少。操作系统法医学分析过程往往由法医实验室的政策和要求以及法医分析软件的能力驱动。没有国际标准组织像 NIST 的 CFTT 那样定义如何执行操作系统法医分析。由于通用操作系统种类繁多、复杂且变化快速，难以定义出一种通用的标准程序。

#### *同行评审的研究*

数字取证标准和方法的另一个来源是同行评审的研究和学术会议。这些资源提供了数字取证研究社区中的最新进展和技术。基于同行评审的科学研究的法医工作在新方法和新技术的应用上尤为重要，因为这些方法和技术可能在法庭上未经验证。

存在多个国际学术研究社区，它们为知识体系的发展做出了贡献。*数字调查*^(3)是取证领域一个重要的科学研究期刊，自 2004 年起发布该领域的学术研究。*数字调查*最近加入了法医学国际期刊（FSI）系列，标志着数字取证被纳入传统的法医学范畴。一个数字取证学术研究会议的例子是数字取证研究研讨会（DFRWS）。^(4) DFRWS 于 2001 年在美国成立，旨在创建一个来自学术界、工业界和公共部门的数字取证专家社区。DFRWS 欧洲分会于 2014 年启动，DFRWS 亚太分会（APAC）则于 2021 年成立。DFRWS 的全球扩展反映了数字取证作为一门国际科学学科的成长。

完整披露：我是 FSI *数字调查*期刊的编辑，并且参与了 DFRWS 欧洲分会的组织委员会。

#### *行业法规和最佳实践*

行业特定的规定可能会对数字证据的收集提出额外的要求（或限制）。

在私营部门，行业标准和最佳实践由各种组织和行业团体制定。例如，信息保障咨询委员会提供了*数字调查和证据的董事和公司顾问指南*。

其他来源包括法律和监管机构强制执行的标准和流程；例如，美国《萨班斯-奥克斯利法案》对证据收集能力的要求。

一些数字证据要求也可能取决于行业。例如，某地区的医疗保健规定可能会指定数据保护要求，并包括在发生数据泄露时的各种取证响应和证据收集流程。电信提供商可能会有日志保存和执法机关访问基础设施通信的规定。银行监管机构也会规定与欺诈（特别是网络欺诈）相关的数字证据要求和标准。一个很好的例子是新加坡金融管理局（MAS），^(5)提供了详细的银行社区标准，涵盖安全和事件响应等领域。

另一个影响因素是日益增长的网络保险领域。未来几年，保险公司将需要调查和验证网络保险索赔。分析的正式标准可能由保险监管机构推动，并有助于规范分析过程。

最近网络攻击，特别是勒索软件的增加，正在同时针对多个行业（金融、健康等）。标准化证据收集和分析的需求将在未来几年获得监管机构的更多关注。

### 取证中的特殊话题

本简短部分涵盖了几项在本书其他部分不太适合的特殊话题，但值得提及。

#### *取证准备*

*取证准备*的概念是指在发生事件时提前为执行数字取证采集和分析做好准备。这通常适用于预见到滥用和攻击自己基础设施的组织。取证准备可能是监管机构（如卫生、金融等部门）或其他商业行业立法（如《萨班斯-奥克斯利法案》）的要求。取证准备也可能由行业标准和最佳实践或组织自身的政策（由其风险和安全职能推动）驱动。

取证准备可能包括定义系统配置和日志要求、组织的取证能力（例如，取证团队或外包合作公司）、制定执行取证调查和/或收集数字证据的流程，以及安排外部支持的保留合同。对于选择拥有内部数字取证能力的大型组织，这还包括员工培训并确保拥有足够的工具。

取证准备通常适用于拥有自己 IT 基础设施的组织，这些组织能够决定准备工作。在执法机构的情况下，刑事调查过程中没收的 IT 基础设施并不在事先控制或了解范围内。公共部门的取证实验室所拥有的取证准备更多是指员工培训、工具和流程，以应对各种意外的数字取证工作。

#### *反取证*

*反取证*或*反取证技术*的概念在近年来已成为一个引起关注和重视的话题。数字取证领域的大部分研究和从业工作是公开可得的，这意味着那些有兴趣保护自己并隐藏犯罪活动的罪犯可以接触到这些信息。

反取证活动并不是新鲜事，自计算机入侵开始以来就一直存在。这是一场猫鼠游戏，类似于杀毒软件社区在尝试检测和防止恶意软件和病毒活动时面临的挑战。

一些反取证活动是通过合法的安全研究发现的。其他反取证活动则在犯罪分子之间的地下网络中共享（尽管这些方法通常不会隐藏太长时间）。数字取证社区对潜在反取证活动的了解越多，就越有助于应对。如果反取证方法的信息是公开的，数字取证研究人员可以开发工具来检测或防止这些活动。这将提高数字证据的可靠性和完整性，并保护法院决策的有效性。

传统的反取证技术包括加密驱动器上的数据或使用隐写术来隐藏证据。犯罪分子所拥有的系统采用“反取证准备”措施，以确保他们的系统不会记录并保存调查人员可能感兴趣的证据痕迹。

反取证的技术示例包括信息的操控或销毁，如日志文件的篡改，或时间戳的篡改，使得时间线不可靠。例如，像*timestomp*这样的程序可以将所有文件和目录的时间戳重置为零（即 Unix 纪元，1970 年 1 月 1 日）。清理工具和擦除工具是试图销毁硬盘上操作系统和应用程序活动证据的工具（不可逆地删除缓存、历史记录、临时文件等）。目前，一些反取证对策正在被开发中。一个很好的 Linux 示例是 systemd 日志，它提供了前向安全封存（FSS），可以检测日志的篡改。

在网络领域，反取证的示例包括欺骗、转发、匿名化或动态生成的网页内容。例如，针对性的网络钓鱼网站可能会在特定 IP 地址范围内查看时显示无害的内容，试图阻止被检测或关闭。

恶意软件中的代码混淆（例如恶意 JavaScript 或二进制可执行文件）通常用于阻碍调查人员的逆向工程工作。恶意代码还可能设计为在特定条件出现时保持潜伏。例如，如果计算机是虚拟机（表示可能存在反恶意软件系统），它可能会拒绝安装，或者它可能会根据地理区域的不同表现出不同的行为。

法医调查人员在分析和解读数字证据时，必须保持一定程度的怀疑态度。可以使用加密验证或佐证来源来提高数字证据的真实性和可靠性。在本书中，将会在适当的地方提到潜在的反取证风险。
