## 第一章：**数字取证概述**

![image](img/common-01.jpg)

一些关于数字取证领域的历史背景，帮助解释该领域如何发展，并为取证行业中专业人士所面临的一些问题和挑战提供额外的背景信息。

### 数字取证历史

在这里，我将讨论现代数字取证作为一门科学学科的发展。

#### *Y2K 之前*

与其他科学学科相比，数字取证的历史较短。最早的与计算机相关的取证工作始于 1980 年代，当时的从业者几乎全来自执法机构或军事组织。1980 年代，家用计算机和拨号 BBS 服务的兴起，激发了执法界对计算机取证的早期兴趣。1984 年，FBI 开发了一个开创性的程序，用于分析计算机证据。此外，滥用和基于互联网的攻击的增加促成了计算机应急响应小组（CERT）的成立，该小组于 1988 年由国防高级研究计划局（DARPA）创建，并位于匹兹堡的卡内基梅隆大学。

1990 年代，互联网接入的大规模增长使得家用个人计算机变得普及。在此期间，计算机取证成为执法机构中的一个重要话题。1993 年，FBI 主办了第一次关于计算机证据的国际会议，并且 1995 年，国际计算机证据组织（IOCE）成立并开始提出标准建议。“计算机犯罪”的概念已经成为现实，不仅在美国，而且在全球范围内。1999 年，英国警察总监协会（ACPO）为处理计算机证据的英国执法人员创建了一个良好实践指南。同时，在 1990 年代末期，第一个开源取证软件——《验尸官工具包》由 Dan Farmer 和 Wietse Venema 开发。

#### *2000–2010*

千年之交后，多个因素增加了对数字法医的需求。2001 年 9 月 11 日的悲剧对全球安全和事件响应的看法产生了巨大的影响。安然和安达信会计丑闻导致了美国《萨班斯-奥克斯利法案》的制定，该法案旨在通过提高公司披露的准确性和可靠性来保护投资者。该法案要求组织必须有正式的事件响应和调查流程，通常包括某种形式的数字法医或证据收集能力。知识产权（IP）问题的增长也对民间组织产生了影响。网络欺诈、网络钓鱼及其他与知识产权和品牌相关的事件进一步增加了对调查和证据收集的需求。点对点文件共享（始于 Napster）以及《数字千年版权法案》（DMCA）的出台，导致了对数字版权侵权调查的需求增加。

自 2000 年以来，数字法医界在将其转变为一门科学学科方面取得了巨大进展。2001 年的 DFRWS 会议为法医界提供了重要的定义和挑战，并对数字法医进行了如下定义：

利用科学推导和验证的方法，保存、收集、验证、识别、分析、解释、记录和呈现来自数字源的数字证据，以便促进或进一步重建已发现的犯罪事件，或帮助预测已证明对计划操作具有破坏性未经授权的行为。^(1)

当法医界确定其范围和目标，力求成为一个公认的科学研究领域时，实践层面的标准、指南和最佳实践程序也在不断规范化。数字证据科学工作组（SWGDE）明确了定义和标准，包括要求执法部门制定标准操作程序（SOP）。2000 年在法国举行的国际刑事侦查组织（IOCE）大会推动了通过指南和检查清单来规范执法人员的程序。第 13 届国际刑警组织法医科学研讨会同样在法国召开，概述了参与数字法医的各方要求，并为政府和执法部门制定了一套全面的标准和原则。美国司法部发布了详细的执法人员应急响应指南（美国司法部《电子犯罪现场调查：应急响应人员指南》），国家标准与技术研究院（NIST）则开展了计算机法医工具测试项目（CFTT），编写了首个《磁盘镜像工具规范》。

在过去的十年里，几本同行评审的学术期刊相继推出，发布日益增加的知识内容。*《国际数字证据期刊（IJDE）》*于 2002 年创办（并于 2007 年停刊），*《数字调查：国际数字取证与事件响应期刊》*则于 2004 年创办。

#### *2010 年至今*

自 2010 年以来，一系列事件将焦点转向了对网络攻击和数据泄露的调查与证据收集。

WikiLeaks (*[`www.wikileaks.org/`](http://www.wikileaks.org/)*) 开始发布美国军方泄露的材料，包括视频和外交电报。匿名者因分布式拒绝服务（DDoS）攻击和其他黑客活动而声名狼藉。LulzSec 破坏并泄露了 HBGary Federal 及其他公司的数据。

高级持续性威胁（APT）恶意软件的调查成为行业中的一个重要话题。政府使用恶意软件对其他政府和私人企业进行间谍活动的程度被公开。特别是，针对 SCADA 系统的 Stuxnet 蠕虫被发现，尤其是针对伊朗核计划中的控制系统。Mandiant 发布了对 APT1（中国军队的网络战单位）的调查报告。爱德华·斯诺登泄露了大量文件，揭示了美国国家安全局（NSA）黑客活动的广泛程度。来自意大利公司 HackingTeam 的数据泄露揭示了为政府、执法机构和私营企业出售的专业漏洞市场。

大型数据泄露事件引起了私营部门公司的关注，因为信用卡和其他数据被从索尼、塔吉特、摩根大通、安盛等公司窃取。全球银行业面临银行恶意软件（如 Zeus、Sinowal/Torpig、SpyEye、Gozi、Dyre、Dridex 等）大幅增长的局面，这些恶意软件成功地攻击银行客户，实施金融诈骗。最近，勒索攻击变得流行起来（如勒索软件、比特币 DDoS 攻击等）。

这种多样化的黑客攻击和滥用行为扩大了数字取证的研究范围，涵盖了网络流量捕获与分析以及感染系统的实时系统内存采集。

### 取证采集趋势与挑战

数字取证领域由于技术和犯罪行为的变化与进步而不断转型。在本节中，我将讨论近期影响传统取证存储介质获取的挑战、趋势和变化。

#### *证据的规模、位置与复杂性的变化*

影响取证镜像采集的最明显变化是磁盘容量。截至目前，消费者硬盘可存储 10TB 的数据。易于使用的 RAID 设备的普及使逻辑磁盘容量达到了更大的规模。这些大容量的磁盘给传统的取证实验室采集过程带来了挑战。

另一个挑战是犯罪现场或事件中出现的各种存储设备。曾经属于家庭使用的单一计算机，现在已经变成了五花八门的计算机、笔记本、平板电脑、手机、外部硬盘、USB 闪存盘、存储卡、CD 和 DVD 以及其他存储大量数据的设备。挑战实际上是找到并扣押所有相关的存储介质，并以一种方式获取图像，使得法医分析工具能够同时访问所有内容。

证据向云端转移的趋势也带来了一些挑战。在某些情况下，数据可能只保存在终端用户设备上的缓存副本中，数据的主要部分存储在云服务提供商处。如果数据存储在法律管辖区之外，执法机构收集这些数据可能会变得复杂；而对于私营组织而言，当外包云服务提供商的服务合同中没有法医支持条款时，收集这些数据也将是一个困难的问题。

物联网是一个快速增长的趋势，也将对法医界提出挑战。各种小型联网电子设备（健康监测器、时钟、环境显示器、安全摄像头等）通常不会包含大量存储。但它们可能包含有用的遥测数据，例如时间戳、位置和移动数据、环境条件等。识别和访问这些数据最终将成为法医证据收集的标准部分。

可以说，当今法医调查人员面临的最难的挑战之一是专有封闭设备的趋势。个人计算机架构和磁盘设备历来是开放的并且有详细的文档，使得创建标准的法医工具来访问数据成为可能。然而，专有软件和硬件的使用增加使得这一创新变得困难。这在移动设备领域尤为突出，许多设备可能需要*越狱*（实际上是被黑客入侵）才能进行较低层次的文件系统块访问。

#### *跨司法管辖区的因素*

网络犯罪的国际性质是法医调查人员面临的另一个挑战。假设 A 国的一家公司遭到 B 国攻击者的攻击，攻击者通过 C 国的代理服务器来入侵基础设施，而这家公司又通过 D 国的外包合作伙伴进行渗透，并将窃取的数据转移到 E 国的一个数据存储点。在这种情况下，涉及到五个不同的国家，意味着可能需要协调五个不同的执法机构，至少与五个不同的公司合作，跨越五个不同的法律管辖区。今天，这种多国情境并不罕见；事实上，它相当常见。

#### *行业、学术界和执法合作*

互联网犯罪活动日益复杂和先进，这促进了更多的合作与协作，以收集情报和证据，并协调调查。

竞争的行业同行之间的这种合作可以视为共同对抗一个共同的敌人（银行业对抗银行恶意软件，ISP 行业对抗 DDoS 和垃圾邮件等等）。这种合作也跨越了私营和公共部门的边界：执法机构与行业合作伙伴共同合作，打击公共私营伙伴关系（PPP）中的犯罪活动。这种多方面的合作为识别、收集和转移数字证据创造了机会。这里的挑战是确保私营合作伙伴理解数字证据的性质，并能够满足公共部门执法机关的标准。这将增加根据私营部门收集的证据成功起诉的可能性。

另一个与行业和执法机构合作的团体是学术研究社区。该社区通常由大学取证实验室和安全研究部门组成，专注于计算机犯罪和取证的理论及高度技术性方面。这些研究人员能够花时间分析问题，深入了解新的犯罪方法和取证技术。在某些情况下，他们能够为执法部门提供支持，当标准的取证工具无法提取或分析所需证据时。学术团体还必须了解管理和保存数字证据的需求和期望。

### 计算机死后取证原则

作为一门科学学科的数字取证原则受到多个因素的影响，包括正式定义的标准、同行评审的研究、行业监管和最佳实践。

#### *数字取证标准*

传统物理证据的收集和保存标准在很大程度上依赖于当地的法律管辖区。相比之下，数字证据的收集在国际环境中得到了发展，多个管辖区共同推动了研究和标准的制定。通常，硬件、软件、文件格式、网络协议和其他技术在全球范围内是相同的。因此，收集数字证据的标准和流程在不同管辖区之间更加一致。一个很好的例子是使用写保护器将磁盘连接到成像机器上，这一做法几乎在全球范围内都得到了接受。

存在多个正式的标准组织，定义了取证采集的标准。美国国家标准与技术研究院（NIST）提供了计算机取证工具测试（CFTT）计划。其目标如下所述：

国家标准与技术研究院（NIST）计算机取证工具测试（CFTT）项目的目标是通过制定通用工具规格、测试程序、测试标准、测试集和测试硬件，建立计算机取证软件工具的测试方法。

尽管 NIST 是一个以美国为中心的组织，但它的许多标准在国际上得到了采纳，或者至少对其他国家的标准机构产生了影响。

国际标准化组织（ISO）也提供了一些与数字证据相关的标准。与取证获取相关的是 ISO 关于数字证据识别、收集、获取和保存的指南：

ISO/IEC 27037:2012 提供了处理数字证据的特定活动指南，包括识别、收集、获取和保存具有证据价值的潜在数字证据。

它为个人提供了有关在整个数字证据处理过程中常见情况的指导，并协助组织在其纪律程序中以及促进司法管辖区之间潜在数字证据的交换。

各个警察部门可能有自己的标准，规定了证据收集过程。例如，在英国，首席警察官协会（ACPO）提供了*ACPO 数字证据良好实践指南*。该指南指出：

本最佳实践指南由 ACPO 犯罪业务领域制定，并于 2007 年 12 月由 ACPO 内阁首次批准。本文档的目的是为执法人员以及所有协助调查网络安全事件和犯罪的人员提供指导。它将根据立法和政策的变化进行更新，并在必要时重新发布。

本文档参考了 ACPO 等机构提出的多个其他标准和文件。

美国司法部维护*电子犯罪现场调查：第一响应者指南*。该指南的介绍部分指出：

本指南旨在协助州和地方执法人员及其他第一响应者，他们可能负责保存电子犯罪现场并识别、收集和保护数字证据。

其他一些国际组织通过创建取证工作组、委员会和社区，推动标准的制定。

#### *同行评审的研究*

另一个数字取证标准和方法的来源是同行评审的研究和学术会议。这些资源提出了数字取证研究社区中的最新进展和技术。在较新的方法和技术上，基于同行评审的科学研究进行取证工作尤为重要，因为这些方法和技术可能尚未在法庭上进行验证。

存在多个国际学术研究社区，并对知识体系做出贡献。该领域最著名的研究期刊是*《数字调查：数字取证与事件响应国际期刊》*，该期刊已发布该领域的学术研究超过十年。期刊的目标和范围如下所述：

*《数字调查学报》*涵盖了全球数字取证和事件响应的前沿发展。这本广泛引用的期刊帮助数字调查员跟上新技术、实用工具、相关研究、调查技术和处理安全漏洞的方法。从事企业、刑事和军事领域的从业者利用该期刊分享他们的知识和经验，包括以下领域的当前挑战和经验教训：

同行评审研究：解决数字调查挑战的新方法，包括对特定技术分析的应用研究，以及计算机科学在数字取证和事件响应中遇到的问题的应用。

从业者报告：调查案例研究和报告，描述从业者如何应对该领域的新兴挑战，包括改进的有效数字调查方法……

领先的数字取证学术研究会议是数字取证研究研讨会（DFRWS）。该会议自 2001 年开始，始终在美国举办，尽管在 2014 年创建了一个独立的欧洲分会。DFRWS 的明确目标如下：^(2)

• 吸引新的视角并促进思想交流，以推动数字取证科学的发展

• 促进与数字取证研究及其应用相关的学术讨论

• 邀请来自执法、军事和民间领域的经验丰富的分析师和检查员，集中研究从业者需求、多种调查环境和现实世界的可用性

• 确定构成有用研究和开发重点的核心技术

• 促进发现、解释和呈现具有决定性和说服力的证据，以应对法院和其他决策者在民事和军事环境中的严格审查

• 建立并扩展一个共同的术语表，以便社区能够使用相同的语言

• 进行定期辩论和合作活动，确保保持关注、兴趣和效能

• 维护一个由学术界和实践界专家组成的动态社区

• 提高数字取证科学的科学严谨性

• 激励下一代发明新颖的解决方案

完全披露：我是*《数字调查学报》*的编辑，并参与了 DFRWS 欧洲分会的组织委员会。

#### *行业规范与最佳实践*

行业特定的法规可能对数字证据的收集提出额外的要求（或限制）。

在私营部门，行业标准和最佳实践由各类组织和行业团体制定。例如，信息保障咨询委员会（IAAC）提供了*《数字调查与证据的董事与公司顾问指南》*。

其他来源包括法律和监管机构规定的标准和流程，例如美国《萨班斯-奥克斯利法案》中对证据收集能力的要求。

某些数字证据要求可能取决于行业。例如，某个地区的医疗行业法规可能会规定数据保护的要求，并在发生数据泄露时包括各种取证响应和证据收集流程。电信服务提供商可能会有涵盖日志保留和执法机关访问基础设施通信的规定。银行监管机构也会对数字证据的要求和标准做出规定。一个很好的例子是新加坡金融管理局（MAS），它为银行业提供了详细的安全性和事件响应领域的标准 (*[`www.mas.gov.sg/regulations-and-financial-stability/regulatory-and-supervisory-framework/risk-management/technology-risk.aspx`](http://www.mas.gov.sg/regulations-and-financial-stability/regulatory-and-supervisory-framework/risk-management/technology-risk.aspx)*)。

随着针对不同领域（如金融、健康等）的网络攻击的增加，监管机构在未来可能在影响和定义证据收集标准方面发挥更大作用。

#### *本书中使用的原则*

本书聚焦于私营和公共部门共同拥有的取证任务。示例从简化的取证获取开始，后续的示例展示了获取过程的附加功能和能力。这包括通过加密哈希和签名来保护证据、日志记录、性能、错误处理和确保获取的映像安全。我还解释了几种通过网络进行影像处理的技术，以及一些特殊话题，如磁带和 RAID 系统。

要执行取证获取，有几个先决条件：

• 目标驱动器已连接并被 Linux 内核识别。

• 已建立写入阻止。

• 已对目标驱动器进行确认并记录。

• 可以完全访问设备（HPA、DCO 和 ATA 安全功能已禁用）。

• 有足够的时间和存储容量来执行获取。

数字取证过程和工具测试在数字取证社区中有很好的文档记录，且某些要求是预期的。一个有用的资源是由 NIST 设立的 CFTT 计划。NIST 的顶级取证映像要求包括以下内容：

• 工具应制作原始磁盘或分区的位流副本或映像。

• 工具不得修改原始磁盘。

• 工具应记录输入/输出错误。

• 工具的文档应当是正确的。

这些原则在 NIST 发布的一篇论文中进行了描述^(3)，为本书的其余部分提供了基础。它们的存在是为了确保证据的完整性得到保持，并且防止或检测篡改行为。

一些研究对 ATA 接口在访问物理磁盘时的限制和局限性提出了挑战，认为在这种条件下无法实现完全获取^(4)。理论上，完全获取包括磁盘上的所有扇区以及 SSD 和闪存驱动器闪存转换层下的内存，现如今还扩展到无法通过传统块设备方法对锁定的移动设备进行成像的情况。要实现设备所有物理存储的“完全”获取变得越来越困难。对于移动设备，法医界已经区分了物理获取和逻辑获取，后者指的是复制文件和数据，而不是成像驱动器扇区。

在本书中的示例中，*法医完整性*指的是通过使用公开可用的软件工具，并根据已发布的接口规范，可靠且可重复地访问磁盘的区域。那些只能通过非公开的厂商专有工具（内部诊断、开发工具等）或使用硬件拆解（芯片去焊、头组件更换、磁盘盘片移除等）才能访问的磁盘区域，不属于本书的讨论范围。

这只是对数字取证领域的简要介绍。第一章将继续介绍存储介质技术及其与采集主机连接所使用的接口。
