## **详细内容**

**致谢**

**前言**

**简介**

为什么阅读本书？

安装 Python

书中的内容是什么？

第一部分：网络基础

第二部分：密码学

第三部分：社会工程学

第四部分：利用

第五部分：控制网络

联系

**1

设置**

虚拟实验室

设置 VirtualBox

配置 pfSense

设置内部网络

配置 pfSense

配置 Metasploitable

设置 Kali Linux

设置 Ubuntu Linux 桌面

你的第一次黑客攻击：利用 Metasploitable 中的后门

获取 Metasploitable 服务器的 IP 地址

通过后门获取访问权限

**第一部分

网络基础**

**2

使用 ARP 欺骗捕获流量**

互联网如何传输数据

数据包

MAC 地址

IP 地址

ARP 表

ARP 欺骗攻击

执行 ARP 欺骗攻击

检测 ARP 欺骗攻击

练习

检查 ARP 表

用 Python 实现 ARP 欺骗

MAC 泛洪攻击

**3

分析捕获的流量**

数据包和互联网协议栈

五层互联网协议栈

在 Wireshark 中查看数据包

分析防火墙收集的数据包

捕获 80 端口的流量

练习

pfSense

在 Wireshark 中探索数据包

**4

构建 TCP Shell 和僵尸网络**

套接字和进程通信

TCP 握手

TCP 反向 Shell

访问受害机器

扫描开放端口

利用易受攻击的服务

编写反向 Shell 客户端

编写一个监听客户端连接的 TCP 服务器

将反向 Shell 加载到 Metasploitable 服务器上

僵尸网络

练习

多客户端机器人服务器

SYN 扫描

检测 XMas 扫描

**第二部分

加密学**

**5

加密学与勒索软件**

加密

一次性密钥

伪随机生成器

不安全的块加密模式

安全块加密模式

加密与解密文件

电子邮件加密

公钥加密

Rivest–Shamir–Adleman 理论

RSA 数学原理

使用 RSA 加密文件

最佳非对称加密填充

编写勒索软件

练习

勒索软件服务器

扩展勒索软件客户端

未解决的代码

**6

TLS 和迪菲-赫尔曼算法**

传输层安全性

消息认证

证书授权机构和签名

证书授权机构

使用迪菲-赫尔曼算法计算共享密钥

步骤 1：生成共享参数

步骤 2：生成公私钥对

为什么黑客无法计算私钥？

步骤 3：交换密钥份额与随机数

步骤 4：计算共享秘密密钥

步骤 5：密钥派生

攻击迪菲-赫尔曼算法

椭圆曲线迪菲-赫尔曼算法

椭圆曲线数学

加倍与加法算法

[为什么黑客无法使用 G[xy] 和 a[xy] 来计算私钥 A?](ch06.xhtml#ch06lev17)

编写 TLS 套接字

安全客户端套接字

安全服务器套接字

SSL 剥离与 HSTS 绕过

练习：为勒索软件服务器添加加密

**第三部分

社会工程学**

**7

网络钓鱼与深度伪造**

复杂且狡猾的社会工程学攻击

伪造电子邮件

执行邮件服务器的 DNS 查找

使用 SMTP 通信

编写电子邮件伪造工具

伪造 SMTPS 电子邮件

伪造网站

创建深度伪造视频

访问 Google Colab

导入机器学习模型

练习

声音克隆

大规模钓鱼

SMTP 审计

**8

扫描目标**

链路分析

Maltego

泄露的凭证数据库

SIM 劫持

Google Dorking

扫描整个互联网

Masscan

Shodan

IPv6 和 NAT 的局限性

互联网协议第六版（IPv6）

NAT

漏洞数据库

漏洞扫描器

练习

nmap 扫描

发现

编写自己的 OSINT 工具

**第四部分

EXPLOITATION**

**9

零日漏洞的模糊测试**

案例研究：利用 Heartbleed OpenSSL 漏洞

创建利用程序

启动程序

编写客户端 Hello 消息

读取服务器响应

构造恶意心跳请求

读取泄露的内存内容

编写利用函数

整合

模糊测试

简化示例

编写自己的模糊测试工具

American Fuzzy Lop

符号执行

对测试程序的符号执行

符号执行的局限性

动态符号执行

使用 DSE 破解密码

创建可执行二进制文件

安装并运行 Angr

Angr 程序

练习

使用 Angr 进行夺旗游戏

模糊测试 Web 协议

模糊测试开源项目

实现你自己的合成执行引擎

**10

木马构建**

案例研究：通过 Metasploit 重建 Drovorub

构建攻击者服务器

构建受害者客户端

上传木马

使用攻击者代理

为什么我们需要受害者内核模块

隐藏木马在合法文件中

创建木马

托管木马

下载感染文件

控制木马

通过使用编码器躲避杀毒软件

Base64 编码器

编写 Metasploit 模块

Shikata Ga Nai 编码器

创建 Windows 木马

将木马藏在扫雷游戏中

将木马藏在 Word 文档中（或其他无辜的文件）

创建 Android 木马

解构 APK 查看植入程序

重建并签名 APK

测试 Android 木马

练习

Evil-Droid

编写你自己的 Python 植入程序

使你的植入程序混淆

构建平台特定的可执行文件

**11

构建和安装 Linux Rootkits**

编写 Linux 内核模块

备份你的 Kali Linux 虚拟机

编写代码

编译并运行你的内核模块

修改系统调用

系统调用的工作原理

钩取系统调用

钩取关闭系统调用

隐藏文件

linux_dirent 结构

编写钩取代码

使用 Armitage 利用主机漏洞并安装 Rootkit

扫描网络

利用主机漏洞

安装 Rootkit

练习

键盘记录器

自我隐藏模块

**12

破解和窃取密码**

SQL 注入

从网站数据库窃取密码

列举 Web 服务器上可访问的文件

执行 SQL 注入

编写自己的 SQL 注入工具

理解 HTTP 请求

编写注入程序

使用 SQLMap

哈希密码

MD5 哈希的结构

破解哈希值

使用 Nonce 对哈希值加盐

构建盐值哈希破解器

流行的哈希破解和暴力破解工具

John the Ripper

Hashcat

Hydra

练习

NoSQL 注入

暴力破解 Web 登录

Burp Suite

**13

严重的跨站脚本攻击**

跨站脚本攻击

JavaScript 如何被用于恶意攻击

存储型 XSS 攻击

反射型 XSS 攻击

使用 OWASP Zed 攻击代理寻找漏洞

使用浏览器漏洞框架有效负载

注入 BeEF 钩子

执行社会工程攻击

从浏览器跳转到机器

案例研究：利用旧版 Chrome 浏览器漏洞

通过网站漏洞安装 Rootkits

练习：在 Bug 赏金程序中寻找漏洞

**PART V

控制网络**

**14

跳板与特权提升**

从双网卡设备进行跳板

配置双网卡设备](ch14.xhtml#ch14lev2)

将机器连接到你的私有网络

使用 Metasploit 进行跳板攻击

编写攻击者代理

在 Linux 上提取密码哈希值

Linux 存储用户名和密码的位置

执行 Dirty COW 特权提升攻击

练习

为双网卡设备添加 NAT

关于 Windows 特权提升的推荐阅读

**15

穿越企业 Windows 网络**

创建 Windows 虚拟实验室

使用 Mimikatz 提取密码哈希值

通过 NT LAN 管理器传递哈希值

探索企业 Windows 网络

攻击 DNS 服务

攻击 Active Directory 和 LDAP 服务

编写 LDAP 查询客户端

使用 SharpHound 和 Bloodhound 进行 LDAP 枚举

攻击 Kerberos

票证攻击

黄金票证和 DC 同步攻击

练习：Kerberoasting

**16

下一步**

设置一个加固的黑客环境

通过 Tor 和 Tails 保持匿名

设置虚拟专用服务器

设置 SSH

安装你的黑客工具

加固服务器

审计你的加固服务器

其他主题

软件定义无线电

攻击蜂窝基础设施

突破空气隔离

逆向工程

物理黑客工具

取证

攻击工业系统

量子计算

与他人连接

**索引**
