# 第一章：选择一个漏洞悬赏程序

![](img/chapterart.png)

漏洞悬赏程序：它们都一样吗？找到合适的漏洞悬赏程序是成为成功的漏洞猎人第一步。近年来，许多程序相继涌现，很难确定哪些程序能提供最佳的金钱奖励、经验和学习机会。

一个*漏洞悬赏程序*是一个公司邀请黑客攻击其产品和服务的项目。但你应该如何选择一个程序？你又应该如何优先考虑它们的不同指标，比如涉及的资产类型、程序是否托管在平台上、是否公开或私密、程序的范围、奖励金额和响应时间等？

在这一章中，我们将探讨不同类型的漏洞悬赏程序，分析每种程序的优缺点，并帮助你选择合适的程序。

## 行业现状

漏洞悬赏目前是组织获取关于安全漏洞反馈的最流行方式之一。像 PayPal 和 Facebook 这样的跨国公司，以及像美国国防部这样的政府机构，都已经接受了这一理念。然而，不久之前，向公司报告一个漏洞，可能会让你面临牢狱之灾，而不是获得奖励。

1995 年，Netscape 推出了第一个漏洞悬赏程序。公司鼓励用户报告其全新浏览器 Netscape Navigator 2.0 中发现的漏洞，将众包安全测试的概念引入互联网世界。九年后的 2004 年，Mozilla 推出了下一个企业级漏洞悬赏程序，邀请用户在 Firefox 浏览器中识别漏洞。

但直到 2010 年代，提供漏洞悬赏才成为一种流行的做法。那一年，谷歌推出了自己的程序，随后 Facebook 在 2011 年也跟进了。正是这两个程序启动了利用漏洞悬赏来增强公司内部安全基础设施的趋势。

随着漏洞悬赏成为一种更为广泛的策略，漏洞悬赏即服务的*平台*应运而生。这些平台帮助公司设置和运营他们的程序。例如，它们为公司提供了一个托管程序的地方，处理奖励支付的方式，以及一个集中式的地方来与漏洞猎人进行沟通。

这两个最大的漏洞悬赏平台，HackerOne 和 Bugcrowd，都在 2012 年推出。此后，还有一些平台，如 Synack、Cobalt 和 Intigriti，也进入了市场。这些平台和管理漏洞悬赏服务使得即便是资源有限的公司也能开展安全计划。如今，大型公司、小型初创企业、非营利组织以及政府机构都已将漏洞悬赏作为额外的安全措施，并成为其安全政策的重要组成部分。你可以在[`en.wikipedia.org/wiki/Bug_bounty_program`](https://en.wikipedia.org/wiki/Bug_bounty_program)了解更多关于漏洞悬赏程序的历史。

*安全计划*一词通常指的是信息安全行业中信息安全政策、程序、指南和标准。在本书中，我用*计划*或*漏洞悬赏计划*来指代公司的漏洞悬赏操作。如今，存在大量的漏洞悬赏计划，每个计划都有其独特的特点、优势和缺点。让我们来仔细看看这些。

## 资产类型

在漏洞悬赏计划中，*资产*是指你可以攻击的应用、网站或产品。资产有不同的类型，每种类型都有其独特的特点、要求以及优缺点。在考虑了这些差异后，你应当根据自己的技能、经验水平和偏好，选择适合自己优势的资产。

### 社交网站和应用程序

任何标记为*社交*的东西都有很大的漏洞潜力，因为这些应用通常很复杂，涉及用户之间以及用户与服务器之间大量的交互。这就是为什么我们将要讨论的第一个漏洞悬赏项目针对社交网站和应用程序。*社交应用*一词指的是任何允许用户互相交互的网站。许多项目属于这一类别：例如，HackerOne 的漏洞悬赏计划，以及 Facebook、Twitter、GitHub 和 LINE 的项目。

社交应用需要管理用户之间的交互，以及每个用户的角色、权限和账户完整性。它们通常存在潜在的关键网络漏洞，如不安全的直接对象引用（IDOR）、信息泄露和账户接管。当许多用户在一个平台上时，这些漏洞容易发生；当应用程序错误管理用户信息时，恶意用户可以冒充他人身份。

这些复杂的应用通常还提供了大量用户输入的机会。如果输入验证没有正确执行，这些应用容易出现注入漏洞，比如 SQL 注入（SQLi）或跨站脚本（XSS）。

如果你是漏洞悬赏的新手，我建议你从社交网站开始。如今大量的社交应用意味着，如果你瞄准社交网站，你将有很多项目可供选择。此外，社交网站的复杂性质意味着你将遇到广泛的攻击面，可以进行实验。（一个应用的*攻击面*指的是攻击者可以尝试利用的应用的所有不同点。）最后，这些网站上出现的各种漏洞意味着你将能够迅速建立深厚的网络安全知识。

黑客攻击社交程序所需的技能包括使用代理的能力，比如第四章介绍的 Burp Suite 代理，以及对 XSS 和 IDOR 等网页漏洞的了解。你可以在第六章和第十章中学习更多相关内容。掌握一些 JavaScript 编程技能和网页开发知识也会有所帮助。然而，这些技能并不是成为黑客成功的必要条件。

但是这些程序有一个重大缺点。由于它们产品的流行和低门槛，它们通常竞争激烈，并且有许多黑客在上面进行攻击。像 Facebook 和 Twitter 这样的社交媒体平台是最常被攻击的程序之一。

### 一般网页应用

*一般* *网页应用*也是初学者的一个好目标。在这里，我指的是不涉及用户与用户之间互动的任何网页应用。相反，用户与服务器互动以访问应用的功能。属于这些类别的目标可以包括静态网站、云应用、像银行网站这样的消费服务以及物联网（IoT）设备或其他连接硬件的网页门户。像社交网站一样，它们也是相当多样化的，并且适合各种技能水平。例子包括谷歌、美国国防部和 Credit Karma 的程序。

也就是说，根据我的经验，它们往往比社交应用稍微难以攻破，而且攻击面更小。如果你在寻找账户接管和信息泄露漏洞方面，可能不会有太多运气，因为用户之间互动的机会比较少，难以窃取他们的信息。在这些应用中，你会发现的漏洞类型稍有不同。你需要寻找服务器端漏洞以及特定于应用技术栈的漏洞。你也可以寻找常见的网络漏洞，比如子域名接管。这意味着你需要了解客户端和服务器端的网页漏洞，并且应该具备使用代理的能力。了解一些网页开发和编程的知识也会有所帮助。

这些程序的流行程度各不相同。然而，它们大多数的门槛较低，因此你很可能可以立即开始进行黑客攻击！

### 移动应用（Android、iOS 和 Windows）

一旦你掌握了黑客攻击网页应用的技巧，你可能会选择专攻*移动应用*。移动程序正在变得越来越普及；毕竟，现在大多数网页应用都有移动版本。它们包括 Facebook Messenger、Twitter 应用、LINE 移动应用、Yelp 应用和 Gmail 应用。

黑客攻击移动应用程序需要你已经掌握的网页应用程序的黑客技能，并且还需要额外了解移动应用的结构以及与平台相关的编程技术。你应了解如证书固定绕过、移动逆向工程和密码学等攻击和分析策略。

黑客攻击移动应用程序还需要比攻击网页应用程序更多的准备，因为你需要拥有一台可以进行实验的移动设备。一个好的移动测试实验室包括常规设备、已 root 设备以及 Android 和 iOS 的设备模拟器。一个*已 root* *设备*是你拥有管理员权限的设备。它将允许你更加自由地进行实验，因为你可以绕过移动系统的安全约束。*模拟器*是你在计算机上运行的移动环境的虚拟仿真程序。它允许你运行多个设备版本和操作系统，而无需为每个设置都拥有一台设备。

因此，移动应用程序在漏洞赏金猎人中不如网页应用程序受欢迎。然而，移动程序较高的入门门槛对参与者而言却是一个优势。这些程序竞争较小，使得发现漏洞相对容易。

### API

*应用程序接口（**API**）*是定义其他应用程序如何与一个组织的资源进行交互的规范，例如获取或修改其数据。例如，另一个应用程序可能通过超文本传输协议（HTTP）消息访问某个端点，获取应用程序的数据，应用程序会以可扩展标记语言（XML）或 JavaScript 对象表示法（JSON）格式返回数据。

一些程序在其漏洞赏金计划中会更加关注 API 错误，尤其是在推出新版本 API 时。安全的 API 实现对于防止数据泄露和保护客户数据至关重要。黑客攻击 API 需要与黑客攻击网页应用、移动应用和物联网应用相似的技能。但在测试 API 时，你应关注常见的 API 错误，如数据泄露和注入漏洞。

### 源代码和可执行文件

如果你具备更高级的编程和逆向工程技能，你可以尝试*源代码*和*可执行* *程序*。这些程序鼓励黑客通过直接提供开源代码库或二进制可执行文件来寻找组织软件中的漏洞。例子包括互联网漏洞赏金计划、PHP 语言的程序以及 WordPress 计划。

破解这些程序可能需要分析开源项目的源代码以寻找网络漏洞，并对二进制文件进行模糊测试以发现潜在的漏洞。通常，你需要了解编码和计算机科学的基本概念才能在这里成功。你将需要了解网络漏洞、与项目代码库相关的编程技能和代码分析技能。密码学、软件开发和逆向工程技能也会有所帮助。

源代码程序可能听起来令人畏惧，但请记住，它们是多种多样的，因此你有很多选择。你不必成为一名高手程序员才能破解这些程序；相反，目标是对项目的技术栈和底层架构有扎实的理解。因为这些程序通常需要更多的技能，它们的竞争性较小，只有一小部分黑客会尝试破解它们。

### 硬件和物联网

最后但同样重要的是硬件和物联网程序。这些程序要求你破解像汽车、智能电视和恒温器这样的设备。例如，特斯拉和福特汽车公司的漏洞奖励程序就是其中的例子。

破解这些程序需要非常具体的技能：你通常需要深入了解你所破解的设备类型，并理解常见的物联网漏洞。你应该了解网络漏洞、编程、代码分析和逆向工程。同时，还需要研究物联网概念和行业标准，如数字签名和非对称加密方案。最后，密码学、无线黑客技术和软件开发技能也会有所帮助。

虽然某些程序会提供免费设备供你破解，但这通常只适用于那些已经与公司建立了关系的特定黑客。要开始破解这些程序，你可能需要资金来自己购买设备。

由于这些程序需要专业的技能和设备，因此它们往往是竞争最少的。

## 漏洞奖励平台

公司可以通过两种方式举办漏洞奖励程序：漏洞奖励平台和独立托管的网站。

*漏洞奖励平台* 是许多公司举办其程序的网站。通常，平台会直接根据黑客的结果授予声望点数和金钱。一些最大的漏洞奖励平台包括 HackerOne、Bugcrowd、Intigriti、Synack 和 Cobalt。

漏洞赏金平台是黑客和安全团队之间的中介。它们为公司提供后勤支持，帮助完成支付和沟通等任务。它们还经常帮助管理进来的报告，通过筛选、去重和筛查漏洞报告来协助公司。最后，这些平台提供了一种方式，让公司通过黑客统计数据和声誉来评估黑客的技能水平。这使得那些不希望被低质量报告淹没的公司能够邀请有经验的黑客参加他们的私人计划。一些平台在允许黑客参与计划之前，还会对黑客进行筛查或面试。

从黑客的角度来看，漏洞赏金平台提供了一个集中提交报告的地方。它们还提供了一个无缝的方式来获得对你发现的漏洞的认可和报酬。

另一方面，许多组织在没有平台帮助的情况下自己主办和管理漏洞赏金计划。像谷歌、Facebook、苹果和 Medium 这样的公司就是这么做的。你可以通过访问他们的网站，或在网上搜索“*公司名称* 漏洞赏金计划”来找到他们的漏洞赏金政策页面。

作为一个漏洞赏金猎人，你应该在漏洞赏金平台上进行黑客攻击吗？还是应该选择公司独立主办的计划？

### 优点 . . .

漏洞赏金平台的最大优点是，它们提供了公司流程的高度透明度，因为它们会发布已披露的报告、有关计划的筛查率、支付金额和响应时间等指标。独立主办的计划通常缺乏这种透明度。在漏洞赏金世界中，*筛查*指的是对漏洞的确认。

你也不必担心每次提交漏洞报告时，如何通过电子邮件联系安全团队、跟进报告，以及提供支付和税务信息。漏洞赏金计划通常还设有声誉系统，允许你展示你的经验，从而获得邀请-only 漏洞赏金计划的访问权限。

漏洞赏金平台的另一个优点是，它们通常会作为第三方提供冲突解决和法律保护。如果你向非平台计划提交报告，你将无法在最终的赏金决策中寻求补偿。最终，在当前行业状态下，你不能总是期待公司支付赏金或解决报告，但平台提供的黑客对黑客的反馈系统是非常有帮助的。

### . . . 和缺点

然而，一些黑客避免使用漏洞赏金平台，因为他们不喜欢这些平台处理报告的方式。提交给平台管理的漏洞赏金计划的报告通常会由*筛查员*处理，这些是第三方员工，通常不熟悉公司产品的所有安全细节。关于筛查员不当处理报告的投诉很常见。

平台上的程序还打破了黑客和开发者之间的直接联系。通过直接参与的程序，你通常可以与公司的安全工程师讨论漏洞，这为你提供了一个极好的学习体验。

最后，公共的 bug 赏金平台上的程序通常会很拥挤，因为这些平台为它们提供了更多曝光。另一方面，许多私有托管的程序没有那么多黑客关注，因此竞争较少。对于许多不与 bug 赏金平台合作的公司，如果你想参与它们的程序，你别无选择，只能去平台外参与。

## 范围、支付和响应时间

选择一个程序时，除了资产类型和平台之外，你还应考虑哪些其他指标？在每个 bug 赏金程序的页面上，通常会列出一些指标，帮助你评估该程序。这些指标提供了关于你可能找到漏洞的难易程度、你可能获得的报酬以及程序运行效率的洞察。

### 程序范围

首先，考虑范围。一个程序的*范围*在其政策页面中指定了你被允许如何进行黑客攻击。范围有两种类型：资产范围和漏洞范围。*资产范围*告诉你可以攻击哪些子域名、产品和应用程序。而*漏洞范围*则指定了公司接受哪些漏洞作为有效的 bug。

例如，公司可能会列出其网站的子域名，哪些在范围内，哪些超出范围：

**范围内的资产**

1.  *a.example.com*

1.  *b.example.com*

1.  *c.example.com*

1.  *users.example.com*

1.  *landing.example.com*

**超出范围的资产**

1.  *dev.example.com*

1.  *test.example.com*

列为范围内的资产是你被允许攻击的资产。另一方面，列为超出范围的资产则禁止赏金猎人攻击。一定要特别小心并遵守规则！攻击超出范围的资产是违法的。

公司通常也会列出它们认为有效的漏洞：

**范围内的漏洞**

1.  所有没有列为超出范围的资产

**超出范围的漏洞**

1.  自我 XSS

1.  点击劫持

1.  缺失的 HTTP 头和其他没有直接安全影响的最佳实践

1.  拒绝服务攻击

1.  使用已知存在漏洞的库，但没有可利用的证明

1.  自动扫描器的结果，但没有可利用的证明

在这个示例中，你看到的超出范围的漏洞是 bug 赏金项目中典型的漏洞。注意，许多程序将无法利用的问题，比如违反最佳实践的情况，视为超出范围。

任何具有大范围资产和漏洞的程序都非常适合初学者开始。资产范围越大，你可以查看的目标应用和网页就越多。当一个程序拥有较大的资产范围时，你通常可以发现一些其他黑客忽视的冷门应用，这通常意味着在报告 bug 时竞争较小。

漏洞范围越大，组织愿意接受的漏洞报告种类也越多。这些计划更容易发现漏洞，因为你有更多的机会，可以发挥你的优势。

### 支付金额

你应该考虑的下一个指标是该计划的*payout amounts*。漏洞披露计划（VDPs）和漏洞悬赏计划（bug bounty programs）有两种类型的支付计划。

漏洞披露计划（VDPs）是*仅限声誉的计划*，意味着它们不会为发现的漏洞支付奖励，但通常会提供声誉积分和奖励物品。对于那些赚钱不是主要目标的人来说，它们是了解黑客攻击的一个很好的途径。由于这些计划不支付报酬，因此竞争较少，更容易发现漏洞。你可以利用这些计划来练习发现常见漏洞并与安全工程师进行沟通。

另一方面，漏洞悬赏计划会根据你的发现提供不同金额的奖励。通常，漏洞的严重性越高，报告的奖励也会越多。但是，不同的计划在每个严重性等级上的支付平均金额不同。你可以在漏洞悬赏页面上找到该计划的支付信息，通常在名为*payout*表格的部分中列出。通常，低影响问题的奖励范围在 50 到 500 美元（USD）之间，而严重问题的奖励则可能超过 1 万美元。然而，漏洞悬赏行业正在发展，且高影响漏洞的支付金额也在增加。例如，苹果现在对于最严重的漏洞提供最高 100 万美元的奖励。

### 响应时间

最后，考虑该计划的平均*响应时间*。一些公司会在几天内处理并解决你的报告，而其他公司则可能需要几周甚至几个月的时间才能最终修复。延迟通常是由于安全团队内部的限制，例如缺乏人员处理报告、发布安全补丁的延迟，以及缺乏资金及时奖励研究人员。有时，延迟是因为研究人员提交了没有清晰重现步骤的错误报告。

优先选择响应时间较快的计划。等待公司回复可能是一个令人沮丧的经历，特别是当你刚开始时，你会犯很多错误。你可能会错误评估漏洞的严重性，写出不清楚的解释，或在报告中犯技术错误。来自安全团队的快速反馈将帮助你改进，让你更快地成为一名合格的黑客。

## 私有计划

大多数漏洞悬赏平台区分公开计划和私有计划。

*公开计划*是开放给所有人的；任何人都可以攻击并向这些计划提交漏洞，只要他们遵守法律和漏洞悬赏计划的政策。

另一方面，*私人程序*只对被邀请的黑客开放。对于这些程序，公司会邀请拥有一定经验并且有着证明过能力记录的黑客来攻击公司并提交漏洞。由于参与人数有限，私人程序的竞争远不如公共程序激烈。因此，在这些程序中发现漏洞要容易得多。私人程序通常也有更快的响应时间，因为它们收到的报告相对较少。

参与私人程序可以带来极大的优势。但你如何才能被邀请加入呢？图 1-1 展示了 HackerOne 平台上的私人邀请通知。

![f01001](img/f01001.png)

图 1-1：HackerOne 平台上的私人邀请通知。当你在漏洞赏金平台上进行攻击时，你经常能收到不同公司私人程序的邀请。

公司会向通过某些方式证明自己能力的黑客发送私人邀请，因此一旦你发现了一些漏洞，获得私人程序的邀请并不难。不同的漏洞赏金平台会有不同的算法来确定谁能收到邀请，但这里有一些建议可以帮助你达到目标。

首先，向公共程序提交一些漏洞。要获得私人邀请，你通常需要在平台上积累一定数量的声誉积分，而开始赚取这些积分的唯一途径是向公共程序提交有效的漏洞。你还应专注于提交高影响力的漏洞。这些漏洞通常会为你带来更高的声誉积分，并帮助你更快地获得私人邀请。在本书第二部分的每一章中，我都会提供建议，帮助你将发现的问题升级为最大影响力的攻击。在一些漏洞赏金平台（如 HackerOne）上，你还可以通过完成教程或解决“夺旗赛”（CTF）挑战获得私人邀请。

接下来，避免发送垃圾报告。提交无关问题通常会导致声誉积分下降。大多数漏洞赏金平台将私人邀请限制在拥有一定积分以上的黑客。

最后，在与安全团队沟通时，要保持礼貌和尊重。对安全团队无礼或恶劣的行为很可能会导致你被禁用，且无法获得其他公司的私人邀请。

## 选择合适的程序

漏洞赏金是获得网络安全经验并赚取额外收入的好方法。但是，随着行业竞争的加剧，越来越多的人开始发现并参与这些程序，初学者想要入门变得越来越困难。这就是为什么从一开始就选择一个能让你成功的程序如此重要。

在你培养出漏洞猎人的直觉之前，你通常不得不依赖易得的漏洞和常见的技巧。这意味着其他很多黑客也能发现相同的漏洞，通常比你更快。因此，选择那些经验更丰富的漏洞猎人忽视的程序，避免竞争，还是个不错的选择。你可以通过两种方式找到这些竞争较少的程序：寻找无薪程序或选择范围广泛的程序。

尝试首先选择漏洞披露程序。由于没有金钱奖励，无薪程序通常会被经验丰富的漏洞猎人忽视。但它们仍然能为你赢得积分和认可！而这种认可可能正是你获得邀请加入私人付费程序所需要的。

选择一个具有广泛适用范围的程序意味着你将能够查看更多的目标应用程序和网页。这将减少竞争，因为较少的黑客会报告任何单一的资产或漏洞类型。选择响应时间快的程序可以防止挫败感，并尽快获得反馈。

你可以将程序的声誉作为决策过程中的最后一个参考因素。如果可以的话，通过查看公司公开的报告，收集有关公司流程的信息，并从其他黑客的经验中学习。公司是否对报告者友好？他们是否尊重并支持你？他们是否帮助你学习？选择那些在你学习过程中会给予支持的程序，并且会根据你提供的价值给予回报的程序。

选择适合你技能水平的程序至关重要，如果你想进入漏洞赏金的世界。本章应该能帮助你理清你可能感兴趣的各种程序。祝你黑客之路顺利！

## 常见程序的快速比较

在你确定了几个感兴趣的程序后，可以列出每个程序的属性来进行比较。在表 1-1 中，我们比较了本章介绍的几个流行程序。

表 1-1：三个漏洞赏金计划的比较：HackerOne、Facebook 和 GitHub

| **程序** | **资产类型** | **适用范围** | **支付金额** | **响应时间** |
| --- | --- | --- | --- | --- |

| HackerOne | 社交网站 | [`hackerone.com/`](https://hackerone.com/) https://api.hackerone.com

*.vpn.hackerone.net

[`www.hackerone.com`](https://www.hackerone.com)

以及更多资产...

除排除项外的任何漏洞都在适用范围内。| $500–$15,000+ | 快速。平均响应时间为 5 小时，平均分类时间为 15 小时。 |

| Facebook | 社交网站、非社交网站、移动网站、物联网和源代码 | Instagram Internet.org / Free Basics

Oculus

Workplace

Facebook 的开源项目

WhatsApp

Portal

FBLite

Express Wi-Fi

除排除项外的任何漏洞都在适用范围内。| 最低 $500 | 根据我的经验，非常快！ |

| GitHub | 社交网站 | [`blog.github.com/`](https://blog.github.com/) [`community.github.com/`](https://community.github.com/)

[`resources.github.com/`](http://resources.github.com/)

以及更多资源 . . .

使用已知漏洞的软件。

点击劫持静态网站。

在 Markdown 内容中包含 HTML。

通过 *.patch* 链接泄露电子邮件地址。

以及更多问题 . . . | $617–$30,000 | 快速。平均响应时间为 11 小时。平均分类时间为 23 小时。 |
