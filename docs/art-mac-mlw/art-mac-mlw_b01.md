# 索引

请注意，索引链接指向每个术语的大致位置。

**A**

阿尔诺·阿巴蒂，117

ABI（应用程序二进制接口），128

活动监视器工具，64

广告软件

广告软件相关的劫持和注入，54–56

Bitdefender 广告软件移除工具，49

Crossrider，43

*5mLen*，70，80–81

Pitchofcase，40

`aevt_decompile` 反编译器，87

国际特赦组织，63

分析。*请参阅* 动态分析；静态分析

分析工具检测

检测调试器，209–210

防止调试，210–211

目标安全工具，208–209

分析 EvilQuest 恶意软件

反分析逻辑，233–242

命令行参数，231–233

确认文件类型，223–224

提取内容，224–225

提取嵌入信息，229–231

文件加密逻辑，275–277

文件外泄逻辑，271–275

感染途径，221–223

本地病毒感染逻辑，253–263

持久性，243–252

远程通信逻辑，263–271

持久性逻辑，252–253

可疑包工具，225–228

分析脚本

AppleScript，82–88

bash shell 脚本，76–78

Perl 脚本，88–89

Python 脚本，78–82

反分析逻辑，176–177

反动态分析方法，204–216

反静态分析方法，188–204

环境生成密钥，216–217

EvilQuest 恶意软件，233–242

防调试逻辑，234–238

混淆字符串，238–242

虚拟机防范逻辑，233–234

概览，187

反动态分析方法

分析工具检测，208–211

检测调试器，209–210

防止调试，210–211

目标安全工具，208–209

绕过，211–216

修改执行环境，213

修改指令指针，214–215

修改寄存器值，216

修补二进制映像，213–214

虚拟机检测，204–207

计算逻辑和物理 CPU，206

MAC 地址，检查，207

概述，204–205

SIP 状态，208

系统模型名称，检查，205–206

防感染保护机制

应用程序公证要求，4–5

文件隔离，4

Gatekeeper，4

反静态分析方法

代码级混淆，199–204

二进制加密器，202–204

概述，199–201

打包工具，201–202

基于字符串的混淆，188–199

加密字符串，189–191

寻找去混淆代码，193–194

强制恶意软件执行解密例程，197–199

定位混淆字符串，191–192

将敏感字符串伪装为常量，188–189

通过 Hopper 脚本，194–196

Apparency 应用程序，91–92

`append_ei` 函数，EvilQuest 恶意软件，257–259

Appify 工具，115，116–117

Apple 磁盘映像 (.dmg)，72

AppleJeus 恶意软件，75–76，135，151–152

AppleScript，82–88

Apple Silicon，102，126

应用程序二进制接口 (ABI)，128

应用程序捆绑包

*Contents/_CodeSignature* 文件，93

*Contents/* 目录, 93

*Contents/Info.plist* 文件，93–95

*Contents/MacOS* 目录，93

*Contents/Resources* 目录，93

已定义，91

WindTail 恶意软件，91–95

应用程序

Apparency 应用程序，91–92

应用程序包，91–95

应用程序公证要求，4–5

破解，9–10

假冒，7–8

破解，9–10

木马化，8–9

《计算机病毒研究与防御的艺术》（Szor），253

汇编，126–130

调用约定，127–128

已定义，126

指令，127

`objc_msgSend` 函数，128–130

概览，126

寄存器，126–127

汇编（ASM）模式，Hopper，146

**B**

`backtrace` 命令，LLDB 调试器，175

bash shell 脚本，76–78

二进制分析

提取非二进制组件，116–122

Mach-O 二进制文件格式，99–114

分类，107–114

数据段，106–107

头文件，100–103

加载命令，103–106

概览，99–100

用于构建二进制文件的工具，115–116

二进制加密器，202–204

二进制修改，42–43

BirdMiner 恶意软件，10，56，155–156

*BitcoinMagazine-Quidax _InterviewQuestions_2018* 文档，51

Bitdefender 广告软件移除工具，49

`breakpoint` 命令，LLDB 调试器，174

`breakpoint delete` 命令，LLDB 调试器，174

`breakpoint enable/disable` 命令，LLDB 调试器，174

`breakpoint list` 命令，LLDB 调试器，174

`breakpoint modify` 命令，LLDB 调试器，174

断点

添加命令到，173–174

条件触发，172–173

已定义，170

管理，174

概览，170–171

设置在方法名称上，172

暴力破解，17

`__bss` 区段，Mach-O 二进制 `__DATA` 段，106

Bundlore 恶意软件, 117

**C**

调用约定, 汇编, 127–128

功能

广告软件相关的劫持和注入, 54–56

分类, 47–48

加密货币矿工, 56–57

已定义, 1

文件加密, 61–62

内存执行, 58–59

特权提升

root 权限, 52–54

沙盒, 50–51

侦查逻辑, 48–49

远程下载/上传, 59–61

远程进程, 58

远程 Shell, 57–58

间谍软件, 64–65

隐匿性, 62–64

调查, 48–50

`carve_target` 函数, EvilQuest 恶意软件, 276

C/C++ 反汇编, 135–137

证书文件外泄, 272–275

CFG（控制流图）模式, Hopper, 146

`CFStringGetCString` 函数, 137

Checkm8 漏洞, 20

`class-dump` 工具, 113–114

代码级混淆

二进制加密器, 202–204

已定义, 188

概述, 199–201

打包器, 201–202

代码签名认证机构, 109

`codesign` 工具, 108–111

Cohen, Frederick, 253

ColdRoot 恶意软件, 154

命令, 添加到断点, 173–174

`construct_plist_path` 函数, EvilQuest 恶意软件, 251

`__const` 区段, Mach-O 二进制 `__TEXT` 段, 106

*Contents/_CodeSignature* 文件, 93

*Contents/* 目录, 93

*Contents/Info.plist* 文件, 93–95

*Contents/MacOS* 目录, 93

*Contents/Resources* 目录, 93

`continue` 命令, LLDB 调试器, 169

控制流反汇编, 137–139

控制流图（CFG）模式, Hopper, 146

CookieMiner 恶意软件, 56, 157

CPUMeaner 恶意软件, 56, 73–74

`cputype` 成员, Mach-O 头部, 101

破解的应用程序, 9–10

CreativeUpdate 恶意软件, 16, 56, 109, 117–118

cron 作业, 32–33

交叉引用, Hopper, 144–145

Crossrider 广告软件, 43

加密货币

加密货币文件外泄, 272–275

揭示 App Store 应用中的加密货币挖矿, 180–185

加密货币矿工, 56–57

`_cstring` 区段, Mach-O 二进制 `__TEXT` 区段, 106

`CTRL-C` 命令, LLDB 调试器, 169

自定义 URL 方案, 10–13

Cylance 杀毒公司, 59

**D**

Dacls 后门恶意软件, 133–134, 159–160

DarthMiner 恶意软件, 56

`__data` 区段, Mach-O 二进制 `__DATA segment`, 106

`__DATA` 区段, Mach-O 二进制文件格式, 104, 107

`dataWithBytes:length:` 方法, Objective-C 反汇编, 130

调试

LLDB 调试器, 167–180

断点, 170–174

控制执行, 169–170

显示运行时信息, 174–176

修改进程状态, 176–178

概述, 167–168

脚本, 178–180

启动会话, 168–169

概述, 165

力量, 166–167

揭示 App Store 应用中的加密货币挖矿, 180–185

防调试逻辑, 234–238

反编译, 139–140

反编译工具, 80

Devadoss, Dinesh, 222, 275

DevilRobber 恶意软件, 84

目录列表外泄, 271–272

反汇编

C/C++, 135–137

控制流, 137–139

Objective-C, 130–133

Swift, 133–135

显示模式, Hopper, 145–146

分发打包, 提取恶意文件

Apple 磁盘映像, 72

包，73–76

*.dmg*（Apple 磁盘映像）文件扩展名，72

*.docm* 文件扩展名，89–90

Dok 恶意软件，5

DoubleFantasy 恶意软件，194–196

Dummy 恶意软件，57

转储（打印），调试过程，166–167，174

`DYLD_*` 环境变量，35–36

dylibs。*参见* 动态库

动态分析

调试，165–185

LLDB 调试器，167–180

概述，165

功能强大，166–167

脚本，178–180

揭示 App Store 应用中的加密货币挖矿，180–185

已定义，67

文件监控，153–156

FileMonitor 工具，155–156

`fs_usage` 工具，154–155

概述，153–154

网络监控，157–163

网络礼仪工具，159–160

网络状态监视器，158–159

网络流量监视器，160–163

概述，157–158

概述，149–150

进程监控，150–153

概述，150–151

ProcessMonitor 工具，151–153

动态库（dylibs），34–39

`DYLD_*` 环境变量，35–36

dylib 劫持，37–39

dylib 代理，36–37

概述，34–35

**E**

EFI（可扩展固件接口）漏洞，20

`ei_carver_main` 函数，EvilQuest 恶意软件，275

`ei_forensic_sendfile` 函数，EvilQuest 恶意软件，274

`ei_forensic_thread` 函数，EvilQuest 恶意软件，271

`ei_loader_main` 函数，EvilQuest 恶意软件，254

`ei_pers_thread` 函数，EvilQuest 恶意软件，252

`ei_rfind_cnc 和 ei_getip` 函数，EvilQuest 恶意软件，281

`ei_selfretain_main` 函数，EvilQuest 恶意软件，249–250

`ei_str` 函数，EvilQuest 恶意软件，239–240

8 位寄存器, 127

`eiht_get_update` 函数, EvilQuest 恶意软件, 262–263

Eleanor 恶意软件, 150–151

Electron 工具, 115–116, 120

嵌入信息，提取, 229–231

Endpoint Security 框架, 151

环境生成的密钥, 216–217

Equation Group, 217

ESET 杀毒公司, 10

Esser, Stefan, 54

事件监控规则, 41

EvilQuest 恶意软件, 43, 52, 62, 215

分析

反分析逻辑, 233–242

命令行参数, 231–233

确认文件类型, 223–224

提取内容, 224–225

提取嵌入信息, 229–231

文件加密逻辑, 275–277

文件外泄逻辑, 271–275

感染向量, 221–223

本地病毒感染逻辑, 253–263

持久化, 243–252

远程通信逻辑, 263–271

持久化逻辑, 252–253

可疑包工具, 225–228

调用字符串解密程序, 197–199

更新, 277–281

外泄, 59–61

证书和加密货币外泄, 272–275

目录列出外泄, 271–272

漏洞利用

Checkm8, 18–19

已定义, 18

EFI, 18–19

零日漏洞, 18–19

可扩展固件接口 (EFI) 漏洞, 20

面向外部的服务, 17–18

**F**

假应用程序, 7–8

假安全警报, 6–7

假更新, 7

`fat_header`, Mach-O 头文件, 102

`52M_rj` 函数, EvilQuest 恶意软件, 278

`file` 命令

识别字节编译的 Python 脚本, 70–71

辨识 Office 文档，89

文件加密逻辑，61–62，275–277

文件外泄逻辑，EvilQuest 恶意软件分析

证书和加密货币文件外泄，272–275

目录列表外泄，271–272

文件监控

FileMonitor 实用程序，155–156

`fs_usage` 实用工具，154–155

概述，153–154

FileMonitor 实用工具，155–156

文件检疫，4

`filetype` 成员，Mach-O 头部，101

`file` 实用工具，228

EvilQuest 恶意软件，223

Mach-O 头部，103

WindTail 恶意软件，71

FindCrypt 插件，194

FinFisher 恶意软件，172

`finish` 命令，LLDB 调试器，169

FinSpy，63

FireEye，53

Flashback 恶意软件，18

Flash 零日漏洞，19

FruitFly 恶意软件，17，64，88–89，151

`fs_usage` 实用工具，12，154–155

**G**

垃圾（错误）指令，200

Gatekeeper，4

`get_mediator` 函数，EvilQuest 恶意软件，263–265

`get_targets` 函数，EvilQuest 恶意软件，254，272–274，275

`getDeviceSerial` 函数，135–136，137，139

GMERA，63

Grant，Ari，172

GravityRAT 恶意软件，118–121

**H**

HackingTeam 黑客团队，19

Handbrake 应用程序，16

处理程序，AppleScript，87

头部，Mach-O 二进制文件格式，100–103

`cputype` 成员，101

`fat_header`，102

`filetype` 成员，101

`file` 实用工具及其，103

`lipo` 工具及其，102–103

`magic` 成员，100–101

`offset` 成员，102

`otool` 工具及其，101

十六进制模式，Hopper，146

`-h` 标志，Mach-O 头部，101

Homebrew 软件包管理器，6

Hopper，125，139

交叉引用, 144–145  

Inspector 视图, 141–142  

Proc 视图, 142  

通过逆向工程, 140–146  

创建二进制文件进行分析, 140–141  

显示模式, 145–146  

接口, 141–143  

加载二进制文件, 141  

查看反汇编, 143–145  

通过 Hopper 脚本的基于字符串的混淆, 194–196  

Str 视图, 142  

`hostname` 命令, 89  

`--ignrp` 命令行参数, EvilQuest 恶意软件, 233  

**我**  

感染途径  

防感染保护机制, 4–5  

破解应用程序, 9–10  

自定义 URL 方案, 10–13  

已定义, 1  

EvilQuest 恶意软件, 221–223  

漏洞利用, 18–20  

面向外部的服务, 17–18  

虚假应用程序, 7–8  

虚假安全警报, 6–7  

虚假更新, 7  

恶意电子邮件, 5–6  

Office 宏, 14–15  

概述, 3–4  

物理攻击, 19  

破解应用程序, 9–10  

供应链攻击, 16  

木马化应用程序, 8–9  

Xcode 项目, 15–16  

*Info.plist* 文件  

已定义, 11  

WindTail 恶意软件, 93–95

Inspector 视图, Hopper, 141–142  

Intego 安全公司, 7  

交互式 shell, 57  

IOServiceGetMatchingService 函数, 136–137  

IPStorm 恶意软件, 17–18  

伊朗威胁博客, 49  

`is_debugging` 函数, EvilQuest 恶意软件, 235–236  

`is_executable` 函数, EvilQuest 恶意软件, 255–257  

iWorm 恶意软件, 10  

**J**  

作业, 33  

**K**  

KeRanger 勒索软件, 61, 213–215  

密钥链, 49  

`kill _unwanted` 函数, EvilQuest 恶意软件, 244  

KnockKnock 开源工具, 44–45  

Komplex 恶意软件，58，130，138，210

**L**

启动代理，26–32

启动守护进程，26–32

Lazarus Group，58，61，91，133，217

AppleJeus，75–76，135，151–152

Dacls 后门恶意软件，133–134，159–160

JMTTrader.app，8–9

`LC_LOAD_DYLIB` 加载命令，Mach-O 二进制文件格式，105–106

`LC_MAIN` 加载命令，Mach-O 二进制文件格式，104–105

`LC_SEGMENT_64` 加载命令，Mach-O 二进制文件格式，104

`lfsc_dirlist` 函数，EvilQuest 恶意软件，272

`__LINKEDIT` 段，Mach-O 二进制文件格式，104

`lipo` 工具，Mach-O 头部，102–103

Little Snitch 防火墙，49，209

LLDB 调试器

断点，170–174

向中添加命令，173–174

有条件触发，172–173

定义，170

管理，174

概述，170–171

设置方法名称，172

控制执行，169–170

检查运行时信息，174–176

修改进程状态，176–178

概述，167–168

启动会话，168–169

加载命令，Mach-O 二进制文件格式

`LC_LOAD_DYLIB`，105–106

`LC_MAIN`，104–105

`LC_SEGMENT_64`，104

概述，103–104

本地病毒感染逻辑

检查待感染的文件，255–257

EvilQuest 恶意软件分析，253–263

执行感染文件的原始代码，262–263

从感染文件中执行并重新持久化，260–262

感染目标文件，257–260

列出待感染的候选文件，254

概述，253–254

登录项, 24–26

登录/登出钩子, 34

LoudMiner 恶意软件, 10

`lsof` 工具, 159

**M**

MacDownloader 恶意软件, 49, 60

Mach-O 二进制文件格式, 76, 95

分类, 107–114

代码签名信息, 109–111

哈希值, 107–109

Objective-C 类信息, 113–114

字符串, 112–113

头部, 100–103

`cputype` 成员, 101

`fat_header`, 102

`filetype` 成员, 101

`file` 工具, 103

`lipo` 工具, 102–103

`magic` 成员, 100–101

`offset` 成员, 102

`otool` 工具, 101

加载命令, 103–106

`LC_LOAD_DYLIB`, 105–106

`LC_MAIN`, 104–105

`LC_SEGMENT_64`, 104

概述, 103–104

概述, 99–100

段, 106–107

`__DATA` 段, 107

`__TEXT` 段, 107

`__LINKEDIT` 段, 104

MachOView 工具, 101

mach 端口, 136

macOS Catalina (10.15), 4–5

MacRansom, 205–206

宏

提取, 89–90

基于宏的攻击, 14–15

MacUpdate 网站, 56, 117

`magic` 成员, Mach-O 头部, 100–101

恶意邮件, 5–6

Malwarebytes, 54

Mami 恶意软件, 166

MD5 哈希, 107–108

内存执行, 58–59

`memory write` 命令, LLDB 调试器, 177–178

`MH_BUNDLE (0x8)` 值, Mach-O 头部, 101

`MH_DYLIB (0x6)` 值, Mach-O 头部, 101

`MH_EXECUTE (0x2)` 值, Mach-O 头部, 101

MinerGate, 118

助记符, 汇编指令, 127

Mokes 恶意软件, 64, 159

Mughthesec 恶意软件, 54, 207, 213

**N**

名称修饰, 133, 135

Netcat 工具, 150

Netiquette 工具, 60, 159–160

`netstat` 工具, 158

`nettop` 工具, 158

NetWire 恶意软件, 191–192

网络监控

Netiquette 工具, 159–160

网络状态监控工具, 158–159

网络流量监控工具, 160–163

概述, 157–158

`nexti` 命令, LLDB 调试器, 169

`nm` 工具, EvilQuest 恶意软件, 229

非二进制分析

分析脚本, 76–89

AppleScript, 82–88

bash 脚本, 76–78

Perl 脚本, 88–89

Python 脚本, 78–82

应用程序, 91–95

从分发包中提取恶意文件, 72–76

Apple 磁盘映像, 72

安装包, 73–76

识别文件类型, 70–72

Office 文档, 89–91

概述, 69–70

非交互式 shell, 57

无操作 (NOPs), 200

`NSData` 类方法, Objective-C 反汇编, 131–132

`NSData` 对象, 131–132

`NSTask` 启动方法, 134

Nygard, Steve, 113

**O**

混淆脚本, 199–204

混淆字符串

EvilQuest 恶意软件, 197–199, 238–242

定位, 191–192

`__objc_*` 区段, Mach-O 二进制 `__DATA` 段, 106

`objc_msgSend` 函数, 172, 178–179, 182–183, 193

汇编, 128–130

Swift 反汇编, 133

Objective-C 反汇编, 130–133

Office 宏

提取, 89–90

基于宏的攻击, 14–15

`offset` 成员, Mach-O 头部, 102

oletools 工具集, 89–90

`olevba` 工具, 89–90

操作数, 127

组织唯一标识符（OUI）, 207, 213

`osadecompile` 命令, 82

OSAMiner 恶意软件, 56, 85–88

OS X Leopard, 4

OS X Mountain Lion, 4

`otool` 工具, 101–102, 105

OUI（组织唯一标识符）, 207, 213

**P**

安装包（*.pkg*）, 73–76

压缩工具, 201–202

补丁二进制文件

反汇编, 231

提取嵌入信息, 229–231

周期性脚本, 33–34

Perl 脚本, 88–89

`persist_executable_frombundle` 函数, EvilQuest 恶意软件, 261

`persist_executable` 函数, EvilQuest 恶意软件, 246

持久性

应用程序和二进制修改, 42–43

定义, 1, 23

动态库, 34–39

`DYLD_*` 环境变量, 35–36

dylib 劫持, 37–39

dylib 代理, 36–37

概述, 34–35

事件监控规则, 41

EvilQuest 恶意软件分析, 243–252

作为启动项的副本, 247–249

复制操作, 246–247

终止不需要的进程, 244–246

概述, 243–244

启动项, 249–252

KnockKnock 开源工具, 44–45

启动代理, 26–32

启动守护进程, 26–32

登录项, 24–26

登录/登出钩子, 34

概述, 23–24

插件, 39–40

重新启动应用程序, 41–42

调度机制, 32–34

cron 任务, 32–33

at 任务, 33

周期性脚本, 33–34

脚本, 41

物理攻击，19

海盗湾网站，10

盗版应用程序，9–10

Pirrit 恶意软件，102，200–201，208

Pitchofcase 广告软件，40

*.pkg*（软件包），73–76

`pkgutil` 实用程序，EvilQuest 恶意软件，225

鸭嘴兽工具，76–77，115，117–118

插件，39–40

`prevent_trace` 函数，EvilQuest 恶意软件，237–238

`print` 命令，LLDB 调试器，175

打印（转储），调试过程，166–167，174

特权升级

根权限，52–54

沙箱，50–51

进程监控

概述，150–151

ProcessMonitor 实用程序，151–153

Proc 视图，Hopper，142

Proton 恶意软件，16，49，208–209

伪代码模式，Hopper，146

`ptrace` 系统调用，阻止调试，210–211

PyInstaller 提取工具，119

PyInstaller 工具，115，119

Python 脚本，78–82

**R**

勒索软件。*参见* EvilQuest 恶意软件

定义，23

KeRanger 勒索软件，61，213–215

`RBP` 寄存器，127

`RCX` 寄存器，131–132

`RDX` 寄存器，131–132，231

`react_exec` 函数，EvilQuest 恶意软件，266–267

`react_host` 函数，EvilQuest 恶意软件，270

`react_keys` 函数，EvilQuest 恶意软件，269

`react_ping` 函数，EvilQuest 恶意软件，270，280

`react_sav` 函数，EvilQuest 恶意软件，268

`react_scmd` 函数，EvilQuest 恶意软件，270–271

`react_start` 函数，EvilQuest 恶意软件，268

`react_updatesettings` 函数，EvilQuest 恶意软件，281

Reaves, Jason，277

侦察逻辑，48–49

Reed, Thomas，43，54，207，222

寄存器

汇编, 126–127

`R8` 寄存器, 269

`R9` 寄存器, 183

`RAX` 寄存器, 31, 126–128, 130–131, 136–137, 175–177, 190, 200, 211, 216, 236, 248, 239

`RBP` 寄存器, 127

`RCX` 寄存器, 131–132

`RDX` 寄存器, 131–132, 231

`RSI` 寄存器, 131–132, 129, 136–137, 179–180, 193

`RSP` 寄存器, 127

修改寄存器值, 216

“scratch,” 136

`register write` 命令，LLDB 调试器, 176–177

重新启动应用程序, 41–42

远程通信逻辑，EvilQuest 恶意软件分析

`get_mediator` 函数, 263–265

远程任务逻辑, 265–271

远程下载/上传, 59–61

远程进程, 58

远程服务，妥协, 17–18

远程 shell, 57–58

远程任务逻辑，EvilQuest 恶意软件, 265–271

概述, 265–266

`react_exec` 函数, 266–267

`react_host` 函数, 270

`react_keys` 函数, 269

`react_ping` 函数, 270

`react_sav` 函数, 268

`react_scmd` 函数, 270–271

`react_start` 函数, 268

持久化逻辑，EvilQuest 恶意软件分析, 252–253

逆向工程

创建二进制文件进行分析, 140–141

显示模式, 145–146

接口, 141–143

加载二进制文件, 141

查看反汇编, 143–145

Riordan, James, 217

root 权限, 52–54

`RSI` 寄存器, 131–132, 129, 136–137, 179–180, 193

`RSP` 寄存器, 127

`run_audio 和 run_image` 函数, EvilQuest 恶意软件, 281

`run_daemon` 函数, EvilQuest 恶意软件, 250–251

`run_target` 函数, EvilQuest 恶意软件, 262–263

`run` 命令, LLDB 调试器, 169

仅运行 AppleScript 文件, 84–87

运行时信息，显示, 174–176

**S**

`s_is_high_time` 函数, EvilQuest 恶意软件, 275

Safe Finder, 54–55

沙箱, 50–51

调度机制

cron 任务, 32–33

at 任务, 33

定期脚本, 33–34

Schneier, Bruce, 217

“scratch” 寄存器, 136

脚本编辑器, 82, 84

脚本, 41

AppleScript, 82–88

bash shell, 76–78

Perl, 88–89

Python, 78–82

`scutil` 命令, 89

SDK 文件, 100–101

段, Mach-O 二进制文件格式, 106–107

`__DATA` 段, 107

`__TEXT` 段, 107

`__LINKEDIT` 段, 104

`set_important_files` 函数, EvilQuest 恶意软件, 252–253

`setLaunchPath:` 方法, Swift 汇编, 133

`SHA-1` 哈希, 107–108

Shlayer 恶意软件, 4–5, 116

Siggen 恶意软件, 76–80, 94–95

签名证书, 109

`--silent` 命令行参数, EvilQuest 恶意软件, 231–232

SIP（系统完整性保护）状态, 169, 208

16 位寄存器, 127

64 位寄存器, 127

假指令（垃圾指令）, 200

间谍软件, 64–65

栈, 定义, 127

静态分析

汇编, 126–130

二进制分析, 99–122

提取非二进制组件，116–122

Mach-O 二进制文件格式，99–114

用于构建二进制文件的工具，115–116

反编译，139–140

定义，67

反汇编，130–139

非二进制分析，69–95

分析脚本，76–89

应用程序，91–95

从分发包中提取恶意文件，72–76

识别文件类型，70–72

Office 文档，89–91

概述，69–70

使用 Hopper 进行逆向工程，140–146

隐秘，62–64

LLDB 调试器的`stepi`命令，169

逐步进行调试过程，166

Phil Stokes，80，85，87，277

基于字符串的混淆

定义，188

加密字符串，189–191

查找去混淆代码，193–194

强制恶意软件执行解密例程，197–199

定位混淆字符串，191–192

伪装为常量的敏感字符串，188–189

通过 Hopper 脚本，194–196

字符串

提取嵌入字符串，112–113

混淆字符串

恶意软件 EvilQuest，197–199，238–242

定位，191–192

`strings`实用程序

恶意软件 EvilQuest，229–230

WindTail 恶意软件，112–113

Hopper 的 Str 视图，142

*sudoers*文件，54

供应链攻击，16

调查，48–50

Suspicious Package 实用程序，73–75，225–228

Swift 反汇编，133–135

系统完整性保护（SIP）状态，169，208

Peter Szor，253

**T**

`tcpdump`实用程序，160

团队标识符，109

`__TEXT` 段，Mach-O 二进制文件格式，104，106–107

ThiefQuest 恶意软件，278。*参见* EvilQuest 恶意软件

32 位寄存器，127

Thomas, Adam，54

Tor 工具，150

Trend Micro，15，278–279，281

被篡改的应用程序，8–9

拼写变体攻击，6

**U**

通用二进制文件，102

UPX 打包工具，201，213

用户协助感染。*参见* 感染途径

防感染保护机制，4–5

恶意电子邮件，5–6

`/usr/bin/osascript` 命令，AppleScript，82

**V**

VBA（Visual Basic for Applications），14

`-v` 标志，Mach-O 头部，101

Vilaça, Pedro，202

虚拟机检测

计算逻辑和物理 CPU，206

MAC 地址，检查，207

概述，204–205

SIP 状态，检查，208

系统型号名称，检查，205–206

虚拟机防范逻辑，233–234

病毒

检查要感染的文件，255–257

定义，253

感染文件

从中执行并重新持久化，260–262

执行原始代码，262–263

感染目标文件，257–260

列出候选感染文件，254

VirusTotal 杀毒扫描门户，108

Visual Basic for Applications (VBA)，14

VMware，207

VST Crack 网站，10

**W**

Wacaw 工具，150

*WhatsAppService.app*，76–77

WhatsYourSign (WYS) 工具，71–73

`whoami` 命令，89

WindTail 恶意软件，10–13，59–61，70，91–95

*Info.plist* 文件，93–95

键/值对，94

`strings` 工具，112–113

Wireshark 应用程序，161–163

`writeconfig.xpc` 服务，53

`writeToFile:atomically:` 方法，Objective-C 反汇编，132

WYS (WhatsYourSign) 工具, 71–73

**X**

XAgent 恶意软件, 114

`x/b` 命令, LLDB 调试器, 175

Xcode 项目, 15–16

XCSSET 恶意软件, 15–16

`x/i` 命令, LLDB 调试器, 175

`x/s` 命令, LLDB 调试器, 175

XSLCmd 恶意软件, 53

**Y**

Yort 恶意软件, 91

**Z**

零日漏洞攻击, 18–19

ZuRu 恶意软件, 106
