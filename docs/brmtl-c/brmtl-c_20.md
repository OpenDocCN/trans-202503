# 后记

![](img/chapterart.png)

本书应该能帮助你顺利入门嵌入式 C 编程，但在*裸金属 C*之外还有一个全新的世界等着你去探索。最后，以下是一些开始走向专业编程道路的有用建议。

## 学会如何写作

到目前为止，专业程序员最重要的技能是能够写得好，因为编程过程包括撰写几种类型的文档，如提案、需求、设计文档、用户文档和销售资料。

参加一个创意写作课程，在课程中你的作品会被同学们审阅。我从圣地亚哥写作工作坊获得的反馈是我一生中最宝贵的训练之一。

这里有一个专业小贴士：如果你正在为一个项目编写设计或需求文档，你将拥有引导项目方向的巨大权力。

## 学会如何阅读

你可以通过“阅读”技术文档学到很多东西。我把“阅读”放在引号里，是因为你不会完全阅读大多数技术文档。你只是浏览它们，找到你当时需要的信息。

以下是我为本书准备过程中所使用的文档列表：

+   ISO/IEC9899:2017，“编程语言：C”（500 页）

+   RM0360 参考手册，“STM32F030x4/x6/x8/xC 和 STM32F070x6/xB 高级 ARM®-基于 32 位 MCU”（800 页）

+   ARM®开发者套件汇编指南版本 1.2, [`developer.arm.com/documentation/dui0068/b`](https://developer.arm.com/documentation/dui0068/b)（400 页）

+   “使用 GNU 编译器集合”（GCC 文档，1,000 页）

+   GNU Make 手册, [`www.gnu.org/software/make/manual`](https://www.gnu.org/software/make/manual)（225 页）

我并没有从头到尾阅读这些文档。我可能只用了其中的 0.5%到 15%。我已经熟练使用`find`命令来定位我感兴趣的文档部分。

## 合作与创意盗用

无论你多么有经验，你始终只是一个人。通过与他人合作并互相审查工作，你可以扩展自己的知识并帮助他人提升。Linux 内核就是一个很好的例子。成千上万的人分享了他们的代码，收到了反馈，改进了代码，最终将其汇集成世界上最强大的操作系统。

浏览公开的代码，看看其他程序员是如何做的，这也很有帮助。一个例子是 STM32 工作台附带的 HAL 固件。它是专业的代码，并提供了很好的内部文档。（见接下来的“Doxygen”部分。）坏消息是，它设计用于一整套不同的芯片，因此你需要应对 200 个`#ifdef`的代码块。许多优质源代码是公开的。浏览一下，看看你能学到什么。

## 有用的开源工具

开源社区有着悠久的历史，开发了许多优质工具来帮助程序的创建和编辑。这些免费工具是由想要使用它们的人开发的，而不是那些添加有助于销售程序但可能不实用的功能的商业软件。此节描述了几款有用的开源工具。

### Cppcheck

Cppcheck 程序是一个静态程序检查器。换句话说，它会查找编译器没有发现的程序问题，而现在编译器变得相当复杂，这让检查变得更具挑战性。

这个程序帮助我找到了我最喜欢的一段 C 代码。这是错误信息：

```
Detect matching 'if' and 'else if' conditions
```

换句话说，`if`语句和`else`语句的主体包含了相同的代码。如果条件成立或不成立时计算机执行相同的操作，那么这个条件是没有必要的。

下面是相关代码：

```
if (flag) {
    //(removed) processMessage()
} else {
    //(removed) processMessage()
}
```

没错，`if`语句的主体是一个被注释掉的过程调用，而`else`语句的主体则是相同的被注释掉的过程调用！

我更倾向于使用 Cppcheck，而不是大多数商业静态程序分析器，因为它生成的假阳性最少。如果 Cppcheck 标记了你代码中的某一行，最好检查一下那段代码。

### Doxygen

自从第一段程序的代码超过 50 行以来，人们就一直尝试开发能够自我生成文档的编程语言。到目前为止，他们还没有成功。Doxygen 的开发者创建了一个系统，通过在程序中添加结构化注释，你可以为程序生成文档（至少在理论上是如此）。

第一个困难是你必须在代码中添加注释，而许多工程师根本没有为他们的代码添加注释。另一个问题是，文档看起来像是自动生成的。尽管自动生成的文档其实很好，但它终究是自动生成的文档。

上一节中提到的 Cppcheck 程序使用 Doxygen 进行其内部文档生成。

### Valgrind

Valgrind 项目是一套工具，旨在动态检查你的程序中的错误。该套件中最受欢迎的工具之一是 memcheck，它用于查找诸如数组溢出、已释放的指针被再次使用等内存错误。它在检测大多数简单的运行时错误时非常有效。

### SQLite

SQLite 是一个嵌入式数据库库，适用于小型数据库（最多 10 万条记录）。它不是世界上最快的数据库，但对于不想使用大型数据库所带来开销的小型嵌入式系统来说，它运行良好。你需要学习 SQL 来使用它，但这是一项值得学习的技能。

## 永不停止学习

计算机技术正在以前所未有的速度变化。我们在本书中使用的那款 38¢的 STM 微芯片，其性能超过了 1950 年世界上所有计算机的总和。技术永远不会停止变化，因此你应该不断学习。你永远不知道转角处会有什么新发现等着你。
