# 前言

![](img/chapterart.png)

我们对连接技术的依赖正在以比我们保护它的能力更快的速度增长。那些我们知道存在漏洞的技术，暴露在计算机系统和企业中的事故和对抗中，如今正推动我们工作、提供患者护理并监控我们的家园。我们如何能将对这些设备的信任与它们固有的不可信性调和起来？

网络安全分析师 Keren Elazari 曾说过，黑客是“数字时代的免疫系统”。我们需要具有技术思维的人，来识别、报告并保护社会免受互联网连接世界带来的危害。这项工作比以往任何时候都更加重要，但具备必要心态、技能和工具的人却寥寥无几。

本书旨在增强社会的免疫系统，更好地保护我们所有人。

## 本书的方法

物联网黑客领域范围广泛，本书采用实践方法来探讨这个话题。我们专注于那些能让你快速入门并测试实际物联网系统、协议和设备的概念和技术。我们特别选择了那些价格适中且易于获得的工具和易受攻击的设备，您可以通过这些工具自行进行实践。

我们还创建了自定义的代码示例和概念验证利用程序，您可以从本书网站 [`nostarch.com/practical-iot-hacking/`](https://nostarch.com/practical-iot-hacking/) 下载。部分练习还附带虚拟机，以便您能够轻松设置目标。在某些章节中，我们还引用了流行的开源示例，您可以轻松地在线找到。

*实用物联网黑客* 不是一本关于物联网黑客工具的指南，也没有涵盖物联网安全的所有方面，因为这些话题需要更大的书籍来覆盖，那样的书籍将太笨重，不便阅读。相反，我们探索了最基础的硬件黑客技术，包括与 UART、I²C、SPI、JTAG 和 SWD 的接口。我们分析了多种物联网网络协议，重点关注那些不仅重要，而且在其他出版物中没有广泛覆盖的协议。这些协议包括 UPnP、WS-Discovery、mDNS、DNS-SD、RTSP/RTCP/RTP、LoRa/LoRaWAN、Wi-Fi 和 Wi-Fi Direct、RFID 和 NFC、BLE、MQTT、CDP 和 DICOM。我们还讨论了我们在过去的专业测试工作中遇到的真实案例。

## 本书适合谁阅读

没有两个人拥有完全相同的背景和经验。然而，分析物联网设备需要跨越几乎每个领域的技能，因为这些设备将计算能力和连接性融入到我们世界的各个方面。我们无法预测每个人会对本书的哪些部分产生最强烈的兴趣。但我们相信，将这些知识提供给广泛的群体，将赋予他们在日益数字化的世界中更大的控制力。

我们为黑客（有时被称为安全研究员）撰写了本书，尽管我们期望它对其他人也有用，例如以下个人：

+   一个**安全研究员**可能会将本书作为参考，以实验物联网生态系统中的陌生协议、数据结构、组件和概念。

+   一个**企业系统管理员**或网络工程师可能会学习如何更好地保护他们的环境和组织的资产。

+   一个**产品经理**为物联网设备可能会发现客户将假定已经存在的新需求，并构建它们，从而降低成本并缩短产品达到市场所需的时间。

+   一个**安全评估员**可能会发现一套新技能，更好地为他们的客户服务。

+   一个**好奇的学生**可能会发现一些知识，将他们推向保护人们的有益职业生涯。

本书假设读者已经对 Linux 命令行基础、TCP/IP 网络概念和编码有一些了解。虽然这些不是跟随本书的必需条件，您也可以参考补充的硬件黑客材料，例如 Colin O’Flynn 和 Jasper van Woudenberg 的*硬件黑客手册*（No Starch Press，即将推出）。我们在某些章节推荐了额外的书籍。

## Kali Linux

本书中的大部分练习使用 Kali Linux，这是最流行的用于渗透测试的 Linux 发行版。Kali 配备各种命令行工具，我们在使用它们时会详细解释。尽管如此，如果您对操作系统不熟悉，我们建议阅读 OccupyTheWeb 的*Linux 基础知识*（No Starch Press，2019 年）并探索[`kali.org/`](https://kali.org/)的材料，包括其免费课程[`kali.training/`](https://kali.training/)。

要安装 Kali，请按照[`www.kali.org/docs/installation/`](https://www.kali.org/docs/installation/)的说明进行*.* 无论你使用的版本如何，只要保持最新即可，但请记住，我们测试了 2019 年到 2020 年之间滚动版 Kali 版本中的大部分练习。如果您在安装特定工具时遇到问题，可以尝试在[`old.kali.org/kali-images/`](http://old.kali.org/kali-images/)上尝试旧版本的 Kali 镜像。新版本的 Kali 默认情况下不会安装所有工具，但您可以通过`kali-linux-large`元包添加它们。在终端中输入以下命令以安装该元包：

```
$ **sudo apt install kali-linux-large**
```

我们还建议在虚拟机中使用 Kali。详细的说明在 Kali 网站上，各种在线资源描述了如何使用 VMware、VirtualBox 或其他虚拟化技术来进行这样的操作。

## 本书的组织结构

本书共有 15 章，分为五个部分。大部分章节彼此独立，但你可能会在后面的章节中遇到之前章节介绍的工具或概念。因此，虽然我们编写本书时尽量使大多数章节自成一体，我们还是建议按顺序阅读本书。

**第一部分：物联网威胁概述**

1.  **第一章：物联网安全世界**通过描述物联网安全的重要性以及物联网黑客的特殊性，为本书的其余部分奠定了基础。

1.  **第二章：威胁建模**讨论了如何在物联网系统中应用威胁建模，并通过分析一个药物注射泵及其组件的威胁模型，介绍了常见的物联网威胁。

1.  **第三章：安全测试方法论**提出了一个强大的框架，用于对物联网系统的所有层级进行全面的手动安全评估。

**第二部分：网络黑客**

1.  **第四章：网络评估**讨论了如何在物联网网络中执行 VLAN 跳跃，识别网络上的物联网设备，以及通过创建 Ncrack 模块攻击 MQTT 认证。

1.  **第五章：网络协议分析**提供了一种处理不熟悉的网络协议的方法，并介绍了 Wireshark 解码器和 Nmap 脚本引擎模块的开发过程，针对 DICOM 协议。

1.  **第六章：利用零配置网络**探讨了用于自动化部署和配置物联网系统的网络协议，展示了针对 UPnP、mDNS、DNS-SD 和 WS-Discovery 的攻击。

**第三部分：硬件黑客**

1.  **第七章：UART、JTAG 和 SWD 利用**介绍了 UART 和 JTAG/SWD 的内部工作原理，解释了如何枚举 UART 和 JTAG 引脚，并通过 UART 和 SWD 攻击 STM32F103 微控制器。

1.  **第八章：SPI 和 I²C**探讨了如何利用这两种总线协议和各种工具攻击嵌入式物联网设备。

1.  **第九章：固件黑客**展示了如何获取、提取和分析后门固件，并检查固件更新过程中常见的漏洞。

**第四部分：无线电黑客**

1.  **第十章：短距无线电：RFID 滥用**展示了多种针对 RFID 系统的攻击，例如如何读取和克隆访问卡。

1.  **第十一章：蓝牙低功耗**展示了如何通过简单的练习攻击蓝牙低功耗协议。

1.  **第十二章：中距无线电：Wi-Fi 黑客**讨论了针对无线客户端的 Wi-Fi 关联攻击，Wi-Fi Direct 滥用方法，以及针对接入点的常见 Wi-Fi 攻击。

1.  **第十三章：长距无线电：LPWAN**通过展示如何捕获和解码这类数据包并讨论常见的攻击方式，提供了对 LoRa 和 LoRaWAN 协议的基本介绍。

**第五部分：物联网生态系统攻击**

1.  **第十四章：攻击移动应用**回顾了常见的威胁、安全问题，以及在 Android 和 iOS 平台上测试移动应用的技术。

1.  **第十五章：黑客入侵智能家居**通过描述绕过智能门锁、干扰无线报警系统和回放 IP 摄像头视频流的技术，将本书中的许多理念生动地呈现出来。该章节的高潮是通过一个现实世界的示例，展示如何控制智能跑步机。

1.  **物联网黑客工具**列出了用于实际物联网黑客的流行工具，包括我们讨论的工具以及一些虽然本书未涉及，但仍然有用的工具。

## 联系方式

我们始终欢迎收到反馈，并愿意回答您可能有的任何问题。您可以通过[errata@nostarch.com](http://mailto:errata@nostarch.com)通知我们您发现的错误，或通过[ithilgore@sock-raw.org](http://mailto:ithilgore@sock-raw.org)提供一般反馈。
