# 第十七章：索引

请注意，索引链接指向每个术语的大致位置。

**斜体页码表示术语的定义。**

**符号与数字**

*字符，255，263

8N1 UART 配置，*158*

802.11 协议，*288*

802.11w，289

**A**

AAAA 记录，138–139

A-ASSOCIATE 中止消息，96

A-ASSOCIATE 接受消息，96

A-ASSOCIATE 拒绝消息，96

A-ASSOCIATE 请求消息，*96*

C-ECHO 请求分解器，构建，101–105

定义结构，112–113

概述，96

解析响应，113–114

结构，101–102

编写上下文，110–111

ABP（通过个性化激活），*324*，326–327，330–331

抽象语法，*111*

访问位，251–*252*

访问控制，测试，49–50

访问点（APs），*287*

破解 WPA 企业版，304–305

破解 WPA/WPA2，299–300

一般讨论，287–288

概述，299

访问端口，*60*

帐户权限，测试，51

ACK 欺骗，331

通过个性化激活（ABP），*324*，326–327，330–331

主动侦察，*43*，43–45

主动 RFID 技术，*241*–242

主动爬行，*48*

活动，在 Android 应用中，*361*

活动跟踪系统，*385*

Adafruit CircuitPython

设置，318–319

编写 LoRa 嗅探器，320–322

Adafruit FT232H 扩展板，401–402

adb（Android 调试桥），360，402

`adb logcat`，367–368

`adb pull`命令，361

`AddPortMapping`命令，125–126，130

地址层，UPnP，*119*

地址搜索宏，*［204］(c08.xhtml#Page_204)*

地址空间布局随机化，*［345］(c14.xhtml#Page_345)*

管理员凭证，Netgear D6000，213–214

ADV_IND PDU 类型，271

ADV_NONCONN_IND PDU 类型，271

高级持续性威胁 (APT) 攻击，*［26］(c02.xhtml#Page_26)*

对手，6

`aes128_cmac` 函数，325

AES 128-位密钥，323，325，326

AFI（应用程序系列标识符），*［244］(c10.xhtml#Page_244)*

`-afre` 参数，135–136

后市场安全，5

Aircrack-ng，289，300–301，402

Aireplay-ng，290

Airmon-ng，289–290，297–298

Airodump-ng，290，301

Akamai，118

Akerun 智能锁 iOS 应用，357

警报，干扰无线，375–379

Alfa Atheros AWUS036NHA，402

改变 RFID 标签，255–256

亚马逊 S3 存储桶，209–210

Amcrest IP 摄像头，147–152

放大攻击，94

分析阶段，网络协议检查，92–93

Andriesse，Dennis，218

Android 应用程序。*参见* 智能跑步机，攻击

二进制逆向，362–363

动态分析，363–367

提取 APK，361

MIFARE，利用其进行攻击，256–257

网络流量，拦截与检查，367

概述，360

准备测试环境，360–361

安全控制，339–341

辅助通道泄漏，367–368

静态分析，361–362

威胁，针对，337–338

Android 调试桥 (adb)，360，402

*AndroidManifest.xml* 文件，361，365–366

Android 开源项目 (AOSP)，*［386］(c15.xhtml#Page_386)–［387］(c15.xhtml#Page_387)*

Android 包 (APK) 文件，360

利用本地文件管理器安装，391–393

二进制反向工程, 362–363

提取, 361

静态分析, 361–362

Android Studio IDE, 360

Android 验证启动, *341*

Android 虚拟设备 (AVD) 管理器, 360

Animas OneTouch Ping 胰岛素泵安全问题, 11–12

宣布阶段

ippserver, 137–138

mDNS, 132

天线, RFID, 242–243

防碰撞循环命令, 258–259

反黑客法律, 12–13

`"ANY"` 查询, 134–135

AOSP (Android 开源项目), *386–387*

APK 文件. *参见* Android 包 (APK) 文件

Apktool, 361, 402

Apkx, 361

应用目录，检查, 366

AppEUI (应用标识符), 325

AppKey, *323*, 325

应用分析方法, 210–211

应用上下文，A-ASSOCIATE 请求消息, 110–111

应用实体标题, 102

应用家庭标识符 (AFI), *244*

应用标识符 (AppEUI), 325

应用层, LoRaWAN, 324

应用日志，检查, 351–352

应用映射, 48

应用服务器, 50, *309*

应用签名, 340

应用特定攻击, LoRaWAN, 331

AppNonce, 326

AppSKey, *323*, 326

APs. *参见* 接入点 (APs)

APT (高级持续性威胁) 攻击, 26

ARC (自动引用计数), *346*

Arduino, 402

编写目标程序代码, 172–174

刷写和运行程序, 174–180

Arduino 集成开发环境 (IDE), *170*, 180

Heltec LoRa 32 开发板，设置, 309–314

设置, 170–172

设置控制器-外设 I²C 总线架构, 201–202

Arduino SAM 板, 171

Arduino Uno 微控制器, 198–202

A 记录，138–140，144

A-RELEASE 请求消息，96

A-RELEASE 响应消息，96

`ar` 参数，261–262

以资产为中心的威胁模型，*30*

关联攻击，*291*–295

Atheros AR7 设备，225–226

Atlasis，Antonios，133

`at` 参数，261–262

以攻击者为中心的威胁模型，*31*

攻击树，*28*–29

Attify Badge，403

A 型消息，96–97，99

认证

BLE，282–283

MIFARE 卡，258–259

移动应用，340–341

双向，94

嵌套认证攻击，*374*

Web 应用测试，49

授权、测试，49–50

AutoIP，119

自动设备发现，*145*

自动引用计数（ARC），*346*

自动化

固件分析，215–216

使用脚本引擎的 RFID 攻击，263–264

应用源代码的静态分析，346，361

AVD（Android 虚拟设备）管理器，360

**B**

后门代理，*223*–228

Baksmali，368–369

横幅抓取，*44*

基站，*372*

电池消耗攻击，*42*

波特率，162–163，*317*

`b` 命令，349

信标帧，*293*

信标，*270*

Beagle I2C/SPI 协议分析仪，403

钉床过程，*164*

Bettercap，*276*

发现设备并列出特性，276–278

破解 BLE，279–285

概览，403

BinaryCookieReader，350–351，403

二进制仿真，216–217

二进制逆向

InsecureBankV2 应用，362–363

OWASP iGoat 应用，355–356

*bin/passwd* 二进制文件，213

Binwalk，212，219，403

`binwalk` Nmap 命令，70–71

BIOS 安全测试，41

位翻转攻击，327–330

Black Magic Probe，165

Black Pill（STM32F103C8T6）

选择启动模式，174–175

在 Arduino 中编码目标程序，172–174

连接到计算机，179–180

连接 USB 到串行适配器，178

调试目标，181–188

刷写并运行 Arduino 程序，174–180

概览，169–170，412

UART 引脚，通过逻辑分析仪识别，176–177

上传 Arduino 程序，175–176

BladeRF，403

BLE（蓝牙低能耗）。*参见* 蓝牙低能耗（BLE）

BLE CTF 无限

认证，282–283

检查特性和描述符，281–282

入门，279–280

概览，278

设置，279

欺骗 MAC 地址，283–285

`ble.enum` 命令，284

`ble.show` 命令，276

`ble.write` 命令，278

BlinkM LED，198–202，404

蓝牙低能耗（BLE），*269*。*参见* BLE CTF 无限

BlueZ，273–274

配置接口，274–275

发现设备，275–278

GAP，271–272

GATT，272

一般讨论，270–272

硬件，273

列出特性，275–278

概览，269–270

数据包结构，271

BlueZ，*273*–274

Bolshev, A.，367

Bolt，Usain，400

Bonjour，138–139

启动环境，安全测试，41

启动模式，ST-Link 编程器，174–175

边界扫描，*164*

面包板，*169*

调试中的断点，设置，349

发布-订阅架构中的代理, 73

暴力破解攻击, 213–214

克隆 MIFARE Classic 卡, 252–253

预共享密钥攻击, 301

RFID 读卡器认证控制, 262–263

Wi-Fi Direct, 296–297

BSSID, 288

`bufsiz` 变量, 173

IoT 设备的内建安全性, 5

捆绑容器, *347*

Burp Proxy Suite, 356–357

Burp Suite, 404

Bus Blaster, 404

Bus Pirate, *190*

攻击 I²C, 202–206

与 SPI 芯片通信, 194–195

概述, 190, 404

读取内存芯片内容, 196

BusyBox, *67*

busybox 文件, *217*

BYPASS 命令, JTAG, 164

**C**

CA（SSL 证书颁发机构）, 357

摄像头, IP. *参见* IP 摄像头

Capture the Flag (CTF). *参见* BLE CTF Infinity

CatWAN USB Stick, *309*, 404

转换为 LoRa 嗅探器, 318–322

`cbnz` 命令, 185–186

C-ECHO 消息, *96*–97

C-ECHO 请求分析器, 构建, 101–105

中央设备, *270*

证书透明性, *37*

CFAA（计算机欺诈和滥用法案）, 12–13

特性, BLE, *272*

检查, 281–282

列出, 275–278

`char-read-hnd <handle>` 命令, 282

`charset` 变量, 265

`checkEmulatorStatus()` 函数, 368–369

`check_fwmode` 文件, 71

芯片选择（CS）, 191

ChipWhisperer, 404

`chk` 命令, 252–253

`chmod a+x <script_name>.js` 命令, 328

`chmod` 工具, 376

基于密码的消息认证码 (CMAC), *325*

CIPO（控制器输入，外围设备输出）, 191

CIRCUITPY 驱动, 319, 320

CircuitPython, 405

设置, 318–319

编写 LoRa 嗅探器, 320–322

模拟 Cisco VoIP 设备，66–67

类别，RFID 标签，243

*classes.dex* 文件，361

客户端，WS-Discovery，*145–146*

客户端代码，固件更新机制，229–232

客户端冒充攻击，94

客户端，列举和安装，90

客户端控制，*48*–49

克隆 RFID 标签

高频，250–254

锁系统的，372–375

低频，249

云测试，54

Clutch，344，405

CMAC（基于密码的消息认证码），*325*

`cmd` 结构，85

行为规范，英国，14

*code.py* 文件，319，320

*com.android.insecureBankv2.PostLogin* 文件，368

组合攻击，*214*

IoT 设备的组成，6

计算机欺诈与滥用法（CFAA），12–13

`config_load "upnpd"` 命令，123–124

配置文件

固件中的凭证查找，214–215

OpenOCD 服务器，181–182

`ConfigureConnection` 命令，129

*CONNACK* 数据包，MQTT，75–76，80，82–84

`connect <mac address>` 命令，275

*CONNECT* 数据包，MQTT，74，80–82

`content update` 命令，398

上下文，DICOM，*103*–104

IoT 设备的上下文，6

`continue` 命令，GDB，185

连续性测试，161

控制数据，RFID 标签中的 *243*

控制层，UPnP，*120*

控制器输入，外设输出（CIPO），191

控制器输出，外设输入（COPI），191

控制器-外设 I²C 总线架构，设置，198–202

控制服务器，药物输注泵，19，20

控制服务器服务，*20*，23–24

Cookies，读取，350–351

COPI（控制器输出，外设输入），191

CoreData 框架，*348*

核心，171

制作攻击，152–153

CRCs（循环冗余校验），*243*, 313, 324

凭证

在固件配置文件中查找，214–215

固件更新服务漏洞，233–234

WS-Discovery 攻击，153

*Credentials.plist* 文件，345

婴儿床拖动，*331*

跨站请求伪造 (CSRF) 攻击，*49*

加密密钥，8

CS（芯片选择），191

CSRF（跨站请求伪造）攻击，49

CTF。*参见* BLE CTF 无限

CubicSDR, 376–378, 405

循环冗余校验 (CRC)，*243*, 313, 324

Cydia Impactor，344

**D**

Dalvik 可执行文件 (DEX) 格式，361

Damn Vulnerable ARM Router (DVAR), 235

Damn Vulnerable IoT 设备 (DVID)，235

Darkside 攻击，*373*–374

仪表盘 APK，397–398, 400

应用程序数据库，检查，366–367

数据位，UART，158

数据容器，*347*

数据加密，测试，53

数据链路层，*131*

数据保护，移动应用，339–340

数据表，*37*

数据存储格式标识符 (DSFID)，*244*

DDoS（分布式拒绝服务攻击），4–5

断开身份验证帧，*289*

去身份验证攻击，289–291

调试

接口评估，42

黑色药丸

使用 GDB，183–188

设置环境，170–172

在移动应用程序上，348–349

调试符号，183

`#define` 指令，229

`DeletePortMapping` 命令，130

拒绝服务攻击，*22*

ACK 欺骗，331

在控制服务器服务上，24

在药物库上，24

在固件上，26

在硬件上，27

在 IP 摄像头上，152–153

在操作系统上，25

在泵服务上，28

在限制性用户界面上，22–23

STRIDE 威胁分类模型，19

针对无线客户端，289–291

依赖协议，发现，90

描述层，UPnP，*119*

描述 XML 文件，*119*–120

描述符，BLE，*272*， 281–282

DevAddr（终端设备地址），*324*， 326

DevEUI（终端设备标识符），325

设备认证，*18*

设备引导加载程序，211

设备发现阶段，Wi-Fi Direct，296

DevNonce，325

DEX（Dalvik 可执行）文件格式，361

Dex2jar，361， 405

添加用户名到 dialout 组，310

`dicom_protocol .dissector()` 函数，102

`dicom.associate()` 函数，114–115

`dicom.pdu_header_encode()` 函数，113

DICOM Ping，*96*–97

DICOM 协议，*95*。*另见* DICOM 服务扫描器

C-ECHO 请求解码器，构建，101–105

一般讨论，95–97

Lua Wireshark 解码器，开发，99–101

流量，生成，97

DICOM 服务扫描器，*105*

A-ASSOCIATE 请求消息，110–114

代码和常量，定义，106–107

最终脚本，编写，113–114

发送和接收数据包的函数，108–109

Nmap 脚本引擎库，创建，106

概述，105

数据包头，创建，109–110

脚本参数，在 Nmap 脚本引擎中读取，112

套接字创建和销毁函数，107–108

`dicom.start_connection()` 函数，107–108

字典攻击，*49*

差分功率分析，*42*

数字千年版权法（DMCA），12–13

数字签名，94

指令，Nmap 服务探测，72

`disassemble` 命令，GDB，184–185

取消关联帧，*289*

发现 BLE 设备，275–278

发现层，UPnP，*119*

`dissector()` 函数，99–100

解码器

C-ECHO 请求，构建，101–105

Lua Wireshark，99–101

测试 Wireshark，91

分布式拒绝服务（DDoS），4–5

DMCA（数字千年版权法），12–13

`dmesg` 命令，246

域名系统服务发现（DNS-SD），*131*

使用进行侦察，133–134

一般讨论，132–133

中间人攻击

mDNS 投毒器，创建，141–144

mDNS 投毒器，测试，144–146

典型客户端与服务器交互，139–140

受害者客户端，设置，138–139

受害者服务器，设置，136–138

概述，132

`Dot1Q()` 函数，64

双标签攻击，63–65

降级攻击，94

停机时间，*52*

DREAD 分类方案，29–30

Drozer，363–365，405

药物输注泵

架构，19–21

识别威胁

使用攻击树，28–29

控制服务器服务，23–24

药物库，24

固件，25–26

操作系统，25

概述，21–22

物理设备，26–27

泵服务，27–28

RUI，22–23

DSFID（数据存储格式标识符），*244*

DTP（动态中继协议），*61*

*dumpedkeys.bin* 文件，253–254

`dump` 参数，253–254

`dumptoemul` 脚本，263

DVAR（极易受攻击的 ARM 路由器），235

DVID（极易受攻击的物联网设备），235

动态分析

固件，221–223

InsecureBankV2 应用，363–367

OWASP iGoat 应用，347–353

动态补丁

绕过越狱检测，357–358

绕过 root 检测，369–370

动态中继协议（DTP），*61*

**E**

EAP over LAN (EAPOL) 握手, 299–*300*

EAP-TLS, 304–305

EAP-Tunneled-TLS (EAPTTLS), 304–305

窃听, *331*

LoRaWAN, 331

在标签到读取器通信中, 260–261

Eclipse Mosquitto 软件, 75

IoT 制造的经济学, 6

EEPROM 闪存芯片, 使用 SPI 转储, 192–196

`eget` 命令, 256

电子健康记录 (EHR), *19*

权限提升, *23*

在控制服务器服务上, 24

在药物库上, 24

在固件上, 26

在硬件上, 27

在操作系统上, 25

在泵服务上, 28

在受限用户界面上, 23

智能跑步机, 攻击, 394

STRIDE 威胁分类模型, 19

ELF (可执行和可链接格式) 文件, *183*

`eload` 参数, 255, 265

紧急停止按钮, *398*

*.eml* 文件, 加载到 Proxmark3 内存中, 265

仿真, 固件, 216–221

Wireshark 的启用协议窗口, 91–92

加密

检查, 94

移动应用程序文件系统, 339–340

测试, 53

终端设备地址 (DevAddr), *324*, 326

终端设备标识符 (DevEUI), 325

协议的字节顺序, 93

EPSON 的 iPrint 应用程序, 363

提升权限。*参见* 权限提升

`eset` 参数, 255

ESP32 开发板, 273, 309–314

ESSID, 288

*etc/passwd* 文件, 213, 221

`Ether()` 函数, 64

事件层, UPnP, *120*

EvilDirect 攻击, *297*–299

恶意双胞胎攻击, *291*–292

exacqVision, 147–152

`Exclude` Nmap 服务探测指令, 72

可执行和可链接格式 (ELF) 文件, *183*

可执行二进制文件, 检查内存保护, 345–346

利用, 协议或服务, 47

Android 应用中的导出活动, 361

局域网（EAPOL）握手中的可扩展认证协议（EAP），299–*300*

外部实体（XXE）攻击， *121*

EXTEST 命令，JTAG，164

**F**

FACT（固件分析与比较工具），406

失败开放条件， *49*

假装网络中的摄像头

在 Wireshark 中分析请求和回复，147–149

模拟摄像头，149–152

设置，147

`fallback` Nmap 服务探测指令，72

FBE（基于文件的加密）， *339*–340

FCC ID 在线数据库，37–38

`fchk` 命令，253

FCntDown 帧计数器，330

FCntUp 帧计数器，330

FDE（全盘加密）， *339*–340

影响物联网研究的联邦法律，12–13

Fernandes, E.，368

`fetchButtonTapped` 函数，358–359

FFmpeg，384

FHDR（帧头），324

基于文件的加密（FBE）， *339*–340

文件管理器应用程序，跑步机浏览器，392–393

文件结构，iOS，347

文件系统

访问控制，测试，53

固件，212–216

移动应用，339–340

`find` 命令，347

指纹识别， *44*， 67–71

防火墙

在固件中禁用，222

穿透防火墙，121–126

FIRMADYNE， *216*， 218–221， 227， 405

Firmwalker，215–216， 405

固件， *25*。 *另见* 固件更新机制；Wi-Fi 调制解调器路由器黑客攻击

后门攻击，223–228

一般讨论，208

识别对防火墙的威胁，25–26

获取，209–211

安全测试，42

固件分析与比较工具（FACT），406

固件工具包，226

固件更新机制， *228*

客户端代码，229–232

编译和设置，229

一般讨论，228

运行更新服务，232–233

漏洞，233–235

固定头部，MQTT *CONNECT* 数据包，*80*–82

标志，355

闪存芯片，使用 SPI 转储，192–196

`flashrom` Linux 工具，195–196

泛洪攻击，94

流程图，38–39

强制浏览，*50*

`ForceTermination` 命令，129

`fork()` 命令，224

福肖，詹姆斯，92，116

傅里叶变换，47

四次握手，WPA/WPA2，299–300

FPort，324

帧头 (FHDR)，324

框架，*8*–10

Frida 插桩框架，406

越狱检测，避免，357–358

根目录检测，避免，369–370

跑步机软件和物理按钮，禁用，398–399

FRMPayload，324，327

`fs` 命令，355

`fswatch` 应用程序，347–348

FTDI FT232RL，406

完整磁盘加密 (FDE)，*339*–340

熔断，*32*

`fuzz()` 函数，266

模糊测试

概述，94

RFID, 使用自定义脚本, 264–268

**G**

GAP (通用访问配置文件)，*271*–272

加西亚，丹尼尔，118，128

加尔格，普雷里特，18

网关，LoRaWAN，*309*

GATT (通用属性配置文件)，*272*

GATTTool，*275*，406

发现设备并列出特征，275–276

破解 BLE，279–285

读取和写入特征，278

GDB，*172*，406

使用调试，183–188

安装，172

`gdb-multiarch` 命令，183

盖革，哈利，12–13

通用访问配置文件 (GAP)，*271*–272

通用属性配置文件 (GATT)，*272*

通用属性配置文件工具 (GATTTool)。*参见* GATTTool

`GetAutoDisconnectTime` 命令，129

`GetConnectionTypeInfo` 命令，128

`GetExternalIPAddress` 命令，130

`GetGenericPortMappingEntry` 命令，129

`GetIdleDisconnectTime` 命令，129

`GetLinkLayerMaxBitRates` 命令，129

`GetNATRSIPStatus` 命令，129

`GetPassword` 命令，129

`GetPPPAuthenticationProtocol` 命令，129

`GetPPPCompressionProtocol` 命令，129

`GetPPPEncryptionProtocol` 命令，129

`GetSpecificPortMappingEntry` 命令，129

`GetStatusInfo` 命令，129

`GetUserName` 命令，129

`GetWarnDisconnectDelay` 命令，129

Ghidra，185，406

`git` 命令，226–227

闪烁攻击， *42*

地线（GND），197，199

GND（地面）端口，UART，159，161–162，178

GNUcitizen，118

GNU 调试器（GDB）， *172*

调试， 183–188

安装，172

Goldberg，Dave，400

Goode，Lauren，4

Google Dorks，209

地面（GND）端口，UART，159，161–162，178

地线（GND），197，199

组所有者， *295*

组临时密钥（GTK）， *300*

指导文档， *8*–10

**H**

HackRF One，407

HAL（硬件抽象层）， *396*

`halt` 命令，182

硬编码凭据，233–234

硬件

BLE，273

识别威胁，26–27

安全测试，40–43

智能跑步机设计，394–396

用于 Wi-Fi 安全评估，288

硬件抽象层（HAL）， *396*

硬件抽象层 APK，396

硬件文件夹，Arduino IDE，170–171

硬件完整性攻击， *32*

Hashcat，213–214，302，304，407

hashid，213–214

哈希算法，不安全，234

Hciconfig, *274*

Hcxdumptool, 302–303, 407

`hcxpcaptool` 命令, 303

Hcxtools, 302, 407

Heffner, Craig, 163

Heltec LoRa 32 开发板, *309*

概述, 309, 407

作为 LoRa 发送器的编程, 310–313

设置, 309–310

测试 LoRa 发送器, 310–314

`hf 14a raw` 命令, 258–259

hf-mf-B46F6F79-data.bin 文件, 254

`hf mf` 命令, 251

`hf mf ecfill` 命令, 374

`hf mf mifare` 命令, 373–374

`hf mf nested` 命令, 374

`hf mf rdsc` 命令, 253

`hf mf sim` 命令, 262–263, 375

`hf` 参数, 248

`hf search` 命令, 258, 372–373

Hickory Smart 应用, 351

隐藏内容, *48*

隐藏的 Wi-Fi 网络, *288*

HID Global ProxCard, 244, 246

`hid` 参数, 249

高频 RFID

天线, 243

克隆标签, 250–254

一般讨论, 245

使用 Proxmark3 进行识别, 248–249

HiLetgo USB 逻辑分析仪, 176–177

连接医疗设备的希波克拉底誓言, 9

HMAC-MD5, 234

Homebrew 包, 347–348

主机配置审查, *50*–54

主机发现, *43*

HTTP 缓存, 350

华为 HiLink 应用, 353

Hydrabus, 407

**I**

I²C。*见* 集成电路间总线（I²C）

我是骑兵框架, 5–6, 9

IDA Pro, 408

IDE（集成开发环境），Arduino。*见* Arduino 集成开发环境（IDE）

RFID 标签中的身份数据, *243*

空闲状态, UART, 158

IDOR（不安全的直接对象引用）, *54*

IGD（互联网网关设备）协议。*见* 互联网网关设备（IGD）协议

iGoat 移动应用

二进制反向工程, 355–356

动态分析, 347–353

注入攻击, 353–354

IPA，提取和重新签名, 343–344

避免越狱检测, 357–360

钥匙链存储, 354

拦截和检查网络流量, 356–357

概述, 341–342

静态分析, 344–346

测试环境，准备中, 342–343

`iI` 命令, 355

隐式头模式, 322

跑步机的倾斜度，远程控制, 394–398

`info functions` 命令，GDB, 183–184

`info registers` 命令，GDB, 185

信息泄露, *22*

关于控制服务器服务, 24

关于药物库, 24

关于固件, 26

关于硬件, 27

关于操作系统, 25

关于泵服务, 28

关于限制性用户界面, 22

STRIDE 威胁分类模型, 19

信息收集阶段，网络协议检查, 90–91

信息对象定义（IODs）， *110*–111

信息属性列表文件, *344*–345

`init` 命令, 182

注入攻击

OWASP iGoat 应用程序, 353–354

SQL, 24, 120, 354

XSS, 353–354

跑步机攻击造成的伤害, 400

输入验证, 50

InsecureBankV2 应用程序

二进制逆向分析, 362–363

动态分析, 363–367

提取 APK, 361

拦截和检查网络流量, 367

概述, 360

准备测试环境, 360–361

边信道泄露, 367–368

静态分析, 361–362

不安全的直接对象引用（IDOR）, *54*

不安全的哈希算法, 234

不安全的金丝雀, 14

胰岛素泵, 11–12, 16

内部集成电路（I²C）， *189*

使用 Bus Pirate 进行攻击, 202–206

控制器-外设总线架构，设置，198–202

一般讨论，197–198

与之通信的硬件，190–191

概述，189

互联网网关设备（IGD）协议，*121*

通过 WAN 接口滥用 UPnP，126–131

穿越防火墙，121–122，124–125

物联网（IoT），*3–4*

IOD（信息对象定义），*110*–111

iOS 应用

二进制反向工程，355–356

动态分析，347–353

注入攻击，353–354

IPA，提取和重新签名，343–344

避免越狱检测，357–360

钥匙串存储，354

网络流量，拦截和检查，356–357

概述，341–342

安全控制，339–341

静态分析，344–346

测试环境，准备，342–343

威胁，337–338

iOS 应用商店包（IPA），*343*–344

物联网（IoT），*3–4*

物联网设备，识别网络中的设备

指纹识别服务，67–71

Nmap 服务探测，编写新，71–73

物联网安全

专家观点，12–16

框架、标准和指南，8–10

黑客技术，6–8

重要性，4–5

胰岛素泵安全问题，11–12

传统安全与，5–6

IPA（iOS 应用商店包），*343*–344

IP 摄像头

在网络上伪装

在 Wireshark 中分析请求和回复，147–149

模拟摄像头，149–152

设置，147

Nmap 服务探测，编写，71–73

播放流媒体

分析网络流量，380–382

提取视频流，382–385

概述, 379–380

流媒体协议, 380

服务指纹识别, 67–71

WS-Discovery 攻击, 152–153

`IP()` 函数, 64

ippserver, *136*–137, 140, 145

`iptables` 工具, 222

iRemocon- WiFi 应用, 367

`iwconfig` 命令, 299

**J**

JADX, 361, 408

越狱检测, 避免, 357–358

干扰无线警报, 375–379

Jarsigner, 369

John the Ripper, 213–214, 408

Join-Accept, 326

加入 LoRaWAN 网络, 324–327

Join-Request, 325–326

联合测试行动小组 (JTAG), *157*

边界扫描命令, 164

用于通信的硬件工具, 165

标识引脚, 166–167

概述, 157–158, 164

测试接入端口 (TAP), 164–165

JTAGenum 工具, 167

JTAGulator, *166*, 408

跳线引脚, *175*

跳线, 169

Junior, M., 366

**K**

KARMA 攻击, *292*

钥匙链服务 API, *354*

钥匙链存储, iGoat 应用, 354

密钥生成与管理, LoRaWAN, 330

钥匙锁系统, 克隆 RFID 标签, 372–375

Keytool, 369

kiosk 模式, *40*–41

已知信标攻击, *292*–295

Kohnfelder, Loren, 18

Kr00k, 291

**L**

影响物联网研究的法律, 12–13

合法的 RFID 阅读器攻击, 262–263

`lf` 参数, 248

LimeSDR, 408

`list` 命令, GDB, 184–185

LLDB, 348–350, 408

`llvm clang` 静态分析器, 346

`load_seed_tag()` 函数, 265, 266

本地链路协议, 131–132

本地范围辅助函数, *79*

锁定机制， *51*

锁定，评估， 41

日志文件，敏感， 234

日志记录，UPnP， 121

逻辑分析仪， *162*， 163， 176–177

逻辑缺陷， 50

长距离（LoRa）， *307–308*。*另见* LoRaWAN 协议

CatWAN USB 设备，将其转变为 LoRa 嗅探器， 318–322

Heltec LoRa 32，设置， 309–314

LoStik，设置， 314–318

概述， 308–309

物理层， 323–324

发送数据包， 311–313

`loop()` 函数， 173–174， 313

`LoRa.endPacket()` 函数， 313

*lora-packet* 库， 328–329

`LoRa.print()` 函数， 313

LoRaWAN 协议

ACK 欺骗， 331

应用特定攻击， 331

位翻转攻击， 327–330

窃听， 331

一般讨论， 308–309

加入网络， 324–327

密钥生成与管理， 330

概述， 318–322

数据包格式， 323–324

重放攻击， 330–331

LoStik， *309*， 314–318， 409

低频 RFID

用于的天线， 243

克隆标签， 249

一般讨论， 244–245

使用 Proxmark3 进行识别， 248–249

低功耗广域网（LPWAN），* 307 *–309。*另见* 长距离（LoRa）；LoRaWAN 协议

Lua， *95*。*另见* DICOM 服务扫描器

在 Wireshark 中启用， 97–99

一般讨论， 95

生成 DICOM 流量， 97

使用进行原型开发， 93

Wireshark 分析器，开发 DICOM 协议， 99–101

**M**

MAC 地址，欺骗， 283–285

MAC 头（MHDR）， *324*

MAC 层，LoRaWAN， 324

`mac pause` 命令， 316

MACPayload， 324

宏，*I²C* 库，［204］(c08.xhtml#Page_204)–［205］(c08.xhtml#Page_205)

`main()` 函数，［142］(c06.xhtml#Page_142)，［229］(c09.xhtml#Page_229)–［232］(c09.xhtml#Page_232)

`make` 命令，［226］(c09.xhtml#Page_226)

Malith，Osanda，［224］(c09.xhtml#Page_224)

管理服务账户，*［52］(c03.xhtml#Page_52)*

管理帧，*［288］(c12.xhtml#Page_288)*

中间人攻击，*［23］(c02.xhtml#Page_23)*。*另见* 回放 IP 摄像头流

在控制服务器服务上，［23］(c02.xhtml#Page_23)

iOS 应用，［356］(c14.xhtml#Page_356)–［357］(c14.xhtml#Page_357)

mDNS 或 DNS-SD

mDNS 中毒攻击者，创建，［141］(c06.xhtml#Page_141)–［144］(c06.xhtml#Page_144)

mDNS 中毒攻击者，测试，［144］(c06.xhtml#Page_144)–［146］(c06.xhtml#Page_146)

典型客户端和服务器交互，［139］(c06.xhtml#Page_139)–［140］(c06.xhtml#Page_140)

受害者客户端，设置，［138］(c06.xhtml#Page_138)–［139］(c06.xhtml#Page_139)

受害者服务器，设置，［136］(c06.xhtml#Page_136)–［138］(c06.xhtml#Page_138)

通过获得固件，［211］(c09.xhtml#Page_211)

系统手册，［37］(c03.xhtml#Page_37)

制造商数据，*［244］(c10.xhtml#Page_244)*

`match` Nmap 服务探测指令，［72］(c04.xhtml#Page_72)

MCU（微控制器单元），*［211］(c09.xhtml#Page_211)*

MD5 哈希，［232］(c09.xhtml#Page_232)

MDM（移动设备管理），*［386］(c15.xhtml#Page_386)*

mDNS。*参见* 多播域名系统（mDNS）

`MDNS` 类，创建，［143］(c06.xhtml#Page_143)–［144］(c06.xhtml#Page_144)

mDNS 中毒攻击者

创建，［141］(c06.xhtml#Page_141)–［144］(c06.xhtml#Page_144)

测试，［144］(c06.xhtml#Page_144)–［146］(c06.xhtml#Page_146)

典型客户端和服务器交互，［139］(c06.xhtml#Page_139)–［140］(c06.xhtml#Page_140)

受害者客户端，设置，［138］(c06.xhtml#Page_138)–［139］(c06.xhtml#Page_139)

受害者服务器，设置，［136］(c06.xhtml#Page_136)–［138］(c06.xhtml#Page_138)

`MDNS_poisoner` 函数，［142］(c06.xhtml#Page_142)

mDNS 反射 DDoS 攻击，［94］(c05.xhtml#Page_94)

`mdw` 命令，［182］(c07.xhtml#Page_182)

医疗设备安全

胰岛素泵安全问题，［11］(c01.xhtml#Page_11)–［12］(c01.xhtml#Page_12)

患者视角，［14］(c01.xhtml#Page_14)–［16］(c01.xhtml#Page_16)

内存损坏漏洞，［120］(c06.xhtml#Page_120)

消息完整性码（MIC），*［300］(c12.xhtml#Page_300)*，［323］(c13.xhtml#Page_323)–［326］(c13.xhtml#Page_326)

消息队列遥测传输（MQTT）

发布-订阅架构，［73］(c04.xhtml#Page_73)–［74］(c04.xhtml#Page_74)

测试环境，设置，［75］(c04.xhtml#Page_75)–［76］(c04.xhtml#Page_76)

测试 Ncrack 模块，［86］(c04.xhtml#Page_86)–［87］(c04.xhtml#Page_87)

在 Ncrack 中编写身份验证破解模块，［77］(c04.xhtml#Page_77)–［86］(c04.xhtml#Page_86)

`mfkey64` 工具，［262］(c10.xhtml#Page_262)

`mfkeys` 脚本，［263］(c10.xhtml#Page_263)

MHDR（MAC 头），*［324］(c13.xhtml#Page_324)*

MIC（消息完整性码），*［300］(c12.xhtml#Page_300)*，［323］(c13.xhtml#Page_323)–［326］(c13.xhtml#Page_326)

微控制器黑客攻击

启动模式, 选择, 174–175

在 Arduino 中编写目标程序, 172–174

连接到计算机, 179–180

连接 USB 到串口适配器, 178

设置调试环境, 170–172

调试目标, 181–188

烧录并运行 Arduino 程序, 174–180

STM32F103C8T6 目标设备, 169–170

工具, 168–169

使用逻辑分析仪识别 UART 引脚, 176–177

上传 Arduino 程序, 175–176

微控制器单元 (MCU), *211*

MIFARE 卡片

访问位, 251

更改 RFID 标签, 255–256

使用 Android 应用进行攻击, 256–257

认证协议, 258, 259

克隆 Classic 卡片, 250–254

克隆钥锁系统的 RFID 标签, 372–375

从捕获的流量中提取私钥, 261–262

MIFARE Classic 内存映射, 250

概述, 245

原始命令, 通过读取, 258

模拟 RFID 标签, 254–255

MIFARE Classic 工具, 256–257

mini ST-Link 编程器, *168*

MiniUPnP, 设置, 122–124

Mirai 僵尸网络, 4–5, 6

Miranda, 125, 130, 409

移动应用. *另见* iGoat 移动应用; InsecureBankV2 应用

结构, 336

一般移动设备威胁, 337

概述, 335–336

避免 root 检测, 368–370

安全控制, 339–341

安全测试, 54

威胁, 337–338

移动设备管理 (MDM), *386*

移动安全框架 (MobSF), 346, 409

ModemManager, 247

`modprobe` 命令, 63

Moe, Marie, 15

监控模式, AP, *288*

Moore, H.D., 118

*.mpy* 文件, 319

MQTT. *参见* 消息队列遥测传输 (MQTT)

`MQTT_FINI` 状态, Ncrack, 79–80, 85–86

`MQTT_INIT` 状态, Ncrack, 79–80, 84–86

`mqtt_loop_read` 函数, 79, 83, 86

`msearch` 命令, 125

M-SEARCH 请求, *119*

MU 编辑器, 320–322

多播域名系统 (mDNS), *131*

滥用探测阶段, 134–136

一般讨论, 132

中间人攻击

创建 mDNS 欺骗者, 141–144

测试 mDNS 欺骗者, 144–146

典型的客户端和服务器交互, 139–140

受害客户端，设置, 138–139

受害服务器，设置, 136–138

概述, 131–132

与之进行侦察, 133–134

多用表, *160*–162

基于变异的模糊测试, 264

相互认证, 94

MyCar 控制移动应用, 356

**N**

NAC（网络访问控制）, 18

窄带（NB-IoT）, *308*

NAT（网络地址转换）, *121*

原生 VLAN, 63, *63*

NB-IoT（窄带）, *308*

`ncat` Nmap 命令, 69

Ncrack, *74*, 409

架构, 77

编译, 77–78

初始化模块, 78–79

概述, 77

测试模块对 MQTT, 86–87

编写认证破解模块, 77–86

`ncrack_mqtt` 函数, 84–86

*ncrack-services* 文件, 78

近场通信（NFC）, *245*, 296

嵌套认证攻击, *374*

Netgear D6000

动态分析, 221–223

提取文件系统, 212

固件仿真, 216–221

概述, 211–212

静态分析文件系统内容, 213–216

支持页面, 211

网络应用, 223

NetID（网络标识符）, 326

`netstat` 命令，222

网络访问控制（NAC），*18*

网络地址转换（NAT），*121*

网络评估

在网络上识别物联网设备，67

使用指纹识别服务，67–71

Nmap 服务探测，编写新探测，71–73

MQTT，攻击

概述，73–74

测试环境，设置，75–76

对 MQTT 进行 Ncrack 模块测试，86–87

在 Ncrack 中编写身份验证破解模块，77–86

概述，59

VLAN 跳跃攻击

双重标签攻击，63–65

模拟 VoIP 设备，65–67

概述，60

交换机欺骗攻击，61–63

VLAN 和网络交换机，理解，60–61

网络标识符（NetID），326

网络层，*43*–47

网络打印机，中间人攻击。*参见* mDNS 欺骗工具

网络协议。*另请参见* DICOM 协议

分析阶段，92–93

C-ECHO 请求分析器，构建，101–105

信息收集阶段，90–91

概述，89–90

原型制作与工具开发，93

安全评估，93–94

攻击的阶段，45–47

网络服务器，*309*

网络套接字，设置，150

网络交换机，60–61

网络流量

的分析，46

使用 Wireshark 进行分析，92

InsecureBankV2 应用，367

IP 摄像头流分析，380–382

获取副本，92

OWASP iGoat 应用，356–357

`NewInternalClient` bug，120

NFC（近场通信），*245*，296

Nmap，409

指纹识别服务，67–71

编写新的服务探测，71–73

*nmap* 库，106–107

Nmap 脚本引擎（NSE），112。*另请参见* DICOM 服务扫描器

Nmap 脚本引擎（NSE）库，106

*nmap-service-probes* 文件, 68, 70, 72

`nmcli` 命令, 63

node-applesign, 344

节点克隆, *32*

Node.js, 327–328

节点, LoRaWAN, *309*

NOTIFY 消息, 119

NotPetya 攻击, 5

`npm` 包管理器, 328

`nr` 参数, 261–262

NSE（Nmap 脚本引擎）, 112。*另见* DICOM 服务扫描器

NSE（Nmap 脚本引擎）库, 106

*nsedebug* 库, 106

NSEdoc 块格式, 108

`nsock_iod` 变量, 85

`nsock_read` 变量, 85

`nsock_write` 变量, 85

*Nsock* 库, 77

`nt` 参数, 261–262

`NULL` 探测, Nmap, 72

NwkSKey, *323*, 326

NXP 卡, 245

**O**

OhMiBod Remote Android 应用, 367

*ojbc.pl* 脚本, 355

ONVIF, 145

开漏驱动, *197*

打开模式, Wi-Fi 网络, *288*

OpenOCD（开放芯片调试器）, *165*

安装, 171–172

概述, 165, 409

开源情报（OSINT）, *37*–40

开放 Web 应用程序安全项目（OWASP）, 9–10。*另见* iGoat 移动应用

OpenWrt

编译后门代理, *225*–226

测试 UPnP 服务器, 设置, 122–125

操作系统, 25, 44

Orthanc, *97*

OSINT（开源情报）, *37*–40

Otool, 345–346, 410

空中下载 (OTA) 更新, 26

空中激活（OTAA）方法, *323*–326, 330–331

OWASP（开放 Web 应用程序安全项目）, 9–10

OWASP iGoat 项目。*参见* iGoat 移动应用

OWASP IoTGoat, 235

OWASP Zed Attack Proxy (ZAP), 410

**P**

起搏器, 15

数据包格式

LoRaWAN, 323–324

UART, 158

数据包注入功能, *288*

数据包结构, BLE, 271

降级遗留加密（POODLE）攻击，94

焊盘，UART，*159*

成对主密钥（PMK），300

成对主密钥标识符（PMKID）字段，*299*，301–304

成对瞬态密钥（PTK），300

并行通信协议，*158*

奇偶校验位，UART，158

解析可变长度字段，103–104

被动侦察，*37*–40，292

被动 RFID 技术，*241*–242

被动蜘蛛爬行，*48*

密码过期，*51*

密码历史，*51*

密码

破解 Netgear D6000 管理员凭证，213–214

过期，51

固件更新服务漏洞，233–234

历史，51

在安卓应用中的重置，363–365

强度，测试，51

通过指纹识别服务的揭露，67–71

剪贴板，*353*

补丁级别，测试，52

专利，38

载荷，MQTT *CONNECT* 数据包，*81*–82

PBC（按键配置），*296*，297–299

PCB。*见* 印刷电路板（PCB）

（P-DATA-TF）消息，96

`pdc` 命令，356

`pdf` 命令，356

`pdu_header_encode()` 函数，110

PDU（协议数据单元），96–97，271

PEAP（保护的 EAP），304–305

渗透测试。*见* 安全测试方法

感知层，测试，47

外围接口，*40*–41

个人身份信息（PII），*53*

PHDR（物理头部），324

PHDR_CRC，324

PHI（受保护的健康信息），*53*

飞利浦 HealthSuite 健康安卓应用，366

Pholus，410

滥用 mDNS 探测阶段，134–136

与...的侦察，133–134

PHYPayload，324

跑步机的物理按钮，禁用，398–400

物理进入智能家居

克隆钥匙锁系统的 RFID 标签，372–375

无线报警干扰，375–379

物理设备，识别威胁，26–27

物理头（PHDR），324

物理鲁棒性，测试，42–43

个人可识别信息（PII），*53*

PIN 输入，WPS，296–297

引脚输出，UART，*159*–162

引脚

Arduino Uno，198

闪存芯片，192–193，194

JTAG，166–167

UART，159–162，176–177

播放 IP 摄像头流

分析网络流量，380–382

提取视频流，382–385

概述，379–380

流媒体协议，380

`PLAY` 请求，382

Plutil 工具，345

PMK（对等主密钥），300

PMKID（对等主密钥标识符）字段，*299*，301–304

指针记录（PTR），132–133，138，139–140

POODLE（降级加密填充 Oracle）攻击，94

`portfwd` 命令，399

端口

网络协议，90

UART，159–162

`ports` Nmap 服务探测指令，72

前导码，无线电，323

预启动执行环境（PXE），*41*

预测文本引擎，*353*

首选网络列表，*292*

演示上下文，A-ASSOCIATE 请求消息，111

表示层，UPnP，*120*

共享密钥攻击，299

最小特权原则，*51*–52

印刷电路板（PCB）

JTAG 引脚，166，167

UART 引脚，159–160

打印机，中间人攻击。*参见* mDNS 投毒器

隐私泄露，32

特权，提升。*参见* 特权提升

PRNG（伪随机数生成器），*373*

`Probe` Nmap 服务探测指令，72

探测请求，*292*

探测阶段，mDNS，132，134–136

受保护 EAP（PEAP），304–305

受保护的健康信息（PHI），*【53】(c03.xhtml#Page_53)*

协议数据单元（PDU），96–97，271

`ProtoField`类，99

`ProtoField.string`函数，102

`Proto(name, description)`函数，99

原型设计，*【93】(c05.xhtml#Page_93)*

ProxCard，HID Global，244，246

Proxmark3，410

改变 RFID 标签，255–256

使用 Android 应用攻击 MIFARE，256–257

使用脚本引擎自动化 RFID 攻击，263–264

窃听标签与读卡器之间的通信，260–261

从捕获的流量中提取扇区密钥，261–262

高频标签克隆，250–254

识别低频和高频卡，248–249

密钥锁系统标签，克隆，372–375

合法的 RFID 读卡器攻击，262–263

低频标签克隆，249

概述，245–246

RAW 命令，258–260

使用自定义脚本进行 RFID 模糊测试，264–268

设置，246

模拟 RFID 标签，254–255

更新，246–248

伪随机数生成器（PRNG），*【373】(c15.xhtml#Page_373)*

PTK（成对瞬时密钥），300

PTR（指针记录），132–133，138–140

发布-订阅架构，*【73】(c04.xhtml#Page_73)*

泵服务，识别威胁，27–28

打洞穿透防火墙，121–126

Pupy，391，393，399，410

`pupygen`命令，391

按钮配置（PBC），*【296】(c12.xhtml#Page_296)–299*

PuTTY，319–320

PXE（预启动执行环境），*【41】(c03.xhtml#Page_41)*

`pyserial`包，315–316

Python 2，128，134

**Q**

Qark，361，410

QEMU（快速仿真器），*【216】(c09.xhtml#Page_216)–217，411*

QU 位，132

**R**

`r2`命令，355

`rabin2`命令，355

Radare2, 355–356, 358, 411

Radcliffe, Jay, 11–12, 16

无线射频识别（RFID）, *239*. *另见* Proxmark3

修改标签, 255–256

使用脚本引擎自动化攻击, 263–264

窃听标签与读卡器之间的通信, 260–261

从捕获的流量中提取扇区密钥, 261–262

使用自定义脚本进行模糊测试, 264–268

一般讨论, 240

高频标签克隆, 250–254

高频标签, 245

识别低频和 高频卡, 248–249

钥匙锁系统标签克隆, 372–375

合法读卡器攻击, 262–263

低频标签克隆, 249

低频标签, 244–245

概述, 239

被动和主动技术, 241–242

无线频率带, 240–241

标签的 RAW 命令, 258–260

模拟标签, 254–255

标签结构, 242–244

无线干扰, *291*

`radio rx 0` 命令, 316–317

`radio set crc off` 命令, 316–317

`radio set sf sf7` 命令, 316–317

`radio set wdt 0` 命令, 316

RADIUS（远程身份验证拨号用户服务）服务器, *304*

`randomize()` 函数, 265–266

勒索软件攻击, 5

稀有度等级, *68*

`rarity` Nmap 服务探测指令, 72

Raspberry Pi 转变为无线发射器, 378–379

限速, *297*

RFID 标签的 RAW 命令, 258–260

RBAC（基于角色的访问控制）, 49–50

`rdbl` 参数, 253

只读存储器（ROM）, *338*

Realtek RTL2832U 芯片组, 376

Reaver, 297, 411

接收（RX）端口, UART, 159, 162, 178

`receive(dcm)` 函数, 109  

侦察  

激活, *43*–45  

使用 DNS-SD, 133–134  

使用 mDNS, 133–134  

被动, *37*–40, 292  

`recv_data()` 函数, 174  

远程认证拨号用户服务 (RADIUS) 服务器, *304*  

远程控制跑步机的速度和坡度, 394–398  

远程维护, 安全测试, 53  

远程 shell 访问, 获取, 391  

重放攻击, *23*, *31*  

控制服务器服务, 23  

LoRaWAN, 330–331  

概览, 31  

存储库 APK, 397–399  

否认, *22*  

控制服务器服务上, 23  

药物库上, 23  

固件上, 26  

硬件上, 27  

操作系统上, 25  

泵服务上, 28  

限制性用户界面上, 22  

STRIDE 威胁分类模型, 19  

请求全部 (REQA) 命令, 258–259  

`RequestConnection` 命令, 129  

`RequestTermination` 命令, 129  

`restore` 参数, 254  

限制性用户界面 (RUI), *22*–23  

`ret_code` 字段, 83  

逆向工程协议, 46–47  

撤销规避攻击, 7–8  

RfCat, 411  

RFID. *参见* 无线射频识别 (RFID)  

`rfm9x` 类, 322  

`rfm9x.receive()` 函数, 322  

`rfm9x.rssi()` 函数, 322  

RFQuack, 411  

稳健安全网络 (RSN), *301*  

Rogers, David, 14  

基于角色的访问控制 (RBAC), *49*–50  

ROM (只读内存), *338*  

root 检测, 避免, 368–370  

root 用户, 394  

Rpitx, 378–379, 411  

`rpitx` 命令, 378–379  

RSN (稳健安全网络), *301*  

RTCP 协议, 380

RTL-SDR DVB-T 加密狗, 375–376, 411  

*rtpdump* 文件, 383–384  

`rtpplay` 命令, 384  

RTP 协议, 380

RTP 流, 提取, 383

RTP 工具, 384, 412

`RTSP DESCRIBE` 请求, 381

`RTSP OPTIONS` 请求, 381

RTSP 协议, 380

RUI (受限用户界面), 22–23

RX (接收) 端口, UART, 159, 162, 178

**S**

S3Scanner, 209–210, 412

Saleae 逻辑分析仪, 163, 176–177

SAMD21 微控制器, 318

SAMPLE/PRELOAD 命令, JTAG, 164

沙箱, 340, 347

SCAN 请求, *270*

Scapy, 64–65, 412

Schlage 门锁伴侣应用, 368

SCK (串行时钟), 191

SCL (串行时钟线), 197, 199–200

屏幕截图, 应用程序, 352

脚本引擎, Proxmark3, 263–264

`script list` 命令, 263

`script run` 命令, 263

`script run fuzzer` 命令, 267

SDA (串行数据线), 197, 199–200

SD 卡目录, 检查, 367

SDP (会话描述协议) 文件, 381–383

SDR (软件定义无线电), *375*–376

`search` 参数, 248

扇区尾部, 250–*251*

安全启动, *341*

Secure Enclave, *341*

安全 IPC, 340

安全模式, Wi-Fi 网络, *288*

SecureRom, *341*

Secure RTP (SRTP) 协议, *385*

安全漏洞, 32

安全性测试方法论

云测试, 54

概念层, 36

硬件层, 40–43

主机配置审核, 50–54

移动应用, 54

网络层, 43–47

概览, 35–37

被动侦察, 37–40

Web 应用程序, 48–50

种子, *264*

Segger J-Link 调试探针, *165*

选择卡片命令, 258–260

选择性干扰, *291*

半被动 RFID 技术, *242*

`send_cmd` 函数, 317

`send(dcm, data)` 函数, 109

敏感日志文件, 234

串行时钟 (SCK), 191

串行时钟线 (SCL), 197, 199–200

串行数据线 (SDA), 197, 199–200

串行监视器, *180*, 310, 313, 319–320

串行外设接口 (SPI), *189*

使用 Shikra 转储 EEPROM 闪存芯片, 192–196

一般讨论, 191

用于通信的硬件, 190–191

概述, 189

串行协议, *158*

串行线调试 (SWD), *158*

黑客设备通过

在 Arduino 中编写目标程序, 172–174

设置调试环境, 170–172

调试目标, 181–188

刷写并运行 Arduino 程序, 174–180

STM32F103C8T6 目标设备, 169–170

工具, 168–169

用于通信的硬件工具, 165

概述, 158, 165

串行线或 JTAG 调试端口 (SWJ-DP), *165*

`ser` 串行对象, 317

服务器冒充攻击, 94

`server_ip` 变量, 230

服务器配置错误的测试, 54

`<service>` 标签, 120

服务发现阶段, Wi-Fi Direct, 296

服务, BLE, *272*

服务扫描器, DICOM. *参见* DICOM 服务扫描器

服务扫描, 44

服务版本检测, 44

会话描述协议 (SDP) 文件, 381–383

会话管理, 49

`SetAutoDisconnectTime` 命令, 129

`SetConnectionType` 命令, 128

`SetIdleDisconnectTime` 命令, 129

设置篡改攻击, *32*

`setup()` 函数, 173, 312–313

`SETUP` 请求, 381–382

`SetWarnDisconnectDelay` 命令, 129

SGX, *341*

共享内存段, *397*

Shikra, 412

短程无线电, 239。*另见* 特定技术

`showRootStatus()` 函数, 368–369

边信道分析, *330*

边信道泄露, 367–368

信号干扰攻击, *31*

信噪比（SNR）, *375*

签名，应用, 340

签名, 94

SIMATIC WinCC OA 操作员应用程序, 348

`sim` 参数, 255

简单对象访问协议（SOAP）, *120*

模拟 RFID 标签, 254–255

mDNS 投毒者的骨架文件, 141–143

刷卡攻击, *23*

小外形集成（SOIC）夹, 190, 193

智能门锁，规避, 372–375

智能家居。*另见* 攻击智能跑步机

克隆钥匙锁系统的 RFID 标签, 372–375

干扰无线警报, 375–379

概述, 371–372

回放 IP 摄像头流

分析网络流量, 380–382

提取视频流, 382–385

概述, 379–380

流媒体协议, 380

智能锁系统, 7–8

`smartQuotesType` 属性, 354

攻击智能跑步机

Android 操作系统, 386–387

提升权限, 394

由于...的伤害, 400

安装 APK, 391–393

概述, 385

远程控制速度和坡度, 394–398

远程 shell 访问, 391

软件和物理按钮，禁用, 398–400

UI 限制，规避, 387–390

强制设备发送短信, 351–352, 365–366

*快照* 文件夹, 352

嗅探 CDP 模式, 66

嗅探器宏, 204–205

使用 CatWAN USB 棒嗅探 LoRa 流量, 318–322

嗅探模式，CDP, *66*

SNR（信噪比）, *375*

SOAP（简单对象访问协议）, *120*

套接字创建函数, 107–108

套接字销毁函数，107–108

`socketserver` 框架，142，144

`softmatch` Nmap 服务探测指令，72

软件组成分析，*52*

软件定义无线电（SDR），*375*–376

软件碎片化，*338*

软件完整性控制，*18*

跑步机软件，禁用，398–400

软件白名单，*18*

SOIC（小型外形集成电路）夹子，190，193

跑步机速度，远程控制，394–398

SPI。*请参见*串行外设接口（SPI）

爬虫工具，*48*

*spiflash.py* 脚本，196

欺骗 CDP 模式，66

欺骗，*22*，*23*

关于控制服务器服务，23

关于药物库，24

关于固件，25

关于硬件，27

MAC 地址，283–285

关于操作系统，25

关于泵服务，28

关于限制性用户界面，22

STRIDE 威胁分类模型，18

欺骗模式，CDP，*66*

`spooftooph` 工具，284

使用预制数据包模式欺骗，CDP，*66*

扩频因子，*313*，316–317

扩频，308

SQL 注入攻击，*24*，120，354

Squashfs 格式，*71*

SRTP（安全 RTP）协议，*385*

SRV 记录，132–133，135，138–140，144

SSL 证书授权机构（CA），357

`sslports` Nmap 服务探测指令，72

STA（站点），*288*

堆栈破坏保护，*346*

Stais, Ioannis，385

标准，*8*–10

星形拓扑，*309*

启动位，UART，158

国家反黑客法律，13

状态，Ncrack，79–80

静态分析

固件文件系统内容，213–216

InsecureBankV2 应用，361–362

OWASP iGoat 应用，344–346

静态修补

越狱检测, 避免使用, 358–360

避免根目录检测, 368–369

站点 (STA), *288*

*stdnse* 库, 106

`step` 命令, 349

ST-Link 编程器, *165*

启动模式, 选择, 174–175

连接到计算机, 179–180

连接 USB 到串行适配器, 178

刷写并运行 Arduino 程序, 174–180

UART 引脚, 使用逻辑分析仪识别, 176–177

上传 Arduino 程序, 175–176

STM32F103C8T6 (Black Pill)

启动模式, 选择, 174–175

在 Arduino 中编写目标程序, 172–174

连接到计算机, 179–180

连接 USB 到串行适配器, 178

调试目标, 181–188

刷写并运行 Arduino 程序, 174–180

概述, 169–170, 412

UART 引脚, 使用逻辑分析仪识别, 176–177

上传 Arduino 程序, 175–176

停止位, UART, 158

`strcmp()` 函数, 185–186

流媒体协议, 380

STRIDE 威胁分类模型, *18*

使用攻击树, 28–29

将架构分解为组件, 20–21

识别架构, 19

识别威胁

控制服务器服务, 23–24

药品库, 24

固件, 25–26

操作系统, 25

概述, 21–22

物理设备, 26–27

泵服务, 27–28

RUI, 22–23

概述, 18–19

*string* 库, 106

`string.pack()` 函数, 109–110

`string.unpack()` 函数, 109, 113–114

提取应用实体标题的字符串值, 102

订阅者，在发布-订阅架构中, 73

向现有协议树中添加子树, 102–103

SUID 二进制文件, *394*

RFID 标签中的补充数据, *243*–244

供应链攻击, *27*

`(-sV)`Nmap 命令, 68

SWD. *参见* 串行线调试 (SWD)

切换欺骗攻击, *61*–63

`switch` 语句, 85

SWJ-DP (串行线或 JTAG 调试端口), *165*

Sybil 攻击, *32*

符号链接, 216–*217*

同步通信协议, *191*

`syslog` 函数, 230–231

系统手册, 37

**T**

*表格* 库, 106

Tag-Connect 接口, *167*

标记端口, *60*

标签与读取器通信，窃听, 260–261

TAGulator, 166–167

`tag` 变量, 265

篡改, *22*

关于控制服务器服务, 23

关于药物库, 23

关于固件, 26

关于硬件, 27

关于操作系统, 25

保护与检测, 41–42

关于泵服务, 28

关于限制性用户界面, 22

STRIDE 威胁分类模型, 18

防篡改硬件, 341

TAP (测试接入端口), *164*–165

目标服务，WS-Discovery, *145*–146

TCK (测试时钟输入), 164

TCP SYN 洪水攻击, 94

`tcpwrappedms` Nmap 服务探测指令, 72

TDI (测试数据输入), 164–165

`tdnse.get_script_args()` 函数, 112

TDO (测试数据输出), 164–165

技术保护措施 (TPMs), *12*–13

TEE (受信执行环境), 41, *341*

测试接入端口 (TAP), *164*–165

测试时钟输入 (TCK), 164

测试数据输入 (TDI), 164–165

测试数据输出 (TDO), 164–165

测试环境设置, 75–76

测试钩片, 190, 194

测试

解码器, 104

固件更新服务, 232–233

LoRa 发送器，310–314

mDNS 投毒，144–146

测试方法论。*参见* 安全测试方法论

测试模式选择（TMS）输入，164–165

测试点接口，42

测试探针，*159*

测试复位（TRST）输入，164–165

短信，强制设备发送，351–352，365–366

厚客户端，*210–211*

精简二进制，355

威胁建模，*17*。*参见* STRIDE 威胁分类模型

常见威胁，31–33

DREAD 分类方案，29–30

问题，18

其他类型，30–31

概述，17

时间尺度，6

生存时间（TTL）值，132

定时标记，*177*

Titan M，*341*

TMS（测试模式选择）输入，164–165

工具开发，93

工具。参见具体工具

主题，在发布-订阅架构中，73

拓扑映射，*44*

`totalwaitms` Nmap 服务探测指令，72

TP-Link Kasa 应用，366

TPM（技术保护措施），12–13

传统与物联网安全，5–6

传输语法，*111*

晶体管-晶体管逻辑（TTL），*168*

传输功率，*313*

发送（TX）端口，UART，159，162，178

跑步机，攻击。*参见* 智能跑步机，攻击

TRST（测试复位）输入，164–165

主干链路，*61*

主干端口，*60*

信任边界，*20*–21

受信执行环境（TEE），41，*341*

受信平台模块，*341*

TrustZone，*341*

TTL（生存时间）值，132

TTL（晶体管-晶体管逻辑），*168*

TX（发送）端口，UART，159，162，178

TXT 记录，133，138–140，144

**U**

UART。*参见* 通用异步接收发送器（UART）

UART 桥接 VCP 驱动，310

Ubertooth One，412

创建 `UDP_server`，142

UEFI（统一可扩展固件接口）安全启动，* 41*

UF2（USB 闪存格式），*318*

UID（唯一标识符），*244*，255，258

UI 限制，绕过，387–390

英国《实践规范》，14

超窄带（UNB），*308*

Umap，118，413

通过 WAN 接口滥用 UPnP，126–131

未加密的通信通道，234

统一可扩展固件接口（UEFI）安全启动，*41*

唯一标识符（UID），*244*，255，258

通用异步接收器-发射器（UART），*157*

波特率，识别，162–163

通过设备进行黑客攻击

在 Arduino 中编写目标程序，172–174

设置调试环境，170–172

调试目标，181–188

刷写并运行 Arduino 程序，174–180

STM32F103C8T6 目标设备，169–170

工具，168–169

用于通信的硬件工具，158–159

概述，157

数据包格式，158

端口，识别，159–162，176–177

通用即插即用（UPnP）

通过 WAN 接口滥用，126–131

常见漏洞，120–121

漏洞历史，118

其他类型的攻击，131

概述，118

穿透防火墙，121–126

UPnP 栈，119–120

`u` 参数，255

更新机制，固件。*参见* 固件更新机制

`upload` 命令，399

UPnP。*参见* 通用即插即用（UPnP）

UPnProxy，118

URL 方案，344–*345*，351–352

USB 闪存格式（UF2），*318*

USB 端口，评估，40–41

USB 到串行适配器，*168*，176–177

USB 到串行接口。*参见* 总线海盗（Bus Pirate）

用户帐户，测试，51

用户认证，移动应用，340–341

用户信息上下文，A-ASSOCIATE 请求消息，111

用户知识，39–40

用户级别隔离，*49*–50

用户名枚举，*49*

用户密码，重置，363–365

用户安全意识，32–33

USRP，413

UUIDs，278

**V**

`validate()` 函数，174，184–187

Valsamaras，Dimitris，385

变量头部，MQTT *CONNECT* 包，*80*–82

变长字段，解析，103–104

Vcc（电压）端口，UART，159，162

`vconfig` 命令，63

厂商，从中获取固件，208–209

版本强度，68

Vibease 无线遥控震动器应用，367

视频管理服务器，*145*

攻击，152–153

假冒网络摄像头，147–152

Vim，315

虚拟局域网（VLANs），*60*–61

VLAN 跳跃攻击

双标签攻击，63–65

模拟 VoIP 设备，65–67

概述，60

交换机欺骗攻击，61–63

VLAN 标签，*61*

VMware，122–123

模拟 VoIP 设备，65–67

VoIP 跳跃，65–67，413

电压（Vcc）端口，UART，159，162

漏洞扫描，46

`VV` 命令，359

**W**

WAN 接口，通过 UPnP 滥用，126–131

WannaCry 攻击，5–6

看门狗定时器，316–317

web 应用程序，评估，48–50

web 应用程序会话，*49*

Web 服务动态发现（WS-Discovery），*145*

构造攻击，152–153

假冒网络上的摄像头

在 Wireshark 中分析请求和回复，147–149

模拟摄像头，149–152

设置，147

WebView, 350

绕过跑步机上的 UI 限制, 387–390

XSS 漏洞, 353–354

`wget` 命令, 212, 226

整个固件仿真, 218–221

Wi-Fi

对接入点（AP）的攻击

破解 WPA/WPA2 企业版, 304–305

破解 WPA/WPA2, 299–300

概述, 299

针对无线客户端的攻击

关联攻击, 291–295

去认证攻击, 289–291

拒绝服务攻击, 289–291

概述, 288–289

Wi-Fi Direct, 295–299

一般讨论, 287–288

安全评估硬件, 288

测试方法论, 305–306

Wi-Fi Direct, 针对其的攻击, 295–299

Wi-Fi 调制解调器路由器黑客攻击

动态分析, 221–223

提取文件系统, 212

固件仿真, 216–221

概述, 211–212

静态分析文件系统内容, 213–216

Wifiphisher, 294–295, 297–298, 413

Wi-Fi 保护访问 (WPA/WPA2), 47, 299–300

Wi-Fi 保护设置 (WPS), 296–297

有线等效隐私 (WEP), 47, 299

无线报警, 干扰, 375–379

无线客户端, 攻击

关联攻击, 291–295

去认证和拒绝服务攻击, 289–291

恶意双胞胎攻击, 291–292

KARMA 攻击, 292

已知信标攻击, 292–295

概述, 288–289

Wi-Fi Direct, 295–299

无线协议测试, 47

Wireshark

关于 Wireshark 窗口, 98

额外文档, 91

ADV_IND 数据包, 271

生成 DICOM 流量, 97

启用协议窗口, 91–92

IP 摄像头网络流量，在，380–381

在启用 Lua 时，97–99

Lua 解码器，开发中，99–101

使用分析网络流量，92

概述，413

提取 RTP 流，383

SRV 记录在，133

测试解码器，91

流量转储

语音网络中的 DHCP 帧，67

MQTT *CONNACK* 包，76

MQTT CONNECT 包，74

分析 WS-Discovery 请求和回复，在，147–149

世界可写日志，*23*

破解 WPA 企业版，304–305

WPA/WPA2 (Wi-Fi Protected Access), 47, 299–300

WPA/WPA2 四次握手，*299*–300

WPS (Wi-Fi Protected Setup)，296–297

`wrbl` 参数，256

写前日志机制，*354*

WS-Discovery。*见* Web 服务动态发现 (WS-Discovery)

**X**

`xcodebuild` 命令，343

Xcode IDE，342

`xcode-select` 命令，342

Xcrun，351–352

`xcrun` 命令，342–343

XSS 注入攻击，353–354

XXE（外部实体）攻击，*121*

**Y**

Yersinia，61–63，413

Yushkevich, I.，367

**Z**

ZAP (OWASP Zed Attack Proxy)，410

零配置网络，*117*。*另见**特定协议*

Zipalign，369
