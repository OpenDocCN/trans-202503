

# 索引



## A

+   绝对安全描述符，149–151, 164

+   摘要 类别属性，354

+   访问检查，25, 36, 222, 265

+   活动目录，366

+   自动化，275–277

+   自由访问控制，228, 241–244, 249, 259

+   企业，249–260

+   句柄重复，269–272

+   内核模式，222–225

+   强制访问控制（MACs），228, 230–237, 242

+   对象类型，249–255

+   在 PowerShell 中，227–244

+   远程访问检查协议，389–390

+   沙箱令牌检查，244–249, 272–274

+   线程过程，271–272

+   令牌，227–228, 230, 237–241

+   遍历检查，266–269

+   用户模式，225

+   示例，261–263, 277–279

+   访问控制条目（ACEs），145, 153–156. *另见特定 ACE 的名称*

+   访问过滤器，233

+   回调，156

+   复合，154–155, 213–214

+   自由访问控制列表，145–146

+   查找带有 Audit ACEs 的资源，294–295

+   标志，156

+   映射到标志字符串，167

+   强制标签，154, 167, 172, 201–203

+   普通，154–155

+   对象，154–155

+   排序，158–159

+   安全访问控制列表，145–146

+   支持的类型，153

+   类型字符串映射到 ACE 类型，167

+   访问控制列表（ACLs），151–156

+   ACEs，153–156

+   DACLs，145–146, 186, 215

+   映射到控制标志的标志字符串，166

+   头信息，152–153

+   NULL ACLs，146

+   SACLs, 144–146, 288–289, 292–293

+   AccessFilter ACE，154，156，167

+   访问掩码，155

+   映射到访问字符串，168

+   关闭句柄，40

+   转换，38–39

+   显示，37–38

+   句柄表，39–40

+   数值，39

+   通用映射表，37

+   访问类型，36–37

+   访问模式，223–224

+   访问字符串

+   对于文件和注册表类型，169

+   强制标签访问字符串，172

+   映射到访问掩码，168

+   AccessSystemSecurity 访问权限，37，178

+   访问令牌，25

+   AccountNotDelegated 标志，490

+   ACE 标志字符串，167

+   ACEs。*参见* 访问控制条目；*特定 ACE 的名称*

+   ACL 标志字符串，166

+   ACLs。*参见* 访问控制列表

+   活动目录，341–396

+   访问检查，366–382

+   声明和中央访问策略，382–384

+   域配置，342–349

+   企业网络域，301–302

+   组策略，384–386

+   交互式身份验证，404

+   对象，349–353

+   ObjectType GUID，用于，169

+   属性层次结构，250–251

+   模式，353–358

+   安全描述符，358–366

+   示例，387–395

+   Add- 命令，49–52，59，84，157，251，309，311，324，371，389，543，415，417–418

+   AddMember 访问权限，318

+   Add-Member 函数，388

+   AD-Domain-Services 功能，541，545

+   AdjustDefault 访问权限，100

+   AdjustGroups 访问权限，100

+   AdjustPrivileges 访问权限，100，320

+   AdjustQuotas 访问权限，320

+   AdjustSessionId 访问权限，100

+   AdjustSystemAccess 访问权限，320

+   AdministerServer 访问权限，315

+   管理员用户，122–124

+   LsaLogonUser API，409–410

+   删除特权，140–141

+   SAM 数据库，326

+   验证令牌，123–124

+   高级加密标准（AES），327–332

+   AES 密钥，470–471，496

+   高级本地过程调用（ALPC）子系统，24，55

+   AFD（辅助功能驱动程序），47

+   Alarm ACEs，154，292

+   AlarmCallback ACEs，154，292

+   AlarmCallbackObject ACEs，154，292

+   AlarmObject ACEs，154，292

+   别名，12–13，166，318，548

+   Allowed ACEs，153–154，158，167

+   AllowedCallback ACEs，154，167

+   AllowedCallbackObject ACEs，154，167

+   AllowedCompound ACEs，154–155

+   AllowedObject ACEs，154，167

+   ALPC（高级本地过程调用）子系统，24，55

+   辅助功能驱动程序（AFD），47

+   Anonymous 标志，518

+   匿名模拟级别，104，106，136

+   匿名会话，518–519

+   Anonymous 类型，53

+   Anonymous 用户 token，214

+   ANSI 字符串，79

+   API

+   AcceptSecurityContext API，426–427

+   AcquireCredentialsHandle API，424

+   AuthzAccessCheck API，156，243

+   AuthZ API，387，389–390

+   Create APIs，77–79，87–90，107，117，135，208，412–413

+   数据保护 API (DPAPI)，322，516

+   DecryptMessage API，440–441，476

+   EncryptMessage API，440–442

+   ExIsRestrictedCaller API，272

+   通用安全服务 API，476

+   Get APIs，65–66，78，208–209，212

+   ImpersonateNamedPipe API，104

+   InitializeSecurityContext API，423–424

+   LoadLibrary API，65，68

+   LogonUser API，102，401

+   LsaLogonUser API，399–414

+   从 PowerShell 访问，410–412

+   创建用户桌面，398–399

+   域身份验证，403–404

+   本地身份验证，401–402

+   登录和控制台会话，404–406

+   登录类型，400

+   协议转换委托，489

+   安全包，400–401

+   token 创建，407–410

+   LsaManageSidNameMapping API, 323–324

+   LsaOpenPolicy API, 318–319

+   MakeSignature API, 441–443

+   NtAccessCheckByType API, 249

+   前缀到子系统映射, 24–25

+   Query API, 430, 442

+   RtlDosPathNameToNtPathName API, 83, 86

+   RtlIsSandboxToken API, 272, 274

+   Sam API, 313–316

+   SeAccessCheck API, 222–223

+   SeAccessCheckByType API, 249

+   SeAssignSecurityEx API, 180–182

+   SeCreateClientSecurity API, 484

+   SeImpersonateClient API, 484

+   SeSetSecurityDescriptorInfoEx API, 206–207

+   SetNamedSecurityInfo API, 208–210

+   SeTokenCanImpersonate API, 136

+   SetPrivateObjectSecurityEx API, 208

+   sets, 67–68

+   Shell, 89–91

+   VerifySignature API, 440–441

+   Win32 安全 API, 64–70, 77–80, 208–213

+   WinSock API, 47

+   应用容器进程, 120–122

+   应用程序信息服务, 93

+   应用程序包权限, 120

+   AP-REP 消息。*参见* 身份验证协议应答消息

+   AP-REQ（身份验证协议请求）消息, 494, 519–520

+   array 类型, 5

+   asInvoker UAC 执行级别, 126

+   AS-REP（身份验证服务应答）消息, 459

+   AS-REQ（身份验证服务请求）消息，458

+   AssignPrimary 访问权限，100

+   Audit ACEs，153，167，294–295

+   AuditCallback ACEs，154，167

+   AuditCallbackObject ACEs，154

+   审计。*见* 安全审计

+   AuditLogAdmin 访问权限，319

+   AuditObject ACEs，154，167

+   审计策略安全，287–293

+   配置全局 SACL，292–293

+   配置资源 SACL，288–291

+   身份验证审计事件日志，524–527

+   身份验证协议回复（AP-REP）消息

+   解密，476–477

+   委托，481

+   PowerShell 中的 Kerberos 身份验证，468–469

+   协商安全包，505

+   网络服务身份验证，463–464

+   身份验证协议请求（AP-REQ）消息，494，519–520

+   跨域身份验证，478

+   解密，469–476

+   委托，481–483，485–487

+   PowerShell 中的 Kerberos 身份验证，466–469

+   协商安全包，505

+   网络服务身份验证，463–464

+   U2U 身份验证，491–493

+   身份验证协议转换，486–487，490

+   身份验证服务回复（AS-REP）消息，459

+   身份验证服务请求（AS-REQ）消息，458

+   身份验证令牌，423，500

+   Authenticode 机制，54

+   AuthZAccessCheck 函数，387

+   自动继承标志，161，181–182，203，209–210，215

+   Auxiliary 类别属性，354

## B

+   BackgroundColor 参数，16

+   BaseNamedObjects（BNO）目录，29

+   控制台会话，76–77

+   查找对象管理器资源所有者，216–217

+   查询安全描述符和所有者，179

+   Win32 API 与系统调用，78

+   按位运算符，6

+   BNO 目录。*见* BaseNamedObjects 目录

+   布尔运算符，6

+   bool 类型，5

+   暴力攻击，428–429，465

## C

+   规范化，84–85，362

+   CBC（密码块链），330

+   中央访问策略，255–260

+   访问检查，258–259

+   Active Directory，382–384

+   声明，255–256，382–384

+   显示，257

+   启用，259–260

+   包含的信息，257

+   简单配置与，256

+   ChangePassword 访问权限，316，377

+   通道绑定，444–445

+   ChannelBindings 缓冲区标志，500

+   Chrome 网页浏览器，117

+   密码块链（CBC），330

+   密文窃取模式（CTS），466

+   Citrix，77

+   声明

+   Active Directory，382–384

+   设备，255–256

+   用户，255–256

+   Class88 类别属性，354

+   客户端服务器运行时子系统（CSRSS），71

+   CLI XML 格式，20–21

+   CloudAP 安全包，403

+   代码完整性，54–55

+   Authenticode 机制，54

+   内核，24

+   前缀，25

+   目的，54

+   COM（组件对象模型）服务器进程，93

+   命令行解析，88–89

+   命令。*另见特定命令名称*

+   接受参数，9

+   访问属性和方法，9

+   别名，12–13

+   发现，10

+   执行，9–10

+   换行，9–10

+   命名约定，9

+   将一个的输出传递给另一个, 9

+   使用示例, 11–12

+   Commit 状态值, 50

+   Compare- 命令, 42, 231, 233

+   组件对象模型 (COM) 服务器进程, 93

+   条件表达式, 155, 169–171

+   访问控制过滤器 ACEs, 233–235

+   中央访问策略, 255, 257–259

+   中缀运算符, 171

+   类型值, 170

+   一元运算符, 170

+   Confidentiality 请求属性标志, 440–441, 451

+   配置管理器。*见* 注册表

+   Connect 访问权限, 313

+   控制台会话, 83, 416–417

+   创建用户桌面, 398

+   冒充令牌, 137

+   远程桌面服务, 74–75

+   命名对象的分离, 76–77

+   会话 ID, 102, 405

+   Windows 登录过程, 92

+   受限委托（用户服务），480, 484–491

+   仅 Kerberos, 485–486, 490

+   协议转换, 486–488, 490

+   基于资源的, 489–491

+   构造函数, 8

+   ContainerInherit ACE 标志, 156, 167, 193–194, 202

+   上下文跟踪模式, 106

+   ControlAccess 访问权限, 366, 378

+   控制访问权限, 376–379, 394

+   控制标志, 144–145, 166, 173, 182, 193–194, 215, 381

+   Dacl, 144–146, 166, 181–182, 194, 215

+   RmControlValid, 149

+   Sacl, 144–145, 166, 181

+   SelfRelative, 149–151

+   ServerSecurity, 213–214

+   TrustedForDelegation, 381, 482

+   TrustedToAuthenticateFor Delegation, 381

+   ConvertFrom- 命令, 155–156, 163, 173, 502, 509

+   ConvertTo-NtSecurityDescriptor 命令, 218

+   Copy- 命令, 41, 107–108, 140

+   CreateAccount 访问权限, 319–320

+   CreateAlias 访问权限, 315

+   CreateChild 访问权限, 366–368

+   CreateDirectories 属性, 267

+   CreateDomain 访问权限, 313

+   CreateGroup 访问权限, 315, 317

+   CreatePrivilege 访问权限, 319

+   CreateSecret 访问权限, 319

+   CreateUser 访问权限, 315

+   创建者安全描述符, 180

+   在资源创建过程中分配, 180–188

+   继承规则, 215

+   凭证保护, 484

+   凭证管理器, 514–517

+   CredSSP 协议, 510–513

+   Critical ACE 标志, 156, 167, 208

+   跨域身份验证, 477–479

+   加密派生过程, 431–433

+   CSRSS（客户端服务器运行时子系统）, 71

+   CSV 文件, 20

+   CTS（密文盗取模式）, 466

+   CVE 安全问题

+   2014-6324, 475

+   2014-6349，278

+   2018-0748，184

+   2018-0983，212

+   2019-0943，57，271

+   2020-1472（Zerologon），403

+   2020-1509，523

+   2020-17136，225

+   2021-34470，368

## D

+   DAC（自主访问控制），36，143

+   Dacl 控制标志，144–146，166，181–182，194，215

+   DACLs。*参见* 自主访问控制列表

+   Dacl 安全信息标志，211

+   DAP（目录访问协议），342

+   Data 缓冲区标志，500，502

+   数据加密标准（DES），332–333

+   数据报传输层安全协议（DTLS），506

+   数据保护 API（DPAPI），322，516

+   DCOM 服务器进程启动器，93

+   Delegate 标志，483

+   委托，479–480

+   受限，480，484–491

+   不受限，480–484

+   委托冒充级别，105–107

+   Delete 访问权限，36，168，369

+   DeleteChild 访问权限，366，369

+   DeleteTree 访问权限，366，369

+   Denied ACEs，153–154，158，167，243，255

+   DeniedCallback ACEs，154，167

+   DeniedCallbackObject ACEs，154

+   DeniedObject ACEs，154，167，252–253，255

+   DenyCallback ACEs，243

+   DES（数据加密标准）, 332–333

+   DesiredAccess 参数, 30, 36, 79

+   Desktop 对象, 71–72

+   桌面窗口管理器（DWM）进程, 92, 405

+   DHCP（动态主机配置协议）, 537, 540

+   Diffie-Hellman 密钥交换, 477, 508

+   目录访问协议 (DAP), 342

+   Directory 对象, 28, 169, 219

+   Disable-NtTokenPrivilege 命令, 114

+   自愿访问检查, 228, 230, 241–243

+   自愿访问控制 (DAC), 36, 143

+   自愿访问控制列表 (DACLs), 145–146

+   控制标志, 144–146, 166, 181–182, 194, 215

+   默认, 186

+   继承规则, 215

+   DistinguishedName 属性, 351

+   区别名称, 349–351

+   DllMain 函数, 66

+   DLLs, 65–69, 119

+   API 集, 67–68

+   延迟加载, 67

+   .*DLL* 文件扩展名, 69

+   导出转发, 66

+   劫持, 68–69

+   加载新库, 65–66

+   *NTDLL*, 65–66

+   搜索, 68–70

+   不受信任, 66

+   查看导入的 API, 66–67

+   DNS。 *参见* 域名系统

+   域认证, 300–304

+   域森林, 302–304

+   企业网络域, 301–302

+   本地认证, 299–301

+   LsaLogonUser API, 403–404

+   域森林, 302–304

+   全局目录, 303–304

+   多个, 304

+   信任关系, 303

+   DomainLocal 组作用域, 346–347

+   域名系统（DNS），302，344，536

+   Active Directory 域配置，344–345

+   虚拟机，540，544

+   域策略远程服务，312，318–324

+   访问权限，319

+   账户对象，319–321

+   连接到，318–319

+   名称查找和映射，323–324

+   秘密对象，321–322

+   受信域对象，322–323

+   域安全策略，282

+   完成状态，430

+   DOS 设备路径，83–87

+   规范化，84–85

+   显示符号链接，83–84

+   DOS 设备映射前缀，83

+   最大路径长度，85–87

+   路径分隔符，84

+   路径类型，84–85

+   双重跳跃问题，435

+   double 类型，5

+   DPAPI（数据保护 API），322，516

+   绘图资源对象，71

+   DTLS（数据报传输层安全性）协议，506

+   Duplicate 访问权限，100

+   DWM（桌面窗口管理器）进程，92，405

+   动态访问控制，255

+   动态主机配置协议（DHCP），537，540

## E

+   ECB（电子密码本），333

+   Edit- 命令，158–159，190，364

+   有效伪令牌句柄，108

+   有效令牌模式，106

+   电子密码本（ECB），333

+   Empty 缓冲区标志，500

+   Enabled 属性，110，114

+   EnabledByDefault 属性，110，114

+   Enable-NtTokenPrivilege 命令，114

+   企业访问检查，249–260

+   中央访问策略，255–260

+   对象类型访问检查，249–255

+   企业身份验证能力，520–523

+   企业网络域，301–302。*另见* Active Directory

+   域控制器，301–302

+   群组策略，302

+   EnumerateDomains 访问权限，313–314

+   EnumerateUsers 访问权限，287

+   EPA（扩展身份验证保护），444

+   转义字符，7–8

+   Windows 事件追踪 (ETW)，292

+   Everyone ACEs，365

+   显式凭据，437，522–523

+   显式令牌冒充，107

+   Export- 命令，20，533

+   导出数据

+   到 CLI XML 格式，20–21

+   到 CSV 文件，20

+   到文本文件，20

+   表达式，5–8

+   扩展身份验证保护 (EPA)，444

+   扩展权限，373–376

+   ExtendedSessionSecurity NTLM 标志，429–430

+   Extra 缓冲区标志，500

## F

+   FailedAccess ACE 标志，156，168

+   快速用户切换功能，75，417

+   File 对象，30，41，162，169

+   ForceAccessCheck 属性标志，224–225

+   ForcePasswordChange 访问权限，316

+   ForegroundColor 参数，16

+   Format- 命令，15，27，44，60，103，159–161，209，359，427

+   Forwardable 标志，472，485–486，490

+   Free 状态值, 50–51

+   FullName 属性, 9

+   function 关键字, 13

+   函数, 13–14

## G

+   *GDI32* 库, 70–71

+   GenericAll 访问值, 37, 250–252, 254

+   GenericExecute 访问值, 37, 235

+   通用映射, 39, 181

+   分配安全描述符

+   在资源创建期间, 181, 185

+   对现有资源, 206–207

+   内核模式访问检查, 222

+   强制完整性级别检查, 235

+   映射表, 37

+   用户模式访问检查, 225

+   GenericRead 访问值, 37, 39, 235

+   通用安全服务应用程序编程接口 (GSSAPI), 476

+   GenericWrite 访问值, 37, 235

+   GetAliasMembership 访问权限, 315

+   Get- 命令，7，9–16，26–27，34，37–39，43–48，50–51，54，56–57，65–68，72，74，78，81，83，85–87，93–94，102–103，108–110，112–114，147–148，175–176，179，206，208–209，217–218，226–229，244–245，257–258，261–262，275–277，286–287，289，305–306，308，310–312，314–315，317–320，327，344–348，350–351，356–357，359，363，368–369，373–374，379，382–384，386，390，395，400，404–405，411，441，470–471，494–495，543，545

+   Get- 函数，140，242，339，393–395，431–433，448，532，529

+   GetObject 方法，59

+   GetPrivateInformation 访问权限，319

+   全球目录，303–304，352–353

+   Global 组范围，346–347

+   金色票券，462–463

+   Google Chrome 网络浏览器，117

+   GrantedAccessMask 属性，39

+   GroupByAddress 参数，58

+   Group-Object 命令，19，58

+   组策略，256–257，409

+   Active Directory，384–386

+   对已知 Web 代理的认证，521

+   企业网络域，301–302

+   Group 安全信息标志，157，183

+   GSSAPI（通用安全服务应用程序接口），476

+   GSS_ 函数，476

## H

+   句柄，30，35–42

+   访问掩码，36–40

+   关闭，40

+   显示句柄表，39–40

+   重复，40–41

+   重复未命名，187–188

+   重复访问检查，269–272

+   按名称查找开放句柄，57

+   查找要冒充的令牌句柄，139–140

+   句柄表，35

+   虚拟，48，108–109

+   注册表，80

+   Windows，73

+   Handles 属性，18–19

+   基于哈希的消息认证码（HMACs），429

+   hashtable 类型，5

+   highestAvailable UAC 执行级别，126

+   HKEY_CLASSES_ROOT 句柄，90

+   Hyper-V，47，537–538

## I

+   IBM OS/2 操作系统，64，85

+   身份验证冒充级别，105–106，136

+   Identify 请求属性标志，519–520

+   身份令牌，519–520

+   Id 属性，14，284

+   IIS（Internet Information Services）Web 服务器，414

+   Image 类型，53

+   Impersonate访问权限，100，104，107

+   模拟的模拟级别，105

+   模拟伪令牌句柄，108

+   模拟令牌，104–107

+   显式令牌模拟，107

+   模拟上下文，104

+   SQoS，104–107

+   导入命令，5，20，65–66

+   导入数据，20–21

+   InfoOnly参数，47，314

+   InformationClass参数，43

+   继承，215

+   自动继承，181

+   行为，197

+   危险，212

+   标志，182，194

+   父安全描述符，188–194

+   继承属性标志，42

+   Inherited ACE 标志，156，158，167，212

+   InheritedObjectType GUID，169，203–205

+   InheritOnly ACE 标志，156，167

+   初始化向量，329–330

+   Initialize访问权限，313

+   InitialOwner参数，32，79

+   输入/输出（I/O）管理器，24–25，45–47

+   设备驱动程序，45

+   显示设备对象，46

+   列出驱动程序，47

+   打开设备对象并显示卷路径，46–47

+   Install-命令，4，545

+   Int64安全属性类型，260

+   集成 Windows 身份验证（IWA），424

+   Integrity属性标志，112–113

+   IntegrityEnabled属性，112

+   完整性级别, 102, 112, 124, 137

+   交互式身份验证, 397–419, 458–464

+   AP-REP 消息, 464

+   AP-REQ 消息, 464

+   AS-REP 消息, 459–461

+   AS-REQ 消息, 458

+   使用令牌创建新进程, 412–413

+   创建用户桌面, 398–399

+   初始用户身份验证, 458–462

+   KDC 服务, 458

+   LsaLogonUser API, 399–412

+   网络服务身份验证, 463–465

+   预身份验证数据, 458

+   特权属性证书, 459

+   服务 登录类型, 413–414

+   服务主体名称, 460

+   TGS-REP 消息, 461–462

+   TGS-REQ 消息, 460–461

+   票证授予服务器, 459

+   票证授予票证, 459

+   票证, 458

+   示例， 414–419

+   Internet Explorer, 118–119

+   Internet 信息服务（IIS）Web 服务器, 414

+   int 类型, 5

+   Invoke- 命令, 14, 105

+   I/O 管理器。*见* 输入/输出管理器

+   ISE（PowerShell 集成脚本环境）, 261

+   IsFiltered 标志, 128, 269

+   IsRestricted 标志, 269

+   IWA（集成 Windows 身份验证）, 424

## J

+   John the Ripper, 496

## K

+   KDC 服务。*见* 密钥分发中心服务

+   Kerberoasting, 465, 495–496

+   Kerberos, 457–497

+   AP-REP 消息解密, 476–477

+   AP-REQ 消息解密, 469–476

+   CredSSP 协议, 512

+   跨域身份验证, 477–479

+   委托, 479–491

+   双跳问题, 435

+   金票, 462–463

+   交互式身份验证, 458–464

+   PKINIT，477

+   通过 PowerShell，465–469

+   服务主体名称，443

+   银票证书，465

+   U2U 认证，491–493

+   工作示例，493–496

+   Kerberos 凭据 (KRB-CRED)，483

+   仅限 Kerberos 委托（用户到代理的服务），485–486，490

+   *KERNEL32* 库，64–65

+   *KERNELBASE* 库，64–65

+   内核模式访问检查，222–225

+   访问模式，223–224

+   内存指针检查，224–225

+   参数，222

+   KernelObjects OMNS 目录，75

+   密钥分发中心 (KDC) 服务

+   跨域认证，478

+   解密 AP-REQ 消息，473，475

+   初始用户认证，458，477

+   仅限 Kerberos 委托，485

+   网络服务认证，463–464

+   协议转换委托，486–487

+   基于资源的委托，490

+   U2U 认证，491

+   无限制委托，481

+   KeyExchange 标志，441

+   密钥版本号，467

+   KeywordsDisplayNames 属性，290

+   *KnownDlls* OMNS 目录，69–70

+   KRB-CRED（Kerberos 凭据），483

## L

+   LAN 管理器 (LM)，306，327

+   较低特权的应用容器 (LPACs)，246

+   轻量级目录访问协议 (LDAP)，342，354–358，371，494

+   关联令牌，126–129，262

+   List 访问权限，366–367，369

+   ListAccounts 访问权限，315

+   ListGroups 访问权限，316

+   ListMembers 访问权限，318

+   ListObject 访问权限，366，369

+   LM (LAN 管理器)，306，327

+   本地认证，299–301，398

+   本地域，300

+   LsaLogonUser API，401–402

+   用户数据库，305

+   LocalCall 标志，436

+   本地域配置，300，305–311

+   LSA 策略数据库，309–312

+   用户数据库，305–309

+   本地回环认证，435–436

+   本地唯一标识符（LUIDs），102–103

+   本地安全机构（LSA），305，309–324

+   提取系统密钥，327–328

+   登录账户权限，310–311

+   权限账户权限，310

+   远程服务，311–324

+   本地安全机构子系统（LSASS），26，92

+   创建令牌，131–133

+   枚举 SIDs，175–176

+   查找具有审计 ACEs 的资源，295

+   链接令牌，128

+   登录会话，102

+   本地安全策略，282

+   登录账户权限，310–311，415–416

+   LogonId 属性，111，405

+   登录类型，400，402，408–412

+   Network 登录类型，409–411

+   NewCredentials 登录类型，438

+   Service 登录类型，413–414

+   LogonUI 进程，92，398

+   LongPathsEnabled 值，87

+   long 类型，5

+   Lookup访问权限，315

+   LookupDomain 访问权限，313–314

+   LookupNames访问权限，319，323

+   lowbox 令牌，120–122，246–249，273，520–523

+   LPACs（较低权限应用容器），246

+   LParam 参数，74

+   lpMutexAttributes 参数，78

+   lpName 参数，78

+   LSA。*参见* 本地安全权限

+   LsaLogonUser API，399–414

+   从 PowerShell 访问，410–412

+   创建用户桌面，398–399

+   域认证，403–404

+   本地认证，401–402

+   登录和控制台会话，404–406

+   登录类型，400

+   协议转换委托，489

+   安全包，400–401

+   令牌创建，407–410

+   LSASS。*参见* 本地安全权限子系统

+   LuaToken 标志，128，140

+   LUID（本地唯一标识符），102–103

## M

+   强制访问检查（MACs），228–237

+   访问过滤器 ACEs，233–235

+   lowbox 令牌，247–248

+   强制完整性级别检查，235–237

+   进程信任级别检查，231–233

+   强制访问控制，102，143

+   Mandatory 属性，110

+   强制完整性控制（MIC），230

+   强制完整性级别检查，235–237

+   强制标签 ACEs，154，167

+   访问字符串，172

+   在资源创建期间分配安全描述符，201–203

+   完整性级别 SID，172

+   MandatoryLabel 安全权限，112

+   强制策略值，161

+   MapGenericRights 参数，39

+   MapWrite 访问，52，58

+   MD4 哈希值，306，432

+   MD5 哈希值，329，431，466

+   内存管理器，49–54

+   查找可写且可执行的内存，60–61

+   NtVirtualMemory 命令，49–51

+   页面文件，49

+   前缀, 25

+   Section 对象, 51–54

+   虚拟内存空间, 49

+   内存指针检查, 224–225

+   消息完整性代码 (MICs), 425, 429, 433

+   消息循环, 73

+   Microsoft Visual Studio, 261, 538

+   ModifyState 访问, 42, 270–271

+   Mutant 对象, 29–30, 181, 187, 193

+   双向身份验证, 464

+   MutualAuth 标志, 483

+   MutualAuthRequired 标志, 469

## N

+   纳格尔算法, 448

+   NAT (网络地址转换), 537

+   协商安全包, 401, 503–505

+   初始化, 503–505

+   安全机制, 504

+   指定凭证, 504

+   NegotiateStream 类, 445

+   NetCredentialsOnly 标志, 413

+   Netlogon 协议, 342, 403

+   网络地址转换 (NAT), 537

+   网络身份验证, 421–455

+   凭证, 407

+   低框令牌, 520–523

+   NTLM 网络身份验证, 422–438

+   NTLM 中继攻击, 438–445

+   实例演示, 445–454

+   网络级身份验证 (NLA), 511

+   网络 登录类型, 409–411

+   New- 命令, 8, 12–13, 46, 51–53, 56, 81, 85, 88–89, 132–133, 157, 251, 273, 306–307, 309, 325, 361, 381, 389–390, 424, 500, 507, 537, 539

+   NewCredentials 登录类型, 438

+   New- 函数, 189, 232, 538–539

+   NewGuid 静态方法, 8

+   NLA（网络级身份验证）, 511

+   None ACE 标志, 193

+   NoPropagateInherit ACE 标志, 156, 167, 193–194

+   NoRightsUpgrade 标志, 188, 270–271

+   Notification 访问权限, 319

+   Nt (Zw) 前缀, 24, 29–30, 224

+   NtAccessCheck 系统调用, 225–227, 249, 254, 291

+   NtAdjust 系统调用, 110, 114–115

+   NtAllocate 系统调用, 49–50, 102, 409

+   NtChallengeResponse 系统调用, 433

+   NtCloseObjectAuditAlarm 系统调用, 291

+   NtCreate 系统调用, 29–30, 55, 77, 116, 120, 132

+   *NTDLL* (NT 层动态链接库)，65–66

+   NtDuplicate 系统调用，41，107

+   NtFilterToken 系统调用，117

+   NtFreeVirtualMemory 系统调用，49

+   NT 哈希值，306，326–327，332，334

+   NtImpersonate 系统调用，106–107

+   NTLM (NT 局域网管理器)

+   标志，425，427

+   网络身份验证，422–438

+   身份验证令牌，423

+   绕过代理检查，523–524

+   破解用户密码，428–429

+   CredSSP 协议，512

+   密码学衍生过程，431–433

+   显式凭据，437

+   假冒令牌，437–438

+   本地管理员，430–431

+   本地回环身份验证，435–436

+   协商安全包，503–505

+   直通身份验证，434–435

+   变种，422

+   通过 PowerShell，423–430

+   中继攻击，438–445

+   活跃服务器挑战，440

+   通道绑定，444–445

+   示例，439

+   签名和封装，440–443

+   目标名称，443

+   安全包，401

+   NtLoadDriver 系统调用，45，116

+   NtMake 系统调用，40–41

+   NtMapViewOfSection 系统调用，51

+   NtObjectManager 模块，xx，356，359

+   NtOpen 系统调用，100，291

+   NtPrivilegeCheck 系统调用，115

+   NtQuery 系统调用，30，39，47，49，126，179–180

+   NtReadVirtualMemory 系统调用, 49

+   NtSecurityDescriptor 属性, 358, 380

+   NtSetInformation 系统调用, 107, 128, 131–132, 135

+   NtSetSecurityObject 系统调用, 205–206

+   NTSTATUS 代码, 32–35, 77–78

+   NtWriteVirtualMemory 系统调用, 49

+   NullSession 请求属性标志, 518

## O

+   ObjectAccess 审计类别, 284–285

+   ObjectAttributes 参数, 30–31

+   OBJECT_ATTRIBUTES 结构, 30–32

+   ObjectClass 属性, 351, 355

+   ObjectInherit ACE 标志, 156, 167

+   对象管理器, 24, 180–181

+   显示对象类型, 27–28

+   DOS 设备路径, 83–84

+   查找所有者, 216–218

+   NTSTATUS 代码, 32–35

+   对象目录, 29

+   对象句柄, 35–42

+   对象管理器命名空间, 28

+   自动化访问检查, 275–276

+   永久对象, 40–41

+   注册表, 55

+   遍历检查, 266–267

+   Win32 注册表路径, 80–82

+   前缀, 24

+   系统调用, 29–32

+   Query 和 Set 系统调用, 42–45

+   ObjectName 参数, 31–32, 291

+   对象

+   访问属性, 8

+   属性标志, 32

+   创建, 8

+   目录, 29

+   显示, 14–17, 27

+   过滤, 17–19

+   查找共享对象, 57–59

+   分组, 19

+   句柄, 30, 35–42, 187–188

+   调用方法, 8

+   命名, 31

+   永久, 40–41

+   排序, 18–19

+   对象类型访问检查, 249–255

+   ObjectType GUID, 169, 203–205

+   ObjectTypes 参数, 249, 251–253

+   Oem NTLM 标志, 427

+   OkAsDelegate 标志, 481–483

+   OMNS. *参见* 对象管理器命名空间 *下的* 对象管理器

+   操作符, 6, 14, 18

+   中缀, 171

+   一元运算符, 170

+   Oracle VirtualBox, 537

+   组织单位, 385–386

+   Out- 命令, 16–17, 20, 54, 60

+   Owner 属性, 111

+   所有者检查, 184, 240–241

+   Owner 安全信息标志, 184

## P

+   页面文件, 49

+   Paging 参数, 16

+   Parameter 命令, 11

+   参数, 9, 11

+   父级安全描述符, 180, 182, 185–203

+   继承规则, 215

+   同时设置创建者和父级, 195–200

+   不设置创建者或父级, 185–188

+   仅设置父级, 188–195

+   哈希传递技术, 306

+   透传身份验证, 434–435

+   PassThru 参数, 17, 285

+   基于密码的密钥派生函数 2（PBKDFv2）算法, 471

+   密码加密密钥（PEKs）

+   解密, 328–330

+   解密密码哈希, 330–332

+   Path 参数, 9

+   PDC (主域控制器) 模拟器, 345

+   Permanent 属性标志, 40

+   每用户审计策略, 285–287

+   进程 ID (PIDs), 47–48

+   管道 (|), 9

+   PkgParams 缓冲区标志, 500–501

+   PKINIT (公共密钥初始认证), 477

+   即插即用 (PnP) 管理器, 45

+   POSIX, 64, 85, 145

+   PowerShell, 3–21

+   配置, 4–5

+   发现命令, 10

+   显示和操作对象, 14–17

+   等效的 SDK 名称, 38

+   执行命令, 9–10

+   导出数据, 20–21

+   表达式, 5–8

+   过滤对象, 17–19

+   函数, 13–14

+   获取帮助, 10–13

+   对象分组, 19

+   集成脚本环境, 261

+   换行符, xxviii

+   模块, 4–5

+   操作符, 6

+   脚本执行策略, 4–5

+   对象排序, 18–19

+   字符串字符转义, 7–8

+   字符串插值, 7

+   书中示例的样式约定, xxvii–xxviii

+   类型, 5–6, 8

+   变量, 6–7

+   版本, 3–4

+   预认证数据, 458–459

+   PreviousMode 值, 223–224

+   主域控制器 (PDC) 模拟器, 345

+   Primary 令牌, 100, 108, 133–134

+   Principal 参数, 249–250

+   print Shell 动词, 90–91

+   printto Shell 动词, 90–91

+   特权属性证书 (PACs), 408

+   跨域认证, 478–479

+   解密 AP-REQ 消息, 472–475

+   委派, 487

+   golden tickets, 462

+   初始用户身份验证，458–462

+   网络服务身份验证，464

+   银票，465

+   特权检查，238–239

+   进程和线程管理器，24，47–48

+   显示进程和线程，47–48

+   打开进程和线程，48

+   前缀，25

+   进程和线程 ID，47

+   进程创建，87–91

+   命令行解析，88–89

+   Shell API，89–91

+   进程 ID（PIDs），47–48

+   ProcessName 属性，14，19

+   Process 对象，18，42

+   Process 参数，49

+   ProcessTrustLabel ACEs，154，167

+   进程信任级别检查，231–233

+   属性集，251，373–376

+   ProtectedDacl 安全信息标志，210–211，364

+   ProtectedData 类，516

+   受保护的对象，381–382

+   受保护的进程，231–233

+   ProtectedSacl 安全信息标志，210

+   ProtectFromClose 属性，42

+   Protect-LsaContextMessage 命令，441

+   协议转换委托（用户到自我服务），486–488，490

+   代理自动配置（PAC）脚本，521

+   伪句柄，48，108–109

+   公钥初始身份验证（PKINIT），477

## Q

+   Query 访问权限，100

+   QueryInformation 类，45

+   QueryInformation 系统调用动词，30

+   QueryLimitedInformation 访问权限，49，61

+   QueryMiscPolicy 访问权限，287

+   QuerySource 访问权限，100

+   Query 系统调用，42–45

+   QuerySystemPolicy 访问权限，287

+   QueryUserPolicy 访问权限，287

+   QueryValue 访问权限，322

## R

+   彩虹表，429

+   RC4 加密算法，327–328，331，442，466，470

+   RDP（远程桌面协议），75，77

+   RDS（远程桌面服务），74，77

+   ReadAccount 访问权限，316

+   Read- 命令，49–51，307，410

+   ReadControl 访问权限，36，178，240–241

+   ReadGeneral 访问权限，316

+   ReadGroupInformation 访问权限，316

+   ReadInformation 访问权限，318

+   ReadLogon 访问权限，316

+   ReadOnly 缓冲区标志，501

+   ReadOnly 保护状态，49

+   ReadOnlyWithChecksum 缓冲区标志，501

+   ReadOtherParameters 访问权限，315

+   ReadPasswordParameters 访问权限，314–315

+   ReadPreferences 访问权限，316

+   ReadProp 访问权限，366，370

+   Read-TlsRecordToken 函数，532

+   Receive- 函数, 448

+   转介票证, 478–479

+   regedit 应用程序, 80

+   注册表 (配置管理器), 24, 55–56

+   附加点, 56

+   注册表项, 56

+   键和值, 55–56

+   前缀, 25

+   相对区分名称, 349–350

+   相对标识符 (RIDs), 26, 112

+   应用容器和低箱令牌, 120–121

+   循环, 323, 336–337

+   强制完整性级别检查, 235

+   SID 结构, 146–149

+   用户数据库, 306–308

+   相对安全描述符, 149–151, 163–164

+   RemainingAccess 值, 229–230

+   远程访问检查协议, 389–390

+   远程凭证保护, 513

+   远程桌面协议 (RDP), 75, 77

+   远程桌面服务 (RDS), 74, 77

+   远程过程调用 (RPCs), 55, 104

+   远程过程调用子系统 (RPCSS), 92–93

+   远程服务器管理工具 (RSAT), 343–344

+   Remove- 命令, 49–52, 56, 115, 308–309, 311, 324, 369, 416

+   RemoveMember 访问权限, 318

+   Renewable 标志, 472

+   requireAdministrator UAC 执行级别, 126

+   Reserve 状态值, 50

+   Reset-Win32SecurityDescriptor 命令, 211

+   Resolve- 函数, 238, 240, 244

+   Resource 属性, 113, 408

+   ResourceAttribute ACEs, 154, 167

+   基于资源的委托, 489–491  

+   资源管理器标志, 144–145, 149  

+   限制管理员模式, 513–514, 525  

+   RestrictedKrbHost 类, 467–468  

+   限制令牌, 117–119, 244–245  

+   return 关键字, 13  

+   RIDs. *参见* 相对标识符  

+   RmControlValid 控制标志, 149  

+   RootDirectory 参数, 31–32  

+   根目录系统代理条目（RootDSE）, 350  

+   RPCs（远程过程调用）, 55, 104  

+   RSAT（远程服务器管理工具）, 343–344  

+   RtlNewSecurityObjectEx 系统调用, 182  

+   Rubeus, 496  

## S  

+   S4U. *参见* 受限委托  

+   S4U2proxy（用户到代理的服务）, 485–486, 490  

+   S4U2self（用户自我服务）, 486–488, 490  

+   SaclAutoInherit 自动继承标志, 209–210  

+   Sacl 控制标志, 145, 166, 181  

+   SACLs. *参见* 安全访问控制列表  

+   SAM. *参见* 安全账户管理器数据库; 安全账户管理器远程服务  

+   沙箱令牌, 117–122, 244–249  

+   访问检查, 272–274  

+   低箱令牌, 120–122, 246–249  

+   限制令牌, 117–118, 244–245  

+   写入受限令牌, 119

+   SAS（安全注意序列）, 399  

+   SCM（服务控制管理器）, 92–93  

+   ScopedPolicyId ACEs, 154, 167  

+   脚本块, 14, 18  

+   SDDL 格式. *参见* 安全描述符定义语言格式  

+   SDK（软件开发工具包）, 38, 110, 112  

+   SDKName 属性, 38, 161  

+   Search-Win32SecurityDescriptor 命令, 212–213

+   SeAssignPrimaryTokenPrivilege 权限, 116

+   SeAuditPrivilege 权限, 116

+   SeBackupPrivilege 权限, 116, 123

+   SeBatchLogonRight 账户权限, 311, 402, 416

+   SeChangeNotifyPrivilege 权限, 116, 267

+   secpol.msc 命令, 282

+   SeCreateTokenPrivilege 权限, 116, 123, 132

+   Section 对象, 217

+   创建节并映射到内存, 51–52

+   查找共享文件, 57–59

+   查找可写文件, 278–279

+   列出带名称的映射文件, 53

+   映射和查看加载的镜像, 53–54

+   修改映射区域, 59–60

+   安全注意序列 (SAS), 399

+   安全通道, 506–510

+   加密和解密应用数据, 508–509

+   提取服务器 TLS 证书, 530–533

+   检查连接信息, 508

+   设置, 506–507

+   TLS 记录结构, 507

+   安全套接层 (SSL) 协议, 506–507

+   SecureString 类, 307

+   安全访问控制列表 (SACLs), 145–146

+   控制标志, 144–145, 166, 181

+   全局, 292–293

+   资源, 288–291

+   安全访问令牌

+   管理员用户, 122–124

+   分配, 133–138

+   转换/复制, 107–108

+   创建, 131–133

+   组, 109–113

+   模拟令牌, 104–107, 136–138

+   完整性级别, 102

+   主令牌, 100–104, 133–136

+   权限, 113–117

+   伪令牌句柄, 108–109

+   沙箱令牌, 117–122

+   安全属性, 130–131, 172

+   Int64 安全属性类型, 260

+   用户账户控制, 124–130

+   实际示例, 138–141

+   安全账户管理器（SAM）数据库, 312, 324–334

+   通过注册表访问, 325–334

+   Active Directory 前的企业网络配置, 342

+   安全账户管理器（SAM）远程服务, 312–318

+   访问权限, 313

+   别名对象, 318

+   域对象, 314

+   组对象, 317

+   用户对象, 315–316

+   SECURITY_ATTRIBUTES 结构, 78–79

+   安全审计, 281–295

+   审计策略安全, 287–293

+   安全事件日志, 282–286

+   实际示例, 287–295

+   安全授权, 147

+   MandatoryLabel, 112

+   World, 219

+   SecurityBuffer 类, 500

+   安全缓冲区, 500

+   带有认证上下文, 501–502

+   带有签名和封印, 502–503

+   SECURITY 数据库, 324, 334–336

+   安全描述符定义语言（SDDL）格式, 26, 165–173

+   访问字符串, 168–169, 172

+   ACE 标志字符串, 167

+   ACL 标志字符串, 166

+   条件表达式, 170–171

+   将安全描述符转换为, 165

+   强制标签完整性级别 SID, 172

+   ObjectType 在 AD 中使用的 GUID, 169

+   安全属性 SDDL 类型字符串, 172

+   SID 别名, 166, 547–549

+   拆分组件, 165

+   映射到 ACE 类型的类型字符串, 167

+   SecurityDescriptor 对象, 151, 157

+   安全描述符, 143–220

+   绝对和相对, 149–151

+   访问控制列表, 151–156

+   分配

+   在资源创建期间, 180–205

+   到现有资源, 205–208

+   组件, 144–146

+   转换

+   从相对描述符转换, 163–164

+   转换为 SDDL 格式, 165

+   创建, 157–158

+   格式化, 159–163

+   继承行为, 214–215

+   排序 ACEs, 158–159

+   读取, 178–179

+   SDDL 格式, 165–173

+   服务器安全描述符和复合 ACEs, 213–214

+   SID 结构, 146–149

+   标准化, 362

+   结构, 144

+   Win32 安全 API, 208–213

+   示例, 173–176, 216–219

+   安全事件日志, 282–286

+   审计事件和事件 ID, 282

+   审计策略子类别, 284

+   配置

+   每用户审计策略, 285–286

+   系统审计策略, 282–285

+   显示类别 GUIDs, 284

+   设置策略并查看结果策略列表, 284–285

+   顶级审计策略类别, 283

+   安全标识符（SIDs）, 26–27, 81, 146–149

+   管理员用户, 124

+   别名, 166, 547–549

+   任意所有者, 184

+   断言身份, 489–490

+   分配令牌, 137

+   能力, 120–121

+   能力组, 121

+   组件, 146–147

+   创建令牌, 132–133

+   设备组, 113

+   枚举, 175–176

+   固定登录会话, 102

+   组, 145

+   完整性级别, 112

+   登录类型, 408–409, 414

+   低框令牌, 120–122

+   机器, 306

+   强制标签完整性级别, 172

+   手动解析二进制, 173–175

+   所有者, 145

+   进程信任级别, 231–232

+   虚拟令牌句柄, 109

+   查询管理员组 SID, 148

+   替换 *CREATOR OWNER* 和 *CREATOR GROUP* SIDs, 200

+   受限令牌, 117–118

+   SDDL SID 别名映射, 547–549

+   *SELF* SID, 249–250, 379–380

+   令牌组, 111–113

+   令牌, 101

+   SecurityInformation 标志, 178, 205–206

+   Dacl, 211

+   Group, 157, 183

+   Owner, 184

+   ProtectedDacl, 210–211, 364

+   ProtectedSacl, 210

+   UnprotectedDacl, 210–211

+   UnprotectedSacl, 210

+   安全包 (安全支持提供者), 400–401, 499–533

+   匿名会话, 518–519

+   认证审计事件日志, 524–527

+   凭据管理器, 514–517

+   CredSSP, 510–513

+   身份令牌, 519–520

+   协商, 401, 503–505

+   使用低盒令牌的网络认证, 520–523

+   远程凭据保护, 513

+   限制管理员模式, 513–514

+   安全通道, 506–510

+   安全缓冲区, 500–503

+   实际案例, 527–533

+   安全服务质量 (SQoS), 32, 104–107

+   上下文跟踪模式, 106

+   有效令牌模式, 106

+   模拟级别, 104–106

+   SECURITY_QUALITY_OF_SERVICE 结构, 104, 107

+   安全参考监视器 (SRM), 24–27

+   访问检查, 25

+   进程, 221–263

+   使用案例, 265–280

+   访问令牌, 25

+   审计事件, 26

+   组件, 25

+   本地安全授权子系统, 26

+   前缀, 24

+   安全访问令牌, 99–141

+   安全审计, 281–295

+   安全描述符, 143–176

+   安全标识符, 26–27

+   SECURITY_SQOS_PRESENT 标志, 107

+   SECURITY_SUBJECT_CONTEXT 结构，222，272

+   安全支持提供者接口（SSPI），424，440，476，500，518

+   安全支持提供者。*请参阅* 安全包

+   SeDebugPrivilege 特权，116，123

+   SeDenyBatchLogonRight 账户权限，311，402

+   SeDenyInteractiveLogonRight 账户权限，311，402

+   SeDenyNetworkLogonRight 账户权限，311，402

+   SeDenyRemoteInteractive 账户权限，402

+   SeDenyRemoteInteractiveLogonRight 登录权限，311

+   SeDenyServiceLogonRight 账户权限，311，402

+   SeEnableDelegationPrivilege 特权，381

+   SeFastTraverseCheck 函数，268

+   SeImpersonatePrivilege 特权，116，123

+   SeInteractiveLogonRight 账户权限，311，402

+   SeIsTokenAssignableToProcess 函数，134

+   Select-HiddenValue 函数，95–96

+   Select-Object 命令，14–15，17

+   Self 访问权限，366，378–379

+   SelfRelative 控制标志，149–151

+   SeLoadDriverPrivilege 特权，116，123

+   SeMachineAccountPrivilege 特权，380

+   Send- 函数，448–449

+   SeNetworkLogonRight账户权限，311，402

+   序列号，442

+   SeRelabelPrivilege特权，117，123，202，239

+   SeRemoteInteractiveLogonRight账户权限，311，402

+   SeRestorePrivilege特权，116，123，219

+   ServerAdmin访问权限，319

+   服务器消息块（SMB），105，422，439–440，442

+   ServerSecurity控制标志，213–214

+   服务控制管理器（SCM），92–93

+   用户服务。*参见* 受限委派

+   用户代理服务（即 S4U2proxy 或仅 Kerberos 委派），485–486，490

+   用户自我服务（即 S4U2self 或协议转换委派），486–488，490

+   服务登录类型，413–414

+   服务主体名称（SPN），443

+   认证

+   跨域，478

+   使用显式凭据，522

+   初始用户，460–462

+   PowerShell 中的 Kerberos 认证，466

+   到已知的网络代理，522

+   网络服务，463–464

+   U2U，491–493

+   绕过代理检查，523–524

+   解密 AP-REQ 消息，469–470

+   委派，482，484，486，488–490

+   SeSecurityPrivilege特权，116，127，287–288

+   SeServiceLogonRight账户权限，311，402

+   会话 0 隔离功能，76

+   会话管理子系统（SMSS），92

+   Session对象，75

+   SeTakeOwnershipPrivilege 特权, 117, 123, 239

+   SetAuditRequirements 访问权限, 319

+   SeTcbPrivilege 特权, 116, 123

+   Set- 命令, 44, 49–51, 56, 110, 135, 209–210, 286–288, 469, 486, 489, 539

+   SetDefaultQuotaLimits 访问权限, 319

+   SeTimeZonePrivilege 特权, 115–116

+   SetInformation 类, 30, 45

+   SetMiscPolicy 访问权限, 287

+   SeTrustedCredmanAccessPrivilege 特权, 516–517

+   Set 系统调用, 42–45, 99

+   SetSystemPolicy 访问权限, 287

+   SetUserPolicy 访问权限, 287

+   SetValue 访问权限, 322

+   SHA256 算法, 121–122

+   SHA384 算法, 508

+   碎片化攻击, 76

+   *SHELL32* 库, 89

+   Shell API, 89–91

+   Shell 动词, 91

+   Show- 命令, 60, 100, 104, 131, 162

+   ShowWindow 参数, 11–12

+   Shutdown 访问权限, 313

+   同级令牌, 134–135

+   SID 别名, 166, 548–549

+   安全标识符（SIDs）。*参见* 安全标识符

+   SignatureType 属性, 55

+   签名和封装

+   NTLM 中继攻击, 440–443

+   安全缓冲区, 502–503

+   银票，465

+   简单且受保护的协商机制（SPNEGO）协议，503–505

+   SingleHost 标志，429

+   SkipTokenGroups 标志，389

+   SMB（服务器消息块），105，422，439–440，442

+   SMSS（会话管理子系统），92

+   软件开发工具包（SDK），38，110，112

+   Sort-Object 命令，18–19

+   分割令牌管理员，124，126，128–129，262

+   SPNEGO（简单且受保护的协商机制）协议，503–505

+   SPNs。*参见* 服务主体名称

+   SQoS。*参见* 安全质量服务

+   SRM。*参见* 安全参考监视器

+   SSL（安全套接字层）协议，506–507

+   SSPI（安全支持提供程序接口），424，440，476，500，518

+   Start- 命令，88，276，325

+   静态方法，8

+   Stream 缓冲区标志，500

+   StreamHeader 缓冲区标志，500，509

+   StreamTrailer 缓冲区标志，500，509

+   字符串

+   ANSI，79

+   字符转义，7–8

+   双引号，7

+   插值，7

+   安全，307

+   单引号，7

+   宽，79

+   string 类型，5

+   Structural 类别属性，354

+   SuccessfulAccess ACE 标志，156，168

+   上级，367–368

+   SymbolicLink 对象，28–29

+   SymbolicLinkTarget 属性，28–29

+   系统审计策略，282–285，287

+   系统调用

+   常见动词，30

+   状态码，34

+   Win32 API 和，77–80

+   系统进程，91–93

+   本地安全授权子系统，92

+   服务控制管理器，92–93

+   会话管理子系统，92

+   Windows 登录进程，92

+   SystemProcessInformation 类，47

## T

+   TargetInfo 标志，427

+   TargetTypeDomain 标志，427

+   TargetTypeServer 标志，427

+   任务调度服务，93

+   TCB（可信计算基础），116

+   TCP，446，532

+   TcpClient 对象，452

+   TCP/IP，47，342

+   TcpListener 类，451

+   终端服务，77

+   Test-AccessFilter 检查，231

+   Test- 命令，115–116，138，189–190，240–241，243，259，430，441–442

+   Test- 函数，230，393

+   Test-MandatoryIntegrityLevel 检查，231

+   Test-ProcessTrustLevel 检查，231

+   TGS-REP 消息。*参见* 票证授予服务回复消息

+   TGS-REQ 消息。*参见* 票证授予服务请求消息

+   TGSs。*参见* 票证授予服务器

+   TGT-REP（票证授予票证回复）消息，491–493

+   TGT-REQ（票证授予票证请求）消息，491–492

+   TGTs。*参见* 票证授予票证

+   线程亲和性，73

+   线程 ID (TIDs)，47–48

+   Thread 对象，27，48，203

+   票证授予服务器（TGSs）

+   跨域身份验证，478–479

+   解密 AP-REQ 消息，469

+   委托, 479–482, 485  

+   初始用户身份验证, 459–461  

+   PowerShell 中的 Kerberos 身份验证, 466  

+   网络服务身份验证, 464  

+   票据授予服务回复（TGS-REP）消息  

+   初始用户身份验证, 458, 461–462  

+   PowerShell 中的 Kerberos 身份验证, 466  

+   网络服务身份验证, 464  

+   票据授予服务请求（TGS-REQ）消息  

+   委托, 479, 481, 485  

+   初始用户身份验证, 458  

+   PowerShell 中的 Kerberos 身份验证, 466  

+   网络服务身份验证, 463–464  

+   U2U 身份验证, 492  

+   票据授予票据回复（TGT-REP）消息, 491–493  

+   票据授予票据请求（TGT-REQ）消息, 491–492  

+   票据授予票据（TGTs）  

+   委托, 479–485  

+   初始用户身份验证, 459–461  

+   网络服务身份验证, 463–464  

+   U2U 身份验证, 491–493  

+   线程 ID（TIDs），47–48  

+   TLS 协议。*参见* 传输层安全协议  

+   ToCharArray 方法, 8  

+   令牌访问检查, 227–228, 230, 237–241  

+   所有者检查, 240–241  

+   权限检查, 238–239  

+   Token 缓冲区标志, 500–502  

+   TokenLinkedToken 类, 126, 128  

+   Token 对象  

+   创建, 407–410  

+   使用创建新进程, 412–413

+   请求已认证用户, 430  

+   Token Viewer 应用程序, 100–101, 103  

+   传输层安全（TLS）协议  

+   通道绑定, 444–445  

+   CredSSP, 511–512  

+   提取证书, 530–533  

+   安全通道, 506–510  

+   遍历检查, 266–269  

+   限制性检查, 267–269  

+   SeChangeNotifyPrivilege 权限, 267  

+   Traverse 访问权限, 266–269  

+   受信管理员 访问权限，319

+   受信计算基础（TCB），116

+   受信委托 控制标志，381，482

+   受信用于委托认证 控制标志，381

+   受信授权委托 标志，487–489

+   受信保护 ACE 标志，156，168

+   信任关系，303–304，322，477–479

+   TS 服务安全包（TSSSP），511–512

+   类型 对象，27

+   类型，5，8

## U

+   U2U（用户对用户）认证，491–493

+   UAC。*参见* 用户帐户控制

+   UIPI（用户界面特权隔离），76，129

+   UMFD（用户模式字体驱动程序）进程，92，405

+   不受限制的委托，480–484

+   Unicode NTLM 标志，427

+   UNICODE_STRING 结构，31，85–86

+   通用 组范围，347，354

+   未保护 命令，441，446，471，476

+   未保护的 DACL 安全信息标志，210–211

+   未保护的 SACL 安全信息标志，210

+   未保护 函数，328–331

+   更新 命令，4–5，427–428

+   UPNs（用户主体名称），345

+   仅用于拒绝 属性，111–112

+   *USER32* 库，70–71

+   用户帐户控制（UAC），93，124–126，409

+   提升类型，126–129

+   执行级别，126

+   过滤，416

+   关联令牌，126–129

+   查询可执行清单信息，125

+   UI 访问，129，138–139

+   虚拟化，129–130

+   User-Account-Restrictions 属性集，374–375

+   User-Change-Password 访问权限，377–378

+   用户委派权限，381

+   用户桌面创建，398–399

+   User-Force-Change-Password 访问权限，377–378

+   用户界面特权隔离（UIPI），76，129

+   用户模式访问检查，225

+   用户模式应用程序，64–96

+   DOS 设备路径，83–87

+   进程创建，87–91

+   系统进程，91–93

+   Win32

+   API，64–70，77–80

+   GUI，70–77

+   注册表路径，80–82

+   示例，94–96

+   用户模式字体驱动程序（UMFD）进程，92，405

+   用户主体名称（UPNs），345

+   用户对用户（U2U）身份验证，491–493

## V

+   变量

+   枚举所有，7

+   预定义，6–7

+   $VerbosePreference 全局变量，454

+   View 访问权限，320

+   ViewAuditInformation 访问权限，319

+   ViewLocalInformation 访问权限，319–320

+   VirtualBox，537

+   虚拟化，129–130，484

+   VirtualizationEnabled 属性，130

+   Visual Studio，261，538

+   VMS，292

## W

+   WarningAction 参数，276

+   WebClient 类，522

+   Where-Object 命令，17–19

+   宽字符串，79

+   通配符语法，10–11，15

+   Win32

+   API，64–70

+   加载新库，65–66

+   搜索 DLL，68–70

+   安全 API，208–213

+   系统调用和，77–80

+   查看导入的 API，66–67

+   GUI，70–77

+   控制台会话，74–77

+   内核资源，71–73

+   模块，70

+   窗口消息，73–74

+   注册表路径，80–82

+   句柄，80–81

+   HKEY_CLASSES_ROOT 句柄，90

+   列出注册表内容，81–82

+   打开密钥，81

+   *WIN32K* 驱动程序，70–71

+   Win32Path 参数，81

+   *WIN32U* 库，70–71

+   窗口

+   类，73

+   消息，73–74

+   对象，71–73

+   Windows 认证，299–340

+   Active Directory，341–396

+   域认证，300–304

+   交互式认证，397–419

+   本地域配置，305–311

+   网络认证，299，421–455

+   远程 LSA 服务，311–324

+   SAM 数据库，324–334

+   SECURITY 数据库，334–336

+   示例，336–339

+   Windows 域网络，535–545

+   配置，536

+   虚拟机，538–545

+   Windows Hyper-V，47，537–538

+   Windows 安装程序服务，93

+   Windows 内核，23–61

+   子系统和组件，24–56

+   用户模式应用程序，64–96

+   示例，56–61

+   Windows 操作系统，xxviii

+   PowerShell 测试环境设置，3–21

+   用户模式应用程序，64–96

+   Windows 内核，23–56

+   Windows 子系统 for Linux，64

+   WindowStation 对象，71–72

+   Windows 更新服务，4，93

+   Winlogon 进程，75，398–399，408

+   WinRM 协议，513

+   WinSock API，47

+   WM_CLOSE 消息，73

+   WM_GETTEXT 消息，74

+   WM_TIMER 消息，76

+   World 安全权限，219

+   WParam 参数，74

+   WriteAccount 访问权限，316，318

+   Write- 命令，16，49–50，59，291，448，454

+   WriteDac 访问权限，36，205–206，233，235，365

+   WriteGroupInformation 访问权限，316

+   WriteOtherParameters 访问权限，315

+   WriteOwner 访问权限，37，117，205–206，239

+   WritePasswordParams 访问权限，314

+   WritePreferences 访问权限，316

+   WriteProp 访问权限，366，370，372，375，378

+   写受限的令牌，119

+   写验证的访问权限，378–379

## X

+   X.509 证书，342，507

+   XML，20，528–529

## Z

+   Zerologon (CVE-2020-1472) 安全问题，403

+   Zw （Nt）前缀，24，29–30，224
