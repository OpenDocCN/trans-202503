<hgroup>

# <samp class="SANS_Dogma_OT_Bold_B_11">索引</samp>

</hgroup>

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">A</samp>

+   绝对安全描述符，149–151, 164

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">摘要</samp> 类别属性，354

+   访问检查，25, 36, 222, 265

+   活动目录，366

+   自动化，275–277

+   自由访问控制，228, 241–244, 249, 259

+   企业，249–260

+   句柄重复，269–272

+   内核模式，222–225

+   强制访问控制（MACs），228, 230–237, 242

+   对象类型，249–255

+   在 PowerShell 中，227–244

+   远程访问检查协议，389–390

+   沙箱令牌检查，244–249, 272–274

+   线程过程，271–272

+   令牌，227–228, 230, 237–241

+   遍历检查，266–269

+   用户模式，225

+   示例，261–263, 277–279

+   访问控制条目（ACEs），145, 153–156. *另见特定 ACE 的名称*

+   访问过滤器，233

+   回调，156

+   复合，154–155, 213–214

+   自由访问控制列表，145–146

+   查找带有 <samp class="SANS_TheSansMonoCd_W5Regular_11">Audit</samp> ACEs 的资源，294–295

+   标志，156

+   映射到标志字符串，167

+   强制标签，154, 167, 172, 201–203

+   普通，154–155

+   对象，154–155

+   排序，158–159

+   安全访问控制列表，145–146

+   支持的类型，153

+   类型字符串映射到 ACE 类型，167

+   访问控制列表（ACLs），151–156

+   ACEs，153–156

+   DACLs，145–146, 186, 215

+   映射到控制标志的标志字符串，166

+   头信息，152–153

+   NULL ACLs，146

+   SACLs, 144–146, 288–289, 292–293

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AccessFilter</samp> ACE，154，156，167

+   访问掩码，155

+   映射到访问字符串，168

+   关闭句柄，40

+   转换，38–39

+   显示，37–38

+   句柄表，39–40

+   数值，39

+   通用映射表，37

+   访问类型，36–37

+   访问模式，223–224

+   访问字符串

+   对于文件和注册表类型，169

+   强制标签访问字符串，172

+   映射到访问掩码，168

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AccessSystemSecurity</samp> 访问权限，37，178

+   访问令牌，25

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AccountNotDelegated</samp> 标志，490

+   ACE 标志字符串，167

+   ACEs。*参见* 访问控制条目；*特定 ACE 的名称*

+   ACL 标志字符串，166

+   ACLs。*参见* 访问控制列表

+   活动目录，341–396

+   访问检查，366–382

+   声明和中央访问策略，382–384

+   域配置，342–349

+   企业网络域，301–302

+   组策略，384–386

+   交互式身份验证，404

+   对象，349–353

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ObjectType</samp> GUID，用于，169

+   属性层次结构，250–251

+   模式，353–358

+   安全描述符，358–366

+   示例，387–395

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Add-</samp> 命令，49–52，59，84，157，251，309，311，324，371，389，543，415，417–418

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AddMember</samp> 访问权限，318

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Add-Member</samp> 函数，388

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AD-Domain-Services</samp> 功能，541，545

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AdjustDefault</samp> 访问权限，100

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AdjustGroups</samp> 访问权限，100

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AdjustPrivileges</samp> 访问权限，100，320

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AdjustQuotas</samp> 访问权限，320

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AdjustSessionId</samp> 访问权限，100

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AdjustSystemAccess</samp> 访问权限，320

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AdministerServer</samp> 访问权限，315

+   管理员用户，122–124

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LsaLogonUser</samp> API，409–410

+   删除特权，140–141

+   SAM 数据库，326

+   验证令牌，123–124

+   高级加密标准（AES），327–332

+   AES 密钥，470–471，496

+   高级本地过程调用（ALPC）子系统，24，55

+   AFD（辅助功能驱动程序），47

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Alarm</samp> ACEs，154，292

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AlarmCallback</samp> ACEs，154，292

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AlarmCallbackObject</samp> ACEs，154，292

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AlarmObject</samp> ACEs，154，292

+   别名，12–13，166，318，548

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Allowed</samp> ACEs，153–154，158，167

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AllowedCallback</samp> ACEs，154，167

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AllowedCallbackObject</samp> ACEs，154，167

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AllowedCompound</samp> ACEs，154–155

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AllowedObject</samp> ACEs，154，167

+   ALPC（高级本地过程调用）子系统，24，55

+   辅助功能驱动程序（AFD），47

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Anonymous</samp> 标志，518

+   匿名模拟级别，104，106，136

+   匿名会话，518–519

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Anonymous</samp> 类型，53

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Anonymous</samp> 用户 token，214

+   ANSI 字符串，79

+   API

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AcceptSecurityContext</samp> API，426–427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AcquireCredentialsHandle</samp> API，424

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AuthzAccessCheck</samp> API，156，243

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AuthZ</samp> API，387，389–390

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Create</samp> APIs，77–79，87–90，107，117，135，208，412–413

+   数据保护 API (DPAPI)，322，516

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DecryptMessage</samp> API，440–441，476

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">EncryptMessage</samp> API，440–442

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ExIsRestrictedCaller</samp> API，272

+   通用安全服务 API，476

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Get</samp> APIs，65–66，78，208–209，212

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ImpersonateNamedPipe</samp> API，104

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">InitializeSecurityContext</samp> API，423–424

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LoadLibrary</samp> API，65，68

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LogonUser</samp> API，102，401

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LsaLogonUser</samp> API，399–414

+   从 PowerShell 访问，410–412

+   创建用户桌面，398–399

+   域身份验证，403–404

+   本地身份验证，401–402

+   登录和控制台会话，404–406

+   登录类型，400

+   协议转换委托，489

+   安全包，400–401

+   token 创建，407–410

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LsaManageSidNameMapping</samp> API, 323–324

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LsaOpenPolicy</samp> API, 318–319

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">MakeSignature</samp> API, 441–443

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtAccessCheckByType</samp> API, 249

+   前缀到子系统映射, 24–25

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Query</samp> API, 430, 442

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RtlDosPathNameToNtPathName</samp> API, 83, 86

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RtlIsSandboxToken</samp> API, 272, 274

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Sam</samp> API, 313–316

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeAccessCheck</samp> API, 222–223

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeAccessCheckByType</samp> API, 249

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeAssignSecurityEx</samp> API, 180–182

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeCreateClientSecurity</samp> API, 484

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeImpersonateClient</samp> API, 484

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeSetSecurityDescriptorInfoEx</samp> API, 206–207

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetNamedSecurityInfo</samp> API, 208–210

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeTokenCanImpersonate</samp> API, 136

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetPrivateObjectSecurityEx</samp> API, 208

+   sets, 67–68

+   Shell, 89–91

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">VerifySignature</samp> API, 440–441

+   Win32 安全 API, 64–70, 77–80, 208–213

+   WinSock API, 47

+   应用容器进程, 120–122

+   应用程序信息服务, 93

+   应用程序包权限, 120

+   AP-REP 消息。*参见* 身份验证协议应答消息

+   AP-REQ（身份验证协议请求）消息, 494, 519–520

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">array</samp> 类型, 5

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">asInvoker</samp> UAC 执行级别, 126

+   AS-REP（身份验证服务应答）消息, 459

+   AS-REQ（身份验证服务请求）消息，458

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AssignPrimary</samp> 访问权限，100

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Audit</samp> ACEs，153，167，294–295

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AuditCallback</samp> ACEs，154，167

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AuditCallbackObject</samp> ACEs，154

+   审计。*见* 安全审计

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AuditLogAdmin</samp> 访问权限，319

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AuditObject</samp> ACEs，154，167

+   审计策略安全，287–293

+   配置全局 SACL，292–293

+   配置资源 SACL，288–291

+   身份验证审计事件日志，524–527

+   身份验证协议回复（AP-REP）消息

+   解密，476–477

+   委托，481

+   PowerShell 中的 Kerberos 身份验证，468–469

+   协商安全包，505

+   网络服务身份验证，463–464

+   身份验证协议请求（AP-REQ）消息，494，519–520

+   跨域身份验证，478

+   解密，469–476

+   委托，481–483，485–487

+   PowerShell 中的 Kerberos 身份验证，466–469

+   协商安全包，505

+   网络服务身份验证，463–464

+   U2U 身份验证，491–493

+   身份验证协议转换，486–487，490

+   身份验证服务回复（AS-REP）消息，459

+   身份验证服务请求（AS-REQ）消息，458

+   身份验证令牌，423，500

+   Authenticode 机制，54

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">AuthZAccessCheck</samp> 函数，387

+   自动继承标志，161，181–182，203，209–210，215

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Auxiliary</samp> 类别属性，354

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">B</samp>

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">BackgroundColor</samp> 参数，16

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">BaseNamedObjects</samp>（BNO）目录，29

+   控制台会话，76–77

+   查找对象管理器资源所有者，216–217

+   查询安全描述符和所有者，179

+   Win32 API 与系统调用，78

+   按位运算符，6

+   BNO 目录。*见* <samp class="SANS_TheSansMonoCd_W5Regular_11">BaseNamedObjects</samp> 目录

+   布尔运算符，6

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">bool</samp> 类型，5

+   暴力攻击，428–429，465

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">C</samp>

+   规范化，84–85，362

+   CBC（密码块链），330

+   中央访问策略，255–260

+   访问检查，258–259

+   Active Directory，382–384

+   声明，255–256，382–384

+   显示，257

+   启用，259–260

+   包含的信息，257

+   简单配置与，256

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ChangePassword</samp> 访问权限，316，377

+   通道绑定，444–445

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ChannelBindings</samp> 缓冲区标志，500

+   Chrome 网页浏览器，117

+   密码块链（CBC），330

+   密文窃取模式（CTS），466

+   Citrix，77

+   声明

+   Active Directory，382–384

+   设备，255–256

+   用户，255–256

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Class88</samp> 类别属性，354

+   客户端服务器运行时子系统（CSRSS），71

+   CLI XML 格式，20–21

+   CloudAP 安全包，403

+   代码完整性，54–55

+   Authenticode 机制，54

+   内核，24

+   前缀，25

+   目的，54

+   COM（组件对象模型）服务器进程，93

+   命令行解析，88–89

+   命令。*另见特定命令名称*

+   接受参数，9

+   访问属性和方法，9

+   别名，12–13

+   发现，10

+   执行，9–10

+   换行，9–10

+   命名约定，9

+   将一个的输出传递给另一个, 9

+   使用示例, 11–12

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Commit</samp> 状态值, 50

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Compare-</samp> 命令, 42, 231, 233

+   组件对象模型 (COM) 服务器进程, 93

+   条件表达式, 155, 169–171

+   访问控制过滤器 ACEs, 233–235

+   中央访问策略, 255, 257–259

+   中缀运算符, 171

+   类型值, 170

+   一元运算符, 170

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Confidentiality</samp> 请求属性标志, 440–441, 451

+   配置管理器。*见* 注册表

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Connect</samp> 访问权限, 313

+   控制台会话, 83, 416–417

+   创建用户桌面, 398

+   冒充令牌, 137

+   远程桌面服务, 74–75

+   命名对象的分离, 76–77

+   会话 ID, 102, 405

+   Windows 登录过程, 92

+   受限委托（用户服务），480, 484–491

+   仅 Kerberos, 485–486, 490

+   协议转换, 486–488, 490

+   基于资源的, 489–491

+   构造函数, 8

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ContainerInherit</samp> ACE 标志, 156, 167, 193–194, 202

+   上下文跟踪模式, 106

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ControlAccess</samp> 访问权限, 366, 378

+   控制访问权限, 376–379, 394

+   控制标志, 144–145, 166, 173, 182, 193–194, 215, 381

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Dacl</samp>, 144–146, 166, 181–182, 194, 215

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RmControlValid</samp>, 149

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Sacl</samp>, 144–145, 166, 181

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SelfRelative</samp>, 149–151

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ServerSecurity</samp>, 213–214

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">TrustedForDelegation</samp>, 381, 482

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">TrustedToAuthenticateFor Delegation</samp>, 381

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ConvertFrom-</samp> 命令, 155–156, 163, 173, 502, 509

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ConvertTo-NtSecurityDescriptor</samp> 命令, 218

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Copy-</samp> 命令, 41, 107–108, 140

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateAccount</samp> 访问权限, 319–320

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateAlias</samp> 访问权限, 315

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateChild</samp> 访问权限, 366–368

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateDirectories</samp> 属性, 267

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateDomain</samp> 访问权限, 313

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateGroup</samp> 访问权限, 315, 317

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreatePrivilege</samp> 访问权限, 319

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateSecret</samp> 访问权限, 319

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateUser</samp> 访问权限, 315

+   创建者安全描述符, 180

+   在资源创建过程中分配, 180–188

+   继承规则, 215

+   凭证保护, 484

+   凭证管理器, 514–517

+   CredSSP 协议, 510–513

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Critical</samp> ACE 标志, 156, 167, 208

+   跨域身份验证, 477–479

+   加密派生过程, 431–433

+   CSRSS（客户端服务器运行时子系统）, 71

+   CSV 文件, 20

+   CTS（密文盗取模式）, 466

+   CVE 安全问题

+   2014-6324, 475

+   2014-6349，278

+   2018-0748，184

+   2018-0983，212

+   2019-0943，57，271

+   2020-1472（Zerologon），403

+   2020-1509，523

+   2020-17136，225

+   2021-34470，368

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">D</samp>

+   DAC（自主访问控制），36，143

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Dacl</samp> 控制标志，144–146，166，181–182，194，215

+   DACLs。*参见* 自主访问控制列表

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Dacl</samp> 安全信息标志，211

+   DAP（目录访问协议），342

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Data</samp> 缓冲区标志，500，502

+   数据加密标准（DES），332–333

+   数据报传输层安全协议（DTLS），506

+   数据保护 API（DPAPI），322，516

+   DCOM 服务器进程启动器，93

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Delegate</samp> 标志，483

+   委托，479–480

+   受限，480，484–491

+   不受限，480–484

+   委托冒充级别，105–107

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Delete</samp> 访问权限，36，168，369

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DeleteChild</samp> 访问权限，366，369

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DeleteTree</samp> 访问权限，366，369

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Denied</samp> ACEs，153–154，158，167，243，255

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DeniedCallback</samp> ACEs，154，167

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DeniedCallbackObject</samp> ACEs，154

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DeniedObject</samp> ACEs，154，167，252–253，255

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DenyCallback</samp> ACEs，243

+   DES（数据加密标准）, 332–333

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DesiredAccess</samp> 参数, 30, 36, 79

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Desktop</samp> 对象, 71–72

+   桌面窗口管理器（DWM）进程, 92, 405

+   DHCP（动态主机配置协议）, 537, 540

+   Diffie-Hellman 密钥交换, 477, 508

+   目录访问协议 (DAP), 342

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Directory</samp> 对象, 28, 169, 219

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Disable-NtTokenPrivilege</samp> 命令, 114

+   自愿访问检查, 228, 230, 241–243

+   自愿访问控制 (DAC), 36, 143

+   自愿访问控制列表 (DACLs), 145–146

+   控制标志, 144–146, 166, 181–182, 194, 215

+   默认, 186

+   继承规则, 215

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DistinguishedName</samp> 属性, 351

+   区别名称, 349–351

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DllMain</samp> 函数, 66

+   DLLs, 65–69, 119

+   API 集, 67–68

+   延迟加载, 67

+   .*DLL* 文件扩展名, 69

+   导出转发, 66

+   劫持, 68–69

+   加载新库, 65–66

+   *NTDLL*, 65–66

+   搜索, 68–70

+   不受信任, 66

+   查看导入的 API, 66–67

+   DNS。 *参见* 域名系统

+   域认证, 300–304

+   域森林, 302–304

+   企业网络域, 301–302

+   本地认证, 299–301

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LsaLogonUser</samp> API, 403–404

+   域森林, 302–304

+   全局目录, 303–304

+   多个, 304

+   信任关系, 303

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">DomainLocal</samp> 组作用域, 346–347

+   域名系统（DNS），302，344，536

+   Active Directory 域配置，344–345

+   虚拟机，540，544

+   域策略远程服务，312，318–324

+   访问权限，319

+   账户对象，319–321

+   连接到，318–319

+   名称查找和映射，323–324

+   秘密对象，321–322

+   受信域对象，322–323

+   域安全策略，282

+   完成状态，430

+   DOS 设备路径，83–87

+   规范化，84–85

+   显示符号链接，83–84

+   DOS 设备映射前缀，83

+   最大路径长度，85–87

+   路径分隔符，84

+   路径类型，84–85

+   双重跳跃问题，435

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">double</samp> 类型，5

+   DPAPI（数据保护 API），322，516

+   绘图资源对象，71

+   DTLS（数据报传输层安全性）协议，506

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Duplicate</samp> 访问权限，100

+   DWM（桌面窗口管理器）进程，92，405

+   动态访问控制，255

+   动态主机配置协议（DHCP），537，540

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">E</samp>

+   ECB（电子密码本），333

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Edit-</samp> 命令，158–159，190，364

+   有效伪令牌句柄，108

+   有效令牌模式，106

+   电子密码本（ECB），333

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Empty</samp> 缓冲区标志，500

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Enabled</samp> 属性，110，114

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">EnabledByDefault</samp> 属性，110，114

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Enable-NtTokenPrivilege</samp> 命令，114

+   企业访问检查，249–260

+   中央访问策略，255–260

+   对象类型访问检查，249–255

+   企业身份验证能力，520–523

+   企业网络域，301–302。*另见* Active Directory

+   域控制器，301–302

+   群组策略，302

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">EnumerateDomains</samp> 访问权限，313–314

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">EnumerateUsers</samp> 访问权限，287

+   EPA（扩展身份验证保护），444

+   转义字符，7–8

+   Windows 事件追踪 (ETW)，292

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Everyone</samp> ACEs，365

+   显式凭据，437，522–523

+   显式令牌冒充，107

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Export-</samp> 命令，20，533

+   导出数据

+   到 CLI XML 格式，20–21

+   到 CSV 文件，20

+   到文本文件，20

+   表达式，5–8

+   扩展身份验证保护 (EPA)，444

+   扩展权限，373–376

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ExtendedSessionSecurity</samp> NTLM 标志，429–430

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Extra</samp> 缓冲区标志，500

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">F</samp>

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">FailedAccess</samp> ACE 标志，156，168

+   快速用户切换功能，75，417

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">File</samp> 对象，30，41，162，169

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ForceAccessCheck</samp> 属性标志，224–225

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ForcePasswordChange</samp> 访问权限，316

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ForegroundColor</samp> 参数，16

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Format-</samp> 命令，15，27，44，60，103，159–161，209，359，427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Forwardable</samp> 标志，472，485–486，490

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Free</samp> 状态值, 50–51

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">FullName</samp> 属性, 9

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">function</samp> 关键字, 13

+   函数, 13–14

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">G</samp>

+   *GDI32* 库, 70–71

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GenericAll</samp> 访问值, 37, 250–252, 254

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GenericExecute</samp> 访问值, 37, 235

+   通用映射, 39, 181

+   分配安全描述符

+   在资源创建期间, 181, 185

+   对现有资源, 206–207

+   内核模式访问检查, 222

+   强制完整性级别检查, 235

+   映射表, 37

+   用户模式访问检查, 225

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GenericRead</samp> 访问值, 37, 39, 235

+   通用安全服务应用程序编程接口 (GSSAPI), 476

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GenericWrite</samp> 访问值, 37, 235

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetAliasMembership</samp> 访问权限, 315

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Get-</samp> 命令，7，9–16，26–27，34，37–39，43–48，50–51，54，56–57，65–68，72，74，78，81，83，85–87，93–94，102–103，108–110，112–114，147–148，175–176，179，206，208–209，217–218，226–229，244–245，257–258，261–262，275–277，286–287，289，305–306，308，310–312，314–315，317–320，327，344–348，350–351，356–357，359，363，368–369，373–374，379，382–384，386，390，395，400，404–405，411，441，470–471，494–495，543，545

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Get-</samp> 函数，140，242，339，393–395，431–433，448，532，529

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetObject</samp> 方法，59

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GetPrivateInformation</samp> 访问权限，319

+   全球目录，303–304，352–353

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Global</samp> 组范围，346–347

+   金色票券，462–463

+   Google Chrome 网络浏览器，117

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GrantedAccessMask</samp> 属性，39

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GroupByAddress</samp> 参数，58

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Group-Object</samp> 命令，19，58

+   组策略，256–257，409

+   Active Directory，384–386

+   对已知 Web 代理的认证，521

+   企业网络域，301–302

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Group</samp> 安全信息标志，157，183

+   GSSAPI（通用安全服务应用程序接口），476

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">GSS_</samp> 函数，476

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">H</samp>

+   句柄，30，35–42

+   访问掩码，36–40

+   关闭，40

+   显示句柄表，39–40

+   重复，40–41

+   重复未命名，187–188

+   重复访问检查，269–272

+   按名称查找开放句柄，57

+   查找要冒充的令牌句柄，139–140

+   句柄表，35

+   虚拟，48，108–109

+   注册表，80

+   Windows，73

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Handles</samp> 属性，18–19

+   基于哈希的消息认证码（HMACs），429

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">hashtable</samp> 类型，5

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">highestAvailable</samp> UAC 执行级别，126

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">HKEY_CLASSES_ROOT</samp> 句柄，90

+   Hyper-V，47，537–538

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">I</samp>

+   IBM OS/2 操作系统，64，85

+   身份验证冒充级别，105–106，136

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Identify</samp> 请求属性标志，519–520

+   身份令牌，519–520

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Id</samp> 属性，14，284

+   IIS（Internet Information Services）Web 服务器，414

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Image</samp> 类型，53

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Impersonate</samp>访问权限，100，104，107

+   模拟的模拟级别，105

+   模拟伪令牌句柄，108

+   模拟令牌，104–107

+   显式令牌模拟，107

+   模拟上下文，104

+   SQoS，104–107

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">导入</samp>命令，5，20，65–66

+   导入数据，20–21

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">InfoOnly</samp>参数，47，314

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">InformationClass</samp>参数，43

+   继承，215

+   自动继承，181

+   行为，197

+   危险，212

+   标志，182，194

+   父安全描述符，188–194

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">继承</samp>属性标志，42

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Inherited</samp> ACE 标志，156，158，167，212

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">InheritedObjectType</samp> GUID，169，203–205

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">InheritOnly</samp> ACE 标志，156，167

+   初始化向量，329–330

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Initialize</samp>访问权限，313

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">InitialOwner</samp>参数，32，79

+   输入/输出（I/O）管理器，24–25，45–47

+   设备驱动程序，45

+   显示设备对象，46

+   列出驱动程序，47

+   打开设备对象并显示卷路径，46–47

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Install-</samp>命令，4，545

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Int64</samp>安全属性类型，260

+   集成 Windows 身份验证（IWA），424

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Integrity</samp>属性标志，112–113

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">IntegrityEnabled</samp>属性，112

+   完整性级别, 102, 112, 124, 137

+   交互式身份验证, 397–419, 458–464

+   AP-REP 消息, 464

+   AP-REQ 消息, 464

+   AS-REP 消息, 459–461

+   AS-REQ 消息, 458

+   使用令牌创建新进程, 412–413

+   创建用户桌面, 398–399

+   初始用户身份验证, 458–462

+   KDC 服务, 458

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LsaLogonUser</samp> API, 399–412

+   网络服务身份验证, 463–465

+   预身份验证数据, 458

+   特权属性证书, 459

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">服务</samp> 登录类型, 413–414

+   服务主体名称, 460

+   TGS-REP 消息, 461–462

+   TGS-REQ 消息, 460–461

+   票证授予服务器, 459

+   票证授予票证, 459

+   票证, 458

+   示例， 414–419

+   Internet Explorer, 118–119

+   Internet 信息服务（IIS）Web 服务器, 414

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">int</samp> 类型, 5

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Invoke-</samp> 命令, 14, 105

+   I/O 管理器。*见* 输入/输出管理器

+   ISE（PowerShell 集成脚本环境）, 261

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">IsFiltered</samp> 标志, 128, 269

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">IsRestricted</samp> 标志, 269

+   IWA（集成 Windows 身份验证）, 424

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">J</samp>

+   John the Ripper, 496

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">K</samp>

+   KDC 服务。*见* 密钥分发中心服务

+   Kerberoasting, 465, 495–496

+   Kerberos, 457–497

+   AP-REP 消息解密, 476–477

+   AP-REQ 消息解密, 469–476

+   CredSSP 协议, 512

+   跨域身份验证, 477–479

+   委托, 479–491

+   双跳问题, 435

+   金票, 462–463

+   交互式身份验证, 458–464

+   PKINIT，477

+   通过 PowerShell，465–469

+   服务主体名称，443

+   银票证书，465

+   U2U 认证，491–493

+   工作示例，493–496

+   Kerberos 凭据 (KRB-CRED)，483

+   仅限 Kerberos 委托（用户到代理的服务），485–486，490

+   *KERNEL32* 库，64–65

+   *KERNELBASE* 库，64–65

+   内核模式访问检查，222–225

+   访问模式，223–224

+   内存指针检查，224–225

+   参数，222

+   KernelObjects OMNS 目录，75

+   密钥分发中心 (KDC) 服务

+   跨域认证，478

+   解密 AP-REQ 消息，473，475

+   初始用户认证，458，477

+   仅限 Kerberos 委托，485

+   网络服务认证，463–464

+   协议转换委托，486–487

+   基于资源的委托，490

+   U2U 认证，491

+   无限制委托，481

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">KeyExchange</samp> 标志，441

+   密钥版本号，467

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">KeywordsDisplayNames</samp> 属性，290

+   *KnownDlls* OMNS 目录，69–70

+   KRB-CRED（Kerberos 凭据），483

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">L</samp>

+   LAN 管理器 (LM)，306，327

+   较低特权的应用容器 (LPACs)，246

+   轻量级目录访问协议 (LDAP)，342，354–358，371，494

+   关联令牌，126–129，262

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">List</samp> 访问权限，366–367，369

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ListAccounts</samp> 访问权限，315

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ListGroups</samp> 访问权限，316

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ListMembers</samp> 访问权限，318

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ListObject</samp> 访问权限，366，369

+   LM (LAN 管理器)，306，327

+   本地认证，299–301，398

+   本地域，300

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LsaLogonUser</samp> API，401–402

+   用户数据库，305

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LocalCall</samp> 标志，436

+   本地域配置，300，305–311

+   LSA 策略数据库，309–312

+   用户数据库，305–309

+   本地回环认证，435–436

+   本地唯一标识符（LUIDs），102–103

+   本地安全机构（LSA），305，309–324

+   提取系统密钥，327–328

+   登录账户权限，310–311

+   权限账户权限，310

+   远程服务，311–324

+   本地安全机构子系统（LSASS），26，92

+   创建令牌，131–133

+   枚举 SIDs，175–176

+   查找具有审计 ACEs 的资源，295

+   链接令牌，128

+   登录会话，102

+   本地安全策略，282

+   登录账户权限，310–311，415–416

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LogonId</samp> 属性，111，405

+   登录类型，400，402，408–412

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Network</samp> 登录类型，409–411

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NewCredentials</samp> 登录类型，438

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Service</samp> 登录类型，413–414

+   LogonUI 进程，92，398

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LongPathsEnabled</samp> 值，87

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">long</samp> 类型，5

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Lookup</samp>访问权限，315

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LookupDomain</samp> 访问权限，313–314

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LookupNames</samp>访问权限，319，323

+   lowbox 令牌，120–122，246–249，273，520–523

+   LPACs（较低权限应用容器），246

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LParam</samp> 参数，74

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">lpMutexAttributes</samp> 参数，78

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">lpName</samp> 参数，78

+   LSA。*参见* 本地安全权限

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LsaLogonUser</samp> API，399–414

+   从 PowerShell 访问，410–412

+   创建用户桌面，398–399

+   域认证，403–404

+   本地认证，401–402

+   登录和控制台会话，404–406

+   登录类型，400

+   协议转换委托，489

+   安全包，400–401

+   令牌创建，407–410

+   LSASS。*参见* 本地安全权限子系统

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">LuaToken</samp> 标志，128，140

+   LUID（本地唯一标识符），102–103

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">M</samp>

+   强制访问检查（MACs），228–237

+   访问过滤器 ACEs，233–235

+   lowbox 令牌，247–248

+   强制完整性级别检查，235–237

+   进程信任级别检查，231–233

+   强制访问控制，102，143

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Mandatory</samp> 属性，110

+   强制完整性控制（MIC），230

+   强制完整性级别检查，235–237

+   强制标签 ACEs，154，167

+   访问字符串，172

+   在资源创建期间分配安全描述符，201–203

+   完整性级别 SID，172

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">MandatoryLabel</samp> 安全权限，112

+   强制策略值，161

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">MapGenericRights</samp> 参数，39

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">MapWrite</samp> 访问，52，58

+   MD4 哈希值，306，432

+   MD5 哈希值，329，431，466

+   内存管理器，49–54

+   查找可写且可执行的内存，60–61

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtVirtualMemory</samp> 命令，49–51

+   页面文件，49

+   前缀, 25

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Section</samp> 对象, 51–54

+   虚拟内存空间, 49

+   内存指针检查, 224–225

+   消息完整性代码 (MICs), 425, 429, 433

+   消息循环, 73

+   Microsoft Visual Studio, 261, 538

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ModifyState</samp> 访问, 42, 270–271

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Mutant</samp> 对象, 29–30, 181, 187, 193

+   双向身份验证, 464

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">MutualAuth</samp> 标志, 483

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">MutualAuthRequired</samp> 标志, 469

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">N</samp>

+   纳格尔算法, 448

+   NAT (网络地址转换), 537

+   协商安全包, 401, 503–505

+   初始化, 503–505

+   安全机制, 504

+   指定凭证, 504

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NegotiateStream</samp> 类, 445

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NetCredentialsOnly</samp> 标志, 413

+   Netlogon 协议, 342, 403

+   网络地址转换 (NAT), 537

+   网络身份验证, 421–455

+   凭证, 407

+   低框令牌, 520–523

+   NTLM 网络身份验证, 422–438

+   NTLM 中继攻击, 438–445

+   实例演示, 445–454

+   网络级身份验证 (NLA), 511

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">网络</samp> 登录类型, 409–411

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">New-</samp> 命令, 8, 12–13, 46, 51–53, 56, 81, 85, 88–89, 132–133, 157, 251, 273, 306–307, 309, 325, 361, 381, 389–390, 424, 500, 507, 537, 539

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NewCredentials</samp> 登录类型, 438

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">New-</samp> 函数, 189, 232, 538–539

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NewGuid</samp> 静态方法, 8

+   NLA（网络级身份验证）, 511

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">None</samp> ACE 标志, 193

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NoPropagateInherit</samp> ACE 标志, 156, 167, 193–194

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NoRightsUpgrade</samp> 标志, 188, 270–271

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Notification</samp> 访问权限, 319

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Nt</samp> (<samp class="SANS_TheSansMonoCd_W5Regular_11">Zw</samp>) 前缀, 24, 29–30, 224

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtAccessCheck</samp> 系统调用, 225–227, 249, 254, 291

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtAdjust</samp> 系统调用, 110, 114–115

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtAllocate</samp> 系统调用, 49–50, 102, 409

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtChallengeResponse</samp> 系统调用, 433

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtCloseObjectAuditAlarm</samp> 系统调用, 291

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtCreate</samp> 系统调用, 29–30, 55, 77, 116, 120, 132

+   *NTDLL* (NT 层动态链接库)，65–66

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtDuplicate</samp> 系统调用，41，107

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtFilterToken</samp> 系统调用，117

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtFreeVirtualMemory</samp> 系统调用，49

+   NT 哈希值，306，326–327，332，334

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtImpersonate</samp> 系统调用，106–107

+   NTLM (NT 局域网管理器)

+   标志，425，427

+   网络身份验证，422–438

+   身份验证令牌，423

+   绕过代理检查，523–524

+   破解用户密码，428–429

+   CredSSP 协议，512

+   密码学衍生过程，431–433

+   显式凭据，437

+   假冒令牌，437–438

+   本地管理员，430–431

+   本地回环身份验证，435–436

+   协商安全包，503–505

+   直通身份验证，434–435

+   变种，422

+   通过 PowerShell，423–430

+   中继攻击，438–445

+   活跃服务器挑战，440

+   通道绑定，444–445

+   示例，439

+   签名和封装，440–443

+   目标名称，443

+   安全包，401

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtLoadDriver</samp> 系统调用，45，116

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtMake</samp> 系统调用，40–41

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtMapViewOfSection</samp> 系统调用，51

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtObjectManager</samp> 模块，xx，356，359

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtOpen</samp> 系统调用，100，291

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtPrivilegeCheck</samp> 系统调用，115

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtQuery</samp> 系统调用，30，39，47，49，126，179–180

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtReadVirtualMemory</samp> 系统调用, 49

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtSecurityDescriptor</samp> 属性, 358, 380

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtSetInformation</samp> 系统调用, 107, 128, 131–132, 135

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtSetSecurityObject</samp> 系统调用, 205–206

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NTSTATUS</samp> 代码, 32–35, 77–78

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NtWriteVirtualMemory</samp> 系统调用, 49

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NullSession</samp> 请求属性标志, 518

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">O</samp>

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ObjectAccess</samp> 审计类别, 284–285

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ObjectAttributes</samp> 参数, 30–31

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">OBJECT_ATTRIBUTES</samp> 结构, 30–32

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ObjectClass</samp> 属性, 351, 355

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ObjectInherit</samp> ACE 标志, 156, 167

+   对象管理器, 24, 180–181

+   显示对象类型, 27–28

+   DOS 设备路径, 83–84

+   查找所有者, 216–218

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">NTSTATUS</samp> 代码, 32–35

+   对象目录, 29

+   对象句柄, 35–42

+   对象管理器命名空间, 28

+   自动化访问检查, 275–276

+   永久对象, 40–41

+   注册表, 55

+   遍历检查, 266–267

+   Win32 注册表路径, 80–82

+   前缀, 24

+   系统调用, 29–32

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Query</samp> 和 <samp class="SANS_TheSansMonoCd_W5Regular_11">Set</samp> 系统调用, 42–45

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ObjectName</samp> 参数, 31–32, 291

+   对象

+   访问属性, 8

+   属性标志, 32

+   创建, 8

+   目录, 29

+   显示, 14–17, 27

+   过滤, 17–19

+   查找共享对象, 57–59

+   分组, 19

+   句柄, 30, 35–42, 187–188

+   调用方法, 8

+   命名, 31

+   永久, 40–41

+   排序, 18–19

+   对象类型访问检查, 249–255

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ObjectType</samp> GUID, 169, 203–205

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ObjectTypes</samp> 参数, 249, 251–253

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Oem</samp> NTLM 标志, 427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">OkAsDelegate</samp> 标志, 481–483

+   OMNS. *参见* 对象管理器命名空间 *下的* 对象管理器

+   操作符, 6, 14, 18

+   中缀, 171

+   一元运算符, 170

+   Oracle VirtualBox, 537

+   组织单位, 385–386

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Out-</samp> 命令, 16–17, 20, 54, 60

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Owner</samp> 属性, 111

+   所有者检查, 184, 240–241

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Owner</samp> 安全信息标志, 184

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">P</samp>

+   页面文件, 49

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Paging</samp> 参数, 16

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Parameter</samp> 命令, 11

+   参数, 9, 11

+   父级安全描述符, 180, 182, 185–203

+   继承规则, 215

+   同时设置创建者和父级, 195–200

+   不设置创建者或父级, 185–188

+   仅设置父级, 188–195

+   哈希传递技术, 306

+   透传身份验证, 434–435

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">PassThru</samp> 参数, 17, 285

+   基于密码的密钥派生函数 2（PBKDFv2）算法, 471

+   密码加密密钥（PEKs）

+   解密, 328–330

+   解密密码哈希, 330–332

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Path</samp> 参数, 9

+   PDC (主域控制器) 模拟器, 345

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Permanent</samp> 属性标志, 40

+   每用户审计策略, 285–287

+   进程 ID (PIDs), 47–48

+   管道 (<samp class="SANS_TheSansMonoCd_W5Regular_11">|</samp>), 9

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">PkgParams</samp> 缓冲区标志, 500–501

+   PKINIT (公共密钥初始认证), 477

+   即插即用 (PnP) 管理器, 45

+   POSIX, 64, 85, 145

+   PowerShell, 3–21

+   配置, 4–5

+   发现命令, 10

+   显示和操作对象, 14–17

+   等效的 SDK 名称, 38

+   执行命令, 9–10

+   导出数据, 20–21

+   表达式, 5–8

+   过滤对象, 17–19

+   函数, 13–14

+   获取帮助, 10–13

+   对象分组, 19

+   集成脚本环境, 261

+   换行符, xxviii

+   模块, 4–5

+   操作符, 6

+   脚本执行策略, 4–5

+   对象排序, 18–19

+   字符串字符转义, 7–8

+   字符串插值, 7

+   书中示例的样式约定, xxvii–xxviii

+   类型, 5–6, 8

+   变量, 6–7

+   版本, 3–4

+   预认证数据, 458–459

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">PreviousMode</samp> 值, 223–224

+   主域控制器 (PDC) 模拟器, 345

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Primary</samp> 令牌, 100, 108, 133–134

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Principal</samp> 参数, 249–250

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">print</samp> Shell 动词, 90–91

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">printto</samp> Shell 动词, 90–91

+   特权属性证书 (PACs), 408

+   跨域认证, 478–479

+   解密 AP-REQ 消息, 472–475

+   委派, 487

+   golden tickets, 462

+   初始用户身份验证，458–462

+   网络服务身份验证，464

+   银票，465

+   特权检查，238–239

+   进程和线程管理器，24，47–48

+   显示进程和线程，47–48

+   打开进程和线程，48

+   前缀，25

+   进程和线程 ID，47

+   进程创建，87–91

+   命令行解析，88–89

+   Shell API，89–91

+   进程 ID（PIDs），47–48

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ProcessName</samp> 属性，14，19

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Process</samp> 对象，18，42

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Process</samp> 参数，49

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ProcessTrustLabel</samp> ACEs，154，167

+   进程信任级别检查，231–233

+   属性集，251，373–376

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ProtectedDacl</samp> 安全信息标志，210–211，364

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ProtectedData</samp> 类，516

+   受保护的对象，381–382

+   受保护的进程，231–233

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ProtectedSacl</samp> 安全信息标志，210

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ProtectFromClose</samp> 属性，42

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Protect-LsaContextMessage</samp> 命令，441

+   协议转换委托（用户到自我服务），486–488，490

+   代理自动配置（PAC）脚本，521

+   伪句柄，48，108–109

+   公钥初始身份验证（PKINIT），477

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">Q</samp>

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Query</samp> 访问权限，100

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">QueryInformation</samp> 类，45

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">QueryInformation</samp> 系统调用动词，30

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">QueryLimitedInformation</samp> 访问权限，49，61

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">QueryMiscPolicy</samp> 访问权限，287

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">QuerySource</samp> 访问权限，100

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Query</samp> 系统调用，42–45

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">QuerySystemPolicy</samp> 访问权限，287

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">QueryUserPolicy</samp> 访问权限，287

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">QueryValue</samp> 访问权限，322

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">R</samp>

+   彩虹表，429

+   RC4 加密算法，327–328，331，442，466，470

+   RDP（远程桌面协议），75，77

+   RDS（远程桌面服务），74，77

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ReadAccount</samp> 访问权限，316

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Read-</samp> 命令，49–51，307，410

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ReadControl</samp> 访问权限，36，178，240–241

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ReadGeneral</samp> 访问权限，316

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ReadGroupInformation</samp> 访问权限，316

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ReadInformation</samp> 访问权限，318

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ReadLogon</samp> 访问权限，316

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ReadOnly</samp> 缓冲区标志，501

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ReadOnly</samp> 保护状态，49

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ReadOnlyWithChecksum</samp> 缓冲区标志，501

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ReadOtherParameters</samp> 访问权限，315

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ReadPasswordParameters</samp> 访问权限，314–315

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ReadPreferences</samp> 访问权限，316

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ReadProp</samp> 访问权限，366，370

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Read-TlsRecordToken</samp> 函数，532

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Receive-</samp> 函数, 448

+   转介票证, 478–479

+   regedit 应用程序, 80

+   注册表 (配置管理器), 24, 55–56

+   附加点, 56

+   注册表项, 56

+   键和值, 55–56

+   前缀, 25

+   相对区分名称, 349–350

+   相对标识符 (RIDs), 26, 112

+   应用容器和低箱令牌, 120–121

+   循环, 323, 336–337

+   强制完整性级别检查, 235

+   SID 结构, 146–149

+   用户数据库, 306–308

+   相对安全描述符, 149–151, 163–164

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RemainingAccess</samp> 值, 229–230

+   远程访问检查协议, 389–390

+   远程凭证保护, 513

+   远程桌面协议 (RDP), 75, 77

+   远程桌面服务 (RDS), 74, 77

+   远程过程调用 (RPCs), 55, 104

+   远程过程调用子系统 (RPCSS), 92–93

+   远程服务器管理工具 (RSAT), 343–344

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Remove-</samp> 命令, 49–52, 56, 115, 308–309, 311, 324, 369, 416

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RemoveMember</samp> 访问权限, 318

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Renewable</samp> 标志, 472

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">requireAdministrator</samp> UAC 执行级别, 126

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Reserve</samp> 状态值, 50

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Reset-Win32SecurityDescriptor</samp> 命令, 211

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Resolve-</samp> 函数, 238, 240, 244

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Resource</samp> 属性, 113, 408

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ResourceAttribute</samp> ACEs, 154, 167

+   基于资源的委托, 489–491  

+   资源管理器标志, 144–145, 149  

+   限制管理员模式, 513–514, 525  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RestrictedKrbHost</samp> 类, 467–468  

+   限制令牌, 117–119, 244–245  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">return</samp> 关键字, 13  

+   RIDs. *参见* 相对标识符  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RmControlValid</samp> 控制标志, 149  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RootDirectory</samp> 参数, 31–32  

+   根目录系统代理条目（RootDSE）, 350  

+   RPCs（远程过程调用）, 55, 104  

+   RSAT（远程服务器管理工具）, 343–344  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">RtlNewSecurityObjectEx</samp> 系统调用, 182  

+   Rubeus, 496  

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">S</samp>  

+   S4U. *参见* 受限委托  

+   S4U2proxy（用户到代理的服务）, 485–486, 490  

+   S4U2self（用户自我服务）, 486–488, 490  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SaclAutoInherit</samp> 自动继承标志, 209–210  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Sacl</samp> 控制标志, 145, 166, 181  

+   SACLs. *参见* 安全访问控制列表  

+   SAM. *参见* 安全账户管理器数据库; 安全账户管理器远程服务  

+   沙箱令牌, 117–122, 244–249  

+   访问检查, 272–274  

+   低箱令牌, 120–122, 246–249  

+   限制令牌, 117–118, 244–245  

+   写入受限令牌, 119

+   SAS（安全注意序列）, 399  

+   SCM（服务控制管理器）, 92–93  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ScopedPolicyId</samp> ACEs, 154, 167  

+   脚本块, 14, 18  

+   SDDL 格式. *参见* 安全描述符定义语言格式  

+   SDK（软件开发工具包）, 38, 110, 112  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SDKName</samp> 属性, 38, 161  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Search-Win32SecurityDescriptor</samp> 命令, 212–213

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeAssignPrimaryTokenPrivilege</samp> 权限, 116

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeAuditPrivilege</samp> 权限, 116

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeBackupPrivilege</samp> 权限, 116, 123

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeBatchLogonRight</samp> 账户权限, 311, 402, 416

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeChangeNotifyPrivilege</samp> 权限, 116, 267

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">secpol.msc</samp> 命令, 282

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeCreateTokenPrivilege</samp> 权限, 116, 123, 132

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Section</samp> 对象, 217

+   创建节并映射到内存, 51–52

+   查找共享文件, 57–59

+   查找可写文件, 278–279

+   列出带名称的映射文件, 53

+   映射和查看加载的镜像, 53–54

+   修改映射区域, 59–60

+   安全注意序列 (SAS), 399

+   安全通道, 506–510

+   加密和解密应用数据, 508–509

+   提取服务器 TLS 证书, 530–533

+   检查连接信息, 508

+   设置, 506–507

+   TLS 记录结构, 507

+   安全套接层 (SSL) 协议, 506–507

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SecureString</samp> 类, 307

+   安全访问控制列表 (SACLs), 145–146

+   控制标志, 144–145, 166, 181

+   全局, 292–293

+   资源, 288–291

+   安全访问令牌

+   管理员用户, 122–124

+   分配, 133–138

+   转换/复制, 107–108

+   创建, 131–133

+   组, 109–113

+   模拟令牌, 104–107, 136–138

+   完整性级别, 102

+   主令牌, 100–104, 133–136

+   权限, 113–117

+   伪令牌句柄, 108–109

+   沙箱令牌, 117–122

+   安全属性, 130–131, 172

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Int64</samp> 安全属性类型, 260

+   用户账户控制, 124–130

+   实际示例, 138–141

+   安全账户管理器（SAM）数据库, 312, 324–334

+   通过注册表访问, 325–334

+   Active Directory 前的企业网络配置, 342

+   安全账户管理器（SAM）远程服务, 312–318

+   访问权限, 313

+   别名对象, 318

+   域对象, 314

+   组对象, 317

+   用户对象, 315–316

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SECURITY_ATTRIBUTES</samp> 结构, 78–79

+   安全审计, 281–295

+   审计策略安全, 287–293

+   安全事件日志, 282–286

+   实际示例, 287–295

+   安全授权, 147

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">MandatoryLabel</samp>, 112

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">World</samp>, 219

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SecurityBuffer</samp> 类, 500

+   安全缓冲区, 500

+   带有认证上下文, 501–502

+   带有签名和封印, 502–503

+   SECURITY 数据库, 324, 334–336

+   安全描述符定义语言（SDDL）格式, 26, 165–173

+   访问字符串, 168–169, 172

+   ACE 标志字符串, 167

+   ACL 标志字符串, 166

+   条件表达式, 170–171

+   将安全描述符转换为, 165

+   强制标签完整性级别 SID, 172

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ObjectType</samp> 在 AD 中使用的 GUID, 169

+   安全属性 SDDL 类型字符串, 172

+   SID 别名, 166, 547–549

+   拆分组件, 165

+   映射到 ACE 类型的类型字符串, 167

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SecurityDescriptor</samp> 对象, 151, 157

+   安全描述符, 143–220

+   绝对和相对, 149–151

+   访问控制列表, 151–156

+   分配

+   在资源创建期间, 180–205

+   到现有资源, 205–208

+   组件, 144–146

+   转换

+   从相对描述符转换, 163–164

+   转换为 SDDL 格式, 165

+   创建, 157–158

+   格式化, 159–163

+   继承行为, 214–215

+   排序 ACEs, 158–159

+   读取, 178–179

+   SDDL 格式, 165–173

+   服务器安全描述符和复合 ACEs, 213–214

+   SID 结构, 146–149

+   标准化, 362

+   结构, 144

+   Win32 安全 API, 208–213

+   示例, 173–176, 216–219

+   安全事件日志, 282–286

+   审计事件和事件 ID, 282

+   审计策略子类别, 284

+   配置

+   每用户审计策略, 285–286

+   系统审计策略, 282–285

+   显示类别 GUIDs, 284

+   设置策略并查看结果策略列表, 284–285

+   顶级审计策略类别, 283

+   安全标识符（SIDs）, 26–27, 81, 146–149

+   管理员用户, 124

+   别名, 166, 547–549

+   任意所有者, 184

+   断言身份, 489–490

+   分配令牌, 137

+   能力, 120–121

+   能力组, 121

+   组件, 146–147

+   创建令牌, 132–133

+   设备组, 113

+   枚举, 175–176

+   固定登录会话, 102

+   组, 145

+   完整性级别, 112

+   登录类型, 408–409, 414

+   低框令牌, 120–122

+   机器, 306

+   强制标签完整性级别, 172

+   手动解析二进制, 173–175

+   所有者, 145

+   进程信任级别, 231–232

+   虚拟令牌句柄, 109

+   查询管理员组 SID, 148

+   替换 *CREATOR OWNER* 和 *CREATOR GROUP* SIDs, 200

+   受限令牌, 117–118

+   SDDL SID 别名映射, 547–549

+   *SELF* SID, 249–250, 379–380

+   令牌组, 111–113

+   令牌, 101

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SecurityInformation</samp> 标志, 178, 205–206

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Dacl</samp>, 211

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Group</samp>, 157, 183

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Owner</samp>, 184

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ProtectedDacl</samp>, 210–211, 364

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ProtectedSacl</samp>, 210

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">UnprotectedDacl</samp>, 210–211

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">UnprotectedSacl</samp>, 210

+   安全包 (安全支持提供者), 400–401, 499–533

+   匿名会话, 518–519

+   认证审计事件日志, 524–527

+   凭据管理器, 514–517

+   CredSSP, 510–513

+   身份令牌, 519–520

+   协商, 401, 503–505

+   使用低盒令牌的网络认证, 520–523

+   远程凭据保护, 513

+   限制管理员模式, 513–514

+   安全通道, 506–510

+   安全缓冲区, 500–503

+   实际案例, 527–533

+   安全服务质量 (SQoS), 32, 104–107

+   上下文跟踪模式, 106

+   有效令牌模式, 106

+   模拟级别, 104–106

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SECURITY_QUALITY_OF_SERVICE</samp> 结构, 104, 107

+   安全参考监视器 (SRM), 24–27

+   访问检查, 25

+   进程, 221–263

+   使用案例, 265–280

+   访问令牌, 25

+   审计事件, 26

+   组件, 25

+   本地安全授权子系统, 26

+   前缀, 24

+   安全访问令牌, 99–141

+   安全审计, 281–295

+   安全描述符, 143–176

+   安全标识符, 26–27

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SECURITY_SQOS_PRESENT</samp> 标志, 107

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SECURITY_SUBJECT_CONTEXT</samp> 结构，222，272

+   安全支持提供者接口（SSPI），424，440，476，500，518

+   安全支持提供者。*请参阅* 安全包

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeDebugPrivilege</samp> 特权，116，123

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeDenyBatchLogonRight</samp> 账户权限，311，402

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeDenyInteractiveLogonRight</samp> 账户权限，311，402

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeDenyNetworkLogonRight</samp> 账户权限，311，402

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeDenyRemoteInteractive</samp> 账户权限，402

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeDenyRemoteInteractiveLogonRight</samp> 登录权限，311

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeDenyServiceLogonRight</samp> 账户权限，311，402

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeEnableDelegationPrivilege</samp> 特权，381

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeFastTraverseCheck</samp> 函数，268

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeImpersonatePrivilege</samp> 特权，116，123

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeInteractiveLogonRight</samp> 账户权限，311，402

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeIsTokenAssignableToProcess</samp> 函数，134

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Select-HiddenValue</samp> 函数，95–96

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Select-Object</samp> 命令，14–15，17

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Self</samp> 访问权限，366，378–379

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SelfRelative</samp> 控制标志，149–151

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeLoadDriverPrivilege</samp> 特权，116，123

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeMachineAccountPrivilege</samp> 特权，380

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Send-</samp> 函数，448–449

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeNetworkLogonRight</samp>账户权限，311，402

+   序列号，442

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeRelabelPrivilege</samp>特权，117，123，202，239

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeRemoteInteractiveLogonRight</samp>账户权限，311，402

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeRestorePrivilege</samp>特权，116，123，219

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ServerAdmin</samp>访问权限，319

+   服务器消息块（SMB），105，422，439–440，442

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ServerSecurity</samp>控制标志，213–214

+   服务控制管理器（SCM），92–93

+   用户服务。*参见* 受限委派

+   用户代理服务（即 S4U2proxy 或仅 Kerberos 委派），485–486，490

+   用户自我服务（即 S4U2self 或协议转换委派），486–488，490

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">服务</samp>登录类型，413–414

+   服务主体名称（SPN），443

+   认证

+   跨域，478

+   使用显式凭据，522

+   初始用户，460–462

+   PowerShell 中的 Kerberos 认证，466

+   到已知的网络代理，522

+   网络服务，463–464

+   U2U，491–493

+   绕过代理检查，523–524

+   解密 AP-REQ 消息，469–470

+   委派，482，484，486，488–490

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeSecurityPrivilege</samp>特权，116，127，287–288

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeServiceLogonRight</samp>账户权限，311，402

+   会话 0 隔离功能，76

+   会话管理子系统（SMSS），92

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Session</samp>对象，75

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeTakeOwnershipPrivilege</samp> 特权, 117, 123, 239

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetAuditRequirements</samp> 访问权限, 319

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeTcbPrivilege</samp> 特权, 116, 123

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Set-</samp> 命令, 44, 49–51, 56, 110, 135, 209–210, 286–288, 469, 486, 489, 539

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetDefaultQuotaLimits</samp> 访问权限, 319

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeTimeZonePrivilege</samp> 特权, 115–116

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetInformation</samp> 类, 30, 45

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetMiscPolicy</samp> 访问权限, 287

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeTrustedCredmanAccessPrivilege</samp> 特权, 516–517

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Set</samp> 系统调用, 42–45, 99

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetSystemPolicy</samp> 访问权限, 287

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetUserPolicy</samp> 访问权限, 287

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SetValue</samp> 访问权限, 322

+   SHA256 算法, 121–122

+   SHA384 算法, 508

+   碎片化攻击, 76

+   *SHELL32* 库, 89

+   Shell API, 89–91

+   Shell 动词, 91

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Show-</samp> 命令, 60, 100, 104, 131, 162

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ShowWindow</samp> 参数, 11–12

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Shutdown</samp> 访问权限, 313

+   同级令牌, 134–135

+   SID 别名, 166, 548–549

+   安全标识符（SIDs）。*参见* 安全标识符

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SignatureType</samp> 属性, 55

+   签名和封装

+   NTLM 中继攻击, 440–443

+   安全缓冲区, 502–503

+   银票，465

+   简单且受保护的协商机制（SPNEGO）协议，503–505

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SingleHost</samp> 标志，429

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SkipTokenGroups</samp> 标志，389

+   SMB（服务器消息块），105，422，439–440，442

+   SMSS（会话管理子系统），92

+   软件开发工具包（SDK），38，110，112

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Sort-Object</samp> 命令，18–19

+   分割令牌管理员，124，126，128–129，262

+   SPNEGO（简单且受保护的协商机制）协议，503–505

+   SPNs。*参见* 服务主体名称

+   SQoS。*参见* 安全质量服务

+   SRM。*参见* 安全参考监视器

+   SSL（安全套接字层）协议，506–507

+   SSPI（安全支持提供程序接口），424，440，476，500，518

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Start-</samp> 命令，88，276，325

+   静态方法，8

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Stream</samp> 缓冲区标志，500

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">StreamHeader</samp> 缓冲区标志，500，509

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">StreamTrailer</samp> 缓冲区标志，500，509

+   字符串

+   ANSI，79

+   字符转义，7–8

+   双引号，7

+   插值，7

+   安全，307

+   单引号，7

+   宽，79

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">string</samp> 类型，5

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Structural</samp> 类别属性，354

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SuccessfulAccess</samp> ACE 标志，156，168

+   上级，367–368

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SymbolicLink</samp> 对象，28–29

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SymbolicLinkTarget</samp> 属性，28–29

+   系统审计策略，282–285，287

+   系统调用

+   常见动词，30

+   状态码，34

+   Win32 API 和，77–80

+   系统进程，91–93

+   本地安全授权子系统，92

+   服务控制管理器，92–93

+   会话管理子系统，92

+   Windows 登录进程，92

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SystemProcessInformation</samp> 类，47

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">T</samp>

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">TargetInfo</samp> 标志，427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">TargetTypeDomain</samp> 标志，427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">TargetTypeServer</samp> 标志，427

+   任务调度服务，93

+   TCB（可信计算基础），116

+   TCP，446，532

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">TcpClient</samp> 对象，452

+   TCP/IP，47，342

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">TcpListener</samp> 类，451

+   终端服务，77

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Test-AccessFilter</samp> 检查，231

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Test-</samp> 命令，115–116，138，189–190，240–241，243，259，430，441–442

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Test-</samp> 函数，230，393

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Test-MandatoryIntegrityLevel</samp> 检查，231

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Test-ProcessTrustLevel</samp> 检查，231

+   TGS-REP 消息。*参见* 票证授予服务回复消息

+   TGS-REQ 消息。*参见* 票证授予服务请求消息

+   TGSs。*参见* 票证授予服务器

+   TGT-REP（票证授予票证回复）消息，491–493

+   TGT-REQ（票证授予票证请求）消息，491–492

+   TGTs。*参见* 票证授予票证

+   线程亲和性，73

+   线程 ID (TIDs)，47–48

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Thread</samp> 对象，27，48，203

+   票证授予服务器（TGSs）

+   跨域身份验证，478–479

+   解密 AP-REQ 消息，469

+   委托, 479–482, 485  

+   初始用户身份验证, 459–461  

+   PowerShell 中的 Kerberos 身份验证, 466  

+   网络服务身份验证, 464  

+   票据授予服务回复（TGS-REP）消息  

+   初始用户身份验证, 458, 461–462  

+   PowerShell 中的 Kerberos 身份验证, 466  

+   网络服务身份验证, 464  

+   票据授予服务请求（TGS-REQ）消息  

+   委托, 479, 481, 485  

+   初始用户身份验证, 458  

+   PowerShell 中的 Kerberos 身份验证, 466  

+   网络服务身份验证, 463–464  

+   U2U 身份验证, 492  

+   票据授予票据回复（TGT-REP）消息, 491–493  

+   票据授予票据请求（TGT-REQ）消息, 491–492  

+   票据授予票据（TGTs）  

+   委托, 479–485  

+   初始用户身份验证, 459–461  

+   网络服务身份验证, 463–464  

+   U2U 身份验证, 491–493  

+   线程 ID（TIDs），47–48  

+   TLS 协议。*参见* 传输层安全协议  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ToCharArray</samp> 方法, 8  

+   令牌访问检查, 227–228, 230, 237–241  

+   所有者检查, 240–241  

+   权限检查, 238–239  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Token</samp> 缓冲区标志, 500–502  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">TokenLinkedToken</samp> 类, 126, 128  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Token</samp> 对象  

+   创建, 407–410  

+   使用创建新进程, 412–413

+   请求已认证用户, 430  

+   Token Viewer 应用程序, 100–101, 103  

+   传输层安全（TLS）协议  

+   通道绑定, 444–445  

+   CredSSP, 511–512  

+   提取证书, 530–533  

+   安全通道, 506–510  

+   遍历检查, 266–269  

+   限制性检查, 267–269  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">SeChangeNotifyPrivilege</samp> 权限, 267  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Traverse</samp> 访问权限, 266–269  

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">受信管理员</samp> 访问权限，319

+   受信计算基础（TCB），116

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">受信委托</samp> 控制标志，381，482

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">受信用于委托认证</samp> 控制标志，381

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">受信授权委托</samp> 标志，487–489

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">受信保护</samp> ACE 标志，156，168

+   信任关系，303–304，322，477–479

+   TS 服务安全包（TSSSP），511–512

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">类型</samp> 对象，27

+   类型，5，8

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">U</samp>

+   U2U（用户对用户）认证，491–493

+   UAC。*参见* 用户帐户控制

+   UIPI（用户界面特权隔离），76，129

+   UMFD（用户模式字体驱动程序）进程，92，405

+   不受限制的委托，480–484

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Unicode</samp> NTLM 标志，427

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">UNICODE_STRING</samp> 结构，31，85–86

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">通用</samp> 组范围，347，354

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">未保护</samp> 命令，441，446，471，476

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">未保护的 DACL</samp> 安全信息标志，210–211

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">未保护的 SACL</samp> 安全信息标志，210

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">未保护</samp> 函数，328–331

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">更新</samp> 命令，4–5，427–428

+   UPNs（用户主体名称），345

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">仅用于拒绝</samp> 属性，111–112

+   *USER32* 库，70–71

+   用户帐户控制（UAC），93，124–126，409

+   提升类型，126–129

+   执行级别，126

+   过滤，416

+   关联令牌，126–129

+   查询可执行清单信息，125

+   UI 访问，129，138–139

+   虚拟化，129–130

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">User-Account-Restrictions</samp> 属性集，374–375

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">User-Change-Password</samp> 访问权限，377–378

+   用户委派权限，381

+   用户桌面创建，398–399

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">User-Force-Change-Password</samp> 访问权限，377–378

+   用户界面特权隔离（UIPI），76，129

+   用户模式访问检查，225

+   用户模式应用程序，64–96

+   DOS 设备路径，83–87

+   进程创建，87–91

+   系统进程，91–93

+   Win32

+   API，64–70，77–80

+   GUI，70–77

+   注册表路径，80–82

+   示例，94–96

+   用户模式字体驱动程序（UMFD）进程，92，405

+   用户主体名称（UPNs），345

+   用户对用户（U2U）身份验证，491–493

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">V</samp>

+   变量

+   枚举所有，7

+   预定义，6–7

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">$VerbosePreference</samp> 全局变量，454

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">View</samp> 访问权限，320

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ViewAuditInformation</samp> 访问权限，319

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">ViewLocalInformation</samp> 访问权限，319–320

+   VirtualBox，537

+   虚拟化，129–130，484

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">VirtualizationEnabled</samp> 属性，130

+   Visual Studio，261，538

+   VMS，292

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">W</samp>

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WarningAction</samp> 参数，276

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WebClient</samp> 类，522

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Where-Object</samp> 命令，17–19

+   宽字符串，79

+   通配符语法，10–11，15

+   Win32

+   API，64–70

+   加载新库，65–66

+   搜索 DLL，68–70

+   安全 API，208–213

+   系统调用和，77–80

+   查看导入的 API，66–67

+   GUI，70–77

+   控制台会话，74–77

+   内核资源，71–73

+   模块，70

+   窗口消息，73–74

+   注册表路径，80–82

+   句柄，80–81

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">HKEY_CLASSES_ROOT</samp> 句柄，90

+   列出注册表内容，81–82

+   打开密钥，81

+   *WIN32K* 驱动程序，70–71

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Win32Path</samp> 参数，81

+   *WIN32U* 库，70–71

+   窗口

+   类，73

+   消息，73–74

+   对象，71–73

+   Windows 认证，299–340

+   Active Directory，341–396

+   域认证，300–304

+   交互式认证，397–419

+   本地域配置，305–311

+   网络认证，299，421–455

+   远程 LSA 服务，311–324

+   SAM 数据库，324–334

+   SECURITY 数据库，334–336

+   示例，336–339

+   Windows 域网络，535–545

+   配置，536

+   虚拟机，538–545

+   Windows Hyper-V，47，537–538

+   Windows 安装程序服务，93

+   Windows 内核，23–61

+   子系统和组件，24–56

+   用户模式应用程序，64–96

+   示例，56–61

+   Windows 操作系统，xxviii

+   PowerShell 测试环境设置，3–21

+   用户模式应用程序，64–96

+   Windows 内核，23–56

+   Windows 子系统 for Linux，64

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WindowStation</samp> 对象，71–72

+   Windows 更新服务，4，93

+   Winlogon 进程，75，398–399，408

+   WinRM 协议，513

+   WinSock API，47

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WM_CLOSE</samp> 消息，73

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WM_GETTEXT</samp> 消息，74

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WM_TIMER</samp> 消息，76

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">World</samp> 安全权限，219

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WParam</samp> 参数，74

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WriteAccount</samp> 访问权限，316，318

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Write-</samp> 命令，16，49–50，59，291，448，454

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WriteDac</samp> 访问权限，36，205–206，233，235，365

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WriteGroupInformation</samp> 访问权限，316

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WriteOtherParameters</samp> 访问权限，315

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WriteOwner</samp> 访问权限，37，117，205–206，239

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WritePasswordParams</samp> 访问权限，314

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WritePreferences</samp> 访问权限，316

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">WriteProp</samp> 访问权限，366，370，372，375，378

+   写受限的令牌，119

+   写验证的访问权限，378–379

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">X</samp>

+   X.509 证书，342，507

+   XML，20，528–529

## <samp class="SANS_Futura_Std_Bold_Condensed_B_11">Z</samp>

+   Zerologon (CVE-2020-1472) 安全问题，403

+   <samp class="SANS_TheSansMonoCd_W5Regular_11">Zw</samp> （<samp class="SANS_TheSansMonoCd_W5Regular_11">Nt</samp>）前缀，24，29–30，224
