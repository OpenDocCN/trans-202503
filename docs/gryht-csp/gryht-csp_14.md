# 第十五章

索引

A

> > > > 抽象类
> > > > 
> > > > 抽象 Task 类, 160–161
> > > > 
> > > > 已定义, 4
> > > > 
> > > > 从...子类化, 5–6
> > > > 
> > > > 抽象语法树（AST）, 243
> > > > 
> > > > 匿名方法
> > > > 
> > > > 将委托分配给方法, 9
> > > > 
> > > > 可选参数, 10–11
> > > > 
> > > > 更新 Firefighter 类, 9–10
> > > > 
> > > > 更新 Main() 方法, 11–12
> > > > 
> > > > API（应用程序接口）
> > > > 
> > > > Arachni REST API, 224–228
> > > > 
> > > > Cuckoo 沙箱, 148–150
> > > > 
> > > > Nessus, 103–105
> > > > 
> > > > Nexpose
> > > > 
> > > > NexposeManager 类, 124–125
> > > > 
> > > > NexposeSession 类, 118–124
> > > > 
> > > > RPC API, 208–209
> > > > 
> > > > sqlmap REST API, 169–173
> > > > 
> > > > Arachni, 223
> > > > 
> > > > arachni_rpcd 脚本, 229
> > > > 
> > > > arachni_rpc 脚本, 229
> > > > 
> > > > 安装, 223–224
> > > > 
> > > > Main() 方法, 237–239
> > > > 
> > > > REST API, 224–228
> > > > 
> > > > ArachniHTTPManager 类, 226–228
> > > > 
> > > > ArachniHTTPSession 类, 225–226, 228
> > > > 
> > > > RPC, 228–237
> > > > 
> > > > ArachniRPCManager 类, 236–237
> > > > 
> > > > ArachniRPCSession 类, 230–234
> > > > 
> > > > ExecuteCommand() 方法, 234–235
> > > > 
> > > > ArachniHTTPManager 类, 226–228
> > > > 
> > > > ArachniHTTPSession 类, 225–226, 228
> > > > 
> > > > ArachniRPCManager 类, 236–237
> > > > 
> > > > ArachniRPCSession 类, 230–234
> > > > 
> > > > 资产（Nexpose）, 118, 126–127
> > > > 
> > > > AST（抽象语法树）, 243
> > > > 
> > > > 已定义的属性, 13
> > > > 
> > > > Authenticate() 方法
> > > > 
> > > > MetasploitSession 类, 213
> > > > 
> > > > NessusSession 类, 105–106
> > > > 
> > > > NexposeSession 类, 119–120
> > > > 
> > > > 身份验证
> > > > 
> > > > Metasploit RPC API, 208, 213–214
> > > > 
> > > > NessusSession 类, 105–109
> > > > 
> > > > NexposeManager 类, 124–125
> > > > 
> > > > NexposeSession 类, 118–120
> > > > 
> > > > OpenVASSession 类，135–136

B

> > > > BadStore ISO
> > > > 
> > > > 从启动 VM，17–18
> > > > 
> > > > 模糊化 POST 请求，25–31
> > > > 
> > > > 参数，29–31
> > > > 
> > > > 写入请求，27–29
> > > > 
> > > > sqlmap 工具和，182，184–185
> > > > 
> > > > 绑定有效负载，85–86
> > > > 
> > > > 接受数据，86
> > > > 
> > > > 从流中执行命令，87–88
> > > > 
> > > > 返回输出，87
> > > > 
> > > > 运行命令，87
> > > > 
> > > > 位掩码，194
> > > > 
> > > > bkhive 工具，263–264
> > > > 
> > > > 闲置 SQL 注入，43–44
> > > > 
> > > > 创建真/假响应，44
> > > > 
> > > > GetValue() 方法，49–50
> > > > 
> > > > MakeRequest() 方法，47
> > > > 
> > > > 打印值，50–51
> > > > 
> > > > 获取值的长度，47–49
> > > > 
> > > > 基于布尔值的盲 SQL 注入。参见 闲置 SQL 注入
> > > > 
> > > > 启动键，转储
> > > > 
> > > > GetBootKey() 方法，259–261，262–263
> > > > 
> > > > GetNodeKey() 方法，261–262
> > > > 
> > > > GetValueKey() 方法，261
> > > > 
> > > > StringToByteArray() 方法，262
> > > > 
> > > > 验证启动键，263–264
> > > > 
> > > > Burp Suite，25–27

C

> > > > C# 语言
> > > > 
> > > > 匿名方法，9–12
> > > > 
> > > > 将委托分配给方法，9
> > > > 
> > > > 可选参数，10–11
> > > > 
> > > > 更新 Firefighter 类，9–10
> > > > 
> > > > 更新 Main() 方法，11–12
> > > > 
> > > > 类，4，6–7
> > > > 
> > > > 接口，4–7
> > > > 
> > > > Main() 方法，7–9
> > > > 
> > > > 本地库，12–13
> > > > 
> > > > 类型和语法，2–3
> > > > 
> > > > 子节点
> > > > 
> > > > 注册表 Hive，250，254–257
> > > > 
> > > > SOAP，58–67
> > > > 
> > > > CIL（通用中间语言）字节码，245
> > > > 
> > > > cl_scanfile() 函数（ClamEngine 类），198–200
> > > > 
> > > > ClamAV，191
> > > > 
> > > > clamd 守护进程，201–206
> > > > 
> > > > ClamdManager 类，204–205
> > > > 
> > > > ClamdSession 类，203–204
> > > > 
> > > > 安装，202
> > > > 
> > > > 启动，202–203
> > > > 
> > > > 测试，205–206
> > > > 
> > > > 安装，192–193
> > > > 
> > > > 本地库，193–201
> > > > 
> > > > 访问函数，196–200
> > > > 
> > > > ClamEngine 类，197–198
> > > > 
> > > > 类，195
> > > > 
> > > > Dispose() 方法，198–200
> > > > 
> > > > 枚举，194–195
> > > > 
> > > > 扫描文件，198–200
> > > > 
> > > > 测试，200–201
> > > > 
> > > > ClamBindings 类，196
> > > > 
> > > > ClamDatabaseOptions 枚举，194
> > > > 
> > > > clamd 守护进程，201–202
> > > > 
> > > > ClamdManager 类，204–205
> > > > 
> > > > ClamdSession 类，203–204
> > > > 
> > > > 安装，202
> > > > 
> > > > 启动，202–203
> > > > 
> > > > 测试，205–206
> > > > 
> > > > ClamdManager 类（clamd 守护进程），204–205
> > > > 
> > > > ClamdSession 类（clamd 守护进程），203–204
> > > > 
> > > > ClamEngine 类，197–198
> > > > 
> > > > ClamReturnCode 枚举，195
> > > > 
> > > > ClamScanOptions 枚举，195
> > > > 
> > > > 类，6–7
> > > > 
> > > > 摘要，4，5–6，160–161
> > > > 
> > > > ClamAV 本地库，195
> > > > 
> > > > 定义，4
> > > > 
> > > > 通用中间语言（CIL）字节码，245
> > > > 
> > > > CONCAT() SQL 函数，39–40
> > > > 
> > > > 反向连接有效载荷
> > > > 
> > > > 网络流，82–84
> > > > 
> > > > 运行，84–85
> > > > 
> > > > 运行命令，84–85
> > > > 
> > > > 构造函数，6
> > > > 
> > > > CreateOrUpdateSite() 方法（NexposeManager 类），126–127
> > > > 
> > > > CreateSimpleTarget() 方法（OpenVASManager 类），141–142
> > > > 
> > > > CreateSimpleTask() 方法（OpenVASManager 类），143
> > > > 
> > > > CreateTask() 方法（CuckooManager 类），157–158
> > > > 
> > > > 跨站脚本攻击（XSS），20–22
> > > > 
> > > > CsharpVulnJson Web 应用捕获易受攻击的 JSON 请求，31–33
> > > > 
> > > > JSON 模糊测试器
> > > > 
> > > > 创建，33–37
> > > > 
> > > > 测试，37–38
> > > > 
> > > > 设置易受攻击的设备，31
> > > > 
> > > > CsharpVulnSoap 网络应用，54，78–79。另见 SOAP 端点 Cuckoo Sandbox，147
> > > > 
> > > > 创建文件分析任务，163–164
> > > > 
> > > > CuckooManager 类，157–162
> > > > 
> > > > 抽象 Task 类，160–161
> > > > 
> > > > CreateTask() 方法，157–158
> > > > 
> > > > 报告方法，159–160
> > > > 
> > > > 排序并创建不同的类类型，161–162
> > > > 
> > > > 任务详情，159
> > > > 
> > > > CuckooSession 类，151–157
> > > > 
> > > > 使用 GetMultipartFormData() 方法创建多部分 HTTP 数据，153–155
> > > > 
> > > > FileParameter 类，155
> > > > 
> > > > 测试，156–157
> > > > 
> > > > 编写 ExecuteCommand() 方法以处理 HTTP 请求，151–153
> > > > 
> > > > 手动运行 API，148–150
> > > > 
> > > > 设置，148
> > > > 
> > > > 测试应用，164–165
> > > > 
> > > > curl 命令行工具
> > > > 
> > > > 测试 Arachni REST API，225
> > > > 
> > > > 测试 Cuckoo 状态，149–150
> > > > 
> > > > 测试 Nexpose API，118
> > > > 
> > > > 测试 sqlmap API，170–173

D

> > > > DateTime 类，3
> > > > 
> > > > 反编译器，242–245
> > > > 
> > > > DecompressData() 方法（ArachniRPCSession 类），233
> > > > 
> > > > 委托，分配给方法，9
> > > > 
> > > > DeleteSite() 方法（NexposeManager 类），128
> > > > 
> > > > DeleteTask() 方法（SqlmapManager 类），178–179
> > > > 
> > > > 反序列化，175
> > > > 
> > > > 调度器（RPC 框架），230
> > > > 
> > > > Dispose() 方法
> > > > 
> > > > ArachniRPCSession 类，234
> > > > 
> > > > ClamAV 本地库，198–200
> > > > 
> > > > ClamEngine 类，200
> > > > 
> > > > CuckooManager 类，160
> > > > 
> > > > MetasploitSession 类，216
> > > > 
> > > > NessusSession 类，107–108
> > > > 
> > > > NexposeSession 类，123
> > > > 
> > > > SqlmapManager 类，178
> > > > 
> > > > SqlmapSession 类，174
> > > > 
> > > > 转储引导密钥
> > > > 
> > > > GetBootKey() 方法，259–261，262–263
> > > > 
> > > > GetNodeKey() 方法， 261–262
> > > > 
> > > > GetValueKey() 方法， 261
> > > > 
> > > > StringToByteArray() 方法， 262
> > > > 
> > > > 验证启动密钥， 263–264

E

> > > > EICAR 文件， 200–201
> > > > 
> > > > 端点
> > > > 
> > > > SOAP。参见 SOAP 端点
> > > > 
> > > > sqlmap API， 167
> > > > 
> > > > 枚举（ClamAV）， 194–195
> > > > 
> > > > ExecuteCommand() 方法
> > > > 
> > > > ArachniRPCSession 类， 234–235
> > > > 
> > > > CuckooSession 类， 151–153
> > > > 
> > > > NexposeSession 类， 120–123
> > > > 
> > > > OpenVASSession 类， 136–137
> > > > 
> > > > ExecuteGet() 方法（SqlmapSession 类）， 174–175
> > > > 
> > > > Execute() 方法
> > > > 
> > > > ClamdSession 类， 203–204
> > > > 
> > > > MetasploitSession 类， 213–215
> > > > 
> > > > MSGPACK 库， 210
> > > > 
> > > > ExecuteModule() 方法（MetasploitManager 类）， 219
> > > > 
> > > > ExecutePost() 方法（SqlmapSession 类）， 175
> > > > 
> > > > ExecuteRequest() 方法（ArachniHTTPSession 类）， 226
> > > > 
> > > > 利用 SQL 注入
> > > > 
> > > > 基于布尔值的盲注 SQL 注入， 43–51
> > > > 
> > > > 基于 UNION 的， 38–43

F

> > > > FileParameter 类（CuckooSession 类）， 155
> > > > 
> > > > FileTask 类（Cuckoo Sandbox）， 161–162
> > > > 
> > > > First() 方法（反向连接有效负载）， 84
> > > > 
> > > > for 循环
> > > > 
> > > > 子节点和， 256–257
> > > > 
> > > > 方法和， 50–51
> > > > 
> > > > 获取用户数据库的数据库计数长度， 45–46
> > > > 
> > > > 发送有效负载到， 47
> > > > 
> > > > 函数
> > > > 
> > > > ClamAV 原生库， 196–200
> > > > 
> > > > 声明， 13
> > > > 
> > > > 从 libc 导入， 98–99
> > > > 
> > > > SQL， 39–40， 46
> > > > 
> > > > 模糊测试工具， 15–16。另见跨站脚本攻击模糊测试， 20–22
> > > > 
> > > > SOAP， 185–190
> > > > 
> > > > FuzzHttpGetPort() 方法
> > > > 
> > > > 模糊测试 SOAP 服务， 70–72
> > > > 
> > > > sqlmap 工具， 189
> > > > 
> > > > FuzzHttpPort() 方法（模糊测试 SOAP 服务）， 69
> > > > 
> > > > FuzzHttpPostPort() 方法
> > > > 
> > > > 模糊测试 SOAP 服务， 72–75
> > > > 
> > > > sqlmap 工具， 189–190
> > > > 
> > > > 模糊测试
> > > > 
> > > > 定义， 16
> > > > 
> > > > 使用突变模糊测试工具的 GET 请求，22–25
> > > > 
> > > > JSON，31–38
> > > > 
> > > > 捕获易受攻击的 JSON 请求，31–33
> > > > 
> > > > HTTP 请求，33–34，35–37
> > > > 
> > > > 遍历键/值对，34–35
> > > > 
> > > > 设置易受攻击的设备，31
> > > > 
> > > > 测试，37–38
> > > > 
> > > > POST 请求，25–31
> > > > 
> > > > 参数，29–31
> > > > 
> > > > 编写请求，27–29
> > > > 
> > > > 用于 SQL 注入漏洞的 SOAP 端点，68–79
> > > > 
> > > > HTTP POST SOAP 端口，72–75
> > > > 
> > > > 单独的 SOAP 服务，69–72
> > > > 
> > > > 运行模糊测试工具，78–79
> > > > 
> > > > SOAP XML 端口，75–78
> > > > 
> > > > SQL 注入，19–20，38–51
> > > > 
> > > > 虚拟机，16–18
> > > > 
> > > > 添加仅主机虚拟网络，16
> > > > 
> > > > 从 BadStore ISO 启动，17–18
> > > > 
> > > > 创建，17
> > > > 
> > > > FuzzService() 方法（SOAP 服务），69
> > > > 
> > > > FuzzSoapPort() 方法
> > > > 
> > > > 测试 SOAP 服务，75–78
> > > > 
> > > > sqlmap 工具，188–189

G

> > > > get_version 命令（OpenVASSession 类），139
> > > > 
> > > > GetBootKey() 方法，259–261，262–263
> > > > 
> > > > GetLength() 方法（盲注 SQL 注入），47–49
> > > > 
> > > > GetLog() 方法（SqlmapLogItem 类），183–184
> > > > 
> > > > GetMultipartFormData() 方法（CuckooSession 类），153–155
> > > > 
> > > > GetNodeKey() 方法，261–262
> > > > 
> > > > GetObject() 方法（MetasploitSession 类），216
> > > > 
> > > > GetOptions() 方法（SqlmapManager 类），179
> > > > 
> > > > GetPdfSiteReport() 方法（NexposeManager 类），128
> > > > 
> > > > GetProgress() 方法（ArachniRPCManager 类），237
> > > > 
> > > > GET 请求
> > > > 
> > > > 将 sqlmap GET 请求支持添加到 SOAP 模糊测试工具，185–187
> > > > 
> > > > 使用突变模糊测试工具进行模糊测试，22–25
> > > > 
> > > > sqlmap REST API，169–170
> > > > 
> > > > 使用 WebRequest 方法执行，174–175
> > > > 
> > > > GetScanConfigurations() 方法（OpenVASManager 类），141–142
> > > > 
> > > > GetScanStatus() 方法
> > > > 
> > > > ArachniHTTPManager 类，227–228
> > > > 
> > > > NexposeManager 类，127
> > > > 
> > > > SqlmapStatus 类，181–182
> > > > 
> > > > GetStream() 方法
> > > > 
> > > > ArachniRPCSession 类，233
> > > > 
> > > > OpenVASSession 类，138
> > > > 
> > > > GetTaskDetails() 方法（CuckooManager 类），159，163
> > > > 
> > > > GetTaskReport() 方法（CuckooManager 类），159，163
> > > > 
> > > > GetTaskResults() 方法（OpenVASManager 类），143–144
> > > > 
> > > > GetTasks() 方法（OpenVASManager 类），143–144
> > > > 
> > > > GetValueKey() 方法，261
> > > > 
> > > > GetValue() 方法（盲注 SQL 注入），49–50
> > > > 
> > > > GetVersion() 方法（ClamdManager 类），205
> > > > 
> > > > 全局唯一 ID（Guid），110

H

> > > > Hello World 示例，2–3
> > > > 
> > > > 主机专用虚拟网络，添加到虚拟机，16
> > > > 
> > > > HTTP 请求
> > > > 
> > > > 构建，23–24
> > > > 
> > > > DELETE，167
> > > > 
> > > > GET 请求
> > > > 
> > > > 向 SOAP fuzzer 添加 sqlmap GET 请求支持，185–187
> > > > 
> > > > 使用突变模糊测试进行模糊测试，22–25
> > > > 
> > > > sqlmap REST API，169–170
> > > > 
> > > > 使用 WebRequest 方法执行，174–175
> > > > 
> > > > JSON
> > > > 
> > > > 捕获漏洞，31–33
> > > > 
> > > > Fuzz() 方法，35–37
> > > > 
> > > > 读取，33–34
> > > > 
> > > > NessusSession 类，106–107
> > > > 
> > > > NexposeSession 类，120–121
> > > > 
> > > > POST
> > > > 
> > > > 模糊测试，25–31，72–75
> > > > 
> > > > 集成 sqlmap 工具，187–188
> > > > 
> > > > 参数，28
> > > > 
> > > > sqlmap API，167，170–172
> > > > 
> > > > PUT，167
> > > > 
> > > > REST APIs 和，104
> > > > 
> > > > 编写 ExecuteCommand() 方法来处理，151–153
> > > > 
> > > > HTTP 响应（NexposeSession 类），121–123
> > > > 
> > > > HttpWebRequest 类，24，36，42

I

> > > > 集成开发环境（IDEs），1–2，210
> > > > 
> > > > IL（中间语言），246
> > > > 
> > > > ILSpy 反编译器，242
> > > > 
> > > > 实例
> > > > 
> > > > 已定义，4
> > > > 
> > > > RPC 框架，230
> > > > 
> > > > 实例化对象，24
> > > > 
> > > > 集成开发环境（IDEs），1–2，210
> > > > 
> > > > 接口，已定义，4–7
> > > > 
> > > > 中间语言（IL），246
> > > > 
> > > > int.Parse() 方法，83，176
> > > > 
> > > > IsBusy() 方法（ArachniRPCManager 类），237

J

> > > > JavaScript 对象表示法。参见 JSON
> > > > 
> > > > Join() 方法（回连负载），84
> > > > 
> > > > JSON（JavaScript 对象表示法）。参见 sqlmap 工具
> > > > 
> > > > 模糊测试
> > > > 
> > > > 捕获易受攻击的 JSON 请求，31–33
> > > > 
> > > > HTTP 请求，33–34，35–37
> > > > 
> > > > 遍历键/值对，34–35
> > > > 
> > > > 设置易受攻击的设备，31
> > > > 
> > > > 测试，37–38
> > > > 
> > > > Json.NET 库，34，51
> > > > 
> > > > JsonConvert 类，181
> > > > 
> > > > SqlmapManager 类，177–179
> > > > 
> > > > SqlmapSession 类，176–177

K

> > > > kernel32.dll 库，96–98

L

> > > > 语言集成查询。参见 LINQ
> > > > 
> > > > Level 属性（SqlmapLogItem 类），182–183
> > > > 
> > > > 库
> > > > 
> > > > ClamAV，193–201
> > > > 
> > > > 访问函数，196–197
> > > > 
> > > > ClamEngine 类，197–198
> > > > 
> > > > 类，195
> > > > 
> > > > Dispose() 方法，198–200
> > > > 
> > > > 枚举，194–195
> > > > 
> > > > 扫描文件，198–200
> > > > 
> > > > 测试，200–201
> > > > 
> > > > Json.NET，34，51
> > > > 
> > > > JsonConvert 类，181
> > > > 
> > > > SqlmapManager 类，177–179
> > > > 
> > > > SqlmapSession 类，176–177
> > > > 
> > > > MSGPACK，209–210
> > > > 
> > > > 安装，211
> > > > 
> > > > NuGet 包管理器，210
> > > > 
> > > > 引用，211–212
> > > > 
> > > > 面向对象关系映射（ORM），20，242–244
> > > > 
> > > > LINQ（语言集成查询）
> > > > 
> > > > Descendants() 方法，145
> > > > 
> > > > LINQ to XML 类，76
> > > > 
> > > > 有效载荷与，87
> > > > 
> > > > Single() 方法，69，70
> > > > 
> > > > StringToByteArray() 方法，262
> > > > 
> > > > System.Linq 命名空间，84
> > > > 
> > > > Linux
> > > > 
> > > > BadStore ISO，16，17–18，25–31
> > > > 
> > > > ClamAV 库，193–201
> > > > 
> > > > 执行原生 Linux 有效载荷，98–102
> > > > 
> > > > 生成 Metasploit 有效载荷，96
> > > > 
> > > > 安装 ClamAV，192
> > > > 
> > > > printf() 函数，13
> > > > 
> > > > LogOut() 方法
> > > > 
> > > > NessusSession 类，107–108
> > > > 
> > > > NexposeSession 类，121–123
> > > > 
> > > > long.Parse() 方法，176

M

> > > > Main() 方法，7–9
> > > > 
> > > > Arachni，237–239
> > > > 
> > > > ClamdManager 类，205
> > > > 
> > > > Cuckoo 沙箱，156，163
> > > > 
> > > > Metasploit，219–220
> > > > 
> > > > 注册表配置单元，259，263
> > > > 
> > > > SOAP 端点模糊测试，68
> > > > 
> > > > SqlmapManager 类，182
> > > > 
> > > > 测试 GetBootKey() 方法，263
> > > > 
> > > > MakeRequest() 方法
> > > > 
> > > > Blind SQL 注入，47
> > > > 
> > > > NessusSession 类，106–107
> > > > 
> > > > 管理程序集，241
> > > > 
> > > > ILSpy，242
> > > > 
> > > > monodis 程序，245–247
> > > > 
> > > > NuGet 包，242–244
> > > > 
> > > > 测试反编译器，244–245
> > > > 
> > > > 管理代码，96
> > > > 
> > > > Marshal.Copy() 方法（有效载荷），101–102
> > > > 
> > > > Marshal.GetDelegateForFunctionPointer() 方法（有效载荷），101–102
> > > > 
> > > > MessageBox() 函数（Windows），13
> > > > 
> > > > MessagePackToDictionary() 方法（MetasploitSession 类），215
> > > > 
> > > > Message 属性（SqlmapLogItem 类），182
> > > > 
> > > > Metasploit，207
> > > > 
> > > > 与 Shell 交互，221–222
> > > > 
> > > > MSGPACK 库，209–212
> > > > 
> > > > 安装，211
> > > > 
> > > > NuGet 包管理器，210
> > > > 
> > > > 引用，211–212
> > > > 
> > > > 有效负载
> > > > 
> > > > 执行本地 Linux 有效负载，98–102
> > > > 
> > > > 生成，96
> > > > 
> > > > 设置，94–96
> > > > 
> > > > 非托管代码，96–98
> > > > 
> > > > RPC API，208–209
> > > > 
> > > > 运行漏洞利用，220–221
> > > > 
> > > > Metasploitable 2，209
> > > > 
> > > > MetasploitManager 类，217–219
> > > > 
> > > > MetasploitSession 类，212–213
> > > > 
> > > > Execute() 方法，213–215
> > > > 
> > > > 测试，217
> > > > 
> > > > 转换响应数据，215–217
> > > > 
> > > > 方法重载，151–152
> > > > 
> > > > 方法
> > > > 
> > > > 将委托分配给，9
> > > > 
> > > > 定义，4
> > > > 
> > > > MID() SQL 函数，46
> > > > 
> > > > MonoDevelop
> > > > 
> > > > 安装，2
> > > > 
> > > > 安装 MSGPACK 库，210–212
> > > > 
> > > > monodis 程序，245–247
> > > > 
> > > > Mono 框架。请参阅托管程序集
> > > > 
> > > > msfvenom 工具（Metasploit），96，103
> > > > 
> > > > MSGPACK 库，209–210
> > > > 
> > > > 安装，211
> > > > 
> > > > NuGet 包管理器，210
> > > > 
> > > > 引用，211–212
> > > > 
> > > > 变异模糊测试器
> > > > 
> > > > 定义，15
> > > > 
> > > > 使用模糊测试 GET 请求，22–25

N

> > > > Name 属性（SoapMessage 类），59，61
> > > > 
> > > > 命名空间
> > > > 
> > > > 定义，3
> > > > 
> > > > SOAP XML，76
> > > > 
> > > > System.Linq 命名空间，84
> > > > 
> > > > XML，56–57
> > > > 
> > > > 本地库，12–13。另见本地 x86 汇编库，241。另见托管程序集 Nessus，103–104
> > > > 
> > > > NessusManager 类，109–110
> > > > 
> > > > NessusSession 类，105–109
> > > > 
> > > > HTTP 请求，106–107
> > > > 
> > > > 登出，107–108
> > > > 
> > > > 测试，108–109
> > > > 
> > > > 执行扫描，110–113
> > > > 
> > > > REST 架构，104–105
> > > > 
> > > > .NET 库。请参阅托管程序集
> > > > 
> > > > 网络流
> > > > 
> > > > 绑定有效负载，85–88
> > > > 
> > > > 反向连接有效负载，82–84
> > > > 
> > > > NewTask() 方法（SqlmapManager 类）, 178–179
> > > > 
> > > > Nexpose, 115
> > > > 
> > > > 自动化漏洞扫描, 126–127, 130
> > > > 
> > > > 安装, 116–118
> > > > 
> > > > NexposeManager 类, 124–125
> > > > 
> > > > NexposeSession 类, 118–124
> > > > 
> > > > 身份验证 API, 124
> > > > 
> > > > Dispose() 方法, 123
> > > > 
> > > > ExecuteCommand() 方法, 120–123
> > > > 
> > > > 查找 API 版本, 123–124
> > > > 
> > > > Logout() 方法, 121–123
> > > > 
> > > > PDF 站点报告, 128, 130
> > > > 
> > > > 执行扫描, 129
> > > > 
> > > > NodeKey 类（注册表蜂巢）, 250, 253–257

O

> > > > 面向对象语言, 3
> > > > 
> > > > 对象关系映射（ORM）库, 20, 242–244
> > > > 
> > > > 对象，已定义, 4
> > > > 
> > > > OMP（OpenVAS 管理协议）, 133
> > > > 
> > > > OpenVAS, 133
> > > > 
> > > > 安装, 134
> > > > 
> > > > OpenVASManager 类, 140–145
> > > > 
> > > > 自动化, 144–145
> > > > 
> > > > CreateSimpleTarget() 方法, 141–142
> > > > 
> > > > CreateSimpleTask() 方法, 143
> > > > 
> > > > GetScanConfigurations() 方法, 141–142
> > > > 
> > > > GetTaskResults() 方法, 143–144
> > > > 
> > > > GetTasks() 方法, 143–144
> > > > 
> > > > StartTask() 方法, 143
> > > > 
> > > > OpenVASSession 类, 134–139
> > > > 
> > > > 身份验证, 135–136
> > > > 
> > > > ExecuteCommand() 方法, 136–137
> > > > 
> > > > get_version 命令, 139
> > > > 
> > > > GetStream() 方法, 138
> > > > 
> > > > ReadMessage() 方法, 137–138
> > > > 
> > > > SSL 证书验证, 138–139
> > > > 
> > > > OpenVAS 管理协议（OMP）, 133
> > > > 
> > > > 可选参数, 10–11
> > > > 
> > > > ORD() SQL 函数, 46
> > > > 
> > > > ORM（对象关系映射）库, 20, 242–244
> > > > 
> > > > OS X
> > > > 
> > > > ClamAV 库, 192, 196
> > > > 
> > > > .NET 反编译器， 242
> > > > 
> > > > Xamarin Studio， 2

P

> > > > Packer 类（Metasploit）， 214
> > > > 
> > > > 参数，模糊测试， 29–31
> > > > 
> > > > 参数属性（SoapMessage 类）， 59
> > > > 
> > > > 父类，定义， 4
> > > > 
> > > > ParseChildNodes() 方法（NodeKey 类）， 256–257
> > > > 
> > > > ParseMessages() 方法（WSDL 类构造函数）， 57–58， 62
> > > > 
> > > > Parse() 方法
> > > > 
> > > > 反向连接载荷， 83
> > > > 
> > > > int.Parse() 方法， 83， 176
> > > > 
> > > > long.Parse() 方法， 176
> > > > 
> > > > ParseChildNodes() 方法， 256–257
> > > > 
> > > > ParseMessages() 方法， 57–58， 62
> > > > 
> > > > ParseTypes() 方法， 56–57
> > > > 
> > > > short.Parse() 方法， 176
> > > > 
> > > > ParseTypes() 方法（WSDL 类构造函数）， 56–57
> > > > 
> > > > 解析
> > > > 
> > > > 注册表 Hive， 252–259
> > > > 
> > > > WSDL XML 文档， 55–67
> > > > 
> > > > SoapBinding 类， 64–65
> > > > 
> > > > SoapBindingOperation 类， 65–66
> > > > 
> > > > SoapMessage 类， 60–61
> > > > 
> > > > SoapMessagePart 类， 61–62
> > > > 
> > > > SoapOperation 类， 63–64
> > > > 
> > > > SoapPortType 类， 62–63
> > > > 
> > > > SoapService 类， 66–67
> > > > 
> > > > SoapType 类， 58–60
> > > > 
> > > > 编写初始解析方法， 56–58
> > > > 
> > > > WSDL 类构造函数， 55–56
> > > > 
> > > > 载荷， 81–82
> > > > 
> > > > 绑定， 85–88
> > > > 
> > > > 接受数据， 86
> > > > 
> > > > 从流中执行命令， 87–88
> > > > 
> > > > 返回输出， 87
> > > > 
> > > > 执行命令， 87
> > > > 
> > > > 反向连接载荷， 82–85
> > > > 
> > > > 网络流， 82–84
> > > > 
> > > > 运行， 84–85
> > > > 
> > > > 执行命令， 84–85
> > > > 
> > > > Metasploit， 94–102
> > > > 
> > > > 执行本地 Linux 载荷， 98–102
> > > > 
> > > > 以非托管代码执行本地 Windows 载荷， 96–98
> > > > 
> > > > 生成， 96
> > > > 
> > > > 设置， 94–96
> > > > 
> > > > 使用 UDP 攻击网络, 88–94
> > > > 
> > > > 攻击者的代码, 92–94
> > > > 
> > > > 目标机器的代码, 89–91
> > > > 
> > > > PDF 站点报告（Nexpose）, 128, 130
> > > > 
> > > > 平台调用（P/Invoke）, 12, 193
> > > > 
> > > > 端口（WSDL）, 55
> > > > 
> > > > HTTP POST SOAP 端口, 72–75
> > > > 
> > > > SOAP XML 端口, 75–78
> > > > 
> > > > posix_memalign() 函数, 99–101
> > > > 
> > > > 向 SOAP 服务发送 POST 参数, 74–75
> > > > 
> > > > POST 请求
> > > > 
> > > > 模糊测试, 25–27
> > > > 
> > > > 参数, 29–31
> > > > 
> > > > 写入请求, 27–29
> > > > 
> > > > 集成 sqlmap 工具, 187–188
> > > > 
> > > > sqlmap REST API, 170–172
> > > > 
> > > > printf() 函数（Linux）, 13
> > > > 
> > > > Process 类
> > > > 
> > > > 绑定有效负载, 87–88
> > > > 
> > > > 反向连接有效负载, 84–85
> > > > 
> > > > 通过 UDP 进行网络攻击, 91
> > > > 
> > > > ProcessStartInfo 类
> > > > 
> > > > 绑定有效负载, 87–88
> > > > 
> > > > 反向连接有效负载, 84–85
> > > > 
> > > > 通过 UDP 进行网络攻击, 91
> > > > 
> > > > 属性，已定义, 4
> > > > 
> > > > Python
> > > > 
> > > > Cuckoo Sandbox 和, 147, 149
> > > > 
> > > > sqlmap, 168, 170

R

> > > > Rapid7
> > > > 
> > > > Metasploit, 94
> > > > 
> > > > Nexpose, 115–116
> > > > 
> > > > ReadChildrenNodes() 方法（NodeKey 类）, 255–256
> > > > 
> > > > ReadChildValues() 方法（NodeKey 类）, 257
> > > > 
> > > > ReadInt32() 方法（NodeKey 类）, 255
> > > > 
> > > > ReadMessage() 方法
> > > > 
> > > > ArachniRPCSession 类, 233, 235
> > > > 
> > > > OpenVASSession 类, 137–138
> > > > 
> > > > ReadNodeStructure() 方法（NodeKey 类）, 254–255
> > > > 
> > > > 正则表达式类（SQL 注入）, 42–43
> > > > 
> > > > RegistryHive 类, 252–253
> > > > 
> > > > 注册表 hive, 249–250
> > > > 
> > > > 转储启动密钥, 259–264
> > > > 
> > > > GetBootKey() 方法, 259–261, 262–263
> > > > 
> > > > GetNodeKey() 方法, 261–262
> > > > 
> > > > GetValueKey() 方法，261
> > > > 
> > > > StringToByteArray() 方法，262
> > > > 
> > > > 验证启动密钥，263–264
> > > > 
> > > > 导出，250–252
> > > > 
> > > > 阅读，252–259
> > > > 
> > > > NodeKey 类，253–257
> > > > 
> > > > RegistryHive 类，252–253
> > > > 
> > > > ValueKey 类，258–259
> > > > 
> > > > 结构，250
> > > > 
> > > > 测试，259
> > > > 
> > > > 远程过程调用 API。参见 RPC API
> > > > 
> > > > REST（表述性状态转移）架构。另见 sqlmap 工具 Arachni 和，224–228
> > > > 
> > > > Cuckoo Sandbox 和，148–150
> > > > 
> > > > Nessus 和，104–105
> > > > 
> > > > sqlmap，169–170
> > > > 
> > > > RLIKE 关键字（盲 SQL 注入），43–44
> > > > 
> > > > 调用方法，50–51
> > > > 
> > > > 创建真假响应，44
> > > > 
> > > > GetValue() 方法，49–50
> > > > 
> > > > MakeRequest() 方法，47
> > > > 
> > > > 打印值，50–51
> > > > 
> > > > 检索值的长度，47–49
> > > > 
> > > > userdb 表，45–47
> > > > 
> > > > 用于匹配搜索条件，44–45
> > > > 
> > > > 根节点密钥（注册表蜂窝），250
> > > > 
> > > > RPC（远程过程调用）API
> > > > 
> > > > Arachni，228–237
> > > > 
> > > > ArachniRPCManager 类，236–237
> > > > 
> > > > ArachniRPCSession 类，230–234
> > > > 
> > > > ExecuteCommand() 方法，234–235
> > > > 
> > > > 手动运行，229–230
> > > > 
> > > > Metasploit，208–209
> > > > 
> > > > Ruby 编程语言
> > > > 
> > > > Arachni 网络应用，223
> > > > 
> > > > Metasploit，94–96
> > > > 
> > > > Ruby 版本管理器（RVM），95

S

> > > > ScanFile() 方法（ClamEngine 类），198–200
> > > > 
> > > > Scan() 方法（ClamdManager 类），205
> > > > 
> > > > 扫描
> > > > 
> > > > ClamAV 库，198–200
> > > > 
> > > > 在 Nessus 中，110–113
> > > > 
> > > > 在 Nexpose 中，126–127，129
> > > > 
> > > > sqlmap 扫描日志，172
> > > > 
> > > > ScanSite() 方法（NexposeManager 类），127
> > > > 
> > > > SDLC（软件开发生命周期），224
> > > > 
> > > > SelectNodes() 方法（WSDL 类构造函数），57
> > > > 
> > > > SELinux, 100
> > > > 
> > > > SerializeObject() 方法（JsonConvert 类），181
> > > > 
> > > > shell，与 Metasploit 交互，221–222
> > > > 
> > > > short.Parse() 方法，176
> > > > 
> > > > 简单对象访问协议（SOAP），19。另见 SOAP 端点；SOAP 模糊测试器 Single() 方法（LINQ），69，70
> > > > 
> > > > Skip() 方法（回连有效载荷），84
> > > > 
> > > > SOAP（简单对象访问协议），19。另见 SOAP 端点；SOAP 模糊测试器 SOAPAction HTTP 头（SOAP 端点），77–78
> > > > 
> > > > SoapBinding 类（WSDL），64–65
> > > > 
> > > > SoapBindingOperation 类（WSDL），65–66
> > > > 
> > > > SOAP 端点，53–54
> > > > 
> > > > 自动化模糊测试 SQL 注入漏洞，68–79
> > > > 
> > > > HTTP POST SOAP 端口，72–75
> > > > 
> > > > 个别 SOAP 服务，69–72
> > > > 
> > > > 运行模糊测试器，78–79
> > > > 
> > > > SOAP XML 端口，75–78
> > > > 
> > > > 解析 WSDL XML 文档，55–67
> > > > 
> > > > 类构造函数，55–56
> > > > 
> > > > SoapBinding 类，64–65
> > > > 
> > > > SoapBindingOperation 类，65–66
> > > > 
> > > > SoapMessage 类, 60–61
> > > > 
> > > > SoapMessagePart 类，61–62
> > > > 
> > > > SoapOperation 类，63–64
> > > > 
> > > > SoapPortType 类，62–63
> > > > 
> > > > SoapService 类，66–67
> > > > 
> > > > SoapType 类，58–60
> > > > 
> > > > 编写初步解析方法，56–58
> > > > 
> > > > 设置易受攻击的端点，54
> > > > 
> > > > SOAP 模糊测试器
> > > > 
> > > > 调用新方法, 188–190
> > > > 
> > > > GET 请求，185–187
> > > > 
> > > > POST 请求，187–188
> > > > 
> > > > SoapMessage 类（WSDL），57，60–61
> > > > 
> > > > SoapMessagePart 类（WSDL），61–62
> > > > 
> > > > SoapOperation 类（WSDL），63–64
> > > > 
> > > > SoapPortType 类（WSDL），62–63
> > > > 
> > > > SoapService 类（WSDL），66–67
> > > > 
> > > > SoapType 类（WSDL），58–60
> > > > 
> > > > SoapTypeParameter 类（WSDL），60
> > > > 
> > > > SOAP XML 端口，模糊测试，75–78
> > > > 
> > > > Socket 类, 网络攻击通过 UDP, 89
> > > > 
> > > > 软件开发生命周期（SDLC）, 224
> > > > 
> > > > Split() 方法（反向连接有效载荷）, 84
> > > > 
> > > > SQL（结构化查询语言）。参见 SQL 注入；sqlmap 工具 SQL 注入, 19–20
> > > > 
> > > > 利用
> > > > 
> > > > 基于布尔值的盲 SQL 注入, 43–51
> > > > 
> > > > 基于 UNION, 38–43
> > > > 
> > > > 模糊测试 SOAP 端点漏洞, 68–79
> > > > 
> > > > HTTP POST SOAP 端口, 72–75
> > > > 
> > > > 独立的 SOAP 服务, 69–72
> > > > 
> > > > 运行模糊测试器, 78–79
> > > > 
> > > > SOAP XML 端口, 75–78
> > > > 
> > > > SqlmapLogItem 类, 182–183
> > > > 
> > > > SqlmapManager 类, 177–179
> > > > 
> > > > Main() 方法, 182
> > > > 
> > > > 选项, 179–180
> > > > 
> > > > 执行扫描, 180–182
> > > > 
> > > > SqlmapSession 类, 173–174
> > > > 
> > > > ExecuteGet() 方法, 174–175
> > > > 
> > > > ExecutePost() 方法, 175
> > > > 
> > > > 测试, 176–177
> > > > 
> > > > SqlmapStatus 类, 181–182
> > > > 
> > > > sqlmap 工具, 167–168
> > > > 
> > > > 自动化扫描, 183–185
> > > > 
> > > > 与 SOAP 模糊测试器集成, 185–190
> > > > 
> > > > 调用新方法, 188–190
> > > > 
> > > > GET 请求, 185–187
> > > > 
> > > > POST 请求, 187–188
> > > > 
> > > > 报告扫描, 182–183
> > > > 
> > > > 正在运行, 168–173
> > > > 
> > > > sqlmap REST API, 169–170
> > > > 
> > > > 使用 curl 测试 sqlmap API, 170–173
> > > > 
> > > > SqlmapManager 类, 177–179
> > > > 
> > > > Main() 方法, 182
> > > > 
> > > > 选项, 179–180
> > > > 
> > > > 执行扫描, 180–182
> > > > 
> > > > SqlmapSession 类, 173–174
> > > > 
> > > > ExecuteGet() 方法, 174–175
> > > > 
> > > > ExecutePost() 方法, 175
> > > > 
> > > > 测试, 176–177
> > > > 
> > > > SSL 证书验证（OpenVASSession 类）, 138–139
> > > > 
> > > > StartScan() 方法
> > > > 
> > > > ArachniHTTPManager 类, 227–228
> > > > 
> > > > ArachniRPCManager 类, 237
> > > > 
> > > > StartTask() 方法
> > > > 
> > > > OpenVASManager 类, 143
> > > > 
> > > > SqlmapManager 类，180
> > > > 
> > > > 有状态协议，85–88
> > > > 
> > > > 无状态协议，88
> > > > 
> > > > 静态网站（Nexpose），118
> > > > 
> > > > StreamReader 类构造函数（反向连接有效载荷），83
> > > > 
> > > > StreamReader ReadLine() 方法（反向连接有效载荷），83
> > > > 
> > > > 字符串类型选项（monodis 程序），245
> > > > 
> > > > StringToByteArray() 方法，262
> > > > 
> > > > 结构化查询语言。参见 SQL 注入；sqlmap 工具子类，4–6
> > > > 
> > > > System.Linq 命名空间（反向连接有效载荷），84

T

> > > > TaskFactory 类（Cuckoo Sandbox），162
> > > > 
> > > > TCP（传输控制协议）
> > > > 
> > > > 有效载荷，81–82
> > > > 
> > > > 绑定，85–88
> > > > 
> > > > 反向连接有效载荷，82–85
> > > > 
> > > > UDP 与，88–89
> > > > 
> > > > TcpClient 类
> > > > 
> > > > clamd 守护进程，203
> > > > 
> > > > 反向连接有效载荷，82–84
> > > > 
> > > > TcpListener 类（绑定有效载荷），85–86
> > > > 
> > > > Tenable 网络安全，103
> > > > 
> > > > TestGetRequestWithSqlmap() 方法（SOAP 测试器），185–187
> > > > 
> > > > 测试
> > > > 
> > > > ClamAV 库，200–201
> > > > 
> > > > clamd 守护进程，205–206
> > > > 
> > > > GetBootKey() 方法，263
> > > > 
> > > > JSON 测试器，37–38
> > > > 
> > > > MetasploitSession 类，217
> > > > 
> > > > NessusSession 类，108–109
> > > > 
> > > > Nexpose，118
> > > > 
> > > > 注册表蜂巢，259
> > > > 
> > > > SqlmapSession 类，176–177
> > > > 
> > > > TestPostRequestWithSqlmap() 方法（SOAP 测试器），187–188
> > > > 
> > > > Time 属性（SqlmapLogItem 类），183
> > > > 
> > > > TLS（传输层安全性），121
> > > > 
> > > > 传输控制协议。参见 TCP

U

> > > > Ubuntu，94
> > > > 
> > > > UDP（用户数据报协议）
> > > > 
> > > > TCP 与，88–89
> > > > 
> > > > 用于攻击网络，88–94
> > > > 
> > > > 攻击者代码，92–94
> > > > 
> > > > 目标机器的代码，89–91
> > > > 
> > > > UdpClient 类，89
> > > > 
> > > > 基于 UNION 的 SQL 注入
> > > > 
> > > > 手动执行漏洞利用，38–40
> > > > 
> > > > 程序化执行漏洞利用，40–43
> > > > 
> > > > 使用有效负载构建 URL，41–42
> > > > 
> > > > 创建标记以查找用户名和密码，41
> > > > 
> > > > 发起 HTTP 请求，42–43
> > > > 
> > > > 非托管代码，96–98
> > > > 
> > > > 用户数据报协议。参见 UDP
> > > > 
> > > > 使用关键字，24

V

> > > > ValidateServerCertificate() 方法（ArachniRPCSession 类），233
> > > > 
> > > > ValueKey 类（注册表 Hive），250, 258–259
> > > > 
> > > > VirtualAlloc() 函数，96–98
> > > > 
> > > > VirtualBox 虚拟化软件，16, 209。另见 VMs 虚拟机。参见 VMs
> > > > 
> > > > Visual Studio IDE（微软），1–2
> > > > 
> > > > 虚拟机（VMs），12–13
> > > > 
> > > > 添加仅主机虚拟网络，16
> > > > 
> > > > 从 BadStore ISO 启动，17–18
> > > > 
> > > > 创建，17
> > > > 
> > > > 漏洞扫描器
> > > > 
> > > > Nessus，103–113
> > > > 
> > > > NessusManager 类，109–110
> > > > 
> > > > NessusSession 类，105–109
> > > > 
> > > > 执行扫描，110–113
> > > > 
> > > > REST 架构及，104–105
> > > > 
> > > > Nexpose，115–131
> > > > 
> > > > 自动化漏洞扫描，126–127, 130
> > > > 
> > > > 安装，116–118
> > > > 
> > > > NexposeManager 类，124–125
> > > > 
> > > > NexposeSession 类，118–124
> > > > 
> > > > PDF 网站报告, 128, 130
> > > > 
> > > > 执行扫描，129
> > > > 
> > > > OpenVAS，134–145
> > > > 
> > > > 安装，134
> > > > 
> > > > OpenVASManager 类，140–145
> > > > 
> > > > OpenVASSession 类，134–139

W

> > > > Web 服务描述语言 XML 文档，解析。参见 WSDL XML 文档，解析 while 循环
> > > > 
> > > > 反向连接有效负载，83
> > > > 
> > > > 通过 UDP 进行网络攻击，89–90
> > > > 
> > > > Windows
> > > > 
> > > > ClamAV 库，192, 196
> > > > 
> > > > 执行本地 Windows 有效负载作为非托管代码，96–98
> > > > 
> > > > 生成 Metasploit 有效负载，96
> > > > 
> > > > ILSpy 反编译器，242
> > > > 
> > > > kernel32.dll 库，96–97
> > > > 
> > > > MessageBox() 函数，13
> > > > 
> > > > 注册表配置单元，249–250
> > > > 
> > > > 转储启动密钥，259–264
> > > > 
> > > > 导出，250–252
> > > > 
> > > > 读取，252–259
> > > > 
> > > > 结构，250
> > > > 
> > > > 测试，259
> > > > 
> > > > WSDL（Web 服务描述语言）XML 文档，解析，55
> > > > 
> > > > 类构造函数，55–56
> > > > 
> > > > SoapBinding 类，64–65
> > > > 
> > > > SoapBindingOperation 类，65–66
> > > > 
> > > > SoapMessage 类，60–61
> > > > 
> > > > SoapMessagePart 类，61–62
> > > > 
> > > > SoapOperation 类，63–64
> > > > 
> > > > SoapPortType 类，62–63
> > > > 
> > > > SoapType 类，58–60
> > > > 
> > > > 编写初始解析方法，56–58

X

> > > > x86_64 汇编，241。另见托管程序集 Xamarin Studio IDE，2
> > > > 
> > > > XElement 类（SOAP XML），76–77
> > > > 
> > > > XML 节点，59–60
> > > > 
> > > > XPath 查询，57–58
> > > > 
> > > > XSS（跨站脚本攻击），20–22

《Gray Hat C#》使用了 New Baskerville、Futura、Dogma 和 TheSansMono Condensed 字体。此书由 Sheridan Books, Inc. 在密歇根州切尔西市印刷和装订。纸张为 60# Finch Smooth，且获得森林管理委员会（FSC）认证。

本书采用平装订法，页面通过冷固、柔性胶水粘合在一起，书本的第一页和最后一页与封面连接。封面实际上并没有粘到书脊上，翻开时，书本可以平躺，且书脊不会破裂。
