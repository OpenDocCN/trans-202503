## 第九章：## 在故事板中创建按钮和屏幕

![图片](img/Image00001.jpg)

BirthdayTracker 应用帮助你通过将生日保存到列表中并通过提醒来提示你，帮助你记住朋友的生日。我们将在接下来的五个章节中一起构建这个应用。在本章中，我们将向你展示如何设置用户所看到的应用部分。

我们将制作两个屏幕：一个显示生日列表，另一个让你将某个人的名字和生日添加到列表中。然后，在第十章到第十三章中，我们将向你展示如何获取用户输入、在屏幕上显示生日、保存生日，并在某人生日时通过通知提醒用户。

你准备好创建一个应用了吗？我们开始吧！

### 应用的概要

到本章结束时，我们将为 BirthdayTracker 创建两个屏幕。我们将这些屏幕称为“生日”和“添加生日”屏幕，如图 9-1 所示。

![图片](img/Image00196.jpg)

*图 9-1：我们将在接下来的几章中构建的完成应用*

生日屏幕显示了你已添加的生日列表，添加生日屏幕是你可以添加新生日条目的地方。

在 Xcode 中，屏幕包括一个*视图*和一个*视图控制器*。视图是你在屏幕上看到的内容，而视图控制器包含所有控制视图的 Swift 代码。在图 9-1 中，你可以看到 Birthdays 视图的右上角有一个像加号（+）一样的添加按钮。

添加按钮将打开添加生日视图，用户可以在其中输入新朋友的生日详情。让我们通过为 BirthdayTracker 创建一个新的 Xcode 项目来开始吧。

### 创建一个新的 Xcode 项目

到目前为止，你大部分代码都是在 playground 中编写的。playground 是学习编程的好地方，但要编写一个可以在 iPad 或 iPhone 上运行的应用，你需要创建一个 Xcode 项目，就像你在第一章中为 Hello World 应用创建的项目一样。

在 Xcode 菜单中，选择 **文件** ▸ **新建** ▸ **项目**。在对话框的顶部选择 **iOS**，然后选择 **单视图应用程序** 作为项目模板，点击 **下一步**。

在出现的对话框中，Xcode 会要求你设置一些新应用的选项。由于这只是一个示例，你不需要太过*严肃*对待这部分内容。当你编写计划销售或在 App Store 上分发的应用时，设置这些值要更为重要。将你的应用命名为**BirthdayTracker**，确保语言设置为**Swift**，设备设置为**iPhone**，并勾选**使用 Core Data**。你的组织名称和组织标识符应该会自动填充为你在创建 Hello World 应用时在第一章中输入的值。

点击**下一步**。在弹出的对话框中，选择你要保存项目的位置并点击**创建**。你的 Xcode 项目应该会自动打开。花点时间确保在你的项目导航器中列出了名为*BirthdayTracker.xcdatamodeld*的文件（见图 9-2）。

![Image](img/Image00197.jpg)

*图 9-2：确保你的新项目中有一个*BirthdayTracker.xcdatamodeld*文件。*

你需要*BirthdayTracker.xcdatamodeld*文件来在 iPhone 上保存生日。如果它丢失了，那意味着你在创建 Xcode 项目时没有勾选使用 Core Data 的选项。别担心——这个问题非常容易解决。

如果你的*BirthdayTracker.xcdatamodeld*文件丢失，关闭你的项目（文件 ▸ 关闭项目），然后重新开始，创建一个勾选了使用 Core Data 的新 Xcode 项目。当系统询问你是否要替换 BirthdayTracker 项目时，只需点击**替换**，你就准备好了！

你的新 BirthdayTracker Xcode 项目将会打开。如果你还没有将 Apple 账号添加到 Xcode，你会在“常规”应用设置的签名部分看到一条消息：“未找到账户”。除非你希望在真实设备上运行应用，否则无需添加账户。（记得你也可以在 Xcode 的模拟器上运行应用。）要将 Apple 账号添加到 Xcode，点击**添加账户**按钮。（有关添加 Apple 账号的详细说明，请参见“你的第一个应用！” 第 5 页（text00011.html#page_5））

这个常规设置屏幕也是你设置应用运行设备方向的地方。我们希望 BirthdayTracker 应用仅在*竖屏*模式下运行。竖屏模式是手机的常规方向，主屏按钮位于底部。*横屏*模式是当你将手机横着拿时，屏幕也会旋转，屏幕的宽度变成了手机的高度，屏幕的高度变成了手机的宽度。BirthdayTracker 应用在横屏模式下显示效果不好，因此我们不会让屏幕在用户将手机横着拿时自动旋转。倒置模式下应用也能正常显示，但如果用户将手机反转，屏幕跟着旋转会让用户感到困惑，因此我们也不支持倒置模式。在部署信息部分，设备方向旁边，取消勾选**左横屏**和**右横屏**，确保只有**竖屏**框被勾选。

让我们环顾一下 Xcode。选择左侧导航栏中的*ViewController.swift*，你应该会看到类似图 9-3 的内容。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航器窗格 ➊，你可以通过进入**视图** ▸ **导航器** ▸ **隐藏/显示导航器**或按 ⌘ -0 来隐藏或显示它。你将使用导航器来选择并查看项目中的文件。

编辑器窗格位于窗口的中央 ➋。这是你编写代码的地方！这里也是你可以更改应用设置并使用故事板布局应用中将要显示的项目的地方，正如你在第一章中看到的。我们稍后会更详细地讨论故事板。

右侧是工具窗格 ➌，你可以通过选择**视图** ▸ **工具** ▸ **隐藏/显示工具**或按 ⌘ -OPTION -0 来隐藏或显示它。当故事板打开时，工具窗格将允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用程序都带有某种图标，该图标会显示在用户设备的主屏幕上。我们将通过添加应用图标来开始我们的 BirthdayTracker 应用。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图片。下载 ZIP 文件后，你将在 *Downloads* 文件夹内看到一个名为 *ch9-images* 的文件夹，其中包含你需要的图片文件。拿到这些文件后，从项目导航器中选择 *Assets.xcassets*。这将打开应用的 *资源目录*，在这里你可以放置任何应用将要使用的 *资源*（如图片、声音等），包括应用图标。事实上，资源目录已经带有一个占位符，你可以在其中添加图标。从目录左侧菜单中选择 **AppIcon**，你应该能看到几个图像占位符。

要添加将在 iPhone 主屏幕上显示的应用图标，你需要为标记为 *iPhone App* 的图标集提供 2x 和 3x 的图像。2x 尺寸适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸的图像。你将在第十四章中了解更多关于为不同屏幕分辨率调整图片尺寸的内容。

将图标添加到资源目录非常简单！下载提供的图片后，在 Finder 中打开 *Downloads* 文件夹。然后，简单地将图片 *cake@2x.png* 拖到 iPhone App 2x 框中，将 *cake@3x.png* 拖到 3x 框中。完成后，你的资源目录应该像图 9-4 一样。

![图片](img/Image00200.jpg)

*图 9-4：我们现在有了应用图标！*

除了应用图标，应用还具有一个在主页图标下显示的显示名称。默认情况下，这个名称就是应用名称 BirthdayTracker。然而，这个名称有点长，无法适应图标下方，所以我们将其更改为一个更短的名称：Birthdays。为此，选择项目导航器中的 BirthdayTracker 项目，返回设置页面。在身份部分的顶部，你可以更改应用的显示名称。只需在显示名称文本字段中输入**Birthdays**。这只会更改显示在应用图标下方的名称。你的项目名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，接下来让我们创建应用界面！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。这是我们将设计应用*用户界面*的地方。用户界面是用户用来与应用交互的所有元素的总称——例如图像、文本、按钮等。*故事板*让你可以直观地组织应用的各个屏幕。我们将使用故事板查看所有使用的屏幕以及它们之间的连接。

一旦你选择了*Main.storyboard*，通过按下⌘ -0 隐藏导航面板，以便腾出更多屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在看看工具面板顶部。你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，它们是帮助你更仔细地查看故事板元素并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它将出现在工具面板中。

**检查故事板项目**

图 9-5 展示了在打开故事板时，工具面板中出现的检查器选择栏的特写图。

![Image](img/Image00201.jpg)

*图 9-5：你可以在故事板的工具面板中使用六个检查器。*

让我们从左到右依次了解这些检查器。页面图标打开文件检查器。这是你可以更改故事板文件设置的地方。在本书中以及你大多数应用中，你不会使用这个检查器。

下一个检查器是由问号图标表示的“快速帮助检查器”。这个检查器将为你提供关于当前在故事板中选中的项目的详细类信息。

第三个检查器是带有身份证图标的“身份检查器”。在这里，你可以为故事板中的项目设置自定义类。

接下来的两个检查器是您在工作中最常使用的，文本中也会频繁提到它们。属性检查器的图标看起来像一个盾牌。此检查器用于设置故事板中选定项目的各种属性。例如，可以用它来设置标签的文本、按钮的颜色或文本输入框周围的框类型。尺寸检查器，带有尺子的图标，用于设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，它的图标看起来像一个圆圈中的箭头。这个工具可以用来将故事板中的元素与您在类中编写的代码片段连接起来。我们将在第十章中向您展示如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是“生日”视图控制器。这将是一个特殊类型的视图控制器，用于显示一个列表，在 Xcode 中被称为*表格视图控制器*。在我们的应用程序中，表格视图控制器将显示您朋友的生日列表！目前它只是看起来像一个空白屏幕，您将在“创建生日表格视图控制器”的第 156 页中学习如何显示生日数据。

让我们向故事板添加一个表格视图控制器。如果您先从故事板缩小视图，以便更好地看到视图控制器，这个步骤会更容易。双击故事板中视图控制器外的空白区域来实现。现在您的屏幕应该已经缩小了。

在实用工具窗格的底部，有一个顶部有四个按钮的区域。选择第三个按钮，它看起来像一个圆圈中的方块。这里是对象库，您可以在这里找到可以添加到故事板中的项目。滚动浏览对象库列表，直到找到表格视图控制器，或者使用窗格底部的筛选栏搜索“table view controller”。然后将该对象点击并拖动到故事板上，放置在已存在的视图控制器旁边。您的故事板应该看起来像图 9-6 中的样子。

请注意，在您添加表格视图控制器后，左侧大纲视图中会出现一个表格视图控制器场景条目，里面包含一个表格视图控制器。故事板中的场景表示应用程序中的一个屏幕区域。在 iPhone 应用程序中，通常一次只有一个场景显示在屏幕上，并且该场景会填满整个屏幕。iPad 应用程序则可以同时在屏幕上显示两个或更多场景。

![图片](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到“生日”屏幕的故事板中*

下一步是将这个新视图控制器设置为应用启动时第一个出现的屏幕，因为我们希望在用户打开应用时显示生日列表。完成此操作的步骤见图 9-7。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表视图控制器并将其设置为初始视图控制器。*

首先，在大纲视图 ➊ 中选择**表视图控制器**。然后在工具区域 ➋ 中调出属性检查器。在那里，勾选**是初始视图控制器** ➌。完成后，应该会看到在故事板中表视图控制器左侧出现一个箭头。这个箭头表示应用在启动时会显示这个视图控制器。

#### 添加导航控制器

接下来，我们将为视图控制器添加一个标题，显示“生日”，并添加一个“添加”按钮，用于弹出“添加生日”视图控制器。为此，我们首先将表视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器，并配有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧显示按钮，用于导航到应用中的其他屏幕。您可以在多个 iOS 应用程序中看到这个导航栏，例如设置应用和信息应用。

在大纲视图中选择**表视图控制器**。选中它后，您需要使用 Xcode 菜单将表视图控制器嵌入到导航控制器中。依次点击**编辑** ▸ **嵌入到** ▸ **导航控制器**。

在将表视图控制器嵌入到导航控制器后，您的故事板应该像图 9-8 中所示。导航控制器将作为屏幕出现在故事板中。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器都代表着用户将在应用中看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像是一个独立的屏幕，实际上，导航控制器只是一个容器，包含了应用中用户在不同视图之间切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着您的应用可以在一个视图与另一个视图之间进行导航。

你应该在导航控制器和表视图控制器的顶部看到灰色的导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能还包含按钮和箭头，用户可以使用它们前往其他屏幕。为了使用导航栏告诉用户他们所在的屏幕，我们需要为屏幕添加标题。现在是回到故事板并进行缩放的好时机。双击故事板的空白区域进行缩放，然后滚动视图，以便你可以看到表视图控制器。要为表视图控制器添加标题，在左侧大纲视图中的**表视图控制器场景**下点击**导航项**。

![Image](img/Image00205.jpg)

选中此项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。你应该能看到，在完成此步骤并按下 RETURN 键后，大纲视图中的表视图控制器场景条目会自动更新为“生日场景”。

接下来，我们将创建一个添加按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并向该列表添加一个生日。让我们创建一个按钮，让他们可以这样做！

我们需要在导航栏上添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。在对象库中找到工具栏按钮项，然后将其拖放到表视图控制器的导航栏右侧，如图 9-9 所示。

现在我们想把这个按钮变成一个添加按钮。幸运的是，Xcode 提供了一个内建的添加按钮可以使用。在属性检查器中，将工具栏按钮项的系统项目改为**添加**。你应该能看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在被点击时该做什么。我们希望它打开“添加生日”视图控制器，所以我们需要将添加按钮连接到该视图控制器。首先，双击故事板以进行缩小，确保你能看到“生日”表视图控制器和最终将成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键并从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标，这将弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将工具栏按钮项拖放到生日视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到邻近的视图控制器，并在弹出的对话框中选择“模态呈现”。*

连接对话框提供了多个选项，让你选择两个视图控制器之间的*过渡*类型——即从一个屏幕到另一个屏幕的过渡效果。点击连接对话框中的**模态呈现**选项。这将使视图控制器作为*模态*视图控制器呈现在屏幕上。在 iPhone 上，模态视图控制器是从屏幕底部出现的，并且它不会自动带有返回按钮返回到上一个屏幕。相反，模态视图可以有其他按钮，如取消或保存。还有其他类型的过渡，如显示过渡（Show segue），它会将视图控制器从右侧推到屏幕上，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用程序中，当你呈现一个用于获取和保存用户输入的屏幕时，应该将该屏幕显示为模态视图，并带有取消按钮。否则，如果你使用类似显示过渡（Show segue）并带有返回按钮的方式，可能会发生用户输入了所有内容后，点击返回按钮而没有保存任何内容的情况！有了取消按钮，用户必须刻意点击取消才能退出屏幕。

要查看一个好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，你会看到在导航栏右侧有一个 + 按钮，点击它可以添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，用于不保存并退出屏幕，右侧有一个添加按钮，用于在关闭模态视图前创建新事件。你应该看到，新事件模态视图是从屏幕底部出现的，并且在关闭时会向下消失。我们希望用户能够保存生日，因此我们也将使用模态视图。

现在让我们尝试运行我们的应用程序，看看到目前为止我们做了什么！要运行应用程序，首先选择一个设备模拟器，方法是点击 Xcode 左上角显示的 BirthdayTracker 旁边的设备（见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器运行的设备，设备名称显示在应用程序名称旁边。这里设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用程序。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮或使用快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用程序时，如果模拟器太大，无法在你的计算机屏幕上显示，你可以调整它的大小。点击模拟器以选择它，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用时不会发生太多事情。你应该会看到第一个“Birthdays”屏幕，带有一个 + 按钮，正如图 9-1 所示。显然，此时“Birthdays”屏幕将是空的。点击 + 按钮将会弹出第二个空白屏幕。当你查看完应用后，通过点击 Xcode 中的停止按钮关闭它，停止按钮位于你之前点击的播放按钮旁边。当你停止应用时，你应该能看到你的应用图标出现在模拟器的主屏幕上！（见图 9-12）

就这样！现在我们需要配置第二个屏幕，以便它可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，首先添加其标题。为此，你需要将其嵌入到自己的导航控制器中。当视图控制器是模态的时，它不会继承我们故事板中已有的导航控制器的导航栏。导航控制器是提供导航栏的，所以我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器来选择它。然后转到 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在，你应该会看到一个导航项已添加到视图控制器场景下的轮廓视图中。点击这个新添加的导航项，然后在属性检查器中输入标题 **Add a Birthday**。这些步骤与之前为表格视图控制器添加“Birthdays”标题时的步骤相同。

现在，当“添加生日”视图控制器在应用中出现时，顶部将会显示其标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每一条记录都将包括一个名字、一个姓氏和一个出生日期。我们将向“添加生日”视图控制器中添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件是像文本框或下拉菜单这样的控件，允许用户在应用中输入数据。我们将从添加用户可以添加的所有信息的输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“First Name”（名字）的标签。这个标签将位于一个文本框旁边，用户可以在其中输入朋友的名字。找到并将一个标签对象从对象库拖动到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name** 作为显示文本，如图 9-14 所示。

现在我们想使用大小检查器设置标签的大小和位置。在 Xcode 的 storyboard 中，宽度和高度以 *点* 为单位。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点将转换为 1 像素、2×2 像素的方块，或 3×3 像素的方块。这三种缩放因子分别称为 @1x、@2x 和 @3x（这与我们设置应用图标时讨论的尺寸相同）。不同设备的点分辨率也不相同，宽度范围从 320 到 1,024 点，高度从 568 到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* 姓名

只有最旧的 iPhone 和 iPod 型号使用 @1x 缩放因子，并且你将无法在这些型号上运行你的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们通常使用 @2x 缩放因子，这些设备使用的是 @3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离（单位为点）。y 位置是从屏幕顶部到对象顶部的距离。（见 图 9-15。）我们将为每个添加到视图控制器中的库对象设置 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签放置在屏幕上，这样它不会靠近屏幕边缘，同时仍然为文本输入字段和其他标签及输入框留出足够的空间。在大小检查器的 View 部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。将高度保持为 21。

完成后，重复这些步骤为添加生日视图控制器添加两个标签：姓氏标签和出生日期标签。我们需要定位其他标签和输入框，确保它们不会重叠。在某些情况下，这可能会变得很棘手，可能需要一些时间。对于这个应用程序，我们已经为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们会解释如何让你的应用在其他设备上运行。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，从而使它们垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置需要比下一个最近的标签高出至少 21 个点。由于我们还要在每个标签下方添加输入控件，所以我们将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

太好了！现在你的故事板应该像图 9-16 一样。

![Image](img/Image00214.jpg)

*图 9-16：已为输入项添加标签到视图控制器。*

接下来，你将添加两个*文本字段*，它们将让你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在文本字段中输入一行文字。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。为这两个文本字段设置如表 9-2 中所示的大小和位置。你可以像设置标签一样，使用大小检查器来完成此操作。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个被称为*日期选择器*的控件，它可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中的日期选择器一样（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，日期选择器用于选择日期。*

日期选择器也可以仅显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这就是我们在生日追踪器中使用的方式。

在对象库中滚动直到找到日期选择器，然后点击并拖动它到视图控制器中的出生日期标签下方。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整一些日期选择器的属性。点击选择日期选择器，然后在属性检查器中将日期选择器的模式设置为显示**日期**，而非日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们把这个日期改为您的生日！将“日期”字段从“当前日期”改为**自定义**。这样，一个新框将会出现。将该日期改为您的生日。

让我们通过运行应用来测试目前的效果！我们为输入控件选择的尺寸非常适合 iPhone 7 屏幕。所以，选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当您点击“生日”视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如 图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很好，但其他设备呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，然后重新运行应用。您会看到，某些内容看起来不太对劲。

您在故事板中添加的所有元素都会出现，但文本框超出了屏幕的边缘。现在您已经将所有元素放到屏幕上，下一步是让它们在任何屏幕尺寸上都能正确适配。我们将通过一个叫做 *自动布局* 的工具来实现这一点。

#### 在每个设备上通过自动布局使您的应用看起来完美

iPhone 单独就有三种不同的屏幕尺寸，而且未来可能还会有更多尺寸。您需要设计您的应用，使其在任何设备上都能看起来不错。这意味着您的应用应该能够根据设备的不同，自动调整应用中所有元素的位置和大小。自动布局使用一种叫做 *布局约束* 的机制来放置屏幕上的元素。您需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见 图 9-20 ）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部第四个图标，打开自动布局菜单。*

在屏幕的故事板面板底部，有一条包含图标的功能条，在实用工具面板前的最右侧有一个三角形，位于两条竖线之间。将鼠标光标悬停在该图标上，应该会显示一个标签，标明“解决自动布局问题”。点击该图标以打开一个建议菜单。点击**添加缺失的约束**。^(*) 完成后，您会看到为“添加生日”场景添加了一堆布局约束。

这些自动布局约束确保每个元素的尺寸正确，适合显示在屏幕上。例如，自动布局确保日期选择器的宽度适配屏幕宽度，不会超出屏幕边缘。自动布局还确保每个文本字段前后有 20 点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这时，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这项工作，我们将向你展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。按钮目前不会做任何事情，我们只是进行设置。在第十章中，我们将添加一些代码，使它们能够取消操作并保存生日信息到应用中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右侧*。我们将把这个按钮设置为保存按钮，方法与设置“添加”按钮时相同。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，方法与设置保存按钮时相同。你的视图控制器应该看起来像图 9-21 所示。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新按钮的效果！

点击生日表视图控制器上的 + 按钮应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的名字和生日。点击取消和保存按钮目前没有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

本章中，你开始制作一个生日跟踪器应用，通过创建“生日”和“添加生日”屏幕的基本用户界面。你还使用表视图控制器创建了“生日”屏幕，并使用户可以通过“添加”按钮和导航控制器在屏幕之间切换。

现在你已经完成了应用的基本框架，接下来将在第十章中编写代码，使取消和保存按钮能够在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失的约束”选项已被禁用。这是苹果的一个 bug。如果遇到这种情况，请选择 **重置为缺失约束** 以添加缺失的约束。

## 在故事板上创建按钮和屏幕

![图片](img/Image00001.jpg)

BirthdayTracker 应用帮助你通过将生日保存到列表中并通过提醒通知你来跟踪朋友的生日。在接下来的五个章节中，我们将一起构建这个应用。在本章中，我们将展示如何设置用户所看到的应用部分。

我们将制作两个屏幕：一个显示生日列表，另一个让你将一个人的名字和生日添加到列表中。然后，在第十章到第十三章中，我们将展示如何获取用户输入、在屏幕上显示生日、保存生日，并在有人过生日时通过通知提醒用户。

你准备好制作一个应用了吗？我们开始吧！

### 应用概述

在本章结束时，我们将拥有两个 BirthdayTracker 屏幕。我们将这两个屏幕称为“生日”屏幕和“添加生日”屏幕，如图 9-1 所示。

![Image](img/Image00196.jpg)

*图 9-1：我们将在接下来的几个章节中构建的完成应用的展示*

生日屏幕显示了你添加的生日列表，而添加生日屏幕则是你可以新增生日条目的地方。

在 Xcode 中，屏幕包括一个*视图*和一个*视图控制器*。视图是你在屏幕上看到的内容，视图控制器则包含所有控制视图的 Swift 代码。在图 9-1 中，你可以看到生日视图的右上角有一个加号（+）样式的添加按钮。

添加按钮将打开添加生日视图，用户可以在这里输入新朋友的生日详情。让我们从为 BirthdayTracker 创建一个新的 Xcode 项目开始。

### 创建一个新的 Xcode 项目

到目前为止，你大部分的代码都写在了 playground 中。playground 是一个学习编码的好地方，但要编写一个可以在 iPad 或 iPhone 上运行的应用，你需要创建一个 Xcode 项目，就像你在第一章中为 Hello World 应用所做的那样。

在 Xcode 菜单中，选择**文件** ▸ **新建** ▸ **项目**。在对话框顶部选择**iOS**，然后选择**单视图应用**作为你的项目模板，点击**下一步**。

在弹出的对话框中，Xcode 会要求你为新的应用设置一些选项。由于这只是一个示例，你不需要过于认真对待这部分内容。当你编写一个计划出售或在 App Store 上分发的应用时，设置这些值才会变得更加重要。将你的应用命名为**BirthdayTracker**，确保语言选项为**Swift**，设备选项设置为**iPhone**，并勾选**使用 Core Data**。你的组织名称和组织标识符应当已预填入你在第一章中创建 Hello World 应用时输入的值。

点击**下一步**。在弹出的对话框中，选择你希望保存项目的位置，并点击**创建**。你的 Xcode 项目应该会自动打开。花点时间确保在项目导航器中列出了名为*BirthdayTracker.xcdatamodeld*的文件（参见图 9-2）。

![Image](img/Image00197.jpg)

*图 9-2：确保你的新项目中有一个* BirthdayTracker.xcdatamodeld *文件。*

你需要*BirthdayTracker.xcdatamodeld*来在 iPhone 上保存生日。如果它缺失，意味着你在创建 Xcode 项目时没有勾选使用核心数据（Use Core Data）选项。别担心——这很容易解决。

如果你的*BirthdayTracker.xcdatamodeld*文件缺失，请关闭项目（文件 ▸ 关闭项目），然后重新开始，创建一个勾选了使用核心数据（Use Core Data）选项的新 Xcode 项目。当系统询问是否替换 BirthdayTracker 项目时，点击**替换**，一切就绪！

你的新 BirthdayTracker Xcode 项目将会打开。如果你没有将 Apple 账户添加到 Xcode，你会在常规应用设置的签名部分看到一条消息：“未找到账户”。除非你想在真实设备上运行应用，否则不需要添加账户。（记住，你也可以在 Xcode 的模拟器上运行你的应用。）要将 Apple 账户添加到 Xcode，点击**添加账户**按钮。（有关添加 Apple 账户的详细说明，请参见“你的第一个应用！”第 5 页 。）

这个常规设置页面也是你设置应用程序运行所需设备方向的地方。我们希望 BirthdayTracker 应用程序仅在*竖屏*模式下运行。竖屏模式是手机的常规方向，主屏按钮在底部。*横屏*模式是当你将手机横过来时，屏幕也会旋转，使得屏幕的宽度变成手机的高度，屏幕的高度变成手机的宽度。BirthdayTracker 应用程序在横屏模式下看起来不会太好，所以我们不希望屏幕在用户将手机横过来的时候发生变化。应用程序在倒立时看起来没问题，但如果屏幕在用户将手机翻转，主屏按钮在顶部时自动旋转，这可能会让用户感到迷惑，所以我们也不支持倒立模式。在“部署信息”部分，在设备方向旁边，取消勾选**横屏左**和**横屏右**，确保只有**竖屏**选项被选中。

让我们来看看 Xcode。选择左侧导航窗格中的*ViewController.swift*，你应该会看到类似于图 9-3 的内容。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是“导航器”面板 ➊，你可以通过选择**视图** ▸ **导航器** ▸ **隐藏/显示导航器**来隐藏或显示该面板，或者按⌘ -0 快捷键。你将使用导航器来选择并查看项目中的文件。

编辑器面板位于窗口的中央 ➋。在这里你将编写代码！这里也是你可以更改应用设置并使用故事板布置将在应用中显示的项目的地方，正如你在第一章中看到的那样。我们很快会进一步讨论故事板。

右侧是“工具”面板 ➌，你可以通过选择**视图** ▸ **工具** ▸ **隐藏/显示工具**来隐藏或显示该面板，或者按⌘ -OPTION -0 快捷键。当故事板打开时，工具面板将允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都有某种图标，会显示在用户设备的主屏幕上。我们将通过添加一个应用图标来开始创建我们的 BirthdayTracker 应用。你可以从* [`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将使用的两张图像。下载 ZIP 文件后，你将在*下载*文件夹内得到一个名为*ch9-images*的文件夹，里面包含你需要的图像文件。获取这些文件后，从项目导航器中选择*Assets.xcassets*。这将打开应用的*资源目录*，在这里你可以放置任何应用需要使用的*资源*（图像、声音等），包括应用图标。实际上，资源目录已经有一个占位符，你可以在其中添加图标。从目录左侧的菜单中选择**AppIcon**，你应该能看到几个图像的占位符。

要添加一个显示在 iPhone 主屏幕上的应用图标，你需要为标记为*iPhone App*的图标集提供 2x 和 3x 的图像。2x 尺寸适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸的图像。你将在第十四章中了解更多关于不同屏幕分辨率下图像大小的内容。

将图标添加到资源目录非常简单！下载提供的图像后，在 Finder 中打开你的*下载*文件夹。然后只需将图像*cake@2x.png*拖到 iPhone App 2x 框中，将*cake@3x.png*拖到 3x 框中。完成后，你的资源目录应该像图 9-4 一样。

![Image](img/Image00200.jpg)

*图 9-4：现在我们有了一个应用图标！*

除了应用程序图标，应用程序还有一个显示名称，它会显示在主页图标下方。默认情况下，这是应用程序的名称，BirthdayTracker。然而，这个名称有点太长，无法适应图标下方的位置，因此我们将其更改为一个更短的名称：Birthdays。为此，请通过在项目导航器中选择 BirthdayTracker 项目回到设置页面。在顶部的身份部分，你可以更改应用程序的显示名称。只需在显示名称文本框中输入**Birthdays**。这只会更改显示在应用程序图标下方的名称。你的项目名称仍然是 BirthdayTracker。

现在我们已经设置了应用程序图标和显示名称，接下来让我们创建应用程序界面！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。这是我们设计应用程序*用户界面*的地方。用户界面就是用户用来与应用程序交互的所有可见内容——图像、文本、按钮等等。*故事板*让你可以直观地组织应用程序的各个屏幕。我们将使用故事板来查看所有使用的屏幕以及它们之间的连接。

一旦你选择了*Main.storyboard*，通过按⌘ -0 来隐藏导航窗格，以便为屏幕提供更多空间。你的故事板应该已经包含一个视图控制器。

现在看一下实用工具窗格的顶部。你应该会看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更仔细地查看故事板中元素的工具，并允许你更改这些元素的设置。当你选择一个检查器时，它会出现在实用工具窗格中。

**检查故事板项目**

图 9-5 显示了当故事板打开时，实用工具窗格中出现的检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：你可以在故事板的实用工具窗格中使用六个检查器。*

让我们从左到右依次了解这些检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书以及你大多数的应用程序中，你不会使用这个检查器。

下一个检查器，由问号图标表示，是快速帮助检查器。这个检查器会提供你当前在故事板中选择的项的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里，你可以为故事板项目设置自定义类。

接下来的两个检查器是你在故事板中工作时最常使用的，我们将在文本中经常提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置故事板中选定项的各种属性。它可以用来设置标签的文本、按钮的颜色，或者显示在文本输入框周围的框的类型等。尺寸检查器的图标是一个尺子，用来设置每个故事板项的大小和屏幕位置。

最后是连接检查器，它的图标像一个箭头围绕着一个圆圈。它可以用来将故事板中的项目连接到你在类中编写的代码。我们将在第十章中向你展示如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是生日视图控制器。它将是一个特殊的视图控制器类，显示一个列表，在 Xcode 中称为 *表格视图控制器*。在我们的应用中，表格视图控制器将显示你朋友的生日列表！现在它只会像一个空白屏幕，你将在 “创建生日表格视图控制器” 中学习如何在第 156 页显示生日数据。

让我们向故事板中添加一个表格视图控制器。如果你先将故事板缩小，这一步会更容易，因为你可以更好地看到视图控制器。双击视图控制器外的空白区域来实现这一点。现在你的屏幕应该已经缩小了。

在工具面板的底部有一个包含四个按钮的区域。选择第三个按钮，它看起来像是一个圆圈里的方块。这是对象库，你可以在这里找到要添加到故事板中的项目。滚动浏览对象库列表，直到找到表格视图控制器，或者使用面板底部的过滤栏搜索“table view controller”。然后点击并拖动该对象到你的故事板上，放置在已经存在的视图控制器旁边。你的故事板应该像图 9-6 中的那样。

注意，在你添加表格视图控制器后，左侧大纲视图中会出现一个“表格视图控制器场景”条目，里面包含一个表格视图控制器。故事板中的一个场景代表你应用中的一个屏幕区域。对于 iPhone 应用，通常一次只有一个场景出现在屏幕上，并且该场景占据整个屏幕。iPad 应用则可以同时在屏幕上显示两个或更多的场景。

![图片](img/Image00202.jpg)

*图 9-6：为“生日”界面添加表格视图控制器*

下一步是将这个新视图控制器设置为当你运行应用时首先显示的界面，因为我们希望用户打开应用时看到生日列表。执行此操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择“表格视图控制器”，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后在工具面板中打开属性检查器 ➋。在这里，勾选**是初始视图控制器** ➌。完成此操作后，应该会在故事板中的表格视图控制器左侧出现一个箭头。这个箭头表示当应用程序启动时，会显示此视图控制器。

#### 添加导航控制器

接下来，我们将为视图控制器添加一个标题“生日”，并添加一个“添加”按钮，点击后会打开“添加生日”视图控制器。为了做到这一点，我们首先将表格视图控制器嵌入到一个*导航控制器*中。导航控制器管理一个或多个视图控制器，并且带有一个*导航栏*，这个导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且有左右按钮可以导航到应用中的其他界面。你可以在多个 iOS 应用中看到这个导航栏，例如“设置”应用和“信息”应用。

在大纲视图中选择**表格视图控制器**。选中后，使用 Xcode 菜单将表格视图控制器嵌入到导航控制器中。路径是**编辑** ▸ **嵌入** ▸ **导航控制器**。

在表格视图控制器被嵌入到导航控制器后，你的故事板应该会像图 9-8 所示。导航控制器将作为故事板中的一个屏幕显示。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表用户将在应用中看到的一个屏幕，但导航控制器略有不同。虽然它在故事板中看起来像一个单独的屏幕，但实际上，导航控制器只是一个容器，里面包含了用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中，意味着你的应用可以从一个视图导航到另一个视图，再返回来。

你应该会在导航控制器和表格视图控制器的顶部看到灰色导航栏。当应用程序运行时，导航栏会告诉用户他们所在的屏幕标题，并可能包含他们可以用来跳转到其他屏幕的按钮和箭头。为了使用导航栏告诉用户他们所在的屏幕，我们需要给我们的屏幕命名。现在是时候重新缩放故事板了。双击故事板的空白区域进行放大，然后滚动视图，确保能看到表格视图控制器。要为表格视图控制器添加标题，请在左侧大纲视图中的“表格视图控制器场景”下点击**导航项**。

![Image](img/Image00205.jpg)

选中此项后，你可以在右侧的属性检查器中输入屏幕的标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。完成此步骤并按下 RETURN 后，你会看到大纲视图中的“表格视图控制器场景”条目自动更新为“生日场景”。

接下来，我们将创建一个“添加”按钮，以便你可以添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并将生日添加到该列表中。让我们创建一个按钮，允许用户执行此操作！

我们需要向导航栏添加一个按钮，以引导用户进入“添加生日”场景，方便用户输入生日。在对象库中找到“条形按钮项目”，然后将其拖放到表格视图控制器导航栏的右侧，如图 9-9 所示。

现在我们要将这个按钮转换成“添加”按钮。幸运的是，Xcode 提供了一个内建的“添加”按钮供我们使用。在属性检查器中，将条形按钮项目的“系统项目”更改为**添加**。你应该会看到按钮变成一个加号 (+)。

接下来，我们需要告诉按钮点击时应该执行的操作。我们希望它能打开“添加生日”视图控制器，因此需要将“添加”按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你可以看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标，这时会弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个“条形按钮项目”拖动到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在出现的对话框中选择“模态呈现”。*

连接对话框为你提供了几种选项来选择你希望在两个视图控制器之间进行的*segue*（即从一个屏幕到下一个屏幕的过渡）。点击连接对话框中的**模态展示**选项。这将使视图控制器作为*模态*视图控制器出现在屏幕上。在 iPhone 上，模态视图控制器会从手机底部进入屏幕，而且默认情况下没有返回按钮来返回到前一个屏幕。相反，模态视图可以有其他按钮，比如取消或保存。还有其他类型的 segue，例如展示 segue，在这种情况下，视图控制器会从右侧推入屏幕，并且导航栏的左侧会有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，该屏幕应该以模态形式展示，并带有取消按钮。否则，如果你使用像展示 segue 这样的方式，带有返回按钮，用户可能会在输入所有内容后点击返回按钮，而没有保存任何内容！带有取消按钮，用户必须刻意点击才能退出屏幕。

要查看模态输入视图控制器的良好示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧会有一个+按钮，你可以点击它来添加日历事件。点击+按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，用于退出屏幕而不保存，右侧有一个添加按钮，用于在关闭模态窗口之前创建新事件。你应该会看到，新事件模态窗口会从屏幕底部弹出，并在关闭时向下滑动消失。我们希望用户能够保存生日信息，因此我们也将使用模态窗口。

现在让我们尝试运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先选择一个设备模拟器，方法是点击 Xcode 左上角的“生日追踪器”旁边列出的设备（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器将运行的设备，紧挨着你的应用名称。这里，设备设置为 iPhone 7。*

这将显示一个设备选项列表，供你选择用于运行应用的设备。我们选择 iPhone 7。在选择了模拟器后，点击左上角的播放按钮，或使用键盘快捷键⌘ -**R**。

当模拟器打开以运行你的应用时，如果它的大小太大，无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器以选择它，然后前往**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用程序时并没有发生太多事情。你应该会看到你的第一个“生日”屏幕，上面有一个 + 按钮，如图 9-1 所示。显然，在这一点上，你的“生日”屏幕将是空的。点击 + 按钮会显示第二个空白屏幕。查看完应用程序后，通过点击 Xcode 中的停止按钮关闭它，停止按钮位于你之前点击的播放按钮旁边。当你停止应用时，你应该能够看到应用图标出现在模拟器的主屏幕上！（参见图 9-12）

就这样！接下来，我们需要配置这个第二个屏幕，以便它可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题开始设计添加生日视图控制器。为此，你需要将它嵌入到一个自己的导航控制器中。当视图控制器是模态时，它不会继承我们故事板中已经存在的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过在故事板中点击视图控制器，选择该视图控制器。然后，进入**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该能看到一个导航项已添加到视图控制器场景下的轮廓视图中。点击这个新导航项，然后在属性检查器中添加标题**添加生日**。这些步骤和你为表格视图控制器添加“生日”标题时使用的步骤是一样的。

现在，当添加生日视图控制器出现在应用中时，它将带有顶部的标题标签。

#### 添加你朋友的名字和生日

当你在第十章中输入你朋友的生日时，你的应用中的每个条目都会包含一个名字、一个姓氏和一个出生日期。接下来，让我们向添加生日视图控制器中添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件就是像文本框或下拉菜单这样的控件，它们允许用户向应用程序中输入数据。我们将从为所有用户可以添加的信息添加输入控件标签开始。

##### 添加和定位标签

让我们为你的添加生日视图控制器做一个显示“名字”的标签。这个标签将放在一个文本框旁边，用户可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到添加生日视图控制器上（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向添加生日视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在，我们要使用尺寸检查器设置标签的大小和位置。在 Xcode storyboard 中，宽度和高度以 *points* 为单位测量。请注意，1 point 不等于 1 像素。根据您的应用程序运行的设备类型，1 point 将转换为 1 像素、一个 2×2 像素正方形或一个 3×3 像素正方形。这三个缩放因子分别称为 @1x、@2x 和 @3x（与我们设置应用程序图标时提到的相同尺寸）。设备的点分辨率也不同，宽度从 320 到 1,024 points，高度从 568 到 1,366 points 不等。

![图像](img/Image00211.jpg)

*图 9-14：显示标签* 名字

只有最旧的 iPhone 和 iPod 型号使用 @1x 缩放因子，您将无法在这些型号上运行您的应用程序（BirthdayTracker 仅支持 iOS 10+）。您的手机或 iPod 使用的很可能是 @2x 缩放因子，除非它是 iPhone 6 Plus、6s Plus 或 7 Plus，这些型号使用 @3x 缩放因子。

屏幕上对象的位置也基于 points。对象的 x 位置是从屏幕左侧到对象左侧的点距离。y 位置是从屏幕顶部到对象顶部的点距离。（见 图 9-15 。）我们将为添加到视图控制器的每个库对象设置 x 位置和 y 位置。

![图像](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![图像](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕边缘之外，但仍然留出足够空间放置其文本输入字段和其他标签和输入框。在尺寸检查器的“视图”部分中，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。将高度保留为 21。

完成此操作后，请按照相同步骤向“添加生日”视图控制器中添加另外两个标签：姓氏标签和生日标签。我们需要定位其他标签和输入框，以免它们重叠。在某些情况下，这可能会有些棘手，可能需要一些时间。对于此应用程序，我们已经为您计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何使您的应用程序与其他设备兼容。表 9-1 列出了您应为每个标签提供的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到所有的标签具有相同的 x 位置，使它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度是 21，因此 y 位置需要比下一个标签的 y 位置大至少 21 点。由于我们在每个标签下方添加了输入控件，所以我们将 y 位置设得更大，以适应标签的高度和输入控件的高度。

太棒了！现在你的故事板应该看起来像 图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已被添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段的大小和位置设置为 表 9-2 中所示。你可以使用尺寸检查器，正如你为标签所做的那样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做*日期选择器*的轮盘。这将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，允许用户选择日期或时间。它可以同时包含日期和时间，就像日历应用中的日期选择器（参见 图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用的日期选择器用于选择日期。*

日期选择器还可以仅显示时间，就像时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这也是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到视图控制器中的出生日期标签下方。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（参见 图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器会显示当前日期。我们来将这个日期改为你的生日吧！将“日期”字段从“当前日期”更改为**自定义**。更改后，会出现一个新的框框。将日期设置为你的生日。

让我们通过运行应用来测试目前为止的工作效果！我们为输入控件设置的大小在 iPhone 7 屏幕上显示得很好。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你点击“生日”视图控制器上的 + 按钮时，“添加生日”屏幕应该会显示出来，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备怎么样呢？选择一个较小的模拟器（如 iPhone 5s），并重新运行应用。你会看到界面看起来有些问题。

你添加到故事板中的所有元素都会显示出来，但文本框超出了屏幕边缘。现在所有元素都已显示在屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确显示。我们将通过一个叫做*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上都完美显示，使用自动布局

单单 iPhone 就有三种不同的屏幕尺寸，并且未来可能会有更多的尺寸。你需要设计你的应用，使其在任何设备上都能良好显示。这意味着你需要让应用自动调整屏幕上所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的技术来将元素放置到屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的提纲视图中选择**视图控制器**。接下来，看看编辑面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部第四个图标，弹出自动布局菜单。*

在屏幕故事板面板的底部，有一个带图标的工具栏，位于工具面板之前的最右侧图标是一个夹在两条竖线之间的三角形。将鼠标光标悬停在该图标上时，应该会显示一个标签，内容为“解决自动布局问题”。点击此图标，会弹出一系列建议。点击**添加缺失的约束**。^(*) 完成此操作后，你会看到许多布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小能够正确地适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕，不会超出边缘。自动布局还会确保每个文本框前后都有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这时，“添加生日”页面应该看起来完美无缺。

#### 添加“保存”和“取消”按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作“取消”和“保存”按钮。按钮目前不会执行任何操作——我们只是先设置它们。在第十章中，我们将添加一些代码，使这些按钮能够取消“添加生日”页面并保存生日到应用中。

为了添加“保存”按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改成“保存”按钮，就像之前我们做的“添加”按钮一样。选中按钮项，然后使用属性检查器将其转换为“保存”按钮。

最后，让我们添加“取消”按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其转换为“取消”按钮，就像你之前将“保存”按钮转换一样。你的视图控制器应该像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有“取消”和“保存”按钮的输入视图控制器*

现在再次运行你的应用程序，查看新的按钮！

点击“生日”表格视图控制器上的 + 按钮，应该会带你进入“添加生日”视图控制器，在这里你可以输入一个人的名字和出生日期。点击“取消”和“保存”按钮目前什么都不会发生——我们将在第十章中实现这两个按钮的功能！

### 你学到的内容

在本章中，你通过为“生日”页面和“添加生日”页面创建基本用户界面，开始制作一个生日跟踪器应用。你还使用表格视图控制器创建了“生日”页面，并设置了用户可以通过添加按钮和导航控制器在不同页面之间进行切换。

现在你已经完成了应用的基本骨架，接下来将在第十章中编写代码，完成“取消”和“保存”按钮的功能，以便你能在应用中添加并保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项是禁用的。这是苹果的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。![图片](img/Image00001.jpg)

BirthdayTracker 应用帮助你通过将生日保存到列表中并提醒你来跟踪朋友的生日。我们将在接下来的五章中构建这个应用。本章中，我们将向你展示如何设置用户看到的应用部分。

我们将制作两个屏幕：一个显示生日列表，一个允许你将某人的姓名和生日添加到列表中。然后，在第十章到第十三章中，我们将向你展示如何获取用户输入，显示生日，保存生日，并在某人生日时通过通知提醒用户。

你准备好制作应用了吗？开始吧！

### 你的应用概述

在本章结束时，我们将为 BirthdayTracker 创建两个屏幕。我们将这两个屏幕分别称为“生日”和“添加生日”屏幕，如图 9-1 所示。

![图片](img/Image00196.jpg)

*图 9-1：我们将在接下来的几章中构建的完成应用界面*

生日屏幕会显示你已添加的生日列表，而添加生日屏幕则是你可以添加新的生日条目的地方。

在 Xcode 中，一个屏幕包含一个 *视图* 和一个 *视图控制器*。视图是你在屏幕上看到的内容，而视图控制器包含所有控制视图的 Swift 代码。在图 9-1 中，你可以看到生日视图的右上角有一个加号（+）形状的“添加”按钮。

“添加”按钮将会弹出添加生日视图，用户可以在其中输入新朋友的生日信息。让我们从为我们的 BirthdayTracker 创建一个新的 Xcode 项目开始吧。

### 创建一个新的 Xcode 项目

到目前为止，你一直在游乐场中编写大部分代码。游乐场是一个学习编程的好地方，但要编写可以在 iPad 或 iPhone 上运行的应用，你需要创建一个 Xcode 项目，就像你在第一章中为 Hello World 应用创建的那样。

在 Xcode 菜单中，依次选择 **文件** ▸ **新建** ▸ **项目**。在对话框的顶部选择 **iOS**，然后选择 **单视图应用** 作为项目模板，接着点击 **下一步**。

在出现的对话框中，Xcode 会要求你为新应用设置几个选项。由于这是一个示例，你不需要 *太* 严肃地对待这一部分。设置这些值在你编写计划销售或在 App Store 分发的应用时才更为重要。为你的应用命名为 **BirthdayTracker**，确保语言选择为 **Swift**，设备设置为 **iPhone**，并勾选 **使用核心数据**。你的组织名称和组织标识符应该已预填充为你在第一章创建 Hello World 应用时输入的值。

点击**下一步**。在弹出的对话框中，选择你要保存项目的位置并点击**创建**。你的 Xcode 项目应该会自动打开。花点时间确保在项目导航器中列出了一个名为*BirthdayTracker.xcdatamodeld*的文件（参见图 9-2）。

![Image](img/Image00197.jpg)

*图 9-2：确保你的新项目中有一个* BirthdayTracker.xcdatamodeld *文件。*

你需要*BirthdayTracker.xcdatamodeld*来在 iPhone 上保存生日。如果它丢失了，意味着你在创建 Xcode 项目时没有勾选“使用核心数据”选项。别担心，这很容易修复。

如果你的*BirthdayTracker.xcdatamodeld*丢失了，关闭你的项目（文件 ▸ 关闭项目），然后重新开始，创建一个勾选了“使用核心数据”选项的新 Xcode 项目。当系统提示你是否要替换 BirthdayTracker 项目时，只需点击**替换**，你就准备好了！

你的新 BirthdayTracker Xcode 项目将会打开。如果你还没有将 Apple 账户添加到 Xcode，你会在应用设置的“签名”部分看到一条消息，显示“未找到账户”。除非你想在真实设备上运行应用，否则你不需要添加账户。（记住，你也可以在 Xcode 的模拟器上运行你的应用。）要将你的 Apple 账户添加到 Xcode，点击**添加账户**按钮。（有关添加 Apple 账户的详细说明，请参阅 “你的第一个应用！” 第 5 页。）

这个“常规”设置界面也是你设置应用运行设备方向的地方。我们希望 BirthdayTracker 应用只在*竖屏*模式下运行。竖屏模式是手机的常规方向，底部是 home 键。*横屏*模式是将手机转为侧向，屏幕也会旋转，宽度变成手机的高度，屏幕的高度变成手机的宽度。BirthdayTracker 应用在横屏模式下看起来不好，所以我们不会在用户将手机横过来的时候让屏幕旋转。虽然应用倒置也能正常显示，但如果屏幕在用户把手机倒转（home 键在顶部）时翻转，会让用户感到困惑，因此我们也不会支持倒置模式。在“部署信息”部分，找到设备方向，取消勾选**横屏左**和**横屏右**，确保只有**竖屏**被勾选。

让我们来看看 Xcode。选择左侧导航面板中的*ViewController.swift*，你应该会看到类似图 9-3 的内容。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航面板 ➊，你可以通过选择**视图** ▸ **导航器** ▸ **隐藏/显示导航器**或按⌘-0 来隐藏或显示它。你将使用导航器来选择并查看项目中的文件。

编辑器面板位于窗口的中间 ➋。这是你编写代码的地方！这里也是你可以更改应用程序设置并使用故事板布局将在应用中显示的项目的地方，正如你在第一章中看到的那样。我们稍后会详细讨论故事板。

右侧是实用工具面板 ➌，你可以通过选择**视图** ▸ **实用工具** ▸ **隐藏/显示实用工具**或按⌘-OPTION-0 来隐藏或显示它。当故事板打开时，实用工具面板将允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用程序都有某种图标，显示在用户设备的主屏幕上。我们将通过添加应用图标来开始我们的 BirthdayTracker 应用程序。你可以从*[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)*下载我们将用于图标的两张图片。下载 ZIP 文件后，你会在*Downloads*文件夹中找到一个名为*ch9-images*的文件夹，其中包含所需的图片文件。一旦你获取到这些文件，选择项目导航器中的*Assets.xcassets*。这将打开应用程序的*资源目录*，在这里你可以添加应用程序将使用的任何*资源*（图片、声音等），包括应用图标。实际上，资源目录已经有一个占位符，你可以在这里添加图标。选择目录左侧的**AppIcon**，你应该会看到几个图片的占位符。

要添加将在 iPhone 主屏幕上显示的应用图标，你需要提供标记为*iPhone App*的图标集的 2x 和 3x 图像。2x 尺寸适用于大多数 iPhone，如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸的图像。你将在第十四章中了解有关为不同屏幕分辨率调整图像大小的更多信息。

向资源目录添加图标非常简单！下载提供的图片后，在 Finder 中打开*Downloads*文件夹。然后只需将图片*cake@2x.png*拖到 iPhone App 2x 框中，将*cake@3x.png*拖到 3x 框中。完成后，你的资源目录应该像图 9-4 一样。

![图片](img/Image00200.jpg)

*图 9-4：现在我们有了应用图标！*

除了应用图标，应用程序还具有一个显示名称，该名称显示在主页图标下方。默认情况下，这个名称就是应用名称，BirthdayTracker。然而，这个名称有点太长，无法放下图标下方，因此我们将其更改为一个更短的名称：Birthdays。要做到这一点，请通过在项目导航器中选择 BirthdayTracker 项目返回设置页面。在顶部的身份部分，你可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这只会更改显示在应用图标下方的名称。你的项目名称仍将是 BirthdayTracker。

现在我们已经设置好了应用图标和显示名称，接下来让我们创建应用屏幕！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。在这里，我们将设计应用程序的*用户界面*。用户界面是用户用来与应用程序互动的视觉元素——图像、文本、按钮等。*故事板*让你可以直观地组织应用的屏幕。我们将使用故事板查看所有使用的屏幕以及它们之间的连接。

一旦你选择了*Main.storyboard*，按下⌘ -0 隐藏导航窗格，以便有更多的屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在看一下工具窗格的顶部。你应该会看到一个带有六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更仔细查看故事板元素并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它会出现在工具窗格中。

**检查故事板项**

图 9-5 显示了当故事板打开时，工具窗格中出现的检查器选择条的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：你可以在故事板的工具窗格中使用六个检查器。*

让我们从左到右浏览检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书中以及你大多数应用程序中，你不会使用这个检查器。

下一个检查器，用一个问号图标表示，是快速帮助检查器。这个检查器会提供有关你当前在故事板中选择的项的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里，你可以为故事板项设置自定义类。

接下来的两个检查器是你在工作时最常使用的，我们在文本中会频繁提到它们。属性检查器的图标看起来像一个盾牌。这个检查器用于设置故事板中选定项目的各种属性。它可以用来设置标签的文本、按钮的颜色，或者文本输入框周围显示的框的类型。例如。尺寸检查器，带有尺子图标，用于设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，图标看起来像一个箭头在一个圆圈里。这个检查器可以用来将故事板中的项目与您在类中编写的代码片段连接起来。我们将在第十章中向您展示如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是“生日”视图控制器。这将是一个特殊的视图控制器类，用于显示一个列表，在 Xcode 中称为*表格视图控制器*。在我们的应用中，表格视图控制器将显示你朋友的生日列表！目前它看起来只是一个空白屏幕，稍后你将在“创建生日表格视图控制器”一节学习如何显示生日数据，第 156 页。

让我们将一个表格视图控制器添加到故事板中。如果你先从故事板缩小视图，这一步会更容易，这样你就可以更好地看到视图控制器。双击视图控制器外部的空白区域即可实现此操作。现在你的屏幕应该已经缩小了。

在“实用工具”面板的底部，有一个顶部有四个按钮的区域。选择第三个按钮，它看起来像一个圆圈内的正方形。这是对象库，在这里你可以找到可以添加到故事板中的项目。滚动浏览对象库列表，直到找到“表格视图控制器”，或者使用面板底部的过滤栏搜索“table view controller”。然后点击并拖动该对象到你的故事板上。将其放置在已经存在的视图控制器旁边。你的故事板应该像图 9-6 中所示的那样。

请注意，在你添加表格视图控制器后，左侧大纲视图中会出现一个表格视图控制器场景条目，里面有一个表格视图控制器。故事板中的场景代表应用程序中屏幕上的一个区域。对于 iPhone 应用，通常一次屏幕上只有一个场景，并且该场景填满整个屏幕。iPad 应用可以同时在屏幕上显示两个或更多场景。

![Image](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到生日屏幕的故事板中*

下一步是让这个新的视图控制器成为当你运行应用时显示的第一个屏幕，因为我们希望用户打开应用时能够看到生日列表。实现这个目标的步骤请参考图 9-7。

![Image](img/Image00203.jpg)

*图 9-7：在左侧的大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后在工具面板中打开属性检查器 ➋。在那里，勾选**是初始视图控制器** ➌。完成后，在故事板中，表格视图控制器的左侧应该会出现一个箭头。这个箭头表示应用在启动时会显示这个视图控制器。

#### 添加导航控制器

现在我们将为视图控制器添加一个标题，显示“生日”，并添加一个“添加”按钮，用来显示添加生日的视图控制器。为此，我们首先要将表格视图控制器嵌入到一个*导航控制器*中。导航控制器管理一个或多个视图控制器，它带有一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且两侧有按钮用于导航到应用中的其他屏幕。你在许多 iOS 应用中看到过这种导航栏，比如“设置”应用和“信息”应用。

在大纲视图中选择**表格视图控制器**。选中后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。选择**编辑** ▸ **嵌入** ▸ **导航控制器**。

在表格视图控制器嵌入到导航控制器后，你的故事板应该像图 9-8 中那样。导航控制器将作为一个屏幕显示在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表应用中用户将看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像一个独立的屏幕，实际上导航控制器只是一个容器，包含了用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在不同的视图之间进行导航，并可以返回。

您应该会看到导航控制器和表格视图控制器顶部的灰色导航栏。当应用程序运行时，导航栏会告诉用户他们所在屏幕的标题，并可能包含按钮和箭头，用户可以用它们跳转到其他屏幕。为了使用导航栏告诉用户当前屏幕的标题，我们需要为屏幕添加标题。现在是缩放回故事板的好时机。双击故事板的空白处进行缩放，然后滚动视图，直到您可以看到表格视图控制器。要为表格视图控制器添加标题，请点击大纲视图中**表格视图控制器场景**下的**导航项**。

![图片](img/Image00205.jpg)

当选择此项时，您可以在右侧的属性检查器中输入屏幕的标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。完成此步骤并按下 RETURN 后，您应该会看到大纲视图中的表格视图控制器条目自动更新为“生日场景”。

接下来，我们将创建一个“添加”按钮，以便您可以添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并将生日添加到该列表中。让我们创建一个按钮，允许他们这样做！

我们需要在导航栏中添加一个按钮，跳转到“添加生日”场景，以便用户可以输入生日。找到对象库中的“条形按钮项”，然后将其拖放到表格视图控制器导航栏的右侧，如图 9-9 所示。

现在，我们希望将这个按钮变成一个“添加”按钮。幸运的是，Xcode 内置了一个我们可以使用的添加按钮。在属性检查器中，将导航栏按钮项的系统项更改为**添加**。您应该会看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮在点击时应该做什么。我们希望它打开“添加生日”视图控制器，因此我们需要将“添加”按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保您能看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的空视图控制器。按住 CONTROL 键，然后从+按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标。这将弹出一个连接对话框，类似于图 9-10 中所示。

![图片](img/Image00206.jpg)

*图 9-9：将一个“条形按钮项”拖到“生日”视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到邻近的视图控制器，并在弹出的对话框中选择“模态呈现”。*

连接对话框为你提供了多种类型的 *segue*——即从一个界面到另一个界面的过渡——选项。点击连接对话框中的 **Present Modally** 选项，这将使视图控制器以 *模态* 视图控制器的形式出现在屏幕上。在 iPhone 上，模态视图控制器从手机底部滑上屏幕，并且不会自动带有返回按钮返回到上一个屏幕。相反，模态视图可以有其他按钮，比如取消或保存。还有其他类型的 segue，比如 Show segue，它会将视图控制器从右侧推入屏幕，并且在导航栏左侧有返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的界面时，应该以模态窗口的形式展示，并且有一个取消按钮。否则，如果你使用类似 Show segues 带返回按钮的方式，可能会出现用户输入了所有内容后，点击返回按钮却没有保存任何内容的情况！而有了取消按钮，用户必须故意点击才能退出界面。

要查看模态输入视图控制器的一个好例子，看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它添加日历事件。点击 + 按钮会弹出一个模态的新增事件视图控制器。这个视图控制器左侧有一个取消按钮，点击可以不保存直接退出界面，右侧有一个添加按钮，点击可以在关闭模态窗口之前创建新事件。你应该能看到新增事件的模态窗口从底部滑入屏幕，关闭时则滑回底部。我们希望用户保存生日，因此我们也将使用模态窗口。

现在让我们试着运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先选择一个设备模拟器，点击 Xcode 左上角列出的 BirthdayTracker 旁边的设备（参见 图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角，应用名称旁边设置模拟器的设备类型。这里，设备被设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。在选择了模拟器后，点击左上角的播放按钮，或使用快捷键 ⌘ -**R**。

当模拟器启动以运行你的应用时，如果它太大，无法适应你的计算机屏幕，你可以调整它的大小。点击模拟器进行选择，然后转到 **Window** ▸ **Scale**，在模拟器菜单中选择一个较小的比例。

到目前为止，当您运行应用时，应该不会有太多变化。您应该能看到您的第一个“生日”屏幕，上面有一个 + 按钮，如 图 9-1 中所示。显然，这时您的“生日”屏幕是空的。点击 + 按钮将弹出第二个空白屏幕。查看完应用后，点击 Xcode 中的停止按钮关闭它，停止按钮位于您之前按下的播放按钮旁边。当您停止应用时，您应该会看到应用图标出现在模拟器的主屏幕上！（参见 图 9-12。）

就这样！我们现在需要配置第二个屏幕，以便可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，您需要将其嵌入到一个独立的导航控制器中。当一个视图控制器是模态时，它不会继承我们故事板中已经存在的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击故事板中的普通视图控制器来选择它。然后，转到 **编辑** ▸ **嵌入到** ▸ **导航控制器**。现在，您应该能看到在视图控制器场景下的概览视图中添加了一个导航项。点击这个新添加的导航项，然后在属性检查器中添加标题 **添加生日**。这些步骤与您在表视图控制器中添加“生日”标题时的操作相同。

现在，当“添加生日”视图控制器在应用中显示时，它将在顶部显示标题。

#### 添加朋友的名字和生日

当您在 第十章 中输入朋友的生日时，您应用中的每一条记录将包含名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些 *输入控件*，让用户能够为每个人输入所有这些信息。输入控件是像文本字段或下拉菜单这样的元素，允许用户向应用中输入数据。我们将首先为所有可以添加的信息添加输入控件标签。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个写着“名字”的标签。这个标签将放置在一个文本字段旁边，您将在其中输入朋友的名字。从对象库中找到并将一个标签对象拖到“添加生日”视图控制器中（参见 图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入 **名字** 作为显示文本，如 图 9-14 所示。

现在我们想使用尺寸检查器来设置标签的大小和位置。在 Xcode 的情节提要中，宽度和高度以*点*为单位进行测量。请注意，1 个点并不等于 1 像素。根据应用运行的设备类型，1 个点可能对应 1 像素、2×2 像素的正方形，或 3×3 像素的正方形。这三个缩放因子分别称为 @1x、@2x 和 @3x（这也是我们设置应用图标时讨论的相同大小）。设备的点分辨率也不相同，可能从 320 点到 1,024 点宽、从 568 点到 1,366 点高不等。

![图片](img/Image00211.jpg)

*图 9-14：制作标签显示* 姓氏

只有最老款的 iPhone 和 iPod 才使用 @1x 缩放因子，并且您将无法在这些型号上运行您的应用（BirthdayTracker 仅支持 iOS 10 及更高版本）。除非您的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，这些设备使用 @3x 缩放因子，否则您的设备很可能使用 @2x 缩放因子。

对象在屏幕上的位置也是基于点来定义的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的距离。（参见 图 9-15）。我们将在每个我们添加到视图控制器的库对象上设置 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签定位到屏幕边缘之外，但仍然为其文本输入框和其他标签及输入框留出足够的空间。在尺寸检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成此操作后，重复这些步骤，将两个标签添加到添加生日的视图控制器中：一个是姓氏标签，一个是出生日期标签。我们需要为其他标签和输入框设置位置，以避免它们重叠。在某些情况下，这可能会变得有些棘手，并可能需要一些时间。对于这个应用程序，我们已经为您计算出了适合放置对象的位置，基于 iPhone 7 屏幕。稍后，我们将解释如何使您的应用适配其他设备。表 9-1 列出了您应该为每个标签设置的尺寸和位置。

表 9-1：视图控制器中的输入标签设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，以便它们垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置需要比下一个最接近的标签大至少 21 个点。由于我们还将输入控件添加到每个标签下方，因此我们已经增大了 y 位置，以适应标签的高度和输入控件的高度。

很棒！现在你的故事板应该像图 9-16 中所示的那样。

![图片](img/Image00214.jpg)

*图 9-16：已向视图控制器添加输入标签。*

接下来，你需要添加两个*文本字段*，它们允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。给这两个文本字段设置表 9-2 中看到的大小和位置。你可以像设置标签一样，使用尺寸检查器来完成。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个叫做*日期选择器*的滚轮控件。这个控件将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以同时包含日期和时间，例如在日历应用中使用的日期选择器（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，日期选择器用于选择日期。*

日期选择器还可以仅显示时间，例如在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这正是我们将在 BirthdayTracker 中使用的。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到出生日期标签下方的视图控制器中。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将这个日期改为您的生日！将日期字段从“当前日期”更改为**自定义**。这样，一个新的框会出现。将这个日期更改为您的生日。

让我们通过运行应用来测试它目前的效果！我们用于输入控件的尺寸在 iPhone 7 屏幕上很合适。因此，选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当您点击“生日”视图控制器上的 + 按钮时，应该会显示添加生日的界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很好，但其他设备呢？选择一个较小的模拟器，比如 iPhone 5s，再次运行应用。您会看到，某些东西看起来不太对。

您添加到故事板的所有元素都已出现，但文本框超出了屏幕的边缘。现在，所有元素都已显示在屏幕上，下一步是让它们适应任何屏幕尺寸。我们将通过一个叫做*自动布局*的工具来完成这一任务。

#### 使用自动布局让您的应用在每个设备上看起来完美

单独的 iPhone 就有三种不同的屏幕尺寸，而且未来可能会有更多尺寸出现。您需要设计应用，让它在任何设备上都能看起来不错。这意味着您需要让应用根据运行应用的设备来调整界面中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的技术来放置屏幕上的元素。您需要在故事板中添加这些约束。

首先，在左侧面板的概览视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕故事板面板的底部，有一个带图标的带状工具栏，位于实用工具面板之前的最右侧是一个两条垂直线之间的三角形图标。将鼠标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击此图标，弹出建议菜单。点击**添加缺失的约束**。^(*) 这样做后，您会看到一堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局使得日期选择器的大小适应屏幕宽度，不会超出边缘。自动布局还会确保每个文本字段前后都有 20 个点的间距，从而使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，添加生日页面应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成设置，我们将展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。按钮现在还不会有任何功能。我们只是设置它们。在 第十章 中，我们将添加一些代码，使它们能够退出添加生日页面并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个栏按钮项，并将其放置在导航栏的 *右侧*。我们将把这个按钮改为保存按钮，就像我们之前对添加按钮所做的那样。选择按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个栏按钮项，这次将它放置在导航栏的 *左侧*。使用属性检查器将其转换为取消按钮，像你之前对保存按钮做的那样。你的视图控制器应该像 图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新按钮！

点击生日表格视图控制器上的 + 按钮，应该会带你到添加生日的视图控制器，在这里你可以输入一个人的姓名和出生日期。点击取消和保存按钮暂时没有任何反应——我们将在 第十章 中实现这两个按钮！

### 你学到了什么

在本章中，你开始制作生日追踪器应用程序，通过创建生日和添加生日页面的基本用户界面。你还使用表格视图控制器创建了生日页面，并使用户可以通过添加按钮和导航控制器在页面之间导航。

现在你已经完成了应用程序的基本框架，接下来将在 第十章 中编写代码，使取消和保存按钮能够让你在应用程序中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失的约束”选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **重置为缺失的约束** 选项以添加缺失的约束。

BirthdayTracker 应用帮助你通过将生日保存到列表中并通过提醒通知你来追踪朋友的生日。我们将在接下来的五章中构建这个应用。在本章中，我们将向你展示如何设置用户可以看到的应用部分。

我们将创建两个屏幕：一个显示生日列表，另一个允许你将一个人的名字和生日添加到列表中。接着，在第十章到第十三章中，我们将向你展示如何获取用户输入、在屏幕上显示生日、保存生日并在某人过生日时通过通知提醒用户。

你准备好制作一个应用了吗？我们开始吧！

### 你的应用概述

在本章结束时，我们将为 BirthdayTracker 创建两个屏幕。我们将这两个屏幕分别称为“Birthdays”屏幕和“添加生日”屏幕，如图 9-1 所示。

![图片](img/Image00196.jpg)

*图 9-1：我们将在接下来的几章中构建的完成应用的预览*

Birthdays 屏幕显示你已添加的生日列表，而“添加生日”屏幕是你可以添加新生日条目的地方。

在 Xcode 中，屏幕包含一个*视图*和一个*视图控制器*。视图是你在屏幕上看到的内容，视图控制器包含了所有用来控制视图的 Swift 代码。你可以在图 9-1 中看到，Birthdays 视图的右上角有一个看起来像加号（+）的添加按钮。

添加按钮将打开添加生日视图，用户可以在这里输入新朋友的生日信息。让我们从为我们的 BirthdayTracker 创建一个新的 Xcode 项目开始吧。

### 创建一个新的 Xcode 项目

到目前为止，你大部分的代码都是在 Playground 中编写的。Playground 是一个学习编程的好地方，但如果要编写一个可以在 iPad 或 iPhone 上运行的应用，你需要创建一个 Xcode 项目，就像你在第一章中为 Hello World 应用所做的那样。

在 Xcode 菜单中，选择 **文件** ▸ **新建** ▸ **项目**。在对话框顶部选择 **iOS**，然后选择 **单视图应用程序** 作为项目模板，接着点击 **下一步**。

在出现的对话框中，Xcode 会要求你为新应用设置一些选项。由于这只是一个示例，你不需要*太*认真对待这部分内容。当你编写一个打算在 App Store 上销售或分发的应用时，设置这些值才会更为重要。将你的应用命名为 **BirthdayTracker**，确保语言选择为 **Swift**，设备类型选择 **iPhone**，并勾选 **使用 Core Data**。你的组织名称和组织标识符应该会预填入你在第一章中为 Hello World 应用输入的值。

点击 **Next**。在弹出的对话框中，选择你希望保存项目的位置，然后点击 **Create**。你的 Xcode 项目应该会自动打开。稍等片刻，确保你在项目导航栏中看到一个名为 *BirthdayTracker.xcdatamodeld* 的文件（参见 图 9-2）。

![图片](img/Image00197.jpg)

*图 9-2：确保你在新项目中有一个* BirthdayTracker.xcdatamodeld *文件。*

你需要 *BirthdayTracker.xcdatamodeld* 来在 iPhone 上保存生日。如果它丢失了，那就意味着你在创建 Xcode 项目时没有勾选“使用 Core Data”框。别担心——这是很容易解决的。

如果你的 *BirthdayTracker.xcdatamodeld* 文件丢失了，关闭你的项目（文件 ▸ 关闭项目），然后重新创建一个新的 Xcode 项目，记得勾选“使用 Core Data”框。当系统询问是否替换 BirthdayTracker 项目时，只需点击 **Replace**，就完成了！

你的新 BirthdayTracker Xcode 项目将会打开。如果你还没有将 Apple 账户添加到 Xcode，你会看到在常规应用设置中的签名部分显示“未找到账户”的信息。除非你想在真实设备上运行应用，否则无需添加账户。（记住，你也可以在 Xcode 的模拟器中运行应用。）要将 Apple 账户添加到 Xcode，点击 **Add Account** 按钮。（关于如何添加 Apple 账户的详细说明，参见 “你的第一个应用！” 第 5 页 。）

这个常规设置界面也是你设置应用程序设备方向的地方。我们希望 BirthdayTracker 应用仅在 *竖屏* 模式下运行。竖屏模式是手机的常规方向，主屏按钮位于底部。*横屏* 模式是将手机侧着转动，屏幕也会旋转，这样屏幕的宽度变成了手机的高度，屏幕的高度变成了手机的宽度。BirthdayTracker 应用在横屏模式下显示效果不好，所以我们不会在用户将手机转为横屏时让屏幕发生变化。应用倒立显示也没问题，但如果用户将手机转过来，主屏按钮在顶部时，屏幕翻转可能会让用户感到困惑，所以我们也不支持倒立显示。在“部署信息”部分，找到设备方向，取消勾选 **Landscape Left** 和 **Landscape Right**，确保只有 **Portrait** 被勾选。

让我们来看看 Xcode。选择左侧导航栏中的 *ViewController.swift*，你应该能看到类似于 图 9-3 的内容。

![图片](img/Image00198.jpg)![图片](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航器面板 ➊ ，你可以通过进入**视图** ▸ **导航器** ▸ **隐藏/显示导航器**或按下⌘ -0 来隐藏或显示它。你将使用导航器来选择和查看项目中的文件。

编辑器面板位于窗口的中央 ➋ 。在这里你将编写代码！这里也是你可以更改应用设置并使用故事板布局显示在应用中的项目的位置，正如你在第一章中看到的。我们很快会进一步讲解故事板。

右侧是实用工具面板 ➌ ，你可以通过选择**视图** ▸ **实用工具** ▸ **隐藏/显示实用工具**或按下⌘ -OPTION -0 来隐藏或显示它。当故事板打开时，实用工具面板将允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都有某种图标，显示在用户设备的主屏幕上。我们将通过添加应用图标来开始我们的 BirthdayTracker 应用。你可以从*[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)*下载我们将用于图标的两张图像。下载 ZIP 文件后，你将在*下载*文件夹中找到名为*ch9-images*的文件夹，其中包含你需要的图像文件。获取这些文件后，从项目导航器中选择*Assets.xcassets*。这将打开应用的*资产目录*，在这里你可以放入任何应用将使用的*资产*（图像、声音等），包括应用图标。实际上，资产目录已经提供了一个占位符，你可以在其中添加图标。从目录左侧的菜单中选择**AppIcon**，你应该能看到几个图像占位符。

要添加一个将在 iPhone 主屏幕上显示的应用图标，你需要为标记为*iPhone App*的图标集提供 2x 和 3x 图像。2x 大小适用于大多数 iPhone，如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，使用 3x 大小的图像。在第十四章中，你将学习如何为不同屏幕分辨率调整图像的大小。

将图标添加到资产目录很容易！下载提供的图像后，打开 Finder 中的*下载*文件夹。然后，只需将图片*cake@2x.png*拖到 iPhone 应用 2x 框中，将*cake@3x.png*拖到 3x 框中。完成后，你的资产目录应该像图 9-4 一样。

![图片](img/Image00200.jpg)

*图 9-4：我们现在有了应用图标！*

除了应用图标，应用还会有一个显示名称，这个名称会显示在主页面图标下方。默认情况下，这个名称就是应用名称 BirthdayTracker。然而，这个名称有点太长，无法完全显示在图标下方，所以我们将其更改为一个更短的名称：Birthdays。为此，返回设置页面，在项目导航器中选择 BirthdayTracker 项目。在顶部的身份部分，您可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这将仅更改显示在应用图标下方的名称。项目的名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，让我们来创建应用的屏幕！

### 显示您的朋友生日

从项目导航器中选择*Main.storyboard*，打开故事板。这是我们设计*用户界面*的地方。用户界面只是一个花哨的名称，指的是用户将在其中看到并与之交互的所有元素——图像、文本、按钮等。*故事板*允许您以视觉方式组织应用的屏幕。我们将使用故事板查看所有使用的屏幕以及它们之间的连接。

选择了*Main.storyboard*后，按⌘ -0 隐藏导航窗格，以便为屏幕腾出更多空间。您的故事板应该已经包含一个视图控制器。

现在看看实用工具窗格的顶部。您应该会看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助您更仔细地查看故事板中元素的工具，并允许您更改这些元素的设置。当您选择其中一个检查器时，它会出现在实用工具窗格中。

**检查故事板项**

图 9-5 显示了当故事板打开时，在实用工具窗格中出现的检查器选择栏的特写视图。

![图片](img/Image00201.jpg)

*图 9-5：在故事板的实用工具窗格中，您可以使用六个检查器。*

让我们从左到右依次了解这些检查器。页面图标打开文件检查器。在这里，您可以更改故事板文件的设置。在本书中以及大多数应用中，您不会使用此检查器。

下一个检查器是带有问号图标的快速帮助检查器。这个检查器会为您提供当前在故事板中选择的项的详细类信息。

第三个检查器是带有身份证图标的身份检查器。在这里，您可以为故事板项目设置自定义类。

接下来的两个检查器是你在工作中最常用的，它们将在文本中频繁出现。属性检查器的图标像一个盾牌。这个检查器用于设置故事板中所选项的各种属性。例如，可以用它来设置标签的文本、按钮的颜色，或文本输入框周围显示的框的类型。尺寸检查器则带有一个尺子的图标，用来设置每个故事板项的大小和屏幕位置。

最后是连接检查器，它的图标看起来像一个圆圈中的箭头。这个检查器可以用来将故事板中的项连接到你在类中编写的代码部分。我们将在第十章中向你展示如何实现这一点。

#### 添加表格视图控制器

我们的第一个视图控制器将是“生日”视图控制器。这将是一个特殊类型的视图控制器，显示一个列表，在 Xcode 中叫做*表格视图控制器*。在我们的应用中，表格视图控制器将展示你朋友们的生日列表！现在它看起来只是一个空白屏幕，之后你将学习如何在“创建生日表格视图控制器”（第 156 页）中显示生日数据。

让我们将表格视图控制器添加到故事板中。如果你先将故事板缩小，这个步骤会更容易，这样你可以更好地查看视图控制器。双击视图控制器外部的空白区域来实现这个操作。现在，你的屏幕应该已缩小。

在工具面板的底部，有一个顶部带四个按钮的区域。选择第三个按钮，它看起来像一个圆圈中的方形。这是对象库，你可以在这里找到可以添加到故事板中的项。浏览对象库列表，直到找到“表格视图控制器”，或者使用面板底部的筛选栏搜索“table view controller”。然后点击并拖动该对象到你的故事板上，将它放在已经存在的视图控制器旁边。你的故事板应该像图 9-6 中的样子。

注意，在你添加表格视图控制器后，左侧大纲视图中会出现一个“表格视图控制器场景”条目，其中包含一个表格视图控制器。故事板中的场景代表应用屏幕上的一个区域。对于 iPhone 应用，通常一次屏幕上只有一个场景，而且该场景会填满整个屏幕。而 iPad 应用可以在屏幕上同时显示两个或更多场景。

![图片](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到“生日”屏幕的故事板中*

下一步是将这个新视图控制器设置为应用启动时首先显示的屏幕，因为我们希望在用户打开应用时，显示生日列表。执行这些步骤的过程请参考图 9-7。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊ 。然后在工具面板中打开属性检查器 ➋ 。在此，勾选**是初始视图控制器** ➌ 。完成此操作后，你的表格视图控制器左侧应该会出现一个箭头。这个箭头意味着当应用启动时，将显示该视图控制器。

#### 添加导航控制器

现在我们将向视图控制器添加一个标题“Birthdays”，以及一个“添加”按钮，该按钮将弹出添加生日视图控制器。为了实现这一点，我们首先将表格视图控制器嵌入到一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧提供按钮，用于导航到应用中的其他屏幕。你在多个 iOS 应用中都可以看到这个导航栏，例如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。选择后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。路径是**编辑** ▸ **嵌入** ▸ **导航控制器**。

在将表格视图控制器嵌入到导航控制器之后，你的故事板应该像图 9-8 中所示那样。导航控制器会显示为故事板中的一个屏幕。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表用户将在应用中看到的一个屏幕，但导航控制器略有不同。尽管它看起来像是故事板中的一个独立屏幕，但导航控制器实际上只是一个容器，用于存放用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在不同的视图之间导航。

你应该能看到导航控制器和表格视图控制器顶部的灰色导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，还可能包含按钮和箭头，用户可以使用这些按钮和箭头跳转到其他屏幕。为了利用导航栏告诉用户当前所在的屏幕，我们需要为屏幕添加标题。现在是时候放大故事板了。双击故事板的空白处进行放大，然后滚动视图，直到你能看到表格视图控制器。为了给表格视图控制器添加标题，点击左侧大纲视图中的**Table View Controller Scene**下的**Navigation Item**。

![图片](img/Image00205.jpg)

选择此项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的“Title”字段中输入**Birthdays**。你会看到，当你完成此步骤并按下 RETURN 键后，左侧大纲视图中的 Table View Controller Scene 条目会自动更新为 Birthdays Scene。

接下来，我们将添加一个按钮，便于你添加生日！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将生日添加到该列表中。让我们制作一个按钮，让他们能够实现这个功能！

我们需要在导航栏上添加一个按钮，跳转到“添加生日”场景，以便用户可以输入生日。在对象库中找到“Bar Button Item”，然后将其拖放到表格视图控制器的导航栏右侧，如图 9-9 所示。

现在我们要把这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮。打开属性检查器，将栏按钮项目的系统项更改为**Add**。你应该会看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮点击时执行的操作。我们希望它打开“添加生日”视图控制器，因此需要将添加按钮与该视图控制器连接起来。首先，双击故事板进行缩小，以确保你可以看到生日表格视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，并从+按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器高亮显示时，松开鼠标。这将弹出一个连接对话框，如图 9-10 所示。

![图片](img/Image00206.jpg)

*图 9-9：将 Bar Button Item 拖动到生日视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，然后在弹出的对话框中选择“模态呈现”。*

连接对话框提供了几个选项，用于选择你想要在两个视图控制器之间进行的*segue*（即从一个屏幕到另一个屏幕的过渡）。点击连接对话框中的**Present Modally**选项。这将使视图控制器以*模态*视图控制器的形式呈现在屏幕上。在 iPhone 上，模态视图控制器会从手机底部滑入屏幕，而且它不会自动带有返回按钮来返回到前一个屏幕。相反，模态视图可以有其他按钮，例如取消或保存。还有其他类型的 segue，例如 Show segue，其中视图控制器从右侧推入屏幕，并且在导航栏左侧有一个返回按钮。

在 iOS 应用中，当你呈现一个用于获取和保存用户输入的屏幕时，应该以模态方式显示该屏幕，并且带有取消按钮。否则，如果你使用类似 Show segue 的方式并带有返回按钮，可能会出现用户输入完所有内容后，点击返回按钮而没有保存任何内容的情况！有了取消按钮，用户必须故意点击来取消退出屏幕。

要查看一个良好的模态输入视图控制器的示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧会有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以退出屏幕而不保存，右侧有一个添加按钮，可以在关闭模态视图之前创建新事件。你应该看到，新事件模态视图从屏幕底部滑入，取消时又滑回到底部。我们希望用户能够保存生日，所以我们也会使用模态视图。

现在让我们尝试运行我们的应用，看看我们迄今为止做了什么！要运行应用，首先选择一个设备模拟器，方法是点击 Xcode 左上角 BirthdayTracker 旁边列出的设备（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角应用名称旁边设置模拟器运行的设备。这里设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果它的尺寸太大，无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器进行选择，然后转到**窗口** ▸ **缩放**，在模拟器菜单中选择较小的比例。

到目前为止，当你运行应用时，不会发生太多变化。你应该会看到你的第一个生日屏幕，并带有一个+按钮，如图 9-1 所示。显然，在这一点上，你的生日屏幕将是空的。点击+按钮会弹出第二个空白屏幕。查看完应用后，通过点击 Xcode 中的停止按钮来关闭它，这个按钮就在你之前点击的播放按钮旁边。当你停止应用时，你应该会在模拟器的主屏幕上看到你的应用图标！（见图 9-12）

就这样！我们现在需要配置第二个屏幕，以便它可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控件输入和标签

让我们从为“添加生日”视图控制器添加标题开始。为此，你需要将它嵌入到一个独立的导航控制器中。当一个视图控制器是模态视图时，它不会继承我们故事板上已经存在的导航控制器的导航栏。导航控制器提供了导航栏，所以我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的普通视图控制器来选择它。然后，进入**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在你应该能看到一个导航项已经被添加到视图控制器场景下的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与之前为你的表格视图控制器添加标题“生日”时的步骤相同。

现在，当“添加生日”视图控制器在应用中显示时，它将显示在顶部的标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每个条目将包括名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，让用户能够输入这些信息。输入控件类似于文本框或下拉菜单，允许用户将数据输入到应用中。我们将通过添加所有用户可以添加的信息的输入控件标签来开始。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器做一个显示“名字”的标签。这个标签将放在一个文本框旁边，你可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框，输入**名字**作为显示文本，如图 9-14 所示。

现在我们想使用大小检查器来设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点（points）*为单位的。请注意，1 点并不等于 1 像素。根据应用运行的设备类型，1 点可能会转换为 1 像素、2×2 像素的方块或 3×3 像素的方块。这三个缩放因子分别称为 @1x、@2x 和 @3x（我们在设置应用图标时也提到了这些大小）。不同的设备也有不同的点分辨率，宽度从 320 到 1,024 点不等，身高从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最旧的 iPhone 和 iPod 型号使用 @1x 缩放因子，而且你将无法在这些型号上运行应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的 iPhone 6 Plus、6s Plus 或 7 Plus 使用 @3x 缩放因子，否则你的手机或 iPod 很可能使用 @2x 缩放因子。

对象在屏幕上的位置也是基于点数的。对象的 x 位置是从屏幕左侧到对象左侧的距离，单位为点。y 位置是从屏幕顶部到对象顶部的距离。（见图 9-15。）我们将设置每个我们添加到视图控制器的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕边缘之外，但仍然为其文本输入框和其他标签及输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成此操作后，重复这些步骤以在“添加生日”视图控制器中添加两个标签：Last Name 标签和 Birthdate 标签。我们需要定位其他标签和输入框，以确保它们不会重叠。在某些情况下，这可能会变得有些棘手，并可能需要一些时间。对于这个应用，我们已经为你计算好了 iPhone 7 屏幕上的位置。稍后，我们将解释如何使应用程序适配其他设备。表 9-1 列出了每个标签应设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| First Name | 20 | 100 | 100 | 21 |
| Last Name | 20 | 170 | 100 | 21 |
| Birthdate | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，这样它们就能垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置必须比下一个最接近的标签高至少 21 个点。由于我们也将输入控件添加在每个标签下方，所以我们已将 y 位置调整得更大，以适应标签的高度和输入控件的高度。

太棒了！现在你的故事板应该像图 9-16 中的一样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本框*，让你可以输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本框对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。为这两个文本框设置表 9-2 中看到的尺寸和位置。你可以像设置标签一样，使用尺寸检查器进行设置。

表 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做*日期选择器*的控件。这个控件可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像日历应用中使用的日期选择器（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，像时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这正是我们在生日追踪器中使用的功能。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到视图控制器中，放置在“出生日期”标签下。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。我们来把这个日期改成你的出生日期！将日期字段从“当前日期”改为**自定义**。这样，一个新框将出现。将这个日期改为你的出生日期。

让我们通过运行应用程序来测试到目前为止应用的表现！我们为输入控件使用的尺寸在 iPhone 7 屏幕上适配得很好。所以选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这次，当你点击生日视图控制器上的 + 按钮时，应该会显示“添加生日”界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很不错，但其他设备呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，然后再次运行应用程序。你会发现，某些地方看起来不太对劲。

所有你添加到故事板中的元素都显示出来了，但文本字段超出了屏幕的边缘。现在，所有元素都已经出现在屏幕上，下一步是确保它们在任何屏幕尺寸上都能正确适配。我们将使用一个叫做*自动布局*的工具来完成这一步。

#### 让你的应用在每个设备上看起来完美——使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能会有更多的尺寸出现。你需要设计你的应用程序，使它在任何设备上看起来都很棒。这意味着你需要让应用程序根据设备调整所有内容的位置和尺寸。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的提纲视图中选择**视图控制器**。接下来，看看编辑面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标来打开自动布局菜单。*

在屏幕的故事板面板底部有一个带图标的带状区域，最右侧的图标是两个垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，上面写着“解决自动布局问题”。点击这个图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到一堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局会确保日期选择器的大小适应屏幕宽度，并且不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点的间距，以便它们能够在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这一次，“添加生日”页面应该显示完美。

#### 添加保存和取消按钮

为了完成这部分内容，我们将展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。按钮暂时不会做任何事情，我们只是进行设置。在第十章中，我们将添加一些代码，使它们能够取消添加生日屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮更改为保存按钮，像我们处理添加按钮一样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，像处理保存按钮一样。你的视图控制器应该看起来像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在重新运行你的应用，看看新按钮的效果！

在生日表视图控制器中点击 + 按钮应该会带你到添加生日视图控制器，在这里你可以输入一个人的姓名和出生日期。点击取消和保存按钮暂时没有任何作用——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个生日追踪器应用，创建了“生日”页面和“添加生日”页面的基本用户界面。你还使用表视图控制器创建了“生日”页面，并使用户能够通过添加按钮和导航控制器在页面之间进行切换。

现在你已经完成了应用的基本骨架设计，在第十章中，你将编写代码以实现取消和保存按钮，从而可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项是禁用的，这是一个 Apple 的 Bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

我们将制作两个屏幕：一个显示生日列表，另一个让你向列表中添加一个人的姓名和生日。接着，在 第十章 到 第十三章 中，我们将教你如何获取用户输入，显示生日，保存生日，并在某人生日时通过通知提醒用户。

你准备好制作一个应用了吗？让我们开始吧！

### 你的应用概览

本章结束时，我们将有两个屏幕：一个用于显示生日列表，另一个用于添加新的生日条目。我们将这两个屏幕称为“生日”和“添加生日”屏幕，如 图 9-1 所示。

![Image](img/Image00196.jpg)

*图 9-1：我们将在接下来的几章中构建的完成应用的预览*

生日屏幕会显示你已经添加的生日列表，而添加生日屏幕则是你可以添加新生日条目的地方。

在 Xcode 中，一个屏幕包括 *视图* 和 *视图控制器*。视图是你在屏幕上看到的内容，而视图控制器包含控制视图的所有 Swift 代码。你可以在 图 9-1 中看到，生日视图的右上角有一个看起来像加号（+）的添加按钮。

添加按钮会弹出“添加生日”视图，用户可以在此输入新朋友的生日信息。让我们通过为 BirthdayTracker 创建一个新的 Xcode 项目开始吧。

### 创建一个新的 Xcode 项目

到目前为止，你大部分代码都写在了 playground 中。playground 是一个学习编程的好地方，但要编写一个能在 iPad 或 iPhone 上运行的应用，你需要像创建《Hello World》应用时一样，创建一个 Xcode 项目，详见 第一章。

在 Xcode 菜单中，选择 **文件** ▸ **新建** ▸ **项目**。在对话框顶部选择 **iOS**，然后选择 **单视图应用** 作为项目模板，点击 **下一步**。

在出现的对话框中，Xcode 会要求你为新应用设置一些选项。由于这只是一个示例，你不需要 *太* 认真对待这一部分。当你写一个打算出售或在 App Store 上分发的应用时，设置这些值会更为重要。给你的应用命名为 **BirthdayTracker**，确保语言选择 **Swift**，设备类型选择 **iPhone**，并勾选 **使用 Core Data** 选项。你的组织名称和组织标识符应当会自动填入你在创建《Hello World》应用时输入的值，详情见 第一章。

点击 **下一步**。在打开的对话框中，选择你希望保存项目的位置，然后点击 **创建**。你的 Xcode 项目应该会自动打开。花点时间确认你的项目导航器中有一个名为 *BirthdayTracker.xcdatamodeld* 的文件（见 图 9-2）。

![Image](img/Image00197.jpg)

*图 9-2：确保你的新项目中有一个* BirthdayTracker.xcdatamodeld *文件。*

你需要*BirthdayTracker.xcdatamodeld*来在 iPhone 上保存生日。如果它缺失，这意味着你在创建 Xcode 项目时没有勾选使用 Core Data 的选项。别担心——这是很容易解决的。

如果你的*BirthdayTracker.xcdatamodeld*缺失，关闭你的项目（文件 ▸ 关闭项目），然后重新创建一个勾选了使用 Core Data 的新 Xcode 项目。当你被问到是否要替换 BirthdayTracker 项目时，只需点击**替换**，你就准备好啦！

你的新生日追踪器 Xcode 项目将会打开。如果你还没有将你的 Apple 账号添加到 Xcode 中，你将在“常规”应用设置的“签名”部分看到一条消息，提示“未找到账户”。除非你想在实际设备上运行应用，否则不需要添加账户。（记住，你也可以在 Xcode 的模拟器上运行你的应用。）要将你的 Apple 账号添加到 Xcode 中，请点击**添加账户**按钮。（关于如何添加 Apple 账户的详细说明，请参阅 “你的第一款应用！” 第 5 页 。）

这个常规设置屏幕也是你设置应用运行设备方向的地方。我们希望生日追踪器应用只在*竖屏*模式下运行。竖屏模式是手机的常规方向，主屏幕按钮位于底部。*横屏*模式是当你将手机旋转到侧面时，屏幕也会旋转，此时屏幕的宽度变成了手机的高度，屏幕的高度变成了手机的宽度。生日追踪器应用在横屏模式下看起来不太好，所以当用户将手机横过来时，我们不希望屏幕发生变化。即使应用在倒置时看起来也没问题，但如果用户将手机翻转，主屏幕按钮位于顶部时，屏幕会自动翻转，这可能会让用户感到迷惑，因此我们也不支持倒置模式。在“部署信息”部分，找到设备方向选项，取消勾选**横屏左**和**横屏右**，并确保**竖屏**是唯一勾选的选项。

让我们来看看 Xcode。选择左侧导航窗格中的*ViewController.swift*，你应该能看到类似图 9-3 的界面。

![图片](img/Image00198.jpg)![图片](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航窗格 ➊，你可以通过 **视图** ▸ **导航器** ▸ **隐藏/显示导航器** 或按 ⌘ -0 来隐藏或显示它。你将使用导航器来选择和查看项目中的文件。

编辑器窗格位于窗口的中央 ➋。这是你编写代码的地方！这里也是你可以更改应用设置并使用故事板（你在第一章 中看到过）布局将要显示的应用项的地方。我们很快会详细讨论故事板。

右侧是工具面板 ➌，你可以通过选择**视图** ▸ **工具** ▸ **隐藏/显示工具**或按下⌘ -OPTION -0 来隐藏或显示它。当故事板打开时，工具面板将允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都有某种图标，在用户设备的主屏幕上显示。我们将通过为 BirthdayTracker 应用添加一个图标来开始。你可以从*[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)*下载我们将用于图标的两个图像。下载 ZIP 文件后，你将在*Downloads*文件夹中得到一个名为*ch9-images*的文件夹，里面包含你需要的图像文件。获得这些文件后，在项目导航器中选择*Assets.xcassets*。这将打开应用的*资源目录*，这里是你放置应用将使用的任何*资源*（如图像、声音等）的地方，包括应用图标。事实上，资源目录已经带有一个占位符，你可以在这里添加你的图标。选择目录左侧菜单中的**AppIcon**，你应该能看到几个图像的占位符。

要添加一个显示在 iPhone 主屏幕上的应用图标，你需要为图标集提供 2x 和 3x 尺寸的图片，标签为*iPhone App*。2x 尺寸适用于大多数 iPhone，比如 iPhone 5、6 和 7。更大的 iPhone，比如 iPhone 6s Plus 和 iPhone 7 Plus，使用 3x 尺寸的图片。你将在第十四章中学到更多关于不同屏幕分辨率下图像尺寸的知识。

将图标添加到资源目录非常简单！下载提供的图像后，在 Finder 中打开*Downloads*文件夹。然后，只需将图像*cake@2x.png*拖到 iPhone 应用 2x 框中，将*cake@3x.png*拖到 3x 框中。完成后，你的资源目录应该会像图 9-4 一样。

![Image](img/Image00200.jpg)

*图 9-4：我们现在有了一个应用图标！*

除了应用图标，应用还拥有一个显示名称，该名称会显示在主页图标下方。默认情况下，这个名称就是应用名称 BirthdayTracker。然而，这个名称有点长，不能完全适应图标下方，所以我们将其更改为一个更短的名称：Birthdays。要做到这一点，请通过在项目导航器中选择 BirthdayTracker 项目，返回设置页面。在顶部的身份部分，你可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这只会更改显示在应用图标下方的名称。你的项目名称仍然是 BirthdayTracker。

现在我们已经设置好了应用图标和显示名称，接下来让我们创建应用屏幕吧！

### 显示朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。这是我们设计应用程序*用户界面*的地方。用户界面只是用户用来与应用程序互动的元素的统称——包括图像、文本、按钮等。*故事板*让你能够直观地组织应用程序的各个屏幕。我们将使用故事板来查看所有使用的屏幕及它们之间的连接。

一旦你选择了*Main.storyboard*，通过按下⌘-0 隐藏导航窗格，以便获得更多的屏幕空间。你的故事板应该已经包含一个视图控制器。

现在看看实用工具窗格的顶部。你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你仔细查看故事板中元素并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它会出现在实用工具窗格中。

**检查故事板项目**

图 9-5 展示了在打开故事板时，出现在实用工具窗格中的检查器选择条的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：你可以在故事板的实用工具窗格中使用六个检查器。*

从左到右，我们逐一了解这些检查器。页面图标打开文件检查器。这是你可以更改故事板文件设置的地方。在本书中以及大多数应用程序中，你将不会使用这个检查器。

接下来的检查器，图标是一个问号图标，是快速帮助检查器。这个检查器会提供你当前在故事板中选择的项目的详细类信息。

第三个检查器，图标是身份证图标，是身份检查器。在这里你可以为故事板项目设置自定义类。

接下来的两个检查器是你在故事板中工作时最常用的，我们将在文中频繁提到它们。属性检查器的图标看起来像一个盾牌。这个检查器用于设置故事板中所选项目的各种属性。例如，它可以用来设置标签的文本、按钮的颜色，或者文本输入框周围显示的框的类型。大小检查器的图标是一个尺子，用来设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，图标看起来像一个圆圈中的箭头。这个检查器可以用来将故事板中的项目与你在类中编写的代码连接起来。我们将在第十章中向你展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊的视图控制器类，用于显示一个列表，在 Xcode 中叫做*表视图控制器*。在我们的应用中，表视图控制器将显示你朋友的生日列表！现在它看起来只是一个空白屏幕，稍后你将在“创建生日表视图控制器”（第 156 页）中学习如何显示生日数据。

让我们将表视图控制器添加到故事板中。如果你先缩小故事板，这一步会更容易，因为你可以更清楚地看到视图控制器。双击故事板中视图控制器外的空白区域即可进行缩小。现在你的屏幕应该已经缩小了。

在“实用工具”窗格的底部，有一个包含四个按钮的区域。选择第三个按钮，它看起来像一个圆圈内的正方形。这是对象库，在这里你可以找到要添加到故事板的项目。滚动浏览对象库列表，直到找到“表视图控制器”，或者使用窗格底部的筛选栏搜索“table view controller”。然后点击并将该对象拖动到故事板上，放置在已经存在的视图控制器旁边。你的故事板应该看起来像图 9-6 中的示例。

请注意，在添加表视图控制器后，左侧的大纲视图中会出现一个“表视图控制器场景”条目，其中包含一个表视图控制器。故事板中的场景表示应用程序中的一个屏幕区域。对于 iPhone 应用程序，通常一次屏幕上只有一个场景，并且该场景会填满整个屏幕。iPad 应用程序可以同时显示两个或多个场景。

![Image](img/Image00202.jpg)

*图 9-6：将表视图控制器添加到生日屏幕的故事板中*

接下来的步骤是将这个新视图控制器设置为运行应用时第一个显示的屏幕，因为我们希望在用户打开应用时显示生日列表。执行此操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表视图控制器** ➊。然后在“实用工具”窗格中打开属性检查器 ➋。在那里，勾选**是初始视图控制器** ➌。完成后，应该会在故事板中的表视图控制器左侧看到一个箭头。这个箭头表示应用程序在启动时会显示此视图控制器。

#### 添加导航控制器

现在，我们将为视图控制器添加一个标题，显示“Birthdays”，并添加一个“添加”按钮，点击后将弹出添加生日的视图控制器。为了实现这一点，我们首先需要将表视图控制器放入*导航控制器*中。导航控制器管理一个或多个视图控制器，并带有一个*导航栏*，它位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且在左右两侧有按钮，可以让用户在应用中的其他屏幕之间导航。您可以在许多 iOS 应用中看到这种导航栏，比如设置应用和信息应用。

在大纲视图中选择**表视图控制器**。选中它之后，您需要通过 Xcode 菜单将表视图控制器嵌入到导航控制器中。前往 **Editor** ▸ **Embed In** ▸ **Navigation Controller**。

在将表视图控制器嵌入到导航控制器之后，您的故事板应该像图 9-8 一样。导航控制器会在故事板中显示为一个屏幕。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表一个用户在应用中看到的屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像一个单独的屏幕，实际上导航控制器只是一个容器，存放着用户在应用中移动的其他视图控制器。将视图控制器嵌入导航控制器中意味着您的应用可以在不同的视图之间进行导航。

您应该会看到导航控制器和表视图控制器顶部有灰色的导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，并可能包含他们可以用来前往其他屏幕的按钮和箭头。为了利用导航栏告诉用户他们当前所在的屏幕，我们需要为我们的屏幕命名。现在是一个回到故事板的好时机。双击故事板中的空白区域来放大视图，然后滚动查看表视图控制器。要为表视图控制器添加标题，请在左侧的大纲视图中点击**Navigation Item**，它位于**Table View Controller Scene**下。

![图片](img/Image00205.jpg)

选择此项后，您可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。完成此步骤并按下 RETURN 键后，您应该看到大纲视图中的表视图控制器条目自动更新为 Birthdays Scene。

接下来，我们将制作一个“添加”按钮，这样您就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将生日添加到列表中。让我们做一个按钮，让他们可以实现这个功能！

我们需要在导航栏中添加一个按钮，通向“添加生日”场景，以便用户输入生日。找到对象库中的条形按钮项，然后将其拖动并放置到表格视图控制器导航栏的右侧，如图 9-9 所示。

现在我们想把这个按钮改成一个添加按钮。幸运的是，Xcode 提供了一个内置的添加按钮供我们使用。在属性检查器中，将条形按钮项的系统项目改为**添加**。你应该能看到按钮变成了一个加号 (+)。

接下来，我们需要告诉按钮在被点击时应该做什么。我们希望它打开“添加生日”视图控制器，所以我们需要将添加按钮与该视图控制器连接起来。首先，双击故事板以缩小视图，确保你可以看到“生日”表格视图控制器和最终会成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，从加号按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标。这将弹出一个连接对话框，类似于图 9-10。

![Image](img/Image00206.jpg)

*图 9-9：将条形按钮项拖动到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到邻近的视图控制器，并在弹出的对话框中选择模态呈现。*

连接对话框为你提供了几种选择，用于选择两者视图控制器之间的*segue*——从一个屏幕到下一个屏幕的过渡。点击连接对话框中的**模态呈现**选项。这将使视图控制器以*模态*视图控制器的形式出现。在 iPhone 上，模态视图控制器从屏幕底部出现，并且不会自动带有返回按钮用于返回到之前的屏幕。相反，模态视图可以包含其他按钮，例如取消或保存。还有其他类型的 segue，例如 Show segue，它将视图控制器从右侧推送到屏幕上，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，屏幕应该作为模态视图展示，并带有取消按钮。否则，如果使用类似 Show segue 的方式，并且有返回按钮，可能会出现这样的情况：用户输入了所有内容，然后点击返回按钮而没有保存任何内容！而有了取消按钮，用户必须有意识地点击取消以退出屏幕。

要查看一个良好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个+按钮，你可以点击它来添加一个日历事件。点击+按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，可以在关闭模态窗口之前创建新事件。你应该看到“新事件”模态窗口从屏幕底部弹出，退出时又下滑消失。我们希望用户能够保存生日，因此我们也将使用模态窗口。

现在让我们尝试运行我们的应用，看看到目前为止我们做了些什么！要运行应用，首先选择一个设备模拟器，点击 Xcode 左上角显示的 BirthdayTracker 旁边的设备（见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：将模拟器运行的设备设置在 Xcode 窗口的左上角，紧挨着你应用的名称。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键⌘-**R**。

当模拟器打开并运行你的应用时，如果它太大以至于无法适应你的计算机屏幕，你可以调整它的大小。点击模拟器以选中它，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择较小的缩放比例。

到目前为止，当你运行应用时，并没有发生太多事情。你应该会看到你的第一个“生日”屏幕，屏幕上有一个+按钮，如之前在图 9-1 所示。显然，此时你的“生日”屏幕是空的。点击+按钮将会弹出第二个空白屏幕。查看完你的应用后，通过点击 Xcode 中的停止按钮来关闭它，停止按钮位于你之前按下的播放按钮旁边。当你停止应用时，你现在应该会在模拟器的主屏幕上看到你的应用图标！（见图 9-12）

就这样！接下来我们需要配置第二个屏幕，以便它可以用来添加生日！

![图片](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计添加生日视图控制器。为此，您需要将其嵌入到自己的导航控制器中。当视图控制器是模态的时，它不会继承我们故事板中已经存在的导航控制器中的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过在故事板中点击视图控制器，选择它。然后转到 **编辑器** ▸ **嵌入于** ▸ **导航控制器**。现在您应该看到在“视图控制器场景”的大纲视图下添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题 **添加生日**。这些步骤与您当时为您的表格视图控制器添加标题“生日”时所遵循的步骤相同。

现在，当添加生日视图控制器在应用中出现时，它会在顶部显示其标题。

#### 添加您朋友的姓名和生日

当您在第十章中输入朋友的生日时，您应用中的每个条目将包含一个名字、一个姓氏和一个出生日期。让我们为添加生日视图控制器添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件是像文本框或下拉菜单这样的控件，它们允许用户在您的应用中输入数据。我们将从为所有可以添加信息的控件添加输入控件标签开始。

##### 添加和定位标签

让我们为您的添加生日视图控制器创建一个显示“First Name”的标签。这个标签将位于一个文本框旁边，您将在其中输入您朋友的名字。从对象库中找到并拖动一个标签对象到添加生日视图控制器中（见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：向添加生日视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name** 作为显示文本，如图 9-14 所示。

现在我们要使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*为单位进行测量的。请注意，1 点不等于 1 像素。根据您的应用运行的设备类型，1 点将转化为 1 像素、一个 2×2 像素的方块，或一个 3×3 像素的方块。这三种缩放因子分别称为 @1x、@2x 和 @3x（这与我们设置应用图标时谈到的尺寸相同）。设备的点分辨率也不同，宽度可以从 320 到 1,024 点，高度可以从 568 到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最老款的 iPhone 和 iPod 使用@1x 的缩放因子，你将无法在这些设备上运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们很可能使用@2x 的缩放因子，这些设备使用的是@3x 的缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离。（见图 9-15）我们将设置每个添加到视图控制器中的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置为不在屏幕的边缘，但仍然留出足够的空间用于文本输入框和其他标签及输入项。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成这些操作后，重复这些步骤为“添加生日”视图控制器添加两个标签：姓氏标签和出生日期标签。我们需要定位其他标签和输入项，以免它们重叠。在某些情况下，这可能会变得有些棘手，可能需要一些时间。对于这个应用，我们已经为你计算好了可以放置对象的位置，这些位置适用于 iPhone 7 屏幕。稍后，我们会解释如何使应用兼容其他设备。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有的标签具有相同的 x 位置，使它们在垂直方向上对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置必须比下一个标签的 y 位置大至少 21 个点。由于我们也将在每个标签下方添加输入控件，所以我们已将 y 位置增大，以适应标签的高度和输入控件的高度。

太好了！现在你的故事板应该与图 9-16 中的一样。

![Image](img/Image00214.jpg)

*图 9-16：视图控制器中已添加输入标签。*

接下来，你将添加两个*文本框*，它们将允许你输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在文本框中输入一行文本。

##### 添加文本框

从对象库中将两个文本框对象拖放到视图控制器中。一个用于输入名字，另一个用于输入姓氏。给这两个文本框设置与表 9-2 中所示相同的大小和位置。你可以使用尺寸检查器来完成此操作，就像你之前设置标签一样。

表 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个称为 *日期选择器* 的滚轮。它将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，用于允许用户选择日期或时间。它可以包含日期和时间，就像在日历应用中使用的日期选择器（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以只显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者只显示日期，这也是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到出生日期标签下方的视图控制器中。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的出生日期！将日期字段从当前日期更改为**自定义**。这样，一个新框将出现。将这个日期改为你的出生日期。

让我们通过运行应用来测试一下目前的功能！我们为输入控件使用的大小在 iPhone 7 屏幕上非常合适。因此，选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击 Birthdays 视图控制器上的 + 按钮时，应该会显示“添加生日”界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器，比如 iPhone 5s，然后再次运行应用。你会发现一些地方看起来不太对劲。

你添加到故事板中的所有元素都会显示出来，但文本字段超出了屏幕边缘。现在你已经把所有元素放到屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确适配。我们将使用一个叫做*自动布局*的工具来完成这个任务。

#### 通过自动布局让你的应用在每个设备上看起来都完美

单独的 iPhone 就有三种不同的屏幕尺寸，而且未来可能会出现更多尺寸。你需要设计应用程序，以确保它在任何设备上都能显示良好。这意味着你需要让应用程序根据运行设备的不同，自动调整屏幕上所有元素的位置和大小。自动布局使用了一种叫做*布局约束*的机制，将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部第四个图标，打开自动布局菜单。*

在屏幕故事板面板的底部，有一个包含图标的带状区域，在工具面板的最右侧，靠近工具面板的是一个介于两条垂直线之间的三角形图标。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击这个图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*) 完成此操作后，你会看到“添加生日”场景中添加了大量布局约束。

这些自动布局约束确保每个元素的大小正确，能够适配屏幕。例如，自动布局使得日期选择器的大小与屏幕宽度相匹配，不会超出边界。自动布局还会确保每个文本字段前后都有 20 个点的间距，以便它们能在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这次，“添加生日”页面应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成剩下的部分，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮暂时不会执行任何操作，我们只是先设置好它们。在第十章中，我们将添加代码，使它们能够退出“添加生日”页面，并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将它放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们为添加按钮所做的那样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将它放在导航栏的*左侧*。使用属性检查器将其转换为取消按钮，就像您对保存按钮所做的那样。您的视图控制器应如图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行您的应用，查看新按钮！

点击“生日”表视图控制器上的+按钮，应该会带您进入“添加生日”视图控制器，您可以在其中输入一个人的姓名和出生日期。点击取消和保存按钮目前不会发生任何操作——我们将在第十章中实现这两个按钮！

### 您学到了什么

在本章中，您通过创建生日和添加生日屏幕的基本用户界面，开始制作 BirthdayTracker 应用。您还使用表视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间切换。

现在，您已经有了应用的基本框架，接下来将在第十章中编程实现取消和保存按钮，这样您就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个苹果的 bug。在这种情况下，选择**重置为缺失约束**选项以添加缺失的约束。

您准备好制作一个应用了吗？我们开始吧！

### 您的应用概览

在本章结束时，我们将为 BirthdayTracker 应用创建两个屏幕。我们将它们分别称为“生日”和“添加生日”屏幕，如图 9-1 所示。

![Image](img/Image00196.jpg)

*图 9-1：我们将在接下来的几章中构建的完成应用的效果图*

生日屏幕显示您已添加的生日列表，而添加生日屏幕则是您可以添加新生日条目的地方。

在 Xcode 中，一个屏幕包括一个*视图*和一个*视图控制器*。视图是您在屏幕上看到的内容，而视图控制器包含所有控制视图的 Swift 代码。您可以在图 9-1 中看到，生日视图的右上角有一个加号（+）样式的添加按钮。

添加按钮将弹出添加生日视图，用户可以在其中输入新朋友的生日详情。让我们通过为我们的 BirthdayTracker 创建一个新的 Xcode 项目来开始吧。

### 创建一个新的 Xcode 项目

到目前为止，您已经在 playground 中编写了大部分代码。playground 是一个学习编程的好地方，但要编写一个可以在 iPad 或 iPhone 上运行的应用，您需要创建一个 Xcode 项目，就像您在第一章中为 Hello World 应用所做的那样。

在 Xcode 菜单中，依次选择 **文件** ▸ **新建** ▸ **项目**。在对话框的顶部选择 **iOS**，然后选择 **单视图应用** 作为项目模板，接着点击 **下一步**。

在弹出的对话框中，Xcode 会要求你为新的应用设置一些选项。由于这是一个示例，你无需过于严肃对待这个部分。当你编写一个计划销售或分发到 App Store 的应用时，设置这些值将变得非常重要。为你的应用命名为 **BirthdayTracker**，确保语言设置为 **Swift**，设备设置为 **iPhone**，并勾选 **使用 Core Data** 选项框。你的组织名称和组织标识符应该会自动填充为你在创建 Hello World 应用时输入的值，见第一章。

点击 **下一步**。在弹出的对话框中，选择你希望保存项目的位置，然后点击 **创建**。你的 Xcode 项目应该会自动打开。花点时间确认在你的项目导航栏中有一个名为 *BirthdayTracker.xcdatamodeld* 的文件（见图 9-2）。

![图片](img/Image00197.jpg)

*图 9-2：确保你的新项目中有一个* BirthdayTracker.xcdatamodeld *文件。*

你需要 *BirthdayTracker.xcdatamodeld* 来保存 iPhone 上的生日数据。如果它缺失，意味着你在创建 Xcode 项目时没有勾选“使用 Core Data”选项框。别担心——这个问题很容易解决。

如果你的 *BirthdayTracker.xcdatamodeld* 文件丢失，请关闭你的项目（文件 ▸ 关闭项目），然后重新创建一个新的 Xcode 项目，并确保选中“使用 Core Data”选项框。当系统询问你是否要替换 BirthdayTracker 项目时，点击**替换**，这样就完成了！

你的新 BirthdayTracker Xcode 项目将会打开。如果你还没有将你的 Apple 账号添加到 Xcode，你会看到“未找到账户”的信息，显示在 General 应用设置中的签名部分。除非你希望在真实设备上运行应用，否则不需要添加账户。（记住，你也可以在 Xcode 的模拟器上运行你的应用。）要添加 Apple 账户到 Xcode，点击 **添加账户** 按钮。（关于如何添加 Apple 账户的详细说明，请参阅 “你的第一个应用！” 在 第 5 页）。

此常规设置屏幕也是你设置应用程序运行设备方向的地方。我们希望 BirthdayTracker 应用仅在*竖屏*模式下运行。竖屏模式是手机的常规方向，主屏按钮位于底部。*横屏*模式是当你将手机横过来时，屏幕也会旋转，使得屏幕的宽度变成手机的高度，屏幕的高度变成手机的宽度。BirthdayTracker 应用在横屏模式下看起来不太好，因此我们不会在用户横屏时让屏幕发生变化。应用程序倒立显示是没问题的，但如果用户把手机转过来，主屏按钮位于顶部，屏幕发生翻转会让他们感到困惑，因此我们也不会支持倒立模式。在部署信息部分，在设备方向旁边，取消选中**Landscape Left**和**Landscape Right**旁的框，并确保**Portrait**是唯一被选中的框。

让我们来看看 Xcode。选择左侧导航器窗格中的*ViewController.swift*，你应该会看到类似于图 9-3 的界面。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航器窗格 ➊，你可以通过选择**视图** ▸ **导航器** ▸ **隐藏/显示导航器**或按⌘-0 来隐藏或显示它。你将使用导航器来选择并查看项目中的文件。

编辑器窗格位于窗口的中央 ➋。在这里你将编写代码！这里也是你可以更改应用设置并使用故事板布置应用中显示的项的位置，故事板在第一章中你已经看过了。我们很快会详细讲解故事板。

右侧是工具窗格 ➌，你可以通过选择**视图** ▸ **工具** ▸ **隐藏/显示工具**或按⌘-OPTION-0 来隐藏或显示它。当打开故事板时，工具窗格将帮助你配置应用中的对象的大小和位置。

### 添加应用图标

大多数应用程序都有某种图标，显示在用户设备的主屏幕上。我们将通过添加应用程序图标来开始开发我们的 BirthdayTracker 应用。你可以从* [`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)*下载我们将用于图标的两个图片。下载 ZIP 文件后，你将在*Downloads*文件夹内找到一个名为*ch9-images*的文件夹，里面有你需要的图像文件。获取这些文件后，选择项目导航器中的*Assets.xcassets*。这将打开应用程序的*资源目录*，你可以在这里放入应用程序将使用的所有*资源*（如图片、声音等），包括应用程序图标。事实上，资源目录中已经有一个占位符，你可以在其中添加图标。从目录左侧的菜单中选择**AppIcon**，你应该能看到几个图片的占位符。

要添加一个将在 iPhone 主屏幕上显示的应用图标，你需要为名为 *iPhone App* 的图标集提供 2x 和 3x 图像。2x 尺寸适用于大多数 iPhone，如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸的图像。你将在 第十四章 中了解更多关于不同屏幕分辨率的图像尺寸设置。

将图标添加到资源目录中非常简单！下载提供的图像后，在 Finder 中打开你的*下载*文件夹。然后，只需将图像 *cake@2x.png* 拖动到 iPhone 应用 2x 框中，将 *cake@3x.png* 拖动到 3x 框中。完成后，你的资源目录应该像 图 9-4 所示。

![Image](img/Image00200.jpg)

*图 9-4：我们现在有了应用图标！*

除了应用图标，应用程序还有一个显示名称，它显示在主页图标下方。默认情况下，这个名称就是应用名称 BirthdayTracker。然而，这个名称有点太长，无法完全显示在应用图标下方，所以我们将其更改为一个更短的名称：Birthdays。要做到这一点，返回到设置页面，选择项目导航器中的 BirthdayTracker 项目。在顶部的身份部分，你可以更改应用的显示名称。只需在显示名称文本框中输入 **Birthdays**。这只会更改显示在应用图标下方的名称，项目名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，接下来让我们创建应用的屏幕！

### 显示你朋友的生日

从项目导航器中选择 *Main.storyboard* 以打开故事板。这是我们设计应用*用户界面*的地方。用户界面是一个 fancy 的名称，指的是用户将看到并用来与应用交互的内容——如图像、文本、按钮等。*故事板* 让你可以直观地组织应用的屏幕。我们将使用故事板查看所有使用的屏幕及其之间的连接。

一旦你选择了 *Main.storyboard*，通过按 ⌘ -0 隐藏导航面板，以便获得更多的屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在看一下实用工具面板的顶部。你应该会看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更仔细查看故事板元素并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它会出现在实用工具面板中。

**检查故事板项**

图 9-5 显示了当故事板打开时，实用工具面板中出现的检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：你可以在故事板的实用工具面板中使用六个检查器。*

让我们从左到右浏览这些检查器。页面图标打开文件检查器。在这里你可以更改故事板文件的设置。在本书和大多数应用程序中，你不会使用这个检查器。

接下来的检查器，标志是一个问号图标，是快速帮助检查器。这个检查器将为你提供关于你当前在故事板中选择的项目的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里你可以为故事板中的项目设置自定义类。

接下来的两个检查器是你在使用故事板时最常用的，我们将在文本中频繁提到它们。属性检查器的图标看起来像一个盾牌。这个检查器用于设置选中项目的各种属性。例如，它可以用来设置标签的文本、按钮的颜色或围绕文本输入框的框类型。尺寸检查器带有一个尺子的图标，用于设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，它的图标像是一个圆圈中的箭头。这个检查器可以用来将你在故事板中的项目与在类中编写的代码连接起来。我们将在第十章中展示如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是“生日”视图控制器。它将是一个特殊类型的视图控制器，显示一个列表，在 Xcode 中称为*表格视图控制器*。在我们的应用中，表格视图控制器将显示你朋友们的生日列表！现在它看起来只是一个空白屏幕，你将在“创建生日表格视图控制器”一节中学习如何显示生日数据，参见第 156 页。

让我们向故事板添加一个表格视图控制器。如果你先从故事板中缩小，这一步会更容易，这样你就能更好地看到视图控制器。在故事板中双击视图控制器外的空白处来实现这一点。现在你的屏幕应该已经缩小了。

在实用工具面板的底部，有一个带有四个按钮的部分。选择第三个按钮，图标像一个圆圈中的正方形。这是对象库，你可以在这里找到可以添加到故事板中的项目。滚动浏览对象库列表，直到找到表格视图控制器，或者使用面板底部的筛选栏搜索“table view controller”。然后点击并将该对象拖到故事板上，紧挨着已有的视图控制器放置。你的故事板应该像图 9-6 中那样。

注意，当你添加表格视图控制器后，左侧的大纲视图中会出现一个“表格视图控制器场景”条目，里面包含一个表格视图控制器。故事板中的场景代表了应用中某个屏幕的区域。在 iPhone 应用中，通常每次屏幕上只显示一个场景，并且该场景会填满整个屏幕。iPad 应用可以同时显示两个或更多场景。

![图片](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到生日屏幕的故事板中*

下一步是将这个新视图控制器设置为应用运行时首先显示的屏幕，因为我们希望在用户打开应用时，首先看到生日列表。执行此操作的步骤见图 9-7。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后在工具区中打开属性检查器 ➋。在那里，勾选**Is Initial View Controller**框 ➌。完成此操作后，表格视图控制器左侧应该会出现一个箭头。这个箭头表示应用启动时将显示这个视图控制器。

#### 添加导航控制器

现在，我们将为视图控制器添加一个名为“生日”的标题，并添加一个“添加”按钮，点击后会显示“添加生日”视图控制器。为此，我们首先将表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器，它配有一个*导航栏*，导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧显示按钮，用于导航到应用中的其他屏幕。你在许多 iOS 应用中看到的这个栏位，例如设置应用和消息应用，都是这样设计的。

在大纲视图中选择**表格视图控制器**。选中后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。操作路径为：**Editor** ▸ **Embed In** ▸ **Navigation Controller**。

在将表格视图控制器嵌入到导航控制器中后，你的故事板应该与图 9-8 中的示例类似。导航控制器将显示为故事板中的一个屏幕。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

每个故事板中的视图控制器代表用户在应用中看到的一个屏幕，但导航控制器稍有不同。虽然它在故事板中看起来像是一个独立的屏幕，实际上导航控制器只是一个容器，用来容纳用户在应用中切换的其他视图控制器。将一个视图控制器嵌入到导航控制器中意味着你的应用可以从一个视图切换到另一个视图，再返回。

你应该在导航控制器和表视图控制器的顶部看到灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能还包含按钮和箭头，用户可以用它们去其他屏幕。为了通过导航栏告诉用户他们当前所在的屏幕，我们需要为我们的屏幕命名。现在是时候重新聚焦到故事板了。双击故事板的空白区域进行放大，然后滚动视图，直到你能看到表视图控制器。要为表视图控制器添加标题，请在左侧大纲视图中点击**导航项**，它位于**表视图控制器场景**下方。

![图片](img/Image00205.jpg)

选择此项后，你可以在右侧的属性检查器中为屏幕输入一个标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。你应该会看到，在完成此步骤并按下 RETURN 后，左侧大纲视图中的表视图控制器场景条目会自动更新为“生日场景”。

接下来，我们将制作一个“添加”按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并向该列表添加一个生日。让我们制作一个按钮，让他们可以做到这一点！

我们需要在导航栏上添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。找到对象库中的 Bar Button Item，然后将其拖放到表视图控制器的导航栏右侧，如图 9-9 所示。

现在我们要将这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮，我们可以使用。在属性检查器中，将 bar button item 的系统项目（System Item）更改为**添加**。你应该能看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在被点击时执行什么操作。我们希望它打开“添加生日”视图控制器，因此我们需要将“添加”按钮连接到该视图控制器。首先，双击故事板进行缩小，确保你能看到“生日”表视图控制器和最终会变成“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，并将加号（+）按钮从按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标。这会弹出一个连接对话框，如图 9-10 所示。

![图片](img/Image00206.jpg)

*图 9-9：将一个 Bar Button Item 拖动到“生日”视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，然后在弹出的对话框中选择“模态展示”。*

连接对话框为你提供了几种*segue*选项——即从一个屏幕到下一个屏幕的过渡——你可以在两个视图控制器之间选择。点击连接对话框中的**模态展示**选项。这将使视图控制器作为*模态*视图控制器出现在屏幕上。在 iPhone 上，模态视图控制器从手机的底部进入屏幕，并且它不会自动带有返回按钮来返回到前一个屏幕。相反，模态视图可以有其他按钮，如取消或保存。还有其他类型的 segue，比如 Show segue，在这种 segue 中，视图控制器从右侧推到屏幕上，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，该屏幕应该作为模态显示，并且带有一个取消按钮。否则，如果你使用类似于 Show segue 的方式，并且有一个返回按钮，可能会出现用户输入所有内容后点击返回按钮而没有保存任何内容的情况！有了取消按钮，用户必须故意点击才能退出该屏幕。

要查看一个好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，用于创建新事件然后关闭模态视图。你会看到新事件模态视图从屏幕底部进入，关闭时会再次从屏幕底部退出。我们希望用户保存生日，因此我们也会使用模态视图。

现在让我们尝试运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先通过点击 Xcode 左上角显示在 BirthdayTracker 旁边的设备名称来选择一个设备模拟器（请参见 图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器运行的设备，位置在你应用程序名称旁边。在这里，设备被设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用程序。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮或使用键盘快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果它的尺寸太大，无法适应你的电脑屏幕，你可以调整其大小。点击模拟器进行选择，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时，没发生太多事情。你应该能看到你第一个“生日”界面，其中有一个+按钮，如之前在图 9-1 中所示。显然，此时你的“生日”界面是空的。点击+按钮将显示一个第二个空白界面。当你查看完应用后，点击 Xcode 中的停止按钮关闭应用，该按钮位于你之前点击的播放按钮旁边。停止应用后，你应该能在模拟器的主屏幕上看到你的应用图标！（见图 9-12）

就这样！现在我们需要配置第二个界面，以便可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到一个自己的导航控制器中。当一个视图控制器是模态时，它不会继承我们在故事板中已经有的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。点击故事板中的视图控制器，选择该视图控制器，然后转到**Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在你应该能看到一个导航项已添加到视图控制器场景的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**Add a Birthday**。这些步骤与之前为表格视图控制器添加标题“Birthdays”时相同。

现在，当“添加生日”视图控制器出现在应用中时，它将显示其顶部的标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每个条目都会有一个名字、姓氏和生日。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入所有这些信息。输入控件是诸如文本框或下拉菜单之类的元素，允许用户将数据输入到你的应用中。我们将通过为用户可以添加的所有信息添加输入控件标签来开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“First Name”（名字）的标签。这个标签将位于一个文本框旁边，你将在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们希望使用“大小检查器”设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*为单位进行测量的。请注意，1 个点不等于 1 个像素。根据你的应用程序运行的设备类型，1 个点将转换为 1 个像素、一个 2×2 像素的方块或一个 3×3 像素的方块。这三种缩放因子被称为@1x、@2x 和@3x（这是我们设置应用程序图标时讨论的相同大小）。设备的分辨率也并非相同，屏幕的宽度从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：显示标签* 名字

只有最旧型号的 iPhone 和 iPod 使用@1x 缩放因子，而且你将无法在这些设备上运行你的应用程序（BirthdayTracker 仅支持 iOS 10+）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，它们使用@3x 缩放因子，否则你的手机或 iPod 通常使用@2x 缩放因子。

对象在屏幕上的位置也是基于点数的。对象的 x 位置是从屏幕左侧到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离。（见图 9-15）。我们将为每个添加到视图控制器的库对象设置 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕的非边缘位置，同时仍然为其文本输入框和其他标签及输入框留出足够的空间。在“大小检查器”的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，高度保持为 21。

完成这个后，重复这些步骤以在“添加生日”视图控制器中添加两个标签：姓氏标签和生日标签。我们需要定位其他标签和输入框，以避免它们重叠。在某些情况下，这可能会变得复杂，并且可能需要一些时间。对于这个应用程序，我们已经为你计算了可以放置对象的位置，适用于 iPhone 7 屏幕。稍后我们将解释如何让你的应用程序适配其他设备。表 9-1 列出了你应该给每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，这样它们就能垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，所以 y 位置需要至少比下一个标签高出 21 个点。由于我们也要在每个标签下方添加输入控件，所以我们将 y 位置设置得更大，以容纳标签和输入控件的高度。

太好了！现在你的故事板应该像图 9-16 中那样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器。*

接下来你将添加两个*文本字段*，它们将允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器。一个用于输入名字，另一个用于输入姓氏。给这两个文本字段设置在表格 9-2 中看到的大小和位置。你可以通过大小检查器来完成这一操作，就像你为标签所做的那样。

表格 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个叫做*日期选择器*的控件。它将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像日历应用中使用的日期选择器一样（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，使用日期选择器进行日期选择。*

日期选择器还可以只显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到视图控制器中出生日期标签下方。使用大小检查器，将 x 位置设为 0，y 位置设为 280。

你可能需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：修改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将此日期改为你的生日！将日期字段从当前日期更改为**自定义**。此时，会出现一个新框，修改此日期为你的生日。

让我们通过运行应用程序来测试到目前为止它的工作情况！我们为输入控件选择的大小适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击生日视图控制器上的+按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来不错，但其他设备呢？选择一个更小的模拟器来运行应用程序，比如 iPhone 5s，再次运行应用程序。你会看到，事情看起来有些不对劲。

你添加到故事板中的所有元素都已经显示出来，但文本字段超出了屏幕的边缘。现在你已经将所有元素放置到屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确显示。我们将使用一个名为*自动布局*的工具来完成这一步。

#### 通过自动布局让你的应用在每个设备上看起来完美

iPhone 本身就有三种不同的屏幕尺寸，而且未来可能会有更多的尺寸。你需要设计你的应用程序，使其在任何设备上都能看起来很好。这意味着你希望你的应用程序能自动调整所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种名为*布局约束*的机制来将元素放置到屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部第四个图标来打开自动布局菜单。*

屏幕的故事板面板底部有一条带图标的功能区，位于工具区前面的最右边的图标是一个位于两条竖直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，内容为“解决自动布局问题”。点击该图标会弹出一个建议菜单。点击**添加缺失约束**。^(*) 当你这么做时，你会看到在“添加生日”场景中添加了许多布局约束。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的宽度适应屏幕，不会超出边缘。自动布局还会确保每个文本字段前后有 20 点的间距，以便它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这一次，“添加生日”界面应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮目前还不会执行任何操作，我们只是先设置它们。在第十章中，我们将添加一些代码，使它们能退出“添加生日”界面并将生日保存到应用中。

为了添加保存按钮，从对象库中拖动一个“Bar Button Item”，并将它放置在导航栏的*右*侧。我们将这个按钮更改为保存按钮，就像我们设置添加按钮一样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，我们来添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将它放在导航栏的*左*侧。使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该看起来像图 9-21 所示。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新按钮的效果！

点击生日表视图控制器上的 + 按钮应该会将你带到“添加生日”视图控制器，在这里你可以输入一个人的名字和生日。点击取消和保存按钮目前没有任何作用——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个生日跟踪器应用，创建了“生日”和“添加生日”界面的基本用户界面。你还使用表视图控制器创建了生日界面，并使得用户可以通过添加按钮和导航控制器在界面之间导航。

现在你的应用基础框架已经完成，在第十章中，你将编写代码来实现取消和保存按钮，从而可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是一个 Apple 错误。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

### 你的应用概要

本章结束时，我们将有两个生日跟踪器的界面。我们将这两个界面称为“生日”和“添加生日”界面，如图 9-1 所示。

![图片](img/Image00196.jpg)

*图 9-1：我们将在接下来的几个章节中构建的完成应用程序的展示*

生日屏幕显示了你添加的生日列表，而“添加生日”屏幕是你可以添加新生日条目的地方。

在 Xcode 中，屏幕包括一个*视图*和一个*视图控制器*。视图是你在屏幕上看到的内容，而视图控制器包含了所有用于控制视图的 Swift 代码。你可以在图 9-1 中看到，生日视图的右上角有一个加号（+）样式的添加按钮。

点击“添加”按钮会弹出“添加生日”视图，在这里用户可以输入新朋友的生日详情。让我们通过为我们的 BirthdayTracker 创建一个新的 Xcode 项目来开始吧。

### 创建一个新的 Xcode 项目

到目前为止，你大多数代码都在 playground 中编写。Playground 是一个学习编程的好地方，但要编写一个能够在 iPad 或 iPhone 上运行的应用程序，你需要像在第一章中为 Hello World 应用程序所做的那样，创建一个 Xcode 项目。

在 Xcode 菜单中，选择 **文件** ▸ **新建** ▸ **项目**。在对话框的顶部选择 **iOS**，并选择 **单视图应用程序** 作为项目模板，然后点击 **下一步**。

在弹出的对话框中，Xcode 会要求你为新应用设置一些选项。由于这只是一个示例，你不需要太过严肃地对待这一部分。在编写一个你计划在 App Store 销售或分发的应用时，设置这些值会更为重要。将你的应用命名为**BirthdayTracker**，确保语言选择为**Swift**，设备设置为**iPhone**，并勾选**使用 Core Data**。你的组织名称和组织标识符应该会自动填入你在第一章中为 Hello World 应用创建时输入的值。

点击 **下一步**。在弹出的对话框中，选择你希望保存项目的位置，然后点击 **创建**。你的 Xcode 项目应该会自动打开。花点时间确保你的项目导航器中列出了名为*BirthdayTracker.xcdatamodeld*的文件（见图 9-2）。

![Image](img/Image00197.jpg)

*图 9-2：确保你的新项目中有一个* BirthdayTracker.xcdatamodeld *文件。*

你需要*BirthdayTracker.xcdatamodeld*来在 iPhone 上保存生日。如果缺少这个文件，说明在创建 Xcode 项目时没有勾选“使用 Core Data”选项。别担心——这很容易修复。

如果缺少*BirthdayTracker.xcdatamodeld*，请关闭你的项目（文件 ▸ 关闭项目），然后重新开始，通过创建一个勾选了“使用 Core Data”选项的新 Xcode 项目。当系统询问是否要替换 BirthdayTracker 项目时，只需点击**替换**，然后你就完成了！

您的新 BirthdayTracker Xcode 项目将打开。如果您还没有将您的 Apple 账户添加到 Xcode 中，您将在“General”应用设置的“Signing”部分看到一条消息，提示“未找到账户”。除非您想在真实设备上运行应用，否则无需添加账户。（请记住，您也可以在 Xcode 的模拟器上运行您的应用。）要将您的 Apple 账户添加到 Xcode，点击**添加账户**按钮。（有关添加 Apple 账户的详细说明，请参阅“您的第一个应用！”第 5 页 。）

这个“General”设置屏幕也是设置应用程序运行设备方向的地方。我们希望 BirthdayTracker 应用程序仅在*竖屏*模式下运行。竖屏模式是手机的常规方向，Home 键在底部。*横屏*模式是当您将手机横向旋转时，屏幕也会旋转，此时屏幕的宽度变为手机的高度，屏幕的高度变为手机的宽度。BirthdayTracker 应用程序在横屏模式下显示效果不好，因此我们不会让屏幕在用户将手机横向旋转时发生变化。应用程序在倒置时看起来也没问题，但如果用户将手机转动并且 Home 键在顶部时屏幕翻转，可能会让用户感到困惑，因此我们也不支持倒置模式。在“Deployment Info”部分，找到“Device Orientation”旁边，取消选中**Landscape Left**和**Landscape Right**旁的框，确保**Portrait**是唯一选中的框。

让我们来看看 Xcode。选择左侧导航窗格中的*ViewController.swift*，您应该会看到类似于图 9-3 的界面。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航窗格 ➊ ，您可以通过选择**视图** ▸ **导航器** ▸ **隐藏/显示导航器**或按下⌘ -0 来隐藏或显示它。您将使用导航器来选择和查看项目中的文件。

编辑器窗格位于窗口的中央 ➋ 。在这里，您将编写代码！这里也是您可以更改应用程序设置并使用故事板布局应用中将要显示的项目的地方，您在第一章中已经看过故事板。我们很快会进一步讨论故事板。

右侧是工具窗格 ➌ ，您可以通过选择**视图** ▸ **工具** ▸ **隐藏/显示工具**或按下⌘ -OPTION -0 来隐藏或显示它。当故事板打开时，工具窗格允许您配置应用中对象的大小和位置。

### 添加应用程序图标

大多数应用程序都会有一个图标，显示在用户设备的主屏幕上。我们将通过添加应用图标来开始我们的 BirthdayTracker 应用。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图片。下载 ZIP 文件后，你将在 *Downloads* 文件夹中得到一个名为 *ch9-images* 的文件夹，里面包含你需要的图片文件。获取这些文件后，在项目导航器中选择 *Assets.xcassets*。这将打开应用的 *资源目录*，在这里你可以放置任何你的应用将使用的 *资源*（图像、声音等），包括应用图标。事实上，资源目录已经有一个占位符，可以用来添加你的图标。从目录左侧的菜单中选择 **AppIcon**，你应该能看到几个图像占位符。

要添加一个将在 iPhone 主屏幕上显示的应用图标，你需要为标签为 *iPhone App* 的图标集提供 2x 和 3x 的图像。2x 尺寸适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，例如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸的图像。你将在 第十四章 中了解更多关于为不同屏幕分辨率调整图像大小的内容。

将图标添加到资源目录非常简单！下载提供的图片后，打开 Finder 中的 *Downloads* 文件夹。然后，只需将图片 *cake@2x.png* 拖到 iPhone 应用 2x 框中，将 *cake@3x.png* 拖到 3x 框中。完成后，你的资源目录应该像 图 9-4 一样。

![图片](img/Image00200.jpg)

*图 9-4：现在我们有了应用图标！*

除了应用图标外，应用还具有一个显示名称，显示在主屏幕图标下方。默认情况下，这个名称就是应用的名称 BirthdayTracker。然而，这个名称有点长，无法完全适应图标下方，因此我们将其改为一个更短的名称：Birthdays。要做到这一点，请通过在项目导航器中选择 BirthdayTracker 项目返回设置页面。在顶部的 Identity 部分，你可以更改应用的显示名称。只需在显示名称文本框中输入 **Birthdays**。这将仅更改图标下方显示的名称。你的项目名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，让我们开始创建应用屏幕吧！

### 显示你朋友的生日

在项目导航器中选择 *Main.storyboard* 打开故事板。这是我们设计应用 *用户界面* 的地方。用户界面只是用户用来与应用互动的元素的 fancy 名称——图像、文本、按钮等。*故事板* 允许你直观地组织应用的屏幕。我们将使用故事板来查看所有使用的屏幕及其之间的连接。

选择了*Main.storyboard*后，按下⌘ -0 隐藏导航面板，以便腾出更多屏幕空间。你的故事板应该已经包含一个视图控制器。

现在，看看工具面板顶部。你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是一些工具，帮助你更详细地查看故事板中的元素，并允许你更改这些元素的设置。当你选择其中一个检查器时，它会出现在工具面板中。

**检查故事板项**

图 9-5 展示了故事板打开时，在工具面板中出现的检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：你可以在故事板的工具面板中使用六个检查器。*

让我们从左到右逐一查看这些检查器。页面图标打开文件检查器。你可以在这里更改故事板文件的设置。在本书以及你大多数应用程序中，你不会使用这个检查器。

下一个检查器，用问号图标表示，是快速帮助检查器。这个检查器将为你提供关于你当前在故事板中选择的项目的详细类信息。

第三个检查器，带有身份证图标的是身份检查器。在这里，你可以为故事板项设置自定义类。

接下来的两个检查器是你在工作中最常用的两个，我们将在文本中频繁提到它们。属性检查器有一个类似盾牌的图标。这个检查器用于设置故事板中选定项目的各种属性。例如，它可以用来设置标签的文本、按钮的颜色，或文本输入框周围显示的框类型。大小检查器，带有尺子的图标，用于设置每个故事板项的大小和屏幕位置。

最后是连接检查器，它的图标看起来像一个圈中的箭头。你可以用它将故事板中的项目连接到你在类中编写的代码。我们将在第十章中向你展示如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是“生日”视图控制器。这将是一个特殊类型的视图控制器，显示一个列表，在 Xcode 中称为*表格视图控制器*。在我们的应用中，表格视图控制器将显示你朋友的生日列表！现在它看起来只是一个空白屏幕，你将在“创建生日表格视图控制器”第 156 页中学习如何显示生日数据。

让我们将一个表视图控制器添加到故事板中。如果你先从故事板中缩小视图以便更好地看到视图控制器，这一步会更容易。你可以通过双击故事板中视图控制器外的空白区域来实现此操作。现在，屏幕应该已经缩小。

在工具面板的底部，有一个包含四个按钮的区域。选择第三个按钮，它看起来像一个圆圈中的方形。这是对象库，你可以在这里找到可以添加到故事板中的项。滚动对象库列表，直到找到“表视图控制器”，或者使用面板底部的过滤条搜索“table view controller”。然后点击并拖动该对象到你的故事板上，将它放到已有视图控制器旁边。你的故事板应该看起来像图 9-6 所示。

注意，在你添加表视图控制器后，左侧的大纲视图中会出现一个“表视图控制器场景”条目，里面有一个表视图控制器。在你的故事板中，一个场景代表应用中的一个屏幕区域。对于 iPhone 应用，通常屏幕上一次只有一个场景，并且该场景会占满整个屏幕。而 iPad 应用则可以同时在屏幕上显示两个或更多场景。

![Image](img/Image00202.jpg)

*图 9-6：将表视图控制器添加到生日屏幕的故事板中*

下一步是将这个新视图控制器设置为运行应用时首先出现的屏幕，因为我们希望当用户打开应用时能看到生日列表。实现这一目标的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表视图控制器并将其设置为初始视图控制器。*

首先，在大纲视图➊ 中选择**表视图控制器**。然后在你的工具面板➋ 中打开属性检查器。在那里，勾选**是初始视图控制器** ➌ 。完成此操作后，你的表视图控制器左侧应该会出现一个箭头。这个箭头表示当应用首次启动时，应用将显示这个视图控制器。

#### 添加导航控制器

现在，我们将为视图控制器添加一个标题“Birthdays”，以及一个添加按钮，用于打开“添加生日”视图控制器。为此，我们将首先把表视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器，它带有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且左侧和右侧有按钮，用于导航到应用中的其他屏幕。在许多 iOS 应用中，你会看到这个栏位于屏幕顶部，比如设置应用和消息应用。

在大纲视图中选择**Table View Controller**。选择后，您需要通过 Xcode 菜单将表视图控制器嵌入到导航控制器中。依次选择**Editor** ▸ **Embed In** ▸ **Navigation Controller**。

将表视图控制器嵌入导航控制器后，您的故事板应该像图 9-8 所示。导航控制器会作为一个屏幕出现在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表用户将在应用中看到的一个屏幕，但导航控制器略有不同。即使它在故事板中看起来像一个独立的屏幕，导航控制器实际上只是一个容器，包含用户在应用中移动的其他视图控制器。将视图控制器嵌入到导航控制器中，意味着您的应用可以在一个视图与另一个视图之间进行导航，并可以返回。

您应该能在导航控制器和表视图控制器的顶部看到灰色导航栏。当应用程序运行时，导航栏会告诉用户他们当前所在屏幕的标题，并且可能还包含用户可以用来导航到其他屏幕的按钮和箭头。为了使用导航栏告诉用户他们当前所处的屏幕，我们需要为屏幕添加标题。现在是回到故事板查看的好时机。双击故事板的空白处以放大，然后滚动视图以查看表视图控制器。要为表视图控制器添加标题，请在左侧的大纲视图中点击**Table View Controller Scene**下的**Navigation Item**。

![Image](img/Image00205.jpg)

选择此选项后，您可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。完成此步骤并按下 RETURN 键后，您应该会看到大纲视图中的表视图控制器场景条目自动更新为 Birthdays 场景。

接下来，我们将创建一个添加按钮，让您可以添加生日！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并向列表中添加一个生日。让我们做一个按钮来实现这一功能！

我们需要在导航栏上添加一个按钮，跳转到添加生日的场景，以便用户可以输入生日。找到对象库中的“Bar Button Item”，然后将其拖动到表视图控制器导航栏的右侧，如图 9-9 所示。

现在我们想将此按钮转换为添加按钮。幸运的是，Xcode 提供了一个内置的添加按钮可以使用。在属性检查器中，将条形按钮项的系统项目更改为**Add**。您应该会看到按钮变成加号（+）。

接下来，我们需要告诉按钮点击时该执行什么操作。我们希望它能打开“添加生日”视图控制器，因此我们需要将添加按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你能看到“生日”表视图控制器和最终将成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，从 + 按钮拖动到故事板右侧空白视图控制器的中间。视图控制器高亮显示时松开鼠标，这会弹出一个连接对话框，类似于图 9-10 所示。

![图片](img/Image00206.jpg)

*图 9-9：将“条形按钮项”拖到生日视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态展示”。*

连接对话框提供了几个选项，让你选择在两个视图控制器之间进行的*跳转*类型——即从一个屏幕到另一个屏幕的过渡。在连接对话框中点击**模态展示**选项。这会让视图控制器作为*模态*视图控制器展示在屏幕上。在 iPhone 上，模态视图控制器会从屏幕底部出现，并且默认没有返回按钮返回到前一个屏幕。相反，模态视图可以有其他按钮，例如取消或保存。还有其他类型的跳转，例如“显示”跳转，视图控制器会从右侧推入屏幕，并且导航栏左侧会有返回按钮。

在 iOS 应用程序中，当你展示一个用于获取和保存用户输入的界面时，应该将其显示为模态视图，并配有取消按钮。否则，如果你使用类似“显示”跳转的方式，并且没有返回按钮，可能会出现用户输入所有信息后点击返回按钮却没有保存任何内容的情况！通过添加取消按钮，用户必须有意识地点击取消才能退出界面。

要查看模态输入视图控制器的一个好例子，可以看看你 iPhone 或 iPad 上的日历应用程序。打开它后，你会看到导航栏右侧有一个 + 按钮，点击它可以添加日历事件。点击 + 按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出界面，右侧有一个添加按钮，可以在关闭模态前创建新的事件。你会看到，新事件模态视图从屏幕底部出现，关闭时又会下滑消失。我们希望用户能够保存生日信息，因此我们也将使用模态视图。

现在让我们试着运行我们的应用程序，看看到目前为止我们做了什么！要运行应用程序，首先点击 Xcode 左上角的 BirthdayTracker 旁边列出的设备模拟器（见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角的应用名称旁边设置模拟器运行的设备。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用程序。我们选择的是 iPhone 7。选择好模拟器后，点击左上角的播放按钮或使用快捷键 ⌘ -**R**。

当模拟器启动运行你的应用程序时，如果模拟器的大小太大而无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器进行选择，然后前往 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的比例。

到目前为止，运行应用程序时没有太多变化。你应该能看到你的第一个“生日”界面，并且有一个 + 按钮，如前面在图 9-1 所示。显然，在这一点上，你的“生日”界面将是空的。点击 + 按钮会弹出第二个空白界面。当你查看完应用程序后，点击 Xcode 中的停止按钮（位于你之前点击的播放按钮旁边）来关闭它。当你停止应用程序时，你应该能看到应用程序图标出现在模拟器的主屏幕上！（见图 9-12）

就是这样！我们现在需要配置第二个界面，以便它可以用于添加生日！

![图片](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们从添加标题开始设计添加生日的视图控制器。为此，你需要将它嵌入到自己的导航控制器中。当一个视图控制器是模态时，它不会继承我们在故事板中已经存在的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中点击选中普通视图控制器，然后进入 **编辑** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该能看到在视图控制器场景下的提纲视图中添加了一个导航项。点击这个新导航项，然后在属性检查器中添加标题 **添加生日**。这些步骤与你之前为表格视图控制器添加“生日”标题时是一样的。

现在，当添加生日视图控制器出现在应用程序中时，它将在顶部显示标题。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每一项都将包含一个名字、一个姓氏和一个生日。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件是允许用户向应用中输入数据的控件，如文本框或下拉菜单。我们将从为所有用户可以添加的信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“First Name”的标签。这个标签将位于一个文本框旁边，用户将在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在“属性检查器”中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在我们希望使用“尺寸检查器”设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以*点*为单位进行测量。请注意，1 个点并不等于 1 个像素。根据应用运行的设备类型，1 个点将转化为 1 个像素、一个 2×2 像素的正方形或一个 3×3 像素的正方形。这三种比例因子分别为@1x、@2x 和@3x（与我们设置应用图标时讨论的大小相同）。不同设备的点分辨率也不相同，宽度从 320 到 1024 点不等，纵向从 568 到 1366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示“First Name”*

只有最老款的 iPhone 和 iPod 使用@1x 比例因子，你将无法在这些设备上运行应用（BirthdayTracker 只支持 iOS 10 及以上版本）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，否则你的手机或 iPod 很可能使用@2x 比例因子，它们使用@3x 比例因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点数，y 位置是从屏幕顶部到对象顶部的点数。（参见图 9-15）。我们将设置我们添加到视图控制器中的每个库对象的 x 和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕的边缘以外，同时为其文本输入框以及其他标签和输入框留出足够的空间。在“尺寸检查器”的“视图”部分，设置 x 位置为 20，y 位置为 100，宽度为 100。高度保持为 21。

完成此操作后，重复这些步骤以向“添加生日”视图控制器添加两个标签：一个“姓氏”标签和一个“出生日期”标签。我们需要调整其他标签和输入框的位置，以避免它们重叠。在某些情况下，这可能会变得复杂并需要一些时间。对于这个应用程序，我们已经为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何使你的应用程序兼容其他设备。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有的标签都有相同的 X 位置，这样它们就会垂直对齐，但每个标签的 Y 位置不同。每个标签的高度都是 21，因此 Y 位置需要至少比下一个标签高出 21 个点。由于我们还在每个标签下方添加了输入控件，因此我们把 Y 位置设置得更大，以适应标签和输入控件的高度。

太好了！现在你的故事板应该像图 9-16 中的那样。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器。*

接下来，你将添加两个*文本字段*，用来输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在文本字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。其中一个用于输入名字，另一个用于输入姓氏。将这两个文本字段设置为表 9-2 中的大小和位置。你可以使用大小检查器来完成这一操作，就像设置标签一样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个叫做*日期选择器*的滚轮。它将帮助你轻松地输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，用于允许用户选择日期或时间。它可以包含日期和时间，就像日历应用中使用的日期选择器（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，就像时钟应用中用于设置闹钟的日期选择器，或者仅显示日期，这是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到日期选择器，然后将其点击并拖动到出生日期标签下的视图控制器上。使用大小检查器，将 x 位置设为 0，y 位置设为 280。

你需要调整日期选择器的几个属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们把这个日期改成你的出生日期！将日期字段从“当前日期”更改为**自定义**。当你这么做时，一个新的框会出现。将这个日期更改为你的出生日期。

让我们通过运行应用来测试目前的效果！我们为输入控件设置的尺寸适合 iPhone 7 的屏幕。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击出生日期视图控制器上的+按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备怎么样呢？选择一个较小的模拟器运行应用，比如 iPhone 5s，然后再次运行应用。你会看到，某些地方看起来不太对。

所有你添加到故事板上的元素都出现了，但是文本字段超出了屏幕的边缘。现在你已经将所有元素放到屏幕上，下一步是确保它们在任何屏幕尺寸上都能正确适配。我们将使用一种叫做*自动布局*的工具来实现这一点。

#### 使用自动布局让你的应用在每个设备上看起来都完美

单独的 iPhone 有三种不同的屏幕尺寸，而且未来可能会有更多尺寸。你需要设计你的应用，以确保它在任何设备上看起来都不错。这意味着你希望应用能够调整所有元素的位置和尺寸，以适应运行该应用的设备。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕故事板窗格的底部，有一个带有图标的带状区域，靠近“实用工具”窗格的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标指针悬停在该图标上，它应该显示一个标签，写着“解决自动布局问题”。点击此图标会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这么做时，你会看到大量的布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的尺寸正确，以适应屏幕。例如，自动布局确保日期选择器的大小适应屏幕的宽度，并且不会超出屏幕边缘。自动布局还确保每个文本框前后都有 20 个点的间距，使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用。这次，“添加生日”界面应该看起来完美。

#### 添加保存和取消按钮

为了完成这部分内容，我们将展示如何为“添加生日”视图控制器的导航栏添加“取消”和“保存”按钮。这些按钮目前不会执行任何操作，我们只是设置它们。在第十章中，我们将添加代码，使它们能够取消添加生日的操作并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮更改为“保存”按钮，就像我们之前做的“添加”按钮一样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加“取消”按钮。从对象库中拖动另一个条形按钮项，并这次将其放置在导航栏的*左侧*。使用属性检查器将其更改为“取消”按钮，就像你为保存按钮所做的那样。你的视图控制器应该像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新增的按钮！

在“生日”表视图控制器上点击+按钮应该会带你进入“添加生日”视图控制器，在这里你可以输入一个人的姓名和出生日期。点击“取消”和“保存”按钮目前不会执行任何操作——我们将在第十章中实现这两个按钮！

### 你学到的内容

在本章中，你开始创建一个 BirthdayTracker 应用，通过为“生日”界面和“添加生日”界面设计基本的用户界面。你还使用了表视图控制器创建了“生日”界面，并使用户能够通过“添加”按钮和导航控制器在不同界面之间进行导航。

现在你已经完成了应用的基本框架，在第十章中，你将编写代码实现“取消”和“保存”按钮，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项以添加缺失的约束。

本章结束时，我们将有两个 BirthdayTracker 屏幕。我们将其命名为“生日”和“添加生日”屏幕，如图 9-1 所示。

![图片](img/Image00196.jpg)

*图 9-1：我们将在接下来的几章中构建的完成应用的外观*

生日屏幕展示了您已添加的生日列表，而“添加生日”屏幕是您可以添加新生日条目的地方。

在 Xcode 中，一个屏幕包括一个*视图*和一个*视图控制器*。视图是您在屏幕上看到的内容，而视图控制器包含所有控制视图的 Swift 代码。您可以在图 9-1 中看到，生日视图的右上角有一个看起来像加号（+）的添加按钮。

添加按钮将打开“添加生日”视图，用户可以在其中输入新朋友的生日详情。让我们开始创建一个新的 Xcode 项目，用于我们的 BirthdayTracker。

### 创建新 Xcode 项目

到目前为止，您一直在 playground 中编写大部分代码。Playground 是一个学习编程的好地方，但要编写一个可以在 iPad 或 iPhone 上运行的应用，您需要创建一个 Xcode 项目，就像在第一章中为 Hello World 应用所做的那样。

在 Xcode 菜单中，选择**文件** ▸ **新建** ▸ **项目**。在对话框顶部选择**iOS**，并选择**单视图应用**作为项目模板，然后点击**下一步**。

在弹出的对话框中，Xcode 会要求您为新应用设置几个选项。由于这只是一个示例，您不需要太过认真对待这部分。当您编写计划出售或分发到 App Store 的应用时，设置这些值会更为重要。将您的应用命名为**BirthdayTracker**，确保语言为**Swift**，设备设置为**iPhone**，并勾选**使用核心数据**。您的组织名称和组织标识符应该会自动填充为您在第一章中创建 Hello World 应用时输入的值。

点击**下一步**。在弹出的对话框中，选择您希望保存项目的位置并点击**创建**。您的 Xcode 项目应该会自动打开。花点时间确保在您的项目导航器中列出了名为*BirthdayTracker.xcdatamodeld*的文件（请参见图 9-2）。

![图片](img/Image00197.jpg)

*图 9-2：确保您的新项目中有一个*BirthdayTracker.xcdatamodeld*文件。*

您需要*BirthdayTracker.xcdatamodeld*来在 iPhone 上保存生日。如果缺少该文件，意味着您在创建 Xcode 项目时没有勾选“使用核心数据”选项。别担心，这个问题很容易解决。

如果你的*BirthdayTracker.xcdatamodeld*丢失了，关闭你的项目（文件 ▸ 关闭项目），然后通过创建一个新的 Xcode 项目并勾选“使用 Core Data”框来重新开始。当系统询问你是否要替换 BirthdayTracker 项目时，只需点击**替换**，然后你就完成了！

你的新 BirthdayTracker Xcode 项目将会打开。如果你没有将 Apple 账户添加到 Xcode，你会看到在“常规”应用设置的签名部分显示一条消息：“未找到账户”。除非你想在真实设备上运行应用，否则无需添加账户。（记住，你也可以在 Xcode 的模拟器上运行应用。）要将你的 Apple 账户添加到 Xcode，请点击**添加账户**按钮。（关于如何添加 Apple 账户的详细说明，请参见“你的第一个应用！”，第 5 页。）

这个“常规设置”界面也是你设置应用运行时设备方向的地方。我们希望 BirthdayTracker 应用只在*竖屏*模式下运行。竖屏模式是手机的常规方向，主屏幕按钮在底部。*横屏*模式是当你将手机旋转时，屏幕也会随之旋转，屏幕的宽度变为手机的高度，屏幕的高度变为手机的宽度。BirthdayTracker 应用在横屏模式下看起来不太好，所以我们不会让屏幕在用户将手机横向旋转时发生变化。应用倒过来也没问题，但如果用户将手机转过来，主屏幕按钮在顶部时屏幕翻转，这可能会让用户感到迷惑，因此我们也不会支持倒置屏幕。在部署信息部分，在设备方向旁边，取消勾选**横屏左**和**横屏右**，确保只有**竖屏**的框被勾选。

让我们来看看 Xcode。选择左侧导航面板中的*ViewController.swift*，你应该会看到类似图 9-3 的界面。

![图片](img/Image00198.jpg)![图片](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航面板 ➊ ，你可以通过选择**视图** ▸ **导航器** ▸ **隐藏/显示导航器**，或者按 ⌘ -0 来隐藏或显示它。你将使用导航器来选择和查看项目中的文件。

编辑器面板位于窗口的中央 ➋ 。这里是你编写代码的地方！也是你可以更改应用设置并使用情景图布局将要在应用中显示的项目的地方，你在第一章中见过情景图。我们很快会进一步讲解情景图。

右侧是实用工具面板 ➌ ，你可以通过选择**视图** ▸ **实用工具** ▸ **隐藏/显示实用工具**，或者按 ⌘ -OPTION -0 来隐藏或显示它。当情景图打开时，实用工具面板允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都有某种图标，显示在用户设备的主屏幕上。我们将通过添加应用图标来开始我们的 BirthdayTracker 应用。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用作图标的两个图像。下载 ZIP 文件后，你将在 *下载* 文件夹内得到一个名为 *ch9-images* 的文件夹，里面包含你需要的图像文件。获取这些文件后，从项目导航器中选择 *Assets.xcassets*。这将打开应用的 *资源目录*，在这里你可以放入应用将使用的任何 *资源*（如图像、声音等），包括应用图标。事实上，资源目录已经有一个占位符，你可以在其中添加你的图标。从目录左侧的菜单中选择 **AppIcon**，你应该能看到几个图像的占位符。

若要添加一个图标在 iPhone 的主屏幕上显示，你需要提供 *iPhone App* 图标集的 2x 和 3x 图像。2x 尺寸适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸的图像。你将在第十四章中了解更多关于不同屏幕分辨率图像大小的内容。

将图标添加到资源目录很简单！下载提供的图像后，打开 Finder 中的 *下载* 文件夹。然后，只需将图像 *cake@2x.png* 拖动到 iPhone App 2x 框中，将 *cake@3x.png* 拖动到 3x 框中。完成后，你的资源目录应该像图 9-4 一样。

![图片](img/Image00200.jpg)

*图 9-4：现在我们有了一个应用图标！*

除了应用图标外，应用还有一个显示名称，会显示在图标下方。在默认情况下，这个名称就是应用的名称 BirthdayTracker。然而，这个名称太长，无法完全显示在图标下方，所以我们将其改为一个更短的名称：Birthdays。为此，返回设置页面，在项目导航器中选择 BirthdayTracker 项目。在顶部的 Identity 部分，你可以更改应用的显示名称。在显示名称文本框中输入 **Birthdays**。这只会更改在应用图标下方显示的名称，项目的名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，接下来让我们创建应用界面！

### 显示朋友的生日

从项目导航器中选择 *Main.storyboard*，以打开故事板。这是我们将设计应用 *用户界面* 的地方。用户界面就是用户用来与应用互动的所有元素——图像、文本、按钮等等。*故事板* 让你可以直观地组织应用的各个屏幕。我们将使用故事板查看所有屏幕及其之间的连接。

一旦选择了*Main.storyboard*，通过按⌘-0 隐藏导航面板，这样你将拥有更多的屏幕空间。你的故事板应该已经包含一个视图控制器。

现在看一下工具面板的顶部。你应该能看到一个有六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你仔细查看故事板中元素的工具，并允许你更改这些元素的设置。当你选择其中一个检查器时，它会出现在工具面板中。

**检查故事板项**

图 9-5 显示了当故事板打开时，在工具面板中出现的检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：你可以在故事板的工具面板中使用六个检查器。*

让我们从左到右浏览这些检查器。页面图标打开文件检查器。在这里你可以更改故事板文件的设置。在本书中以及你大多数应用中，你不会使用这个检查器。

下一个检查器，由一个问号图标表示，是快速帮助检查器。这个检查器将为你当前在故事板中选择的项提供详细的类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里你可以为故事板项设置自定义类。

接下来的两个检查器是你在工作中最常使用的，我们将在文本中频繁提到它们。属性检查器的图标看起来像一个盾牌。这个检查器用于设置选定项的各种属性，比如设置标签的文本、按钮的颜色，或显示在文本输入框周围的框类型等。尺寸检查器，带有尺子的图标，用于设置每个故事板项的大小和屏幕位置。

最后是连接检查器，图标看起来像一个圆圈中的箭头。这个检查器可以用来将故事板中的项目连接到你在类中编写的代码。我们将在第十章中展示如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊类型的视图控制器，显示一个列表，在 Xcode 中称为*表格视图控制器*。在我们的应用中，表格视图控制器将显示你朋友们的生日列表！目前它看起来只是一个空白屏幕，你将在“创建生日表格视图控制器”（第 156 页）中学习如何显示生日数据。

让我们在故事板中添加一个表视图控制器。如果你先从故事板缩小视图，便能更清晰地看到视图控制器，这一步会更简单。你可以双击故事板中视图控制器外的空白区域来实现缩小。现在你的屏幕应该已经缩小了。

在工具面板的底部，有一个包含四个按钮的区域。选择第三个按钮，它看起来像是一个圆圈中的正方形。这是对象库，在这里你可以找到可以添加到故事板中的项。滚动浏览对象库列表，直到你找到表视图控制器，或者使用面板底部的过滤条搜索“table view controller”。然后点击并拖动该对象到你的故事板上，放置在已经存在的视图控制器旁边。你的故事板应该与图 9-6 中的样式一致。

注意，在你添加表视图控制器后，左侧的大纲视图中会出现一个名为“表视图控制器场景”的条目，并且其中包含一个表视图控制器。故事板中的场景代表了应用程序屏幕上的一个区域。对于 iPhone 应用来说，通常每次屏幕上只有一个场景，且该场景占据整个屏幕。iPad 应用则可以同时显示两个或更多场景。

![Image](img/Image00202.jpg)

*图 9-6：为“生日”屏幕添加表视图控制器到故事板中*

下一步是将这个新的视图控制器设置为在运行应用时第一个出现的屏幕，因为我们希望用户打开应用时能看到生日列表。实现这一目标的步骤见图 9-7。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表视图控制器并将其设置为初始视图控制器。*

首先，在大纲视图 ➊ 中选择**表视图控制器**。然后在工具面板中打开属性检查器 ➋ 。在那里，勾选**是初始视图控制器** ➌ 。完成这一步后，你的表视图控制器左侧应该会出现一个箭头。这个箭头表示当应用程序启动时，应用会显示这个视图控制器。

#### 添加导航控制器

接下来，我们将在视图控制器中添加一个标题“生日”，并添加一个“添加”按钮，点击该按钮将显示添加生日的视图控制器。为此，我们首先需要将表视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它自带一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在其左右两侧放置导航到其他屏幕的按钮。你可以在多个 iOS 应用中看到这个导航栏，例如设置应用和消息应用。

在大纲视图中选择**表视图控制器**。选择后，您需要使用 Xcode 菜单将表视图控制器嵌入到导航控制器中。前往 **编辑** ▸ **嵌入** ▸ **导航控制器**。

在将表视图控制器嵌入到导航控制器后，您的故事板应该像图 9-8 所示。导航控制器将在故事板中作为一个屏幕显示。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表应用中的一个屏幕，用户将在其中看到，但导航控制器稍微不同。尽管它在故事板中看起来像一个单独的屏幕，实际上导航控制器只是一个容器，包含了用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着您的应用可以从一个视图切换到另一个视图，然后再返回。

您应该能看到导航控制器和表视图控制器顶部的灰色导航栏。当应用运行时，导航栏会告诉用户他们当前所在屏幕的标题，并可能包含按钮和箭头，用户可以利用它们前往其他屏幕。为了让导航栏告诉用户他们所在的屏幕，我们需要给屏幕命名。现在是时候缩放故事板视图了。双击故事板中的空白处进行缩放，然后滚动视图，直到能看到表视图控制器。要为表视图控制器添加标题，在左侧大纲视图中的**表视图控制器场景**下点击**导航项**。

![Image](img/Image00205.jpg)

选择此项后，您可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。完成此步骤并按回车键后，大纲视图中的表视图控制器场景项将自动更新为“生日场景”。

接下来，我们将制作一个添加按钮，方便您添加生日！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并向其中添加生日。让我们制作一个按钮，让他们能够做到这一点！

我们需要在导航栏中添加一个按钮，指向添加生日的场景，以便用户可以输入生日。在对象库中找到“条形按钮项”，然后将其拖放到表视图控制器的导航栏右侧，如图 9-9 所示。

现在，我们想将这个按钮变成一个添加按钮。幸运的是，Xcode 提供了一个内置的添加按钮可以使用。在属性检查器中，将条形按钮项的系统项目改为**添加**。您应该看到按钮变成了一个加号 (+)。

接下来，我们需要告诉按钮点击时要执行的操作。我们希望它打开“添加生日”视图控制器，因此我们需要将“添加”按钮连接到该视图控制器。首先，双击 storyboard 以缩小视图，确保你能看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从“+”按钮拖动到 storyboard 右侧空白视图控制器的中间。当视图控制器高亮显示时松开鼠标。这样就会弹出一个连接对话框，像图 9-10 中展示的那样。

![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar Button Item 拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在出现的对话框中选择“模态展示”。*

连接对话框提供了多个选项，供你选择在两个视图控制器之间进行的*segue*类型——即从一个屏幕到下一个屏幕的过渡。点击连接对话框中的**模态展示**选项。这会使视图控制器作为*模态*视图控制器呈现到屏幕上。在 iPhone 上，模态视图控制器从屏幕底部滑入，并且通常不带有自动生成的返回按钮来返回到上一个屏幕。相反，模态视图可以包含其他按钮，如取消或保存。还有其他类型的 segue，例如显示 segue，它会将视图控制器从右侧推出，并在导航栏的左侧带有一个返回按钮。

在 iOS 应用中，当你呈现一个用于获取和保存用户输入的屏幕时，应该将屏幕以模态形式展示，并配有一个取消按钮。否则，如果你使用类似于显示 segue 的方式，并且带有返回按钮，可能会出现用户输入所有内容后点击返回按钮却没有保存任何内容的情况！有了取消按钮，用户必须故意点击才能取消退出屏幕。

要查看一个好的模态输入视图控制器的示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个“+”按钮，你可以点击它来添加日历事件。点击“+”按钮会弹出一个模态的“新建事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出，右侧有一个添加按钮，用于在关闭模态视图前创建新事件。你应该会看到“新建事件”模态从底部滑入屏幕，并且在关闭时又会滑回底部。我们希望用户能保存生日信息，因此我们也将使用模态。

现在让我们尝试运行应用，看看我们到目前为止做了什么！要运行应用，首先在 Xcode 的左上角点击“BirthdayTracker”旁边列出的设备模拟器（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设备的设置位于应用名称旁边。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行您的应用。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮，或使用键盘快捷键⌘ -**R**。

当模拟器启动并运行您的应用时，如果模拟器的尺寸过大以至于无法适应计算机屏幕，您可以调整其大小。点击模拟器以选中它，然后转到**窗口** ▸ **缩放**，在模拟器菜单中选择较小的缩放比例。

到目前为止，当您运行应用时，似乎没有发生太多事情。您应该看到第一个“生日”屏幕，带有一个+按钮，正如之前在图 9-1 中所示。显然，此时，您的“生日”屏幕是空的。点击+按钮会显示第二个空白屏幕。查看完应用后，通过点击 Xcode 中的停止按钮来关闭它，该按钮位于您之前点击的播放按钮旁边。当您停止应用时，您应该可以在模拟器的主屏幕上看到您的应用图标！（参见图 9-12。）

就这样！现在我们需要配置第二个屏幕，以便它可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控件输入和标签

我们从添加标题开始设计“添加生日”视图控制器。为此，您需要将其嵌入到自己的导航控制器中。当视图控制器是模态时，它不会继承我们在故事板上已有的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击故事板中的视图控制器来选择普通视图控制器。然后转到**编辑器** ▸ **嵌入到** ▸ **导航控制器**。现在，您应该能看到在视图控制器场景下的轮廓视图中添加了一个导航项。点击这个新导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与您在为表视图控制器添加标题“生日”时的操作相同。

现在，当“添加生日”视图控制器在应用中出现时，它会在顶部显示其标题。

#### 添加您的朋友的姓名和生日

当您在第十章中输入朋友的生日时，您应用中的每一项条目都将包含名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，这样用户就可以输入每个人的信息。输入控件是指文本框或下拉菜单等，允许用户将数据输入到应用程序中。我们将通过添加所有用户可以输入的信息的输入控件标签来开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个写着“First Name”的标签。这个标签将位于一个文本框旁边，用户可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器中。*

接下来，修改标签的显示文本。在“属性检查器”中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在我们希望使用“大小检查器”设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以*点*为单位进行度量。请注意，1 个点并不等于 1 个像素。根据您的应用运行的设备类型，1 个点可能会转化为 1 个像素、2×2 像素的正方形或 3×3 像素的正方形。这三种缩放因子分别称为@1x、@2x 和@3x（我们在设置应用图标时提到过的相同大小）。不同的设备也有不同的点分辨率，宽度范围从 320 点到 1024 点，高度范围从 568 点到 1366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最老的 iPhone 和 iPod 型号使用@1x 缩放因子，而这些型号无法运行您的应用（BirthdayTracker 将仅支持 iOS 10+）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，否则您的 iPhone 或 iPod 很可能使用@2x 缩放因子，而这些设备使用的是@3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的距离。（见图 9-15。）我们将设置每个我们添加到视图控制器的库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕边缘之外，但仍然留有足够的空间给文本输入框以及其他标签和输入框。在“大小检查器”的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成这些操作后，重复这些步骤，向“添加生日”视图控制器中添加两个标签：一个是姓氏标签，另一个是出生日期标签。我们需要定位其他标签和输入框，以确保它们不会重叠。在某些情况下，这可能会变得有些复杂，并可能需要一些时间。对于这个应用程序，我们已经计算出适合放置对象的地方，适用于 iPhone 7 屏幕。稍后，我们将解释如何让您的应用适配其他设备。表 9-1 列出了您应该为每个标签设置的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X-位置 | Y-位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

您可以看到，所有标签的 x-位置相同，因此它们垂直对齐，但每个标签的 y-位置不同。每个标签的高度为 21，所以 y-位置至少需要比下一个标签的 y-位置大 21 点。由于我们也将输入控件添加到每个标签下方，所以我们已将 y-位置设置得更大，以便同时容纳标签的高度和输入控件的高度。

太好了！现在您的故事板应该像图 9-16 中的那样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，您将添加两个*文本框*，允许您输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在文本框中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本框对象到视图控制器中。一个将用于输入名字，另一个将用于输入姓氏。根据表 9-2 中的尺寸和位置设置这两个文本框。您可以使用尺寸检查器进行设置，就像您为标签所做的那样。

表 9-2：视图控制器中输入的文本框

| 文本框 | X-位置 | Y-位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后，您需要添加一个称为*日期选择器*的控件。它将使您能够轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的工具，允许用户选择日期或时间。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以只显示时间，比如在时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到日期选择器，然后将其点击并拖动到 Birthdate 标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器设置为显示当前日期。让我们把这个日期改成你的生日！将日期字段从当前日期更改为**自定义**。当你这么做时，一个新的框会出现。将这个日期改成你的生日。

让我们通过运行应用来测试目前为止的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击生日视图控制器上的 + 按钮时，应该会显示添加生日的屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美契合。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个更小的模拟器来运行应用程序，比如 iPhone 5s，然后重新运行应用程序。你会发现一些显示效果不太对。

你添加到故事板中的所有元素都已显示出来，但文本字段超出了屏幕边缘。现在，所有元素都已出现在屏幕上，接下来的步骤是让它们在任何屏幕尺寸上正确显示。我们将使用一个名为*自动布局*的工具来实现这一点。

#### 使用自动布局让你的应用在每个设备上看起来都完美

iPhone 本身就有三种不同的屏幕尺寸，而且将来可能会有更多尺寸。你需要设计你的应用，使其在任何设备上都能看起来很好。这意味着你需要让你的应用根据运行设备的不同调整应用中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标来调出自动布局菜单。*

在屏幕故事板面板的底部有一个带有图标的功能区，紧靠着实用工具面板的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上时，应该会显示一个标签，标明“解决自动布局问题”。点击该图标会弹出一个建议菜单。点击**添加缺失的约束** ^(*)。这样，你会看到一堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局会确保日期选择器的大小适应屏幕的宽度，并且不会超出边界。自动布局还会确保每个文本字段前后有 20 个点，以便它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器中运行应用。这次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成设置，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮目前不会做任何事情，我们只是将它们设置好。在第十章中，我们将添加一些代码，使它们能够取消“添加生日”屏幕并保存生日到应用中。

要添加保存按钮，从对象库中拖动一个“条形按钮项”并将其放置在导航栏的*右侧*。我们将把这个按钮更改为保存按钮，就像我们做过的“添加”按钮一样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“条形按钮项”，这次将其放置在导航栏的*左侧*。使用属性检查器将其更改为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该像图 9-21 所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新添加的按钮！

点击“生日”表格视图控制器上的+按钮应该会将你带到“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前不会有任何反应——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用，通过创建“生日”和“添加生日”屏幕的基本用户界面。你还使用表格视图控制器创建了“生日”屏幕，并使用户可以通过“添加”按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本框架，接下来将在第十章中编写取消和保存按钮的代码，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，Add Missing Constraints 选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **Reset to Missing Constraints** 选项来添加缺失的约束。![Image](img/Image00196.jpg)

*图 9-1：我们将在接下来的几章中构建的完成应用的预览*

Birthdays 屏幕展示了你已添加的生日列表，而 Add a Birthday 屏幕则是你可以添加新生日条目的地方。

在 Xcode 中，一个屏幕包括 *视图* 和 *视图控制器*。视图是你在屏幕上看到的内容，视图控制器包含你用 Swift 编写的代码来控制视图。你可以在图 9-1 中看到，Birthdays 视图的右上角有一个看起来像加号 (+) 的 Add 按钮。

点击添加按钮将打开 Add a Birthday 视图，用户可以在这里输入新朋友的生日信息。让我们从为 BirthdayTracker 创建一个新的 Xcode 项目开始。

### 创建新的 Xcode 项目

到目前为止，你大部分代码都是在 Playground 中编写的。Playground 是学习编程的好地方，但要编写一个能在 iPad 或 iPhone 上运行的应用，你需要像在第一章中为 Hello World 应用创建的那样，创建一个 Xcode 项目。

在 Xcode 菜单中，选择 **File** ▸ **New** ▸ **Project**。在对话框顶部选择 **iOS**，然后选择 **Single View Application** 作为项目模板，接着点击 **Next**。

在弹出的对话框中，Xcode 会要求你为新应用设置一些选项。由于这只是一个示例，你不需要太过认真对待这部分内容。当你编写一个计划出售或在 App Store 上分发的应用时，设置这些值就变得更为重要了。将你的应用命名为**BirthdayTracker**，确保语言选择为**Swift**，设备选择为**iPhone**，并勾选**Use Core Data**。你的组织名称和组织标识符应该已经自动填充，填入的是你在第一章中创建 Hello World 应用时输入的值。

点击 **Next**。在弹出的对话框中，选择你要保存项目的位置并点击 **Create**。你的 Xcode 项目应该会自动打开。花点时间确认你的项目导航器中是否列出了名为 *BirthdayTracker.xcdatamodeld* 的文件（参见图 9-2）。

![Image](img/Image00197.jpg)

*图 9-2：确保你在新项目中有一个* BirthdayTracker.xcdatamodeld *文件。*

你需要 *BirthdayTracker.xcdatamodeld* 来保存 iPhone 上的生日数据。如果它缺失了，那意味着你在创建 Xcode 项目时没有勾选 Use Core Data 选项。别担心——这很容易修复。

如果你的*BirthdayTracker.xcdatamodeld*文件丢失，关闭你的项目（文件 ▸ 关闭项目），然后重新创建一个新的 Xcode 项目，确保勾选了“使用 Core Data”选项。当系统询问你是否要替换 BirthdayTracker 项目时，只需点击**替换**，就可以顺利开始了！

你的新 BirthdayTracker Xcode 项目将会打开。如果你还没有将 Apple 账户添加到 Xcode，你会在应用的“常规”设置中的“签名”部分看到一条消息，提示“未找到账户”。除非你想在真实设备上运行应用，否则你不需要添加账户。（记住，你也可以在 Xcode 的模拟器上运行应用。）要将 Apple 账户添加到 Xcode，请点击**添加账户**按钮。（有关如何添加 Apple 账户的详细说明，请参阅《你的第一款应用！》，第 5 页 。）

此“常规”设置屏幕还是你设置应用运行设备方向的地方。我们希望 BirthdayTracker 应用仅在*竖屏*模式下运行。竖屏模式是手机的常规方向，底部是主页按钮。*横屏*模式则是你将手机横过来，屏幕也随之旋转，屏幕的宽度变成了手机的高度，而屏幕的高度变成了手机的宽度。BirthdayTracker 应用在横屏模式下显示效果不佳，因此我们不希望用户将手机转到横屏时，屏幕会变化。应用倒过来运行也是可以的，但如果用户将手机转过来，且主页按钮在上方，屏幕却翻转，这样会让用户感到迷惑，因此我们也不支持倒立模式。在“部署信息”部分，在设备方向旁边，取消勾选**左横屏**和**右横屏**，确保仅勾选**竖屏**。

让我们来看看 Xcode。选择左侧导航栏中的*ViewController.swift*，你应该会看到类似于图 9-3 的界面。

![图片](img/Image00198.jpg)![图片](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的构成*

左侧是导航面板 ➊ ，你可以通过**视图** ▸ **导航器** ▸ **隐藏/显示导航器**，或者按⌘ -0 来隐藏或显示它。你将使用导航器选择和查看项目中的文件。

编辑器面板位于窗口的中央 ➋ 。在这里你将编写代码！这是你可以更改应用设置和使用故事板布局应用中显示内容的地方，你在第一章中已经见过故事板。我们稍后会详细讲解故事板。

右侧是实用工具面板 ➌ ，你可以通过选择**视图** ▸ **实用工具** ▸ **隐藏/显示实用工具**，或者按⌘ -OPTION -0 来隐藏或显示它。当故事板打开时，实用工具面板将帮助你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都会有一个图标，显示在用户设备的主屏幕上。我们将通过添加一个应用图标来开始我们的 BirthdayTracker 应用。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图像。下载 ZIP 文件后，你会在 *Downloads* 文件夹中看到一个名为 *ch9-images* 的文件夹，里面包含你需要的图像文件。拿到这些图像后，从 Project navigator 中选择 *Assets.xcassets*。这将打开应用的 *资产目录*，你可以在这里添加应用需要使用的任何 *资源*（图像、声音等），包括应用图标。事实上，资产目录已经有一个占位符，你可以在其中添加你的图标。选择目录左侧菜单中的 **AppIcon**，你应该会看到多个图像占位符。

要添加一个应用图标，以便在 iPhone 主屏幕上显示，你需要提供标记为 *iPhone App* 的图标集的 2x 和 3x 图像。2x 尺寸适用于大多数 iPhone，比如 iPhone 5、6 和 7。而较大的 iPhone，例如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸的图像。你将在第十四章中学习如何为不同的屏幕分辨率调整图像大小。

将图标添加到资产目录非常简单！下载提供的图像后，打开 Finder 中的 *Downloads* 文件夹。然后，只需将图像 *cake@2x.png* 拖到 iPhone App 2x 框中，将 *cake@3x.png* 拖到 3x 框中。当你完成后，资产目录应如下所示 图 9-4。

![图片](img/Image00200.jpg)

*图 9-4：我们现在有了一个应用图标！*

除了应用图标，应用还会有一个显示名称，它会显示在主屏幕图标下方。默认情况下，这个名称就是应用名称，BirthdayTracker。然而，这个名称稍微有点长，不能完全显示在图标下方，因此我们将其改为一个较短的名称：Birthdays。为此，返回设置页面，选择 Project navigator 中的 BirthdayTracker 项目。在顶部的 Identity 部分，你可以更改应用的显示名称。只需在显示名称文本框中输入 **Birthdays**。这样做只会更改图标下方显示的名称，项目名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，让我们来创建应用的界面吧！

### 显示朋友的生日

从 Project navigator 中选择 *Main.storyboard* 打开故事板。这是我们将设计应用 *用户界面* 的地方。用户界面是用户看到并与应用交互的部分——例如图像、文本、按钮等。*故事板* 让你可以可视化地组织应用的所有界面，并查看它们之间的连接。

一旦你选择了*Main.storyboard*，通过按 ⌘ -0 隐藏导航面板，以便腾出更多的屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在看看实用工具面板的顶部。你应该能看到一个带有六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更仔细查看故事板中元素的工具，并允许你更改这些元素的设置。当你选择一个检查器时，它会出现在实用工具面板中。

**检查故事板项目**

图 9-5 展示了当故事板打开时，出现在实用工具面板中的检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：在故事板的实用工具面板中，有六个检查器可以使用。*

我们从左到右浏览这些检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书和大多数应用程序中，你不会使用这个检查器。

下一个检查器，标识为一个问号图标，是快速帮助检查器。这个检查器会为你提供关于当前在故事板中选择的项目的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里，你可以为故事板项目设置自定义类。

接下来的两个检查器是你在工作中最常用的检查器，我们会在文本中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置故事板中选定项目的各种属性。例如，它可以用来设置标签的文本、按钮的颜色，或者文本输入框周围显示的框类型。尺寸检查器，带有尺子图标，用于设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，它的图标看起来像一个圆圈中的箭头。这个检查器可以用来将你在故事板中的项目与类中编写的代码连接起来。我们将在第十章中教你如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊类型的视图控制器，显示一个列表，在 Xcode 中被称为*表格视图控制器*。在我们的应用中，表格视图控制器将显示你朋友的生日列表！目前它看起来只是一个空白屏幕，你将学会如何在“创建生日表格视图控制器”中显示生日数据，见第 156 页。

让我们将表格视图控制器添加到故事板中。如果你首先将故事板缩小，这一步会更容易，这样你可以更好地看到视图控制器。双击视图控制器外的空白区域来进行缩放。现在，你的屏幕应该已经缩小了。

在工具面板的底部，有一个包含四个按钮的区域。选择第三个按钮，它看起来像是一个圆圈内的正方形。这是对象库，在这里你可以找到要添加到故事板中的元素。滚动浏览对象库，直到找到表格视图控制器，或者使用面板底部的筛选条搜索“table view controller”。然后点击并拖动该对象到你的故事板中，放在已有视图控制器旁边。你的故事板应该像图 9-6 中的样子。

请注意，在你添加表格视图控制器后，左侧大纲视图中会出现一个“表格视图控制器场景”条目，其中包含一个表格视图控制器。故事板中的场景表示应用中屏幕上的区域。对于 iPhone 应用，通常每次屏幕上只显示一个场景，并且该场景会填满整个屏幕。而 iPad 应用可以在同一时间显示两个或多个场景。

![图片](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到生日屏幕的故事板中*

下一步是将这个新视图控制器设置为应用启动时首先显示的屏幕，因为我们希望用户打开应用时能看到生日列表。完成此操作的步骤在图 9-7 中展示。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊ 。然后在工具面板中打开属性检查器 ➋ 。在这里，勾选**是初始视图控制器** ➌ 。完成后，故事板中的表格视图控制器左侧应该出现一个箭头。这个箭头表示应用在启动时会显示这个视图控制器。

#### 添加导航控制器

现在我们将在视图控制器中添加一个标题“Birthdays”和一个“添加”按钮，点击该按钮会打开添加生日的视图控制器。为此，我们首先将表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧显示按钮，允许用户导航到应用中的其他屏幕。在许多 iOS 应用中，你可以看到这个导航栏，例如设置应用和信息应用。

在大纲视图中选择**表视图控制器**。选择后，你需要使用 Xcode 菜单将表视图控制器嵌入到导航控制器中。点击**Editor** ▸ **Embed In** ▸ **Navigation Controller**。

在将表视图控制器嵌入导航控制器后，你的 storyboard 应该看起来像图 9-8 中所示的那样。导航控制器将作为一个屏幕出现在 storyboard 中。

![Image](img/Image00204.jpg)

*图 9-8: 导航控制器*

每个 storyboard 中的视图控制器代表用户将看到的应用屏幕，但导航控制器略有不同。虽然它在 storyboard 中看起来像一个独立的屏幕，但导航控制器实际上只是一个容器，保存着用户在应用中移动的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在不同的视图之间进行导航，并且可以返回。

你应该能看到导航控制器和表视图控制器顶部的灰色导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，并可能包含按钮和箭头，供他们用来前往其他屏幕。为了通过导航栏告知用户他们所在的屏幕，我们需要给屏幕命名标题。现在是回到 storyboard 的好时机。双击 storyboard 中的空白区域放大视图，然后滚动视图，直到你能看到表视图控制器。要为表视图控制器添加标题，点击大纲视图中**Table View Controller Scene**下的**Navigation Item**。

![Image](img/Image00205.jpg)

选中该项后，你可以在右侧的属性检查器中为该屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。完成此步骤并按下回车后，大纲视图中的 Table View Controller Scene 条目会自动更新为“Birthdays Scene”。

接下来，我们将制作一个“添加”按钮，方便你添加生日！

#### 添加按钮

我们希望用户能够打开应用，查看生日列表，并将生日添加到该列表中。让我们创建一个按钮来实现这个功能！

我们需要在导航栏中添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。在对象库中找到“Bar Button Item”，然后将其拖放到表视图控制器的导航栏右侧，如图 9-9 所示。

现在我们想把这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮。进入属性检查器，将 bar button item 的系统项改为**Add**。你应该会看到按钮变成一个加号 (+)。

接下来，我们需要告诉按钮在点击时应该执行什么操作。我们希望它打开“添加生日”视图控制器，因此我们需要将“添加”按钮连接到该视图控制器。首先，双击故事板缩小视图，确保你能够看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，并从“+”按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标，这时会弹出一个连接对话框，类似于图 9-10 所示。

![图片](img/Image00206.jpg)

*图 9-9：将一个条形按钮项拖到“生日”视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态呈现”选项。*

连接对话框为你提供了几种不同类型的*segue*（即从一个屏幕到下一个屏幕的过渡）选项。点击连接对话框中的**模态呈现**选项，这样视图控制器就会以*模态*的形式显示在屏幕上。在 iPhone 上，模态视图控制器从手机底部滑入，并且它默认不带返回按钮，无法返回到之前的屏幕。相反，模态视图可以有其他按钮，例如取消或保存。还有其他类型的 segue，例如“显示”segue，它会将视图控制器从右侧推入屏幕，并且左侧导航栏会有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，应该以模态的形式呈现该屏幕，并配备一个取消按钮。否则，如果你使用类似“显示”segue 的方式，并带有返回按钮，用户可能会输入所有信息后直接点击返回按钮，结果什么都没有保存！使用取消按钮，用户必须故意点击取消才能退出屏幕。

要查看一个好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。打开日历应用后，在导航栏的右侧有一个“+”按钮，你可以点击它来添加日历事件。点击“+”按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，点击它可以在不保存的情况下退出界面，右侧有一个添加按钮，点击它可以在关闭模态之前创建新的事件。你应该能看到，新事件模态视图从屏幕底部滑入，关闭时又从屏幕底部滑出。我们希望用户保存生日，因此我们也将使用模态视图。

现在让我们试着运行一下应用，看看我们到目前为止做了什么！要运行应用，首先选择一个设备模拟器，方法是点击 Xcode 左上角显示在 BirthdayTracker 旁边的设备（参见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，应用名称旁边设置模拟器运行的设备。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R**。

当模拟器启动并运行你的应用时，如果模拟器太大无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器以选择它，然后转到 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的比例。

到目前为止，当你运行应用时，没有太多变化。你应该能看到你第一个 "Birthdays" 屏幕，并且有一个 + 按钮，如图 9-1 中所示。显然，此时你的 "Birthdays" 屏幕是空的。点击 + 按钮会弹出第二个空白屏幕。查看完应用后，通过点击 Xcode 中的停止按钮来关闭它，停止按钮就在你之前点击的播放按钮旁边。当你停止应用后，你应该能在模拟器的主屏幕上看到你的应用图标！（参见图 9-12。）

就这样！我们现在需要配置第二个屏幕，以便可以用来添加生日！

![图片](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计 "添加生日" 视图控制器，首先添加它的标题。为此，你需要将其嵌入到自己的导航控制器中。当视图控制器是模态时，它不会继承我们在故事板中已设置的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击故事板中的普通视图控制器来选择它。然后，转到 **编辑** ▸ **嵌入** ▸ **导航控制器**。现在，你应该能看到在视图控制器场景下的轮廓视图中添加了一个导航项。点击这个新导航项，然后在属性检查器中添加标题 **添加生日**。这些步骤与当你将标题 "Birthdays" 添加到表视图控制器时是相同的。

现在，当 "添加生日" 视图控制器出现在应用中时，它的标题会显示在顶部。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友的生日时，你的应用程序中的每一条记录都将包含名字、姓氏和出生日期。我们来向“添加生日”视图控制器中添加一些*输入控件*，以便用户为每个人输入所有这些信息。输入控件是让用户将数据输入到应用程序中的控件，例如文本框或下拉菜单。我们将首先为用户可以添加的所有信息添加输入控件标签。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个显示“First Name”的标签。这个标签将位于一个文本框旁边，用户将在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name** 作为显示文本，如图 9-14 所示。

现在我们希望使用“尺寸检查器”设置标签的大小和位置。在 Xcode 的情节管理器中，宽度和高度是以*点*为单位进行测量的。注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点将转换为 1 像素、2×2 像素的方块或 3×3 像素的方块。这三种缩放因子被称为 @1x、@2x 和 @3x（我们在设置应用程序图标时提到过的相同尺寸）。设备的点分辨率也并不相同，宽度范围从 320 到 1,024 点，高度范围从 568 到 1,366 点。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最老款的 iPhone 和 iPod 使用 @1x 缩放因子，你将无法在这些型号上运行你的应用程序（BirthdayTracker 只支持 iOS 10 及以上版本）。除非你的 iPhone 6 Plus、6s Plus 或 7 Plus 否则你的手机或 iPod 很可能使用 @2x 缩放因子，这些设备使用的是 @3x 缩放因子。

一个物体在屏幕上的位置也是基于点数的。物体的 x 位置是从屏幕左侧到物体左侧的距离（以点为单位）。y 位置是从屏幕顶部到物体顶部的距离（以点为单位）。（参见图 9-15）。我们将为每个我们添加到视图控制器中的库对象设置 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示屏幕上物体的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕的边缘之外，但仍然为其文本输入框和其他标签及输入框留出足够的空间。在“尺寸检查器”的“视图”部分中，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成这个后，重复这些步骤，在“添加生日”视图控制器中添加两个标签：姓氏标签和出生日期标签。我们需要调整其他标签和输入控件的位置，以避免重叠。在某些情况下，这可能会变得有些复杂，并且可能需要一些时间。对于这个应用，我们已为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后我们会解释如何使你的应用适配其他设备。表 9-1 列出了每个标签的大小和位置。

表 9-1：视图控制器中的输入标签设置

| 显示文本 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 坐标相同，这样它们就会垂直对齐，但每个标签的 y 坐标不同。每个标签的高度为 21，因此 y 坐标需要比下一个标签大至少 21 个点。由于我们还将在每个标签下方添加输入控件，因此我们将 y 坐标设置得更大，以容纳标签和输入控件的高度。

很棒！现在你的故事板应该看起来像图 9-16 中的那样。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来你将添加两个*文本字段*，让你输入名字和姓氏。文本字段是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个用来输入名字，另一个用来输入姓氏。根据表 9-2 中所示，设置这两个文本字段的大小和位置。你可以通过大小检查器来设置，正如你为标签所做的那样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做*日期选择器*的控件。它将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于选择日期或时间的标准工具。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器一样（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，使用日期选择器来选择日期。*

日期选择器也可以只显示时间，比如在时钟应用中添加闹钟时使用的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到你找到日期选择器，然后点击并将其拖动到出生日期标签下的视图控制器上。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们把这个日期改成你的生日！将日期字段从当前日期改为**自定义**。这样会出现一个新框，将日期更改为你的生日。

让我们通过运行应用程序来测试目前的工作效果！我们为输入控件设置的尺寸非常适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你点击出生日期视图控制器上的+按钮时，应该会显示添加生日的屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很不错，但其他设备呢？选择一个更小的模拟器，如 iPhone 5s，再次运行应用程序。你会看到界面看起来有些不对劲。

所有你添加到故事板中的元素都会显示出来，但文本框已经超出了屏幕边缘。现在，你已将所有元素放在屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都适配正确。我们将使用一个叫做*自动布局*的工具来完成这项工作。

#### 让你的应用在每个设备上看起来完美，通过自动布局

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能会有更多尺寸出现。你需要设计你的应用程序，使其在任何设备上都看起来不错。这意味着你需要让你的应用程序根据运行的设备调整界面上所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标，弹出自动布局菜单。*

在屏幕故事板面板的底部，有一个带图标的带状工具条，靠近实用工具面板的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该显示一个标签，上面写着“解决自动布局问题”。点击该图标以显示建议菜单。点击**添加缺失约束**。^(*) 完成后，你会看到许多布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局使得日期选择器的大小适应屏幕的宽度，不会超出其边缘。自动布局还会确保每个文本字段前后都有 20 点的间距，以便它们能够在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成操作，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。这些按钮目前不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消“添加生日”屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右侧*。我们将把这个按钮更改为保存按钮，就像我们对添加按钮所做的那样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中再拖动一个“Bar Button Item”，这次将其放置在导航栏的*左侧*。使用属性检查器将其更改为取消按钮，就像你对保存按钮所做的那样。你的视图控制器应该看起来像图 9-21 中所示的样子。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新按钮的效果！

点击生日表视图控制器上的 + 按钮应该会带你进入“添加生日”视图控制器，你可以在其中输入某人的姓名和出生日期。点击取消和保存按钮目前不会执行任何操作——我们将在第十章中实现它们！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用，创建了“生日”和“添加生日”界面的基本用户界面。你还使用表视图控制器创建了“生日”屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用程序的基本框架，在第十章中，你将编程实现取消和保存按钮，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个苹果的 bug。在这种情况下，选择**重置为缺失约束**选项以添加缺失的约束。

*图 9-1：我们将在接下来的几章中构建的完成应用的预览*

生日屏幕会显示你已添加的生日列表，而“添加生日”屏幕是你可以添加新生日条目的地方。

在 Xcode 中，屏幕包括一个*视图*和一个*视图控制器*。视图是你在屏幕上看到的内容，视图控制器包含了所有用 Swift 编写的代码来控制视图。你可以在图 9-1 中看到，生日视图的右上角有一个看起来像加号（+）的“添加”按钮。

添加按钮会打开“添加生日”视图，用户可以在这里输入新朋友的生日详情。让我们开始创建一个新的 Xcode 项目，用于我们的 BirthdayTracker。

### 创建一个新的 Xcode 项目

到目前为止，你一直在 playground 中编写大部分代码。Playground 是学习编程的好地方，但要编写一个可以在 iPad 或 iPhone 上运行的应用，你需要像在第一章中为 Hello World 应用所做的那样，创建一个 Xcode 项目。

在 Xcode 菜单中，选择**文件** ▸ **新建** ▸ **项目**。在对话框的顶部选择**iOS**，然后选择**单视图应用程序**作为项目模板，点击**下一步**。

在出现的对话框中，Xcode 会要求你为你的新应用设置一些选项。由于这只是一个示例，你不需要*太*认真对待这一部分。在你编写一个计划出售或分发到 App Store 的应用时，设置这些值要重要得多。将你的应用命名为**BirthdayTracker**，确保语言选择为**Swift**，设备设置为**iPhone**，并勾选**使用核心数据**。你的组织名称和组织标识符应会自动填充为你在第一章中创建 Hello World 应用时输入的值。

点击**下一步**。在弹出的对话框中，选择你想保存项目的位置，然后点击**创建**。你的 Xcode 项目应该会自动打开。花点时间确保在项目导航器中列出了一个名为*BirthdayTracker.xcdatamodeld*的文件（见图 9-2）。

![Image](img/Image00197.jpg)

*图 9-2：确保你的新项目中有一个*BirthdayTracker.xcdatamodeld*文件。*

你需要*BirthdayTracker.xcdatamodeld*来在 iPhone 上保存生日。如果这个文件丢失，说明你在创建 Xcode 项目时没有勾选“使用核心数据”选项。别担心——这很容易修复。

如果你的 *BirthdayTracker.xcdatamodeld* 文件丢失，关闭你的项目（文件 ▸ 关闭项目），然后通过创建一个勾选了“使用 Core Data”框的新 Xcode 项目重新开始。当系统询问是否要替换 BirthdayTracker 项目时，只需点击**替换**，你就准备好开始了！

你的新 BirthdayTracker Xcode 项目将会打开。如果你还没有将你的 Apple 账号添加到 Xcode 中，你会在常规应用设置中的签名部分看到一条消息，提示“未找到账户”。除非你想在真实设备上运行应用，否则无需添加账户。（记住，你也可以在 Xcode 的模拟器上运行你的应用。）要将 Apple 账号添加到 Xcode，点击**添加账户**按钮。（关于如何添加 Apple 账户的详细说明，请参阅《你的第一个应用！ 》中的第 5 页。）

这个常规设置屏幕也是你设置应用运行时设备方向的地方。我们希望 BirthdayTracker 应用仅在*竖屏*模式下运行。竖屏模式是手机的常规方向，主屏幕按钮位于底部。*横屏*模式是当你将手机转横，屏幕也会旋转，这时屏幕的宽度变成手机的高度，屏幕的高度变成手机的宽度。BirthdayTracker 应用在横屏模式下显示效果不好，所以我们不会让屏幕在用户将手机横过来时旋转。应用倒过来看没有问题，但如果屏幕在用户将手机转过来时翻转，可能会让用户感到困惑，所以我们也不支持倒置模式。在部署信息部分，在设备方向旁边，取消勾选**左横屏**和**右横屏**，并确保仅勾选**竖屏**。

让我们看看 Xcode 的界面。选择左侧导航面板中的*ViewController.swift*，你应该会看到类似图 9-3 的界面。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航面板 ➊ ，你可以通过选择**视图** ▸ **导航器** ▸ **隐藏/显示导航器**，或者按 ⌘ -0 来隐藏或显示它。你将使用导航器选择并查看项目中的文件。

编辑器面板位于窗口的中央 ➋ 。这里是你编写代码的地方！也是你可以更改应用设置并使用故事板布局在应用中显示项目的地方，你在第一章中看到过故事板。我们很快会详细讨论故事板。

右侧是工具面板 ➌ ，你可以通过选择**视图** ▸ **工具** ▸ **隐藏/显示工具**，或者按 ⌘ -OPTION -0 来隐藏或显示它。当故事板打开时，工具面板允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用程序都会有某种图标，显示在用户设备的主屏幕上。我们将通过添加应用程序图标开始创建我们的 BirthdayTracker 应用程序。你可以从*[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)*下载我们将用于图标的两张图像。下载 ZIP 文件后，你将在*Downloads*文件夹中找到一个名为*ch9-images*的文件夹，里面包含你需要的图像文件。获得这些文件后，从项目导航器中选择*Assets.xcassets*。这将打开应用程序的*资源目录*，这里是你放置应用程序将使用的任何*资源*（图像、声音等）的位置，包括应用程序图标。实际上，资源目录已经包含了一个占位符，你可以在其中添加图标。从目录左侧的菜单中选择**AppIcon**，你应该能看到几个图像占位符。

要添加一个将在 iPhone 主屏幕上显示的应用程序图标，你需要为标记为*iPhone App*的图标集提供 2x 和 3x 图像。2x 尺寸适用于大多数 iPhone，如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，使用 3x 尺寸的图像。你将在第十四章中学到更多关于为不同屏幕分辨率调整图像尺寸的知识。

将图标添加到资源目录中非常简单！下载提供的图像后，在 Finder 中打开*Downloads*文件夹。然后，只需将图像*cake@2x.png*拖到 iPhone App 2x 框中，并将*cake@3x.png*拖到 3x 框中。完成后，你的资源目录应如下所示：图 9-4。

![Image](img/Image00200.jpg)

*图 9-4：现在我们有了应用程序图标！*

除了应用程序图标，应用程序还有一个显示名称，显示在主页图标下方。默认情况下，这个名称就是应用程序的名称“BirthdayTracker”。但是，这个名称有点长，不能完全显示在图标下方，因此我们将其更改为一个更短的名称：“Birthdays”。为此，返回设置页面，在项目导航器中选择 BirthdayTracker 项目。在顶部的“Identity”部分，你可以更改应用程序的显示名称。只需在显示名称文本框中输入**Birthdays**即可。这只会更改显示在应用程序图标下方的名称。项目的名称仍然是 BirthdayTracker。

现在我们已经设置了应用程序图标和显示名称，接下来让我们创建应用程序的屏幕！

### 显示你朋友的生日

在项目导航器中选择*Main.storyboard*以打开故事板。这是我们设计应用程序*用户界面*的地方。用户界面只是用户与应用程序互动时会看到并使用的内容的一个花哨名称——如图像、文本、按钮等。*故事板*让你可以直观地组织应用程序的屏幕。我们将使用故事板来查看所有使用的屏幕及它们之间的连接。

一旦你选择了*Main.storyboard*，按下⌘-0 隐藏导航窗格，这样你就有更多的屏幕空间了。你的故事板应该已经包含一个视图控制器。

现在看看工具窗格的顶部。你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是一些帮助你更仔细查看故事板中元素的工具，并允许你更改这些元素的设置。当你选择其中一个检查器时，它会出现在工具窗格中。

**检查故事板项**

图 9-5 展示了当故事板打开时，工具窗格中显示的检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：在故事板的工具窗格中，你可以使用六个检查器。*

让我们从左到右依次了解这些检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书中以及你的大多数应用中，你不会使用这个检查器。

下一个检查器，标有问号图标，是快速帮助检查器。这个检查器会提供关于你当前在故事板中选定项的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里，你可以为故事板项设置自定义类。

接下来的两个检查器是你在工作中最常用的检查器，我们将在文本中经常提到它们。属性检查器的图标看起来像一个盾牌。这个检查器用于设置故事板中选定项的各种属性。比如可以用它来设置标签的文本、按钮的颜色，或文本输入框周围显示的框的类型等。尺寸检查器，图标是一个尺子，用来设置每个故事板项的大小和屏幕位置。

最后是连接检查器，它的图标像一个圆圈中的箭头。这个检查器可以用于将故事板中的元素与在类中编写的代码片段连接起来。我们将在第十章中展示如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是“生日视图控制器”。这将是一个特殊的视图控制器类，用于显示一个列表，在 Xcode 中称为*表格视图控制器*。在我们的应用中，表格视图控制器将显示你朋友们的生日列表！现在它看起来只是一个空白屏幕，你将在“创建生日表格视图控制器”第 156 页学习如何显示生日数据。

让我们将表格视图控制器添加到故事板中。如果您首先将视图缩小，这一步会更容易，因为这样您可以更清晰地看到视图控制器。只需双击故事板中视图控制器外的空白区域即可缩小视图。现在您的屏幕应该已经缩小了。

在“实用工具”窗格的底部，有一个包含四个按钮的区域。选择第三个按钮，形状像一个圆圈中的正方形。这是对象库，您可以在这里找到要添加到故事板中的项目。向下滚动对象库列表，直到找到表格视图控制器，或者使用窗格底部的过滤栏搜索“table view controller”。然后单击并将该对象拖动到您的故事板中，放置在已经存在的视图控制器旁边。您的故事板应当与图 9-6 中所示的相同。

请注意，添加表格视图控制器后，左侧的大纲视图中会出现一个“表格视图控制器场景”条目，并且其中包含一个表格视图控制器。故事板中的一个场景代表了应用屏幕上的一个区域。对于 iPhone 应用，通常一次屏幕上只会显示一个场景，并且该场景会填满整个屏幕。而 iPad 应用则可以在屏幕上同时显示两个或更多的场景。

![图片](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到生日屏幕的故事板中*

下一步是将这个新的视图控制器设置为应用运行时首先显示的屏幕，因为我们希望在用户打开应用时显示生日列表。执行此操作的步骤如图 9-7 所示。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后在实用工具窗格中打开属性检查器 ➋。在这里，勾选**是初始视图控制器**的选项 ➌。完成后，您应该会在故事板中看到表格视图控制器左侧出现一个箭头。这个箭头表示应用启动时会显示这个视图控制器。

#### 添加导航控制器

现在，我们将为视图控制器添加一个标题“生日”，并添加一个“添加”按钮，用于显示“添加生日”视图控制器。为此，我们首先将表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且两侧可以有按钮，帮助导航到应用中的其他屏幕。您在许多 iOS 应用中看到的导航栏，像设置应用和信息应用，都是这种形式。

在大纲视图中选择**表格视图控制器**。选择后，你需要使用 Xcode 菜单将表格视图控制器嵌入到导航控制器中。进入 **编辑** ▸ **嵌入到** ▸ **导航控制器**。

当表格视图控制器嵌入到导航控制器中时，你的故事板应该看起来像图 9-8 所示。导航控制器将作为故事板中的一个屏幕出现。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表一个用户将看到的屏幕，但导航控制器略有不同。尽管它在故事板中看起来像一个独立的屏幕，实际上导航控制器只是一个容器，里面包含了用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以从一个视图导航到另一个视图，并能返回。

你应该能在导航控制器和表格视图控制器的顶部看到灰色的导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能还包含按钮和箭头，用户可以用它们来进入其他屏幕。为了利用导航栏告诉用户当前所在的屏幕，我们需要为屏幕命名。现在是回到故事板的好时机。双击故事板中的空白处以放大视图，然后滚动视图，直到你能看到表格视图控制器。要为表格视图控制器添加标题，在左侧大纲视图中的**表格视图控制器场景**下点击**导航项**。

![图片](img/Image00205.jpg)

选中后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。完成此步骤并按下 RETURN 键后，你应该会看到大纲视图中的表格视图控制器场景条目自动更新为“生日场景”。

接下来，我们将制作一个“添加”按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并向列表中添加生日。让我们制作一个按钮来实现这个功能！

我们需要在导航栏中添加一个按钮，链接到“添加生日”场景，以便用户可以输入生日。在对象库中找到“条形按钮项”，然后将其拖动并放置到表格视图控制器导航栏的右侧，如图 9-9 所示。

现在我们想将这个按钮变成“添加”按钮。幸运的是，Xcode 提供了一个内建的“添加”按钮供我们使用。在属性检查器中，将条形按钮项的系统项更改为**添加**。你应该看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在被点击时应该执行什么操作。我们希望它打开“添加生日”视图控制器，所以需要将添加按钮与该视图控制器连接起来。首先，双击故事板以缩小视图，确保你能看到“生日”表视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从“+”按钮拖动到故事板右侧空白视图控制器的中央。当视图控制器被高亮显示时松开鼠标，这时会弹出一个连接对话框，如图 9-10 所示。

![图片](img/Image00206.jpg)

*图 9-9：将一个“Bar Button Item”拖动到“生日”视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态呈现”。*

连接对话框为你提供了几种关于*segue*（从一个屏幕到另一个屏幕的过渡效果）的选择。点击连接对话框中的**模态呈现**选项。这样视图控制器就会以*模态*的形式显示在屏幕上。在 iPhone 上，模态视图控制器从手机底部呈现，并且它不会自动带有返回按钮来返回到上一屏幕。相反，模态视图可以有其他按钮，比如取消或保存。还有其他类型的 segue，比如“展示”segue，它会将视图控制器从右侧推出，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，应该以模态方式呈现该屏幕，并且应该有一个取消按钮。否则，如果你使用像“展示”segue 带有返回按钮，用户可能会输入所有内容后点击返回按钮，结果没有保存任何内容！使用取消按钮时，用户必须刻意点击取消按钮才能退出该屏幕。

要查看一个好的模态输入视图控制器示例，可以看看 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧会有一个“+”按钮，你可以点击它来添加一个日历事件。点击“+”按钮后会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出，右侧有一个添加按钮，用于在关闭模态前创建新事件。你应该注意到，“新事件”模态视图从屏幕底部弹出，当被关闭时又会从屏幕底部收回。我们希望用户保存生日，因此我们也会使用模态视图。

现在让我们试着运行我们的应用，看看我们到目前为止做了什么！要运行应用，首先在 Xcode 的左上角点击列出的设备，选择一个设备模拟器（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器运行的设备，位于你的应用名称旁边。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择完模拟器后，点击左上角的播放按钮，或使用快捷键⌘-**R**。

当模拟器启动运行你的应用时，如果模拟器窗口过大而无法适应电脑屏幕，你可以调整它的大小。点击模拟器选择它，然后转到**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时，应用内并没有发生太多变化。你应该能看到你的第一个“生日”屏幕，并且有一个+按钮，如图 9-1 所示。显然，此时你的“生日”屏幕是空的。点击+按钮会弹出第二个空白屏幕。看完应用后，通过点击 Xcode 中的停止按钮（位于你之前点击的播放按钮旁边）来关闭应用。当你停止应用后，你应该会在模拟器的主屏幕上看到你的应用图标！（参见图 9-12）

就这样！我们现在需要配置第二个屏幕，以便它可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已被添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，首先添加其标题。为此，你需要将其嵌入一个自己的导航控制器中。当视图控制器是模态视图时，它不会继承我们在故事板上已经存在的导航控制器中的导航栏。导航控制器提供导航栏，所以我们需要将模态视图控制器嵌入它自己的导航控制器中。通过在故事板中点击视图控制器来选择它。然后，转到**编辑** ▸ **嵌入** ▸ **导航控制器**。现在，你应该能看到一个导航项目已被添加到“视图控制器场景”的大纲视图下。点击这个新添加的导航项目，然后在属性检查器中添加标题**添加生日**。这些步骤和你为表格视图控制器添加“生日”标题时使用的步骤是一样的。

现在，当“添加生日”视图控制器出现在应用程序中时，它将在顶部显示其标题。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友的生日时，你的应用程序中的每个条目将包括一个名字、一个姓氏和一个出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入所有这些信息。输入控件是类似文本框或下拉菜单的元素，允许用户在应用程序中输入数据。我们将首先添加所有用户可以输入信息的输入控件标签。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“First Name”的标签。这个标签将位于一个文本框旁边，你可以在其中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器上（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在我们想使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*为单位来测量的。注意，1 个点并不等于 1 个像素。根据你的应用运行的设备类型，1 个点将转换为 1 个像素、一个 2×2 像素的正方形或一个 3×3 像素的正方形。这三个缩放因子被称为@1x、@2x 和@3x（我们在设置应用图标时讨论过的相同尺寸）。设备的点分辨率也并非完全相同，宽度可以从 320 到 1024 点不等，高度可以从 568 到 1366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最老的 iPhone 和 iPod 型号使用@1x 缩放因子，而且你无法在这些设备上运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它很可能使用@2x 缩放因子，而这三款设备则使用@3x 缩放因子。

对象在屏幕上的位置也是基于点来确定的。对象的 x 位置是从屏幕左边缘到对象左边缘的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（参见图 9-15）。我们将设置每个添加到视图控制器中的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位，使其不紧靠屏幕边缘，但仍然为其文本输入框和其他标签及输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成这一步后，重复这些步骤，向“添加生日”视图控制器中添加两个标签：一个是姓氏标签，一个是生日标签。我们需要定位其他的标签和输入框，确保它们不会重叠。在某些情况下，这可能会有些棘手，并且可能需要一些时间。对于这个应用程序，我们已经为你计算了可以放置对象的位置，适用于 iPhone 7 的屏幕。稍后，我们将解释如何让你的应用在其他设备上运行。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，这样它们在垂直方向上对齐，但它们的 y 位置不同。每个标签的高度都是 21，因此 y 位置需要比下一个最接近的标签高出至少 21 个点。由于我们在每个标签下方也添加了输入控件，因此我们将 y 位置设置得更大，以便同时容纳标签的高度和输入控件的高度。

太好了！现在你的故事板应该像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已被添加到视图控制器中。*

接下来，你将添加两个*文本字段*，用于输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在该字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器上。一个将用于输入名字，另一个将用于输入姓氏。给这两个文本字段设置表 9-2 中看到的大小和位置。你可以使用大小检查器来完成这一步，就像你之前为标签做的一样。

表 9-2：视图控制器中输入的文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个称为*日期选择器*的轮盘。它将使你能够轻松输入生日日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以同时包含日期和时间，像在日历应用中使用的日期选择器（参见图 9-17）一样。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器进行日期选择。*

日期选择器还可以仅显示时间，就像时钟应用中用于设置闹钟的日期选择器，或者仅显示日期，这就是我们在 BirthdayTracker 中将使用的方式。

在对象库中滚动，直到找到一个日期选择器，然后将其点击并拖动到 Birthdate 标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器进行选中。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将这个日期更改为你的生日！将日期字段从当前日期更改为**自定义**。当你这样做时，一个新的框会出现。将日期更改为你的生日。

让我们通过运行应用来测试目前的效果！我们为输入控件设置的大小在 iPhone 7 屏幕上看起来不错。所以选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这一次，当你点击 Birthdays 视图控制器上的 + 按钮时，添加生日的界面应该会显示出来，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很不错，但其他设备呢？选择一个更小的模拟器运行应用，比如 iPhone 5s，然后重新运行应用。你会发现显示效果似乎有点问题。

所有你添加到故事板中的元素都出现了，但文本框超出了屏幕边缘。现在你已经将所有元素放到屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来完成这项工作。

#### 使用自动布局让你的应用在每个设备上看起来都完美

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会有更多尺寸。你需要设计你的应用，使其在任何设备上都能看起来不错。这意味着你希望你的应用能够根据设备的不同，自动调整应用中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的机制来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部第四个图标，打开自动布局菜单。*

在屏幕的故事板面板底部，有一个包含图标的功能区，紧靠在工具面板左侧的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，内容是“解决自动布局问题”。点击该图标，会弹出一系列建议的菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到许多布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小都正确地适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕，不会超出屏幕边缘。自动布局还会确保每个文本框前后都有 20 点的间距，以便它们能够在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

完成这些步骤后，我们将展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。按钮现在还没有任何功能，我们只是设置它们。在第十章中，我们将添加一些代码，使按钮能够取消并返回“添加生日”界面，并将生日保存到应用中。

要添加保存按钮，拖动一个“Bar Button Item”从对象库并将其放置在导航栏的*右*侧。我们将把这个按钮改为保存按钮，就像我们之前为添加按钮做的那样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左*侧。使用属性检查器将其更改为取消按钮，就像你做保存按钮时那样。你的视图控制器应该看起来像图 9-21 所示。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新按钮的效果！

在“生日”表视图控制器上点击 + 按钮，应该会将你带到“添加生日”视图控制器，在那里你可以输入人的名字和出生日期。点击取消和保存按钮目前还没有任何反应—我们将在第十章中实现它们！

### 你学到了什么

在本章中，你开始制作一个“BirthdayTracker”应用，通过创建“生日”和“添加生日”界面的基本用户界面。你还使用表视图控制器创建了“生日”屏幕，并让用户能够通过添加按钮和导航控制器在不同的屏幕之间进行切换。

现在你已经完成了应用的基本框架，在第十章中，你将编程实现取消和保存按钮，便于在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项是禁用的。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项以添加缺失的约束。

Birthdays 屏幕展示了你已经添加的生日列表，而添加生日屏幕是你可以在其中添加新生日条目的地方。

在 Xcode 中，一个屏幕包括一个*视图*和一个*视图控制器*。视图是你在屏幕上看到的内容，而视图控制器包含了所有用来控制视图的 Swift 代码。你可以在图 9-1 中看到，Birthdays 视图的右上角有一个看起来像加号 (+) 的添加按钮。

添加按钮将弹出添加生日视图，用户可以在此输入新朋友的生日详情。让我们从为 BirthdayTracker 创建一个新的 Xcode 项目开始。

### 创建一个新的 Xcode 项目

到目前为止，你大多数代码都在 playground 中编写。playground 是学习编程的好地方，但要编写一个可以在 iPad 或 iPhone 上运行的应用，你需要创建一个 Xcode 项目，就像在第一章中为 Hello World 应用创建的那样。

在 Xcode 菜单中，依次选择**文件** ▸ **新建** ▸ **项目**。在对话框的顶部选择**iOS**，选择**单一视图应用**作为项目模板，然后点击**下一步**。

在弹出的对话框中，Xcode 会要求你为新应用设置一些选项。由于这只是一个示例，你不需要过于*严肃*对待这部分内容。当你编写一个计划销售或在 App Store 发布的应用时，设置这些值就显得更加重要。将你的应用命名为**BirthdayTracker**，确保语言选择**Swift**，设备选择**iPhone**，并勾选**使用 Core Data**选项。你的组织名称和组织标识符应该已经预填为你在第一章中为 Hello World 应用所输入的值。

点击**下一步**。在打开的对话框中，选择你要保存项目的位置并点击**创建**。你的 Xcode 项目应该会自动打开。花一点时间确保在项目导航器中列出了一个名为*BirthdayTracker.xcdatamodeld*的文件（见图 9-2）。

![图片](img/Image00197.jpg)

*图 9-2：确保你的新项目中有一个* BirthdayTracker.xcdatamodeld *文件。*

你需要*BirthdayTracker.xcdatamodeld*文件来在 iPhone 上保存生日。如果这个文件丢失，说明你在创建 Xcode 项目时没有勾选“使用 Core Data”选项。别担心——这很容易修复。

如果你的*BirthdayTracker.xcdatamodeld*文件丢失，关闭项目（文件 ▸ 关闭项目），然后重新创建一个新 Xcode 项目，并确保勾选了“使用 Core Data”选项。当系统询问你是否要替换 BirthdayTracker 项目时，只需点击**替换**，然后你就可以继续了！

你的新 BirthdayTracker Xcode 项目将会打开。如果你还没有将 Apple 账户添加到 Xcode，你会在应用的常规设置的签名部分看到“未找到账户”的提示。除非你想在真实设备上运行应用，否则无需添加账户。（记住，你也可以在 Xcode 的模拟器上运行应用。）要将 Apple 账户添加到 Xcode，点击**添加账户**按钮。（有关添加 Apple 账户的更详细说明，请参见“你的第一个应用！” 在第 5 页 。）

这个通用设置屏幕也是你设置应用运行设备方向的地方。我们希望 BirthdayTracker 应用仅在*纵向*模式下运行。纵向模式是手机的常规方向，主屏幕按钮在底部。*横向*模式是当你将手机横过来时，屏幕会旋转，使得屏幕的宽度变成手机的高度，屏幕的高度变成手机的宽度。BirthdayTracker 应用在横向模式下看起来并不好，因此我们不希望在用户将手机横过来时屏幕发生变化。即便手机倒过来使用也没有问题，但如果用户将手机转过来时屏幕反转，可能会让用户感到困惑，因此我们不支持倒置模式。在部署信息部分，在设备方向旁边，取消选中**左横屏**和**右横屏**的复选框，确保只有**纵向**的复选框被选中。

让我们来看看 Xcode 的界面。选择左侧导航面板中的*ViewController.swift*，你应该会看到类似于图 9-3 的内容。

![图片](img/Image00198.jpg)![图片](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航面板 ➊ ，你可以通过选择**视图** ▸ **导航器** ▸ **隐藏/显示导航器**或按下⌘ -0 来隐藏或显示该面板。你将使用导航器来选择和查看项目中的文件。

编辑器面板位于窗口的中央 ➋ 。这里是你编写代码的地方！在这里，你还可以更改应用的设置，并使用故事板布局将显示在应用中的项目，正如你在第一章中看到的那样。我们稍后会进一步讨论故事板。

右侧是工具面板 ➌ ，你可以通过选择**视图** ▸ **工具** ▸ **隐藏/显示工具**或按下⌘ -OPTION -0 来隐藏或显示该面板。当故事板打开时，工具面板将帮助你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都有某种图标，会显示在用户设备的主屏幕上。我们将通过添加应用图标来启动我们的 BirthdayTracker 应用。你可以从*[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)*下载我们将用于图标的两张图片。下载 ZIP 文件后，你将在*下载*文件夹中看到一个名为*ch9-images*的文件夹，里面有你需要的图像文件。获取这些文件后，选择项目导航器中的*Assets.xcassets*。这将打开应用的*资产目录*，你可以在其中添加应用将使用的任何*资产*（图像、声音等），包括应用图标。事实上，资产目录已经有一个占位符，可以用来添加图标。从目录左侧的菜单中选择**AppIcon**，你应该能看到几个用于图像的占位符。

要添加一个在 iPhone 主屏幕上显示的应用图标，你需要提供标签为*iPhone App*的图标集的 2x 和 3x 图像。2x 大小适用于大多数 iPhone，例如 iPhone 5、6 和 7。更大的 iPhone，例如 iPhone 6s Plus 和 iPhone 7 Plus，使用 3x 大小的图像。你将在第十四章中了解更多关于为不同屏幕分辨率调整图像大小的知识。

将图标添加到资产目录非常简单！下载提供的图片后，在 Finder 中打开你的*下载*文件夹。然后，只需将图片*cake@2x.png*拖动到 iPhone App 2x 框中，将*cake@3x.png*拖动到 3x 框中。完成后，你的资产目录应该像图 9-4 一样。

![Image](img/Image00200.jpg)

*图 9-4：我们现在有了应用图标！*

除了应用图标，应用还需要一个显示名称，这个名称会显示在主屏幕的图标下方。默认情况下，这个名称就是应用的名字 BirthdayTracker。然而，这个名字有点太长，无法放置在应用图标下方，所以我们将它改成一个简短的名字：Birthdays。为此，返回设置页面，在项目导航器中选择 BirthdayTracker 项目。在顶部的身份部分，你可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这只会改变图标下方显示的名称，项目的名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，接下来让我们创建应用屏幕！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。这是我们设计应用程序*用户界面*的地方。用户界面只是用户用来与应用互动的元素的一个高级名称——例如图像、文本、按钮等。*故事板*让你可以直观地组织应用的各个屏幕。我们将使用故事板来查看所有使用的屏幕及它们之间的连接。

一旦选择了*Main.storyboard*，按下⌘ -0 隐藏导航窗格，以便腾出更多的屏幕空间。你的故事板应该已经包含一个视图控制器。

现在看看工具窗格的顶部，你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你仔细查看故事板元素并允许你更改这些元素设置的工具。当你选择一个检查器时，它会出现在工具窗格中。

**检查故事板项目**

图 9-5 显示了当故事板打开时，工具窗格中出现的检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：这是你在故事板的工具窗格中可以使用的六个检查器。*

让我们从左到右浏览这些检查器。页面图标打开文件检查器。你可以在这里更改故事板文件的设置。在本书中，以及在你大多数应用中，你不会使用这个检查器。

下一个检查器，标有问号图标，是快速帮助检查器。这个检查器将提供你当前在故事板中选定项的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里，你可以为故事板项设置自定义类。

接下来的两个检查器是你在故事板中工作时最常用的两个，我们将在文本中频繁提到它们。属性检查器的图标看起来像一个盾牌。这个检查器用于设置故事板中选定项的各种属性。例如，可以用它来设置标签的文本、按钮的颜色，或者文本输入框周围的框的类型。大小检查器，带有尺子图标，用于设置每个故事板项的大小和屏幕位置。

最后是连接检查器，它的图标看起来像一个圆圈中的箭头。你可以用它将故事板中的项连接到你在类中编写的代码片段中。我们将在第十章中展示如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是“生日”视图控制器。这将是一个特殊的视图控制器类，显示一个列表，在 Xcode 中被称为*表格视图控制器*。在我们的应用中，表格视图控制器将显示你朋友们的生日！现在它看起来只是一个空白屏幕，你将在“创建生日表格视图控制器”中学习如何在第 156 页上展示生日数据。

让我们将一个表格视图控制器添加到故事板中。如果你先从故事板上缩小视图，以便更好地看到视图控制器，这一步会更容易。双击视图控制器外的空白区域来进行缩放。现在你的屏幕应该已经缩小了。

在工具面板的底部，有一个包含四个按钮的部分。选择第三个按钮，它看起来像一个圆圈内的方形。这是对象库，你可以在其中找到要添加到故事板中的项目。滚动浏览对象库列表，直到找到表格视图控制器，或者使用面板底部的筛选条搜索“table view controller”。然后点击并将该对象拖放到你的故事板中。将其放在已存在的视图控制器旁边。你的故事板应该像图 9-6 中的那样。

注意，在你添加表格视图控制器后，左侧大纲视图中会出现一个“表格视图控制器场景”条目，并且其中包含一个表格视图控制器。在故事板中的场景表示应用屏幕上的一个区域。对于 iPhone 应用，通常一次屏幕上只会显示一个场景，且该场景会填满整个屏幕。iPad 应用则可以同时在屏幕上显示两个或更多场景。

![Image](img/Image00202.jpg)

*图 9-6：将一个表格视图控制器添加到生日屏幕的故事板中*

接下来的步骤是将这个新添加的视图控制器设为运行应用时首先出现的屏幕，因为我们希望在用户打开应用时能看到生日列表。执行此操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后在你的工具面板中打开属性检查器 ➋。在这里，勾选**是初始视图控制器** ➌。完成此操作后，你的表格视图控制器左侧应该会出现一个箭头。这个箭头表示当应用启动时，会显示此视图控制器。

#### 添加导航控制器

现在，我们将给视图控制器添加一个标题，写上“生日”，并添加一个“添加”按钮，点击后会打开“添加生日”视图控制器。为此，我们首先将表格视图控制器放入一个*导航控制器* 中。导航控制器管理一个或多个视图控制器。它自带一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧放置按钮，用于导航到应用中的其他屏幕。你可以在多个 iOS 应用中看到这个栏，比如设置应用和信息应用。

在大纲视图中选择**Table View Controller**。选择后，你需要使用 Xcode 菜单将表格视图控制器嵌入到导航控制器中。前往**Editor** ▸ **Embed In** ▸ **Navigation Controller**。

在将表格视图控制器嵌入到导航控制器之后，你的故事板应该看起来像图 9-8 中的那样。导航控制器将作为一个屏幕出现在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器表示用户将看到的一个屏幕，但导航控制器稍有不同。虽然它在故事板中看起来像一个独立的屏幕，导航控制器实际上只是一个容器，包含了用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以从一个视图切换到另一个视图，再返回。

你应该看到导航控制器和表格视图控制器顶部有灰色的导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，可能还包含用户可以用来跳转到其他屏幕的按钮和箭头。为了使用导航栏告诉用户他们所在的屏幕，我们需要为我们的屏幕添加标题。现在是重新聚焦到故事板的好时机。双击故事板的空白处进行放大，然后滚动视图，直到你能看到表格视图控制器。要为表格视图控制器添加标题，点击大纲视图中**Table View Controller Scene**下的**Navigation Item**。

![Image](img/Image00205.jpg)

当选择此项时，你可以在右侧的属性检查器中输入屏幕的标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。完成此步骤并按下 RETURN 键后，你应该看到大纲视图中的表格视图控制器场景条目自动更新为 Birthdays Scene。

接下来，我们将制作一个添加按钮，让你能够添加生日！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将一个生日添加到这个列表中。让我们做一个按钮，让他们能做到这一点！

我们需要在导航栏中添加一个按钮，通向添加生日场景，这样用户就可以输入生日了。找到对象库中的“Bar Button Item”，然后将其拖放到表格视图控制器导航栏的右侧，如图 9-9 所示。

现在，我们希望将此按钮变为添加按钮。幸运的是，Xcode 有一个内置的添加按钮可以使用。在属性检查器中，将工具栏按钮项的系统项更改为**Add**。你应该看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮在点击时执行什么操作。我们希望它能打开“添加生日”视图控制器，因此需要将“添加”按钮连接到该视图控制器。首先，双击故事板进行缩小，以确保你能看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键并从+按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标。这将弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar Button Item 拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态呈现”。*

连接对话框为你提供了几种不同的*segue*（从一个屏幕到另一个屏幕的过渡）选项。点击连接对话框中的**模态呈现（Present Modally）**选项。这将使视图控制器作为*模态*视图控制器呈现到屏幕上。在 iPhone 上，模态视图控制器从屏幕底部滑入，且默认没有返回按钮让你回到上一个屏幕。相反，模态视图控制器可以有其他按钮，例如取消或保存。还有其他类型的 segue，比如显示（Show）segue，在这种过渡方式下，视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，应该将该屏幕作为模态视图显示，并带有取消按钮。否则，如果你使用像显示（Show）segue 这样的方式，带有返回按钮的情况下，用户可能会输入所有信息后，点击返回按钮而没有保存任何内容！有了取消按钮，用户必须有意点击以取消该屏幕。

要查看模态输入视图控制器的一个好例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个+按钮，你可以点击它来添加一个日历事件。点击+按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，可以在关闭模态视图之前创建新事件。你会看到，新事件模态视图从屏幕底部滑入，关闭时又滑回到底部。我们希望用户能够保存生日，所以我们也会使用模态视图。

现在，让我们试着运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先选择一个设备模拟器，方法是点击 Xcode 左上角显示的 “BirthdayTracker” 旁边的设备（参见 图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器将运行的设备，设备设置为 iPhone 7。*

这将弹出一个设备选项列表供你运行应用。我们选择的是 iPhone 7。在选择了模拟器后，点击左上角的播放按钮，或者使用快捷键⌘ -**R**。

当模拟器打开并运行你的应用时，如果模拟器的大小太大以至于无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器以选择它，然后转到 **Window** ▸ **Scale**，在模拟器菜单中选择一个较小的比例。

到目前为止，当你运行应用时，并不会发生太多事情。你应该会看到你第一个“生日”屏幕，并且有一个 + 按钮，如 图 9-1 中所示。显然，此时你的“生日”屏幕是空的。点击 + 按钮会弹出第二个空白屏幕。看完应用后，通过点击 Xcode 中的停止按钮来关闭它，停止按钮位于你之前点击的播放按钮旁边。当你停止应用后，你应该会看到应用图标出现在模拟器的主屏幕上！（参见 图 9-12）。

就这样！现在我们需要配置第二个屏幕，使其可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控件输入和标签

让我们开始设计“添加生日”视图控制器，首先添加其标题。为此，你需要将它嵌入到自己的导航控制器中。当视图控制器是模态视图时，它不会继承我们故事板上已经存在的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过在故事板中点击视图控制器来选择它。然后，转到 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在你应该可以看到，在视图控制器场景下的大纲视图中添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题 **添加生日**。这些步骤与添加“生日”标题到你的表视图控制器时的步骤相同。

现在，当“添加生日”视图控制器出现在应用中时，它将在顶部显示其标题。

#### 添加你的朋友名字和生日

当你在第十章中输入朋友的生日时，你的应用中的每一项将包括一个名字、一个姓氏和一个出生日期。让我们在“添加生日”视图控制器中添加一些*输入控件*，以便用户为每个人输入这些信息。输入控件是像文本框或下拉菜单这样的组件，允许用户在应用中输入数据。我们将首先添加所有用户可以输入信息的控件标签。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器创建一个显示“First Name”（名字）的标签。这个标签将放在一个文本框旁边，你可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器中添加标签。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框，输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们想要使用大小检查器来设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点（points）*为单位来测量的。请注意，1 个点不等于 1 个像素。根据你的应用运行的设备类型，1 个点可能对应 1 个像素、一个 2×2 像素的方块，或者一个 3×3 像素的方块。这三种缩放因子分别被称为@1x、@2x 和@3x（这些就是我们在设置应用图标时讨论过的大小）。设备的点分辨率也不是全部相同，屏幕宽度可能在 320 到 1,024 点之间，屏幕高度则可能在 568 到 1,366 点之间。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示“First Name”*

只有最旧的 iPhone 和 iPod 型号使用@1x 缩放因子，并且你将无法在这些型号上运行你的应用（BirthdayTracker 只支持 iOS 10 及以上版本）。除非你的设备是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它很可能使用@2x 缩放因子，而这三款设备则使用@3x 缩放因子。

对象在屏幕上的位置也是基于点来计算的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（参见图 9-15）。我们将设置每个添加到视图控制器中的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕的边缘之外，同时仍然为其文本输入框和其他标签以及输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成此操作后，重复这些步骤，向“添加生日”视图控制器添加两个标签：姓氏标签和出生日期标签。我们需要定位其他标签和输入控件，以确保它们不会重叠。在某些情况下，这可能会变得有些棘手，可能需要一些时间。对于这个应用程序，我们已经为你计算出了可以放置对象的位置，基于 iPhone 7 的屏幕。稍后我们将解释如何使你的应用适应其他设备。表格 9-1 列出了你应该为每个标签设置的大小和位置。

表格 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们在垂直方向上对齐，但每个标签的 y 位置不同。每个标签的高度为 21，所以 y 位置需要至少比下一个标签的 y 位置大 21 个点。由于我们将在每个标签下方添加输入控件，因此我们将 y 位置设置得更大，以便容纳标签的高度和输入控件的高度。

太好了！现在你的故事板应该看起来像图 9-16 中的那样。

![图片](img/Image00214.jpg)

*图 9-16：输入的标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们将允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中将两个文本字段对象拖动到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段设置为表格 9-2 中所示的大小和位置。你可以使用大小检查器来设置，就像之前为标签设置位置一样。

表格 9-2：视图控制器中的文本字段用于输入

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个称为*日期选择器*的控件。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的标准工具，允许用户选择日期或时间。它可以包含日期和时间，就像在日历应用中使用的日期选择器（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，使用日期选择器来选择日期。*

日期选择器还可以仅显示时间，比如在时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这就是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动直到找到日期选择器，然后点击并将其拖到 Birthdate 标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击选择日期选择器。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器设置为显示当前日期。让我们改成显示你的出生日期！将日期字段从当前日期更改为**自定义**。这样做后，会出现一个新框。将这个日期更改为你的出生日期。

让我们通过运行应用程序来测试目前为止的效果！我们为输入控件使用的大小在 iPhone 7 屏幕上很合适。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击 Birthdays 视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器运行应用，比如 iPhone 5s，并再次运行应用。你会发现一些地方显示得不太对。

你添加到故事板中的所有元素都已经显示出来，但文本字段超出了屏幕边缘。现在你已经把所有元素放到屏幕上，下一步是让它们在任何屏幕尺寸下都能正确适配。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上都完美显示，使用自动布局

iPhone 本身有三种不同的屏幕尺寸，并且未来可能会推出更多尺寸。你需要设计你的应用，使其在任何设备上看起来都很合适。这意味着你需要让你的应用调整界面中所有元素的位置和大小，以适应应用运行的设备。自动布局使用一种叫做*布局约束*的方式来安排屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕故事板窗格的底部有一个带有图标的带状工具栏，工具栏中紧挨着工具窗格的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，标明“解决自动布局问题”。点击该图标弹出一份建议菜单。点击**添加缺失的约束**。^(*) 完成此操作后，你会看到一大堆布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕，并且不会超出边缘。自动布局还确保每个文本字段前后各有 20 个点的间距，使它们在屏幕上居中对齐。

现在在 iPhone 5s 模拟器上再次运行应用程序。这次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。这些按钮目前不会做任何事情。我们只是先进行设置。在第十章中，我们将添加一些代码，使它们可以退出“添加生日”屏幕并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个条形按钮项并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们之前做的“添加”按钮一样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将它放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新按钮的效果！

点击生日表视图控制器上的+按钮应该会带你进入“添加生日”视图控制器，在那里你可以输入某个人的姓名和出生日期。点击取消和保存按钮目前不会有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在这一章中，你开始制作一个 BirthdayTracker 应用，通过创建生日和添加生日屏幕的基本用户界面。你还使用表视图控制器创建了生日屏幕，并使用户能够通过“添加”按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用程序的基本框架，接下来你将在第十章中编写代码，实现取消和保存按钮，这样你就可以在应用程序中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

在 Xcode 中，一个屏幕包含一个*视图*和一个*视图控制器*。视图是你在屏幕上看到的内容，视图控制器包含所有用于控制视图的 Swift 代码。你可以在图 9-1 中看到，Birthdays 视图的右上角有一个加号按钮（+）。

点击加号按钮将弹出“添加生日”视图，用户可以在此输入新朋友的生日详情。让我们通过创建一个新的 Xcode 项目来开始我们的 BirthdayTracker。

### 创建一个新的 Xcode 项目

到目前为止，你一直在 playground 中编写大部分代码。Playground 是一个很好的学习编程的地方，但要编写一个能够在 iPad 或 iPhone 上运行的应用，你需要创建一个 Xcode 项目，就像你在第一章中为 Hello World 应用做的那样。

在 Xcode 菜单中，依次选择**文件** ▸ **新建** ▸ **项目**。在对话框顶部选择**iOS**，然后选择**单视图应用**作为你的项目模板，接着点击**下一步**。

在弹出的对话框中，Xcode 会要求你为新应用设置一些选项。由于这只是一个示例，你不需要太过于认真对待这部分内容。设置这些值在你编写一个计划出售或分发到 App Store 的应用时更为重要。为你的应用命名为**BirthdayTracker**，确保语言选择为**Swift**，设备选择为**iPhone**，并勾选**使用 Core Data**框。你的组织名称和组织标识符应该已经预填充了你在第一章创建 Hello World 应用时输入的值。

点击**下一步**。在弹出的对话框中，选择你想保存项目的位置并点击**创建**。你的 Xcode 项目应该会自动打开。花点时间确认你在项目导航器中是否有名为*BirthdayTracker.xcdatamodeld*的文件（见图 9-2）。

![Image](img/Image00197.jpg)

*图 9-2：确保你在新项目中有一个*BirthdayTracker.xcdatamodeld*文件。*

你需要*BirthdayTracker.xcdatamodeld*文件来在 iPhone 上保存生日。如果这个文件丢失，说明你在创建 Xcode 项目时没有勾选“使用 Core Data”框。别担心——这很容易修复。

如果你的*BirthdayTracker.xcdatamodeld*文件丢失，关闭你的项目（文件 ▸ 关闭项目），然后重新创建一个新的 Xcode 项目，并勾选“使用 Core Data”框。当系统询问你是否要替换 BirthdayTracker 项目时，只需点击**替换**，你就完成了所有设置！

你的新 BirthdayTracker Xcode 项目将会打开。如果你没有将 Apple 账户添加到 Xcode，你会在常规应用程序设置的“签名”部分看到一条消息，显示“未找到账户”。除非你想在真实设备上运行应用程序，否则不需要添加账户。（记住，你也可以在 Xcode 的模拟器上运行应用程序。）要将 Apple 账户添加到 Xcode，点击**添加账户**按钮。（有关如何添加 Apple 账户的详细说明，请参见“你的第一个应用！”在第 5 页的内容。）

这个“常规设置”屏幕也是你设置应用程序运行时设备方向的地方。我们希望 BirthdayTracker 应用程序仅在*竖屏*模式下运行。竖屏模式是手机的常规方向，底部有主页按钮。*横屏*模式是当你将手机横过来，屏幕也随之旋转，这样屏幕的宽度变成手机的高度，屏幕的高度变成手机的宽度。BirthdayTracker 应用程序在横屏模式下显示效果不佳，因此我们不希望当用户将手机横过来时，屏幕发生变化。应用程序倒过来看也没问题，但如果用户将手机翻转，主页按钮在顶部时屏幕翻转可能会让用户感到困惑，因此我们也不支持倒立模式。在“部署信息”部分，在“设备方向”旁边，取消选中**左横屏**和**右横屏**旁的复选框，确保**竖屏**是唯一被选中的选项。

让我们环顾一下 Xcode。在左侧的导航器窗格中选择*ViewController.swift*，你应该会看到类似于图 9-3 的内容。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口结构*

左侧是导航窗格 ➊，你可以通过选择**视图** ▸ **导航器** ▸ **隐藏/显示导航器**或按下⌘ -0 来隐藏或显示导航器。你将使用导航器来选择和查看项目中的文件。

编辑器窗格位于窗口的中央 ➋。在这里你将编写代码！这里也是你可以更改应用程序设置并使用故事板布局应用程序中将显示的项目的地方，你在第一章中看到过故事板。我们很快会详细讲解故事板。

右侧是实用工具窗格 ➌，你可以通过选择**视图** ▸ **实用工具** ▸ **隐藏/显示实用工具**或按下⌘ -OPTION -0 来隐藏或显示实用工具。当故事板打开时，实用工具窗格将允许你配置应用程序中对象的大小和位置。

### 添加应用图标

大多数应用程序都会带有某种图标，该图标会显示在用户设备的主屏幕上。我们将通过添加一个应用图标来开始我们的 BirthdayTracker 应用。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用作图标的两张图片。下载 ZIP 文件后，你将在 *Downloads* 文件夹内找到一个名为 *ch9-images* 的文件夹，里面有你需要的图片文件。获取这些文件后，从项目导航器中选择 *Assets.xcassets*。这将打开应用的 *资源目录*，这是你放置应用将使用的任何 *资源*（图片、声音等）的地方，包括应用图标。事实上，资源目录已经包含了一个占位符，你可以在其中添加图标。从目录左侧菜单中选择 **AppIcon**，你应该能看到几个图片占位符。

要添加一个将在 iPhone 主屏幕上显示的应用图标，你需要提供标记为 *iPhone App* 的图标集的 2x 和 3x 图像。2x 尺寸适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸的图像。你将在 第十四章 中了解更多关于不同屏幕分辨率的图片大小调整。

将图标添加到资源目录很简单！下载提供的图片后，打开 Finder 中的 *Downloads* 文件夹。然后，只需将图片 *cake@2x.png* 拖到 iPhone App 2x 框中，将 *cake@3x.png* 拖到 3x 框中。完成后，你的资源目录应该像 图 9-4 一样。

![Image](img/Image00200.jpg)

*图 9-4：我们现在有了一个应用图标！*

除了应用图标，应用程序还有一个显示名称，显示在主屏幕图标下方。默认情况下，这个名称就是应用名称 BirthdayTracker。然而，这个名称有点长，无法完全显示在图标下方，所以让我们将它改为一个更简短的名称：Birthdays。为此，请通过在项目导航器中选择 BirthdayTracker 项目返回设置页面。在顶部的身份部分，你可以更改应用的显示名称。只需在显示名称文本框中输入 **Birthdays**。这将只更改显示在应用图标下方的名称。你的项目名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，让我们来创建应用屏幕吧！

### 显示你朋友的生日

从项目导航器中选择 *Main.storyboard* 以打开故事板。这是我们设计应用 *用户界面* 的地方。用户界面是用户将看到并用来与应用交互的东西——图像、文本、按钮等等。*故事板* 让你可以直观地组织应用的各个屏幕。我们将使用故事板来查看所有已使用的屏幕以及它们之间的连接。

一旦你选择了*Main.storyboard*，通过按 ⌘ -0 隐藏导航面板，以便为屏幕腾出更多空间。你的故事板应该已经包含一个视图控制器。

现在看看工具面板的顶部。你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更详细地查看故事板元素并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它将出现在工具面板中。

**检查故事板项**

图 9-5 显示了在打开故事板时，工具面板中出现的检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：你可以在故事板的工具面板中使用六个检查器。*

我们从左到右依次浏览这些检查器。页面图标打开文件检查器。这里是你可以更改故事板文件设置的地方。在本书中以及大多数应用程序中，你不会使用这个检查器。

下一个检查器，由一个问号图标表示，是快速帮助检查器。此检查器将提供关于你当前在故事板中选择的项的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。这里是你可以为故事板项设置自定义类的地方。

接下来的两个检查器是你在故事板中最常用的两个，我们会在文本中频繁提到它们。属性检查器的图标看起来像一个盾牌。这个检查器用于设置选定项的各种属性。它可以用来设置标签的文本、按钮的颜色，或者文本输入框周围显示的框的类型，例如。尺寸检查器，带有尺子图标，用于设置每个故事板项的大小和屏幕位置。

最后是连接检查器，它的图标看起来像一个圆圈中的箭头。这个检查器可以用来将你的故事板项与在类中编写的代码片段连接起来。我们将在第十章中展示如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是“生日”视图控制器。这将是一个特殊类型的视图控制器，用于显示一个列表，在 Xcode 中称为*表格视图控制器*。在我们的应用中，表格视图控制器将显示你朋友们的生日列表！目前它看起来只是一个空白屏幕，你将在“创建生日表格视图控制器”中学习如何显示生日数据，第 156 页。

让我们向故事板中添加一个表视图控制器。如果你首先将故事板缩小，这一步会更容易，因为你可以更清楚地看到视图控制器。你可以通过双击视图控制器外部的空白区域来实现缩小。现在你的屏幕应该已经缩小了。

在工具面板的底部，有一个包含四个按钮的区域。选择第三个按钮，它看起来像一个圆圈里的方框。这个是对象库，你可以在这里找到可以添加到故事板中的项目。滚动浏览对象库列表，直到你找到表视图控制器，或者使用面板底部的筛选栏搜索“table view controller”。然后将该对象点击并拖动到故事板上，放到已经存在的视图控制器旁边。你的故事板应该像图 9-6 所示。

请注意，添加表视图控制器后，左侧大纲视图中会出现一个“表视图控制器场景”条目，其中包含一个表视图控制器。故事板中的场景代表应用屏幕上的一个区域。对于 iPhone 应用，通常一次只会有一个场景显示在屏幕上，并且该场景会填满整个屏幕。而 iPad 应用则可以同时在屏幕上显示两个或多个场景。

![图片](img/Image00202.jpg)

*图 9-6：将表视图控制器添加到生日屏幕的故事板中*

下一步是使这个新视图控制器成为运行应用时首先出现的屏幕，因为我们希望用户打开应用时首先看到生日列表。完成这一操作的步骤请参考图 9-7。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表视图控制器，并将其设为初始视图控制器。*

首先，在大纲视图 ➊ 中选择**表视图控制器**。然后，在工具面板中打开属性检查器 ➋ 。在那里，勾选**是初始视图控制器** ➌ 选项。完成后，在故事板中的表视图控制器左侧应该会出现一个箭头。这个箭头表示应用启动时将首先显示这个视图控制器。

#### 添加导航控制器

现在，我们将向视图控制器添加一个标题，显示“生日”，并添加一个“添加”按钮，点击后将打开添加生日的视图控制器。为此，我们首先将表视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它自带一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且可以在左右两侧显示按钮，帮助导航到应用中的其他屏幕。在多个 iOS 应用中，比如设置应用和信息应用，你会看到这个导航栏出现在屏幕顶部。

在大纲视图中选择 **Table View Controller**。选中后，你需要使用 Xcode 菜单将表格视图控制器嵌入到导航控制器中。请前往 **Editor** ▸ **Embed In** ▸ **Navigation Controller**。

在将表格视图控制器嵌入到导航控制器后，你的故事板应该像 图 9-8 中的那样。导航控制器将会在故事板中显示为一个屏幕。

![图片](img/Image00204.jpg)

*图 9-8: 导航控制器*

故事板中的每个视图控制器代表应用程序中的一个屏幕，用户将看到它，但导航控制器有些不同。虽然它在故事板中看起来像是一个独立的屏幕，但导航控制器实际上只是一个容器，它包含了用户在应用程序中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在一个视图和另一个视图之间进行导航并返回。

你应该会看到在导航控制器和表格视图控制器的顶部有灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们当前所在屏幕的标题，并且可能还包含用户可以用来跳转到其他屏幕的按钮和箭头。为了利用导航栏来告诉用户他们所处的屏幕，我们需要为屏幕添加标题。现在是时候重新聚焦到故事板了。双击故事板的空白处以放大视图，然后滚动视图以便可以看到表格视图控制器。要为表格视图控制器添加标题，请点击大纲视图中 **Table View Controller Scene** 下的 **Navigation Item**。

![图片](img/Image00205.jpg)

选中该项后，你可以在右侧的属性检查器中输入屏幕的标题。我们希望导航栏显示“生日”作为标题，所以在右侧的 Title 字段中输入 **Birthdays**。你应该会看到，在完成此步骤并按下 RETURN 后，表格视图控制器场景条目在大纲视图中自动更新为“Birthday Scene”。

接下来，我们将创建一个“添加”按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并向列表中添加生日。让我们创建一个按钮，让他们可以做到这一点！

我们需要在导航栏上添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。在对象库中找到“Bar Button Item”，然后将其拖放到表格视图控制器导航栏的右侧，如 图 9-9 所示。

现在，我们想将这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮可以使用。在属性检查器中，将 bar button item 的 System Item 改为 **Add**。你应该会看到按钮变成一个加号 (+)。

接下来，我们需要告诉按钮点击时该做什么。我们希望它打开“添加生日”视图控制器，因此我们需要将“添加”按钮与该视图控制器连接。首先，双击 storyboard 以缩小视图，确保你可以看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键并从 + 按钮拖动到 storyboard 右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标。这样会弹出一个连接对话框，如图 9-10 所示。

![图片](img/Image00206.jpg)

*图 9-9：将一个 Bar Button Item 拖到“生日”视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖到相邻的视图控制器，并在弹出的对话框中选择“模态展示”。*

连接对话框为你提供了几种选项，用于选择两个视图控制器之间的*segue*（屏幕之间的过渡方式）。在连接对话框中点击**模态展示**选项。这将使视图控制器以*模态*的方式呈现在屏幕上。在 iPhone 上，模态视图控制器是从屏幕底部滑入的，并且通常不带有自动的返回按钮来返回上一个屏幕。相反，模态视图可以有其他按钮，如取消或保存。还有其他类型的 segue，比如“展示”segue，其中视图控制器从右侧推入屏幕，并且在导航栏左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用来获取和保存用户输入的屏幕时，应该将该屏幕呈现为模态视图，并带有一个“取消”按钮。否则，如果使用类似“展示”segue 并带有返回按钮，用户可能会输入所有信息后点击返回按钮，但没有保存任何内容！有了“取消”按钮，用户必须故意点击才能退出该屏幕。

要查看一个良好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的“新建事件”视图控制器。这个视图控制器左侧有一个“取消”按钮，可以退出该屏幕而不保存，右侧有一个“添加”按钮，可以在关闭模态窗口之前创建新事件。你应该能看到“新建事件”模态窗口是从屏幕底部滑入的，关闭时则向下滑动消失。我们希望用户能够保存生日，因此我们也会使用模态窗口。

现在让我们尝试运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先选择一个设备模拟器，通过点击 Xcode 左上角列出的设备（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器将运行的设备，位置就在你应用名称旁边。在这里，设备被设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。在你选择了模拟器后，点击左上角的播放按钮，或使用键盘快捷键⌘ -**R**。

当模拟器打开并运行你的应用时，如果模拟器的大小太大，无法适应你的计算机屏幕，你可以调整它的大小。点击模拟器以选中它，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时，并不会发生太多事情。你应该能看到你的第一个“生日”屏幕，并且有一个+按钮，正如之前在图 9-1 中所示。显然，到这个时候，你的“生日”屏幕将是空的。点击+按钮将弹出第二个空白屏幕。当你看完应用后，点击 Xcode 中的停止按钮关闭它，停止按钮位于你之前点击的播放按钮旁边。停止应用后，你应该会看到你的应用图标出现在模拟器的主屏幕上！（参见图 9-12。）

就这样！接下来，我们需要配置第二个屏幕，以便能够用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已被添加到主屏幕上。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，你需要将其嵌入一个自己的导航控制器中。当一个视图控制器是模态时，它不会继承我们故事板中已有的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器来选择它。然后进入**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该会看到一个导航项被添加到视图控制器场景下的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与你在给表视图控制器添加“生日”标题时是一样的。

现在，当“添加生日”视图控制器在应用中出现时，它将显示在顶部的标题。

#### 添加你朋友的姓名和生日

当您在第十章中输入朋友的生日时，您的应用中的每个条目都会有名字、姓氏和出生日期。让我们向“添加生日”视图控制器中添加一些 *输入控件*，以便用户可以为每个人输入所有这些信息。输入控件是允许用户在应用中输入数据的组件，例如文本框或下拉菜单。我们将从添加所有用户可以输入的标签开始。

##### 添加与定位标签

让我们为“添加生日”视图控制器创建一个标签，显示“First Name”（名字）。这个标签将放在一个文本框旁边，您可以在其中输入朋友的名字。找到并将一个标签对象从对象库拖动到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13: 向“添加生日”视图控制器添加标签。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name** 作为显示文本，如图 9-14 所示。

现在，我们想使用尺寸检查器来设置标签的大小和位置。在 Xcode 故事板中，宽度和高度是用 *点* 来衡量的。请注意，1 点并不是 1 像素。根据您的应用运行的设备类型，1 点可能对应 1 像素、一个 2×2 像素的方块，或者一个 3×3 像素的方块。这三个比例因子分别称为 @1x、@2x 和 @3x（我们在设置应用图标时也提到了这些大小）。设备的点分辨率也不相同，宽度从 320 到 1,024 点不等，高度从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14: 使标签显示* First Name

只有最旧款的 iPhone 和 iPod 使用 @1x 比例因子，您将无法在这些型号上运行您的应用（BirthdayTracker 将只支持 iOS 10+）。除非您的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus（它们使用 @3x 比例因子），否则很可能您的设备使用的是 @2x 比例因子。

对象在屏幕上的位置也是基于点来计算的。对象的 x 位置是从屏幕左侧到对象左侧的点数。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15）。我们将设置我们添加到视图控制器中的每个库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15: 显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们想要将第一个标签的位置设置在屏幕边缘之外，但仍然留有足够的空间给其文本输入框以及其他标签和输入框。在尺寸检查器的视图部分，设置 x 位置为 20，y 位置为 100，宽度为 100。高度保持为 21。

完成这个操作后，重复这些步骤，将两个标签添加到“添加生日”视图控制器中：一个是“姓氏”标签，一个是“出生日期”标签。我们需要调整其他标签和输入框的位置，以避免它们重叠。在某些情况下，这可能会变得有些复杂，并且可能需要一些时间。对于这个应用程序，我们已经为你计算好了可以放置对象的位置，适用于 iPhone 7 屏幕。稍后我们会解释如何使你的应用程序适配其他设备。表 9-1 列出了每个标签应设置的大小和位置。

表 9-1：视图控制器中的输入标签设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度是 21，因此 y 位置需要比下一个最近的标签高出至少 21 个点。由于我们也将在每个标签下方添加输入控件，因此我们已将 y 位置设置得更大，以便同时容纳标签的高度和输入控件的高度。

很棒！现在你的故事板应该像图 9-16 中一样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个 *文本框*，它们允许你输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以在文本框中输入一行文字。

##### 添加文本框

从对象库中拖动两个文本框对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中的尺寸和位置设置这两个文本框。你可以使用尺寸检查器，就像你为标签所做的那样。

表 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个称为 *日期选择器* 的控件。它可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，允许用户选择日期或时间。它可以同时包含日期和时间，类似于日历应用中的日期选择器（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器来选择日期。*

日期选择器还可以只显示时间，就像钟表应用中用于设置闹钟的日期选择器，或者仅显示日期，这也是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到一个日期选择器，然后点击并拖动它到“出生日期”标签下的视图控制器。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将这个日期改成你的生日！将日期字段从“当前日期”改为**自定义**。这样一个新框将会出现。将这个日期更改为你的生日。

让我们通过运行应用来测试到目前为止的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你在“生日”视图控制器上点击+按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来不错，但其他设备呢？选择一个更小的模拟器来运行应用，比如 iPhone 5s，并再次运行应用。你会看到，某些地方看起来不太对。

你添加到故事板中的所有元素都出现了，但是文本字段超出了屏幕边缘。现在你已经将所有元素放到屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确显示。我们将通过一个叫做*自动布局*的工具来完成这个任务。

#### 使你的应用在每个设备上看起来完美，使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会有更多尺寸的设备。你需要设计你的应用，使它在任何设备上都能看起来不错。这意味着，你需要让你的应用调整屏幕上所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的东西来定位屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来打开自动布局菜单。*

在屏幕故事板面板的底部，有一个带图标的带状工具栏，紧接在实用工具面板之前的最右边是一个位于两条垂直线之间的三角形图标。将鼠标光标悬停在该图标上，它会显示一个标签，写着“解决自动布局问题”。点击此图标会弹出一个建议菜单。点击**添加缺失的约束**。^(*)当你这样做时，你会看到一大堆布局约束被添加到了添加生日场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适应屏幕的宽度，不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点的间距，从而使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。此次，添加生日屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这些工作，我们将展示如何为添加生日视图控制器的导航栏创建取消和保存按钮。按钮目前不会执行任何操作，我们只是设置它们。到第十章时，我们将添加一些代码，使得这些按钮能够取消添加生日屏幕并将生日信息保存到应用中。

为了添加保存按钮，从对象库中拖动一个“条形按钮项”，并将其放置在导航栏的*右侧*。我们将把这个按钮转化为保存按钮，就像我们为添加按钮所做的那样。选择按钮项，然后使用属性检查器将其转化为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“条形按钮项”，这次将其放置在导航栏的*左侧*。使用属性检查器将其转化为取消按钮，和之前为保存按钮所做的一样。你的视图控制器应该与图 9-21 中显示的一致。

![图片](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行应用，看看新按钮的效果！

点击生日表视图控制器上的“+”按钮应将你带到添加生日视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前不会有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在这一章中，你通过创建生日和添加生日屏幕的基本用户界面，开始制作一个 BirthdayTracker 应用。你还使用表视图控制器创建了生日屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用程序的基本框架，第十章将指导你编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日信息了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项是禁用的。这是 Apple 的一个 bug。在这种情况下，选择 **重置为缺失约束** 选项来添加缺失的约束。

添加按钮会打开一个“添加生日”视图，用户可以在这里输入新朋友的生日信息。让我们通过创建一个新的 Xcode 项目来开始开发我们的 BirthdayTracker 应用。

### 创建一个新的 Xcode 项目

到目前为止，你的大部分代码都是写在 playground 中的。playground 是一个学习编程的好地方，但要写一个可以在 iPad 或 iPhone 上运行的应用程序，你需要像在 第一章 中做的那样，创建一个 Xcode 项目。

在 Xcode 菜单中，依次选择 **文件** ▸ **新建** ▸ **项目**。在对话框顶部选择 **iOS**，并选择 **单视图应用程序** 作为项目模板，然后点击 **下一步**。

在弹出的对话框中，Xcode 会要求你为新应用设置一些选项。由于这只是一个示例，你不需要 *太* 认真对待这个部分。当你编写计划在 App Store 销售或分发的应用程序时，这些设置会变得更为重要。将你的应用命名为 **BirthdayTracker**，确保语言设置为 **Swift**，设备选择为 **iPhone**，并勾选 **使用 Core Data** 选项。你的组织名称和组织标识符应该会自动填充，填入的是你在 第一章 创建 Hello World 应用时输入的值。

点击 **下一步**。在弹出的对话框中，选择你希望保存项目的位置，然后点击 **创建**。你的 Xcode 项目应该会自动打开。花点时间确认在项目导航器中有一个名为 *BirthdayTracker.xcdatamodeld* 的文件（见 图 9-2）。

![Image](img/Image00197.jpg)

*图 9-2：确保你的新项目中有一个* BirthdayTracker.xcdatamodeld *文件。*

你需要 *BirthdayTracker.xcdatamodeld* 来在 iPhone 上保存生日。如果缺少该文件，意味着你在创建 Xcode 项目时没有勾选使用 Core Data 选项。别担心，这个问题很容易解决。

如果你的 *BirthdayTracker.xcdatamodeld* 文件丢失，关闭你的项目（文件 ▸ 关闭项目），然后通过勾选使用 Core Data 选项重新创建一个新的 Xcode 项目。当系统询问是否替换 BirthdayTracker 项目时，点击 **替换**，这样你就准备好了！

你的新 BirthdayTracker Xcode 项目将会打开。如果你还没有将 Apple 账户添加到 Xcode，你会看到“未找到账户”的信息，出现在常规应用设置的签名部分。除非你想在真实设备上运行应用，否则无需添加账户。（记住，你也可以在 Xcode 的模拟器上运行你的应用。）要将 Apple 账户添加到 Xcode，点击**添加账户**按钮。（有关如何添加 Apple 账户的详细说明，请参见《你的第一个应用！》，在第 5 页有详细介绍。）

这个常规设置界面也是设置应用运行的设备方向的地方。我们希望 BirthdayTracker 应用仅在*竖屏*模式下运行。竖屏模式是手机的常规方向，主页按钮在底部。*横屏*模式是当你将手机转侧时，屏幕也会旋转，使得屏幕的宽度变成手机的高度，屏幕的高度变成手机的宽度。由于 BirthdayTracker 应用在横屏模式下效果不好，因此我们不希望在用户将手机转为横屏时屏幕发生变化。即使应用在倒立时也能正常显示，但如果用户将手机转过来，主页按钮位于顶部时屏幕翻转，可能会让用户感到迷惑，因此我们也不支持倒立模式。在部署信息部分，在设备方向旁边，取消选中**横屏左**和**横屏右**，确保**竖屏**是唯一选中的选项。

让我们来看一下 Xcode。在左侧的导航面板中选择*ViewController.swift*，你应该能看到类似于图 9-3 的内容。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航面板 ➊，你可以通过点击**视图** ▸ **导航器** ▸ **隐藏/显示导航器**，或者按 ⌘ -0\ 来隐藏或显示它。你将使用导航器来选择并查看项目中的文件。

编辑器面板位于窗口的中央 ➋。在这里你将编写代码！这也是你可以更改应用设置并使用故事板布置应用中将显示的项目的地方，你在第一章中已经看过故事板。稍后我们将深入讨论故事板。

右侧是实用工具面板 ➌，你可以通过点击**视图** ▸ **实用工具** ▸ **隐藏/显示实用工具**，或者按 ⌘ -OPTION -0\ 来隐藏或显示它。当故事板打开时，实用工具面板将允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都有某种图标，会显示在用户设备的主屏幕上。我们将从添加一个应用图标开始我们的 BirthdayTracker 应用。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图片。下载 ZIP 文件后，你会在 *Downloads* 文件夹中看到一个名为 *ch9-images* 的文件夹，其中包含你需要的图像文件。获取这些文件后，从项目导航器中选择 *Assets.xcassets*。这将打开应用的 *资源目录*，在这里你可以放置应用将使用的任何 *资源*（图像、声音等），包括应用图标。事实上，资源目录已经有一个占位符，你可以在这里添加图标。选择目录左侧菜单中的 **AppIcon**，你应该会看到多个图像占位符。

要添加一个在 iPhone 主屏幕上显示的应用图标，你需要为标记为 *iPhone 应用* 的图标集提供 2x 和 3x 大小的图片。2x 大小适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，例如 iPhone 6s Plus 和 iPhone 7 Plus，使用 3x 大小的图片。你将在第十四章中了解更多关于不同屏幕分辨率下图片大小的内容。

将图标添加到资源目录非常简单！下载提供的图像后，打开 Finder 中的 *Downloads* 文件夹。然后，简单地将图像 *cake@2x.png* 拖动到 iPhone 应用 2x 框中，将 *cake@3x.png* 拖动到 3x 框中。完成后，你的资源目录应该像图 9-4 一样。

![Image](img/Image00200.jpg)

*图 9-4：我们现在有了应用图标！*

除了应用图标，应用还具有一个显示名称，显示在主屏幕上图标下方。默认情况下，这个名称就是应用名称，BirthdayTracker。然而，这个名称有点长，无法完全显示在图标下方，所以我们将其更改为更短的名称：Birthdays。为此，请通过在项目导航器中选择 BirthdayTracker 项目返回设置页面。在身份部分的顶部，你可以更改应用的显示名称。只需在显示名称文本框中输入 **Birthdays**。这只会更改显示在应用图标下方的名称。你的项目名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，让我们创建应用屏幕吧！

### 显示你朋友的生日

从项目导航器中选择 *Main.storyboard* 打开故事板。这是我们设计应用 *用户界面* 的地方。用户界面只是一个 fancy 名词，指的是用户将看到并用来与应用交互的内容——图像、文本、按钮等等。*故事板* 让你以可视化方式组织应用的各个屏幕。我们将使用故事板来查看所有使用的屏幕以及它们之间的连接。

选择了*Main.storyboard* 后，通过按 ⌘ -0 隐藏导航面板，以便腾出更多屏幕空间。你的故事板应该已经包含一个视图控制器。

现在看看工具区的顶部。你应该会看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，它们是帮助你更仔细地查看故事板中元素并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它将出现在工具区。

**检查故事板项目**

图 9-5 显示了故事板打开时，在工具区出现的检查器选择栏的特写。

![Image](img/Image00201.jpg)

*图 9-5：你可以在故事板的工具区使用六个检查器。*

让我们从左到右依次了解各个检查器。页面图标打开文件检查器。在这里你可以更改故事板文件的设置。在本书以及大多数应用程序中，你不会使用这个检查器。

下一个检查器，由问号图标表示，是快速帮助检查器。这个检查器将提供关于你当前在故事板中选择的项目的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。你可以在这里为故事板项目设置自定义类。

接下来的两个检查器是你在故事板中最常使用的两个，我们将在文本中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置故事板中选定项目的各种属性。例如，它可以用来设置标签的文本、按钮的颜色，或者文本输入框周围显示的框类型。带有尺子图标的大小检查器用于设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，它的图标看起来像一个圈中的箭头。这个检查器可以将故事板中的项目与您在类中编写的代码片段连接起来。我们将在第十章 中展示如何做到这一点。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊类型的视图控制器，用于显示列表，在 Xcode 中称为*表视图控制器*。在我们的应用程序中，表视图控制器将显示你的朋友生日的列表！现在它看起来只是一个空白屏幕，稍后你将在“创建生日表视图控制器”（第 156 页）中学习如何显示生日数据。

让我们向故事板中添加一个表视图控制器。如果你先将故事板缩小，这个步骤会更容易，因为你可以更好地看到视图控制器。在故事板中的视图控制器外的空白处双击即可缩小视图。现在你的屏幕应该已经缩小了。

在工具面板的底部有一个区域，顶部有四个按钮。选择第三个按钮，它看起来像是一个圆圈内的方形。这个按钮是对象库，你可以在其中找到可以添加到故事板的元素。滚动浏览对象库列表，直到找到表视图控制器，或者使用面板底部的筛选栏搜索“table view controller”。然后点击并将该对象拖到你的故事板上，放置在已经存在的视图控制器旁边。你的故事板应该像图 9-6 中的那样。

请注意，在你添加表视图控制器后，左侧的大纲视图中会出现一个“表视图控制器场景”条目，里面包含一个表视图控制器。你的故事板中的场景表示应用程序中某个屏幕区域。对于 iPhone 应用程序，通常一次屏幕上只有一个场景，并且该场景会填满整个屏幕。iPad 应用程序则可以同时显示两个或更多的场景。

![Image](img/Image00202.jpg)

*图 9-6：将表视图控制器添加到“生日”屏幕的故事板中*

下一步是将这个新的视图控制器设置为运行应用时首先出现的屏幕，因为我们希望用户打开应用时看到生日列表。执行此操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧的大纲视图中选择表视图控制器并将其设为初始视图控制器。*

首先，在大纲视图➊中选择**表视图控制器**。然后在工具面板中打开属性检查器➋。在那里，勾选**是初始视图控制器**的框➌。完成此操作后，一个箭头应出现在你的表视图控制器的左侧，表示应用程序启动时会显示此视图控制器。

#### 添加导航控制器

现在我们将给视图控制器添加一个标题，显示为“生日”，并添加一个“添加”按钮，该按钮会弹出添加生日的视图控制器。为了实现这一点，我们将首先把表视图控制器放入一个*导航控制器*中。导航控制器可以管理一个或多个视图控制器。它带有一个*导航栏*，该栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并带有左右两侧的按钮，用于导航到应用中的其他屏幕。你会在多个 iOS 应用程序中看到这个栏，比如设置应用和信息应用。

在大纲视图中选择**Table View Controller**。选择后，您需要通过 Xcode 菜单将表视图控制器嵌入到导航控制器中。前往**Editor** ▸ **Embed In** ▸ **Navigation Controller**。

将表视图控制器嵌入到导航控制器后，您的故事板应该像图 9-8 中所示的那样。导航控制器将在故事板中显示为一个屏幕。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表应用中用户将看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像是一个独立的屏幕，导航控制器实际上只是一个容器，用来包含用户在应用中切换的其他视图控制器。将一个视图控制器嵌入到导航控制器中意味着您的应用可以在不同的视图之间来回导航。

您应该会看到导航控制器和表视图控制器顶部有灰色的导航栏。当应用运行时，导航栏会告诉用户他们所在的屏幕标题，并且可能还包含按钮和箭头，用户可以通过这些按钮和箭头前往其他屏幕。为了通过导航栏告诉用户他们所在的屏幕，我们需要为屏幕命名。现在是时候回到故事板进行缩放了。双击故事板中的空白区域进行缩放，然后滚动视图，使您可以看到表视图控制器。要为表视图控制器添加标题，请在左侧的大纲视图中点击**Navigation Item**，它位于**Table View Controller Scene**下。

![图片](img/Image00205.jpg)

选择后，您可以在右侧的属性检查器中输入屏幕标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。完成此步骤并按下 RETURN 后，您会看到大纲视图中的表视图控制器条目自动更新为“Birthdays Scene”。

接下来，我们将创建一个“添加”按钮，这样您就可以添加生日了！

#### 添加一个按钮

我们希望用户能够打开应用，查看他们的生日列表，并向该列表添加一个生日。让我们创建一个按钮，让他们可以做到这一点！

我们需要在导航栏上添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。在对象库中找到“Bar Button Item”，然后将其拖放到表视图控制器的导航栏右侧，如图 9-9 所示。

现在我们要将这个按钮变成“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮，我们可以使用它。在属性检查器中，将“bar button item”的系统项目更改为**Add**。您应该会看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮点击时应该做什么。我们希望它能打开“添加生日”视图控制器，所以我们需要将添加按钮连接到该视图控制器。首先，双击故事板进行缩小，确保你可以看到“生日”表格视图控制器和将来成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标。这将弹出一个连接对话框，就像图 9-10 中显示的那样。

![Image](img/Image00206.jpg)

*图 9-9：将一个条形按钮项目拖动到生日视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在出现的对话框中选择 Present Modally。*

连接对话框为你提供了几种选项来选择你希望在两个视图控制器之间进行的*segue*——即从一个屏幕到另一个屏幕的过渡方式。点击连接对话框中的**Present Modally**选项。这将使视图控制器以*模态*视图控制器的形式出现在屏幕上。在 iPhone 上，模态视图控制器会从手机的底部弹出，而且它不会自动带有返回按钮来返回到前一个屏幕。相反，模态视图控制器可以有其他按钮，比如取消或保存。还有其他类型的 segue，比如 Show segue，其中视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，这个屏幕应该作为一个模态视图显示，并且带有一个取消按钮。否则，如果你使用类似 Show segue 的过渡方式并带有返回按钮，用户可能会在输入所有内容后点击返回按钮而没有保存任何内容！有了取消按钮，用户必须故意点击取消才能退出屏幕。

要查看模态输入视图控制器的一个好例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏的右侧会有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，用来在不保存的情况下退出屏幕，右侧有一个添加按钮，用来在关闭模态窗口之前创建新的事件。你应该能看到，新事件模态视图从屏幕底部弹出，并在被关闭时再返回到底部。我们希望用户能保存生日，所以我们也会使用模态。

现在让我们试着运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先通过点击 Xcode 左上角的设备列表，选择一个设备模拟器（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角的应用名称旁设置模拟器将运行的设备。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，供你选择运行应用的设备。我们选择 iPhone 7。在你选择好模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R**。

当模拟器启动以运行你的应用时，如果它太大，无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器以选择它，然后前往 **Window** ▸ **Scale**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用时并没有发生太多事情。你应该能看到你的第一个“Birthdays”屏幕，并有一个加号按钮，如图 9-1 所示。显然，在这一点上，你的“Birthdays”屏幕会是空的。点击加号按钮将会显示一个空白的第二个屏幕。查看完你的应用后，通过点击 Xcode 中的停止按钮关闭应用，停止按钮就在你之前点击的播放按钮旁边。停止应用后，你应该会在模拟器的主屏幕上看到你的应用图标！（见图 9-12）。

就这样！现在我们需要配置第二个屏幕，使其可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，并为其添加标题。为此，你需要将其嵌入到一个独立的导航控制器中。当一个视图控制器是模态时，它不会继承我们故事板上已有的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过在故事板中点击选择简单视图控制器来选择它。然后，前往 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在你应该看到，在“视图控制器场景”下的轮廓视图中添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题 **Add a Birthday**。这些步骤与之前将“Birthdays”标题添加到表视图控制器时的步骤相同。

现在，当“添加生日”视图控制器在应用中出现时，它会在顶部显示其标题。

#### 添加朋友的姓名和生日

当你在第十章中输入朋友的生日时，应用中的每一项都会包含名字、姓氏和生日。我们来为“添加生日”视图控制器添加一些*输入控件*，让用户可以为每个人输入这些信息。输入控件是像文本框或下拉菜单这样的元素，允许用户在应用中输入数据。我们将从添加用户可以输入的所有信息的输入控件标签开始。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器制作一个显示“First Name”的标签。这个标签将放置在一个文本框旁边，用户可以在其中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器中。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框，并输入**First Name**作为显示文本，如图 9-14 所示。

现在我们要使用尺寸检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*为单位的。注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点可能等于 1 个像素、一个 2×2 像素的正方形，或者一个 3×3 像素的正方形。这三个缩放因子被称为@1x、@2x 和@3x（我们在设置应用图标时提到过这些相同的大小）。不同的设备也有不同的点分辨率，宽度从 320 点到 1,024 点不等，纵向从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：制作标签显示* First Name

只有最旧款的 iPhone 和 iPod 使用@1x 缩放因子，而且你无法在这些型号上运行你的应用（BirthdayTracker 只支持 iOS 10+）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则很可能它们使用的是@2x 缩放因子，这些设备使用的是@3x 缩放因子。

对象在屏幕上的位置也是基于点来计算的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的距离。（见图 9-15）。我们将设置每个我们添加到视图控制器中的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们想要将第一个标签的位置调整到屏幕边缘之外，但仍然留出足够的空间容纳文本输入框以及其他标签和输入项。在尺寸检查器的视图部分，设置 x 位置为 20，y 位置为 100，宽度为 100。高度保持为 21。

完成这些步骤后，重复这些步骤，向添加生日的视图控制器中再添加两个标签：姓氏标签和出生日期标签。我们需要将其他标签和输入控件放置好，以确保它们不会重叠。在某些情况下，这可能会有些棘手，并可能需要一些时间。对于这个应用程序，我们已经为你计算了可以放置对象的 iPhone 7 屏幕上的位置。稍后，我们将解释如何使你的应用在其他设备上工作。表 9-1 列出了你应该给每个标签的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个最接近的标签大至少 21 个点。由于我们还要在每个标签下方添加输入控件，所以我们将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

太棒了！现在你的故事板应该看起来像 图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个 *文本字段*，用于输入名字和姓氏。文本字段是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们就可以在文本框中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据 表 9-2 中所示的大小和位置设置这两个文本字段。你可以使用大小检查器，就像设置标签时一样。

表 9-2：视图控制器中的文本字段输入

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一项是一个叫做 *日期选择器* 的轮盘。这个控件可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，用于让用户选择日期或时间。它可以包含日期和时间，就像日历应用中使用的日期选择器一样（见 图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，就像时钟应用中添加闹钟时使用的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的功能。

在对象库中滚动直到找到日期选择器，然后点击并拖动它到出生日期标签下方的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的一些属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而非日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将这个日期改为你的出生日期吧！将日期字段从当前日期更改为**自定义**。完成此操作后，一个新框将出现。将日期更改为你的出生日期。

让我们通过运行应用来测试目前的效果！我们为输入控件所使用的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你点击“出生日期”视图控制器上的 + 按钮时，“添加生日”屏幕应该会显示出来，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上的完美适配。*

![图片](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器（比如 iPhone 5s）来运行应用，并重新运行一次。你会发现界面看起来有些不对劲。

所有你添加到故事板中的元素都出现了，但文本字段溢出了屏幕边缘。现在，所有元素都在屏幕上，接下来的步骤是确保它们在任何屏幕尺寸上都能正确显示。我们将通过一个叫做*自动布局*的工具来完成这一步。

#### 让你的应用在每个设备上都看起来完美——使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会有更多尺寸。你需要设计应用，使其在任何设备上都能良好显示。这意味着你希望你的应用能够根据运行设备的不同，自动调整应用中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的工具来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来调出自动布局菜单。*

在屏幕故事板面板的底部有一条带有图标的带状工具栏，位于“实用工具”面板之前的最右侧的图标是两个垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，上面写着“解决自动布局问题”。点击此图标，弹出一系列建议。点击**添加缺失的约束**。^(*) 这样，你会看到一大堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的尺寸正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适配屏幕宽度，不会超出屏幕边缘。自动布局还确保每个文本字段前后都有 20 个点的间距，使其在屏幕上居中显示。

现在，再次在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这部分内容，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮暂时不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使得这些按钮可以退出“添加生日”屏幕并将生日保存到应用中。

要添加“保存”按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像之前为“添加”按钮做的那样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加“取消”按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，方法与之前设置保存按钮相同。你的视图控制器应该看起来像图 9-21 所示。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行应用，查看新按钮的效果！

点击生日表视图控制器中的 + 按钮应该会将你带到“添加生日”视图控制器，在那里你可以输入一个人的名字和出生日期。点击“取消”和“保存”按钮目前不会执行任何操作——我们将在第十章中实现这两个功能！

### 你学到的内容

在本章中，你通过创建生日和添加生日屏幕的基本用户界面，开始制作一个 BirthdayTracker 应用。你还使用表视图控制器创建了生日屏幕，并使得用户可以通过“添加”按钮和导航控制器在屏幕之间进行导航。

现在，你已经完成了应用的基本框架，接下来你将在第十章中编程实现取消和保存按钮，以便你能够在应用中添加和保存生日！

* 在某些版本的 Xcode 中，Add Missing Constraints 选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **Reset to Missing Constraints** 选项来添加缺失的约束。

### 创建一个新的 Xcode 项目

到目前为止，你一直在 playground 中编写大部分代码。playground 是一个学习编程的好地方，但要编写可以在 iPad 或 iPhone 上运行的应用，你需要创建一个 Xcode 项目，就像你在第一章中为 Hello World 应用所做的那样。

在 Xcode 菜单中，选择 **File** ▸ **New** ▸ **Project**。在对话框顶部选择 **iOS**，并为你的项目模板选择 **Single View Application**，然后点击 **Next**。

在出现的对话框中，Xcode 会要求你为你的新应用设置一些选项。由于这只是一个示例，你不需要太过认真对待这部分内容。当你编写一个计划出售或分发到 App Store 上的应用时，设置这些值就非常重要了。给你的应用命名为 **BirthdayTracker**，确保语言设置为 **Swift**，设备设置为 **iPhone**，并勾选 **Use Core Data** 选项。你的组织名称和组织标识符应该已经自动填入，和你在第一章中创建 Hello World 应用时输入的值一致。

点击 **Next** 。在弹出的对话框中，选择你希望保存项目的位置，并点击 **Create** 。你的 Xcode 项目应该会自动打开。花一点时间，确保你在项目导航器中看到了名为 *BirthdayTracker.xcdatamodeld* 的文件（参见 图 9-2）。

![Image](img/Image00197.jpg)

*图 9-2：确保你的新项目中有一个* BirthdayTracker.xcdatamodeld *文件。*

你需要 *BirthdayTracker.xcdatamodeld* 来在 iPhone 上保存生日。如果它缺失了，说明你在创建 Xcode 项目时没有勾选 Use Core Data 选项。别担心——这个问题非常容易解决。

如果你的 *BirthdayTracker.xcdatamodeld* 文件丢失，关闭你的项目（File ▸ Close Project），然后重新开始，创建一个新的 Xcode 项目，并勾选 Use Core Data 选项。当系统提示你是否要替换 BirthdayTracker 项目时，点击 **Replace**，你就大功告成了！

你的新 BirthdayTracker Xcode 项目会打开。如果你没有将 Apple 账户添加到 Xcode，你会看到在应用程序设置的 General 部分中显示“未找到账户”的信息。除非你希望在真实设备上运行应用，否则不需要添加账户。（记住，你也可以在 Xcode 的模拟器上运行你的应用。）要将 Apple 账户添加到 Xcode，点击 **Add Account** 按钮。（关于如何添加 Apple 账户的详细说明，请参见 “你的第一个应用！” 第 5 页）

这个常规设置屏幕也是你设置希望应用运行的设备方向的位置。我们希望 BirthdayTracker 应用只在*竖屏*模式下运行。竖屏模式是手机的常规方向，主屏按钮在底部。*横屏*模式是当你将手机横过来时，屏幕也会旋转，屏幕的宽度变成手机的高度，屏幕的高度变成手机的宽度。BirthdayTracker 应用在横屏模式下看起来不太好，所以我们不希望在用户将手机横过来时，屏幕会发生变化。应用在倒立的情况下看起来没问题，但如果用户将手机转过来，主屏按钮在顶部时，屏幕翻转可能会让用户感到迷惑，因此我们也不支持倒立模式。在“部署信息”部分，找到设备方向，取消勾选 **左横屏** 和 **右横屏**，确保只勾选 **竖屏**。

让我们来看看 Xcode。选择左侧导航窗格中的 *ViewController.swift*，你应该会看到类似 图 9-3 的内容。

![图片](img/Image00198.jpg)![图片](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航窗格 ➊ ，你可以通过选择 **视图** ▸ **导航器** ▸ **隐藏/显示导航器** 或按 ⌘ -0 来隐藏或显示它。你将使用导航器来选择和查看项目中的文件。

编辑器窗格位于窗口的中央 ➋ 。这里是你编写代码的地方！在这里，你还可以更改应用的设置，并使用故事板（你在 第一章 中看到的）布局将显示在应用中的项目。我们很快会更详细地讨论故事板。

右侧是实用工具窗格 ➌ ，你可以通过选择 **视图** ▸ **实用工具** ▸ **隐藏/显示实用工具** 或按下 ⌘ -OPTION -0 来隐藏或显示它。当故事板打开时，实用工具窗格将允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用程序都会有某种图标，显示在用户设备的主屏幕上。我们将通过添加应用图标来开始开发我们的 BirthdayTracker 应用。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图片。下载 ZIP 文件后，你将在 *Downloads* 文件夹中找到一个名为 *ch9-images* 的文件夹，里面有你需要的图片文件。获取这些文件后，从项目导航器中选择 *Assets.xcassets*。这将打开应用的 *资源目录*，在这里你可以放置应用将使用的任何 *资源*（图片、声音等），包括应用图标。实际上，资源目录中已经有一个占位符，你可以在其中添加图标。从目录左侧的菜单中选择 **AppIcon**，你应该会看到几个图片的占位符。

要添加一个会显示在 iPhone 主屏幕上的应用图标，你需要为标记为*iPhone App*的图标集提供 2x 和 3x 的图像。2x 尺寸适用于大多数 iPhone，比如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸的图像。你将在第十四章中了解更多关于为不同屏幕分辨率调整图像尺寸的内容。

将图标添加到资源目录非常简单！下载提供的图像后，打开 Finder 中的*下载*文件夹。然后，直接将图片*cake@2x.png*拖到 iPhone App 2x 框中，将*cake@3x.png*拖到 3x 框中。完成后，你的资源目录应该像图 9-4 所示。

![Image](img/Image00200.jpg)

*图 9-4：我们现在有了一个应用图标！*

除了应用图标，应用还会有一个显示在图标下方的显示名称。默认情况下，这个名称就是应用的名称 BirthdayTracker。然而，这个名字稍微有点长，无法完全显示在图标下方，所以让我们将其改为一个更短的名称：Birthdays。为此，请通过在项目导航器中选择 BirthdayTracker 项目，返回设置页面。在顶部的身份部分，你可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这将仅更改显示在应用图标下方的名称，项目的名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，接下来让我们创建应用屏幕！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*，以打开 storyboard。这就是我们将设计应用*用户界面*的地方。用户界面就是用户与应用交互时看到和使用的元素——图像、文本、按钮等等。*storyboard*让你可以直观地组织应用的各个屏幕。我们将使用 storyboard 查看所有使用的屏幕及它们之间的连接。

选择了*Main.storyboard*后，按下⌘ -0 隐藏导航面板，这样你就能有更多的屏幕空间。你的 storyboard 应该已经包含了一个视图控制器。

现在看一下工具面板的顶部，你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你仔细查看 storyboard 中元素并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它会出现在工具面板中。

**检查 storyboard 项目**

图 9-5 显示了当 storyboard 打开时，在工具面板中出现的检查器选择栏的特写。

![Image](img/Image00201.jpg)

*图 9-5：你可以在 storyboard 的工具面板中使用六个检查器。*

让我们从左到右逐一了解检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书中以及大多数应用中，你不需要使用这个检查器。

下一个检查器，图标是一个问号，是快速帮助检查器。这个检查器将提供你当前在故事板中选定项的详细类信息。

第三个检查器，图标是身份证样式的，是身份检查器。在这里你可以为故事板中的项设置自定义类。

接下来的两个检查器是你在工作流程中最常使用的，它们会在文本中频繁提到。属性检查器的图标看起来像一个盾牌。这个检查器用于设置故事板中选定项的各种属性。它可以用来设置标签的文本、按钮的颜色，或是围绕文本输入框显示的框的类型，举个例子。尺寸检查器，图标是一个尺子，用于设置每个故事板项的大小和屏幕位置。

最后是连接检查器，图标看起来像一个箭头围绕着一个圆圈。它可以用来将故事板中的项与在类中编写的代码连接起来。我们将在第十章中展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊的视图控制器类，用来显示一个列表，在 Xcode 中称为*表视图控制器*。在我们的应用中，表视图控制器将显示你朋友们的生日列表！现在它看起来只是一个空白屏幕，你将学习如何在“创建生日表视图控制器”一章中在第 156 页展示生日数据。

让我们将一个表视图控制器添加到故事板中。如果你先从故事板上缩小视图，使视图控制器更加清晰，这一步会更容易。双击视图控制器外的空白区域来实现。现在你的屏幕应该已经缩小了。

在工具面板的底部有一个区域，上面有四个按钮。选择第三个按钮，它看起来像是一个圆圈中的正方形。这个是对象库，你可以在这里找到要添加到故事板的项。浏览对象库列表，直到你找到“表视图控制器”，或者使用面板底部的过滤栏搜索“table view controller”。然后点击并拖动该对象到你的故事板中，放在已经存在的视图控制器旁边。你的故事板应该像图 9-6 中的样子。

注意，在你添加表视图控制器后，左侧大纲视图中会出现一个表视图控制器场景条目，并且其内部包含一个表视图控制器。故事板中的场景代表应用中的一个屏幕区域。对于 iPhone 应用，通常一次只会有一个场景显示在屏幕上，并且该场景会填满整个屏幕。而 iPad 应用则可以在屏幕上同时显示两个或更多的场景。

![图片](img/Image00202.jpg)

*图 9-6：将表视图控制器添加到故事板中的生日屏幕*

下一步是将这个新视图控制器设为当你运行应用时首先显示的屏幕，因为我们希望用户打开应用时能看到生日列表。完成此操作的步骤见于图 9-7。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表视图控制器，并将其设为初始视图控制器。*

首先，在大纲视图中选择**表视图控制器** ➊。然后在你的工具面板中打开属性检查器 ➋。在那里，勾选**是初始视图控制器** ➌。完成后，表视图控制器左侧应出现一个箭头。这个箭头表示应用启动时会显示这个视图控制器。

#### 添加导航控制器

现在我们将为视图控制器添加一个标题，显示“生日”，并添加一个“添加”按钮，用于弹出“添加生日”视图控制器。为此，我们首先需要将表视图控制器嵌入到*导航控制器*中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且在其左右两侧有按钮，用于导航到应用中的其他屏幕。在许多 iOS 应用中，你会看到屏幕顶部有这个栏，例如设置应用和消息应用。

在大纲视图中选择**表视图控制器**。选择后，你需要使用 Xcode 菜单将表视图控制器嵌入到导航控制器中。转到 **Editor** ▸ **Embed In** ▸ **Navigation Controller**。

将表视图控制器嵌入到导航控制器中后，你的故事板应该像图 9-8 所示。导航控制器将作为一个屏幕显示在故事板中。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表用户在应用中看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像是一个单独的屏幕，实际上，导航控制器只是一个容器，用来存放用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中，意味着你的应用可以从一个视图切换到另一个视图，并且能够返回。

你应该能看到导航控制器和表视图控制器顶部的灰色导航条。当应用程序运行时，导航条会告诉用户他们所在屏幕的标题，并且可能还包含按钮和箭头，用户可以用它们去访问其他屏幕。为了使用导航条告诉用户他们所在的屏幕，我们需要为我们的屏幕设置标题。现在是回到故事板视图的好时机。双击故事板的空白区域以放大视图，然后滚动视图，使你可以看到表视图控制器。要为表视图控制器添加标题，请在左侧的轮廓视图中，点击**表视图控制器场景**下的**导航项目**。

![Image](img/Image00205.jpg)

选择这个选项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航条显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。完成此步骤并按下 RETURN 键后，轮廓视图中的“表视图控制器场景”条目会自动更新为“生日场景”。

接下来，我们将制作一个“添加”按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并将一个生日添加到列表中。让我们制作一个按钮，让他们能够做到这一点！

我们需要在导航条上添加一个按钮，链接到“添加生日”场景，这样用户就可以输入生日了。在对象库中找到“条形按钮项”（Bar Button Item），然后将其拖动并放置到表视图控制器导航条的右侧，如图 9-9 所示。

现在我们要把这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮可以使用。在属性检查器中，将条形按钮项的系统项（System Item）改为**添加**。你应该能看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在被点击时要执行什么操作。我们希望它能够打开“添加生日”视图控制器，所以我们需要将“添加”按钮与该视图控制器连接起来。首先，双击故事板缩小视图，以确保你可以看到“生日”表视图控制器和将最终成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，然后从“+”按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时，松开鼠标。这样会弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将条形按钮项拖动到“生日”视图控制器的导航条上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态呈现”。*

连接对话框为你提供了几种不同的*segue*（从一个屏幕到另一个屏幕的过渡）选项。点击连接对话框中的**模态展示**选项。这将使视图控制器作为*模态*视图控制器显示在屏幕上。在 iPhone 上，模态视图控制器从手机底部进入屏幕，并且它不会自动带有返回按钮返回到上一个屏幕。相反，模态视图控制器可以带有其他按钮，例如取消或保存。还有其他类型的 segue，比如 Show segue，在其中视图控制器从右侧推送到屏幕上，并且在导航栏的左侧有返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，应该将屏幕作为模态显示，并带有一个取消按钮。否则，如果你使用像 Show segue 那样带有返回按钮的方式，可能会出现用户输入完所有信息后点击返回按钮但没有保存任何内容的情况！有了取消按钮，用户必须故意点击才能退出该屏幕。

要查看一个模态输入视图控制器的好例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏的右侧有一个+按钮，你可以点击它来添加一个日历事件。点击+按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，可以在关闭模态视图前创建新事件。你应该能看到新事件模态视图从屏幕底部进入，关闭时会向下消失。我们希望用户能够保存生日，因此我们也会使用模态视图。

现在让我们尝试运行我们的应用，看看目前为止我们做了什么！要运行应用，首先点击 Xcode 左上角的 BirthdayTracker 旁边的设备列表，选择一个设备模拟器（见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角的应用名称旁边设置模拟器将运行的设备。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表供你选择以运行应用。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或使用键盘快捷键⌘ -**R**。

当模拟器打开以运行应用时，如果它太大而无法适应你的电脑屏幕，你可以调整其大小。点击模拟器以选择它，然后转到**窗口** ▸ **缩放**，在模拟器菜单中选择一个更小的缩放比例。

到目前为止，当你运行应用程序时，没什么特别的变化。你应该会看到你的第一个生日页面，页面上有一个 + 按钮，正如之前在图 9-1 中所示。显然，到此为止，你的生日页面是空的。点击 + 按钮会弹出一个第二个空白页面。查看完应用后，通过点击 Xcode 中停止按钮来关闭应用，停止按钮位于你之前点击的播放按钮旁边。当你停止应用时，你应该能在模拟器的主屏幕上看到你的应用图标！（见图 9-12）

就这样！接下来我们需要配置第二个页面，使其能够用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，通过添加标题来开始。为此，你需要将它嵌入到一个独立的导航控制器中。当视图控制器是模态时，它不会继承我们在故事板上已有的导航控制器中的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击故事板中的视图控制器，选择该视图控制器。然后，转到**编辑** ▸ **嵌入于** ▸ **导航控制器**。现在，你应该看到在视图控制器场景下的轮廓视图中添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与你之前为表格视图控制器添加标题“生日”时的操作一样。

现在，当“添加生日”视图控制器出现在应用程序中时，它会在顶部显示它的标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每一条记录将包括名字、姓氏和出生日期。我们来给“添加生日”视图控制器添加一些*输入控件*，这样用户就可以为每个人输入所有信息。输入控件是像文本框或下拉菜单之类的控件，允许用户将数据输入到应用程序中。我们将通过添加所有可以让用户输入信息的输入控件标签来开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个标签，内容为“名字”。这个标签会出现在一个文本框旁边，用户可以在其中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在，我们想通过大小检查器设置标签的大小和位置。在 Xcode 的 storyboard 中，宽度和高度是以*点（points）*为单位进行度量的。请注意，1 点不等于 1 像素。根据您的应用运行的设备类型，1 点会转换为 1 像素、2×2 像素的方块或 3×3 像素的方块。这三种缩放因子分别称为 @1x、@2x 和 @3x（我们在设置应用图标时提到过的相同尺寸）。不同设备的点分辨率也不相同，宽度从 320 到 1,024 点不等，高度从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* 名字

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，且您将无法在这些型号上运行您的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非您的 iPhone 6 Plus、6s Plus 或 7 Plus，否则您的手机或 iPod 很可能使用 @2x 缩放因子，这些设备使用的是 @3x 缩放因子。

对象在屏幕上的位置也是基于点来确定的。对象的 x 位置是从屏幕的左侧到对象左侧的点数距离。y 位置是从屏幕的顶部到对象顶部的距离。（参见图 9-15。）我们将设置添加到视图控制器中的每个库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕的边缘之外，同时仍然为文本输入字段和其他标签及输入框留下足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。将高度保持为 21。

完成这些操作后，重复这些步骤以向添加生日的视图控制器中添加两个标签：姓氏标签和生日标签。我们需要定位其他标签和输入框，确保它们不会重叠。在某些情况下，这可能会变得有些棘手，并且可能需要一些时间。对于这个应用程序，我们已经为您计算了可以在 iPhone 7 屏幕上放置对象的位置。稍后，我们会解释如何让您的应用程序在其他设备上运行。表 9-1 列出了您应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x-坐标相同，这样它们就能垂直对齐，但每个标签的 y-坐标都不同。每个标签的高度为 21，因此 y-坐标需要比下一个最接近的标签大至少 21 个点。由于我们还将在每个标签下方添加输入控件，所以我们已将 y-坐标调整得更大，以容纳标签的高度和输入控件的高度。

很棒！现在你的故事板应该像图 9-16 中那样。

![Image](img/Image00214.jpg)

*图 9-16：输入框的标签已添加到视图控制器中。*

接下来，你将添加两个 *文本框*，用于输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本框对象到你的视图控制器中，一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中的大小和位置为这两个文本框设置尺寸。你可以使用尺寸检查器，就像你为标签设置一样。

表 9-2：视图控制器中的输入文本框

| 文本框 | X-坐标 | Y-坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个称为 *日期选择器* 的控件。这将使你能够轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以显示日期和时间，就像日历应用中的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，使用日期选择器选择日期。*

日期选择器也可以仅显示时间，就像闹钟应用中用于添加闹钟的日期选择器，或者只显示日期，这也是我们在生日追踪器中使用的功能。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到视图控制器中的出生日期标签下方。使用尺寸检查器，将 x-坐标设置为 0，y-坐标设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示 **日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们把这个日期改成你的生日吧！将日期字段从当前日期改为 **自定义**。这样会弹出一个新框，改成你的生日。

让我们通过运行应用来测试它目前的表现！我们为输入控件设置的尺寸在 iPhone 7 屏幕上显示得很合适。所以选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这一次，当你点击生日视图控制器上的 + 按钮时，应该会显示添加生日的页面，如 图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上显示得非常合适。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很不错，但其他设备呢？选择一个较小的模拟器运行应用，比如 iPhone 5s，再次运行应用。你会发现一些东西看起来不太对劲。

所有添加到故事板上的元素都出现了，但文本框已经超出了屏幕边缘。现在，你已经把所有元素放到屏幕上，下一步是让它们适应任何屏幕大小。我们将通过一个叫做 *自动布局* 的工具来实现这一点。

#### 让你的应用在每个设备上都能完美显示，使用自动布局

仅 iPhone 就有三种不同的屏幕尺寸，并且未来可能会出现更多尺寸。你需要设计你的应用，以确保它在任何设备上都能显示得很好。这意味着你需要让应用自动调整屏幕上所有元素的位置和大小，以适应应用运行的设备。自动布局使用一种叫做 *布局约束* 的方式来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择 **视图控制器**。接着，看看编辑器面板右下角的四个图标（见 图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕故事板面板的底部，有一个包含图标的带状工具条，位于实用工具面板之前的最右侧是一个三角形图标，夹在两条垂直线之间。将鼠标光标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击此图标，弹出建议菜单。点击 **添加缺失的约束**。^(*) 这样，你会看到一大堆布局约束被添加到添加生日页面中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的宽度适应屏幕，不会超出边界。自动布局还确保每个文本字段前后有 20 个点的间距，以便它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用。此时，添加生日屏幕应该完美显示。

#### 添加保存和取消按钮

为了完成这项工作，我们将展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。按钮目前还不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消并保存生日信息到应用中。

要添加保存按钮，拖动一个条形按钮项从对象库中，并将其放置在导航栏的 *右侧*。我们将把这个按钮改为保存按钮，就像我们处理添加按钮一样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中再拖动一个条形按钮项，这次将其放置在导航栏的 *左侧*。使用属性检查器将其设置为取消按钮，就像你之前为保存按钮做的那样。你的视图控制器应该像图 9-21 所示那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新的按钮！

点击生日表视图控制器上的 + 按钮应该会带你进入添加生日视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前不会执行任何操作——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始通过创建生日和添加生日屏幕的基本用户界面来制作一个 BirthdayTracker 应用。你还使用表视图控制器创建了生日屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间导航。

现在，你已经完成了应用的基本框架，接下来将在第十章中编写取消和保存按钮的代码，这样你就能在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，添加缺失约束的选项被禁用。这是一个苹果的 bug。在这种情况下，选择 **重置为缺失约束** 选项以添加缺失的约束。

到目前为止，你一直在 playground 中编写大部分代码。playground 是学习编程的一个好地方，但要编写一个可以在 iPad 或 iPhone 上运行的应用，你需要创建一个 Xcode 项目，就像你在第一章中为 Hello World 应用所做的那样。

在 Xcode 菜单中，点击**文件** ▸ **新建** ▸ **项目**。在对话框顶部选择**iOS**，然后选择**单视图应用程序**作为你的项目模板，接着点击**下一步**。

在弹出的对话框中，Xcode 会要求你为新应用设置一些选项。由于这只是一个示例，你无需过于重视这部分内容。当你开发一个计划出售或在 App Store 上发布的应用时，设置这些值才会更为重要。将你的应用命名为**BirthdayTracker**，确保语言选择为**Swift**，设备选择为**iPhone**，并勾选**使用核心数据**。你的组织名称和组织标识符应该已经预填入你在第一章中创建 Hello World 应用时输入的值。

点击**下一步**。在打开的对话框中，选择你想要保存项目的位置，然后点击**创建**。你的 Xcode 项目应该会自动打开。稍等片刻，确保在项目导航器中列出了一个名为*BirthdayTracker.xcdatamodeld*的文件（见图 9-2）。

![图片](img/Image00197.jpg)

*图 9-2：确保你的新项目中有一个* BirthdayTracker.xcdatamodeld *文件。*

你需要*BirthdayTracker.xcdatamodeld*来保存 iPhone 上的生日。如果缺少它，说明你在创建 Xcode 项目时没有勾选使用核心数据框。别担心——这很容易解决。

如果缺少*BirthdayTracker.xcdatamodeld*，请关闭你的项目（文件 ▸ 关闭项目），然后重新创建一个新的 Xcode 项目，并勾选使用核心数据框。系统询问是否要替换 BirthdayTracker 项目时，只需点击**替换**，然后一切准备就绪！

你的新 BirthdayTracker Xcode 项目将会打开。如果你还没有将你的 Apple 账户添加到 Xcode，你会在应用设置的签名部分看到一条消息：“未找到账户”。除非你想在真实设备上运行应用，否则不需要添加账户。（记得，你也可以在 Xcode 的模拟器上运行应用。）要将 Apple 账户添加到 Xcode，点击**添加账户**按钮。（有关添加 Apple 账户的更详细说明，请参见《你的第一款应用！》 第 5 页）

这个常规设置屏幕也是你设置应用运行的设备方向的地方。我们希望 BirthdayTracker 应用只在*竖屏*模式下运行。竖屏模式是手机的常规方向，主屏按钮在底部。*横屏*模式是当你将手机横过来时，屏幕也会旋转，使屏幕的宽度变为手机的高度，屏幕的高度变为手机的宽度。BirthdayTracker 应用在横屏模式下看起来不好，所以我们不会让屏幕在用户将手机横过来的时候发生变化。应用在倒置时看起来还行，但如果用户将手机翻转，主屏按钮在上时，屏幕旋转可能会让他们感到迷惑，所以我们也不支持倒置模式。在部署信息部分，在设备方向旁边，取消勾选**左横屏**和**右横屏**，确保只有**竖屏**的框被勾选。

让我们浏览一下 Xcode。选择左侧导航器窗格中的*ViewController.swift*，你应该会看到类似于图 9-3 的界面。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航器窗格 ➊ ，你可以通过选择**视图** ▸ **导航器** ▸ **隐藏/显示导航器**，或者按⌘ -0 来隐藏或显示它。你将使用导航器来选择和查看项目中的文件。

编辑器窗格位于窗口的中央 ➋ 。这里是你编写代码的地方！也是你可以更改应用程序设置并使用故事板布局应用中显示的项的地方，故事板你在第一章中见过。我们稍后会详细讲解故事板。

右侧是实用工具窗格 ➌ ，你可以通过选择**视图** ▸ **实用工具** ▸ **隐藏/显示实用工具**，或者按⌘ -OPTION -0 来隐藏或显示它。当故事板打开时，实用工具窗格将帮助你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用程序都会有一个图标，显示在用户设备的主屏幕上。我们将通过添加应用图标来开始我们的 BirthdayTracker 应用。你可以从*[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)*下载我们将用于图标的两个图片。下载 ZIP 文件后，你将在*Downloads*文件夹中找到一个名为*ch9-images*的文件夹，里面包含你需要的图像文件。获取这些文件后，在项目导航器中选择*Assets.xcassets*。这将打开应用的*资源目录*，这里是你放置任何应用资源（图片、音效等）的地方，包括应用图标。实际上，资源目录已经提供了一个占位符，你可以在其中添加图标。从目录左侧的菜单中选择**AppIcon**，你应该能看到多个图片占位符。

要添加一个会显示在 iPhone 主屏幕上的应用图标，你需要提供用于 *iPhone 应用* 图标集的 2x 和 3x 图像。2x 尺寸适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸的图像。你将在第十四章中了解到更多关于不同屏幕分辨率下图像尺寸的内容。

将图标添加到资源目录非常简单！下载提供的图像后，在 Finder 中打开你的 *Downloads* 文件夹。然后只需将图像 *cake@2x.png* 拖动到 iPhone 应用 2x 框中，再将 *cake@3x.png* 拖动到 3x 框中。完成后，你的资源目录应该像 图 9-4 一样。

![Image](img/Image00200.jpg)

*图 9-4：现在我们有了应用图标！*

除了应用图标外，应用还有一个显示名称，它显示在主页面图标下方。默认情况下，这个显示名称就是应用名称，BirthdayTracker。然而，这个名称稍微有些长，无法完全适应图标下方，所以让我们将它改成更短的名称：Birthdays。为此，请通过在项目导航器中选择 BirthdayTracker 项目，返回设置页面。在“身份”部分的顶部，你可以更改应用的显示名称。只需在“显示名称”文本框中输入**Birthdays**。这只会更改显示在应用图标下的名称，项目的名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，接下来让我们创建应用的界面！

### 显示朋友的生日

从项目导航器中选择 *Main.storyboard* 以打开故事板。这是我们设计应用程序*用户界面*的地方。用户界面只是一个 fancy 名称，指的是用户将看到并用来与应用互动的元素——图像、文本、按钮等。*故事板* 让你以视觉方式组织应用的各个屏幕。我们将使用故事板查看所有使用的屏幕以及它们之间的连接。

选择 *Main.storyboard* 后，按 ⌘ -0 隐藏导航窗格，以便你有更多的屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在看看实用工具窗格的顶部，你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更仔细地查看故事板元素并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它会出现在实用工具窗格中。

**检查故事板项目**

图 9-5 显示了当故事板打开时，实用工具窗格中出现的检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：在故事板的实用工具窗格中，你可以使用六个检查器。*

让我们从左到右依次查看各个检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书和大多数应用程序中，你不会使用这个检查器。

下一个检查器，由问号图标表示，是快速帮助检查器。这个检查器将为你提供有关当前选中项的详细类信息。

第三个检查器，图标是身份证图标，是身份检查器。你可以在这里为故事板中的项设置自定义类。

接下来的两个检查器是你在使用故事板时最常用的两个，我们将在文中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置故事板中选定项的各种属性。例如，它可以用来设置标签的文本、按钮的颜色，或者文本输入框周围显示的框类型。尺寸检查器，图标是一个标尺，用于设置每个故事板项的大小和屏幕位置。

最后是连接检查器，它的图标像一个圆圈中的箭头。这个检查器可以用来将故事板中的项与在你的类中编写的代码连接起来。我们将在第十章中向你展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是“生日”视图控制器。这将是一个特殊类型的视图控制器，用于显示列表，在 Xcode 中称为*表视图控制器*。在我们的应用中，表视图控制器将显示你朋友的生日列表！目前它看起来只是一个空白屏幕，你将在“创建生日表视图控制器”中学习如何显示生日数据，详见第 156 页。

让我们将一个表视图控制器添加到故事板中。首先将故事板缩小，这样你可以更清楚地看到视图控制器。可以通过双击故事板中视图控制器外的空白区域来实现。现在你的屏幕应该已经缩小。

在工具面板的底部，有一个带有四个按钮的区域。选择第三个按钮，它看起来像是一个圆圈中的方形图标。这是对象库，在这里你可以找到要添加到故事板中的项。浏览对象库列表，直到找到“表视图控制器”，或者使用面板底部的过滤器栏搜索“table view controller”。然后点击并拖动该对象到你的故事板中，将它放在已有的视图控制器旁边。你的故事板应该像图 9-6 中的样子。

注意，在你添加表格视图控制器后，左侧大纲视图中会出现一个**表格视图控制器场景**条目，其中包含一个表格视图控制器。你在故事板中的场景表示应用程序中屏幕上的一个区域。对于 iPhone 应用，通常一次只会显示一个场景，并且该场景会填满整个屏幕。而 iPad 应用可以同时显示两个或更多场景。

![图片](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到用于生日屏幕的故事板中*

下一步是让这个新视图控制器成为你运行应用时首先显示的屏幕，因为我们希望在用户打开应用时显示生日列表。完成此操作的步骤如图 9-7 所示。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊ 。然后在工具面板中调出属性检查器 ➋ 。在这里，勾选**作为初始视图控制器** ➌ 。完成此操作后，故事板中表格视图控制器的左侧应该会出现一个箭头。箭头表示应用程序启动时会显示这个视图控制器。

#### 添加导航控制器

接下来，我们将为视图控制器添加一个标题“Birthdays”以及一个“添加”按钮，用于调出添加生日视图控制器。为此，我们首先将表格视图控制器嵌入到*导航控制器*中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧放置按钮，用于导航到应用中的其他屏幕。你可以在多个 iOS 应用中看到这个导航栏，例如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。选择后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。路径是：**Editor** ▸ **Embed In** ▸ **Navigation Controller**。

在将表格视图控制器嵌入到导航控制器后，你的故事板应该像图 9-8 中所示。导航控制器将作为一个屏幕出现在故事板中。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表用户在应用中看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像一个单独的屏幕，实际上导航控制器只是一个容器，包含了用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在不同的视图之间导航并返回。

你应该会看到在导航控制器和表格视图控制器的顶部有灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们所处屏幕的标题，并且可能还包含按钮和箭头，供用户跳转到其他屏幕。为了使用导航栏告诉用户他们所在的屏幕，我们需要为我们的屏幕命名。现在是缩小故事板的好时机。双击故事板的空白处进行放大，然后滚动视图，以便可以看到表格视图控制器。要为表格视图控制器添加标题，请点击左侧大纲视图中的**导航项**，位于**表格视图控制器场景**下。

![图片](img/Image00205.jpg)

选择此项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。你应该会看到，在完成此步骤并按下 RETURN 后，大纲视图中的“表格视图控制器场景”项自动更新为“生日场景”。

接下来，我们将创建一个“添加”按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并向列表中添加一个生日。让我们做一个按钮，让他们可以做到这一点！

我们需要在导航栏上添加一个按钮，进入“添加生日”场景，这样用户就可以输入生日。找到对象库中的“条形按钮项”，然后将其拖动并放置到表格视图控制器的导航栏右侧，如图 9-9 所示。

现在我们想把这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮，我们可以使用。在属性检查器中，将条形按钮项目的系统项更改为**添加**。你应该能看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在点击时该做什么。我们希望它能打开“添加生日”视图控制器，所以我们需要将添加按钮与该视图控制器连接起来。首先，双击故事板进行缩小，确保你能看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，从 + 按钮拖动到故事板右侧的空视图控制器的中间。当视图控制器被高亮显示时，松开鼠标。这将弹出一个连接对话框，类似于图 9-10。

![图片](img/Image00206.jpg)

*图 9-9：将“条形按钮项”拖动到“生日”视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态呈现”。*

连接对话框为你提供了几种选择，可以决定在两个视图控制器之间进行的*过渡*——即从一个屏幕到另一个屏幕的切换方式。点击连接对话框中的**模态呈现**选项。这样，视图控制器将作为*模态*视图控制器呈现到屏幕上。在 iPhone 上，模态视图控制器从手机底部进入屏幕，并且不会自动带有返回按钮来返回到之前的屏幕。相反，模态视图控制器可以有其他按钮，如取消或保存。还有其他类型的过渡，比如显示过渡（Show segue），其中视图控制器从屏幕右侧推入，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你呈现一个用于获取和保存用户输入的屏幕时，该屏幕应该作为模态屏幕呈现，并带有取消按钮。否则，如果使用像“显示”过渡那样带有返回按钮的方式，用户可能在输入完所有内容后直接点击返回按钮而不保存任何东西！有了取消按钮，用户必须故意点击以取消退出屏幕。

要查看一个好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，可以在关闭模态视图之前创建新事件。你应该看到，“新事件”模态视图从屏幕底部进入，并在关闭时从屏幕底部退出。我们希望用户保存生日，因此我们也将使用模态视图。

现在让我们尝试运行我们的应用，看看到目前为止做了哪些工作！首先，通过点击 Xcode 左上角“BirthdayTracker”旁边列出的设备，选择一个设备模拟器（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角应用名称旁边设置模拟器运行的设备。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果它的尺寸太大无法适应你的计算机屏幕，你可以调整它的大小。点击模拟器选择它，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当您运行应用时并没有发生太多事情。您应该会看到第一个“生日”屏幕，上面有一个 + 按钮，如 图 9-1 所示。显然，此时您的“生日”屏幕是空的。点击 + 按钮将打开第二个空白屏幕。当您查看完应用程序后，可以点击 Xcode 中的停止按钮关闭应用，它位于您之前按下的播放按钮旁边。当您停止应用时，您应该会在模拟器的主屏幕上看到您的应用图标！（见 图 9-12）。

就这样！现在我们需要配置第二个屏幕，以便它可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12: 生日跟踪器应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，您需要将其嵌入到自己的导航控制器中。当视图控制器是模态时，它不会继承我们在故事板上已经存在的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击故事板中的视图控制器来选择它。然后转到 **编辑** ▸ **嵌入在** ▸ **导航控制器**。现在，您应该会看到在视图控制器场景下的轮廓视图中已添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题 **Add a Birthday**。这些步骤与您添加“Birthdays”标题到表格视图控制器时所做的步骤相同。

现在，当“添加生日”视图控制器在应用程序中显示时，它将在顶部标有标题。

#### 添加朋友的名字和生日

当您在 第十章 中输入朋友的生日时，您的应用中的每个条目都会有名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些 *输入控件*，以便用户可以为每个人输入所有这些信息。输入控件是像文本框或下拉菜单这样的控件，它们允许用户将数据输入到您的应用中。我们将首先添加用于输入所有信息的标签。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“名字”的标签。这个标签将位于一个文本框旁边，您将在该文本框中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（见 图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13: 向“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name** 作为显示文本，如 图 9-14 所示。

现在我们希望使用大小检查器设置标签的大小和位置。在 Xcode storyboard 中，宽度和高度是以 *点* 为单位的。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点将转化为 1 像素、2×2 像素的方块，或 3×3 像素的方块。这三个缩放因子分别称为 @1x、@2x 和 @3x（这些大小是我们在设置应用图标时讨论过的）。设备的点分辨率也并非都相同，宽度从 320 到 1,024 点不等，高度从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：制作标签显示* 姓名

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，并且你将无法在这些型号上运行你的应用（BirthdayTracker 只支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus（它们使用 @3x 缩放因子），否则很可能你的设备使用 @2x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的距离。（见 图 9-15）。我们将为每个我们添加到视图控制器中的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，同时仍然为其文本输入框以及其他标签和输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成此操作后，重复这些步骤，将另外两个标签添加到“添加生日”视图控制器：一个是姓氏标签，另一个是出生日期标签。我们需要定位其他标签和输入框，确保它们不会重叠。在某些情况下，这可能会变得复杂，并且可能需要一些时间。对于这个应用，我们已经为你计算出了在 iPhone 7 屏幕上放置对象的位置。稍后我们将解释如何让你的应用在其他设备上工作。表 9-1 列出了每个标签应该设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | x 位置 | y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，因此它们会垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置需要比下一个标签的 y 位置至少大 21 点。由于我们还要在每个标签下方添加输入控件，我们已经将 y 位置设置得更大，以适应标签和输入控件的高度。

太好了！现在你的故事板应该像 图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16：输入的标签已添加到视图控制器中。*

接下来，你将添加两个 *文本框*，它们将允许你输入名字和姓氏。文本框是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本框对象到你的视图控制器上。一个用于输入名字，另一个用于输入姓氏。按照 表 9-2 中看到的大小和位置进行设置。你可以使用大小检查器，就像设置标签一样。

表 9-2：视图控制器中输入的文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做 *日期选择器* 的控件。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，用于让用户选择日期或时间。它可以同时显示日期和时间，例如日历应用中使用的日期选择器（参见 图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，日期选择器用于选择日期。*

日期选择器还可以仅显示时间，例如在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这是我们在 BirthdayTracker 中将要使用的方式。

在对象库中滚动，直到找到一个日期选择器，然后将其点击并拖到视图控制器中的出生日期标签下方。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整一些日期选择器的属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示 **日期**，而不是日期和时间（参见 图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器显示当前日期。让我们将这个日期改为你的生日！将日期字段从“当前日期”更改为**自定义**。这样做后，会出现一个新框。将日期改为你的生日。

让我们通过运行应用来测试目前为止的效果！我们使用的输入控件大小非常适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你点击“生日”视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来非常棒，但其他设备呢？选择一个更小的模拟器来运行应用，比如 iPhone 5s，再次运行应用。你会看到界面有些不太对劲。

所有添加到故事板的元素都会显示出来，但文本字段超出了屏幕边缘。现在，既然所有元素都已经放置在屏幕上，下一步就是让它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 使用自动布局让你的应用在每个设备上看起来完美

单单 iPhone 就有三种不同的屏幕尺寸，未来可能还会有更多尺寸的设备。你需要设计你的应用，使它在任何设备上都能显示得很好。这意味着，你的应用需要调整界面上所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的技术来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的提纲视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标弹出自动布局菜单。*

在屏幕故事板面板的底部，有一个带图标的工具栏，在“实用工具”面板之前的最右侧图标是两个垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，上面写着“解决自动布局问题”。点击这个图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你执行此操作时，你会看到一大堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适应屏幕的宽度，不会超出边界。自动布局还会确保每个文本字段前后有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，添加生日的界面应该看起来很完美。

#### 添加保存和取消按钮

最后，我们将向你展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。按钮目前还没有任何功能，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消添加生日界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个 Bar Button Item，并将其放置在导航栏的 *右侧*。我们将把这个按钮改为保存按钮，就像我们之前为添加按钮做的那样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，并这次将其放置在导航栏的 *左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮做的那样。你的视图控制器应该像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新按钮的效果！

点击生日表视图控制器上的 + 按钮应该会将你带到添加生日视图控制器，在这里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前不会有任何反应——我们将在第十章中实现这两个功能！

### 你学到了什么

在这一章中，你开始制作生日追踪应用，创建了生日和添加生日界面的基本用户界面。你还使用表视图控制器创建了生日界面，并使用户能够通过添加按钮和导航控制器在不同界面之间切换。

现在你已经完成了应用的基本框架，接下来将在第十章中编写取消和保存按钮的代码，这样你就能在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项是禁用的。这是 Apple 的一个 bug。遇到这种情况时，选择 **重置为缺失约束** 选项以添加缺失的约束。

在 Xcode 菜单中，依次点击 **文件** ▸ **新建** ▸ **项目**。在对话框顶部选择 **iOS**，然后选择 **单一视图应用程序** 作为项目模板，接着点击 **下一步**。

在弹出的对话框中，Xcode 会要求你为你的新应用设置一些选项。由于这只是一个示例，你不需要太过认真对待这部分内容。当你编写一款计划在 App Store 上销售或分发的应用时，设置这些值会变得更加重要。将应用命名为**BirthdayTracker**，确保语言选择**Swift**，设备设置为**iPhone**，并勾选**使用 Core Data**。你的组织名称和组织标识符应该会自动填充为你在创建 Hello World 应用时输入的值（参见第一章）。

点击**下一步**。在弹出的对话框中，选择你要保存项目的位置，然后点击**创建**。你的 Xcode 项目应该会自动打开。花点时间确认在项目导航器中列出了一个名为*BirthdayTracker.xcdatamodeld*的文件（参见图 9-2）。

![Image](img/Image00197.jpg)

*图 9-2：确保在你的新项目中有一个* BirthdayTracker.xcdatamodeld *文件。*

你需要*BirthdayTracker.xcdatamodeld*来保存 iPhone 上的生日。如果缺少该文件，说明你在创建 Xcode 项目时没有勾选“使用 Core Data”选项。别担心——这很容易修复。

如果缺少*BirthdayTracker.xcdatamodeld*，请关闭项目（文件 ▸ 关闭项目），然后重新开始，创建一个新 Xcode 项目并勾选“使用 Core Data”选项。当系统询问是否要替换 BirthdayTracker 项目时，点击**替换**，这样就完成了！

你的新 BirthdayTracker Xcode 项目将会打开。如果你没有将你的 Apple 账户添加到 Xcode 中，你会在“常规”应用设置的签名部分看到一条消息，显示“未找到账户”。除非你希望在真实设备上运行应用，否则无需添加账户。（记住，你也可以在 Xcode 的模拟器上运行应用。）要将 Apple 账户添加到 Xcode 中，点击**添加账户**按钮。（关于如何添加 Apple 账户的详细说明，请参见《你的第一款应用！》第 5 页链接。）

这个常规设置界面也是你设置应用运行的设备方向的地方。我们希望 BirthdayTracker 应用仅在 *竖屏* 模式下运行。竖屏模式是手机的常规方向，主屏幕按钮在底部。*横屏* 模式是当你将手机横向放置时，屏幕也会旋转，使屏幕的宽度变为手机的高度，屏幕的高度变为手机的宽度。BirthdayTracker 应用在横屏模式下看起来不会很好，因此我们不希望屏幕在用户将手机横过来时改变。应用倒置显示是可以的，但如果屏幕在用户将手机翻转时自动翻转，且主屏幕按钮在顶部，那会让用户感到困惑，所以我们也不会支持倒置显示。在部署信息部分，在设备方向旁边，取消选中 **Landscape Left** 和 **Landscape Right** 旁的复选框，并确保 **Portrait** 是唯一勾选的框。

让我们来熟悉一下 Xcode。在左侧的导航面板中选择 *ViewController.swift*，你应该会看到类似图 9-3 的界面。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口结构*

左侧是导航面板 ➊ ，你可以通过选择 **视图** ▸ **导航器** ▸ **隐藏/显示导航器** 或按 ⌘ -0 来隐藏或显示它。你将使用导航器来选择并查看项目中的文件。

编辑器面板位于窗口的中央 ➋ 。这是你编写代码的地方！这里也是你可以更改应用设置，并使用你在第一章 中看到的故事板布局应用中显示的项目的地方。我们很快会详细介绍故事板。

右侧是实用工具面板 ➌ ，你可以通过选择 **视图** ▸ **实用工具** ▸ **隐藏/显示实用工具** 或按 ⌘ -OPTION -0 来隐藏或显示它。当故事板打开时，实用工具面板会让你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都有一种图标，它会显示在用户设备的主屏幕上。我们将通过添加一个应用图标来开始开发我们的 BirthdayTracker 应用。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图片。下载 ZIP 文件后，你会在 *下载* 文件夹中看到一个名为 *ch9-images* 的文件夹，里面包含了你需要的图片文件。获取这些文件后，从项目导航器中选择 *Assets.xcassets*。这将打开应用的 *资源目录*，你可以在这里放置应用要使用的任何 *资源*（图像、声音等），包括应用图标。实际上，资源目录已经带有一个占位符，你可以在这里添加图标。从目录左侧的菜单中选择 **AppIcon**，你应该能看到多个图像占位符。

要添加一个显示在 iPhone 主屏幕上的应用图标，你需要提供 2x 和 3x 图像，用于标签为 *iPhone 应用* 的图标集。2x 大小适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，使用 3x 大小的图像。你将在 第十四章 中学习更多关于不同屏幕分辨率的图像尺寸。

将图标添加到资产目录非常简单！下载提供的图像后，在 Finder 中打开 *下载* 文件夹。然后，只需将图像 *cake@2x.png* 拖动到 iPhone 应用 2x 框中，将 *cake@3x.png* 拖动到 3x 框中。当你完成后，你的资产目录应该像 图 9-4 一样。

![图片](img/Image00200.jpg)

*图 9-4：现在我们有了应用图标！*

除了应用图标，应用还有一个显示名称，它会显示在主页图标下方。默认情况下，显示名称就是应用的名称，BirthdayTracker。然而，这个名称有点长，无法完全显示在图标下方，所以让我们将其更改为一个较短的名称：Birthdays。为此，通过在项目导航器中选择 BirthdayTracker 项目，返回设置页面。在顶部的身份部分，你可以更改应用的显示名称。只需在显示名称文本框中输入 **Birthdays**。这将只更改显示在应用图标下方的名称，而项目的名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，接下来让我们创建应用的屏幕！

### 显示好友的生日

从项目导航器中选择 *Main.storyboard* 来调出故事板。在这里我们将设计应用的*用户界面*。用户界面是指用户将看到并用来与应用交互的内容——例如图片、文本、按钮等。*故事板* 让你以视觉方式组织应用的屏幕。我们将使用故事板来查看所有使用的屏幕以及它们之间的连接。

选择 *Main.storyboard* 后，按 ⌘ -0 隐藏导航面板，这样你就能获得更多的屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在看看工具面板的顶部。你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更仔细地查看故事板中元素的工具，并允许你更改这些元素的设置。当你选择其中一个检查器时，它会出现在工具面板中。

**检查故事板项**

图 9-5 显示了在打开故事板时，工具面板中出现的检查器选择栏的特写视图。

![图片](img/Image00201.jpg)

*图 9-5：在故事板的工具面板中，你可以使用六个检查器。*

让我们从左到右浏览这些检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书以及大多数应用中，你不会使用这个检查器。

下一个检查器，标识为问号图标，是快速帮助检查器。这个检查器将提供关于你当前在故事板中选择的项目的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里，你可以为故事板项目设置自定义类。

接下来的两个检查器是你在工作中最常用的检查器，我们将在文本中频繁提到它们。属性检查器的图标看起来像一个盾牌。这个检查器用于设置所选项目的各种属性。例如，它可以用来设置标签的文本、按钮的颜色，或者文本输入框周围显示的框类型。大小检查器，带有尺子图标，用于设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，它的图标看起来像一个圆圈中的箭头。可以用它将你的故事板中的项目与在类中编写的代码连接起来。我们将在第十章中展示如何做到这一点。

#### 添加表格视图控制器

我们的第一个视图控制器将是“生日”视图控制器。这将是一个特殊类型的视图控制器，显示一个列表，在 Xcode 中叫做*表格视图控制器*。在我们的应用中，表格视图控制器将显示你朋友的生日列表！现在它看起来只是一个空白屏幕，你将在“创建生日表格视图控制器”中学习如何显示生日数据，第 156 页会进一步介绍。

让我们向故事板中添加一个表格视图控制器。如果你先从故事板中缩小视图，使得视图控制器更清晰，这一步会更容易。双击故事板中视图控制器外的空白区域即可完成这个操作。现在你的屏幕应该已经缩小。

在实用工具面板的底部有一个区域，顶部有四个按钮。选择第三个按钮，它看起来像一个圆圈中的方形。这是对象库，你将在这里找到可以添加到故事板中的项目。浏览对象库列表，直到找到“表格视图控制器”，或者使用面板底部的筛选栏搜索“table view controller”。然后点击并拖动该对象到你的故事板上，放置在已有的视图控制器旁边。你的故事板应该像图 9-6 中的样子。

注意，当您添加表格视图控制器后，左侧大纲视图中会出现一个“表格视图控制器场景”条目，其中包含一个表格视图控制器。在您的故事板中，场景表示应用中的一个屏幕区域。对于 iPhone 应用，通常每次屏幕上只会显示一个场景，而且该场景会占据整个屏幕。而 iPad 应用则可以同时显示两个或多个场景。

![图片](img/Image00202.jpg)

*图 9-6：为生日屏幕向故事板添加表格视图控制器*

下一步是将这个新的视图控制器设置为在运行应用时首先出现的屏幕，因为我们希望用户打开应用时能够看到生日列表。完成此操作的步骤见图 9-7。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器并将其设为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后在工具窗格中调出属性检查器 ➋。在那里，勾选**是初始视图控制器** ➌。完成此操作后，表格视图控制器左侧应出现一条箭头。这条箭头意味着应用启动时将显示此视图控制器。

#### 添加导航控制器

现在，我们将为视图控制器添加一个名为“生日”的标题，并添加一个“添加”按钮来显示“添加生日”视图控制器。为此，我们首先将表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它自带一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧提供按钮，以便导航到应用中的其他屏幕。在许多 iOS 应用程序中，如设置应用和消息应用，您都会看到这个导航栏。

在大纲视图中选择**表格视图控制器**。选择后，您需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。前往**编辑** ▸ **嵌入到** ▸ **导航控制器**。

在将表格视图控制器嵌入导航控制器后，您的故事板应如下所示图 9-8。导航控制器将作为一个屏幕显示在故事板中。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

每个故事板中的视图控制器代表用户在应用中将看到的一个屏幕，而导航控制器则有所不同。尽管它在故事板中看起来像是一个独立的屏幕，但实际上导航控制器只是一个容器，用于容纳用户在应用中切换的其他视图控制器。将视图控制器嵌入导航控制器中，意味着您的应用可以在不同的视图之间进行导航并返回。

你应该能看到导航控制器和表格视图控制器顶部有灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们所在屏幕的标题，可能还会包含按钮和箭头，用户可以用来跳转到其他屏幕。为了使用导航栏告诉用户他们所在的屏幕，我们需要为我们的屏幕添加标题。现在是回到故事板上进行编辑的好时机。双击故事板中的空白处进行缩放，然后滚动视图，直到你能看到表格视图控制器。要为表格视图控制器添加标题，请点击左侧大纲视图中**表格视图控制器场景**下的**导航项**。

![图片](img/Image00205.jpg)

选择此项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。你应该会看到，在完成此步骤并按下回车键后，大纲视图中的“表格视图控制器场景”条目自动更新为“生日场景”。

接下来，我们将制作一个添加按钮，以便你可以添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并向列表中添加一个生日。让我们制作一个按钮，让他们能够做到这一点！

我们需要在导航栏中添加一个按钮，跳转到“添加生日”场景，以便用户输入生日。找到对象库中的条形按钮项，然后将其拖动并放置到表格视图控制器的导航栏右侧，如图 9-9 所示。

现在我们要将这个按钮改成一个添加按钮。幸运的是，Xcode 提供了一个内建的添加按钮，我们可以使用。在属性检查器中，将条形按钮项的系统项目更改为**添加**。你应该能看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在点击时该做什么。我们希望它能够打开“添加生日”视图控制器，因此需要将添加按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你能看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键并从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器高亮时松开鼠标。这时会弹出一个连接对话框，如图 9-10 所示。

![图片](img/Image00206.jpg)

*图 9-9：将条形按钮项拖动到生日视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态呈现”。*

连接对话框为你提供了几种选项，用于选择你想在两个视图控制器之间进行的 *segue*（从一个屏幕到下一个屏幕的过渡）。在连接对话框中点击 **Present Modally** 选项。这将使视图控制器作为 *模态* 视图控制器呈现在屏幕上。在 iPhone 上，模态视图控制器从手机底部弹出，并且不会自动带有返回按钮来返回到上一屏幕。相反，模态视图可以有其他按钮，如取消或保存。还有其他类型的 segue，例如 Show segue，其中视图控制器从右侧推出，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你呈现一个屏幕以获取和保存用户输入时，屏幕应该作为模态显示，并且有一个取消按钮。否则，如果你使用像 Show segue 这样的过渡并带有返回按钮，你可能会遇到用户输入所有内容后，点击返回按钮却没有保存任何内容的情况！有了取消按钮，用户必须有意识地点击才能取消退出屏幕。

要查看模态输入视图控制器的一个好例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，可以在关闭模态视图之前创建新事件。你应该能看到，新事件模态从屏幕底部弹出，在被关闭时又会返回到底部。我们希望用户保存生日，因此我们也将使用模态。

现在让我们尝试运行我们的应用，看看目前为止我们做了什么！要运行应用，首先选择一个设备模拟器，方法是点击 Xcode 左上角 BirthdayTracker 旁边列出的设备（见 图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，选择模拟器运行应用的设备。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用程序。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R**。

当模拟器打开以运行你的应用时，如果模拟器的尺寸太大无法适应你的计算机屏幕，你可以调整它的大小。点击模拟器以选中它，然后进入 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的比例。

到目前为止，运行应用时并没有发生太多变化。你应该能看到第一个生日页面，其中有一个+按钮，正如图 9-1 中所示。显然，此时你的生日页面将是空的。点击+按钮会弹出一个第二个空白页面。当你查看完应用后，可以通过点击 Xcode 中的停止按钮关闭应用，该按钮位于你之前点击的播放按钮旁边。停止应用后，你应该能在模拟器的主屏幕上看到你的应用图标！（参见图 9-12。）

就这样！我们现在需要配置第二个屏幕，使其可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：生日追踪器应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到一个独立的导航控制器中。当一个视图控制器是模态时，它不会继承我们在故事板上已经存在的导航控制器中的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击故事板中的视图控制器，选择它。然后转到**Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在你应该能看到在“视图控制器场景”下的轮廓视图中添加了一个导航项。点击这个新导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与当初为你的表格视图控制器添加标题“生日”时的操作相同。

现在，当“添加生日”视图控制器出现在应用中时，它的顶部将显示其标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用程序中的每一条记录将包含一个名字、一个姓氏和一个生日。让我们在“添加生日”视图控制器中添加一些*输入控件*，以便用户为每个人输入所有这些信息。输入控件是允许用户向应用程序中输入数据的元素，比如文本框或下拉菜单。我们将通过添加所有用户可以添加的信息的输入控件标签来开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个标签，标签内容为“名字”。这个标签将放置在一个文本框旁边，用户可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加一个标签。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在我们希望使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以 *点* 为单位进行测量。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点可以转换为 1 像素、2×2 像素的方块，或者 3×3 像素的方块。这三种缩放因子分别称为 @1x、@2x 和 @3x（我们在设置应用图标时提到的相同尺寸）。不同设备的点分辨率也不同，宽度范围从 320 到 1,024 点，高度范围从 568 到 1,366 点。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* 名字

只有最旧型号的 iPhone 和 iPod 使用 @1x 的缩放因子，并且你将无法在这些型号上运行你的应用程序（BirthdayTracker 只支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们大多使用 @2x 的缩放因子，而这三个型号使用的是 @3x 的缩放因子。

一个对象在屏幕上的位置也是基于点数来确定的。对象的 x 位置是从屏幕左侧到对象左侧的距离，以点为单位。y 位置是从屏幕顶部到对象顶部的距离。（见图 9-15。）我们将为每个添加到视图控制器的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，但仍然为其文本输入框和其他标签及输入框留出足够的空间。在“大小检查器”的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成此操作后，重复这些步骤，向添加生日视图控制器中添加另外两个标签：一个姓氏标签和一个出生日期标签。我们需要定位其他标签和输入框，以避免它们重叠。在某些情况下，这可能会变得复杂，并且可能需要一些时间。对于这个应用程序，我们已经为你计算好了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何使你的应用在其他设备上运行。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，这样它们就会垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置需要比下一个最近的标签大至少 21 个点。由于我们也在每个标签下方添加了输入控件，因此我们将 y 位置设置得更大，以适应标签和输入控件的高度。

太棒了！现在你的故事板应该看起来像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来你将添加两个*文本字段*，它们将允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段设置为表格 9-2 中所示的大小和位置。你可以使用大小检查器来完成这个设置，就像你为标签所做的那样。

表格 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个组件是一个叫做*日期选择器*的控件。它将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的标准工具，用于允许用户选择日期或时间。它可以同时包含日期和时间，像在日历应用中使用的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以只显示时间，像时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这也是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到视图控制器中的出生日期标签下方。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的一些属性。点击日期选择器进行选择。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。我们来把这个日期改为你的生日吧！将日期字段从当前日期更改为**自定义**。这样一个新框将会出现。将日期改为你的生日。

让我们通过运行应用来测试目前的效果！我们使用的输入控件的尺寸在 iPhone 7 屏幕上显示得很好。所以，选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你在“生日”视图控制器上点击 + 按钮时，“添加生日”屏幕应该会显示出来，正如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个更小的模拟器来运行应用，比如 iPhone 5s，然后重新运行应用。你会发现，一些地方显示得不太对劲。

你添加到故事板中的所有元素都显示出来了，但文本字段超出了屏幕的边缘。现在你已经将所有元素放在了屏幕上，下一步是让它们在任何屏幕尺寸上都能正确适配。我们将使用一个叫做*自动布局*的工具来完成这个任务。

#### 让你的应用在每个设备上都完美显示，使用自动布局

仅 iPhone 就有三种不同的屏幕尺寸，而且未来可能会有更多尺寸。你会希望设计的应用在任何设备上看起来都不错。这意味着你需要让你的应用调整所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的方式来安排屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接着，看看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部第四个图标，打开自动布局菜单。*

在屏幕故事板面板的底部有一条包含图标的带状栏，位于工具面板前的最右侧图标是两个垂直线之间的三角形。将鼠标光标悬停在这个图标上时，应该会显示一个标签，写着“解决自动布局问题”。点击这个图标，会弹出一组建议菜单。点击**添加缺失的约束**。^(*) 当你这么做时，你会看到在“添加生日”场景中添加了许多布局约束。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适应屏幕宽度，不会超出边界。自动布局还会确保每个文本字段前后有 20 个点的间距，使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这次，添加生日屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将展示如何为添加生日视图控制器的导航栏创建取消和保存按钮。按钮目前不会做任何事情，我们只是进行设置。在第十章中，我们将添加一些代码，使这些按钮可以取消添加生日屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像之前添加按钮那样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中再拖动一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其更改为取消按钮，就像之前做保存按钮那样。你的视图控制器应与图 9-21 中所示的样子相同。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行应用程序，查看新按钮的效果！

在生日表视图控制器上点击 + 按钮应该会带你进入添加生日视图控制器，在那里你可以输入一个人的名字和生日。点击取消和保存按钮目前不会有任何反应——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你通过创建生日和添加生日屏幕的基本用户界面，开始制作一个 BirthdayTracker 应用。你还使用表视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在不同屏幕之间导航。

现在你已经完成了应用程序的基本框架，第十章将指导你编写取消和保存按钮的代码，这样你就能在应用中添加和保存生日信息！

* 在某些版本的 Xcode 中，添加缺失约束的选项被禁用了。这是一个苹果的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

在弹出的对话框中，Xcode 会要求您为新应用设置一些选项。由于这只是一个示例，您不需要*太*认真对待这部分内容。当您编写计划在 App Store 销售或分发的应用时，设置这些值就显得尤为重要。将您的应用命名为**BirthdayTracker**，确保语言为**Swift**，设备设置为**iPhone**，并勾选**使用 Core Data**框。您的组织名称和组织标识符应该会自动填充为您在第一章中创建 Hello World 应用时输入的值。

点击**下一步**。在弹出的对话框中，选择您希望保存项目的位置，然后点击**创建**。您的 Xcode 项目应该会自动打开。花点时间确保在项目导航器中列出了名为*BirthdayTracker.xcdatamodeld*的文件（参见图 9-2）。

![Image](img/Image00197.jpg)

*图 9-2：确保您的新项目中有一个* BirthdayTracker.xcdatamodeld *文件。*

您需要*BirthdayTracker.xcdatamodeld*来在 iPhone 上保存生日。如果丢失了，说明您在创建 Xcode 项目时没有勾选“使用 Core Data”框。别担心——这个问题很容易解决。

如果您的*BirthdayTracker.xcdatamodeld*丢失，请关闭您的项目（文件 ▸ 关闭项目），并通过创建一个勾选了使用 Core Data 框的新 Xcode 项目重新开始。当系统询问您是否要替换 BirthdayTracker 项目时，只需点击**替换**，您就大功告成了！

您的新 BirthdayTracker Xcode 项目将会打开。如果您没有将 Apple 账户添加到 Xcode，您会看到在常规应用设置的签名部分出现一条“未找到账户”的消息。除非您希望在真实设备上运行应用，否则无需添加账户。（请记住，您也可以在 Xcode 的模拟器上运行应用。）要将 Apple 账户添加到 Xcode，请点击**添加账户**按钮。（有关添加 Apple 账户的详细说明，请参见《你的第一个应用！》，第 5 页。）

这个“常规设置”屏幕也是你设置应用运行时设备方向的地方。我们希望 BirthdayTracker 应用仅在*竖屏*模式下运行。竖屏模式是手机的常规方向，主屏幕按钮在底部。*横屏*模式是当你将手机横过来时，屏幕会旋转，屏幕的宽度变成手机的高度，屏幕的高度变成手机的宽度。BirthdayTracker 应用在横屏模式下看起来不太好，所以我们不希望用户将手机横过来时屏幕发生变化。倒立模式下应用看起来也不错，但如果用户将手机翻转，主屏幕按钮在顶部时屏幕翻转，可能会让用户感到迷惑，所以我们也不支持倒立模式。在“部署信息”部分，点击“设备方向”旁边，取消勾选**横屏左**和**横屏右**，确保只有**竖屏**被勾选。

让我们来看看 Xcode。选择左侧导航器面板中的*ViewController.swift*，你应该会看到类似图 9-3 的内容。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航器面板 ➊ ，你可以通过选择**视图** ▸ **导航器** ▸ **隐藏/显示导航器**或按下⌘ -0\来隐藏或显示。你将使用导航器来选择并查看项目中的文件。

编辑器面板位于窗口的中央 ➋ 。这里是你编写代码的地方！这里也是你可以更改应用设置并使用故事板布局显示在应用中的项目的地方，你在第一章中看到了故事板。我们稍后会详细讨论故事板。

右侧是工具面板 ➌ ，你可以通过选择**视图** ▸ **工具** ▸ **隐藏/显示工具**或按下⌘ -OPTION -0\来隐藏或显示。打开故事板时，工具面板将允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都会有一个图标，在用户设备的主屏幕上显示。我们将通过添加应用图标来开始创建我们的 BirthdayTracker 应用。你可以从*[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)*下载我们将用作图标的两个图像。下载 ZIP 文件后，你将在*Downloads*文件夹中得到一个名为*ch9-images*的文件夹，其中包含你所需的图像文件。一旦你拿到这些文件，选择项目导航器中的*Assets.xcassets*。这将打开应用的*资源目录*，你可以在这里添加应用要使用的任何*资源*（图像、声音等），包括应用图标。实际上，资源目录已经包含一个占位符，你可以在其中添加图标。从目录左侧的菜单中选择**AppIcon**，你应该会看到几个图像占位符。

要添加将在 iPhone 主屏幕上显示的应用图标，你需要提供标记为 *iPhone 应用* 的图标集的 2x 和 3x 图像。2x 尺寸适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，使用 3x 尺寸的图像。你将在第十四章中了解更多关于不同屏幕分辨率的图像尺寸。

将图标添加到资源目录非常简单！下载提供的图像后，在 Finder 中打开你的*下载*文件夹。然后，直接将图像 *cake@2x.png* 拖动到 iPhone 应用 2x 框中，将 *cake@3x.png* 拖动到 3x 框中。完成后，你的资源目录应如下所示：图 9-4。

![Image](img/Image00200.jpg)

*图 9-4：我们现在有了一个应用图标！*

除了应用图标，应用程序还有一个显示名称，它显示在主页图标下方。默认情况下，这个名称就是应用名称 BirthdayTracker。然而，这个名称稍微有点长，无法完全显示在图标下方，因此让我们将其更改为更短的名称：Birthdays。为此，请通过选择项目导航器中的 BirthdayTracker 项目，返回设置页面。在顶部的 Identity 部分，你可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这只会更改图标下方显示的名称，项目的名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，接下来让我们创建应用屏幕！

### 显示你朋友的生日

从项目导航器中选择 *Main.storyboard* 以打开故事板。这就是我们将设计应用*用户界面*的地方。用户界面就是用户将看到并用来与应用交互的东西——图像、文本、按钮等。*故事板* 让你可以直观地组织应用的屏幕。我们将使用故事板查看所有使用的屏幕以及它们之间的连接。

一旦你选择了 *Main.storyboard*，通过按 ⌘ -0 隐藏导航面板，这样可以腾出更多屏幕空间。你的故事板应该已经包含一个视图控制器。

现在，看看工具面板顶部。你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更仔细地查看故事板元素并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它将出现在工具面板中。

**检查故事板项**

图 9-5 显示了在打开故事板时出现在工具面板中的检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：在故事板的工具面板中，你可以使用六个检查器。*

让我们从左到右浏览这些检查器。页面图标打开文件检查器。这里可以更改故事板文件的设置。在本书和大多数应用程序中，你不会使用这个检查器。

下一个检查器，带有问号图标，是快速帮助检查器。这个检查器将提供你当前在故事板中选择的项目的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里你可以为故事板项设置自定义类。

接下来的两个检查器是你在使用故事板时最常用的两个，我们将在文本中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置选定项目的各种属性。它可以用于设置标签的文本、按钮的颜色，或者文本输入框周围显示的框的类型。例如。大小检查器的图标是一个尺子，用于设置每个故事板项的大小和屏幕位置。

最后是连接检查器，它的图标像一个圆圈中的箭头。这个检查器可以将你故事板中的项目连接到你在类中编写的代码。我们将在第十章中向你展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊类型的视图控制器，显示一个列表，在 Xcode 中被称为*表视图控制器*。在我们的应用中，表视图控制器将显示你朋友的生日列表！现在它看起来就像一个空白屏幕，你将在 “创建生日表视图控制器”（第 156 页）中学习如何显示生日数据。

让我们向故事板添加一个表视图控制器。如果你先将故事板缩小，这一步会更容易，这样你可以更好地看到视图控制器。双击视图控制器外的空白区域来进行缩小。现在你的屏幕应该是缩小的。

在实用工具面板的底部，有一个区域，顶部有四个按钮。选择第三个按钮，它看起来像是一个圆圈中的方块。这是对象库，你将在这里找到可以添加到故事板的项目。滚动浏览对象库列表，直到找到表视图控制器，或者使用面板底部的筛选栏搜索“table view controller”。然后点击并将该对象拖到故事板中，放到已经存在的视图控制器旁边。你的故事板应该像图 9-6 中的那样。

请注意，在你添加表格视图控制器后，左侧的大纲视图中会出现一个“表格视图控制器场景”条目，并且其中包含一个表格视图控制器。故事板中的场景代表你应用中的一个屏幕区域。对于 iPhone 应用，通常每次屏幕上只会显示一个场景，并且该场景会填满整个屏幕。而 iPad 应用则可以同时显示两个或更多的场景。

![图片](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到生日屏幕的故事板中*

下一步是让这个新视图控制器成为运行应用时首先出现的屏幕，因为我们希望用户打开应用时看到的是生日列表。完成此操作的步骤显示在图 9-7 中。

![图片](img/Image00203.jpg)

*图 9-7：在左侧的大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后在你的工具面板中调出属性检查器 ➋。在那里，勾选**是初始视图控制器** ➌。勾选后，故事板中表格视图控制器的左侧应该会出现一个箭头。这个箭头意味着应用在启动时会显示这个视图控制器。

#### 添加导航控制器

现在我们将为视图控制器添加一个标题“生日”和一个“添加”按钮，点击后会弹出“添加生日”视图控制器。为此，我们将首先把表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器，它自带一个*导航栏*，导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且可以在左右两侧显示按钮，用于导航到应用中的其他屏幕。你可以在多个 iOS 应用中看到这个栏位，例如“设置”应用和“信息”应用。

在大纲视图中选择**表格视图控制器**。选择后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。前往**编辑** ▸ **嵌入** ▸ **导航控制器**。

在表格视图控制器嵌入到导航控制器中之后，你的故事板应该类似于图 9-8 中的样子。导航控制器会作为一个屏幕出现在故事板中。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

每个视图控制器在故事板中代表应用中用户将看到的一个屏幕，但导航控制器略有不同。尽管它看起来像是故事板中的一个独立屏幕，但实际上，导航控制器只是一个容器，用来容纳用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中，意味着你的应用可以在一个视图和另一个视图之间进行导航，并且可以返回。

你应该会看到导航控制器和表视图控制器顶部有灰色的导航栏。当应用运行时，导航栏会告诉用户他们当前所在的屏幕标题，并可能包含按钮和箭头，用户可以使用它们跳转到其他屏幕。为了通过导航栏告知用户他们所在的屏幕，我们需要给屏幕加上标题。现在是时候重新缩放故事板了。双击故事板中的空白区域以缩小视图，然后滚动视图，使你能看到表视图控制器。要为表视图控制器添加标题，请点击大纲视图左侧“Table View Controller Scene”下的**Navigation Item**。

![图片](img/Image00205.jpg)

选择此项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的“Title”字段中输入**Birthdays**。你应该会看到，在完成此步骤并按下 RETURN 后，大纲视图中的“Table View Controller Scene”条目会自动更新为“Birthdays Scene”。

接下来，我们将制作一个“添加”按钮，让你能够添加生日！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将一个生日添加到列表中。让我们制作一个按钮，让他们可以这样做！

我们需要在导航栏中添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。在对象库中找到“Bar Button Item”，然后将其拖动到表视图控制器的导航栏右侧，如图 9-9 所示。

现在，我们想把这个按钮变成“添加”按钮。幸运的是，Xcode 内置了一个我们可以使用的“添加”按钮。在属性检查器中，将栏按钮项的系统项目更改为**Add**。你应该会看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮点击时该做什么。我们希望它打开“添加生日”视图控制器，因此需要将“添加”按钮与该视图控制器连接起来。首先，双击故事板以缩小视图，确保可以同时看到“生日”表视图控制器和最终会成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，将+按钮从左侧拖动到右侧故事板中的空视图控制器中央。当视图控制器被高亮显示时，松开鼠标。这时会弹出一个连接对话框，如图 9-10 所示。

![图片](img/Image00206.jpg)

*图 9-9：将“Bar Button Item”拖动到“生日”视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“Present Modally”。*

连接对话框提供了几种选项，供你选择在两个视图控制器之间进行的 *segue*（即从一个屏幕到下一个屏幕的过渡）类型。点击连接对话框中的 **模态展示** 选项。这会让视图控制器以 *模态* 视图控制器的形式展示在屏幕上。在 iPhone 上，模态视图控制器从屏幕底部进入，并且不会自动带有返回按钮来返回上一屏幕。相反，模态视图可以包含其他按钮，比如取消或保存。还有其他类型的 segue，比如 Show segue，其中视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用程序中，当你展示一个用于获取和保存用户输入的屏幕时，屏幕应该以模态方式显示，并带有一个取消按钮。否则，如果你使用类似 Show segue 的方式并且有一个返回按钮，可能会出现用户输入了所有内容后按下返回按钮却没有保存任何数据的情况！有了取消按钮，用户必须故意点击取消才能退出屏幕。

想要看到一个模态输入视图控制器的好例子，可以查看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下取消退出屏幕，右侧有一个添加按钮，可以在关闭模态视图之前创建新事件。你应该能看到，新事件模态视图是从屏幕底部进入的，当它被关闭时，它会返回到底部。我们希望用户保存生日，因此我们也将使用模态视图。

现在让我们尝试运行我们的应用程序，看看到目前为止我们做了什么！要运行应用程序，首先选择一个设备模拟器，方法是点击 Xcode 左上角的 BirthdayTracker 旁边列出的设备（见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角的应用程序名称旁设置模拟器运行的设备。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，供你选择用于运行应用程序的设备。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R**。

当模拟器打开并运行应用程序时，如果它的尺寸太大无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器以选择它，然后进入 **窗口** ▸ **缩放**，在模拟器菜单中选择一个更小的比例。

到目前为止，当你运行应用时，似乎没有太多变化。你应该能看到你的第一个“生日”界面，并且有一个 + 按钮，正如之前在图 9-1 中所示。显然，在这一点上，你的“生日”界面是空的。点击 + 按钮将会显示第二个空白界面。一旦你查看完应用，点击 Xcode 中停止按钮来关闭它，停止按钮在你之前点击的播放按钮旁边。当你停止应用时，你现在应该能在模拟器的主屏幕上看到你的应用图标！(见图 9-12。)

就是这样！现在我们需要配置第二个界面，使其能够用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12: 生日追踪器应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到一个独立的导航控制器中。当一个视图控制器是模态视图时，它不会继承我们故事板中已经存在的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器来选择它。然后转到**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该能看到一个新的导航项已添加到视图控制器场景下的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤和你当初为表视图控制器添加“生日”标题时是一样的。

现在，当“添加生日”视图控制器在应用中出现时，它的顶部将显示该视图控制器的标题。

#### 添加你朋友的名字和生日

当你在第十章中输入你朋友的生日时，每一条记录都将包含名字、姓氏和生日。让我们向“添加生日”视图控制器中添加一些*输入控件*，让用户为每个人输入所有这些信息。输入控件是像文本框或下拉菜单之类的东西，允许用户将数据输入到你的应用中。我们将首先为用户可以添加的所有信息添加输入控件标签。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个显示“名字”的标签。这个标签将放置在一个文本框旁边，用户将在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13: 在“添加生日”视图控制器中添加标签。*

接下来，更改标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在我们希望使用“大小检查器”设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以*点*为单位。请注意，1 个点并不等于 1 个像素。根据您的应用程序运行的设备类型，1 个点可以转换为 1 个像素、一个 2×2 像素的方块或一个 3×3 像素的方块。这三个缩放因子被称为@1x、@2x 和@3x（这些是我们在设置应用图标时讨论过的大小）。设备的点分辨率也不完全相同，宽度可以从 320 到 1,024 点不等，高度可以从 568 到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* 姓氏

只有最旧型号的 iPhone 和 iPod 使用@1x 缩放因子，并且您无法在这些型号上运行您的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非您的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们通常使用@2x 缩放因子，而 iPhone 6 Plus、6s Plus 或 7 Plus 使用@3x 缩放因子。

对象在屏幕上的位置也是基于点来衡量的。对象的 x 位置是屏幕左侧到对象左侧的点距离。y 位置是屏幕顶部到对象顶部的距离。（见图 9-15。）我们将为每个添加到视图控制器中的库对象设置 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置为既不在屏幕边缘，又能留出足够的空间给文本输入框和其他标签与输入框。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成此操作后，重复这些步骤，在“添加生日”视图控制器中再添加两个标签：一个是“姓氏”标签，另一个是“出生日期”标签。我们需要定位其他标签和输入框，确保它们不会重叠。在某些情况下，这可能会变得复杂，并且可能需要一些时间。对于这个应用程序，我们已经计算了适合放置对象的 iPhone 7 屏幕位置。稍后，我们将解释如何使您的应用适配其他设备。表 9-1 列出了每个标签应设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | x 位置 | y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，因此它们在垂直方向上对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个最接近的标签大至少 21 点。由于我们要在每个标签下方添加输入控件，因此我们将 y 位置设置得更大，以便容纳标签的高度和输入控件的高度。

太棒了！现在你的故事板应该像图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来你将添加两个*文本字段*，这将允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段设置为表 9-2 中显示的尺寸和位置。你可以使用尺寸检查器，正如你为标签所做的那样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个称为*日期选择器*的控件。它将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像日历应用中使用的日期选择器（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器进行日期选择。*

日期选择器也可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这就是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到一个日期选择器，然后点击并将它拖动到出生日期标签下方的视图控制器中。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整一些日期选择器的属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：修改日期选择器的设置。*

日期选择器默认设置为显示当前日期。我们来把这个日期改成你的生日吧！将日期字段从“当前日期”更改为**自定义**。当你这样做时，系统会出现一个新的框，修改日期为你的生日。

让我们通过运行应用来测试目前的效果！我们所使用的输入控件的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你点击“生日视图控制器”上的 + 按钮时，“添加生日”屏幕应该会显示出来，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

在 iPhone 7 上效果很好，但其他设备呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，然后重新运行应用。你会看到效果不太对劲。

所有添加到故事板中的元素都已经显示出来，但文本字段超出了屏幕边缘。现在，所有元素都已经出现在屏幕上，下一步是让它们在任何屏幕尺寸上都能正确适配。我们将使用一种名为*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上都看起来完美：使用自动布局

iPhone 单独就有三种不同的屏幕尺寸，而且未来可能会推出更多尺寸。你需要设计你的应用，使它在任何设备上都看起来很棒。这意味着你希望你的应用能够根据运行设备调整屏幕中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来安排屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部第四个图标来打开自动布局菜单。*

屏幕的故事板面板底部有一个带有图标的功能区，位于工具面板之前最右侧的图标是两个垂直线之间的一个三角形。将鼠标指针悬停在该图标上时，应该会显示一个标签，写着“解决自动布局问题”。点击该图标以弹出建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到一大堆布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适应屏幕宽度，并且不会超出边界。自动布局还确保每个文本字段前后有 20 个点的间距，以使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用。这次，“添加生日”页面应该看起来完美。

#### 添加保存和取消按钮

为了完成所有内容，我们将展示如何为“添加生日”视图控制器的导航栏添加“取消”和“保存”按钮。这些按钮暂时不会做任何事情，我们只是设置它们。在第十章中，我们将添加代码，使得它们可以退出“添加生日”页面并将生日保存到应用中。

要添加“保存”按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮改成“保存”按钮，就像我们之前做的那样。选择按钮项，然后使用属性检查器将其设置为“保存”按钮。

最后，让我们添加“取消”按钮。从对象库中拖动另一个“Bar Button Item”，这次将它放置在导航栏的*左侧*。使用属性检查器将它设置为“取消”按钮，就像你之前将“保存”按钮设置为一样。你的视图控制器应该和图 9-21 中所示的样子一样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新的按钮效果！

在“生日”表视图控制器中点击 + 按钮，应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击“取消”和“保存”按钮暂时没有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用，首先创建了“生日”和“添加生日”页面的基本用户界面。你还使用表视图控制器创建了“生日”页面，并使用户能够通过“添加”按钮和导航控制器在页面之间切换。

现在你已经完成了应用的基本框架，接下来将花费第十章的时间编程“取消”和“保存”按钮，这样你就可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项以添加缺失的约束。

点击**下一步**。在弹出的对话框中，选择你希望保存项目的位置并点击**创建**。你的 Xcode 项目应该会自动打开。花点时间确认在项目导航器中列出了一个名为*BirthdayTracker.xcdatamodeld*的文件（参见图 9-2）。

![Image](img/Image00197.jpg)

*图 9-2：确保在你的新项目中有一个*BirthdayTracker.xcdatamodeld*文件。*

你需要*BirthdayTracker.xcdatamodeld*来在 iPhone 上保存生日。如果它丢失，意味着你在创建 Xcode 项目时没有勾选“使用 Core Data”选项。别担心——这很容易解决。

如果你的*BirthdayTracker.xcdatamodeld*文件丢失，关闭你的项目（文件 ▸ 关闭项目），然后重新创建一个新的 Xcode 项目，并勾选使用 Core Data 选项。当系统询问是否要替换 BirthdayTracker 项目时，只需点击**替换**，一切就准备好了！

你的新 BirthdayTracker Xcode 项目将会打开。如果你还没有将你的 Apple 账户添加到 Xcode，你会在常规应用设置中的“签名”部分看到一条信息：“未找到帐户”。除非你想在真实设备上运行应用，否则你不需要添加帐户。（记住，你也可以在 Xcode 的模拟器上运行你的应用。）要将你的 Apple 账户添加到 Xcode，点击**添加帐户**按钮。（关于如何添加 Apple 账户的详细说明，请参见“你的第一个应用！”第 5 页。）

这个“常规”设置界面也是你设置应用程序运行时设备方向的地方。我们希望 BirthdayTracker 应用仅在*竖屏*模式下运行。竖屏模式是手机的常规方向，主屏按钮在底部。*横屏*模式是将手机横过来，屏幕也会旋转，使屏幕的宽度变为手机的高度，屏幕的高度变为手机的宽度。BirthdayTracker 应用在横屏模式下效果不好，所以我们不会让屏幕在用户将手机横过来的时候旋转。应用在倒立时看起来可以，但如果用户将手机转过来，主屏按钮在顶部时，屏幕翻转可能会让人迷失方向，所以我们也不会支持倒立模式。在“部署信息”部分，在设备方向旁，取消勾选**左横屏**和**右横屏**，确保只有**竖屏**框被勾选。

让我们看看 Xcode。选择左侧导航窗格中的*ViewController.swift*，你应该能看到类似于图 9-3 的内容。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航面板 ➊ ，你可以通过点击 **视图** ▸ **导航器** ▸ **隐藏/显示导航器** 或按下 ⌘ -0 来隐藏或显示该面板。你将使用导航器来选择和查看项目中的文件。

编辑器面板位于窗口的中央 ➋ 。这里是你编写代码的地方！这里也是你可以改变应用设置并使用故事板布局将在应用中显示的项目的地方，你在 第一章 中见过它。我们很快会进一步讨论故事板。

右侧是工具面板 ➌ ，你可以通过选择 **视图** ▸ **工具** ▸ **隐藏/显示工具** 或按下 ⌘ -OPTION -0 来隐藏或显示该面板。当故事板打开时，工具面板将允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都带有一种图标，显示在用户设备的主屏幕上。我们将通过添加一个应用图标来开始我们的 BirthdayTracker 应用。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图片。下载 ZIP 文件后，你会在 *下载* 文件夹中找到一个名为 *ch9-images* 的文件夹，其中包含所需的图像文件。获取这些文件后，在项目导航器中选择 *Assets.xcassets*。这将打开应用的 *资产目录*，你将在其中添加任何应用使用的 *资产*（图像、声音等），包括应用图标。事实上，资产目录中已经有一个占位符，你可以在其中添加图标。从目录左侧的菜单中选择 **AppIcon**，你应该能看到几个图像占位符。

要添加一个会显示在 iPhone 主屏幕上的应用图标，你需要提供 2x 和 3x 尺寸的图标图片集，标记为 *iPhone App*。2x 尺寸适用于大多数 iPhone，如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸的图像。你将在 第十四章 中了解更多关于不同屏幕分辨率的图片尺寸。

将图标添加到资产目录很简单！下载提供的图像后，打开 Finder 中的 *下载* 文件夹。然后，只需将图像 *cake@2x.png* 拖到 iPhone App 2x 框中，将 *cake@3x.png* 拖到 3x 框中。完成后，资产目录应如下所示：图 9-4。

![图片](img/Image00200.jpg)

*图 9-4：我们现在有了一个应用图标！*

除了应用程序图标外，应用程序还有一个显示名称，该名称会显示在主页上的图标下方。默认情况下，这个名称就是应用程序的名称：BirthdayTracker。然而，这个名称有点太长，无法完全显示在应用程序图标下方，所以我们将其更改为一个较短的名称：Birthdays。要做到这一点，请通过在项目导航器中选择 BirthdayTracker 项目返回设置页面。在顶部的身份部分，你可以更改应用程序的显示名称。只需在显示名称文本字段中输入**Birthdays**。这将只更改显示在应用程序图标下方的名称。你的项目名称仍将是 BirthdayTracker。

现在我们已经设置了应用程序图标和显示名称，接下来让我们创建应用程序屏幕！

### 显示朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。这是我们将设计应用程序*用户界面*的地方。用户界面只是用户将看到并用来与应用程序交互的元素的统称——图片、文本、按钮等。*故事板*允许你以可视化方式组织应用程序的各个屏幕。我们将使用故事板查看所有使用的屏幕及其之间的连接。

一旦选择了*Main.storyboard*，通过按⌘-0 隐藏导航窗格，以便获得更多的屏幕空间。你的故事板应该已经包含一个视图控制器。

现在查看工具窗格顶部。你应该看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更详细查看故事板中元素的工具，并允许你更改这些元素的设置。当你选择其中一个检查器时，它会出现在工具窗格中。

**检查故事板项目**

图 9-5 显示了打开故事板时，工具窗格中出现的检查器选择条的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：在故事板的工具窗格中，你可以使用六个检查器。*

让我们从左到右浏览这些检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书中以及你的大多数应用程序中，你不太会使用这个检查器。

下一个检查器，由问号图标表示，是快速帮助检查器。此检查器将提供关于你当前在故事板中选择的项目的详细类信息。

第三个检查器，带有 ID 卡图标的是身份检查器。在这里，你可以为故事板项目设置自定义类。

下两个检查器是你在工作时最常用的检查器，我们将在本文中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置在故事板中选定项的各种属性。例如，它可以用来设置标签的文本、按钮的颜色，或文本输入框周围显示的框类型。大小检查器则有一个像尺子的图标，用来设置每个故事板项的大小和屏幕位置。

最后，还有连接检查器，它的图标像一个圆圈中的箭头。这个检查器可以用来将故事板中的项与你在类中编写的代码连接起来。我们将在第十章中向你展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是“生日”视图控制器。这将是一个特殊的视图控制器类，用于显示一个列表，在 Xcode 中称为*表视图控制器*。在我们的应用中，表视图控制器将显示你的朋友们的生日列表！现在它看起来只是一个空屏幕，你将在“创建生日表视图控制器”（第 156 页）中学会如何显示生日数据。

让我们将表视图控制器添加到故事板中。如果你先从故事板缩小，这一步会更容易，这样你就能更好地看到视图控制器。双击视图控制器外的空白区域即可进行缩放。现在，你的屏幕应该已经缩小。

在工具窗格的底部，有一个包含四个按钮的区域。选择第三个按钮，它看起来像一个圆圈中的正方形。这是对象库，你将在这里找到要添加到故事板中的项。向下滚动对象库列表，直到找到“表视图控制器”，或者使用窗格底部的筛选栏搜索“table view controller”。然后点击并拖动该对象到你的故事板上。将它放在已经存在的视图控制器旁边。你的故事板应该像图 9-6 中的样子。

请注意，在你添加表视图控制器后，左侧大纲视图中会出现一个“表视图控制器场景”条目，其中包含一个表视图控制器。故事板中的一个场景代表你的应用中的一个屏幕区域。对于 iPhone 应用，通常屏幕上一次只会显示一个场景，并且该场景会填满整个屏幕。而 iPad 应用可以在屏幕上同时显示两个或更多场景。

![图像](img/Image00202.jpg)

*图 9-6：将表视图控制器添加到生日屏幕的故事板中*

下一步是将这个新视图控制器设置为应用启动时显示的第一个屏幕，因为我们希望用户打开应用时看到生日列表。执行这些步骤的方法见图 9-7。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图 ➊ 中选择**表格视图控制器**。然后在你的工具窗格中打开属性检查器 ➋ 。在这里，勾选**是初始视图控制器** ➌ 。完成此操作后，你的表格视图控制器左侧应该会出现一个箭头，表示应用启动时会显示这个视图控制器。

#### 添加导航控制器

接下来，我们将为视图控制器添加一个标题“生日”以及一个“添加”按钮，用来打开添加生日的视图控制器。为此，我们首先将表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它配有一个*导航栏*，这个导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧有按钮，用于导航到应用中的其他屏幕。你可以在许多 iOS 应用中看到这个导航栏，比如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。选择后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。前往**编辑** ▸ **嵌入到** ▸ **导航控制器**。

当表格视图控制器嵌入到导航控制器中后，你的故事板应该像图 9-8 中的那样。导航控制器将在故事板中作为一个屏幕出现。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

每个故事板中的视图控制器代表用户在应用中看到的一个屏幕，但导航控制器有所不同。尽管它看起来像是故事板中的一个独立屏幕，实际上导航控制器只是一个容器，用来存放用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在不同视图之间导航。

你应该在导航控制器和表视图控制器的顶部看到灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们所在屏幕的标题，并可能包含按钮和箭头，用户可以通过这些按钮和箭头跳转到其他屏幕。为了利用导航栏告诉用户当前屏幕的信息，我们需要为屏幕设置标题。现在是回到故事板的好时机。双击故事板的空白区域进行放大，然后滚动视图，直到你可以看到表视图控制器。要为表视图控制器添加标题，在左侧大纲视图中的**表视图控制器场景**下，点击**导航项**。

![Image](img/Image00205.jpg)

选中该项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，所以在右侧的标题字段中输入**生日**。你应该看到在完成此步骤并按下 RETURN 后，大纲视图中的表视图控制器场景条目会自动更新为“生日场景”。

接下来，我们将创建一个“添加”按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并向列表中添加一个生日。让我们做一个按钮，让他们可以这样做！

我们需要在导航栏上添加一个按钮，用于跳转到“添加生日”场景，这样用户就可以输入生日了。在对象库中找到“条形按钮项”，然后将它拖动并放置到表视图控制器导航栏的右侧，如图 9-9 所示。

现在我们要将这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮可以使用。在属性检查器中，将条形按钮项的系统项目更改为**添加**。你应该看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮点击时应该做什么。我们希望它打开“添加生日”视图控制器，所以我们需要将“添加”按钮与那个视图控制器连接起来。首先，双击故事板进行缩小，确保你能看到“生日”表视图控制器和将来成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，然后从加号按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器高亮显示时松开鼠标，这时会弹出一个连接对话框，像图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个条形按钮项拖到生日视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态展示”。*

连接对话框提供了多个选项，供你选择在两个视图控制器之间进行的*segue*——即从一个屏幕到下一个屏幕的过渡方式。点击连接对话框中的 **以模态方式呈现** 选项。这将使视图控制器以*模态*方式呈现到屏幕上。在 iPhone 上，模态视图控制器从屏幕底部滑入，而且它不会自动带有返回按钮来返回到上一个页面。相反，模态框可以有其他按钮，比如取消或保存。还有其他类型的 segue，比如 Show segue，视图控制器从屏幕右侧推出，并且会有一个在导航栏左侧的返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的页面时，该页面应该作为模态框显示，并带有一个取消按钮。否则，如果你使用像 Show segue 这样的页面跳转，并带有返回按钮，可能会出现用户输入了所有信息后，点击返回按钮却没有保存任何内容的情况！有了取消按钮，用户必须故意点击才能退出该页面。

想要看到一个良好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧会有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮后会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出页面，右侧有一个添加按钮，可以在关闭模态页面之前创建新事件。你应该会看到新的事件模态从屏幕底部出现，当它被关闭时又会向下消失。我们希望用户保存生日信息，因此我们也会使用模态框。

现在让我们试着运行我们的应用，看看我们到目前为止做了什么！首先，在 Xcode 左上角的 BirthdayTracker 旁边选择一个设备模拟器（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角你应用名称旁边设置模拟器运行的设备。这里设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用程序。我们选择的是 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果模拟器的大小过大无法适应电脑屏幕，你可以调整它的大小。点击模拟器以选择它，然后前往 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用程序时并没有发生太多变化。你应该能看到你的第一个“生日”屏幕，屏幕上有一个“+”按钮，如前面在图 9-1 所示。显然，在这一点上，你的“生日”屏幕将是空的。点击“+”按钮将会弹出第二个空白屏幕。一旦你看完应用程序，关闭它，只需点击 Xcode 中停止按钮（它在你之前点击的播放按钮旁边）。当你停止应用程序时，你应该能在模拟器的主屏幕上看到应用图标！(参见图 9-12)。

就是这样！现在我们需要配置第二个屏幕，以便可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，通过添加它的标题。为此，你需要将它嵌入到自己的导航控制器中。当一个视图控制器是模态时，它不会继承我们故事板上已经存在的导航控制器的导航栏。导航控制器提供导航栏，所以我们需要将模态视图控制器嵌入到自己的导航控制器中。在故事板中点击视图控制器以选择它，然后转到**Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在你应该能看到一个新的导航项已被添加到“视图控制器场景”的轮廓视图中。点击这个新的导航项，然后在“属性检查器”中添加标题**Add a Birthday**（添加生日）。这些步骤和你在为表视图控制器添加标题“Birthdays”时是一样的。

现在，当“添加生日”视图控制器出现在应用中时，它将会在顶部显示其标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每一条记录将包括名字、姓氏和出生日期。我们来为“添加生日”视图控制器添加一些*输入控件*，让用户可以输入每个人的所有信息。输入控件就是像文本框或下拉菜单这样的控件，它们允许用户向应用中输入数据。我们将从添加所有用户可以填写的输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“First Name”（名字）的标签。这个标签将放在一个文本框旁边，用户可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器中。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**（名字）作为显示文本，如图 9-14 所示。

现在，我们希望使用尺寸检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以*点*为单位进行测量。请注意，1 个点并不等于 1 个像素。根据你的应用运行的设备类型，1 个点可能转换为 1 个像素、一个 2×2 像素的正方形，或一个 3×3 像素的正方形。这三个缩放因子被称为@1x、@2x 和@3x（我们在设置应用图标时提到过的相同尺寸）。设备的点分辨率也不同，可能从 320 点宽到 1,024 点宽，从 568 点高到 1,366 点高。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* 姓名

只有最早的 iPhone 和 iPod 型号使用@1x 缩放因子，你将无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10 及更高版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则很可能它们使用的是@2x 缩放因子，这些设备使用的是@3x 缩放因子。

对象在屏幕上的位置也以点为单位。对象的 x 位置是从屏幕左侧到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15。）我们将设置每个我们添加到视图控制器的库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置为不靠近屏幕边缘，但仍然为其文本输入字段和其他标签及输入框留出足够的空间。在“尺寸检查器”的“视图”部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成这些操作后，重复这些步骤，为“添加生日”视图控制器添加两个标签：一个“姓氏”标签和一个“出生日期”标签。我们需要调整其他标签和输入框的位置，确保它们不会重叠。在某些情况下，这可能会变得复杂，并且可能需要一些时间。对于这个应用程序，我们已经为你计算了可以放置对象的 iPhone 7 屏幕位置。稍后我们将解释如何使你的应用在其他设备上运行。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有的标签具有相同的 x 位置，这样它们就能垂直对齐，但它们每个都有不同的 y 位置。每个标签的高度为 21，因此 y 位置需要比下一个最接近的标签高出至少 21 个点。由于我们也在每个标签下方添加了输入控件，所以我们将 y 位置设置得更大，以适应标签和输入控件的高度。

很好！现在你的故事板应该和图 9-16 中的样子一样。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已被添加到视图控制器。*

接下来，你将添加两个*文本字段*，用于输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器。一个用于输入名字，另一个用于输入姓氏。为这两个文本字段设置表格 9-2 中显示的大小和位置。你可以使用大小检查器，就像为标签做的那样。

表格 9-2：视图控制器中的文本字段输入

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后，你需要添加一个称为*日期选择器*的控件。这将使你能够轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用程序中用于让用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中使用的日期选择器一样（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中将要使用的。

滚动浏览对象库，直到找到日期选择器，然后点击并将其拖动到视图控制器的出生日期标签下方。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将日期改成你的生日吧！将“日期”字段从“当前日期”改为**自定义**。这样会出现一个新的框框，将日期更改为你的生日。

让我们通过运行应用来测试一下目前的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上显示得非常合适。所以，选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你在“生日”视图控制器中点击 + 按钮时，应该会显示“添加生日”界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上显示得非常合适。*

![Image](img/Image00218.jpg)

这个在 iPhone 7 上看起来很不错，但其他设备怎么样呢？选择一个更小的模拟器来运行应用，例如 iPhone 5s，并再次运行应用。你会看到，一些东西看起来不太对劲。

你添加到故事板中的所有元素都会显示出来，但文本字段已经超出了屏幕的边缘。现在，既然所有的元素都已显示在屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确显示。我们将使用一个名为*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上看起来完美：自动布局

单独的 iPhone 就有三种不同的屏幕尺寸，未来可能还会有更多尺寸出现。你需要设计你的应用程序，以确保它们在任何设备上看起来都很合适。这意味着，你需要让你的应用能够根据所运行的设备自动调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部第四个图标，弹出自动布局菜单。*

屏幕故事板面板的底部有一排图标，在实用工具面板之前的最右侧图标是一个位于两条竖直线之间的三角形。将鼠标光标悬停在该图标上时，会显示一个标签，写着“解决自动布局问题”。点击此图标，以显示一个建议菜单。点击**添加缺失的约束**。^(*) 当你这么做时，你会看到一堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局使得日期选择器的大小适应屏幕宽度，并且不会超出屏幕边缘。自动布局还会确保每个文本字段的前后都有 20 个点的间距，使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用。这次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这一步，我们将展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。按钮目前不会做任何事情——我们只是设置它们。在第十章中，我们将添加代码，使它们可以取消“添加生日”屏幕并将生日保存到应用中。

要添加“保存”按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右*侧。我们将把这个按钮改成一个保存按钮，就像我们做的“添加”按钮一样。选择按钮项，然后使用属性检查器将其转变为“保存”按钮。

最后，让我们添加取消按钮。从对象库中再拖动一个“Bar Button Item”，这次将它放置在导航栏的*左*侧。使用属性检查器将其转换为取消按钮，就像你之前做的保存按钮一样。你的视图控制器应该像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新的按钮！

点击“生日”表视图控制器上的+按钮应该会将你带到“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击“取消”和“保存”按钮目前还没有任何反应——我们将在第十章中实现这两个功能！

### 你学到的内容

在本章中，你通过创建“生日”和“添加生日”屏幕的基本用户界面，开始制作一个生日追踪器应用。你还使用表视图控制器创建了“生日”屏幕，并使用户可以通过“添加”按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本框架，接下来你将在第十章中编程实现“取消”和“保存”按钮，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。![Image](img/Image00197.jpg)

*图 9-2：确保在你的新项目中有一个* BirthdayTracker.xcdatamodeld *文件。*

您需要*BirthdayTracker.xcdatamodeld*来在 iPhone 上保存生日。如果它缺失，说明您在创建 Xcode 项目时没有勾选使用 Core Data 选项。别担心—这非常容易修复。  

如果您的*BirthdayTracker.xcdatamodeld*缺失，关闭您的项目（文件 ▸ 关闭项目），并通过创建一个勾选了使用 Core Data 的新 Xcode 项目重新开始。当系统询问是否要替换 BirthdayTracker 项目时，只需点击**替换**，然后一切就绪！  

您的新生日追踪器 Xcode 项目将会打开。如果您还没有将您的 Apple 账户添加到 Xcode，您会看到在常规应用设置的签名部分出现“未找到账户”消息。除非您想在真实设备上运行应用，否则不需要添加账户。（请记住，您也可以在 Xcode 的模拟器上运行应用。）要将您的 Apple 账户添加到 Xcode，请点击**添加账户**按钮。（有关添加 Apple 账户的详细说明，请参阅《你的第一个应用！》，见第 5 页）。  

此常规设置屏幕也是您设置应用运行设备方向的地方。我们希望 BirthdayTracker 应用仅在*竖屏*模式下运行。竖屏模式是手机的常规方向，主屏按钮在底部。*横屏*模式是将手机横着转动，屏幕也会旋转，使得屏幕的宽度变为手机的高度，屏幕的高度变为手机的宽度。BirthdayTracker 应用在横屏模式下看起来不太好，因此我们不会在用户横向转动手机时让屏幕发生变化。应用倒过来是可以正常显示的，但如果用户将手机翻转，并且屏幕旋转了，可能会让用户感到困惑，因此我们也不会支持倒屏模式。在部署信息部分，在设备方向旁边，取消选中**左横屏**和**右横屏**，确保只有**竖屏**被选中。  

让我们环顾一下 Xcode。选择左侧导航器面板中的*ViewController.swift*，您应该会看到类似于图 9-3 的界面。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)  

*图 9-3：Xcode 项目窗口的结构*  

在左侧是导航器面板 ➊ ，您可以通过进入**视图** ▸ **导航器** ▸ **隐藏/显示导航器**，或者按 ⌘ -0 来隐藏或显示该面板。您将使用导航器来选择和查看项目中的文件。  

编辑器面板位于窗口中央 ➋ 。这是您将编写代码的地方！这里也是您可以更改应用设置并使用 storyboard 布局展示应用中显示的项目的地方，您在第一章中已看到过 storyboard。我们稍后会详细讨论 storyboard。  

右侧是工具面板 ➌，你可以通过选择 **View** ▸ **Utilities** ▸ **Hide/Show Utilities** 或按下 ⌘ -OPTION -0 来隐藏或显示它。当打开 storyboard 时，工具面板可以帮助你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都有一个图标，显示在用户设备的主屏幕上。我们将从添加应用图标开始我们的 BirthdayTracker 应用。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图片。下载 ZIP 文件后，你将在 *Downloads* 文件夹中得到一个名为 *ch9-images* 的文件夹，其中包含所需的图像文件。获得这些文件后，在项目导航器中选择 *Assets.xcassets*。这将打开应用的 *资源目录*，这里是你放置应用将要使用的任何 *资源*（如图像、声音等）的位置，包括应用图标。实际上，资源目录已经提供了一个占位符，你可以在其中添加图标。从目录左侧的菜单中选择 **AppIcon**，你应该能看到几个图像的占位符。

要添加一个在 iPhone 主屏幕上显示的应用图标，你需要为标记为 *iPhone App* 的图标集提供 2x 和 3x 图像。2x 大小适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 大小的图像。你将在 第十四章 中学习如何为不同屏幕分辨率调整图像大小。

将图标添加到资源目录非常简单！下载提供的图像后，打开 Finder 中的 *Downloads* 文件夹。然后只需将图像 *cake@2x.png* 拖动到 iPhone 应用 2x 框中，将 *cake@3x.png* 拖动到 3x 框中。完成后，你的资源目录应该像 图 9-4 一样。

![Image](img/Image00200.jpg)

*图 9-4：我们现在有了一个应用图标！*

除了应用图标外，应用还会有一个显示名称，它会显示在主屏幕上的图标下方。默认情况下，这个显示名称就是应用名称 BirthdayTracker。然而，这个名称稍微有点长，无法完全显示在图标下方，所以我们将其更改为更简短的名称：Birthdays。为此，在项目导航器中选择 BirthdayTracker 项目，返回设置页面。在顶部的 Identity 部分，你可以更改应用的显示名称。只需在 Display Name 文本框中输入 **Birthdays**。这只会更改显示在应用图标下方的名称，项目的名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，接下来让我们创建应用屏幕吧！

### 显示朋友的生日

从项目导航器中选择*Main.storyboard*来打开故事板。这是我们将设计应用程序的*用户界面*的地方。用户界面只是用户将看到并用来与应用程序交互的东西——例如图像、文本、按钮等。*故事板*让你可视化地组织应用程序的屏幕。我们将使用故事板查看所有使用的屏幕及其之间的连接。

选择*Main.storyboard*后，通过按下⌘-0 隐藏导航面板，以便为屏幕腾出更多空间。你的故事板应该已经包含一个视图控制器。

现在看看实用工具面板顶部。你应该看到一个带有六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更详细地查看故事板中元素的工具，同时允许你更改这些元素的设置。当你选择一个检查器时，它会出现在实用工具面板中。

**检查故事板项**

图 9-5 显示了故事板打开时，实用工具面板中出现的检查器选择栏的特写图。

![图片](img/Image00201.jpg)

*图 9-5：在故事板的实用工具面板中，你可以使用六个检查器。*

让我们从左到右依次了解这些检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书和大多数应用程序中，你不会使用这个检查器。

下一个检查器，通过一个问号图标表示，是快速帮助检查器。此检查器会为你提供当前在故事板中选中的项的详细类信息。

第三个检查器，带有身份证图标的是身份检查器。在这里，你可以为故事板项设置自定义类。

接下来的两个检查器是你在故事板中工作时最常用的检查器，我们将在文本中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置选中项的各种属性，比如设置标签的文本、按钮的颜色或文本输入框周围的框类型等。尺寸检查器，带有尺子图标，用于设置每个故事板项的大小和屏幕位置。

最后是连接检查器，图标像一个箭头圈。这个检查器可以将故事板中的项与类中你编写的代码片段连接起来。我们将在第十章中展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊的视图控制器类，用于显示一个列表，在 Xcode 中称为*表视图控制器*。在我们的应用中，表视图控制器将显示你的朋友们的生日！目前它看起来只是一个空白屏幕，后续你将在“创建生日表视图控制器”中学习如何显示生日数据，参见第 156 页。

让我们向故事板添加一个表视图控制器。为了更容易完成此步骤，建议先缩小故事板视图，以便更清楚地看到视图控制器。双击故事板中视图控制器外的空白区域来实现这一点。现在你的屏幕应该已经缩小了。

在工具面板底部有一个带四个按钮的区域。选择第三个按钮，它看起来像一个圆圈中的正方形。这是对象库，你可以在这里找到添加到故事板的项目。浏览对象库列表，直到找到表视图控制器，或者使用面板底部的筛选栏搜索“table view controller”。然后点击并将该对象拖动到你的故事板中，放置在已有视图控制器旁边。你的故事板应该看起来像图 9-6 中的样子。

注意，在你添加表视图控制器后，左侧的大纲视图中会出现一个表视图控制器场景条目，里面包含一个表视图控制器。你的故事板中的场景代表了应用程序中屏幕上的一个区域。对于 iPhone 应用程序，通常一次屏幕上只会显示一个场景，且该场景会填满整个屏幕。iPad 应用程序可以同时显示两个或多个场景。

![Image](img/Image00202.jpg)

*图 9-6：为生日屏幕向故事板添加表视图控制器*

下一步是将这个新视图控制器设为应用运行时第一个显示的屏幕，因为我们希望在用户打开应用时显示生日列表。执行此操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧的大纲视图中选择表视图控制器并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表视图控制器** ➊。然后在工具面板中打开属性检查器 ➋。在那里，勾选**是初始视图控制器** ➌。完成后，你会在故事板中看到表视图控制器左侧出现一个箭头。这个箭头表示应用启动时会显示这个视图控制器。

#### 添加导航控制器

现在，我们将向视图控制器添加一个标题，显示“生日”，以及一个“添加”按钮，点击后会弹出“添加生日”视图控制器。为此，我们将首先把表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器，并附带一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且可以在左右两侧显示按钮，用于导航到应用中的其他屏幕。你在多个 iOS 应用中都能看到这个栏，例如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。选择后，你需要使用 Xcode 菜单将表格视图控制器嵌入到导航控制器中。依次点击**编辑** ▸ **嵌入** ▸ **导航控制器**。

当表格视图控制器嵌入到导航控制器中后，你的故事板应该看起来像图 9-8 中的那样。导航控制器会作为一个屏幕出现在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器都代表用户将在应用中看到的一个屏幕，但导航控制器有些不同。尽管它在故事板中看起来像是一个独立的屏幕，导航控制器实际上只是一个容器，容纳着用户在应用中切换的其他视图控制器。将视图控制器嵌套在导航控制器中意味着你的应用可以在不同的视图之间导航。

你应该能看到导航控制器和表格视图控制器顶部的灰色导航栏。当应用运行时，导航栏会告诉用户他们所处的屏幕标题，并可能包含按钮和箭头，用户可以用来跳转到其他屏幕。为了使用导航栏告诉用户当前屏幕的标题，我们需要给我们的屏幕加上标题。现在是时候放大故事板视图了。双击故事板的空白处以放大，然后滚动视图，直到可以看到表格视图控制器。为了给表格视图控制器添加标题，点击左侧大纲视图中**表格视图控制器场景**下的**导航项**。

![Image](img/Image00205.jpg)

选择此项后，你可以在右侧的属性检查器中输入屏幕的标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。你应该能看到，在完成此步骤并按下 RETURN 后，大纲视图中的表格视图控制器场景条目会自动更新为“生日场景”。

接下来，我们将制作一个“添加”按钮，让你可以添加生日！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将生日添加到列表中。让我们制作一个按钮，让他们能够做到这一点！

我们需要在导航栏上添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。找到对象库中的“Bar Button Item”，然后将它拖放到表格视图控制器的导航栏右侧，像图 9-9 中所示的那样。

现在我们要将这个按钮变成一个“添加”按钮。幸运的是，Xcode 有一个内置的“添加”按钮可以使用。在属性检查器中，将“Bar Button Item”的系统项更改为**Add**。你应该看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在被点击时应该执行什么操作。我们希望它打开“添加生日”视图控制器，因此需要将“添加”按钮连接到该视图控制器。首先，双击故事板进行缩小，确保你可以看到“生日表格视图控制器”和将最终成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，并从“+”按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器高亮显示时松开鼠标，这将弹出一个连接对话框，像图 9-10 中所示的那样。

![Image](img/Image00206.jpg)

*图 9-9：将“Bar Button Item”拖到生日视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“Present Modally”。*

连接对话框为你提供了几种不同类型的*segue*选项——即从一个屏幕过渡到另一个屏幕的方式。点击连接对话框中的**Present Modally**选项。这将使视图控制器以*模态*的形式展示在屏幕上。在 iPhone 上，模态视图控制器会从屏幕底部出现，并且默认没有返回按钮用于返回到上一个屏幕。相反，模态视图可以有其他按钮，比如取消或保存。还有其他类型的 segue，比如 Show segue，它将视图控制器从右侧推入屏幕，并在导航栏的左侧带有返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的界面时，该界面应该作为模态视图显示，并包含一个取消按钮。否则，如果你使用类似“Show”跳转并带有返回按钮，用户可能会在输入完所有信息后点击返回按钮而没有保存任何内容！有了取消按钮，用户必须有意点击才能取消该界面。

要查看一个良好的模态输入视图控制器的示例，可以查看 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧会有一个 + 按钮，你可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，可以在关闭模态窗口之前创建新事件。你应该会看到，新事件模态从屏幕底部弹出，并在被关闭时向下滑动。我们希望用户保存生日，因此我们也将使用模态窗口。

现在让我们尝试运行应用，看看到目前为止我们完成了什么！要运行应用，首先通过点击 Xcode 左上角的 BirthdayTracker 旁边的设备列表选择一个设备模拟器（参见 图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角的应用名称旁边设置模拟器将运行的设备。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，供你选择运行应用的设备。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或使用键盘快捷键 ⌘ -**R**。

当模拟器打开以运行应用时，如果屏幕太大无法适应你的计算机屏幕，你可以调整其大小。点击模拟器进行选择，然后前往 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时，界面变化不大。你应该会看到你的第一个生日界面，上面有一个 + 按钮，如前所示在 图 9-1 中。显然，在此时你的生日界面会是空的。点击 + 按钮会弹出第二个空白屏幕。查看完应用后，点击 Xcode 中的停止按钮关闭应用，该按钮位于你之前点击的播放按钮旁边。当你停止应用时，你应该会看到应用图标出现在模拟器的主屏幕上！（参见 图 9-12。）

就这样！我们现在需要配置第二个屏幕，以便可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控件输入和标签

让我们通过添加标题开始设计“添加生日”视图控制器。为此，您需要将其嵌入到一个独立的导航控制器中。当一个视图控制器是模态时，它不会继承我们在故事板上已经有的导航控制器中的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。在故事板中点击选择空白视图控制器，然后转到 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在，您应该会看到一个导航项已被添加到视图控制器场景下的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题 **Add a Birthday**。这些步骤与您为表格视图控制器添加标题“Birthdays”时所做的相同。

现在，当“添加生日”视图控制器在应用中出现时，它将在顶部显示其标题。

#### 添加朋友的名字和生日

当您在第十章中输入朋友的生日时，您的应用程序中的每个条目将包含名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些 *输入控件*，这样用户就可以为每个人输入这些信息。输入控件包括文本框或下拉菜单等，让用户能够将数据输入到应用程序中。我们将从添加所有用户可以输入的控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个显示“名字”的标签。这个标签将放置在一个文本框旁边，用户可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，更改标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name** 作为显示文本，如图 9-14 所示。

现在，我们想通过大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以 *点* 为单位进行测量。请注意，1 点并不等于 1 像素。根据您的应用程序运行的设备类型，1 点可能对应 1 像素、2×2 像素的正方形或 3×3 像素的正方形。这三种缩放因子分别称为 @1x、@2x 和 @3x（这与我们设置应用图标时讨论的相同）。不同设备的点分辨率也不同，宽度可以从 320 到 1,024 点不等，高度从 568 到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：制作标签显示* 名字

只有最旧型号的 iPhone 和 iPod 使用 @1x 的缩放因子，而且你无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10+）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，这些设备使用 @3x 的缩放因子，否则你的手机或 iPod 很可能使用 @2x 的缩放因子。

一个对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15）。我们将设置每个我们添加到视图控制器中的库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，但仍为其文本输入框和其他标签及输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。将高度保持为 21。

完成这些步骤后，重复这些步骤，向“添加生日”视图控制器添加两个标签：姓氏标签和出生日期标签。我们需要定位其他标签和输入框，以确保它们不会重叠。在某些情况下，这可能会变得棘手，并且可能需要一些时间。对于这个应用，我们已经计算好了你可以将对象放置的位置（针对 iPhone 7 屏幕）。稍后我们会解释如何让你的应用适配其他设备。表 9-1 列出了每个标签应该设置的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有的标签都有相同的 x 位置，这样它们就垂直对齐了，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个标签的 y 位置大至少 21 点。由于我们还要在每个标签下方添加输入控件，因此我们将 y 位置设置得更大，以便同时容纳标签的高度和输入控件的高度。

太好了！现在你的故事板应该看起来像图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16：已向视图控制器添加输入标签。*

接下来，你将添加两个*文本框*，允许你输入姓氏和名字。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本字段对象到你的视图控制器上。一个用于输入名字，另一个用于输入姓氏。按照表 9-2 中的尺寸和位置设置这两个文本字段。你可以像之前设置标签一样使用大小检查器来进行调整。

表 9-2：视图控制器中的文本字段输入

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个称为*日期选择器*的滚轮。这将让你轻松输入生日。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，用于让用户选择日期或时间。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以只显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的。

在对象库中滚动，直到找到一个日期选择器，然后点击并拖动它到视图控制器中的生日标签下方。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整一些日期选择器的属性。点击选择日期选择器，然后在属性检查器中，将日期选择器的模式设置为只显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的生日吧！将日期字段从当前日期更改为**自定义**。当你这样做时，一个新框将出现。将这个日期更改为你的生日。

让我们通过运行应用程序来测试目前的效果！我们为输入控件设置的尺寸在 iPhone 7 的屏幕上适配得很好。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你点击生日视图控制器上的+按钮时，应该会显示添加生日屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来很好，但其他设备呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，并再次运行应用程序。你会看到，某些地方看起来不太对。

你添加到故事板中的所有元素都出现了，但文本字段却超出了屏幕的边缘。现在你已经将所有元素放到了屏幕上，下一步是让它们在任何屏幕尺寸上都能正确显示。我们将通过一个名为*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上看起来完美，使用自动布局

仅 iPhone 就有三种不同的屏幕尺寸，而且未来可能会有更多尺寸出现。你需要设计你的应用，使其在任何设备上看起来都很好。这意味着你需要让应用根据运行设备的不同调整应用中所有元素的位置和尺寸。自动布局使用一种叫做*布局约束*的方式，将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，调出自动布局菜单。*

屏幕故事板窗格的底部是一个带有图标的带状区域，在工具区域之前的最右侧图标是一个位于两条竖线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解析自动布局问题”。点击这个图标会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的尺寸正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适合屏幕，并且不会超出屏幕边缘。自动布局还会确保每个文本字段前后都有 20 个点的间距，从而使它们在屏幕上居中。

现在再次在 iPhone 5s 模拟器上运行应用。这一次，添加生日屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这一部分，我们将展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。按钮现在还不会有任何功能，我们只是设置它们。在第十章中，我们将添加代码，使这些按钮能取消并保存生日信息到应用中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右侧*。我们将把这个按钮改成一个保存按钮，正如我们为添加按钮所做的那样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加“取消”按钮。从对象库中拖动另一个“Bar Button Item”，这次将它放在导航栏的*左侧*。使用属性检查器将它设置为“取消”按钮，就像你做过的“保存”按钮一样。你的视图控制器应该像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有“取消”和“保存”按钮的输入视图控制器*

现在重新运行你的应用，看看新增的按钮！

在“生日”表视图控制器上点击+按钮，应该会跳转到“添加生日”视图控制器，在这里你可以输入一个人的名字和出生日期。点击“取消”和“保存”按钮目前没有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到的内容

本章中，你开始制作 BirthdayTracker 应用，通过创建“生日”和“添加生日”屏幕的基本用户界面。你还使用表视图控制器创建了“生日”屏幕，并设置了用户可以通过“添加”按钮和导航控制器在屏幕间切换。

现在你的应用基础框架已经完成，接下来你将在第十章编程实现“取消”和“保存”按钮，以便在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项以添加缺失的约束。

*图 9-2：确保你的新项目中有一个* BirthdayTracker.xcdatamodeld *文件。*

你需要*BirthdayTracker.xcdatamodeld*来保存 iPhone 上的生日。如果缺少它，那就意味着你在创建 Xcode 项目时没有勾选“使用 Core Data”选项。别担心——这很容易解决。

如果你的*BirthdayTracker.xcdatamodeld*丢失了，关闭你的项目（文件 ▸ 关闭项目），然后重新创建一个新的 Xcode 项目，并确保勾选“使用 Core Data”选项。当系统询问是否要替换 BirthdayTracker 项目时，点击**替换**，你就完成了！

你的新 BirthdayTracker Xcode 项目将打开。如果你还没有将 Apple 账号添加到 Xcode，你会在“常规”应用设置的“签名”部分看到“未找到账户”的提示。除非你想在真机上运行应用，否则不需要添加账户。（记得你也可以在 Xcode 的模拟器上运行应用。）要将 Apple 账号添加到 Xcode，点击**添加账户**按钮。（关于如何添加 Apple 账号的详细说明，请参阅“你的第一款应用！”的第 5 页。）

这个常规设置屏幕也是你设置应用运行设备方向的地方。我们希望 BirthdayTracker 应用仅在 *竖屏* 模式下运行。竖屏模式是手机的常规方向，主屏按钮在底部。*横屏* 模式是指你将手机横向放置，屏幕也会旋转，此时屏幕的宽度变为手机的高度，屏幕的高度变为手机的宽度。BirthdayTracker 应用在横屏模式下显示效果不好，所以我们不希望用户将手机转动时屏幕发生变化。应用倒过来看也没问题，但如果用户把手机反过来，屏幕翻转可能会让他们感到困惑，所以我们也不支持倒置模式。在部署信息部分，设备方向旁边，取消勾选 **横屏左** 和 **横屏右**，确保 **竖屏** 选项是唯一勾选的。

让我们来看看 Xcode。选择左侧导航窗格中的 *ViewController.swift*，你应该会看到类似于 图 9-3 的内容。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的构成*

左侧是导航窗格 ➊，你可以通过选择 **视图** ▸ **导航器** ▸ **隐藏/显示导航器** 或按下 ⌘ -0 来隐藏或显示它。你将使用导航器来选择和查看项目中的文件。

编辑器窗格位于窗口的中央 ➋。在这里你将编写代码！这里也是你可以更改应用设置和使用故事板布局应用中显示项的地方，故事板在 第一章 中已提到。我们很快会进一步讨论故事板。

右侧是实用工具窗格 ➌，你可以通过选择 **视图** ▸ **实用工具** ▸ **隐藏/显示实用工具** 或按下 ⌘ -OPTION -0 来隐藏或显示它。当故事板打开时，实用工具窗格将允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都会有一个显示在用户设备主屏上的图标。我们将从添加应用图标开始创建我们的 BirthdayTracker 应用。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图片。下载 ZIP 文件后，你将在 *下载* 文件夹中找到一个名为 *ch9-images* 的文件夹，里面有你需要的图像文件。一旦你下载了这些，选择项目导航器中的 *Assets.xcassets*。这将打开应用的 *资产目录*，这是你放置任何应用将使用的 *资产*（如图像、声音等）的地方，包括应用图标。事实上，资产目录已经有一个占位符，你可以在其中添加你的图标。选择目录左侧菜单中的 **AppIcon**，你应该会看到几个用于图像的占位符。

要添加一个将显示在 iPhone 主屏幕上的应用图标，你需要提供 2x 和 3x 图像，用于标签为*iPhone App*的图标集。2x 尺寸适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，例如 iPhone 6s Plus 和 iPhone 7 Plus，使用 3x 尺寸的图像。你将在第十四章中了解更多关于为不同屏幕分辨率调整图像尺寸的内容。

将图标添加到资源目录很简单！下载提供的图像后，打开 Finder 中的*下载*文件夹。然后只需将图片*cake@2x.png* 拖动到 iPhone App 2x 框中，将*cake@3x.png* 拖动到 3x 框中。完成后，你的资源目录应该像图 9-4 一样。

![Image](img/Image00200.jpg)

*图 9-4：我们现在有了一个应用图标！*

除了应用图标，应用还有一个显示名称，这个名称会显示在首页图标下方。默认情况下，显示名称就是应用的名称，BirthdayTracker。然而，这个名称有点长，无法完全显示在图标下方，所以我们将其更改为一个更短的名称：Birthdays。为此，选择项目导航器中的 BirthdayTracker 项目，返回设置页面。在顶部的 Identity 部分，你可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这只会更改显示在应用图标下的名称，而项目的名称仍然是 BirthdayTracker。

现在我们已经设置好了应用图标和显示名称，让我们来创建应用屏幕吧！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。这是我们设计应用*用户界面*的地方。用户界面是用户与应用互动时看到和使用的部分——图像、文本、按钮等。*故事板*让你可视化地组织应用的各个屏幕。我们将使用故事板查看所有使用的屏幕及其之间的连接。

选择*Main.storyboard*后，按 ⌘ -0 隐藏导航窗格，以便腾出更多屏幕空间。你的故事板应该已经包含一个视图控制器。

现在，看看实用工具窗格的顶部。你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是一些帮助你仔细查看故事板中元素的工具，并允许你更改这些元素的设置。当你选择其中一个检查器时，它会出现在实用工具窗格中。

**检查故事板项**

图 9-5 显示了当故事板打开时，实用工具窗格中出现的检查器选择栏的特写图。

![Image](img/Image00201.jpg)

*图 9-5：在故事板的实用工具窗格中有六个可以使用的检查器。*

让我们从左到右依次查看检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书中，以及你大多数应用中，你不会使用这个检查器。

下一个检查器，图标为问号，是快速帮助检查器。这个检查器会为你提供当前在故事板中选定项目的详细类信息。

第三个检查器，带有身份证图标的是身份检查器。在这里，你可以为故事板项目设置自定义类。

接下来的两个检查器是你在工作时最常用的，我们将在文本中频繁提到它们。属性检查器的图标看起来像一个盾牌。这个检查器用于设置故事板中选定项目的各种属性。它可以用来设置标签的文本、按钮的颜色，或文本输入框周围的框的类型等。大小检查器，带有标尺图标，用于设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，它的图标看起来像一个圆圈中的箭头。你可以用它将你的故事板中的项目连接到你在类中编写的代码上。我们将在第十章中展示如何做到这一点。

#### 添加表格视图控制器

我们的第一个视图控制器将是生日视图控制器。这个视图控制器是一个特殊的类，显示一个列表，在 Xcode 中称为*表格视图控制器*。在我们的应用中，表格视图控制器将显示你朋友的生日列表！现在它看起来只会是一个空白屏幕，你将在《创建生日表格视图控制器》中学习如何在第 156 页显示生日数据。

让我们将一个表格视图控制器添加到故事板中。如果你先从故事板上缩小视图，这个步骤会更容易，这样你就能更好地看到视图控制器。双击故事板中视图控制器外的空白区域来进行缩放。现在你的屏幕应该已经缩小了。

在工具面板的底部有一个部分，顶部有四个按钮。选择第三个按钮，它看起来像是一个圆圈中的方块。这是对象库，在这里你可以找到添加到故事板的项目。滚动浏览对象库列表，直到找到表格视图控制器，或者使用面板底部的筛选栏搜索“table view controller”。然后点击并拖动该对象到你的故事板中，放置在已经存在的视图控制器旁边。你的故事板应该像图 9-6 中那样。

请注意，在你添加表格视图控制器后，左侧的大纲视图中会出现一个表格视图控制器场景条目，里面包含一个表格视图控制器。故事板中的一个场景代表了应用屏幕上的一个区域。对于 iPhone 应用，通常一次屏幕上只有一个场景，而且该场景会填满整个屏幕。对于 iPad 应用，屏幕上可以同时显示两个或多个场景。

![图片](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到故事板中的生日屏幕*

下一步是将这个新视图控制器设置为运行应用时显示的第一个屏幕，因为我们希望在用户打开应用时能看到生日列表。完成此操作的步骤如图 9-7 所示。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后，在工具窗格中打开属性检查器 ➋。在那里，勾选**是初始视图控制器** ➌。完成此操作后，表格视图控制器左侧应该会出现一个箭头。该箭头表示当应用首次启动时，会显示这个视图控制器。

#### 添加导航控制器

现在，我们将给视图控制器添加一个标题，显示“生日”，并添加一个“添加”按钮，用于弹出添加生日的视图控制器。为此，我们首先将表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并带有位于左右两侧的按钮，允许用户在应用中导航到其他屏幕。你在多个 iOS 应用中都能看到这个导航栏，例如设置应用和消息应用。

在大纲视图中选择**表格视图控制器**。选择后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。路径是**编辑** ▸ **嵌入** ▸ **导航控制器**。

在表格视图控制器嵌入导航控制器之后，你的故事板应该如图 9-8 所示。导航控制器将在故事板中作为一个屏幕显示。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

在故事板中，每个视图控制器代表用户将看到的一个应用屏幕，但导航控制器略有不同。尽管它在故事板中看起来像一个独立的屏幕，但导航控制器实际上只是一个容器，里面包含了用户在应用中切换的其他视图控制器。将视图控制器嵌入导航控制器中意味着你的应用可以在一个视图和另一个视图之间来回导航。

你应该能看到导航控制器和表视图控制器顶部有灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们所在屏幕的标题，并可能包含按钮和箭头，供他们跳转到其他屏幕。为了使用导航栏告诉用户他们所在的屏幕，我们需要为屏幕命名。现在是缩放回故事板的好时机。双击故事板的空白处以放大视图，然后滚动视图，以便你可以看到表视图控制器。要为表视图控制器添加标题，请在左侧的大纲视图中点击**Navigation Item**，该项位于**Table View Controller Scene**下。

![Image](img/Image00205.jpg)

选中该项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。完成此步骤并按下 RETURN 后，表视图控制器场景条目将在大纲视图中自动更新为 Birthdays Scene。

接下来，我们将创建一个添加按钮，方便你添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并将生日添加到列表中。让我们做一个按钮，让他们可以做到这一点！

我们需要在导航栏添加一个按钮，指向添加生日的场景，以便用户可以输入生日。找到对象库中的 Bar Button Item，然后将其拖放到表视图控制器的导航栏右侧，如图 9-9 所示。

现在我们要将这个按钮变成一个添加按钮。幸运的是，Xcode 有一个内置的添加按钮可以使用。在属性检查器中，将 bar button item 的系统项更改为**Add**。你应该会看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮在被点击时该做什么。我们希望它打开“添加生日”视图控制器，因此需要将添加按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你能看到 Birthdays 表视图控制器和将最终成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 并从+按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时，松开鼠标。这将弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将 Bar Button Item 拖到 Birthdays 视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，在弹出的对话框中选择“Modally 呈现”。*

连接对话框为你提供了几种类型的 *segue* ——从一个屏幕到下一个屏幕的过渡方式——你可以在两个视图控制器之间选择。点击连接对话框中的 **Present Modally** 选项。这将使视图控制器作为 *模态* 视图控制器出现在屏幕上。在 iPhone 上，模态视图控制器从屏幕底部出现，并且它不会自动带有返回按钮返回到上一个屏幕。相反，模态视图可以有其他按钮，例如取消或保存。还有其他类型的 segue，例如 Show segue，它会将视图控制器从右侧推到屏幕上，并且在导航栏的左侧有返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，屏幕应当以模态方式显示，并带有取消按钮。否则，如果你使用类似“Show”segue 且带有返回按钮，用户可能会遇到输入完所有内容后点击返回按钮却没有保存任何数据的情况！有了取消按钮，用户必须故意点击才能退出该屏幕。

要查看一个很好的模态输入视图控制器的例子，看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，点击该按钮可以添加日历事件。点击 + 按钮会弹出一个模态的“新建事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，在关闭模态视图之前创建新事件。你应该看到，新的事件模态视图从屏幕底部弹出，并在关闭时再次向下消失。我们希望用户保存生日，因此我们也会使用模态视图。

现在，让我们运行一下我们的应用，看看到目前为止做了什么！要运行应用，首先在 Xcode 左上角的 BirthdayTracker 旁边点击设备列表，选择一个设备模拟器（参见 图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角设置模拟器运行的设备，设备名称位于应用名称旁边。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。在选择了模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R** 。

当模拟器启动并运行你的应用时，如果模拟器的大小过大，无法适应你的计算机屏幕，你可以调整它的大小。点击模拟器以选中它，然后转到 **Window** ▸ **Scale**，在模拟器菜单中选择一个较小的比例。

到目前为止，运行应用时没有发生太多事情。你应该能看到你的第一个“生日”界面，上面有一个加号按钮，如图 9-1 所示。显然，此时你的“生日”界面是空的。点击加号按钮会显示第二个空白界面。看完应用后，可以通过点击 Xcode 中的停止按钮来关闭应用，这个按钮位于你之前点击的播放按钮旁边。当你停止应用后，你应该能在模拟器的主屏幕上看到应用图标！（参见图 9-12。）

就是这样！现在我们需要配置第二个屏幕，使其能够用于添加生日！

![图片](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控件输入和标签

让我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，你需要将它嵌入到一个自己的导航控制器中。当一个视图控制器是模态时，它不会继承我们故事板上已有的导航控制器的导航栏。导航控制器是提供导航栏的控件，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中点击选择普通的视图控制器。然后进入**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该能看到在视图控制器场景下的轮廓视图中已添加一个导航项。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与添加“生日”标题到你的表格视图控制器时的步骤相同。

现在，当“添加生日”视图控制器出现在应用中时，它将在顶部显示其标题标签。

#### 添加朋友的姓名和生日

当你在第十章中输入朋友的生日时，应用中的每条记录都会包含一个名字、一个姓氏和一个生日日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件包括文本框或下拉菜单等，它们允许用户在应用中输入数据。我们将从为所有用户可以输入的信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“姓名”的标签。这个标签将位于一个文本框旁边，你可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入**姓名**作为显示文本，如图 9-14 所示。

现在，我们希望使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点（points）*为单位的。请注意，1 点并不等于 1 像素。根据应用运行的设备类型，1 点可能对应 1 像素、2×2 像素的方块，或者 3×3 像素的方块。这三种缩放因子分别称为 @1x、@2x 和 @3x（这是我们在设置应用图标时讨论过的相同尺寸）。不同的设备也并非都具有相同的点分辨率，宽度从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* 姓氏

只有最老款的 iPhone 和 iPod 才使用 @1x 缩放因子，而且你将无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们很可能使用 @2x 缩放因子，而这三款设备使用的是 @3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（参见图 9-15）。我们将设置每个添加到视图控制器的库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置为不在屏幕边缘，但仍然为其文本输入框以及其他标签和输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成此操作后，重复这些步骤，向“添加生日”视图控制器添加另外两个标签：姓氏标签和出生日期标签。我们需要将其他标签和输入框的位置设置好，以避免重叠。在某些情况下，这可能会变得棘手，可能需要一些时间。对于这个应用，我们已经计算了在 iPhone 7 屏幕上放置对象的位置。稍后我们将解释如何让你的应用在其他设备上运行。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中的输入标签设置

| 显示文本 | x 位置 | y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，以便它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置必须比下一个标签的 y 位置大至少 21 个点。由于我们也在每个标签下方添加了输入控件，所以我们将 y 位置设置得更大，以便容纳标签和输入控件的高度。

太棒了！现在你的故事板应该像图 9-16 中的那样。

![图片](img/Image00214.jpg)

*图 9-16：已向视图控制器添加了输入标签。*

接下来，你将添加两个*文本字段*，用于输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在文本框中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中的尺寸和位置设置这两个文本字段。你可以使用尺寸检查器来完成这一操作，就像设置标签一样。

表 9-2：视图控制器中输入的文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个叫做*日期选择器*的滚轮。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的工具，用于让用户选择日期或时间。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器一样（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，使用日期选择器选择日期。*

日期选择器还可以只显示时间，就像时钟应用中用于设置闹钟的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并将其拖动到视图控制器中出生日期标签下方。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们把这个日期改为你的生日吧！将日期字段从当前日期改为**自定义**。这样会出现一个新的框。将日期改为你的生日。

让我们通过运行应用来测试到目前为止的效果！我们为输入控件设置的大小适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这时，当你点击生日视图控制器上的 + 按钮时，应该会显示添加生日界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这个在 iPhone 7 上看起来很好，但其他设备怎么样呢？选择一个较小的模拟器运行应用，比如 iPhone 5s，然后再次运行应用。你会看到界面看起来不太对劲。

你添加到故事板的所有元素都会显示出来，但文本框超出了屏幕边缘。现在你已经将所有元素都放置到屏幕上，下一步是让它们能够在任何屏幕尺寸上正确显示。我们将使用一个叫做*自动布局*的工具来完成这一步。

#### 在每个设备上通过自动布局让你的应用看起来完美

iPhone 单独就有三种不同的屏幕尺寸，未来可能会有更多尺寸推出。你需要设计你的应用，使其在任何设备上都能看起来很好。这意味着你要让你的应用能够调整界面中所有元素的位置和大小，以适应应用运行的设备。自动布局使用一种叫做*布局约束*的方式来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标调出自动布局菜单。*

在屏幕故事板面板的底部有一个带图标的带状栏，在实用工具面板之前的最右边的图标是一个位于两条竖线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击该图标，弹出一份建议菜单。点击**添加缺失的约束**。^(*)这样做后，你会看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适应屏幕宽度，不会超出屏幕边缘。自动布局还会确保每个文本框前后有 20 个点，以便它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，"Add a Birthday" 屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这个操作，我们将展示如何为添加生日视图控制器的导航栏添加取消和保存按钮。这些按钮现在还不会执行任何操作。我们只是简单地设置它们。在 第十章 中，我们将添加一些代码，使它们能够取消添加生日屏幕并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的 *右侧*。我们将把这个按钮改成保存按钮，就像我们之前做的添加按钮一样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中再拖动一个条形按钮项，这次将其放置在导航栏的 *左侧*。使用属性检查器将其设置为取消按钮，就像你之前设置保存按钮一样。你的视图控制器应该像 图 9-21 所示那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新的按钮！

点击生日表格视图控制器上的 + 按钮应该会带你进入添加生日视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前不会有任何反应——我们将在 第十章 中实现这两个功能！

### 你学到了什么

在本章中，你通过创建生日和添加生日屏幕的基本用户界面，开始制作一个 BirthdayTracker 应用程序。你还使用表格视图控制器创建了生日屏幕，并让用户能够通过添加按钮和导航控制器在屏幕之间切换。

现在你已经有了应用程序的基本框架，在 第十章 中，你将编写代码来实现取消和保存按钮，这样你就能在应用中添加和保存生日！

* 在某些版本的 Xcode 中，"Add Missing Constraints" 选项被禁用。这是苹果的一个 bug。在这种情况下，选择 **Reset to Missing Constraints** 选项来添加缺失的约束。

你需要 *BirthdayTracker.xcdatamodeld* 来保存 iPhone 上的生日。如果缺少该文件，意味着你在创建 Xcode 项目时没有勾选“使用核心数据”选项。别担心——这很容易解决。

如果你的*BirthdayTracker.xcdatamodeld*丢失了，关闭你的项目（文件 ▸ 关闭项目），然后通过创建一个新的 Xcode 项目，并勾选“使用 Core Data”框重新开始。当系统询问你是否想要替换 BirthdayTracker 项目时，点击**替换**，这样就可以了！

你的新 BirthdayTracker Xcode 项目将打开。如果你还没有将 Apple 账户添加到 Xcode，你会在“常规”应用设置的签名部分看到一条消息：“未找到账户”。除非你想在真实设备上运行应用，否则你不需要添加账户。（记住，你也可以在 Xcode 的模拟器上运行应用。）要将 Apple 账户添加到 Xcode，点击**添加账户**按钮。（关于如何添加 Apple 账户的详细说明，请参见《你的第一个应用！》，见第 5 页。）

这个“常规设置”屏幕也是你设置应用运行设备方向的地方。我们希望 BirthdayTracker 应用只在*竖屏*模式下运行。竖屏模式是手机的常规方向，主屏幕按钮在底部。*横屏*模式是指将手机横过来时，屏幕也会旋转，使得屏幕的宽度变为手机的高度，屏幕的高度变为手机的宽度。BirthdayTracker 应用在横屏模式下效果不好，因此我们不希望屏幕在用户将手机横过来时发生变化。即使手机倒过来时，应用也能正常显示，但如果用户将手机旋转，主屏幕按钮在顶部时，屏幕翻转可能会让用户感到困惑，所以我们也不会支持倒屏模式。在“部署信息”部分，在“设备方向”旁边，取消勾选**横屏左**和**横屏右**，确保只有**竖屏**被勾选。

我们来看看 Xcode。选择左侧导航窗格中的*ViewController.swift*，你应该会看到类似于图 9-3 的内容。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的构成*

左侧是导航窗格 ➊，你可以通过选择**视图** ▸ **导航器** ▸ **隐藏/显示导航器**或按⌘-0 来隐藏或显示它。你将使用导航器来选择和查看项目中的文件。

编辑器窗格位于窗口的中央 ➋。这是你编写代码的地方！这里也是你可以更改应用设置和通过故事板布局显示在应用中的项的地方，你在第一章中见过这个故事板。我们很快会详细讲解故事板。

右侧是实用工具窗格 ➌，你可以通过选择**视图** ▸ **实用工具** ▸ **隐藏/显示实用工具**或按⌘-OPTION-0 来隐藏或显示它。当打开故事板时，实用工具窗格将让你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用程序都会有某种图标，显示在用户设备的主屏幕上。我们将通过添加应用图标来开始我们的 BirthdayTracker 应用程序。你可以从*[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)*下载我们将用作图标的两张图像。下载 ZIP 文件后，你将在 *Downloads* 文件夹中得到一个名为 *ch9-images* 的文件夹，里面有你需要的图像文件。获取这些文件后，选择项目导航器中的 *Assets.xcassets*。这将打开应用程序的*资源目录*，你可以将任何应用程序将要使用的*资源*（图像、声音等）放置在其中，包括应用图标。事实上，资源目录中已经有一个占位符，你可以在其中添加图标。从目录左侧菜单中选择**AppIcon**，你应该能看到多个图像占位符。

要添加一个显示在 iPhone 主屏幕上的应用图标，你需要提供标记为*iPhone App*的图标集的 2x 和 3x 尺寸图像。2x 尺寸适用于大多数 iPhone，例如 iPhone 5、6 和 7。更大的 iPhone，例如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸的图像。你将在第十四章中了解更多关于不同屏幕分辨率的图像尺寸。

将图标添加到资源目录非常简单！下载提供的图像后，打开 Finder 中的 *Downloads* 文件夹。然后，只需将图像*cake@2x.png* 拖到 iPhone App 2x 框中，将*cake@3x.png* 拖到 3x 框中。完成后，你的资源目录应该像图 9-4 一样。

![图片](img/Image00200.jpg)

*图 9-4：我们现在有了一个应用图标！*

除了应用图标，应用程序还有一个显示名称，它会显示在主屏幕上的图标下方。默认情况下，这个名称就是应用的名称 BirthdayTracker。然而，这个名称有点长，不适合显示在图标下方，所以我们将其更改为更短的名称：Birthdays。为此，选择项目导航器中的 BirthdayTracker 项目，返回到设置页面。在顶部的 Identity 部分，你可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这将只更改显示在应用图标下方的名称。你的项目名称仍然是 BirthdayTracker。

现在我们已经设置好了应用图标和显示名称，让我们来创建应用屏幕吧！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。这是我们设计应用程序*用户界面*的地方。用户界面是一个花哨的名称，指的是用户将在其中看到并用来与应用程序互动的内容——图像、文本、按钮等。*故事板*让你能够直观地组织应用程序的各个屏幕。我们将使用故事板来查看所有使用的屏幕及它们之间的连接。

选择了*Main.storyboard*后，按下⌘ -0 隐藏导航窗格，这样你将有更多的屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在看看实用工具窗格的顶部。你应该会看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，它们是帮助你更详细地查看故事板中元素的工具，并允许你更改这些元素的设置。当你选择其中一个检查器时，它会出现在实用工具窗格中。

**检查故事板项目**

图 9-5 显示了在打开故事板时，出现在实用工具窗格中的检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：在故事板的实用工具窗格中，有六个检查器可以使用。*

让我们从左到右浏览这些检查器。页面图标打开文件检查器。你可以在这里更改故事板文件的设置。在本书以及你大多数应用中，你不会使用这个检查器。

下一个检查器，标识为一个问号图标，是快速帮助检查器。这个检查器会提供你当前在故事板中选择的项目的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。你可以在这里为故事板项目设置一个自定义类。

接下来的两个检查器是你在工作中最常使用的，我们将在文本中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置选定项目的各种属性。例如，它可以用来设置标签的文本、按钮的颜色或文本输入框周围显示的框类型。大小检查器，带有尺子图标，用于设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，它的图标像一个圆圈中的箭头。你可以用它将故事板中的项目连接到你在类中编写的代码部分。我们将在第十章中教你如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是“生日”视图控制器。这将是一个特殊的视图控制器类，显示一个列表，在 Xcode 中被称为*表视图控制器*。在我们的应用中，表视图控制器将显示你的朋友们的生日！现在它看起来只是一个空白屏幕，你将在“创建生日表视图控制器”第 156 页中学习如何显示生日数据。

让我们将一个表格视图控制器添加到故事板。为了更容易完成这一步，首先将故事板缩小，这样可以更好地查看视图控制器。在故事板中双击视图控制器外部的空白区域来缩小视图。现在你的屏幕应该已经缩小了。

在工具面板的底部，有一个包含四个按钮的区域。选择第三个按钮，它看起来像一个圆圈中的正方形。这是对象库，在这里你可以找到要添加到故事板的项目。滚动浏览对象库列表，直到找到表格视图控制器，或者使用面板底部的筛选栏搜索“table view controller”。然后将该对象点击并拖动到你的故事板上。将其放在已经存在的视图控制器旁边。你的故事板应该看起来像图 9-6 中的样子。

请注意，在添加表格视图控制器后，一个“表格视图控制器场景”条目会出现在左侧的大纲视图中，并且其中包含一个表格视图控制器。故事板中的一个场景代表你的应用程序中屏幕上的区域。对于 iPhone 应用程序，通常屏幕上一次只有一个场景，并且该场景会填满整个屏幕。iPad 应用程序可以在屏幕上同时显示两个或更多的场景。

![图片](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到用于显示生日屏幕的故事板中*

下一步是将这个新的视图控制器设置为运行应用程序时首先显示的屏幕，因为我们希望用户打开应用时首先看到生日列表。执行此操作的步骤如图 9-7 所示。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊ 。然后在工具面板中打开属性检查器 ➋ 。在这里，勾选**是初始视图控制器**的框 ➌ 。完成此操作后，故事板中表格视图控制器的左侧应该会出现一个箭头。这个箭头意味着应用程序在启动时会显示此视图控制器。

#### 添加导航控制器

现在，我们将为视图控制器添加一个标题“生日”，并添加一个“添加”按钮，以打开添加生日视图控制器。为此，我们将首先把表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器，并自带一个*导航栏*，它位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧提供按钮，用于导航到应用程序中的其他屏幕。你在多个 iOS 应用程序的屏幕顶部看到过这个栏，比如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。选择后，你需要使用 Xcode 菜单将表格视图控制器嵌入到导航控制器中。依次点击**编辑** ▸ **嵌入到** ▸ **导航控制器**。

在将表格视图控制器嵌入导航控制器后，你的故事板应类似于图 9-8。导航控制器会作为一个屏幕显示在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表用户在应用中看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像一个独立的屏幕，但导航控制器其实只是一个容器，存放着用户在应用中切换的其他视图控制器。将视图控制器嵌入导航控制器意味着你的应用可以在不同的视图之间来回导航。

你应该能看到导航控制器和表格视图控制器顶部的灰色导航栏。当应用运行时，导航栏会告诉用户他们当前所处屏幕的标题，并且可能还包含按钮和箭头，供他们跳转到其他屏幕。为了利用导航栏向用户展示他们所处的屏幕，我们需要为屏幕命名。现在是重新聚焦故事板的好时机。双击故事板的空白处以进行缩放，然后滚动视图，直到可以看到表格视图控制器。要为表格视图控制器添加标题，请在左侧大纲视图中的**表格视图控制器场景**下点击**导航项**。

![Image](img/Image00205.jpg)

选择此项后，你可以在右侧的属性检查器中输入屏幕的标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。完成此步骤并按回车后，你会看到大纲视图中的表格视图控制器场景条目自动更新为“生日场景”。

接下来，我们将创建一个添加按钮，以便你可以添加生日！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将生日添加到该列表中。让我们做一个按钮，让他们能够做到这一点！

我们需要在导航栏上添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。在对象库中找到“Bar Button Item”，然后将其拖放到表格视图控制器的导航栏右侧，如图 9-9 所示。

现在我们希望将这个按钮变成一个添加按钮。幸运的是，Xcode 提供了一个内置的添加按钮。 在属性检查器中，将条形按钮项的系统项目更改为**添加**。你应该看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在被点击时该做什么。我们希望它打开“添加生日”视图控制器，因此需要将“添加”按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你能看到“生日”表视图控制器和最终会成为“添加生日”视图控制器的空视图控制器。按住 CONTROL 键并从“+”按钮拖动到故事板右侧的空视图控制器的中间。当视图控制器被高亮显示时松开鼠标，这将弹出一个连接对话框，如图 9-10 所示。

![图片](img/Image00206.jpg)

*图 9-9：将一个条形按钮项拖动到“生日”视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态展示”选项。*

连接对话框为你提供了几种不同类型的*segue*（即从一个屏幕到另一个屏幕的过渡效果）选项。点击对话框中的**模态展示**选项。这将使视图控制器以*模态*视图控制器的形式显示在屏幕上。在 iPhone 上，模态视图控制器会从屏幕底部弹出，并且不会自动带有返回按钮来返回上一个屏幕。相反，模态视图可以带有其他按钮，例如“取消”或“保存”。还有其他类型的 segue，例如“显示”segue，其中视图控制器从屏幕右侧推送出来，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用程序中，当你呈现一个用于获取和保存用户输入的屏幕时，应该以模态形式显示该屏幕，并带有一个取消按钮。否则，如果你使用像“显示”segue 这样带有返回按钮的方式，用户可能会输入所有内容后点击返回按钮，而没有保存任何东西！有了取消按钮，用户必须有意识地点击取消才能退出该屏幕。

要查看一个很好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个“+”按钮，你可以点击它来添加日历事件。点击“+”按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个“取消”按钮，可以在不保存的情况下退出该屏幕，右侧有一个“添加”按钮，用来在关闭模态之前创建新事件。你应该能看到，新事件模态从屏幕底部滑入，并在关闭时再次滑下。我们希望用户保存生日，因此我们也将使用模态。

现在，让我们试着运行我们的应用，看看到目前为止我们做了什么！运行应用之前，首先点击 Xcode 左上角 BirthdayTracker 旁边列出的设备模拟器来选择一个设备（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：将模拟器设置为运行设备，位置在 Xcode 窗口左上角，紧邻应用程序名称。这里，设备设置为 iPhone 7。*

这将显示一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮，或者使用快捷键⌘ -**R**。

当模拟器打开并运行你的应用时，如果它太大而无法适应计算机屏幕，你可以调整其大小。点击模拟器选择它，然后前往**窗口** ▸ **缩放**，在模拟器菜单中选择更小的缩放比例。

到目前为止，当你运行应用程序时，并不会发生太多事情。你应该能看到你的第一个生日屏幕，其中有一个+按钮，如图 9-1 所示。显然，此时你的生日屏幕是空的。点击+按钮会弹出第二个空白屏幕。当你完成查看应用程序后，通过点击 Xcode 中的停止按钮关闭应用程序，停止按钮位于你之前点击的播放按钮旁边。停止应用程序后，你应该能够看到你的应用图标出现在模拟器的主屏幕上！（参见图 9-12）。

就是这样！现在我们需要配置第二个屏幕，以便它可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：生日追踪器应用程序图标已被添加到主屏幕。*

### 设置控制输入和标签

现在我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，你需要将其嵌入到一个自己的导航控制器中。当视图控制器为模态时，它不会继承我们在故事板上已经存在的导航控制器中的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击故事板中的视图控制器，选择该视图控制器。然后，前往**编辑** ▸ **嵌入** ▸ **导航控制器**。现在，你应该会看到一个导航项已被添加到视图控制器场景的轮廓视图下。点击这个新导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与之前为你的表视图控制器添加标题“生日”时的步骤相同。

现在，当“添加生日”视图控制器出现在应用中时，它的顶部将标有标题。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友的生日时，应用程序中的每一项将包含名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，这样用户就可以为每个人输入这些信息。输入控件是像文本字段或下拉菜单这样的控件，允许用户将数据输入到应用程序中。我们将从为用户可以添加的所有信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个标签，显示“First Name”。这个标签将放在一个文本字段旁边，你可以在其中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，改变标签的显示文本。在“属性检查器”中，点击标签文本框，输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们希望使用“大小检查器”设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*为单位测量的。请注意，1 个点并不等于 1 个像素。根据应用程序运行的设备类型，1 个点将转化为 1 个像素、一个 2×2 像素的正方形或一个 3×3 像素的正方形。这三种缩放因子分别称为@1x、@2x 和@3x（这些就是我们在设置应用图标时提到的尺寸）。设备的点分辨率也不相同，宽度可能从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最老款的 iPhone 和 iPod 使用@1x 缩放因子，你将无法在这些设备上运行应用程序（BirthdayTracker 只支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们使用的是@2x 缩放因子，这些设备使用@3x 缩放因子。

对象在屏幕上的位置也是基于点数的。对象的 x 位置是从屏幕左侧到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离（以点为单位）。(参见图 9-15)。我们将为每个添加到视图控制器的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕边缘之外，同时仍然为文本输入框和其他标签及输入框留出足够的空间。在“大小检查器”的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成这些步骤后，重复操作，向“添加生日”视图控制器中添加两个标签：一个是姓氏标签，另一个是生日标签。我们需要调整其他标签和输入框的位置，避免它们重叠。在某些情况下，这可能会变得有些棘手，并且可能需要一些时间。对于这个应用，我们已经为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何让你的应用适配其他设备。表 9-1 列出了每个标签应该使用的尺寸和位置。

表 9-1：视图控制器中的输入标签设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，这样它们就能垂直对齐，但它们的 y 位置各不相同。每个标签的高度是 21，因此 y 位置需要比下一个标签至少多 21 个点。由于我们也要在每个标签下方添加输入控件，所以我们将 y 位置设置得更大，以便容纳标签的高度和输入控件的高度。

太好了！现在你的故事板应该看起来像图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本框*，它们允许你输入名字和姓氏。文本框是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本框对象到你的视图控制器上。一个用于输入名字，另一个用于输入姓氏。将这两个文本框设置为表 9-2 中看到的尺寸和位置。你可以通过尺寸检查器来调整，就像你为标签所做的那样。

表 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个称为*日期选择器*的控件，它可以让你轻松输入生日。

##### 添加日期选择器

日期选择器是 iOS 应用中用于选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中使用的日期选择器一样（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并将其拖动到出生日期标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击选择日期选择器，然后在属性检查器中，将日期选择器的模式设置为仅显示 **日期**，而不是日期和时间（参见 图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。我们将把这个日期改成你的出生日期！将日期字段从“当前日期”更改为 **自定义**。这样会出现一个新框，改成你的出生日期。

让我们通过运行应用来测试到目前为止的效果！我们为输入控件选择的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击出生日期视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如 图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美契合。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很好，但其他设备呢？选择一个较小的模拟器来运行该应用程序，比如 iPhone 5s，并重新运行应用。你会发现，界面看起来有点不对劲。

所有添加到故事板中的元素都会出现，但文本框已超出屏幕边缘。现在你已经把所有元素放到了屏幕上，下一步是让它们在任何屏幕尺寸上都能正确显示。我们将通过一个叫做 *自动布局* 的工具来实现这一点。

#### 使用自动布局让你的应用在每个设备上都完美显示

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能会出现更多尺寸。你需要设计你的应用，让它在任何设备上看起来都很好。这意味着你希望你的应用能够调整所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做 *布局约束* 的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择 **视图控制器**。接下来，看看编辑器面板右下角的四个图标（参见 图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来调出自动布局菜单。*

在屏幕的故事板面板底部有一个带有图标的工具栏，最右侧的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击该图标会弹出一个建议菜单。点击**添加缺失约束**。^(*) 这样做时，你会看到在添加生日场景中添加了许多布局约束。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局使得日期选择器的大小适应屏幕宽度，并且不会超出屏幕边缘。自动布局还确保每个文本框前后都有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，添加生日的屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。按钮暂时不会执行任何操作，我们只是设置它们。在第十章中，我们会添加一些代码，使它们能够取消添加生日屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮变成保存按钮，就像我们做添加按钮一样。选择该按钮项，然后使用属性检查器将其转变为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其转变为取消按钮，就像你做保存按钮一样。你的视图控制器应该看起来像图 9-21 所示。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新按钮的效果！

在生日表格视图控制器上点击+按钮应该会将你带到添加生日视图控制器，你可以在这里输入某个人的姓名和生日。点击取消和保存按钮暂时没有任何反应——我们将在第十章中实现它们！

### 你学到了什么

在本章中，你通过创建生日和添加生日屏幕的基本用户界面，开始制作一个生日追踪器应用。你还使用表格视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本框架，在第十章中，你将编写代码来实现取消和保存按钮，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束（Add Missing Constraints）选项被禁用。这是苹果的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

如果你的*BirthdayTracker.xcdatamodeld*丢失了，关闭你的项目（文件 ▸ 关闭项目），然后通过创建一个新的 Xcode 项目，并勾选“使用 Core Data”选项重新开始。当你被问到是否要替换 BirthdayTracker 项目时，只需点击**替换**，然后就可以开始了！

你的新 BirthdayTracker Xcode 项目将会打开。如果你还没有将你的 Apple 账号添加到 Xcode，你会在“常规”应用设置的签名部分看到一条消息：“未找到账户”。除非你想在真实设备上运行应用，否则无需添加账户。（记住，你也可以在 Xcode 的模拟器上运行你的应用。）要将 Apple 账号添加到 Xcode，请点击**添加账户**按钮。（关于如何添加 Apple 账号的更详细说明，请参见 “你的第一款应用！” 第 5 页 page 5）。

这个常规设置屏幕也是你设置应用运行的设备方向的地方。我们希望 BirthdayTracker 应用仅在*竖屏*模式下运行。竖屏模式是手机的常规方向，主屏按钮在底部。*横屏*模式是当你将手机横着转时，屏幕也会旋转，使得屏幕的宽度变为手机的高度，屏幕的高度变为手机的宽度。BirthdayTracker 应用在横屏模式下效果不好，所以我们不希望当用户将手机横着转时，屏幕发生变化。倒立显示虽然看起来不错，但如果用户将手机翻转时屏幕翻转可能会让用户感到困惑，因此我们也不支持倒立模式。在“部署信息”部分，找到设备方向（Device Orientation），取消勾选**横屏左**和**横屏右**，确保只勾选**竖屏**。

让我们来看看 Xcode。选择左侧导航窗格中的*ViewController.swift*，你应该能看到类似于图 9-3 的内容。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的构成*

左侧是导航窗格 ➊ ，你可以通过**视图** ▸ **导航器** ▸ **隐藏/显示导航器**，或者按 ⌘ -0\ 来隐藏或显示它。你将使用导航器来选择和查看项目中的文件。

编辑器窗格位于窗口的中心 ➋ 。这里是你将编写代码的地方！这里也是你可以更改应用设置并使用故事板布置将在应用中显示的项目的地方，你在第一章中看到过故事板。我们稍后会详细讨论故事板。

右侧是工具面板 ➌，你可以通过选择 **视图** ▸ **工具** ▸ **隐藏/显示工具** 或按 ⌘ -OPTION -0 来隐藏或显示它。当 storyboard 打开时，工具面板将允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用程序都有一个图标，显示在用户设备的主屏幕上。我们将通过添加应用图标来开始创建我们的 BirthdayTracker 应用。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图片。下载 ZIP 文件后，你将在 *Downloads* 文件夹内看到一个名为 *ch9-images* 的文件夹，其中包含所需的图像文件。获取这些文件后，在项目导航器中选择 *Assets.xcassets*。这将打开应用的 *资产目录*，在这里你可以放置应用将使用的所有 *资源*（图像、声音等），包括应用图标。实际上，资产目录中已经有一个占位符，你可以在其中添加图标。选择左侧菜单中的 **AppIcon**，你应该能看到多个图像占位符。

要添加一个在 iPhone 主屏幕上显示的应用图标，你需要为标记为 *iPhone 应用* 的图标集提供 2x 和 3x 图像。2x 大小适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，例如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 大小的图像。你将在 第十四章 中了解更多关于为不同屏幕分辨率调整图像大小的内容。

将图标添加到资产目录非常简单！下载提供的图片后，在 Finder 中打开 *Downloads* 文件夹。然后只需将图像 *cake@2x.png* 拖到 iPhone 应用 2x 框中，将 *cake@3x.png* 拖到 3x 框中。完成后，你的资产目录应该类似于 图 9-4。

![Image](img/Image00200.jpg)

*图 9-4：现在我们有了应用图标！*

除了应用图标，应用还会有一个显示名称，显示在主屏幕图标下方。默认情况下，这个名称就是应用名称 BirthdayTracker。然而，这个名称有点太长，无法放在图标下方，所以我们将其更改为一个更短的名称：Birthdays。为此，请通过选择项目导航器中的 BirthdayTracker 项目返回到设置页面。在顶部的 Identity 部分，你可以更改应用的显示名称。只需在显示名称文本框中输入 **Birthdays**。这只会更改图标下方显示的名称。你的项目名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，接下来让我们创建应用屏幕！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。在这里我们将设计应用程序的*用户界面*。用户界面只是用户用来与应用交互的所有视觉元素的总称——图像、文本、按钮等等。*故事板*允许你以可视化的方式组织应用程序的各个屏幕。我们将使用故事板查看所有使用的屏幕及它们之间的连接。

一旦你选择了*Main.storyboard*，通过按⌘ -0 隐藏导航面板，这样你就有更多的屏幕空间。你的故事板应该已经包含一个视图控制器。

现在看看实用工具面板的顶部，你应该看到一个带有六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更仔细地查看故事板中元素并更改它们设置的工具。当你选择某个检查器时，它将出现在实用工具面板中。

**检查故事板项目**

图 9-5 显示了在故事板打开时出现在实用工具面板中的检查器选择栏的特写图。

![图片](img/Image00201.jpg)

*图 9-5：在故事板的实用工具面板中，你可以使用六个检查器。*

让我们从左到右查看各个检查器。页面图标打开文件检查器。在这里你可以更改故事板文件的设置。在本书中以及大多数应用程序中，你不会使用这个检查器。

下一个检查器，由问号图标表示，是快速帮助检查器。这个检查器会提供你当前在故事板中选择的项目的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。你可以在这里为故事板项设置自定义类。

接下来的两个检查器是你在故事板工作时最常用的两个，我们将在文本中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置故事板中选中项目的各种属性。例如，它可以用来设置标签的文本、按钮的颜色，或者文本输入框周围显示的框的类型。大小检查器，带有尺子图标，用于设置每个故事板项的大小和屏幕位置。

最后是连接检查器，它的图标像一个圈中的箭头。这个检查器可以将你故事板中的项目与类中编写的代码连接起来。我们将在第十章中展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊的视图控制器类，用于显示列表，在 Xcode 中称为*表视图控制器*。在我们的应用中，表视图控制器将显示您朋友的生日列表！现在它看起来只是一个空白屏幕，您将在“创建生日表视图控制器”一节中了解如何在第 156 页显示生日数据。

让我们将表视图控制器添加到故事板中。如果您首先从故事板缩小视图，以便更好地看到视图控制器，这一步会更容易。双击故事板中视图控制器外的空白区域即可实现。现在，您的屏幕应该已经缩小。

在实用工具窗格的底部，有一个包含四个按钮的区域，位于顶部。选择第三个按钮，它看起来像一个圆圈内的正方形。这是对象库，您可以在其中找到要添加到故事板的项目。滚动浏览对象库列表，直到找到“表视图控制器”，或者使用窗格底部的过滤栏搜索“table view controller”。然后点击并将该对象拖到您的故事板中，直接放置在已有的视图控制器旁边。您的故事板应该像图 9-6 中的那样。

请注意，在添加表视图控制器后，左侧的大纲视图中会出现一个“表视图控制器场景”条目，里面包含一个表视图控制器。故事板中的场景代表应用程序中的一个屏幕区域。对于 iPhone 应用，通常一次屏幕上只显示一个场景，并且该场景会填满整个屏幕。iPad 应用可以同时显示两个或多个场景。

![图片](img/Image00202.jpg)

*图 9-6：将表视图控制器添加到生日屏幕的故事板中*

下一步是将这个新视图控制器设为应用运行时首先显示的屏幕，因为我们希望在用户打开应用时显示生日列表。执行此操作的步骤请参见图 9-7。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图 ➊ 中选择**表视图控制器**。然后在您的实用工具窗格中调出属性检查器 ➋。在那里，勾选**是初始视图控制器**框 ➌。完成后，故事板中表视图控制器的左侧应该会出现一个箭头。这个箭头表示应用在启动时会显示这个视图控制器。

#### 添加导航控制器

现在，我们将向视图控制器添加一个标题，显示“Birthdays”，并添加一个“添加”按钮，用于打开添加生日的视图控制器。为此，我们首先将表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧包含按钮，用户可以通过这些按钮在应用程序中的其他屏幕之间导航。你可以在多个 iOS 应用程序中看到这个导航栏，比如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。一旦选择了它，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。前往 **Editor** ▸ **Embed In** ▸ **Navigation Controller**。

当表格视图控制器嵌入到导航控制器中后，你的故事板应该像图 9-8 所示那样。导航控制器将在故事板中显示为一个屏幕。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表用户将在应用程序中看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像一个独立的屏幕，导航控制器实际上只是一个容器，里面包含了用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在一个视图和另一个视图之间进行导航。

你应该在导航控制器和表格视图控制器的顶部看到灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们当前所处的屏幕标题，并可能包含按钮和箭头，用户可以使用它们去往其他屏幕。为了通过导航栏告诉用户他们所处的屏幕，我们需要为我们的屏幕添加标题。现在是时候放大故事板视图了。双击故事板的空白区域放大，然后滚动视图，直到你可以看到表格视图控制器。要为表格视图控制器添加标题，点击大纲视图左侧的 **Navigation Item**，它位于 **Table View Controller Scene** 下。

![Image](img/Image00205.jpg)

选择此项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，所以在右侧的标题字段中输入**Birthdays**。完成此步骤并按下 RETURN 后，你会看到大纲视图中的表格视图控制器场景条目自动更新为 Birthdays 场景。

接下来，我们将制作一个“添加”按钮，以便你可以添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并向列表中添加一个生日。让我们创建一个按钮来实现这个功能！

我们需要在导航栏上添加一个按钮，指向添加生日的场景，以便用户可以输入生日。请在对象库中找到“Bar Button Item”，然后将其拖放到表视图控制器的导航栏右侧，如图 9-9 所示。

现在我们想将这个按钮改成“添加”按钮。幸运的是，Xcode 提供了一个内置的添加按钮可以使用。在属性检查器中，将“系统项目”更改为**添加**。你应该会看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮被点击时该做什么。我们希望它打开“添加生日”视图控制器，因此需要将添加按钮连接到该视图控制器。首先，双击故事板进行缩小，以确保你能看到“生日”表视图控制器和最终将成为“添加生日”视图控制器的空视图控制器。按住 CONTROL 键并从+按钮拖动到故事板右侧空白视图控制器的中央。当视图控制器被高亮显示时松开鼠标，这会弹出一个连接对话框，类似于图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将 Bar Button Item 拖到生日视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖到邻近的视图控制器，并在弹出的对话框中选择以模态方式呈现。*

连接对话框为你提供了几种不同类型的*segue*（从一个屏幕到另一个屏幕的过渡）选择。点击连接对话框中的**以模态方式呈现**选项，这将使视图控制器以*模态*视图控制器的形式出现在屏幕上。在 iPhone 上，模态视图控制器从手机底部进入屏幕，并且不会自动带有返回按钮返回到上一个屏幕。相反，模态视图可以有其他按钮，例如取消或保存。还有其他类型的 segue，比如“显示”segue，其中视图控制器从右侧推送到屏幕上，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用程序中，当你展示一个用于获取和保存用户输入的屏幕时，应该以模态的方式显示该屏幕，并带有取消按钮。否则，如果你使用类似“显示”segue 并带有返回按钮，用户可能会输入所有内容后点击返回按钮而没有保存任何内容！而如果有取消按钮，用户必须故意点击才能取消该屏幕。

要查看一个良好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，点击它可以添加日历事件。点击 + 按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，用于不保存而退出屏幕，右侧有一个添加按钮，用于创建新事件后再关闭模态。你应该能看到“新事件”模态从屏幕底部弹出，并在关闭时滑回底部。我们希望用户能够保存生日，因此我们也会使用模态。

现在让我们尝试运行我们的应用程序，看看到目前为止我们做了什么！要运行应用程序，首先选择一个设备模拟器，方法是点击 Xcode 左上角列出的 BirthdayTracker 旁边的设备（见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设备的设置位置在应用程序名称旁边。在这里，设备被设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用程序。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮，或使用快捷键 ⌘ - **R**。

当模拟器打开以运行你的应用程序时，如果它太大以至于无法适应计算机屏幕，你可以调整其大小。点击模拟器以选择它，然后进入 **窗口** ▸ **缩放**，在模拟器菜单中选择一个更小的缩放比例。

到目前为止，当你运行应用程序时，似乎没有太多发生。你应该会看到你第一个带有 + 按钮的“生日”屏幕，正如之前在图 9-1 中所示。显然，在此时，你的“生日”屏幕会是空的。点击 + 按钮将会弹出第二个空白屏幕。查看完应用程序后，点击 Xcode 中的停止按钮关闭应用程序，停止按钮位于你之前按下的播放按钮旁边。当你停止应用程序时，你应该会看到应用图标出现在模拟器的主屏幕上！(见图 9-12。)

就是这样！现在我们需要配置第二个屏幕，以便它可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题开始设计“添加生日”视图控制器。为此，你需要将其嵌入到一个独立的导航控制器中。当一个视图控制器是模态时，它不会继承我们 storyboard 中已经存在的导航控制器的导航栏。导航控制器提供了一个导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击 storyboard 中的视图控制器来选择它。然后前往**编辑** ▸ **嵌入于** ▸ **导航控制器**。现在，你应该会看到在“视图控制器场景”下的概述视图中新增了一个导航项目。点击这个新导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与你在为表格视图控制器添加“生日”标题时所跟随的步骤是一样的。

现在，当“添加生日”视图控制器出现在应用程序中时，它将显示顶部的标题标签。

#### 添加你的朋友的名字和生日

当你在第十章中输入朋友们的生日时，你的应用程序中的每一项都会包含名字、姓氏和出生日期。让我们在“添加生日”视图控制器中添加一些*输入控件*，以便用户可以为每个人输入所有这些信息。输入控件是诸如文本框或下拉菜单之类的控件，让用户能够将数据输入到应用程序中。我们将通过添加所有用户可以输入的内容的输入控件标签来开始。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器创建一个标签，显示“名字”。这个标签将位于一个文本框旁边，用户可以在其中输入朋友们的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在我们想要使用大小检查器设置标签的大小和位置。在 Xcode 的 storyboard 中，宽度和高度是以*点*为单位的。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点可能会转换为 1 像素、2×2 像素的方块或 3×3 像素的方块。这三种缩放因子分别称为 @1x、@2x 和 @3x（这是我们在设置应用图标时提到的相同大小）。设备的点分辨率也不相同，宽度可以从 320 点到 1,024 点不等，高度可以从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示*名字

只有最老的 iPhone 和 iPod 型号使用 @1x 的缩放比例，你将无法在这些型号上运行你的应用（BirthdayTracker 只支持 iOS 10 及以上版本）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，否则你的手机或 iPod 很可能使用 @2x 缩放比例，这些型号使用 @3x 缩放比例。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离，以点为单位。y 位置是从屏幕顶部到对象顶部的距离。（参见 图 9-15）。我们将设置每个我们添加到视图控制器中的库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签定位，使其既不在屏幕边缘，又能为其文本输入框以及其他标签和输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。将高度保留为 21。

完成后，重复这些步骤，向添加生日视图控制器中添加两个标签：姓氏标签和出生日期标签。我们需要调整其他标签和输入框的位置，以避免重叠。在某些情况下，这可能会变得复杂，可能需要一些时间。对于这个应用，我们已经计算好了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何使应用在其他设备上运行。表 9-1 列出了你应该为每个标签设置的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要至少比下一个最接近的标签高出 21 点。由于我们还在每个标签下方添加了输入控件，因此我们已将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

很好！现在你的故事板应该像图 9-16 中那样。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器。*

接下来，你将添加两个 *文本字段*，它们将让你输入名字和姓氏。文本字段是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。按照 表 9-2 中所示的大小和位置设置这两个文本字段。你可以使用大小检查器，就像你为标签所做的那样。

表 9-2：视图控制器中输入的文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个被称为 *日期选择器* 的滚轮。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以包含日期和时间，就像在日历应用中使用的日期选择器一样（见 图 9-17 ）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，日期选择器用于选择日期。*

日期选择器也可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这就是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到视图控制器中的出生日期标签下方。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击选择日期选择器。然后，在属性检查器中，将日期选择器的模式设置为显示 **日期**，而不是日期和时间（见 图 9-18 ）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器设置为显示当前日期。让我们将这个日期改为你的出生日期！将日期字段从“当前日期”更改为 **自定义** 。这样，一个新的框会出现。将日期改为你的出生日期。

让我们通过运行应用程序来测试它目前的工作情况！我们为输入控件设置的大小非常适合 iPhone 7 屏幕。所以，选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这次，当你在“生日”视图控制器上点击 + 按钮时，应该会显示“添加生日”屏幕，如 图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![图片](img/Image00218.jpg)

在 iPhone 7 上显示效果很好，但其他设备呢？选择一个更小的模拟器来运行应用程序，比如 iPhone 5s，然后重新运行应用程序。你会发现显示效果并不完全正确。

所有你添加到故事板中的元素都出现了，但文本字段超出了屏幕的边缘。现在你已经将所有元素添加到屏幕上，下一步是确保它们能够在任何屏幕尺寸上正确显示。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 通过自动布局让你的应用在每个设备上都看起来完美

单单 iPhone 就有三种不同的屏幕尺寸，未来可能会有更多的尺寸。你需要设计应用，使其在任何设备上都能呈现良好的效果。这意味着你希望应用能够调整屏幕上所有元素的位置和大小，以适应运行该应用的设备。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕故事板面板的底部有一条带有图标的带状工具条，最右边的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它会显示一个标签，说明是“解决自动布局问题”。点击该图标后，会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 这样做后，你会看到在“添加生日”页面中添加了大量的布局约束。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适应屏幕宽度，并且不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点的间距，以便它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，"添加生日" 页面应该完美显示。

#### 添加保存和取消按钮

为了完成操作，我们将展示如何为“添加生日”视图控制器的导航栏添加“取消”和“保存”按钮。这些按钮暂时不会执行任何操作。我们只是设置它们。在第十章中，我们将添加一些代码，使它们可以退出“添加生日”页面，并将生日保存到应用中。

要添加“保存”按钮，从对象库中拖动一个“条形按钮项”，并将其放置在导航栏的*右侧*。我们将把这个按钮更改为“保存”按钮，就像我们做的“添加”按钮一样。选择按钮项，然后使用属性检查器将其转换为“保存”按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你之前为保存按钮所做的那样。你的视图控制器应该像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新的按钮！

点击“生日”表格视图控制器中的 + 按钮应该会将你带到“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前还没有任何反应——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你开始通过创建“生日”和“添加生日”屏幕的基本用户界面来制作一个 BirthdayTracker 应用。你还使用表格视图控制器创建了“生日”屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本框架，你将在第十章中编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

你的新的 BirthdayTracker Xcode 项目将会打开。如果你还没有将你的 Apple 账户添加到 Xcode，你会在常规应用设置的签名部分看到一条消息，提示“未找到账户”。除非你希望在真实设备上运行应用，否则不需要添加账户。（记住，你也可以在 Xcode 的模拟器上运行应用。）要将你的 Apple 账户添加到 Xcode，请点击**添加账户**按钮。（有关如何添加 Apple 账户的详细说明，请参见 “你的第一个应用！” 第 5 页。）

这个“常规设置”界面也是你设置应用运行时所需设备方向的位置。我们希望“BirthdayTracker”应用仅在*竖屏*模式下运行。竖屏模式是手机的常规方向，主屏按钮位于底部。*横屏*模式是当你将手机旋转到侧面时，屏幕也会旋转，此时屏幕的宽度变成了手机的高度，屏幕的高度变成了手机的宽度。“BirthdayTracker”应用在横屏模式下看起来效果不好，因此我们不会让屏幕在用户将手机横过来时发生变化。即使倒置时应用看起来正常，但如果用户把手机旋转时，屏幕翻转会让他们感到困惑，因此我们也不支持倒置模式。在“部署信息”部分，找到设备方向，取消勾选**横屏左**和**横屏右**，确保只有**竖屏**被勾选。

让我们看看 Xcode 的界面。选择左侧导航面板中的*ViewController.swift*，你应该会看到类似于图 9-3 的内容。

![图片](img/Image00198.jpg)![图片](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航面板 ➊，你可以通过进入**视图** ▸ **导航器** ▸ **隐藏/显示导航器**来隐藏或显示它，或者按⌘ -0。你将使用导航器来选择和查看项目中的文件。

编辑器面板位于窗口的中间 ➋。这里是你编写代码的地方！这里也是你可以更改应用设置并使用故事板布局应用中显示的内容的位置，正如你在第一章中看到的。我们很快会更详细地讨论故事板。

右侧是工具面板 ➌，你可以通过选择**视图** ▸ **工具** ▸ **隐藏/显示工具**来隐藏或显示它，或者按⌘ -OPTION -0。当故事板打开时，工具面板将允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都带有某种图标，显示在用户设备的主屏幕上。我们将通过添加应用图标来开始“BirthdayTracker”应用。你可以从*[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)*下载我们将使用的两个图标图像。下载 ZIP 文件后，你会在*下载*文件夹中得到一个名为*ch9-images*的文件夹，里面包含你需要的图像文件。一旦你拥有这些文件，选择项目导航器中的*Assets.xcassets*。这将打开应用的*资产目录*，这里是你放置任何应用将要使用的*资产*（图像、声音等）的地方，包括应用图标。事实上，资产目录已经有一个占位符，可以用来添加你的图标。从目录左侧的菜单中选择**AppIcon**，你应该能看到几个图像占位符。

要添加一个将在 iPhone 主屏幕上显示的应用图标，你需要为名为 *iPhone App* 的图标集提供 2x 和 3x 的图像。2x 大小适用于大多数 iPhone，例如 iPhone 5、6 和 7。更大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 大小的图像。你将在 第十四章 中了解更多关于为不同屏幕分辨率调整图像大小的内容。

将图标添加到资源目录中非常简单！下载提供的图片后，打开 Finder 中的 *下载* 文件夹。然后，只需将图像 *cake@2x.png* 拖动到 iPhone App 2x 框中，将 *cake@3x.png* 拖动到 3x 框中。完成后，你的资源目录应该像 图 9-4 一样。

![图像](img/Image00200.jpg)

*图 9-4：我们现在有了一个应用图标！*

除了应用图标，应用还有一个显示名称，它会显示在主页图标下方。默认情况下，这个名称就是应用名称 BirthdayTracker。然而，这个名称稍微有点长，无法完全放在图标下方，所以我们将其更改为一个更简短的名称：Birthdays。为此，请通过在项目导航器中选择 BirthdayTracker 项目返回设置页面。在顶部的 Identity 部分，你可以更改应用的显示名称。只需在显示名称文本框中输入 **Birthdays**。这将只更改显示在应用图标下方的名称。你的项目名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，接下来让我们创建应用的屏幕！

### 显示你朋友的生日

从项目导航器中选择 *Main.storyboard* 来打开 storyboard。这是我们将设计应用 *用户界面* 的地方。用户界面只是一个花哨的名称，指的是用户将看到并用来与应用交互的内容——图像、文本、按钮等等。*storyboard* 让你可以直观地组织应用的屏幕。我们将使用 storyboard 来查看所有使用的屏幕以及它们之间的连接。

一旦你选择了 *Main.storyboard*，按 ⌘ -0 隐藏导航面板，以便你有更多的屏幕空间。你的 storyboard 应该已经包含了一个视图控制器。

现在看看工具面板的顶部。你应该会看到一个包含六个按钮的菜单。这些按钮用于在六个 *检查器* 之间切换，检查器是帮助你更仔细地查看 storyboard 中元素的工具，并允许你更改这些元素的设置。当你选择一个检查器时，它将出现在工具面板中。

**检查 storyboard 项目**

图 9-5 显示了在打开 storyboard 时出现在工具面板中的检查器选择栏的特写视图。

![图像](img/Image00201.jpg)

*图 9-5：在 storyboard 的工具面板中有六个检查器可以使用。*

我们从左到右来浏览这些检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书和大多数应用程序中，你不会使用这个检查器。

下一个检查器，由一个问号图标表示，是快速帮助检查器。这个检查器会提供你当前在故事板中选择的项目的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里你可以为故事板项目设置自定义类。

接下来的两个检查器是你在故事板中工作时最常用的，我们将在文本中经常提到它们。属性检查器的图标看起来像一个盾牌。这个检查器用于设置选定项目的各种属性。例如，它可以用来设置标签的文本、按钮的颜色，或文本输入框周围的框类型。尺寸检查器，带有尺子的图标，用于设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，它的图标看起来像一个圆圈中的箭头。这个检查器可以用来将故事板中的项目与您在类中编写的代码连接起来。我们将在第十章中展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊的视图控制器类，用于显示列表，在 Xcode 中称为*表视图控制器*。在我们的应用中，表视图控制器将显示你朋友的生日列表！现在它看起来只是一个空白屏幕，你将在“创建生日表视图控制器”中学习如何显示生日数据，详见第 156 页。

让我们将一个表视图控制器添加到故事板中。如果你首先将故事板缩小，这一步会更容易，这样你可以更好地查看视图控制器。双击故事板中视图控制器之外的空白区域来实现。现在你的屏幕应该已经缩小。

在工具面板的底部，有一个包含四个按钮的部分。选择第三个按钮，它看起来像一个圆圈里的方块。这是对象库，在这里你可以找到可以添加到故事板中的项目。向下滚动对象库列表，直到找到“表视图控制器”，或者使用面板底部的筛选栏搜索“table view controller”。然后点击并拖动该对象到你的故事板上，放在已经存在的视图控制器旁边。你的故事板应该像图 9-6 中的那样。

请注意，在你添加表格视图控制器后，左侧的大纲视图中会出现一个“表格视图控制器场景”条目，里面包含一个表格视图控制器。故事板中的场景代表了应用程序中的一个屏幕区域。对于 iPhone 应用，通常一次只会有一个场景出现在屏幕上，而且该场景会占满整个屏幕。iPad 应用则可以在屏幕上同时显示两个或更多场景。

![Image](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到生日屏幕的故事板中*

下一步是让这个新视图控制器成为运行应用时最先出现的屏幕，因为我们希望在用户打开应用时显示生日列表。执行这些操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图 ➊ 中选择**表格视图控制器**。然后在你的工具区 ➋ 中调出属性检查器。在那里，勾选**作为初始视图控制器** ➌ 。完成此操作后，应该会在故事板中的表格视图控制器左侧出现一箭头。箭头表示当应用程序启动时，系统将显示这个视图控制器。

#### 添加导航控制器

现在，我们将为视图控制器添加一个标题，显示“生日”，以及一个“添加”按钮，点击后会弹出“添加生日”视图控制器。为此，我们首先将表格视图控制器放入一个*导航控制器* 中。导航控制器管理一个或多个视图控制器，并带有一个*导航栏*，它位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧显示按钮，用于导航到应用中的其他屏幕。你在许多 iOS 应用中都会看到这个导航栏，例如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。选中后，您需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。前往**编辑** ▸ **嵌入于** ▸ **导航控制器**。

在表格视图控制器被嵌入到导航控制器后，你的故事板应该像图 9-8 中的那样。导航控制器会作为一个屏幕出现在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表了用户在应用中看到的一个屏幕，而导航控制器则略有不同。尽管它看起来像是故事板中的一个独立屏幕，但导航控制器实际上只是一个容器，用于存放用户在应用中切换的其他视图控制器。将一个视图控制器嵌入到导航控制器中，意味着你的应用可以在不同视图之间导航，并且能够来回切换。

你应该会看到导航控制器和表视图控制器的顶部有灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能还包含按钮和箭头，供他们用来跳转到其他屏幕。为了使用导航栏告诉用户当前所在的屏幕，我们需要为屏幕命名。现在是时候放大故事板了。双击故事板的空白区域进行放大，然后滚动视图以确保你能看到表视图控制器。要为表视图控制器添加标题，请在左侧的大纲视图中点击**导航项**，该项位于**表视图控制器场景**下。

![Image](img/Image00205.jpg)

选中后，你可以在右侧的属性检查器中输入屏幕的标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。完成后按下 RETURN，左侧大纲视图中的“表视图控制器场景”条目会自动更新为“生日场景”。

接下来，我们将创建一个添加按钮，方便你添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并向该列表添加一个生日。让我们做一个按钮，让他们可以实现这个功能！

我们需要在导航栏中添加一个按钮，跳转到“添加生日”页面，这样用户就可以输入一个生日。在对象库中找到“Bar Button Item”，然后将它拖到表视图控制器导航栏的右侧，如图 9-9 所示。

现在我们要把这个按钮变成一个添加按钮。幸运的是，Xcode 有一个内建的添加按钮可以使用。在属性检查器中，将 bar button item 的“系统项”设置为**添加**。你应该会看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮在被点击时应该做什么。我们希望它打开“添加生日”视图控制器，因此我们需要将添加按钮与该视图控制器连接。首先，双击故事板进行缩小，确保你可以看到“生日”表视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从+按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标，这会弹出一个连接对话框，类似于图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar Button Item 拖到生日视图控制器的导航栏。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态呈现”。*

连接对话框提供了几种选项，让你选择在两个视图控制器之间进行的*过渡*——即从一个屏幕到下一个屏幕的过渡方式。点击连接对话框中的**以模态方式呈现**选项。这样，视图控制器将以*模态*视图控制器的形式出现在屏幕上。在 iPhone 上，模态视图控制器从手机底部滑动到屏幕上，并且不会自动带有返回按钮返回到前一个屏幕。相反，模态视图控制器可以有其他按钮，例如取消或保存。还有其他类型的过渡，例如显示过渡，其中视图控制器从右侧推送到屏幕上，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个获取和保存用户输入的屏幕时，应该以模态方式显示该屏幕，并带有取消按钮。否则，如果你使用类似显示过渡并带有返回按钮的方式，可能会发生用户输入所有内容后点击返回按钮而没有保存的情况！使用取消按钮，用户必须明确点击才能退出屏幕。

要查看一个模态输入视图控制器的好例子，看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，用于不保存并退出屏幕，右侧有一个添加按钮，用于在关闭模态前创建新事件。你会看到，新事件模态视图控制器从底部滑动到屏幕上，关闭时会从屏幕上滑下。我们希望用户保存生日事件，所以我们也会使用模态视图。

现在，让我们试着运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先选择一个设备模拟器，通过点击 Xcode 左上角 BirthdayTracker 旁边列出的设备（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角设置模拟器运行的设备，设备名称旁边是你的应用程序名称。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用程序。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或使用快捷键 ⌘ -**R**。

当模拟器启动并运行你的应用时，如果模拟器的大小太大无法适应你的计算机屏幕，你可以调整其大小。点击模拟器以选择它，然后前往 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当您运行应用时，似乎没有太多的变化。您应该能看到之前提到的第一个“生日”屏幕，里面有一个 + 按钮，如图 9-1 所示。显然，在此时，您的“生日”屏幕会是空的。点击 + 按钮将打开第二个空白屏幕。完成查看应用后，通过点击 Xcode 中的停止按钮来关闭它，停止按钮位于您之前点击的播放按钮旁边。当您停止应用后，您应该能看到应用图标出现在模拟器的主屏幕上！（参见图 9-12）。

就这样！我们现在需要配置第二个屏幕，以便可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，您需要将其嵌入到一个独立的导航控制器中。当视图控制器是模态时，它不会继承我们故事板上已存在的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击故事板中的普通视图控制器来选择它。然后，前往**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在，您应该能看到一个导航项已被添加到视图控制器场景的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与您在为表视图控制器添加标题“生日”时所遵循的步骤相同。

现在，当“添加生日”视图控制器出现在应用中时，顶部将显示其标题。

#### 添加朋友的名字和生日

当您在第十章中输入朋友的生日时，应用中的每一条记录将包含一个名字、姓氏和生日。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入所有这些信息。输入控件包括文本框或下拉菜单等，允许用户将数据输入到应用中。我们将通过为用户可以添加的所有信息添加输入控件标签来开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器添加一个标签，内容为“名字”。这个标签将放在一个文本框旁边，您将在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们希望使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*为单位的。请注意，1 个点并不等于 1 个像素。根据应用运行的设备类型，1 个点可能会转换为 1 个像素、一个 2×2 像素的方块或一个 3×3 像素的方块。这三种缩放因子分别称为@1x、@2x 和@3x（这是我们在设置应用图标时讨论过的相同尺寸）。设备的点分辨率也不相同，宽度可以从 320 到 1,024 点，高度可以从 568 到 1,366 点。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* 名字

只有最旧型号的 iPhone 和 iPod 使用@1x 缩放因子，而且您无法在这些型号上运行您的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非您的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它很可能使用@2x 缩放因子，这些设备使用的是@3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离，以点为单位。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15）。我们将为添加到视图控制器中的每个库对象设置 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签放置在屏幕的边缘之外，但仍然留出足够的空间给文本输入字段及其他标签和输入框。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成此操作后，重复这些步骤，为“添加生日”视图控制器添加两个标签：姓氏标签和出生日期标签。我们需要定位其他标签和输入框，以避免它们重叠。在某些情况下，这可能会变得有些棘手，需要一些时间。对于此应用程序，我们已经为您计算出了适合放置对象的位置，基于 iPhone 7 屏幕。稍后，我们将解释如何让您的应用支持其他设备。表 9-1 列出了您应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | x 位置 | y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有的标签都有相同的 x 坐标，这样它们就可以垂直对齐，但每个标签的 y 坐标不同。每个标签的高度是 21，所以 y 坐标需要比下一个最近的标签大至少 21 个点。由于我们也要在每个标签下方添加输入控件，所以我们将 y 坐标设置得更大，以适应标签的高度和输入控件的高度。

太棒了！现在你的故事板应该像图 9-16 中的那样。

![Image](img/Image00214.jpg)

*图 9-16：输入的标签已添加到视图控制器中。*

接下来，你需要添加两个*文本字段*，它们将让你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们就可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中看到的大小和位置设置这两个文本字段。你可以使用大小检查器来进行设置，就像设置标签时一样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个称为*日期选择器*的控件。它将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的工具，允许用户选择日期或时间。它可以包含日期和时间，类似于日历应用中的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到一个日期选择器，然后点击并将其拖动到出生日期标签下方的视图控制器中。使用大小检查器，将 x 坐标设置为 0，y 坐标设置为 280。

你需要调整日期选择器的一些属性。点击选择日期选择器。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的生日！将日期字段从当前日期改为**自定义**。这样会出现一个新框，修改这个日期为你的生日。

让我们通过运行应用来测试目前的效果！我们为输入控件选择的尺寸在 iPhone 7 屏幕上适配得很好。所以选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这次，当你点击生日视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很不错，但在其他设备上呢？选择一个较小的模拟器，比如 iPhone 5s，然后再次运行应用。你会发现一些地方看起来不太对。

你添加到故事板上的所有元素都会显示，但文本字段超出了屏幕的边缘。现在你已经将所有元素放到屏幕上，下一步是让它们能够正确适配任何屏幕尺寸。我们将通过一个名为*自动布局*的工具来完成这一任务。

#### 使用自动布局让你的应用在每个设备上都看起来完美

单单 iPhone 就有三种不同的屏幕尺寸，而且未来可能会有更多尺寸。你需要设计应用，使其在任何设备上看起来都很好。这意味着你需要让应用根据设备的不同调整应用中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来在屏幕上放置元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标以调出自动布局菜单。*

在屏幕的故事板面板底部，有一排图标，实用工具面板之前的最右侧图标是一个夹在两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，上面写着“解决自动布局问题”。点击此图标以弹出建议菜单。点击**添加缺失的约束**。^(*) 做到这一点后，你会看到一堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适应屏幕的宽度，不会超出边缘。自动布局还会确保每个文本框前后有 20 个点的间距，从而使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，添加生日屏幕应该看起来非常完美。

#### 添加保存和取消按钮

为了完成这一切，我们将向你展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。这些按钮暂时不会有任何功能，我们只是将它们设置好。在第十章中，我们将添加一些代码，使它们能够退出添加生日屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个 Bar Button 项，并将其放置在导航栏的*右侧*。我们将把这个按钮设置为保存按钮，就像我们设置添加按钮一样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button 项，放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该像图 9-21 所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在重新运行你的应用程序，看看新按钮的效果！

点击生日表格视图控制器中的 + 按钮应该会带你进入添加生日视图控制器，在这里你可以输入一个人的姓名和生日日期。点击取消和保存按钮目前不会有任何反应——我们将在第十章实现这两个功能！

### 你学到了什么

在本章中，你开始制作一个生日追踪应用，通过创建生日和添加生日屏幕的基本用户界面。你还使用表格视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行切换。

现在你已经有了应用的基本框架，你将在第十章中编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用，这是一个苹果的 Bug。在这种情况下，选择“重置为缺失约束”选项以添加缺失的约束。

这个常规设置屏幕也是你设置应用运行设备方向的地方。我们希望 BirthdayTracker 应用仅在*竖屏*模式下运行。竖屏模式是手机的常规方向，主页按钮在底部。*横屏*模式是当你将手机横过来，屏幕也会旋转，使屏幕的宽度变成手机的高度，屏幕的高度变成手机的宽度。BirthdayTracker 应用在横屏模式下看起来不太好，所以我们不会让屏幕在用户将手机横过来时发生变化。虽然应用在手机倒过来的时候看起来也不错，但如果屏幕在用户将手机转过来时翻转，可能会让用户感到迷失方向，因此我们也不支持倒过来使用。在“部署信息”部分，在“设备方向”旁边，取消勾选**横屏左**和**横屏右**，确保只有**竖屏**的框被勾选。

让我们看看 Xcode。选择左侧导航窗格中的*ViewController.swift*，你应该能看到类似图 9-3 的内容。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航窗格 ➊，你可以通过前往**视图** ▸ **导航器** ▸ **隐藏/显示导航器**，或按 ⌘ -0\ 来隐藏或显示导航窗格。你将使用导航窗格来选择并查看项目中的文件。

编辑器窗格位于窗口的中央 ➋。这里是你将编写代码的地方！这里也是你可以更改应用设置并使用故事板布置在应用中显示的项目的地方，你在第一章中看到过故事板。我们稍后会更多地讨论故事板。

右侧是实用工具窗格 ➌，你可以通过选择**视图** ▸ **实用工具** ▸ **隐藏/显示实用工具**，或按 ⌘ -OPTION -0\ 来隐藏或显示实用工具窗格。当故事板打开时，实用工具窗格将让你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都会有一个图标，显示在用户设备的主屏幕上。我们将通过添加应用图标来开始制作我们的 BirthdayTracker 应用。你可以从*[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图片。下载 ZIP 文件后，你将在*下载*文件夹中得到一个名为*ch9-images*的文件夹，其中包含你所需的图片文件。下载完成后，选择项目导航器中的*Assets.xcassets*。这将打开应用的*资源目录*，这是你放置任何应用将要使用的*资源*（图像、声音等）的地方，包括应用图标。事实上，资源目录已经带有一个占位符，你可以在其中添加你的图标。从目录左侧的菜单中选择**AppIcon**，你应该能看到多个图像占位符。

要添加一个显示在 iPhone 主屏幕上的应用图标，你需要为标记为*iPhone 应用*的图标集提供 2x 和 3x 的图标图片。2x 大小适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，例如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 大小的图像。你将在第十四章中学习如何为不同屏幕分辨率调整图像大小。

将图标添加到资源目录非常简单！下载提供的图片后，打开 Finder 中的*下载*文件夹。然后只需将图片*cake@2x.png*拖动到 iPhone 应用 2x 框中，将*cake@3x.png*拖动到 3x 框中。完成后，你的资源目录应当像图 9-4 一样。

![Image](img/Image00200.jpg)

*图 9-4：现在我们有了应用图标！*

除了应用图标，应用程序还有一个显示名称，它会显示在首页图标下方。默认情况下，这个名称就是应用名称 BirthdayTracker。然而，这个名称有点太长，无法适应图标下方，所以我们将其更改为更短的名称：Birthdays。为此，请通过在项目导航器中选择 BirthdayTracker 项目返回设置页面。在顶部的身份部分，你可以更改应用程序的显示名称。只需在显示名称文本字段中输入**Birthdays**即可。这只会更改显示在应用图标下的名称。你的项目名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，接下来让我们创建应用屏幕！

### 显示朋友的生日

在项目导航器中选择*Main.storyboard*以打开故事板。这是我们设计应用程序*用户界面*的地方。用户界面只是一个华丽的术语，指的是用户将看到并用来与应用程序交互的所有内容——图片、文本、按钮等。*故事板*让你以可视化的方式组织应用程序的所有屏幕。我们将使用故事板查看所有使用的屏幕及它们之间的连接。

一旦选择了*Main.storyboard*，通过按 ⌘ -0 隐藏导航窗格，以便获得更多的屏幕空间。你的故事板应该已经包含一个视图控制器。

现在看看实用工具窗格的顶部。你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更详细地查看故事板中元素的工具，并允许你更改这些元素的设置。当你选择一个检查器时，它将显示在实用工具窗格中。

**检查故事板项目**

图 9-5 显示了在打开故事板时，位于实用工具窗格中的检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：在故事板的实用工具窗格中，你可以使用六个检查器。*

让我们从左到右逐一查看各个检查器。页面图标打开文件检查器。这里是你可以更改故事板文件设置的地方。在本书中，以及在大多数应用中，你不会使用这个检查器。

下一个检查器，由问号图标表示，是快速帮助检查器。这个检查器将为你提供关于当前在故事板中选择的项目的详细类信息。

第三个检查器是带有身份证图标的身份检查器。在这里，你可以为故事板项目设置自定义类。

接下来的两个检查器是你在工作中最常使用的两个，我们将在文中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置所选项目在故事板中的各种属性。例如，可以用它来设置标签的文本、按钮的颜色，或文本输入框周围显示的框类型。大小检查器，图标是一个尺子，用于设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，它的图标像是一个圆圈中的箭头。你可以使用它将故事板中的项目与在类中编写的代码片段连接起来。我们将在第十章中展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。它将是一个特殊的视图控制器类，用于显示一个列表，在 Xcode 中被称为*表视图控制器*。在我们的应用中，表视图控制器将显示你朋友的生日列表！现在它看起来只是一个空白屏幕，稍后你将在 “创建生日表视图控制器”中学习如何显示生日数据，在第 156 页。

让我们向故事板中添加一个表视图控制器。如果你首先从故事板中缩小视图，使得你可以更好地看到视图控制器，这一步会更容易。双击故事板中视图控制器外的空白区域来完成此操作。现在你的屏幕应该已经缩小了。

在工具面板的底部有一个部分，顶部有四个按钮。选择第三个按钮，看起来像是一个圆圈中的方块。这是对象库，在这里你可以找到要添加到故事板中的项目。滚动对象库列表，直到你找到表视图控制器，或者使用面板底部的筛选栏搜索“table view controller”。然后点击并拖动该对象到你的故事板上，放在已经存在的视图控制器旁边。你的故事板应该像图 9-6 中那样。

请注意，在你添加表格视图控制器后，左侧大纲视图中会出现一个“表格视图控制器场景”条目，里面包含一个表格视图控制器。故事板中的场景表示应用中的一个屏幕区域。在 iPhone 应用中，通常每次屏幕上只显示一个场景，并且该场景会填满整个屏幕。而 iPad 应用可以在同一屏幕上显示两个或更多场景。

![图片](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到生日屏幕的故事板中*

下一步是将这个新的视图控制器设置为运行应用时首先显示的屏幕，因为我们希望在用户打开应用时显示生日列表。执行此操作的步骤见于图 9-7。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后在你的工具面板中调出属性检查器 ➋。在这里，勾选**Is Initial View Controller** ➌。完成此操作后，你的表格视图控制器左侧应该会出现一个箭头。这个箭头表示应用启动时将显示这个视图控制器。

#### 添加导航控制器

现在我们将为视图控制器添加一个标题“生日”以及一个“添加”按钮，用于显示“添加生日”视图控制器。为了实现这一点，我们首先将表格视图控制器放入*导航控制器*中。导航控制器管理一个或多个视图控制器，并配有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧显示按钮，用于导航到应用中的其他屏幕。你会在许多 iOS 应用中看到这个栏，例如“设置”应用和“信息”应用。

在大纲视图中选择**表格视图控制器**。选择后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。前往 **Editor** ▸ **Embed In** ▸ **Navigation Controller**。

在将表格视图控制器嵌入到导航控制器后，你的故事板应该像图 9-8 中的示例一样。导航控制器将在故事板中作为一个屏幕出现。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表应用中用户将看到的一个屏幕，但导航控制器有所不同。尽管它在故事板中看起来像一个独立的屏幕，但导航控制器实际上只是一个容器，用于存放用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在不同的视图之间进行导航。

您应该看到导航控制器和表格视图控制器顶部有灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们所在屏幕的标题，并可能包含按钮和箭头，用户可以用来导航到其他屏幕。为了利用导航栏告诉用户他们所在的屏幕，我们需要为屏幕添加标题。现在是放大故事板的好时机。双击故事板的空白处以放大，然后滚动视图，以便您可以看到表格视图控制器。要为表格视图控制器添加标题，请在左侧大纲视图中点击**表格视图控制器场景**下的**导航项**。

![Image](img/Image00205.jpg)

选中此项后，您可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。完成此步骤并按下 RETURN 键后，您应该看到大纲视图中的表格视图控制器场景条目自动更新为“生日场景”。

接下来，我们将制作一个添加按钮，以便您可以添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并向该列表添加生日。让我们做一个按钮，允许他们执行这个操作！

我们需要在导航栏中添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。在对象库中找到条形按钮项，然后将其拖放到表格视图控制器的导航栏右侧，如图 9-9 所示。

现在，我们想把这个按钮变成一个添加按钮。幸运的是，Xcode 有一个内置的添加按钮可以使用。在属性检查器中，将条形按钮项的系统项更改为**添加**。您应该看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮点击时应该做什么。我们希望它打开“添加生日”视图控制器，所以我们需要将添加按钮连接到该视图控制器。首先，双击故事板进行缩小，确保您可以看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键并从+按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标。这样会弹出一个连接对话框，就像图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个条形按钮项拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖到相邻的视图控制器，并在出现的对话框中选择“模态呈现”。*

连接对话框提供了多种选项，让你选择在两个视图控制器之间进行的*过渡*方式—从一个屏幕到另一个屏幕的转换。点击连接对话框中的**模态呈现**选项。这将使视图控制器作为*模态*视图控制器显示在屏幕上。在 iPhone 上，模态视图控制器会从手机的底部滑上屏幕，并且它没有自动带有返回按钮来返回上一屏幕。相反，模态视图可以有其他按钮，如取消或保存。还有其他类型的过渡方式，比如显示过渡（Show segue），在这种方式下，视图控制器从右侧推到屏幕上，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用程序中，当你展示一个屏幕来获取和保存用户输入时，应该将该屏幕作为模态显示，并带有一个取消按钮。否则，如果你使用类似于显示过渡（Show segue）且带有返回按钮的方式，可能会发生一种情况：用户输入所有内容后点击返回按钮，结果没有保存任何内容！有了取消按钮，用户必须故意点击以取消该屏幕。

要查看模态输入视图控制器的一个好例子，可以看看你 iPhone 或 iPad 上的日历应用程序。当你打开它时，在导航栏的右侧有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，在关闭模态之前创建新事件。你会看到，“新事件”模态视图从屏幕底部滑入，并且在被关闭时又滑回去。我们希望用户能够保存生日信息，所以我们也会使用模态视图。

现在让我们尝试运行我们的应用程序，看看到目前为止我们完成了什么！要运行应用程序，首先通过点击 Xcode 左上角的 BirthdayTracker 旁边的设备列表来选择一个设备模拟器（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器运行的设备，设备名称旁边显示的是你的应用程序的名称。在这里，设备被设置为 iPhone 7。*

这将显示一个设备选项列表，用于运行你的应用程序。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或使用键盘快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用程序时，如果它的尺寸太大而无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器以选中它，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用时并不会发生太多事情。你应该会看到你的第一个生日屏幕，屏幕上有一个+按钮，如图 9-1 所示。显然，此时你的生日屏幕将是空的。点击+按钮会弹出第二个空白屏幕。查看完你的应用后，点击 Xcode 中的停止按钮（它位于你之前按下的播放按钮旁边）来关闭它。当你停止应用时，你应该会看到应用图标出现在模拟器的主屏幕上！（见图 9-12）

就这样！现在我们需要配置第二个屏幕，以便它可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

我们从为“添加生日”视图控制器添加标题开始设计它。为此，你需要将其嵌入到自己的导航控制器中。当一个视图控制器是模态时，它不会继承我们在故事板上已经设置的导航控制器中的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器来选择它。然后转到**Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在你应该可以看到，在视图控制器场景下的轮廓视图中，已经添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题**Add a Birthday**。这些步骤与之前为表格视图控制器添加“Birthdays”标题时相同。

现在，当“添加生日”视图控制器出现在应用中时，顶部将显示其标题。

#### 添加你朋友的姓名和生日

当你在第十章中输入你朋友的生日时，应用中的每条记录将包含名字、姓氏和出生日期。我们来为“添加生日”视图控制器添加一些*输入控件*，这样用户就可以为每个人输入所有这些信息。输入控件是像文本框或下拉菜单这样的元素，允许用户在你的应用中输入数据。我们将通过为用户可以添加的所有信息添加输入控件标签来开始。

##### 添加和定位标签

我们来为“添加生日”视图控制器创建一个标签，上面写着“名字”。这个标签将位于一个文本框旁边，用户可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框，并输入**First Name**作为显示文本，如图 9-14 所示。

现在我们想使用“大小检查器”设置标签的尺寸和位置。在 Xcode 的情节提要中，宽度和高度是以*点*为单位进行测量的。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点可能对应 1 个像素、一个 2×2 像素的方块，或者一个 3×3 像素的方块。这三个比例因子分别为@1x、@2x 和@3x（这也是我们设置应用图标时讨论过的尺寸）。不同设备的点分辨率也不同，从 320 点到 1,024 点宽，568 点到 1,366 点高不等。

![Image](img/Image00211.jpg)

*图 9-14：设置标签显示* 名字

只有最旧款的 iPhone 和 iPod 才使用@1x 比例因子，而且你将无法在这些设备上运行你的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的设备是 iPhone 6 Plus、6s Plus 或 7 Plus，否则你的手机或 iPod 可能使用@2x 比例因子，这些设备使用的是@3x 比例因子。

对象在屏幕上的位置也基于点来计算。对象的 x 位置是从屏幕左侧到对象左侧的距离，单位为点。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15）。我们将设置每个添加到视图控制器中的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在离屏幕边缘不太近的位置，同时留出足够的空间给其文本输入框及其他标签和输入框。在“大小检查器”的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成此操作后，重复这些步骤，将两个标签添加到“添加生日”视图控制器中：一个姓氏标签和一个出生日期标签。我们需要调整其他标签和输入框的位置，以避免它们重叠。在某些情况下，这可能会变得有些复杂，需要一些时间。对于这个应用程序，我们已经为你计算出了适合 iPhone 7 屏幕的对象放置位置。稍后我们将解释如何让你的应用程序适配其他设备。表 9-1 列出了每个标签的尺寸和位置设置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | x 位置 | y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

可以看到，所有标签的 x 位置相同，因此它们垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置需要比下一个最接近的标签大至少 21 个点。由于我们还将在每个标签下方添加输入控件，因此我们将 y 位置设置得更大，以适应标签和输入控件的高度。

太棒了！现在你的故事板应该像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：已将输入标签添加到视图控制器中。*

接下来，你将添加两个*文本字段*，让你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。给这两个文本字段设置表 9-2 中看到的大小和位置。你可以使用大小检查器，就像设置标签时一样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后，你需要添加一个叫做*日期选择器*的滚轮。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，用于让用户选择日期或时间。它可以同时包含日期和时间，就像日历应用中使用的日期选择器（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到“出生日期”标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将日期更改为你的出生日期！将日期字段从“当前日期”更改为**自定义**。这样会出现一个新框，将此日期更改为你的出生日期。

让我们通过运行应用来测试当前的效果！我们使用的输入控件尺寸在 iPhone 7 屏幕上非常合适。所以，选择 iPhone 7 模拟器，点击左上角的播放按钮。这次，当你在“生日”视图控制器上点击 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很好，但其他设备怎么样呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，并再次运行应用。你会发现一些东西看起来不太对劲。

所有添加到故事板中的元素都会显示，但文本框超出了屏幕的边缘。现在你已经将所有元素添加到屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确显示。我们将通过一个名为*自动布局*的工具来实现这一点。

#### 使用自动布局让你的应用在每个设备上都看起来完美

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会有更多尺寸。你需要设计应用程序，使其在任何设备上都能看起来不错。这意味着你希望你的应用能够根据运行该应用的设备，自动调整应用中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来调出自动布局菜单。*

在屏幕的故事板面板底部，有一个带图标的功能区，紧挨着工具面板右侧的是一个位于两条垂直线之间的三角形图标。将鼠标光标悬停在该图标上，应该会显示一个标签，提示“解决自动布局问题”。点击这个图标，会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 这样，你会看到大量布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，能够适应屏幕。例如，自动布局会确保日期选择器的宽度适配屏幕宽度，不会超出边界。自动布局还会确保每个文本字段前后有 20 点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”页面应该完美显示。

#### 添加保存和取消按钮

为了完成剩下的部分，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮现在还没有任何功能。我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消“添加生日”页面并保存生日到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的 *右侧*。我们将把这个按钮改成保存按钮，就像我们做的添加按钮一样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，我们来添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的 *左侧*。使用属性检查器将其更改为取消按钮，就像你之前做的保存按钮一样。你的视图控制器应该看起来像图 9-21 中所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新按钮的效果！

在“生日”表格视图控制器上点击 + 按钮应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮现在不会做任何事情——我们将在第十章中实现它们！

### 你所学到的内容

在这一章中，你开始制作一个 BirthdayTracker 应用，通过创建“生日”和“添加生日”页面的基本用户界面。你还通过使用表格视图控制器创建了“生日”页面，并使得用户可以通过添加按钮和导航控制器在页面间导航。

现在你已经有了应用程序的基本框架，你将花费第十章的时间来编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项是禁用的。这是苹果的一个 bug。在这种情况下，选择 **重置为缺失约束** 选项来添加缺失的约束。

让我们浏览一下 Xcode。在左侧导航窗格中选择 *ViewController.swift*，你应该看到类似图 9-3 的界面。

![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的构成*

在左侧是导航器面板 ➊ ，你可以通过选择**视图** ▸ **导航器** ▸ **隐藏/显示导航器**或按 ⌘ -0 来隐藏或显示它。你将使用导航器来选择和查看项目中的文件。

编辑器面板位于窗口的中央 ➋ 。在这里，你将编写代码！这也是你可以更改应用程序设置并使用故事板布局显示在应用程序中的项的位置，你在第一章中看到过这个故事板。稍后我们会详细讨论故事板。

在右侧是实用工具面板 ➌ ，你可以通过选择**视图** ▸ **实用工具** ▸ **隐藏/显示实用工具**或按 ⌘ -OPTION -0 来隐藏或显示它。当故事板打开时，实用工具面板将允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都会有某种图标，在用户的设备主屏幕上显示。我们将通过添加一个应用图标来开始我们的 BirthdayTracker 应用。你可以从*[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图像。下载 ZIP 文件后，你将在*下载*文件夹中找到一个名为*ch9-images*的文件夹，里面有你需要的图像文件。拿到这些文件后，从项目导航器中选择*Assets.xcassets*。这将打开应用的*资源目录*，在这里你可以放置应用要使用的任何*资源*（图像、声音等），包括应用图标。实际上，资源目录已经有一个占位符，你可以在其中添加你的图标。从目录左侧的菜单中选择**AppIcon**，你应该会看到几个图像占位符。

要添加一个会显示在 iPhone 主屏幕上的应用图标，你需要提供 2x 和 3x 图像，这些图像属于标记为*iPhone 应用*的图标集。2x 大小适用于大多数 iPhone，如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 大小的图像。你将在第十四章中学习如何为不同的屏幕分辨率调整图像大小。

将图标添加到资源目录很简单！下载提供的图像后，打开 Finder 中的*下载*文件夹。然后，只需将图像*cake@2x.png* 拖到 iPhone 应用 2x 框中，将*cake@3x.png* 拖到 3x 框中。完成后，你的资源目录应该像图 9-4 一样。

![Image](img/Image00200.jpg)

*图 9-4：现在我们有了一个应用图标！*

除了应用程序图标，应用程序还有一个显示名称，该名称显示在主页上的图标下方。默认情况下，这个名称就是应用程序名称 BirthdayTracker。然而，这个名称有点太长，无法适应图标下方的空间，因此我们将其改为一个更短的名称：Birthdays。为此，返回到设置页面，选择项目导航器中的 BirthdayTracker 项目。在顶部的身份部分，您可以更改应用程序的显示名称。只需在显示名称文本框中输入**Birthdays**。这只会更改显示在应用程序图标下方的名称，而项目的名称仍然是 BirthdayTracker。

现在我们已经设置了应用程序图标和显示名称，接下来让我们创建应用程序的屏幕！

### 显示朋友的生日

在项目导航器中选择*Main.storyboard*以打开故事板。这是我们设计应用程序*用户界面*的地方。用户界面是用户看到并用来与应用程序交互的元素的总称——包括图像、文本、按钮等。*故事板*可以帮助您直观地组织应用程序的屏幕。我们将使用故事板查看所有使用的屏幕及其之间的连接。

一旦选择了*Main.storyboard*，通过按下⌘ -0 隐藏导航面板，以便腾出更多的屏幕空间。您的故事板应该已经包含一个视图控制器。

现在，看看实用工具面板的顶部。您应该看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助您更详细地查看故事板元素并更改这些元素设置的工具。当您选择其中一个检查器时，它将出现在实用工具面板中。

**检查故事板项目**

图 9-5 显示了故事板打开时，在实用工具面板中出现的检查器选择栏的特写视图。

![图片](img/Image00201.jpg)

*图 9-5：在故事板的实用工具面板中，您可以使用六个检查器。*

让我们从左到右依次查看检查器。页面图标打开文件检查器。在这里，您可以更改故事板文件的设置。在本书和大多数应用程序中，您不会使用此检查器。

下一个检查器，由一个问号图标表示，是快速帮助检查器。这个检查器会为您提供当前选中项目的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里，您可以为故事板项目设置自定义类。

接下来的两个检查器是你在故事板中工作时最常用的，我们在文中也会频繁提到它们。属性检查器的图标像一个盾牌。此检查器用于设置故事板中所选项目的各种属性。比如它可以用来设置标签的文本、按钮的颜色，或者设置文本输入框周围显示的框的类型等。尺寸检查器，图标是一个尺子，用来设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，它的图标像一个圈中的箭头。这个检查器可以用来将故事板中的项目连接到你在类中编写的代码部分。我们将在第十章中向你展示如何实现这一点。

#### 添加表格视图控制器

我们的第一个视图控制器将是生日视图控制器。这个视图控制器将是一个特殊的控制器，显示一个列表，在 Xcode 中被称为*表格视图控制器*。在我们的应用中，表格视图控制器将显示你朋友们的生日列表！现在它看起来只是一个空白的屏幕，你将学习如何在“创建生日表格视图控制器”中显示生日数据，第 156 页会详细讲解。

让我们把表格视图控制器添加到故事板中。如果你先缩小故事板的视图，使你能更好地看到视图控制器，这一步会更容易。你可以通过双击故事板中视图控制器外的空白区域来做到这一点。现在你的屏幕应该已经缩小了。

在工具窗格的底部，有一个包含四个按钮的区域。选择第三个按钮，它看起来像是一个圆圈内的正方形。这是对象库，你可以在这里找到要添加到故事板中的项目。滚动对象库列表，直到找到“表格视图控制器”，或者使用窗格底部的过滤器栏搜索“table view controller”。然后将该对象点击并拖动到你的故事板中，放到已经存在的视图控制器旁边。你的故事板应该像图 9-6 所示。

注意，在你添加了表格视图控制器后，左侧大纲视图中会出现一个“表格视图控制器场景”条目，里面包含一个表格视图控制器。故事板中的场景代表了你应用程序中屏幕上的一个区域。对于 iPhone 应用，通常一次屏幕上只有一个场景，而且该场景会填满整个屏幕。而 iPad 应用则可以在屏幕上同时显示两个或更多场景。

![图片](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到生日屏幕的故事板中*

下一步是将这个新的视图控制器设置为应用启动时首先显示的屏幕，因为我们希望在用户打开应用时看到生日列表。完成此操作的步骤请参见图 9-7。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设为初始视图控制器。*

首先，在大纲视图 ➊ 中选择**表格视图控制器**。然后在实用工具面板中打开属性检查器 ➋。在这里，勾选**是初始视图控制器** ➌。完成此操作后，应该会在故事板中的表格视图控制器左侧显示一个箭头。这个箭头表示应用启动时会显示这个视图控制器。

#### 添加导航控制器

现在，我们将为视图控制器添加一个标题“Birthdays”，并添加一个“添加”按钮，点击该按钮将弹出“添加生日”视图控制器。为此，首先我们将表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并带有左右两侧的按钮，用于导航到应用中的其他屏幕。你可以在许多 iOS 应用中看到这个导航栏，比如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。选中后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。请前往**编辑** ▸ **嵌入** ▸ **导航控制器**。

在将表格视图控制器嵌入导航控制器后，你的故事板应该类似于图 9-8。导航控制器将在故事板中作为一个屏幕出现。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

每个视图控制器在故事板中代表着用户在应用中看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像是一个单独的屏幕，实际上导航控制器只是一个容器，用来存放用户在应用中来回切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在不同的视图之间进行导航。

你应该在导航控制器和表视图控制器的顶部看到灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们所在的屏幕的标题，并且可能还包含用户可以用来导航到其他屏幕的按钮和箭头。为了利用导航栏告诉用户他们所在的屏幕，我们需要为屏幕添加标题。现在是时候回到故事板了。双击故事板的空白区域以放大视图，然后滚动视图，直到你可以看到表视图控制器。要为表视图控制器添加标题，请在左侧的大纲视图中点击**Table View Controller Scene**下的**Navigation Item**。

![Image](img/Image00205.jpg)

选择后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。完成此步骤并按下 RETURN 键后，你会看到大纲视图中的 Table View Controller Scene 条目会自动更新为 Birthdays Scene。

接下来，我们将制作一个“添加”按钮，让你能够添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并向该列表中添加生日。让我们做一个按钮，让他们能做到这一点！

我们需要在导航栏上添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。找到对象库中的 Bar Button Item，然后将其拖放到表视图控制器导航栏的右侧，如图 9-9 所示。

现在，我们想将这个按钮变成一个“添加”按钮。幸运的是，Xcode 内置了一个可以使用的“添加”按钮。在属性检查器中，将 bar button item 的 System Item 更改为**Add**。你应该看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在被点击时该做什么。我们希望它打开“添加生日”视图控制器，因此我们需要将“添加”按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你可以同时看到 Birthdays 表视图控制器和最终会成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从 + 按钮拖动到故事板右侧的空白视图控制器中间。鼠标放开时，当视图控制器被高亮显示时，就会弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar Button Item 拖到 Birthdays 视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到邻近的视图控制器，并在弹出的对话框中选择“模态呈现”。*

连接对话框为你提供了几种 *segue* 的选项——即从一个屏幕到另一个屏幕的过渡方式。点击连接对话框中的 **Present Modally** 选项。这将使视图控制器以 *模态* 视图控制器的形式出现在屏幕上。在 iPhone 上，模态视图控制器从手机底部出现，并且不会自动带有返回按钮以返回到前一个屏幕。相反，模态视图可以包含其他按钮，如取消或保存。还有其他类型的 segue，比如 Show segue，它会将视图控制器从右侧推送到屏幕上，并且在导航栏左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，应该将该屏幕作为模态显示，并带有一个取消按钮。否则，如果你使用类似 Show segue 的方式，并且有一个返回按钮，用户可能会在输入所有内容后点击返回按钮而没有保存任何信息！而使用取消按钮时，用户必须有意识地点击来取消该屏幕。

想要查看模态输入视图控制器的一个好例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。该视图控制器左侧有一个取消按钮，允许用户不保存直接退出屏幕，右侧则有一个添加按钮，点击后可以在关闭模态视图前创建新事件。你会看到，新事件模态视图从屏幕底部出现，关闭时也会从屏幕底部退出。我们希望用户能够保存生日，所以我们也将使用模态视图。

现在让我们尝试运行我们的应用程序，看看到目前为止我们做了什么！要运行应用程序，首先通过点击 Xcode 左上角的 BirthdayTracker 旁边列出的设备，选择一个设备模拟器（见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器将运行的设备，设备名称旁边是你的应用名称。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择的是 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ - **R**。

当模拟器打开并运行你的应用时，如果模拟器的尺寸太大，无法适应你的计算机屏幕，你可以调整其大小。点击模拟器以选中它，然后进入 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的比例。

到目前为止，运行应用时并没有发生太多事情。你应该会看到第一个“生日”屏幕，其中有一个+按钮，如图 9-1 所示。显然，此时你的“生日”屏幕将是空的。点击+按钮会弹出第二个空屏幕。当你查看完应用后，通过点击 Xcode 中的停止按钮关闭应用，停止按钮位于你之前点击的播放按钮旁边。当你停止应用时，应该能看到你的应用图标出现在模拟器的主屏幕上！（参见图 9-12。）

就这样！现在我们需要配置第二个屏幕，以便它可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，你需要将它嵌入到一个独立的导航控制器中。当视图控制器是模态时，它不会继承我们故事板中已存在的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器，选择该视图控制器。然后转到**Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在，你应该看到一个新的导航项已被添加到“视图控制器场景”的大纲视图中。点击这个新导航项，然后在“属性检查器”中添加标题**Add a Birthday**。这些步骤与当时在表视图控制器中添加标题“Birthdays”时的步骤相同。

现在，当“添加生日”视图控制器出现在应用中时，它将在顶部标有标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每条记录都会包含一个名字、一个姓氏和一个出生日期。让我们在“添加生日”视图控制器中添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件是诸如文本框或下拉菜单等控件，允许用户将数据输入到应用中。我们将通过为所有用户可以添加的信息添加输入控件标签来开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个标签，标签内容为“First Name”。这个标签将放在一个文本框旁边，用户可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：在“添加生日”视图控制器中添加标签。*

接下来，修改标签的显示文本。在“属性检查器”中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在我们想使用大小检查器设置标签的大小和位置。在 Xcode 故事板中，宽度和高度是以*点*为单位测量的。请注意，1 个点不等于 1 个像素。根据你的应用运行的设备类型，1 个点可能会转换为 1 个像素、一个 2×2 像素的正方形，或者一个 3×3 像素的正方形。这三种缩放因子被称为@1x、@2x 和@3x（这也是我们在设置应用图标时提到的大小）。不同的设备也并非具有相同的点分辨率，宽度范围从 320 到 1,024 点，高度从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：显示标签* 姓名

只有最旧款的 iPhone 和 iPod 使用@1x 缩放因子，而且你将无法在这些设备上运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们大多数使用@2x 缩放因子。

一个对象在屏幕上的位置也是基于点数来确定的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15）。我们将设置添加到视图控制器的每个库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕的边缘外，但仍然为其文本输入框和其他标签及输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，高度保持为 21。

完成这些步骤后，重复这些操作，为添加生日视图控制器再添加两个标签：一个是姓氏标签，另一个是生日标签。我们需要调整其他标签和输入框的位置，确保它们不会重叠。在某些情况下，这可能会变得有些棘手，并且可能需要一些时间。对于这个应用，我们已经为你计算出了在 iPhone 7 屏幕上放置对象的位置。稍后我们将解释如何使你的应用适配其他设备。表 9-1 列出了每个标签应设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 坐标相同，这样它们就可以垂直对齐，但它们的 y 坐标各不相同。每个标签的高度为 21，因此 y 坐标需要至少比下一个标签的 y 坐标大 21 个点。由于我们也将在每个标签下方添加输入控件，所以我们将 y 坐标设得更大，以适应标签的高度和输入控件的高度。

太棒了！现在你的故事板应该像图 9-16 中的那样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们将允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在文本字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器上。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段的大小和位置设置为表 9-2 中的值。你可以像设置标签一样使用大小检查器来完成此操作。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后，你需要添加一个被称为*日期选择器*的控件。这个控件将允许你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，日期选择器用于日期选择。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的功能。

在对象库中滚动，直到找到一个日期选择器，然后点击并拖动它到视图控制器中的出生日期标签下。使用大小检查器，将 x 坐标设置为 0，y 坐标设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。我们来把这个日期改成你的生日！将日期字段从“当前日期”更改为**自定义**。更改后，一个新框将出现。将此日期更改为你的生日。

让我们通过运行应用来测试一下到目前为止的工作！我们为输入控件所使用的大小适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你在“生日”视图控制器上点击 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个更小的模拟器，比如 iPhone 5s，再次运行应用。你会发现某些地方看起来不太对劲。

所有添加到故事板中的元素都已显示，但文本框超出了屏幕边缘。现在你已经将所有元素放在屏幕上，下一步是让它们适应任何屏幕大小。我们将使用一个名为*自动布局*的工具来做到这一点。

#### 通过自动布局使你的应用在每个设备上看起来完美

iPhone 本身就有三种不同的屏幕大小，而且未来可能会有更多屏幕尺寸。你需要设计应用程序，使其在任何设备上看起来都很棒。这意味着你希望应用能够根据运行应用的设备来调整屏幕上所有内容的位置和大小。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（参见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来打开自动布局菜单。*

在屏幕的故事板面板底部有一个带图标的带状工具栏，位于“实用工具”面板之前的最右边的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，上面写着“解决自动布局问题”。点击该图标以弹出一个建议菜单。点击**添加缺失的约束**。^(*) 完成此操作后，你将看到一大堆布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的宽度适合屏幕，并且不会超出屏幕边缘。自动布局还会确保每个文本字段的前后各有 20 个点，以便它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上重新运行应用程序。这次，“添加生日”界面应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这个操作，我们将向你展示如何为添加生日视图控制器的导航栏创建取消和保存按钮。这些按钮目前还不会做任何事情，我们只是先设置它们。在第十章中，我们将添加代码，让它们能退出添加生日界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”，并将它放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们之前做的“添加”按钮一样。选择这个按钮项，然后使用属性检查器将它变成保存按钮。

最后，我们来添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将它放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该和图 9-21 中显示的一样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新的按钮！

点击生日表视图控制器中的+按钮应该会带你进入添加生日视图控制器，在那里你可以输入一个人的名字和生日。点击取消和保存按钮暂时不会有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在这一章中，你开始制作一个 BirthdayTracker 应用，通过创建生日和添加生日界面的基本用户界面。你还使用表视图控制器创建了生日界面，并使用户可以通过“添加”按钮和导航控制器在不同的界面之间切换。

现在你已经有了应用的基本框架，接下来将在第十章中编程实现取消和保存按钮，以便你能在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是一个苹果的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。![Image](img/Image00198.jpg)![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航面板 ➊，你可以通过进入**视图** ▸ **导航器** ▸ **隐藏/显示导航器**，或按 ⌘ -0 来隐藏或显示导航面板。你将使用导航面板来选择并查看项目中的文件。

编辑面板位于窗口的中央 ➋。这里是你编写代码的地方！这也是你可以更改应用设置并使用故事板布局将在应用中显示的项目的地方，正如你在第一章中看到的那样。我们很快会进一步讨论故事板。

右侧是实用工具面板 ➌，你可以通过选择**视图** ▸ **实用工具** ▸ **隐藏/显示实用工具**，或按 ⌘ -OPTION -0 来隐藏或显示实用工具面板。当故事板打开时，实用工具面板将允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用程序都有某种图标，显示在用户设备的主屏幕上。我们将通过添加一个应用图标来开始创建我们的 BirthdayTracker 应用。你可以从*[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图片。下载 ZIP 文件后，你将在*下载*文件夹中得到一个名为*ch9-images*的文件夹，里面有你需要的图片文件。获取这些文件后，选择项目导航器中的*Assets.xcassets*。这将打开应用的*资源目录*，这是你放置应用将使用的任何*资源*（图片、声音等）的位置，包括应用图标。实际上，资源目录已经包含了一个占位符，你可以在其中添加你的图标。选择目录左侧菜单中的**AppIcon**，你应该能看到几个图片占位符。

要添加一个将在 iPhone 主屏幕上显示的应用图标，你需要为标记为*iPhone App*的图标集提供 2x 和 3x 尺寸的图片。2x 尺寸适用于大多数 iPhone，比如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，使用 3x 尺寸的图片。你将在第十四章中学习更多关于不同屏幕分辨率图像尺寸的内容。

将图标添加到资源目录非常简单！下载提供的图片后，打开 Finder 中的*下载*文件夹。然后，只需将图片*cake@2x.png* 拖到 iPhone App 2x 框中，将*cake@3x.png* 拖到 3x 框中。完成后，你的资源目录应该像图 9-4 一样。

![Image](img/Image00200.jpg)

*图 9-4：现在我们有了一个应用图标！*

除了应用图标，应用程序还有一个显示名称，它会显示在主页上的图标下。默认情况下，这个名称就是应用程序的名称 BirthdayTracker。然而，这个名称有点太长，不能完全显示在图标下，所以我们将它改为一个更短的名称：Birthdays。要做到这一点，返回设置页面，选择项目导航器中的 BirthdayTracker 项目。在顶部的身份部分，你可以更改应用的显示名称。只需在显示名称文本字段中输入**Birthdays**。这只会更改显示在应用图标下的名称。你的项目名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，让我们来创建应用的屏幕！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*以调出故事板。这是我们设计应用程序*用户界面*的地方。用户界面只是用户将看到并用来与应用互动的各种元素——如图像、文本、按钮等的一个 fancy 名称。*故事板*让你以可视化的方式组织应用的各个屏幕。我们将使用故事板查看所有使用的屏幕及其之间的连接。

一旦你选择了*Main.storyboard*，通过按⌘-0 隐藏导航面板，以便获得更多的屏幕空间。你的故事板应该已经包含一个视图控制器。

现在看看工具面板的顶部。你应该会看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更详细地查看故事板元素，并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它会出现在工具面板中。

**检查故事板项目**

图 9-5 显示了在打开故事板时，工具面板中出现的检查器选择栏的特写图。

![Image](img/Image00201.jpg)

*图 9-5：这是在打开故事板时，你可以在工具面板中使用的六个检查器。*

让我们从左到右依次浏览这些检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书以及大多数应用程序中，你不会使用这个检查器。

下一个检查器，用一个问号图标表示，是快速帮助检查器。这个检查器会提供关于你当前在故事板中选择的项目的详细类信息。

第三个检查器，带有身份证图标的是身份检查器。在这里你可以为故事板项目设置自定义类。

接下来的两个检查器是你在工作时最常用的，我们将在文本中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置故事板中所选元素的各种属性。例如，它可以用来设置标签的文本、按钮的颜色，或文本输入框周围显示的框的类型。尺寸检查器的图标是一个尺子，用于设置每个故事板项的大小和屏幕位置。

最后，还有连接检查器，它的图标看起来像是一个箭头在一个圆圈里。这个工具可以用来将故事板中的元素连接到你在类中编写的代码上。我们将在第十章中展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊类型的视图控制器，用于显示列表，在 Xcode 中称为*表视图控制器*。在我们的应用中，表视图控制器将显示你朋友的生日列表！目前，它只会看起来像一个空白屏幕，你将在 “创建生日表视图控制器” 中学习如何在第 156 页中显示生日数据。

让我们向故事板中添加一个表视图控制器。如果你先从故事板中缩小视图，这一步会更容易，这样你可以更好地看到视图控制器。双击故事板中视图控制器外的空白区域即可实现这一点。现在你的屏幕应该已经缩小了。

在工具面板的底部，有一个区域，顶部有四个按钮。选择第三个按钮，它看起来像是一个圆圈内的方形。这是对象库，在这里你可以找到要添加到故事板中的元素。滚动浏览对象库列表，直到找到表视图控制器，或者使用面板底部的过滤栏搜索“table view controller”。然后点击并拖动该对象到故事板上，放置在已经存在的视图控制器旁边。你的故事板应该像图 9-6 中的样子。

请注意，添加表视图控制器后，左侧大纲视图中会出现一个“表视图控制器场景”条目，里面有一个表视图控制器。故事板中的场景代表应用中屏幕上的区域。对于 iPhone 应用，通常一次屏幕上只有一个场景，并且该场景会填满整个屏幕。iPad 应用可以同时在屏幕上显示两个或更多场景。

![图片](img/Image00202.jpg)

*图 9-6：将表视图控制器添加到生日屏幕的故事板中*

下一步是使这个新的视图控制器成为应用程序运行时首先显示的屏幕，因为我们希望在用户打开应用程序时显示生日列表。执行此操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表视图控制器** ➊。然后在工具面板中调出属性检查器 ➋。在那里，勾选**是初始视图控制器** ➌的框。一旦完成，表视图控制器的左侧应该会出现一个箭头。这个箭头表示应用程序在启动时会显示这个视图控制器。

#### 添加导航控制器

现在我们将为视图控制器添加一个标题“生日”，并添加一个“添加”按钮，点击后会弹出“添加生日”视图控制器。为此，我们将首先把表视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器，它自带一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题，以及左右两侧的按钮，用于在应用程序中导航到其他屏幕。在多个 iOS 应用中，例如设置应用和信息应用，你都会看到这个导航栏。

在大纲视图中选择**表视图控制器**。选择后，您需要通过 Xcode 菜单将表视图控制器嵌入到导航控制器中。请前往**编辑** ▸ **嵌入** ▸ **导航控制器**。

将表视图控制器嵌入到导航控制器中后，您的故事板应如下图所示，图 9-8。导航控制器将作为一个屏幕显示在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表应用程序中用户将看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像是一个独立的屏幕，实际上它只是一个容器，里面存放着用户在应用中可以切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着应用程序可以在不同的视图之间进行切换。

你应该能看到导航控制器和表格视图控制器顶部有灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们所在的屏幕标题，并且可能还包含按钮和箭头，用户可以通过它们跳转到其他屏幕。为了让导航栏告诉用户当前所在的屏幕，我们需要为屏幕命名。现在是时候重新缩小故事板了。双击故事板中的空白区域进行缩小，然后滚动视图，直到看到表格视图控制器。要为表格视图控制器添加标题，请在左侧的大纲视图中点击**表格视图控制器场景**下的**导航项**。

![Image](img/Image00205.jpg)

选择此项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，因此在右侧的“标题”字段中输入**生日**。完成此步骤并按下 RETURN 键后，你应该看到大纲视图中的“表格视图控制器场景”项自动更新为“生日场景”。

接下来，我们将制作一个“添加”按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用程序，查看生日列表，并向列表中添加生日。让我们做一个按钮，让他们能够做到这一点！

我们需要在导航栏中添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。找到对象库中的“工具栏按钮项”，然后将其拖动到表格视图控制器的导航栏右侧，如图 9-9 所示。

现在我们要将这个按钮改为“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮可以使用。在属性检查器中，将工具栏按钮项的系统项目更改为**添加**。你应该能看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在被点击时做什么。我们希望它打开“添加生日”视图控制器，所以我们需要将“添加”按钮连接到那个视图控制器。首先，双击故事板以缩小视图，确保你能看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从 + 按钮拖动到故事板右侧的空白视图控制器中间。当视图控制器被高亮显示时松开鼠标，这时会弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将“工具栏按钮项”拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在出现的对话框中选择“模态呈现”。*

连接对话框为你提供了几种选项来选择你希望在两个视图控制器之间创建的 *segue*——即从一个屏幕到另一个屏幕的过渡。点击连接对话框中的 **模态呈现** 选项。这将使视图控制器作为 *模态* 视图控制器呈现在屏幕上。在 iPhone 上，模态视图控制器从屏幕底部滑入，并且不会自动带有返回按钮返回到前一个屏幕。相反，模态视图控制器可以有其他按钮，如取消或保存。还有其他类型的跳转，比如 Show 跳转，其中视图控制器从屏幕右侧推入，并且在导航栏左侧有一个返回按钮。

在 iOS 应用中，当你展示一个获取和保存用户输入的屏幕时，屏幕应该作为模态视图显示，并带有取消按钮。否则，如果你使用像 Show 跳转（segue）并带有返回按钮，可能会出现这样的情况：用户输入了所有内容，然后点击返回按钮但没有保存任何东西！而带有取消按钮的模态视图会要求用户故意点击才能取消退出屏幕。

要查看一个良好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，在导航栏的右侧会有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，用于不保存并退出当前屏幕，右侧有一个添加按钮，用于在关闭模态视图前创建新事件。你应该看到“新事件”模态从屏幕底部滑入，关闭时会滑回底部。我们希望用户保存生日，因此我们也会使用模态视图。

现在让我们尝试运行我们的应用，看看到目前为止做了什么！要运行应用，首先选择一个设备模拟器，点击 Xcode 左上角的“BirthdayTracker”旁边列出的设备（见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器运行的设备，紧挨着你的应用名称。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R** 。

当模拟器打开运行你的应用时，如果它太大而无法适应电脑屏幕，你可以调整它的大小。点击模拟器以选择它，然后进入 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用程序时，似乎没发生什么特别的事情。你应该能看到第一个生日屏幕，屏幕上有一个+按钮，如之前在图 9-1 中所示。显然，这时你的生日屏幕将是空的。点击+按钮会弹出第二个空白屏幕。查看完应用程序后，点击 Xcode 中的停止按钮（位于你之前点击的播放按钮旁边）关闭它。当你停止应用时，你应该能在模拟器的主屏幕上看到你的应用图标！（参见图 9-12。）

就这些！我们现在需要配置第二个屏幕，以便它可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将它嵌入到一个导航控制器中。当视图控制器是模态时，它不会继承我们故事板上已经存在的导航控制器中的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器来选择它。然后，进入**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该能看到一个导航项已被添加到视图控制器场景下的提纲视图中。点击这个新添加的导航项，然后在属性检查器中添加标题**Add a Birthday**。这些步骤和你在给表格视图控制器添加“Birthdays”标题时所遵循的步骤相同。

现在，当“添加生日”视图控制器出现在应用中时，它将会在顶部标有标题。

#### 添加朋友的姓名和生日

当你在第十章中输入朋友的生日时，应用中的每一条记录将包括名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入所有这些信息。输入控件是一些允许用户在应用中输入数据的组件，如文本框或下拉菜单。我们将从为所有用户可以添加的信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个标签，上面写着“First Name”。这个标签将放在一个文本字段旁边，用户可以在这里输入朋友们的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在我们希望使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以 *点* 为单位。请注意，1 点不等于 1 像素。根据你的应用程序运行的设备类型，1 点将转换为 1 像素、一个 2×2 像素的方块或一个 3×3 像素的方块。这三种比例因子分别被称为 @1x、@2x 和 @3x（这也是我们在设置应用程序图标时讨论过的大小）。设备的点分辨率也不完全相同，可以从 320 到 1,024 点宽、从 568 到 1,366 点高不等。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最早的 iPhone 和 iPod 型号使用 @1x 比例因子，并且你将无法在这些型号上运行你的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们使用的是 @2x 比例因子。

对象在屏幕上的位置也是基于点来计算的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（见 图 9-15 。）我们将设置每个添加到视图控制器中的库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕的边缘之外，但仍然留出足够的空间用于文本输入框以及其他标签和输入框。在大小检查器的视图部分，设置 x 位置为 20，y 位置为 100，宽度为 100。将高度保留为 21。

完成此操作后，重复这些步骤，在“添加生日”视图控制器中再添加两个标签：一个是 Last Name 标签，一个是 Birthdate 标签。我们需要设置其他标签和输入框的位置，以避免它们重叠。在某些情况下，这可能会变得棘手，并且需要一些时间。对于这个应用程序，我们已经为你计算出了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何使应用程序在其他设备上也能正常工作。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x-位置相同，这样它们就能垂直对齐，但它们的 y-位置各不相同。每个标签的高度为 21，因此 y-位置至少需要比下一个标签高出 21 点。由于我们还要在每个标签下方添加输入控件，所以我们已经将 y-位置调大，以适应标签的高度和输入控件的高度。

很好！现在你的故事板应该像图 9-16 中的那样。

![图片](img/Image00214.jpg)

*图 9-16：已将输入标签添加到视图控制器中。*

接下来你需要添加两个*文本框*，它们将允许你输入名字和姓氏。文本框是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以在文本框中输入一行文字。

##### 添加文本框

从对象库中拖动两个文本框对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。给这两个文本框设置在表 9-2 中看到的尺寸和位置。你可以使用大小检查器，就像为标签做的一样。

表 9-2：视图控制器中输入框的文本框

| 文本框 | X-位置 | Y-位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个元素是一个叫做*日期选择器*的轮盘。它将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中使用的日期选择器一样（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器在日历应用中用于添加事件时选择日期。*

日期选择器也可以仅显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这也是我们在 BirthdayTracker 中将使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到视图控制器中的出生日期标签下方。使用大小检查器，将 x-位置设置为 0，y-位置设置为 280。

你将需要调整一些日期选择器的属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**而非日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将此日期更改为你的生日！将“日期”字段从“当前日期”更改为**自定义**。这样做时，会出现一个新框，修改此日期为你的生日。

让我们通过运行应用来测试目前的效果！我们为输入控件使用的大小在 iPhone 7 屏幕上合适。所以选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这一次，当你点击生日视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美契合。*

![Image](img/Image00218.jpg)

在 iPhone 7 上显示效果很好，但其他设备呢？选择一个较小的模拟器来运行应用，例如 iPhone 5s，然后再次运行应用。你会看到界面看起来有点不对劲。

你添加到故事板中的所有元素都会出现，但文本字段超出了屏幕的边缘。现在你已经把所有元素放到屏幕上，下一步是让它们在任何屏幕尺寸上都能正确显示。我们将通过一个叫做*自动布局*的工具来完成这一步。

#### 让你的应用在每个设备上都完美显示，使用自动布局

单独的 iPhone 就有三种不同的屏幕尺寸，而且未来可能会有更多尺寸。你需要设计应用，使其在任何设备上看起来都很合适。这意味着你需要让应用调整屏幕上所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的方式来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来打开自动布局菜单。*

在屏幕的故事板面板底部，有一个带图标的功能区，实用工具面板前面的最右侧图标是一个位于两条竖线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，内容为“解决自动布局问题”。点击此图标，弹出建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到一大堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局使日期选择器的大小适应屏幕宽度，并且不会超出屏幕边缘。自动布局还会确保每个文本字段前后有 20 点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行该应用。这次，添加生日的界面应该完美无缺。

#### 添加保存和取消按钮

为了完成设置，我们将向你展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。这些按钮目前不会做任何事。我们只是简单地进行设置。在第十章中，我们将添加一些代码，使得它们能够取消添加生日界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们之前设置添加按钮一样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将它放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像之前设置保存按钮一样。你的视图控制器应该看起来像图 9-21 中显示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新按钮的效果！

点击生日表视图控制器上的 + 按钮，应该会带你进入添加生日的视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前不会执行任何操作——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用，通过创建生日和添加生日界面的基本用户界面。你还使用表视图控制器创建了生日界面，并使用户能够通过“添加”按钮和导航控制器在界面之间进行切换。

现在你已经完成了应用的基本框架，在第十章中，你将编写取消和保存按钮的代码，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。![Image](img/Image00199.jpg)

*图 9-3：Xcode 项目窗口的结构*

左侧是导航器面板 ➊，你可以通过选择 **视图** ▸ **导航器** ▸ **隐藏/显示导航器** 或按 ⌘ -0 来隐藏或显示它。你将使用导航器选择和查看项目中的文件。

编辑器面板位于窗口的中间 ➋。这里是你编写代码的地方！也是你可以更改应用设置，并通过使用你在 第一章 中看到的故事板来布局应用中将要显示的项目的地方。我们很快将详细介绍故事板。

右侧是实用工具面板 ➌，你可以通过选择 **视图** ▸ **实用工具** ▸ **隐藏/显示实用工具** 或按 ⌘ -OPTION -0 来隐藏或显示它。当故事板打开时，实用工具面板将帮助你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都带有某种图标，显示在用户设备的主屏幕上。我们将通过添加应用图标来开始我们的 BirthdayTracker 应用。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图片。下载 ZIP 文件后，你将在 *下载* 文件夹中看到一个名为 *ch9-images* 的文件夹，里面有你需要的图像文件。获得这些文件后，在项目导航器中选择 *Assets.xcassets*。这将打开应用的 *资源目录*，在这里你可以放置任何应用将要使用的 *资源*（图片、声音等），包括应用图标。事实上，资源目录中已经有一个占位符，你可以将图标添加进去。从目录左侧的菜单中选择 **AppIcon**，你应该能看到多个图片的占位符。

要添加一个显示在 iPhone 主屏幕上的应用图标，你需要提供标为 *iPhone 应用* 的图标集的 2x 和 3x 图片。2x 尺寸适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸的图片。你将在 第十四章 中了解更多关于为不同屏幕分辨率调整图片大小的内容。

将图标添加到资源目录非常简单！下载提供的图片后，在 Finder 中打开你的 *下载* 文件夹。然后只需将图片 *cake@2x.png* 拖到 iPhone 应用的 2x 框中，再将 *cake@3x.png* 拖到 3x 框中。完成后，你的资源目录应当像 图 9-4 所示。

![Image](img/Image00200.jpg)

*图 9-4: 我们现在有了一个应用图标！*

除了应用图标，应用还拥有一个在主页图标下方显示的名称。默认情况下，这是应用名称，BirthdayTracker。然而，这个名称稍微有点长，无法完全显示在应用图标下方，因此让我们将它更改为一个更短的名称：Birthdays。为此，返回设置页面，选择项目导航器中的 BirthdayTracker 项目。在顶部的身份部分，你可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这将只更改显示在应用图标下的名称，项目名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，让我们来创建应用屏幕吧！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*，打开故事板。这是我们将设计应用*用户界面*的地方。用户界面是指用户将看到并用来与应用交互的所有内容——图像、文本、按钮等。*故事板*让你能够直观地组织应用的各个屏幕。我们将使用故事板查看所有使用的屏幕以及它们之间的连接。

选中*Main.storyboard*后，通过按 ⌘ -0 隐藏导航面板，以便腾出更多屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在看一下工具面板的顶部。你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，这些检查器是帮助你仔细查看故事板元素并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它会出现在工具面板中。

**检查故事板项目**

图 9-5 显示了当故事板打开时，工具面板中出现的检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：你可以在故事板的工具面板中使用六个检查器。*

让我们从左到右查看各个检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书和大多数应用中，你不会使用这个检查器。

下一个检查器，由一个问号图标表示，是快速帮助检查器。这个检查器会给你关于你当前在故事板中选择的项目的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里，你可以为故事板项目设置自定义类。

接下来的两个检查器是你在故事板工作时最常使用的，我们将在文本中频繁提到它们。属性检查器的图标看起来像一个盾牌。这个检查器用于设置故事板中选中项的各种属性。它可以用来设置标签的文本、按钮的颜色，或者显示在文本输入框周围的框类型等。大小检查器，图标是一个尺子，用于设置每个故事板项目的大小和屏幕位置。

最后，还有连接检查器，图标看起来像一个箭头在圆圈中。这个检查器可以用来将故事板中的项目与您在类中编写的代码连接起来。我们将在第十章中教你如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊的视图控制器类，用于显示一个列表，在 Xcode 中称为*表格视图控制器*。在我们的应用中，表格视图控制器将显示你的朋友们的生日列表！现在它看起来只是一个空白屏幕，你将在“创建生日表格视图控制器”中学习如何在第 156 页上显示生日数据。

让我们将表格视图控制器添加到故事板中。如果你先将故事板缩小，这一步会更容易，这样你可以更清楚地看到视图控制器。双击故事板中视图控制器外的空白区域来缩小。现在你的屏幕应该已经缩小了。

在实用工具窗格的底部，有一个带有四个按钮的区域。选择第三个按钮，看起来像是一个圆圈中的方块。这是对象库，在这里你可以找到可以添加到故事板中的项目。滚动浏览对象库列表，直到你找到表格视图控制器，或者使用窗格底部的筛选栏搜索“table view controller”。然后点击并拖动该对象到你的故事板中，放置在已经存在的视图控制器旁边。你的故事板应该和图 9-6 一样。

请注意，在你添加了表格视图控制器后，左侧的轮廓视图中会出现一个“表格视图控制器场景”条目，并且其中会有一个表格视图控制器。故事板中的场景代表了应用程序中的一个屏幕区域。在 iPhone 应用程序中，通常每次屏幕上只显示一个场景，并且该场景会占满整个屏幕。而在 iPad 应用程序中，屏幕上可以同时显示两个或更多的场景。

![图片](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到生日屏幕的故事板中*

下一步是让这个新视图控制器成为运行应用时首先显示的屏幕，因为我们希望用户打开应用时看到生日列表。实现这一点的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊ 。然后在工具区调出属性检查器 ➋ 。在这里，勾选**是初始视图控制器** ➌ 。完成此操作后，表格视图控制器左侧应该会出现一个箭头。该箭头表示应用程序启动时会显示此视图控制器。

#### 添加导航控制器

接下来，我们将给视图控制器添加一个标题“Birthdays”（生日），并添加一个“添加”按钮，点击后会弹出“添加生日”视图控制器。为此，我们首先将表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器，并配有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧放置按钮，用于导航到应用程序中的其他屏幕。你可以在多个 iOS 应用中看到这种导航栏，例如“设置”应用和“信息”应用。

在大纲视图中选择**表格视图控制器**。选中后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。路径是：**编辑** ▸ **嵌入** ▸ **导航控制器**。

将表格视图控制器嵌入到导航控制器后，您的故事板应该像图 9-8 中显示的那样。导航控制器将作为一个屏幕出现在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

每个故事板中的视图控制器代表一个用户将看到的屏幕，但导航控制器则有所不同。尽管它在故事板中看起来像是一个独立的屏幕，实际上导航控制器只是一个容器，用来容纳用户在应用中移动的其他视图控制器。将视图控制器嵌入到导航控制器中，意味着你的应用能够从一个视图跳转到另一个视图并返回。

你应该会看到导航控制器和表视图控制器顶部有灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们所在屏幕的标题，并可能包含按钮和箭头，供他们前往其他屏幕。为了使用导航栏告知用户他们所处的屏幕，我们需要给屏幕命名。现在是重新放大故事板视图的好时机。双击故事板空白处以放大视图，然后滚动视图，直到你能看到表视图控制器。要为表视图控制器添加标题，请点击大纲视图中**表视图控制器场景**下的**导航项**。

![Image](img/Image00205.jpg)

选择此项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。完成此步骤并按下 RETURN 键后，你应该看到大纲视图中的表视图控制器场景条目自动更新为“生日场景”。

接下来，我们将创建一个添加按钮，让你可以添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并向该列表添加一个生日。让我们创建一个按钮，允许他们执行这个操作！

我们需要在导航栏上添加一个按钮，连接到“添加生日”场景，以便用户能够输入生日。在对象库中找到工具栏按钮项，然后将其拖动并放置到表视图控制器的导航栏右侧，如图 9-9 所示。

现在我们想将这个按钮变成一个添加按钮。幸运的是，Xcode 提供了一个内置的添加按钮可以使用。在属性检查器中，将工具栏按钮项的“系统项”更改为**添加**。你应该会看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮点击时应该执行什么操作。我们希望它能打开“添加生日”视图控制器，因此我们需要将添加按钮连接到该视图控制器。首先，双击故事板缩小视图，确保你能看到生日表视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，并从加号按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时，松开鼠标。这时会弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个工具栏按钮项拖到生日视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在出现的对话框中选择“模态呈现”。*

连接对话框为你提供了多个选项，用于选择两视图控制器之间的 *segue*——即从一个屏幕到下一个屏幕的过渡。点击连接对话框中的 **Present Modally** 选项。这将使视图控制器作为 *模态* 视图控制器显示在屏幕上。在 iPhone 上，模态视图控制器从手机底部进入屏幕，并且不会自动附带返回按钮来返回到前一个屏幕。相反，模态视图可以包含其他按钮，如取消或保存。还有其他类型的 segue，例如 Show segue，它将视图控制器从右侧推入屏幕，并在导航栏的左侧显示返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，应该将该屏幕作为模态视图展示，并包含一个取消按钮。否则，如果你使用类似“Show”类型的跳转，并且有返回按钮，可能会发生用户输入了所有内容后，却点击返回按钮而没有保存任何东西的情况！而如果有取消按钮，用户必须有意识地点击取消，才能退出此屏幕。

想看一个模态输入视图控制器的好例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏的右侧有一个 + 按钮，你可以点击它添加日历事件。点击 + 按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下取消屏幕，右侧有一个添加按钮，可以在关闭模态视图之前创建新事件。你应该注意到，新的事件模态视图是从底部进入屏幕的，关闭时又会从屏幕底部滑下。我们希望用户能保存生日，因此我们也将使用模态视图。

现在让我们尝试运行我们的应用程序，看看我们目前为止做了什么！要运行应用程序，首先点击 Xcode 左上角的设备列表，选择一个设备模拟器（见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：将模拟器运行的设备设置在 Xcode 窗口左上角，紧挨着应用名称的位置。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表供你选择用于运行应用程序的设备。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用程序时，如果它太大而无法适应你的电脑屏幕，你可以调整其大小。点击模拟器以选择它，然后转到 **Window** ▸ **Scale**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时并不会发生太多事情。你应该能看到你的第一个“生日”屏幕，并且有一个+按钮，如图 9-1 所示。显然，在这个阶段，你的“生日”屏幕是空的。点击+按钮会弹出第二个空白屏幕。浏览完应用后，点击 Xcode 中的停止按钮关闭应用，它就在你之前点击的播放按钮旁边。当你停止应用时，你现在应该能在模拟器的主屏幕上看到你的应用图标！(见图 9-12。)

就是这样！我们现在需要配置第二个屏幕，使其能够用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到一个独立的导航控制器中。当视图控制器是模态视图时，它不会继承我们故事板中已有的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中点击选中普通视图控制器。然后前往**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该能看到一个导航项已经添加到视图控制器场景下的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤和你之前为表格视图控制器添加标题“生日”时一样。

现在，当“添加生日”视图控制器出现在应用中时，它的顶部会显示标题标签。

#### 添加朋友的名字和生日

当你在第十章中输入朋友们的生日时，你的应用中每一条记录都会包含一个名字、一个姓氏和一个生日日期。让我们在“添加生日”视图控制器中添加一些*输入控件*，这样用户就可以为每个人输入所有这些信息。输入控件是像文本框或下拉菜单这样的控件，允许用户在应用中输入数据。我们将从为所有可供用户添加的信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“名字”的标签。这个标签将位于一个文本框旁边，用户可以在其中输入朋友们的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框，输入**名字**作为显示文本，如图 9-14 所示。

现在我们要使用尺寸检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以 *点* 为单位的。请注意，1 点不等于 1 像素。根据你的应用运行的设备类型，1 点将转换为 1 像素、2×2 像素的正方形，或者 3×3 像素的正方形。这三个缩放因子被称为 @1x、@2x 和 @3x（这些就是我们在设置应用图标时讨论的大小）。设备的点分辨率也不是完全相同的，宽度可以从 320 点到 1,024 点不等，高度可以从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：制作标签显示* 姓名

只有最旧款的 iPhone 和 iPod 使用 @1x 的缩放因子，并且你将无法在这些型号上运行你的应用（BirthdayTracker 只支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus（它们使用 @3x 缩放因子），否则你的设备可能会使用 @2x 缩放因子。

一个对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15）我们将设置每个添加到视图控制器中的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕的边缘之外，但仍然为其文本输入框和其他标签及输入框留出足够的空间。在尺寸检查器的“视图”部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成这一步后，重复这些步骤，为“添加生日”视图控制器添加两个标签：一个是姓氏标签，另一个是出生日期标签。我们需要调整其他标签和输入框的位置，以避免它们重叠。在某些情况下，这可能会变得有些复杂，并且需要一些时间。对于这个应用，我们已经为你计算出了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何使你的应用适配其他设备。表 9-1 列出了你应该给每个标签设置的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，以便它们垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置需要比下一个最接近的标签大至少 21 个点。由于我们也将在每个标签下方添加输入控件，所以我们将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

太棒了！现在你的故事板应该和图 9-16 中的一样。

![Image](img/Image00214.jpg)

*图 9-16：输入框的标签已添加到视图控制器中。*

接下来你将添加两个*文本字段*，用于输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段的尺寸和位置设置为表 9-2 中所示的值。你可以使用大小检查器来完成这一步，就像你为标签做的一样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加一个叫做*日期选择器*的轮子。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，使用日期选择器进行日期选择。*

日期选择器也可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这就是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动直到找到日期选择器，然后点击并拖动它到视图控制器中的出生日期标签下方。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器进行选择。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器会显示当前日期。让我们将这个日期改为您的生日！将日期字段从“当前日期”更改为**自定义**。这样做后，会出现一个新框，您可以将日期更改为您的生日。

让我们通过运行应用程序来测试它目前的表现！我们为输入控件使用的尺寸在 iPhone 7 屏幕上很合适。因此，选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这次，当您在“生日”视图控制器上点击+按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

这个布局在 iPhone 7 上看起来很棒，但在其他设备上怎么样呢？选择一个较小的模拟器来运行该应用，比如 iPhone 5s，然后再次运行应用。您会看到一些地方看起来不太对劲。

您添加到故事板中的所有元素都会显示，但文本框超出了屏幕的边缘。现在所有元素都已显示在屏幕上，接下来的步骤是使它们能够正确适应任何屏幕尺寸。我们将使用一个叫做*自动布局*的工具来完成这项任务。

#### 通过自动布局使您的应用在每个设备上都完美显示

iPhone 单独就有三种不同的屏幕尺寸，而且未来可能还会有更多尺寸。您需要设计应用程序，使其在任何设备上看起来都很不错。这意味着，您希望应用能够根据运行它的设备调整应用内所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来安排屏幕上的元素。您需要在故事板中添加这些约束。

首先，在左侧面板的概览视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕的故事板窗格底部有一条带有图标的工具栏，靠近“实用工具”窗格的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标悬停在该图标上时，应该会显示一个标签，标明“解决自动布局问题”。点击此图标，您将看到一系列建议。点击**添加缺失的约束**。^(*) 这样做后，您会看到许多布局约束已添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确地适应屏幕。例如，自动布局会确保日期选择器的宽度适应屏幕的宽度，不会超出边缘。自动布局还会确保每个文本字段前后都有 20 个点，以便它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，添加生日的界面应该看起来完美。

#### 添加保存和取消按钮

最后，我们将向你展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。这些按钮目前还不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够退出添加生日界面并将生日保存到应用中。

要添加保存按钮，从对象库拖动一个 Bar Button Item，并将其放置在导航栏的*右侧*。我们将把这个按钮改成一个保存按钮，就像我们之前做的添加按钮一样。选择该按钮项，然后使用属性检查器将其改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，这次将它放置在导航栏的*左侧*。使用属性检查器将其改为取消按钮，就像你之前设置保存按钮一样。你的视图控制器应该看起来像图 9-21 所示。

![图片](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新的按钮！

点击生日表视图控制器上的+按钮，应该会带你进入添加生日的视图控制器，在那里你可以输入人的名字和生日。点击取消和保存按钮目前不会执行任何操作——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你通过创建生日和添加生日界面的基本用户界面，开始制作一个 BirthdayTracker 应用。你还使用表视图控制器创建了生日界面，并使用户可以通过添加按钮和导航控制器在屏幕之间进行导航。

现在，你的应用基本框架已经完成，接下来你将花费第十章的时间来编程取消和保存按钮，以便在应用中添加和保存生日！

* 在某些版本的 Xcode 中，"Add Missing Constraints"选项被禁用。这是一个苹果的 bug。在这种情况下，选择**Reset to Missing Constraints**选项来添加缺失的约束。

*图 9-3：Xcode 项目窗口的结构*

左侧是导航窗格 ➊，你可以通过**视图** ▸ **导航器** ▸ **隐藏/显示导航器**或按⌘ -0 来隐藏或显示它。你将使用导航器来选择并查看项目中的文件。

编辑器面板位于窗口的中央 ➋ 。在这里，你将编写代码！这也是你可以通过故事板更改应用设置并布置将要在应用中显示的项目的地方，你在第一章中看到过它。我们很快会详细讲解故事板。

右侧是工具面板 ➌ ，你可以通过选择**视图** ▸ **工具** ▸ **隐藏/显示工具**或按⌘ -OPTION -0 来隐藏或显示它。当故事板打开时，工具面板可以让你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都有某种图标，显示在用户设备的主屏幕上。我们将通过添加应用图标来开始我们的 BirthdayTracker 应用。你可以从*[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)*下载我们将用于图标的两张图片。下载 ZIP 文件后，你将在*下载*文件夹中看到一个名为*ch9-images*的文件夹，里面包含了你需要的图片文件。获取这些文件后，从项目导航器中选择*Assets.xcassets*。这将打开应用的*资产目录*，你可以在其中放置任何应用将要使用的*资产*（图片、音频等），包括应用图标。实际上，资产目录已经有一个占位符，你可以在其中添加图标。从目录左侧的菜单中选择**AppIcon**，你应该能看到几个图片占位符。

要添加显示在 iPhone 主屏幕上的应用图标，你需要为标记为*iPhone App*的图标集提供 2x 和 3x 图像。2x 大小适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 大小的图像。你将在第十四章中学习如何根据不同的屏幕分辨率调整图像大小。

将图标添加到资产目录很简单！下载提供的图片后，在 Finder 中打开你的*下载*文件夹。然后只需将图片*cake@2x.png*拖到 iPhone App 2x 框中，将*cake@3x.png*拖到 3x 框中。完成后，你的资产目录应该看起来像图 9-4。

![图片](img/Image00200.jpg)

*图 9-4：我们现在有了一个应用图标！*

除了应用图标，应用还拥有一个显示名称，该名称会显示在首页图标下方。默认情况下，这个名称就是应用名称，BirthdayTracker。然而，这个名称有点长，无法完全显示在图标下方，所以我们将其更改为一个更短的名称：Birthdays。为此，通过在项目导航器中选择 BirthdayTracker 项目返回设置页面。在“身份”部分的顶部，你可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这只会更改显示在应用图标下方的名称。你的项目名称仍然是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，接下来让我们创建应用屏幕！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。这是我们设计应用程序*用户界面*的地方。用户界面是用户与应用程序互动时看到和使用的所有东西——图像、文本、按钮等等。*故事板*让你可以以可视化的方式组织应用程序的所有屏幕。我们将使用故事板查看所有使用的屏幕以及它们之间的连接。

一旦你选择了*Main.storyboard*，按下⌘ -0 隐藏导航面板，以便你有更多的屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在看看工具面板的顶部，你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是一些工具，帮助你更仔细地查看故事板中的元素，并允许你更改这些元素的设置。当你选择其中一个检查器时，它会出现在工具面板中。

**检查故事板项**

图 9-5 显示了在打开故事板时出现在工具面板中的检查器选择条的特写视图。

![图片](img/Image00201.jpg)

*图 9-5：你可以在故事板的工具面板中使用六个检查器。*

让我们从左到右浏览这些检查器。页面图标打开文件检查器。这是你可以更改故事板文件设置的地方。在本书中以及你大多数应用程序中，你不会使用这个检查器。

下一个检查器由一个问号图标表示，是快速帮助检查器。这个检查器将为你当前在故事板中选择的项提供详细的类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里，你可以为故事板项设置自定义类。

接下来的两个检查器是你在工作中最常用的，我们将在文本中经常提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置选中项的各种属性。例如，它可以用来设置标签的文本、按钮的颜色，或者文本输入框周围显示的框的类型。大小检查器带有一个尺子的图标，用于设置每个故事板项的大小和屏幕位置。

最后，是连接检查器，它的图标像一个圈中的箭头。这个检查器可以用于将故事板中的项与在类中编写的代码部分连接起来。我们将在第十章 中向你展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊的视图控制器类，用于显示列表，在 Xcode 中称为*表格视图控制器*。在我们的应用程序中，表格视图控制器将显示你的朋友们的生日！现在它看起来只是一个空白屏幕，你将在 “创建生日表格视图控制器” （第 156 页）中学习如何显示生日数据。

让我们将表格视图控制器添加到故事板中。如果你先缩小故事板，这一步会更容易，因为你可以更清楚地看到视图控制器。双击故事板中视图控制器外的空白区域来做到这一点。现在你的屏幕应该已经缩小了。

在工具区的底部，有一个包含四个按钮的区域，位于顶部。选择第三个按钮，它看起来像一个圆圈中的方块。这是对象库，你可以在这里找到要添加到故事板的项目。滚动对象库列表，直到找到表格视图控制器，或者使用面板底部的筛选条搜索“table view controller”。然后点击并拖动该对象到故事板上，放置在已经存在的视图控制器旁边。你的故事板应该看起来像图 9-6 中的样子。

请注意，在你添加表格视图控制器后，左侧的轮廓视图中会出现一个“表格视图控制器场景”条目，里面有一个表格视图控制器。故事板中的场景代表你应用程序中显示的一个屏幕区域。对于 iPhone 应用程序，通常一次只显示一个场景，且该场景填满整个屏幕。iPad 应用程序可以同时显示两个或更多场景。

![图片](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到生日屏幕的故事板中*

下一步是让这个新视图控制器成为运行应用程序时第一个显示的屏幕，因为我们希望在用户打开应用程序时显示生日列表。完成此操作的步骤如图 9-7 所示。

![图片](img/Image00203.jpg)

*图 9-7：在左侧的轮廓视图中选择表格视图控制器并将其设为初始视图控制器。*

首先，在轮廓视图中选择**表格视图控制器** ➊。然后在工具区中打开属性检查器 ➋。在那里，勾选**是初始视图控制器** ➌。完成此操作后，故事板中的表格视图控制器左侧会出现一个箭头。这个箭头表示应用程序在启动时会显示这个视图控制器。

#### 添加导航控制器

接下来，我们将为视图控制器添加一个标题“Birthdays”和一个“Add”按钮，点击该按钮会弹出添加生日的视图控制器。为此，我们将首先把表视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器，并且配有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且在左右两侧显示按钮，用户可以通过这些按钮在应用中导航到其他屏幕。你在多个 iOS 应用中看到的这个导航栏，如设置应用和信息应用，都是类似的。

在轮廓视图中选择**Table View Controller**。选择后，你需要使用 Xcode 菜单将表视图控制器嵌入到导航控制器中。前往**Editor** ▸ **Embed In** ▸ **Navigation Controller**。

在将表视图控制器嵌入到导航控制器后，你的故事板应该像图 9-8 中那样显示。导航控制器将作为一个屏幕出现在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表用户将在应用中看到的一个屏幕，但导航控制器则有所不同。尽管它看起来像是故事板中的一个独立屏幕，导航控制器实际上只是一个容器，存放着用户在应用中之间切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在不同的视图之间进行导航，并且可以返回。

你应该在导航控制器和表视图控制器的顶部看到灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能包含按钮和箭头，用户可以通过这些按钮和箭头进入其他屏幕。为了使用导航栏告诉用户他们当前所处的屏幕，我们需要为屏幕设置标题。现在是重新聚焦故事板的好时机。双击故事板的空白区域进行放大，然后滚动视图，直到你可以看到表视图控制器。要为表视图控制器添加标题，请在左侧的轮廓视图中点击**Navigation Item**，该项位于**Table View Controller Scene**下。

![Image](img/Image00205.jpg)

选择此项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。你应该会看到，在完成此步骤并按下 RETURN 后，轮廓视图中的 Table View Controller Scene 条目会自动更新为“Birthdays Scene”。

接下来，我们将制作一个“Add”按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并向列表中添加一个生日。让我们做一个按钮，允许他们这么做！

我们需要在导航栏中添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。首先，在对象库中找到“Bar Button Item”，然后将其拖放到表视图控制器的导航栏右侧，如图 9-9 所示。

现在，我们想将这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮。打开属性检查器，将“bar button item”的系统项改为**添加**。你应该看到按钮变成了一个加号 (+)。

接下来，我们需要告诉按钮点击时该做什么。我们希望它能打开“添加生日”视图控制器，因此需要将“添加”按钮与该视图控制器连接起来。首先，双击 storyboard 以缩小视图，确保你能够看到“生日”表视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，并将 + 按钮从 storyboard 中拖到右侧空白视图控制器的中间。当视图控制器高亮显示时松开鼠标。这样就会弹出一个连接对话框，如图 9-10 所示。

![图片](img/Image00206.jpg)

*图 9-9：将 Bar Button Item 拖到“生日”视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在出现的对话框中选择“以模态方式呈现”。*

连接对话框为你提供了多个选项来选择你想在两个视图控制器之间创建的*segue*类型——即从一个屏幕到下一个屏幕的过渡。点击连接对话框中的**以模态方式呈现**选项。这会让视图控制器以*模态*视图控制器的形式呈现在屏幕上。在 iPhone 上，模态视图控制器从屏幕底部滑入，且不会自动带有返回按钮返回到上一个屏幕。相反，模态视图可以有其他按钮，如取消或保存。还有其他类型的 segue，比如 Show segue，其中视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你呈现一个用于获取和保存用户输入的屏幕时，该屏幕应该以模态方式显示，并带有取消按钮。否则，如果你使用类似于 Show segue 这样带有返回按钮的方式，用户可能会输入所有内容后点击返回按钮而不保存任何东西！使用取消按钮后，用户必须有意识地点击取消按钮才能退出屏幕。

要查看一个良好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，你会看到导航栏右侧有一个 + 按钮，你可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以取消退出当前屏幕而不保存，右侧有一个添加按钮，在关闭模态窗口之前创建新的事件。你应该看到新事件模态窗口是从屏幕底部滑上来的，关闭时又会向下滑去。我们希望用户能保存生日，因此我们也会使用模态窗口。

现在让我们尝试运行我们的应用，看看我们目前的进展！要运行应用，首先选择一个设备模拟器，通过点击 Xcode 左上角的 BirthdayTracker 旁边列出的设备（见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设备设置在应用名称旁边。这里，设备设置为 iPhone 7。*

这会弹出一个设备选项列表来运行你的应用。我们选择 iPhone 7。选择了模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果它的大小太大，无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器以选中它，然后进入 **窗口** ▸ **缩放**，在模拟器菜单中选择一个更小的缩放比例。

到目前为止，运行应用时不会发生太多事情。你应该能看到你第一个生日屏幕，上面有一个 + 按钮，正如之前在图 9-1 中所示。显然，在这一点上，你的生日屏幕会是空的。点击 + 按钮会弹出第二个空白屏幕。看完你的应用后，点击 Xcode 中的停止按钮关闭它，停止按钮就在你之前点击的播放按钮旁边。当你停止应用时，你应该会在模拟器的主屏幕上看到你的应用图标！（见图 9-12）。

就这样！现在我们需要配置第二个屏幕，以便它可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已经添加到主屏幕。*

### 设置控制输入和标签

我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，你需要将其嵌入到一个独立的导航控制器中。当一个视图控制器是模态的时，它不会继承我们情节提要中已有导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。点击情节提要中的视图控制器，选择该视图控制器，然后转到**编辑器** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该会看到一个新的导航项已添加到视图控制器场景下的提纲视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与当初为你的表格视图控制器添加“生日”标题时的步骤相同。

现在，当“添加生日”视图控制器出现在应用中时，它的顶部会显示标题标签。

#### 添加你朋友的姓名和生日

当你在第十章中输入你朋友的生日时，你的应用程序中的每一条记录将包含一个名字、一个姓氏和一个出生日期。我们来为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入所有这些信息。输入控件是指允许用户在应用程序中输入数据的控件，如文本框或下拉菜单。我们将从为用户可以添加的所有信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器做一个标签，显示“名字”。这个标签将位于一个文本框旁边，用户可以在其中输入朋友的名字。从对象库中找到并将一个标签对象拖到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器中。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框，并输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们想使用“大小检查器”来设置标签的大小和位置。在 Xcode 的情节提要中，宽度和高度是以*点*为单位进行测量的。注意，1 点不等于 1 像素。根据应用运行的设备类型，1 点可能等于 1 像素、2×2 像素的正方形或 3×3 像素的正方形。这三个缩放因子分别被称为@1x、@2x 和@3x（这与我们设置应用图标时提到的相同尺寸）。不同的设备也有不同的点分辨率，宽度可以从 320 到 1,024 点不等，高度可以从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最老款的 iPhone 和 iPod 使用 @1x 缩放因子，而你无法在这些型号上运行你的应用（BirthdayTracker 只支持 iOS 10+）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，否则你的手机或 iPod 很可能使用的是 @2x 缩放因子，而这些设备使用的是 @3x 缩放因子。

对象在屏幕上的位置也是基于点数的。对象的 x 坐标是从屏幕左侧到对象左侧的距离（单位：点）。y 坐标是从屏幕顶部到对象顶部的距离（见 图 9-15）。我们将设置每个我们添加到视图控制器中的库对象的 x 坐标和 y 坐标。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 坐标、y 坐标、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位在离屏幕边缘稍远的位置，但仍然为其文本输入框和其他标签及输入框留出足够的空间。在“大小检查器”的“视图”部分，将 x 坐标设置为 20，y 坐标设置为 100，宽度设置为 100，保持高度为 21。

完成这一步后，重复这些步骤，在“添加生日”视图控制器中再添加两个标签：一个是“姓氏”标签，另一个是“出生日期”标签。我们需要为其他标签和输入控件设置位置，以免它们重叠。在某些情况下，这可能会变得有些复杂，需要一些时间。对于这个应用，我们已经为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后我们会解释如何使你的应用适配其他设备。表 9-1 列出了你应为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 坐标相同，所以它们垂直对齐，但它们的 y 坐标各不相同。每个标签的高度为 21，因此 y 坐标需要至少比下一个标签高 21 点。由于我们还要在每个标签下方添加输入控件，我们将 y 坐标设置得更大，以适应标签的高度和输入控件的高度。

太棒了！现在你的故事板应该看起来像 图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：为输入项添加了标签到视图控制器中。*

接下来，你将添加两个 *文本字段*，用于输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在文本框中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段到视图控制器中。一个用来输入名字，另一个用来输入姓氏。按照表 9-2 中所示的大小和位置设置这两个文本字段。你可以使用大小检查器，就像设置标签一样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个叫做*日期选择器*的滚轮。这将使你能够轻松输入生日日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，允许用户选择日期或时间。它可以同时包含日期和时间，像在日历应用中使用的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用的日期选择器。*

日期选择器还可以仅显示时间，像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这正是我们在生日跟踪器中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并将其拖动到生日标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整一些日期选择器的属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：修改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将此日期更改为你的生日！将日期字段从当前日期更改为**自定义**。完成后，一个新框会出现。将日期更改为你的生日。

让我们通过运行应用程序来测试目前的效果！我们为输入控件设置的大小在 iPhone 7 屏幕上显示得很合适。所以，选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击生日视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但在其他设备上怎么样呢？选择一个较小的模拟器，比如 iPhone 5s，然后再次运行应用程序。你会看到界面显示得不太正常。

你在故事板中添加的所有元素都显示出来了，但是文本框的内容超出了屏幕的边缘。现在你已经将所有元素添加到屏幕上，下一步是确保它们能正确适配任何屏幕尺寸。我们将使用一个名为*自动布局*的工具来完成这项工作。

#### 让你的应用在每个设备上都看起来完美，使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会出现更多尺寸。你需要设计应用，以确保它在任何设备上都看起来很好。这意味着你需要让应用根据运行它的设备来调整应用中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来安排屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕故事板面板的底部，有一条带图标的工具栏，最右侧的图标是一个夹在两条垂直线之间的三角形。将鼠标光标悬停在这个图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击这个图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*) 这样做后，你会看到在“添加生日”场景中添加了一大堆布局约束。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局会确保日期选择器的宽度适应屏幕，不会超出边缘。自动布局还会确保每个文本框前后都有 20 个点的间距，使它们在屏幕上居中对齐。

现在，再次在 iPhone 5s 模拟器上运行应用。这次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

完成后，我们将展示如何在“添加生日”视图控制器的导航栏上添加取消和保存按钮。现在按钮还没有任何功能，我们只是进行初步设置。在第十章中，我们会添加一些代码，让按钮能够退出“添加生日”屏幕并保存生日到应用中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮变成一个保存按钮，就像我们之前做的“添加”按钮一样。选择按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，这次将其放置在导航栏的*左侧*。使用属性检查器将其转换为取消按钮，就像你为保存按钮做的那样。你的视图控制器应该像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在重新运行你的应用，看看新按钮的效果！

点击生日表视图控制器上的 + 按钮，应该会带你到添加生日视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前没有任何反应——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你通过创建“生日”和“添加生日”屏幕的基本用户界面，开始制作一个 BirthdayTracker 应用。你还使用表视图控制器创建了生日屏幕，并使用户能够通过“添加”按钮和导航控制器在屏幕之间切换。

现在你已经完成了应用的基本框架，第十章中你将编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日信息了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

左侧是导航器窗格 ➊ ，你可以通过选择**视图** ▸ **导航器** ▸ **隐藏/显示导航器**或按下⌘ -0 来隐藏或显示该窗格。你将使用导航器来选择并查看项目中的文件。

编辑器窗格位于窗口的中央 ➋ 。这里是你编写代码的地方！在这里，你也可以更改应用的设置，并使用故事板布局将在应用中显示的项目，你在第一章中已经看过故事板。我们很快会详细讲解故事板。

右侧是实用工具窗格 ➌ ，你可以通过选择**视图** ▸ **实用工具** ▸ **隐藏/显示实用工具**或按下⌘ -OPTION -0 来隐藏或显示该窗格。当故事板打开时，实用工具窗格将允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都配有某种图标，显示在用户设备的主屏幕上。我们将通过添加应用图标来开始我们的 BirthdayTracker 应用。您可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两个图像。下载 ZIP 文件后，您将在 *Downloads* 文件夹中看到一个名为 *ch9-images* 的文件夹，里面包含您需要的图像文件。获得这些文件后，从项目导航器中选择 *Assets.xcassets*。这将打开应用的 *资源目录*，在这里您可以放置应用将使用的任何 *资源*（图像、声音等），包括应用图标。实际上，资源目录已经提供了一个占位符，您可以在其中添加图标。从目录左侧的菜单中选择 **AppIcon**，您应该会看到几个图像的占位符。

要添加一个会显示在 iPhone 主屏幕上的应用图标，您需要提供 2x 和 3x 的图标图片集，标记为*iPhone 应用*。2x 大小适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，例如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 大小的图像。您将在第十四章中了解更多关于为不同屏幕分辨率调整图像大小的内容。

将图标添加到资源目录非常简单！下载提供的图像后，在 Finder 中打开您的 *Downloads* 文件夹。然后只需将图像 *cake@2x.png* 拖动到 iPhone 应用 2x 框中，将 *cake@3x.png* 拖动到 3x 框中。完成后，您的资源目录应该像图 9-4 一样。

![图片](img/Image00200.jpg)

*图 9-4：我们现在有了一个应用图标！*

除了应用图标外，应用还具有一个显示名称，会显示在主屏幕图标下方。默认情况下，这就是应用名称 BirthdayTracker。然而，这个名称有点太长，无法完全显示在图标下，所以我们将其更改为一个更短的名称：Birthdays。为此，请返回设置页面，在项目导航器中选择 BirthdayTracker 项目。在顶部的身份部分，您可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这将只更改显示在应用图标下方的名称。您的项目名称仍将是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，让我们来创建应用的界面！

### 显示你朋友的生日

从项目导航器中选择 *Main.storyboard* 打开故事板。这是我们设计应用 *用户界面* 的地方。用户界面只是一个 fancy 的名称，表示用户看到的并与之互动的元素——如图像、文本、按钮等。*故事板* 让您可以直观地组织应用的各个界面。我们将使用故事板来查看所有使用的界面以及它们之间的连接。

选中*Main.storyboard*后，按下⌘-0 隐藏导航窗格，以便有更多的屏幕空间。你的故事板应该已经包含一个视图控制器。

现在看看工具栏的顶部，你应该看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更仔细地查看故事板中的元素，并允许你更改这些元素设置的工具。当你选择一个检查器时，它会出现在工具栏中。

**检查故事板项目**

图 9-5 展示了故事板打开时，工具窗格中出现的检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：你可以在故事板的工具窗格中使用六个检查器。*

让我们从左到右浏览这些检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书中以及你大多数应用程序中，你不会使用这个检查器。

下一个检查器，标有问号图标，是快速帮助检查器。这个检查器将为你提供关于你当前在故事板中选中项的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里，你可以为故事板中的项目设置一个自定义类。

接下来的两个检查器是你在工作中最常用的两个，我们将在文本中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置故事板中选定项的各种属性。例如，它可以用于设置标签的文本、按钮的颜色，或者文本输入框周围显示的框的类型。尺寸检查器，带有尺子图标，用于设置每个故事板项的大小和屏幕位置。

最后是连接检查器，它的图标像一个圆圈中的箭头。这个检查器可以用于将故事板中的项目连接到你在类中编写的代码部分。我们将在第十章中向你展示如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊类型的视图控制器，它显示一个列表，在 Xcode 中称为*表格视图控制器*。在我们的应用程序中，表格视图控制器将显示你的朋友们的生日！现在它看起来只是一个空白屏幕，你将在“创建生日表格视图控制器”中学习如何在第 156 页显示生日数据。

让我们向故事板添加一个表视图控制器。如果你先将故事板缩小，这一步会更容易，因为这样可以更好地看到视图控制器。双击故事板中视图控制器外的空白区域来进行缩放。现在你的屏幕应该已经缩小了。

在“实用工具”面板的底部，有一个包含四个按钮的区域。选择第三个按钮，它看起来像一个圆圈中的方形图标。这个是对象库，在这里你可以找到可以添加到故事板中的元素。滚动浏览对象库列表，直到找到“表视图控制器”，或者使用面板底部的过滤栏搜索“table view controller”。然后点击并将该对象拖到你的故事板上，放置在已经存在的视图控制器旁边。你的故事板应该像图 9-6 一样。

注意，在你添加表视图控制器后，大纲视图左侧会出现一个“表视图控制器场景”条目，里面包含一个表视图控制器。故事板中的一个场景代表应用中的一个屏幕区域。对于 iPhone 应用，通常每次屏幕上只显示一个场景，并且该场景会占满整个屏幕。iPad 应用可以在屏幕上同时显示两个或更多的场景。

![图片](img/Image00202.jpg)

*图 9-6：将表视图控制器添加到用于“生日”屏幕的故事板中*

下一步是将这个新视图控制器设置为应用运行时首先显示的屏幕，因为我们希望用户打开应用时看到生日列表。完成此操作的步骤如图 9-7 所示。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图➊中选择**表视图控制器**。然后在“实用工具”面板中调出属性检查器➋。在这里，勾选**Is Initial View Controller**框➌。完成后，故事板中的表视图控制器左侧应该会出现一个箭头。这个箭头意味着应用首次启动时会显示此视图控制器。

#### 添加导航控制器

现在，我们将为视图控制器添加一个标题，内容为“生日”，并添加一个“添加”按钮，点击后会弹出“添加生日”视图控制器。为此，我们首先将表视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且在左右两侧有按钮，用于导航到应用中的其他屏幕。你在许多 iOS 应用中会看到这个栏，例如设置应用和信息应用。

在大纲视图中选择**Table View Controller**。选中后，你需要使用 Xcode 菜单将表视图控制器嵌入到导航控制器中。依次点击**Editor** ▸ **Embed In** ▸ **Navigation Controller**。

在将表视图控制器嵌入到导航控制器后，你的故事板应该看起来像图 9-8 中的样子。导航控制器将作为一个屏幕显示在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

在故事板中的每个视图控制器代表你应用中的一个屏幕，用户会在其中看到这些内容，但导航控制器略有不同。尽管它在故事板中看起来像一个单独的屏幕，导航控制器实际上只是一个容器，包含了用户在你的应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在一个视图和另一个视图之间进行导航并返回。

你应该会看到导航控制器和表视图控制器顶部的灰色导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，并可能包含用户用来进入其他屏幕的按钮和箭头。为了使用导航栏告诉用户他们在哪个屏幕，我们需要为屏幕命名。现在是时候再次放大查看故事板了。双击故事板的空白区域进行放大，然后滚动视图，直到你看到表视图控制器。为了为表视图控制器添加标题，点击大纲视图左侧的**Table View Controller Scene**下的**Navigation Item**。

![Image](img/Image00205.jpg)

选中后，你可以在右侧的属性检查器中输入屏幕标题。我们希望导航栏显示“Birthdays”作为标题，所以在右侧的“Title”字段中输入**Birthdays**。完成此步骤并按下 RETURN 后，你会看到大纲视图中的 Table View Controller Scene 条目自动更新为“Birthdays Scene”。

接下来，我们将创建一个“添加”按钮，以便你可以添加生日！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并向该列表添加一个生日。让我们创建一个按钮，让他们能够做到这一点！

我们需要在导航栏中添加一个按钮，链接到“添加生日”场景，以便用户可以输入一个生日。找到对象库中的“Bar Button Item”，然后将其拖放到表视图控制器的导航栏右侧，如图 9-9 所示。

现在我们想将这个按钮变成“添加”按钮。幸运的是，Xcode 内置了一个我们可以使用的“添加”按钮。在属性检查器中，将该按钮的“System Item”属性更改为**Add**。你应该会看到按钮变成一个加号 (+)。

接下来，我们需要告诉按钮点击时该做什么。我们希望它打开“添加生日”视图控制器，因此需要将“添加”按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你可以看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时，松开鼠标。这样会弹出一个连接对话框，类似于图 9-10。

![Image](img/Image00206.jpg)

*图 9-9：将条形按钮项拖动到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在出现的对话框中选择“模态呈现”。*

连接对话框为你提供了几种选择，来决定你希望在两个视图控制器之间进行哪种*过渡*—从一个屏幕到下一个屏幕的过渡。点击连接对话框中的**模态呈现**选项。这将使视图控制器以*模态*视图控制器的形式显示在屏幕上。在 iPhone 上，模态视图控制器从手机的底部出现，并且默认不会带有返回按钮来返回到上一个屏幕。相反，模态视图控制器可以有其他按钮，例如取消或保存。还有其他类型的过渡，例如“显示”过渡，它将视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，屏幕应该作为模态视图显示，并带有一个取消按钮。否则，如果你使用类似“显示”过渡且带有返回按钮，可能会出现这样的情况：用户输入了所有信息后，点击返回按钮，却没有保存任何内容！带有取消按钮的模态视图会迫使用户明确点击取消，从而退出当前屏幕。

要查看一个模态输入视图控制器的良好示例，请查看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏的右侧有一个 + 按钮，点击该按钮可以添加一个日历事件。点击 + 按钮会弹出一个模态的“新建事件”视图控制器。这个视图控制器的左侧有一个取消按钮，可以在不保存的情况下退出当前屏幕；右侧有一个添加按钮，可以在关闭模态视图前创建新事件。你会看到新建事件模态视图从底部出现，关闭时又返回底部。我们希望用户保存生日，因此我们也将使用模态视图。

现在让我们尝试运行应用，看看到目前为止我们做了什么！要运行应用，首先通过点击 Xcode 左上角“BirthdayTracker”旁边的设备列表，选择一个设备模拟器（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器运行的设备，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用键盘快捷键⌘ -**R**。

当模拟器打开并运行你的应用时，如果它太大，无法适应你的计算机屏幕，你可以调整其大小。点击模拟器进行选择，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时，几乎没有任何变化。你应该看到你第一个“生日”屏幕，里面有一个“+”按钮，如之前在图 9-1 中所示。显然，这时你的“生日”屏幕会是空的。点击“+”按钮会弹出第二个空白屏幕。当你查看完应用后，可以通过点击 Xcode 中的停止按钮来关闭它，停止按钮位于你之前点击的播放按钮旁边。停止应用后，你现在应该能在模拟器的主屏幕上看到你的应用图标！（参见图 9-12。）

就是这样！现在我们需要配置第二个屏幕，以便它可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，通过添加它的标题。为此，你需要将它嵌入到一个导航控制器中。当视图控制器是模态的时，它不会继承已经在我们的故事板上的导航控制器提供的导航栏。导航控制器提供了导航栏，所以我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击故事板中的普通视图控制器来选择它。然后，进入**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该会看到一个导航项已添加到视图控制器场景下的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤和你当时为表视图控制器添加“生日”标题时是相同的。

现在，当“添加生日”视图控制器出现在应用中时，它会在顶部显示标题。

#### 添加你朋友的名字和生日

当你在第十章中输入你朋友的生日时，应用程序中的每一条记录将包含一个名字、一个姓氏和一个生日。让我们在“添加生日”视图控制器中添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件是指文本框或下拉菜单等控件，允许用户在应用中输入数据。我们将从为用户可以添加的所有信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个显示“First Name”的标签。这个标签将位于一个文本框旁边，你将在其中输入朋友们的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在我们想使用大小检查器来设置标签的大小和位置。在 Xcode 故事板中，宽度和高度以*点*为单位来衡量。请注意，1 个点并不等于 1 个像素。根据应用运行的设备类型，1 个点将转换为 1 个像素、一个 2×2 像素的方块或一个 3×3 像素的方块。这三种缩放因子被称为@1x、@2x 和@3x（我们在设置应用图标时讨论过的相同尺寸）。设备的点分辨率也并不相同，宽度范围从 320 点到 1,024 点，高度范围从 568 点到 1,366 点。

![Image](img/Image00211.jpg)

*图 9-14：让标签显示* First Name

只有最老款的 iPhone 和 iPod 使用@1x 缩放因子，并且你无法在这些设备上运行你的应用（BirthdayTracker 将仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们很可能使用@2x 缩放因子，而这三款设备使用的是@3x 缩放因子。

对象在屏幕上的位置也是基于点来确定的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（见图 9-15）我们将设置每个我们添加到视图控制器的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置为不在屏幕的边缘，但仍然为其文本输入框和其他标签与输入框留出足够的空间。在大小检查器的视图部分，设置 x 位置为 20，y 位置为 100，宽度为 100，保持高度为 21。

完成这一步后，重复这些步骤，再添加两个标签到“添加生日”视图控制器：一个是姓氏标签，另一个是出生日期标签。我们需要调整其他标签和输入控件的位置，以免它们重叠。在某些情况下，这可能会变得棘手，并且可能需要一些时间。对于这个应用程序，我们已经为你计算了在 iPhone 7 屏幕上放置控件的位置。稍后，我们将解释如何让你的应用程序适配其他设备。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们在垂直方向上对齐，但每个标签的 y 位置不同。每个标签的高度是 21，因此 y 位置需要比下一个最近的标签高至少 21 个点。由于我们还将在每个标签下方添加输入控件，所以我们将 y 位置设得更大，以容纳标签的高度和输入控件的高度。

很棒！现在你的故事板应该像图 9-16 中的那样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器。*

接下来，你需要添加两个*文本字段*，它们允许你输入名字和姓氏。文本字段是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中将两个文本字段对象拖到你的视图控制器上。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段设置为表 9-2 中看到的尺寸和位置。你可以使用“尺寸检查器”来完成这一操作，就像你对标签做的那样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个称为*日期选择器*的轮子。这个控件可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用程序中用于让用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中使用的日期选择器一样（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这也是我们在生日追踪器中使用的功能。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到“生日”标签下的视图控制器中。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整一些日期选择器的属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将这个日期改为你的生日！将“日期”字段从“当前日期”更改为**自定义**。这样一个新框会出现，将其日期更改为你的生日。

让我们通过运行应用来测试它目前的工作情况！我们为输入控件设置的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你在生日视图控制器上点击 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备怎么样呢？选择一个较小的模拟器，比如 iPhone 5s，然后再次运行应用。你会发现有些地方看起来不太对。

你添加到故事板中的所有元素都已出现，但文本字段超出了屏幕边缘。现在你已经将所有元素添加到屏幕上，下一步是确保它们能够正确适配任何屏幕尺寸。我们将使用一个名为*自动布局*的工具来实现这一点。

#### 使用自动布局让你的应用在每个设备上看起来完美

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能会推出更多尺寸。你需要设计你的应用，以便它们在任何设备上看起来都不错。这意味着你需要确保应用能够根据设备自动调整屏幕上所有元素的位置和大小。自动布局使用一种名为*布局约束*的机制来安排屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕的故事板面板底部有一个带有图标的带状区域，在实用工具面板前的最右侧图标是一个夹在两条竖线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，上面写着“解决自动布局问题”。点击此图标以弹出建议菜单。点击**添加缺失的约束**。^(*) 这样，你会看到很多布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适应屏幕宽度，并不会超出边缘。自动布局还会确保每个文本字段前后都有 20 个点，使它们在屏幕上居中显示。

现在，在 iPhone 5s 模拟器上再次运行应用。这次，“添加生日”屏幕应该完美显示。

#### 添加保存和取消按钮

为了完成这一部分，我们将向你展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。按钮目前不会做任何事情，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消添加生日屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，和添加按钮一样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其更改为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新按钮的效果！

点击生日表格视图控制器中的+按钮应该会带你进入“添加生日”视图控制器，在这里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前没有任何效果——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你开始制作一个生日跟踪器应用，通过创建生日和添加生日屏幕的基本用户界面。你还使用表格视图控制器创建了生日屏幕，并让用户可以通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本框架，接下来你将在第十章中编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **重置为缺失约束** 选项以添加缺失的约束。

编辑器面板位于窗口的中央 ➋ 。这是你编写代码的地方！这里也是你可以更改应用设置并使用故事板布置应用中将显示的项目的地方，你在 第一章 中已经看到过这个内容。我们很快会详细讨论故事板。

右侧是工具面板 ➌ ，你可以通过选择 **视图** ▸ **工具** ▸ **隐藏/显示工具** 或按 ⌘ -OPTION -0 来隐藏或显示它。当故事板打开时，工具面板将帮助你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都带有某种图标，显示在用户设备的主屏幕上。我们将从为我们的 BirthdayTracker 应用添加一个应用图标开始。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图片。下载 ZIP 文件后，你会在 *下载* 文件夹中找到一个名为 *ch9-images* 的文件夹，里面有你需要的图像文件。获取这些文件后，选择项目导航器中的 *Assets.xcassets*。这将打开应用的 *资源目录*，你可以在其中放置应用要使用的任何 *资源*（如图像、声音等），包括应用图标。事实上，资源目录已经带有一个占位符，你可以在其中添加图标。选择目录左侧菜单中的 **AppIcon**，你应该会看到几个图像占位符。

要添加显示在 iPhone 主屏幕上的应用图标，你需要为名为 *iPhone App* 的图标集提供 2x 和 3x 图像。2x 尺寸适用于大多数 iPhone，如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸图像。你将在 第十四章 中了解更多关于为不同屏幕分辨率调整图像大小的内容。

将图标添加到资源目录非常简单！下载提供的图片后，打开 Finder 中的 *下载* 文件夹。然后，只需将图片 *cake@2x.png* 拖动到 iPhone App 2x 框中，将 *cake@3x.png* 拖动到 3x 框中。当你完成后，你的资源目录应如下所示：图 9-4。

![Image](img/Image00200.jpg)

*图 9-4：现在我们有一个应用图标了！*

除了应用程序图标，应用程序还有一个显示名称，显示在首页图标下方。默认情况下，这是应用程序名称 BirthdayTracker。然而，这个名称有点太长，无法在图标下方显示，因此我们将其更改为一个较短的名称：Birthdays。要进行此更改，返回设置页面，选择 BirthdayTracker 项目，在项目导航器中。然后在顶部的身份部分，你可以更改应用程序的显示名称。只需在显示名称文本框中输入**Birthdays**即可。这样只会更改显示在应用图标下的名称。你的项目名称仍然是 BirthdayTracker。

现在我们已经设置好了应用程序图标和显示名称，接下来让我们创建应用程序屏幕！

### 显示朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。这是我们将设计应用程序*用户界面*的地方。用户界面只是用户看到并用来与应用程序互动的各种元素的一个 Fancy 名称——例如图像、文本、按钮等等。*故事板*让你以视觉方式组织应用程序的各个屏幕。我们将使用故事板来查看所有的屏幕以及它们之间的连接。

选择了*Main.storyboard*后，按⌘ -0 隐藏导航面板，以便获得更多的屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在看看工具区顶部。你应该看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，这些检查器是帮助你更仔细查看故事板中元素并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它会出现在工具区中。

**检查故事板项**

图 9-5 显示了当打开故事板时，工具区中出现的检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：你可以在故事板的工具区使用六个检查器。*

让我们从左到右依次介绍这些检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书和你大多数的应用程序中，你不会使用这个检查器。

下一个检查器是由问号图标表示的快速帮助检查器。这个检查器会提供你当前在故事板中选择的项目的详细类信息。

第三个检查器，带有身份证图标的是身份检查器。在这里，你可以为故事板项设置自定义类。

接下来的两个检查器是你在工作中最常用的两个，我们将在文本中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置选定项的各种属性，比如设置标签的文本、按钮的颜色，或文本输入框周围显示的框类型等。大小检查器的图标像一个尺子，用于设置每个故事板项的大小和屏幕位置。

最后，是连接检查器，它的图标看起来像一个圆圈中的箭头。你可以用它将故事板中的项目与在类中编写的代码连接起来。我们将在第十章中展示如何进行操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊类型的视图控制器，用于显示列表，在 Xcode 中被称为*表视图控制器*。在我们的应用中，表视图控制器将显示你朋友们的生日列表！现在它看起来只是一个空白屏幕，你将在“创建生日表视图控制器”一节中学习如何显示生日数据，参考第 156 页。

让我们将表视图控制器添加到故事板中。如果你先从故事板中缩小视图，这个步骤会更容易，因为你可以更清楚地看到视图控制器。你可以通过双击视图控制器外部的空白区域来缩小视图。现在你的屏幕应该已被缩小。

在工具面板的底部，有一个包含四个按钮的部分。选择第三个按钮，看起来像是一个圈中的方框。这是对象库，在这里你可以找到要添加到故事板的项。滚动浏览对象库列表，直到你找到表视图控制器，或者使用面板底部的过滤栏搜索“table view controller”。然后将该对象点击并拖动到你的故事板上，放置在已经存在的视图控制器旁边。你的故事板应该看起来像图 9-6 中的那样。

注意，当你添加表视图控制器后，左侧大纲视图中会出现一个“表视图控制器场景”条目，其中包含一个表视图控制器。故事板中的场景代表应用中显示的屏幕区域。对于 iPhone 应用，通常每次屏幕上只有一个场景，并且该场景会填满整个屏幕。iPad 应用可以同时在屏幕上显示两个或更多场景。

![Image](img/Image00202.jpg)

*图 9-6：将表视图控制器添加到生日屏幕的故事板中*

下一步是将这个新视图控制器设为在您运行应用时首先出现的屏幕，因为我们希望用户打开应用时能够看到生日列表。执行这些步骤的操作如图 9-7 所示。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊ 。然后，在工具面板中调出属性检查器 ➋ 。在那里，勾选**是初始视图控制器** ➌ 。完成此操作后，您的表格视图控制器左侧应会出现一个箭头。这个箭头表示应用在启动时会显示此视图控制器。

#### 添加导航控制器

现在，我们将给视图控制器添加一个标题，名为“生日”，并添加一个“添加”按钮，点击该按钮将弹出“添加生日”视图控制器。为此，我们将首先把表格视图控制器放入一个*导航控制器* 中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧显示用于导航到应用其他屏幕的按钮。您在多个 iOS 应用中都能看到这个导航栏，例如“设置”应用和“信息”应用。

在大纲视图中选择**表格视图控制器**。选中后，您需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。请前往**编辑** ▸ **嵌入到** ▸ **导航控制器**。

将表格视图控制器嵌入到导航控制器后，您的故事板应该像图 9-8 中所示。导航控制器将在故事板中显示为一个屏幕。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表应用中用户将看到的一个屏幕，但导航控制器有点不同。尽管它在故事板中看起来像是一个独立的屏幕，实际上，导航控制器只是一个容器，用来容纳用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着您的应用可以在一个视图与另一个视图之间进行导航并返回。

您应该会看到导航控制器和表视图控制器顶部有灰色的导航栏。当应用程序运行时，导航栏告诉用户他们所在的屏幕标题，并且可能还包含他们可以用来跳转到其他屏幕的按钮和箭头。为了通过导航栏告诉用户他们所在的屏幕，我们需要为屏幕添加标题。现在是放大故事板的好时机。双击故事板的空白区域进行放大，然后滚动视图，使您可以看到表视图控制器。要为表视图控制器添加标题，请点击大纲视图中**Table View Controller Scene**下的**Navigation Item**。

![Image](img/Image00205.jpg)

选择此项后，您可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。完成此步骤并按下 RETURN 后，您应该会看到大纲视图中的 Table View Controller Scene 条目自动更新为 Birthdays Scene。

接下来，我们将创建一个添加按钮，您可以用它来添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并将生日添加到该列表中。让我们做一个按钮来实现这个功能！

我们需要向导航栏添加一个按钮，指向添加生日的场景，以便用户可以输入生日。在对象库中找到 Bar Button Item，然后将其拖放到表视图控制器导航栏的右侧，如图 9-9 所示。

现在我们想将这个按钮变成一个添加按钮。幸运的是，Xcode 内置了一个我们可以使用的添加按钮。在属性检查器中，将 Bar Button Item 的 System Item 更改为**Add**。您应该会看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮点击时要做什么。我们希望它打开添加生日的视图控制器，因此我们需要将添加按钮连接到该视图控制器。首先，双击故事板进行缩小，确保您可以看到 Birthdays 表视图控制器和最终将成为您的添加生日视图控制器的空白视图控制器。按住 CONTROL 键，从+按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标，这将弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar Button Item 拖动到 Birthdays 视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从 Add 按钮拖动到相邻的视图控制器，并在弹出的对话框中选择 Present Modally。*

连接对话框为你提供了多种*转场*选项——即从一个屏幕到另一个屏幕的过渡——你可以在两个视图控制器之间选择。点击连接对话框中的**模态展示**选项。这会使视图控制器作为*模态*视图控制器出现在屏幕上。在 iPhone 上，模态视图控制器从手机底部出现，并且默认没有返回按钮返回上一屏幕。相反，模态视图控制器可以有其他按钮，例如取消或保存。还有其他类型的转场，比如“显示”转场，视图控制器从右侧推入屏幕，且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的界面时，屏幕应该以模态方式显示，并带有取消按钮。否则，如果你使用类似“显示”转场并带有返回按钮，用户可能会在输入所有信息后点击返回按钮而没有保存任何内容！有了取消按钮，用户必须有意识地点击才能退出屏幕。

要查看一个好的模态输入视图控制器的示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏的右侧有一个+按钮，你可以点击它来添加一个日历事件。点击+按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以不保存地退出屏幕，右侧有一个添加按钮，可以在关闭模态之前创建新事件。你会看到新的事件模态视图从屏幕底部出现，关闭时又向下滑动。我们希望用户保存生日，所以我们也会使用模态视图。

现在，让我们尝试运行我们的应用，看看到目前为止我们做了些什么！要运行应用，首先在 Xcode 的左上角点击 BirthdayTracker 旁边列出的设备模拟器（参见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角，应用名称旁设置模拟器运行的设备。这里设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择的是 iPhone 7。在选择好模拟器后，点击左上角的播放按钮或使用快捷键⌘-**R**。

当模拟器打开并运行你的应用时，如果它的大小过大，无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器选择它，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个更小的缩放比例。

到目前为止，当你运行应用时，似乎没有发生太多事情。你应该会看到第一个生日屏幕，并且有一个+按钮，如图 9-1 中所示。显然，此时你的生日屏幕将是空的。点击+按钮将会出现第二个空白屏幕。当你查看完应用后，可以通过点击 Xcode 中的停止按钮来关闭它，这个按钮就在你之前按下的播放按钮旁边。当你停止应用时，你应该会看到应用图标出现在模拟器的主屏幕上！（见图 9-12）。

就这样！现在我们需要配置第二个屏幕，以便可以用来添加生日！

![图片](img/Image00209.jpg)

*图 9-12：生日追踪器应用图标已添加到主屏幕。*

### 设置控件输入和标签

让我们通过添加标题开始设计“添加生日”视图控制器。为此，你需要将它嵌入到自己的导航控制器中。当视图控制器是模态时，它不会继承已经在我们故事板上的导航控制器中的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过在故事板中点击视图控制器，选择它。然后进入 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在，你应该能在视图控制器场景下的概述视图中看到已添加了一个导航项。点击这个新导航项，然后在属性检查器中添加标题 **添加生日**。这些步骤和你在为表视图控制器添加标题“生日”时做的步骤相同。

现在，当“添加生日”视图控制器在应用中出现时，它将显示在顶部的标题。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友的生日时，你的应用中每个条目都会有名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，这样用户就能为每个人输入这些信息。输入控件是像文本框或下拉菜单这样的元素，它们允许用户在应用中输入数据。我们将从添加所有用户可以输入的信息的输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个显示“名字”的标签。这个标签将位于文本框旁边，用户可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在我们希望使用大小检查器设置标签的大小和位置。在 Xcode storyboard 中，宽度和高度以 *点* 为单位进行测量。请注意，1 个点并不等于 1 个像素。根据你的应用程序运行的设备类型，1 个点可能对应 1 个像素、2×2 像素的方块或 3×3 像素的方块。这三种缩放因子分别被称为 @1x、@2x 和 @3x（我们在设置应用图标时讨论过的相同尺寸）。设备的分辨率也不完全相同，点的宽度从 320 到 1,024 不等，高度从 568 到 1,366 不等。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，并且你无法在这些型号上运行你的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，这些设备使用 @3x 缩放因子，否则你的手机或 iPod 很可能使用 @2x 缩放因子。

对象在屏幕上的位置也是基于点数的。对象的 x 位置是从屏幕左侧到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15）。我们将设置每个库对象的 x 位置和 y 位置，并将它们添加到视图控制器中。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕边缘之外，但仍为其文本输入框和其他标签及输入框留出足够的空间。在大小检查器的视图部分中，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成这一步后，重复这些步骤，向“添加生日”视图控制器中添加两个标签：姓氏标签和生日标签。我们需要定位其他标签和输入框，以避免它们重叠。在某些情况下，这可能会变得复杂，且需要一些时间。对于这个应用程序，我们已经计算出了在 iPhone 7 屏幕上放置对象的位置。稍后我们将解释如何使你的应用在其他设备上运行。表 9-1 列出了你应该为每个标签设置的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| First Name | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，所以 y 位置必须至少比下一个标签大 21 个点。由于我们还要在每个标签下方添加输入控件，因此我们增加了 y 位置的值，以适应标签的高度和输入控件的高度。

太好了！现在你的故事板应该和图 9-16 中的样子一样。

![Image](img/Image00214.jpg)

*图 9-16：输入的标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们将让你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器上。一个用来输入名字，另一个用来输入姓氏。按照表 9-2 中的尺寸和位置设置这两个文本字段。你可以像设置标签一样，使用尺寸检查器来完成。

表 9-2：视图控制器中的文本字段输入

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个名为*日期选择器*的控件。这个控件可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像日历应用中的日期选择器一样（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到视图控制器中的出生日期标签下方。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的一些属性。点击日期选择器选中它。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。我们来把日期改成你的生日吧！将日期字段从“当前日期”改为**自定义**。当你这么做时，会出现一个新的框，修改日期为你的生日。

让我们通过运行应用来测试它目前的工作情况！我们为输入控件选择的大小非常适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你在生日视图控制器中点击 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美契合。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来很好，但其他设备呢？选择一个较小的模拟器运行应用，例如 iPhone 5s，然后重新运行应用。你会看到界面看起来不太对劲。

所有添加到故事板中的元素都出现了，但是文本框超出了屏幕的边缘。现在你已经将所有元素添加到屏幕上，下一步是确保它们能够在任何屏幕尺寸上正确显示。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 使用自动布局让你的应用在每个设备上看起来都完美

单单 iPhone 就有三种不同的屏幕尺寸，未来可能还会有更多尺寸。你需要设计你的应用，确保它在任何设备上都能看起来很好。这意味着你希望应用能够调整界面中所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的工具来将元素放置到屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器窗格右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部第四个图标，打开自动布局菜单。*

在屏幕故事板窗格的底部有一个带图标的条带，最右边的图标是在两个垂直线之间的一个三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击此图标以打开建议菜单。点击**添加缺失约束**。^(*)当你这么做时，你会看到一大堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小合适，能够正确显示在屏幕上。例如，自动布局会确保日期选择器的宽度适应屏幕并不会超出边界。自动布局还会确保每个文本字段前后有 20 个点的间隔，从而使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器中再次运行应用程序。这一次，添加生日页面应该完美显示。

#### 添加保存和取消按钮

为了完成任务，我们将展示如何为添加生日视图控制器的导航栏创建取消和保存按钮。按钮目前还不会执行任何操作，我们只是先设置它们。在第十章中，我们将添加一些代码，使它们可以取消添加生日页面并将生日信息保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们对添加按钮所做的那样。选中按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其转换为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该与图 9-21 中的示例相似。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新按钮的效果！

点击生日表格视图控制器上的+按钮，应该会带你进入添加生日视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前还没有任何反应——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你开始制作一个生日追踪器应用，通过创建生日和添加生日页面的基本用户界面。你还使用表格视图控制器创建了生日页面，并使用户能够通过添加按钮和导航控制器在页面间进行切换。

现在你已经完成了应用程序的基本框架，在第十章中，你将编写代码来实现取消和保存按钮，从而能够在应用中添加和保存生日信息！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是苹果的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

右侧是实用工具窗格 ➌，你可以通过选择**视图** ▸ **实用工具** ▸ **隐藏/显示实用工具**或按⌘ -OPTION -0 来隐藏或显示它。当故事板打开时，实用工具窗格将允许你配置应用中对象的大小和位置。

### 添加应用图标

大多数应用都有某种图标显示在用户设备的主屏幕上。我们将通过添加应用图标来开始我们的 BirthdayTracker 应用。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图片。下载 ZIP 文件后，你将在 *Downloads* 文件夹中找到名为 *ch9-images* 的文件夹，其中包含所需的图像文件。获取这些文件后，从项目导航器中选择 *Assets.xcassets*。这将打开应用程序的 *资产目录*，在这里你可以放置应用程序将使用的任何*资源*（如图像、声音等），包括应用图标。实际上，资产目录中已经有一个占位符，你可以在其中添加你的图标。选择左侧目录菜单中的**AppIcon**，你应该能看到几个图像占位符。

要添加一个将在 iPhone 主屏幕上显示的应用图标，你需要提供标记为*iPhone App*的图标集的 2x 和 3x 图像。2x 尺寸适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸的图像。你将在第十四章中了解更多关于不同屏幕分辨率下图像大小的内容。

将图标添加到资产目录非常简单！下载提供的图像后，在 Finder 中打开你的 *Downloads* 文件夹。然后，简单地将图像 *cake@2x.png* 拖到 iPhone App 2x 框中，将 *cake@3x.png* 拖到 3x 框中。完成后，你的资产目录应该像图 9-4 一样。

![Image](img/Image00200.jpg)

*图 9-4：现在我们有了一个应用图标！*

除了应用图标，应用还会有一个显示名称，显示在图标下方的主屏幕上。默认情况下，这个名称就是应用名称 BirthdayTracker。然而，这个名称有点太长，无法适应图标下方，所以我们将它改成一个更短的名称：Birthdays。为此，返回设置页面，选择项目导航器中的 BirthdayTracker 项目。在顶部的身份部分，你可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这将仅更改显示在应用图标下方的名称。你的项目名称仍然是 BirthdayTracker。

现在我们已经设置好了应用图标和显示名称，让我们来创建应用程序的屏幕吧！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。这里是我们设计应用程序*用户界面*的地方。用户界面只是用户将看到并用来与应用程序互动的事物的花哨名称——图像、文本、按钮等等。*故事板*让你以视觉方式组织应用程序的屏幕。我们将使用故事板来查看所有使用的屏幕及它们之间的连接。

一旦你选择了*Main.storyboard*，按下 ⌘-0 隐藏导航面板，以便为你提供更多的屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在看看实用工具面板的顶部。你应该会看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更仔细地查看故事板中元素并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它会出现在实用工具面板中。

**检查故事板项目**

图 9-5 显示了当故事板打开时，出现在实用工具面板中的检查器选择栏的特写。

![Image](img/Image00201.jpg)

*图 9-5：在故事板的实用工具面板中，你可以使用六个检查器。*

让我们从左到右依次了解这些检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书和你的大多数应用程序中，你不会使用这个检查器。

下一个检查器，用一个问号图标表示，是快速帮助检查器。这个检查器会提供你当前在故事板中选择的项目的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里，你可以为故事板项目设置自定义类。

接下来的两个检查器是你在故事板中最常用的检查器，我们将在文中经常提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置故事板中所选项目的各种属性。例如，它可以用来设置标签的文本、按钮的颜色，或文本输入框周围显示的框类型。尺寸检查器，带有尺子图标，用于设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，它的图标像一个圆圈中的箭头。这个检查器可以用来将你在故事板中的项目与在类中编写的代码连接起来。我们将在第十章中展示如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊的视图控制器类，显示一个列表，在 Xcode 中称为*表格视图控制器*。在我们的应用程序中，表格视图控制器将显示你朋友们的生日列表！现在它看起来只是一个空白的屏幕，你将在 “创建生日表格视图控制器” 中学习如何在 第 156 页 显示生日数据。

让我们将一个表视图控制器添加到故事板中。如果你先从故事板缩小视图，这一步会更容易，这样你可以更清楚地看到视图控制器。双击故事板中视图控制器外的空白区域即可实现此操作。现在，你的屏幕应该已经缩小了。

在“实用工具”面板的底部，有一部分包含四个按钮。选择第三个按钮，它看起来像一个圆圈中的方块。这是“对象库”，你可以在其中找到可以添加到故事板中的项。滚动浏览对象库列表，直到找到“表视图控制器”，或者使用面板底部的筛选栏搜索“table view controller”。然后将该对象点击并拖动到你的故事板上。将其直接放置在已存在的视图控制器旁边。你的故事板应当类似于图 9-6。

请注意，在添加表视图控制器后，大纲视图左侧会出现一个“表视图控制器场景”条目，内部包含一个表视图控制器。故事板中的场景代表应用程序中的一个屏幕区域。在 iPhone 应用中，通常每次屏幕上只显示一个场景，且该场景填充整个屏幕。iPad 应用则可以同时在屏幕上显示两个或更多场景。

![Image](img/Image00202.jpg)

*图 9-6：为“生日”屏幕将表视图控制器添加到故事板中*

下一步是将这个新的视图控制器设置为应用运行时首先出现的屏幕，因为我们希望在用户打开应用时显示生日列表。执行此操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表视图控制器** ➊。然后在“实用工具”面板中打开“属性检查器” ➋。在这里，勾选**是初始视图控制器** ➌。完成此操作后，表视图控制器左侧应会出现一条箭头。该箭头表示应用程序将在启动时显示此视图控制器。

#### 添加导航控制器

现在，我们将在视图控制器上添加一个标题，显示“生日”，并添加一个“添加”按钮，用于显示添加生日的视图控制器。为此，我们首先将表视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器，并配有*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并包含左右两侧的按钮，用于在应用程序中的其他屏幕之间导航。你可以在多个 iOS 应用中看到这个导航栏，例如设置应用和信息应用。

在轮廓视图中选择**Table View Controller**。选中后，你需要使用 Xcode 菜单将表视图控制器嵌入到导航控制器中。前往**Editor** ▸ **Embed In** ▸ **Navigation Controller**。

在表视图控制器嵌入到导航控制器后，你的故事板应类似于图 9-8 所示。导航控制器会作为一个屏幕显示在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表应用中用户将看到的一个屏幕，但导航控制器略有不同。尽管它在故事板中看起来像是一个单独的屏幕，实际上，导航控制器只是一个容器，保存着用户在应用中可以切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在不同的视图之间来回导航。

你应该能在导航控制器和表视图控制器的顶部看到灰色的导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能还包含按钮和箭头，供他们跳转到其他屏幕。为了使用导航栏告知用户当前所在的屏幕，我们需要为屏幕命名。现在是重新聚焦故事板的好时机。双击故事板的空白处进行放大，然后滚动视图，直到你可以看到表视图控制器。要为表视图控制器添加标题，在左侧轮廓视图中点击**Table View Controller Scene**下的**Navigation Item**。

![Image](img/Image00205.jpg)

选择此项后，你可以在右侧的属性检查器中输入屏幕的标题。我们希望导航栏显示“Birthdays”作为标题，所以在右侧的标题字段中输入**Birthdays**。你应该会看到，在完成这一步并按下 RETURN 键后，轮廓视图中的“Table View Controller Scene”条目会自动更新为“Birthdays Scene”。

接下来，我们将创建一个“添加”按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将生日添加到列表中。让我们创建一个按钮，让他们实现这一操作！

我们需要向导航栏添加一个按钮，跳转到“添加生日”场景，让用户输入生日。找到对象库中的“Bar Button Item”，然后将其拖放到表视图控制器导航栏的右侧，如图 9-9 所示。

现在我们想将这个按钮变成“添加”按钮。幸运的是，Xcode 提供了一个内建的“添加”按钮可供使用。在属性检查器中，将该按钮的系统项更改为**Add**。你应该会看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在被点击时该做什么。我们希望它能打开“添加生日”视图控制器，所以我们需要将添加按钮与该视图控制器连接。首先，双击故事板以缩小视图，确保你能看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从+按钮拖动到故事板右侧的空白视图控制器的中间。当视图控制器被高亮显示时，松开鼠标。这样会弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个条形按钮项拖到生日视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态展示”。*

连接对话框提供了几种不同类型的*segue*——从一个屏幕到下一个屏幕的过渡效果——供你选择。在连接对话框中，点击**模态展示**选项。这将使视图控制器作为*模态*视图控制器展示在屏幕上。在 iPhone 上，模态视图控制器从屏幕底部进入，并且不会自动带有返回按钮返回到上一个屏幕。相反，模态视图可以有其他按钮，如取消或保存。还有其他类型的 segue，例如“显示”segue，其中视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，这个屏幕应以模态方式显示，并且带有一个取消按钮。否则，如果你使用类似“显示”segue 和返回按钮的方式，就可能出现用户输入完所有内容后点击返回按钮，导致没有保存任何信息的情况！而有了取消按钮，用户必须故意点击以取消该屏幕。

要查看模态输入视图控制器的一个好例子，可以看看你 iPhone 或 iPad 上的日历应用。打开应用后，导航栏右侧有一个+按钮，点击它可以添加一个日历事件。点击+按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，点击它可以退出屏幕而不保存，右侧有一个添加按钮，可以在关闭模态视图之前创建新事件。你会看到“新事件”模态视图从屏幕底部进入，关闭时又从屏幕底部消失。我们希望用户保存生日，所以我们也会使用模态视图。

现在，让我们试着运行我们的应用，看看我们到目前为止完成了什么！首先，选择一个设备模拟器，方法是在 Xcode 左上角的 BirthdayTracker 旁边点击设备列表（见 图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，点击应用程序名称旁边的设备设置按钮，将模拟器运行的设备设置为 iPhone 7。*

这将弹出一份设备选项列表，用于运行你的应用程序。我们选择了 iPhone 7。在选择好模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R**。

当模拟器打开并运行应用时，如果它太大，无法适应你的电脑屏幕，你可以调整其大小。点击模拟器选中它，然后转到 **Window** ▸ **Scale**，在模拟器菜单中选择较小的比例。

到目前为止，运行应用时并不会发生太多变化。你应该能看到你的第一个生日屏幕，上面有一个 + 按钮，如前面在 图 9-1 中所示。显然，在此时，你的生日屏幕是空的。点击 + 按钮会弹出第二个空白屏幕。看完应用后，点击 Xcode 中的停止按钮（位于你之前点击的播放按钮旁边）来关闭应用。当你停止应用后，应该可以在模拟器的主屏幕上看到你的应用图标！（见 图 9-12）

就这样！现在我们需要配置第二个屏幕，使其能够用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计添加生日视图控制器，首先为其添加标题。为此，你需要将它嵌入到一个自己的导航控制器中。当视图控制器为模态时，它不会继承已经在故事板上的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中点击选中普通视图控制器。然后，选择 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在，你应该会看到一个导航项已被添加到视图控制器场景下的概览视图中。点击这个新添加的导航项，然后在属性检查器中为其添加标题 **Add a Birthday**。这些步骤和你之前为表格视图控制器添加标题“Birthdays”时相同。

现在，当应用中出现添加生日视图控制器时，顶部将显示其标题标签。

#### 添加朋友的姓名和生日

当你在第十章中输入朋友的生日时，你的应用中的每个条目将包含一个名字、一个姓氏和一个出生日期。让我们在“添加生日”视图控制器中添加一些*输入控件*，让用户能够为每个人输入这些信息。输入控件是指文本字段或下拉菜单等，允许用户在应用中输入数据。我们将通过为用户可以添加的所有信息添加输入控件标签来开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“First Name”的标签。这个标签将放置在一个文本字段旁边，用户可以在该文本字段中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加一个标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们想使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以*点*为单位进行测量。请注意，1 点并不等于 1 像素。根据应用运行的设备类型，1 点可能对应 1 个像素、一个 2×2 像素的正方形，或者一个 3×3 像素的正方形。这三个缩放因子分别称为@1x、@2x 和@3x（与设置应用图标时讨论的尺寸相同）。设备的点分辨率也不相同，宽度从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最旧的 iPhone 和 iPod 型号使用@1x 缩放因子，而且你无法在这些型号上运行应用（BirthdayTracker 只支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们很可能使用@2x 缩放因子，这些型号使用的是@3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15。）我们将在每个添加到视图控制器的库对象上设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕的边缘之外，但仍然留出足够的空间用于文本输入字段以及其他标签和输入项。在大小检查器的“视图”部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成后，重复这些步骤，为“添加生日”视图控制器添加两个标签：姓氏标签和出生日期标签。我们需要将其他标签和输入控件定位，以避免重叠。在某些情况下，这可能会变得复杂并且需要一些时间。对于这个应用，我们已经为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何使你的应用在其他设备上运行。表格 9-1 列出了每个标签的大小和位置。

表格 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有的标签都具有相同的 x 位置，使它们垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置需要至少比下一个标签大 21 个点。由于我们也在每个标签下方添加输入控件，因此我们将 y 位置设置得更大，以便容纳标签和输入控件的高度。

很棒！现在你的故事板应该看起来像 图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个 *文本字段*，让你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用来在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在该字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用来输入名字，另一个用来输入姓氏。给这两个文本字段设置 表格 9-2 中看到的大小和位置。你可以使用大小检查器进行设置，就像为标签设置时做的一样。

表格 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后，你需要添加一个叫做 *日期选择器* 的控件。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中使用的日期选择器一样（参见 图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器在日历应用中用于事件添加时的日期选择。*

日期选择器还可以只显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后将其点击并拖动到出生日期标签下的视图控制器中。使用大小检查器，将 x 坐标设置为 0，y 坐标设置为 280。

你可能需要调整一些日期选择器的属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的出生日期！将日期字段从当前日期更改为**自定义**。这样会出现一个新框，修改这个日期为你的出生日期。

让我们通过运行应用来测试一下它的工作情况！我们为输入控件使用的尺寸非常适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这次，当你点击“出生日期”视图控制器上的 + 按钮时，“添加生日”屏幕应该会显示出来，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很好，但其他设备呢？选择一个较小的模拟器运行应用程序，例如 iPhone 5s，并再次运行应用程序。你会发现，界面看起来不太对劲。

所有你添加到故事板的元素都会显示出来，但文本框已经超出了屏幕的边缘。现在，既然所有元素都已经放在屏幕上，下一步是让它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 使用自动布局让您的应用在每个设备上都看起来完美

单单 iPhone 就有三种不同的屏幕尺寸，并且未来可能会推出更多尺寸。你需要设计你的应用，使其在任何设备上都能看起来不错。这意味着你需要让你的应用自动调整所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的东西来将元素放置到屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来调出自动布局菜单。*

在屏幕的故事板面板底部有一个带有图标的功能区，位于“实用工具”面板之前的最右侧图标是一个夹在两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，上面写着“解决自动布局问题”。点击该图标会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 完成此操作后，你将看到一堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适合屏幕的宽度，不会超出屏幕边缘。自动布局还会确保每个文本框的前后有 20 个点的间距，使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这一次，添加生日屏幕应该完美显示。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮暂时还不会做任何事情，我们只会先设置它们。在第十章中，我们将添加一些代码，使它们能够取消“添加生日”屏幕并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个 Bar Button Item 并将其放置在导航栏的*右*侧。我们将把这个按钮更改为保存按钮，就像我们之前做的添加按钮一样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中再拖动一个 Bar Button Item，这次将其放置在导航栏的*左*侧。使用属性检查器将其更改为取消按钮，就像你之前做的保存按钮一样。你的视图控制器应该与图 9-21 中显示的样子相似。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新按钮的效果！

点击生日表视图控制器中的+按钮应该会将你带到添加生日视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前还没有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始通过创建生日和添加生日屏幕的基本用户界面来制作一个 BirthdayTracker 应用程序。你还使用表视图控制器创建了生日屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用程序的基本框架，接下来将在第十章中编写取消和保存按钮的代码，这样你就可以在应用程序中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失的约束”选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **重置为缺失的约束** 选项来添加缺失的约束。

### 添加应用图标

大多数应用都有某种图标，会显示在用户设备的主屏幕上。我们将通过为 BirthdayTracker 应用添加一个图标来开始。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图片。下载 ZIP 文件后，你将在 *Downloads* 文件夹中找到名为 *ch9-images* 的文件夹，里面有你需要的图像文件。获得这些文件后，在项目导航器中选择 *Assets.xcassets*，这将打开应用的 *资源目录*，在这里你可以放置应用所需的任何 *资源*（如图像、音频等），包括应用图标。实际上，资源目录已经有一个占位符，你可以在其中添加图标。从目录左侧的菜单中选择 **AppIcon**，你应该能看到多个图像占位符。

要添加一个显示在 iPhone 主屏幕上的应用图标，你需要为标签为 *iPhone App* 的图标集提供 2x 和 3x 图像。2x 尺寸适用于大多数 iPhone，如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸的图像。你将在 第十四章 中学习如何为不同的屏幕分辨率调整图像大小。

将图标添加到资源目录很简单！下载提供的图像后，打开 Finder 中的 *Downloads* 文件夹。然后只需将图像 *cake@2x.png* 拖到 iPhone App 2x 框中，将 *cake@3x.png* 拖到 3x 框中。完成后，你的资源目录应类似于 图 9-4。

![Image](img/Image00200.jpg)

*图 9-4：现在我们有了应用图标！*

除了应用图标，应用还会有一个显示名称，显示在图标下方的主页上。默认情况下，这个显示名称就是应用名称 BirthdayTracker。然而，这个名称稍微有点长，无法完全显示在图标下方，所以我们将它更改为一个较短的名称：Birthdays。为此，请通过在项目导航器中选择 BirthdayTracker 项目返回设置页面。在顶部的 Identity 部分，你可以更改应用的显示名称。只需在显示名称文本框中输入 **Birthdays**。这只会更改显示在应用图标下方的名称。你的项目名称仍将是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，让我们来创建应用屏幕！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。这是我们将设计应用程序*用户界面*的地方。用户界面只是用户与应用程序交互时所看到和使用的元素——图像、文本、按钮等。*故事板*让你以可视化的方式组织应用程序的各个屏幕。我们将使用故事板来查看所有的屏幕及它们之间的连接。

一旦你选择了*Main.storyboard*，按下⌘-0 隐藏导航面板，以便有更多的屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在看一下工具面板顶部。你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，它们是帮助你更仔细查看故事板中元素的工具，并允许你更改这些元素的设置。当你选择其中一个检查器时，它会出现在工具面板中。

**检查故事板项**

图 9-5 显示了当故事板打开时，工具面板中检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：在故事板的工具面板中，你可以使用六个检查器。*

让我们从左到右浏览这些检查器。页面图标打开文件检查器。这是你可以更改故事板文件设置的地方。在本书以及大多数应用程序中，你不会使用这个检查器。

下一个检查器，图标是一个问号，是快速帮助检查器。这个检查器会提供你当前在故事板中选中项的详细类信息。

第三个检查器，图标是一个身份证，称为身份检查器。在这里，你可以为故事板项设置一个自定义类。

接下来的两个检查器是你在故事板中工作时最常用的，我们在文中会频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置选中项的各种属性，比如设置标签的文本、按钮的颜色，或者文本输入框周围的框类型等。尺寸检查器，图标是一个尺子，用于设置每个故事板项的大小和屏幕位置。

最后是连接检查器，图标像一个圆圈中的箭头。这个检查器可以用来将故事板中的项与您在类中编写的代码连接起来。我们将在第十章 中展示如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊类型的视图控制器，用于显示列表，在 Xcode 中被称为*表格视图控制器*。在我们的应用中，表格视图控制器将显示你朋友的生日列表！目前它看起来就像一个空白屏幕，你将学习在 “创建生日表格视图控制器” 中如何显示生日数据，具体内容请见第 156 页。

现在，让我们将表格视图控制器添加到故事板中。为了更方便操作，你可以先将故事板缩小，这样可以更好地查看视图控制器。在故事板中双击视图控制器外的空白区域即可进行缩放。现在你的屏幕应该已经被缩小。

在工具面板的底部，有一个包含四个按钮的区域。选择第三个按钮，它看起来像一个圆圈中的方形。这是对象库，你可以在这里找到要添加到故事板的项目。浏览对象库列表，直到找到表格视图控制器，或者使用面板底部的筛选栏搜索“table view controller”。然后点击并拖动该对象到你的故事板上，放到已经存在的视图控制器旁边。你的故事板应该像图 9-6 中那样。

请注意，在你添加表格视图控制器后，左侧的大纲视图中会出现一个“表格视图控制器场景”条目，里面有一个表格视图控制器。你故事板中的每个场景代表应用程序屏幕上的一个区域。对于 iPhone 应用，通常一次只会显示一个场景，并且这个场景会占满整个屏幕。而 iPad 应用则可以同时显示两个或更多的场景。

![Image](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到生日屏幕的故事板中*

下一步是将这个新视图控制器设置为你运行应用时显示的第一个屏幕，因为我们希望用户打开应用时，能够看到生日列表。具体步骤可以参见图 9-7。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后在工具面板中打开属性检查器 ➋。在这里，勾选**是初始视图控制器** ➌。完成此操作后，表格视图控制器左侧应该会出现一个箭头。这个箭头意味着应用启动时会显示这个视图控制器。

#### 添加导航控制器

现在，我们将为视图控制器添加一个标题“生日”以及一个添加按钮，这样可以打开添加生日的视图控制器。为此，我们首先将表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器，它配有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且在左右两侧可以包含按钮，用于导航到应用中的其他屏幕。你会在多个 iOS 应用的屏幕顶部看到这个导航栏，例如设置应用和消息应用。

在大纲视图中选择**表格视图控制器**。选中后，你需要使用 Xcode 菜单将表格视图控制器嵌入到导航控制器中。进入 **编辑** ▸ **嵌入到** ▸ **导航控制器**。

在表格视图控制器嵌入到导航控制器后，你的故事板应该像图 9-8 所示。导航控制器将作为一个屏幕出现在故事板中。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

每个故事板中的视图控制器代表应用中用户将看到的一个屏幕，但导航控制器稍微不同。尽管它在故事板中看起来像一个独立的屏幕，但导航控制器实际上只是一个容器，包含了用户在应用中切换的其他视图控制器。将一个视图控制器嵌入到导航控制器中意味着你的应用可以在不同的视图之间进行导航。

你应该在导航控制器和表格视图控制器的顶部看到灰色的导航栏。当应用运行时，导航栏会告诉用户他们当前所在屏幕的标题，并且可能包含一些按钮和箭头，供他们用来切换到其他屏幕。为了利用导航栏告诉用户他们当前所在的屏幕，我们需要为屏幕命名。现在是回到故事板的好时机。双击故事板中的空白处进行缩放，然后滚动视图以便看到表格视图控制器。要为表格视图控制器添加标题，请点击大纲视图左侧的**表格视图控制器场景**下的**导航项**。

![图片](img/Image00205.jpg)

选中该项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，所以在右侧的标题字段中输入**生日**。你应该会看到，完成这一步并按下 RETURN 后，大纲视图中的“表格视图控制器场景”条目会自动更新为“生日场景”。

接下来，我们将创建一个添加按钮，这样你就可以添加生日了！

#### 添加一个按钮

我们希望用户能够打开应用，查看他们的生日列表，并且可以向列表中添加生日。让我们制作一个按钮，让他们实现这个功能！

我们需要在导航栏中添加一个按钮，指向“添加生日”场景，以便用户输入生日。找到对象库中的“Bar Button Item”，然后将其拖动并放置到表视图控制器的导航栏右侧，如图 9-9 所示。

现在，我们希望将这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮供我们使用。在属性检查器中，将该 Bar Button Item 的系统项更改为**Add**。你应该看到按钮变成了一个加号 (+)。

接下来，我们需要告诉按钮点击时应该做什么。我们希望它打开“添加生日”视图控制器，因此我们需要将添加按钮连接到该视图控制器。首先，双击 storyboard 以缩小视图，确保你可以同时看到“生日”表视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键并从 + 按钮拖动到 storyboard 右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标。这时会弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar Button Item 拖动到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到邻近的视图控制器，并在出现的对话框中选择“Present Modally”。*

连接对话框为你提供了几种关于*segue*的选项——即从一个屏幕到另一个屏幕的过渡。点击连接对话框中的**Present Modally**选项。这会使视图控制器以*模态*视图控制器的形式出现在屏幕上。在 iPhone 上，模态视图控制器会从手机底部滑动到屏幕上，并且不会自动带有返回按钮来返回到之前的屏幕。相反，模态视图可以包含其他按钮，比如取消或保存。还有其他类型的 segue，例如“Show”segue，在这种方式下，视图控制器从右侧推到屏幕上，并且导航栏的左侧会有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，屏幕应该作为模态窗口展示，并且带有一个取消按钮。否则，如果你使用类似“Show”segue 并带有返回按钮，可能会出现用户输入完所有内容后点击返回按钮而没有保存任何东西的情况！有了取消按钮，用户必须故意点击才能取消该屏幕。

要查看一个好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以取消并退出屏幕而不保存，右侧有一个添加按钮，用于在关闭模态之前创建新事件。你应该能看到新事件模态从屏幕底部弹出，并在被关闭时再次向下消失。我们希望用户能保存生日，所以我们也会使用模态。

现在，让我们尝试运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先点击 Xcode 左上角的设备列表，选择一个设备模拟器（参见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角设置模拟器运行的设备，靠近应用名称。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表来运行你的应用。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R**。

当模拟器打开运行你的应用时，如果它的大小太大以至于无法适应你的电脑屏幕，你可以调整它的尺寸。点击模拟器选择它，然后前往 **窗口** ▸ **缩放**，在模拟器菜单中选择更小的比例。

到目前为止，运行应用时没有太多变化。你应该能看到第一个生日屏幕，带有一个 + 按钮，如图 9-1 所示。显然，此时你的生日屏幕是空的。点击 + 按钮会弹出第二个空白屏幕。查看完应用后，通过点击 Xcode 中的停止按钮来关闭它，这个按钮位于你之前按下的播放按钮旁边。当你停止应用时，你应该会看到你的应用图标出现在模拟器的主屏幕上！（见图 9-12。）

就这样！我们现在需要配置第二个屏幕，以便它可以用于添加生日！

![图片](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，您需要将其嵌入到一个自己的导航控制器中。当视图控制器是模态时，它不会继承我们故事板上已经存在的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中点击普通视图控制器以选择它。然后进入**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在您应该看到在“视图控制器场景”下的轮廓视图中添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与您在为表视图控制器添加“生日”标题时遵循的步骤相同。

现在，当“添加生日”视图控制器在应用中出现时，顶部会显示其标题。

#### 添加朋友的名字和生日

当您在第十章中输入朋友的生日时，应用中的每一条记录都会包含一个名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入所有这些信息。输入控件包括文本字段或下拉菜单等，允许用户将数据输入到应用程序中。我们将从为用户可以添加的所有信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“名字”的标签。这个标签将位于一个文本字段旁边，您将在其中输入朋友的名字。在对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在我们要使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点（points）*为单位测量的。请注意，1 个点并不等于 1 个像素。根据您的应用运行的设备类型，1 个点可能会转换成 1 个像素、一个 2×2 像素的方块，或者一个 3×3 像素的方块。这三种缩放因子分别被称为@1x、@2x 和 @3x（与我们在设置应用图标时讨论的尺寸相同）。设备的分辨率也不是统一的，宽度从 320 到 1,024 点不等，长度从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* 名字

只有最旧型号的 iPhone 和 iPod 使用@1x 缩放因子，而你将无法在这些型号上运行你的应用（BirthdayTracker 将仅支持 iOS 10 及以上版本）。除非你的 iPhone 或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们很可能使用@2x 缩放因子，这些机型使用@3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离，单位是点。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15）。我们将设置每个我们添加到视图控制器中的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15: 显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签放置在离屏幕边缘不太近的地方，但仍然留出足够的空间以容纳文本输入框以及其他标签和输入项。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成此操作后，重复这些步骤，向添加生日的视图控制器中再添加两个标签：姓氏标签和出生日期标签。我们需要将其他标签和输入控件的位置调整好，以免它们重叠。在某些情况下，这可能会变得有些棘手，可能需要一些时间。对于此应用，我们已经为你计算出了在 iPhone 7 屏幕上放置对象的位置。稍后我们将解释如何使你的应用适应其他设备。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1: 视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置必须至少比下一个标签大 21 个点。由于我们还将在每个标签下方添加输入控件，所以我们将 y 位置设置得更大，以便容纳标签和输入控件的高度。

太好了！现在你的故事板应该像图 9-16 中那样。

![Image](img/Image00214.jpg)

*图 9-16: 输入标签已添加到视图控制器中。*

接下来你将添加两个*文本框*，用于输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本框对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本框设置为 表 9-2 中所示的大小和位置。你可以使用尺寸检查器，像之前设置标签那样操作。

表 9-2：视图控制器中输入的文本字段

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个叫做*日期选择器*的控件。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时显示日期和时间，就像在日历应用中使用的日期选择器一样（参见 图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器选择日期。*

日期选择器还可以只显示时间，就像在时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并将其拖到 Birthdate 标签下的视图控制器中。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器进行选择。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见 图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将这个日期改为你的出生日期！将日期字段从当前日期更改为**自定义**。这样一个新的框会出现，修改这个日期为你的出生日期。

让我们通过运行应用程序来测试它的效果！我们为输入控件设置的大小适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你点击 Birthdays 视图控制器上的 + 按钮时，应该会显示 Add a Birthday 屏幕，如 图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很不错，但其他设备呢？选择一个较小的模拟器来运行该应用程序，比如 iPhone 5s，然后再次运行应用程序。你会发现，界面看起来不太对劲。

你添加到故事板中的所有元素都已出现，但文本框超出了屏幕的边缘。现在，所有元素已经添加到屏幕上，接下来的步骤是确保它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 使用自动布局使你的应用在每个设备上看起来完美

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能会有更多尺寸的设备出现。你需要设计应用，使它在任何设备上看起来都很合适。这意味着你需要让你的应用调整屏幕上所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的方式来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕故事板面板的底部有一条包含图标的带状栏，位于工具面板前的最右侧图标是两个垂直线之间的三角形。将鼠标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击此图标会弹出一份建议菜单。点击**添加缺失的约束**。^(*)当你这样做时，你会看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局会确保日期选择器的大小适合屏幕的宽度，不会超出边缘。自动布局还会确保每个文本框前后都有 20 个点的间距，使它们在屏幕上居中显示。

现在，再次在 iPhone 5s 模拟器上运行应用。此次，“添加生日”屏幕应该完美显示。

#### 添加保存和取消按钮

最后，我们将展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。按钮目前不会有任何功能。我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消“添加生日”屏幕并保存生日到应用中。

要添加保存按钮，从对象库中拖动一个“条形按钮项”，并将其放置在导航栏的*右侧*。我们将把这个按钮变成一个保存按钮，就像我们对“添加”按钮所做的那样。选择按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，这次将它放置在导航栏的 *左侧*。使用属性检查器将其转换为取消按钮，就像你做保存按钮一样。你的视图控制器应该看起来像 图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新的按钮！

点击生日表视图控制器上的 + 按钮，应该会进入添加生日视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前不会有任何反应——我们将在 第十章 中实现这两个功能！

### 你学到了什么

在本章中，你开始制作 BirthdayTracker 应用，通过创建生日和添加生日屏幕的基本用户界面。你还使用表视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间切换。

现在你已经完成了应用的基本框架，第十章 将教你如何编程实现取消和保存按钮，让你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **重置为缺失约束** 选项，以添加缺失的约束。

大多数应用都带有某种图标，该图标会显示在用户设备的主屏幕上。我们将从为我们的 BirthdayTracker 应用添加一个图标开始。你可以从 *[`www.nostarch.com/iphoneappsforkids/`](https://www.nostarch.com/iphoneappsforkids/)* 下载我们将用于图标的两张图片。下载 ZIP 文件后，你将在 *Downloads* 文件夹内看到一个名为 *ch9-images* 的文件夹，里面包含你需要的图片文件。下载完成后，从项目导航器中选择 *Assets.xcassets*，这将打开应用的 *资源目录*，你将在其中添加任何应用要使用的 *资源*（例如图片、声音等），包括应用图标。实际上，资源目录已经自带一个占位符，你可以在其中添加图标。从目录左侧的菜单中选择 **AppIcon**，你应该能看到多个图片占位符。

要添加一个应用图标，以便在 iPhone 的主屏幕上显示，你需要提供 2x 和 3x 大小的图标集图片，标签为 *iPhone 应用*。2x 大小适用于大多数 iPhone，例如 iPhone 5、6 和 7。较大的 iPhone，如 iPhone 6s Plus 和 iPhone 7 Plus，使用 3x 大小的图片。你将在 第十四章 中了解更多关于不同屏幕分辨率的图片尺寸。

将图标添加到资源目录中非常简单！下载提供的图像后，打开 Finder 中的*下载*文件夹。然后，只需将图像*cake@2x.png* 拖到 iPhone App 2x 框中，将*cake@3x.png* 拖到 3x 框中。完成后，你的资源目录应类似于图 9-4。

![图片](img/Image00200.jpg)

*图 9-4：现在我们有了应用程序图标！*

除了应用程序图标，应用程序还具有显示名称，显示在主页图标下方。默认情况下，这是应用程序的名称，BirthdayTracker。然而，这个名称有点太长，无法完全显示在图标下方，所以我们将其更改为一个较短的名称：Birthdays。为此，返回设置页面，在项目导航器中选择 BirthdayTracker 项目。在顶部的身份部分，你可以更改应用程序的显示名称。只需在显示名称文本框中输入**Birthdays**。这将只更改显示在应用程序图标下的名称。你的项目名称仍然是 BirthdayTracker。

现在我们已经设置了应用程序图标和显示名称，接下来我们来创建应用程序的屏幕！

### 显示朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。这是我们将设计应用程序*用户界面*的地方。用户界面就是用户将看到并用来与应用程序互动的内容——图像、文本、按钮等等。*故事板*让你以视觉方式组织应用程序的屏幕。我们将使用故事板查看所有已使用的屏幕及其之间的连接。

一旦选择了*Main.storyboard*，通过按 ⌘ -0 隐藏导航窗格，这样可以腾出更多的屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在看看工具窗格的顶部。你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更仔细地查看故事板中元素的工具，并允许你更改这些元素的设置。当你选择一个检查器时，它会出现在工具窗格中。

**检查故事板项目**

图 9-5 显示了在故事板打开时，工具窗格中出现的检查器选择栏的特写视图。

![图片](img/Image00201.jpg)

*图 9-5：在故事板的工具窗格中，你可以使用六个检查器。*

让我们从左到右依次查看这些检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书以及大多数应用程序中，你不会使用这个检查器。

下一个检查器，通过问号图标标识，是快速帮助检查器。此检查器会为你当前在故事板中选择的项目提供详细的类信息。

第三个检查器是带有身份证图标的身份检查器。在这里，您可以为故事板中的项设置自定义类。

接下来的两个检查器是您在故事板中工作时最常用的，我们将在文中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置故事板中选定项的各种属性。例如，它可以用来设置标签的文本、按钮的颜色，或文本输入框周围显示的框类型。大小检查器，带有尺子图标，用于设置每个故事板项的大小和屏幕位置。

最后，还有连接检查器，它的图标看起来像是一个圈中的箭头。这个检查器可以用来将故事板中的项与您在类中编写的代码连接起来。我们将在第十章中展示如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是“生日”视图控制器。这将是一个特殊类型的视图控制器，用于显示列表，在 Xcode 中称为*表格视图控制器*。在我们的应用程序中，表格视图控制器将显示您朋友的生日列表！现在它看起来只是一个空白屏幕，您将在“创建生日表格视图控制器”一节中学习如何显示生日数据，参考第 156 页。

让我们将表格视图控制器添加到故事板中。如果您先将视图缩小，以便更好地看到视图控制器，这一步会更加简单。您可以双击视图控制器外的空白区域来实现这一点。现在您的屏幕应该已被缩小。

在实用工具窗格的底部有一个包含四个按钮的区域。选择第三个按钮，它看起来像是一个圈中的方块。这是对象库，您可以在这里找到要添加到故事板中的项。向下滚动对象库列表，直到找到表格视图控制器，或者使用窗格底部的过滤栏搜索“table view controller”。然后单击并拖动该对象到您的故事板中。将其放置在已存在的视图控制器旁边。您的故事板应该看起来像图 9-6 中的那样。

请注意，当您添加表格视图控制器后，左侧大纲视图中会出现一个“表格视图控制器场景”条目，并且其中包含一个表格视图控制器。故事板中的场景代表应用程序中的一个屏幕区域。对于 iPhone 应用程序，通常一次只会显示一个场景，该场景会占满整个屏幕。iPad 应用程序则可以同时在屏幕上显示两个或多个场景。

![Image](img/Image00202.jpg)

*图 9-6：为“生日”屏幕添加表格视图控制器*

下一步是使这个新视图控制器成为应用运行时出现的第一个屏幕，因为我们希望用户打开应用时看到生日列表。执行此操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后，在工具区中打开属性检查器 ➋。在那里，勾选**是初始视图控制器** ➌。完成后，表格视图控制器左侧应该会出现一个箭头。这个箭头表示应用在启动时会显示这个视图控制器。

#### 添加导航控制器

现在我们将为视图控制器添加一个标题“生日”，并添加一个按钮，当点击时会弹出添加生日视图控制器。为此，我们首先将表格视图控制器放入*导航控制器*中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并有左右按钮，用于导航到应用中的其他屏幕。你会在多个 iOS 应用中看到这个栏，如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。选中后，你需要使用 Xcode 菜单将表格视图控制器嵌入导航控制器。进入**编辑** ▸ **嵌入到** ▸ **导航控制器**。

在将表格视图控制器嵌入导航控制器后，你的故事板应该像图 9-8 中的那样。导航控制器将作为故事板中的一个屏幕显示出来。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表应用中用户将看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像是一个单独的屏幕，实际上导航控制器只是一个容器，容纳着用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在不同视图之间进行导航。

你应该能看到导航控制器和表格视图控制器顶部的灰色导航栏。当应用程序运行时，导航栏会告诉用户他们当前屏幕的标题，并可能包含按钮和箭头，用户可以用来跳转到其他屏幕。为了利用导航栏告诉用户他们所处的屏幕，我们需要为屏幕添加标题。现在是重新缩小故事板视图的好时机。双击故事板的空白处进行缩小，然后滚动视图，直到你能看到表格视图控制器。要为表格视图控制器添加标题，请在左侧的大纲视图中点击**表格视图控制器场景**下的**导航项**。

![Image](img/Image00205.jpg)

选中后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。你应该会看到，当你完成这一步并按下回车后，大纲视图中的表格视图控制器场景条目会自动更新为“生日场景”。

接下来，我们将创建一个添加按钮，方便你添加生日！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并向其中添加一个生日。让我们做一个按钮，让他们可以做到这一点！

我们需要在导航栏上添加一个按钮，通向“添加生日”场景，这样用户就可以输入一个生日。找到对象库中的“工具栏按钮项”，然后将其拖动到表格视图控制器的导航栏右侧，像图 9-9 所示。

现在我们要把这个按钮改成一个添加按钮。幸运的是，Xcode 提供了一个内置的添加按钮可以使用。在属性检查器中，将工具栏按钮项的系统项（System Item）改为**添加**。你应该看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在被点击时该做什么。我们希望它能打开“添加生日”视图控制器，因此需要将添加按钮连接到这个视图控制器。首先，双击故事板进行缩小，确保你能看到“生日”表格视图控制器和最终会成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，并从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器高亮显示时松开鼠标，这会弹出一个连接对话框，类似于图 9-10。

![Image](img/Image00206.jpg)

*图 9-9：将“工具栏按钮项”拖动到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，在弹出的对话框中选择“模态展示”。*

连接对话框提供了几种选项，用于设置你想要在两个视图控制器之间进行的*segue*——即从一个屏幕到另一个屏幕的过渡。点击连接对话框中的**模态展示**选项。这将使视图控制器作为*模态*视图控制器显示在屏幕上。在 iPhone 上，模态视图控制器从手机底部进入屏幕，并且没有自动带有返回按钮以返回到上一屏幕。相反，模态视图可以有其他按钮，比如取消或保存。还有其他类型的 segue，比如 Show segue，它会从右侧将视图控制器推到屏幕上，并且在导航栏左侧会有一个返回按钮。

在 iOS 应用中，当你展示一个获取和保存用户输入的屏幕时，应该以模态视图的形式展示，并且带有取消按钮。否则，如果你使用类似 Show segue 的方式带有返回按钮，就可能出现用户输入完所有信息后，点击返回按钮而没有保存任何内容的情况！带有取消按钮的话，用户必须故意点击才能退出该屏幕。

想要查看一个模态输入视图控制器的好例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧会有一个 + 按钮，你可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，用于不保存内容直接退出，右侧有一个添加按钮，用于在关闭模态视图之前创建新事件。你应该能看到，新事件模态视图是从屏幕底部进入的，关闭时又会返回底部。我们希望用户保存生日信息，因此我们也会使用模态视图。

现在让我们试着运行我们的应用，看看目前为止我们都做了些什么！要运行应用，首先通过点击 Xcode 左上角 BirthdayTracker 旁边列出的设备，选择一个设备模拟器（参见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：将模拟器运行的设备设置在 Xcode 窗口左上角，靠近应用程序名称的位置。这里，设备设置为 iPhone 7。*

这将会弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或使用快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果模拟器的大小太大，无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器以选中它，然后前往**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用时不会发生太多变化。你应该能看到第一个生日屏幕，上面有一个“+”按钮，如图 9-1 中所示。显然，在这个阶段，你的生日屏幕是空的。点击“+”按钮会弹出第二个空白屏幕。查看完应用后，通过点击 Xcode 中的停止按钮来关闭它，该按钮位于你之前按下的播放按钮旁边。当你停止应用时，你现在应该会在模拟器的主屏幕上看到你的应用图标！（见图 9-12）。

就这样！我们现在需要配置第二个屏幕，以便它可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：生日追踪器应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到一个自己的导航控制器中。当视图控制器是模态时，它不会继承我们在故事板中已经有的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击故事板中的视图控制器来选择它。然后转到**编辑器** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该看到一个导航项已添加到视图控制器场景的概览视图中。点击这个新添加的导航项，然后在属性检查器中输入标题**添加生日**。这些步骤与你在给表视图控制器添加“生日”标题时的操作相同。

现在，当“添加生日”视图控制器出现在应用中时，它会在顶部显示标题标签。

#### 添加朋友的姓名和生日

当你在第十章中输入朋友们的生日时，应用中的每个条目都会包含名字、姓氏和出生日期。让我们向“添加生日”视图控制器添加一些*输入控件*，这样用户就可以为每个人输入所有这些信息。输入控件是指诸如文本字段或下拉菜单等控件，允许用户在应用中输入数据。我们将首先添加所有用户可以输入信息的输入控件标签。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个显示“名字”的标签。这个标签将位于一个文本字段旁边，你可以在该文本字段中输入朋友们的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：在“添加生日”视图控制器中添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在我们想使用 Size Inspector 设置标签的大小和位置。在 Xcode 的 Storyboard 中，宽度和高度以*点*为单位进行测量。请注意，1 个点并不是 1 个像素。根据应用程序运行的设备类型，1 个点可以对应 1 个像素、一个 2×2 像素的方块，或一个 3×3 像素的方块。这三种缩放因子分别称为@1x、@2x 和@3x（这与我们设置应用图标时讨论的缩放因子相同）。不同的设备也有不同的点分辨率，宽度可以从 320 到 1,024 点不等，高度可以从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：显示标签 First Name*

只有最旧型号的 iPhone 和 iPod 使用@1x 的缩放因子，而且你无法在这些型号上运行你的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus（这些型号使用@3x 缩放因子），否则你的设备使用的是@2x 缩放因子。

对象在屏幕上的位置也是基于点数的。对象的 x 坐标是从屏幕左边缘到对象左边缘的距离（以点为单位）。y 坐标是从屏幕顶部到对象顶部的距离（以点为单位）。(见图 9-15)。我们将为每个添加到视图控制器的库对象设置 x 坐标和 y 坐标。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 坐标、y 坐标、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签放置在离屏幕边缘有一定距离的位置，同时留出足够的空间给文本输入框和其他标签及输入框。在 Size Inspector 的 View 部分，将 x 坐标设置为 20，y 坐标设置为 100，宽度设置为 100，保持高度为 21。

完成这一步后，重复这些步骤，将两个标签添加到“添加生日”视图控制器：一个 Last Name 标签和一个 Birthdate 标签。我们需要调整其他标签和输入框的位置，确保它们不会重叠。在某些情况下，这可能会变得有些棘手，可能需要一些时间。对于这个应用程序，我们已经为你计算出在 iPhone 7 屏幕上放置对象的位置。稍后我们会解释如何使你的应用程序在其他设备上运行。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| First Name | 20 | 100 | 100 | 21 |
| Last Name | 20 | 170 | 100 | 21 |
| Birthdate | 20 | 250 | 100 | 21 |

你可以看到所有的标签都有相同的 X 坐标，这样它们可以垂直对齐，但每个标签的 Y 坐标不同。每个标签的高度都是 21，所以 Y 坐标需要至少比下一个标签大 21 个点。由于我们也要在每个标签下方添加输入控件，因此我们将 Y 坐标设置得更大，以便容纳标签的高度和输入控件的高度。

很好！现在你的故事板应该看起来像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来你将添加两个*文本字段*，它们将用来输入名字和姓氏。文本字段是 UITextField 类的一个 UI 元素，用来在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户就可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用来输入名字，另一个用来输入姓氏。按照表格 9-2 中显示的大小和位置来设置这两个文本字段。你可以使用尺寸检查器，就像你为标签做的一样。

表格 9-2：视图控制器中的输入文本字段

| 文本字段 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个叫做*日期选择器*的控件。它可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的工具，允许用户选择日期或时间。它可以显示日期和时间，例如在日历应用中使用的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用的日期选择器。*

日期选择器也可以只显示时间，类似于时钟应用中设置闹钟时使用的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动直到找到日期选择器，然后点击并将其拖动到视图控制器中的出生日期标签下方。使用尺寸检查器，将 X 坐标设置为 0，Y 坐标设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们把这个日期改成你的出生日期吧！将日期字段从“当前日期”更改为**自定义**。这样一个新框将出现。将日期更改为你的出生日期。

让我们通过运行应用来测试一下它目前的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这次，当你在生日视图控制器上点击+按钮时，“添加生日”屏幕应该会显示出来，正如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，然后再次运行应用程序。你会看到，某些元素显示不太正常。

你添加到故事板中的所有元素都已显示，但文本字段超出了屏幕边缘。现在你已经把所有元素放到了屏幕上，接下来的步骤是让它们适配任何屏幕尺寸。我们将使用一种名为*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上都看起来完美，通过自动布局

单独的 iPhone 就有三种不同的屏幕尺寸，而且未来可能会有更多的屏幕尺寸。你需要设计应用程序，确保它在任何设备上看起来都很好。这意味着，你的应用需要根据运行应用的设备自动调整应用内所有元素的位置和大小。自动布局使用一种叫做*布局约束*的工具来在屏幕上放置元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接着，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来打开自动布局菜单。*

屏幕的故事板面板底部有一个带图标的带状工具栏，在工具面板之前最右边的图标是两个垂直线之间的三角形。将鼠标悬停在该图标上，它应该会显示一个标签，提示为“解决自动布局问题”。点击此图标，将弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到很多布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素大小适合屏幕。例如，自动布局使日期选择器的宽度适合屏幕，并且不会超出其边缘。自动布局还会确保每个文本字段前后有 20 个点，使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这次，添加生日屏幕应该看起来完美。

#### 添加保存和取消按钮

最后，我们将向您展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。这些按钮暂时还没有功能。我们只是先设置它们。在第十章中，我们将添加一些代码，使它们能取消添加生日屏幕并将生日保存到应用程序中。

要添加保存按钮，请从对象库中拖动一个栏按钮项目，并将其放在导航栏的*右*侧。我们将像添加按钮一样将此按钮更改为保存按钮。选择按钮项目，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个栏按钮项目，并这次将其放在导航栏的*左*侧。使用属性检查器将其转换为取消按钮，就像您对保存按钮所做的那样。您的视图控制器应该看起来像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行您的应用程序以查看新按钮！

在生日表视图控制器上点击 + 按钮应该会带你到添加生日视图控制器，你可以在那里输入一个人的姓名和出生日期。现在点击取消和保存按钮暂时没有任何操作——我们会在第十章中实现它们！

### 你学到了什么

在本章中，您通过创建生日和添加生日屏幕的基本用户界面开始制作 BirthdayTracker 应用程序。您还使用表视图控制器创建了生日屏幕，并使用户可以使用“添加”按钮和导航控制器在屏幕之间导航。

现在你的应用程序基本框架已经运行起来，接下来你将在第十章中编写代码来实现取消和保存按钮，这样你就可以在应用程序中添加并保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个苹果的 bug。在这种情况下，请选择“重置为缺失的约束”选项以添加缺失的约束。

要添加一个将在 iPhone 主屏幕上显示的应用图标，你需要为标记为*iPhone App*的图标集提供 2x 和 3x 的图标图片。2x 的尺寸适用于大多数 iPhone，比如 iPhone 5、6 和 7。更大的 iPhone，例如 iPhone 6s Plus 和 iPhone 7 Plus，则使用 3x 尺寸的图片。你将在第十四章中学习更多关于针对不同屏幕分辨率调整图片尺寸的内容。

将图标添加到资源目录非常简单！下载提供的图像后，打开 Finder 中的*下载*文件夹。然后只需将图片*cake@2x.png*拖到 iPhone App 2x 框中，将*cake@3x.png*拖到 3x 框中。完成后，你的资源目录应该看起来像图 9-4。

![图片](img/Image00200.jpg)

*图 9-4：我们现在有了一个应用图标！*

除了应用图标，应用还会有一个显示名称，显示在主屏幕上图标下方。默认情况下，这个名称就是应用名称 BirthdayTracker。然而，这个名称有点长，无法完全显示在图标下方，所以我们将它更改为一个更短的名称：Birthdays。为此，返回设置页面，在项目导航器中选择 BirthdayTracker 项目。在顶部的身份部分，你可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这将仅更改显示在应用图标下方的名称。你的项目名称仍然是 BirthdayTracker。

现在我们已经设置好了应用图标和显示名称，让我们来创建应用的屏幕吧！

### 显示朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。这是我们设计应用程序*用户界面*的地方。用户界面只是一个 fancy 的名字，指的是用户看到并用来与应用互动的元素——图片、文本、按钮等。*故事板*允许你以视觉方式组织应用的屏幕。我们将使用故事板来查看所有使用的屏幕及它们之间的连接。

在选择了*Main.storyboard*后，按⌘ -0 隐藏导航面板，这样你就能有更多的屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在看看实用工具面板的顶部，你应该能看到一个包含六个按钮的菜单。这些按钮用来在六个*检查器*之间切换，检查器是帮助你更详细查看故事板中元素的工具，并允许你修改这些元素的设置。当你选择其中一个检查器时，它会出现在实用工具面板中。

**检查故事板项目**

图 9-5 展示了在打开故事板时，出现在实用工具面板中的检查器选择条的特写视图。

![图片](img/Image00201.jpg)

*图 9-5：你可以在故事板的实用工具面板中使用六个检查器。*

让我们从左到右浏览检查员。页面图标打开文件检查员。这是您可以更改故事板文件设置的地方。在本书和大多数应用中，您不会使用此检查员。

下一个由问号图标指示的检查员是快速帮助检查员。此检查员将为您提供有关当前在故事板中选择的项目的详细类信息。

第三个检查员，具有身份证图标，是身份检查员。这是您可以为故事板项目设置自定义类的地方。

接下来的两个检查员是您在故事板中工作时最常使用的两个检查员，我们将在文本中经常提到它们。属性检查员具有一个看起来像盾牌的图标。此检查员用于设置故事板中所选项目的各种属性。例如，可以用它来设置标签的文本、按钮的颜色或围绕文本输入字段显示的框的类型。尺寸检查员具有尺子图标，用于设置每个故事板项目的大小和屏幕位置。

最后，有连接检查员，它具有看起来像一个箭头在一个圆圈中的图标。这可用于将故事板中的项目连接到您在类中编写的代码片段。我们将在第十章 中向您展示如何执行此操作。

#### 添加表视图控制器

我们的第一个视图控制器将是“生日”视图控制器。这将是一个特殊类别的视图控制器，显示一个列表，在 Xcode 中称为*表视图控制器*。在我们的应用中，表视图控制器将显示您朋友的生日列表！目前它看起来只是一个空屏幕，您将学会在“创建生日表视图控制器”中显示生日数据，在第 156 页 上。

让我们向故事板添加表视图控制器。如果您首先从故事板中放大以便更好地看到视图控制器，则此步骤将更容易完成。在故事板中，双击视图控制器外的空白处以执行此操作。现在您的屏幕应该已经放大。

在实用程序窗格的底部是一个顶部有四个按钮的部分。选择第三个按钮，看起来像一个圆内的正方形。这是对象库，您将在其中找到要添加到故事板的项目。浏览对象库列表，直到找到表视图控制器，或者使用窗格底部的过滤条搜索“表视图控制器”。然后将该对象拖放到您的故事板上。将其放在已经存在的视图控制器旁边。您的故事板应该看起来像图 9-6 中的那个。

注意，在添加表视图控制器后，大纲视图左侧会出现一个表视图控制器场景条目，其中包含一个表视图控制器。故事板中的场景表示应用程序中的屏幕区域。对于 iPhone 应用程序，通常一次只有一个场景在屏幕上，并且该场景填充整个屏幕。iPad 应用程序可以同时在屏幕上显示两个或多个场景。

![图片](img/Image00202.jpg)

*图 9-6: 将表视图控制器添加到生日屏幕的故事板中*

接下来的步骤是将这个新的视图控制器设置为应用程序运行时首先出现的第一个屏幕，因为我们希望在用户打开应用时显示生日列表。执行此操作的步骤如图 9-7 所示。

![图片](img/Image00203.jpg)

*图 9-7: 在左侧大纲视图中选择表视图控制器并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表视图控制器** ➊。然后，在您的实用工具窗格中打开属性检查器 ➋。在那里，勾选**是初始视图控制器**复选框 ➌。完成此操作后，应在故事板中的表视图控制器左侧看到一个箭头。箭头表示应用程序启动时将显示此视图控制器。

#### 添加导航控制器

现在我们将在视图控制器上添加一个标题，显示为“生日”，并添加一个添加生日视图控制器的添加按钮。为此，我们首先将表视图控制器放入*导航控制器*中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题以及位于应用程序中其他屏幕的左右侧的按钮。您可以在几个 iOS 应用程序的顶部屏幕看到此栏，例如设置应用程序和消息应用程序。

在大纲视图中选择**表视图控制器**。一旦选择了它，您需要使用 Xcode 菜单将表视图控制器嵌入到导航控制器中。转到**编辑器** ▸ **嵌入** ▸ **导航控制器**。

将表视图控制器嵌入导航控制器后，您的故事板应如图 9-8 中所示。导航控制器将显示为故事板中的一个屏幕。

![图片](img/Image00204.jpg)

*图 9-8: 导航控制器*

故事板中的每个视图控制器代表您的应用程序中用户将看到的一个屏幕，但导航控制器有些不同。尽管在故事板中看起来像是一个单独的屏幕，但导航控制器实际上只是一个容器，其中包含用户在应用程序中移动的其他视图控制器。将视图控制器嵌入导航控制器意味着您的应用程序可以从一个视图导航到另一个视图，然后再返回。

你应该能看到导航控制器和表格视图控制器顶部的灰色导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能还包含按钮和箭头，用户可以用来跳转到其他屏幕。为了使用导航栏告诉用户当前屏幕的标题，我们需要为我们的屏幕命名。现在是缩小故事板视图的好时机。双击故事板的空白处进行缩小，然后滚动视图，直到你能看到表格视图控制器。要为表格视图控制器添加标题，请点击大纲视图左侧的**表格视图控制器场景**下的**导航项**。

![Image](img/Image00205.jpg)

选择此项后，你可以在右侧的属性检查器中输入屏幕标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。完成此步骤并按 RETURN 后，你会看到大纲视图中的“表格视图控制器场景”项会自动更新为“生日场景”。

接下来，我们将创建一个添加按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并将生日添加到该列表中。让我们创建一个按钮来实现这个功能！

我们需要在导航栏中添加一个按钮，链接到“添加生日”场景，以便用户可以输入生日。在对象库中找到“Bar Button 项”，然后将其拖放到表格视图控制器的导航栏右侧，如图 9-9 所示。

现在我们想把这个按钮改成一个添加按钮。幸运的是，Xcode 有一个内建的添加按钮可以使用。在属性检查器中，将 bar 按钮项的系统项目改为**添加**。你应该能看到按钮变成一个加号 (+)。

接下来，我们需要告诉按钮在被点击时应该做什么。我们希望它打开“添加生日”视图控制器，因此我们需要将添加按钮连接到该视图控制器。首先，双击故事板进行缩小，确保你能看到“生日”表格视图控制器和最终会变成“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，从 + 按钮拖到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时，松开鼠标。这将弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar Button 项拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖到相邻的视图控制器，并在出现的对话框中选择“模态呈现”。*

连接对话框提供了多种选择，用于设置你希望在两个视图控制器之间进行的*过渡*（从一个屏幕到下一个屏幕的转换）。在连接对话框中，点击**模态呈现**选项。这将使视图控制器作为*模态*视图控制器显示在屏幕上。在 iPhone 上，模态视图控制器从手机底部弹出，且通常没有返回按钮可以返回到上一个屏幕。相反，模态视图可以包含其他按钮，比如取消或保存。还有其他类型的过渡方式，比如 Show 过渡，其中视图控制器从右侧推到屏幕上，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你呈现一个屏幕来获取和保存用户输入时，屏幕应以模态形式显示，并配有取消按钮。否则，如果你使用类似 Show 过渡的方式，并且有一个返回按钮，就可能出现用户输入完所有内容后点击返回按钮而没有保存任何内容的情况！有了取消按钮，用户需要刻意点击以取消退出屏幕。

要查看模态输入视图控制器的良好示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个+按钮，点击它可以添加一个日历事件。点击+按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以取消并返回，不保存任何内容，右侧有一个添加按钮，用来在关闭模态视图前创建新事件。你会看到新事件模态视图从屏幕底部弹出，并且在关闭时再次从屏幕上移下。我们希望用户能够保存生日，因此我们也将使用模态视图。

现在让我们尝试运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先在 Xcode 左上角点击列出的设备，选择一个设备模拟器（见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：设置模拟器将在 Xcode 窗口左上角你的应用名称旁边运行的设备。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。在选择了模拟器后，点击左上角的播放按钮，或使用键盘快捷键⌘ -**R**。

当模拟器打开以运行你的应用时，如果模拟器的尺寸太大，无法适应你的电脑屏幕，你可以调整其大小。点击模拟器以选中它，然后前往**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时，变化不大。你应该会看到你的第一个“生日”屏幕，带有一个加号按钮，如前面在图 9-1 中所示。显然，此时你的“生日”屏幕是空的。点击加号按钮将会显示第二个空白屏幕。看完你的应用后，点击 Xcode 中的停止按钮关闭它，这个按钮就在你之前点击的播放按钮旁边。当你停止应用时，你现在应该能在模拟器的主屏幕上看到你的应用图标！（见图 9-12）。

就是这样！我们现在需要配置第二个屏幕，使其可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控件输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将它嵌入一个自己的导航控制器中。当一个视图控制器是模态视图时，它不会继承我们已经在故事板中设置的导航控制器中的导航栏。导航控制器是提供导航栏的控件，因此我们需要将模态视图控制器嵌入自己的导航控制器中。点击故事板中的视图控制器，选择它。然后转到**编辑** ▸ **嵌入在** ▸ **导航控制器**。现在你应该会看到一个导航项已添加到视图控制器场景的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与当初为表格视图控制器添加“生日”标题时的步骤相同。

现在，当“添加生日”视图控制器出现在应用中时，它将会在顶部显示其标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每条记录都将包含名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件是像文本框或下拉菜单这样的控件，允许用户向你的应用输入数据。我们将从为所有可以添加的信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“名字”的标签。这个标签将位于一个文本框旁边，用户可以在其中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在我们想使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以 *点* 为单位进行度量。请注意，1 点并不等于 1 像素。根据应用运行的设备类型，1 点可能会转换成 1 像素、2×2 像素的方块，或者 3×3 像素的方块。这三种缩放因子分别被称为 @1x、@2x 和 @3x（这与我们设置应用图标时讨论的大小相同）。设备的点分辨率也并非都相同，宽度可以从 320 到 1,024 点不等，高度可以从 568 到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* 名字

只有最旧的 iPhone 和 iPod 型号使用 @1x 缩放因子，并且你无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，这些设备使用 @3x 缩放因子，否则很可能你的设备使用的是 @2x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的距离。（见 图 9-15）。我们将设置每个添加到视图控制器中的库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置为不在屏幕边缘，但仍然留有足够的空间来容纳其文本输入框以及其他标签和输入框。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成上述操作后，重复这些步骤为“添加生日”视图控制器添加两个标签：一个是姓氏标签，另一个是出生日期标签。我们需要调整其他标签和输入框的位置，以避免重叠。在某些情况下，这可能会变得有些棘手，可能需要一些时间。对于这个应用，我们已经为你计算好了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何使应用在其他设备上运行。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 轴位置相同，这样它们就可以垂直对齐，但每个标签的 y 轴位置不同。每个标签的高度为 21，所以 y 轴位置必须至少比下一个标签高 21 个点。由于我们也将输入控件添加到每个标签下方，所以我们增加了 y 轴的位置，以适应标签的高度和输入控件的高度。

太好了！现在你的故事板应该看起来像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入的标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，让你输入姓氏和名字。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中所示的大小和位置设置这两个文本字段。你可以像设置标签那样使用大小检查器来完成这项工作。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 轴位置 | Y 轴位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个名为*日期选择器*的轮盘。这将使你能够轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，用于允许用户选择日期或时间。它可以同时包含日期和时间，就像日历应用中的日期选择器一样（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以只显示时间，例如在时钟应用中用于设置闹钟的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到出生日期标签下的视图控制器中。使用大小检查器，将 x 轴位置设置为 0，y 轴位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器进行选择。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改成你的出生日期吧！将日期字段从当前日期改为**自定义**。这样做后，会出现一个新框框。将这个日期改为你的出生日期。

让我们通过运行应用程序来测试目前为止的效果！我们为输入控件设置的尺寸在 iPhone 7 屏幕上显示得很好。因此，选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击生日视图控制器上的+按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美适应 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备怎么样呢？选择一个更小的模拟器（如 iPhone 5s）来运行应用程序，再次运行应用。你会发现，界面看起来不太对劲。

你添加到故事板中的所有元素都会显示出来，但文本框超出了屏幕的边缘。现在你已经将所有元素添加到屏幕上，接下来的步骤是让它们能够适应任何屏幕尺寸。我们将通过一个名为*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上看起来都完美：使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，而且未来可能会有更多尺寸发布。你将需要设计应用程序，以便它们在任何设备上看起来都不错。这意味着，你需要让应用程序根据运行该应用程序的设备自动调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来将元素放置到屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部第四个图标，调出自动布局菜单。*

在屏幕的故事板面板底部，有一个带图标的功能区，位于工具面板之前的最右侧图标是一个夹在两条竖线之间的三角形。将鼠标光标悬停在该图标上时，应该会显示一个标签，上面写着“解决自动布局问题”。点击此图标会弹出一个建议菜单。点击**添加缺失的约束**。^(*)这样做后，你会看到在“添加生日”场景中，已经添加了一堆布局约束。

这些自动布局约束确保每个元素的尺寸正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适配屏幕并不会超出边缘。自动布局还会确保每个文本框前后有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，添加生日的界面应该完美无缺。

#### 添加保存和取消按钮

为了完成所有操作，我们将向你展示如何为添加生日视图控制器的导航栏创建取消和保存按钮。按钮目前还不会执行任何操作。我们只是设置它们。在第十章中，我们将添加一些代码，使它们可以退出添加生日屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项并将其放置在导航栏的*右侧*。我们将把这个按钮变成保存按钮，方法和添加按钮相同。选择按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其转换为取消按钮，就像你之前做的保存按钮一样。你的视图控制器应该像图 9-21 所示。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在重新运行你的应用，看看新增的按钮！

在生日表视图控制器上点击+按钮应该会带你进入添加生日视图控制器，你可以在这里输入一个人的姓名和生日日期。点击取消和保存按钮暂时不会有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你通过创建生日和添加生日屏幕的基本用户界面，开始了生日追踪器应用的开发。你还使用表视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行切换。

现在，你已经完成了应用的基本框架，接下来将在第十章中编程实现取消和保存按钮，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是苹果的一个 bug。在这种情况下，选择**重置为缺失约束**选项以添加缺失的约束。

将图标添加到资源目录非常简单！下载提供的图片后，在 Finder 中打开*下载*文件夹。然后只需将图片*cake@2x.png*拖到 iPhone App 2x 框中，将*cake@3x.png*拖到 3x 框中。完成后，你的资源目录应该像图 9-4 一样。

![图片](img/Image00200.jpg)

*图 9-4：我们现在有了一个应用图标！*

除了应用图标外，应用还有一个显示名称，它会显示在主页图标下方。默认情况下，这个名称就是应用的名称——BirthdayTracker。然而，这个名称有点太长，无法适应图标下方，所以我们将它改成一个更短的名称：Birthdays。为此，返回设置页面，通过在项目导航器中选择 BirthdayTracker 项目。在顶部的身份部分，你可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这将只更改显示在应用图标下方的名称，项目名称仍然是 BirthdayTracker。

现在我们已经设置好了应用图标和显示名称，接下来让我们创建应用的屏幕！

### 显示朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。这是我们设计应用*用户界面*的地方。用户界面只是一个高级名称，指的是用户在与应用交互时看到和使用的东西——例如图片、文本、按钮等。*故事板*让你可以直观地组织应用的屏幕。我们将使用故事板查看所有已使用的屏幕以及它们之间的连接。

选择了*Main.storyboard*后，按下⌘-0 隐藏导航面板，这样可以腾出更多屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在，看看工具面板顶部。你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更仔细查看故事板元素并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它将出现在工具面板中。

**检查故事板项目**

图 9-5 展示了当故事板打开时，在工具面板中出现的检查器选择栏的特写视图。

![图片](img/Image00201.jpg)

*图 9-5：你可以在故事板的工具面板中使用六个检查器。*

让我们从左到右依次查看各个检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书中，以及在你大部分的应用中，你不会使用这个检查器。

下一个检查器是由问号图标表示的快速帮助检查器。这个检查器会提供你当前在故事板中选择的项目的详细类信息。

第三个检查器，带有 ID 卡图标的是身份检查器。在这里你可以为故事板项目设置一个自定义类。

接下来的两个检查器是你在工作中最常用的两个，我们在文中会频繁提到它们。属性检查器的图标看起来像一个盾牌。这个检查器用于设置在故事板中选择的项目的各种属性。例如，可以用它来设置标签的文本、按钮的颜色，或者设置文本输入框周围的框类型。大小检查器，图标是尺子，用于设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，其图标看起来像一个圆圈中的箭头。这个检查器可以将故事板中的项目连接到你在类中编写的代码。我们将在第十章中向你展示如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是“生日”视图控制器。这将是一个特殊的视图控制器类，用于显示列表，在 Xcode 中称为*表格视图控制器*。在我们的应用中，表格视图控制器将显示你朋友的生日列表！现在它只是看起来像一个空白屏幕，你将在“创建生日表格视图控制器”中学习如何显示生日数据，参见第 156 页。

让我们在故事板中添加一个表格视图控制器。如果你先从故事板中缩小视图，以便更好地看到视图控制器，这一步会更容易。双击视图控制器外的空白区域来进行缩小。现在你的屏幕应该已经缩小了。

在工具面板的底部，有一个部分，顶部有四个按钮。选择第三个按钮，它看起来像一个圆圈内的方块。这个是对象库，在这里你可以找到要添加到故事板中的项目。滚动浏览对象库列表，直到找到表格视图控制器，或者使用面板底部的筛选栏搜索“table view controller”。然后点击并将该对象拖动到故事板上，放在已经存在的视图控制器旁边。你的故事板应该像图 9-6 中的那样。

请注意，在你添加表格视图控制器后，左侧的轮廓视图中会出现一个“表格视图控制器场景”条目，其中包含一个表格视图控制器。故事板中的场景代表应用程序中显示的一个屏幕区域。对于 iPhone 应用，通常一次屏幕上只有一个场景，并且该场景会填满整个屏幕。iPad 应用则可以同时在屏幕上显示两个或更多场景。

![图片](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到故事板中的生日屏幕*

接下来的步骤是让这个新的视图控制器成为应用程序运行时首先出现的屏幕，因为我们希望当用户打开应用时，能看到生日列表。实现这个目标的步骤如图 9-7 所示。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表视图控制器** ➊ 。然后在工具面板中打开属性检查器 ➋ 。在这里，勾选**是初始视图控制器** ➌ 。完成后，表视图控制器左侧应该会出现一个箭头。这个箭头表示应用在启动时将显示这个视图控制器。

#### 添加导航控制器

现在，我们将为视图控制器添加一个标题，显示“生日”，并添加一个“添加”按钮，用于展示“添加生日”视图控制器。为了实现这一点，我们首先将表视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它自带一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧提供按钮，帮助用户导航到应用中的其他屏幕。你可以在许多 iOS 应用中看到这个栏位，例如设置应用和信息应用。

在大纲视图中选择**表视图控制器**。选中后，你需要通过 Xcode 菜单将表视图控制器嵌入到导航控制器中。操作路径为：**Editor** ▸ **Embed In** ▸ **Navigation Controller** 。

将表视图控制器嵌入到导航控制器中后，你的故事板应该像图 9-8 中的那样。导航控制器将在故事板中作为一个屏幕显示。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

每个故事板中的视图控制器代表用户在应用中看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像是一个单独的屏幕，但导航控制器实际上只是一个容器，它包含了用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在不同的视图之间进行导航，并能返回。

你应该能看到导航控制器和表格视图控制器顶部的灰色导航栏。当应用运行时，导航栏会告诉用户他们当前所在的屏幕标题，并可能包含用户可以用来跳转到其他屏幕的按钮和箭头。为了让导航栏告诉用户他们所在的屏幕，我们需要为屏幕命名。现在是时候回到故事板并放大了。双击故事板的空白处进行放大，然后滚动视图，以便你能看到表格视图控制器。要为表格视图控制器添加标题，请在左侧的轮廓视图中点击**导航项**（Navigation Item），它位于**表格视图控制器场景**（Table View Controller Scene）下。

![图像](img/Image00205.jpg)

选中此项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。你应该看到，完成此步骤并按下 RETURN 键后，轮廓视图中的表格视图控制器场景（Table View Controller Scene）条目会自动更新为“生日场景”（Birthdays Scene）。

接下来，我们将制作一个添加按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将生日添加到该列表中。让我们做一个按钮，允许他们这么做！

我们需要在导航栏中添加一个按钮，用于跳转到“添加生日”场景，这样用户就可以输入生日了。在对象库中找到“工具栏按钮项”（Bar Button Item），然后将其拖放到表格视图控制器导航栏的右侧，如图 9-9 所示。

现在我们要将这个按钮转换为添加按钮。幸运的是，Xcode 提供了一个内置的添加按钮可以使用。在属性检查器中，将工具栏按钮项的系统项（System Item）更改为**添加**（Add）。你应该能看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在被点击时应该做什么。我们希望它打开“添加生日”视图控制器，因此我们需要将添加按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你可以看到“生日”表格视图控制器和将来会变成“添加生日”视图控制器的空视图控制器。按住 CONTROL 键，并从 + 按钮拖动到故事板右侧的空视图控制器中间。当视图控制器被高亮显示时松开鼠标。这时会弹出一个连接对话框，类似于图 9-10 中所示。

![图像](img/Image00206.jpg)

*图 9-9：将“工具栏按钮项”拖放到“生日”视图控制器的导航栏上。*

![图像](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在出现的对话框中选择“模态展示（Present Modally）”选项。*

连接对话框会给你几个选项，用于选择你想在两个视图控制器之间创建的 *segue* ——从一个屏幕过渡到下一个屏幕的方式。在连接对话框中点击 **以模态方式展示** 选项。这样，视图控制器就会以 *模态* 视图控制器的方式进入屏幕。在 iPhone 上，模态视图控制器会从屏幕底部进入，并且不会自动带有返回按钮来返回上一个屏幕。相反，模态视图可以有其他按钮，如取消或保存。还有其他类型的 segue，比如 Show segue，其中视图控制器会从屏幕右侧推入，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，该屏幕应该作为一个模态视图展示，并且有一个取消按钮。否则，如果你使用类似于 Show segue 带有返回按钮的方式，用户可能会在输入所有内容后点击返回按钮，而没有保存任何内容！有了取消按钮，用户必须刻意点击才能退出该屏幕。

要查看一个模态输入视图控制器的好例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，在导航栏的右侧有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，用户可以点击它退出屏幕而不保存，右侧则有一个添加按钮，可以在关闭模态视图之前创建新的事件。你会看到新的事件模态视图从屏幕底部弹出，关闭时又会滑回底部。我们希望用户能保存生日事件，因此我们也会使用模态视图。

现在，让我们尝试运行我们的应用，看看到目前为止做了些什么！要运行应用，首先选择一个设备模拟器，方法是点击 Xcode 左上角 BirthdayTracker 旁边列出的设备（参见 图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：将模拟器运行的设备设置在 Xcode 窗口左上角，靠近应用名称的位置。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，供你选择运行应用的设备。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果它太大而无法适应你的计算机屏幕，你可以调整其大小。点击模拟器进行选择，然后前往 **窗口** ▸ **缩放**，在模拟器菜单中选择一个更小的缩放比例。

到目前为止，运行应用时不会发生太多变化。你应该能看到你的第一个“生日”屏幕，屏幕上有一个 + 按钮，如图 9-1 所示。显然，在此时，你的“生日”屏幕将是空的。点击 + 按钮会弹出第二个空白屏幕。当你查看完应用后，可以通过点击 Xcode 中的停止按钮来关闭它，停止按钮就在你之前点击的播放按钮旁边。当你停止应用时，你应该会看到应用图标出现在模拟器的主屏幕上！（见图 9-12。）

就这样！现在我们需要配置第二个屏幕，以便它可以用来添加生日！

![图像](img/Image00209.jpg)

*图 9-12：生日跟踪器应用图标已添加到主屏幕。*

### 设置控件输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将它嵌入到一个自己的导航控制器中。当视图控制器是模态时，它不会继承我们在故事板中已经存在的导航控制器中的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。点击故事板中的普通视图控制器进行选择。然后进入**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在你应该看到一个导航项已被添加到视图控制器场景下的概述视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与当你为表视图控制器添加“生日”标题时所遵循的步骤相同。

现在，当“添加生日”视图控制器在应用中出现时，它的顶部会显示标题。

#### 添加朋友的姓名和生日

当你在第十章中输入朋友的生日时，应用中的每条记录将包含名字、姓氏和生日。我们来为“添加生日”视图控制器添加一些*输入控件*，让用户可以为每个人输入这些信息。输入控件是诸如文本框或下拉菜单等，允许用户向应用程序中输入数据的控件。我们将从为用户可以添加的所有信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个标签，显示“名字”。这个标签将位于一个文本框旁边，用户可以在其中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![图像](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框，输入**名字**作为显示文本，如图 9-14 所示。

现在我们要使用“大小检查器”设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以 *点* 为单位的。请注意，1 点并不等于 1 像素。根据应用运行的设备类型，1 点可能会转换为 1 像素、2×2 像素的正方形，或者 3×3 像素的正方形。这三种缩放因子分别被称为 @1x、@2x 和 @3x（这也是我们在设置应用图标时讨论的大小）。不同设备的点分辨率也不同，宽度从 320 到 1,024 点不等，高度从 568 到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* 姓名

只有最老的 iPhone 和 iPod 型号使用 @1x 缩放因子，并且你无法在这些型号上运行你的应用（BirthdayTracker 只支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，它们使用 @3x 缩放因子，否则你的设备很可能使用 @2x 缩放因子。

对象在屏幕上的位置也是基于点来计算的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（参见 图 9-15）我们将设置每个我们添加到视图控制器中的库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置得既不在屏幕边缘，又能留出足够的空间给它的文本输入框以及其他标签和输入项。在“大小检查器”的“视图”部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成这些步骤后，重复这些步骤，将另外两个标签添加到“添加生日”视图控制器中：姓氏标签和出生日期标签。我们需要将其他标签和输入项的位置调整好，避免它们重叠。在某些情况下，这可能会变得棘手，可能需要一些时间。对于这个应用，我们已经为你计算了可以放置对象的位置，基于 iPhone 7 的屏幕。稍后我们会解释如何使你的应用兼容其他设备。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们垂直对齐，但它们的 y 位置不同。每个标签的高度是 21，因此 y 位置需要至少比下一个标签大 21 个点。由于我们在每个标签下方也添加了输入控件，因此我们将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

很棒！现在你的故事板应该像图 9-16 中的那样。

![图片](img/Image00214.jpg)

*图 9-16：视图控制器中已添加输入框标签。*

接下来你需要添加两个*文本框*，它们将让你输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以在文本框中输入一行文本。

##### 添加文本框

从对象库中将两个文本框对象拖到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。按照表 9-2 中看到的尺寸和位置设置这两个文本框。你可以使用尺寸检查器，和设置标签时一样。

表 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个称为*日期选择器*的控件。这样，你可以轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，允许用户选择日期或时间。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以只显示时间，就像在时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这正是我们在生日追踪器中使用的功能。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到出生日期标签下的视图控制器中。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器会显示当前日期。让我们将这个日期改为你的出生日期！将日期字段从当前日期更改为**自定义**。这样做时，一个新框会出现。将日期更改为你的出生日期。

让我们测试一下应用到目前为止的效果！我们为输入控件使用的大小在 iPhone 7 屏幕上非常合适。所以，选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你点击“生日”视图控制器上的 + 按钮时，应该会显示添加生日的屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来不错，但其他设备怎么样呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，再次运行应用。你会发现某些内容看起来不太对劲。

所有你添加到故事板中的元素都已经出现，但文本字段超出了屏幕的边缘。现在你已经把所有元素都放到屏幕上了，下一步是让它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来完成这项工作。

#### 让你的应用在每个设备上看起来完美的自动布局

iPhone 本身就有三种不同的屏幕尺寸，而且未来可能还会推出更多尺寸。你需要设计你的应用，使其在任何设备上看起来都很好。这意味着你需要让你的应用自动调整所有元素的位置和大小，以适应应用运行的设备。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标以打开自动布局菜单。*

在屏幕故事板面板的底部，有一个带图标的带状栏，实用工具面板前的最右边的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它会显示一个标签，写着“解决自动布局问题”。点击该图标，弹出一份建议菜单。点击**添加缺失约束**。^(*) 当你这样做时，你会看到一大堆布局约束已被添加到添加生日的场景中。

这些自动布局约束确保每个元素的大小正确，能够适应屏幕。例如，自动布局使得日期选择器的大小适应屏幕宽度，并且不会超出边界。自动布局还确保每个文本框前后有 20 个点的间距，以便它们能够在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这次，添加生日屏幕应该完美无缺。

#### 添加保存和取消按钮

为了完成剩下的部分，我们将向你展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。这些按钮现在不会做任何事情。我们只是设置它们。在第十章 中，我们将添加代码，使它们能够退出添加生日屏幕并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们之前对添加按钮做的那样。选择按钮项，然后使用属性检查器将其转变为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其转变为取消按钮，就像你对保存按钮做的那样。你的视图控制器应该像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新按钮的效果！

点击生日表视图控制器上的 + 按钮应该会带你进入添加生日视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮现在不会做任何事情——我们将在第十章 中实现这两个功能！

### 你学到了什么

在本章中，你开始通过创建生日和添加生日屏幕的基本用户界面来制作一个 BirthdayTracker 应用程序。你还使用表视图控制器创建了生日屏幕，并使得用户可以通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用程序的基本框架，在第十章 中，你将编写代码来实现取消和保存按钮，以便你可以在应用程序中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项是禁用的。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项以添加缺失的约束。![Image](img/Image00200.jpg)

*图 9-4：现在我们有了一个应用图标！*

除了应用图标，应用程序还有一个显示名称，显示在首页图标下方。默认情况下，这个名称就是应用名称 BirthdayTracker。然而，这个名称有点长，无法完全显示在应用图标下，所以我们将其更改为一个较短的名称：Birthdays。为此，请通过选择项目导航器中的 BirthdayTracker 项目返回设置页面。在顶部的身份部分，你可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这将仅更改显示在应用图标下方的名称。项目的名称仍将是 BirthdayTracker。

现在我们已经设置好了应用图标和显示名称，让我们来创建应用的界面！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*来打开故事板。这是我们设计应用*用户界面*的地方。用户界面是用户与应用互动时看到并使用的东西——例如图像、文本、按钮等。*故事板*让你可以直观地组织应用的各个屏幕。我们将使用故事板来查看所有使用的屏幕及其之间的连接。

当你选择了*Main.storyboard*后，通过按⌘ -0 来隐藏导航面板，这样你可以腾出更多的屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在看看工具面板的顶部。你应该会看到一个带有六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，这些检查器是帮助你更仔细地查看故事板中元素并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它会出现在工具面板中。

**检查故事板项**

图 9-5 展示了当故事板打开时，在工具面板中出现的检查器选择条的特写。

![图片](img/Image00201.jpg)

*图 9-5：在故事板的工具面板中，你可以使用六个检查器。*

让我们从左到右浏览检查器。页面图标打开文件检查器。这是你可以更改故事板文件设置的地方。在本书中以及大多数应用中，你不会使用这个检查器。

下一个检查器，由问号图标表示，是快速帮助检查器。这个检查器会提供你当前在故事板中选定项的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里，你可以为故事板项设置自定义类。

接下来的两个检查器是你在工作中最常用的检查器，我们将在文本中经常提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置选定项的各种属性。比如可以用它设置标签的文本、按钮的颜色，或者文本输入框周围显示的框类型等。而尺寸检查器，图标是一个尺子，用于设置每个故事板项的大小和屏幕位置。

最后，我们有连接检查器，它的图标看起来像一个圈中的箭头。你可以使用它将故事板中的项目连接到你在类中编写的代码片段。我们将在第十章中向你展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊的视图控制器类，用于显示一个列表，在 Xcode 中称为*表视图控制器*。在我们的应用中，表视图控制器将显示你朋友的生日列表！现在它看起来只是一个空白屏幕，你将在《创建生日表视图控制器》一章的第 156 页学习如何展示生日数据。

让我们将一个表视图控制器添加到故事板中。如果你先缩小故事板的视图，使你能更好地看到视图控制器，这一步会更容易。双击故事板中视图控制器外的空白区域即可实现。现在你的屏幕应该已经缩小了。

在实用工具窗格的底部，有一个包含四个按钮的部分。选择第三个按钮，它看起来像一个圆圈中的方形。这是对象库，你可以在这里找到可以添加到故事板中的项目。滚动浏览对象库列表，直到你找到表视图控制器，或者使用窗格底部的筛选条搜索“表视图控制器”。然后点击并拖动该对象到你的故事板上，放置在已经存在的视图控制器旁边。你的故事板应该像图 9-6 中的那样。

注意，在你添加表视图控制器后，左侧的大纲视图中会出现一个“表视图控制器场景”条目，其中包含一个表视图控制器。故事板中的场景代表应用程序中的一个屏幕区域。对于 iPhone 应用，通常屏幕上一次只显示一个场景，并且该场景会填满整个屏幕。而 iPad 应用则可以在屏幕上同时显示两个或更多场景。

![图片](img/Image00202.jpg)

*图 9-6：将表视图控制器添加到生日屏幕的故事板中*

接下来的步骤是将这个新的视图控制器设置为运行应用时首先显示的屏幕，因为我们希望用户打开应用时看到生日列表。完成此操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图 ➊ 中选择**表视图控制器**。然后在工具区中打开属性检查器 ➋ 。在这里，勾选**作为初始视图控制器**的复选框 ➌ 。完成后，表视图控制器左侧应该会出现一个箭头。这个箭头表示应用启动时将显示这个视图控制器。

#### 添加导航控制器

现在，我们将在视图控制器上添加一个标题“Birthdays”，并添加一个“添加”按钮，点击后会弹出“添加生日”视图控制器。为此，我们首先将表视图控制器嵌入到一个*导航控制器*中。导航控制器管理一个或多个视图控制器，它自带一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧提供按钮，用户可以通过这些按钮在应用中的不同屏幕之间导航。你在许多 iOS 应用中都会看到这个导航栏，比如设置应用和消息应用。

在大纲视图中选择**表视图控制器**。选中后，你需要通过 Xcode 菜单将表视图控制器嵌入到导航控制器中。前往 **Editor** ▸ **Embed In** ▸ **Navigation Controller**。

在将表视图控制器嵌入到导航控制器后，你的 storyboard 应该会像图 9-8 中那样显示。导航控制器会作为一个屏幕出现在 storyboard 中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

storyboard 中的每个视图控制器代表应用中用户将看到的一个屏幕，而导航控制器则略有不同。虽然它在 storyboard 中看起来像是一个独立的屏幕，但实际上导航控制器只是一个容器，用来存放应用中用户可以在其中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在不同的视图之间进行导航。

您应该会看到导航控制器和表视图控制器顶部有灰色导航栏。当应用程序运行时，导航栏会告诉用户他们所在屏幕的标题，并可能包含按钮和箭头，供他们用来跳转到其他屏幕。为了利用导航栏告诉用户他们所在的屏幕，我们需要为屏幕命名。现在是一个很好的时机，可以再次放大故事板。双击故事板的空白区域以放大视图，然后滚动视图，以便您能看到表视图控制器。要为表视图控制器添加标题，请在大纲视图左侧的**Table View Controller Scene**下点击**Navigation Item**。

![Image](img/Image00205.jpg)

选中此项后，您可以在右侧的属性检查器中为屏幕输入一个标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。完成此步骤并按下 RETURN 后，您应该会看到大纲视图中的表视图控制器场景条目自动更新为“Birthdays Scene”。

接下来，我们将制作一个“添加”按钮，方便您添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并向该列表中添加生日。让我们制作一个按钮来实现这个功能！

我们需要在导航栏中添加一个按钮，指向“添加生日”页面，以便用户可以输入生日。在对象库中找到“Bar Button Item”，然后将其拖放到表视图控制器的导航栏右侧，如图 9-9 所示。

现在，我们希望将这个按钮变成“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮，我们可以直接使用。在属性检查器中，将条形按钮项的“System Item”更改为**Add**。您应该会看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮被点击时应该执行什么操作。我们希望它打开“添加生日”视图控制器，因此需要将“添加”按钮连接到该视图控制器。首先，双击故事板缩小视图，以确保您能够看到“Birthdays”表视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，将加号按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时，松开鼠标。这时会弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将 Bar Button Item 拖放到“Birthdays”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在出现的对话框中选择“Present Modally”。*

连接对话框为你提供了几种不同的*过渡效果*——即从一个屏幕到另一个屏幕的过渡方式——你可以选择的选项。点击连接对话框中的**模态展示**选项。这将使视图控制器作为*模态*视图控制器呈现到屏幕上。在 iPhone 上，模态视图控制器会从手机底部滑入屏幕，并且不会自动带有返回按钮来返回到前一个屏幕。相反，模态视图控制器可能会带有其他按钮，例如取消或保存。还有其他类型的过渡效果，比如显示过渡（Show segue），在这种情况下，视图控制器会从屏幕右侧推送到屏幕上，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，应该将该屏幕显示为模态视图，并配有取消按钮。否则，如果你使用像“显示过渡”（Show segue）这样的过渡效果，并且有返回按钮，用户可能会在输入完所有内容后，点击返回按钮而没有保存任何东西！而带有取消按钮的模态视图，用户必须明确点击取消才能退出屏幕。

要查看模态输入视图控制器的一个好例子，可以看看你 iPhone 或 iPad 上的日历应用。打开它后，你会看到导航栏右侧有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下取消并退出屏幕，右侧有一个添加按钮，用于在关闭模态视图之前创建新事件。你会发现，“新事件”模态视图从屏幕底部滑入，退出时则从屏幕上滑下去。我们希望用户能够保存生日信息，因此我们也将使用模态视图。

现在，让我们尝试运行我们的应用，看看我们到目前为止做了什么！要运行应用，首先选择一个设备模拟器，方法是点击 Xcode 左上角“BirthdayTracker”旁边列出的设备（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器将运行的设备，设备名称位于你的应用程序名称旁边。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用程序。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R** 。

当模拟器启动并运行你的应用时，如果模拟器的大小过大以至于无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器以选中它，然后进入**窗口** ▸ **缩放**，并在模拟器菜单中选择一个更小的比例。

到目前为止，当你运行应用时，变化不大。你应该能看到你的第一个生日屏幕，上面有一个“+”按钮，如图 9-1 所示。显然，在这个时候，你的生日屏幕是空的。点击“+”按钮会弹出一个第二个空白屏幕。当你查看完应用后，通过点击 Xcode 中的停止按钮来关闭它，停止按钮位于你之前按下的播放按钮旁边。停止应用后，你现在应该能在模拟器的主屏幕上看到你的应用图标！（见图 9-12）。

就是这样！现在我们需要配置第二个屏幕，以便它可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们从添加标题开始设计“添加生日”视图控制器。为此，你需要将它嵌入到一个独立的导航控制器中。当视图控制器是模态视图时，它不会继承已经在我们的故事板上的导航控制器中的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器来选择它。然后，前往**编辑** ▸ **嵌入** ▸ **导航控制器**。现在你应该可以看到，在视图控制器场景下的轮廓视图中添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤和你在为表格视图控制器添加“生日”标题时所做的相同。

现在，当“添加生日”视图控制器出现在应用中时，顶部会显示它的标题标签。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每条记录都会有一个名字、一个姓氏和一个生日日期。让我们为“添加生日”视图控制器添加一些*输入控制*，让用户可以为每个人输入这些信息。输入控制包括文本框或下拉菜单等，允许用户将数据输入到应用中。我们将通过为用户可以添加的所有信息添加输入控制标签来开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个标签，内容为“名字”。这个标签将放置在一个文本框旁边，供你输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框，输入**名字**作为显示文本，如图 9-14 所示。

现在，我们希望使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*为单位的。请注意，1 个点并不等于 1 个像素。根据您的应用运行的设备类型，1 个点可能转换为 1 个像素、一个 2×2 像素的方块，或者一个 3×3 像素的方块。这三种缩放因子被称为 @1x、@2x 和 @3x（我们在设置应用图标时也讨论过相同的尺寸）。不同的设备也有不同的点分辨率，宽度可能从 320 点到 1,024 点，高度可能从 568 点到 1,366 点。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，您将无法在这些型号上运行应用（BirthdayTracker 只支持 iOS 10+）。除非您的设备是 iPhone 6 Plus、6s Plus 或 7 Plus，否则您的手机或 iPod 很可能使用 @2x 缩放因子，后者使用 @3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 坐标是从屏幕左侧到对象左侧的点数。y 坐标是从屏幕顶部到对象顶部的点数。（请参见图 9-15。）我们将设置添加到视图控制器中的每个库对象的 x 坐标和 y 坐标。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 坐标、y 坐标、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，但仍然为文本输入框和其他标签及输入留出足够的空间。在大小检查器的视图部分，将 x 坐标设置为 20，y 坐标设置为 100，宽度设置为 100。将高度保持为 21。

完成此操作后，重复这些步骤将另外两个标签添加到“添加生日”视图控制器中：一个姓氏标签和一个出生日期标签。我们需要设置其他标签和输入的位置，以避免它们重叠。在某些情况下，这可能会变得棘手，可能需要一些时间。对于这个应用，我们已经为您计算了可以在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何使应用在其他设备上运行。表 9-1 列出了您应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 坐标相同，所以它们在垂直方向上对齐，但它们的 y 坐标不同。每个标签的高度为 21，因此 y 坐标需要比下一个最近的标签至少大 21 点。由于我们在每个标签下方也添加了输入控件，所以我们将 y 坐标设置得更大，以适应标签和输入控件的高度。

很棒！现在你的故事板应该看起来像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入框的标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们让你能够输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中看到的大小和位置设置这两个文本字段。你可以使用大小检查器，就像设置标签一样。

表 9-2：视图控制器中的输入用文本字段

| 文本字段 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加一个名为*日期选择器*的滚轮。这样，你就可以轻松地输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，允许用户选择日期或时间。它可以同时包含日期和时间，像日历应用中使用的日期选择器一样（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，例如在时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的。

在对象库中滚动，直到找到日期选择器，然后将其点击并拖动到出生日期标签下的视图控制器中。使用大小检查器，将 x 坐标设置为 0，y 坐标设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器进行选择。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将这个日期改为你的出生日期！将日期字段从“当前日期”更改为 **自定义**。这样会出现一个新的框，修改日期为你的出生日期。

让我们通过运行应用程序来测试它到目前为止的工作效果！我们为输入控件设置的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你在“生日”视图控制器上点击 + 按钮时，应该会显示“添加生日”屏幕，如 图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个更小的模拟器来运行应用程序，例如 iPhone 5s，然后再次运行应用程序。你会发现界面看起来不太对劲。

你添加到故事板上的所有元素都已经出现，但文本字段已经超出了屏幕边缘。现在你已经将所有元素放置在屏幕上，下一步是让它们在任何屏幕尺寸上正确显示。我们将通过一个叫做 *自动布局* 的工具来实现这一点。

#### 在每个设备上通过自动布局让你的应用看起来完美

单单是 iPhone 就有三种不同的屏幕尺寸，而且未来可能会有更多尺寸出现。你需要设计应用程序，使其在任何设备上看起来都很不错。这意味着你需要让应用程序调整所有元素的位置和大小，以适应运行应用程序的设备。自动布局使用一种叫做 *布局约束* 的方式来摆放屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择 **视图控制器**。接着，看看编辑器面板右下角的四个图标（见 图 9-20 ）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标来打开自动布局菜单。*

在屏幕的故事板面板底部，有一个带有图标的带状栏，实用工具面板之前的最右侧图标是一个位于两条竖线之间的三角形。将鼠标光标悬停在该图标上时，应该会显示一个标签，标明“解决自动布局问题”。点击此图标以弹出建议菜单。点击**添加缺失的约束**。^(*) 当你这么做时，你会看到许多布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适应屏幕宽度，并且不会超出边界。自动布局还会确保每个文本框前后都有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，“添加生日”界面应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。按钮目前不会有任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消“添加生日”界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮设置为保存按钮，就像我们设置添加按钮一样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，并将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该看起来像图 9-21 所示的样子。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新的按钮！

在“生日”表视图控制器上点击 + 按钮，应该会带你到“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前不会有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你通过创建“生日”界面和“添加生日”界面的基本用户界面，开始制作一个生日追踪应用。你还通过使用表视图控制器创建了“生日”界面，并让用户能够通过“添加”按钮和导航控制器在各个界面之间进行切换。

现在，你已经完成了应用的基本框架，接下来将在第十章中编程实现取消和保存按钮的功能，这样你就可以在应用中添加和保存生日信息了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用，这是苹果的一个 bug。在这种情况下，选择**重置为缺失的约束**选项来添加缺失的约束。

*图 9-4：我们现在有了一个应用图标！*

除了应用图标，应用程序还有一个显示名称，显示在首页图标下方。默认情况下，这就是应用的名称 BirthdayTracker。然而，这个名称有点太长，无法完全显示在应用图标下方，因此我们将其更改为一个更短的名称：Birthdays。为此，通过选择项目导航器中的 BirthdayTracker 项目回到设置页面。在顶部的身份部分，你可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这将仅更改显示在应用图标下方的名称。你的项目名称仍将是 BirthdayTracker。

现在我们已经设置了应用图标和显示名称，让我们创建应用的屏幕吧！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*以调出故事板。在这里，我们将设计应用的*用户界面*。用户界面是指用户将看到并与之互动的内容——图片、文本、按钮等。*故事板*让你能够直观地组织应用的屏幕。我们将使用故事板查看所有使用的屏幕及它们之间的连接。

一旦选择了*Main.storyboard*，按下⌘-0 隐藏导航窗格，这样你就能获得更多的屏幕空间。你的故事板应该已经包含一个视图控制器。

现在看看工具区的顶部。你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更仔细查看故事板中元素的工具，并允许你更改这些元素的设置。当你选择其中一个检查器时，它会出现在工具区中。

**检查故事板项目**

图 9-5 显示了故事板打开时出现在工具区中的检查器选择栏的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：在故事板的工具区中，你可以使用六个检查器。*

让我们从左到右浏览这些检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书和大多数应用程序中，你不会使用这个检查器。

下一个检查器，标识为一个问号图标，是快速帮助检查器。这个检查器将为你提供关于你当前在故事板中选中的项目的详细类信息。

第三个检查器，带有身份证图标的是身份检查器。在这里，你可以为故事板项目设置自定义类。

接下来的两个检查器是你在使用故事板时最常用的，我们将在文本中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置故事板中选定项的各种属性。例如，它可以用来设置标签的文本、按钮的颜色，或文本输入框周围显示的框类型。尺寸检查器，图标是一个标尺，用于设置每个故事板项的大小和屏幕位置。

最后是连接检查器，它的图标看起来像一个圆圈中的箭头。这个工具可以用来将故事板中的元素与在类中编写的代码连接起来。我们将在第十章中向你展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊的视图控制器类，用于显示列表，在 Xcode 中称为*表视图控制器*。在我们的应用中，表视图控制器将显示你朋友的生日列表！现在它只会显示一个空白屏幕，你将在“创建生日表视图控制器”一节中学习如何在第 156 页显示生日数据。

让我们向故事板中添加一个表视图控制器。如果你先将故事板缩小，这一步会更容易，因为你可以更好地查看视图控制器。双击视图控制器外的空白区域来实现这一点。现在你的屏幕应该已经缩小了。

在工具区的底部有一个区域，顶部有四个按钮。选择第三个按钮，它看起来像一个圆圈内的正方形。这个是对象库，在这里你可以找到可以添加到故事板中的元素。滚动对象库列表，直到找到表视图控制器，或者使用面板底部的过滤栏搜索“table view controller”。然后点击并拖动该对象到你的故事板上，放置在已经存在的视图控制器旁边。你的故事板应该看起来像图 9-6 中的样子。

注意，在你添加表视图控制器后，左侧的大纲视图中会出现一个表视图控制器场景条目，并且其中包含一个表视图控制器。故事板中的场景代表应用程序中的一个屏幕区域。对于 iPhone 应用，通常一次屏幕上只有一个场景，并且该场景填满整个屏幕。而 iPad 应用可以在屏幕上同时显示两个或更多场景。

![图片](img/Image00202.jpg)

*图 9-6：向故事板添加一个表视图控制器，用于显示生日界面*

下一步是让这个新的视图控制器成为应用程序运行时首先显示的屏幕，因为我们希望用户打开应用程序时看到生日列表。执行此操作的步骤如图 9-7 所示。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表视图控制器，并将其设为初始视图控制器。*

首先，在大纲视图中选择**表视图控制器** ➊。然后在工具区中打开属性检查器 ➋。在那里，勾选**是初始视图控制器** ➌。完成后，您应该会看到一个箭头出现在故事板中表视图控制器的左侧。该箭头表示应用程序启动时会显示这个视图控制器。

#### 添加导航控制器

现在，我们将为视图控制器添加一个标题，显示为“生日”，并添加一个“添加”按钮，点击后会弹出添加生日的视图控制器。为此，我们首先将表视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧放置按钮，用于导航到应用程序中的其他屏幕。在许多 iOS 应用程序中，您可以看到这个导航栏，例如设置应用和信息应用。

在大纲视图中选择**表视图控制器**。选择后，您需要使用 Xcode 菜单将表视图控制器嵌入导航控制器。前往**编辑** ▸ **嵌入到** ▸ **导航控制器**。

将表视图控制器嵌入导航控制器后，您的故事板应该类似于图 9-8。导航控制器将作为故事板中的一个屏幕显示。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表用户在应用程序中看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像一个单独的屏幕，但导航控制器实际上只是一个容器，包含了用户在应用程序中切换的其他视图控制器。将视图控制器嵌入导航控制器意味着您的应用程序可以在不同的视图之间来回导航。

你应该能看到导航控制器和表格视图控制器顶部的灰色导航栏。当应用运行时，导航栏会告诉用户当前所在屏幕的标题，并可能包含按钮和箭头，用户可以用它们进入其他屏幕。为了通过导航栏告诉用户当前所在的屏幕，我们需要为屏幕命名。现在是时候将故事板缩小回来了。双击故事板的空白区域以放大视图，然后滚动视图，以便你能看到表格视图控制器。要为表格视图控制器添加标题，请在左侧大纲视图中点击**表格视图控制器场景**下的**导航项**。

![Image](img/Image00205.jpg)

选中此项后，你可以在右侧的属性检查器中输入屏幕标题。我们希望导航栏显示“生日”作为标题，因此在标题字段中输入**生日**。你应该能看到，完成此步骤并按下 RETURN 键后，大纲视图中的“表格视图控制器场景”条目自动更新为“生日场景”。

接下来，我们将创建一个添加按钮，以便你可以添加生日！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并向该列表添加生日。让我们创建一个按钮，让他们能够做到这一点！

我们需要在导航栏上添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。在对象库中找到条形按钮项，然后将其拖放到表格视图控制器的导航栏右侧，如图 9-9 所示。

现在，我们希望将这个按钮变成一个添加按钮。幸运的是，Xcode 提供了一个内置的添加按钮，我们可以直接使用。在属性检查器中，将条形按钮项的系统项目更改为**添加**。你应该能看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮被点击时应该做什么。我们希望它打开“添加生日”视图控制器，因此需要将添加按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你能同时看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，拖动加号按钮到故事板右侧空白视图控制器的中间。当视图控制器高亮时，放开鼠标。这时会弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将条形按钮项拖动到生日视图控制器的导航栏。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态展示”。*

连接对话框会为你提供几种不同类型的*segue*—从一个屏幕到另一个屏幕的过渡。点击连接对话框中的**模态呈现**选项。这样，视图控制器会作为*模态*视图控制器呈现到屏幕上。在 iPhone 上，模态视图控制器是从手机底部滑上来的，并且不会自动带有返回按钮返回到上一个屏幕。相反，模态可以有其他按钮，比如取消或保存。还有其他类型的 segue，比如 Show segue，其中一个视图控制器从右侧推入屏幕，并且导航栏左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，屏幕应该作为一个模态展示，并且带有一个取消按钮。否则，如果你使用类似 Show segue 的方式，并配有返回按钮，用户可能会输入所有内容后点击返回按钮，结果并没有保存任何东西！有了取消按钮，用户必须有意识地点击才能取消该屏幕。

要查看一个很好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧会有一个+按钮，你可以点击它来添加一个日历事件。点击+按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以不保存并退出屏幕，右侧有一个添加按钮，用于在关闭模态前创建新事件。你应该能看到，新事件模态是从屏幕底部滑入的，取消时会再次滑回底部。我们希望用户能够保存生日事件，因此我们也会使用模态。

现在，让我们试着运行我们的应用，看看目前为止做了什么！要运行应用，首先通过点击 Xcode 左上角 BirthdayTracker 旁边列出的设备，选择一个设备模拟器（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角设备旁边设置模拟器将运行的设备，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择的是 iPhone 7。在选择了模拟器后，点击左上角的播放按钮，或者使用键盘快捷键⌘ -**R**。

当模拟器启动并运行你的应用时，如果应用的大小过大无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器以选中它，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的比例。

到目前为止，当你运行应用时，没发生太多变化。你应该能看到你的第一个“生日”屏幕，上面有一个+按钮，如前面在图 9-1 中所示。显然，在这一点上，你的“生日”屏幕将是空的。点击+按钮将弹出第二个空白屏幕。完成查看应用后，通过点击 Xcode 中的停止按钮来关闭它，停止按钮位于你之前点击的播放按钮旁边。当你停止应用时，你应该能在模拟器的主屏幕上看到你的应用图标！（见图 9-12）。

就这样！现在我们需要配置第二个屏幕，以便它可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，通过添加它的标题来开始。为此，你需要将它嵌入到一个独立的导航控制器中。当一个视图控制器是模态时，它不会继承我们在故事板上已经存在的导航控制器的导航栏。导航控制器提供导航栏，所以我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的纯视图控制器来选择它。然后进入**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该能看到在视图控制器场景下的轮廓视图中添加了一个导航项。点击这个新导航项，然后在属性检查器中添加标题**添加生日**。这些步骤和你之前为表视图控制器添加“生日”标题时的步骤相同。

现在，当“添加生日”视图控制器出现在应用中时，它将在顶部显示其标题。

#### 添加朋友的姓名和生日

当你在第十章中输入朋友的生日时，应用中的每一条记录都会包含名字、姓氏和生日。让我们在“添加生日”视图控制器中添加一些*输入控件*，这样用户就可以为每个人输入所有信息了。输入控件是诸如文本框或下拉菜单之类的控件，允许用户在应用中输入数据。我们将首先添加所有用户可以添加的信息的输入控件标签。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器创建一个显示“名字”的标签。这个标签将位于一个文本框旁边，用户可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：在“添加生日”视图控制器中添加一个标签。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在，我们想通过大小检查器来设置标签的大小和位置。在 Xcode 的 Storyboard 中，宽度和高度以*点*为单位进行测量。请注意，1 点并不等于 1 像素。根据你的应用程序运行的设备类型，1 点将转换为 1 个像素、一个 2×2 像素的方块，或者一个 3×3 像素的方块。这三种缩放因子分别被称为@1x、@2x 和@3x（我们在设置应用图标时提到过这些相同的尺寸）。不同设备的点分辨率也不同，宽度从 320 到 1024 点不等，高度从 568 到 1366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示“First Name”*

只有最旧的 iPhone 和 iPod 型号使用@1x 缩放因子，而你将无法在这些型号上运行应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，这些设备使用@3x 缩放因子，否则它们的缩放因子应该是@2x。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15）我们将设置我们添加到视图控制器中的每个库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在离屏幕边缘稍远的位置，同时留出足够的空间给其文本输入框以及其他标签和输入框。在“大小检查器”的“视图”部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

在完成此操作后，重复这些步骤，在“添加生日”视图控制器中添加两个标签：姓氏标签和出生日期标签。我们需要调整其他标签和输入框的位置，以避免它们重叠。在某些情况下，这可能会变得有些棘手，可能需要一些时间。对于这个应用程序，我们已经为你计算出了可以放置对象的 iPhone 7 屏幕位置。稍后，我们将解释如何让你的应用程序兼容其他设备。表 9-1 列出了你应该为每个标签设置的尺寸和位置。

表 9-1：视图控制器中的输入标签设置

| 显示文本 | x 位置 | y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你会看到所有标签的 x 位置相同，从而使它们垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置需要比下一个最接近的标签大至少 21 个点。由于我们还将输入控件添加到每个标签下方，因此我们将 y 位置增大，以适应标签的高度和输入控件的高度。

太好了！现在你的故事板应该看起来像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：已将输入标签添加到视图控制器。*

接下来，你将添加两个*文本字段*，它们允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中的尺寸和位置设置这两个文本字段。你可以使用大小检查器进行设置，就像之前设置标签时一样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做*日期选择器*的控件。它将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，像在日历应用中使用的日期选择器（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以只显示时间，比如在时钟应用中用于设置闹钟的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后将其点击并拖到“出生日期”标签下的视图控制器中。使用大小检查器，将 x 位置设为 0，y 位置设为 280。

你需要调整日期选择器的几个属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们把这个日期改为你的生日吧！将日期字段从“当前日期”改为**自定义**。这样会出现一个新框，输入你的生日。

让我们通过运行应用来测试目前为止的工作！我们为输入控件使用的尺寸在 iPhone 7 屏幕上很合适。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你在生日视图控制器上点击+按钮时，“添加生日”屏幕应该会显示出来，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很不错，但其他设备呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，再次运行应用。你会看到，有些地方看起来不太对劲。

你添加到故事板中的所有元素都显示出来了，但文本框超出了屏幕边缘。现在你已经将所有元素放在了屏幕上，下一步是让它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来完成这个任务。

#### 使用自动布局让你的应用在每个设备上看起来完美

单独的 iPhone 有三种不同的屏幕尺寸，并且未来可能会有更多尺寸。你需要设计你的应用，让它在任何设备上看起来都不错。这意味着你需要让你的应用根据运行应用的设备调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器窗格右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕故事板窗格的底部，有一个带有图标的功能区，在“实用工具”窗格之前的最右侧图标是一个夹在两条竖线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，标明“解决自动布局问题”。点击这个图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到在“添加生日”场景中添加了一大堆布局约束。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局使得日期选择器的宽度适应屏幕的宽度，并且不会超出屏幕边缘。自动布局还确保每个文本字段前后有 20 个点的间距，使其在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这次，添加生日屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成最后的步骤，我们将展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。这些按钮目前不会有任何功能，我们只会设置它们。在第十章中，我们将添加代码，使它们能够取消添加生日屏幕并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个 Bar 按钮项并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们做添加按钮一样。选择按钮项，然后使用属性检查器将其改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar 按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，方法与设置保存按钮时相同。你的视图控制器应该如下图所示：图 9-21。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新按钮的效果！

在生日表格视图控制器中点击+按钮应该会带你进入添加生日视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前没有任何反应——我们将在第十章中实现这两个按钮！

### 你学到的内容

在本章中，你通过创建生日和添加生日屏幕的基本用户界面开始制作一个 BirthdayTracker 应用程序。你还使用表格视图控制器创建了生日屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用程序的基本框架，第十章将指导你编程实现取消和保存按钮，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，"添加缺失约束"选项是禁用的。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

除了应用图标外，应用程序还有一个显示名称，它会显示在首页图标下方。默认情况下，这就是应用程序的名称 BirthdayTracker。然而，这个名字有点长，无法适应图标下方，所以我们将其改为一个更短的名称：Birthdays。为此，回到设置页面，在项目导航器中选择 BirthdayTracker 项目。在顶部的身份部分，你可以更改应用的显示名称。只需在显示名称文本框中输入**Birthdays**。这将只更改显示在应用图标下方的名称。项目的名称仍将是 BirthdayTracker。

现在我们已经设置好了应用程序图标和显示名称，接下来让我们创建应用屏幕！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*，以打开故事板。这是我们将设计应用程序*用户界面*的地方。用户界面只是用户将看到并用来与应用交互的内容——图像、文本、按钮等等。*故事板*让你可以直观地组织应用程序的各个屏幕。我们将使用故事板查看所有使用的屏幕以及它们之间的连接。

选择了*Main.storyboard*之后，按⌘-0 隐藏导航面板，以便腾出更多的屏幕空间。你的故事板应该已经包含了一个视图控制器。

现在看一下工具面板的顶部。你应该能看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是一些工具，可以帮助你更仔细地查看故事板中的元素，并允许你更改这些元素的设置。当你选择其中一个检查器时，它将出现在工具面板中。

**检查故事板项目**

图 9-5 显示了故事板打开时在工具面板中出现的检查器选择栏的特写。

![Image](img/Image00201.jpg)

*图 9-5：你可以在故事板的工具面板中使用六个检查器。*

让我们从左到右依次浏览这些检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书和你大部分的应用程序中，你不会使用这个检查器。

下一个检查器，标有问号图标，是快速帮助检查器。这个检查器将提供你当前在故事板中选中的项目的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里你可以为故事板项目设置自定义类。

接下来的两个检查器是你在故事板中工作时最常使用的，我们将在文本中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置选定项的各种属性。例如，它可以用于设置标签的文本、按钮的颜色，或者设置文本输入框周围显示的框类型。尺寸检查器的图标是一个尺子，用于设置每个故事板项的大小和屏幕位置。

最后，还有连接检查器，它的图标看起来像一个圈中的箭头。这个检查器可以将故事板中的项与代码中的类连接起来。我们将在第十章中展示如何进行此操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊类型的视图控制器，用于显示列表，在 Xcode 中称为*表视图控制器*。在我们的应用中，表视图控制器将显示你朋友的生日列表！现在它看起来只是一个空白屏幕，你将在“创建生日表视图控制器”中学习如何显示生日数据，第 156 页将为你展示相关内容。

让我们将表视图控制器添加到故事板中。如果你先将故事板缩小，以便更好地查看视图控制器，这一步会更容易。你可以通过双击视图控制器外的空白区域来实现此操作。现在你的屏幕应该已经缩小。

在工具区底部有一个包含四个按钮的区域。选择第三个按钮，它看起来像一个圆圈中的正方形。这是对象库，你可以在其中找到可以添加到故事板中的项。滚动浏览对象库列表，直到找到表视图控制器，或者使用面板底部的过滤条搜索“table view controller”。然后将该对象点击并拖动到你的故事板上，放在已经存在的视图控制器旁边。你的故事板应该像图 9-6 中那样。

请注意，在添加表视图控制器后，左侧的大纲视图中会出现一个表视图控制器场景条目，里面有一个表视图控制器。故事板中的场景代表应用中的屏幕区域。对于 iPhone 应用，通常一次屏幕上只显示一个场景，并且该场景会填满整个屏幕。iPad 应用可以在屏幕上同时显示两个或更多场景。

![图片](img/Image00202.jpg)

*图 9-6：将表视图控制器添加到生日屏幕的故事板中*

下一步是将这个新的视图控制器设置为应用启动时首先显示的屏幕，因为我们希望用户打开应用时能够看到生日列表。执行此操作的步骤显示在图 9-7 中。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择“表格视图控制器”，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊ 。然后在工具窗格中调出属性检查器 ➋ 。在此，勾选**是初始视图控制器** ➌ 的框。完成此操作后，您的表格视图控制器旁边应该会出现一个箭头。这个箭头表示，当应用首次启动时，将显示这个视图控制器。

#### 添加导航控制器

现在，我们将给视图控制器添加一个标题“生日”和一个“添加”按钮，用于显示添加生日的视图控制器。为此，我们首先将表格视图控制器放入*导航控制器*中。导航控制器管理一个或多个视图控制器，它自带一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题，以及左右两侧的按钮，用于导航到应用中的其他屏幕。您可以在多个 iOS 应用中看到这个栏，比如设置应用和消息应用。

在大纲视图中选择**表格视图控制器**。选择后，您需要使用 Xcode 菜单将表格视图控制器嵌入到导航控制器中。转到**编辑** ▸ **嵌入到** ▸ **导航控制器**。

在将表格视图控制器嵌入导航控制器后，您的故事板应如下所示，类似于图 9-8 。导航控制器将作为一个屏幕显示在故事板中。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

每个视图控制器在故事板中代表应用的一个屏幕，用户将看到该屏幕，但导航控制器有些不同。尽管它在故事板中看起来像一个独立的屏幕，但导航控制器实际上只是一个容器，用来存放用户在应用中切换的其他视图控制器。将视图控制器嵌入导航控制器中意味着您的应用可以在不同的视图之间进行导航，并且可以返回。

你应该能在导航控制器和表视图控制器的顶部看到灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们所在的屏幕的标题，并且可能还会包含按钮和箭头，用户可以使用它们跳转到其他屏幕。为了让导航栏告诉用户他们所在的屏幕，我们需要为屏幕命名。现在是时候重新聚焦到故事板了。双击故事板的空白区域以放大，然后滚动视图，以便你能看到表视图控制器。要为表视图控制器添加标题，点击左侧大纲视图中的**导航项**，该项位于**表视图控制器场景**下。

![Image](img/Image00205.jpg)

选中后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，所以在右侧的标题字段中输入**生日**。你应该会看到，完成此步骤并按下 RETURN 后，左侧大纲视图中的表视图控制器场景条目会自动更新为“生日场景”。

接下来，我们将制作一个“添加”按钮，让你可以添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并向该列表中添加一个生日。让我们制作一个按钮，让他们可以做到这一点！

我们需要在导航栏中添加一个按钮，指向“添加生日”场景，这样用户就可以输入生日了。在对象库中找到条形按钮项，然后将其拖放到表视图控制器导航栏的右侧，如图 9-9 所示。

现在我们想把这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮可以使用。在属性检查器中，将条形按钮项的系统项更改为**添加**。你应该会看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在点击时应该做什么。我们希望它能打开“添加生日”视图控制器，因此需要将“添加”按钮与该视图控制器连接起来。首先，双击故事板以缩小视图，确保你可以看到生日表视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，并从“+”按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标，这将弹出一个连接对话框，类似于图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个条形按钮项拖到生日视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在出现的对话框中选择“模态展示”。*

连接对话框为你提供了几种*segue*类型——即从一个界面到另一个界面的过渡方式——可以选择。点击连接对话框中的**模态展示**选项。这将使视图控制器作为*模态*视图控制器呈现到屏幕上。在 iPhone 上，模态视图控制器从屏幕底部滑上来，并且默认没有返回按钮来返回到前一个界面。相反，模态界面可以有其他按钮，如取消或保存。有其他类型的 segue，比如 Show segue，其中一个视图控制器从右侧滑动到屏幕上，并且在导航栏左侧有一个返回按钮。

在 iOS 应用中，当你展示一个获取并保存用户输入的界面时，这个界面应该作为一个模态框呈现，并带有一个取消按钮。否则，如果你使用类似 Show segue 并带有返回按钮，用户可能会遇到这样一种情况：他们输入了所有内容后，点击返回按钮而没有保存任何内容！有了取消按钮，用户必须故意点击取消以退出界面。

要查看一个模态输入视图控制器的良好示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个+按钮，你可以点击它来添加日历事件。点击+按钮会弹出一个模态的新增事件视图控制器。这个视图控制器左侧有一个取消按钮，用于在不保存的情况下退出界面，右侧有一个添加按钮，用于在关闭模态界面之前创建新事件。你应该能看到，新增事件的模态界面从屏幕底部滑上来，关闭时又滑回去。我们希望用户保存生日信息，因此我们也会使用模态框。

现在让我们尝试运行应用，看看我们到目前为止做了什么！要运行应用，首先选择一个设备模拟器，点击 Xcode 左上角 BirthdayTracker 旁边列出的设备（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角，设置模拟器将运行的设备，位于应用名称旁边。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表供你选择用于运行应用的设备。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用键盘快捷键⌘ -**R**。

当模拟器打开并运行你的应用时，如果它太大而无法适应你的计算机屏幕，你可以调整其大小。点击模拟器进行选择，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时，似乎没有太多变化。你应该能看到第一个生日页面，并且有一个+按钮，正如图 9-1 中所示。当然，此时你的生日页面是空的。点击+按钮会弹出第二个空白页面。查看完应用后，点击 Xcode 中的停止按钮关闭应用，这个按钮位于你之前点击的播放按钮旁边。当你停止应用时，你应该会在模拟器的主屏幕上看到应用图标！（见图 9-12。）

就这样！现在我们需要配置第二个屏幕，使其可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已经添加到主屏幕上。*

### 设置控件输入和标签

让我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，你需要将其嵌入到一个自己的导航控制器中。当一个视图控制器是模态时，它不会继承我们故事板中已有的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器来选择它。然后，转到**编辑** ▸ **嵌入** ▸ **导航控制器**。现在，你应该能看到一个导航项已被添加到视图控制器场景下的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**Add a Birthday**。这些步骤和你之前为表视图控制器添加标题“Birthdays”时的步骤相同。

现在，当“添加生日”视图控制器出现在应用中时，顶部会显示它的标题。

#### 添加朋友的姓名和生日

当你在第十章中输入朋友的生日时，应用程序中的每条记录将包含一个名字、一个姓氏和一个生日。让我们在“添加生日”视图控制器中添加一些*输入控件*，以便用户为每个人输入这些信息。输入控件是允许用户向应用程序输入数据的控件，如文本框或下拉菜单。我们将从为用户可以添加的所有信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“First Name”（名字）的标签。这个标签将位于一个文本框旁边，用户可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们希望使用大小检查器设置标签的大小和位置。在 Xcode 情景图中，宽度和高度以*点*为单位进行测量。请注意，1 点不等于 1 像素。根据你的应用程序运行的设备类型，1 点会转换为 1 像素、2×2 像素的方块或 3×3 像素的方块。这三种缩放因子分别称为 @1x、@2x 和 @3x（我们在设置应用程序图标时讨论过的相同大小）。设备的点分辨率也不完全相同，宽度可以从 320 到 1,024 点不等，长度从 568 到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* 姓氏

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，并且你无法在这些型号上运行你的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，否则你的手机或 iPod 很可能使用 @2x 缩放因子，后者使用 @3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离，单位为点。y 位置是从屏幕顶部到对象顶部的距离。（见 图 9-15）我们会设置每个添加到视图控制器的库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签定位，使其不在屏幕的边缘，但仍然为其文本输入框和其他标签及输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成此操作后，重复这些步骤，将两个标签添加到“添加生日”视图控制器中：一个“姓氏”标签和一个“出生日期”标签。我们需要将其他标签和输入框定位，以避免它们重叠。在某些情况下，这可能会变得复杂，可能需要一些时间。对于这个应用程序，我们已经为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们会解释如何让应用程序在其他设备上运行。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中的输入标签设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x-位置相同，这样它们就能垂直对齐，但每个标签的 y-位置都不同。每个标签的高度为 21，因此 y-位置需要至少比下一个最接近的标签大 21 个点。由于我们要在每个标签下方添加输入控件，因此我们将 y-位置调大，以容纳标签的高度和输入控件的高度。

太棒了！现在你的故事板应该和图 9-16 中的一样了。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器。*

接下来你将添加两个*文本字段*，让你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个将用于输入名字，另一个将用于输入姓氏。根据表 9-2 中的位置和大小调整这两个文本字段。你可以通过大小检查器进行调整，就像之前对标签进行的操作一样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X-位置 | Y-位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个被称为*日期选择器*的控件。这个控件将让你轻松地输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用程序中用于让用户选择日期或时间的标准工具。它可以显示日期和时间，就像日历应用程序中的日期选择器（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以只显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中将要使用的功能。

滚动浏览对象库，直到找到一个日期选择器，然后点击并拖动它到视图控制器中的出生日期标签下方。使用大小检查器，将 x-位置设置为 0，y-位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器会显示当前日期。让我们将这个日期改为你的生日吧！将日期字段从当前日期更改为**自定义**。更改后，会出现一个新的框，改成你的生日。

让我们通过运行应用来测试到目前为止的效果！我们为输入控件选择的尺寸适合 iPhone 7 的屏幕。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击生日视图控制器上的+按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这个界面在 iPhone 7 上看起来很好，但其他设备呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，并重新运行应用。你会发现界面看起来有些不对劲。

所有添加到故事板中的元素都已显示，但文本字段超出了屏幕边缘。现在，所有元素都已显示在屏幕上，下一步是确保它们能够在任何屏幕尺寸上正确适配。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 在每个设备上使用自动布局让你的应用看起来完美

iPhone 本身有三种不同的屏幕尺寸，未来可能还会推出更多尺寸。你需要设计你的应用程序，以确保它在任何设备上都看起来不错。这意味着，你的应用程序需要调整其中所有元素的位置和大小，以适应运行应用程序的设备。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来打开自动布局菜单。*

在屏幕故事板面板的底部有一排带有图标的按钮，位于“实用工具”面板前的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，上面写着“解决自动布局问题”。点击这个图标，会弹出一组建议菜单。点击**添加缺失的约束**。^(*) 点击后，你会看到一大堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局会确保日期选择器的宽度适应屏幕的宽度，不会超出边界。自动布局还会确保每个文本字段前后有 20 个点的间距，使它们在屏幕上居中。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”屏幕应该完美显示。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。这些按钮现在不会做任何事情。我们只是设置它们。在第十章中，我们将添加一些代码，让它们可以取消添加生日屏幕并保存生日到应用程序。

要添加保存按钮，从对象库中拖动一个“条形按钮项”，并将其放置在导航栏的*右*侧。我们将把这个按钮更改为保存按钮，就像我们做的添加按钮一样。选择该按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“条形按钮项”，这次将其放置在导航栏的*左*侧。使用属性检查器将其设置为取消按钮，就像你之前设置保存按钮一样。你的视图控制器应该像图 9-21 中显示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新的按钮！

点击生日表视图控制器上的+按钮应该会将你带到“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮现在不会执行任何操作——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始通过创建生日和添加生日屏幕的基本用户界面来制作一个 BirthdayTracker 应用程序。你还使用表视图控制器创建了生日屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经有了应用程序的基本框架，接下来你将在第十章中编写取消和保存按钮的代码，以便你可以在应用程序中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是一个苹果的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

现在我们已经设置了应用程序图标和显示名称，让我们来创建应用程序的屏幕！

### 显示你朋友的生日

从项目导航器中选择*Main.storyboard*以打开故事板。这是我们将设计应用程序的*用户界面*的地方。用户界面只是用户将看到并用来与应用程序交互的元素的花哨名称——如图像、文本、按钮等。*故事板*让你可以直观地组织应用程序的各个屏幕。我们将使用故事板查看所有使用的屏幕以及它们之间的连接。

一旦选择了*Main.storyboard*，按⌘-0 隐藏导航窗格，以便为屏幕提供更多空间。你的故事板应该已经包含了一个视图控制器。

现在，看看工具窗格的顶部。你应该会看到一个带有六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更仔细查看故事板中元素并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它会出现在工具窗格中。

**检查故事板项**

图 9-5 显示了在打开故事板时，检查器选择栏在工具窗格中的特写视图。

![Image](img/Image00201.jpg)

*图 9-5：在故事板的工具窗格中，你可以使用六个检查器。*

让我们从左到右逐一查看检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书中以及大多数应用程序中，你不会使用这个检查器。

下一个检查器，标有问号图标，是快速帮助检查器。此检查器将提供有关你当前在故事板中选择的项的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里，你可以为故事板项设置自定义类。

接下来的两个检查器是你在故事板中工作时最常使用的两个，我们将在文本中频繁提到它们。属性检查器的图标看起来像一个盾牌。这个检查器用于设置所选项的各种属性，比如设置标签的文本、按钮的颜色，或文本输入框周围的框类型等。大小检查器，带有尺子图标，用于设置每个故事板项的大小和屏幕位置。

最后是连接检查器，图标看起来像一个圆圈中的箭头。这个检查器可以用来将你故事板中的项与类中编写的代码部分连接起来。我们将在第十章中向你展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。它将是一个特殊类型的视图控制器，用于显示列表，在 Xcode 中称为*表格视图控制器*。在我们的应用程序中，表格视图控制器将显示您朋友的生日列表！现在它看起来只是一个空白屏幕，您将在“创建生日表格视图控制器”（第 156 页）中学习如何显示生日数据。

让我们将表格视图控制器添加到故事板中。首先将故事板缩小，这样您可以更好地看到视图控制器，执行此操作的方法是双击视图控制器外的空白区域。现在您的屏幕应该已经缩小了。

在工具区的底部有一个包含四个按钮的区域。选择第三个按钮，它看起来像一个圆圈中的正方形。这是对象库，您可以在这里找到可以添加到故事板的项目。滚动浏览对象库列表，直到找到表格视图控制器，或者使用面板底部的过滤栏搜索“table view controller”。然后点击并拖动该对象到故事板中，直接放置在已经存在的视图控制器旁边。您的故事板应该像图 9-6 中显示的那样。

注意，添加表格视图控制器后，在左侧的大纲视图中会出现一个“表格视图控制器场景”条目，并且其中包含一个表格视图控制器。在故事板中，一个场景代表应用程序中的一个屏幕区域。对于 iPhone 应用程序，通常屏幕上一次只有一个场景，并且该场景填满整个屏幕。而对于 iPad 应用程序，屏幕上可以同时显示两个或更多的场景。

![Image](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到故事板中的生日屏幕*

接下来的步骤是将这个新视图控制器设置为在运行应用程序时首先显示的屏幕，因为我们希望用户打开应用程序时能看到生日列表。完成此操作的步骤显示在图 9-7 中。

![Image](img/Image00203.jpg)

*图 9-7：在左侧的大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图 ➊ 中选择**表格视图控制器**。然后在工具区 ➋ 中打开属性检查器。在那里，勾选**是初始视图控制器** ➌。完成此操作后，您应该能在故事板中看到表格视图控制器左侧出现一个箭头。该箭头表示应用程序启动时会显示此视图控制器。

#### 添加导航控制器

现在我们将为视图控制器添加一个标题，显示“生日”，并添加一个“添加”按钮，点击后将打开添加生日的视图控制器。为了实现这一点，我们首先需要将表格视图控制器放入*导航控制器*中。导航控制器管理一个或多个视图控制器，它配备了一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧放置按钮，用于导航到应用中的其他屏幕。在许多 iOS 应用中，你会看到这个导航栏，例如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。选中后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。点击**编辑器** ▸ **嵌入到** ▸ **导航控制器**。

在表格视图控制器嵌入到导航控制器之后，你的故事板应该看起来像图 9-8 中的样子。导航控制器将在故事板中作为一个屏幕显示。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表用户在应用中看到的一个屏幕，但导航控制器略有不同。虽然它在故事板中看起来像一个单独的屏幕，实际上导航控制器只是一个容器，它包含了用户在应用中可以切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在一个视图和另一个视图之间来回导航。

你应该会在导航控制器和表格视图控制器的顶部看到灰色的导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能还包含一些按钮和箭头，用户可以用来跳转到其他屏幕。为了利用导航栏告知用户他们在哪个屏幕，我们需要为屏幕命名。现在是放大故事板的好时机。双击故事板的空白处以放大视图，然后滚动视图直到你能看到表格视图控制器。要为表格视图控制器添加标题，点击左侧大纲视图中**表格视图控制器场景**下的**导航项**。

![Image](img/Image00205.jpg)

选中后，你可以在右侧的属性检查器中输入屏幕的标题。我们希望导航栏显示“生日”作为标题，所以在右侧的标题字段中输入**生日**。完成这一步并按下 RETURN 键后，左侧大纲视图中的表格视图控制器场景条目会自动更新为“生日场景”。

接下来，我们将添加一个“添加”按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将一个生日添加到这个列表中。让我们做一个按钮来让他们实现这一点！

我们需要在导航栏上添加一个按钮，以进入“添加生日”场景，方便用户输入生日。找到对象库中的条形按钮项，然后将其拖放到表格视图控制器的导航栏右侧，如图 9-9 所示。

现在我们想将这个按钮变成一个添加按钮。幸运的是，Xcode 提供了一个内置的添加按钮供我们使用。在属性检查器中，将条形按钮项的“系统项目”设置为**添加**。你应该看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在被点击时应该执行什么操作。我们希望它打开“添加生日”视图控制器，因此我们需要将添加按钮与该视图控制器连接。首先，双击故事板进行缩小，确保你能看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，并从“+”按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标。这时会弹出一个连接对话框，像图 9-10 中的那样。

![Image](img/Image00206.jpg)

*图 9-9：将条形按钮项拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态呈现”。*

连接对话框为你提供了几种*segue*（从一个屏幕到另一个屏幕的过渡）选项。点击对话框中的**模态呈现**选项。这将使视图控制器以*模态*方式呈现在屏幕上。在 iPhone 上，模态视图控制器从屏幕底部出现，并且不会自动配有返回按钮来返回到上一个屏幕。相反，模态视图可以包含其他按钮，如取消或保存。还有其他类型的 segue，比如“显示”segue，它会将视图控制器从右侧推到屏幕上，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个获取和保存用户输入的屏幕时，应该以模态形式展示，并且有一个取消按钮。否则，如果你使用类似“显示”segue 并配有返回按钮的方式，用户可能会在输入完所有信息后点击返回按钮而没有保存任何内容！有了取消按钮，用户必须明确点击来取消操作并退出屏幕。

要查看一个良好的模态输入视图控制器示例，看看你 iPhone 或 iPad 上的日历应用。当你打开它时，你会看到导航栏右侧有一个 + 按钮，你可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，用于在不保存的情况下退出屏幕，右侧有一个添加按钮，用于在关闭模态窗口之前创建新的事件。你应该能看到新事件模态从屏幕底部出现，然后在关闭时再次向下消失。我们希望用户能够保存生日，所以我们也将使用模态。

现在让我们尝试运行我们的应用程序，看看目前为止我们做了什么！要运行应用程序，首先选择一个设备模拟器，方法是点击 Xcode 左上角的 BirthdayTracker 旁边列出的设备（见 图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，应用程序名称旁边设置模拟器将运行的设备。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用程序。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或使用键盘快捷键 ⌘ -**R**。

当模拟器打开运行你的应用程序时，如果它的尺寸过大，无法适应你的计算机屏幕，你可以调整它的大小。点击模拟器以选择它，然后前往 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用程序时没有发生太多事情。你应该会看到你第一个生日屏幕，上面有一个 + 按钮，正如之前在 图 9-1 中所示。显然，到这个时候，你的生日屏幕是空的。点击 + 按钮会弹出第二个空屏幕。查看完应用程序后，通过点击 Xcode 中的停止按钮来关闭它，停止按钮位于你之前点击的播放按钮旁边。当你停止应用程序时，你应该能在模拟器的主屏幕上看到你的应用图标！（见 图 9-12）

就这样！我们现在需要配置第二个屏幕，以便可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，你需要将其嵌入到自己的导航控制器中。当视图控制器是模态时，它不会继承已在 storyboard 中的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击 storyboard 中的普通视图控制器来选择它，然后转到**编辑** ▸ **嵌入于** ▸ **导航控制器**。现在你应该会看到在视图控制器场景下的概述视图中添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与当初在表格视图控制器中添加标题“生日”时相同。

现在，当“添加生日”视图控制器在应用中出现时，它的顶部将显示标题。

#### 添加你朋友的姓名和生日

当你在第十章中输入朋友的生日时，应用中的每一项都会包含一个名字、一个姓氏和一个出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以输入每个人的所有信息。输入控件是像文本框或下拉菜单这样的控件，它们允许用户在应用中输入数据。我们将从添加所有用户可以输入信息的输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个标签，显示“姓名”。这个标签将放在一个文本框旁边，用来输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**姓名**作为显示文本，如图 9-14 所示。

现在我们要使用大小检查器设置标签的大小和位置。在 Xcode 的 storyboard 中，宽度和高度以*点*为单位进行测量。请注意，1 个点并不等于 1 个像素。根据应用运行的设备类型，1 个点可能会转化为 1 个像素、一个 2×2 像素的方块，或一个 3×3 像素的方块。这三种比例因子被称为 @1x、@2x 和 @3x（我们在设置应用图标时也提到过这些尺寸）。不同的设备具有不同的点分辨率，宽度从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* 姓名

只有最旧的 iPhone 和 iPod 型号使用 @1x 缩放因子，而且你将无法在这些型号上运行你的应用（BirthdayTracker 将仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 使用 @2x 缩放因子，否则很可能是使用 @3x 缩放因子的 iPhone 6 Plus、6s Plus 或 7 Plus。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（参见图 9-15）。我们将为添加到视图控制器中的每个库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置为离屏幕边缘不太近，但仍然为其文本输入框和其他标签及输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。将高度保持为 21。

完成后，重复这些步骤，向“添加生日”视图控制器中再添加两个标签：一个姓氏标签和一个出生日期标签。我们需要为其他标签和输入框定位，以确保它们不重叠。在某些情况下，这可能会变得棘手，并且需要一些时间。对于这个应用，我们已经为你计算出了在 iPhone 7 屏幕上的对象位置。稍后我们将解释如何让你的应用在其他设备上工作。表 9-1 列出了你应该为每个标签设置的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，因此它们垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置需要至少比下一个标签大 21 个点。由于我们也在每个标签下方添加了输入控件，所以我们将 y 位置设置得更大，以容纳标签的高度和输入控件的高度。

很棒！现在你的故事板应该像图 9-16 中的那样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器。*

接下来，你将添加两个*文本框*，让你输入姓名。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中看到的尺寸和位置调整这两个文本字段。你可以像调整标签一样，使用大小检查器来完成这一步。

表 9-2：视图控制器中输入的文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个元素是一个称为*日期选择器*的轮盘。这将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用程序中用于允许用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中使用的日期选择器（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日历应用中添加事件时使用的日期选择器。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这也是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到视图控制器的出生日期标签下。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器显示当前日期。让我们将这个日期改为你的出生日期！将日期字段从当前日期更改为**自定义**。这样，一个新的框将会出现。将这个日期更改为你的出生日期。

让我们通过运行应用程序来测试它的工作情况！我们为输入控件设置的尺寸在 iPhone 7 屏幕上适配得很好。所以选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这次，当你在生日视图控制器上点击 + 按钮时，应该会显示添加生日的屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来不错，但其他设备呢？选择一个更小的模拟器来运行应用程序，比如 iPhone 5s，然后再次运行应用程序。你会发现，界面看起来不太对劲。

所有你添加到故事板中的元素都出现了，但文本框超出了屏幕边缘。现在你已经将所有元素放到屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确适配。我们将使用一个叫做*自动布局*的工具来完成这个任务。

#### 让你的应用在每个设备上看起来完美，使用自动布局

iPhone 本身有三种不同的屏幕尺寸，并且未来可能会有更多的尺寸推出。你需要设计你的应用程序，使其在任何设备上都能看起来不错。这意味着你需要让你的应用根据运行的设备调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的概述视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标，弹出自动布局菜单。*

在屏幕故事板面板的底部，有一排图标，右侧最靠近工具面板的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上时，应该会显示一个标签，写着“解决自动布局问题”。点击这个图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这么做时，你会看到在添加生日场景中加入了一堆布局约束。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的宽度适合屏幕并且不会超出边缘。自动布局还会确保每个文本框前后有 20 个点的间距，这样它们就能在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，添加生日界面应该看起来完美。

#### 添加保存和取消按钮

为了完成设置，我们将向你展示如何为添加生日视图控制器的导航栏添加取消和保存按钮。这些按钮目前不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们可以取消添加生日界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮更改为保存按钮，就像我们之前做的添加按钮一样。选择该按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“条形按钮项”，这次将其放置在导航栏的 *左* 边。使用属性检查器将其转化为一个取消按钮，方法与设置保存按钮时相同。你的视图控制器应该如图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新增的按钮！

点击“生日”表格视图控制器上的 + 按钮应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前没有任何效果——我们将在第十章 中实现这两个按钮的功能！

### 你学到了什么

在本章中，你通过创建“生日”和“添加生日”界面的基本用户界面，开始制作一个生日追踪器应用。你还使用表格视图控制器创建了生日屏幕，并让用户可以通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本框架，接下来将在第十章 中编程实现取消和保存按钮，以便在应用中添加和保存生日！

* 在一些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择 **重置为缺失约束** 选项来添加缺失的约束。

### 显示你朋友的生日

从项目导航器中选择 *Main.storyboard*，打开故事板。这就是我们设计应用 *用户界面* 的地方。用户界面只是一个 fancy 名词，指的是用户将看到并用于与应用互动的内容——例如图像、文本、按钮等。*故事板* 让你可以直观地组织应用的各个屏幕。我们将使用故事板查看所有使用的屏幕及其之间的连接。

一旦你选择了 *Main.storyboard*，按 ⌘ -0 隐藏导航面板，这样你就有更多的屏幕空间了。你的故事板应该已经包含一个视图控制器。

现在看一下工具面板的顶部，你应该看到一个包含六个按钮的菜单。这些按钮用于在六个 *检查器* 之间切换，这些检查器是帮助你更仔细查看故事板中元素并更改它们设置的工具。当你选择一个检查器时，它会出现在工具面板中。

**检查故事板项**

图 9-5 显示了当故事板打开时，工具面板中检查器选择栏的特写。

![Image](img/Image00201.jpg)

*图 9-5：你可以在故事板的工具面板中使用六个检查器。*

让我们从左到右依次查看检查器。页面图标打开文件检查器。在这里你可以更改故事板文件的设置。在本书和大多数应用程序中，你不会使用这个检查器。

下一个检查器由一个问号图标表示，是快速帮助检查器。这个检查器将提供关于你当前在故事板中选定项目的详细类信息。

第三个检查器，带有身份证图标的是身份检查器。你可以在这里为故事板项目设置自定义类。

接下来的两个检查器是你在工作时最常用的，我们将在文中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置故事板中选定项目的各种属性。例如，它可以用来设置标签的文本、按钮的颜色，或者设置文本输入框周围显示的框的类型。带有尺子图标的尺寸检查器则用于设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，它的图标看起来像一个圈中的箭头。你可以用它将故事板中的元素与在类中编写的代码连接起来。我们将在第十章中向你展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊类型的视图控制器，用于显示一个列表，在 Xcode 中被称为*表视图控制器*。在我们的应用程序中，表视图控制器将显示你朋友的生日列表！现在它看起来只是一个空白屏幕，你将在“创建生日表视图控制器”一节中学习如何在第 156 页显示生日数据。

让我们将表视图控制器添加到故事板中。如果你首先缩小视图，可以更好地看到视图控制器，这一步会更容易。双击视图控制器外的空白区域即可实现缩小视图。现在你的屏幕应该已经缩小了。

在工具区底部，有一个带有四个按钮的区域。选择第三个按钮，它看起来像一个圆圈中的方块。这是对象库，你可以在这里找到可以添加到故事板中的元素。滚动浏览对象库列表，直到你找到表视图控制器，或者使用面板底部的筛选栏搜索“table view controller”。然后点击并拖动该对象到你的故事板上，放在已有的视图控制器旁边。你的故事板应该像图 9-6 中的那样。

注意，添加表格视图控制器后，左侧大纲视图中会出现一个“表格视图控制器场景”条目，其中包含一个表格视图控制器。故事板中的一个场景表示应用程序中屏幕上的区域。对于 iPhone 应用，通常一次屏幕上只会有一个场景，并且该场景会填满整个屏幕。iPad 应用则可以同时在屏幕上显示两个或更多的场景。

![Image](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到生日屏幕的故事板中*

下一步是将这个新的视图控制器设为应用运行时第一个出现的屏幕，因为我们希望用户打开应用时看到生日列表。完成此操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后在实用工具窗格中打开属性检查器 ➋。在那里，勾选**是初始视图控制器** ➌。完成后，您应该会看到故事板中的表格视图控制器左侧出现一个箭头。这个箭头表示当应用启动时，会显示这个视图控制器。

#### 添加导航控制器

现在，我们将为视图控制器添加一个标题“生日”，以及一个“添加”按钮，用于弹出“添加生日”视图控制器。为此，我们首先将表格视图控制器放入*导航控制器*中。导航控制器管理一个或多个视图控制器。它自带一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在其左右两侧放置按钮，用于在应用中导航到其他屏幕。您在多个 iOS 应用中都会看到这个导航栏，例如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。选中后，您需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。请依次选择**编辑** ▸ **嵌入** ▸ **导航控制器**。

将表格视图控制器嵌入到导航控制器后，您的故事板应该像图 9-8 中显示的那样。导航控制器将作为故事板中的一个屏幕出现。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器都代表了用户在应用中看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像一个独立的屏幕，实际上导航控制器只是一个容器，用于存放用户在应用中切换的其他视图控制器。将视图控制器嵌入导航控制器意味着您的应用可以从一个视图导航到另一个视图，再返回。

你应该能看到导航控制器和表视图控制器顶部有灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们当前所处的屏幕的标题，并且可能包含用户可以使用的按钮和箭头，帮助他们跳转到其他屏幕。为了通过导航栏告诉用户他们所处的屏幕，我们需要给屏幕添加标题。现在是回到故事板的好时机。双击故事板的空白区域以放大视图，然后滚动页面，直到你能看到表视图控制器。要为表视图控制器添加标题，点击大纲视图左侧的**Table View Controller Scene**下的**Navigation Item**。

![Image](img/Image00205.jpg)

当选中此项时，你可以在右侧的属性检查器中为屏幕输入一个标题。我们希望导航栏显示“生日”作为标题，所以在右侧的标题字段中输入**生日**。完成此步骤并按下 RETURN 后，你应该能看到大纲视图中的“Table View Controller Scene”条目自动更新为“Birthday Scene”。

接下来，我们将创建一个“添加”按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并将一个生日添加到列表中。让我们创建一个按钮，允许他们这么做！

我们需要在导航栏中添加一个按钮，指向“添加生日”场景，以便用户可以输入一个生日。找到对象库中的“Bar Button Item”，然后将它拖放到表视图控制器的导航栏右侧，如图 9-9 所示。

现在我们想把这个按钮变成一个“添加”按钮。幸运的是，Xcode 内置了一个可以使用的“添加”按钮。在属性检查器中，将“系统项目”改为**添加**。你应该能看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在点击时执行什么操作。我们希望它打开“添加生日”视图控制器，因此我们需要将“添加”按钮与该视图控制器连接起来。首先，双击故事板以缩小视图，确保你能看到“生日”表视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从加号按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器高亮显示时松开鼠标，这会弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将“Bar Button Item”拖动到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态展示”。*

连接对话框为你提供了几种选择，你可以选择想要在两个视图控制器之间做的*segue*（从一个屏幕到下一个屏幕的过渡）。点击连接对话框中的**模态呈现**选项。这将使视图控制器作为*模态*视图控制器出现在屏幕上。在 iPhone 上，模态视图控制器从手机底部进入屏幕，并且不会自动带有返回按钮以返回到上一个屏幕。相反，模态可以有其他按钮，比如取消或保存。还有其他类型的 segue，例如“显示”segue，其中视图控制器从右侧推送到屏幕上，并且导航栏左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，应该将其显示为带有取消按钮的模态视图。否则，如果你使用类似“显示”segue 且带有返回按钮，可能会出现用户输入完所有内容后，点击返回按钮而没有保存任何内容的情况！有了取消按钮，用户必须故意点击取消才能退出屏幕。

要查看一个良好的模态输入视图控制器的示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，可以在关闭模态前创建新事件。你应该能看到“新事件”模态从屏幕底部滑上来，关闭时又滑回底部。我们希望用户能够保存生日，所以我们也会使用模态。

现在让我们尝试运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先点击 Xcode 左上角列出的设备，选择一个设备模拟器（见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器将运行的设备，设备名称在应用名称旁边。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果它太大而无法适应你的电脑屏幕，你可以调整其大小。点击模拟器以选择它，然后转到**窗口** ▸ **缩放**，在模拟器菜单中选择较小的比例。

到目前为止，运行应用时并没有发生太多变化。你应该能看到第一个生日页面，其中有一个 + 按钮，如图 9-1 所示。显然，此时你的生日页面是空的。点击 + 按钮会显示第二个空白页面。查看完你的应用后，通过点击 Xcode 中的停止按钮关闭它，这个按钮位于你之前按下的播放按钮旁边。当你停止应用时，你应该能看到应用图标出现在模拟器的主屏幕上！（见图 9-12）。

就是这样！现在我们需要配置第二个屏幕，以便它可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到自己的导航控制器中。当视图控制器是模态时，它不会继承我们故事板上已有的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的普通视图控制器来选择它。然后进入 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在，你应该会看到一个导航项已被添加到“视图控制器场景”下的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题 **Add a Birthday**。这些步骤与添加标题“Birthdays”到你的表格视图控制器时是一样的。

现在，当“添加生日”视图控制器出现在应用程序中时，它将在顶部标注其标题。

#### 添加朋友的姓名和生日

当你在第十章中输入朋友的生日时，应用中的每一条记录都会有名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些 *输入控件*，以便用户可以为每个人输入这些信息。输入控件如文本框或下拉菜单，允许用户向应用中输入数据。我们将从为所有用户可以添加的信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个写有“First Name”的标签。这个标签将放置在一个文本框旁边，用户可以在其中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name** 作为显示文本，如图 9-14 所示。

现在我们想使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*为单位测量的。请注意，1 点不等于 1 像素。根据你的应用运行的设备类型，1 点可能会转换为 1 像素、2×2 像素的正方形，或 3×3 像素的正方形。这三种缩放因子分别被称为 @1x、@2x 和 @3x（这是我们在设置应用图标时讨论过的相同大小）。不同设备的点分辨率也不相同，宽度可能从 320 点到 1,024 点，长度可能从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* 名字

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，你将无法在这些型号上运行你的应用（BirthdayTracker 只支持 iOS 10 及以上版本）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，否则你的 iPhone 或 iPod 很可能使用 @2x 缩放因子，它们使用的是 @3x 缩放因子。

物体在屏幕上的位置也是基于点来计算的。物体的 x 坐标是从屏幕左侧到物体左侧的距离，单位是点。y 坐标是从屏幕顶部到物体顶部的距离。（请参见图 9-15）。我们将为每个添加到视图控制器中的库对象设置 x 坐标和 y 坐标。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上物体的 x 坐标、y 坐标、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在离屏幕边缘不太近的地方，但仍然为其文本输入框和其他标签与输入框留出足够的空间。在大小检查器的视图部分，将 x 坐标设置为 20，y 坐标设置为 100，宽度设置为 100。将高度保持为 21。

完成这一步后，重复这些步骤，在“添加生日”视图控制器中再添加两个标签：姓氏标签和生日标签。我们需要为其他标签和输入框设置位置，以避免它们重叠。在某些情况下，这可能会变得有些复杂并需要一些时间。对于这个应用，我们已经为你计算出了放置对象的位置，基于的是 iPhone 7 屏幕。稍后，我们将解释如何使你的应用在其他设备上运行。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们在垂直方向上对齐，但每个标签的 y 位置不同。每个标签的高度为 21，所以 y 位置需要比下一个最接近的标签大至少 21 个点。由于我们在每个标签下方添加了输入控件，因此我们将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

很棒！现在你的故事板应该看起来像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：已将输入标签添加到视图控制器中。*

接下来你将添加两个*文本字段*，它们将允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中的尺寸和位置设置这两个文本字段。你可以使用尺寸检查器，就像设置标签时一样。

表 9-2：视图控制器中的文本字段输入

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做*日期选择器*的滚轮。它将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用程序中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像日历应用中使用的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于日历应用中添加事件时的日期选择。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这就是我们在 BirthdayTracker 中使用的。

在对象库中滚动，直到找到一个日期选择器，然后点击并拖动它到视图控制器中的出生日期标签下方。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整一些日期选择器的属性。点击日期选择器进行选择。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的生日！将日期字段从当前日期更改为**自定义**。当你这么做时，新的框会出现。将这个日期改为你的生日。

让我们通过运行应用程序来测试一下到目前为止的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上适合。因此，选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这次，当你点击“生日”视图控制器上的+按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

在 iPhone 7 上效果很好，但其他设备呢？选择一个较小的模拟器，比如 iPhone 5s，重新运行应用程序。你会发现，布局看起来有些不对劲。

你添加到故事板上的所有元素都显示出来了，但文本字段超出了屏幕边缘。现在，你已经将所有元素添加到屏幕上，下一步是确保它们能在任何屏幕大小上正确显示。我们将通过一种叫做*自动布局*的工具来实现这一点。

#### 通过自动布局让你的应用在每个设备上看起来完美

iPhone 本身有三种不同的屏幕尺寸，而且未来可能会有更多尺寸。你需要设计你的应用，以确保它在任何设备上看起来都很合适。这意味着，你需要让你的应用根据运行应用的设备调整应用内所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来摆放屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来打开自动布局菜单。*

在屏幕故事板面板的底部，有一个带有图标的带状栏，靠近工具区面板的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它会显示一个标签，上面写着解决自动布局问题。点击这个图标，弹出建议菜单。点击**添加缺失的约束**。^(*)。这样，你会看到一堆布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的尺寸适合屏幕。例如，自动布局确保日期选择器的宽度适应屏幕，并且不会超出边缘。自动布局还会确保每个文本字段前后有 20 点的间距，以便它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”页面应该显示得很完美。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。这些按钮现在不会执行任何操作——我们只是设置它们。在第十章中，我们将添加代码，使它们能够退出“添加生日”界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们之前为“添加”按钮所做的那样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新按钮的效果！

点击“+”按钮进入“添加生日”视图控制器，你可以在这里输入一个人的姓名和出生日期。点击取消和保存按钮目前还没有任何效果——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你开始创建一个生日追踪器应用，首先为“生日”和“添加生日”界面创建了基本的用户界面。你还通过使用表视图控制器创建了“生日”界面，并使用户可以通过“添加”按钮和导航控制器在各个界面之间切换。

现在你已经完成了应用的基本骨架，接下来将在第十章中编写代码，完成取消和保存按钮的功能，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

在项目导航器中选择*Main.storyboard*以打开故事板。这是我们将设计应用程序*用户界面*的地方。用户界面只是用户将看到并用来与应用程序互动的内容的花哨名称——图像、文本、按钮等等。*故事板*让你可以直观地组织应用程序的各个屏幕。我们将使用故事板查看所有使用的屏幕以及它们之间的连接。

选择*Main.storyboard*后，通过按⌘-0 隐藏导航面板，以便为屏幕腾出更多空间。你的故事板应该已经包含了一个视图控制器。

现在看看实用工具面板的顶部，你应该看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更详细地查看故事板中元素的工具，允许你更改这些元素的设置。当你选择其中一个检查器时，它会出现在实用工具面板中。

**检查故事板项目**

图 9-5 显示了故事板打开时，实用工具面板中的检查器选择条的特写。

![Image](img/Image00201.jpg)

*图 9-5：你可以在故事板的实用工具面板中使用六个检查器。*

让我们从左到右依次了解这些检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书中以及你大部分应用程序中，你不会使用这个检查器。

下一个检查器，图标是一个问号，是快速帮助检查器。这个检查器会提供关于你当前选中项的详细类信息。

第三个检查器，图标是身份证的样子，是身份检查器。在这里，你可以为故事板项目设置自定义类。

接下来的两个检查器是你在故事板中最常使用的，我们将在文本中经常提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置选中项的各种属性。例如，它可以用来设置标签的文本、按钮的颜色或文本输入框周围显示的框的类型。尺寸检查器，图标像一个尺子，用来设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，它的图标看起来像是一个圆圈中的箭头。这个检查器可以用来将故事板中的项目连接到你在类中编写的代码。我们将在第十章中展示如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊的视图控制器，用于显示列表，在 Xcode 中被称为*表格视图控制器*。在我们的应用中，表格视图控制器将显示你的朋友们的生日列表！现在它看起来只是一个空白的屏幕，你将学习如何在“创建生日表格视图控制器”中显示生日数据，第 156 页会介绍如何实现。

让我们在故事板中添加一个表格视图控制器。如果你先从故事板缩小视图，这个步骤会更容易，因为你能更清楚地看到视图控制器。双击视图控制器外的空白区域来进行缩小。现在你的屏幕应该已经缩小了。

在工具面板的底部有一个包含四个按钮的区域。选择第三个按钮，它看起来像是一个圆圈中的方形。这是对象库，你可以在其中找到可以添加到故事板的元素。浏览对象库列表，直到找到表格视图控制器，或者使用面板底部的过滤条搜索“table view controller”。然后点击并拖动该对象到你的故事板中。将它放置在已经存在的视图控制器旁边。你的故事板应该像图 9-6 那样。

注意，在你添加表格视图控制器之后，左侧的大纲视图中会出现一个“表格视图控制器场景”条目，里面包含一个表格视图控制器。故事板中的场景代表了应用程序中的一个屏幕区域。对于 iPhone 应用，通常一次屏幕上只有一个场景，而且这个场景会填满整个屏幕。而 iPad 应用则可以同时显示两个或更多的场景。

![图片](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到生日屏幕的故事板中*

下一步是将这个新视图控制器设置为运行应用时显示的第一个屏幕，因为我们希望在用户打开应用时能够看到生日列表。如何操作的步骤在图 9-7 中展示。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后在工具面板中打开属性检查器 ➋。在那里，勾选**是初始视图控制器** ➌的选项框。完成此操作后，故事板中的表格视图控制器左侧应该会出现一个箭头。这个箭头表示应用程序在启动时会显示该视图控制器。

#### 添加导航控制器

现在我们将为视图控制器添加一个标题，显示“生日”，并添加一个“添加”按钮，用于打开“添加生日”视图控制器。为此，我们首先将表格视图控制器嵌入到一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它自带一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且可以在左右两侧显示按钮，用于在应用中导航到其他屏幕。你可以在许多 iOS 应用中看到这个导航栏，例如设置应用和消息应用。

在大纲视图中选择**表格视图控制器**。选择后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。前往 **编辑** ▸ **嵌入** ▸ **导航控制器**。

当表格视图控制器被嵌入到导航控制器中后，你的 storyboard 应该会像图 9-8 中的那样。导航控制器将作为一个屏幕出现在 storyboard 中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

每个 storyboard 中的视图控制器代表了用户在应用中看到的一个屏幕，但导航控制器则有些不同。尽管它在 storyboard 中看起来像一个单独的屏幕，导航控制器实际上只是一个容器，用来容纳用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在不同的视图之间进行导航，并且可以来回切换。

你应该能看到导航控制器和表格视图控制器顶部的灰色导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能包含可以用来前往其他屏幕的按钮和箭头。为了使用导航栏来告诉用户他们所在的屏幕，我们需要为屏幕添加标题。现在是时候回到 storyboard 上进一步编辑了。双击 storyboard 的空白处进行放大，然后滚动视图，使你能够看到表格视图控制器。为了给表格视图控制器添加标题，点击左侧大纲视图中 **表格视图控制器场景** 下的 **导航项**。

![Image](img/Image00205.jpg)

选中后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。你应该能看到，当你完成这一步并按下 RETURN 键后，大纲视图中的“表格视图控制器场景”条目会自动更新为“生日场景”。

接下来，我们将创建一个“添加”按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将一个生日添加到该列表中。让我们制作一个按钮，允许他们这样做！

我们需要在导航栏上添加一个按钮，指向“添加生日”场景，以便用户输入生日。在对象库中找到“Bar Button Item”，然后将其拖放到表视图控制器导航栏的右侧，如图 9-9 所示。

现在我们想将这个按钮转换为“添加”按钮。幸运的是，Xcode 有一个内置的“添加”按钮，我们可以使用。在属性检查器中，将 bar button item 的系统项更改为**添加**。你应该能看到按钮变成了一个加号 (+)。

接下来，我们需要告诉按钮在被点击时执行什么操作。我们希望它打开“添加生日”视图控制器，因此我们需要将添加按钮连接到该视图控制器。首先，双击故事板缩小视图，以确保你可以看到“生日”表视图控制器和将最终成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键并从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标，这将弹出一个连接对话框，类似于图 9-10 所示。

![图片](img/Image00206.jpg)

*图 9-9：将 Bar Button Item 拖放到“生日”视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态呈现”。*

连接对话框为你提供了几种不同的*segue*选项——也就是从一个屏幕到另一个屏幕的过渡方式。点击连接对话框中的**模态呈现**选项。这将使视图控制器以*模态*的形式出现在屏幕上。在 iPhone 上，模态视图控制器从手机底部滑入屏幕，并且没有自动带有返回按钮返回到上一个屏幕。相反，模态视图可以有其他按钮，例如取消或保存。还有其他类型的 segue，例如 Show segue，在这种过渡方式中，视图控制器从右侧推入屏幕，并且导航栏左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，该屏幕应以模态方式呈现，并带有取消按钮。否则，如果你使用像 Show segue 这样的过渡，并且带有返回按钮，可能会出现用户输入所有信息后，点击返回按钮而没有保存任何内容的情况！有了取消按钮，用户必须故意点击才能取消退出屏幕。

要查看一个良好的模态输入视图控制器的例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个+按钮，点击它可以添加日历事件。点击+按钮会弹出一个模态的“新建事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，用于在关闭模态之前创建新事件。你应该看到“新建事件”模态从屏幕底部滑入，关闭时会再次滑下。我们希望用户能够保存生日，所以我们也将使用模态视图。

现在让我们尝试运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先在 Xcode 左上角选择一个设备模拟器，点击“BirthdayTracker”旁边列出的设备（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角设置模拟器运行的设备，并在应用名称旁边显示。这里设备设置为 iPhone 7。*

这将弹出一个运行应用的设备选项列表。我们选择 iPhone 7。在选择好模拟器后，点击左上角的播放按钮，或使用快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果应用的尺寸太大无法适应电脑屏幕，你可以调整其大小。点击模拟器进行选择，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用时并不会发生太多变化。你应该能看到你的第一个“生日”屏幕，其中有一个+按钮，正如之前在图 9-1 中所示。显然，此时你的“生日”屏幕是空的。点击+按钮将弹出第二个空白屏幕。当你看完应用后，通过点击 Xcode 中的停止按钮来关闭它，停止按钮位于你之前点击的播放按钮旁边。当你停止应用时，你应该能在模拟器的主屏幕上看到你的应用图标！（参见图 9-12）。

就这样！我们现在需要配置第二个屏幕，以便能够用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将它嵌入到一个自己的导航控制器中。当一个视图控制器是模态时，它不会继承我们已经在故事板上设置的导航控制器中的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击故事板中的普通视图控制器来选择它。然后，前往 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在你应该会看到，导航项已添加到视图控制器场景下的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与你当初为表视图控制器添加“生日”标题时的步骤相同。

现在，当应用中出现“添加生日”视图控制器时，它会在顶部标上标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每一项都将包含名字、姓氏和生日。让我们为“添加生日”视图控制器添加一些*输入控件*，这样用户就可以为每个人输入这些信息。输入控件包括文本框或下拉菜单等，它们允许用户在应用中输入数据。我们将通过添加所有用户可以输入信息的控件标签来开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“名字”的标签。这个标签将位于一个文本框旁边，你可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，更改标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在，我们想通过大小检查器来设置标签的大小和位置。在 Xcode 故事板中，宽度和高度以*点*为单位进行度量。请注意，1 点并不等于 1 像素。根据应用运行的设备类型，1 点可能会转化为 1 像素、2×2 像素的方块或 3×3 像素的方块。这三种缩放因子分别称为@1x、@2x 和@3x（这些与我们设置应用图标时讨论的尺寸相同）。不同设备的点分辨率也不相同，宽度从 320 到 1,024 点，长度从 568 到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* 名字

只有最老款的 iPhone 和 iPod 使用 @1x 缩放因子，并且你无法在这些机型上运行你的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，这些设备使用 @3x 缩放因子，否则你的手机或 iPod 很可能使用 @2x 缩放因子。

对象在屏幕上的位置也是基于点（points）来计算的。对象的 x 位置是从屏幕左侧到对象左侧的距离，y 位置是从屏幕顶部到对象顶部的距离。（见 图 9-15）。我们将为每个添加到视图控制器的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕的边缘之外，但仍然留出足够的空间用于文本输入框和其他标签与输入控件。在 Size Inspector 的 View 部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成后，重复这些步骤，向“添加生日”视图控制器中添加两个标签：一个姓氏标签和一个出生日期标签。我们需要定位其他标签和输入控件，确保它们不重叠。在某些情况下，这可能会变得有些棘手，并且可能需要一些时间。对于这个应用程序，我们已经为你计算出了在 iPhone 7 屏幕上放置对象的位置。稍后，我们会解释如何使你的应用在其他设备上运行。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们在垂直方向上对齐，但它们每个的 y 位置不同。每个标签的高度都是 21，因此 y 位置需要至少比下一个标签高出 21 个点。由于我们还在每个标签下方添加了输入控件，因此我们将 y 位置设置得更大，以容纳标签的高度和输入控件的高度。

太好了！现在你的故事板应该像 图 9-16 中的那样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已经添加到视图控制器。*

接下来你将添加两个 *文本框*，它们允许你输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本字段对象到视图控制器上。一个用于输入名字，另一个用于输入姓氏。给这两个文本字段设置在表格 9-2 中看到的大小和位置。你可以使用尺寸检查器来完成这一操作，就像你为标签所做的那样。

表格 9-2：视图控制器中输入框的文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后，你需要添加一个叫做*日期选择器*的控件。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中使用的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用的日期选择器。*

日期选择器还可以只显示时间，就像在时钟应用中设置闹钟时使用的日期选择器，或者只显示日期，这也是我们在 BirthdayTracker 中使用的。

在对象库中滚动，直到找到一个日期选择器，然后点击并拖动它到出生日期标签下的视图控制器上。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整一下日期选择器的属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。我们来把这个日期改成你的出生日期吧！将日期字段从当前日期改为**自定义**。此时会出现一个新的框，修改这个日期为你的出生日期。

让我们通过运行应用来测试目前为止的功能！我们为输入控件使用的大小在 iPhone 7 屏幕上很合适。所以选择 iPhone 7 模拟器，点击左上角的播放按钮。这次，当你点击“生日”视图控制器上的 + 按钮时，“添加生日”屏幕应该会显示出来，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个更小的模拟器来运行应用，比如 iPhone 5s，然后再次运行应用。你会发现界面看起来有点不对劲。

你添加到故事板中的所有元素都显示出来了，但文本字段超出了屏幕边缘。现在，所有元素都已显示在屏幕上，下一步是让它们在任何屏幕尺寸上都能够正确适配。我们将通过一个叫做*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上都看起来完美，使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会有更多尺寸。你需要设计你的应用，以便它在任何设备上看起来都很不错。这意味着你的应用需要根据运行应用的设备自动调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的技术来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕故事板面板的底部有一个包含图标的带状工具栏，位于工具面板之前的最右侧图标是一个夹在两条垂直线之间的三角形。将鼠标悬停在该图标上，应该会显示“解决自动布局问题”标签。点击该图标以显示建议菜单。点击**添加缺失的约束**。^(*) 完成后，你会看到大量的布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕，并不会超出屏幕边缘。自动布局还确保每个文本字段前后各有 20 个点的间距，以便它们能够在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这次，“添加生日”界面应该完美无缺。

#### 添加保存和取消按钮

最后，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。这些按钮目前不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们可以取消添加生日界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个 Bar Button Item 并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们对添加按钮所做的那样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，并这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新按钮的效果！

在“生日”表视图控制器上点击+按钮，应该会带你到“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮暂时没有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你通过创建“生日”和“添加生日”屏幕的基本用户界面，开始制作一个生日追踪器应用。你还使用表视图控制器创建了“生日”屏幕，并使用户可以通过添加按钮和导航控制器在屏幕间进行导航。

现在你已经完成了应用的基本框架，接下来将在第十章编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日信息了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项是禁用的。这是一个苹果的 bug。此时，你需要选择**重置为缺失约束**选项来添加缺失的约束。

一旦选择了*Main.storyboard*，按下⌘ -0 隐藏导航窗格，以便腾出更多的屏幕空间。你的故事板应该已经包含一个视图控制器。

现在看看实用工具窗格的顶部。你应该看到一个带有六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更仔细查看故事板中元素并允许你更改这些元素设置的工具。当你选择其中一个检查器时，它会出现在实用工具窗格中。

**检查故事板项目**

图 9-5 展示了在故事板打开时，实用工具窗格中出现的检查器选择栏的特写视图。

![图片](img/Image00201.jpg)

*图 9-5：在故事板的实用工具窗格中，你可以使用六个检查器。*

我们从左到右依次浏览检查器。页面图标打开文件检查器。在这里，你可以更改故事板文件的设置。在本书和大多数应用中，你不太会使用这个检查器。

下一个检查器由一个问号图标表示，这是快速帮助检查器。这个检查器会提供你当前在故事板中选中的项目的详细类信息。

第三个检查器，带有身份证图标，是身份检查器。在这里，你可以为故事板项目设置自定义类。

接下来的两个检查器是你在工作时最常使用的，我们会在文中频繁提到它们。属性检查器的图标像一个盾牌。这个检查器用于设置故事板中所选项目的各种属性。例如，它可以用来设置标签的文本、按钮的颜色，或者文本输入框周围框的类型。大小检查器的图标像一把尺子，用于设置每个故事板项目的大小和屏幕位置。

最后，有一个连接检查器，它的图标看起来像一个圆圈中的箭头。这个检查器可以用来将你在故事板中添加的项目与类中编写的代码连接起来。我们将在第十章中向你展示如何操作。

#### 添加表格视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊的视图控制器类，用于显示列表，在 Xcode 中称为*表格视图控制器*。在我们的应用中，表格视图控制器将显示你朋友的生日列表！现在它看起来只是一个空白的屏幕，你将在《创建生日表格视图控制器》中学习如何在第 156 页上显示生日数据。

让我们将表格视图控制器添加到故事板中。如果你先缩小故事板的视图，这一步会更容易，这样你可以更清楚地看到视图控制器。双击视图控制器外的空白区域即可缩小视图。现在你的屏幕应该已经缩小了。

在实用工具窗格的底部，有一个区域，顶部有四个按钮。选择第三个按钮，它看起来像一个圆圈里的方块。这是对象库，你可以在这里找到要添加到故事板中的项目。滚动浏览对象库列表，直到找到“表格视图控制器”，或者使用窗格底部的筛选栏搜索“table view controller”。然后点击并拖动该对象到故事板中，放到已经存在的视图控制器旁边。你的故事板应该像图 9-6 一样。

请注意，在你添加表格视图控制器后，左侧的大纲视图中会出现一个“表格视图控制器场景”条目，并且其中包含一个表格视图控制器。故事板中的一个场景代表应用程序中一个显示区域。对于 iPhone 应用，屏幕上通常一次只显示一个场景，且该场景会占满整个屏幕。而 iPad 应用则可以在同一时间显示两个或更多场景。

![图片](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到生日屏幕的故事板中*

下一步是让这个新视图控制器成为应用启动时显示的第一个屏幕，因为我们希望用户打开应用时能看到生日列表。具体步骤请参见图 9-7。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表视图控制器并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表视图控制器** ➊ 。然后在工具面板中打开属性检查器 ➋ 。在那里，勾选**是初始视图控制器** ➌ 。完成后，你应该会看到在故事板中表视图控制器的左侧出现一根箭头。这表示应用在启动时将显示这个视图控制器。

#### 添加导航控制器

现在我们将为视图控制器添加一个标题“生日”和一个“添加”按钮，点击后将打开“添加生日”视图控制器。为了实现这一点，我们首先将表视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器，它带有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧显示按钮，用于导航到应用程序中的其他屏幕。你会在许多 iOS 应用中看到这个导航栏，例如设置应用和消息应用。

在大纲视图中选择**表视图控制器**。选择后，你需要通过 Xcode 菜单将表视图控制器嵌入到导航控制器中。依次选择**编辑** ▸ **嵌入** ▸ **导航控制器**。

将表视图控制器嵌入到导航控制器中后，故事板应该像图 9-8 中的那样显示。导航控制器将在故事板中作为一个屏幕出现。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器都代表用户将在应用中看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像是一个单独的屏幕，实际上，导航控制器只是一个容器，用来存放用户在应用中切换的其他视图控制器。将视图控制器嵌入导航控制器中意味着你的应用可以在不同的视图之间来回导航。

你应该能看到导航控制器和表格视图控制器顶部的灰色导航栏。当应用程序运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能还包含可以用来进入其他屏幕的按钮和箭头。为了使用导航栏告诉用户他们在哪个屏幕上，我们需要为屏幕命名。现在是时候重新缩放故事板了。双击故事板的空白处以放大视图，然后滚动视图，直到你可以看到表格视图控制器。要为表格视图控制器添加标题，请在左侧的轮廓视图中点击**表格视图控制器场景**下的**导航项**。

![Image](img/Image00205.jpg)

选中此项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，所以在右侧的标题字段中输入**生日**。完成此步骤并按 RETURN 后，你会看到轮廓视图中的表格视图控制器场景条目自动更新为“生日场景”。

接下来，我们将创建一个添加按钮，以便你可以添加生日！

#### 添加一个按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并将生日添加到该列表中。让我们制作一个按钮，让他们能够做到这一点！

我们需要在导航栏中添加一个按钮，通向“添加生日”场景，这样用户就可以输入生日了。找到对象库中的条形按钮项，然后将其拖放到表格视图控制器的导航栏右侧，如图 9-9 所示。

现在，我们要将这个按钮变成一个添加按钮。幸运的是，Xcode 有一个内置的添加按钮可以使用。在属性检查器中，将条形按钮项的系统项改为**添加**。你应该看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在点击时应该做什么。我们希望它打开“添加生日”视图控制器，因此我们需要将添加按钮连接到该视图控制器。首先，双击故事板进行缩小，确保可以看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，然后从+按钮拖动到故事板右侧的空白视图控制器中间。当视图控制器被高亮显示时松开鼠标。这时会弹出一个连接对话框，类似于图 9-10。

![Image](img/Image00206.jpg)

*图 9-9：将条形按钮项拖动到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在出现的对话框中选择模态展示。*

连接对话框为你提供了几种选择，决定你想要在两个视图控制器之间进行的 *segue* ——从一个屏幕到下一个屏幕的过渡。点击连接对话框中的 **模态展示** 选项。这将使视图控制器以 *模态* 视图控制器的形式出现在屏幕上。在 iPhone 上，模态视图控制器从手机的底部滑入，并且不会自动带有返回按钮返回到上一屏幕。相反，模态视图可以有其他按钮，如取消或保存。还有其他类型的 segue，例如 Show segue，其中视图控制器从右侧滑入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，屏幕应该以模态的形式显示，并带有取消按钮。否则，如果你使用类似 Show segue 的方式并带有返回按钮，可能会出现用户输入完所有内容后点击返回按钮，结果没有保存任何内容的情况！有了取消按钮，用户必须有意识地点击才能退出屏幕。

要查看模态输入视图控制器的一个好例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏的右侧有一个 + 按钮，点击它可以添加日历事件。点击 + 按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，可以在关闭模态前创建新事件。你应该会看到，新事件模态从屏幕底部滑入，关闭时则会滑回底部。我们希望用户能够保存生日，因此我们也将使用模态。

现在让我们尝试运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先通过点击 Xcode 左上角的 BirthdayTracker 旁边列出的设备选择一个设备模拟器（见 图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器运行的设备，紧挨着应用名称。这里设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或使用快捷键 ⌘ -**R**。

当模拟器打开以运行你的应用时，如果模拟器的尺寸过大无法适应你的计算机屏幕，你可以调整它的大小。点击模拟器进行选择，然后前往 **窗口** ▸ **缩放**，在模拟器菜单中选择一个更小的缩放比例。

到目前为止，当你运行应用时，实际上并没有太多变化。你应该会看到第一个生日页面，并有一个 + 按钮，如 图 9-1 所示。显然，到目前为止，你的生日页面将是空的。点击 + 按钮将会弹出第二个空白屏幕。看完应用后，通过点击 Xcode 中停止按钮关闭它，这个按钮位于你之前点击的播放按钮旁边。当你停止应用时，你应该会在模拟器的主屏幕上看到你的应用图标！（见 图 9-12）。

就是这样！现在我们需要配置第二个屏幕，以便可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，首先添加其标题。为此，你需要将其嵌入到一个新的导航控制器中。当一个视图控制器是模态的时，它不会继承我们故事板中已经存在的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。点击故事板中的普通视图控制器，然后转到 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在你应该会看到，一个导航项已经被添加到视图控制器场景的概览视图中。点击这个新的导航项，然后在属性检查器中添加标题 **Add a Birthday**。这些步骤与当你为表视图控制器添加标题“Birthdays”时是一样的。

现在，当“添加生日”视图控制器出现在应用中时，它将会在顶部显示其标题。

#### 添加朋友的名字和生日

当你在 第十章 输入朋友的生日时，应用中的每一项将包括一个名字、一个姓氏和一个生日日期。让我们为“添加生日”视图控制器添加一些*输入控件*，这样用户就可以为每个人输入这些信息。输入控件是像文本框或下拉菜单这样的元素，允许用户在你的应用中输入数据。我们将通过添加所有信息的输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个标注，内容为“名字”。这个标注将位于一个文本框旁边，用户可以在其中输入朋友们的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器上（见 图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加一个标签。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name** 作为显示文本，如 图 9-14 所示。

现在，我们希望使用大小检查器来设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以 *点* 为单位进行测量。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点可能会转化为 1 像素、2×2 像素的正方形，或 3×3 像素的正方形。这三个缩放因子被称为 @1x、@2x 和 @3x（与我们在设置应用图标时讨论的大小相同）。设备的点分辨率也不完全相同，宽度从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* 姓氏

只有最旧款的 iPhone 和 iPod 使用 @1x 缩放因子，并且你无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10+）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则很可能使用 @2x 缩放因子，这些设备使用 @3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 坐标是从屏幕左侧到对象左侧的距离（单位为点）。y 坐标是从屏幕顶部到对象顶部的距离。（见 图 9-15）我们将设置每个添加到视图控制器中的库对象的 x 坐标和 y 坐标。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 坐标、y 坐标、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，但仍然留出足够的空间以容纳文本输入框和其他标签与输入框。在大小检查器的视图部分，将 x 坐标设置为 20，y 坐标设置为 100，宽度设置为 100，保持高度为 21。

完成此操作后，重复这些步骤，向“添加生日”视图控制器添加两个标签：一个姓氏标签和一个出生日期标签。我们需要调整其他标签和输入框的位置，确保它们不会重叠。在某些情况下，这可能会变得有些棘手，并且可能需要一些时间。对于这个应用，我们已经为你计算好了在 iPhone 7 屏幕上放置对象的位置。稍后我们会解释如何使你的应用支持其他设备。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中的输入标签设置

| 显示文本 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个最近的标签大至少 21 点。由于我们将输入控件添加到每个标签下方，所以我们将 y 位置设置得更大，以适应标签和输入控件的高度。

太棒了！现在你的故事板应该与图 9-16 中的内容相似。

![图片](img/Image00214.jpg)

*图 9-16：输入项的标签已添加到视图控制器中。*

接下来你将添加两个*文本字段*，它们允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘将自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中的尺寸和位置调整这两个文本字段。你可以使用大小检查器来完成这一操作，就像你为标签所做的那样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个称为*日期选择器*的滚轮。这将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的工具，用于让用户选择日期或时间。它可以同时包含日期和时间，类似于日历应用中的日期选择器（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，日期选择器用于选择日期。*

日期选择器还可以只显示时间，像时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到日期选择器，然后点击并将其拖动到视图控制器中的出生日期标签下方。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们把这个日期改成你的生日！将日期字段从“当前日期”更改为**自定义**。这样会出现一个新框，修改这个日期为你的生日。

让我们通过运行应用程序来测试到目前为止应用的表现！我们为输入控件使用的大小在 iPhone 7 屏幕上适配得很好。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你点击“生日”视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美地适配了 iPhone 7 屏幕。*

![图片](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器运行应用，比如 iPhone 5s，然后重新运行应用。你会看到，一些内容显示得不太对劲。

所有添加到故事板中的元素都已经显示，但文本框超出了屏幕边缘。现在你已经将所有元素放到屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确适配。我们将通过一个叫做*自动布局*的工具来实现这一点。

#### 通过自动布局让你的应用在每个设备上都完美显示

iPhone 单独就有三种不同的屏幕尺寸，并且未来可能会推出更多尺寸。你需要设计你的应用程序，使其在任何设备上看起来都很不错。这意味着你需要让你的应用程序调整应用中所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（参见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕的故事板窗格底部，有一条带有图标的带状栏，在实用工具窗格之前的最右侧是一个三角形图标，夹在两条垂直线之间。将鼠标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击这个图标，打开一个建议菜单。点击**添加缺失的约束**。^(*)当你这么做时，你会看到一大堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局会确保日期选择器的宽度适应屏幕的宽度，并且不会超出边缘。自动布局还会确保每个文本字段的前后都有 20 个点的间隔，以便它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这次，添加生日的屏幕应该看起来非常完美。

#### 添加保存和取消按钮

为了完成这项工作，我们将向你展示如何为“添加生日”视图控制器的导航栏制作“取消”和“保存”按钮。这些按钮目前不会做任何事情，我们只是设置它们。在第十章中，我们将添加一些代码，让它们能够退出“添加生日”屏幕并将生日保存到应用中。

要添加“保存”按钮，从对象库中拖动一个 Bar Button Item，并将其放置在导航栏的 *右侧*。我们将把这个按钮更改为“保存”按钮，就像我们为“添加”按钮所做的那样。选择按钮项，然后使用属性检查器将其设置为“保存”按钮。

最后，我们来添加“取消”按钮。从对象库中拖动另一个 Bar Button Item，然后将其放置在导航栏的 *左侧*。使用属性检查器将其设置为“取消”按钮，就像你为“保存”按钮所做的一样。你的视图控制器应该像图 9-21 中显示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新按钮的效果！

在“生日”表格视图控制器上点击 + 按钮，应该会跳转到“添加生日”视图控制器，你可以在其中输入一个人的姓名和生日日期。点击“取消”和“保存”按钮目前还没有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你通过创建“生日”和“添加生日”屏幕的基本用户界面开始了开发 BirthdayTracker 应用程序。你还使用表格视图控制器创建了“生日”屏幕，并让用户能够通过添加按钮和导航控制器在屏幕之间导航。

现在，你已经完成了应用程序的基本框架，接下来将在第十章中编写“取消”和“保存”按钮的代码，这样你就可以在应用程序中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **重置为缺失约束** 选项来添加缺失的约束。

现在看一下工具面板的顶部。你应该会看到一个包含六个按钮的菜单。这些按钮用于在六个*检查器*之间切换，检查器是帮助你更仔细地查看故事板中元素的工具，并允许你更改这些元素的设置。当你选择其中一个检查器时，它会出现在工具面板中。

**检查故事板项目**

图 9-5 显示了当故事板打开时，在工具面板中出现的检查器选择栏的特写图像。

![Image](img/Image00201.jpg)

*图 9-5：在故事板的工具面板中，你可以使用六个检查器。*

让我们从左到右依次浏览这些检查器。页面图标打开文件检查器。这是你可以更改故事板文件设置的地方。在本书和大多数应用中，你不会使用这个检查器。

下一个检查器，由一个问号图标表示，是快速帮助检查器。这个检查器会为你提供关于你当前在故事板中选择的项目的详细类信息。

第三个检查器，带有身份证图标的是身份检查器。这里可以为故事板项目设置自定义类。

接下来的两个检查器是你在故事板中工作时最常用的两个，我们在文本中将频繁提到它们。属性检查器的图标看起来像一个盾牌。这个检查器用于设置选定项目的各种属性。例如，它可以用来设置标签的文本、按钮的颜色或文本输入框周围的框类型。尺寸检查器，带有尺子图标，用于设置每个故事板项目的大小和屏幕位置。

最后是连接检查器，它的图标看起来像是一个圆圈中的箭头。你可以使用它将故事板中的项目与在类中编写的代码片段连接起来。我们将在第十章 中展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊的视图控制器类，用于显示列表，在 Xcode 中称为*表视图控制器*。在我们的应用中，表视图控制器将显示你朋友的生日列表！目前它只会显示一个空白屏幕，你将在《创建生日表视图控制器》（第 156 页）中学习如何显示生日数据。

让我们在故事板中添加一个表视图控制器。如果你先从故事板中缩小视图以便更好地看到视图控制器，这一步会更容易。双击视图控制器外部的空白区域来进行缩小。现在你的屏幕应该已经缩小。

在工具窗格的底部，有一个包含四个按钮的区域。选择第三个按钮，它看起来像一个圆圈里的方块。这是对象库，你可以在这里找到要添加到故事板的项目。滚动浏览对象库列表，直到找到“表格视图控制器”，或者使用窗格底部的筛选栏搜索“table view controller”。然后点击并拖动该对象到故事板上，放置在已经存在的视图控制器旁边。你的故事板应该像图 9-6 中的那样。

注意，添加表格视图控制器后，左侧大纲视图中会出现一个“表格视图控制器场景”条目，里面包含一个表格视图控制器。故事板中的一个场景代表应用屏幕上的一个区域。对于 iPhone 应用，通常一次屏幕上只显示一个场景，而且该场景会填满整个屏幕。iPad 应用则可以在屏幕上同时显示两个或更多场景。

![Image](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到生日屏幕的故事板中*

接下来的步骤是将这个新视图控制器设置为应用启动时第一个显示的屏幕，因为我们希望用户打开应用时能看到生日列表。实现这一点的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后在工具窗格中打开属性检查器 ➋。在这里，勾选**是初始视图控制器** ➌。完成后，表格视图控制器的左侧应该会出现一个箭头。这个箭头意味着应用在启动时会显示这个视图控制器。

#### 添加导航控制器

现在我们将为视图控制器添加一个标题，显示为“生日”，并添加一个“添加”按钮，点击后会弹出添加生日视图控制器。为此，我们首先将表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它配有一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧显示按钮，供用户导航到应用中的其他屏幕。你可以在许多 iOS 应用中看到这个导航栏，比如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。选择后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。路径为**编辑** ▸ **嵌入到** ▸ **导航控制器**。

在将表视图控制器嵌入到导航控制器后，你的故事板应该看起来像图 9-8 中的样子。导航控制器会作为一个屏幕出现在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表用户在应用中看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像一个独立的屏幕，实际上导航控制器只是一个容器，存放着用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在不同的视图之间来回导航。

你应该会看到导航控制器和表视图控制器顶部有灰色的导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能还包含按钮和箭头，供他们跳转到其他屏幕。为了利用导航栏告诉用户他们当前所在的屏幕，我们需要为我们的屏幕设置标题。现在是时候重新缩放到故事板了。双击故事板中的空白处进行缩放，然后滚动视图，使你能够看到表视图控制器。要为表视图控制器添加标题，请点击左侧大纲视图中的**Table View Controller Scene**下的**Navigation Item**。

![Image](img/Image00205.jpg)

选中此项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。完成此步骤并按下 RETURN 后，你应该会看到大纲视图中的表视图控制器场景条目自动更新为“Birthdays Scene”。

接下来，我们将制作一个添加按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将生日添加到该列表中。让我们制作一个按钮，让他们可以这么做！

我们需要在导航栏中添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。找到对象库中的“Bar Button Item”，然后将其拖动并放置到表视图控制器的导航栏右侧，如图 9-9 所示。

现在我们要将这个按钮变成添加按钮。幸运的是，Xcode 有一个内置的“添加”按钮可以使用。在属性检查器中，将条形按钮项的系统项更改为**Add**。你应该会看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮在被点击时应该做什么。我们希望它打开“添加生日”视图控制器，所以我们需要将“添加”按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你可以看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时，松开鼠标。这将弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个条形按钮项拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到邻近的视图控制器，并在出现的对话框中选择“模态呈现”。*

连接对话框提供了几种选项，用于选择你想在两个视图控制器之间进行的*过渡*——从一个屏幕到另一个屏幕的过渡。点击连接对话框中的**模态呈现**选项。这将使视图控制器以*模态*视图控制器的形式呈现在屏幕上。在 iPhone 上，模态视图控制器从手机底部滑入屏幕，并且不会自动附带返回按钮以返回到上一屏幕。相反，模态视图可以包含其他按钮，比如取消或保存。还有其他类型的过渡，比如显示过渡（Show segue），在这种情况下，视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你呈现一个用于获取和保存用户输入的屏幕时，屏幕应该以模态形式显示，并带有一个取消按钮。否则，如果你使用像“显示”过渡（Show segue）那样带有返回按钮的过渡，可能会发生用户输入所有信息后点击返回按钮但没有保存任何内容的情况！带有取消按钮，用户必须明确点击取消才能退出屏幕。

要查看模态输入视图控制器的一个好例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏的右侧有一个 + 按钮，你可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，在创建新事件并关闭模态后保存该事件。你应该看到新事件模态从底部进入屏幕，在被关闭时又下滑消失。我们希望用户保存生日，因此我们也会使用模态视图。

现在让我们尝试运行我们的应用程序，看看我们迄今为止完成了什么！要运行应用程序，首先选择一个设备模拟器，方法是点击 Xcode 左上角的 BirthdayTracker 旁边列出的设备（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器将运行的设备，位于应用名称旁边。这里，设备被设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用程序。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用程序时，如果它的大小太大无法适应你的计算机屏幕，你可以调整它的大小。点击模拟器以选中它，然后进入**Window** ▸ **Scale**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用程序时，似乎没有太多变化。你应该能看到你第一个“生日”屏幕，并且屏幕上会有一个“+”按钮，正如前面在图 9-1 中所示。显然，此时你的“生日”屏幕是空的。点击“+”按钮会出现第二个空白屏幕。当你看完你的应用程序后，通过点击 Xcode 中的停止按钮来关闭它，停止按钮就在你之前按的播放按钮旁边。停止应用程序时，你应该能在模拟器的主屏幕上看到你的应用图标！（参见图 9-12）。

就这样！现在我们需要配置第二个屏幕，以便可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：生日追踪器应用图标已经添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，你需要将其嵌入到一个自己的导航控制器中。当一个视图控制器是模态时，它不会继承我们已经在故事板上设置的导航控制器中的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中点击选择普通视图控制器。然后进入**Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在，你应该能看到在视图控制器场景下的轮廓视图中添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与当时你为表视图控制器添加“生日”标题时的步骤是一样的。

现在，当“添加生日”视图控制器在应用程序中出现时，它将在顶部标上标题。

#### 添加朋友的姓名和生日

当你在第十章中输入朋友的生日时，你的应用程序中的每一项都将包含一个名字、一个姓氏和一个生日。让我们向“添加生日”视图控制器中添加一些 *输入控件*，以便用户可以为每个人输入这些信息。输入控件是像文本框或下拉菜单之类的控件，允许用户将数据输入到应用程序中。我们将首先通过添加所有可供用户添加信息的输入控件标签来开始。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器创建一个标签，标签上写着“First Name”。这个标签将位于一个文本框旁边，你将在其中输入朋友们的名字。在对象库中找到并将标签对象从对象库拖放到“添加生日”视图控制器上（见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器中。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name** 作为显示文本，如图 9-14 所示。

现在我们想要使用尺寸检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以 *点* 为单位的。请注意，1 点不等于 1 像素。根据你的应用程序运行的设备类型，1 点可以转换为 1 像素、2×2 像素的正方形，或 3×3 像素的正方形。这三种缩放因子分别称为 @1x、@2x 和 @3x（我们在设置应用程序图标时也提到过这些尺寸）。不同的设备具有不同的点分辨率，屏幕宽度范围从 320 到 1,024 点，高度范围从 568 到 1,366 点。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示“First Name”*

只有最旧型号的 iPhone 和 iPod 使用 @1x 的缩放因子，并且你将无法在这些型号上运行你的应用程序（BirthdayTracker 只支持 iOS 10 及以上版本）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，否则你的手机或 iPod 很可能使用的是 @2x 的缩放因子，这些设备使用的是 @3x 的缩放因子。

对象在屏幕上的位置也是基于点数的。对象的 x 位置是从屏幕左侧到对象左侧的距离，单位是点。y 位置是从屏幕顶部到对象顶部的距离。（见图 9-15）。我们将设置每个我们添加到视图控制器中的库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置得既不在屏幕边缘，又能为文本输入框、其他标签和输入控件留出足够的空间。在尺寸检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成这些步骤后，重复这些操作为“添加生日”视图控制器添加两个标签：一个是姓氏标签，一个是出生日期标签。我们需要调整其他标签和输入控件的位置，以避免重叠。在某些情况下，这可能会变得有些棘手，可能需要一些时间。对于这个应用，我们已经计算好了放置对象的位置，适用于 iPhone 7 屏幕。稍后，我们会解释如何让你的应用适应其他设备。表 9-1 列出了每个标签的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有的标签都有相同的 x 位置，因此它们垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，所以 y 位置需要比下一个最接近的标签大至少 21 个点。由于我们还要在每个标签下方添加输入控件，所以我们将 y 位置设置得更大，以容纳标签的高度和输入控件的高度。

太棒了！现在你的故事板应该像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：已将输入标签添加到视图控制器。*

接下来，你将添加两个*文本字段*，它们允许你输入名字和姓氏。文本字段是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中的尺寸和位置设置这两个文本字段。你可以使用大小检查器进行设置，就像为标签设置一样。

表 9-2：视图控制器中输入的文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做*日期选择器*的滚轮。它可以让你轻松地输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以同时包含日期和时间，类似于日历应用中的日期选择器（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以只显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到一个日期选择器，然后点击并将其拖动到“出生日期”标签下的视图控制器上。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器会显示当前日期。让我们把这个日期改为你的生日吧！将日期字段从“当前日期”更改为**自定义**。这样会弹出一个新框，修改这个日期为你的生日。

让我们通过运行应用程序来测试目前的效果！我们使用的输入控件尺寸适配 iPhone 7 屏幕。因此，选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你点击“生日”视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来不错，但其他设备呢？选择一个较小的模拟器（如 iPhone 5s）来运行应用程序，然后再次运行应用。你会看到界面显示得不太对劲。

你添加到故事板中的所有元素都显示了出来，但文本字段超出了屏幕的边缘。现在，所有元素都已显示在屏幕上，下一步是确保它们能够在任何屏幕尺寸下正确显示。我们将通过一个叫做*自动布局*的工具来完成这一任务。

#### 使用自动布局让你的应用在每个设备上看起来完美

单独的 iPhone 有三种不同的屏幕尺寸，未来可能还会有更多尺寸。你需要设计应用程序，使其在任何设备上看起来都很不错。这意味着，你需要让你的应用自动调整所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，调出自动布局菜单。*

在屏幕的故事板面板底部，有一个带有图标的带状栏，靠近工具面板的最右边的图标是一个夹在两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击此图标以弹出建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到一堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局使得日期选择器的宽度适应屏幕的宽度，不会超出边界。自动布局还会确保每个文本字段的前后有 20 个点，以便它们能够在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行该应用程序。这次，添加生日屏幕应该看起来非常完美。

#### 添加保存和取消按钮

为了完成最后的步骤，我们将向你展示如何为添加生日视图控制器的导航栏添加取消和保存按钮。按钮目前不会有任何功能，我们只是将它们设置好。在第十章中，我们将添加一些代码，让它们可以取消并保存生日信息到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右*侧。我们将把这个按钮转换为保存按钮，就像我们处理添加按钮一样。选择该按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“条形按钮项”，这次将其放置在导航栏的*左*侧。使用属性检查器将其转换为取消按钮，就像你设置保存按钮一样。你的视图控制器应该和图 9-21 中的一样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新添加的按钮！

点击生日表视图控制器上的 + 按钮应该会带你进入添加生日视图控制器，在那里你可以输入某人的名字和生日。点击取消和保存按钮目前还没有任何作用——我们将在第十章中实现它们！

### 你学到的内容

在本章中，你开始制作一个生日追踪器应用程序，通过创建生日和添加生日屏幕的基本用户界面。你还使用表视图控制器创建了生日屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用程序的基本框架，在第十章中，你将编程实现取消和保存按钮的功能，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是一个苹果的 BUG。在这种情况下，选择**重置为缺失约束**选项以添加缺失的约束。

**检查故事板项**

图 9-5 显示了当故事板打开时在工具面板中出现的检查器选择栏的特写。

![Image](img/Image00201.jpg)

*图 9-5：在故事板的工具面板中，你可以使用六个检查器。*

让我们从左到右浏览检查器。页面图标打开文件检查器。在这里你可以更改故事板文件的设置。在本书以及你大多数应用中，你将不会使用这个检查器。

下一个检查器，用问号图标表示的是快速帮助检查器。此检查器将为你提供有关你当前在故事板中选定项的详细类信息。

第三个检查器，带有身份证图标的是身份检查器。在这里你可以为故事板项设置自定义类。

接下来的两个检查器是你在工作时最常使用的检查器，我们在文本中也会经常提到它们。属性检查器的图标像一个盾牌。此检查器用于设置故事板中选定项的各种属性。例如，它可以用来设置标签的文本、按钮的颜色或文本输入框周围显示的框的类型。大小检查器，带有尺子图标，用于设置每个故事板项的大小和屏幕位置。

最后是连接检查器，它的图标看起来像一个圆圈中的箭头。可以用它将你的故事板中的项与在类中编写的代码片段连接起来。我们将在第十章中向你展示如何操作。

#### 添加表视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊的视图控制器类，用于显示一个列表，在 Xcode 中称为*表视图控制器*。在我们的应用中，表视图控制器将显示你朋友的生日列表！现在它看起来只是一个空白屏幕，稍后你将在“创建生日表视图控制器”的第 156 页中学习如何显示生日数据。

让我们向故事板中添加一个表视图控制器。首先从故事板中缩小视图，这样你可以更好地看到视图控制器，这样做会更容易。双击视图控制器外的空白区域来完成此操作。现在你的屏幕应该已经缩小。

在工具区的底部，有一个包含四个按钮的区域。选择第三个按钮，它看起来像一个圆圈中的方块。这是对象库，你可以在这里找到可以添加到故事板的项目。滚动浏览对象库列表，直到你找到表格视图控制器，或者使用面板底部的筛选栏搜索“table view controller”。然后点击并拖动该对象到你的故事板中，放在已经存在的视图控制器旁边。你的故事板应该像图 9-6 所示。

注意，在你添加表格视图控制器后，大纲视图的左侧会出现一个表格视图控制器场景条目，并且其中包含了一个表格视图控制器。故事板中的场景代表你应用程序中的一个屏幕区域。对于 iPhone 应用程序，通常屏幕上一次只显示一个场景，并且该场景填充整个屏幕。对于 iPad 应用程序，可以在同一时间显示两个或更多的场景。

![Image](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到“生日”屏幕的故事板中*

下一步是让这个新视图控制器成为当你运行应用时显示的第一个屏幕，因为我们希望用户打开应用时看到生日列表。完成此操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后，在工具区中打开属性检查器 ➋。在这里，勾选**Is Initial View Controller** ➌。完成后，表格视图控制器的左侧应出现一个箭头。这个箭头表示应用启动时会显示这个视图控制器。

#### 添加导航控制器

现在，我们将在视图控制器中添加一个标题，内容为“生日”，并添加一个“添加”按钮，点击后会显示添加生日视图控制器。为此，首先我们将表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器，并带有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧显示按钮，用于导航到应用中的其他屏幕。你可以在许多 iOS 应用程序中看到这个导航栏，例如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。选中后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。路径是：**Editor** ▸ **Embed In** ▸ **Navigation Controller**。

当表格视图控制器嵌入到导航控制器中后，你的故事板应该像图 9-8 中所示的那样。导航控制器将作为一个屏幕出现在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

在故事板中的每个视图控制器代表应用程序中用户将看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像是一个独立的屏幕，但导航控制器实际上只是一个容器，用来承载用户在应用程序中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在一个视图和另一个视图之间进行导航，并且可以返回。

你应该会看到导航控制器和表格视图控制器顶部有灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们所在的屏幕标题，并且可能包含他们可以用来进入其他屏幕的按钮和箭头。为了使用导航栏告诉用户他们所在的屏幕，我们需要为我们的屏幕命名。现在是时候再次缩放故事板了。双击故事板中的空白区域以进行缩放，然后滚动视图，以便你可以看到表格视图控制器。要为表格视图控制器添加标题，点击左侧轮廓视图中的**Table View Controller Scene**下的**Navigation Item**。

![Image](img/Image00205.jpg)

选择此项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。你应该会看到，当你完成此步骤并按下 RETURN 键后，轮廓视图中的表格视图控制器场景条目会自动更新为 Birthdays Scene。

接下来，我们将创建一个添加按钮，以便你可以添加生日！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并向该列表添加生日。让我们做一个按钮，让他们可以这样做！

我们需要在导航栏中添加一个按钮，指向“添加生日”场景，以便用户输入生日。找到对象库中的条形按钮项，然后将其拖放到表格视图控制器的导航栏右侧，如图 9-9 所示。

现在我们希望将此按钮变成“添加”按钮。幸运的是，Xcode 内置了一个我们可以使用的添加按钮。在属性检查器中，将条形按钮项的系统项更改为**Add**。你应该会看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在被点击时执行什么操作。我们希望它打开“添加生日”视图控制器，因此需要将“添加”按钮连接到该视图控制器。首先，双击故事板进行缩小，确保可以看到“生日”表格视图控制器和最终成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键并从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时，松开鼠标。这将弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar 按钮项拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在出现的对话框中选择“模态呈现”。*

连接对话框提供了几种选项，用于选择两者之间的*segue*——从一个屏幕到下一个屏幕的过渡类型。点击连接对话框中的**模态呈现**选项。这将使视图控制器以*模态*的方式出现在屏幕上。在 iPhone 上，模态视图控制器从手机底部滑动上来，并且默认没有返回按钮可以返回到上一个屏幕。相反，模态视图可以有其他按钮，比如“取消”或“保存”。还有其他类型的 segue，比如“显示”segue，其中视图控制器从右侧推送到屏幕上，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用程序中，当你呈现一个用于获取和保存用户输入的屏幕时，屏幕应作为模态视图显示，并带有“取消”按钮。否则，如果你使用类似“显示”segue 并带有返回按钮的方式，可能会出现用户输入完所有内容后，点击返回按钮而没有保存任何内容的情况！带有“取消”按钮时，用户必须故意点击以取消退出屏幕。

要查看模态输入视图控制器的一个好例子，可以看看你 iPhone 或 iPad 上的“日历”应用。当你打开它时，导航栏右侧有一个 + 按钮，点击它可以添加一个日历事件。点击 + 按钮会弹出一个模态的“新事件”视图控制器。该视图控制器的左侧有一个“取消”按钮，用于不保存并退出屏幕，右侧有一个“添加”按钮，用于在关闭模态视图之前创建新事件。你应该能看到“新事件”模态视图从屏幕底部滑入，关闭时又从屏幕底部滑出。我们希望用户保存生日信息，因此我们也将使用模态视图。

现在让我们尝试运行应用程序，看看到目前为止我们完成了什么！要运行应用程序，首先选择一个设备模拟器，方法是点击 Xcode 左上角的 BirthdayTracker 旁边列出的设备（参见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角，您的应用名称旁边设置模拟器运行的设备。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，供您运行应用程序。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮，或者使用快捷键⌘ -**R**。

当模拟器打开并运行您的应用时，如果模拟器太大，无法适应您的电脑屏幕，您可以调整其大小。点击模拟器以选择它，然后转到**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用程序时没有太多变化。您应该能看到您的第一个生日屏幕，上面有一个+按钮，如图 9-1 中所示。显然，在这一点上，您的生日屏幕将是空的。点击+按钮将弹出第二个空白屏幕。查看完应用程序后，通过点击 Xcode 中的停止按钮关闭它，停止按钮位于您之前按下的播放按钮旁边。当您停止应用时，您现在应该能在模拟器的主屏幕上看到您的应用图标！（参见图 9-12）。

就是这样！现在我们需要配置第二个屏幕，使其可以用于添加生日！

![图片](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，您需要将它嵌入到一个自己的导航控制器中。当视图控制器是模态的时，它不会继承已经在我们故事板上的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中点击选择普通视图控制器。然后转到**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在您应该看到在视图控制器场景下的轮廓视图中添加了一个导航项。点击这个新添加的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与您在为表视图控制器添加标题“生日”时遵循的步骤相同。

现在，当应用中出现“添加生日”视图控制器时，它将在顶部标注其标题。

#### 添加朋友的姓名和生日

当你在第十章中输入你朋友的生日时，应用中的每一条记录都会包含一个名字、一个姓氏和一个出生日期。我们来为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件是像文本框或下拉菜单这样的元素，允许用户将数据输入到应用中。我们首先从添加用户可以输入的所有信息的标签开始。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器添加一个显示“名字”的标签。这个标签将放在一个文本框旁边，你可以在其中输入你朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在，我们想通过大小检查器来设置标签的大小和位置。在 Xcode 故事板中，宽度和高度的单位是*点*。请注意，1 点并不等于 1 像素。根据应用运行的设备类型，1 点可能转换为 1 像素、一个 2×2 像素的方块或一个 3×3 像素的方块。这三种缩放因子分别称为@1x、@2x 和@3x（我们在设置应用图标时讨论过的大小）。不同的设备也有不同的点分辨率，宽度可以从 320 到 1,024 点，身高则从 568 到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：显示“名字”标签*

只有最老款的 iPhone 和 iPod 使用@1x 缩放因子，而你将无法在这些型号上运行你的应用（BirthdayTracker 将只支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们可能使用@2x 缩放因子，这些型号使用的是@3x 缩放因子。

对象在屏幕上的位置也是基于点来计算的。对象的 x 位置是从屏幕左侧到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离（以点为单位）（见图 9-15）。我们将设置每个库对象在视图控制器中的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签放置在屏幕的边缘之外，但仍然为其文本输入框和其他标签及输入留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，高度保持为 21。

完成这一步后，重复这些步骤，再添加两个标签到“添加生日”视图控制器中：一个是姓氏标签，另一个是出生日期标签。我们需要调整其他标签和输入控件的位置，确保它们不重叠。在某些情况下，这可能会变得复杂并需要一些时间。对于这款应用，我们已经为你计算好了放置控件的位置，适用于 iPhone 7 屏幕。稍后，我们会解释如何使你的应用适配其他设备。表 9-1 列出了每个标签应设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓氏 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有的标签都有相同的 X 位置，使它们垂直对齐，但每个标签的 Y 位置不同。每个标签的高度都是 21，因此 Y 位置需要至少比下一个最接近的标签大 21 个点。由于我们还要在每个标签下方添加输入控件，因此我们将 Y 位置调得更大，以适应标签的高度和输入控件的高度。

太好了！现在你的故事板应该和图 9-16 中的一样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本框*，它们让你能够输入姓氏和名字。文本框是 UITextField 类的一个 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在文本框中输入一行文本。

##### 添加文本框

从对象库中将两个文本框对象拖到视图控制器中。一个用于输入名字，另一个用于输入姓氏。按照表 9-2 中看到的大小和位置调整这两个文本框。你可以使用大小检查器来进行调整，就像你对标签所做的一样。

表 9-2：视图控制器中的文本框输入

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加一个称为*日期选择器*的控件，它可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像日历应用中的日期选择器一样（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，就像时钟应用中设置闹钟时使用的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中将使用的功能。

在对象库中滚动，直到找到日期选择器，然后点击并将其拖动到 Birthdate 标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整一些日期选择器的属性。点击选择日期选择器。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的出生日期吧！将日期字段从“当前日期”更改为**自定义**。这样会出现一个新框框。将此日期更改为你的出生日期。

让我们通过运行应用程序来测试到目前为止的效果！我们为输入控件选择的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器，点击左上角的播放按钮。这一次，当你点击 Birthdays 视图控制器上的 + 按钮时，应该会显示“添加生日”界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备怎么样呢？选择一个更小的模拟器来运行应用程序，比如 iPhone 5s，然后再次运行应用程序。你会发现界面看起来不太对。

所有添加到故事板的元素都出现了，但文本字段超出了屏幕边缘。现在你已经将所有元素放在了屏幕上，下一步是让它们在任何屏幕大小上都能正确适配。我们将通过一个叫做*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上都能完美显示，使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，而且未来可能会有更多的尺寸。你需要设计你的应用，使其在任何设备上都能看起来很棒。这意味着你需要让你的应用根据运行应用的设备来调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来调出自动布局菜单。*

在屏幕的故事板面板底部有一个带图标的功能区，位于工具面板之前的最右侧图标是一个位于两条竖线之间的三角形。将鼠标光标悬停在该图标上时，应该会显示一个标签，上面写着“解决自动布局问题”。点击该图标以弹出一个建议菜单。点击**添加缺失约束**。^(*) 当你这样做时，你会看到在“添加生日”场景中添加了很多布局约束。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的大小适合屏幕的宽度，并且不会超出屏幕边缘。自动布局还会确保每个文本字段前后有 20 个点的间距，使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用。这一次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这一部分，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。这些按钮目前不会执行任何操作，我们只是设置它们。我们将在第十章中添加一些代码，使它们能够取消“添加生日”屏幕并将生日保存到应用中。

为了添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们对添加按钮做的那样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“条形按钮项”，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你之前设置保存按钮一样。你的视图控制器应该看起来像图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新按钮的效果！

点击“生日”表视图控制器上的+按钮应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前不会执行任何操作——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你开始通过创建“生日”和“添加生日”屏幕的基本用户界面来制作一个 BirthdayTracker 应用。你还使用表视图控制器创建了“生日”屏幕，并使用户能够通过使用添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本骨架搭建，接下来你将在第十章中编程实现取消和保存按钮，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，添加缺失约束选项是禁用的。这是 Apple 的一个 bug。在这种情况下，选择 **重置为缺失约束** 选项来添加缺失的约束。

#### 添加表格视图控制器

我们的第一个视图控制器将是生日视图控制器。这将是一个特殊类型的视图控制器，用于显示列表，在 Xcode 中被称为 *表格视图控制器*。在我们的应用中，表格视图控制器将展示你朋友的生日列表！现在它看起来只是一个空白屏幕，你将在《创建生日表格视图控制器》（第 156 页）中学习如何展示生日数据。

让我们将表格视图控制器添加到故事板中。首先，如果你缩小视图，这一步会更容易，因为这样你能更好地看到视图控制器。你可以双击故事板中视图控制器之外的空白区域来实现缩小视图。现在你的屏幕应该已经缩小了。

在实用工具面板的底部，有一个包含四个按钮的区域。选择第三个按钮，看起来像一个圆圈内的方块。这个是对象库，在这里你可以找到要添加到故事板中的项。滚动浏览对象库列表，直到你找到表格视图控制器，或者使用面板底部的过滤栏搜索“表格视图控制器”。然后点击并拖动该对象到你的故事板中，直接将它放置在已有的视图控制器旁边。你的故事板应该像图 9-6 一样。

注意，在你添加表格视图控制器后，左侧的大纲视图中会出现一个“表格视图控制器场景”条目，里面包含了一个表格视图控制器。故事板中的场景代表了你应用中显示的屏幕区域。对于 iPhone 应用，通常一次屏幕上只会显示一个场景，而且该场景会填满整个屏幕。iPad 应用可以在同一屏幕上同时显示两个或更多的场景。

![Image](img/Image00202.jpg)

*图 9-6：将一个表格视图控制器添加到生日屏幕的故事板中*

下一步是将这个新视图控制器设置为应用运行时首次显示的屏幕，因为我们希望用户打开应用时能够看到生日列表。执行这一操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧的大纲视图中选择表格视图控制器并将其设为初始视图控制器。*

首先，在大纲视图 ➊ 中选择 **表格视图控制器**。然后在你的实用工具面板 ➋ 中打开属性检查器。在这里，勾选 **是初始视图控制器** ➌ 复选框。完成此操作后，故事板中的表格视图控制器左侧应该会出现一根箭头。箭头表示应用启动时将首先显示这个视图控制器。

#### 添加导航控制器

现在我们将为视图控制器添加一个标题，显示为“生日”，并添加一个“添加”按钮，打开“添加生日”视图控制器。为此，我们首先将表视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且可以在左右两侧显示用于导航到应用其他屏幕的按钮。您可以在多个 iOS 应用中看到这个导航栏，比如设置应用和信息应用。

在大纲视图中选择**表视图控制器**。选择后，您需要通过 Xcode 菜单将表视图控制器嵌入到导航控制器中。请前往**编辑** ▸ **嵌入** ▸ **导航控制器**。

在表视图控制器嵌入导航控制器之后，您的故事板应该像图 9-8 所示。导航控制器将在故事板中显示为一个屏幕。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表应用程序中用户将看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像一个独立的屏幕，但导航控制器实际上只是一个容器，包含用户在应用中来回切换的其他视图控制器。将一个视图控制器嵌入到导航控制器中意味着您的应用可以从一个视图切换到另一个视图，然后再返回。

您应该能在导航控制器和表视图控制器的顶部看到灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能还包含可以用来导航到其他屏幕的按钮和箭头。为了利用导航栏告诉用户他们当前所在的屏幕，我们需要为我们的屏幕设置标题。现在是重新聚焦到故事板的好时机。在故事板的空白处双击以放大视图，然后滚动视图以查看表视图控制器。要为表视图控制器添加标题，请点击左侧大纲视图中**表视图控制器场景**下的**导航项目**。

![Image](img/Image00205.jpg)

选中该项后，您可以在右侧的属性检查器中为屏幕输入一个标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。完成此步骤并按下 RETURN 后，您会看到大纲视图中的表视图控制器场景条目会自动更新为“生日场景”。

接下来，我们将制作一个“添加”按钮，以便您可以添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并将生日添加到该列表中。让我们制作一个按钮，让他们可以做到这一点！

我们需要在导航栏中添加一个按钮，指向“添加生日”场景，这样用户就可以输入生日了。在对象库中找到工具栏按钮项，然后将其拖放到表视图控制器导航栏的右侧，如图 9-9 所示。

现在我们要将这个按钮变成一个添加按钮。幸运的是，Xcode 有一个内置的添加按钮可以使用。在属性检查器中，将工具栏按钮项的系统项目更改为**添加**。你应该会看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮点击时应该做什么。我们希望它能打开“添加生日”视图控制器，因此需要将添加按钮与该视图控制器连接起来。首先，双击故事板进行缩小，确保你可以看到“生日”表视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从加号按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时，松开鼠标。这时会弹出一个连接对话框，类似于图 9-10 中的样式。

![Image](img/Image00206.jpg)

*图 9-9：将工具栏按钮项拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到邻近的视图控制器，并在出现的对话框中选择“模态呈现”选项。*

连接对话框为你提供了几种不同类型的*segue*（即屏幕之间的过渡）选项，供你选择。点击连接对话框中的**模态呈现**选项。这将使视图控制器以*模态*方式出现在屏幕上。在 iPhone 上，模态视图控制器会从屏幕底部弹出，并且不会自动带有返回按钮。相反，模态视图可以有其他按钮，比如取消或保存。还有其他类型的 segue，比如“展示”segue，视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个获取和保存用户输入的界面时，屏幕应该以模态的方式显示，并带有一个取消按钮。否则，如果你使用类似“展示”跳转并带有返回按钮的方式，可能会出现用户输入所有信息后，点击返回按钮但没有保存任何内容的情况！通过取消按钮，用户必须有意识地点击取消按钮以退出该界面。

要查看一个良好的模态输入视图控制器示例，可以查看你 iPhone 或 iPad 上的日历应用。当你打开它时，在导航栏的右侧会有一个 + 按钮，点击它可以添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器的左侧有一个取消按钮，可以取消操作并不保存，右侧有一个添加按钮，可以在关闭模态前创建新事件。你应该看到，新事件模态从屏幕底部滑入，当关闭时又滑回底部。我们希望用户能保存生日，因此我们也会使用模态。

现在让我们尝试运行我们的应用，看看我们目前完成了什么！要运行应用，首先选择一个设备模拟器，方法是点击 Xcode 左上角 BirthdayTracker 旁边列出的设备（参见 图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，选择与应用名称旁边的设备，设置模拟器运行的设备。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮，或使用快捷键 ⌘ -**R**。

当模拟器打开以运行你的应用时，如果模拟器的大小过大，无法适应你的计算机屏幕，你可以调整它的大小。点击模拟器进行选择，然后进入 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时，并没有太多变化。你应该能看到你第一个生日屏幕，带有一个 + 按钮，如前面在 图 9-1 中所示。显然，到这个时候，你的生日屏幕将是空的。点击 + 按钮会弹出第二个空白屏幕。当你查看完应用后，通过点击 Xcode 中的停止按钮来关闭它，该按钮位于你之前点击的播放按钮旁边。当你停止应用时，你应该会看到应用图标出现在模拟器的主屏幕上！（参见 图 9-12。）

就这样！现在我们需要配置第二个屏幕，使其能够用于添加生日！

![图片](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到一个自己的导航控制器中。当视图控制器是模态的时，它不会继承我们已经在故事板中添加的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的普通视图控制器来选择它。然后，前往**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在你应该能看到在视图控制器场景下的轮廓视图中添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤和你在给表格视图控制器添加“生日”标题时遵循的步骤相同。

现在，当“添加生日”视图控制器在应用中出现时，它的顶部将显示标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每个条目都将包含一个名字、一个姓氏和一个出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户为每个人输入所有这些信息。输入控件是像文本框或下拉菜单这样的控件，允许用户向应用中输入数据。我们将从为所有可以添加的信息添加输入控件标签开始。

##### 添加和定位标签

为你的“添加生日”视图控制器创建一个显示“名字”的标签。这个标签将放置在一个文本框旁边，用户可以在其中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器上（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在我们希望使用大小检查器来设置标签的大小和位置。在 Xcode 故事板中，宽度和高度以*点（points）*为单位进行测量。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点将转换为 1 像素、2×2 像素的方块，或 3×3 像素的方块。这三种缩放因子分别称为@1x、@2x 和@3x（这是我们在设置应用图标时讨论过的相同大小）。设备的点分辨率也不相同，可能从 320 点到 1,024 点宽，从 568 点到 1,366 点高。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最旧款的 iPhone 和 iPod 使用 @1x 比例因子，而你无法在这些设备上运行你的应用（BirthdayTracker 只支持 iOS 10 及以上版本）。除非你的 iPhone 或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们很可能使用 @2x 比例因子，而这些设备使用的是 @3x 比例因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离（单位：点）。y 位置是从屏幕顶部到对象顶部的距离。（见 图 9-15）我们将为每个添加到视图控制器的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕的边缘之外，同时仍然为其文本输入框和其他标签及输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成后，重复这些步骤，在添加生日视图控制器中再添加两个标签：姓氏标签和生日标签。我们需要定位其他标签和输入控件，以免它们重叠。在某些情况下，这可能会变得有些棘手，可能需要一些时间。对于这个应用，我们已经为你计算好了在 iPhone 7 屏幕上放置对象的位置。稍后我们会解释如何使你的应用适配其他设备。表 9-1 列出了你应该给每个标签的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，这样它们就能垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，所以 y 位置必须至少比下一个标签高 21 个点。由于我们还要在每个标签下方添加输入控件，因此我们增加了 y 位置，以适应标签的高度和输入控件的高度。

太棒了！现在你的故事板应该看起来像 图 9-16 中的那样。

![Image](img/Image00214.jpg)

*图 9-16：输入的标签已被添加到视图控制器中。*

接下来，你将添加两个 *文本框*，用于输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以在框内输入一行文本。

##### 添加文本框

从对象库中拖动两个文本字段对象到你的视图控制器上。一个用于输入名字，另一个用于输入姓氏。按照表 9-2 中的尺寸和位置设置这两个文本字段。你可以像设置标签一样使用大小检查器来完成这一操作。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个叫做*日期选择器*的控件。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器一样（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器进行日期选择。*

日期选择器还可以只显示时间，就像在时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动直到找到日期选择器，然后点击并拖动它到“生日”标签下的视图控制器上。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整一下日期选择器的一些属性。点击选择日期选择器，然后在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将这个日期改为你的出生日期吧！将日期字段从“当前日期”改为**自定义**。这样会出现一个新框，修改为你的出生日期。

让我们通过运行应用来测试它的功能！我们为输入控件设置的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你在“生日”视图控制器上点击 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![图片](img/Image00218.jpg)

在 iPhone 7 上显示得很好，但其他设备呢？选择一个较小的模拟器来运行该应用，比如 iPhone 5s，然后再次运行应用。你会发现界面看起来不太对劲。

你添加到故事板中的所有元素都会显示出来，但文本框却超出了屏幕的边缘。现在你已经将所有元素放置在屏幕上，接下来的步骤是让它们在任何屏幕尺寸下都能正确显示。我们将使用一个叫做*自动布局*的工具来完成这一点。

#### 让你的应用在每个设备上都完美显示，使用自动布局

单单是 iPhone 就有三种不同的屏幕尺寸，并且未来可能会有更多尺寸出现。你需要设计你的应用，使其在任何设备上看起来都不错。这意味着，你希望你的应用能够根据运行设备的不同，自动调整屏幕上所有元素的位置和大小。自动布局使用了一种叫做*布局约束*的技术来将元素放置到屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标，调出自动布局菜单。*

屏幕故事板窗格的底部有一个带图标的带状工具条，在“实用工具”窗格之前最右侧的图标是一个位于两条垂直线之间的三角形。将鼠标指针悬停在该图标上时，它应该会显示一个标签，写着“解决自动布局问题”。点击这个图标以调出一个建议菜单。点击**添加缺失约束**。^(*) 当你这么做时，你会看到大量的布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，能够适应屏幕。例如，自动布局确保日期选择器的宽度适合屏幕，不会超出边缘。自动布局还会确保每个文本框前后有 20 个点的间隔，使其在屏幕上居中显示。

现在，再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。按钮目前还不会执行任何操作。我们只是设置它们而已。在第十章，我们会添加一些代码，使它们能够取消并退出“添加生日”屏幕，或者将生日保存到应用中。

为了添加保存按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮改成一个保存按钮，就像我们做的添加按钮一样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将它放置在导航栏的*左侧*。使用属性检查器将它设置为取消按钮，就像你之前为保存按钮所做的那样。你的视图控制器应该像图 9-21 中显示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在重新运行你的应用，看看新的按钮！

点击“生日”表格视图控制器中的+按钮应该会带你到“添加生日”视图控制器，在这里你可以输入一个人的名字和生日日期。点击取消和保存按钮目前还没有反应——我们将在第十章中实现这两个按钮的功能！

### 你学到的内容

在本章中，你开始制作一个 BirthdayTracker 应用，通过创建“生日”和“添加生日”屏幕的基本用户界面。你还使用表格视图控制器创建了“生日”屏幕，并使用户能够通过“添加”按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本骨架，在第十章中你将编写代码来实现取消和保存按钮，这样你就可以在应用中添加并保存生日信息了！

* 在某些版本的 Xcode 中，"添加缺失的约束"选项是禁用的。这是一个苹果的 bug。在这种情况下，选择“重置为缺失的约束”选项以添加缺失的约束。

我们的第一个视图控制器将是“生日”视图控制器。这将是一个特殊的视图控制器类，显示一个列表，在 Xcode 中称为*表格视图控制器*。在我们的应用中，表格视图控制器将显示你朋友的生日列表！目前它只会显示一个空屏幕，你将在“创建生日表格视图控制器”（第 156 页）中学习如何显示生日数据。

让我们在故事板中添加一个表格视图控制器。如果你先从故事板缩小视图，这一步会更容易，这样你就能更清晰地看到视图控制器了。双击故事板中视图控制器外的空白区域来完成这个操作。现在你的屏幕应该已经缩小了。

在工具面板的底部，有一个包含四个按钮的区域。选择第三个按钮，看起来像一个圆圈内的正方形。这个是对象库，你可以在这里找到要添加到故事板的项。滚动浏览对象库列表，直到找到“表格视图控制器”，或者使用面板底部的筛选栏搜索“table view controller”。然后点击并拖动该对象到你的故事板上，放在已经存在的视图控制器旁边。你的故事板应该像图 9-6 中显示的那样。

请注意，在你添加表格视图控制器后，左侧的大纲视图中会出现一个“表格视图控制器场景”条目，并在其中显示一个表格视图控制器。故事板中的场景表示你应用中屏幕上的一个区域。对于 iPhone 应用程序，通常一次只有一个场景显示在屏幕上，且该场景会填满整个屏幕。而 iPad 应用程序可以同时在屏幕上显示两个或更多场景。

![Image](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到生日屏幕的故事板中*

下一步是将这个新视图控制器设为应用运行时首先显示的屏幕，因为我们希望用户打开应用时，能看到生日列表。完成此操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊ 。然后在工具面板中调出属性检查器 ➋ 。在这里，勾选**是初始视图控制器**的选项 ➌ 。完成后，表格视图控制器左侧的故事板上应该会出现一个箭头。这个箭头表示应用启动时会显示这个视图控制器。

#### 添加导航控制器

现在，我们将为视图控制器添加一个标题，命名为“生日”，并添加一个“添加”按钮，点击后会显示添加生日的视图控制器。为此，首先我们将表格视图控制器放入*导航控制器*中。导航控制器管理一个或多个视图控制器，它配备了一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧显示按钮，用于导航到应用中的其他屏幕。你会在多个 iOS 应用程序中看到这个导航栏，比如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。选择后，你需要使用 Xcode 菜单将表格视图控制器嵌入到导航控制器中。前往**编辑** ▸ **嵌入到** ▸ **导航控制器**。

在表格视图控制器嵌入到导航控制器后，你的故事板应该像图 9-8 中的那样。导航控制器会作为一个屏幕显示在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

在故事板中的每个视图控制器代表你的应用程序中用户将看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像是一个独立的屏幕，实际上它只是一个容器，用来保存用户在应用中切换的其他视图控制器。将一个视图控制器嵌入到导航控制器中，意味着你的应用可以从一个视图导航到另一个视图，再返回。

你应该会看到导航控制器和表视图控制器顶部有灰色的导航栏。当应用运行时，导航栏会告诉用户他们当前所在屏幕的标题，并且可能包含按钮和箭头，用户可以使用它们去其他屏幕。为了使用导航栏告诉用户他们当前所在的屏幕，我们需要给屏幕命名。现在是回到故事板的好时机。双击故事板的空白区域以进行放大，然后滚动视图，直到你能看到表视图控制器。要为表视图控制器添加标题，请在左侧的大纲视图中点击**导航项**，它位于**表视图控制器场景**下。

![Image](img/Image00205.jpg)

选择此选项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。完成此步骤并按下 RETURN 后，你应该会看到大纲视图中的表视图控制器场景条目自动更新为“生日场景”。

接下来，我们将制作一个添加按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将生日添加到列表中。让我们做一个按钮，让他们能够做到这一点！

我们需要在导航栏上添加一个按钮，通向“添加生日”场景，这样用户就可以输入生日。找到对象库中的条形按钮项，然后将其拖放到表视图控制器导航栏的右侧，如图 9-9 所示。

现在我们要将这个按钮变成一个“添加”按钮。幸运的是，Xcode 有一个内置的“添加”按钮可以使用。在属性检查器中，将条形按钮项的系统项目更改为**添加**。你应该会看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮在点击时执行什么操作。我们希望它打开“添加生日”视图控制器，因此我们需要将添加按钮与该视图控制器连接起来。首先，双击故事板进行缩小，确保你可以同时看到“生日”表视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键并从加号按钮拖动到故事板右侧的空白视图控制器中。鼠标放开时，视图控制器会被高亮显示。这时会弹出一个连接对话框，类似于图 9-10 中所示的。

![Image](img/Image00206.jpg)

*图 9-9：将一个条形按钮项拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在出现的对话框中选择“模态呈现”。*

连接对话框为您提供了多个选项，以选择您希望在两个视图控制器之间创建的*segue*——即从一个屏幕到下一个屏幕的过渡效果。点击连接对话框中的**模态展示**选项。这将使视图控制器作为*模态*视图控制器展示到屏幕上。在 iPhone 上，模态视图控制器从手机底部弹出，并且通常没有自动附带返回按钮来返回到前一个屏幕。相反，模态视图控制器可以包含其他按钮，例如取消或保存。还有其他类型的 segue，比如 Show segue，它会将视图控制器从右侧推送到屏幕上，并在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当您展示一个屏幕以获取和保存用户输入时，该屏幕应以模态的形式显示，并且带有取消按钮。否则，如果使用类似 Show 的 segue 并带有返回按钮，用户可能会输入所有内容后点击返回按钮而不保存任何信息！通过取消按钮，用户必须故意点击以取消退出屏幕。

要查看一个良好的模态输入视图控制器示例，请查看您 iPhone 或 iPad 上的日历应用。当您打开它时，导航栏右侧有一个 + 按钮，您可以点击它以添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，用于在不保存的情况下取消当前屏幕，右侧有一个添加按钮，用于在关闭模态视图前创建新事件。您应该能看到新事件模态视图从屏幕底部弹出，关闭时会再次下滑。我们希望用户保存生日，所以我们也将使用模态视图。

现在让我们尝试运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先通过点击 Xcode 左上角 BirthdayTracker 旁边列出的设备来选择一个设备模拟器（见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角应用名称旁边设置模拟器运行的设备。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，供您选择用于运行应用的设备。我们选择 iPhone 7。在选择了模拟器之后，点击左上角的播放按钮或使用快捷键 ⌘ -**R**。

当模拟器打开并运行您的应用时，如果模拟器的尺寸太大，无法适应计算机屏幕，您可以调整其大小。点击模拟器以选中它，然后前往**窗口** ▸ **缩放**，在模拟器菜单中选择较小的缩放比例。

到目前为止，当你运行应用时，效果并不显著。你应该能看到之前在图 9-1 中显示的第一个生日屏幕，并带有一个+按钮。显然，此时你的生日屏幕将是空的。点击+按钮会弹出第二个空白屏幕。当你查看完应用后，可以点击 Xcode 中的停止按钮关闭应用，停止按钮位于你之前按下的播放按钮旁边。停止应用后，你现在应该能在模拟器的主屏幕上看到你的应用图标！(参见图 9-12 。)

就这样！我们现在需要配置第二个屏幕，使其能够用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：生日追踪器应用图标已添加到主屏幕。*

### 设置控件输入和标签

让我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，你需要将其嵌入到一个自己的导航控制器中。当视图控制器是模态时，它不会继承我们故事板上已有的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到一个自己的导航控制器中。在故事板中点击选择普通视图控制器，然后转到**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该能在视图控制器场景下的轮廓视图中看到一个导航项。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤和你为表格视图控制器添加标题“生日”时相同。

现在，当“添加生日”视图控制器在应用中出现时，它的顶部会显示标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每一条记录都会包含名字、姓氏和生日。接下来，我们在“添加生日”视图控制器中加入一些*输入控件*，以便用户为每个人输入这些信息。输入控件是指像文本框或下拉菜单这样的元素，允许用户向应用中输入数据。我们将通过为用户可以添加的所有信息添加输入控件标签来开始。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器制作一个显示“名字”的标签。这个标签将放置在文本框旁边，用户将在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在，我们想使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点（points）*为单位进行测量的。请注意，1 点并不是 1 像素。根据您的应用运行的设备类型，1 点会转换为 1 像素、2×2 像素的方块或 3×3 像素的方块。这三个缩放因子被称为 @1x、@2x 和 @3x（我们在设置应用图标时提到过的相同大小）。设备的点分辨率也不相同，宽度可以从 320 到 1,024 点不等，纵深可以从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* 姓氏

只有最旧款的 iPhone 和 iPod 使用 @1x 缩放因子，而且您无法在这些机型上运行您的应用程序（BirthdayTracker 只支持 iOS 10+）。除非您的设备是 iPhone 6 Plus、6s Plus 或 7 Plus，否则您的手机或 iPod 很可能使用 @2x 缩放因子，而这三款设备则使用 @3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离（单位：点）。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15）。我们将设置我们添加到视图控制器的每个库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，但仍然为其文本输入框和其他标签与输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成此步骤后，重复这些步骤为“添加生日”视图控制器添加两个标签：一个姓氏标签和一个出生日期标签。我们需要定位其他标签和输入框，以确保它们不会重叠。在某些情况下，这可能会变得有些复杂，并且可能需要一些时间。对于这个应用程序，我们已经为您计算了放置对象的位置，适用于 iPhone 7 屏幕。稍后，我们将解释如何让您的应用适配其他设备。表 9-1 列出了您应为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你会发现，所有的标签都具有相同的 x 坐标位置，以便它们在垂直方向上对齐，但它们每个都有不同的 y 坐标位置。每个标签的高度为 21，因此 y 坐标必须比下一个最接近的标签大至少 21 个点。由于我们也要在每个标签下方添加输入控件，因此我们将 y 坐标设置得更大，以便容纳标签的高度和输入控件的高度。

太好了！现在你的故事板应该像 图 9-16 中那样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来你将添加两个*文本框*，用来输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户就可以在该文本框中输入一行文本。

##### 添加文本框

从对象库中拖拽两个文本框对象到你的视图控制器中。一个用来输入名字，另一个用来输入姓氏。根据 表 9-2 中的尺寸和位置设置这两个文本框的大小和位置。你可以使用尺寸检查器来完成这一步，就像之前为标签所做的那样。

表 9-2：视图控制器中的文本框输入

| 文本框 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个叫做*日期选择器*的轮子。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时显示日期和时间，像日历应用中使用的日期选择器一样（见 图 9-17 ）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器选择日期。*

日期选择器还可以只显示时间，像时钟应用中用于添加闹钟的日期选择器一样，或者只显示日期，这就是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到视图控制器中的出生日期标签下方。使用尺寸检查器，将 x 坐标设置为 0，y 坐标设置为 280。

你还需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见 图 9-18 ）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们把这个日期改成你的出生日期！将日期字段从当前日期更改为**自定义**。这样做时，会出现一个新的框框。将此日期更改为你的出生日期。

让我们通过运行应用程序来测试目前为止的效果！我们为输入控件所使用的尺寸非常适合 iPhone 7 的屏幕。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你点击生日视图控制器上的+按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备怎么样呢？选择一个较小的模拟器运行应用程序，比如 iPhone 5s，然后重新运行应用程序。你会看到一些内容看起来不太对劲。

你添加到故事板中的所有元素都出现了，但文本框超出了屏幕边缘。现在你已经将所有元素放在了屏幕上，接下来的步骤是确保它们能正确适应任何屏幕尺寸。我们将通过一个名为*自动布局*的工具来完成这项工作。

#### 通过自动布局使你的应用在每个设备上都看起来完美

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能会有更多尺寸推出。你需要设计你的应用程序，使其在任何设备上都能显示得很好。这意味着，你需要让应用程序根据设备的不同，自动调整所有元素的位置和大小。自动布局使用了叫做*布局约束*的东西来安排屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的概览视图中选择**视图控制器**。接着，查看编辑面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标，调出自动布局菜单。*

屏幕故事板面板底部有一条带有图标的带状区域，位于实用工具面板之前的最右侧图标是一个在两条垂直线之间的三角形。将鼠标光标悬停在这个图标上，它会显示一个标签，写着“解决自动布局问题”。点击这个图标，会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到一堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局使得日期选择器的宽度适应屏幕宽度，并且不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点的间距，以便它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，添加生日屏幕应该显示得完美无瑕。

#### 添加保存和取消按钮

为了完成最后的工作，我们将向你展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。这些按钮暂时不会做任何事，我们只是进行设置。在第十章中，我们将添加代码，使它们能够取消添加生日屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个栏按钮项并将其放置在导航栏的 *右侧*。我们将把这个按钮设置为保存按钮，就像我们设置添加按钮一样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个栏按钮项，并将其放置在导航栏的 *左侧*。使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该像图 9-21 所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新的按钮！

点击生日表格视图控制器上的 + 按钮应该会带你进入添加生日视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮暂时不会做任何事情——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你通过创建生日和添加生日屏幕的基本用户界面，开始制作生日追踪应用。你还使用表格视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用程序的基本框架，第十章 将教你如何编程实现取消和保存按钮，从而可以在应用程序中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是苹果的一个 bug。在这种情况下，选择 **重置为缺失约束** 选项来添加缺失的约束。

让我们在故事板中添加一个表格视图控制器。如果先将故事板缩小，这个步骤会更容易，你可以更清晰地看到视图控制器。双击视图控制器外的空白区域即可缩小屏幕。现在，屏幕应该已经缩小。

在工具面板的底部有四个按钮，位于顶部。选择第三个按钮，它看起来像是一个圆圈内的方形图标。这是对象库，你可以在这里找到可以添加到故事板中的项目。滚动对象库列表，直到找到表格视图控制器，或者使用面板底部的筛选栏搜索“table view controller”。然后点击并拖动该对象到故事板上，放在已有视图控制器旁边。你的故事板应该像图 9-6 中的一样。

请注意，在你添加表格视图控制器后，大纲视图左侧会出现一个“表格视图控制器场景”条目，里面有一个表格视图控制器。故事板中的场景表示应用屏幕上的一个区域。对于 iPhone 应用，通常一次只显示一个场景，并且这个场景会填满整个屏幕。iPad 应用则可以在同一时间显示两个或多个场景。

![Image](img/Image00202.jpg)

*图 9-6：向生日屏幕的故事板中添加表格视图控制器*

下一步是让这个新视图控制器成为应用启动时首先显示的屏幕，因为我们希望在用户打开应用时显示生日列表。完成这个操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊ 。然后在工具面板中打开属性检查器 ➋ 。在这里，勾选**是初始视图控制器** ➌ 。完成后，你的表格视图控制器旁边应该会出现一个箭头，表示应用启动时将显示这个视图控制器。

#### 添加导航控制器

现在我们将在视图控制器中添加一个标题“生日”和一个添加按钮，该按钮将弹出“添加生日”视图控制器。为了做到这一点，我们首先将表格视图控制器放入*导航控制器*中。导航控制器管理一个或多个视图控制器，并且自带一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且在左右两侧有按钮，用于导航到应用中的其他屏幕。你在多个 iOS 应用中看到的顶部条就是这个，比如设置应用和信息应用。

在轮廓视图中选择**Table View Controller**。选中它后，你需要使用 Xcode 菜单将表视图控制器嵌入到导航控制器中。前往**Editor** ▸ **Embed In** ▸ **Navigation Controller**。

在表视图控制器嵌入到导航控制器后，你的故事板应该像图 9-8 中的那样。导航控制器会作为一个屏幕显示在故事板中。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

每个故事板中的视图控制器代表你的应用程序中用户将看到的一个屏幕，但导航控制器有些不同。尽管它在故事板中看起来像一个独立的屏幕，实际上导航控制器只是一个容器，里面包含了用户在应用程序中切换的其他视图控制器。将一个视图控制器嵌入到导航控制器中意味着你的应用程序可以在一个视图与另一个视图之间进行导航。

你应该能看到导航控制器和表视图控制器顶部的灰色导航栏。当应用程序运行时，导航栏会告诉用户他们当前所在屏幕的标题，并可能包含用户可以用来跳转到其他屏幕的按钮和箭头。为了利用导航栏告诉用户当前所在的屏幕，我们需要为我们的屏幕命名。现在是放大回到故事板的好时机。双击故事板中的空白处进行放大，然后滚动视图，直到你能看到表视图控制器。要为表视图控制器添加标题，请在左侧的轮廓视图中点击**Navigation Item**，该项位于**Table View Controller Scene**下。

![图片](img/Image00205.jpg)

选中后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，所以在右侧的“Title”字段中输入**Birthdays**。完成此步骤并按下 RETURN 后，你应该看到轮廓视图中的“Table View Controller Scene”项自动更新为“Birthdays Scene”。

接下来，我们将创建一个“添加”按钮，让你可以添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并向列表中添加一个生日。让我们做一个按钮，让他们可以做到这一点！

我们需要在导航栏中添加一个按钮，指向“添加生日”页面，以便用户可以输入生日。在对象库中找到“Bar Button Item”，然后将其拖动到表视图控制器的导航栏右侧，如图 9-9 所示。

现在我们想把这个按钮变成一个“添加”按钮。幸运的是，Xcode 有一个内置的“添加”按钮，我们可以使用。在属性检查器中，将“系统项”设置为**Add**。你应该能看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮点击时该做什么。我们希望它打开“添加生日”视图控制器，因此需要将添加按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你能看到“生日”表格视图控制器和将来成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器高亮显示时，松开鼠标。这将弹出一个连接对话框，如图 9-10 所示。

![图片](img/Image00206.jpg)

*图 9-9：将“条形按钮项”拖到“生日”视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态展示”。*

连接对话框提供了几种不同的*转场*选项——即从一个屏幕到另一个屏幕的过渡方式。点击连接对话框中的**模态展示**选项。这将使视图控制器以*模态*形式显示在屏幕上。在 iPhone 上，模态视图控制器从屏幕底部滑上来，并且不会自动带有返回按钮返回上一屏幕。相反，模态视图可以有其他按钮，如取消或保存。还有其他类型的转场，比如“显示”转场，它将视图控制器从屏幕右侧推出，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，该屏幕应该以模态形式显示，并带有取消按钮。否则，如果你使用类似“显示”转场并配有返回按钮，用户可能会输入所有内容后直接点击返回按钮，导致没有保存任何东西！带有取消按钮可以让用户必须有意点击才能退出屏幕。

要查看一个好的模态输入视图控制器的例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，你会看到导航栏右侧有一个 + 按钮，点击它可以添加一个日历事件。点击 + 按钮会弹出一个模态的“新建事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以退出该界面而不保存；右侧有一个添加按钮，可以在关闭模态窗口前创建新事件。你应该看到，当“新建事件”模态视图出现时，它是从屏幕底部滑上来的，关闭时又会滑回底部。我们希望用户能保存生日，因此我们也会使用模态视图。

现在，让我们尝试运行我们的应用程序，看看到目前为止我们做了什么！要运行应用程序，首先选择一个设备模拟器，通过点击 Xcode 左上角的 BirthdayTracker 旁边列出的设备（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：设置模拟器将运行的设备，位于 Xcode 窗口左上角，紧挨着应用程序名称。在此，设备设置为 iPhone 7。*

这将会弹出一个设备选项列表，用于运行您的应用程序。我们选择 iPhone 7。选择完模拟器后，点击左上角的播放按钮，或使用键盘快捷键 ⌘ -**R**。

当模拟器打开并运行您的应用程序时，如果它太大无法适应计算机屏幕，您可以调整其大小。点击模拟器以选择它，然后进入**窗口** ▸ **缩放**，并在模拟器菜单中选择更小的比例。

到目前为止，当您运行应用程序时，不会发生太多事情。您应该会看到您的第一个“生日”屏幕，其中有一个 + 按钮，如之前在图 9-1 中所示。显然，在这一点上，您的“生日”屏幕将是空的。点击 + 按钮将会弹出第二个空白屏幕。当您查看完应用程序后，通过点击 Xcode 中的停止按钮（在您之前按下的播放按钮旁边）关闭它。当您停止应用程序时，您现在应该可以在模拟器的主屏幕上看到您的应用图标！（参见图 9-12）。

就这样！现在我们需要配置第二个屏幕，以便它可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用程序图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，您需要将其嵌入到一个独立的导航控制器中。当一个视图控制器是模态时，它不会继承我们在故事板中已经存在的导航控制器中的导航栏。导航控制器提供了导航栏，所以我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中点击选择普通视图控制器。然后进入**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在您应该会看到一个导航项已被添加到视图控制器场景的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与您之前为表视图控制器添加标题“生日”时遵循的步骤相同。

现在，当“添加生日”视图控制器在应用程序中出现时，它将在顶部显示标题标签。

#### 添加您朋友的名字和生日

当你在第十章中输入你朋友的生日时，你的应用程序中的每个条目都会有一个名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件是允许用户在应用程序中输入数据的控件，如文本字段或下拉菜单。我们将通过添加用户可以输入的所有信息的输入控件标签来开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个显示“First Name”（名字）的标签。这个标签将放置在一个文本字段旁边，用于输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们希望使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以*点*为单位。请注意，1 点不等于 1 像素。根据你的应用程序运行的设备类型，1 点可能等于 1 个像素、2×2 像素的方块或 3×3 像素的方块。这三种缩放因子分别称为@1x、@2x 和@3x（我们在设置应用图标时讨论过相同的尺寸）。不同设备的点分辨率也不同，宽度从 320 到 1,024 点不等，高度从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：让标签显示“First Name”*

只有最旧型号的 iPhone 和 iPod 使用@1x 缩放因子，并且你将无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则很可能你的设备使用@2x 缩放因子，而这几款设备则使用@3x 缩放因子。

对象在屏幕上的位置也是基于点来计算的。对象的 x 位置是从屏幕左边到对象左边的距离，以点为单位。y 位置是从屏幕顶部到对象顶部的距离。（见图 9-15）。我们将设置每个我们添加到视图控制器的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕边缘之外，但又足够留出空间给它的文本输入字段以及其他标签和输入控件。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成后，重复这些步骤，为“添加生日”视图控制器添加两个标签：一个姓氏标签和一个出生日期标签。我们需要为其他标签和输入框确定位置，以确保它们不会重叠。在某些情况下，这可能会变得复杂并且需要一些时间。对于这个应用，我们已经为你计算了在 iPhone 7 屏幕上的控件放置位置。稍后我们会解释如何让你的应用适配其他设备。表 9-1 列出了你应该给每个标签设置的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 坐标位置相同，因此它们垂直对齐，但每个标签的 y 坐标位置不同。每个标签的高度为 21，所以 y 坐标需要至少比下一个标签高出 21 个点。由于我们也在每个标签下方添加输入控件，因此我们将 y 坐标设置得更大，以适应标签的高度和输入控件的高度。

太好了！现在你的故事板应该像图 9-16 中的那样。

![图片](img/Image00214.jpg)

*图 9-16：输入的标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们将允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖拽两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。给这两个文本字段设置表 9-2 中看到的尺寸和位置。你可以像设置标签一样，使用尺寸检查器来进行设置。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后，你需要添加一个叫做*日期选择器*的滚轮控件。它可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的工具，用于让用户选择日期或时间。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器一样（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以只显示时间，就像时钟应用中用于设置闹钟的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后将其点击并拖到视图控制器中的出生日期标签下方。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整一些日期选择器的属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（请参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器设置为显示当前日期。现在，让我们将这个日期改为你的生日！将日期字段从当前日期更改为**自定义**。这样，一个新的框将会出现。将这个日期改为你的生日。

让我们测试一下目前为止应用的运行情况！我们为输入控件选择的尺寸在 iPhone 7 屏幕上适配得很好。所以选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这次，当你点击生日视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个更小的模拟器来运行应用，比如 iPhone 5s，然后再次运行应用。你会发现，事情看起来并不完全正确。

你添加到故事板中的所有元素都已显示出来，但文本框超出了屏幕的边缘。现在，所有元素都已经出现在屏幕上，接下来的步骤是确保它们能够在任何屏幕尺寸上正确显示。我们将使用一个名为*自动布局*的工具来完成这个任务。

#### 在每个设备上让你的应用看起来完美：使用自动布局

单独的 iPhone 就有三种不同的屏幕尺寸，未来可能会有更多尺寸出现。你需要设计你的应用，使其在任何设备上看起来都很好。这意味着你需要让你的应用根据运行应用的设备调整所有元素的位置和大小。自动布局使用一种名为*布局约束*的技术来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（请参见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

屏幕故事板面板的底部有一个带图标的带状工具条，在“实用工具”面板前的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，上面写着“解决自动布局问题”。点击这个图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这么做时，你会看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适应屏幕宽度，并且不会超出边界。自动布局还会确保每个文本字段前后有 20 个点的间距，从而使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用。这次，添加生日的界面应该完美显示。

#### 添加保存和取消按钮

为了完成任务，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮暂时不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使按钮能够退出“添加生日”界面并将生日保存到应用中。

为了添加保存按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们对添加按钮做的那样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中再拖动一个“Bar Button Item”，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你之前做的保存按钮一样。你的视图控制器应该像图 9-21 所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新的按钮效果！

点击“生日”表格视图控制器上的+按钮应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮暂时不会有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在这一章中，你开始通过创建“生日”和“添加生日”界面的基本用户界面来制作一个 BirthdayTracker 应用。你还使用表格视图控制器创建了“生日”界面，并使用户能够通过添加按钮和导航控制器在界面间切换。

现在你已经完成了应用的基本框架，第十章将教你如何编程实现“取消”和“保存”按钮，让你可以在应用中添加和保存生日信息！

* 在某些版本的 Xcode 中，"添加缺失的约束" 选项是禁用的。这是苹果的一个 bug。在这种情况下，选择 **重置为缺失的约束** 选项来添加缺失的约束。

在工具窗格的底部有一个区域，顶部有四个按钮。选择第三个按钮，它看起来像一个圆圈内的正方形。这是对象库，您可以在这里找到可以添加到故事板的项目。滚动浏览对象库列表，直到找到“表视图控制器”，或者使用窗格底部的过滤栏搜索“table view controller”。然后点击并拖动该对象到您的故事板中。将其直接放到已经存在的视图控制器旁边。您的故事板应该像图 9-6 中那样。

请注意，在您添加表视图控制器后，左侧的大纲视图中会出现一个“表视图控制器场景”条目，其中包含一个表视图控制器。故事板中的场景代表应用中屏幕上的一个区域。对于 iPhone 应用，通常一次屏幕上只有一个场景，并且该场景填满整个屏幕。iPad 应用可以在同一时间显示两个或更多场景。

![Image](img/Image00202.jpg)

*图 9-6：将表视图控制器添加到生日屏幕的故事板中*

下一步是让这个新的视图控制器成为当您运行应用时首先显示的屏幕，因为我们希望用户打开应用时看到生日列表。执行此操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表视图控制器并将其设置为初始视图控制器。*

首先，在大纲视图中选择 **表视图控制器** ➊。然后在工具窗格中打开属性检查器 ➋。在这里，勾选 **是初始视图控制器** ➌。完成此操作后，您的故事板中的表视图控制器左侧应该会出现一个箭头。这个箭头意味着当应用启动时，会显示这个视图控制器。

#### 添加导航控制器

现在我们将为视图控制器添加一个标题，显示为“生日”，以及一个“添加”按钮，点击后将弹出添加生日视图控制器。为了实现这一点，我们首先将表视图控制器放入一个 *导航控制器* 中。导航控制器管理一个或多个视图控制器。它带有一个 *导航栏*，该栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，以及左右两侧的按钮，用于在应用中导航到其他屏幕。您在多个 iOS 应用中会看到这个导航栏，比如设置应用和信息应用。

在轮廓视图中选择**表视图控制器**。选择后，您需要通过 Xcode 菜单将表视图控制器嵌入到导航控制器中。选择**Editor** ▸ **Embed In** ▸ **Navigation Controller**。

将表视图控制器嵌入导航控制器后，您的故事板应该像图 9-8 中显示的那样。导航控制器将在故事板中显示为一个屏幕。

![Image](img/Image00204.jpg)

*图 9-8: 导航控制器*

故事板中的每个视图控制器都代表一个用户将看到的应用屏幕，但导航控制器有些不同。尽管它看起来像是故事板中的一个独立屏幕，实际上导航控制器只是一个容器，容纳着用户在应用中切换的其他视图控制器。将一个视图控制器嵌入到导航控制器中意味着您的应用可以在不同的视图之间进行导航并返回。

您应该会看到导航控制器和表视图控制器顶部的灰色导航栏。当应用运行时，导航栏会告诉用户他们所在的屏幕标题，并可能包含按钮和箭头，用户可以使用这些按钮和箭头进入其他屏幕。为了使用导航栏告诉用户当前所处的屏幕，我们需要为我们的屏幕添加标题。现在是时候缩放回故事板了。双击故事板的空白区域进行缩放，然后滚动视图，直到可以看到表视图控制器。要为表视图控制器添加标题，请点击轮廓视图中**表视图控制器场景**下的**导航项**。

![Image](img/Image00205.jpg)

选中该项后，您可以在右侧的属性检查器中为屏幕输入一个标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。完成此步骤并按下 RETURN 后，轮廓视图中的表视图控制器场景条目会自动更新为 Birthdays Scene。

接下来，我们将制作一个添加按钮，以便您可以添加生日！

#### 添加一个按钮

我们希望用户能够打开应用，查看他们的生日列表，并向该列表添加生日。让我们制作一个按钮，让他们可以这样做！

我们需要在导航栏中添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。在对象库中找到“Bar Button Item”，然后将其拖动并放置到表视图控制器的导航栏右侧，如图 9-9 所示。

现在我们要把这个按钮转换为添加按钮。幸运的是，Xcode 内置了一个我们可以使用的添加按钮。在属性检查器中，将栏按钮项的系统项更改为**Add**。您应该会看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮点击时应该执行什么操作。我们希望它打开添加生日的视图控制器，所以我们需要将添加按钮与该视图控制器连接起来。首先，双击 storyboard 进行缩小，确保你能看到“生日”表格视图控制器和将来会成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，从 + 按钮拖动到 storyboard 右侧空白视图控制器的中间。当视图控制器被高亮显示时，松开鼠标。这时会弹出一个连接对话框，就像在 图 9-10 中显示的那样。

![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar Button Item 拖动到生日视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在弹出的对话框中选择 Present Modally。*

连接对话框提供了几种不同类型的 *segue* 选项——即从一个屏幕到另一个屏幕的过渡方式。点击连接对话框中的 **Present Modally** 选项。这会让视图控制器作为 *模态* 视图控制器出现在屏幕上。在 iPhone 上，模态视图控制器是从手机底部滑入的，并且不会自动带有返回按钮来返回上一个屏幕。相反，模态视图可以有其他按钮，例如取消或保存。还有其他类型的 segue，比如 Show segue，其中视图控制器是从屏幕右侧推出的，并且导航栏左侧会有返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，屏幕应该作为一个模态窗口显示，并带有一个取消按钮。否则，如果你使用类似“Show segue”并带有返回按钮的方式，就可能出现用户输入完所有内容后点击返回按钮却没有保存任何数据的情况！有了取消按钮，用户必须有意点击才能退出该屏幕。

要查看模态输入视图控制器的一个好例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮会弹出一个模态的“新建事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出该屏幕，右侧则有一个添加按钮，可以在关闭模态窗口之前创建新事件。你应该看到，新事件模态窗口从屏幕底部滑入，并且在关闭时会滑回到底部。我们希望用户能保存生日，因此我们也将使用模态窗口。

现在让我们尝试运行我们的应用程序，看看到目前为止我们做了些什么！要运行应用程序，首先选择一个设备模拟器，方法是点击 Xcode 左上角的 BirthdayTracker 旁边列出的设备（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：设置模拟器将在 Xcode 窗口左上角，紧挨着你的应用名称旁边运行的设备。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用程序。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键⌘ -**R**。

当模拟器打开并运行你的应用程序时，如果模拟器的大小太大，无法适应你的计算机屏幕，你可以调整它的大小。点击模拟器以选择它，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用程序时没有太多变化。你应该会看到你第一个生日屏幕，并有一个“+”按钮，如图 9-1 所示。显然，在这一点上，你的生日屏幕将是空的。点击“+”按钮将弹出第二个空屏幕。查看完你的应用程序后，通过点击 Xcode 中的停止按钮关闭它，停止按钮位于你之前按过的播放按钮旁边。当你停止应用程序时，你应该会看到你的应用图标出现在模拟器的主屏幕上！（参见图 9-12。）

就这样！现在我们需要配置第二个屏幕，使其能够用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到一个独立的导航控制器中。当一个视图控制器是模态视图时，它不会继承我们在故事板上已经设置的导航控制器中的导航栏。导航控制器提供了一个导航栏，所以我们需要将模态视图控制器嵌入到它自己的导航控制器中。点击故事板中的普通视图控制器以选择它。然后进入**编辑器** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该会看到一个导航项已被添加到视图控制器场景下的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与当你向表视图控制器中添加标题“生日”时所做的步骤相同。

现在，当“添加生日”视图控制器出现在应用程序中时，它将在顶部显示其标题。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友的生日时，应用程序中的每个条目都将包含一个名字、姓氏和生日。我们将为“添加生日”视图控制器添加一些*输入控件*，以便用户可以输入每个人的所有信息。输入控件是指如文本框或下拉菜单之类的控件，它们允许用户在应用程序中输入数据。我们将首先为所有可以添加的信息添加输入控件标签。

##### 添加和定位标签

为你的“添加生日”视图控制器创建一个显示“First Name”（名字）的标签。这个标签将位于一个文本框旁边，你可以在这里输入朋友的名字。在对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器中。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在我们想通过“尺寸检查器”设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*为单位来测量的。请注意，1 个点不等于 1 个像素。根据应用运行的设备类型，1 个点可能对应 1 个像素、一个 2×2 像素的正方形，或者一个 3×3 像素的正方形。这三种缩放因子分别被称为@1x、@2x 和@3x（这些是我们设置应用程序图标时讨论过的尺寸）。不同设备的点分辨率也不同，宽度可能从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示“First Name”*

只有最旧的 iPhone 和 iPod 型号使用@1x 缩放因子，而且你无法在这些型号上运行你的应用程序（BirthdayTracker 只支持 iOS 10 及以上版本）。除非你的设备是 iPhone 6 Plus、6s Plus 或 7 Plus（它们使用@3x 缩放因子），否则你的 iPhone 或 iPod 很可能使用@2x 缩放因子。

对象在屏幕上的位置也是基于点来计算的。对象的 x 位置是从屏幕左侧到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离（以点为单位）（参见图 9-15）。我们将为每个添加到视图控制器中的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕的边缘之外，同时仍留出足够的空间给其文本输入框以及其他标签和输入框。在尺寸检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，高度保持为 21。

完成后，重复这些步骤，在“添加生日”视图控制器中再添加两个标签：姓氏标签和生日标签。我们需要将其他标签和输入控件的位置调整好，以免它们重叠。在某些情况下，这可能会比较复杂，可能需要一些时间。对于这个应用，我们已经为你计算好了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何让你的应用适配其他设备。表 9-1 列出了每个标签应该设置的尺寸和位置。

表 9-1: 视图控制器中的输入标签设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，这样它们就能垂直对齐，但它们的 y 位置各不相同。每个标签的高度都是 21，所以 y 位置需要至少比下一个标签大 21 个点。由于我们要在每个标签下方添加输入控件，因此我们已将 y 位置调大，以容纳标签的高度和输入控件的高度。

很好！现在你的故事板应该像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16: 输入的标签已经添加到视图控制器中。*

接下来，你将添加两个*文本字段*，用于输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器上。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中的尺寸和位置调整这两个文本字段。你可以使用尺寸检查器，和调整标签时一样。

表 9-2: 视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后，你需要添加的是一个名为*日期选择器*的控件。这将让你轻松输入生日。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器一样（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17: 在日历应用中添加事件时，使用日期选择器进行日期选择。*

日期选择器还可以仅显示时间，比如时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这是我们在生日跟踪器中使用的方式。

在对象库中滚动，直到找到日期选择器，然后将其点击并拖到生日标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器显示当前日期。让我们将这个日期改成你的生日！将日期字段从“当前日期”更改为**自定义**。这样会出现一个新的框，修改日期为你的生日。

让我们通过运行应用来测试到目前为止的效果！我们为输入控件设置的大小在 iPhone 7 屏幕上显示得很好。所以，选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这次，当你点击生日视图控制器上的+按钮时，应该会显示添加生日的屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来不错，但其他设备呢？选择一个更小的模拟器，如 iPhone 5s，再次运行应用。你会发现，界面看起来有点不对劲。

所有你添加到故事板中的元素都出现了，但文本字段超出了屏幕边缘。现在你已经把所有元素放到屏幕上，接下来的步骤是让它们适配任何屏幕尺寸。我们将使用一个叫做*自动布局*的工具来完成这一点。

#### 通过自动布局让您的应用在每个设备上都完美呈现

单独的 iPhone 就有三种不同的屏幕尺寸，并且未来可能会出现更多尺寸。你需要设计你的应用，使其在任何设备上看起来都很好。这意味着，你希望你的应用能够根据运行设备的不同，自动调整屏幕上所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接着，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕故事板面板的底部有一条带有图标的带状工具栏，靠近实用工具面板之前的最右侧图标是一个在两条竖线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击该图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到许多布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局使得日期选择器的大小能够适应屏幕宽度，并且不会超出边界。自动布局还会确保每个文本字段的前后都有 20 个点的间距，以便它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，**添加生日**界面应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮现在不会执行任何操作，我们只是先设置它们。在第十章中，我们将添加代码，使它们能够取消“添加生日”界面并将生日保存到应用程序中。

要添加“保存”按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们之前做的添加按钮一样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其更改为取消按钮，就像你之前做的保存按钮一样。你的视图控制器应该与图 9-21 所示的相同。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新添加的按钮！

在“生日”表视图控制器中点击 + 按钮应该会将你带到“添加生日”视图控制器，你可以在这里输入一个人的名字和生日日期。点击取消和保存按钮目前不会执行任何操作——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你通过创建“生日”和“添加生日”界面的基本用户界面，开始制作一个“生日追踪器”应用程序。你还使用表视图控制器创建了“生日”界面，并让用户能够通过添加按钮和导航控制器在各个界面之间切换。

现在你已经完成了应用程序的基本框架，你将在第十章中编程实现取消和保存按钮，以便在应用程序中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **重置为缺失约束** 选项来添加缺失的约束。

请注意，在你添加表格视图控制器之后，大纲视图左侧会出现一个“表格视图控制器场景”条目，里面有一个表格视图控制器。你在故事板中的每个场景代表应用中的一个屏幕区域。对于 iPhone 应用，通常一次屏幕上只有一个场景，而且该场景会填满整个屏幕。iPad 应用则可以在同一屏幕上显示两个或更多的场景。

![Image](img/Image00202.jpg)

*图 9-6：将表格视图控制器添加到用于生日屏幕的故事板中*

下一步是将这个新视图控制器设置为应用运行时首先显示的屏幕，因为我们希望在用户打开应用时显示生日列表。执行此操作的步骤请参考 图 9-7 。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图中选择 **表格视图控制器** ➊ 。然后在工具区中打开属性检查器 ➋ 。在这里，勾选 **是初始视图控制器** ➌ 。完成此操作后，你的表格视图控制器左侧应该会出现一个箭头。这个箭头表示当应用首次启动时，会显示此视图控制器。

#### 添加导航控制器

现在，我们将为视图控制器添加一个标题，显示“生日”，并且添加一个“添加”按钮，点击后会显示添加生日视图控制器。为此，首先将表格视图控制器放入一个 *导航控制器* 中。导航控制器管理一个或多个视图控制器，并且自带一个 *导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，同时右侧和左侧的按钮用于导航到应用中的其他屏幕。你在许多 iOS 应用中都会看到这个导航栏，例如设置应用和消息应用。

在大纲视图中选择 **表格视图控制器**。选择后，你需要通过 Xcode 菜单将表格视图控制器嵌入到一个导航控制器中。请前往 **编辑** ▸ **嵌入** ▸ **导航控制器**。

当表格视图控制器被嵌入到导航控制器中后，你的故事板应该会像 图 9-8 中的那样。导航控制器将在故事板中显示为一个屏幕。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

在故事板中，每个视图控制器代表应用程序中的一个屏幕，用户将在该屏幕上看到内容，但导航控制器则有所不同。尽管它在故事板中看起来像是一个单独的屏幕，实际上导航控制器只是一个容器，用来容纳用户在应用程序中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用程序可以在不同的视图之间进行导航，并可以返回。

你应该会看到导航控制器和表视图控制器的顶部有灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能还会包含按钮和箭头，用户可以用来跳转到其他屏幕。为了使用导航栏告诉用户他们所在的屏幕，我们需要为屏幕添加标题。现在是重新聚焦到故事板的好时机。双击故事板中的空白区域进行放大，然后滚动视图，直到你可以看到表视图控制器。要为表视图控制器添加标题，点击左侧大纲视图中**表视图控制器场景**下的**导航项**。

![Image](img/Image00205.jpg)

选中后，你可以在右侧的属性检查器中输入屏幕的标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。你应该会看到，当你完成此步骤并按下 RETURN 键后，大纲视图中的表视图控制器场景条目会自动更新为 Birthdays 场景。

接下来，我们将创建一个“添加”按钮，供你添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并将生日添加到列表中。让我们制作一个按钮来实现这一功能！

我们需要在导航栏中添加一个按钮，点击后会跳转到“添加生日”场景，让用户输入生日。在对象库中找到“Bar Button Item”，然后将其拖放到表视图控制器的导航栏右侧，如图 9-9 所示。

现在我们想将这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内建的添加按钮可供使用。在属性检查器中，将“系统项目”字段的值更改为**Add**。你应该会看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮点击时应该做什么。我们希望它打开“添加生日”视图控制器，因此需要将“添加”按钮连接到该视图控制器。首先，双击故事板缩小视图，确保可以看到“生日”表格视图控制器和最终会变成“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，拖动从+按钮到故事板右侧空白视图控制器的中间。释放鼠标时，视图控制器会被高亮显示。此时会弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar Button Item 拖到 Birthdays 视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到邻近的视图控制器，并在出现的对话框中选择“Present Modally”。*

连接对话框为你提供了几种选择，用于决定在两个视图控制器之间进行什么样的*segue*——从一个屏幕到下一个屏幕的过渡。点击连接对话框中的**Present Modally**选项。这将使视图控制器以*模态*视图控制器的方式显示在屏幕上。在 iPhone 上，模态视图控制器会从屏幕底部滑动进来，并且不会自动带有返回按钮返回到上一个屏幕。相反，模态视图可以有其他按钮，如取消或保存。还有其他类型的 segue，比如 Show segue，视图控制器会从右侧滑动到屏幕上，并且导航栏的左侧会有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的界面时，该界面应作为模态窗口显示，并包含一个取消按钮。否则，如果使用类似“Show segue”的方式并且有一个返回按钮，就可能出现用户输入完所有内容后点击返回按钮却没有保存任何东西的情况！有了取消按钮，用户必须刻意点击才能退出该界面。

若想查看一个好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个+按钮，你可以点击它来添加一个日历事件。点击+按钮会弹出一个模态的“新建事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以不保存退出，右侧有一个添加按钮，可以在关闭模态窗口之前创建新事件。你应该能看到“新建事件”模态视图从屏幕底部滑入，关闭时又滑回屏幕底部。我们希望用户能够保存生日，因此我们也将使用模态视图。

现在让我们试着运行应用，看看到目前为止我们做了些什么！要运行应用，首先点击 Xcode 左上角列出的设备模拟器，选择一个设备（见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上方，应用名称旁边设置了模拟器运行的设备。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表来运行你的应用。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或使用键盘快捷键⌘ -**R**。

当模拟器打开以运行你的应用时，如果应用的大小超出了电脑屏幕，你可以调整它的大小。点击模拟器进行选择，然后前往**窗口** ▸ **缩放**，在模拟器菜单中选择一个更小的缩放比例。

到目前为止，运行应用时并没有太多发生。你应该会看到你的第一个“生日”屏幕，带有一个+按钮，正如图 9-1 中所示。显然，这时你的“生日”屏幕将是空的。点击+按钮将会弹出第二个空白屏幕。查看完应用后，点击 Xcode 中的停止按钮（它就在你之前按下的播放按钮旁边）来关闭它。当你停止应用时，你现在应该能在模拟器的主屏幕上看到你的应用图标！（见图 9-12。）

就这样！现在我们需要配置第二个屏幕，使其可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：生日追踪器应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，首先添加其标题。为此，你需要将其嵌入到一个属于它的导航控制器中。当一个视图控制器是模态时，它不会继承我们在故事板上已经存在的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过在故事板中点击它来选择这个普通视图控制器。然后前往**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在你应该看到一个导航项已被添加到视图控制器场景下的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与当初将标题“生日”添加到你的表格视图控制器时相同。

现在，当“添加生日”视图控制器出现在应用中时，顶部将显示它的标题标签。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每个条目将包含一个名字、一个姓氏和一个出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入所有这些信息。输入控件是像文本字段或下拉菜单这样的控件，允许用户向你的应用程序中输入数据。我们将通过添加所有可以让用户添加信息的输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“名字”的标签。这个标签将位于一个文本字段旁边，你将在其中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在我们要使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以*点*为单位进行测量。请注意，1 点不等于 1 像素。根据你的应用程序运行的设备类型，1 点将转化为 1 像素、一个 2×2 像素的方块或一个 3×3 像素的方块。这三种缩放因子分别被称为@1x、@2x 和@3x（与我们设置应用图标时讨论的尺寸相同）。设备的点分辨率也不完全相同，宽度范围从 320 点到 1,024 点，长度范围从 568 点到 1,366 点。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示“名字”*

只有最旧型号的 iPhone 和 iPod 使用@1x 缩放因子，而这些型号无法运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则很可能使用@2x 缩放因子，它们使用的是@3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的距离。（见图 9-15）。我们将设置每个添加到视图控制器中的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置为离屏幕边缘有一定距离，同时仍留出足够的空间给文本输入字段以及其他标签和输入框。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成这一步后，重复这些步骤，在添加生日的视图控制器中再添加两个标签：一个姓氏标签和一个出生日期标签。我们需要定位其他标签和输入控件，以避免它们重叠。在某些情况下，这可能会变得复杂并且需要一些时间。对于这款应用，我们已为你计算了放置对象的位置，适用于 iPhone 7 屏幕。稍后我们将解释如何使你的应用适配其他设备。表 9-1 列出了每个标签的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，所以它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置至少需要比下一个最近的标签大 21 个点。由于我们还要在每个标签下方添加输入控件，因此我们将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

很好！现在你的故事板应该看起来像图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16：已将输入标签添加到视图控制器中。*

接下来，你将添加两个*文本字段*，用于输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在该字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。按照表 9-2 中的尺寸和位置设置这两个文本字段。你可以使用尺寸检查器，就像之前为标签设置的那样。

表 9-2：视图控制器中输入的文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个称为*日期选择器*的轮子。它将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用程序中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像日历应用程序中使用的日期选择器一样（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器来选择日期。*

日期选择器还可以仅显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这也是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到生日标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器设置为显示当前日期。让我们将这个日期改为你的出生日期！将日期字段从当前日期更改为**自定义**。这样，一个新的框会出现。将日期改为你的出生日期。

让我们通过运行应用来测试目前为止的效果！我们为输入控件设置的大小在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你在生日视图控制器上点击+按钮时，应该会显示添加生日的页面，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个更小的模拟器来运行应用，比如 iPhone 5s，再次运行应用。你会发现效果看起来有些不对劲。

所有你添加到故事板中的元素都出现了，但文本框超出了屏幕的边缘。现在你已经将所有元素放置在屏幕上，下一步是让它们在任何屏幕尺寸下都能正确适配。我们将通过一个叫做*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上看起来完美无缺，通过自动布局

iPhone 本身就有三种不同的屏幕尺寸，而且未来可能会推出更多尺寸。你需要设计应用，使其在任何设备上看起来都不错。这意味着你需要让你的应用调整所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的方式来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的提纲视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标调出自动布局菜单。*

在屏幕故事板窗格的底部有一个带有图标的带状工具栏，最右侧的图标是一个三角形，位于两条竖线之间。将鼠标光标悬停在该图标上时，应该会显示一个标签，写着“解决自动布局问题”。点击该图标以弹出建议菜单。点击**添加缺失约束**。^(*) 这样做后，你会看到很多布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小合适，可以适应屏幕。例如，自动布局使日期选择器的宽度适应屏幕，不会超出边界。自动布局还确保每个文本字段前后都有 20 个点的间隔，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”页面应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这部分内容，我们将展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。这些按钮暂时不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使得它们能够取消“添加生日”页面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮更改为保存按钮，就像之前我们设置添加按钮时那样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“条形按钮项”，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，和之前设置保存按钮时一样。你的视图控制器应该看起来像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新添加的按钮！

点击“生日”表格视图控制器上的 + 按钮应该会带你进入“添加生日”视图控制器，你可以在这里输入一个人的姓名和生日。点击取消和保存按钮目前不会有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在这一章中，你通过创建“生日”和“添加生日”页面的基本用户界面开始制作 BirthdayTracker 应用。你还使用表格视图控制器创建了“生日”页面，并使得用户可以通过点击添加按钮和使用导航控制器在页面间切换。

现在，你已经完成了应用的基本框架，在第十章中，你将编写代码实现取消和保存按钮的功能，这样你就可以在应用中添加并保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项可能被禁用。这是一个苹果的 bug。如果遇到这种情况，选择 **Reset to Missing Constraints** 选项来添加缺失的约束。![Image](img/Image00202.jpg)

*图 9-6：为生日屏幕添加表格视图控制器到故事板中*

下一步是将这个新视图控制器设置为当你运行应用时首先出现的屏幕，因为我们希望在用户打开应用时显示生日列表。执行此操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后在工具面板中调出属性检查器 ➋。在这里，勾选**Is Initial View Controller** ➌。完成后，表格视图控制器左侧应该会出现一个箭头。这个箭头意味着应用在启动时会显示这个视图控制器。

#### 添加导航控制器

接下来，我们将给视图控制器添加一个标题“生日”以及一个“添加”按钮，点击后会打开“添加生日”视图控制器。为了做到这一点，我们首先将表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器，并且自带一个*导航栏*，导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且在左右两侧有按钮，可以导航到应用中的其他屏幕。在多个 iOS 应用中，你都能看到这个导航栏，例如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。选中后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。进入 **Editor** ▸ **Embed In** ▸ **Navigation Controller**。

当表格视图控制器嵌入到导航控制器中后，你的故事板应该像图 9-8 中所示。导航控制器会作为一个屏幕出现在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

在故事板中，每个视图控制器代表用户在应用中看到的一个屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像是一个独立的屏幕，实际上，导航控制器只是一个容器，里面包含了用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以从一个视图导航到另一个视图，并且可以返回。

你应该会看到导航控制器和表视图控制器顶部的灰色导航栏。当应用程序运行时，导航栏会告诉用户他们所在屏幕的标题，还可能包含可以用来跳转到其他屏幕的按钮和箭头。为了使用导航栏告诉用户他们所在的屏幕，我们需要为屏幕添加标题。现在是重新聚焦到故事板的好时机。双击故事板的空白区域以放大视图，然后滚动视图直到你能看到表视图控制器。要为表视图控制器添加标题，请点击大纲视图左侧的**Navigation Item**，它位于**Table View Controller Scene**下。

![图片](img/Image00205.jpg)

选中该项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。完成此步骤并按下 RETURN 键后，你应该会看到大纲视图中的 Table View Controller Scene 条目自动更新为 Birthdays Scene。

接下来，我们将创建一个“添加”按钮，这样你就可以添加生日了！

#### 添加一个按钮

我们希望用户能够打开应用，查看他们的生日列表，并能向列表中添加生日。让我们做一个按钮来实现这个功能！

我们需要在导航栏上添加一个按钮，用于进入添加生日的场景，让用户能够输入生日。找到对象库中的 Bar Button Item，并将其拖动到表视图控制器导航栏的右侧，如图 9-9 所示。

现在我们想将这个按钮变成一个“添加”按钮。幸运的是，Xcode 有一个内置的“添加”按钮可以使用。在属性检查器中，将 Bar Button Item 的 System Item 改为**Add**。你应该会看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在点击时执行什么操作。我们希望它能打开添加生日的视图控制器，所以我们需要将“添加”按钮连接到那个视图控制器。首先，双击故事板以缩小视图，确保你能同时看到“Birthdays”表视图控制器和将最终成为“添加生日”视图控制器的空视图控制器。按住 CONTROL 键，从+按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标，这将弹出一个连接对话框，如图 9-10 所示。

![图片](img/Image00206.jpg)

*图 9-9：将一个 Bar Button Item 拖到 Birthdays 视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在出现的对话框中选择“模态呈现”。*

连接对话框为你提供了几种选项，用于选择你想在两个视图控制器之间实现的*过渡*——从一个屏幕到下一个屏幕的转换。点击连接对话框中的**模态展示**选项。这将使视图控制器以*模态*视图控制器的形式展示在屏幕上。在 iPhone 上，模态视图控制器从手机底部进入屏幕，并且默认没有返回按钮来返回到上一个屏幕。相反，模态视图可以有其他按钮，如取消或保存。还有其他类型的过渡，比如展示（Show）过渡，其中视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，这个屏幕应该作为模态屏幕展示，并且有一个取消按钮。否则，如果你使用像展示（Show）过渡这种带有返回按钮的方式，可能会出现用户输入了所有内容后却点击返回按钮而没有保存任何东西的情况！有了取消按钮，用户必须刻意点击才能取消退出屏幕。

要查看一个好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。打开后，你会看到导航栏右侧有一个 + 按钮，可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，用来在不保存的情况下退出屏幕，右侧有一个添加按钮，用来在关闭模态视图之前创建新事件。你应该能看到，新事件模态视图从屏幕底部进入，并且在被关闭时会回到屏幕底部。我们希望用户保存生日，因此我们也会使用模态视图。

现在，让我们尝试运行应用，看看到目前为止我们做了些什么！要运行应用，首先选择一个设备模拟器，方法是点击 Xcode 左上角列出在“BirthdayTracker”旁边的设备（见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，应用名称旁边设置模拟器运行的设备。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。在选择好模拟器后，点击左上角的播放按钮或使用键盘快捷键 ⌘ -**R**。

当模拟器打开以运行你的应用时，如果它的尺寸太大无法适应你的电脑屏幕，你可以调整其大小。点击模拟器以选中它，然后前往**窗口** ▸ **缩放**，在模拟器菜单中选择一个更小的缩放比例。

到目前为止，当你运行应用程序时并不会发生太多事情。你应该能看到之前提到的带有 + 按钮的“生日”屏幕，如图 9-1 所示。显然，此时“生日”屏幕将是空的。点击 + 按钮将显示第二个空白屏幕。查看完应用后，通过点击 Xcode 中的停止按钮来关闭它，停止按钮位于你之前点击的播放按钮旁边。当你停止应用后，你应该能在模拟器的主屏幕上看到你的应用图标！（参见图 9-12。）

就这样！接下来，我们需要配置第二个屏幕，使其可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控件输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到一个独立的导航控制器中。当一个视图控制器是模态的时，它不会继承我们在故事板中已经设置的导航控制器的导航栏。导航控制器提供导航栏，所以我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器来选择它，然后前往**编辑** ▸ **嵌入于** ▸ **导航控制器**。现在你应该看到一个导航项已被添加到视图控制器场景的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与当你为表视图控制器添加标题“生日”时是一样的。

现在，当“添加生日”视图控制器出现在应用程序中时，它将在顶部显示其标题。

#### 添加好友的姓名和生日

当你在第十章中输入朋友的生日时，应用程序中的每一项将包括名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户能够为每个人输入这些信息。输入控件是指像文本框或下拉菜单这样的元素，允许用户在应用程序中输入数据。我们将从为用户可以添加的所有信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“名字”的标签。这个标签将放置在一个文本框旁边，用户可以在这里输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框，并输入**名字**作为显示文本，如图 9-14 所示。

现在我们想通过“大小检查器”设置标签的大小和位置。在 Xcode 的 storyboard 中，宽度和高度是以 *点* 为单位的。请注意，1 点不等于 1 像素。根据你的应用运行的设备类型，1 点将转换为 1 像素、2×2 像素的方形区域，或 3×3 像素的方形区域。这三种缩放因子分别称为 @1x、@2x 和 @3x（这些也是我们设置应用图标时提到的大小）。不同设备的点分辨率也不同，可能在 320 到 1,024 点宽，568 到 1,366 点高之间变化。

![Image](img/Image00211.jpg)

*图 9-14：让标签显示* 姓名

只有最旧的 iPhone 和 iPod 型号使用 @1x 的缩放因子，你将无法在这些型号上运行你的应用程序（BirthdayTracker 只支持 iOS 10 及以上版本）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus 否则你的手机或 iPod 使用的是 @2x 缩放因子，它们使用的是 @3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点距离。y 位置是从屏幕顶部到对象顶部的距离。（见 图 9-15）。我们将设置每个库对象在视图控制器中的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置为不在屏幕边缘，但仍然为其文本输入框和其他标签及输入框留出足够的空间。在“大小检查器”的“视图”部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成这一步后，重复这些步骤，向“添加生日”视图控制器中添加另外两个标签：姓氏标签和出生日期标签。我们还需要设置其他标签和输入框的位置，以避免它们重叠。在某些情况下，这可能会变得棘手，并且可能需要一些时间。对于这个应用，我们已经为你计算好了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何让你的应用在其他设备上运行。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | x 位置 | y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 坐标相同，因此它们会垂直对齐，但每个标签的 y 坐标不同。每个标签的高度为 21，所以 y 坐标必须比下一个最近的标签大至少 21 个点。由于我们还需要在每个标签下方添加输入控件，所以我们将 y 坐标设置得更大，以便容纳标签的高度和输入控件的高度。

太好了！现在你的故事板应该像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们将让你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在该字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器上。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段的尺寸和位置设置为表 9-2 中显示的内容。你可以使用尺寸检查器，正如你为标签所做的那样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | x 坐标 | y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加一个叫做*日期选择器*的控件。它将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，允许用户选择日期或时间。它可以同时包含日期和时间，就像日历应用中的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以只显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这也是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到视图控制器中“出生日期”标签下方。使用尺寸检查器，将 x 坐标设置为 0，y 坐标设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的出生日期！将日期字段从当前日期改为**自定义**。这样做后，一个新的框将会出现。将日期更改为你的出生日期。

让我们通过运行应用来测试一下到目前为止的效果！我们为输入控件设置的尺寸适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你在生日视图控制器上点击 + 按钮时，添加生日的界面应该会显示出来，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美地适配了 iPhone 7 屏幕。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很不错，但其他设备怎么样呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，然后再次运行应用。你会看到，界面看起来并不完全正确。

你添加到故事板的所有元素都已经显示出来，但文本字段超出了屏幕的边缘。现在你已经将所有元素都放在屏幕上，接下来的步骤是使它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来完成这个工作。

#### 让你的应用在每个设备上都完美显示：自动布局

iPhone 单独就有三种不同的屏幕尺寸，而且未来可能还会有更多尺寸。你需要设计你的应用，使其在任何设备上都能良好显示。这意味着你需要让应用根据运行应用的设备调整屏幕上所有元素的位置和大小。自动布局使用一种叫做*布局约束*的技术来摆放元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标，调出自动布局菜单。*

在屏幕故事板面板的底部，有一条带有图标的带状区域，靠近实用工具面板的最右侧是一个位于两条竖线之间的三角形图标。将鼠标光标悬停在这个图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击这个图标以调出建议菜单。点击**添加缺失的约束**。^(*)这样做后，你会看到一大堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局使得日期选择器的大小适应屏幕宽度，并且不会超出边缘。自动布局还会确保每个文本字段前后都有 20 个点的间距，从而使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，“添加生日”屏幕应该完美无缺。

#### 添加保存和取消按钮

为了完成设置，我们将向你展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。按钮暂时不会执行任何操作，我们只是做一个设置。在第十章中，我们将添加一些代码，使它们能够取消返回并保存生日信息。

要添加“保存”按钮，从对象库中拖动一个 Bar Button Item，并将其放置在导航栏的*右*侧。我们将把这个按钮改成一个“保存”按钮，和我们之前做的“添加”按钮一样。选择该按钮项，然后使用属性检查器将其转换为“保存”按钮。

最后，让我们添加“取消”按钮。从对象库中拖动另一个 Bar Button Item，这次将它放置在导航栏的*左*侧。使用属性检查器将其转换为“取消”按钮，就像你之前做的“保存”按钮一样。你的视图控制器应该像图 9-21 所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新增的按钮！

点击“生日”表视图控制器上的+按钮，应该会带你进入“添加生日”视图控制器，你可以在其中输入一个人的姓名和生日。点击“取消”和“保存”按钮暂时不会执行任何操作——我们将在第十章中实现这两个按钮！

### 你学到的内容

在本章中，你开始通过创建“生日”和“添加生日”屏幕的基本用户界面来制作一个 BirthdayTracker 应用程序。你还通过使用表视图控制器创建了“生日”屏幕，并设置了用户可以通过“添加”按钮和导航控制器在屏幕之间切换。

现在，你已经完成了应用程序的基本框架，接下来将在第十章中编程实现“取消”和“保存”按钮，这样你就可以在应用中添加和保存生日信息了！

* 在某些版本的 Xcode 中，“添加缺失的约束”选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择“重置为缺失的约束”选项来添加缺失的约束。

*图 9-6：为生日屏幕将表视图控制器添加到故事板*

下一步是将这个新的视图控制器设置为当你运行应用时首先显示的屏幕，因为我们希望在用户打开应用时显示生日列表。完成此操作的步骤如图 9-7 所示。

![Image](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊。然后在工具面板中调出属性检查器 ➋。在这里，勾选**是初始视图控制器** ➌。完成后，表格视图控制器左侧应该会出现一个箭头。这个箭头表示应用在启动时会显示该视图控制器。

#### 添加导航控制器

现在我们将给视图控制器添加一个标题，显示“生日”，并添加一个“添加”按钮，点击后将弹出“添加生日”视图控制器。为此，我们首先将表格视图控制器放入*导航控制器* 中。导航控制器管理一个或多个视图控制器，并配有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并带有位于左右两侧的按钮，用于在应用中导航到其他屏幕。在许多 iOS 应用中，比如设置和信息应用中，你都能看到这个导航栏。

在大纲视图中选择**表格视图控制器**。选中它后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。前往**编辑器** ▸ **嵌入** ▸ **导航控制器**。

当表格视图控制器被嵌入到导航控制器中后，你的故事板应该像图 9-8 中的那样。导航控制器将在故事板中显示为一个屏幕。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表用户在应用中看到的一个屏幕，但导航控制器有些不同。尽管它在故事板中看起来像一个单独的屏幕，导航控制器实际上只是一个容器，用来存放用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中，意味着你的应用可以在一个视图与另一个视图之间进行导航。

您应该看到导航控制器和表视图控制器的顶部有灰色导航栏。当应用程序运行时，导航栏会告诉用户他们所在屏幕的标题，并可能包含用户可以用来访问其他屏幕的按钮和箭头。为了通过导航栏告诉用户他们所处的屏幕，我们需要为屏幕命名。现在是时候再次缩小故事板视图。双击故事板空白区域以放大视图，然后滚动视图，直到您可以看到表视图控制器。要为表视图控制器添加标题，请在左侧的大纲视图中点击**表视图控制器场景**下的**导航项**。

![Image](img/Image00205.jpg)

选中此项后，您可以在右侧的“属性检查器”中输入屏幕标题。我们希望导航栏显示“生日”作为标题，因此在右侧的“标题”字段中输入**生日**。完成此步骤并按 RETURN 后，您会看到大纲视图中的“表视图控制器场景”条目自动更新为“生日场景”。

接下来，我们将创建一个添加按钮，供您添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并在列表中添加一个生日。让我们制作一个可以让他们这样做的按钮！

我们需要在导航栏中添加一个按钮，指向“添加生日”页面，用户可以在此输入生日。找到对象库中的“Bar Button Item”，然后将其拖放到表视图控制器导航栏的右侧，如图 9-9 所示。

现在我们想将这个按钮变成一个添加按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮可以使用。在“属性检查器”中，将栏按钮项的“系统项”更改为**添加**，您应该会看到按钮变成一个加号 (+)。

接下来，我们需要告诉按钮点击时该做什么。我们希望它打开“添加生日”视图控制器，因此我们需要将添加按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保可以同时看到“生日”表视图控制器和将来成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，从+按钮拖动到故事板右侧的空视图控制器中间。当视图控制器高亮时松开鼠标，这将弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将“Bar Button Item”拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态展示”。*

连接对话框为你提供了几种*segue*（从一个屏幕到另一个屏幕的过渡）类型选项。点击连接对话框中的**模态展示**选项。这将使视图控制器作为*模态*视图控制器出现在屏幕上。在 iPhone 上，模态视图控制器从手机底部滑动上来，并且不会自动附带返回按钮返回到上一屏幕。相反，模态视图可以有其他按钮，比如取消或保存。还有其他类型的 segue，比如 Show segue，它将视图控制器从右侧推到屏幕上，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，应该将其显示为一个带有取消按钮的模态屏幕。否则，如果你使用像 Show segue 这种带有返回按钮的方式，用户可能会输入所有内容后点击返回按钮，但没有保存任何东西！使用取消按钮，用户必须有意点击才能取消该屏幕。

要查看一个模态输入视图控制器的好例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧会有一个+按钮，你可以点击它来添加日历事件。点击+按钮会弹出一个模态的“新建事件”视图控制器。这个视图控制器的左侧有一个取消按钮，可以在不保存的情况下退出，右侧有一个添加按钮，在创建新事件后再关闭模态视图。你应该能看到“新建事件”模态视图从屏幕底部滑上来，然后在关闭时滑回去。我们希望用户保存生日，因此我们也会使用模态视图。

现在让我们尝试运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先通过点击 Xcode 左上角 BirthdayTracker 旁边列出的设备，选择一个设备模拟器（见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角的应用名称旁边设置模拟器将运行的设备。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。在选择了模拟器后，点击左上角的播放按钮，或者使用键盘快捷键⌘ -**R**。

当模拟器打开并运行你的应用时，如果模拟器的大小太大无法适应你的电脑屏幕，你可以调整其大小。点击模拟器选择它，然后前往**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的比例。

到目前为止，当你运行应用时，似乎没有太多变化。你应该能看到第一个“生日”屏幕，并且会看到一个+按钮，如图 9-1 所示。显然，这时你的“生日”屏幕是空的。点击+按钮会弹出第二个空白屏幕。一旦你完成查看应用，点击 Xcode 中的停止按钮来关闭应用，这个按钮就在你之前点击的播放按钮旁边。当你停止应用时，你应该能在模拟器的主屏幕上看到你的应用图标！（见图 9-12）

就这样！现在我们需要配置那个第二个屏幕，以便可以用来添加生日！

![图片](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，你需要将其嵌入到一个独立的导航控制器中。当一个视图控制器是模态时，它不会继承我们在故事板中已有的导航控制器中的导航栏。导航控制器提供导航栏，所以我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器，选择这个普通视图控制器。然后，转到**编辑** ▸ **嵌入在** ▸ **导航控制器**。现在，你应该能看到一个导航项已被添加到“视图控制器场景”的大纲视图下。点击这个新的导航项，然后在“属性检查器”中添加标题**添加生日**。这些步骤和你在为表视图控制器添加“生日”标题时所做的步骤相同。

现在，当“添加生日”视图控制器出现在应用中时，顶部会显示其标题。

#### 添加你朋友的姓名和生日

当你在第十章中输入你朋友的生日时，应用中的每个条目将包含一个名字、一个姓氏和一个出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入所有这些信息。输入控件是用户可以在应用中输入数据的控件，例如文本框或下拉菜单。我们将通过添加所有可以供用户添加的信息的输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“名字”的标签。这个标签将位于一个文本框旁边，用户可以在其中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在“属性检查器”中，点击标签文本框，输入**名字**作为显示文本，如图 9-14 所示。

现在，我们想使用尺寸检查器来设置标签的大小和位置。在 Xcode storyboard 中，宽度和高度是以*点*为单位进行测量的。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点将转化为 1 像素、2×2 像素的正方形，或者 3×3 像素的正方形。这三种缩放因子分别被称为 @1x、@2x 和 @3x（这就是我们在设置应用图标时谈到的相同大小）。设备的点分辨率也不相同，宽度从 320 到 1,024 点不等，高度从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* 名字

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，你将无法在这些型号上运行你的应用（BirthdayTracker 只支持 iOS 10 及以上版本）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，否则你的手机或 iPod 很可能使用 @2x 缩放因子，后者使用 @3x 缩放因子。

对象在屏幕上的位置也是基于点来计算的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的距离。（见图 9-15）。我们将设置每个添加到视图控制器中的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置为不在屏幕的边缘，但仍然留有足够的空间来容纳文本输入框以及其他标签和输入框。在尺寸检查器的“视图”部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成后，重复这些步骤，将两个标签添加到添加生日的视图控制器中：一个是姓氏标签，一个是出生日期标签。我们需要将其他标签和输入框的位置设置好，以确保它们不重叠。在某些情况下，这可能会有些棘手，并且可能需要一些时间。对于这个应用程序，我们已经为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何使你的应用在其他设备上正常工作。表 9-1 列出了每个标签应该设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有的标签都有相同的 x 位置，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度是 21，所以 y 位置需要比下一个标签至少大 21 个点。由于我们也在每个标签下方添加了输入控件，因此我们将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

太棒了！现在你的故事板应该像图 9-16 中的那样了。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已被添加到视图控制器中。*

接下来，你将添加两个*文本框*，这将允许你输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们就可以在文本框中输入一行文字。

##### 添加文本框

从对象库中拖动两个文本框对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中的尺寸和位置设置这两个文本框。你可以使用尺寸检查器，像设置标签时一样进行调整。

表 9-2：视图控制器中输入的文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个名为*日期选择器*的控件。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的工具，用于让用户选择日期或时间。它可以同时包含日期和时间，就像日历应用中的日期选择器一样（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以只显示时间，就像在时钟应用中用于设置闹钟的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动直到找到日期选择器，然后点击并拖动它到视图控制器的 Birthdate 标签下方。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整一些日期选择器的属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们把这个日期改为你的出生日期！将日期字段从“当前日期”改为**自定义**。这样做时，会出现一个新框，修改该框中的日期为你的出生日期。

让我们通过运行应用来测试目前为止的效果！我们为输入控件设置的尺寸适合 iPhone 7 屏幕。因此，选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你点击“生日”视图控制器上的+按钮时，“添加生日”屏幕应该会显示出来，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器，比如 iPhone 5s，再次运行应用。你会看到，界面看起来不太对劲。

所有你添加到故事板中的元素都已显示，但文本框超出了屏幕边缘。现在你已经将所有元素放到屏幕上，下一步是确保它们在任何屏幕尺寸上都能正确适配。我们将使用一个名为*自动布局*的工具来做到这一点。

#### 让你的应用在每个设备上都能完美显示，使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会有更多尺寸的设备出现。你需要设计应用，使其在任何设备上都能呈现良好效果。这意味着你需要让应用根据运行它的设备调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的工具来在屏幕上放置元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接着，查看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标以调出自动布局菜单。*

在屏幕的故事板窗格底部，有一个带图标的带状工具栏，位于“实用工具”窗格之前的最右侧图标是一个三角形，位于两条垂直线之间。将鼠标光标悬停在该图标上，它应显示一个标签，写着“解决自动布局问题”。点击此图标以调出建议菜单。点击**添加缺失约束**。^(*) 当你这样做时，你会看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局使得日期选择器的大小适应屏幕的宽度，不会超出屏幕边缘。自动布局还会确保每个文本字段前后有 20 个点的间距，从而使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用。这次，添加生日的屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这些步骤，我们将展示如何为添加生日视图控制器的导航栏创建取消和保存按钮。现在这些按钮还没有功能，我们只是进行设置。在第十章中，我们将添加代码，使这些按钮能够退出添加生日屏幕并将生日保存到应用中。

为了添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们为添加按钮所做的那样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该像图 9-21 所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新按钮的效果！

在生日表视图控制器上点击+按钮应该会将你带到添加生日视图控制器，在这里你可以输入一个人的姓名和生日日期。点击取消和保存按钮目前不会执行任何操作——我们将在第十章中实现它们的功能！

### 你学到了什么

在本章中，你通过为生日和添加生日屏幕创建基本的用户界面，开始制作一个 BirthdayTracker 应用。你还使用表视图控制器创建了生日屏幕，并使得用户能够通过添加按钮和导航控制器在屏幕之间切换。

现在，你已经完成了应用的基本骨架，在第十章中你将编写代码实现取消和保存按钮的功能，以便你能够在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项是禁用的。这是 Apple 的一个 BUG。在这种情况下，选择**重置为缺失约束**选项，以添加缺失的约束。

下一步是将这个新的视图控制器设为应用启动时显示的第一个屏幕，因为我们希望用户打开应用时能看到生日列表。完成此操作的步骤如图 9-7 所示。

![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设为初始视图控制器。*

首先，在大纲视图 ➊ 中选择**表格视图控制器**。然后，在你的工具面板中打开属性检查器 ➋ 。在那里，勾选**是初始视图控制器** ➌ 。完成此操作后，在故事板中，表格视图控制器的左侧应该会出现一个箭头。这个箭头表示当应用程序首次启动时，将显示这个视图控制器。

#### 添加导航控制器

现在，我们将为视图控制器添加一个标题，标题为“生日”，并添加一个“添加”按钮，用于弹出“添加生日”视图控制器。为此，我们首先将表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题，以及在屏幕左侧和右侧的按钮，用于导航到应用中的其他屏幕。在多个 iOS 应用中，你可以看到这个导航栏，比如在设置和消息应用中。

在大纲视图中选择**表格视图控制器**。选择之后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。转到**编辑器** ▸ **嵌入到** ▸ **导航控制器**。

在将表格视图控制器嵌入导航控制器后，你的故事板应该类似于图 9-8 中的样子。导航控制器将作为一个屏幕出现在故事板中。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表用户将看到的应用屏幕，但导航控制器则有所不同。尽管它在故事板中看起来像一个独立的屏幕，导航控制器实际上只是一个容器，用来容纳用户在应用中切换的其他视图控制器。将视图控制器嵌入导航控制器中意味着你的应用可以在不同的视图之间进行导航，并能返回到原来的视图。

你应该会看到导航控制器和表格视图控制器顶部出现灰色导航栏。当应用运行时，导航栏会告诉用户当前所在屏幕的标题，可能还包含按钮和箭头，用户可以用它们导航到其他屏幕。为了使用导航栏来告知用户当前所在的屏幕，我们需要为我们的屏幕添加标题。现在是重新缩放故事板的好时机。双击故事板的空白区域进行缩放，然后滚动视图，直到你能看到表格视图控制器。要为表格视图控制器添加标题，点击左侧大纲视图中**表格视图控制器场景**下的**导航项**。

![图片](img/Image00205.jpg)

选中此项后，你可以在右侧的属性检查器中为屏幕输入一个标题。我们希望导航栏显示“Birthdays”作为标题，所以在右侧的标题字段中输入**Birthdays**。完成此步骤并按下 RETURN 后，你会看到大纲视图中的 Table View Controller 场景项自动更新为 Birthdays Scene。

接下来，我们将创建一个添加按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并向列表中添加一个生日。让我们创建一个按钮，让他们能够这样做！

我们需要在导航栏中添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。找到对象库中的 Bar Button Item，然后将其拖放到表格视图控制器导航栏的右侧，如图 9-9 所示。

现在，我们要将这个按钮转换为“添加”按钮。幸运的是，Xcode 内置了一个可以使用的添加按钮。在属性检查器中，将栏按钮项的系统项更改为**Add**。你会看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮点击时该做什么。我们希望它打开“添加生日”视图控制器，所以我们需要将添加按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你可以看到“Birthdays”表格视图控制器和最终将成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 并从+按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标。这样会弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将栏按钮项拖到“Birthdays”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在出现的对话框中选择 Present Modally。*

连接对话框提供了几种选择，用于确定在两个视图控制器之间进行的*segue*（从一个屏幕到下一个屏幕的过渡）类型。点击连接对话框中的**Present Modally**选项。这会使视图控制器以*模态*视图控制器的形式显示在屏幕上。在 iPhone 上，模态视图控制器从手机底部滑入屏幕，并且不会自动带有返回按钮返回到前一个屏幕。相反，模态视图可以有其他按钮，如取消或保存。还有其他类型的 segue，比如 Show segue，在该 segue 中，视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，应该以模态形式显示该屏幕，并且带有一个取消按钮。否则，如果你使用类似 Show segue 和返回按钮的方式，可能会出现用户输入了所有内容后，却点击返回按钮而没有保存任何信息的情况！有了取消按钮，用户必须故意点击取消，才能退出该屏幕。

要查看一个良好的模态输入视图控制器示例，看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下取消退出屏幕，右侧有一个添加按钮，可以在关闭模态窗口之前创建新事件。你应该会看到，新事件模态从屏幕底部出现，关闭时又从屏幕底部消失。我们希望用户保存生日，因此我们也会使用模态。

现在让我们尝试运行我们的应用，看看到目前为止我们做了些什么！要运行应用，首先通过点击 Xcode 左上角 BirthdayTracker 旁边列出的设备来选择一个设备模拟器（参见 图 9-11 ）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器将运行的设备，设备名称位于应用名称旁边。此处，设备设置为 iPhone 7。*

这将显示一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或使用快捷键 ⌘ -**R** 。

当模拟器打开并运行你的应用时，如果应用窗口太大，无法适应电脑屏幕，你可以调整它的大小。点击模拟器以选择它，然后前往 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时，没发生太多事情。你应该能看到你的第一个生日屏幕，并且有一个 + 按钮，如前面 图 9-1 所示。显然，此时你的生日屏幕是空的。点击 + 按钮会弹出一个第二个空白屏幕。一旦你看完应用，点击 Xcode 中的停止按钮关闭它，该按钮就在你之前点击的播放按钮旁边。停止应用后，你应该会在模拟器的主屏幕上看到你的应用图标！（参见 图 9-12 。）

就是这样！现在我们需要配置第二个屏幕，以便能够添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将它嵌入到自己的导航控制器中。当一个视图控制器是模态时，它不会继承情节提要中已存在的导航控制器中的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击情节提要中的普通视图控制器来选择它。然后前往**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该会看到一个导航项已被添加到视图控制器场景的概述视图中。点击这个新的导航项，然后在属性检查器中添加标题**Add a Birthday**。这些步骤与你在为表格视图控制器添加标题“Birthdays”时的操作相同。

现在，当“添加生日”视图控制器在应用中出现时，它将在顶部显示标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每一条记录都会包含名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入所有这些信息。输入控件是类似文本字段或下拉菜单的控件，允许用户将数据输入到应用中。我们将从添加用户可以输入的所有信息的标签开始。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器制作一个显示“First Name”的标签。这个标签将位于一个文本字段旁边，你将在其中输入朋友们的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器中添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们想使用大小检查器来设置标签的大小和位置。在 Xcode 的情节提要中，宽度和高度是以*点（points）*为单位来衡量的。请注意，1 点并不等于 1 像素。根据应用运行的设备类型，1 点将转换为 1 像素、2×2 像素的方块或 3×3 像素的方块。这三种缩放因子被称为@1x、@2x 和@3x（与我们设置应用图标时讨论的大小相同）。不同设备的点分辨率也不同，宽度可以从 320 到 1,024 点不等，高度可以从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最旧型号的 iPhone 和 iPod 使用 @1x 比例因子，您将无法在这些型号上运行您的应用程序（BirthdayTracker 只支持 iOS 10+）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，这些设备使用 @3x 比例因子，否则您的手机或 iPod 使用的通常是 @2x 比例因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离。（见 图 9-15）。我们将为每个我们添加到视图控制器中的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置得既不在屏幕边缘，也要为其文本输入字段以及其他标签和输入留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。将高度保持为 21。

完成这一步后，重复这些步骤，在“添加生日”视图控制器中再添加两个标签：姓氏标签和出生日期标签。我们需要调整其他标签和输入项的位置，以避免重叠。在某些情况下，这可能会变得有些复杂，并可能需要一些时间。对于这个应用程序，我们已经为您计算出适合放置对象的 iPhone 7 屏幕位置。稍后，我们将解释如何让您的应用程序适应其他设备。表 9-1 列出了每个标签应该设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

您可以看到，所有标签的 x 位置相同，因此它们垂直对齐，但它们的 y 位置不同。每个标签的高度为 21，因此 y 位置需要至少比下一个最近的标签高 21 个点。由于我们还将输入控件添加到每个标签下面，我们已将 y 位置调整得更大，以便同时容纳标签和输入控件的高度。

太棒了！现在您的故事板应该与 图 9-16 中的样式相似。

![Image](img/Image00214.jpg)

*图 9-16：输入项的标签已添加到视图控制器中。*

接下来，您将添加两个 *文本字段*，它们允许您输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器上。一个用于输入名字，另一个用于输入姓氏。给这两个文本字段设置表 9-2 中显示的大小和位置。你可以使用大小检查器，方法和为标签设置一样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个称为*日期选择器*的轮盘。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用程序中用于允许用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中使用的日期选择器（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以只显示时间，就像在时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到出生日期标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器显示当前日期。让我们将这个日期改为你的出生日期！将日期字段从当前日期更改为**自定义**。当你这样做时，会出现一个新的框，改成你的出生日期。

让我们通过运行应用程序来测试目前为止的效果！我们为输入控件设置的大小在 iPhone 7 屏幕上非常合适。所以，选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击生日视图控制器上的+按钮时，应该会显示添加生日界面，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![图片](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备呢？选择一个更小的模拟器运行应用程序，比如 iPhone 5s，然后重新运行应用程序。你会发现一些地方看起来不太对劲。

所有添加到故事板中的元素都显示出来了，但文本框超出了屏幕边缘。现在，所有元素都已显示在屏幕上，下一步是让它们在任何屏幕尺寸下都能正确适配。我们将使用一个名为*自动布局*的工具来完成这一点。

#### 让你的应用在每个设备上看起来都很完美，使用自动布局

光是 iPhone 就有三种不同的屏幕尺寸，而且未来可能还会推出更多尺寸。你需要设计应用，使其在任何设备上看起来都很合适。这意味着你需要让应用根据其运行的设备自动调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来安排屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来调出自动布局菜单。*

在屏幕故事板面板的底部，有一排图标，最右侧的图标是两个竖直线之间的三角形。将鼠标光标悬停在该图标上，它会显示一个标签，写着“解决自动布局问题”。点击该图标，调出建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到一堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适配屏幕，并不会超出边缘。自动布局还会确保每个文本框前后有 20 个点的间距，从而使它们在屏幕上居中显示。

现在，在 iPhone 5s 模拟器上再次运行应用。此时，添加生日屏幕应该显示完美无缺。

#### 添加保存和取消按钮

为了完成任务，我们将向你展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。这些按钮现在还不会执行任何操作。我们只是简单地设置它们。在第十章中，我们将添加一些代码，以便它们能够取消返回“添加生日”界面，并保存生日到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项并将其放置在导航栏的*右侧*。我们将把这个按钮更改为保存按钮，就像我们对添加按钮所做的那样。选择按钮项，然后使用属性检查器将其转变为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该如图 9-21 所示。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新按钮的效果！

在生日表格视图控制器上点击+按钮，应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮暂时不会做任何操作——我们将在第十章中实现这两个按钮！

### 你学到的知识

在本章中，你开始制作一个生日追踪应用，通过创建“生日”和“添加生日”屏幕的基本用户界面。你还使用表格视图控制器创建了“生日”屏幕，并使用户能够通过添加按钮和导航控制器在不同的屏幕之间导航。

现在你已经完成了应用的基本框架，接下来你将花时间在第十章中编写代码，实现取消和保存按钮，让你能够在应用中添加和保存生日！

* 在某些版本的 Xcode 中，"添加缺失的约束"选项被禁用。这是苹果的一个 bug。遇到这种情况，选择**重置为缺失约束**选项来添加缺失的约束。![图片](img/Image00203.jpg)

*图 9-7：在左侧大纲视图中选择表格视图控制器，并将其设置为初始视图控制器。*

首先，在大纲视图 ➊ 中选择**表格视图控制器**。然后在你的工具面板中打开属性检查器 ➋ 。在那里，勾选**是初始视图控制器** ➌ 。完成后，你的表格视图控制器左侧应该会出现一个箭头。这个箭头表示应用在启动时会显示这个视图控制器。

#### 添加导航控制器

现在我们将给视图控制器添加一个标题，显示“生日”，并添加一个“添加”按钮，用于弹出“添加生日”视图控制器。为此，我们首先将表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它自带一个*导航栏*，位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧显示按钮，用于在应用中导航到其他屏幕。你在多个 iOS 应用中看到过这个栏，比如设置应用和消息应用。

在大纲视图中选择**表格视图控制器**。选择后，你需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。前往**编辑** ▸ **嵌入到** ▸ **导航控制器**。

在表格视图控制器嵌入导航控制器后，你的故事板应该像图 9-8 那样。导航控制器将作为一个屏幕出现在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

每个视图控制器在故事板中代表着用户将看到的应用界面，但导航控制器有些不同。虽然它看起来像是故事板中的一个单独屏幕，实际上，导航控制器只是一个容器，包含着用户在应用中切换的其他视图控制器。将视图控制器嵌套到导航控制器中意味着你的应用可以在一个视图与另一个视图之间导航并返回。

你应该会看到导航控制器和表格视图控制器顶部有灰色的导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能还包含按钮和箭头，用户可以用来跳转到其他屏幕。为了使用导航栏来告知用户当前所处的屏幕，我们需要为屏幕添加标题。现在是回到故事板的好时机。双击故事板的空白区域以放大视图，然后滚动视图以便看到表格视图控制器。为了给表格视图控制器添加标题，点击左侧大纲视图中的**表格视图控制器场景**下的**导航项**。

![Image](img/Image00205.jpg)

选中此项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，所以在右侧的标题字段中输入**生日**。完成此步骤并按下 RETURN 键后，你会看到大纲视图中的表格视图控制器场景项自动更新为“生日场景”。

接下来，我们将制作一个“添加”按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并向列表中添加生日。让我们做一个按钮，允许用户完成这个操作！

我们需要在导航栏上添加一个按钮，跳转到“添加生日”场景，以便用户可以输入生日。找到对象库中的条形按钮项，然后将其拖放到表格视图控制器的导航栏右侧，如图 9-9 所示。

现在我们想把这个按钮改成“添加”按钮。幸运的是，Xcode 提供了一个内置的添加按钮可以使用。在属性检查器中，将条形按钮项的系统项目更改为**添加**。你应该会看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮在被点击时应该执行什么操作。我们希望它打开“添加生日”视图控制器，因此需要将添加按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你能看到“生日”表格视图控制器和最终会成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时，松开鼠标。这时会弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个条形按钮项目拖到生日视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态呈现”。*

连接对话框为你提供了几种*转场*的选项——即从一个屏幕到另一个屏幕的过渡方式。点击连接对话框中的**模态呈现**选项。这会使视图控制器以*模态*视图控制器的形式呈现到屏幕上。在 iPhone 上，模态视图控制器是从手机的底部滑上来的，并且它不会自动带有返回按钮来返回上一屏幕。相反，模态视图可以有其他按钮，比如取消或保存。还有其他类型的转场，比如“显示”转场（Show segue），它会将视图控制器从右侧推到屏幕上，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用程序中，当你呈现一个用于获取和保存用户输入的屏幕时，该屏幕应该以模态的形式呈现，并带有一个取消按钮。否则，如果使用类似“显示”转场（show segue）并带有返回按钮的方式，用户可能会输入完所有内容后点击返回按钮，结果没有保存任何东西！而带有取消按钮的模态视图，用户必须故意点击取消，才能退出该屏幕。

想要看到一个模态输入视图控制器的良好示例，可以看看你 iPhone 或 iPad 上的日历应用程序。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出，右侧有一个添加按钮，用于创建新事件并在关闭模态视图之前保存。你会看到新事件模态视图从屏幕底部弹出，关闭时又会回到底部。我们希望用户能够保存生日，因此我们也将使用模态视图。

现在让我们尝试运行应用程序，看看我们到目前为止完成了什么！要运行应用程序，首先通过点击 Xcode 左上角列出的生日追踪器旁的设备选择器来选择一个设备模拟器（见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器将运行的设备，紧挨着您应用程序的名称。此处，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行您的应用程序。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R**。

当模拟器启动并运行您的应用程序时，如果它太大而无法适应您的计算机屏幕，您可以调整它的大小。点击模拟器进行选择，然后转到**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的比例。

到目前为止，运行应用程序时并没有发生太多事情。您应该会看到您的第一个生日屏幕，上面有一个 + 按钮，如图 9-1 中所示。显然，此时您的生日屏幕将是空的。点击 + 按钮将弹出第二个空白屏幕。查看完应用后，点击 Xcode 中的停止按钮关闭它，停止按钮位于您之前按下的播放按钮旁边。停止应用后，您应该能在模拟器的主屏幕上看到您的应用图标！（参见图 9-12）。

就是这样！现在我们需要配置第二个屏幕，以便它可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：生日追踪器应用图标已添加到主屏幕。*

### 设置控制输入和标签

我们通过添加标题来开始设计“添加生日”视图控制器。为此，您需要将其嵌入到一个独立的导航控制器中。当视图控制器是模态时，它不会继承我们故事板上已经存在的导航控制器中的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。在故事板中点击选中普通视图控制器。然后，转到**编辑** ▸ **嵌入** ▸ **导航控制器**。现在，您应该可以看到在视图控制器场景的轮廓视图下添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与您之前为表格视图控制器添加“生日”标题时使用的步骤相同。

现在，当“添加生日”视图控制器在应用中出现时，它将显示在顶部带有其标题。

#### 添加朋友的姓名和生日

当你在第十章中输入朋友的生日时，应用中的每个条目将包含名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入所有这些信息。输入控件包括文本框或下拉菜单等，允许用户将数据输入到应用中。我们将从添加用户可以输入的所有信息的输入控件标签开始。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器制作一个显示“First Name”的标签。这个标签将放置在一个文本框旁边，你将在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器中。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们希望使用“尺寸检查器”设置标签的大小和位置。在 Xcode 的 storyboard 中，宽度和高度是以*点*为单位进行测量的。请注意，1 点并不等于 1 像素。根据应用运行的设备类型，1 点可能等于 1 像素、2×2 像素的正方形或 3×3 像素的正方形。这三个比例因子被称为 @1x、@2x 和 @3x（这些尺寸与我们在设置应用图标时讨论过的相同）。不同设备的点分辨率也不同，范围从 320 到 1,024 点宽、568 到 1,366 点高。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示“First Name”*

只有最旧款的 iPhone 和 iPod 使用 @1x 比例因子，并且你无法在这些型号上运行你的应用（BirthdayTracker 将仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，它们使用 @3x 比例因子，否则你的设备很可能使用 @2x 比例因子。

对象在屏幕上的位置也是基于点来计算的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（见图 9-15）。我们将在添加到视图控制器的每个库对象中设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位在离屏幕边缘不太近的位置，同时为文本输入框、其他标签和输入框留出足够的空间。在“尺寸检查器”的“视图”部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成此操作后，重复这些步骤，在“添加生日”视图控制器中再添加两个标签：一个是姓氏标签，一个是出生日期标签。我们需要将其他标签和输入控件放置在合适的位置，以免重叠。在某些情况下，这可能会比较棘手，且可能需要一些时间。对于这款应用，我们已经为你计算出了 iPhone 7 屏幕上的控件位置。稍后，我们会解释如何让你的应用适配其他设备。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，这样它们就能垂直对齐，但每个标签的 y 位置不同。每个标签的高度是 21，因此 y 位置需要比下一个最接近的标签高出至少 21 个点。由于我们还在每个标签下方添加了输入控件，所以我们将 y 位置设置得更大，以便容纳标签的高度和输入控件的高度。

太好了！现在你的故事板应该和 图 9-16 中的样式一样。

![Image](img/Image00214.jpg)

*图 9-16：已将输入标签添加到视图控制器中。*

接下来，你将添加两个 *文本字段*，它们让你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们就可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用来输入名字，另一个用来输入姓氏。按照 表 9-2 中看到的大小和位置调整这两个文本字段。你可以像调整标签一样使用大小检查器进行调整。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个称为 *日期选择器* 的滚轮控件。它将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以包含日期和时间，就像在日历应用中使用的日期选择器（参见 图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，比如在时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这就是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到出生日期标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。我们将把这个日期改为你的出生日期！将日期字段从当前日期更改为**自定义**。这样，一个新框将会出现。将日期改为你的出生日期。

现在，让我们通过运行应用来测试它的工作情况！我们使用的输入控件大小在 iPhone 7 屏幕上适配得很好。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击“出生日期视图控制器”上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很好，但其他设备呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，然后再次运行应用。你会发现有些地方显示得不太对。

你添加到故事板的所有元素都已出现，但文本字段超出了屏幕边缘。现在你已经把所有元素都放在了屏幕上，下一步是确保它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来完成这个工作。

#### 通过自动布局让你的应用在每个设备上看起来都完美

iPhone 本身有三种不同的屏幕尺寸，未来可能会出现更多尺寸。你需要设计你的应用，以确保它在任何设备上看起来都不错。这意味着你需要调整应用中所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的方式来安排屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：添加自动布局约束，点击编辑器底部第四个图标，打开自动布局菜单。*

在屏幕故事板面板的底部有一条带有图标的工具条，靠近实用工具面板的最右边是一个两个竖线之间的三角形图标。将鼠标悬停在该图标上，它应该会显示一个标签，提示“解决自动布局问题”。点击这个图标，会弹出一份建议菜单。点击**添加缺失的约束**。^(*)当你这样做时，你会看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适合屏幕宽度，不会超出屏幕边缘。自动布局还会确保每个文本框前后有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这一部分，我们将展示如何为“添加生日”视图控制器的导航栏制作“取消”和“保存”按钮。这些按钮现在还不会执行任何操作，我们只是进行设置。在第十章中，我们将添加代码，使它们可以取消“添加生日”屏幕并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个“条形按钮项”，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像之前为添加按钮所做的那样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中再拖动一个“条形按钮项”，这次将其放置在导航栏的*左侧*。使用属性检查器将其更改为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该看起来像图 9-21 所示的样子。

![Image](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新增的按钮吧！

点击“生日”表格视图控制器上的 + 按钮应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前不会有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到的内容

在本章中，你通过创建“生日”和“添加生日”屏幕的基本用户界面开始制作一个 BirthdayTracker 应用程序。你还使用了表格视图控制器创建了“生日”屏幕，并设置了用户可以通过“添加”按钮和导航控制器在不同屏幕之间切换。

现在你已经完成了应用程序的基本框架，在第十章中，你将编程实现取消和保存按钮，从而能够在应用程序中添加和保存生日！

* 在某些版本的 Xcode 中，"添加缺失约束"选项被禁用。这是一个苹果的 Bug。在这种情况下，选择选项**重置为缺失约束**来添加缺失的约束。

*图 9-7：在左侧大纲视图中选择表格视图控制器并将其设为初始视图控制器。*

首先，在大纲视图中选择**表格视图控制器** ➊ 。然后在你的实用工具面板中打开属性检查器 ➋ 。在那里，勾选**是初始视图控制器** ➌ 。完成后，你应该能在故事板中看到表格视图控制器左侧出现一个箭头。这个箭头表示应用程序在启动时会显示这个视图控制器。

#### 添加导航控制器

现在我们将为视图控制器添加一个标题，显示为“生日”，并添加一个“添加”按钮，点击该按钮会弹出“添加生日”视图控制器。为此，我们将首先把表格视图控制器放入一个*导航控制器*中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并在左右两侧显示按钮，用于在应用中导航到其他屏幕。你可以在多个 iOS 应用中看到这个栏位，比如“设置”应用和“信息”应用。

在大纲视图中选择**表格视图控制器**。选择后，你需要使用 Xcode 菜单将表格视图控制器嵌入到导航控制器中。前往**编辑** ▸ **嵌入于** ▸ **导航控制器**。

当表格视图控制器嵌入到导航控制器后，你的故事板应该像图 9-8 所示。导航控制器将作为一个屏幕出现在故事板中。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表着用户将在应用中看到的一个屏幕，但导航控制器稍有不同。虽然它在故事板中看起来像是一个独立的屏幕，但实际上导航控制器只是一个容器，用于包含用户在应用中切换的其他视图控制器。将一个视图控制器嵌入到导航控制器中意味着你的应用可以在不同的视图之间进行导航，并能够返回。

您应该会看到导航控制器和表视图控制器顶部的灰色导航栏。当应用程序运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能还包含他们可以用来跳转到其他屏幕的按钮和箭头。为了让导航栏能够告诉用户他们在哪个屏幕上，我们需要为我们的屏幕添加标题。现在是时候在故事板上缩小查看了。双击故事板的空白处进行放大，然后滚动视图，以便看到表视图控制器。要为表视图控制器添加标题，请在左侧提纲视图中的**表视图控制器场景**下单击**导航项**。

![Image](img/Image00205.jpg)

选择此项后，您可以在右侧的属性检查器中输入屏幕的标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。您应该会看到，在完成此步骤并按下 RETURN 后，提纲视图中的“表视图控制器场景”条目会自动更新为“生日场景”。

接下来，我们将创建一个“添加”按钮，以便您可以添加生日！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并将生日添加到该列表中。让我们创建一个按钮，让他们能够实现这一点！

我们需要在导航栏上添加一个按钮，链接到“添加生日”场景，以便用户可以输入生日。在对象库中找到“Bar Button Item”，然后将其拖放到表视图控制器导航栏的右侧，如图 9-9 所示。

现在，我们要将此按钮转变为“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮可以使用。在属性检查器中，将“Bar Button Item”的系统项目更改为**添加**。您应该会看到按钮变成了一个加号 (+)。

接下来，我们需要告诉按钮点击时该做什么。我们希望它能够打开“添加生日”视图控制器，因此我们需要将“添加”按钮连接到该视图控制器。首先，双击故事板进行缩小，以确保能够看到“生日”表视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键并从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标，这将弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar Button Item 拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态呈现”。*

连接对话框提供了几种不同类型的 *segue* ——从一个屏幕到另一个屏幕的过渡——你可以选择在两个视图控制器之间使用哪一种。点击连接对话框中的**模态呈现**选项。这将使视图控制器以 *模态* 形式出现在屏幕上。在 iPhone 上，模态视图控制器会从手机的底部弹出，并且默认没有返回按钮来返回到上一个屏幕。相反，模态视图可以有其他按钮，比如取消或保存。还有其他类型的 segue，比如 Show segue（显示转场），在这种情况下，视图控制器会从右侧推到屏幕上，并且导航栏左侧会有返回按钮。

在 iOS 应用程序中，当你展示一个用于获取和保存用户输入的屏幕时，屏幕应该以模态的形式显示，并且应该有一个取消按钮。否则，如果你使用像 Show segue（显示转场）这样的方式，并且有返回按钮，用户可能会遇到这种情况：他们输入了所有内容，然后点击返回按钮，结果什么也没保存！有了取消按钮，用户必须刻意点击取消才能退出屏幕。

要查看一个模态输入视图控制器的良好示例，可以看看你 iPhone 或 iPad 上的日历应用程序。当你打开它时，导航栏右侧会有一个 + 按钮，你可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以退出屏幕而不保存，右侧有一个添加按钮，可以在关闭模态时创建新的事件。你应该会看到“新事件”模态从屏幕底部弹出，关闭时则从屏幕底部滑回去。我们希望用户能够保存生日，所以我们也会使用模态。

现在让我们尝试运行我们的应用程序，看看到目前为止我们做了什么！要运行应用程序，首先通过点击 Xcode 左上角 BirthdayTracker 旁边列出的设备，选择一个设备模拟器（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角，设置模拟器将运行的设备，位于应用程序名称旁边。这里，设备设置为 iPhone 7。*

这将显示一个设备选项列表，用于运行你的应用程序。我们选择 iPhone 7。当你选择了模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R**。

当模拟器启动并运行你的应用程序时，如果模拟器的大小太大，无法适应你的电脑屏幕，你可以调整它。点击模拟器进行选择，然后进入 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用时没有发生太多事情。你应该会看到你的第一个生日屏幕，屏幕上有一个加号按钮，如图 9-1 所示。显然，这时你的生日屏幕会是空的。点击加号按钮会弹出第二个空白屏幕。查看完你的应用后，点击 Xcode 中的停止按钮关闭应用，停止按钮位于你之前按下的播放按钮旁边。停止应用后，你应该会看到应用图标出现在模拟器的主屏幕上！（参见图 9-12。）

就这样！现在我们需要配置第二个屏幕，以便可以用来添加生日！

![图片](img/Image00209.jpg)

*图 9-12：生日追踪器应用图标已添加到主屏幕。*

### 设置控件输入和标签

让我们通过添加标题开始设计“添加生日”视图控制器。为此，你需要将它嵌入到自己的导航控制器中。当视图控制器是模态的时，它不会继承我们故事板中已存在的导航控制器的导航栏。导航控制器是提供导航栏的，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器来选择它，然后进入**编辑器** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该会看到在“视图控制器场景”下的轮廓视图中添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与在表视图控制器中添加标题“生日”时所遵循的步骤相同。

现在，当“添加生日”视图控制器出现在应用中时，它将在顶部标有标题。

#### 添加你的朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每一条记录都会包含一个名字、姓氏和出生日期。我们来为“添加生日”视图控制器添加一些*输入控件*，这样用户就能为每个人输入所有这些信息。输入控件是像文本字段或下拉菜单这样的元素，允许用户将数据输入到应用中。我们将从为所有用户可以添加的信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“名字”的标签。这个标签将放在一个文本框旁边，用户可以在其中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器上（参见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框，并输入**名字**作为显示文本，如图 9-14 所示。

现在我们要使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以*点*为单位。请注意，1 个点并不等于 1 像素。根据你的应用运行的设备类型，1 个点可能会转换成 1 个像素、2×2 像素的方块或 3×3 像素的方块。这三种缩放因子分别称为 @1x、@2x 和 @3x（这些就是我们在设置应用图标时提到的相同大小）。设备的点分辨率也各不相同，宽度可以从 320 点到 1,024 点，长度从 568 点到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14: 显示标签* 名字

只有最旧款的 iPhone 和 iPod 才使用 @1x 缩放因子，而这些设备无法运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。你的手机或 iPod 很可能使用 @2x 缩放因子，除非它是 iPhone 6 Plus、6s Plus 或 7 Plus，这些设备使用 @3x 缩放因子。

对象在屏幕上的位置也是基于点数的。对象的 x 位置是从屏幕的左侧到对象左侧的距离，以点为单位。y 位置是从屏幕的顶部到对象顶部的距离。（参见图 9-15）我们将设置每个库对象在视图控制器中的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15: 显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置得既不在屏幕边缘，又能为其文本输入框和其他标签、输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成这些步骤后，重复这些操作，在“添加生日”视图控制器中再添加两个标签：一个是姓氏标签，另一个是出生日期标签。我们需要调整其他标签和输入框的位置，以避免重叠。在某些情况下，这可能会变得复杂并需要一些时间。对于这个应用，我们已经为你计算了适合放置对象的位置，适用于 iPhone 7 屏幕。稍后，我们将解释如何让你的应用在其他设备上也能运行。表格 9-1 列出了你应该为每个标签设置的大小和位置。

表格 9-1: 视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 坐标相同，这样它们就可以垂直对齐，但每个标签的 y 坐标不同。每个标签的高度为 21，所以 y 坐标需要比下一个最接近的标签高至少 21 点。由于我们还将在每个标签下方添加输入控件，因此我们已经增大了 y 坐标，以便同时容纳标签的高度和输入控件的高度。

太好了！现在你的故事板应该像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，让你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段的大小和位置设置为表 9-2 中所示的样式。你可以使用大小检查器，正如你为标签所做的那样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后，你需要添加一个叫做*日期选择器*的控件。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的工具，允许用户选择日期或时间。它可以包含日期和时间，像日历应用中使用的日期选择器一样（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，例如在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这正是我们在生日追踪器中使用的功能。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到视图控制器中出生日期标签下方。使用大小检查器，将 x 坐标设置为 0，y 坐标设置为 280。

你需要调整一些日期选择器的属性。点击日期选择器进行选择。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的生日！将“日期”字段从“当前日期”更改为**自定义**。当你这样做时，新的框框将出现。将这个日期更改为你的生日。

让我们通过运行应用来测试一下它目前的效果！我们为输入控件所使用的尺寸非常适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你点击“生日视图控制器”中的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美契合。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来不错，但其他设备呢？选择一个更小的模拟器运行应用，比如 iPhone 5s，再次运行应用。你会发现，界面显示得不太对劲。

你添加到故事板中的所有元素都出现了，但文本框超出了屏幕的边缘。现在你已经将所有元素放在屏幕上，接下来的步骤是确保它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来完成这项工作。

#### 让你的应用在每个设备上看起来完美无缺，使用自动布局

单单 iPhone 就有三种不同的屏幕尺寸，而且未来可能还会有更多的尺寸。你需要设计你的应用，使它在任何设备上看起来都很棒。这意味着你需要让应用根据运行的设备自动调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的概览视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕故事板面板的底部，有一个带有图标的条带，编辑器面板底部的最右侧图标是一个位于两条竖线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，提示“解决自动布局问题”。点击此图标，打开建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到一堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局会确保日期选择器的大小适应屏幕宽度，并且不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点，使它们在屏幕上居中显示。

现在，再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”屏幕应该显示完美。

#### 添加保存和取消按钮

为了完成这些工作，我们将向你展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。此时，按钮还不会执行任何操作。我们只会设置它们。在第十章中，我们将添加一些代码，使它们能够取消添加生日屏幕并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个 Bar Button Item，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们对添加按钮所做的那样。选择按钮项，然后使用属性检查器将其改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，并将其放置在导航栏的*左侧*。使用属性检查器将其更改为取消按钮，就像你对保存按钮所做的那样。你的视图控制器应如图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新的按钮！

点击生日表视图控制器上的+按钮应该会带你进入“添加生日”视图控制器，你可以在其中输入人的姓名和出生日期。此时点击取消和保存按钮不会执行任何操作——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你开始通过创建生日和添加生日屏幕的基本用户界面来制作一个 BirthdayTracker 应用程序。你还使用表视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用程序的基本骨架，接下来将在第十章中编写取消和保存按钮的代码，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，"Add Missing Constraints"选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择**Reset to Missing Constraints**选项来添加缺失的约束。

首先，在大纲视图中选择**表格视图控制器** ➊。然后在您的实用工具面板中打开属性检查器 ➋。在这里，勾选**是初始视图控制器**的框 ➌。完成后，故事板中表格视图控制器左侧应出现一个箭头。这个箭头表示应用启动时将显示此视图控制器。

#### 添加导航控制器

现在我们将在视图控制器上添加一个标题“Birthdays”，并添加一个“添加”按钮，点击后会弹出“添加生日”视图控制器。为此，首先我们将表格视图控制器放入*导航控制器*中。导航控制器管理一个或多个视图控制器，它自带一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且左右两侧可能会有按钮，用于导航到应用中的其他屏幕。您在多个 iOS 应用中看到过这个栏位，比如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。选择后，您需要通过 Xcode 菜单将表格视图控制器嵌入到导航控制器中。依次点击 **Editor** ▸ **Embed In** ▸ **Navigation Controller**。

将表格视图控制器嵌入导航控制器后，您的故事板应该像图 9-8 中所示的那样。导航控制器将显示为故事板中的一个屏幕。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表用户将看到的应用屏幕，但导航控制器有些不同。尽管在故事板中它看起来像是一个独立的屏幕，导航控制器实际上只是一个容器，存放用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着您的应用可以在一个视图和另一个视图之间进行导航。

您应该可以看到导航控制器和表格视图控制器顶部有灰色的导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能包含按钮和箭头，用户可以通过这些按钮和箭头切换到其他屏幕。为了通过导航栏告诉用户当前所在的屏幕，我们需要为屏幕设置标题。现在是时候在故事板上重新聚焦了。双击故事板的空白区域进行放大，然后滚动视图以便查看表格视图控制器。为了给表格视图控制器添加标题，请在左侧的大纲视图中点击**表格视图控制器场景**下的**导航项**。

![Image](img/Image00205.jpg)

选中此项后，您可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。完成此步骤并按下 RETURN 键后，您应该会看到大纲视图中的“Table View Controller Scene”项自动更新为“Birthdays Scene”。

接下来，我们将制作一个“添加”按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将生日添加到该列表中。让我们制作一个按钮，让他们能够做到这一点！

我们需要在导航栏上添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。在对象库中找到“Bar Button Item”，然后将其拖放到表视图控制器的导航栏右侧，如图 9-9 所示。

现在我们想把这个按钮变成一个“添加”按钮。幸运的是，Xcode 有一个内置的“添加”按钮可以使用。在属性检查器中，将 bar button item 的“System Item”更改为**Add**。你应该能看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在被点击时该做什么。我们希望它打开“添加生日”视图控制器，因此我们需要将添加按钮与该视图控制器连接。首先，双击故事板进行缩小，以确保您能看到“Birthdays”表视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从+按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标，这将弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将 Bar Button Item 拖到 Birthdays 视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖到邻近的视图控制器，并在出现的对话框中选择 Present Modally。*

连接对话框为你提供了几种选择，以便在两个视图控制器之间进行*segue*（从一个屏幕到下一个屏幕的过渡）。点击连接对话框中的**Present Modally**选项。这会将视图控制器作为*模态*视图控制器呈现到屏幕上。在 iPhone 上，模态视图控制器从手机底部进入屏幕，并且不会自动带有返回按钮来返回上一个屏幕。相反，模态视图可以有其他按钮，例如取消或保存。还有其他类型的 segue，例如 Show segue，其中视图控制器从右侧推送到屏幕上，并且在导航栏左侧有一个返回按钮。

在 iOS 应用中，当你展示一个获取和保存用户输入的界面时，屏幕应该作为模态窗口展示，并带有一个取消按钮。否则，如果你使用类似 Show segue 的方式，并且带有返回按钮，用户可能会先输入所有内容，然后点击返回按钮而没有保存任何数据！有了取消按钮，用户必须主动点击才能取消该界面。

要查看一个良好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，你会看到导航栏右侧有一个 + 按钮，点击它可以添加一个日历事件。点击 + 按钮会弹出一个模态的“新事件”视图控制器。该视图控制器左侧有一个取消按钮，点击后可以取消并返回，而右侧有一个添加按钮，用于在关闭模态窗口之前创建新的事件。你会看到“新事件”模态窗口从屏幕底部滑上来，关闭时又滑回底部。我们希望用户能够保存生日，所以我们也将使用模态窗口。

现在让我们试着运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先通过点击 Xcode 左上角 BirthdayTracker 旁边列出的设备来选择一个设备模拟器（参见 图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器运行的设备，设备旁边是你应用的名称。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或使用键盘快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果它太大无法适应你的电脑屏幕，你可以调整其大小。点击模拟器以选择它，然后进入 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时，实际上并没有发生太多事情。你应该能看到你第一个生日页面，页面上有一个 + 按钮，如 图 9-1 中所示。显然，到目前为止，你的生日页面是空的。点击 + 按钮会展示第二个空白页面。当你完成查看应用后，点击 Xcode 中的停止按钮关闭应用，该按钮位于之前点击的播放按钮旁边。停止应用后，你现在应该能看到你的应用图标出现在模拟器的主屏幕上！（见 图 9-12。）

就是这样！接下来我们需要配置第二个界面，使其能够添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计添加生日视图控制器，首先添加其标题。为此，你需要将其嵌入到一个独立的导航控制器中。当一个视图控制器是模态的时，它不会继承我们故事板中已经存在的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过在故事板中点击视图控制器来选择一个普通视图控制器。然后转到**编辑** ▸ **嵌入于** ▸ **导航控制器**。现在你应该看到在视图控制器场景的轮廓视图下方添加了一个导航项。点击这个新导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与添加标题“生日”到你的表格视图控制器时的步骤相同。

现在，当添加生日视图控制器在应用中出现时，顶部会显示其标题。

#### 添加你朋友的姓名和生日

当你在第十章中输入朋友的生日时，应用中的每一条记录都会有名字、姓氏和出生日期。让我们为添加生日视图控制器添加一些*输入控件*，以便用户可以为每个人输入所有这些信息。输入控件是像文本框或下拉菜单这样的控件，允许用户将数据输入到你的应用中。我们将从为用户可以添加的所有信息添加输入控件标签开始。

##### 添加和定位标签

让我们为你的添加生日视图控制器创建一个显示“名字”的标签。这个标签将放置在一个文本框旁边，你可以在这里输入你朋友的名字。从对象库中找到并拖动一个标签对象到添加生日视图控制器上（参见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：将标签添加到添加生日视图控制器。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在我们想通过尺寸检查器来设置标签的大小和位置。在 Xcode 故事板中，宽度和高度以*点*为单位进行测量。注意，1 点不等于 1 像素。根据你的应用运行的设备类型，1 个点可能会转换成 1 个像素、2×2 像素的方块，或者 3×3 像素的方块。这三个缩放因子被称为@1x、@2x 和@3x（我们在设置应用图标时也讨论过这些大小）。设备的点分辨率也并不相同，宽度范围从 320 点到 1,024 点，高度范围从 568 点到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* 名字

只有最老款的 iPhone 和 iPod 使用 @1x 缩放因子，你将无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus 否则你的手机或 iPod 应该使用 @2x 缩放因子，这些设备使用 @3x 缩放因子。

对象在屏幕上的位置也是基于点来计算的。对象的 x 位置是从屏幕左边到对象左边的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离。（见 图 9-15）。我们将在视图控制器中设置每个库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位到屏幕边缘之外，但仍然为其文本输入框和其他标签及输入框留出足够的空间。在“大小检查器”的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成此操作后，重复这些步骤，向“添加生日”视图控制器添加两个标签：姓氏标签和出生日期标签。我们需要定位其他标签和输入框，以确保它们不会重叠。在某些情况下，这可能会变得棘手，并且可能需要一些时间。对于这个应用程序，我们已经为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何使应用程序在其他设备上运行。表 9-1 列出了你应该为每个标签设置的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | x 位置 | y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们在垂直方向上对齐，但它们每个的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个最接近的标签至少大 21 点。由于我们还在每个标签下方添加了输入控件，我们将 y 位置设置得更大，以适应标签和输入控件的高度。

很棒！现在你的故事板应该像 图 9-16 中的那样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个 *文本框*，让你可以输入姓氏和名字。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本字段对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段的大小和位置设置为表 9-2 所示。你可以通过“尺寸检查器”进行设置，就像你设置标签时那样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个叫做*日期选择器*的轮盘。这将帮助你轻松输入生日日期。

##### 添加日期选择器

日期选择器是 iOS 应用程序中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，比如日历应用中使用的日期选择器（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器在日历应用中用于添加事件时选择日期。*

日期选择器还可以仅显示时间，比如在时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到“生日”标签下的视图控制器中。使用“尺寸检查器”将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器将其选中。然后，在“属性检查器”中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将这个日期更改为你的生日！将“日期”字段从当前日期改为**自定义**。这样会出现一个新的框，输入你的生日日期。

让我们通过运行应用来测试到目前为止的效果！我们为输入控件使用的尺寸适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这时，当你点击“生日视图控制器”上的+按钮时，应该会显示“添加生日”界面，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美契合。*

![图片](img/Image00218.jpg)

在 iPhone 7 上显示得很好，但其他设备呢？选择一个更小的模拟器，比如 iPhone 5s，然后再次运行应用。你会看到界面显示得不太合适。

所有你添加到故事板的元素都已经显示出来，但文本框超出了屏幕的边缘。现在你已经把所有元素都放到了屏幕上，接下来的步骤是确保它们能够在任何屏幕尺寸上正确显示。我们将使用一个名为*自动布局*的工具来完成这一任务。

#### 使用自动布局让你的应用在每个设备上看起来完美

单独的 iPhone 就有三种不同的屏幕尺寸，未来可能还会有更多尺寸。你需要设计你的应用，使其在任何设备上看起来都很不错。这意味着，你需要让你的应用根据运行应用的设备，调整应用中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来将元素放置到屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部第四个图标来打开自动布局菜单。*

在屏幕的故事板面板底部，有一个包含图标的工具带，位于“实用工具”面板前面的最右侧图标是一个夹在两条竖线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击这个图标，将弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这么做时，你会看到一大堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的宽度适应屏幕，不会超出边界。自动布局还会确保每个文本框前后都有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”屏幕应该显示得很完美。

#### 添加保存和取消按钮

为了完成最后的步骤，我们将教你如何在“添加生日”视图控制器的导航栏中添加取消和保存按钮。此时，按钮尚未实现任何功能，我们只是简单地设置它们。在第十章中，我们将添加一些代码，使得按钮能够退出“添加生日”屏幕并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个“条形按钮项”并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们之前做的“添加”按钮一样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个栏按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，像你设置保存按钮一样。你的视图控制器应该像图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新的按钮！

点击生日表格视图控制器上的 + 按钮，应该会带你进入添加生日视图控制器，在那里你可以输入一个人的名字和生日日期。点击取消和保存按钮暂时没有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你开始通过创建生日和添加生日屏幕的基本用户界面来制作一个 BirthdayTracker 应用程序。你还使用表格视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用程序的基本框架，接下来将在第十章中编程实现取消和保存按钮，这样你就可以在应用程序中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

#### 添加导航控制器

现在，我们将为视图控制器添加一个标题，写上“生日”，并添加一个将打开添加生日视图控制器的添加按钮。为此，我们将首先把表格视图控制器放入一个*导航控制器*。导航控制器管理一个或多个视图控制器，它自带一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并配有左右两侧的按钮，用于导航到应用程序中的其他屏幕。你会在许多 iOS 应用程序中看到这个导航栏，比如设置应用和信息应用。

在大纲视图中选择**表格视图控制器**。选择后，你需要使用 Xcode 菜单将表格视图控制器嵌入到导航控制器中。前往**编辑** ▸ **嵌入** ▸ **导航控制器**。

在将表格视图控制器嵌入到导航控制器后，你的故事板应该像图 9-8 所示。导航控制器将显示为故事板中的一个屏幕。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

每个视图控制器在故事板中代表着用户将看到的应用屏幕，但导航控制器稍有不同。尽管它在故事板中看起来像是一个独立的屏幕，但导航控制器实际上只是一个容器，包含了用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在一个视图和另一个视图之间导航。

你应该会看到导航控制器和表视图控制器顶部有灰色的导航栏。当应用运行时，导航栏会告诉用户他们当前所在的屏幕标题，并且可能还会包含按钮和箭头，用户可以用它们去其他屏幕。为了利用导航栏告诉用户他们所处的屏幕，我们需要为屏幕设置标题。现在是时候放大故事板了。在故事板的空白区域双击以放大视图，然后滚动视图，直到你能看到表视图控制器。为了给表视图控制器添加标题，请点击轮廓视图左侧**表视图控制器场景**下的**导航项**。

![Image](img/Image00205.jpg)

选择此选项后，你可以在右侧的属性检查器中为屏幕输入一个标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。你应该会看到，在完成此步骤并按下 RETURN 后，轮廓视图中的表视图控制器场景条目会自动更新为 Birthdays 场景。

接下来，我们将添加一个“添加”按钮，这样你就可以添加生日了！

#### 添加一个按钮

我们希望用户能够打开应用，查看他们的生日列表，并向列表中添加一个生日。让我们创建一个按钮来让他们做到这一点！

我们需要在导航栏上添加一个按钮，指向“添加生日”场景，以便用户可以输入一个生日。找到对象库中的**Bar Button Item**，然后将它拖动到表视图控制器的导航栏右侧，正如图 9-9 所示。

现在我们要把这个按钮变成“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮可以使用。在属性检查器中，将按钮的系统项目更改为**Add**。你应该会看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在点击时执行什么操作。我们希望它打开“添加生日”视图控制器，因此需要将“添加”按钮连接到该视图控制器。首先，双击故事板进行缩小，确保你能看到“生日”表格视图控制器和将来成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键并从 + 按钮拖动到故事板右侧的空白视图控制器中间。当视图控制器被高亮显示时松开鼠标，这将弹出一个连接对话框，如图 9-10 所示。

![图片](img/Image00206.jpg)

*图 9-9：将一个“条形按钮项”拖到生日视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态呈现”选项。*

连接对话框提供了多个选项，可以选择你想要在两个视图控制器之间进行的*转场*方式——即从一个屏幕到下一个屏幕的过渡。点击连接对话框中的**模态呈现**选项。这将使视图控制器作为*模态*视图控制器显示在屏幕上。在 iPhone 上，模态视图控制器从屏幕底部出现，并且没有自动带有返回按钮以返回到上一个屏幕。相反，模态视图可以有其他按钮，如“取消”或“保存”。还有其他类型的转场，如“显示”转场，其中视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你呈现一个用于获取和保存用户输入的屏幕时，屏幕应该以模态的形式显示，并且要有一个“取消”按钮。否则，如果你使用类似“显示”转场（Show segue）并且有返回按钮的方式，用户可能会输入所有内容后点击返回按钮，而没有保存任何数据！有了“取消”按钮，用户必须有意识地点击以取消退出该屏幕。

要查看一个好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧会有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮后，会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个“取消”按钮，可以不保存直接取消退出，右侧有一个“添加”按钮，在关闭模态视图之前创建新事件。你会看到，“新事件”模态视图控制器从屏幕底部进入，当它被关闭时又会下滑退出。我们希望用户保存生日，因此我们也会使用模态视图控制器。

现在让我们尝试运行我们的应用程序，看看目前为止我们做了什么！要运行应用程序，首先点击 Xcode 左上角的设备列表，选择一个设备模拟器（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上方的应用程序名称旁边设置模拟器运行的设备。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用程序。我们选择的是 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R**。

当模拟器启动并运行你的应用时，如果模拟器的大小太大而无法适应计算机屏幕，你可以调整其大小。点击模拟器以选中它，然后进入 **窗口** ▸ **缩放**，在模拟器菜单中选择更小的缩放比例。

到目前为止，运行应用程序时不会发生太多事情。你应该看到第一个生日屏幕，上面有一个 + 按钮，如之前在图 9-1 所示。显然，在这一点上，生日屏幕是空的。点击 + 按钮会弹出第二个空白屏幕。查看完应用程序后，通过点击 Xcode 中的停止按钮来关闭它，停止按钮位于你之前按下的播放按钮旁边。停止应用程序后，你现在应该能在模拟器的主屏幕上看到你的应用程序图标！（参见图 9-12）。

就这样！我们现在需要配置第二个屏幕，以便可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用程序图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将它嵌入到一个独立的导航控制器中。当视图控制器是模态视图时，它不会继承我们故事板上已有的导航控制器的导航栏。导航控制器提供了一个导航栏，所以我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器来选择它。然后进入 **编辑** ▸ **嵌入到** ▸ **导航控制器**。现在你应该看到一个导航项已添加到视图控制器场景下的轮廓视图中。点击这个新添加的导航项，然后在属性检查器中添加标题 **添加生日**。这些步骤与你当时为表格视图控制器添加标题“生日”时所遵循的步骤相同。

当“添加生日”视图控制器出现在应用程序中时，它会在顶部标注其标题。

#### 添加朋友的姓名和生日

当你在第十章中输入朋友的生日时，应用中的每个条目将包含一个名字、一个姓氏和一个出生日期。让我们在“添加生日”视图控制器中添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件是像文本框或下拉菜单这样的控件，允许用户将数据输入到你的应用中。我们将首先添加所有用户可以添加的信息的输入控件标签。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“First Name”的标签。这个标签将放在一个文本框旁边，用于输入朋友们的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器中。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框，并输入**First Name**作为显示文本，如图 9-14 所示。

现在我们希望使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*为单位的。请注意，1 点并不是 1 像素。根据应用运行的设备类型，1 点将转换为 1 像素、一个 2×2 像素的方块或一个 3×3 像素的方块。这三种缩放因子被称为@1x、@2x 和@3x（我们在设置应用图标时讨论过的相同大小）。设备的点分辨率也不相同，宽度可以从 320 到 1,024 点不等，长度从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最老的 iPhone 和 iPod 型号使用@1x 缩放因子，并且你将无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10+）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，否则你的手机或 iPod 很可能使用@2x 缩放因子，而这些设备使用@3x 缩放因子。

一个对象在屏幕上的位置也是基于点数的。对象的 x 位置是从屏幕的左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（见图 9-15）。我们将为每个我们添加到视图控制器中的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置为不靠近屏幕边缘，但仍然为其文本输入框和其他标签与输入控件留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成此操作后，重复这些步骤，向“添加生日”视图控制器中再添加两个标签：一个是姓氏标签，另一个是出生日期标签。我们需要定位其他标签和输入框，以避免它们重叠。在某些情况下，这可能会变得复杂，并可能需要一些时间。对于这个应用，我们已经为你计算好了可以放置对象的位置，适用于 iPhone 7 的屏幕。稍后我们会解释如何让你的应用支持其他设备。表 9-1 列出了你应该给每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X-位置 | Y-位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x-位置相同，这样它们就能垂直对齐，但它们的 y-位置各不相同。每个标签的高度是 21，因此 y-位置需要比下一个最接近的标签大至少 21 个点。由于我们也在每个标签下方添加了输入控件，我们将 y-位置设置得更大，以便容纳标签的高度和输入控件的高度。

太棒了！现在你的故事板应该像图 9-16 中那样。

![图片](img/Image00214.jpg)

*图 9-16：输入的标签已经添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们将允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在该字段中输入一行文本。

##### 添加文本字段

从对象库中将两个文本字段对象拖到你的视图控制器上。一个将用于输入名字，另一个将用于输入姓氏。给这两个文本字段设置表 9-2 中显示的大小和位置。你可以使用大小检查器，就像为标签所做的那样。

表 9-2：视图控制器中的文本字段输入

| 文本字段 | X-位置 | Y-位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做*日期选择器*的控件。它将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器一样（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于日历应用中添加事件时选择日期。*

日期选择器也可以只显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者只显示日期，这就是我们将在生日追踪器中使用的。

在对象库中滚动，直到找到一个日期选择器，然后将其点击并拖动到“出生日期”标签下的视图控制器上。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

您需要调整日期选择器的几个属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器设置为显示当前日期。让我们将这个日期改为您的出生日期！将日期字段从“当前日期”更改为**自定义**。当您这样做时，会出现一个新框。将这个日期改为您的出生日期。

让我们通过运行应用程序来测试它目前的工作情况！我们为输入控件所使用的尺寸在 iPhone 7 屏幕上显示得很好。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当您在“生日”视图控制器上点击 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来不错，但其他设备呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，然后再次运行应用程序。您会看到界面看起来不太对劲。

您添加到故事板的所有元素都已显示，但文本框超出了屏幕的边缘。现在所有元素都已显示在屏幕上，下一步是使它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来完成这项工作。

#### 使用自动布局让您的应用在每个设备上看起来都完美

单单是 iPhone 就有三种不同的屏幕尺寸，并且未来可能会推出更多尺寸。您需要设计您的应用程序，使其在任何设备上看起来都很好。这意味着您需要让应用程序调整应用内所有元素的位置和大小，以适应应用运行的设备。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。您需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接着，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕故事板的底部有一个带有图标的带状区域，位于工具面板之前的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该显示一个标签，标注为“解决自动布局问题”。点击这个图标，将弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你执行此操作时，你会看到很多布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局会确保日期选择器的宽度适应屏幕，不会超出边缘。自动布局还会确保每个文本框前后有 20 个点，以便它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成最后的工作，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮暂时不会有任何功能。我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消“添加生日”屏幕并保存生日到应用中。

为了添加保存按钮，从对象库中拖动一个条形按钮项并将其放置在导航栏的*右*侧。我们将把这个按钮改成保存按钮，就像我们处理添加按钮一样。选择按钮项，然后使用属性检查器将其转变为保存按钮。

最后，我们来添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左*侧。使用属性检查器将其转变为取消按钮，就像你处理保存按钮一样。你的视图控制器应如图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新增的按钮！

点击生日表视图控制器上的+按钮应该会带你进入“添加生日”视图控制器，你可以在其中输入某人的名字和出生日期。点击取消和保存按钮目前没有任何效果——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用，通过创建生日和添加生日屏幕的基本用户界面。你还使用表视图控制器创建了生日屏幕，并让用户可以通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本框架，在第十章中，你将编程实现取消和保存按钮，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，"Add Missing Constraints" 选项被禁用了，这是一个 Apple 的 bug。在这种情况下，选择**Reset to Missing Constraints**选项来添加缺失的约束。

现在我们将为视图控制器添加一个标题“Birthdays”并添加一个“Add”按钮，用于弹出“添加生日”视图控制器。为了实现这个，我们首先将表视图控制器嵌入到*导航控制器*中。导航控制器管理一个或多个视图控制器。它带有一个*导航栏*，该导航栏位于视图控制器的顶部。导航栏可以显示视图控制器的标题，并且可以在左右两侧显示按钮，用于导航到应用中的其他屏幕。在多个 iOS 应用中，如设置应用和信息应用，你可以看到这个导航栏出现在屏幕顶部。

在大纲视图中选择**Table View Controller**。选择后，你需要通过 Xcode 菜单将表视图控制器嵌入到导航控制器中。进入**Editor** ▸ **Embed In** ▸ **Navigation Controller**。

将表视图控制器嵌入到导航控制器后，你的故事板应该类似于图 9-8 中的样子。导航控制器会作为一个屏幕显示在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器都代表了用户将看到的一个屏幕，但导航控制器稍有不同。尽管它看起来像是故事板中的一个独立屏幕，实际上导航控制器只是一个容器，里面存放着用户在应用中切换的其他视图控制器。将视图控制器嵌入到导航控制器中意味着你的应用可以在不同的视图之间进行导航。

你应该看到导航控制器和表视图控制器顶部有灰色的导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，并可能包含按钮和箭头，用户可以使用这些按钮和箭头跳转到其他屏幕。为了利用导航栏告诉用户当前所在的屏幕，我们需要为屏幕添加标题。现在是重新聚焦到故事板的好时机。双击故事板中的空白区域以放大视图，然后滚动视图以便看到表视图控制器。要为表视图控制器添加标题，在左侧大纲视图中点击**Navigation Item**，它位于**Table View Controller Scene**下。

![Image](img/Image00205.jpg)

选中后，你可以在右侧的属性检查器中输入屏幕的标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题栏中输入**Birthdays**。完成此步骤并按下 RETURN 键后，你应该会看到大纲视图中的 Table View Controller Scene 条目自动更新为 Birthdays Scene。

接下来，我们将创建一个“添加”按钮，这样你就可以添加生日了！

#### 添加一个按钮

我们希望用户能够打开应用，查看他们的生日列表，并向列表中添加一个生日。让我们做一个按钮来实现这一功能！

我们需要在导航栏中添加一个按钮，进入“添加生日”场景，以便用户输入生日。在对象库中找到“Bar Button Item”，然后将其拖动到表视图控制器的导航栏右侧，如图 9-9 所示。

现在我们要将这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮供我们使用。在属性检查器中，将工具栏按钮项的系统项改为**添加**。你应该会看到按钮变成一个加号 (+)。

接下来，我们需要告诉按钮在被点击时应该做什么。我们希望它打开“添加生日”视图控制器，因此我们需要将“添加”按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你可以看到“生日”表视图控制器和将来会成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键并将 + 按钮拖动到故事板右侧的空白视图控制器中间。当视图控制器高亮显示时松开鼠标，这将弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将 Bar Button Item 拖动到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态展示”。*

连接对话框提供了多个选项，用于设置两个视图控制器之间的*segue*——从一个屏幕到下一个屏幕的过渡方式。在连接对话框中点击**模态展示**选项。这将使视图控制器以*模态*方式显示在屏幕上。在 iPhone 上，模态视图控制器从手机底部滑上屏幕，并且它不会自动附带返回按钮返回到上一屏幕。相反，模态视图可以包含其他按钮，如取消或保存。还有其他类型的过渡，比如“展示”过渡，视图控制器从右侧推送到屏幕上，并且在导航栏左侧带有返回按钮。

在 iOS 应用中，当你展示一个获取和保存用户输入的屏幕时，这个屏幕应该以模态方式显示，并且带有一个取消按钮。否则，如果你使用类似“展示”过渡的方式，并且有一个返回按钮，那么用户可能会在输入所有内容后点击返回按钮而没有保存任何内容！有了取消按钮，用户必须明确点击才能退出该屏幕。

要查看一个很好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，可以在关闭模态前创建新事件。你应该能看到，新事件模态从屏幕底部弹出，并且在关闭时会返回到底部。我们希望用户能够保存生日信息，所以我们也会使用模态。

现在让我们尝试运行我们的应用程序，看看到目前为止我们做了什么！要运行应用程序，首先通过点击 Xcode 左上角的 BirthdayTracker 旁边的设备列表，选择一个设备模拟器（参见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角，应用名称旁边设置模拟器运行的设备。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R**。

当模拟器打开以运行你的应用时，如果它的大小过大，无法适应你的电脑屏幕，你可以调整其大小。点击模拟器以选择它，然后进入 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的比例。

到目前为止，运行应用程序时不会发生太多事情。你应该会看到你的第一个生日屏幕，屏幕上有一个 + 按钮，如图 9-1 所示。显然，此时你的生日屏幕是空的。点击 + 按钮会弹出第二个空白屏幕。浏览完你的应用后，可以点击 Xcode 中的停止按钮来关闭它，停止按钮位于你之前点击的播放按钮旁边。停止应用后，你现在应该能在模拟器的主屏幕上看到你的应用图标！（参见图 9-12）。

就是这样！我们现在需要配置第二个屏幕，使其能够用于添加生日！

![图片](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到一个独立的导航控制器中。当视图控制器是模态时，它不会继承我们故事板上已经存在的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击故事板中的视图控制器来选择纯视图控制器。然后，转到**编辑** ▸ **嵌入** ▸ **导航控制器**。现在，你应该看到一个导航项已被添加到视图控制器场景下的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与之前为表视图控制器添加“生日”标题时相同。

现在，当“添加生日”视图控制器出现在应用中时，它将在顶部显示其标题。

#### 添加你的朋友的名字和生日

当你在第十章中输入朋友的生日时，应用程序中的每个条目将包含名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以输入每个人的所有信息。输入控件包括文本字段或下拉菜单等，它们允许用户在应用程序中输入数据。我们将通过添加所有用户可以添加的信息的输入控件标签来开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个显示“名字”的标签。这个标签将位于一个文本字段旁边，用户将在其中输入朋友的名字。从对象库中找到并将标签对象拖放到“添加生日”视图控制器上（参见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在，我们希望使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以*点*为单位进行测量。请注意，1 点并不等于 1 像素。根据应用运行的设备类型，1 点可能对应 1 个像素、2×2 像素的方块或 3×3 像素的方块。这三个缩放因子分别称为@1x、@2x 和@3x（与我们在设置应用图标时讨论的尺寸相同）。设备的点分辨率也不相同，宽度从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* 名字

只有最旧款的 iPhone 和 iPod 使用 @1x 缩放因子，而你将无法在这些型号上运行你的应用程序（BirthdayTracker 只支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们很可能使用 @2x 缩放因子，这些设备使用的是 @3x 缩放因子。

对象在屏幕上的位置也是基于点数的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（见图 9-15）。我们将设置每个添加到视图控制器中的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在离屏幕边缘不远的地方，同时仍然为其文本输入框和其他标签及输入框留出足够的空间。在 Size Inspector 的 View 部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成此操作后，重复这些步骤，为“添加生日”视图控制器添加另外两个标签：姓氏标签和出生日期标签。我们需要定位其他标签和输入框，以确保它们不会重叠。在某些情况下，这可能会变得有些棘手，并且可能需要一些时间。对于这个应用程序，我们已经为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何使你的应用程序适配其他设备。表 9-1 列出了你应该为每个标签指定的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | x 位置 | y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们垂直对齐，但它们的 y 位置不同。每个标签的高度是 21，因此 y 位置必须至少比下一个最近的标签大 21 点。由于我们还将输入控件添加到每个标签下方，所以我们将 y 位置设得更大，以适应标签的高度和输入控件的高度。

很棒！现在你的故事板应该像图 9-16 一样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本框*，让你输入名字和姓氏。文本框是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本字段对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中的大小和位置设置这两个文本字段。你可以使用大小检查器，就像之前为标签做的一样。

表 9-2：视图控制器中的文本字段输入

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做*日期选择器*的控件。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器一样（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中选择日期时使用。*

日期选择器也可以仅显示时间，就像在时钟应用中设置闹钟时使用的日期选择器，或者仅显示日期，这就是我们在生日追踪器中将使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到出生日期标签下方的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的一些属性。点击日期选择器将其选中。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器会显示当前日期。让我们将这个日期改为你的生日！将日期字段从“当前日期”更改为**自定义**。当你这样做时，一个新框将出现。将日期改为你的生日。

让我们通过运行应用程序来测试目前的效果！我们为输入控件设置的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你点击生日视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这个布局在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，然后再次运行应用程序。你会发现界面显示得不太对劲。

你添加到故事板中的所有元素都会出现，但文本字段超出了屏幕边缘。现在你已经将所有元素放到屏幕上，接下来的步骤是确保它们能够适配任何屏幕尺寸。我们将通过一个名为*自动布局*的工具来实现这一点。

#### 通过自动布局让你的应用在每个设备上看起来完美

仅 iPhone 就有三种不同的屏幕尺寸，未来可能会有更多尺寸。你需要设计你的应用程序，使其在任何设备上看起来都很好。这意味着你需要让应用程序调整屏幕上所有元素的位置和大小，以适应运行该应用程序的设备。自动布局使用一种名为*布局约束*的东西来将元素放置到屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标来调出自动布局菜单。*

在屏幕故事板面板的底部，有一条带有图标的带状栏，位于“实用工具”面板之前的最右侧图标是一个位于两条竖线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，内容是“解决自动布局问题”。点击该图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这么做时，你会看到很多布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局使得日期选择器的大小适应屏幕宽度，不会超出边缘。自动布局还会确保每个文本字段前后各有 20 个点，这样它们就会在屏幕上居中显示。

现在在 iPhone 5s 模拟器上重新运行应用程序。这一次，“添加生日”页面应该显示得完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作“取消”和“保存”按钮。这些按钮现在还没有任何功能。我们只是先设置它们。在第十章中，我们将添加一些代码，使它们能够取消“添加生日”页面并将生日保存到应用中。

要添加“保存”按钮，从对象库中拖动一个“条形按钮项”并将其放置在导航栏的*右侧*。我们将把这个按钮改成“保存”按钮，就像我们之前将“添加”按钮改成一样。选择该按钮项，然后使用属性检查器将其更改为“保存”按钮。

最后，让我们添加“取消”按钮。从对象库中拖动另一个“条形按钮项”，这次将其放置在导航栏的*左侧*。使用属性检查器将其转换为“取消”按钮，就像您之前做的“保存”按钮一样。您的视图控制器应该像图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行您的应用，查看新按钮！

在生日表视图控制器上点击+按钮，应该会跳转到“添加生日”视图控制器，在那里您可以输入一个人的姓名和出生日期。点击“取消”和“保存”按钮目前没有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在这一章中，您开始制作一个 BirthdayTracker 应用，创建了“生日”和“添加生日”界面的基本用户界面。您还使用表视图控制器创建了“生日”屏幕，并使用户能够通过“添加”按钮和导航控制器在屏幕之间进行导航。

现在，您已经完成了应用的基本框架，接下来将在第十章中编写“取消”和“保存”按钮的程序代码，以便您可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

在大纲视图中选择**表视图控制器**。选择后，您需要使用 Xcode 菜单将表视图控制器嵌入到导航控制器中。转到**编辑** ▸ **嵌入到** ▸ **导航控制器**。

在表视图控制器被嵌入到导航控制器中之后，您的故事板应该像图 9-8 所示。导航控制器将作为一个屏幕出现在故事板中。

![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

每个视图控制器在故事板中代表应用中用户将看到的一个屏幕，但导航控制器有些不同。尽管它看起来像是故事板中的一个独立屏幕，实际上，导航控制器只是一个容器，包含用户在应用中之间切换的其他视图控制器。将一个视图控制器嵌入到导航控制器中，意味着您的应用可以从一个视图导航到另一个视图，并返回。

你应该在导航控制器和表视图控制器的顶部看到灰色的导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，并且可能还包含用户可以用来跳转到其他屏幕的按钮和箭头。为了使用导航栏来告诉用户他们所在的屏幕，我们需要给屏幕加上标题。现在是时候回到故事板上了。双击故事板的空白处以放大视图，然后滚动查看，以便你可以看到表视图控制器。要为表视图控制器添加标题，点击左侧大纲视图中的**Navigation Item**，该项位于**Table View Controller Scene**下。

![Image](img/Image00205.jpg)

选择此项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，所以在右侧的标题栏中输入**Birthdays**。你应该会看到，在你完成此步骤并按下 RETURN 后，大纲视图中的“Table View Controller Scene”条目会自动更新为“Birthdays Scene”。

接下来，我们将创建一个添加按钮，以便你可以添加生日！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将生日添加到该列表中。让我们做一个按钮，允许他们这样做！

我们需要在导航栏上添加一个按钮，跳转到“添加生日”场景，以便用户可以输入生日。在对象库中找到“Bar Button Item”，然后将其拖动到表视图控制器导航栏的右侧，如图 9-9 所示。

现在我们要把这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内置的添加按钮，我们可以使用。在属性检查器中，将条形按钮项的“System Item”更改为**Add**。你应该看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮被点击时该执行什么操作。我们希望它能够打开“添加生日”视图控制器，所以我们需要将添加按钮与该视图控制器连接起来。首先，双击故事板以缩小视图，确保你能够看到“生日”表视图控制器和最终会变成“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从加号按钮拖动到故事板右侧的空白视图控制器中。当视图控制器被高亮显示时松开鼠标。这将弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar Button Item 拖动到生日视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在出现的对话框中选择“Present Modally”。*

连接对话框为你提供了几种过渡方式的选择 —— 即从一个屏幕到另一个屏幕的过渡 —— 你希望在两个视图控制器之间进行哪种类型的过渡。点击连接对话框中的**模态呈现**选项。这将使视图控制器作为*模态*视图控制器显示到屏幕上。在 iPhone 上，模态视图控制器从手机底部出现，并且默认没有带返回按钮返回到上一个屏幕。相反，模态视图控制器可以有其他按钮，比如取消或保存。还有其他类型的过渡，如“Show”过渡，其中视图控制器从右侧推入屏幕，并且有一个返回按钮位于导航栏的左侧。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，应该以模态方式显示，并且包含一个取消按钮。否则，如果你使用类似“Show”过渡的方式，并带有返回按钮，可能会出现用户输入完所有内容后直接点击返回按钮，导致什么也没保存的情况！有了取消按钮，用户需要明确点击才能退出当前屏幕。

要查看模态输入视图控制器的良好示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧会有一个+按钮，点击后可以添加一个日历事件。点击+按钮会弹出一个模态的“新建事件”视图控制器。这个视图控制器的左侧有一个取消按钮，可以在不保存的情况下退出当前屏幕，右侧有一个添加按钮，可以在关闭模态前创建新事件。你会看到新事件模态从屏幕底部出现，关闭时会回到底部。我们希望用户能够保存生日，所以我们也会使用模态方式。

现在让我们尝试运行我们的应用，看看到目前为止做了什么！要运行应用，首先点击 Xcode 左上角的 BirthdayTracker 旁边列出的设备模拟器，选择一个设备（见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：设置模拟器将在 Xcode 窗口左上角的应用名称旁运行的设备。这里设备设置为 iPhone 7。*

这将显示一个设备选项列表供你选择运行应用的设备。我们选择的是 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键⌘ -**R**。

当模拟器打开运行你的应用时，如果它的大小太大，无法适应电脑屏幕，你可以调整其大小。点击模拟器进行选择，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用程序时不会发生太多变化。你应该能看到你的第一个生日屏幕，并且有一个+按钮，如图 9-1 中所示。显然，在这一点上，你的生日屏幕是空的。点击+按钮将会弹出第二个空白屏幕。查看完应用程序后，点击 Xcode 中的停止按钮来关闭它，停止按钮位于你之前按下的播放按钮旁边。当你停止应用程序时，你应该能看到应用程序图标出现在模拟器的主屏幕上！（参见图 9-12）。

就这样！现在我们需要配置第二个屏幕，使其可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用程序图标已添加到主屏幕。*

### 设置控件输入和标签

让我们通过添加标题来设计“添加生日”视图控制器。为此，你需要将它嵌入到自己的导航控制器中。当视图控制器是模态视图时，它不会继承已经在我们的故事板上的导航控制器的导航栏。导航控制器提供了导航栏，所以我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中点击选择普通的视图控制器。然后转到**编辑** ▸ **嵌入在** ▸ **导航控制器**。现在你应该能看到一个导航项已被添加到“视图控制器场景”下的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与你之前在为表视图控制器添加“生日”标题时所执行的步骤相同。

现在，当“添加生日”视图控制器出现在应用程序中时，它将在顶部显示其标题。

#### 添加你的朋友的名字和生日

当你在第十章中输入朋友的生日时，应用程序中的每个条目都会包含一个名字、一个姓氏和一个出生日期。让我们在“添加生日”视图控制器中添加一些*输入控件*，这样用户就可以为每个人输入所有这些信息。输入控件是诸如文本框或下拉菜单之类的组件，允许用户在应用程序中输入数据。我们将通过为用户可以添加的所有信息添加输入控件标签来开始。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器制作一个写着“名字”的标签。这个标签将放置在一个文本框旁边，你将在这里输入朋友的名字。从对象库中找到并将一个标签对象拖动到“添加生日”视图控制器上（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框，并输入**名字**作为显示文本，如图 9-14 所示。

现在，我们希望使用尺寸检查器设置标签的大小和位置。在 Xcode 的 storyboard 中，宽度和高度是以 *点* 为单位的。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点可能对应 1 像素、2×2 像素的方块或 3×3 像素的方块。这三种缩放因子分别称为 @1x、@2x 和 @3x（这与我们设置应用图标时提到的尺寸相同）。设备的点分辨率也不相同，宽度可能从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* 名字

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，而且你无法在这些设备上运行你的应用（BirthdayTracker 只支持 iOS 10 及更高版本）。除非你的 iPhone 或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，它们使用的是 @3x 缩放因子，否则你的设备可能使用的是 @2x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离（以点为单位）。(参见图 9-15)。我们将为添加到视图控制器中的每个库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，同时留出足够的空间给文本输入框和其他标签及输入框。在尺寸检查器的“视图”部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。将高度保留为 21。

完成此步骤后，重复这些步骤，在“添加生日”视图控制器中再添加两个标签：一个是“姓氏”标签，一个是“出生日期”标签。我们需要调整其他标签和输入框的位置，以确保它们不会重叠。在某些情况下，这可能会变得有些棘手，可能需要一些时间。对于这个应用程序，我们已经为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们会解释如何让你的应用程序适应其他设备。表 9-1 列出了你应为每个标签设置的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个标签至少大 21 个点。由于我们也在每个标签下方添加了输入控件，因此我们将 y 位置设置得更大，以便容纳标签的高度和输入控件的高度。

太棒了！现在你的故事板应该像图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器。*

接下来，你将添加两个*文本框*，它们允许你输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以在文本框中输入一行文字。

##### 添加文本框

从对象库中拖动两个文本框对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本框的大小和位置设置为表 9-2 中所示。你可以使用大小检查器，就像你为标签设置一样。

表 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个称为*日期选择器*的轮子。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的工具，用于让用户选择日期或时间。它可以包含日期和时间，就像日历应用中使用的日期选择器一样（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以只显示时间，就像时钟应用中用于添加闹钟的日期选择器一样，或者只显示日期，这正是我们在 BirthdayTracker 中使用的。

滚动浏览对象库，直到找到日期选择器，然后将其点击并拖动到出生日期标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。我们来将日期改为你的出生日期！将“日期”字段从“当前日期”更改为**自定义**。这样做时，一个新的框会出现。将此日期更改为你的出生日期。

让我们通过运行应用程序来测试目前的效果！我们为输入控件选择的大小在 iPhone 7 屏幕上显示得很好。因此，选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你在“生日”视图控制器上点击 + 按钮时，应该会显示“添加生日”界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上显示完美。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备呢？选择一个更小的模拟器来运行应用程序，比如 iPhone 5s，然后重新运行应用程序。你会看到，某些内容看起来不太对劲。

你添加到故事板中的所有元素都已经显示出来，但文本框超出了屏幕边缘。现在你已经将所有元素添加到屏幕上，下一步是让它们在任何屏幕尺寸上都能正确显示。我们将通过一个叫做*自动布局*的工具来实现这一点。

#### 使用自动布局让你的应用在每个设备上看起来完美

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能会出现更多尺寸。你需要设计你的应用程序，使其在任何设备上看起来都很不错。这意味着你需要让应用程序根据运行它的设备调整所有内容的位置和大小。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来调出自动布局菜单。*

屏幕的故事板面板底部有一个带图标的带状栏，位于工具区前面的最右侧图标是两个竖直线条之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击此图标，会弹出一份建议菜单。点击**添加缺失约束**。^(*) 做完这个，你会看到“添加生日”场景中添加了大量布局约束。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的宽度适配屏幕，不会超出边缘。自动布局还会确保每个文本字段前后都有 20 点的间距，这样它们会在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”屏幕应该显示完美无缺。

#### 添加保存和取消按钮

为了完成这部分内容，我们将向你展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。按钮现在还不会执行任何操作，我们只需要设置它们。在第十章中，我们将添加一些代码，使它们能够取消返回“添加生日”屏幕并保存生日到应用中。

为了添加保存按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮更改为保存按钮，就像我们做的添加按钮一样。选择按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左侧*。使用属性检查器将其转换为取消按钮，和之前设置保存按钮时一样。你的视图控制器应该像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新按钮的效果！

点击“生日”表格视图控制器上的 + 按钮应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。此时，点击取消和保存按钮不会执行任何操作——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用，通过创建“生日”和“添加生日”屏幕的基本用户界面。你还使用表格视图控制器创建了“生日”屏幕，并让用户可以通过添加按钮和导航控制器在屏幕之间导航。

现在你的应用程序的基本框架已经完成，在第十章中，你将编写代码来实现取消和保存按钮，这样你就可以在应用中添加和保存生日信息了！

* 在某些版本的 Xcode 中，"Add Missing Constraints"（添加缺失约束）选项被禁用。这是苹果的一个 Bug。在这种情况下，选择**Reset to Missing Constraints**（重置为缺失的约束）选项来添加缺失的约束。

在表格视图控制器嵌入到导航控制器后，你的故事板应该像图 9-8 中所示的那样。导航控制器将在故事板中显示为一个屏幕。

![图片](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表一个用户会看到的应用屏幕，但导航控制器略有不同。虽然它在故事板中看起来像是一个单独的屏幕，实际上导航控制器只是一个容器，保存了用户在应用中切换的其他视图控制器。将一个视图控制器嵌入导航控制器中意味着你的应用可以在不同视图之间导航并返回。

你应该能看到导航控制器和表视图控制器顶部有灰色的导航栏。当应用运行时，导航栏会告诉用户他们当前所在的屏幕标题，可能还包含用户可以用来跳转到其他屏幕的按钮和箭头。为了让导航栏告诉用户他们当前所在的屏幕，我们需要为屏幕设置标题。现在是时候重新放大故事板了。双击故事板的空白区域以放大视图，然后滚动视图，直到看到表视图控制器。要为表视图控制器添加标题，请在左侧的轮廓视图中点击**Navigation Item**（导航项）。

![Image](img/Image00205.jpg)

选中后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”（生日）作为标题，所以在右侧的标题字段中输入**Birthdays**。完成这一步并按下 RETURN 后，你会看到轮廓视图中的“Table View Controller Scene”条目自动更新为“Birthdays Scene”。

接下来，我们将制作一个添加按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将一个生日添加到列表中。让我们制作一个按钮，让他们可以做到这一点！

我们需要在导航栏中添加一个按钮，点击后可以进入添加生日的场景，以便用户输入生日。找到对象库中的“Bar Button Item”，然后将其拖动到表视图控制器导航栏的右侧，如图 9-9 所示。

现在，我们要将这个按钮改成一个添加按钮。幸运的是，Xcode 提供了一个内置的添加按钮供我们使用。在属性检查器中，将导航栏按钮的系统项（System Item）更改为**Add**（添加）。你应该能看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在点击时该做什么。我们希望它能打开“添加生日”视图控制器，所以我们需要将添加按钮连接到那个视图控制器。首先，双击 storyboard 以缩小视图，确保你能看到 Birthdays 表格视图控制器和最终将成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键并从 + 按钮拖动到 storyboard 右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标，这会弹出一个连接对话框，如 图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar Button 项拖动到 Birthdays 视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在弹出的对话框中选择 Present Modally。*

连接对话框为你提供了多个关于 *segue*（即从一个屏幕到另一个屏幕的过渡）的选项。点击连接对话框中的**Present Modally**选项。这将使视图控制器以 *模态* 视图控制器的形式展示在屏幕上。在 iPhone 上，模态视图控制器会从手机底部滑上屏幕，而且它不会自动带有返回按钮来返回到前一个屏幕。相反，模态视图可以有其他按钮，比如取消或保存。还有其他类型的 segue，比如 Show segue，它会将视图控制器从右侧推送到屏幕上，并且在导航栏的左侧带有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，这个屏幕应该以模态方式呈现，并且包含一个取消按钮。否则，如果你使用像 Show segue 这样的方式，并配有返回按钮，用户可能会在输入完所有内容后不小心点击返回按钮，导致数据没有被保存！有了取消按钮，用户必须刻意点击才能退出该屏幕。

要查看模态输入视图控制器的良好示例，请查看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏的右侧有一个 + 按钮，点击它可以添加日历事件。点击 + 按钮会弹出一个模态的“新建事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，在保存新事件后再关闭模态视图。你会看到，模态视图从底部滑上屏幕，关闭时又会滑回到底部。我们希望用户保存生日，所以我们也会使用模态视图。

现在，让我们试着运行应用，看看目前为止我们做了什么！要运行应用，首先通过点击 Xcode 左上角列出的设备，选择一个设备模拟器（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，应用名称旁边设置模拟器运行的设备。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键⌘ -**R**。

当模拟器打开并运行你的应用时，如果应用的大小太大，无法适应你的计算机屏幕，你可以调整其大小。点击模拟器以选中它，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时，没发生太多事情。你应该会看到你的第一个生日屏幕，并且有一个+按钮，如前面在图 9-1 中所示。显然，在此时，你的生日屏幕是空的。点击+按钮会弹出第二个空白屏幕。查看完你的应用后，通过点击 Xcode 中的停止按钮来关闭它，停止按钮位于你之前点击的播放按钮旁边。当你停止应用时，你现在应该能在模拟器的主屏幕上看到你的应用图标！（参见图 9-12）

就是这样！现在我们需要配置第二个屏幕，以便可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，你需要将其嵌入到自己的导航控制器中。当一个视图控制器是模态的时，它不会继承我们故事板中已经存在的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器来选择它。然后，进入**编辑器** ▸ **嵌入** ▸ **导航控制器**。现在，你应该会看到一个导航项被添加到视图控制器场景的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与你之前为表视图控制器添加“生日”标题时的步骤相同。

现在，当“添加生日”视图控制器出现在应用中时，它将在顶部显示标题。

#### 添加你朋友的名字和生日

当你在第十章输入朋友的生日时，应用中的每一项都会包含一个名字、一个姓氏和一个出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户能够为每个人输入这些信息。输入控件是像文本框或下拉菜单这样的控件，它们允许用户将数据输入到你的应用中。我们将从为所有用户可以添加的信息添加输入控件标签开始。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器制作一个显示“First Name”（名字）的标签。这个标签将位于一个文本框旁边，用户可以在其中输入朋友的名字。找到并将一个标签对象从对象库拖到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器中。*

接下来，改变标签的显示文本。在“属性检查器”中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们希望使用尺寸检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以*点（points）*为单位进行度量。请注意，1 个点并不等于 1 个像素。根据应用运行的设备类型，1 个点将转换为 1 个像素、2×2 像素的正方形或 3×3 像素的正方形。这三种缩放因子被称为@1x、@2x 和@3x（这就是我们在设置应用图标时讨论过的大小）。设备的点分辨率也不是都一样的，可能从 320 点到 1,024 点宽，568 点到 1,366 点高不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最旧型号的 iPhone 和 iPod 使用@1x 缩放因子，并且你将无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10+）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们使用的是@2x 缩放因子，只有这些型号使用@3x 缩放因子。

对象在屏幕上的位置也是基于点来设置的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（参见图 9-15）我们将为每个添加到视图控制器中的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们想要定位第一个标签，使其不位于屏幕边缘，但仍留出足够的空间给文本输入框和其他标签及输入项。在“尺寸检查器”的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。将高度保持为 21。

完成这些步骤后，重复上述步骤为“添加生日”视图控制器添加两个标签：一个是姓氏标签，一个是出生日期标签。我们需要调整其他标签和输入控件的位置，避免它们重叠。在某些情况下，这可能会变得有些棘手，并且需要一些时间。对于这个应用程序，我们已经为你计算了可以放置对象的位置，适用于 iPhone 7 屏幕。稍后，我们会解释如何让你的应用适配其他设备。表 9-1 列出了你应该给每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，这样它们就能垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置需要至少比下一个最近的标签大 21 个点。由于我们还将在每个标签下方添加输入控件，我们将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

太棒了！现在你的故事板应该和 图 9-16 中的样子一样。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已被添加到视图控制器中。*

接下来，你将添加两个 *文本字段*，让你可以输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。给这两个文本字段设置 表 9-2 中显示的大小和位置。你可以使用大小检查器来完成这一步，和设置标签时一样。

表 9-2：视图控制器中输入的文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加一个叫做 *日期选择器* 的控件，这样你就可以轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以包含日期和时间，就像在日历应用中使用的日期选择器一样（见 图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这就是我们在 BirthdayTracker 中使用的。

滚动浏览对象库，直到找到日期选择器，然后将其点击并拖动到出生日期标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器进行选择。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器会显示当前日期。让我们将这个日期改为你的出生日期吧！将日期字段从“当前日期”改为**自定义**。这样做后，会出现一个新的框，修改日期为你的出生日期。

让我们通过运行应用来测试到目前为止的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上适配得很好。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击生日视图控制器上的+按钮时，应该会显示“添加生日”页面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器来运行应用，例如 iPhone 5s，并再次运行应用。你会发现界面看起来不太对劲。

所有添加到故事板中的元素都已出现，但文本框超出了屏幕边缘。现在你已经将所有元素放到屏幕上，下一步是确保它们在任何屏幕尺寸上都能正确适配。我们将通过一个叫做*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上看起来完美，使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，未来可能会有更多尺寸。你需要设计应用，使其在任何设备上都能显示良好。这意味着你希望你的应用能够根据设备调整应用中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来在屏幕上放置元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部第四个图标，调出自动布局菜单。*

屏幕的故事板面板底部有一个包含图标的带状工具条，位于实用工具面板之前最右侧的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上时，它应该会显示一个标签，标明“解决自动布局问题”。点击此图标将弹出一个建议菜单。点击**添加缺失约束**。^(*) 当你这样做时，你会看到一堆布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，能够适应屏幕。例如，自动布局使得日期选择器的大小适应屏幕的宽度，且不会超出屏幕边缘。自动布局还会确保每个文本框前后各有 20 个点的间距，使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这次，“添加生日”界面应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成最后的步骤，我们将展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。这些按钮现在还不做任何事，我们只是设置它们。到第十章时，我们将添加一些代码，让它们能退出“添加生日”界面并将生日保存到应用中。

为了添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，正如我们为添加按钮所做的那样。选择该按钮项，然后使用属性检查器将其改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，正如你为保存按钮所做的那样。你的视图控制器应该看起来像图 9-21 所示。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新增的按钮！

点击生日表格视图控制器上的 + 按钮应该会将你带到“添加生日”视图控制器，在这里你可以输入一个人的姓名和出生日期。点击“取消”和“保存”按钮目前不会做任何事情——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你开始通过创建生日和添加生日屏幕的基本用户界面来制作一个 BirthdayTracker 应用程序。你还使用表格视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行切换。

现在你已经完成了应用程序的基本框架，在第十章中你将编写取消和保存按钮的代码，这样你就可以在应用程序中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用，这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。![Image](img/Image00204.jpg)

*图 9-8：导航控制器*

故事板中的每个视图控制器代表用户将看到的应用中的一个屏幕，但导航控制器有点不同。虽然它在故事板中看起来像是一个单独的屏幕，但导航控制器实际上只是一个容器，里面包含了用户在应用中切换的其他视图控制器。将一个视图控制器嵌入到导航控制器中意味着你的应用可以在一个视图和另一个视图之间导航。

你应该能在导航控制器和表视图控制器的顶部看到灰色的导航栏。当应用运行时，导航栏会告诉用户他们当前所在屏幕的标题，并可能包含按钮和箭头，用户可以用它们去其他屏幕。为了使用导航栏告诉用户他们所在的屏幕，我们需要为我们的屏幕命名。现在是回到故事板进行缩放的好时机。双击故事板的空白处以放大，然后滚动视图，直到你能看到表视图控制器。为了给表视图控制器添加标题，点击左侧轮廓视图中**表视图控制器场景**下的**导航项**。

![Image](img/Image00205.jpg)

选中该项后，你可以在右侧的属性检查器中输入屏幕的标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。你应该看到，在完成这一步并按下 RETURN 键后，轮廓视图中的“表视图控制器场景”条目自动更新为“生日场景”。

接下来，我们将创建一个“添加”按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并向该列表添加生日。让我们做一个按钮，让他们可以这样做！

我们需要在导航栏中添加一个按钮，用于进入“添加生日”场景，以便用户可以输入生日。找到对象库中的条形按钮项，然后将其拖放到表视图控制器导航栏的右侧，如图 9-9 所示。

现在我们要将这个按钮改成“添加”按钮。幸运的是，Xcode 自带了一个可以使用的“添加”按钮。在属性检查器中，将条形按钮项的系统项目改为**添加**。你应该看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在被点击时该做什么。我们希望它打开“添加生日”视图控制器，因此我们需要将添加按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你能看到“生日”表格视图控制器和最终会变成“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从 + 按钮拖到故事板右侧的空白视图控制器中间。当视图控制器被高亮显示时松开鼠标。这样会弹出一个连接对话框，就像图 9-10 中所示的那样。

![Image](img/Image00206.jpg)

*图 9-9：将一个条形按钮项拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在出现的对话框中选择“模态呈现”。*

连接对话框提供了几种选项，用于选择你想要在两个视图控制器之间进行的*过渡*——从一个屏幕到下一个屏幕的转换。点击连接对话框中的**模态呈现**选项。这将使视图控制器作为*模态*视图控制器显示在屏幕上。在 iPhone 上，模态视图控制器会从手机底部滑入屏幕，并且它默认没有返回按钮返回到上一屏幕。相反，模态视图控制器可以有其他按钮，如取消或保存。还有其他类型的过渡，比如显示过渡（Show segue），在这种过渡中，视图控制器会从右侧推入屏幕，并且会在导航栏的左侧显示一个返回按钮。

在 iOS 应用中，当你呈现一个用于获取和保存用户输入的屏幕时，屏幕应作为模态显示，并带有一个取消按钮。否则，如果你使用像显示过渡（Show segue）这样的方式，并且有返回按钮，用户可能会输入所有内容后点击返回按钮，却没有保存任何内容！而带有取消按钮的模态视图要求用户必须刻意点击取消按钮才能退出屏幕。

要查看一个模态输入视图控制器的好例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，用于在关闭模态视图之前创建新事件。你应该注意到，新事件模态视图是从屏幕底部滑入的，然后在关闭时再次滑回底部。我们希望用户保存生日，因此我们也将使用模态视图。

现在让我们尝试运行我们的应用，看看目前为止我们做了什么！要运行应用，首先选择一个设备模拟器，方法是点击 Xcode 左上角的设备列表旁边的设备（参见 图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设备设置为 iPhone 7，显示在应用名称旁边。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择的是 iPhone 7\。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果它太大而无法适应你的电脑屏幕，你可以调整其大小。点击模拟器以选中它，然后转到 **Window** ▸ **Scale**，在模拟器菜单中选择一个较小的比例。

到目前为止，运行应用时并不会发生太多变化。你应该能看到第一个“生日”屏幕，屏幕上有一个 + 按钮，正如之前在 图 9-1 中所示。显然，此时你的“生日”屏幕将是空的。点击 + 按钮将弹出第二个空白屏幕。查看完应用后，通过点击 Xcode 中的停止按钮（它位于你之前点击的播放按钮旁边）来关闭应用。当你停止应用时，你应该会看到你的应用图标出现在模拟器的主屏幕上！（参见 图 9-12）。

就是这样！接下来我们需要配置第二个屏幕，以便它可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到一个自己的导航控制器中。当视图控制器是模态时，它不会继承我们在故事板中已有的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的纯视图控制器来选择它。然后转到 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在，你应该能在视图控制器场景下的轮廓视图中看到一个新的导航项。点击这个新的导航项，然后在属性检查器中添加标题 **添加生日**。这些步骤与之前在表视图控制器中添加“生日”标题时相同。

现在，当“添加生日”视图控制器出现在应用中时，它的标题将显示在顶部。

#### 添加你的朋友的名字和生日

当你在 第十章 中输入朋友的生日时，应用中的每条记录都会包含名字、姓氏和出生日期。让我们在“添加生日”视图控制器中添加一些 *输入控件*，以便用户可以为每个人输入这些信息。输入控件就是让用户在应用中输入数据的元素，比如文本框或下拉菜单。我们将首先添加所有用户可以输入信息的输入控件标签。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“First Name”的标签。这个标签将放在一个文本框旁边，用户将在其中输入朋友们的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器上（见 图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name** 作为显示文本，如 图 9-14 所示。

现在，我们想使用大小检查器来设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以 *点* 为单位进行测量。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点可能会转换为 1 像素、一个 2×2 像素的方块，或者一个 3×3 像素的方块。这三个缩放因子分别称为 @1x、@2x 和 @3x（这些大小也正是我们在设置应用图标时讨论过的）。不同设备的点分辨率并不相同，宽度可能从 320 点到 1,024 点不等，高度可能从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，而且你无法在这些设备上运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的 iPhone 6 Plus、6s Plus 或 7 Plus 使用 @3x 缩放因子，否则你的手机或 iPod 可能使用 @2x 缩放因子。

一个物体在屏幕上的位置也是基于点的。物体的 x 位置是从屏幕左侧到物体左侧的距离（以点为单位）。y 位置是从屏幕顶部到物体顶部的距离。（见 图 9-15）。我们将为添加到视图控制器的每个库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上物体的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置为不在屏幕边缘，但仍然要留出足够的空间给其文本输入框以及其他标签和输入框。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成这些操作后，重复这些步骤，在“添加生日”视图控制器中再添加两个标签：一个是姓氏标签，另一个是出生日期标签。我们需要调整其他标签和输入控件的位置，以避免它们重叠。在某些情况下，这可能会变得棘手并且需要一些时间。对于这个应用，我们已为你计算出在 iPhone 7 屏幕上放置控件的位置。稍后，我们将解释如何让你的应用适配其他设备。表 9-1 列出了你应该为每个标签设置的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你会看到所有标签的 x 位置相同，这样它们就会垂直对齐，但它们的 y 位置不同。每个标签的高度为 21，因此 y 位置需要至少比下一个最接近的标签高 21 个点。由于我们也将在每个标签下方添加输入控件，因此我们将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

很好！现在你的故事板应该看起来像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入的标签已添加到视图控制器。*

接下来，你将添加两个*文本框*，它们允许你输入名字和姓氏。文本框是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本框对象到视图控制器上。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中所示的尺寸和位置调整这两个文本框。你可以使用大小检查器进行调整，就像你调整标签一样。

表 9-2：视图控制器中的文本框输入

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个叫做*日期选择器*的滚轮。这将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，允许用户选择日期或时间。它可以包含日期和时间，就像日历应用中使用的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器选择日期。*

日期选择器还可以只显示时间，就像在时钟应用中用于设置闹钟的日期选择器，或者只显示日期，这就是我们将在 BirthdayTracker 中使用的功能。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到生日标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器进行选择。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。我们来将这个日期改为你的生日日期吧！将日期字段从当前日期更改为**自定义**。这样，新的框会出现。将这个日期更改为你的生日日期。

让我们通过运行应用来测试目前的效果！我们使用的输入控件大小在 iPhone 7 屏幕上非常合适。所以，选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击生日视图控制器上的+按钮时，应该会显示添加生日的界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来不错，但其他设备呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，并再次运行应用。你会发现界面看起来有些不对劲。

所有你添加到故事板的元素都显示出来了，但文本字段超出了屏幕边缘。现在你已经将所有元素添加到屏幕上，下一步是让它们能够正确适配任何屏幕尺寸。我们将通过一个叫做*自动布局*的工具来完成这一点。

#### 通过自动布局让你的应用在每个设备上都能完美显示

单独的 iPhone 就有三种不同的屏幕尺寸，未来可能会有更多的尺寸。你需要设计你的应用，让它在任何设备上都能看起来很好。这意味着你希望你的应用能够调整所有元素的位置和大小，以适应运行该应用的设备。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕故事板面板的底部，有一个带有图标的带状工具条，位于工具面板左侧的最右边图标是一个夹在两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击该图标，会弹出一个建议菜单。点击**添加缺失约束**。^(*) 做到这一点后，你会看到一大堆布局约束被添加到添加生日场景中。

这些自动布局约束确保每个元素都能正确调整大小，以适应屏幕。例如，自动布局使得日期选择器的大小适应屏幕的宽度，不会超出边界。自动布局还确保每个文本字段前后各有 20 点的间距，以便它们在屏幕上居中显示。

现在，在 iPhone 5s 模拟器上再次运行应用程序。这次，添加生日屏幕应该看起来完美。

#### 添加保存和取消按钮

为了完成工作，我们将展示如何为添加生日视图控制器的导航栏添加取消和保存按钮。按钮暂时不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们可以取消并保存生日。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们做添加按钮一样。选择该按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，并将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你做保存按钮一样。你的视图控制器应与图 9-21 所示的相同。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新增的按钮！

点击生日表视图控制器上的 + 按钮应该会带你进入添加生日视图控制器，在这里你可以输入一个人的名字和出生日期。点击取消和保存按钮暂时不会做任何操作——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你通过创建生日和添加生日屏幕的基本用户界面，开始了生日跟踪器应用的制作。你还使用表视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用程序的基本框架，接下来将在第十章中编程处理取消和保存按钮，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择**Reset to Missing Constraints**（重置为缺失约束）选项来添加缺失的约束。

*图 9-8：导航控制器*

故事板中的每个视图控制器代表用户在应用中看到的一个屏幕，但导航控制器稍有不同。尽管它看起来像是故事板中的一个独立屏幕，但导航控制器实际上只是一个容器，用于存放用户在应用中切换的其他视图控制器。将一个视图控制器嵌入导航控制器中意味着你的应用可以在不同视图之间进行导航并返回。

你应该能在导航控制器和表视图控制器的顶部看到灰色的导航栏。当应用运行时，导航栏会告诉用户他们所在屏幕的标题，并可能包含可以用于前往其他屏幕的按钮和箭头。为了使用导航栏告诉用户他们在哪个屏幕上，我们需要为我们的屏幕添加标题。现在是时候在故事板中进行缩放了。双击故事板的空白区域以进行缩放，然后滚动视图以查看表视图控制器。要为表视图控制器添加标题，请在左侧的大纲视图中点击**Navigation Item**（导航项）下的**Table View Controller Scene**（表视图控制器场景）。

![图片](img/Image00205.jpg)

选中此项后，你可以在右侧的属性检查器中为屏幕输入一个标题。我们希望导航栏显示“Birthdays”（生日）作为标题，因此在右侧的标题字段中输入**Birthdays**（生日）。完成此步骤并按下 RETURN 后，你应该会看到大纲视图中的“Table View Controller Scene”项自动更新为“Birthdays Scene”。

接下来，我们将制作一个“添加”按钮，以便你可以添加生日！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并向列表中添加一个生日。让我们创建一个按钮，让他们能够这么做！

我们需要在导航栏上添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。在对象库中找到“Bar Button Item”，然后将其拖放到表视图控制器的导航栏右侧，如图 9-9 所示。

现在我们要将这个按钮转换为“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮可以使用。在属性检查器中，将“bar button item”的系统项更改为**Add**（添加）。你应该看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在被点击时要做什么。我们希望它打开“添加生日”视图控制器，因此我们需要将添加按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你可以看到生日表格视图控制器和将最终成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键并从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标，这时会弹出一个连接对话框，类似于图 9-10。

![图片](img/Image00206.jpg)

*图 9-9：将一个栏按钮项拖到生日视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在出现的对话框中选择“以模态方式呈现”。*

连接对话框为你提供了几种类型的*segue*（从一个屏幕到下一个屏幕的过渡方式）选项。点击连接对话框中的**以模态方式呈现**选项。这将使视图控制器作为*模态*视图控制器呈现到屏幕上。在 iPhone 上，模态视图控制器会从屏幕底部滑入，并且不会自动带有返回按钮返回到上一屏幕。相反，模态视图控制器可以有其他按钮，例如取消或保存。还有其他类型的 segue，比如 Show segue，其中视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个屏幕用于获取和保存用户输入时，这个屏幕应该作为一个模态呈现，并配有取消按钮。否则，如果你使用类似 Show segue 并带有返回按钮的方式，可能会发生用户输入所有内容后，点击返回按钮而没有保存任何信息的情况！有了取消按钮，用户必须刻意点击才能取消并退出屏幕。

要查看一个模态输入视图控制器的良好示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧会有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮会弹出一个模态的“新建事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，在关闭模态视图之前创建新的事件。你会发现“新建事件”模态从屏幕底部滑入，并在关闭时滑回去。我们希望用户能够保存生日，因此我们也会使用模态。

现在让我们尝试运行我们的应用，看看我们到目前为止做了些什么！首先，选择一个设备模拟器，在 Xcode 左上角的 BirthdayTracker 旁边的设备列表中点击选择（见 图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角应用名称旁边设置模拟器要运行的设备。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表用于运行你的应用。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮，或使用快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果应用窗口过大而无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器选择它，然后前往 **Window** ▸ **Scale** 并在模拟器菜单中选择较小的缩放比例。

到目前为止，运行应用时没有发生太多变化。你应该能看到你的第一个“Birthdays”屏幕，并带有一个 + 按钮，如之前 图 9-1 所示。显然，此时你的“Birthdays”屏幕是空的。点击 + 按钮将弹出第二个空白屏幕。当你看完应用后，通过点击 Xcode 中的停止按钮来关闭它，该按钮位于你之前点击的播放按钮旁边。当你停止应用时，你现在应该能看到你的应用图标出现在模拟器的主屏幕上！（见 图 9-12）。

就这样！我们现在需要配置第二个屏幕，以便可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，你需要将其嵌入一个导航控制器。当视图控制器是模态视图时，它不会继承我们故事板中已经存在的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入它自己的导航控制器中。通过点击故事板中的视图控制器来选择它，然后前往 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在你应该会看到一个导航项已添加到视图控制器场景下的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题 **Add a Birthday**。这些步骤与当你为表视图控制器添加“Birthdays”标题时是相同的。

现在，当应用中出现“添加生日”视图控制器时，它将显示在顶部带有标题的标签。

#### 添加朋友的姓名和生日

当你在第十章中输入朋友的生日时，应用程序中的每条记录将包含名字、姓氏和出生日期。让我们在“添加生日”视图控制器中添加一些*输入控件*，以便用户为每个人输入所有这些信息。输入控件是让用户向应用程序输入数据的元素，比如文本框或下拉菜单。我们将通过添加用户可以输入的所有信息的输入控件标签来开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“First Name”的标签。这个标签将位于一个文本框旁边，用于输入你朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们希望使用尺寸检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*为单位的。请注意，1 点不等于 1 像素。根据应用程序运行的设备类型，1 点将转换为 1 像素、2×2 像素的方形或 3×3 像素的方形。这三种缩放因子分别称为@1x、@2x 和@3x（这些尺寸与我们设置应用图标时谈到的相同）。设备的点分辨率也不相同，宽度可以从 320 到 1,024 点，长度可以从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最老款的 iPhone 和 iPod 使用@1x 缩放因子，而这些设备无法运行你的应用程序（BirthdayTracker 只支持 iOS 10 及以上版本）。除非你的 iPhone 6 Plus、6s Plus 或 7 Plus 使用@3x 缩放因子，否则你的手机或 iPod 很可能使用@2x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（见图 9-15）。我们将设置每个库对象在视图控制器中的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕的中间，而不是屏幕的边缘，同时为其文本输入框和其他标签及输入框留出足够的空间。在尺寸检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成这个步骤后，重复这些操作，为“添加生日”视图控制器再添加两个标签：一个是姓氏标签，另一个是出生日期标签。我们需要定位其他标签和输入框，以确保它们不会重叠。在某些情况下，这可能会变得复杂，并且需要一些时间。对于这个应用程序，我们已经为你计算出了适合 iPhone 7 屏幕的对象位置。稍后，我们将解释如何使你的应用程序适配其他设备。表格 9-1 列出了每个标签应设置的尺寸和位置。

表格 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，这样它们就能垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，所以 y 位置需要比下一个最接近的标签至少大 21 个点。由于我们还将在每个标签下方添加输入控件，所以我们增加了 y 位置的值，以便容纳标签的高度和输入控件的高度。

太好了！现在你的故事板应该和 图 9-16 中的样子一样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个 *文本框*，它们将让你输入名字和姓氏。文本框是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘将自动弹出，用户可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本框对象到视图控制器中。一个用来输入名字，另一个用来输入姓氏。为这两个文本框设置 表格 9-2 中所示的尺寸和位置。你可以使用尺寸检查器，就像为标签设置尺寸一样。

表格 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个被称为 *日期选择器* 的控件。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中使用的日期选择器一样（见 图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中，日期选择器用于添加事件时选择日期。*

日期选择器也可以仅显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这也是我们在 BirthdayTracker 中使用的方式。

滚动对象库，直到找到一个日期选择器，然后点击并拖动它到“出生日期”标签下的视图控制器中。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的生日！将日期字段从当前日期更改为**自定义**。更改后，一个新的框会出现，设置日期为你的生日。

让我们通过运行应用来测试到目前为止的效果！我们为输入控件设置的尺寸在 iPhone 7 屏幕上非常合适。所以，选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你点击“出生日期”视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

在 iPhone 7 上效果很好，但其他设备呢？选择一个更小的模拟器来运行应用，比如 iPhone 5s，再次运行应用。你会发现，界面看起来有些不对劲。

所有你添加到故事板中的元素都会显示出来，但文本框超出了屏幕边缘。现在你已经将所有元素放在屏幕上，接下来的步骤是确保它们能够适配任何屏幕尺寸。我们将使用一个名为*自动布局*的工具来完成这项工作。

#### 使用自动布局让你的应用在每个设备上都完美显示

iPhone 本身就有三种不同的屏幕尺寸，而且未来可能还会推出更多尺寸。你需要设计你的应用，以便它在任何设备上都能显示得很好。这意味着你需要让你的应用调整所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的方式来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的概览视图中选择**视图控制器**。接着，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，弹出自动布局菜单。*

在屏幕故事板面板的底部，有一个带有图标的带状工具条，位于实用工具面板之前的最右侧是一个位于两条垂直线之间的三角形图标。将鼠标光标悬停在该图标上，它会显示一个标签，显示“解决自动布局问题”。点击此图标，弹出建议菜单。点击**添加缺失约束**。^(*) 当你这样做时，你会看到大量的布局约束被添加到添加生日场景中。

这些自动布局约束确保每个元素的尺寸正确，以适应屏幕。例如，自动布局使得日期选择器的宽度适配屏幕，不会超出边缘。自动布局还会确保每个文本字段前后都有 20 个点，以便它们在屏幕上居中。

现在在 iPhone 5s 模拟器上再次运行应用程序。这次，添加生日屏幕应该完美显示。

#### 添加保存和取消按钮

为了完成这项工作，我们将向你展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。这些按钮目前还不会执行任何操作。我们只是设置它们。在第十章，我们会添加一些代码，使它们可以取消添加生日屏幕并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们之前处理添加按钮一样。选择按钮项，然后使用属性检查器将其改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左侧*。使用属性检查器将其改为取消按钮，就像你做保存按钮时一样。你的视图控制器应该像图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新的按钮！

点击生日表视图控制器上的 + 按钮，应该会进入添加生日视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前还不会有任何效果——我们将在第十章中实现它们！

### 你学到的内容

在本章中，你通过创建生日和添加生日屏幕的基本用户界面，开始制作一个 BirthdayTracker 应用程序。你还使用表视图控制器创建了生日屏幕，并让用户可以通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用程序的基本框架，接下来将在第十章中编写取消和保存按钮的代码，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束的选项是禁用的。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项以添加缺失的约束。

故事板中的每个视图控制器代表用户将看到的应用程序中的一个屏幕，但导航控制器有些不同。尽管它在故事板中看起来像是一个单独的屏幕，但导航控制器实际上只是一个容器，用来保存用户在应用程序中切换的其他视图控制器。将视图控制器嵌入导航控制器中，意味着你的应用程序可以在不同的视图之间导航，并可以返回。

你应该看到导航控制器和表格视图控制器顶部有灰色的导航栏。当应用程序运行时，导航栏会告诉用户他们所处屏幕的标题，并可能包含他们可以用来导航到其他屏幕的按钮和箭头。为了让导航栏告诉用户他们当前所在的屏幕，我们需要为我们的屏幕添加标题。现在是时候放大故事板了。在故事板的空白处双击以放大视图，然后滚动视图，直到你能看到表格视图控制器。要为表格视图控制器添加标题，点击左侧大纲视图中的**导航项**，位于**表格视图控制器场景**下。

![Image](img/Image00205.jpg)

当选择此项时，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的标题字段中输入**Birthdays**。完成此步骤并按下 RETURN 后，你应该看到大纲视图中的表格视图控制器场景条目自动更新为 Birthdays Scene。

接下来，我们将制作一个“添加”按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用程序，查看他们的生日列表，并向列表中添加一个生日。让我们做一个按钮，允许他们这样做！

我们需要在导航栏中添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。在对象库中找到“Bar Button Item”，然后将其拖动到表格视图控制器导航栏的右侧，如图 9-9 所示。

现在我们要把这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮供我们使用。在属性检查器中，将条形按钮项的系统项更改为**添加**。你应该会看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮在点击时应该执行什么操作。我们希望它打开“添加生日”视图控制器，所以我们需要将“添加”按钮连接到那个视图控制器。首先，双击故事板以缩小视图，确保你能看到“生日”表格视图控制器和最终会变成“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，然后从 + 按钮拖动到故事板右侧的空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标。这样就会弹出一个连接对话框，类似于图 9-10 中所示的对话框。

![Image](img/Image00206.jpg)

*图 9-9：将一个条形按钮项拖到生日视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在出现的对话框中选择“模态呈现”。*

连接对话框为你提供了几种不同的*过渡*方式——即从一个屏幕到另一个屏幕的转换——你可以选择两者视图控制器之间的过渡方式。在连接对话框中点击**模态呈现**选项。这会使视图控制器以*模态*视图控制器的形式呈现出来。在 iPhone 上，模态视图控制器会从屏幕底部滑上来，而且它不会自动带有返回按钮来返回上一个屏幕。相反，模态视图控制器可以有其他按钮，比如取消或保存。还有其他类型的过渡，比如显示过渡（Show segue），在这种过渡中，视图控制器从右侧推送到屏幕上，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，应该以模态形式展示，并且带有取消按钮。否则，如果你使用类似显示过渡（Show segue）并带有返回按钮的方式，可能会出现用户输入完所有信息后，点击返回按钮而没有保存任何内容的情况！如果有取消按钮，用户就必须明确点击取消才能退出屏幕。

要查看模态输入视图控制器的一个好的示例，可以查看你 iPhone 或 iPad 上的日历应用。当你打开它时，你会看到导航栏右侧有一个 + 按钮，你可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，用于在关闭模态之前创建新事件。你应该看到新事件模态视图控制器从屏幕底部滑上来，当它被关闭时又滑回去。我们希望用户能保存生日信息，所以我们也会使用模态视图。

现在让我们尝试运行应用，看看目前为止我们做了什么！要运行应用，首先点击 Xcode 左上角的设备列表，选择一个设备模拟器（参见 图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角，紧挨着应用名称的地方设置模拟器运行的设备。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。在选择了模拟器后，点击左上角的播放按钮，或使用键盘快捷键 ⌘ -**R**。

当模拟器打开并运行应用时，如果设备屏幕过大而无法适应电脑显示器，你可以调整其大小。点击模拟器以选中它，然后前往 **窗口** ▸ **缩放**，在模拟器菜单中选择一个更小的缩放比例。

到目前为止，运行应用时并没有太多变化。你应该能看到第一个“生日”屏幕，并且上面有一个 + 按钮，如 图 9-1 所示。显然，到这个阶段，你的“生日”屏幕将是空的。点击 + 按钮会弹出第二个空白屏幕。查看完应用后，通过点击 Xcode 中的停止按钮（在你之前点击的播放按钮旁边）来关闭应用。当你停止应用时，你应该能在模拟器的主屏幕上看到你的应用图标！（参见 图 9-12）。

就这样！我们现在需要配置第二个屏幕，使其可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，首先为其添加标题。为此，你需要将其嵌入到一个自己的导航控制器中。当视图控制器是模态视图时，它不会继承我们故事板上已有的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。在故事板中点击选择空白的视图控制器。然后前往 **编辑** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该能看到在视图控制器场景下的大纲视图中添加了一个导航项。点击这个新的导航项，然后在属性检查器中为其添加标题 **添加生日**。这些步骤与当你为表视图控制器添加标题“生日”时所遵循的步骤相同。

现在，当“添加生日”视图控制器出现在应用中时，它将显示在顶部带有标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每一条记录都会包括一个名字、姓氏和生日。让我们为“添加生日”视图控制器添加一些*输入控件*，这样用户就可以为每个人输入这些信息了。输入控件是像文本框或下拉菜单这样的组件，让用户能够在应用中输入数据。我们将首先添加所有信息的输入控件标签。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个标签，显示“First Name”。这个标签将位于一个文本框旁边，用于输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框，并输入**First Name**作为显示文本，如图 9-14 所示。

现在我们希望使用 Size Inspector 来设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点（points）*为单位测量的。注意，1 点并不是 1 像素。根据应用运行的设备类型，1 点可能对应 1 像素、2×2 像素的方块，或者 3×3 像素的方块。这三种缩放因子分别称为 @1x、@2x 和 @3x（这些与我们设置应用图标时所讨论的相同）。设备的点分辨率也各不相同，宽度范围从 320 到 1,024 点，长度范围从 568 到 1,366 点。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最旧型号的 iPhone 和 iPod 使用 @1x 的缩放因子，你将无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，这些设备使用 @3x 缩放因子，否则你的手机或 iPod 都使用 @2x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 坐标是对象左侧到屏幕左侧的距离，y 坐标是对象顶部到屏幕顶部的距离。（参见图 9-15）。我们将为每个添加到视图控制器的库对象设置 x 坐标和 y 坐标。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 坐标、y 坐标、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，但仍然留出足够的空间给其文本输入框以及其他标签和输入框。在 Size Inspector 的视图部分，将 x 坐标设置为 20，y 坐标设置为 100，宽度设置为 100，保持高度为 21。

完成后，重复这些步骤，再为“添加生日”视图控制器添加两个标签：一个是姓氏标签，一个是出生日期标签。我们需要调整其他标签和输入框的位置，以避免它们重叠。在某些情况下，这可能会变得有些棘手，并且可能需要一些时间。对于这个应用，我们已经为你计算出了在 iPhone 7 屏幕上的位置。稍后，我们会解释如何让你的应用在其他设备上运行。表 9-1 列出了每个标签应该放置的大小和位置。

表 9-1：视图控制器中的输入标签设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，这样它们就垂直对齐了，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个标签的 y 位置至少大 21 个点。由于我们还在每个标签下方添加了输入控件，因此我们将 y 位置设置得更大，以容纳标签的高度和输入控件的高度。

太棒了！现在你的故事板应该像 图 9-16 中的那样。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个 *文本框*，它们让你输入名字和姓氏。文本框是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本框控件到视图控制器中。一个用于输入名字，另一个用于输入姓氏。将两个文本框的大小和位置设置为 表 9-2 中的值。你可以通过“大小检查器”来完成这项操作，就像你设置标签时做的那样。

表 9-2：视图控制器中的文本框输入

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做 *日期选择器* 的控件。这个控件让你可以轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以包含日期和时间，就像在日历应用中使用的日期选择器一样（参见 图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器来选择日期。*

日期选择器也可以只显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到出生日期标签下的视图控制器。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的几个属性。点击选择日期选择器，然后在属性检查器中，将日期选择器的模式设置为显示**日期**而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。我们来将这个日期改为你的出生日期！将日期字段从当前日期改为**自定义**。这样，一个新框将会出现。将日期修改为你的出生日期。

让我们测试一下应用到目前为止的效果！我们为输入控件所使用的尺寸在 iPhone 7 屏幕上显示得很好。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你点击出生日期视图控制器上的+按钮时，应该会显示添加生日的屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很好，但其他设备怎么样呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，然后重新运行应用。你会看到界面看起来不太对。

所有添加到故事板中的元素都会出现，但文本字段超出了屏幕边缘。现在所有元素都已经显示在屏幕上，下一步是让它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上看起来都完美——使用自动布局

单单是 iPhone 就有三种不同的屏幕尺寸，而且未来可能还会有更多尺寸。你会希望设计的应用能够在任何设备上都能良好显示。这意味着你需要让你的应用根据设备的不同自动调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：添加自动布局约束，通过点击编辑器底部的第四个图标来打开自动布局菜单。*

屏幕故事板面板的底部有一个带有图标的带状栏，位于实用工具面板之前的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击此图标以显示一系列建议。点击**添加缺失的约束**。^(*) 做这件事时，你会看到一堆布局约束被添加到了添加生日场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适应屏幕宽度，并且不会超出屏幕边缘。自动布局还确保每个文本框前后有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，添加生日屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将教你如何为添加生日视图控制器的导航栏制作取消和保存按钮。这些按钮目前不会执行任何操作。我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消添加生日屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个栏按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮更改为保存按钮，就像我们为添加按钮所做的那样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个栏按钮项，并将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新按钮！

点击生日表视图控制器中的+按钮应该会带你进入添加生日视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前不会有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你通过创建生日和添加生日界面的基本用户界面，开始制作一个 BirthdayTracker 应用。你还使用表视图控制器创建了生日屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本框架，第十章将教你如何编程实现取消和保存按钮，以便在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束的选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **Reset to Missing Constraints** 选项来添加缺失的约束。

你应该能看到导航控制器和表视图控制器顶部有灰色的导航栏。当应用运行时，导航栏会告诉用户他们当前所在的屏幕标题，并且可能还会包含可以用来跳转到其他屏幕的按钮和箭头。为了使用导航栏告诉用户他们在哪个屏幕上，我们需要为屏幕添加标题。现在是放大回故事板的好时机。双击故事板中的空白区域进行放大，然后滚动视图以便可以看到表视图控制器。要为表视图控制器添加标题，请在左侧大纲视图中点击 **Navigation Item**，它位于 **Table View Controller Scene** 下。

![Image](img/Image00205.jpg)

选择该项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“Birthdays”作为标题，因此在右侧的 Title 字段中输入 **Birthdays**。完成此步骤并按下 RETURN 后，你应该能看到大纲视图中的 Table View Controller Scene 自动更新为 Birthdays Scene。

接下来，我们将制作一个添加按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将生日添加到列表中。让我们制作一个按钮，让他们能够做到这一点！

我们需要在导航栏中添加一个按钮，用于跳转到 Add a Birthday 场景，以便用户可以输入生日。找到 Object Library 中的 Bar Button Item，并将其拖放到表视图控制器导航栏的右侧，如图 9-9 所示。

现在，我们希望将此按钮转变为添加按钮。幸运的是，Xcode 提供了一个内置的 Add 按钮，我们可以使用它。在属性检查器中，将 bar button item 的 System Item 更改为 **Add**。你应该看到按钮变成了一个加号 (+)。

接下来，我们需要告诉按钮在点击时执行什么操作。我们希望它能够打开 Add a Birthday 视图控制器，因此我们需要将添加按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你可以同时看到 Birthdays 表视图控制器和最终将成为 Add a Birthday 视图控制器的空白视图控制器。按住 CONTROL 键，并从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标。这时会弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar Button Item 拖到 Birthdays 视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在出现的对话框中选择“Present Modally”。*

连接对话框提供了几种 *segue* 类型的选项 —— 从一个屏幕过渡到下一个屏幕。点击连接对话框中的 **Present Modally** 选项。这将使视图控制器作为 *模态* 视图控制器显示在屏幕上。在 iPhone 上，模态视图控制器会从手机底部滑入，并且默认没有返回上一屏幕的返回按钮。相反，模态视图可以有其他按钮，如取消或保存。还有其他类型的 segue，例如 Show segue，其中视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当您展示一个获取和保存用户输入的屏幕时，应该以模态视图的形式呈现，并带有一个取消按钮。否则，如果使用类似 Show segue 的过渡并带有返回按钮，可能会出现用户输入完所有内容后，点击返回按钮而没有保存任何内容的情况！有了取消按钮，用户必须刻意点击才能退出屏幕。

要查看一个良好的模态输入视图控制器示例，请查看 iPhone 或 iPad 上的日历应用。当您打开它时，导航栏右侧有一个 + 按钮，您可以点击它以添加日历事件。点击 + 按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以不保存直接退出屏幕；右侧有一个添加按钮，可以在关闭模态视图前创建新事件。您应该看到，模态的“新事件”视图是从屏幕底部滑入的，取消时它会向下滑出。我们希望用户能保存生日，因此我们也将使用模态视图。

现在让我们尝试运行应用，看看到目前为止我们做了什么！要运行应用，首先通过点击 Xcode 左上角的 BirthdayTracker 旁边列出的设备来选择一个设备模拟器（见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，将模拟器的设备设置为靠近您应用程序名称的位置。这里，设备设置为 iPhone 7。*

这将显示一个设备选项列表，用于运行您的应用。我们选择 iPhone 7。选择完模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R**。

当模拟器打开并运行应用时，如果模拟器的大小太大以至于无法适应您的计算机屏幕，您可以调整其大小。点击模拟器以选择它，然后前往 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时，并不会发生太多事情。你应该能看到你的第一个生日界面，其中有一个加号按钮，如图 9-1 所示。显然，在这个时候，你的生日界面将是空的。点击加号按钮会弹出第二个空白页面。查看完你的应用后，通过点击 Xcode 中的停止按钮来关闭应用，停止按钮位于你之前点击的播放按钮旁边。当你停止应用时，你现在应该能在模拟器的主屏幕上看到你的应用图标！(参见图 9-12)。

就这样！我们现在需要配置第二个屏幕，以便它可以用于添加生日！

![图片](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控件输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到自己的导航控制器中。当一个视图控制器是模态的，它不会继承我们在故事板中已经设置的导航控制器中的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击故事板中的视图控制器，选择该视图控制器。然后进入**Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在你应该能在视图控制器场景下的轮廓视图中看到添加了一个导航项。点击这个新添加的导航项，然后在属性检查器中添加标题**Add a Birthday**。这些步骤和你在为表格视图控制器添加“Birthdays”标题时所遵循的步骤是一样的。

现在，当“添加生日”视图控制器在应用中出现时，顶部会显示其标题。

#### 添加朋友的姓名和生日

当你在第十章中输入朋友的生日时，应用中的每一条记录都会包含名字、姓氏和生日日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件包括文本字段或下拉菜单等，允许用户将数据输入到应用中。我们将从为用户可以添加的所有信息添加输入控件标签开始。

##### 添加并定位标签

让我们为“添加生日”视图控制器制作一个标签，标签内容为“First Name”。这个标签将位于一个文本字段旁边，你将在文本字段中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（参见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在我们要使用“大小检查器”设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以 *点* 为单位进行测量的。请注意，1 个点并不等于 1 像素。根据你的应用程序运行的设备类型，1 个点可能转换为 1 像素、一个 2×2 像素的方块，或一个 3×3 像素的方块。这三种缩放因子分别称为 @1x、@2x 和 @3x（这与我们设置应用图标时讨论的大小相同）。不同的设备也有不同的点分辨率，宽度范围从 320 点到 1,024 点不等，高度范围从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* 姓名

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，而且你将无法在这些型号上运行你的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的 iPhone 或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，它们使用 @3x 缩放因子，否则你的手机或 iPod 可能使用 @2x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离，以点为单位。y 位置是从屏幕顶部到对象顶部的距离。（请参见 图 9-15。）我们将为每个添加到视图控制器中的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置为：它不在屏幕的边缘，但仍为其文本输入框和其他标签及输入框留出足够的空间。在“大小检查器”的“视图”部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成此操作后，重复这些步骤，为“添加生日”视图控制器添加两个标签：姓氏标签和出生日期标签。我们需要调整其他标签和输入框的位置，以避免它们重叠。在某些情况下，这可能会变得有些棘手，并且需要一些时间。对于这个应用程序，我们已经为你计算出放置对象的最佳位置，适用于 iPhone 7 屏幕。稍后，我们将解释如何让你的应用程序支持其他设备。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们在垂直方向上对齐，但它们的 y 位置各不相同。每个标签的高度为 21，所以 y 位置需要比下一个最接近的标签至少大 21 个点。由于我们也在每个标签下方添加了输入控件，所以我们增加了 y 位置，以适应标签的高度和输入控件的高度。

很好！现在你的故事板应该像图 9-16 中显示的那样。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本框*，它们将允许你输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本框对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。给这两个文本框设置表 9-2 中看到的大小和位置。你可以使用大小检查器，就像你为标签做的一样。

表 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个被称为*日期选择器*的控件。它将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用程序中用于允许用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像日历应用中使用的日期选择器一样（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，使用日期选择器进行日期选择。*

日期选择器也可以仅显示时间，就像在时钟应用中用于添加闹钟的日期选择器一样，或者仅显示日期，这也是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到出生日期标签下的视图控制器中。使用大小检查器，将 x 位置设为 0，y 位置设为 280。

你需要调整日期选择器的几个属性。点击选择日期选择器。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。我们来将这个日期改为您的出生日期吧！将日期字段从“当前日期”更改为**自定义**。这样会出现一个新框，您可以将其日期更改为您的出生日期。

让我们通过运行应用来测试到目前为止的效果！我们为输入控件设置的尺寸适合 iPhone 7 屏幕。因此，选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当您点击生日视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器运行应用程序，比如 iPhone 5s，然后再次运行应用程序。您会发现，屏幕上的内容看起来不太对劲。

您添加到故事板中的所有元素都会显示出来，但文本框超出了屏幕边缘。现在，您已经将所有元素放置在屏幕上，下一步是让它们能够正确适应任何屏幕尺寸。我们将通过一种叫做*自动布局*的工具来实现这一点。

#### 让您的应用在每个设备上看起来完美无缺，使用自动布局

单独的 iPhone 就有三种不同的屏幕尺寸，而且未来可能还会出现更多尺寸。您需要设计您的应用程序，使其在任何设备上看起来都很不错。这意味着您需要让应用程序调整其中所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的东西来将元素放置到屏幕上。您需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕的故事板窗格底部有一个带有图标的带状工具栏，位于工具面板之前的最右侧的图标是两个垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击此图标，弹出建议菜单。点击**添加缺失的约束**。^(*) 当您这样做时，您会看到在“添加生日”场景中添加了一大堆布局约束。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的宽度适应屏幕，并不会超出屏幕边缘。自动布局还会确保每个文本字段前后各有 20 个点，从而使其在屏幕上居中。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”屏幕应该显示完美无缺。

#### 添加保存和取消按钮

为了完成最后的工作，我们将向你展示如何为“添加生日”视图控制器的导航栏添加“取消”和“保存”按钮。此时，这些按钮不会有任何作用，我们只是将它们设置好。在第十章中，我们将添加一些代码，使它们能够取消“添加生日”屏幕并保存生日到应用中。

要添加“保存”按钮，从对象库中拖动一个“条形按钮项”并将其放置在导航栏的 *右侧*。我们将把这个按钮改为“保存”按钮，就像我们为“添加”按钮所做的那样。选择该按钮项，然后使用属性检查器将其设置为“保存”按钮。

最后，让我们添加“取消”按钮。从对象库中拖动另一个“条形按钮项”，这次将其放置在导航栏的 *左侧*。使用属性检查器将其设置为“取消”按钮，就像你为“保存”按钮所做的那样。你的视图控制器应该看起来像图 9-21 所示的样子。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新按钮的效果！

在生日表格视图控制器上点击 + 按钮应该会带你到“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击“取消”和“保存”按钮目前没有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你开始创建一个生日追踪应用，首先设计了“生日”和“添加生日”屏幕的基本用户界面。你还使用表格视图控制器创建了“生日”屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用程序的基本框架，在第十章中，你将编写“取消”和“保存”按钮的代码，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择 **重置为缺失约束** 选项以添加缺失的约束。![Image](img/Image00205.jpg)

选择此选项后，你可以在右侧的属性检查器中输入屏幕的标题。我们希望导航栏显示“生日”作为标题，因此在右侧的标题字段中输入**生日**。你应该看到，完成此步骤并按下 RETURN 后，轮廓视图中的“表格视图控制器”条目会自动更新为“生日视图”。

接下来，我们将创建一个“添加”按钮，让你可以添加生日！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并向该列表中添加一个生日。让我们制作一个按钮，允许他们这么做！

我们需要向导航栏添加一个按钮，跳转到“添加生日”场景，这样用户就可以输入生日了。在对象库中找到条形按钮项，然后将其拖放到表格视图控制器导航栏的右侧，如图 9-9 所示。

现在我们要将这个按钮转换为一个“添加”按钮。幸运的是，Xcode 提供了一个内建的“添加”按钮，我们可以使用。在属性检查器中，将条形按钮项的系统项更改为**添加**。你应该看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮在点击时应该做什么。我们希望它打开“添加生日”视图控制器，因此我们需要将添加按钮与该视图控制器连接起来。首先，双击故事板以缩小视图，确保你能看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 并从加号按钮拖动到故事板右侧的空白视图控制器中。当视图控制器被高亮显示时松开鼠标。这将弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将条形按钮项拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖到相邻的视图控制器，并在弹出的对话框中选择“以模态方式呈现”。*

连接对话框为你提供了几种选择，用于决定在两个视图控制器之间进行的*过渡*——从一个屏幕到下一个屏幕的过渡方式。点击连接对话框中的**以模态方式呈现**选项。这样，视图控制器将作为*模态*视图控制器显示在屏幕上。在 iPhone 上，模态视图控制器从手机底部进入屏幕，并且它默认没有返回按钮来返回到上一个屏幕。相反，模态视图控制器可以有其他按钮，比如取消或保存。有其他类型的过渡，例如“显示”过渡，在这种过渡中，视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，应该将该屏幕作为模态显示，并带有一个取消按钮。否则，如果你使用类似于 Show 转场并带有返回按钮的方式，可能会出现用户输入完所有内容后，点击返回按钮却没有保存任何数据的情况！而如果有取消按钮，用户必须故意点击取消才能退出该屏幕。

要查看模态输入视图控制器的良好示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏的右侧有一个 + 按钮，点击它可以添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，用于退出该屏幕而不保存，右侧有一个添加按钮，用于在关闭模态视图之前创建新事件。你应该会看到，新事件模态视图是从屏幕底部滑入的，关闭时会滑回去。我们希望用户能够保存生日，所以我们也会使用模态。

现在让我们尝试运行我们的应用，看看到目前为止我们做了些什么！首先，通过点击 Xcode 左上角的设备列表，选择一个设备模拟器来运行应用（见 图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角，设置模拟器将运行的设备，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用程序。我们选择的是 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R**。

当模拟器启动并运行你的应用时，如果它的尺寸过大而无法适应你的计算机屏幕，你可以调整其大小。点击模拟器以选择它，然后进入 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用时并没有发生太多事情。你应该能看到第一个 Birthdays 屏幕，上面有一个 + 按钮，如之前在 图 9-1 中所示。显然，在这一点上，你的 Birthdays 屏幕将是空的。点击 + 按钮会弹出第二个空白屏幕。当你查看完应用后，通过点击 Xcode 中的停止按钮关闭它，该按钮位于你之前按下的播放按钮旁边。当你停止应用时，应该会在模拟器的主屏幕上看到你的应用图标！（见 图 9-12）

就是这样！现在我们需要配置第二个屏幕，以便可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控件输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到一个单独的导航控制器中。当一个视图控制器是模态的时，它不会继承我们故事板上已经存在的导航控制器中的导航栏。导航控制器提供了一个导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击故事板中的普通视图控制器来选择它。然后进入**编辑** ▸ **嵌入在** ▸ **导航控制器**。现在，你应该看到在“视图控制器场景”下的轮廓视图中添加了一个导航项。点击这个新导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与当你为表格视图控制器添加“生日”标题时的操作相同。

现在，当“添加生日”视图控制器出现在应用中时，它将在顶部显示标题。

#### 添加你朋友的姓名和生日

当你在第十章中输入朋友的生日时，你的应用中每一项记录都会包含一个名字、一个姓氏和一个出生日期。让我们在“添加生日”视图控制器中添加一些*输入控件*，这样用户就可以为每个人输入所有这些信息。输入控件是像文本框或下拉菜单这样的元素，允许用户向你的应用中输入数据。我们将通过添加用户可以添加的所有信息的输入控件标签来开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个写着“名字”的标签。这个标签将位于一个文本框旁边，你可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在我们希望使用“大小检查器”设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以*点*为单位进行测量。请注意，1 个点并不等于 1 个像素。根据应用运行的设备类型，1 个点将转换为 1 个像素、2×2 像素的正方形或 3×3 像素的正方形。这三种缩放因子分别称为@1x、@2x 和@3x（我们在设置应用图标时提到过的相同尺寸）。设备的点分辨率也不相同，宽度范围从 320 到 1024 点，长度范围从 568 到 1366 点。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* 名字

只有最旧的 iPhone 和 iPod 型号使用 @1x 缩放因子，并且您将无法在这些型号上运行您的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非您的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus（它们使用 @3x 缩放因子），否则您的设备很可能使用 @2x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离。（见 图 9-15。）我们将设置添加到视图控制器的每个库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕上，使其不在屏幕边缘，但仍然为其文本输入字段以及其他标签和输入留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。将高度保留为 21。

完成这些步骤后，重复这些操作，将两个标签添加到“添加生日”视图控制器：一个姓氏标签和一个出生日期标签。我们需要调整其他标签和输入的位置，以确保它们不重叠。在某些情况下，这可能会变得有些棘手，可能需要一些时间。对于这个应用，我们已经为您计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何使您的应用适配其他设备。表 9-1 列出了您应该为每个标签设置的大小和位置。

表 9-1：视图控制器中的输入标签设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

您可以看到，所有标签的 x 位置相同，以便它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个最近的标签高至少 21 个点。由于我们也在每个标签下方添加了输入控件，因此我们将 y 位置设得更大，以便同时容纳标签的高度和输入控件的高度。

太棒了！现在您的故事板应该像 图 9-16 中的那样。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器。*

接下来，您将添加两个 *文本字段*，它们允许您输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本字段时，键盘将自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段设置为表格 9-2 中所示的大小和位置。你可以使用大小检查器，和设置标签时一样进行操作。

表格 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个叫做*日期选择器*的控件。它将帮助你轻松地输入生日。

##### 添加日期选择器

日期选择器是 iOS 应用程序中允许用户选择日期或时间的标准工具。它可以包含日期和时间，就像在日历应用中使用的日期选择器一样（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器在日历应用中用于事件添加时的日期选择。*

日期选择器还可以只显示时间，像在时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这就是我们在生日追踪器中将使用的方式。

在对象库中滚动，直到你找到一个日期选择器，然后将它点击并拖动到出生日期标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将这个日期改成你的生日！将日期字段从当前日期改为**自定义**。这样一个新框将会出现，修改日期为你的生日。

让我们通过运行应用程序来测试它目前的功能！我们为输入控件使用的大小非常适合 iPhone 7 的屏幕。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你点击生日视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很好，但其他设备呢？选择一个更小的模拟器来运行应用，比如 iPhone 5s，然后再次运行应用。你会看到效果看起来不太对劲。

所有添加到故事板中的元素都会出现，但文本框超出了屏幕边缘。现在，所有元素都已经添加到屏幕上，接下来的步骤是确保它们在任何屏幕尺寸上都能正确显示。我们将使用一个名为*自动布局*的工具来完成这一点。

#### 通过自动布局使你的应用在每个设备上都看起来完美

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会有更多尺寸。你需要设计你的应用程序，使其在任何设备上都看起来很好。这意味着，你的应用程序需要调整界面中所有元素的位置和大小，以适应设备的屏幕。自动布局使用名为*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部第四个图标来打开自动布局菜单。*

屏幕故事板面板的底部有一个带图标的条带，在实用工具面板前的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该显示一个标签，写着“解决自动布局问题”。点击此图标以弹出建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到许多布局约束已添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适合屏幕宽度，并且不会超出边缘。自动布局还会确保每个文本框前后有 20 个点的间距，以使它们在屏幕上居中。

现在，再次在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”屏幕应该看起来完美。

#### 添加保存和取消按钮

最后，我们将展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。此时，这些按钮还没有功能。我们只是将它们设置好。在第十章中，我们将添加代码，使它们能够取消并退出“添加生日”界面，或将生日保存到应用程序中。

要添加“保存”按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮变成一个“保存”按钮，就像我们之前做的“添加”按钮一样。选择按钮项，然后使用属性检查器将其转变为“保存”按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，然后这次将其放置在导航栏的*左侧*。使用属性检查器将其转换为取消按钮，方法与创建保存按钮时相同。你的视图控制器应该像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新按钮的效果！

点击生日表格视图控制器上的+按钮应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前还没有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在这一章中，你通过创建生日和添加生日屏幕的基本用户界面，开始制作一个 BirthdayTracker 应用。你还使用表格视图控制器创建了生日屏幕，并让用户通过添加按钮和导航控制器在屏幕之间切换。

现在你已经完成了应用的基本框架，接下来将在第十章中编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项是禁用的。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

选择这个选项后，你可以在右侧的属性检查器中为屏幕输入标题。我们希望导航栏显示“生日”作为标题，所以在右侧的标题字段中输入**生日**。完成此步骤并按 RETURN 后，你会看到大纲视图中的表格视图控制器场景项自动更新为“生日场景”。

接下来，我们将创建一个添加按钮，让你能够添加生日！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并将生日添加到列表中。让我们创建一个按钮，让他们可以实现这一功能！

我们需要在导航栏中添加一个按钮，指向“添加生日”场景，这样用户就可以输入生日。找到对象库中的条形按钮项，然后将其拖动并放置到表格视图控制器导航栏的右侧，如图 9-9 所示。

现在，我们想将这个按钮变成添加按钮。幸运的是，Xcode 提供了一个内置的添加按钮。使用属性检查器，将条形按钮项的系统项目改为**添加**。你应该会看到按钮变成一个加号（+）。

接下来，我们需要告诉按钮在被点击时应该做什么。我们希望它打开“添加生日”视图控制器，因此我们需要将添加按钮连接到该视图控制器。首先，双击故事板进行缩小，确保你可以同时看到生日表格视图控制器和将最终成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键并从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时，松开鼠标。这将弹出一个连接对话框，类似于 图 9-10 中的对话框。

![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar Button 项目拖到生日视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在弹出的对话框中选择 Present Modally。*

连接对话框会给你几个选择，关于你想在两个视图控制器之间进行的 *segue*——从一个屏幕到下一个屏幕的过渡。点击连接对话框中的 **Present Modally** 选项。这将使视图控制器作为 *模态* 视图控制器从屏幕底部弹出。在 iPhone 上，模态视图控制器会从屏幕底部滑入，并且不会自动带有返回按钮返回到上一屏幕。相反，模态视图控制器可以有其他按钮，如取消或保存。还有其他类型的 segue，比如 Show segue，在这种情况下，视图控制器从右侧推到屏幕上，并且导航栏左侧有返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，应该将该屏幕作为模态展示，并带有一个取消按钮。否则，如果你使用像 Show segue 这样带有返回按钮的方式，用户可能会输入所有内容后点击返回按钮，却没有保存任何东西！有了取消按钮，用户必须故意点击它来退出屏幕。

要查看一个好的模态输入视图控制器的示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，用于取消并退出屏幕而不保存，右侧有一个添加按钮，用于在关闭模态之前创建新事件。你应该看到新事件模态从屏幕底部弹出，并在关闭时再向下消失。我们希望用户保存生日，所以我们也会使用模态。

现在让我们尝试运行应用，看看到目前为止我们做了些什么！首先，选择一个设备模拟器，在 Xcode 左上角点击列出的设备（参见 图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，在应用名称旁边设置模拟器将运行的设备。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择的是 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果它太大而无法适应你的电脑屏幕，你可以调整其大小。点击模拟器以选择它，然后选择 **Window** ▸ **Scale**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时，并不会发生太多事情。你应该能看到第一个生日屏幕，里面有一个 + 按钮，如之前在 图 9-1 中所示。显然，这时你的生日屏幕是空的。点击 + 按钮会弹出第二个空白屏幕。查看完应用后，点击 Xcode 中的停止按钮（位于之前按下的播放按钮旁边）关闭应用。停止应用时，你应该会在模拟器的主屏幕上看到你的应用图标！（参见 图 9-12。）

就这样！现在我们需要配置第二个屏幕，使其能够用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，并添加其标题。为此，你需要将其嵌入到一个独立的导航控制器中。当视图控制器是模态视图时，它不会继承我们在故事板上已有的导航控制器中的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。在故事板中点击选择普通视图控制器，然后选择 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在你应该会看到一个导航项被添加到视图控制器场景下的提纲视图中。点击这个新的导航项，然后在属性检查器中添加标题 **添加生日**。这些步骤与你之前给表格视图控制器添加标题“生日”时的操作是一样的。

现在，当“添加生日”视图控制器在应用中出现时，它会在顶部显示其标题。

#### 添加你朋友的名字和生日

当你在 第十章 中输入朋友的生日时，应用中的每个条目将包含一个名字、一个姓氏和一个生日。让我们向“添加生日”视图控制器添加一些 *输入控件*，以便用户为每个人输入所有这些信息。输入控件是类似文本字段或下拉菜单的控件，允许用户在应用程序中输入数据。我们将从添加用户可以输入的所有信息的输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个显示“First Name”的标签。这个标签将位于文本框旁边，用户将在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器（参见 图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，修改标签的显示文本。在“属性检查器”中，点击标签文本框并输入 **First Name** 作为显示文本，如 图 9-14 所示。

现在，我们想通过“大小检查器”来设置标签的大小和位置。在 Xcode 的 storyboard 中，宽度和高度是以 *点* 为单位进行测量的。请注意，1 点并不是 1 像素。根据应用程序运行的设备类型，1 点可能对应 1 像素、2×2 像素的方块，或者 3×3 像素的方块。这三种缩放因子被称为 @1x、@2x 和 @3x（我们在设置应用程序图标时讨论过相同的大小）。设备的点分辨率也并不完全相同，宽度从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最旧款的 iPhone 和 iPod 使用 @1x 缩放因子，而且你无法在这些设备上运行你的应用程序（BirthdayTracker 仅支持 iOS 10 及更高版本）。除非你的设备是 iPhone 6 Plus、6s Plus 或 7 Plus，这些设备使用 @3x 缩放因子，否则你的手机或 iPod 使用的是 @2x 缩放因子。

物体在屏幕上的位置也是基于点的。物体的 x 位置是从屏幕左侧到物体左侧的距离（以点为单位）。y 位置是从屏幕顶部到物体顶部的距离。（参见 图 9-15）。我们将设置每个库对象在视图控制器中添加时的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上物体的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕边缘之外，但仍为其文本输入框以及其他标签和输入框留出足够的空间。在“大小检查器”的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。将高度保留为 21。

完成后，重复这些步骤，再向“添加生日”视图控制器添加两个标签：姓氏标签和出生日期标签。我们需要调整其他标签和输入框的位置，以确保它们不会重叠。在某些情况下，这可能会比较棘手，并且需要一些时间。对于这个应用，我们已经为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何使你的应用适配其他设备。表 9-1 列出了每个标签应设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，因此它们在垂直方向上对齐，但它们的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个标签的 y 位置高至少 21 个点。由于我们还要在每个标签下方添加输入控件，因此我们增加了 y 位置的值，以便同时容纳标签的高度和输入控件的高度。

很棒！现在你的故事板应该像图 9-16 中的那样。

![图片](img/Image00214.jpg)

*图 9-16：已向视图控制器添加了输入框标签。*

接下来，你将添加两个*文本框*，用于输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以输入一行文本。

##### 添加文本框

从对象库中拖动两个文本框对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本框的大小和位置设置为表 9-2 中所示。你可以像设置标签那样使用大小检查器来完成这一步。

表 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个元素是一个叫做*日期选择器*的控件。它将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的工具，允许用户选择日期或时间。它可以同时包含日期和时间，就像日历应用中使用的日期选择器一样（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以只显示时间，比如在时钟应用中用于设置闹钟的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中将使用的方式。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到生日标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器会显示当前日期。让我们将这个日期改为你的出生日期吧！将日期字段从“当前日期”更改为**自定义**。这样做后，一个新框将会出现。将这个日期更改为你的出生日期。

让我们通过运行应用程序来测试一下目前的功能！我们为输入控件设置的大小非常适合 iPhone 7 屏幕。因此，选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击生日视图控制器上的+按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![图片](img/Image00218.jpg)

在 iPhone 7 上看起来不错，但其他设备怎么样？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，然后重新运行应用程序。你会看到一些地方显示得不太对劲。

你在故事板中添加的所有元素都已显示，但文本字段超出了屏幕的边缘。现在你已经将所有元素放在屏幕上，接下来的步骤是让它们在任何屏幕尺寸下都能正确适配。我们将使用一个名为*自动布局*的工具来完成这个工作。

#### 在每个设备上通过自动布局使你的应用完美呈现

单独的 iPhone 有三种不同的屏幕尺寸，并且未来可能会推出更多尺寸。你需要设计应用程序，以确保它在任何设备上看起来都很合适。这意味着，你希望应用程序能够根据运行它的设备调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（参见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来调出自动布局菜单。*

在屏幕故事板的下方有一个包含图标的带状工具栏，位于“实用工具”面板前的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该显示一个标签，说明是“解决自动布局问题”。点击该图标会弹出一组建议菜单。点击**添加缺失的约束**。^(*)当你这样做时，你会看到一大堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适合屏幕，并不会超出屏幕边缘。自动布局还确保每个文本字段前后都有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”屏幕应该看起来完美。

#### 添加保存和取消按钮

为了完成这部分内容，我们将向你展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。按钮目前不会执行任何操作，我们只是将它们设置好。在第十章中，我们将添加一些代码，使它们能够取消“添加生日”屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“条形按钮项”并将其放置在导航栏的*右侧*。我们将把这个按钮改成一个保存按钮，就像我们之前做的添加按钮一样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，我们来添加取消按钮。从对象库中再拖动一个“条形按钮项”，这次将其放置在导航栏的*左侧*。使用属性检查器将其更改为取消按钮，就像你做保存按钮时一样。你的视图控制器应该看起来像图 9-21 所示。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新按钮的效果！

点击生日表视图控制器上的+按钮应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前什么也不会发生——我们将在第十章中实现这两个功能！

### 你学到了什么

在这一章中，你开始通过创建“生日”和“添加生日”屏幕的基本用户界面，制作了一个 BirthdayTracker 应用。你还使用表视图控制器创建了“生日”屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本框架，接下来你将在第十章中编写代码，来实现取消和保存按钮，让你能够在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用，这是一个苹果的 bug。在这种情况下，选择“**重置为缺失约束**”选项来添加缺失的约束。

接下来，我们将创建一个添加按钮，这样你就可以添加生日了！

#### 添加按钮

我们希望用户能够打开应用，查看他们的生日列表，并向列表中添加一个生日。让我们做一个按钮，允许他们执行这个操作！

我们需要在导航栏中添加一个按钮，通向“添加生日”场景，这样用户就可以输入生日。找到对象库中的条形按钮项，然后将其拖放到表视图控制器的导航栏的右侧，如图 9-9 所示。

现在，我们想把这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮可以使用。在属性检查器中，将条形按钮项的系统项更改为**添加**。你应该看到按钮变成了一个加号（+）。

接下来，我们需要告诉按钮点击时应该做什么。我们希望它能打开“添加生日”视图控制器，所以我们需要将添加按钮与该视图控制器连接起来。首先，双击故事板进行缩小，确保你可以看到“生日”表视图控制器和将来成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键并从加号按钮拖到故事板右侧的空白视图控制器中间。当视图控制器高亮时松开鼠标。这样就会弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个条形按钮项拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到相邻的视图控制器，并在出现的对话框中选择“以模态方式呈现”。*

连接对话框提供了几种选择，来设置你想要在两个视图控制器之间做的*过渡*——从一个屏幕到下一个屏幕的转换。点击连接对话框中的**以模态方式呈现**选项。这将使视图控制器以*模态*视图控制器的形式显示在屏幕上。在 iPhone 上，模态视图控制器会从手机底部进入屏幕，而且它通常不会自动带有返回按钮以返回到前一个屏幕。相反，模态视图可以有其他按钮，比如取消或保存。还有其他类型的过渡，比如“显示”过渡，在这种过渡中，视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，屏幕应该以模态方式展示，并且带有一个取消按钮。否则，如果你使用像“显示”过渡并带有返回按钮，用户可能会输入所有内容后直接点击返回按钮而没有保存任何东西！有了取消按钮，用户必须故意点击它才能退出该屏幕。

要查看一个很好的模态输入视图控制器的例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个加号按钮，你可以点击它来添加日历事件。点击加号按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，用于创建新事件并关闭模态视图。你会看到，新事件模态视图会从屏幕底部弹出，关闭时则会向下收起。我们希望用户能够保存生日，因此我们也将使用模态视图。

现在让我们尝试运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先点击 Xcode 左上角的设备列表中列出的设备模拟器（参见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角设置模拟器将运行的设备，设备名称旁边就是你的应用名称。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮，或者使用快捷键⌘ -**R**。

当模拟器打开以运行你的应用时，如果屏幕太大而无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器以选择它，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个更小的比例。

到目前为止，当你运行应用程序时，并没有发生太多事情。你应该看到你的第一个“生日”屏幕，上面有一个加号按钮，如之前在图 9-1 中所示。显然，在这一点上，你的“生日”屏幕是空的。点击加号按钮会弹出第二个空白屏幕。查看完应用程序后，点击 Xcode 中的停止按钮来关闭它，停止按钮就在你之前按下的播放按钮旁边。当你停止应用程序时，你应该能在模拟器的主屏幕上看到你的应用图标！（参见图 9-12。）

就是这样！现在我们需要配置第二个屏幕，以便它可以用来添加生日！

![图片](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已经添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到一个独立的导航控制器中。当视图控制器是模态时，它不会继承已经在 storyboard 上的导航控制器中的导航栏。导航控制器提供了导航栏，所以我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击 storyboard 中的普通视图控制器来选择它。然后，进入 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在，你应该会看到一个新的导航项已被添加到视图控制器场景的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**Add a Birthday**。这些步骤和你当初在为表视图控制器添加标题“Birthdays”时所做的相同。

现在，当“添加生日”视图控制器出现在应用中时，它的顶部将标有标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用程序中的每个条目将包含一个名字、一个姓氏和一个出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件是指像文本字段或下拉菜单这样的元素，允许用户在应用中输入数据。我们将从为用户可以添加的所有信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个显示“First Name”（名字）的标签。这个标签将位于一个文本字段旁边，用户可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在我们希望使用尺寸检查器设置标签的大小和位置。在 Xcode 的 storyboard 中，宽度和高度是以*点*为单位进行测量的。请注意，1 点不等于 1 像素。根据应用运行的设备类型，1 点可能转换为 1 像素、2×2 像素的方块，或者 3×3 像素的方块。这三种缩放因子分别被称为 @1x、@2x 和 @3x（这些和我们设置应用图标时讨论的尺寸相同）。不同设备的点分辨率也不完全相同，宽度从 320 到 1,024 点不等，高度从 568 到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，而且你无法在这些型号上运行你的应用程序（BirthdayTracker 将仅支持 iOS 10 及更高版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们大概率使用的是 @2x 缩放因子，这些设备使用的是 @3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是屏幕左侧到对象左侧的距离，y 位置是屏幕顶部到对象顶部的距离。（参见图 9-15。）我们将为每个添加到视图控制器的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位到不在屏幕边缘的位置，同时仍然为其文本输入框和其他标签与输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成这些步骤后，重复这些步骤，在“添加生日”视图控制器中再添加两个标签：一个姓氏标签和一个出生日期标签。我们需要将其他标签和输入框定位好，以确保它们不会重叠。在某些情况下，这可能会变得有些棘手，可能需要一些时间。对于这个应用，我们已经为你计算出了可以放置对象的位置，假设你使用的是 iPhone 7 屏幕。稍后，我们将解释如何让你的应用适应其他设备。表 9-1 列出了每个标签应该设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有的标签具有相同的 x 位置，这样它们就能垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置需要比下一个最近的标签大至少 21 个点。由于我们在每个标签下方也添加了输入控件，所以我们将 y 位置设置得更大，以便容纳标签和输入控件的高度。

很棒！现在你的故事板应该像图 9-16 中的那样。

![Image](img/Image00214.jpg)

*图 9-16：输入的标签已经添加到视图控制器中。*

接下来，你将添加两个*文本框*，允许你输入姓氏和名字。文本框是 UITextField 类的一个 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表格 9-2 中的尺寸和位置设置这两个文本字段。你可以使用尺寸检查器，和之前设置标签时一样。

表格 9-2：视图控制器中的文本字段输入

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个叫做*日期选择器*的控件。它将帮助你轻松输入生日日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的日期或时间选择工具。它可以同时显示日期和时间，就像日历应用中使用的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以仅显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中将要使用的。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到出生日期标签下的视图控制器中。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整一些日期选择器的属性。点击选择日期选择器。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将此日期更改为你的生日！将日期字段从“当前日期”更改为**自定义**。这样，一个新框将出现。将此日期更改为你的生日。

让我们通过运行应用来测试目前为止的工作效果！我们使用的输入控件尺寸在 iPhone 7 屏幕上适配得很好。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击生日视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个更小的模拟器来运行应用，比如 iPhone 5s，再次运行应用。你会发现效果看起来不太对劲。

所有你添加到故事板中的元素都已显示，但文本框超出了屏幕的边缘。现在你已经将所有元素放到屏幕上，下一步是确保它们能够适应任何屏幕大小。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 使用自动布局让你的应用在每个设备上看起来完美

单独的 iPhone 就有三种不同的屏幕尺寸，未来可能会有更多的尺寸。你需要设计你的应用，以确保它在任何设备上看起来都很不错。这意味着你希望你的应用能够调整界面中所有元素的位置和大小，以适应应用运行的设备。自动布局使用了一种叫做*布局约束*的机制来安排屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的提纲视图中选择**视图控制器**。接着，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕故事板面板的底部，有一个带图标的功能区，位于实用工具面板之前的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，内容为“解决自动布局问题”。点击这个图标，会弹出一系列建议菜单。点击**添加缺失的约束**。^(*) 当你这么做时，你会看到大量的布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕宽度，并且不会超出边界。自动布局还会确保每个文本框前后有 20 个点的间距，以便它们能够在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这一次，“添加生日”屏幕应该完美显示。

#### 添加保存和取消按钮

为了完成这些工作，我们将向你展示如何为“添加生日”视图控制器的导航栏制作“取消”和“保存”按钮。按钮目前还没有任何功能。我们只是先进行设置。在第十章中，我们会添加一些代码，使它们可以取消“添加生日”屏幕并将生日保存到应用中。

要添加保存按钮，拖动一个“条形按钮项”从对象库中放置到导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们之前做的“添加”按钮一样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中再拖动一个“Bar Button Item”，这次将其放置在导航栏的 *左侧*。使用属性检查器将其转换为“取消”按钮，就像你之前为保存按钮所做的那样。你的视图控制器应该与图 9-21 所示的相似。

![Image](img/Image00220.jpg)

*图 9-21: 带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新添加的按钮！

点击“生日”表格视图控制器上的 + 按钮应该会将你带到“添加生日”视图控制器，在那里你可以输入一个人的姓名和生日。点击取消和保存按钮暂时没有任何效果——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个“生日追踪器”应用，创建了“生日”和“添加生日”屏幕的基本用户界面。你还使用表格视图控制器创建了“生日”屏幕，并使用户可以通过“添加”按钮和导航控制器在屏幕之间进行导航。

现在，你已经完成了应用的基本框架，接下来你将在第十章编写代码，处理取消和保存按钮，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，"Add Missing Constraints" 选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **Reset to Missing Constraints** 选项来添加缺失的约束。

#### 添加一个按钮

我们希望用户能够打开应用，查看他们的生日列表，并将生日添加到列表中。让我们创建一个按钮，让他们能够实现这个功能！

我们需要在导航栏上添加一个按钮，指向添加生日的场景，以便用户可以输入生日。在对象库中找到“Bar Button Item”，然后将其拖动并放置到表格视图控制器的导航栏右侧，如图 9-9 所示。

现在我们要将这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮可以使用。在属性检查器中，将“bar button item”的系统项更改为 **Add**。你应该会看到按钮变成一个加号 (+)。

接下来，我们需要告诉按钮在点击时执行什么操作。我们希望它打开“添加生日”视图控制器，因此需要将“添加”按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你可以看到“生日”表格视图控制器和将最终成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，并从 + 按钮拖动到故事板右侧的空白视图控制器中。当视图控制器被高亮显示时松开鼠标。这将弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个条形按钮项拖动到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在出现的对话框中选择“模态呈现”。*

连接对话框为你提供了几种选择，用于设置两个视图控制器之间的*转场*——从一个屏幕到另一个屏幕的过渡方式。点击连接对话框中的**模态呈现**选项。这将使视图控制器作为*模态*视图控制器出现在屏幕上。在 iPhone 上，模态视图控制器是从手机底部滑上屏幕的，并且通常没有自动带有返回按钮返回到上一个屏幕。相反，模态视图可以有其他按钮，比如取消或保存。还有其他类型的转场，例如 Show 转场，它将视图控制器从右侧推入屏幕，并且在导航栏左侧带有返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，屏幕应该作为模态显示，并带有取消按钮。否则，如果你使用像 Show 转场这样的方式，并带有一个返回按钮，可能会出现用户输入完所有内容后，点击返回按钮却没有保存任何内容的情况！使用取消按钮时，用户必须故意点击它来取消退出屏幕。

要查看模态输入视图控制器的一个良好示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，用于在关闭模态之前创建新事件。你应该会看到，新的事件模态视图是从屏幕底部滑入的，当它被关闭时又会滑回去。我们希望用户能够保存生日，因此我们也会使用模态视图。

现在，让我们尝试运行我们的应用，看看我们目前为止做了什么！要运行应用，首先选择一个设备模拟器，在 Xcode 左上角的 BirthdayTracker 旁边点击设备名称（参见 图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角的应用名称旁边设置模拟器运行的设备。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，以供你选择运行应用的设备。我们选择的是 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果模拟器的大小过大，无法适应你的计算机屏幕，你可以调整它的大小。点击模拟器以选择它，然后转到**窗口** ▸ **缩放**，在模拟器菜单中选择一个更小的缩放比例。

到目前为止，运行应用程序时并不会发生太多事情。你应该会看到你第一个“生日”屏幕，上面有一个 + 按钮，正如之前在图 9-1 中所示。显然，在这一点上，你的“生日”屏幕是空的。点击 + 按钮将显示一个空白的第二个屏幕。查看完应用程序后，通过点击 Xcode 中的停止按钮关闭应用程序，该按钮位于你之前按下的播放按钮旁边。当你停止应用时，你应该能看到你的应用图标出现在模拟器的主屏幕上！（见图 9-12）

就这样！我们现在需要配置那个第二个屏幕，以便可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：生日追踪器应用程序图标已添加到主屏幕。*

### 设置控制输入和标签

我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，你需要将它嵌入到自己的导航控制器中。当视图控制器是模态时，它不会继承我们故事板中已存在的导航控制器的导航栏。导航控制器提供了导航栏，所以我们需要将模态视图控制器嵌入到自己的导航控制器中。通过在故事板中点击视图控制器来选择它。然后，转到 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在你应该能看到，在视图控制器场景的轮廓视图下，已经添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题 **添加生日**。这些步骤与将“生日”标题添加到表格视图控制器时的步骤相同。

现在，当“添加生日”视图控制器出现在应用程序中时，它会在顶部显示标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用程序中的每个条目都会包含名字、姓氏和生日日期。我们来为“添加生日”视图控制器添加一些 *输入控件*，以便用户可以为每个人输入这些信息。输入控件是允许用户向应用程序中输入数据的控件，如文本框或下拉菜单。我们将通过添加所有可以让用户输入信息的输入控件标签来开始。

##### 添加和定位标签

现在我们为“添加生日”视图控制器创建一个标签，内容为“名字”。这个标签会放在一个文本框旁边，用来输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入 **名字** 作为显示文本，如图 9-14 所示。

现在我们希望使用 Size Inspector 设置标签的大小和位置。在 Xcode 的 storyboard 中，宽度和高度是以 *点（points）* 为单位的。请注意，1 个点并不是 1 像素。根据你的应用运行的设备类型，1 个点可能对应 1 个像素、一个 2×2 像素的方块，或一个 3×3 像素的方块。这三个缩放因子分别称为 @1x、@2x 和 @3x（我们在设置应用图标时也提到过这些尺寸）。设备的点分辨率也不相同，宽度可能从 320 点到 1,024 点不等，高度可能从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示“名字”*

只有最旧款的 iPhone 和 iPod 使用 @1x 缩放因子，你将无法在这些设备上运行你的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的设备是 iPhone 6 Plus、6s Plus 或 7 Plus，它们使用 @3x 缩放因子，否则你的手机或 iPod 使用的是 @2x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是屏幕左边缘到对象左边缘的点数距离。y 位置是屏幕顶部到对象顶部的点数距离。（见 图 9-15）我们会设置每个我们添加到视图控制器的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签放置在屏幕边缘之外，但仍然留有足够的空间给其文本输入框以及其他标签和输入框。在 Size Inspector 的 View 部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，高度设置为 21。

完成这些步骤后，重复这些操作以向添加生日视图控制器中添加两个标签：姓氏标签和出生日期标签。我们需要将其他标签和输入框放置在合适的位置，以避免它们重叠。在某些情况下，这可能会变得有些复杂，并且可能需要一些时间。对于这个应用程序，我们已经计算好了在 iPhone 7 屏幕上的对象位置。稍后，我们会解释如何让你的应用程序兼容其他设备。表 9-1 列出了每个标签应该设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，以便它们垂直对齐，但它们每个的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个最接近的标签大至少 21 个点。由于我们也在每个标签下方添加了输入控件，我们将 y 位置设置得更大，以容纳标签和输入控件的高度。

太好了！现在你的故事板应该和图 9-16 中看到的一样。

![图片](img/Image00214.jpg)

*图 9-16：视图控制器中已添加输入标签。*

接下来，你将添加两个*文本字段*，让你能够输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们将能够在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中显示的尺寸和位置设置这两个文本字段。你可以像设置标签一样使用大小检查器来完成这一步。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加一个被称为*日期选择器*的控件，这将使你能够轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时显示日期和时间，就像日历应用中使用的日期选择器（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者只显示日期，这也是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到日期选择器，然后点击并将其拖动到出生日期标签下方的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。我们来将这个日期改为你的生日！将日期字段从当前日期改为**自定义**。这样做后，会出现一个新的框。将这个日期更改为你的生日。

让我们测试一下到目前为止应用程序的运行情况！我们为输入控件使用的大小非常适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击生日视图控制器上的 + 按钮时，应该会显示添加生日的屏幕，如 图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来不错，但其他设备呢？选择一个较小的模拟器运行该应用程序，比如 iPhone 5s，然后再次运行应用程序。你会看到显示效果不完全正确。

你添加到故事板中的所有元素都已显示，但文本字段已经超出了屏幕边缘。现在你已经将所有元素放在屏幕上，下一步是让它们适应任何屏幕大小。我们将通过一个叫做*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上都完美显示，使用自动布局

仅 iPhone 就有三种不同的屏幕尺寸，而且未来可能会出现更多尺寸。你需要设计你的应用，使其在任何设备上看起来都不错。这意味着，你希望应用能够调整所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（见 图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部第四个图标来调出自动布局菜单。*

在屏幕的故事板面板底部有一个带图标的带状工具栏，最右边的图标是一个位于两条竖线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击该图标以调出建议菜单。点击**添加缺失的约束**。^(*) 这样做后，你会看到大量的布局约束已被添加到添加生日场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的宽度适配屏幕，不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点，以便它们能够在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这一次，“添加生日”屏幕应该看起来完美。

#### 添加保存和取消按钮

为了完成所有步骤，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。此时按钮还不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消并保存生日数据到应用程序中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们做的添加按钮一样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其转变为取消按钮，就像你做保存按钮一样。你的视图控制器应该像图 9-21 中显示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新按钮！

点击生日表视图控制器上的+按钮应该会带你进入“添加生日”视图控制器，在这里你可以输入一个人的姓名和出生日期。点击取消和保存按钮暂时不会执行任何操作——我们将在第十章中实现它们！

### 你学到了什么

在本章中，你开始创建一个生日追踪应用，通过构建生日和添加生日屏幕的基本用户界面。你还使用表视图控制器创建了生日屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间切换。

现在你已经完成了应用程序的基本框架，接下来将花时间在第十章中编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日信息了！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是一个苹果的 bug。遇到这种情况时，选择**重置为缺失约束**选项以添加缺失的约束。

我们希望用户能够打开应用程序，查看他们的生日列表，并向列表中添加一个生日。让我们制作一个按钮，让他们可以做到这一点！

我们需要在导航栏上添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。找到对象库中的“Bar Button Item”，然后将其拖放到表格视图控制器的导航栏右侧，如图 9-9 所示。

现在我们想将这个按钮变成一个“添加”按钮。幸运的是，Xcode 提供了一个内置的“添加”按钮可以使用。在属性检查器中，将条形按钮项的系统项更改为**添加**。你应该看到按钮变成了一个加号 (+)。

接下来，我们需要告诉按钮点击时执行什么操作。我们希望它打开“添加生日”视图控制器，因此需要将“添加”按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你可以同时看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，从 + 按钮拖动到故事板右侧的空视图控制器中间。当视图控制器高亮显示时松开鼠标，这将弹出一个连接对话框，如图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar Button Item 拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在出现的对话框中选择“模态呈现”选项。*

连接对话框为你提供了几种*segue*（从一个屏幕到另一个屏幕的过渡）选项。点击连接对话框中的**模态呈现**选项。这将使视图控制器作为*模态*视图控制器显示在屏幕上。在 iPhone 上，模态视图控制器从屏幕底部滑入，而且它不会自动带有返回按钮返回到前一个屏幕。相反，模态视图控制器可以有其他按钮，例如“取消”或“保存”。还有其他类型的 segue，比如“显示”segue，它会将视图控制器从屏幕右侧推出，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你呈现一个用于获取和保存用户输入的屏幕时，应该以模态方式显示该屏幕，并且带有“取消”按钮。否则，如果你使用类似“显示”segue 的过渡，并且带有返回按钮，就可能出现用户输入完所有内容后点击返回按钮而没有保存任何内容的情况！而如果有“取消”按钮，用户必须故意点击它来退出屏幕。

要查看一个良好的模态输入视图控制器示例，看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧会有一个 + 按钮，点击它可以添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以退出该页面而不保存，右侧有一个添加按钮，可以在关闭模态前创建新的事件。你会看到，新事件模态从屏幕底部滑入，取消时会滑回底部。我们希望用户能够保存生日，因此我们也会使用模态视图。

现在让我们尝试运行我们的应用，看看到目前为止我们做了些什么！要运行应用，首先在 Xcode 左上角的 BirthdayTracker 旁边选择一个设备模拟器（参见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角，设置模拟器运行的设备，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。在选择了模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ - **R**。

当模拟器打开并运行你的应用时，如果模拟器的大小太大，无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器进行选择，然后前往 **窗口** ▸ **缩放**，在模拟器菜单中选择较小的比例。

到目前为止，运行应用时并没有发生太多事情。你应该看到之前显示的第一个生日页面，并且有一个 + 按钮（参见图 9-1）。显然，在这一点上，你的生日页面是空的。点击 + 按钮会弹出第二个空白页面。查看完应用后，点击 Xcode 中的停止按钮关闭它，这个按钮位于你之前按下的播放按钮旁边。当你停止应用时，你应该能在模拟器的主屏幕上看到你的应用图标！（参见图 9-12）

就是这样！现在我们需要配置第二个屏幕，以便可以用来添加生日！

![图片](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到一个独立的导航控制器中。当视图控制器是模态时，它不会继承我们故事板中已有的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中，点击选择纯视图控制器。然后前往**Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在，你应该会看到在“视图控制器场景”下的轮廓视图中添加了一个导航项。点击这个新导航项，然后在属性检查器中添加标题**Add a Birthday**。这些步骤和你在添加“Birthdays”标题到表格视图控制器时遵循的步骤是一样的。

现在，当“添加生日”视图控制器出现在应用中时，它将会在顶部显示标题标签。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友们的生日时，应用中的每一条记录都将包含一个名字、一个姓氏和一个出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，让用户为每个人输入这些信息。输入控件是像文本框或下拉菜单这样的控件，它们允许用户在应用中输入数据。我们将首先通过添加输入控件标签来开始，标明用户可以添加的所有信息。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个标签，显示“First Name”。这个标签将放在一个文本框旁边，用户可以在其中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们想要使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*为单位的。请注意，1 个点并不是 1 个像素。根据你的应用运行的设备类型，1 个点可以对应 1 个像素、2×2 像素的方块，或者 3×3 像素的方块。这三个缩放因子被称为@1x、@2x 和@3x（这些大小在我们设置应用图标时提到过）。设备的点分辨率也不完全相同，宽度可能从 320 点到 1,024 点不等，高度可能从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：制作显示“First Name”的标签*

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，而这些设备无法运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的设备是 iPhone 6 Plus、6s Plus 或 7 Plus，否则你的 iPhone 或 iPod 很可能使用 @2x 缩放因子，这些设备使用的是 @3x 缩放因子。

一个对象在屏幕上的位置也是基于点数的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（见图 9-15）。我们将设置每个库对象在视图控制器中的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，但仍留出足够的空间给文本输入字段以及其他标签和输入框。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成这一步后，重复这些步骤向“添加生日”视图控制器添加两个标签：姓氏标签和生日标签。我们需要调整其他标签和输入框的位置，确保它们不重叠。在某些情况下，这可能会变得复杂，且可能需要一些时间。对于这个应用，我们已经为你计算了 iPhone 7 屏幕上的位置。稍后我们会解释如何让你的应用在其他设备上工作。表 9-1 列出了每个标签应该设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，这样它们就会垂直对齐，但它们的 y 位置不同。每个标签的高度是 21，因此 y 位置必须比下一个标签的 y 位置大至少 21 点。由于我们也要在每个标签下方添加输入控件，因此我们将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

太棒了！现在你的故事板应该看起来像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来你将添加两个 *文本字段*，让你输入名字和姓氏。文本字段是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器上。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中看到的尺寸和位置来设置这两个文本字段。你可以使用尺寸检查器来完成，就像你为标签所做的那样。

表 9-2：视图控制器中的文本字段输入

| 文本字段 | x 位置 | y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个元素是一个叫做*日期选择器*的滚轮。它将让你轻松输入生日日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，允许用户选择日期或时间。它可以包含日期和时间，就像日历应用中使用的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这正是我们在生日跟踪器中使用的。

滚动浏览对象库，直到你找到一个日期选择器，然后点击并拖动它到视图控制器下的生日标签下。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。我们将其更改为显示你的生日！将日期字段从当前日期更改为**自定义**。这样，一个新框将会出现。将此日期更改为你的生日。

让我们测试一下应用程序到目前为止的功能！我们为输入控件选择的大小在 iPhone 7 屏幕上看起来非常合适。所以选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这一次，当你在生日视图控制器上点击 + 按钮时，应该会显示添加生日的界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来很好，但其他设备呢？选择一个更小的模拟器来运行应用程序，比如 iPhone 5s，并再次运行应用程序。你会看到界面显示得有些不对劲。

所有添加到故事板中的元素都会显示出来，但文本字段已超出屏幕边缘。现在，所有元素都已显示在屏幕上，下一步是确保它们在任何屏幕尺寸上都能正确适配。我们将使用一个名为*自动布局*的工具来完成这一任务。

#### 使用自动布局让你的应用在每个设备上看起来都完美

iPhone 本身就有三种不同的屏幕尺寸，而且未来可能会有更多的尺寸。你需要设计应用程序，使其在任何设备上看起来都不错。这意味着，你需要让应用程序自动调整应用内所有元素的位置和大小，以适应运行该应用的设备。自动布局使用一种称为*布局约束*的东西来将元素放置到屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕的故事板窗格底部，有一个带图标的条带，位于工具面板之前的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，显示“解决自动布局问题”。点击该图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*) 做到这一点后，你会看到许多布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，适合屏幕。例如，自动布局确保日期选择器的大小适应屏幕的宽度，并且不会超出边缘。自动布局还会确保每个文本字段前后各有 20 个点，以便它们在屏幕上居中对齐。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”屏幕应该显示得完美无缺。

#### 添加保存和取消按钮

最后，我们将展示如何为“添加生日”视图控制器的导航栏创建“取消”和“保存”按钮。这些按钮暂时不会执行任何操作，我们只是进行设置。在第十章中，我们将添加一些代码，使它们能够取消添加生日屏幕并将生日保存到应用程序中。

要添加“保存”按钮，从对象库中拖动一个“条形按钮项”并将其放置在导航栏的*右侧*。我们将把这个按钮更改为“保存”按钮，方法与添加按钮时相同。选择该按钮项，然后使用属性检查器将其更改为“保存”按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个工具栏按钮项，这次将其放置在导航栏的 *左* 侧。使用属性检查器将其设置为取消按钮，就像你对保存按钮所做的那样。你的视图控制器应该像 图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新的按钮！

在“生日”表格视图控制器上点击 + 按钮应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前还没有任何反应——我们将在 第十章 中实现这两个按钮！

### 你学到了什么

在这一章中，你开始制作一个 BirthdayTracker 应用，通过创建生日和添加生日界面的基本用户界面。你还使用表格视图控制器创建了生日界面，并使用户能够通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本骨架，接下来你将在 第十章 中编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项是禁用的。这是一个 Apple 的 bug。在这种情况下，选择 **重置为缺失约束** 选项来添加缺失的约束。

我们需要在导航栏中添加一个按钮，指向“添加生日”场景，以便用户可以输入生日。在对象库中找到工具栏按钮项，然后将其拖放到表格视图控制器的导航栏右侧，如 图 9-9 所示。

现在我们想将这个按钮变成一个添加按钮。幸运的是，Xcode 有一个内置的添加按钮可以使用。在属性检查器中，将工具栏按钮项的系统项目改为 **添加**。你应该能看到按钮变成一个加号 (+)。

接下来，我们需要告诉按钮在点击时应该做什么。我们希望它打开“添加生日”视图控制器，因此需要将添加按钮连接到该视图控制器。首先，双击故事板以缩小视图，确保你可以看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，然后从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标。这样会弹出一个连接对话框，如 图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将工具栏按钮项拖到生日视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在出现的对话框中选择“模态展示”。*

连接对话框提供了几种*segue*（从一个屏幕到另一个屏幕的过渡）选项，你可以在两个视图控制器之间进行选择。在连接对话框中，点击**模态展示**选项。这将使视图控制器作为*模态*视图控制器显示在屏幕上。在 iPhone 上，模态视图控制器从屏幕底部滑入，并且默认没有返回按钮来返回到前一个屏幕。相反，模态视图可以有其他按钮，比如取消或保存。还有其他类型的 segue，比如 Show segue，其中视图控制器从右侧推送到屏幕上，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，应该以模态形式显示，并带有一个取消按钮。否则，如果使用像 Show segue 这样的过渡，并且带有返回按钮，可能会出现用户输入完所有信息后点击返回按钮而不保存的情况！带有取消按钮时，用户必须故意点击以取消退出屏幕。

要查看模态输入视图控制器的一个好例子，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，在导航栏的右侧有一个+按钮，你可以点击它来添加一个日历事件。点击+按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，可以在关闭模态视图之前创建新事件。你应该看到，"新事件"模态从屏幕底部滑入，关闭时再滑回底部。我们希望用户保存生日，所以我们也会使用模态视图。

现在让我们尝试运行我们的应用，看看我们到目前为止做了什么！要运行应用，首先选择一个设备模拟器，方法是在 Xcode 左上角点击 BirthdayTracker 旁边列出的设备（参见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设置模拟器运行的设备，并将其显示在应用名称旁边。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表来运行你的应用。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用键盘快捷键⌘ -**R**。

当模拟器打开并运行你的应用时，如果它太大无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器以选择它，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用时并没有发生太多事情。你应该能看到你第一个生日页面，其中有一个+按钮，正如之前在图 9-1 中所示。当然，此时你的生日页面将是空的。点击+按钮会弹出第二个空白页面。查看完应用后，通过点击 Xcode 中的停止按钮关闭应用，该按钮位于你之前按过的播放按钮旁边。当你停止应用时，你应该能在模拟器的主屏幕上看到应用图标！(见图 9-12)。

就是这样！现在我们需要配置第二个屏幕，以便能够添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控件输入和标签

让我们通过添加标题来开始设计添加生日的视图控制器。为此，你需要将它嵌入到一个自己的导航控制器中。当一个视图控制器是模态时，它不会继承我们在故事板上已经有的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。点击故事板中的空白视图控制器，选择它。然后，进入**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该会看到一个导航项已被添加到视图控制器场景的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与你之前在表格视图控制器中添加“生日”标题时是一样的。

现在，当添加生日视图控制器在应用中显示时，它会在顶部标明标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，你的应用中每一条记录都会包含名字、姓氏和生日日期。让我们为添加生日视图控制器添加一些*输入控件*，以便用户可以为每个人输入所有这些信息。输入控件是诸如文本框或下拉菜单之类的控件，允许用户在应用中输入数据。我们将从为所有可以添加信息的输入控件添加标签开始。

##### 添加和定位标签

让我们为你的添加生日视图控制器制作一个显示“名字”的标签。这个标签将位于一个文本框旁边，你将在这里输入朋友的名字。从对象库中找到并拖动一个标签对象到添加生日视图控制器上（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到添加生日视图控制器。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在我们希望使用大小检查器设置标签的大小和位置。在 Xcode 的 storyboard 中，宽度和高度以 *点* 为单位进行测量。请注意，1 点并不是 1 像素。根据你的应用运行的设备类型，1 点会转换为 1 像素、2×2 像素的方块，或者 3×3 像素的方块。这三种缩放因子分别称为 @1x、@2x 和 @3x（这些就是我们在设置应用图标时提到的尺寸）。设备的点分辨率也不相同，宽度可能从 320 点到 1,024 点不等，高度可能从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：显示标签内容* 名字

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，而且你将无法在这些型号上运行应用（BirthdayTracker 仅支持 iOS 10 及以上）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们很可能使用 @2x 缩放因子，这些设备使用 @3x 缩放因子。

一个对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离（单位：点）。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15）。我们将设置每个我们添加到视图控制器中的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签放置在屏幕边缘以外的位置，但仍留出足够的空间用于文本输入框以及其他标签和输入项。在“大小检查器”的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成这些操作后，重复这些步骤向“添加生日”视图控制器中添加两个标签：一个姓氏标签和一个出生日期标签。我们需要调整其他标签和输入项的位置，以确保它们不会重叠。在某些情况下，这可能会变得复杂，可能需要一些时间。对于这款应用，我们已经为你计算了适合放置对象的 iPhone 7 屏幕位置。稍后，我们将解释如何使应用适应其他设备。表 9-1 列出了每个标签应该设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们在垂直方向上对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个标签的 y 位置大至少 21 个点。由于我们还将在每个标签下方添加输入控件，我们将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

太好了！现在你的故事板应该看起来像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：已将输入标签添加到视图控制器中。*

接下来，你将添加两个*文本框*，用于输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本框对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本框设置为表格 9-2 中看到的大小和位置。像设置标签一样，使用大小检查器进行设置。

表格 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做*日期选择器*的控件。这将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中的日期选择器一样（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以只显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动到出生日期标签下方的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器进行选择。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器会显示当前日期。让我们将这个日期改为你的出生日期吧！将日期字段从“当前日期”改为**自定义**。这样做时，一个新的框会出现。将这个日期改为你的出生日期。

让我们通过运行应用程序来测试它到目前为止的表现！我们为输入控件选择的尺寸在 iPhone 7 屏幕上显示得很好。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你点击“生日”视图控制器上的+按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器，比如 iPhone 5s，再次运行应用程序。你会看到布局看起来不太对。

你添加到故事板中的所有元素都会显示出来，但文本框超出了屏幕的边缘。现在你已经将所有元素放置在屏幕上，下一步是让它们在任何屏幕尺寸上正确适配。我们将通过一个叫做*自动布局*的工具来做到这一点。

#### 通过自动布局让你的应用在每个设备上都看起来完美

iPhone 本身就有三种不同的屏幕尺寸，而且未来可能会有更多尺寸出现。你需要设计应用程序，使其在任何设备上看起来都很好。这意味着，你需要让你的应用根据运行设备的不同，自动调整应用内所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来将元素放置到屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来显示自动布局菜单。*

屏幕的故事板面板底部有一个带图标的带状栏，实用工具面板之前最右边的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，上面写着“解决自动布局问题”。点击此图标以显示建议菜单。点击**添加缺失的约束**。^(*) 做到这一点后，你会看到很多布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的尺寸正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕宽度，并且不会超出边缘。自动布局还会确保每个文本字段前后各有 20 个点的间距，使它们在屏幕上居中对齐。

现在再次在 iPhone 5s 模拟器上运行应用。这次，“添加生日”屏幕应该显示完美。

#### 添加保存和取消按钮

为了完成这一部分，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。这些按钮现在不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消操作并将生日保存到应用中。

要添加保存按钮，拖动一个栏按钮项从对象库中，将它放置在导航栏的 *右侧*。我们将把这个按钮改成保存按钮，就像我们之前将添加按钮改成加号按钮一样。选择按钮项，然后使用属性检查器将它改成保存按钮。

最后，我们来添加取消按钮。再从对象库中拖动一个栏按钮项，这次将它放置在导航栏的 *左侧*。使用属性检查器将它改成取消按钮，就像你做保存按钮时一样。你的视图控制器应该像图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新的按钮！

点击生日表视图控制器中的 + 按钮，应该会进入“添加生日”视图控制器，在那里你可以输入一个人的名字和生日日期。点击取消和保存按钮目前不会执行任何操作——我们将在第十章中实现它们！

### 你学到了什么

在这一章中，你开始制作生日跟踪器应用，通过创建“生日”界面和“添加生日”界面实现了基本的用户界面。你还通过使用表视图控制器创建了“生日”屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本框架，在第十章中，你将编写代码来实现取消和保存按钮，使你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，"添加缺失约束"选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **重置为缺失约束** 选项来添加缺失的约束。

现在我们要将这个按钮变成一个添加按钮。幸运的是，Xcode 提供了一个内置的添加按钮可以使用。在属性检查器中，将栏按钮项的系统项更改为 **添加**。你应该能看到按钮变成了一个加号 (+)。

接下来，我们需要告诉按钮在被点击时应该做什么。我们希望它打开“添加生日”视图控制器，所以我们需要将“添加”按钮与该视图控制器连接起来。首先，双击故事板进行缩小，确保你能够看到“生日”表格视图控制器和将来成为“添加生日”视图控制器的空白视图控制器。按住 CONTROL 键，从 + 按钮拖动到故事板右侧空白视图控制器的中间。当视图控制器被高亮显示时松开鼠标。这时会弹出一个连接对话框，类似于图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将一个条形按钮项拖动到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态展示”。*

连接对话框为你提供了多个选项，以选择你希望在两个视图控制器之间进行的*segue*——从一个屏幕到下一个屏幕的过渡。点击连接对话框中的**模态展示**选项。这会使视图控制器作为*模态*视图控制器呈现到屏幕上。在 iPhone 上，模态视图控制器从手机底部滑入屏幕，并且它不会自动带有返回按钮返回到前一个屏幕。相反，模态视图控制器可以有其他按钮，例如取消或保存。还有其他类型的 segue，比如“显示”segue，视图控制器从右侧滑入屏幕，并且导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，该屏幕应该作为模态视图展示，并带有取消按钮。否则，如果你使用像“显示”segue 这样的过渡并带有返回按钮，用户可能会输入所有内容后点击返回按钮，却没有保存任何数据！而带有取消按钮的模态视图要求用户必须主动点击取消才能退出屏幕。

要查看一个好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏的右侧会有一个 + 按钮，点击它可以添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，可以在关闭模态视图前创建新事件。你会看到，新事件模态视图是从屏幕底部滑入的，关闭时又从底部滑出去。我们希望用户保存生日信息，所以也会使用模态视图。

现在让我们试着运行我们的应用程序，看看到目前为止我们做了什么！要运行应用程序，首先通过点击 Xcode 左上角的 BirthdayTracker 旁边列出的设备来选择一个设备模拟器（见 图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设备与应用程序名称旁边设置了模拟器。这里选择的设备是 iPhone 7。*

这将弹出一个设备选项列表来运行你的应用程序。我们选择的是 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R**。

当模拟器打开运行你的应用程序时，如果模拟器的大小太大以至于无法适应电脑屏幕，你可以调整它的大小。点击模拟器以选中它，然后在 **窗口** ▸ **缩放** 中选择一个更小的比例。

到目前为止，当你运行应用程序时，并不会发生太多事情。你应该能看到你的第一个生日屏幕，其中有一个 + 按钮，如前面在 图 9-1 中所示。显然，这时你的生日屏幕会是空的。点击 + 按钮将会弹出第二个空白屏幕。查看完应用程序后，通过点击 Xcode 中的停止按钮来关闭它，停止按钮就在你之前点击的播放按钮旁边。停止应用程序后，你应该能看到应用程序图标出现在模拟器的主屏幕上！（见 图 9-12）

就这样！现在我们需要配置第二个屏幕，以便它可以用来添加生日！

![图片](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将它嵌入到一个独立的导航控制器中。当视图控制器是模态的时，它不会继承我们故事板中已有的导航控制器中的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过在故事板中点击普通视图控制器来选择它。然后，转到 **编辑** ▸ **嵌入在** ▸ **导航控制器**。现在，你应该看到在视图控制器场景下的轮廓视图中添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题 **添加生日**。这些步骤和你之前为表视图控制器添加标题“生日”时的步骤相同。

现在，当“添加生日”视图控制器出现在应用程序中时，它的标题会显示在顶部。

#### 添加好友的姓名和生日

当你在第十章中输入朋友的生日时，应用中的每个条目将包含一个名字、一个姓氏和一个出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户为每个人输入所有这些信息。输入控件如文本字段或下拉菜单等，允许用户在应用中输入数据。我们将从添加所有用户可以输入信息的输入控件标签开始。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器制作一个写有“First Name”的标签。这个标签将位于文本字段旁边，你将在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器（见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：在“添加生日”视图控制器中添加标签。*

接下来，修改标签的显示文本。在“属性检查器”中，点击标签文本框，输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们要使用“尺寸检查器”设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以*点*为单位进行度量。请注意，1 个点并不等于 1 像素。根据你的应用运行的设备类型，1 个点可能会转换为 1 像素、一个 2×2 像素的正方形或一个 3×3 像素的正方形。这三个缩放因子被称为 @1x、@2x 和 @3x（这也是我们设置应用图标时提到的大小）。不同的设备也不会有相同的点分辨率，宽度可以从 320 到 1,024 点不等，高度可以从 568 到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：让标签显示* First Name

只有最老款的 iPhone 和 iPod 才使用 @1x 缩放因子，而你将无法在这些设备上运行你的应用（BirthdayTracker 将仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们很可能使用 @2x 缩放因子，这些型号使用的是 @3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点数。y 位置是从屏幕顶部到对象顶部的距离。（请参见图 9-15。）我们将为添加到视图控制器中的每个库对象设置 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示屏幕上一个对象的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕的边缘之外，但仍然为其文本输入框和其他标签及输入控件留出足够的空间。在“尺寸检查器”的“视图”部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。将高度保持为 21。

完成后，重复这些步骤，向“添加生日”视图控制器中添加另外两个标签：姓氏标签和出生日期标签。我们需要调整其他标签和输入控件的位置，以避免它们重叠。在某些情况下，这可能会变得棘手并需要一些时间。对于这个应用，我们已经为你计算好了在 iPhone 7 屏幕上放置对象的位置。稍后我们将解释如何使你的应用支持其他设备。表格 9-1 列出了你应该为每个标签设置的大小和位置。

表格 9-1: 视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，所以 y 位置需要至少比下一个最接近的标签高 21 个点。由于我们在每个标签下方也添加了输入控件，因此我们将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

很棒！现在你的故事板应该看起来像图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16: 输入标签已添加到视图控制器。*

接下来你将添加两个*文本字段*，它们将允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器上。其中一个用于输入名字，另一个用于输入姓氏。为这两个文本字段设置表格 9-2 中所示的大小和位置。你可以通过大小检查器来实现，就像你为标签做的那样。

表格 9-2: 视图控制器中的文本字段输入

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做*日期选择器*的控件。这个控件可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像日历应用中的日期选择器一样（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17: 日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以仅显示时间，类似于时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的。

在对象库中滚动，直到找到一个日期选择器，然后点击并拖动它到出生日期标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击选择日期选择器。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的生日！将日期字段从当前日期更改为**自定义**。当你这么做时，新的框将会出现。将日期更改为你的生日。

让我们通过运行应用程序来测试目前的效果！我们为输入控件设置的大小非常适合 iPhone 7 的屏幕。所以，选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你点击出生日期视图控制器上的+按钮时，应该会显示添加生日的页面，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美契合。*

![图片](img/Image00218.jpg)

在 iPhone 7 上效果很好，但其他设备怎么样呢？选择一个更小的模拟器（如 iPhone 5s）来运行应用程序，再次运行应用程序。你会看到，界面看起来不太对。

所有你添加到故事板中的元素都会显示出来，但文本字段超出了屏幕的边缘。现在，你的所有元素都已经出现在屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上都能完美显示——使用自动布局

光 iPhone 就有三种不同的屏幕尺寸，而且未来可能还会有更多尺寸的设备。你需要设计你的应用，使它们在任何设备上看起来都很棒。这意味着你希望应用能够根据运行设备的不同，调整屏幕上所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板中的大纲视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标，调出自动布局菜单。*

在屏幕故事板的底部有一个带有图标的带状区域，位于实用工具面板之前的最右侧是一个夹在两条垂直线之间的三角形图标。将鼠标光标悬停在该图标上，它会显示一个标签，写着“解决自动布局问题”。点击这个图标会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你执行此操作时，你会看到一堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适合屏幕宽度，并且不会超出屏幕边缘。自动布局还会确保每个文本框的前后都有 20 个点的间距，这样它们就能在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这部分内容，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。这些按钮暂时不会执行任何操作。我们只是设置它们。在第十章中，我们将添加一些代码，让它们能够取消“添加生日”屏幕并将生日信息保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮更改为保存按钮，就像我们对添加按钮所做的那样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，并这次将它放置在导航栏的*左侧*。使用属性检查器将其更改为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该像图 9-21 中显示的那样。

![Image](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新按钮的效果！

在生日表视图控制器中点击+按钮，应该会进入“添加生日”视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前还没有任何效果——我们将在第十章中实现这两个按钮的功能！

### 你学到的内容

在这一章中，你开始制作一个 BirthdayTracker 应用，创建了生日和添加生日界面的基本用户界面。你还使用表视图控制器创建了生日界面，并让用户可以通过添加按钮和导航控制器在各个界面之间切换。

现在你已经完成了应用的基本框架，第十章将会教你如何编程实现“取消”和“保存”按钮，这样你就可以在应用中添加和保存生日信息了！

* 在某些版本的 Xcode 中，"Add Missing Constraints" 选项被禁用。这是一个 Apple 的 Bug。在这种情况下，选择 **Reset to Missing Constraints** 选项来添加缺失的约束。

接下来，我们需要告诉按钮在被点击时做什么。我们希望它打开“添加生日”视图控制器，因此我们需要将“添加”按钮连接到该视图控制器。首先，双击 storyboard 以缩小视图，确保你能看到“生日”表格视图控制器和最终将成为“添加生日”视图控制器的普通视图控制器。按住 CONTROL 键，从 + 按钮拖动到 storyboard 右侧空白视图控制器的中间。当视图控制器被高亮显示时，松开鼠标。这将弹出一个连接对话框，如 图 9-10 所示。

![Image](img/Image00206.jpg)

*图 9-9：将 Bar Button Item 拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“Present Modally”选项。*

连接对话框为你提供了几种 *segue*（即从一个屏幕到另一个屏幕的过渡方式）选项。点击连接对话框中的 **Present Modally** 选项。这会将视图控制器作为 *模态* 视图控制器呈现到屏幕上。在 iPhone 上，模态视图控制器从屏幕底部滑入，并且不会自动带有返回按钮返回到上一屏幕。相反，模态视图可以有其他按钮，例如取消或保存。还有其他类型的 segue，比如 Show segue，它将视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用来获取和保存用户输入的界面时，该界面应该作为模态窗口展示，并带有取消按钮。否则，如果你使用类似 Show segue 的方式，并且有返回按钮，用户可能会输入所有信息后不保存就点击返回按钮！有了取消按钮，用户必须故意点击才能取消该界面。

要查看一个模态输入视图控制器的好例子，可以看看你 iPhone 或 iPad 上的日历应用。打开它时，在导航栏的右侧有一个 + 按钮，点击它可以添加一个日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以取消并退出屏幕而不保存，右侧有一个添加按钮，可以在关闭模态之前创建新事件。你应该能看到新事件模态视图从底部弹出，关闭时又从屏幕下方消失。我们希望用户保存生日，所以我们也会使用模态。

现在让我们尝试运行我们的应用程序，看看目前为止我们完成了什么！要运行应用程序，首先通过点击 Xcode 左上角 BirthdayTracker 旁边的设备列表来选择一个设备模拟器（参见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，选择与应用名称旁边的设备，以设置模拟器运行的设备。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果它太大无法适应你的计算机屏幕，你可以调整其大小。点击模拟器以选中它，然后转到 **窗口** ▸ **缩放**，在模拟器菜单中选择一个更小的缩放比例。

到目前为止，当你运行应用时，应该不会发生太多变化。你应该能看到你第一个生日屏幕，带有一个 + 按钮，正如之前在图 9-1 中所示。显然，在这一点上，你的生日屏幕将是空的。点击 + 按钮将弹出第二个空白屏幕。一旦你查看完应用，点击 Xcode 中的停止按钮来关闭它，这个按钮在你之前按的播放按钮旁边。当你停止应用时，你应该会在模拟器的主屏幕上看到你的应用图标！（参见图 9-12。）

就是这样！现在我们需要配置第二个屏幕，以便它可以用于添加生日！

![图片](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到一个自己的导航控制器中。当一个视图控制器是模态视图时，它不会继承故事板中已存在的导航控制器中的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器，选择该视图控制器。然后，进入**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在你应该看到一个导航项已添加到视图控制器场景下的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与添加“生日”标题到表格视图控制器时的操作是一样的。

现在，当“添加生日”视图控制器在应用中出现时，它将显示在顶部的标题标签。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每一条信息都会包含名字、姓氏和出生日期。让我们在“添加生日”视图控制器中添加一些*输入控件*，以便用户为每个人输入这些信息。输入控件是指像文本框或下拉菜单这样的控件，允许用户在应用中输入数据。我们将从为用户可以添加的所有信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个显示“名字”的标签。这个标签将放置在一个文本框旁边，用户可以在其中输入朋友的名字。找到并将标签对象从对象库拖动到“添加生日”视图控制器中（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在，我们要使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*（points）为单位来衡量的。请注意，1 个点并不是 1 像素。根据应用运行的设备类型，1 个点可能会转换为 1 个像素、一个 2×2 像素的方块，或一个 3×3 像素的方块。这三个缩放因子分别被称为 @1x、@2x 和 @3x（这些与我们设置应用图标时讨论的大小是一样的）。不同设备的点分辨率也不相同，宽度从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：让标签显示* 名字

只有最旧款的 iPhone 和 iPod 使用 @1x 缩放因子，并且你无法在这些型号上运行你的应用程序（BirthdayTracker 只支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，它们使用 @3x 缩放因子，否则你的设备很可能使用 @2x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的距离。（见图 9-15）我们将设置添加到视图控制器中的每个库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示屏幕上一个对象的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置为既不靠近屏幕边缘，又能为其文本输入框及其他标签和输入控件留出足够的空间。在 Size Inspector 的 View 部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成这一步后，重复这些步骤，在“添加生日”视图控制器中添加两个标签：姓氏标签和出生日期标签。我们需要为其他标签和输入控件设置位置，以确保它们不会重叠。在某些情况下，这可能会变得有些复杂，并且可能需要一些时间。对于这个应用程序，我们已经为你计算出了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何使应用程序兼容其他设备。表 9-1 列出了你应该为每个标签设置的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你会看到所有标签的 x 位置相同，因此它们在垂直方向上对齐，但每个标签的 y 位置不同。每个标签的高度为 21，所以 y 位置需要比下一个最近的标签至少大 21 个点。由于我们也将在每个标签下方添加输入控件，因此我们将 y 位置设置得更大，以容纳标签的高度和输入控件的高度。

太好了！现在你的故事板应该像图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本框*，让你可以输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本字段到视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段设置为表 9-2 中看到的尺寸和位置。你可以使用“尺寸检查器”来完成此操作，就像设置标签时一样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X-位置 | Y-位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个叫做*日期选择器*的组件。这个组件可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时显示日期和时间，就像在日历应用中使用的日期选择器一样（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中，日期选择器用于事件的日期选择。*

日期选择器还可以仅显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这也是我们在 BirthdayTracker 中使用的功能。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到出生日期标签下方的视图控制器中。使用尺寸检查器，将 x-位置设置为 0，y-位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：修改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的出生日期！将日期字段从“当前日期”更改为**自定义**。这样，一个新框会出现。将这个日期更改为你的出生日期。

让我们运行应用程序，测试一下目前为止的工作情况！我们为输入控件设置的尺寸适合 iPhone 7 的屏幕。因此，选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击“+”按钮进入生日视图控制器时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

在 iPhone 7 上看起来很好，但其他设备呢？选择一个更小的模拟器运行应用程序，比如 iPhone 5s，再次运行应用。你会发现显示效果不太对劲。

所有添加到故事板中的元素都显示出来，但文本字段超出了屏幕的边缘。现在你已经将所有元素放置到屏幕上，下一步是确保它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 使用自动布局让你的应用在每个设备上看起来都完美

iPhone 单独就有三种不同的屏幕尺寸，而且未来可能还会有更多尺寸。你需要设计应用程序，使它在任何设备上看起来都很好。这意味着你需要让应用程序根据设备的不同调整界面元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来安排屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接着，看看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部第四个图标，打开自动布局菜单。*

在屏幕故事板面板的底部，有一条带有图标的带状工具栏，工具栏最右侧的图标是两个垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，提示“解决自动布局问题”。点击该图标以显示建议菜单。点击**添加缺失的约束**。^(*) 这样做后，你会看到“添加生日”场景中添加了一大堆布局约束。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局使日期选择器的宽度适配屏幕宽度，并且不会超出边缘。自动布局还会确保每个文本字段前后都有 20 个点的间距，以便它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这一次，“添加生日”屏幕应该显示完美。

#### 添加保存和取消按钮

为了完成这一切，我们将向你展示如何为“添加生日”视图控制器的导航栏制作“取消”和“保存”按钮。按钮现在还没有功能。我们只是先设置它们。在第十章中，我们将添加一些代码，使它们能够取消退出“添加生日”屏幕并将生日保存到应用程序中。

要添加“保存”按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮更改为“保存”按钮，就像我们之前做的“添加”按钮一样。选择按钮项，然后使用属性检查器将其更改为“保存”按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，和你为保存按钮所做的相同。你的视图控制器应该像图 9-21 所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在重新运行你的应用程序，看看新添加的按钮！

点击“生日”表视图控制器上的 + 按钮应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前不会有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你开始通过创建“生日”和“添加生日”屏幕的基本用户界面来制作一个 BirthdayTracker 应用程序。你还使用表视图控制器创建了“生日”屏幕，并使得用户可以通过添加按钮和导航控制器在屏幕之间进行导航。

现在你的应用程序的基本框架已经搭建完成，你将在第十章编写代码，来实现取消和保存按钮，以便你可以在应用程序中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项是禁用的。这是苹果的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。![Image](img/Image00206.jpg)

*图 9-9：将一个 Bar Button Item 拖到“生日”视图控制器的导航栏上。*

![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖到相邻的视图控制器，并在出现的对话框中选择“模态呈现”。*

连接对话框为你提供了几种不同类型的*过渡*——即从一个屏幕到下一个屏幕的切换——选项，你可以在两个视图控制器之间进行选择。点击连接对话框中的**模态呈现**选项。这样，视图控制器会作为*模态*视图控制器呈现到屏幕上。在 iPhone 上，模态视图控制器会从屏幕底部呈现，而且它不会自动带有返回按钮来返回上一屏。相反，模态视图控制器可能会有其他按钮，如取消或保存。还有其他类型的过渡，例如 Show 过渡，其中视图控制器从右侧推入屏幕，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用程序中，当你展示一个用于获取和保存用户输入的屏幕时，应该以模态方式显示，并且带有一个取消按钮。否则，如果你使用类似 Show 过渡并带有返回按钮，可能会出现用户输入完所有内容后点击返回按钮而没有保存任何内容的情况！带有取消按钮的屏幕需要用户明确点击才能取消。

要查看一个模态输入视图控制器的良好示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏的右侧会有一个 + 按钮，你可以点击它来添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，用于创建新事件并关闭模态视图。你应该会看到新事件模态视图从屏幕底部弹出，关闭时又回到屏幕底部。我们希望用户能保存生日，因此我们也将使用模态视图。

现在让我们尝试运行应用，看看我们迄今为止做了什么！要运行应用，首先通过点击 Xcode 左上角显示的设备列表，选择一个设备模拟器（参见图 9-11）。

![图片](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，你可以设置模拟器运行的设备，设备名称旁边是你的应用程序名称。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。在选择了模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用程序时，如果它的尺寸太大，无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器以选择它，然后转到**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时，实际上没有太多操作发生。你应该能看到你的第一个生日页面，并且上面有一个 + 按钮，如前面图 9-1 所示。显然，在这一点上，你的生日页面将是空的。点击 + 按钮将会弹出第二个空页面。查看完应用后，点击 Xcode 中的停止按钮关闭应用，停止按钮在你之前按过的播放按钮旁边。当你停止应用后，你应该能看到模拟器主屏幕上的应用图标！（参见图 9-12。）

就这样！现在我们需要配置第二个屏幕，以便可以用来添加生日！

![图片](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

我们来开始设计“添加生日”视图控制器，首先添加其标题。为此，你需要将其嵌入到自己的导航控制器中。当一个视图控制器是模态视图时，它不会继承我们在故事板上已有的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器来选择它。然后进入**编辑** ▸ **嵌入** ▸ **导航控制器**。现在，你应该会看到在“视图控制器场景”的大纲视图下添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与当初为你的表格视图控制器添加标题“生日”时是一样的。

现在，当“添加生日”视图控制器在应用中出现时，它将会在顶部显示标题标签。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每一项都会包含名字、姓氏和出生日期。接下来，我们要在“添加生日”视图控制器中添加一些*输入控件*，这样用户就能为每个人输入这些信息。输入控件是像文本字段或下拉菜单之类的元素，允许用户在应用中输入数据。我们将从添加所有可以输入的标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个显示“名字”的标签。这个标签将放置在一个文本字段旁边，用户可以在该字段中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，更改标签的显示文本。在属性检查器中，点击标签文本框，输入**名字**作为显示文本，如图 9-14 所示。

现在我们希望使用“大小检查器”来设置标签的大小和位置。在 Xcode 故事板中，宽度和高度是以*点*为单位的。注意，1 个点并不等于 1 个像素。根据应用运行的设备类型，1 个点可能对应 1 个像素、2×2 像素的正方形或 3×3 像素的正方形。这三个缩放因子被称为@1x、@2x 和@3x（这些是我们设置应用图标时提到的相同尺寸）。设备的点分辨率也不完全相同，宽度范围从 320 到 1,024 点，高度范围从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：显示标签* 名字

只有最旧型号的 iPhone 和 iPod 使用@1x 缩放因子，你将无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们很可能使用@2x 缩放因子，后者使用@3x 缩放因子。

对象在屏幕上的位置也是基于点数来计算的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（参见图 9-15）。我们将设置每个添加到视图控制器中的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们想将第一个标签的位置调整一下，使其不在屏幕边缘，但又能为文本输入字段和其他标签及输入控件留出足够的空间。在 Size Inspector 的 View 部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成这一步后，重复这些步骤，在“添加生日”视图控制器中添加两个标签：姓氏标签和生日标签。我们需要将其他标签和输入控件的位置设置好，以避免它们重叠。在某些情况下，这可能会有些棘手，并且可能需要一些时间。对于这个应用，我们已经为你计算出了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何让你的应用支持其他设备。表 9-1 列出了你应该为每个标签设置的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，所以 y 位置必须比下一个最近的标签高出至少 21 个点。由于我们还将在每个标签下方添加输入控件，因此我们将 y 位置设置得更大，以适应标签和输入控件的高度。

太棒了！现在你的故事板应该像图 9-16 中一样。

![Image](img/Image00214.jpg)

*图 9-16：已将输入标签添加到视图控制器中。*

接下来，你将添加两个*文本字段*，让你可以输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们就可以在文本框中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器上。其中一个用于输入名字，另一个用于输入姓氏。为这两个文本字段设置表 9-2 中显示的尺寸和位置。你可以使用大小检查器，就像设置标签一样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个元素是一个被称为 *日期选择器* 的滚轮。这个滚轮将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像日历应用中使用的日期选择器一样（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器进行日期选择。*

日期选择器也可以只显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的功能。

在对象库中滚动，直到找到一个日期选择器，然后点击并将其拖到“出生日期”标签下的视图控制器上。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：修改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改成你的出生日期！将日期字段从“当前日期”改为**自定义**。当你这样做时，一个新的框会出现。将这个日期改成你的出生日期。

让我们通过运行应用程序来测试目前的效果！我们为输入控件所使用的尺寸非常适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击“出生日期”视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![图片](img/Image00218.jpg)

在 iPhone 7 上看起来很好，但其他设备呢？选择一个较小的模拟器运行应用程序，例如 iPhone 5s，然后重新运行应用。你会发现，界面看起来有些不对劲。

所有添加到故事板中的元素都已显示，但文本字段超出了屏幕的边缘。现在，您已将所有元素添加到屏幕上，下一步是确保它们能够在任何屏幕尺寸上正确显示。我们将通过一个叫做*自动布局*的工具来实现这一点。

#### 让您的应用在每个设备上都看起来完美的自动布局

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会有更多尺寸。您需要设计应用程序，使其在任何设备上看起来都很合适。这意味着，您需要让应用自动调整屏幕上所有元素的位置和大小，以适应应用运行的设备。自动布局使用一种叫做*布局约束*的方式来安置屏幕上的元素。您需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部第四个图标，调出自动布局菜单。*

在屏幕故事板面板的底部，有一个带有图标的带状区域，位于实用工具面板前的最右侧图标是一个夹在两条竖直线之间的三角形。将鼠标光标悬停在该图标上时，应该会显示一个标签，标明“解决自动布局问题”。点击此图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*) 这样做时，您会看到添加生日场景中添加了一大堆布局约束。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局会确保日期选择器的宽度适应屏幕，并且不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点的间隔，使其在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，添加生日的界面应该显示得完美无缺。

#### 添加保存和取消按钮

为了完成这项工作，我们将向您展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。现在这些按钮不会执行任何操作，我们只是在设置它们。在第十章，我们将添加一些代码，使它们能取消添加生日界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们对添加按钮所做的一样。选择按钮项，然后使用属性检查器将其转变为保存按钮。

最后，让我们添加“取消”按钮。从对象库中再拖动一个 Bar Button Item，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为“取消”按钮，就像你设置“保存”按钮一样。你的视图控制器应该如图 9-21 所示。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新按钮的效果！

在“生日”表视图控制器上点击 + 按钮，应该会进入“添加生日”视图控制器，在这里你可以输入一个人的名字和生日日期。点击“取消”和“保存”按钮目前还没有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始创建了一个 BirthdayTracker 应用，创建了“生日”和“添加生日”屏幕的基本用户界面。你还使用表视图控制器创建了“生日”屏幕，并使用户能够通过“添加”按钮和导航控制器在屏幕之间导航。

现在你的应用的基本框架已经完成，你将在第十章编写“取消”和“保存”按钮的代码，从而让你可以在应用中添加和保存生日信息！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择“重置为缺失约束”选项来添加缺失的约束。

*图 9-9：将一个 Bar Button Item 拖动到“生日”视图控制器的导航栏上。*

![图片](img/Image00207.jpg)

*图 9-10：从“添加”按钮拖动到相邻的视图控制器，并在弹出的对话框中选择“模态呈现”选项。*

连接对话框为你提供了几种*segue*（即从一个屏幕到下一个屏幕的过渡方式）选项。点击连接对话框中的**模态呈现**选项。这将使视图控制器以*模态*视图控制器的形式出现在屏幕上。在 iPhone 上，模态视图控制器从屏幕底部滑动上来，并且通常没有自动带有返回按钮返回到上一屏幕。相反，模态视图可以有其他按钮，比如“取消”或“保存”。还有其他类型的 segue，比如“显示”segue，在这种方式中，视图控制器从右侧推出，并且在导航栏的左侧有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，应该将该屏幕呈现为一个带有“取消”按钮的模态视图。否则，如果你使用类似“显示”segue 并带有返回按钮的方式，用户可能在输入所有内容后点击返回按钮，导致没有保存任何内容！有了“取消”按钮，用户必须刻意点击才能退出该屏幕。

要查看一个好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，在导航栏的右侧有一个 + 按钮，你可以点击它来添加一个日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，用于在不保存的情况下退出屏幕，右侧有一个添加按钮，用于在关闭模态视图之前创建新事件。你应该会看到新事件模态视图从屏幕底部弹出，并在被关闭时向下滑动消失。我们希望用户能保存生日，所以我们也会使用一个模态。

现在让我们试着运行我们的应用，看看到目前为止我们做了什么！要运行应用，首先通过点击 Xcode 左上角的“BirthdayTracker”旁边的设备来选择一个设备模拟器（见 图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角，设备设置在你的应用名称旁边。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。在选择好模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R**。

当模拟器打开以运行你的应用时，如果它太大无法适应电脑屏幕，你可以调整其大小。点击模拟器选择它，然后进入 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时，什么也没有发生。你应该会看到你的第一个“生日”屏幕，上面有一个 + 按钮，如 图 9-1 中所示。显然，到这个时候，你的“生日”屏幕是空的。点击 + 按钮将会弹出第二个空白屏幕。一旦你查看完应用，点击 Xcode 中的停止按钮来关闭它，这个按钮位于你之前按下的播放按钮旁边。当你停止应用时，你应该会看到你的应用图标出现在模拟器的主屏幕上！（见 图 9-12）

就是这样！现在我们需要配置第二个屏幕，以便可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，您需要将其嵌入到一个独立的导航控制器中。当视图控制器是模态时，它不会继承我们故事板中已有的导航控制器的导航栏。导航控制器提供导航栏，所以我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器来选择普通视图控制器。然后转到**Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在，您应该看到一个导航项已经添加到视图控制器场景下的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**Add a Birthday**。这些步骤与您在给表视图控制器添加标题“Birthdays”时的步骤相同。

现在，当“添加生日”视图控制器在应用中显示时，顶部会显示其标题。

#### 添加朋友的名字和生日

当您在第十章中输入朋友的生日时，您应用中的每个条目都将包括名字、姓氏和出生日期。让我们向“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件是让用户向应用中输入数据的元素，如文本字段或下拉菜单。我们将通过添加输入控件的标签开始，显示用户可以添加的所有信息。

##### 添加和定位标签

我们来做一个标签，显示“First Name”，用于您的“添加生日”视图控制器。这个标签将放在一个文本字段旁边，您将在那里输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们想要使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以*点*为单位进行测量。请注意，1 点不等于 1 像素。根据您的应用运行的设备类型，1 点可能会转换成 1 像素、一个 2×2 像素的正方形，或一个 3×3 像素的正方形。这三种缩放因子分别称为@1x、@2x 和@3x（这些与我们设置应用图标时提到的大小相同）。设备的点分辨率也不相同，宽度从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最老的 iPhone 和 iPod 型号使用 @1x 的缩放因子，而且你无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10+）。除非你的手机或 iPod 使用的是 iPhone 6 Plus、6s Plus 或 7 Plus，它们使用 @3x 缩放因子，否则你的设备很可能使用 @2x 缩放因子。

对象在屏幕上的位置也是基于点来计算的。对象的 x 位置是从屏幕左侧到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15）我们将设置每个库对象的 x 位置和 y 位置，将其添加到视图控制器中。

![图片](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕的边缘之外，但仍然为其文本输入框和其他标签及输入框留下足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成此操作后，重复这些步骤，向“添加生日”视图控制器添加两个标签：一个是姓氏标签，一个是出生日期标签。我们需要调整其他标签和输入框的位置，以避免它们重叠。在某些情况下，这可能会变得有些棘手，并且可能需要一些时间。对于这个应用程序，我们已经为你计算好了适合放置对象的位置，基于 iPhone 7 屏幕。稍后，我们会解释如何使你的应用程序适配其他设备。表 9-1 列出了每个标签应该设置的大小和位置。

表 9-1：视图控制器中的输入标签设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们在垂直方向上对齐，但它们的 y 位置各不相同。每个标签的高度为 21，所以 y 位置需要至少比下一个标签的 y 位置大 21 点。由于我们在每个标签下方也添加了输入控件，所以我们将 y 位置设置得更大，以适应标签和输入控件的高度。

很好！现在你的故事板应该和图 9-16 中的样子一样。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已被添加到视图控制器中。*

接下来，你将添加两个*文本框*，用于输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本框对象到你的视图控制器上。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中看到的尺寸和位置设置它们。你可以像设置标签一样使用尺寸检查器来做。

表 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个叫做*日期选择器*的滚轮。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，允许用户选择日期或时间。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器一样（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以只显示时间，就像在时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中使用的。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到“出生日期”标签下的视图控制器上。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整一下日期选择器的属性。点击选择日期选择器。然后，在属性检查器中，将日期选择器的模式设置为只显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：修改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的出生日期吧！将日期字段从“当前日期”更改为**自定义**。这样，一个新框会出现。将这个日期改为你的出生日期。

让我们通过运行应用来测试目前为止的功能！我们为输入控件使用的尺寸在 iPhone 7 屏幕上显示得很好。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你点击生日视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这个在 iPhone 7 上看起来很棒，但其他设备呢？选择一个更小的模拟器，比如 iPhone 5s，然后再次运行应用。你会发现事情看起来不太对劲。

你添加到故事板中的所有元素都显示出来了，但文本字段超出了屏幕的边缘。现在你已经将所有元素放置在屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确显示。我们将通过一个名为*自动布局*的工具来实现这一点。

#### 使用自动布局使应用在每个设备上都看起来完美

单独的 iPhone 就有三种不同的屏幕尺寸，而且未来可能还会出现更多的屏幕尺寸。你需要设计你的应用，使它能够在任何设备上都显示得很好。这意味着你需要让应用自动调整其中每个元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的方式来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来打开自动布局菜单。*

在屏幕的故事板面板底部有一条带有图标的带状栏，靠近工具面板右侧的图标是一个夹在两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该显示一个标签，上面写着“解决自动布局问题”。点击这个图标，会弹出一份建议菜单。点击**添加缺失的约束**。^(*) 当你执行此操作时，你会看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小都能正确适配屏幕。例如，自动布局确保日期选择器的宽度适配屏幕，并且不会超出边缘。自动布局还会确保每个文本字段前后都有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”界面应该显示完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮目前还没有任何功能，我们只是先设置它们。在第十章中，我们将添加一些代码，使这些按钮能够取消并退出“添加生日”界面，或者将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项并将其放置在导航栏的*右侧*。我们将把这个按钮改成一个保存按钮，像添加按钮一样。选择按钮项，然后使用属性检查器将其改为保存按钮。

最后，我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，这次将它放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，方法和设置保存按钮时一样。你的视图控制器应该像图 9-21 中显示的那样。

![Image](img/Image00220.jpg)

*图 9-21：输入视图控制器，带有取消和保存按钮*

现在再次运行你的应用，看看新按钮的效果！

在生日表视图控制器上点击+按钮应该会带你到“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前不会有什么反应——我们将在第十章中实现这两个按钮！

### 你学到的内容

在本章中，你开始制作一个 BirthdayTracker 应用，通过创建生日和添加生日屏幕的基本用户界面。你还使用表视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本框架，第十章将帮助你编程实现取消和保存按钮，这样你就可以在应用中添加和保存生日信息！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择**重置缺失约束**选项来添加缺失的约束。![Image](img/Image00207.jpg)

*图 9-10：从添加按钮拖动到邻近的视图控制器，并在出现的对话框中选择模态呈现。*

连接对话框为你提供了几种*过渡*选项——即从一个屏幕到另一个屏幕的过渡方式——你可以在两个视图控制器之间选择。点击连接对话框中的**模态呈现**选项。这将使视图控制器作为*模态*视图控制器显示在屏幕上。在 iPhone 上，模态视图控制器从手机底部进入屏幕，并且不会自动带有返回按钮返回到前一个屏幕。相反，模态视图可以有其他按钮，比如取消或保存。还有其他类型的过渡，比如显示过渡（Show segue），在这种过渡中，视图控制器从右侧推到屏幕上，并且在导航栏的左侧会有一个返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，屏幕应该作为模态显示，并带有取消按钮。否则，如果你使用像显示过渡（Show segue）这样的方式，并带有返回按钮，可能会出现用户输入完所有内容后，点击返回按钮却没有保存任何东西的情况！带有取消按钮时，用户必须有意识地点击取消才能退出屏幕。

要查看一个良好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧会有一个 + 按钮，点击它可以添加日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以不保存并退出屏幕，右侧有一个添加按钮，用于在关闭模态之前创建新的事件。你会看到新事件模态从屏幕底部滑上来，关闭时又滑回底部。我们希望用户能够保存生日，因此我们也会使用模态。

现在让我们尝试运行应用程序，看看目前为止我们做了什么！要运行应用程序，首先点击 Xcode 左上角的设备列表，选择一个设备模拟器（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：设置模拟器将运行的设备，在 Xcode 窗口左上角，紧挨着你的应用程序名称。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用程序。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用程序时，如果它的大小过大，无法适应你的电脑屏幕，你可以调整其大小。点击模拟器以选中它，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个更小的缩放比例。

到目前为止，运行应用程序时并没有发生太多事情。你应该能看到第一个“生日”屏幕，并且有一个 + 按钮，如之前在图 9-1 中所示。显然，这时你的“生日”屏幕会是空的。点击 + 按钮将会弹出第二个空白屏幕。查看完应用程序后，点击 Xcode 中的停止按钮关闭它，这个停止按钮在你之前点击的播放按钮旁边。当你停止应用程序时，你应该能够在模拟器的主屏幕上看到你的应用图标！（参见图 9-12）

就这样！接下来，我们需要配置第二个屏幕，以便可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

我们来通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将它嵌入到一个自己的导航控制器中。当视图控制器是模态视图时，它不会继承我们故事板中已有的导航控制器中的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。在故事板中点击选择普通视图控制器。然后进入**编辑器** ▸ **嵌入** ▸ **导航控制器**。现在，你应该可以在视图控制器场景的概述视图中看到一个新的导航项。点击这个新导航项，然后在属性检查器中添加标题**添加生日**。这些步骤和你在为表格视图控制器添加标题“生日”时的操作相同。

现在，当“添加生日”视图控制器出现在应用程序中时，它将在顶部显示标题。

#### 添加你朋友的名字和生日

当你在第十章中输入你朋友的生日时，应用程序中的每个条目都将包含一个名字、一个姓氏和一个出生日期。我们来为“添加生日”视图控制器添加一些*输入控件*，让用户可以为每个人输入所有这些信息。输入控件是允许用户向应用程序输入数据的元素，比如文本框或下拉菜单。我们首先通过添加输入控件标签来开始，标明用户可以输入的所有信息。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个显示“名字”的标签。这个标签将位于一个文本框旁边，用户可以在其中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器上（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在，我们希望使用大小检查器来设置标签的大小和位置。在 Xcode 故事板中，宽度和高度是以*点*为单位测量的。请注意，1 个点并不等于 1 个像素。根据应用运行的设备类型，1 个点可能会转换为 1 个像素、一个 2×2 像素的方块，或者一个 3×3 像素的方块。这三个缩放因子被称为@1x、@2x 和 @3x（这和我们设置应用图标时讨论的大小相同）。不同设备的点分辨率也不相同，宽度范围从 320 到 1024 点，长度范围从 568 到 1366 点。

![Image](img/Image00211.jpg)

*图 9-14：制作标签显示* 名字

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，且您无法在这些型号上运行您的应用（BirthdayTracker 仅支持 iOS 10+）。除非您的 iPhone 或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则很可能它们使用的是 @2x 缩放因子，而这三款设备使用的是 @3x 缩放因子。

对象在屏幕上的位置也是基于点来计算的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15。）我们将设置每个我们添加到视图控制器中的库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置在离屏幕边缘不远的地方，同时留出足够的空间给它的文本输入字段以及其他标签和输入控件。在大小检查器的视图部分，设置 x 位置为 20，y 位置为 100，宽度为 100。高度保持为 21。

完成此操作后，重复这些步骤，为“添加生日”视图控制器添加两个标签：一个姓氏标签和一个出生日期标签。我们需要定位其他标签和输入控件，以确保它们不会重叠。在某些情况下，这可能会变得棘手并且需要一些时间。对于这个应用，我们已经为您计算出了在 iPhone 7 屏幕上放置对象的位置。稍后，我们会解释如何让您的应用在其他设备上运行。表 9-1 列出了您应该给每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

您可以看到，所有标签的 x 位置相同，以便它们在垂直方向上对齐，但它们的 y 位置各不相同。每个标签的高度为 21，所以 y 位置需要比下一个标签高至少 21 点。由于我们也在每个标签下方添加了输入控件，因此我们已将 y 位置增大，以便容纳标签的高度和输入控件的高度。

太棒了！现在您的故事板应该像图 9-16 中的一样。

![图片](img/Image00214.jpg)

*图 9-16：已向视图控制器添加输入标签。*

接下来，您将添加两个*文本字段*，用于输入名字和姓氏。文本字段是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用来输入名字，另一个用来输入姓氏。给这两个文本字段设置表 9-2 中看到的大小和位置。你可以像设置标签一样使用大小检查器来完成这个操作。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X-位置 | Y-位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个称为*日期选择器*的轮盘。这个控件将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中的日期选择器（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器在日历应用中用于选择日期时的界面。*

日期选择器也可以只显示时间，例如用于在时钟应用中添加闹钟的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中使用的。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到“出生日期”标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的几个属性。点击日期选择器选中它，然后在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器会显示当前日期。让我们将这个日期改为你的出生日期！将日期字段从“当前日期”更改为**自定义**。这样会出现一个新框，改为你的出生日期。

让我们通过运行应用来测试目前的功能！我们为输入控件设置的大小在 iPhone 7 屏幕上显示得很好。所以，选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击生日视图控制器上的+按钮时，应该会显示“添加生日”界面，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很好，但其他设备呢？选择一个较小的模拟器运行应用，比如 iPhone 5s，然后再次运行应用。你会发现界面显示有些问题。

你添加到故事板中的所有元素都已显示，但文本框超出了屏幕边缘。现在你已经将所有元素放置在屏幕上，下一步是确保它们能够在任何屏幕尺寸上正确显示。我们将通过一种名为*自动布局*的工具来完成这项工作。

#### 使用自动布局让你的应用在每个设备上看起来完美

iPhone 本身有三种不同的屏幕尺寸，而且未来可能还会有更多尺寸。你需要设计你的应用，使其能够在任何设备上看起来都很不错。这意味着，你需要让应用自动调整应用中所有元素的位置和尺寸，以适应运行该应用的设备。自动布局使用一种叫做*布局约束*的东西来放置元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕故事板窗格的底部，有一个带图标的带状工具条，位于实用工具面板之前的最右边图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击该图标以打开一个建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到很多布局约束已被添加到添加生日场景中。

这些自动布局约束确保每个元素的大小都能正确适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕宽度，不会超出边缘。自动布局还会确保每个文本框前后都有 20 个点，以使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，添加生日界面应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。按钮暂时不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消返回添加生日界面，并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个条形按钮项并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们做的添加按钮一样。选择按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将它放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你之前设置保存按钮一样。你的视图控制器应该像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新的按钮！

点击生日表视图控制器上的 + 按钮应该会带你进入“添加生日”视图控制器，在这里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前什么也不会发生——我们将在第十章中实现这两个按钮！

### 你学到的知识

在本章中，你开始制作一个生日追踪器应用，通过创建“生日”和“添加生日”屏幕的基本用户界面。你还使用表视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用程序的基本框架，接下来你将在第十章中编写代码来实现取消和保存按钮，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

*图 9-10：从添加按钮拖到相邻的视图控制器，并在弹出的对话框中选择“模态呈现”选项。*

连接对话框为你提供了几种不同的*segue*（从一个屏幕到另一个屏幕的过渡）选项。点击连接对话框中的**模态呈现**选项。这将使视图控制器作为*模态*视图控制器出现在屏幕上。在 iPhone 上，模态视图控制器从屏幕底部出现，并且不会自动带有返回按钮来返回到前一个屏幕。相反，模态视图可以有其他按钮，比如取消或保存按钮。还有其他类型的 segue，比如显示 segue，其中视图控制器从右侧推到屏幕上，并且在导航栏的左侧有返回按钮。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，屏幕应该以模态方式显示，并带有取消按钮。否则，如果你使用像“显示 segue”这样的方式，其中带有返回按钮，用户可能会输入所有内容，然后点击返回按钮而没有保存任何内容！使用取消按钮时，用户必须明确点击才能取消该屏幕。

要查看一个良好的模态输入视图控制器示例，可以查看你 iPhone 或 iPad 上的日历应用。打开应用时，导航栏右侧有一个 + 按钮，你可以点击它添加日历事件。点击 + 按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，点击它可以在不保存的情况下退出当前屏幕，右侧有一个添加按钮，可以在关闭模态视图之前创建新事件。你应该会看到新事件模态视图从屏幕底部弹出，然后在关闭时再次下移。我们希望用户保存生日，所以我们也会使用模态。

现在让我们尝试运行应用，看看到目前为止我们做了什么！要运行应用，首先选择一个设备模拟器，方法是点击 Xcode 左上角的“BirthdayTracker”旁边列出的设备（见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：设置模拟器将在 Xcode 窗口左上角与你的应用名称旁边运行的设备。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表来运行你的应用。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮，或使用快捷键 ⌘ -**R**。

当模拟器打开以运行你的应用时，如果应用的尺寸太大，无法适应你的电脑屏幕，你可以调整其大小。点击模拟器以选择它，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用时并没有发生太多事情。你应该会看到你的第一个“生日”屏幕，上面有一个 + 按钮，如图 9-1 中所示。显然，在这一点上，你的“生日”屏幕是空的。点击 + 按钮会弹出第二个空白屏幕。查看完应用后，点击 Xcode 中的停止按钮关闭它，停止按钮位于你之前点击的播放按钮旁边。当你停止应用时，你应该会看到你的应用图标出现在模拟器的主屏幕上！（见图 9-12）。

就是这样！接下来我们需要配置第二个屏幕，以便它可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到一个自己的导航控制器中。当视图控制器是模态时，它不会继承我们在故事板上已有的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中点击视图控制器以选择它，然后前往**编辑** ▸ **嵌入于** ▸ **导航控制器**。现在你应该可以看到，在视图控制器场景下的轮廓视图中已经添加了一个导航项。点击这个新添加的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤和你在为表格视图控制器添加标题“生日”时所做的相同。

现在，当“添加生日”视图控制器出现在应用中时，它将会在顶部标注其标题。

#### 添加朋友的姓名和生日

当你在第十章中输入朋友的生日时，应用中的每一项都将包含一个名字、一个姓氏和一个生日。让我们为“添加生日”视图控制器添加一些*输入控件*，这样用户就可以为每个人输入所有这些信息。输入控件是让用户在应用中输入数据的控件，比如文本框或下拉菜单。我们将从添加所有用户可以输入的信息的输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器添加一个显示“名字”的标签。这个标签将放在一个文本框旁边，用户可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框，输入**名字**作为显示文本，如图 9-14 所示。

现在，我们想使用大小检查器来设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以*点*为单位进行测量。注意，1 点并不等于 1 像素。根据应用运行的设备类型，1 点会转换为 1 像素、2×2 像素的正方形或 3×3 像素的正方形。这三种缩放因子被称为 @1x、@2x 和 @3x（这些与我们设置应用图标时讨论的大小相同）。设备的点分辨率也不完全相同，宽度从 320 到 1,024 点不等，高度从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：制作标签显示* 名字

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，而且您将无法在这些型号上运行您的应用程序（BirthdayTracker 将仅支持 iOS 10 及以上版本）。除非您的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们很可能使用 @2x 缩放因子，后者则使用 @3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是屏幕左侧到对象左侧的距离（以点为单位）。y 位置是屏幕顶部到对象顶部的距离（以点为单位）。(参见 图 9-15)。我们将设置每个库对象在视图控制器中的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置为，既不放在屏幕的边缘，同时还要为其文本输入框以及其他标签和输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成此操作后，重复这些步骤，向“添加生日”视图控制器中再添加两个标签：一个“姓氏”标签和一个“出生日期”标签。我们需要调整其他标签和输入框的位置，以避免重叠。在某些情况下，这可能会变得有些棘手，并且可能需要一些时间。对于这个应用程序，我们已为您计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何让您的应用程序适配其他设备。表 9-1 列出了每个标签应设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | x 位置 | y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

您可以看到所有标签的 x 位置相同，因此它们会垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个最近标签大至少 21 个点。由于我们也将在每个标签下方添加输入控件，因此我们已将 y 位置增大，以适应标签的高度和输入控件的高度。

太好了！现在您的故事板应该像 图 9-16 中的那样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，您将添加两个 *文本字段*，这将允许您输入姓氏和名字。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。给这两个文本字段设置如表 9-2 中所示的大小和位置。你可以使用大小检查器来完成这个操作，就像你为标签所做的那样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你最后需要添加的是一个叫做*日期选择器*的轮盘。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用程序中标准的工具，允许用户选择日期或时间。它可以同时包含日期和时间，就像日历应用中使用的日期选择器（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器来选择日期。*

日期选择器也可以只显示时间，就像时钟应用中用来设置闹钟的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到出生日期标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器进行选择。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器会显示当前日期。我们来将这个日期改成你的出生日期！将日期字段从当前日期改为**自定义**。这样，一个新框会出现。将这个日期改为你的出生日期。

让我们通过运行应用程序来测试一下它到目前为止的效果！我们为输入控件使用的大小非常适合 iPhone 7 的屏幕。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你在生日视图控制器中点击+按钮时，应该会显示添加生日的屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

在 iPhone 7 上看起来不错，但其他设备呢？选择一个较小的模拟器运行应用程序，比如 iPhone 5s，然后再次运行应用程序。你会发现界面看起来不太对劲。

你添加到故事板的所有元素都已出现，但文本字段超出了屏幕的边缘。现在，你已将所有元素放在屏幕上，下一步是确保它们在任何屏幕尺寸上都能正确适配。我们将使用一个叫做*自动布局*的工具来完成这项工作。

#### 使用自动布局让你的应用在每个设备上看起来完美

iPhone 本身就有三种不同的屏幕尺寸，而且未来可能会推出更多尺寸。你需要设计你的应用程序，使其在任何设备上都能显示良好。这意味着你需要让你的应用程序根据运行的设备来调整应用内所有元素的位置和大小。自动布局使用一种叫做*布局约束*的技术来在屏幕上放置元素。你需要在故事板中添加这些约束。

首先，在左侧面板的提纲视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标来打开自动布局菜单。*

屏幕故事板面板底部有一个带图标的带状工具栏，紧挨“实用工具”面板的右侧图标是两个竖直线之间的三角形。将鼠标光标悬停在该图标上，它应该显示一个标签，写着“解决自动布局问题”。点击该图标以显示建议菜单。点击**添加缺失的约束**。^(*) 点击后，你会看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕宽度，不会超出边缘。自动布局还会确保每个文本字段前后都有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮目前还不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，让它们能够退出“添加生日”屏幕并将生日保存到应用中。

为了添加保存按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们在添加按钮时做的那样。选择按钮项，然后使用属性检查器将其转变为保存按钮。

最后，我们来添加取消按钮。再从对象库中拖动一个“Bar Button Item”，这次将它放在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该看起来像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新按钮的效果！

点击生日表视图控制器上的 + 按钮应该会将你带到“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮暂时没有任何效果——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你通过创建生日和添加生日屏幕的基本用户界面开始制作一个 BirthdayTracker 应用程序。你还使用表视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行切换。

现在你已经完成了应用的基本框架，你将在第十章中编写取消和保存按钮的代码，以便你可以在应用中添加和保存生日信息！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是苹果的一个 bug。在这种情况下，选择**重置为缺失约束**选项以添加缺失的约束。

连接对话框为你提供了多种类型的*过渡*（从一个屏幕到下一个屏幕的转换）选项。点击连接对话框中的**模态呈现**选项。这将使视图控制器以*模态*视图控制器的形式显示在屏幕上。在 iPhone 上，模态视图控制器从手机底部滑上屏幕，并且默认没有带返回按钮返回上一屏幕。相反，模态视图可以包含其他按钮，例如取消或保存按钮。还有其他类型的过渡，比如显示过渡（Show segue），这种方式将视图控制器从右侧推出屏幕，并在导航栏的左侧显示一个返回按钮。

在 iOS 应用中，当你呈现一个用于获取和保存用户输入的屏幕时，屏幕应以模态方式显示，并且应包含取消按钮。否则，如果你使用类似“显示过渡”（Show segue）并带有返回按钮，用户可能会在输入完所有内容后点击返回按钮，而不保存任何信息！有了取消按钮，用户必须明确点击才能取消退出屏幕。

要查看一个良好的模态输入视图控制器的示例，可以查看你 iPhone 或 iPad 上的日历应用。打开应用后，你会看到导航栏右侧有一个 + 按钮，点击它可以添加日历事件。点击 + 按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，用来取消并退出当前页面，而右侧有一个添加按钮，用于在关闭模态之前创建新事件。你应该看到“新事件”模态从屏幕底部出现，取消时又会回到屏幕下方。我们希望用户能够保存生日，因此我们也会使用模态视图。

现在让我们试着运行应用，看看到目前为止我们做了什么！要运行应用，首先通过点击 Xcode 左上角列出的设备（在 BirthdayTracker 旁边）来选择一个设备模拟器（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角，应用名称旁边设置模拟器将要运行的设备。这里设备设置为 iPhone 7。*

这将弹出一个设备选项列表，让你选择运行应用的设备。我们选择 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果模拟器的屏幕太大，无法适应你的电脑显示器，你可以调整它的大小。点击模拟器以选中它，然后前往 **窗口** ▸ **缩放**，在模拟器菜单中选择一个更小的缩放比例。

到目前为止，当你运行应用时，功能还不多。你应该看到你的第一个“生日”屏幕，并有一个 + 按钮，正如前面在图 9-1 中所示。显然，在这个阶段，你的“生日”屏幕会是空的。点击 + 按钮会弹出第二个空白屏幕。查看完应用后，通过点击 Xcode 中的停止按钮来关闭它，该按钮位于你之前点击的播放按钮旁边。当你停止应用时，你应该会看到模拟器的主屏幕上出现了你的应用图标！（见图 9-12）

就是这样！现在我们需要配置第二个屏幕，以便用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们从添加“添加生日”视图控制器的标题开始设计。为此，你需要将它嵌入到一个独立的导航控制器中。当视图控制器是模态时，它不会继承我们故事板上已经存在的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的视图控制器来选择该视图控制器，然后选择**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在你应该能看到一个导航项已添加到视图控制器场景下的轮廓视图中。点击这个新的导航项，然后在“属性检查器”中添加标题**Add a Birthday**。这些步骤与你在为表视图控制器添加标题“Birthdays”时所遵循的步骤相同。

现在，当“添加生日”视图控制器在应用中出现时，它将显示顶部的标题。

#### 添加你的朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每一项都将包含名字、姓氏和出生日期。让我们向“添加生日”视图控制器添加一些*输入控件*，以便用户能够输入每个人的信息。输入控件是像文本框或下拉菜单这样的控件，允许用户向应用输入数据。我们将从为所有可以添加的信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“名字”的标签。这个标签将位于一个文本框旁边，你可以在其中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器上（参见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在“属性检查器”中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在我们需要使用“大小检查器”设置标签的大小和位置。在 Xcode 故事板中，宽度和高度以*点（points）*为单位进行测量。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点可能对应 1 像素、2×2 像素的方块，或者 3×3 像素的方块。这三种缩放因子被称为 @1x、@2x 和 @3x（这些大小与我们设置应用图标时讨论的相同）。不同设备的点分辨率也不同，范围从 320 到 1,024 点宽，568 到 1,366 点高。

![图片](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最老款的 iPhone 和 iPod 使用 @1x 缩放因子，而这些型号无法运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，它们使用 @3x 缩放因子，否则很有可能使用 @2x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离（单位：点）。y 位置是从屏幕顶部到对象顶部的距离（见图 9-15）。我们将设置我们添加到视图控制器中的每个库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示屏幕上一个对象的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕的边缘之外，同时仍然留出足够的空间用于文本输入框以及其他标签和输入框。在大小检查器的视图部分，设置 x 位置为 20，y 位置为 100，宽度为 100，保持高度为 21。

完成此操作后，重复这些步骤，将两个标签添加到添加生日视图控制器中：一个姓氏标签和一个生日标签。我们需要将其他标签和输入框的位置调整好，以避免重叠。在某些情况下，这可能会变得棘手，并可能需要一些时间。对于这个应用，我们已经为你计算出了可以放置对象的 iPhone 7 屏幕位置。稍后，我们将解释如何让你的应用适配其他设备。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到所有的标签都有相同的 x 位置，这样它们就垂直对齐了，但每个标签的 y 位置不同。每个标签的高度为 21，所以 y 位置需要比下一个标签至少大 21 个点。由于我们要在每个标签下面添加输入控件，我们将 y 位置设置得更大，以便容纳标签的高度和输入控件的高度。

太棒了！现在你的故事板应该和图 9-16 中的样子一样。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来你将添加两个*文本框*，让你可以输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表格 9-2 设置两个文本字段的大小和位置。你可以通过尺寸检查器来完成这一步，就像你为标签所做的那样。

表格 9-2：视图控制器中的文本字段输入

| 文本字段 | X-位置 | Y-位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做*日期选择器*的控件。它可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用来让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像日历应用中使用的日期选择器一样（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器在日历应用中添加事件时用于选择日期。*

日期选择器还可以仅显示时间，就像时钟应用中用于设置闹钟的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中使用的方式。

滚动对象库，直到找到一个日期选择器，然后点击并拖动它到视图控制器中的“出生日期”标签下方。使用尺寸检查器，将 x-位置设置为 0，y-位置设置为 280。

你可能需要调整日期选择器的一些属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将此日期改为你的出生日期吧！将日期字段从当前日期改为**自定义**。完成后，一个新框会出现，将日期更改为你的出生日期。

让我们通过运行应用程序来测试它目前的功能！我们为输入控件设置的尺寸在 iPhone 7 屏幕上适配良好。所以选择 iPhone 7 模拟器，点击左上角的播放按钮。这一次，当你点击“生日视图控制器”中的 + 按钮时，应该会显示添加生日的界面，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来不错，但其他设备呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，然后重新运行应用程序。你会发现，界面看起来有些不对劲。

你添加到故事板中的所有元素都会显示出来，但文本字段超出了屏幕边缘。现在你已经将所有元素放置在屏幕上，下一步是让它们在任何屏幕尺寸上正确显示。我们将使用一种叫做*自动布局*的工具来完成这项工作。

#### 使用自动布局让你的应用在每个设备上看起来都完美

单独的 iPhone 就有三种不同的屏幕尺寸，未来可能还会有更多尺寸。你需要设计你的应用程序，使其在任何设备上看起来都不错。这意味着你希望你的应用程序能够根据运行应用程序的设备，调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来在屏幕上放置元素。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，看看编辑器窗格右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，弹出自动布局菜单。*

在屏幕的故事板窗格底部有一条带有图标的功能区，位于工具区之前的最右侧图标是一个夹在两条垂直线之间的三角形。将鼠标悬停在该图标上，应该会显示一个标签，上面写着“解决自动布局问题”。点击此图标，弹出一个建议菜单。点击**添加缺失约束**。^(*) 当你这么做时，你会看到许多布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局会确保日期选择器的大小适合屏幕宽度，不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮目前还没有任何功能。我们只是设置它们。在第十章，我们将添加一些代码，使它们可以取消“添加生日”屏幕并保存生日信息到应用程序中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改成一个保存按钮，就像我们之前为添加按钮做的那样。选择按钮项，然后使用属性检查器将其改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，并将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，方式与设置保存按钮时相同。你的视图控制器应该和图 9-21 中展示的样子一样。

![Image](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新的按钮！

点击生日表视图控制器中的+按钮应该会进入添加生日视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前不会有任何反应——我们将在第十章中实现这两个功能！

### 你学到了什么

在这一章中，你通过创建生日和添加生日屏幕的基本用户界面，开始制作一个 BirthdayTracker 应用。你还使用表视图控制器创建了生日屏幕，并让用户可以通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本框架，第十章中你将编写取消和保存按钮的功能，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项是禁用的。这是苹果的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

在 iOS 应用中，当你展示一个用于获取和保存用户输入的屏幕时，屏幕应该作为一个模态窗口显示，并且包含一个取消按钮。否则，如果你使用像显示 segue 的方式并带有返回按钮，用户可能会在输入所有内容后点击返回按钮而没有保存任何信息！有了取消按钮，用户必须明确点击取消按钮才能退出屏幕。

要查看一个很好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏的右侧有一个+按钮，你可以点击它来添加一个日历事件。点击+按钮会弹出一个模态的“新事件”视图控制器。这个视图控制器左侧有一个取消按钮，可以在不保存的情况下退出屏幕，右侧有一个添加按钮，可以在关闭模态窗口之前创建新事件。你应该会看到“新事件”模态窗口从屏幕底部出现，关闭时又回到屏幕底部。我们希望用户能够保存生日，所以我们也会使用模态窗口。

现在让我们试着运行一下我们的应用，看看到目前为止我们做了什么！要运行应用，首先选择一个设备模拟器，通过点击 Xcode 左上角 BirthdayTracker 旁边列出的设备（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口的左上角设置模拟器运行的设备，靠近你的应用名称。这里，设备被设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用。我们选择的是 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果它的大小太大，无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器以选择它，然后转到 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用时，似乎没有太多变化。你应该会看到你的第一个生日界面，并且有一个 + 按钮，正如之前在 图 9-1 中所示。显然，在此时，你的生日界面将是空的。点击 + 按钮将弹出第二个空白界面。一旦你看完应用，点击 Xcode 中的停止按钮来关闭应用，这个按钮位于你之前点击的播放按钮旁边。当你停止应用时，你应该能在模拟器的主屏幕上看到你的应用图标！(见 图 9-12。)

就这样！现在我们需要配置第二个屏幕，以便它可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已被添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将它嵌入到自己的导航控制器中。当视图控制器是模态时，它不会继承已经在我们的故事板上的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中点击选择简单视图控制器，然后转到 **编辑** ▸ **嵌入在** ▸ **导航控制器**。现在你应该能看到一个导航项已被添加到视图控制器场景的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题 **添加生日**。这些步骤与添加标题“生日”到你的表视图控制器时是一样的。

现在，当“添加生日”视图控制器在应用中出现时，它的顶部将显示标题。

#### 添加朋友的姓名和生日

当你在 第十章 中输入朋友的生日时，你的应用中的每个条目都会有一个名字、一个姓氏和一个出生日期。让我们在“添加生日”视图控制器中添加一些 *输入控件*，让用户可以为每个人输入这些信息。输入控件是类似文本框或下拉菜单的控件，让用户能够在应用中输入数据。我们将通过添加所有用户可以输入的信息的输入控件标签来开始。

##### 添加和定位标签

为你的“添加生日”视图控制器创建一个标注，文本为“First Name”。这个标签将位于一个文本框旁边，你将在该文本框中输入朋友的名字。请从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（参见 图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在“属性检查器”中，点击标签文本框，输入 **First Name** 作为显示文本，如 图 9-14 所示。

现在，我们需要使用“大小检查器”设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以 *点* 为单位进行测量。请注意，1 点不等于 1 像素。根据应用运行的设备类型，1 点可能会转换为 1 像素、2×2 像素的正方形，或者 3×3 像素的正方形。这三种缩放因子分别称为 @1x、@2x 和 @3x（这也是我们设置应用图标时讨论的尺寸）。设备的点分辨率也不尽相同，可能从宽 320 点到 1,024 点不等，或者从高 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示“First Name”*

只有最老款的 iPhone 和 iPod 使用 @1x 的缩放因子，你将无法在这些型号的设备上运行你的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们大多使用 @2x 的缩放因子，只有这三款使用 @3x 缩放因子。

对象在屏幕上的位置也是基于点来确定的。对象的 x 位置是从屏幕左边缘到对象左边缘的距离，y 位置是从屏幕顶部到对象顶部的距离。（参见 图 9-15）。我们将在添加到视图控制器的每个库对象上设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕的边缘之外，但仍能为文本输入框以及其他标签和输入框留出足够的空间。在“大小检查器”的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，高度保持为 21。

完成此操作后，重复这些步骤，将两个标签添加到“添加生日”视图控制器：一个是“Last Name”标签，另一个是“Birthdate”标签。我们需要调整其他标签和输入框的位置，确保它们不会重叠。在某些情况下，这可能会变得复杂并需要一些时间。对于这个应用程序，我们已经为你计算出了在 iPhone 7 屏幕上的对象放置位置。稍后我们将解释如何让你的应用适配其他设备。表 9-1 列出了每个标签应该设置的大小和位置。

表格 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 X 位置相同，因此它们垂直对齐，但每个标签的 Y 位置不同。每个标签的高度为 21，因此 Y 位置需要至少比下一个标签的 Y 位置大 21 个点。由于我们也将输入控件添加到每个标签下方，因此我们将 Y 位置设置得更大，以便容纳标签的高度和输入控件的高度。

太棒了！现在你的故事板应该像图 9-16 中的那样。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器上。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段设置为表格 9-2 中显示的尺寸和位置。你可以像设置标签一样，使用大小检查器来完成这一操作。

表格 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后，你需要添加的是一个叫做*日期选择器*的控件。它将帮助你轻松地输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器一样（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以只显示时间，就像时钟应用中添加闹钟的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的功能。

滚动浏览对象库，直到找到日期选择器，然后点击并将其拖到视图控制器中的出生日期标签下方。使用大小检查器，将 X 位置设置为 0，Y 位置设置为 280。

你可能需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为只显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将日期改为你的出生日期！将日期字段从当前日期更改为**自定义**。这样做后，会出现一个新框，修改这个日期为你的出生日期。

让我们通过运行应用程序来测试它到目前为止的效果！我们所使用的输入控件的大小在 iPhone 7 屏幕上适配良好。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你在生日视图控制器中点击 + 按钮时，应该会显示添加生日屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美契合。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器运行应用程序，比如 iPhone 5s，然后再次运行应用程序。你会发现，界面看起来有些不对劲。

所有添加到故事板中的元素都出现了，但文本字段超出了屏幕边缘。现在你已经将所有元素添加到屏幕上，下一步是让它们在任何屏幕尺寸下正确适配。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 使用自动布局让你的应用在每个设备上看起来完美

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会有更多尺寸。你需要设计你的应用，使其在任何设备上看起来都不错。这意味着你需要让应用调整所有元素的位置和大小，以适应正在运行的设备。自动布局使用一种叫做*布局约束*的技术来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标来打开自动布局菜单。*

在屏幕故事板面板的底部，有一条带有图标的带状工具栏，最右侧的图标是两个垂直线之间的三角形。将鼠标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击这个图标，会弹出一个建议菜单。点击**添加缺失的约束**。^(*)这样做后，你会看到一大堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局会使日期选择器的大小适应屏幕的宽度，并防止其超出边缘。自动布局还会确保每个文本框前后都有 20 个点的间距，使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这一次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。按钮目前不会做任何事情，我们只是先设置它们。在第十章 中，我们将添加一些代码，使它们能够退出“添加生日”屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个 Bar Button 项，并将其放置在导航栏的*右侧*。我们将把这个按钮更改为保存按钮，就像我们设置添加按钮一样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button 项，并将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新按钮的效果！

点击生日表视图控制器上的 + 按钮应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮暂时没有任何反应——我们将在第十章 中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始创建一个 BirthdayTracker 应用，通过为“生日”和“添加生日”屏幕创建基本的用户界面。你还使用表视图控制器创建了生日屏幕，并使用户能够通过“添加”按钮和导航控制器在屏幕之间进行导航。

现在，你已经完成了应用的基本框架，在第十章 中，你将编写取消和保存按钮的代码，以便在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用，这是一个 Apple 的 bug。在这种情况下，选择“重置为缺失约束”选项来添加缺失的约束。

要查看一个好的模态输入视图控制器示例，可以看看你 iPhone 或 iPad 上的日历应用。当你打开它时，导航栏右侧有一个 + 按钮，点击它可以添加一个日历事件。点击 + 按钮会弹出一个模态的新事件视图控制器。这个视图控制器左侧有一个取消按钮，可以取消并退出该屏幕而不保存，右侧有一个添加按钮，可以在关闭模态视图前创建新事件。你会看到新事件模态视图从屏幕底部弹出，取消时则会重新向下消失。我们希望用户能够保存生日，所以我们也将使用模态视图。

现在让我们尝试运行应用，看看到目前为止我们做了什么！要运行应用，首先点击 Xcode 左上角的设备列表，选择一个设备模拟器（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角设置模拟器运行的设备，设备设置为 iPhone 7。*

这将弹出一个设备选项列表来运行你的应用。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ - **R**。

当模拟器打开并运行应用时，如果屏幕太大以至于无法在计算机屏幕上显示，你可以调整它的大小。点击模拟器选中它，然后进入 **Window** ▸ **Scale**，在模拟器菜单中选择一个较小的比例。

到目前为止，运行应用时没有发生太多事情。你应该能看到第一个带有 + 按钮的“生日”界面，如图 9-1 中所示。显然，此时“生日”界面将是空的。点击 + 按钮会弹出第二个空白界面。当你查看完应用后，点击 Xcode 中的停止按钮关闭它，停止按钮就在你之前点击的播放按钮旁边。停止应用后，你现在应该能在模拟器的主屏幕上看到你的应用图标！(参见图 9-12)。

就这样！现在我们需要配置第二个屏幕，以便可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，首先添加其标题。为此，你需要将其嵌入到一个导航控制器中。当一个视图控制器是模态的时，它不会继承 storyboard 中已有的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。在 storyboard 中点击选择普通视图控制器。然后前往 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在你应该会看到，在视图控制器场景下的轮廓视图中添加了一个导航项目。点击这个新的导航项目，然后在属性检查器中添加标题 **Add a Birthday**（添加生日）。这些步骤和你在为表视图控制器添加标题“Birthdays”（生日）时所做的一样。

现在，当“添加生日”视图控制器出现在应用中时，它将顶部显示其标题。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友的生日时，每个条目都会包含一个名字、一个姓氏和一个出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，这样用户就可以为每个人输入这些信息。输入控件包括文本字段或下拉菜单，允许用户将数据输入到应用中。我们将从为用户可以添加的所有信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个显示“First Name”（名字）的标签。这个标签将放置在一个文本字段旁边，用户可以在其中输入朋友们的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器中。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name**（名字）作为显示文本，如图 9-14 所示。

现在我们想要使用大小检查器设置标签的大小和位置。在 Xcode 的 storyboard 中，宽度和高度是以*点*为单位来衡量的。请注意，1 个点并不等于 1 个像素。根据应用运行的设备类型，1 个点可能会转化为 1 个像素、一个 2×2 像素的正方形，或一个 3×3 像素的正方形。这三种缩放因子分别被称为 @1x、@2x 和 @3x（这些和我们在设置应用图标时讨论的大小相同）。不同设备的点分辨率也不完全相同，宽度从 320 到 1,024 点不等，高度从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最老款的 iPhone 和 iPod 使用 @1x 缩放因子，您将无法在这些设备上运行您的应用（BirthdayTracker 只支持 iOS 10 及以上版本）。除非您的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们使用的是 @2x 缩放因子。

对象在屏幕上的位置也基于点。对象的 x 位置是从屏幕左边到对象左边的距离，单位是点。y 位置是从屏幕顶部到对象顶部的距离。（见图 9-15）。我们会为每个添加到视图控制器中的库对象设置 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，但仍然为其文本输入框和其他标签、输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成这些步骤后，重复这些步骤，为“添加生日”视图控制器添加两个标签：一个“姓氏”标签和一个“出生日期”标签。我们需要定位其他标签和输入框，以确保它们不会重叠。在某些情况下，这可能会有些棘手，并且可能需要一些时间。对于这个应用，我们已经为您计算好了可以放置对象的位置，基于 iPhone 7 屏幕的布局。稍后我们会解释如何使您的应用适配其他设备。表格 9-1 列出了每个标签应该设置的尺寸和位置。

表格 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

您可以看到，所有标签的 x 位置都相同，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要至少比下一个最接近的标签高 21 个点。由于我们还在每个标签下方添加了输入控件，因此我们将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

很棒！现在您的故事板应该像图 9-16 中的那样。

![图片](img/Image00214.jpg)

*图 9-16：已将输入标签添加到视图控制器中。*

接下来，您将添加两个*文本框*，用于输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以在该文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本框对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中的尺寸和位置设置这两个文本框。你可以使用大小检查器，就像设置标签一样。

表 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个被称为*日期选择器*的滚轮。它将使你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用程序中用于让用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用程序中使用的日期选择器一样（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以仅显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这也是我们将在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并将其拖动到出生日期标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的一些属性。点击日期选择器将其选中。然后，在属性检查器中，将日期选择器的模式设置为**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器会显示当前日期。我们来将这个日期改为你的出生日期吧！将日期字段从当前日期改为**自定义**。这样，一个新的框将出现。将这个日期改为你的出生日期。

让我们通过运行应用程序来测试一下目前为止的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你在生日视图控制器上点击+按钮时，应该会显示添加生日的界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备呢？选择一个更小的模拟器来运行应用程序，比如 iPhone 5s，然后重新运行应用程序。你会发现一些地方看起来不太对劲。

您添加到故事板的所有元素都已显示，但文本框超出了屏幕的边缘。现在，您已将所有元素放置在屏幕上，接下来的步骤是使它们在任何屏幕尺寸上都能正确适应。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 通过自动布局让您的应用在每个设备上看起来完美

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能会出现更多尺寸。您需要设计应用程序，以便它在任何设备上都能看起来不错。这意味着您希望应用程序能够根据运行应用程序的设备调整屏幕上所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来将元素放置到屏幕上。您需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来打开自动布局菜单。*

屏幕故事板面板的底部有一个带有图标的带状区域，在实用工具面板之前的最右边的图标是一个位于两个垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击该图标以打开建议菜单。点击**添加缺失的约束**。^(*) 当您执行此操作时，您会看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素都能正确调整大小以适应屏幕。例如，自动布局使得日期选择器的大小适应屏幕宽度，并且不会超出边缘。自动布局还会确保每个文本框前后各有 20 个点的间距，以便它们在屏幕上居中显示。

现在，在 iPhone 5s 模拟器上重新运行应用程序。这一次，添加生日的界面应该看起来完美。

#### 添加保存和取消按钮

最后，我们将向您展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。此时，按钮还不会执行任何操作。我们只是先设置好它们。在第十章中，我们将添加一些代码，使得按钮可以取消并退出“添加生日”界面，或者将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个 Bar Button Item 并将其放置在导航栏的*右侧*。我们将把这个按钮更改为保存按钮，就像我们之前为添加按钮所做的那样。选择该按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，和你设置保存按钮时一样。你的视图控制器应该和图 9-21 中显示的样子一致。

![Image](img/Image00220.jpg)

*图 9-21：输入视图控制器，带有取消和保存按钮*

现在再次运行你的应用程序，看看新按钮的效果！

点击生日表格视图控制器中的 + 按钮，将带你进入添加生日视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前还没有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在这一章中，你通过创建生日和添加生日屏幕的基本用户界面，开始了制作 BirthdayTracker 应用程序的过程。你还使用表格视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行切换。

现在你已经完成了应用程序的基本框架，接下来你将在第十章中编写取消和保存按钮的代码，这样你就可以在应用程序中添加并保存生日信息了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项可能被禁用。这是一个苹果的 bug。在这种情况下，选择 **重置缺失约束** 选项来添加缺失的约束。

现在让我们尝试运行应用程序，看看我们目前的进展！要运行应用程序，首先点击 Xcode 左上角的设备列表，选择一个设备模拟器（参见图 9-11）。

![Image](img/Image00208.jpg)

*图 9-11：在 Xcode 窗口左上角，选择你应用程序名称旁边的设备来设置模拟器运行的设备类型。这里选择的是 iPhone 7。*

这将弹出一个设备选项列表供你选择运行应用程序的设备。我们选择的是 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键 ⌘ -**R** 。

当模拟器打开并运行你的应用程序时，如果它的尺寸过大而无法适应你的电脑屏幕，你可以调整模拟器的大小。点击模拟器以选择它，然后进入 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用时并没有发生太多变化。你应该会看到第一个“生日”屏幕，上面有一个 + 按钮，如之前图 9-1 所示。显然，在这一点上，你的“生日”屏幕将是空的。点击 + 按钮将会显示第二个空白屏幕。完成查看应用后，通过点击 Xcode 中的停止按钮关闭它，停止按钮位于你之前按过的播放按钮旁边。当你停止应用时，你现在应该能看到应用图标出现在模拟器的主屏幕上！（见图 9-12）

就这些！现在我们需要配置第二个屏幕，以便它可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：“生日追踪器”应用图标已经添加到主屏幕。*

### 设置控件输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将它嵌入到一个独立的导航控制器中。当一个视图控制器是模态时，它不会继承我们在故事板中已经存在的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过点击故事板中的视图控制器来选择它。然后转到 **编辑器** ▸ **嵌入** ▸ **导航控制器**。现在你应该能看到一个新的导航项已添加到视图控制器场景的轮廓视图下。点击这个新的导航项，然后在属性检查器中添加标题 **添加生日**。这些步骤与当你为表视图控制器添加标题“生日”时所遵循的步骤相同。

现在，当“添加生日”视图控制器出现在应用中时，它的顶部将显示其标题。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友们的生日时，应用中的每一项记录将包括一个名字、一个姓氏和一个出生日期。让我们向“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件是指像文本框或下拉菜单这样的元素，允许用户在应用中输入数据。我们将首先为用户可以添加的所有信息添加输入控件标签。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“First Name”的标签。这个标签将放置在一个文本框旁边，用户可以在其中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name** 作为显示文本，如图 9-14 所示。

现在我们想使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以 *点* 为单位。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点可以转换为 1 像素、2×2 像素的正方形，或 3×3 像素的正方形。这三个缩放因子被称为 @1x、@2x 和 @3x（当我们设置应用图标时讨论过的相同大小）。设备的点分辨率也并非都相同，宽度可以从 320 到 1,024 点不等，高度可以从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示为* 名字

只有最旧的 iPhone 和 iPod 型号使用 @1x 缩放因子，而且你无法在这些设备上运行你的应用（BirthdayTracker 将仅支持 iOS 10+）。除非你的 iPhone 或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，这些型号使用 @3x 缩放因子，否则你的设备可能使用的是 @2x 缩放因子。

物体在屏幕上的位置也是基于点的。物体的 x 位置是从屏幕左侧到物体左侧的距离（单位：点）。y 位置是从屏幕顶部到物体顶部的距离。（见图 9-15）。我们会设置添加到视图控制器中的每个库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上物体的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签放置在屏幕的非边缘位置，同时仍然留出足够的空间给文本输入框和其他标签与输入框。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成此操作后，重复这些步骤，将两个标签添加到“添加生日”视图控制器中：一个“姓氏”标签和一个“出生日期”标签。我们需要安排其他标签和输入框的位置，以确保它们不会重叠。在某些情况下，这可能会变得复杂并需要一些时间。对于此应用，我们已经为你计算了将物体放置在 iPhone 7 屏幕上的位置。稍后我们将解释如何使应用在其他设备上运行。表 9-1 列出了你应为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | x 位置 | y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，这样它们就能垂直对齐，但它们的 y 位置各不相同。每个标签的高度是 21，所以 y 位置需要比下一个标签高至少 21 个点。由于我们也将在每个标签下方添加输入控件，因此我们已经将 y 位置增大，以适应标签的高度和输入控件的高度。

很棒！现在你的故事板应该看起来像 图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：已在视图控制器中添加输入标签。*

接下来你将添加两个*文本字段*，用于输入姓和名。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在文本字段中输入一行文字。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器上。一个用于输入名字，另一个用于输入姓氏。根据 表 9-2 中的大小和位置设置这两个文本字段。你可以使用大小检查器，就像设置标签时一样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加一个叫做*日期选择器*的控件。这将使你能够轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用程序中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，像日历应用中使用的日期选择器（见 图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，像时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这也是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到日期选择器，然后点击并将其拖动到出生日期标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见 图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的生日！将日期字段从当前日期改为**自定义**。这样做后，会出现一个新框。将日期更改为你的生日。

让我们通过运行应用程序来测试到目前为止的效果！我们为输入控件设置的尺寸在 iPhone 7 屏幕上显示得很好。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击生日视图控制器上的 + 按钮时，应该会显示添加生日的界面，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，然后再次运行应用程序。你会发现，某些地方看起来不太对劲。

所有你添加到故事板的元素都已显示，但文本框超出了屏幕边缘。现在你已经将所有元素放在了屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确显示。我们将使用一种叫做*自动布局*的工具来完成这项工作。

#### 在每个设备上通过自动布局让你的应用看起来完美

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能会有更多的尺寸出现。你需要设计你的应用程序，使其在任何设备上都能良好显示。这意味着你需要让你的应用程序调整屏幕上所有元素的位置和大小，以适应运行应用程序的设备。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕故事板面板的底部，有一个带有图标的带状工具栏，工具栏中靠近实用工具面板的最右侧是一个位于两条垂直线之间的三角形。将鼠标悬停在该图标上，它应该会显示一个标签，上面写着“解决自动布局问题”。点击该图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*) 完成此操作后，你会看到一大堆布局约束被添加到了添加生日的场景中。

这些自动布局约束确保每个元素的大小正确，能够适应屏幕。例如，自动布局会使日期选择器的宽度适应屏幕，并且不会超出边界。自动布局还会确保每个文本字段前后都有 20 个点的间距，使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这时，添加生日的界面应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这一部分，我们将向你展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。按钮目前不会做任何事情，我们只会设置它们。在第十章中，我们将添加一些代码，使按钮能够取消添加生日界面并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个 Bar Button Item，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们为添加按钮所做的那样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新按钮的效果！

在生日表视图控制器上点击 + 按钮应该会带你进入添加生日视图控制器，在那里你可以输入一个人的姓名和生日。点击取消和保存按钮目前不会做任何事情——我们将在第十章中实现它们！

### 你学到了什么

在这一章中，你开始制作一个 BirthdayTracker 应用，通过创建生日和添加生日界面的基本用户界面。你还使用表视图控制器创建了生日界面，并使用户能够通过添加按钮和导航控制器在不同的界面之间导航。

现在你已经完成了应用程序的基本框架，在第十章中，你将编写取消和保存按钮的代码，以便你可以在应用程序中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项是禁用的。这是一个苹果的 bug。遇到这种情况时，选择**重置为缺失约束**选项来添加缺失的约束。![Image](img/Image00208.jpg)

*图 9-11：设置模拟器将运行的设备，位于 Xcode 窗口左上角，靠近你的应用名称。这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用程序。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮，或使用快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用程序时，如果模拟器的大小太大，无法适应你的计算机屏幕，你可以调整它的大小。点击选择模拟器，然后转到 **Window** ▸ **Scale**，在模拟器菜单中选择一个更小的缩放比例。

到目前为止，运行应用程序时并没有发生太多事情。你应该可以看到你第一个“生日”屏幕，屏幕上有一个加号按钮，如前面在图 9-1 中所示。显然，到目前为止，你的“生日”屏幕会是空的。点击加号按钮会弹出第二个空白屏幕。查看完应用程序后，通过点击 Xcode 中的停止按钮（位于你之前点击的播放按钮旁边）来关闭它。停止应用程序后，你应该可以在模拟器的主屏幕上看到应用图标！(见图 9-12。)

就是这样！我们现在需要配置第二个屏幕，以便可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们从添加标题开始设计“添加生日”视图控制器。为此，你需要将它嵌入到自己的导航控制器中。当视图控制器是模态时，它不会继承已经在我们故事板上的导航控制器的导航栏。导航控制器提供了一个导航栏，所以我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中点击选择普通视图控制器。然后转到 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在，你应该可以看到一个导航项已被添加到“视图控制器场景”的轮廓视图中。点击这个新添加的导航项，然后在属性检查器中添加标题 **添加生日**。这些步骤与当你为表格视图控制器添加“生日”标题时是一样的。

现在，当“添加生日”视图控制器出现在应用程序中时，它将在顶部显示其标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每条记录将包含名字、姓氏和出生日期。让我们向“添加生日”视图控制器添加一些 *输入控件*，以便用户可以为每个人输入所有这些信息。输入控件包括文本字段或下拉菜单，允许用户将数据输入到应用程序中。我们将从为所有用户可以添加的信息添加输入控件标签开始。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器创建一个名为“First Name”（名字）的标签。这个标签将位于一个文本框旁边，你可以在该文本框中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（参见 图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在“属性检查器”中，点击“标签”文本框，输入 **First Name** 作为显示文本，如 图 9-14 所示。

现在，我们希望使用“大小检查器”设置标签的大小和位置。在 Xcode 故事板中，宽度和高度以 *点*（points）为单位进行测量。请注意，1 个点不等于 1 像素。根据你的应用运行的设备类型，1 个点会转换为 1 个像素、2×2 像素的方块，或 3×3 像素的方块。这三个缩放因子分别称为 @1x、@2x 和 @3x（这些就是我们设置应用图标时提到的大小）。不同设备的点分辨率也不相同，可能从 320 到 1,024 点宽、568 到 1,366 点高不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示“First Name”*

只有最旧款的 iPhone 和 iPod 使用 @1x 的缩放因子，你将无法在这些设备上运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，否则你的手机或 iPod 使用的是 @2x 的缩放因子，而这三款设备使用的是 @3x 的缩放因子。

对象在屏幕上的位置也是基于点（points）的。对象的 x 位置是从屏幕左边到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离（以点为单位）。(参见 图 9-15)。我们将为每个添加到视图控制器中的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置为，不在屏幕边缘，但仍为其文本输入框和其他标签及输入框留有足够的空间。在“大小检查器”中的“视图”部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成后，重复这些步骤，再向“添加生日”视图控制器添加两个标签：一个是“Last Name”（姓氏）标签，一个是“Birthdate”（出生日期）标签。我们需要调整其他标签和输入框的位置，避免它们重叠。在某些情况下，这可能会有些棘手，并且可能需要一些时间。对于这个应用，我们已经为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们会解释如何让你的应用适配其他设备。 表 9-1 列出了你应为每个标签设置的大小和位置。

表 9-1：视图控制器中的输入标签设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们会垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，所以 y 位置需要至少比下一个最接近的标签大 21 个点。由于我们还需要在每个标签下方添加输入控件，因此我们将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

很棒！现在你的故事板应该看起来像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器。*

接下来，你将添加两个*文本字段*，它们允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们将能够在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器上。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中的大小和位置调整这两个文本字段。你可以使用大小检查器，就像你为标签所做的那样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个元素是一个叫做*日期选择器*的轮盘。它将帮助你轻松地输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，允许用户选择日期或时间。它可以同时显示日期和时间，就像日历应用中的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以只显示时间，就像时钟应用中的添加闹钟使用的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的。

滚动查看对象库，直到找到日期选择器，然后点击并拖动它到视图控制器的出生日期标签下方。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**而非日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的生日吧！将日期字段从“当前日期”改为**自定义**。这样做后，会出现一个新框，改变这个日期为你的生日。

让我们通过运行应用来测试一下它目前的工作情况！我们为输入控件设置的尺寸在 iPhone 7 屏幕上显示得很好。所以选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这次，当你点击“生日”视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很不错，但其他设备呢？选择一个较小的模拟器，比如 iPhone 5s，再次运行应用。你会看到显示效果不太对。

所有你添加到故事板上的元素都出现了，但是文本框超出了屏幕的边缘。现在你已经将所有元素放到屏幕上，下一步是让它们在任何屏幕尺寸下都能正确显示。我们将使用一个叫做*自动布局*的工具来完成这项工作。

#### 通过自动布局让你的应用在每个设备上看起来都完美

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能会有更多尺寸推出。你需要设计你的应用程序，确保它在任何设备上都能显示得很好。这意味着你需要让应用程序根据其运行的设备调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来排列屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕的故事板面板底部，有一个包含图标的带状区域，位于工具面板之前的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击此图标，弹出建议菜单。点击**添加缺失的约束**。^(*) 当你这么做时，你会看到一大堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局会使得日期选择器的宽度适应屏幕，避免超出边缘。自动布局还会确保每个文本框前后各有 20 个点的间距，以便它们能够在屏幕上居中显示。

现在，在 iPhone 5s 模拟器上再次运行应用程序。这时，添加生日的界面应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。按钮目前不会执行任何操作，我们只是进行设置。在 第十章 中，我们将添加一些代码，让它们能够取消并退出添加生日界面，或者将生日保存到应用程序中。

为了添加保存按钮，从对象库拖动一个“Bar Button Item”并将其放置在导航栏的 *右* 边。我们将把这个按钮设置为保存按钮，就像我们之前设置添加按钮一样。选择该按钮项，然后使用属性检查器将其转换为保存按钮。

最后，添加取消按钮。将另一个“Bar Button Item”从对象库拖动到导航栏的 *左* 边。使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该像 图 9-21 所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新按钮的效果！

点击生日表视图控制器上的 + 按钮，应该会带你进入“添加生日”视图控制器，在这里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前没有任何反应——我们将在 第十章 中实现这两个按钮！

### 你学到的内容

在本章中，你通过创建“生日”和“添加生日”屏幕的基本用户界面，开始了制作生日追踪应用的工作。你还使用表视图控制器创建了“生日”屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间导航。

现在，你已经完成了应用程序的基本框架，接下来将在 第十章 中编写代码，实现取消和保存按钮的功能，这样你就能在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个苹果的 bug。在这种情况下，选择 **重置为缺失约束** 选项来添加缺失的约束。

*图 9-11：在 Xcode 窗口的左上角，应用程序名称旁边设置模拟器将运行的设备。在这里，设备设置为 iPhone 7。*

这将弹出一个设备选项列表，用于运行你的应用程序。我们选择的是 iPhone 7。选择好模拟器后，点击左上角的播放按钮，或者使用快捷键⌘ -**R**。

当模拟器打开并运行你的应用时，如果模拟器的大小太大，无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器以选择它，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，当你运行应用程序时并不会发生太多事情。你应该能看到第一个生日屏幕，并且屏幕上有一个+按钮，如之前在图 9-1 中所示。显然，这时你的生日屏幕将是空的。点击+按钮将弹出第二个空白屏幕。看完应用后，点击 Xcode 中的停止按钮，停止应用，停止按钮就在你之前点击的播放按钮旁边。当你停止应用时，你应该能在模拟器的主屏幕上看到你的应用图标！（见图 9-12）。

就是这样！现在我们需要配置第二个屏幕，以便可以用来添加生日！

![图片](img/Image00209.jpg)

*图 9-12: 生日追踪器应用图标已添加到主屏幕上。*

### 设置控制输入和标签

我们来通过添加标题开始设计“添加生日”视图控制器。为此，你需要将它嵌入到自己的导航控制器中。当一个视图控制器是模态视图时，它不会继承我们故事板中已有的导航控制器的导航栏。导航控制器是提供导航栏的控件，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。在故事板中点击选择空白视图控制器，然后进入**编辑** ▸ **嵌入于** ▸ **导航控制器**。现在，你应该能看到在“视图控制器场景”下的轮廓视图中添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤和你之前为表视图控制器添加标题“生日”时的步骤相同。

现在，当“添加生日”视图控制器出现在应用程序中时，它将会在顶部显示标题。

#### 添加朋友的名字和生日

当你在第十章中输入朋友的生日时，你的应用中每个条目将包括名字、姓氏和出生日期。我们来给“添加生日”视图控制器添加一些*输入控件*，让用户可以为每个人输入这些信息。输入控件就是像文本字段或下拉菜单这样的控件，允许用户在应用中输入数据。我们将从为用户可以添加的所有信息添加输入控件标签开始。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器制作一个显示“名字”的标签。这个标签将放在一个文本框旁边，你将在其中输入朋友的名字。找到并从“对象库”中拖拽一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，修改标签的显示文本。在“属性检查器”中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在我们要使用“大小检查器”设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*为单位进行测量的。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点可能会转换成 1 像素、一个 2×2 像素的方块，或者一个 3×3 像素的方块。这三种缩放因子分别称为 @1x、@2x 和 @3x（这些也是我们在设置应用图标时讨论过的尺寸）。不同设备的点分辨率也不同，宽度从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* 名字

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，而你将无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它很可能使用 @2x 缩放因子，而这些型号使用的是 @3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（参见图 9-15。）我们将为每个添加到视图控制器中的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，同时留出足够的空间以容纳文本输入框及其他标签和输入框。在“大小检查器”的“视图”部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成此步骤后，重复这些步骤，为“添加生日”视图控制器添加两个标签：一个是“姓氏”标签，一个是“出生日期”标签。我们需要调整其他标签和输入框的位置，确保它们不会重叠。在某些情况下，这可能会变得有些复杂，且需要一些时间。对于这个应用，我们已经为你计算了可以放置对象的位置，适用于 iPhone 7 屏幕。稍后，我们将解释如何让你的应用在其他设备上运行。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中的输入标签设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，确保它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置至少需要比下一个最近的标签大 21 个点。由于我们也在每个标签下方添加输入控件，所以我们将 y 位置增大，以容纳标签的高度和输入控件的高度。

太棒了！现在你的故事板应该看起来像图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，用于输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在文本字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中的尺寸和位置调整这两个文本字段。你可以使用大小检查器，和之前调整标签的位置一样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后，你需要添加一个称为*日期选择器*的滚轮。这将使你能够轻松地输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的工具，用于让用户选择日期或时间。它可以同时包含日期和时间，就像日历应用中的日期选择器一样（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于日历应用中添加事件时的日期选择。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这就是我们在 BirthdayTracker 中将要使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到出生日期标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的生日！将日期字段从当前日期更改为**自定义**。这样会出现一个新框，修改日期为你的生日。

让我们通过运行应用来测试一下目前为止应用的表现！我们为输入控件设置的尺寸在 iPhone 7 屏幕上非常合适。因此，选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击“生日视图控制器”上的+按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，再次运行应用。你会看到显示效果不太对劲。

所有你添加到故事板的元素都会显示出来，但文本字段超出了屏幕边缘。现在，所有元素都已出现在屏幕上，下一步是确保它们能够在任何屏幕尺寸上正确显示。我们将通过一个叫做*自动布局*的工具来实现这一点。

#### 通过自动布局让你的应用在每个设备上都看起来完美

单单 iPhone 就有三种不同的屏幕尺寸，而且未来可能会出现更多的尺寸。你需要设计你的应用，确保它们在任何设备上看起来都很好。这意味着你需要让你的应用根据设备的不同调整应用中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部第四个图标来打开自动布局菜单。*

在屏幕的故事板面板底部有一个带图标的功能区，位于实用工具面板前的最右侧图标是一个夹在两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，上面写着“解决自动布局问题”。点击该图标以显示建议菜单。点击**添加缺失的约束**。^(*) 这样做后，你会看到一堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕，不会超出边界。自动布局还确保每个文本框前后有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，添加生日界面应该完美显示。

#### 添加保存和取消按钮

为了完成这部分，我们将向你展示如何为添加生日视图控制器的导航栏创建取消和保存按钮。按钮目前不会做任何事情，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消添加生日界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们之前做的添加按钮一样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，并将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像我们之前对保存按钮做的那样。你的视图控制器应当看起来像图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新按钮的效果！

在生日表格视图控制器上点击+按钮应当将你带到添加生日视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前没有任何反应——我们将在第十章中实现它们！

### 你学到了什么

在本章中，你开始制作一个生日跟踪器应用，通过创建生日界面和添加生日界面的基本用户界面。你还使用表格视图控制器创建了生日界面，并使用户可以通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本框架，接下来将在第十章中编程实现取消和保存按钮，这样你就可以在应用中添加并保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个苹果的 bug。如果是这种情况，请选择**重置为缺失约束**选项来添加缺失的约束。

这将弹出一个设备选项列表，用于运行你的应用。我们选择 iPhone 7。选择模拟器后，点击左上角的播放按钮，或者使用键盘快捷键 ⌘ -**R**。

当模拟器打开并运行你的应用时，如果应用窗口过大，无法适应你的电脑屏幕，你可以调整它的大小。点击模拟器以选择它，然后进入**窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的缩放比例。

到目前为止，运行应用时并没有发生太多变化。你应该能看到你的第一个“生日”屏幕，里面有一个“+”按钮，如之前在图 9-1 中所示。显然，此时你的“生日”屏幕是空的。点击“+”按钮将打开第二个空白屏幕。查看完你的应用后，通过点击 Xcode 中的停止按钮来关闭它，停止按钮位于你之前按下的播放按钮旁边。当你停止应用时，你应该能在模拟器的主屏幕上看到你的应用图标！（见图 9-12）。

就是这样！现在我们需要配置第二个屏幕，以便它可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控件输入和标签

让我们开始设计“添加生日”视图控制器，首先添加其标题。为此，你需要将其嵌入一个独立的导航控制器中。当一个视图控制器是模态的时，它不会继承我们故事板上已存在的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入其独立的导航控制器中。在故事板中点击选择普通视图控制器，然后转到**编辑** ▸ **嵌入于** ▸ **导航控制器**。现在你应该能看到，在视图控制器场景下的轮廓视图中，已添加了一个导航项。点击这个新导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与之前在表视图控制器中添加“生日”标题时是一样的。

现在，当“添加生日”视图控制器在应用中出现时，它将会在顶部显示其标题。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每一条记录都会包括一个名字、一个姓氏和一个出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，让用户可以输入每个人的所有信息。输入控件是像文本框或下拉菜单这样的控件，它们允许用户在应用中输入数据。我们将通过添加用于所有信息的输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个显示“名字”的标签。这个标签将位于一个文本框旁边，你将在那里输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器中添加标签。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框，输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们想使用大小检查器设置标签的大小和位置。在 Xcode 的 Storyboard 中，宽度和高度是以*点*为单位进行度量的。请注意，1 个点并不等于 1 个像素。根据应用程序运行的设备类型，1 个点可能转换为 1 个像素、2×2 像素的正方形，或 3×3 像素的正方形。这三种缩放因子被称为@1x、@2x 和@3x（这与我们设置应用图标时提到的大小相同）。不同的设备也不具有相同的点分辨率，宽度可能从 320 到 1,024 点不等，高度则可能从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：让标签显示* First Name

只有最老款的 iPhone 和 iPod 使用@1x 缩放因子，你将无法在这些设备上运行你的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，否则你的手机或 iPod 很可能使用@2x 缩放因子，它们使用的是@3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是屏幕左边到对象左边的距离（以点为单位）。y 位置是屏幕顶部到对象顶部的距离（以点为单位）。(参见图 9-15。)我们将为每个添加到视图控制器中的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，同时还要留出足够的空间以容纳文本输入框和其他标签及输入框。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成这一步后，重复这些步骤，为“添加生日”视图控制器添加两个标签：一个姓氏标签和一个生日标签。我们需要定位其他标签和输入框，避免它们重叠。在某些情况下，这可能会变得有些复杂，需要一些时间。对于这个应用程序，我们已经为你计算好了适用于 iPhone 7 屏幕的控件位置。稍后，我们会解释如何让你的应用在其他设备上运行。表 9-1 列出了你应该给每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个最接近的标签高出至少 21 个点。由于我们还在每个标签下方添加了输入控件，因此我们将 y 位置设置得更大，以容纳标签的高度和输入控件的高度。

太棒了！现在你的故事板应该像图 9-16 一样。

![图片](img/Image00214.jpg)

*图 9-16：输入的标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们将让你输入名字和姓氏。文本字段是 UITextField 类的一个 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个将用于输入名字，另一个将用于输入姓氏。根据表 9-2 中看到的大小和位置调整这两个文本字段。你可以像调整标签一样，使用大小检查器来完成这项操作。

表 9-2：视图控制器中的文本输入字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一项是一个称为*日期选择器*的滚轮。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以同时包含日期和时间，像日历应用中使用的日期选择器一样（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中，日期选择器用于添加事件时选择日期。*

日期选择器还可以只显示时间，像时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这正是我们将在 BirthdayTracker 中使用的。

滚动浏览对象库，直到找到日期选择器，然后点击并将其拖到视图控制器的出生日期标签下方。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整一些日期选择器的属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们把这个日期改成你的生日！将日期字段从“当前日期”改为**自定义**。这样，一个新的框会出现。将这个日期改为你的生日。

让我们运行应用，测试目前的效果！我们所用的输入控件的尺寸在 iPhone 7 屏幕上显示得很好。所以，选择 iPhone 7 模拟器并点击左上角的播放按钮。这时，当你点击“生日视图控制器”上的 + 按钮时，“添加生日”屏幕应该会显示出来，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上显示得非常合适。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来非常棒，但其他设备呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，然后再次运行应用。你会看到一些东西看起来并不太对劲。

你添加到故事板的所有元素都显示出来了，但文本框超出了屏幕边缘。现在，你已经将所有元素放置在屏幕上，下一步是确保它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来完成这一步。

#### 在每个设备上使用自动布局让你的应用看起来完美

单独的 iPhone 就有三种不同的屏幕尺寸，并且未来可能还会出现更多尺寸。你需要设计你的应用程序，让它在任何设备上都能看起来很好。这意味着，你需要让应用自动调整其中所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕故事板面板的底部有一条包含图标的带状栏，靠近“工具面板”之前最右侧的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，上面写着“解决自动布局问题”。点击该图标打开一个建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局会确保日期选择器的大小适应屏幕的宽度，不会超出边缘。自动布局还会确保每个文本字段前后各有 20 个点，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”屏幕应该看起来完美。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。这些按钮暂时不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们可以退出“添加生日”屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右侧*。我们将把这个按钮转换为保存按钮，就像我们处理添加按钮一样。选择该按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将它放置在导航栏的*左侧*。使用属性检查器将其转换为取消按钮，就像我们之前处理保存按钮一样。你的视图控制器应该看起来像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新的按钮！

在“生日”表视图控制器上点击 + 按钮，应该会带你到“添加生日”视图控制器，在这里你可以输入一个人的名字和生日。点击取消和保存按钮暂时没有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用，创建了“生日”和“添加生日”界面的基础。你还使用表视图控制器创建了“生日”屏幕，并使用户能够通过“添加”按钮和导航控制器在屏幕之间切换。

现在你已经完成了应用程序的基本框架，你将在第十章中编写代码，实现取消和保存按钮的功能，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，"Add Missing Constraints" 选项被禁用。这是苹果的一个错误。在这种情况下，选择“**Reset to Missing Constraints**”选项来添加缺失的约束。

当模拟器打开并运行你的应用程序时，如果它的尺寸太大，无法适应你的计算机屏幕，你可以调整它的大小。点击模拟器以选中它，然后转到 **窗口** ▸ **缩放**，在模拟器菜单中选择一个较小的比例。

到目前为止，当你运行应用时，没发生太多事情。你应该能看到你的第一个“生日”界面，界面上有一个 + 按钮，如前面在图 9-1 中所示。显然，在此时，你的“生日”界面将是空的。点击 + 按钮会弹出第二个空白界面。当你查看完应用后，点击 Xcode 中的停止按钮关闭应用，停止按钮位于你之前点击的播放按钮旁边。当你停止应用时，你应该会在模拟器的主屏幕上看到你的应用图标！（见图 9-12）。

就这样！现在我们需要配置第二个界面，使其能够用于添加生日！

![图片](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已被添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到自己的导航控制器中。当一个视图控制器是模态的时，它不会继承我们在故事板上已经设置的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中点击选择普通视图控制器，然后转到 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在你应该会看到一个导航项已被添加到“视图控制器场景”的大纲视图下。点击这个新导航项，然后在属性检查器中添加标题 **添加生日**。这些步骤和你在为表格视图控制器添加“生日”标题时所做的步骤是一样的。

现在，当“添加生日”视图控制器出现在应用中时，它将在顶部显示其标题。

#### 添加朋友的姓名和生日

当你在第十章中输入你朋友的生日时，你的应用中的每一项都会包含名字、姓氏和出生日期。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户能够为每个人输入所有这些信息。输入控件是指像文本框或下拉菜单这样的控件，它们允许用户在应用中输入数据。我们将从为所有可以输入的信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器添加一个显示“名字”的标签。这个标签将位于一个文本框旁边，用于输入你朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加一个标签。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框，并输入 **名字** 作为显示文本，如图 9-14 所示。

现在，我们希望使用大小检查器来设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以 *点* 为单位进行测量。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点将转换为 1 像素、2×2 像素的方块，或者 3×3 像素的方块。这三种缩放因子分别称为 @1x、@2x 和 @3x（与设置应用图标时讨论的大小相同）。设备的点分辨率也并不相同，宽度可以从 320 到 1,024 点，纵向从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：显示标签的制作* 姓名

只有最老款的 iPhone 和 iPod 使用 @1x 缩放因子，你将无法在这些型号上运行你的应用（BirthdayTracker 将只支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，这些型号使用 @3x 缩放因子，其他设备大多数使用 @2x 缩放因子。

一个对象在屏幕上的位置也是基于点来定义的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（见 图 9-15）。我们将设置我们添加到视图控制器的每个库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，但仍然留有足够的空间来放置文本输入框和其他标签及输入字段。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成此操作后，重复这些步骤为“添加生日”视图控制器添加两个标签：姓氏标签和出生日期标签。我们需要设置其他标签和输入框的位置，以避免重叠。在某些情况下，这可能会有些复杂，并且可能需要一些时间。对于这个应用程序，我们已经计算出了可以放置对象的位置，适用于 iPhone 7 屏幕。稍后我们会解释如何让你的应用适配其他设备。表 9-1 列出了每个标签应设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | x 位置 | y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置都相同，因此它们垂直对齐，但它们的 y 位置各不相同。每个标签的高度是 21，因此 y 位置需要比下一个最近的标签至少大 21 个点。由于我们在每个标签下方添加了输入控件，我们还将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

很棒！现在你的故事板应该看起来像图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们将让你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们将能够在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用来输入名字，另一个用来输入姓氏。为这两个文本字段设置表 9-2 中看到的尺寸和位置。你可以使用大小检查器，像为标签做的一样进行操作。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | x 位置 | y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做*日期选择器*的轮子。这将使你能够轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，允许用户选择日期或时间。它可以同时包含日期和时间，就像在“日历”应用中使用的日期选择器（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在“日历”应用中添加事件时使用日期选择器来选择日期。*

日期选择器还可以只显示时间，就像在“时钟”应用中添加闹钟时使用的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中将使用的方式。

滚动浏览对象库，直到找到一个日期选择器，然后点击并将它拖到视图控制器中“出生日期”标签下方。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器来选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。我们来将这个日期改成你的出生日期吧！将日期字段从当前日期更改为 **自定义** 。这样会弹出一个新的框，修改日期为你的出生日期。

让我们测试一下应用程序到目前为止的工作情况吧！我们为输入控件选择的尺寸在 iPhone 7 屏幕上显示得很好。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你点击生日视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如 图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备怎么样呢？选择一个更小的模拟器来运行应用，比如 iPhone 5s，再次运行应用。你会发现看起来不太对劲。

你添加到故事板上的所有元素都显示了出来，但文本框溢出了屏幕边缘。现在，所有元素都已显示在屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确显示。我们将通过一个叫做 *自动布局* 的工具来实现这一点。

#### 通过自动布局让你的应用在每个设备上都完美呈现

单独的 iPhone 就有三种不同的屏幕尺寸，而且未来可能会推出更多尺寸。你需要设计应用程序，以便它在任何设备上看起来都很好。这意味着你需要让你的应用调整应用中所有元素的位置和尺寸，以适应运行应用的设备。自动布局使用一种叫做 *布局约束* 的东西来安排元素的位置。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择 **视图控制器**。接下来，查看编辑器面板右下角的四个图标（见 图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标来打开自动布局菜单。*

在屏幕的故事板面板底部，有一个带图标的工具栏，在工具栏的最右侧，位于“实用工具”面板之前，是一个位于两条垂直线之间的三角形图标。将鼠标悬停在这个图标上，它会显示一个标签，写着“解决自动布局问题”。点击这个图标，弹出一个建议菜单。点击 **添加缺失约束** 。^(*) 当你执行这个操作时，你会看到许多布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕，不会超出边界。自动布局还会确保每个文本字段前后各有 20 个点的间距，从而使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成最后的步骤，我们将向你展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。这些按钮目前不会做任何事情，我们只是先设置它们。在第十章中，我们将添加代码，使它们能够取消“添加生日”屏幕并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个条形按钮项并将其放置在导航栏的*右*侧。我们将把这个按钮改为保存按钮，就像我们之前做的“添加”按钮一样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，我们来添加取消按钮。从对象库中再拖一个条形按钮项，这次将其放置在导航栏的*左*侧。使用属性检查器将其更改为取消按钮，就像你做保存按钮时一样。你的视图控制器应该像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新按钮的效果！

在生日表格视图控制器上点击+按钮，应该会带你到“添加生日”视图控制器，你可以在这里输入一个人的姓名和出生日期。点击取消和保存按钮目前没有任何反应——我们将在第十章中实现它们！

### 你学到了什么

在这一章中，你开始制作一个 BirthdayTracker 应用程序，通过创建生日和添加生日屏幕的基本用户界面。你还使用表格视图控制器创建了生日屏幕，并使用户能够通过“添加”按钮和导航控制器在屏幕之间进行导航。

现在你已经有了应用程序的基本框架，接下来将在第十章中编写代码，实现取消和保存按钮的功能，方便你在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项是禁用的。这是一个苹果的 bug。在这种情况下，选择“**重置为缺失约束**”选项以添加缺失的约束。

到目前为止，当你运行应用程序时并不会发生太多事情。你应该看到你的第一个生日屏幕，上面有一个 + 按钮，如之前在图 9-1 中所示。显然，在这个时候，你的生日屏幕将是空的。点击 + 按钮会弹出第二个空白屏幕。当你看完应用程序后，通过点击 Xcode 中的停止按钮来关闭它，该按钮位于你之前点击的播放按钮旁边。停止应用后，你应该能够在模拟器的主屏幕上看到你的应用图标！（参见图 9-12。）

就是这样！我们现在需要配置第二个屏幕，以便它可以用于添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们通过添加标题来开始设计“添加生日”视图控制器。为此，你需要将其嵌入到自己的导航控制器中。当一个视图控制器是模态时，它不会继承我们故事板上已有的导航控制器中的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到自己的导航控制器中。通过在故事板中点击视图控制器来选择它。然后，转到 **Editor** ▸ **Embed in** ▸ **Navigation Controller**。现在，你应该看到一个导航项已添加到视图控制器场景的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题 **添加生日**。这些步骤与当你为表格视图控制器添加“生日”标题时所执行的步骤相同。

现在，当“添加生日”视图控制器出现在应用中时，它的顶部将显示标题。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每一条记录都将包含名字、姓氏和生日。让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入所有这些信息。输入控件是像文本框或下拉菜单这样的控件，允许用户将数据输入到你的应用中。我们将从添加所有可供用户输入的标签开始。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器创建一个写着“名字”的标签。这个标签将位于一个文本框旁边，你将在其中输入你朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加一个标签。*

接下来，更改标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name** 作为显示文本，如图 9-14 所示。

现在我们要使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以 *点* 为单位的。请注意，1 个点并不等于 1 像素。根据您的应用程序运行的设备类型，1 个点可能会转换为 1 个像素、一个 2×2 像素的方块，或者一个 3×3 像素的方块。这三个缩放因子被称为 @1x、@2x 和 @3x（我们在设置应用图标时讨论过的大小）。设备的点分辨率也不尽相同，宽度从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：制作标签显示* 名字

只有最旧的 iPhone 和 iPod 型号使用 @1x 缩放因子，您将无法在这些型号上运行您的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非您的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们很可能使用 @2x 缩放因子，这些型号使用的是 @3x 缩放因子。

对象在屏幕上的位置也是基于点数的。对象的 x 坐标是从屏幕左侧到对象左侧的点数距离。y 坐标是从屏幕顶部到对象顶部的距离。（参见 图 9-15）我们将设置每个我们添加到视图控制器的库对象的 x 坐标和 y 坐标。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 坐标、y 坐标、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签放置在屏幕边缘之外，同时确保它有足够的空间来容纳文本输入框以及其他标签和输入框。在大小检查器的视图部分，将 x 坐标设置为 20，y 坐标设置为 100，宽度设置为 100。保持高度为 21。

完成此操作后，重复这些步骤将两个标签添加到“添加生日”视图控制器：一个是姓氏标签，一个是出生日期标签。我们需要将其他标签和输入框放置在不重叠的位置。在某些情况下，这可能会变得有些棘手，可能需要一些时间。对于这个应用程序，我们已经为您计算了可以在 iPhone 7 屏幕上放置对象的位置。稍后，我们会解释如何让您的应用程序适配其他设备。表 9-1 列出了您应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | x 坐标 | y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，这样它们就能垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，所以 y 位置需要至少比下一个标签高 21 个点。由于我们也要在每个标签下方添加输入控件，因此我们将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

很棒！现在你的故事板应该和图 9-16 中的一样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已经添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。为这两个文本字段设置在表 9-2 中看到的尺寸和位置。你可以像设置标签一样使用尺寸检查器来完成。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做*日期选择器*的滚轮。它将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像日历应用中的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以只显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中使用的。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到视图控制器中的出生日期标签下方。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的出生日期！将日期字段从当前日期更改为**自定义**。完成此操作后，将出现一个新框。将这个日期更改为你的出生日期。

让我们通过运行应用程序来测试目前为止的工作！我们为输入控件设置的大小在 iPhone 7 屏幕上效果不错。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击生日视图控制器上的 + 按钮时，应该会显示添加生日屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备呢？选择一个更小的模拟器（比如 iPhone 5s）来运行应用，再次运行应用。你会看到界面看起来有些不对劲。

你添加到故事板中的所有元素都出现了，但文本字段超出了屏幕的边缘。现在你已经将所有元素放置在屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来完成这一步。

#### 使用自动布局让你的应用在每个设备上看起来完美

iPhone 本身有三种不同的屏幕尺寸，未来可能会推出更多尺寸。你需要设计你的应用程序，使其在任何设备上看起来都很不错。这意味着你需要让你的应用自动调整应用内所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的东西来定位屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的提纲视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

屏幕故事板面板底部有一个包含图标的带状工具条，工具条中最右侧的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击该图标以打开建议菜单。点击**添加缺失的约束**。^(*)这样做后，你会看到添加生日场景中增加了一堆布局约束。

这些自动布局约束确保每个元素的大小都正确，适合屏幕。例如，自动布局确保日期选择器的宽度适应屏幕宽度，并且不会超出屏幕边缘。自动布局还确保每个文本字段前后各有 20 个点的间隔，这样它们就能在屏幕上居中显示。

现在，在 iPhone 5s 模拟器上重新运行应用程序。这次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作“取消”和“保存”按钮。这些按钮目前不会执行任何操作，我们只是先设置好它们。第十章中，我们将添加代码，使它们可以取消“添加生日”屏幕并将生日保存到应用中。

要添加“保存”按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮改成“保存”按钮，就像我们做的“添加”按钮一样。选择按钮项，然后使用“属性检查器”将其改为“保存”按钮。

最后，让我们添加“取消”按钮。从对象库中再拖动一个“Bar Button Item”，这次将它放置在导航栏的*左侧*。使用“属性检查器”将其改为“取消”按钮，就像你为“保存”按钮所做的那样。你的视图控制器应该像图 9-21 所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在重新运行你的应用，看看新的按钮效果！

在“生日”表视图控制器上点击“+”按钮应该会带你进入“添加生日”视图控制器，你可以在其中输入一个人的姓名和出生日期。点击“取消”和“保存”按钮目前不会有任何反应——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你开始通过为“生日”和“添加生日”屏幕创建基本的用户界面来制作一个 BirthdayTracker 应用。你还使用表视图控制器创建了“生日”屏幕，并设置了用户可以通过“添加”按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本框架，接下来将花费第十章的时间编程实现“取消”和“保存”按钮，这样你就能在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用，这是苹果的一个 BUG。在这种情况下，选择**重置为缺失约束**来添加缺失的约束。

就这些！现在我们需要配置第二个屏幕，以便它可以用来添加生日！

![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们从为“添加生日”视图控制器添加标题开始设计。为此，你需要将其嵌入到一个独立的导航控制器中。当一个视图控制器是模态视图时，它不会继承已经存在于故事板中的导航控制器的导航栏。导航控制器提供了导航栏，所以我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中点击选择普通视图控制器。然后，进入**编辑** ▸ **嵌入于** ▸ **导航控制器**。现在，你应该能看到在视图控制器场景下的轮廓视图中添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与当你为表视图控制器添加标题“生日”时所执行的步骤相同。

现在，当“添加生日”视图控制器在应用中出现时，它将会在顶部显示其标题。

#### 添加朋友的姓名和生日

当你在第十章中输入朋友的生日时，应用中的每个条目都会包含名字、姓氏和出生日期。让我们向“添加生日”视图控制器添加一些*输入控件*，让用户可以为每个人输入这些信息。输入控件是像文本框或下拉菜单之类的控件，允许用户在应用中输入数据。我们将通过为所有用户可以添加的信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“名字”的标签。这个标签将放在一个文本框旁边，用户将在其中输入朋友们的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器上（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在，我们希望使用尺寸检查器来设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*为单位测量的。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点会转化为 1 个像素、一个 2×2 像素的方块或一个 3×3 像素的方块。这三个缩放因子分别被称为@1x、@2x 和@3x（这些和我们在设置应用图标时讨论的大小相同）。设备的点分辨率也并不完全相同，宽度可以从 320 到 1,024 点不等，高度可以从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* 名字

只有最旧的 iPhone 和 iPod 型号使用@1x 缩放因子，您将无法在这些型号上运行您的应用（BirthdayTracker 只支持 iOS 10 及以上版本）。除非您的 iPhone 6 Plus、6s Plus 或 7 Plus 使用@3x 缩放因子，否则您的手机或 iPod 很可能使用@2x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（见图 9-15）。我们将设置每个我们添加到视图控制器中的库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕的边缘之外，但仍然为其文本输入字段和其他标签及输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。保持高度为 21。

完成这些操作后，重复这些步骤，为“添加生日”视图控制器添加另外两个标签：一个姓氏标签和一个生日标签。我们需要定位其他标签和输入框，确保它们不会重叠。在某些情况下，这可能会变得复杂，并且可能需要一些时间。对于这个应用，我们已经为您计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们会解释如何让您的应用在其他设备上运行。表 9-1 列出了您应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

您可以看到所有标签的 x 位置相同，以便它们垂直对齐，但它们的 y 位置不同。每个标签的高度为 21，因此 y 位置至少需要比下一个最近的标签大 21 个点。由于我们还要在每个标签下方添加输入控件，因此我们已将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

很好！现在您的故事板应该看起来像图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，您将添加两个*文本字段*，它们允许您输入姓氏和名字。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段控件到视图控制器上。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段的尺寸和位置设置为表 9-2 所示。你可以通过尺寸检查器来进行设置，和之前设置标签时的方式一样。

表 9-2：视图控制器中输入的文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个叫做*日期选择器*的控件。它将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时显示日期和时间，就像日历应用中的日期选择器（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器来选择日期。*

日期选择器还可以仅显示时间，比如在时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这也是我们在 BirthdayTracker 中将要使用的。

在对象库中滚动直到找到日期选择器，然后点击并拖动它到视图控制器中的出生日期标签下。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将日期更改为你的出生日期！将日期字段从当前日期更改为**自定义**。当你这么做时，一个新框将会出现。把这个日期更改为你的出生日期。

让我们通过运行应用来测试目前的工作情况！我们为输入控件使用的尺寸在 iPhone 7 屏幕上适配得很好。所以，选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你点击生日视图控制器中的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备怎么样呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，然后再次运行应用。你会发现界面看起来不太对劲。

所有你添加到故事板中的元素都会显示出来，但文本框超出了屏幕边缘。现在你已经把所有元素放在屏幕上，接下来的步骤是使它们适应不同的屏幕尺寸。我们将使用一个叫做*自动布局*的工具来完成这项工作。

#### 通过自动布局使你的应用在每个设备上都完美呈现

单独的 iPhone 就有三种不同的屏幕尺寸，而且未来可能会有更多的尺寸出现。你需要设计应用程序，使其在任何设备上都能看起来不错。这意味着，你希望应用程序能够调整所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的方式来在屏幕上放置元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部第四个图标，打开自动布局菜单。*

在屏幕的故事板面板底部，有一排图标，位于工具面板前的最右边图标是两个垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击这个图标，会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 完成后，你会看到“添加生日”场景中添加了许多布局约束。

这些自动布局约束确保每个元素的尺寸正确，以适应屏幕。例如，自动布局会确保日期选择器的宽度适合屏幕，并且不会超出屏幕边缘。自动布局还会确保每个文本框前后有 20 个点的间距，从而使它们在屏幕上居中。

现在在 iPhone 5s 模拟器上重新运行应用程序。这一次，“添加生日”界面应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。按钮暂时不会执行任何操作。我们只是进行设置。在第十章中，我们将添加代码，使这些按钮能够取消“添加生日”界面并保存生日数据到应用中。

为了添加保存按钮，从对象库中拖动一个“条形按钮项”并将其放置在导航栏的*右侧*。我们将把这个按钮改成一个保存按钮，和我们之前为添加按钮所做的一样。选择按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加“取消”按钮。从对象库中拖动另一个条形按钮项，并将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为“保存”按钮所做的一样。你的视图控制器应该看起来像图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新按钮的效果！

在“生日”表视图控制器上点击+按钮应该会带你进入“添加生日”视图控制器，在这里你可以输入一个人的姓名和出生日期。点击“取消”和“保存”按钮暂时没有任何反应——我们将在第十章中实现这两个功能！

### 你学到了什么

在这一章中，你通过创建“生日”和“添加生日”屏幕的基本用户界面，开始制作一个 BirthdayTracker 应用。你还使用表视图控制器创建了“生日”屏幕，并使用户能够通过“添加”按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本框架，你将会在第十章中编程实现“取消”和“保存”按钮，以便在应用中添加和保存生日信息！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用，这是一个苹果的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。![Image](img/Image00209.jpg)

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控件输入和标签

让我们开始设计“添加生日”视图控制器，并首先添加其标题。为此，你需要将其嵌入到一个独立的导航控制器中。当一个视图控制器是模态时，它不会继承我们在故事板上已有的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到一个新的导航控制器中。点击故事板中的普通视图控制器来选择它，然后进入**编辑** ▸ **嵌入** ▸ **导航控制器**。现在，你应该能看到一个导航项目已经被添加到视图控制器场景的轮廓视图中。点击这个新的导航项目，然后在属性检查器中添加标题**添加生日**。这些步骤与你当初为表视图控制器添加“生日”标题时是一样的。

现在，当“添加生日”视图控制器在应用中出现时，它会在顶部显示标题。

#### 添加你朋友的姓名和生日

当你在第十章中输入你朋友的生日时，应用程序中的每个条目都将包含一个名字、姓氏和出生日期。让我们在“添加生日”视图控制器中添加一些*输入控件*，让用户能够为每个人输入这些信息。输入控件是让用户向应用程序输入数据的组件，例如文本字段或下拉菜单。我们将从为用户可以添加的所有信息添加输入控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个显示“First Name”的标签。这个标签将位于一个文本框旁边，你可以在其中输入朋友们的名字。在对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在我们希望使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*为单位的。请注意，1 个点并不等于 1 像素。根据你的应用程序运行的设备类型，1 个点可能转换为 1 像素、一个 2×2 像素的方块，或者一个 3×3 像素的方块。这三种缩放因子被称为 @1x、@2x 和 @3x（这些就是我们在设置应用程序图标时讨论的大小）。不同的设备也有不同的点分辨率，宽度从 320 到 1,024 点不等，高度从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：设置标签显示“First Name”*

只有最老款的 iPhone 和 iPod 使用 @1x 的缩放因子，而且你无法在这些型号上运行你的应用程序（BirthdayTracker 将仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，它们使用 @3x 缩放因子，否则你使用的很可能是 @2x 缩放因子。

对象在屏幕上的位置也是以点为单位的。对象的 x 坐标是从屏幕的左边缘到对象左边缘的距离（单位：点）。y 坐标是从屏幕顶部到对象顶部的距离。（参见图 9-15）我们将设置每个添加到视图控制器中的库对象的 x 坐标和 y 坐标。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 坐标、y 坐标、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签放置在屏幕的边缘之外，但仍然为文本输入框和其他标签及输入框留出足够的空间。在大小检查器的视图部分，将 x 坐标设置为 20，y 坐标设置为 100，宽度设置为 100。将高度保持为 21。

完成上述操作后，重复这些步骤，为“添加生日”视图控制器添加两个标签：姓氏标签和出生日期标签。我们需要调整其他标签和输入框的位置，以免它们重叠。在某些情况下，这可能会变得有些棘手，需要一些时间。对于这个应用程序，我们已经计算出适合放置控件的位置，基于 iPhone 7 屏幕。稍后我们会解释如何让你的应用适配其他设备。表 9-1 列出了你应该为每个标签指定的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个最近的标签高出至少 21 个点。由于我们也在每个标签下方添加了输入控件，因此我们将 y 位置设得更大，以便容纳标签的高度和输入控件的高度。

太棒了！现在你的故事板应该与图 9-16 中的样子类似。

![图片](img/Image00214.jpg)

*图 9-16：输入框的标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们将允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们就能在该字段中输入一行文字。

##### 添加文本字段

从对象库中拖动两个文本字段控件到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。为这两个文本字段设置表 9-2 中看到的大小和位置。你可以像为标签设置一样，使用大小检查器进行调整。

表 9-2：视图控制器中输入框的文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个名为*日期选择器*的控件。这个控件可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中使用的日期选择器一样（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，使用日期选择器进行日期选择。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这就是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到一个日期选择器，然后点击并拖动它到“出生日期”标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整一些日期选择器的属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将这个日期改为你的出生日期！将日期字段从当前日期更改为**自定义**。这样会出现一个新框，修改日期为你的出生日期。

让我们通过运行应用来测试目前为止的效果！我们为输入控件选择的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这时，当你在生日视图控制器上点击“+”按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很不错，但其他设备呢？选择一个更小的模拟器运行应用，例如 iPhone 5s，并再次运行应用。你会看到，某些地方看起来并不太对劲。

你添加到故事板上的所有元素都已显示，但文本字段超出了屏幕的边缘。现在你已经把所有元素放到屏幕上，接下来的步骤是让它们能够适应任何屏幕尺寸。我们将使用一个叫做*自动布局*的工具来完成这项工作。

#### 通过自动布局让你的应用在每个设备上看起来完美

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会有更多的尺寸。你需要设计你的应用，使其在任何设备上都能看起来不错。这意味着你希望你的应用根据运行的设备调整应用中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来在屏幕上放置元素。你需要在故事板中添加这些约束。

首先，在左侧面板的概览视图中选择**视图控制器**。接下来，看看编辑器窗格右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标调出自动布局菜单。*

在屏幕故事板面板的底部，有一个带有图标的带状工具条，实用工具面板前的最右边图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，显示为“解决自动布局问题”。点击此图标以显示一系列建议。点击**添加缺失的约束**。^(*)当你这样做时，你会看到“添加生日”场景添加了一堆布局约束。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局会确保日期选择器的大小适应屏幕宽度，并且不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点，以使它们在屏幕上居中显示。

现在，在 iPhone 5s 模拟器上再次运行应用程序。这次，“添加生日”页面应该看起来完美。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。这些按钮暂时不会执行任何操作。我们只是设置它们。在第十章中，我们将添加一些代码，以便它们可以取消添加生日页面并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮更改为保存按钮，就像我们设置添加按钮一样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该看起来像图 9-21 所示。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新按钮的效果！

点击生日表格视图控制器上的 + 按钮应该会带你进入“添加生日”视图控制器，你可以在这里输入一个人的姓名和出生日期。点击取消和保存按钮暂时不会做任何事情——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你开始制作一个生日追踪器应用程序，创建了生日和添加生日页面的基本用户界面。你还使用表格视图控制器创建了生日页面，并使用户可以通过添加按钮和导航控制器在屏幕之间切换。

现在你已经完成了应用程序的基本骨架，接下来你将在第十章中编写代码，实现取消和保存按钮，以便你可以在应用程序中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是 Apple 的一个 Bug。在这种情况下，选择**重置为缺失约束**选项以添加缺失的约束。

*图 9-12：BirthdayTracker 应用图标已添加到主屏幕。*

### 设置控制输入和标签

让我们开始设计“添加生日”视图控制器，首先添加它的标题。为此，你需要将其嵌入到自己的导航控制器中。当一个视图控制器是模态时，它不会继承我们故事板中已经存在的导航控制器的导航栏。导航控制器提供了导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中点击空白视图控制器，选择**编辑** ▸ **嵌入** ▸ **导航控制器**。现在，你应该看到在“视图控制器场景”下的轮廓视图中添加了一个导航项。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤与你之前为表格视图控制器添加“生日”标题时的步骤相同。

现在，当“添加生日”视图控制器在应用中出现时，它将会在顶部显示标题标签。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友们的生日时，你的应用中的每一条记录都会包含一个名字、姓氏和出生日期。现在，让我们为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件包括文本框或下拉菜单等，允许用户向应用中输入数据。我们将从为所有可以添加信息的输入控件添加标签开始。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器创建一个显示“姓名”的标签。这个标签将放置在一个文本框旁边，供你输入朋友的名字。在对象库中找到并将标签对象拖到“添加生日”视图控制器中（参见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器中。*

接下来，改变标签的显示文本。在属性检查器中，点击标签文本框并输入**姓名**作为显示文本，如图 9-14 所示。

现在我们希望使用尺寸检查器来设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点*为单位测量的。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点会转化为 1 像素、2×2 像素的方块或 3×3 像素的方块。这三个缩放因子分别称为 @1x、@2x 和 @3x（这些和我们设置应用图标时讨论的尺寸相同）。设备的点分辨率也不完全相同，宽度从 320 到 1,024 点不等，高度从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：显示标签“名字”*

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，你将无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的 iPhone 6 Plus、6s Plus 或 7 Plus 使用 @3x 缩放因子，否则你的手机或 iPod 很可能使用 @2x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点数。y 位置是从屏幕顶部到对象顶部的距离。（见 图 9-15）我们会设置我们添加到视图控制器中的每个库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置为不靠近屏幕边缘，但仍然留出足够的空间用于文本输入框以及其他标签和输入框。在尺寸检查器的“视图”部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。保持高度为 21。

完成此操作后，重复这些步骤，向“添加生日”视图控制器中添加两个标签：一个是姓氏标签，另一个是生日标签。我们需要调整其他标签和输入框的位置，以确保它们不会重叠。在某些情况下，这可能会变得有些棘手，并且可能需要一些时间。对于这个应用程序，我们已经为你计算出了在 iPhone 7 屏幕上放置对象的位置。稍后，我们会解释如何让你的应用程序适配其他设备。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，这样它们就能垂直对齐，但每个标签的 y 位置不同。每个标签的高度是 21，因此 y 位置需要比下一个标签至少大 21 个点。由于我们也将输入控件放在每个标签下方，因此我们将 y 位置设置得更大，以适应标签的高度和输入控件的高度。

很棒！现在你的故事板应该和图 9-16 中的样子一样。

![Image](img/Image00214.jpg)

*图 9-16：输入的标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，这将允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段的大小和位置设置为表 9-2 中所示。你可以使用大小检查器，就像你为标签所做的那样。

表 9-2：视图控制器中输入的文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一项是一个叫做*日期选择器*的控件。它将让你轻松地输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，用于允许用户选择日期或时间。它可以包含日期和时间，就像在日历应用中使用的日期选择器一样（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器进行日期选择。*

日期选择器也可以只显示时间，就像在时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到一个日期选择器，然后点击并拖动它到出生日期标签下方的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整一些日期选择器的属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器显示当前日期。让我们将这个日期改为你的生日！将日期字段从当前日期更改为**自定义**。这样做后，会出现一个新框。将该日期改为你的生日。

让我们运行应用程序，测试目前的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上显示良好。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这时，当你点击生日视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备怎么样呢？选择一个较小的模拟器，如 iPhone 5s，再次运行应用程序。你会发现界面显示有些不对劲。

您添加到故事板中的所有元素都已显示，但文本框超出了屏幕的边缘。现在，所有元素都已显示在屏幕上，下一步是让它们在任何屏幕大小上都能正确适配。我们将使用一个名为*自动布局*的工具来实现这一点。

#### 让您的应用在每个设备上都看起来完美，通过自动布局

单独的 iPhone 就有三种不同的屏幕尺寸，并且未来可能会有更多的尺寸。你需要设计应用程序，以确保它在任何设备上看起来都不错。这意味着，你的应用需要根据运行设备自动调整屏幕上所有元素的位置和大小。自动布局使用一种称为*布局约束*的方式来在屏幕上定位元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕故事板面板的底部有一个带图标的带状工具栏，紧挨着实用工具面板的最右边图标是一个夹在两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，提示“解决自动布局问题”。点击该图标，会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 这样，你会看到一堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕，并不会超出屏幕边缘。自动布局还会确保每个文本框前后都有 20 个点的间距，以便它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，“添加生日”屏幕应该显示得很完美。

#### 添加保存和取消按钮

接下来，我们将向你展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。这些按钮现在还不会执行任何操作，我们只是设置它们。在第十章中，我们将添加代码，使这些按钮可以取消“添加生日”屏幕并将生日信息保存到应用中。

要添加保存按钮，从对象库中拖动一个 Bar Button Item，并将其放置在导航栏的*右侧*。我们将把这个按钮设置为保存按钮，就像我们为添加按钮所做的那样。选择按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应与图 9-21 中显示的一致。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新添加的按钮！

点击“生日”表视图控制器上的+按钮，应该会带你进入“添加生日”视图控制器，你可以在这里输入一个人的名字和出生日期。点击取消和保存按钮现在还没有任何反应——我们将在第十章中实现它们的功能！

### 你学到了什么

本章中，你通过创建“生日”和“添加生日”屏幕的基本用户界面，开始制作一个 BirthdayTracker 应用。你还使用表视图控制器创建了“生日”屏幕，并设置用户可以通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本框架，接下来将在第十章编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日信息了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用了，这是 Apple 的一个 bug。如果遇到这种情况，请选择“**重置为缺失约束**”来添加缺失的约束。

### 设置控件输入和标签

我们来开始设计“添加生日”视图控制器，首先添加它的标题。为此，你需要将它嵌入到一个独立的导航控制器中。当视图控制器是模态时，它不会继承我们故事板中已经存在的导航控制器的导航栏。导航控制器提供导航栏，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。在故事板中点击选择普通视图控制器。然后，进入**编辑** ▸ **嵌入** ▸ **导航控制器**。现在，你应该能看到一个导航项目已经被添加到视图控制器场景的轮廓视图中。点击这个新的导航项目，然后在属性检查器中添加标题**添加生日**。这些步骤与之前将标题“生日”添加到你的表视图控制器时是一样的。

现在，当“添加生日”视图控制器出现在应用中时，它将在顶部标注其标题。

#### 添加你的朋友的姓名和生日

当你在第十章中输入你朋友的生日时，应用中的每个条目将包含名字、姓氏和出生日期。接下来，我们在“添加生日”视图控制器中添加一些*输入控件*，以便用户能够为每个人输入这些信息。输入控件是指像文本字段或下拉菜单这样的控件，允许用户在应用中输入数据。我们将通过添加用户可以添加的所有信息的输入控件标签来开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个标签，显示“名字”。这个标签将放在一个文本字段旁边，用于输入你朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：为“添加生日”视图控制器添加标签*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**名字**作为显示文本，如图 9-14 所示。

现在，我们想使用大小检查器来设置标签的大小和位置。在 Xcode 故事板中，宽度和高度是以*点*为单位来测量的。注意，1 个点并不等于 1 个像素。根据你的应用运行的设备类型，1 个点可能对应 1 个像素、一个 2×2 像素的方块，或者一个 3×3 像素的方块。这三种缩放因子分别称为@1x、@2x 和@3x（这些与我们设置应用图标时讨论的大小是一样的）。不同设备的点分辨率也不相同，宽度从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示“名字”*

只有最旧型号的 iPhone 和 iPod 使用@1x 比例因子，你将无法在这些型号上运行你的应用（BirthdayTracker 只支持 iOS 10+）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们的比例因子是@2x，而这三款设备使用的是@3x 比例因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离（单位：点）。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15）。我们将设置每个库对象的 x 位置和 y 位置，添加到视图控制器中。

![图片](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘以外，同时仍然为文本输入字段和其他标签及输入控件留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成后，重复这些步骤，为“添加生日”视图控制器添加两个标签：姓氏标签和出生日期标签。我们需要设置其他标签和输入控件的位置，确保它们不会重叠。在某些情况下，这可能会变得有些棘手，并且可能需要一些时间。对于这个应用，我们已经为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何让你的应用支持其他设备。表 9-1 列出了每个标签应该设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，所以 y 位置需要至少比下一个标签大 21 个点。由于我们也在每个标签下面添加了输入控件，我们已将 y 位置调整得更大，以容纳标签的高度和输入控件的高度。

太好了！现在你的故事板应该像图 9-16 中那样。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器。*

接下来你将添加两个*文本字段*，它们允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段设置为 表 9-2 中显示的大小和位置。你可以通过大小检查器来完成这项操作，和你为标签所做的一样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个元素是一个叫做*日期选择器*的滚轮。这样你就可以轻松输入出生日期了。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时显示日期和时间，就像在日历应用中使用的日期选择器一样（见 图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，日期选择器用于选择日期。*

日期选择器还可以仅显示时间，就像在时钟应用中设置闹钟时使用的日期选择器，或者仅显示日期，这正是我们在生日追踪器中使用的功能。

在对象库中滚动直到找到日期选择器，然后点击并拖动它到视图控制器中的出生日期标签下方。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整一些日期选择器的属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（见 图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器会显示当前日期。让我们将此日期改为你的出生日期！将日期字段从当前日期改为**自定义**。这样会出现一个新框，修改此日期为你的出生日期。

让我们通过运行应用程序来测试一下它目前的工作情况！我们为输入控件使用的尺寸非常适合 iPhone 7 屏幕。所以，选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击“+”按钮进入生日视图控制器时，应该会显示“添加生日”屏幕，如 图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美契合。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很不错，但其他设备呢？选择一个更小的模拟器运行应用程序，比如 iPhone 5s，然后再次运行应用程序。你会看到，界面看起来并不完全合适。

所有添加到故事板中的元素都已出现，但文本字段超出了屏幕的边缘。现在，你已将所有元素添加到屏幕上，下一步是确保它们能够在任何屏幕尺寸上正确显示。我们将使用一种叫做*自动布局*的工具来实现这一点。

#### 使用自动布局让你的应用在每个设备上看起来都完美

iPhone 本身有三种不同的屏幕尺寸，未来可能会出现更多尺寸。你需要设计你的应用程序，使它在任何设备上都看起来很好。这意味着你需要让应用程序调整所有元素的位置和大小，以适应应用程序运行的设备。自动布局使用一种叫做*布局约束*的方式来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标来打开自动布局菜单。*

屏幕故事板面板的底部有一条带图标的带状工具栏，位于工具面板之前的最右侧图标是两个竖线之间的三角形。将鼠标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击该图标，打开一个建议菜单。点击**添加缺失的约束**。^(*) 这样做后，你会看到许多布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适合屏幕的宽度，不会超出边缘。自动布局还确保每个文本字段前后有 20 个点的间距，使它们在屏幕上居中对齐。

现在，在 iPhone 5s 模拟器上重新运行应用程序。这次，添加生日的界面应该看起来完美。

#### 添加保存和取消按钮

为了完成这部分内容，我们将向你展示如何为“添加生日”视图控制器的导航栏添加“取消”和“保存”按钮。这些按钮目前不会做任何事情，我们只是设置它们。在第十章中，我们将添加代码，使它们能够取消“添加生日”界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们之前做的添加按钮一样。选择按钮项，然后使用属性检查器将其改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该看起来像图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新按钮的效果！

点击生日表视图控制器上的+按钮应该会将你带到添加生日视图控制器，在那里你可以输入一个人的名字和生日日期。点击取消和保存按钮目前没有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你通过创建生日和添加生日屏幕的基本用户界面开始制作生日追踪应用。你还使用表视图控制器创建了生日屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本框架，接下来将在第十章中编写取消和保存按钮的代码，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是一个苹果的 bug。在这种情况下，选择**重置为缺失约束**选项以添加缺失的约束。

让我们开始设计添加生日视图控制器，首先添加其标题。为此，你需要将其嵌入到一个自己的导航控制器中。当视图控制器是模态时，它不会继承已经在故事板上的导航控制器中的导航栏。导航控制器是提供导航栏的组件，因此我们需要将模态视图控制器嵌入到它自己的导航控制器中。通过点击故事板中的普通视图控制器来选择它。然后转到**编辑** ▸ **嵌入到** ▸ **导航控制器**。现在，你应该看到一个导航项已被添加到视图控制器场景的轮廓视图中。点击这个新的导航项，然后在属性检查器中添加标题**添加生日**。这些步骤和你为表视图控制器添加“生日”标题时相同。

现在，当添加生日视图控制器出现在应用中时，它的顶部将会显示其标题。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每条记录将包含名字、姓氏和出生日期。让我们在“添加生日”视图控制器中添加一些 *输入控件*，以便用户为每个人输入这些信息。输入控件包括文本框或下拉菜单等，让用户将数据输入到你的应用中。我们将从添加所有可以输入的信息的控件标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器制作一个显示“First Name”的标签。这个标签将位于一个文本框旁边，用户可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器中。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name** 作为显示文本，如图 9-14 所示。

现在我们想使用大小检查器来设置标签的大小和位置。在 Xcode 的 storyboard 中，宽度和高度是以 *点* 为单位进行度量的。注意，1 个点并不等于 1 像素。根据你的应用运行的设备类型，1 个点将转换为 1 像素、2×2 像素的方块或 3×3 像素的方块。这三个缩放因子分别称为 @1x、@2x 和 @3x（这就是我们在设置应用图标时讨论的大小）。不同的设备也不具有相同的点分辨率，宽度可以从 320 到 1,024 点不等，高度可以从 568 到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示“First Name”*

只有最老款的 iPhone 和 iPod 使用 @1x 缩放因子，你将无法在这些设备上运行你的应用（BirthdayTracker 只支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们大概率使用的是 @2x 缩放因子，后者使用 @3x 缩放因子。

对象在屏幕上的位置也是基于点数来计算的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15）我们将设置每个添加到视图控制器中的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们想将第一个标签定位到屏幕边缘之外，但仍然为其文本输入框和其他标签、输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成这一步后，重复这些步骤，将两个标签添加到“添加生日”视图控制器中：一个姓氏标签和一个出生日期标签。我们需要将其他标签和输入框放置在合适的位置，确保它们不重叠。在某些情况下，这可能会变得复杂并且需要一些时间。对于这个应用，我们已为你计算好了在 iPhone 7 屏幕上的控件位置。稍后，我们会解释如何使你的应用适配其他设备。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，这样它们就垂直对齐了，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要至少比下一个最近的标签大 21 个点。由于我们要在每个标签下方添加输入控件，所以我们已经增加了 y 位置，以适应标签的高度和输入控件的高度。

太棒了！现在你的故事板应该看起来像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入框的标签已被添加到视图控制器中。*

接下来你将添加两个*文本字段*，它们将允许你输入姓名和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。按照表 9-2 中的大小和位置设置这两个文本字段。你可以像设置标签一样，使用大小检查器进行设置。

表 9-2：视图控制器中的文本字段输入

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个叫做*日期选择器*的轮盘。它将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以包含日期和时间，就像在日历应用中使用的日期选择器一样（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，日期选择器用于选择日期。*

日期选择器也可以只显示时间，比如在时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到“出生日期”标签下的视图控制器上。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整一些日期选择器的属性。点击日期选择器进行选择。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器会显示当前日期。让我们把这个日期改成你的出生日期！将日期字段从当前日期改为**自定义**。当你这么做时，会出现一个新的框。将此日期更改为你的出生日期。

让我们通过运行应用来测试目前为止它的工作情况！我们为输入控件所使用的尺寸在 iPhone 7 屏幕上适配得很好。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你点击“生日视图控制器”上的 + 按钮时，应该会显示添加生日屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备怎么样？选择一个更小的模拟器，比如 iPhone 5s，然后再次运行应用。你会发现界面看起来有些不对劲。

你添加到故事板中的所有元素都会显示，但文本框超出了屏幕的边缘。现在你已经将所有元素放到屏幕上，下一步是让它们在任何屏幕尺寸上都能够正确显示。我们将通过一个叫做*自动布局*的工具来完成这项工作。

#### 使用自动布局让你的应用在每个设备上都看起来完美

iPhone 本身就有三种不同的屏幕尺寸，而且未来可能会有更多的尺寸发布。你需要设计你的应用，以便它在任何设备上都能看起来不错。这意味着你需要让你的应用根据运行它的设备自动调整应用中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标打开自动布局菜单。*

屏幕故事板面板的底部有一个包含图标的带状工具条，位于工具面板前的最右侧图标是两个垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，上面写着“解决自动布局问题”。点击这个图标，会弹出一菜单，提供一些建议。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到一大堆布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的大小适应屏幕的宽度，不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点，这样它们就会在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”界面应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。按钮目前不会执行任何操作。我们只会设置它们。在第十章中，我们会添加一些代码，让它们退出“添加生日”界面并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右*侧。我们将把这个按钮改成保存按钮，方式与添加按钮一样。选择该按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中再拖动一个条形按钮项，这次将其放置在导航栏的*左*侧。使用属性检查器将其更改为取消按钮，就像你之前做的保存按钮一样。你的视图控制器应该像图 9-21 中显示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新按钮！

点击生日表格视图控制器中的 + 按钮，应该会跳转到“添加生日”视图控制器，在这里你可以输入一个人的姓名和生日日期。点击取消和保存按钮目前不会有任何反应——我们将在第十章 中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用程序，通过创建“生日”和“添加生日”屏幕的基本用户界面。你还使用表格视图控制器创建了“生日”屏幕，并使用户能够通过“添加”按钮和导航控制器在屏幕之间导航。

现在你的应用程序的基本框架已经完成，你将在第十章中编程实现取消和保存按钮，以便你能在应用程序中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是苹果的一个 bug。在这种情况下，选择“**重置为缺失约束**”选项来添加缺失的约束。

现在，当“添加生日”视图控制器在应用中显示时，顶部会显示它的标题。

#### 添加你朋友的名字和生日

当你在第十章中输入朋友的生日时，应用中的每一条记录将包含名字、姓氏和出生日期。我们将为“添加生日”视图控制器添加一些*输入控件*，这样用户就可以为每个人输入所有这些信息。输入控件是像文本框或下拉菜单这样的元素，它们允许用户向应用中输入数据。我们将从添加所有用户可以输入的标签开始。

##### 添加和定位标签

让我们为“添加生日”视图控制器创建一个名为“First Name”（名字）的标签。这个标签将放置在一个文本框旁边，用户可以在该文本框中输入朋友的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到“添加生日”视图控制器。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name** 作为显示文本，如图 9-14 所示。

现在我们希望使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以 *点* 为单位进行测量。请注意，1 点并不是 1 像素。根据你的应用运行的设备类型，1 点可能会转化为 1 像素、2×2 像素的方块或 3×3 像素的方块。这三个缩放因子分别称为 @1x、@2x 和 @3x（我们在设置应用图标时讨论过相同的尺寸）。设备的点分辨率也不完全相同，宽度范围从 320 到 1024 点，高度范围从 568 到 1366 点。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name（名字）

只有最旧款的 iPhone 和 iPod 使用 @1x 缩放因子，你将无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则很可能你的设备使用的是 @2x 缩放因子，这些设备使用的是 @3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕的左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（参见图 9-15）。我们将设置每个添加到视图控制器中的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置在距离屏幕边缘有一定距离的地方，同时为其文本输入框以及其他标签和输入框留出足够的空间。在大小检查器的“视图”部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成此步骤后，重复这些操作，为“添加生日”视图控制器添加两个标签：一个姓氏标签和一个出生日期标签。我们需要调整其他标签和输入控件的位置，确保它们不重叠。在某些情况下，这可能会变得比较复杂，并且需要一些时间。对于这个应用，我们已经为你计算好了可以放置控件的位置，基于 iPhone 7 屏幕。稍后，我们将解释如何让你的应用在其他设备上正常工作。表格 9-1 列出了每个标签应该设置的大小和位置。

表格 9-1：视图控制器中的输入标签设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，因此它们垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置需要比下一个标签的 y 位置大至少 21 个点。由于我们将输入控件放置在每个标签下方，所以我们将 y 位置设置得更大，以容纳标签的高度和输入控件的高度。

很棒！现在你的故事板应该像图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们用于输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在文本字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个将用于输入名字，另一个将用于输入姓氏。给这两个文本字段设置如表格 9-2 所示的大小和位置。你可以像设置标签那样，使用大小检查器来完成这一步。

表格 9-2：视图控制器中的文本字段输入控件

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后，你需要添加一个名为*日期选择器*的控件。这个控件将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器一样（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用的日期选择器。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到出生日期标签下的视图控制器。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器设置为显示当前日期。我们将把这个日期改为你的生日！将日期字段从当前日期更改为**自定义**。这样，一个新框将会出现。将这个日期更改为你的生日。

现在让我们运行应用，看看到目前为止它的工作情况！我们为输入控件使用的尺寸非常适合 iPhone 7 的屏幕。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击出生日期视图控制器上的+按钮时，应该会显示添加生日的界面，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

在 iPhone 7 上看起来很好，但其他设备呢？选择一个更小的模拟器来运行应用，比如 iPhone 5s，再次运行应用。你会看到显示效果并不完全正确。

所有添加到故事板中的元素都显示出来了，但文本字段超出了屏幕的边缘。现在，你的所有元素都已经放到屏幕上，下一步是让它们能够在任何屏幕大小上正确显示。我们将通过一个叫做*自动布局*的工具来实现这一点。

#### 让您的应用在每个设备上都完美显示，使用自动布局

单独的 iPhone 有三种不同的屏幕尺寸，未来可能还会有更多尺寸。你需要设计你的应用，确保它们在任何设备上看起来都很不错。这意味着你需要让你的应用根据设备的不同自动调整界面中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的机制来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标打开自动布局菜单。*

屏幕的故事板面板底部有一条包含图标的带状工具条，位于工具条最右侧、实用工具面板之前的是一个夹在两条垂直线之间的三角形图标。将鼠标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击该图标将弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到大量的布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素都正确调整大小，以适应屏幕。例如，自动布局确保日期选择器的大小适应屏幕宽度，并且不会超出边界。自动布局还会确保每个文本字段前后各有 20 点间距，从而使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这一次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这部分内容，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮目前不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能退出“添加生日”界面并保存生日到应用程序。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮更改为保存按钮，就像我们对添加按钮所做的那样。选择按钮项，然后使用属性检查器将其转变为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其转变为取消按钮，就像你对保存按钮所做的那样。你的视图控制器应该像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行应用程序，看看新按钮的效果！

点击生日表格视图控制器上的 + 按钮应该会带你到“添加生日”视图控制器，在那里你可以输入一个人的姓名和生日日期。点击取消和保存按钮目前不会做任何事——我们将在第十章中实现它们！

### 你学到了什么

在这一章中，你开始制作 BirthdayTracker 应用程序，通过创建 Birthdays 和 Add a Birthday 屏幕的基本用户界面。你还使用表格视图控制器创建了 Birthdays 屏幕，并使用户可以通过 Add 按钮和导航控制器在屏幕之间切换。

现在你已经完成了应用程序的基本框架，你将在 第十章 中编程处理取消和保存按钮，以便在应用中添加和保存生日信息！

* 在某些版本的 Xcode 中，添加缺失约束选项是禁用的。这是 Apple 的一个 bug。在这种情况下，选择 **重置为缺失的约束** 以添加缺失的约束。

#### 添加朋友的姓名和生日

当你在 第十章 输入朋友们的生日时，应用中的每条记录将包含名字、姓氏和出生日期。我们将为 Add a Birthday 视图控制器添加一些 *输入控件*，以便用户为每个人输入这些信息。输入控件是指允许用户将数据输入到应用程序中的控件，例如文本字段或下拉菜单。我们将首先添加用户可以添加的所有信息的输入控件标签。

##### 添加和定位标签

让我们为 Add a Birthday 视图控制器制作一个显示“First Name”的标签。这个标签将放在一个文本字段旁边，用于输入朋友们的名字。在对象库中找到并拖动一个标签对象到 Add a Birthday 视图控制器上（参见 图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：将标签添加到 Add a Birthday 视图控制器中。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name** 作为显示文本，如 图 9-14 所示。

现在我们想使用 Size Inspector 设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以 *点* 为单位测量的。请注意，1 点并不等于 1 像素。根据应用运行的设备类型，1 点可以对应 1 像素、2×2 像素的方块，或者 3×3 像素的方块。这三种缩放因子被称为 @1x、@2x 和 @3x（这和我们设置应用图标时讨论的尺寸相同）。不同设备的点分辨率也不同，宽度可能在 320 到 1,024 点之间，长度可能在 568 到 1,366 点之间。

![Image](img/Image00211.jpg)

*图 9-14：制作显示“First Name”的标签*

只有最老款的 iPhone 和 iPod 使用 @1x 缩放因子，你将无法在这些型号上运行你的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们使用的是 @2x 缩放因子，后者使用的是 @3x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离，单位是点。y 位置是从屏幕顶部到对象顶部的距离。（见图 9-15）。我们将设置每个库对象在视图控制器中的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置为不在屏幕边缘，但仍然留出足够的空间给其文本输入框和其他标签及输入框。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成后，重复这些步骤，在“添加生日”视图控制器中再添加两个标签：一个姓氏标签和一个出生日期标签。我们需要将其他标签和输入框定位，以确保它们不重叠。在某些情况下，这可能会变得有些棘手，并且可能需要一些时间。对于这个应用程序，我们已经为你计算好了在 iPhone 7 屏幕上放置对象的位置。稍后我们将解释如何使应用程序在其他设备上工作。表 9-1 列出了每个标签应设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，这样它们就能垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个最接近的标签至少大 21 个点。由于我们在每个标签下面也添加了输入控件，所以我们将 y 位置设置得更大，以便同时容纳标签的高度和输入控件的高度。

很好！现在你的故事板应该像图 9-16 一样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用来在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在该字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用来输入名字，另一个用来输入姓氏。将两个文本字段设置为表 9-2 中所示的大小和位置。你可以通过大小检查器来完成这一步，和之前为标签所做的操作一样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

您需要添加的最后一个控件是一个叫做*日期选择器*的控件。它可以让您轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，例如在日历应用中使用的日期选择器（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用的日期选择器用于选择日期。*

日期选择器也可以仅显示时间，例如在时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这就是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到视图控制器中的出生日期标签下。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

您需要调整日期选择器的一些属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们把这个日期改成您的出生日期吧！将日期字段从当前日期更改为**自定义**。这样会出现一个新框，您可以将日期更改为您的出生日期。

让我们通过运行应用来测试一下目前的效果！我们为输入控件设置的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当您在生日视图控制器中点击+按钮时，应该会显示“添加生日”界面，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

在 iPhone 7 上看起来很不错，但其他设备呢？选择一个更小的模拟器来运行应用，比如 iPhone 5s，再次运行应用。您会发现界面看起来有些不对劲。

您添加到故事板中的所有元素都已显示出来，但文本字段超出了屏幕的边缘。现在，您已经将所有元素放到了屏幕上，下一步是确保它们能够在任何屏幕尺寸上正确适配。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 通过自动布局让您的应用在每个设备上都完美显示

单单是 iPhone 就有三种不同的屏幕尺寸，未来可能还会有更多尺寸。你需要设计你的应用，使它们能够在任何设备上看起来都很合适。这意味着你需要让应用根据运行应用的设备调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来安排屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕的故事板面板底部，有一个带有图标的带状工具条，位于实用工具面板之前的最右侧是一个两条竖线之间的三角形图标。将鼠标悬停在该图标上时，应该会显示一个标签，提示“解决自动布局问题”。点击该图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到大量的布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕，不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点，以便它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用。这一次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏创建“取消”和“保存”按钮。这些按钮现在还不会执行任何操作，我们只是先设置它们。在第十章，我们将添加一些代码，使它们能够取消退出“添加生日”页面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们为添加按钮所做的那样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该像图 9-21 所示。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在重新运行你的应用，看看新按钮的效果！

在“生日”表视图控制器上点击+按钮，应该会将你带到“添加生日”视图控制器，在那里你可以输入一个人的名字和生日日期。点击“取消”和“保存”按钮目前不会执行任何操作——我们将在第十章中实现这两个按钮的功能！

### 你学到的内容

在本章中，你开始创建一个 BirthdayTracker 应用，通过为“生日”和“添加生日”屏幕创建基本的用户界面。你还使用表视图控制器创建了“生日”屏幕，并使用户可以通过“添加”按钮和导航控制器在屏幕之间进行导航。

现在，你已经完成了应用的基本框架，在第十章中，你将编写代码来实现“取消”和“保存”按钮的功能，以便在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个苹果的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

当你在第十章中输入朋友的生日时，应用中的每个条目将包含一个名字、一个姓氏和一个生日日期。我们来为“添加生日”视图控制器添加一些*输入控件*，以便用户可以为每个人输入这些信息。输入控件是像文本字段或下拉菜单这样的元素，它们允许用户将数据输入到你的应用中。我们将首先添加所有用户可以输入信息的输入控件标签。

##### 添加和定位标签

我们为“添加生日”视图控制器制作一个显示“First Name”的标签。这个标签将位于一个文本字段旁边，你将在其中输入朋友的名字。找到并从对象库中拖动一个标签对象到“添加生日”视图控制器中（参见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：在“添加生日”视图控制器中添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们要使用大小检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度以*点（points）*为单位进行测量。请注意，1 个点并不等于 1 个像素。根据你的应用运行的设备类型，1 个点可能对应 1 个像素、一个 2×2 像素的方块或一个 3×3 像素的方块。这三种缩放因子被称为@1x、@2x 和@3x（这也是我们在设置应用图标时讨论的大小）。设备的点分辨率也并不相同，宽度范围从 320 到 1,024 点，高度范围从 568 到 1,366 点。

![Image](img/Image00211.jpg)

*图 9-14：制作标签显示“First Name”*

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，而这些设备无法运行你的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，这些设备使用 @3x 缩放因子，否则你的手机或 iPod 使用的可能是 @2x 缩放因子。

对象在屏幕上的位置也是基于点数的。对象的 x 位置是从屏幕左侧到对象左侧的距离，以点为单位。y 位置是从屏幕顶部到对象顶部的距离。（见图 9-15）。我们将为每个添加到视图控制器中的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，同时还要为其文本输入框和其他标签及输入框留出足够的空间。在 Size Inspector 的 View 部分，设置 x 位置为 20，y 位置为 100，宽度为 100。高度保持为 21。

完成这些操作后，重复这些步骤，在“添加生日”视图控制器中添加两个标签：姓氏标签和生日标签。我们需要设置其他标签和输入框的位置，以确保它们不会重叠。在某些情况下，这可能会有些棘手，可能需要一些时间。对于这个应用程序，我们已经为你计算了适合放置对象的位置，针对的是 iPhone 7 屏幕。稍后我们将解释如何使你的应用在其他设备上也能正常工作。表 9-1 列出了你应该为每个标签设置的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们在垂直方向上对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要至少比下一个标签的 y 位置大 21 点。由于我们在每个标签下方添加了输入控件，因此我们将 y 位置设置得更大，以容纳标签的高度和输入控件的高度。

很好！现在你的故事板应该看起来像图 9-16 中一样。

![Image](img/Image00214.jpg)

*图 9-16：输入框的标签已添加到视图控制器中。*

接下来你将添加两个*文本框*，它们让你输入名字和姓氏。文本框是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本字段对象到视图控制器中。一个用来输入名字，另一个用来输入姓氏。将这两个文本字段的大小和位置设置为 表 9-2 中所示的样式。你可以像调整标签一样，使用尺寸检查器进行调整。

表 9-2：视图控制器中的文本字段输入

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个叫做*日期选择器*的轮盘。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中的日期选择器（见 图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器选择日期。*

日期选择器还可以仅显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这就是我们在 BirthdayTracker 中将要使用的。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到出生日期标签下的视图控制器中。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**而非日期和时间（见 图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。我们来把这个日期改为你的出生日期吧！将日期字段从“当前日期”更改为**自定义**。这样做后，一个新的框将会出现。把这个日期更改为你的出生日期。

让我们测试一下应用的运行情况！我们为输入控件设置的大小在 iPhone 7 屏幕上适配得很好。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你在生日视图控制器中点击 + 按钮时，应该会显示添加生日的界面，如 图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很好，但其他设备怎么样呢？选择一个更小的模拟器来运行应用，比如 iPhone 5s，然后重新运行应用。你会发现一些显示效果不太对。

您添加到故事板的所有元素都会出现，但文本字段超出了屏幕的边缘。现在，所有元素都已放置在屏幕上，下一步是使它们能够在任何屏幕尺寸上正确显示。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上都看起来完美，使用自动布局

iPhone 单独就有三种不同的屏幕尺寸，未来可能还会有更多尺寸的设备。您需要设计您的应用程序，以便它们在任何设备上都能看起来不错。这意味着，您希望您的应用程序能够调整应用内所有元素的位置和大小，以适应运行应用程序的设备。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。您需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕故事板面板的底部，有一个包含图标的带状区域，位于实用工具面板之前的最右侧的图标是两个垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击这个图标，会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 完成此操作后，您会看到在“添加生日”场景中添加了大量布局约束。

这些自动布局约束确保每个元素的大小都能正确适应屏幕。例如，自动布局确保日期选择器的大小适应屏幕的宽度，不会超出边缘。自动布局还会确保每个文本字段的前后有 20 个点的间距，使它们在屏幕上居中对齐。

现在，再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”界面应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向您展示如何为“添加生日”视图控制器的导航栏制作“取消”和“保存”按钮。按钮暂时还不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消“添加生日”界面并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个“条形按钮项”并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们做的“添加”按钮一样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将它放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该如图 9-21 所示。

![图片](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在重新运行你的应用，查看新按钮的效果！

点击“生日”表格视图控制器中的“+”按钮，应该会跳转到“添加生日”视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前没有任何反应——我们将在第十章中实现它们！

### 你学到了什么

在本章中，你通过创建“生日”和“添加生日”屏幕的基本用户界面，开始了制作一个生日追踪器应用的过程。你还使用表格视图控制器创建了“生日”屏幕，并让用户可以通过“添加”按钮和导航控制器在屏幕之间导航。

现在你已经有了应用的基本框架，你将在第十章中编程实现取消和保存按钮，以便你可以在应用中添加并保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项是禁用的。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

##### 添加和定位标签

让我们为你的“添加生日”视图控制器创建一个显示“名字”的标签。这个标签将放置在一个文本框旁边，你将在那里输入朋友们的名字。从对象库中找到并拖动一个标签对象到“添加生日”视图控制器中（见图 9-13）。

![图片](img/Image00210.jpg)

*图 9-13：向“添加生日”视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框，输入**First Name**作为显示文本，如图 9-14 所示。

现在我们要使用“大小检查器”设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以*点（points）*为单位测量的。请注意，1 点不等于 1 像素。根据你的应用运行的设备类型，1 点将转换为 1 个像素、一个 2×2 像素的方块或一个 3×3 像素的方块。这三种缩放因子分别被称为@1x、@2x 和 @3x（这些就是我们设置应用图标时提到的相同大小）。不同设备的点分辨率也不相同，宽度可以从 320 到 1024 点，高度可以从 568 到 1366 点。

![图片](img/Image00211.jpg)

*图 9-14：制作显示“First Name”标签*

只有最旧的 iPhone 和 iPod 型号使用 @1x 的缩放因子，并且你无法在这些型号上运行你的应用程序（BirthdayTracker 将仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，这些设备使用 @3x 的缩放因子，否则你的设备很可能使用 @2x 的缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离。（参见 图 9-15）。我们将为每个添加到视图控制器的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签定位在屏幕边缘之外，同时仍然留出足够的空间以容纳其文本输入字段以及其他标签和输入项。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成这些操作后，重复这些步骤，再向“添加生日”视图控制器中添加两个标签：姓氏标签和生日日期标签。我们需要将其他标签和输入项定位好，以避免重叠。在某些情况下，这可能会有些棘手，可能需要一些时间。对于这个应用，我们已经为你计算好了适合 iPhone 7 屏幕的对象位置。稍后，我们将解释如何让你的应用在其他设备上工作。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日日期 | 20 | 250 | 100 | 21 |

你可以看到所有的标签具有相同的 x 位置，这样它们就可以垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置需要至少比下一个最接近的标签大 21 个点。由于我们还在每个标签下方添加了输入控件，我们将 y 位置设置得更大，以适应标签和输入控件的高度。

很棒！现在你的故事板应该看起来像 图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已经添加到视图控制器中。*

接下来，你将添加两个 *文本字段*，它们允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们就可以在该字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本框对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。为这两个文本框设置表 9-2 中显示的大小和位置。你可以像调整标签一样，使用大小检查器来完成这一步。

表 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一项控件是一个叫做*日期选择器*的滚轮。这将使你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中的日期选择器（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于日历应用中添加事件时选择日期。*

日期选择器还可以只显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中将使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并将其拖动到视图控制器中的“出生日期”标签下。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们把这个日期改为你的出生日期吧！将日期字段从“当前日期”更改为**自定义**。更改后，会出现一个新框。把日期改为你的出生日期。

让我们通过运行应用程序来测试目前为止的工作！我们为输入控件设置的尺寸在 iPhone 7 屏幕上显示得非常合适。所以，选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你点击“Birthdays”视图控制器上的“+”按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来非常不错，但其他设备呢？选择一个更小的模拟器来运行应用程序，比如 iPhone 5s，并再次运行应用程序。你会发现显示效果不太对劲。

你添加到故事板中的所有元素都已经显示出来，但文本字段超出了屏幕的边缘。现在，你已经将所有元素放到屏幕上，下一步是使它们能够在任何屏幕尺寸上正确显示。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 使用自动布局使你的应用在每个设备上都看起来完美

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能会推出更多尺寸。你需要设计你的应用程序，确保它们在任何设备上都能显示良好。这意味着你需要让你的应用自动调整所有元素的位置和大小，以适应运行该应用的设备。自动布局使用一种叫做*布局约束*的技术来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕故事板窗格的底部，有一排图标，紧挨着实用工具窗格的右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击此图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*) 点击后，你会看到一堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小能够正确适应屏幕。例如，自动布局确保日期选择器的宽度适合屏幕，并且不会超出边缘。自动布局还会确保每个文本字段的前后有 20 个点的间距，使其在屏幕上居中显示。

现在在 iPhone 5s 模拟器上重新运行应用。这次，“添加生日”界面应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这部分内容，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。此时，按钮还没有功能，我们只是进行设置。在第十章中，我们将添加一些代码，使它们能取消添加生日界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“条形按钮项”，并将其放置在导航栏的*右侧*。我们将把这个按钮变成一个保存按钮，就像之前添加按钮时一样。选择该按钮项，然后使用属性检查器将其变成一个保存按钮。

最后，我们来添加取消按钮。从对象库中拖动另一个条形按钮项，这次将它放置在导航栏的*左侧*。使用属性检查器将它设置为取消按钮，方式与设置保存按钮相同。你的视图控制器应该像图 9-21 所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新的按钮！

点击生日表视图控制器上的+按钮，应该会带你进入添加生日视图控制器，在这里你可以输入某人的姓名和出生日期。点击取消和保存按钮目前没有任何反应——我们将在第十章中实现这两个功能！

### 你学到的知识

在本章中，你通过创建生日和添加生日屏幕的基本用户界面，开始制作一个 BirthdayTracker 应用程序。你还使用表视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行导航。

现在你的应用程序的基本框架已经搭建完成，你将在第十章中编程实现取消和保存按钮，这样你就可以在应用程序中添加和保存生日了！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**来添加缺失的约束。

让我们为添加生日视图控制器创建一个显示“First Name”的标签。这个标签将放置在一个文本框旁边，用户可以在其中输入朋友的名字。从对象库中找到并拖动一个标签对象到添加生日视图控制器中（见图 9-13）。

![Image](img/Image00210.jpg)

*图 9-13：在添加生日视图控制器中添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框，并输入**First Name**作为显示文本，如图 9-14 所示。

现在，我们使用大小检查器来设置标签的大小和位置。在 Xcode 故事板中，宽度和高度以*点*为单位。请注意，1 点并不是 1 像素。根据你的应用程序运行的设备类型，1 点可能会转换为 1 个像素、2×2 个像素的正方形，或者 3×3 个像素的正方形。这三个缩放因子分别称为@1x、@2x 和@3x（我们在设置应用程序图标时讨论过这些大小）。不同的设备还拥有不同的点分辨率，宽度可能从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最旧型号的 iPhone 和 iPod 使用@1x 缩放因子，您将无法在这些型号上运行应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非您的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus（它们使用@3x 缩放因子），否则您的设备很可能使用@2x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的距离（单位：点）。y 位置是从屏幕顶部到对象顶部的距离。（参见图 9-15）。我们将为每个添加到视图控制器中的库对象设置 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，但仍然留出足够的空间供文本输入字段和其他标签及输入框使用。在“大小检查器”的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成此操作后，重复这些步骤，向“添加生日”视图控制器添加两个标签：一个姓氏标签和一个生日标签。我们需要为其他标签和输入框设置位置，以避免重叠。在某些情况下，这可能会有些棘手，并且可能需要一些时间。对于此应用程序，我们已经为您计算了将对象放置在 iPhone 7 屏幕上的位置。稍后，我们将解释如何让您的应用程序在其他设备上工作。表 9-1 列出了每个标签应设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

您可以看到，所有标签的 x 位置相同，因此它们垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置需要至少比下一个最接近的标签大 21 个点。由于我们还在每个标签下方添加了输入控件，因此我们增加了 y 位置，以适应标签的高度和输入控件的高度。

很棒！现在您的故事板应该像图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，您将添加两个*文本字段*，它们将让您输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘将自动弹出，他们可以在该字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本框对象到你的视图控制器上。一个用来输入名字，另一个用来输入姓氏。将这两个文本框调整到表格 9-2 中显示的大小和位置。你可以像调整标签一样，使用大小检查器来完成这个操作。

表格 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做*日期选择器*的控件。它可以让你轻松输入生日日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的工具，允许用户选择日期或时间。它可以同时包含日期和时间，就像日历应用中的日期选择器一样（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中，日期选择器用于添加事件时选择日期。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中将要使用的。

在对象库中滚动，直到找到日期选择器，然后将其点击并拖动到视图控制器中的出生日期标签下。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整一些日期选择器的属性。点击日期选择器将其选中。然后，在属性检查器中，将日期选择器的模式设置为**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认会显示当前日期。让我们把这个日期改成你的生日！将日期字段从当前日期改为**自定义**。这样会出现一个新框框，改成你的生日日期。

让我们运行一下应用程序，测试一下目前的效果！我们为输入控件设定的尺寸在 iPhone 7 屏幕上非常合适。所以，选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你在生日视图控制器中点击+按钮时，应该会显示“添加生日”界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上的完美适配。*

![Image](img/Image00218.jpg)

这个效果在 iPhone 7 上看起来很不错，但其他设备呢？选择一个更小的模拟器，例如 iPhone 5s，再次运行应用。你会发现布局有些不对劲。

所有你添加到故事板中的元素都已显示，但文本字段却超出了屏幕的边缘。现在你已经将所有元素添加到屏幕上，下一步是让它们在任何屏幕尺寸下都能正确显示。我们将使用一个名为*自动布局*的工具来实现这一点。

#### 通过自动布局让你的应用在每个设备上都完美显示

iPhone 本身就有三种不同的屏幕尺寸，未来可能会有更多尺寸。你需要设计你的应用，使其在任何设备上看起来都很好。这意味着你需要让应用根据其运行的设备调整屏幕上所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

屏幕故事板面板的底部有一个带图标的带状区域，Utilities 面板前最右侧的图标是两个竖线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击此图标以打开建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局使日期选择器的宽度适应屏幕，不会超出屏幕边缘。自动布局还会确保每个文本字段的前后都有 20 个点的间距，以便它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，添加生日的界面应该看起来完美。

#### 添加保存和取消按钮

为了完成剩下的工作，我们将向你展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。这些按钮暂时不会做任何事情，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够退出“添加生日”界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个 Bar Button Item 并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们为添加按钮所做的一样。选择该按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，这次将其放置在导航栏的 *左侧*。使用属性检查器将其转换为取消按钮，就像你对保存按钮做的那样。你的视图控制器应该如 图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新的按钮！

在 Birthdays 表视图控制器上点击 + 按钮应将你带到添加生日的视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前还不会有任何反应——我们将在 第十章 中实现这两个功能！

### 你学到的内容

在本章中，你开始制作一个 BirthdayTracker 应用，创建了 Birthdays 和 Add a Birthday 屏幕的基本用户界面。你还使用表视图控制器创建了 Birthdays 屏幕，并使用户能够通过 Add 按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本框架，接下来将在 第十章 中编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，"Add Missing Constraints" 选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **Reset to Missing Constraints** 选项来添加缺失的约束。![Image](img/Image00210.jpg)

*图 9-13：向 Add a Birthday 视图控制器添加标签。*

接下来，修改标签的显示文本。在属性检查器中，点击标签文本框并输入 **First Name** 作为显示文本，如 图 9-14 所示。

现在我们想通过尺寸检查器设置标签的大小和位置。在 Xcode 的故事板中，宽度和高度是以 *点* 为单位测量的。请注意，1 点并不等于 1 像素。根据应用运行的设备类型，1 点可能转换为 1 像素、一个 2×2 像素的方块，或一个 3×3 像素的方块。这三种缩放因子被称为 @1x、@2x 和 @3x（我们在设置应用图标时讨论过的大小）。设备的点分辨率也不完全相同，宽度从 320 点到 1,024 点不等，高度从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：制作标签显示* 姓名

只有最老款的 iPhone 和 iPod 才使用 @1x 缩放因子，而且你无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，否则你的手机或 iPod 很可能使用 @2x 缩放因子，这些型号使用的是 @3x 缩放因子。

对象在屏幕上的位置也是基于点数的。对象的 x 位置是从屏幕左侧到对象左侧的距离（单位：点）。y 位置是从屏幕顶部到对象顶部的距离。（见图 9-15）。我们将在视图控制器中设置每个库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕的边缘之外，同时为文本输入框和其他标签及输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成这些步骤后，重复操作，将另外两个标签添加到“添加生日”视图控制器：一个“姓氏”标签和一个“出生日期”标签。我们需要调整其他标签和输入框的位置，确保它们不会重叠。在某些情况下，这可能会变得有些棘手，可能需要一些时间。对于这个应用程序，我们已经为你计算出了在 iPhone 7 屏幕上放置对象的位置。稍后我们将解释如何使你的应用程序兼容其他设备。表 9-1 列出了你应该为每个标签设置的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，以便它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个标签至少大 21 个点。由于我们将输入控件添加到每个标签的下方，我们也增加了 y 位置的值，以便同时容纳标签和输入控件的高度。

很棒！现在你的故事板应该看起来像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中将两个文本字段对象拖动到视图控制器上。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段设置为表 9-2 中看到的尺寸和位置。你可以像设置标签一样使用大小检查器进行操作。

表 9-2：视图控制器中的文本框输入

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个元素是一个叫做 *日期选择器* 的滚轮。这将让你轻松输入生日日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以同时显示日期和时间，如日历应用中使用的日期选择器（参见 图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以只显示时间，如在时钟应用中用于设置闹钟的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的功能。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到出生日期标签下的视图控制器中。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（参见 图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器设置为显示当前日期。让我们将这个日期改为你的生日！将日期字段从当前日期改为**自定义**。这样会出现一个新框，输入你的生日日期。

让我们通过运行应用来测试目前为止的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上显示得很好。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击生日视图控制器上的 + 按钮时，添加生日的屏幕应该会显示出来，如 图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上显示得非常合适。*

![图片](img/Image00218.jpg)

在 iPhone 7 上效果很好，但其他设备呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，然后再次运行应用。你会发现界面看起来有些不对劲。

你添加到故事板中的所有元素都会出现，但文本框超出了屏幕的边缘。现在你已经把所有元素放在了屏幕上，下一步是确保它们在任何屏幕尺寸上都能正确适配。我们将使用一个叫做 *自动布局* 的工具来完成这一点。

#### 通过自动布局让你的应用在每个设备上都看起来完美

单独的 iPhone 就有三种不同的屏幕尺寸，未来可能会有更多尺寸出现。你需要设计你的应用程序，使其在任何设备上都能看起来不错。这意味着你需要让应用程序根据运行它的设备来调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标来调出自动布局菜单。*

在屏幕故事板面板的底部，有一条包含图标的带状工具条，位于实用工具面板之前的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击这个图标，会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这么做时，你会看到许多布局约束已经被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，适合屏幕。例如，自动布局会确保日期选择器的大小适应屏幕宽度，并不会超出边界。自动布局还会确保每个文本字段前后有 20 个点的间隔，以便它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这一次，“添加生日”屏幕应该看起来完美。

#### 添加保存和取消按钮

最后，我们将展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。这些按钮现在还不会执行任何操作，我们只需要设置它们。在第十章中，我们会添加一些代码，使它们能够取消“添加生日”屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们之前对添加按钮所做的那样。选择按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其转换为取消按钮，就像你之前对保存按钮所做的那样。你的视图控制器应该和图 9-21 中所示的样子一样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新的按钮效果！

在 Birthdays 表格视图控制器上点击 + 按钮应该会带你到 Add a Birthday 视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前没有任何作用——我们将在 第十章 中实现这两个功能！

### 你学到的内容

在本章中，你通过创建 Birthdays 和 Add a Birthday 屏幕的基本用户界面开始制作 BirthdayTracker 应用。你还使用表格视图控制器创建了 Birthdays 屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本框架，接下来将花时间在 第十章 中编程实现取消和保存按钮，这样你就可以在应用中添加和保存生日信息了！

* 在某些版本的 Xcode 中，"添加缺失约束" 选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **重置为缺失约束** 选项以添加缺失的约束。

*图 9-13：将标签添加到 Add a Birthday 视图控制器。*

接下来，改变标签的显示文本。在 Attributes Inspector 中，点击标签文本框并输入 **First Name** 作为显示文本，如 图 9-14 所示。

现在，我们想使用 Size Inspector 设置标签的大小和位置。在 Xcode 的 storyboard 中，宽度和高度以 *点* 为单位进行测量。请注意，1 点并不等于 1 像素。根据你的应用运行的设备类型，1 点将转换为 1 像素、2×2 像素的正方形或 3×3 像素的正方形。这三个缩放因子被称为 @1x、@2x 和 @3x（这些与我们设置应用图标时提到的大小相同）。设备的点分辨率也并非都相同，宽度可以从 320 点到 1,024 点不等，高度可以从 568 点到 1,366 点不等。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最老型号的 iPhone 和 iPod 使用 @1x 缩放因子，而且你无法在这些型号上运行你的应用（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的设备是 iPhone 6 Plus、6s Plus 或 7 Plus（这些设备使用 @3x 缩放因子），否则很可能你的手机或 iPod 使用的是 @2x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（参见 图 9-15）我们将设置每个添加到视图控制器的库对象的 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置得既不在屏幕边缘，又能为其文本输入框以及其他标签和输入框留出足够的空间。在“大小检查器”的视图部分，将 x 坐标设置为 20，y 坐标设置为 100，宽度设置为 100。高度保持为 21。

完成此操作后，重复这些步骤，在添加生日的视图控制器中添加两个标签：一个姓氏标签和一个出生日期标签。我们需要将其他标签和输入框位置设置好，以免它们重叠。在某些情况下，这可能会有些棘手，并且需要一些时间。对于这个应用程序，我们已经为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后我们会解释如何让你的应用程序支持其他设备。表 9-1 列出了每个标签应该设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有的标签都有相同的 x 坐标，因此它们垂直对齐，但它们每个都有不同的 y 坐标。每个标签的高度为 21，所以 y 坐标需要比下一个最接近的标签大至少 21 个点。由于我们还将在每个标签下方添加输入控件，因此我们已将 y 坐标设置得更大，以便同时容纳标签和输入控件的高度。

太好了！现在你的故事板应该像 图 9-16 中的那样。

![图片](img/Image00214.jpg)

*图 9-16：已将输入标签添加到视图控制器中。*

接下来，你将添加两个 *文本框*，用于输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以在框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本框对象到视图控制器中。一个将用于输入名字，另一个将用于输入姓氏。将这两个文本框设置为 表 9-2 中所示的大小和位置。你可以使用“大小检查器”来设置，就像你设置标签时做的那样。

表 9-2：视图控制器中的输入文本框

| 文本框 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个叫做 *日期选择器* 的控件。这个控件可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，允许用户选择日期或时间。它可以同时包含日期和时间，就像日历应用中使用的日期选择器（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这也是我们在 BirthdayTracker 中使用的功能。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到“出生日期”标签下的视图控制器上。使用“大小检查器”，将 x 位置设为 0，y 位置设为 280。

你需要调整日期选择器的几个属性。点击日期选择器进行选择。然后，在“属性检查器”中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将此日期改为你的生日！将日期字段从当前日期更改为**自定义**。这样做后，会出现一个新框。将此日期更改为你的生日。

让我们通过运行应用来测试到目前为止的效果！我们为输入控件使用的尺寸适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你在生日视图控制器上点击 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器来运行应用，例如 iPhone 5s，并再次运行应用。你会发现，效果看起来有些不对劲。

所有你添加到故事板中的元素都已显示出来，但文本框超出了屏幕边缘。现在，所有元素都已放置在屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 使用自动布局让你的应用在每个设备上都显示完美

仅 iPhone 就有三种不同的屏幕尺寸，未来可能会有更多的尺寸。你需要设计应用，使其在任何设备上都能良好显示。这意味着你需要让应用根据运行的设备调整应用中所有元素的位置和尺寸。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来调出自动布局菜单。*

在屏幕故事板面板的底部，有一个带图标的带状区域，位于“实用工具”面板之前的最右侧的图标是两个垂直线之间的三角形。将鼠标光标悬停在该图标上时，应该会显示一个标签，标注为“解析自动布局问题”。点击该图标会弹出一个建议菜单。点击**添加缺失的约束**。^(*)这样做后，你会看到一堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的尺寸正确，以适应屏幕。例如，自动布局确保日期选择器的尺寸适合屏幕宽度，并且不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点，以便它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”界面应该完美无缺。

#### 添加保存和取消按钮

最后，我们将展示如何在“添加生日”视图控制器的导航栏上创建“取消”和“保存”按钮。按钮目前不会有任何功能，我们只会先设置它们。在第十章中，我们会添加一些代码，使按钮能够退出“添加生日”界面并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们之前做的“添加”按钮一样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，方法和保存按钮一样。你的视图控制器应该如图 9-21 所示。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新的按钮！

点击“生日”表格视图控制器上的+按钮，应该会将你带到“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击“取消”和“保存”按钮目前没有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，您通过创建 Birthdays 和 Add a Birthday 屏幕的基本用户界面开始制作 BirthdayTracker 应用程序。您还使用表视图控制器创建了 Birthdays 屏幕，并使用户能够通过 Add 按钮和导航控制器在屏幕之间导航。

现在您已经完成了应用程序的基本框架，接下来将在 第十章 中编写代码，以实现取消和保存按钮，这样您就可以在应用程序中添加和保存生日信息！

* 在某些版本的 Xcode 中，Add Missing Constraints 选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **Reset to Missing Constraints** 选项来添加缺失的约束。

接下来，修改标签的显示文本。在 Attributes Inspector 中，点击标签文本框并输入 **First Name** 作为显示文本，如 图 9-14 所示。

现在我们希望使用 Size Inspector 设置标签的大小和位置。在 Xcode storyboard 中，宽度和高度以 *points* 为单位。请注意，1 point 并不等于 1 像素。根据应用程序运行的设备类型，1 point 可以转换为 1 像素、一个 2×2 像素的正方形或一个 3×3 像素的正方形。这三个缩放因子分别被称为 @1x、@2x 和 @3x（这些是我们在设置应用图标时讨论过的相同尺寸）。不同设备的点分辨率也不同，宽度范围从 320 到 1,024 点，高度范围从 568 到 1,366 点。

![Image](img/Image00211.jpg)

*图 9-14：使标签显示* First Name

只有最旧的 iPhone 和 iPod 型号使用 @1x 的缩放因子，您将无法在这些型号上运行您的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非是 iPhone 6 Plus、6s Plus 或 7 Plus，它们使用的是 @3x 缩放因子，否则您的手机或 iPod 很可能使用 @2x 缩放因子。

对象在屏幕上的位置也是基于点的。对象的 x 位置是从屏幕左侧到对象左侧的点数。y 位置是从屏幕顶部到对象顶部的距离。（请参见 图 9-15。）我们将为每个添加到视图控制器中的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，同时为其文本输入框、其他标签和输入框留出足够的空间。在 Size Inspector 的 View 部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成这一步之后，重复这些步骤，向“添加生日”视图控制器中再添加两个标签：一个姓氏标签和一个出生日期标签。我们需要调整其他标签和输入控件的位置，避免它们重叠。在某些情况下，这可能会变得复杂，并且可能需要一些时间。对于这个应用，我们已经计算出了适合放置控件的地方，基于 iPhone 7 屏幕的尺寸。稍后，我们会解释如何让应用在其他设备上也能正常工作。表 9-1 列出了你应该为每个标签设置的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，因此它们会垂直对齐，但每个标签的 y 位置不同。每个标签的高度是 21，所以 y 位置需要至少比下一个最接近的标签大 21 个点。由于我们还将输入控件放在每个标签的下方，因此我们将 y 位置设置得更大，以容纳标签的高度和输入控件的高度。

很棒！现在你的故事板应该看起来像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已被添加到视图控制器中。*

接下来你将添加两个*文本字段*，它们将允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。给这两个文本字段设置在表 9-2 中看到的尺寸和位置。你可以使用“大小检查器”来完成这一步，就像你为标签做的那样。

表 9-2：视图控制器中输入的文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个称为*日期选择器*的控件。它可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用程序中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，类似于日历应用中使用的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以仅显示时间，像时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这也是我们在 BirthdayTracker 中使用的。

滚动浏览对象库，直到找到日期选择器，然后将其点击并拖动到“出生日期”标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整一下日期选择器的一些属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示 **日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的生日吧！将“日期”字段从当前日期改为 **自定义**。这样，一个新框会出现。把这个日期改为你的生日。

让我们通过运行应用来测试它目前的工作情况！我们为输入控件选择的尺寸在 iPhone 7 屏幕上非常合适。所以，选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击“生日”视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来不错，但其他设备呢？选择一个更小的模拟器（如 iPhone 5s），然后再次运行应用。你会发现界面看起来不太对劲。

你添加到故事板中的所有元素都已经出现了，但文本框的内容超出了屏幕的边缘。现在，所有元素都已显示在屏幕上，下一步是让它们在任何屏幕尺寸上都能正确适配。我们将通过一个叫做 *自动布局* 的工具来完成这个任务。

#### 让你的应用在每个设备上看起来都完美，通过自动布局

单单 iPhone 就有三种不同的屏幕尺寸，而且未来可能会有更多的尺寸。你需要设计你的应用，使它在任何设备上都能显示良好。这意味着你需要让应用根据运行的设备调整屏幕上所有元素的位置和大小。自动布局使用一种叫做 *布局约束* 的方法来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择 **视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕的故事板面板底部，有一条带图标的带状工具栏，紧挨着实用工具面板之前的最右边图标是一个三角形，位于两条竖线之间。将鼠标光标悬停在该图标上，它应该会显示一个标签，上面写着“解析自动布局问题”。点击这个图标，会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 这样做后，你会看到很多布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小合适，可以适应屏幕。例如，自动布局确保日期选择器的大小适合屏幕宽度，不会超出边缘。自动布局还会确保每个文本字段的前后有 20 个点的间距，从而使它们在屏幕上居中。

现在在 iPhone 5s 模拟器上再次运行应用程序。这一次，“添加生日”页面应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮现在还没有任何功能，我们只是先进行设置。在第十章中，我们将添加一些代码，使它们能够取消“添加生日”页面并将生日保存到应用中。

要添加保存按钮，请从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右*侧。我们将把这个按钮更改为“保存”按钮，就像我们之前做的“添加”按钮一样。选择该按钮项，然后使用属性检查器将其更改为“保存”按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左*侧。使用属性检查器将其转换为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应如图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行应用程序，查看新按钮的效果！

点击生日表格视图控制器上的+按钮应该会进入“添加生日”视图控制器，在那里你可以输入一个人的名字和生日日期。点击取消和保存按钮目前不会有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用，首先创建了生日页面和添加生日页面的基本用户界面。你还使用表格视图控制器创建了生日页面，并使用户能够通过“添加”按钮和导航控制器在页面之间切换。

现在，你已经完成了应用的基本骨架，在第十章中，你将编程实现取消和保存按钮，以便可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择选项**重置为缺失约束**来添加缺失的约束。

现在我们要使用“大小检查器”设置标签的大小和位置。在 Xcode 的 storyboard 中，宽度和高度以*点*为单位进行测量。请注意，1 点不等于 1 像素。根据你的应用运行的设备类型，1 点可以转换为 1 像素、2×2 像素的方块，或者 3×3 像素的方块。这三种缩放因子被称为 @1x、@2x 和 @3x（与我们在设置应用图标时讨论的大小相同）。设备的分辨率也不完全相同，点的宽度从 320 到 1,024 点不等，高度从 568 到 1,366 点不等。

![图片](img/Image00211.jpg)

*图 9-14：显示标签* First Name

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，你将无法在这些型号上运行你的应用程序（BirthdayTracker 将仅支持 iOS 10 及更高版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，这些设备使用 @3x 缩放因子，否则很可能你的设备使用 @2x 缩放因子。

对象在屏幕上的位置也是基于点数的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的距离。（见 图 9-15）我们将在视图控制器中设置我们添加的每个库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，但仍留出足够的空间给其文本输入字段和其他标签及输入项。在“大小检查器”的“视图”部分，设置 x 位置为 20，y 位置为 100，宽度为 100。高度保持为 21。

完成这一步后，重复这些步骤，将两个标签添加到“添加生日”视图控制器中：一个是姓氏标签，一个是出生日期标签。我们需要定位其他标签和输入项，以确保它们不会重叠。在某些情况下，这可能会变得有些棘手，需要一些时间。对于这个应用程序，我们已经为你计算出适合 iPhone 7 屏幕的对象放置位置。稍后，我们会解释如何让你的应用在其他设备上运行。表 9-1 列出了每个标签的大小和位置设置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有的标签都有相同的 x 位置，以便它们垂直对齐，但每个标签的 y 位置都不同。每个标签的高度为 21，因此 y 位置需要比下一个最接近的标签高出至少 21 个点。由于我们也在每个标签下方添加了输入控件，因此我们将 y 位置设置得更大，以适应标签和输入控件的高度。

太棒了！现在你的故事板应该和图 9-16 中的一样。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本框*，它们允许你输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在框中输入一行文字。

##### 添加文本框

从对象库中拖动两个文本框对象到你的视图控制器中。一个用来输入名字，另一个用来输入姓氏。给这两个文本框设置表 9-2 中看到的尺寸和位置。你可以像设置标签一样使用尺寸检查器进行设置。

表 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个叫做*日期选择器*的轮子。它将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，用于允许用户选择日期或时间。它可以同时包含日期和时间，像日历应用中使用的日期选择器（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，类似于时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这也是我们在 BirthdayTracker 中使用的方式。

滚动对象库，直到你找到一个日期选择器，然后点击并拖动它到视图控制器中的“出生日期”标签下。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们把这个日期改为你的生日吧！将日期字段从“当前日期”更改为**自定义**。完成后，一个新的框会出现。将日期更改为你的生日。

让我们通过运行应用来测试目前为止的工作！我们为输入控件设置的尺寸在 iPhone 7 屏幕上显示良好。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你在生日视图控制器上点击+按钮时，“添加生日”屏幕应该会显示出来，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

在 iPhone 7 上显示得很棒，但其他设备呢？选择一个更小的模拟器来运行应用，比如 iPhone 5s，再次运行应用。你会看到显示效果不太对劲。

你添加到故事板中的所有元素都会显示出来，但文本字段已经超出了屏幕的边缘。现在你已经将所有元素添加到屏幕上，下一步是使它们在任何屏幕尺寸下都能正确显示。我们将通过一个叫做*自动布局*的工具来完成这项工作。

#### 使用自动布局使你的应用在每个设备上都能完美显示

仅 iPhone 本身就有三种不同的屏幕尺寸，而且未来可能会有更多尺寸。你需要设计你的应用，使其在任何设备上都能显示良好。这意味着你的应用需要调整其中所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的方式来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕故事板面板的底部，有一排带图标的功能按钮，位于工具面板前的最右边的图标是一个夹在两条竖线之间的三角形。将鼠标光标悬停在该图标上，它会显示一个标签，写着“解决自动布局问题”。点击此图标将弹出一份建议菜单。点击**添加缺失的约束**。^(*) 完成此操作后，你会看到一大堆布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局会确保日期选择器的大小适应屏幕的宽度，不会超出屏幕边缘。自动布局还会确保每个文本字段的前后有 20 个点的间距，从而使它们在屏幕上居中。

现在在 iPhone 5s 模拟器上再次运行应用。这时，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。这些按钮现在还没有任何功能，我们只是简单地设置它们。在第十章中，我们将添加一些代码，使它们能够取消并退出添加生日屏幕，并将生日保存到应用中。

为了添加保存按钮，从对象库中拖动一个 Bar Button Item，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们做添加按钮时那样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将它放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该像图 9-21 所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新增的按钮！

在生日表格视图控制器上点击+按钮，应该能带你到“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮现在不会有什么反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你通过创建生日和添加生日屏幕的基本用户界面，开始制作一个 BirthdayTracker 应用。你还使用表格视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间切换。

现在你已经完成了应用的基本框架，第十章将帮助你编程实现取消和保存按钮，这样你就可以在应用中添加和保存生日了！

* 在一些版本的 Xcode 中，“添加缺失约束”选项是禁用的。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。![图片](img/Image00211.jpg)

*图 9-14：制作显示标签* First Name

只有最老的 iPhone 和 iPod 型号使用 @1x 缩放因子，你将无法在这些型号上运行你的应用程序（BirthdayTracker 仅支持 iOS 10 及以上版本）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，这些型号使用 @3x 缩放因子，否则你的设备很可能使用 @2x 缩放因子。

对象在屏幕上的位置也基于点来计算。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的距离。（见 图 9-15）我们将为每个添加到视图控制器中的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置为既不在屏幕边缘，又能为其文本输入框和其他标签及输入框留出足够的空间。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成后，重复这些步骤，为“添加生日”视图控制器添加另外两个标签：姓氏标签和出生日期标签。我们需要定位其他标签和输入框，以确保它们不会重叠。在某些情况下，这可能会变得棘手并且需要一些时间。对于这个应用程序，我们已经为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们会解释如何使你的应用在其他设备上工作。表 9-1 列出了你应为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们在垂直方向上对齐，但每个标签的 y 位置不同。每个标签的高度是 21，所以 y 位置需要比下一个最近的标签至少大 21 个点。由于我们在每个标签下方也添加了输入控件，我们将 y 位置设置得更大，以便容纳标签和输入控件的高度。

太好了！现在你的故事板应该和 图 9-16 中的样子一样。

![Image](img/Image00214.jpg)

*图 9-16：已将输入标签添加到视图控制器中。*

接下来，你将添加两个*文本框*，它们允许你输入名字和姓氏。文本框是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本字段对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段调整为表格 9-2 中所示的大小和位置。你可以使用大小检查器来进行调整，就像你对标签所做的那样。

表格 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后需要添加的是一个被称为*日期选择器*的轮盘。这将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，使用日期选择器来选择日期。*

日期选择器也可以只显示时间，就像在时钟应用中用于设置闹钟的日期选择器，或者只显示日期，这正是我们在生日追踪器中使用的。

滚动浏览对象库，直到找到日期选择器，然后点击并将其拖动到出生日期标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器进行选择。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：修改日期选择器的设置。*

日期选择器默认显示当前日期。让我们把这个日期改为你的出生日期吧！将日期字段从当前日期更改为**自定义**。当你这样做时，会出现一个新的框，修改为你的出生日期。

让我们通过运行应用程序来测试一下它目前的工作效果！我们为输入控件使用的大小在 iPhone 7 屏幕上非常适合。所以，选择 iPhone 7 模拟器，点击左上角的播放按钮。这一次，当你点击生日视图控制器上的 + 按钮时，应该会显示“添加生日”界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很好，但其他设备如何呢？选择一个较小的模拟器来运行该应用程序，例如 iPhone 5s，然后重新运行应用程序。你会看到一些内容显示不太对劲。

所有添加到故事板的元素都显示了，但文本字段超出了屏幕边缘。现在你已经将所有元素放置到屏幕上，接下来的步骤是使它们适应任何屏幕尺寸。我们将使用一个名为*自动布局*的工具来完成这项工作。

#### 让你的应用在每个设备上都完美显示，使用自动布局

单独的 iPhone 有三种不同的屏幕尺寸，并且未来可能会有更多尺寸。你需要设计你的应用，使其在任何设备上都看起来不错。这意味着你希望应用能够根据运行的设备调整应用中所有元素的位置和大小。自动布局使用名为*布局约束*的东西来定位屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的概览视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部第四个图标打开自动布局菜单。*

在屏幕底部的故事板面板上有一条带有图标的带状工具栏，紧接着工具面板之前的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它会显示一个标签，上面写着“解决自动布局问题”。点击该图标即可打开建议菜单。点击**添加缺失约束**。^(*) 做到这一点后，你会看到很多布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局会确保日期选择器的宽度适配屏幕，并且不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点的间距，这样它们就能在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，“添加生日”屏幕应该完美显示。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮现在还没有任何功能。我们只是设置它们。在第十章中，我们将添加一些代码，让它们能取消退出“添加生日”界面，并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们做的添加按钮一样。选择该按钮项，然后使用属性检查器将其转换为保存按钮。

最后，我们来添加取消按钮。从对象库中拖动另一个条形按钮项，并将其放置在导航栏的 *左侧*。使用属性检查器将其转换为取消按钮，就像之前为保存按钮做的那样。你的视图控制器应该像 图 9-21 中显示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在重新运行你的应用，查看新按钮的效果！

在生日表格视图控制器中点击 + 按钮应该会把你带到“添加生日”视图控制器，在那里你可以输入人的姓名和出生日期。点击取消和保存按钮目前没有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始创建 BirthdayTracker 应用，设计了生日页面和添加生日页面的基本用户界面。你还创建了生日页面，使用了一个表格视图控制器，并设置了用户可以通过添加按钮和导航控制器在页面之间进行导航。

现在你已经完成了应用的基本框架，接下来将在第十章中编程实现取消和保存按钮，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是苹果的一个 bug。在这种情况下，选择 **重置为缺失约束** 选项以添加缺失的约束。

*图 9-14：使标签显示* First Name

只有最老款的 iPhone 和 iPod 使用 @1x 的缩放因子，而且你无法在这些机型上运行你的应用（BirthdayTracker 仅支持 iOS 10+）。除非你的 iPhone 或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们很可能使用 @2x 缩放因子，后者使用 @3x 缩放因子。

对象在屏幕上的位置也是基于点数的。对象的 x 位置是从屏幕左侧到对象左侧的距离（以点为单位）。y 位置是从屏幕顶部到对象顶部的距离。（见 图 9-15）。我们将设置每个库对象在视图控制器中的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置在离屏幕边缘有一定距离的位置，同时为文本输入框以及其他标签和输入框留出足够的空间。在“大小检查器”的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。将高度保持为 21。

完成后，重复这些步骤，向“添加生日”视图控制器中添加两个标签：姓氏标签和出生日期标签。我们需要定位其他标签和输入框，以确保它们不会重叠。在某些情况下，这可能会变得有些复杂，并且可能需要一些时间。对于这个应用程序，我们已经为你计算出了在 iPhone 7 屏幕上放置对象的位置。稍后我们将解释如何让你的应用程序适配其他设备。表 9-1 列出了你应该为每个标签设置的尺寸和位置。

表 9-1：视图控制器中的输入标签设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个最近的标签大至少 21 个点。由于我们还将在每个标签下方添加输入控件，我们将 y 位置增大，以便同时容纳标签的高度和输入控件的高度。

很棒！现在你的故事板应该看起来像图 9-16 中的那样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已被添加到视图控制器中。*

接下来你将添加两个*文本框*，它们将允许你输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们就可以在框中输入一行文本。

##### 添加文本框

从对象库中将两个文本框对象拖动到你的视图控制器上。一个用于输入名字，另一个用于输入姓氏。按照表 9-2 中看到的尺寸和位置为这两个文本框设置大小和位置。你可以使用“大小检查器”来完成这一操作，就像为标签设置时做的那样。

表 9-2：视图控制器中的文本输入框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做*日期选择器*的滚轮。这个控件将方便你输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用程序中用于允许用户选择日期或时间的标准工具。它可以同时包含日期和时间，类似于在日历应用中使用的日期选择器（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，使用日期选择器选择日期。*

日期选择器还可以仅显示时间，就像时钟应用中用于设置闹钟的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到出生日期标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器进行选择。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的生日！将日期字段从当前日期改为**自定义**。这样做后，会出现一个新的框框。将日期改为你的生日。

让我们运行应用，测试一下目前的功能！我们为输入控件使用的尺寸在 iPhone 7 屏幕上显示得很好。所以选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这一次，当你点击出生日期视图控制器上的+按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美适配 iPhone 7 屏幕。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来不错，但其他设备呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，并再次运行应用。你会看到，布局似乎不太对劲。

你已将所有元素添加到故事板中，但文本框超出了屏幕边缘。现在，你已经将所有元素放到屏幕上，下一步是使它们在任何屏幕尺寸上都能正确显示。我们将使用一个名为*自动布局*的工具来完成这项工作。

#### 通过自动布局让你的应用在每个设备上都完美呈现

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能会有更多尺寸。你需要设计你的应用，使它们在任何设备上都能显示良好。这意味着你希望你的应用能够根据运行应用的设备调整所有内容的位置和大小。自动布局使用一种叫做*布局约束*的机制来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来打开自动布局菜单。*

在屏幕的故事板面板底部，有一个带有图标的带状工具条，在“实用工具”面板之前的最右侧图标是一个夹在两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击该图标，会弹出一个建议菜单。点击**添加缺失的约束**。^(*)这样做后，你会看到一堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的尺寸正确，以适应屏幕。例如，自动布局使得日期选择器的宽度与屏幕相匹配，避免超出屏幕边缘。自动布局还会确保每个文本框前后都有 20 个点的间隔，使它们在屏幕上居中排列。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”界面应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这些操作，我们将向你展示如何为“添加生日”视图控制器的导航栏添加“取消”和“保存”按钮。按钮目前什么也不做。我们只是设置它们。在第十章中，我们将添加代码，使它们可以取消“添加生日”界面并将生日保存到应用程序中。

要添加“保存”按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改成“保存”按钮，就像我们之前为“添加”按钮做的那样。选择按钮项，然后使用属性检查器将其转变为“保存”按钮。

最后，让我们添加“取消”按钮。从对象库中拖动另一个条形按钮项，并将其放置在导航栏的*左侧*。使用属性检查器将其转变为“取消”按钮，就像你为“保存”按钮所做的那样。你的视图控制器应该像图 9-21 所示那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新的按钮效果！

点击“生日”表格视图控制器中的+按钮，应该会跳转到“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击“取消”和“保存”按钮目前还没有任何反应——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用程序，通过创建“生日”和“添加生日”界面的基本用户界面。你还使用表格视图控制器创建了“生日”界面，并使得用户可以通过“添加”按钮和导航控制器在界面之间进行切换。

现在，你已经完成了应用程序的基本框架，接下来将在第十章中编写代码，实现“取消”和“保存”按钮，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个苹果的 bug。在这种情况下，选择“**重置为缺失约束**”选项来添加缺失的约束。

只有最旧型号的 iPhone 和 iPod 使用 @1x 缩放因子，并且你无法在这些型号上运行你的应用（BirthdayTracker 只支持 iOS 10 及以上）。除非你的手机或 iPod 是 iPhone 6 Plus、6s Plus 或 7 Plus，否则它们很可能使用 @2x 缩放因子，后者使用 @3x 缩放因子。

对象在屏幕上的位置也是基于点数的。对象的 x 位置是从屏幕左侧到对象左侧的点数距离。y 位置是从屏幕顶部到对象顶部的点数距离。（参见图 9-15）。我们将设置每个我们添加到视图控制器中的库对象的 x 位置和 y 位置。

![图片](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![图片](img/Image00213.jpg)

我们希望将第一个标签定位到屏幕的边缘位置，确保它不会靠近屏幕边缘，同时也能为其文本输入框和其他标签以及输入控件留出足够的空间。在“大小检查器”的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100，保持高度为 21。

完成这些步骤后，重复这些步骤，将两个标签添加到“添加生日”视图控制器中：姓氏标签和出生日期标签。我们需要将其他标签和输入控件定位好，以避免它们重叠。在某些情况下，这可能会变得有些棘手，并且可能需要一些时间。对于这个应用程序，我们已经为你计算了可以放置对象的位置，适用于 iPhone 7 屏幕。稍后，我们将解释如何让你的应用支持其他设备。表 9-1 列出了每个标签应设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，所以 y 位置需要比下一个最接近的标签大至少 21 点。由于我们在每个标签下方也添加了输入控件，因此我们将 y 位置设置得更大，以适应标签和输入控件的高度。

太好了！现在你的故事板应该看起来像图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16：输入框的标签已经添加到视图控制器中。*

接下来，你将添加两个 *文本框*，用来输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用来在屏幕上显示可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本框对象到视图控制器中。一个用来输入名字，另一个用来输入姓氏。为这两个文本框设置 表 9-2 中看到的尺寸和位置。你可以像为标签所做的那样，使用大小检查器来设置它们。

表 9-2：视图控制器中的文本框输入

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加一个叫做 *日期选择器* 的控件。这个控件可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的工具，允许用户选择日期或时间。它可以同时显示日期和时间，比如在日历应用中使用的日期选择器（见 图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用的日期选择器。*

日期选择器还可以仅显示时间，例如在时钟应用中设置闹钟时使用的日期选择器，或者仅显示日期，这也是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到出生日期标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示 **日期**，而不是日期和时间（见 图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。我们将把这个日期更改为你的出生日期！将日期字段从当前日期更改为 **自定义**。这样会出现一个新框，修改这个日期为你的出生日期。

让我们测试一下目前为止应用的工作情况吧！我们为输入控件设置的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这时，当你在生日视图控制器中点击 + 按钮时，应该会显示“添加生日”屏幕，如 图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来不错，但其他设备呢？选择一个较小的模拟器来运行该应用，比如 iPhone 5s，并重新运行应用。你会看到，界面看起来有些不对劲。

所有你添加到故事板的元素都出现了，但文本框的内容已经超出了屏幕的边缘。现在你已经将所有元素添加到屏幕上，接下来的步骤是让它们在任何屏幕尺寸下都能正确显示。我们将通过一个叫做*自动布局*的工具来实现这一点。

#### 通过自动布局使你的应用在每个设备上都完美显示

仅 iPhone 就有三种不同的屏幕尺寸，并且未来可能会出现更多的尺寸。你需要设计你的应用，以便它在任何设备上看起来都很不错。这意味着，你希望你的应用能够根据设备的不同，调整应用中所有内容的位置和大小。自动布局通过一个叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（参见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕故事板面板的底部，有一个带有图标的功能区，位于工具面板左侧的最右边的图标是一个夹在两条竖线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，内容为“解决自动布局问题”。点击此图标会弹出一个建议菜单。点击**添加缺失约束** ^(*)。这样，你会看到一大堆布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕，并且不会超出边缘。自动布局还会确保每个文本框前后各有 20 个点，以便它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，“添加生日”屏幕应该看起来完美。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮现在还不会执行任何操作。我们只是设置它们。到第十章时，我们将添加一些代码，使它们能够取消“添加生日”屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们做“添加”按钮一样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，我们添加取消按钮。 从对象库中拖动另一个“Bar Button Item”，这次将它放置在导航栏的*左侧*。 使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该像图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新的按钮！

点击生日表视图控制器上的 + 按钮应该会带你到“添加生日”视图控制器，你可以在这里输入一个人的姓名和出生日期。点击取消和保存按钮目前不会执行任何操作——我们将在第十章中实现这两个按钮！

### 你学到的内容

在本章中，你开始制作一个 BirthdayTracker 应用，通过创建“生日”和“添加生日”屏幕的基本用户界面。你还使用表视图控制器创建了“生日”屏幕，并使用户可以通过“添加”按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本框架，接下来的第十章中你将编写代码，实现取消和保存按钮功能，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是苹果的一个 bug。遇到这种情况时，选择 **重置为缺失约束** 以添加缺失的约束。

对象在屏幕上的位置也是基于点数的。对象的 x 位置是从屏幕左侧到对象左侧的距离，单位为点。y 位置是从屏幕顶部到对象顶部的距离。（见图 9-15）。我们将为每个我们添加到视图控制器中的库对象设置 x 位置和 y 位置。

![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置为不在屏幕边缘，但仍然留出足够的空间来容纳文本输入字段以及其他标签和输入项。 在“大小检查器”的“视图”部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成这些后，重复这些步骤，向添加生日的视图控制器中再添加两个标签：姓氏标签和出生日期标签。我们需要将其他标签和输入控件的位置调整好，以免它们重叠。在某些情况下，这可能会变得有些复杂，需要一些时间。对于这个应用，我们已经为你计算好了在 iPhone 7 屏幕上的对象放置位置。稍后，我们会解释如何让你的应用适应其他设备。表 9-1 列出了每个标签应设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有标签的 x 位置相同，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个最接近的标签大至少 21 个点。由于我们在每个标签下方也添加了输入控件，所以我们将 y 位置设得更大，以容纳标签和输入控件的高度。

太好了！现在你的故事板应该看起来像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器。*

接下来，你将添加两个*文本字段*，它们让你输入名字和姓氏。文本字段是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用来输入名字，另一个用来输入姓氏。根据表 9-2 中的尺寸和位置调整这两个文本字段。你可以使用尺寸检查器，像调整标签时一样进行操作。

表 9-2：视图控制器中输入的文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个元素是一个叫做*日期选择器*的控件。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中使用的日期选择器一样（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以只显示时间，就像时钟应用中用于添加闹钟的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的。

在对象库中滚动，直到找到一个日期选择器，然后点击并拖动它到生日标签下的视图控制器中。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整一下日期选择器的一些属性。点击日期选择器将其选中。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改为你的生日！将日期字段从当前日期更改为**自定义**。这样会出现一个新框，修改为你的生日日期。

让我们通过运行应用来测试它目前的工作情况！我们为输入控件使用的尺寸非常适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你点击生日视图控制器上的 + 按钮时，应该会显示添加生日的界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美契合。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很好，但其他设备呢？选择一个更小的模拟器来运行应用，比如 iPhone 5s，再次运行应用。你会看到界面看起来不太对劲。

所有你添加到故事板中的元素都显示出来了，但文本字段超出了屏幕边缘。现在，所有元素都已放置在屏幕上，下一步是确保它们能适应任何屏幕尺寸。我们将通过一个叫做*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上都看起来完美，使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能会有更多尺寸。你需要设计你的应用，使其在任何设备上都看起来好。也就是说，你需要让应用自动调整屏幕上所有元素的位置和大小，以适应正在运行应用的设备。自动布局使用一种叫做*布局约束*的方式来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的概览视图中选择**视图控制器**。接着，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标调出自动布局菜单。*

屏幕底部的故事板面板有一个包含图标的带状区域，在实用工具面板之前最右边的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，标明“解决自动布局问题”。点击该图标以弹出建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到许多布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局使得日期选择器的大小适合屏幕宽度，并且不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点，这样它们就能很好地居中显示在屏幕上。

现在再次在 iPhone 5s 模拟器上运行应用。这次，“添加生日”屏幕应该显示完美。

#### 添加保存和取消按钮

为了完成这部分内容，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。这些按钮现在还不会做任何事情，我们只是先设置它们。在第十章中，我们会添加一些代码，使它们能够取消“添加生日”屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个 Bar Button Item，并将它放置在导航栏的*右侧*。我们将把这个按钮更改为保存按钮，就像我们为添加按钮所做的那样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，这次将它放置在导航栏的*左侧*。使用属性检查器将它设置为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该像图 9-21 中显示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新添加的按钮！

点击生日表格视图控制器上的+按钮，应该会带你进入“添加生日”视图控制器，在这里你可以输入一个人的姓名和出生日期。点击取消和保存按钮暂时不会做任何操作——我们将在第十章中实现它们！

### 你学到了什么

在本章中，你开始通过创建生日和添加生日屏幕的基本用户界面来制作一个 BirthdayTracker 应用。你还使用表格视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行导航。

现在你的应用已经有了基本的框架，你将在第十章中编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，"添加缺失约束" 选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **重置为缺失约束** 选项来添加缺失的约束。![Image](img/Image00212.jpg)

*图 9-15：显示对象在屏幕上的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，同时还要为其文本输入框和其他标签及输入框留出足够的空间。在尺寸检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。将高度保持为 21。

完成后，重复这些步骤，将两个标签添加到“添加生日”视图控制器中：一个姓氏标签和一个出生日期标签。我们需要设置其他标签和输入控件的位置，以避免它们重叠。在某些情况下，这可能会变得复杂，并且可能需要一些时间。对于这个应用程序，我们已经为你计算了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何让你的应用程序适配其他设备。表格 9-1 列出了每个标签应设置的大小和位置。

表格 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，这样它们就会垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个标签至少大 21 点。由于我们将在每个标签下方添加输入控件，因此我们将 y 位置设置得更大，以便容纳标签的高度和输入控件的高度。

很棒！现在你的故事板应该像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个 *文本字段*，它们允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在该字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。给这两个文本字段设置表格 9-2 中显示的大小和位置。你可以使用尺寸检查器来完成这一步，和设置标签时的操作相同。

表格 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个元素是一个称为*日期选择器*的滚轮。它将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以包含日期和时间，像日历应用中的日期选择器一样（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，就像在时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这就是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到日期选择器，然后点击并将其拖动到出生日期标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击选择日期选择器。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将此日期更改为你的出生日期！将日期字段从当前日期更改为**自定义**。这样，新的框框会出现。将日期更改为你的出生日期。

让我们测试一下到目前为止应用的运行情况！我们所使用的输入控件大小在 iPhone 7 屏幕上看起来非常合适。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击出生日期视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美契合。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，然后再次运行应用。你会看到界面显示得不太对劲。

所有添加到故事板中的元素都已经出现，但文本框已经超出了屏幕边缘。现在，所有元素都已经添加到屏幕上，下一步是让它们在任何屏幕大小上都能正确显示。我们将使用一个名为*自动布局*的工具来完成这一任务。

#### 通过自动布局让您的应用在每个设备上看起来完美

iPhone 本身就有三种不同的屏幕尺寸，而且未来可能会有更多尺寸。你需要设计你的应用，使其在任何设备上看起来都很合适。这意味着你要让你的应用根据运行它的设备调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在情节提要中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标以弹出自动布局菜单。*

在屏幕情节提要面板的底部是一个带有图标的带状工具栏，位于实用工具面板前的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上时，它应该显示一个标签，写着“解决自动布局问题”。点击此图标以弹出建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到一大堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局使得日期选择器的宽度适应屏幕宽度，不会超出屏幕边缘。自动布局还会确保每个文本字段前后都有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这个时候，"添加生日"屏幕应该显示得完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。这些按钮目前不会做任何事情，我们只是进行设置。到第十章时，我们会添加一些代码，使它们能够取消“添加生日”屏幕并将生日保存到应用中。

要添加“保存”按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮改为“保存”按钮，就像我们之前做的“添加”按钮一样。选择按钮项，然后使用属性检查器将其更改为“保存”按钮。

最后，让我们添加“取消”按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左侧*。使用属性检查器将其更改为“取消”按钮，就像你做的“保存”按钮一样。你的视图控制器应该看起来像图 9-21 所示。

![图片](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新按钮的效果！

点击生日表格视图控制器上的+按钮，应该会将你带到添加生日视图控制器，你可以在这里输入一个人的姓名和生日。点击“取消”和“保存”按钮目前什么也不做——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始通过为“生日”和“添加生日”界面创建基本的用户界面来制作一个生日追踪器应用程序。你还使用表格视图控制器创建了生日界面，并使用户可以通过添加按钮和导航控制器在不同的界面之间导航。

现在你已经完成了应用程序的基本框架，第十章将教你如何编程实现“取消”和“保存”按钮，这样你就可以在应用程序中添加和保存生日信息！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

*图 9-15：显示屏幕上对象的 x 位置、y 位置、宽度和高度*

![Image](img/Image00213.jpg)

我们希望将第一个标签的位置设置为不在屏幕边缘，同时仍然为其文本输入框和其他标签及输入控件留出足够的空间。在“大小检查器”的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。高度保持为 21。

完成此操作后，重复这些步骤将两个标签添加到“添加生日”视图控制器：一个是“姓氏”标签，一个是“生日”标签。我们需要定位其他标签和输入控件，以确保它们不会重叠。在某些情况下，这可能会变得复杂并需要一些时间。对于这个应用程序，我们已经为你计算出了适合放置对象的位置，基于 iPhone 7 的屏幕。稍后我们会解释如何让应用程序支持其他设备。表 9-1 列出了你应该为每个标签设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，因此它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个最接近的标签大至少 21 个点。由于我们还将在每个标签下方添加输入控件，因此我们将 y 位置设得更大，以容纳标签的高度和输入控件的高度。

太棒了！现在你的故事板应该像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已被添加到视图控制器中。*

接下来，你将添加两个*文本字段*，让你能够输入名字和姓氏。文本字段是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘将自动弹出，他们可以在该字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个将用于输入名字，另一个用于输入姓氏。根据表 9-2 中的尺寸和位置设置这两个文本字段。你可以像设置标签一样，使用尺寸检查器来完成这一步。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | x 位置 | y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一项是一个叫做*日期选择器*的控件。它将让你轻松地输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的工具，用于让用户选择日期或时间。它可以同时包含日期和时间，就像日历应用中的日期选择器一样（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器进行日期选择。*

日期选择器还可以仅显示时间，就像时钟应用中用于添加闹钟的日期选择器一样，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到出生日期标签下的视图控制器中。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们改成显示你的出生日期吧！将日期字段从“当前日期”更改为**自定义**。此时，一个新的框将出现。将日期更改为你的出生日期。

让我们通过运行应用来测试它的工作情况！我们为输入控件所使用的尺寸在 iPhone 7 屏幕上适配良好。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你在生日视图控制器中点击+按钮时，应该会显示“添加生日”界面，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，并再次运行应用程序。你会看到某些地方看起来不太对劲。

所有你添加到故事板中的元素都会出现，但文本框超出了屏幕的边缘。现在你已经将所有元素放在屏幕上，接下来的步骤是让它们适应任何屏幕大小。我们将使用一个名为*自动布局*的工具来完成这一任务。

#### 让你的应用在每个设备上看起来完美，通过自动布局

iPhone 本身就有三种不同的屏幕尺寸，未来可能会有更多的尺寸。你需要设计应用程序，使其在任何设备上都能看起来很棒。这意味着你希望应用程序能够根据运行应用的设备调整所有元素的位置和大小。自动布局使用名为*布局约束*的东西来在屏幕上放置元素。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来弹出自动布局菜单。*

在屏幕故事板面板的底部，有一个包含图标的功能区，位于“工具”面板之前的最右侧图标是两个垂直线之间的一个三角形。将鼠标光标悬停在该图标上时，它应该会显示一个标签，显示为“解决自动布局问题”。点击该图标会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小都适合屏幕。例如，自动布局会调整日期选择器的大小，使其适应屏幕的宽度，并且不会超出边缘。自动布局还会确保每个文本框前后都有 20 个点的间距，以便它们能够在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。这些按钮暂时不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消“添加生日”屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们做的添加按钮一样。选择按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其转换为取消按钮，就像你做保存按钮一样。你的视图控制器应该像图 9-21 中显示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新添加的按钮！

点击生日表视图控制器上的 + 按钮应该会带你到添加生日视图控制器，在那里你可以输入一个人的名字和生日。点击取消和保存按钮目前还没有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在这一章中，你开始制作生日追踪应用，创建了生日和添加生日屏幕的基本用户界面。你还使用表视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本框架，在第十章中，你将编程实现取消和保存按钮，这样你就可以在应用中添加和保存生日信息！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。![图片](img/Image00213.jpg)

我们希望将第一个标签的位置设置在屏幕边缘之外，同时仍然为其文本输入框和其他标签及输入框留出足够的空间。在“尺寸检查器”的视图部分，将 X 位置设置为 20，Y 位置设置为 100，宽度设置为 100。将高度保持为 21。

完成这些操作后，重复这些步骤，在“添加生日”视图控制器中再添加两个标签：一个是姓氏标签，一个是生日标签。我们需要调整其他标签和输入框的位置，以避免它们重叠。在某些情况下，这可能会变得复杂并且需要一些时间。对于这个应用，我们已经为你计算好了在 iPhone 7 屏幕上放置对象的位置。稍后，我们将解释如何使你的应用适配其他设备。表 9-1 列出了每个标签的尺寸和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 生日 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，确保它们垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要至少比下一个标签大 21 点。由于我们也在每个标签下方添加输入控件，因此我们将 y 位置调得更大，以便同时容纳标签和输入控件的高度。

太好了！现在你的故事板应该看起来像 图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：已将输入标签添加到视图控制器中。*

接下来，你将添加两个*文本字段*，用来输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段的大小和位置设置为 表 9-2 中所示的样式。你可以像设置标签那样，使用大小检查器来完成此操作。

表 9-2：视图控制器中的文本字段输入

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个名为*日期选择器*的轮盘。这将帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时显示日期和时间，就像在日历应用中使用的日期选择器（见 图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器进行日期选择。*

日期选择器也可以只显示时间，就像在时钟应用中设置闹钟时使用的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中使用的形式。

滚动浏览对象库，直到找到日期选择器，然后将其点击并拖动到 Birthdate 标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击选择日期选择器。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见 图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们改为显示你的出生日期！将日期字段从“当前日期”改为**自定义**。此时，会出现一个新框。将日期更改为你的出生日期。

让我们通过运行应用程序来测试目前为止的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上显示得很好。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击生日视图控制器上的 + 按钮时，应该会显示添加生日的屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器（例如 iPhone 5s）来运行应用程序，再次运行应用。你会发现布局看起来不太对劲。

你添加到故事板的所有元素都已出现，但文本框超出了屏幕边缘。现在，所有元素都在屏幕上，下一步是让它们能够在任何屏幕尺寸上正确显示。我们将使用一个名为*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上看起来完美——使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会有更多尺寸出现。你需要设计应用程序，以便它们在任何设备上看起来都不错。这意味着你需要让应用自动调整所有元素的位置和大小，以适应应用运行的设备。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的概览视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来调出自动布局菜单。*

在屏幕故事板面板的底部有一个带图标的带状栏，实用工具面板前的最右侧图标是两个垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击该图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*) 这样做时，你会看到很多布局约束被添加到添加生日的场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局使得日期选择器的宽度适应屏幕，避免超出边界。自动布局还确保每个文本字段前后有 20 个点的间距，从而使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”界面应该显示完美。

#### 添加保存和取消按钮

为了完成这部分内容，我们将展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。目前这些按钮还没有功能，我们只是进行设置。在第十章中，我们将添加代码，使它们能够取消添加生日界面并保存生日信息。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们为添加按钮所做的那样。选择该按钮项，然后使用属性检查器将其转变为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将它放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该和图 9-21 中显示的样子一样。

![Image](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新按钮的效果！

点击生日表视图控制器上的 + 按钮应该会跳转到“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前没有任何效果——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个生日跟踪应用，通过创建生日和添加生日界面的基本用户界面。你还使用表视图控制器创建了生日界面，并使用户能够通过添加按钮和导航控制器在屏幕之间导航。

现在你已经有了应用程序的基本框架，在第十章中你将编写代码实现取消和保存按钮，以便在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

我们希望将第一个标签的位置设置在离屏幕边缘不远的地方，同时留出足够的空间用于文本输入字段、其他标签和输入控件。在大小检查器的视图部分，将 x 位置设置为 20，y 位置设置为 100，宽度设置为 100。将高度保持为 21。

完成此操作后，重复这些步骤向“添加生日”视图控制器中添加两个标签：姓氏标签和出生日期标签。我们需要调整其他标签和输入控件的位置，确保它们不重叠。在某些情况下，这可能会变得有些复杂，并且可能需要一些时间。对于这个应用程序，我们已经为你计算了可以放置对象的位置，适用于 iPhone 7 屏幕。稍后，我们将解释如何让你的应用程序适配其他设备。表 9-1 列出了每个标签应该设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到，所有的标签都有相同的 x 位置，因此它们在垂直方向上对齐，但每个标签的 y 位置不同。每个标签的高度为 21，所以 y 位置需要至少比下一个最接近的标签大 21 个点。由于我们还将在每个标签下方添加输入控件，因此我们已将 y 位置设置得更大，以便容纳标签的高度和输入控件的高度。

很棒！现在你的故事板应该看起来像 图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入的标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们将让你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在该字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段的大小和位置设置为 表 9-2 中的样子。你可以像设置标签一样使用大小检查器来完成这个操作。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做 *日期选择器* 的滚轮。它将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以包含日期和时间，就像在日历应用中使用的日期选择器一样（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以仅显示时间，像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这就是我们在生日追踪器中使用的方式。

在对象库中滚动，直到找到一个日期选择器，然后将其点击并拖动到生日标签下的视图控制器中。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器设置为显示当前日期。让我们将这个日期改成你的生日！将日期字段从当前日期改为**自定义**。这样，一个新框将会出现。将此日期更改为你的生日。

让我们通过运行应用来测试一下目前的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上适合得很好。所以，选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击生日视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美契合。*

![Image](img/Image00218.jpg)

在 iPhone 7 上显示很好，但其他设备怎么样呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，再次运行应用。你会发现，某些地方看起来不太对劲。

你添加到故事板的所有元素都已显示出来，但文本框超出了屏幕边缘。现在，你的所有元素都已显示在屏幕上，接下来的步骤是让它们在任何屏幕尺寸上正确适配。我们将通过一种叫做*自动布局*的工具来实现这一点。

#### 使用自动布局让你的应用在每个设备上都看起来完美

iPhone 本身有三种不同的屏幕尺寸，而且未来可能会推出更多尺寸。你需要设计你的应用，使其在任何设备上都能显示得很好。这意味着，你需要让你的应用自动调整所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的方式来将元素放置到屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标来打开自动布局菜单。*

屏幕故事板面板底部有一个带图标的功能区，位于“工具”面板之前的最右侧图标是一个位于两条竖线之间的三角形。将鼠标悬停在该图标上，它应该会显示一个标签，显示为“解决自动布局问题”。点击此图标以弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到一堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局使得日期选择器的大小适应屏幕宽度，不会超出边缘。自动布局还会确保每个文本字段前后都有 20 个点，以便它们能在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成，我们将向你展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。这些按钮暂时还没有任何功能，我们只是在设置它们。在第十章中，我们将添加一些代码，使它们能够取消“添加生日”界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将它放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们设置添加按钮一样。选择按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，然后这次将它放置在导航栏的*左侧*。使用属性检查器将其转变为取消按钮，和你设置保存按钮一样。你的视图控制器应如下所示：图 9-21。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在重新运行你的应用程序，查看新的按钮！

在“生日”表视图控制器中点击+按钮，应该会带你进入“添加生日”视图控制器，你可以在其中输入一个人的名字和出生日期。点击取消和保存按钮暂时不会做任何事情——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个生日追踪器应用，创建了“生日”和“添加生日”界面的基本布局。你还使用表格视图控制器创建了“生日”界面，并使用户能够通过添加按钮和导航控制器在各个界面之间切换。

现在你已经完成了应用的基本框架，你将花费 第十章 的时间编写取消和保存按钮的代码，以便你可以在应用中添加和保存生日信息！

* 在某些版本的 Xcode 中，添加缺失约束的选项被禁用。这是一个苹果的 bug。在这种情况下，选择 **重置为缺失约束** 选项来添加缺失的约束。

完成此操作后，重复这些步骤，向“添加生日”视图控制器中添加两个标签：一个是姓氏标签，一个是出生日期标签。我们需要调整其他标签和输入控件的位置，避免它们重叠。在某些情况下，这可能会变得比较棘手，并且需要一些时间。对于这个应用，我们已经为你计算出了在 iPhone 7 屏幕上的放置位置。稍后我们将解释如何让你的应用适应其他设备。 表 9-1 列出了每个标签应该设置的大小和位置。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，以便它们在垂直方向上对齐，但它们每个都有不同的 y 位置。每个标签的高度为 21，所以 y 位置需要比下一个标签的 y 位置高至少 21 个点。由于我们还将输入控件添加在每个标签下方，所以我们将 y 位置设得更大，以适应标签和输入控件的高度。

很好！现在你的故事板应该看起来像 图 9-16 中的那样。

![图片](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来你将添加两个 *文本框*，它们将允许你输入名字和姓氏。文本框是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本框时，键盘会自动弹出，他们可以在文本框中输入一行文本。

##### 添加文本框

从对象库中拖动两个文本框对象到你的视图控制器上。一个用来输入名字，另一个用来输入姓氏。根据 表 9-2 中看到的尺寸和位置设置这两个文本框。你可以像设置标签一样，使用大小检查器来完成这一步。

表 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后你需要添加的是一个叫做*日期选择器*的轮盘。它将让你轻松地输入生日日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用来让用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中使用的日期选择器（参见 图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器来选择日期。*

日期选择器也可以只显示时间，就像在时钟应用中为添加闹钟使用的日期选择器，或者只显示日期，这也是我们在生日追踪器中使用的功能。

滚动查看对象库，直到你找到日期选择器，然后点击并将它拖到生日标签下的视图控制器上。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见 图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。我们来将这个日期改为你的生日吧！将日期字段从当前日期改为**自定义**。这样，一个新框会出现。将日期改为你的生日。

让我们通过运行应用程序来测试目前为止的效果！我们为输入控件所使用的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击生日视图控制器上的 + 按钮时，应该会显示添加生日的屏幕，如 图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美契合。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但在其他设备上怎么样呢？选择一个较小的模拟器运行应用程序，比如 iPhone 5s，然后再次运行应用程序。你会发现，界面看起来有些不对劲。

你添加到故事板中的所有元素都会显示出来，但文本字段超出了屏幕边缘。现在你已经将所有元素放置在屏幕上，下一步是让它们适应任何屏幕尺寸。我们将使用一个名为*自动布局*的工具来完成这一步。

#### 通过自动布局让你的应用在每个设备上看起来都完美

仅 iPhone 就有三种不同的屏幕尺寸，并且未来可能还会推出更多尺寸。您需要设计应用程序，使其在任何设备上看起来都很合适。这意味着，您需要使您的应用程序根据其运行的设备调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来安排屏幕上的元素。您需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接着，查看编辑面板右下角的四个图标（请参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来打开自动布局菜单。*

在屏幕故事板面板的底部，有一条带图标的功能带，紧挨着“实用工具”面板的最右侧图标是一个三角形，两边有垂直线。将鼠标悬停在该图标上，它应该会显示一个标签，显示“解决自动布局问题”。点击此图标以弹出一个建议菜单。点击**添加缺失的约束**。^(*)这样做时，您会看到许多布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，适合屏幕。例如，自动布局确保日期选择器的大小适合屏幕宽度，并且不会超出边界。自动布局还会确保每个文本框前后都有 20 个点的间距，使它们在屏幕上居中对齐。

现在，再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”界面应该完美无缺。

#### 添加保存和取消按钮

最后，我们将向您展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。这些按钮暂时不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消“添加生日”界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“条形按钮项”，并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，像添加按钮那样操作。选择按钮项，然后使用属性检查器将其转换为保存按钮。

最后，我们来添加取消按钮。从对象库中拖动另一个“条形按钮项”，这次将其放置在导航栏的*左侧*。使用属性检查器将其转换为取消按钮，就像您为保存按钮所做的那样。您的视图控制器应如图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行您的应用程序，查看新按钮的效果！

点击“生日”表格视图控制器上的+按钮应该会将您带到“添加生日”视图控制器，在那里您可以输入一个人的姓名和出生日期。点击“取消”和“保存”按钮目前没有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，您开始通过创建“生日”和“添加生日”屏幕的基本用户界面来制作一个 BirthdayTracker 应用程序。您还使用表格视图控制器创建了“生日”屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行导航。

现在，您已经完成了应用程序的基本框架，接下来将在第十章中编程实现“取消”和“保存”按钮，以便您可以在应用程序中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项以添加缺失的约束。

表 9-1：视图控制器中输入标签的设置

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

您可以看到，所有的标签都有相同的 x 位置，因此它们垂直对齐，但它们的 y 位置各不相同。每个标签的高度为 21，因此 y 位置需要比下一个最接近的标签大至少 21 个点。由于我们还将在每个标签下方添加输入控件，因此我们将 y 位置设置得更大，以容纳标签和输入控件的高度。

太好了！现在您的故事板应该像图 9-16 中的样子。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器。*

接下来，您将添加两个*文本字段*，它们将允许您输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们就可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段的大小和位置设置为表 9-2 中所示的样式。您可以使用大小检查器来完成这一操作，正如您之前为标签所做的那样。

表 9-2：视图控制器中输入的文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

您最后需要添加的是一个叫做*日期选择器*的控件。它将帮助您轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以包含日期和时间，就像在日历应用中使用的日期选择器一样（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器来选择日期。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这也是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动到“出生日期”标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改成你的出生日期！将日期字段从“当前日期”更改为**自定义**。这样会出现一个新的框，改变这个日期为你的出生日期。

让我们通过运行应用来测试到目前为止的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上看起来很合适。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击“出生日期”视图控制器上的+按钮时，应该会显示添加生日的屏幕，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

在 iPhone 7 上看起来很不错，但其他设备呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，然后再次运行应用。你会发现一些元素看起来不太对。

所有你添加到故事板中的元素都已出现，但文本框超出了屏幕的边缘。现在你已经将所有元素放在屏幕上，下一步是让它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来完成这一步。

#### 使用自动布局让你的应用在每个设备上都完美展示

iPhone 本身有三种不同的屏幕尺寸，并且未来可能会有更多尺寸。你需要设计你的应用程序，以便它能在任何设备上看起来都很不错。这意味着你需要让你的应用自动调整所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的概览视图中选择**视图控制器**。接下来，查看编辑面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20: 要添加自动布局约束，点击编辑面板底部的第四个图标，打开自动布局菜单。*

在屏幕故事板面板的底部，有一条带有图标的功能区，位于工具面板之前的最右边的图标是两个竖直线之间的三角形。将鼠标光标悬停在该图标上时，会显示一个标签，写着“解决自动布局问题”。点击这个图标会弹出一个建议菜单。点击**添加缺失约束**。^(*) 当你这样做时，你会看到一堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，能够适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕的宽度，并且不会超出屏幕边缘。自动布局还会确保每个文本框前后有 20 个点，使其在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成最后的步骤，我们将向你展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。按钮现在不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够退出“添加生日”界面并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右*侧。我们将把这个按钮转换为保存按钮，就像我们为添加按钮所做的那样。选择按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左*侧。使用属性检查器将其转换为取消按钮，像你为保存按钮所做的一样。你的视图控制器应该看起来像图 9-21 中所示。

![Image](img/Image00220.jpg)

*图 9-21: 输入视图控制器，带有取消和保存按钮*

现在再次运行你的应用程序，看看新按钮的效果！

点击生日表格视图控制器上的+按钮应该会带你进入“添加生日”视图控制器，在这里你可以输入一个人的名字和出生日期。点击取消和保存按钮现在不会执行任何操作——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你开始创建一个 BirthdayTracker 应用，通过构建“生日”和“添加生日”屏幕的基本用户界面。你还使用表格视图控制器创建了“生日”屏幕，并使用户可以通过“添加”按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用程序的基本框架，接下来将在第十章编写“取消”和“保存”按钮的代码，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个苹果的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

| 显示文本 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 100 | 100 | 21 |
| 姓氏 | 20 | 170 | 100 | 21 |
| 出生日期 | 20 | 250 | 100 | 21 |

你可以看到所有标签的 x 位置相同，这样它们就会垂直对齐，但每个标签的 y 位置不同。每个标签的高度为 21，因此 y 位置需要至少比下一个标签的 y 位置大 21 个点。由于我们在每个标签下面添加了输入控件，因此我们将 y 位置设置得更大，以便容纳标签的高度和输入控件的高度。

太棒了！现在你的故事板应该像图 9-16 中的那样。

![Image](img/Image00214.jpg)

*图 9-16：已将输入标签添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们可以让你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器上。一个用于输入名字，另一个用于输入姓氏。根据表 9-2 中看到的大小和位置调整这两个文本字段。你可以使用尺寸检查器来完成这项操作，就像你为标签所做的那样。

表 9-2：视图控制器中的文本字段输入

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 姓名 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个组件是一个叫做*日期选择器*的控件。它可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中常用的工具，允许用户选择日期或时间。它可以同时包含日期和时间，比如在日历应用中使用的日期选择器（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用的日期选择器，用于选择日期。*

日期选择器还可以仅显示时间，就像在时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中将使用的功能。

滚动浏览对象库，直到找到日期选择器，然后将其点击并拖动到“生日”标签下的视图控制器中。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器进行选择。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见 图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。我们来将日期改为你的生日吧！将日期字段从当前日期改为**自定义**。这样会出现一个新框，将日期改为你的生日。

让我们通过运行应用程序来测试到目前为止的效果！我们为输入控件设置的尺寸适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击生日视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如 图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

在 iPhone 7 上效果很好，但其他设备呢？选择一个更小的模拟器运行应用，比如 iPhone 5s，再次运行应用。你会发现效果不太对劲。

你添加到故事板上的所有元素都已经出现，但文本字段超出了屏幕的边缘。现在，所有的元素都已经放置在屏幕上，下一步是让它们在任何屏幕尺寸上都能正确适配。我们将通过一个叫做*自动布局*的工具来实现这一点。

#### 通过自动布局让你的应用在每个设备上都看起来完美

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能会有更多尺寸。你需要设计应用，使其在任何设备上看起来都很合适。这意味着你需要让应用根据运行的设备调整应用中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来定位屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑面板右下角的四个图标（见 图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕的故事板面板底部，有一个带有图标的带状工具条，位于工具条右侧、工具面板之前的图标是一个夹在两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，上面写着“解决自动布局问题”。点击该图标会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到一大堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局会确保日期选择器的大小适应屏幕的宽度，不会超出屏幕边缘。自动布局还会确保每个文本字段前后有 20 个点的间距，使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上重新运行应用程序。这一次，"添加生日"屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成接下来的步骤，我们将向你展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。此时按钮还没有任何功能。我们只是先设置好它们。在第十章中，我们将添加一些代码，使得这些按钮可以取消当前的“添加生日”屏幕，并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们之前做的添加按钮一样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你之前设置保存按钮一样。你的视图控制器应该看起来像图 9-21 中所示的样子。

![图片](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新添加的按钮！

在生日表格视图控制器上点击 + 按钮应该会将你带到“添加生日”视图控制器，在那里你可以输入一个人的姓名和生日。点击取消和保存按钮目前没有任何效果——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你通过创建“生日”和“添加生日”屏幕的基本用户界面，开始制作一个 BirthdayTracker 应用。你还使用表格视图控制器创建了“生日”屏幕，并使得用户可以通过添加按钮和导航控制器在屏幕之间切换。

现在，你已经完成了应用的基本骨架，在第十章中，你将编写代码实现取消和保存按钮的功能，以便在应用中添加和保存生日！

* 在某些版本的 Xcode 中，"添加缺失约束"选项是禁用的。这是一个苹果的 BUG。在这种情况下，选择**重置为缺失约束**选项，以添加缺失的约束。

你可以看到所有标签的 x 位置相同，这样它们就可以垂直对齐，但它们的 y 位置不同。每个标签的高度为 21，因此 y 位置需要比下一个最近的标签高至少 21 个点。由于我们还在每个标签下方添加输入控件，因此我们将 y 位置设置得更大，以适应标签和输入控件的高度。

很棒！现在你的故事板应该像图 9-16 中的样子。

![图片](img/Image00214.jpg)

*图 9-16: 输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在该字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段设置为表 9-2 中看到的大小和位置。你可以使用大小检查器，就像之前设置标签时那样。

表 9-2: 视图控制器中的文本字段输入

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个元素是一个被称为*日期选择器*的滚轮。它将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像日历应用中使用的日期选择器（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17: 在日历应用中添加事件时使用日期选择器来选择日期。*

日期选择器还可以仅显示时间，就像在时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的。

滚动浏览对象库，直到找到日期选择器，然后点击并将其拖动到视图控制器中的出生日期标签下方。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18: 修改日期选择器的设置。*

日期选择器默认显示当前日期。我们来将日期改成你的出生日期！将日期字段从“当前日期”改为**自定义**。这样会出现一个新框框，将日期更改为你的出生日期。

让我们通过运行应用来测试目前为止的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你在生日视图控制器上点击 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很好，但其他设备呢？选择一个更小的模拟器，比如 iPhone 5s，然后重新运行应用。你会发现一些元素看起来不太对劲。

你添加到故事板中的所有元素都会显示出来，但文本字段超出了屏幕的边缘。现在你已经将所有元素添加到屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确显示。我们将通过一个叫做*自动布局*的工具来实现这一点。

#### 通过自动布局让你的应用在每个设备上看起来都完美

iPhone 单独就有三种不同的屏幕尺寸，并且未来可能会出现更多尺寸。你需要设计你的应用，让它在任何设备上都能显示良好。这意味着你需要让你的应用根据运行设备调整所有元素的位置和大小。自动布局使用称为*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标调出自动布局菜单。*

在屏幕的故事板面板底部，有一个带图标的带状工具栏，最右侧的图标是在两个垂直线条之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击该图标以调出建议菜单。点击**添加缺失的约束**。^(*) 这样，你会看到很多布局约束被添加到了“添加生日”场景。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适合屏幕，不会超出边界。自动布局还确保每个文本字段前后有 20 点的间距，以便它们能够在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成任务，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮现在还不会有任何作用，我们只是先设置它们。在第十章中，我们将添加代码，使它们能够退出“添加生日”屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们之前做的添加按钮一样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，我们来添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮做的那样。你的视图控制器应该和图 9-21 中的样子一样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新按钮的效果！

点击生日表视图控制器上的 + 按钮，应该会跳转到“添加生日”视图控制器，你可以在这里输入一个人的姓名和出生日期。点击取消和保存按钮暂时不会执行任何操作——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你开始制作一个生日追踪器应用，创建了“生日”和“添加生日”屏幕的基本用户界面。你还使用表格视图控制器创建了“生日”屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间进行导航。

现在你的应用程序的基本框架已经搭建完成，接下来你将在第十章中编写代码，功能包括实现取消和保存按钮，这样你就可以在应用中添加和保存生日信息了！

* 在某些版本的 Xcode 中，添加缺失约束选项是禁用的。这是苹果的一个错误。在这种情况下，选择“**重置为缺失约束**”选项来添加缺失的约束。

太好了！现在你的故事板应该和图 9-16 中的样子一样。

![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们将允许你输入名字和姓氏。文本字段是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器上。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段的大小和位置设置为表格 9-2 中显示的样式。你可以通过大小检查器来完成这个操作，就像你为标签做的那样。

表格 9-2：视图控制器中的文本字段输入

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后，你需要添加一个叫做*日期选择器*的滚轮。它将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，允许用户选择日期或时间。它可以同时显示日期和时间，就像在日历应用中使用的日期选择器（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用的日期选择器。*

日期选择器还可以仅显示时间，就像时钟应用中的设置闹钟时使用的日期选择器，或者仅显示日期，这也是我们在 BirthdayTracker 中使用的。

滚动浏览对象库，直到找到日期选择器，然后点击并将其拖动到视图控制器的“出生日期”标签下。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。我们来将这个日期改成你的生日！将日期字段从“当前日期”更改为**自定义**。这样会出现一个新的框，修改日期为你的生日。

让我们通过运行应用来测试目前为止的功能！我们为输入控件设置的尺寸在 iPhone 7 的屏幕上非常合适。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你点击“生日”视图控制器上的+按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来不错，但其他设备呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，并再次运行应用。你会看到界面看起来不太对劲。

你添加到故事板的所有元素都显示出来了，但文本框超出了屏幕的边缘。现在，所有元素都已经出现在屏幕上，下一步是让它们能够在任何屏幕尺寸上正确显示。我们将通过一个叫做*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上都看起来完美，通过自动布局

iPhone 单独就有三种不同的屏幕尺寸，而且未来可能会有更多的尺寸推出。你需要设计你的应用，使其在任何设备上都能显示良好。这意味着你需要让你的应用调整屏幕中所有元素的位置和大小，以适应你的应用运行的设备。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕的故事板面板底部有一排图标，紧挨着工具面板的是一个位于两条垂直线之间的三角形图标。将鼠标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击此图标，弹出一菜单提供建议。点击**添加缺失的约束**。^(*) 当你这么做时，你会看到一堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小都合适，以适应屏幕。例如，自动布局使得日期选择器的大小适应屏幕宽度，不会超出边缘。自动布局还会确保每个文本框前后有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，添加生日屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。这些按钮现在不会做任何事情，我们只是设置它们。在第十章中，我们会添加一些代码，让它们能够取消“添加生日”界面并保存生日信息到应用中。

要添加保存按钮，从对象库中拖动一个“条形按钮项”并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们对添加按钮做的那样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中再拖动一个“条形按钮项”，这次将其放置在导航栏的*左侧*。使用属性检查器将其更改为取消按钮，就像你对保存按钮所做的那样。你的视图控制器应该看起来像图 9-21 所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新按钮的效果！

点击生日表视图控制器上的 + 按钮应该会带你进入添加生日视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前不会有任何反应——我们将在第十章中实现这两个功能！

### 你学到了什么

在这一章中，你开始制作生日追踪器应用程序，通过创建生日和添加生日屏幕的基本用户界面。你还使用表视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行导航。

现在你的应用程序的基本框架已经搭建完成，接下来你将在第十章中编写取消和保存按钮的代码，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项是禁用的。这是 Apple 的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。![Image](img/Image00214.jpg)

*图 9-16：输入标签已添加到视图控制器中。*

接下来，你将添加两个*文本字段*，它们将让你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们将能够在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到你的视图控制器中。一个用来输入名字，另一个用来输入姓氏。给这两个文本字段设置表 9-2 中看到的大小和位置。你可以使用大小检查器来完成这一操作，就像你为标签所做的那样。

表 9-2：视图控制器中的文本字段输入

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后，你需要添加一个叫做*日期选择器*的控件。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，允许用户选择日期或时间。它可以同时包含日期和时间，就像日历应用中使用的日期选择器一样（参见 图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，类似于时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到 Birthdate 标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为仅显示 **日期**，而不是日期和时间（参见 图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。我们将把这个日期改为你的生日！将日期字段从“当前日期”更改为 **自定义**。这样，一个新的框将会出现。把日期改为你的生日。

让我们通过运行应用程序来测试一下到目前为止的效果！我们为输入控件设置的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你在 Birthdays 视图控制器上点击 + 按钮时，应该会显示添加生日的屏幕，如 图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来不错，但其他设备怎么样呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，然后再次运行应用程序。你会发现，界面看起来有些不对劲。

所有你添加到故事板上的元素都已显示出来，但文本框超出了屏幕的边缘。现在你已经将所有元素放到屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做 *自动布局* 的工具来完成这一点。

#### 在每个设备上使用自动布局让你的应用看起来完美

iPhone 本身就有三种不同的屏幕尺寸，未来可能会有更多尺寸。你需要设计你的应用程序，使其在任何设备上看起来都不错。这意味着，你希望应用程序能够调整所有元素的位置和大小，以适应应用程序运行的设备。自动布局使用一种叫做 *布局约束* 的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标来调出自动布局菜单。*

在屏幕故事板面板的底部，有一个带有图标的带状区域，位于“实用工具”面板前的最右侧的图标是一个位于两条垂直线之间的三角形。将鼠标悬停在该图标上，应该会显示一个标签，标明“解决自动布局问题”。点击此图标，会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 做到这一点后，你会看到在“添加生日”场景中添加了许多布局约束。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局使得日期选择器的大小适应屏幕的宽度，并且不会超出边缘。自动布局还将确保每个文本字段前后都有 20 点的间距，以便它们能很好地居中显示在屏幕上。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。这些按钮目前不会执行任何操作，我们只是将它们设置好。在第十章中，我们将添加一些代码，使这些按钮能够取消“添加生日”屏幕并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个“条形按钮项”，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们处理添加按钮一样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“条形按钮项”，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新的按钮效果！

点击生日表视图控制器上的 + 按钮应该会将你带到“添加生日”视图控制器，在那里你可以输入某人的姓名和出生日期。点击取消和保存按钮暂时不会做任何事情——我们将在第十章中实现它们！

### 你学到了什么

在这一章中，你开始制作 BirthdayTracker 应用，创建了生日和添加生日屏幕的基本用户界面。你还使用表格视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本骨架，你将在第十章中编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，添加缺失约束的选项被禁用。这是苹果的一个 bug。在这种情况下，选择选项**重置为缺失约束**来添加缺失的约束。

*图 9-16：为输入添加了标签到视图控制器。*

接下来，你将添加两个*文本字段*，它们将允许你输入名字和姓氏。文本字段是 UITextField 类的 UI 元素，用于在屏幕上显示可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，用户可以在字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器中。一个用于输入名字，另一个用于输入姓氏。给这两个文本字段设置在表格 9-2 中看到的尺寸和位置。你可以使用尺寸检查器，就像你设置标签一样。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一件事是一个叫做*日期选择器*的控件。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以包含日期和时间，就像日历应用中的日期选择器一样（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以仅显示时间，就像时钟应用中添加闹钟时使用的日期选择器，或者只显示日期，这就是我们将在 BirthdayTracker 中使用的方式。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到视图控制器中，放置在出生日期标签下。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的一些属性。点击选择日期选择器。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**而不是日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器设置为显示当前日期。让我们改成显示你的出生日期！将日期字段从当前日期改为**自定义**。这样做时，会出现一个新框。将这个日期改成你的出生日期。

让我们通过运行应用程序来测试它的工作效果！我们为输入控件选择的尺寸在 iPhone 7 屏幕上非常合适。因此，选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击“生日视图控制器”上的 + 按钮时，“添加生日”屏幕应该会显示出来，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器运行应用程序，比如 iPhone 5s，然后重新运行应用程序。你会看到界面看起来不太对劲。

你添加到故事板中的所有元素都显示出来了，但文本字段超出了屏幕边缘。现在，所有元素都已显示在屏幕上，下一步是让它们能够适应任何屏幕尺寸。我们将通过一种名为*自动布局*的工具来实现这一点。

#### 通过自动布局让你的应用程序在每个设备上看起来都完美

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会有更多尺寸出现。你需要设计你的应用程序，使它能够在任何设备上看起来都不错。这意味着你需要让你的应用程序能够根据运行应用程序的设备调整屏幕上所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来调出自动布局菜单。*

在屏幕故事板面板的底部有一条带有图标的功能区，位于“工具”面板之前的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上时，它应该会显示一个标签，写着“解决自动布局问题”。点击此图标会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到很多布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局会确保日期选择器的宽度适应屏幕，不会超出边缘。自动布局还会确保每个文本字段的前后有 20 个点的间距，使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用。这一次，“添加生日”界面应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将展示如何为“添加生日”视图控制器的导航栏创建“取消”和“保存”按钮。这些按钮暂时没有功能，我们只需要设置它们。在第十章中，我们将添加一些代码，使它们能够退出“添加生日”界面并将生日保存到应用中。

要添加“保存”按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右侧*。我们将把这个按钮改为“保存”按钮，就像我们为“添加”按钮所做的那样。选择按钮项，然后使用属性检查器将其设置为“保存”按钮。

最后，让我们添加“取消”按钮。从对象库中拖动另一个“Bar Button Item”，这次将它放置在导航栏的*左侧*。使用属性检查器将其设置为“取消”按钮，就像我们为“保存”按钮做的那样。您的视图控制器应该看起来像图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行您的应用，看看新添加的按钮！

点击生日表视图控制器上的“+”按钮应该会将您带到“添加生日”视图控制器，您可以在此输入一个人的姓名和生日日期。点击“取消”和“保存”按钮目前不会做任何事情——我们将在第十章中实现这两个按钮！

### 你学到的内容

在本章中，您开始制作一个生日追踪器应用，创建了“生日”和“添加生日”界面的基本用户界面。您还使用表视图控制器创建了“生日”界面，并使用户能够通过“添加”按钮和导航控制器在界面之间进行切换。

现在您的应用已经有了基本框架，接下来您将在第十章中编写代码，完成“取消”和“保存”按钮的功能，这样就能在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用，这是一个苹果的 bug。在这种情况下，选择**重置为缺失约束**选项以添加缺失的约束。

接下来，你将添加两个*文本字段*，这将允许你输入名字和姓氏。文本字段是 UITextField 类的一个 UI 元素，用于在屏幕上显示一个可编辑的文本区域。当用户点击文本字段时，键盘会自动弹出，他们可以在文本字段中输入一行文本。

##### 添加文本字段

从对象库中拖动两个文本字段对象到视图控制器上。一个用于输入名字，另一个用于输入姓氏。将这两个文本字段的大小和位置设置为表 9-2 中所示的样子。你可以通过大小检查器来完成这个操作，就像你为标签设置一样。

表 9-2：视图控制器中输入的文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后，你需要添加的是一个称为*日期选择器*的控件。这个控件可以让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用程序中用于让用户选择日期或时间的标准工具。它可以包含日期和时间，就像在日历应用中使用的日期选择器一样（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用的日期选择器。*

日期选择器也可以只显示时间，就像在时钟应用中设置闹钟时使用的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中将要使用的。

滚动浏览对象库，直到找到日期选择器，然后点击并将其拖动到视图控制器中的“出生日期”标签下。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你还需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将此日期更改为你的出生日期！将日期字段从“当前日期”更改为**自定义**。此时会出现一个新框，修改日期为你的出生日期。

让我们通过运行应用程序来测试它目前的工作情况！我们为输入控件所使用的尺寸适合 iPhone 7 屏幕。因此，选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击“生日”视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备怎么样呢？选择一个更小的模拟器，如 iPhone 5s，重新运行应用。你会发现界面显示得不太对劲。

所有你添加到故事板中的元素都显示出来了，但文本框超出了屏幕边缘。现在你已经把所有元素放到屏幕上，下一步是让它们能够在任何屏幕尺寸上正确显示。我们将通过一个叫做*自动布局*的工具来完成这项工作。

#### 使用自动布局使你的应用在每个设备上都看起来完美

iPhone 本身就有三种不同的屏幕尺寸，未来可能会有更多尺寸的设备出现。你会希望设计你的应用，使它在任何设备上都看起来不错。这意味着，你需要让你的应用能够根据运行设备的不同，调整应用中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，调出自动布局菜单。*

在屏幕的故事板窗格底部有一条带图标的带状工具条，右侧的图标是一个在两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它会显示一个标签，写着“解决自动布局问题”。点击此图标以调出一系列建议。点击**添加缺失约束**。^(*) 这样做后，你会看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的尺寸正确，以适应屏幕。例如，自动布局使得日期选择器的宽度适应屏幕宽度，并且不会超出屏幕边缘。自动布局还会确保每个文本框前后有 20 个点，使其在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。按钮现在还没有功能，我们只是简单设置一下它们。在第十章中，我们会添加一些代码，让它们可以取消“添加生日”界面并保存生日到应用中。

为了添加“保存”按钮，从对象库中拖动一个“条形按钮项目”并将其放置在导航栏的*右侧*。我们将把这个按钮设置为“保存”按钮，就像我们之前为“添加”按钮所做的那样。选择按钮项，然后使用属性检查器将其设置为“保存”按钮。

最后，让我们添加“取消”按钮。从对象库中拖动另一个“条形按钮项目”，并将其放置在导航栏的*左侧*。使用属性检查器将其设置为“取消”按钮，就像你为“保存”按钮所做的那样。你的视图控制器应该像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有“取消”和“保存”按钮的输入视图控制器*

现在再次运行你的应用，看看新增的按钮！

点击生日表视图控制器上的+按钮将带你进入“添加生日”视图控制器，在那里你可以输入一个人的名字和出生日期。点击“取消”和“保存”按钮目前没有任何反应——我们将在第十章中实现这两个功能！

### 你学到的内容

在本章中，你开始制作生日追踪器应用，首先创建了“生日”和“添加生日”界面的基本用户界面。你还使用表视图控制器创建了“生日”界面，并使用户能够通过“添加”按钮和导航控制器在不同界面之间导航。

现在你已经完成了应用的基本框架，接下来将在第十章中编程实现“取消”和“保存”按钮，以便你可以在应用中添加和保存生日信息！

* 在某些版本的 Xcode 中，“添加缺失约束”选项是禁用的。这是一个苹果的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

##### 添加文本字段

从对象库中将两个文本字段对象拖到视图控制器中。一个用来输入名字，另一个用来输入姓氏。将两个文本字段的大小和位置设置为表 9-2 中所示的样式。你可以使用大小检查器，就像你为标签所做的那样。

表 9-2：视图控制器中的文本字段输入

| 文本字段 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个元素是一个叫做*日期选择器*的控件。它可以让你轻松地输入生日。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，允许用户选择日期或时间。它可以同时包含日期和时间，就像日历应用中使用的日期选择器（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用的日期选择器。*

日期选择器还可以仅显示时间，就像在时钟应用中用于添加闹钟的日期选择器一样，或者仅显示日期，这是我们在 BirthdayTracker 中使用的。

在对象库中滚动，直到找到一个日期选择器，然后点击并将其拖动到“出生日期”标签下的视图控制器中。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将这个日期改成你的生日！将日期字段从当前日期更改为**自定义**。当你这么做时，一个新框会出现。将此日期更改为你的生日。

让我们通过运行应用来测试它目前的效果！我们为输入控件使用的尺寸非常适合 iPhone 7 屏幕。因此，选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击“出生日期”视图控制器上的+按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来非常不错，但其他设备呢？选择一个更小的模拟器来运行应用，例如 iPhone 5s，并重新运行应用。你会看到，某些部分看起来并不完全合适。

你添加到故事板中的所有元素都显示出来了，但文本框超出了屏幕边缘。现在，所有元素都已经放置到屏幕上，接下来的步骤是确保它们能在任何屏幕尺寸下正确适应。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 使用自动布局让你的应用在每个设备上看起来完美

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会有更多的尺寸。你需要设计你的应用程序，使其在任何设备上看起来都很合适。这意味着，你需要让你的应用根据运行的设备自动调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部第四个图标，调出自动布局菜单。*

在屏幕故事板面板的底部有一条带图标的带状区域，在“实用工具”面板之前最右侧的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它会显示一个标签，写着“解决自动布局问题”。点击该图标会弹出一份建议菜单。点击**添加缺失约束**。^(*) 当你执行此操作时，你将看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的大小适应屏幕的宽度，不会超出边界。自动布局还会确保每个文本框前后有 20 个点，这样它们就能在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用。这次，“添加生日”界面应该看起来完美。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消（Cancel）和保存（Save）按钮。这些按钮现在还没有任何功能，我们只是先设置它们。在第十章，我们将添加一些代码，使它们可以退出“添加生日”界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右*侧。我们将把这个按钮改为保存按钮，就像我们之前做的“添加”按钮一样。选择按钮项，然后使用属性检查器将其改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左*侧。使用属性检查器将其改为取消按钮，就像你做的保存按钮一样。你的视图控制器应该看起来像图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新的按钮！

点击“生日”表视图控制器上的+按钮，应该会带你进入“添加生日”视图控制器，在这里你可以输入一个人的姓名和出生日期。点击取消和保存按钮现在还没有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在这一章中，你通过创建“生日”和“添加生日”界面的基本用户界面开始制作 BirthdayTracker 应用。你还使用表视图控制器创建了“生日”界面，并使得用户可以通过添加按钮和导航控制器在各个界面之间导航。

现在，你已经完成了应用的基础框架，在第十章中，你将编写代码实现取消和保存按钮，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，"添加缺失约束"选项被禁用。这是一个苹果的 BUG。在这种情况下，选择选项**重置为缺失约束**来添加缺失的约束。

从对象库中拖动两个文本框对象到视图控制器上。其中一个用于输入名字，另一个用于输入姓氏。将这两个文本框设置为表 9-2 中所示的尺寸和位置。你可以像设置标签一样，使用大小检查器来完成这一步。

表 9-2：视图控制器中的输入文本框

| 文本框 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个元素是一个被称为*日期选择器*的滚轮。这个滚轮将使你能够轻松输入生日。

##### 添加日期选择器

日期选择器是 iOS 应用中标准的工具，用于允许用户选择日期或时间。它可以同时显示日期和时间，就像日历应用中的日期选择器（参见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以仅显示时间，比如时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的。

滚动浏览对象库，直到找到一个日期选择器，然后点击并拖动它到视图控制器的出生日期标签下方。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的某些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而非日期和时间（参见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将其更改为你的生日！将日期字段从“当前日期”更改为**自定义**。这样会弹出一个新框，将此日期更改为你的生日。

让我们通过运行应用来测试到目前为止的效果！我们为输入控件设置的尺寸在 iPhone 7 的屏幕上适配良好。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击出生日期视图控制器上的+按钮时，"添加生日"的页面应该会显示出来，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美适配 iPhone 7 屏幕。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很不错，但其他设备呢？选择一个更小的模拟器来运行应用，比如 iPhone 5s，然后再次运行应用。你会发现显示效果不太合适。

你添加到故事板中的所有元素都显示出来了，但文本字段超出了屏幕边缘。现在，你已经将所有元素放到屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来做到这一点。

#### 让你的应用在每个设备上看起来都完美无缺，使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能会推出更多尺寸。你需要设计应用程序，使其在任何设备上都能看起来很好。这意味着你希望你的应用能够根据运行应用的设备调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接着，查看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标调出自动布局菜单。*

在屏幕故事板面板的底部，有一个带图标的带状工具栏，位于实用工具面板之前的最右边的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上时，它应该会显示一个标签，指示“解决自动布局问题”。点击这个图标，调出一个建议菜单。点击**添加缺失的约束**。^(*)这样，你会看到在“添加生日”场景中添加了一大堆布局约束。

这些自动布局约束确保每个元素的大小都适合屏幕。例如，自动布局使日期选择器的大小适应屏幕宽度，并且不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点的间隔，这样它们就能在屏幕上居中显示。

现在，再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。这些按钮现在还不会执行任何操作，我们只是设置它们。在第十章中，我们会添加一些代码，让它们能够退出“添加生日”屏幕，并将生日保存到应用程序中。

要添加“保存”按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮变成一个保存按钮，就像我们之前将添加按钮一样。选择按钮项，然后使用属性检查器将其设置为“保存”按钮。

最后，我们来添加取消按钮。从对象库中拖动另一个 Bar Button Item，并将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮做的那样。你的视图控制器应该与图 9-21 中所示的相同。

![Image](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新添加的按钮！

在“生日”表格视图控制器上点击+按钮，应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮暂时没有任何效果——我们将在第十章中实现这两个功能！

### 你学到的内容

在本章中，你开始创建了一个生日追踪器应用，通过为“生日”界面和“添加生日”界面创建基本的用户界面。你还使用表格视图控制器创建了“生日”界面，并使用户能够通过添加按钮和导航控制器在界面之间切换。

现在你已经完成了应用的基本框架，在第十章中，你将编写代码来实现取消和保存按钮，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失的约束”选项被禁用。这是一个苹果的错误。遇到这种情况时，选择**重置为缺失的约束**以添加缺失的约束。

表 9-2：视图控制器中的输入文本字段

| 文本字段 | X 位置 | Y 位置 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

你需要添加的最后一个控件是一个称为*日期选择器*的轮盘。这将让你轻松地输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以包含日期和时间，类似于日历应用中的日期选择器（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用日期选择器选择日期。*

日期选择器还可以仅显示时间，例如在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这就是我们在生日追踪器中使用的方式。

滚动对象库，直到找到日期选择器，然后点击并拖动它到“出生日期”标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的一些属性。点击日期选择器以选中它。然后，在属性检查器中将日期选择器的模式设置为显示**日期**而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将日期更改为您的出生日期！将日期字段从“当前日期”更改为**自定义**。完成此操作后，会出现一个新的框，您可以将日期更改为您的出生日期。

让我们通过运行应用程序来测试它目前的表现！我们为输入控件设置的尺寸非常适合 iPhone 7 屏幕。因此，选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当您在生日视图控制器上点击 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备怎么样呢？选择一个更小的模拟器来运行应用程序，比如 iPhone 5s，然后重新运行应用程序。您会看到，界面看起来不太对劲。

您添加到故事板中的所有元素都会显示，但文本字段超出了屏幕的边缘。现在，您已经将所有元素添加到屏幕上，接下来的步骤是确保它们在任何屏幕尺寸下都能正确适配。我们将使用一种名为*自动布局*的工具来完成此操作。

#### 让您的应用在每个设备上都能完美显示，使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，而且未来可能会有更多尺寸出现。您需要设计应用程序，使其在任何设备上都能良好展示。这意味着您希望应用程序根据运行它的设备自动调整屏幕上所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。您需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（请参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标来弹出自动布局菜单。*

在屏幕的故事板面板底部，有一个带图标的功能区，右侧在工具面板之前的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，内容为“解决自动布局问题”。点击该图标会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 完成此操作后，您会看到一大堆布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小都正确，以适应屏幕。例如，自动布局会确保日期选择器的宽度适应屏幕并不会超出边界。自动布局还会确保每个文本字段前后有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这一次，“添加生日”屏幕应该完美显示。

#### 添加保存和取消按钮

为了完成最后的步骤，我们将向你展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。这些按钮目前不会有任何功能，我们只是先设置它们。我们将在第十章中添加一些代码，让它们可以取消退出“添加生日”屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮变成保存按钮，就像我们设置添加按钮时做的那样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将它放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你设置保存按钮时做的那样。你的视图控制器应该像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新按钮的效果！

在“生日”表格视图控制器中点击+按钮，应该会带你进入“添加生日”视图控制器，在这里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前没有任何作用——我们将在第十章实现这两个功能！

### 你学到的内容

在本章中，你开始制作一个 BirthdayTracker 应用，通过创建“生日”和“添加生日”屏幕的基本用户界面。你还使用表格视图控制器创建了“生日”屏幕，并让用户可以通过“添加”按钮和导航控制器在不同的屏幕之间导航。

现在你已经完成了应用的基本框架，接下来你将在第十章中编写代码来实现取消和保存按钮，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项是禁用的，这是一个苹果的 bug。遇到这种情况时，选择“重置为缺失约束”选项来添加缺失的约束。

| 文本字段 | X 坐标 | Y 坐标 | 宽度 | 高度 |
| --- | --- | --- | --- | --- |
| 名字 | 20 | 130 | 335 | 30 |
| 姓氏 | 20 | 200 | 335 | 30 |

最后，你需要添加的是一个叫做*日期选择器*的控件，它可以帮助你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像在日历应用中使用的日期选择器一样（见 图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这是我们在 BirthdayTracker 中使用的功能。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到“出生日期”标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为仅显示**日期**，而不是日期和时间（见 图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们把这个日期改为你的生日！将日期字段从“当前日期”改为**自定义**。当你这么做时，会出现一个新框。将这个日期改为你的生日。

让我们通过运行应用来测试到目前为止它的工作情况！我们为输入控件使用的尺寸适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，当你点击“生日”视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如 图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，然后再次运行应用。你会发现屏幕上的显示有些不对劲。

所有你添加到故事板中的元素都出现了，但文本框超出了屏幕的边缘。现在你已经将所有元素放置到屏幕上，下一步是让它们在任何屏幕尺寸上都能正确显示。我们将通过一个叫做*自动布局*的工具来完成这一点。

#### 通过自动布局让你的应用在每个设备上都看起来完美

仅 iPhone 就有三种不同的屏幕尺寸，而且未来可能会出现更多尺寸。你需要设计你的应用，使其在任何设备上都能看起来很合适。这意味着，你希望应用能够根据运行的设备自动调整屏幕上所有元素的位置和大小。自动布局使用称为*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕的故事板面板底部有一条带有图标的工具条，右侧最靠近“工具”面板的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击此图标，打开一个建议菜单。点击**添加缺失的约束**。^(*) 这样做后，你会看到许多布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小都能正确适应屏幕。例如，自动布局使日期选择器的宽度适应屏幕宽度，不会超出边缘。自动布局还会确保每个文本字段前后各有 20 个点，这样它们就能在屏幕上居中显示。

现在在 iPhone 5s 模拟器中重新运行应用。这次，“添加生日”界面应该完美显示。

#### 添加保存和取消按钮

为了结束本节内容，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮现在还没有任何功能，我们只是先设置好它们。在第十章中，我们将添加一些代码，使得按钮能够取消“添加生日”界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右侧*。我们将把这个按钮设置为保存按钮，就像我们之前设置添加按钮一样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，并将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该像图 9-21 所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新按钮效果如何！

点击生日表视图控制器上的+按钮，应该会跳转到“添加生日”视图控制器，在那里你可以输入人的姓名和生日。点击取消和保存按钮目前没有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在这一章中，你开始制作一个 BirthdayTracker 应用，通过创建“生日”和“添加生日”屏幕的基本用户界面。你还使用表视图控制器创建了“生日”屏幕，并让用户可以通过添加按钮和导航控制器在不同屏幕之间切换。

现在你已经完成了应用的基本框架，接下来将在第十章中编写代码来实现“取消”和“保存”按钮，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失的约束”选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失的约束**选项来添加缺失的约束。

最后，你需要添加一个叫做*日期选择器*的控件。这将让你轻松输入出生日期。

##### 添加日期选择器

日期选择器是 iOS 应用中用于允许用户选择日期或时间的标准工具。它可以同时包含日期和时间，就像日历应用中使用的日期选择器（参见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：日期选择器用于在日历应用中添加事件时选择日期。*

日期选择器也可以仅显示时间，就像在时钟应用中用于添加闹钟的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到“出生日期”标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的几个属性。点击日期选择器进行选择。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。我们来把这个日期改成你的出生日期吧！将日期字段从“当前日期”改为**自定义**。这样会出现一个新的框，改成你的出生日期。

让我们通过运行应用来测试一下目前的效果！我们为输入控件设置的尺寸非常适合 iPhone 7 屏幕。所以选择 iPhone 7 模拟器，并点击左上角的播放按钮。这次，当你点击“生日”视图控制器上的 + 按钮时，应该会显示“添加生日”界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很好，但其他设备呢？选择一个较小的模拟器，比如 iPhone 5s，再次运行应用。你会发现效果不太对劲。

所有你添加到故事板的元素都会显示出来，但文本字段超出了屏幕的边缘。现在，既然你已经把所有元素放到屏幕上，下一步是确保它们能在任何屏幕尺寸上正确适配。我们将使用一个叫做*自动布局*的工具来完成这个任务。

#### 使用自动布局让你的应用在每个设备上都看起来完美

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会有更多尺寸。你需要设计应用，使其在任何设备上看起来都很好。这意味着，你需要让应用自动调整所有元素的位置和大小，以适应运行该应用的设备。自动布局使用一种叫做*布局约束*的东西来将元素放置到屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标，弹出自动布局菜单。*

在屏幕故事板面板的底部，有一个带有图标的带状工具栏，在实用工具面板前的最右侧图标是一个夹在两条竖线之间的三角形。将鼠标光标悬停在这个图标上，它会显示一个标签，写着“解决自动布局问题”。点击此图标，会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到很多布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的宽度适合屏幕，并且不会超出边缘。自动布局还会确保每个文本字段前后都有 20 个点，这样它们就能在屏幕上居中显示。

现在，再次在 iPhone 5s 模拟器上运行应用。这次，“添加生日”页面应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成最后的工作，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮暂时不会执行任何操作，我们只会进行设置。在第十章中，我们将添加一些代码，使按钮能够取消并退出“添加生日”页面，同时保存生日信息到应用中。

要添加保存按钮，从对象库中拖动一个 Bar Button Item，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们之前做的添加按钮一样。选择按钮项，然后使用属性检查器将其变成保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，并将其放置在导航栏的 *左侧*。使用属性检查器将其转换为取消按钮，就像你之前对保存按钮所做的那样。你的视图控制器应该像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在重新运行应用程序，看看新的按钮效果！

点击 Birthdays 表视图控制器中的 + 按钮应该会带你进入 Add a Birthday 视图控制器，在那里你可以输入一个人的姓名和生日。点击取消和保存按钮目前没有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到的内容

在本章中，你通过创建 Birthdays 和 Add a Birthday 屏幕的基本用户界面，开始了制作生日追踪器应用的过程。你还使用表视图控制器创建了 Birthdays 屏幕，并使用户可以通过 Add 按钮和导航控制器在屏幕之间进行导航。

现在你已经有了应用的基本框架，接下来你将在第十章中编程实现取消和保存按钮功能，从而能够在应用中添加和保存生日！

* 在一些版本的 Xcode 中，"Add Missing Constraints" 选项被禁用，这是苹果的一个 bug。遇到这种情况时，选择 **Reset to Missing Constraints** 选项来添加缺失的约束。

##### 添加日期选择器

日期选择器是 iOS 应用中用于让用户选择日期或时间的标准工具。它可以同时包含日期和时间，像在日历应用中使用的日期选择器（见图 9-17）。

![图片](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，日期选择器用于选择日期。*

日期选择器还可以仅显示时间，就像在时钟应用中添加闹钟时使用的日期选择器，或者仅显示日期，这正是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到视图控制器下的 Birthdate 标签旁。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器选中它。然后，在属性检查器中将日期选择器的模式设置为显示 **Date**，而不是日期和时间（见图 9-18）。

![图片](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将此日期更改为你的生日！将日期字段从当前日期更改为 **Custom**。这样，新的输入框将会出现。将日期改为你的生日。

让我们通过运行应用程序来测试到目前为止它的工作情况！我们为输入控件设置的大小在 iPhone 7 屏幕上显示得很好。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你点击“生日”视图控制器上的+按钮时，“添加生日”屏幕应该会显示出来，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，再次运行应用程序。你会看到，界面显示得不太正确。

你添加到故事板的所有元素都出现了，但文本字段超出了屏幕的边缘。现在你已经将所有元素添加到屏幕上，下一步是确保它们能够正确适配任何屏幕大小。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上都看起来完美，使用自动布局

iPhone 本身有三种不同的屏幕尺寸，并且未来可能会有更多尺寸的出现。你需要设计你的应用程序，使其在任何设备上都看起来不错。这意味着你需要让你的应用程序调整屏幕上所有元素的位置和大小，以适应运行应用程序的设备。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部第四个图标以调出自动布局菜单。*

在屏幕的故事板面板底部有一个带有图标的功能区，位于“实用工具”面板之前的最右侧图标是两个垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，上面写着“解决自动布局问题”。点击此图标，将弹出一个建议菜单。点击**添加缺失的约束**。^(*)当你这样做时，你会看到一大堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素都能够正确地调整大小，适配屏幕。例如，自动布局使日期选择器能够适配屏幕宽度，不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点，以便它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将展示如何为“添加生日”视图控制器的导航栏添加“取消”和“保存”按钮。这些按钮暂时还不会执行任何操作，我们只是设置它们。在第十章中，我们会添加代码使它们可以取消“添加生日”屏幕并将生日保存到应用中。

要添加“保存”按钮，从对象库中拖动一个 Bar Button Item，并将其放置在导航栏的*右侧*。我们将把这个按钮变成一个保存按钮，像之前做“添加”按钮那样。选择按钮项，然后使用属性检查器将其转换为“保存”按钮。

最后，我们来添加“取消”按钮。从对象库中拖动另一个 Bar Button Item，这次将其放置在导航栏的*左侧*。使用属性检查器将其转换为“取消”按钮，像设置“保存”按钮一样。你的视图控制器应该像图 9-21 所示那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行应用程序，查看新添加的按钮！

点击生日表格视图控制器上的 + 按钮应该会带你到“添加生日”视图控制器，在这里你可以输入一个人的姓名和出生日期。点击“取消”和“保存”按钮暂时不会有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用程序，通过创建生日和添加生日屏幕的基本用户界面。你还使用表格视图控制器创建了生日屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用程序的基本框架，接下来在第十章中，我们将编写代码来实现“取消”和“保存”按钮功能，以便你可以在应用中添加并保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

日期选择器是 iOS 应用中常用的工具，允许用户选择日期或时间。它可以同时包含日期和时间，就像日历应用中使用的日期选择器一样（见图 9-17）。

![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时使用的日期选择器。*

日期选择器也可以只显示时间，比如在时钟应用中添加闹钟时使用的日期选择器，或者只显示日期，这就是我们在 BirthdayTracker 中将使用的方式。

浏览对象库，直到找到日期选择器，然后点击并将其拖到出生日期标签下的视图控制器上。使用尺寸检查器，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认设置为显示当前日期。让我们将日期改为你的生日！将日期字段从“当前日期”更改为**自定义**。这样做后，会出现一个新框。将此日期更改为你的生日。

让我们通过运行应用程序来测试它到目前为止的工作情况！我们为输入控件所使用的尺寸在 iPhone 7 屏幕上显示得很合适。所以，选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击生日视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美契合。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器来运行应用程序，例如 iPhone 5s，然后重新运行应用程序。你会看到，显示效果并不完全正确。

所有你添加到故事板的元素都出现了，但文本字段超出了屏幕的边缘。现在，你已经将所有元素放在了屏幕上，下一步是让它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来完成这项工作。

#### 让你的应用在每个设备上看起来完美，使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，而且未来可能会出现更多尺寸。你需要设计应用程序，使其在任何设备上都能显示得很好。这意味着你需要让应用程序根据设备的不同，自动调整界面元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来将元素放置到屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，查看编辑器窗格右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来打开自动布局菜单。*

在屏幕故事板窗格的底部有一个带图标的带状工具栏，编辑器窗格中倒数第二个图标是一个位于两条竖线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，上面写着“解决自动布局问题”。点击该图标会弹出建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到很多布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适配屏幕，并且不会超出屏幕边缘。自动布局还会确保每个文本字段前后都有 20 个点的间距，从而使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用。这次，“添加生日”界面应该完美显示。

#### 添加保存和取消按钮

为了完成最后的步骤，我们将展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。按钮目前不会执行任何操作，我们只是设置它们。在第十章中，我们将添加代码，使这些按钮能够取消返回“添加生日”界面，并将生日信息保存到应用中。

为了添加保存按钮，从对象库中拖动一个 Bar Button Item，并将其放置在导航栏的*右侧*。我们将把这个按钮设置为保存按钮，就像我们为添加按钮所做的那样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该看起来像图 9-21 所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新添加的按钮！

点击“生日”表视图控制器上的 + 按钮应该会跳转到“添加生日”视图控制器，在那里你可以输入一个人的姓名和生日。点击取消和保存按钮目前不会执行任何操作——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你开始创建一个生日追踪应用程序，首先创建了“生日”和“添加生日”界面的基本用户界面。你还使用表视图控制器创建了“生日”界面，并使用户能够通过“添加”按钮和导航控制器在界面之间进行切换。

现在你已经完成了应用的基本框架，在第十章中，你将编程实现取消和保存按钮，这样你就能在应用中添加和保存生日信息了！

* 在某些版本的 Xcode 中，"Add Missing Constraints" 选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **Reset to Missing Constraints** 选项以添加缺失的约束。![Image](img/Image00215.jpg)

*图 9-17：在日历应用中添加事件时，日期选择器用于选择日期。*

日期选择器也可以仅显示时间，就像时钟应用程序中用于添加闹钟的日期选择器，或者仅显示日期，这是我们在 BirthdayTracker 中将使用的方式。

在对象库中滚动查找日期选择器，然后点击并拖拽到生日标签下的视图控制器上。使用尺寸检查器，将 x 位置设为 0，y 位置设为 280。

你会想要微调日期选择器的几个属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![图像](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将这个日期改为你的出生日期吧！将日期字段从当前日期更改为**自定义**。当你这样做时，会出现一个新的框。将这个日期改为你的出生日期。

让我们通过运行它来测试到目前为止应用程序的工作情况！我们用于输入控件的大小在 iPhone 7 屏幕上适合得很好。因此，请选择 iPhone 7 模拟器，并点击左上角的播放按钮。这一次，在生日视图控制器上点击 + 按钮时，应该显示添加生日屏幕，如图 9-19 所示。

![图像](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![图像](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，然后再次运行应用程序。你会发现事情看起来不太对劲。

所有添加到故事板的元素都显示出来了，但文本字段超出了屏幕边缘。现在你已经在屏幕上放置了所有元素，下一步是确保它们能够在任何屏幕尺寸上正确显示。我们将使用一个名为*自动布局*的工具来完成这一步骤。

#### 使用自动布局让你的应用程序在每台设备上看起来完美

iPhone 单独有三种不同的屏幕尺寸，未来可能还会有更多尺寸。你希望设计你的应用程序在任何设备上都能看起来很棒。这意味着你需要调整应用程序中所有元素的位置和大小，以适应应用程序运行的设备。自动布局使用称为*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，看一看编辑器窗格右下角的四个图标（见图 9-20）。

![图像](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标来打开自动布局菜单。*

在屏幕故事板面板的底部，有一个带有图标的带状工具条，紧挨着工具栏的是一个位于两条垂直线之间的三角形图标。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击此图标会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 当你这么做时，你会看到一大堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的大小适应屏幕的宽度，不会超出边界。自动布局还会确保每个文本框前后都有 20 个点的间距，从而使它们在屏幕上居中显示。

现在，在 iPhone 5s 模拟器上再次运行应用程序。这次，添加生日界面应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这部分，我们将向你展示如何为“添加生日”视图控制器的导航栏制作“取消”和“保存”按钮。按钮目前还没有任何功能。我们只是先进行设置。在第十章中，我们将添加一些代码，使这些按钮能够退出“添加生日”界面，并将生日保存到应用中。

要添加“保存”按钮，从对象库中拖动一个 Bar Button Item，并将其放置在导航栏的*右*侧。我们将把这个按钮变成“保存”按钮，就像我们做的“添加”按钮一样。选择按钮项，然后使用属性检查器将其转换为“保存”按钮。

最后，让我们添加“取消”按钮。从对象库中拖动另一个 Bar Button Item，这次将其放置在导航栏的*左*侧。使用属性检查器将其转换为“取消”按钮，就像你做的“保存”按钮一样。你的视图控制器应该像图 9-21 所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新按钮的效果！

在“生日”表视图控制器上点击 + 按钮，应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的名字和出生日期。点击“取消”和“保存”按钮目前不会有任何反应——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用程序，通过创建生日和添加生日界面的基本用户界面。你还使用表视图控制器创建了生日界面，并使用户可以通过添加按钮和导航控制器在界面之间切换。

现在你已经完成了应用程序的基本框架，接下来将花时间在第十章中编程实现“取消”和“保存”按钮，这样你就可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项是禁用的。这是苹果的一个错误。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

*图 9-17：在日历应用中添加事件时使用的日期选择器。*

日期选择器还可以仅显示时间，就像时钟应用中添加闹钟时使用的日期选择器，或者只显示日期，这正是我们在 BirthdayTracker 中使用的功能。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到 Birthdate 标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整一些日期选择器的属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器设置为显示当前日期。让我们将这个日期改为你的出生日期！将日期字段从当前日期更改为**自定义**。这样会出现一个新框。将日期更改为你的出生日期。

让我们通过运行应用程序来测试到目前为止的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上适配得很好。因此，选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击 Birthdays 视图控制器上的 + 按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很好，但其他设备呢？选择一个更小的模拟器来运行应用程序，比如 iPhone 5s，然后再次运行应用程序。你会发现某些部分看起来不太对。

你添加到故事板中的所有元素都已显示出来，但文本字段超出了屏幕边缘。现在，所有元素都已显示在屏幕上，下一步是让它们在任何屏幕尺寸上都能正确适配。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 让你的应用在每个设备上都完美显示，使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会推出更多尺寸。你需要设计你的应用程序，使其在任何设备上看起来都很合适。这意味着你需要让你的应用程序调整应用中所有元素的位置和大小，以适应应用运行的设备。自动布局使用了一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的概述视图中选择**视图控制器**。接下来，看看编辑器窗格右下角的四个图标（参见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部第四个图标打开自动布局菜单。*

在屏幕的故事板窗格底部，有一个带有图标的带状工具栏，最右侧的图标是一个夹在两条竖线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，上面写着“解决自动布局问题”。点击此图标以弹出一个建议菜单。点击**添加缺失的约束**。^(*) 做到这一点后，你会看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的大小适应屏幕宽度，不会超出屏幕边缘。自动布局还会确保每个文本字段前后都有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。此时，添加生日屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成操作，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮目前还不做任何事情，我们只是设置它们。在第十章中，我们会添加一些代码，使它们能取消“添加生日”屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们做过的添加按钮一样。选择该按钮项，然后使用属性检查器将其转换为保存按钮。

最后，我们来添加取消按钮。从对象库中再拖动一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其转换为取消按钮，就像你为保存按钮所做的一样。你的视图控制器应该像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新的按钮！

在生日表视图控制器上点击 + 按钮应该会带你进入添加生日视图控制器，你可以在这里输入一个人的名字和生日日期。点击取消和保存按钮暂时不会有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到的内容

在本章中，你开始创建 BirthdayTracker 应用，首先搭建了“生日”和“添加生日”屏幕的基本用户界面。你还创建了使用表格视图控制器的“生日”屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本框架，接下来将在第十章中编程“取消”和“保存”按钮，添加和保存生日信息！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

日期选择器还可以仅显示时间，比如在时钟应用中添加闹钟时使用的日期选择器，或者只显示日期，这也是我们在 BirthdayTracker 中使用的方式。

滚动浏览对象库，直到找到日期选择器，然后点击并拖动它到“出生日期”标签下的视图控制器中。使用“大小检查器”，将 x 位置设置为 0，y 位置设置为 280。

你可能需要调整日期选择器的几个属性。点击日期选择器进行选择。然后，在“属性检查器”中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器设置为显示当前日期。让我们把这个日期改为你的生日！将日期字段从当前日期改为**自定义**。此时会出现一个新框，修改该日期为你的生日。

让我们通过运行应用来测试目前为止的效果！我们所使用的输入控件大小在 iPhone 7 屏幕上适配良好。所以选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这次，当你点击“生日”视图控制器上的+按钮时，“添加生日”屏幕应该会显示，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

在 iPhone 7 上效果很好，但其他设备呢？选择一个较小的模拟器运行应用，例如 iPhone 5s，然后再次运行应用。你会发现，界面看起来有些不对劲。

你添加到故事板中的所有元素都已显示，但文本框超出了屏幕边缘。现在你已经将所有元素放在了屏幕上，接下来的步骤是确保它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 通过自动布局让你的应用在每个设备上都完美显示

单独的 iPhone 就有三种不同的屏幕尺寸，未来可能会有更多尺寸的出现。你需要设计你的应用程序，以便它能够在任何设备上看起来都不错。这意味着你需要让应用程序调整其中所有元素的位置和大小，以适应设备的屏幕。自动布局使用一种叫做*布局约束*的技术来安排屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的概述视图中选择**视图控制器**。接下来，看看编辑器窗格右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部第四个图标打开自动布局菜单。*

在屏幕故事板面板的底部，有一条带有图标的功能区，最右边的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击此图标，会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 执行此操作后，你会看到一堆布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适合屏幕宽度，并且不会超出屏幕边缘。自动布局还会确保每个文本框前后有 20 个点的间隔，使它们在屏幕上居中对齐。

现在再次在 iPhone 5s 模拟器上运行应用程序。这一次，“添加生日”界面应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成最后的步骤，我们将向你展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。这些按钮暂时不会做任何事情，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够退出“添加生日”界面并保存生日信息。

要添加保存按钮，从对象库中拖动一个 Bar Button Item，并将其放置在导航栏的*右侧*。我们将把这个按钮更改为保存按钮，就像我们之前设置添加按钮一样。选择该按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新按钮的效果！

点击生日表格视图控制器上的 + 按钮应该会带你进入添加生日视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前没有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你通过创建生日和添加生日屏幕的基本用户界面，开始了生日追踪器应用的制作。你还使用表格视图控制器创建了生日屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用程序的基本框架，第十章将帮助你编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束的选项被禁用。这是苹果的一个 bug。在这种情况下，选择 **重置为缺失约束** 选项以添加缺失的约束。

在对象库中滚动，直到找到日期选择器，然后点击并拖动它到生日标签下的视图控制器中。使用大小检查器，将 x 位置设置为 0，y 位置设置为 280。

你需要调整日期选择器的几个属性。点击日期选择器以选中它。然后，在属性检查器中，将日期选择器的模式设置为显示 **日期**，而不是日期和时间（参见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

默认情况下，日期选择器显示的是当前日期。我们来将这个日期改成你的生日吧！将日期字段从当前日期改为 **自定义**。这样，一个新的框会出现。将日期改为你的生日。

让我们通过运行应用来测试目前的工作进展！我们为输入控件设置的尺寸适合 iPhone 7 屏幕。所以，选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这一次，当你点击生日视图控制器上的 + 按钮时，应该会显示添加生日的界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，然后重新运行应用。你会发现界面看起来不太对劲。

你添加到故事板上的所有元素都出现了，但文本框已经超出了屏幕边缘。现在，所有元素都显示在屏幕上，下一步是让它们在任何屏幕尺寸上都能正确适配。我们将使用一个叫做 *自动布局* 的工具来实现这一点。

#### 让你的应用在每个设备上都完美显示，使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，而且未来可能会有更多尺寸。你需要设计应用程序，使其在任何设备上都能看起来很好。这意味着你需要让应用程序根据运行它的设备，自动调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的概述视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标来弹出自动布局菜单。*

屏幕的故事板面板底部有一个包含图标的带状条，最右侧的图标是两个垂直线之间的三角形。将鼠标光标悬停在该图标上，它会显示一个标签，说明是“解决自动布局问题”。点击该图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*) 这样做后，你会看到许多布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适应屏幕宽度，并且不会超出边缘。自动布局还会确保每个文本字段前后有 20 个点的间距，以便它们在屏幕上居中显示。

现在重新在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成最后的步骤，我们将向你展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。此时这些按钮还没有任何功能。我们只是先设置它们。在第十章中，我们会添加一些代码，让它们能取消“添加生日”屏幕并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们为添加按钮所做的那样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，我们来添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将它放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新按钮的效果！

点击生日表格视图控制器上的+按钮应该会带你进入添加生日视图控制器，在这里你可以输入一个人的姓名和生日。点击取消和保存按钮目前还没有反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你开始通过创建“生日”和“添加生日”界面的基本用户界面来制作一个 BirthdayTracker 应用。你还使用表格视图控制器创建了“生日”界面，并让用户可以通过添加按钮和导航控制器在界面之间进行切换。

现在你的应用的基本框架已经完成，你将在第十章编程取消和保存按钮，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失的约束”选项是禁用的。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

你可能需要调整日期选择器的一些属性。点击日期选择器以选择它。然后，在属性检查器中，将日期选择器的模式设置为显示**日期**，而不是日期和时间（见图 9-18）。

![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将这个日期改为你的生日！将日期字段从当前日期更改为**自定义**。这样会出现一个新的框，修改这个日期为你的生日。

让我们通过运行应用来测试目前的效果！我们使用的输入控件的尺寸在 iPhone 7 屏幕上显示得很好。所以，选择 iPhone 7 模拟器，然后点击左上角的播放按钮。这次，当你在生日视图控制器上点击+按钮时，应该会显示添加生日界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但在其他设备上呢？选择一个较小的模拟器，比如 iPhone 5s，再次运行应用。你会看到界面显示不太对。

你添加到故事板中的所有元素都已显示，但文本字段超出了屏幕的边缘。现在你已经将所有元素放置在屏幕上，下一步是让它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 使用自动布局让你的应用在每个设备上都看起来完美

单独的 iPhone 有三种不同的屏幕尺寸，并且未来可能还会有更多尺寸。你需要设计你的应用，使其在任何设备上看起来都不错。这意味着你需要让你的应用调整应用中所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的概述视图中选择**视图控制器**。接着，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来弹出自动布局菜单。*

屏幕的故事板面板底部有一个带图标的功能带，位于实用工具面板之前的最右边的图标是一个夹在两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击这个图标会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 完成此操作后，你会看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，能够适应屏幕。例如，自动布局确保日期选择器的大小适合屏幕宽度，不会超出边界。自动布局还会确保每个文本字段前后都有 20 点的间距，以便它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这一次，“添加生日”屏幕应该看起来完美。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮暂时不会执行任何操作，我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消退出“添加生日”屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们做的添加按钮一样。选择按钮项，然后使用属性检查器将其改成保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其改成取消按钮，就像你做的保存按钮一样。你的视图控制器应该看起来像图 9-21 中显示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新的按钮！

点击“生日”表视图控制器上的+按钮应该会带你进入“添加生日”视图控制器，在这里你可以输入一个人的姓名和出生日期。点击“取消”和“保存”按钮目前没有任何反应——我们将在第十章中实现这两个功能！

### 你学到了什么

在这一章中，你开始制作一个 BirthdayTracker 应用，通过创建生日和添加生日屏幕的基本用户界面。你还使用表视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本框架，在第十章中你将编写代码来实现“取消”和“保存”按钮，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用了，这是苹果的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。![Image](img/Image00216.jpg)

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们将这个日期改成你的出生日期！将日期字段从“当前日期”改为**自定义**。这样会出现一个新框，改为你的出生日期。

让我们通过运行应用程序来测试到目前为止的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上看起来很合适。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击出生日期视图控制器上的+按钮时，“添加生日”屏幕应该会显示出来，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，然后再次运行应用程序。你会发现某些地方看起来不太对劲。

你添加到情节提要中的所有元素都已显示出来，但文本字段已经超出了屏幕边缘。现在你已经将所有元素添加到屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确适配。我们将使用一个名为*自动布局*的工具来实现这一点。

#### 通过自动布局让你的应用在每个设备上看起来完美

单单 iPhone 就有三种不同的屏幕尺寸，未来可能会有更多尺寸推出。你需要设计你的应用，使其在任何设备上都能良好显示。这意味着你需要让你的应用根据所运行设备的不同，自动调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来将元素放置在屏幕上。你需要在情节提要中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标调出自动布局菜单。*

在屏幕的故事板面板底部有一个带图标的带状栏，在“实用工具”面板之前的最右侧图标是两个垂直线之间的三角形。将鼠标光标悬停在该图标上时，它应该会显示一个标签，写着“解决自动布局问题”。点击该图标会弹出一个建议菜单。点击**添加缺失约束**。^(*) 这样做时，你会看到大量的布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的尺寸正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕宽度，并且不会超出屏幕边缘。自动布局还会确保每个文本字段前后都有 20 个点的间距，以便它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这个时候，添加生日的屏幕应该看起来完美。

#### 添加保存和取消按钮

为了完成这部分内容，我们将向你展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。按钮现在还不会执行任何操作——我们只是设置它们。在第十章中，我们将添加代码，使它们能退出添加生日屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个 Bar Button Item，并将其放置在导航栏的*右侧*。我们将把这个按钮改成一个保存按钮，就像我们之前将添加按钮改成添加按钮一样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，我们来添加取消按钮。从对象库中拖动另一个 Bar Button Item，这次将其放置在导航栏的*左侧*。使用属性检查器将其更改为取消按钮，就像你为保存按钮做的那样。你的视图控制器应该像图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新的按钮！

在生日表格视图控制器上点击 + 按钮应该会带你进入添加生日视图控制器，在这里你可以输入一个人的名字和出生日期。点击取消和保存按钮暂时没有任何反应——我们将在第十章实现它们！

### 你学到了什么

在这一章中，你开始制作一个 BirthdayTracker 应用，创建了基本的用户界面，包括生日和添加生日的界面。你还使用表格视图控制器创建了生日界面，并使用户可以通过添加按钮和导航控制器在各个界面之间切换。

现在，你已经完成了应用的基本框架，接下来的工作是在第十章中编程实现取消和保存按钮，这样你就可以在应用中添加并保存生日！

* 在某些版本的 Xcode 中，"添加缺失约束"选项是禁用的。这是一个苹果的 Bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

*图 9-18：更改日期选择器的设置。*

日期选择器默认显示当前日期。让我们把这个日期改为你的生日吧！将日期字段从当前日期更改为**自定义**。这样，一个新的框将会出现。将此日期更改为你的生日。

让我们通过运行应用来测试一下目前的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上非常合适。所以选择 iPhone 7 模拟器并点击左上角的播放按钮。这次，当你点击生日视图控制器上的+按钮时，应该会显示添加生日的界面，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

在 iPhone 7 上看起来很不错，但其他设备怎么样呢？选择一个较小的模拟器，比如 iPhone 5s，重新运行应用。你会看到某些东西看起来不太对劲。

所有你添加到情节提要中的元素都显示了出来，但文本字段超出了屏幕的边缘。现在，既然所有元素都已显示在屏幕上，下一步是让它们能够适应任何屏幕尺寸。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 通过自动布局让你的应用在每个设备上看起来都完美

iPhone 本身有三种不同的屏幕尺寸，并且未来可能会有更多尺寸发布。你需要设计你的应用，使其在任何设备上看起来都很好。这意味着你需要让应用根据运行的设备调整应用内所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在情节提要中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

屏幕的故事板面板底部有一个带图标的带状工具栏，在实用工具面板之前的最右侧是一个位于两条垂直线之间的三角形图标。将鼠标光标悬停在该图标上，应该会显示一个标签，写着“解析自动布局问题”。点击该图标以弹出建议菜单。点击**添加缺失约束**。^(*)这样做时，你会看到一堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的大小适应屏幕宽度，不会超出边界。自动布局还会确保每个文本字段前后有 20 点的间距，使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上再次运行应用程序。这一次，添加生日屏幕应该看起来完美。

#### 添加保存和取消按钮

最后，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮现在不会做任何事，我们只是设置它们。在第十章中，我们将添加一些代码，让它们可以取消添加生日屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个“条形按钮项”并将其放置在导航栏的*右*侧。我们将把这个按钮改为保存按钮，就像我们处理添加按钮一样。选择按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中再拖动一个“条形按钮项”，这次将其放置在导航栏的*左*侧。使用属性检查器将其转换为取消按钮，就像你做保存按钮时一样。你的视图控制器应该看起来像图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新按钮的效果！

在“生日”表视图控制器上点击 + 按钮，应该会带你进入添加生日视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮现在不会做任何事——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你开始制作一个生日追踪应用，通过创建“生日”和“添加生日”屏幕的基本用户界面。你还创建了一个使用表视图控制器的“生日”屏幕，并使用户能够通过“添加”按钮和导航控制器在屏幕之间进行导航。

现在你已经有了应用的基本框架，在第十章中，你将编写代码来实现取消和保存按钮，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择**重置为缺失约束**选项以添加缺失的约束。

日期选择器默认设置为显示当前日期。让我们将这个日期改为您的出生日期！将日期字段从当前日期改为**自定义**。这样做后，会出现一个新框。将日期更改为您的出生日期。

让我们通过运行应用程序来测试它目前的效果！我们为输入控件使用的尺寸在 iPhone 7 屏幕上很合适。因此，选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当您点击生日视图控制器上的+按钮时，应该会显示“添加生日”屏幕，如图 9-19 所示。

![Image](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器，如 iPhone 5s，再次运行应用程序。您会发现，界面显示不太对劲。

您添加到故事板中的所有元素都已显示，但文本字段超出了屏幕边缘。现在所有元素都已经出现在屏幕上，接下来的步骤是让它们适应任何屏幕尺寸。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 让您的应用在每个设备上看起来完美——使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，未来可能还会有更多尺寸。您需要设计您的应用程序，使其在任何设备上看起来都很不错。这意味着您需要让应用程序根据运行应用程序的设备来调整所有内容的位置和大小。自动布局使用一种叫做*布局约束*的东西来定位屏幕上的元素。您需要在故事板中添加这些约束。

首先，在左侧面板的概览视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请通过点击编辑器底部的第四个图标打开自动布局菜单。*

在屏幕故事板面板的底部，有一条带有图标的带状工具栏，在“实用工具”面板之前的最右边是一个位于两条垂直线之间的三角形图标。将鼠标光标悬停在该图标上，应该会显示一个标签，标明“解决自动布局问题”。点击这个图标会弹出一个建议菜单。点击**添加缺失约束**。^(*) 这样做后，您会看到一堆布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保每个元素的尺寸正确，以适应屏幕。例如，自动布局会确保日期选择器的宽度适应屏幕，并且不会超出边界。自动布局还会确保每个文本字段前后有 20 个点，使它们在屏幕上居中对齐。

现在在 iPhone 5s 模拟器上重新运行应用程序。这次，添加生日界面应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。这些按钮现在还没有功能，我们只是先设置它们。在第十章中，我们将添加一些代码，使得这两个按钮能够退出添加生日界面并保存生日到应用程序中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮更改为保存按钮，就像我们之前做的添加按钮一样。选择按钮项，然后使用属性检查器将其变成保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其变成取消按钮，就像你之前为保存按钮所做的那样。你的视图控制器应该像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在重新运行你的应用程序，查看新按钮！

在生日表视图控制器上点击 + 按钮，应该会带你进入添加生日视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前不会有任何反应——我们将在第十章实现这两个按钮！

### 你学到了什么

在本章中，你开始制作生日追踪器应用程序，创建了生日和添加生日屏幕的基本用户界面。你还使用表视图控制器创建了生日屏幕，并使得用户能够通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用程序的基本框架，接下来你将在第十章编写代码，为应用程序添加保存和取消按钮，这样你就可以在应用程序中添加和保存生日了！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **重置为缺失约束** 选项来添加缺失的约束。

让我们通过运行应用来测试它目前的效果！我们为输入控件选择的尺寸在 iPhone 7 屏幕上非常合适。所以，选择 iPhone 7 模拟器并点击左上角的播放按钮。这一次，当你在生日视图控制器中点击 + 按钮时，应该会显示添加生日界面，如图 9-19 所示。

![图片](img/Image00217.jpg)

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![图片](img/Image00218.jpg)

这在 iPhone 7 上看起来很不错，但其他设备呢？选择一个更小的模拟器，如 iPhone 5s，然后重新运行应用。你会发现一些元素显示得不太对。

你添加到故事板中的所有元素都出现了，但文本字段超出了屏幕边缘。现在，所有元素已经显示在屏幕上，接下来的步骤是确保它们能在任何屏幕尺寸上正确显示。我们将使用一个叫做*自动布局*的工具来完成这项工作。

#### 使用自动布局让你的应用在每个设备上看起来都完美

iPhone 本身有三种不同的屏幕尺寸，并且未来可能会有更多的尺寸。你需要设计你的应用，使其在任何设备上都能显示良好。这意味着，你需要让你的应用根据运行设备的不同，自动调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来打开自动布局菜单。*

在屏幕的故事板面板底部有一排图标，位于实用工具面板之前的最右侧图标是一个夹在两条垂直线之间的三角形。将鼠标悬停在这个图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击这个图标，打开建议菜单。点击**添加缺失的约束**。^(*) 这样做后，你会看到很多布局约束被添加到了“添加生日”场景中。

这些自动布局约束确保了每个元素的大小适合屏幕。例如，自动布局确保日期选择器的宽度与屏幕宽度相匹配，不会超出屏幕边缘。自动布局还会确保每个文本字段前后有 20 点的间距，使它们在屏幕上居中显示。

现在，再次在 iPhone 5s 模拟器上运行应用。这一次，生日添加界面应该显示得非常完美。

#### 添加保存和取消按钮

为了完成接下来的内容，我们将向你展示如何为添加生日视图控制器的导航栏创建取消和保存按钮。这些按钮现在还没有任何功能，我们只是先设置它们。在第十章中，我们将添加一些代码，让它们能够取消添加生日界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个 Bar Button Item，并将其放置在导航栏的*右*侧。我们将把这个按钮更改为保存按钮，方法和我们设置添加按钮时一样。选择按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，这次将其放置在导航栏的*左*侧。使用属性检查器将其转换为取消按钮，方法和设置保存按钮时一样。你的视图控制器应该和图 9-21 中显示的一样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新按钮的效果！

点击生日表格视图控制器上的+按钮，应该会进入添加生日视图控制器，在那里你可以输入一个人的名字和生日。点击取消和保存按钮目前没有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用，通过创建生日和添加生日界面的基本用户界面。你还使用表格视图控制器创建了生日界面，并使用户能够通过添加按钮和导航控制器在界面之间切换。

现在你已经完成了应用程序的基本骨架，接下来你将在第十章中编写代码来实现取消和保存按钮，这样你就可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项是禁用的。这是苹果的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。![Image](img/Image00217.jpg)

*图 9-19：文本框和日期选择器在 iPhone 7 屏幕上完美适配。*

![Image](img/Image00218.jpg)

这在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器来运行应用程序，比如 iPhone 5s，并再次运行应用程序。你会发现界面看起来有些不对劲。

所有你添加到故事板中的元素都已出现，但文本框已经超出了屏幕的边缘。现在你已经将所有元素放到屏幕上，下一步是让它们在任何屏幕尺寸下都能正确显示。我们将使用一个叫做*自动布局*的工具来完成这个任务。

#### 使用自动布局让你的应用在每个设备上看起来完美

iPhone 本身就有三种不同的屏幕尺寸，而且未来可能会有更多尺寸。你需要设计你的应用程序，使其在任何设备上看起来都很不错。这意味着你需要让你的应用程序调整屏幕上所有元素的位置和大小，以适应设备的显示。自动布局使用一种叫做*布局约束*的东西来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来打开自动布局菜单。*

在屏幕故事板面板的底部有一条带图标的工具带，位于工具面板之前的最右侧图标是两个垂直线之间的三角形。将鼠标光标悬停在该图标上，它会显示一个标签，说明是解决自动布局问题。点击该图标会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 这样做后，你会看到大量的布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的宽度适应屏幕，不会超出边缘。自动布局还会确保每个文本框前后都有 20 个点的间距，这样它们就能在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行该应用。这次，“添加生日”屏幕应该看起来非常完美。

#### 添加保存和取消按钮

为了完成这个步骤，我们将向你展示如何为“添加生日”视图控制器的导航栏添加“取消”和“保存”按钮。按钮暂时不会执行任何操作，我们只是先设置它们。在第十章中，我们将添加一些代码，使它们能够退出“添加生日”屏幕并将生日保存到应用中。

要添加“保存”按钮，从对象库中拖动一个“条形按钮项”，并将其放置在导航栏的*右侧*。我们将把这个按钮更改为“保存”按钮，就像之前我们做的“添加”按钮一样。选择该按钮项，然后使用属性检查器将其更改为“保存”按钮。

最后，让我们添加“取消”按钮。从对象库中拖动另一个“条形按钮项”，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为“取消”按钮，就像你之前做的“保存”按钮一样。你的视图控制器应当和图 9-21 中所示的一样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新的按钮效果！

点击生日表格视图控制器上的+按钮，应将你带到添加生日视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前不会有任何反应——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你通过创建生日和添加生日屏幕的基本用户界面，开始制作一个 BirthdayTracker 应用。你还创建了一个使用表格视图控制器的生日屏幕，并让用户可以通过添加按钮和导航控制器在不同的屏幕之间导航。

现在你已经有了应用的基本框架，接下来你将在第十章中编程实现取消和保存按钮的功能，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用，这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

*图 9-19：文本字段和日期选择器完美适配 iPhone 7 屏幕。*

![图片](img/Image00218.jpg)

在 iPhone 7 上看起来很棒，但其他设备呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，并再次运行应用。你会看到界面显示得不太对。

所有你添加到故事板中的元素都会出现，但文本字段超出了屏幕的边缘。现在你已经把所有元素放到了屏幕上，接下来的步骤是让它们在任何屏幕尺寸上都能正确显示。我们将通过一种叫做*自动布局*的工具来实现。

#### 通过自动布局让你的应用在每个设备上看起来完美

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能会推出更多尺寸。你需要设计你的应用程序，确保它在任何设备上都能显示良好。这意味着你需要让你的应用调整所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的方式来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的概览视图中选择**视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来调出自动布局菜单。*

在屏幕的故事板面板底部有一个带有图标的带状工具栏，靠近实用工具面板的最右侧图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，写着“解决自动布局问题”。点击该图标，弹出建议菜单。点击**添加缺失的约束**。^(*) 做这一步时，您会看到一堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的大小适应屏幕宽度，并且不会超出边界。自动布局还会确保每个文本字段前后都有 20 个点，从而确保它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，添加生日的屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。按钮目前不会执行任何操作，我们只是先将它们设置好。在第十章中，我们将添加代码，使这些按钮能够退出“添加生日”屏幕并将生日保存到应用中。

要添加保存按钮，请从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们之前做的添加按钮一样。选择按钮项，然后使用属性检查器将其转变为保存按钮。

最后，我们来添加取消按钮。从对象库中再拖动一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其转变为取消按钮，就像之前对保存按钮做的一样。您的视图控制器应该看起来像图 9-21 所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行您的应用，查看新添加的按钮！

点击“生日”表视图控制器上的+按钮，应该会将您带到“添加生日”视图控制器，您可以在这里输入一个人的名字和出生日期。点击取消和保存按钮目前没有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，您通过创建“生日”和“添加生日”屏幕的基本用户界面开始制作生日跟踪应用。您还使用表视图控制器创建了“生日”屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间切换。

现在，您已经完成了应用的基本骨架，接下来在第十章中，您将编程实现取消和保存按钮，以便在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失的约束”选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。![图片](img/Image00218.jpg)

在 iPhone 7 上看起来很不错，但其他设备呢？选择一个较小的模拟器来运行应用，比如 iPhone 5s，然后再次运行应用。你会看到，界面显示得并不完全正确。

所有你添加到故事板上的元素都显示出来了，但文本框的内容超出了屏幕边缘。现在，所有元素都已经放置在屏幕上，接下来的步骤是确保它们在任何屏幕尺寸下都能正确适应。我们将使用一个叫做*自动布局*的工具来实现这一点。

#### 通过自动布局让你的应用在每个设备上都完美呈现

iPhone 本身就有三种不同的屏幕尺寸，并且未来可能还会推出更多尺寸。你需要设计你的应用程序，确保它在任何设备上都能显示得很好。这意味着你需要让你的应用程序调整应用内所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做*布局约束*的方式来排列屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（参见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标来调出自动布局菜单。*

在屏幕故事板面板的底部，有一个带图标的带状工具栏，位于“实用工具”面板之前最右侧的图标是两个竖直线之间的三角形。将鼠标悬停在该图标上时，应该会显示“解决自动布局问题”的标签。点击该图标，调出建议菜单。点击**添加缺失的约束**。^(*) 当你这么做时，你会看到许多布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小都正确，以适应屏幕。例如，自动布局会确保日期选择器的大小适应屏幕的宽度，并且不会超出屏幕边缘。自动布局还会确保每个文本框的前后各有 20 个点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，“添加生日”屏幕应该完美显示。

#### 添加保存和取消按钮

最后，我们将展示如何为“添加生日”视图控制器的导航栏创建“取消”和“保存”按钮。此时按钮还没有任何功能，我们只是简单地设置它们。在第十章中，我们将添加一些代码，使它们能够取消“添加生日”界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们对添加按钮所做的一样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中再拖动一个条形按钮项，这次将它放在导航栏的*左侧*。使用属性检查器将其更改为取消按钮，就像你对保存按钮所做的那样。你的视图控制器应该像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新添加的按钮！

点击生日表视图控制器上的 + 按钮，应该会带你进入添加生日视图控制器，在那里你可以输入某个人的姓名和出生日期。点击取消和保存按钮目前什么也不会发生——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个生日追踪应用，通过创建生日和添加生日屏幕的基本用户界面。你还使用表视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间切换。

现在你已经完成了应用程序的基本框架，接下来你将在第十章中编写取消和保存按钮的代码，以便你可以在应用中添加和保存生日信息！

* 在某些版本的 Xcode 中，“添加缺失约束”选项是禁用的。这是一个 Apple 的 bug。在这种情况下，选择“**重置为缺失约束**”选项来添加缺失的约束。

在 iPhone 7 上看起来很好，但其他设备怎么样呢？选择一个较小的模拟器来运行应用，例如 iPhone 5s，再次运行应用。你会发现有些地方显示不正确。

你添加到故事板中的所有元素都显示出来了，但文本框超出了屏幕的边缘。现在你已经将所有元素添加到屏幕上，下一步是确保它们能在任何屏幕尺寸下正确显示。我们将通过一个叫做*自动布局*的工具来完成这个任务。

#### 让你的应用在每个设备上都完美显示，通过自动布局

iPhone 单独提供三种不同的屏幕尺寸，未来可能会推出更多尺寸。你需要设计你的应用程序，使其在任何设备上看起来都很好。这意味着你需要让你的应用根据设备的不同调整所有元素的位置和大小。自动布局使用一种叫做*布局约束*的方式来放置屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择**视图控制器**。接下来，看看编辑面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标，调出自动布局菜单。*

在屏幕故事板面板的底部，有一个包含图标的带状栏，最右侧的图标是两个竖直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，说明是“解决自动布局问题”。点击此图标以调出建议菜单。点击**添加缺失的约束**。^(*) 当你这样做时，你会看到一大堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，能够适应屏幕。例如，自动布局使得日期选择器的大小适应屏幕宽度，不会超出边界。自动布局还会确保每个文本字段前后有 20 个点的间距，使它们在屏幕上居中对齐。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”界面应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成任务，我们将向你展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。按钮目前不会做任何事情，我们只是先设置它们。在第十章中，我们将添加一些代码，使得它们能够退出“添加生日”界面并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个 Bar Button Item 并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们做添加按钮时一样。选择按钮项，然后使用属性检查器将其转化为保存按钮。

最后，我们来添加取消按钮。从对象库中拖动另一个 Bar Button Item，这次将其放置在导航栏的*左侧*。使用属性检查器将其转化为取消按钮，就像你做保存按钮时一样。你的视图控制器应该像图 9-21 中显示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新按钮！

点击生日表格视图控制器上的+按钮应该会进入“添加生日”视图控制器，在那里你可以输入某人的名字和生日。点击取消和保存按钮目前不会有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用，通过创建 Birthdays 和 Add a Birthday 屏幕的基本用户界面。你还通过使用表视图控制器创建了 Birthdays 屏幕，并使用户能够通过“添加”按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本框架，接下来将在第十章编写代码实现取消和保存按钮，这样你就可以在应用中添加和保存生日信息了！

* 在某些版本的 Xcode 中，添加缺失约束选项是禁用的。这是 Apple 的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

所有你添加到故事板中的元素都已经显示出来，但文本字段超出了屏幕边缘。现在你已经将所有元素放在屏幕上，下一步是确保它们在任何屏幕尺寸上都能正确显示。我们将使用一个叫做*自动布局*的工具来完成这项工作。

#### 让你的应用在每个设备上都完美显示，使用自动布局

iPhone 单独就有三种不同的屏幕尺寸，未来可能会有更多尺寸的设备。你需要设计应用程序，以便它们在任何设备上都能良好显示。这意味着你需要让你的应用能够根据设备的不同调整应用中所有元素的位置和大小。自动布局使用一种叫做*布局约束*的东西来定位屏幕上的元素。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（参见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕的故事板面板底部，有一个带有图标的工具条，位于实用工具面板之前最右边的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，显示为“解决自动布局问题”。点击此图标，打开建议菜单。点击**添加缺失的约束**。^(*) 完成后，你会看到添加生日场景的布局约束已添加一大堆。

这些自动布局约束确保每个元素的大小正确，适合屏幕。例如，自动布局会调整日期选择器的大小，使其适应屏幕宽度，并且不会超出屏幕边缘。自动布局还会确保每个文本字段前后有 20 个点的间距，从而使它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器上重新运行应用程序。这一次，添加生日的界面应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮目前不会有任何功能。我们只是将它们设置好。在第十章中，我们会添加一些代码，使它们能退出添加生日界面并保存生日到应用程序中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像我们之前做的添加按钮一样。选择按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中再拖动一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其转换为取消按钮，就像你做保存按钮时一样。你的视图控制器应该与图 9-21 所示的类似。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新按钮的效果！

在“生日”表格视图控制器上点击 + 按钮，应该会带你进入“添加生日”视图控制器，在那里你可以输入人的名字和出生日期。点击取消和保存按钮目前还没有任何反应——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你开始制作一个生日追踪应用，通过创建生日和添加生日屏幕的基本用户界面。你还使用表格视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本框架，接下来将花时间在第十章中编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日了！

* 在某些版本的 Xcode 中，添加缺失约束选项是禁用的。这是苹果的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

#### 让你的应用在每个设备上都完美显示，使用自动布局

iPhone 本身就有三种不同的屏幕尺寸，而且未来可能会有更多的尺寸。你需要设计应用程序，使其在任何设备上都能显示得很漂亮。这意味着，你的应用程序需要调整所有元素的位置和大小，以适应正在运行应用程序的设备。自动布局使用一种叫做*布局约束*的东西来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部第四个图标打开自动布局菜单。*

在屏幕的故事板面板底部，有一条包含图标的带状工具条，位于实用工具面板之前最右侧的图标是一个位于两条竖直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击这个图标，会弹出一个建议菜单。点击**添加缺失的约束**。^(*) 完成此操作后，你将看到一大堆布局约束被添加到添加生日的场景中。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局确保日期选择器的宽度适配屏幕宽度，不会超出边缘。自动布局还会确保每个文本框前后有 20 个点的间距，以便它们在屏幕上居中显示。

现在在 iPhone 5s 模拟器中再次运行应用。这一次，添加生日的屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成操作，我们将向你展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。这些按钮目前什么都不做——我们只会设置它们。在第十章中，我们将添加一些代码，使它们能够取消添加生日界面并保存生日信息。

要添加保存按钮，从对象库中拖动一个条形按钮项并将其放置在导航栏的*右侧*。我们将把这个按钮改成一个保存按钮，就像我们之前为添加按钮所做的那样。选择按钮项，然后使用属性检查器将其更改为保存按钮。

最后，让我们添加取消按钮。从对象库中再拖动一个条形按钮项，这次将其放置在导航栏的*左侧*。使用属性检查器将其更改为取消按钮，就像你之前为保存按钮所做的那样。你的视图控制器应当像图 9-21 所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新增的按钮！

点击生日表格视图控制器中的+按钮，应该会进入添加生日的视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前没有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你通过为生日和添加生日屏幕创建基本用户界面，开始制作一个 BirthdayTracker 应用。你还使用表格视图控制器创建了生日屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间切换。

现在你已经完成了应用的基本框架，接下来你将在第十章中编写代码，使取消和保存按钮能够在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失的约束”选项被禁用。这是一个苹果的 bug。在这种情况下，选择 **重置为缺失的约束** 来添加缺失的约束。

仅 iPhone 就有三种不同的屏幕尺寸，未来可能会有更多尺寸出现。你需要设计你的应用，使它在任何设备上都看起来不错。这意味着你需要让应用自动调整屏幕上所有元素的位置和大小，以适应运行应用的设备。自动布局使用一种叫做 *布局约束* 的方式来将元素放置在屏幕上。你需要在故事板中添加这些约束。

首先，在左侧面板的大纲视图中选择 **视图控制器**。接下来，查看编辑器面板右下角的四个图标（见图 9-20）。

![图片](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，通过点击编辑器底部的第四个图标，调出自动布局菜单。*

在屏幕的故事板面板底部，有一条带图标的带状条，位于工具面板前的最右侧图标是一个位于两条竖线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，显示“解决自动布局问题”。点击此图标以调出建议菜单。点击 **添加缺失的约束**。^(*) 当你这样做时，你会看到许多布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕的宽度，不会超出屏幕边缘。自动布局还确保每个文本字段前后都有 20 点的间距，使它们在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成最后的步骤，我们将展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。按钮暂时不会执行任何操作，我们只是进行设置。在第十章中，我们将添加代码，使它们能够取消“添加生日”屏幕并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项并将其放置在导航栏的 *右侧*。我们将把这个按钮变成保存按钮，就像我们做的添加按钮一样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将它放置在导航栏的*左侧*。使用属性检查器将其转变为取消按钮，就像你做保存按钮时一样。你的视图控制器应该像图 9-21 中所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在重新运行你的应用程序，查看新按钮的效果！

点击“生日”表视图控制器上的+按钮，应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前还没有任何作用——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用程序，创建了“生日”和“添加生日”屏幕的基本用户界面。你还使用表视图控制器创建了“生日”屏幕，并让用户可以通过添加按钮和导航控制器在不同屏幕之间切换。

现在你已经有了应用程序的基本框架，在第十章中，你将编写取消和保存按钮的代码，以便在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失的约束”选项可能被禁用。这是 Apple 的一个错误。在这种情况下，选择**重置为缺失的约束**选项来添加缺失的约束。

首先，在左侧面板的轮廓视图中选择**视图控制器**。接下来，看看编辑器面板右下角的四个图标（参见图 9-20）。

![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，请点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕的故事板面板底部，有一个带有图标的带状工具栏，位于“工具”面板之前的最右侧图标是两个垂直线之间的三角形。将鼠标光标悬停在该图标上，它应该会显示一个标签，写着“解决自动布局问题”。点击该图标，弹出一个建议菜单。点击**添加缺失的约束**。^(*)这样，你会看到大量的布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保了每个元素的大小正确，适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕的宽度，不会超出屏幕边缘。自动布局还会确保每个文本字段前后都有 20 个点的间距，使它们在屏幕上居中对齐。

现在再次在 iPhone 5s 模拟器上运行应用程序。这时，“添加生日”屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。这些按钮暂时没有任何功能，我们只是将它们设置好。在第十章中，我们将添加一些代码，使它们能够退出添加生日屏幕并保存生日到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项并将其放置在导航栏的*右侧*。我们将把这个按钮变成一个保存按钮，就像我们为添加按钮所做的那样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，并将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应如图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新的按钮！

在生日表视图控制器上点击+按钮应该会带你进入添加生日视图控制器，你可以在其中输入一个人的姓名和出生日期。点击取消和保存按钮目前没有任何效果——我们将在第十章中实现这两个功能！

### 你学到了什么

在本章中，你通过创建生日和添加生日屏幕的基本用户界面开始制作生日跟踪器应用程序。你还使用表视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间切换。

现在你已经完成了应用程序的基本框架，接下来你将在第十章中编程实现取消和保存按钮，以便你可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束的选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。![Image](img/Image00219.jpg)

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标，调出自动布局菜单。*

在屏幕的故事板面板底部，有一个带有图标的条带，最右侧的图标是两个垂直线之间的三角形。在该图标上悬停，应该会显示一个标签，上面写着“解决自动布局问题”。点击该图标，调出建议菜单。点击**添加缺失约束**。^(*) 当你这样做时，你会看到为“添加生日”场景添加了很多布局约束。

这些自动布局约束确保每个元素的大小适合屏幕。例如，自动布局会确保日期选择器的宽度适应屏幕，并且不会超出边界。自动布局还会确保每个文本框前后各有 20 个点的间距，以便它们能在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这一次，"添加生日" 屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成任务，我们将向你展示如何为 "添加生日" 视图控制器的导航栏制作 "取消" 和 "保存" 按钮。这些按钮目前还不会执行任何操作。我们只是先设置它们。在 第十章 中，我们将添加一些代码，使它们能够取消操作并保存生日到应用中。

要添加 "保存" 按钮，从对象库中拖动一个 "Bar Button Item"，并将其放置在导航栏的 *右侧*。我们将把这个按钮设置为 "保存" 按钮，就像我们之前设置 "添加" 按钮一样。选择该按钮项，然后使用属性检查器将其设置为 "保存" 按钮。

最后，让我们添加 "取消" 按钮。从对象库中拖动另一个 "Bar Button Item"，这次将其放置在导航栏的 *左侧*。使用属性检查器将其设置为 "取消" 按钮，就像你设置 "保存" 按钮一样。你的视图控制器应该像 图 9-21 中显示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新的按钮效果！

点击 "生日" 表格视图控制器上的 + 按钮应该会带你进入 "添加生日" 视图控制器，你可以在这里输入一个人的姓名和出生日期。点击 "取消" 和 "保存" 按钮目前不会执行任何操作——我们将在 第十章 中实现这两个按钮！

### 你学到了什么

在这一章中，你开始创建一个 "BirthdayTracker" 应用，通过为 "生日" 和 "添加生日" 屏幕创建基本的用户界面。你还使用表格视图控制器创建了 "生日" 屏幕，并使用户能够通过 "添加" 按钮和导航控制器在屏幕之间进行导航。

现在，你已经完成了应用的基本框架，在 第十章 中，你将编写取消和保存按钮的代码，以便在应用中添加和保存生日！

* 在某些版本的 Xcode 中，"添加缺失约束" 选项是禁用的。这是 Apple 的一个 bug。在这种情况下，选择 **重置为缺失约束** 选项来添加缺失的约束。

*图 9-20：要添加自动布局约束，点击编辑器底部的第四个图标，打开自动布局菜单。*

在屏幕的故事板面板底部有一个包含图标的带状工具条，最右侧的图标是两个垂直线之间的一个三角形。将鼠标悬停在该图标上时，会显示一个标签，上面写着“解决自动布局问题”。点击该图标，会弹出一个建议菜单。点击**添加缺失约束**。^(*)。这样，你会看到一大堆布局约束已被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局使日期选择器的宽度适配屏幕，避免超出边缘。自动布局还确保每个文本字段前后有 20 个点的间距，从而使它们在屏幕上居中显示。

现在，再次在 iPhone 5s 模拟器上运行应用。这次，“添加生日”界面应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成这一部分，我们将向你展示如何为“添加生日”视图控制器的导航栏添加取消和保存按钮。这些按钮暂时不会执行任何操作，我们只是设置它们。在第十章，我们将添加代码，使它们能够取消退出添加生日界面并将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个条形按钮项，并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们之前做的添加按钮一样。选择按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个条形按钮项，并将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你为保存按钮所做的那样。你的视图控制器应该像图 9-21 所示的那样。

![Image](img/Image00220.jpg)

*图 9-21：输入视图控制器，带有取消和保存按钮*

现在再次运行你的应用，查看新按钮的效果！

点击生日表视图控制器上的+按钮应该会带你进入“添加生日”视图控制器，在那里你可以输入一个人的名字和生日日期。此时点击取消和保存按钮不会有任何反应——我们将在第十章中实现这两个按钮的功能！

### 你学到的内容

在本章中，你通过为生日和添加生日界面创建基本的用户界面，开始制作一个生日追踪器应用。你还使用表视图控制器创建了生日界面，并使用户能够通过添加按钮和导航控制器在不同界面之间进行导航。

现在你已经有了应用的基本框架，接下来你将在第十章中编写代码，实现取消和保存按钮的功能，这样你就可以在应用中添加并保存生日了！

* 在某些版本的 Xcode 中，"添加缺失的约束" 选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **重置为缺失约束** 选项以添加缺失的约束。

屏幕故事板面板的底部有一个带图标的带状栏，在“工具”面板之前最右边的图标是一个位于两条垂直线之间的三角形。将鼠标光标悬停在该图标上，应该会显示一个标签，上面写着“解决自动布局问题”。点击该图标以显示一组建议的菜单。点击 **添加缺失的约束**。^(*) 当你这样做时，你会看到一堆布局约束被添加到“添加生日”场景中。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适配屏幕，并且不会超出边界。自动布局还会确保每个文本字段前后有 20 个点的间距，这样它们可以在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用程序。这次，添加生日屏幕应该看起来完美无缺。

#### 添加保存和取消按钮

最后，我们将向你展示如何为添加生日视图控制器的导航栏创建取消和保存按钮。这些按钮目前不会执行任何操作。我们只是设置它们。在第十章中，我们将添加一些代码，使它们能够取消添加生日屏幕并保存生日信息到应用程序中。

要添加保存按钮，从对象库中拖动一个“条形按钮项”并将其放置在导航栏的 *右侧*。我们将把这个按钮改为保存按钮，就像我们对添加按钮所做的那样。选择按钮项，然后使用属性检查器将其转变为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“条形按钮项”，这次将其放置在导航栏的 *左侧*。使用属性检查器将其转变为取消按钮，就像你对保存按钮所做的那样。你的视图控制器应该看起来像图 9-21 中显示的那样。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新的按钮！

在“生日”表视图控制器上点击 + 按钮应该会带你进入添加生日视图控制器，在这里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前不会有任何反应——我们将在第十章中实现这两个按钮！

### 你学到了什么

在本章中，你开始通过创建生日和添加生日界面的基本用户界面来制作一个 BirthdayTracker 应用。你还通过使用表格视图控制器创建了生日界面，并使用户能够通过添加按钮和导航控制器在屏幕之间导航。

现在你的应用已经有了基本的框架，你将在第十章中编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日信息！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用，这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**来添加缺失的约束。

这些自动布局约束确保每个元素的大小正确，以适应屏幕。例如，自动布局确保日期选择器的宽度适应屏幕，并且不会超出屏幕边缘。自动布局还会确保每个文本字段前后有 20 点的间距，这样它们就能在屏幕上居中显示。

现在再次在 iPhone 5s 模拟器上运行应用。这次，添加生日界面应该看起来很完美。

#### 添加保存和取消按钮

最后，我们将向你展示如何为添加生日视图控制器的导航栏制作取消和保存按钮。现在按钮还没有任何功能，我们只是设置它们。在第十章中，我们将添加一些代码，使它们可以取消添加生日界面并保存生日信息。

要添加保存按钮，从对象库中拖动一个 Bar Button Item，并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像我们对添加按钮所做的那样。选择该按钮项，然后使用属性检查器将其转换为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个 Bar Button Item，并将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，和保存按钮的操作一样。你的视图控制器应当如图 9-21 所示。

![Image](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用，看看新增的按钮！

点击生日表格视图控制器上的+按钮应该会带你到添加生日视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前没有任何效果——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用，通过创建基本的用户界面来实现“生日”和“添加生日”页面。你还使用表格视图控制器创建了“生日”页面，并使用户能够通过“添加”按钮和导航控制器在不同页面之间切换。

现在，应用的基本框架已经完成，你将在第十章编程实现取消和保存按钮，以便你能够在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项是禁用的。这是苹果的一个 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

现在再次在 iPhone 5s 模拟器上运行应用。这次，“添加生日”页面应该看起来完美无缺。

#### 添加保存和取消按钮

为了完成，我们将向你展示如何为“添加生日”视图控制器的导航栏制作取消和保存按钮。这些按钮目前还不会做任何事情，我们只会设置它们。在第十章中，我们将添加一些代码，使按钮能够取消并退出“添加生日”页面，或将生日保存到应用中。

要添加保存按钮，从对象库中拖动一个 Bar Button Item，并将它放置在导航栏的*右侧*。我们将把这个按钮变成一个保存按钮，就像我们做的“添加”按钮一样。选择该按钮项，然后使用属性检查器将其变成保存按钮。

最后，让我们添加取消按钮。从对象库中再拖动一个 Bar Button Item，这次将它放置在导航栏的*左侧*。使用属性检查器将其变成取消按钮，就像你做保存按钮一样。你的视图控制器应该看起来像图 9-21 中所示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行应用，看看新按钮的效果！

在“生日”表格视图控制器上点击+按钮应该会让你进入“添加生日”视图控制器，你可以在其中输入一个人的姓名和出生日期。点击取消和保存按钮目前不会做任何事情——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用，通过创建基本的用户界面来实现“生日”和“添加生日”页面。你还使用表格视图控制器创建了“生日”页面，并使用户能够通过“添加”按钮和导航控制器在不同页面之间切换。

现在，应用的基本框架已经完成，你将在第十章编程实现取消和保存按钮，以便你能够在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失的约束”选项是禁用的。这是一个苹果的 bug。在这种情况下，选择**重置为缺失的约束**选项来添加缺失的约束。

#### 添加保存和取消按钮

为了完成，我们将向你展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。这些按钮暂时不会做任何事情，我们只是设置它们。在第十章 中，我们将添加一些代码，让它们退出“添加生日”屏幕并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”，并将其放置在导航栏的*右侧*。我们将把这个按钮改成保存按钮，就像之前做的添加按钮一样。选择按钮项，然后使用属性检查器将其改为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左侧*。使用属性检查器将其改为取消按钮，就像你做的保存按钮一样。你的视图控制器应该像图 9-21 中显示的那样。

![图片](img/Image00220.jpg)

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，看看新的按钮！

在“生日”表视图控制器上点击 + 按钮应该会带你到“添加生日”视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮暂时没有任何反应——我们将在第十章 中实现这两个按钮！

### 你学到了什么

在本章中，你通过创建“生日”和“添加生日”界面的基本用户界面，开始制作一个 BirthdayTracker 应用程序。你还使用表格视图控制器创建了“生日”屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经有了应用程序的基本框架，在第十章 中，你将编写取消和保存按钮的代码，这样你就可以在应用程序中添加和保存生日了！

* 在某些版本的 Xcode 中，“添加缺失的约束”选项是禁用的。这是一个苹果的 bug。在这种情况下，选择**重置为缺失的约束**选项来添加缺失的约束。

为了完成，我们将向你展示如何为“添加生日”视图控制器的导航栏创建取消和保存按钮。这些按钮暂时不会做任何事情，我们只是设置它们。在第十章 中，我们将添加一些代码，让它们退出“添加生日”屏幕并将生日保存到应用程序中。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像之前对添加按钮的处理一样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，方法与设置保存按钮相同。您的视图控制器应该看起来像图 9-21 中所示的样子。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在重新运行您的应用以查看新按钮！

点击“生日”表视图控制器中的+按钮应该会带您进入“添加生日”视图控制器，在那里您可以输入一个人的姓名和出生日期。点击取消和保存按钮目前还没有任何效果——我们将在第十章中实现这两个按钮的功能！

### 您学到了什么

在本章中，您通过创建生日和添加生日屏幕的基本用户界面开始制作 BirthdayTracker 应用。您还使用表视图控制器创建了生日屏幕，并使用户能够通过添加按钮和导航控制器在屏幕之间进行导航。

现在您已经完成了应用的基本框架，接下来将在第十章中编写代码实现取消和保存按钮，以便您可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项是禁用的。这是一个 Apple 的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

要添加保存按钮，从对象库中拖动一个“Bar Button Item”并将其放置在导航栏的*右侧*。我们将把这个按钮改为保存按钮，就像之前对添加按钮的处理一样。选择该按钮项，然后使用属性检查器将其设置为保存按钮。

最后，让我们添加取消按钮。从对象库中拖动另一个“Bar Button Item”，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，方法与设置保存按钮相同。您的视图控制器应该看起来像图 9-21 中所示的样子。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在重新运行您的应用以查看新按钮！

点击“生日”表视图控制器中的+按钮应该会带您进入“添加生日”视图控制器，在那里您可以输入一个人的姓名和出生日期。点击取消和保存按钮目前还没有任何效果——我们将在第十章中实现这两个按钮的功能！

### 您学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用，通过创建生日和添加生日屏幕的基本用户界面。你还使用表视图控制器创建了生日屏幕，并使得用户能够通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本框架，在第十章中你将编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个苹果的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。

最后，让我们添加取消按钮。从对象库中拖动另一个“条形按钮项”，这次将其放置在导航栏的*左侧*。使用属性检查器将其设置为取消按钮，就像你设置保存按钮一样。你的视图控制器应该像图 9-21 中显示的那样。

![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新的按钮！

点击生日表视图控制器上的+按钮应该会将你带到“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前没有任何反应——我们将在第十章实现这两个按钮！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用，通过创建生日和添加生日屏幕的基本用户界面。你还使用表视图控制器创建了生日屏幕，并使得用户能够通过添加按钮和导航控制器在屏幕之间进行导航。

现在你已经完成了应用的基本框架，在第十章中你将编写取消和保存按钮的代码，这样你就可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，“添加缺失约束”选项被禁用。这是一个苹果的 bug。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。![图片](img/Image00220.jpg)

*图 9-21：带有取消和保存按钮的输入视图控制器*

现在再次运行你的应用程序，查看新的按钮！

点击生日表视图控制器上的+按钮应该会将你带到“添加生日”视图控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮目前没有任何反应——我们将在第十章实现这两个按钮！

### 你学到了什么

在这一章中，你开始制作一个 BirthdayTracker 应用，通过创建生日和添加生日屏幕的基本用户界面。你还使用表格视图控制器创建了生日屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本框架，接下来将在第十章中编程实现取消和保存按钮，这样你就可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **重置缺失约束** 选项来添加缺失的约束。

*图 9-21：包含取消和保存按钮的输入视图控制器*

现在再次运行你的应用，查看新的按钮！

点击生日表视图控制器上的 + 按钮应该会将你带到“添加生日”视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前不会做任何操作——我们将在第十章中实现这两个功能！

### 你学到了什么

在这一章中，你开始制作一个 BirthdayTracker 应用，通过创建生日和添加生日屏幕的基本用户界面。你还使用表格视图控制器创建了生日屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本框架，接下来将在第十章中编程实现取消和保存按钮，这样你就可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **重置缺失约束** 选项来添加缺失的约束。

现在再次运行你的应用，查看新的按钮！

点击生日表视图控制器上的 + 按钮应该会将你带到“添加生日”视图控制器，在那里你可以输入一个人的名字和出生日期。点击取消和保存按钮目前不会做任何操作——我们将在第十章中实现这两个功能！

### 你学到了什么

在这一章中，你开始制作一个 BirthdayTracker 应用，通过创建生日和添加生日屏幕的基本用户界面。你还使用表格视图控制器创建了生日屏幕，并使用户可以通过添加按钮和导航控制器在屏幕之间导航。

现在你已经完成了应用的基本框架，接下来将在第十章中编程实现取消和保存按钮，这样你就可以在应用中添加和保存生日！

* 在某些版本的 Xcode 中，添加缺失约束选项被禁用。这是一个 Apple 的 bug。在这种情况下，选择 **重置缺失约束** 选项来添加缺失的约束。

点击生日表格视图控制器上的+按钮，应该会带你进入添加生日页面控制器，在那里你可以输入一个人的姓名和出生日期。点击取消和保存按钮暂时没有任何作用——我们将在第十章中实现这两个按钮的功能！

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用程序，通过创建生日页面和添加生日页面的基本用户界面。你还使用表格视图控制器创建了生日页面，并使得用户能够通过添加按钮和导航控制器在页面间进行切换。

现在你已经完成了应用程序的基本框架，在第十章中，你将编写取消和保存按钮的代码，这样你就可以在应用程序中添加和保存生日了！

* 在某些版本的 Xcode 中，"添加缺失约束"选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择“重置为缺失约束”选项来添加缺失的约束。

### 你学到了什么

在本章中，你开始制作一个 BirthdayTracker 应用程序，通过创建生日页面和添加生日页面的基本用户界面。你还使用表格视图控制器创建了生日页面，并使得用户能够通过添加按钮和导航控制器在页面间进行切换。

现在你已经完成了应用程序的基本框架，在第十章中，你将编写取消和保存按钮的代码，这样你就可以在应用程序中添加和保存生日了！

* 在某些版本的 Xcode 中，"添加缺失约束"选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择“重置为缺失约束”选项来添加缺失的约束。

在本章中，你开始制作一个 BirthdayTracker 应用程序，通过创建生日页面和添加生日页面的基本用户界面。你还使用表格视图控制器创建了生日页面，并使得用户能够通过添加按钮和导航控制器在页面间进行切换。

现在你已经完成了应用程序的基本框架，在第十章中，你将编写取消和保存按钮的代码，这样你就可以在应用程序中添加和保存生日了！

* 在某些版本的 Xcode 中，"添加缺失约束"选项被禁用。这是 Apple 的一个 bug。在这种情况下，选择“重置为缺失约束”选项来添加缺失的约束。

现在你已经完成了应用程序的基本框架，在第十章中，你将编写取消和保存按钮的代码，这样你就可以在应用程序中添加和保存生日了！

* 在某些版本的 Xcode 中，"添加缺失约束"选项被禁用。这是一个 Apple 的错误。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。* 在某些版本的 Xcode 中，"添加缺失约束"选项被禁用。这是一个 Apple 的错误。在这种情况下，选择**重置为缺失约束**选项来添加缺失的约束。
