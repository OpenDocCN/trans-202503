## 前言

![image](img/common01.jpg)

我写这本书，是为了成为我在学习密码学时希望拥有的书籍。2005 年，我在巴黎附近攻读硕士学位，我迫不及待地注册了下学期的密码学课程。不幸的是，由于报名人数太少，课程被取消了。学生们争论道：“加密太难了”，于是他们纷纷转而报读计算机图形学和数据库课程。

从那时起，我听到“加密很难”已经不下十几次了。但是，密码学真的*那么*难吗？要学会演奏乐器、精通一门编程语言，或将任何迷人的领域的应用付诸实践，你需要学习一些概念和符号，但做到这一点并不需要博士学位。我认为，成为一名称职的密码学家也是如此。我还认为，密码学之所以被认为难，是因为密码学家在教学方面做得不好。

我感到需要写这本书的另一个原因是，密码学不再只是关于加密——它已经扩展成为一个跨学科的领域。要在密码学中做一些有用且相关的事情，你需要对围绕密码学的概念有所了解：网络和计算机是如何工作的，用户和系统需要什么，以及攻击者如何滥用算法及其实现。换句话说，你需要与现实建立联系。

### 本书的方法论

本书的初衷标题是 *现实中的密码学*，旨在强调我所追求的以实践为导向、面向现实的、毫不做作的方式。我并不想通过简化密码学来让它变得容易理解，而是将其与实际应用结合起来。我提供了源代码示例，并描述了真实的漏洞和令人恐惧的故事。

本书的其他基石是其与现实的紧密联系、简洁性和现代性。我更多关注形式上的简洁，而非内容上的简化：我呈现了许多非琐碎的概念，但没有沉闷的数学形式化。我尝试传达的是密码学的核心思想，这些思想比记住一堆公式更为重要。为了确保本书的现代性，我涵盖了密码学的最新发展和应用，如 TLS 1.3 和后量子密码学。我没有讨论过时或不安全的算法，如 DES 或 MD5。唯一的例外是 RC4，但它的包含仅是为了说明它有多么脆弱，并展示这种类型的流密码是如何工作的。

*严谨的密码学* 不是一本关于密码软件的指南，也不是一本技术规范汇编——这些内容你可以轻松在线找到。相反，本书的首要目标是让你对密码学产生兴趣，并在过程中教授其基本概念。

### 适合阅读本书的人群

在写作时，我经常想象读者是一个接触过加密技术但在尝试阅读晦涩的教科书和研究论文后仍然感到困惑和沮丧的开发者。开发者常常需要——也希望——更好地理解加密技术，以避免不幸的设计选择，我希望这本书能有所帮助。

但是，如果你不是开发者，也不用担心！这本书不需要任何编程技能，任何理解计算机科学基础和大学数学（例如概率论、模算术等概念）的人都可以阅读。

尽管如此，这本书仍然可能让人感到有些望而生畏，尽管它相对容易理解，但要从中获得最大收益还是需要一些努力。我喜欢登山类比：作者为你铺设道路，提供绳索和冰镐来帮助你，但最终的攀登还是得靠你自己。学习本书中的概念需要付出努力，但最终会有回报。

### 本书的结构

本书共有十四章，分为四个部分。各章节之间大多独立，唯一例外是第九章，它为接下来的三章奠定了基础。我还建议在阅读其他内容之前，先阅读前三章。

#### *基础知识*

+   **第一章: 加密**介绍了安全加密的概念，从简单的手写密码到强大的、随机化的加密技术。

+   **第二章: 随机性**描述了伪随机生成器的工作原理，什么样的伪随机生成器是安全的，以及如何安全地使用它。

+   **第三章: 加密安全**讨论了安全的理论和实践概念，并比较了可证明的安全性与概率性安全性。

#### *对称加密*

+   **第四章: 分组密码**讲解了逐块处理信息的密码算法，重点介绍了最著名的高级加密标准（AES）。

+   **第五章: 流密码**介绍了生成一串看似随机的比特流并与要加密的消息进行异或操作的密码算法。

+   **第六章: 哈希函数**讲解了唯一不依赖于密钥的算法，它们实际上是最常见的加密基础构件。

+   **第七章: 密钥哈希**解释了如果将哈希函数与密钥结合，会发生什么情况，以及它是如何用于消息认证的。

+   **第八章: 认证加密**展示了某些算法如何在加密信息的同时验证其真实性，举例包括标准的 AES-GCM 算法。

#### *非对称加密*

+   **第九章: 困难问题**阐述了公钥加密背后的基本概念，运用了计算复杂度的相关概念。

+   **第十章: RSA**利用因式分解问题构建安全的加密和签名方案，所需的只是简单的算术操作。

+   **第十一章：Diffie–Hellman** 扩展了非对称加密到密钥协商的概念，在这一过程中，双方仅使用非秘密值来建立一个秘密值。

+   **第十二章：椭圆曲线** 轻松介绍了椭圆曲线密码学，这是最快的非对称加密方式。

#### *应用*

+   **第十三章：TLS** 聚焦于传输层安全（TLS），这是网络安全中最重要的协议之一。

+   **第十四章：量子与后量子** 以科幻的形式总结，介绍了量子计算和一种新的加密学概念。

### 致谢

我要感谢 Jan、Annie 以及所有参与本书工作的 No Starch 员工，特别是感谢 Bill 从一开始就相信这个项目，感谢他在消化困难话题时的耐心，感谢他将我笨拙的草稿变成了可读的内容。我还要感谢 Laurel 让本书看起来如此漂亮，并处理了我提出的许多修改请求。

在技术方面，如果没有以下几位人士的帮助，这本书将包含更多的错误和不准确之处：Jon Callas、Bill Cox、Niels Ferguson、Philipp Jovanovic、Samuel Neves、David Reid、Phillip Rogaway、Erik Tews，以及所有在早期版本中报告错误的读者。最后，感谢 Matt Green 为本书写的序言。

我还要感谢我的雇主，Kudelski Security，感谢他们给予我时间来撰写本书。最后，我要向 Alexandra 和 Melina 表达我最深的感谢，感谢她们的支持和耐心。

洛桑，2017 年 5 月 17 日（三个质数）
