## 第二部分

自动化日常任务

如果第一部分感觉更像是一个学校练习，而不是实际的内容——那种你可以今天、现在就能做的事情——别担心，你并不孤单！我也有同样的感觉。但你不能总是直接跳进去；有时候在跳入之前先试探一下水温是件好事。这就是第一部分的作用——为那些新接触 PowerShell 的人提供了入门，为那些不陌生的人提供了复习。

在第二部分，你将最终接触到有趣的内容，将你在第一部分学到的知识应用到实际场景中。你将学习如何使用 PowerShell 来自动化一些许多技术专业人员每天都会遇到的常见场景。如果你是一个经验丰富的技术专业人士，你无疑以前遇到过这些场景：昏昏欲睡地在 Active Directory 中点击，花费过多时间在 Excel 表格之间复制粘贴，在你尝试设置某些远程控制软件以便同时连接一打机器时慌乱不已，以便将你上司两天前想要的管理信息发送给他。

在本书的这一部分，你将学习自动化这些任务所需的工具。当然，我无法涵盖所有内容——有太多无聊的任务需要自动化了！接下来是我在 20 年的行业经验中遇到的一些常见场景。如果你遇到的问题没有被覆盖，不用担心！到本书结束时，你将拥有自己解决任务自动化所需的基础知识。

第二部分被分为四个主要主题，涵盖五个章节。

### 处理结构化数据

数据无处不在。如果你以前处理过数据，你就知道它有成千上万种格式：SQL 数据库、XML 文件、JSON 对象、CSV 文件等等。每种类型的数据都有其特定的结构，而每种结构都必须以不同的方式处理。在第十章，你将学习如何读取、写入和修改各种形式的数据。

### 自动化 Active Directory 任务

Active Directory（AD）是一个目录服务。从高层次来看，你可以将*目录服务*看作一种层次化的方式，用来跟踪用户可以访问哪些 IT 资源。AD 是微软版本的目录服务，正如你所想，它被全球成千上万的组织使用，这使得它成为一个非常适合自动化的领域。

第十一章介绍了如何从 PowerShell 控制台管理各种 AD 对象的基本知识。一旦你熟悉了 AD cmdlet，我们将通过一些小项目，帮助你使用各种 AD cmdlet 来自动化你可能会看到的一些最琐碎的任务。

### 控制云端

像如今几乎所有的技术一样，云计算也得到了 PowerShell 的强力支持。理解 PowerShell 在云环境中的工作方式，包括 Microsoft Azure 和 Amazon Web Services（AWS），将开启自动化的新天地。在第十二章和第十三章中，你将创建虚拟机、Web 服务等。你甚至会看到一个使用 PowerShell 同时与两个云服务提供商互动的示例。由于 PowerShell 对使用哪种云计算环境不偏不倚（它是*云中立*的），我们可以控制任何我们想要的云！

### 创建服务器清单脚本

因为本书内容是逐步积累的，你需要在尝试第三部分的技术奇才之前，打好坚实的基础。这正是第十四章的重点，将你在本书中收集的所有知识融合在一起，转化为一个完整的项目。在这里，你将学习如何将来自不同来源的信息整合成一个统一且连贯的报告。这将包括从 AD 查询计算机，并利用 CIM/WMI 对其进行询问，以访问有用的信息，例如名称、RAM、CPU 速度、操作系统、IP 地址等。

### 总结

到本部分结束时，你应该对可以用 PowerShell 自动化的各种日常任务有一个清晰的了解。通过亲自自动化其中几个任务，你会发现根本无需为昂贵的软件或花哨的顾问支付高额费用来管理你的环境。PowerShell 能够与数百种产品和服务互补——只要有意愿（和 PowerShell），就一定有办法。
