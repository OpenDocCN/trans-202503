## 前言

![图片](img/common.jpg)

在我的 IT 职业生涯中，我做过各种不同的工作：我曾在技术支持岗位接听电话，作为技术员拜访用户并告诉他们重启电脑，作为系统管理员维护服务器，作为系统工程师设计和构建解决方案，并作为网络工程师学习 OSPF 和 RIP 路由的区别。

直到我发现 PowerShell，我才意识到我能对某项技术如此热情。PowerShell 在多方面改变了我的生活，它是改变我职业轨迹最深远的技术。这门语言帮助我成为了公司中的关键人才，因为我知道如何为团队节省无数工时，它也为我带来了我的第一个六位数薪资。PowerShell 实在太酷了，以至于我决定要与全世界分享它，从那时起，我连续五年获得了微软 MVP 奖项。

在本书中，我将向你展示如何使用 PowerShell 来自动化成千上万的任务，构建定制工具而不是购买现成的产品，并将各种工具连接在一起。你可能不想成为 PowerShell 社区的活跃成员，但我可以保证，学习 PowerShell 会让你掌握许多企业需要并积极寻求的技能。

### 为什么选择 PowerShell？

曾被称为 *Monad*（参见 *[`www.jsnover.com/Docs/MonadManifesto.pdf`](https://www.jsnover.com/Docs/MonadManifesto.pdf)*)，并在 2003 年作为比 VBScript 更直观的自动化任务方式提出的 Microsoft PowerShell 是一门通用的自动化、脚本和开发语言。PowerShell 的诞生旨在弥合脚本、自动化和运维人员之间的鸿沟。它旨在使用户能够通过脚本自动化任务，而无需学习计算机编程。这使得它特别适用于没有软件开发背景的系统管理员。如果你是一个时间紧张的系统管理员，PowerShell 是你值得拥有的好帮手。

PowerShell 现在已成为一个开源、无处不在、跨平台的脚本和开发语言。你可以使用 PowerShell 不仅来配置完整的服务器集群，还可以创建文本文件或设置注册表项。由于 IT 专业人员、开发者、DevOps 工程师、数据库管理员和系统工程师的广泛使用，成千上万的软件产品和服务现在都支持 PowerShell。

### 本书适用对象

本书面向那些厌倦了在同一个图形界面中重复点击、每年做着同样任务超过 500 次的 IT 专业人员和系统管理员。它同样适用于那些在自动化新服务器环境、进行自动化测试或自动化整个持续集成/持续交付（CI/CD）构建管道中遇到困难的 DevOps 工程师。

没有单一的人群能从 PowerShell 中获得最大的好处。PowerShell 用户的传统工作角色是“Windows 商店”中的微软系统管理员，但 PowerShell 通常适用于任何 IT 运维人员的工具包。如果你从事 IT 工作，并且不认为自己是开发人员，那么这本书适合你。

### 本书简介

在本书中，我将通过实际操作来教学，使用大量示例和真实世界的用例。与其 *告诉* 你什么是变量，我会 *展示* 给你看。如果你正在寻找一本传统的教科书，这本书不适合你。

我不会将 PowerShell 拆分成各个部分并独立介绍每个功能，因为这不是你在现实世界中使用 PowerShell 的方式。例如，我不会期待你知道 *函数* 或 *for 循环* 的书面定义，而是尽可能将功能结合起来，帮助你全面理解眼前的问题以及如何解决它。

本书分为三部分。**第一部分：基础知识** 为 PowerShell 新手提供了他们所需的知识，帮助他们与经验丰富的老手并驾齐驱。如果你已经具备中级或更高级别的 PowerShell 技能，可以跳过 第八章。

**第一章–第七章** 涵盖了 PowerShell 语言本身。你将学习基础知识，包括如何查找帮助和发现新命令，以及一些其他编程语言中常见的编程概念，如变量、对象、函数、模块和错误处理基础。

**第八章** 解释了如何使用 PowerShell 远程连接并在远程计算机上运行命令。

**第九章** 介绍了流行的 PowerShell 测试框架 Pester，你将在本书中使用它。

在 **第二部分：自动化日常任务** 中，你将应用在 第一部分 中学到的知识，开始自动化常见任务。

**第十章–第十三章** 涵盖了如何解析结构化数据以及许多 IT 管理员常用的领域，如 Active Directory、Azure 和亚马逊 Web 服务（AWS）。

**第十四章** 向你展示如何构建一个工具，帮助你在自己的环境中进行服务器清单管理。

在 **第三部分：构建你自己的模块** 中，你将专注于构建一个名为 PowerLab 的单一 PowerShell 模块，以展示 PowerShell 的潜力。我们将涵盖良好的模块设计和函数的最佳实践。即使你认为自己是一个高级 PowerShell 脚本编写者，也一定能从 第三部分 中学到一些东西。

**第十五章–第二十章** 解释了如何使用 PowerShell 自动化整个实验室或测试服务器环境，演示了如何配置 Hyper-V 虚拟机、安装操作系统、以及部署和配置 IIS 和 SQL 服务器。

我希望本书能帮助你入门 PowerShell。如果你是初学者，我希望它能给你勇气开始自动化；如果你是经验丰富的脚本编写者，我希望它能向你展示一些你可能不太熟悉的技巧。

让我们开始编写脚本吧！
