<html><head></head><body>
<div id="sbo-rt-content"><section>
<header>
<h1 class="chapter">
<span class="ChapterNumber"><span epub:type="pagebreak" id="Page_329" title="329"/><a class="XrefDestination" id="16"/><span class="XrefDestination" id="xref-502727c16-001"/>16</span><br/>
<span class="ChapterTitle"><a class="XrefDestination" id="Solvingcipherswithhillclimbing"/><span class="XrefDestination" id="xref-502727c16-002"/>Solving ciphers with hill climbing</span></h1>
</header>
<figure class="graphic">
<img alt="" class="" height="475" src="image_fi/502727c16/g16001.png" width="844"/></figure>
<p class="BodyFirst"><span epub:type="pagebreak" id="Page_330" title="330"/>Many of the encryption methods introduced in this book can be broken with a strategy called <em>hill climbing</em>. Computer scientists developed this technique to solve certain kinds of optimization problems, most of which are not crypto related. It is well suited, for instance, to finding the shortest route that includes certain cities or determining the most efficient configuration of a production facility. The method is named “hill climbing” because it aims to improve a given configuration iteratively, until the “top of the mountain” is reached and no further improvement is possible, as represented in <a href="#figure16-1" id="figureanchor16-1">Figure 16-1</a>.</p>
<figure>
<img alt="" class="" height="334" src="image_fi/502727c16/f16001.png" width="694"/>
<figcaption><p><a id="figure16-1">Figure 16-1</a>: A hill-climbing algorithm takes a random key and checks whether the plaintext obtained with it looks like real language. By making small changes to the key, it tries to improve the result until no better one can be found. The last candidate often is the correct one.</p></figcaption>
</figure>
<p>Hill climbing is especially suited for problems that have too many potential solutions for the cryptanalyst to check every single one. It requires that the problem be “smooth,” which means that a small change in the input may cause only a small change in the output. Most codebreaking tasks used on classical ciphers fulfill both requirements. For these deciphering methods, the number of potential solutions (i.e., the number of keys) is extremely large. For example, there are 403,291,461,126,605,635,584,000,000 (about 400 trillion trillion, or 4 × 10<sup>26</sup>) ways to create a simple substitution table with twenty-six letters—way too many to check every one, even with the best computer. In addition, small changes in the key of many classical encryption methods cause only small changes in the ciphertext. For instance, if we switch two ciphertext symbols in a simple substitution table, the changes in the decryption result are only minor.</p>
<p>Hill climbing is only feasible when implemented as a computer program. Codebreakers have successfully used this method to break a wide range of encryption algorithms, including difficult machine ciphers such as the one used by the Enigma. Today, quite a few computer programs (for instance, CrypTool 2) support hill-climbing algorithms for codebreaking. However, codebreakers must still customize hill climbing for the system they are attacking. For this reason, a variety of hill-climbing implementations are available.</p>
<p><span epub:type="pagebreak" id="Page_331" title="331"/>It is important to note that, while hill climbing is a powerful tool for breaking historically important ciphers, it is not suited at all to attacking modern encryption algorithms such as AES or DES. This is because modern encryption algorithms are not smooth, and a small change in their key or plaintext should cause a major change in the ciphertext.</p>
<h2 id="h1-502727c16-0001"><a class="XrefDestination" id="Solvingsimplesubstitutioncipherswithhillclimbing"/><span class="XrefDestination" id="xref-502727c16-003"/>Solving simple substitution ciphers with hill climbing</h2>
<p class="BodyFirst">In this section, we explain the technique of hill climbing by applying it to a simple substitution ciphertext. As you will see later in this chapter, we can apply the same technique to other ciphers. Take a look at the following cryptogram, a challenge published in Sabine Baring-Gould’s 1896 book <em>Curiosities of Olden Times</em>:<sup class="endnote"><a href="b06.xhtml#c16-endnote-1" id="c16-noteref-1">1</a></sup><sup>, </sup><sup class="endnote"><a href="b06.xhtml#c16-endnote-2" id="c16-noteref-2">2</a></sup></p>
<figure class="graphic">
<img alt="" class="" height="120" src="image_fi/502727c16/g16002.png" width="543"/></figure>
<p>Let’s first translate this cryptogram into a version that is easier for a computer program to process. We replace the symbol that appears first with <code>A</code>, the next one with <code>B</code>, the third one with <code>C</code>, and so on, keeping the word breaks:</p>
<p class="BodyCustom"><code>A BCDE CF GHI HAFE CJ KLDGH GKL CF GHI BMJH</code></p>
<h4 id="h3-502727c16-0001"><a class="XrefDestination" id="Step1"/><span class="XrefDestination" id="xref-502727c16-004"/>Step 1</h4>
<p class="BodyFirst">We start by creating a random substitution table:</p>
<p class="BodyCustom"><code>Plaintext:  </code><code class="bold">ABCDEFGHIJKLMNOPQRSTUVWXYZ</code></p>
<p class="BodyCustom"><code>Ciphertext: SNOIJRGYZLMBPDQWUVHFCTAXEK</code></p>
<h4 id="h3-502727c16-0002"><a class="XrefDestination" id="Step2"/><span class="XrefDestination" id="xref-502727c16-005"/>Step 2</h4>
<p class="BodyFirst">Then, we use the substitution table to decrypt the cryptogram, which gives us the following plaintext candidate:</p>
<p class="BodyCustom"><code>S NOIJ OR GYZ YSRJ OL MBIGY GMB OR GYZ NPLY</code></p>
<h4 id="h3-502727c16-0003"><a class="XrefDestination" id="Step3"/><span class="XrefDestination" id="xref-502727c16-006"/>Step 3</h4>
<p class="BodyFirst">Now, we rate the correctness of the plaintext candidate with a so-called <em>fitness function</em>. Using a fitness function is the most sophisticated and critical part of a hill-climbing attack. There are many ways to check whether a certain text is more or less correct (i.e., whether it looks like real language). In our case, we take a simple approach based on letter frequencies. Advanced codebreakers will easily find better methods.</p>
<p><span epub:type="pagebreak" id="Page_332" title="332"/>For each letter, we determine its frequency in the plaintext candidate and compare it with the distance from that frequency in an average English text of the same length. In our case, the ciphertext has thirty-three characters. Based on the fact that, in the English language, the letter <em>A</em> has a frequency of 8%, <em>B</em> of 1%, and <em>C</em> of 3%, we set the expected frequency of these letters in the plaintext candidate to three, zero, and one. The expected frequencies of the remaining letters are derived in a similar way.</p>
<p>Next, we compare the frequencies in the plaintext candidate with the expected frequencies and determine the distance:</p>
<table border="1" id="tabular-502727c16-0001">
<thead>
<tr>
<td><b>Letter</b></td>
<td><b>Frequency in the plaintext candidate</b></td>
<td><b>Expected frequency</b></td>
<td><b>Distance</b></td>
</tr>
</thead>
<tbody>
<tr>
<td><code>A</code></td>
<td>0</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td><code>B</code></td>
<td>2</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td><code>C</code></td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>D</code></td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>E</code></td>
<td>0</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td><code>F</code></td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>G</code></td>
<td>4</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td><code>H</code></td>
<td>0</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td><code>I</code></td>
<td>2</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<td><code>J</code></td>
<td>2</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td><code>K</code></td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td><code>L</code></td>
<td>2</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>M</code></td>
<td>2</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>N</code></td>
<td>2</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<td><code>O</code></td>
<td>4</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td><code>P</code></td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td><code>Q</code></td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td><code>R</code></td>
<td>3</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td><code>S</code></td>
<td>2</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<td><code>T</code></td>
<td>0</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td><code>U</code></td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>V</code></td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td><code>W</code></td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>X</code></td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td><code>Y</code></td>
<td>5</td>
<td>1</td>
<td>4</td>
</tr>
<tr>
<td><code>Z</code></td>
<td>2</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td class="white" colspan="4"> <p class="right">Sum: 34</p></td>
</tr>
</tbody>
</table>
<p><span epub:type="pagebreak" id="Page_333" title="333"/>The sum of the distances (here, thirty-four) is the result of the fitness function. The lower the result, the better the fit.</p>
<h4 id="h3-502727c16-0004"><a class="XrefDestination" id="Step4"/><span class="XrefDestination" id="xref-502727c16-007"/>Step 4</h4>
<p class="BodyFirst">Next, we slightly randomize the substitution table. In the following, the second line is the old substitution alphabet, while the third line is the new one:</p>
<p class="BodyCustom"><code>Plaintext:      </code><code class="bold">ABCDEFGHIJKLMNOPQRSTUVWXYZ</code></p>
<p class="BodyCustom"><code>Old ciphertext: SNOIJRGYZLMBPDQWUVHFCTAXEK</code></p>
<p class="BodyCustom"><code>New ciphertext: SNOIJFGYZLMBPDQWUVHRCTAXEK</code></p>
<p>As you can see, we have made only a small change, exchanging the positions of <code>F</code> and <code>R</code>.</p>
<h4 id="h3-502727c16-0005"><a class="XrefDestination" id="Step5"/><span class="XrefDestination" id="xref-502727c16-008"/>Step 5</h4>
<p class="BodyFirst">In the next step, we decrypt the ciphertext with the new substitution table and get a new plaintext candidate (the old plaintext is listed for comparison):</p>
<p class="BodyCustom"><code>Old plaintext:</code> <code class="bold">S NOIJ OR GYZ YSRJ OL MBIGY GMB OR GYZ NPLY</code></p>
<p class="BodyCustom"><code>New plaintext:</code> <code class="bold">S NOIJ OF GYZ YSFJ OL MBIGY GMB OF GYZ NPLY</code></p>
<h4 id="h3-502727c16-0006"><a class="XrefDestination" id="Step6"/><span class="XrefDestination" id="xref-502727c16-009"/>Step 6</h4>
<p class="BodyFirst">Again, we rate the correctness of the plaintext candidate with our fitness function:</p>
<table border="1" id="tabular-502727c16-0002">
<thead>
<tr>
<td><b>Letter</b></td>
<td><b>Frequency in the plaintext candidate</b></td>
<td><b>Expected frequency</b></td>
<td><b>Distance</b></td>
</tr>
</thead>
<tbody>
<tr>
<td><code>A</code></td>
<td>0</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td><code>B</code></td>
<td>2</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td><code>C</code></td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>D</code></td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>E</code></td>
<td>0</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td><code>F</code></td>
<td>3</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td><code>G</code></td>
<td>4</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td><code>H</code></td>
<td>0</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td><code>I</code></td>
<td>2</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<td><code>J</code></td>
<td>2</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td><code>K</code></td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td><code>L</code></td>
<td>2</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>M</code></td>
<td>2</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code><span epub:type="pagebreak" id="Page_334" title="334"/>N</code></td>
<td>2</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<td><code>O</code></td>
<td>4</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td><code>P</code></td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td><code>Q</code></td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td><code>R</code></td>
<td>0</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td><code>S</code></td>
<td>2</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<td><code>T</code></td>
<td>0</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td><code>U</code></td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>V</code></td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td><code>W</code></td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>X</code></td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td><code>Y</code></td>
<td>5</td>
<td>1</td>
<td>4</td>
</tr>
<tr>
<td><code>Z</code></td>
<td>2</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td class="white" colspan="4"> <p class="right">Sum: 36</p></td>
</tr>
</tbody>
</table>
<p>The overall distance between the expected and real letter frequencies has become larger, which means that the correctness of the plaintext candidate has decreased. For this reason, we go back to the previous substitution alphabet. If there had been an improvement, we would have kept the current table.</p>
<p>Again, we change the substitution table slightly. Here, we have exchanged the positions of <code>T</code> and <code>J</code>:</p>
<p class="BodyCustom"><code>Plaintext:      </code><code class="bold">ABCDEFGHIJKLMNOPQRSTUVWXYZ</code></p>
<p class="BodyCustom"><code>Old ciphertext: SNOIJRGYZLMBPDQWUVHFCTAXEK</code></p>
<p class="BodyCustom"><code>New ciphertext: SNOITRGYZLMBPDQWUVHFCJAXEK</code></p>
<h4 id="h3-502727c16-0007"><a class="XrefDestination" id="Step5(again)"/><span class="XrefDestination" id="xref-502727c16-010"/>Step 5 (again)</h4>
<p class="BodyFirst">We decrypt the ciphertext with the changed substitution table and get a new plaintext candidate:</p>
<p class="BodyCustom"><code>Old plaintext:</code> <code class="bold">S NOIJ OR GYZ YSRJ OL MBIGY GMB OR GYZ NPLY</code></p>
<p class="BodyCustom"><code>New plaintext:</code> <code class="bold">S NOIT OR GYZ YSRT OL MBIGY GMB OR GYZ NPLY</code></p>
<h4 id="h3-502727c16-0008"><a class="XrefDestination" id="Step6(again)"/><span class="XrefDestination" id="xref-502727c16-011"/>Step 6 (again)</h4>
<p class="BodyFirst">Then, we rate the correctness of the plaintext candidate with our fitness function:</p>
<table border="1" id="tabular-502727c16-0003">
<thead>
<tr>
<td><b>Letter</b></td>
<td><b>Frequency in the plaintext candidate</b></td>
<td><b>Expected frequency</b></td>
<td><b>Distance</b></td>
</tr>
</thead>
<tbody>
<tr>
<td><code>A</code></td>
<td>0</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td><code>B</code></td>
<td>2</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td><code>C</code></td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>D</code></td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>E</code></td>
<td>0</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td><code>F</code></td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>G</code></td>
<td>4</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td><code>H</code></td>
<td>0</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td><code>I</code></td>
<td>2</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<td><code>J</code></td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td><code>K</code></td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td><code>L</code></td>
<td>2</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>M</code></td>
<td>2</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>N</code></td>
<td>2</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<td><code>O</code></td>
<td>4</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td><code>P</code></td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td><code>Q</code></td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td><code>R</code></td>
<td>3</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td><code>S</code></td>
<td>2</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<td><code>T</code></td>
<td>2</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td><code>U</code></td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>V</code></td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td><code>W</code></td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td><code>X</code></td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td><code>Y</code></td>
<td>5</td>
<td>1</td>
<td>4</td>
</tr>
<tr>
<td><code>Z</code></td>
<td>2</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td class="white" colspan="4"> <p class="right"> Sum: 30</p></td>
</tr>
</tbody>
</table>
<p><span epub:type="pagebreak" id="Page_335" title="335"/>The result of the fitness function has now decreased, which means that the plaintext candidate looks more like a text in the English language. We therefore keep the table.</p>
<p>We repeat the procedure described in the previous paragraphs many times. If the new substitution table leads to a lower result from the fitness function, we keep it. Otherwise, we restore the previous table. We keep doing this until the result of the fitness function doesn’t improve any further for, say, ten steps.</p>
<p><span epub:type="pagebreak" id="Page_336" title="336"/>Usually, the last plaintext candidate is correct. However, there is no guarantee of this, as it is possible for a wrong plaintext candidate to deliver a better fitness function result than all of its tested neighbors, at which point, we call it a <em>local maximum</em>. In such a case, we simply restart the algorithm with a new randomly generated key. If several hill-climbing trials fail to produce a plaintext that makes sense, our assumption that we are dealing with a simple-substitution cryptogram might be wrong.</p>
<p>In the case of the Baring-Gould cryptogram, the correct plaintext is <code class="bold">A BIRD IN THE HAND IS WORTH TWO IN THE BUSH</code>. Here’s the substitution table:</p>
<p class="BodyCustom"><code>Plaintext:  </code><code class="bold">ABIRDNTHESWOU</code></p>
<p class="BodyCustom"><code>Ciphertext: ABCDEFGHIJKLM</code></p>
<p>Note that the plaintext contains only thirteen different letters.</p>
<h3 id="h2-502727c16-0001"><a class="XrefDestination" id="Simulatedannealing"/><span class="XrefDestination" id="xref-502727c16-012"/>Simulated annealing</h3>
<p class="BodyFirst">To avoid getting stuck at local maxima, some codebreakers use a variation on hill climbing known as <em>simulated annealing</em>. Unlike regular hill climbing, a simulated-annealing algorithm moves to a new key candidate not only if the fitness function result improves but also, in some cases, when it decreases. In other words, the path from one key candidate to another can also go downhill. These downhill steps are, however, exceptions, which ensures that the general direction of our path is uphill, as shown in <a href="#figure16-2" id="figureanchor16-2">Figure 16-2</a>.</p>
<p>The decision to take a downhill step depends on a random number and some configurable details. We can vary the probability of a downhill step during the process, based on a control parameter known as the <em>temperature</em>. A higher temperature means that downhill steps are more likely, and a lower temperature decreases their probability.</p>
<figure>
<img alt="" class="" height="331" src="image_fi/502727c16/f16002.png" width="694"/>
<figcaption><p><a id="figure16-2">Figure 16-2</a>: Simulated annealing is a variation on hill climbing. While the latter moves to a new key only if the fitness function result increases, simulated annealing allows for downhill steps.</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_337" title="337"/>Because simulated annealing allows for downhill steps, the algorithm can find a path leading away from a local maximum. However, simulated annealing is often slower than hill climbing, as the downhill steps cause the algorithm to take longer.</p>
<p>The term <em>simulated annealing</em> comes from the process of annealing in metallurgy, which is a method involving the heating and controlled cooling of a material to increase the size of its crystals and reduce their defects.</p>
<h3 id="h2-502727c16-0002"><a class="XrefDestination" id="SuccessstoryBartWenmeckers’ssolutiontotheBaring-Gouldcryptogram"/><span class="XrefDestination" id="xref-502727c16-013"/>Success story: Bart Wenmeckers’s solution to the Baring-Gould cryptogram</h3>
<p class="BodyFirst">While CrypTool 2 supports hill climbing, some experienced codebreakers have written their own hill-climbing code, which allows them to adapt the fitness function and other parameters easily. This section considers the output of a program written by one of our colleagues, New Zealand-based crypto expert Bart Wenmeckers.<sup class="endnote"><a href="b06.xhtml#c16-endnote-3" id="c16-noteref-3">3</a></sup></p>
<p>Bart’s program uses a much more sophisticated fitness function than the one above. It delivers a higher value each time a plaintext candidate looks more like real language. This is the opposite of what is done above. The program prints two lines when a substitution table delivers a better result than its predecessor. Here’s an example:</p>
<p class="BodyCustom"><code>AYISLNTHEPFRBDJXMWCQOKZGVU,313</code></p>
<p class="BodyCustom"><code class="bold">A YISL IN THE HANL IP FRSTH TFR IN THE YDPH</code></p>
<p>This output indicates that the current substitution table is the following . . .</p>
<p class="BodyCustom"><code>Plaintext:  </code><code class="bold">ABCDEFGHIJKLMNOPQRSTUVWXYZ</code></p>
<p class="BodyCustom"><code>Ciphertext: AYISLNTHEPFRBDJXMWCQOKZGVU</code></p>
<p class="BodyContinued">. . . and that the result of the fitness function is 313. The output’s second line is the plaintext candidate (see below). When Bart tried his program with the cryptogram from Sabine Baring-Gould’s book, he received the following sequential results:</p>
<p class="BodyCustom"><code>AYISLNTHEMBUQDVWCGPJZRXKOF,323</code></p>
<p class="BodyCustom"><code class="bold">A YISL IN THE HANL IM BUSTH TBU IN THE YDMH</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>ARISDNTHEMBOUFQWKXCZGPVLYJ,327</code></p>
<p class="BodyCustom"><code class="bold">A RISD IN THE HAND IM BOSTH TBO IN THE RFMH</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>ARISDNTHEMOBUFQWKXCZGPVLYJ,331</code></p>
<p class="BodyCustom"><code class="bold">A RISD IN THE HAND IM OBSTH TOB IN THE RFMH</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>ARISDNTHEMOPUFQWKXCZGBVLYJ,333</code></p>
<p class="BodyCustom"><code class="bold">A RISD IN THE HAND IM OPSTH TOP IN THE RFMH</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>ARISDNTHEGOPZFQWUXVJMBCLYK,334</code></p>
<p class="BodyCustom"><code class="bold">A RISD IN THE HAND IG OPSTH TOP IN THE RFGH</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_338" title="338"/><code>ARISDNTHEGOFZPQWUXVJMBCLYK,343</code></p>
<p class="BodyCustom"><code class="bold">A RISD IN THE HAND IG OFSTH TOF IN THE RPGH</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>ARISDNTHEMOFZPQWUXVJGBCLYK,347</code></p>
<p class="BodyCustom"><code class="bold">A RISD IN THE HAND IM OFSTH TOF IN THE RPMH</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>ARISDNTHEMOFCYBKWXZJVLUGQP,348</code></p>
<p class="BodyCustom"><code class="bold">A RISD IN THE HAND IM OFSTH TOF IN THE RYMH</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>ARISDNTHELOFZUJMBXCKGVQPYW,349</code></p>
<p class="BodyCustom"><code class="bold">A RISD IN THE HAND IL OFSTH TOF IN THE RULH</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>ARILDNTHESOFJMXVUWGQCPBKZY,354</code></p>
<p class="BodyCustom"><code class="bold">A RILD IN THE HAND IS OFLTH TOF IN THE RMSH</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>ARILDNTHESOFVUKMXGPYZJWCBQ,355</code></p>
<p class="BodyCustom"><code class="bold">A RILD IN THE HAND IS OFLTH TOF IN THE RUSH</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>AMILDNTHESOFVUJQXGPYZKWCBR,357</code></p>
<p class="BodyCustom"><code class="bold">A MILD IN THE HAND IS OFLTH TOF IN THE MUSH</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>AMIRDNTHESCOYUBQVXLPWZGJFK,358</code></p>
<p class="BodyCustom"><code class="bold">A MIRD IN THE HAND IS CORTH TCO IN THE MUSH</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>ABIRDNTHESWOYUMXVQCZJLKGPF,365</code></p>
<p class="BodyCustom"><code class="bold">A BIRD IN THE HAND IS WORTH TWO IN THE BUSH</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>ABIRDNTHESPOGUJMQXZYKCWLFV,366</code></p>
<p class="BodyCustom"><code class="bold">A BIRD IN THE HAND IS PORTH TPO IN THE BUSH</code></p>
<p>As can be seen, Bart’s program found the correct solution, rated 365, but didn’t stop there. It rated <code class="bold">A BIRD IN THE HAND IS PORTH TPO IN THE BUSH</code> as an even better solution, with 366 points. Things like this can happen. Of course, a human watching the computer do its work would probably have guessed the correct solution much earlier than the computer, by operating as if they were on <em>Wheel of Fortune</em>.</p>
<h3 id="h2-502727c16-0003"><a class="XrefDestination" id="SuccessstoryTheFloridamurdercasecryptogram"/><span class="XrefDestination" id="xref-502727c16-014"/>Success story: The Florida murder case cryptogram</h3>
<p class="BodyFirst">Some ciphers and cryptograms are associated with horrific crimes. In 2004, eleven-year-old Carlie Brucia was kidnapped from a car wash in Sarasota, Florida, and later killed. Based on a surveillance video, police identified car mechanic Joseph P. Smith as the murderer. In 2005, while in jail and awaiting his trial, he tried to send an encrypted message (<a href="#figure16-3" id="figureanchor16-3">Figure 16-3</a>) to his brother.</p>
<p>The Cryptanalysis and Racketeering Records Unit (CRRU), the FBI’s codebreaking unit, soon broke this cryptogram but did not publicly release any details.<sup class="endnote"><a href="b06.xhtml#c16-endnote-4" id="c16-noteref-4">4</a></sup> In 2014, when Klaus read about the story in a 2005 FBI report,<sup class="endnote"><a href="b06.xhtml#c16-endnote-5" id="c16-noteref-5">5</a></sup> he posted the encrypted message on his blog, after which, German crypto expert and CrypTool 2 developer Nils Kopal quickly solved it via hill climbing.<sup class="endnote"><a href="b06.xhtml#c16-endnote-6" id="c16-noteref-6">6</a></sup></p>
<span epub:type="pagebreak" id="Page_339" title="339"/><figure>
<img alt="" class="" height="455" src="image_fi/502727c16/f16003.png" width="371"/>
<figcaption><p><a id="figure16-3">Figure 16-3</a>: The murderer of Carlie Brucia tried to send this encrypted message from prison to his brother.</p></figcaption>
</figure>
<p>To start, Nils created the following transcript:</p>
<p class="BodyCustom"><code>+5 5 +1 5 %3 +2 -4 x4 -1 +1 %2 %4 x4 %2 +3 -5</code></p>
<p class="BodyCustom"><code>%5 %2 -3 -5 -4 +3 -5 +1 %5 -1 +2 %2 %3 +1 1</code></p>
<p class="BodyCustom"><code>x5 +3 +1 +2 -5 %4 -4 x4 5 x5 -5 +2 -1 3 +1 +2</code></p>
<p class="BodyCustom"><code>-5 +3 -5 %3 3 x5 +1 1 -4 x5 -2 -5 %3 +1 -4 -5 %4</code></p>
<p class="BodyCustom"><code>-1 +3 -4 %2 x4 -5 +5 x5 -5 %3 +1 x4 %2 -1 5 x5 +1</code></p>
<p class="BodyCustom"><code>%2 +1 %5 -5 x2 %2 +1 %2 +1 x4 -5 3 %2 -5 +2 %2 4</code></p>
<p class="BodyCustom"><code>-4 -1 +3 x5 %5 -5 +2 5 x5 %3 +3 5 x5 1 x5 +1 -5 x3 -1</code></p>
<p class="BodyCustom"><code>-3 %2 1 -1 -4 x4 x5 x3 +1 -1 %3 +1 +2 +3 -5 +1 +2 +5 x3 5 -4</code></p>
<p class="BodyCustom"><code>+1 x4 -5 +3 -5 %5 %5 %2 -4 +3 5 x5 %5 x4 %2 +1 x4 -5</code></p>
<p class="BodyCustom"><code>3 +2 -5 %3 +1 x5 x2 -3 -4 x4 -1 x1 -3 -1 +5 x1 -3 -1 -2 -5</code></p>
<p class="BodyCustom"><code>%3 +1 x1 x5 %3 x5 1 -1 +2 x5 +1 1 -3 x2 5 %1 x4 x2</code></p>
<p class="BodyCustom"><code>%3 +1 x3 x5 +2 -4 -1 %3 x2 %3 +2 x2 3 %2</code></p>
<p>Nils performed some statistical analyses involving letter frequency, the index of coincidence, and other tests. He realized that the cryptogram looked like a simple substitution cipher, but all his attempts to break it failed. So, he made some educated guesses, such as checking whether the text might have been written backward.</p>
<p>When he applied the simple-substitution hill climber in CrypTool 2 on the backward-written cryptogram, he succeeded immediately, deriving the following gruesome plaintext (which contains a number of spelling errors):</p>
<p class="BodyCustom"><code>I WLSH L HAD SOMTHLN JULCY TO SAY OH OK THE BACKPACK AND CLOTHES WENT IN FOUR DIFFERENT DUMPSTERS THAT MONDAY I CAME TO YOUR HOUSE FOR ADVISE I WENT IT I LEFT IT OUT IN THE OPEN I DRAGED THE BODY TO WHERE ST WAS FOUND DESTROY THIS AFTER DECIFERING IT AND SHUT UP</code></p>
<p><span epub:type="pagebreak" id="Page_340" title="340"/>This leads to the following substitution table:</p>
<table border="1" class="tabular2" id="tabular-502727c16-0004">
<thead>
<tr>
<td><b><code>A</code></b></td>
<td><b><code>B</code></b></td>
<td><b><code>C</code></b></td>
<td><b><code>D</code></b></td>
<td><b><code>E</code></b></td>
<td><b><code>F</code></b></td>
<td><b><code>G</code></b></td>
<td><b><code>H</code></b></td>
<td><b><code>I</code></b></td>
<td><b><code>J</code></b></td>
<td><b><code>K</code></b></td>
<td><b><code>L</code></b></td>
<td><b><code>M</code></b></td>
<td><b><code>N</code></b></td>
<td><b><code>O</code></b></td>
<td><b><code>P</code></b></td>
<td><b><code>Q</code></b></td>
<td><b><code>R</code></b></td>
<td><b><code>S</code></b></td>
<td><b><code>T</code></b></td>
<td><b><code>U</code></b></td>
<td><b><code>V</code></b></td>
<td><b><code>W</code></b></td>
<td><b><code>X</code></b></td>
<td><b><code>Y</code></b></td>
<td><b><code>Z</code></b></td>
</tr>
</thead>
<tbody>
<tr>
<td>-1</td>
<td>-2</td>
<td>-3</td>
<td>-4</td>
<td>-5</td>
<td>%5</td>
<td>%4</td>
<td>%3</td>
<td>%2</td>
<td>%1</td>
<td>x1</td>
<td>x2</td>
<td>x3</td>
<td>x4</td>
<td>x5</td>
<td>+5</td>
<td>+4</td>
<td>+3</td>
<td>+2</td>
<td>+1</td>
<td>5</td>
<td>4</td>
<td>3</td>
<td>2</td>
<td>1</td>
<td/>
</tr>
</tbody>
</table>
<p>The letters <code class="bold">Q</code>, <code class="bold">X</code>, and <code class="bold">Z</code> don’t appear in the plaintext. While the ciphertext equivalents of <code class="bold">Q</code> and <code class="bold">X</code> can be easily guessed (<code class="bold">Q</code>, for instance, lies between +5 and +3), the character for <code class="bold">Z</code> remains unknown.</p>
<p>In court, a CRRU specialist had presented the same result. Along with other evidence, it led to Smith being sentenced to death.</p>
<h2 id="h1-502727c16-0002"><a class="XrefDestination" id="Solvingahomophoniccipherwithhillclimbing"/><span class="XrefDestination" id="xref-502727c16-015"/>Solving a homophonic cipher with simulated annealing</h2>
<p class="BodyFirst">When it comes to solving a homophonic cipher, hill climbing and simulated annealing are obvious methods to use. After all, a small change in the cipher’s substitution table causes only small changes in the ciphertext. Moreover, because a homophonic cipher has far more potential keys than we can exhaustively check one by one, hill climbing, as well as simulated annealing, provides much more efficient methods than brute force. Since most implementations that we know of use simulated annealing for this purpose, we will focus on only simulated annealing for the following.</p>
<p>Solving a homophonic cipher with simulated annealing is a relatively new field of research, with only a few papers published on the topic to date. One frequently cited article, written by Nils Kopal in 2019, offers an introduction to the subject.<sup class="endnote"><a href="b06.xhtml#c16-endnote-7" id="c16-noteref-7">7</a></sup> However, various researchers around the world are studying this area and may publish the results of their homophonic-simulated-annealing projects in the years ahead.</p>
<p>The best software for homophonic simulated annealing we have found, AZDecrypt, was written by Belgian codebreaking expert Jarl Van Eycke (who released version 1.21 in 2023). AZDecrypt comes with an impressive number of configuration options and implements a strong fitness function. It is available for free at <a class="LinkURL" href="http://www.zodiackillerciphers.com">http://www.zodiackillerciphers.com</a>.</p>
<h3 id="h2-502727c16-0004"><a class="XrefDestination" id="SuccessstoryDhavare,Low,andStamp’sZodiacKillersolutions"/><span class="XrefDestination" id="xref-502727c16-016"/>Success story: Dhavare, Low, and Stamp’s Zodiac Killer solutions</h3>
<p class="BodyFirst">One of the few research papers about hill-climbing attacks on homophonic ciphers that we know of is “Efficient Cryptanalysis of Homophonic Substitution Ciphers,” published by Amrapali Dhavare, Richard M. Low, and Mark Stamp in 2013.<sup class="endnote"><a href="b06.xhtml#c16-endnote-8" id="c16-noteref-8">8</a></sup> The authors describe a method that involves two hill-climbing steps: the first, called <em>outer hill climbing</em>, determines the number of homophones each plaintext letter maps to; while the second, <em>inner hill climbing</em>, reconstructs the substitution table.</p>
<p>Dhavare, Low, and Stamp initially tested their method on Z408, the first message written by the Zodiac Killer (see <span class="xref" itemid="xref_target_Chapter 6"><a href="c06.xhtml">Chapter 6</a></span>). Z408 was solved back in 1969, and the researchers wanted to see whether their algorithm could repeat this deciphering success. In fact, it could, quite easily (see <a href="#figure16-4" id="figureanchor16-4">Figure 16-4</a>).</p>
<p><span epub:type="pagebreak" id="Page_341" title="341"/>The authors next applied their technique to a homophonic cipher challenge, titled Zodiac Cipher, which was available on the crypto-puzzle platform MysteryTwister.<sup class="endnote"><a href="b06.xhtml#c16-endnote-9" id="c16-noteref-9">9</a></sup> This challenge mimics Z340, the second Zodiac Killer message, which, unlike Z408, hadn’t yet been solved. Again, the hill-climbing program had no trouble solving the cryptogram.</p>
<figure>
<img alt="" class="" height="491" src="image_fi/502727c16/g16003.png" width="694"/>
<figcaption><p><a id="figure16-4">Figure 16-4</a>: Dhavare, Low, and Stamp’s hill climber easily broke the (already-solved) first Zodiac Killer message.</p></figcaption>
</figure>
<p>Finally, Dhavare, Low, and Stamp used their method to attack Z340 itself, which was one of the most famous unsolved mysteries in the world. Unfortunately, this time, they did not succeed. The details of their efforts can be seen in their article. For the trio of solvers that did manage to crack Z340 in 2020, see <span class="xref" itemid="xref_target_Chapter 6"><a href="c06.xhtml">Chapter 6</a></span>.</p>
<h2 id="h1-502727c16-0003"><a class="XrefDestination" id="SolvingaVigenèrecipherwithhillclimbing"/><span class="XrefDestination" id="xref-502727c16-017"/>Solving a Vigenère cipher with hill climbing</h2>
<p class="BodyFirst">As pointed out in <span class="xref" itemid="xref_target_Chapter 8"><a href="c08.xhtml">Chapter 8</a></span>, there are many ways to break a Vigenère cipher: some that require a computer and others that can be carried out by hand. One of the computer-based Vigenère-breaking methods is hill climbing. However, hill-climbing attacks on the Vigenère cipher seem to be less popular than on other ciphers, probably because there are efficient alternatives. We are not aware of a research paper that comprehensively covers Vigenère-cipher hill climbing, but at least a few implementations exist, including in CrypTool 2.</p>
<p>Hill-climbing software can either discover the keyword length as part of the hill climbing or determine the information in a different way. Most tools use the latter approach. The program either guesses the length of the <span epub:type="pagebreak" id="Page_342" title="342"/>keyword with Friedman’s method before it starts the hill-climbing procedure, or it conducts a separate hill-climbing attack for every keyword length between, say, three and twenty-five.</p>
<p>These implementations can use the same fitness function as for a simple substitution cipher.</p>
<h3 id="h2-502727c16-0005"><a class="XrefDestination" id="SuccessstoryJimGillogly’ssolutiontoIRAVigenèrecryptograms"/><span class="XrefDestination" id="xref-502727c16-018"/>Success story: Jim Gillogly’s solution to IRA Vigenère cryptograms</h3>
<p class="BodyFirst">In 2001, historian Tom Mahon found around 300 documents containing encrypted messages in a Dublin archive. These documents originated from the estate of activist Moss Twomey (1897–1978), who was the leader of the IRA from 1926 to 1936. Most of the encrypted texts Mahon found were dispatches exchanged between the IRA headquarters in Dublin and IRA activists in the British Isles or the United States. In all, the corpus comprised about 1,300 individual cryptograms.</p>
<p>As Mahon lacked the expertise to decipher these messages, he asked the American Cryptogram Association for support. Our colleague, ACA member Jim Gillogly, became interested, initiating a fruitful partnership between the two researchers. Over the next months, Jim managed to decipher almost all the cryptograms Twomey had left behind, providing insights into the work and structure of the IRA in the 1920s. In 2008, Jim and Mahon published their results in a book titled <em>Decoding the IRA</em>.<sup class="endnote"><a href="b06.xhtml#c16-endnote-10" id="c16-noteref-10">10</a></sup> The book is an interesting read about Irish history, and the first chapter, in which Jim explains his decryptions, is a fascinating resource for anyone interested in codebreaking.</p>
<p>As it turned out, most of the IRA ciphertexts were encrypted using a column-based transposition, which is covered in the next section of this chapter. A smaller share consisted of short ciphertext passages, which contained strikingly many ampersand characters, embedded in cleartext sentences. The following message (dated May 4, 1923) is a typical example:</p>
<figure class="graphic">
<img alt="" class="" height="82" src="image_fi/502727c16/g16004.png" width="691"/></figure>
<p>Here’s a transcript of the first two sentences:</p>
<p class="BodyCustom"><code>Have you yet got X&amp;OYC&amp;UIJO&amp;MN? Did you look up that man FX&amp;WA HKGKH/ whom I spoke to you about.</code></p>
<p>The letter frequencies and some other statistics suggested that its author had applied a Vigenère cipher. Hoping that the author had used the same key for each of these ciphertexts, Jim selected the first six letters of each one. As he didn’t know what to do with the ampersand, he ignored all six-letter blocks that contained this character. The following twenty-two remained:</p>
<p class="BodyCustom"><code>SDRDPX VVQDTY WXGKTX SJMCEK LPMOCG MVLLWK HMNMLJ VDBDFX UMDMWO GGCOCS MMNEYJ KHAKCQ LPQXLI HMHQLT IJMPWG DDMCEX HVQDSU OISOCX DXNXEO IJLWPS IJNBOO OIREAK</code></p>
<p><span epub:type="pagebreak" id="Page_343" title="343"/>Jim fed this block series into a hill-climbing program of his own design, starting with a keyword length of six. Although the twenty-two blocks came from different ciphertexts, characteristics reflected by the fitness function remained valid. In fact, the hill climber found a six-letter keyword candidate that produced promising results right away:</p>
<p class="BodyCustom"><code>MISTER PARTIS QCHAIR MONSTE FUNERA FAMBLE BROCAD PICTUR ORECLI ALDERM GROUND EMBARK FURNAC BRIGAN CONFLA XINSTR BARTHO INTERR XCONTI COMMEM COORDI INSUPE</code></p>
<p>As every six-letter block represented a plausible English letter sequence, Jim knew that he was on the right track.</p>
<p>The hill climber had delivered the keyword <code>GVZKLG</code>. Jim used it to decrypt all the Vigenère messages and learned that the ampersand served as a replacement for the letter <code class="bold">Z</code>, which is why no <code class="bold">Z</code> appears in the ciphertexts. The message shown above decrypted to the following plaintext (the <code class="bold">Z</code> and <code class="bold">X</code> in <code class="bold">Z XCAMPBELLZ</code> were used for padding):</p>
<p class="BodyCustom"><code>Have you yet got REPORT ON KEOGH? Did you look up that man ZCAMPBELLX whom I spoke to you about.</code></p>
<p>Why did the IRA use the keyword <code>GVZKLG</code>? After some experimentation, Jim found that it was the word <code class="bold">TEAPOT</code> encrypted with a simple substitution cipher, based on the following substitution table:</p>
<p class="BodyCustom"><code>Plaintext:  </code><code class="bold">ABCDEFGHIJKLMNOPQRSTUVWXYZ</code></p>
<p class="BodyCustom"><code>Ciphertext: ZYXWVUTSRQPONMLKJIHGFEDCBA</code></p>
<p>As you can see, the substitution used an easy-to-remember backward alphabet.</p>
<h2 id="h1-502727c16-0004"><a class="XrefDestination" id="Solvingacolumnartranspositionwithhillclimbing"/><span class="XrefDestination" id="xref-502727c16-019"/>Solving a columnar transposition with hill climbing</h2>
<p class="BodyFirst">We can use hill climbing to solve both complete and incomplete columnar transposition ciphers, which are described in <span class="xref" itemid="xref_target_Chapters 9">Chapters <a href="c09.xhtml">9</a></span> and <span class="xref" itemid="xref_target_10"><a href="c10.xhtml">10</a></span>. However, the fitness function employed to break a simple substitution cipher doesn’t work here. In general, we can’t break a transposition with any fitness function that is based on the frequency of letters, because transposing letters doesn’t change their frequencies.</p>
<p>Instead, we can rely on the frequency of letter groups to rate the correctness of a plaintext candidate. We have encountered anything from letter pairs (digraphs) to groups of eight letters (octagraphs) used in this context.</p>
<p>Next, we need a way to change the transposition cipher’s key slightly. If we are dealing with a columnar transposition of, say, ten columns, we can write the key like this:</p>
<p class="BodyCustom"><code>8,4,5,2,9,7,1,10,3,6.</code></p>
<p>To make a small change in the key, we might switch two randomly chosen numbers in this sequence. For instance, <code>8,4,5,2,9,7,1,10,3,6</code> might become <code>8,4,1,2,9,7,5,10,3,6</code>.</p>
<p><span epub:type="pagebreak" id="Page_344" title="344"/>Note that the keyword used to encrypt a columnar transposition ciphertext doesn’t play a role in this process. Hill climbing works even if the keyword is a random string, like <code>VKWJIDPQFH</code>, and delivers the plaintext without re-creating the original keyword. In fact, determining the keyword is often impossible, as there might be several equivalent ones.</p>
<p>Breaking an incomplete columnar transposition is, of course, more complex than solving a complete one. Still, we can think of the process as merely a special case of solving complete columnar transpositions. Because a computer usually does this task using a hill-climbing program, the complexity is generally not a problem, but the task may take longer.</p>
<p>If we do not know the length of the keyword (as is usually the case in practice), we have two possible approaches. First, we can make the keyword length a part of the key and change it slightly between hill-climbing rounds; however, this adds to the complexity of the program. The better approach is usually to perform several hill-climbing attacks for different keyword lengths. If we assume that the keyword has a length of between five and twenty letters, then we need sixteen tries—not much of a problem for today’s computers.</p>
<p>The software CrypTool 2 includes a powerful transposition hill climber. Bernhard Esslinger, the head of the CrypTool project, has demonstrated that this hill climber (even running on a PC) can easily break some of the IRA transposition cryptograms introduced in <span class="xref" itemid="xref_target_Chapter 10"><a href="c10.xhtml">Chapter 10</a></span> within two minutes.</p>
<h3 id="h2-502727c16-0006"><a class="XrefDestination" id="SuccessstoryJimGillogly’ssolutiontoIRAtranspositioncryptograms"/><span class="XrefDestination" id="xref-502727c16-020"/>Success story: Jim Gillogly’s solution to IRA transposition cryptograms</h3>
<p class="BodyFirst">Let’s return to that 2008 book <em>Decoding the IRA</em> by Jim Gillogly and Tom Mahon. The following IRA cryptogram is one of six messages that Mahon, the historian, initially sent to the American Cryptogram Association in 2005. It was subsequently shared on the association’s mailing list and then solved by Jim:</p>
<p class="BodyCustom"><code>AEOOA IIIEO AEAEW LFRRD ELBAP RAEEA EIIIE AAAHO IFMFN COUMA</code></p>
<p class="BodyCustom"><code>FSOSG NEGHS YPITT WUSYA ORDOO ERHNQ EEEVR TTRDI SOSDR ISIEE ISUTI</code></p>
<p class="BodyCustom"><code>ERRAS TTKAH LFSUG RDLKP UEYDM ERNEO RULDC ERWTE ICNIA T</code></p>
<p>This cryptogram consists of 151 letters. When analyzing the ciphertext, Jim saw that <code>E</code> was by far the most common letter, with twenty-three appearances, followed by <code>A</code>, <code>R</code>, and <code>I</code>. The letters <code>Q</code>, <code>B</code>, and <code>V</code> turned out to be very rare. These frequencies are consistent with the English language, although the ratio of vowels (47%) seemed a little high (40% is typical). Jim assumed that he was dealing with a transposition cipher. As 151 is a prime number, it could not be a complete columnar transposition, but an incomplete one seemed possible.</p>
<p>In his forty years as a codebreaker, Jim had written a considerable amount of cryptanalysis software for his personal use. Among other things, he was one of the first to use hill climbing for cryptanalysis. To solve this particular encryption, he used a hill-climbing program tailored to breaking an incomplete columnar transposition, assuming a line length of between eight and fifteen and starting separate runs for each length. When he tried a length of twelve, he received the following plaintext candidate:</p>
<p class="BodyCustom"><code>THEAADDARESSTOWHECIEHYOUWILLOESENDSTUFFFOR . . .</code></p>
<p><span epub:type="pagebreak" id="Page_345" title="345"/>This string, as you can tell, contains many words that make sense. It is even possible to read a meaningful sentence from it (<code class="bold">THE ADDRESS TO WHICH YOU WILL SEND STUFF . . .</code>). However, quite a few letters seem unnecessary.</p>
<p>Jim restarted his hill-climbing program about a hundred times, with a different initial keyword candidate on each occasion, but he didn’t get a better result. His software had determined that the keyword was <code>FDBJALHCGKEI</code>—certainly not the original one used by the IRA, but equivalent. For further analysis, he looked at the transposition table his program had created:</p>
<p class="BodyCustom"><code>FDBJALHCGKEI</code></p>
<p class="BodyCustom"><code>------------</code></p>
<p class="BodyCustom"><code>THEAADDARESS</code></p>
<p class="BodyCustom"><code>TOWHECIEHYOU</code></p>
<p class="BodyCustom"><code>WILLOESENDST</code></p>
<p class="BodyCustom"><code>UFFFOROAQMGI</code></p>
<p class="BodyCustom"><code>SMRSAWSEEENE</code></p>
<p class="BodyCustom"><code>YFRUITDIERER</code></p>
<p class="BodyCustom"><code>ANDGIERIENGR</code></p>
<p class="BodyCustom"><code>OCERIIFIVEHA</code></p>
<p class="BodyCustom"><code>ROLDECSEROSS</code></p>
<p class="BodyCustom"><code>DUBLONIATRYT</code></p>
<p class="BodyCustom"><code>OMAKAIEATUET</code></p>
<p class="BodyCustom"><code>OAPPEAEARLLK</code></p>
<p class="BodyCustom"><code>EFRHATI</code></p>
<p>Jim immediately recognized why his software had delivered strange results. The encipherer had inserted two columns (the fifth and eighth) of meaningless vowels into the table. In addition, his hill-climbing program had switched the <code>L</code> and <code>H</code> columns. Here is the correct table (with the extra vowels omitted):</p>
<p class="BodyCustom"><code>FDBJAHLCGKEI</code></p>
<p class="BodyCustom"><code>------------</code></p>
<p class="BodyCustom"><code>THEA DD RESS</code></p>
<p class="BodyCustom"><code>TOWH IC HYOU</code></p>
<p class="BodyCustom"><code>WILL SE NDST</code></p>
<p class="BodyCustom"><code>UFFF OR QMGI</code></p>
<p class="BodyCustom"><code>SMRS SW EENE</code></p>
<p class="BodyCustom"><code>YFRU DT ERER</code></p>
<p class="BodyCustom"><code>ANDG RE ENGR</code></p>
<p class="BodyCustom"><code>OCER FI VEHA</code></p>
<p class="BodyCustom"><code>ROLD SC ROSS</code></p>
<p class="BodyCustom"><code>DUBL IN TRYT</code></p>
<p class="BodyCustom"><code>OMAK EI TUET</code></p>
<p class="BodyCustom"><code>OAPP EA RLLK</code></p>
<p class="BodyCustom"><code>EFRH IT</code></p>
<p><span epub:type="pagebreak" id="Page_346" title="346"/>The correct plaintext reads as follows:</p>
<p class="BodyCustom"><code>THE ADDRESS TO WHICH YOU WILL SEND STUFF FOR QMG IS MRS SWEENEY FRUDTERER AND GREENGROCER FIVE HAROLD’S CROSS DUBLIN TRY TO MAKE IT UP TO APPEAR LIKE FRUIT.</code></p>
<p>The actual keyword used by the IRA has never been determined.</p>
<h3 id="h2-502727c16-0007"><a class="XrefDestination" id="SuccessstoryRichardBean’ssolutiontothelastunsolvedIRAcryptogram"/><span class="XrefDestination" id="xref-502727c16-021"/>Success story: Richard Bean’s solution to the last unsolved IRA cryptogram</h3>
<p class="BodyFirst">As described in the previous section, Jim Gillogly solved hundreds of transposition cryptograms left behind by IRA activist Moss Twomey, but there was one he couldn’t break:</p>
<p class="BodyCustom"><code>GTHOO RCSNM EOTDE TAEDI NRAHE EBFNS INSGD AILLA YTTSE AOITDE</code></p>
<p>In the Twomey files, every encrypted message has a header that indicates its length. In this case, the number of letters is specified to be fifty-two, though the ciphertext consists of only fifty-one characters. It was clear that something had gone wrong; perhaps this was the reason Jim had not succeeded in breaking the message.</p>
<p>In 2018, our colleague Richard Bean, a mathematician from Brisbane, Australia, specializing in combinatorics and statistics, became interested in this cryptogram after reading Jim Gillogly and Tom Mahon’s book.<sup class="endnote"><a href="b06.xhtml#c16-endnote-11" id="c16-noteref-11">11</a></sup> He tried to solve it with hill climbing, checking different keyword lengths and iteratively improving his fitness function. Drawing from George Lasry’s PhD thesis,<sup class="endnote"><a href="b06.xhtml#c16-endnote-12" id="c16-noteref-12">12</a></sup> he realized that hexagraph frequencies would prove especially helpful for distinguishing meaningful text from gibberish. He also noticed that a keyword length of eleven produced the best hill-climbing scores. When adding letters to all different parts of the ciphertext, he received the most meaningful results by inserting a character between the two <code>E</code>s (letters twenty-five and twenty-six).</p>
<p>Richard also observed that, in some of the best-scoring ciphertext candidates, the string <code class="bold">LIGNIT</code> appeared. As the IRA used gelignite (an explosive) in the 1920s, this discovery provided a potential crib. When Richard forced the string <code class="bold">GELIGNIT</code> into the hill-climbing output, many other meaningful words became visible, such as <code class="bold">THEYRAID</code> and <code class="bold">ANDOBTAINED</code>. The additional letter ended up in the string <code class="bold">SCOT*AND</code>, so he could easily identify it as an <code class="bold">L</code>. Finally, Richard detected the following plaintext:</p>
<p class="BodyCustom"><code>REGELIGNITSCOTLANDSTAESTHEYRAIDEANDOBTAINEDOMEOFTHLS</code></p>
<p>Here is the message in a more readable form: <code class="bold">RE GELIGNIT[E] SCOTLAND STA[T]ES THEY RAIDE[D] AND OBTAINED [S]OME OF THLS</code>.</p>
<p>Note that four letters in the plaintext (<code class="bold">E</code>, <code class="bold">T</code>, <code class="bold">D</code>, and <code class="bold">S</code>) are missing and that there’s a typo in the last word. Along with the missing ciphertext letter <code>L</code>, these mistakes made it extremely difficult to break the message. After <span epub:type="pagebreak" id="Page_347" title="347"/>some more analysis, Richard found that he could obtain a better result if he assumed a twelve-letter keyword and an additional column in the transposition table containing the letters <code class="bold">E</code>, <code class="bold">T</code>, <code class="bold">D</code>, and <code class="bold">S</code> (four of the missing plaintext letters). Because the original location of this additional column isn’t known, it is very difficult to determine the keyword used. As we will show, <code class="bold">BCAFIEHGKDLJ</code> works, though this is certainly not the keyword used by the IRA.</p>
<p>Based on this information, we can reconstruct the process by which the message was encrypted. We start with the plaintext, including the letters <code class="bold">E</code>, <code class="bold">T</code>, <code class="bold">D</code>, <code class="bold">S</code>, and <code class="bold">L</code> (which were lost at a later point in time) and keeping the typo in the last word:</p>
<p class="BodyCustom"><code>RE GELIGNITE SCOTLAND STATES THEY RAIDED AND OBTAINED SOME OF THLS</code></p>
<p>Next, we write this text below the keyword. (Note that the letters <code class="bold">E</code>, <code class="bold">T</code>, <code class="bold">D</code>, and <code class="bold">S</code> appear in the next-to-last column.)</p>
<p class="BodyCustom"><code>BCAFIEHGKDLJ</code></p>
<p class="BodyCustom"><code>------------</code></p>
<p class="BodyCustom"><code>REGELIGNITES</code></p>
<p class="BodyCustom"><code>COTLANDSTATE</code></p>
<p class="BodyCustom"><code>STHEYRAIDEDA</code></p>
<p class="BodyCustom"><code>NDOBTAINEDSO</code></p>
<p class="BodyCustom"><code>MEOFTHLS</code></p>
<p>Now, we transpose the columns such that the keyword letters are in alphabetical order:</p>
<p class="BodyCustom"><code>ABCDEFGHIJKL</code></p>
<p class="BodyCustom"><code>------------</code></p>
<p class="BodyCustom"><code>GRETIENGLSIE</code></p>
<p class="BodyCustom"><code>TCOANLSDAETT</code></p>
<p class="BodyCustom"><code>HSTEREIAYADD</code></p>
<p class="BodyCustom"><code>ONDDABNITOES</code></p>
<p class="BodyCustom"><code>OME HFSLT</code></p>
<p>Reading out the text column-wise, we receive:</p>
<p class="BodyCustom"><code>GTHOO RCSNM EOTDE TAEDI NRAHE LEBFN SINSG DAILL AYTTS EAOIT DEETDS</code></p>
<p>This message consists of fifty-six letters. Somehow, the final five characters were later lost (the <code>ETDS</code> at the end and the <code>L</code> in <code>LEBEN</code>):</p>
<p class="BodyCustom"><code>GTHOO RCSNM EOTDE TAEDI NRAHE <span class="Strikethrough">L</span>EBFN SINSG DAILL AYTTS EAOIT DE<span class="Strikethrough">ETDS</span></code></p>
<p>In August 2019, Richard Bean informed Klaus and Jim of this solution he had found. Jim was able to verify it, confirming that it was correct. Over a decade after his initial success, the last of Twomey’s messages had finally been deciphered.</p>
<h3 id="h2-502727c16-0008"><span epub:type="pagebreak" id="Page_348" title="348"/><a class="XrefDestination" id="SuccessstoryGeorgeLasry’ssolutionofthedoublecolumnartranspositionchallenge"/><span class="XrefDestination" id="xref-502727c16-022"/>Success story: George Lasry’s solution of the double columnar transposition challenge</h3>
<p class="BodyFirst">In 1999, Otto Leiberich, the former president of the German crypto authority <em>Zentralstelle für das Chiffrierwesen</em><em> (ZfCh)</em>, or the Central Authority for Cipher Affairs, published an article in the German science journal <em>Spektrum der Wissenschaft</em>.<sup class="endnote"><a href="b06.xhtml#c16-endnote-13" id="c16-noteref-13">13</a></sup> In this article, Leiberich discussed double columnar transposition (see <span class="xref" itemid="xref_target_Chapter 10),">Chapter 10),</span> which East German agents had used during the Cold War.</p>
<p>Double columnar transposition is one of the best manual ciphers known. Leiberich and his team worked intensively on the cryptanalysis of this method, and in 1974, one of their results led to the unmasking of a top spy: Günter Guillaume, the personal secretary of the West German Chancellor, Willy Brandt. Guillaume had been feeding information to the East Germans. He was arrested, tried, and sentenced to prison but freed in 1981 as part of a prisoner exchange.</p>
<p>In his 1999 article, published long after the end of the Cold War, Leiberich encouraged researchers to study double columnar transposition further, for the technique’s historical value. He also suggested that a challenge cryptogram be created with this cipher. His recommendations for this challenge included the following items:</p>
<ul class="disc">
<li>Both keywords should have twenty to twenty-five characters.</li>
<li>The lengths of the two keywords should have no common divisor except one.</li>
<li>The length of the ciphertext should not be a multiple of the length of either keyword.</li>
<li>The ciphertext should have approximately five hundred characters (roughly the product of the lengths of the two keywords).</li>
</ul>
<p>Leiberich never published a challenge of this kind himself, so Klaus decided to do so because he was always interested in challenging his readers. He chose a few paragraphs from the 1910 novel <em>Mistress Wilding</em> by Rafael Sabatini and encrypted them using two keywords consisting of English phrases with twenty to twenty-five letters.<sup class="endnote"><a href="b06.xhtml#c16-endnote-14" id="c16-noteref-14">14</a></sup> The length of the plaintext was 599. Klaus published this challenge ciphertext in 2007 in an online article:<sup class="endnote"><a href="b06.xhtml#c16-endnote-15" id="c16-noteref-15">15</a></sup></p>
<p class="BodyCustom"><code>VESINTNVONMWSFEWNOEALWRNRNCFITEEICRHCODEE</code></p>
<p class="BodyCustom"><code>AHEACAEOHMYTONTDFIFMDANGTDRVAONRRTORMTDHE</code></p>
<p class="BodyCustom"><code>OUALTHNFHHWHLESLIIAOETOUTOSCDNRITYEELSOAN</code></p>
<p class="BodyCustom"><code>GPVSHLRMUGTNUITASETNENASNNANRTTRHGUODAAAR</code></p>
<p class="BodyCustom"><code>AOEGHEESAODWIDEHUNNTFMUSISCDLEDTRNARTMOOI</code></p>
<p class="BodyCustom"><code>REEYEIMINFELORWETDANEUTHEEEENENTHEOOEAUEA</code></p>
<p class="BodyCustom"><code>EAHUHICNCGDTUROUTNAEYLOEINRDHEENMEIAHREED</code></p>
<p class="BodyCustom"><code>OLNNIRARPNVEAHEOAATGEFITWMYSOTHTHAANIUPTA</code></p>
<p class="BodyCustom"><code>DLRSRSDNOTGEOSRLAAAURPEETARMFEHIREAQEEOIL</code></p>
<p class="BodyCustom"><code>SEHERAHAOTNTRDEDRSDOOEGAEFPUOBENADRNLEIAF</code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_349" title="349"/><code>RHSASHSNAMRLTUNNTPHIOERNESRHAMHIGTAETOHSE</code></p>
<p class="BodyCustom"><code>NGFTRUANIPARTAORSIHOOAEUTRMERETIDALSDIRUA</code></p>
<p class="BodyCustom"><code>IEFHRHADRESEDNDOIONITDRSTIEIRHARARRSETOIH</code></p>
<p class="BodyCustom"><code>OKETHRSRUAODTSCTTAFSTHCAHTSYAOLONDNDWORIW</code></p>
<p class="BodyCustom"><code>HLENTHHMHTLCVROSTXVDRESDR</code></p>
<p>Neither Klaus nor Leiberich expected that this cryptogram could be broken; however, six years later, in 2013, Klaus received an email from our colleague, the then-unknown Israeli George Lasry, who claimed to have solved the double columnar transposition challenge. His solution proved correct:</p>
<p class="BodyCustom"><code>THEGIRLHADARRIVEDATLUPTONHOUSEAHALFHOURAH</code></p>
<p class="BodyCustom"><code>EADOFMISSWESTMACOTTANDUPONHERARRIVALSHEHA</code></p>
<p class="BodyCustom"><code>DEXPRESSEDSURPRISEEITHERFEIGNEDORREALATFI</code></p>
<p class="BodyCustom"><code>NDINGRUTHSTILLABSENTDETECTINGTHEALARMTHAT</code></p>
<p class="BodyCustom"><code>DIANAWASCAREFULTOTHROWINTOHERVOICEANDMANN</code></p>
<p class="BodyCustom"><code>ERHERMOTHERQUESTIONEDHERANDELICITEDTHESTO</code></p>
<p class="BodyCustom"><code>RYOFHERFAINTNESSANDOFRUTHSHAVINGRIDDENONA</code></p>
<p class="BodyCustom"><code>LONETOMRWILDINGSSOOUTRAGEDWASLADYHORTONTH</code></p>
<p class="BodyCustom"><code>ATFORONCEINAWAYTHISWOMANUSUALLYSOMEEKANDE</code></p>
<p class="BodyCustom"><code>ASELOVINGWASROUSEDTOANENERGYANDANGERWITHH</code></p>
<p class="BodyCustom"><code>ERDAUGHTERANDHERNIECETHATTHREATENEDTOREMO</code></p>
<p class="BodyCustom"><code>VEDIANAATONCEFROMTHEPERNICIOUSATMOSPHEREO</code></p>
<p class="BodyCustom"><code>FLUPTONHOUSEANDCARRYHERHOMETOTAUNTONRUTHF</code></p>
<p class="BodyCustom"><code>OUNDHERSTILLATHERREMONSTRANCESARRIVEDINDE</code></p>
<p class="BodyCustom"><code>EDINTIMEFORHERSHAREOFTHEM</code></p>
<p>Interestingly, George had found two different methods for breaking the challenge. In the first, a dictionary attack, his computer program had guessed the two keywords: <code class="bold">PREPONDERANCEOFEVIDENCE</code> and <code class="bold">TOSTAYYOUFROMELECTION</code>. His second method was based on hill climbing. Later, Jim came up with a third method: using a computer program, he checked all nineteenth-century texts available online and identified the one Klaus had chosen.</p>
<p>Readers interested in this ingenious act of cryptanalysis are advised to read George’s 2014 publication in <em>Cryptologia</em> (co-written with Arno Wacker and Nils Kopal).<sup class="endnote"><a href="b06.xhtml#c16-endnote-16" id="c16-noteref-16">16</a></sup> If you are interested in an even more difficult cryptogram of this type, see the “Double Columnar Transposition Reloaded Challenge” in the “<span class="xref" itemid="xref_target_Challenges">Challenges</span>” section of <span class="xref" itemid="xref_target_Chapter 10"><a href="c10.xhtml">Chapter 10</a></span>.</p>
<h2 id="h1-502727c16-0005"><a class="XrefDestination" id="Solvingaturninggrillecipherwithhillclimbing"/><span class="XrefDestination" id="xref-502727c16-023"/>Solving a turning grille cipher with hill climbing</h2>
<p class="BodyFirst">Hill climbing has proven to be a very powerful method of breaking turning grille cryptograms. As we will show, we can solve even large turning grilles, consisting of 20 × 20 squares or more, with this technique. This is because we can easily construct a turning grille of size 2<em>n </em>× 2<em>n</em> with an <em>n </em>× <em>n</em> matrix, <span epub:type="pagebreak" id="Page_350" title="350"/>as described in <span class="xref" itemid="xref_target_Chapter 11"><a href="c11.xhtml">Chapter 11</a></span>. As an example, the following diagram shows how a 3 × 3 matrix can become a 6 × 6 grille:</p>
<figure class="graphic">
<img alt="" class="" height="291" src="image_fi/502727c16/g16005.png" width="694"/></figure>
<p>In a computer program, the number sequence in the 3 × 3 matrix (<code>2,4,1,1,4,3,3,2,2</code>) can represent the grille, which serves as this encryption method’s key. Next, we need a way to change the grille slightly. We can do this, for instance, by adding 2 to one of the numbers representing the grille, as in the following example. If the result were greater than 4, we would subtract 4 from it:</p>
<p class="BodyCustom"><code>Old key: 2,4,1,1,4,3,3,2,2</code></p>
<p class="BodyCustom"><code>New key: 2,4,3,1,4,3,3,2,2</code></p>
<p>For a turning grille hill climber, we also need to modify the kind of fitness function that we employ to rate the correctness of a plaintext candidate. We can’t base it on the frequency of letters, as this kind of encryption doesn’t change a plaintext’s letter frequencies. (No transposition cipher does.) Instead, we might create a fitness function based on the frequencies of digraphs, trigraphs, or other <em>n</em>-graphs.</p>
<p>The computer program JCrypTool offers a turning grille solver based on hill climbing.</p>
<h3 id="h2-502727c16-0009"><a class="XrefDestination" id="SuccessstoryBartWenmeckers’ssolutiontoaturninggrillecryptogram"/><span class="XrefDestination" id="xref-502727c16-024"/>Success story: Bart Wenmeckers’s solution to a turning grille cryptogram</h3>
<p class="BodyFirst">In <span class="xref" itemid="xref_target_Chapter 11"><a href="c11.xhtml">Chapter 11</a></span>, we mentioned that the Italian crypto-history expert Paolo Bonavoglia recently found a turning grille cryptogram in a notebook belonging to his famous grandfather, Luigi Sacco (1883–1970).<sup class="endnote"><a href="b06.xhtml#c16-endnote-17" id="c16-noteref-17">17</a></sup> After solving the cryptogram himself, Paolo also published it as a challenge in the “Cryptograms &amp; Classical Ciphers” Facebook group. Our colleague Bart Wenmeckers, the host of the group, took up the challenge.<sup class="endnote"><a href="b06.xhtml#c16-endnote-18" id="c16-noteref-18">18</a></sup></p>
<p>Like many other specialists in breaking classical ciphers, Bart makes frequent use of hill climbing, employing a modified program that he wrote himself. The program returns the grille written in a line, with the letter <code>C</code> representing a hole and <code>D</code> representing no hole. It also returns the result of its fitness function (the higher, the better) and the plaintext candidate <span epub:type="pagebreak" id="Page_351" title="351"/>produced each time that result increases. Here’s the final part of the log of Bart’s hill-climbing attack on Sacco’s turning grille cryptogram:</p>
<p class="BodyCustom"><code>DDCCCDCDDDDDDDDCDDCDDDDDDCDDDDDDDDDCDDCCCCDDDDDDD, 323</code></p>
<p class="BodyCustom"><code>NOSPDSEHERSEEUCHNGENDWITRSTWRKECYHEIESULLIUNTEXE</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>DDCCCDCDDDDDDDDCDDCDDDDDDCDDDDDDDDDCCDCCDCDDDDDDD, 329</code></p>
<p class="BodyCustom"><code>NOSPDSEHWEREESUCHNGENDITRTWURKECYHEIESLLIUNTEXSE</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>DDCCCDCDDDDDDDDDDDCDDDDDDCDDDDDDDCDCCDCCDCDDDDDDD, 334</code></p>
<p class="BodyCustom"><code>NOSPSECHWEREESCHNGENDXITRTWURDKEYHEIESULLIUNTESE</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>DDCCCDDDDDDDDDDDDDCDDDDDDCDDDDDDDCDCCDCCDCCDDDDDD, 344</code></p>
<p class="BodyCustom"><code>NOSSECHWEREYEESCHNGENDXIPRTWURDKEHEISULLIUNTESET</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>CDCCCDDDDDDDDDDDDDCDDDDDDCDDDDDDDCDCCDCCDCDDDDDDD, 362</code></p>
<p class="BodyCustom"><code>ENOSSECHWEREEPSCHNGENDXIRTWURDKEHEITSULLIUNTESYE</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>CDCCCDDDDDDDDDDDDCCDDDDDDDDDDDDDDCDCCDCCDCDDDDDDD, 385</code></p>
<p class="BodyCustom"><code>ENOSISCHWEREEPSCHENGNDXIRTWURDEEHEITSULLUNKTESYE</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>DDCCCDDDDDDDDDDDDCCDDDDDDDDDDDDDDCDCCDCCDCDDDDDDC, 402</code></p>
<p class="BodyCustom"><code>NOSISCHWERETESCHENGNDXYIERTWURDEEHEISPULLUNKTESE</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>DDCCDDDDDDDDDDCDCCDDDDDDDDDDDDDDDCDCCDCCDCDDDDDDC, 410</code></p>
<p class="BodyCustom"><code>NOLLICHWERETESSSCHENGXYIERTWURDENDEISPUUNKTEESHE</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>DDDDDCDDDCCDCCDCDDDDDDDDDDDDDDDCCDCDDDDDDDDDDCCDC, 416</code></p>
<p class="BodyCustom"><code>STWURDENDEITUUNKTEESEYHEENOLLICHWERIESPRSSCHENGX</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>CDDDDCDDDCCDCCDCDDDDDDDDDDDDDDDCCDCDDDDDDDDDDCCDD, 424</code></p>
<p class="BodyCustom"><code>ESTWURDENDEIPUUNKTEESEHENOLLICHWERITESRSSCHENGXY</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>CDDDDCDDDCCDCCDCDDDDDDDDDDDDDDDCCDDDDDDDDDDDCCCDD, 425</code></p>
<p class="BodyCustom"><code>ESTWURDENHEIPULUNKTEESEENOSLICHWERITERSSCHENGDXY</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>CDDDDCDDDCCDCCDCDDDDDDDDDDDDDDCCDDDDDDDDDDDDCCCDD, 428</code></p>
<p class="BodyCustom"><code>ESTWURDEEHEIPULLUNKTESEENOSISCHWERITERSCHENGNDXY</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>CDDDDCDDDDCDCCDCDDDDDDDDDDDDDDDCCDCDDDDCDDDDDCCDD, 442</code></p>
<p class="BodyCustom"><code>ESWURDENDREIPUNKTEGESEHENOTLLICHWEITESRSSUCHENXY</code></p>
<p>If you know German (the language of the original message), you’ll see words show up immediately. Here’s the plaintext (the mistakes were present in the original): <code class="bold">ES WURDEN DREI PUNKTE GESEHEN OTLLICH WEITESRSSUCHEN XY</code>.</p>
<p>It translates to <code class="bold">THREE POINTS HAVE BEEN SEEN. KEEP ON SEARCHING IN THE EAST XY.</code> The <code class="bold">X</code> and <code class="bold">Y</code> at the end of the message are almost certainly padding that was added to ensure a plaintext of exactly forty-eight letters.</p>
<h3 id="h2-502727c16-0010"><span epub:type="pagebreak" id="Page_352" title="352"/><a class="XrefDestination" id="SuccessstoryArminKrauß’ssolutiontoaturninggrillechallenge"/><span class="XrefDestination" id="xref-502727c16-025"/>Success story: Armin Krauss’s solution to a turning grille challenge</h3>
<p class="BodyFirst">Can a 20 × 20 turning grille cryptogram be broken with hill climbing? Because Klaus had never found an answer to this question in the literature, he decided to create a challenge for his blog readers that tested the idea. He took an English text consisting of 400 letters, encrypted it with a 20 × 20 turning grille, and published the ciphertext on his blog in 2017:<sup class="endnote"><a href="b06.xhtml#c16-endnote-19" id="c16-noteref-19">19</a></sup></p>
<p class="BodyCustom"><code>ENPAIGEZLANEDMTHSENF</code></p>
<p class="BodyCustom"><code>EIORDEMATANNATMOOFSL</code></p>
<p class="BodyCustom"><code>AEPLMHOIERITOECDMVNE</code></p>
<p class="BodyCustom"><code>OXNPBROEDOIETRANEEIU</code></p>
<p class="BodyCustom"><code>XPNPONRNTAREOMMYDWIT</code></p>
<p class="BodyCustom"><code>IANHTNEIOODNSOUOTETD</code></p>
<p class="BodyCustom"><code>MOOVEARPHRIOLAEGNALN</code></p>
<p class="BodyCustom"><code>INATTFINOREATDNGWDDA</code></p>
<p class="BodyCustom"><code>UHSIEURININGTTEDASTN</code></p>
<p class="BodyCustom"><code>ATGHPEESAOMEISEADRMM</code></p>
<p class="BodyCustom"><code>YANTSOEJOESYTERTHACH</code></p>
<p class="BodyCustom"><code>BNINCALURDCHLEALLHLA</code></p>
<p class="BodyCustom"><code>OIFWESTEHENGREERRTHE</code></p>
<p class="BodyCustom"><code>SAAMSIBEIOVNSAINARLI</code></p>
<p class="BodyCustom"><code>DTESGIIETTUCNARILYLO</code></p>
<p class="BodyCustom"><code>ESENRUUISINEADSRANLA</code></p>
<p class="BodyCustom"><code>COUWNEAUETCPOHRNSDTW</code></p>
<p class="BodyCustom"><code>BYEOFNINGHERHIVNTOTE</code></p>
<p class="BodyCustom"><code>MNTBERAEHEUNSPNSUTIX</code></p>
<p class="BodyCustom"><code>NPOITYPFIKSAVULEATRA</code></p>
<p>Three days after Klaus’s publication, our colleague Armin Krauss posted the solution:<sup class="endnote"><a href="b06.xhtml#c16-endnote-20" id="c16-noteref-20">20</a></sup></p>
<p class="BodyCustom"><code>PLANS FOR MANNED MOON EXPEDITIONS ORIGINATED DURING THE EISENHOWER ERA IN AN ARTICLE SERIES WERNHER VON BRAUN POPULARIZED THE IDEA OF A MOON EXPEDITION A MANNED MOON LANDING POSED MANY TECHNICAL CHALLENGES BESIDES GUIDANCE AND WEIGHT MANAGEMENT ATMOSPHERIC REENTRY WITHOUT OVERHEATING WAS A MAJOR HURDLE AFTER THE SOVIET UNIONS LAUNCH OF THE SPUTNIK SATELLITE VON BRAUN PROMOTED A PLAN FOR THE UNITED STATES ARMY TO ESTABLISH A MILITARY LUNAR OUTPOST BY NINETEEN SIXTY FIVE</code></p>
<p>Armin had used a hill-climbing and simulated-annealing program of his own design to break this cryptogram. The fitness function he applied was based on trigraph frequencies. In addition, Armin used a sequence of numbers between one and four to represent a grille, as explained <span class="xref" itemid="xref_target_in the introduction to this section">in the introduction to this section</span>. In each round, he changed one of the numbers at random.</p>
<p>Because the original ciphertext contained a mistake, Armin had to perform some additional manual codebreaking. After he learned via Google that Klaus’s plaintext was derived from a Wikipedia article, he managed to solve the challenge in spite of the error.</p>
<h2 id="h1-502727c16-0006"><span epub:type="pagebreak" id="Page_353" title="353"/><a class="XrefDestination" id="Solvingageneraldigraphsubstitutionwithhillclimbing"/><span class="XrefDestination" id="xref-502727c16-026"/>Solving a general digraph substitution with hill climbing</h2>
<p class="BodyFirst">Hill climbing is a perfect approach to solving general digraph substitutions. This technique resembles the breaking of simple substitution ciphers; we can even use a comparable fitness function, based on letter or <em>n</em>-graph frequencies, to check whether a plaintext candidate looks like real language. However, we need a larger substitution table (one with 676 columns, in the case of a twenty-six-letter alphabet) and a larger ciphertext.</p>
<h3 id="h2-502727c16-0011"><a class="XrefDestination" id="SuccessstorySomedigraphchallenges"/><span class="XrefDestination" id="xref-502727c16-027"/>Success story: Some digraph challenges</h3>
<p class="BodyFirst">Because researchers have published little in the field of general digraph substitution, Klaus decided to challenge his blog readers with digraph cryptograms. This led to a series of notable codebreaking records:</p>
<ul class="disc">
<li>In February 2017, on his blog, Klaus published two digraph challenges: “Bigram 5000” and “Bigram 2500.”<sup class="endnote"><a href="b06.xhtml#c16-endnote-21" id="c16-noteref-21">21</a></sup> <em>Bigram</em> is another word for <em>digraph</em>, while 2,500 and 5,000 were the number of letters contained in the challenge ciphertexts. Within three days, German codebreaker Norbert Biermann, supported by Armin Krauß, found both plaintexts with a hill-climbing program of Norbert’s own design.</li>
<li>Two years later, in July 2019, Klaus created a new and even shorter challenge. This time, the ciphertext consisted of only 1,346 letters: the “Bigram 1346.”<sup class="endnote"><a href="b06.xhtml#c16-endnote-22" id="c16-noteref-22">22</a></sup> Four weeks later, Biermann once again broke this challenge, setting a new record.<sup class="endnote"><a href="b06.xhtml#c16-endnote-23" id="c16-noteref-23">23</a></sup></li>
<li>A few months later, in October 2019, Klaus challenged his readers yet again with an even shorter ciphertext of the same kind, consisting of exactly 1,000 letters.<sup class="endnote"><a href="b06.xhtml#c16-endnote-24" id="c16-noteref-24">24</a></sup> Again, the cryptogram was broken quickly, setting another record. This time, the solution came from two blog readers: Jarl Van Eycke of Belgium and Louie Helm of Switzerland, who worked together.<sup class="endnote"><a href="b06.xhtml#c16-endnote-25" id="c16-noteref-25">25</a></sup> They solved the challenge with a highly sophisticated hill-climbing program that included a fitness function based on octagraph frequencies. Given that a twenty-six-letter alphabet can generate approximately 200 billion eight-letter blocks, the codebreakers needed huge amounts of text to generate useful reference statistics. They used about two terabytes of English text taken from a database they created from millions of books, all of Wikipedia, seven billion words extracted from Usenet posts, and more.</li>
<li>Two months later, in December 2019, Klaus published an even shorter challenge, consisting of only 750 letters: “Bigram 750.”<sup class="endnote"><a href="b06.xhtml#c16-endnote-26" id="c16-noteref-26">26</a></sup> Again, Van Eycke and Helm solved it within two days.<sup class="endnote"><a href="b06.xhtml#c16-endnote-27" id="c16-noteref-27">27</a></sup></li>
<li>After Van Eycke and Helm’s success, Klaus published the “Bigram 600” challenge in March 2020 (see <span class="xref" itemid="xref_target_Chapter 12"><a href="c12.xhtml">Chapter 12</a></span>).</li>
</ul>
<p>As of this writing, the “Bigram 750” ciphertext remains the shortest general digraph cryptogram ever solved.</p>
<h2 id="h1-502727c16-0007"><span epub:type="pagebreak" id="Page_354" title="354"/><a class="XrefDestination" id="SolvingaPlayfaircipherwithhillclimbing"/><span class="XrefDestination" id="xref-502727c16-028"/>Solving a Playfair cipher with hill climbing</h2>
<p class="BodyFirst">Hill climbing has proven very efficient for breaking Playfair cryptograms. It works much better than the manual codebreaking technique we introduced in <span class="xref" itemid="xref_target_Chapter 12.">Chapter 12.</span> It is also superior to a dictionary attack, as it doesn’t require the codebreaker to derive the Playfair matrix from a guessable keyword.</p>
<p>To introduce a small change in the Playfair matrix, all we need to do is switch the positions of two letters. Defining a fitness function is also straightforward, because we can rely on letter frequencies to judge whether a plaintext candidate looks like real language. Using the frequencies of other <em>n</em>-graphs (ranging from digraphs to octagraphs) can be even more helpful for deducing the final plaintext.</p>
<p>How quickly could a computer handle this task? The software CrypTool 2 features a powerful Playfair hill climber, named Playfair Analyzer, which includes a fitness function based on hexagraph frequencies. Esslinger, the head of the CrypTool project, showed us how this component performed on a Playfair cryptogram from Dorothy L. Sayers’s 1932 novel <em>Have His Carcase</em>. In <span class="xref" itemid="xref_target_Chapter 12"><a href="c12.xhtml">Chapter 12</a></span>, we dedicated multiple pages to describing how difficult this same cryptogram is to break without computer support. <a href="#figure16-5" id="figureanchor16-5">Figure 16-5</a> shows how Playfair Analyzer works.</p>
<figure>
<img alt="" class="keyline" height="386" src="image_fi/502727c16/f16004.png" width="820"/>
<figcaption><p><a id="figure16-5">Figure 16-5</a>: The software CrypTool 2, running on a PC, breaks the Playfair cryptogram from Dorothy L. Sayers’s novel <em>Have His Carcase</em> within a minute.</p></figcaption>
</figure>
<p>After the user has copied the ciphertext into the left window and started the hill climber, the software displays every climbing step in the middle window. CrypTool 2 needs about a minute to produce both the cryptogram’s key and the plaintext. Even an experienced codebreaker would require hours to perform this task without computer support.</p>
<p>The software displays the following correct Playfair matrix, written on one line, in the lower-right window. It uses the keyword <code class="bold">MONARCHY</code>:</p>
<p class="BodyCustom"><code>MONAR|CHYBD|EFGIK|LPQST|UVWXZ</code></p>
<p><span epub:type="pagebreak" id="Page_355" title="355"/>You can see the plaintext in the upper-right window or reproduced in <span class="xref" itemid="xref_target_Chapter 12"><a href="c12.xhtml">Chapter 12</a></span>.</p>
<h3 id="h2-502727c16-0012"><a class="XrefDestination" id="SuccessstoryDanGirard’ssolutiontotheCheltenhamLetterStone"/><span class="XrefDestination" id="xref-502727c16-029"/>Success story: Dan Girard’s solution to the Cheltenham Letter Stone</h3>
<p class="BodyFirst">In 2005, British artist Gordon Young created the <em>Listening Stones</em> in Cheltenham, United Kingdom (see <span class="xref" itemid="xref_target_Chapter 4"><a href="c04.xhtml">Chapter 4</a></span>). Two of these ten-foot-tall stones, called the Number Stone and the Letter Stone, bear encrypted inscriptions. Here is the message on the Letter Stone, as provided to us by the sculptor:</p>
<p class="BodyCustom"><code>EC KH LO PT OA DL LU AB KW LO YS NA EC BF MZ FA LC NQ XR UT DK</code></p>
<p class="BodyCustom"><code>SQ KH EC ZK NL CK SQ CB SA SA QU LF MZ IV FA LC OA VB OK CK AV</code></p>
<p class="BodyCustom"><code>DY SY LO WL KL NI BH BX LO MY VA EK AP LB CW PY OA OK MO AV BL</code></p>
<p class="BodyCustom"><code>VM PK LC UP BY KQ MK BN AN BF GA YM LO AK NI BP PI HT TI NT CV</code></p>
<p class="BodyCustom"><code>EC FI LW CQ GL TI KL NI BH RP GZ SU LQ AS YT GA VB FW NM XC UP</code></p>
<p class="BodyCustom"><code>EB NA WL ID PM ZK LM WL RO VI AO LC IC VI KQ FW OA PA XC UP EQ</code></p>
<p class="BodyCustom"><code>SO PM QU MB PU CL VA KI OM NE LM BF UP IG BC FR LO CV KI OM VT</code></p>
<p class="BodyCustom"><code>BF YF IP EQ CQ SX NK MZ CQ YS GZ BF UI XD SQ QK AG KL SQ YF PM</code></p>
<p class="BodyCustom"><code>RF TV KE CW LW ME VA KN UP FA UI FI KM NQ XR AV TR LO CV EL NL</code></p>
<p class="BodyCustom"><code>LQ FY UP PN NK IG NO BN EC NP BF GA NE HM IV FY DQ LM YF DQ AM</code></p>
<p class="BodyCustom"><code>BP NI KF LU BN RY UK NA KI OM WF SO OK KQ OA BL KL QA BL VK CK</code></p>
<p class="BodyCustom"><code>HL MP TO AG QT PI HL TI NT CV EC IA SL LM YF RL HT IP PS CW CW</code></p>
<p><a href="#figure16-6" id="figureanchor16-6">Figure 16-6</a> shows the sculpture. When Klaus learned about this cryptogram in 2015, it was still unsolved. According to the sculptor, the digraphs on the stone were a message encrypted using a Playfair cipher. However, he didn’t remember the details of the encryption, let alone the key.</p>
<figure>
<img alt="" class="" height="419" src="image_fi/502727c16/f16005.png" width="474"/>
<figcaption><p><a id="figure16-6">Figure 16-6</a>: The Letter Stone, a sculpture located next to the GCHQ Headquarters in Cheltenham, UK, bears a Playfair-encrypted inscription, arrows, and letter pairs within each of the circles.</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_356" title="356"/>Klaus published an article about this cryptogram on his blog in September 2015.<sup class="endnote"><a href="b06.xhtml#c16-endnote-28" id="c16-noteref-28">28</a></sup> After only a few hours, blog reader Dan Girard posted the solution, having broken it with his own hill-climbing program. It turned out that the keyword was <code class="bold">LECKHAMPTON</code>. Here’s the beginning of the plaintext:</p>
<p class="BodyCustom"><code>LECKHAMPTON CHIMNEY HAS FALLEN DOWN</code></p>
<p class="BodyCustom"><code>THE BIRDS OF CRICKLEY HAVE CRIED IT IT IS KNOWN IN THE TOWN</code></p>
<p class="BodyCustom"><code>THE CLIFXFS HAVE CHANGED WHAT WILL COME NEXT XTO THAT LINE</code></p>
<p class="BodyCustom"><code>WATCHER OF WEST ENGLAND NOW THAT LANDMARK OAS FALXLEN . . .</code></p>
<p>Devil’s Chimney is a rock formation at Leckhampton Hill, near Cheltenham.</p>
<h3 id="h2-502727c16-0013"><a class="XrefDestination" id="SuccessstoryPlayfairworldrecords"/><span class="XrefDestination" id="xref-502727c16-030"/>Success story: Playfair world records</h3>
<p class="BodyFirst">In <span class="xref" itemid="xref_target_Chapter 12"><a href="c12.xhtml">Chapter 12</a></span>, we mentioned that in 1936, the American cryptanalyst Alf Monge broke a thirty-letter Playfair message based on a keyword.<sup class="endnote"><a href="b06.xhtml#c16-endnote-29" id="c16-noteref-29">29</a></sup> In 2018, Klaus wanted to know how short a Playfair cryptogram a codebreaker could solve if the matrix was not keyword based, meaning a dictionary attack wouldn’t work. Thus, he presented a series of increasingly difficult Playfair challenges on his blog, along with corresponding solutions provided by readers. Most of the codebreaking work depended on hill climbing and simulated annealing.</p>
<p>As far as we are aware, the cryptanalysis results produced over the course of these challenges represent the best results of such an experiment. This means that they set world records, the last of which is still valid as of this writing. We and the challenge solvers published these codebreaking success stories in an article titled “How We Set New World Records in Breaking Playfair Ciphertexts,” in <em>Cryptologia</em>.<sup class="endnote"><a href="b06.xhtml#c16-endnote-30" id="c16-noteref-30">30</a></sup> In the following, we will present a summary of this article.</p>
<p>In April 2018, Klaus published on his blog a fifty-letter Playfair message not based on a keyword:<sup class="endnote"><a href="b06.xhtml#c16-endnote-31" id="c16-noteref-31">31</a></sup></p>
<p class="BodyCustom"><code>MQ VS KP EV IS BA WK TP KP PN AU NU NE GL UZ TY UZ LY GC TZ KN KU ST AG CT NQ</code></p>
<p>The challenge didn’t remain a mystery for long; our colleague George Lasry solved it on the same day with a simulated annealing program of his own design. His fitness function used statistics about hexagraphs. Here’s the plaintext:</p>
<p class="BodyCustom"><code>WHILE IN PARIS I RECEIVED ORDERS TO REPORT X TO GENERAL FOSTER X</code></p>
<p>In December 2018, Klaus created another challenge, based on a plaintext with only forty letters:<sup class="endnote"><a href="b06.xhtml#c16-endnote-32" id="c16-noteref-32">32</a></sup></p>
<p class="BodyCustom"><code>OF FC ER VU MW MO OM RU FI WC MA OG FV ZY FX YB HG UX ZV EH</code></p>
<p>This time, German codebreaker Nils Kopal, the developer of CrypTool 2, was the one to post the solution on the same day. He had applied the same simulated-annealing algorithm written by George, <span epub:type="pagebreak" id="Page_357" title="357"/>including his hexagraph-based fitness function. The software delivered the following solution:<sup class="endnote"><a href="b06.xhtml#c16-endnote-33" id="c16-noteref-33">33</a></sup></p>
<p class="BodyCustom"><code>MEET YOU TOMORROW AT FOUR TWENTY AT MARKET PLACE</code></p>
<p>Next, in April 2019, Klaus published a thirty-two-letter Playfair cryptogram based on a thirty-letter plaintext:<sup class="endnote"><a href="b06.xhtml#c16-endnote-34" id="c16-noteref-34">34</a></sup></p>
<p class="BodyCustom"><code>SX CR ED BQ UG VZ RS MN DS IK RK WR SG NS NX VM</code></p>
<p>The challenge proved more difficult than the previous ones, as no solution popped up that day, week, or even month. However, five months later, in September 2019, Magnus Ekhall from Sweden deciphered the message with simulated annealing and again set a new record. His fitness function used the frequencies of five-letter groups (pentagraphs). The plaintext read as follows and included two <code class="bold">X</code>s as filler characters:<sup class="endnote"><a href="b06.xhtml#c16-endnote-35" id="c16-noteref-35">35</a></sup></p>
<p class="BodyCustom"><code>TAKE THE LAST X TRAIN TO YORK ON SUNDAY X</code></p>
<p>In September 2019, Klaus created a new Playfair challenge—this time with twenty-eight letters:<sup class="endnote"><a href="b06.xhtml#c16-endnote-36" id="c16-noteref-36">36</a></sup></p>
<p class="BodyCustom"><code>ZX LS EW HC HU CE LQ OE PN YR IW YC VQ LS</code></p>
<p>Again, Magnus Ekhall came up with the solution. The process, however, made it clear that a twenty-eight-letter Playfair message was considerably more difficult to break than one with thirty-two letters. Using simulated annealing, Magnus’s software produced 100,000 solution candidates. Magnus then wrote an additional program to determine the correct candidate, reproduced here:<sup class="endnote"><a href="b06.xhtml#c16-endnote-37" id="c16-noteref-37">37</a></sup></p>
<p class="BodyCustom"><code>STAY WHERE YOU ARE UNTIL THURSDAY</code></p>
<p>Continuing the experiment, Klaus published a twenty-six-letter challenge in November 2019:<sup class="endnote"><a href="b06.xhtml#c16-endnote-38" id="c16-noteref-38">38</a></sup></p>
<p class="BodyCustom"><code>DB AQ IH KN RW VB KW NA DQ WR AM OQ IY</code></p>
<p>Four weeks later, the solution was posted by a person thus far unknown in the codebreaking community: Konstantin Hamidullin, from Riga, Latvia. Here’s the plaintext:<sup class="endnote"><a href="b06.xhtml#c16-endnote-39" id="c16-noteref-39">39</a></sup></p>
<p class="BodyCustom"><code>WAIT FOR FURTHER INSTRUCTIONS</code></p>
<p>Surprisingly, Konstantin (who has since become a working colleague of ours) had found this solution with neither a hill climber nor a simulated-annealing algorithm but with his own unique method, which performed a kind of dictionary attack against the first words of the plaintext. This attack required a list, or dictionary, of word groups that frequently appear at the beginning of English sentences. For instance, <code class="bold">ONCEUPONATIME</code> or <code class="bold">THEQUESTIONWEWILLDISCUSSTODAY</code> could appear in such a list.</p>
<p>As Konstantin couldn’t find an existing collection that would suit his needs, he decided to create one. For this purpose, he turned to Project Gutenberg, a digital library that collects the full texts of tens of thousands of books in the public domain. He wrote a software program that worked <span epub:type="pagebreak" id="Page_358" title="358"/>through about 3,000 English-language books and generated a list of the most frequent word groups that appeared at the start of all the sentences.</p>
<p>Konstantin’s codebreaking software then used the more frequent entries on this list as cribs for the beginning of the plaintext. Next, it checked whether a Playfair matrix existed that would lead from the crib to the corresponding ciphertext. In many instances, this was not the case: for example, the word group <code class="bold">THISIS</code> cannot encode to <code>DBAQIH</code>, as the repetition of <code class="bold">IS</code> would lead to a repetition in the ciphertext not present here. If, for a certain crib, a Playfair matrix existed, the software would extend the word group by another likely word—for instance, <code class="bold">ONCEUPONATIME</code> could become <code class="bold">ONCEUPONATIMETHERE</code>—and test again.</p>
<p>The breakthrough came when Konstantin’s software received a positive result for the word group <code class="bold">WAITFOR</code> and successfully extended it to <code class="bold">WAITFORFURTHER</code>. When it added <code class="bold">INSTRUCTIONS</code> as the fourth word and rendered a positive result, the solution was found.</p>
<p>Lastly, Klaus published a twenty-four-letter challenge, which you can find in <span class="xref" itemid="xref_target_Chapter 12"><a href="c12.xhtml">Chapter 12</a></span>. As of this writing, the twenty-six-letter Playfair cryptogram solved by Konstantin is the shortest one ever deciphered. If you would like to try to break this record, try your luck at the twenty-four-letter one. To find out whether or not this challenge is still active, check out <a class="LinkURL" href="https://codebreaking-guide.com/errata/">https://codebreaking-guide.com/errata/</a>.</p>
<h2 id="h1-502727c16-0008"><a class="XrefDestination" id="Solvingmachinecipherswithhillclimbing"/><span class="XrefDestination" id="xref-502727c16-031"/>Solving machine ciphers with hill climbing</h2>
<p class="BodyFirst">Hill climbing works not only for most substitutions and transpositions but also for the more sophisticated ciphers of the encryption machine era (which spanned roughly 1920 to 1970 and is discussed in <span class="xref" itemid="xref_target_Chapter 15"><a href="c15.xhtml">Chapter 15</a></span>). Most importantly, hill climbing proved extremely successful for breaking Enigma messages.</p>
<h3 id="h2-502727c16-0014"><a class="XrefDestination" id="SuccessstoryBreakingoriginalEnigmamessages"/><span class="XrefDestination" id="xref-502727c16-032"/>Success story: Breaking original Enigma messages</h3>
<p class="BodyFirst">The exact number isn’t known, but experts estimate that the Germans transmitted about a million Enigma messages during World War II.<sup class="endnote"><a href="b06.xhtml#c16-endnote-40" id="c16-noteref-40">40</a></sup> For security reasons, radio operators usually destroyed any record of a ciphertext after decryption, which is why most original Enigma messages are lost today. Luckily, there are exceptions, and a few thousand Enigma messages from the war are preserved in archives, museums, or private collections. Of course, researchers may discover more of these messages in the future.</p>
<p>Over the last two decades, several Enigma enthusiasts have tried to break original Enigma cryptograms—with considerable success. We are aware of the following projects:</p>
<ul class="disc">
<li><em>M4 Project</em>: This is an effort by German violinist Stefan Krah to break three original German Navy messages from World War II, which were encrypted with the four-rotor Enigma M4.<sup class="endnote"><a href="b06.xhtml#c16-endnote-41" id="c16-noteref-41">41</a></sup> The goal was to find the solutions with the help of distributed computing. Thousands of people <span epub:type="pagebreak" id="Page_359" title="359"/>downloaded software that Krah had written for this purpose and provided CPU resources. The M4 project succeeded in breaking two of the messages in 2006. The third one was solved seven years later, in 2013.</li>
<li><em>Breaking German Wehrmacht Ciphers</em>: This is an ongoing project started by Geoff Sullivan and Frode Weierud in 2002.<sup class="endnote"><a href="b06.xhtml#c16-endnote-42" id="c16-noteref-42">42</a></sup> Olaf Ostwald later joined the effort. Together, they have broken hundreds of original Enigma ciphertexts, including radio messages from the Flossenbürg concentration camp and Germany’s Russia campaign (Operation Barbarossa).</li>
<li><em>Breaking German Navy Ciphers</em>: This is another ongoing project that aims to break original Enigma messages. It was started in 2012 by German schoolteacher Michael Hörenberg.<sup class="endnote"><a href="b06.xhtml#c16-endnote-43" id="c16-noteref-43">43</a></sup> As of this writing, he and his cryptanalytic partner Dan Girard have succeeded in deciphering over sixty Enigma cryptograms.</li>
</ul>
<p>The people involved in these projects have developed computer-based Enigma-breaking techniques that are much more powerful than the methods used by the British in Bletchley Park during the war. Many of these are based on hill climbing. Most of the original Enigma messages that are known to exist have been broken. The only exceptions tend to be very short messages or ciphertexts that likely contain errors.</p>
</section>
</div></body></html>