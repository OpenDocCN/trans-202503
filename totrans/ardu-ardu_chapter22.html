<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" lang="en" xml:lang="en">
<head>
<title>Arduino for Arduinians</title>
<meta content="text/html; charset=utf-8" http-equiv="default-style"/>
<link href="../styles/stylesheet.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:67118b6d-3178-4c1c-99a1-6e412fe74179" name="Adept.expected.resource"/>
</head>
<body epub:type="bodymatter">
<section aria-labelledby="ch22" epub:type="chapter" role="doc-chapter">
<header>
<h1 class="CHAPTER" id="ch22">
<span class="CN"><span aria-label=" Page 385. " epub:type="pagebreak" id="pg_385" role="doc-pagebreak"/><samp class="SANS_Futura_Std_Bold_Condensed_B_11">22</samp></span>
<span class="CT"><samp class="SANS_Dogma_OT_Bold_B_11">CAPTURE AND LOG DATA TO GOOGLE SHEETS</samp></span>
</h1>
</header>
<figure class="opener"><img alt="" class="opener" src="../images/opener-img.png"/>
</figure>
<p class="INTRO">You can use internet-connected boards like the ESP32 to capture data and store it in online spreadsheets for real-time monitoring and later analysis. In this chapter, you’ll use this method to build a single project that sends time and temperature data to a Google Sheets spreadsheet tool within Google Workspace, a collection of cloud-computing collaboration tools that are accessible from most web-enabled devices.</p>
<p class="TX">You can use this framework in future projects to record any other type of data you can gather with Arduino-compatible projects. For example, you might want to share weather data at a remote location with other colleagues or monitor sensor values in a laboratory experiment from your cell phone while on holiday elsewhere.</p>
<p class="HeadProject"><span id="h1-160"/><span aria-label=" Page 386. " epub:type="pagebreak" id="pg_386" role="doc-pagebreak"/><samp class="SANS_Futura_Std_Heavy_B_21">Project #65: Logging Time and Temperature Data</samp></p>
<p class="TNI">This project demonstrates how to send the time and date from an NTP server, along with the temperature and air pressure from a BMP180 sensor board, to Google Workspace’s Google Sheets tool via the ESP32 board.</p>
<p class="TX">You’ll need the following hardware:</p>
<ul class="ul">
<li class="BL">An ESP32 dev board and matching USB cable</li>
<li class="BL">A solderless breadboard</li>
<li class="BL">Assorted jumper wires</li>
<li class="BL">A BMP180 temperature and pressure sensor board</li>
</ul>
<p class="TX">If you haven’t already, turn to <span class="Xref"><a href="chapter19.xhtml">Chapter 19</a></span> and complete the instructions in <span class="Xref">“</span>Configuring <span class="Xref">the Arduino IDE for the ESP32”</span> through <span class="Xref">“Testing the ESP32”</span> to get your ESP32 working. Also make sure you’ve completed <span class="Xref">“BMP180 Sensors”</span> in <span class="Xref"><a href="chapter10.xhtml">Chapter 10</a></span> and read <span class="Xref"><a href="chapter21.xhtml">Chapter 21</a></span> to familiarize yourself with NTP servers.</p>
<p class="TX">To build this project, you’ll start by configuring a Google Workspace account to receive data from the ESP32 and then set up the ESP32 board and sensor for data transmission.</p>
<section aria-labelledby="sec1" epub:type="division">
<h2 class="H1" id="sec1"><span id="h1-161"/><samp class="SANS_Futura_Std_Bold_B_11">Preparing the Google Sheets Document</samp></h2>
<p class="TNI">Google Sheets is a cloud-based spreadsheet included as part of the Google Workspace cloud-based product. If you don’t already have one, set up a Google Workspace account at <a href="https://workspace.google.com"><i>https://<wbr/>workspace<wbr/>.google<wbr/>.com</i></a>. A free trial is available if you want to experiment without commitment, but at time of writing, the price for a monthly subscription is less than US$10 a month.</p>
<p class="TX">Once you’ve logged into your account, visit <a href="https://docs.google.com/spreadsheets"><i>https://<wbr/>docs<wbr/>.google<wbr/>.com<wbr/>/spreadsheets</i></a> to view the Google Sheets start page, as shown in <a href="chapter22.xhtml#fig22-1">Figure 22-1</a>.</p>
<figure class="IMG"><img alt="A SCREENSHOT OF THE GOOGLE SHEETS START PAGE" class="img1" id="fig22-1" src="../images/fig22-1.png"/>
<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 22-1: The Google Sheets start page</samp></p></figcaption>
</figure>
<p class="TX">Create a new, blank spreadsheet by clicking the <b>Blank</b> icon under Start a new spreadsheet. A new tab for that spreadsheet will appear, as shown in <a href="chapter22.xhtml#fig22-2">Figure 22-2</a>.<span aria-label=" Page 387. " epub:type="pagebreak" id="pg_387" role="doc-pagebreak"/></p>
<figure class="IMG"><img alt="A SCREENSHOT OF THE BLANK SPREADSHEET" class="img1" id="fig22-2" src="../images/fig22-2.png"/>
<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 22-2: A blank spreadsheet</samp></p></figcaption>
</figure>
<p class="TX">Click <b>Untitled spreadsheet</b> and enter an appropriate name for a spreadsheet that tracks temperature and air pressure data for your location—for example, <b>OfficeWeather</b>—and then press <small>ENTER</small>. Next, rename the page label at the bottom of the page from Sheet1 to <b>office</b>.</p>
<p class="TX">Now give the columns in row 1 the following headings, starting from cell A1, as shown in <a href="chapter22.xhtml#fig22-3">Figure 22-3</a>: <b>date, month, year, hour, minute, second, temperature, airpressure</b>. These will match the data sent from the ESP32 board, as you’ll see shortly.</p>
<figure class="IMG"><img alt="A SCREENSHOT OF THE PREPARED SPREADSHEET" class="img1" id="fig22-3" src="../images/fig22-3.png"/>
<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 22-3: The spreadsheet setup, with names and data headings</samp></p></figcaption>
</figure>
<p class="TX">Note that column headings in Google Sheets, must always be lowercase and not contain any spaces or symbols.</p>
<p class="TX">Wait for Google to automatically save the sheet, then retrieve and save the sheet ID. This is the long group of characters between <i>/d</i> and <i>/edit</i> in the sheet’s URL, as shown in <a href="chapter22.xhtml#fig22-4">Figure 22-4</a>. Copy the sheet ID and paste it into a text document so you can easily retrieve it later.<span aria-label=" Page 388. " epub:type="pagebreak" id="pg_388" role="doc-pagebreak"/></p>
<figure class="IMG"><img alt="A SCREENSHOT OF THE SHEET’S ID IN THE URL" class="img1" id="fig22-4" src="../images/fig22-4.png"/>
<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 22-4: Example of a sheet ID highlighted in a URL</samp></p></figcaption>
</figure>
<p class="TX">Your sheet is now ready to receive data. For now, leave it open in the web browser.</p>
</section>
<section aria-labelledby="sec2" epub:type="division">
<h2 class="H1" id="sec2"><span id="h1-162"/><samp class="SANS_Futura_Std_Bold_B_11">The Google Apps Script</samp></h2>
<p class="TNI">Your ESP32 hardware will send data to your Google sheet by making an HTTP call with the data attached to the end of the HTTP address. To enable that process, you must upload a small piece of JavaScript code to the Google servers that decodes HTTP calls from the ESP32 board, separating the data and placing it in the correct column in the sheet.</p>
<p class="TX">Open the Google Apps script tool by selecting <b>Extensions</b> <img alt="" class="inline" src="../images/arr.png"/> <b>Apps Script</b> in Google Sheets.</p>
<p class="TX">A new tab for the Apps Script editor will open in the web browser, as shown in <a href="chapter22.xhtml#fig22-5">Figure 22-5</a>.</p>
<figure class="IMG"><img alt="A SCREENSHOT OF THE APPS SCRIPT EDITOR" class="img1" id="fig22-5" src="../images/fig22-5.png"/>
<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 22-5: Opening a new tab</samp></p></figcaption>
</figure>
<p class="TX">Click <b>Untitled project</b> and enter a name for the script, such as <b>OfficeWeatherScript</b>. Copy the following code and paste it over the text in line 1 of the editor:</p>

<pre><code>var sheet_id = "<var>sheet_ID</var>";
var sheet_name = "office";
function doGet(e)
{
    var ss = SpreadsheetApp.openById(sheet_id);
    var sheet = ss.getSheetByName(sheet_name);
    var date = Number(e.parameter.date);
    var month = Number(e.parameter.month);
    var year = Number(e.parameter.year);
    var hour = Number(e.parameter.hour);
    var minute = Number(e.parameter.minute);
<span aria-label=" Page 389. " epub:type="pagebreak" id="pg_389" role="doc-pagebreak"/>    var second = Number(e.parameter.second);
    var temperature = Number(e.parameter.temperature);
    var airpressure = Number(e.parameter.airpressure);
    sheet.appendRow([date,month,year,hour,minute,second,temperature,airpressure]);
}</code></pre>

<p class="TX">Insert the sheet ID you retrieved earlier between the quotes in the first line of the code. The sheet label name, <samp class="SANS_TheSansMonoCd_W5Regular_11">office</samp>, appears between the quotes in the next line. Each column of data to store is represented by the <samp class="SANS_TheSansMonoCd_W5Regular_11">var</samp> declarations in the order they appear across row 1 of the spreadsheet (<samp class="SANS_TheSansMonoCd_W5Regular_11">date</samp> to <samp class="SANS_TheSansMonoCd_W5Regular_11">airpressure</samp>).</p>
<p class="TX">Finally, the <samp class="SANS_TheSansMonoCd_W5Regular_11">sheet.appendrow()</samp> function writes the received data to a new row in the spreadsheet. The order in which the variables appear in the function determines the order in which the data is written to the sheet. Each set of data received will be saved to the next empty row, until you hit the maximum of 40,000 rows in a Google sheet. From that point, you cannot log any more data.</p>
<p class="TX">Your editor page should now resemble <a href="chapter22.xhtml#fig22-6">Figure 22-6</a>. The script editor will highlight any syntax errors, so check for errors before moving on.</p>
<figure class="IMG"><img alt="A SCREENSHOT OF THE COMPLETED APP SCRIPT" class="img8" id="fig22-6" src="../images/fig22-6.png"/>
<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 22-6: The completed app script</samp></p></figcaption>
</figure>
<p class="TX">To deploy the script, select <b>Deploy</b> <img alt="" class="inline" src="../images/arr.png"/> <b>New deployment</b>. When the New deployment window appears, click the gear icon to select the deployment type. In the drop-down menu that appears, click <b>Web app</b> to open the configuration dialog, which has three fields.</p>
<p class="TX">You will be presented with the Configuration dialog, which has three fields. In the first, New Description, enter <b>OfficeWeather</b> (or whatever you chose to name your sheet). Select <b>Me</b> for the Web app field, and select <b>Anyone</b> for the Who has access field, as shown in <a href="chapter22.xhtml#fig22-7">Figure 22-7</a>. Click <b>Deploy</b>.<span aria-label=" Page 390. " epub:type="pagebreak" id="pg_390" role="doc-pagebreak"/></p>
<figure class="IMG"><img alt="A SCREENSHOT OF THE DEPLOYMENT CONFIGURATION PAGE" class="img8" id="fig22-7" src="../images/fig22-7.png"/>
<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 22-7: The deployment configuration page</samp></p></figcaption>
</figure>
<p class="TX">A pop-up should prompt you to authorize access to the account. Click <b>Authorize access</b>.</p>
<p class="TX">If prompted to log into your Google account again, do so. You will be presented with a new window showing your spreadsheet’s deployment ID and web app URL.</p>
<p class="TX">Use the Copy links in the window to copy each of the items and save them in the document containing your sheet ID. You can now close the Apps Script tab in the web browser.</p>
<p class="TX">Before setting up this project’s hardware, test that your script is working. Using a text editor, enter the web app URL on a new line and then add the following text to the end of the URL:</p>

<pre><code><b>?date=12&amp;month=1&amp;year=2023&amp;hour=12&amp;minute=37&amp;second=30&amp;temperature=28.5&amp;airpressure=9999</b></code></pre>

<p class="TX">The text appended to the URL describes the data being sent to the spreadsheet in the format <samp class="SANS_TheSansMonoCd_W5Regular_Italic_I_11">column</samp> <samp class="SANS_TheSansMonoCd_W5Regular_11">=</samp><samp class="SANS_TheSansMonoCd_W5Regular_Italic_I_11">data</samp>, with each column and data pair separated by a question mark. The data in this line of code is intended just to test the script—you’ll program the ESP32 dev board to send its own data shortly.</p>
<p class="TX">Copy the entire URL into the address field of a web browser and press <small>ENTER</small>. Two things should happen. First, the web browser should return a message telling you that the script completed but did not return anything, as shown in <a href="chapter22.xhtml#fig22-8">Figure 22-8</a>.<span aria-label=" Page 391. " epub:type="pagebreak" id="pg_391" role="doc-pagebreak"/></p>
<figure class="IMG"><img alt="A SCREENSHOT OF THE MESSAGE RETURNED BY THE GOOGLE APPS SCRIPT" class="img7" id="fig22-8" src="../images/fig22-8.png"/>
<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 22-8: A message returned by the Google Apps script</samp></p></figcaption>
</figure>
<p class="TX">The message means the script worked but didn’t send any data back to the web browser. That’s okay—the data went to the spreadsheet instead. Check your sheet and you should see the data on a new row, as shown in <a href="chapter22.xhtml#fig22-9">Figure 22-9</a>. If you like, you can go back and edit the data at the end of the entered URL, resubmit the URL, and see another row of data entered into the spreadsheet.</p>
<figure class="IMG"><img alt="A SCREENSHOT OF THE SPREADSHEET AFTER A SUCCESSFUL HTML CALL" class="img1" id="fig22-9" src="../images/fig22-9.png"/>
<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 22-9: The spreadsheet after a successful HTML call</samp></p></figcaption>
</figure>
<p class="TX">This process is the basis for data logging from the ESP32: the sketch will arrange the data captured from the sensor along with the time and date into one URL and then perform an HTTP call that the Google Apps script you created earlier will process to enter data into the spreadsheet. If this test didn’t work for you, check that you’ve correctly followed all instructions provided in the project up to this point.</p>
</section>
<section aria-labelledby="sec3" epub:type="division">
<h2 class="H1" id="sec3"><span id="h1-163"/><samp class="SANS_Futura_Std_Bold_B_11">Preparing the Hardware</samp></h2>
<p class="TNI">Assemble your hardware as shown in <a href="chapter22.xhtml#fig22-10">Figure 22-10</a>. Note that although your BMP180 board may be marked as a 5 V device, it will work on 3.3 V and the ESP32 board without a level converter.</p>
<figure class="IMG"><img alt="THE SCHEMATIC FOR PROJECT #65" class="img4" id="fig22-10" src="../images/fig22-10.png"/>
<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 22-10: The schematic for Project #65</samp></p></figcaption>
</figure>
<p class="TX"><span aria-label=" Page 392. " epub:type="pagebreak" id="pg_392" role="doc-pagebreak"/>Enter and upload the sketch, including your Wi-Fi network name (SSID) and password in the fields toward the beginning of the program, as originally explained in <span class="Xref">Project #55</span> in <span class="Xref"><a href="chapter19.xhtml">Chapter 19</a></span>. Don’t forget to change the offset for your time zone, as described in <span class="Xref">“Network Time Protocol”</span> in <span class="Xref"><a href="chapter21.xhtml">Chapter 21</a></span>, and insert your web app URL into the appropriate field. The ESP32 should connect to the Wi-Fi network and then retrieve the time and date from an NTP server and the temperature and air pressure from the BMP180. It should combine the data into a string comprised of the web app URL and the data and then complete a HTTP call to the Google server.</p>
<p class="TX">A moment later, you should see the data appear in the spreadsheet. Leave the sheet open to see it update nearly in real time, as shown in <a href="chapter22.xhtml#fig22-11">Figure 22-11</a>.</p>
<figure class="IMG"><img alt="A SCREENSHOT OF THE EXAMPLE OUTPUT FROM PROJECT #65" class="img8" id="fig22-11" src="../images/fig22-11.png"/>
<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 22-11: Example output from Project #65</samp></p></figcaption>
</figure>
<p class="TX">Let’s see how this works:</p>
<span id="pro-65"/>

<pre><code>// Project #65 - Logging time and temperature data to Google Sheets

#include &lt;WiFi.h&gt;
#include &lt;HTTPClient.h&gt;
#include &lt;NTPClient.h&gt;
#include &lt;WiFiUdp.h&gt;
#include &lt;Adafruit_BMP085.h&gt;

WiFiUDP ntpUDP;
Adafruit_BMP085 bmp;

const char* ssid = "<var>SSID</var>";
const char* password = "<var>password</var>";

// ntpUDP, time server pool, offset in seconds, update interval (mS)
NTPClient timeClient(ntpUDP, "0.au.pool.ntp.org", 36000, 60000);

<span aria-label=" Page 393. " epub:type="pagebreak" id="pg_393" role="doc-pagebreak"/><span aria-label="annotation1" class="CodeAnnotationHang">❶</span> String webAppURL = "<var>webapp_URL</var>";

unsigned long lastUpdate = 0;
<span aria-label="annotation2" class="CodeAnnotationHang">❷</span> unsigned long updatePeriod = 20000; // 20 seconds

void setup()
{
  <span aria-label="annotation3" class="CodeAnnotationHang1">❸</span> bmp.begin();
    Serial.begin(115200);
    WiFi.mode(WIFI_STA);
    WiFi.begin(ssid, password);
    Serial.print("Connecting to Wi-Fi ");
    while (WiFi.status() != WL_CONNECTED)
    {
        Serial.print(".");
        delay(500);
    }
    timeClient.begin();
}

void loop()
{
    String dateString, finalAppURL;
    String date, month, year;
    String hh, mm, ss;
    String temperature, pressure;

  <span aria-label="annotation4" class="CodeAnnotationHang1">❹</span> if ((millis() - lastUpdate) &gt; updatePeriod)
    {
        if (WiFi.status() == WL_CONNECTED)
        {
            HTTPClient http;
            timeClient.update();

            // Extract date from NTP server:
            dateString = timeClient.getFormattedDate();
            date = dateString.substring(8, 10);
            month = dateString.substring(5, 7);
            year = dateString.substring(0, 4);

            // Extract time from NTP server:
            hh = String(timeClient.getHours());
            mm = String(timeClient.getMinutes());
            ss = String(timeClient.getSeconds());

            // Add time and date to web app URL:
          <span aria-label="annotation5" class="CodeAnnotationHang1">❺</span> finalAppURL = webAppURL + "?date=" + date + "&amp;month=";
            finalAppURL += month + "&amp;year=" + year + "&amp;hour=" + hh;
            finalAppURL += "&amp;minute=" + mm + "&amp;second=" + ss;

          <span aria-label="annotation6" class="CodeAnnotationHang1">❻</span> // Get weather data from BMP180:
            temperature = String(bmp.readTemperature());
            pressure = String(bmp.readSealevelPressure());

<span aria-label=" Page 394. " epub:type="pagebreak" id="pg_394" role="doc-pagebreak"/>            // Add weather data to web app URL:
            finalAppURL = finalAppURL + "&amp;temperature=";
            finalAppURL += temperature + "&amp;airpressure=" + pressure;

          <span aria-label="annotation7" class="CodeAnnotationHang1">❼</span> http.begin(finalAppURL.c_str());

          <span aria-label="annotation8" class="CodeAnnotationHang1">❽</span> int httpCode = http.GET(); // Get response code from server
            if (httpCode &gt; 0)
            {
                Serial.print("HTTP Response code: ");
                Serial.println(httpCode);
                String httpMessage = http.getString();
                Serial.println(httpMessage);
            } else
            {
                Serial.print("HTTP error: ");
                Serial.println(httpCode);
            }
        http.end(
        } else
        {
            Serial.println("Wi-Fi problem.");
        }
  <span aria-label="annotation9" class="CodeAnnotationHang1">❾</span> lastUpdate = millis();
    }
}
</code></pre>

<p class="TX">The sketch includes and initializes all required libraries, followed by the fields for your Wi-Fi network’s name and password and then the initialization for the network time server client <span aria-label="annotation1" class="CodeAnnotationCode">❶</span>.</p>
<p class="TX">The sketch then sets the period between sending different data readings to the spreadsheet <span aria-label="annotation2" class="CodeAnnotationCode">❷</span>, in milliseconds. This is the minimum amount of time between updates, but the actual update frequency is determined by the speed of Google’s server and your internet connection. For example, consider the values shown in <a href="chapter22.xhtml#fig22-12">Figure 22-12</a>—even though the demonstration was set to 20 seconds, the actual times recorded were 22 seconds or more. Values of 10 seconds or less may not be recorded, as this doesn’t give the processes enough time to complete the reception and saving of data on the Google server.</p>
<p class="TX">In <samp class="SANS_TheSansMonoCd_W5Regular_11">void setup()</samp>, the usual declarations take place, along with starting the required libraries and the Serial Monitor. The sketch connects to your Wi-Fi network and starts the network time client. The code in <samp class="SANS_TheSansMonoCd_W5Regular_11">void loop()</samp> declares the required string variables used to store the time and temperature data from the network time server and BMP180 sensor, respectively.</p>
<p class="TX">The program includes a calculation to determine whether the required amount of time has elapsed before sending more data <span aria-label="annotation3" class="CodeAnnotationCode">❸</span>. This allows the sketch to proceed when the <samp class="SANS_TheSansMonoCd_W5Regular_11">millis()</samp> count from the last update time is greater than the set period <span aria-label="annotation4" class="CodeAnnotationCode">❹</span>. Once the period has elapsed, it’s time to extract the date and time information from the NTP server and store it in the string variables and then append this data to the web app URL <span aria-label="annotation5" class="CodeAnnotationCode">❺</span>.</p>
<p class="TX"><span aria-label=" Page 395. " epub:type="pagebreak" id="pg_395" role="doc-pagebreak"/>Next, the temperature and air pressure data are retrieved from the BMP180 sensor and those values are placed into string variables <span aria-label="annotation6" class="CodeAnnotationCode">❻</span>. These variables are then appended to the giant string <samp class="SANS_TheSansMonoCd_W5Regular_11">finalAppURL</samp>, which already contains the web app URL along with the date and time.</p>
<p class="TX">Now that the web app URL has been fully constructed, an HTTP call sends the data to the Google server <span aria-label="annotation7" class="CodeAnnotationCode">❼</span>. The final lines of code get the HTTP response code <span aria-label="annotation8" class="CodeAnnotationCode">❽</span> from the Google server and send it to the Serial Monitor. This is useful for debugging, since it confirms whether the process has been successful, but you can remove it once your sketch is operating as required. Finally, the sketch records the elapsed time after the latest update, which is used to calculate the delay before the next update <span aria-label="annotation9" class="CodeAnnotationCode">❾</span>.</p>
</section>
<section aria-labelledby="sec4" epub:type="division">
<h2 class="H1" id="sec4"><span id="h1-164"/><samp class="SANS_Futura_Std_Bold_B_11">Tips for Future Google Sheets Projects</samp></h2>
<p class="TNI">Now that you have a working mechanism to log real-world data to a Google Sheets spreadsheet, here are a few final tips for building this type of project. First, you’re limited to viewing your projects on a browser, as the spreadsheet is on the Google server. You can also monitor the project’s progress from using the Google Sheets app on your mobile device or tablet, as shown in <a href="chapter22.xhtml#fig22-12">Figure 22-12</a>.</p>
<figure class="IMG"><img alt="A SCREENSHOT OF THE EXAMPLE OUTPUT FROM PROJECT #65 DISPLAYED USING THE ANDROID GOOGLE SHEETS APP" class="img1" id="fig22-12" src="../images/fig22-12.png"/>
<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 22-12: Example output from Project #65 displayed using the Google Sheets app on Android</samp></p></figcaption>
</figure>
<p class="TX">As previously noted, the maximum number of rows in a Google Sheets spreadsheet is 40,000. To monitor two or more ESP32 boards at the same time, give them separate spreadsheets; you can then combine and analyze the data from the desktop once the required data has been captured. If you want to edit an existing project—by changing the variable names or locations in the spreadsheet, for example—don’t forget to update the app script and then create a new deployment that uses a new web app URL that you then insert into the sketch.</p>
</section>
<section aria-labelledby="sec5" epub:type="division">
<h2 class="H1" id="sec5"><span id="h1-165"/><span aria-label=" Page 396. " epub:type="pagebreak" id="pg_396" role="doc-pagebreak"/><samp class="SANS_Futura_Std_Bold_B_11">Moving On</samp></h2>
<p class="TNI">This chapter gave you an inexpensive framework for capturing any type of data that can be gathered by an Arduino-compatible board and sending it straight to a spreadsheet. This allows you to monitor real-time data from almost anywhere in the world and share this data with others in a public or private manner. You can use your own sensors, change the spreadsheet variables, and update times to suit your own needs.</p>
<p class="TX">In the next chapter, you’ll continue working with internet-connected devices, creating your own web server with the ESP32 board to share information in read-only format for others to view.</p>
</section>
</section>
</body>
</html>