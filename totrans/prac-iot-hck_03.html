<html><head></head><body><div id="sbo-rt-content"><section>
<header>
<h1 class="chapter">
<span class="ChapterNumber"><span epub:type="pagebreak" title="17" id="Page_17"/>2</span><br/>
<span class="ChapterTitle">Threat Modeling</span>
</h1>
</header>
<figure class="opener">
<img src="Images/chapterart.png" alt="" width="204" height="204"/>
</figure>
<p class="ChapterIntro">The <em>threat modeling</em> process systematically identifies possible attacks against a device and then prioritizes certain issues based on their severity. Because threat modeling can be tedious, it’s sometimes overlooked. Nonetheless, it’s vital to understanding threats, their impact, and the appropriate mitigations you’ll have to take to eliminate them. </p>
<p>In this chapter, we walk you through a simple framework for threat modeling and discuss a few alternative frameworks. Then we briefly describe some of the most important threats that an IoT infrastructure usually encounters so you can successfully employ threat modeling techniques in your next IoT assessment.</p>
<h2 id="h1-500907c02-0001"><span epub:type="pagebreak" title="18" id="Page_18"/>Threat Modeling for IoT</h2>
<p class="BodyFirst">When you create threat models for IoT devices specifically, you’ll likely run into a few recurring issues. The reason is that the IoT world is mostly made up of systems with low computing power, power consumption, memory, and disk space that are deployed in insecure networking environments. Many hardware manufacturers have realized they can easily convert any inexpensive platform, such as an Android phone or tablet, a Raspberry Pi, or an Arduino board, into a sophisticated IoT device. </p>
<p>Consequently, at their core, many IoT devices are running Android or common Linux distributions, the same operating systems on more than a billion phones, tablets, watches, and televisions. These operating systems are well known, and they often provide more functionality than a device needs, increasing the ways an attacker can exploit it. Worse, IoT developers supplement the operating systems by introducing custom apps, which lack proper security controls. Then, to make sure their products can carry out their primary functions, developers often have to bypass the operating system’s original protections. Still other IoT devices, based on real-time operating systems (RTOS), minimize processing time without implementing the security standards of more advanced platforms.</p>
<p>In addition, these IoT devices usually don’t have the capacity to run antivirus or anti-malware protections. Their minimalistic designs, developed for ease of use, don’t support common security controls, such as <em>software whitelisting</em>, in which devices allow only specific software to be installed, or <em>network access control (NAC)</em> solutions, which enforce network policies that control user and device access. Many vendors stop offering security updates shortly after the product’s initial release. Also, the white-label firms that often develop these products distribute them widely through many suppliers under different brand names and logos, making security and software updates difficult to apply to all products. </p>
<p>These limitations force many internet-enabled devices to use proprietary or lesser-known protocols that don’t meet the industry security standards. Often, they can’t support sophisticated hardening approaches, such as the <em>software integrity control</em>, which verifies that third parties haven’t tampered with executables, or <em>device attestation</em>, which uses specialized hardware to ensure that a target device is legitimate. </p>
<h2 id="h1-500907c02-0002">Following a Framework for Threat Modeling</h2>
<p>The easiest way to use threat modeling in your security assessments is to follow a framework like the <em>STRIDE threat classification model</em>, which focuses on identifying weaknesses in the technology rather than vulnerable assets or possible attackers. Developed by Praerit Garg and Loren Kohnfelder at Microsoft, STRIDE is one of the most popular threat classification schemes. The acronym represents the following threats:</p>
<ol class="none">
<li><span class="RunInHead">Spoofing </span>  When an actor pretends to play the role of a system component </li>
<li><span class="RunInHead">Tampering</span>  When an actor violates the integrity of data or a system</li>
<li><span epub:type="pagebreak" title="19" id="Page_19"/><span class="RunInHead">Repudiation</span>  When users can deny they took certain actions on the system</li>
<li><span class="RunInHead">Information Disclosure</span>  When an actor violates the confidentiality of the system’s data</li>
<li><span class="RunInHead">Denial of Service</span>  When an actor disrupts the availability of a system’s component or the system as a whole</li>
<li><span class="RunInHead">Elevation of Privilege</span>  When users or system components can elevate themselves to a privilege level they shouldn’t have access to</li>
</ol>
<p>STRIDE has three steps: identify the architecture, break it into components, and identify threats to each component. To see this framework in action, let’s imagine we’re performing threat modeling for a drug infusion pump. We’ll assume that the pump connects via Wi-Fi to a control server located in the hospital. The network is insecure and lacks segmentation, meaning a visitor to the hospital could connect to the Wi-Fi and passively monitor the pump’s traffic. We’ll use this scenario to walk through each step of the framework.</p>
<h3 id="h2-500907c02-0001">Identifying the Architecture</h3>
<p class="BodyFirst">We start our threat modeling by examining the device’s architecture. The system consists of the drug infusion pump and a control server that can send commands to a few dozen pumps (<a id="figureanchor2-1" href="#figure2-1">Figure 2-1</a>). Nurses operate the server, although in some cases, authorized IT admins might access it, too.</p>
<figure>
<img src="Images/f02001.png" alt="f02001" width="750" height="183"/>
<figcaption><p><a id="figure2-1">Figure 2-1:</a> A simple architecture diagram of an infusion pump</p></figcaption>
</figure>
<p>The control server sometimes needs software updates, including updates to its drug library and patient records. That means it’s sometimes connected to the <em>electronic health record (EHR)</em> and the update server. The EHR database contains patient health records. Even though these two components might be beyond the scope of a security assessment, we’re including them in our threat model (<a id="figureanchor2-2" href="#figure2-2">Figure 2-2</a>).</p>
<figure>
<img src="Images/f02002.png" alt="f02002" width="750" height="156"/>
<figcaption><p><a id="figure2-2">Figure 2-2:</a> An expanded architecture diagram of an infusion pump and its control server, which is also connected to the EHR and an update server</p></figcaption>
</figure>
<h3 id="h2-500907c02-0002"><span epub:type="pagebreak" title="20" id="Page_20"/>Breaking the Architecture into Components</h3>
<p class="BodyFirst">Now let’s look at the architecture more closely. The infusion pump and the control server consist of several components, so we need to break down our model to identify threats more reliably. <a id="figureanchor2-3" href="#figure2-3">Figure 2-3</a> shows the architecture’s components in more detail. </p>
<figure>
<img src="Images/f02003.png" alt="f02003" width="750" height="626"/>
<figcaption><p><a id="figure2-3">Figure 2-3:</a> Breaking down our threat model further</p></figcaption>
</figure>
<p>The pump system consists of the hardware (the actual pump), an operating system, and the software and microcontroller operating inside the pump. We’ve also taken into account the control server’s operating system, the <em>control server service </em>(the program operating the control server), and the restrictive user interface, which limits the user’s interaction with the service. </p>
<p>Now that we have a better idea of the system, let’s establish the direction in which information flows between these components. By doing so, we’ll locate sensitive data and figure out which components an attacker might target. We might also reveal hidden data-flow paths we didn’t know about. Let’s assume that, after examining the ecosystem further, we conclude that data flows both ways between all components. We’ve noted this using bidirectional arrows in <a href="#figure2-3">Figure 2-3</a>. Keep that detail in mind. </p>
<p>Let’s move on by adding trust boundaries to our diagram (<a id="figureanchor2-4" href="#figure2-4">Figure 2-4</a>). <em>Trust boundaries</em> surround groups with the same security attributes, which can help us expose data-flow entry points that might be susceptible to threats. </p>
<span epub:type="pagebreak" title="21" id="Page_21"/><figure>
<img src="Images/f02004.png" alt="f02004" width="750" height="643"/>
<figcaption><p><a id="figure2-4">Figure 2-4:</a> Diagram with trust boundaries included</p></figcaption>
</figure>
<p>We create separate trust boundaries around the pump, the control server, the onsite components, and the offsite components. For practical reasons, we also add two external users: the patient who will use the pump and the nurse who will operate the control server. </p>
<p>Notice that sensitive information, such as patient data from the pump, can reach the third-party vendor’s update server through the control server. Our method works: we’ve already spotted our first threat, an insecure update mechanism, which could expose patient data to unauthorized systems. </p>
<h3 id="h2-500907c02-0003">Identifying Threats</h3>
<p class="BodyFirst">Now we’ll apply the STRIDE framework to the diagram’s components, giving us a more comprehensive list of threats. Although we’ll discuss only some of those components in this exercise for brevity, you should address all of them as part of your threat modeling process.</p>
<p><span epub:type="pagebreak" title="22" id="Page_22"/>First, we’ll examine the product’s general security requirements. Often, the vendor establishes these requirements during development. If we don’t have the vendor’s specific list of requirements, we can review the device documentation to determine them on our own. For example, as a medical device, the drug infusion pump must ensure patient safety and privacy. In addition, all medical equipment should be accredited with certifications specific to the market in which it’s launched. For instance, devices traded on the extended Single Market in the European Economic Area (EEA) should have the Conformité Européenne (CE) certification mark. We’ll keep these requirements in mind as we analyze each component.</p>
<h4 id="h3-500907c02-0001">The Restrictive User Interface</h4>
<p class="BodyFirst">The <em>restrictive user interface (RUI)</em> is the kiosk app that interacts with the control server service. This app severely limits the actions a user can execute. It’s like an ATM app; you can interact with the software but only in a handful of ways. In addition to the general security requirements, the RUI has its own specific constraints. First, the user shouldn’t be able to escape the app. Second, the user must authenticate with valid credentials to access it. Now let’s go through each part of the STRIDE model to identify threats. </p>
<p>When it comes to <em>spoofing</em>, the RUI authenticates users with weak, four-digit PINs that adversaries can easily predict. If attackers predict the PIN correctly, they can access authorized accounts and send commands to the infusion pump on behalf of the accounts’ owners.</p>
<p>In terms of <em>tampering</em>, the RUI can receive input other than the limited set of allowed input. For example, it could receive input through an external keyboard. Even if most of the keyboard keys have been disabled, the system might still allow key combinations, such as shortcuts, hotkeys, or even accessibility features configured by the underlying operating system (like closing a window by pressing <span class="KeyCaps">alt</span>-F4 on Windows). These could allow users to bypass the RUI and exit the kiosk application. We’ll describe this kind of attack in Chapter 3. </p>
<p>For <em>repudiation</em>, the RUI supports only a single user account for the medical staff, making all the log files, if any exist, useless because you can’t identify who actually used the device. Because the RUI can’t operate in multiuser mode, any member of the medical team can access the control server and operate the infusion pump without the system being able to distinguish between them.</p>
<p>When it comes to <em>information disclosure</em>, it’s possible that certain debugging messages or errors, when presented to the user, might reveal important information about the patients or system internals. Adversaries might be able to decode these messages, discover technologies the underlying system uses, and figure out a way to exploit them.</p>
<p>The RUI might be vulnerable to <em>denial of service</em> attacks because of its brute-force protection mechanism, which locks a user out of the system after five consecutive incorrect login attempts. Once the brute-force protection is active, no user can log into the system for a set period of time. If the medical team accidentally triggers this feature, they might block access to <span epub:type="pagebreak" title="23" id="Page_23"/>the system and violate the patient safety security requirement as a result. Even though security features might protect against some threats, they’ll often cause other threats. Finding the balance between security, safety, and usability is a difficult task.</p>
<p>In terms of <em>elevation of privilege</em>, critical medical systems frequently have remote support solutions that allow the vendor’s technicians to access the software instantly. The existence of these features automatically increases the component’s threat surface, because these services are prone to vulnerabilities, and attackers can abuse them to get remote administrative access within the RUI or the control server service. Even if these features require authentication, the credentials might be publicly available or be the same for all products of this line. Or there could be no authentication at all.</p>
<h4 id="h3-500907c02-0002">The Control Server Service</h4>
<p class="BodyFirst">The control server service<b> </b>is the app that operates the control server. It’s responsible for communicating with the RUI, the drug library, and the drug infusion pump. It also communicates with the EHR (to receive information about the patients) using HTTPS and with the update server (to receive software and drug library updates) using a custom TCP protocol. </p>
<p>In addition to the general security requirements mentioned earlier, the control server should be able to identify and verify drug infusion pumps to avoid <em>skimming attacks</em>, in which an adversary replaces peripheral components with similar, tampered ones. We should also make sure the data-in-transit is protected. In other words, the communication protocol between the control server and the pump must be secure and shouldn’t allow for replay attacks or interception. <em>Replay attacks</em> cause the retransmission or delay of a critical or state altering request to the server. Additionally, we must ensure that attackers can’t compromise the hosting platform’s security controls, which might include application sandboxing, filesystem permissions, and existing role-based access controls.</p>
<p>Using STRIDE, we can identify the following threats. <em>Spoofing</em> attacks could occur because the control server doesn’t have a solid method of identifying drug infusion pumps. If you briefly analyze the communication protocol, you can imitate a pump and communicate with the control server, which might lead to more threats. </p>
<p>An attacker could <em>tamper </em>with the service, because the control server doesn’t have a solid method of verifying the data integrity that the drug infusion pump sends. That means the control server might be vulnerable to <em>man-in-the-middle attacks</em>, in which an attacker modifies the data sent to the control server and provides the server with falsified readings. If the control server bases its actions on the falsified readings, this attack might directly affect the patients’ health and safety.</p>
<p>The control server might enable <em>repudiation</em> because it uses <em>world-writeable logs</em>, which any system user is capable of overwriting, to monitor its actions. These logs files can be subject to insider tampering by an attacker to hide certain operations.</p>
<p><span epub:type="pagebreak" title="24" id="Page_24"/>Regarding <em>information disclosure</em>, the control server unnecessarily sends sensitive patient information to the update server or drug infusion pump. This information could range from vital measurements to personal information.</p>
<p>In terms of <em>denial of service</em>, adversaries in close proximity to the control server can jam the server’s signal and disable any kind of wireless communication with the drug infusion pump, rendering the whole system useless.</p>
<p>Additionally, the control server might be vulnerable to <em>elevation of privilege</em> if it inadvertently exposes API services that allow unauthenticated adversaries to perform high-privileged functionalities, including altering the drug infusion pump settings.</p>
<h4 id="h3-500907c02-0003">The Drug Library</h4>
<p class="BodyFirst">The drug library is the system’s main database. It holds all information related to the drugs the pump uses. This database can also control the user management system. </p>
<p>In terms of <em>spoofing</em>, users interacting with the database through the RUI or pump might be able to execute actions by impersonating other database users. For instance, they might exploit an application vulnerability to abuse the lack of controls for the user’s input from the RUI.</p>
<p>The drug library might be vulnerable to <em>tampering</em> if the library fails to properly sanitize user input from the RUI. This could lead to <em>SQL injection attacks</em>, which allow attackers to manipulate the database or execute untrusted code.</p>
<p>The database could allow <em>repudiation</em> if logs for user requests originating from the drug infusion pump store the request’s user agent in an unsafe manner, allowing adversaries to pollute the database’s log files (for example, by using line-feed characters to insert fake log entries). </p>
<p>When it comes to <em>information disclosure</em>, the database might contain functions or stored procedures that perform external requests (such as DNS or HTTP requests). An adversary could abuse these to exfiltrate data using an out-of-band SQL injection technique. This method is extremely useful to attackers who are able to perform only blind SQL injections, in which the server’s output doesn’t contain the data resulting from the injected query. For example, adversaries could smuggle out sensitive data by constructing URLs and placing this data in the subdomain of a domain that they control. Then they can supply this URL to one of these vulnerable functions and force the database to perform an external request to their server. </p>
<p><em>Denial of service </em>attacks might also occur in cases when an adversary abuses components that allow complex queries. By forcing the components to perform unnecessary computations, the database might come to a halt when no more resources are available to complete the requested query.</p>
<p>Additionally, when it comes to <em>elevation of privilege</em>, certain database functions might allow users to run code with the highest privileges. By performing a specific set of actions through the RUI component, the user might be capable of calling these functions and escalating their privileges to that of a database superuser.</p>
<h4 id="h3-500907c02-0004"><span epub:type="pagebreak" title="25" id="Page_25"/>The Operating System</h4>
<p class="BodyFirst">The operating system receives input from the control server service, so any threats to it derive directly from the control server. The operating system should have integrity checking mechanisms and a baseline configuration that incorporates specific security principles. For example, it should protect data-at-rest, enable update procedures, enable network firewalls, and detect malicious code. </p>
<p>The component could allow <em>spoofing</em> if an adversary is able to boot their own custom operating system. This custom operating system could deliberately lack support for necessary security controls, such as application sandboxing, filesystem permissions, and role-based access control. An attacker can then study the application and extract vital information that otherwise wouldn’t be available due to the security controls. </p>
<p>As for <em>tampering</em>, if adversaries have local or remote access to the system, they could manipulate the operating system. For example, they could change the current security settings, disable the firewall, and install a backdoor executable. </p>
<p><em>Repudiation</em> vulnerabilities might be present on the operating system if the system logs are stored only locally and if a high-privileged adversary could alter them.</p>
<p>With respect to <em>information disclosure</em>, error and debugging messages might reveal information about the operating system that could help adversaries exploit the system even further. Messages might also include sensitive patient information, which could violate compliance requirements. </p>
<p>The component might be susceptible to <em>denial of service</em> attacks if an adversary triggers an unwanted system restart (during an update process, for example) or deliberately shuts down the system, causing the whole system to halt its operation.</p>
<p>Attackers could achieve <em>elevation of privilege</em> if they abuse vulnerable functionalities, software designs, or misconfigurations of high-privileged services and applications to obtain elevated access to resources that should be available only to a superuser.</p>
<h4 id="h3-500907c02-0005">The Device Components’ Firmware </h4>
<p class="BodyFirst">Next, let’s consider all the device components’ firmware, such as the CD/DVD drive, controllers, display, keyboard, mouse, motherboard, network card, sound card, video card, and so on. <em>Firmware</em> is a kind of software that provides specific low-level operations. It’s usually stored on the components’ nonvolatile memory or loaded into the components by a driver during the initialization. The device’s vendor typically develops and maintains its firmware. The vendor should also sign the firmware, and the device should verify this signature. </p>
<p>The component might be susceptible to <em>spoofing</em> if the attackers can exploit logic bugs that downgrade the firmware to older versions containing known vulnerabilities. Adversaries could also install custom firmware that pretends to be the latest available version from the vendor when the system requests an update. </p>
<p><span epub:type="pagebreak" title="26" id="Page_26"/>The attackers might succeed in <em>tampering</em> with the firmware by installing malware on it. This is a common technique for <em>advanced persistent threat (APT)</em> attacks, in which the adversary attempts to remain undetected for an extended period and survive an operating system reinstallation or hard disk replacement. For example, a hard disk firmware modification containing a Trojan horse could allow users to store data in locations that won’t be erased even if they format or wipe the disk. IoT devices often don’t verify the integrity of the digital signature and firmware, making this kind of attack even easier. In addition, tampering with the configuration variables of certain firmware (such as BIOS or UEFI) might allow adversaries to disable certain hardware-supported security controls, like secure boot. </p>
<p>In terms of <em>information disclosure</em>, any firmware that establishes a communication channel with third-party vendors servers (for analytics purposes or to request information about updates, for example) might also expose private data related to the patients, likely violating regulations. Also, sometimes the firmware exposes unnecessary security-related API functionalities, which adversaries can abuse to extract data or escalate their privileges. This might include the disclosure of System Management Random Access Memory (SMRAM) contents, storage that System Management Mode uses, which gets executed with high privileges and handles CPU power management. </p>
<p>When it comes to <em>denial of service</em>, some device component vendors use over-the-air (OTA) updates to deploy firmware and configure the corresponding component securely. Sometimes, adversaries are able to block these updates, leaving the system in an insecure or unstable state. In addition, adversaries might be able to directly interact with the communication interface and attempt to corrupt the data to halt the system. </p>
<p>With regards to <em>elevation of privilege</em>, adversaries can escalate their privileges by exploiting known vulnerabilities in the drivers and abusing undocumented, exposed management interfaces, such as System Management Mode. Also, many device components ship with default passwords embedded in their firmware. Attackers can use these passwords to gain privileged access to the components’ management panels or the actual host system.</p>
<h4 id="h3-500907c02-0006">The Physical Equipment</h4>
<p class="BodyFirst">Now we’ll assess the physical equipment’s security, including the box containing the control server’s processor and the RUI screen. When attackers gain physical access to a system, you should generally assume that they’ll have full administrative access. There are very few ways to completely protect against that. Nonetheless, you can implement mechanisms to make this process a lot harder for adversaries.</p>
<p>Physical equipment has quite a few more security requirements than the rest. First, the clinic should store the control server in a room that only authorized employees have access to. The component should support hardware attestation and have a secure boot process, one based on keys <span epub:type="pagebreak" title="27" id="Page_27"/>burned into the CPU. The device should have memory protection enabled. It should be able to perform secure, hardware-backed key management, storage, and generation, as well as secure cryptographic operations, like generating random numbers, encrypting data with a public key, and secure signing. Additionally, it should seal all critical components using epoxy or another adhesive that would prevent people from easily inspecting the circuit design, making reverse engineering more difficult. </p>
<p>In terms of <em>spoofing</em>, adversaries might be able to replace critical hardware parts with faulty or insecure ones. We call these attacks <em>supply chain attacks</em>, because they often occur during the product’s manufacturing or shipping stages. </p>
<p>With regards to <em>tampering</em>, it’s possible for a user to insert external USB devices, like keyboards or flash drives, to provide the system with untrusted data. Also, attackers can replace existing physical input devices (such as keyboards, configuration buttons, and USB or Ethernet ports) with malicious ones that leak data to external parties. Exposed hardware programming interfaces, like JTAG, might also allow adversaries to change the device’s current settings and extract the firmware or even reset the device to an insecure state. </p>
<p>When it comes to <em>information disclosure</em>, attackers can discover information about the system and its operation by simply observing it. In addition to that, the RUI screen can’t protect the system against photographs that capture its sensitive information. Someone could remove external storage devices and extract the stored data. Adversaries might also be able to passively infer sensitive patients’ information, cleartext passwords, and encryption keys by exploiting potential side-channel leaks in the hardware implementation (such as electromagnetic interference or CPU power consumption) or by analyzing memory sections while performing a cold-boot attack. </p>
<p>The service might be vulnerable to <em>denial of service</em> in cases when a power outage occurs and causes the system to shut down. This threat will directly affect all the components that require the control server to operate. Additionally, adversaries with physical access to the hardware can manipulate the device’s internal circuit structure, causing it to malfunction.</p>
<p><em>Elevation of privilege</em> might occur from vulnerabilities such as race conditions and insecure error handling. These issues are often inherent in the design of the embedded CPUs, and they could allow a rogue process to read all memory or to write in arbitrary memory locations, even when not authorized to do so.</p>
<h4 id="h3-500907c02-0007">The Pump Service</h4>
<p class="BodyFirst">The pump service is the software operating the pump. It consists of a communication protocol that connects with the control server and a microcontroller that controls the pump. In addition to the general security <span epub:type="pagebreak" title="28" id="Page_28"/>requirements, the pump should identify and verify the control server service’s integrity. The communication protocol between the control server and the drug infusion pump should be secure, and it shouldn’t allow for replay attacks or interception.</p>
<p><em>Spoofing</em> can affect the component if the drug infusion pump doesn’t use sufficient validation checks or verify that it’s indeed communicating with a valid control server. Insufficient validation checks can also lead to <em>tampering</em> attacks, if, for instance, the pump allows maliciously crafted requests to change the pump’s settings. As for <em>repudiation</em> issues, the infusion pump might use custom-made log files. If these files aren’t read-only, they’ll be prone to tampering. </p>
<p>The pump service might allow for <em>information disclosure</em> if the communication protocol between the control server and the infusion pump doesn’t use encryption. In that case, man-in-the-middle attackers could capture transmitted data, including sensitive patient information.</p>
<p>The service might be vulnerable to <em>denial of service</em> if, after a thorough analysis of the communication protocol, an attacker identifies a shutdown command. Additionally, if the pump runs as a superuser and has complete control over the device, it might be prone to <em>elevation of privilege</em>. </p>
<p>You might have discovered more threats than those we’ve mentioned, and you’ve likely identified additional security requirements for each component. A good rule is to find at least one or two threats per STRIDE category for each component. If you can’t think of that many on the first attempt, revisit your threat model multiple times.</p>
<h3 id="h2-500907c02-0004">Using Attack Trees to Uncover Threats</h3>
<p class="BodyFirst">If you want to identify new threats in a different way or model existing ones for further analysis, you could use an attack tree. An <em>attack tree</em> is a visual map that starts by defining a generic attack objective and then becomes more specific as the tree expands. For example, <a id="figureanchor2-5" href="#figure2-5">Figure 2-5</a> shows an attack tree for the threat of tampering with drug delivery. </p>
<p>Attack trees can provide greater insight on the outcome of our threat model, and we might uncover threats that we missed earlier. Notice that each node contains a possible attack that requires one or more of the attacks described in its child nodes. In some cases, the attack might require all of its child nodes. For example, tampering with database data within infusion pumps requires you to gain database access <em>and</em> have improper access controls in the drug library tables. However, you can tamper with the drug delivery by either changing the infusion rate <em>or</em> by disrupting the infusion rate update using a denial of service attack.</p>
<span epub:type="pagebreak" title="29" id="Page_29"/><figure>
<img src="Images/f02005.png" alt="f02005" width="750" height="744"/>
<figcaption><p><a id="figure2-5">Figure 2-5:</a> Attack tree for the threat of tampering with drug delivery</p></figcaption>
</figure>
<h2 id="h1-500907c02-0003">Rating Threats with the DREAD Classification Scheme</h2>
<p class="BodyFirst">Threats pose no danger on their own. For a threat to matter, it must have some sort of impact. We can’t figure out the true impact of the threats we’ve discovered until we review the vulnerability assessment results. Still, at some point you should evaluate the risk posed by each threat. We’ll show you how to do this using <em>DREAD</em>, a risk rating system. The DREAD acronym represents the following criteria: </p>
<ul>
<li>Damage  How damaging the exploitation of this threat would be</li>
<li>Reproducibility  How easy the exploit is to reproduce</li>
<li><span epub:type="pagebreak" title="30" id="Page_30"/>Exploitability  How easy the threat is to exploit</li>
<li>Affected Users  How many users would be affected</li>
<li>Discoverability  How easy it is to identify the threat</li>
</ul>
<p>We’ll assign each of these categories a score between 0 and 10, and then use the scores to calculate the final risk score of a threat. </p>
<p>As an example, let’s use DREAD to rate the threat caused by the RUI’s weak four-digit PIN authentication method. First, if adversaries can guess someone’s PIN, they can access the current user’s data. Because the attack would affect only a single patient, we’ll give the <em>Damage</em> and <em>Affected Users</em> categories half of the maximum score, or a score of five. Next, because even a nonskilled adversary can easily identify, exploit, and reproduce this threat, we’ll give the <em>Discoverability</em>, <em>Exploitability</em>, and <em>Reproducibility</em> categories the maximum score of 10. After adding these scores and dividing them by the number of categories, the result is an average threat ranking of 8 out of 10, as shown in <a href="#table2-1" id="tableanchor2-1">Table 2-1</a>.</p>
<figure>
<figcaption class="TableTitle"><p><a id="table2-1">Table 2-1</a>: DREAD Scoring Matrix</p></figcaption>
<table id="table-500907c02-0001" border="1">
<thead>
<tr>
<td><b>Threat</b></td><td><b>Score</b></td></tr>
</thead>
<tbody>
<tr>
<td>Damage</td><td>5</td></tr>
<tr>
<td>Reproducibility</td><td>10</td></tr>
<tr>
<td>Exploitability</td><td>10</td></tr>
<tr>
<td>Affected Users</td><td>5</td></tr>
<tr>
<td>Discoverability</td><td>10</td></tr>
<tr>
<td><b>Total</b></td><td><b>8</b></td></tr>
</tbody>
</table>
</figure>
<p>You could follow a similar approach to classify the rest of the identified threats and prioritize your responses to them.</p>
<h2 id="h1-500907c02-0004">Other Types of Threat Modeling, Frameworks, and Tools</h2>
<p class="BodyFirst">So far in this chapter, we’ve presented one possible framework for threat modeling: a software-centric approach that prioritizes the vulnerability of each application component. But there are other possible frameworks you could follow, such as asset-centric and attacker-centric approaches. You might use one of these alternative methods depending on your assessment’s specific needs. </p>
<p>In an <em>asset-centric</em> threat model, you’d first identify the system’s important information. For the drug infusion pump, assets could include the patients’ data, the control server’s authentication credentials, the infusion pump configuration settings, and the software releases. You’d then analyze these assets based on their security attributes: in other words, what each asset needs to maintain its confidentiality, integrity, and availability. Note that you probably won’t create a complete list of assets, because what’s considered valuable depends on each person’s point of view. </p>
<p><span epub:type="pagebreak" title="31" id="Page_31"/>The <em>attacker-centric</em> approach focuses on identifying potential attackers. Once you’ve done so, you’d use their attributes to develop a basic threat profile for each asset. This approach has some problems: it requires you to gather extensive intelligence about modern threat actors, their recent activity, and their characteristics. In addition, it’s possible that you’ll accidentally fall back on your own biases about who attackers are and what they want. To avoid doing so, use the standardized descriptions of threat agents provided by the Intel Threat Agent Library at <a href="https://www.intel.com/content/dam/www/public/us/en/documents/solution-briefs/risk-assessments-maximize-security-budgets-brief.pdf" class="LinkURL">https://www.intel.com/content/dam/www/public/us/en/documents/solution-briefs/risk-assessments-maximize-security-budgets-brief.pdf</a>. For example, in our scenario, our list of agents might include the Untrained Nurse who misuses the system, the Reckless Nurse who deliberately circumvents existing security controls for expediency, and the Hospital Thief who can steal small components (such as hard disks and SD cards) or even the whole drug infusion pump. More advanced actors could include the Data Miner, who searches for internet-connected control servers and collects patient data, or the Government Cyber Warrior, who performs state-sponsored attacks to disrupt the use of infusion pumps on a national scale. </p>
<p>You can also make other choices when threat modeling. Frameworks other than STRIDE include PASTA, Trike, OCTAVE, VAST, Security Cards, and Persona non Grata. We won’t cover these models here, but you might find them useful for certain assessments. We used data flow diagrams to model our threats, but you could also use other types of diagrams, such as unified modeling language (UML), swimlane diagrams, or even state diagrams. It’s up to you to decide what system makes the most sense and works best for you. </p>
<h2 id="h1-500907c02-0005">Common IoT Threats</h2>
<p class="BodyFirst">Let’s review some common threats in IoT systems. The list isn’t exhaustive, but you could use it as a baseline for your own threat models.</p>
<h3 id="h2-500907c02-0005">Signal Jamming Attacks</h3>
<p class="BodyFirst">In a <em>signal jamming attack</em>, the adversary interferes with the communication between two systems. IoT systems usually have their own ecosystems of nodes. For example, the drug infusion pump system has one control server connected to multiple drug infusion pumps. With special equipment, it’s possible to isolate the control server and pumps from each other. In critical systems like this one, this threat could prove fatal.</p>
<h3 id="h2-500907c02-0006">Replay Attacks</h3>
<p class="BodyFirst">In a <em>replay attack</em>, the adversary repeats some operation or resends a transmitted packet. In the drug infusion pump example, this could mean that a patient receives multiple doses of a drug. Replay attacks, regardless of whether or not they affect IoT devices, are usually severe.</p>
<h3 id="h2-500907c02-0007"><span epub:type="pagebreak" title="32" id="Page_32"/>Settings Tampering Attacks</h3>
<p class="BodyFirst">In <em>settings tampering attacks</em>, the adversary exploits a component’s lack of integrity to change its settings. For the drug infusion pump, these settings could include the following: exchanging the control server with a malicious control server, changing the primary drug used, or altering the network settings to cause a denial of service attack.</p>
<h3 id="h2-500907c02-0008">Hardware Integrity Attacks</h3>
<p class="BodyFirst"><em>Hardware integrity attacks</em> compromise the integrity of the physical device. For example, an attacker might bypass insecure locks or easily accessible USB ports, especially if they’re bootable. All IoT systems face this threat, because no device integrity protection is perfect. Still, certain techniques make it more difficult. Once, during a vulnerability assessment of a certain medical device, we realized that unless we very carefully disassembled the device with specialized equipment, a fail-safe mechanism, also known as a <em>fuse</em>, would destroy the board. This mechanism proved that the product’s designers had taken seriously the possibility of device tampering. Yet we eventually bypassed the protection mechanism.</p>
<h3 id="h2-500907c02-0009">Node Cloning</h3>
<p class="BodyFirst"><em>Node cloning</em> is a threat that arises as part of a <em>Sybil attack</em>, in which an attacker creates fake nodes in a network to compromise its reliability. IoT systems commonly use multiple nodes in their ecosystem, such as when one control server manages multiple drug infusion pumps. </p>
<p>We often find node cloning threats in IoT systems. One reason is that the association protocols that the nodes use to communicate aren’t very sophisticated, and creating fake nodes can sometimes be easy. Occasionally, you can even create a fake master node (in our example, the control server). This threat could affect the system in various ways: is there a finite number of nodes a control server can connect to? Can this threat lead to a denial of service attack? Can it cause attackers to propagate falsified information?</p>
<h3 id="h2-500907c02-0010">Security and Privacy Breaches</h3>
<p class="BodyFirst">Privacy breaches are one of the biggest and most consistent threats in IoT systems. Often, very little protects user data confidentiality, so you can find this threat in almost any communication protocol that transfers data to and from a device. Map the system architecture, find the components that might contain sensitive user data, and monitor the endpoints that transfer them.</p>
<h3 id="h2-500907c02-0011">User Security Awareness</h3>
<p class="BodyFirst">Even if you manage to mitigate all other threats, you’ll probably have trouble addressing users’ security awareness. This could include their ability to detect phishing emails, which could compromise their workstations, or their habit of allowing unauthorized people into sensitive areas. People who work with medical IoT equipment have a saying: if you’re looking for a hack, <span epub:type="pagebreak" title="33" id="Page_33"/>a business logic bypass, or something that will accelerate some processing tasks, just ask the nurse operating the system. Because they use this system daily, they’ll know all the system shortcuts.</p>
<h2 id="h1-500907c02-0006">Conclusion</h2>
<p class="BodyFirst">This chapter provided you with an introduction to threat modeling, the process of identifying and listing possible attacks against an examined system. By walking through a threat model for a drug infusion pump system, we outlined the basic stages of the threat modeling process and described a few of the core threats IoT devices face. The approach we explained was simple and might not be the best for every situation, so we encourage you to explore other frameworks and processes. </p>
</section>
</div></body></html>