- en: '**19**'
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**ANALYSIS OF VARIANCE**'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/common-01.jpg)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
- en: '*Analysis of variance (ANOVA)*, in its simplest form, is used to compare multiple
    means in a test for equivalence. In that sense, it’s a straightforward extension
    of the hypothesis test comparing two means. There’s a continuous variable from
    which the means of interest are calculated, and there’s at least one categorical
    variable that tells you how to define the groups for those means. In this chapter,
    you’ll explore the ideas surrounding ANOVA and look at comparing means first split
    by one categorical variable (one-way ANOVA) and then split by multiple categorical
    variables (multiple-factor ANOVA).'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: '**19.1 One-Way ANOVA**'
  id: totrans-4
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The simplest version of ANOVA is referred to as *one-way* or *one-factor* analysis.
    Simply put, the one-way ANOVA is used to test two or more means for equality.
    Those means are split by a categorical *group* or *factor* variable. ANOVA is
    often used to analyze experimental data to assess the impact of an intervention.
    You might, for example, be interested in comparing the mean weights of the chicks
    in the built-in `chickwts` data set, split according to the different food types
    they were fed.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
- en: '***19.1.1 Hypotheses and Diagnostic Checking***'
  id: totrans-6
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Say you have a categorical-nominal variable that splits a total of *N* numeric
    observations into *k* distinct groups, where *k* ≥ 2\. You’re looking to statistically
    compare the *k* groups’ means, *μ[1]*,...,*μ[k]*, to see whether they can be claimed
    to be equal. The standard hypotheses are as follows:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
- en: 'H[0] : *μ[1]* = *μ[2]* = ... = *μ[k]*'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
- en: 'H[A] : *μ[1]*, *μ[2]*, ... , *μ[k]* are not all equal'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
- en: (alternatively, at least one mean differs).
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
- en: In fact, when *k* = 2, the two-sample *t*-test is equivalent to ANOVA; for that
    reason, ANOVA is most frequently employed when *k* > 2.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
- en: 'The following assumptions need to be satisfied in order for the results of
    the basic one-way ANOVA test to be considered reliable:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
- en: '**Independence** The samples making up the *k* groups must be independent of
    one another, and the observations in each group must be independent and identically
    distributed (iid).'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
- en: '**Normality** The observations in each group should be normally distributed,
    or at least approximately so.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
- en: '**Equality of variances** The variance of the observations in each group should
    be equal, or at least approximately so.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
- en: If the assumptions of equality of variances or normality are violated, it doesn’t
    necessarily mean your results will be completely worthless, but it will impact
    the overall effectiveness of detecting a true difference in the means (refer to
    the discussion on statistical power in [Section 18.5.4](ch18.xhtml#ch18lev2sec167)).
    It’s always a good idea to assess the validity of these assumptions before using
    ANOVA; I’ll do this informally for the upcoming example.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
- en: It’s also worth noting that you don’t need to have an equal number of observations
    in each group to perform the test (in which case it is referred to as *unbalanced*).
    However, having unbalanced groups does render the test more sensitive to potentially
    detrimental effects if your assumptions of equality of variances and normality
    are not sound.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 另外值得注意的是，进行检验时，组内观察值数量不必完全相等（此时称为*不平衡*）。然而，组不平衡会使检验对方差相等性和正态性假设不成立时产生潜在不利影响时更加敏感。
- en: 'Let’s return to the `chickwts` data for the example—the weights of chicks based
    on *k* = 6 different feeds. You’re interested in comparing the mean weights according
    to feed type to see whether they’re all equal. Use `table` to summarize the six
    sample sizes and use `tapply` (see, for example, [Section 13.2.1](ch13.xhtml#ch13lev2sec116))
    to get each group mean, as follows:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们回到`chickwts`数据作为本例——这是根据* k * = 6种不同饲料的小鸡体重数据。你希望比较不同饲料类型下的均值体重，看看它们是否相等。使用`table`来总结六个样本的大小，使用`tapply`（例如参见[第13.2.1节](ch13.xhtml#ch13lev2sec116)）来获取每个组的均值，如下所示：
- en: '[PRE0]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Your skills from [Section 14.3.2](ch14.xhtml#ch14lev2sec125) allow you to produce
    side-by-side box-plots of the distributions of weights. The next two lines give
    you the plot on the left of [Figure 19-1](ch19.xhtml#ch19fig1):'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 你在[第14.3.2节](ch14.xhtml#ch14lev2sec125)中的技能使你能够生成并排显示的箱形图，比较不同喂养方式下的小鸡体重分布。接下来的两行代码将生成[图19-1](ch19.xhtml#ch19fig1)左侧的图表：
- en: '[PRE1]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '![image](../images/f19-01.jpg)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f19-01.jpg)'
- en: '*Figure 19-1: Exploring the* `chickwts` *data. Left: Side-by-side boxplots
    of chick weight split by feed type, with the mean marked by* ×*. Right: Normal
    QQ plot of the mean-centered data of each feed group.*'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '*图19-1：探索* `chickwts` *数据。左图：按饲料类型划分的小鸡体重并排箱形图，均值由* ×*标出。右图：每个饲料组的均值中心化数据的正态QQ图。*'
- en: Because boxplots display the median, not the mean, the second line of code adds
    the feed-specific means (stored in the `chick.means` object you just created)
    to each box using `points`.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 由于箱形图显示的是中位数而不是均值，第二行代码通过`points`将每个箱形图的喂养特定均值（存储在你刚刚创建的`chick.means`对象中）添加到箱形图中。
- en: 'Inspecting the left plot of [Figure 19-1](ch19.xhtml#ch19fig1), it certainly
    looks as though there’s a difference in the mean weights. Is any apparent difference
    statistically significant, though? To find out, the ANOVA test for this example
    concerns the following hypotheses:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 检查[图19-1](ch19.xhtml#ch19fig1)左侧的图表，显然看起来均值体重有所不同。然而，这种明显的差异是否具有统计学意义呢？为了弄清楚这一点，本例的方差分析（ANOVA）测试涉及以下假设：
- en: 'H[0] : *μ*[casein] = *μ*[horsebean] = *μ*[linseed] = *μ*[meatmeal] = *μ*[soybean]
    = *μ*[sunflower]'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[0] : *μ*[casein] = *μ*[horsebean] = *μ*[linseed] = *μ*[meatmeal] = *μ*[soybean]
    = *μ*[sunflower]'
- en: 'H[A] : The means are not all equal.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 'H[A] : 均值不全相等。'
- en: 'Assuming independence of the data, before implementing the test, you must first
    check that the other assumptions are valid. To examine equality of variances,
    you can use the same informal rule of thumb as used in the two-sample *t*-test.
    That is, you can assume equality of variances if the ratio of the largest sample
    standard deviation to the smallest is less than 2\. For the chick weights data,
    the following code will determine this:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 假设数据独立，在执行测试之前，首先必须检查其他假设是否有效。为了检查方差是否相等，你可以使用与两样本*t*检验中相同的非正式经验法则。也就是说，如果最大样本标准差与最小样本标准差之比小于2，就可以假设方差相等。对于小鸡体重数据，以下代码将帮助你进行这一检查：
- en: '[PRE2]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This informal result indicates that it’s reasonable to make the assumption.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 这个非正式结果表明，做出这个假设是合理的。
- en: Next, consider the assumption of normality of the raw observations. This can
    be difficult to determine in many real-data examples. At the least, though, it’s
    worthwhile to inspect histograms and QQ plots for signs of non-normality. You
    already inspected histograms and QQ plots for all 71 weights in [Section 16.2.2](ch16.xhtml#ch16lev2sec142),
    but for an ANOVA, you need to do this with respect to the grouping of the observations
    (that is, not just “overall” for the whole set of weights regardless of groups).
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，考虑原始观测值的正态性假设。在许多真实数据的例子中，这可能很难确定。然而，至少值得检查直方图和QQ图，寻找非正态性的迹象。你已经在[第16.2.2节](ch16.xhtml#ch16lev2sec142)中检查了所有71个权重的直方图和QQ图，但对于方差分析（ANOVA），你需要针对观测值的分组进行此操作（也就是说，不仅仅是对所有权重的“总体”进行检查，而不考虑分组）。
- en: 'To achieve this for the `chickwts` data, you need to first *mean-center* each
    weight by its respective sample mean. You can do this by taking the original vector
    of weights and subtracting from it the `chick.means` vector, but first you must
    rearrange and replicate the latter elements to correspond to the elements in the
    former. This is done by using `as.numeric` on the factor vector that represents
    feed type, giving the numeric value of the levels of `chickwts$feed` for each
    record in the original data frame. When that numeric vector is passed via the
    square brackets to `chick.means`, you get the correct group mean matched to each
    observation. As an exercise, you can inspect all the ingredients that go into
    creating the following `chick.meancen` object to satisfy yourself of what’s going
    on:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: In the context of the current analysis, these group-wise, mean-centered values
    are also referred to as *residuals*, a term you’ll come across frequently when
    you study regression methods in the next few chapters.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: You can now assess normality of the observations as a whole using the residuals.
    To inspect a normal QQ plot, the relevant functions are `qqnorm` and `qqline`,
    which you first met in [Section 16.2.2](ch16.xhtml#ch16lev2sec142). The following
    two lines produce the image on the right of [Figure 19-1](ch19.xhtml#ch19fig1).
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Based on this plot (the proximity of the plotted points to the perfect straight
    line), it doesn’t seem unreasonable to assume normality for these data, particularly
    when compared to QQ plots of generated normal data of the same sample size (an
    example was given on the left of [Figure 16-9](ch16.xhtml#ch16fig9) on [page 355](ch16.xhtml#page_355)).
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
- en: Investigating the validity of any required assumptions is referred to as *diagnostic
    checking*. If you wanted to perform a more rigorous diagnostic check for an ANOVA,
    other visual diagnostics could involve inspecting QQ plots split by group (you’ll
    do this in an example in [Section 19.3](ch19.xhtml#ch19lev1sec61)) or plotting
    the sample standard deviation for each group against the corresponding sample
    means. Indeed, there are also general hypothesis tests for normality (such as
    the Shapiro-Wilk test or Anderson-Darling test—you’ll see the former used in [Section
    22.3.2](ch22.xhtml#ch22lev2sec215)), as well as tests for equality of variances
    (such as Levene’s test), but I’ll stick with the basic rule of thumb and visual
    checks in this example.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
- en: '***19.1.2 One-Way ANOVA Table Construction***'
  id: totrans-39
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Turning your attention back to the left of [Figure 19-1](ch19.xhtml#ch19fig1),
    remember that the goal is to statistically evaluate the equality of the means
    marked by ×. This task will therefore require you to consider not only the variability
    *within* each of the *k* samples but the variability *between* the samples; this
    is why the test is referred to as an analysis of variance.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
- en: The test proceeds by first calculating various metrics associated with the overall
    variability and then calculating the within- and between-group variability. These
    figures involve sums of squared quantities and associated degrees of freedom values.
    All this culminates in a single test statistic and *p*-value targeting the aforementioned
    hypotheses. These ingredients are typically presented in a table, which is defined
    as follows.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
- en: Let *x*[1], ... , *x[N]* represent all *N* observations, regardless of group;
    let *x*[1][(][*j*][)], ... , *x[nj](j)* denote the specific group observations
    in group *j* = 1, ... , *k* such that *n[1]* + ... + *n[k]* = *N*. Let the “grand
    mean” of all observations be defined as ![image](../images/f0439-01.jpg). The
    ANOVA table is then constructed, where SS stands for sum-of-squares, df stands
    for degrees of freedom, MS stands for mean square, *F* refers to the *F* test
    statistic, and *p* refers to the *p*-value.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
- en: '|  | df | SS | MS | *F* | *p* |'
  id: totrans-43
  prefs: []
  type: TYPE_TB
- en: '| Overall | 1 | **(1)** |  |  |  |'
  id: totrans-44
  prefs: []
  type: TYPE_TB
- en: '| Group (or “[Factor](ch04.xhtml#ch04lev1sec18)”) | *k* − 1 | **(2)** | **(5)**
    | **(5)÷(6)** | *p*-value |'
  id: totrans-45
  prefs: []
  type: TYPE_TB
- en: '| Error (or “Residual”) | *N* − *k* | **(3)** | **(6)** |  |  |'
  id: totrans-46
  prefs: []
  type: TYPE_TB
- en: '| TOTAL | *N* | **(4)** |  |  |  |'
  id: totrans-47
  prefs: []
  type: TYPE_TB
- en: 'You calculate the values with these formulas:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
- en: '*Nx̄*²'
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![image](../images/f0439-02.jpg)'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_IMG
- en: '**(4)–(2)–(1)**'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![image](../images/f0439-03.jpg)'
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_IMG
- en: '**(2)**÷(*k* – 1)'
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**(3)**÷(*N* – *k*)'
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'There are three input sources that are assumed to make up the observed data,
    which, when added together, result in the TOTAL row. Let’s think about these in
    a little more detail:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
- en: '**Overall row** This relates to the scale on which the data as a whole sit.
    It doesn’t affect the outcome of the hypothesis test (since you’re interested
    only in the relative differences between means) and is sometimes removed from
    the table, affecting the TOTAL values accordingly.'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
- en: '**Group row/Factor row** This relates to the data in the individual groups
    of interest, thereby accounting for the *between-group variability*.'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
- en: '**Error row/Residual row** This accounts for the random deviation from the
    estimated means of each group, thereby accounting for the *within-group variability*.'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
- en: '**TOTAL row** This represents the raw data, based on the previous three ingredients.
    It is used to find the Error SS by differencing.'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
- en: The three input sources each have a corresponding degrees of freedom (df) value
    in the first column and a sum-of-squares (SS) value attached to the df in the
    second column. Between- and within-group variability is averaged by dividing the
    SS by the df, giving the mean squared (MS) component for these two items. The
    test statistic, *F*, is found by dividing the mean squared group (MSG) effect
    by the mean squared error (MSE) effect. This test statistic follows the *F*-distribution
    (refer to [Section 16.2.5](ch16.xhtml#ch16lev2sec145)), which itself requires
    a pair of degrees of freedom values ordered as df[1] (which represents the Group
    df, *k*−1) and df[2] (which represents the Error df, *N*−*k*). Like the chi-squared
    distribution, the *F*-distribution is unidirectional in nature, and the *p*-value
    is obtained as the upper-tail area from the test statistic *F*.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
- en: '***19.1.3 Building ANOVA Tables with the aov Function***'
  id: totrans-61
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'As you might expect, R allows you to easily construct an ANOVA table for the
    chick weight test using the built-in `aov` function as follows:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Then, the table is printed to the console screen using `summary`.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: There are several comments to make here. Note that you employ formula notation
    `weight~feed` to specify the measurement variable of interest, weight, as modeled
    by the categorical-nominal variable of interest, feed type. In this case, the
    variable names `weight` and `feed` are not required to be prefaced by `chickwts$`
    since the optional `data` argument has been passed the data frame of interest.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
- en: Remember from [Section 14.3.2](ch14.xhtml#ch14lev2sec125) that for the notation
    in the expression `weight~feed`, the “outcome” of interest must always appear
    on the left of the `~` (this notation will become particularly relevant in [Chapters
    20](ch20.xhtml#ch20) to [22](ch22.xhtml#ch22)).
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
- en: To actually view the table, you must apply the `summary` command to the object
    resulting from the call to `aov`. R omits the first and last rows (Overall and
    TOTAL) since these are not directly involved in calculating the *p*-value. Other
    than that, it’s easy to identify that the `feed` row refers to the Group row and
    the `Residuals` row refers to the Error row.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
- en: '**NOTE**'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
- en: '*By default, R annotates model-based* `summary` *output like this with* significance
    stars*. These show intervals of significance, and the number of stars increases
    as the p-value decreases beyond a cutoff mark of 0.1\. This can be useful when
    you’re examining more complicated analyses where multiple p-values are summarized,
    though not everyone likes this feature. If you want, you can turn off this feature
    in a given R session by entering* `options(show.signif.stars=FALSE)` *at the prompt.
    Alternatively, you can turn off the feature directly in the call to* `summary`
    *by setting the additional argument* `signif.stars=FALSE`*. In this book, I’ll
    leave them be.*'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
- en: From the contents of the ANOVA for this example, you can quickly confirm the
    calculations. Note that the MSE, 3009, was defined as the Error SS divided by
    the Error df. Indeed, in R, the same result is achieved manually (the table output
    has been rounded to the nearest integer).
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 从这个例子的ANOVA内容中，你可以快速确认计算结果。注意，MSE（均方误差）为3009，它被定义为误差平方和（Error SS）除以误差自由度（Error
    df）。实际上，在R中，手动计算也能得出相同的结果（表格输出已四舍五入到最接近的整数）。
- en: '[PRE7]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: You can confirm all the other results in the table output using the relevant
    equations from earlier.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过使用前面提到的相关公式，确认表格输出中的所有其他结果。
- en: Interpreting a hypothesis test based on ANOVA follows the same rules as any
    other test. With the understanding of a *p*-value as “the probability that you
    observe the sample statistics at hand or something more extreme, if H[0] is true,”
    a small *p*-value indicates evidence against the null hypothesis. In the current
    example, a tiny *p*-value provides strong evidence against the null that the mean
    chick weights are the same for the different diets. In other words, you reject
    H[0] in favor of H[A]; the latter states that there is a difference.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 解释基于ANOVA的假设检验遵循与其他任何检验相同的规则。通过理解*p*-值为“如果原假设H[0]为真，你观察到当前样本统计量或更极端的情况的概率”，一个小的*p*-值表明反对原假设的证据。在当前的例子中，一个极小的*p*-值提供了强有力的证据，反对均值相同的原假设，即不同饮食对小鸡体重的影响相同。换句话说，你拒绝原假设H[0]，支持备择假设H[A]；后者表示存在差异。
- en: In a similar fashion as in the chi-squared tests, rejection of the null in one-way
    ANOVA doesn’t tell you exactly where a difference lies, merely that there’s evidence
    one exists. Further scrutiny of the data in the individual groups is necessary
    to identify the offending means. At the simplest level, you could turn back to
    pairwise two-sample *t*-tests, in which case you could also use the MSE from the
    ANOVA table as an estimate of the pooled variance. The substitution is valid if
    the assumption of equal variance holds, and such a step is beneficial because
    the corresponding *t*-based sampling distribution will utilize the Error df (this
    is naturally higher than would otherwise be the case if the df was based on just
    the sample sizes of the two groups of specific interest).
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 与卡方检验类似，一元ANOVA中的原假设被拒绝并不能告诉你差异到底在哪里，仅仅表明有证据表明存在差异。需要对各个组的数据进行进一步审查，以确定存在问题的均值。在最简单的层面上，你可以回到成对的两样本*t*-检验，在这种情况下，你也可以使用ANOVA表中的MSE作为合并方差的估计。如果方差相等的假设成立，则这种替代是有效的，这一步是有益的，因为相应的基于*t*的抽样分布将利用误差自由度（Error
    df）（如果自由度仅基于两个特定组的样本大小，通常情况下该自由度会较低）。
- en: '**Exercise 19.1**'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '**习题 19.1**'
- en: 'Consider the following data:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑以下数据：
- en: '| **Site I** | **Site II** | **Site III** | **Site IV** |'
  id: totrans-78
  prefs: []
  type: TYPE_TB
  zh: '| **遗址 I** | **遗址 II** | **遗址 III** | **遗址 IV** |'
- en: '| --- | --- | --- | --- |'
  id: totrans-79
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| 93 | 85 | 100 | 96 |'
  id: totrans-80
  prefs: []
  type: TYPE_TB
  zh: '| 93 | 85 | 100 | 96 |'
- en: '| 120 | 45 | 75 | 58 |'
  id: totrans-81
  prefs: []
  type: TYPE_TB
  zh: '| 120 | 45 | 75 | 58 |'
- en: '| 65 | 80 | 65 | 95 |'
  id: totrans-82
  prefs: []
  type: TYPE_TB
  zh: '| 65 | 80 | 65 | 95 |'
- en: '| 105 | 28 | 40 | 90 |'
  id: totrans-83
  prefs: []
  type: TYPE_TB
  zh: '| 105 | 28 | 40 | 90 |'
- en: '| 115 | 75 | 73 | 65 |'
  id: totrans-84
  prefs: []
  type: TYPE_TB
  zh: '| 115 | 75 | 73 | 65 |'
- en: '| 82 | 70 | 65 | 80 |'
  id: totrans-85
  prefs: []
  type: TYPE_TB
  zh: '| 82 | 70 | 65 | 80 |'
- en: '| 99 | 65 | 50 | 85 |'
  id: totrans-86
  prefs: []
  type: TYPE_TB
  zh: '| 99 | 65 | 50 | 85 |'
- en: '| 87 | 55 | 30 | 95 |'
  id: totrans-87
  prefs: []
  type: TYPE_TB
  zh: '| 87 | 55 | 30 | 95 |'
- en: '| 100 | 50 | 45 | 82 |'
  id: totrans-88
  prefs: []
  type: TYPE_TB
  zh: '| 100 | 50 | 45 | 82 |'
- en: '| 90 | 40 | 50 |  |'
  id: totrans-89
  prefs: []
  type: TYPE_TB
  zh: '| 90 | 40 | 50 |  |'
- en: '| 78 |  | 45 |  |'
  id: totrans-90
  prefs: []
  type: TYPE_TB
  zh: '| 78 |  | 45 |  |'
- en: '| 95 |  | 55 |  |'
  id: totrans-91
  prefs: []
  type: TYPE_TB
  zh: '| 95 |  | 55 |  |'
- en: '| 93 |  |  |  |'
  id: totrans-92
  prefs: []
  type: TYPE_TB
  zh: '| 93 |  |  |  |'
- en: '| 88 |  |  |  |'
  id: totrans-93
  prefs: []
  type: TYPE_TB
  zh: '| 88 |  |  |  |'
- en: '| 110 |  |  |  |'
  id: totrans-94
  prefs: []
  type: TYPE_TB
  zh: '| 110 |  |  |  |'
- en: These figures provide the depths (in centimeters) at which important archaeological
    finds were made at four sites in New Mexico (see [Woosley and Mcintyre, 1996](ref.xhtml#ref77)).
    Store these data in your R workspace, with one vector containing depth and the
    other vector containing the site of each observation.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 这些图表提供了在新墨西哥州四个遗址上发现重要考古学发现的深度（单位：厘米）（参见[Woosley 和 Mcintyre, 1996](ref.xhtml#ref77)）。将这些数据存储在你的R工作区，其中一个向量包含深度，另一个向量包含每个观察点的遗址。
- en: Produce side-by-side boxplots of the depths split by group, and use additional
    points to mark the locations of the sample means.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 生成按组分割的深度箱型图，并使用额外的点来标出样本均值的位置。
- en: Assuming independence, execute diagnostic checks for normality and equality
    of variances.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 假设独立性成立，执行正态性和方差齐性的诊断检查。
- en: Perform and conclude a one-way ANOVA test for evidence of a difference between
    the means.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行并得出一元ANOVA检验的结论，以确认均值之间是否存在差异。
- en: In [Section 14.4](ch14.xhtml#ch14lev1sec47), you looked at the data set providing
    measurements on petal and sepal sizes for three species of iris flowers. This
    is available in R as `iris`.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第14.4节](ch14.xhtml#ch14lev1sec47)中，你查看了一个数据集，提供了三种鸢尾花物种的花瓣和花萼大小的测量数据。该数据集在R中可以通过`iris`访问。
- en: Based on diagnostic checks for normality and equality of variances, decide which
    of the four outcome measurements (sepal length/width and petal length/width) would
    be suitable for ANOVA (using the species as the group variable).
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基于正态性和方差齐性的诊断检查，决定哪四个结果测量（萼片长度/宽度和花瓣长度/宽度）适合方差分析（使用物种作为组变量）。
- en: Carry out one-way ANOVA for any suitable measurement variables.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对任何合适的测量变量执行单因素方差分析。
- en: '**19.2 Two-Way ANOVA**'
  id: totrans-102
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**19.2 二因素方差分析**'
- en: In many studies, the numeric outcome variable you’re interested in will be categorized
    by more than just one grouping variable. In these cases, you would use the *multiple-factor*
    ANOVA rather than the one-way ANOVA. This technique is directly referred to by
    the number of grouping variables used, with two- and three-way ANOVA being the
    next and most common extensions.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多研究中，您感兴趣的数值结果变量将不仅由一个分组变量进行分类。在这些情况下，您将使用*多因素*方差分析而不是单因素方差分析。这种技术直接通过使用的分组变量数量来指代，二因素和三因素方差分析是其下一个和最常见的扩展。
- en: Increasing the number of grouping variables complicates matters somewhat—performing
    just a one-way ANOVA for each variable separately is inadequate. In dealing with
    more than one categorical grouping factor, you must consider the *main effects*
    of each factor on the numeric outcome, while simultaneously accounting for the
    presence of the other grouping factor(s). That’s not all, though. It’s just as
    important to additionally investigate the idea of an *interactive effect*; if
    an interactive effect exists, then it suggests that the impact one of the grouping
    variables has on the outcome of interest, specified by its main effect, varies
    according to the levels of the other grouping variable(s).
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 增加分组变量的数量会使情况变得复杂一些——仅对每个变量分别执行单因素方差分析是不够的。在处理多个分类分组因素时，您必须考虑每个因素对数值结果的*主效应*，同时考虑其他分组因素的存在。但这还不是全部。同样重要的是额外研究*交互效应*的概念；如果存在交互效应，则表明一个分组变量对感兴趣的结果的影响（由其主效应指定）会根据其他分组变量的水平变化而变化。
- en: '***19.2.1 A Suite of Hypotheses***'
  id: totrans-105
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***19.2.1 一组假设***'
- en: 'For this explanation, denote your numeric outcome variable with *O* and your
    two grouping variables as *G[1]* and *G*[2]. In two-way ANOVA, the hypotheses
    should be set along the following lines:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 对于此说明，请用 *O* 表示您的数值结果变量，用 *G[1]* 和 *G*[2] 表示您的两个分组变量。在二因素方差分析中，假设应设置如下：
- en: 'H[0] : *G[1]* has no main (marginal) effect on the mean of *O*.'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: H[0]：*G[1]* 对 *O* 的均值没有主要（边际）影响。
- en: '*G*[2] has no main (marginal) effect on the mean of *O*.'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '*G*[2] 对 *O* 的均值没有主要（边际）影响。'
- en: There is no interactive effect of *G[1]* with *G[2]* on the mean of *O*.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '*G[1]* 与 *G*[2] 对 *O* 的均值没有交互效应。'
- en: 'H[A] : Separately, each statement in H[0] is incorrect.'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: H[A]：在H[0]中，各个声明分别不正确。
- en: You can see from these general hypotheses that you now have to obtain a *p*-value
    for each of the three components.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从这些一般性假设中看出，现在您必须为这三个组成部分中的每一个获取一个*p*-值。
- en: 'For the example, let’s use the built-in `warpbreaks` data frame ([Tippett,
    1950](ref.xhtml#ref65)), which provides the number of “warp break” imperfections
    (column `breaks`) observed in 54 pieces of yarn of equal length. Each piece of
    yarn is classified according to two categorical variables: `wool` (the type of
    yarn, with levels `A` and `B`) and `tension` (the level of tension applied to
    that piece—`L`, `M`, or `H` for low, medium, or high). Using `tapply`, you can
    inspect the mean number of warp breaks for each classification.'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，让我们使用内置的 `warpbreaks` 数据框架（[Tippett, 1950](ref.xhtml#ref65)），它提供了观察到的54根相同长度的纱线中的“断裂”缺陷数量（列
    `breaks`）。每根纱线根据两个分类变量进行分类：`wool`（纱线类型，具有 `A` 和 `B` 两个水平）和 `tension`（施加在该纱线上的张力水平，分别为
    `L`、`M` 或 `H`，分别代表低、中、高）。使用 `tapply`，您可以查看每个分类的平均断裂数。
- en: '[PRE8]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: You can supply more than one grouping variable to the `INDEX` argument as separate
    members of a list (any factor vectors given to this argument should be the same
    length as the first argument that specifies the data of interest). The results
    are returned as a matrix for two grouping variables, a 3D array for three grouping
    variables, and so on.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以将多个分组变量作为列表的单独成员提供给 `INDEX` 参数（此参数给定的任何因子向量应与指定感兴趣的数据的第一个参数的长度相同）。结果作为矩阵返回给两个分组变量，作为三个分组变量的3D数组返回给，依此类推。
- en: For some analyses, however, you might need the same information provided earlier
    in a different format. The `aggregate` function is similar to `tapply`, but it
    returns a data frame, the results in *stacked* format according to the specified
    grouping variables (as opposed to an array as returned by `tapply`). It’s called
    in much the same way. The first argument takes the data vector of interest. The
    second argument, `by`, should be a list of the desired grouping variables, and
    in `FUN`, you specify the function to operate on each subset.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，对于某些分析，你可能需要以不同的格式提供之前的信息。`aggregate`函数与`tapply`类似，但它返回的是一个数据框，结果按照指定的分组变量以*堆叠*格式呈现（与`tapply`返回的数组不同）。它的调用方式基本相同。第一个参数是你感兴趣的数据向量。第二个参数`by`应是所需分组变量的列表，而在`FUN`中，你指定要对每个子集操作的函数。
- en: '[PRE9]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Here I’ve stored the result of the call to `aggregate` as the object `wb.means`
    for later use.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我将对`aggregate`的调用结果存储为对象`wb.means`以供后续使用。
- en: '***19.2.2 Main Effects and Interactions***'
  id: totrans-118
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***19.2.2 主效应和交互效应***'
- en: 'I mentioned earlier that you could perform just a one-way ANOVA on each grouping
    variable separately, but this, in general, isn’t a good idea. I’ll demonstrate
    this now with the `warpbreaks` data (a quick inspection of the relevant diagnostics
    shows no obvious cause for concern):'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 我之前提到过，你可以分别对每个分组变量执行单因素方差分析，但通常这不是一个好主意。我现在将使用`warpbreaks`数据演示这一点（对相关诊断的快速检查显示没有明显的原因需要担忧）：
- en: '[PRE10]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: This output tells you that if you ignore `tension`, there is no evidence to
    suggest that there is any difference in the mean number of imperfections based
    on the type of `wool` alone (*p*-value 0.108). If you ignore `wool`, however,
    there *is* evidence to suggest a difference in warp breaks according to `tension`
    only.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 该输出告诉你，如果忽略`tension`，没有证据表明仅根据`wool`类型对经纱断裂的平均数量有任何差异（*p*-值为0.108）。然而，如果忽略`wool`，则*有*证据表明仅根据`tension`存在经纱断裂的差异。
- en: The problem here is that by ignoring one of the variables, you lose the ability
    to detect differences (or, more generally, statistical relationships) that may
    occur at a finer level. For example, though the `wool` type alone seems to have
    no remarkable impact on the mean number of warp breaks, you cannot tell whether
    this would be the case if you just looked at `wool` types at one particular level
    of `tension`.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的问题在于，忽略了其中一个变量后，你就失去了在更细致的层面上检测差异（或更一般地说，统计关系）的能力。例如，虽然单独看`wool`类型似乎对经纱断裂的平均数量没有显著影响，但你无法知道如果仅仅在某一特定的`tension`水平下查看`wool`类型时，情况是否会不同。
- en: 'Instead, you investigate this kind of question using two-way ANOVA. The following
    executes a two-way ANOVA for the warp breaks data based only on the main effects
    of the two grouping variables:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 相反，你使用双因素方差分析（two-way ANOVA）来研究这个问题。以下代码执行基于两个分组变量主效应的双因素方差分析，针对的是经纱断裂数据：
- en: '[PRE11]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Take a look at the formula. Specifying `wool+tension` to the right of the outcome
    variable and the `~` allows you to take both grouping variables into account at
    the same time. The results reveal a small drop in the size of the *p*-values now
    attached to each grouping variable; indeed, the *p*-value for `wool` is around
    0.073, approaching the conventional cutoff significance level of *α* = 0.05\.
    To interpret the results, you hold one grouping variable constant—if you focus
    on just one type of wool, there is still statistically significant evidence to
    suggest a difference in the mean number of warp breaks between the different `tension`
    levels. If you focus on just one level of `tension`, the evidence of a difference
    considering the two `wool` types has increased a little but is still not statistically
    significant (assuming the aforementioned *α* = 0.05).
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 看一下公式。指定`wool+tension`在结果变量右侧，`~`符号允许你同时考虑这两个分组变量。结果显示，现在附加在每个分组变量上的*p*-值略有下降；实际上，`wool`的*p*-值约为0.073，接近传统的显著性水平*α*
    = 0.05。为了解释结果，你保持一个分组变量不变——如果你只关注某一种类型的羊毛，仍然有统计学显著的证据表明不同`tension`水平之间的经纱断裂均值存在差异。如果你只关注某一特定的`tension`水平，考虑到两种`wool`类型的差异证据有所增加，但仍然不显著（假设上述的*α*
    = 0.05）。
- en: There’s still a limitation with considering only main effects. While the previous
    analysis shows that there’s variation in the outcome between the different levels
    of the two categorical variables, it doesn’t address the possibility that a difference
    in the mean number of warp breaks might vary further according to precisely *which*
    level of either `tension` or `wool` is being used when holding the other variable
    constant. This relatively subtle yet important consideration is known as an *interaction*.
    Specifically, if there is an interactive effect present between `tension` and
    `wool` with respect to warp breaks, then this would imply that the magnitude and/or
    direction of the difference in the mean number of warp breaks *is not the same*
    at different levels of the two grouping factors.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
- en: To account for interactions, you make a slight adjustment to the two-way ANOVA
    model code.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: You can explicitly specify the interaction as the main effects model formula
    *plus* the notation `wool:tension`, where the two grouping variables are separated
    by a `:`. (Note, in this setting, the `:` operator has nothing to do with the
    shortcut for creating an integer sequence first discussed in [Section 2.3.2](ch02.xhtml#ch02lev2sec21).)
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
- en: You can see from the ANOVA table output that, statistically, there is evidence
    of an interactive effect; that is, the very nature of the difference in the means
    is dependent upon the factor levels themselves, even though that evidence is relatively
    weak. Of course, the *p*-value of around 0.021 tells you only that, overall, there
    might be an interaction but not the precise features of the interaction.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
- en: To help with this, you can interpret such a two-way interaction effect in more
    detail with an *interaction plot*, provided in R with `interaction.plot`.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: When `interaction.plot` is called, the outcome means should be supplied to the
    argument `response`, and the vectors providing the corresponding levels of each
    of the two factors should be supplied to the arguments `x.factor` (for the variable
    on the horizontal axis that refers to moving between levels from the left to the
    right) and `trace.factor` (each level of which will produce a different line,
    referenced in an automatically produced legend; the title of this legend is passed
    to `trace.label`). It doesn’t matter which grouping variable is which; the appearance
    of the plot will change accordingly, but your interpretations will (should!) be
    the same. The result is shown in [Figure 19-2](ch19.xhtml#ch19fig2).
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
- en: The two-way interaction plot displays the outcome variable on the vertical axis
    and splits the recorded means by the levels of the two grouping variables. This
    allows you to inspect the potential effect that varying the levels of the grouping
    variables has on the outcome. In general, when the lines (or segments thereof)
    are not parallel, it suggests an interaction could be present. Vertical separations
    between the plotted locations indicate the individual main effects of the grouping
    variables.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
- en: It turns out that the columns returned by a call to `aggregate` are actually
    perfectly suited to `interaction.plot`. As usual, you can specify the common graphical
    parameters, like those you initially encountered in [Section 7.2](ch07.xhtml#ch07lev1sec24),
    to control specific features of the plot and axis annotation. For [Figure 19-2](ch19.xhtml#ch19fig2),
    you’ve specified that `x.factor` should be the second column of the `wb.means`
    matrix, meaning that the `tension` levels vary horizontally. The `trace.factor`
    here is the type of `wool`, so there are only two distinct lines corresponding
    to the two levels `A` and `B`. The `response` is that third column of `wb.means`,
    extracted using `$x` (take a look at the `wb.means` object; you’ll see the column
    containing the results of interest is labeled `x` by default after a call to `aggregate`).
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f19-02.jpg)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
- en: '*Figure 19-2: An interaction plot for the full two-way ANOVA model of the*
    `warpbreaks` *data set*'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
- en: Considering the actual appearance of the plot in [Figure 19-2](ch19.xhtml#ch19fig2),
    it does indeed appear that the mean number of warp breaks for wool type `A` is
    higher if `tension` is low, but the nature of the difference changes if you move
    to a medium tension, where `B` has a higher point estimate than `A`. Moving to
    a high tension, type `A` again has a higher estimate of the mean number of breaks
    than `B`, though here the difference between `A` and `B` is nowhere near as big
    as it is at a low tension. (Note, however, that the interaction plot does not
    display any kind of standard error measurements, so you must remember that all
    point estimates of the means are subject to variability.)
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
- en: Interactions are certainly not a concept unique to multiple-factor ANOVA; they
    form an important consideration in many different types of statistical models.
    For the moment, it’s good just to gain a basic appreciation of interactions.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
- en: '**19.3 Kruskal-Wallis Test**'
  id: totrans-140
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: When comparing multiple means, there may be situations when you’re unwilling
    to assume normality or have even found the assumption of normality invalid in
    diagnostic checks. In this case, you can use the *Kruskal-Wallis test*, an alternative
    to the one-way ANOVA that relaxes the dependence on the necessity for normality.
    This method tests for “equality of distributions” of the measurements in each
    level of the grouping factor. If you make the usual assumption of equal variances
    across these groups, you can therefore think of this test as one that compares
    multiple medians rather than means.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
- en: The hypotheses governing the test alter accordingly.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
- en: 'H[0] : Group medians are all equal.'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
- en: 'H[A] : Group medians are not all equal'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
- en: (alternatively, at least one group median differs).
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
- en: The Kruskal-Wallis test is a *nonparametric* approach since it does not rely
    on quantiles of a standardized parametric distribution (in other words, the normal
    distribution) or any of its functions. In the same way that the ANOVA is a generalization
    of the two-sample *t*-test, the Kruskal-Wallis ANOVA is a generalization of the
    Mann-Whitney test for two medians. It’s also referred to as the Kruskal-Wallis
    *rank sum* test, and you use the chi-squared distribution to calculate the *p*-value.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
- en: Turn your attention to the data frame `survey`, located in the `MASS` package.
    These data record particular characteristics of 237 first-year undergraduate statistics
    students collected from a class at the University of Adelaide, South Australia.
    Load the required package first with a call to `library("MASS")` and then enter
    `?survey` at the prompt. You can read the help file to understand which variables
    are present in the data frame.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
- en: 'Suppose you’re interested to see whether the age of the students, `Age`, tends
    to differ with respect to four smoking categories reported in `Smoke`. An inspection
    of the relevant side-by-side boxplots and a normal QQ plot of the residuals (mean-centered
    observations with respect to each group) suggests a straightforward one-way ANOVA
    isn’t necessarily a good idea. The following code (which mimics the steps you
    saw in [Section 19.1.1](ch19.xhtml#ch19lev2sec168)) produces the two images in
    [Figure 19-3](ch19.xhtml#ch19fig3), which show normality is questionable:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: With this possible violation of normality, you could therefore apply the Kruskal-Wallis
    test instead of the parametric ANOVA. A quick check for equality of variances
    further supports this, with the ratio of the largest to the smallest group standard
    deviations clearly being less than 2.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '![image](../images/f19-03.jpg)'
  id: totrans-152
  prefs: []
  type: TYPE_IMG
- en: '*Figure 19-3: Side-by-side boxplots (left) and a normal QQ plot of the residuals
    (right) for the student age observations split by smoking status*'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
- en: In R, a Kruskal-Wallis test is performed using `kruskal.test`.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: The syntax for this test is the same as for `aov`. As you might suspect from
    [Figure 19-3](ch19.xhtml#ch19fig3), the large *p*-value suggests there’s no evidence
    against the null hypothesis that states that the medians are all equal. In other
    words, there doesn’t seem to be an overall age difference between the students
    in the four smoking categories.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
- en: '**Exercise 19.2**'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
- en: Bring up the `quakes` data frame again, which describes the locations, magnitudes,
    depths, and number of observation stations that detected 1,000 seismic events
    off the coast of Fiji.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
- en: 'Use `cut` (see [Section 4.3.3](ch04.xhtml#ch04lev2sec48)) to create a new factor
    vector defining the depths of each event according to the following three categories:
    (0,200], (200,400], and (400,680].'
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Decide whether a one-way ANOVA or a Kruskal-Wallis test is more appropriate
    to use to compare the distributions of the number of detecting stations, split
    according to the three categories in (a).
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Perform your choice of test in (b) (assume a *α* = 0.01 level of significance)
    and conclude.
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Load the `MASS` package with a call to `library("MASS")` if you haven’t already
    done so in the current R session. This package includes the ready-to-use `Cars93`
    data frame, which contains detailed data on 93 cars for sale in the United States
    in 1993 ([Lock, 1993](ref.xhtml#ref43); [Venables and Ripley, 2002](ref.xhtml#ref69)).
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
- en: 'Use `aggregate` to compute the mean length of the 93 cars, split by two categorical
    variables: `AirBags` (type of airbags available—levels are `Driver & Passenger`,
    `Driver only`, and `None`), and `Man.trans.avail` (whether the car comes in a
    manual transmission—levels are `Yes` and `No`).'
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Produce an interaction plot using the results in (d). Does there appear to be
    an interactive effect of `AirBags` with `Man.trans.avail` on the mean length of
    these cars (if you consider only these variables)?
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Fit a full two-way ANOVA model for the mean lengths according to the two grouping
    variables (assume satisfaction of all relevant assumptions). Is the interactive
    effect statistically significant? Is there evidence of any main effects?
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Important Code in This Chapter**'
  id: totrans-166
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: '| **Function/operator** | **Brief description** | **First occurrence** |'
  id: totrans-167
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  id: totrans-168
  prefs: []
  type: TYPE_TB
- en: '| `aov` | Produce ANOVA table | [Section 19.1.3](ch19.xhtml#ch19lev2sec170),
    [p. 440](ch19.xhtml#page_440) |'
  id: totrans-169
  prefs: []
  type: TYPE_TB
- en: '| `aggregate` | Stacked statistics by factor | [Section 19.2.1](ch19.xhtml#ch19lev2sec171),
    [p. 444](ch19.xhtml#page_444) |'
  id: totrans-170
  prefs: []
  type: TYPE_TB
- en: '| `interaction.plot` | Two-factor interaction plot | [Section 19.2.2](ch19.xhtml#ch19lev2sec172),
    [p. 446](ch19.xhtml#page_446) |'
  id: totrans-171
  prefs: []
  type: TYPE_TB
- en: '| `kruskal.test` | Kruskal-Wallis test | [Section 19.3](ch19.xhtml#ch19lev1sec61),
    [p. 449](ch19.xhtml#page_449) |'
  id: totrans-172
  prefs: []
  type: TYPE_TB
