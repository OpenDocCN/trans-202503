<html><head></head><body>
<h2 class="h2" id="ch06"><span epub:type="pagebreak" id="page_97"/>6<br/>MANIPULATING MINECRAFT</h2>&#13;
<p class="noindent"><span class="big1">IN THIS CHAPTER, YOU’LL WRITE PYTHON PROGRAMS TO HACK INTO THE MINECRAFT ENVIRONMENT SO YOU CAN DO SOME COOL THINGS. YOU’LL SEND MESSAGES TO THE MINECRAFT WORLD AND TURN ITS GRASS INTO TRAMPOLINES. THEN YOU’LL WRITE YOUR FIRST MINECRAFT GAME, <em>SAND DROP</em>, WHERE PLAYERS DODGE FALLING BLOCKS OF SAND. <span epub:type="pagebreak" id="page_98"/>USING YOUR GLUE GUN LED LIGHT THAT YOU BUILT IN <a href="ch03.xhtml#ch03"><span class="big1">CHAPTER 3</span></a>, YOU’LL ADD REAL-WORLD HARDWARE THAT YOU’LL CONTROL FROM MINECRAFT. COMBINING THE POWER OF MINECRAFT WITH THE PI CAMERA, YOU’LL CREATE A HIDDEN CAMERA YOU CONTROL WITH TOWERS OF GOLD, BRICK, AND MELONS!</span></p>&#13;
<h3 class="h3" id="ch06lev1sec1">WHAT YOU’LL NEED</h3>&#13;
<p class="noindent">For most of the projects in this chapter, you’ll be coding in Python and Minecraft, so you don’t need many items beyond your Pi and a computer. Here are the few additional items you need:</p>&#13;
<ul>&#13;
<li class="noindent">Raspberry Pi</li>&#13;
<li class="noindent">Your glue gun LED light or a new LED with a 220–330 ohm resistor</li>&#13;
<li class="noindent">Jumper wires</li>&#13;
<li class="noindent">Pi Camera</li>&#13;
</ul>&#13;
<h3 class="h3" id="ch06lev1sec2">MINECRAFT ON THE RASPBERRY PI</h3>&#13;
<p class="noindent">Chances are you’re already familiar with Minecraft, but just in case you’re not, here’s a description: Minecraft is a game where you mine, craft, and create all kinds of weird and wonderful objects within a 3D world that consists of various terrains, habitats, and materials. It’s often described as a computer-game version of LEGO. The world is free roaming: you, as the main character Steve or Alex, can travel wherever you want to, see what you want to, and basically do what you want to.</p>&#13;
<p class="indent">The Raspberry Pi operating system comes preinstalled with a Minecraft Pi Edition. This is a stripped-down version of the game that lets you hack the Minecraft world through a range of programming languages, including Python, which is what we’ll use here.</p>&#13;
<h4 class="h4" id="ch06lev2sec1">Starting Minecraft</h4>&#13;
<p class="noindent">Boot up your Raspberry Pi and click the Pi symbol at the top left of the screen. A drop-down menu appears. Scroll down to and click the <strong>Games</strong> tab. The option to open Minecraft appears. Click this option to load the Minecraft Pi Edition, as shown in <a href="ch06.xhtml#ch06fig01">Figure 6-1</a>. Loading will take between a few seconds and a full minute, depending on which Pi model you’re using. Minecraft loads fastest on the Pi 4 model.</p>&#13;
<div class="image"><img alt="Image" src="../images/06fig01.jpg"/></div>&#13;
<p class="figcap" id="ch06fig01"><strong>FIGURE 6-1</strong> Loading Minecraft Pi Edition</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_99"/>Using Minecraft on the Pi is the same as using it on your computer. The Pi uses a classic keyboard-control layout to move your player around the world. But the Pi Edition has something extra: it allows you to <em>fly</em>, meaning you can quickly travel to other locations. You do this by pressing the spacebar twice, using the arrow keys for direction, and using your mouse to control the player’s view (as usual).</p>&#13;
<p class="indent">The other control you’ll use in these hacks is the <span class="small">TAB</span> key. It releases the mouse from the Minecraft controls so you can use it to click elsewhere. This means you can select the Python programming interface and either write new code or select your program to run. Then you can launch Minecraft and double-click either the left or right mouse button in the middle of the world: the mouse movement will control the player’s view again.</p>&#13;
<p class="indent">This table shows the keys for the main Minecraft controls.</p>&#13;
<table class="table1">&#13;
<colgroup>&#13;
<col style="width:40%"/>&#13;
<col style="width:60%"/>&#13;
</colgroup>&#13;
<thead>&#13;
<tr>&#13;
<td class="table-h" style="vertical-align: top;"><p class="tab_th"><strong>KEY</strong></p></td>&#13;
<td class="table-h1" style="vertical-align: top;"><p class="tab_th"><strong>ACTION</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple">W</span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">Move forward</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple">A</span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">Move left</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple">S</span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">Move backward</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple">D</span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">Move right</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple">E</span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">Load inventory</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple">Spacebar</span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">Jump</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple">Double spacebar</span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">Fly/fall</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple"><span class="small">SHIFT</span></span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">Float downward</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple"><span class="small">ESC</span></span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">Pause/Game menu</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple"><span class="small">TAB</span></span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">Release mouse cursor</span></p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<h4 class="h4" id="ch06lev2sec2"><span epub:type="pagebreak" id="page_100"/>Finding Yourself: Using the X-, Y-, and Z- Coordinates</h4>&#13;
<p class="noindent">Although the Pi Edition of the Minecraft world is not as large as the full game, it’s still easy to get lost. To locate the player in the world, the game uses x-, y-, and z- coordinates, as shown in <a href="ch06.xhtml#ch06fig02">Figure 6-2</a>.</p>&#13;
<div class="image"><img alt="Image" src="../images/06fig02.jpg"/></div>&#13;
<p class="figcap" id="ch06fig02"><strong>FIGURE 6-2</strong> The x-, y-, and z- coordinates are located at the top left of the window.</p>&#13;
<p class="indent">These three values are an essential part of the game. They ensure that the things you make happen in your program happen at your player’s location. You’ll use these coordinates in your programs.</p>&#13;
<p class="indent">The coordinate values display at the top left of the screen. All values are measured from the middle of the game world. So, if you’re at the x, y, and z values 0.0, 0.0, 0.0, you’re in the exact center of the world. A negative, or minus, x value means the player is to the left of the world’s midpoint; a negative y value means the player is below the midpoint; and a negative z value means the player is behind the midpoint. For example, 0.0, -45.7, 0.0 means the player is 45.7 blocks lower than the middle of the world. But the worlds are randomly generated, so the size of the worlds varies. This table lists the maximum and minimum values of these coordinates.</p>&#13;
<table class="table1">&#13;
<colgroup>&#13;
<col style="width:25%"/>&#13;
<col style="width:25%"/>&#13;
<col style="width:25%"/>&#13;
<col style="width:25%"/>&#13;
</colgroup>&#13;
<thead>&#13;
<tr>&#13;
<td class="table-h" style="vertical-align: top;"><p class="tab_th"><strong>COORDINATE</strong></p></td>&#13;
<td class="table-h1" style="vertical-align: top;"><p class="tab_th"><strong>INDICATES</strong></p></td>&#13;
<td class="table-h" style="vertical-align: top;"><p class="tab_th"><strong>MINIMUM VALUE</strong></p></td>&#13;
<td class="table-h1" style="vertical-align: top;"><p class="tab_th"><strong>MAXIMUM VALUE</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple">x</span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">Left and right movement</span></p></td>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple">-255</span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">+255</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple">y</span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">Up and down movement</span></p></td>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple">-128</span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">+128</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple">z</span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">Forward and backward movement</span></p></td>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple">-255</span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">+255</span></p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<h4 class="h4" id="ch06lev2sec3"><span epub:type="pagebreak" id="page_101"/>Hacking Minecraft</h4>&#13;
<p class="noindent">Let’s start hacking Minecraft! The Raspberry Pi operating system lets you connect directly to Minecraft by using Python code. You can develop and write your programs, open and start a Minecraft game, run your code, and then return to the Minecraft world to see the effects in action.</p>&#13;
<p class="indent">When you’re running your hacking programs, unless you’re using a Raspberry Pi 4, don’t run Minecraft in full-screen mode; instead, keep the window at its default size. Full-screen mode prevents you from viewing your code or any program errors and puts a huge demand on the graphics card, creating lag in the game. If you are using the Pi 4, feel free to use full-screen mode! Also, because of a bug in the Minecraft program, full-screen mode prevents you from accessing the last line of items in your inventory.</p>&#13;
<h3 class="h3" id="ch06lev1sec3">POSTING A MESSAGE TO CHAT</h3>&#13;
<p class="noindent">We’ll start with a simple program that will post a message to the Minecraft world, as shown in <a href="ch06.xhtml#ch06fig03">Figure 6-3</a>. This hack is only three lines and will teach you how the interaction between Python and Minecraft works.</p>&#13;
<div class="image"><img alt="Image" src="../images/06fig03.jpg"/></div>&#13;
<p class="figcap" id="ch06fig03"><strong>FIGURE 6-3</strong> Displaying a chat message in Minecraft</p>&#13;
<h4 class="h4" id="ch06lev2sec4"><span epub:type="pagebreak" id="page_102"/>Coding the Chat Messenger</h4>&#13;
<p class="noindent">To begin your first hack, open Python and start a new file. Then enter the program code in <a href="ch06.xhtml#ch06ex01">Listing 6-1</a>. Remember that you can download the program from <em><a href="https://www.nostarch.com/raspiforkids/">https://www.nostarch.com/raspiforkids/</a></em> and either use it to compare against your program or just run the <em>first_program.py</em> file from the download.</p>&#13;
<pre><span class="codeorg">from</span> mcpi <span class="codeorg">import</span> minecraft&#13;
mc = minecraft.Minecraft.create()&#13;
mc.postToChat(<span class="codegreen1">"Welcome to my first Minecraft hack"</span>)</pre>&#13;
<p class="caption"><a id="ch06ex01"/><strong>LISTING 6-1</strong> The Minecraft messaging program</p>&#13;
<p class="indent">First, import the <span class="literal">mcpi</span> library, which enables you to use Python to control Minecraft. This library tells the program to open and run in Minecraft. To trigger events within the Minecraft world, use the library’s <span class="literal">minecraft.Minecraft.create()</span> function to create a connection from Python to Minecraft. Store that function in the variable <span class="literal">mc</span> so you don’t have to type it each time. Then use the <span class="literal">postToChat()</span> function, after your newly created <span class="literal">mc</span> variable, to display a message in the Minecraft game. You can change the message inside the quotes to anything you want to display.</p>&#13;
<h4 class="h4" id="ch06lev2sec5">Running Your Program</h4>&#13;
<p class="noindent">To run the program, save the file and then open Minecraft. Start a game and wait for the world to load. Once it’s loaded, press <span class="small">TAB</span> to release the mouse from the game so you can use it to find your hack. Next, select your Python program (open it if you closed it), and execute it by pressing <strong>F5</strong>. Your program will start running in Minecraft automatically. Return to the Minecraft game by selecting it with either one of the mouse buttons. Your custom message should appear. Congratulations! You’ve made your first Minecraft hack! Now let’s do something a bit more adventurous.</p>&#13;
<h3 class="h3" id="ch06lev1sec4">TRAMPOLINE GRASS</h3>&#13;
<p class="noindent">This trampoline project walks you through creating your first proper interactive program. Each time you step onto a block of grass, you’ll spring into the air just like you’re on a trampoline, as shown in <a href="ch06.xhtml#ch06fig04">Figure 6-4</a>.</p>&#13;
<div class="image"><img alt="Image" src="../images/06fig04.jpg"/></div>&#13;
<p class="figcap" id="ch06fig04"><strong>FIGURE 6-4</strong> <span epub:type="pagebreak" id="page_103"/>Turn all grass into a trampoline</p>&#13;
<h4 class="h4" id="ch06lev2sec6">Coding the Trampoline Grass</h4>&#13;
<p class="noindent">Begin the hack by opening Python and starting a new file. Enter the program code in <a href="ch06.xhtml#ch06ex02">Listing 6-2</a>. Remember that you can download the program from <em><a href="https://www.nostarch.com/raspiforkids/">https://www.nostarch.com/raspiforkids/</a></em> and either use it to compare against your program or just run the <em>trampoline.py</em> file from the download.</p>&#13;
<pre><span class="codeorg">from</span> mcpi <span class="codeorg">import</span> minecraft&#13;
mc = minecraft.Minecraft.create()&#13;
&#13;
<span class="ent">❶</span> <span class="codeorg">while True</span>:&#13;
      <span class="ent">❷</span> p = mc.player.getTilePos()&#13;
      <span class="ent">❸</span> b = mc.getBlock(p.x,p.y-1,p.z)      &#13;
      <span class="ent">❹</span> <span class="codeorg">if</span> b == 2: <span class="codered"># grass</span>&#13;
          <span class="ent">❺</span> mc.player.setPos(p.x, p.y+20, p.z)&#13;
</pre>&#13;
<p class="caption"><a id="ch06ex02"/><strong>LISTING 6-2</strong> The trampoline grass program</p>&#13;
<p class="indent">Import the <span class="literal">minecraft</span> module from the <span class="literal">mcpi</span> library again so you can use Python to control Minecraft. Save the <span class="literal">minecraft.Minecraft.create()</span> connection into a variable named <span class="literal">mc</span> again.</p>&#13;
<p class="indent">Then create a <span class="literal">while</span> loop <span class="ent">❶</span>, which, as you might remember from <a href="ch02.xhtml#ch02">Chapter 2</a>, makes sure the program keeps running. Also, remember to indent the code after the <span class="literal">while</span> line four spaces because it belongs in the loop.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_104"/>In the loop, you find and return the current position of your player within the Minecraft environment <span class="ent">❷</span> and the type of block the player is standing on <span class="ent">❸</span>. This is important because only the grass is springy, not any other ground. This position is returned as an ID number, and you store it in a variable called <span class="literal">b</span>. You subtract 1 from the y position of the block, which is the up-and-down coordinate. The reason is that you want to affect the block <em>below</em> the player, not the actual player.</p>&#13;
<p class="indent">Use a conditional to check the kind of ground you’re standing on <span class="ent">❹</span>. Each type of block has an ID value, and the value for a grass block is <span class="literal">2</span>. So you check whether the block ID value stored in variable <span class="literal">b</span> is equal to <span class="literal">2</span> and run the code to make the grass bouncy only if it has that value.</p>&#13;
<p class="indent">When the conditional finds that the player <em>is</em> indeed standing on grass, you use <span class="literal">setPos()</span> to send the player up in the air to a new y position <span class="ent">❺</span>. You want to send the player up, not across, so you keep the same x and z positions but add 20 to the y value. The player should shoot into the air.</p>&#13;
<h4 class="h4" id="ch06lev2sec7">Running Your Program</h4>&#13;
<p class="noindent">As before, save your program and make sure Minecraft is open. Resume your game and wait for the world to load. Press <span class="small">TAB</span> to release the mouse from the game, and then select your Python program. Execute it by pressing <strong>F5</strong>, and return to the Minecraft window by clicking it with the mouse. Walk around and watch out for that grass!</p>&#13;
<p class="indent">If you’re getting any errors, check that you’ve followed the same indentation spacing as in <a href="ch06.xhtml#ch06ex02">Listing 6-2</a>. Also, make sure you included the colon after the <span class="literal">while True</span> and <span class="literal">if</span> lines.</p>&#13;
<h4 class="h4" id="ch06lev2sec8">Taking It Further</h4>&#13;
<p class="noindent">You can alter your program to make the player go higher, lower, or even underground—a kind of antigravity trampoline—by changing the <span class="literal">p.y</span> number in <span class="literal">mc.player.setPos()</span>. Try a few numbers to see the effect. As another challenge, try changing the trigger block ID so the water triggers the trampoline instead. Check out the IDs at <em><a href="https://www.raspberrypi-spy.co.uk/2014/09/raspberry-pi-minecraft-block-id-number-reference/">https://www.raspberrypi-spy.co.uk/2014/09/raspberry-pi-minecraft-block-id-number-reference/</a></em>.</p>&#13;
<h3 class="h3" id="ch06lev1sec5">THE SAND DROP GAME</h3>&#13;
<p class="noindent">Now you’ll make your first game, called <em>Sand Drop</em>. In this simple game, blocks of sand drop from the sky, and the player has to dodge <span epub:type="pagebreak" id="page_105"/>them. In the Minecraft environment, the sand block is automatically affected by gravity: if you set a sand block above the player, it will fall downward, landing on the player if they don’t move in time. If one of the blocks hits the player, it’s <em>game over</em>.</p>&#13;
<p class="indent">You’ll program the sand blocks to follow you as you move around the world (<a href="ch06.xhtml#ch06fig05">Figure 6-5</a>), so don’t think you can run away. The sand is out to get you!</p>&#13;
<div class="image"><img alt="Image" src="../images/06fig05.jpg"/></div>&#13;
<p class="figcap" id="ch06fig05"><strong>FIGURE 6-5</strong> The <em>Sand Drop</em> game</p>&#13;
<h4 class="h4" id="ch06lev2sec9">Coding the Sand Drop Game</h4>&#13;
<p class="noindent">Begin the hack by opening Python and starting a new file. Enter the program code in <a href="ch06.xhtml#ch06ex03">Listing 6-3</a>. Remember that you can download the program from <em><a href="https://www.nostarch.com/raspiforkids/">https://www.nostarch.com/raspiforkids/</a></em> and either use it to compare against your program or just run the <em>sand_drop.py</em> file from the download.</p>&#13;
<pre><span class="codeorg">from</span> mcpi <span class="codeorg">import</span> minecraft&#13;
mc = minecraft.Minecraft.create()&#13;
<span class="codeorg">from</span> time <span class="codeorg">import</span> sleep&#13;
&#13;
<span class="ent">❶</span> sleep(5)&#13;
pos = mc.player.getTilePos()&#13;
&#13;
<span class="ent">❷</span> <span class="codeorg">while</span> mc.getBlock(pos.x, pos.y, pos.z) != 13:&#13;
     mc.setBlock(pos.x, pos.y + 25, pos.z, 13)&#13;
     sleep(1)&#13;
     pos = mc.player.getTilePos()&#13;
<span class="ent">❸</span> mc.postToChat(<span class="codegreen1">"Got you!"</span>)&#13;
</pre>&#13;
<p class="caption"><a id="ch06ex03"/><strong>LISTING 6-3</strong> The <em>Sand Drop</em> game program</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_106"/>As with previous hacks, begin by importing the <span class="literal">minecraft</span> library and storing the event trigger in the <span class="literal">mc</span> variable to keep it simple and save you from having to type <span class="literal">minecraft.Minecraft.create()</span> each time.</p>&#13;
<p class="indent">Also import the <span class="literal">sleep()</span> function from the <span class="literal">time</span> module, which adds a small delay between each block dropping. This gives you some time to dodge each block. Add a short time delay after the game begins and before the blocks start falling <span class="ent">❶</span> to give you time to return to the game from the Python window. The blocks will follow you around, so you need to get the player’s x, y, and z position data. Use a <span class="literal">while</span> loop to check whether a sand block has hit you <span class="ent">❷</span>. The loop does this by checking the block’s ID at the same position as the player. If it’s not block ID 13—the sand block—you haven’t been hit. Yet.</p>&#13;
<p class="indent">If you haven’t been hit, the next line runs to place and drop a new sand block. Note that the block’s y position is +25, meaning that the block is placed 25 blocks above you before it drops. Then you wait for 1 second before running the next line of code, which takes the player’s new x, y, and z position reading in case you’ve moved. If a sand block does hit you, a message is posted to the Minecraft world, and it’s game over for you <span class="ent">❸</span>.</p>&#13;
<h4 class="h4" id="ch06lev2sec10">Running Your Program</h4>&#13;
<p class="noindent">As before, save your program as <em>sand_drop.py</em>, make sure Minecraft is open, and start or resume a game. Release the mouse by pressing <span class="small">TAB</span>, and select and execute your Python program. Return to your Minecraft game, and get ready to dodge that falling sand.</p>&#13;
<h4 class="h4" id="ch06lev2sec11">Taking It Further</h4>&#13;
<p class="noindent">If you want to test your reflexes, try changing the height of the block to make the game more challenging. If the blocks are closer to the player when they start falling, you’ll have less time to react. You could also reduce the delay or <span class="literal">sleep()</span> time between each block dropping.</p>&#13;
<p class="indent">Different blocks in Minecraft have different physics. Test the world by changing the block from sand to another type. This will alter how the block falls: it might be slower, it might be faster, or it might land in a different location, affecting how you play the game. Try the blocks in the following table for starters.</p>&#13;
<table class="table1">&#13;
<colgroup>&#13;
<col style="width:60%"/>&#13;
<col style="width:40%"/>&#13;
</colgroup>&#13;
<thead>&#13;
<tr>&#13;
<td class="table-h" style="vertical-align: top;"><p class="tab_th"><span epub:type="pagebreak" id="page_107"/><strong>BLOCK TYPE</strong></p></td>&#13;
<td class="table-h1" style="vertical-align: top;"><p class="tab_th"><strong>BLOCK ID</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple">Water</span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">9</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple">Lava</span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">10</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-b1" style="vertical-align: top;"><p class="tabc"><span class="purple">Gravel</span></p></td>&#13;
<td class="table-b1a" style="vertical-align: top;"><p class="tabc"><span class="purple">13</span></p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent">A list of all the block IDs is at <em><a href="https://www.raspberrypi-spy.co.uk/2014/09/raspberry-pi-minecraft-block-id-number-reference/">https://www.raspberrypi-spy.co.uk/2014/09/raspberry-pi-minecraft-block-id-number-reference/</a></em>.</p>&#13;
<h3 class="h3" id="ch06lev1sec6">MINECRAFT-CONTROLLED LED</h3>&#13;
<p class="noindent">In this project, you’ll write a program that lets you use Minecraft to control the glue gun LED light that you made in <a href="ch03.xhtml#ch03">Chapter 3</a>. Whenever you touch water in the Minecraft world, the light in the real world will turn on. When you leave the water, the light will turn off.</p>&#13;
<h4 class="h4" id="ch06lev2sec12">Wiring the Minecraft LED</h4>&#13;
<p class="noindent">Using either your custom glue gun light from <a href="ch03.xhtml#ch03">Chapter 3</a> or a new LED, attach one male-to-female jumper wire to each of the LED legs. Attach the <em>longer</em> positive leg to GPIO pin 18: this is physical pin 12 on the Pi. Connect the other jumper wire to any one of the ground pins: choose from physical number 9, 14, 20, 30, 34, or 39. <a href="ch06.xhtml#ch06fig06">Figure 6-6</a> shows the wiring diagram.</p>&#13;
<div class="image"><img alt="Image" src="../images/06fig06.jpg"/></div>&#13;
<p class="figcap" id="ch06fig06"><strong>FIGURE 6-6</strong> Wiring up the LED</p>&#13;
<h4 class="h4" id="ch06lev2sec13"><span epub:type="pagebreak" id="page_108"/>Coding the Minecraft LED</h4>&#13;
<p class="noindent">Open a new Python file and enter the code in <a href="ch06.xhtml#ch06ex04">Listing 6-4</a>.</p>&#13;
<pre><span class="ent">❶</span> <span class="codeorg">from</span> gpiozero <span class="codeorg">import</span> LED&#13;
   <span class="codeorg">import</span> time&#13;
&#13;
   <span class="codeorg">from</span> mcpi.minecraft <span class="codeorg">import</span> Minecraft&#13;
<span class="ent">❷</span> mc = Minecraft.create()&#13;
&#13;
<span class="ent">❸</span> led = LED(18)&#13;
&#13;
<span class="ent">❹</span> <span class="codeorg">while True</span>:&#13;
       x,y,z = mc.player.getPos()&#13;
    <span class="ent">❺</span> block_id = mc.getBlock(x, y, z)&#13;
&#13;
    <span class="ent">❻</span> <span class="codeorg">if</span> block_id == 9: <span class="codered"># 9 = water</span>&#13;
           led.on()&#13;
       <span class="codeorg">else</span>:&#13;
           led.off()</pre>&#13;
<p class="caption"><a id="ch06ex04"/><strong>LISTING 6-4</strong> The Minecraft LED program</p>&#13;
<p class="indent">Begin by importing the <span class="literal">LED</span> class from the <span class="literal">gpiozero</span> library <span class="ent">❶</span>, as you did in <a href="ch03.xhtml#ch03">Chapter 3</a>. Also import the <span class="literal">time</span> module, so you can add a delay if required, and the <span class="literal">minecraft</span> library. Again, set the variable <span class="literal">mc</span> to hold the <span class="literal">minecraft</span> library code <span class="ent">❷</span>.</p>&#13;
<p class="indent">Tell the Pi that the LED is attached to pin 18 <span class="ent">❸</span> and create a <span class="literal">while</span> loop <span class="ent">❹</span> so the program keeps running the next few indented lines. Then get the player’s x, y, and z position data. Use the <span class="literal">getBlock()</span> function to find out the ID of the block you’re standing on and store this ID in a variable called <span class="literal">block_id</span> <span class="ent">❺</span>. Recall that you can check the IDs online at <em><a href="https://www.raspberrypi-spy.co.uk/2014/09/raspberry-pi-minecraft-block-id-number-reference/">https://www.raspberrypi-spy.co.uk/2014/09/raspberry-pi-minecraft-block-id-number-reference/</a></em>.</p>&#13;
<p class="indent">Check whether the block ID is equal to 9, the ID for water <span class="ent">❻</span>. If it is, the LED will turn on. If you aren’t standing on water, the LED will be off.</p>&#13;
<h4 class="h4" id="ch06lev2sec14">Running Your Program</h4>&#13;
<p class="noindent">Save your program, open Minecraft, and press <span class="small">TAB</span> to release the mouse. Select your program and execute it by pressing <strong>F5</strong>. Return to your Minecraft game and find some water! When the character stands in water, the LED should light up, as shown in <a href="ch06.xhtml#ch06fig07">Figure 6-7</a>.</p>&#13;
<div class="image"><img alt="Image" src="../images/06fig07.jpg"/></div>&#13;
<p class="figcap" id="ch06fig07"><strong>FIGURE 6-7</strong> <span epub:type="pagebreak" id="page_109"/>The LED turns on when the character touches water.</p>&#13;
<h3 class="h3" id="ch06lev1sec7">CAMERA SURVEILLANCE MINECRAFT TOWERS</h3>&#13;
<p class="noindent">In this hack, you’ll set up a surveillance camera that you’ll control from Minecraft. To anyone else around, it will appear that you’re simply playing Minecraft. But, really, you’ll be using three towers in the game to control the camera. Tower 1 is made from gold and triggers the camera to take a picture. Tower 2 is made from brick and starts capturing video. Tower 3 is made from melons—yes, melons—and ends the video recording. To trigger each tower, you’ll hit it with a sword. You can then view your photos and watch the video or take another video or photo.</p>&#13;
<p class="indent">Before you start, set up your Pi Camera as you did in <a href="ch04.xhtml#ch04">Chapter 4</a>.</p>&#13;
<h4 class="h4" id="ch06lev2sec15"><span epub:type="pagebreak" id="page_110"/>Building the Three Trigger Towers</h4>&#13;
<p class="noindent">Let’s make the secret trigger towers. Load a new Minecraft world, and find a suitable flat space to build your three towers. Select the gold block from the inventory, and build a small tower of three or four blocks.</p>&#13;
<p class="indent">Repeat the same process for the two other towers, except use the brick and melon blocks. Build the brick and melon towers close together, because when you hit the brick tower, the video won’t stop recording until you hit the melon tower! <a href="ch06.xhtml#ch06fig08">Figure 6-8</a> shows the tower placement.</p>&#13;
<div class="image"><img alt="Image" src="../images/06fig08.jpg"/></div>&#13;
<p class="figcap" id="ch06fig08"><strong>FIGURE 6-8</strong> The camera control towers</p>&#13;
<p class="indent">You can actually use any block you want, as long as you amend the program code to include the relevant block name. But make sure each tower is made of only one block type.</p>&#13;
<p class="indent">You’ll need a way to set off the towers, so equip your player with the sword from the inventory by pressing <strong>E</strong> and selecting the sword. When you click the left mouse button, you remove blocks, and clicking the right mouse button hits blocks. Hitting a block doesn’t destroy it; instead, it returns block data, which you’ll use in this hack to control the Pi Camera functions. You can try out hitting the towers first before you start your program code.</p>&#13;
<h4 class="h4" id="ch06lev2sec16"><span epub:type="pagebreak" id="page_111"/>Coding the Camera Towers</h4>&#13;
<p class="noindent">Open a new Python file and enter the code in <a href="ch06.xhtml#ch06ex05">Listing 6-5</a>. This code sets up the camera and instruction messages for the player. You’ll add the rest of the code shortly.</p>&#13;
<pre><span class="ent">❶</span> <span class="codeorg">from</span> picamera <span class="codeorg">import</span> PiCamera&#13;
   camera = PiCamera()&#13;
   camera.resolution = (600, 600) <span class="codered"># size of photo</span>&#13;
<span class="ent">❷</span> camera.framerate = 100&#13;
&#13;
   <span class="codeorg">from</span> mcpi.minecraft <span class="codeorg">import</span> Minecraft&#13;
<span class="ent">❸</span> <span class="codeorg">import</span> mcpi.block <span class="codeorg">as</span> block&#13;
   mc = Minecraft.create()&#13;
&#13;
   <span class="codeorg">import</span> time&#13;
   <span class="codeorg">import</span> datetime&#13;
<span class="ent">❹</span> mc.postToChat(<span class="codegreen1">"Minecraft Camera Controller"</span>)&#13;
   time.sleep(4)&#13;
   mc.postToChat(<span class="codegreen1">"Gold = Take a picture"</span>)&#13;
   mc.postToChat(<span class="codegreen1">"Brick = Start filming"</span>)&#13;
   mc.postToChat(<span class="codegreen1">"Melon = Stop filming"</span>)</pre>&#13;
<p class="caption"><a id="ch06ex05"/><strong>LISTING 6-5</strong> Setting up the camera and player instructions</p>&#13;
<p class="indent">Begin by importing the <span class="literal">PiCamera</span> <span class="ent">❶</span> class to control the camera. Then create a variable called <span class="literal">camera</span> to store the <span class="literal">PiCamera()</span> command so you don’t have to type it each time.</p>&#13;
<p class="indent">Set the resolution of the camera image to 100 <span class="ent">❷</span>. This is the <em>frame rate</em>: a high <span class="literal">framerate</span> value produces a smooth video, and a lower <span class="literal">framerate</span> value makes the video appear jerkier—but it’s a bit of a trade-off. A frame rate of 100 is good, because if you make it too high, the Raspberry Pi will quickly run out of memory and struggle to take the image. You can change the <span class="literal">framerate</span> value later if you want to alter the video quality.</p>&#13;
<p class="indent">Then import the usual Minecraft libraries, as well as the <span class="literal">block</span> library <span class="ent">❸</span>, which lets you identify and refer to blocks by their name instead of their ID number. For example, you can specify gold, grass, sand, and brick by name. Finally, import the <span class="literal">time</span> module and the <span class="literal">datetime</span> library that will add a timestamp to the filename.</p>&#13;
<p class="indent">Add a line to make a message appear in Minecraft that shows the title of your program <span class="ent">❹</span>. Add a short delay to give the player time to read the message. Then post another message to inform the player of what action each block triggers; for example, gold takes a picture. Now let’s add the triggers.</p>&#13;
<h5 class="h5"><span epub:type="pagebreak" id="page_112"/>Hitting the Gold Tower</h5>&#13;
<p class="noindent">Now you’ll add the main section of the program, as shown in <a href="ch06.xhtml#ch06ex06">Listing 6-6</a>. This code checks which tower block has been hit and responds with the appropriate camera command. You’ll start with the gold tower and add the others in a moment.</p>&#13;
<p class="indent">Make sure you indent the lines of code exactly as shown: lines inside the <span class="literal">while</span> loop need to be indented four spaces. Then the lines inside the <span class="literal">for</span> loop that follows need to be indented another four spaces, and finally the lines inside the <span class="literal">if</span> statement need to be indented four more spaces.</p>&#13;
<pre><span class="codeorg">while True</span>:&#13;
  current_time = datetime.datetime.now()&#13;
&#13;
  <span class="codeorg">for</span> hitBlock <span class="codeorg">in</span> mc.events.pollBlockHits():&#13;
    <span class="codered"># print (hitBlock)</span>&#13;
    <span class="codeorg">if</span> mc.getBlock(hitBlock.pos.x, hitBlock.pos.y, hitBlock.pos.z)&#13;
    == block.GOLD_BLOCK.id:&#13;
      <span class="codepurple">print</span> (<span class="codegreen1">"PICTURE"</span>)&#13;
      mc.postToChat(<span class="codegreen1">"Smile!"</span>)&#13;
      time.sleep(1)&#13;
      camera.capture(<span class="codegreen1">'/home/pi/Desktop/'</span>+ <span class="codepurple">str</span>(current_time) +&#13;
      <span class="codegreen1">'photo.jpg'</span>)</pre>&#13;
<p class="caption"><a id="ch06ex06"/><strong>LISTING 6-6</strong> Programming the gold tower</p>&#13;
<p class="indent">First create a <span class="literal">while True</span> loop, which means the program is constantly checking whether you’ve hit one of the towers. If a tower has been hit, take a reading of the current time and store it in a variable called <span class="literal">current_time</span>. Then print a line to the screen showing the details of the block you hit. This includes the player’s x-, y-, and z- coordinates as well as the tower’s ID and block name.</p>&#13;
<p class="indent">Next, you need to determine which type of tower was hit and which camera action to take. You do this with an <span class="literal">if</span> statement that checks whether the block that you just hit is a gold block. If it is, the word <em>PICTURE</em> prints to the screen. At the same time, the word <em>Smile!</em> prints in the Minecraft chat messages to remind the character to smile. Wait a second for the character to pose, and then trigger the camera to take a picture.</p>&#13;
<p class="indent">Store the picture that was taken on the desktop and assign it a filename of the current time, which you took earlier and stored in the <span class="literal">current_time</span> variable. Now the action for the gold tower is taken care of. Save your program as <em>camera_tower.py</em>, but keep it open to add more code.</p>&#13;
<h5 class="h5"><span epub:type="pagebreak" id="page_113"/>Hitting the Brick Tower</h5>&#13;
<p class="noindent">Add the code in <a href="ch06.xhtml#ch06ex07">Listing 6-7</a> to your <em>camera_tower.py</em> program. This code checks whether the player has hit the brick block. If so, the camera starts a video recording.</p>&#13;
<pre><span class="ent">❷</span> <span class="codeorg">elif</span> mc.getBlock(hitBlock.pos.x, hitBlock.pos.y, hitBlock.pos.z)&#13;
   == block.BRICK_BLOCK.id:&#13;
     <span class="codered"># print ("brick")</span>&#13;
  <span class="ent">❶</span> mc.postToChat(<span class="codegreen1">"Video Recording!"</span>)&#13;
     camera.start_preview()&#13;
     time.sleep(1)&#13;
  <span class="ent">❸</span> camera.start_recording(<span class="codegreen1">'/home/pi/my_video.h264'</span>)</pre>&#13;
<p class="caption"><a id="ch06ex07"/><strong>LISTING 6-7</strong> Programming the brick tower</p>&#13;
<p class="indent">Add an <span class="literal">elif</span> statement to check whether the brick block has been hit <span class="ent">❶</span>. This is like the <span class="literal">if</span> statement you added to check whether a gold tower had been hit. But the <span class="literal">elif</span> statement means <em>else if</em> and runs only if the tower hit wasn’t made of gold blocks.</p>&#13;
<p class="indent">Post a message to the Minecraft screen to inform the player that the video is about to start recording <span class="ent">❷</span>. Start a preview on the screen so you can see what’s being filmed, wait a second, and then trigger the camera to start filming.</p>&#13;
<p class="indent">Finally, save the file to your <em>/home/pi</em> folder and name it <em>my_video.h264</em> <span class="ent">❸</span>. The video will continue to record until the melon tower is hit or you stop the program by clicking the close button at the top-right corner of the IDLE window.</p>&#13;
<h5 class="h5">Hitting the Melon Tower or Hitting Nothing</h5>&#13;
<p class="noindent">The last part of the program responds to the player hitting the melon tower, hitting any other block, or doing nothing. Add the code in <a href="ch06.xhtml#ch06ex08">Listing 6-8</a> to the end of your <em>camera_tower.py</em> file.</p>&#13;
<pre>    <span class="codeorg">elif</span> mc.getBlock(hitBlock.pos.x, hitBlock.pos.y, hitBlock.pos.z)&#13;
    == block.MELON.id:&#13;
      <span class="codered"># print ("Melon")</span>&#13;
      mc.postToChat(<span class="codegreen1">"Stop the video!"</span>)&#13;
      camera.stop_preview()&#13;
      time.sleep(1)&#13;
      camera.stop_recording()&#13;
    <span class="codeorg">else</span>:&#13;
      <span class="codeorg">pass</span></pre>&#13;
<p class="caption"><a id="ch06ex08"/><strong>LISTING 6-8</strong> Programming the melon tower</p>&#13;
<p class="indent">Add another <span class="literal">elif</span> statement to check whether the block that was hit is a melon block. If it is, post a chat message to Minecraft informing the player that the video recording is about to stop, and stop the preview. Wait for 1 second and stop the recording.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_114"/>Then add a last <span class="literal">else</span> statement to respond to the player doing something else other than hitting one of the three towers. If the player doesn’t hit one of the three trigger towers, use a <span class="literal">pass</span> statement. A <span class="literal">pass</span> statement tells the program to take no action except to return to the start of the <span class="literal">while</span> loop in <a href="ch06.xhtml#ch06ex06">Listing 6-6</a>. The program then checks for the next block interaction.</p>&#13;
<h4 class="h4" id="ch06lev2sec17">Running Your Program</h4>&#13;
<p class="noindent">Save your program and run it. If you encounter any errors, be sure to double-check that the indentation levels are correct. You can load the <em>camera_tower.py</em> file from the downloads section at <em><a href="https://www.nostarch.com/raspiforkids/">https://www.nostarch.com/raspiforkids/</a></em> and compare your program against it (or just use mine!) if you can’t get yours to work. Also, make sure you’ve used uppercase and lowercase letters in the same places that they’re used in the program code. Remember to ensure that Minecraft is open and running too.</p>&#13;
<p class="indent">After you have taken some photos and videos, minimize the Minecraft windows by clicking the middle icon at the top right of the window. You should see the photo files on the Pi desktop. Simply click and open to view each one. To view your video, you need to execute it from the terminal. Click the terminal icon.</p>&#13;
<p class="indent">In the terminal, enter this line, but replace <span class="codestrongitalic">my_video</span> with the name of your file if you gave it a different name:</p>&#13;
<pre><span class="codegreen1">pi@raspberrypi</span>:- <span class="codeblue">$</span> <span class="codestrong1">omxplayer</span> <span class="codestrongi">my_video</span><span class="codestrong1">.h264</span></pre>&#13;
<p class="indent">This line runs OMXPlayer, a video player specifically made for the Raspberry Pi. Press <span class="small">ENTER</span>, and the video should play. To play it again, press the up arrow key. Don’t forget to share your photos and videos with your friends.</p>&#13;
<h3 class="h3" id="ch06lev1sec8">WRAPPING UP</h3>&#13;
<p class="noindent">As an extra challenge, try changing the towers to other blocks, like wool, sand, or even obsidian. You could also build additional towers to add further functionality to your program. Perhaps have a block that adds a filter to your photo.</p>&#13;
<p class="indent">If you’ve enjoyed these Minecraft hacks and want more, be sure to check out <em>Learn to Program with Minecraft</em> by Craig Richardson (No Starch Press, 2015) and <em>Coding with Minecraft</em> by Al Sweigart (No Starch Press, 2018).</p>&#13;
</body></html>