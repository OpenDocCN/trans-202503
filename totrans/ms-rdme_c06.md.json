["```\nclass SimpleThrottler def initialize(max_per_sec=1000) @max_per_sec = max_per_sec @last_sec = Time.now.to_i @count_this_sec = 0 end def do_work @count_this_sec += 1 # ... end def maybe_throttle if Time.now.to_i == @last_sec and @count_this_sec > @max_per_sec throttle() @count_this_sec = 0 end @last_sec = Time.now.to_i end def throttle # ... end\nend\n```", "```\nclass SimpleThrottler def initialize(max_per_sec=1000, clock=Time) @max_per_sec = max_per_sec @clock = clock @last_sec = clock.now.to_i @count_this_sec = 0 end def do_work @count_this_sec += 1 # ... end def maybe_throttle if @clock.now.to_i == @last_sec and @count_this_sec > @max_per_sec throttle() @count_this_sec = 0 end @last_sec = @clock.now.to_i end def throttle # ... end\nend\n```"]