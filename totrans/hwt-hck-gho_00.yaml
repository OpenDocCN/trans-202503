- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![](image_fi/book_art/chapterart.png)'
  prefs: []
  type: TYPE_IMG
- en: The security industry is tricky. I maintain a love/hate relationship with this
    field, due in no small part to its fickle and fleeting nature. You can spend months
    or years honing your skills in a particular area of security—say, privilege escalation
    and lateral movement using PowerShell—only to feel completely useless when you
    find yourself in a full Linux or macOS environment.
  prefs: []
  type: TYPE_NORMAL
- en: 'By the time you learn how to dump macOS keychain secrets and defeat Gatekeeper,
    the new Windows 10 build is out with novel detection measures, rendering every
    PowerShell attack almost useless. You drag yourself back to the drawing board:
    blog hunting, conference binging, and researching to upgrade your tools and devise
    new exploitation pathways.'
  prefs: []
  type: TYPE_NORMAL
- en: Soberly considered, this rat race may seem like utter madness.
  prefs: []
  type: TYPE_NORMAL
- en: You can, of course, always console your ego by diving into the network of a
    Fortune 500 company that regards Windows XP/2003 as a precious, endangered species
    to be preserved at all costs, but the tide is catching up to you. You know in
    your heart that you have to move on to brighter shores.
  prefs: []
  type: TYPE_NORMAL
- en: At the end of the day, that’s what hacking is all about. The frustration of
    having to throw away a favorite trick can only be matched by the exhilaration
    of mastering a shiny new technique.
  prefs: []
  type: TYPE_NORMAL
- en: We loosely define *hacking* as an ensemble of tricks and tips designed to achieve
    unexpected results from a system or a process. Yet, these tricks have an ever-accelerating
    expiry date. Your aim as a security professional or enthusiast is to seek out
    and gather as many useful tricks as you can. You never know which spear will stop
    the bull’s charging ahead.
  prefs: []
  type: TYPE_NORMAL
- en: In my other books, I focused a great deal on Windows-related attacks, because
    most of the Fortune 500 companies designed the majority of their environment around
    Active Directory. It was the go-to solution to manage thousands of users, servers,
    and applications.
  prefs: []
  type: TYPE_NORMAL
- en: The zeitgeist is changing, though. A company looking to set up its infrastructure
    from scratch will no longer spring up a Windows Domain Controller on bare metal
    in a shared datacenter 20 miles from the city. Really, show me a system admin
    who still wants to manage hardware obsolescence and an ESXi cluster with 30 appliances
    with different firewalls, switches, routers, and load balancers. Hand me that
    noose and close the door already!
  prefs: []
  type: TYPE_NORMAL
- en: Why bother when you can set up everything in a cloud environment in a matter
    of seconds? Databases, Docker containers, and Active Directory are all but one
    click away, with a free trial to sweeten the deal for your accountant. Sure, the
    initial low-ticket fee quickly balloons as your servers scale up, but most startups
    will be delighted to deal with these types of problems. It means business is growing.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this book, I have decided to throw away the conventional architecture you
    find in greasy old companies. Let’s see how an attacker might take down a modern
    and worthy opponent: a company that planted its technical roots in a nurturing
    and resilient cloud environment, and powered its growth using DevOps practices.'
  prefs: []
  type: TYPE_NORMAL
- en: Beyond buzzwords touted by clueless management and hungry headhunters, when
    followed successfully these new paradigms have such a deep impact on architectural
    decisions and application designs that they naturally require a new set of tricks
    and flair to hunt for and find loopholes. Vulnerabilities that may otherwise be
    overlooked or dismissed in a classic environment suddenly acquire lethal potential
    in a cloud setting. Forget SQL injection. The second you know that a machine is
    hosted on Amazon Web Services (AWS), you should focus on another class of vulnerabilities
    altogether.
  prefs: []
  type: TYPE_NORMAL
- en: Attackers used to hop from one machine to another, sneaking past firewall rules
    and burrowing their way to the internal database, Active Directory, and what have
    you. This journey often involved network scans, traffic tunneling, and so on.
    In a cloud environment, you can manipulate core elements of the infrastructure
    from any IP in the world. Is a firewall blocking access to a particular machine?
    With the right credentials, you can toss that specific rule with a single API
    call from China and access that “internal” machine from the Philippines.
  prefs: []
  type: TYPE_NORMAL
- en: That’s not to say that machine-hopping is completely gone, of course. We still
    need a fair amount of network wizardry to gain access to that precious endpoint
    holding business data, but the goal has shifted somewhat, from taking control
    of machines to taking control of the infrastructure itself.
  prefs: []
  type: TYPE_NORMAL
- en: Consider DevOps—another key set of principles advocated by tech companies that
    is loosely defined as any technical or organizational measure that automates software
    development and boosts code delivery and reliability. DevOps spans anything from
    defining infrastructure as code to containerization and automated monitoring.
    One major corollary of this DevOps culture is that companies are less and less
    afraid to alter their infrastructure and applications. Forget the typical IT mantra,
    “If it’s working, don’t change it*.*” When you deploy an application to production
    five times a week, you’d better be comfortable changing it however you see fit.
  prefs: []
  type: TYPE_NORMAL
- en: When you decorrelate the application from the system it’s running on, you have
    more leeway to upgrade your systems. When you have end-to-end integration tests,
    you can easily afford to patch critical parts of the code with minimal side effects.
    When you have an infrastructure defined as code, you can prevent shadow IT and
    tightly oversee every machine in the infrastructure—a luxury that many big companies
    would kill to have.
  prefs: []
  type: TYPE_NORMAL
- en: This cutting-edge wave of DevOps practices slashes down the assumptions we’ve
    historically relied on for finding holes in a company’s network. A hacker gets
    into the mind of the person designing a system to surf on the wave of false assumptions
    and hasty decisions. How can we as hackers do that if we, too, are stuck in the
    old ways of designing and running systems?
  prefs: []
  type: TYPE_NORMAL
- en: 'Of course, this new era of computing is not all unicorns pissing rainbows.
    Stupendous mistakes made in the 1970s are still being faithfully—if not religiously—replicated
    in this decade. Isn’t it outrageous that in today’s world of looming threats,
    security is still considered a “nice to have” and not a core feature of the initial
    minimum viable product (MVP)? I’m not talking about IoT companies that are one
    funding round away from bankruptcy, but about big tech products, like Kubernetes,
    Chef, Spark, and so on. People making statements like the following should be
    slowly and repeatedly beaten down with a steel spoon until they collapse:'
  prefs: []
  type: TYPE_NORMAL
- en: “Security in Spark is OFF by default. This could mean you are vulnerable to
    attack by default.”
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: But I digress. My point is, DevOps and the shift toward the cloud are introducing
    a great deal of change, and our hacker intuition may benefit from some small adjustments
    to stay on track.
  prefs: []
  type: TYPE_NORMAL
- en: This was the epiphany that ignited and drove my writing of this book.
  prefs: []
  type: TYPE_NORMAL
- en: How the Book Works
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This is not your typical tech book. There won’t be tutorials, in the traditional
    sense. We take on the role of the hacker, and our target is the (fictional) political
    consultancy firm Gretsch Politico. I’ll walk you through a day (or several) in
    the life of a hacker, working from start to finish—from setting up a decent anonymous
    infrastructure, to performing some preliminary recon, to finally infiltrating
    and exploiting the target. The companies and names used herein are mostly fictional,
    with the exception of the obvious ones like Twitter and Kubernetes. So while there
    is plenty you can adapt and try out (and I encourage you to do so), you won’t
    be able to follow each step exactly as shown. For example, we’ll eventually hack
    the emails of the Gretsch Politico CEO, Alexandra Styx. Neither the company nor
    Styx herself exists.
  prefs: []
  type: TYPE_NORMAL
- en: As we feel out our journey, we’ll meet many dead ends and roadblocks, but I’ll
    show you how you can use even the most apparently meagre of results to set you
    on another path. This is how security works in the real world. Not every route
    will lead to success, but with enough perseverance, a tad of creativity and sheer
    luck, you can stumble upon some interesting findings.
  prefs: []
  type: TYPE_NORMAL
- en: To preserve our fourth wall, from now on we’ll speak of our targets as though
    they are as tangible as you or me.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s talk about our target for this new hacking adventure. Gretsch Politico
    Consulting is a firm that helps future elected officials run their political campaigns.
    Gretsch Politico (which we’ll also refer to as GP) claims to have millions of
    data points and complex modeling profiles to effectively engage key audiences.
    As they nicely put it on their website, “Elections often come down to the last
    critical voters. Our data management and micro-targeting services help you reach
    the right people at the right time*.*”
  prefs: []
  type: TYPE_NORMAL
- en: 'In laymen’s terms: “We have a huge database of likes and dislikes of millions
    of people and can push whatever content is necessary to serve your political agenda.”'
  prefs: []
  type: TYPE_NORMAL
- en: Much clearer but much scarier, right?
  prefs: []
  type: TYPE_NORMAL
- en: I wish I were making this stuff up, but sadly this whole charade is how almost
    every so-called democratic election works nowadays, so we might as well make it
    our training ground for this book’s hacking scenario.
  prefs: []
  type: TYPE_NORMAL
- en: The Vague Plan
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: I don’t want to give too much away ahead of the game, but as a quick overview,
    the book is split into four parts. Part I, “Catch Me If You Can,” helps you set
    up a robust hacking infrastructure—one that guarantees online anonymity and resiliency.
    We’ll deck out an arsenal of custom scripts, containers, and Command and Control
    (C2) servers and build a backend attacking infrastructure in an automated fashion
    for maximum efficiency.
  prefs: []
  type: TYPE_NORMAL
- en: With our weapons in hand, Part II, “Try Harder,” laysout the basic recon you’ll
    need to perform in order to understand your targets as well as find those valuable
    vulnerabilities.
  prefs: []
  type: TYPE_NORMAL
- en: In Part III, “Total Immersion,” we gain access to a barren ephemeral environment
    that we leverage to pivot from one application to another, and from one account
    to another, until we achieve complete dominion over the target’s infrastructure.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, in Part IV, “The Enemy Inside,” we pull it all together and reap our
    rewards by astutely combing through terabytes of data and exploiting hidden links
    between our targets.
  prefs: []
  type: TYPE_NORMAL
- en: We won’t go down every rabbit hole for every technique or tool; otherwise, the
    book would never end. Instead, at the end of each chapter, I give a list of resources
    for you to peruse at your leisure.
  prefs: []
  type: TYPE_NORMAL
