<html><head></head><body>
<div id="book-content">
<div id="sbo-rt-content"><h2 class="h2" id="ch20"><span epub:type="pagebreak" id="page_139"/><strong><span class="big">20</span><br/>STATELESS AND STATEFUL TRAINING</strong></h2>&#13;
<div class="image1"><img src="../images/common.jpg" alt="Image" width="252" height="252"/></div>&#13;
<p class="noindent">What is the difference between stateless and stateful training workflows in the context of production and deployment systems?</p>&#13;
<p class="indent">Stateless training and stateful training refer to different ways of training a production model.</p>&#13;
<h3 class="h3" id="ch00lev101"><strong>Stateless (Re)training</strong></h3>&#13;
<p class="noindent">In stateless training, the more conventional approach, we first train an initial model on the original training set and then retrain it as new data arrives. Hence, stateless training is also commonly referred to as stateless <em>retraining</em>.</p>&#13;
<p class="indent">As <a href="ch20.xhtml#ch20fig1">Figure 20-1</a> shows, we can think of stateless retraining as a sliding window approach in which we retrain the initial model on different parts of the data from a given data stream.<span epub:type="pagebreak" id="page_140"/></p>&#13;
<div class="image"><img id="ch20fig1" src="../images/20fig01.jpg" alt="Image" width="561" height="256"/></div>&#13;
<p class="figcap"><em>Figure 20-1: Stateless training replaces the model periodically.</em></p>&#13;
<p class="indent">For example, to update the initial model in <a href="ch20.xhtml#ch20fig1">Figure 20-1</a> (Model 1) to a newer model (Model 2), we train the model on 30 percent of the initial data and 70 percent of the most recent data at a given point in time.</p>&#13;
<p class="indent">Stateless retraining is a straightforward approach that allows us to adapt the model to the most recent changes in the data and feature-target relationships via retraining the model from scratch in user-defined checkpoint intervals. This approach is prevalent with conventional machine learning systems that cannot be fine-tuned as part of a transfer or self-supervised learning workflow (see <a href="ch02.xhtml">Chapter 2</a>). For example, standard implementations of tree-based models, such as random forests and gradient boosting (XGBoost, CatBoost, and LightGBM), fall into this category.</p>&#13;
<h3 class="h3" id="ch00lev102"><strong>Stateful Training</strong></h3>&#13;
<p class="noindent">In stateful training, we train the model on an initial batch of data and then update it periodically (as opposed to retraining it) when new data arrives.</p>&#13;
<p class="indent">As illustrated in <a href="ch20.xhtml#ch20fig2">Figure 20-2</a>, we do not retrain the initial model (Model 1.0) from scratch; instead, we update or fine-tune it as new data arrives. This approach is particularly attractive for models compatible with transfer learning or self-supervised learning.</p>&#13;
<div class="image"><img id="ch20fig2" src="../images/20fig02.jpg" alt="Image" width="596" height="128"/></div>&#13;
<p class="figcap"><em>Figure 20-2: Stateful training updates models periodically.</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_141"/>The stateful approach mimics a transfer or self-supervised learning work-flow where we adopt a pretrained model for fine-tuning. However, stateful training differs fundamentally from transfer and self-supervised learning because it updates the model to accommodate concept, feature, and label drifts. In contrast, transfer and self-supervised learning aim to adopt the model for a different classification task. For instance, in transfer learning, the target labels often differ. In self-supervised learning, we obtain the target labels from the dataset features.</p>&#13;
<p class="indent">One significant advantage of stateful training is that we do not need to store data for retraining; instead, we can use it to update the model as soon as it arrives. This is particularly attractive when data storage is a concern due to privacy or resource limitations.</p>&#13;
<h3 class="h3" id="ch00lev103"><strong>Exercises</strong></h3>&#13;
<p class="number1"><strong>20-1.</strong> Suppose we train a classifier for stock trading recommendations using a random forest model, including the moving average of the stock price as a feature. Since new stock market data arrives daily, we are considering how to update the classifier daily to keep it up to date. Should we take a stateless training or stateless retraining approach to update the classifier?</p>&#13;
<p class="number1_1"><strong>20-2.</strong> Suppose we deploy a large language model (transformer) such as Chat-GPT that can answer user queries. The dialogue interface includes thumbs-up and thumbs-down buttons so that users can give direct feedback based on the generated queries. While collecting the user feedback, we donâ€™t update the model immediately as new feedback arrives. However, we are planning to release a new or updated model at least once per month. Should we use stateless or stateful retraining for this model?<span epub:type="pagebreak" id="page_142"/></p>&#13;
</div>
</div>
</body></html>