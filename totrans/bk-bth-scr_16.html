<html><head></head><body>
<div id="sbo-rt-content" class="calibre1"><section aria-labelledby="ch15" epub:type="chapter" role="doc-chapter">
<hgroup>
<h2 class="title" id="ch15">
<span class="cn"><span aria-label=" Page 157. " epub:type="pagebreak" id="pg_157" role="doc-pagebreak" class="calibre2"/><span class="sans_dogma_ot_bold_b_">15</span></span>
<span class="ct1"><span class="sans_dogma_ot_bold_b_">INTERACTIVE BATCH</span></span>
</h2>
</hgroup>
<figure class="opener"><img alt="" class="opener1" height="407" src="../images/chapter.jpg" width="408"/>
</figure>
<p class="chapterintro">Let me be the one to break it to you if there was any doubt in your mind. Batch doesn’t have a graphical user interface (GUI), but it does have a functional user interface (UI). In this chapter, I’ll discuss different means of getting input from the user into a bat file as it executes, such as selecting one option from a list or typing in a response to a question. I’ll also describe how to alter the visual display or look and feel of the console including clearing the screen, changing colors, and updating the title. Finally, I’ll bring everything together to build a fully operational Batch UI (BUI) ready to execute.</p>
<section aria-labelledby="sec1" epub:type="division">
<h3 class="h" id="sec1"><span id="h1-107"/><span aria-label=" Page 158. " epub:type="pagebreak" id="pg_158" role="doc-pagebreak"/><span class="sans_futura_std_bold_b_">UIs, GUIs, and BUIs</span></h3>
<p class="tni">A user interface at its core is a means for the user to communicate with a computer, passing information in and getting something back. Every time you make an online purchase, you’re using a graphical user interface, which is a more sophisticated user interface with graphics allowing user input from more than just a keyboard. A video game is a glorified UI, and every time you touch an icon on your smartphone to open an app, you’re using a user interface. Commander Data of <i class="calibre6">Star Trek: The Next Generation</i> was (or will be) an android, possessing an incredibly advanced UI able to interact with humans with use of all five senses.</p>
<p class="tx">Sticking with the science-fiction theme, the Batch UI is more along the lines of the 1983 movie <i class="calibre6">War Games</i>. There are no panels, drop-downs, icons, menus, or radio buttons, and certainly no touchscreen or voice commands in the Batch UI, or BUI (pronounced boo-<span class="copyright_accent">ē</span>). Be warned, if you use this term with coders, you’ll likely receive some blank stares and raised eyebrows. I’ve tried but so far failed to add BUI to the coding lexicon, but I hold out hope that it’ll still catch on.</p>
<p class="tx">The BUI isn’t sexy, but it can ask questions of the user, who can then respond by entering a string of text or selecting an option from a list by pressing a single key. A coder would be a sadist to use Batch to build a complex UI for a large number of users, not to mention soon-to-be unemployed. But there are many instances when a bat file needs a piece of data or two from the user, especially if the user is also the coder. I’ve coded a number of BUIs, but for each one I can count on one hand the number of people who’ve ever used it.</p>
<p class="tx">The possible needs for a BUI are plentiful. Your bat file might be copying files to or from a server, where you ask the user to specify the server. As another example, you might want to create a report but be able to generate it from test or production data depending on the user’s preference. Or you might ask the user to enter a date range of files to be backed up.</p>
</section>
<section aria-labelledby="sec2" epub:type="division">
<h3 class="h" id="sec2"><span id="h1-108"/><span class="sans_futura_std_bold_b_">Choosing a Selection from a List</span></h3>
<p class="tni">Two commands allow the user to input data into a BUI. One asks for the user to choose one out of multiple possible selections, and the other asks for a typed freeform response. The first one is the <span class="sans_thesansmonocd_w5regular_">choice</span> command, and as the name suggests, it allows the user to make a <i class="calibre6">choice</i> from a list of two or more selections.</p>
<p class="tx">To get started, let’s ask the user a question—<span class="sans_thesansmonocd_w5regular_">Do you want a Joke, Pun, or Riddle?</span>—and allow them to enter <span class="sans_thesansmonocd_w5regular_">J</span>, <span class="sans_thesansmonocd_w5regular_">P</span>, or <span class="sans_thesansmonocd_w5regular_">R</span> for one of the three selections, respectively. The following <span class="sans_thesansmonocd_w5regular_">choice</span> command does just this:</p>
<pre class="pre"><code class="calibre11">choice /C:JPR /M:"Do you want a Joke, Pun, or Riddle"</code></pre>
<p class="tni">The <span class="sans_thesansmonocd_w5regular_">/C</span> option lists the <i class="calibre6">choices</i>, <span class="sans_thesansmonocd_w5regular_">/C:JPR</span>, and the text encased in double quotes associated with the <span class="sans_thesansmonocd_w5regular_">/M</span> option is the <i class="calibre6">message</i> presented to the user. Both of <span aria-label=" Page 159. " epub:type="pagebreak" id="pg_159" role="doc-pagebreak"/>these options also work without the colon delimiter. That is, <span class="sans_thesansmonocd_w5regular_">/C JPR</span> is functionally equivalent to <span class="sans_thesansmonocd_w5regular_">/C:JPR</span>, but I much prefer the colon because it nicely ties the option to its values or its message, much like a valued rug ties a room together. Also, notice the lack of the question mark at the end of the question. The interpreter adds the punctuation after giving the user the list of possible selections.</p>
<p class="tx">The previous command displays the following to the user on the console:</p>
<pre class="pre"><code class="calibre11">Do you want a Joke, Pun, or Riddle [J,P,R]?</code></pre>
<p class="tx">The execution of the bat file suspends at the <span class="sans_thesansmonocd_w5regular_">choice</span> command until the user presses one of the three keys (or exits the command window). If the user presses a key not on the list, the computer beeps and continues to wait, but what happens when the user selects one of the choices?</p>
<p class="tx">Up until this point <span class="sans_thesansmonocd_w5regular_">errorlevel</span> has merely been a return code, usually <span class="sans_thesansmonocd_w5regular_">0</span> for the successful execution of a command and something greater than <span class="sans_thesansmonocd_w5regular_">0</span> for a failure. But after a <span class="sans_thesansmonocd_w5regular_">choice</span> command executes, it sets <span class="sans_thesansmonocd_w5regular_">errorlevel</span> to the user’s selection; more specifically, it’s set to the integer value corresponding to the position of the user’s selection in the list. More simply, if the choices are defined by <span class="sans_thesansmonocd_w5regular_">/C:JPR</span>, selecting <span class="sans_thesansmonocd_w5regular_">J</span> returns <span class="sans_thesansmonocd_w5regular_">1</span>, <span class="sans_thesansmonocd_w5regular_">P</span> returns <span class="sans_thesansmonocd_w5regular_">2</span>, and <span class="sans_thesansmonocd_w5regular_">R</span> returns <span class="sans_thesansmonocd_w5regular_">3</span>.</p>
<p class="tx">I find it a bit misleading that the variable returning the valid selection contains the word <i class="calibre6">error</i> in its name, but after getting over the issue of semantics and the fact that this reserved word is doing double duty, it’s not difficult to interrogate the variable to determine the user’s selection and which logic to execute next.</p>
<p class="tx">Here’s another example of a <span class="sans_thesansmonocd_w5regular_">choice</span> command that also appears to be missing something (other than a question mark):</p>
<pre class="pre"><code class="calibre11">choice /M:"Do you want to try again"</code></pre>
<p class="tni">The <span class="sans_thesansmonocd_w5regular_">/C</span> option is missing, but this is a yes or no question, and when that option is omitted, the implied default is <span class="sans_thesansmonocd_w5regular_">/C:YN</span>, returning <span class="sans_thesansmonocd_w5regular_">1</span> for <span class="sans_thesansmonocd_w5regular_">Y</span> and <span class="sans_thesansmonocd_w5regular_">2</span> for <span class="sans_thesansmonocd_w5regular_">N</span>.</p>
<p class="tx">Two additional options always go hand in hand with each other. The <span class="sans_thesansmonocd_w5regular_">/T</span> option sets the <i class="calibre6">timeout</i>, or the number of seconds given before the command times out and the interpreter chooses the <i class="calibre6">default</i> selection defined by the <span class="sans_thesansmonocd_w5regular_">/D</span> option. The following command gives the user 20 seconds, <span class="sans_thesansmonocd_w5regular_">/T:20</span>, to make a selection before a pun, <span class="sans_thesansmonocd_w5regular_">/D:P</span>, is inflicted upon them:</p>
<pre class="pre"><code class="calibre11">choice /C:JPR /M:"Do you want a Joke, Pun, or Riddle" /T:20 /D:P</code></pre>
<p class="tx">Sometimes it doesn’t make sense to list the selections. For instance, when asking the user to rate something on a scale from 1 to 5, it might instead be preferable to explain the rating system with some text. Assume that you want to pose the following to the user requesting a response:</p>
<pre class="pre"><code class="calibre11">Rate your agreement to the statement on a scale of 1 to 5.
I love bat comedy.  1 (Agree) to 5 (Disagree)   
</code></pre>
<p class="tx"><span aria-label=" Page 160. " epub:type="pagebreak" id="pg_160" role="doc-pagebreak"/>Together, the following <span class="sans_thesansmonocd_w5regular_">echo</span> command and <span class="sans_thesansmonocd_w5regular_">choice</span> command produce the desired text and wait for a response:</p>
<pre class="pre"><code class="calibre11">echo Rate your agreement to the statement on a scale of 1 to 5.
choice /C:12345 /M:"I love bat comedy.  1 (Agree) to 5 (Disagree)" /N
</code></pre>
<p class="tx">You’ll need the <span class="sans_thesansmonocd_w5regular_">/C:12345</span> option so that the interpreter has the list of possible selections, but you don’t want <span class="sans_thesansmonocd_w5regular_">[1,2,3,4,5]?</span> displayed because it’ll compete with the instructions on the prior line. The <span class="sans_thesansmonocd_w5regular_">/N</span> option (<i class="calibre6">no choice keys</i>) suppresses the display of choices, showing only the desired message to the user. The question mark is also suppressed with the <span class="sans_thesansmonocd_w5regular_">/N</span> option, but you can include it in the message string if the message is posed as a question.</p>
<p class="tx">If a bat file is to perform a task on a selected server, a series of <span class="sans_thesansmonocd_w5regular_">echo</span> commands could list any number of servers along with their associated keyboard keys as a prelude to a <span class="sans_thesansmonocd_w5regular_">choice</span> command. That would work great for a predefined list of servers, but if the list is particularly long or unknown at coding time, you can instead ask the user to key in any server name with the next command.</p>
</section>
<section aria-labelledby="sec3" epub:type="division">
<h3 class="h" id="sec3"><span id="h1-109"/><span class="sans_futura_std_bold_b_">Freeform User Input</span></h3>
<p class="tni">The other command allowing the user to input data is the <span class="sans_thesansmonocd_w5regular_">set</span> command (from <span class="xref"><a href="chapter2.xhtml" class="calibre3">Chapter 2</a></span>) when used with the <span class="sans_thesansmonocd_w5regular_">/P</span> or <i class="calibre6">prompt string</i> option. Much like its optionless counterpart, the <span class="sans_thesansmonocd_w5regular_">set /P</span> command assigns a value to a variable, where that value can be a string of any reasonable length or even null. The difference is that the text after the equal sign isn’t the value assigned; it’s the prompt string displayed to the user. Whatever the user enters is assigned to the variable once they press <small class="calibre5">ENTER</small>.</p>
<p class="tx">To demonstrate, the question after the equal sign is displayed to the console:</p>
<pre class="pre"><code class="calibre11">set /P yourAns=How are bats like false teeth?  &amp;</code></pre>
<p class="tni">The execution is put on hold until the user responds, at which point the interpreter assigns that response to the <span class="sans_thesansmonocd_w5regular_">yourAns</span> variable.</p>
<p class="tx">Forget to use the <span class="sans_thesansmonocd_w5regular_">/P</span> option, and the variable is assigned to the text after the equal sign without prompting of the user. Notice three minor yet important details. First, this command doesn’t append the question mark to the message string, so I added it. Second, I added a couple of spaces after that question mark to move the start of the response away from the question. Finally, I terminated the line with an ampersand to make those spaces obvious at a glance. These subtle tweaks will be equally appreciated by your users and any readers of your code.</p>
<p class="tx">Every joke needs a punchline, and it’s displayed to the user on the second line of the following code after they have had a chance to ponder the question and enter a guess:</p>
<pre class="pre"><code class="calibre11"><span aria-label=" Page 161. " epub:type="pagebreak" id="pg_161" role="doc-pagebreak"/>set /P yourAns=How are bats like false teeth?  &amp;
echo ** They both come out at night.
echo ** You said: "%yourAns%"
</code></pre>
<p class="tni">The third and final line displays the user’s answer encased in double quotes. It’s a joke. I didn’t say it was a good joke.</p>
</section>
<section aria-labelledby="sec4" epub:type="division">
<h3 class="h" id="sec4"><span id="h1-110"/><span class="sans_futura_std_bold_b_">Altering the UI Look and Feel</span></h3>
<p class="tni">Batch provides three more commands that alter the look and feel of the console, and a couple of them have additional applications:</p>
<p class="listhead"><b class="calibre10">Updating the Title</b></p>
<p class="listplainfirst">When a bat file executes, a command window opens, and the title in the white bar across its top is likely to be <i class="calibre6">C:\WINDOWS\system32\cmd.exe</i>, the program that runs a bat file. The <span class="sans_thesansmonocd_w5regular_">title</span> command resets that title to something a little more identifiable and far less generic. The following changes the title to the text that follows it:</p>
<pre class="list"><code class="calibre11"><span class="sans_thesansmonocd_w5regular_">title Batch Improv Theater</span>
</code></pre>
<p class="listcontinued">The embedded spaces in the argument list aren’t an issue, and if you encase the text in double quotes, they’ll also be part of the title.</p>
<p class="listbody">Use of this command isn’t limited to interactive bat files where its value is obvious. Any bat file that runs on a machine where other bat files might also be running can only be enhanced by a title. If one of those bat files is hung or otherwise trapped in an endless loop, which one should be killed? If none of them has a title, they may all look identical, leaving you no way of knowing. The <span class="sans_thesansmonocd_w5regular_">title</span> command solves this problem. In fact, I’ll use this command in <span class="xref"><a href="chapter26.xhtml" class="calibre3">Chapter 26</a></span>, where I’ll title a process susceptible to hanging so that another bat file can find it and kill it, if it does indeed hang. You can even reset the title multiple times during a run, perhaps showing the status or the step being executed.</p>
<p class="listhead"><b class="calibre10">Clearing the Screen</b></p>
<p class="listplainfirst">The <span class="sans_thesansmonocd_w5regular_">cls</span> command is a severe abbreviation of <i class="calibre6">clear screen</i>. When this optionless command executes, the screen or console is cleared, revealing a blank (and for now black) canvas. To cut through the noise, you can execute this command before posing a question to the user.</p>
<p class="listhead"><b class="calibre10">Changing Colors</b></p>
<p class="listplainfirst">Opening or executing a bat file brings up a command window with white text on a black background, which is the exact opposite of how humans have been reading since the advent of papyrus and ink. Contemplate for a moment the text you’re currently reading as if it were white on jet-black paper. It seems anachronistic now, but it must have been avant-garde in the early days of Batch.</p>
<p class="listbody"><span aria-label=" Page 162. " epub:type="pagebreak" id="pg_162" role="doc-pagebreak"/>The <span class="sans_thesansmonocd_w5regular_">color</span> command provides 16 different colors from which to choose for both the foreground text and background, for a total of 240 permutations, although certain combinations are virtually unreadable and even painful to the eye.</p>
<p class="listbody">Go to the help menu, <span class="sans_thesansmonocd_w5regular_">color /?</span>, to get the full list of colors denoted by the hexadecimal digits <span class="sans_thesansmonocd_w5regular_">0</span> to <span class="sans_thesansmonocd_w5regular_">F</span>, but the set of popular colors includes black (<span class="sans_thesansmonocd_w5regular_">0</span>), blue (<span class="sans_thesansmonocd_w5regular_">1</span>), red (<span class="sans_thesansmonocd_w5regular_">4</span>), and white (<span class="sans_thesansmonocd_w5regular_">7</span>). The <span class="sans_thesansmonocd_w5regular_">color</span> command accepts a two-character color attribute as its argument, where the first character represents the background color and the second represents the foreground or text color. By the way, the interpreter is smart enough to reject a command that assigns the same color to both.</p>
<p class="listbody">A black background supporting white text is the default Batch color scheme, which you can call for explicitly with this command: <span class="sans_thesansmonocd_w5regular_">color 07</span>. Flipping the attribute around to <span class="sans_thesansmonocd_w5regular_">70</span> creates a white background supporting black text, but black text on a bright white (<span class="sans_thesansmonocd_w5regular_">F</span>) background is more appealing:</p>
<pre class="list"><code class="calibre11"><span class="sans_thesansmonocd_w5regular_">color F0</span>
</code></pre>
<p class="listbody">My preference for readability is bright white on a blue background, <span class="sans_thesansmonocd_w5regular_">color 1F</span>, but aesthetics aside, the greatest use of this command is to flag problems. You may run certain bat files daily to perform mundane or repetitive tasks. You may run such a bat file upon logon each morning and then ignore it, but on the rare instance when a file can’t be copied or a process aborts, the <span class="sans_thesansmonocd_w5regular_">color</span> command offers a great means of throwing up a red flag (literally) to alert the user. If using the default color settings, after writing an error message to the console, this line immediately changes the screen from black to red (<span class="sans_thesansmonocd_w5regular_">4</span>), brightens the white text a tad (<span class="sans_thesansmonocd_w5regular_">F</span>), and holds the window open:</p>
<pre class="list"><code class="calibre11"><span class="sans_thesansmonocd_w5regular_">@color 4F &amp; pause</span>
</code></pre>
<p class="listcontinued">That should get the user’s attention even if they’ve moved on to other tasks and the command window is off to the side. If it doesn’t, you can also use the <span class="sans_thesansmonocd_w5regular_">cls</span> command to clear the screen before writing an error message. To heighten the contrast, you can make the background green with <span class="sans_thesansmonocd_w5regular_">color 2F</span>, when the process completes successfully.</p>
<p class="tx">The <span class="sans_thesansmonocd_w5regular_">cls</span> and <span class="sans_thesansmonocd_w5regular_">color</span> commands are nonfunctional if stdout has been redirected to either a trace file or the nul file. If you need to clear the screen only once, execute the <span class="sans_thesansmonocd_w5regular_">cls</span> command just before redirecting stdout to the trace; otherwise, <span class="sans_thesansmonocd_w5regular_">echo off</span> is the only realistic option for keeping stdout off the console. Likewise, you can execute the <span class="sans_thesansmonocd_w5regular_">color</span> command prior to or after the redirection. Do it early, and the color will be set for the duration of the redirection. You also can turn the screen red for an abort at the end of the execution after returning from the redirection. The <span class="sans_thesansmonocd_w5regular_">title</span> command is <span aria-label=" Page 163. " epub:type="pagebreak" id="pg_163" role="doc-pagebreak"/>the favorite child of the bunch, as it works anywhere in a bat file, regardless of redirection.</p>
</section>
<section aria-labelledby="sec5" epub:type="division">
<h3 class="h" id="sec5"><span id="h1-111"/><span class="sans_futura_std_bold_b_">Fully Functional Batch UI</span></h3>
<p class="tni">Let’s put all of this together into a fully functional bat file that can interactively share a joke, a pun, or a riddle, repeatedly. The next two code snippets contain the entire bat file. Here’s the first portion of <i class="calibre6">BatchImprov.bat</i>:</p>
<pre class="pre"><code class="calibre11"><span aria-label="annotation1" class="codeannotationhang1">❶</span> @setlocal EnableExtensions EnableDelayedExpansion
 @echo off
 color 1F
 title Batch Improv Theater

<span aria-label="annotation2" class="codeannotationhang">❷</span> :Again
 cls
 &gt; con echo.
<span aria-label="annotation3" class="codeannotationhang1">❸</span> &gt; con choice /C:JPR /M:"Do you want a Joke, Pun, or Riddle"
 &gt; con echo.
<span aria-label="annotation4" class="codeannotationhang1">❹</span> if %errorlevel% equ 1 (
    call :Joke
 ) else if %errorlevel% equ 2 (
    call :Pun
 ) else if %errorlevel% equ 3 (
    call :Riddle
 )
 &gt; con echo.
<span aria-label="annotation5" class="codeannotationhang1">❺</span> &gt; con choice /M:"Do you want to try again"
 if %errorlevel% equ 1  goto :Again
 goto :eof
</code></pre>
<p class="tx">After the <span class="sans_thesansmonocd_w5regular_">setlocal</span> command <span aria-label="annotation1" class="codeannotation">❶</span> (my ubiquitous opening command), the <span class="sans_thesansmonocd_w5regular_">echo off</span> command suppresses stdout so that only my coder-generated output gets to the console. Notice that neither command is written to the console thanks to the leading at sign (<span class="sans_thesansmonocd_w5regular_">@</span>). The <span class="sans_thesansmonocd_w5regular_">color</span> command then sets the background to blue and the text to bright white, for no other reason than readability. Next, the <span class="sans_thesansmonocd_w5regular_">title</span> command defines the title of the command window. After the <span class="sans_thesansmonocd_w5regular_">:Again</span> label <span aria-label="annotation2" class="codeannotation">❷</span>, the <span class="sans_thesansmonocd_w5regular_">cls</span> command clears the screen to complete the setup.</p>
<p class="tx">Three <span class="sans_thesansmonocd_w5regular_">echo.</span> commands are strategically placed in the code to display blank lines for readability. The same <span class="sans_thesansmonocd_w5regular_">choice</span> command <span aria-label="annotation3" class="codeannotation">❸</span> from earlier asks the user for their jocular liking. Since there are three selections from which to choose, an <span class="sans_thesansmonocd_w5regular_">if</span> command with an <span class="sans_thesansmonocd_w5regular_">else if</span> construct interrogates <span class="sans_thesansmonocd_w5regular_">errorlevel</span> <span aria-label="annotation4" class="codeannotation">❹</span>. Depending on the user’s response, different <span class="sans_thesansmonocd_w5regular_">call</span> commands are invoked for a joke, pun, or riddle, based on the values of <span class="sans_thesansmonocd_w5regular_">1</span>, <span class="sans_thesansmonocd_w5regular_">2</span>, or <span class="sans_thesansmonocd_w5regular_">3</span>, respectively.</p>
<p class="tx">A second <span class="sans_thesansmonocd_w5regular_">choice</span> command <span aria-label="annotation5" class="codeannotation">❺</span> then asks the user if they want more of this humor, using the implied default choices of <span class="sans_thesansmonocd_w5regular_">Y</span> and <span class="sans_thesansmonocd_w5regular_">N</span>. If the user selects <span class="sans_thesansmonocd_w5regular_">Y</span>, the interpreter returns <span class="sans_thesansmonocd_w5regular_">1</span> and we go back to the <span class="sans_thesansmonocd_w5regular_">:Again</span> label <span aria-label="annotation2" class="codeannotation">❷</span>, where we clear the screen and begin again. A selection of <span class="sans_thesansmonocd_w5regular_">N</span> indicates that the user has had enough, and we exit the bat file.</p>
<p class="tx"><span aria-label=" Page 164. " epub:type="pagebreak" id="pg_164" role="doc-pagebreak"/>The three routines called in the previous listing are defined here in the final portion of <i class="calibre6">BatchImprov.bat</i>:</p>
<pre class="pre"><code class="calibre11">:Joke
 &gt; con echo Please give an answer to the joke:
 &gt; con set /P yourAns=How are bats like false teeth?  &amp;
 &gt; con echo ** They both come out at night.
 &gt; con echo ** You said: "%yourAns%"
 goto :eof

:Pun
 &gt; con echo We hope you find this punny:
 &gt; con echo Crossing a vampire bat with a computer means love at first byte.
 goto :eof

:Riddle
 &gt; con echo Please give an answer to the riddle:
 &gt; con set /P yourAns=This type of bat is silly.  &amp;
 &gt; con echo ** A Dingbat.
 &gt; con echo ** You said: "%yourAns%"
 goto :eof
</code></pre>
<p class="tx">The <span class="sans_thesansmonocd_w5regular_">:Joke</span> and <span class="sans_thesansmonocd_w5regular_">:Riddle</span> routines are similarly structured. A <span class="sans_thesansmonocd_w5regular_">set /P</span> command asks for a response before revealing the punchline and the user’s answer. The <span class="sans_thesansmonocd_w5regular_">:Pun</span> routine simply writes out the witty pun with no input from the user.</p>
<p class="tx">This bat file doesn’t capture stdout and stderr, because doing so wouldn’t allow for the use of the <span class="sans_thesansmonocd_w5regular_">cls</span> command between each selection. If that were to cause a problem during development, you could temporarily comment out the <span class="sans_thesansmonocd_w5regular_">echo off</span> command, but be prepared for a messy console impeding your testing.</p>
<p class="tx">Each <span class="sans_thesansmonocd_w5regular_">choice</span> and <span class="sans_thesansmonocd_w5regular_">set /P</span> command in <i class="calibre6">BatchImprov.bat</i> is a little different from the ones shown earlier in this chapter. Along with the <span class="sans_thesansmonocd_w5regular_">echo</span> commands, each one is using redirection to explicitly write its prompt or message to the console via the <span class="sans_thesansmonocd_w5regular_">&gt; con</span> syntax. This addition would have been required if stdout had been redirected to a trace file; otherwise, it would have written unanswerable prompt strings to the trace. But since stdout is simply being suppressed, the redirection to the console is redundant in this case. I didn’t include the redirection earlier in the chapter because I wanted to focus on the new commands alone, but in practice it’s best to always define the destination explicitly as I’ve done here, even if it isn’t required.</p>
<p class="tx">The <i class="calibre6">BatchImprov.bat</i> bat file is now fully functional. Run it and you can answer questions and see the results until you answer <span class="sans_thesansmonocd_w5regular_">N</span> to the <span class="sans_thesansmonocd_w5regular_">Do you want to try again?</span> prompt. Undoubtedly, you’ll soon get bored due to the limited content, but we still have many enhancements to discuss. In <span class="xref">Appendix A</span>, you’ll find a far more dynamic version of this bat file capable of reading files containing libraries of jokes, puns, and riddles; storing them in arrays; and randomly accessing the arrays to get unique material multiple times during a single execution.</p>
</section>
<section aria-labelledby="sec6" epub:type="division">
<h3 class="h" id="sec6"><span id="h1-112"/><span aria-label=" Page 165. " epub:type="pagebreak" id="pg_165" role="doc-pagebreak"/><span class="sans_futura_std_bold_b_">Summary</span></h3>
<p class="tni">In this chapter, I created the most substantial bat file yet, and I did it to demonstrate how to communicate interactively with users. You learned how to provide users with a list from which to choose a selection and how to store a typed freeform user response of any length into a variable. I also introduced useful commands for clearing the screen, updating the title, and changing background and text colors, including other noninteractive uses for these commands.</p>
<p class="tx">In the next chapter, the last of <span class="xref"><a href="part1.xhtml" class="calibre3">Part I</a></span>, I’ll discuss code blocks, which is an integral topic as you move forward. A code block isn’t simply a “block of code.” I’ll explain what it is, why it’s important, and how it’s useful in the next few pages.</p>
</section>
</section>
</div></body></html>