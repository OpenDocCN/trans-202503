<html><head></head><body>
		<section>&#13;
			<header>&#13;
				<h1 class="chapter"><span class="ChapterNumber"><span epub:type="pagebreak" id="Page_23" title="23"/>3</span><br/><span class="ChapterTitle">First Steps</span></h1>&#13;
			</header>&#13;
			<p class="ChapterIntro">In this chapter you will</p>&#13;
			<ul>&#13;
				<li>Learn the concepts of good project design</li>&#13;
				<li>Learn the basic properties of electricity</li>&#13;
				<li>Be introduced to the resistor, light-emitting diode (LED), transistor, rectifier diode, and relay</li>&#13;
				<li>Use a solderless breadboard to construct circuits</li>&#13;
				<li>&#13;
					Learn how integer variables, <code>for</code> loops, and digital outputs can be used to create various LED effects</li>&#13;
			</ul>&#13;
			<p>Now you’ll begin to bring your Arduino to life. As you will see, there is more to working with Arduino than just the board itself. You’ll learn how to plan projects in order to make your ideas a reality, then move on to a quick primer on electricity. Electricity is the driving force behind everything we do in this book, and it’s important to have a solid understanding of the basics in order to create your own projects. You’ll also take a look at the components that bring real projects to life. Finally, you’ll examine some new functions that are the building blocks for your Arduino sketches.</p>&#13;
			<h2 id="h1-500587c03-0001"><span epub:type="pagebreak" id="Page_24" title="24"/>Planning Your Projects</h2>&#13;
			<p class="BodyFirst">When starting your first few projects, you might be tempted to write your sketch immediately after you’ve come up with a new idea. But before you start writing, a few basic preparatory steps are in order. After all, your Arduino board isn’t a mind reader; it needs precise instructions, and even if these instructions can be executed by the Arduino, if you overlook so much as a minor detail, the results may not be what you expected.</p>&#13;
			<p>Whether you are creating a project that simply blinks a light or one that controls an automated model railway signal, you’ll be more successful if you have a detailed plan. When designing your Arduino projects, follow these basic steps:</p>&#13;
			<ol class="decimal">&#13;
				<li value="1"><b>Define your objective.</b> Determine what you want to achieve.</li>&#13;
				<li value="2"><b>Write your algorithm.</b> An <em>algorithm</em> is a set of instructions that describes how to accomplish your goal. Your algorithm will list the steps necessary for you to achieve your project’s objective.</li>&#13;
				<li value="3"><b>Select your hardware.</b> Determine how your hardware will connect to the Arduino.</li>&#13;
				<li value="4"><b>Write your sketch.</b> Create your initial program that tells the Arduino what to do.</li>&#13;
				<li value="5"><b>Wire it up.</b> Connect your hardware to the Arduino board.</li>&#13;
				<li value="6"><b>Test and debug.</b> Does it work? During this stage, you identify errors and find their causes, whether in the sketch, hardware, or algorithm.</li>&#13;
			</ol>&#13;
			<p>The more time you spend planning your project, the easier a time you’ll have during the testing and debugging stage.</p>&#13;
			<aside epub:type="sidebar">&#13;
				<div class="top hr">&#13;
					<hr/>&#13;
				</div>&#13;
				<section class="note">&#13;
					<h2><span class="NoteHead">NOTE</span></h2>&#13;
					<p>&#13;
							Even well-planned projects sometimes fall prey to feature creep. <em>Feature creep</em> occurs when people think up new functionality that they want to add to a project and then try to force new elements into an existing design. When you need to change a design, don’t try to “slot in” changes or modify it with 11th-hour additions. Instead, start fresh by redefining your objective.</p>&#13;
					<div class="bottom hr">&#13;
						<hr/>&#13;
					</div>&#13;
				</section>&#13;
			</aside>&#13;
			<h2 id="h1-500587c03-0002">About Electricity</h2>&#13;
			<p class="BodyFirst">Let’s spend a bit of time discussing electricity, since you’ll soon be building electronic circuits with your Arduino projects. In simple terms, <em>electricity</em> is a form of energy that we can harness and convert into heat, light, movement, and power. Electricity has three main properties that will be important to us as we build projects: current, voltage, and power.</p>&#13;
			<h3 id="h2-500587c03-0001">Current</h3>&#13;
			<p class="BodyFirst">The flow of electrical energy is called the <em>current</em>. Electrical current flows through a <em>circuit</em> (a path for the current) from the positive side of a power source, such as a battery, to the negative side of the power source. This is <span epub:type="pagebreak" id="Page_25" title="25"/>known as <em>direct current (DC)</em>. (For the purposes of this book, we will not deal with <em>alternating current</em>, or<em> AC</em>.) In some circuits, the negative side is called <em>ground (GND)</em>. Current is measured in <em>amperes</em> or “amps” (<em>A</em>); 1 amp is 6.2415 × 10<sup>18</sup> electrons flowing past a single point in 1 second. Smaller amounts of current are measured in <em>milliamps (mA)</em>, where 1,000 milliamps equal 1 amp.</p>&#13;
			<h3 id="h2-500587c03-0002">Voltage</h3>&#13;
			<p class="BodyFirst"><em>Voltage</em> is a measure of the difference in potential energy between a circuit’s positive and negative ends. This is measured in <em>volts (V)</em>. If you think of electrons flowing the way water flows, then voltage would be equivalent to pressure: the greater the voltage, the faster the current moves through a circuit.</p>&#13;
			<h3 id="h2-500587c03-0003">Power</h3>&#13;
			<p class="BodyFirst"><em>Power</em> is a measurement of the rate at which an electrical device converts energy from one form to another. Power is measured in <em>watts (W)</em>. For example, a 100 W light bulb is much brighter than a 60 W bulb because the higher-wattage bulb converts more electrical energy into light.</p>&#13;
			<p>A simple mathematical relationship exists among voltage, current, and power:</p>&#13;
			<ol class="none">&#13;
				<li>&#13;
					Power (<em>W</em>) = Voltage (<em>V</em>) × Current (<em>A</em>)</li>&#13;
			</ol>&#13;
			<h2 id="h1-500587c03-0003">Electronic Components</h2>&#13;
			<p class="BodyFirst">Now that you know a little bit about the basics of electricity, let’s look at how it interacts with various electronic components and devices. Electronic <em>components</em> are the various parts that control electric current in a circuit. Just as the various parts of a car’s engine work together to store fuel, filter fuel, pump fuel, and inject fuel to allow us to drive, electronic components work together to control and harness the flow of electricity to help us create useful devices.</p>&#13;
			<p>Throughout this book, I’ll explain specialized components as we use them. The following sections describe some of the fundamental components.</p>&#13;
			<h3 id="h2-500587c03-0004">The Resistor</h3>&#13;
			<p class="BodyFirst">Various components, such as the Arduino’s LED, require only a small amount of current to function—usually around 10 mA. When the LED receives more current than it needs, it converts the excess to heat—and too much heat can kill an LED. To reduce the flow of current to components such as LEDs, we can add a <em>resistor</em> between the voltage source and the component. Current flows freely along normal copper wire, but when it encounters a resistor, its movement is slowed. Some current is converted into a small amount of heat, which is proportional to the value of the resistor. <a href="#figure3-1" id="figureanchor3-1">Figure 3-1</a> shows some commonly used resistors.</p>&#13;
			<span epub:type="pagebreak" id="Page_26" title="26"/>&#13;
			<figure>&#13;
				<img alt="f03001" src="image_fi/500587c03/f03001.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-1">Figure 3-1</a>: Typical resistors</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<h4 id="h3-500587c03-0001">Resistance</h4>&#13;
			<p class="BodyFirst">The level of resistance can be either fixed or variable. Resistance is measured in <em>ohms</em> (Ω) and can range from zero to thousands of ohms (<em>kilohms</em>, or kΩ) to millions of ohms (<em>megohms</em>, or MΩ).</p>&#13;
			<h4 id="h3-500587c03-0002">Reading Resistance Values</h4>&#13;
			<p class="BodyFirst">Although you can test resistance with a multimeter, you can also read resistance directly from a physical resistor. The resistors we will use will be physically very small, so their resistance value usually cannot be printed on them. One common way to show a component’s resistance is with a series of color-coded bands, read from left to right, as follows:</p>&#13;
			<ol class="none">&#13;
				<li><span class="RunInHead"><b>First band</b> </span>  Represents the first digit of the resistance</li>&#13;
				<li><span class="RunInHead"><b>Second band</b> </span>  Represents the second digit of the resistance</li>&#13;
				<li><span class="RunInHead"><b>Third band</b> </span>  Represents the multiplier (for four-band resistors) or the third digit (for five-band resistors)</li>&#13;
				<li><span class="RunInHead"><b>Fourth band</b> </span>  Represents the multiplier (for five-band resistors) or the <em>tolerance</em>, or accuracy of the component’s resistance (for four-band resistors)</li>&#13;
				<li><span class="RunInHead"><b>Fifth band</b> </span>  Shows the tolerance for five-band resistors</li>&#13;
			</ol>&#13;
			<p><a href="#table3-1" id="tableanchor3-1">Table 3-1</a> lists the colors of resistors and their corresponding values.</p>&#13;
			<p>Because it is difficult to manufacture resistors with exact values, you select a margin of error as a percentage when buying a resistor. For five-band resistors, a brown band in the fifth position indicates tolerance of 1 percent, gold indicates 5 percent, and silver indicates 10 percent.</p>&#13;
			<p><a href="#figure3-2" id="figureanchor3-2">Figure 3-2</a> shows a resistor diagram. The yellow, violet, and orange resistance bands are read as 4, 7, and 3, respectively, as listed in <a href="#table3-1">Table 3-1</a>. The third band represents the multiplier; in this example, the 47 is multiplied by 10 to the power of 3 to arrive at the value of 47,000 Ω, more commonly read as 47 kΩ.  The brown band indicates a very precise resistor, which should be accurate to within 1 percent.</p>&#13;
			<span epub:type="pagebreak" id="Page_27" title="27"/>&#13;
			<figure>&#13;
				<img alt="f03002" src="image_fi/500587c03/f03002.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-2">Figure 3-2</a>: Example resistor diagram</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<figure>&#13;
				<figcaption class="TableTitle">&#13;
					<p><a id="table3-1">Table 3-1</a>: Values of Bands Printed on a Resistor, in Ohms</p>&#13;
				</figcaption>&#13;
				<table border="1" id="table-500587c03-0001">&#13;
					<thead>&#13;
						<tr>&#13;
							<td><b>Color</b></td>&#13;
							<td><b>Ohms</b></td>&#13;
						</tr>&#13;
					</thead>&#13;
					<tbody>&#13;
						<tr>&#13;
							<td>Black</td>&#13;
							<td>0</td>&#13;
						</tr>&#13;
						<tr>&#13;
							<td>Brown</td>&#13;
							<td>1</td>&#13;
						</tr>&#13;
						<tr>&#13;
							<td>Red</td>&#13;
							<td>2</td>&#13;
						</tr>&#13;
						<tr>&#13;
							<td>Orange</td>&#13;
							<td>3</td>&#13;
						</tr>&#13;
						<tr>&#13;
							<td>Yellow</td>&#13;
							<td>4</td>&#13;
						</tr>&#13;
						<tr>&#13;
							<td>Green</td>&#13;
							<td>5</td>&#13;
						</tr>&#13;
						<tr>&#13;
							<td>Blue</td>&#13;
							<td>6</td>&#13;
						</tr>&#13;
						<tr>&#13;
							<td>Violet</td>&#13;
							<td>7</td>&#13;
						</tr>&#13;
						<tr>&#13;
							<td>Gray</td>&#13;
							<td>8</td>&#13;
						</tr>&#13;
						<tr>&#13;
							<td>White</td>&#13;
							<td>9</td>&#13;
						</tr>&#13;
					</tbody>&#13;
				</table>&#13;
			</figure>&#13;
			<h4 id="h3-500587c03-0003">Chip Resistors</h4>&#13;
			<p class="BodyFirst">Surface-mount chip resistors display a printed number and letter code, as shown in <a href="#figure3-3" id="figureanchor3-3">Figure 3-3</a>, instead of colored stripes. The first two digits represent a single number, and the third digit represents the number of zeros to follow that number. For example, the resistor in <a href="#figure3-3">Figure 3-3</a> has a value of 10,000 Ω, or 10 kΩ.</p>&#13;
			<figure>&#13;
				<img alt="f03003" src="image_fi/500587c03/f03003.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-3">Figure 3-3</a>: A surface-mount resistor</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<aside epub:type="sidebar">&#13;
				<div class="top hr">&#13;
					<hr/>&#13;
				</div>&#13;
				<section class="note">&#13;
					<h2><span class="NoteHead">NOTE</span></h2>&#13;
					<p>&#13;
							If you see a number and letter code on a small chip resistor (such as <em>01C</em>), google <em>EIA-96 code calculator</em> for lookup tables for that more involved code system.</p>&#13;
					<div class="bottom hr">&#13;
						<hr/>&#13;
					</div>&#13;
				</section>&#13;
			</aside>&#13;
			<aside epub:type="sidebar">&#13;
				<div class="top hr">&#13;
					<hr/>&#13;
				</div>&#13;
				<section class="box">&#13;
					<h2><span epub:type="pagebreak" id="Page_28" title="28"/>Multimeters</h2>&#13;
					<p class="BoxBodyFirst">A <em>multimeter</em> is an incredibly useful and relatively inexpensive piece of test equipment that can measure voltage, resistance, current, and more. <a href="#figure3-4" id="figureanchor3-4">Figure 3-4</a> shows a multimeter measuring a resistor.</p>&#13;
					<figure>&#13;
						<img alt="f03004" src="image_fi/500587c03/f03004.png"/>&#13;
						<figcaption>&#13;
							<p><a id="figure3-4">Figure 3-4</a>: A multimeter measuring a 560 Ω, 1 percent tolerance resistor</p>&#13;
						</figcaption>&#13;
					</figure>&#13;
					<p>If you have difficulty distinguishing the different codes on a color-coded resistor, a multimeter is essential. As with other good tools, purchase your multimeter from a reputable retailer instead of fishing about on the internet for the cheapest one you can find.</p>&#13;
					<div class="bottom hr">&#13;
						<hr/>&#13;
					</div>&#13;
				</section>&#13;
			</aside>&#13;
			<h4 id="h3-500587c03-0004">Power Rating</h4>&#13;
			<p class="BodyFirst">The resistor’s <em>power rating</em> is a measurement of the power, in watts, that it will tolerate before overheating or failing. The resistors shown in <a href="#figure3-1">Figure 3-1</a> are 1/4W resistors, which are the most commonly used resistors with the Arduino system. For the purposes of the projects in this book, you only need 1/4W resistors.</p>&#13;
			<p>When you’re selecting a resistor, consider the relationship between power, current, and voltage. The greater the current and/or voltage in your design, the greater the resistor’s power rating should be.</p>&#13;
			<p>&#13;
				Usually, the greater a resistor’s power rating, the greater its physical size. For example, the resistor shown in <a href="#figure3-5" id="figureanchor3-5">Figure 3-5</a> is a 5W resistor, whose body measures 22 mm long by 10 mm wide.</p>&#13;
			<figure>&#13;
				<img alt="f03005" src="image_fi/500587c03/f03005.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-5">Figure 3-5</a>: A 5W resistor</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<h3 id="h2-500587c03-0005"><span epub:type="pagebreak" id="Page_29" title="29"/>The Light-Emitting Diode</h3>&#13;
			<p class="BodyFirst">The LED is a very common, infinitely useful component that converts electrical current into light. LEDs come in various shapes, sizes, and colors. <a href="#figure3-6" id="figureanchor3-6">Figure 3-6</a> shows a common LED.</p>&#13;
			<figure>&#13;
				<img alt="f03006" src="image_fi/500587c03/f03006.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-6">Figure 3-6</a>: A red LED, 5 mm in diameter</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<p>&#13;
				Connecting LEDs in a circuit takes some care, because they are <em>polarized</em>; this means that current can enter and leave the LED in one direction only. The current enters via the <em>anode</em> (positive) side and leaves via the <em>cathode</em> (negative) side, as shown in <a href="#figure3-7" id="figureanchor3-7">Figure 3-7</a>. Any attempt to make too much current flow through an LED in the opposite direction will break the component.</p>&#13;
			<p>&#13;
				Thankfully, LEDs are designed so that you can tell which end is which. The leg on the anode side is longer (you can think of the “plus” side as having length “added” to it), and the rim at the base of the LED is flat on the cathode side, as shown in <a href="#figure3-8" id="figureanchor3-8">Figure 3-8</a>.</p>&#13;
			<figure>&#13;
				<img alt="f03007" src="image_fi/500587c03/f03007.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-7">Figure 3-7</a>: Current flow through an LED</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<figure>&#13;
				<img alt="f03008" src="image_fi/500587c03/f03008.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-8">Figure 3-8</a>: LED design indicates the anode (longer leg) and cathode (flat rim) sides.</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<p>When adding LEDs to a project, you need to consider the operating voltage and current. For example, common red LEDs require around 1.7 V and 5 to 20 mA of current. This presents a slight problem for us, because the Arduino outputs a set 5 V and a much higher current. Luckily, we can use a current-limiting resistor to reduce the current flow into an LED. But which value resistor do we use? That’s where Ohm’s law comes in.</p>&#13;
			<p><span epub:type="pagebreak" id="Page_30" title="30"/>To calculate the required current-limiting resistor for an LED, use this formula:</p>&#13;
			<p><em>R</em> = (<em>V</em><sub>s</sub> − <em>V</em><sub>f</sub>) ÷ <em>I</em></p>&#13;
			<p class="BodyContinued">where <em>V</em><sub>s</sub> is the supply voltage (Arduino outputs 5 V), <em>V</em><sub>f</sub> is the LED forward voltage drop (say, 1.7 V), and <em>I</em> is the current required for the LED (10 mA). (The value of <em>I</em> must be in amps, so 10 mA converts to 0.01 A.)</p>&#13;
			<p>&#13;
				Now let’s apply this formula to our LEDs, using values of 5 V for <em>V</em><sub>s</sub>, 1.7 V for <em>V</em><sub>f</sub>, and 0.01 A for <em>I</em>. Substituting these values into the formula gives a value for <em>R</em> of 330 Ω. However, the LEDs will happily light up when fed current less than 10 mA. It’s good practice to use lower currents when possible to protect sensitive electronics, so we’ll use 560 Ω, 1/4W resistors with our LEDs, which allow around 6 mA of current to flow.</p>&#13;
			<aside epub:type="sidebar">&#13;
				<div class="top hr">&#13;
					<hr/>&#13;
				</div>&#13;
				<section class="note">&#13;
					<h2><span class="NoteHead">NOTE</span></h2>&#13;
					<p>	When in doubt, always choose a slightly higher value resistor, because it’s better to have a dim LED than a dead one!</p>&#13;
					<div class="bottom hr">&#13;
						<hr/>&#13;
					</div>&#13;
				</section>&#13;
			</aside>&#13;
			<aside epub:type="sidebar">&#13;
				<div class="top hr">&#13;
					<hr/>&#13;
				</div>&#13;
				<section class="box">&#13;
					<h2>The Ohm’s Law Triangle</h2>&#13;
					<p class="BoxBodyFirst">Ohm’s law states that the relationship between current, resistance, and voltage is as follows:</p>&#13;
					<p>&#13;
						Voltage (<em>V</em>) = Current (<em>I</em>) × Resistance (<em>R</em>)</p>&#13;
					<p>&#13;
						If you know two of the quantities, you can calculate the third. A popular way to remember Ohm’s law is with a triangle, as shown in <a href="#figure3-9" id="figureanchor3-9">Figure 3-9</a>.</p>&#13;
					<figure>&#13;
						<img alt="f03009" src="image_fi/500587c03/f03009.png"/>&#13;
						<figcaption>&#13;
							<p><a id="figure3-9">Figure 3-9</a>: The Ohm’s law triangle</p>&#13;
						</figcaption>&#13;
					</figure>&#13;
					<p>&#13;
						The Ohm’s law triangle diagram is a convenient tool for calculating voltage, current, or resistance when two of the three values are known. For example, if you need to calculate resistance, put your finger over <em>R</em>, leaving voltage divided by current. To calculate voltage, cover <em>V</em>, leaving current times resistance.</p>&#13;
					<div class="bottom hr">&#13;
						<hr/>&#13;
					</div>&#13;
				</section>&#13;
			</aside>&#13;
			<h3 id="h2-500587c03-0006"><span epub:type="pagebreak" id="Page_31" title="31"/>The Solderless Breadboard</h3>&#13;
			<p class="BodyFirst">Our ever-changing circuits will need a base—something to hold them together and build upon. A great tool for this purpose is a <em>solderless breadboard</em>. The breadboard is a plastic base with rows of electrically connected sockets (just don’t cut bread on them). They come in many sizes, shapes, and colors, as shown in <a href="#figure3-10" id="figureanchor3-10">Figure 3-10</a>.</p>&#13;
			<figure>&#13;
				<img alt="f03010" src="image_fi/500587c03/f03010.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-10">Figure 3-10</a>: Breadboards in various shapes and sizes</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<p>&#13;
				The key to using a breadboard is knowing how the sockets are connected—whether in short columns or in long rows along the edge or in the center. The connections vary by board. For example, in the breadboard shown at the top of <a href="#figure3-11" id="figureanchor3-11">Figure 3-11</a>, columns of five holes are connected vertically but isolated horizontally. If you place two wires in one vertical row, then they will be electrically connected. By the same token, the long rows in the center between the horizontal lines are connected horizontally. You’ll often need to connect a circuit to the supply voltage and ground, and these long horizontal lines of holes are ideal for that purpose.</p>&#13;
			<p>&#13;
				When you’re building more complex circuits, a breadboard will get crowded, and you won’t always be able to place components exactly where you want. It’s easy to solve this problem using short connecting wires, however. Retailers that sell breadboards usually also sell small boxes of wires of various lengths, such as the assortment shown in <a href="#figure3-12" id="figureanchor3-12">Figure 3-12</a>.</p>&#13;
				<span epub:type="pagebreak" id="Page_32" title="32"/>&#13;
				<figure>&#13;
				<img alt="f03011" src="image_fi/500587c03/f03011.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-11">Figure 3-11</a>: Breadboard internal connections</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<figure>&#13;
				<img alt="f03012" src="image_fi/500587c03/f03012.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-12">Figure 3-12</a>: Assorted breadboard wires</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<h2 class="HeadProject" id="h1-500587c03-0004"><span><span epub:type="pagebreak" id="Page_33" title="33"/>Project #1: Creating a Blinking LED Wave</span></h2>&#13;
			<p class="BodyFirst">Let’s put some LEDs and resistors to work. In this project, we’ll use five LEDs to emulate the front of the famous vehicle KITT from the television show <em>Knight Rider</em>, creating a kind of wavelike light pattern.</p>&#13;
			<h3 id="h2-500587c03-0007">The Algorithm</h3>&#13;
			<p class="BodyFirst">Here’s our algorithm for this project:</p>&#13;
			<ol class="decimal">&#13;
				<li value="1">Turn on LED 1.</li>&#13;
				<li value="2">Wait half a second.</li>&#13;
				<li value="3">Turn off LED 1.</li>&#13;
				<li value="4">Turn on LED 2.</li>&#13;
				<li value="5">Wait half a second.</li>&#13;
				<li value="6">Turn off LED 2.</li>&#13;
				<li value="7">Continue until LED 5 is turned on, at which point the process reverses from LEDs 5 to 1.</li>&#13;
				<li value="8">Repeat indefinitely.</li>&#13;
			</ol>&#13;
			<h3 id="h2-500587c03-0008">The Hardware</h3>&#13;
			<p class="BodyFirst">Here’s what you’ll need to create this project:</p>&#13;
			<ul>&#13;
				<li>Five LEDs</li>&#13;
				<li>Five 560 Ω resistors</li>&#13;
				<li>One breadboard</li>&#13;
				<li>Various connecting wires</li>&#13;
				<li>Arduino and USB cable</li>&#13;
			</ul>&#13;
			<p>We will connect the LEDs to digital pins 2 through 6 via the 560 Ω current-limiting resistors.</p>&#13;
			<h3 id="h2-500587c03-0009">The Schematic</h3>&#13;
			<p class="BodyFirst">Now let’s build the circuit. Circuit layout can be described in several ways. For the first few projects in this book, we’ll use physical layout diagrams similar to the one shown in <a href="#figure3-13" id="figureanchor3-13">Figure 3-13</a>.</p>&#13;
			<p>&#13;
				By comparing the wiring diagram to the functions in the sketch, you can begin to make sense of the circuit. For example, when we use <code>digitalWrite(2, HIGH)</code>, a high voltage of 5 V flows from digital pin 2, through the current-limiting resistor, through the LED via the anode and then the cathode, and finally back to the Arduino’s GND socket to complete the circuit. Then, when we use <code>digitalWrite(2, LOW)</code>, the current stops and the LED turns off.</p>&#13;
				<span epub:type="pagebreak" id="Page_34" title="34"/>&#13;
				<figure>&#13;
				<img alt="f03013" src="image_fi/500587c03/f03013.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-13">Figure 3-13</a>: Circuit layout for Project 1</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<h3 id="h2-500587c03-0010">The Sketch</h3>&#13;
			<p class="BodyFirst">Now for our sketch. Enter this code into the IDE:</p>&#13;
			<pre><code>// Project 1 - Creating a Blinking LED Wave<span aria-label="annotation1" class="CodeAnnotationHang">1</span> void setup()&#13;
{ pinMode(2, OUTPUT);	// LED 1 control pin is set up as an output pinMode(3, OUTPUT);	// same for LED 2 to LED 5 pinMode(4, OUTPUT); pinMode(5, OUTPUT); pinMode(6, OUTPUT);&#13;
} <span aria-label="annotation2" class="CodeAnnotationHang">2</span> void loop()&#13;
{ digitalWrite(2, HIGH); // Turn LED 1 on delay(500); // wait half a second digitalWrite(2, LOW);  // Turn LED 1 off digitalWrite(3, HIGH); // and repeat for LED 2 to 5 delay(500); digitalWrite(3, LOW); digitalWrite(4, HIGH); delay(500);<span epub:type="pagebreak" id="Page_35" title="35"/>   digitalWrite(4, LOW); digitalWrite(5, HIGH); delay(500); digitalWrite(5, LOW); digitalWrite(6, HIGH); delay(500); digitalWrite(6, LOW); digitalWrite(5, HIGH); delay(500); digitalWrite(5, LOW);    digitalWrite(4, HIGH); delay(500); digitalWrite(4, LOW); digitalWrite(3, HIGH); delay(500); digitalWrite(3, LOW);&#13;
// The loop() will now loop around and start from the top again&#13;
}</code></pre>&#13;
			<p>&#13;
				In <code>void setup()</code> at <span aria-label="annotation1" class="CodeAnnotation">1</span>, the digital I/O pins are set to outputs, because we want them to send current to the LEDs on demand. We specify when to turn on each LED using the <code>digitalWrite()</code> function in the <code>void loop()</code> section of the sketch at <span aria-label="annotation2" class="CodeAnnotation">2</span>.</p>&#13;
			<h3 id="h2-500587c03-0011">Running the Sketch</h3>&#13;
			<p class="BodyFirst">Now connect your Arduino and upload the sketch. After a second or two, the LEDs should blink from left to right and then back again. Success is a wonderful thing—embrace it!</p>&#13;
			<p>If nothing happens, however, then immediately remove the USB cable from the Arduino and check that you typed the sketch correctly. If you find an error, fix it and upload your sketch again. If your sketch matches exactly and the LEDs still don’t blink, check your wiring on the breadboard.</p>&#13;
			<p>&#13;
				You now know how to make an LED blink with your Arduino, but this sketch is somewhat inefficient. For example, if you wanted to modify it to make the LEDs cycle more quickly, you would need to alter each <code>delay(500)</code>. There is a better way.</p>&#13;
			<h2 id="h1-500587c03-0005">Using Variables</h2>&#13;
			<p class="BodyFirst">In computer programs, we can use <em>variables</em> to store data. The problem with the sketch for Project 1 as written is that because it doesn’t use variables, it’s not very flexible. For example, we use the function <code>delay(500)</code> to keep the LEDs turned on. If we want to make a change to the delay time, then we have to change each entry manually. To address this problem, we’ll create a variable to represent the value for the <code>delay()</code> function.</p>&#13;
			<p>&#13;
				Enter the following line in the Project 1 sketch, above the <code>void setup()</code> function and just after the initial comment:</p>&#13;
			<pre><code><b>int d = 250;</b></code></pre>&#13;
			<p><span epub:type="pagebreak" id="Page_36" title="36"/>This assigns the number <code>250</code> to a variable called <code>d</code>. The <code>int</code> indicates that the variable contains an integer—a whole number between −32,768 and 32,767. Simply put, any integer value has no fraction or decimal places.</p>&#13;
			<p>&#13;
				Next, change every <code>500</code> in the sketch to a <code>d</code>. Now when the sketch runs, the Arduino will use the value in <code>d</code> for the <code>delay()</code> functions. When you upload your sketch after making these changes, the LEDs will turn on and off at a much faster rate, as the delay value is much smaller.</p>&#13;
			<p>&#13;
				Now, if you want to change the delay, simply change the variable declaration at the start of the sketch. For example, entering <code>100</code> for the delay would speed things up even more:</p>&#13;
			<pre><code><b>int d = 100;</b></code></pre>&#13;
			<p>&#13;
				Experiment with the sketch, perhaps altering the delays and the sequence of <code>HIGH</code> and <code>LOW</code>. Have some fun with it. Don’t disassemble the circuit yet, though; we’ll continue to use it with more projects in this chapter.</p>&#13;
			<h2 class="HeadProject" id="h1-500587c03-0006"><span>Project #2: Repeating with for Loops</span></h2>&#13;
			<p class="BodyFirst">When designing a sketch, you’ll often repeat the same function. You could simply copy and paste the function to duplicate it in a sketch, but that’s inefficient and a waste of your Arduino’s program memory. Instead, you can use <code>for</code> loops. The benefit of using a <code>for</code> loop is that you can determine how many times the code inside the loop will repeat.</p>&#13;
			<p>&#13;
				To see how a <code>for</code> loop works, enter the following code as a new sketch:</p>&#13;
			<pre><code>// Project 2 - Repeating with for Loops&#13;
int d = 100; &#13;
void setup()&#13;
{ pinMode(2, OUTPUT); pinMode(3, OUTPUT); pinMode(4, OUTPUT); pinMode(5, OUTPUT); pinMode(6, OUTPUT);&#13;
} &#13;
void loop()&#13;
{ for ( int a = 2; a &lt; 7 ; a++ ) { digitalWrite(a, HIGH); delay(d); digitalWrite(a, LOW); delay(d); }&#13;
}</code></pre>&#13;
			<p><span epub:type="pagebreak" id="Page_37" title="37"/>The <code>for</code> loop will repeat the code within the curly brackets as long as some condition is true. Here we have used a new integer variable, <code>a</code>, which starts with the value <code>2</code>. Every time the code is executed, the <code>a++</code> will add 1 to the value of <code>a</code>. The loop will continue in this fashion while the value of <code>a</code> is less than 7 (the <em>condition</em>). Once it is equal to or greater than 7, the Arduino moves on and continues with whatever code comes after the <code>for</code> loop.</p>&#13;
			<p>&#13;
				The number of loops that a <code>for</code> loop executes can also be set by counting down from a higher number to a lower number. To demonstrate this, add the following loop to the Project 2 sketch after the first <code>for</code> loop:</p>&#13;
			<pre><code><span aria-label="annotation1" class="CodeAnnotationHang">1</span> for ( int a = 5 ; a &gt; 1 ; a-- )&#13;
{ digitalWrite(a, HIGH); delay(d); digitalWrite(a, LOW); delay(d);&#13;
}</code></pre>&#13;
			<p>&#13;
				Here, the <code>for</code> loop at <span aria-label="annotation1" class="CodeAnnotation">1</span> sets the value of <code>a</code> equal to 5 and then subtracts 1 after every loop due to the <code>a--</code>. The loop continues in this manner while the value of <code>a</code> is greater than 1 (<code>a &gt; 1</code>) and finishes once the value of <code>a</code> falls to 1 or less than 1.</p>&#13;
			<p>We have now re-created Project 1 using less code. Upload the sketch and see for yourself!</p>&#13;
			<h2 id="h1-500587c03-0007">Varying LED Brightness with Pulse-Width Modulation</h2>&#13;
			<p class="BodyFirst">Rather than just turning LEDs on and off rapidly using <code>digitalWrite()</code>, we can define the level of brightness of an LED by adjusting the amount of time between each LED’s on and off states using <em>pulse-width modulation (PWM)</em>. PWM can be used to create the illusion that an LED is shining at different levels of brightness by turning the LED on and off rapidly, at around 500 cycles per second. The brightness we perceive is determined by the amount of time the digital output pin is on versus the amount of time it is off—that is, how long the LED is lit or unlit. Because our eyes can’t see flickers faster than 50 cycles per second, the LED appears to have a constant brightness.</p>&#13;
			<p>&#13;
				The greater the <em>duty cycle</em> (the longer the pin is on compared to off in each cycle), the greater the perceived brightness of the LED connected to the digital output pin.</p>&#13;
			<p><a href="#figure3-14" id="figureanchor3-14">Figure 3-14</a> shows various PWM duty cycles. The filled-in gray areas represent the amount of time that the light is on. As you can see, the amount of time per cycle that the light is on increases with the duty cycle.</p>&#13;
			<span epub:type="pagebreak" id="Page_38" title="38"/>&#13;
			<figure>&#13;
				<img alt="f03014" src="image_fi/500587c03/f03014.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-14">Figure 3-14</a>: Various PWM duty cycles</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<p>&#13;
				Only digital pins 3, 5, 6, 9, 10, and 11 on a regular Arduino board can be used for PWM. They are marked on the Arduino board with a tilde (~), as shown in <a href="#figure3-15" id="figureanchor3-15">Figure 3-15</a>.</p>&#13;
			<figure>&#13;
				<img alt="f03015" src="image_fi/500587c03/f03015.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-15">Figure 3-15</a>: The PWM pins are marked with a tilde (~).</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<p>&#13;
				To create a PWM signal, we use the function <code>analogWrite(</code><var>x</var><code>, </code><var>y</var><code>)</code>, where <var>x</var> is the digital pin and <var>y</var> is a value for the duty cycle. <var>y</var> can be any value between 0 and 255, where 0 indicates a 0 percent duty cycle and 255 indicates a 100 percent duty cycle.</p>&#13;
			<h2 class="HeadProject" id="h1-500587c03-0008"><span>Project #3: Demonstrating PWM</span></h2>&#13;
			<p class="BodyFirst">Now let’s try this with our circuit from Project 2. Enter the following sketch into the IDE and upload it to the Arduino:</p>&#13;
			<pre><code>// Project 3 - Demonstrating PWM&#13;
int d = 5;&#13;
void setup()<span epub:type="pagebreak" id="Page_39" title="39"/>{ pinMode(3, OUTPUT); // LED control pin is 3, a PWM-capable pin&#13;
} &#13;
void loop()&#13;
{ for ( int a = 0 ; a &lt; 256 ; a++ ) { analogWrite(3, a); delay(d); } for ( int a = 255 ; a &gt;= 0 ; a-- ) { analogWrite(3, a); delay(d); } delay(200);&#13;
}</code></pre>&#13;
			<p>The LED on digital pin 3 will exhibit a “breathing effect” as the duty cycle increases and decreases. In other words, the LED will turn on, increasing in brightness until fully lit, and then reverse until it is dark. Experiment with the sketch and circuit. For example, make all five LEDs breathe at once, or have them do so sequentially.</p>&#13;
			<h2 id="h1-500587c03-0009">More Electric Components</h2>&#13;
			<p class="BodyFirst">You’ll usually find it easy to plan on having a digital output do something without taking into account how much current the control really needs to get the job done. As you create your project, remember that each digital output pin on the Arduino Uno can offer a maximum of 40 mA of current per pin and 200 mA total for all pins. However, the three electronic hardware components discussed next can help you increase the current-handling ability of the Arduino.</p>&#13;
			<aside epub:type="sidebar">&#13;
				<div class="top hr">&#13;
					<hr/>&#13;
				</div>&#13;
				<section class="note">&#13;
					<h2><span class="NoteHead">WARNING</span></h2>&#13;
					<p>	If you attempt to exceed 40 mA on a single pin, or 200 mA total, then you risk permanently damaging the microcontroller integrated circuit (IC).</p>&#13;
					<div class="bottom hr">&#13;
						<hr/>&#13;
					</div>&#13;
				</section>&#13;
			</aside>&#13;
			<h3 id="h2-500587c03-0012">The Transistor</h3>&#13;
			<p class="BodyFirst">Almost everyone has heard of a <em>transistor</em>, but most people don’t really understand how it works. In the spirit of brevity, I will keep the explanation as simple as possible. A transistor can turn on or off the flow of a much larger current than the Arduino Uno can handle. We can, however, safely control a transistor using an Arduino digital output pin. A popular transistor is the BC548, shown in <a href="#figure3-16" id="figureanchor3-16">Figure 3-16</a>.</p>&#13;
			<span epub:type="pagebreak" id="Page_40" title="40"/>&#13;
			<figure>&#13;
				<img alt="f03016" src="image_fi/500587c03/f03016.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-16">Figure 3-16</a>: A typical transistor: the BC548</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<p>&#13;
				Similar to the LED, the transistor’s pins have a unique function and need to be connected in the proper orientation. With the flat front of the transistor facing you (as shown on the left of <a href="#figure3-16">Figure 3-16</a>), the pins on the BC548 are called, from left to right, the <em>collector</em> (C), <em>base</em> (B), and <em>emitter</em> (E). (Note that this pin order, or <em>pinout</em>, is for the BC548 transistor; other transistors may be oriented differently.) When a small current is applied to the base, such as from an Arduino digital I/O pin, the larger current we want to switch enters through the collector. It’s combined with the small current from the base before flowing out via the emitter. When the small control current at the base is turned off, no current can flow through the transistor.</p>&#13;
			<p>The BC548 can switch up to 100 mA of current at a maximum of 30 V—much more than the Arduino’s digital output. In projects later in the book, you’ll read about transistors in more detail.</p>&#13;
			<aside epub:type="sidebar">&#13;
				<div class="top hr">&#13;
					<hr/>&#13;
				</div>&#13;
				<section class="note">&#13;
					<h2><span class="NoteHead">NOTE</span></h2>&#13;
					<p>	Always pay attention to the pin order for your particular transistor, because each transistor can have its own orientation.</p>&#13;
					<div class="bottom hr">&#13;
						<hr/>&#13;
					</div>&#13;
				</section>&#13;
			</aside>&#13;
			<h3 id="h2-500587c03-0013">The Rectifier Diode</h3>&#13;
			<p class="BodyFirst">The <em>diode</em> is a very simple yet useful component that allows current to flow in one direction only. It looks a lot like a resistor, as you can see in <a href="#figure3-17" id="figureanchor3-17">Figure 3-17</a>.</p>&#13;
			<figure>&#13;
				<img alt="f03017" src="image_fi/500587c03/f03017.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-17">Figure 3-17</a>: A 1N4004-type rectifier diode</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<p><span epub:type="pagebreak" id="Page_41" title="41"/>The projects in this book will use the 1N4004-type rectifier diode. Current flows into the diode via the anode and out through the cathode, which is marked with the ring around the diode’s body. These diodes can protect parts of the circuit against reverse current flow, but there is a price to pay: diodes also cause a drop in the voltage of around 0.7 V. The 1N4004 diode is rated to handle 1 A and 400 V, much higher than we will be using. It’s a tough, common, and low-cost diode.</p>&#13;
			<h3 id="h2-500587c03-0014">The Relay</h3>&#13;
			<p class="BodyFirst"><em>Relays</em> are used for the same reason as transistors—to control a large current and voltage. A relay has the advantage of being <em>electrically isolated</em> from the control circuit, allowing the Arduino to switch very large currents and voltages without actually coming into contact with those voltages, which could damage it. Inside the relay is an interesting pair of items: mechanical switch contacts and a low-voltage coil of wire, as shown in <a href="#figure3-18" id="figureanchor3-18">Figure 3-18</a>.</p>&#13;
			<figure class="graphic">&#13;
				<img alt="f03018" src="image_fi/500587c03/f03018.png"/>&#13;
			</figure>&#13;
			<figure>&#13;
				<img alt="f03018a" src="image_fi/500587c03/f03018a.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-18">Figure 3-18</a>: Inside a typical relay</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<p>When a current is applied to the relay, the coil becomes an electromagnet and attracts a bar of metal that acts just like the toggle of a switch. The magnet pulls the bar in one direction when on and lets it fall back when off, thereby turning it on or off as current is applied to and removed from the coil. This movement has a distinctive “click” that you might recognize from the turn signal in older cars.</p>&#13;
			<h2 id="h1-500587c03-0010">Higher-Voltage Circuits</h2>&#13;
			<p class="BodyFirst">Now that you understand a bit about the transistor, rectifier diode, and relay, let’s use them together to control higher currents and voltages. For example, you may wish to turn a large motor on or off. Connecting the components is simple, as shown in <a href="#figure3-19" id="figureanchor3-19">Figure 3-19</a>.</p>&#13;
			<span epub:type="pagebreak" id="Page_42" title="42"/>&#13;
			<figure>&#13;
				<img alt="f03019" src="image_fi/500587c03/f03019.png"/>&#13;
				<figcaption>&#13;
					<p><a id="figure3-19">Figure 3-19</a>: A relay control circuit</p>&#13;
				</figcaption>&#13;
			</figure>&#13;
			<p>&#13;
				This simple example circuit controls a relay that has a 12 V coil. One use for this circuit might be to control a lamp or cooling fan connected to the relay switching contacts. The Arduino’s digital pin 10 is connected to the transistor’s base via a 1 kΩ resistor. The transistor controls the current through the relay’s coil by switching it on and off. Remember that the pins are <em>C</em>, <em>B</em>, and then <em>E</em> when looking at the flat surface of the transistor. The object on the left of the breadboard at <span aria-label="annotation1" class="CodeAnnotation">1</span> represents a 12 V power supply for the relay coil. The negative or ground at <span aria-label="annotation2" class="CodeAnnotation">2</span> from the 12 V supply, the transistor’s emitter pin, and Arduino GND are all connected together. Finally, a 1N4004 rectifier diode is connected across the relay’s coil at <span aria-label="annotation3" class="CodeAnnotation">3</span>, with the cathode on the positive supply side. You can check the relay’s data sheet to determine the pins for the contacts and to connect the controlled item appropriately.</p>&#13;
			<p>The diode is in place to protect the circuit. When the relay coil changes from on to off, stray current remains briefly in the coil and becomes a high-voltage spike that has to go somewhere. The diode allows the stray current to loop around through the coil until it is dissipated as a tiny amount of heat. It prevents the turn-off spike from damaging the transistor or Arduino pin.</p>&#13;
			<aside epub:type="sidebar">&#13;
				<div class="top hr">&#13;
					<hr/>&#13;
				</div>&#13;
				<section class="note"><span epub:type="pagebreak" id="Page_43" title="43"/>&#13;
				<h2><span class="NoteHead">WARNING</span></h2>&#13;
					<p>	If you want to control wall power electricity (110–250 V) at a high current with a relay, contact a licensed electrician to complete this work for you. Even the slightest mistake can be fatal.</p>&#13;
					<div class="bottom hr">&#13;
						<hr/>&#13;
					</div>&#13;
				</section>&#13;
			</aside>&#13;
			<h2 id="h1-500587c03-0011">Looking Ahead</h2>&#13;
			<p class="BodyFirst">And now Chapter 3 draws to a close. I hope you had fun trying out the examples and experimenting with LED effects. In this chapter, you got to create blinking LEDs on the Arduino in various ways, did a bit of hacking, and learned how functions and loops can be used to efficiently control components connected to the Arduino. Studying this chapter has set you up for more success in the forthcoming chapters.</p>&#13;
			<p><span class="xref" itemid="xref_target_Chapter 4">Chapter 4</span> will be a lot of fun. You will create some more advanced projects, including traffic lights, a thermometer, a battery tester, and more—so when you’re ready to take it to the next level, turn the page!</p>&#13;
		</section>&#13;
	</body></html>