<html><head></head><body><div id="sbo-rt-content"><section>&#13;
<header>&#13;
<h1 class="chapter">&#13;
<span class="ChapterNumber"><span epub:type="pagebreak" title="107" id="Page_107"/>14</span><br/>&#13;
<span class="ChapterTitle">Ghost on the Moon</span><br/>&#13;
<span class="ChapterSubtitle">According to Japanese legend, if you knew how to seek the ghost who tends trees on the moon, he could invite you to the moon to eat the leaves of his tree, making you invisible.</span></h1></header>&#13;
<blockquote class="Epigraph" epub:type="epigraph">&#13;
<p class="Epigraph">In normal times, before the need arises, you should find someone as an undercover agent who will become the betrayer, an enemy you plant and thus make a ninja of him and have him within the enemy castle, camp or vassalage, exactly as the ghost in the legend, Katsuraotoko, is stationed on the moon.</p>&#13;
<p class="EpigraphSource">—Bansenshūkai, Yo-nin I <sup class="endnote"><a id="c14-noteref-93" href="b01.xhtml#endnote-93">1</a></sup></p>&#13;
</blockquote>&#13;
<p class="ChapterIntro">As part of its array of sophisticated infiltration techniques, the <em>Bansenshūkai </em>describes a long-term open-disguise tactic called “ghost on the moon.” This tactic was designed to acquire privileged information and access through a planted secret agent. First, a shinobi recruits a person who is trustworthy, smart, wise, courageous, and loyal. Or, if the recruit is not loyal to begin with, the scroll suggests taking their family members hostage for the duration of <span epub:type="pagebreak" title="108" id="Page_108"/>the mission to make them “loyal.” Then, the shinobi plants the agent in a foreign province or castle. There, they will spend years working earnestly with the target to build up their reputation, connections, knowledge, and access. Ideally, the plant will be working closely with enemy leadership. The mole must always maintain plausible, reliable, and conspicuous means of contact with the shinobi. If this enemy stronghold ever becomes a target for attack, the shinobi handler can call on the undercover agent for high-confidence intelligence, insider assistance, sabotage, and offensive actions against the enemy, including assassination.<sup class="endnote"><a id="c14-noteref-94" href="b01.xhtml#endnote-94">2</a></sup> And while the ghost on the moon gambit took years to pay off, to patient and tactful shinobi, the reward was worth the time investment.</p>&#13;
<p>In this chapter, we will look at the ghost on the moon as a type of insider threat. It can help to think of hardware implants, by way of analogy, as trying to find ghosts on the moon with a telescope. For that reason, we’ll cover the subject of implants, supply chain security, and covert hardware backdoors. We will also compare the characteristics of a ghost on the moon plant with ideal hardware implants. We’ll touch on supply chain risk management and threat-hunting strategies, with the caveat that underlying issues make this threat nearly impossible to fully defend against. </p>&#13;
<h2 id="h1-500549c14-0001">Implants</h2>&#13;
<p class="BodyFirst">Corporate espionage and nation-state spy activities historically have relied on strategically placed agents to accomplish specific long-term missions. Today, technology offers newer and cheaper ways to get the results that have traditionally been possible only with human actors. For example, suppose your organization bought and installed a foreign-manufactured router on its network years ago, and it has functioned perfectly. But, unbeknownst to your security team, an adversary has just activated a hidden implant installed at the factory, providing direct, unfiltered backdoor access to your most sensitive systems and data.</p>&#13;
<p>The cybersecurity industry classifies this kind of attack as a <em>supply chain attack</em>. Here, <em>supply chain</em> refers to the products and services associated with an organization’s business activities or systems; examples include hardware, software, and cloud hosting. In the previous example, the router performs the necessary business activity of moving digital information over the network to conduct ecommerce.</p>&#13;
<p>While heuristics or threat hunting can detect abnormal router behavior, there is no foolproof way to defend against covert implants. Some organizations may use quality assurance representatives to monitor manufacturing, but they cannot ensure that every system is built correctly. <span epub:type="pagebreak" title="109" id="Page_109"/>However, several cybersecurity best practices can mitigate a router-based supply chain attack. A proactive organization could:</p>&#13;
<ol class="decimal">&#13;
<li value="1">Perform a threat analysis of all router manufacturers and then use the results to acquire a router less likely to ship with compromised hardware or software</li>&#13;
<li value="2">Employ a trusted, secure shipping service and procure chain of custody for the router to prevent malicious interception</li>&#13;
<li value="3">Conduct forensic inspection of the router upon delivery to validate that it has not been compromised or altered from the expected specifications</li>&#13;
<li value="4">Secure the router with tamper protections and detection technologies to identify and mitigate unauthorized alterations</li>&#13;
</ol>&#13;
<p>Note that these steps are not limited to routers. Organizations can take these precautions on every service, device, system, component, and software application in their supply chain.</p>&#13;
<p>Covert implants are as valuable to modern nation-states as they were to shinobi, because the need to discover and defend against them poses difficult, long-term organizational challenges. Cybersecurity professionals continually test new concepts to address those challenges. For example, an organization can restrict trust and access to all systems under the assumption that they have already been compromised. However, the significant impact they have on business operations renders many of these concepts a practical impossibility. </p>&#13;
<h2 id="h1-500549c14-0002">Protections from Implants</h2>&#13;
<p class="BodyFirst">Organizations attempting to weigh or x-ray every system to find something out of place will likely find themselves lost in the process of trying to manage their supply chain. What’s more, advanced threat actors capable of supply chain compromises are likely to embed malicious functions in the default design of the system. In this way, only <em>they</em> know the secret to enabling the implant, and it exists in every system. And while an organization’s inspection process may be able to see a threat, it might not understand what it’s looking at. This is the scope of this problem—it’s like trying to find a ghost on the moon. That said, guidance for protecting your organization from these implants is as follows:  </p>&#13;
<ol class="decimal">&#13;
<li value="1"><em>Identify supply chain attack conditions. </em>Create a list of components in your supply chain that have ghost on the moon potential. Include elements that:&#13;
<ul>&#13;
<li>Are considered high trust</li>&#13;
<li><span epub:type="pagebreak" title="110" id="Page_110"/>Can communicate</li>&#13;
<li>Can provide lateral or direct access to sensitive information or systems</li>&#13;
<li>Are not easily inspected</li>&#13;
<li>Are not regularly replaced or updated</li>&#13;
</ul>&#13;
<p class="ListBody">Specifically, look at software and hardware that communicates with external systems or exerts control over systems that can perform signal or communication functions (such as firmware on routers, network interface cards [NICs], and VPN concentrators). An implant can also exist as a hardware device, such as an extremely thin metal interface placed inside the PCI interface socket to act as a man-in-the-middle against the NIC, altering the data flow, integrity, confidentiality, and availability of network communications for that interface.</p>&#13;
<p class="ListBody">Imagine what your antivirus, hypervisor, vulnerability scanner, or forensic analyst cannot inspect or test in your environment. A key feature of ghost on the moon supply chain candidates is their ability to persist in the target’s environment, which likely requires targeting components that do not break or wear down regularly, are not easily replaced or upgraded with cheaper versions over time, are too important to turn off or dispose of, and are difficult to modify and update (such as firmware, BIOS, UEFI, and MINIX). Autonomy and stealth requirements for this class of supply chain implant mean the implant needs to avoid inspection, scans, and other types of integrity testing while having access to some form of processor instruction or execution. </p></li>&#13;
<li value="2"><em>Implement supply chain protections. </em>Implement supply chain safeguards and protections as needed. A ghost on the moon supply chain attack is one of the most challenging to detect, prevent, or mitigate. Thus, many organizations simply accept or ignore this risk. It can be useful to start with first principles—fundamental truths about security and the purpose of your business—and then use these truths as a rubric to evaluate the threat your organization faces. Review “A Contemporary Look at Saltzer and Schroeder’s 1975 Design Principles”<sup class="endnote"><a id="c14-noteref-95" href="b01.xhtml#endnote-95">3</a></sup> or other core security works to determine appropriate mitigations for this threat. It could also be helpful to abstract the problems to higher-level concepts, where they become familiar and understood, and then attempt to solve them. Consider the following Castle Theory Thought Exercise. &#13;
<aside epub:type="sidebar">&#13;
<div class="top hr"><hr/></div>&#13;
<section class="box">&#13;
<h2><span epub:type="pagebreak" title="111" id="Page_111"/>Castle Theory Thought Exercise</h2>&#13;
<p class="BoxBodyFirst">Consider the scenario in which you are the ruler of a medieval castle with valuable assets inside. You receive credible threat intelligence that a scribe in your employ is an enemy “ghost on the moon” plant. This agent has spent the past 10 years learning to copy your handwriting style, vernacular, and sealing techniques, and they have memorized the names and addresses of all your important contacts. The plant has the means to modify your outgoing orders, such as by directing your standing army to travel far from key defense locations. It is not clear which scribe is the plant or whether the scribe has already been activated by an enemy shinobi. Scribes are a scarce resource in your kingdom—acquiring and training them is costly and time intensive—and they are critical to your operations.</p>&#13;
<p>How do you detect which scribe is an enemy plant, both pre- and postactivation? Consider what safeguards could prevent the scribe from sending altered orders in your name. What authentication protocols could you implement to prevent message spoofing? What integrity measures might you take to prevent message tampering? What nonrepudiation controls would deny false messages sent in your name? How could you ensure that future scribes are not compromised enemy plants? Finally, consider all these questions in a scenario in which multiple scribes are enemy plants. </p>&#13;
<div class="bottom hr"><hr/></div>&#13;
</section>&#13;
</aside></li>&#13;
</ol>&#13;
<h2 id="h1-500549c14-0003">Recommended Security Controls and Mitigations</h2>&#13;
<p class="BodyFirst">Where relevant, recommendations are presented with applicable security controls from the NIST 800-53 standard. Each should be evaluated with the concept of ghost on the moon in mind.</p>&#13;
<ol class="decimal">&#13;
<li value="1">Consider introducing heterogeneity into the supply chain by isolating, segmenting, and layering a diverse set of supply chain components. Supply chain diversity greatly reduces the potential impact of a compromised component. [SC-29: Heterogeneity]</li>&#13;
<li value="2">Analyze your organization’s procurement process to identify areas in which you can reduce the risk of a supply chain attack. Use techniques such as blind buying, trusted shipping, restricting purchases from certain companies or countries, amending purchasing contract language, and randomizing or minimizing acquisition time. [SA-12: Supply Chain Protection | (1) Acquisition Strategies/Tools/Methods] </li>&#13;
<li value="3">Consider delaying non-security updates or acquisition of new, untested software, hardware, and services for as long as possible. <span epub:type="pagebreak" title="112" id="Page_112"/>Implement advanced countermeasures to limit a sophisticated actor’s opportunity to target your organization. [SA-12: Supply Chain Protection | (5) Limitation of Harm]</li>&#13;
<li value="4">Purchase or assess multiple instances of the same hardware, software, component, or service through different vendors to identify alterations or non-genuine elements. [SA-12: Supply Chain Protection | (10) Validate as Genuine and Not Altered; SA-19: Component Authenticity; SI-7: Software, Firmware, and Information Integrity | (12) Integrity Verification]</li>&#13;
<li value="5">Install independent, out-of-band monitoring mechanisms and sanity tests to verify that high-trust components suspected of supply chain attack are not performing covert communications or altering data streams. [SI-4: Information System Monitoring | (11) Analyze Communications Traffic Anomalies | (17) Integrated Situational Awareness | (18) Analyze Traffic/Covert Exfiltration] </li>&#13;
</ol>&#13;
<h2 id="h1-500549c14-0004">Debrief</h2>&#13;
<p class="BodyFirst">In this chapter, we reviewed the shinobi technique of hiring trusted allies to work inside an organization and position themselves to be as useful to the shinobi as possible. We compared this type of plant to hardware implants and discussed the theory behind what devices and systems would be suitable for hardware implants. We talked about supply chain attacks, along with ways to potentially detect them. The thought exercise challenged you to detect a compromised scribe who has privileged access to communications; the scribe represents a router, VPN, or other layer 3 device meant to be transparent to the communicators, highlighting how difficult it can be to determine when such a device is compromised.</p>&#13;
<p>In the next chapter, we will discuss the shinobi’s backup plan if you do happen to catch them or their plant. The shinobi would often plant false evidence ahead of time, long before their covert mission, enabling them to shift blame if caught. When successful, this tactic tricks the victim into believing an ally betrayed them, and this deception itself harms the target.</p>&#13;
</section>&#13;
</div></body></html>