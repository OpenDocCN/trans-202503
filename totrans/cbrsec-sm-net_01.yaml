- en: '[1](nsp-enoka501485-0007.xhtml#rch01)'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[1](nsp-enoka501485-0007.xhtml#rch01)'
- en: Getting Started with a Base Linux System and Network Map
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 开始使用基础Linux系统和网络地图
- en: '![Chapter opening icon](images/nsp-enoka501485-ct.jpg)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![章节开头图标](images/nsp-enoka501485-ct.jpg)'
- en: 'This chapter presents two fundamental projects: setting up a basic Ubuntu system
    that you’ll use throughout the book and creating a network map. You’ll use this
    system as a base on top of which you will install and run various security tools,
    and the network map will provide a visual overview of all the devices in your
    network and how they interrelate and communicate.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章介绍了两个基本项目：设置一个基础的Ubuntu系统，这是你在本书中将一直使用的系统，并创建一个网络地图。你将使用这个系统作为基础，在其上安装和运行各种安全工具，而网络地图将提供一个所有设备在网络中如何相互联系和通信的视觉概览。
- en: We’ll start with a definition and overview of common Linux operating systems
    and then go through the steps to install a version of Linux (specifically, Ubuntu)
    in a virtual machine (VM), on a physical computer, and in the cloud. Regardless
    of where it’s installed, I’ll show you how to make Ubuntu more secure and then
    add it to your network map. Every time a new endpoint is added to your network,
    you must update your network map to ensure it’s always up-to-date. An out-of-date
    network map is no use to anyone.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将首先定义并概述常见的Linux操作系统，然后介绍如何在虚拟机（VM）、物理计算机和云环境中安装Linux版本（特别是Ubuntu）。无论安装在哪里，我都会教你如何提升Ubuntu的安全性，并将其添加到网络地图中。每次向网络中添加新终端时，都必须更新网络地图，以确保其始终是最新的。过时的网络地图对任何人都没有用。
- en: '[Linux Operating Systems](nsp-enoka501485-0007.xhtml#rah0301)'
  id: totrans-5
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '[Linux操作系统](nsp-enoka501485-0007.xhtml#rah0301)'
- en: Linux is the operating system of choice, as Linux systems are open source and
    therefore very extensible, especially when compared to Windows or macOS. The level
    of control you have over the operating system and the applications that run on
    top of it is very granular, enabling you to have far better control over the security
    of your endpoints and your network.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: Linux是首选的操作系统，因为Linux系统是开源的，因此具有很高的扩展性，特别是与Windows或macOS相比。你对操作系统及其上运行的应用程序的控制非常细致，这使得你能更好地掌控终端和网络的安全性。
- en: Several Linux operating systems (or *distributions*) are available. Each distribution
    uses a different set of basic utilities and graphical user interfaces (GUIs),
    and each one looks and functions in a slightly different way. For example, Kali
    Linux is a distribution geared toward offensive operations and is commonly used
    by penetration testers to perform network assessments. Red Hat Linux is probably
    the most used enterprise distribution, and several other distributions are based
    on Red Hat, such as Fedora and CentOS. If you’re interested in Linux, try various
    distributions to find the one you like the most.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 有多种Linux操作系统（或*发行版*）可供选择。每个发行版使用不同的基本工具和图形用户界面（GUI），每个发行版的外观和功能都有些不同。例如，Kali
    Linux是一个面向攻击性操作的发行版，常被渗透测试人员用于执行网络评估。Red Hat Linux可能是最常用的企业级发行版，Fedora和CentOS等其他发行版也基于Red
    Hat。如果你对Linux感兴趣，可以尝试不同的发行版，找到最适合自己的那个。
- en: 'In this book, we’ll primarily use Ubuntu, which is one of the most user-friendly
    and among the easiest to use for beginners or those new to Linux in general. Ubuntu
    is available in three editions: Desktop, Server, and Core. For our purposes, the
    Desktop edition is sufficient. If you plan to use your Ubuntu servers for additional
    network services, such as a file or Dynamic Host Control Protocol (DHCP) server,
    the Server edition would be appropriate. Ubuntu Core is specifically for resource-limited
    applications, like internet of things (IoT) implementations.'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 本书主要使用Ubuntu，它是最具用户友好性的Linux发行版之一，也是初学者或对Linux不熟悉的人最容易上手的操作系统。Ubuntu有三个版本：桌面版、服务器版和核心版。对于我们的目的，桌面版就足够了。如果你打算将Ubuntu服务器用于额外的网络服务，如文件服务器或动态主机配置协议（DHCP）服务器，那么服务器版会更合适。Ubuntu核心版专为资源受限的应用而设计，例如物联网（IoT）实现。
- en: The most recent versions of the Ubuntu operating system are available from [https://ubuntu.com/download/](https://ubuntu.com/download/).
    These downloads will be in ISO file format, meaning the file extension will be
    *.iso*. ISO files are logical images or containers that can be used to emulate
    physical media such as CDs or DVDs.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 最新版本的Ubuntu操作系统可以从[https://ubuntu.com/download/](https://ubuntu.com/download/)下载。这些下载文件将是ISO文件格式，意味着文件扩展名为*.iso*。ISO文件是逻辑镜像或容器，可以用来模拟物理媒体，如CD或DVD。
- en: The following sections walk through installing Ubuntu, either as a physical
    device or as a virtual machine on either macOS or Windows, as well as in the cloud.
    Using a physical device allows you to take advantage of all of a system’s resources,
    such as CPU and RAM, but it requires that you have a physical system available
    onto which you can install Ubuntu. Using virtual machines provides several useful
    features, like the ability to take snapshots (this will be discussed later in
    this chapter). Creating a virtual machine in the cloud provides additional capabilities,
    like easy access to your system from any location, but often comes with additional
    security considerations. Once you’re finished with the platform-specific instructions
    for your setup, jump to “[Finalizing the Linux Installation](nsp-enoka501485-0010.xhtml#ah0302)”
    on [page 8](nsp-enoka501485-0010.xhtml#p8).
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 以下部分讲解了如何在 macOS 或 Windows 上安装 Ubuntu，无论是作为物理设备还是虚拟机，以及如何在云中安装。使用物理设备可以充分利用系统的所有资源，如
    CPU 和 RAM，但需要你有一个可以安装 Ubuntu 的物理系统。使用虚拟机提供了几个有用的功能，比如可以创建快照（稍后会在本章讨论）。在云中创建虚拟机提供了额外的能力，如可以从任何地点轻松访问你的系统，但通常也带来了额外的安全性考虑。一旦你完成了针对你的平台特定的安装步骤，跳到
    “[完成 Linux 安装](nsp-enoka501485-0010.xhtml#ah0302)” [第8页](nsp-enoka501485-0010.xhtml#p8)。
- en: '[#1: Creating an Ubuntu Virtual Machine](nsp-enoka501485-0007.xhtml#rhd0301)'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '[#1：创建一个 Ubuntu 虚拟机](nsp-enoka501485-0007.xhtml#rhd0301)'
- en: Throughout this book, you’ll create Ubuntu systems for various purposes. Each
    of them will be based on the system we’ll create now, which will act as a standard
    base operating system, on top of which you can add tools and applications necessary
    for securing your network.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书中，你将为不同的目的创建 Ubuntu 系统。每个系统都将基于我们现在要创建的系统，这个系统将作为标准基础操作系统，你可以在其基础上添加用于保护网络的工具和应用程序。
- en: '[Hypervisor Options](nsp-enoka501485-0007.xhtml#rbh0301)'
  id: totrans-13
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[虚拟机监控器选项](nsp-enoka501485-0007.xhtml#rbh0301)'
- en: A *hypervisor* is software that allows you to create and run virtual machines
    using a guest operating system. For this initial project, you can create an Ubuntu
    VM using an inexpensive commercial hypervisor from VMware. Multiple editions of
    VMware Workstation are available from [https://www.vmware.com/](https://www.vmware.com/).
    VMware Player (for Windows) and VMware Fusion Player (for Mac) are free for personal
    use, but they don’t have some of the more advanced features we’ll want to take
    advantage of in later chapters. I recommend using VMware Workstation Pro and VMware
    Fusion Pro. The commercial license for either of these is relatively inexpensive.
    An alternative solution is to use the free Workstation Player to begin with and
    then upgrade to the commercial license if you need to. The step-by-step instructions
    for Workstation and Player editions are mostly the same, with some slight differences
    between Workstation and Fusion.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '*虚拟机监控器* 是一种软件，允许你创建并运行虚拟机，通过使用来宾操作系统。在这个初始项目中，你可以使用 VMware 的一款廉价商业虚拟机监控器来创建
    Ubuntu 虚拟机。VMware Workstation 有多个版本，可以从 [https://www.vmware.com/](https://www.vmware.com/)
    获取。VMware Player（适用于 Windows）和 VMware Fusion Player（适用于 Mac）对于个人使用是免费的，但它们没有一些我们将在后续章节中使用的高级功能。我推荐使用
    VMware Workstation Pro 和 VMware Fusion Pro。这两款的商业许可证相对较便宜。另一种解决方案是先使用免费的 Workstation
    Player，如果需要，可以升级到商业许可证。Workstation 和 Player 版本的大多数安装步骤是相同的，只有 Workstation 和 Fusion
    之间有些许差异。'
- en: Another option is to use VirtualBox, a free solution for creating and managing
    VMs maintained by Oracle. VirtualBox is available for all major operating systems,
    and you can download it from [https://www.virtualbox.org/wiki/Downloads/](https://www.virtualbox.org/wiki/Downloads/).
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个选择是使用 VirtualBox，这是 Oracle 维护的一个免费的虚拟机创建和管理解决方案。VirtualBox 适用于所有主要操作系统，你可以从
    [https://www.virtualbox.org/wiki/Downloads/](https://www.virtualbox.org/wiki/Downloads/)
    下载它。
- en: '[VMware Workstation and VMware Player for Windows](nsp-enoka501485-0007.xhtml#rbh0302)'
  id: totrans-16
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[适用于 Windows 的 VMware Workstation 和 VMware Player](nsp-enoka501485-0007.xhtml#rbh0302)'
- en: 'To create your VM in VMware Workstation or VMware Player, follow these steps:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在 VMware Workstation 或 VMware Player 中创建虚拟机，请按以下步骤操作：
- en: 1\. Click **File▸New Virtual Machine** in VMware.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1. 在 VMware 中点击 **文件▸新建虚拟机**。
- en: 2\. On the New Virtual Machine screen that opens, choose **Typical (recommended)**
    and click **Next**.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2. 在打开的新虚拟机界面上，选择 **典型（推荐）** 并点击 **下一步**。
- en: 3\. Select **Installer Disc Image File (iso)**.
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3. 选择 **安装光盘映像文件 (iso)**。
- en: 4\. Using the **Browse** button, navigate to and select the Ubuntu ISO you downloaded
    earlier; then click **Next**.
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4. 使用 **浏览** 按钮，导航到并选择你之前下载的 Ubuntu ISO 文件，然后点击 **下一步**。
- en: 5\. The Easy Install wizard will ask for the user details for your VM; fill
    out the Full Name, User Name, and Password fields, and click **Next**.
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 5\. 易安装向导会要求提供虚拟机的用户详情；填写全名、用户名和密码字段，然后点击**下一步**。
- en: 6\. Give your VM a meaningful name indicating its role on your network when
    asked.
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 6\. 在提示时为虚拟机提供一个有意义的名称，表示其在网络中的角色。
- en: 7\. Save the VM to the default location (or anywhere you desire) and click **Next**.
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 7\. 将虚拟机保存到默认位置（或你想要的位置），然后点击**下一步**。
- en: 8\. Set the virtual disk size to 40GB if your host machine has enough disk space;
    otherwise, accept the default 20GB.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 8\. 如果主机有足够的磁盘空间，将虚拟磁盘大小设置为40GB；否则，接受默认的20GB。
- en: 9\. Store the virtual disk as a single file, rather than split into multiple
    files and click **Next**.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 9\. 将虚拟磁盘存储为单个文件，而不是分成多个文件，然后点击**下一步**。
- en: 10\. Click **Customize Hardware**.
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 10\. 点击**自定义硬件**。
- en: 11\. If your host has enough RAM, increase the RAM of the VM from 2GB to 4GB.
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 11\. 如果主机有足够的内存，将虚拟机的内存从2GB增加到4GB。
- en: 12\. Set Processors to 1.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 12\. 将处理器设置为1。
- en: 13\. Under Network Adapter, select **Bridged** mode to give your VM its own
    independent IP address and network connection.
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 13\. 在网络适配器下，选择**桥接**模式，为你的虚拟机分配独立的IP地址和网络连接。
- en: 14\. Click **Sound Card▸Remove**.
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 14\. 点击**声卡▸移除**。
- en: 15\. Click **Printer▸Remove**.
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 15\. 点击**打印机▸移除**。
- en: 16\. Click **Finish**.
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 16\. 点击**完成**。
- en: Your virtual machine will be created, and the operating system will begin installing.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 虚拟机将被创建，操作系统将开始安装。
- en: '[VMware Fusion and VMware Fusion Player for macOS](nsp-enoka501485-0007.xhtml#rbh0303)'
  id: totrans-35
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[VMware Fusion 和 VMware Fusion Player for macOS](nsp-enoka501485-0007.xhtml#rbh0303)'
- en: 'Once you’ve installed VMware Fusion or VMware Fusion Player, follow these steps
    to create your first VM:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完VMware Fusion或VMware Fusion Player后，按照以下步骤创建你的第一个虚拟机：
- en: 1\. Click **File▸New▸Continue** in VMware.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1\. 在VMware中点击**文件▸新建▸继续**。
- en: 2\. Drag and drop your ISO file onto the VMware Fusion window, or click the
    **Use Another Disc or Disc Image** button to locate the file in your filesystem;
    then click **Continue**.
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2\. 将你的ISO文件拖放到VMware Fusion窗口，或点击**使用另一个磁盘或磁盘映像**按钮在文件系统中定位文件；然后点击**继续**。
- en: 3\. The Easy Install wizard will ask you for the user details for your VM; fill
    out the Display Name, Account Name, and Password fields.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3\. 易安装向导会要求提供虚拟机的用户详情；填写显示名称、账户名称和密码字段。
- en: 4\. Ensure the Make your home folder accessible to the virtual machine checkbox
    is not ticked and click **Continue**.
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4\. 确保“使你的主文件夹对虚拟机可访问”复选框未勾选，然后点击**继续**。
- en: 5\. Click **Customize Settings**.
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 5\. 点击**自定义设置**。
- en: 6\. Save the VM to the default location (or anywhere you desire).
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 6\. 将虚拟机保存到默认位置（或你想要的位置）。
- en: 7\. Set the virtual disk size to 40GB if your host machine has enough disk space;
    otherwise, accept the default 20GB.
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 7\. 如果主机有足够的磁盘空间，将虚拟磁盘大小设置为40GB；否则，接受默认的20GB。
- en: 8\. In the **Processors and Memory** menu, if your host has enough RAM, increase
    the RAM of the VM from 2GB to 4GB, and set Processors to 1.
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 8\. 在**处理器和内存**菜单中，如果主机有足够的内存，将虚拟机的内存从2GB增加到4GB，并将处理器设置为1。
- en: '9\. Untick the **Connect** checkbox to either add or disconnect the following
    peripherals within their context menus: sound card, floppy, printer, and camera.
    (Disconnecting unused or superfluous peripherals from your virtual machines removes
    potential attack vectors.)'
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 9\. 取消勾选**连接**复选框，以在其上下文菜单中添加或断开以下外设：声卡、软盘、打印机和相机。（从虚拟机中断开未使用或多余的外设可以减少潜在的攻击面。）
- en: Click the **Play** button to start your VM, and the operating system installation
    will begin.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**播放**按钮启动虚拟机，操作系统安装将开始。
- en: '[VirtualBox](nsp-enoka501485-0007.xhtml#rbh0304)'
  id: totrans-47
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[VirtualBox](nsp-enoka501485-0007.xhtml#rbh0304)'
- en: 'The steps for creating a VM in VirtualBox are the same whether you’re using
    a Windows PC or Mac as the host system. Once you’ve downloaded and installed VirtualBox,
    follow these steps to create a VM:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在VirtualBox中创建虚拟机的步骤与使用Windows PC或Mac作为主机系统无关。下载并安装VirtualBox后，按照以下步骤创建虚拟机：
- en: 1\. Click the **New** button at the top of the VirtualBox window.
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1\. 点击VirtualBox窗口顶部的**新建**按钮。
- en: '2\. Provide a relevant name for your VM, specify the location to save the files
    (the default folder is usually fine), and select the correct operating system
    from the drop-down menus: **Linux▸Ubuntu (64-bit)**; then click **Continue**.'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2\. 为你的虚拟机提供一个相关的名称，指定保存文件的位置（默认文件夹通常可以），并从下拉菜单中选择正确的操作系统：**Linux▸Ubuntu（64位）**；然后点击**继续**。
- en: 3\. If your host has enough RAM, increase the RAM of the VM from 2GB to 4GB,
    and click **Continue**.
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你的主机有足够的内存，将虚拟机的内存从2GB增加到4GB，并点击**继续**。
- en: 4\. Select **Create a New Virtual Hard Disk Now** and then click **Create**.
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**现在创建一个新的虚拟硬盘**，然后点击**创建**。
- en: 5\. Select **VMDK** as the hard disk format and click **Continue**.
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**VMDK**作为硬盘格式并点击**继续**。
- en: 6\. Select **Dynamically Allocated** and click **Continue** or **Next** (depending
    on your OS).
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**动态分配**并点击**继续**或**下一步**（取决于你的操作系统）。
- en: 7\. Set the virtual disk size to 40GB if your host machine has enough disk space;
    otherwise, accept the default 32GB and click **Create**.
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果主机有足够的磁盘空间，请将虚拟磁盘大小设置为40GB；否则，接受默认的32GB并点击**创建**。
- en: 8\. Select the VM in VirtualBox and click **Settings**.
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择虚拟机并点击**设置**。
- en: 9\. Go to **Settings▸System▸Motherboard**.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往**设置▸系统▸主板**。
- en: 10\. Under Boot Order, untick the **Floppy** checkbox.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在启动顺序中，取消勾选**软盘**复选框。
- en: 11\. Go to **Settings▸System▸Storage**.
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往**设置▸系统▸存储**。
- en: '12\. Select the CD drive (it’ll be listed as **Controller: IDE** and have a
    CD icon next to it).'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择CD驱动器（它将显示为**控制器：IDE**，并且旁边会有一个CD图标）。
- en: 13\. In the attributes pane, click the **CD icon** to choose a disk file, and
    point it at your Ubuntu ISO file.
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在属性面板中，点击**CD图标**以选择一个磁盘文件，并指向你的Ubuntu ISO文件。
- en: 14\. Under **Settings▸Audio**, untick the **Enable Audio** checkbox.
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**设置▸音频**下，取消勾选**启用音频**复选框。
- en: 15\. Under **Settings▸Network▸Adapter 1**, switch the **Attached to** drop-down
    to **Bridged Adapter** so your VM will be assigned its own IP address and be logically
    separate from the host system’s network settings.
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**设置▸网络▸适配器1**下，将**附加到**下拉菜单切换为**桥接适配器**，这样虚拟机会被分配自己的IP地址，并且在逻辑上与主机系统的网络设置分开。
- en: 16\. Click **OK**.
  id: totrans-64
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**确定**。
- en: Note The options for hard disk format are VDI, VHD, or VMDK. VDI is VirtualBox’s
    proprietary format. VHD was developed by Microsoft, is compatible with Windows,
    and can be easily mounted under the Windows operating system as a virtual disk.
    VMware originally developed VMDK, but it’s now an open file format. VMDK is compatible
    with both VirtualBox and VMware, so if you choose to switch from one to the other,
    your virtual hard disks shouldn’t cause any challenges.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：硬盘格式选项有VDI、VHD或VMDK。VDI是VirtualBox的专有格式。VHD由微软开发，兼容Windows，并且可以在Windows操作系统下轻松挂载为虚拟磁盘。VMDK最初由VMware开发，但现在是一个开放的文件格式。VMDK兼容VirtualBox和VMware，因此，如果你选择从一个平台切换到另一个平台，你的虚拟硬盘不会遇到问题。
- en: '[#2: Creating a Physical Linux System](nsp-enoka501485-0007.xhtml#rhd0302)'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '[#2：创建物理Linux系统](nsp-enoka501485-0007.xhtml#rhd0302)'
- en: Instead of creating a virtual machine, you might want to use a physical computer
    and install Ubuntu the same way you’d install Windows or macOS directly onto the
    hardware. Using a physical system has benefits like increased performance or reduced
    resource requirements in terms of memory and processing power. The main drawback
    is that physical systems usually aren’t as flexible as virtual machines. As you
    progress through this book, you’ll be asked to create multiple Linux systems,
    so we’ll assume that you’ll use mostly virtual machines. However, should you choose
    to use physical systems for each of these projects, you should still be able to
    follow along.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你不想创建虚拟机，也可以选择使用物理计算机，像安装Windows或macOS一样直接在硬件上安装Ubuntu。使用物理系统有诸如提升性能或减少内存和处理能力要求等优势。主要的缺点是物理系统通常不像虚拟机那样灵活。在你本书的后续章节中，会要求你创建多个Linux系统，因此我们假设你主要使用虚拟机。然而，如果你决定为每个项目使用物理系统，依然可以跟随教程进行操作。
- en: To create a physical Ubuntu system, you need a *bootable USB drive*, which means
    you’ll install Ubuntu on a USB that you can plug into any computer and install
    it from there.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建一个物理Ubuntu系统，你需要一个*可启动USB驱动器*，这意味着你会将Ubuntu安装到一个USB驱动器上，可以插入任何计算机并从那里进行安装。
- en: '[Bootable USB on Windows](nsp-enoka501485-0007.xhtml#rbh0305)'
  id: totrans-69
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[Windows上的可启动USB](nsp-enoka501485-0007.xhtml#rbh0305)'
- en: 'On a Windows computer, the simplest way to create a bootable Ubuntu USB is
    with Rufus, a small utility specifically for creating bootable media. Download
    the latest version from [https://rufus.ie/](https://rufus.ie/). Rufus is a *portable
    executable*, which means you don’t need to install it; just download and run it.
    Once downloaded, follow these steps:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 在Windows计算机上，创建可启动Ubuntu USB的最简单方法是使用Rufus，这是一款专门用于创建可启动媒体的小型工具。请从[https://rufus.ie/](https://rufus.ie/)下载最新版本。Rufus是一个*便携式可执行文件*，这意味着你无需安装它，只需下载并运行即可。下载后，按照以下步骤操作：
- en: 1\. Plug in a USB thumb drive at least 16GB in size. Rufus will format this
    USB drive, so make sure it doesn’t contain anything you want to keep.
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1\. 插入一个至少 16GB 的 USB 闪存驱动器。Rufus 将格式化此 USB 驱动器，请确保其中没有任何你想保留的内容。
- en: 2\. Run the Rufus executable.
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2\. 运行 Rufus 可执行文件。
- en: 3\. Once Rufus is open, ensure the Device drop-down menu indicates that the
    correct USB drive is selected. It’s often easiest to plug in only your target
    USB device and unplug any others.
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3\. 一旦 Rufus 打开，确保设备下拉菜单显示已选择正确的 USB 驱动器。通常最简单的方法是只插入目标 USB 设备，并拔掉其他设备。
- en: 4\. Under Boot Selection, choose **Disk or ISO Image**.
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4\. 在启动选择中，选择 **磁盘或 ISO 镜像**。
- en: 5\. Click **Select**.
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 5\. 点击 **选择**。
- en: 6\. Navigate to your Ubuntu ISO file and select it.
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 6\. 找到并选择你的 Ubuntu ISO 文件。
- en: 7\. Once selected, Rufus will load a set of default settings for the bootable
    USB; accept them and click **Start**.
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 7\. 选择后，Rufus 会加载一组启动 USB 的默认设置；接受它们并点击 **开始**。
- en: 8\. Rufus might display a pop-up asking whether you want to write the media
    in ISO or DD image mode; choose **ISO Mode** and click **OK**. When installing
    Ubuntu later, if you aren’t able to proceed with the installation or it seems
    to hang, repeat this process and select **DD Mode** instead.
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 8\. Rufus 可能会显示一个弹窗，询问你是否希望以 ISO 或 DD 镜像模式写入媒体；选择 **ISO 模式** 并点击 **确定**。在稍后的
    Ubuntu 安装过程中，如果无法继续安装或似乎卡住，重复此过程并选择 **DD 模式**。
- en: 9\. Rufus will display a pop-up to inform you that it will format the USB drive;
    click **OK** to proceed.
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 9\. Rufus 会显示一个弹窗，通知你它将格式化 USB 驱动器；点击 **确定** 以继续。
- en: '[Bootable USB on macOS](nsp-enoka501485-0007.xhtml#rbh0306)'
  id: totrans-80
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[在 macOS 上创建启动 USB](nsp-enoka501485-0007.xhtml#rbh0306)'
- en: '*Etcher* is an open source utility for macOS used for writing operating system
    images to removable media such as USB drives and SD cards. Download the latest
    version from [https://www.balena.io/etcher/](https://www.balena.io/etcher/). Once
    it’s downloaded and installed, follow these steps:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: '*Etcher* 是一个开源工具，用于在 macOS 上将操作系统镜像写入可移动媒体，例如 USB 驱动器和 SD 卡。从 [https://www.balena.io/etcher/](https://www.balena.io/etcher/)
    下载最新版本。下载并安装后，请按照以下步骤操作：'
- en: 1\. Plug in a USB thumb drive at least 16GB in size. Etcher will format your
    USB drive, so make sure it doesn’t contain anything you want to keep.
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1\. 插入一个至少 16GB 的 USB 闪存驱动器。Etcher 将格式化你的 USB 驱动器，请确保其中没有任何你想保留的内容。
- en: 2\. Run Etcher.
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2\. 运行 Etcher。
- en: 3\. Once Etcher is open, click **Flash from File**, and select your Ubuntu ISO file.
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3\. 一旦 Etcher 打开，点击 **从文件闪存**，并选择你的 Ubuntu ISO 文件。
- en: 4\. Click **Select Target** and select your USB drive.
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4\. 点击 **选择目标** 并选择你的 USB 驱动器。
- en: 5\. Click **Flash** to create your bootable Ubuntu USB (you might be asked to
    enter your computer password to allow Etcher to make changes to the USB).
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 5\. 点击 **闪存** 创建你的启动 Ubuntu USB（你可能会被要求输入计算机密码，以允许 Etcher 对 USB 进行更改）。
- en: 6\. The flashing process will begin, and a progress bar will appear. Once the
    process completes, you may be informed that “The disk you inserted was not readable
    by this computer.” If so, just eject the USB; don’t choose Initialize.
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 6\. 闪存过程将开始，并会出现进度条。过程完成后，系统可能会提示“你插入的磁盘无法被此计算机读取。”如果是这样，只需弹出 USB 驱动器；不要选择初始化。
- en: '[Using the Bootable USB](nsp-enoka501485-0007.xhtml#rbh0307)'
  id: totrans-88
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[使用启动 USB](nsp-enoka501485-0007.xhtml#rbh0307)'
- en: When the process completes, you’ll have a bootable Ubuntu Linux USB drive. Plug
    it into the computer on which you want to install Ubuntu and boot or reboot it.
    You might have to change the system’s boot order so it boots from the USB instead
    of the internal hard drive. To do that, you need to interrupt the boot sequence,
    which is typically done by pressing ESC, F8, F10, or F12\. Do an internet search
    to find the correct interrupt key for your computer, or reboot the system and
    press each of those keys until you successfully enter the computer’s basic input/output
    system (BIOS).
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 过程完成后，你将拥有一个可启动的 Ubuntu Linux USB 驱动器。将其插入你希望安装 Ubuntu 的计算机，并启动或重启计算机。你可能需要更改系统的启动顺序，以便它从
    USB 启动，而不是从内置硬盘启动。为此，你需要中断启动顺序，通常通过按 ESC、F8、F10 或 F12 来完成。请在网上搜索查找适合你计算机的中断键，或者重新启动系统并按下这些键，直到成功进入计算机的基本输入输出系统（BIOS）。
- en: Note Technically, most modern computers use the Unified Extensible Firmware
    Interface (UEFI), which has improved features over the outdated BIOS. We’ll use
    the terms BIOS and UEFI interchangeably.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：从技术上讲，大多数现代计算机使用统一可扩展固件接口（UEFI），它相比过时的 BIOS 拥有更强大的功能。我们将在文中交替使用 BIOS 和 UEFI
    两个术语。
- en: From the BIOS, which is responsible for hardware management outside your operating
    system, change the boot order so that the computer boots from the USB first. Then
    restart the computer, and it will boot into the Ubuntu installation environment.
    On a Mac, just hold the OPTION key while the system boots and then choose to boot
    from USB.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 在 BIOS 中，负责操作系统外的硬件管理，改变启动顺序，使计算机首先从 USB 启动。然后重启计算机，它将进入 Ubuntu 安装环境。在 Mac 上，只需在系统启动时按住
    OPTION 键，然后选择从 USB 启动。
- en: '[#3: Creating a Cloud-Based Linux System](nsp-enoka501485-0007.xhtml#rhd0303)'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '[#3：创建基于云的 Linux 系统](nsp-enoka501485-0007.xhtml#rhd0303)'
- en: It’s common to move network infrastructure to the cloud, which just means running
    our services on someone else’s computer(s). Websites and the web servers that
    run them are often easier to access (from anywhere in the world) and manage in
    the cloud than they would be on our private networks and VPN servers. (We’ll cover
    VPNs in greater detail in [Chapter 5](nsp-enoka501485-0014.xhtml#ch05).) In this
    section, we’ll explain how to create your Linux computer using a cloud service
    provider. We’ll use Vultr for this project as it’s relatively inexpensive, it’s
    reliable, and it presents an easy learning curve if you haven’t used a cloud provider
    before. The steps should be similar regardless of provider, whether you’re using
    Amazon Web Services, Microsoft Azure, or something else.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 将网络基础设施迁移到云端是很常见的，这意味着我们的服务运行在别人的计算机上。网站和运行它们的网络服务器在云端通常比在我们的私有网络和 VPN 服务器上更容易访问（从全球任何地方）和管理。（我们将在[第5章](nsp-enoka501485-0014.xhtml#ch05)详细讨论
    VPN。）在本节中，我们将解释如何使用云服务提供商创建 Linux 计算机。我们将使用 Vultr 进行此项目，因为它相对便宜，可靠，并且如果您之前没有使用过云服务提供商，它提供了一个简单的学习曲线。无论使用哪个服务提供商，步骤应该是相似的，无论是使用
    Amazon Web Services、Microsoft Azure 还是其他服务。
- en: 1\. Create an account at [https://www.vultr.com/](https://www.vultr.com/).
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1\. 在[https://www.vultr.com/](https://www.vultr.com/)创建一个帐户。
- en: 2\. On the account dashboard, click **+▸Deploy New Server**.
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2\. 在帐户仪表板上，点击**+▸部署新服务器**。
- en: 3\. Choose **Cloud Compute**. The other options (High Frequency, Bare Metal,
    and so on) are for specialist applications, not suitable for our purposes.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3\. 选择**云计算**。其他选项（高频、裸金属等）适用于专业应用，与你的目的不符。
- en: 4\. Choose a location for your server. Choosing a location geographically close
    to you can improve access speeds to your VM; however, if you want to obfuscate
    your location, choose a location in a different country.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4\. 选择服务器的位置。选择离您地理位置较近的服务器位置可以提高虚拟机的访问速度；但是，如果您想隐藏自己的位置，可以选择其他国家的服务器位置。
- en: 5\. For Server Type, choose the latest available version of Ubuntu.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 5\. 对于服务器类型，选择最新版本的 Ubuntu。
- en: 6\. Choose a server size. The cheapest option is a good place to start; you
    can always upgrade your VM later if necessary.
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 6\. 选择服务器大小。最便宜的选项是一个不错的起点；如果需要，您可以稍后升级您的虚拟机。
- en: 7\. Supply a hostname for your server.
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 7\. 为您的服务器提供一个主机名。
- en: 8\. Click **Deploy**.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 8\. 点击**部署**。
- en: The service provider will now instantiate your Ubuntu VM, which is the same
    as creating a VM in VMware or VirtualBox. This process can take some time. Once
    your VM is confirmed to be up and running, your service provider will supply the
    IP address, username, and password to access your VM. You’ll then be able to complete
    the steps in the following sections to set up and secure your VM.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 服务提供商现在将启动您的 Ubuntu 虚拟机，这与在 VMware 或 VirtualBox 中创建虚拟机相同。这个过程可能需要一些时间。一旦确认虚拟机已启动并运行，您的服务提供商将提供
    IP 地址、用户名和密码以访问虚拟机。然后，您可以按照以下各节中的步骤来设置和保护虚拟机。
- en: '[Finalizing the Linux Installation](nsp-enoka501485-0007.xhtml#rah0302)'
  id: totrans-103
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '[完成 Linux 安装](nsp-enoka501485-0007.xhtml#rah0302)'
- en: If you created your Linux system in the cloud or using VMware and Easy Install,
    booting the VM will automatically install Ubuntu, create your user account, and
    present you with the Ubuntu desktop environment, which will be similar to a Windows
    or Mac desktop. If you used VirtualBox or are creating a physical Linux system,
    you’ll need to complete some additional steps to get to that stage.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您在云端或使用 VMware 和 Easy Install 创建了 Linux 系统，启动虚拟机会自动安装 Ubuntu，创建您的用户帐户，并展示
    Ubuntu 桌面环境，类似于 Windows 或 Mac 桌面。如果您使用了 VirtualBox 或正在创建物理 Linux 系统，您需要完成一些额外的步骤才能达到该阶段。
- en: 'In VirtualBox, follow these steps:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在 VirtualBox 中，按照以下步骤操作：
- en: 1\. Click the **Start** button to boot the VM.
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1\. 点击**开始**按钮以启动虚拟机。
- en: 2\. Using the Ubuntu installation wizard, select your desired language and click
    **Install Ubuntu**.
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2\. 使用 Ubuntu 安装向导，选择您希望的语言并点击**安装 Ubuntu**。
- en: 3\. Select your keyboard layout and click **Continue**.
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3\. 选择你的键盘布局并点击**继续**。
- en: 4\. On the Updates and Software screen, select **Minimal Installation** as you
    won’t need a lot of the additional software that would otherwise be installed
    with the operating system.
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4\. 在“更新和软件”屏幕上，选择**最小安装**，因为你不需要与操作系统一起安装的大部分附加软件。
- en: 5\. Tick both checkboxes to allow software updates to be installed from various
    sources.
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 5\. 勾选两个复选框，以允许从各种来源安装软件更新。
- en: 6\. Click **Continue**.
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 6\. 点击**继续**。
- en: 7\. On the next screen, the wizard will ask if you want to erase the disk and
    install Ubuntu, with a warning, as shown in [Figure 1-1](nsp-enoka501485-0010.xhtml#fig0101).
    Click the **Advanced Features** button and select **Use LVM with the New Ubuntu
    Installation**. Using LVM provides greater flexibility and control over your disks
    and their partitioning. LVM allows for advanced features such as naming logical
    volumes and dynamically resizing partitions and virtual hard disks when required.
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 7\. 在下一屏幕上，向导会询问你是否要擦除磁盘并安装Ubuntu，并显示警告，如[图1-1](nsp-enoka501485-0010.xhtml#fig0101)所示。点击**高级功能**按钮并选择**使用LVM进行新Ubuntu安装**。使用LVM可以提供更大的灵活性和对磁盘及其分区的控制。LVM允许进行诸如命名逻辑卷以及在需要时动态调整分区和虚拟硬盘大小等高级功能。
- en: '![Ubuntu’s wizard displays the following warning when asking if you’d like
    to erase the disk and install Ubuntu: “Warning: This will delete all your programs,
    documents, photos, music, and any other files in all operating systems.” The clickable
    Advanced features button appears underneath this warning.](images/nsp-enoka501485-fig0101.jpg)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![Ubuntu的向导在询问是否希望擦除磁盘并安装Ubuntu时，会显示如下警告：“警告：这将删除你所有的程序、文档、照片、音乐以及所有操作系统中的其他文件。”在此警告下方显示了可点击的“高级功能”按钮。](images/nsp-enoka501485-fig0101.jpg)'
- en: 'Figure 1-1: Ubuntu installation type prompt'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 图1-1：Ubuntu安装类型提示
- en: Keep in mind that this installation wizard is referring only to the virtual
    machine and the virtual hard disk that is attached to it (which we created earlier).
    It does not affect the physical hard drive of your host system. There is no risk
    of losing your files or data by proceeding with the installation inside the VM.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，这个安装向导仅仅是针对虚拟机及其附加的虚拟硬盘（我们之前创建的）。它不会影响主机系统的物理硬盘。继续在虚拟机中进行安装不会导致文件或数据丢失。
- en: 8\. Click **OK▸Install Now**.
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 8\. 点击**确定▸立即安装**。
- en: 9\. You’ll be asked to write the changes to disk (meaning the virtual hard disk
    of the VM). Click **Continue** to accept the configuration you just set for this
    VM.
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 9\. 系统会提示你将更改写入磁盘（即虚拟机的虚拟硬盘）。点击**继续**以接受你刚刚为这个虚拟机设置的配置。
- en: As Ubuntu installs, you’ll be asked for certain settings for the operating system,
    such as your location (for time zone settings), your name, your computer or hostname,
    and your user details such as username and password. Set those as appropriate
    and continue the installation. Eventually, the operating system installation will
    complete, and you’ll be presented with the Ubuntu desktop environment.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 在Ubuntu安装过程中，系统会要求你设置操作系统的某些设置，如你的位置（时区设置）、你的姓名、计算机名称或主机名，以及你的用户名和密码等用户信息。根据需要设置这些内容，然后继续安装。最终，操作系统安装将完成，系统会展示Ubuntu桌面环境。
- en: Warning Do not set or allow the user to log in automatically, as that configuration
    isn’t secure for any computer. Always use the **Require my Password to Log in**
    setting.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：不要设置或允许用户自动登录，因为这种配置对任何计算机来说都不安全。始终使用**登录时需要我的密码**的设置。
- en: The first time you log in, Ubuntu will ask you to configure online accounts
    and whether you want to share anonymous statistics with the developer. This system
    needs to be a secure system and therefore shouldn’t be connected to services such
    as Google or Microsoft cloud services. Skip all of those configuration options
    and disallow sharing of data wherever possible. This advice is good for life (if
    you’re concerned about privacy), not just the configuration of Ubuntu virtual
    machines.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 首次登录时，Ubuntu会要求你配置在线帐户，并询问你是否愿意与开发人员共享匿名统计数据。该系统需要保持安全，因此不应连接到Google或Microsoft等云服务。跳过所有这些配置选项，并尽可能禁止共享数据。这些建议不仅适用于Ubuntu虚拟机的配置，也适用于生活中的隐私保护。
- en: You’ll follow the same steps to complete Ubuntu installation on a physical system,
    the only difference being the disk partitioning will affect the physical hard
    drive within the computer, and not a virtual hard drive. Once you’ve installed
    Ubuntu, reset the boot order in the BIOS as you did before so the computer boots
    from the internal hard drive instead of USB, and also remove the bootable USB
    from the computer.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 完成物理系统上的 Ubuntu 安装时，你将按照相同的步骤进行，唯一的区别是磁盘分区会影响计算机内部的物理硬盘，而不是虚拟硬盘。安装 Ubuntu 后，像之前一样在
    BIOS 中重置启动顺序，使计算机从内部硬盘启动，而不是 USB，同时也将可启动的 USB 移除。
- en: '[Hardening Your Ubuntu System](nsp-enoka501485-0007.xhtml#rah0303)'
  id: totrans-122
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '[加强你的 Ubuntu 系统](nsp-enoka501485-0007.xhtml#rah0303)'
- en: Now that you’ve created a base virtual or physical machine, you’ll make some
    initial configuration changes to ensure your system is secure. This process is
    called *hardening*, which broadly means keeping the system up-to-date with the
    latest operating system and software patches, installing some additional management
    software, and altering configuration files to make the system more secure.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经创建了一个基础的虚拟或物理机器，接下来你将进行一些初步的配置更改，以确保你的系统是安全的。这个过程称为*硬化*，通常是指保持系统与最新操作系统和软件补丁同步，安装一些额外的管理软件，并修改配置文件以增强系统安全性。
- en: '[#4: Installing System Packages](nsp-enoka501485-0007.xhtml#rhd0304)'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: '[#4: 安装系统软件包](nsp-enoka501485-0007.xhtml#rhd0304)'
- en: In Ubuntu, you’ll use the Advanced Package Tool (APT) to ensure the system is
    up-to-date with all of the latest patches. In Linux, people use the term *packages*
    to refer to software, and APT is a package management utility used to install,
    uninstall, update, or otherwise manage the tools and software on your system.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Ubuntu 中，你将使用高级包管理工具（APT）来确保系统与最新的补丁保持同步。在 Linux 中，人们使用*软件包*一词来指代软件，而 APT
    是一个包管理工具，用于安装、卸载、更新或以其他方式管理系统上的工具和软件。
- en: APT is a command line interface (CLI) utility, which means you’ll use the Linux
    Terminal to interact with it, rather than a GUI tool like Windows Update.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: APT 是一个命令行界面（CLI）工具，这意味着你将使用 Linux 终端与它交互，而不是像 Windows 更新那样的图形界面工具。
- en: Note Most operating systems have a CLI; Windows has Command Prompt and PowerShell,
    and macOS has its own Terminal. Essentially, a CLI is a more direct way to interact
    with the operating system using text commands. A CLI will look like a simple text
    editor with a prompt for your input. Command Prompt, Linux Terminal, and macOS
    Terminal are all black with white text by default. PowerShell is blue.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，大多数操作系统都有 CLI；Windows 有命令提示符和 PowerShell，macOS 有自己的终端。基本上，CLI 是通过文本命令与操作系统进行交互的更直接方式。CLI
    看起来像一个简单的文本编辑器，里面有一个等待你输入的提示符。命令提示符、Linux 终端和 macOS 终端默认都是黑色背景白色文字，而 PowerShell
    是蓝色的。
- en: In a cloud deployment, you might have access only to the Linux Terminal by default,
    with no access to a GUI. If that’s the case, you’ll be presented with a terminal
    window immediately upon logging in. Otherwise, to access the terminal in Ubuntu,
    click the **Activities** menu at the top-left side of the screen in Ubuntu, type
    **Terminal**, and click it when it appears, the same way you’d search for and
    open an application in the Windows Start menu.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在云部署中，默认情况下你可能只能访问 Linux 终端，而无法访问图形界面。如果是这种情况，你在登录后会直接看到终端窗口。否则，要在 Ubuntu 中访问终端，请点击屏幕左上角的**活动**菜单，输入**终端**，然后点击出现的终端图标，就像在
    Windows 开始菜单中搜索并打开应用程序一样。
- en: 'By default, even as an administrator, you can’t run certain commands or perform
    some actions on a Linux system because you don’t have the necessary permissions
    (called *privileges* in Linux). A lot of commands and actions are reserved for
    *superusers*, or the *root* user account in Linux. As a non-root (that is, a nonsuperuser)
    user in Linux, you need the `sudo` command, which stands for *superuser do*. For
    example, to use APT to update all the installed packages in your Ubuntu system,
    use the following commands, pressing ENTER after each command to execute them:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，即使是管理员，你也不能在 Linux 系统上运行某些命令或执行某些操作，因为你没有必要的权限（在 Linux 中称为*特权*）。许多命令和操作是为*超级用户*保留的，或称为
    Linux 中的*root* 用户账户。作为一个非 root 用户（即非超级用户）在 Linux 中，你需要使用 `sudo` 命令，`sudo` 代表*超级用户执行*。例如，要使用
    APT 更新 Ubuntu 系统中所有已安装的软件包，可以使用以下命令，在每个命令后按 ENTER 执行：
- en: '[PRE0]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The first command, `sudo apt update`, retrieves the list of available updates
    for each application currently installed. The second command, `sudo apt upgrade`,
    downloads and installs those updates. When prompted, enter your password; making
    you authenticate to run privileged commands is a `sudo` security feature. Every
    time you run a command with `sudo`, the action is logged in the */var/log/auth.log*
    file, so all administrative actions can be audited after the fact. When asked
    to continue installing packages, enter `Y` (for yes) and press ENTER.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个命令`sudo apt update`会获取当前安装的每个应用程序的可用更新列表。第二个命令`sudo apt upgrade`会下载并安装这些更新。系统提示时，输入密码；要求你验证身份以运行特权命令是`sudo`的安全特性。每次使用`sudo`运行命令时，该操作会被记录在*/var/log/auth.log*文件中，因此所有管理操作都可以在事后进行审计。当提示继续安装软件包时，输入`Y`（是）并按回车键。
- en: Warning On the command line in Linux and macOS, when your prompt displays a
    dollar sign (`$`), this means you’re currently in the context of (that is, operating
    as) a normal, non-administrative user. If your prompt displays a hash mark (`#`),
    you’re in the context of the root user and have full system access to make changes,
    move files, and delete files. Be careful if you’re operating in the context of
    root, as it’s easy to make mistakes and cause problems with your operating system.
    It’s always best to work primarily in the context of a normal user and use `sudo`
    when using the command line.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 警告 在Linux和macOS的命令行中，当提示符显示美元符号（`$`）时，这意味着你当前处于（即以）普通非管理员用户身份。如果提示符显示井号（`#`），则表示你处于root用户上下文中，具有完全的系统访问权限，可以进行更改、移动文件和删除文件。如果你以root身份操作，请小心，因为很容易犯错并导致操作系统出现问题。最好主要以普通用户身份工作，使用命令行时再使用`sudo`。
- en: 'When you install new packages, APT often also installs any dependencies required
    for those packages (otherwise, your software would look for things it depends
    on, not find them, and fail to run successfully). However, when you remove or
    uninstall software, those dependencies might be left behind. Having unnecessary
    applications on your systems is insecure, as an attacker might exploit a vulnerability
    in those leftover packages to gain access to your network or use them to perform
    other nefarious activities. Run `sudo apt autoremove` and `sudo apt clean` as
    shown here to remove any no longer needed dependencies and delete previously downloaded
    packages, respectively:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 当你安装新软件包时，APT通常也会安装这些软件包所需的任何依赖项（否则，软件会找不到依赖项，导致无法正常运行）。但是，当你卸载软件时，这些依赖项可能会被遗留下来。系统中残留不必要的应用程序是不安全的，因为攻击者可能会利用这些残留的软件包中的漏洞来访问你的网络或执行其他恶意活动。运行`sudo
    apt autoremove`和`sudo apt clean`，如下面所示，分别用来移除不再需要的依赖项和删除以前下载的软件包：
- en: '[PRE1]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: To install new packages, use `sudo apt install`. A useful package that allows
    you to access and administer your system remotely via the command line is SSH
    (for *secure shell*). Run `sudo apt install openssh-server` to install SSH (to
    install a different package, you would substitute `openssh-server` for the package
    name).
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装新的软件包，请使用`sudo apt install`。一个有用的软件包是SSH（*安全外壳*），它允许你通过命令行远程访问和管理系统。运行`sudo
    apt install openssh-server`来安装SSH（如果安装其他软件包，只需将`openssh-server`替换为相应的软件包名称）。
- en: 'You can install multiple packages with `apt` at the same time like this:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以像这样使用`apt`同时安装多个软件包：
- en: '[PRE2]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Again, type your password and enter `Y` if prompted. With SSH installed, you’ll
    be able to configure remote access to your system.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 再次输入密码，如果提示，输入`Y`确认。安装完SSH后，你将能够配置远程访问系统。
- en: '[#5: Managing Linux Users](nsp-enoka501485-0007.xhtml#rhd0305)'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: '[#5: 管理Linux用户](nsp-enoka501485-0007.xhtml#rhd0305)'
- en: 'Part of managing your network security is managing the user accounts and hosts
    within your network. You may need to add new users to your Ubuntu machines, such
    as a new user account for a new service or application, or to allow others to
    administer your systems. Adding new users is an administrative function and requires
    the `sudo` command. Use the `adduser` command to add new users:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 网络安全管理的一部分是管理网络中的用户帐户和主机。你可能需要在Ubuntu机器上添加新用户，例如为新服务或应用程序创建新的用户帐户，或者允许他人管理你的系统。添加新用户是一个管理操作，需要使用`sudo`命令。使用`adduser`命令来添加新用户：
- en: '[PRE3]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: You’ll be asked to specify a password for the user, but using passphrases is
    better, because they’re easier to remember, tend to be longer, and are harder
    to crack. (We’ll discuss passphrases and creating strong passwords in more detail
    in [Chapter 11](nsp-enoka501485-0020.xhtml#ch11).)
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 系统会要求你为该用户指定一个密码，但使用密码短语更好，因为密码短语更容易记住，通常较长，且更难破解。（我们将在[第11章](nsp-enoka501485-0020.xhtml#ch11)中更详细地讨论密码短语和创建强密码的内容。）
- en: You also can set names, phone numbers, and other information for your users
    if you want; otherwise, press ENTER to leave these fields blank.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你愿意，你还可以为用户设置姓名、电话号码和其他信息；否则，按ENTER键跳过这些字段。
- en: 'Deleting a user is just as easy:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 删除用户同样简单：
- en: '[PRE4]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'In addition, you may want to give your new user `sudo` privileges to allow
    them to administer your system, which you can do with the `usermod` command:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，你可能希望授予新用户`sudo`权限，以便他们能够管理系统，这可以通过`usermod`命令实现：
- en: '[PRE5]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The `-aG` (add group) parameter will add the user to the *sudo* group. User
    groups in Linux are a collection of user accounts, and they’re used to assign
    privileges and permissions to specific user accounts, such as the ability to read
    and write certain files. Keep in mind, however, that the fewer users with sudo
    privileges the better. Always practice the principle of least privilege and allow
    users only as much control as they require on a day-to-day basis. Providing administrator
    credentials and privileges to more people than necessary will lead to a far less
    secure network configuration.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: '`-aG`（添加组）参数会将用户添加到*sudo*组中。Linux中的用户组是用户账户的集合，用于为特定的用户账户分配权限和权限，例如读取和写入某些文件的权限。然而，请记住，拥有sudo权限的用户越少越好。始终遵循最小权限原则，只给予用户日常操作所需的控制权限。将管理员凭据和权限授予多余的人会导致网络配置的安全性大大降低。'
- en: 'Finally, you can reset the password for a given user with the `passwd` command:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，你可以使用`passwd`命令重置给定用户的密码：
- en: '[PRE6]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Managing the users in your network is an important part of keeping your network
    secure. Having superfluous user accounts, especially if they have more privileges
    than they require, provides an easy way for adversaries to compromise and gain
    a foothold inside your network. This is easily preventable, so always be aware
    of the risks of additional or unnecessary user accounts.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 管理网络中的用户是保持网络安全的重要部分。拥有多余的用户账户，尤其是那些权限超出需求的账户，会为攻击者提供轻松的入侵方式，从而在你的网络内获得立足点。这是完全可以避免的，因此，始终要注意额外或不必要用户账户的风险。
- en: Besides managing the users in your environment, each of your endpoints has a
    hostname, which is a friendly name or human-readable name used to identify the
    host. Often, these are configured as some default value by the operating system
    when it’s installed (like `ubuntu` for Ubuntu systems). It can be beneficial to
    choose a naming scheme for your hosts and to ensure each host has a different
    name. In Windows networks, for example, multiple hosts cannot have the same hostname,
    because this results in conflicts that create administrative problems within the
    network.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 除了管理你环境中的用户外，每个终端设备都有一个主机名，这是一个用于识别主机的友好名称或可读名称。通常，在操作系统安装时，系统会将其配置为某个默认值（例如，Ubuntu系统的`ubuntu`）。为主机选择一个命名方案并确保每个主机具有不同的名称是有益的。例如，在Windows网络中，多个主机不能具有相同的主机名，因为这会导致冲突，从而在网络中造成管理问题。
- en: 'You can check the hostname of your Linux system with the `hostname` command:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用`hostname`命令检查你的Linux系统的主机名：
- en: '[PRE7]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'To change the hostname, use the `hostname` command again, but this time use
    `sudo` and specify the desired hostname:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 要更改主机名，再次使用`hostname`命令，但这次需要使用`sudo`并指定所需的主机名：
- en: '[PRE8]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Run the `hostname` command again to confirm the change has occurred. Reboot
    your server to make the change permanent.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 再次运行`hostname`命令确认更改已生效。重启服务器使更改永久生效。
- en: '[#6: Securing Remote Access](nsp-enoka501485-0007.xhtml#rhd0306)'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '[#6: 保护远程访问](nsp-enoka501485-0007.xhtml#rhd0306)'
- en: Now that you’ve made it possible to access the system remotely with SSH, you
    need to lock down that capability so only authorized users can log in to this
    host. Several settings are involved in this process. You’ll disable password login
    in favor of SSH keys, as well as disallow the root account from logging in directly
    via SSH. Allowing superusers such as root to log in interactively using utilities
    like SSH is bad practice because it allows attackers to perform attacks such as
    brute-forcing (continually guessing potential passwords until they find the one
    that works) and then be able to log in with complete access to your system. Likewise,
    with your other user accounts, using SSH keys to log in instead of passwords eliminates
    an entire class of potential attacks (username and password guessing) against
    your systems.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经使得可以通过 SSH 远程访问系统，你需要锁定该功能，只允许授权用户登录到此主机。这个过程涉及几个设置。你将禁用密码登录，改为使用 SSH 密钥，并禁止
    root 账户通过 SSH 直接登录。允许超级用户（如 root）使用像 SSH 这样的工具交互式登录是一个不好的做法，因为这会让攻击者进行暴力破解（不断猜测潜在密码直到找到正确的密码），然后可以完全访问你的系统。同样，对于其他用户账户，使用
    SSH 密钥而不是密码登录，可以消除一类潜在攻击（用户名和密码猜测）对你的系统的威胁。
- en: '[Generating SSH Keys](nsp-enoka501485-0007.xhtml#rbh0308)'
  id: totrans-160
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[生成 SSH 密钥](nsp-enoka501485-0007.xhtml#rbh0308)'
- en: '*SSH key pairs* are generally accepted to be more secure than passwords or
    passphrases. SSH keys are cryptographically secure keys that can be used to authenticate
    a client computer (your local host) to an SSH server (your Ubuntu system). The
    first part of a key pair is your private key, which is held by and identifies
    your client, and must remain absolutely secret, just like a password. The other
    half is the public key, which can be freely shared. The public key is provided
    to your SSH server and is capable of decrypting your private key, thereby allowing
    authentication between the two endpoints. Each local user account that you want
    to use to log in to your Ubuntu system will need its own set of public and private
    keys.'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '*SSH 密钥对* 通常被认为比密码或密码短语更安全。SSH 密钥是加密安全的密钥，可以用来验证客户端计算机（你的本地主机）与 SSH 服务器（你的
    Ubuntu 系统）之间的身份。密钥对的第一部分是你的私钥，它由你持有并识别你的客户端，必须绝对保密，就像密码一样。另一部分是公钥，可以自由分享。公钥提供给你的
    SSH 服务器，并能解密你的私钥，从而允许两端之间的身份验证。每个你希望用来登录到 Ubuntu 系统的本地用户账户都需要一对公钥和私钥。'
- en: 'To create an SSH key pair, open a terminal window on the computer you plan
    to use as your SSH client (the computer that will connect to your Ubuntu system
    via SSH). Enter `ssh-keygen` and press enter. Press enter again to accept the
    default file in which to save the keys. The default location of this file will
    be:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建一个 SSH 密钥对，在你计划作为 SSH 客户端使用的计算机上打开终端窗口（即将通过 SSH 连接到你的 Ubuntu 系统的计算机）。输入 `ssh-keygen`
    并按回车键。再次按回车键以接受保存密钥的默认文件。该文件的默认位置是：
- en: '• Windows: *C:\Users\<user>\.ssh\id_rsa*'
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '• Windows: *C:\Users\<user>\.ssh\id_rsa*'
- en: '• macOS: */Users/<user>/.ssh/id_rsa*'
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '• macOS: */Users/<user>/.ssh/id_rsa*'
- en: '• Linux: */home/<user>/.ssh/id_rsa*'
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '• Linux: */home/<user>/.ssh/id_rsa*'
- en: Next, you’ll be asked for a passphrase for your private key, which is optional
    but recommended. By using a passphrase in addition to your SSH keys, your private
    key is never exposed on the network, meaning that to get access to your private
    key, attackers need access to your computer (if they have that, it’s probably
    already game over). Once you’ve entered your passphrase (or not), press ENTER,
    and your key pair will be created.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，你将被要求输入私钥的密码短语，这是可选的，但推荐使用。通过在 SSH 密钥的基础上使用密码短语，你的私钥就不会暴露在网络上，这意味着要获取你的私钥，攻击者需要访问你的计算机（如果他们能做到这一点，游戏可能已经结束）。一旦输入密码短语（或者不输入），按
    ENTER 键，你的密钥对将被创建。
- en: 'To provide the public key file to your Ubuntu system (or any other server you
    want to use your key pair to connect with), enter the following command:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 要将公钥文件提供给你的 Ubuntu 系统（或任何其他你希望使用密钥对连接的服务器），请输入以下命令：
- en: '[PRE9]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: The prompt about an ECDSA key fingerprint might be shown, which just means that
    the remote computer wasn’t able to identify your local computer (because it hasn’t
    connected to it in this way before). If you receive this prompt, type `yes` and
    press ENTER. Your Ubuntu system will ask you for the password of the user account
    you’re trying to use to connect (that is, the password for the remote user account).
    Enter the password, and the process is complete. At this point, you can use `ssh`
    `user@your_ubuntu_ip` to log in to your Ubuntu system, and you’ll be prompted
    for the SSH key passphrase (not the passphrase for the user on the Ubuntu system)
    if you set one.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 可能会显示有关 ECDSA 密钥指纹的提示，这意味着远程计算机无法识别你的本地计算机（因为它以前没有以这种方式连接过）。如果你收到这个提示，输入`yes`并按下
    ENTER。你的 Ubuntu 系统将会要求你输入你试图使用的用户账户的密码（也就是远程用户账户的密码）。输入密码后，过程完成。此时，你可以使用`ssh`
    `user@your_ubuntu_ip`登录到你的 Ubuntu 系统，如果你设置了 SSH 密钥密码，还会提示你输入 SSH 密钥的密码短语（不是 Ubuntu
    系统上用户的密码）。
- en: Disallowing Password Authentication
  id: totrans-170
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 禁用密码认证
- en: 'Next, change the SSH configuration on your Ubuntu system to disallow password
    authentication, forcing the use of your SSH keys to log in. Log in to your Ubuntu
    system as a standard, non-root user, and open the SSH configuration file in the
    terminal using Nano, the text editor installed by default on many Linux distributions,
    with the following command:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，更改你 Ubuntu 系统上的 SSH 配置，禁止使用密码认证，强制使用 SSH 密钥登录。以标准的非 root 用户身份登录你的 Ubuntu
    系统，并使用以下命令在终端中打开 SSH 配置文件，Nano 是许多 Linux 发行版默认安装的文本编辑器：
- en: '[PRE10]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Find the line with the setting: `# PasswordAuthentication yes`. To search for
    text in Nano, press CTRL-W and then type your search term and press ENTER. The
    setting is currently commented out (the `#` at the start of the line tells SSH
    to ignore that line) because `yes` is the default configuration and doesn’t need
    to be set explicitly. Remove the `#` from the beginning of the line, and change
    `yes` to `no`. For every system you create (and on which you enable SSH), you
    must change this setting.'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 查找设置行：`# PasswordAuthentication yes`。在 Nano 中搜索文本时，按下 CTRL-W 然后输入你的搜索词并按 ENTER。该设置当前被注释掉（行首的
    `#` 告诉 SSH 忽略该行），因为 `yes` 是默认配置，不需要显式设置。去掉行首的 `#`，并将 `yes` 改为 `no`。每当你创建一个新系统并启用
    SSH 时，都必须更改此设置。
- en: Disabling Root Login
  id: totrans-174
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 禁用 Root 登录
- en: 'It’s also prudent to disable the ability for the root user to log in remotely.
    As mentioned earlier, on Linux, the root user has the highest level of permissions
    or privileges on the system. By disabling its ability to log in, you remove the
    capability of any would-be attackers to gain privileged access to the system.
    Technically, the root account on the most recent versions of Ubuntu can’t log
    in because it’s locked by default, but it’s always good to ensure it’s unable
    to log in anyway. Find the line:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 还应谨慎禁用 root 用户远程登录的功能。如前所述，在 Linux 系统中，root 用户拥有系统中最高级别的权限。通过禁用其登录能力，你可以防止任何潜在的攻击者获得系统的特权访问权限。从技术上讲，在最新版本的
    Ubuntu 上，root 账户默认是被锁定的，无法登录，但确保它无法登录总是明智的。找到以下行：
- en: '[PRE11]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: and change `prohibit-password` to `no`. With that done, save the changes you’ve
    made to the file. Press ctrl-O and then press enter to overwrite the file you’re
    editing. Press ctrl-X to exit the file and return to the terminal.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 并将`prohibit-password`改为`no`。完成后，保存你对文件所做的更改。按下 ctrl-O 然后按 enter 键覆盖你正在编辑的文件。按下
    ctrl-X 退出文件并返回终端。
- en: 'Restart the SSH service so that it’s reloaded with the new configuration, using
    the following command:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下命令重新启动 SSH 服务，使其重新加载新的配置：
- en: '[PRE12]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'There’s one more thing left to test. Earlier, you disabled the ability to log in
    via SSH using password authentication by modifying the configuration file in */etc/ssh/sshd_config*.
    From any computer in your network, try to SSH into your Ubuntu system using an
    account on that computer, with the password you configured (not the user account
    you provided with your SSH key):'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 还有一件事需要测试。之前，你通过修改配置文件 */etc/ssh/sshd_config* 禁用了通过 SSH 使用密码认证登录的功能。从你网络中的任何一台计算机，尝试使用该计算机上的账户和你配置的密码（不是你通过
    SSH 密钥提供的用户账户）SSH 登录到你的 Ubuntu 系统：
- en: '[PRE13]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Here, `user` is the username you use to log in to the system, and `your_ubuntu_ip`
    is the IP address of your Linux system. If you’re able to log in successfully,
    go back to the “[Disallowing Password Authentication](nsp-enoka501485-0010.xhtml#ch0301)”
    section and make sure your configuration is correct, or reboot Ubuntu. Leaving
    access open would create a vulnerability in your network, which is easy to fix
    but potentially a big problem if left unchecked.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，`user` 是你用来登录系统的用户名，`your_ubuntu_ip` 是你的 Linux 系统的 IP 地址。如果你能够成功登录，请返回 “[禁止密码认证](nsp-enoka501485-0010.xhtml#ch0301)”
    部分，确保你的配置正确，或重新启动 Ubuntu。保持开放的访问权限会在你的网络中创建一个漏洞，虽然这个问题很容易解决，但如果放任不管，可能会带来很大的安全风险。
- en: '[Remote Login with SSH](nsp-enoka501485-0007.xhtml#rbh0309)'
  id: totrans-183
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[使用 SSH 远程登录](nsp-enoka501485-0007.xhtml#rbh0309)'
- en: 'Both macOS and Windows have SSH built in. Using the computer for which you
    generated an SSH key and copied to your Ubuntu system, connect to your new Linux
    system by entering the following command:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: macOS 和 Windows 都内置了 SSH。使用为你的 Ubuntu 系统生成并复制的 SSH 密钥的计算机，输入以下命令以连接到新的 Linux
    系统：
- en: '[PRE14]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: When you log in via SSH to Ubuntu, the operating system outputs a lot of useful
    information. The first line indicates which version of the operating system is
    currently installed ❶. There are links to documentation and how to get help ❷,
    followed by a list of any available updates for the system or installed packages
    ❸. This useful list indicates when you need to run the update commands described
    earlier in “[Installing System Packages](nsp-enoka501485-0010.xhtml#hd0304).”
    Next, Ubuntu shows when support for your operating system expires ❹, at which
    point you’ll need to upgrade your distribution with the `sudo apt dist-upgrade`
    command or build a new system with the latest operating system. Finally, the last
    successful login to the system is shown ❺, which can be useful for identifying
    suspicious activity. If the last login was at 3 AM or from an unfamiliar IP address,
    you might want to investigate that activity (unless you’re in the habit of administering
    your network and systems in the early hours).
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 当你通过 SSH 登录到 Ubuntu 时，操作系统会输出大量有用的信息。第一行显示当前安装的操作系统版本❶。接下来是文档链接以及如何获得帮助❷，然后列出了系统或已安装软件包的可用更新❸。这个有用的列表显示了你何时需要运行前面在“[安装系统软件包](nsp-enoka501485-0010.xhtml#hd0304)”中描述的更新命令。接下来，Ubuntu
    显示操作系统支持的到期时间❹，届时你需要通过 `sudo apt dist-upgrade` 命令升级你的发行版，或者使用最新的操作系统重新构建一个新系统。最后，显示系统最后一次成功登录的信息❺，这对于识别可疑活动非常有用。如果上次登录是在凌晨
    3 点或来自一个不熟悉的 IP 地址，你可能需要调查该活动（除非你习惯在凌晨管理网络和系统）。
- en: '[#7: Capturing VM Configurations](nsp-enoka501485-0007.xhtml#rhd0307)'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: '[#7: 捕获虚拟机配置](nsp-enoka501485-0007.xhtml#rhd0307)'
- en: At this point, if you’re using a VM, your virtual machine is at a known-good
    state; you’ve finished configuring and hardening it, and it’s ready to be used
    in your network. It’s a good idea to save this state so that if something goes
    wrong, you can return to it without completely rebuilding the system. One of the
    benefits of using virtual machines is the ability to take *snapshots*. Snapshots
    save the current state of a virtual machine, including its power state (on, off,
    suspended, and so on), so that you can quickly return to a saved state if necessary.
    You can’t do that with a traditional, physical system, although we’ve all been
    in situations where we wish we could. You might choose to take a snapshot before
    installing a new program, for example, or before changing a VM’s network settings
    or before adding or deleting a new user.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，如果你使用的是虚拟机，那么你的虚拟机已经处于一个已知的良好状态；你已经完成了配置和加固工作，它已准备好在你的网络中使用。最好保存这个状态，以便如果发生问题时，你可以恢复到这个状态，而无需重新构建整个系统。使用虚拟机的一个好处是可以创建
    *快照*。快照保存虚拟机的当前状态，包括其电源状态（开、关、暂停等），这样你就可以在必要时迅速恢复到保存的状态。传统的物理系统无法做到这一点，虽然我们都曾有过希望能这样做的时刻。例如，你可以选择在安装新程序之前，或在更改虚拟机的网络设置或添加/删除新用户之前创建一个快照。
- en: '[Taking Snapshots in VMware](nsp-enoka501485-0007.xhtml#rbh0310)'
  id: totrans-189
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[在 VMware 中创建快照](nsp-enoka501485-0007.xhtml#rbh0310)'
- en: Regardless of the version of VMware you’re using, simply right-click the virtual
    machine for which you want to create a snapshot, click **Snapshots▸Snapshot**,
    name your snapshot, and wait for the process to complete. That’s it. Now, if something
    happens to your VM, right-click the VM and then click **Snapshots▸Restore Snapshot**
    to revert to this known-good state. It’s that simple.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
- en: '[Taking Snapshots in VirtualBox](nsp-enoka501485-0007.xhtml#rbh0311)'
  id: totrans-191
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In VirtualBox, click the menu button (three bullets and three lines) on the
    VM in the virtual machine panel on the left of the VirtualBox window and then
    click **Snapshots**. To create a snapshot, click **Take**. Name your snapshot,
    click **OK**, and wait for the process to complete. To revert to a snapshot, click
    the snapshot and then click **Restore**.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
- en: Note Every snapshot you create will effectively make a duplicate of your virtual
    machine. Multiple snapshots can take up a large amount of space on your host computer.
    Keep this in mind when creating snapshots, and remove old snapshots when they’re
    no longer needed. Some cloud providers charge for snapshot storage as well, so
    keep that in mind when creating snapshots in your cloud dashboard. Snapshots are
    also not a good long-term backup method. (We’ll discuss backups at length in [Chapter 9](nsp-enoka501485-0018.xhtml#ch09).)
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
- en: '[Network Topology](nsp-enoka501485-0007.xhtml#rah0304)'
  id: totrans-194
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Understanding how your systems and devices connect to and communicate with each
    other is critical when it comes to cybersecurity. With that in mind, let’s take
    a crash course on the *Internet Protocol (IP)* and IP addressing. IP is a standard
    protocol that defines the format of data sent over a network allowing computers
    and other network-connected devices to communicate with each other.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
- en: Each of your computers and other network-connected devices requires an *IP address*.
    An IP address is comparable to a street address or a post office box; computer
    A sends network traffic to computer B by embedding computer B’s IP address in
    the data it sends. It’s the same as writing an address on an envelope. Any intermediate
    devices between the two computers can interpret this address from the data and
    pass it along until it reaches its destination, just like the postal service.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
- en: Two commonly used versions of the internet protocol currently exist, version
    4 and version 6, which means we have two types of IP addresses, IPv4 and IPv6\.
    While IPv6 has been around since the 1990s, it still isn’t used often today. We
    won’t cover it in detail in later chapters as it’s largely outside the scope of
    this book, but it’s important to be aware of what it is and why it exists. IPv4
    addresses are written in what is known as *dotted quad notation*, which is a fancy
    way of saying they’re composed of four numbers separated by periods, such as 192.168.1.1\.
    Each of the four numbers can range from 0 to 255, meaning that IPv4 addresses
    range from 0.0.0.0 to 255.255.255.255, or a total of 4,294,967,296 possible addresses.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
- en: So many network-connected devices now exist in the world that there aren’t enough
    IPv4 addresses to go around, which is one of the reasons IPv6 was created. IPv6
    has a larger address space, with a total of more than 340 trillion, trillion,
    trillion addresses. To put that in perspective, that’s 100 times more addresses
    than there are atoms on the surface of Earth, which is convenient as more and
    more internet-connected devices come online. Eventually, IPv6 will be in common
    use, and every device will be able to have its own public IPv6 address, until
    we run out of those (probably not in my lifetime).
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
- en: As there aren’t enough IPv4 addresses for everyone, we’ve had to come up with
    clever workarounds to connect all of our devices to the internet. One of those
    solutions is *network address translation (NAT)*. Using NAT, several devices can
    be contacted via one IP address.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
- en: When you connect your home or office to the internet through your router, your
    internet service provider assigns you (and your network) a public IP address.
    You can find your IP address using services like [https://www.whatismyip.com/](https://www.whatismyip.com/).
    IP addresses are usually *dynamic*, meaning that when you disconnect from and
    reconnect to the internet, you will often receive a different IP address.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
- en: Your internet router is responsible for routing traffic from your private, internal
    network, to the public internet, and vice versa, which is how you’re able to access
    services and browse the internet generally. At a high level, NAT takes the public
    IP address assigned to your router and translates the traffic it receives so that
    traffic bound from the internet to one of your internal computers or devices receives
    the traffic destined for that specific device. It’s similar to the way letters
    and packages are delivered to office buildings at their street address, and then
    a clerk or mail department determines where that package needs to go internally,
    forwarding it to the right recipient. It also works in the reverse; traffic outbound
    from your computer to the internet must be translated from the internal IP address
    of your computer to the public IP address of your router before being forwarded
    on to reach its intended destination and return a service, like a web page.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
- en: 'Different IP addresses are reserved and available for use on the public internet
    and your private network. The private address ranges that can be used for private
    networks are:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
- en: 10.0.0.0 to 10.255.255.255
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 172.16.0.0 to 172.31.255.255
  id: totrans-204
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 192.168.0.0 to 192.168.255.255
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All other IP addresses form part of the publicly available IP ranges or are
    as yet unassigned.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
- en: '[#8: Checking Your IP Address](nsp-enoka501485-0007.xhtml#rhd0308)'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
- en: Addressing is usually handled by a router or server. If you have a wireless
    router, you can log in to that device, take a look at the client list or DHCP
    settings, and find out which address range is being used. Alternatively, you can
    just check the address of your computer(s). Understanding the addressing in your
    network, in addition to maintaining an asset inventory and network map, also means
    you can keep account of the addresses assigned to specific devices, the users
    who are responsible for or assigned to a specific piece of hardware, and where
    a particular device is physically located, among other metadata. (We discuss asset
    management further in [Chapter 8](nsp-enoka501485-0017.xhtml#ch08).)
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
- en: '[On Windows](nsp-enoka501485-0007.xhtml#rbh0312)'
  id: totrans-209
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'On Windows, click the Start menu, enter cmd, and press ENTER to open the command
    prompt. Next, enter `ipconfig` and press ENTER:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: The output will show your current IP address, the relevant *subnet mask*, and
    the *default gateway* your computer is using. The subnet mask indicates to which
    segment of a network your computer belongs, and the default gateway is the address
    of the device your computer uses to access other networks, such as the internet.
    The gateway is probably your router.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
- en: '[On a Mac](nsp-enoka501485-0007.xhtml#rbh0313)'
  id: totrans-213
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Finding the IP address of a Mac is similar. Open a terminal window, type `ifconfig`,
    and press ENTER:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  id: totrans-215
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'On macOS, the `ifconfig` output is a bit different: `inet` is the internet
    or IP address, `netmask` is the subnet mask, and `broadcast` is the *broadcast
    address* of the network. The subnet mask here is displayed in *hexadecimal (hex)*
    instead of decimal. Hex is another notation used by computers, different from
    the dotted quad notation. A broadcast address is a reserved address in a network
    used for sending traffic to all devices in that network segment (we’ll cover this
    more in [Chapter 10](nsp-enoka501485-0019.xhtml#ch10), which discusses network
    security monitoring).'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
- en: '[On Linux](nsp-enoka501485-0007.xhtml#rbh0314)'
  id: totrans-217
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'On a Linux system, open a terminal window, and enter the following:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
- en: $ `ip addr`
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
- en: '`--snip--`'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
- en: '2: ens32: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP
    group default qlen 1000'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
- en: link/ether 00:0c:29:db:ee:7c brd ff:ff:ff:ff:ff:ff
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
- en: altname enp2s0
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
- en: '`inet`  192.168.1.30`/24 brd` 192.168.1.255 scope global dynamic noprefixroute
    ens32'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
- en: valid_lft 4106sec preferred_lft 4106sec
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
- en: inet6 fe80::66e:1ae7:861f:9224/64 scope link noprefixroute
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
- en: valid_lft forever preferred_lft forever
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
- en: The IP address is listed under `inet` again; the broadcast address is `brd`,
    and the subnet mask is shown as `/24`, in *CIDR notation*. CIDR is another way
    of representing the same subnet mask information in a shorter format.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
- en: '[#9: Creating a Network Map](nsp-enoka501485-0007.xhtml#rhd0309)'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
- en: To get a better understanding of your network and see more granular details,
    like ingress and egress points (that is, the places where traffic enters and leaves
    your network), creating a *network map* or *network diagram* is beneficial. A
    network diagram is a graphical representation of your network that allows you
    to see the overall architecture at a glance and makes it easier to identify potential
    issues when it comes to securing your network.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
- en: draw.io ([https://www.draw.io/](https://www.draw.io/)) is a free and easy-to-use
    cloud editor that allows users to create various types of diagrams, one being
    the network diagram. Alternatively, Microsoft Visio is a commercial solution that
    achieves the same objective. If you choose to use draw.io, load the site and open
    the Citrix drop-down from the menu on the left. You can then drag and drop the
    relevant representations, as shown in [Figure 1-2](nsp-enoka501485-0010.xhtml#fig0102),
    from the menu on the left to the canvas on the right.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
- en: '![Screenshot showing draw.io that has a grid (or canvas) on the right side
    of its window and a menu on the left side. The menu contains the following drop-down
    options: General, Misc, Advanced, Citrix. The Citrix drop-down option contains
    various images of hardware.](images/nsp-enoka501485-fig0102.jpg)'
  id: totrans-232
  prefs: []
  type: TYPE_IMG
- en: 'Figure 1-2: draw.io diagramming tool'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
- en: 'At its most basic, a small network typically comprises a modem/router, usually
    provided by your internet service provider, which connects your network and all
    your devices to the internet, as well as a few devices: computers, laptops, mobile
    devices, peripherals such as printers, and so on. Keeping track of all the devices
    on your network better enables you to secure your network, because you know what
    should be connected and allowed to communicate, both within the network and between
    your network and the internet.'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
- en: Always keep your network diagram up-to-date. Whenever you add a new computer,
    laptop, mobile device, switch, virtual machine, or other system or device to your
    network (and remove them as well), you should update your network diagram. When
    it comes to a transient device whose IP addresses aren’t static, it might be worth
    assigning the device a static IP address in your router (see [Chapter 4](nsp-enoka501485-0013.xhtml#ch04)).
    Otherwise, you can track the IP range that might be assigned to those devices.
    Even if a device isn’t always connected to your network, maintain a record of
    devices that will be consistently expected to connect ([Chapter 4](nsp-enoka501485-0013.xhtml#ch04)
    discusses this in greater detail), and note those IP addresses in your network
    diagram.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
- en: A network diagram also allows you to see where you can implement additional
    security controls to improve your security posture. For example, [Figure 1-3](nsp-enoka501485-0010.xhtml#fig0103)
    shows a small, basic network.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
- en: '![The basic network diagram contains the Internet (at the very top), which
    connects to a Wireless Router, which is connected to Desktop 1 and Laptop 1.](images/nsp-enoka501485-fig0103.jpg)'
  id: totrans-237
  prefs: []
  type: TYPE_IMG
- en: 'Figure 1-3: A small network'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
- en: This network layout is typical of most home networks, where a modem/router connects
    the network to the internet, and all the endpoints use that device as a gateway
    to the public network. The problem with this network architecture is that it also
    allows adversaries to use the same network infrastructure to access the private
    network, without many obstacles in their path. Later in this book, you’ll learn
    how to improve this network’s security by adding a firewall between the wireless
    router and the internet to better manage the ingress and egress traffic and block
    suspicious traffic entering or leaving the network (see [Chapter 3](nsp-enoka501485-0012.xhtml#ch03)
    for more details on firewalls).
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
- en: When mapping your network, collect as much information as possible about all
    the devices it includes, such as their IP addresses, MAC addresses, hostnames,
    purpose, primary user or owner, location, serial numbers, and so on. Start with
    your computers and move on to mobile devices, such as phones and tablets, and
    then any IoT devices you might have—if your TV or refrigerator connects to the
    internet, be sure to capture those as well.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
- en: '[#10: Transferring Files](nsp-enoka501485-0007.xhtml#rhd0310)'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
- en: 'You may want to transfer files to your Linux machine from another system or
    from your Linux machine to your local computer. The intuitive rsync tool can synchronize
    files and folders, either between two locations on one system or between two systems
    across a network. To transfer specific files from one computer to another, use
    the following:'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  id: totrans-243
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Immediately following the `rsync` command are four flags. The `r` flag stands
    for *recursive*, meaning that everything inside the source folder will be copied
    to the destination. The `u` flag stands for *update*, which indicates to rsync
    that if it finds a copy of a file in the destination location that is newer than
    the copy in the source directory, skip it. Next, `h` is the typical flag used
    for *human-readable output*: any numbers (dates, file sizes, and so on) will be
    shown in an easier-to-read format. The `P` flag is for *progress*, which tells
    rsync to output the progress of the copy to the screen so you can see how much
    data has been transferred, how much remains, and how long until the process is
    expected to complete.'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
- en: Following this first set of flags, the `--remove-source-files` argument tells
    rsync to delete the source files once they’ve been successfully copied, and `--protect-args`
    tells rsync to interpret the following arguments (the source and destination directories)
    as one continuous string each, even if they’re separated by a space character,
    which would normally indicate to the terminal that the directories were separate
    and independent. Without this argument, if your source path has a space in it,
    the command will interpret each section of the path on either side of the space
    character as a separate path. The same is true of the destination path. You can
    exclude one or both of those arguments if you don’t want to delete the source
    files after copying them or if your source and/or destination directories have
    no space characters in them.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
- en: 'In practice, the following shows how the command might look between two Linux
    servers (which we’ll cover in greater detail in [Chapter 5](nsp-enoka501485-0014.xhtml#ch05)):'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  id: totrans-247
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: As we mentioned in the “[Securing Remote Access](nsp-enoka501485-0010.xhtml#hd0306)”
    section, remember to enter the passphrase for the SSH key pair you created earlier,
    not the passphrase for the user account you’re using for the file transfer. The
    bottom of this listing contains the progress percentage, the current transfer
    speed, expected time remaining, and the number of files remaining in the transfer.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
- en: Note The best feature of rsync is its ability to resume transfers if they get
    interrupted. The Secure File Transfer Protocol (SFTP) and Secure Copy Protocol
    (SCP) are alternatives you could use to transfer files between systems, but neither
    can stop a transfer and pick it up at the same point so that you don’t lose your
    transfer progress while transferring potentially large files or directories. For
    these reasons, rsync is superior to SFTP and SCP, so we’ll primarily use rsync
    throughout the remainder of this book.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
- en: '[Summary](nsp-enoka501485-0007.xhtml#rah0305)'
  id: totrans-250
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this chapter, you built and secured your first Linux machine, which you’ll
    need to follow the examples in several chapters of this book. You also learned
    how to harden your Linux system to increase its security and your overall security
    posture, including creating a secure SSH configuration by utilizing SSH key pairs,
    and the fundamentals of how to manage users in your network. You learned about
    mapping your network topology, how computers and other devices are interrelated,
    and how they communicate with each other. In [Chapter 2](nsp-enoka501485-0011.xhtml#ch02),
    you’ll learn how to layout your network to passively increase your overall security.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
