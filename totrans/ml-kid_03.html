<html><head></head><body><div id="sbo-rt-content"><section>
<header>
<figure class="opener">
<img src="Images/chapterart.png" alt=""/>
</figure>
<h1 class="chapterTitle">
<span class="ChapterNumber"><span epub:type="pagebreak" title="49" id="Page_49"/>5</span><br/>
<span class="ChapterTitle">Recognizing Movie Posters</span>
</h1>
</header>
<p class="ChapterIntro"><span class="OpenerCap"><img src="Images/Alphabet-I.png" alt="Alphabet-I" class="dropcap"/></span>n the last two chapters, you collected training images to create an ML system that could identify pictures of a certain object by learning to recognize the colors, shapes, and patterns that the training images had in common. </p>
<p><span epub:type="pagebreak" title="50" id="Page_50"/>In this chapter, you’ll use the same technique to train a model to recognize the style of a picture rather than its subject. For example, if you collect examples of watercolor paintings in one training bucket, and examples of pen drawings in another training bucket, you can train an ML model to recognize whether a picture is a watercolor or a pen drawing. </p>
<p>The most common example of how this technique is used in real life is in search engines. Image search engines can recognize the visual style of images, allowing you to filter image search results by type (clip art, line drawings, photos, and so on). These search engines use an ML model that has been trained with a lot of examples of pictures of different styles to be able to recognize the type of each search result. </p>
<p>Some people use ML systems to create entirely new pictures. This involves training a computer to recognize the patterns found in works of art of a certain style, and then letting the computer use what it has learned to generate new works of art in that style. In 2018, an AI system created a painting that was auctioned as a work of art for over $400,000. </p>
<p>This sort of project is called <em>computational creativity</em><em/> and has been used to create all sorts of things. AI systems have composed new pieces of music and even invented recipes and meals. </p>
<p>In this chapter, you’ll train an ML model that can recognize the genre of a work of art based only on a picture of it.</p>
<p>Think about what posters for certain movie genres have in common. For example, thriller movie posters often have dark colors and large letters. Romance movie posters often have light colors and flowery letters. Science-fiction movie posters often have spaceships, stars, planets, and a black background. </p>
<p>We all learn these patterns, often without realizing it, so that we can recognize a movie’s genre just from seeing its poster (see <a id="figureanchor5-1" href="#figure5-1">Figure 5-1</a>). </p>
<p>In this project, you’ll train the computer to recognize what works of art in a particular genre have in common. For example, do posters for action movies have anything in common? The box art for racing video games? The cover art for rap albums? You’ll see whether a computer can learn to recognize these patterns so that it can identify the genre of a work of art, such as a book, based just on a picture of its cover or poster.  </p>
<span epub:type="pagebreak" title="51" id="Page_51"/><figure>
<img src="Images/f05001.png" alt="f05001"/>
<figcaption><p><a id="figure5-1" href="#figureanchor5-1">Figure 5-1:</a> ML models can learn to recognize movie genres.</p></figcaption>
</figure>
<p>Let’s get started!</p>
<h2 id="h1-500563c05-0001">Build Your Project</h2>
<p class="BodyFirst">Choose a type of art that can be grouped by genre and is represented by a graphical cover or poster. </p>
<p>For example, you could choose:</p>
<ul>
<li>Books, which are represented by book coversBooks, which are represented by book coversBooks, which are represented by book coversBooks, which are represented by book coversBooks, which are represented by book coversBooks, which are represented by book covers</li>
<li>Movies, which are represented by movie posters</li>
<li>Video games, which are represented by box art</li>
<li>Music albums, which are represented by album covers</li>
</ul>
<p>You’ll need to collect pictures of your chosen works of art to be the training examples for this project. Look for websites that group books, movies, games, or albums by genre. If you’ve chosen books, the website for a bookstore or library is a useful source of training examples. If you’ve chosen music albums or video games, retailer websites are good places to try. </p>
<p><span epub:type="pagebreak" title="52" id="Page_52"/>Next, choose a few genres that you want to train the computer to be able to recognize. Training the computer will be easier if you choose genres that are very obviously different. For example, it’s easier to recognize the difference between the posters for action movies and romance movies than it is to recognize the difference between posters for action movies and adventure movies. </p>
<p>For the screenshots in this project, I trained an ML model to recognize three genres of movies—action, family, and drama—based on their movie posters. </p>
<p>Once you’ve chosen your type of art and genres, you can start training your model.</p>
<h3 id="h2-500563c05-0001">Train Your Model</h3>
<ol>
<li value="1">Create a new ML project, name it <code class="bold">Judge a book by its cover</code>, and set it to learn to recognize images.
<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<h2><span class="NoteHead">Note	</span></h2>
<p>If you’re not sure how to create an ML project, read the section <span class="xref" itemid="xref_target_“Creating a New ML Project” on page 9">“Creating a New ML Project” on page 9</span> in <span class="xref" itemid="xref_target_Chapter 2">Chapter 2</span>.</p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
</li>
<li value="2">Click <b>Train</b>, as shown in <a id="figureanchor5-2" href="#figure5-2">Figure 5-2</a>.
<figure>
<img src="Images/f05002.png" alt="f05002"/>
<figcaption><p><a id="figure5-2" href="#figureanchor5-2">Figure 5-2:</a> Train is the first phase of an ML project.</p></figcaption>
</figure>
</li>
<li value="3">Click <b>Add new label</b>, as shown in <a id="figureanchor5-3" href="#figure5-3">Figure 5-3</a>, and enter the name of your first genre.
<span epub:type="pagebreak" title="53" id="Page_53"/><figure>
<img src="Images/f05003.png" alt="f05003"/>
<figcaption><p><a id="figure5-3" href="#figureanchor5-3">Figure 5-3:</a> Click <b>Add new label</b> to create training buckets for your genres.</p></figcaption>
</figure>
</li>
<li value="4">Open a second window in your web browser (usually by selecting <b>File</b><span class="MenuArrow">▶</span><b>New Window</b>) and arrange your two windows side by side, as shown in <a id="figureanchor5-4" href="#figure5-4">Figure 5-4</a>. In your second window, search for pictures that match your first genre.
<figure>
<img src="Images/f05004.png" alt="f05004"/>
<figcaption><p><a id="figure5-4" href="#figureanchor5-4">Figure 5-4:</a> Arrange your two web browser windows side by side. </p></figcaption>
</figure>
</li>
<li value="5"><span epub:type="pagebreak" title="54" id="Page_54"/>Drag a picture (of the book cover, movie poster, game box, or album cover) for your first genre and drop it in the training bucket in your project. 
<p class="ListBody">You should see a thumbnail version of the picture in your training bucket, as shown in <a id="figureanchor5-5" href="#figure5-5">Figure 5-5</a>. If you don’t, try dragging and dropping the picture again.</p>
<figure>
<img src="Images/f05005.png" alt="f05005"/>
<figcaption><p><a id="figure5-5" href="#figureanchor5-5">Figure 5-5:</a> My first training example for recognizing action movies</p></figcaption>
</figure>
</li>
<li value="6">Repeat step 5 until you have at least 10 examples of works of that genre, as shown in <a id="figureanchor5-6" href="#figure5-6">Figure 5-6</a>. 
<figure>
<img src="Images/f05006.png" alt="f05006"/>
<figcaption><p><a id="figure5-6" href="#figureanchor5-6">Figure 5-6:</a> Training examples of action movie posters </p></figcaption>
</figure>
</li>
<li value="7"><span epub:type="pagebreak" title="55" id="Page_55"/>Repeat steps 3 through 6 for all of the genres that you want your model to be able to recognize, as shown in <a id="figureanchor5-7" href="#figure5-7">Figure 5-7</a>.
<p class="ListBody">Try to collect a similar number of examples for each genre. In other words, avoid having lots of examples in one bucket but hardly any in another bucket.</p>
<figure>
<img src="Images/f05007.png" alt="f05007"/>
<figcaption><p><a id="figure5-7" href="#figureanchor5-7">Figure 5-7:</a> Training examples for recognizing different types of movie posters</p></figcaption>
</figure>
</li>
<li value="8">Click <b>Back to project</b> in the top-left corner of the screen.</li>
<li value="9">Click <b>Learn &amp; Test</b>, as shown in <a id="figureanchor5-8" href="#figure5-8">Figure 5-8</a>.
<figure>
<img src="Images/f05008.png" alt="f05008"/>
<figcaption><p><a id="figure5-8" href="#figureanchor5-8">Figure 5-8:</a> Learn &amp; Test is the second phase of an ML project.</p></figcaption>
</figure>
</li>
<li value="10">Click <b>Train new machine learning model</b>, as shown in <a id="figureanchor5-9" href="#figure5-9">Figure 5-9</a>. 
<span epub:type="pagebreak" title="56" id="Page_56"/><figure>
<img src="Images/f05009.png" alt="f05009"/>
<figcaption><p><a id="figure5-9" href="#figureanchor5-9">Figure 5-9:</a> Click <b>Train new machine learning model</b> to start the training process.</p></figcaption>
</figure>
</li>
</ol>
<p>The computer will use the examples that you’ve collected to look for patterns in the covers or posters from different genres. Training the model may take a few minutes, depending on how many examples you’ve collected, but you can move on to the next step of the project in your second web browser window while you wait.</p>
<h3 id="h2-500563c05-0002">Prepare Your Model</h3>
<p class="BodyFirst">You need to test whether your ML model is able to recognize a genre from a picture it hasn’t seen before. To test the model, you’ll save some new pictures that you haven’t used for training and then create a script in Scratch to test your model with them. </p>
<ol>
<li value="1">Search for more pictures of each genre you’ve chosen and save them to your computer. To save the photos, right-click the image and select <b>Save Picture</b> or <b>Save Image As</b>, as shown in <a id="figureanchor5-10" href="#figure5-10">Figure 5-10</a>. x
<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<h2><span class="NoteHead">Note	</span></h2>
<p>Don’t choose the same pictures you used for training the model. You want to test how good the computer is at recognizing genres, not how good it is at remembering them.</p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
<span epub:type="pagebreak" title="57" id="Page_57"/><figure>
<img src="Images/f05010.png" alt="f05010"/>
<figcaption><p><a id="figure5-10" href="#figureanchor5-10">Figure 5-10:</a> Saving test photos to your computer </p></figcaption>
</figure>
<p class="ListBody">Save these test photos in a folder on your computer, as shown in <a id="figureanchor5-11" href="#figure5-11">Figure 5-11</a>. The more pictures you save, the more you can use to test your ML model.</p>
<figure>
<img src="Images/f05011.png" alt="f05011"/>
<figcaption><p><a id="figure5-11" href="#figureanchor5-11">Figure 5-11:</a> Preparing test photos</p></figcaption>
</figure>
</li>
<li value="2"><span epub:type="pagebreak" title="58" id="Page_58"/>Click <b>Back to project</b> in the top-left corner of the screen.</li>
<li value="3">Click <b>Make</b>, as shown in <a id="figureanchor5-12" href="#figure5-12">Figure 5-12</a>.
<figure>
<img src="Images/f05012.png" alt="f05012"/>
<figcaption><p><a id="figure5-12" href="#figureanchor5-12">Figure 5-12:</a> Make is the third phase of an ML project.</p></figcaption>
</figure>
</li>
<li value="4">Click <b>Scratch 3</b>, and then click <b>Open in Scratch 3</b> to open a new window with Scratch.</li>
<li value="5"><em/>Click the cat sprite (<b>Sprite1</b>) in the sprites pane at the bottom right of the screen. Then, click the <b>Costumes</b> tab at the top left.</li>
<li value="6">Move your mouse pointer over the Choose a Costume icon in the bottom-left corner. Click <b>Upload Costume</b> and find the folder on your computer where you saved your downloaded test pictures. </li>
<li value="7">Select all of the test photos you saved in step 1 to upload them all at once as costumes for the cat sprite. 
<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<h2><span class="NoteHead">Note	</span></h2>
<p>Make sure that you don’t make each test image a separate sprite. You should only have one sprite at the bottom right, but lots of costumes on the left-hand side. </p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
</li>
<li value="8">Change the name of the <em/>cat sprite from <b>Sprite1</b> by entering <code class="bold">test images</code> in the Sprite text box, shown in <a id="figureanchor5-13" href="#figure5-13">Figure 5-13</a>.
<span epub:type="pagebreak" title="59" id="Page_59"/><figure>
<img src="Images/f05013.png" alt="f05013"/>
<figcaption><p><a id="figure5-13" href="#figureanchor5-13">Figure 5-13:</a> Create a sprite to hold the test images.</p></figcaption>
</figure>
</li>
<li value="9">You’ll need some button sprites for your Scratch project. Move your mouse pointer over the Choose a Sprite icon in the bottom-right corner.
<p class="ListBody">To draw your own buttons, click <b>Paint</b> to access the drawing and coloring tools. Don’t worry if you make a mistake while painting—just click the blue undo arrow next to the costume name. </p>
<p class="ListBody">If you don’t like drawing, click <b>Choose a Sprite</b> and choose one from the Scratch Sprites Library, as shown in <a id="figureanchor5-14" href="#figure5-14">Figure 5-14</a>.  </p>
<p class="ListBody">Make one button for each of your genres.</p>
<figure>
<img src="Images/f05014.png" alt="f05014"/>
<figcaption><p><a id="figure5-14" href="#figureanchor5-14">Figure 5-14:</a> Access the Sprites Library by clicking <b>Choose a Sprite</b>.</p></figcaption>
</figure>
</li>
<li value="10"><span epub:type="pagebreak" title="60" id="Page_60"/>Rename your button sprites to match the genres, as shown in <a id="figureanchor5-15" href="#figure5-15">Figure 5-15</a>. I named my three buttons action, family, and drama. 
<figure>
<img src="Images/f05015.png" alt="f05015"/>
<figcaption><p><a id="figure5-15" href="#figureanchor5-15">Figure 5-15:</a> Create buttons for each genre.</p></figcaption>
</figure>
</li>
<li value="11">Click the <b>Costumes</b> tab and select the Text tool (which looks like a T) to add labels to the buttons. Use the Fill tool to choose the label color. Make your labels match the names of the genres, as shown in <a id="figureanchor5-16" href="#figure5-16">Figure 5-16</a>.</li>
<li value="12">Next, you’ll create three variables. Click the <b>Code</b> tab, click <b>Variables</b> in the Toolbox, and then click <b>Make a Variable</b>, as shown in <a id="figureanchor5-17" href="#figure5-17">Figure 5-17</a>. 
<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<h2><span class="NoteHead">Note	</span></h2>
<p>For all three variables, select the <b>For all sprites</b> option.</p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
<span epub:type="pagebreak" title="61" id="Page_61"/><figure>
<img src="Images/f05016.png" alt="f05016"/>
<figcaption><p><a id="figure5-16" href="#figureanchor5-16">Figure 5-16:</a> I’ve used the Text and Fill tools to add white labels to each of the buttons.</p></figcaption>
</figure>
<p class="ListBody">Two of the variables count how many times you agree or disagree with the computer’s decision. Name the first variable <code class="bold">agree</code> and the second variable <code class="bold">disagree</code>. </p>
<p class="ListBody">The third variable stores the computer’s choice for the genre of the most recent picture. Name this variable <code class="bold">computer</code>. </p>
<figure>
<img src="Images/f05017.png" alt="f05017"/>
<figcaption><p><a id="figure5-17" href="#figureanchor5-17">Figure 5-17:</a> Click <b>Make a Variable</b> to create the project’s three variables.</p></figcaption>
</figure>
</li>
<li value="13"><span epub:type="pagebreak" title="62" id="Page_62"/>Make sure the checkboxes next to the <code class="bold">agree</code> and <code class="bold">disagree</code> variables are checked. This displays them on the Stage so you can see the score while you test your project. Uncheck the box next to the <b>computer</b> variable.</li>
<li value="14">Click the <b>test images</b> sprite (the sprite with your test pictures as costumes). </li>
<li value="15">Copy the scripts shown in <a id="figureanchor5-18" href="#figure5-18">Figure 5-18</a>. 
<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<h2><span class="NoteHead">Note	</span></h2>
<p>If you’re not sure how to code in Scratch, read the section <span class="xref" itemid="xref_target_“Coding in Scratch” on page xxii">“Coding in Scratch” on page xxii</span> in the introduction to this book.</p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
<p class="ListBody">In the <code class="bold">switch costume</code> block, use the drop-down arrow to set the costume to the first of your test photos (in <a href="#figure5-18">Figure 5-18</a>, my first test photo was called <em>image001</em>).</p>
<figure>
<img src="Images/f05018.png" alt="f05018"/>
<figcaption><p><a id="figure5-18" href="#figureanchor5-18">Figure 5-18:</a> Code for recognizing the movie posters</p></figcaption>
</figure>
</li>
<li value="16"><span epub:type="pagebreak" title="63" id="Page_63"/>Click the first of your genre button sprites, as shown in <a id="figureanchor5-19" href="#figure5-19">Figure 5-19</a>.
<figure>
<img src="Images/f05019.png" alt="f05019"/>
<figcaption><p><a id="figure5-19" href="#figureanchor5-19">Figure 5-19:</a> Genre buttons </p></figcaption>
</figure>
</li>
<li value="17">Copy the scripts shown in <a id="figureanchor5-20" href="#figure5-20">Figure 5-20</a>, changing the <code class="bold">action</code> block to match the label of your first genre button. 
<figure>
<img src="Images/f05020.png" alt="f05020"/>
<figcaption><p><a id="figure5-20" href="#figureanchor5-20">Figure 5-20:</a> Code for the first genre button </p></figcaption>
</figure>
<p class="ListBody">The computer will use this code when the user clicks the button to guess the genre. If the user’s choice matches what the model recognized, the <code>agree</code> count will increase by 1. If it doesn’t match, the <code>disagree</code> count will increase instead. </p></li>
<li value="18"><span epub:type="pagebreak" title="64" id="Page_64"/>Click the next genre button sprite and copy the same scripts from step 17, as shown in <a id="figureanchor5-21" href="#figure5-21">Figure 5-21</a>. As before, match the genre to the label on the button. For my project, the second button was for family movies. 
<figure>
<img src="Images/f05021.png" alt="f05021"/>
<figcaption><p><a id="figure5-21" href="#figureanchor5-21">Figure 5-21:</a> Code for the second genre button </p></figcaption>
</figure>
</li>
<li value="19">Repeat step 17 until all of your genre buttons have a copy of the script, as shown in <a id="figureanchor5-22" href="#figure5-22">Figure 5-22</a>. 
<figure>
<img src="Images/f05022.png" alt="f05022"/>
<figcaption><p><a id="figure5-22" href="#figureanchor5-22">Figure 5-22:</a> Every genre button needs a copy of the script. </p></figcaption>
</figure>
</li>
</ol>
<p>Now it’s time to test your ML project!</p>
<h3 id="h2-500563c05-0003"><span epub:type="pagebreak" title="65" id="Page_65"/>Test Your Model</h3>
<p class="BodyFirst">Try to find someone else to test your ML project, since it’s better for the person testing the project to not have seen the test pictures that you downloaded. </p>
<p>Once they click the Green Flag, Scratch will show them each test picture and ask them to decide what genre they think the work of art is. Your Scratch code will keep a count of how many times they agree with your ML model and how many times they disagree, as shown in <a id="figureanchor5-23" href="#figure5-23">Figure 5-23</a>.</p>
<figure>
<img src="Images/f05023.png" alt="f05023"/>
<figcaption><p><a id="figure5-23" href="#figureanchor5-23">Figure 5-23:</a> Testing your ML model</p></figcaption>
</figure>
<p>Ask whoever tests your project to use <em>only</em> the picture to decide what to click, even if they recognize the work of art and know something about it already. </p>
<h2 id="h1-500563c05-0002">Review and Improve Your Project</h2>
<p class="BodyFirst">In this project, you trained an ML model to recognize the visual styles that are commonly found in images from different genres. </p>
<p>If your ML model performed badly, with a lot more disagrees than agrees, try adding more examples to your training buckets in the Train phase and then training a new ML model with them in the Learn &amp; Test phase. In general, the more training examples an ML model has to learn from, the better the results. </p>
<h2 id="h1-500563c05-0003"><span epub:type="pagebreak" title="66" id="Page_66"/>What You Learned</h2>
<p class="BodyFirst">In this chapter, you trained another ML model to recognize pictures. In the previous two chapters, you trained image recognition systems to recognize objects in a picture. This time, you used one to recognize the style, not the subject, of a picture. </p>
<p>You also saw that one way we commonly measure the effectiveness of an ML system is to compare the answers that it gives to test questions with the answers people give. </p>
<p>In the next chapter, you’ll learn about another useful image recognition application: handwriting recognition.</p>
</section>
</div></body></html>