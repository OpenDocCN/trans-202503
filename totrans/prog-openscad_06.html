<html><head></head><body>
<section>
<header>
<h1 class="chapter">
<span class="ChapterNumber"><span epub:type="pagebreak" title="95" id="Page_95"/>6</span><br/>
<span class="ChapterTitle">Dynamic Designs with if Statements</span></h1>
</header>
<figure class="opener">
<img src="image_fi/book_art/chapterart.png" alt=""/>
</figure>
<p class="ChapterIntro">In this chapter, you’ll learn how to use <code>if</code> statements to create OpenSCAD designs that respond differently to a variety of conditions. This powerful programming tool gives your designs the power to choose from several options and execute only certain lines of code. As a result, you can create dynamic designs that adapt to changing circumstances. For instance, you can use <code>if</code> statements to reconfigure a design quickly for 3D printing.</p>
<p>As an example project, here you will learn to use <code>if</code> statements to vary the length of tick marks on a ruler to indicate inch, half-inch, and quarter-inch increments depending on the position of the tick mark. You’ll also learn how to use random numbers to vary repeated shapes in order to create a more organic variety of design characteristics.</p>
<h2 id="h1-279547c06-0001"><span epub:type="pagebreak" title="96" id="Page_96"/>Using if Statements</h2>
<p class="BodyFirst">An <code>if</code> statement uses a Boolean expression (an expression that evaluates to either <code>true</code> or <code>false</code>) to compare two values, then determines whether to execute code based on that comparison. If the Boolean expression in an <code>if</code> statement evaluates to <code>true</code>, the indicated code statements are executed. Otherwise, the statements are skipped entirely. The Boolean expression describes a condition that must be satisfied in order for the indicated statements to be added to the design.</p>
<p>The following shows <code>if</code> statement syntax:</p>
<pre><code>if (<var>&lt;boolean expression&gt;</var>) {
  // code that is executed only when the boolean expression is true
}</code></pre>
<p><a href="#listing6-1" id="listinganchor6-1">Listing 6-1</a> is a variation on the skyscraper design created in <span class="xref" itemid="xref_target_Chapter 4">Chapter 4</span>. This new version uses <code>if</code> statements to decide where to place windows and doors in the skyscraper (<a href="#figure6-1" id="figureanchor6-1">Figure 6-1</a>).</p>
<pre><code>num_rows = 10;
num_col = 6;

building_width = num_col * 5;
building_height = num_rows * 6;

difference() {
  cube([building_width, 10, building_height]);

  for (<span class="CodeAnnotation" aria-label="annotation1">1</span> z = [1:1:num_rows]) {
    for  (x = [0:1:num_col-1]) {
    <span class="CodeAnnotationCode" aria-label="annotation2">2</span> if (z == 1) {
      <span class="CodeAnnotationCode" aria-label="annotation3">3</span> translate([x*5+1, -1, -1]) cube([3, 3, 8]); // door
      }
      <span class="CodeAnnotationHang" aria-label="annotation4">4</span> if (z &gt; 1) {
      <span class="CodeAnnotationCode" aria-label="annotation5">5</span> translate([x*5+1, -1, z*5]) cube([3, 3, 4]);  // window
      }
    }
  }
}</code></pre>
<p class="CodeListingCaption"><a id="listing6-1">Listing 6-1</a>: Using <code>if</code> statements to insert doors and windows depending on floor number</p>
<p><a href="#figure6-1">Figure 6-1</a> shows a skyscraper with doors on the first floor and windows on every subsequent floor. Two <code>for</code> loops in <a href="#listing6-1">Listing 6-1</a> create the rows and columns of windows and doors in this design. The <code>z</code> variable <span class="CodeAnnotation" aria-label="annotation1">1</span> controls the vertical position of each row. Next, two <code>if</code> statements use those <code>z</code> values to decide whether to add a window or a door to the design. If <code>z</code> equals 1 <span class="CodeAnnotation" aria-label="annotation2">2</span>, a large door is added to the design <span class="CodeAnnotation" aria-label="annotation3">3</span>. If <code>z</code> is greater than 1 <span class="CodeAnnotation" aria-label="annotation4">4</span>, a small window is added to the design <span class="CodeAnnotation" aria-label="annotation5">5</span>.</p>
<span epub:type="pagebreak" title="97" id="Page_97"/><figure>
<img src="image_fi/279547c06/f06001.png" alt="f06001"/>
<figcaption><p><a id="figure6-1">Figure 6-1</a>: A grid of windows on a skyscraper, with a row of doors</p></figcaption>
</figure>
<p>We’ll evolve this skyscraper design throughout the rest of the chapter. However, you might feel that a skyscraper is not a skyscraper without more details, especially on the other sides of the building. We totally agree and leave the exercise of adding more detail to this simple design as a challenge to the reader.</p>
<h2 id="h1-279547c06-0002">Defining Complex Conditions</h2>
<p class="BodyFirst">You can use an <code>if</code> statement to evaluate many types of conditions by utilizing a combination of six Boolean operators and one of two logical operators. In addition, you can specify a default scenario (which is executed if the specified condition is false) by connecting an <code>else</code> statement with an <code>if</code> statement. Finally, you can connect several related conditions together by using an <code>else if</code> statement. </p>
<h3 id="h2-279547c06-0001">Choosing Boolean Operators</h3>
<p class="BodyFirst">OpenSCAD uses six Boolean operators to evaluate the content of variables within a Boolean expression. Each of these operators will result in <code>true</code> if the comparison is valid, and <code>false</code> if the comparison is not valid:</p>
<ol class="none">
<li><span class="RunInHead"><span class="LiteralBold"><code>&lt;</code></span></span>  less than</li>
<li><span class="RunInHead"><span class="LiteralBold"><code>&gt;</code></span></span>  greater than</li>
<li><span class="RunInHead"><span class="LiteralBold"><code>&lt;=</code></span></span>  less than or equal to</li>
<li><span class="RunInHead"><span class="LiteralBold"><code>&gt;=</code></span></span>  greater than or equal to</li>
<li><span class="RunInHead"><span class="LiteralBold"><code>==</code></span></span>  equal to</li>
<li><span class="RunInHead"><span class="LiteralBold"><code>!=</code></span></span>  not equal to</li>
</ol>
<p>The symbols used for many of these Boolean operators are probably familiar to you from math class. OpenSCAD (as with most other <span epub:type="pagebreak" title="98" id="Page_98"/>programming languages) changes the symbols a bit so that you can easily type them on a keyboard. For instance, you’re probably used to seeing the ≤ symbol to indicate less than or equal to. However, programming languages commonly use <code>&lt;=</code> instead. In the same way, <code>&gt;= </code>replaces ≥, and <code>!=</code> replaces ≠. Finally, be sure not to confuse <code>==</code> with <code>=</code>. Because the single equal sign already has a use (assigning a value to a variable), Boolean expressions use the double equal sign (<code>==</code>) to test whether two values are “equal to” each other. For example, <a href="#listing6-1">Listing 6-1</a> tests for the equality of two values by using the equals (<code>==</code>) operator.</p>
<p>This collection of Boolean operators provides many choices for evaluating variables to determine whether a condition is <code>true</code> or <code>false</code>. You can now write a loop that generates different shapes depending on the number of times the loop has repeated. As you will see later, you can also specify that you’d like to draw a shape only if a certain condition is not true. Using Boolean operators in an <code>if</code> statement allows you to create dynamic designs with a relatively small number of statements.</p>
<h3 id="h2-279547c06-0002">Using Logical Operators to Combine Boolean Expressions</h3>
<p class="BodyFirst">Additionally, you can combine multiple Boolean expressions with one of two logical operators: <code>&amp;&amp;</code> (which stands for <em>and</em>) and <code>||</code> (which means <em>or</em>).</p>
<p>If you use the <code>&amp;&amp;</code> operator, all conditions need to be true in order for the indicated statements to execute. If you use the <code>||</code> operator, at least one of multiple conditions needs to be true. For a better sense of how the <code>&amp;&amp;</code> operator works, consider the following: </p>
<pre><code>if (x &gt; 10 &amp;&amp; y &lt;= 20) {
  translate([x, y, 0]) cube([3, 4, 3]);
}</code></pre>
<p>This code segment draws a translated cube only when <code>x</code> is greater than 10 <em>and</em> <code>y</code> is less than or equal to 20. </p>
<p>Now consider this <code>if</code> statement that uses the <code>||</code> operator:</p>
<pre><code>if (x &gt; 10 || y &lt;= 20) {
  translate([x, y, 0]) cube([3, 4, 3]);
}</code></pre>
<p>A translated cube is drawn when <em>either</em> <code>x</code> is greater than 10 <em>or</em> <code>y</code> is less than or equal to 20. Only one of the Boolean expressions connected by an <em>or</em> operator needs to evaluate to <code>true</code> in order for the shape to be drawn. The cube will also be drawn if both Boolean expressions connected by the <em>or</em> operator are <code>true</code>. </p>
<h3 id="h2-279547c06-0003">Following an Expanded Order of Operations</h3>
<p class="BodyFirst">You can construct complex Boolean expressions that involve many arithmetic, Boolean, and logical operators. As in math class, where you learn to perform multiplication <em>before</em> addition, even if addition comes first in the <span epub:type="pagebreak" title="99" id="Page_99"/>arithmetic expression, OpenSCAD evaluates expressions following a well-defined order of operations: </p>
<ol class="decimal">
<li value="1"><code>( )</code></li>
<li value="2"><code>^</code></li>
<li value="3"><code>*</code>, <code>/</code>, <code>%</code></li>
<li value="4"><code>+</code>, <code>-</code></li>
<li value="5"><code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code></li>
<li value="6"><code>==</code>, <code>!=</code></li>
<li value="7"><code>&amp;&amp;</code></li>
<li value="8"><code>||</code></li>
</ol>
<p>Operators at the same level in the order of operations are performed according to the order of their occurrence in the expression as it is read from left to right. Otherwise, operators at the top of this list have a higher precedence and are calculated prior to operators at the bottom of the list, even if that means the expression is calculated from the inside out.</p>
<h3 id="h2-279547c06-0004">Making Two-Way Choices with if…else Statements</h3>
<p class="BodyFirst">A basic <code>if</code> statement executes a section of code only when the Boolean condition is <code>true</code>. To execute alternate code when the Boolean condition is <code>false</code>, attach an <code>else</code> statement to an <code>if</code> statement. An <code>if...else</code> statement creates a two-way branch in your code, allowing you to execute different collections of statements for each truth condition.</p>
<p>Consider the following <code>if...else</code> syntax:</p>
<pre><code>if (<var>&lt;boolean expression&gt;</var>) {
  // code that is executed only when the boolean expression is true
}
else {
  // code that is executed only when the boolean expression is false
}</code></pre>
<p>If the Boolean expression in the <code>if</code> statement is <code>true</code>, the first group of statements is executed. If the Boolean expression in the <code>if</code> statement is  <code>false</code>, the statements contained within the <code>else</code> section is executed. The <code>else</code> section of an <code>if</code> statement is often called the <em>default</em> condition, because it describes what should happen when the condition specified in the <code>if</code> statement is <code>false</code>. An <code>else</code> statement is an optional extension to an <code>if</code> statement and is appropriate for <em>mutually exclusive</em> branching scenarios, where there is no possibility that you want to include both sections of code in your design.</p>
<p>You could easily redesign <a href="#listing6-1">Listing 6-1</a> by using an <code>else</code> statement. The skyscraper in <a href="#figure6-1">Figure 6-1</a> has exactly one row of doors. All of the remaining rows will have windows. Because the <code>for</code> loop should sometimes draw a door and all other times draw a window, you could rewrite the <code>if</code> statement like this:</p>
<pre><code>num_rows = 10;
num_col = 6;

<span epub:type="pagebreak" title="100" id="Page_100"/>building_width = num_col * 5;
building_height = num_rows * 6;

difference() {
  cube([building_width, 10, building_height]);

  for (z = [1:1:num_rows]) {
    for (x = [0:1:num_col-1]) {
      if (z == 1<span class="CodeAnnotation" aria-label="annotation1">1</span>) {
       <span class="CodeAnnotationCode" aria-label="annotation2">2</span> translate([x*5+1, -1, -1]) cube([3, 3, 8]); // door
      }
      else {
       <span class="CodeAnnotationCode" aria-label="annotation3">3</span> translate([x*5+1, -1, z*5]) cube([3, 3, 4]);  // window
      }
    }
  }
}</code></pre>
<p>If the Boolean expression <code>z == 1</code> <span class="CodeAnnotation" aria-label="annotation1">1</span> is <code>true</code>, OpenSCAD draws a door <span class="CodeAnnotation" aria-label="annotation2">2</span>. If the Boolean expression is <code>false</code>, OpenSCAD draws a window <span class="CodeAnnotation" aria-label="annotation3">3</span>.</p>
<h3 id="h2-279547c06-0005">Using Extended if Statements</h3>
<p class="BodyFirst">An <em>extended </em><var>if </var><em>statement</em> attaches a condition to an <code>else</code> statement to create an ordered collection of related decisions. OpenSCAD evaluates the Boolean expressions in an extended <code>if</code> statement in order until one of the expressions evaluates to <code>true</code>. You can optionally include an <code>else</code> statement at the end of an extended <code>if</code> to provide a catchall default option in case all of the decisions evaluate to <code>false</code>.</p>
<p>The syntax for an extended <code>if</code> statement looks like this:</p>
<pre><code>if (<var>&lt;boolean expression&gt;</var>) {
  // code that is executed only when the boolean expression is true
}
else if (<var>&lt;boolean expression&gt;</var>) {
  // code that is executed only when the first boolean expression is false
  // and the second boolean expression is true
}
else {
  // optional default scenario
  // code that is executed only when both boolean expressions are false
}</code></pre>
<p>You can add as many <code>else if</code> statements as needed to describe any number of mutually exclusive design possibilities, which is particularly useful when you want to ensure that exactly one of many related outcomes should happen. Each Boolean expression in the extended <code>if</code> statement is evaluated in order until one is found that evaluates to <code>true</code>. Only the code section for that Boolean expression is executed, while the remaining sections are skipped. If no Boolean expressions are <code>true</code>, the code specified in the optional <code>else</code> section (if provided) is executed. Because the <code>else</code> section describes the default possibility, it must be included at the end of an extended <code>if</code> statement.</p>
<p><span epub:type="pagebreak" title="101" id="Page_101"/><a href="#listing6-2" id="listinganchor6-2">Listing 6-2</a> uses an extended <code>if</code> statement to draw tick marks of various sizes on a ruler (<a href="#figure6-2" id="figureanchor6-2">Figure 6-2</a>). This design creates an inch-based ruler with tick marks at three repeating intervals: one inch, a half inch, and a quarter inch. Tick marks at inch intervals are the longest, followed by slightly shorter half-inch tick marks, and even shorter quarter-inch tick marks. OpenSCAD is unit-less, so this design uses basic proportionality to divide every inch on the ruler into four equal-sized “gaps.” It is intended to be resized to its exact width in your 3D-printing preparation software just prior to printing.</p>
<pre><code>ruler(5);

module ruler(inches) {
<span class="CodeAnnotationHang" aria-label="annotation1">1</span> gap_size = 1; // 1 unit per quarter inch
  total_marks = 4 * inches; // inch, half inch, quarter inch
    
  width = gap_size * total_marks;
  length = 4 * gap_size;
  height = 0.5 * gap_size;
    
  mark_width = 0.25 * gap_size; 
  mark_height = 1.5 * height;

  // main ruler body
  difference() {
    cube([width, length, height]);
    translate([width-gap_size, length-gap_size, -0.5]) 
      cylinder(h=height+1, r=0.15*length, $fn=20);
  }

  // tick marks
  <span class="CodeAnnotationHang" aria-label="annotation2">2</span> for(t = [1:1:total_marks-1]) {
    mark_x = gap_size * t - 0.5 * mark_width;

  <span class="CodeAnnotationCode" aria-label="annotation3">3</span> if (t%4 == 0) { // inch marks and number labels
      translate([gap_size * t, 0.65 * length, 0])
        linear_extrude(mark_height)
          text(str(t/4), size=gap_size, halign="center");
      translate([mark_x, 0, 0])
        cube([mark_width, 0.5 * length, mark_height]);
    }
    <span class="CodeAnnotationHang" aria-label="annotation4">4</span> else if (t%2 == 0) { // half-inch marks
      translate([mark_x, 0, 0])
        cube([0.75 * mark_width, 0.25 * length, mark_height]);
    }
    <span class="CodeAnnotationHang" aria-label="annotation5">5</span> else { // quarter-inch marks
      translate([mark_x, 0, 0])
        cube([0.5 * mark_width, 0.125 * length, mark_height]);
    }
  }
}</code></pre>
<p class="CodeListingCaption"><a id="listing6-2">Listing 6-2</a>: Using extended <code>if</code> statements to differentiate tick mark sizes on a ruler</p>
<span epub:type="pagebreak" title="102" id="Page_102"/><figure>
<img src="image_fi/279547c06/f06002.png" alt="f06002"/>
<figcaption><p><a id="figure6-2">Figure 6-2</a>: A five-inch ruler</p></figcaption>
</figure>
<p>First, a collection of variables is defined to help us organize our design <span class="CodeAnnotation" aria-label="annotation1">1</span>: <code>gap_size</code> indicates that one OpenSCAD unit will represent the width taken by a single quarter-inch gap between tick marks, and <code>total_marks</code> keeps track of the total number of tick marks needed (according to the <code>inches</code> parameter of the <code>ruler</code> module). We’ll need four tick marks per inch as we’ll include marks at the inch, half-inch, and quarter-inch intervals. The other variables relate the proportionality of various features of the ruler to these two initial choices. Organizing the module variables in this manner allows you to quickly update your design in the future. For instance, you might decide to make a longer ruler in your next version. This change could easily be accomplished by making a single change: the calculation that determines the value of <code>length</code> variable.</p>
<p>The <code>for</code> loop <span class="CodeAnnotation" aria-label="annotation2">2</span> draws something for every needed tick mark, except for the first and last tick marks, which are meant to be inferred (as they are the beginning and end of the ruler). The <code>t</code> variable in the <code>for</code> loop keeps track of the number of tick marks being drawn, while <code>mark_x</code> is used to keep track of the location of each new tick mark along the x-axis. The first Boolean expression <span class="CodeAnnotation" aria-label="annotation3">3</span> tests whether the <code>t</code> variable is divisible by 4 (remember, <code>%</code> calculates the remainder). If this condition is <code>true</code>, the longest tick mark is added to the design to indicate an inch interval. If the <code>t</code> variable isn’t divisible by 4, the second Boolean expression <span class="CodeAnnotation" aria-label="annotation4">4</span> tests whether it is divisible by 2. And if it is, the second-longest tick mark is added to the design to indicate a half-inch mark. Only if the <code>t</code> variable isn’t divisible by either 4 or 2 will the shortest tick mark be added to the design <span class="CodeAnnotation" aria-label="annotation5">5</span> by the <code>else</code> statement.</p>
<p>Notice the careful ordering of the decisions used in this extended <code>if</code> statement. The <code>for</code> loop produces a series of numbers that are each evaluated by the extended <code>if</code> statement: 1, 2, 3, 4, 5, 6, 7, 8, and so on. Numbers like 4, 8, and 12 are divisible by both 4 and 2, so which condition should be executed? Extended <code>if</code> statements evaluate each decision in order, executing only the code contained in the <code>if</code> statement with the first Boolean <span epub:type="pagebreak" title="103" id="Page_103"/>expression that is <code>true</code>. Even though some numbers are divisible by both 4 and 2, the second decision <span class="CodeAnnotation" aria-label="annotation3">3</span> is evaluated only if the first expression <span class="CodeAnnotation" aria-label="annotation2">2</span> is <code>false</code>. Thus, only one tick mark is drawn for each value of <code>t</code> in the <code>for</code> loop. This is an example of a mutually exclusive scenario: one, and only one, of the three tick mark lengths should be drawn for each value of <code>t</code>.</p>
<h3 id="h2-279547c06-0006">Using Nested if Statements</h3>
<p class="BodyFirst">Placing an <code>if</code> statement inside another <code>if</code> statement is a way to guarantee that a Boolean expression should be considered only if another Boolean expression is <code>true</code>. At a basic level, a nested <code>if</code> statement can replace the <code>&amp;&amp;</code> operator:</p>
<pre><code>if (x &lt; 8 &amp;&amp; y == 10) {
  // code that is executed only when both boolean expressions are true
}</code></pre>
<p>So you could rewrite the preceding code with a nested <code>if</code> statement:</p>
<pre><code>if (x &lt; 8) {
  if (y == 10) {
    // code that is executed only when both boolean expressions are true
  }
}</code></pre>
<p>It’s probably easiest to use the <code>&amp;&amp;</code> operator for simple combinations of Boolean expressions that all need to be <code>true</code> for satisfying certain design conditions. However, using nested <code>if</code> statements can be easier when you want to test the outcome of multiple Boolean expressions that can either be <code>true</code> or <code>false</code>:</p>
<pre><code>if (x &lt; 8) {
  if (y == 10) {
    // code that is executed only when both x &lt; 8 and y == 10
  }
  else if (y &lt; 10) {
    // code that is executed only when both x &lt; 8 and y &lt; 10
  }
  else {
    // code that is executed only when both x &lt; 8 and y &gt; 10
  }
} else {
  if (y == 10) {
    // code that is executed only when both x &gt;= 8 and y ==10
  }
  else {
    // code that is executed only when both x &gt;= 8 and y !=10
  }
}</code></pre>
<p>It’s usually possible to describe complex conditions using a variety of combinations of Boolean operators, logical operators, extended <code>if</code> <span epub:type="pagebreak" title="104" id="Page_104"/>statements, and nested <code>if</code> statements. Often, the best choice is the combination of conditions that makes the most sense to the person creating the design.</p>
<h2 id="h1-279547c06-0003">Useful Applications of if Statements</h2>
<p class="BodyFirst">You should include an <code>if</code> statement whenever you want your OpenSCAD design to vary according to a specific condition. The following situations are examples of when you may want to use <code>if</code> statements in your projects.</p>
<h3 id="h2-279547c06-0007">Setting Up a Design Mode and Print Mode</h3>
<p class="BodyFirst">Consider the Towers of Hanoi project from <span class="xref" itemid="xref_target_Chapter 4">Chapter 4</span>. When designing the series of stacking discs, it was convenient to visualize the discs stacked vertically on one of the pegs. However, that configuration is not the best for 3D-printing the design, because the disks are resting on top of each other, and you wouldn’t want all the disks to be printed as one piece. </p>
<p>A useful technique is to create two versions of your design: one configuration for visualizing the final result and one for 3D-printing it. Use <em>design mode</em> to build your design in a way that is easy to visualize, and use <em>print mode</em> to reorganize the same design in a way that is better for 3D printing.</p>
<p><a href="#listing6-3" id="listinganchor6-3">Listing 6-3</a> incorporates these two design configurations; <a href="#figure6-3" id="figureanchor6-3">Figure 6-3</a> depicts print mode.</p>
<pre><code>$fn = 100;
mode = "print"; // or "design"

cube([200, 60, 10], center=true);

for (x = [-60:60:60]) {
  translate([x, 0, 5]) cylinder(h=70, r=4);
}

<span class="CodeAnnotationHang" aria-label="annotation1">1</span> if (mode == "design") {
  for (d = [2:1:7]) {
    translate([-60, 0, 10 + (7-d)*10]) disc(d*4, 5);
  }
}
<span class="CodeAnnotationHang" aria-label="annotation2">2</span> else if (mode == "print") {
  for (d = [2:1:7]) {
    if (d &gt; 4) {
      translate([60*d - 350, 60, 0]) disc(d*4, 5);
    }
    else {
      translate([60*d - 200, 100, 0]) disc(d*4, 5);
    }
  }
}

module disc(disc_radius, hole_radius) {
  difference() {
<span epub:type="pagebreak" title="105" id="Page_105"/>    cylinder(h=10, r=disc_radius, center=true);
    cylinder(h=11, r=hole_radius, center=true);
  }
}</code></pre>
<p class="CodeListingCaption"><a id="listing6-3">Listing 6-3</a>: Using <code>if</code> statements to differentiate print mode and design mode</p>
<figure>
<img src="image_fi/279547c06/f06003.png" alt="f06003"/>
<figcaption><p><a id="figure6-3">Figure 6-3</a>: A Towers of Hanoi project set up for printing</p></figcaption>
</figure>
<p><a href="#listing6-3">Listing 6-3</a> uses a variable named <code>mode</code> and an extended <code>if</code> statement to decide whether to draw the shapes in <code>"print"</code> mode or <code>"design"</code> mode. If <code>mode == "design"</code> <span class="CodeAnnotation" aria-label="annotation1">1</span>, the disks are displayed vertically, stacked on top of one another, which makes it easy to visualize and check for correctness. If <code>mode == "print"</code> <span class="CodeAnnotation" aria-label="annotation2">2</span>, the discs are arranged in two horizontal rows, which is an appropriate setup for 3D printing. This differentiation allows you to quickly switch back and forth between the two configurations. When you are ready to print, all you need to do is change the value of <code>mode</code> to <code>"print"</code> to make the design change automatically. </p>
<h3 id="h2-279547c06-0008">Using Random Numbers as a Design Element</h3>
<p class="BodyFirst">Random numbers are a fun way to add unpredictable elements to your designs, which is convenient when a design has features that you want to be similar, but not exactly the same. For instance, you could easily use random numbers to generate an entire city of skyscrapers, all with different heights, widths, and numbers of windows. </p>
<p>When you roll a six-sided die, you can expect that one of the six values (1, 2, 3, 4, 5, 6) on the die will be the result of the roll, but you can’t predict the exact outcome. A similar procedure happens with the <code>rands</code> function. You can be certain that a decimal value within a specified range will be picked without knowing exactly which value will be picked until the statement is executed.</p>
<p><span epub:type="pagebreak" title="106" id="Page_106"/> Use the mathematical <code>rands</code> function to generate random numbers. The following line of code picks two random decimal numbers between 0 and 1:</p>
<pre><code>number_list = rands(0, 1, 2);</code></pre>
<p>The first parameter you pass to <code>rands</code> specifies the lowest decimal number that the random number generator can choose. In this case, the lowest possible number is 0.0. The second parameter specifies the highest possible number, which is 1.0 for this example. The third parameter, 2, specifies how many numbers will be picked. The variable <code>number_list</code> remembers the generated list of random numbers so you can use them later.</p>
<p>The following code segment chooses three random numbers from 10 to 20, then stores the list of three numbers in a variable called <code>number_list</code>. Each random number in the list is then printed to the console window with the <code>number_list</code> variable, followed by the position of each number in the list within square brackets (<code>[</code> <code>]</code>). As with most programming languages, OpenSCAD considers the first element in a list to be in position <code>[0]</code>:</p>
<pre><code>number_list = rands(10, 20, 3);

echo(number_list[0]);
echo(number_list[1]);
echo(number_list[2]);</code></pre>
<p>Every time you preview this code, you will see a different combination of three randomly chosen decimal numbers from 10 to 20 printed to the console. </p>
<p>The <code>rands</code> function can choose any decimal number within the range you provide, but sometimes it’s convenient to restrict a design to working only with integers (that is, numbers without decimals). If your design needs to pick a random integer within a certain range, the mathematical <code>round</code> function can be used to map randomly generated decimals to integers. The <code>round</code> function examines the decimal extension of a number to decide whether the decimal number should be “rounded up” or “rounded down” according to whether the decimal extension is &gt;= 0.5 or &lt; 0.5, respectively:</p>
<pre><code>number_list = rands(9.5, 20.49, 3);

echo(round(number_list[0]));
echo(round(number_list[1]));
echo(round(number_list[2]));</code></pre>
<p>Every time you run this code, you will see a different combination of three integers from 10 to 20 printed to the console because of the use of the mathematical <code>round</code> function in each <code>echo</code> statement. Notice that the first two parameters of the <code>rands</code> function have been changed to 9.5 and 20.49 in order to ensure that each integer in the original range (that is, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, or 20) is picked an approximately equally likely number of times. Because we wouldn’t want to allow for a random choice of 20.5 and have it rounded up to 21, we use 20.49 as the highest possible value <span epub:type="pagebreak" title="107" id="Page_107"/>that can be generated. This produces a slightly lower possibility of 20 being randomly generated as compared to the other integer values in the range, but the difference is very small. </p>
<p>Random numbers are a useful way to generate design elements only a certain percentage of the time. For instance, you could modify your skyscraper design from the preceding chapter so that 50 percent of the time, the skyscraper includes a water tower on top of the roof. </p>
<p><a href="#listing6-4" id="listinganchor6-4">Listing 6-4</a> draws the same simple skyscraper from <a href="#listing6-2">Listing 6-2</a>. This new version of the design sometimes includes a water tower to the top of the building (<a href="#figure6-4" id="figureanchor6-4">Figure 6-4</a>).</p>
<pre><code>num_rows = 10;
num_col = 6;

building_width = num_col * 5;
building_height = num_rows * 6;

difference() {
  cube([building_width, 10, building_height]);

  for (z = [1:1:num_rows]) {
    for (x = [0:1:num_col-1]) {
      if (z == 1) {
        translate([x*5 + 1, -1, -1]) cube([3, 3, 8]);
      }
      else {
        translate([x*5 + 1, -1, z*5]) cube([3, 3, 4]);
      }
    }
  }
}

<span class="CodeAnnotationHang" aria-label="annotation1">1</span> draw_tower = rands(0, 1, 1);

<span class="CodeAnnotationHang" aria-label="annotation2">2</span> if (draw_tower[0] &lt; 0.5) {
   translate([building_width/6, 5, building_height])
     watertower(building_width/4);
}

module watertower(width) {
  $fn = 20;
  cylinder(h=5, r=width/2);
  translate([0, 0, 5]) cylinder(h=5, r1=width/2, r2=0);
}</code></pre>
<p class="CodeListingCaption"><a id="listing6-4">Listing 6-4</a>: <code>if</code> statements and random numbers to sometimes draw a water tower</p>
<p>After drawing a basic building, the design generates a list with a single random number between 0 and 1 <span class="CodeAnnotation" aria-label="annotation1">1</span>. This list is stored in the <code>draw_tower</code> variable. An <code>if</code> statement <span class="CodeAnnotation" aria-label="annotation2">2</span> tests the randomly generated number and draws a water tower on top of the skyscraper only if the number generated is less than 0.5. That means the skyscraper will have a water tower approximately 50 percent of the time, and no water tower the other 50 percent of the time. </p>
<span epub:type="pagebreak" title="108" id="Page_108"/><figure>
<img src="image_fi/279547c06/f06004.png" alt="f06004"/>
<figcaption><p><a id="figure6-4">Figure 6-4</a>: A skyscraper with a water tower</p></figcaption>
</figure>
<p>Next, let’s use random numbers to create a city block of randomly sized skyscrapers (<a href="#figure6-5" id="figureanchor6-5">Figure 6-5</a>):</p>
<pre><code><span class="CodeAnnotationHang" aria-label="annotation1">1</span> use &lt;skyscraper.scad&gt;

num_buildings = 5;

<span class="CodeAnnotationHang" aria-label="annotation2">2</span> width_list = rands(10, 30, num_buildings); 
length_list = rands(20, 30, num_buildings);
height_list = rands(20, 100, num_buildings);

window_row_list = rands(2.5, 10.49, num_buildings);
window_col_list = rands(2.5, 10.49, num_buildings);

watertower_list = rands(0, 1, num_buildings);

for (n=[0:1:num_buildings-1]) {
<span class="CodeAnnotationCode" aria-label="annotation3">3</span> width = width_list[n]; 
  length = length_list[n];
  height = height_list[n];

<span class="CodeAnnotationCode" aria-label="annotation4">4</span> window_rows = round(window_row_list[n]);
  window_cols = round(window_col_list[n]);

  watertower = round(watertower_list[n]);

  translate([0, n*30, 0]) {
  <span class="CodeAnnotationCode" aria-label="annotation5">5</span> skyscraper(width, length, height, window_rows, window_cols, watertower);
  }
}</code></pre>
<span epub:type="pagebreak" title="109" id="Page_109"/><figure>
<img src="image_fi/279547c06/f06005.png" alt="f06005"/>
<figcaption><p><a id="figure6-5">Figure 6-5</a>: A row of randomly sized skyscrapers, some with a water tower</p></figcaption>
</figure>
<p>The skyscraper module is imported from <em>skyscraper.scad</em> <span class="CodeAnnotation" aria-label="annotation1">1</span> to keep the design small and manageable. Next, lists of random numbers (of size <code>num_buildings</code>) are generated for each parameter of the skyscraper module <span class="CodeAnnotation" aria-label="annotation2">2</span>. A <code>for</code> loop then draws a number of skyscrapers according to the value indicated by the <code>num_buildings</code> variable. For each new skyscraper, variables are assigned random numbers from the appropriate spot in each list <span class="CodeAnnotation" aria-label="annotation3">3</span>. Decimals are rounded to integer values <span class="CodeAnnotation" aria-label="annotation4">4</span> for parameters where decimal values wouldn’t make sense (you wouldn’t want half of a window to be drawn). Finally, this collection of randomly generated values specifies the various parameters <span class="CodeAnnotation" aria-label="annotation5">5</span> of each new skyscraper. Every time you preview or render this design, each building will be rendered differently, because the random values used to generate each skyscraper will be different. This technique is useful for making repeated computer-generated designs appear more organic and natural.</p>
<h2 id="h1-279547c06-0004">Summary</h2>
<p class="BodyFirst">This chapter introduced the concept of creating conditional branches with <code>if</code> statements that allow you to create designs that adapt to changing circumstances. Each section of an <code>if</code> statement executes only when a specific condition is true, allowing you to generate designs with varying characteristics. This variety allows you to describe complex designs concisely. </p>
<p><span epub:type="pagebreak" title="110" id="Page_110"/>When utilizing <code>if</code> statements to create dynamic designs, keep these concepts in mind:</p>
<ul>
<li><code>if</code> statements use a Boolean expression to evaluate whether a condition is true or false. </li>
<li><code>if</code> statements execute only if their Boolean expression is <code>true</code>. </li>
<li>All expressions in OpenSCAD are evaluated according to an order of operations, which means that a complex Boolean expression can be evaluated from the inside out.</li>
<li>A nested <code>if</code> statement is an <code>if</code> statement placed inside another <code>if</code> statement.</li>
<li>To indicate what should happen when a Boolean expression is <code>false</code>, extend an <code>if</code> statement with an <code>else</code> statement. </li>
<li>You can combine several mutually exclusive decisions in one extended <code>if</code> statement.</li>
<li>An <code>else</code> statement allows you to provide a default collection of statements that execute when none of the Boolean conditions in an extended <code>if</code> statement are true.</li>
<li>You can use <code>if</code> statements with random numbers to generate an organic naturalness to your design.</li>
<li><code>if</code> statements can help you organize your design into modes (like <code>"print"</code> or <code>"design"</code>), making it easy to change important configuration details. </li>
</ul>
<aside epub:type="sidebar">
<div class="dottedTop hr"><hr/></div>
<section class="boxcustom2">
<h2 id="h1-279547c06-0005"><span epub:type="pagebreak" title="111" id="Page_111"/>Design Time: if Statements </h2>
<p class="BoxBodyFirst">Before reading further, practice the skills you learned in this chapter by building each of these complex designs (<a href="#figure6-6" id="figureanchor6-6">Figure 6-6</a>). Be sure to use at least one <code>if</code> statement in each exercise. </p>
<figure>
<img src="image_fi/279547c06/f06006.png" alt="f06006"/>
<figcaption><p><a id="figure6-6">Figure 6-6</a>: Practice creating all of these designs.</p></figcaption></figure><div class="dottedBottom hr"><hr/></div>
</section>
</aside>
<aside epub:type="sidebar">
<div class="dottedTop hr"><hr/></div>
<section class="boxcustom2">
<h2 id="h1-279547c06-0006"><span epub:type="pagebreak" title="112" id="Page_112"/>Big Projects: Decisions</h2>
<p class="BoxBodyFirst">Practice the skills you’ve learned so far by modeling the following three projects.</p>
<h3>Random Forest</h3>
<p class="BoxBodyFirst">Generate a forest (<a href="#figure6-7" id="figureanchor6-7">Figure 6-7</a>) by using random numbers to choose from a variety of tree modules. Design each tree module to take width and height as parameters.</p>
<figure>
<img src="image_fi/279547c06/f06007.png" alt="f06007"/>
<figcaption><p><a id="figure6-7">Figure 6-7</a>: Random forest</p></figcaption></figure>
<h3>Clock</h3>
<p class="BoxBodyFirst">Design a clock that uses <code>if</code> statements to vary the design characteristics of its face markings. Try to emphasize 15-minute positions (<a href="#figure6-8" id="figureanchor6-8">Figure 6-8</a>). It may help to use nested <code>if</code> statements to apply different transformation operations to various sections of the text-based hour labels of the clock. Applying the same operations to every number won’t produce the orientations you see in <a href="#figure6-8">Figure 6-8</a>. </p>
<figure>
<img src="image_fi/279547c06/f06008.png" alt="f06008"/>
<figcaption><p><a id="figure6-8">Figure 6-8</a>: Clock</p></figcaption></figure>
<h3><span epub:type="pagebreak" title="113" id="Page_113"/>City of Random Skyscrapers</h3>
<p class="BoxBodyFirst">Extend various exercises in this chapter to generate an entire city of randomly sized skyscrapers (<a href="#figure6-9" id="figureanchor6-9">Figure 6-9</a>).</p>
<figure>
<img src="image_fi/279547c06/f06009.png" alt="f06009"/>
<figcaption><p><a id="figure6-9">Figure 6-9</a>: City of randomly sized skyscrapers</p></figcaption></figure><div class="dottedBottom hr"><hr/></div>
</section>
</aside>
</section>
</body></html>