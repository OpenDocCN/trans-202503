- en: '2'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Physical Access Hacks
  prefs: []
  type: TYPE_NORMAL
- en: '![](image_fi/book_art/chapterart.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Have you ever left your laptop unattended in a coffee shop, thinking that your
    private files would be safely protected behind a login screen? It turns out that
    anyone with physical access to your computer can gain access to your files with
    just a few keystrokes, without needing to know your login details. In this chapter,
    I’ll show you two *physical access hacks*: the *Sticky Keys hack*, used on Windows
    PCs, and the *Mac root hack*, used on Macs. Both hacks give an attacker administrator-levelaccess
    to the target computer, allowing them to steal files or change important settings.'
  prefs: []
  type: TYPE_NORMAL
- en: Physical access hacks may sound scary because they can be used maliciously by
    attackers on stolen or unattended computers. However, they also have constructive
    applications. Ethical hackers at home and at IT help desks use techniques like
    the Sticky Keys hack or the Mac root hack to recover files that would otherwise
    be lost due to a forgotten password. If you have an old computer in the garage
    or attic with family photos or other important documents that you can’t access
    because no one remembers the computer’s password, these hacks can help.
  prefs: []
  type: TYPE_NORMAL
- en: The Sticky Keys Hack
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Sticky Keys is a Windows feature that makes it easier to issue certain keyboard
    commands, like CTRL-C to copy or CTRL-V to paste, by allowing you to press the
    keys one after another instead of all at once. Sticky Keys is triggered by pressing
    SHIFT five times and can even be turned on from the Windows login screen, before
    a username or password has been entered.
  prefs: []
  type: TYPE_NORMAL
- en: For this hack, we’ll replace the Sticky Keysprogram file with another file,
    *cmd.exe*. That way, instead of launching the usual Sticky Keys assistant, pressing
    SHIFT five times will launch a *command prompt*. This is a text-based program
    that lets us enter commands directly into Windows. By launching a command prompt
    at the login screen (see [Figure 2-1](#figure2-1)), you’ll be able to add a new
    username and password, give yourself administrator-level access to the computer,
    and access the computer’s files, all without knowing the login information on
    that computer!
  prefs: []
  type: TYPE_NORMAL
- en: Since Windows 10 computers that have been updated in 2019 or later are safe
    from the Sticky Keys hack, you’ll need an older Windows computer to try out the
    hack for yourself. You’ll also need a Windows 10 installation disc or USB drive.
    To create one, follow the instructions in Appendix A.
  prefs: []
  type: TYPE_NORMAL
- en: Booting from a Windows 10 Installation Disc
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To replace the Sticky Keys program with the command prompt program, we need
    to access the hard drive that contains those program files using a Windows 10
    installation disc or USB drive. Once you’ve created an installation disc, as described
    in Appendix A, insert the disc and then restart the computer.
  prefs: []
  type: TYPE_NORMAL
- en: '![f02001](image_fi/502000c02/f02001.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 2-1: The Sticky Keys hack brings up a command prompt window instead
    of the Sticky Keys assistant.'
  prefs: []
  type: TYPE_NORMAL
- en: 'We need to tell the computer to load the operating system (OS) from the disc
    or USB drive instead of from the computer’s hard drive. To do this, we’ll access
    either the boot menu or the *Basic Input/Output System (BIOS)*, which contains
    basic settings that control your computer when it starts up. Different PC manufacturers
    and different versions of Windows cause the instructions to vary a bit, but the
    following steps combined with a little web searching will get you into most older
    Windows computers:'
  prefs: []
  type: TYPE_NORMAL
- en: On Windows computers, you press a special key to access the boot menu or BIOS.
    If your startup screen doesn’t show you which key to press just before the Windows
    startup logo appears, reboot your computer and quickly press ESC, DELETE, F8,
    F9, F10, F11, or F12 right as it begins to start up. Search online for “boot menu”
    and the specific make and model of your computer to find the right key.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If the boot menu appears, select the **Boot from DVD** or **Boot from USB**
    option to boot from the Windows installation disc you inserted, then move on to
    step 5.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'If the boot menu doesn’t appear after a few restarts, try entering the BIOS
    menu instead: turn the computer off and on again, and press DELETE, F2, F9, F10,
    F12, or ESC. Search online for “BIOS” and your computer model to find the right
    key.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once you’re inside the BIOS, find the boot options and change the order or priority
    of your boot devices (often by using your arrow keys) to make the USB or DVD the
    top option. Then save the changes and exit the BIOS.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Reboot the computer again. You should briefly see the message `Press any key
    to boot from CD or DVD` or `Press any key to boot from USB device`. Press any
    key (such as the spacebar) *immediately* to boot from your DVD or USB.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: When the Windows installation disc starts up, click **Next**▶**Repair your computer**▶**Troubleshoot**▶**Command
    Prompt**, as shown in [Figure 2-2](#figure2-2). The menu order or the option names
    might look different, but look for the Windows command prompt.![f02002a](image_fi/502000c02/f02002a.png)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Figure 2-2: Use the Windows installation disc to access the command prompt.'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Once you’ve reached the Windows command prompt (usually a black, text-based
    window), type `c:` and press **ENTER** to change to the C: drive, as shown here:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Enter the command `dir`to see a list of files and folders on the C: drive.
    Look for a folder called *Windows* (it will be marked `<DIR>`, short for *directory*).'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: This folder 1 contains the operating system files, including the command prompt
    application and the Sticky Keys program file that we need to swap out to perform
    this hack.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'If there’s no *Windows* directory on the C: drive, try the same process in
    the D: drive by entering `d:` and then `dir`. If the D: drive doesn’t have the
    *Windows* directory either, keep going through the alphabet (E:, F:, G:, and so
    on) until you find a drive containing *Windows* in its listing.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Gaining Administrator-Level Access
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Now to replace the *sethc.exe* Sticky Keys program with the *cmd.exe* command
    prompt program. Then we’ll be able to create a new administrator account on the
    computer.
  prefs: []
  type: TYPE_NORMAL
- en: 'Enter the following three commands:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: These commands enter the directory where we can find both *sethc.exe* and *cmd.exe*,
    create a backup copy of the Sticky Keys program, and replace the original Sticky
    Keys program file with a copy of the command prompt program file. This way, whenever
    the computer runs *sethc.exe*, it will open a command prompt window in place of
    the Sticky Keys program.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: After the third command, Windows will ask you if you want to overwrite *sethc.exe*.
    Enter `Y` to proceed.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Remove the Windows 10 installation DVD or USB and reboot the computer.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: When the PC boots to the login screen, press **SHIFT** five times. Instead of
    the usual Sticky Keys program, you should see a command prompt window pop up *in
    front* of the login screen, as shown in [Figure 2-3](#figure2-3).![f02003](image_fi/502000c02/f02003.png)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Figure 2-3: Opening a command prompt window'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Enter the following two commands into the command prompt window:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: The first command adds a user account named *ironman* with the password *Jarvis*
    to the Windows computer. The second command adds the *ironman* user to the list
    of local administrators. This means that when we log in as *ironman*, we’ll have
    administrator-level access to all the files on the computer.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: When you see a success message like the one in [Figure 2-4](#figure2-4), close
    the command prompt.![f02004](image_fi/502000c02/f02004.png)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Figure 2-4: We’ve successfully added a user named *ironman* as an administrator
    on this computer.'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: In addition to creating a new user account, you can also reset the password
    of an existing user from the command prompt window by entering `net` `user` followed
    by the existing username and the new password you want to set—for example, `net`
    `user` `bryson` `Thisisyournewpassword!`. However, you should never reset another
    person’s password without their permission and the permission of the computer’s
    owner.
  prefs: []
  type: TYPE_NORMAL
- en: Now You’re an Administrator. Log In!
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Congratulations! You now have access to the machine as an administrator. Go
    ahead and log in. Enter `.\ironman` as the username (or select **ironman** from
    the list of accounts, as shown in [Figure 2-5](#figure2-5)). The dot and backslash
    before `ironman` tell Windows the account is local to the computer and not stored
    on a network server. After entering the username, enter the password, `Jarvis`.
  prefs: []
  type: TYPE_NORMAL
- en: '![f02005](image_fi/502000c02/f02005.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 2-5: You can now use the *ironman* user to log in to this Windows PC.'
  prefs: []
  type: TYPE_NORMAL
- en: Since we made the *ironman* user a member of the local administrators group,
    you should have administrator-level access to *all* files and folders, including
    all users and documents in *C:\Users\*, as shown in [Figure 2-6](#figure2-6).
  prefs: []
  type: TYPE_NORMAL
- en: '![f02006](image_fi/502000c02/f02006.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 2-6: As an administrator-level user, you can see *all* users’ files,
    not just your own.'
  prefs: []
  type: TYPE_NORMAL
- en: When you click into another user’s folder for the first time, you’ll see a pop-up
    message saying you need permission to open another user’s files, as shown in [Figure
    2-7](#figure2-7). Since you’re an administrator, click **Continue** to grant yourself
    permanent access!
  prefs: []
  type: TYPE_NORMAL
- en: '![f02007](image_fi/502000c02/f02007.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 2-7: Administrators can give themselves permission to access anyone’s
    files on the same computer.'
  prefs: []
  type: TYPE_NORMAL
- en: The Sticky Keys hack works only on Windows machines. However, computers running
    macOS are vulnerable to physical access hacks as well.
  prefs: []
  type: TYPE_NORMAL
- en: The Mac Root Hack
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Like the Sticky Keys hack, the Mac root hack is a physical access attack that
    will give you administrator-level access to a computer. It makes you a *root*
    user, which is the administrator-level account on macOS computers. For this hack,
    all you need is a Mac computer. We’ll reboot the Mac in *single-user mode*, a
    troubleshooting and repair login. From there, we can change the root user’s password,
    giving us access to all the files on the computer.
  prefs: []
  type: TYPE_NORMAL
- en: Updating the Root User Settings
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To begin, the Mac needs to be completely turned off—not just asleep. If it isn’t
    off already, press and hold the power button for about six seconds.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Press the power button again while holding COMMAND-S (⌘-S) to enter single-user
    mode. You should see a text-based command line terminal window with very few features,
    as shown in [Figure 2-8](#figure2-8).![f02008](image_fi/502000c02/f02008.png)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Figure 2-8: Part of the single-user mode boot screen on a Mac'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: The terminal prompt should contain `root#` (press enter a few times if it’s
    not visible on the last line, and it should come up), indicating that we’re logged
    in to the command line as the root, or administrator, user.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Enter the following commands to mount, or connect to, the hard drive:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now connect to the Open Directory service’s property list, or *plist*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Your Mac uses Open Directory to track users, groups, file sharing, and even
    Wi-Fi printers. Think of it as a catalog of all the user accounts and permissions
    on your Mac.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'If you get an error after running the previous command, try running the following
    command instead—it’s the same as step 4, but for older Macs:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now to change the root user’s password. Enter this command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Enter a new password. You won’t see the characters of the password on the screen
    as you type. Then enter the password a second time to confirm the change. (If
    you mistype the password, start up in single-user mode again and do this same
    hack—it should reset the root user’s password every time.)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You’re the Root User Now!
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Well done! Now that you’ve changed the root user’s password to something you
    know, you can log in as the root user anytime you want. Try it out right now:
    either enter `reboot` at the command line  to reboot the computer or press the
    power button to turn the computer off and back on. When the computer boots normally
    to the Mac login screen, enter `root` as the username and type in the new password
    you’ve just set, as shown in [Figure 2-9](#figure2-9).'
  prefs: []
  type: TYPE_NORMAL
- en: '![f02009](image_fi/502000c02/f02009.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 2-9: After the Mac root hack, you can log in as the root user with the
    password you set in the hack.'
  prefs: []
  type: TYPE_NORMAL
- en: Click through any setup screens you see, and you’ll soon come to the Mac desktop.
    You should see in the menu bar at the top of the screen that you’re logged in
    as the system administrator. You now have access to all users’ files and folders
    on the Mac!
  prefs: []
  type: TYPE_NORMAL
- en: Other Physical Hacks
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: There are many physical access hacks besides the Sticky Keys hack and the Mac
    root hack. In fact, almost any bootable disc—like Ultimate Boot CD, KNOPPIX, SystemRescueCd,
    or Trinity Rescue Kit—can give you access to the files on the hard drive of a
    computer you have physical access to. There are also specially made hacking tools,
    like Rubber Ducky and Bash Bunny, that cost under $100 and look like regular USB
    drives but contain automated tools for hacking into computers. Some physical access
    hacks even use voice commands. For example, the Open Sesame! attack used Microsoft’s
    Cortana voice assistant to bypass the login screen by telling Cortana to open
    a malicious file on a USB drive or website.
  prefs: []
  type: TYPE_NORMAL
- en: Protecting Against Physical Hacks
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As you’ve seen, physical access hacks can help you recover old photos, copy
    files, and change users on almost any computer you can physically touch, even
    without the original password. However, that means anyone who has physical access
    and knows these hacks can access *your* private files and information too! That’s
    why it’s important to keep your devices with you or locked away in a secure area.
  prefs: []
  type: TYPE_NORMAL
- en: If someone manages to get access to your computer, however, there are a few
    ways to protect your data. One is to set a *firmware password*, also called a
    *BIOS password* or *EFI password*. This option on Macs and most PCs can prevent
    attackers from tampering with your computer’s BIOS/UEFI settings, neutralizing
    hacks like the Sticky Keys hack and Mac root hack. Unfortunately, firmware passwords
    are only one layer of defense and can often be bypassed. For example, motivated
    attackers can remove a battery from the circuit board in your computer, thereby
    erasing the stored firmware password on most PCs.
  prefs: []
  type: TYPE_NORMAL
- en: A surer bet is to *encrypt* your files, scrambling them into an unreadable form
    that can only be *unencrypted* (unscrambled) with a password. The encryption password
    is different from your computer’s login password, so an attacker can’t see what’s
    inside your encrypted files by changing your user password with the Sticky Keys
    or Mac root hack. We’ll discuss encryption in more detail in Chapter 11.
  prefs: []
  type: TYPE_NORMAL
- en: The Takeaway
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this chapter, you saw how to use the Windows Sticky Keys hack and Mac root
    hack to gain administrator-level access to all the files and user accounts on
    a computer, even when you don’t know the username and password. You also learned
    that there are other physical hacks and some specialized tools, like Rubber Ducky
    and Bash Bunny, that make physical hacks even easier. While you can use these
    hacks to recover lost files or reset a forgotten password, you also discovered
    that an attacker with physical access to your computer can often gain access to
    every bit of your information. You can defend against these hacks by limiting
    who has access to your computer, setting a firmware password, and encrypting your
    files.
  prefs: []
  type: TYPE_NORMAL
- en: Now that you understand the importance of physical security, it’s time to start
    thinking about other attacks that can put your computer in danger—malicious websites,
    phishing and infected email attachments, and even attacks on the internet-connected
    smart devices in your daily life. To be able to practice these other types of
    hacks safely, and to learn to defend against them, you’ll set up your own private
    virtual hacking lab in Chapter 3.
  prefs: []
  type: TYPE_NORMAL
