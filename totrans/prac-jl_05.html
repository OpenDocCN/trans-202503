<html><head></head><body>
<h2 class="h" id="ch04"><span epub:type="pagebreak" id="page_83" class="calibre1"/><strong class="calibre2"><span class="big">4</span><br class="calibre3"/>THE PLOTTING SYSTEM</strong></h2>
<div class="bq">
<p class="center"><em class="calibre11">There is nothing worse than a sharp image of a fuzzy concept.</em></p>
<p class="center1">—Ansel Adams</p>
</div>
<div class="image"><img alt="Image" src="../images/common.jpg" class="calibre6"/></div>
<p class="noindent">This chapter introduces the large and rich subject of visualization in Julia. Plots and diagrams play a role in scientific communication equal in importance to words and equations. Julia’s plotting ecosystem is diverse and powerful; you’ll be able to craft a solution to any type of visualization challenge without leaving the language. The ability to keep both your calculation and its visualization within a single program simplifies the process of exploring and reporting results.</p>
<p class="indent">Plotting in Julia is a hotspot of rapid development. This is mostly good, as it means new features and packages arise regularly. The downside, however, is a higher than average incidence of conflicts among packages, incomplete documentation, and bugs, exacerbated by the frequent need for plotting routines to depend on external graphics libraries. With this in mind, I’ve confined the treatment in this chapter to packages that seem to be stable <span epub:type="pagebreak" id="page_84"/>and mature. The examples here should work over the long term. I’ve avoided discussing some potentially useful packages that still have too many rough edges.</p>
<h3 class="h2" id="ch04lev1"><strong class="calibre2">Plots</strong></h3>
<p class="noindent">The main, and in a sense “official,” plotting package for Julia is <span class="literal">Plots</span>. Later in the book we’ll explore other graphical methods, but this chapter is about the package at the center of Julia’s visualization universe.</p>
<p class="indent"><span class="literal">Plots</span> is not in the standard library, so we need to install it in the package manager with <span class="codestrong1">add Plots</span>. The initial installation will take some time, as <span class="literal">Plots</span> has many dependencies, all of which need to be (automatically) installed as well. Precompilation of this assortment of packages will take a few minutes.</p>
<p class="indent"><span class="literal">Plots</span> is a unique approach to providing a programming language with plotting abilities. It’s often described as a plotting <em class="calibre11">metapackage</em>, because <span class="literal">Plots</span> doesn’t do any actual plotting on its own. Rather, it orchestrates the creation of visualizations by calling on a choice of <em class="calibre11">backends</em>.</p>
<h3 class="h2" id="ch04lev2"><strong class="calibre2">The Backend System</strong></h3>
<p class="noindent">The backend is the package that actually draws the picture. Each backend has particular strengths and weaknesses, and is suitable for a different type of application. The job of <span class="literal">Plots</span> is to provide a unified interface to all of the backends and to apply a degree of intelligence in translating our plotting call into a form that the backend can understand. It tries to figure out what we mean and how to produce the plot we want.</p>
<p class="indent">The advantage of using a plotting metapackage is that we can change the backend used in a program without having to change the plotting commands. During research, we may want to have a simulation code produce rough plots directly in the terminal or 3D plots that we can rotate with the mouse. Later, we may want to run the simulation again, but this time save publication-quality plots to disk. With the <span class="literal">Plots</span> system, we can accomplish that by simply changing one line of code that selects a different backend.</p>
<p class="indent">Some of <span class="literal">Plots</span>’s backends are automatically installed when we install the package, but we’ll need to install others manually, as separate packages (these are subject to change, but we’ll be prompted to install a missing backend when we try to use it). When we <span class="literal">add</span> the <span class="literal">Plots</span> package, one backend that always comes along for the ride is the default backend. Recently this default has been <span class="literal">GR</span>, a reasonably fast and featureful plotting engine. To see the list of available backends, execute the <span class="codestrong1">backends()</span> function in the REPL. To see the currently active backend, execute the <span class="codestrong1">backend()</span> function.</p>
<p class="indent">To activate a backend, we use the appropriate name that <span class="literal">backends()</span> returns to form a function and simply call it. If it’s installed, the function responds by confirming the name of the package. If not, we’ll get an error message explaining that we need to <span class="literal">add</span> it.</p>
<p class="indent">Here is part of a REPL session showing the process:<span epub:type="pagebreak" id="page_85"/></p>
<pre class="calibre13">   julia&gt; <span class="codestrong">using Plots</span>

<span class="ent">➊</span> julia&gt; <span class="codestrong">backends()</span>
   10-element Vector{Symbol}:
    :pyplot
    :unicodeplots
    :plotly
    :plotlyjs
    :gr
    :pgfplo
    :pgfplotsx
    :inspectdr
    :hdf5
    :gaston

<span class="ent">➋</span> julia&gt; <span class="codestrong">backend()</span>
   Plots.GRBackend()

<span class="ent">➌</span> julia&gt; <span class="codestrong">unicodeplots()</span>
   Plots.UnicodePlotsBackend()

   julia&gt; <span class="codestrong">hdf5()</span>
   ERROR: ArgumentError: Package HDF5 not found in current path:
   - Run `import Pkg; Pkg.add("HDF5")` to install the HDF5 package.

<span class="ent">➍</span> (@v1.6) pkg&gt; <span class="codestrong">add HDF5</span>
      Resolving package versions...
       Updating `~/.julia/environments/v1.6/Project.toml`
     [f67ccb44] + HDF5 v0.15.6
     No Changes to `~/.julia/environments/v1.6/Manifest.toml`

   julia&gt; <span class="codestrong">hdf5()</span>
   Plots.HDF5Backend()

   julia&gt; <span class="codestrong">backend()</span>
   Plots.HDF5Backend()</pre>
<p class="indent">Asking for available backends <span class="ent">➊</span> returns a list in the form of a <span class="literal">Vector</span> of <span class="literal">Symbol</span>s, indicated by the leading colons. “Symbols and Metaprogramming” on <a href="ch06.xhtml#ch06lev3" class="calibre10">page 167</a> will explain the <span class="literal">Symbol</span> data type, but for now, think of it as a string.</p>
<p class="indent">Asking for the current backend <span class="ent">➋</span> returns <span class="literal">Plots.GRBackend()</span>. The multiple names for each backend is somewhat confusing, as the capitalized form used to refer to a package differs from the lowercase form used to activate it. The form that <span class="literal">backend()</span> returns isn’t used for anything.</p>
<p class="indent"><span epub:type="pagebreak" id="page_86"/>The next move is to make <span class="literal">UnicodePlots</span> the current backend <span class="ent">➌</span>; the operation was confirmed. Then we change our mind and decide to plot with HDF5, but our attempt to switch to it gives us an error because it’s not in the load path. Apparently we never added it to the environment. After adding HDF5 in package mode <span class="ent">➍</span>, we switch to it and call <span class="literal">backend()</span> to confirm.</p>
<p class="indent">The package system doesn’t consider the various backends to be dependencies of <span class="literal">Plots</span>. This was a deliberate choice to spare users from having to install all of the backends when installing <span class="literal">Plots</span>, as there are many of them, and most users will need only a modest subset. This creates occasional incompatibilities, however, as <span class="literal">Plots</span> and its various backends evolve, since the package system cannot automatically keep them in sync. If something doesn’t work, try a different backend if possible; otherwise, search the web and the resources in “Further Reading” on <a href="ch04.xhtml#fur4" class="calibre10">page 121</a> for a resolution.</p>
<h3 class="h2" id="ch04lev3"><strong class="calibre2">Modes of Interaction with Plots</strong></h3>
<p class="noindent">If you are following along in Pluto, you can enter each plotting command in a new cell and produce a sequence of figures embedded in the page. If you’re using the REPL, each plot should reuse the display window opened by the first, replacing the existing plot. If you want to close that window, use the statement <span class="literal">closeall()</span>. Closing it using your window manager sometimes leads to errors in the REPL, a known bug.</p>
<p class="indent">If you’re saving plot commands in a program file, you may have noticed that you don’t see any output when you run it. First, you need to include the statement <span class="literal">gui()</span> at the point in the program where you want to display the current state of the plot. However, the plot window thus created will vanish when the program exits, perhaps so quickly that you may not be able to see the window at all. You need to make the program pause until you’re done admiring your plot. One way is to insert the <span class="literal">readline()</span> statement directly after <span class="literal">gui()</span>. This statement waits for input at the terminal. When you’re ready to dismiss the plot window, simply press <small class="calibre5">RETURN</small> and it will vanish, and the program will continue.</p>
<h3 class="h2" id="ch04lev4"><strong class="calibre2">2D Plots</strong></h3>
<p class="noindent">The term <em class="calibre11">2D plot</em> refers to a variety of visualizations involving maps between two variables. The basic type, a <em class="calibre11">line plot</em>, takes the form of a curve, or set of curves, for functions of a single variable, where typically the independent variable is represented by the horizontal x-axis and the dependent variable by the vertical y-axis in a rectangular coordinate system. The <em class="calibre11">polar coordinate plot</em> maps an angle to the distance from some origin, in a polar coordinate system. A third common type is a <em class="calibre11">parametric plot</em>, where both variables depend on a third variable, called the parameter. These three basic types, along with other varieties such as bar and pie charts and scatterplots, are all called <em class="calibre11">two-dimensional plots</em>, and they are all handled by the <span class="literal">plot()</span> function provided by the <span class="literal">Plots</span> package and understood by all of its backends.</p>
<p class="indent"><span epub:type="pagebreak" id="page_87"/>For the examples in this section, any backend will work, but I suggest sticking with the default setup when you execute <span class="literal">using Plots</span>. This will always be a relatively stable and performant engine that displays color plots either in a new window when using the REPL, or on the page when using Pluto or VS Code. In all of the examples in this chapter, <span class="literal">using Plots</span> is assumed.</p>
<p class="indent">The <span class="literal">plot()</span> function accepts arguments of various kinds, and, as mentioned previously, usually does what we expect. It returns a result in the form of a plot object. In the REPL, a notebook interface such as Pluto, or another interactive environment, it immediately displays the plot, unless we suppress the output by following the call with a semicolon. We can display the plot later with a call to <span class="literal">gui()</span> or by storing the plot object in a variable and simply evaluating it.</p>
<h4 class="h3" id="ch04lev1sec1"><strong class="calibre2"><em class="calibre4">Plotting from Vectors</em></strong></h4>
<p class="noindent">We can call the function with a single <span class="literal">Vector</span> argument:</p>
<pre class="calibre13">julia&gt; <span class="codestrong">gr()</span>
Plots.GRBackend()

julia&gt; <span class="codestrong">plot([0, 3, 1, 4, 1])</span></pre>
<p class="indent">This plots the numbers in the <span class="literal">Vector</span>, in order, against an independent variable that gives their index. <a href="ch04.xhtml#ch4fig1" class="calibre10">Figure 4-1</a> shows the plot.</p>
<div class="image1"><img alt="Image" id="ch4fig1" src="../images/ch04fig01.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-1: Plotting a single vector</em></p>
<p class="indent">We get a legend, which at the moment is not very informative. We’ll learn shortly how to adjust this, and change other things about the graph, but first let’s look at the different ways we can use <span class="literal">plot()</span>.<span epub:type="pagebreak" id="page_88"/></p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre11">I’ve created grayscale versions of all the examples in this chapter for printing, but the original color output from each plot command is available from the book’s supplementary website at</em> <a href="https://julia.lee-phillips.org" class="calibre10">https://julia.lee-phillips.org</a><em class="calibre11">.</em></p>
</div>
<p class="indent">The second form supplies both <em class="calibre11">x</em>- and <em class="calibre11">y</em>-variables, with two <span class="literal">Vector</span>s:</p>
<pre class="calibre13">julia&gt; <span class="codestrong">plot([0, 0.13, 0.38, 0.88, 1.88], [0, 3, 1, 4, 1])</span></pre>
<p class="indent">The result (<a href="ch04.xhtml#ch4fig2" class="calibre10">Figure 4-2</a>) shows the same <em class="calibre11">y</em>-values plotted at different horizontal locations.</p>
<div class="image1"><img alt="Image" id="ch4fig2" src="../images/ch04fig02.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-2: Plotting a vector versus another vector</em></p>
<h4 class="h3" id="ch04lev1sec2"><strong class="calibre2"><em class="calibre4">Plotting Functions</em></strong></h4>
<p class="noindent">To plot a function, we can supply a vector as the first argument and a second vector created by broadcasting the function over the first argument (see “Broadcasting” on <a href="ch02.xhtml#ch02lev1sec13" class="calibre10">page 51</a>):</p>
<pre class="calibre13">julia&gt; <span class="codestrong">f(x) = sin(1/x)</span>
f (generic function with 1 method)

julia&gt; <span class="codestrong">x = π/1000</span>:π<span class="codestrong">/1000:</span>π
0.0031415926535897933:0.0031415926535897933:3.14

julia&gt; <span class="codestrong">plot(x, f.(x))</span></pre>
<p class="indent">In this example we first create a function, <span class="literal">f()</span>, using the succinct one-line function definition syntax. Next we define a range and store it in <span class="codeitalic1">x</span>; the range <span epub:type="pagebreak" id="page_89"/>excludes <span class="literal">0</span> to avoid the singularity there. The <span class="literal">plot()</span> command has two <span class="literal">Vector</span> arguments, as before. The range is instantiated into a <span class="literal">Vector</span> and the dot after <span class="literal">f()</span> broadcasts the function over <span class="literal">x</span>, returning a <span class="literal">Vector</span> for the dependent variable. <a href="ch04.xhtml#ch4fig3" class="calibre10">Figure 4-3</a> shows the result.</p>
<div class="image1"><img alt="Image" id="ch4fig3" src="../images/ch04fig03.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-3: A plot of a function broadcast over a vector</em></p>
<p class="indent">We can see the plot becoming inaccurate as we approach the origin and the π<span class="literal">/1000</span> resolution fails to keep up with the rapid oscillations in that region.</p>
<p class="indent">The <span class="literal">plot()</span> function and its comrades offer a convenient shorthand. Instead of supplying the second argument as a broadcast expression that explicitly creates a vector, we can simply write the name of a function, or construct an anonymous function. The <span class="literal">plot()</span> function will broadcast the function we name over the independent variable vector that we pass in the first argument.</p>
<p class="indent">In other words, we can write <span class="literal">plot(x, f.(x))</span> as simply <span class="literal">plot(x, f)</span>. If we had not already defined <span class="literal">f()</span>, we could insert an anonymous function directly as <span class="literal">plot(x, s -&gt; sin(1/s))</span>. These three ways of calling <span class="literal">plot()</span> are all equivalent.</p>
<p class="indent">We can even leave out the independent variable and supply only a function name or an anonymous function. In this case, <span class="literal">plot()</span> will plot the function for us, choosing the locations of the independent variable and handling singularities automatically. We can supply a domain on the horizontal axis using a second and third argument, with default values of –5 and 5. If we use a <span class="literal">Vector</span> of functions in the first argument, we’ll get a plot of all of them on the same axes. Using the same definition for <span class="literal">f</span>, executing <span class="literal">plot([sin, cos, f], -</span>π<span class="literal">,</span> π<span class="literal">)</span> produces <a href="ch04.xhtml#ch4fig4" class="calibre10">Figure 4-4</a>.<span epub:type="pagebreak" id="page_90"/></p>
<div class="image1"><img alt="Image" id="ch4fig4" src="../images/ch04fig04.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-4: Plotting three functions</em></p>
<p class="indent">In this use of <span class="literal">plot()</span>, we supply the names of the functions. We’re not <em class="calibre11">calling</em> these functions, so we omit the parentheses. Plotting is a common application for anonymous functions (see “Creating Anonymous Functions” on <a href="ch02.xhtml#ch02lev1sec12" class="calibre10">page 51</a>). This is their purpose: to pass a function as an argument to another function, in this case <span class="literal">plot()</span>.</p>
<h4 class="h3" id="ch04lev1sec3"><strong class="calibre2"><em class="calibre4">Plotting Vectors of Vectors or Functions</em></strong></h4>
<p class="noindent">If we supply vectors of vectors in the first two argument positions, <span class="literal">plot()</span> will cycle through both arguments, reusing elements as necessary. For example, if we call <span class="literal">plot([x1, x2], [y1, y2])</span>, we’ll get a plot of <span class="literal">y1</span> versus <span class="literal">x1</span> and <span class="literal">y2</span> versus <span class="literal">x2</span>, both on the same set of axes. But if we call <span class="literal">plot(x1, [y1, y2])</span>, we’ll get a plot of <span class="literal">y1</span> versus <span class="literal">x1</span> and <span class="literal">y2</span> versus <span class="literal">x1</span>. If we call <span class="literal">plot([x1, x2], y1)</span>, we’ll see <span class="literal">y1</span> versus <span class="literal">x1</span> and <span class="literal">y1</span> versus <span class="literal">x2</span>.</p>
<p class="indent">We’ll get the same results if we use horizontal concatenation; in other words, <span class="literal">plot([x1, x2], [y1, y2])</span> produces the same plot as <span class="literal">plot([x1 x2],</span> <span class="literal">[y1 y2])</span>. When given <span class="literal">Matrix</span> arguments, <span class="literal">plot()</span> plots by columns. We can even call <span class="literal">plot([x1, x2], [y1 y2])</span>, mixing a vector of vectors with a matrix, and <span class="literal">plot()</span> will know what we mean and draw the same graph as in the two preceding examples.</p>
<p class="indent">If we use <em class="calibre11">vertical</em> concatenation, we will simply create longer vectors. We can use this to plot different functions over different ranges:</p>
<pre class="calibre13">julia&gt; <span class="codestrong">x = 0:5π/1000:5π</span>
julia&gt; <span class="codestrong">plot([x; 5π .+ x], [sin.(x); -exp.(-x .* 0.2) .* sin.(x)])</span></pre>
<p class="indent">In this example, we join the <span class="literal">x</span> vector to itself shifted to the right by 5π and supply the result as the independent variable. Against that, we plot a <span class="literal">sin</span> <span epub:type="pagebreak" id="page_91"/>function joined to the same function multiplied by a decaying exponential (note the use of broadcast notation throughout). <a href="ch04.xhtml#ch4fig5" class="calibre10">Figure 4-5</a> shows the result.</p>
<div class="image1"><img alt="Image" id="ch4fig5" src="../images/ch04fig05.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-5: Joining vectors to model a damped oscillation</em></p>
<p class="indent">The graph can be interpreted as an initially frictionless oscillation with damping applied at <em class="calibre11">x</em> = 5π.</p>
<h4 class="h3" id="ch04lev1sec4"><strong class="calibre2"><em class="calibre4">Displaying and Mutating</em></strong></h4>
<p class="noindent">I mentioned earlier that we cause the display of a plot in a program file with the call <span class="literal">gui()</span>. But how does the <span class="literal">gui()</span> function know what plot to display? The plotting system maintains a <em class="calibre11">current plot</em> in the global namespace, along with other settings and state related to the display of graphics. This is convenient during interactive plotting, as it allows us to incrementally adjust and add things to the current plot by mutating it. The mutating version of <span class="literal">plot()</span> is <span class="literal">plot!()</span>, following the convention (see “Functions That Mutate Their Arguments” on <a href="ch02.xhtml#ch02lev1sec17" class="calibre10">page 56</a>).</p>
<p class="indent">Using mutation, we can produce <a href="ch04.xhtml#ch4fig4" class="calibre10">Figure 4-4</a> with these three lines:</p>
<pre class="calibre13">julia&gt; <span class="codestrong">plot(sin,</span> -π<span class="codestrong">,</span> π<span class="codestrong">)</span>


julia&gt; <span class="codestrong">plot!(cos)</span>


julia&gt; <span class="codestrong">plot!(f)</span></pre>
<p class="indent">The <span class="literal">plot!()</span> function maintains the domain established in the first call. We can use the mutating form to change many aspects of the plot, in addition to adding curves.</p>
<p class="indent"><span epub:type="pagebreak" id="page_92"/>The <span class="literal">plot()</span> and <span class="literal">plot!()</span> functions return plot objects, which we can assign to variables. The reason we see a plot when we call the function in the REPL or in a notebook is that Julia calls <span class="literal">gui()</span> automatically in interactive contexts whenever a plot object is returned from an expression. If we’ve assigned some plots to variables, anytime we want to see one, we can simply type its name in the REPL and press <small class="calibre5">RETURN</small>. In a program file, we can supply the plot object as an argument to <span class="literal">gui()</span>.</p>
<p class="indent">If we give <span class="literal">plot!()</span> a plot object as its first argument, it will mutate that plot instead of the current plot. For example, if we execute <span class="literal">ps = plot(sin)</span>, then <span class="literal">ps</span> is a plot of the <span class="literal">sin()</span> function. A call to <span class="literal">plot!(ps, cos)</span> will do two things: it will mutate <span class="literal">ps</span>, adding a <span class="literal">cos()</span> curve to it, and it will return the result, so that the altered plot pops up on the screen. Making the same call using the non-mutating version, <span class="literal">plot()</span>, will display the plot with both curves, but won’t alter <span class="literal">ps</span>.</p>
<p class="indent">We can supply any number of plot objects as arguments to <span class="literal">plot()</span>, and it will arrange them automatically into a grid. See “Layouts” on <a href="ch04.xhtml#ch04lev12" class="calibre10">page 117</a> for details on how to get more control over this arrangement.</p>
<p class="indent">This REPL session creates several plots and then combines them:</p>
<pre class="calibre13">julia&gt; <span class="codestrong">parabola = plot(x -&gt; x^2);</span>


julia&gt; <span class="codestrong">ps = plot(sin, 0, 2π);</span>


julia&gt; <span class="codestrong">plot!(ps, cos);</span>


julia&gt; <span class="codestrong">plot(ps, plot(f), plot(s -&gt; s^3), parabola)</span></pre>
<p class="indent">All the lines end with a semicolon except the last, where we want to see the plot. First we give the variable <span class="literal">parabola</span> the value of a plot object depicting a parabola, constructed with an anonymous function. The value of the variable is now a data type representing a complete plot, with axes, tick marks, and so on. We don’t specify a domain, so the parabola is plotted from –5 to 5.</p>
<p class="indent">Then we assign <span class="literal">ps</span> to a plot of the <span class="literal">sin</span> function, this time with a domain from 0 to 2π.</p>
<p class="indent">Next we decide we would like <span class="literal">ps</span> to also contain a <span class="literal">cos</span> curve, so we change it; <span class="literal">plot!()</span> will keep the existing domain.</p>
<p class="indent">The final line creates the plot shown in <a href="ch04.xhtml#ch4fig6" class="calibre10">Figure 4-6</a>.<span epub:type="pagebreak" id="page_93"/></p>
<div class="image1"><img alt="Image" id="ch4fig6" src="../images/ch04fig06.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-6: Plotting four plot objects</em></p>

<p class="indent">We call <span class="literal">plot()</span> with four plot-object arguments. The first and last are the two plot-holding variables, the second is a plot object created directly with a <span class="literal">plot()</span> function on the previous <span class="literal">f</span> function, and the third uses an anonymous function.</p>
<h4 class="h3" id="ch04lev1sec5"><strong class="calibre2"><em class="calibre4">Creating Parametric Plots</em></strong></h4>
<p class="noindent">Parametric plots in the plane are also classified with 2D plots because there is one independent variable, now called the <em class="calibre11">parameter</em>. In this type of plot, <em class="calibre11">x</em> and <em class="calibre11">y</em> both depend on the parameter. If we pass two arguments that are both functions to <span class="literal">plot()</span>, it recognizes this as the signature for a parametric plot and produces a graph with the <em class="calibre11">x</em>-dependence given by the first function and the <em class="calibre11">y</em>-dependence given by the second (where, as usual, <em class="calibre11">x</em> is plotted on the horizontal axis and <em class="calibre11">y</em> on the vertical). We must specify the domain for the parameter with two additional arguments; however, there is no default as when plotting non-parametric functions.</p>
<p class="indent">Parametric plotting allows us to render various complex shapes and such plots as circles and spirals, as shown in <a href="ch04.xhtml#ch4fig7" class="calibre10">Figure 4-7</a>.<span epub:type="pagebreak" id="page_94"/></p>
<div class="image1"><img alt="Image" id="ch4fig7" src="../images/ch04fig07.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-7: Two parametric plots</em></p>
<p class="indent">The left-hand plot is produced with the call <span class="literal">circle = plot(sin, cos, 0, 2</span>π<span class="literal">)</span> and the spiral in the right-hand plot is created by <span class="literal">spiral = plot(r -&gt; r*sin(r),</span> <span class="literal">r -&gt; r*cos(r), 0, 8</span>π<span class="literal">)</span>. We draw the composite figure by calling <span class="literal">plot(circle,</span> <span class="literal">spiral)</span>.</p>
<p class="indent">As in the case of regular function plotting, the independent variable, in this case the parameter, can be implicit, as in the call we used to draw the circle. When the functions to be plotted are too complex to allow this, as in the spiral example, we must employ a dummy variable, which we named <span class="literal">r</span> in this case.</p>
<h4 class="h3" id="ch04lev1sec6"><strong class="calibre2"><em class="calibre4">Making Polar Plots</em></strong></h4>
<p class="noindent">A polar plot uses the conventional polar coordinate system rather than a rectangular coordinate system. The independent variable is the angle, measured counterclockwise from the horizontal axis, and the dependent variable is the distance from the origin.</p>
<p class="indent"><a href="ch04.xhtml#ch4fig8" class="calibre10">Figure 4-8</a> shows two simple plots in polar coordinates. The <span class="literal">plot()</span> function renders the coordinate grid to reflect the symmetry of the polar geometry.</p>
<div class="image1"><span epub:type="pagebreak" id="page_95"/><img alt="Image" id="ch4fig8" src="../images/ch04fig08.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-8: Two polar plots</em></p>
<p class="indent">We created the plot on the left with <span class="literal">plot(0:2</span>π<span class="literal">/500:2</span>π<span class="literal">, t -&gt; 1 + 0.2*sin(8t); proj=:polar)</span> and the spiral on the right with <span class="literal">plot(0:8</span>π<span class="literal">/200:8</span>π<span class="literal">, t -&gt; t; proj=: polar)</span>. The first arguments in these calls are arrays of angular coordinates, and the second arguments are functions mapping the angle to the distance from the origin, using <span class="literal">t</span> as a dummy variable. The argument <span class="literal">proj=:polar</span> tells <span class="literal">plot()</span> to make a polar plot. This is a keyword argument, as explained in “Optional and Keyword Arguments” on <a href="ch04.xhtml#ch04lev5" class="calibre10">page 96</a>.</p>
<h4 class="h3" id="ch04lev1sec7"><strong class="calibre2"><em class="calibre4">Making Scatterplots</em></strong></h4>
<p class="noindent">The 2D plots we’ve seen so far draw a continuous line through a set of points. Sometimes we need to plot a collection of dots or other markers, each at a particular (<em class="calibre11">x</em>, <em class="calibre11">y</em>) position: a <em class="calibre11">scatterplot</em>. The <span class="literal">scatter()</span> function works identically to the <span class="literal">plot()</span> function, but it draws point collections rather than curves.</p>
<p class="indent">As an example application, suppose we wanted to visualize the output of the iterated map:</p>

<div class="image"><img alt="Image" src="../images/math95.jpg" class="calibre6"/></div>
<p class="noindent">This simple map produces a fascinating variety of patterns with an unpredictable dependence on <em class="calibre11">a</em>. The Julia version is:</p>
<pre class="calibre13">julia&gt; <span class="codestrong">function ginger(x, y, a)</span>
           <span class="codestrong">x2 = 1.0 - y + a*abs(x)</span>
           <span class="codestrong">y2 = x</span>
           <span class="codestrong">x2, y2</span>
       <span class="codestrong">end</span></pre>
<p class="indent">I’ve named it after the common nickname for the map: the <em class="calibre11">gingerbread man</em>.</p>
<p class="indent"><span epub:type="pagebreak" id="page_96"/>We’ll store the sequence of values in two vectors, <span class="literal">x</span> and <span class="literal">y</span>, initialized with the starting coordinates, and iterate 4,000 times:</p>
<pre class="calibre13">julia&gt; <span class="codestrong">x = [20.0]; y = [9.0];</span>
julia&gt; <span class="codestrong">for i in 1:4000</span>
        <span class="ent">➊</span> <span class="codestrong">x2, y2 = ginger(x[end], y[end], 1.76)</span>
           <span class="codestrong">push!(x, x2)</span>
           <span class="codestrong">push!(y, y2)</span>
       <span class="codestrong">end</span></pre>
<p class="indent">The listing uses a form of <em class="calibre11">destructuring</em> <span class="ent">➊</span>. The <span class="literal">ginger()</span> function returns a tuple with its first member stored in <span class="literal">x2</span> and its second in <span class="literal">y2</span>.</p>
<p class="indent">After running this loop, we can see what’s in <span class="literal">x</span> and <span class="literal">y</span> with a scatterplot. The call <span class="literal">scatter(x, y; ms=0.5, legend=false)</span> produces the plot shown in <a href="ch04.xhtml#ch4fig9" class="calibre10">Figure 4-9</a>.</p>
<div class="image1"><img alt="Image" id="ch4fig9" src="../images/ch04fig09.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-9: The gingerbread man iterated map</em></p>
<p class="indent">In the call to <span class="literal">scatter()</span>, after the <span class="literal">x</span> and <span class="literal">y</span> arguments, we add something new after a semicolon. These two <em class="calibre11">optional keyword arguments</em> affect the plot’s appearance, as explained in the next section.</p>
<h3 class="h2" id="ch04lev5"><strong class="calibre2">Optional and Keyword Arguments</strong></h3>
<p class="noindent">In a function definition, we can supply default values for arguments. Doing so makes those arguments <em class="calibre11">optional</em>, as the user can call the function without using them:<span epub:type="pagebreak" id="page_97"/></p>
<pre class="calibre13">julia&gt; <span class="codestrong">g(x, y=2) = x + y</span>
g (generic function with 2 methods)

julia&gt; <span class="codestrong">g(4)</span>
6

julia&gt; <span class="codestrong">g(4, 9)</span>
13</pre>
<p class="indent">In this example, the definition of <span class="literal">g()</span> includes the default value of <span class="literal">2</span> for <span class="literal">y</span>. If we call it with no second argument, it returns <span class="literal">x + 2</span>. When we do supply a second argument, it uses that instead.</p>
<p class="indent">So far we’ve learned how to define and call functions with <em class="calibre11">positional arguments</em>. Values are assigned based on the order in which we put them in the argument list when calling the function, whether they’re optional or not.</p>
<p class="indent">Julia also has <em class="calibre11">keyword arguments</em>, identified by name rather than position. Unlike some other languages, we must make a distinction when defining a function between its positional and keyword arguments; we separate them with a semicolon, as in this example:</p>
<pre class="calibre13">   julia&gt; <span class="codestrong">p(x; y=2) = x + y</span>
   p (generic function with 1 method)

<span class="ent">➊</span> julia&gt; <span class="codestrong">p(4)</span>
   6

   julia&gt; <span class="codestrong">p(4, 5)</span>
   ERROR: MethodError: no method matching p(::Int64, ::Int64)
   Closest candidates are:
     p(::Any; y) at REPL[346]:1

   julia&gt; <span class="codestrong">p(4; y=5)</span>
   9</pre>
<p class="indent">Here we define <span class="literal">p()</span> to have one positional argument and one keyword argument, named <span class="literal">y</span>, with the default value of <span class="literal">2</span>. We can call <span class="literal">p()</span> omitting the keyword argument <span class="ent">➊</span>, because the default makes it optional. If we supply two positional arguments, that returns an error because the function takes only one. Make sure you understand the difference between the functions <span class="literal">g()</span> and <span class="literal">p()</span>: they differ only in their function signatures.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre11">When calling a function we have the option to use a comma instead of a semicolon because there’s no chance of ambiguity; however, the semicolon is required in function definitions.</em></p>
</div>
<p class="indent">The plotting functions in the <span class="literal">Plots</span> ecosystem use positional arguments for data or functions and keyword arguments for setting plot options. Because all the plot options have default values, we haven’t had to use them until now.<span epub:type="pagebreak" id="page_98"/></p>
<h3 class="h2" id="ch04lev6"><strong class="calibre2">Basic Plot Settings</strong></h3>
<p class="noindent">To adjust a plot’s appearance, we use keyword arguments. There are four components that can make up a visualization made with the <span class="literal">Plots</span> package, and each one has a collection of settings that applies to it.</p>
<p class="indent">These four components are <em class="calibre11">plot</em>, <em class="calibre11">subplot</em>, <em class="calibre11">axis</em>, and <em class="calibre11">series</em>. Plots can contain subplots, and either of those can contain axes or series.</p>
<p class="indent">The overall illustration is called the plot; it contains other plots, the subplots, when there are more than one, as in <a href="ch04.xhtml#ch4fig6" class="calibre10">Figure 4-6</a>. Settings such as an overall title and background color apply to the plot.</p>
<p class="indent">Within a plot, each subplot can have its own title, background color, margin, and many other settings.</p>
<p class="indent">The actual curves or other visualizations of functions or data are the series, and a subplot can contain many series.</p>
<p class="indent">Each subplot contains an axis object. Its settings determine such things as whether the coordinate axes are drawn with arrows, the color of tick labels, or the numbers on the coordinate axes.</p>
<p class="indent">For the most part, we can simply use the appropriate keyword to set the desired <em class="calibre11">attribute</em> of our visualization, and the plotting system will apply it where it makes sense. But when designing complicated visualizations, we sometimes need to target specific components.</p>
<p class="indent">The official plotting system documentation at <a href="https://docs.juliaplots.org/stable/" class="calibre10"><em class="calibre11">https://docs.juliaplots.org/stable/</em></a> contains the complete list of attributes for all components, as well as which attributes are supported by which backends. The following list provides the most important ones and gives examples of their effects:</p>
<h4 class="h4a" id="ch04lev1sec1a"><strong class="calibre2">Titles</strong></h4>
<ul class="calibre12">
<li class="noindent1">Overall title: <span class="literal">plot_title</span></li>
<li class="noindent1">Title for subplot: <span class="literal">title</span></li>
<li class="noindent1">Title for legend: <span class="literal">legendtitle</span></li></ul>
<h4 class="h4a" id="ch04lev1sec1b"><strong class="calibre2">Other labels</strong></h4>
<ul class="calibre12">
<li class="noindent1">Legend text: <span class="literal">label</span></li>
<li class="noindent1">Legend existence and position: <span class="literal">legend</span></li>
<li class="noindent1">Axis labels: <span class="literal">[x,y]guide</span></li>
<li class="noindent1">Label anywhere: <span class="literal">annotation=(x, y, "Text")</span></li>
</ul>
<h4 class="h4a" id="ch04lev1sec1c"><strong class="calibre2">Font colors</strong></h4>
<ul class="calibre12">
<li class="noindent1">Overall title: <span class="literal">plot_titlefontcolor</span></li>

<li class="noindent1">Subplot title: <span class="literal">titlefontcolor</span></li>

<li class="noindent1">Legend: <span class="literal">legendfontcolor</span></li>

<li class="noindent1">Axis labels: <span class="literal">[x,y]guidefontcolor</span></li></ul>
<h4 class="h4a" id="ch04lev1sec1d"><span epub:type="pagebreak" id="page_99" class="calibre1"/><strong class="calibre2">Area colors</strong></h4>
<ul class="calibre12">
<li class="noindent1">Margin area: <span class="literal">background_outside</span></li>

<li class="noindent1">Plot area only: <span class="literal">background_inside</span></li></ul>
<h4 class="h4a" id="ch04lev1sec1e"><strong class="calibre2">Curves</strong></h4>
<ul class="calibre12">
<li class="noindent1">Line color: <span class="literal">lc</span></li>

<li class="noindent1">Line width: <span class="literal">lw</span></li>

<li class="noindent1">Line style: <span class="literal">ls</span></li></ul>
<h4 class="h4a" id="ch04lev1sec1f"><strong class="calibre2">Scatterplots</strong></h4>
<ul class="calibre12">
<li class="noindent1">Marker shape: <span class="literal">shape</span></li>

<li class="noindent1">Marker color: <span class="literal">mc</span></li>

<li class="noindent1">Marker size: <span class="literal">ms</span></li></ul>

<h4 class="h4a" id="ch04lev1sec1g"><strong class="calibre2">Contour plots</strong></h4>
<ul class="calibre12">
<li class="noindent1">Give contours labels (Boolean): <span class="literal">clabels</span></li>

<li class="noindent1">Contour levels: <span class="literal">levels</span></li></ul>
<h4 class="h4a" id="ch04lev1sec1h"><strong class="calibre2">Axes and ticks</strong></h4>
<ul class="calibre12">
<li class="noindent1">Reverse axis (Boolean): <span class="literal">[x,y]flip</span></li>

<li class="noindent1">Rotation of tick labels: <span class="literal">[x,y]rotation</span></li>

<li class="noindent1">Draw axis: <span class="literal">showaxis [x,y]ticks</span></li>

<li class="noindent1">Frame style: <span class="literal">framestyle</span></li></ul>
<h4 class="h4a" id="ch04lev1sec1i"><strong class="calibre2">Grid</strong></h4>
<ul class="calibre12">
<li class="noindent1">Draw a grid (Boolean): <span class="literal">grid</span></li>

<li class="noindent1">Gridline opacity: <span class="literal">gridalpha [0,1]</span></li>

<li class="noindent1">Gridline style: <span class="literal">gridstyle</span></li></ul>
<h4 class="h4a" id="ch04lev1sec1j"><strong class="calibre2">Coordinate system</strong></h4>
<ul class="calibre12">
<li class="noindent1">Use polar coordinates: <span class="literal">:proj=polar</span></li></ul>
<h4 class="h4a" id="ch04lev1sec1k"><strong class="calibre2">Sizes and margins</strong></h4>
<ul class="calibre12">
<li class="noindent1">Margin around subplot: <span class="literal">[left,right,top,bottom]margin</span></li>

<li class="noindent1">Overall plot size: <span class="literal">sizes(a, b)</span> (in px)</li>

<li class="noindent1">Subplot aspect ratio: <span class="literal">ratio</span></li></ul>
<p class="indent">Each of the keywords in these lists has a set of abbreviations and alternative spellings, all listed in the official documentation. I’ve picked one version in each case; it’s not always the briefest alternative, but a choice designed to be memorable and to avoid confusion.</p>
<p class="indent"><span epub:type="pagebreak" id="page_100"/>The purposes of a few of these settings will not be clear until we discuss them later, but I’ve listed them all here for easy reference.</p>
<h4 class="h3" id="ch04lev1sec8"><strong class="calibre2"><em class="calibre4">Font Attributes</em></strong></h4>
<p class="noindent">To form the keyword for setting a font attribute such as the font size or family, look up the corresponding name for setting the font color in the attribute list shown earlier, and substitute the desired attribute, such as <span class="literal">fontsize</span> or <span class="literal">fontfamily</span> in place of <span class="literal">fontcolor</span>. For example, to make the plot title have a size of 30pt, use the setting <span class="literal">plot_titlefontsize=30</span>.</p>
<p class="indent">The font <em class="calibre11">families</em> are dependent on which backend is in use. A list for the GR backend is at <a href="https://gr-framework.org/fonts.html" class="calibre10"><em class="calibre11">https://gr-framework.org/fonts.html</em></a>. Some of the more useful families, which also may be available in other backends, are Times (Roman, Italic, Bold), Courier, Bookman, DejaVu Sans, and Computer Modern. Supply the setting as a string. If we set the attribute <span class="literal">fontfamily</span>, that will apply to all or most of the text on the plot. For example, to get the ticks, axis labels, and other annotations in Computer Modern, but the title in Times, we’d call <span class="literal">plot(...; fontfamily="Computer Modern", legendfontfamily="Times")</span>.</p>
<p class="indent">If we mutate a plot that contains subplots, and we’re adding or changing attributes that apply to subplots, we must specify which subplot to mutate, unless we want our changes to apply to all of them. This is the purpose of the <span class="literal">subplot</span> keyword. Set it to an integer indexing the subplots as they appear in the <span class="literal">plot()</span> statement. For example, for two graphs displayed side by side with <span class="literal">plot(p1, p2)</span>, we can put a label on the horizontal axis of <span class="literal">p2</span> with <span class="literal">plot</span>!(<span class="literal">; xguide</span> <span class="literal">="Time", subplot=2)</span>. Without the <span class="literal">subplot</span> keyword, both plots would get the label.</p>
<h4 class="h3" id="ch04lev1sec9"><strong class="calibre2"><em class="calibre4">The Frame Styles</em></strong></h4>
<p class="noindent">The <span class="literal">framestyle</span> setting determines the type of axis. <a href="ch04.xhtml#ch4fig10" class="calibre10">Figure 4-10</a> displays the six possibilities.</p>
<div class="image1"><img alt="Image" id="ch4fig10" src="../images/ch04fig10.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-10: The six possible frame styles</em></p>
<p class="indent"><span epub:type="pagebreak" id="page_101"/>We set the attribute to the symbol version of the term printed on the graph. For example, to get the style in the lower-left corner, we’d use the setting <span class="literal">framestyle=:zerolines</span>.</p>
<h3 class="h2" id="ch04lev7"><strong class="calibre2">Working with Plot Settings</strong></h3>
<p class="noindent">Now we can understand the call to <span class="literal">scatter(x, y; ms=0.5, legend=false)</span> that produced <a href="ch04.xhtml#ch4fig9" class="calibre10">Figure 4-9</a>. After the first two positional arguments, the arrays holding the points to be plotted, we have a semicolon indicating the start of the keyword arguments. The first sets a small marker size and the second turns off the legend.</p>
<p class="indent">Let’s use some combinations of the basic attributes listed in “Basic Plot Settings” on <a href="ch04.xhtml#ch04lev6" class="calibre10">page 98</a> to solve some other visualization problems.</p>
<h4 class="h3" id="ch04lev1sec10"><strong class="calibre2"><em class="calibre4">Aspect Ratio and Title Font Size</em></strong></h4>
<p class="noindent">The following program creates a simple plot with two subplots displaying a circle and a parabola:</p>
<pre class="calibre13">julia&gt; <span class="codestrong">p1 = plot(sin, cos, 0, 2π; title="A Circle", ratio=1,</span>
                 <span class="codestrong">grid=false, ticks=false, legend=false)</span>

julia&gt; <span class="codestrong">p2 = plot(x -&gt; x^2, -1, 1; title="A Parabola",</span>
                 <span class="codestrong">gridalpha=0.4, gridstyle=:dot, legend=false)</span>

julia&gt; <span class="codestrong">plot(p1, p2; plot_title="Two Shapes", plot_titlefontsize=20)</span></pre>
<p class="indent">Here we use the <span class="literal">ratio</span> keyword to set the aspect ratio in the first line. You may have noticed that what is supposed to be a circle in <a href="ch04.xhtml#ch4fig7" class="calibre10">Figure 4-7</a> is rendered as a noncircular ellipse. The default size of Julia’s plots is not square, but is instead longer than it is tall, so the circle is stretched horizontally. If it matters, as it does in this case, we can use <span class="literal">ratio</span> to fix the problem. We also turned off the grid and ticks on this plot.</p>
<p class="indent">The default grid in most backends is quite light, so we made it more prominent by increasing the <span class="literal">gridalpha</span> in the plot of the parabola. The default for this is <span class="literal">0.1</span>.</p>
<p class="indent">The last line creates the combined plot with an overall title set a little larger than the default. <a href="ch04.xhtml#ch4fig11" class="calibre10">Figure 4-11</a> shows the result.<span epub:type="pagebreak" id="page_102"/></p>
<div class="image1"><img alt="Image" id="ch4fig11" src="../images/ch04fig11.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-11: A plot with two subplots</em></p>
<p class="indent">To get more space between the two subplots, we can, for example, set a <span class="literal">rightmargin</span> on the left subplot. Before setting margins, execute <span class="codestrong1">using Plots</span> <span class="codestrong1">.PlotMeasures</span>, which lets us use literal dimensions in margin settings; for example, <span class="literal">rightmargin=10mm</span>. Other available dimensions are <span class="literal">inch</span>, <span class="literal">cm</span>, <span class="literal">px</span>, and <span class="literal"><em class="calibre11">pt</em></span>.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre11">The</em> <span class="codeitalic1">plot_title</span> <em class="calibre11">is a recent addition to the plotting system, and its implementation is incomplete. If we choose larger font sizes for the title, it will overlap the titles of the subplots, and there is no straightforward way to fix that.</em></p>
</div>
<h4 class="h3" id="ch04lev1sec11"><strong class="calibre2"><em class="calibre4">Labels and Legend Positioning</em></strong></h4>
<p class="noindent">For our next example, let’s make a plot of <em class="calibre11">x</em><sup class="calibre23"><em class="calibre11">n</em></sup> for a few values of <em class="calibre11">n</em>:</p>
<pre class="calibre13">julia&gt; <span class="codestrong">plot()</span>

julia&gt; <span class="codestrong">for n = 1:5</span>
           <span class="codestrong">plot!(x -&gt; x^n; lw=3, ls=:auto, label=n)</span>
       <span class="codestrong">end</span>

julia&gt; <span class="codestrong">plot!(; legend=:topleft, legendtitle="Exponent")</span></pre>
<p class="indent">First we’ll clear any existing plots with an empty <span class="literal">plot()</span> command, and then mutate the empty plot once for each function. Since the <span class="literal">for</span> loop doesn’t return a result, we won’t see anything until the final call after the loop, which simply makes some plot settings. In the plotting statements, the <span class="literal">label</span> setting defines the text associated with that plot in the legend. It expects a string (or symbol), but can convert the integer <span class="literal">n</span>. The <span class="literal">lw</span> setting makes the lines thicker <span epub:type="pagebreak" id="page_103"/>than the default. The <span class="literal">ls</span> setting is for the line style. It can take the values <span class="literal">:auto</span>, <span class="literal">:solid</span>, <span class="literal">:dash</span>, <span class="literal">:dot</span>, <span class="literal">:dashdot</span>, or <span class="literal">:dashdotdot</span>. The option used here, <span class="literal">:auto</span>, cycles through the other five styles, reusing them if the plot has more than five curves. It’s a good choice for print when we can’t use color. <a href="ch04.xhtml#ch4fig12" class="calibre10">Figure 4-12</a> shows the results.</p>
<div class="image1"><img alt="Image" id="ch4fig12" src="../images/ch04fig12.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-12: The five line styles</em></p>
<p class="indent">The final <span class="literal">plot()</span> statement sets <span class="literal">legend</span> to place it at the top left of the plot. We can use other similar positioning symbols, optionally preceded by <span class="literal">outer</span> to place the legend outside the axes. For more precise positioning we can use an <span class="literal">(x, y)</span> tuple specifying the coordinates of the legend box. Finally, we can set <span class="literal">legend=false</span> to omit the legend.</p>
<h4 class="h3" id="ch04lev1sec12"><strong class="calibre2"><em class="calibre4">LaTeX Titles and Label Positioning by Data</em></strong></h4>
<p class="noindent">Let’s plot the same functions with a different style of labeling. We’ll use annotations to place labels indicating each exponent on top of each corresponding curve, as shown in <a href="ch04.xhtml#ch4lis1" class="calibre10">Listing 4-1</a>.</p>
<pre class="calibre13">julia&gt; <span class="codestrong">plot()</span>

julia&gt; <span class="codestrong">for n = 1:5</span>
           <span class="codestrong">xlabel = (0.2 + 0.12n)</span>
        <span class="ent">➊</span> <span class="codestrong">ylabel = xlabel^n</span>
           <span class="codestrong">plot!(x -&gt; x^n; lw=3, ls=:auto,</span>
                      <span class="codestrong">annotation=(xlabel, ylabel, n),</span>
                      <span class="codestrong">annotationfontsize=25)</span>
       <span class="codestrong">end</span>


julia&gt; <span class="codestrong">using LaTeXStrings</span>

julia&gt; <span class="codestrong">plot!(; legend=false, xguide="x", yguide="y", guidefontsize=18,</span>
        <span class="ent">➋</span> <span class="codestrong">title=L"x^n \textrm{~labeled~by~}n", titlefontsize=30)</span></pre>
<p class="list" id="ch4lis1"><span epub:type="pagebreak" id="page_104"/><em class="calibre11">Listing 4-1: Using calculated labels and a LaTeX title</em></p>
<p class="indent">Here we calculate coordinates for each of the five labels within the loop. The x-coordinate increases to the right with the exponent, to space out the labels so they don’t overlap. The label’s y-coordinate <span class="ent">➊</span> is the same function of <em class="calibre11">x</em> as the curves we’re plotting, to ensure that they lie precisely on the curves that they’re labeling.</p>
<p class="indent">The setting for the <span class="literal">annotation</span> has <span class="literal">n</span>, a variable holding an integer, where there should be a <span class="literal">String</span>, but the <span class="literal">plot()</span> function converts it for us.</p>
<p class="indent">We then import a package we haven’t seen before: <span class="literal">LaTeXStrings</span> (note the capitalization) lets us put math in our plot titles and annotations using LaTeX syntax. Even non-LaTeX users may still need equations in graphs occasionally, and LaTeX’s math syntax is straightforward. Check “Further Reading” on <a href="ch04.xhtml#fur4" class="calibre10">page 121</a> for a link to a guide. After importing this package, we can prepend <span class="literal">L</span> to any string to turn it into a LaTeX string. In a context where typesetting is possible, such as in a plot, Julia will typeset the string appropriately. The entire string is in LaTeX math mode, where all letters are treated as mathematical symbols. Therefore, if we need some normal text, as we did in this example <span class="ent">➋</span>, we must wrap it in a LaTeX command to force it to be set as such. Within these text segments, indicate spaces with a tilde (<span class="literal">~</span>). The plot in <a href="ch04.xhtml#ch4fig13" class="calibre10">Figure 4-13</a> shows the result of this REPL session.</p>
<div class="image1"><img alt="Image" id="ch4fig13" src="../images/ch04fig13.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-13: Using calculated labels and a LaTeX title</em></p>
<p class="indent"><span epub:type="pagebreak" id="page_105"/>In addition to the settings for individual plot elements, two others make larger-scale changes. The <span class="literal">thickness_scaling</span> setting is useful for creating a version of the plot with better legibility for presentation. It thickens everything, including tick labels. It affects the margins as well, however, and can change the positioning of plot elements. Setting the values between 1 and 1.7 produces useful results. Use values less than 1 to create a spindly version of the plot.</p>
<h4 class="h3" id="ch04lev1sec13"><strong class="calibre2"><em class="calibre4">Regression Lines</em></strong></h4>
<p class="noindent">The <span class="literal">smooth</span> setting draws a line of best fit, calculated by linear regression, through each curve or dataset on the plot.</p>
<p class="indent">Let’s return to the gingerbread map and, using the same initial conditions, calculate 20,000 iterations with <em class="calibre11">a</em> = 1<em class="calibre11">.</em>6, again storing the results in the <span class="literal">x</span> and <span class="literal">y Vector</span>s. We’ll make two subplots. The first will be a scatterplot similar to <a href="ch04.xhtml#ch4fig9" class="calibre10">Figure 4-9</a>, but with a regression line showing the average orientation of the points. The second will plot the first 100 values of <span class="literal">x</span> versus iteration number, with a regression line showing the trend of a gradually increasing distance from the origin:</p>
<pre class="calibre13">   julia&gt; <span class="codestrong">sc = scatter(x, y; smooth=true, ms=1, legend=false,</span>
                       <span class="codestrong">xguide="x", yguide="y", guidefontsize=18)</span>

   julia&gt; <span class="codestrong">pl = plot(x[1:100]; smooth=true, legend=false)</span>

<span class="ent">➊</span> julia&gt; <span class="codestrong">pl = plot!(x[1:100]; lc=:lightgray, legend=false,</span>
                     <span class="codestrong">xguide="iteration", yguide="x", guidefontsize=18)</span>

   julia&gt; <span class="codestrong">plot(sc, pl, plot_title="Gingerbread map with a = 1.6",</span>
               <span class="codestrong">plot_titlefontsize=22)</span></pre>
<p class="indent">First we create a scatterplot of the map as before, adding the trend line with the setting <span class="literal">smooth=true</span>, and assign the result to <span class="literal">sc</span>. Then we plot the initial 100 <em class="calibre11">x</em>-values, also with a trend line. Plotting the two subplots together with a title gives us <a href="ch04.xhtml#ch4fig14" class="calibre10">Figure 4-14</a>.<span epub:type="pagebreak" id="page_106"/></p>
<div class="image1"><img alt="Image" id="ch4fig14" src="../images/ch04fig14.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-14: Trends in the gingerbread map</em></p>
<p class="indent">As before, the <span class="literal">plot_title</span> attribute creates an overall title for the two plots. We wanted the plotted curve and the calculated trend line to have different styles, but there’s no setting for this, so we resorted to a trick, over-plotting the curve in a different style but without a trend line <span class="ent">➊</span>.</p>
<h3 class="h2" id="ch04lev8"><strong class="calibre2">Saving Plots</strong></h3>
<p class="noindent">When you’re ready to save your creation to disk, call <span class="codestrong1">savefig(</span><span class="codestrongitalic">p</span><span class="codestrong1">,</span> <span class="codestrongitalic">path</span><span class="codestrong1">)</span> where <span class="codeitalic1">p</span> is the variable holding the visualization and <span class="codeitalic1">path</span> is the location where you would like the image file stored. The filename extension to <span class="codeitalic1">path</span> determines the format, but different backends support different types of images. PDF and PNG should always be available, and SVG is also widely supported.</p>
<p class="indent">If we omit <span class="literal">p</span>, it defaults to the current plot. A common workflow is to repeatedly mutate a plot, making adjustments until it’s satisfactory, and then call <span class="literal">savefig(</span><span class="codeitalic1">path</span><span class="literal">)</span>.</p>
<h3 class="h2" id="ch04lev9"><strong class="calibre2">Detail Insets</strong></h3>
<p class="noindent">An inset plot is a small plot inside the frame of a larger one. It’s often used to provide a magnified view of a section of the outer plot. Julia’s plotting system has a built-in function for creating this type of detail inset, called <span class="literal">lens!()</span>. It exists only in a mutating form because the inset plot makes sense only as an addition to an existing plot.</p>
<p class="indent">The first argument to <span class="literal">lens!()</span> either is an existing plot or is omitted to indicate the current plot. The next two arguments are vectors defining the rectangular region to be magnified. The required argument <span class="literal">inset</span> specifies <span epub:type="pagebreak" id="page_107"/>which subplot gets the inset as well as the inset’s position and size. The diagram in <a href="ch04.xhtml#ch4fig15" class="calibre10">Figure 4-15</a> shows how to use these arguments.</p>
<div class="image1"><img alt="Image" id="ch4fig15" src="../images/ch04fig15.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-15: How to make an inset</em></p>
<p class="indent"><a href="ch04.xhtml#ch4fig15" class="calibre10">Figure 4-15</a> uses a blank plot with a grid for illustration. The annotations “width” and “height” refer to the width and height of the outer plot. The complete command that created the inset is shown near the bottom of the plot.</p>
<p class="indent">As an application for <span class="literal">lens!()</span>, I constructed another instance of the gingerbread map, this time with <em class="calibre11">a</em> = 1<em class="calibre11">.</em>4 and 100,000 iterations to produce more detail. The following two lines first create the scatterplot and then add the inset:</p>
<pre class="calibre13">scatter(x, y; ms=0.1, legend=false)

lens!([-26, -22], [31, 38];
      inset=(1, bbox(0.1, 0, 0.3, 0.3)),
   <span class="ent">➊</span> ticks=false, framestyle=:box, subplot=2,
      linecolor=:green, linestyle=:dot)</pre>
<p class="indent">In the call to <span class="literal">lens!()</span>, the settings <span class="ent">➊</span> for the <span class="literal">ticks</span> and <span class="literal">Framestyle</span> apply to the inset plot, while the <span class="literal">linecolor</span> and <span class="literal">linestyle</span> settings apply to the drawing of the magnifying glass that delineates the expanded area. A full frame style is a good choice for an inset plot.</p>
<p class="indent"><a href="ch04.xhtml#ch4fig16" class="calibre10">Figure 4-16</a> shows the result. I’ve used the inset plot to magnify one of the corners of the gingerbread map, showing the pattern of points within it.<span epub:type="pagebreak" id="page_108"/></p>
<div class="image1"><img alt="Image" id="ch4fig16" src="../images/ch04fig16.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-16: Using a detail inset to magnify a section of the gingerbread map</em></p>
<p class="indent">The setting <span class="literal">subplot=2</span> in the call that creates the inset ensures that the other graph settings in that call apply only to the inset, which becomes the second subplot. By referring to the number of the subplot, we could create an inset within the inset, if we were so inclined.</p>
<h3 class="h2" id="ch04lev10"><strong class="calibre2">3D Plots</strong></h3>
<p class="noindent">Several types of plots visualize a quantity that depends on two independent variables. When in rectangular coordinates, the dependent variable is conventionally called <em class="calibre11">z</em>, and the two independent variables are called <em class="calibre11">x</em> and <em class="calibre11">y</em>. The three common ways to represent such a relationship are with a surface plot, a heatmap, or a contour plot. Which is most effective depends on the nature of the data and the features we’re trying to clarify.</p>
<h4 class="h3" id="ch04lev1sec14"><strong class="calibre2"><em class="calibre4">Surface Plots</em></strong></h4>
<p class="noindent">After importing the plotting package with <span class="literal">using Plots</span>, we have access to several 3D plotting routines. For a <em class="calibre11">surface plot</em>, we use the <span class="literal">surface()</span> function to create a perspective rendering of a 2D surface embedded in a 3D space, with the height and coloring of the surface indicating the <em class="calibre11">z</em>-value.</p>
<p class="indent">Here are a few additional settings that apply to surface plots:</p>
<ul class="calibre12">
<li class="noindent1">Draw a colorbar: <span class="literal">colorbar</span> (<span class="literal">true</span> or <span class="literal">false</span>)</li>
<li class="noindent1">Opacity of the surface: <span class="literal">fillalpha</span></li>
<li class="noindent1">Angle of view: <span class="literal">camera</span> (azimuth, elevation) (in degrees)</li>
<li class="noindent1"><span epub:type="pagebreak" id="page_109"/>Colorbar title: <span class="literal">cbtitle</span></li>
<li class="noindent1">Surface palette: <span class="literal">c</span></li></ul>
<p class="indent">Let’s put some of these settings to use in making a surface plot of a Gaussian distribution of two variables. After defining a vector <em class="calibre11">x</em> to go from –1 to 1, we can use anonymous function syntax to plot the surface with the following:</p>
<pre class="calibre13">surface(x, x, (x, y) -&gt; exp(-(0.05x^2 + y^2)/.1);
        fillalpha=0.5, camera=(45, 50), c=[Gray(0), Gray(0.8)],
        xrotation=45, yrotation=-45)</pre>
<p class="indent">We use an alpha less than 1 in order to see through the surface, and rotated the axis tick labels to make them easier to read and to keep them from colliding where the axes meet. <a href="ch04.xhtml#ch4fig17" class="calibre10">Figure 4-17</a> shows the surface plot.</p>
<div class="image1"><img alt="Image" id="ch4fig17" src="../images/ch04fig17.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-17: A surface plot</em></p>
<p class="indent">The <span class="literal">c</span> setting defines the palette used to color the surface. There are several ways to define the palette; the one used earlier, with a number of colors in a <span class="literal">Vector</span>, creates a palette by smoothly interpolating between them. <span class="literal">Gray(0)</span> is black, <span class="literal">Gray(1)</span> is white, and so on. We can also define colors with <span class="literal">RGB(r, g, b)</span>, where <span class="literal">r</span>, <span class="literal">g</span>, and <span class="literal">b</span> are the red, green, and blue components, also ranging from <span class="literal">0</span> (absent) to <span class="literal">1</span> (fully saturated). Over 600 color names are available as symbols, including both memorable names such as <span class="literal">:red</span> and <span class="literal">:blue</span> and meaningless ones such as <span class="literal">:seashell3</span> and <span class="literal">:oldlace</span>.</p>
<p class="indent">Instead of a <span class="literal">Vector</span> of colors, we can supply a symbol giving the name of a predefined palette, of which there are scores listed at <a href="https://docs.juliaplots.org/latest/generated/colorschemes/" class="calibre10"><em class="calibre11">https://docs.juliaplots.org/latest/generated/colorschemes/</em></a>. The more useful ones have names such as <span epub:type="pagebreak" id="page_110"/><span class="literal">:blues</span> or <span class="literal">:grays</span> that use one hue and vary the saturation and lightness, but there are plenty to choose from for special purposes.</p>
<h4 class="h3" id="ch04lev1sec15"><strong class="calibre2"><em class="calibre4">Heatmaps</em></strong></h4>
<p class="noindent">A heatmap also visualizes a mapping of two independent variables to one dependent variable, but the values of the independent variable are indicated by a color or gray value. The call is similar to a surface plot, but uses the <span class="literal">heatmap()</span> function:</p>
<pre class="calibre13">heatmap(x, x, (x, y) -&gt; exp(-(0.05x^2 + y^2)/.1);
               c=:grays)</pre>
<p class="indent">This call creates the heatmap shown in <a href="ch04.xhtml#ch4fig18" class="calibre10">Figure 4-18</a>.</p>
<div class="image1"><img alt="Image" id="ch4fig18" src="../images/ch04fig18.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-18: A heatmap of a 2D Gaussian</em></p>
<p class="indent">Color palettes for heatmaps work the same way as for surface plots.</p>
<h4 class="h3" id="ch04lev1sec16"><strong class="calibre2"><em class="calibre4">Contour Plots</em></strong></h4>
<p class="noindent">Contour plots are similar to heatmaps, but they use isolines rather than color to indicate the values of the independent variable. Here are a few important attributes specific to contour plots:</p>
<ul class="calibre12">
<li class="noindent1">Number of contours or specific contour levels: <span class="literal">levels</span> (integer or vector of levels)</li>

<li class="noindent1">Draw contour labels (Boolean): <span class="literal">clabels</span></li>

<li class="noindent1">Fill areas between contours (Boolean): <span class="literal">fill</span></li></ul>
<p class="indent"><span epub:type="pagebreak" id="page_111"/>If we supply an integer for <span class="literal">levels</span>, Julia will draw that many contours. If we also set <span class="literal">clabels</span> to <span class="literal">true</span>, it will label the contour lines with the values they represent. Unfortunately, these numerical labels are printed with too many digits and often become crowded. If we set <span class="literal">levels</span> to a <span class="literal">Vector</span> of numbers, the plot will have contours at just those values, and their labels will be printed using the same precision used for the <span class="literal">levels</span>. The following example shows this use of <span class="literal">levels</span> and <span class="literal">clabels</span>:</p>
<pre class="calibre13">contour(x, x, (x, y) -&gt; exp(-(0.05x^2 + y^2)/.1);
               clabels=true, levels=[0.1, 0.3, 0.5, 0.7, 0.9, 1.0],
               colorbar=false, framestyle=:box)</pre>
<p class="indent">This call uses the same <span class="literal">x</span> vector and plots the same function as the surface plot and heatmap examples shown in <a href="ch04.xhtml#ch4fig17" class="calibre10">Figures 4-17</a> and <a href="ch04.xhtml#ch4fig18" class="calibre10">4-18</a>. The result, in <a href="ch04.xhtml#ch4fig19" class="calibre10">Figure 4-19</a>, shows the labels with one digit of precision.</p>
<div class="image1"><img alt="Image" id="ch4fig19" src="../images/ch04fig19.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-19: A labeled contour plot</em></p>
<p class="indent">The <span class="literal">:box framestyle</span> works well with contour plots. Eliminating the color bar is also a good idea. We can color the lines by setting a <span class="literal">c</span>, but this doesn’t always work well with every backend. If we find stray colors creeping into the contour lines, we can fix it with <span class="literal">c=:black</span>.</p>
<p class="indent">Line styles such as <span class="literal">:dot</span> work, but not <span class="literal">:auto</span>.</p>
<div class="note">
<p class="notet"><strong class="calibre2"><span class="notes">NOTE</span></strong></p>
<p class="notep"><em class="calibre11">When using filled contours with some backends, including</em> <span class="codeitalic1">GR</span><em class="calibre11">, and manually set contour levels, we must include a level greater than or equal to the maximum of the data, or the graph will not be properly drawn.</em></p>
</div>
<p class="indent">The <span class="literal">fill</span> attribute, when set to <span class="literal">true</span>, adds colors between the contour lines, resulting in a kind of discrete heatmap with contours. The <span class="literal">c</span> attribute <span epub:type="pagebreak" id="page_112"/>defines the palette for these colors. The <span class="literal">contourf()</span> function is an alias for <span class="literal">contour()</span> with <span class="literal">fill=true</span>.</p>
<p class="indent">Let’s repeat the previous contour plot (<a href="ch04.xhtml#ch4fig19" class="calibre10">Figure 4-19</a>), but this time leave the color bar in, turn on the <span class="literal">fill</span>, and use a grayscale palette:</p>
<pre class="calibre13">contour(x, x, (x, y) -&gt; exp(-(0.05x^2 + y^2)/.1);
               clabels=true, levels=[0.1, 0.3, 0.5, 0.7, 0.9, 1.0],
               fill=true, c=[Gray(0.4), :white])</pre>
<p class="indent"><a href="ch04.xhtml#ch4fig20" class="calibre10">Figure 4-20</a> shows the filled contour plot.</p>
<div class="image1"><img alt="Image" id="ch4fig20" src="../images/ch04fig20.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-20: A filled contour plot</em></p>
<p class="indent">In this case, having both contour labels and a color bar is somewhat redundant, as they carry the same information, but this may make the plot easier to interpret. There is an art to scientific visualization in creating a result that is both intuitively clear and quantitatively precise.</p>
<h4 class="h3" id="ch04lev1sec17"><strong class="calibre2"><em class="calibre4">3D Parametric Plots</em></strong></h4>
<p class="noindent">Parametric plots in 3D work just as they do in 2D, but they trace a path through 3D space, with three functions of the single parameter giving the x-, y-, and z-coordinates. Unlike in 2D parametric plots, we must supply three vectors, and it doesn’t work with functions. Here is an example:</p>
<pre class="calibre13">julia&gt; <span class="codestrong">t = 0:2π/100:2π;</span>

julia&gt; <span class="codestrong">xp = sin.(3 .* t);</span>

julia&gt; <span class="codestrong">yp = cos.(3 .* t);</span>

julia&gt; <span class="codestrong">zp = t .* 0.2</span>

julia&gt; <span class="codestrong">plot(xp, yp, zp; lw=3, gridalpha=0.4, camera=(30, 50))</span></pre>
<p class="indent"><span epub:type="pagebreak" id="page_113"/>The <span class="literal">plot()</span> function knows what to do when supplied with three vectors as positional arguments, producing the resulting 3D parametric plot shown in <a href="ch04.xhtml#ch4fig21" class="calibre10">Figure 4-21</a>.</p>
<div class="image1"><img alt="Image" id="ch4fig21" src="../images/ch04fig21.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-21: An example of a 3D parametric plot</em></p>
<p class="indent">We can use the attributes for lines as for ordinary 2D plots, and set the camera angle as for surface plots.</p>
<h4 class="h3" id="ch04lev1sec18"><strong class="calibre2"><em class="calibre4">Vector Plots</em></strong></h4>
<p class="noindent">A vector field maps every point in space to a vector, which can be represented by an arrow. The <span class="literal">Plots</span> package offers vector plots created with the <span class="literal">quiver()</span> function. Its first two arguments are <span class="literal">x</span> and <span class="literal">y Vector</span>s containing the coordinates of the start of the vectors. The displacements from those coordinates to the vectors’ endpoints are stored in two other <span class="literal">Vector</span>s, placed in a <span class="literal">Tuple</span>, and assigned to a keyword argument also called <span class="literal">quiver</span>.</p>
<p class="indent">The following example shows how to use <span class="literal">quiver()</span>:</p>
<pre class="calibre13">julia&gt; <span class="codestrong">xc = 0:.3:π;</span>

julia&gt; <span class="codestrong">yc = sin.(xc);</span>

julia&gt; <span class="codestrong">quiver(xc, yc; quiver=(xc .- π/2, yc .- 0.25), lw=3)</span></pre>
<p class="indent"><span epub:type="pagebreak" id="page_114"/>These three lines produce the vector plot in <a href="ch04.xhtml#ch4fig22" class="calibre10">Figure 4-22</a>.</p>
<div class="image1"><img alt="Image" id="ch4fig22" src="../images/ch04fig22.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-22: A vector plot using</em> <span class="codeitalic">quiver()</span></p>
<p class="indent">The <span class="literal">quiver()</span> function accepts all the attributes for curves; here we set the line width to get thicker arrows.</p>
<h4 class="h3" id="ch04lev1sec19"><strong class="calibre2"><em class="calibre4">3D Scatterplots</em></strong></h4>
<p class="noindent"><span class="literal">Plots</span> can extend scatterplots into the third dimension. One way to visualize a 3D distribution of some quantity is to plot a regular 3D grid of markers while setting some marker attribute, such as size or opacity, to a function of the quantity. First we need to establish the grid by making <span class="literal">x</span>, <span class="literal">y</span>, and <span class="literal">z</span> <span class="literal">Vector</span>s:</p>
<pre class="calibre13">x = []; y = []; z = [];

for i in 0:20, j in 0:20, k in 0:20
    push!(x, i/10 - 1)
    push!(y, j/10 - 1)
    push!(z, k/10 - 1)
end</pre>
<p class="indent">This will create the coordinate arrays ranging from –1 to 1.</p>
<p class="indent">Let’s imagine a planet sitting in the center of our grid. We could plot the shape of the gravitational potential due to the planet by first defining a potential function and then using it to set the marker size:</p>
<pre class="calibre13">pot(x, y, z) = 1 / sqrt(x^2 + y^2 + z^2)
scatter(x, y, z;  ms=min.(pot.(x, y, z), 5), ma=0.4, legend=false)</pre>
<p class="indent"><span epub:type="pagebreak" id="page_115"/>The potential becomes large near the planet, so we need to limit the marker size with the <span class="literal">min()</span> function. It actually becomes infinite at (0, 0, 0), but Julia handles that gracefully. The result is shown in <a href="ch04.xhtml#ch4fig23" class="calibre10">Figure 4-23</a>.</p>
<div class="image1"><img alt="Image" id="ch4fig23" src="../images/ch04fig23.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-23: A 3D scatterplot</em></p>
<p class="indent">We set an opacity to allow us to see through the markers. This is the same <span class="literal">scatter()</span> function that we used in 2D, but Julia knows what to do if we give it three positional arguments.</p>
<h3 class="h2" id="ch04lev11"><strong class="calibre2">Useful Backends</strong></h3>
<p class="noindent"><span class="literal">GR</span>, the current default backend, has the merit of being fast and capable of producing most basic categories of visualization.</p>
<p class="indent">A few other backends are available for special purposes, but most of them require us to <span class="literal">add</span> them in the package manager before use.</p>
<h4 class="h3" id="ch04lev1sec20"><strong class="calibre2"><em class="calibre4">UnicodePlots</em></strong></h4>
<p class="noindent">The <span class="literal">unicodeplots</span> backend plots directly in the terminal. It’s good for a quick look at some data, which it plots using characters. We can also use it to generate plots to paste into an email, but obviously it’s not suited to making figures for publication, and it can’t save plots.</p>
<p class="indent">To produce quick plots in the terminal, first execute <span class="codestrong1">add UnicodePlots</span> in package mode, then call <span class="codestrong1">unicodeplots()</span> to activate the backend.</p>
<p class="indent">The <span class="literal">unicodeplots</span> backend doesn’t support every plot type. It can make 2D plots, including scatterplots, but not contour or surface plots. However, <span class="literal">unicodeplots</span> can render colored heatmaps in the terminal.<span epub:type="pagebreak" id="page_116"/></p>
<h4 class="h3" id="ch04lev1sec21"><strong class="calibre2"><em class="calibre4">PyPlot</em></strong></h4>
<p class="noindent">The <span class="literal">pyplot</span> backend uses Python’s Matplotlib, so it may be a good choice for those already familiar with that system. Although it can sometimes be a bit slow, it creates better plots than the default in some cases.</p>
<h4 class="h3" id="ch04lev1sec22"><strong class="calibre2"><em class="calibre4">PlotlyJS</em></strong></h4>
<p class="noindent">With the <span class="literal">plotlyjs</span> backend we can create interactive graphs for the web. Saving the plot with the <em class="calibre11">.html</em> file extension creates a file containing an HTML fragment that we can paste into a web page. The fragment loads some third-party JavaScript that supplies interactive controls for panning, zooming, and, for 3D plots, rotating in 3D space. Other forms of interactivity vary appropriately with the plot type. Two-dimensional plots display data values as the user hovers over the curve, and surface plots draw contours on the surfaces at the <em class="calibre11">z</em>-value of the mouse pointer.</p>
<p class="indent">Plotting is not at all fast, although the results look good and interaction is impressively responsive. Contour plots are better with <span class="literal">plotlyjs</span> than with <span class="literal">GR</span>, especially for colored contours, but the attributes for linewidth or linestyle have no effect, and manual levels don’t work.</p>
<p class="indent">When plotting from the REPL, a separate window pops up for each plot, using the same JavaScript interactivity as in the HTML files.</p>
<h4 class="h3" id="ch04lev1sec23"><strong class="calibre2"><em class="calibre4">PGFPlots and PGFPlotsX</em></strong></h4>
<p class="noindent">I won’t say much about these, because they are useful only to those who have LaTeX installed and some knowledge of the LaTeX graphing system PGFPlots. Those who do use these systems should be aware of the two Julia interfaces to them. The difference between the two versions is that <span class="literal">PGFPlotsX</span>’s syntax is closer to what’s used directly in LaTeX. With <span class="literal">PGFPlots</span>, we can make extraordinary visualizations that are difficult to achieve through other means. LaTeX users who aren’t familiar with the system may want to acquaint themselves. This backend does depend on a LaTeX installation—not a trivial requirement.</p>
<h4 class="h3" id="ch04lev1sec24"><strong class="calibre2"><em class="calibre4">HDF5</em></strong></h4>
<p class="noindent">HDF5 stands for Hierarchical Data Format, version 5. This backend does not display plots directly; its purpose is to bundle data and plots together into an HDF file. For anyone who uses HDF in their research, this package will be essential, but others will have no use for it.</p>
<p class="indent">The backend not only writes HDF files, it also can read them into the Julia session for display with other <span class="literal">Plots</span> backends.</p>
<h4 class="h3" id="ch04lev1sec25"><strong class="calibre2"><em class="calibre4">Gaston</em></strong></h4>
<p class="noindent"><span class="literal">Gaston</span> is an interface to gnuplot and depends on a gnuplot installation. This backend will be of interest to those already using that venerable and powerful graphics program.</p>
<p class="indent"><span epub:type="pagebreak" id="page_117"/><span class="literal">Gaston</span> is fast and powerful, because gnuplot is fast and powerful. If you routinely need to make complex 3D plots that the other backends can’t handle, or need more fine control over plots for publication, installing gnuplot and using it with <span class="literal">Gaston</span> may be the best choice.</p>
<h3 class="h2" id="ch04lev12"><strong class="calibre2">Layouts</strong></h3>
<p class="noindent">Earlier in this chapter we saw that the <span class="literal">plot()</span> function will arrange graphs in a grid if we pass it a number of plot objects. Sometimes we need more control over the arrangement of subplots in an illustration. In such cases, we turn to the <span class="literal">Layout</span> system.</p>
<p class="indent">The plotting package’s method for composing plots into larger illustrations is one of the jewels of the system. Considering the complexity that it allows, it’s remarkably intuitive to use.</p>
<p class="indent">In the following demonstrations, the <span class="literal">Vector s</span> contains six plots, each displaying a prominent digit, from 1 to 6. This will make it clear where the layout engine positions each plot.</p>
<p class="indent">If you’d like to follow along, you’ll need to create your own <span class="literal">s</span> vector, with plots of your choosing.</p>
<h4 class="h3" id="ch04lev1sec26"><strong class="calibre2"><em class="calibre4">Making Simple Rectangular Layouts</em></strong></h4>
<p class="noindent">To replace the default square grid of plots with a different rectangular arrangement, supply the desired number of rows and columns as a tuple assigned to the <span class="literal">layout</span> attribute:</p>
<pre class="calibre13">plot(s[1], s[2], s[3], s[4]; layout=(1, 4))</pre>
<p class="indent">As <a href="ch04.xhtml#ch4fig24" class="calibre10">Figure 4-24</a> shows, this call arranges the plots using one row and four columns.</p>
<div class="image1"><img alt="Image" id="ch4fig24" src="../images/ch04fig24.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-24: A one-row layout</em></p>
<p class="indent"><span epub:type="pagebreak" id="page_118"/>The number of plots implied in the layout tuple must match exactly the number of subplots. The default in this case would be equivalent to <span class="literal">layout=(2, 2)</span>.</p>
<h4 class="h3" id="ch04lev1sec27"><strong class="calibre2"><em class="calibre4">Using grid()</em></strong></h4>
<p class="noindent">The simple layouts in the previous example make all the subplots the same size. To control the heights and widths of the rows and columns, use the <span class="literal">grid()</span> function, as in the following example:</p>
<pre class="calibre13">plot(s[1], s[2], s[3], s[4];
     layout=grid(2, 2; widths=(0.2, 0.8), heights=(0.7, 0.3)))</pre>
<p class="indent">This call creates the layout in <a href="ch04.xhtml#ch4fig25" class="calibre10">Figure 4-25</a>. We can omit either the <span class="literal">height</span> or the <span class="literal">width</span> specification to get equalized lengths in that direction.</p>
<div class="image1"><img alt="Image" id="ch4fig25" src="../images/ch04fig25.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-25: A layout using the</em> <span class="codeitalic">grid()</span> <em class="calibre11">function</em></p>
<p class="indent">When using <span class="literal">grid()</span>, the dimensions can add up to less than 1, which will simply leave some blank space, but they should not add to greater than 1.</p>
<h4 class="h3" id="ch04lev1sec28"><strong class="calibre2"><em class="calibre4">Creating Complex Layouts Using @layout</em></strong></h4>
<p class="noindent">We can create layouts of arbitrary complexity. The next level requires the use of the <span class="literal">@layout</span> macro. We haven’t seen macros yet; they’re introduced in “Macros” on <a href="ch06.xhtml#ch06lev4" class="calibre10">page 170</a>. For now, I’ll show how to use this particular macro to create graph layouts. We’ll be better equipped to understand how it works under the hood after we learn a bit more about the language.</p>
<p class="indent">The <span class="literal">@layout</span> macro creates a layout that follows the shape of a matrix that we supply to the macro. We use spaces to place subplots horizontally and <span epub:type="pagebreak" id="page_119"/>newlines or semicolons to place them vertically, as when constructing actual matrices. However, these <span class="literal">@layout</span> matrices don’t need to have matching dimensions. As in the following example, the rows can have different numbers of elements. I use <span class="literal">a</span> to represent a subplot, but we can use any identifiers. They have no meaning, as the layout engine just uses the plots in the order we supply them in the <span class="literal">plot()</span> function. Here’s a simple use of the macro:</p>
<pre class="calibre13">plot(s[1], s[2], s[3], s[4], s[5], s[6];
     layout =  @layout [ a a a
                          a a
                           a   ] )</pre>
<p class="indent"><a href="ch04.xhtml#ch4fig26" class="calibre10">Figure 4-26</a> shows the resulting layout. Observe how the arrangement of subplots follows the arrangement of the <span class="literal">a</span> placeholders used in the macro.</p>
<div class="image1"><img alt="Image" id="ch4fig26" src="../images/ch04fig26.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-26: Using the <span class="codeitalic">@layout</span> macro</em></p>
<p class="indent">The use of <span class="literal">@layout</span> in this form equalizes the space allotted to the subplots. To change the height or width of any of them, use the notation in the following example:</p>
<pre class="calibre13">plot(s[1], s[2], s[3], s[4], s[5], s[6];
     layout =  @layout [ a a a
                          a{0.68w} a
                            a{0.5h} ])</pre>
<p class="indent">The specifications inside the curly brackets are width or height as a fraction of the entire plot. This call creates the layout in <a href="ch04.xhtml#ch4fig27" class="calibre10">Figure 4-27</a>.<span epub:type="pagebreak" id="page_120"/></p>
<div class="image1"><img alt="Image" id="ch4fig27" src="../images/ch04fig27.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-27: Using the <span class="codeitalic">@layout</span> macro with dimension specifications</em></p>
<p class="indent">We can achieve even greater flexibility in layouts by using a call to <span class="literal">grid()</span> within the <span class="literal">@layout</span> argument, as in the following example:</p>
<pre class="calibre13">plot(s[1], s[2], s[3], s[4], s[5], s[6];
     layout=@layout [ grid(2, 2) a{0.3w}
                            b{0.2h} ])</pre>
<p class="indent">The number of subplots passed to the <span class="literal">@layout</span> macro must equal the number in the positional arguments to <span class="literal">plots()</span>. The <span class="literal">grid(2, 2)</span> call here accounts for four subplots, and the remaining two are represented by <span class="literal">a</span> and <span class="literal">b</span>. <a href="ch04.xhtml#ch4fig28" class="calibre10">Figure 4-28</a> shows the result.</p>
<div class="image1"><img alt="Image" id="ch4fig28" src="../images/ch04fig28.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-28: Using subgrids within a layout</em></p>
<p class="indent"><span epub:type="pagebreak" id="page_121"/>“Detail Insets” on <a href="ch04.xhtml#ch04lev9" class="calibre10">page 106</a> explained how to create inset plots that magnified a section of a main plot. We can use the <span class="literal">inset</span> and <span class="literal">subplot</span> attributes that we used there to make any kind of inset, not merely one using <span class="literal">lens!()</span>, and we can combine it with any layout.</p>
<p class="indent">After creating the layout in the previous example, we can add an inset to it with this call:</p>
<pre class="calibre13">plot!(x -&gt; sin(7x); inset=bbox(0.2, 0.2, 0.3, 0.3), subplot=7,
      background_inside=RGBA(1, 1, 1, 0.3), lw=5, framestyle=:box,
      legend=false, lc=:black)</pre>
<p class="indent">The <span class="literal">inset</span> attribute is set to a <span class="literal">bbox</span>. Since we didn’t supply it with a positional argument, the <span class="literal">bbox</span> parameters will position the plot relative to the entire layout, rather than any particular subplot. The <span class="literal">subplot=7</span> setting makes the inset into a new subplot, which is necessary to make this work as intended, as the layout already has six subplots. <span class="literal">RGBA</span> is similar to the <span class="literal">RGB</span> that we saw before, but with a final parameter for the opacity.</p>
<p class="indent"><a href="ch04.xhtml#ch4fig29" class="calibre10">Figure 4-29</a> shows the result of adding the inset.</p>
<div class="image1"><img alt="Image" id="ch4fig29" src="../images/ch04fig29.jpg" class="calibre6"/></div>
<p class="figcap"><em class="calibre11">Figure 4-29: Adding a floating inset to a layout</em></p>
<h3 class="h2" id="ch04lev13"><strong class="calibre2">Conclusion</strong></h3>
<p class="noindent">This chapter covered everything about the <span class="literal">Plots</span> package that you’ll need for most scientific graphics: the main types of plots, lenses and annotations, how to customize appearance, and how to lay out sets of graphs to form a composite illustration. In <a href="ch07.xhtml" class="calibre10">Chapter 7</a> we’ll find out how to make animations and explore some packages to create diagrams, and in <a href="ch08.xhtml" class="calibre10">Chapter 8</a> we’ll revisit the plotting system to learn about plot recipes.<span epub:type="pagebreak" id="page_122"/></p>
<div class="box">
<p class="boxtitle-d" id="fur4"><strong class="calibre2">FURTHER READING</strong></p>
<ul class="calibre12">
<li class="noindent1">The official reference for the <span class="literal">Plots</span> package is available at <a href="https://docs.juliaplots.org/latest/" class="calibre10"><em class="calibre11">https://docs.juliaplots.org/latest/</em></a>.</li>
<li class="noindent1">Here’s where you can find a video about <span class="literal">Plots</span>
 by its creator: <a href="http://www.breloff.com/plots-video" class="calibre10"><em class="calibre11">http://www.breloff.com/plots-video</em></a>.</li>
<li class="noindent1">For a useful guide to making publication-quality plots, visit <a href="https://nextjournal.com/leandromartinez98/tips-to-create-beautiful-publication-quality-plots-in-julia" class="calibre10"><em class="calibre11">https://nextjournal.com/leandromartinez98/tips-to-create-beautiful-publication-quality-plots-in-julia</em></a>.</li>
<li class="noindent1">More information on the HDF5 format is available at <a href="https://www.hdfgroup.org/solutions/hdf5" class="calibre10"><em class="calibre11">https://www.hdfgroup.org/solutions/hdf5</em></a>.</li>
<li class="noindent1">Documentation on using HDF5 files in Julia is available at <a href="https://juliaio.github.io/HDF5.jl/stable/" class="calibre10"><em class="calibre11">https://juliaio.github.io/HDF5.jl/stable/</em></a>.</li>
<li class="noindent1">For more information on predefined palettes for plots, visit <a href="https://docs.juliaplots.org/latest/generated/colorschemes/" class="calibre10"><em class="calibre11">https://docs.juliaplots.org/latest/generated/colorschemes/</em></a>.</li>
<li class="noindent1">The <span class="literal">Gaston</span> headquarters, at <a href="https://mbaz.github.io/Gaston.jl/stable" class="calibre10"><em class="calibre11">https://mbaz.github.io/Gaston.jl/stable</em></a>, contains a well-chosen illustration.</li>
<li class="noindent1">Information and software downloads for gnuplot are available at <a href="http://gnuplot.info" class="calibre10"><em class="calibre11">http://gnuplot.info</em></a>.</li>
<li class="noindent1">The basics of LaTeX math syntax are available at <a href="https://www.cs.princeton.edu/courses/archive/spr10/cos433/Latex/latex-guide.pdf" class="calibre10"><em class="calibre11">https://www.cs.princeton.edu/courses/archive/spr10/cos433/Latex/latex-guide.pdf</em></a> (see Section 7).</li>
<li class="noindent1">Documentation on a Julia wrapper over the powerful <em class="calibre11">plotly.js</em> interactive plotting system is available through the <span class="literal">plotlyjs</span> package: <a href="https://plotly.com/julia/" class="calibre10"><em class="calibre11">https://plotly.com/julia/</em></a>.</li>
</ul>
</div>
</body></html>