<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" epub:prefix="z3998: http://www.daisy.org/z3998/2012/vocab/structure/#" lang="en" xml:lang="en">
  <head>
    <title>Project 17: Internet of Things Control Center with Node-RED</title>
    <link href="../styles/9781593278717.css" rel="stylesheet" type="text/css"/>
    <link href="../68851547a55f.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <div id="sbo-rt-content"><h2 class="h2" id="ch17"><span epub:type="pagebreak" id="page_208"/><strong>17<br/>Internet of Things Control Center with Node-RED</strong></h2>
<p class="noindent"><span class="blue1">In this project, you’ll create an Internet of Things app to control your favorite household electronics from a web server using Node-RED, a powerful and easy-to-use tool for Internet of Things applications.</span></p>
<div class="image"><span epub:type="pagebreak" id="page_209"/><img src="../images/f0209-01.jpg" alt="image"/></div>
<p class="cap"><span class="blue1"><strong>PARTS REQUIRED</strong></span></p>
<p class="cap1">Raspberry Pi</p>
<p class="cap1">Breadboard</p>
<p class="cap1">DHT22 temperature and humidity sensor</p>
<p class="cap1">4.7 kΩ resistor</p>
<p class="cap1">Two 5 mm LEDs</p>
<p class="cap1">Two 330 Ω resistor</p>
<p class="cap1">Jumper wires</p>
<p class="cap"><span class="blue1"><strong>SOFTWARE REQUIRED</strong></span></p>
<p class="cap1">Node-RED DHT node</p>
<p class="cap1">Node-RED dashboard</p>
<p class="noindentt"><span epub:type="pagebreak" id="page_210"/>You’re going to create a Node-RED application that controls outputs and reads inputs in the local network. You’ll use it to control LEDs, as well as to read and display temperature and humidity values using the DHT22 sensor—all remotely through a web server.</p>
<h3 class="h3" id="lev174"><span class="blue1"><strong>INTRODUCING NODE-RED</strong></span></h3>
<p class="noindent">Node-RED is an open source visual wiring tool for building IoT applications that comes already installed on your Pi’s operating system and is designed to run perfectly with the Pi.</p>
<p class="indent">Node-RED uses visual programming, with blocks called <em>nodes</em> that you wire together to perform a certain task, simplifying much of the programming significantly. Node-RED allows you to prototype a complex home automation system quickly and simply, giving you more time to spend on designing and making cool stuff.</p>
<p class="indent">We won’t cover everything that Node-RED can do in this project, but here’s a brief breakdown if you want to explore further:</p>
<ul>
<li class="noindent">Access the Pi’s GPIOs.</li>
<li class="noindent">Establish a connection with other boards like the Arduino and ESP8266.</li>
<li class="noindent">Create a responsive graphical user interface.</li>
<li class="noindent">Communicate with third-party services.</li>
<li class="noindent">Retrieve data from the web.</li>
<li class="noindent">Create time-triggered events.</li>
<li class="noindent">Store and retrieve data from a database.</li>
</ul>
<h4 class="h4" id="lev175"><span class="blue1"><strong>Installing the DHT22 Nodes</strong></span></h4>
<p class="noindent">Although the Node-RED software comes already installed with the Pi’s operating system, it doesn’t come with a node able to read from the DHT22 sensor. We need to install that first, by installing npm (Node Package Management) like so:</p>
<div class="box">
<p class="programs">pi@raspberrypi:~ $ <span class="codestrong">sudo apt install npm</span></p>
</div>
<p class="indent">When prompted, type <span class="codestrong">Y</span> and press <small>ENTER</small>. The installation may take a few minutes. Then, enter the following command to upgrade npm to the latest 3.x version, which is the version recommended for use with Node-RED:</p>
<div class="box">
<p class="programs">pi@raspberrypi:~ $ <span class="codestrong">sudo npm install -g npm@3.x</span><br/>pi@raspberrypi:~ $ <span class="codestrong">hash -r</span></p>
</div>
<p class="indent"><span epub:type="pagebreak" id="page_211"/>These commands will output a warning message, but don’t worry—it’s harmless, so you can ignore it.</p>
<p class="indent">Next you’ll download and unzip a C library for the Raspberry Pi. You need this library to control DHT22 through Node-RED. At the time of writing, the latest version of the library is 1.55. Before you install the library, go to <em><a href="http://www.airspayce.com/mikem/bcm2835/">http://www.airspayce.com/mikem/bcm2835/</a></em> and check the latest version. Then, enter the following commands, replacing the <span class="literal">1.55</span> highlighted in italics with the latest version.</p>
<div class="box">
<p class="programs">pi@raspberrypi:~ $ <span class="codestrong">wget http://www.airspayce.com/mikem/bcm2835/</span><br/><span class="codestrong">bcm2835-<em>1.55</em>.tar.gz</span><br/>pi@raspberrypi:~ $ <span class="codestrong">tar zxvf bcm2835-<em>1.55</em>.tar.gz</span></p>
</div>
<p class="indent">Finally, enter the following list of commands to compile and install the nodes needed to control the DHT22 sensor and add dashboard support:</p>
<div class="box">
<p class="programs">pi@raspberrypi:~ $ <span class="codestrong">cd bcm2835-<em>1.55</em></span><br/>pi@raspberrypi:~/bcm2835-1.55 $ <span class="codestrong">./configure</span><br/>pi@raspberrypi:~/bcm2835-1.55 $ <span class="codestrong">make</span><br/>pi@raspberrypi:~/bcm2835-1.55 $ <span class="codestrong">sudo make check</span><br/>pi@raspberrypi:~/bcm2835-1.55 $ <span class="codestrong">sudo make install</span><br/>pi@raspberrypi:~/bcm2835-1.55 $ <span class="codestrong">cd</span><br/>pi@raspberrypi:~ $ <span class="codestrong">sudo npm install -–unsafe-perm -g node-dht-sensor</span><br/>pi@raspberrypi:~ $ <span class="codestrong">sudo npm install --unsafe-perm -g node-red-</span><br/><span class="codestrong">contrib-dht-sensor</span><br/>pi@raspberrypi:~ $ <span class="codestrong">sudo npm install --unsafe-perm -g node-red-</span><br/><span class="codestrong">dashboard</span></p>
</div>
<p class="indent">With all of that installed, reboot your Pi. Now we’ll give you a quick tour of Node-RED.</p>
<h4 class="h4" id="lev176"><span class="blue1"><strong>Getting Started with Node-RED</strong></span></h4>
<p class="noindent">To open Node-RED, go to the terminal and enter the following:</p>
<div class="box">
<p class="programs">pi@raspberrypi:~ $ <span class="codestrong">sudo node-red start</span></p>
</div>
<p class="indent">Your terminal window should show something like <a href="ch17.xhtml#ch17fig1">Figure 17-1</a>. The highlighted line shows your localhost’s Raspberry Pi IP address followed by the number of the port the Node-RED server is running on. <em>Localhost</em> is a hostname that means “this computer” and resolves to the IP address shown in the terminal window: http://127.0.0.1. Using this IP address you can access Node-RED only in your Raspberry Pi browser. To access Node-RED in any browser on your local network, you need to find your Pi’s IP address.</p>
<div class="note">
<p class="notet"><strong>NOTE</strong></p>
<p class="notep"><em>Usually, instead of going to the terminal, you can open Node-RED by going to the taskbar main menu and clicking <strong>Programming <span class="ent">▸</span> Node-RED</strong>. However, in this project, you need to start Node-RED from the terminal because DHT22 nodes require administrator permission.</em></p>
</div>
<div class="image"><span epub:type="pagebreak" id="page_212"/><a id="ch17fig1"/><img src="../images/f0212-01.jpg" alt="image"/></div>
<p class="figcap"><strong>FIGURE 17-1:</strong> Starting Node-RED from the terminal</p>
<p class="indent">To find your Raspberry Pi IP address, enter the following in the terminal:</p>
<div class="box">
<p class="programs">pi@raspberrypi:~ $ <span class="codestrong">hostname -I</span></p>
</div>
<p class="indent">Open Chromium and enter <em>http://&lt;Pi IP address&gt;:1880/</em>, replacing <em>&lt;Pi IP address&gt;</em> with your Raspberry Pi’s IP address. Your Node-RED page server should open as shown in <a href="ch17.xhtml#ch17fig2">Figure 17-2</a>.</p>
<div class="image"><a id="ch17fig2"/><img src="../images/f0212-02.jpg" alt="image"/></div>
<p class="figcap"><strong>FIGURE 17-2:</strong> The Node-RED editor in your browser</p>
<p class="indent">On the left you’ll see a list of blocks, or nodes. Nodes are grouped according to their function; scroll down the list to see what you have. We’ll just cover a small number of existing nodes in this project, including nodes from the input, Raspberry_Pi, function, and dashboard sections, illustrated in <a href="ch17.xhtml#ch17fig3">Figure 17-3</a>.</p>
<div class="image"><span epub:type="pagebreak" id="page_213"/><a id="ch17fig3"/><img src="../images/f0213-01.jpg" alt="image"/></div>
<p class="figcap"><strong>FIGURE 17-3:</strong> Some of the Node-RED nodes</p>
<p class="indent">The center box of your Node-RED page is the <em>flow</em> section; this is where you drag the nodes and wire them together to build your application. On the right are several tabs: the <em>info</em> tab shows information about a selected node, the <em>debug</em> tab is used for debugging purposes, and the <em>dashboard</em> tab is where you organize the user interface widgets of your application. Finally, the <em>Deploy</em> button saves the changes made to the flow and executes it. Next you’ll wire up your hardware, and then put together your flow in Node-RED.</p>
<h3 class="h3" id="lev177"><span class="blue1"><strong>WIRING THE CIRCUIT</strong></span></h3>
<p class="noindent">You should already be familiar with LEDs and the DHT22 sensor, but for a refresher on the DHT22 sensor, check <a href="ch12.xhtml#ch12">Project 12</a>. To wire the circuit, follow these instructions:</p>
<ol>
<li class="noindent"><p class="list">Connect 5 V and GND from the Pi to a red and blue breadboard rail, respectively.</p></li>
<li class="noindent"><p class="list"><span epub:type="pagebreak" id="page_214"/>Insert two LEDs into the breadboard. Wire the shorter lead of each LED to the GND rail through a 330 Ω resistor. Wire the longer lead of one LED to GPIO 18, and the longer lead of the other LED to GPIO 17.</p></li>
<li class="noindent"><p class="list">Insert the DHT22 into the breadboard (with the raised side facing you) and wire it according to the following table. Your completed circuit should match <a href="ch17.xhtml#ch17fig4">Figure 17-4</a>.</p></li>
</ol>
<table class="topbot-d">
<thead>
<tr>
<td style="vertical-align: top;" class="border_th-o"><p class="tab_th"><strong>DHT22</strong></p></td>
<td style="vertical-align: top;" class="border_tha"><p class="tab_th"><strong>RASPBERRY PI</strong></p></td>
</tr>
</thead>
<tbody>
<tr>
<td style="vertical-align: top;" class="table-o"><p class="tabc"><span class="blue1">1</span></p></td>
<td style="vertical-align: top;" class="table-a"><p class="tabc"><span class="blue1">3.3 V</span></p></td>
</tr>
<tr>
<td style="vertical-align: top;" class="table-o"><p class="tabc"><span class="blue1">2</span></p></td>
<td style="vertical-align: top;" class="table-a"><p class="tabc"><span class="blue1">GPIO 4 and 3.3 V (via 4.7 kΩ resistor)</span></p></td>
</tr>
<tr>
<td style="vertical-align: top;" class="table-o"><p class="tabc"><span class="blue1">3</span></p></td>
<td style="vertical-align: top;" class="table-a"><p class="tabc"><span class="blue1">Don’t connect</span></p></td>
</tr>
<tr>
<td style="vertical-align: top;" class="table-o"><p class="tabc"><span class="blue1">4</span></p></td>
<td style="vertical-align: top;" class="table-a"><p class="tabc"><span class="blue1">GND</span></p></td>
</tr>
</tbody>
</table>
<div class="image"><a id="ch17fig4"/><img src="../images/f0214-01.jpg" alt="image"/></div>
<p class="figcap"><strong>FIGURE 17-4:</strong> Wiring the DHT22 and two LEDs to the Pi</p>
<h3 class="h3" id="lev178"><span class="blue1"><strong>CREATING THE FLOW</strong></span></h3>
<p class="noindent">The script, in this case, is the flow you’ll make in Node-RED. This flow will allow you to do the following:</p>
<ul>
<li class="noindent">Control an LED with an on and off switch. This LED will also be time-sensitive, which means it will automatically light up and turn off at a specific time that you set.</li>
<li class="noindent"><span epub:type="pagebreak" id="page_215"/>Control another LED with PWM using a slider to act as a dimmer switch.</li>
<li class="noindent">Read the temperature from the DHT22 sensor and display it on a time-versus-temperature chart.</li>
<li class="noindent">Read the humidity from the DHT22 sensor and display it on a gauge.</li>
</ul>
<p class="indent">First you’ll make the user interface you’ll use to control the components from your server.</p>
<h4 class="h4" id="lev179"><span class="blue1"><strong>Creating the Dashboard User Interface</strong></span></h4>
<p class="noindent">Nodes from the dashboard section provide widgets that show up in your application user interface (UI) to control components. Every widget—like a button, slider, or chart—you add to the flow has to be associated with a <em>group</em> that tells the widget where it should appear on the UI.</p>
<p class="indent">You’ll also need tabs, which are like pages in your application (like tabs in a browser). Groups are sections within a tab, where you can group widgets together. In any project, you’ll need to create tabs and groups in your dashboard to organize the widgets in the UI. You’ll build a tab called “Home” with one group called “Dashboard.”</p>
<p class="indent">Using <a href="ch17.xhtml#ch17fig5">Figure 17-5</a> as a reference, select the <strong>dashboard</strong> tab <span class="ent">➊</span> in the top right and then press the <strong>+ tab</strong> button <span class="ent">➋</span> to create a new tab under the Tabs list. Click <strong>edit</strong> to edit the tab <span class="ent">➌</span> and enter the name <span class="codestrong">Home</span>. Once that’s created, press the <strong>+ group</strong> button <span class="ent">➍</span> to create a new group; then click <strong>edit</strong> <span class="ent">➎</span> and enter the name <span class="codestrong">Dashboard</span>.</p>
<div class="image"><a id="ch17fig5"/><img src="../images/f0215-01.jpg" alt="image"/></div>
<p class="figcap"><strong>FIGURE 17-5:</strong> Creating tabs and groups in the dashboard</p>
<p class="indent">To see how your dashboard currently looks, go to <em>http://&lt;Pi IP address&gt;:1880/ui</em> in your browser, replacing <em>&lt;Pi IP address&gt;</em> with your Raspberry Pi’s IP address you got earlier. As you can see in <a href="ch17.xhtml#ch17fig6">Figure 17-6</a>, your user interface is empty at the moment because you haven’t added any widgets, so let’s add some functionality next.</p>
<div class="image"><span epub:type="pagebreak" id="page_216"/><a id="ch17fig6"/><img src="../images/f0216-01.jpg" alt="image"/></div>
<p class="figcap"><strong>FIGURE 17-6:</strong> The Node-RED user interface</p>
<h4 class="h4" id="lev180"><span class="blue1"><strong>Wiring the Nodes</strong></span></h4>
<p class="noindent">Now you’re going to add nodes to your flow. Your flow will control the LEDs connected to the Raspberry Pi GPIOs and read temperature and humidity from the DHT22 sensor.</p>
<h5 class="h5"><strong>Adding a Switch and Scheduling Events</strong></h5>
<p class="noindent">Go back to the Node-RED editor and add two inject nodes from the input section by dragging them into the flow. When you drop them in the flow, their name will change to <em>timestamp</em>. Add a switch from the dashboard section, and an rpi gpio output node (the one with a joint on the left side) from the Raspberry_Pi nodes section. Arrange the nodes and wire them as shown in <a href="ch17.xhtml#ch17fig7">Figure 17-7</a>.</p>
<div class="image"><a id="ch17fig7"/><img src="../images/f0216-02.jpg" alt="image"/></div>
<p class="figcap"><strong>FIGURE 17-7:</strong> The flow for controlling LED 1</p>
<p class="indent">This set of nodes controls the LED connected to GPIO 17. This LED can be controlled remotely with an on and off switch, and it is also time sensitive; timestamp 1 determines the time the LED lights up, and timestamp 2 determines the time the LED turns off.</p>
<p class="indent">If you double-click a node, a new window will open that allows you to edit the node’s properties. Double-click the first timestamp node and edit its properties like so: set the payload number to <strong>1</strong>, which sends 1 to the Raspberry Pi GPIO 17 when this node is triggered. In the repeat field, select <strong>at a specific time</strong> and choose the <span epub:type="pagebreak" id="page_217"/>time and day you want your LED to light up; you’ll choose the time to turn it off in timestamp 2. We chose 19:00 (7 <small>PM</small>) for all days of the week. You can choose whatever times and days you want. The name field lets you name the node, and in our case we’ve called it <strong>On at 7PM</strong>. When you’re done editing your node, click the <strong>Done</strong> button. <a href="ch17.xhtml#ch17fig8">Figure 17-8</a> shows the properties we set for this node.</p>
<div class="image"><a id="ch17fig8"/><img src="../images/f0217-01.jpg" alt="image"/></div>
<p class="figcap"><strong>FIGURE 17-8:</strong> Editing the inject node properties</p>
<p class="indent">Edit the other nodes’ properties to match those in the following table.</p>
<table class="topbot-d">
<thead>
<tr>
<td style="vertical-align: top;" class="border_th-o"><p class="tab_th"><strong>NODE</strong></p></td>
<td style="vertical-align: top;" class="border_tha"><p class="tab_th"><strong>PROPERTIES</strong></p></td>
</tr>
</thead>
<tbody>
<tr>
<td style="vertical-align: middle;" class="table-o"><p class="taba"><span class="blue1">timestamp</span></p></td>
<td style="vertical-align: top;" class="table-a"><p class="taba"><span class="blue1">Payload: number 1<br/>Repeat: at a specific time<br/>At: 19:00<br/>On: select all days</span></p></td>
</tr>
<tr>
<td style="vertical-align: middle;" class="table-o"><p class="taba"><span class="blue1">timestamp</span></p></td>
<td style="vertical-align: top;" class="table-a"><p class="taba"><span class="blue1">Payload: number 0<br/>Repeat: at a specific time<br/>At: 23:00<br/>On: select all days</span></p></td>
</tr>
<tr>
<td style="vertical-align: middle;" class="table-o"><p class="taba"><span class="blue1">switch</span></p></td>
<td style="vertical-align: top;" class="table-a"><p class="taba"><span class="blue1">Group: Dashboard [Home]<br/>Label: LED 1<br/>On Payload: number 1<br/>Off Payload: number 0<br/>Name: LED 1 – Switch</span></p></td>
</tr>
<tr>
<td style="vertical-align: middle;" class="table-o"><p class="taba"><span class="blue1">pin</span></p></td>
<td style="vertical-align: top;" class="table-a"><p class="taba"><span class="blue1">GPIO: GPIO17 – 11<br/>Type: Digital output<br/>Name: LED 1 – GPIO 17</span></p></td>
</tr>
</tbody>
</table>
<p class="indent"><span epub:type="pagebreak" id="page_218"/>To run your Node-RED application, click the <strong>Deploy</strong> button at the top right. This will also save the changes. To see how your application looks, go to <em>http://&lt;Pi IP address&gt;:1880/ui</em> in the browser. At this point, it should look like <a href="ch17.xhtml#ch17fig9">Figure 17-9</a>.</p>
<div class="image"><a id="ch17fig9"/><img src="../images/f0218-01.jpg" alt="image"/></div>
<p class="figcap"><strong>FIGURE 17-9:</strong> The user interface with the LED 1 control switch</p>
<p class="indent">Click the switch to test whether you can control the LED connected to GPIO 17. If not, go back and make sure you’ve wired your nodes correctly and set the right properties.</p>
<h5 class="h5"><strong>Adding a Slider</strong></h5>
<p class="noindent">Now, you’ll add the nodes to control the brightness of the LED connected to GPIO 18. Drag a slider and an rpi gpio output node into the flow, and arrange them as in <a href="ch17.xhtml#ch17fig10">Figure 17-10</a>.</p>
<div class="image"><a id="ch17fig10"/><img src="../images/f0218-02.jpg" alt="image"/></div>
<p class="figcap"><strong>FIGURE 17-10:</strong> The flow for controlling LED 1 and LED 2</p>
<p class="indent">Edit the new nodes’ properties as shown in the following table.</p>
<table class="topbot-d">
<thead>
<tr>
<td style="vertical-align: top;" class="border_th-o"><p class="tab_th"><strong>NODE</strong></p></td>
<td style="vertical-align: top;" class="border_tha"><p class="tab_th"><strong>PROPERTIES</strong></p></td>
</tr>
</thead>
<tbody>
<tr>
<td style="vertical-align: middle;" class="table-o"><p class="taba"><span class="blue1">slider</span></p></td>
<td style="vertical-align: top;" class="table-a"><p class="taba"><span class="blue1">Group: Dashboard [Home]<br/>Label: LED 2<br/>Range: min:0; max:100; step:1<br/>Name: LED 2 – Slider</span></p></td>
</tr>
<tr>
<td style="vertical-align: middle;" class="table-o"><p class="taba"><span class="blue1">pin</span></p></td>
<td style="vertical-align: top;" class="table-a"><p class="taba"><span class="blue1">GPIO: 12 – GPIO18<br/>Type: PWM output<br/>Name: LED 2 – GPIO 18</span></p></td>
</tr>
</tbody>
</table>
<p class="indent"><span epub:type="pagebreak" id="page_219"/>This new set of nodes controls the LED connected to GPIO 18 using PWM. Moving the slider will change the LED brightness. Click the <strong>Deploy</strong> button, go to the Node-RED UI, and test your application. It should look something like <a href="ch17.xhtml#ch17fig11">Figure 17-11</a>.</p>
<div class="image"><a id="ch17fig11"/><img src="../images/f0219-01.jpg" alt="image"/></div>
<p class="figcap"><strong>FIGURE 17-11:</strong> The user interface with the LED 1 switch and the LED 2 slider</p>
<h5 class="h5"><strong>Adding a Temperature Chart and Humidity Gauge</strong></h5>
<p class="noindent">Finally, to create a temperature chart and a humidity gauge, drag an inject node, rpi dht22 node, function node, a chart, and a gauge to the flow. The chart and the gauge are dashboard nodes. Arrange the nodes so your flow looks like <a href="ch17.xhtml#ch17fig13">Figure 17-13</a>.</p>
<div class="image"><a id="ch17fig12"/><img src="../images/f0219-02.jpg" alt="image"/></div>
<p class="figcap"><strong>FIGURE 17-12:</strong> The complete Node-RED flow</p>
<p class="indent"><span epub:type="pagebreak" id="page_220"/>Edit the new nodes’ properties with the settings in the following table.</p>
<table class="topbot-d">
<thead>
<tr>
<td style="vertical-align: top;" class="border_th-o"><p class="tab_th"><strong>NODE</strong></p></td>
<td style="vertical-align: top;" class="border_tha"><p class="tab_th"><strong>PROPERTIES</strong></p></td>
</tr>
</thead>
<tbody>
<tr>
<td style="vertical-align: middle;" class="table-o"><p class="taba"><span class="blue1">timestamp</span></p></td>
<td style="vertical-align: top;" class="table-a"><p class="taba"><span class="blue1">Payload: Boolean true<br/>Repeat: interval<br/>Every: 1 minute<br/>Name: Read DHT22</span></p></td>
</tr>
<tr>
<td style="vertical-align: middle;" class="table-o"><p class="taba"><span class="blue1">rpi-dht22</span></p></td>
<td style="vertical-align: top;" class="table-a"><p class="taba"><span class="blue1">Sensor model: DHT22<br/>Pin numbering: BCM GPIO<br/>Pin number: 4<br/>Name: DHT22 – GPIO 4</span></p></td>
</tr>
<tr>
<td style="vertical-align: middle;" class="table-o"><p class="taba"><span class="blue1">chart</span></p></td>
<td style="vertical-align: top;" class="table-a"><p class="taba"><span class="blue1">Group: Dashboard [Home]<br/>Label: Temperature<br/>Type: Line Chart<br/>X-axis: 1 hour<br/>X-axis Label: HH:mm<br/>Name: Temperature – Chart</span></p></td>
</tr>
<tr>
<td style="vertical-align: middle;" class="table-o"><p class="taba"><span class="blue1">f</span></p></td>
<td style="vertical-align: top;" class="table-a"><p class="taba"><span class="blue1">Name: Get humidity<br/>Function:<br/>msg.payload = msg.humidity;<br/>return msg;</span></p></td>
</tr>
<tr>
<td style="vertical-align: middle;" class="table-o"><p class="taba"><span class="blue1">gauge</span></p></td>
<td style="vertical-align: top;" class="table-a"><p class="taba"><span class="blue1">Group: Dashboard [Home]<br/>Type: Gauge<br/>Label: Humidity<br/>Value format: {{value}}<br/>Units: %<br/>Range: min:0; max:100<br/>Name: Humidity - Gauge</span></p></td>
</tr>
</tbody>
</table>
<p class="indent">Click the <strong>Deploy</strong> button and once again test your application. Remember, if you run into any trouble, make sure that your properties match the tables here and double-check the wiring of your nodes against the figures.</p>
<h3 class="h3" id="lev181"><span class="blue1"><strong>RUNNING YOUR APPLICATION</strong></span></h3>
<p class="noindent">Congratulations! You’ve built your first IoT application with Node-RED. Go to <em>http://&lt;Pi IP address&gt;:1880/ui</em> to see how your user interface looks. You can access this URL using any browser on the local network, whether that’s on your computer or smartphone. <a href="ch17.xhtml#ch17fig13">Figure 17-13</a> shows the final circuit you can control using your Node-RED application.</p>
<div class="image"><span epub:type="pagebreak" id="page_221"/><a id="ch17fig13"/><img src="../images/f0221-01.jpg" alt="image"/></div>
<p class="figcap"><strong>FIGURE 17-13:</strong> IoT project with Node-RED</p>
<p class="indent">Your application has a switch to control LED 1, which is also time sensitive; a slider to control the brightness of LED 2; and a chart and gauge to display temperature and humidity.</p>
<h3 class="h3" id="lev182"><span class="blue1"><strong>TAKING IT FURTHER</strong></span></h3>
<p class="noindent">This project just scratched the surface of what Node-RED can do. Here are some ideas for taking this project further:</p>
<ul>
<li class="noindent">Replace the time-sensitive LED with a relay and a lamp (refer to <a href="ch16.xhtml#ch16">Project 16</a> for an introduction to the relay module).</li>
<li class="noindent">Add more sensor readings to your application, like the smoke sensor and movement detection.<span epub:type="pagebreak" id="page_222"/></li>
</ul>
</div>
  </body>
</html>
