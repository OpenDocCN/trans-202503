<html><head></head><body><div class="chapter" title="Chapter&#xA0;2.&#xA0;Rails Fundamentals"><div class="titlepage"><div><div><h1 class="title"><a id="rails_fundamentals"/>Chapter 2. Rails Fundamentals</h1></div></div></div><p><a class="indexterm" id="iddle1598"/><a class="indexterm" id="iddle1660"/><a class="indexterm" id="iddle2027"/><a class="indexterm" id="iddle2030"/><a class="indexterm" id="iddle2125"/><span class="emphasis"><em>Ruby on Rails</em></span> is an open source web framework. Like the
        Ruby language, it emphasizes programmer happiness and productivity. As you’ll see, it
        includes sensible defaults that allow you to spend less time dealing with configuration and
        more time writing code. It also creates a directory structure for your application with a
        place for every file you need.</p><p>Rails was created by David Heinemeier Hansson. He extracted the framework from the
        project management application Basecamp that he built for 37signals. It was first released
        as open source in July 2004.</p><p>Rails is also a <span class="emphasis"><em>full-stack</em></span> web framework. This means it contains
        everything you need to build web applications that accept user requests, query databases,
        and respond with data rendered in templates.</p><p>Enter the following command in a terminal to ensure that Rails is installed:</p><a id="pro_id00059"/><pre class="programlisting">$ <span class="strong"><strong>rails --version</strong></span></pre><p><a class="indexterm" id="iddle1235"/><a class="indexterm" id="iddle1269"/><a class="indexterm" id="iddle1307"/><a class="indexterm" id="iddle1501"/><a class="indexterm" id="iddle1605"/><a class="indexterm" id="iddle1846"/><a class="indexterm" id="iddle2038"/><a class="indexterm" id="iddle2059"/><a class="indexterm" id="iddle2149"/><a class="indexterm" id="iddle2330"/><a class="indexterm" id="iddle2333"/>This should display Rails 4.0.0 or greater. If not, check the installation
        instructions for Rails in <a class="xref" href="pr03.html#rubycomma_railscomma_and_git" title="Ruby, Rails, and Git">Ruby, Rails, and Git</a>.</p><div class="sect1" title="Your First Rails Application"><div class="titlepage"><div><div><h1 class="title"><a id="your_first_rails_application"/>Your First Rails Application</h1></div></div></div><p>Rails makes getting started easy, so let’s dive right in. You’re only five
          commands away from having a running Rails web application.</p><p>Just like Jedi Knights build their own lightsabers, I think web developers should
          build their own personal websites, so that’s where we’ll start. I use my
          website as a playground for testing new ideas. In the fast-moving world of Ruby on Rails,
          keeping your own site up-to-date also helps you learn to use new features as they are
          released.</p><p>Open a terminal window and create a directory for your Rails projects. I call mine
            <span class="emphasis"><em>code</em></span>, but you can use any name you like.</p><a id="pro_id00060"/><pre class="programlisting">$ <span class="strong"><strong>mkdir code</strong></span>
$ <span class="strong"><strong>cd code</strong></span></pre><p>Now use the <code class="literal">rails new</code> command to create a new application. Our
          first application will be a simple weblog, so let’s just call it
            <span class="emphasis"><em>blog</em></span>.</p><a id="pro_id00061"/><pre class="programlisting">$ <span class="strong"><strong>rails new blog</strong></span></pre><p>This command creates all of the files your new application needs and then runs the
            <code class="literal">bundle install</code> command to download and install any other gems needed
          by Rails. (<span class="emphasis"><em>Gems</em></span> are packaged Ruby applications or libraries.)
          Depending on your connection speed, this may take a few minutes. When the install is
          complete, use the <code class="literal">cd</code> command to move to the newly created
            <span class="emphasis"><em>blog</em></span> directory:</p><a id="pro_id00062"/><pre class="programlisting">$ <span class="strong"><strong>cd blog</strong></span></pre><p>Finally, use the <code class="literal">rails server</code> command to launch a server so you can
          see your new application. When you created this application, a directory called
            <span class="emphasis"><em>bin</em></span> was also created inside <span class="emphasis"><em>blog</em></span>. The
            <span class="emphasis"><em>bin</em></span> directory is where you’ll find <code class="literal">rails</code>
          and other commands you’ll need later.</p><a id="pro_id00063"/><pre class="programlisting">$ <span class="strong"><strong>bin/rails server</strong></span></pre><p>This command starts the WEBrick server that is built in to Ruby. Once the server has
          started, open your web browser and go to this address:
            <span class="emphasis"><em>http://localhost:3000</em></span>. If everything worked correctly, you should
          see a web page like the one in <a class="xref" href="ch02.html#your_first_rails_application-id00001" title="Figure 2-1. Your first Rails application">Figure 2-1</a>.</p><div class="figure"><a id="your_first_rails_application-id00001"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00001"/><img alt="Your first Rails application" src="httpatomoreillycomsourcenostarchimages2169060.png.jpg"/></div></div><p class="title">Figure 2-1. Your first Rails application</p></div><p><a class="indexterm" id="iddle1385"/><a class="indexterm" id="iddle2033"/>Congratulations! You’re officially a Ruby on Rails developer. The page
          you just created includes some tips for getting started with your application, but before
          we get into that, let’s learn a little more about Rails.</p></div><div class="sect1" title="Rails Principles"><div class="titlepage"><div><div><h1 class="title"><a id="rails_principles"/>Rails Principles</h1></div></div></div><p>The Rails framework is based on two well-known software engineering principles.
          Understanding these principles will help you understand the “Rails way” of
          building applications.</p><div class="sect2" title="Convention over Configuration"><div class="titlepage"><div><div><h2 class="title"><a id="convention_over_configuration"/>Convention over Configuration</h2></div></div></div><p>You didn’t have to configure anything to get a basic Rails application up and
            running. In Rails, this concept is known as <span class="emphasis"><em>convention over
              configuration</em></span>. As long as you follow the Rails conventions, everything
            should just work.</p><p>Rails makes many choices for you when you create an application. Those choices
            include which web server and database server to run in development mode and which
            JavaScript library and testing library your application will use. Even the names of your
            application’s database tables and models are chosen automatically based on
            convention. You can certainly break convention and change those settings if you’d
            like, but then you’ll have to configure some things for yourself.</p></div><div class="sect2" title="Don’t Repeat Yourself"><div class="titlepage"><div><div><h2 class="title"><a id="donapostrophet_repeat_yourself"/>Don’t Repeat Yourself</h2></div></div></div><p><a class="indexterm" id="iddle1105"/><a class="indexterm" id="iddle1273"/><a class="indexterm" id="iddle1511"/><a class="indexterm" id="iddle1515"/><a class="indexterm" id="iddle1532"/><a class="indexterm" id="iddle1543"/><a class="indexterm" id="iddle1681"/><a class="indexterm" id="iddle1702"/><a class="indexterm" id="iddle1769"/><a class="indexterm" id="iddle1779"/><a class="indexterm" id="iddle1851"/><a class="indexterm" id="iddle1860"/><a class="indexterm" id="iddle2028"/><a class="indexterm" id="iddle2090"/><a class="indexterm" id="iddle2192"/><a class="indexterm" id="iddle2294"/><a class="indexterm" id="iddle2319"/><a class="indexterm" id="iddle2341"/>The other key principle in Rails is <span class="emphasis"><em>don’t repeat
              yourself</em></span>, often abbreviated <span class="emphasis"><em>DRY</em></span>. In Rails, you avoid
            duplicating knowledge within your application. Specifying the same information in more
            than one place can lead to errors when you change one instance and not the other.</p><p>You’ll see several examples of the DRY principle as we work our way through
            the Rails architecture and directory structure. There is a single, specific place for
            each part of a Rails application. Things that can be inferred from another source, such
            as the names of columns in a database table, don’t need to be specified
            anywhere.</p></div></div><div class="sect1" title="Rails Architecture"><div class="titlepage"><div><div><h1 class="title"><a id="rails_architecture"/>Rails Architecture</h1></div></div></div><p>Rails applications are structured around the <span class="emphasis"><em>model-view-controller
            (MVC)</em></span> software engineering pattern. The MVC pattern is designed to separate
          an application’s data from a user’s interaction with it. This separation of
          concerns usually results in an application that is easier to understand and
          maintain.</p><div class="sect2" title="Model"><div class="titlepage"><div><div><h2 class="title"><a id="model"/>Model</h2></div></div></div><p>The <span class="emphasis"><em>model</em></span> represents your application’s data and the
            rules for manipulating that data. The application’s data is sometimes referred to
            as the application’s <span class="emphasis"><em>state</em></span>. The rules for manipulating this
            data are also known as <span class="emphasis"><em>business logic</em></span>. All changes to your
            application’s state must pass through the model layer.</p><p>Rails models contain code for data validation and associations between models. Most
            of the code you write will be inside of a Rails model, unless it is directly involved
            with the user’s view of the data.</p></div><div class="sect2" title="View"><div class="titlepage"><div><div><h2 class="title"><a id="view"/>View</h2></div></div></div><p>The <span class="emphasis"><em>view</em></span> is the user interface for your application. Because we
            are building web applications, the view will consist mainly of HTML. Rails uses a
            template system called <span class="emphasis"><em>Embedded Ruby (ERB)</em></span> by default.</p><p>Embedded Ruby allows you to include Ruby code for accessing data within an HTML
            template. When the user requests a page, the Ruby code in the template is evaluated by
            the server, and the resulting HTML page is sent to the user.</p><p>The ability to embed Ruby code inside a view can sometimes lead programmers to
            include too much code inside a view. Doing this is problematic because if you add
            another view, then that code will need to be duplicated. Code used only by the view can
            be moved to a <span class="emphasis"><em>helper</em></span>, which is a method meant specifically for use
            in the view. In general, a view should never contain code more complex than a simple
            conditional statement.</p><div class="note" title="Note"><h3 class="title"><a id="ch02note01"/>Note</h3><p><span class="emphasis"><em>In addition to HTML pages, Rails can also generate JSON and XML. Ruby
                has built-in support for generating CSV files, and gems are available for generating
                other types of output, such as PDF documents and Excel
              spreadsheets.</em></span></p></div></div><div class="sect2" title="Controller"><div class="titlepage"><div><div><h2 class="title"><a id="controller"/>Controller</h2></div></div></div><p><a class="indexterm" id="iddle1180"/><a class="indexterm" id="iddle1236"/><a class="indexterm" id="iddle1359"/><a class="indexterm" id="iddle1376"/><a class="indexterm" id="iddle1495"/><a class="indexterm" id="iddle1541"/><a class="indexterm" id="iddle1688"/><a class="indexterm" id="iddle1815"/><a class="indexterm" id="iddle2004"/><a class="indexterm" id="iddle2040"/><a class="indexterm" id="iddle2057"/><a class="indexterm" id="iddle2160"/><a class="indexterm" id="iddle2241"/>The <span class="emphasis"><em>controller</em></span> is like the glue that holds together the
            model and the view. The controller is responsible for accepting a request from the user,
            gathering the necessary data from the model, and rendering the correct view. This sounds
            like a lot of work, but thanks to the conventions used in Rails applications, the
            process happens almost automatically.</p><p>In Rails, the controller is simply a Ruby class with methods that correspond to the
            various actions in your application. For example, in your blog application, you have a
            method named <code class="literal">show</code> for displaying a blog post and a method named
              <code class="literal">new</code> for adding a new post.</p></div></div><div class="sect1" title="Rails Application Structure"><div class="titlepage"><div><div><h1 class="title"><a id="rails_application_structure"/>Rails Application Structure</h1></div></div></div><p>Now that you’re familiar with the principles and architecture used by Rails,
          let’s see where these pieces live within the directory structure created by the
            <code class="literal">rails new</code> command. Inside the blog directory, you should find 10
          subdirectories.</p><div class="sect2" title="The app Directory"><div class="titlepage"><div><div><h2 class="title"><a id="app_directory"/>The app Directory</h2></div></div></div><p>The <span class="emphasis"><em>app</em></span> directory is where you’ll spend most of your time
            while building your application. It contains subdirectories for each part of the MVC
            architecture discussed previously, as well as <span class="emphasis"><em>assets</em></span>,
              <span class="emphasis"><em>helpers</em></span>, and <span class="emphasis"><em>mailers</em></span>.</p><p>The <span class="emphasis"><em>assets</em></span> directory holds the images, JavaScript files, and
            CSS style-sheets used by your application. The <span class="emphasis"><em>helpers</em></span> directory
            contains Ruby files with methods used by your views. The <span class="emphasis"><em>mailers</em></span>
            directory is for Ruby classes used to send email.</p></div><div class="sect2" title="The bin Directory"><div class="titlepage"><div><div><h2 class="title"><a id="bin_directory"/>The bin Directory</h2></div></div></div><p>The <span class="emphasis"><em>bin</em></span> directory holds simple Ruby scripts for accessing the
              <span class="emphasis"><em>bundle</em></span>, <span class="emphasis"><em>rails</em></span>, and <span class="emphasis"><em>rake</em></span>
            command-line programs used while building your application. These scripts ensure that
            the three programs run in the context of the current Rails application. You can have
            multiple versions of these programs installed at the same time, which can lead to errors
            if you don’t use the scripts in <span class="emphasis"><em>bin</em></span> to access them.</p></div><div class="sect2" title="The config Directory"><div class="titlepage"><div><div><h2 class="title"><a id="config_directory"/>The config Directory</h2></div></div></div><p>Rails makes heavy use of convention over configuration, but sometimes configuration
            is unavoidable. In those cases, look to the <span class="emphasis"><em>config</em></span>
            directory.</p><p>The <span class="emphasis"><em>environments</em></span> subdirectory contains configuration files for
            the three different environments created automatically by Rails. An environment is a
            collection of settings used for a specific purpose such as development or testing. These
            settings are stored in <span class="emphasis"><em>development.rb</em></span> (used while developing your
            application), <span class="emphasis"><em>test.rb</em></span> (used while running automated tests), and
              <span class="emphasis"><em>production.rb</em></span> (used after your application is deployed and
            running in production).</p><p><a class="indexterm" id="iddle1001"/><a class="indexterm" id="iddle1002"/><a class="indexterm" id="iddle1003"/><a class="indexterm" id="iddle1111"/><a class="indexterm" id="iddle1181"/><a class="indexterm" id="iddle1438"/><a class="indexterm" id="iddle1446"/><a class="indexterm" id="iddle1458"/><a class="indexterm" id="iddle1494"/><a class="indexterm" id="iddle1549"/><a class="indexterm" id="iddle1798"/><a class="indexterm" id="iddle1805"/><a class="indexterm" id="iddle2011"/><a class="indexterm" id="iddle2061"/><a class="indexterm" id="iddle2115"/><a class="indexterm" id="iddle2134"/><a class="indexterm" id="iddle2145"/><a class="indexterm" id="iddle2187"/><a class="indexterm" id="iddle2210"/>The file <span class="emphasis"><em>application.rb</em></span> contains the settings for all
            environments. Information in one of the specific environment files just mentioned will,
            however, take precedence over settings here.</p><p>The file <span class="emphasis"><em>database.yml</em></span> holds database configuration for each of
            the three environments. Rails creates a SQLite database, by default, when you run
              <code class="literal">rails new</code>, so the default settings in
              <span class="emphasis"><em>database.yml</em></span> are for that SQLite database. This database is a
            single file that you will use during development. You usually want to specify a
            different database server to use in production.</p><p>The file <span class="emphasis"><em>routes.rb</em></span> maps the web address entered by the user to
            a specific controller and action in your application. As you add resources and actions
            to your application, you need to update this file to reflect the changes. I cover
            resource-based routing during the discussion of controllers in <a class="xref" href="ch04.html" title="Chapter 4. Controllers">Chapter 4</a>.</p></div><div class="sect2" title="The db Directory"><div class="titlepage"><div><div><h2 class="title"><a id="db_directory"/>The db Directory</h2></div></div></div><p>The <span class="emphasis"><em>db</em></span> directory initially contains only a single file called
              <span class="emphasis"><em>seeds.rb</em></span>. Use this file to create your application’s
            default data. For example, in an application with user accounts, you may want to include
            a special “admin” user here.</p><p>As you build your application, you will create <span class="emphasis"><em>database
              migrations</em></span>, Ruby scripts that create and modify the tables in your
            database. A directory named <span class="emphasis"><em>migrate</em></span> is created to hold these
            database migration files. The file <span class="emphasis"><em>schema.rb</em></span>, which shows the
            current state of your application’s database, is created as well. If you use the
            default SQLite database in your application, the database itself is also placed in this
            folder.</p></div><div class="sect2" title="The lib Directory"><div class="titlepage"><div><div><h2 class="title"><a id="lib_directory"/>The lib Directory</h2></div></div></div><p>The <span class="emphasis"><em>lib</em></span> directory is the place to put any reusable library code
            you write. This directory is initially empty except for two subdirectories: assets and
            tasks. <span class="emphasis"><em>Assets</em></span> are images, CSS stylesheets, and JavaScript files.
              <span class="emphasis"><em>Tasks</em></span> are Ruby scripts used to automate actions such as managing
            your application’s database, clearing log and temporary files, and running tests.
            These tasks are executed using the <code class="literal">rake</code> command.</p></div><div class="sect2" title="The log Directory"><div class="titlepage"><div><div><h2 class="title"><a id="log_directory"/>The log Directory</h2></div></div></div><p>As your application runs, data is written to a file in the <span class="emphasis"><em>log</em></span>
            directory. When you run your code in the development environment, this file is named
              <span class="emphasis"><em>development.log</em></span>. Separate files will be created for the test and
            production environments.</p></div><div class="sect2" title="The public Directory"><div class="titlepage"><div><div><h2 class="title"><a id="public_directory"/>The public Directory</h2></div></div></div><p>Files in the <span class="emphasis"><em>public</em></span> directory are sent to users as if the files
            were in the root directory of your application. For example, three files in this
            directory are for error messages—<span class="emphasis"><em>404.html</em></span>,
              <span class="emphasis"><em>422.html</em></span>, and <span class="emphasis"><em>500.html</em></span>. You can see one of
            these files in your browser by adding its name to your address bar. If you visit
              <span class="emphasis"><em>http://localhost:3000/404.html</em></span>, for example, you should see the
            default “page does not exist” error page.</p><p><a class="indexterm" id="iddle1266"/><a class="indexterm" id="iddle1271"/><a class="indexterm" id="iddle1559"/><a class="indexterm" id="iddle1601"/><a class="indexterm" id="iddle2029"/><a class="indexterm" id="iddle2078"/><a class="indexterm" id="iddle2112"/><a class="indexterm" id="iddle2211"/><a class="indexterm" id="iddle2216"/><a class="indexterm" id="iddle2227"/><a class="indexterm" id="iddle2228"/><a class="indexterm" id="iddle2257"/><a class="indexterm" id="iddle2316"/>This directory also holds a default <span class="emphasis"><em>favicon.ico</em></span>, the
            image that appears in the address bar of most browsers, and a
              <span class="emphasis"><em>robots.txt</em></span> file that controls how search engines index your
            application. You can modify all of these files for your application. You’ll
            probably want to customize the error pages with your own branding and add a custom
            favicon for your site.</p></div><div class="sect2" title="The test Directory"><div class="titlepage"><div><div><h2 class="title"><a id="test_directory"/>The test Directory</h2></div></div></div><p>The <span class="emphasis"><em>test</em></span> directory contains subdirectories with automated tests
            for each part of your application. It also holds the script
              <span class="emphasis"><em>test_helper.rb</em></span>, which loads the test environment settings in
              <span class="emphasis"><em>config/environments/test.rb</em></span> and adds helper methods used in your
            tests.</p><p>Some Rails developers practice <span class="emphasis"><em>test-driven development (TDD)</em></span>.
            In TDD, you first write an automated test describing a new feature; then you add just
            enough code to make the test pass; and finally you <span class="emphasis"><em>refactor</em></span>, or
            restructure, the code as needed to improve readability and reduce complexity.</p></div><div class="sect2" title="The tmp Directory"><div class="titlepage"><div><div><h2 class="title"><a id="tmp_directory"/>The tmp Directory</h2></div></div></div><p>The <span class="emphasis"><em>tmp</em></span> directory contains ephemeral files. Here, you find
            cached copies of your application’s assets, process id files (pids) for running
            programs (such as your web server), user sessions, and files representing sockets being
            used by your application.</p><div class="note" title="Note"><h3 class="title"><a id="ch02note02"/>Note</h3><p><span class="emphasis"><em>Because these files usually do not need to be saved, version control
                systems ignore them.</em></span></p></div></div><div class="sect2" title="The vendor Directory"><div class="titlepage"><div><div><h2 class="title"><a id="vendor_directory"/>The vendor Directory</h2></div></div></div><p>Finally, the <span class="emphasis"><em>vendor</em></span> directory holds assets needed by
            third-party gems that you add to your application. Its purpose is similar to the
              <span class="emphasis"><em>lib</em></span> directory, except it is used by libraries that you did not
            write yourself.</p></div></div><div class="sect1" title="Rails Commands"><div class="titlepage"><div><div><h1 class="title"><a id="rails_commands"/>Rails Commands</h1></div></div></div><p>You use four different command-line programs when building Rails applications. These
          can sometimes be confusing to new Rails developers.</p><div class="sect2" title="The gem Command"><div class="titlepage"><div><div><h2 class="title"><a id="gem_command"/>The gem Command</h2></div></div></div><p>The <code class="literal">gem</code> command installs Ruby gems. The Rails framework is
            actually distributed as a collection of gem files.</p><p>Your newly created Rails application is made up of over 40 gems. Maintaining the
            correct versions of these gems and dependencies between them can get complicated. For
            this reason, you rarely use the <code class="literal">gem</code> command directly; instead, you
            usually rely on a tool called Bundler to manage gems and keep your dependencies up to
            date. You interact with Bundler using the <code class="literal">bundle</code> command.</p></div><div class="sect2" title="The bundle Command"><div class="titlepage"><div><div><h2 class="title"><a id="bundle_command"/>The bundle Command</h2></div></div></div><p><a class="indexterm" id="iddle1371"/><a class="indexterm" id="iddle1457"/><a class="indexterm" id="iddle1620"/><a class="indexterm" id="iddle2044"/><a class="indexterm" id="iddle2055"/>The <code class="literal">bundle</code> command is used to install and update the gems
            needed by your application. It installs gems by reading the <span class="emphasis"><em>Gemfile</em></span>
            that was automatically created by the <code class="literal">rails new</code> command in the root
            directory of your Rails application. It stores the version numbers of gems you’re
            using and their dependencies in the file <span class="emphasis"><em>Gemfile.lock</em></span>.</p><p>The <code class="literal">bundle list</code> command displays the names and versions of all
            gems currently being used by your application:</p><a id="pro_id00064"/><pre class="programlisting">$ <span class="strong"><strong>bin/bundle list</strong></span></pre><p>As mentioned earlier, we are using the copy of <code class="literal">bundle</code> inside the
              <span class="emphasis"><em>bin</em></span> directory.</p></div><div class="sect2" title="The rake Command"><div class="titlepage"><div><div><h2 class="title"><a id="rake_command"/>The rake Command</h2></div></div></div><p>The <code class="literal">rake</code> command is an automated build tool used to run tasks
            related to your application. (If you are familiar with the <code class="literal">make</code>
            command, <code class="literal">rake</code> is the Ruby version.) Enter this command to obtain a
            list of the available tasks for your application:</p><a id="pro_id00065"/><pre class="programlisting">$ <span class="strong"><strong>bin/rake --tasks</strong></span></pre><p>This command prints a list of tasks your application can use along with a short
            description of each to your terminal. Some gems add tasks to your application, and you
            can also add your own tasks by writing Ruby scripts and saving them in the
              <span class="emphasis"><em>lib/tasks</em></span> directory.</p></div><div class="sect2" title="The rails Command"><div class="titlepage"><div><div><h2 class="title"><a id="rails_command"/>The rails Command</h2></div></div></div><p>You used the <code class="literal">rails</code> command earlier to create an application and
            start the server. You can also use this command to generate new code and launch the
            console. Enter the <code class="literal">rails</code> command by itself to list the available
            options:</p><a id="pro_id00066"/><pre class="programlisting">$ <span class="strong"><strong>bin/rails</strong></span></pre><p>In addition to the <code class="literal">new</code> command that you used to build your
            application and the <code class="literal">server</code> command that starts a web server, Rails
            also provides several other helpful commands. These include the
              <code class="literal">generate</code> command (generates new code), the
              <code class="literal">console</code> command (starts an interactive Ruby console with your Rails
            application preloaded), and the <code class="literal">dbconsole</code> command (starts a
            command-line interface for the currently configured database).</p><p>Now that you’ve seen some Rails command-line tools, let’s use a few of
            them to add some functionality to the blog application we created.</p></div></div><div class="sect1" title="Rails Scaffold"><div class="titlepage"><div><div><h1 class="title"><a id="rails_scaffold"/>Rails Scaffold</h1></div></div></div><p><a class="indexterm" id="iddle2034"/><a class="indexterm" id="iddle2062"/>We’re going to use a Rails feature known as
            <span class="emphasis"><em>scaffolding</em></span>. Rails scaffolding is a sometimes-controversial feature
          that generates application code for you. This single command creates a model, a set of
          views, and a controller automatically.</p><p>Many developers believe that you should write all of your own code. I agree with them,
          but Rails scaffolding is helpful for bootstrapping an application, especially for
          developers new to Ruby on Rails. We will explore the generated code over the next few
          chapters. By the end, you will understand each file and be able to write those files by
          hand.</p><p>Open a new terminal window (or a new tab in your current one). Change to your
            <span class="emphasis"><em>code/blog</em></span> directory if necessary. Then, use the <code class="literal">rails
            generate</code> command to add posts to the blog:</p><a id="pro_id00067"/><pre class="programlisting">$ <span class="strong"><strong>bin/rails generate scaffold Post</strong></span> ➊<span class="strong"><strong>title:string</strong></span> ➋ <span class="strong"><strong>body:text</strong></span></pre><p>Here, we’ve asked Rails to generate a scaffold for a blog Post. We specified
          that a Post should have a title ➊ and a body ➋.</p><p>The title will be a string, and the body will be a text field in the database. As this
          command runs, you should see a flurry of activity in your terminal as files are generated
          and placed in the correct folders.</p><p>The previous command should have generated a database migration. Use the
            <code class="literal">rake</code> command to run that migration:</p><a id="pro_id00068"/><pre class="programlisting">$ <span class="strong"><strong>bin/rake db:migrate</strong></span></pre><p>This command should create a table named <span class="emphasis"><em>posts</em></span> with fields named
            <code class="literal">id</code>, <code class="literal">title</code>, <code class="literal">body</code>,
            <code class="literal">created_at</code>, and <code class="literal">updated_at</code>. The
            <code class="literal">title</code> and <code class="literal">body</code> fields will store data entered by
          the user. Rails adds the <code class="literal">id</code>, <code class="literal">created_at</code>, and
            <code class="literal">updated_at</code> fields automatically. The <code class="literal">id</code> field is a
          unique, auto-incrementing integer that represents each row in the database. The
            <code class="literal">created_at</code> and <code class="literal">updated_at</code> fields are timestamps
          representing when the row was created and when it was last updated. Rails keeps track of
          these values automatically.</p><p>To see the results, go to <span class="emphasis"><em>http://localhost:3000/posts</em></span> in your web
          browser. You should see a page like the one in <a class="xref" href="ch02.html#rails_post_scaffolding" title="Figure 2-2. The Rails Post scaffolding">Figure 2-2</a>.</p><div class="figure"><a id="rails_post_scaffolding"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00002"/><img alt="The Rails Post scaffolding" src="httpatomoreillycomsourcenostarchimages2169062.png.jpg"/></div></div><p class="title">Figure 2-2. The Rails Post scaffolding</p></div><p><a class="indexterm" id="iddle1395"/><a class="indexterm" id="iddle1439"/><a class="indexterm" id="iddle1708"/><a class="indexterm" id="iddle2049"/><a class="indexterm" id="iddle2283"/>This page certainly won’t win any awards for design, but it is
          functional. Click the <span class="emphasis"><em>New Post</em></span> link to see a form for adding a new
          blog post. After you add a post, click the <span class="emphasis"><em>Back</em></span> link to return to the
          home page.</p><p>By default, Rails shows your data in a table with links for <span class="emphasis"><em>Show</em></span>,
            <span class="emphasis"><em>Edit</em></span>, and <span class="emphasis"><em>Destroy</em></span>. Feel free to try these
          links and verify that the application is working.</p><p>As you play with the application, be sure to look at the output in the terminal window
          where the server is running. This is a copy of the development log generated by your
          application. You’ll find a wealth of information here, such as the URL requested,
          the Ruby method being run, and the SQL commands being executed.</p></div><div class="sect1" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="summary-id00002"/>Summary</h1></div></div></div><p>This chapter covered the basic principles, architecture, directory structure, and
          commands used to build Rails applications. In the next chapter, we’ll dig in to the
          Rails code we just generated, starting with models, and you’ll learn to write your
          own code.</p></div><div class="sect1" title="Exercises"><div class="titlepage"><div><div><h1 class="title"><a id="exercises-id00003"/>Exercises</h1></div></div></div><div class="qandaset" title="Frequently Asked Questions"><a id="ch02qa1"/><table border="0" summary="Q and A Set" width="100%"><col align="left" width="1%"/><col/><tbody><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch02qa1qe1"/><a id="ch02qa1q1"/><p>Q:</p></td><td align="left" valign="top"><p>1. Explore the functionality of your new blog. Create, edit, and destroy posts.
                View the list of posts and individual posts. Note how the URL in the address bar
                changes as you move around the application.</p></td></tr><tr class="question" title="Q:"><td align="left" valign="top"><a id="ch02qa1qe2"/><a id="ch02qa1q2"/><p>Q:</p></td><td align="left" valign="top"><p>2. Get used to moving around the various files in the blog application in your
                editor of choice. If you’re using Sublime Text 2, you can open the blog
                directory itself and then use the sidebar to open individual files.</p></td></tr></tbody></table></div></div></div></body></html>