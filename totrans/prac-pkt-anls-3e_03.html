<html><head></head><body>
<h2 class="h2"><a id="ch03"/><span epub:type="pagebreak" id="page_37"/><strong><span class="big">3</span></strong><br/><strong>INTRODUCTION TO WIRESHARK</strong></h2>&#13;
<div class="image"><img alt="image" src="../images/common.jpg"/></div>&#13;
<p class="noindent"><span class="big1">As mentioned in <a href="ch01.xhtml#ch01">Chapter 1</a>, several packet-sniffing applications are available for performing network analysis, but we’ll focus mostly on Wireshark in this book. This chapter introduces Wireshark.</span></p>&#13;
<h3 class="h3"><a id="ch03lev1sec1"/><strong>A Brief History of Wireshark</strong></h3>&#13;
<p class="noindent">Wireshark has a very rich history. Gerald Combs, a computer science graduate of the University of Missouri at Kansas City, originally developed it out of necessity. The first version of Combs’s application, called Ethereal, was released in 1998 under the GNU Public License (GPL).</p>&#13;
<p class="indent">Eight years after releasing Ethereal, Combs left his job to pursue other career opportunities. Unfortunately, his employer at that time had full rights to the Ethereal trademarks, and Combs was unable to reach an agreement that would allow him to control the Ethereal brand. Instead, Combs and the rest of the development team rebranded the project as <em>Wireshark</em> in mid-2006.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_38"/>Wireshark has grown dramatically in popularity, and its collaborative development team now boasts more than 500 contributors. The program that exists under the Ethereal name is no longer being developed.</p>&#13;
<h3 class="h3"><a id="ch03lev1sec2"/><strong>The Benefits of Wireshark</strong></h3>&#13;
<p class="noindenta">Wireshark offers several benefits that make it appealing for everyday use. Aimed at both the up-and-coming and the expert packet analyst, it offers a variety of features to entice each. Let’s examine Wireshark according to the criteria defined in <a href="ch01.xhtml#ch01">Chapter 1</a> for selecting a packet-sniffing tool.</p>&#13;
<p class="noindentl"><strong>Supported protocols</strong>   Wireshark excels in the number of protocols that it supports—more than 1,000 as of this writing. These range from common ones like IP and DHCP to more advanced proprietary protocols like DNP3 and BitTorrent. And because Wireshark is developed under an open source model, new protocol support is added with each update.</p>&#13;
<div class="note">&#13;
<p class="notet"><span class="box"><strong>NOTE</strong></span></p>&#13;
<p class="notep"><em>In the unlikely event that Wireshark doesn’t support a protocol you need, you can code that support yourself. Then you can submit your code to the Wireshark developers for consideration for inclusion in the application. You can learn about what is required to contribute code to the Wireshark project at</em> <a href="https://www.wireshark.org/develop.html">https://www.wireshark.org/develop.html</a>.</p>&#13;
</div>&#13;
<p class="noindentla"><strong>User-friendliness</strong>   The Wireshark interface is one of the easiest to understand of any packet-sniffing application. It is GUI based, with clearly written context menus and a straightforward layout. It also provides several features designed to enhance usability, such as protocol-based color coding and detailed graphical representations of raw data. Unlike some of the more complicated command line–driven alternatives, like tcpdump, the Wireshark GUI is accessible to those just entering the world of packet analysis.</p>&#13;
<p class="noindentla"><strong>Cost</strong>   Since it’s open source and released under the GNU Public License (GPL), Wireshark’s pricing can’t be beat: it’s absolutely free. You can download and use Wireshark for any purpose, whether personal or commercial.</p>&#13;
<div class="note">&#13;
<p class="notet"><span class="box"><strong>NOTE</strong></span></p>&#13;
<p class="notep"><em>Although Wireshark may be free, some people have made the mistake of paying for it by accident. If you search for packet sniffers on eBay, you may be surprised by how many people would love to sell you a “professional enterprise license” for Wireshark for the low, low price of $39.95. If you decide you really want to buy it, give me a call, and we can talk about some oceanfront property in Kentucky I have for sale!</em></p>&#13;
</div>&#13;
<p class="noindentla"><span epub:type="pagebreak" id="page_39"/><strong>Program support</strong>   A software package’s level of support can make or break it. Freely distributed software such as Wireshark may not come with any formal support, so the open source community often relies on its user base to provide assistance. Luckily for us, the Wireshark community is one of the most active of any open source project. The Wireshark website links directly to several forms of support, including online documentation; a wiki; FAQs; and a place to sign up for the Wireshark mailing list, which is monitored by most of the program’s top developers. Paid support for Wireshark is also available from Riverbed Technology.</p>&#13;
<p class="noindentla"><strong>Source code access</strong>   Wireshark is open source software, so you can access the code at any time. This can be useful for troubleshooting application issues, understanding how protocol dissectors work, or making your own contributions.</p>&#13;
<p class="noindentla"><strong>Operating system support</strong>   Wireshark supports all major modern operating systems, including Windows, Linux-based, and OS X platforms. You can view a complete list of supported operating systems on the Wireshark home page.</p>&#13;
<h3 class="h3"><a id="ch03lev1sec3"/><strong>Installing Wireshark</strong></h3>&#13;
<p class="noindenta">The Wireshark installation process is surprisingly simple. However, before you install Wireshark, make sure that your system meets the following requirements:</p>&#13;
<p class="bullet">•     Any modern 32-bit x86 or 64-bit CPU</p>&#13;
<p class="bullet">•     400MB available RAM, but more for larger capture files</p>&#13;
<p class="bullet">•     At least 300MB of available storage space, plus space for capture files</p>&#13;
<p class="bullet">•     NIC that supports promiscuous mode</p>&#13;
<p class="bulleta">•     WinPcap/libpcap capture driver</p>&#13;
<p class="indent">The WinPcap capture driver is the Windows implementation of the pcap packet-capturing application programming interface (API). Simply put, this driver interacts with your operating system to capture raw packet data, apply filters, and switch the NIC in and out of promiscuous mode.</p>&#13;
<p class="indent">Although you can download WinPcap separately (from <em><a href="http://www.winpcap.org/">http://www.winpcap.org/</a></em>), it is typically better to install WinPcap from the Wireshark installation package, because the included version of WinPcap has been tested to work with Wireshark.</p>&#13;
<h4 class="h4"><a id="ch03lev2sec1"/><strong><em>Installing on Windows Systems</em></strong></h4>&#13;
<p class="noindent">The current version of Wireshark is tested to support versions of Windows that are still within their extended support lifetime. As of the writing of this book, that encompasses Windows Vista; Windows 7; Windows 8; <span epub:type="pagebreak" id="page_40"/>Windows 10; and Windows Servers 2003, 2008, and 2012. While Wireshark will often work on other versions of Windows (like Windows XP), those versions are not officially supported.</p>&#13;
<p class="indent">The first step when installing Wireshark on Windows is to obtain the latest installation build from the official Wireshark web page, <em><a href="http://www.wireshark.org/">http://www.wireshark.org/</a></em>. Navigate to the Download Wireshark section on the website and choose a release mirror. Once you’ve downloaded the package, follow these steps:</p>&#13;
<ol>&#13;
<li class="nump"><p class="number">Double-click the <em>.exe</em> file to begin installation and then click <strong>Next</strong> in the introductory window.</p></li>&#13;
<li class="nump"><p class="number">Read the licensing agreement and click <strong>I Agree</strong> if you agree.</p></li>&#13;
<li class="nump"><p class="number">Select the components of Wireshark you wish to install, as shown in <a href="ch03.xhtml#ch03fig1">Figure 3-1</a>. For our purposes, you can accept the defaults by clicking <strong>Next</strong>.</p>&#13;
<div class="image"><img alt="image" src="../images/f40-01.jpg"/></div>&#13;
<p class="figcap"><a id="ch03fig1"/><em>Figure 3-1: Choosing the Wireshark components you wish to install</em></p></li>&#13;
<li class="nump"><p class="number">Click <strong>Next</strong> in the Additional Tasks window.</p></li>&#13;
<li class="nump"><p class="number">Select the location where you wish to install Wireshark and click <strong>Next</strong>.</p></li>&#13;
<li class="nump"><p class="number">When the dialog asks whether you want to install WinPcap, first make sure the <strong>Install WinPcap</strong> box is checked, as shown in <a href="ch03.xhtml#ch03fig2">Figure 3-2</a>. Then click <strong>Install</strong>. The installation process should begin.</p></li>&#13;
<li class="nump"><p class="number">About halfway through the Wireshark installation, the WinPcap installation should start. When it does, click <strong>Next</strong> in the introductory window, read the licensing agreement, and click <strong>I Agree</strong>.</p></li>&#13;
<li class="nump"><p class="number">You’ll be given the option to install USBPcap, a utility for collecting data from USB devices. Select the appropriate check box if you wish to do so and click <strong>Next</strong>.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_41"/><img alt="image" src="../images/f41-01.jpg"/></div>&#13;
<p class="figcap"><a id="ch03fig2"/><em>Figure 3-2: Selecting the option to install the WinPcap driver</em></p></li>&#13;
<li class="nump"><p class="number">WinPcap and, if you selected it, USBPcap should install on your computer. After this installation is complete, click <strong>Finish</strong>.</p></li>&#13;
<li class="nump"><p class="number">Wireshark should complete its installation. When it’s finished, click <strong>Next</strong>.</p></li>&#13;
<li class="nump"><p class="number">In the installation confirmation window, click <strong>Finish</strong>.</p></li>&#13;
</ol>&#13;
<h4 class="h4"><a id="ch03lev2sec2"/><strong><em>Installing on Linux Systems</em></strong></h4>&#13;
<p class="noindent">Wireshark works on most modern Unix-based platforms. It can be installed either by using the distributions package manager of choice or by downloading and installing the package appropriate for your distribution. It isn’t realistic to cover installation procedures for everyone, so we’ll just look at a few.</p>&#13;
<p class="indent">Typically, for system-wide software, root access is a requirement. However, local software installations compiled from source can usually be installed without root access.</p>&#13;
<h5 class="h5"><strong>RPM-Based Systems</strong></h5>&#13;
<p class="noindent">If you’re using Red Hat Linux or a distribution based on it, like CentOS, then it’s likely the OS has the Yum package management tool installed by default. If that’s the case, you may be able to install Wireshark the quick way by pulling it from the distribution’s software repository. To do this, open a console window and enter the following command:</p>&#13;
<pre>$ <span class="codestrong">sudo yum install wireshark</span></pre>&#13;
<p class="indent">If any dependencies are needed, you’ll be prompted to install them. If everything completes successfully, then you should be able to run Wireshark from the command line and access it via the GUI.</p>&#13;
<h5 class="h5"><span epub:type="pagebreak" id="page_42"/><strong>DEB-Based Systems</strong></h5>&#13;
<p class="noindent">Most DEB-based distributions, such as Debian or Ubuntu, include the APT package management tool, which allows you to install Wireshark from the OS software repository. To install Wireshark with this tool, open a console window and enter the following:</p>&#13;
<pre>$ <span class="codestrong">sudo apt-get install wireshark wireshark-qt</span></pre>&#13;
<p class="indent">Once again, you’ll be prompted to install any required dependencies to complete the installation.</p>&#13;
<h5 class="h5"><strong>Compiling from Source</strong></h5>&#13;
<p class="noindent">Due to changes in operation system architecture and Wireshark features, the instructions for compiling Wireshark from source might change over time. That’s one reason it’s recommended to use your operating system package manager to perform the installation. However, if your Linux distribution doesn’t use an automated package management software or you require a specialized installation, Wireshark can be installed manually by compiling it from source. To do so, complete the following steps:</p>&#13;
<ol>&#13;
<li class="nump"><p class="number">Download the source package from the Wireshark web page.</p></li>&#13;
<li class="nump"><p class="number">Extract the archive by entering the following (substituting the filename of your downloaded package as appropriate):</p>&#13;
<pre>$ <span class="codestrong">tar –jxvf <span class="codeitalic">&lt;file_name_here&gt;</span>.tar.bz2</span></pre></li>&#13;
<li class="nump"><p class="number">Before configuring and installing Wireshark, a few dependencies may be required depending on your chosen Linux flavor. For example, Ubuntu 14.04 requires the installation of a few other packages for Wireshark to work. These can be installed by issuing the following command (you’ll need to do this as a root-level user or by invoking <code>sudo</code> before the command):</p>&#13;
<pre>$ <span class="codestrong">sudo apt-get install pkg-config bison flex qt5-default libgtk-3-dev libpcap-dev qttools5-dev-tools</span></pre></li>&#13;
<li class="nump"><p class="number">After installing prerequisites, navigate to the directory where the Wireshark files were extracted.</p></li>&#13;
<li class="nump"><p class="number">Configure the source so that it will build correctly for your distribution of Linux by using the command <span class="codestrong">./configure</span>. If you wish to deviate from the default installation options, you can specify those options at this point in the installation. If any dependencies are missing, you’ll most likely receive an error. You must install and configure those dependencies before proceeding. If configuration is successful, you should see a message noting success, as shown in <a href="ch03.xhtml#ch03fig3">Figure 3-3</a>.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_43"/><img alt="image" src="../images/f43-01.jpg"/></div>&#13;
<p class="figcap"><a id="ch03fig3"/><em>Figure 3-3: When the <code>./configure</code> command is successful, a message is displayed with the selected configurations.</em></p></li>&#13;
<li class="nump"><p class="number">Enter the <span class="codestrong">make</span> command to build the source into a binary.</p></li>&#13;
<li class="nump"><p class="number">Initiate the final installation with <span class="codestrong">sudo make install</span>.</p></li>&#13;
<li class="nump"><p class="number">Run <span class="codestrong">sudo/sbin/ldconfig</span> to complete the installation.</p></li>&#13;
</ol>&#13;
<div class="note">&#13;
<p class="notet"><span class="box"><strong>NOTE</strong></span></p>&#13;
<p class="notep"><em>If you run into an error following these steps, you may have to install an additional package.</em></p>&#13;
</div>&#13;
<h4 class="h4"><a id="ch03lev2sec3"/><strong><em>Installing on OS X Systems</em></strong></h4>&#13;
<p class="noindent">To install Wireshark on OS X, complete these steps:</p>&#13;
<ol>&#13;
<li class="nump"><p class="number">Download the OS X package from the Wireshark web page.</p></li>&#13;
<li class="nump"><p class="number">Run the installation utility and proceed through its steps. Once you’ve accepted the required end user license agreement, you’ll have the option to select the installation location.</p></li>&#13;
<li class="nump"><p class="number">Complete the installation wizard.</p></li>&#13;
</ol>&#13;
<h3 class="h3"><a id="ch03lev1sec4"/><span epub:type="pagebreak" id="page_44"/><strong>Wireshark Fundamentals</strong></h3>&#13;
<p class="noindent">Once you’ve successfully installed Wireshark on your system, you can begin to familiarize yourself with it. Now you finally get to open your fully functioning packet sniffer and see . . . absolutely nothing!</p>&#13;
<p class="indent">Okay, so Wireshark isn’t very interesting when you first open it. For things to really get exciting, you need to get some data.</p>&#13;
<h4 class="h4"><a id="ch03lev2sec4"/><strong><em>Your First Packet Capture</em></strong></h4>&#13;
<p class="noindent">To get packet data into Wireshark, you’ll perform your first packet capture. You may be thinking, “How am I going to capture packets when nothing is wrong on the network?”</p>&#13;
<p class="indent">First, there is <em>always</em> something wrong on the network. If you don’t believe me, then go ahead and send an email to all of your network users and let them know that everything is working perfectly.</p>&#13;
<p class="indent">Secondly, there doesn’t need to be something wrong in order for you to perform packet analysis. In fact, most packet analysts spend more time analyzing problem-free traffic than traffic that they are troubleshooting. After all, you need a baseline for comparison to effectively troubleshoot network traffic. For example, if you ever hope to solve a problem with DHCP by analyzing its traffic, you must understand what the flow of working DHCP traffic looks like.</p>&#13;
<p class="indent">More broadly, to find anomalies in daily network activity, you must know what normal daily network activity looks like. When your network is running smoothly, your observations become a baseline representing what traffic looks like in a normal state.</p>&#13;
<p class="indent">So, let’s capture some packets!</p>&#13;
<ol>&#13;
<li class="nump"><p class="number">Open Wireshark.</p></li>&#13;
<li class="nump"><p class="number">From the main drop-down menu, select <strong>Capture</strong> and then <strong>Options</strong>. You should see a dialog listing the various interfaces that can be used to capture packets, along with some basic information about each one (<a href="ch03.xhtml#ch03fig4">Figure 3-4</a>). Take note of the Traffic heading, which shows a line graph indicating the amount of traffic currently passing through that interface. Peaks on a line tell you that you are actually capturing packets. If you aren’t, the line will be flat. You can also expand each interface by clicking the arrow to the left of it to see the addressing information, such as the MAC address or IP address, tied to it.</p></li>&#13;
<li class="nump"><p class="number">Click the interface you wish to use and click <strong>Start</strong>. Data should begin filling the window.</p></li>&#13;
<li class="nump"><p class="number">Wait about a minute or so, and when you are ready to stop the capture and view your data, click the <strong>Stop</strong> button from the Capture drop-down menu.</p></li>&#13;
</ol>&#13;
<div class="image"><span epub:type="pagebreak" id="page_45"/><img alt="image" src="../images/f45-01.jpg"/></div>&#13;
<p class="figcap"><a id="ch03fig4"/><em>Figure 3-4: Selecting an interface on which to perform your packet capture</em></p>&#13;
<p class="indent">Once you have completed these steps and finished the capture process, the Wireshark main window should be alive with data. As a matter of fact, you might be overwhelmed by the amount of data that appears, but it will all start to make sense quickly as we break down the main window of Wireshark one piece at a time.</p>&#13;
<h4 class="h4"><a id="ch03lev2sec5"/><strong><em>Wireshark’s Main Window</em></strong></h4>&#13;
<p class="noindent">You’ll spend most of your time in the Wireshark main window. This is where all of the packets you capture are displayed and broken down into a more understandable format. Using the packet capture you just made, let’s take a look at Wireshark’s main window, shown in <a href="ch03.xhtml#ch03fig5">Figure 3-5</a>.</p>&#13;
<div class="image"><img alt="image" src="../images/f45-02.jpg"/></div>&#13;
<p class="figcap"><a id="ch03fig5"/><em>Figure 3-5: The Wireshark main window uses a three-pane design.</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_46"/>The three panes in the main window—Packet List, Packet Details, and Packet Bytes from top to bottom—depend on one another. To view the details of an individual packet in the Packet Details pane, you must first select it in the Packet List pane. When you select a portion of the packet in the Packet Details pane, the Packet Bytes pane displays the bytes that correspond with that portion.</p>&#13;
<div class="note">&#13;
<p class="notet"><span class="box"><strong>NOTE</strong></span></p>&#13;
<p class="notep"><em>Notice that <a href="ch03.xhtml#ch03fig5">Figure 3-5</a> lists a few different protocols in the Packet List pane. There is no visual separation of protocols on different layers (other than via color coding); all packets are shown as they are received on the wire.</em></p>&#13;
</div>&#13;
<p class="noindentla">Here’s what each pane contains:</p>&#13;
<p class="noindentl"><strong>Packet List</strong>   The top pane displays a table containing all packets in the current capture file. It has columns containing the packet number, the relative time the packet was captured, the source and destination of the packet, the packet’s protocol, and some general information found in the packet.</p>&#13;
<div class="note">&#13;
<p class="notet"><span class="box"><strong>NOTE</strong></span></p>&#13;
<p class="notep"><em>When I refer to</em> traffic<em>, I’m referring to all packets displayed in the Packet List pane. When I refer to</em> DNS traffic <em>specifically, I mean the DNS protocol packets in the Packet List pane.</em></p>&#13;
</div>&#13;
<p class="noindentla"><strong>Packet Details</strong>   The middle pane contains a hierarchical display of information about a single packet and can be collapsed or expanded to show all of the information collected about the individual packet.</p>&#13;
<p class="noindentla"><strong>Packet Bytes</strong>   The lower pane—perhaps the most confusing—displays a packet in its raw, unprocessed form; that is, it shows what the packet looks like as it travels across the wire. This is raw information with nothing warm or fuzzy to make it easier to follow. We’ll discuss methods for interpreting this type of data in <a href="ch15_appb.xhtml#ch15_appb">Appendix B</a>.</p>&#13;
<h4 class="h4"><a id="ch03lev2sec6"/><strong><em>Wireshark Preferences</em></strong></h4>&#13;
<p class="noindent">Wireshark has several preferences that can be customized to meet your needs. To access Wireshark’s preferences, select <strong>Edit</strong> from the main drop-down menu and click <strong>Preferences</strong>. You’ll see the Preferences dialog, which contains several customizable options, as shown in <a href="ch03.xhtml#ch03fig6">Figure 3-6</a>.</p>&#13;
<p class="indenta">Wireshark’s preferences are divided into six major sections plus an Advanced section:</p>&#13;
<p class="noindentla"><strong>Appearance</strong>   These preferences determine how Wireshark presents data. You can change most options here according to your personal preferences, including whether to save window positions, the layout of the three main panes, the placement of the scroll bar, the placement of the Packet List pane columns, the fonts used to display the captured data, and the background and foreground colors.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_47"/><img alt="image" src="../images/f47-01.jpg"/></div>&#13;
<p class="figcap"><a id="ch03fig6"/><em>Figure 3-6: You can customize Wireshark using the Preferences dialog options.</em></p>&#13;
<p class="noindentla"><strong>Capture</strong>   These preferences allow you to specify options related to the way packets are captured, including your default capture interface, whether to use promiscuous mode by default, and whether to update the Packet List pane in real time.</p>&#13;
<p class="noindentla"><strong>Filter Expressions</strong>   Later we will discuss how Wireshark allows you to filter traffic based on specific criteria. This section of the Preferences dialog allows you to create and manage those filters.</p>&#13;
<p class="noindentla"><strong>Name Resolution</strong>   Through these preferences, you can activate features of Wireshark that allow it to resolve addresses into more recognizable names (including MAC, network, and transport name resolution) and specify the maximum number of concurrent name resolution requests.</p>&#13;
<p class="noindentla"><strong>Protocols</strong>   This section allows you to manipulate options related to the capture and display of the various packets Wireshark is capable of decoding. Not every protocol has configurable preferences, but some have several options that can be changed. These options are best left at their defaults unless you have a specific reason to change them.</p>&#13;
<p class="noindentla"><strong>Statistics</strong>   This section provides a few configurable options for Wireshark’s statistical features, which will be covered in more depth in <a href="ch05.xhtml#ch05">Chapter 5</a>.</p>&#13;
<p class="noindentla"><strong>Advanced</strong>   Settings that don’t fit neatly into any of the previous categories can be found here. Editing these settings is something typically only done by Wireshark power users.</p>&#13;
<h4 class="h4"><a id="ch03lev2sec7"/><span epub:type="pagebreak" id="page_48"/><strong><em>Packet Color Coding</em></strong></h4>&#13;
<p class="noindent">If you are anything like me, you enjoy shiny objects and pretty colors. If so, you probably got excited when you saw all those different colors in the Packet List pane, as in the example in <a href="ch03.xhtml#ch03fig7">Figure 3-7</a> (well, the figure is in black and white if you’re reading this book in print, but you get the idea). It may seem as if these colors are randomly assigned to each packet, but this isn’t the case.</p>&#13;
<div class="image"><img alt="image" src="../images/f48-01.jpg"/></div>&#13;
<p class="figcap"><a id="ch03fig7"/><em>Figure 3-7: Wireshark’s color coding allows for quick protocol identification.</em></p>&#13;
<p class="indent">Each packet is displayed in a certain color for a reason. The color can reflect the packet’s protocol and specific field values. For example, all UDP traffic is blue and all HTTP traffic is green by default. The color coding allows you to quickly differentiate between various protocols so that you don’t need to read the protocol field in the Packet List pane for every packet. You’ll find that this greatly speeds up the time it takes to browse through large capture files.</p>&#13;
<p class="indent">Wireshark makes it easy to see which colors are assigned to each protocol through the Coloring Rules window, shown in <a href="ch03.xhtml#ch03fig8">Figure 3-8</a>. To open this window, select <strong>View</strong> from the main drop-down menu and click <strong>Coloring Rules</strong>.</p>&#13;
<div class="image"><img alt="image" src="../images/f48-02.jpg"/></div>&#13;
<p class="figcap"><a id="ch03fig8"/><em>Figure 3-8: The Coloring Rules window lets you view and modify the coloring of packets.</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_49"/>Coloring rules are based on Wireshark filters, which we will look at in <a href="ch04.xhtml#ch04">Chapter 4</a>. Using these filters, you can define your own coloring rules and modify existing ones. For example, to change the background color used for HTTP traffic from the default green to lavender, follow these steps:</p>&#13;
<ol>&#13;
<li class="nump"><p class="number">Open Wireshark and access the Coloring Rules window (<strong>View</strong> ▶ <strong>Coloring Rules</strong>).</p></li>&#13;
<li class="nump"><p class="number">Find the HTTP coloring rule in the coloring rules list and select it by clicking it once.</p></li>&#13;
<li class="nump"><p class="number">You’ll see the foreground and background colors at the bottom of the screen, as shown in <a href="ch03.xhtml#ch03fig9">Figure 3-9</a>.</p>&#13;
<div class="image"><img alt="image" src="../images/f49-01.jpg"/></div>&#13;
<p class="figcap"><a id="ch03fig9"/><em>Figure 3-9: When editing a color filter, you can modify both the foreground and background colors.</em></p></li>&#13;
<li class="nump"><p class="number">Click the <strong>Background</strong> button.</p></li>&#13;
<li class="nump"><p class="number">Select the color you wish to use on the color wheel and click <strong>OK</strong>.</p></li>&#13;
<li class="nump"><p class="number">Click <strong>OK</strong> once more to accept the changes and return to the main window. The user interface should then reload itself to reflect the updated color scheme.</p></li>&#13;
</ol>&#13;
<p class="indent">As you work with Wireshark on your network, you’ll begin to notice that you deal with certain protocols more than others. Here’s where color-coded packets can make your life a lot easier. For example, if you think that there is a rogue DHCP server on your network handing out IP leases, you could modify the coloring rule for the DHCP protocol so that it shows up in bright yellow (or some other easily identifiable color). This would allow you to pick out all DHCP traffic much more quickly, making your packet analysis more efficient.</p>&#13;
<div class="note">&#13;
<p class="notet"><span epub:type="pagebreak" id="page_50"/><span class="box"><strong>NOTE</strong></span></p>&#13;
<p class="notep"><em>Not too long ago, I was discussing Wireshark coloring rules during a presentation to a local group of students. One student was relieved to find out he could edit the coloring rules because he was color-blind and had trouble distinguishing certain protocols based on the default coloring. The ability to modify the default coloring rules thus provides some degree of accessibility.</em></p>&#13;
</div>&#13;
<h3 class="h3"><a id="ch03lev1sec5"/><strong>Configuration Files</strong></h3>&#13;
<p class="noindent">It’s helpful to understand where Wireshark stores various configuration settings should you ever need to modify those files directly. You can find the location of the Wireshark configuration files by selecting <strong>Help</strong> from the main drop-down menu, choosing <strong>About Wireshark</strong>, and clicking the <strong>Folders</strong> tab. This window is shown in <a href="ch03.xhtml#ch03fig10">Figure 3-10</a>.</p>&#13;
<div class="image"><img alt="image" src="../images/f50-01.jpg"/></div>&#13;
<p class="figcap"><a id="ch03fig10"/><em>Figure 3-10: Locating Wireshark configuration files</em></p>&#13;
<p class="indent">The two most important locations in terms of Wireshark customization are the personal and global configuration directories. The global configuration directory contains all of the default settings for Wireshark and is where the default profile stores its settings. The personal configuration folder contains customized settings and profiles unique to your account. Any new profiles you create will be stored in a subdirectory of the personal configuration folder using whatever name you provide.</p>&#13;
<p class="indent">The difference between global and personal configuration directories is an important one, because any changes made to the global configuration files will affect every Wireshark user on a system.</p>&#13;
<h3 class="h3"><a id="ch03lev1sec6"/><strong>Configuration Profiles</strong></h3>&#13;
<p class="noindent">After learning about Wireshark’s preferences, you may find that sometimes you want to use one set of preferences but then quickly switch to another set to address a different scenario. Instead of making you manually reconfigure your preferences every time this occurs, Wireshark introduced configuration profiles, which allow users to create saved sets of preferences.</p>&#13;
<p class="indenta"><span epub:type="pagebreak" id="page_51"/>A configuration profile stores the following:</p>&#13;
<p class="bullet">•     Preferences</p>&#13;
<p class="bullet">•     Capture filters</p>&#13;
<p class="bullet">•     Display filters</p>&#13;
<p class="bullet">•     Coloring rules</p>&#13;
<p class="bullet">•     Disabled protocols</p>&#13;
<p class="bullet">•     Forced decodes</p>&#13;
<p class="bullet">•     Recent settings, such as pane sizes, view menu settings, and column widths</p>&#13;
<p class="bulleta">•     Protocol-specific tables, such as SNMP users and custom HTTP headers</p>&#13;
<p class="indent">To view the list of profiles, click <strong>Edit</strong> in the main drop-down menu and choose the <strong>Configuration Profiles</strong> option. Alternatively, you can right-click the profiles section at the bottom-right side of the screen and select the <strong>Manage Profiles</strong> option. When you arrive at the Configuration Profiles window, you’ll see that Wireshark comes with a few standard profiles, including the Default, Bluetooth, and Classic profiles shown in <a href="ch03.xhtml#ch03fig11">Figure 3-11</a>. The Latency Investigation profile is a custom profile I’ve added and is in plaintext, while the global and default profiles are in italics.</p>&#13;
<div class="image"><img alt="image" src="../images/f51-01.jpg"/></div>&#13;
<p class="figcap"><a id="ch03fig11"/><em>Figure 3-11: Viewing configuration profiles</em></p>&#13;
<p class="indent">The Configuration Profiles window allows you to create, copy, delete, and apply configuration profiles. The process of creating a new profile is very simple.</p>&#13;
<ol>&#13;
<li class="nump"><p class="number">Configure Wireshark with the settings you’d like to save to a profile.</p></li>&#13;
<li class="nump"><p class="number">Proceed to the Configuration Profiles window by clicking <strong>Edit</strong> in the main drop-down menu. Select the <strong>Configuration Profiles</strong> option.</p></li>&#13;
<li class="nump"><p class="number">Click the plus (+) button and give the profile a descriptive name.</p></li>&#13;
<li class="nump"><p class="number">Click <strong>OK</strong>.</p></li>&#13;
</ol>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_52"/>When you’d like to switch profiles, you can go to the Configuration Profile window, click the profile name, and click <strong>OK</strong>. You can do this more quickly by clicking the Profile heading at the bottom right of the Wireshark window and selecting the profile you’d like to use, as shown in <a href="ch03.xhtml#ch03fig12">Figure 3-12</a>.</p>&#13;
<div class="image"><img alt="image" src="../images/f52-01.jpg"/></div>&#13;
<p class="figcap"><a id="ch03fig12"/><em>Figure 3-12: Quickly switch between profiles through the Profile heading.</em></p>&#13;
<p class="indent">One of the most useful aspects of configuration profiles is that each profile is stored in its own directory with a series of configuration files. This means that you can back up your profiles and share them with others. The folders tab shown in <a href="ch03.xhtml#ch03fig10">Figure 3-10</a> provides paths to personal and global configuration file directories. To share a profile with a user on another computer, just copy the folder matching the name of the profile you want to share and paste it into the same directory for the appropriate user on another computer.</p>&#13;
<p class="indent">While reading along in this book, you may find the need to create a few high-level profiles for general troubleshooting, finding the source of network latency, and investigating security issues. Don’t be afraid to use profiles liberally. They are real time-savers when you want to quickly switch a few preference options on or off. I’ve known people who have used dozens of profiles to address different scenarios with great success.</p>&#13;
<p class="indent">Now that you have Wireshark up and running, you’re ready to do some packet analysis. <a href="ch04.xhtml#ch04">Chapter 4</a> describes how you can work with the packets you’ve captured.</p>&#13;
</body></html>