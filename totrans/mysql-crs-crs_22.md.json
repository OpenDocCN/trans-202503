["```\ncreate database voting;\n```", "```\nuse voting;\n\ncreate table voter\n    (\n    voter_id                int             primary key    auto_increment,\n voter_name              varchar(100)    not null,\n    voter_address           varchar(100)    not null,\n    voter_county            varchar(50)     not null,\n    voter_district          varchar(10)     not null,\n    voter_precinct          varchar(10)     not null,\n    voter_party             varchar(20),\n    voting_location         varchar(100)    not null,\n    voter_registration_num  int             not null       unique\n    );\n```", "```\ncreate table ballot\n    (\n    ballot_id              int          primary key    auto_increment,\n    voter_id               int          not null       unique,\n    ballot_type            varchar(10)  not null,\n    ballot_cast_datetime   datetime     not null       default now(),\n    constraint foreign key (voter_id) references voter(voter_id),\n    constraint check(ballot_type in ('in-person', 'absentee'))\n    );\n```", "```\ncreate table race\n    (\n    race_id                 int             primary key     auto_increment,\n    race_name               varchar(100)    not null        unique,\n    votes_allowed           int             not null\n    );\n```", "```\ncreate table candidate\n    (\n    candidate_id            int             primary key     auto_increment,\n    race_id                 int             not null,\n    candidate_name          varchar(100)    not null        unique,\n    candidate_address       varchar(100)    not null,\n    candidate_party         varchar(20),\n    incumbent_flag          bool,\n    constraint foreign key (race_id) references race(race_id)\n    );\n```", "```\ncreate table ballot_candidate\n    (\n    ballot_id       int,\n    candidate_id    int,\n    primary key (ballot_id, candidate_id),\n    constraint foreign key (ballot_id) references ballot(ballot_id),\n    constraint foreign key (candidate_id) references candidate(candidate_id)\n    );\n```", "```\ndrop trigger if exists tr_voter_bi;\n\ndelimiter //\n\ncreate trigger tr_voter_bi\n  before insert on voter\n  for each row\nbegin\n  if user() not like 'secretary_of_state%' then\n  ❶ signal sqlstate '45000'\n    set message_text = 'Voters can be added only by the Secretary of State';\n  end if;\nend//\n\ndelimiter ;\n```", "```\nsignal sqlstate '45000' set message_text = 'Voters can be added only...';\n```", "```\ndrop trigger if exists tr_ballot_candidate_bi;\n\ndelimiter //\n\ncreate trigger tr_ballot_candidate_bi\n  before insert on ballot_candidate\n  for each row\nbegin\n  declare v_race_id int;\n  declare v_votes_allowed int;\n  declare v_existing_votes int;\n  declare v_error_msg varchar(100);\n  declare v_race_name varchar(100);\n\n❶ select r.race_id,\n         r.race_name,\n         r.votes_allowed\n❷ into   v_race_id,\n         v_race_name,\n         v_votes_allowed\n  from   race r\n  join   candidate c\n  on     r.race_id = c.race_id\n  where  c.candidate_id = new.candidate_id;\n\n❸ select count(*)\n  into   v_existing_votes\n  from   ballot_candidate bc\n  join   candidate c\n  on     bc.candidate_id = c.candidate_id\n  and    c.race_id = v_race_id\n  where  bc.ballot_id = new.ballot_id;\n\n  if v_existing_votes >= v_votes_allowed then\n     select concat('Overvoting error: The ',\n              v_race_name,\n              ' race allows selecting a maximum of ',\n              v_votes_allowed,\n              ' candidate(s) per ballot.'\n            )\n     into v_error_msg;\n\n  ❹ signal sqlstate '45000' set message_text = v_error_msg;\n  end if;\nend//\n\ndelimiter ;\n```", "```\nOvervoting error: The Mayor race allows selecting a maximum of 1 candidate(s) per ballot.\n```", "```\ndrop trigger if exists tr_voter_bu;\n\ndelimiter //\n\ncreate trigger tr_voter_bu\n  before update on voter\n for each row\nbegin\n  if user() not like 'secretary_of_state%' then\n    signal sqlstate '45000'\n    set message_text = 'Voters can be updated only by the Secretary of State';\n  end if;\nend//\n\ndelimiter ;\n```", "```\ndrop trigger if exists tr_voter_bd;\n\ndelimiter //\n\ncreate trigger tr_voter_bd\n  before delete on voter\n  for each row\nbegin\n  if user() not like 'secretary_of_state%' then\n    signal sqlstate '45000'\n    set message_text = 'Voters can be deleted only by the Secretary of State';\n  end if;\nend//\n\ndelimiter ;\n```", "```\ncreate table voter_audit\n(\n  audit_datetime  datetime,\n  audit_user      varchar(100),\n  audit_change    varchar(1000)\n);\n\ncreate table ballot_audit\n(\n  audit_datetime  datetime,\n  audit_user      varchar(100),\n  audit_change    varchar(1000)\n);\n\ncreate table race_audit\n(\n  audit_datetime  datetime,\n  audit_user      varchar(100),\n  audit_change    varchar(1000)\n);\n\ncreate table candidate_audit\n(\n  audit_datetime  datetime,\n  audit_user      varchar(100),\n  audit_change    varchar(1000)\n);\n\ncreate table ballot_candidate_audit\n(\n  audit_datetime  datetime,\n  audit_user      varchar(100),\n  audit_change    varchar(1000)\n);\n```", "```\ndrop trigger if exists tr_voter_ai;\n\ndelimiter //\n\ncreate trigger tr_voter_ai\n  after insert on voter\n❶ for each row\nbegin\n  insert into voter_audit\n  (\n    audit_datetime,\n    audit_user,\n    audit_change\n )\n  values\n  (\n  ❷ now(),\n    user(),\n    concat(\n    ❸ 'New Voter added -',\n         ' voter_id: ',                   new.voter_id,\n         ' voter_name: ',                 new.voter_name,\n         ' voter_address: ',              new.voter_address,\n         ' voter_county: ',               new.voter_county,\n         ' voter_district: ',             new.voter_district,\n         ' voter_precinct: ',             new.voter_precinct,\n         ' voter_party: ',                new.voter_party,\n         ' voting_location: ',            new.voting_location,\n         ' voter_registration_num: ',     new.voter_registration_num\n    )\n  );\nend//\n\ndelimiter ;\n```", "```\naudit_datetime:  2024-05-04 14:13:04\n\naudit_user:      secretary_of_state@localhost\n\naudit_change:    New voter added – voter_id: 1 voter_name: Susan King\n                 voter_address: 12 Pleasant St. Springfield\n                 voter_county: Franklin voter_district: 12A voter_precinct: 4C\n                 voter_party: Democrat voting_location: 523 Emerson St.\n                 voter_registration_num: 129756\n```", "```\ndrop trigger if exists tr_voter_ad;\n\ndelimiter //\n\ncreate trigger tr_voter_ad\n❶ after delete on voter\n  for each row\nbegin\n  insert into voter_audit\n  (\n    audit_datetime,\n    audit_user,\n    audit_change\n  )\n  values\n  (\n    now(),\n    user(),\n    concat(\n      'Voter deleted -',\n         ' voter_id: ',                   old.voter_id,\n         ' voter_name: ',                 old.voter_name,\n         ' voter_address: ',              old.voter_address,\n         ' voter_county: ',               old.voter_county,\n         ' voter_district: ',             old.voter_district,\n         ' voter_precinct: ',             old.voter_precinct,\n         ' voter_party: ',                old.voter_party,\n         ' voting_location: ',            old.voting_location,\n         ' voter_registration_num: ',     old.voter_registration_num\n    )\n  );\nend//\n\ndelimiter ;\n```", "```\naudit_datetime:  2024-05-04 14:28:54\n\naudit_user:      secretary_of_state@localhost\n\naudit_change:    Voter deleted – voter_id: 87 voter_name: Ruth Bain\n                 voter_address: 887 Wyoming St. Centerville\n                 voter_county: Franklin voter_district: 12A voter_precinct: 4C\n                 voter_party: Republican voting_location: 523 Emerson St.\n                 voter_registration_num: 45796\n```", "```\ndrop trigger if exists tr_voter_au;\n\ndelimiter //\n\ncreate trigger tr_voter_au\n  after update on voter\n  for each row\nbegin\n  set @change_msg = concat('Voter ',old.voter_id,' updated: ');\n\n❶ if (new.voter_name != old.voter_name) then\n  ❷ set @change_msg =\n        concat(\n            @change_msg,\n            'Voter name changed from ',\n            old.voter_name,\n            ' to ',\n new.voter_name\n        );\n  end if;\n\n  if (new.voter_address != old.voter_address) then\n    set @change_msg =\n        concat(\n            @change_msg,\n            '. Voter address changed from ',\n            old.voter_address,\n            ' to ',\n            new.voter_address\n    );\n  end if;\n\n  if (new.voter_county != old.voter_county) then\n    set @change_msg =\n        concat(\n            @change_msg,\n            '. Voter county changed from ', old.voter_county, ' to ',\n            new.voter_county\n        );\n  end if;\n\n  if (new.voter_district != old.voter_district) then\n    set @change_msg =\n        concat(\n            @change_msg,\n            '. Voter district changed from ',\n            old.voter_district,\n            ' to ',\n            new.voter_district\n        );\n  end if;\n\n  if (new.voter_precinct != old.voter_precinct) then\n    set @change_msg =\n        concat(\n            @change_msg,\n            '. Voter precinct changed from ',\n            old.voter_precinct,\n            ' to ',\n            new.voter_precinct\n        );\n  end if;\n\n  if (new.voter_party != old.voter_party) then\n    set @change_msg =\n        concat(\n            @change_msg,\n            '. Voter party changed from ',\n            old.voter_party,\n            ' to ',\n new.voter_party\n        );\n  end if;\n\n  if (new.voting_location != old.voting_location) then\n    set @change_msg =\n        concat(\n            @change_msg,\n            '. Voting location changed from ',\n            old.voting_location, '\n            to ',\n            new.voting_location\n        );\n  end if;\n\n  if (new.voter_registration_num != old.voter_registration_num) then\n     set @change_msg =\n         concat(\n             @change_msg,\n             '. Voter registration number changed from ',\n             old.voter_registration_num,\n             ' to ',\n             new.voter_registration_num\n         );\n  end if;\n\ninsert into voter_audit(\n    audit_datetime,\n    audit_user,\n    audit_change\n    )\nvalues (\n    now(),\n    user(),\n  ❸ @change_msg\n    );\n\nend//\n\ndelimiter ;\n```", "```\nupdate voter\nset    voter_name = 'Leah Banks-Kennedy',\n       voter_party = 'Democrat'\nwhere  voter_id = 5876;\n```", "```\naudit_datetime:  2024-05-08 11:08:04\n\naudit_user:      secretary_of_state@localhost\n\naudit_change:    Voter 5876 updated: Voter name changed from Leah Banks\n                 to Leah Banks-Kennedy. Voter party changed from Republican\n                 to Democrat\n```", "```\nconstraint check(ballot_type in ('in-person', 'absentee'))\n```", "```\nballot_type_id  ballot_type\n--------------  ---------------\n       1        in-person\n       2        absentee\n```"]