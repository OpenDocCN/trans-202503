<html><head></head><body>
<h2 class="h2" id="ch11"><span epub:type="pagebreak" id="page_83"/>—11—<br/>Depth-First Search in an Abandoned Prison</h2>&#13;
<p class="noindent">Two steps into the prison, and Frank knew they had walked into a maze. The old computational prisons used to rely on their bizarre structure as much as on guards. Potential escapees think twice about sneaking through a door when they don’t know what lies on the other side: freedom or the guard’s breakroom.</p>&#13;
<p class="indent">“How about some light?” suggested Frank.</p>&#13;
<p class="indent">“Oh. Right,” agreed Socks. He muttered an incantation and a bluish flame flickered from the end of his staff, lighting up the completely unremarkable room.</p>&#13;
<p class="indent">The square room, rough stone walls, and heavy oaken door were enough to confirm what Frank already knew: the entire structure was a grid of rooms, each with doors to only some of its neighbors. They would have to navigate from room to room. But since they didn’t know which rooms had doors between them, they would have to search out a path as they went.</p>&#13;
<p class="indent">“Time for another search,” he said.</p>&#13;
<p class="indent">“A search?” asked Socks. “For what?”</p>&#13;
<p class="indent">“The papers, of course,” responded Frank. He had no doubt that the papers were stashed here. An abandoned prison provided an <span epub:type="pagebreak" id="page_84"/>ideal location for stashing stolen goods, clearly surpassing the more commonly used warehouse. Arguably, the only better location would be an abandoned castle—provided it had a moat. The question now was whether they could find the documents and then, if they did, whether the documents would provide any valuable clues.</p>&#13;
<p class="indent">“Not another breadth-first search,” protested Socks.</p>&#13;
<p class="indent">Frank considered the idea. In theory, breadth-first worked fine on a grid. Each state of the search space was a grid square. Once you explored one grid square, you could add its unexplored neighboring squares to your list of things to try. Frank could clearly picture the search propagating out over an empty grid, like a wave moving across the water.</p>&#13;
<div class="image"><img src="../images/f0084-01.jpg" alt="image"/></div>&#13;
<p class="indent">However, breadth-first search had one major drawback in the physical world—an excessive amount of backtracking. Since you <span epub:type="pagebreak" id="page_85"/>were always adding items to the end of the list, the next square to explore could be annoyingly far away. Even on an empty grid, without walls blocking your path, you could find yourself hiking back to the other end of the search space.</p>&#13;
<div class="image"><img src="../images/f0085-01.jpg" alt="image"/></div>&#13;
<p class="indent">It was the type of unnecessary movement that Frank made it a policy to avoid.</p>&#13;
<p class="indent">“No,” said Frank. “Too much backtracking. We’re better off going depth-first here.”</p>&#13;
<p class="indent">“Depth-first search. Depth-first search,” Socks mumbled to himself as though willing the spell into his memory. “I—I don’t think I remember—”</p>&#13;
<p class="indent">Frank waved him off, and strode confidently down the corridor. “We don’t need a spell for this one. I’ve been doing depth-first searches through buildings since you were in diapers.”</p>&#13;
<p class="indent">“No backtracking with depth-first search then?” asked Socks.</p>&#13;
<p class="indent">“There’s backtracking with most search algorithms. But backtracking in a depth-first search is better suited for walking.”</p>&#13;
<p class="indent">“Um . . . I see.”</p>&#13;
<p class="indent">“No, you don’t,” said Frank bluntly. “If you don’t know the algorithm, just ask. Pretending to know algorithms is a recipe for disaster. I’ve seen too many rookies tripped up due to bad searches. Good kids, like you.”</p>&#13;
<p class="indent">“Okay. What is depth-first search?” Socks asked.</p>&#13;
<p class="indent">“It’s a simple algorithm,” explained Frank. “Basically we explore deeply down each path. We go down one path until we hit a dead end. Then we backtrack to the most recent path that we didn’t take and try that. We’ll stop when we find the target.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_86"/>“In this case, we’re going to use clockwise ordering. Whenever we have multiple options, we’ll try north, east, south, then west—avoiding paths we’ve already tried, of course. We’ll use the same ordering at every intersection, so we’ll always prefer going north if we can. But in this case we have only one option, so we start by going south.”</p>&#13;
<div class="image"><img src="../images/f0086-01.jpg" alt="image"/></div>&#13;
<p class="indent">Even as Frank spoke, they reached their first decision point. Frank surveyed the options. They had come from the north, so he chose east—the next unexplored direction in his ordering. Before leaving the intersection, he retrieved a piece of chalk from his pocket and made a small mark on the wall.</p>&#13;
<div class="image"><img src="../images/f0086-02.jpg" alt="image"/></div>&#13;
<p class="indent">After two more intersections—turning north, then east—they reached their first dead end. So far the rooms had either been completely empty or contained only the odd prison cell—the cells being enclosures within the rooms. With the complete lack of other distinguishing characteristics, Frank chalked a number onto a wall in each room and linked that number in his mind to the different mold formations he found there.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_87"/><img src="../images/f0087-01.jpg" alt="image"/></div>&#13;
<p class="indent">“Now we backtrack to the last room, room 5, with the mold that looked like a horse,” explained Frank as they retraced their steps. This time they chose the only unexplored option from room 5, heading west. Unfortunately, they immediately hit another dead end—an empty room that sported a complex floral pattern of green and blue fuzz.</p>&#13;
<div class="image"><img src="../images/f0087-02.jpg" alt="image"/></div>&#13;
<p class="indent">They backtracked through the most recent intersection whose options had been exhausted until they had a new option at room 4. The eastern option was a dead end, and they’d already explored the northern option, so this time they went south.</p>&#13;
<p class="indent">They ventured through two new empty rooms (8 and 9), differentiated only by the occurrence of a large stalactite of orange mold, which they stayed as far away from as possible. Orange mold was not known for its structural stability. After hitting another dead end, they found themselves retracing their steps all the way back to the first intersection in room 2.</p>&#13;
<div class="image"><img src="../images/f0087-03.jpg" alt="image"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_88"/>“What if we miss it?” asked Socks in his now-standard worried tone. “Or what if we end up in a loop? We could be stuck forever!”</p>&#13;
<p class="indent">Frank groaned. “Listen, kid. This isn’t my first time depth-first searching. I know what I’m doing.”</p>&#13;
<p class="indent">“But loops.”</p>&#13;
<p class="indent">“Why do you think I’m marking the walls?” asked Frank. “If we avoid taking passages that we’ve already explored, we avoid going in loops.”</p>&#13;
<p class="indent">Frank had learned that lesson during a Police Algorithms exercise. With the whole class watching, Frank had done six loops of the hedge maze before he heard another student loudly joke, “There he goes again.”</p>&#13;
<p class="indent">They explored deeper into the maze, following snaking paths and backtracking at dead ends.</p>&#13;
<div class="image"><img src="../images/f0088-01.jpg" alt="image"/></div>&#13;
<p class="indent">Then, in room 23, they found a small cell packed high with rolls of parchment and stacks of ledgers.</p>&#13;
<div class="image"><img src="../images/f0088-02.jpg" alt="image"/></div>&#13;
<p class="indent">“We found it!” said Socks enthusiastically. His staff’s flame cast a flickering blue glow through the room.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_89"/>Frank felt the hairs on his neck rise as he took in the scene. He compared the height of the stacks with the mountains of paperwork he had completed through the years and did some quick calculations. The captain had never been shy about dumping paperwork on him, but Frank had still never seen anything like this. There were even mold-stained pages at the bottom of the stacks. Everything felt wrong.</p>&#13;
<p class="indent">Frank walked to the nearest stack and pulled off a sheet of parchment: a notice on the proper use of duck fences. The date and station number marked it as belonging to the stolen files. The next sheet, listing noise complaints in the Port of West Serial, also came from the stolen collection. It appeared equally random and unhelpful.</p>&#13;
<p class="indent">He knelt down and pried open a gap near the bottom, yanking a ledger free. The pages were spotted with a trio of mold-butterflies, but Frank could clearly make out supply lists for the castle guards. This ledger could have come only from the castle itself. He grabbed another book and found castle guard rotations for last November.</p>&#13;
<p class="indent">“This is wrong,” he muttered. “There’s too much here. There’s castle ledgers as well.” Frank shifted to an adjacent pile, starting again at the top.</p>&#13;
<p class="indent">“Is there a pattern?” asked Socks, as though he had just noticed the extent of the document piles.</p>&#13;
<p class="indent">“I—” started Frank, but he pulled up short as he opened another ledger, entitled <em>Transfer Requests</em>. Four pages had been torn from the middle of the ledger.</p>&#13;
<p class="indent">“Very strange,” said Frank, flipping through the undamaged pages. “This could be—”</p>&#13;
<p class="indent">Frank was cut off as Socks stumbled toward him, flailing for balance. Behind him, Frank could see motion in the gloom. It wasn’t until he heard the rusty shriek of the door’s hinges that he realized what was happening.</p>&#13;
<p class="indent">“Door!” Frank yelled as the junior wizard fell into him.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_90"/><img src="../images/f0090-01.jpg" alt="image"/></div>&#13;
<p class="indent">The two of them tumbled to the ground. The door slammed. A loud click sounded as the lock engaged. Socks’s staff, which had been dropped in the commotion, spun lazily into a tall stack of dry parchment. The staff’s blue flame seemed much larger than Frank remembered.</p>&#13;
<p class="indent">Frank lay stunned on the stone floor as he watched the papers ignite.</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart"><span epub:type="pagebreak" id="page_91"/><strong>POLICE ALGORITHMS 101: DEPTH-FIRST SEARCH</strong></p>&#13;
<p class="sbsub"><em><strong>Excerpt from Professor Drecker’s Lecture</strong></em></p>&#13;
<p class="noindent">Unlike breadth-first search, depth-first search is an algorithm that explores more recently encountered search states first. The algorithm progresses down paths until it hits either the target or a dead end.</p>&#13;
<p class="indent">As with breadth-first search, you can visualize depth-first search as keeping a list (in this case, a <em>stack</em>) of known but unexplored states. At each step, the algorithm picks the next state to explore from the top of the stack. But unlike breadth-first search, depth-first search adds new options to the <em>top</em> of the stack.</p>&#13;
<p class="indent">Consider our graph example from the lecture on breadth-first search. Remember, graphs are data structures composed of individual nodes and edges linking those nodes. They can be used to represent all sorts of concepts, like city maps, networks of criminals, or even the layout of a castle. We’ll use the Kingdom Highway Map from the same lecture and start our search from city A—the scene of the crime.</p>&#13;
<div class="image"><img src="../images/f0091-01.jpg" alt="image"/></div>&#13;
<p class="indent">Depth-first search explores down one path until it hits a dead end (or a node it has already explored). In this way, the algorithm prioritizes exploring <em>deeply</em> down paths over exploring <em>broadly</em> over the options, as in breadth-first search.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_92"/><img src="../images/f0092-01.jpg" alt="image"/></div>&#13;
<p class="indent">Once again, we find our suspect hiding in city H—although this time we travel a different path during our search.</p>&#13;
<p class="indent">As with breadth-first search, we avoid exploring nodes more than once by keeping track of previously visited nodes. This check is particularly important if you want to avoid falling into endless loops, checking the same nodes over and over again. In the above example, we avoid adding previously seen nodes (either explored or unexplored) to our list altogether.</p>&#13;
</div>&#13;
</body></html>