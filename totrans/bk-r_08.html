<html><head></head><body>
<h2 class="h2" id="ch07"><span epub:type="pagebreak" id="page_127"/><span class="big"><strong>7</strong></span><br/><strong>BASIC PLOTTING</strong></h2>&#13;
<div class="image"><img src="../images/common-01.jpg" alt="image"/></div>&#13;
<p class="noindent">One particularly popular feature of R is its incredibly flexible plotting tools for data and model visualization. This is what draws many to R in the first place. Mastering R’s graphical functionality does require practice, but the fundamental concepts are straightforward. In this chapter, I’ll provide an overview of the <code>plot</code> function and some useful options for controlling the appearance of the final graph. Then I’ll cover the basics of using <code>ggplot2</code>, a powerful library for visualizing data in R. This chapter will cover just the basics of plotting, and then you’ll learn more about creating different types of statistical plots in <a href="ch14.xhtml#ch14">Chapter 14</a>, and about advanced plotting techniques in <a href="part05.xhtml#part05">Part V</a>.</p>&#13;
<h3 class="h3" id="ch07lev1sec23"><strong>7.1 Using plot with Coordinate Vectors</strong></h3>&#13;
<p class="noindent">The easiest way to think about generating plots in R is to treat your screen as a blank, two-dimensional canvas. You can plot points and lines using <em>x-</em>and <em>y</em>-coordinates. On paper, these coordinates are usually represented with points written as a pair: (<em>x</em> value, <em>y</em> value). The R function <code>plot</code>, on the other hand, takes in two vectors—one vector of <em>x</em> locations and one vector of <em>y</em> locations—and opens a <em>graphics device</em> where it displays the result. If a <span epub:type="pagebreak" id="page_128"/>graphics device is already open, R’s default behavior is to refresh the device, overwriting the current contents with the new plot.</p>&#13;
<p class="indent">For example, let’s say you wanted to plot the points (1.1,2), (2,2.2), (3.5, − 1.3), (3.9,0), and (4.2,0.2). In <code>plot</code>, you must provide the vector of <em>x</em> locations first, and the <em>y</em> locations second. Let’s define these as <code>foo</code> and <code>bar</code>, respectively:</p>&#13;
<pre>R&gt; foo &lt;- c(1.1,2,3.5,3.9,4.2)<br/>R&gt; bar &lt;- c(2,2.2,-1.3,0,0.2)<br/>R&gt; plot(foo,bar)</pre>&#13;
<p class="indent"><a href="ch07.xhtml#ch7fig1">Figure 7-1</a> shows the resulting graphics device with the plot (I’ll use this simple data set as a working example throughout this section).</p>&#13;
<div class="image"><img src="../images/f07-01.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch7fig1"/>Figure 7-1: The five plotted points using R’s default behavior</em></p>&#13;
<p class="indent">The <em>x</em> and <em>y</em> locations don’t necessarily need to be specified as separate vectors. You can also supply coordinates in the form of a matrix, with the <em>x</em> values in the first column and the <em>y</em> values in the second column, or as a list. For example, setting up a matrix of the five points, the following code exactly reproduces <a href="ch07.xhtml#ch7fig1">Figure 7-1</a> (note the window pane will look slightly different depending on your operating system):</p>&#13;
<pre>R&gt; baz &lt;- cbind(foo,bar)<br/>R&gt; baz<br/>     foo  bar<br/>[1,] 1.1  2.0<br/>[2,] 2.0  2.2<br/>[3,] 3.5 -1.3<br/>[4,] 3.9  0.0<br/>[5,] 4.2  0.2<br/>R&gt; plot(baz)</pre>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_129"/>The <code>plot</code> function is one of R’s versatile <em>generic</em> functions. It works differently for different objects and allows users to define their own methods for handling objects (including user-defined object classes). Technically, the version of the <code>plot</code> command that you’ve just used is internally identified as <code>plot.default</code>. The help file <code>?plot.default</code> provides additional details on this <em>scatterplot</em> style of data visualization.</p>&#13;
<h3 class="h3" id="ch07lev1sec24"><strong>7.2 Graphical Parameters</strong></h3>&#13;
<p class="noindentb">There are a wide range of <em>graphical parameters</em> that can be supplied as arguments to the <code>plot</code> function (or other plotting functions, such as those in <a href="ch07.xhtml#ch07lev1sec25">Section 7.3</a>). These parameters invoke simple visual enhancements, like coloring the points and adding axis labels, and can also control technical aspects of the graphics device (<a href="ch23.xhtml#ch23">Chapter 23</a> covers the latter in more detail). Some of the most commonly used graphical parameters are listed here; I’ll briefly discuss each of these in turn in the following sections:</p>&#13;
<p class="noindenth"><code><span class="codestrong">type</code></span> Tells R how to plot the supplied coordinates (for example, as stand-alone points or joined by lines or both dots and lines).</p>&#13;
<p class="noindenth"><code><span class="codestrong">main</code></span>, <code><span class="codestrong">xlab</code></span>, <code><span class="codestrong">ylab</code></span> Options to include plot title, the horizontal axis label, and the vertical axis label, respectively.</p>&#13;
<p class="noindenth"><code><span class="codestrong">col</code></span> Color (or colors) to use for plotting points and lines.</p>&#13;
<p class="noindenth"><code><span class="codestrong">pch</code></span> Stands for <em>point character</em>. This selects which character to use for plotting individual points.</p>&#13;
<p class="noindenth"><code><span class="codestrong">cex</code></span> Stands for <em>character expansion</em>. This controls the size of plotted point characters.</p>&#13;
<p class="noindenth"><code><span class="codestrong">lty</code></span> Stands for <em>line type</em>. This specifies the type of line to use to connect the points (for example, solid, dotted, or dashed).</p>&#13;
<p class="noindenth"><code><span class="codestrong">lwd</code></span> Stands for <em>line width</em>. This controls the thickness of plotted lines.</p>&#13;
<p class="noindenth"><code><span class="codestrong">xlim</code></span>, <code><span class="codestrong">ylim</code></span> This provides limits for the horizontal range and vertical range (respectively) of the plotting region.</p>&#13;
<h4 class="h4" id="ch07lev2sec63"><strong><em>7.2.1 Automatic Plot Types</em></strong></h4>&#13;
<p class="noindent">By default, the <code>plot</code> function will plot individual points, as shown in <a href="ch07.xhtml#ch7fig1">Figure 7-1</a>. This is the default plot type, but other plot types will have a different appearance. To control the plot type, you can specify a single character-valued option for the argument <code>type</code>.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_130"/>For example, in many cases it makes sense to show lines connecting each coordinate, such as when plotting time series data. For this, you would specify plot type <code>"l"</code>. Using <code>foo</code> and <code>bar</code> from <a href="ch07.xhtml#ch07lev1sec23">Section 7.1</a>, the following produces the plot in the left panel of <a href="ch07.xhtml#ch7fig2">Figure 7-2</a>:</p>&#13;
<pre>R&gt; plot(foo,bar,type="l")</pre>&#13;
<div class="image"><img src="../images/f07-02.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch7fig2"/>Figure 7-2: A line plot produced using five adjoined coordinates, setting</em> <code>type="l"</code> <em>(left) or</em> <code>type="b"</code> <em>(right)</em></p>&#13;
<p class="indent">The default value for <code>type</code> is <code>"p"</code>, which can be interpreted as “points only.” Since you didn’t specify anything different, this is what was used for the graph in <a href="ch07.xhtml#ch7fig1">Figure 7-1</a>. In this last example, on the other hand, you’ve set <code>type="l"</code> (meaning “lines only”). Other options include <code>"b"</code> for both points <em>and</em> lines (shown in the right panel of <a href="ch07.xhtml#ch7fig2">Figure 7-2</a>) and <code>"o"</code> for overplotting the points with lines (this eliminates the gaps between points and lines visible for <code>type="b"</code>). The option <code>type="n"</code> results in no points or lines plotted, creating an empty plot, which can be useful for complicated plots that must be constructed in steps.</p>&#13;
<h4 class="h4" id="ch07lev2sec64"><strong><em>7.2.2 Title and Axis Labels</em></strong></h4>&#13;
<p class="noindent">By default, a basic plot won’t have a main title, and its axes will be labeled with the names of the vectors being plotted. But a main title and more descriptive axis labels often make the plotted data easier to interpret. You can add these by supplying text as character strings to <code>main</code> for a title, <code>xlab</code> for the <em>x</em>-axis label, and <code>ylab</code> for the <em>y</em>-axis label. Note that these strings may include escape sequences (discussed in <a href="ch04.xhtml#ch04lev2sec44">Section 4.2.3</a>). The following code produces the plots in <a href="ch07.xhtml#ch7fig3">Figure 7-3</a>:</p>&#13;
<pre>R&gt; plot(foo,bar,type="b",main="My lovely plot",xlab="x axis label",<br/>        ylab="location y")<br/>R&gt; plot(foo,bar,type="b",main="My lovely plot\ntitle on two lines",xlab="",<br/>        ylab="")</pre>&#13;
<div class="image"><span epub:type="pagebreak" id="page_131"/><img src="../images/f07-03.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch7fig3"/>Figure 7-3: Two examples of plots with axis labels and titles</em></p>&#13;
<p class="indent">In the second plot, note how the new line escape sequence splits the title into two lines. In that plot, <code>xlab</code> and <code>ylab</code> are also set to the empty string <code>""</code> to prevent R from labeling the axes with the names of the <em>x</em> and <em>y</em> vectors.</p>&#13;
<h4 class="h4" id="ch07lev2sec65"><strong><em>7.2.3 Color</em></strong></h4>&#13;
<p class="noindent">Adding color to a graph is far from just an aesthetic consideration. Color can make data much clearer—for example by distinguishing factor levels or emphasizing important numeric limits. You can set colors with the <code>col</code> parameter in a number of ways. The simplest options are to use an integer selector or a character string. There are a number of color string values recognized by R, which you can see by entering <code>colors()</code> at the prompt. The default color is integer <code>1</code> or the character string <code>"black"</code>. The top row of <a href="ch07.xhtml#ch7fig4">Figure 7-4</a> shows two examples of colored graphs, created by the following code:</p>&#13;
<pre>R&gt; plot(foo,bar,type="b",main="My lovely plot",xlab="",ylab="",col=2)<br/>R&gt; plot(foo,bar,type="b",main="My lovely plot",xlab="",ylab="",col="seagreen4")</pre>&#13;
<p class="indent">There are eight possible integer values (shown in the leftmost plot of <a href="ch07.xhtml#ch7fig5">Figure 7-5</a>) and around 650 character strings to specify color. But you aren’t limited to these options since you can also specify colors using RGB (red, green, and blue) levels and by creating your own palettes. I’ll talk more about the last two options in <a href="ch25.xhtml#ch25">Chapter 25</a>.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_132"/><img src="../images/f07-04.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch7fig4"/>Figure 7-4: Experimenting with basic R plotting. Top row: Two examples of colored plots with</em> <code>col=2</code> <em>(left) and</em> <code>col="seagreen4"</code> <em>(right). Middle row: Two further examples making use of</em> <code>pch</code>, <code>lty</code>, <code>cex</code><em>, and</em> <code>lwd</code><em>. Bottom row: Setting plotting region limits</em> <code>xlim=c(-10,5)</code>, <code>ylim=c(-3,3)</code> <em>(left), and</em> <code>xlim=c(3,5)</code>, <code>ylim=c(-0.5,0.2)</code> <em>(right).</em></p>&#13;
<h4 class="h4" id="ch07lev2sec66"><span epub:type="pagebreak" id="page_133"/><strong><em>7.2.4 Line and Point Appearances</em></strong></h4>&#13;
<p class="noindent">To alter the appearance of the plotted points you would use <code>pch</code>, and to alter the lines you would use <code>lty</code>. The <code>pch</code> parameter controls the character used to plot individual data points. You can specify a single character to use for each point, or you can specify a value between <code>1</code> and <code>25</code> (inclusive). The symbols corresponding to each integer are shown in the middle plot of <a href="ch07.xhtml#ch7fig5">Figure 7-5</a>. The <code>lty</code> parameter, which affects the type of line drawn, can take the values <code>1</code> through <code>6</code>. These options are shown in the rightmost plot of <a href="ch07.xhtml#ch7fig5">Figure 7-5</a>.</p>&#13;
<div class="image"><img src="../images/f07-05.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch7fig5"/>Figure 7-5: Some reference plots giving the results of possible integer options of</em> <code>col</code> <em>(left),</em> <code>pch</code> <em>(middle), and</em> <code>lty</code> <em>(right)</em></p>&#13;
<p class="indent">You can also control the size of plotted points using <code>cex</code> and the thickness of lines using <code>lwd</code>. The default size and thickness for both of these is <code>1</code>. To request half-size points, for example, you’d specify <code>cex=0.5</code>; to specify double-thick lines, use <code>lwd=2</code>.</p>&#13;
<p class="indent">The following two lines produce the two plots in the middle row of <a href="ch07.xhtml#ch7fig4">Figure 7-4</a>, showing off <code>pch</code>, <code>lty</code>, <code>cex</code>, and <code>lwd</code>:</p>&#13;
<pre>R&gt; plot(foo,bar,type="b",main="My lovely plot",xlab="",ylab="",<br/>        col=4,pch=8,lty=2,cex=2.3,lwd=3.3)<br/>R&gt; plot(foo,bar,type="b",main="My lovely plot",xlab="",ylab="",<br/>        col=6,pch=15,lty=3,cex=0.7,lwd=2)</pre>&#13;
<h4 class="h4" id="ch07lev2sec67"><strong><em>7.2.5 Plotting Region Limits</em></strong></h4>&#13;
<p class="noindent">As you can see in the plots of <code>foo</code> and <code>bar</code>, by default R sets the range of each axis by using the range of the supplied <em>x</em> and <em>y</em> values (plus a small constant to pad a little area around the outermost points). But you might need more space than this to, for example, annotate individual points, add a legend, or plot additional points that fall outside the original ranges (as you’ll see in <a href="ch07.xhtml#ch07lev1sec25">Section 7.3</a>). You can set custom plotting area limits using <code>xlim</code> and <code>ylim</code>. Both parameters require a numeric vector of length 2, provided as <code>c(<span class="codeitalic">lower</code>, <span class="codeitalic">upper</span>)</span>.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_134"/>Consider the plots in the bottom row of <a href="ch07.xhtml#ch7fig4">Figure 7-4</a>, created with the following two commands:</p>&#13;
<pre>R&gt; plot(foo,bar,type="b",main="My lovely plot",xlab="",ylab="",<br/>        col=4,pch=8,lty=2,cex=2.3,lwd=3.3,xlim=c(-10,5),ylim=c(-3,3))<br/>R&gt; plot(foo,bar,type="b",main="My lovely plot",xlab="",ylab="",<br/>        col=6,pch=15,lty=3,cex=0.7,lwd=2,xlim=c(3,5),ylim=c(-0.5,0.2))</pre>&#13;
<p class="indent">These plots are exactly the same as the two in the middle row, except for one important difference. In the bottom-left plot of <a href="ch07.xhtml#ch7fig4">Figure 7-4</a>, the <em>x</em>-and <em>y</em>-axes are set to be much wider than the observed data, and the plot on the right restricts the plotting window so that only a portion of the data is displayed.</p>&#13;
<h3 class="h3" id="ch07lev1sec25"><strong>7.3 Adding Points, Lines, and Text to an Existing Plot</strong></h3>&#13;
<p class="noindentb">Generally speaking, each call to <code>plot</code> will refresh the active graphics device for a new plotting region. But this is not always desired—to build more complicated plots, it’s easiest to start with an empty plotting region and progressively add any required points, lines, text, and legends to this canvas. Here are some useful, ready-to-use functions in R that will add to a plot without refreshing or clearing the window:</p>&#13;
<p class="noindenth"><code><span class="codestrong">points</code></span> Adds points</p>&#13;
<p class="noindenth"><code><span class="codestrong">lines</code></span>, <code><span class="codestrong">abline</code></span>, <code><span class="codestrong">segments</code></span> Adds lines</p>&#13;
<p class="noindenth"><code><span class="codestrong">text</code></span> Writes text</p>&#13;
<p class="noindenth"><code><span class="codestrong">arrows</code></span> Adds arrows</p>&#13;
<p class="noindenth"><code><span class="codestrong">legend</code></span> Adds a legend</p>&#13;
<p class="indentt">The syntax for calling and setting parameters for these functions is the same as <code>plot</code>. The best way to see how these work is through an extended example, which I’ll base on some hypothetical data made up of 20 (<em>x</em>, <em>y</em>) locations.</p>&#13;
<pre>R&gt; x &lt;- 1:20<br/>R&gt; y &lt;- c(-1.49,3.37,2.59,-2.78,-3.94,-0.92,6.43,8.51,3.41,-8.23,<br/>       -12.01,-6.58,2.87,14.12,9.63,-4.58,-14.78,-11.67,1.17,15.62)</pre>&#13;
<p class="indent">Using these data, you’ll build up the plot shown in <a href="ch07.xhtml#ch7fig6">Figure 7-6</a> (note that you may need to manually enlarge your graphics device and replot to ensure the legend doesn’t overlap other features of the image). It’s worth remembering a generally accepted rule in plotting: “keep it clear and simple.” <a href="ch07.xhtml#ch7fig6">Figure 7-6</a> is an exception for the sake of demonstrating the R commands used.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_135"/><img src="../images/f07-06.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch7fig6"/>Figure 7-6: An elaborate final plot of some hypothetical data</em></p>&#13;
<p class="indent">In <a href="ch07.xhtml#ch7fig6">Figure 7-6</a>, the data points will be plotted differently according to their <em>x</em> and <em>y</em> locations, depending on their relation to the “sweet spot” pointed out in the figure. Points with a <em>y</em> value greater than 5 are marked with a purple ×; points with a <em>y</em> value less than −5 are marked with a green +. Points between these two <em>y</em> values but still outside of the sweet spot are marked with a <span class="ent">○</span>. Finally, points in the sweet spot (with <em>x</em> between 5 and 15 <em>and</em> with <em>y</em> between −5 and 5) are marked as a blue •. Red horizontal and vertical lines delineate the sweet spot, which is labeled with an arrow, and there’s also a legend.</p>&#13;
<p class="indent">Ten lines of code were used to build this plot in its entirety (plus one additional line to add the legend). The plot, as it looks at each step, is given in <a href="ch07.xhtml#ch7fig7">Figure 7-7</a>. The lines of code are detailed next.</p>&#13;
<ol>&#13;
<li><p class="noindent">The first step is to create the empty plotting region where you can add points and draw lines. This first line tells R to plot the data in <code>x</code> and <code>y</code>, though the option <code>type</code> is set to <code>"n"</code>. As mentioned in <a href="ch07.xhtml#ch07lev1sec24">Section 7.2</a>, this opens or refreshes the graphics device and sets the axes to the appropriate lengths (with labels and axes), but it doesn’t plot any points or lines.</p>&#13;
<pre>R&gt; plot(x,y,type="n",main="")</pre></li>&#13;
<li><p class="noindent">The <code>abline</code> function is a simple way to add straight lines spanning a plot. The line (or lines) can be specified with <em>slope</em> and <em>intercept</em> values (see the later discussions on regression in <a href="ch20.xhtml#ch20">Chapter 20</a>). You can also simply add horizontal or vertical lines. This line of code adds two separate horizontal lines, one at <em>y</em> = 5 and the other at <em>y</em> = 5, using <code>h=c(-5,5)</code>. The three parameters (covered in <a href="ch07.xhtml#ch07lev1sec24">Section 7.2</a>) make these <span epub:type="pagebreak" id="page_136"/>two lines red, dashed, and double-thickness. For vertical lines, you could have written <code>v=c(-5,5)</code>, which would have drawn them at <em>x</em> = −5 and <em>x</em> = 5.</p>&#13;
<div class="image"><img src="../images/f07-07.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch7fig7"/>Figure 7-7: Building the final plot given in <a href="ch07.xhtml#ch7fig6">Figure 7-6</a>. The plots (1) through (10) correspond to the itemized lines of code in the text.</em></p>&#13;
<pre><span epub:type="pagebreak" id="page_137"/>R&gt; abline(h=c(-5,5),col="red",lty=2,lwd=2)</pre></li>&#13;
<li><p class="noindent">The third line of code adds shorter vertical lines between the horizontal ones drawn in step 2 to form a box. For this you use <code>segments</code>, not <code>abline</code>, since you don’t want these lines to span the entire plotting region. The <code>segments</code> command takes a “from” coordinate (given as <code>x0</code> and <code>y0</code>) and a “to” coordinate (as <code>x1</code> and <code>y1</code>) and draws the corresponding line. The vector-oriented behavior of R matches up the two sets of “from” and “to” coordinates. Both lines are red and dotted and have double-thickness. (You could also supply vectors of length 2 to these parameters, in which case the first segment would use the first parameter value and the second segment would use the second value.)</p>&#13;
<pre>R&gt; segments(x0=c(5,15),y0=c(-5,-5),x1=c(5,15),y1=c(5,5),col="red",lty=3,<br/>            lwd=2)</pre></li>&#13;
<li><p class="noindent">As step 4, you use <code>points</code> to begin adding specific coordinates from <code>x</code> and <code>y</code> to the plot. Just like <code>plot</code>, <code>points</code> takes two vectors of equal lengths with <em>x</em> and <em>y</em> values. In this case, you want points plotted differently according to their location, so you use logical vector subsetting (see <a href="ch04.xhtml#ch04lev2sec41">Section 4.1.5</a>) to identify and extract elements of <code>x</code> and <code>y</code> where the <em>y</em> value is greater than or equal to 5. These (and only these) points are added as purple × symbols and are enlarged by a factor of 2 with <code>cex</code>.</p>&#13;
<pre>R&gt; points(x[y&gt;=5],y[y&gt;=5],pch=4,col="darkmagenta",cex=2)</pre></li>&#13;
<li><p class="noindent">The fifth line of code is much like the fourth; this time it extracts the coordinates where <em>y</em> values are less than or equal to −5. A + point character is used, and you set the color to dark green.</p>&#13;
<pre>R&gt; points(x[y&lt;=-5],y[y&lt;=-5],pch=3,col="darkgreen",cex=2)</pre></li>&#13;
<li><p class="noindent">The sixth step adds the blue “sweet spot” points, which are identified with <code>(x&gt;=5&amp;x&lt;=15)&amp;(y&gt;-5&amp;y&lt;5)</code>. This slightly more complicated set of conditions extracts the points whose <em>x</em> location lies between 5 and 15 (inclusive) AND whose <em>y</em> location lies between −5 and 5 (exclusive). Note that this line uses the “short” form of the logical operator <code>&amp;</code> throughout since you want element-wise comparisons here (see <a href="ch04.xhtml#ch04lev2sec39">Section 4.1.3</a>).</p>&#13;
<pre>R&gt; points(x[(x&gt;=5&amp;x&lt;=15)&amp;(y&gt;-5&amp;y&lt;5)],y[(x&gt;=5&amp;x&lt;=15)&amp;(y&gt;-5&amp;y&lt;5)],pch=19,<br/>          col="blue")</pre></li>&#13;
<li><p class="noindent">This next command identifies the remaining points in the data set (with an <em>x</em> value that is either less than 5 OR greater than 15 AND a <em>y</em> value between −5 and 5). No graphical parameters are specified, so these points are plotted with the default black <span class="ent">○</span>.</p>&#13;
<pre>R&gt; points(x[(x&lt;5|x&gt;15)&amp;(y&gt;-5&amp;y&lt;5)],y[(x&lt;5|x&gt;15)&amp;(y&gt;-5&amp;y&lt;5)])</pre></li>&#13;
<li><p class="noindent"><span epub:type="pagebreak" id="page_138"/>To draw lines connecting the coordinates in <code>x</code> and <code>y</code>, you use <code>lines</code>. Here you’ve also set <code>lty</code> to <code>4</code>, which draws a dash-dot-dash style line.</p>&#13;
<pre>R&gt; lines(x,y,lty=4)</pre></li>&#13;
<li><p class="noindent">The ninth line of code adds the arrow pointing to the sweet spot. The function <code>arrows</code> is used just like <code>segments</code>, where you provide a “from” coordinate (<code>x0</code>, <code>y0</code>) and a “to” coordinate (<code>x1</code>, <code>y1</code>). By default, the head of the arrow is located at the “to” coordinate, though this (and other options such as the angle and length of the head) can be altered using optional arguments described in the help file <code>?arrows</code>.</p>&#13;
<pre>R&gt; arrows(x0=8,y0=14,x1=11,y1=2.5)</pre></li>&#13;
<li><p class="noindent">The tenth line prints a label on the plot at the top of the arrow. As per the default behavior of <code>text</code>, the string supplied as <code>labels</code> is <em>centered</em> on the coordinates provided with the arguments <code>x</code> and <code>y</code>.</p>&#13;
<pre>R&gt; text(x=8,y=15,labels="sweet spot")</pre></li>&#13;
</ol>&#13;
<p class="indent">As a finishing touch, you can add the legend with the <code>legend</code> function, which gives you the final product shown in <a href="ch07.xhtml#ch7fig6">Figure 7-6</a>.</p>&#13;
<pre>legend("bottomleft",<br/>       legend=c("overall process","sweet","standard",<br/>                "too big","too small","sweet y range","sweet x range"),<br/>       pch=c(NA,19,1,4,3,NA,NA),lty=c(4,NA,NA,NA,NA,2,3),<br/>       col=c("black","blue","black","darkmagenta","darkgreen","red","red"),<br/>       lwd=c(1,NA,NA,NA,NA,2,2),pt.cex=c(NA,1,1,2,2,NA,NA))</pre>&#13;
<p class="indent">The first argument sets where the legend should be placed. There are various ways to do this (including setting exact <em>x</em>- and <em>y</em>-coordinates), but it often suffices to pick a corner using one of the four following character strings: <code>"topleft"</code>, <code>"topright"</code>, <code>"bottomleft"</code>, or <code>"bottomright"</code>. Next you supply the labels as a vector of character strings to the <code>legend</code> argument. Then you need to supply the remaining argument values in vectors of the same length so that the right elements match up with each label.</p>&#13;
<p class="indent">For example, for the first label (<code>"overall process"</code>), you want a line of type 4 with default thickness and color. So, in the first positions of the remaining argument vectors, you set <code>pch=NA</code>, <code>lty=4</code>, <code>col="black"</code>, <code>lwd=1</code>, and <code>pt.cex=NA</code> (all of these are default values, except for <code>lty</code>). Here, <code>pt.cex</code> simply refers to the <code>cex</code> parameter when calling <code>points</code> (using just <code>cex</code> in <code>legend</code> would expand the text used, not the points).</p>&#13;
<p class="indent">Note that you have to fill in some elements in these vectors with <code>NA</code> when you don’t want to set the corresponding graphical parameter. This is just to preserve the equal lengths of the vectors supplied so R can track which parameter values correspond to each particular reference. As you work through this book, you’ll see plenty more examples using <code>legend</code>.</p>&#13;
<div class="ex">&#13;
<p class="ext"><span epub:type="pagebreak" id="page_139"/><a id="ch7exc1"/><strong>Exercise 7.1</strong></p>&#13;
<ol type="a">&#13;
<li><p class="noindent">As closely as you can, re-create the following plot:</p>&#13;
<div class="imagec"><img src="../images/f0139-01.jpg" alt="image"/></div></li>&#13;
<li><p class="noindents">With the following data, create a plot of weight on the <em>x</em>-axis and height on the <em>y</em>-axis. Use different point characters or colors to distinguish between males and females and provide a matching legend. Label the axes and give the plot a title.</p>&#13;
<table class="topbot1">&#13;
<thead>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Weight (kg)</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Height (cm)</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Sex</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">55</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">161</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">female</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">85</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">185</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">male</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">75</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">174</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">male</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">42</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">154</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">female</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">93</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">188</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">male</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">63</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">178</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">male</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">58</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">170</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">female</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">75</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">167</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">male</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">89</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">181</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">male</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">67</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">178</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">female</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table></li>&#13;
</ol>&#13;
</div>&#13;
<h3 class="h3" id="ch07lev1sec26"><strong>7.4 The ggplot2 Package</strong></h3>&#13;
<p class="noindent">This chapter so far has shown off R’s built-in graphical tools (often called <em>base R graphics</em> or <em>traditional R graphics</em>). Now, let’s look at another important suite of graphical tools: <code>ggplot2</code>, a prominent contributed package by Hadley Wickham (<a href="ref.xhtml#ref72">2009</a>). Available on CRAN like any other contributed package, <code>ggplot2</code> offers particularly powerful alternatives to the standard plotting procedures in R. The <em>gg</em> stands for <em>grammar of graphics</em>—a particular approach to graphical production described by Wilkinson (<a href="ref.xhtml#ref75">2005</a>). In following this approach, <code>ggplot2</code> standardizes the production of different plot and graph types, streamlines some of the more fiddly aspects of adding to existing plots (such as including a legend), and lets you build plots by defining and manipulating <em>layers</em>. For the moment, let’s see the elementary behavior of <code>ggplot2</code> <span epub:type="pagebreak" id="page_140"/>using the same simple examples in <a href="ch07.xhtml#ch07lev1sec23">Sections 7.1</a>–<a href="ch07.xhtml#ch07lev1sec25">7.3</a>. You’ll get familiar with the basic plotting function <code>qplot</code> and how it differs from the generic <code>plot</code> function used earlier. I’ll return to the topic of <code>ggplot2</code> when I cover statistical plots in <a href="ch14.xhtml#ch14">Chapter 14</a>, and you’ll investigate even more advanced abilities in <a href="ch24.xhtml#ch24">Chapter 24</a>.</p>&#13;
<h4 class="h4" id="ch07lev2sec68"><strong><em>7.4.1 A Quick Plot with qplot</em></strong></h4>&#13;
<p class="noindent">First, you must install the <code>ggplot2</code> package by downloading it manually or simply entering <code>install.packages("ggplot2")</code> at the prompt (see <a href="app01.xhtml#app01lev2sec275">Section A.2.3</a>). Then, load the package with the following:</p>&#13;
<pre>R&gt; library("ggplot2")</pre>&#13;
<p class="indent">Now, let’s go back to the five data points originally stored in <a href="ch07.xhtml#ch07lev1sec23">Section 7.1</a> as <code>foo</code> and <code>bar</code>.</p>&#13;
<pre>R&gt; foo &lt;- c(1.1,2,3.5,3.9,4.2)<br/>R&gt; bar &lt;- c(2,2.2,-1.3,0,0.2)</pre>&#13;
<p class="indent">You can produce <code>ggplot2</code>’s version of <a href="ch07.xhtml#ch7fig1">Figure 7-1</a> using its “quick plot” function <code>qplot</code>.</p>&#13;
<pre>R&gt; qplot(foo,bar)</pre>&#13;
<p class="indent">The result is shown in the left image of <a href="ch07.xhtml#ch7fig8">Figure 7-8</a>. There are some obvious differences between this image and the one produced using <code>plot</code>, but the basic syntax of <code>qplot</code> is the same as earlier. The first two arguments passed to <code>qplot</code> are vectors of equal length, with the <em>x</em>-coordinates in <code>foo</code> supplied first, followed by the <em>y</em>-coordinates in <code>bar</code>.</p>&#13;
<div class="image"><img src="../images/f07-08.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch7fig8"/>Figure 7-8: Five plotted points using</em> <code>ggplot2</code><em>’s default behavior for the</em> <code>qplot</code> <em>function (left) and with title and axis labels added (right)</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_141"/>Adding a title and axis labels also uses the same arguments you already saw with <code>plot</code> in <a href="ch07.xhtml#ch07lev1sec24">Section 7.2</a>.</p>&#13;
<pre>R&gt; qplot(foo,bar,main="My lovely qplot",xlab="x axis label",ylab="location y")</pre>&#13;
<p class="indent">This produces the right panel of <a href="ch07.xhtml#ch7fig8">Figure 7-8</a>.</p>&#13;
<p class="indent">Underneath this basic similarity in syntax, though, there is a fundamental difference between how <code>ggplot2</code> and base R graphics create plots. Constructing plots using the built-in graphics tools is essentially a live, step-by-step process. This was particularly noticeable in <a href="ch07.xhtml#ch07lev1sec25">Section 7.3</a>, where you treated the graphics device as an active canvas where you added points, lines, and other features one by one. By contrast, <code>ggplot2</code> plots are stored as objects, which means they have an underlying, static representation until you <em>change</em> the object—what you essentially visualize with <code>qplot</code> is the <code>print</code>ed object at any given time. To highlight this, enter the following code:</p>&#13;
<pre>R&gt; baz &lt;- plot(foo,bar)<br/>R&gt; baz<br/>NULL<br/>R&gt; qux &lt;- qplot(foo,bar)<br/>R&gt; qux</pre>&#13;
<p class="indent">The first assignment uses the built-in <code>plot</code> function. When you run that line of code, the plot in <a href="ch07.xhtml#ch7fig1">Figure 7-1</a> pops up. Since nothing is actually stored in the workspace, printing the supposed object <code>baz</code> yields the empty <code>NULL</code> value. On the other hand, it makes sense to store the <code>qplot</code> content (stored as the object <code>qux</code> here). This time, when you perform the assignment, no plot is displayed. The graphic, which matches <a href="ch07.xhtml#ch7fig8">Figure 7-8</a>, is displayed only when you enter <code>qux</code> at the prompt, which invokes the <code>print</code> method for that object. This may seem like a minor point, but the fact that you can save a plot this way before displaying it opens up new ways to modify or enhance plots before displaying them (as you will see in a moment), and it can be a distinct advantage over base R graphics.</p>&#13;
<h4 class="h4" id="ch07lev2sec69"><strong><em>7.4.2 Setting Appearance Constants with Geoms</em></strong></h4>&#13;
<p class="noindent">To add and customize points and lines in a <code>ggplot2</code> graphic, you alter the object itself, rather than using a long list of arguments or secondary functions executed separately (such as <code>points</code> or <code>lines</code>). You can modify the object using <code>ggplot2</code>’s convenient suite of <em>geometric modifiers</em>, known as <em>geoms</em>. Let’s say you want to connect the five points in <code>foo</code> and <code>bar</code> with a line, just as you did in <a href="ch07.xhtml#ch07lev1sec23">Section 7.1</a>. You can first create a blank plot object and then use geometric modifiers on it like this:</p>&#13;
<pre>R&gt; qplot(foo,bar,geom="blank") + geom_point() + geom_line()</pre>&#13;
<p class="indent">The resulting plot is shown on the left of <a href="ch07.xhtml#ch7fig9">Figure 7-9</a>. In the first call to <code>qplot</code>, you create an empty plot object by setting the initial geometric <span epub:type="pagebreak" id="page_142"/>modifier as <code>geom="blank"</code> (if you displayed this plot, you would just see the gray background and the axes). Then you layer on the two other geoms as <code>geom_point()</code> and <code>geom_line()</code>. As indicated by the parentheses, these geoms are functions that result in their own specialized objects. You can add geoms to the <code>qplot</code> object using the <code>+</code> operator. Here, you haven’t supplied any arguments to either geom, which means they’ll operate on the same data originally supplied to <code>qplot</code> (<code>foo</code> and <code>bar</code>) and they’ll stick to the default settings for any other features, such as color or point/line type. You can control those features by specifying optional arguments, as shown here:</p>&#13;
<pre>R&gt; qplot(foo,bar,geom="blank") + geom_point(size=3,shape=6,color="blue") +<br/>      geom_line(color="red",linetype=2)</pre>&#13;
<div class="image"><img src="../images/f07-09.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch7fig9"/>Figure 7-9: Two simple plots that use geometric modifiers to alter the appearance of a</em> <code>qplot</code> <em>object. Left: Adding points and lines using default settings. Right: Using the geoms to affect point character, size, and color, and line type and color.</em></p>&#13;
<p class="indent">Note that some of <code>ggplot2</code>’s argument names used here for things such as point characters and size (<code>shape</code> and <code>size</code>) are different from the base R graphics arguments (<code>pch</code> and <code>cex</code>). But <code>ggplot2</code> is actually compatible with many of the common graphical parameters used in R’s standard <code>plot</code> function, so you can use those arguments here too if you prefer. For instance, setting <code>cex=3</code> and <code>pch=6</code> in <code>geom_point</code> in this example would result in the same image.</p>&#13;
<p class="indent">The object-oriented nature of <code>ggplot2</code> graphics means tweaking a plot or experimenting with different visual features no longer requires you to rerun every plotting command each time you change something. This is facilitated by geoms. Say you like the line type used on the right side of <a href="ch07.xhtml#ch7fig9">Figure 7-9</a> but want a different point character. To experiment, you could first store the <code>qplot</code> object you created earlier and then use <code>geom_point</code> with that object to try different point styles.</p>&#13;
<pre><span epub:type="pagebreak" id="page_143"/>R&gt; myqplot &lt;- qplot(foo,bar,geom="blank") + geom_line(color="red",linetype=2)<br/>R&gt; myqplot + geom_point(size=3,shape=3,color="blue")<br/>R&gt; myqplot + geom_point(size=3,shape=7,color="blue")</pre>&#13;
<p class="indent">The first line stores the original plot in <code>myqplot</code>, and the next lines call <code>myqplot</code> with different point shapes. The second and third lines produce the graphics on the left and right of <a href="ch07.xhtml#ch7fig10">Figure 7-10</a>, respectively.</p>&#13;
<div class="image"><img src="../images/f07-10.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch7fig10"/>Figure 7-10: Using the object-oriented nature of</em> <code>ggplot2</code> <em>graphics to experiment with different point characters</em></p>&#13;
<p class="indent">There are a number of geometric modifiers that can be called using a function name beginning with <code>geom_</code> in <code>ggplot2</code>. To obtain a list, simply ensure the package is loaded and enter <code>??"geom_"</code> as a help search at the prompt.</p>&#13;
<h4 class="h4" id="ch07lev2sec70"><strong><em>7.4.3 Aesthetic Mapping with Geoms</em></strong></h4>&#13;
<p class="noindent">Geoms and <code>ggplot2</code> also provide efficient, automated ways to apply different styles to different subsets of a plot. If you split a data set into categories using a factor object, <code>ggplot2</code> can automatically apply particular styles to different categories. In <code>ggplot2</code>’s documentation, the factor that holds these categories is called a <em>variable</em>, which <code>ggplot2</code> can <em>map</em> to <em>aesthetic</em> values. This gets rid of much of the effort that goes into isolating subsets of data and plotting them separately using base R graphics (as you did in <a href="ch07.xhtml#ch07lev1sec25">Section 7.3</a>).</p>&#13;
<p class="indent">All this is best illustrated with an example. Let’s return to the 20 observations you manually plotted, step-by-step, to produce the elaborate plot in <a href="ch07.xhtml#ch7fig6">Figure 7-6</a>.</p>&#13;
<pre>R&gt; x &lt;- 1:20<br/>R&gt; y &lt;- c(-1.49,3.37,2.59,-2.78,-3.94,-0.92,6.43,8.51,3.41,-8.23,<br/>       -12.01,-6.58,2.87,14.12,9.63,-4.58,-14.78,-11.67,1.17,15.62)</pre>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_144"/>In <a href="ch07.xhtml#ch07lev1sec25">Section 7.3</a>, you defined several categories that classified each observation as either “standard,” “sweet,” “too big,” or “too small” based on their <code>x</code> and <code>y</code> values. Using those same classification rules, let’s explicitly define a factor to correspond to <code>x</code> and <code>y</code>.</p>&#13;
<pre>R&gt; ptype &lt;- rep(NA,length(x=x))<br/>R&gt; ptype[y&gt;=5] &lt;- "too_big"<br/>R&gt; ptype[y&lt;=-5] &lt;- "too_small"<br/>R&gt; ptype[(x&gt;=5&amp;x&lt;=15)&amp;(y&gt;-5&amp;y&lt;5)] &lt;- "sweet"<br/>R&gt; ptype[(x&lt;5|x&gt;15)&amp;(y&gt;-5&amp;y&lt;5)] &lt;- "standard"<br/>R&gt; ptype &lt;- factor(x=ptype)<br/>R&gt; ptype<br/> [1] standard  standard  standard  standard  sweet     sweet     too_big<br/> [8] too_big   sweet     too_small too_small too_small sweet     too_big<br/>[15] too_big   standard  too_small too_small standard  too_big<br/>Levels: standard sweet too_big too_small</pre>&#13;
<p class="indent">Now you have a factor with 20 values sorted into four levels. You’ll use this factor to tell <code>qplot</code> how to map your aesthetics. Here’s a simple way to do that:</p>&#13;
<pre>R&gt; qplot(x,y,color=ptype,shape=ptype)</pre>&#13;
<p class="indent">This single line of code produces the left plot in <a href="ch07.xhtml#ch7fig11">Figure 7-11</a>, which separates the four categories by color and point character and even provides a legend. This was all done by the aesthetic mapping in the call to <code>qplot</code>, where you set <code>color</code> and <code>shape</code> to be mapped to the <code>ptype</code> variable.</p>&#13;
<div class="image"><img src="../images/f07-11.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch7fig11"/>Figure 7-11: Demonstration of aesthetic mapping using</em> <code>qplot</code> <em>and geoms in</em> <code>ggplot2</code><em>. Left: The initial call to</em> <code>qplot</code><em>, which maps point character and color using</em> <code>ptype</code><em>. Right: Augmenting the left plot using various geoms to override the default mappings.</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_145"/>Now, let’s replot these data using the same <code>qplot</code> object along with a suite of geom modifications in order to get something more like <a href="ch07.xhtml#ch7fig6">Figure 7-6</a>. Executing the following produces the plot on the right of <a href="ch07.xhtml#ch7fig11">Figure 7-11</a>:</p>&#13;
<pre>R&gt; qplot(x,y,color=ptype,shape=ptype) + geom_point(size=4) +<br/>      geom_line(mapping=aes(group=1),color="black",lty=2) +<br/>      geom_hline(mapping=aes(yintercept=c(-5,5)),color="red") +<br/>      geom_segment(mapping=aes(x=5,y=-5,xend=5,yend=5),color="red",lty=3) +<br/>      geom_segment(mapping=aes(x=15,y=-5,xend=15,yend=5),color="red",lty=3)</pre>&#13;
<p class="indent">In the first line, you add <code>geom_point(size=4)</code> to increase the size of all the points on the graph. In the lines that follow, you add a line connecting all the points, plus horizontal and vertical lines to mark out the sweet spot. For those last four lines, you have to use <code>aes</code> to set alternate aesthetic mappings for the point categories. Let’s look a little closer at what’s going on there.</p>&#13;
<p class="indent">Since you used <code>ptype</code> for aesthetic mapping in the initial call to <code>qplot</code>, by default all other geoms will be mapped to each category in the same way, <em>unless</em> you override that default mapping with <code>aes</code>. For example, when you call <code>geom_line</code> to connect all the points, if you were to stick with the default mapping to <code>ptype</code> instead of including <code>mapping=aes(group=1)</code>, this geom would draw lines connecting points within each category. You would see four separate dashed lines—one connecting all “standard” points, another connecting all “sweet” points, and so on. But that’s not what you want here; you want a line that connects all of the points, from left to right. So, you tell <code>geom_line</code> to treat all the observations as one group by entering <code>aes(group=1)</code>.</p>&#13;
<p class="indent">After that, you use the <code>geom_hline</code> function to draw horizontal lines at <em>y</em> = −5 and <em>y</em> = 5 using its <code>yintercept</code> argument, again passed to <code>aes</code> to redefine that geom’s <code>mapping</code>. In this case, you need to redefine the mapping to operate on the vector <code>c(-5,5)</code>, rather than using the observed data in <code>x</code> and <code>y</code>. Similarly, you end by using <code>geom_segment</code> to draw the two vertical dotted line segments. <code>geom_segment</code> operates much like <code>segments</code>—you redefine the mapping based on a “from” coordinate (arguments <code>x</code> and <code>y</code>) and a “to” coordinate (<code>xend</code> and <code>yend</code> here). Since the first geom, <code>geom_point(size=4)</code>, sets a constant enlarged size for every plotted point, it doesn’t matter how the geom is mapped because it simply makes a uniform change to each point.</p>&#13;
<p class="indent">Plotting in R, from base graphics to contributed packages like <code>ggplot2</code>, stays true to the nature of the language. The element-wise matching allows you to create intricate plots with a handful of straightforward and intuitive functions. Once you display a plot, you can save it to the hard drive by selecting the graphics device and choosing File → Save. However, you can also write plots to a file directly, as you’ll see momentarily in <a href="ch08.xhtml#ch08lev1sec29">Section 8.3</a>.</p>&#13;
<p class="indent">The graphical capabilities explored in this section are merely the tip of the iceberg, and you’ll continue to use data visualizations from this point onward.</p>&#13;
<div class="ex">&#13;
<p class="ext"><span epub:type="pagebreak" id="page_146"/><a id="ch7exc2"/><strong>Exercise 7.2</strong></p>&#13;
<p class="noindentz">In <a href="ch07.xhtml#ch7exc1">Exercise 7.1</a> (b), you used base R graphics to plot some weight and height data, distinguishing males and females using different points or colors. Repeat this task using <code>ggplot2</code>.</p>&#13;
</div>&#13;
<h5 class="h5" id="ch07lev3sec17"><strong>Important Code in This Chapter</strong></h5>&#13;
<table class="topbot">&#13;
<thead>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Function/operator</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Brief description</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>First occurrence</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>plot</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Create/display base R plot</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev1sec23">Section 7.1</a>, <a href="ch07.xhtml#page_128">p. 128</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>type</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Set plot type</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev2sec63">Section 7.2.1</a>, <a href="ch07.xhtml#page_130">p. 130</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>main</code>, <code>xlab</code>, <code>ylab</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Set axis labels</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev2sec64">Section 7.2.2</a>, <a href="ch07.xhtml#page_130">p. 130</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>col</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Set point/line color</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev2sec65">Section 7.2.3</a>, <a href="ch07.xhtml#page_131">p. 131</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>pch</code>, <code>cex</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Set point type/size</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev2sec66">Section 7.2.4</a>, <a href="ch07.xhtml#page_133">p. 133</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>lty</code>, <code>lwd</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Set line type/width</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev2sec66">Section 7.2.4</a>, <a href="ch07.xhtml#page_133">p. 133</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>xlim</code>, <code>ylim</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Set plot region limits</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev2sec67">Section 7.2.5</a>, <a href="ch07.xhtml#page_134">p. 134</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>abline</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Add vertical/horizontal line</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev1sec25">Section 7.3</a>, <a href="ch07.xhtml#page_137">p. 137</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>segments</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Add specific line segments</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev1sec25">Section 7.3</a>, <a href="ch07.xhtml#page_137">p. 137</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>points</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Add points</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev1sec25">Section 7.3</a>, <a href="ch07.xhtml#page_137">p. 137</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>lines</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Add lines following coords</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev1sec25">Section 7.3</a>, <a href="ch07.xhtml#page_138">p. 138</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>arrows</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Add arrows</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev1sec25">Section 7.3</a>, <a href="ch07.xhtml#page_138">p. 138</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>text</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Add text</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev1sec25">Section 7.3</a>, <a href="ch07.xhtml#page_138">p. 138</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>legend</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Add/control legend</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev1sec25">Section 7.3</a>, <a href="ch07.xhtml#page_138">p. 138</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>qplot</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Create <code>ggplot2</code> “quick plot”</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev2sec68">Section 7.4.1</a>, <a href="ch07.xhtml#page_140">p. 140</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>geom_point</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Add points geom</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev2sec69">Section 7.4.2</a>, <a href="ch07.xhtml#page_141">p. 141</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>geom_line</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Add lines geom</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev2sec69">Section 7.4.2</a>, <a href="ch07.xhtml#page_141">p. 141</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>size</code>, <code>shape</code>, <code>color</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Set geom constants</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev2sec69">Section 7.4.2</a>, <a href="ch07.xhtml#page_142">p. 142</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>linetype</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Set geom line type</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev2sec69">Section 7.4.2</a>, <a href="ch07.xhtml#page_142">p. 142</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>mapping</code>, <code>aes</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Geom aesthetic mapping</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev2sec70">Section 7.4.3</a>, <a href="ch07.xhtml#page_145">p. 145</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>geom_hline</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Add horizontal lines geom</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev2sec70">Section 7.4.3</a>, <a href="ch07.xhtml#page_145">p. 145</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>geom_segment</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Add line segments geom</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch07.xhtml#ch07lev2sec70">Section 7.4.3</a>, <a href="ch07.xhtml#page_145">p. 145</a></p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
</body></html>