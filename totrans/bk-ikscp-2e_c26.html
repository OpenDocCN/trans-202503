<html xmlns="http://www.w3.org/1999/xhtml" xmlns:dk="http://www.kirsanov.com" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:svg="http://www.w3.org/2000/svg" epub:prefix="index: http://www.index.com/" lang="en" xml:lang="en">
	<head>
		<meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>
		<title>Chapter 26: Tutorial: Artwork for a Game</title>
		<link href="NSTemplate_v1_inkbook.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:53262340-c02e-40d5-9273-c34656cedc88" name="Adept.expected.resource"/>
	</head>
	<body>
		<section><a id="ch26"/>
		<header>
				<h1 class="chapterTitle"><span class="ChapterNumber"><span epub:type="pagebreak" id="Page_465" title="465"/>26</span><br/><span class="ChapterTitle">Tutorial: Artwork for a Game</span></h1>
			</header>
			<p class="ChapterIntro"><a id="465"/>Games for all kinds of hardware—desktops, gaming consoles, mobile devices—are a huge, always-growing, and intensely graphics-hungry industry.
Much of game graphics these days is in 3D, but plenty of work for traditional 2D graphic editors like Inkscape remains—if only
as creators of graphic assets for 3D worlds.
In this tutorial, I show how Inkscape can be a game developer's Swiss Army knife.</p>
			<p>This tutorial's examples are from two games that I, with the help of my family, created for Android mobile devices. They are simple 2D games with arcade-like gameplay
based on physical simulation (using the Box2D library).  Creating a game is a complex process that includes design, programming, artwork creation, and music, followed by seemingly endless testing, tweaking, and bugfixing—not to mention marketing and promotion. We used many different tools and resources to create our games. Still, I would rank Inkscape at the top of the list, right  after the Android Studio IDE by Google. This tutorial is a collection of several miniprojects that demonstrate the use of Inkscape for various game development tasks.</p>
			<a id="section26.1"/><h2>
				26.1 <a id="466"/><span epub:type="pagebreak" id="Page_466" title="466"/>BotP: Ice Rink</h2>
			<p>
				One of the games we developed, called <em>Battle of the Pucks</em> (<em>BotP</em>, available at <a href="http://kirsanov.com/battle-of-the-pucks/">http://kirsanov.com/battle-of-the-pucks/</a>), features two teams of pucks on an ice rink.
Players propel their pucks with a finger swipe, aiming to drive their opponent's pucks into the void beyond the edge of the rink.</p>
			<p>
				Creating the image for the ice rink is a challenge because it must give an impression of a real ice with its dents, scratches, and skate traces.<a href="#fig26-1">Figure 26-1</a> shows how we did it using multiple semitransparent paths with <span class="ui">Roughen</span> path effect. The final image is exported as PNG and loaded
into the game as a graphic asset.</p>
			<a id="fig26-1"/><figure>
				<img alt="" src="tuts/t07-botp-board.svg.png"/>
				<figcaption>
					<p>Figure 26-1: Making a realistic ice surface</p>
				</figcaption>
			</figure>
			<a id="section26.2"/>
			<h2>26.2 BotP: Inkscape as a Level Editor</h2>
			<p><em>Battle of the Pucks</em> has multiple levels with a varying initial placement of the pucks (and, on advanced levels, various obstacles) on the game board.
I could define those levels in code, but with more than 90 levels, doing so would be tedious work. Generally, when you have visual information,
you should use a visual tool to work with it, even if that involves some additional investment up front. That's how we came to the
idea of using Inkscape as a level editor for our game.</p>
			<p>
				Any game with levels needs some kind of a level editor, and for complex game projects, it may be a custom piece of software developed in parallel with the game itself.
For relatively simple games, such as <em>BotP</em>, it makes a perfect sense to use Inkscape for this task. Levels are drawn as images, each on its own layer, and saved as SVG.
The game code loads and parses the SVG file, finds the current layer element in it, and reads its child elements to place the pucks and obstacles at the start
of each level.</p>
			<p>
				As you might expect, this attractively simple idea was not exactly as straightforward to implement. The Java library we used for the game had an XML parser, but it had
nothing to deal with SVG-specific data such as transforms (<a href="b01.xhtml#sectionA.7">A.7</a>). As a result, we had to observe certain limitations when creating and editing the
levels.svg file for the game.</p>
			<a id="section26.2.1"/><h3>
				26.2.1 <a id="467"/><span epub:type="pagebreak" id="Page_467" title="467"/>Pucks</h3>
			<p>
				Pucks in our game can be of different sizes, but all of them are round, so in levels.svg, they are 
represented by <code>circle</code> elements created by the Ellipse tool (<a href="c11.xhtml#section11.4">11.4</a>). We had to be careful to keep circles circles.
If you accidentally squeeze or stretch
a circle, Inkscape turns it into an <code>ellipse</code> element in SVG; if you touch the round arc/segment handles of the shape (<a href="c11.xhtml#section11.4.2">11.4.2</a>), it becomes a path.
Both of these changes would break our game's parsing code, which recognizes only a <code>circle</code> element and uses its <code>cx</code> and <code>cy</code> attributes to place the puck
and the <code>r</code> attribute to determine its size (and mass). The white or black color of the circle (parsed out of its <code>style</code> attribute)
determines to which of the two commands this puck belongs (<a href="#fig26-2">Figure 26-2</a>).</p>
			<a id="fig26-2"/><figure>
				<img alt="" src="tuts/t07-botp-hourglass.svg.png"/>
				<figcaption>
					<p>
						Figure 26-2: A <em>BotP</em> level called "The Hourglass": the two puck armies are ready to battle.</p>
				</figcaption>
			</figure>
			<p>
				When the puck circle is moved around in Inkscape, it is important to ensure that the circle element doesn't get the <code>transform</code> attribute. In <span class="ui">Preferences</span>,
on the <span class="ui">Behavior<span class="MenuArrow"> ▶ </span>Transforms</span> page, the <span class="ui">Store Transformations</span> must be set to <span class="ui">Optimized</span>. Now, when you move the circle, Inkscape updates its<code>cx</code> and <code>cy</code> attributes without creating a <code>transform</code> attribute. This approach has nonobvious limitations, though:
when you rotate or flip a circle, it still gets a <code>transform</code> even with optimized transformations. We had learned we needed to arrange our puck armies without
flipping but only by moving or scaling.</p>
			<a id="section26.2.2"/><h3>26.2.2 Obstacles</h3>
			<p>
				Advanced game levels contain obstacles—walls that reflect the pucks—making the gameplay more interesting and often quite challenging. In levels.svg, obstacles
are represented as <code>path</code> elements with a red stroke color. The game code can parse the path data in such an element and re-create it as an object in the game, but it has
a limitation: it can only create obstacles out of linear fragments. To create curvilinear obstacles, we had to approximate them with short linear segments, using the<span class="ui">Extensions<span class="MenuArrow"> ▶ </span>Modify Path<span class="MenuArrow"> ▶ </span>Flatten Beziers</span> extension, as <a href="#fig26-3">Figure 26-3</a> demonstrates.</p>
			<a id="fig26-3"/><figure>
				<img alt="" src="tuts/t07-botp-bowl.svg.png"/>
				<figcaption>
					<p>
						Figure 26-3: A <em>BotP</em> level called "Bowls of Cereal" where four pucks on each side have their backs against the bowl-shaped walls</p>
				</figcaption>
			</figure>
			<p><a id="468"/><span epub:type="pagebreak" id="Page_468" title="468"/><a href="#fig26-4">Figure 26-4</a> shows how this level is rendered.</p>
			<a id="fig26-4"/>
			<figure>
				<img alt="" src="tuts/t07-botp-bowl-game.svg.png"/>
				<figcaption>
					<p>Figure 26-4: The "Bowls of Cereal" level in the actual game</p>
				</figcaption>
			</figure>
			<p>
				When the game code reads the SVG file, it extracts the coordinates of the path's points from the <code>d</code> attribute. That data consists of a sequence of one-letter commands (such as <code>l</code> for linear segment or <code>c</code> for a Bézier curve) followed by their numeric coordinates. Normally, the coordinates in path data are relative; each pair of coordinates provides the displacement relative to the previous point. In our game code, we found it was much simpler to deal with absolute coordinates. For this, in the <span class="ui">Input/Output<span class="MenuArrow"> ▶ </span>SVG Output</span> page of the <span class="ui">Preferences</span> dialog, we switched <span class="ui">path string format</span> to <span class="ui">Absolute</span>. The absolute variants of path commands use uppercase letters, so after the change you will see <code>L</code>, <code>C</code>, and so on in a <code>d</code> attribute of a path.</p>
				<a id="section26.2.3"/>
				<h3>
				26.2.3 <a id="469"/><span epub:type="pagebreak" id="Page_469" title="469"/>Shrinking the File</h3>
			<p>Mobile apps are very sensitive to file size, so before including levels.svg into the game's assets, we tried to reduce its size as much as possible. Inkscape offers a couple
out-of-the-box ways to do this.</p>
			<ul>
				<li><span class="ui">Input/Output<span class="MenuArrow"> ▶ </span></span><span class="ui">SVG Output</span>
page of the <span class="ui">Preferences</span> dialog has a number of options that make the saved SVG files smaller: inline attributes (that is, all attributes of each element are placed on the same line),
number of indentation spaces, and the precision (number of digits) of numeric values. This affects all SVG files saved from Inkscape.</li>
				<li>
					The <span class="ui">Optimized SVG</span> output file type that you can select in <span class="ui">Save</span>, <span class="ui">Save As</span>, or <span class="ui">Save a Copy</span> dialogs can perform some additional optimizations. It can shrink the numeric data
by rounding values to a given number of digits, shorten color values, convert CSS properties to XML attributes, remove unneeded grouping, remove comments and metadata, remove unused IDs, embed raster images,
and pretty-print SVG.</li>
			</ul>
			<p>
				For our purposes, however,  this was not quite enough. We wrote our own Python script that 
removes comments, unneeded namespaces, attributes, and style properties from the SVG file.
This script also alerts us if, despite all precautions, some circles have a <code>transform</code> attribute
or some path data (<code>d</code> attribute) uses lowercase commands (relative) instead of uppercase (absolute).</p>
			<a id="section26.3"/><h2>26.3 BotP: The Pucks</h2>
			<p>
				The pucks in <em>BotP</em> can have different colors, depending on the team to which they belong and the chosen color theme. Therefore, each puck object in the game is composed of three layered images:
a ring-shaped bottom shadow, then a colored circle, and then a semitransparent overlay that adds a circular ridge and some light color accents and scratches for realism (<a href="#fig26-5">Figure 26-5</a>).</p>
			<a id="fig26-5"/><figure>
				<img alt="" src="tuts/t07-botp-puck.svg.png"/>
				<figcaption>
					<p>Figure 26-5: Anatomy of a puck and how it looks in the game</p>
				</figcaption>
			</figure>
			<p>Interestingly,
although the top ridge has a presumed direction of lighting (from the top left), in the game, the pucks—including the overlays—rotate freely, but this rotation never produces an impression of miscast shadows.</p>
			<a id="section26.4"/><h2>
				26.4 <a id="470"/><span epub:type="pagebreak" id="Page_470" title="470"/>BotP: Splash Animation</h2>
			<p>
				As an intentional contrast to the realistic style of the ice rink and pucks, the splash animation (which plays while the game is loading) and the main menu
feature freehand, untidy, jittery animation. The secret to producing such animation is simple: draw every frame anew from scratch, including the parts that do not really move from
frame to frame. We used the Calligraphic pen (<a href="c14.xhtml#section14.2">14.2</a>) with <span class="ui">Tremor</span> and/or <span class="ui">Wiggle</span> and tried not to be too tidy or stick too closely to the guidelines.</p>
			<p><a href="#fig26-6">Figure 26-6</a> shows the 10 frames of <em>BotP</em>'s splash animation, featuring an anthropomorphized puck streaking across the ice in a frenzy. While each of these images on its own seems
just badly drawn and random, when shown in quick succession, they merge into a lifelike and even relatable character.</p>
			<a id="fig26-6"/><figure>
				<img alt="" src="tuts/t07-botp-splash.svg.png"/>
				<figcaption>
					<p>Figure 26-6: The frames of the animated splash image</p>
				</figcaption>
			</figure>
			<a id="section26.5"/>
			<h2>26.5 Batonic: An Iconic Character</h2>
			<p>
				Another game we created is called <em>Batonic</em> (<a href="http://kirsanov.com/batonic/">http://kirsanov.com/batonic/</a>).
What's interesting about this game is the title character’s design, which is used as the game's icon as well
as on the cover of this book.</p>
			<p><a href="#fig26-7">Figure 26-7</a> shows how it looks when sliced into its component layered objects.
We applied the <span class="ui">Envelope Deformation</span> path effect to a path of rectangular stripes to create the striped overalls
and then clipped the result by a copy of the blue garment path.</p>
			<a id="fig26-7"/><figure>
				<img alt="" src="tuts/t07-batonic-icon.svg.png"/>
				<figcaption>
					<p>Figure 26-7: Layers of Mr Bubbel</p>
				</figcaption>
			</figure>
			<p>
				In the game itself, this amusing gentleman, named Mr Bubbel, spawns a whole army of Bubbels that are falling out of the sky upon a circus baton that you balance on the tip of your finger. 
Here, each character's image is separated into body, eyes, arms, and legs, which are animated to make the Bubbels come alive, as shown in <a href="#fig26-8">Figure 26-8</a>.</p>
			<a id="fig26-8"/><figure>
				<img alt="" src="tuts/t07-batonic-bubbles.png"/>
				<figcaption>
					<p>
						Figure 26-8: <a id="471"/><span epub:type="pagebreak" id="Page_471" title="471"/><em>Batonic</em>: Bubbels attack your baton.</p>
				</figcaption>
			</figure>
		</section>
	</body>
</html>