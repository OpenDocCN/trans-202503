<html><head></head><body>
<h2 class="h2" id="ch02"><a id="page_7"/><strong>2</strong></h2>
<p class="h2a"><strong>MEDIA QUERIES</strong></p>
<div class="image"><img alt="Image" src="graphics/common-01.jpg"/></div>
<p class="noindentt">Back when the World Wide Web was something you only accessed via a browser on your desktop or laptop, writing CSS was fairly straightforward. Although you had to consider cross-browser and cross-platform issues, at least you knew with reasonable certainty that everyone was using fundamentally similar devices to view your website. Over the last few years, however, we’ve seen an explosion of new devices for accessing the Web—from game consoles to mobile devices such as smartphones and tablets. Presenting your content to everybody in the same way no longer makes sense when they could be viewing your website on a widescreen desktop monitor or a narrow handheld screen.</p>
<p class="indent">CSS has had a way to serve different styles to different media types for quite some time, using the <code>media</code> attribute of the <code>link</code> element:</p>
<pre class="programs">&lt;link href="style.css" rel="stylesheet" media="screen"&gt;</pre>
<p class="indent"><a id="page_8"/>But this approach has a number of flaws—not least of which is that using it is like wielding a pretty blunt instrument when the screen in question can be between 3.5 inches and 32 inches in size. The list of types is too broad, and many aren’t supported by the devices they’re aimed at—for example, I don’t know of a single web-enabled television that responds to the <code>tv</code> type. Unsurprisingly, given this, the W3C has begun to deprecate the use of media types.</p>
<p class="indent">The CSS3 solution to this problem is to use <em>media queries</em>, defined in the Media Queries Module (<em><a href="http://www.w3.org/TR/css3-mediaqueries/">http://www.w3.org/TR/css3-mediaqueries/</a></em>). These queries extend the media types by providing a query syntax that lets you serve far more specific styles to your user’s device, giving users a tailored experience. This description may sound quite dry, but this feature is actually one of the most revolutionary in the entire CSS3 specification. Media queries give you the freedom to make websites that are truly device- independent, offering your users the best possible experience no matter how they choose to visit your site.</p>
<p class="indent">The Media Queries Module has W3C Recommendation status, so it is considered a standard. The module is already well implemented in all major browsers, including Internet Explorer from version 9.</p>
<h3 class="h3" id="ch02leve1sec13"><strong>The Advantages of Media Queries</strong></h3>
<p class="noindent">As a quick demonstration of the power and flexibility of media queries, I’ll show an example of how websites can be optimized for mobile browsers without requiring a great deal of extra development.</p>
<p class="indent">People visiting your site on a mobile device may well struggle to use it: The text may appear too small, and zooming in means a lot of scrolling to find navigational elements; those navigational elements may involve drop-down functionality that is triggered by hovering over them, an action that often doesn’t exist on mobile devices; large images may take a long time to download over a weak data connection and use a substantial portion of a user’s monthly bandwidth allowance. Some sites plan for this by providing mobile-friendly versions, but these generally involve a lot of development work. A subdomain has to be set up with style sheets and HTML templates that differ from the parent site; images have to be resized to better fit small screens; and a script has to be created to detect whether a mobile browser is being used and to redirect to the mobile site accordingly. This approach can cause problems: Your script has to be kept up to date with all mobile browser versions, and maintenance often involves duplication to keep both mobile and desktop versions in sync.</p>
<p class="indent">Media queries address many of these issues. For a start, they detect devices based on their attributes, so no browser-sniffing scripts are required. They allow you to target style sheets directly for a device’s capabilities, so if a device with a small screen is detected, CSS rules will be tailored to that screen size, removing extraneous elements, serving smaller images, and making text clearer.</p>
<p class="indent"><a id="page_9"/>For example, take a look at the technology website The Next Web (<em><a href="http://thenextweb.com/">http://thenextweb.com/</a></em>), as shown in <a href="ch02.html#ch02fig1">Figure 2-1</a>.</p>
<div class="image"><img alt="Image" src="graphics/f02-01.jpg"/></div>
<p class="figuret"><a id="ch02fig1"/><em>Figure 2-1: The Next Web website viewed in a desktop browser and a mobile browser (inset)</em></p>
<p class="indent">When viewed in a desktop browser, the site features a long horizontal top navigation, related content on the left of the page, and main content laid out in a grid. Through the power of media queries, when you view the same site in a narrower browser—such as an iPhone would use—the navigation is more compact with sharing options hidden away, the related content has been moved off screen, and the main content on the page is moved into a single column, which is ideal for scrolling down.</p>
<p class="indent">Of course, the Web now appears on more than just desktop and smartphone devices, and we really need to be working toward the common goal of websites optimized for any device. See “Responsive Web Design” on <a href="ch02.html#page_10">page 10</a> for more on this.</p>
<p class="indent">And if you want to see what other people have been doing with media queries, you’ll find a great gallery online at <em><a href="http://www.mediaqueri.es/">http://www.mediaqueri.es/</a></em>, which showcases some of the better examples of what’s possible.</p>
<h3 class="h3" id="ch02leve1sec14"><strong>Syntax</strong></h3>
<p class="noindent">A media query sets a parameter (or series of parameters) that enables associated style rules if the device used to view the page has properties that match that parameter. You can use media queries in three ways, all of which match the different ways that CSS can be applied to a document. The first is to call an external style sheet using the <code>link</code> element:</p>
<pre class="programs">&lt;link href="<span class="codeitalic">file</span>" rel="stylesheet" media="<span class="codeitalic">logic media</span> and (<span class="codeitalic">expression</span>)"&gt;</pre>
<div class="sidebar">
<p class="sidebart"><strong><a id="page_10"/>RESPONSIVE WEB DESIGN</strong></p>
<p class="noindent">In 2010, Ethan Marcotte wrote an article titled “Responsive Web Design” (<em><a href="http://www.alistapart.com/articles/responsive-web-design/">http://www.alistapart.com/articles/responsive-web-design/</a></em>), in which he cleverly consolidated contemporary thinking on making websites that adapt to the devices used to view them through the power of media queries. Here is what he said:</p>
<p class="bq1">Now more than ever, we’re designing work meant to be viewed along a gradient of different experiences. Responsive web design offers us a way forward, finally allowing us to “design for the ebb and flow of things.”</p>
<p class="indent">Since then, responsive design has fast become the norm; the majority of developers think this way, and more sites every year are launched or relaunched using responsive design methods. This sort of design is not without its challenges—designing fluid, responsive sites especially has had to be reconsidered, as most design tools are simply not up to the job—but we can safely say we’re on the path to creating a Web that can be consumed by anyone, anywhere, in a way that’s been carefully considered to work with any device.</p>
</div>
<p class="indentt">The second is to call an external style sheet using the <code>@import</code> directive:</p>
<pre class="programs">@import url('<span class="codeitalic">file</span>') <span class="codeitalic">logic media</span> and (<span class="codeitalic">expression</span>);</pre>
<p class="indent">The third is to use media queries in an embedded style element or in the style sheet itself with the extended <code>@media</code> rule:</p>
<pre class="programs">@media <span class="codeitalic">logic media</span> and (<span class="codeitalic">expression</span>) { <span class="codeitalic">rules</span> }</pre>
<p class="indent">This method is the one I’ll use throughout the rest of this chapter, as it’s clearer for demonstration purposes. Which method you use largely depends on your own preference and the demands of your existing stylesheet structure.</p>
<p class="indent">Now that I’ve introduced the declaration methods, let’s explore the syntax. You should already be familiar with the <code>media</code> attribute—it declares the media types that the styles are applied to, just as in the HTML <code>link</code> tag:</p>
<pre class="programs">&lt;link href="style.css" rel="stylesheet" <span class="codestrong">media="screen"</span>&gt;</pre>
<p class="indent">The most common media type values are <code>screen</code> and <code>print</code>, and as with the current syntax, you can use a comma-separated list to choose multiple media queries (although that’s becoming less necessary as the other media types become deprecated). If omitted, the media type defaults to <code>all</code>, so <a id="page_11"/>if you’re writing rules that will apply to all media types you won’t need to specify them in the media query constructor; that being the case, these examples are functionally identical:</p>
<pre class="programs">@media all and (<span class="codeitalic">expression</span>) { <span class="codeitalic">rules</span> }<br/>@media (<span class="codeitalic">expression</span>) { <span class="codeitalic">rules</span> }</pre>
<p class="note"><strong><small>NOTE</small></strong><br/><em>To make the code examples in the rest of this book more concise, I’ll omit the media type where not essential.</em></p>
<p class="indent">The first new attribute for the <code>@media</code> rule is <code><em>logic</em></code>. This optional keyword can have the value of either <code>only</code> or <code>not</code>:</p>
<pre class="programs">@media only <span class="codeitalic">media</span> and (<span class="codeitalic">expression</span>) { <span class="codeitalic">rules</span> }<br/>@media not <span class="codeitalic">media</span> and (<span class="codeitalic">expression</span>) { <span class="codeitalic">rules</span> }</pre>
<p class="indent">The <code>only</code> value is mainly useful if you want to hide the rule from older browsers that don’t support the syntax; for browsers that do support it, <code>only</code> is effectively ignored. The <code>not</code> value is used to negate the query; you use <code>not</code> to apply the styles if the parameters you set are <em>not</em> met.</p>
<p class="indent">If you use <code><em>logic</em></code> or <code><em>media</em></code> in your query, you also need to use the <code>and</code> operator, as in the previous examples, to combine them with the required <code><em>expression</em></code> attribute. This attribute is used to set parameters that offer functionality beyond the media type. These parameters are known as <em>media features</em>, and they’re critical to the power of media queries. That being the case, let’s explore them in detail.</p>
<h3 class="h3" id="ch02leve1sec15"><strong>Media Features</strong></h3>
<p class="noindent"><em>Media features</em> are information about the device that’s being used to display the web page: its dimensions, resolution, and so on. This information is used to evaluate an <code><em>expression</em></code>, the result of which determines which style rules are applied. That <code><em>expression</em></code> could be, for example, “apply these styles only on devices that have a screen wider than 480 pixels” or “only on devices that are orientated horizontally.”</p>
<p class="indent">In media queries, most media feature expressions require that a value be supplied:</p>
<pre class="programs">@media (<span class="codeitalic">feature: value</span>) { <span class="codeitalic">rules</span> }</pre>
<p class="indent">This value is needed to construct the example expressions I just mentioned. In a few cases, however, you can leave out the value and just test the existence of the media feature itself against the expression:</p>
<pre class="programs">@media (<span class="codeitalic">feature</span>) { <span class="codeitalic">rules</span> }</pre>
<p class="indent"><a id="page_12"/>Expressions will become clearer as I talk through the different media features and explain when values are required or optional.</p>
<p class="indent">With the syntax covered, let’s meet some of the more prominent media features. The ones I introduce next are the most applicable to color display screens used for accessing the Web and are the ones you’re most likely to use on a day-to-day basis. Other media features are available, but you’re more likely to use them for alternative devices such as TVs or fixed-grid terminals (if they’re supported on those devices at all).</p>
<h4 class="h4" id="ch02leve1sec16"><strong><em>Width and Height</em></strong></h4>
<p class="noindent">The <code>width</code> media feature describes the width of the rendering viewport of the specified media type, which, in practice, usually means the current width of the browser (including the scroll bar) for desktop operating systems. The basic syntax requires a length value:</p>
<pre class="programs">@media (width: 600px) { <span class="codeitalic">rules</span> }</pre>
<p class="indent">In this case, the rules are applied only to browsers that are set to be exactly 600px wide, which is probably far too specific. <code>width</code> also accepts one of two prefixes, <code>max-</code> and <code>min-</code>, which allows you to test for a minimum or maximum width:</p>
<pre class="programs">@media (max-width: 480px) { <span class="codeitalic">rules</span> }<br/>@media (min-width: 640px) { <span class="codeitalic">rules</span> }</pre>
<p class="indent">The first query applies the rules in browsers that are no wider than 480px, and the second in browsers that are at least 640px wide.</p>
<p class="indent">Let’s look at a practical example. Here, I’ll take advantage of browser window sizes by providing a decorative header for wider windows (some rules have been left out for clarity):</p>
<pre class="programs">@media (min-width: 400px) {<br/>    h1 { background: url('landscape.jpg'); }<br/>}</pre>
<p class="indent">This media query tests for browser viewports that are at least 400px wide and applies a background image to the <code>h1</code> element when that is the case.</p>
<p class="indent">If my browser window is at least 400px wide, I see the image; if I resize it to be narrower, only a text header is shown. You can see this example illustrated in <a href="ch02.html#ch02fig2">Figure 2-2</a>.</p>
<div class="image"><a id="page_13"/><img alt="Image" src="graphics/f02-02.jpg"/></div>
<p class="figuret"><a id="ch02fig2"/><em>Figure 2-2: Different style rules applied with the</em> <code><em>width</em></code> <em>media feature, displayed in a desktop browser and mobile (inset)</em></p>
<p class="indent">The <code>height</code> media feature works in the same way, except it targets browsers based on their height instead of width. The syntax is the same as <code>width</code> and also permits using <code>max-</code> and <code>min-</code> prefixes:</p>
<pre class="programs">@media (height: <span class="codeitalic">value</span>) { <span class="codeitalic">rules</span> }<br/>@media (max-height: <span class="codeitalic">value</span>) { <span class="codeitalic">rules</span> }<br/>@media (min-height: <span class="codeitalic">value</span>) { <span class="codeitalic">rules</span> }</pre>
<p class="indent">Because of the prevalence of vertical scrolling, however, <code>height</code> is used much less frequently than <code>width</code>.</p>
<h4 class="h4" id="ch02leve1sec17"><strong><em>Pixel Ratio</em></strong></h4>
<p class="noindent">In general, the CSS pixel unit (px) is a measurement of a single pixel on the computer screen—if your browser viewport is 1024 pixels wide and you give an element a width of 1024px, you expect it to fill the horizontal length of the viewport. Many new devices, however, especially smartphones and tablets, have super-high resolution screens, which would make an element with a width of 1024 pixels seem quite small and hard to read when displayed.</p>
<p class="indent">To get around this, these newer devices often have a notional CSS pixel, separate from the physical pixels of the device, allowing for zooming in and out of the content and for high graphical fidelity on the small screen. The ratio of physical pixels to CSS pixels is known as the <em>device pixel ratio (DPR)</em>. The iPhone 5S, for example, has a DPR of 2, which means that one CSS pixel is equal to 4 physical pixels—2 horizontally and 2 vertically.</p>
<p class="indent"><a id="page_14"/>You can see this illustrated in <a href="ch02.html#ch02fig3">Figure 2-3</a>. The example on the left shows one CSS pixel on a “normal” screen with a 1:1 pixel ratio. The example in the middle shows the same CSS pixel on a screen with a DPR of 2, like the iPhone; there are 4 physical pixels in the same space. Finally, the example on the right shows how this would appear on a screen with a DPR of 3, like the Nexus 5; now there are 9 physical pixels in the space of a single CSS pixel.</p>
<div class="image"><img alt="Image" src="graphics/f02-03.jpg"/></div>
<p class="figuret"><a id="ch02fig3"/><em>Figure 2-3: A CSS pixel with a 1:1 pixel ratio (left), a DPR of 2 (middle), and 3 (right)</em></p>
<p class="indent">What that means in practice is that, although the iPhone 5S (for example) has a physical resolution of 640×1136, it has a CSS resolution of 320×568—exactly half the dimensions, as every CSS pixel is equivalent to two physical pixels, both horizontally and vertically (although only when the device is in “mobile mode”; see “<a href="ch02.html#ch02leve1sec18">Device Width and Height</a>” on <a href="ch02.html#page_15">page 15</a> for an explanation of this).</p>
<p class="indent">Although this high DPR makes scalable content—such as text and vector graphics—sharp and clear, bitmap images can suffer badly from a loss of quality when viewed on high resolution screens. To get around this problem, a new media feature, called <code>resolution</code>, is available that lets you target devices based on their DPR:</p>
<pre class="programs">@media <span class="codeitalic">media</span> and (resolution: <span class="codeitalic">value</span>) { <span class="codeitalic">rules</span> }</pre>
<p class="indent">The value of <code>resolution</code> is a number with a unit of resolution: <em>dots per inch (DPI)</em>, <em>dots per centimeter (DPCM)</em>, or, most pertinently to us, <em>dots per pixel (DPPX)</em>. The DPPX unit maps to the DPR of the device, so to apply a rule to devices that have a DPR value of 1.5, you use this:</p>
<pre class="programs">@media (resolution: 1.5dppx) { <span class="codeitalic">rules</span> }</pre>
<p class="indent">As with the other media features, you can also detect maximum and minimum pixel ratios:</p>
<pre class="programs">@media (max-resolution: <span class="codeitalic">number</span>) { <span class="codeitalic">rules</span> }<br/>@media (min-resolution: <span class="codeitalic">number</span>) { <span class="codeitalic">rules</span> }</pre>
<p class="indent"><a id="page_15"/>This flexibility makes serving higher-resolution background images to browsers with higher pixel density easier, as you can see in this code:</p>
<pre class="programs1"><span class="ent">➊</span> <span class="codeitalic">E</span> { background-image: url('image-lores.png'); }<br/><span class="ent">➋</span> @media (min-resolution: 1.5dppx) {<br/>       background-image: url('image-hires.png');<br/><span class="ent">➌</span>      background-size: 100% 100%;<br/>  }</pre>
<p class="indent">The first rule (<span class="ent">➊</span>) means browsers on devices with a “standard” (or low-resolution) pixel ratio will use the standard image (<em>image-lores.png</em>), whereas devices with a DPR of at least 1.5 will use the high-resolution image (<em>image-hires.png</em>) instead (<span class="ent">➋</span>). Note the use of the unfamiliar <code>background-size</code> property here (<span class="ent">➌</span>); this property should be used with high-resolution images to ensure they aren’t displayed larger than the element they are applied to (I introduce <code>background-size</code> fully in <a href="ch08.html#ch08">Chapter 8</a>).</p>
<p class="indent">Chrome, Firefox, and Internet Explorer 10+ all support the <code>resolution</code> media feature, although IE unfortunately hasn’t implemented the DPPX value; to accommodate IE, you should use DPI, multiplying the required DPR by 96 (the DPI value of a standard screen). Here’s an example:</p>
<pre class="programs">@media (resolution: 1.5dppx), (resolution: 144dpi) { <span class="codeitalic">rules</span> }</pre>
<p class="indent">Safari doesn’t support <code>resolution</code>, instead using a proprietary media feature called <code>-webkit-device-pixel-ratio</code> (along with <code>max-</code> and <code>min-</code> variants), which takes as a value a single, unitless number that is the targeted DPR. So to accommodate all modern browsers, use this rule:</p>
<pre class="programs">@media (resolution: 1.5dppx), (resolution: 144dpi), (-webkit-device-pixel-ratio: 2) { <span class="codeitalic">rules</span> }</pre>
<p class="indent">The <code>resolution</code> rule was implemented in the WebKit engine at the end of 2012, so I’m disappointed to not see it released in Safari at the time of writing, almost two years later. Hopefully this oversight will be rectified in the near future.</p>
<h4 class="h4" id="ch02leve1sec18"><strong><em>Device Width and Height</em></strong></h4>
<p class="noindent">The <code>width</code> and <code>height</code> media features are related to the dimensions of the browser viewport, but that viewport isn’t always as big as the screen it’s displayed on. If you need to target the physical screen size rather than the viewport size, you can use the <code>device-width</code> and <code>device-height</code> properties and their related <code>min-</code> and <code>max-</code> variants. You won’t use these too often, but to explain why, I need to digress.</p>
<p class="indent">In the previous section, I explained the difference between CSS pixels and physical pixels. The <code>width</code> media feature is measured in CSS pixels, <a id="page_16"/>and <code>device-width</code>, in physical pixels. To make content readable and “natural sized” on a small screen, both dimensions need to match. You do this by adding the <em>viewport meta tag</em> into the head of the document, like this:</p>
<pre class="programs">&lt;meta name="viewport" content="width=device-width"&gt;</pre>
<p class="indent">When the viewport meta tag with these values is present in the <code>head</code> of a page, mobile browsers go into “mobile mode,” in which the viewport is sized to ideal dimensions for that device. The result is that content is displayed at a more appropriate size for the device.</p>
<p class="note"><strong><small>NOTE</small></strong><br/><em>For a more in-depth explanation of mobile viewports and pixels, see Dutch developer</em> <em>PPK’s “A Pixel Is Not a Pixel Is Not a Pixel”</em> (<a href="http://www.quirksmode.org/blog/archives/2010/04/a_pixel_is_not.html">http://www.quirksmode.org/blog/archives/2010/04/a_pixel_is_not.html</a>).</p>
<p class="indent">The viewport of a browser on a mobile device tends to be as large as the screen itself, so the two are basically equivalent; and on desktop browsers, you will most likely want to make your content relative to the width of the viewport rather than that of the screen. For these reasons, the <code>device-width</code> media feature becomes less useful than <code>width</code>, and you probably won’t use it too much in practice.</p>
<p class="indent">The viewport meta tag is being standardized in CSS as the <code>@viewport</code> rule; see “<a href="ch19.html#ch19leve1sec268">Device Adaptation</a>” on <a href="ch19.html#page_252">page 252</a> for a brief walkthrough.</p>
<h4 class="h4" id="ch02leve1sec19"><strong><em>Orientation</em></strong></h4>
<p class="noindent">If you’re less concerned with the actual dimensions of the viewing device but want to optimize your pages for either horizontal (like a typical desktop/laptop web browser) or vertical (like a mobile phone or ebook reader) viewing, the media feature you need is <code>orientation</code>. Here is its syntax:</p>
<pre class="programs">@media (orientation: <span class="codeitalic">value</span>) { <span class="codeitalic">rules</span> }</pre>
<p class="indent"><code><em>value</em></code> can be one of two keyword options: <code>landscape</code> or <code>portrait</code>. The <code>landscape</code> value applies when the width of your browser is greater than its height, and the <code>portrait</code> value applies when the opposite is true. Although <code>orientation</code> can certainly be applied to desktop browsers, you’ll find it most useful when dealing with handheld devices that the user can easily rotate, such as smartphones and tablets.</p>
<p class="indent">For example, you can use <code>orientation</code> to display a navigation menu horizontally or vertically, depending on the visitor’s browser orientation. The code looks like this:</p>
<pre class="programs">ul { overflow: hidden; }<br/>li { float: left; }<br/>@media (orientation: portrait) {<br/>  li { float: none; }<br/>}</pre>
<p class="indent"><a id="page_17"/>By default, the <code>li</code> elements have a float value of <code>left</code>, making them stack horizontally across the page. If the same page is viewed in a <code>portrait</code> orientation—either by resizing the browser to be taller than it is wide or by viewing the page in a device with a portrait orientation—the float is removed and the <code>li</code> elements stack vertically instead. You can see the result in <a href="ch02.html#ch02fig4">Figure 2-4</a>.</p>
<div class="image"><img alt="Image" src="graphics/f02-04.jpg"/></div>
<p class="figuret"><a id="ch02fig4"/><em>Figure 2-4: The</em> <code><em>orientation</em></code> <em>media feature in use on a mobile browser:</em> <code><em>portrait</em></code> <em>(left) and</em> <code><em>landscape</em></code> <em>(right)</em></p>
<p class="indent">As only two values are possible for the <code>orientation</code> feature, if you apply differentiating rules using one value, then the other tacitly becomes the opposite. In this example, I only used the <code>portrait</code> value, so, by default, all of the rules outside of that function apply to the <code>landscape</code> orientation.</p>
<h4 class="h4" id="ch02leve1sec20"><strong><em>Aspect Ratio</em></strong></h4>
<p class="noindent">You can also create queries that apply when a certain width-to-height ratio is met. Use <code>aspect-ratio</code> to test the browser’s aspect ratio or <code>device-aspect-ratio</code> to test the device’s aspect ratio. Here is the syntax for these two features:</p>
<pre class="programs">@media (aspect-ratio: <span class="codeitalic">horizontal</span>/<span class="codeitalic">vertical</span>) { <span class="codeitalic">rules</span> }<br/>@media (device-aspect-ratio: <span class="codeitalic">horizontal</span>/<span class="codeitalic">vertical</span>) { <span class="codeitalic">rules</span> }</pre>
<p class="indent">The <code><em>horizontal</em></code> and <code><em>vertical</em></code> values are positive integers that represent the ratio of the width and height (respectively) of the viewing device’s screen, so a square display would be 1/1 and a cinematic widescreen display would be 16/9.</p>
<p class="note"><strong><small>NOTE</small></strong><br/><em>Some devices—notably the iPhone—always report the aspect ratio of the device in portrait orientation, even when being viewed in landscape.</em></p>
<p class="indent"><a id="page_18"/>Selecting by aspect ratio is potentially fraught with caveats. For example, some device manufacturers define widescreen as 16/9, some as 16/10, and others as 15/10. And a device may not have the exact stated aspect ratio; the iPhone 5S, for example, claims to have a 16/9 aspect ratio but actually reports as having the slightly larger 40/71 ratio (the portrait orientation). Using the <code>max-</code> and <code>min-</code> variations of <code>aspect-ratio</code> and <code>device-aspect-ratio</code> to apply the rules may be preferable. Consider this code in which the rules in the query are applied to any element that has an aspect ratio of greater than 16/9:</p>
<pre class="programs">@media (min-device-aspect-ratio: 16/9) {…}</pre>
<h3 class="h3" id="ch02leve1sec21"><strong>Multiple Media Features</strong></h3>
<p class="noindent">You can chain multiple queries together on the same media type by adding expressions with the <code>and</code> operator:</p>
<pre class="programs">@media logic media and (expression) and (expression) { rules }</pre>
<p class="indent">This syntax tests that both expressions are matched before applying the selected rules. For example, to test for a narrow screen on a device with an aspect ratio no greater than 15/10, you use this query:</p>
<pre class="programs">@media (max-device-aspect-ratio: 15/10) and (max-width: 800px) {…}</pre>
<p class="indent">You can also use a conditional “or” expression by adding extra queries in a comma-separated list:</p>
<pre class="programs">@media <span class="codeitalic">logic media</span> and (<span class="codeitalic">expression</span>), <span class="codeitalic">logic media</span> and (<span class="codeitalic">expression</span>) { <span class="codeitalic">rules</span> }</pre>
<p class="indent">This applies rules when any of the stated cases is true; in the following example, the rules are applied to a screen in landscape orientation or to a printed document in portrait orientation:</p>
<pre class="programs">@media screen and (orientation: landscape), print and (orientation: portrait) {…}</pre>
<p class="indent">You can also, of course, create any combination of these syntaxes.</p>
<h3 class="h3" id="ch02leve1sec22"><strong>Mobile-First Web Development</strong></h3>
<p class="noindent">The common best-practice method of building websites today uses a method known as <em>mobile-first development</em>, where we start developing for smaller screens before adding larger assets and more complexity for users accessing the site on larger devices.</p>
<p class="indent">The reason this method was adopted is because of the way that some browsers load page assets, such as images, that are included in style sheets. <a id="page_19"/>Problems arose because some early adopters of media queries would, for example, apply large background images to elements and then write rules to hide them from mobile devices:</p>
<pre class="programs"><span class="codeitalic">E</span> { background-image: url('huge-image.jpg'); }<br/>@media (max-width: 600px) {<br/>    <span class="codeitalic">E</span> { display: none; }<br/>}</pre>
<p class="indent">But those background images, despite being hidden, were still downloaded by the browser and held in the cache even though they weren’t displayed. This method increases the page’s load time and consumes bandwidth allowances—neither of which is good for mobile device users without wireless connections.</p>
<p class="indent">The mobile-first way to create your pages is to first make a basic style sheet, which is applied to all browsers, including mobile, and to then progressively add assets and features for users with larger screens, loaded using a media query with the <code>min-width</code> feature:</p>
<pre class="programs">@media (min-width: 600px) {<br/>    <span class="codeitalic">E</span> { background-image: url('huge-image.jpg'); }<br/>}</pre>
<p class="indent">This change means the background image in question never gets loaded on devices with smaller screens. This approach can be extrapolated to loading entire style sheets:</p>
<pre class="programs">&lt;link href="basic.css" rel="stylesheet"&gt;<br/>&lt;link href="desktop.css" rel="stylesheet" media="(min-width: 600px)"&gt;</pre>
<p class="indent">When the style sheets are separated in this way, some browsers will optimize the way the style sheets are loaded; in Chrome, for example, as the file <em>desktop.css</em> doesn’t apply to devices with a screen width of less than 600px, its loading is delayed until after more high-priority assets have been downloaded—a quite useful optimization.</p>
<p class="indent">This mobile-first approach works for the great majority of browsers from the past few years; any really old browsers will get the basic style sheet instead, which is probably better for them as they won’t be able to cope with the advanced features I’ll be teaching you throughout the rest of this book.</p>
<h3 class="h3" id="ch02leve1sec23"><strong>Summary</strong></h3>
<p class="noindent">Their syntax may be simple, but media queries have the capacity to be extraordinarily powerful. With the mobile web explosion of recent years, designers and developers are beginning to realize they have the power to tailor their content to the user without employing the old techniques of browser sniffing or separate (and completely different) mobile versions of their sites.</p>
<p class="indent"><a id="page_20"/>The rise of the responsive web design movement in the past few years has been fueled by the power of media queries, and in just a short space of time, they’ve become one of the most powerful tools at a web developer’s disposal. With careful consideration and clever use of media queries, you can create websites that scale perfectly for users, however they access the Web.</p>
<h3 class="h3" id="ch02leve1sec24"><strong>Media Queries: Browser Support</strong></h3>
<table border="0" cellpadding="0" cellspacing="0" class="all" width="100%">
<tr>
<td class="table2" valign="top"><p class="table"/></td>
<td class="table2" valign="top"><p class="table"><strong>Chrome</strong></p></td>
<td class="table2" valign="top"><p class="table"><strong>Firefox</strong></p></td>
<td class="table2" valign="top"><p class="table"><strong>Safari</strong></p></td>
<td class="table2" valign="top"><p class="table"><strong>IE</strong></p></td>
</tr>
<tr>
<td class="table" valign="top"><p class="table">Media queries</p></td>
<td class="table" valign="top"><p class="table">Yes</p></td>
<td class="table" valign="top"><p class="table">Yes</p></td>
<td class="table" valign="top"><p class="table">Yes</p></td>
<td class="table" valign="top"><p class="table">Yes</p></td>
</tr>
</table>
</body></html>