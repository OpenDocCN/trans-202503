["```\nPS> **Get-LsaPackage | Select-Object Name, Comment**\nName                                         Comment\n----                                         -------\nNegotiate                                    Microsoft Package Negotiator ❶\nNegoExtender                                 NegoExtender Security Package\nKerberos                                     Microsoft Kerberos V1.0\nNTLM                                         NTLM Security Package ❷\nTSSSP                                        TS Service Security Package\npku2u                                        PKU2U Security Package\nCloudAP                                      Cloud AP Security Package\nWDigest                                      Digest Authentication for Windows\nSchannel                                     Schannel Security Package\nMicrosoft Unified Security Protocol Provider Schannel Security Package\nDefault TLS SSP                              Schannel Security Package\nCREDSSP                                      Microsoft CredSSP Security Provider \n```", "```\nPS> **Get-NtLogonSession | Sort-Object LogonId**\nLogonId           UserName                     LogonType          SessionId\n-------           --------                     ---------          ---------\n❶ 00000000-000003E4 NT AUTHORITY\\NETWORK SERVICE Service            0\n00000000-000003E5 NT AUTHORITY\\LOCAL SERVICE   Service            0\n❷ 00000000-000003E7 NT AUTHORITY\\SYSTEM          UndefinedLogonType 0\n❸ 00000000-00006A39 Font Driver Host\\UMFD-0      Interactive        0\n00000000-00006A96 Font Driver Host\\UMFD-1      Interactive        1\n00000000-0000C5E9 Window Manager\\DWM-1         Interactive        1\n❹ 00000000-00042A51 GRAPHITE\\user                Interactive        1\n00000000-00042AB7 GRAPHITE\\user                Interactive        1\n00000000-000E7A72 Font Driver Host\\UMFD-3      Interactive        2\n00000000-000E7CF2 Window Manager\\DWM-3         Interactive        2 \n```", "```\nPS> **Get-NtConsoleSession**\nSessionId UserName      SessionName            State\n--------- --------      -----------            -----\n0                       Services               Disconnected\n1         GRAPHITE\\user 31C5CE94259D4006A9E4#0 Active\n2                      Console                Connected \n```", "```\nPS> **$password = Read-Host -AsSecureString -Prompt \"Password\"**\nPassword: ************\nPS> **$token = Get-NtToken -Logon -User** **`user`** **-Domain $env:COMPUTERNAME**\n**-Password $password -LogonType Network**\nPS> **Get-NtLogonSession -Token $token**\nLogonId           UserName         LogonType SessionId\n-------           --------         --------- ---------\n00000000-9BBFFF01 GRAPHITE\\user    Network   3 \n```", "```\nPS> **Get-NtTokenId -Authentication**\nLUID\n----\n00000000-000A0908\n\nPS> **Get-NtTokenId -Token $token -Origin**\nLUID\n----\n00000000-000A0908 \n```", "```\nPS> **Get-NtTokenIntegrityLevel -Token $token**\nHigh\n\nPS> **Test-NtTokenImpersonation $token**\nFalse\n\nPS> **Set-NtTokenIntegrityLevel -Token $token Medium**\nPS> **Test-NtTokenImpersonation $token**\nTrue \n```", "```\nPS> **$token = Get-NtToken -Logon -User** **`user`** **-Domain $env:COMPUTERNAME**\n**-Password $password -LogonType Interactive**\nPS> **New-Win32Process cmd.exe -Token $token**\nException calling \"CreateProcess\": \"A required privilege is not held\nby the client\" \n```", "```\nPS> **$creds = Read-LsaCredential**\nUserName: **alice**\nDomain: **MINERAL**\nPassword: ************\n\nPS> **$proc = New-Win32Process -CommandLine cmd.exe -Credential $creds**\nPS> **$proc.Process.User**\nName          Sid\n----          ---\nMINERAL\\alice S-1-5-21-1195776225-522706947-2538775957-1110 \n```", "```\nPS> **Get-NtToken -Logon -LogonType Service -Domain 'NT AUTHORITY' -User SYSTEM** \n**-WithTcb**\nUser                GroupCount PrivilegeCount AppContainer Restricted\n----                ---------- -------------- ------------ ----------\nNT AUTHORITY\\SYSTEM 11         31             False        False\n\nPS> **Get-NtToken -Service System -WithTcb**\nUser                GroupCount PrivilegeCount AppContainer Restricted\n----                ---------- -------------- ------------ ----------\nNT AUTHORITY\\SYSTEM 11         31             False        False \n```", "```\nPS> **$password = Read-Host -AsSecureString -Prompt \"Password\"**\nPassword: ************\n❶ PS> **$user = New-LocalUser -Name \"Test\" -Password $password**\nPS> **$sid = $user.Sid.Value**\n❷ PS> **$token = Get-NtToken -Logon -User $user.Name -SecurePassword $password**\n**-LogonType Interactive**\nPS> **$token.ElevationType**\nDefault\n\nPS> **$token.Close()**\n❸ PS> **Add-NtAccountRight -Privilege SeDebugPrivilege -Sid $sid**\nPS> **$token = Get-NtToken -Logon -User $user.Name -SecurePassword $password**\n**-LogonType Interactive**\nPS> **Enable-NtTokenPrivilege -Token $token SeDebugPrivilege -PassThru**\n❹ WARNING: Couldn't set privilege SeDebugPrivilege\n\nPS> **$token.ElevationType**\nLimited\n\nPS> **$token.Close()**\n❺ PS> **$token = Get-NtToken -Logon -User $user.Name -SecurePassword $password**\n**-LogonType Network**\nPS> **Enable-NtTokenPrivilege -Token $token SeDebugPrivilege -PassThru**\nName             Luid              Enabled\n----             ----              -------\n❻ SeDebugPrivilege 00000000-00000014 True\n\nPS> **$token.ElevationType**\nDefault\n\nPS> **$token.Close()**\n❼ PS> **Add-NtAccountRight -LogonType SeDenyInteractiveLogonRight -Sid $sid**\nPS> **Add-NtAccountRight -LogonType SeBatchLogonRight -Sid $sid**\n❽ PS> **Get-NtToken -Logon -User $user.Name -SecurePassword $password**\n**-LogonType Interactive**\nGet-NtToken : (0x80070569) - Logon failure: the user has not been granted\nthe requested logon type at this computer.\n\nPS> **$token = Get-NtToken -Logon -User $user.Name -SecurePassword $password**\n**-LogonType Batch**\nPS> **Get-NtTokenGroup $token | Where-Object {$_.Sid.Name -eq** \n**\"NT AUTHORITY\\BATCH\"}**\nSid        : S-1-5-3\nAttributes : Mandatory, EnabledByDefault, Enabled\nEnabled    : True\nMandatory  : True\nDenyOnly   : False\n❾ Name       : NT AUTHORITY\\BATCH\n\nPS> **$token.Close()**\n❿ PS> **Remove-NtAccountRight -Privilege SeDebugPrivilege -Sid $sid**\nPS> **Remove-NtAccountRight -LogonType SeDenyInteractiveLogonRight -Sid $sid**\nPS> **Remove-NtAccountRight -LogonType SeBatchLogonRight -Sid $sid**\nPS> **Remove-LocalUser $user** \n```", "```\nPS> **Start-Win32ChildProcess ((Get-NtProcess -Current).Win32ImagePath)**\n**-RequiredPrivilege SeTcbPrivilege,SeAssignPrimaryTokenPrivilege** \n```", "```\nPS> **$username = \"GRAPHITE\\user\"**\n❶ PS> **$console = Get-NtConsoleSession |**\n**Where-Object FullyQualifiedUserName -eq $username**\n❷ PS> **$token = Get-NtToken -Duplicate -TokenType Primary**\nPS> **Enable-NtTokenPrivilege SeTcbPrivilege**\nPS> **$token.SessionId = $console.SessionId**\nPS> **$cmd = \"cmd.exe\"**\n❸ PS> **$proc = New-Win32Process $cmd -Token $token -Desktop \"WinSta0\\Default\"**\n**-CreationFlags NewConsole**\n❹ PS> **$proc.Process.SessionId -eq $console.SessionId**\nTrue\n\nPS> **$proc.Dispose()**\nPS> **$token.Close()** \n```", "```\nPS> **$domain_sid = Get-NtSid \"S-1-5-99\"** ❶\nPS> **$group_sid = Get-NtSid -BaseSid $domain_sid -RelativeIdentifier 0**\nPS> **$user_sid = Get-NtSid -BaseSid $domain_sid -RelativeIdentifier 1**\nPS> **$domain = \"CUSTOMDOMAIN\"**\nPS> **$group = \"ALL USERS\"**\nPS> **$user = \"USER\"**\nPS> **$token = Invoke-NtToken -System {**❷\n    **Add-NtSidName -Domain $domain -Sid $domain_sid -Register** ❸\n    **Add-NtSidName -Domain $domain -Name $group -Sid $group_sid -Register**\n    **Add-NtSidName -Domain $domain -Name $user -Sid $user_sid -Register**\n    **Add-NtAccountRight -Sid $user_sid -LogonType SeInteractiveLogonRight** ❹\n    **Get-NtToken -Logon -Domain $domain -User $user -LogonProvider Virtual**\n**-LogonType Interactive** ❺\n    **Remove-NtAccountRight -Sid $user_sid -LogonType SeInteractiveLogonRight** ❻\n    **Remove-NtSidName -Sid $domain_sid -Unregister**\n**}**\nPS> **Format-NtToken $token -User -Group**\nUSER INFORMATION\n----------------\nName              Sid\n----              ---\nCUSTOMDOMAIN\\User S-1-5-99-1 ❼\n\nGROUP SID INFORMATION\n-----------------\nName                                   Attributes\n----                                   ----------\nMandatory Label\\Medium Mandatory Level Integrity, IntegrityEnabled\nEveryone                               Mandatory, EnabledByDefault, Enabled\nBUILTIN\\Users                          Mandatory, EnabledByDefault, Enabled\nNT AUTHORITY\\INTERACTIVE               Mandatory, EnabledByDefault, Enabled\nNT AUTHORITY\\Authenticated Users       Mandatory, EnabledByDefault, Enabled\nNT AUTHORITY\\This Organization         Mandatory, EnabledByDefault, Enabled\nNT AUTHORITY\\LogonSessionId_0_10173    Mandatory, EnabledByDefault, Enabled, LogonId\nCUSTOMDOMAIN\\ALL USERS                 Mandatory, EnabledByDefault, Enabled ❽ \n```"]