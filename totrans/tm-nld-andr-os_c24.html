<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" epub:prefix="index: http://www.index.com/" lang="en" xml:lang="en">
<head>
<title>Chapter 24: Developer Tools</title>
<link href="NSTemplate_v1.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:c2f206e1-36e8-4f89-b533-508263d6ec16" name="Adept.expected.resource"/>
</head>
<body epub:type="bodymatter chapter">
<section>
<header>
<h1 class="chapter">
<span class="ChapterNumber"><span epub:type="pagebreak" id="Page_235" title="235"/>24</span><br/>
<span class="ChapterTitle">Developer Tools</span></h1>
</header>
<blockquote class="Epigraph" epub:type="epigraph">
<p class="Epigraph">Developers, developers, developers, developers, developers, developers, developers, developers, developers, developers, developers, developers, developers, developers.</p>
<p class="EpigraphSource">—Steve Ballmer, Microsoft<sup class="FootnoteReference"><a href="#c24-footnote-1" id="c24-footnoteref-1">1</a></sup></p>
</blockquote>
<p class="ChapterIntro"><span class="dropCap">O</span>ne of the reasons behind Android’s growth is the developer ecosystem that was created along the way, enabling thousands (now millions) of applications for people to find, download, and use.</p>
<p>But this kind of ecosystem doesn’t just happen automatically, especially for a new platform with no market share. In order to lower the barrier to entry for application developers, to make it easier for them to write and publish their applications, Android needed to provide tools for developers.</p>
<p>A determined developer could write code and use some obscure commands in a terminal to compile that code into an application. If that developer just wanted to write a “Hello, World!”<sup class="FootnoteReference"><a href="#c24-footnote-2" id="c24-footnoteref-2">2</a></sup> app, that’s probably all they’d need.</p>
<p>But any real application involves a large amount of code and other materials, including multiple files, resources for images, text strings, and so on. <span epub:type="pagebreak" id="Page_236" title="236"/>That level of complexity is overwhelming if you’re coding it all by hand in a text editor with just a command-line compiler for a friend.</p>
<p>That’s why Xavier Ducrohet was brought onto the team, in April of 2007.</p>
<h2 id="h1-502680c24-0001">Xavier Ducrohet and the SDK</h2>
<p class="BodyFirst">Xavier (who goes by “Xav”) had been working on tools for years. Most recently, he was building drawing tools at Beatware. It wasn’t the most stable of jobs: “We were not always quite paid.” But Xav’s green card, which allowed him to stay and work in the US, was still being processed, and leaving a company can put that process in jeopardy. Also, he felt some responsibility for not causing a crisis for the small company. “If I left, the company would go under.”</p>
<p>Beatware was eventually acquired by Hyperion Software in late 2006. Xav decided to stick it out a bit longer because of the stock he was still vesting. But in March of 2007, Oracle acquired Hyperion, and that was it; Xav didn’t want to join Oracle. He called his old friend Mathias Agopian at Google.</p>
<p>Xav already had a good idea of what Android was about, even though the project was secret. Beatware had been in conversations with Android early on about providing some graphics technology. Beatware offered a vector-based image editing tool, which Android could have used for UI graphics. Vector images offer the advantage that they look better when scaled than pure bitmap images, which become blocky or distorted when they are scaled. But Android eventually developed its own kind of image for that purpose, called a <em>NinePatch</em>.<sup class="FootnoteReference"><a href="#c24-footnote-3" id="c24-footnoteref-3">3</a></sup></p>
<p>Xav had known Mathias for years, from the Be community. Xav had played around with BeOS back when he was in college in France. He’d gotten to know the Be community in Paris at the time, which included Mathias as well as future Android engineer Jean-Baptiste Quéru. So when Xav wanted a new job, he reached out to Mathias. He had already interviewed with the team earlier when he was at Beatware, so his interview this time just consisted of having lunch with Steve Horowitz. He started three weeks later, in April of 2007.</p>
<p><span epub:type="pagebreak" id="Page_237" title="237"/>On his first day, Xav sat down with Steve and Mike Cleron, who suggested he work on tools. To begin with, Xav dove into DDMS.<sup class="FootnoteReference"><a href="#c24-footnote-4" id="c24-footnoteref-4">4</a></sup> DDMS was a tool running on a developer’s desktop system that was a container for many different tools. For example, DDMS provided a list of the current applications running on an Android device connected to the host computer. Selecting one of these would cause that application to connect to port 8700 on the host computer, at which point you could debug that application by connecting to that port from a debugging tool.</p>
<p>Xav’s starter project<sup class="FootnoteReference"><a href="#c24-footnote-5" id="c24-footnoteref-5">5</a></sup> was to enable DDMS to visualize native memory. This isn’t a particularly critical need for most Android developers, but it was very important at the time for the Android platform team itself. After that project, he refactored the monolithic DDMS tool into separate pieces consisting of the core functionality, the user interface layer, and the glue that tied the other two together into a standalone tool.</p>
<p>By refactoring DDMS, Xav was able to connect the pieces with an existing open source development IDE called Eclipse. By June, he was able to demonstrate, to the larger Android team, the entire workflow of opening up an application project within this IDE, compiling it, deploying it to the emulator, running it on the emulator, stopping at a breakpoint<sup class="FootnoteReference"><a href="#c24-footnote-6" id="c24-footnoteref-6">6</a></sup> in the code, and then stepping through the code, instruction by instruction.</p>
<p>This project was a good example of what things were like on Android. Someone identified a problem and would then just go hammer out a solution. Quickly. Xav joined in late April. By June, two months after he started, he demoed the entire, new, functional tools flow to the team. That set of tools shipped to external developers when the SDK launched a few months later and served as the basis for Android’s developer toolchain for many years. He <span epub:type="pagebreak" id="Page_238" title="238"/>went from joining the company and team, knowing nothing about Android, to offering a tool that would form foundational support for all Android developers (platform and application, internal and external) in just a couple of months.</p>
<figure>
<img alt="" class="" src="image_fi/502680c24/f24001.png"/>
<figcaption><p>Xav on November 12, 2007—launch day for the first SDK (picture courtesy Brian Swetland)</p></figcaption>
</figure>
<p>Once Xav finished that IDE project, he created the SDK for Android. The SDK was an installable bundle of tools and other pieces for application developers that included the Android Eclipse plugin (and all the sub-tools like DDMS, ADB, and Traceview) and Android itself. The Android bits included the library of code that developers wrote their programs against, the system image of Android that ran in the emulator, and documentation so that developers could figure out what it was they were supposed to be doing. Again, Xav identified the need and put things together. And it’s a good thing he did. This work was coming together around August of 2007. Meanwhile, the SDK for Android was set to ship that November, so it’s nice that they had something to ship.</p>
<h2 id="h1-502680c24-0002"><span epub:type="pagebreak" id="Page_239" title="239"/>David Turner and the Emulator</h2>
<p class="BodyFirst">One of the critical tools that developers need early on in a platform’s development is a device to run that platform on; if you can’t run your application, how can you verify that it does what it’s supposed to?</p>
<p>But when Android was first being developed, devices that ran the platform were effectively unavailable,<sup class="FootnoteReference"><a href="#c24-footnote-7" id="c24-footnoteref-7">7</a></sup> so the team brought in someone to write a virtual device: David Turner (known to the team as “digit”).</p>
<p>Before he wrote the original Android emulator, David was famous in programming circles as the original author of FreeType, a font-rendering library. One of the fascinating things about Google is that there are so many people at the company that are famous for doing a particular thing . . . which is completely unrelated to what they end up doing at Google. I’ve known famous classic game developers, inventors of fundamental graphics algorithms, and 3D graphics experts, none of whom worked on software at Google remotely related to the software achievements that made them famous.</p>
<p>Other companies hire people for what they’ve done, then ask them to do more of it. Google hires people for who they are and asks them to do whatever needs to be done. What these people have done in the past is a great example of what they can do, but does not limit them, in Google’s eyes, to what they are capable of. That’s how Google found itself with one of the world’s great font rendering experts, working on the Android emulator.</p>
<p>David learned about coding for performance when he was a kid, programming in BASIC and assembly language on an Apple II+, and learning the importance of performance coding along the way. “The machines were so underpowered that every detail counted to get anything satisfying from them.”</p>
<p>Years later, he was using a computer running OS/2, but disliked the fonts it used, so he posed himself a challenge: he wrote a renderer for TrueType<sup class="FootnoteReference"><a href="#c24-footnote-8" id="c24-footnoteref-8">8</a></sup> fonts directly from the specification, using as little memory and code as possible. The result was the FreeType renderer. He released it as open source. It caught on, and was used widely in limited, embedded systems from TVs to cameras to . . . Android. FreeType was (and is) the font renderer for Skia, Android’s graphics engine.</p>
<p><span epub:type="pagebreak" id="Page_240" title="240"/>In 2006, an engineer on the Android team (which was always looking for embedded programmers) saw David’s name in the source code for FreeType and reached out. “Of course, nobody told me why I was contacted by Google, so I prepared my interviews by reading a ton of stuff on HTML, SQL, web servers, and databases. To my surprise, all interview questions were about fundamental data structures, algorithms, and embedded systems, so they went a lot better than I initially expected.”</p>
<p>David started on the Android team in September of 2006.</p>
<p>David’s first project was getting a utility library up and running for C programming.<sup class="FootnoteReference"><a href="#c24-footnote-9" id="c24-footnoteref-9">9</a></sup> Android was using a very small and basic C library at the time, but it lacked some necessary features and had a more restrictive license than was desired for the eventual open sourcing of the platform. David assembled Android’s “Bionic” library from various license-compatible BSD<sup class="FootnoteReference"><a href="#c24-footnote-10" id="c24-footnoteref-10">10</a></sup> Unix libraries, combined with new code to integrate with the Linux kernel and to support Linux or Android-specific features not present in the BSD codebase.</p>
<p>After this library work was done, David moved on to the emulator.</p>
<p>Initially, Android had a <em>simulator</em>, a program that ran on the developer’s desktop computer that imitated the behavior of an Android device. But simulators fake many of the details; they mimic the behavior of the system on the outside but ignore many of the details on the inside, which means that the behavior of the overall system is not true to the actual device (and thus cannot be relied on for real testing).</p>
<p>Fadden wrote the original simulator but was getting tired of maintaining it when Android was in constant flux. David remembered, “It was maintained by one sole engineer who was fed up with fixing it every time we had an advanced feature. The plan was: the simulator is essentially dead, and we need a good emulator.”</p>
<p>Android had the beginnings of an emulator already, based on an open source project called QEMU, which was created by Fabrice Bellard, a friend of David’s. David overhauled this implementation: “We were using a very old version of the QEMU upstream at the time that had been modified pretty <span epub:type="pagebreak" id="Page_241" title="241"/>aggressively. Nobody understood exactly what was going on.” David started by pulling in a more recent version of QEMU, which had problems of its own. “QEMU development at the time (around 2006 to 2010) was pretty bad. No unit tests at all, global variables<sup class="FootnoteReference"><a href="#c24-footnote-11" id="c24-footnoteref-11">11</a></sup> everywhere.” </p>
<p>He eventually got things working better, but still had a lot of work to do, like making the Linux-based QEMU project work on Windows and Mac, and separating the Android-specific portions of the emulator to enable better testing.</p>
<p>The emulator was hugely important at the time. Hardware devices were very difficult to come by. Having an emulator that mimicked a real device made it possible (for developers on the Android team and eventually external developers) to write and test their Android code.</p>
<p>The emulator was like a real device because it emulated everything that happened on a real device. Not only did it look like an Android phone (in a window on your desktop computer), but the bits running inside of it, down to the chip level, were exactly the same as those that ran on an actual hardware device.</p>
<p>Another advantage of the emulator was speed, compared to actual hardware devices (for the developers that had them). Communicating to an emulator on the host machine was much faster than communicating through a USB cable to a real device. Pushing applications, or the entire Android platform, across a USB cable could take minutes. Pushing code to the emulator, which was running on the same desktop computer where the code was being pushed from, was much faster, so an engineer could be more productive with a virtual device instead of a real one.</p>
<p>On the other hand, the emulator has always been criticized for being incredibly slow. In particular, it took a long time to boot. Starting up an emulator mimicked booting a phone, since it emulated exactly what a phone would go through. You could leave the emulator running in most situations, especially for pure application development. But startup and runtime <span epub:type="pagebreak" id="Page_242" title="242"/>performance of the emulator continued to be a common source of complaint until more recent releases.<sup class="FootnoteReference"><a href="#c24-footnote-12" id="c24-footnoteref-12">12</a></sup></p>
<p>The emulator project was also a great demonstration of the, er, <em>scrappiness</em> of Android in those early days. It’s not that the team was small . . . there wasn’t even a team. There was just one person responsible for this monumental effort, and the emulator was just one of several projects that he worked on.</p>
<p>David continued developing and maintaining the emulator on his own, as just one of his jobs, for many years. </p>
<h2 id="h1-502680c24-0003">Dirk Dougherty’s Docs: RTFM<sup class="FootnoteReference"><a href="#c24-footnote-13" id="c24-footnoteref-13">13</a></sup></h2>
<p class="BodyFirst">All the tools in the world won’t help developers write code if they can’t figure out what they’re supposed to write. At some point, the developers need to learn about the system and how to put things together in order to create applications. They need documentation.</p>
<p>“Reference documentation” for Android (as for many other platforms) tends to be written by the engineers that write the APIs and underlying functionality. That is, if an engineer adds a class called Thingie, then they will (or should<sup class="FootnoteReference"><a href="#c24-footnote-14" id="c24-footnoteref-14">14</a></sup>) write some kind of overview docs for Thingie that describe what the class is for and why developers should care. The functions inside of the Thingie class will (or should) also have docs describing when and how to call those functions.</p>
<p>But reference docs get you only so far. It’s great to be able to go to the docs for, say, the Activity class and learn how to use it. But how did you learn enough to even know to look for Activity? What developers really need, especially for a new platform like Android, is some higher-level documentation, <span epub:type="pagebreak" id="Page_243" title="243"/>giving an overview and teaching the fundamentals. What is this platform? How do we write apps for it? Where is sample code that we can look at to see how it is done?</p>
<p>The Android SDK was going to launch in November of 2007. Three months before that, the team decided that they needed a tech writer and brought in Dirk Dougherty.</p>
<p>Dirk had been working at Openwave, a company that made a browser for mobile phones. A former colleague forwarded his resume to the Android team. Dirk interviewed and started a few weeks later. </p>
<p>“I came by building 44. I found my desk. It was in a conference room by the lobby, the one that later would become the arcade.<sup class="FootnoteReference"><a href="#c24-footnote-15" id="c24-footnoteref-15">15</a></sup> There were a bunch of tables stashed in there that were all empty. I didn’t know what was going on, or if I was in the right place. Eventually, in came Jason, Dan, Dick, David, and Quang, who were starting up what would become the DevRel<sup class="FootnoteReference"><a href="#c24-footnote-16" id="c24-footnoteref-16">16</a></sup> team. We all moved in there and started learning about the platform. Someone drew a countdown calendar on our whiteboard with the number of days until the SDK launch, and right from then we started pushing toward the launch.”</p>
<p>Dirk and the DevRel team pulled together the pieces that the SDK needed. “The first year was just constantly sprinting to get the website up, to get the basic documentation in place. It was mostly reference docs and tooling, combined with a few guides and API tutorials. We had ongoing preview releases and SDK updates as the platform stabilized. With the Developer Challenge and the intense developer interest, we needed to expand the docs. I got help from an external writer I’d worked with,<sup class="FootnoteReference"><a href="#c24-footnote-17" id="c24-footnoteref-17">17</a></sup> who partnered with me to write the Android fundamentals docs, explaining how all this <span epub:type="pagebreak" id="Page_244" title="244"/>stuff worked. A few months later, we got more reinforcements as another internal writer joined the effort, Scott Main. We spent all of our time creating the fundamentals to go around the reference docs, and then bringing up the website. The engineering team gave us tons of support along the way. Getting things off the ground was a total team effort.”<sup class="FootnoteReference"><a href="#c24-footnote-18" id="c24-footnoteref-18">18</a></sup></p>
</section>
<section class="footnotes">
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-1" id="c24-footnote-1">1.</a></sup>  There is a famous video you can find online of Steve Ballmer (then Microsoft CEO) saying “Developers!” over and over while pacing energetically back and forth across the stage at a Microsoft conference many years ago. On one hand, the video is a quirky piece of tech history (and a meme in the industry). On the other hand, he wasn’t wrong. For companies like Microsoft, and projects like Android, it really is all about the developers that write applications for your platform.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-2" id="c24-footnote-2">2.</a></sup>  “Hello World!” is the canonical first application that a developer writes. It’s an application that does pretty much nothing except print “Hello, World!” to the user, announcing its presence. 
Sure, programmers could have come up with something more interesting as an initial proof of existence. Maybe it could compute digits of pi or draw a picture. But apparently saying Hello is the pinnacle of achievement for developers. Maybe it’s based on a life growing up in dark computer science labs, where the opportunity to say “hello” to actual humans is limited, and therefore exciting.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-3" id="c24-footnote-3">3.</a></sup>  NinePatch images allow for better-looking scaled images by defining areas of the image that should and should not be scaled when the image changes size. For example, the rounded corners of a button should generally retain their absolute size regardless of the size of the button, whereas the interior background of that button should scale to the new size. Android eventually offered vector image formats years later, which have mostly supplanted NinePatch.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-4" id="c24-footnote-4">4.</a></sup>  DDMS = Dalvik Debug Monitor Server. DDMS talked to the Dalvik runtime to get a connection to other services on the device.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-5" id="c24-footnote-5">5.</a></sup>  A starter project at Google is something that a new employee is generally given that allows them to ease into development in their area. It’s usually a small-ish project that won’t make them dive in so deeply that they’ll get lost, and which they can finish up soon to have a sense of accomplishment. Starter projects weren’t really a thing on Android. There was too much to do, so new people basically dove in deep and kept getting deeper.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-6" id="c24-footnote-6">6.</a></sup>  A breakpoint is a marker set in a debugger at a particular line in the code. When the application gets to that line during execution, it pauses and allows the developer to use the debugger to see current values of variables and the state of the program overall.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-7" id="c24-footnote-7">7.</a></sup>  Later, as the team got closer to shipping 1.0, devices were still hard to come by, since the platform and the device hardware were being developed simultaneously.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-8" id="c24-footnote-8">8.</a></sup>  TrueType was a font format created by Apple in the late 1980s.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-9" id="c24-footnote-9">9.</a></sup>  Although Java is the main programming language for Android applications, there is also quite a bit of code inside of Android itself that is written in C++, C, and even assembly.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-10" id="c24-footnote-10">10.</a></sup>  BSD = Berkeley Software Distribution, an early Unix OS with permissive licensing.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-11" id="c24-footnote-11">11.</a></sup>  Global variables are ones that can be accessed from anywhere in the code (as opposed to variables that are more “tightly scoped” and can be used only in more limited areas). Globals provide an easy way to share information across an entire source base, but can cause problems, especially as the code grows and multiple developers contribute to it, because it is difficult to reason about who is accessing what when. So global variables tend to be frowned on for real-world code, especially for large, multi-person projects.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-12" id="c24-footnote-12">12.</a></sup>  More recently, the emulator has taken advantage of the CPU and GPU on the host computer to improve both boot and runtime performance.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-13" id="c24-footnote-13">13.</a></sup>  A common developer acronym for “Read the F-ing Manual,” RTFM is typically used when an engineer is asked a question that could easily have been answered by the questioner had they bothered to read the documentation. 
Have I mentioned that engineers don’t get into computers because of their people skills?</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-14" id="c24-footnote-14">14.</a></sup>  Of course, there were many exceptions to that rule, especially for early-Android APIs. There were many classes in Android that lived for years in the public API with no documentation at all.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-15" id="c24-footnote-15">15.</a></sup>  At one point, building 44 had a video game arcade, which held machines that some of the engineers owned, plus a few that Android bought to fill out the set. It was kind of amazing to have classic arcade games sitting there waiting for people to play them. But they spent more time waiting than being played; there was work to do.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-16" id="c24-footnote-16">16.</a></sup>  <em>DevRel</em> is short for <em>Developer Relations</em>, which is the team that does most of the outreach to (and from) external developers, with materials like documentation, samples, videos, conference talks, and articles. At the time, the Android DevRel team was Jason Chen, Dan Morrill, Dick Wall, David McLaughlin, and Quang Nguyen.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-17" id="c24-footnote-17">17.</a></sup>  Don Larkin, who had worked at NeXT Computer, Be, and (with Dirk) Openwave.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c24-footnoteref-18" id="c24-footnote-18">18.</a></sup>  The website was <em>code.google.com/android</em> at the time (now defunct). The developer documentation now lives at <a class="LinkURL" href="https://developer.android.com">https://developer.android.com</a>.</p></aside>
</section>
</body>
</html>