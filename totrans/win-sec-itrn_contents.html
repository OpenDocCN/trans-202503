<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" epub:prefix="index: http://www.index.com/" xml:lang="en" lang="en">
<head>
<title></title>
<link href="../styles/stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="sbo-rt-content"><section aria-labelledby="cont" epub:type="toc" role="doc-toc">
<hgroup>
<h1 class="FMH" id="cont"><span aria-label=" Page xi. " epub:type="pagebreak" id="pg_xi" role="doc-pagebreak"></span><samp class="SANS_Dogma_OT_Bold_B_11">CONTENTS IN DETAIL</samp></h1>
</hgroup>
<ol class="toc">
<li class="TOCChapter"><a href="title.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">TITLE PAGE</samp></a></li>
<li class="TOCChapter"><a href="copyright.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">COPYRIGHT</samp></a></li>
<li class="TOCChapter"><a href="dedication.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">DEDICATION</samp></a></li>
<li class="TOCChapter"><a href="abouttheauthor.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">ABOUT THE AUTHOR AND TECHNICAL REVIEWER</samp></a></li>
<li class="TOCChapter"><a href="foreword.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">FOREWORD</samp></a></li>
<li class="TOCChapter"><a href="acknowledgments.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">ACKNOWLEDGMENTS</samp></a></li>
<li class="TOCChapter"><a href="introduction.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">INTRODUCTION</samp></a></li>
<li class="TOCHeadA"><a href="introduction.xhtml#h1-2"><samp class="SANS_Futura_Std_Book_11">Who Is This Book For?</samp></a></li>
<li class="TOCHeadA"><a href="introduction.xhtml#h1-3"><samp class="SANS_Futura_Std_Book_11">What Is in This Book?</samp></a></li>
<li class="TOCHeadA"><a href="introduction.xhtml#h1-4"><samp class="SANS_Futura_Std_Book_11">PowerShell Conventions Used in This Book</samp></a></li>
<li class="TOCHeadA"><a href="introduction.xhtml#h1-5"><samp class="SANS_Futura_Std_Book_11">Getting in Touch</samp></a></li>
<li class="TOCPart"><a href="part1.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">PART I: AN OVERVIEW OF THE WINDOWS OPERATING SYSTEM</samp></a></li>
<li class="TOCChapter"><a href="chapter1.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">1<br/>SETTING UP A POWERSHELL TESTING ENVIRONMENT</samp></a></li>
<li class="TOCHeadA"><a href="chapter1.xhtml#h1-6"><samp class="SANS_Futura_Std_Book_11">Choosing a PowerShell Version</samp></a></li>
<li class="TOCHeadA"><a href="chapter1.xhtml#h1-7"><samp class="SANS_Futura_Std_Book_11">Configuring PowerShell</samp></a></li>
<li class="TOCHeadA"><a href="chapter1.xhtml#h1-8"><samp class="SANS_Futura_Std_Book_11">An Overview of the PowerShell Language</samp></a></li>
<li class="TOCHeadB"><a href="chapter1.xhtml#h2-1"><samp class="SANS_Futura_Std_Book_11">Understanding Types, Variables, and Expressions</samp></a></li>
<li class="TOCHeadB"><a href="chapter1.xhtml#h2-2"><samp class="SANS_Futura_Std_Book_11">Executing Commands</samp></a></li>
<li class="TOCHeadB"><a href="chapter1.xhtml#h2-3"><samp class="SANS_Futura_Std_Book_11">Discovering Commands and Getting Help</samp></a></li>
<li class="TOCHeadB"><a href="chapter1.xhtml#h2-4"><samp class="SANS_Futura_Std_Book_11">Defining Functions</samp></a></li>
<li class="TOCHeadB"><a href="chapter1.xhtml#h2-5"><samp class="SANS_Futura_Std_Book_11">Displaying and Manipulating Objects</samp></a></li>
<li class="TOCHeadB"><a href="chapter1.xhtml#h2-6"><samp class="SANS_Futura_Std_Book_11">Filtering, Ordering, and Grouping Objects</samp></a></li>
<li class="TOCHeadB"><a href="chapter1.xhtml#h2-7"><samp class="SANS_Futura_Std_Book_11">Exporting Data</samp></a></li>
<li class="TOCHeadA"><a href="chapter1.xhtml#h1-9"><samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp></a></li>
<li class="TOCChapter"><a href="chapter2.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">2<br/>THE WINDOWS KERNEL</samp></a></li>
<li class="TOCHeadA"><a href="chapter2.xhtml#h1-10"><samp class="SANS_Futura_Std_Book_11">The Windows Kernel Executive</samp></a></li>
<li class="TOCHeadA"><a href="chapter2.xhtml#h1-11"><samp class="SANS_Futura_Std_Book_11">The Security Reference Monitor</samp></a></li>
<li class="TOCHeadA"><a href="chapter2.xhtml#h1-12"><samp class="SANS_Futura_Std_Book_11">The Object Manager</samp></a></li>
<li class="TOCHeadB"><a href="chapter2.xhtml#h2-8"><samp class="SANS_Futura_Std_Book_11">Object Types</samp></a></li>
<li class="TOCHeadB"><a href="chapter2.xhtml#h2-9"><samp class="SANS_Futura_Std_Book_11">The Object Manager Namespace</samp></a></li>
<li class="TOCHeadB"><a href="chapter2.xhtml#h2-10"><samp class="SANS_Futura_Std_Book_11">System Calls</samp></a></li>
<li class="TOCHeadB"><a href="chapter2.xhtml#h2-11"><samp class="SANS_Futura_Std_Book_11">NTSTATUS Codes</samp></a></li>
<li class="TOCHeadB"><a href="chapter2.xhtml#h2-12"><samp class="SANS_Futura_Std_Book_11">Object Handles</samp></a></li>
<li class="TOCHeadB"><a href="chapter2.xhtml#h2-13"><samp class="SANS_Futura_Std_Book_11">Query and Set Information System Calls</samp></a></li>
<li class="TOCHeadA"><a href="chapter2.xhtml#h1-13"><samp class="SANS_Futura_Std_Book_11">The Input/Output Manager</samp></a></li>
<li class="TOCHeadA"><a href="chapter2.xhtml#h1-14"><samp class="SANS_Futura_Std_Book_11">The Process and Thread Manager</samp></a></li>
<li class="TOCHeadA"><a href="chapter2.xhtml#h1-15"><samp class="SANS_Futura_Std_Book_11">The Memory Manager</samp></a></li>
<li class="TOCHeadB"><a href="chapter2.xhtml#h2-14"><samp class="SANS_Futura_Std_Book_11">NtVirtualMemory Commands</samp></a></li>
<li class="TOCHeadB"><a href="chapter2.xhtml#h2-15"><samp class="SANS_Futura_Std_Book_11">Section Objects</samp></a></li>
<li class="TOCHeadA"><span aria-label=" Page xii. " epub:type="pagebreak" id="pg_xii" role="doc-pagebreak"></span><a href="chapter2.xhtml#h1-16"><samp class="SANS_Futura_Std_Book_11">Code Integrity</samp></a></li>
<li class="TOCHeadA"><a href="chapter2.xhtml#h1-17"><samp class="SANS_Futura_Std_Book_11">Advanced Local Procedure Call</samp></a></li>
<li class="TOCHeadA"><a href="chapter2.xhtml#h1-18"><samp class="SANS_Futura_Std_Book_11">The Configuration Manager</samp></a></li>
<li class="TOCHeadA"><a href="chapter2.xhtml#h1-19"><samp class="SANS_Futura_Std_Book_11">Worked Examples</samp></a></li>
<li class="TOCHeadB"><a href="chapter2.xhtml#h2-16"><samp class="SANS_Futura_Std_Book_11">Finding Open Handles by Name</samp></a></li>
<li class="TOCHeadB"><a href="chapter2.xhtml#h2-17"><samp class="SANS_Futura_Std_Book_11">Finding Shared Objects</samp></a></li>
<li class="TOCHeadB"><a href="chapter2.xhtml#h2-18"><samp class="SANS_Futura_Std_Book_11">Modifying a Mapped Section</samp></a></li>
<li class="TOCHeadB"><a href="chapter2.xhtml#h2-19"><samp class="SANS_Futura_Std_Book_11">Finding Writable and Executable Memory</samp></a></li>
<li class="TOCHeadA"><a href="chapter2.xhtml#h1-20"><samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp></a></li>
<li class="TOCChapter"><a href="chapter3.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">3<br/>USER-MODE APPLICATIONS</samp></a></li>
<li class="TOCHeadA"><a href="chapter3.xhtml#h1-21"><samp class="SANS_Futura_Std_Book_11">Win32 and the User-Mode Windows APIs</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-20"><samp class="SANS_Futura_Std_Book_11">Loading a New Library</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-21"><samp class="SANS_Futura_Std_Book_11">Viewing Imported APIs</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-22"><samp class="SANS_Futura_Std_Book_11">Searching for DLLs</samp></a></li>
<li class="TOCHeadA"><a href="chapter3.xhtml#h1-22"><samp class="SANS_Futura_Std_Book_11">The Win32 GUI</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-23"><samp class="SANS_Futura_Std_Book_11">GUI Kernel Resources</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-24"><samp class="SANS_Futura_Std_Book_11">Window Messages</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-25"><samp class="SANS_Futura_Std_Book_11">Console Sessions</samp></a></li>
<li class="TOCHeadA"><a href="chapter3.xhtml#h1-23"><samp class="SANS_Futura_Std_Book_11">Comparing Win32 APIs and System Calls</samp></a></li>
<li class="TOCHeadA"><a href="chapter3.xhtml#h1-24"><samp class="SANS_Futura_Std_Book_11">Win32 Registry Paths</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-26"><samp class="SANS_Futura_Std_Book_11">Opening Keys</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-27"><samp class="SANS_Futura_Std_Book_11">Listing the Registry’s Contents</samp></a></li>
<li class="TOCHeadA"><a href="chapter3.xhtml#h1-25"><samp class="SANS_Futura_Std_Book_11">DOS Device Paths</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-28"><samp class="SANS_Futura_Std_Book_11">Path Types</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-29"><samp class="SANS_Futura_Std_Book_11">Maximum Path Lengths</samp></a></li>
<li class="TOCHeadA"><a href="chapter3.xhtml#h1-26"><samp class="SANS_Futura_Std_Book_11">Process Creation</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-30"><samp class="SANS_Futura_Std_Book_11">Command Line Parsing</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-31"><samp class="SANS_Futura_Std_Book_11">Shell APIs</samp></a></li>
<li class="TOCHeadA"><a href="chapter3.xhtml#h1-27"><samp class="SANS_Futura_Std_Book_11">System Processes</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-32"><samp class="SANS_Futura_Std_Book_11">The Session Manager</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-33"><samp class="SANS_Futura_Std_Book_11">The Windows Logon Process</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-34"><samp class="SANS_Futura_Std_Book_11">The Local Security Authority Subsystem</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-35"><samp class="SANS_Futura_Std_Book_11">The Service Control Manager</samp></a></li>
<li class="TOCHeadA"><a href="chapter3.xhtml#h1-28"><samp class="SANS_Futura_Std_Book_11">Worked Examples</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-36"><samp class="SANS_Futura_Std_Book_11">Finding Executables That Import Specific APIs</samp></a></li>
<li class="TOCHeadB"><a href="chapter3.xhtml#h2-37"><samp class="SANS_Futura_Std_Book_11">Finding Hidden Registry Keys or Values</samp></a></li>
<li class="TOCHeadA"><a href="chapter3.xhtml#h1-29"><samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp></a></li>
<li class="TOCPart"><a href="part2.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">PART II: THE WINDOWS SECURITY REFERENCE MONITOR</samp></a></li>
<li class="TOCChapter"><a href="chapter4.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">4</samp><br/><samp class="SANS_Futura_Std_Bold_B_11">SECURITY ACCESS TOKENS</samp></a></li>
<li class="TOCHeadA"><a href="chapter4.xhtml#h1-30"><samp class="SANS_Futura_Std_Book_11">Primary Tokens</samp></a></li>
<li class="TOCHeadA"><a href="chapter4.xhtml#h1-31"><samp class="SANS_Futura_Std_Book_11">Impersonation Tokens</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-38"><samp class="SANS_Futura_Std_Book_11">Security Quality of Service</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-39"><samp class="SANS_Futura_Std_Book_11">Explicit Token Impersonation</samp></a></li>
<li class="TOCHeadA"><span aria-label=" Page xiii. " epub:type="pagebreak" id="pg_xiii" role="doc-pagebreak"></span><a href="chapter4.xhtml#h1-32"><samp class="SANS_Futura_Std_Book_11">Converting Between Token Types</samp></a></li>
<li class="TOCHeadA"><a href="chapter4.xhtml#h1-33"><samp class="SANS_Futura_Std_Book_11">Pseudo Token Handles</samp></a></li>
<li class="TOCHeadA"><a href="chapter4.xhtml#h1-34"><samp class="SANS_Futura_Std_Book_11">Token Groups</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-40"><samp class="SANS_Futura_Std_Book_11">Enabled, EnabledByDefault, and Mandatory</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-41"><samp class="SANS_Futura_Std_Book_11">LogonId</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-42"><samp class="SANS_Futura_Std_Book_11">Owner</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-43"><samp class="SANS_Futura_Std_Book_11">UseForDenyOnly</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-44"><samp class="SANS_Futura_Std_Book_11">Integrity and IntegrityEnabled</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-45"><samp class="SANS_Futura_Std_Book_11">Resource</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-46"><samp class="SANS_Futura_Std_Book_11">Device Groups</samp></a></li>
<li class="TOCHeadA"><a href="chapter4.xhtml#h1-35"><samp class="SANS_Futura_Std_Book_11">Privileges</samp></a></li>
<li class="TOCHeadA"><a href="chapter4.xhtml#h1-36"><samp class="SANS_Futura_Std_Book_11">Sandbox Tokens</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-47"><samp class="SANS_Futura_Std_Book_11">Restricted Tokens</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-48"><samp class="SANS_Futura_Std_Book_11">Write-Restricted Tokens</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-49"><samp class="SANS_Futura_Std_Book_11">AppContainer and Lowbox Tokens</samp></a></li>
<li class="TOCHeadA"><a href="chapter4.xhtml#h1-37"><samp class="SANS_Futura_Std_Book_11">What Makes an Administrator User?</samp></a></li>
<li class="TOCHeadA"><a href="chapter4.xhtml#h1-38"><samp class="SANS_Futura_Std_Book_11">User Account Control</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-50"><samp class="SANS_Futura_Std_Book_11">Linked Tokens and Elevation Type</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-51"><samp class="SANS_Futura_Std_Book_11">UI Access</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-52"><samp class="SANS_Futura_Std_Book_11">Virtualization</samp></a></li>
<li class="TOCHeadA"><a href="chapter4.xhtml#h1-39"><samp class="SANS_Futura_Std_Book_11">Security Attributes</samp></a></li>
<li class="TOCHeadA"><a href="chapter4.xhtml#h1-40"><samp class="SANS_Futura_Std_Book_11">Creating Tokens</samp></a></li>
<li class="TOCHeadA"><a href="chapter4.xhtml#h1-41"><samp class="SANS_Futura_Std_Book_11">Token Assignment</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-53"><samp class="SANS_Futura_Std_Book_11">Assigning a Primary Token</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-54"><samp class="SANS_Futura_Std_Book_11">Assigning an Impersonation Token</samp></a></li>
<li class="TOCHeadA"><a href="chapter4.xhtml#h1-42"><samp class="SANS_Futura_Std_Book_11">Worked Examples</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-55"><samp class="SANS_Futura_Std_Book_11">Finding UI Access Processes</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-56"><samp class="SANS_Futura_Std_Book_11">Finding Token Handles to Impersonate</samp></a></li>
<li class="TOCHeadB"><a href="chapter4.xhtml#h2-57"><samp class="SANS_Futura_Std_Book_11">Removing Administrator Privileges</samp></a></li>
<li class="TOCHeadA"><a href="chapter4.xhtml#h1-43"><samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp></a></li>
<li class="TOCChapter"><a href="chapter5.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">5<br/>SECURITY DESCRIPTORS</samp></a></li>
<li class="TOCHeadA"><a href="chapter5.xhtml#h1-44"><samp class="SANS_Futura_Std_Book_11">The Structure of a Security Descriptor</samp></a></li>
<li class="TOCHeadA"><a href="chapter5.xhtml#h1-45"><samp class="SANS_Futura_Std_Book_11">The Structure of a SID</samp></a></li>
<li class="TOCHeadA"><a href="chapter5.xhtml#h1-46"><samp class="SANS_Futura_Std_Book_11">Absolute and Relative Security Descriptors</samp></a></li>
<li class="TOCHeadA"><a href="chapter5.xhtml#h1-47"><samp class="SANS_Futura_Std_Book_11">Access Control List Headers and Entries</samp></a></li>
<li class="TOCHeadB"><a href="chapter5.xhtml#h2-58"><samp class="SANS_Futura_Std_Book_11">The Header</samp></a></li>
<li class="TOCHeadB"><a href="chapter5.xhtml#h2-59"><samp class="SANS_Futura_Std_Book_11">The ACE List</samp></a></li>
<li class="TOCHeadA"><a href="chapter5.xhtml#h1-48"><samp class="SANS_Futura_Std_Book_11">Constructing and Manipulating Security Descriptors</samp></a></li>
<li class="TOCHeadB"><a href="chapter5.xhtml#h2-60"><samp class="SANS_Futura_Std_Book_11">Creating a New Security Descriptor</samp></a></li>
<li class="TOCHeadB"><a href="chapter5.xhtml#h2-61"><samp class="SANS_Futura_Std_Book_11">Ordering the ACEs</samp></a></li>
<li class="TOCHeadB"><a href="chapter5.xhtml#h2-62"><samp class="SANS_Futura_Std_Book_11">Formatting Security Descriptors</samp></a></li>
<li class="TOCHeadB"><a href="chapter5.xhtml#h2-63"><samp class="SANS_Futura_Std_Book_11">Converting to and from a Relative Security Descriptor</samp></a></li>
<li class="TOCHeadA"><a href="chapter5.xhtml#h1-49"><samp class="SANS_Futura_Std_Book_11">The Security Descriptor Definition Language</samp></a></li>
<li class="TOCHeadA"><a href="chapter5.xhtml#h1-50"><samp class="SANS_Futura_Std_Book_11">Worked Examples</samp></a></li>
<li class="TOCHeadB"><a href="chapter5.xhtml#h2-64"><samp class="SANS_Futura_Std_Book_11">Manually Parsing a Binary SID</samp></a></li>
<li class="TOCHeadB"><a href="chapter5.xhtml#h2-65"><samp class="SANS_Futura_Std_Book_11">Enumerating SIDs</samp></a></li>
<li class="TOCHeadA"><a href="chapter5.xhtml#h1-51"><samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp></a></li>
<li class="TOCChapter"><span aria-label=" Page xiv. " epub:type="pagebreak" id="pg_xiv" role="doc-pagebreak"></span><a href="chapter6.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">6<br/>READING AND ASSIGNING SECURITY DESCRIPTORS</samp></a></li>
<li class="TOCHeadA"><a href="chapter6.xhtml#h1-52"><samp class="SANS_Futura_Std_Book_11">Reading Security Descriptors</samp></a></li>
<li class="TOCHeadA"><a href="chapter6.xhtml#h1-53"><samp class="SANS_Futura_Std_Book_11">Assigning Security Descriptors</samp></a></li>
<li class="TOCHeadB"><a href="chapter6.xhtml#h2-66"><samp class="SANS_Futura_Std_Book_11">Assigning a Security Descriptor During Resource Creation</samp></a></li>
<li class="TOCHeadB"><a href="chapter6.xhtml#h2-67"><samp class="SANS_Futura_Std_Book_11">Assigning a Security Descriptor to an Existing Resource</samp></a></li>
<li class="TOCHeadA"><a href="chapter6.xhtml#h1-54"><samp class="SANS_Futura_Std_Book_11">Win32 Security APIs</samp></a></li>
<li class="TOCHeadA"><a href="chapter6.xhtml#h1-55"><samp class="SANS_Futura_Std_Book_11">Server Security Descriptors and Compound ACEs</samp></a></li>
<li class="TOCHeadA"><a href="chapter6.xhtml#h1-56"><samp class="SANS_Futura_Std_Book_11">A Summary of Inheritance Behavior</samp></a></li>
<li class="TOCHeadA"><a href="chapter6.xhtml#h1-57"><samp class="SANS_Futura_Std_Book_11">Worked Examples</samp></a></li>
<li class="TOCHeadB"><a href="chapter6.xhtml#h2-68"><samp class="SANS_Futura_Std_Book_11">Finding Object Manager Resource Owners</samp></a></li>
<li class="TOCHeadB"><a href="chapter6.xhtml#h2-69"><samp class="SANS_Futura_Std_Book_11">Changing the Ownership of a Resource</samp></a></li>
<li class="TOCHeadA"><a href="chapter6.xhtml#h1-58"><samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp></a></li>
<li class="TOCChapter"><a href="chapter7.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">7<br/>THE ACCESS CHECK PROCESS</samp></a></li>
<li class="TOCHeadA"><a href="chapter7.xhtml#h1-59"><samp class="SANS_Futura_Std_Book_11">Running an Access Check</samp></a></li>
<li class="TOCHeadB"><a href="chapter7.xhtml#h2-70"><samp class="SANS_Futura_Std_Book_11">Kernel-Mode Access Checks</samp></a></li>
<li class="TOCHeadB"><a href="chapter7.xhtml#h2-71"><samp class="SANS_Futura_Std_Book_11">User-Mode Access Checks</samp></a></li>
<li class="TOCHeadB"><a href="chapter7.xhtml#h2-72"><samp class="SANS_Futura_Std_Book_11">The Get-NtGrantedAccess PowerShell Command</samp></a></li>
<li class="TOCHeadA"><a href="chapter7.xhtml#h1-60"><samp class="SANS_Futura_Std_Book_11">The Access Check Process in PowerShell</samp></a></li>
<li class="TOCHeadB"><a href="chapter7.xhtml#h2-73"><samp class="SANS_Futura_Std_Book_11">Defining the Access Check Function</samp></a></li>
<li class="TOCHeadB"><a href="chapter7.xhtml#h2-74"><samp class="SANS_Futura_Std_Book_11">Performing the Mandatory Access Check</samp></a></li>
<li class="TOCHeadB"><a href="chapter7.xhtml#h2-75"><samp class="SANS_Futura_Std_Book_11">Performing the Token Access Check</samp></a></li>
<li class="TOCHeadB"><a href="chapter7.xhtml#h2-76"><samp class="SANS_Futura_Std_Book_11">Performing the Discretionary Access Check</samp></a></li>
<li class="TOCHeadA"><a href="chapter7.xhtml#h1-61"><samp class="SANS_Futura_Std_Book_11">Sandboxing</samp></a></li>
<li class="TOCHeadB"><a href="chapter7.xhtml#h2-77"><samp class="SANS_Futura_Std_Book_11">Restricted Tokens</samp></a></li>
<li class="TOCHeadB"><a href="chapter7.xhtml#h2-78"><samp class="SANS_Futura_Std_Book_11">Lowbox Tokens</samp></a></li>
<li class="TOCHeadA"><a href="chapter7.xhtml#h1-62"><samp class="SANS_Futura_Std_Book_11">Enterprise Access Checks</samp></a></li>
<li class="TOCHeadB"><a href="chapter7.xhtml#h2-79"><samp class="SANS_Futura_Std_Book_11">The Object Type Access Check</samp></a></li>
<li class="TOCHeadB"><a href="chapter7.xhtml#h2-80"><samp class="SANS_Futura_Std_Book_11">The Central Access Policy</samp></a></li>
<li class="TOCHeadA"><a href="chapter7.xhtml#h1-63"><samp class="SANS_Futura_Std_Book_11">Worked Examples</samp></a></li>
<li class="TOCHeadB"><a href="chapter7.xhtml#h2-81"><samp class="SANS_Futura_Std_Book_11">Using the Get-PSGrantedAccess Command</samp></a></li>
<li class="TOCHeadB"><a href="chapter7.xhtml#h2-82"><samp class="SANS_Futura_Std_Book_11">Calculating Granted Access for Resources</samp></a></li>
<li class="TOCHeadA"><a href="chapter7.xhtml#h1-64"><samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp></a></li>
<li class="TOCChapter"><a href="chapter8.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">8<br/>OTHER ACCESS CHECKING USE CASES</samp></a></li>
<li class="TOCHeadA"><a href="chapter8.xhtml#h1-65"><samp class="SANS_Futura_Std_Book_11">Traversal Checking</samp></a></li>
<li class="TOCHeadB"><a href="chapter8.xhtml#h2-83"><samp class="SANS_Futura_Std_Book_11">The SeChangeNotifyPrivilege Privilege</samp></a></li>
<li class="TOCHeadB"><a href="chapter8.xhtml#h2-84"><samp class="SANS_Futura_Std_Book_11">Limited Checks</samp></a></li>
<li class="TOCHeadA"><a href="chapter8.xhtml#h1-66"><samp class="SANS_Futura_Std_Book_11">Handle Duplication Access Checks</samp></a></li>
<li class="TOCHeadA"><a href="chapter8.xhtml#h1-67"><samp class="SANS_Futura_Std_Book_11">Sandbox Token Checks</samp></a></li>
<li class="TOCHeadA"><a href="chapter8.xhtml#h1-68"><samp class="SANS_Futura_Std_Book_11">Automating Access Checks</samp></a></li>
<li class="TOCHeadA"><a href="chapter8.xhtml#h1-69"><samp class="SANS_Futura_Std_Book_11">Worked Examples</samp></a></li>
<li class="TOCHeadB"><a href="chapter8.xhtml#h2-85"><samp class="SANS_Futura_Std_Book_11">Simplifying an Access Check for an Object</samp></a></li>
<li class="TOCHeadB"><a href="chapter8.xhtml#h2-86"><samp class="SANS_Futura_Std_Book_11">Finding Writable Section Objects</samp></a></li>
<li class="TOCHeadA"><a href="chapter8.xhtml#h1-70"><samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp></a></li>
<li class="TOCChapter"><span aria-label=" Page xv. " epub:type="pagebreak" id="pg_xv" role="doc-pagebreak"></span><a href="chapter9.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">9</samp><br/><samp class="SANS_Futura_Std_Bold_B_11">SECURITY AUDITING</samp></a></li>
<li class="TOCHeadA"><a href="chapter9.xhtml#h1-71"><samp class="SANS_Futura_Std_Book_11">The Security Event Log</samp></a></li>
<li class="TOCHeadB"><a href="chapter9.xhtml#h2-87"><samp class="SANS_Futura_Std_Book_11">Configuring the System Audit Policy</samp></a></li>
<li class="TOCHeadB"><a href="chapter9.xhtml#h2-88"><samp class="SANS_Futura_Std_Book_11">Configuring the Per-User Audit Policy</samp></a></li>
<li class="TOCHeadA"><a href="chapter9.xhtml#h1-72"><samp class="SANS_Futura_Std_Book_11">Audit Policy Security</samp></a></li>
<li class="TOCHeadB"><a href="chapter9.xhtml#h2-89"><samp class="SANS_Futura_Std_Book_11">Configuring the Resource SACL</samp></a></li>
<li class="TOCHeadB"><a href="chapter9.xhtml#h2-90"><samp class="SANS_Futura_Std_Book_11">Configuring the Global SACL</samp></a></li>
<li class="TOCHeadA"><a href="chapter9.xhtml#h1-73"><samp class="SANS_Futura_Std_Book_11">Worked Examples</samp></a></li>
<li class="TOCHeadB"><a href="chapter9.xhtml#h2-91"><samp class="SANS_Futura_Std_Book_11">Verifying Audit Access Security</samp></a></li>
<li class="TOCHeadB"><a href="chapter9.xhtml#h2-92"><samp class="SANS_Futura_Std_Book_11">Finding Resources with Audit ACEs</samp></a></li>
<li class="TOCHeadA"><a href="chapter9.xhtml#h1-74"><samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp></a></li>
<li class="TOCPart"><a href="part3.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">PART III: THE LOCAL SECURITY AUTHORITY AND AUTHENTICATION</samp></a></li>
<li class="TOCChapter"><a href="chapter10.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">10<br/>WINDOWS AUTHENTICATION</samp></a></li>
<li class="TOCHeadA"><a href="chapter10.xhtml#h1-75"><samp class="SANS_Futura_Std_Book_11">Domain Authentication</samp></a></li>
<li class="TOCHeadB"><a href="chapter10.xhtml#h2-93"><samp class="SANS_Futura_Std_Book_11">Local Authentication</samp></a></li>
<li class="TOCHeadB"><a href="chapter10.xhtml#h2-94"><samp class="SANS_Futura_Std_Book_11">Enterprise Network Domains</samp></a></li>
<li class="TOCHeadB"><a href="chapter10.xhtml#h2-95"><samp class="SANS_Futura_Std_Book_11">Domain Forests</samp></a></li>
<li class="TOCHeadA"><a href="chapter10.xhtml#h1-76"><samp class="SANS_Futura_Std_Book_11">Local Domain Configuration</samp></a></li>
<li class="TOCHeadB"><a href="chapter10.xhtml#h2-96"><samp class="SANS_Futura_Std_Book_11">The User Database</samp></a></li>
<li class="TOCHeadB"><a href="chapter10.xhtml#h2-97"><samp class="SANS_Futura_Std_Book_11">The LSA Policy Database</samp></a></li>
<li class="TOCHeadA"><a href="chapter10.xhtml#h1-77"><samp class="SANS_Futura_Std_Book_11">Remote LSA Services</samp></a></li>
<li class="TOCHeadB"><a href="chapter10.xhtml#h2-98"><samp class="SANS_Futura_Std_Book_11">The SAM Remote Service</samp></a></li>
<li class="TOCHeadB"><a href="chapter10.xhtml#h2-99"><samp class="SANS_Futura_Std_Book_11">The Domain Policy Remote Service</samp></a></li>
<li class="TOCHeadA"><a href="chapter10.xhtml#h1-78"><samp class="SANS_Futura_Std_Book_11">The SAM and SECURITY Databases</samp></a></li>
<li class="TOCHeadB"><a href="chapter10.xhtml#h2-100"><samp class="SANS_Futura_Std_Book_11">Accessing the SAM Database Through the Registry</samp></a></li>
<li class="TOCHeadB"><a href="chapter10.xhtml#h2-101"><samp class="SANS_Futura_Std_Book_11">Inspecting the SECURITY Database</samp></a></li>
<li class="TOCHeadA"><a href="chapter10.xhtml#h1-79"><samp class="SANS_Futura_Std_Book_11">Worked Examples</samp></a></li>
<li class="TOCHeadB"><a href="chapter10.xhtml#h2-102"><samp class="SANS_Futura_Std_Book_11">RID Cycling</samp></a></li>
<li class="TOCHeadB"><a href="chapter10.xhtml#h2-103"><samp class="SANS_Futura_Std_Book_11">Forcing a User‘s Password Change</samp></a></li>
<li class="TOCHeadB"><a href="chapter10.xhtml#h2-104"><samp class="SANS_Futura_Std_Book_11">Extracting All Local User Hashes</samp></a></li>
<li class="TOCHeadA"><a href="chapter10.xhtml#h1-80"><samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp></a></li>
<li class="TOCChapter"><a href="chapter11.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">11<br/>ACTIVE DIRECTORY</samp></a></li>
<li class="TOCHeadA"><a href="chapter11.xhtml#h1-81"><samp class="SANS_Futura_Std_Book_11">A Brief History of Active Directory</samp></a></li>
<li class="TOCHeadA"><a href="chapter11.xhtml#h1-82"><samp class="SANS_Futura_Std_Book_11">Exploring an Active Directory Domain with PowerShell</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-105"><samp class="SANS_Futura_Std_Book_11">The Remote Server Administration Tools</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-106"><samp class="SANS_Futura_Std_Book_11">Basic Forest and Domain Information</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-107"><samp class="SANS_Futura_Std_Book_11">The Users</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-108"><samp class="SANS_Futura_Std_Book_11">The Groups</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-109"><samp class="SANS_Futura_Std_Book_11">The Computers</samp></a></li>
<li class="TOCHeadA"><span aria-label=" Page xvi. " epub:type="pagebreak" id="pg_xvi" role="doc-pagebreak"></span><a href="chapter11.xhtml#h1-83"><samp class="SANS_Futura_Std_Book_11">Objects and Distinguished Names</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-110"><samp class="SANS_Futura_Std_Book_11">Enumerating Directory Objects</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-111"><samp class="SANS_Futura_Std_Book_11">Accessing Objects in Other Domains</samp></a></li>
<li class="TOCHeadA"><a href="chapter11.xhtml#h1-84"><samp class="SANS_Futura_Std_Book_11">The Schema</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-112"><samp class="SANS_Futura_Std_Book_11">Inspecting the Schema</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-113"><samp class="SANS_Futura_Std_Book_11">Accessing the Security Attributes</samp></a></li>
<li class="TOCHeadA"><a href="chapter11.xhtml#h1-85"><samp class="SANS_Futura_Std_Book_11">Security Descriptors</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-114"><samp class="SANS_Futura_Std_Book_11">Querying Security Descriptors of Directory Objects</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-115"><samp class="SANS_Futura_Std_Book_11">Assigning Security Descriptors to New Directory Objects</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-116"><samp class="SANS_Futura_Std_Book_11">Assigning Security Descriptors to Existing Objects</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-117"><samp class="SANS_Futura_Std_Book_11">Inspecting a Security Descriptor’s Inherited Security</samp></a></li>
<li class="TOCHeadA"><a href="chapter11.xhtml#h1-86"><samp class="SANS_Futura_Std_Book_11">Access Checks</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-118"><samp class="SANS_Futura_Std_Book_11">Creating Objects</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-119"><samp class="SANS_Futura_Std_Book_11">Deleting Objects</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-120"><samp class="SANS_Futura_Std_Book_11">Listing Objects</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-121"><samp class="SANS_Futura_Std_Book_11">Reading and Writing Attributes</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-122"><samp class="SANS_Futura_Std_Book_11">Checking Multiple Attributes</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-123"><samp class="SANS_Futura_Std_Book_11">Analyzing Property Sets</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-124"><samp class="SANS_Futura_Std_Book_11">Inspecting Control Access Rights</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-125"><samp class="SANS_Futura_Std_Book_11">Analyzing Write-Validated Access Rights</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-126"><samp class="SANS_Futura_Std_Book_11">Accessing the SELF SID</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-127"><samp class="SANS_Futura_Std_Book_11">Performing Additional Security Checks</samp></a></li>
<li class="TOCHeadA"><a href="chapter11.xhtml#h1-87"><samp class="SANS_Futura_Std_Book_11">Claims and Central Access Policies</samp></a></li>
<li class="TOCHeadA"><a href="chapter11.xhtml#h1-88"><samp class="SANS_Futura_Std_Book_11">Group Policies</samp></a></li>
<li class="TOCHeadA"><a href="chapter11.xhtml#h1-89"><samp class="SANS_Futura_Std_Book_11">Worked Example</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-128"><samp class="SANS_Futura_Std_Book_11">Building the Authorization Context</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-129"><samp class="SANS_Futura_Std_Book_11">Gathering Object Information</samp></a></li>
<li class="TOCHeadB"><a href="chapter11.xhtml#h2-130"><samp class="SANS_Futura_Std_Book_11">Running the Access Check</samp></a></li>
<li class="TOCHeadA"><a href="chapter11.xhtml#h1-90"><samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp></a></li>
<li class="TOCChapter"><a href="chapter12.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">12<br/>INTERACTIVE AUTHENTICATION</samp></a></li>
<li class="TOCHeadA"><a href="chapter12.xhtml#h1-91"><samp class="SANS_Futura_Std_Book_11">Creating a User’s Desktop</samp></a></li>
<li class="TOCHeadA"><a href="chapter12.xhtml#h1-92"><samp class="SANS_Futura_Std_Book_11">The LsaLogonUser API</samp></a></li>
<li class="TOCHeadB"><a href="chapter12.xhtml#h2-131"><samp class="SANS_Futura_Std_Book_11">Local Authentication</samp></a></li>
<li class="TOCHeadB"><a href="chapter12.xhtml#h2-132"><samp class="SANS_Futura_Std_Book_11">Domain Authentication</samp></a></li>
<li class="TOCHeadB"><a href="chapter12.xhtml#h2-133"><samp class="SANS_Futura_Std_Book_11">Logon and Console Sessions</samp></a></li>
<li class="TOCHeadB"><a href="chapter12.xhtml#h2-134"><samp class="SANS_Futura_Std_Book_11">Token Creation</samp></a></li>
<li class="TOCHeadA"><a href="chapter12.xhtml#h1-93"><samp class="SANS_Futura_Std_Book_11">Using the LsaLogonUser API from PowerShell</samp></a></li>
<li class="TOCHeadA"><a href="chapter12.xhtml#h1-94"><samp class="SANS_Futura_Std_Book_11">Creating a New Process with a Token</samp></a></li>
<li class="TOCHeadA"><a href="chapter12.xhtml#h1-95"><samp class="SANS_Futura_Std_Book_11">The Service Logon Type</samp></a></li>
<li class="TOCHeadA"><a href="chapter12.xhtml#h1-96"><samp class="SANS_Futura_Std_Book_11">Worked Examples</samp></a></li>
<li class="TOCHeadB"><a href="chapter12.xhtml#h2-135"><samp class="SANS_Futura_Std_Book_11">Testing Privileges and Logon Account Rights</samp></a></li>
<li class="TOCHeadB"><a href="chapter12.xhtml#h2-136"><samp class="SANS_Futura_Std_Book_11">Creating a Process in a Different Console Session</samp></a></li>
<li class="TOCHeadB"><a href="chapter12.xhtml#h2-137"><samp class="SANS_Futura_Std_Book_11">Authenticating Virtual Accounts</samp></a></li>
<li class="TOCHeadA"><a href="chapter12.xhtml#h1-97"><samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp></a></li>
<li class="TOCChapter"><a href="chapter13.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">13<br/>NETWORK AUTHENTICATION</samp></a></li>
<li class="TOCHeadA"><a href="chapter13.xhtml#h1-98"><samp class="SANS_Futura_Std_Book_11">NTLM Network Authentication</samp></a></li>
<li class="TOCHeadB"><a href="chapter13.xhtml#h2-138"><samp class="SANS_Futura_Std_Book_11">NTLM Authentication Using PowerShell</samp></a></li>
<li class="TOCHeadB"><a href="chapter13.xhtml#h2-139"><samp class="SANS_Futura_Std_Book_11">The Cryptographic Derivation Process</samp></a></li>
<li class="TOCHeadB"><span aria-label=" Page xvii. " epub:type="pagebreak" id="pg_xvii" role="doc-pagebreak"></span><a href="chapter13.xhtml#h2-140"><samp class="SANS_Futura_Std_Book_11">Pass-Through Authentication</samp></a></li>
<li class="TOCHeadB"><a href="chapter13.xhtml#h2-141"><samp class="SANS_Futura_Std_Book_11">Local Loopback Authentication</samp></a></li>
<li class="TOCHeadB"><a href="chapter13.xhtml#h2-142"><samp class="SANS_Futura_Std_Book_11">Alternative Client Credentials</samp></a></li>
<li class="TOCHeadA"><a href="chapter13.xhtml#h1-99"><samp class="SANS_Futura_Std_Book_11">The NTLM Relay Attack</samp></a></li>
<li class="TOCHeadB"><a href="chapter13.xhtml#h2-143"><samp class="SANS_Futura_Std_Book_11">Attack Overview</samp></a></li>
<li class="TOCHeadB"><a href="chapter13.xhtml#h2-144"><samp class="SANS_Futura_Std_Book_11">Active Server Challenges</samp></a></li>
<li class="TOCHeadB"><a href="chapter13.xhtml#h2-145"><samp class="SANS_Futura_Std_Book_11">Signing and Sealing</samp></a></li>
<li class="TOCHeadB"><a href="chapter13.xhtml#h2-146"><samp class="SANS_Futura_Std_Book_11">Target Names</samp></a></li>
<li class="TOCHeadB"><a href="chapter13.xhtml#h2-147"><samp class="SANS_Futura_Std_Book_11">Channel Binding</samp></a></li>
<li class="TOCHeadA"><a href="chapter13.xhtml#h1-100"><samp class="SANS_Futura_Std_Book_11">Worked Example</samp></a></li>
<li class="TOCHeadB"><a href="chapter13.xhtml#h2-148"><samp class="SANS_Futura_Std_Book_11">Overview</samp></a></li>
<li class="TOCHeadB"><a href="chapter13.xhtml#h2-149"><samp class="SANS_Futura_Std_Book_11">The Code Module</samp></a></li>
<li class="TOCHeadB"><a href="chapter13.xhtml#h2-150"><samp class="SANS_Futura_Std_Book_11">The Server Implementation</samp></a></li>
<li class="TOCHeadB"><a href="chapter13.xhtml#h2-151"><samp class="SANS_Futura_Std_Book_11">The Client Implementation</samp></a></li>
<li class="TOCHeadB"><a href="chapter13.xhtml#h2-152"><samp class="SANS_Futura_Std_Book_11">The NTLM Authentication Test</samp></a></li>
<li class="TOCHeadA"><a href="chapter13.xhtml#h1-101"><samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp></a></li>
<li class="TOCChapter"><a href="chapter14.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">14<br/>KERBEROS</samp></a></li>
<li class="TOCHeadA"><a href="chapter14.xhtml#h1-102"><samp class="SANS_Futura_Std_Book_11">Interactive Authentication with Kerberos</samp></a></li>
<li class="TOCHeadB"><a href="chapter14.xhtml#h2-153"><samp class="SANS_Futura_Std_Book_11">Initial User Authentication</samp></a></li>
<li class="TOCHeadB"><a href="chapter14.xhtml#h2-154"><samp class="SANS_Futura_Std_Book_11">Network Service Authentication</samp></a></li>
<li class="TOCHeadA"><a href="chapter14.xhtml#h1-103"><samp class="SANS_Futura_Std_Book_11">Performing Kerberos Authentication in PowerShell</samp></a></li>
<li class="TOCHeadA"><a href="chapter14.xhtml#h1-104"><samp class="SANS_Futura_Std_Book_11">Decrypting the AP-REQ Message</samp></a></li>
<li class="TOCHeadA"><a href="chapter14.xhtml#h1-105"><samp class="SANS_Futura_Std_Book_11">Decrypting the AP-REP Message</samp></a></li>
<li class="TOCHeadA"><a href="chapter14.xhtml#h1-106"><samp class="SANS_Futura_Std_Book_11">Cross-Domain Authentication</samp></a></li>
<li class="TOCHeadA"><a href="chapter14.xhtml#h1-107"><samp class="SANS_Futura_Std_Book_11">Kerberos Delegation</samp></a></li>
<li class="TOCHeadB"><a href="chapter14.xhtml#h2-155"><samp class="SANS_Futura_Std_Book_11">Unconstrained Delegation</samp></a></li>
<li class="TOCHeadB"><a href="chapter14.xhtml#h2-156"><samp class="SANS_Futura_Std_Book_11">Constrained Delegation</samp></a></li>
<li class="TOCHeadA"><a href="chapter14.xhtml#h1-108"><samp class="SANS_Futura_Std_Book_11">User-to-User Kerberos Authentication</samp></a></li>
<li class="TOCHeadA"><a href="chapter14.xhtml#h1-109"><samp class="SANS_Futura_Std_Book_11">Worked Examples</samp></a></li>
<li class="TOCHeadB"><a href="chapter14.xhtml#h2-157"><samp class="SANS_Futura_Std_Book_11">Querying the Kerberos Ticket Cache</samp></a></li>
<li class="TOCHeadB"><a href="chapter14.xhtml#h2-158"><samp class="SANS_Futura_Std_Book_11">Simple Kerberoasting</samp></a></li>
<li class="TOCHeadA"><a href="chapter14.xhtml#h1-110"><samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp></a></li>
<li class="TOCChapter"><a href="chapter15.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">15<br/>NEGOTIATE AUTHENTICATION AND OTHER SECURITY PACKAGES</samp></a></li>
<li class="TOCHeadA"><a href="chapter15.xhtml#h1-111"><samp class="SANS_Futura_Std_Book_11">Security Buffers</samp></a></li>
<li class="TOCHeadB"><a href="chapter15.xhtml#h2-159"><samp class="SANS_Futura_Std_Book_11">Using Buffers with an Authentication Context</samp></a></li>
<li class="TOCHeadB"><a href="chapter15.xhtml#h2-160"><samp class="SANS_Futura_Std_Book_11">Using Buffers with Signing and Sealing</samp></a></li>
<li class="TOCHeadA"><a href="chapter15.xhtml#h1-112"><samp class="SANS_Futura_Std_Book_11">The Negotiate Protocol</samp></a></li>
<li class="TOCHeadA"><a href="chapter15.xhtml#h1-113"><samp class="SANS_Futura_Std_Book_11">Less Common Security Packages</samp></a></li>
<li class="TOCHeadB"><a href="chapter15.xhtml#h2-161"><samp class="SANS_Futura_Std_Book_11">Secure Channel</samp></a></li>
<li class="TOCHeadB"><a href="chapter15.xhtml#h2-162"><samp class="SANS_Futura_Std_Book_11">CredSSP</samp></a></li>
<li class="TOCHeadA"><a href="chapter15.xhtml#h1-114"><samp class="SANS_Futura_Std_Book_11">Remote Credential Guard and Restricted Admin Mode</samp></a></li>
<li class="TOCHeadA"><a href="chapter15.xhtml#h1-115"><samp class="SANS_Futura_Std_Book_11">The Credential Manager</samp></a></li>
<li class="TOCHeadA"><a href="chapter15.xhtml#h1-116"><samp class="SANS_Futura_Std_Book_11">Additional Request Attribute Flags</samp></a></li>
<li class="TOCHeadB"><a href="chapter15.xhtml#h2-163"><samp class="SANS_Futura_Std_Book_11">Anonymous Sessions</samp></a></li>
<li class="TOCHeadB"><a href="chapter15.xhtml#h2-164"><samp class="SANS_Futura_Std_Book_11">Identity Tokens</samp></a></li>
<li class="TOCHeadA"><span aria-label=" Page xviii. " epub:type="pagebreak" id="pg_xviii" role="doc-pagebreak"></span><a href="chapter15.xhtml#h1-117"><samp class="SANS_Futura_Std_Book_11">Network Authentication with a Lowbox Token</samp></a></li>
<li class="TOCHeadB"><a href="chapter15.xhtml#h2-165"><samp class="SANS_Futura_Std_Book_11">Authentication with the Enterprise Authentication Capability</samp></a></li>
<li class="TOCHeadB"><a href="chapter15.xhtml#h2-166"><samp class="SANS_Futura_Std_Book_11">Authentication to a Known Web Proxy</samp></a></li>
<li class="TOCHeadB"><a href="chapter15.xhtml#h2-167"><samp class="SANS_Futura_Std_Book_11">Authentication with Explicit Credentials</samp></a></li>
<li class="TOCHeadA"><a href="chapter15.xhtml#h1-118"><samp class="SANS_Futura_Std_Book_11">The Authentication Audit Event Log</samp></a></li>
<li class="TOCHeadA"><a href="chapter15.xhtml#h1-119"><samp class="SANS_Futura_Std_Book_11">Worked Examples</samp></a></li>
<li class="TOCHeadB"><a href="chapter15.xhtml#h2-168"><samp class="SANS_Futura_Std_Book_11">Identifying the Reason for an Authentication Failure</samp></a></li>
<li class="TOCHeadB"><a href="chapter15.xhtml#h2-169"><samp class="SANS_Futura_Std_Book_11">Using a Secure Channel to Extract a Server’s TLS Certificate</samp></a></li>
<li class="TOCHeadA"><a href="chapter15.xhtml#h1-120"><samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp></a></li>
<li class="TOCHeadA"><a href="chapter15.xhtml#h1-121"><samp class="SANS_Futura_Std_Book_11">Final Thoughts</samp></a></li>
<li class="TOCChapter"><a href="appendix-A.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">A<br/>BUILDING A WINDOWS DOMAIN NETWORK FOR TESTING</samp></a></li>
<li class="TOCHeadA"><a href="appendix-A.xhtml#h1-122"><samp class="SANS_Futura_Std_Book_11">The Domain Network</samp></a></li>
<li class="TOCHeadA"><a href="appendix-A.xhtml#h1-123"><samp class="SANS_Futura_Std_Book_11">Installing and Configuring Windows Hyper-V</samp></a></li>
<li class="TOCHeadA"><a href="appendix-A.xhtml#h1-124"><samp class="SANS_Futura_Std_Book_11">Creating the Virtual Machines</samp></a></li>
<li class="TOCHeadB"><a href="appendix-A.xhtml#h2-170"><samp class="SANS_Futura_Std_Book_11">The PRIMARYDC Server</samp></a></li>
<li class="TOCHeadB"><a href="appendix-A.xhtml#h2-171"><samp class="SANS_Futura_Std_Book_11">The GRAPHITE Workstation</samp></a></li>
<li class="TOCHeadB"><a href="appendix-A.xhtml#h2-172"><samp class="SANS_Futura_Std_Book_11">The SALESDC Server</samp></a></li>
<li class="TOCChapter"><a href="appendix-B.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">B<br/>SDDL SID ALIAS MAPPING</samp></a></li>
<li class="TOCChapter"><a href="index.xhtml"><samp class="SANS_Futura_Std_Bold_B_11">INDEX</samp></a></li>
</ol>
</section>
</div></body>
</html>