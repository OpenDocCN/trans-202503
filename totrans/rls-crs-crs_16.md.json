["```\n {\n   \"login\": \"rails\",\n➊  \"id\": 4223,\n➋  \"url\": \"https://api.github.com/orgs/rails\",\n   \"repos_url\": \"https://api.github.com/orgs/rails/repos\",\n   \"events_url\": \"https://api.github.com/orgs/rails/events\",\n   \"members_url\": \"https://api.github.com/orgs/rails/me...\",\n   \"public_members_url\": \"https://api.github.com/orgs/r...\",\n   \"avatar_url\": \"https://avatars.githubusercontent.com...\",\n   \"name\": \"Ruby on Rails\",\n   \"company\": null,\n   \"blog\": \"http://weblog.rubyonrails.org/\",\n   \"location\": null,\n   \"email\": null,\n   \"public_repos\": 73,\n   \"public_gists\": 3,\n   \"followers\": 2,\n   \"following\": 0,\n   \"html_url\": \"https://github.com/rails\",\n➌  \"created_at\": \"2008-04-02T01:59:25Z\",\n➍  \"updated_at\": \"2014-04-13T20:24:49Z\",\n   \"type\": \"Organization\"\n}\n```", "```\n$ **curl https://api.github.com/users/anthonylewis**\n{\n  \"login\": \"anthonylewis\",\n  \"id\": 301,\n  *--snip--*\n}\n```", "```\n  $ **curl -i https://api.github.com/users/anthonylewis**\n➊ HTTP/1.1 200 OK\n  Server: GitHub.com\n  Date: Thu, 17 Apr 2014 00:36:29 GMT\n  Content-Type: application/json; charset=utf-8\n  Status: 200 OK\n➋ X-RateLimit-Limit: 60\n  X-RateLimit-Remaining: 58\n➌ X-RateLimit-Reset: 1397696651\n  *--snip--*\n\n  {\n   \"login\": \"anthonylewis\",\n   \"id\": 301,\n   *--snip--*\n  }\n```", "```\n$ **curl -H \"Authorization: Token *token*\" https://api.github.com/user**\n{\n  \"login\": \"anthonylewis\",\n  \"id\": 301,\n  *--snip--*\n```", "```\n$ **curl -H \"Authorization: Token *token*\" https://api.github.com/user/repos**\n[\n  {\n    \"id\": 6289476,\n    \"name\": \"blog\",\n    \"full_name\": \"anthonylewis/blog\",\n    \"owner\": {\n      \"login\": \"anthonylewis\",\n      \"id\": 301,\n      *--snip--*\n```", "```\n➊ $ **curl -i -d '{\"name\":\"API Test\"}' \\**\n         **-H \"Authorization: Token *token*\" \\**\n         **https://api.github.com/user/repos**\n➋ HTTP/1.1 201 Created\n  Server: GitHub.com\n  Date: Mon, 21 Apr 2014 23:47:59 GMT\n  Content-Type: application/json; charset=utf-8\n  Status: 201 Created\n  *--snip---*\n➌ {\n    \"id\": 18862420,\n    \"name\": \"API-Test\",\n    \"full_name\": \"anthonylewis/API-Test\",\n    \"owner\": {\n      \"login\": \"anthonylewis\",\n    \"id\": 301,\n  *--snip--*\n```", "```\n  Social::Application.routes.draw do\n  *--snip--*\n\n➊   **namespace :api do**\n      **resources :posts**\n    **end**\n  end\n```", "```\n$ **mkdir app/controllers/api**\n```", "```\n  **module Api**\n    **class PostsController < ApplicationController**\n➊   **respond_to :json**\n\n➋   **def index**\n      **@posts = Post.all**\n➌     **respond_with @posts**\n    **end**\n  **end**\n**end**\n```", "```\n$ **curl http://localhost:3000/api/posts**\n[{\"id\":1,\"title\":\"First Post\",\"body\":\"Hello, World!\"...\n```", "```\n$ **curl http://localhost:3000/api/posts | jq '.'**\n[\n  {\n   \"id\": 1,\n   \"title\": \"First Post\",\n   \"body\": \"Hello, World!\",\n   \"url\":null,\n   \"user_id\":1,\n   *--snip--*\n```", "```\n  class Post < ActiveRecord::Base\n    *--snip--*\n\n➊   **def as_json(options={})**\n➋     **super(only: [:id, :title])**\n    **end**\n\n    *--snip--*\n  end\n```", "```\n$ **curl http://localhost:3000/api/posts**\n[\n  {\"id\": 1, \"title\": \"First Post\"},\n  {\"id\": 2, \"title\": \"Google Search\"}\n]\n```", "```\ndef as_json(options={})\n  **super(except: [:user_id], include: :user)**\nend\n```", "```\ndef as_json(options={})\n  **super(except: [:user_id], include: :user,**\n    **methods: :cached_comment_count)**\nend\n```", "```\n$ **mkdir app/views/api**\n$ **mkdir app/views/api/posts**\n```", "```\n**json.array! @posts**\n```", "```\n$ **curl http://localhost:3000/api/posts**\n[\n  {\n    \"id\": 1,\n    \"title\": \"First Post\",\n    \"body\": \"Hello, World!\",\n    \"url\":null,\n    \"user_id\":1,\n    *--snip--*\n```", "```\n**json.array! @posts do |post|**\n  **json.extract! post, :id, :title, :body, :url**\n**end**\n```", "```\n  json.array! @posts do |post|\n    json.extract! post, :id, :title, :body, :url\n➊   **json.post_url api_post_url(post)**\nend\n```", "```\njson.array! @posts do |post|\n  json.extract! post, :id, :title, :body, :url\n  json.post_url api_post_url(post)\n\n  **json.user do**\n    **json.extract! post.user, :id, :name, :email**\n  **end**\nend\n```", "```\n$ **bin/rails g migration add_api_token_to_users api_token:string**\n```", "```\n   class User < ActiveRecord::Base\n     *--snip--*\n\n➊    **validates :api_token, presence: true, uniqueness: true**\n\n➋    **before_validation :generate_api_token**\n\n     *--snip--*\n```", "```\n  class User < ActiveRecord::Base\n\n    *--snip--*\n\n    **def generate_api_token**\n➊     **return if api_token.present?**\n\n      **loop do**\n➋       **self.api_token = SecureRandom.hex**\n➌       **break unless User.exists? api_token: api_token**\n      **end**\n    **end**\n\n  end\n```", "```\n➊ irb(main):001:0> **user = User.first**\n    User Load (0.2ms) SELECT \"users\".* ...\n  => #<User id: 1, ... api_token: nil>\n➋ irb(main):002:0> **user.save**\n     (0.1ms) begin transaction\n    User Exists (0.2ms) SELECT 1 AS one FROM ...\n    User Exists (0.1ms) SELECT 1 AS one FROM ...\n    User Exists (0.1ms) SELECT 1 AS one FROM ...\n    SQL (1.3ms) UPDATE \"users\" SET \"api_token\" ...\n     (1.7ms)  commit transaction\n  => true\n```", "```\n  <div class=\"page-header\">\n    <h1>User</h1>\n  </div>\n\n  <p class=\"lead\"><%= @user.email %></p>\n\n➊ **<% if @user == current_user %>**\n    **<p class=\"lead\">API Token: <%= @user.api_token %></p>**\n  **<% end %>**\n\n*--snip--*\n```", "```\n  class ApplicationController < ActionController::Base\n    # Prevent CSRF attacks by raising an exception.\n    # For APIs, you may want to use :null_session instead.\n    protect_from_forgery with: :exception\n\n    private\n\n    **def authenticate_token!**\n      **authenticate_or_request_with_http_token do |token, options|**\n➊       **@api_user = User.find_by(api_token: token)**\n      **end**\n    **end**\n\n    *--snip--*\n```", "```\nSocial::Application.routes.draw do\n*--snip--*\n\n  namespace :api do u\n    resources :posts\n    **resources :text_posts**\n  end\nend\n```", "```\n  **module Api**\n    **class TextPostsController < ApplicationController**\n      **respond_to :json**\n➊     **before_action :authenticate_token!**\n\n    **end**\n  **end**\n```", "```\n  module Api\n    class TextPostsController < ApplicationController\n      respond_to :json\n      before_action :authenticate_token!\n➊   **def create**\n      **@text_post = @api_user.text_posts.create(text_post_params)**\n      **respond_with @text_post**\n    **end**\n  end\nend\n```", "```\n  module Api\n    class TextPostsController < ApplicationController\n      before_action :authenticate_token!\n\n      respond_to :json\n\n      def create\n        @text_post = @api_user.text_posts.build(text_post_params)\n        respond_with @text_post\n      end\n\n     **private**\n\n➊    **def text_post_params**\n       **params.require(:text_post).permit(:title, :body)**\n     **end**\n  end\nend\n```", "```\n  **$ curl -i \\**\n       **-d '{\"text_post\":{\"title\":\"Test\",\"body\":\"Hello\"}}' \\**\n       **-H \"Content-Type: application/json\" \\**\n       **-H \"Authorization: Token *token*\" \\**\n       **http://localhost:3000/api/text_posts**\n1 HTTP/1.1 422 Unprocessable Entity\n*--snip--*\n```", "```\n  Started POST \"/api/text_posts\" for 127.0.0.1 at 2014-04-23 19:39:09 -0500\n  Processing by Api::TextPostsController#create as */*\n    Parameters: {\"text_post\"=>{\"title\"=>\"Test\", \"body\"=>\"Hello\"}}\n➊ Can't verify CSRF token authenticity\n  Completed 422 Unprocessable Entity in 1ms\n\n--*snip*--\n```", "```\n  class ApplicationController < ActionController::Base\n    # Prevent CSRF attacks by raising an exception.\n    # For APIs, you may want to use :null_session instead.\n➊   **protect_from_forgery with: :null_session**\n\n    *--snip--*\n```", "```\n  **$ curl -i \\**\n         **-d '{\"text_post\":{\"title\":\"Test\",\"body\":\"Hello\"}}' \\**\n         **-H \"Content-Type: application/json\" \\**\n         **-H \"Authorization: Token *token*\" \\**\n         **http://localhost:3000/api/text_posts**\n➊ HTTP/1.1 201 Created\n  *--snip--*\n➋ {\n    \"id\":5,\n    \"title\":\"Test\",\n    \"body\":\"Hello\",\n    \"url\":null,\n    \"user_id\":1,\n    \"created_at\":\"2014-04-24T00:33:35.874Z\",\n    \"updated_at\":\"2014-04-24T00:33:35.874Z\"\n  }\n```"]