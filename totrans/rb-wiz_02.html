<html><head></head><body>
  <div class="chapter" title="Chapter&#xA0;3.&#xA0;Pipe Dreams">&#13;
    <div class="titlepage">&#13;
      <h1 class="title" id="heading_id_2"><a id="pipe_dreams"/>Chapter 3. Pipe Dreams</h1>&#13;
    </div>&#13;
&#13;
    <div class="sect1" title="The Apprentice Plumber’s Dilemma">&#13;
      <div class="titlepage">&#13;
        <h1 class="title" id="heading_id_3"><a id="apprentice_plumberapostrophes_dilemma"/>The Apprentice Plumber’s Dilemma</h1>&#13;
      </div>&#13;
&#13;
      <p><a class="indexterm" id="iddle1817"/>The King, Scarlet, and Ruben made their way back from the Royal Bathroom, the King gleefully batting his string about like a big, beardy cat.</p>&#13;
&#13;
      <p>“All those waterworks for a string in a shower!” Scarlet said to the King. “I hope you’re feeling better now.”</p>&#13;
&#13;
      <p>“Much,” said the King, spinning the beads and trinkets on his string every which way.</p>&#13;
&#13;
      <p>“Speaking of waterworks,” said Ruben, “do you hear that?” And as they rounded the corner and reentered the King’s study, they found themselves ankle-deep in a miniature lake. There was water, water everywhere!</p>&#13;
&#13;
      <p><a class="indexterm" id="iddle1138"/><a class="indexterm" id="iddle1311"/><a class="indexterm" id="iddle1892"/>“The Mysterious Pipe!” cried the King. “Look!” And he pointed to the Mysterious Pipe, which was shaking violently and gushing a surprising amount of water from its narrow top.</p>&#13;
&#13;
      <div class="informalfigure">&#13;
        <a id="med_id00014a"/>&#13;
&#13;
        <div class="mediaobject"><a id="med_id00014"/><img alt="image with no caption" src="../Images/httpatomoreillycomsourcenostarchimages2159983.png.jpg"/></div>&#13;
      </div>&#13;
&#13;
      <p>“Check out the Flowmatic Something-or-Other!” said the King.</p>&#13;
&#13;
      <p>“That’s not terribly descriptive,” Ruben said.</p>&#13;
&#13;
      <p>“No, that’s what it’s called,” said the King. “The Flowmatic Something-or-Other™.”</p>&#13;
&#13;
      <p>“Found it!” said Scarlet, grabbing a square metal box labeled <span class="smaller">HIS MAJESTY</span>’<span class="smaller">S</span> <span class="smaller">FLOWMATIC SOMETHING-OR-OTHER™</span> on the back of the Pipe. She pried open the cover of the Flowmatic Something-or-Other to find a miniature Computing Contraption with its glowing <code class="literal">&gt;&gt;</code> IRB prompt.</p>&#13;
&#13;
      <p>“What do I do?” Scarlet asked the King.</p>&#13;
&#13;
      <p>“I seem to recall this program uses a <code class="literal">flowmatic_on</code> variable,” the King said. “Try turning it off.” He paused a moment. “Hey! I remembered the stuff we learned about variables!”</p>&#13;
&#13;
      <p>Scarlet flashed the King a thumbs-up, typed at the prompt, and pressed <span class="smaller">ENTER</span>:</p><a id="pro_id00047"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">flowmatic_on = false</span></strong></span>&#13;
=&gt; false&#13;
</pre>&#13;
&#13;
      <p>The Mysterious Pipe shuddered once and sputtered, and the water stopped flowing.</p>&#13;
&#13;
      <p>“Whew!” said Ruben. “Nice work!” He peered over Scarlet’s shoulder at the screen. “How’d you do that? What’s <code class="literal">false</code>? It can’t be a string; there are no quotes around it. Is it also a variable?”</p>&#13;
&#13;
      <p>“Nope!” said Scarlet. “But it’s built into Ruby just like numbers, strings, and variables are. It’s called a <span class="emphasis"><em>Boolean</em></span>, and there are actually two of them: <code class="literal">true</code> and <code class="literal">false</code>. It looks like the Mysterious Pipe works when <code class="literal">flowmatic_on</code> is <code class="literal">true</code> and shuts off when it’s <code class="literal">false</code>.”</p>&#13;
&#13;
      <p><a class="indexterm" id="iddle1767"/><a class="indexterm" id="iddle1789"/>“Then how was <code class="literal">flowmatic_on true</code> before?” Ruben asked.</p>&#13;
&#13;
      <p>“I don’t know!” said Scarlet. “Someone or something must have created that variable.”</p>&#13;
&#13;
      <p>“Well, it’s stopped leaking,” said the King, “but it’s not really fixed. It should work correctly even when <code class="literal">flowmatic_on</code> is <code class="literal">true</code>! After all, the Flowmatic supplies all the water to the castle; without it, there can be no Royal Baths, Royal Toothbrushings, or Royal Water Balloon Fights! We need the Mysterious Pipe and its Flowmatic to be on without leaking all over the place.”</p>&#13;
&#13;
      <p>“What about this?” Ruben said, pointing to a line on the Computing Contraption just below the Flowmatic’s on/off control:</p><a id="pro_id00048"/>&#13;
      <pre class="programlisting">&#13;
Warning! flow_rate is above 50!&#13;
</pre>&#13;
&#13;
      <p>“The water must be coming into the Mysterious Pipe too fast,” said Scarlet.</p>&#13;
&#13;
      <p>“Gadzooks!” said the King. “The flow rate must be above 50!”</p>&#13;
&#13;
      <p>“What should we do?” asked Ruben.</p>&#13;
&#13;
      <p>The King thought for a minute. “I think it’s best that we do what should always be done in these situations,” he said. “We should call a professional. In this case, the Royal Plumber!”</p>&#13;
    </div>&#13;
&#13;
    <div class="sect1" title="Writing and Running Ruby Scripts">&#13;
      <div class="titlepage">&#13;
        <h1 class="title" id="heading_id_4"><a id="writing_and_running_ruby_scripts"/>Writing and Running Ruby Scripts</h1>&#13;
      </div>&#13;
&#13;
      <p>While the King calls the Royal Plumber, I’ll take a second to explain some more Ruby magic to you. Don’t worry, it won’t take but a minute.</p>&#13;
&#13;
      <div class="informalfigure">&#13;
        <a id="med_id00015a"/>&#13;
&#13;
        <div class="mediaobject"><a id="med_id00015"/><img alt="image with no caption" src="../Images/httpatomoreillycomsourcenostarchimages2159985.png.jpg"/></div>&#13;
      </div>&#13;
&#13;
      <p>You see, you don’t always have to type commands into IRB one at a time. As mentioned in <a class="xref" href="../Text/ch01.html" title="Chapter 1. What This Book’s About">Chapter 1</a>, you can write a big block of Ruby code and save it as a Ruby <span class="emphasis"><em>script</em></span>. Then, you can run your Ruby script in IRB! (This is a lot like running your code in the terminal with the <code class="literal">ruby</code> command, as we did in <a class="xref" href="../Text/ch01.html" title="Chapter 1. What This Book’s About">Chapter 1</a>, but IRB will stay open the whole time.) Just start IRB while <a class="indexterm" id="iddle1237"/><a class="indexterm" id="iddle1342"/><a class="indexterm" id="iddle1344"/><a class="indexterm" id="iddle1490"/>you’re in the folder that contains your Ruby script, then type <code class="literal">load 'filename.rb'</code>. That’s exactly the same as typing everything in the file into IRB—but this way it’s easy to make changes and try again!</p>&#13;
&#13;
      <p>Let’s try this little guy on for size. Type the following code in your favorite text editor and save it as a file called <span class="bolditalic red">flow.rb</span>. (Look back at <a class="xref" href="../Text/ch01.html" title="Chapter 1. What This Book’s About">Chapter 1</a> if you need a reminder of how to do this, and don’t worry—we’ll cover the new <code class="literal">#{}</code> syntax in two shakes of a fox’s tail.)</p>&#13;
&#13;
      <p><span class="bolditalic red">flow.rb</span></p><a id="pro_id00049"/>&#13;
      <pre class="programlisting">&#13;
flow_rate = 100&#13;
puts "The flow rate is currently #{flow_rate}."&#13;
flow_rate = 100 / 2&#13;
puts "Now the flow rate is #{flow_rate}!"&#13;
</pre>&#13;
&#13;
      <p>If you open IRB, type <span class="strong"><strong><span class="red"><code class="literal">load 'flow.rb'</code></span></strong></span>, and press <span class="smaller">ENTER</span>, you should see:</p><a id="pro_id00050"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">load 'flow.rb'</span></strong></span>&#13;
The flow rate is currently 100.&#13;
Now the flow rate is 50!&#13;
=&gt; true&#13;
</pre>&#13;
&#13;
      <p>Let’s walk through this line by line.</p>&#13;
&#13;
      <p>First, <code class="literal">load 'flow.rb'</code> (it doesn’t matter if you use single or double quotes here) tells Ruby to look for a file called <span class="emphasis"><em>flow.rb</em></span> in the current directory (a <span class="emphasis"><em>directory</em></span> is just a fancy name for a folder on your computer). If Ruby finds <span class="emphasis"><em>flow.rb</em></span> and there are no problems with the code in the file, Ruby will run that code just as if you’d typed it bit by bit into IRB. Next, you know what <code class="literal">flow_rate = 100</code> and <code class="literal">puts</code> do: the first one sets the <code class="literal">flow_rate</code> variable to the value <code class="literal">100</code>, and <code class="literal">puts</code> prints out the string you give it. (You also get a bonus <code class="literal">=&gt; true</code> from Ruby, which lets you know that loading the file worked.) But you probably want to know: what’s this crazy-looking <code class="literal">#{flow_rate}</code> business?</p>&#13;
&#13;
      <p>Well, strings and variables are different things, but sometimes you might want to combine them—say, to print out a <a class="indexterm" id="iddle1044"/><a class="indexterm" id="iddle1422"/><a class="indexterm" id="iddle1823"/><a class="indexterm" id="iddle1834"/><a class="indexterm" id="iddle1838"/>message displaying different values for the <code class="literal">flow_rate</code> variable. Rather than making us look up the value of that variable and type it into the string by hand every time we want to use it, Ruby lets us use <code class="literal">#{}</code> to say, “Hey! Just insert the value of this variable right into the string.” So when you have:</p><a id="pro_id00051"/>&#13;
      <pre class="programlisting">&#13;
flow_rate = 100&#13;
puts "The flow rate is currently #{flow_rate}."&#13;
</pre>&#13;
&#13;
      <p>you get:</p><a id="pro_id00052"/>&#13;
      <pre class="programlisting">&#13;
The flow rate is currently 100.&#13;
</pre>&#13;
&#13;
      <p>One last thing: remember in <a class="xref" href="../Text/ch02.html" title="Chapter 2. The King and His String">Chapter 2</a> when Ruben said that strings with double quotes (<code class="literal">"</code>) were very slightly different from strings with single quotes (<code class="literal">'</code>)? Well, the <code class="literal">#{}</code> magic (called <span class="emphasis"><em>string interpolation</em></span> if you want to be super fancy) is possible <span class="emphasis"><em>only</em></span> with double-quoted strings; it can’t be done with single-quoted ones. (This is precisely what the King meant in <a class="xref" href="../Text/ch02.html" title="Chapter 2. The King and His String">Chapter 2</a> when he said you could put more complicated bits and trinkets on a double-quoted string than on a single-quoted string.)</p>&#13;
&#13;
      <p>That’s really all I wanted to show you. And speaking of the King . . .</p>&#13;
    </div>&#13;
&#13;
    <div class="sect1" title="His Majesty’s Flow Control">&#13;
      <div class="titlepage">&#13;
        <h1 class="title" id="heading_id_5"><a id="his_majestyapostrophes_flow_control"/>His Majesty’s Flow Control</h1>&#13;
      </div>&#13;
&#13;
      <p>“Hello?” said the King. (He had been on hold for a while.) “Is this the Royal Plumber?”</p>&#13;
&#13;
      <p>“Chuff! Chuff! Chuff!” said the Royal Plumber.</p>&#13;
&#13;
      <div class="informalfigure">&#13;
        <a id="med_id00016a"/>&#13;
&#13;
        <div class="mediaobject"><a id="med_id00016"/><img alt="image with no caption" src="../Images/httpatomoreillycomsourcenostarchimages2159987.png.jpg"/></div>&#13;
      </div>&#13;
&#13;
      <p>“Oh dear,” said the King. “It sounds like the Royal Plumber has come down with a bad case of the Chuffs.”</p>&#13;
&#13;
      <p>“Chuffs?” said Scarlet.</p>&#13;
&#13;
      <p>“Chuff!” said the Royal Plumber.</p>&#13;
&#13;
      <p>“It’s a bit like a cold, but coughier and huffier,” said the King. “Royal Plumber, could you send down your Apprentice to help us with the Mysterious Pipe? It’s been overflowing terribly.”</p>&#13;
&#13;
      <p>“Chuff!” she said, and hung up.</p>&#13;
&#13;
      <p>“I think that was a yes,” said the King.</p>&#13;
&#13;
      <p>“I think so, too,” said Ruben. “It looks like the Apprentice is already here!”</p>&#13;
&#13;
      <p>The Apprentice to the Royal Plumber strolled into the King’s study carrying a large red toolbox. Ruben and Scarlet found his expression hard to read behind his dark rectangular sunglasses and heavy black beard. The name <span class="emphasis"><em>Haldo</em></span> was stitched in red on the front of his coveralls.</p>&#13;
&#13;
      <p>“Haldo!” said the King.</p>&#13;
&#13;
      <p>“That’s me,” said Haldo. “I hear the Mysterious Pipe is on the fritz.”</p>&#13;
&#13;
      <p>“Definitely,” said Scarlet. “Can you help us fix it?”</p>&#13;
&#13;
      <div class="informalfigure">&#13;
        <a id="med_id00017a"/>&#13;
&#13;
        <div class="mediaobject"><a id="med_id00017"/><img alt="image with no caption" src="../Images/httpatomoreillycomsourcenostarchimages2159989.png.jpg"/></div>&#13;
      </div>&#13;
&#13;
      <p>“I think so,” said Haldo, “but I’m just the Apprentice, so it may take me a little while. Let’s see what’s what.” He walked over to the Flowmatic Something-or-Other and looked at the screen for a moment. “I seem to remember there’s an <span class="emphasis"><em>instructions.rb</em></span> file in here somewhere.” He typed <code class="literal">load 'instructions.rb'</code>, and this is what came up:</p><a id="pro_id00053"/>&#13;
      <pre class="programlisting">&#13;
     |~~                                            |~~&#13;
     |                                              |&#13;
    :$: HIS MAJESTY'S FLOWMATIC SOMETHING-OR-OTHER :$:&#13;
     `'''''''''''''''''''''''''''''''''''''''''''''`&#13;
                   ~= Instructions =~&#13;
&#13;
     1. Water should flow if flowmatic_on is true and&#13;
        water_available is true.&#13;
     2. If flowmatic_on is false, the message&#13;
        "Flowmatic is off!" should appear.&#13;
     3. If water_available is false, the message&#13;
        "No water!" should appear.&#13;
     4. If the flow_rate is above 50, the warning&#13;
        "Warning! flow_rate is above 50!" should&#13;
        appear, along with the current flow rate.&#13;
     5. If the flow_rate is below 50, the warning&#13;
        "Warning! flow_rate is below 50!" should&#13;
        appear, along with the current flow rate.&#13;
=&gt; true&#13;
</pre>&#13;
&#13;
      <p>“Huh!” said Ruben. “So the problem is that if the flow rate is too high or too low, we only get a message. Ruby doesn’t automatically correct the flow rate, so we can end up with a flood.”</p>&#13;
&#13;
      <p>“We can fix that!” said Scarlet. “We’ll write a Ruby program to check the flow rate. If the flow rate is too high, we’ll lower it, and if it’s too low, we’ll increase it!”</p>&#13;
&#13;
      <p>Haldo scratched his head. “Well, here’s the thing,” he said. “I think I know what we need to do, but I haven’t learned enough Ruby to enter the right commands. If you kids can give me a hand, though, I think we’ll be in business.”</p>&#13;
&#13;
      <p>“No problem,” said Ruben. “Making a Ruby program do different actions based on different conditions is something Scarlet and I know backward and forward.”</p>&#13;
&#13;
      <p><a class="indexterm" id="iddle1001"/><a class="indexterm" id="iddle1075"/><a class="indexterm" id="iddle1212"/><a class="indexterm" id="iddle1217"/><a class="indexterm" id="iddle1261"/><a class="indexterm" id="iddle1265"/><a class="indexterm" id="iddle1272"/><a class="indexterm" id="iddle1391"/>“It’s called <span class="emphasis"><em>control flow</em></span>,” said Scarlet, “and it’s not hard at all. Take a look!” She opened a new file in her text editor on the Computing Contraption, saved it as <span class="bolditalic red">flowmatic_rules.rb</span>, and typed:</p><a id="pro_id00054"/>&#13;
      <pre class="programlisting">&#13;
flowmatic_on = true&#13;
water_available = true&#13;
if flowmatic_on &amp;&amp; water_available&#13;
  flow_rate = 50&#13;
end&#13;
</pre>&#13;
&#13;
      <p>“You’ve lost me,” said the King.</p>&#13;
&#13;
      <p>“We’ll take it slow,” said Scarlet. “First, we assign the variables <code class="literal">flowmatic_on</code> and <code class="literal">water_available</code> to <code class="literal">true</code>. Then, we have the <code class="literal">if</code>, which is a <span class="emphasis"><em>conditional</em></span>, on the second line. It means that <span class="emphasis"><em>if</em></span> the code that follows on the same line is <code class="literal">true</code>, then everything before <code class="literal">end</code> gets run.”</p>&#13;
&#13;
      <p>“And <code class="literal">&amp;&amp;</code> is just Ruby’s way of saying <span class="emphasis"><em>and</em></span>,” said Ruben. “We already know that the fourth line sets the flow rate to 50, so together, the whole thing says, ‘If <code class="literal">flowmatic_on</code> is <code class="literal">true</code> <span class="emphasis"><em>and</em></span> <code class="literal">water_available</code> is also <code class="literal">true</code>, this program will set the <code class="literal">flow_rate</code> variable to <code class="literal">50</code>. <code class="literal">end</code> just tells Ruby that if we’re not setting the flow rate to 50, we shouldn’t do anything—at least, not yet.”</p>&#13;
&#13;
      <p>“I see,” said Haldo. “And that’s just the very first of the instructions! Great work. But what happens if the Flowmatic <span class="emphasis"><em>isn’t</em></span> on or there <span class="emphasis"><em>isn’t</em></span> water available?”</p>&#13;
&#13;
      <p>“Well, at the moment, nothing,” said Ruben. “But we can fix that.” He reached over and added to the <span class="emphasis"><em>flowmatic_rules.rb</em></span> code in his text editor:</p><a id="pro_id00055"/>&#13;
      <pre class="programlisting">&#13;
  flowmatic_on = true&#13;
  water_available = true&#13;
➊ if flowmatic_on &amp;&amp; water_available&#13;
    flow_rate = 50&#13;
➋ elsif !flowmatic_on&#13;
    puts "Flowmatic is off!"&#13;
➌ else&#13;
    puts "No water!"&#13;
  end&#13;
</pre>&#13;
&#13;
      <p><a class="indexterm" id="iddle1037"/><a class="indexterm" id="iddle1185"/><a class="indexterm" id="iddle1262"/><a class="indexterm" id="iddle1403"/><a class="indexterm" id="iddle1611"/>“I think I’m starting to get this,” said the King. “➊ is just what we had before. Then at ➋, we’re trying something new: <code class="literal">elsif</code>! Does <code class="literal">elsif</code> mean ‘if the first bit didn’t get run, try this next step’?”</p>&#13;
&#13;
      <p>“That’s exactly it,” said Scarlet. “Don’t worry about the weird spelling, either! It’s just a shorter way of writing ‘else, if.’ And the <code class="literal">!</code> is just Ruby’s way of saying <span class="emphasis"><em>not</em></span>. So if <code class="literal">flowmatic_on</code> happens to be <code class="literal">false</code>, <code class="literal">!flowmatic_on</code> will be <code class="literal">true</code>, and vice versa.”</p>&#13;
&#13;
      <p>“And since there’s only one condition left—if the Flowmatic <span class="emphasis"><em>is</em></span> on but there’s just no water—the program <code class="literal">puts</code> the ‘No water!’ message at ➌ using an <code class="literal">else</code>, which means: ‘If none of the other code was run, then run the code that follows,’” Ruben said.</p>&#13;
&#13;
      <div class="informalfigure">&#13;
        <a id="med_id00018a"/>&#13;
&#13;
        <div class="mediaobject"><a id="med_id00018"/><img alt="image with no caption" src="../Images/httpatomoreillycomsourcenostarchimages2159991.png.jpg"/></div>&#13;
      </div>&#13;
&#13;
      <p>“And all of that’s followed by an <code class="literal">end</code>, like before,” said Scarlet.</p>&#13;
&#13;
      <p>“Do you need to add the two spaces before the lines following <code class="literal">if</code>, <code class="literal">elsif</code>, and <code class="literal">else</code>?” asked the King.</p>&#13;
&#13;
      <p>“The <span class="emphasis"><em>indentation</em></span>?” said Scarlet. “No, but it sure does look nice.”</p>&#13;
&#13;
      <p>“That takes care of the first three instructions!” said Haldo. “And I think I’m getting the hang of this. Let’s see if I can rewrite <a class="indexterm" id="iddle1041"/><a class="indexterm" id="iddle1042"/><a class="indexterm" id="iddle1046"/><a class="indexterm" id="iddle1050"/><a class="indexterm" id="iddle1362"/><a class="indexterm" id="iddle1363"/><a class="indexterm" id="iddle1478"/><a class="indexterm" id="iddle1479"/><a class="indexterm" id="iddle1496"/>the last two instructions in Ruby.” He added these lines to his <span class="emphasis"><em>flowmatic_rules.rb</em></span> script:</p><a id="pro_id00056"/>&#13;
      <pre class="programlisting">&#13;
➍ if flow_rate &gt; 50&#13;
    puts "Warning! flow_rate is above 50! It's #{flow_rate}."&#13;
    flow_rate = 50&#13;
    puts "The flow_rate's been reset to #{flow_rate}."&#13;
➎ elsif flow_rate &lt; 50&#13;
    puts "Warning! flow_rate is below 50! It's #{flow_rate}."&#13;
    flow_rate = 50&#13;
    puts "The flow_rate's been reset to #{flow_rate}."&#13;
➏ else&#13;
    puts "The flow_rate is #{flow_rate} (thank goodness)."&#13;
  end&#13;
</pre>&#13;
&#13;
      <p>“Okay, <span class="emphasis"><em>this</em></span> I understand,” said the King. “The <code class="literal">&gt;</code> means <span class="emphasis"><em>greater than</em></span> and the <code class="literal">&lt;</code> means <span class="emphasis"><em>less than</em></span>, so that first bit at ➍ says: if the flow rate is above 50, we show a ‘too high’ warning and then assign the variable <code class="literal">flow_rate</code> to 50. The program then <code class="literal">puts</code> a new <code class="literal">flow_rate</code> value using string interpolation, like we saw before.”</p>&#13;
&#13;
      <p>“But at ➎, the program checks if <code class="literal">flow_rate</code> is below 50. If it is, we show a ‘too low’ warning and reset it to 50.</p>&#13;
&#13;
      <p>“At ➏, we have the <code class="literal">else</code>. If <code class="literal">flow_rate</code> isn’t greater than 50 or less than 50, that means it’s <span class="emphasis"><em>exactly</em></span> 50. So, we just show the flow rate without changing the variable and <code class="literal">puts</code> it (thank goodness).” The King smiled, clearly pleased with himself.</p>&#13;
&#13;
      <p>“Perfect!” said Ruben. “You can also use <code class="literal">&lt;=</code> for <span class="emphasis"><em>less than or equal to</em></span> and <code class="literal">&gt;=</code> for <span class="emphasis"><em>greater than or equal to</em></span>, but we don’t need those quite yet, I don’t think.”</p>&#13;
    </div>&#13;
&#13;
    <div class="sect1" title="Improving flow_rate.rb with Fancier Logical Operators">&#13;
      <div class="titlepage">&#13;
        <h1 class="title" id="heading_id_6"><a id="improving_flowunderscoreratedotrb_with_f"/>Improving flow_rate.rb with Fancier Logical Operators</h1>&#13;
      </div>&#13;
&#13;
      <p>Ruben studied the screen for a moment. “You know,” he said, “I think you could replace the section from ➍ to ➏ with even less code. Check this out!”</p><a id="pro_id00057"/>&#13;
      <pre class="programlisting">&#13;
if flow_rate &lt; 50 || flow_rate &gt; 50&#13;
  puts "Warning! flow_rate is not 50! It's #{flow_rate}."&#13;
  flow_rate = 50&#13;
  puts "The flow_rate's been reset to #{flow_rate}."&#13;
else&#13;
  puts "The flow_rate is #{flow_rate} (thank goodness)."&#13;
end&#13;
</pre>&#13;
&#13;
      <p><a class="indexterm" id="iddle1002"/><a class="indexterm" id="iddle1033"/><a class="indexterm" id="iddle1038"/><a class="indexterm" id="iddle1040"/><a class="indexterm" id="iddle1063"/><a class="indexterm" id="iddle1076"/><a class="indexterm" id="iddle1453"/><a class="indexterm" id="iddle1454"/><a class="indexterm" id="iddle1612"/><a class="indexterm" id="iddle1640"/>“What do those two vertical lines mean?” asked Haldo. “I haven’t seen those before.”</p>&#13;
&#13;
      <p>“Just like <code class="literal">&amp;&amp;</code> means <span class="emphasis"><em>and</em></span> and <code class="literal">!</code> means <span class="emphasis"><em>not</em></span>, <code class="literal">||</code> means <span class="emphasis"><em>or</em></span>,” said Scarlet. “So we’re saying, ‘If the flow rate is less than 50 <span class="emphasis"><em>or</em></span> it’s greater than 50, show a warning and reset it to 50; otherwise, just let us know it’s 50 (thank goodness).’</p>&#13;
&#13;
      <p>“That works pretty well,” she continued, “but we can make it even simpler.”</p><a id="pro_id00058"/>&#13;
      <pre class="programlisting">&#13;
if flow_rate != 50&#13;
  puts "Warning! flow_rate is not 50! It's #{flow_rate}."&#13;
  flow_rate = 50&#13;
  puts "The flow_rate's been reset to #{flow_rate}."&#13;
else&#13;
  puts "The flow_rate is #{flow_rate} (thank goodness)."&#13;
end&#13;
</pre>&#13;
&#13;
      <p>“I know that <code class="literal">!</code> means <span class="emphasis"><em>not</em></span>,” said the King, “so is it fair to guess that <code class="literal">!=</code> means <span class="emphasis"><em>is not equal to</em></span>?”</p>&#13;
&#13;
      <p>“It’s not only fair, it’s right!” said Ruben. “You can use <code class="literal">!=</code> to mean <span class="emphasis"><em>is not equal to</em></span> and <code class="literal">==</code> to mean <span class="emphasis"><em>is equal to</em></span>. But be <span class="emphasis"><em>really</em></span> careful not to mix up <code class="literal">=</code> and <code class="literal">==</code>. The first one is used to assign values to variables, and the second is used to check if two things are equal.”</p>&#13;
&#13;
      <p>“This is amazing,” said Haldo. “I think I’m really getting the hang of Ruby control flow. Is there anything else I should know?”</p>&#13;
&#13;
      <p>“One more quick thing,” Scarlet said. “Because <code class="literal">if</code> followed by a negative condition appears all the time in programs, Ruby <a class="indexterm" id="iddle1901"/>came up with another way to write it. Instead of always typing something like:</p><a id="pro_id00059"/>&#13;
      <pre class="programlisting">&#13;
if flow_rate != 50&#13;
  puts "Warning! flow_rate is not 50! It's #{flow_rate}."&#13;
end&#13;
</pre>&#13;
&#13;
      <p>you can instead type <code class="literal">unless</code>:</p><a id="pro_id00060"/>&#13;
      <pre class="programlisting">&#13;
unless flow_rate == 50&#13;
  puts "Warning! flow_rate is not 50! It's #{flow_rate}."&#13;
end&#13;
</pre>&#13;
&#13;
      <p>“And those two examples are exactly the same,” finished Scarlet. “But if you have <code class="literal">elsif</code>s and <code class="literal">else</code>s, it’s sometimes nicer-looking to just use <code class="literal">if</code>s.”</p>&#13;
&#13;
      <p>While Scarlet was talking, Haldo saved their finished <span class="emphasis"><em>flowmatic_rules.rb</em></span> file and typed <span class="strong"><strong><span class="red"><code class="literal">load 'flowmatic_rules.rb'</code></span></strong></span> at the IRB prompt. When he pressed <span class="smaller">ENTER</span>, the Mysterious Pipe shuddered once, then began to gently vibrate. Ruben and Scarlet could hear water flowing through the castle walls, and not a drop was spilled anywhere.</p>&#13;
&#13;
      <p>“Huzzah!” said the King. “I can’t thank you all enough! But I do wonder,” he continued, “how did the flow rate get set to 100 in the first place?”</p>&#13;
&#13;
      <p>“That, I’m not sure about,” said Haldo. “There must be another Ruby program in the castle that has access to the <code class="literal">flow_rate</code> variable and changed it.” He rummaged through his red toolbox and pulled out a flashlight. “I’ll look into it right away,” he said.</p>&#13;
&#13;
      <p>“Aren’t you going to take off your sunglasses?” asked Scarlet.</p>&#13;
&#13;
      <p>“No need,” said Haldo, and with that, he opened a small door on the same side of the room as the Mysterious Pipe and disappeared into the bowels of the castle, whistling as he went.</p>&#13;
    </div>&#13;
&#13;
    <div class="sect1" title="A Biggerish Project for You">&#13;
      <div class="titlepage">&#13;
        <h1 class="title" id="heading_id_7"><a id="biggerish_project_for_you"/>A Biggerish Project for You</h1>&#13;
      </div>&#13;
&#13;
      <p><a class="indexterm" id="iddle1514"/><a class="indexterm" id="iddle1668"/>You’ve learned a lot in the last handful of pages, and now it’s time to put your newfound knowledge to the test! (Don’t worry: I have complete and utter faith in you.) Haldo—now the <span class="emphasis"><em>Senior</em></span> Apprentice to the Royal Plumber, thanks to Ruben and Scarlet—needs your help. While he hasn’t tracked down the precise cause of the Mysterious Pipe’s overflow, he did briefly find himself in a small but tricky maze. He’s asked you to record his adventures in the maze, so let’s start by making a new file called <span class="bolditalic red">maze.rb</span>. (Peek back at <a class="xref" href="../Text/ch01.html" title="Chapter 1. What This Book’s About">Chapter 1</a> if you don’t remember how to do this, or ask your local adult for help.) Type the following into your file.</p>&#13;
&#13;
      <p><span class="bolditalic red">maze.rb</span></p><a id="pro_id00061"/>&#13;
      <pre class="programlisting">&#13;
puts "Holy giraffes! You fell into a maze!"&#13;
print "Where to? (N, E, S, W): "&#13;
direction = gets.chomp&#13;
&#13;
puts "#{direction}, you say? A fine choice!"&#13;
&#13;
if direction == "N"&#13;
  puts "You are in a maze of twisty little passages, all alike."&#13;
elsif direction == "E"&#13;
  puts "An elf! And his pet ham!"&#13;
elsif direction == "S"&#13;
  puts "A minotaur! Wait, no, that's just your reflection."&#13;
elsif direction == "W"&#13;
  puts "You're here, wherever here is."&#13;
else&#13;
  puts "Wait, is that even a direction?"&#13;
end&#13;
</pre>&#13;
&#13;
      <p>Run the program by typing <span class="strong"><strong><span class="red"><code class="literal">ruby maze.rb</code></span></strong></span> in the terminal and pressing <span class="smaller">ENTER</span>. You should see something like this (though your output will change depending on which direction you pick):</p><a id="pro_id00062"/>&#13;
      <pre class="programlisting">&#13;
Holy giraffes! You fell into a maze!&#13;
Where to? (N, E, S, W): <span class="strong"><strong><span class="red">E</span></strong></span>&#13;
E, you say? A fine choice!&#13;
An elf! And his pet ham!&#13;
</pre>&#13;
&#13;
      <p><a class="indexterm" id="iddle1124"/><a class="indexterm" id="iddle1153"/><a class="indexterm" id="iddle1355"/><a class="indexterm" id="iddle1417"/><a class="indexterm" id="iddle1669"/><a class="indexterm" id="iddle1809"/>The <code class="literal">print</code> command is new, but never fear: it’s almost exactly like <code class="literal">puts</code>, except it doesn’t add a new blank line after it prints out its text.</p>&#13;
&#13;
      <p>This bit is also new:</p><a id="pro_id00063"/>&#13;
      <pre class="programlisting">&#13;
direction = gets.chomp&#13;
</pre>&#13;
&#13;
      <p>What we’re doing here is setting a variable, <code class="literal">direction</code>, equal to calling the <code class="literal">gets</code> method and then the <code class="literal">chomp</code> method right after it. This is a fancy way of saying we’re <code class="literal">chomp</code>ing <code class="literal">gets</code>. <code class="literal">gets</code> is a built-in method (you can think of it as a Ruby command) that <span class="emphasis"><em>gets</em></span> the most recent input the user typed; <code class="literal">chomp</code> removes anything extra from the end, like spaces or a blank line. This means that we’ve now taken whatever the user typed (from <code class="literal">gets.chomp</code>) and stored it in our <code class="literal">direction</code> variable.</p>&#13;
&#13;
      <p>After that, it’s all smooth sailing! You’ve seen string interpolation with <code class="literal">#{}</code> already, and everything after that is just checking to see what letter the user entered with <code class="literal">==</code> (is equal to) and using <code class="literal">if</code>, <code class="literal">elsif</code>, and <code class="literal">else</code> to control what message the user sees.</p>&#13;
&#13;
      <p>You can test out your maze program by typing <span class="strong"><strong><span class="red"><code class="literal">ruby maze.rb</code></span></strong></span> from the command line or, after starting up IRB, <span class="strong"><strong><span class="red"><code class="literal">load 'maze.rb'</code></span></strong></span>. You can keep rerunning it with different input to see what happens each time!</p>&#13;
&#13;
      <p>You can go a bit further, though. (Don’t worry, it’s seriously a really small maze.) Here are a few ideas:</p>&#13;
&#13;
      <div class="itemizedlist">&#13;
        <ul class="itemizedlist">&#13;
          <li class="listitem">&#13;
            <p>How might you add more directions, like NW, SW, NE, SE, up, or down?</p>&#13;
          </li>&#13;
&#13;
          <li class="listitem">&#13;
            <p>How could you handle accepting lowercase letters for directions?</p>&#13;
          </li>&#13;
&#13;
          <li class="listitem">&#13;
            <p>A circle has 360 degrees, and turning right is the same as turning 90 degrees. What if you wanted to let your users enter a number so they could turn that many degrees? How could you use <code class="literal">&lt;</code>, <code class="literal">&lt;=</code>, <code class="literal">&gt;</code>, <code class="literal">&gt;=</code>, <code class="literal">==</code>, or <code class="literal">!=</code> to make this work? (This is a bit beyond where we already went, but you can do it! You wouldn’t be wandering around in a maze under a castle if you weren’t the adventurous type.)</p>&#13;
          </li>&#13;
        </ul>&#13;
      </div>&#13;
    </div>&#13;
&#13;
    <div class="sect1" title="You Know This!">&#13;
      <div class="titlepage">&#13;
        <h1 class="title" id="heading_id_8"><a id="you_know_thisexclamation_mark-id00002"/>You Know This!</h1>&#13;
      </div>&#13;
&#13;
      <p><a class="indexterm" id="iddle1003"/><a class="indexterm" id="iddle1039"/><a class="indexterm" id="iddle1045"/><a class="indexterm" id="iddle1064"/><a class="indexterm" id="iddle1077"/><a class="indexterm" id="iddle1139"/><a class="indexterm" id="iddle1218"/><a class="indexterm" id="iddle1263"/><a class="indexterm" id="iddle1266"/><a class="indexterm" id="iddle1312"/><a class="indexterm" id="iddle1392"/><a class="indexterm" id="iddle1451"/><a class="indexterm" id="iddle1613"/><a class="indexterm" id="iddle1641"/><a class="indexterm" id="iddle1788"/><a class="indexterm" id="iddle1835"/><a class="indexterm" id="iddle1839"/><a class="indexterm" id="iddle1893"/><a class="indexterm" id="iddle1902"/><a class="indexterm" id="iddle1925"/>Control flow is tricky stuff, but doing that biggerish project proves you’ve gotten the hang of it. Let’s review some of the things we learned along the way.</p>&#13;
&#13;
      <p>We talked about <span class="emphasis"><em>Booleans</em></span>, which can be <code class="literal">true</code> or <code class="literal">false</code>. They’re part of Ruby just like strings, numbers, and variables are, but they’re definitely not strings! Don’t put quotes around them, or they won’t work right.</p>&#13;
&#13;
      <p>We covered <span class="emphasis"><em>scripts</em></span> and how you can run them in IRB using <code class="literal">load '</code><span class="emphasis"><em><code class="literal">script_name</code></em></span><code class="literal">.rb'</code>. (You can also run your Ruby programs outside of IRB entirely by typing <code class="literal">ruby</code> <span class="emphasis"><em><code class="literal">script_name</code></em></span><code class="literal">.rb</code> on the command line.) Remember: you need quotes if you’re loading a file in IRB, but you don’t need quotes if you’re typing on the command line! (Computers are very dumb and very picky.)</p>&#13;
&#13;
      <p>We explained <span class="emphasis"><em>string interpolation</em></span> using <code class="literal">#{}</code> and how you can use it to put the values of variables directly into your strings. This comes in handy a lot, and remember: you can only do string interpolation with double-quoted (<code class="literal">"</code>) strings. It doesn’t work with single quotes (<code class="literal">'</code>)!</p>&#13;
&#13;
      <p>Finally, we learned about control flow using <code class="literal">if</code>, <code class="literal">elsif</code>, <code class="literal">else</code>, and <code class="literal">unless</code>, and how to combine these with logical operators <code class="literal">&amp;&amp;</code> (and), <code class="literal">!</code> (not), and <code class="literal">||</code> (or), and comparison operators <code class="literal">&lt;</code> (less than), <code class="literal">&gt;</code> (greater than), <code class="literal">&lt;=</code> (less than or equal to), <code class="literal">&gt;=</code> (greater than or equal to), <code class="literal">==</code> (is equal to), and <code class="literal">!=</code> (is not equal to). Using all these together, we can see (for example) <span class="emphasis"><em>if</em></span> one thing <span class="emphasis"><em>and</em></span> another thing are <code class="literal">true</code>, determine <span class="emphasis"><em>if</em></span> one thing is <span class="emphasis"><em>less than</em></span> another thing, or say we should do something <span class="emphasis"><em>unless</em></span> something <span class="emphasis"><em>is not equal to</em></span> something else. (Whew!)</p>&#13;
&#13;
      <p>It’s hard to believe, but this is pretty much everything computer programs do: compare values and test to see what is or isn’t true. Let’s take a minute to kick back, relax, and bask in the glow of all this Ruby know-how. (The next chapter’s gonna throw you for a bit of a loop.)</p>&#13;
    </div>&#13;
  </div>&#13;
</body></html>