<html><head></head><body>
<div id="sbo-rt-content">
<section epub:type="chapter" role="doc-chapter" aria-labelledby="ch6">

<hgroup>
<h2 class="CHAPTER" id="ch6">

<span class="CN"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_149" aria-label=" Page 149. "/><samp class="SANS_Futura_Std_Bold_Condensed_B_11">6</samp></span>

<span class="CT"><samp class="SANS_Dogma_OT_Bold_B_11">READING OTHER PEOPLE’S EMAIL</samp></span>

</h2>
</hgroup>

<p class="COS">After Russia invaded Ukraine in February 2022, hackers started flooding DDoSecrets with stolen data from Russian organizations. The data came in many formats, but the bulk of it—several terabytes’ worth—was email. The entire inboxes of government agencies, oil and gas companies, and investment firms were laid bare.</p>

<p class="TX">Email leaks are among the most common types of data leaks, and they can have serious consequences. In the 2016 US presidential election between Hillary Clinton and Donald Trump, leaked email messages from the DNC and Clinton campaign chair John Podesta—both hacked by the Russian government—played a major role in Trump’s election. The 2020 US presidential election between Trump and Joe Biden also involved email leaks—in this case, stolen from the laptop of Biden’s son Hunter.</p>

<p class="TX">With so many messages to sort through in email leaks, though, finding a place to start can be overwhelming. Depending on how the email was obtained and what software was running on the hacked server, the leaked <span role="doc-pagebreak" epub:type="pagebreak" id="pg_150" aria-label=" Page 150. "/>data could be in any of several different formats, and it may not be clear how to access the messages it contains.</p>

<p class="TX">In this chapter, you’ll learn about common formats for leaked email, the benefits and shortcomings of indexing and searching email with Aleph, and how to import email datasets into Thunderbird and Microsoft Outlook. You’ll sift through leaked email from the Oath Keepers dataset you downloaded in <span class="Xref"><a href="chapter4.xhtml">Chapter 4</a></span>, in addition to datasets from Australian offshore detention centers and the conservative US think tank the Heritage Foundation. We’ll begin by taking a look at the standard composition of an email message.</p>

<section epub:type="division" aria-labelledby="sec1">

<h3 class="H1" id="sec1"><span id="h-135"/><samp class="SANS_Futura_Std_Bold_B_11">The Email Protocol and Message Structure</samp></h3>

<p class="TNI">A <i>protocol</i> is a shared language that software developers agree upon to make their code interoperate. The email protocol we use today was first implemented in the early 1980s, got a major revamp in 1995, and hasn’t changed much since. Unlike modern centralized messaging systems (Facebook Messenger, for example), this protocol allows anyone to run an email server with their own software. For example, Google runs a server at gmail.com, the Russian search engine Yandex runs one at mail.yandex.com, and the Swiss company Proton runs one at proton.me. These servers are powered by different software but communicate using the same protocol, meaning they can all send messages to one another. <i>Internet standards</i>, specifications for how certain types of software should behave, ensure that all email software communicates with a shared protocol and a shared message format.</p>

<p class="TX">Because the email message format is an internet standard, all messages have a similar structure. To see what this format looks like, open any email and choose <b>Show Original</b> or <b>View Source</b>. Each message is a text file with two sections: the headers and body. The headers contain an email’s metadata in <samp class="SANS_TheSansMonoCd_W5Regular_Italic_I_11">Header-Field</samp><samp class="SANS_TheSansMonoCd_W5Regular_11">:</samp> <samp class="SANS_TheSansMonoCd_W5Regular_Italic_I_11">Value</samp> format, while the body contains the main text of the message.</p>

<p class="TX">The following headers are included in nearly every email message:</p>

<pre id="pre-205"><code>Subject: What's up?

From: Alice &lt;alice@example.com&gt;

To: Bob &lt;bob@example.com&gt;</code></pre>

<p class="TX">There are many more headers than these; your email software shows only a few of them. When email servers send, forward, or receive messages, they add headers describing these actions. For example, the common header <samp class="SANS_TheSansMonoCd_W5Regular_11">DKIM-Signature</samp> allows you to verify, using cryptography, that an email actually came from the server that it claims sent it. Messages also typically include a <samp class="SANS_TheSansMonoCd_W5Regular_11">Content-Type</samp> header, which describes the format of the body text.</p>

<p class="TX">After the headers, the email includes a blank line followed by the body. The body is typically in plaintext (text with no formatting), HTML, or Multipurpose Internet Mail Extensions (MIME) format. In MIME email, <span role="doc-pagebreak" epub:type="pagebreak" id="pg_151" aria-label=" Page 151. "/>the most common format, the body is split into parts for text, HTML components, and email attachments.</p>

<p class="TX">Though email messages are text files, you can send binary files like PNGs or ZIPs as attachments. Your email client converts the binary file into text using <i>Base64</i> encoding and includes that encoded attachment in the message. Just as you can convert any decimal number (that is, one conveyed using 10 digits) into a binary number (conveyed using 2 digits) and back, you can convert any binary data into Base64 data (conveyed using 64 characters). For example, here’s how a PNG image containing a 1<span class="symbol">×</span>1 transparent pixel looks with each of its 86 bytes of data represented as binary digits:</p>

<pre id="pre-206"><code>10001001 01010000 01001110 01000111 00001101 00001010 00011010 00001010 00000000 00000000

00000000 00001101 01001001 01001000 01000100 01010010 00000000 00000000 00000000 00000001

00000000 00000000 00000000 00000001 00001000 00000110 00000000 00000000 00000000 00011111

00010101 11000100 10001001 00000000 00000000 00000000 00000110 01100010 01001011 01000111

01000100 00000000 11111111 00000000 11111111 00000000 11111111 10100000 10111101 10100111

10010011 00000000 00000000 00000000 00001011 01001001 01000100 01000001 01010100 00001000

11010111 01100011 01100000 00000000 00000010 00000000 00000000 00000101 00000000 00000001

11100010 00100110 00000101 10011011 00000000 00000000 00000000 00000000 01001001 01000101

01001110 01000100 10101110 01000010 01100000 10000010</code></pre>

<p class="BodyContinued">And here’s the Base64-encoded version of the same binary file:</p>

<pre id="pre-207"><code>iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABmJLR0QA/wD/AP+gvaeTAAAAC0lE

QVQI12NgAAIAAAUAAeImBZsAAAAASUVORK5CYII=</code></pre>

<p class="TX">Base64-encoded data looks like a block of seemingly random text that includes capital letters, lowercase letters, numbers, plus signs (<samp class="SANS_TheSansMonoCd_W5Regular_11">+</samp>), and forward slashes (<samp class="SANS_TheSansMonoCd_W5Regular_11">/</samp>), and sometimes ends with equal signs (<samp class="SANS_TheSansMonoCd_W5Regular_11">=</samp>). The Base64-encoded version of some data conveys the same information as the decoded version, but it can be included more compactly in a text file, like an email. When the recipient of the email loads it, their email client will convert it from Base64 text back into a binary file. Sometimes plaintext or HTML email is encoded in Base64 as well (for example, <samp class="SANS_TheSansMonoCd_W5Regular_11">hello world</samp> is <samp class="SANS_TheSansMonoCd_W5Regular_11">aGVsbG8gd29ybGQ=</samp> in Base64). Although email messages are text files, you can’t rely on <samp class="SANS_TheSansMonoCd_W5Regular_11">grep</samp> to search them, because much of the content you’re hunting for might be Base64-encoded.</p>

<p class="TX">Keeping in mind those basics, let’s turn now to the specific formats typically encountered in email leaks.</p>

</section>

<section epub:type="division" aria-labelledby="sec2">

<h3 class="H1" id="sec2"><span id="h-136"/><samp class="SANS_Futura_Std_Bold_B_11">File Formats for Email Dumps</samp></h3>

<p class="TNI">The most common file formats for email <i>dumps</i>, or collections of email messages, are EML files, MBOX files, and PST Outlook data files. You’ll download email in each format in the upcoming exercise.</p>

<section epub:type="division" aria-labelledby="sec3">

<h4 class="H2" id="sec3"><span id="h-137"/><span role="doc-pagebreak" epub:type="pagebreak" id="pg_152" aria-label=" Page 152. "/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">EML Files</samp></h4>

<p class="TNI">The simplest type of email dump is a folder full of EML files, the standard email message format. An EML file is a text file with the extension <i>.eml</i> that contains the raw email message—the headers followed by the body.</p>

<p class="TX">When you download an email from your personal account, it will be in EML format. If you have a Gmail account, for example, open a message, click the <b>More</b> menu (the three dots icon) in the upper-right corner, and choose <b>Download Message</b>. Other email clients should likewise allow you to download individual messages in EML format. You can sometimes read an EML file in a text editor, but you’ll frequently be stymied by the Base64-encoded parts, so it’s more useful to open it in an email program like Thunderbird, Outlook, or the Mail app on macOS.</p>

<p class="TX">You can forward an email inline or as an attachment. Most email systems default to forwarding inline, copying the text of the body of the email you’re forwarding into the body of the email you’re writing. When you instead forward as an attachment, you attach the raw EML file to the email you’re writing. From a Gmail inbox, for example, select the box next to an email message, click the <b>More</b> menu, and choose <b>Forward as Attachment</b>. Other email clients should allow you to forward email as attachments as well. EML files include information that isn’t included in inline forwarded email, such as the original email headers.</p>

<p class="TX">EML files don’t include information on how the email was organized in the user’s inbox, such as the folder where the email was stored. For this reason, people who leak email dumps in EML format often organize the files into folders, with each folder representing a different user’s inbox. Sometimes they organize the files from each inbox into subfolders, too.</p>

<p class="TX">In Exercise 6-1, you’ll download email messages in EML format from the Nauru Police Force dataset.</p>

</section>

<section epub:type="division" aria-labelledby="sec4">

<h4 class="H2" id="sec4"><span id="h-138"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">MBOX Files</samp></h4>

<p class="TNI">In an MBOX email dump, each file is a collection of many email messages, generally representing a full folder of email. MBOX files often have the file extension <i>.mbox</i>, but sometimes they have no file extension at all.</p>

<p class="TX">Like EML files, MBOX files are text files that are viewable in a text editor but not very human-readable because of the Base64 encoding. However, you can’t just open an MBOX file in an email client to read the email like you can with an EML file. Instead, you’ll need to import the file.</p>

<p class="TX">The Oath Keepers dataset is a series of MBOX files, one for each hacked inbox. I’ll give more detail on the structure of this dataset in Exercise 6-1.</p>

</section>

<section epub:type="division" aria-labelledby="sec5">

<h4 class="H2" id="sec5"><span id="h-139"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">PST Outlook Data Files</samp></h4>

<p class="TNI">Email dumps may also come in the form of PST files, a proprietary format that represents a Microsoft Outlook inbox with the <i>.pst</i> file extension. Microsoft’s email server is called Microsoft Exchange. Whenever an <span role="doc-pagebreak" epub:type="pagebreak" id="pg_153" aria-label=" Page 153. "/>Outlook user wants to create a backup of their email, or when an Exchange server is hacked, the data is downloaded in PST format.</p>

<p class="TX">A PST file represents a full email inbox, complete with a hierarchy of folders and their contents. These files can get <i>big</i>. For example, in April 2022, hackers made off with 786GB of data from the All-Russia State Television and Broadcasting Company (VGTRK), the largest state-owned media company in Russia, and leaked it to DDoSecrets. This dataset includes 252 PST files, each representing a different email address. One file, <i>intercoord@vgtrk.ru.pst</i>, is 48GB alone.</p>

<p class="TX">In Exercise 6-1 you’ll download a 1GB PST file containing email from the Heritage Foundation.</p>

</section>
</section>

<section epub:type="division" aria-labelledby="sec6">

<h3 class="H1F" id="sec6"><span id="h-140"/><samp class="SANS_Futura_Std_Heavy_B_21">Exercise 6-1: Download Email Dumps from Three Datasets</samp></h3>

<p class="TNI">In this exercise, you’ll work with three different datasets from the Nauru Police Force, the Oath Keepers, and the Heritage Foundation. You should already have the Oath Keepers dataset from <span class="Xref"><a href="chapter4.xhtml">Chapter 4</a></span>, so you’ll download the other two next. You’ll also learn more about their contents and structure.</p>

<section epub:type="division" aria-labelledby="sec7">

<h4 class="H2" id="sec7"><span id="h-141"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">The Nauru Police Force Dataset</samp></h4>

<p class="TNI">Nauru is a tiny island in the Pacific with a population of about 10,000. While technically it’s an independent country, it hosts abuse-ridden offshore detention centers that the Australian government uses to hold immigrants and asylum seekers. The Nauru Police Force dataset (<a href="https://ddosecrets.com/wiki/Nauru_Police_Force"><i>https://<wbr/>ddosecrets<wbr/>.com<wbr/>/wiki<wbr/>/Nauru<wbr/>_Police<wbr/>_Force</i></a>) is a 54GB torrent full of 127 ZIP files, each a copy of all of the email from a specific email address at npf.gov.nr, the domain for the Nauru Police Force. Inside each ZIP file is a collection of folders containing EML files. This dataset contains over 285,000 messages.</p>

<p class="TX">For this chapter, you’ll be working with the file <i>iven-notte.zip</i>, which is about 2.9GB. Download the file directly from <i><a href="https://data.ddosecrets.com/Nauru%20Police%20Force/npf.gov.nr/iven-notte.zip">https://<wbr/>data<wbr/>.ddosecrets<wbr/>.com<wbr/>/Nauru%20Police%20Force<wbr/>/npf<wbr/>.gov<wbr/>.nr<wbr/>/iven<wbr/>-notte<wbr/>.zip<wbr/></a></i>. Once you’ve done so, save it into a folder called <i>Nauru Police Force</i> on your <i>datasets</i> USB disk and unzip it. You should end up with a folder called <i>iven-notte</i> containing the subfolders <i>calendar</i>, <i>contacts</i>, <i>deleteditems</i>, <i>drafts</i>, <i>inbox</i>, and more. Each of these subfolders is full of EML files.</p>

</section>

<section epub:type="division" aria-labelledby="sec8">

<h4 class="H2" id="sec8"><span id="h-142"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">The Oath Keepers Dataset</samp></h4>

<p class="TNI">The public part of the Oath Keepers dataset is a 3.9GB torrent of MBOX files taken from the server that hosted email for the oathkeepers.org domain. This dataset has a folder called <i>Oath Keepers.sbd</i>, containing subfolders called <i>ak</i>, <i>al</i>, <i>alb</i>, <i>ar</i>, <i>Archive</i>, <i>az</i>, and many others, each of which is an MBOX file (without the <i>.mbox</i> file extension) that contains several email messages. Each US state chapter of the Oath Keepers militia has its own inbox, so, for example, you can find the Arizona chapter’s email in the MBOX file <i>az</i>. There are a few other MBOX files, including <i>volunteers</i> and <span role="doc-pagebreak" epub:type="pagebreak" id="pg_154" aria-label=" Page 154. "/><i>stewart.rhodes</i> (Stewart Rhodes is the founder of the militia and was convicted of seditious conspiracy and sentenced to 18 years in prison for his group’s role in the January 6, 2021, attack on the US Capitol). DDoSecrets distributes an additional part of the dataset, which contains donor and membership records, only to journalists and researchers who request access, because it contains so much PII.</p>

<p class="TX">If you didn’t already download the Oath Keepers dataset in <span class="Xref"><a href="chapter4.xhtml">Chapter 4</a></span>, visit the DDoSecrets page for the Oath Keepers at <a href="https://ddosecrets.com/wiki/Oath_Keepers"><i>https://<wbr/>ddosecrets<wbr/>.com<wbr/>/wiki<wbr/>/Oath<wbr/>_Keepers</i></a>. This page includes a link to the torrent file as well as the magnet link. Add the torrent to your BitTorrent client and download the full dataset, saving it to your <i>datasets</i> USB disk.</p>

</section>

<section epub:type="division" aria-labelledby="sec9">

<h4 class="H2" id="sec9"><span id="h-143"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">The Heritage Foundation Dataset</samp></h4>

<p class="TNI">The Heritage Foundation is a conservative think tank that played a major role in US politics during the Reagan administration. This dataset, a 1GB file called <i>backup.pst</i>, is a backup of a personal email account used by an employee on the foundation’s major gifts team. His email address was hosted with his residential ISP at the domain embarqmail.com. In 2015, the Twitter user <span class="LinkTwitter">@jfuller290</span> noticed that the foundation had accidentally put this backup in PST format on a public Amazon S3 bucket—an Amazon cloud service that hosts files—and he tweeted the link to it. (The Heritage Foundation at first claimed that it was hacked, but in fact it had inadvertently made the file public itself.) The email backup was made in 2009, six years before <span class="LinkTwitter">@jfuller290</span> noticed it.</p>

<p class="TX">Visit the DDoSecrets page for the Heritage Foundation at <a href="https://ddosecrets.com/wiki/Heritage_Foundation"><i>https://<wbr/>ddosecrets<wbr/>.com<wbr/>/wiki<wbr/>/Heritage<wbr/>_Foundation</i></a>. This page includes links to the torrent as well as a direct download for this dataset. Because the dataset is just a single, relatively small Outlook Data File, directly download it from <a href="https://data.ddosecrets.com/Heritage%20Foundation/backup.pst"><i>https://<wbr/>data<wbr/>.ddosecrets<wbr/>.com<wbr/>/Heritage%20Foundation<wbr/>/backup<wbr/>.pst</i></a> and save it into a folder called <i>Heritage Foundation</i> on your <i>datasets</i> USB disk.</p>

<p class="TX">While you’re waiting for these email dumps to finish downloading, read on to learn about the tools you can use to research them.</p>

</section>
</section>

<section epub:type="division" aria-labelledby="sec10">

<h3 class="H1" id="sec10"><span id="h-144"/><samp class="SANS_Futura_Std_Bold_B_11">Researching Email Dumps with Thunderbird</samp></h3>

<p class="TNI">Before you start reading the email you’ve downloaded, you’ll install and configure <i>Thunderbird</i>, an open source email program for Windows, macOS, and Linux that allows you to work with email dumps in different formats. You can use Thunderbird to import folders full of EML or MBOX files and search and read everything inside them. When you open an EML file in Thunderbird, the program will parse the file, Base64-decode everything for you, and let you see HTML email and download attachments.</p>

<p class="TX">Thunderbird users typically use the program just to check their personal email, sometimes for multiple email accounts. If you want, you can add your existing email accounts to it and use it to read and write email <span role="doc-pagebreak" epub:type="pagebreak" id="pg_155" aria-label=" Page 155. "/>yourself. For research purposes, though, you’ll use Thunderbird to import email into <i>local folders</i>, which will allow you to work with the email locally on your computer without connecting to an email server. You don’t need internet access when using Thunderbird to research email dumps in this way, which means you can use an air-gapped computer.</p>

<p class="TX">Like its sister project, the Firefox web browser, Thunderbird supports third-party extensions that add functionality to the program. The ImportExportTools NG extension is crucial to working with email dumps; it adds support for importing MBOX files and for bulk-importing folders full of EML files, keeping their folder structure intact. However, to import PSTs into Thunderbird, you must first convert them into EMLs using the <samp class="SANS_TheSansMonoCd_W5Regular_11">readpst</samp> program. You’ll import all three file types into Thunderbird later in the chapter.</p>

<p class="TX">After importing email dumps into Thunderbird, you can click through all of the folders and read the email messages as if you were reading your own email. You can also use Thunderbird’s built-in search feature to bulk-search all of the email you’ve imported. However, you can’t use Thunderbird to search the content of attachments—for that, you’ll need a tool like Aleph, which we’ll discuss in <span class="Xref">“Other Tools for Researching Email Dumps”</span> on <span class="Xref">page 163</span>.</p>

</section>

<section epub:type="division" aria-labelledby="sec11">

<h3 class="H1F" id="sec11"><span id="h-145"/><samp class="SANS_Futura_Std_Heavy_B_21">Exercise 6-2: Configure Thunderbird for Email Dumps</samp></h3>

<p class="TNI">In this exercise, you’ll install Thunderbird and configure it in order to analyze the three email dumps you’ve downloaded.</p>

<p class="TX">Download Thunderbird from <a href="https://www.thunderbird.net"><i>https://<wbr/>www<wbr/>.thunderbird<wbr/>.net</i></a> and install it on your computer. When you open the program the first time, it asks if you want to set up an existing email account. While you won’t need to use a real email account to research email dumps, adding an account to Thunderbird makes it easier to import these data dumps later on. If you don’t want to use Thunderbird to check your real email, I recommend that you create a new email account just for this purpose. Click the <b>Get a New Email Address</b> link to create a new free email account directly within Thunderbird on an email provider called Mailfence. Select an email address and generate a random password in your password manager, then provide an existing email address to activate your new account. After creating your account, log in to it with Thunderbird, and you should see the message “Account successfully created.”</p>

<p class="TX">Next, switch to the main Thunderbird tab. In the Folders sidebar on the left, you should see the email address you added, and beneath it a section called Local Folders. You added an email address just to create the Local Folders section, so if you don’t plan on using Thunderbird to check this email account, you can delete it. To do so, click the Thunderbird menu icon in the top-right corner and choose <b>Account Settings</b>. Make sure your new email account is selected, click <b>Account Actions</b> in the bottom left, and choose <b>Remove Account</b>. Select the <b>Remove Message Data</b> box and <span role="doc-pagebreak" epub:type="pagebreak" id="pg_156" aria-label=" Page 156. "/>click <b>Remove</b>. Now switch back to the main Thunderbird window, and only Local Folders should remain in the left sidebar.</p>

<p class="TX">Next, to install the ImportExportTools NG Thunderbird add-on, click the menu icon in the top-right corner and choose <b>Add-ons and Themes</b>. Switch to the <b>Extensions</b> tab, search for <b>ImportExportTools NG</b>, and install the add-on. A lot of this add-on’s functionality appears in the Tools menu bar at the top, which appears automatically in macOS. To access it in Windows or Linux, click the menu icon in the top-right corner and choose <b>View</b><span class="MenuArrow">▸</span><b>Toolbars</b><span class="MenuArrow">▸</span><b>Menu Bar</b>. A menu bar should appear at the top of the Thunderbird window. Go to <b>Tools</b><span class="MenuArrow">▸</span><b>ImportExportTools NG</b> to access the add-on’s features.</p>

<p class="TX">Finally, click the Thunderbird menu icon and choose <b>Settings</b>. Switch to the <b>Privacy &amp; Security</b> tab and make sure that Allow Remote Content in Messages is unchecked (it should be unchecked by default). <i>Remote content</i> is any content hosted on the internet instead of inside of the email, like images loaded from URLs. When you open an email with remote content, like an HTML email with images, loading those images will leave a trace that the email was opened from a certain IP address.</p>
<blockquote>

<p class="NOTE"><span class="NoteHead"><samp class="SANS_Dogma_OT_Bold_B_21">NOTE</samp></span></p>
</blockquote>

<p class="NOTE-TXT"><i>Thunderbird will always give you the chance to load remote content on individual email messages if you’d like, but I recommend that you connect to a VPN beforehand so that the VPN’s IP address, rather than your IP address, will be tracked (see the “Covering Your Tracks with a VPN Service” box on page 255).</i></p>

</section>

<section epub:type="division" aria-labelledby="sec12">

<h3 class="H1" id="sec12"><span id="h-146"/><samp class="SANS_Futura_Std_Bold_B_11">Reading Individual EML Files with Thunderbird</samp></h3>

<p class="TNI">During your own investigations, you may find only a few EML files in a dataset, or someone might forward email messages to you as attachments. Thunderbird is a good tool for inspecting these messages individually without needing to import them.</p>

<p class="TX">Once your downloads from Exercise 6-1 have finished, try using Thunderbird to view some individual messages. Open your file manager app, like Explorer in Windows or Finder in macOS, and browse to the extracted <i>iven-notte</i> folder in the Nauru Police Force dataset. Open the <i>inbox</i> folder, right-click one of the EML files, and open it in Thunderbird. Thunderbird should show you the headers, like the date the email was sent, and the From, To, and Subject lines. You can also read the email exactly as it was originally formatted, and if it has attachments, you can open them.</p>

<p class="TX">Just as you shouldn’t blindly open attachments you receive in your personal email, don’t blindly open attachments that you find in email dumps, because they could hack your computer. Refer back to <span class="Xref"><a href="chapter1.xhtml">Chapter 1</a></span> for tips on how to open such documents safely.</p>
<aside class="box" aria-labelledby="box-18">

<h4 class="BH" id="box-18"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_157" aria-label=" Page 157. "/><samp class="SANS_Dogma_OT_Bold_B_11">EXTRACTING ATTACHMENTS FROM EML FILES</samp></h4>

<p class="BoxBodyFirst"><samp class="SANS_Futura_Std_Book_11">A single EML file could contain several file attachments, all Base64-encoded. The</samp> <samp class="SANS_TheSansMonoCd_W5Regular_11">munpack</samp> <samp class="SANS_Futura_Std_Book_11">program lets you extract these attachments without needing to use an email client. Install</samp> <samp class="SANS_TheSansMonoCd_W5Regular_11">munpack</samp> <samp class="SANS_Futura_Std_Book_11">with</samp> <samp class="SANS_TheSansMonoCd_W7Bold_B_11">sudo apt install mpack</samp> <samp class="SANS_Futura_Std_Book_11">in Linux or Windows with WSL, or use</samp> <samp class="SANS_TheSansMonoCd_W7Bold_B_11">brew install mpack</samp> <samp class="SANS_Futura_Std_Book_11">in Homebrew on macOS. You can then run the command</samp> <samp class="SANS_TheSansMonoCd_W7Bold_B_11">munpack</samp> <samp class="SANS_TheSansMonoCd_W7Bold_Italic_BI_11">filename.eml</samp> <samp class="SANS_Futura_Std_Book_11">to extract the attachments from an email.</samp></p>

<p class="BoxBodyLast"><samp class="SANS_Futura_Std_Book_11">For example, the Nauru Police Force dataset contains an EML file called</samp> <samp class="SANS_Futura_Std_Book_Oblique_I_11">68.eml</samp><samp class="SANS_Futura_Std_Book_11">. When I run</samp> <samp class="SANS_TheSansMonoCd_W5Regular_11">munpack 68.eml</samp><samp class="SANS_Futura_Std_Book_11">, it extracts the attachments from that email—in this case,</samp> <samp class="SANS_Futura_Std_Book_Oblique_I_11">RegistrationXForm.pdf</samp> <samp class="SANS_Futura_Std_Book_11">and</samp> <samp class="SANS_Futura_Std_Book_Oblique_I_11">COPXPassport.pdf</samp><samp class="SANS_Futura_Std_Book_11">—into the current working folder. You could also use</samp> <samp class="SANS_TheSansMonoCd_W5Regular_11">munpack</samp> <samp class="SANS_Futura_Std_Book_11">in a script to extract all of the attachments from every email message in an email dump, all from the terminal.</samp></p>
</aside>

<p class="TX">In the following exercises, you’ll import each of the email dumps you just downloaded into Thunderbird, starting with the EML files from the Nauru Police Force dataset.</p>

</section>

<section epub:type="division" aria-labelledby="sec13">

<h3 class="H1F" id="sec13"><span id="h-147"/><samp class="SANS_Futura_Std_Heavy_B_21">Exercise 6-3: Import the Nauru Police Force EML Email Dump</samp></h3>

<p class="TNI">To import an email dump with the ImportExportTools NG add-on, select the folder into which you’d like to import it. Always import email dumps into a local folder, rather than a remote folder on an email server. From the Folders sidebar on the main Thunderbird tab, right-click <b>Local Folders</b> and choose <b>New Folder</b>, as shown in <a href="#fig6-1">Figure 6-1</a>.</p>
<figure class="IMG"><img class="img100" id="fig6-1" src="Images/Figure6-1.png" alt="A screenshot of the sidebar in Thunderbird that lists the local folders, with New Folder selected from the menu options." width="696" height="331"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 6-1: Creating a new local folder in Thunderbird</samp></p></figcaption>

</figure>

<p class="TX">Name your folder <i>Nauru Police Force</i> and click <b>Create Folder</b>. You should now see the <i>Nauru Police Force</i> folder in your Local Folders list.</p>

<p class="TX"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_158" aria-label=" Page 158. "/>Right-click the <i>Nauru Police Force</i> folder you just created and choose <b>New Subfolder</b>. Name your subfolder <i>iven-notte</i>, the name of the email account whose inbox data you’ll be importing, and click <b>Create Folder</b>. Right-click the new <i>iven-notte</i> subfolder that you just created and choose <b>ImportExportTools NG</b><span class="MenuArrow">▸</span><b>Import EML Messages</b><span class="MenuArrow">▸</span><b>All EML Messages from a Directory and Subdirectories</b>. A dialog will pop up, allowing you to browse for a folder. Select your <i>iven-notte</i> subfolder.</p>

<p class="TX">This subfolder should immediately start filling up with the 14,964 email messages that you’re importing. It will probably take a few minutes to finish (importing all 127 inboxes in this dataset would take considerably longer).</p>

<p class="TX"><a href="#fig6-2">Figure 6-2</a> shows Thunderbird with the <i>iven-notte</i> inbox loaded up. You can see all of the folders and the number of unread messages in each. (If you’d like, you can mark all of these messages as unread to keep track of which messages you have left to read.)</p>
<figure class="IMG"><img class="img100" id="fig6-2" src="Images/Figure6-2.png" alt="A screenshot showing the iven-notte inbox in the Nauru Police Force dataset imported into Thunderbird, with an email from Lionel Aingimea highlighted." width="845" height="648"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 6-2: An email dump imported in Thunderbird</samp></p></figcaption>

</figure>

<p class="TX">The email selected in <a href="#fig6-2">Figure 6-2</a> is in the <i>inbox</i> folder and was sent from Lionel Aingimea, the president of Nauru at that time. In the email, he instructs Iven Notte, the Nauru police chief and the inbox owner, to not respond to Australian journalist Eden Gillespie, who had asked about two <span role="doc-pagebreak" epub:type="pagebreak" id="pg_159" aria-label=" Page 159. "/>Nauru men who had allegedly attacked a refugee worker, possibly run him over, and stolen his motorbike. “Leave it,” President Aingimea wrote. “Don’t answer them.”</p>

<p class="TX">Cam Wilson, a reporter for the Australian news site Crikey, dug into the Nauru Police Force dataset and revealed “the appalling disregard for refugees and asylum seekers detained there.” You can read Wilson’s reporting on Crikey’s website, <a href="https://www.crikey.com.au"><i>https://<wbr/>www<wbr/>.crikey<wbr/>.com<wbr/>.au</i></a>.</p>

</section>

<section epub:type="division" aria-labelledby="sec14">

<h3 class="H1" id="sec14"><span id="h-148"/><samp class="SANS_Futura_Std_Bold_B_11">Searching Email in Thunderbird</samp></h3>

<p class="TNI">Now that you’ve got Thunderbird configured and loaded with data, you’re ready to explore that data. For example, you may want to search the Nauru Police Force dataset for other email from President Aingimea or from Australian politicians. You could also search for email that contains keywords like <i>refugee</i> or was written on specific days. This section covers search methods you can use on any email dump you import into Thunderbird.</p>

<section epub:type="division" aria-labelledby="sec15">

<h4 class="H2" id="sec15"><span id="h-149"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Quick Filter Searches</samp></h4>

<p class="TNI">The simplest search option is to filter the email that shows up in the currently selected folder. When viewing a folder, near the top of the Thunderbird window, make sure the Quick Filter button is toggled on so that an extra toolbar appears. This toolbar has buttons to quickly filter out only messages that are unread, contain attachments, or have other properties.</p>

<p class="TX">The Quick Filter toolbar also has a search box that you can use to find only messages that include certain text. You can also filter for messages that include the search term in the sender field, recipient field, subject line, or body. This is the most common way I search in Thunderbird. For example, I entered <i>Aingimea</i> in the Quick Filter search box to quickly find all of the email related to President Aingimea in the <i>inbox</i> folder. I could also put his email address in the search box and filter for messages where he’s the sender or the recipient (though he won’t be the recipient of any of this email, because this is Iven Notte’s inbox, not his).</p>

</section>

<section epub:type="division" aria-labelledby="sec16">

<h4 class="H2" id="sec16"><span id="h-150"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">The Search Messages Dialog</samp></h4>

<p class="TNI">The Quick Filter search is essentially a more limited version of the Search Messages dialog, which is the most powerful way to search for email in Thunderbird. Open this dialog by clicking the <b>Edit</b> menu and choosing <b>Find</b><span class="MenuArrow">▸</span><b>Search Messages</b>. You can choose which folder to search, or you can elect to search all the email in an account at once. You can then choose more granular search queries. For example, you could find all email messages that mention <i>asylum</i> in the body. You can then filter those results by adding further criteria, such as showing only email sent from or to a specific email address or only email with attachments.</p>

<p class="TX"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_160" aria-label=" Page 160. "/>There’s also a search box in the top right of the Thunderbird window, above the Quick Filter search box, that will quickly search the full email account. I find this feature less useful than the Search Messages dialog. If I can’t find what I’m looking for with Quick Filter, I move on to Search Messages, which lets me make my searches as granular as necessary.</p>

</section>
</section>

<section epub:type="division" aria-labelledby="sec17">

<h3 class="H1F" id="sec17"><span id="h-151"/><samp class="SANS_Futura_Std_Heavy_B_21">Exercise 6-4: Import the Oath Keepers MBOX Email Dump</samp></h3>

<p class="TNI">In this exercise, you’ll import email from the Oath Keepers dataset into Thunderbird. The Oath Keepers dataset contains the files <i>messages.json</i> and <i>messages_old.json</i>, which are chat logs, and the <i>Oath Keepers.sbd</i> folder, which contains 100 files in MBOX format. You’ll focus on the latter here. As mentioned previously, you can’t open MBOX files in an email client to read the messages like you can with EML files; you must import them into Thunderbird first.</p>

<p class="TX">To keep your different datasets separate in Thunderbird, you’ll create a new folder for the Oath Keepers data. In the left panel, right-click <b>Local Folders</b> and choose <b>New Folder</b>. Name your folder <i>Oath Keepers</i> and click <b>Create Folder</b>. You should now see the <i>Oath Keepers</i> folder in your Local Folders list. Right-click the <i>Oath Keepers</i> folder you just created and choose <b>ImportExportTools NG</b><span class="MenuArrow">▸</span><b>Import mbox Files</b><span class="MenuArrow">▸</span><b>All mbox Files from directory (with sbd structure)</b>. Browse your filesystem and select the <i>Oath Keepers.sbd</i> folder.</p>

<p class="TX">Thunderbird might become unresponsive while it imports the 3.9GB of email, not allowing you to click on anything, but be patient. When the import is complete, you should have 100 separate folders full of email.</p>

<p class="TX">The Oath Keepers folder with the most email, by far, is <i>oksupport</i>, the Oath Keepers support email account. <a href="#fig6-3">Figure 6-3</a> shows an email in this folder from a member renouncing his membership shortly after the January 6 attack.</p>

<p class="TX">I haven’t found many major revelations in this email dump; most of those are contained in the private part of the Oath Keepers database, the membership and donor lists that DDoSecrets distributes only to journalists and researchers. The publicly available email contains many people writing about joining the militia or complaining that they paid their membership dues but haven’t had any further communication. There’s also a massive amount of spam, including right-wing extremist, conspiratorial, and anti-vaccine bulk email. Look through the various email accounts you imported and try out Thunderbird’s search tools to see if you can find anything interesting I missed.</p>
<span role="doc-pagebreak" epub:type="pagebreak" id="pg_161" aria-label=" Page 161. "/>

<figure class="IMG"><img class="img100" id="fig6-3" src="Images/Figure6-3.png" alt="A Thunderbird screenshot with the oksupport folder selected, and an email highlighted from an Oath Keepers member resigning his membership." width="845" height="621"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 6-3: An email from the Oath Keepers email dump</samp></p></figcaption>

</figure>
</section>

<section epub:type="division" aria-labelledby="sec18">

<h3 class="H1F" id="sec18"><span id="h-152"/><samp class="SANS_Futura_Std_Heavy_B_21">Exercise 6-5: Import the Heritage Foundation PST Email Dump</samp></h3>

<p class="TNI">In this exercise, you’ll import the Heritage Foundation email dump, a Microsoft Outlook PST file called <i>backup.pst</i>, into Thunderbird. Since the ImportExportTools NG add-on doesn’t support PST files, first you’ll need to convert the PST into an EML or MBOX file.</p>

<p class="TX">The <samp class="SANS_TheSansMonoCd_W5Regular_11">readpst</samp> program can convert a PST file into several different formats, including EML and MBOX files. You can access the program by installing the <samp class="SANS_TheSansMonoCd_W5Regular_11">libpst</samp> package in macOS or the <samp class="SANS_TheSansMonoCd_W5Regular_11">pst-utils</samp> package in Ubuntu. Start by opening a terminal. Mac users, run the following command:</p>

<pre id="pre-208"><code><b>brew install libpst</b></code></pre>

<p class="TX">Linux and Windows with WSL users, run these commands:</p>

<pre id="pre-209"><code><b>sudo apt update</b>

<b>sudo apt install pst-utils</b></code></pre>

<p class="TX"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_162" aria-label=" Page 162. "/>Next, change to the folder that contains the <i>backup.pst</i> file. For example, on my macOS computer, I run:</p>

<pre id="pre-210"><code><b>cd /Volumes/datasets/Heritage\ Foundation</b></code></pre>

<p class="TX">To convert a PST file into EML file, you use the following command, where the <samp class="SANS_TheSansMonoCd_W5Regular_11">-e</samp> argument tells <samp class="SANS_TheSansMonoCd_W5Regular_11">readpst</samp> to output as EML files:</p>

<pre id="pre-211"><code><b>readpst -e</b> <b><var>filename.pst</var></b></code></pre>

<p class="TX">Run that command on the <i>backup.pst</i> file like so:</p>

<pre id="pre-212"><code><b>readpst -e backup.pst</b></code></pre>

<p class="TX">This command creates a folder called <i>Personal Folders</i>, which contains additional <i>Contacts</i>, <i>Heritage</i>, <i>Inbox</i>, <i>Junk E-mail</i>, and other subfolders (this is how the email in <i>backup.pst</i> is organized). Within each folder are several EML files, one for each email message.</p>
<blockquote>

<p class="NOTE"><span class="NoteHead"><samp class="SANS_Dogma_OT_Bold_B_21">NOTE</samp></span></p>
</blockquote>

<p class="NOTE-TXT"><i>I’ve found it easier to import EML files generated by <samp class="SANS_TheSansMonoCd_W5Regular_Italic_I_11">readpst</samp> into Thunderbird, but you can also convert PSTs into MBOX files with the</i> <samp class="SANS_TheSansMonoCd_W5Regular_Italic_I_11">readpst -r</samp> <samp class="SANS_TheSansMonoCd_W5Regular_11">filename.pst</samp> <i>command.</i></p>

<p class="TX">In the left panel, right-click <b>Local Folders</b> and choose <b>New Folder</b>, as you did in the previous exercises. Name your folder <i>Heritage Foundation</i> and click <b>Create Folder</b>. You should now see the <i>Heritage Foundation</i> folder in your Local Folders list.</p>

<p class="TX">Right-click the <i>Heritage Foundation</i> folder, choose <b>New Subfolder</b>, and name your new subfolder <i>backup.pst</i>. Right-click the <i>backup.pst</i> subfolder and choose <b>ImportExportTools NG</b><span class="MenuArrow">▸</span><b>Import EML Messages</b><span class="MenuArrow">▸</span><b>All EML Messages from a Directory and Subdirectories</b>. Browse for the <i>Personal Folders</i> folder that you just created using <samp class="SANS_TheSansMonoCd_W5Regular_11">readpst</samp> and start the import. This folder should start filling up with over a thousand email messages.</p>

<p class="TX">These email messages, all belonging to former Heritage Foundation fundraiser Steve DeBuhr, are meticulously organized into folders. In addition to Heritage Foundation work, this email dump also includes DeBuhr’s personal email. This email dump is very old—the latest messages are from 2009—so it’s unlikely you’ll find very many revelations in here. Since DeBuhr worked with major donors, though, the email in the <i>Heritage</i> folder contains many attachments full of financial details. <a href="#fig6-4">Figure 6-4</a> shows this email dump in Thunderbird.</p>

<p class="TX">Particularly, I noticed as I browsed through this email that the <i>Social Issues</i> folder contains homophobic and otherwise bigoted messages that DeBuhr had forwarded from his official heritage.org address account to his personal one.</p>
<span role="doc-pagebreak" epub:type="pagebreak" id="pg_163" aria-label=" Page 163. "/>

<figure class="IMG"><img class="img100" id="fig6-4" src="Images/Figure6-4.png" alt="In this Thunderbird screenshot from the Heritage Foundation email dump, the Social Issues folder is selected, with a homophobic email highlighted. The message says: “Hi Steve, Found this article and never heard these two arguments against homosexuality . . . Hope you find it helpful.” The rest of the email is an article headlined “Is Homosexuality Normal?”" width="845" height="658"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 6-4: A Heritage Foundation email in Thunderbird</samp></p></figcaption>

</figure>
</section>

<section epub:type="division" aria-labelledby="sec19">

<h3 class="H1" id="sec19"><span id="h-153"/><samp class="SANS_Futura_Std_Bold_B_11">Other Tools for Researching Email Dumps</samp></h3>

<p class="TNI">This chapter has focused on using Thunderbird as a tool for researching email dumps, but in your future work, you might find two alternative tools helpful: Microsoft Outlook and Aleph. In this section I’ll go over how you can use each tool to import and search email dumps. You don’t need to follow the instructions in this section to work through the rest of the book, but reading along will give you a sense of what the options are and when to use them.</p>

<section epub:type="division" aria-labelledby="sec20">

<h4 class="H2" id="sec20"><span id="h-154"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Microsoft Outlook</samp></h4>

<p class="TNI">Unlike Thunderbird, Microsoft’s desktop email program, Outlook, supports importing email dumps directly in PST format. However, Outlook has some downsides. First, it’s not free; the cheapest way to get Outlook is to buy a Microsoft 365 license, which, at the time of writing, costs around $7 per month or $70 per year. Second, Outlook is available only for Windows and macOS, not Linux (though Linux users can run Outlook in a Windows VM). Still, you might find Outlook useful if you’re familiar with <span role="doc-pagebreak" epub:type="pagebreak" id="pg_164" aria-label=" Page 164. "/>the program and understand its advanced features, or just want to see an email in its original interface.</p>

<p class="TX">Let’s look at how to import PST files directly into Outlook, using a real example from a hacked Russian email dump. First, set up a Windows VM for Outlook. Do this even if you’re a Windows or macOS user who already uses Outlook for email, in order to avoid mixing up your actual email and a leaked email dump. Microsoft publishes free Windows VM images for several different VM programs like VirtualBox, VMWare, and Parallels. Download the VM image at <a href="https://developer.microsoft.com/en-us/windows/downloads/virtual-machines/"><i>https://<wbr/>developer<wbr/>.microsoft<wbr/>.com<wbr/>/en<wbr/>-us<wbr/>/windows<wbr/>/downloads<wbr/>/virtual<wbr/>-machines<wbr/>/</i></a> and import it into your VM software. You’ll also need to install Microsoft Office in your VM. If you have a Microsoft 365 license, download Office from <a href="https://www.office.com"><i>https://<wbr/>www<wbr/>.office<wbr/>.com</i></a> by logging in and clicking the <b>Install Office</b> link. If you don’t have a license, Microsoft offers a free trial.</p>

<p class="TX">When you open Outlook the first time, it prompts you to log in to your Office 365 account to check your license. After that, it prompts you to set up an email account. At the bottom, click the link <b>Create an Outlook.com Email Address to Get Started</b> in order to create a new account. Make sure to save your email and password in your password manager. Once you’re finished, click <b>Done</b>. Outlook should open with the empty inbox of the new email account you just created.</p>

<p class="TX">With Outlook set up, add the PST email dumps to it. Click <b>File</b><span class="MenuArrow">▸</span><b>Account Settings</b><span class="MenuArrow">▸</span><b>Account Settings</b>, then click <b>Data Files</b><span class="MenuArrow">▸</span><b>Add</b> and browse for the PST file you want to add. If you have the disk space to spare, make a copy of the PST file and add the copy instead. All information about this inbox, including details like which messages are marked read, is stored in this file, so working from a copy will prevent you from modifying the original.</p>

<p class="TX">The PST file you added should appear in the left sidebar. You can now sift through this inbox as if it were your own. Even the unread email counts you’ll see are the actual counts of unread email for each folder at the time the PST file was exported.</p>

<p class="TX">As an example, I set up a Windows VM, installed Outlook, logged in to it using my Microsoft 365 account, and added <i>intercoord@vgtrk.ru.pst</i> (the 48GB PST file hacked from VGTRK mentioned earlier in this chapter).</p>

<p class="TX"><a href="#fig6-5">Figure 6-5</a> shows this VGTRK inbox, where I’ve used Outlook’s search feature to search for <span class="cyrillic"><span xml:lang="mn" lang="mn">Такер Карлсон</span></span>. This is the Cyrillic spelling of Tucker Carlson, the former Fox News host.</p>

<p class="TX">The subject line of the selected email in <a href="#fig6-5">Figure 6-5</a> translates roughly to “Tucker Carlson sync.” The email body contains a translated quote in which Carlson claims that Ukraine is not an independent country, but rather is controlled by the US Democratic Party. The quote also includes the false claim that in 2016, then Vice President Joe Biden fired Ukraine’s attorney general for investigating Biden’s son Hunter. (In fact, Biden leveraged $1 billion in US aid to persuade Ukraine to oust its top prosecutor, Viktor Shokin, who refused to investigate corruption from powerful Ukrainians. Biden worked in tandem with anti-corruption efforts across Europe: European leaders, as well as civil society groups within Ukraine, urged Shokin to resign for the same reason.) Russian TV likely aired this Tucker Carlson clip, and this email was likely the translation for their Russian dubbed version.</p><span role="doc-pagebreak" epub:type="pagebreak" id="pg_165" aria-label=" Page 165. "/>

<figure class="IMG"><img class="img100" id="fig6-5" src="Images/Figure6-5.png" alt="Screenshot of Outlook running in a Windows VM. The email is in Russian, and the selected email is a translated quote from Tucker Carlson." width="846" height="608"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 6-5: Researching a PST file in Outlook</samp></p></figcaption>

</figure>

<blockquote>

<p class="NOTE"><span class="NoteHead"><samp class="SANS_Dogma_OT_Bold_B_21">NOTE</samp></span></p>
</blockquote>

<p class="NOTE-TXT"><i>When working with data dumps in foreign languages that you don’t read, you can rely on machine translation tools like DeepL or Google Translate—assuming, of course, that you’re comfortable sharing the contents of the leak with a third-party service. I’ve also found the Google Translate phone app useful: if you hold your phone’s camera up to your screen, it will translate text in real time. This works even with scanned documents that aren’t OCR’d.</i></p>

</section>

<section epub:type="division" aria-labelledby="sec21">

<h4 class="H2" id="sec21"><span id="h-155"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Aleph</samp></h4>

<p class="TNI">As you learned in <span class="Xref"><a href="chapter5.xhtml">Chapter 5</a></span>, you can use Aleph to index and browse a wide variety of email, including PST or EML files. When you index a folder containing PSTs, Aleph recognizes the file format and indexes all of the individual messages inside of each PST file, keeping the folder hierarchy intact. Aleph also has the following benefits for working with email dumps:</p>
<ul class="BL">

<li class="BL">Unlike Thunderbird and Outlook, Aleph will also index, make searchable, and even add OCR to email attachments.</li>
<li class="BL">As with any dataset it processes, Aleph will automatically list all of the people and organizations it finds in the dataset, and you can use it to cross-reference that data with other datasets you’ve indexed.</li>
<li class="BL"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_166" aria-label=" Page 166. "/>If you run an Aleph server for a group of researchers, you can easily enable them to search email dumps; all they need is a web browser and an Aleph account.</li>
</ul>

<p class="TX">Using Aleph for email dumps has a few downsides. First, it requires a lot of technical work to spin up an Aleph server and to index datasets, especially if you plan on putting it on the internet for others to use. In my experience, if you try to import large datasets like email dumps into Aleph, you’re likely to run into technical hurdles with your Docker setup. Using Thunderbird is a simpler solution.</p>

<p class="TX">Aleph also can’t properly index MBOX files; it tries to index them as text files rather than as collections of different email messages. It won’t do any Base64-decoding of the data inside MBOX files, so it’s not much more useful than <samp class="SANS_TheSansMonoCd_W5Regular_11">grep</samp> for this task. If you want an MBOX-formatted email dump indexed in your Aleph server, import it into Thunderbird and then export it again (using ImportExportTools NG) in EML format.</p>

<p class="TX">Aleph has other quirks that make working with email dumps more complicated. For example, if there’s an email attachment in a format Aleph doesn’t understand, it just won’t display the attachment at all when you view that email message. If you want to be sure you’re seeing everything in the email, download an individual EML file from Aleph and open it in Thunderbird.</p>

<p class="TX">In sum, Outlook is a reasonable choice for PST files, and Aleph is a good choice if you’re working with groups of people or want to cross-reference an email dump with other datasets. However, Thunderbird is the simplest way to quickly start your email dump investigation, and it supports all email formats.</p>

</section>
</section>

<section epub:type="division" aria-labelledby="sec22">

<h3 class="H1" id="sec22"><span id="h-156"/><samp class="SANS_Futura_Std_Bold_B_11">Summary</samp></h3>

<p class="TNI">In this chapter, you learned how to import email dumps in the EML, MBOX, and PST formats into Thunderbird to read and search them. You read an email from the president of Nauru, got insights into the type of email the Oath Keepers receive, and explored an old email dump from the Heritage Foundation. You also saw how to use Microsoft Outlook and Aleph as alternatives to Thunderbird. You can use the skills you’ve learned here in your future email dump investigations.</p>

<p class="TX">In the next chapter, you’ll level up your technical skills for analyzing datasets by taking a crash course in Python programming.</p>

</section>
</section>

</div></body></html>