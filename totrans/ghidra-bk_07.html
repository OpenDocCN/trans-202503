<html><head></head><body><div id="sbo-rt-content"><span epub:type="pagebreak" id="page_55"/>
<h2 class="h2" id="ch05"><strong><span class="big">5</span><br/>GHIDRA DATA DISPLAYS</strong></h2>
<div class="image1"><img src="Images/com.jpg" alt="Image" width="204" height="204"/></div>
<p class="noindent">At this point, you should have some confidence creating projects, loading binaries into projects, and initiating auto analysis. Once Ghidra’s initial analysis phase is complete, it is time for you to take control. As discussed in <a href="ch04.xhtml#ch04">Chapter 4</a>, when you launch Ghidra, your adventure starts in the Ghidra Project window. When you open a file within one of your projects, a second window opens. This is the Ghidra CodeBrowser, and it’s your home base for much of your SRE efforts. You’ve already used the CodeBrowser to auto analyze your file; now we’ll take a deeper dive into the CodeBrowser menu, windows, and basic options to increase your awareness of Ghidra’s capabilities and allow you to create an SRE analysis environment that is consistent with your personal workflow. Let’s begin with the principal Ghidra data displays.</p>
<span epub:type="pagebreak" id="page_56"/>
<h3 class="h3" id="ch05lev65"><strong>CodeBrowser</strong></h3>
<p class="noindent">You can open the CodeBrowser window by selecting Tools ▸ RunTool ▸ CodeBrowser from the Ghidra Project window. Although CodeBrowser is generally opened by selecting a file for analysis, we are opening an empty instance so that the functionality and configuration options can be demonstrated without specific file-related content influencing the display, as shown in <a href="ch05.xhtml#fig5_1">Figure 5-1</a>. In its default configuration, CodeBrowser has six subwindows. Before we get into the details associated with each of these displays, let’s spend a little time looking at the CodeBrowser menu and its associated functionality.</p>
<div class="image"><img src="Images/fig5-1.jpg" alt="image" width="694" height="603"/></div>
<p class="figcap" id="fig5_1"><em>Figure 5-1: Unpopulated CodeBrowser window</em></p>
<p class="indentb">At the top of the CodeBrowser window is the main menu with a toolbar immediately below. The toolbar provides one-click shortcuts to some of the most commonly used menu options. As we do not currently have a file loaded, we will focus on the menu options that are not associated with a loaded file in this section. Other menu actions will be demonstrated and explained in context with their applicability to the SRE process.</p>
<p class="uln-indent"><strong>File</strong> Provides the basic functionality expected in most file manipulation menus, including options for Open/Close, Import/Export, Save, and Print. In addition, some options are specific to Ghidra, such as <span epub:type="pagebreak" id="page_57"/>Tool options, which allow you to save and manipulate the CodeBrowser tool, and Parse C Source, which can aid in the decompilation process by extracting data type information from C header files. (See “<a href="ch13.xhtml#ch13lev223">Parsing C Header Files</a>” on <a href="ch13.xhtml#page_269">page 269</a>.)</p>
<p class="uln-indent"><strong>Edit</strong> Includes one command that is applicable outside individual subwindows: the Edit ▸ Tool Options command, which opens a new window that allows you to control parameters and options associated with the many tools available from the CodeBrowser. The options related to the console are shown in <a href="ch05.xhtml#fig5_2">Figure 5-2</a>. The Restore Defaults button (revert to default settings) is always available at the bottom right.</p>
<div class="image"><img src="Images/fig5-2.jpg" alt="image" width="694" height="649"/></div>
<p class="figcap" id="fig5_2"><em>Figure 5-2: CodeBrowser Console edit options</em></p>
<p class="uln-indent"><strong>Analysis</strong> Allows you to reanalyze a binary or selectively perform individual analysis tasks. The basic analysis options were introduced in “<a href="ch04.xhtml#ch04lev56">Analyzing Files with Ghidra</a>” on <a href="ch04.xhtml#page_48">page 48</a>.</p>
<p class="uln-indent"><strong>Navigation</strong> Facilitates navigation within files. This menu provides the basic keyboard functionality supported by many applications and adds special navigation options for binaries. While the menu provides one <span epub:type="pagebreak" id="page_58"/>method for moving through a file, you will likely use toolbar options or shortcuts (listed at the right of each menu option) after you gain experience with the many options available for navigation.</p>
<p class="uln-indent"><strong>Search</strong> Provides search capabilities for memory, program text, strings, address tables, direct references, instruction patterns, and much more. Basic searching functionality is introduced in “<a href="ch06.xhtml#ch06lev114">Searching</a>” on <a href="ch06.xhtml#page_114">page 114</a>. More specialized search concepts are presented in context as part of the many examples in subsequent chapters.</p>
<p class="uln-indent"><strong>Select</strong> Provides the capability to identify a portion of the file to consider for a specific task. Selections can be based on subroutines, functions, control flows, or simply by highlighting a desired portion of the file.</p>
<p class="uln-indent"><strong>Tools</strong> Includes some interesting features that allow you to place additional SRE resources on your desktop. One of the most useful is the Processor Manual option, which brings up the processer manual associated with the current file. If you attempt to open a missing processor manual, you will be provided with a method to include the manual, as shown in <a href="ch05.xhtml#fig5_3">Figure 5-3</a>.</p>
<div class="image"><img src="Images/fig5-3.jpg" alt="image" width="694" height="282"/></div>
<p class="figcap" id="fig5_3"><em>Figure 5-3: Missing Processor Manual message</em></p>
<p class="uln-indent"><strong>Window</strong> Allows you to configure your Ghidra work environment for your workflow. We spend most of this chapter introducing and investigating the default Ghidra windows as well as some others that you will find helpful.</p>
<p class="uln-indent"><strong>Help</strong> Provides rich, well-organized, and very detailed options. The Help window supports searching, different views, favorites, zooming in/out, as well as printing and page setup options.</p>
<h3 class="h3" id="ch05lev66"><strong>CodeBrowser Windows</strong></h3>
<p class="noindent">The expanded Window menu can be seen running down the center of <a href="ch05.xhtml#fig5_4">Figure 5-4</a>. By default, six of the available windows are opened when CodeBrowser is launched: Program Trees, Symbol Tree, Data Type <span epub:type="pagebreak" id="page_59"/>Manager, Listing, Console, and Decompiler. The name of each window is displayed at the top left of the associated window. Each of these windows appears as an option on the Window menu, and some also have associated icons on the toolbar directly below the menu. (As an example, we’ve used arrows in <a href="ch05.xhtml#fig5_4">Figure 5-4</a> to highlight the toolbar option and menu option for opening and accessing the Decompiler window.)</p>
<div class="box5">
<p class="boxtitle-c"><strong>HOTKEYS AND BUTTONS AND BARS, OH MY!</strong></p>
<p class="noindent">Almost all commonly used actions within Ghidra have an associated menu item, hotkey, and toolbar button. If they don’t, you have the power to create them! The Ghidra toolbar is highly configurable, as is the mapping of hotkeys to menu actions. (See CodeBrowser Edit ▸ Tool Options ▸ Key Bindings or just hover over a command and press F4.) As if this wasn’t enough, Ghidra also offers good, context-sensitive menu actions in response to right mouse clicks. While these context-sensitive menus do not offer an exhaustive list of permissible actions at a given location, they do serve as good reminders for the most common actions you will be performing. This flexibility allows you to perform an action using the means most comfortable to you <em>and</em> to customize the environment as you discover how Ghidra can work for you.</p>
</div>
<div class="image"><img src="Images/fig5-4.jpg" alt="image" width="676" height="500"/></div>
<p class="figcap" id="fig5_4"><em>Figure 5-4: CodeBrowser window with options to display Decompiler window emphasized</em></p>
<p class="indent">Let’s dive into the six default windows to understand their fundamental importance in the SRE process.</p>
<span epub:type="pagebreak" id="page_60"/>
<div class="box5">
<p class="boxtitle-c"><strong>WINDOW INSIDERS AND OUTSIDERS</strong></p>
<p class="noindent">As you begin exploring the various Ghidra windows, you will notice that, by default, some windows open within the CodeBrowser desktop and others open as new floating windows outside the CodeBrowser desktop. Let’s take a minute to talk about these “insiders” and “outsiders” in the context of the Ghidra environment.</p>
<p class="indent">The “outsider” windows float outside the CodeBrowser environment and may be connected or independent. These windows allow you to explore their contents side by side with CodeBrowser. Examples of these windows are Function Graph, Comments, and Memory Map.</p>
<p class="indent">Next, there are three distinct classes of “insider” windows:</p>
<ul>
<li>Windows that open by default in CodeBrowser (for example, Symbol Tree and Listing)</li>
<li>Windows that are stacked with a default CodeBrowser window (for example, Bytes)</li>
<li>Windows that create or share space with other CodeBrowser windows (for example, Equates and External Programs)</li>
</ul>
<p class="indent">When you open a window that shares a space with another open window, it appears in front of the existing window. All windows sharing the same space are tabbed to allow rapid navigation between windows. If you want to view two windows that share a space simultaneously, you can click the title bar of the window and drag it outside the CodeBrowser window.</p>
<p class="indent">But be careful! Getting windows back into the CodeBrowser window is not as easy as moving them out. (See “<a href="ch12.xhtml#ch12lev209">Rearranging Windows</a>” on <a href="ch12.xhtml#page_242">page 242</a> for more details.)</p>
</div>
<div class="box5">
<p class="boxtitle-c"><strong>WHERE’S MY WINDOW?</strong></p>
<p class="noindent">Ghidra has a lot of windows, and it can be challenging to keep track of where they are at any particular time. This becomes even more complicated as you open more windows and others disappear behind them in CodeBrowser or on your desktop. Ghidra has a unique feature to help you locate those missing windows. Clicking the associated toolbar icon or menu item will move the selected window to the front, but that might not be enough. If you continue clicking the toolbar icon for the window, your missing window will try to catch your attention by vibrating, changing font size or colors, zooming, spinning, and other exciting motions that are sure to catch your eye to help you find it. If you are bored, you can wave back.</p>
</div>
<span epub:type="pagebreak" id="page_61"/>
<h4 class="h4" id="ch05lev67"><strong><em>The Listing Window</em></strong></h4>
<p class="noindent">Also known as the Disassembly window, the Listing window will be your primary tool for viewing, manipulating, and analyzing Ghidra-generated disassemblies. The text display presents the entire disassembly listing of a program and provides the primary means for viewing the data regions of a binary.</p>
<p class="indent">The CodeBrowser display for <em>ch5_example1.exe</em> is shown in its default configuration in <a href="ch05.xhtml#fig5_5">Figure 5-5</a>. The margin to the left of the Listing window provides important information about the file as well as your location within the file. There is an additional marker area on the right side of the Listing window (immediately to the right of the vertical scroll bar) that also provides important information and navigational capabilities. The scroll bar indicates your location within the file and can be used for navigation. To the immediate right of the scroll bar are some informational displays, including bookmarks, that provide additional insight into the file.</p>
<div class="image"><img src="Images/fig5-5.jpg" alt="image" width="694" height="544"/></div>
<p class="figcap" id="fig5_5"><em>Figure 5-5: Default CodeBrowser window with</em> ch5_example1.exe <em>loaded</em></p>
<span epub:type="pagebreak" id="page_62"/>
<div class="box5">
<p class="boxtitle-c"><strong>YOUR FAVORITE BARS</strong></p>
<p class="noindent">After a file is auto analyzed, you can use informational margin bars to help you navigate and further analyze the file. By default, only the Navigation bar is displayed. You can choose to add (or hide) the Overview bar and Entropy bar by using the Toggle Overview Margin tool button at the top right of the Listing window (see <a href="ch05.xhtml#fig5_6">Figure 5-6</a>). Regardless of which bars are displayed, a navigation marker to the left of all of the bars reminds you of where you are in the file. Left-clicking any location in any of the bars will move you to that location in the file and update the contents of the Listing window.</p>
<p class="indentb">Now that you know how to control the appearance (and disappearance) of the bars, let’s investigate what each bar shows and how you might use it in your SRE process:</p>
<p class="uln-indent"><strong>Navigation Marker area</strong> Allows you to move through the file, but it also has another very important function: if you right-click the Navigation Marker area, you will see the classes of markers and bookmarks that can be associated with your file. By selecting and deselecting marker types, you can control what is displayed in the Navigation bar. This allows you to easily move through particular types of markers (such as highlights).</p>
<p class="uln-indent"><strong>Overview bar</strong> Provides you with important visual information about the contents of a file. The horizontal bands in the Overview bar represent color-coded regions of the program. While Ghidra provides default colors associated with common categories, such as functions, external references, data, and instructions, you can control the color scheme through the Edit ▸ Tool Options menu. By default, if you hover over a region, you can view detailed information about that region, including the region type and an associated address, if applicable.</p>
<p class="uln-indent"><strong>Entropy bar</strong> Provides a unique Ghidra functionality: it “stereotypes” file content based on the file content around it. If there is very little variation within a region, it is assigned a low entropy value. If there is high degree of randomness, the corresponding entropy value is high. Hovering your mouse over a horizontal band in the Entropy bar will give you the entropy value (between 0.0 and 8.0), a type (for example, <em>.text</em>), as well as the associated address in the file. The highly configurable Entropy bar can be used to help determine the most likely content in the band. More information about this capability and the mathematics behind it can be discovered in the Ghidra Help menu.</p>
</div>
<span epub:type="pagebreak" id="page_63"/>
<p class="indent"><a href="ch05.xhtml#fig5_6">Figure 5-6</a> provides a breakdown of tool buttons specific to the Listing window. In <a href="ch05.xhtml#fig5_7">Figure 5-7</a>, we have expanded and zoomed in on the Listing window to investigate what is shown. The disassembly is presented in linear fashion, with the leftmost column displaying virtual addresses by default.</p>
<div class="image"><img src="Images/fig5-6.jpg" alt="image" width="684" height="459"/></div>
<p class="figcap" id="fig5_6"><em>Figure 5-6: Listing window tool buttons</em></p>
<div class="image"><img src="Images/fig5-7.jpg" alt="image" width="690" height="501"/></div>
<p class="figcap" id="fig5_7"><em>Figure 5-7: Listing window with labeled example artifacts</em></p>
<span epub:type="pagebreak" id="page_64"/>
<p class="indent">Within the Listing window are several items that merit your attention. The gray band at the far left of the window is the margin marker. It is used to indicate your current location in the file and includes point markers and area markers, which are described in Ghidra Help. In this example, the current file location (<span class="literal">004011b6</span>) is indicated in the margin marker by the small black arrow.</p>
<p class="indent">The region immediately to the right of the margin marker is used to graphically depict nonlinear flow within a function.<sup><a id="ch05fn1a" href="footnotes.xhtml#ch05fn1">1</a></sup> When the source or target address for a control flow instruction is visible in the Listing window, associated flow arrows appear. Solid arrows represent unconditional jumps, while dashed arrows represent conditional jumps. Hovering over a flow line opens a tool tip that displays the start and end address of the flow along with the flow type. When a jump (conditional or unconditional) transfers control to an earlier address in the program, it is often indicative of a loop. This is demonstrated in <a href="ch05.xhtml#fig5_7">Figure 5-7</a> by the flow arrow from address <span class="literal">004011cf</span> to <span class="literal">004011c5</span>. You can easily navigate to the source or destination of any jump by double-clicking the associated flow arrow.</p>
<p class="indent">The declarations at the top of <a href="ch05.xhtml#fig5_7">Figure 5-7</a> show Ghidra’s best estimate concerning the layout of the function’s stack frame.<sup><a id="ch05fn2a" href="footnotes.xhtml#ch05fn2">2</a></sup> Ghidra computes the structure of a function’s stack frame (local variables) by performing detailed analysis of the behavior of the stack pointer and any stack frame pointer used within a function. Stack displays are discussed further in <a href="ch06.xhtml#ch06">Chapter 6</a>.</p>
<p class="indent">Listings generally have numerous data and code <em>cross-references</em> indicated by <em>XREF</em>, seen on the right side of <a href="ch05.xhtml#fig5_7">Figure 5-7</a>. A cross-reference is created anytime one location in the disassembly refers to another location in the disassembly. For example, an instruction at address A jumping to an instruction at address B would result in the creation of a cross-reference from A to B. Hovering over a reference address causes a reference pop-up to appear with the referencing location. The reference pop-up is in the same layout as the Listing window but has a yellow background (similar to a tool tip pop-up). The pop-up window allows you to view the content but does not allow you to follow the references. Cross-references are the subject of <a href="ch09.xhtml#ch09">Chapter 9</a>.</p>
<h4 class="h4" id="ch05lev68"><strong><em>Creating Additional Disassembly Windows</em></strong></h4>
<p class="noindent">If you ever find yourself wanting to view a listing of two functions simultaneously, all you need to do is open another disassembly window by using the Snapshot icon in the Listing toolbar (refer to <a href="ch05.xhtml#fig5_6">Figure 5-6</a>). The first disassembly <span epub:type="pagebreak" id="page_65"/>window opened has the prefix <em>Listing:</em> before the filename. All subsequent disassembly windows are titled <em>[Listing: &lt;filename&gt;]</em> to indicate that they are disconnected from the primary display. The snapshots are disconnected so you can navigate freely through them without affecting other windows.</p>
<div class="box5">
<p class="boxtitle-c"><strong>CONFIGURING LISTING WINDOWS</strong></p>
<p class="noindent">A disassembly listing may be decomposed into a number of component fields, including information such as a mnemonic field, an address field, and a comment field. The listings we have seen so far have been composed from a default set of fields that provide important information about the file. However, sometimes the default view does not provide the information you would like to see. Enter the Browser Field Formatter.</p>
<p class="indent">The Browser Field Formatter provides you the ability to customize over 30 fields to ensure you have ultimate control over the appearance of your Listing windows. You can activate the Browser Field Formatter by clicking the button in the Listing toolbar (refer to <a href="ch05.xhtml#fig5_6">Figure 5-6</a>). This opens a powerful submenu and layout editor, seen in <a href="ch05.xhtml#fig5_8">Figure 5-8</a>, at the top of the listing. The Browser Field Formatter allows you to control the appearance of address breaks, plate comments, functions, variables, instructions, data, structures, and arrays. Within each of these categories are fields that you can adjust, tune, and control to create the perfect listing format for you. We stick primarily with the default formats for listings, but you should explore the Browser Field Formatter to determine whether any options improve your understanding of the Listing window contents.</p>
<div class="image"><img src="Images/fig5-8.jpg" alt="image" width="640" height="554"/></div>
<p class="figcap" id="fig5_8"><em>Figure 5-8: Listing window with Browser Field Formatter activated</em></p>
</div>
<span epub:type="pagebreak" id="page_66"/>
<h4 class="h4" id="ch05lev69"><strong><em>Ghidra Function Graph View</em></strong></h4>
<p class="noindent">While assembly listings are interesting and informative, the flow of the program might be easier to understand by viewing a graph-based display. You can open a Function Graph window associated with the CodeBrowser by choosing Window ▸ Function Graph or clicking the associated icon in the CodeBrowser toolbar. The Function Graph window corresponding to the function in <a href="ch05.xhtml#fig5_7">Figure 5-7</a> is shown in <a href="ch05.xhtml#fig5_9">Figure 5-9</a>. Graph views are somewhat reminiscent of program flowcharts in that a function is broken into basic blocks so you can visualize the function’s control flow from one block to another.<sup><a id="ch05fn3a" href="footnotes.xhtml#ch05fn3">3</a></sup></p>
<div class="image"><img src="Images/fig5-9.jpg" alt="image" width="642" height="642"/></div>
<p class="figcap" id="fig5_9"><em>Figure 5-9: Graph view of listing from <a href="ch05.xhtml#fig5_7">Figure 5-7</a></em></p>
<span epub:type="pagebreak" id="page_67"/>
<p class="indent">Onscreen, Ghidra uses different-colored arrows to distinguish various types of flows between the blocks of a function. In addition, the flows become animated as you mouse over them to indicate direction. Basic blocks that terminate with a conditional jump generate two possible flows: the <em>Yes edge</em> arrow (yes, the tested condition was met) is green by default, and the <em>No edge</em> arrow (no, the tested condition was not met) is red by default. Basic blocks that terminate with only one potential successor block use a <em>Normal edge</em> (blue by default) to point to the next block to be executed. You can click any arrow to see the associated transition from one block to another. Since the graph and listing tools are synchronized by default, your file location will generally remain consistent when switching between and navigating within the listing view and graph view. Exceptions are discussed in <a href="ch10.xhtml#ch10">Chapter 10</a> as well as in Ghidra Help.</p>
<p class="indent">In graph mode, Ghidra displays one function at a time. Ghidra facilitates navigation around the graph by using traditional image interaction techniques such as pan and zoom. Large or complex functions may cause the graph to become extremely cluttered, making the graph difficult to navigate, which is where the Satellite View can help you. By default, the Satellite View is positioned at the bottom right of the graph window and can be a valuable aid to provide some situational awareness (see <a href="ch05.xhtml#fig5_9">Figure 5-9</a>).</p>
<div class="box5">
<p class="boxtitle-c"><strong>SATELLITE NAVIGATION</strong></p>
<p class="noindent">The Satellite View always displays the complete block structure of the graph along with a highlighted frame that indicates the region of the graph currently being viewed in the disassembly window. Clicking any block in the Satellite View centers the graph around that block. The highlighted frame acts as a lens and can be dragged around the overview window to rapidly reposition the graph view to any location on the graph. In addition to providing a means to navigate the Function Graph window, this magical window has other powers that can work for or against you as you examine files.</p>
<p class="indent">This window consumes valuable space in your Function Graph window and can hide important blocks and contents just when you want to see them. There are two approaches to remedy this situation. You can right-click the Satellite View and uncheck the Dock Satellite View checkbox. This will move the Satellite View and its full functionality outside the Function Graph window. Rechecking the option at any time will move it back to its original location in the Function Graph window.</p>
<p class="indent">A second option is to hide the Satellite View, provided you don’t need to use it to navigate. This is another checkbox available in the right-click context menu. When you hide the Satellite View, a small icon will appear in the bottom right of the Function Graph window. Clicking this icon will restore the Satellite View.</p>
<p class="indent">When visible, the Satellite View can cause the primary view to behave more slowly than desired. Hiding the Satellite View can help to make it more responsive.</p>
</div>
<span epub:type="pagebreak" id="page_68"/>
<div class="box5">
<p class="boxtitle-c"><strong>TOOLS MAKING CONNECTIONS</strong></p>
<p class="noindent">Tools can operate together or independently. We have seen how the Listing window and the Function Graph window share data and how events that occur in one window affect the other. If you select a particular block in the Function Graph window, the corresponding code will be highlighted in the Listing window. Conversely, navigating between functions in the Listing window will cause the Function Graph window to be updated. This is one of the many tool connections that happens automatically and is bidirectional. Ghidra also has capabilities for unidirectional connections as well as the ability to manually connect and disconnect tools using a producer/consumer model associated with tool events. In this book, we focus on the bidirectional automatic tool connections that Ghidra provides.</p>
</div>
<p class="indent">In addition to navigating with the Satellite View, you can manipulate the view within the Function Graph window in many ways to suit your needs:</p>
<p class="uln-indent"><strong>Panning</strong> First, in addition to using the Satellite View to rapidly reposition the graph, you can reposition the graph by clicking and dragging the background to change the graph view.</p>
<p class="uln-indent"><strong>Zooming</strong> You can zoom in and out using traditional keyboard methods such as <span class="small">CTRL/COMMAND,</span> a mouse scroll, or associated key bindings. If you zoom out too far, you may pass the <em>painting threshold</em>, where the block contents are no longer displayed. Each block just becomes a colored rectangle. In some cases, particularly when working side by side with the Listing window, this might be advantageous, as it improves the speed at which the function graph can be rendered.</p>
<p class="uln-indent"><strong>Rearranging blocks</strong> Individual blocks within the graph can be dragged to new positions by clicking the title bar for the desired block and dragging it to a new position. All links between blocks are preserved as you move the blocks. If at any point you find yourself wishing to revert to the default layout for your graph, you can do so by selecting the Refresh icon in the Function Graph toolbar.</p>
<p class="uln-indent"><strong>Grouping and collapsing blocks</strong> Blocks can be grouped, either individually or together with other blocks, and collapsed to reduce the <span epub:type="pagebreak" id="page_69"/>clutter in the display. Grouping causes a block to collapse. Collapsing blocks is an easy method to keep track of the blocks you have analyzed. You can collapse any block by choosing the Group icon in the far right of the block toolbar. If you choose this option with multiple blocks selected, they will be collapsed, and the list of associated blocks will be displayed in the stacked window. Some nuances are associated with forming/unforming groups as well as performing actions on the newly formed groups that are explained in Ghidra Help.</p>
<div class="box5">
<p class="boxtitle-c"><strong>CUSTOMIZING YOUR GRAPH DISPLAY</strong></p>
<p class="noindent">To help you with your analysis, Ghidra provides a menu bar at the top of each node in the Function Graph display that allows you to control the display for that particular node. You can control background/text color for the node, jump to an XREF, view a full window listing of the graph node, and use grouping functionality to combine and collapse nodes. (Note that changing the background for a block in the Function Graph also changes the background in the Listing window.) Some of these features might be unnecessary if you are actively using the Listing window in conjunction with the Function Graph window, but the customization options may be helpful and are certainly worth investigating. These options are discussed further in <a href="ch10.xhtml#ch10">Chapter 10</a>.</p>
</div>
<p class="indent">As the graph-based display opens in a window external to CodeBrowser, you can view the two displays side by side. Because the windows have a connection, changing locations in one of the windows moves the location marker in the other window. While many users tend to prefer one view over the other to visualize program flow, you don’t have to choose only one. Also, keep in mind that your control over the graph and text views extends far beyond these examples. Additional Ghidra graphing capabilities are covered in <a href="ch10.xhtml#ch10">Chapter 10</a>, while more information on the manipulation of Ghidra’s view options is available in Ghidra Help.</p>
<p class="indent">For the next five chapters, we primarily focus on the listing display for examples, supplemented with the graph display in cases where it adds significant clarity. In <a href="ch06.xhtml#ch06">Chapter 6</a> we will focus on understanding a Ghidra disassembly, and in <a href="ch07.xhtml#ch07">Chapter 7</a>, we cover the specifics of manipulating the listing display in order to clean up and annotate a disassembly.</p>
<span epub:type="pagebreak" id="page_70"/>
<div class="box5">
<p class="boxtitle-c"><strong>MOVING AROUND</strong></p>
<p class="noindent">In addition to traditional means of navigating a file (up arrow, down arrow, page up, page down, and so on), Ghidra provides navigation tools specific to the SRE process. The icons in the Navigation toolbar (shown in <a href="ch05.xhtml#fig5_10">Figure 5-10</a>) make it easy to move through the program. Let’s meet the icons that serve the reverse engineer.</p>
<div class="image"><img src="Images/fig5-10.jpg" alt="image" width="353" height="47"/></div>
<p class="figcap" id="fig5_10"><em>Figure 5-10: CodeBrowser Navigation toolbar</em></p>
<p class="indent">On the far left is the Direction icon. This arrow toggles between up and down and controls the direction for all of the other navigation icons. The next eight icons advance you through the various targets shown in <a href="ch05.xhtml#fig5_11">Figure 5-11</a>.</p>
<div class="image"><img src="Images/fig5-11.jpg" alt="image" width="217" height="345"/></div>
<p class="figcap" id="fig5_11"><em>Figure 5-11: Navigation toolbar definitions</em></p>
<p class="indent">Rather than just advancing you to the next data in the listing, choosing the Data option skips over adjacent data and takes you to the start of the next nonadjacent data. Instruction and Undefined demonstrate the same behavior.</p>
<p class="indent">The drop-down arrow at the far right of the Navigation toolbar displays a list that allows you to select among specific bookmark types for quick navigation. While used primarily with the Listing window, these navigation shortcuts work in all windows that are connected to the Listing window. Navigating within any of these windows results in synchronous navigation in all connected windows.</p>
</div>
<span epub:type="pagebreak" id="page_71"/>
<h4 class="h4" id="ch05lev70"><strong><em>The Program Trees Window</em></strong></h4>
<p class="noindent">Let’s return to our discussion of the default CodeBrowser windows by taking a brief look at the Program Trees window, shown in <a href="ch05.xhtml#fig5_12">Figure 5-12</a>.</p>
<div class="image"><img src="Images/fig5-12.jpg" alt="image" width="301" height="380"/></div>
<p class="figcap" id="fig5_12"><em>Figure 5-12: Program Trees window</em></p>
<p class="indent">This window shows your program organized into folders and fragments and provides you with the ability to refine the organization that takes place during auto analysis. <em>Fragment</em> is a Ghidra term for a contiguous range of addresses. Fragments may not overlap one another. A more traditional name for a fragment is a <em>program section</em> (for example, <em>.text</em>, <em>.data</em>, and <em>.bss</em>). Program tree–related operations include the following:</p>
<ul>
<li class="noindent">Create folder/fragment</li>
<li class="noindent">Expand/Collapse/Merge folders</li>
<li class="noindent">Add/Remove folders/fragments</li>
<li class="noindent">Identify content in Listing window and move to a fragment</li>
<li class="noindent">Sort by name/address</li>
<li class="noindent">Select addresses</li>
<li class="noindent">Copy/Cut/Paste fragment/folders</li>
<li class="noindent">Reorder folders</li>
</ul>
<p class="indent">The Program Trees window is a connected window, so clicking a fragment in the window navigates you to that location in the Listing window. More information about the Program Trees window can be found in Ghidra Help.</p>
<span epub:type="pagebreak" id="page_72"/>
<h4 class="h4" id="ch05lev71"><strong><em>The Symbol Tree Window</em></strong></h4>
<p class="noindent">When you import a file into a Ghidra project, a Ghidra loader module is selected to load the file content. When present in the binary, the loader is capable of extracting symbol table information (discussed in <a href="ch02.xhtml#ch02">Chapter 2</a>) for display in the Symbol Tree window shown in <a href="ch05.xhtml#fig5_13">Figure 5-13</a>. The Symbol Tree window includes the imports, exports, functions, labels, classes, and namespaces associated with a program. Each of these categories and associated symbol types are discussed in the sections that follow.</p>
<div class="image"><img src="Images/fig5-13.jpg" alt="image" width="321" height="598"/></div>
<p class="figcap" id="fig5_13"><em>Figure 5-13: CodeBrowser Symbol Tree window</em></p>
<p class="indent">All six of the Symbol Tree folders can be controlled by the filter at the bottom of the Symbol Tree window. This functionality will become more valuable as you get to know the file that you are analyzing. In addition, you will find the Symbol Tree window offers functionality similar to command line tools such as <span class="literal">objdump</span> (<span class="literal">-T</span>), <span class="literal">readelf</span> (<span class="literal">-s</span>), and <span class="literal">dumpbin</span> (<span class="literal">/EXPORTS</span>).</p>
<h5 class="h5" id="ch05lev72"><strong>Imports</strong></h5>
<p class="noindent">The <em>Imports</em> folder in the Symbol Tree window lists all functions that are imported by the binary being analyzed. It is relevant only when a binary makes use of shared libraries—statically linked binaries have no external dependencies and therefore no imports. The <em>Imports</em> folder lists imported <span epub:type="pagebreak" id="page_73"/>libraries with entries for each item (function or data) imported from that library. Clicking any symbol within the Symbol Tree view jumps all connected displays to the selected symbol. In our sample Windows binary, clicking the <span class="literal">GetModuleHandleA</span> in the <em>Imports</em> folder would jump the disassembly window to the import address table entry for <span class="literal">GetModuleHandleA</span>, which in this example resides at address <span class="literal">0040e108</span>, as shown in <a href="ch05.xhtml#fig5_14">Figure 5-14</a>.</p>
<div class="image"><img src="Images/fig5-14.jpg" alt="image" width="844" height="336"/></div>
<p class="figcap" id="fig5_14"><em>Figure 5-14: Import address table entry and associated location in Listing window</em></p>
<p class="indent">An important point to remember about the Imports category is that it displays only the symbols named in the binary’s import table. Symbols that a binary chooses to load on its own using a mechanism such as <span class="literal">dlopen/dlsym</span> or <span class="literal">LoadLibrary/GetProcAddress</span> will not be listed in the Symbol Tree window.</p>
<h5 class="h5" id="ch05lev73"><strong>Exports</strong></h5>
<p class="noindent">The <em>Exports</em> folder lists the entry points into the file. These include the program’s execution entry point, as specified in its header section, along with any functions and variables that the file exports for use by other files. Exported functions are commonly found in shared libraries such as Windows DLL files. Exported entries are listed by name, and the corresponding virtual address will be highlighted in the Listing window when the export is selected. For executable files, the <em>Exports</em> folder always contains at least one entry: the program’s execution entry point. Ghidra may name this symbol <span class="literal">entry</span> or <span class="literal">_start</span>, depending on the binary’s type.</p>
<h5 class="h5" id="ch05lev74"><strong>Functions</strong></h5>
<p class="noindent">The <em>Functions</em> folder contains a list of every function that Ghidra has identified in the binary. Hovering over a function name in the Symbol Tree window generates a pop-up with detailed information about the function, as shown in <a href="ch05.xhtml#fig5_15">Figure 5-15</a>. As part of the loading process, the loader utilizes various algorithms, including file structure analysis and byte sequence matching to infer the compiler that was used to create the file. During the analysis phase, the <em>Function ID</em> analyzer utilizes the compiler identification <span epub:type="pagebreak" id="page_74"/>information to perform hash-based function body matching in order to identify the presence of library function bodies that may have been linked into the binary. When a hash match is made, Ghidra retrieves the matched function’s name from the hash database (contained in Ghidra <em>.fidbf</em> files) and adds the name as a function symbol. Hash matching is particularly useful on stripped binaries, as it provides a means of symbol recovery that is independent of the presence of a symbol table. This functionality is discussed in more depth in “<a href="ch13.xhtml#ch13lev226">Function IDs</a>” on <a href="ch13.xhtml#page_272">page 272</a>.</p>
<div class="image"><img src="Images/fig5-15.jpg" alt="image" width="694" height="626"/></div>
<p class="figcap" id="fig5_15"><em>Figure 5-15: Symbol Tree Functions folder pop-up</em></p>
<h5 class="h5" id="ch05lev75"><strong>Labels</strong></h5>
<p class="noindent">The <em>Labels</em> folder is the data equivalent of the <em>Functions</em> folder. Any data symbols contained in a binary’s symbol table will be listed in the <em>Labels</em> folder. In addition, anytime you add a new label name to a data address, that label will be added to the <em>Labels</em> folder.</p>
<h5 class="h5" id="ch05lev76"><strong>Classes</strong></h5>
<p class="noindent">The <em>Classes</em> folder contains an entry for each class identified by Ghidra during its analysis phase. Under each, Ghidra lists the identified data and methods that may assist you in understanding the behavior of the class. <span epub:type="pagebreak" id="page_75"/>C++ classes and the structures that Ghidra uses to populate the classes folder are discussed in more detail in <a href="ch08.xhtml#ch08">Chapter 8</a>.</p>
<h5 class="h5" id="ch05lev77"><strong>Namespaces</strong></h5>
<p class="noindent">In the <em>Namespaces</em> folder, Ghidra may create new namespaces to provide organization and ensure that assigned names do not conflict in the binary. For example, a namespace may be created for each identified external library or for each switch statement that uses jump tables (allowing jump table labels to be reused in other switch statements without conflicting).</p>
<h4 class="h4" id="ch05lev78"><strong><em>The Data Type Manager Window</em></strong></h4>
<p class="noindent">The Data Type Manager window allows you to locate, organize, and apply data types to your file by using a system of data type archives. Archives represent Ghidra’s accumulated knowledge of predefined data types gleaned from header files included with most popular compilers. By processing header files, Ghidra understands the data types that are expected by common library functions and can annotate your disassembly and decompiler listings accordingly. Similarly, from these header files, Ghidra understands both the size and layout of complex data structures. All of this information is collected into archive files and applied anytime a binary is analyzed.</p>
<p class="indent">Referring back to <a href="ch05.xhtml#fig5_4">Figure 5-4</a>, you can see that the root of the BuiltInTypes tree, which contains primitive types like <span class="literal">int</span> that cannot be changed, renamed, or moved within a data type archive, is displayed in the Data Type Manager window (bottom left of the CodeBrowser window) even without a program loaded. In addition to the built-in types, Ghidra supports the creation of user-defined data types, including structures, unions, enums, and typedefs. It also supports arrays and pointers as derived data types.</p>
<p class="indent">Each file you open has an associated entry in the Data Type Manager window, as shown previously in <a href="ch05.xhtml#fig5_5">Figure 5-5</a>. The folder shares the name of the current file and entries within the folder are specific to the current file.</p>
<p class="indent">The Data Type Manager window displays nodes for each of the data type archives that are open. Archives can be opened automatically, such as when a program references an archive, or manually by the user. Data types and the Data Type Manager are covered in more detail in <a href="ch08.xhtml#ch08">Chapters 8</a> and <a href="ch13.xhtml#ch13">13</a>.</p>
<h4 class="h4" id="ch05lev79"><strong><em>The Console Window</em></strong></h4>
<p class="noindent">The Console window at the bottom of the CodeBrowser window serves as Ghidra’s output area for plugins and scripts, including those you develop yourself, and is the place to look for information on tasks Ghidra is performing as you work with a file. Developing scripts and plugins is introduced in <a href="ch14.xhtml#ch14">Chapters 14</a> and <a href="ch15.xhtml#ch15">15</a>.</p>
<h4 class="h4" id="ch05lev80"><strong><em>The Decompiler Window</em></strong></h4>
<p class="noindent">The Decompiler window allows you to simultaneously view and manipulate assembly and C representations of your binary through connected windows. The C representation that is generated by the Ghidra decompiler <span epub:type="pagebreak" id="page_76"/>isn’t always perfect, but it can be very useful in helping you to understand a binary. Basic functionality provided by the decompiler includes recovery of expressions, variables, function parameters, and structure fields. The decompiler is also often capable of recovering a function’s block structure, which tends to get obscured in assembly language, which is not block structured and makes extensive use of <span class="literal">goto</span> (or equivalent) statements to appear block structured.</p>
<p class="indent">The Decompiler window displays a C representation of a function selected in the Listing window, as shown in <a href="ch05.xhtml#fig5_16">Figure 5-16</a>. Depending on your experience with assembly language, the decompiled code may be much easier to understand than the code in the Listing window. Even beginning programmers should be able to identify the infinite loop in the decompiled function. (The <span class="literal">while</span> loop condition is dependent on the value of <span class="literal">param_3</span>, which is not modified within the loop.)</p>
<div class="image"><img src="Images/fig5-16.jpg" alt="image" width="844" height="592"/></div>
<p class="figcap" id="fig5_16"><em>Figure 5-16: Listing and Decompiler windows</em></p>
<p class="indent">The Decompiler window icons are shown in <a href="ch05.xhtml#fig5_17">Figure 5-17</a>. You can use the Snapshot icon to open additional (disconnected) Decompiler windows if you want to compare the decompiled version of multiple functions or continue viewing a particular function while moving elsewhere in the Listing window. The Export icon allows you to save the decompiled function to a C file.</p>
<p class="indent">Within the Decompiler window, context menus are available through right-clicking that allow you to perform actions associated with a highlighted <span epub:type="pagebreak" id="page_77"/>item. The options associated with one of the function parameters, <span class="literal">param_1</span>, are shown in <a href="ch05.xhtml#fig5_18">Figure 5-18</a>.</p>
<div class="image"><img src="Images/fig5-17.jpg" alt="image" width="694" height="398"/></div>
<p class="figcap" id="fig5_17"><em>Figure 5-17: Decompiler window toolbar</em></p>
<div class="image"><img src="Images/fig5-18.jpg" alt="image" width="694" height="559"/></div>
<p class="figcap" id="fig5_18"><em>Figure 5-18: Decompiler window options for function parameters</em></p>
<span epub:type="pagebreak" id="page_78"/>
<p class="indent">Decompilation is an extraordinarily complicated process, and decompiler theory remains an active research area. Unlike disassembly, whose accuracy can be verified against manufacturers’ reference manuals, there are no reference manuals that provide canonical translations of assembly language back to C (or C to assembly for that matter). In fact, while Ghidra’s decompiler always generates C source code, it may be the case that the binary the decompiler is analyzing was originally written in a language other than C, and many of the decompiler’s C-oriented assumptions may not hold at all.</p>
<p class="indent">As with most complex plugins, the decompiler has idiosyncrasies, and the quality of its output depends, to a large extent, on the quality of its input. Many of the issues and irregularities in the Decompiler window can be traced back to issues with the underlying disassembly, so if the decompiled code doesn’t make sense, you may need to spend time improving the quality of the disassembly. In most cases, this involves annotating the disassembly with more accurate data type information, which is discussed in <a href="ch08.xhtml#ch08">Chapters 8</a> and <a href="ch13.xhtml#ch13">13</a>. We continue to explore the decompiler’s capabilities in subsequent chapters and discuss it in depth in <a href="ch19.xhtml#ch19">Chapter 19</a>.</p>
<h3 class="h3" id="ch05lev81"><strong>Other Ghidra Windows</strong></h3>
<p class="noindent">In addition to the six default windows, you can open other windows to support your SRE process with alternate or specialized views into the file. The list of available windows is displayed from the Window menu, shown previously in <a href="ch05.xhtml#fig5_4">Figure 5-4</a>. The utility of these displays depends on both the characteristics of the binary you are analyzing and your skill with Ghidra. Several of these windows are sufficiently specialized to require more detailed coverage in later chapters, but we introduce some common ones here.</p>
<h4 class="h4" id="ch05lev82"><strong><em>The Bytes Window</em></strong></h4>
<p class="noindent">The Bytes window provides a raw look at the byte-level content of the file. By default, the Bytes window opens on the upper-right side of the CodeBrowser and provides a standard hex dump display of the program contents with 16 bytes per line. The window doubles as a hex editor and can be configured to display a variety of formats by using the Settings tool in the Bytes window toolbar. In many cases, it might be helpful to add the ASCII display to the Bytes window, as shown in <a href="ch05.xhtml#fig5_19">Figure 5-19</a>. The figure also shows the Byte Viewer Options dialog and toolbar icons for editing or snapshotting the byte view.</p>
<span epub:type="pagebreak" id="page_79"/>
<div class="image"><img src="Images/fig5-19.jpg" alt="image" width="694" height="471"/></div>
<p class="figcap" id="fig5_19"><em>Figure 5-19: Synchronized hex and disassembly views with Toggle and Snapshot icons emphasized</em></p>
<p class="indent">As with the Listing window, several Bytes windows can be opened simultaneously using the Snapshot icon (see <a href="ch05.xhtml#fig5_19">Figure 5-19</a>) in the Bytes window toolbar. By default, the first Bytes window has a connection to the Listing window, so scrolling in one window and clicking an element causes the other window to scroll to the same location (same virtual address). Subsequent Bytes windows are disconnected, which allows you to scroll through them independently. When a window is disconnected, the window name appears within square brackets in the window title bar.</p>
<p class="indent">To turn the Bytes window into a hex (or ASCII) editor, simply toggle the pencil icon highlighted in <a href="ch05.xhtml#fig5_19">Figure 5-19</a>. The cursor will turn red to indicate that you can edit, though you will not be able to edit at addresses that contain an existing code item such as an instruction. When you are finished editing, toggle the icon again and you will be back in read-only mode. (Note that any changes will not be reflected in disconnected Bytes windows.)</p>
<p class="indent">If the Hex column displays question marks rather than hex values, Ghidra is telling you that it is not sure what values might occupy a given virtual address range. Such is the case when a program contains a <em>bss</em> section,<sup><a id="ch05fn4a" href="footnotes.xhtml#ch05fn4">4</a></sup> which typically occupies no space within a file but is expanded by the loader to accommodate the program’s static storage requirements.</p>
<span epub:type="pagebreak" id="page_80"/>
<h4 class="h4" id="ch05lev83"><strong><em>The Defined Data Window</em></strong></h4>
<p class="noindent">The Defined Data window displays a string representation of data defined in the current program, view, or selection, along with the associated address, type, and size, as shown in <a href="ch05.xhtml#fig5_20">Figure 5-20</a>. As with most of the columnar windows, you can sort by any column in ascending or descending order by clicking the column header. Double-clicking any row in the Defined Data window causes the Listing window to jump to the address of the selected item.</p>
<p class="indent">When used with cross-references (discussed in <a href="ch09.xhtml#ch09">Chapter 9</a>), the Defined Data window provides the means to rapidly spot an interesting item and to track back to any location in the program that references that item with only a few clicks. For example, you might see the string <span class="literal">"SOFTWARE\Microsoft\Windows\Current Version\Run"</span> listed and wonder why an application is referencing this particular key within the Windows registry, and then discover that the program is setting that registry key to automatically start itself when Windows boots.</p>
<div class="image"><img src="Images/fig5-20.jpg" alt="image" width="321" height="467"/></div>
<p class="figcap" id="fig5_20"><em>Figure 5-20: Defined Data window with Filter icon emphasized</em></p>
<p class="indent">The Defined Data window has extensive filtering capabilities. In addition to the Filter bar at the bottom of the window, a Filter icon at the top right (emphasized in <a href="ch05.xhtml#fig5_20">Figure 5-20</a>) allows you to control additional data type filter options, as shown in <a href="ch05.xhtml#fig5_21">Figure 5-21</a>.</p>
<span epub:type="pagebreak" id="page_81"/>
<div class="image"><img src="Images/fig5-21.jpg" alt="image" width="437" height="585"/></div>
<p class="figcap" id="fig5_21"><em>Figure 5-21: Defined data type filter options</em></p>
<p class="indent">Every time you close the Set Data Type Filter dialog by clicking OK, Ghidra will regenerate the Defined Data window contents in accordance with the new settings.</p>
<h4 class="h4" id="ch05lev84"><strong><em>The Defined Strings Window</em></strong></h4>
<p class="noindent">The Defined Strings window displays strings that have been defined in the binary. An example of this window is shown in <a href="ch05.xhtml#fig5_22">Figure 5-22</a>. In addition to the default columns displayed in the figure, you can add columns by right-clicking in the row of column titles. Perhaps one of the most interesting available columns is the Has Encoding Error flag, which can be indicative of an issue with the character set or misidentification of a string. In addition to this window, substantial string search functionality is available in Ghidra. This is discussed in <a href="ch06.xhtml#ch06">Chapter 6</a>.</p>
<span epub:type="pagebreak" id="page_82"/>
<div class="image"><img src="Images/fig5-22.jpg" alt="image" width="580" height="675"/></div>
<p class="figcap" id="fig5_22"><em>Figure 5-22: Defined Strings window</em></p>
<h4 class="h4" id="ch05lev85"><strong><em>The Symbol Table and Symbol References Windows</em></strong></h4>
<p class="noindent">The Symbol Table window provides a summary listing of all the global names within a binary. Eight columns are displayed by default, as shown in <a href="ch05.xhtml#fig5_23">Figure 5-23</a>. The window is highly configurable, with the capability to add and delete columns in the display as well as to sort in ascending or descending order on any column. The first two default columns are Name and Location. A <em>name</em> is nothing more than a symbolic description given to a symbol defined at a <em>location</em>.</p>
<p class="indent">The Symbol Table is connected to the Listing window but provides the capability to control its interaction with the Listing window. The emphasized icon on the right in <a href="ch05.xhtml#fig5_23">Figure 5-23</a> is a toggle that determines whether a single click on a location in the Symbol Table window causes a related move in the Listing window. Regardless of the toggle selection, double-clicking any Symbol Table location entry will immediately jump the Listing view to display the selected entry. This provides a useful tool for rapidly navigating to known locations within a program listing.</p>
<span epub:type="pagebreak" id="page_83"/>
<div class="image"><img src="Images/fig5-23.jpg" alt="image" width="695" height="672"/></div>
<p class="figcap" id="fig5_23"><em>Figure 5-23: Symbol Table window with Display Symbol References and Navigation Toggle icons emphasized</em></p>
<p class="indent">There is extensive filtering capability available in the Symbol Table window and several ways to access the filtering options. The cog icon in the toolbar opens the Symbol Table Filter dialog. The dialog (with the Use Advanced Filters box checked) is shown in <a href="ch05.xhtml#fig5_24">Figure 5-24</a>. In addition to this dialog, you can use the Filter options at the bottom of the window. Thorough discussions of the symbol table filtering options are available in Ghidra Help.</p>
<p class="indent">The emphasized icon on the left in <a href="ch05.xhtml#fig5_23">Figure 5-23</a> is the Display Symbol References icon. Clicking this icon adds the Symbol References window to the Symbol Table window. By default, these two tables will appear side by side. To improve readability, you can drag the Symbol References window below the Symbol Table window, as shown in <a href="ch05.xhtml#fig5_25">Figure 5-25</a>. The connection between these two tables is unidirectional, with the Symbol References table being updated when a selection is made in the Symbol Table.</p>
<span epub:type="pagebreak" id="page_84"/>
<div class="image"><img src="Images/fig5-24.jpg" alt="image" width="694" height="581"/></div>
<p class="figcap" id="fig5_24"><em>Figure 5-24: Symbol Table Filter dialog</em></p>
<div class="image"><img src="Images/fig5-25.jpg" alt="image" width="694" height="435"/></div>
<p class="figcap" id="fig5_25"><em>Figure 5-25: Symbol Table with Symbol References</em></p>
<span epub:type="pagebreak" id="page_85"/>
<p class="indent">Like the Symbol Table window, the Symbol References window has the same column organization controls. In addition, the content of the Symbol References window is controlled by the three icons (S, I, and D) at the top right of the Symbol References toolbar. These options are mutually exclusive, meaning only one can be selected at a time:</p>
<p class="uln-indent"><strong>S icon</strong> When this icon is selected, the Symbol References window will display all <em>references to</em> the symbol that you have selected in the Symbol Table. <a href="ch05.xhtml#fig5_25">Figure 5-25</a> shows a Symbol References window with this option selected.</p>
<p class="uln-indent"><strong>I icon</strong> When this icon is selected, the Symbol References window will display all instruction references from the function that you have selected in the Symbol Table. (This list will be empty if you did not select a function entry point.)</p>
<p class="uln-indent"><strong>D icon</strong> When this icon is selected, the Symbol References window will display all data references from the function that you have selected in the Symbol Table. This list will be empty if you did not select a function entry point or if the function makes no references to any data symbols.</p>
<h4 class="h4" id="ch05lev86"><strong><em>The Memory Map Window</em></strong></h4>
<p class="noindent">The Memory Map window displays a summary listing of the memory blocks present in the program, as shown in <a href="ch05.xhtml#fig5_26">Figure 5-26</a>. Note that what Ghidra terms <em>memory blocks</em> are frequently called <em>sections</em> when discussing the structure of binary files. Information presented in the window includes the memory block (section) name, start and end addresses, length, permission flags, block type, initialized flag, as well as a space for source filename and user comments. The start and end addresses represent the virtual address range to which the program sections will be mapped at runtime.</p>
<div class="image"><img src="Images/fig5-26.jpg" alt="image" width="694" height="332"/></div>
<p class="figcap" id="fig5_26"><em>Figure 5-26: Memory Map window</em></p>
<p class="indent">Double-clicking any start or end address in the window jumps the Listing window (and all other connected windows) to the specified address. The Memory Map window toolbar provides options to add/delete blocks, move blocks, split/merge blocks, edit addresses, and set a new image base. <span epub:type="pagebreak" id="page_86"/>These features are particularly useful when reverse engineering files with nonstandard formats, as the binary’s segment structure may not have been detected by the Ghidra loader.</p>
<p class="indent">Command line counterparts to the Memory Map window include <span class="literal">objdump</span> (<span class="literal">-h</span>), <span class="literal">readelf</span> (<span class="literal">-S</span>), and <span class="literal">dumpbin</span> (<span class="literal">/HEADERS</span>).</p>
<h4 class="h4" id="ch05lev87"><strong><em>The Function Call Graph Window</em></strong></h4>
<p class="noindent">In any program, a function can both call and be called by other functions. The Function Call Graph window shows the immediate neighbors of a given function. For our purposes, we will call Y a neighbor of X if Y directly calls X or if X directly calls Y. When you open the Function Call Graph window, Ghidra determines the neighbors of the function in which the cursor is positioned and generates the associated display. This display shows a function in the context it is used in the program file, but it is just a part of the big picture.</p>
<p class="indent"><a href="ch05.xhtml#fig5_27">Figure 5-27</a> shows a function named <span class="literal">FUN_0040198c</span> that is called from <span class="literal">FUN_00401edc</span> and, in turn, makes calls to six other functions. Double-clicking any function in the window immediately jumps the Listing window and other connected windows to the selected function. Ghidra cross-references (XREFs) are the mechanisms that underlie the generation of the Function Call Graph window. XREFs are covered in more detail in <a href="ch09.xhtml#ch09">Chapter 9</a>.</p>
<div class="image"><img src="Images/fig5-27.jpg" alt="image" width="694" height="565"/></div>
<p class="figcap" id="fig5_27"><em>Figure 5-27: Function Call Graph window</em></p>
<span epub:type="pagebreak" id="page_87"/>
<div class="box5">
<p class="boxtitle-c"><strong>WHO’S CALLING?</strong></p>
<p class="noindent">While the Function Call Graph window is helpful, sometimes you need the big picture, or at least a bigger picture. The Function Call Trees window (Window ▸ Function Call Trees) allows you to see all calls to and from a selected function. The Function Call Trees window (as shown in <a href="ch05.xhtml#fig5_28">Figure 5-28</a>) has two sections: one for incoming calls and one for outgoing calls. Both incoming and outgoing calls can be expanded and collapsed, as desired.</p>
<div class="image"><img src="Images/fig5-28.jpg" alt="image" width="656" height="437"/></div>
<p class="figcap" id="fig5_28"><em>Figure 5-28: The Function Call Trees view</em></p>
<p class="indent">If you open the Function Call Tree window with the entry function selected, you can view a hierarchical representation of the program’s function calls.</p>
</div>
<h3 class="h3" id="ch05lev88"><strong>Summary</strong></h3>
<p class="noindent">At first glance, the number of displays that Ghidra offers can seem overwhelming. You may find it easiest to stick with the default displays until you are comfortable enough to begin exploring the additional display offerings. In any case, you should certainly not feel obligated to use everything that Ghidra throws at you. Not every window will be useful in every reverse engineering scenario.</p>
<p class="indent">One of the best ways to familiarize yourself with Ghidra’s displays is simply to browse around the various tabbed subwindows that Ghidra populates with data about your binary and also open a few of the other available windows. The efficiency and effectiveness of your reverse engineering sessions will improve as your comfort level with Ghidra increases.</p>
<span epub:type="pagebreak" id="page_88"/>
<p class="indent">Ghidra is a very complex tool. In addition to the windows covered in this chapter, you may encounter additional dialogs as you endeavor to master Ghidra. We introduce key dialogs as they become relevant throughout the remainder of the book.</p>
<p class="indent">At this point, you should be starting to feel more comfortable with the Ghidra interface and the CodeBrowser desktop. In the next chapter, we begin to focus on the many ways that you can manipulate a disassembly to enhance your understanding of its behavior and to generally make your life easier with Ghidra.</p>
</div>



  </body></html>