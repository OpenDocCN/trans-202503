<html><head></head><body>
<h2 class="h2" id="ch14"><span epub:type="pagebreak" id="page_289"/><span class="big"><strong>14</strong></span><br/><strong>BASIC DATA VISUALIZATION</strong></h2>&#13;
<div class="image"><img src="../images/common-01.jpg" alt="image"/></div>&#13;
<p class="noindent">Data visualization is an important part of a statistical analysis. The visualization tools appropriate for a given data set are dependent upon the types of variables (as per the definitions in <a href="ch13.xhtml#ch13lev2sec112">Sections 13.1.1</a> and <a href="ch13.xhtml#ch13lev2sec113">13.1.2</a>) for which you’ve made observations. In this chapter, you’ll look at the most commonly used data plots in statistical analyses and see examples using both base R graphics and <code>ggplot2</code> functionality.</p>&#13;
<h3 class="h3" id="ch14lev1sec44"><strong>14.1 Barplots and Pie Charts</strong></h3>&#13;
<p class="noindent">Barplots and pie charts are commonly used to visualize qualitative data by category frequency. In this section you’ll learn how to generate both using R.</p>&#13;
<h4 class="h4" id="ch14lev2sec122"><strong><em>14.1.1 Building a Barplot</em></strong></h4>&#13;
<p class="noindent">A <em>barplot</em> draws either vertical or horizontal bars, typically separated by white space, to visualize frequencies according to the relevant categories. Though <span epub:type="pagebreak" id="page_290"/>the raw frequencies themselves are usually displayed, a barplot can also be used to visualize other quantities, such as means or proportions, which directly depend upon these frequencies.</p>&#13;
<p class="indent">As an example, let’s use the <code>mtcars</code> data set from <a href="ch13.xhtml#ch13exc4">Exercise 13.4</a> (b) on <a href="ch13.xhtml#page_287">page 287</a>. Detailing various characteristics of 32 classic performance cars in the mid-1970s, the first five records can be viewed directly from the prompt.</p>&#13;
<pre>R&gt; mtcars[1:5,]<br/>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb<br/>Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4<br/>Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4<br/>Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1<br/>Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1<br/>Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2</pre>&#13;
<p class="indent">The documentation in <code>?mtcars</code> explains the variables that have been recorded. Of these, <code>cyl</code> provides the number of cylinders in each engine—four, six, or eight. To find out how many cars were observed with each number of cylinders, you can use <code>table</code>, as shown here:</p>&#13;
<pre>R&gt; cyl.freq &lt;- table(mtcars$cyl)<br/>R&gt; cyl.freq<br/> 4 6  8<br/>11 7 14</pre>&#13;
<p class="indent">The result is easily displayed as a barplot, as shown here:</p>&#13;
<pre>R&gt; barplot(cyl.freq)</pre>&#13;
<p class="indent">You can find the resulting barplot on the left of <a href="ch14.xhtml#ch14fig1">Figure 14-1</a>.</p>&#13;
<div class="image"><img src="../images/f14-01.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch14fig1"/>Figure 14-1: Two examples of barplots of data from</em> <code>mtcars</code> <em>using base R graphics. Left: The simplest, default version, using one categorical variable. Right: A “dodged” barplot illustrating various visual options and using two categorical variables.</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_291"/>This plot displays the number of four-, six-, and eight-cylinder cars in the data set but is admittedly rather uninteresting, and without annotations it’s not clear what’s being summarized. Fortunately, it’s easy to annotate such plots and further split up the frequencies of each bar according to an additional categorical variable. Consider the following code where, this time, you’re finding the counts associated with <code>cyl</code> by transmission (<code>am</code>):</p>&#13;
<pre>R&gt; table(mtcars$cyl[mtcars$am==0])<br/> 4  6  8<br/> 3  4 12<br/><br/>R&gt; table(mtcars$cyl[mtcars$am==1])<br/>4 6 8<br/>8 3 2</pre>&#13;
<p class="indent">If you aim to produce a barplot that’s <em>stacked</em> (where bars are split up vertically) or <em>dodged</em> (where bars are broken up and placed beside each other), <code>barplot</code> requests its first argument as a suitably arranged matrix. You could construct it from the previous two vectors using <code>matrix</code>, but it’s easier to just continue using <code>table</code>.</p>&#13;
<pre>R&gt; cyl.freq.matrix &lt;- table(mtcars$am,mtcars$cyl)<br/>R&gt; cyl.freq.matrix<br/><br/>     4 6  8<br/>  0  3 4 12<br/>  1  8 3  2</pre>&#13;
<p class="indent">As you can see, you can cross-tabulate counts by supplying two categorical or discrete vectors of equal length to <code>table</code>; the first vector stipulates row counts, and the second defines the columns. The outcome is a matrix object; here it’s a 2 × 3 structure providing the quantities of the four-, six-, and eight-cylinder automatic cars in the first row and the quantities of the manual cars in the second. The rule is that each column of the barplot will correspond to a column of the supplied matrix; these will be further split with respect to each row of the supplied matrix. The plot on the right of <a href="ch14.xhtml#ch14fig1">Figure 14-1</a> is the result of the following code:</p>&#13;
<pre>R&gt; barplot(cyl.freq.matrix,beside=TRUE,horiz=TRUE,las=1,<br/>           main="Performance car counts\nby transmission and cylinders",<br/>           names.arg=c("V4","V6","V8"),legend.text=c("auto","manual"),<br/>           args.legend=list(x="bottomright"))</pre>&#13;
<p class="indent">The help file <code>?barplot</code> explains the options here in detail. To label the bars according to the categories of the column variable of the matrix that was initially passed to <code>barplot</code>, you use a character vector of the appropriate length passed to <code>names.arg</code>. The options <code>beside=TRUE</code> and <code>horiz=TRUE</code> select a dodged, horizontal barplot. If both options were <code>FALSE</code>, a stacked, vertical <span epub:type="pagebreak" id="page_292"/>barplot would be selected. The argument <code>las=1</code> forces the labels on the vertical axis to appear horizontally, rather than parallel to it. The final two arguments, <code>legend.text</code> and <code>args.legend</code>, are used for the legend—you could have drawn a legend separately as in <a href="ch07.xhtml#ch07lev1sec25">Section 7.3</a> via <code>legend</code>, but this way automates the color assignment to ensure the reference keys match the precise shading of the bars themselves.</p>&#13;
<p class="indent">Similar plots may be produced using <code>ggplot2</code>. If you load the installed package with <code>library("ggplot2")</code> and enter the following, it will produce the most basic barplot, given on the left of <a href="ch14.xhtml#ch14fig2">Figure 14-2</a>:</p>&#13;
<pre>R&gt; qplot(factor(mtcars$cyl),geom="bar")</pre>&#13;
<p class="indent">Note here that the relevant geom is <code>"bar"</code> (or <code>geom_bar</code> if used separately, as you’ll see in a moment) and that the default mapping variable in <code>qplot</code> must be supplied as a factor (in <code>mtcars</code> the vector <code>mtcars$cyl</code> is just numeric, which is fine for <code>barplot</code>, but <code>ggplot2</code> functionality is a bit more strict).</p>&#13;
<div class="image"><img src="../images/f14-02.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch14fig2"/>Figure 14-2: Two examples of barplots of data from</em> <code>mtcars</code> <em>using</em> <code>ggplot2</code> <em>functionality. Left: The most simple</em> <code>qplot</code> <em>version, using one categorical variable. Right: A “dodged” barplot, the same as in <a href="ch14.xhtml#ch14fig1">Figure 14-1</a>, based on the supply of various additional geoms and scaling options.</em></p>&#13;
<p class="indent">Again, you can create far more complicated images depending upon what you want to display. To produce a <code>ggplot2</code> version of the dodged barplot from 14-1, call the following:</p>&#13;
<pre>R&gt; qplot(factor(mtcars$cyl),geom="blank",fill=factor(mtcars$am),xlab="",<br/>         ylab="",main="Performance car counts\nby transmission and cylinders")<br/>         + geom_bar(position="dodge")<br/>         + scale_x_discrete(labels=c("V4","V6","V8"))<br/>         + scale_y_continuous(breaks=seq(0,12,2))<br/>         + theme_bw() + coord_flip()<br/>         + scale_fill_grey(name="Trans.",labels=c("auto","manual"))</pre>&#13;
<p class="indent">You can find the result on the right in <a href="ch14.xhtml#ch14fig2">Figure 14-2</a>.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_293"/>Note a number of new additions to the basic <code>qplot</code> setup. The default mapping, by <code>cyl</code>, remains the same as earlier. You further specify that the bars should be filled according to a factor created by using the transmission variable <code>am</code>; so, each <code>cyl</code> bar is instructed to split according to that variable. The initial call to <code>qplot</code> was “empty,” in the sense that <code>geom="blank"</code>, and therefore drawing begins with the addition of <code>geom_bar</code> to the <code>ggplot2</code> object. It becomes a dodged barplot through <code>position="dodge"</code>; as in base R graphics, the default behavior is to generate a stacked plot. The <code>scale_x_discrete</code> modifier specifies labels for each category of the default <code>cyl</code> mapping; the <code>scale_y_continuous</code> modifier is employed to control the axis labels for the frequencies.</p>&#13;
<p class="indent">Further, adding <code>theme_bw()</code> to the object changes the visual theme of the image; in the current example, I’ve chosen to remove the gray background because it’s too similar in color to the manual car bars. Adding <code>coord_flip</code> to the object flips the axes and provides horizontal bars rather than the default vertical style (note that the calls to the <code>scale_</code> functions are used with respect to the unflipped image). The default behavior of <code>fill</code> is to use colors, so you use the <code>scale_fill_grey</code> modifier to force this to be grayscale and to alter the labels of the automatically generated legend to match at the same time.</p>&#13;
<p class="indent">The most prominent advantage of using <code>ggplot2</code> over base R graphics in this case lies in the fact that you don’t need to manually tabulate counts or design specific matrix structures of these frequencies—the variable mappings do this automatically. For practice, I encourage you to experiment with this code example, omitting or modifying some of the additions to the <code>qplot</code> object to assess the impact on the resulting image.</p>&#13;
<h4 class="h4" id="ch14lev2sec123"><strong><em>14.1.2 A Quick Pie Chart</em></strong></h4>&#13;
<p class="noindent">The venerable <em>pie chart</em> is an alternative option for visualizing frequency-based quantities across levels of categorical variables, with appropriately sized “slices” representing the relative counts of each categorical variable.</p>&#13;
<pre>R&gt; pie(table(mtcars$cyl),labels=c("V4","V6","V8"),<br/>       col=c("white","gray","black"),main="Performance cars by cylinders")</pre>&#13;
<p class="indent">You can find the resulting plot in <a href="ch14.xhtml#ch14fig3">Figure 14-3</a>.</p>&#13;
<p class="indent">Though it’s possible to achieve with some effort, there is no direct “pie” geom in <code>ggplot2</code>. This may, at least in part, be due to the general preference of statisticians for barplots over pie charts. That fact itself is even summarized in the help file <code>?pie</code>!</p>&#13;
<p class="bq">Pie charts are a bad way of displaying information. The eye is good at judging linear measures and bad at judging relative areas.</p>&#13;
<p class="indent">Furthermore, barplots are of greater value than pie charts if you want frequencies split by a <em>second</em> categorical variable or if the levels of a factor are ordered.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_294"/><img src="../images/f14-03.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch14fig3"/>Figure 14-3: A pie chart of the frequencies of total cylinders of the cars in the</em> <code>mtcars</code> <em>data frame</em></p>&#13;
<h3 class="h3" id="ch14lev1sec45"><strong>14.2 Histograms</strong></h3>&#13;
<p class="noindent">The barplot is intuitively sensible for counting observations in relation to categorical variables but is of virtually no use if the variable you’re interested in is numeric-continuous. To visualize the distribution of continuous measurements, you can use a <em>histogram</em>—a tool that’s sometimes confused with a barplot owing to its similar appearance. A histogram also measures frequencies, but in targeting a numeric-continuous variable, it’s first necessary to “bin” the observed data, meaning to define intervals and then count the number of continuous observations that fall within each one. The size of this interval is known as the <em>binwidth</em>.</p>&#13;
<p class="indent">For a simple example of a histogram, consider the horsepower data of the 32 cars in <code>mtcars</code>, given in the fourth column, named <code>hp</code>.</p>&#13;
<pre>R&gt; mtcars$hp<br/> [1] 110 110 93 110 175 105 245  62  95 123 123 180 180 180 205 215 230  66<br/>[19]  52  65 97 150 150 245 175  66  91 113 264 175 335 109</pre>&#13;
<p class="indent">For this section, define horsepowers of all performance cars from that era as your population and assume that these observations represent a sample from that population. Using base R graphics, the <code>hist</code> command takes a vector of numeric-continuous observations and produces a histogram, as shown on the left in <a href="ch14.xhtml#ch14fig4">Figure 14-4</a>.</p>&#13;
<pre>R&gt; hist(mtcars$hp)</pre>&#13;
<div class="image"><span epub:type="pagebreak" id="page_295"/><img src="../images/f14-04.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch14fig4"/>Figure 14-4: Illustrating the default behavior of</em> <code>hist</code> <em>on the</em> <code>mtcars</code> <em>horsepower data (left); customizing binwidth, color, and title options, as well as adding markers of centrality (right)</em></p>&#13;
<p class="indent">You can immediately see that the histogram on the left has used binwidths of 50 units spanning the range of the data, providing you with a quick and useful first impression of the distribution of horsepower measurements. It seems to be centered roughly in the range of 75 to 150, tapering off on the right (this is known as a <em>right</em> or <em>positive skew</em>; more terminology will be covered in <a href="ch15.xhtml#ch15lev2sec136">Section 15.2.4</a>).</p>&#13;
<p class="indent">The accuracy of a histogram as a representation of the shape of a distribution of measurements depends solely upon the widths of the intervals used to bin the data. Binwidths are controlled in <code>hist</code> by the <code>breaks</code> argument. You can manually set these by supplying a vector, giving each breakpoint, to <code>breaks</code>. This is done in the following code by halving the width of each bin from 50 to 25 and widening the overall range somewhat, using an evenly spaced sequence.</p>&#13;
<pre>R&gt; hist(mtcars$hp,breaks=seq(0,400,25),col="gray",main="Horsepower",xlab="HP")<br/>R&gt; abline(v=c(mean(mtcars$hp),median(mtcars$hp)),lty=c(2,3),lwd=2)<br/>R&gt; legend("topright",legend=c("mean HP","median HP"),lty=c(2,3),lwd=2)</pre>&#13;
<p class="indent">This plot, given on the right in <a href="ch14.xhtml#ch14fig4">Figure 14-4</a>, shows the result of using the narrower bins, as well as making the bars gray and adding a more readable title. It also includes vertical lines denoting the mean and median, using <code>abline</code>, and a legend (refer back to <a href="ch07.xhtml#ch07lev1sec25">Section 7.3</a>).</p>&#13;
<p class="indent">With the smaller binwidth, more detail is visible in the distribution. However, using narrower bins risks highlighting “unimportant features” (in other words, features of the histogram that represent natural variation as a consequence of the finite-sized sample). These typically occur at locations on the scale where data are scarce. For example, the single 335 <span epub:type="pagebreak" id="page_296"/>horsepower car has produced an isolated bar on the right of the scale, but you might reasonably conclude that this is not a precise, accurate reflection of a “true bump” at that location in terms of the overall population. It’s therefore important to note that choosing the interval widths is a balancing act of sorts.</p>&#13;
<p class="indent">You want to choose a width that gives you a good idea of the distribution of measurements without emphasizing unimportant detail by using too small a binwidth. Equivalently, you also want to avoid hiding important features by using too <em>large</em> a binwidth. To address this, there are data-driven algorithms that use the scale of the recorded observations to try to calculate an appropriately balanced binwidth. You can supply a character string to <code>breaks</code>, giving the name of the algorithm that you want to employ. The default <code>breaks="Sturges"</code> often works well, though it’s worth trying a small number of alternative widths when exploring data in this way. For further details on this and other ways to use <code>breaks</code>, the documentation <code>?hist</code> provides clear and concise instruction.</p>&#13;
<p class="indent">The issues surrounding intervals and their widths is emphasized in a different way in <code>ggplot2</code>. By default, the <code>qplot</code> function produces a histogram when you supply it with a single numeric vector but no value for the <code>geom</code> argument:</p>&#13;
<pre>R&gt; qplot(mtcars$hp)<br/>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</pre>&#13;
<p class="indent">You can find the result on the left in <a href="ch14.xhtml#ch14fig5">Figure 14-5</a>. Note, however, that a notification from <code>qplot</code> concerning the binwidths is printed to the console.</p>&#13;
<div class="image"><img src="../images/f14-05.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch14fig5"/>Figure 14-5: Illustrating the default behavior of</em> <code>qplot</code> <em>on the</em> <code>mtcars</code> <em>horsepower data (left); customizing binwidth, color, and title options, as well as adding markers of centrality (right)</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_297"/>If you don’t explicitly specify the bins, exactly 30 intervals will be used to span the range of the data. Inspecting the relevant geom documentation given with a call to <code>?geom_histogram</code> tells you the following:</p>&#13;
<p class="bq">By default, <code>stat_bin</code> uses 30 bins. This is not a good default, but the idea is to get you experimenting with different binwidths. You may need to look at a few to uncover the full story behind your data.</p>&#13;
<p class="indent">So, rather than defaulting to a data-driven algorithm such as <code>hist</code>, <code>ggplot2</code> encourages users to become aware of the issue and actively set their own binwidths. You can see that 30 bins yields inappropriately narrow intervals for this example—there are many gaps where no observations have fallen. There are a number of ways to choose histogram intervals in <code>qplot</code>, one of which is to use <code>breaks</code> as earlier, supplying it with an appropriate numeric vector of interval endpoints. To re-create the plot on the right of <a href="ch14.xhtml#ch14fig4">Figure 14-4</a> using <code>ggplot2</code> functionality, use the following code, which produces the right-hand plot in <a href="ch14.xhtml#ch14fig5">Figure 14-5</a>:</p>&#13;
<pre>R&gt; qplot(mtcars$hp,geom="blank",main="Horsepower",xlab="HP")<br/>     + geom_histogram(color="black",fill="white",breaks=seq(0,400,25),<br/>                      closed="right")<br/>     + geom_vline(mapping=aes(xintercept=c(mean(mtcars$hp),median(mtcars$hp)),<br/>                  linetype=factor(c("mean","median"))),show.legend=TRUE)<br/>     + scale_linetype_manual(values=c(2,3)) + labs(linetype="")</pre>&#13;
<p class="indent">Starting with a <code>"blank"</code> geom, <code>geom_histogram</code> completes most of the work, with <code>color</code> governing the bar outline color and <code>fill</code> the internal color of the bars. The argument <code>closed="right"</code> determines that each interval is “closed” (in other words, exclusive) on the right and “open” (in other words, inclusive) on the left, the same as the default noted in <code>?hist</code>. The <code>geom_vline</code> function is used to add the vertical mean and median lines; here, the <code>mapping</code> must be instructed to change using <code>aes</code> and the locations of these lines. To ensure a correctly labeled legend is created for the mean and median, you must also instruct <code>linetype</code> in <code>aes</code> to be mapped to the desired values. In this case, this is simply a factor comprised of the two desired “levels.”</p>&#13;
<p class="indent">Since you’re manually adding these lines and the associated mapping to the <code>ggplot2</code> object, the legend itself must be instructed to appear with <code>show.legend=TRUE</code>. By default, the two lines will be drawn <code>lty=1</code> (solid) and <code>lty=2</code> (dashed), but to match the earlier plot, you want <code>lty=2</code> and <code>lty=3</code> (dotted). You can add the <code>scale_linetype_manual</code> modifier to make this change; the desired line type numbers are passed as a vector to <code>values</code>. Finally, to suppress the automatic inclusion of a title for your manually added legend, the <code>labs(linetype="")</code> addition instructs the scale associated with the variable mapped to <code>linetype</code> in the <code>aes</code> call to be displayed without this title.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_298"/>The choice between using <code>ggplot2</code> and base R graphics often comes down to your intended goal. For automated handling of graphics, especially where categorical variables are used to separate subsets of the data set, <code>ggplot2</code> is particularly powerful. On the other hand, if you require manual control over the creation of a given image, traditional R graphics can be easier to handle, and you don’t need to keep track of multiple aesthetic variable mappings.</p>&#13;
<h3 class="h3" id="ch14lev1sec46"><strong>14.3 Box-and-Whisker Plots</strong></h3>&#13;
<p class="noindent">An especially popular alternative to the histogram is the <em>box-and-whisker plot</em>, or simply <em>boxplot</em> for short. This is merely a visual representation of the five-number summary discussed in <a href="ch13.xhtml#ch13lev2sec118">Section 13.2.3</a>.</p>&#13;
<h4 class="h4" id="ch14lev2sec124"><strong><em>14.3.1 Stand-Alone Boxplots</em></strong></h4>&#13;
<p class="noindent">Let’s return to the built-in <code>quakes</code> data frame of the 1,000 seismic events near Fiji. For the sake of comparison, you can examine both a histogram and a boxplot of the magnitudes of these events using default base R behavior. The following code produces the images given in <a href="ch14.xhtml#ch14fig6">Figure 14-6</a>:</p>&#13;
<pre>R&gt; hist(quakes$mag)<br/>R&gt; boxplot(quakes$mag)</pre>&#13;
<div class="image"><img src="../images/f14-06.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch14fig6"/>Figure 14-6: Default histogram (left) and boxplot (right) of the magnitude data from</em> <code>quakes</code><em>. On the boxplot, commentary (superimposed externally) points out the key information displayed.</em></p>&#13;
<p class="indent">Like the histogram, a boxplot shows important features of the distribution, such as global (in other words, overall) centrality, spread, and skewness. It’s not really possible to see local features, such as multiple significant peaks in the distribution, however. As the labeling arrows point out, the line in the middle of the box represents the median, the lower and upper edges <span epub:type="pagebreak" id="page_299"/>of the box show the respective quartiles, perpendicular lines (the <em>whiskers</em>) extending from the box indicate the minimum and the maximum, and any dots drawn beyond the whiskers are deemed to be points of extremity or outliers. By default, <code>boxplot</code> defines an outlier as an observation that lies more than 1.5 times the IQR below the lower quartile or above the upper quartile. This is done to prevent the whiskers from extending too far and overemphasizing any skew. Thus, the “maximum” and “minimum” values marked by the whiskers are not always the raw, overall maximum or minimum values in the data set because a value that has been deemed an “outlier” might actually represent the highest or lowest value. You can control the nature of this classification via the <code>range</code> argument in <code>boxplot</code>, though the default of <code>range=1.5</code> is usually sensible for basic data exploration.</p>&#13;
<h4 class="h4" id="ch14lev2sec125"><strong><em>14.3.2 Side-by-Side Boxplots</em></strong></h4>&#13;
<p class="noindent">One particularly pleasing aspect of these plots is the ease with which you can compare the five-number summary distributions of different groups with <em>side-by-side</em> boxplots. Again using the <code>quakes</code> data, define the following corresponding factor and inspect the first five elements (review use of the <code>cut</code> command from <a href="ch04.xhtml#ch04lev2sec48">Section 4.3.3</a> if necessary):</p>&#13;
<pre>R&gt; stations.fac &lt;- cut(quakes$stations,breaks=c(0,50,100,150))<br/>R&gt; stations.fac[1:5]<br/>[1] (0,50] (0,50] (0,50] (0,50] (0,50]<br/>Levels: (0,50] (50,100] (100,150]</pre>&#13;
<p class="indent">Recall that the <code>stations</code> variable records how many monitoring stations detected each event. This code has produced a factor breaking up these observations into one of three groups—events detected by 50 stations or fewer, between 51 and 100 stations, and between 101 and 150 stations. Thus, you can compare the distributions of the magnitudes of the events according to these three groups. The following line produces the left image of <a href="ch14.xhtml#ch14fig7">Figure 14-7</a>:</p>&#13;
<pre>R&gt; boxplot(quakes$mag~stations.fac,<br/>           xlab="# stations detected",ylab="Magnitude",col="gray")</pre>&#13;
<p class="indent">With this line of code, you should note new syntax in the form of a tilde, <code>~</code>, shown here in <code>quakes$mag~stations.fac</code>. You can read the <code>~</code> as “on,” “by,” or “according to” (you’ll use the tilde notation frequently in <a href="ch20.xhtml#ch20">Chapters 20</a> through <a href="ch22.xhtml#ch22">22</a>). Here you’re instructing <code>boxplot</code> to plot <code>quakes$mag</code> <em>according to</em> <code>station.fac</code> so that a separate boxplot is produced for each group, naturally given in the order listed in the grouping factor. Optional arguments are also employed to control axis labeling and box color. Your interpretation of this plot mirrors what you can see in <a href="ch13.xhtml#ch13fig6">Figure 13-6</a>, in that the higher the recorded magnitude, the more stations that detected a given seismic event.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_300"/><img src="../images/f14-07.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch14fig7"/>Figure 14-7: Side-by-side boxplots of the</em> <code>quakes</code> <em>magnitudes, split by the three groups identified by</em> <code>station.fac</code><em>, using base R graphics (left) and</em> <code>ggplot2</code> <em>functionality (right)</em></p>&#13;
<p class="indent">Turning to <code>ggplot2</code> functionality, <code>qplot</code> can produce the same type of plot easily, with the following producing the image on the right in <a href="ch14.xhtml#ch14fig7">Figure 14-7</a>:</p>&#13;
<pre>R&gt; qplot(stations.fac,quakes$mag,geom="boxplot",<br/>         xlab="# stations detected",ylab="Magnitude")</pre>&#13;
<p class="indent">The default boxplots look a little different, though you can make the same interpretations. In this use of <code>qplot</code>, you supply the boxplot grouping factor as the <em>x</em>-axis variable (first argument) and the continuous variable for which you require boxplots as the <em>y</em>-axis variable (second argument). Here I’ve explicitly set <code>geom="boxplot"</code> to ensure a boxplot display, and I’ve added axis labels.</p>&#13;
<h3 class="h3" id="ch14lev1sec47"><strong>14.4 Scatterplots</strong></h3>&#13;
<p class="noindent">A <em>scatterplot</em> is most frequently used to identify a relationship between the observed values of two different numeric-continuous variables, displayed as <em>x</em>-<em>y</em> coordinate plots. The coordinate-wise nature of base R graphics lends itself naturally to the creation of scatterplots, so you’ve seen several examples already in this book. However, not every <em>x</em>-<em>y</em> coordinate-based plot is always called a scatterplot; a scatterplot usually assumes there is some “relationship of interest” present. For example, a plot of spatial coordinates like <a href="ch13.xhtml#ch13fig1">Figure 13-1</a> might not be regarded as a scatterplot, but a plot of the earthquake magnitude against the number of stations detecting the event, like <a href="ch13.xhtml#ch13fig6">Figure 13-6</a>, would be.</p>&#13;
<p class="indent">I’ll finish this chapter by expanding on how you can use scatterplots to explore more than two continuous variables. To do this, let’s access another <span epub:type="pagebreak" id="page_301"/>ready-to-use R data set, namely, the famous <code>iris</code> data. Collected in the mid-1930s, this data frame of 150 rows and 5 columns consists of petal and sepal measurements for three species of perennial iris flowers—<em>Iris setosa</em>, <em>Iris virginica</em>, and <em>Iris versicolor</em> (<a href="ref.xhtml#ref03">Anderson, 1935</a>; <a href="ref.xhtml#ref24">Fisher, 1936</a>). You can view the first five records here:</p>&#13;
<pre>R&gt; iris[1:5,]<br/>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species<br/>1          5.1         3.5          1.4         0.2  setosa<br/>2          4.9         3.0          1.4         0.2  setosa<br/>3          4.7         3.2          1.3         0.2  setosa<br/>4          4.6         3.1          1.5         0.2  setosa<br/>5          5.0         3.6          1.4         0.2  setosa</pre>&#13;
<p class="indent">Looking through <code>?iris</code>, you can see that there are 50 observations for each variable, recorded in centimeters (cm), for each species.</p>&#13;
<h4 class="h4" id="ch14lev2sec126"><strong><em>14.4.1 Single Plot</em></strong></h4>&#13;
<p class="noindent">You can modify a simple scatterplot to split the plotted points according to a categorical variable, exposing potential differences between any visible relationships with respect to the continuous variables. For example, using base R graphics, you can examine the petal measurements according to the three species. Using the “stepping-stone” approach first explained in <a href="ch07.xhtml#ch07">Chapter 7</a>, you can manually build up this plot by first using <code>type="n"</code> to generate an empty plotting region of the correct dimensions and subsequently adding the points corresponding to each species, altering point character and color as desired.</p>&#13;
<pre>R&gt; plot(iris[,4],iris[,3],type="n",xlab="Petal Width (cm)",<br/>        ylab="Petal Length (cm)")<br/>R&gt; points(iris[iris$Species=="setosa",4],<br/>          iris[iris$Species=="setosa",3],pch=19,col="black")<br/>R&gt; points(iris[iris$Species=="virginica",4],<br/>          iris[iris$Species=="virginica",3],pch=19,col="gray")<br/>R&gt; points(iris[iris$Species=="versicolor",4],<br/>          iris[iris$Species=="versicolor",3],pch=1,col="black")<br/>R&gt; legend("topleft",legend=c("setosa","virginica","versicolor"),<br/>          col=c("black","gray","black"),pch=c(19,19,1))</pre>&#13;
<p class="indent">You can find the plot in <a href="ch14.xhtml#ch14fig8">Figure 14-8</a>. Note that the <em>Iris virginica</em> species has the largest petals, followed by <em>Iris versicolor</em>, and the smallest petals belong to <em>Iris setosa</em>. However, this code, while functional, is fairly cumbersome. You can generate the same image more simply by first setting up vectors that specify the desired point character and color <em>for each individual observation</em>.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_302"/><img src="../images/f14-08.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch14fig8"/>Figure 14-8: A scatterplot of petal measurements split by species from the built-in</em> <code>iris</code> <em>data frame</em></p>&#13;
<p class="indent">Consider the two objects created here:</p>&#13;
<pre>R&gt; iris_pch &lt;- rep(19,nrow(iris))<br/>R&gt; iris_pch[iris$Species=="versicolor"] &lt;- 1<br/>R&gt; iris_col &lt;- rep("black",nrow(iris))<br/>R&gt; iris_col[iris$Species=="virginica"] &lt;- "gray"</pre>&#13;
<p class="indent">The first line creates a vector <code>iris_pch</code> of equal length to the number of observations in <code>iris</code>, with every entry being <code>19</code>. Vector subsetting then overwrites the entries corresponding to <em>Iris versicolor</em> and sets the point character to <code>1</code>. The same steps are followed to create <code>iris_col</code>; first an appropriately sized vector is filled with the character strings <code>"black"</code>, and then those entries corresponding to <em>Iris virginica</em> are overwritten and set to <code>"gray"</code>. With that, note that the single line shown next, when followed by the same call to <code>legend</code> as earlier, will produce an identical plot:</p>&#13;
<pre>R&gt; plot(iris[,4],iris[,3],col=iris_col,pch=iris_pch,<br/>        xlab="Petal Width (cm)",ylab="Petal Length (cm)")</pre>&#13;
<h4 class="h4" id="ch14lev2sec127"><strong><em>14.4.2 Matrix of Plots</em></strong></h4>&#13;
<p class="noindent">The “single” type of planar scatterplot is really useful only when comparing <em>two</em> numeric-continuous variables. When there are more continuous variables of interest, it isn’t possible to display this information satisfactorily on a single plot. A simple and common solution is to generate a two-variable scatterplot for each pair of variables and show them together in a structured way; this is referred to as a <em>scatterplot matrix</em>. Making use of the <code>iris_pch</code> and <code>iris_col</code> vectors created earlier, you can generate a scatterplot matrix for all <span epub:type="pagebreak" id="page_303"/>four continuous variables in <code>iris</code>, retaining the distinction between species. Working with base R graphics, use the <code>pairs</code> function.</p>&#13;
<pre>R&gt; pairs(iris[,1:4],pch=iris_pch,col=iris_col,cex=0.75)</pre>&#13;
<p class="indent">You can find the result of this line in <a href="ch14.xhtml#ch14fig9">Figure 14-9</a>.</p>&#13;
<div class="image"><img src="../images/f14-09.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch14fig9"/>Figure 14-9: A scatterplot matrix with respect to all four continuous measurements in the data frame</em></p>&#13;
<p class="indent">The easiest way to use <code>pairs</code> is to supply a matrix or data frame of the raw observations as its first argument, done here by selecting all columns of <code>iris</code> except the <code>Species</code> column (<code>iris[,1:4]</code>). The interpretation of the plots depends upon the labeling of the diagonal panels, running from the top left to the bottom right. They will appear in the same order as the columns given as the first argument. These “label panels” allow you to determine which individual plot in the matrix corresponds to each pair of variables. For example, the first column of the scatterplot matrix in <a href="ch14.xhtml#ch14fig9">Figure 14-9</a> corresponds to an <em>x</em>-axis variable of Sepal Length; the third row of the matrix corresponds to a <em>y</em>-axis variable of Petal Length, and each row and column displays a scale that is constant moving left/right or up/down, respectively. This means that plots above the diagonal are mirrored in those below it—the plot of Petal Width (<em>y</em>) on Sepal Width (<em>x</em>) at position row 4, column 2 displays the same data as the scatterplot at position row 2, column 4 but flipped on its axes. As such, <code>pairs</code> includes an option to display only those scatterplots above <em>or</em> below the diagonal, by setting either <code>lower.panel=NULL</code> or <code>upper.panel=NULL</code> to suppress one or the other.</p>&#13;
<p class="indent">Scatterplot matrices therefore allow for an easier comparison of the collection of pairwise relationships formed by observations made on multiple continuous variables. In this matrix, note there’s a strong positive linear association between petal measurements but a weaker relationship between <span epub:type="pagebreak" id="page_304"/>the sepal measurements. Furthermore, although <em>Iris setosa</em> may reasonably be considered the smallest flower in terms of its petals, the same can’t be said in terms of its sepals.</p>&#13;
<p class="indent">For those working with <code>ggplot2</code>, you know that it’s natural to split the points according to a categorical variable, as in the following example.</p>&#13;
<pre>R&gt; qplot(iris[,4],iris[,3],xlab="Petal width",ylab="Petal length",<br/>         shape=iris$Species)<br/>      + scale_shape_manual(values=4:6) + labs(shape="Species")</pre>&#13;
<p class="indent">You can find the result in <a href="ch14.xhtml#ch14fig10">Figure 14-10</a>.</p>&#13;
<div class="image"><img src="../images/f14-10.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch14fig10"/>Figure 14-10: Using</em> <code>ggplot2</code> <em>functionality to plot petal dimensions for the three</em> <code>iris</code> <em>species, with point</em> <code>shape</code> <em>as the aesthetic modifier</em></p>&#13;
<p class="indent">Here, I’ve split up the points using the <code>Species</code> variable mapped to <code>shape</code> (the equivalent of the base R terminology <code>pch</code>), and I’ve modified the point types using the <code>scale_shape_manual</code> modifier. I’ve also simplified the title of the automatically generated legend with <code>labs</code>, as done in <a href="ch14.xhtml#ch14lev1sec45">Section 14.2</a>. Scatterplot matrices, however, are not easily achievable using only <code>ggplot2</code>. To generate a matrix in a <code>ggplot2</code> style, it’s recommended that you download the <code>GGally</code> package (<a href="ref.xhtml#ref58">Schloerke et al., 2014</a>) to access the <code>ggpairs</code> function. This package is designed to be an extension or add-on of <code>ggplot2</code>. It’s installed from CRAN as per usual—for example, by running <code>install.packages("GGally")</code>—and must be loaded via <code>library("GGally")</code> prior to use. After this is done, as a quick example, the following code produces the plot in <a href="ch14.xhtml#ch14fig11">Figure 14-11</a>:</p>&#13;
<pre>R&gt; ggpairs(iris,mapping=aes(col=Species),axisLabels="internal")</pre>&#13;
<p class="indent">Though you might see familiar warnings related to the histogram binwidths, <code>ggpairs</code> offers an impressive visual array for such a short line of code. The output not only gives you the lower half of the scatterplot matrix produced with <code>pairs</code> but also provides equivalent histograms along the bottom and boxplots along the right. It also displays the estimates of the correlation coefficients. As shown, you can map a variable to an aesthetic modifier to split up the plotted observations based on factor levels. In <a href="ch14.xhtml#ch14fig11">Figure 14-11</a>, this is done by color, and you instruct <code>ggpairs</code> to operate on the <code>Species</code> variable. Documentation found in <code>?ggpairs</code> gives concise information on the various options that control the presence and appearance of the individual plots.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_305"/><img src="../images/f14-11.jpg" alt="image"/></div>&#13;
<p class="figt"><em><a id="ch14fig11"/>Figure 14-11: Generation of a scatterplot matrix using <code>ggpairs</code> from the <code>GGally</code> package, using color to separate the species. Note the useful addition of estimated correlation coefficients and distributional plots.</em></p>&#13;
<div class="ex">&#13;
<p class="ext"><span epub:type="pagebreak" id="page_306"/><a id="ch14exc1"/><strong>Exercise 14.1</strong></p>&#13;
<p class="noindentz">Recall the built-in <code>InsectSprays</code> data frame, containing counts of insects on various agricultural units treated with one of six sprays.</p>&#13;
<ol type="a">&#13;
<li><p class="noindents">Produce a histogram of the counts of insects using base R graphics.</p></li>&#13;
<li><p class="noindents">Obtain the total number of insects found according to each spray (this was also asked in <a href="ch13.xhtml#ch13exc2">Exercise 13.2</a> (f) on <a href="ch13.xhtml#page_273">page 273</a>). Then, use base R graphics to produce a vertical barplot and a pie chart of these totals, labeling each plot appropriately.</p></li>&#13;
<li><p class="noindents">Use <code>ggplot2</code> functionality to generate side-by-side boxplots of the counts of insects according to each spray type and include appropriate axis labels and a title.</p></li>&#13;
</ol>&#13;
<p class="noindentz">Yet another of R’s useful ready-to-use data sets is <code>USArrests</code>, containing data on the number of arrests for murder, rape, and assault per 100,000 individuals in each of the 50 states of the United States, recorded in 1973 (see, for example, <a href="ref.xhtml#ref46">McNeil, 1977</a>). It also includes a variable giving the percentage of urban-based population in each state. Briefly inspect the data frame object and the accompanying documentation <code>?USArrests</code>. Then complete the following:</p>&#13;
<ol type="a" start="4">&#13;
<li><p class="noindents">Use <code>ggplot2</code> functionality to generate a right-exclusive histogram of the proportion of urban population for the states. Set your breaks to be 10 units each, between 0 and 100. Have the histogram show the first quartile, the median, and the third quartile; then provide a matching legend. Use colors as you like and include appropriate axis annotation.</p></li>&#13;
<li><p class="noindents">The code <code>t(as.matrix(USArrests[,-3]))</code> creates a matrix of the <code>USArrests</code> data without the urban population column, and the built-in R object <code>state.abb</code> provides the two-letter state abbreviations, in alphabetical order, as a character vector. Use these two structures and base R graphics to produce a horizontal, stacked barplot with the horizontal bars labeled with state abbreviations and with each bar split according to the type of crime (murder, rape, and assault). Include a legend.</p></li>&#13;
<li><p class="noindents"><span epub:type="pagebreak" id="page_307"/>Define a new factor vector <code>urbancat</code> that is set to <code>1</code> if the corresponding state has an urban population percentage greater than the median percentage and is set to <code>0</code> otherwise.</p></li>&#13;
<li><p class="noindents">Create a new copy of <code>USArrests</code> in your workspace, after deleting the <code>UrbanPop</code> column, leaving just the three crime rate variables. Then insert a new, fourth column in this object with <code>urbancat</code>.</p></li>&#13;
<li><p class="noindents">Use the data frame from (g) to produce a scatterplot matrix and other associated plots of the three crime rates against one another via <code>GGally</code> functionality. Use color to split the crime rates according to the two levels of <code>urbancat</code>.</p></li>&#13;
</ol>&#13;
<p class="noindentz">Return to the built-in <code>quakes</code> data set.</p>&#13;
<ol type="a" start="9">&#13;
<li><p class="noindents">Create a factor vector corresponding to the magnitudes. Each entry should assume one of three categories based on breaks marked by the minimum magnitude, the <img class="middle" src="../images/1by3.jpg" alt="image"/> th quantile, the <img class="middle" src="../images/2by3.jpg" alt="image"/> th quantile, and the maximum magnitude.</p></li>&#13;
<li><p class="noindents">Re-create the plot shown next, where low-, medium-, and high-magnitude events, according to your factor vector from (i), are plotted with <code>pch</code> being assigned <code>1</code>, <code>2</code>, and <code>3</code>, respectively.</p>&#13;
<div class="imagec"><img src="../images/f0307-01.jpg" alt="image"/></div></li>&#13;
<li><p class="noindents">Add a legend to the plot from (j) to reference the three <code>pch</code> values.</p></li>&#13;
</ol>&#13;
</div>&#13;
<h5 class="h5" id="ch14lev3sec38"><span epub:type="pagebreak" id="page_308"/><strong>Important Code in This Chapter</strong></h5>&#13;
<table class="topbot">&#13;
<thead>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Function/operator</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Brief description</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>First occurrence</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>barplot</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Create a barplot</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev2sec122">Section 14.1.1</a>, <a href="ch14.xhtml#page_290">p. 290</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>geom_bar</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Barplot geom</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev2sec122">Section 14.1.1</a>, <a href="ch14.xhtml#page_292">p. 292</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>scale_x_discrete</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Modify discrete <em>x</em>-axis (<code>ggplot2</code>)</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev2sec122">Section 14.1.1</a>, <a href="ch14.xhtml#page_292">p. 292</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>scale_y_continuous</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Modify continuous <em>y</em>-axis</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev2sec122">Section 14.1.1</a>, <a href="ch14.xhtml#page_292">p. 292</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>theme_bw</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Black-and-white color theme</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev2sec122">Section 14.1.1</a>, <a href="ch14.xhtml#page_292">p. 292</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>coord_flip</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Switch <em>x</em>- and <em>y</em>-axes</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev2sec122">Section 14.1.1</a>, <a href="ch14.xhtml#page_292">p. 292</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>scale_fill_grey</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Filled colors as grayscale</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev2sec122">Section 14.1.1</a>, <a href="ch14.xhtml#page_292">p. 292</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>pie</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Create a pie chart</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev2sec123">Section 14.1.2</a>, <a href="ch14.xhtml#page_293">p. 293</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>hist</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Create a histogram</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev1sec45">Section 14.2</a>, <a href="ch14.xhtml#page_294">p. 294</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>geom_histogram</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Histogram geom</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev1sec45">Section 14.2</a>, <a href="ch14.xhtml#page_297">p. 297</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>geom_vline</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Add vertical lines geom</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev1sec45">Section 14.2</a>, <a href="ch14.xhtml#page_297">p. 297</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>scale_linetype_manual</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Alter <code>ggplot2</code> line types</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev1sec45">Section 14.2</a>, <a href="ch14.xhtml#page_297">p. 297</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>labs</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>ggplot2</code> legend labels</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev1sec45">Section 14.2</a>, <a href="ch14.xhtml#page_297">p. 297</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>boxplot</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Create boxplots</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev2sec124">Section 14.3.1</a>, <a href="ch14.xhtml#page_298">p. 298</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>~</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Plot “according to”</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev2sec125">Section 14.3.2</a>, <a href="ch14.xhtml#page_299">p. 299</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>pairs</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Scatterplot matrix</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev2sec127">Section 14.4.2</a>, <a href="ch14.xhtml#page_303">p. 303</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>scale_shape_manual</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Alter <code>ggplot2</code> point characters</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev2sec127">Section 14.4.2</a>, <a href="ch14.xhtml#page_304">p. 304</a></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><code>ggpairs</code></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Scatterplot matrix (<code>GGally</code>)</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><a href="ch14.xhtml#ch14lev2sec127">Section 14.4.2</a>, <a href="ch14.xhtml#page_304">p. 304</a></p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
</body></html>