<html><head></head><body>
<div id="sbo-rt-content" class="calibre1"><section aria-labelledby="ch27" epub:type="chapter" role="doc-chapter">
<hgroup>
<h2 class="title" id="ch27">
<span class="cn"><span aria-label=" Page 325. " epub:type="pagebreak" id="pg_325" role="doc-pagebreak" class="calibre2"/><span class="sans_dogma_ot_bold_b_">27</span></span>
<span class="ct1"><span class="sans_dogma_ot_bold_b_">AND/OR OPERATORS</span></span>
</h2>
</hgroup>
<figure class="opener"><img alt="" class="opener1" height="407" src="../images/chapter.jpg" width="408"/>
</figure>
<p class="chapterintro">In this chapter, I’ll discuss what may be the most glaring shortfall in all of Batch. It doesn’t support an <span class="sans_thesansmonocd_w5regular_1">and</span> operator, nor is there an <span class="sans_thesansmonocd_w5regular_1">or</span> operator. After a brief problem statement, I’ll detail a few techniques to simulate or mimic these two operators, handling both the true and false cases. The <span class="sans_thesansmonocd_w5regular_1">and</span> is fairly straightforward, but the <span class="sans_thesansmonocd_w5regular_1">or</span> requires more ingenuity.</p>
<p class="tx">As is often the case with Batch, you can look at a deficiency with frustration or as an inspiration for creativity. These techniques are a must for any Batch coder because without them, you can’t write even moderately interesting <span class="sans_thesansmonocd_w5regular_">if</span> commands.</p>
<section aria-labelledby="sec1" epub:type="division">
<h3 class="h" id="sec1"><span id="h1-184"/><span aria-label=" Page 326. " epub:type="pagebreak" id="pg_326" role="doc-pagebreak"/><span class="sans_futura_std_bold_b_">The Problem Statement</span></h3>
<p class="tni">A certain conversation is a rite of passage for anyone learning Batch:</p>
<p class="blockquotefirst"><i class="calibre6">Bobby</i>: I have a syntax issue. I’m trying to code an <span class="sans_thesansmonocd_w5regular_">if</span> command with an <span class="sans_thesansmonocd_w5regular_">and</span> operator—you know, do something if <span class="sans_thesansmonocd_w5regular_">variable1</span> equals <span class="sans_thesansmonocd_w5regular_">A</span> and <span class="sans_thesansmonocd_w5regular_">variable2</span> equals <span class="sans_thesansmonocd_w5regular_">B</span>—nothing complex. I’d hoped that the syntax was simply the word <i class="calibre6">and</i>. That didn’t work, so I tried an ampersand and then two ampersands. I know that Batch can be unintuitive, so there must be some sort of funky syntax for the <span class="sans_thesansmonocd_w5regular_">and</span> operator, maybe an at sign with a tilde or some nonsense like that. So how do I code this?</p>
<p class="blockquotesingle"><i class="calibre6">Jack</i>: Sorry, Batch doesn’t have an <span class="sans_thesansmonocd_w5regular_">and</span> operator.</p>
<p class="blockquotesingle"><i class="calibre6">Bobby</i>: Seriously? That makes no sense.</p>
<p class="blockquotesingle"><i class="calibre6">Jack</i>: Seriously, there is none.</p>
<p class="blockquotesingle"><i class="calibre6">Bobby</i>: You’re messing with me, aren’t you? Every programming language with an <span class="sans_thesansmonocd_w5regular_">if</span> command has an <span class="sans_thesansmonocd_w5regular_">and</span> operator. I think there’s a law.</p>
<p class="blockquotesingle"><i class="calibre6">Jack</i>: No, not every language. I can’t name another offhand, but Batch isn’t following the crowd on this one.</p>
<p class="blockquotesingle"><i class="calibre6">Bobby</i>: That’s like selling a car that doesn’t turn left. What are you supposed to do?</p>
<p class="blockquotesingle"><i class="calibre6">Jack</i>: Take three rights. Oh ... and by the way, the <span class="sans_thesansmonocd_w5regular_">or</span> operator ... also not a thing.</p>
<p class="blockquotesingle"><i class="calibre6">Bobby</i>: I’m still not sure if you’re yanking my chain. It’s nowhere near April Fool’s Day, and I really need to get this thing working. Any suggestions?</p>
<p class="blockquotelast"><i class="calibre6">Jack</i>: I agree, Batch should have these operators, but this is where some creativity comes in handy. Anyone can code an <span class="sans_thesansmonocd_w5regular_">and</span> in Java or Perl, but doing it in Batch will fill you with a great sense of pride and accomplishment. The <span class="sans_thesansmonocd_w5regular_">or</span> operator is even more fun—or problematic, depending on your perspective.</p>
<p class="tx">I still remember playing the part of the novice in this conversation, and I’ve since experienced d<span class="copyright_accent">é</span>j<span class="copyright_accent">à</span> vu countless times in the opposite role. I fear that some will think that I’m overstating the issue, but it has perplexed many. This <span class="sans_thesansmonocd_w5regular_">and</span> operator irredeemably does <i class="calibre6">not</i> return true if both comparisons are true:</p>
<pre class="pre"><code class="calibre11">if "%var1%" equ "A" and "%var2%" equ "B" (
   &gt; con echo This is junk code.
)
</code></pre>
<p class="tx">That’s not to say that the command inside the code block never executes; in fact, the interpreter typically performs it after discarding the invalid <span class="sans_thesansmonocd_w5regular_">if</span> <span aria-label=" Page 327. " epub:type="pagebreak" id="pg_327" role="doc-pagebreak"/>command. To further complicate matters, the invalid command might generate an error message to stderr, or not, and <span class="sans_thesansmonocd_w5regular_">errorlevel</span> might end up as a nonzero value, or not.</p>
<p class="tx">The same is true for this <i class="calibre6">invalid</i> <span class="sans_thesansmonocd_w5regular_">or</span> operator:</p>
<pre class="pre"><code class="calibre11">if "%var1%" equ "A" or "%var2%" equ "B" (
   &gt; con echo This is more junk code.
)
</code></pre>
<p class="tni">It doesn’t return true if either or both of the comparisons are true.</p>
<p class="tx">But enough of what won’t work. There are solutions, some elegant and some functional, for building these operators.</p>
</section>
<section aria-labelledby="sec2" epub:type="division">
<h3 class="h" id="sec2"><span id="h1-185"/><span class="sans_futura_std_bold_b_">Replicating the and Operator</span></h3>
<p class="tni">The first and most obvious technique to code around the lack of an <span class="sans_thesansmonocd_w5regular_">and</span> operator is the nested <span class="sans_thesansmonocd_w5regular_">if</span> command:</p>
<pre class="pre"><code class="calibre11">if "%var1%" equ "A" (
    if "%var2%" equ "B" (
      &gt; con echo Nesting works but is oh so uninspired.
)  )
</code></pre>
<p class="tx">This is the only possible solution if either conditional clause uses the <span class="sans_thesansmonocd_w5regular_">exist</span> keyword to determine whether a resource exists or the <span class="sans_thesansmonocd_w5regular_">defined</span> keyword to see whether a variable is defined. But if you are examining multiple variables for equality to constants or other variables, I’ll share a far more elegant solution. The following <span class="sans_thesansmonocd_w5regular_">if</span> command, with two resolved variables on one side of the <span class="sans_thesansmonocd_w5regular_">equ</span> operator and two values on the other, is functionally equivalent to the nested commands in the previous example:</p>
<pre class="pre"><code class="calibre11">if "%var1%-%var2%" equ "A-B" (
   &gt; con echo This if command has an AND operator even if the AND is implied.
)
</code></pre>
<p class="tx">The lefthand side of the equality, <span class="sans_thesansmonocd_w5regular_">%var1%-%var2%</span>, has three parts inside the double quotes: the resolution of the first variable, a dash, and the resolution of the second variable. If the two variables are set to <span class="sans_thesansmonocd_w5regular_">A</span> and <span class="sans_thesansmonocd_w5regular_">B</span>, respectively, then <span class="sans_thesansmonocd_w5regular_">"%var1%-%var2%"</span> resolves to <span class="sans_thesansmonocd_w5regular_">"A-B"</span>, and equality is found. If either variable (or both) is set to anything else the conditional clause is false.</p>
<p class="tx">The dash delimiter serves two important purposes. Without the delimiter, we will erroneously find equality if one of the two variables resolves to <span class="sans_thesansmonocd_w5regular_">AB</span> and the other resolves to null. Also, it’s just far easier and more pleasant to read, especially when the comparisons become more complex. For example, the following two <span class="sans_thesansmonocd_w5regular_">if</span> commands—each containing a trio of compares—are very similar, but which one would you rather read?</p>
<pre class="pre"><code class="calibre11"><span aria-label=" Page 328. " epub:type="pagebreak" id="pg_328" role="doc-pagebreak"/>if /i "%writer%%coworker%%admin%" equ "jackbobbysteve" (
   &gt; con echo These variables and values are smushed together.
)

if /i "%writer%-%coworker%-%admin%" equ "jack-bobby-steve" (
   &gt; con echo We can all agree this is far more readable.
)
</code></pre>
<p class="tx">I’m using a dash as the delimiter, but most any understated character also works. Dots are another good option, but above all else, the delimiter that you choose should be a character that you don’t expect to be part of the data. (I’m hesitant to open this can of worms, but the conditional clause, <span class="sans_thesansmonocd_w5regular_">"%A%-%B%" equ "%X%-%Y%"</span>, will incorrectly register as true if <span class="sans_thesansmonocd_w5regular_">A</span> and <span class="sans_thesansmonocd_w5regular_">Y</span> are set to a dash and <span class="sans_thesansmonocd_w5regular_">B</span> and <span class="sans_thesansmonocd_w5regular_">X</span> are null. While this theoretically is an issue, if you know your data and choose your delimiter wisely, it won’t be an issue in practice.)</p>
<p class="tx">Notice also that the two comparisons in the previous listing are case-insensitive. You can do the same for any multiple comparison with the addition of the <span class="sans_thesansmonocd_w5regular_">/i</span> option, but it applies universally—that is, to all three comparisons in this example. If you want to do a mix of case-sensitive and case-insensitive compares, nesting is your best option.</p>
<p class="tx">The prior logic would have required two <span class="sans_thesansmonocd_w5regular_">and</span> operators in most other languages. In Batch, you could have done it with three nested <span class="sans_thesansmonocd_w5regular_">if</span> commands, but the technique connecting operands with a dash is more succinct and readable than it would have been even with a true <span class="sans_thesansmonocd_w5regular_">and</span> operator.</p>
</section>
<section aria-labelledby="sec3" epub:type="division">
<h3 class="h" id="sec3"><span id="h1-186"/><span class="sans_futura_std_bold_b_">Replicating the or Operator</span></h3>
<p class="tni">The <span class="sans_thesansmonocd_w5regular_">or</span> operator is as complex and varied as the <span class="sans_thesansmonocd_w5regular_">and</span> operator is straightforward and uniform. I’ll demonstrate the techniques best suited for different situations.</p>
<section aria-labelledby="sec4" epub:type="division">
<h4 class="h1" id="sec4"><span id="h2-89"/><span class="sans_futura_std_heavy_oblique_bi_">Comparing One Variable to Multiple Values</span></h4>
<p class="tni">A common application of the <span class="sans_thesansmonocd_w5regular_">or</span> operator is to determine whether the contents of a variable is equal to one out of two or more values. For instance, you can glean quite a bit from a state postal code. If it’s equal to <span class="sans_thesansmonocd_w5regular_">WA</span>, <span class="sans_thesansmonocd_w5regular_">OR</span>, or <span class="sans_thesansmonocd_w5regular_">CA</span>, the state is on the Pacific coast of the contiguous United States, and any one of a list of 10 values indicates that the state is on the Mississippi River.</p>
<p class="tx">To build an <span class="sans_thesansmonocd_w5regular_">or</span> operator looking for one of multiple values being assigned to a single variable, I’ll once again turn to the eminently useful <span class="sans_thesansmonocd_w5regular_">for</span> command:</p>
<pre class="pre"><code class="calibre11">for %%p in (ND SD) do (
   if "%postalCode%" equ "%%p" (
      &gt; con echo This is an OR operator of a variable and multiple values.
)  )
</code></pre>
<p class="tni"><span aria-label=" Page 329. " epub:type="pagebreak" id="pg_329" role="doc-pagebreak"/>The <span class="sans_thesansmonocd_w5regular_">echo</span> command executes if and only if the variable represents the postal code for one of the Dakota states.</p>
<p class="tx">The <span class="sans_thesansmonocd_w5regular_">for</span> command executes its code block twice, passing <span class="sans_thesansmonocd_w5regular_">ND</span> and then <span class="sans_thesansmonocd_w5regular_">SD</span> as the <span class="sans_thesansmonocd_w5regular_">%%p</span> variable. The code block contains just an <span class="sans_thesansmonocd_w5regular_">if</span> command comparing the contents of <span class="sans_thesansmonocd_w5regular_">postalCode</span> to what’s passed in as the <span class="sans_thesansmonocd_w5regular_">for</span> variable. Thus, the first execution of the <span class="sans_thesansmonocd_w5regular_">if</span> command looks to see if the variable resolves to <span class="sans_thesansmonocd_w5regular_">ND</span>, and the second execution compares the value of <span class="sans_thesansmonocd_w5regular_">postalCode</span> to <span class="sans_thesansmonocd_w5regular_">SD</span>. If the variable equals either <span class="sans_thesansmonocd_w5regular_">ND</span> or <span class="sans_thesansmonocd_w5regular_">SD</span>, the <span class="sans_thesansmonocd_w5regular_">if</span> command evaluates to true, triggering the execution of its block of code. This in essence is a Batch <span class="sans_thesansmonocd_w5regular_">or</span> operator.</p>
<p class="tx">The previous example was for two possible values, but since the <span class="sans_thesansmonocd_w5regular_">for</span> command takes in a space-delimited list, you can pass any reasonable number of values. Here’s an example of a Batch <span class="sans_thesansmonocd_w5regular_">or</span> operator matching a variable on any one of six names:</p>
<pre class="pre"><code class="calibre11">for %%p in (Cleese Gilliam Jones Chapman Idle Palin) do (
   if /i "%name%" equ "%%p" (
      &gt; con echo %name% is a Python
)  )
</code></pre>
<p class="tx">A single variable, such as <span class="sans_thesansmonocd_w5regular_">postalCode</span> or <span class="sans_thesansmonocd_w5regular_">name</span>, can’t take on two current values at once, meaning that with this technique, the conditional clause in the <span class="sans_thesansmonocd_w5regular_">if</span> command can evaluate to true at most once. This isn’t true of other variants of the <span class="sans_thesansmonocd_w5regular_">or</span> operator, meaning that other considerations and modifications come into play.</p>
</section>
<section aria-labelledby="sec5" epub:type="division">
<h4 class="h1" id="sec5"><span id="h2-90"/><span class="sans_futura_std_heavy_oblique_bi_">Comparing Multiple Variables to One Value</span></h4>
<p class="tni">Let’s flip the last example so that we compare multiple variables to a single hardcoded value. Perhaps a particular program has two functions, and we want to execute it if either of two variables is set to some common value.</p>
<p class="tx">In this example, the <span class="sans_thesansmonocd_w5regular_">for</span> command is using the resolved values of the two variables as its input, and it’s passing each to the <span class="sans_thesansmonocd_w5regular_">if</span> command and comparing them to <span class="sans_thesansmonocd_w5regular_">A</span>:</p>
<pre class="pre"><code class="calibre11"> for %%i in (%var1% %var2%) do (
    if "A" equ "%%i" (
       &gt; con echo This OR operator compares a value to multiple variables.
       goto :OrDone
)  )
:OrDone
</code></pre>
<p class="tx">In this scenario, there’s the possibility for both variables to be equal to <span class="sans_thesansmonocd_w5regular_">A</span>. A true or proper <span class="sans_thesansmonocd_w5regular_">or</span> operator won’t execute the code inside the code block of the <span class="sans_thesansmonocd_w5regular_">if</span> command twice if both are true. To mimic this behavior, we must break out of the logic after the first true condition is satisfied and the code block is executed, and this is accomplished by the <span class="sans_thesansmonocd_w5regular_">goto</span> command branching control to the label just after the <span class="sans_thesansmonocd_w5regular_">for</span> loop.</p>
<p class="tx">Many times, it’s perfectly acceptable to execute the code block multiple times. For instance, if you’re setting some variable or variables when the <span aria-label=" Page 330. " epub:type="pagebreak" id="pg_330" role="doc-pagebreak"/>condition is true, it won’t hurt to simply reset them to the same values, and in those situations, you can simplify the code by removing the <span class="sans_thesansmonocd_w5regular_">goto</span> and the label. Even so, this code isn’t bulletproof in all situations.</p>
<p class="tx">The technique in the previous example assumes that the variables don’t contain any embedded spaces. Since the <span class="sans_thesansmonocd_w5regular_">for</span> command accepts a space-delimited list, the interpreter treats a single value with an embedded space as two distinct values. The following listing accounts for the limitation:</p>
<pre class="pre"><code class="calibre11"> for %%i in ("%var1%" "%var2%") do (
    if "A" equ "%%~i" (
       &gt; con echo This OR operator compares a value to multiple variables.
       goto :OrDone
 )  )
:OrDone
</code></pre>
<p class="tni">I’ve encased each resolved input variable in double quotes, ensuring that we pass each one in its entirety into the code block. To account for what I’ve just added, I’ve also included a tilde to the resolution of the <span class="sans_thesansmonocd_w5regular_">for</span> variable to remove these double quotes while doing the comparison: <span class="sans_thesansmonocd_w5regular_">%%~i</span>.</p>
<p class="tx">Only a double quote in the contents of one of these variables could break this code. Know your data.</p>
</section>
<section aria-labelledby="sec6" epub:type="division">
<h4 class="h1" id="sec6"><span id="h2-91"/><span class="sans_futura_std_heavy_oblique_bi_">Comparing Multiple Variables and Values</span></h4>
<p class="tni">The prior examples demonstrate common yet fairly narrow cases. They won’t work for more complicated conditional clauses containing an <span class="sans_thesansmonocd_w5regular_">or</span> operator comparing multiple variables to various hardcoded values or comparing different variables to each other.</p>
<p class="tx">As a specific example, a desired conditional clause might evaluate to true if one variable equals a particular value or if a second variable equals a third variable. That is, we might try to execute something like the following, but again this does <i class="calibre6">not</i> work in Batch:</p>
<pre class="pre"><code class="calibre11">if "%var1%" equ "A" or "%var2%" equ "%var3%" (
   &gt; con echo This is one last example of junk code.
)
</code></pre>
<p class="tx">There are two ways to mimic this variant of the <span class="sans_thesansmonocd_w5regular_">or</span> operator:</p>
<p class="listhead"><b class="calibre10">The <span class="sans_thesansmonocd_w5regular_"><b class="calibre10">else if</b></span> Solution</b></p>
<p class="listplainfirst">With some brute force you can evaluate the first condition and use the <span class="sans_thesansmonocd_w5regular_">else if</span> construct from <span class="xref"><a href="chapter4.xhtml" class="calibre3">Chapter 4</a></span> to evaluate subsequent conditions:</p>
<pre class="list"><code class="calibre11"><span class="sans_thesansmonocd_w5regular_">if "%var1%" equ "A" (</span>
   &gt; con echo This executes for only one of multiple conditions.
) else if "%var2%" equ "%var3%" (
   &gt; con echo This really needs to be the same code as what's above.
)
</code></pre>
<p class="listbody"><span aria-label=" Page 331. " epub:type="pagebreak" id="pg_331" role="doc-pagebreak"/>This works but has a major drawback that I more than hinted at in the code itself. You must repeat the code block to be executed if the conditional clause in the <span class="sans_thesansmonocd_w5regular_">if</span> command is true. If this code consists of a single statement, that may be more than acceptable, but if the logic is more complex, even two or three lines of code, the code will quickly get messy. In such cases, it’s best to put that code block into a labeled method and call it from multiple locations:</p>
<pre class="list"><code class="calibre11"><span class="sans_thesansmonocd_w5regular_">if "%var1%" equ "A" (</span>
   call :CommonLogic
) else if "%var2%" equ "%var3%" (
   call :CommonLogic
)
</code></pre>
<p class="listbody">The <span class="sans_thesansmonocd_w5regular_">:CommonLogic</span> routine may contain some involved logic and live elsewhere in the bat file, but if it’s only a handful of commands, I suggest placing it immediately after the <span class="sans_thesansmonocd_w5regular_">else if</span> construct inside a perpetually false <span class="sans_thesansmonocd_w5regular_">if</span> command. (See <span class="xref"><a href="chapter20.xhtml" class="calibre3">Chapter 20</a></span> for more on this technique. Hint: <span class="sans_thesansmonocd_w5regular_">if 0 equ 1</span>.) However, if the code block really doesn’t justify its own method (or even if it does), there’s another technique worth exploring.</p>
<p class="listhead"><b class="calibre10">The Nested <span class="sans_thesansmonocd_w5regular_"><b class="calibre10">for</b></span> Command Solution</b></p>
<p class="listplainfirst">This last technique for implementing an <span class="sans_thesansmonocd_w5regular_">or</span> operator isn’t a simple one, but it’s elegant, and I’ve employed it often. It mimics multiple compares of two items where just one match satisfies the condition, but where the two items can be any combination of resolved variables and hardcoded values. It even handles embedded spaces in any of the values.</p>
<p class="listbody">In this solution, I’ve wrapped the <span class="sans_thesansmonocd_w5regular_">if</span> command inside two nested <span class="sans_thesansmonocd_w5regular_">for</span> commands:</p>
<pre class="pre"><code class="calibre11"> for %%i in ("%var1%:A" "%var2%:%var3%") do (
    for /F "tokens=1-2 delims=:" %%j in ("%%~i") do (
       if "%%j" equ "%%k" (
          &gt; con echo A complex OR conditional clause has evaluated to true^^!
          goto :IfOrDone
 )  )  )
:IfOrDone
</code></pre>
<p class="listbody">The input of the outer <span class="sans_thesansmonocd_w5regular_">for</span> command is a space-delimited set of colon-delimited pairs of values, where each pair is encased in double quotes. This means that each execution of the outer code block resolves a pair of values delimited by a colon as <span class="sans_thesansmonocd_w5regular_">%%~i</span>. The pair of values can be a combination of a resolved variable and a hardcoded value such as in the first pair: <span class="sans_thesansmonocd_w5regular_">%var1%:A</span>. In contrast, the second pair demonstrates a different possibility, that of two resolved variables: <span class="sans_thesansmonocd_w5regular_">%var2%:%var3%</span>.</p>
<p class="listbody">The inner <span class="sans_thesansmonocd_w5regular_">for /F</span> command successively accepts each pair resolved by <span class="sans_thesansmonocd_w5regular_">%%~i</span> and treats it as string input because of the encasing double <span aria-label=" Page 332. " epub:type="pagebreak" id="pg_332" role="doc-pagebreak"/>quotes. (Notice that <span class="sans_thesansmonocd_w5regular_">"%%~i"</span> strips off and then adds back a set of double quotes. I could have used <span class="sans_thesansmonocd_w5regular_">%%i</span>, but the explicit double quotes make it clear that the input to the <span class="sans_thesansmonocd_w5regular_">for /F</span> command is a string.)</p>
<p class="listbody">The <span class="sans_thesansmonocd_w5regular_">tokens</span> and <span class="sans_thesansmonocd_w5regular_">delims</span> clauses separate the pair by the colon delimiter into the <span class="sans_thesansmonocd_w5regular_">%%j</span> and <span class="sans_thesansmonocd_w5regular_">%%k</span> tokens (<span class="xref"><a href="chapter19.xhtml" class="calibre3">Chapter 19</a></span>). Finally, the <span class="sans_thesansmonocd_w5regular_">if</span> command compares them for equality and executes the code block if true.</p>
<p class="listbody">I’m using the same technique I employed earlier to break out of the logic so that it doesn’t execute multiple times. Once again, you can drop the <span class="sans_thesansmonocd_w5regular_">goto</span> command and the label if there’s no harm executing the code block more than once. If a colon might be in one of the values being compared, you can choose a different delimiter. Likewise, if a double quote might be in one of the values, you can drop the double quotes around each pair in the input list, but this will expose spaces and special characters in the data.</p>
<p class="listbody">After you get a grasp on how it works, take another look with fresh eyes and ask yourself whether this looks like an <span class="sans_thesansmonocd_w5regular_">if</span> command with an <span class="sans_thesansmonocd_w5regular_">or</span> operator. Some may call it cryptic, and to be clear, an explanatory remark is definitely in order, but what I’ve presented here represents the most comprehensive complex Batch <span class="sans_thesansmonocd_w5regular_">or</span> operator you’re likely to encounter.</p>
</section>
</section>
<section aria-labelledby="sec7" epub:type="division">
<h3 class="h" id="sec7"><span id="h1-187"/><span class="sans_futura_std_bold_b_">The else Keyword</span></h3>
<p class="tni">There’s one last pertinent topic related to any <span class="sans_thesansmonocd_w5regular_">if</span> command that we must not forget: the <span class="sans_thesansmonocd_w5regular_">else</span> keyword. I’ve discussed executing one code block if multiple conditions are all true or if at least one of them is true, but often you’ll want to execute another code block if the ultimate result of the <span class="sans_thesansmonocd_w5regular_">and</span> or <span class="sans_thesansmonocd_w5regular_">or</span> conditional clause is false. Traditionally, this is the code block coming after the <span class="sans_thesansmonocd_w5regular_">else</span> keyword.</p>
<p class="tx">The simulated <span class="sans_thesansmonocd_w5regular_">and</span> operator with multiple resolved variables and hardcoded values strung together lends itself to the use of an <span class="sans_thesansmonocd_w5regular_">else</span> code block:</p>
<pre class="pre"><code class="calibre11">if "%var1%-%var2%" equ "A-B" (
   &gt; con echo Both are true.
) else (
   &gt; con echo One of these variables doesn't match the value, or both don't.
)
</code></pre>
<p class="tx">This also works with the <span class="sans_thesansmonocd_w5regular_">else if</span> construct that can mimic the <span class="sans_thesansmonocd_w5regular_">or</span> operator. But you can only mimic the <span class="sans_thesansmonocd_w5regular_">else</span> keyword in the other situations, and I’ll share two very useful methods here:</p>
<p class="listhead"><span aria-label=" Page 333. " epub:type="pagebreak" id="pg_333" role="doc-pagebreak"/><b class="calibre10">The Preemptive Action Method</b></p>
<p class="listplainfirst">The easiest way to execute the <span class="sans_thesansmonocd_w5regular_">else</span> logic is to do it preemptively:</p>
<pre class="list"><code class="calibre11"><span class="sans_thesansmonocd_w5regular_">set result=NoMatchFound</span>
for %%p in (ND SD) do (
   if "%postalCode%" equ "%%p" (
      set result=Match
)  )
</code></pre>
<p class="listbody">Clearly, this works only if upon finding a match, you can easily undo the preemptive logic. If the <span class="sans_thesansmonocd_w5regular_">else</span> logic is copying or deleting a file, this technique is of no value, but if the logic is simply setting a variable to one of two values, you can do the <span class="sans_thesansmonocd_w5regular_">else</span> logic first and undo it if the <span class="sans_thesansmonocd_w5regular_">if</span> command evaluates to true. In essence, this is an <span class="sans_thesansmonocd_w5regular_">if...else</span> construct.</p>
<p class="listhead"><b class="calibre10">The Branch Over Method</b></p>
<p class="listplainfirst">Another method is to use that bit of space before the label used to break out of the code block on the first match:</p>
<pre class="list"><code class="calibre11"> <span class="sans_thesansmonocd_w5regular_">for %%p in (ND SD) do (</span>
    if "%postalCode%" equ "%%p" (
       set result=Match
       goto :OrDone
 )  )
 set result=NoMatchFound
:OrDone
</code></pre>
<p class="listbody">The <span class="sans_thesansmonocd_w5regular_">goto</span> command already ensures that the logic just above it executes no more than once, but now it also branches over the logic just after the completion of the <span class="sans_thesansmonocd_w5regular_">for</span> command. If this logic finds one match, it sets the variable to <span class="sans_thesansmonocd_w5regular_">Match</span>, but if the <span class="sans_thesansmonocd_w5regular_">if</span> command doesn’t find a match after exhausting the list in the input, only then does control fall to the <span class="sans_thesansmonocd_w5regular_">set</span> command setting the variable to <span class="sans_thesansmonocd_w5regular_">NoMatchFound</span>.</p>
<p class="listbody">This method offers far greater flexibility. Instead of setting a variable, you can call a program if one match is found, and if not, delete a directory. The code isn’t doing anything preemptively, so it doesn’t have to undo anything. For this reason, the branch over method is a truer form of the <span class="sans_thesansmonocd_w5regular_">if...else</span> construct. The fact that the <span class="sans_thesansmonocd_w5regular_">else</span> logic comes last makes it look even more like the traditional construct. After seeing enough of these, you’ll start to interpret those two close parentheses as a kind of <span class="sans_thesansmonocd_w5regular_">else</span> keyword.</p>
</section>
<section aria-labelledby="sec8" epub:type="division">
<h3 class="h" id="sec8"><span id="h1-188"/><span aria-label=" Page 334. " epub:type="pagebreak" id="pg_334" role="doc-pagebreak"/><span class="sans_futura_std_bold_b_">Summary</span></h3>
<p class="tni">In this chapter, I’ve detailed a couple of methods to mimic the <span class="sans_thesansmonocd_w5regular_">and</span> operator of a conditional clause, and you’ve learned multiple techniques for simulating the <span class="sans_thesansmonocd_w5regular_">or</span> operator that satisfy many differing situations. I also demonstrated ways to mimic the <span class="sans_thesansmonocd_w5regular_">else</span> keyword, so as to execute logic that traditionally executes when a conditional clause is false.</p>
<p class="tx">It’s certainly true that the techniques discussed in this chapter are completely unnecessary in most languages, but they are a necessity for any Batch coder wanting to code more than rudimentary logic. They also fill the most prominent lacuna in the Batch universe as elegantly as possible.</p>
<p class="tx">Bobby shouldn’t be faulted for trying to use <span class="sans_thesansmonocd_w5regular_">&amp;&amp;</span> as an <span class="sans_thesansmonocd_w5regular_">and</span> operator; nor should he be faulted if he tried using <span class="sans_thesansmonocd_w5regular_">||</span> as an <span class="sans_thesansmonocd_w5regular_">or</span> operator. Both are commonly used for these purposes in other languages. I haven’t mentioned it yet, but the <span class="sans_thesansmonocd_w5regular_">&amp;&amp;</span> and <span class="sans_thesansmonocd_w5regular_">||</span> operators do have a place in Batch, but in relation to a completely different topic, conditional execution. In <span class="xref"><a href="chapter4.xhtml" class="calibre3">Chapter 4</a></span>, I detailed the most commonly used technique of conditional execution (the <span class="sans_thesansmonocd_w5regular_">if</span> command), but in the next chapter, I’ll return to this topic to share some lesser-known alternative techniques.</p>
</section>
</section>
</div></body></html>