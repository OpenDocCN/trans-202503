- en: <hgroup>
  prefs: []
  type: TYPE_NORMAL
- en: <samp class="SANS_Dogma_OT_Bold_B_11">CONTENTS IN DETAIL</samp>
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: </hgroup>
  prefs: []
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">TITLE PAGE</samp>](title.xhtml)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">COPYRIGHT</samp>](copyright.xhtml)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">DEDICATION</samp>](dedication.xhtml)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">ABOUT THE AUTHOR AND TECHNICAL REVIEWER</samp>](abouttheauthor.xhtml)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">FOREWORD</samp>](foreword.xhtml)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">ACKNOWLEDGMENTS</samp>](acknowledgments.xhtml)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">INTRODUCTION</samp>](introduction.xhtml)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Who Is This Book For?</samp>](introduction.xhtml#h1-2)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">What Is in This Book?</samp>](introduction.xhtml#h1-3)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">PowerShell Conventions Used in This
    Book</samp>](introduction.xhtml#h1-4)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Getting in Touch</samp>](introduction.xhtml#h1-5)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">PART I: AN OVERVIEW OF THE WINDOWS
    OPERATING SYSTEM</samp>](part1.xhtml)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">1'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: SETTING UP A POWERSHELL TESTING ENVIRONMENT</samp>](chapter1.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Choosing a PowerShell Version</samp>](chapter1.xhtml#h1-6)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Configuring PowerShell</samp>](chapter1.xhtml#h1-7)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">An Overview of the PowerShell Language</samp>](chapter1.xhtml#h1-8)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Understanding Types, Variables, and
    Expressions</samp>](chapter1.xhtml#h2-1)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Executing Commands</samp>](chapter1.xhtml#h2-2)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Discovering Commands and Getting Help</samp>](chapter1.xhtml#h2-3)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Defining Functions</samp>](chapter1.xhtml#h2-4)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Displaying and Manipulating Objects</samp>](chapter1.xhtml#h2-5)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Filtering, Ordering, and Grouping Objects</samp>](chapter1.xhtml#h2-6)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Exporting Data</samp>](chapter1.xhtml#h2-7)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp>](chapter1.xhtml#h1-9)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">2'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: THE WINDOWS KERNEL</samp>](chapter2.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Windows Kernel Executive</samp>](chapter2.xhtml#h1-10)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Security Reference Monitor</samp>](chapter2.xhtml#h1-11)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Object Manager</samp>](chapter2.xhtml#h1-12)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Object Types</samp>](chapter2.xhtml#h2-8)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Object Manager Namespace</samp>](chapter2.xhtml#h2-9)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">System Calls</samp>](chapter2.xhtml#h2-10)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">NTSTATUS Codes</samp>](chapter2.xhtml#h2-11)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Object Handles</samp>](chapter2.xhtml#h2-12)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Query and Set Information System Calls</samp>](chapter2.xhtml#h2-13)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Input/Output Manager</samp>](chapter2.xhtml#h1-13)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Process and Thread Manager</samp>](chapter2.xhtml#h1-14)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Memory Manager</samp>](chapter2.xhtml#h1-15)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">NtVirtualMemory Commands</samp>](chapter2.xhtml#h2-14)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Section Objects</samp>](chapter2.xhtml#h2-15)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Code Integrity</samp>](chapter2.xhtml#h1-16)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Advanced Local Procedure Call</samp>](chapter2.xhtml#h1-17)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Configuration Manager</samp>](chapter2.xhtml#h1-18)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Worked Examples</samp>](chapter2.xhtml#h1-19)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Finding Open Handles by Name</samp>](chapter2.xhtml#h2-16)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Finding Shared Objects</samp>](chapter2.xhtml#h2-17)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Modifying a Mapped Section</samp>](chapter2.xhtml#h2-18)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Finding Writable and Executable Memory</samp>](chapter2.xhtml#h2-19)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp>](chapter2.xhtml#h1-20)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">3'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: USER-MODE APPLICATIONS</samp>](chapter3.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Win32 and the User-Mode Windows APIs</samp>](chapter3.xhtml#h1-21)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Loading a New Library</samp>](chapter3.xhtml#h2-20)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Viewing Imported APIs</samp>](chapter3.xhtml#h2-21)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Searching for DLLs</samp>](chapter3.xhtml#h2-22)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Win32 GUI</samp>](chapter3.xhtml#h1-22)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">GUI Kernel Resources</samp>](chapter3.xhtml#h2-23)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Window Messages</samp>](chapter3.xhtml#h2-24)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Console Sessions</samp>](chapter3.xhtml#h2-25)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Comparing Win32 APIs and System Calls</samp>](chapter3.xhtml#h1-23)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Win32 Registry Paths</samp>](chapter3.xhtml#h1-24)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Opening Keys</samp>](chapter3.xhtml#h2-26)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Listing the Registry’s Contents</samp>](chapter3.xhtml#h2-27)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">DOS Device Paths</samp>](chapter3.xhtml#h1-25)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Path Types</samp>](chapter3.xhtml#h2-28)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Maximum Path Lengths</samp>](chapter3.xhtml#h2-29)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Process Creation</samp>](chapter3.xhtml#h1-26)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Command Line Parsing</samp>](chapter3.xhtml#h2-30)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Shell APIs</samp>](chapter3.xhtml#h2-31)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">System Processes</samp>](chapter3.xhtml#h1-27)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Session Manager</samp>](chapter3.xhtml#h2-32)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Windows Logon Process</samp>](chapter3.xhtml#h2-33)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Local Security Authority Subsystem</samp>](chapter3.xhtml#h2-34)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Service Control Manager</samp>](chapter3.xhtml#h2-35)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Worked Examples</samp>](chapter3.xhtml#h1-28)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Finding Executables That Import Specific
    APIs</samp>](chapter3.xhtml#h2-36)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Finding Hidden Registry Keys or Values</samp>](chapter3.xhtml#h2-37)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp>](chapter3.xhtml#h1-29)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">PART II: THE WINDOWS SECURITY REFERENCE
    MONITOR</samp>](part2.xhtml)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">4</samp>'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: <samp class="SANS_Futura_Std_Bold_B_11">SECURITY ACCESS TOKENS</samp>](chapter4.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Primary Tokens</samp>](chapter4.xhtml#h1-30)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Impersonation Tokens</samp>](chapter4.xhtml#h1-31)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Security Quality of Service</samp>](chapter4.xhtml#h2-38)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Explicit Token Impersonation</samp>](chapter4.xhtml#h2-39)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Converting Between Token Types</samp>](chapter4.xhtml#h1-32)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Pseudo Token Handles</samp>](chapter4.xhtml#h1-33)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Token Groups</samp>](chapter4.xhtml#h1-34)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Enabled, EnabledByDefault, and Mandatory</samp>](chapter4.xhtml#h2-40)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">LogonId</samp>](chapter4.xhtml#h2-41)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Owner</samp>](chapter4.xhtml#h2-42)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">UseForDenyOnly</samp>](chapter4.xhtml#h2-43)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Integrity and IntegrityEnabled</samp>](chapter4.xhtml#h2-44)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Resource</samp>](chapter4.xhtml#h2-45)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Device Groups</samp>](chapter4.xhtml#h2-46)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Privileges</samp>](chapter4.xhtml#h1-35)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Sandbox Tokens</samp>](chapter4.xhtml#h1-36)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Restricted Tokens</samp>](chapter4.xhtml#h2-47)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Write-Restricted Tokens</samp>](chapter4.xhtml#h2-48)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">AppContainer and Lowbox Tokens</samp>](chapter4.xhtml#h2-49)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">What Makes an Administrator User?</samp>](chapter4.xhtml#h1-37)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">User Account Control</samp>](chapter4.xhtml#h1-38)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Linked Tokens and Elevation Type</samp>](chapter4.xhtml#h2-50)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">UI Access</samp>](chapter4.xhtml#h2-51)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Virtualization</samp>](chapter4.xhtml#h2-52)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Security Attributes</samp>](chapter4.xhtml#h1-39)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Creating Tokens</samp>](chapter4.xhtml#h1-40)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Token Assignment</samp>](chapter4.xhtml#h1-41)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Assigning a Primary Token</samp>](chapter4.xhtml#h2-53)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Assigning an Impersonation Token</samp>](chapter4.xhtml#h2-54)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Worked Examples</samp>](chapter4.xhtml#h1-42)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Finding UI Access Processes</samp>](chapter4.xhtml#h2-55)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Finding Token Handles to Impersonate</samp>](chapter4.xhtml#h2-56)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Removing Administrator Privileges</samp>](chapter4.xhtml#h2-57)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp>](chapter4.xhtml#h1-43)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">5'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: SECURITY DESCRIPTORS</samp>](chapter5.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Structure of a Security Descriptor</samp>](chapter5.xhtml#h1-44)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Structure of a SID</samp>](chapter5.xhtml#h1-45)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Absolute and Relative Security Descriptors</samp>](chapter5.xhtml#h1-46)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Access Control List Headers and Entries</samp>](chapter5.xhtml#h1-47)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Header</samp>](chapter5.xhtml#h2-58)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The ACE List</samp>](chapter5.xhtml#h2-59)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Constructing and Manipulating Security
    Descriptors</samp>](chapter5.xhtml#h1-48)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Creating a New Security Descriptor</samp>](chapter5.xhtml#h2-60)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Ordering the ACEs</samp>](chapter5.xhtml#h2-61)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Formatting Security Descriptors</samp>](chapter5.xhtml#h2-62)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Converting to and from a Relative Security
    Descriptor</samp>](chapter5.xhtml#h2-63)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Security Descriptor Definition Language</samp>](chapter5.xhtml#h1-49)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Worked Examples</samp>](chapter5.xhtml#h1-50)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Manually Parsing a Binary SID</samp>](chapter5.xhtml#h2-64)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Enumerating SIDs</samp>](chapter5.xhtml#h2-65)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp>](chapter5.xhtml#h1-51)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">6'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: READING AND ASSIGNING SECURITY DESCRIPTORS</samp>](chapter6.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Reading Security Descriptors</samp>](chapter6.xhtml#h1-52)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Assigning Security Descriptors</samp>](chapter6.xhtml#h1-53)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Assigning a Security Descriptor During
    Resource Creation</samp>](chapter6.xhtml#h2-66)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Assigning a Security Descriptor to an
    Existing Resource</samp>](chapter6.xhtml#h2-67)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Win32 Security APIs</samp>](chapter6.xhtml#h1-54)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Server Security Descriptors and Compound
    ACEs</samp>](chapter6.xhtml#h1-55)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">A Summary of Inheritance Behavior</samp>](chapter6.xhtml#h1-56)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Worked Examples</samp>](chapter6.xhtml#h1-57)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Finding Object Manager Resource Owners</samp>](chapter6.xhtml#h2-68)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Changing the Ownership of a Resource</samp>](chapter6.xhtml#h2-69)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp>](chapter6.xhtml#h1-58)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">7'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: THE ACCESS CHECK PROCESS</samp>](chapter7.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Running an Access Check</samp>](chapter7.xhtml#h1-59)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Kernel-Mode Access Checks</samp>](chapter7.xhtml#h2-70)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">User-Mode Access Checks</samp>](chapter7.xhtml#h2-71)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Get-NtGrantedAccess PowerShell Command</samp>](chapter7.xhtml#h2-72)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Access Check Process in PowerShell</samp>](chapter7.xhtml#h1-60)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Defining the Access Check Function</samp>](chapter7.xhtml#h2-73)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Performing the Mandatory Access Check</samp>](chapter7.xhtml#h2-74)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Performing the Token Access Check</samp>](chapter7.xhtml#h2-75)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Performing the Discretionary Access
    Check</samp>](chapter7.xhtml#h2-76)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Sandboxing</samp>](chapter7.xhtml#h1-61)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Restricted Tokens</samp>](chapter7.xhtml#h2-77)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Lowbox Tokens</samp>](chapter7.xhtml#h2-78)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Enterprise Access Checks</samp>](chapter7.xhtml#h1-62)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Object Type Access Check</samp>](chapter7.xhtml#h2-79)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Central Access Policy</samp>](chapter7.xhtml#h2-80)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Worked Examples</samp>](chapter7.xhtml#h1-63)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Using the Get-PSGrantedAccess Command</samp>](chapter7.xhtml#h2-81)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Calculating Granted Access for Resources</samp>](chapter7.xhtml#h2-82)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp>](chapter7.xhtml#h1-64)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">8'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: OTHER ACCESS CHECKING USE CASES</samp>](chapter8.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Traversal Checking</samp>](chapter8.xhtml#h1-65)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The SeChangeNotifyPrivilege Privilege</samp>](chapter8.xhtml#h2-83)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Limited Checks</samp>](chapter8.xhtml#h2-84)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Handle Duplication Access Checks</samp>](chapter8.xhtml#h1-66)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Sandbox Token Checks</samp>](chapter8.xhtml#h1-67)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Automating Access Checks</samp>](chapter8.xhtml#h1-68)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Worked Examples</samp>](chapter8.xhtml#h1-69)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Simplifying an Access Check for an Object</samp>](chapter8.xhtml#h2-85)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Finding Writable Section Objects</samp>](chapter8.xhtml#h2-86)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp>](chapter8.xhtml#h1-70)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">9</samp>'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: <samp class="SANS_Futura_Std_Bold_B_11">SECURITY AUDITING</samp>](chapter9.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Security Event Log</samp>](chapter9.xhtml#h1-71)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Configuring the System Audit Policy</samp>](chapter9.xhtml#h2-87)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Configuring the Per-User Audit Policy</samp>](chapter9.xhtml#h2-88)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Audit Policy Security</samp>](chapter9.xhtml#h1-72)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Configuring the Resource SACL</samp>](chapter9.xhtml#h2-89)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Configuring the Global SACL</samp>](chapter9.xhtml#h2-90)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Worked Examples</samp>](chapter9.xhtml#h1-73)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Verifying Audit Access Security</samp>](chapter9.xhtml#h2-91)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Finding Resources with Audit ACEs</samp>](chapter9.xhtml#h2-92)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp>](chapter9.xhtml#h1-74)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">PART III: THE LOCAL SECURITY AUTHORITY
    AND AUTHENTICATION</samp>](part3.xhtml)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">10'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: WINDOWS AUTHENTICATION</samp>](chapter10.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Domain Authentication</samp>](chapter10.xhtml#h1-75)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Local Authentication</samp>](chapter10.xhtml#h2-93)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Enterprise Network Domains</samp>](chapter10.xhtml#h2-94)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Domain Forests</samp>](chapter10.xhtml#h2-95)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Local Domain Configuration</samp>](chapter10.xhtml#h1-76)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The User Database</samp>](chapter10.xhtml#h2-96)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The LSA Policy Database</samp>](chapter10.xhtml#h2-97)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Remote LSA Services</samp>](chapter10.xhtml#h1-77)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The SAM Remote Service</samp>](chapter10.xhtml#h2-98)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Domain Policy Remote Service</samp>](chapter10.xhtml#h2-99)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The SAM and SECURITY Databases</samp>](chapter10.xhtml#h1-78)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Accessing the SAM Database Through the
    Registry</samp>](chapter10.xhtml#h2-100)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Inspecting the SECURITY Database</samp>](chapter10.xhtml#h2-101)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Worked Examples</samp>](chapter10.xhtml#h1-79)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">RID Cycling</samp>](chapter10.xhtml#h2-102)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Forcing a User‘s Password Change</samp>](chapter10.xhtml#h2-103)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Extracting All Local User Hashes</samp>](chapter10.xhtml#h2-104)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp>](chapter10.xhtml#h1-80)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">11'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: ACTIVE DIRECTORY</samp>](chapter11.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">A Brief History of Active Directory</samp>](chapter11.xhtml#h1-81)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Exploring an Active Directory Domain
    with PowerShell</samp>](chapter11.xhtml#h1-82)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Remote Server Administration Tools</samp>](chapter11.xhtml#h2-105)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Basic Forest and Domain Information</samp>](chapter11.xhtml#h2-106)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Users</samp>](chapter11.xhtml#h2-107)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Groups</samp>](chapter11.xhtml#h2-108)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Computers</samp>](chapter11.xhtml#h2-109)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Objects and Distinguished Names</samp>](chapter11.xhtml#h1-83)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Enumerating Directory Objects</samp>](chapter11.xhtml#h2-110)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Accessing Objects in Other Domains</samp>](chapter11.xhtml#h2-111)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Schema</samp>](chapter11.xhtml#h1-84)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Inspecting the Schema</samp>](chapter11.xhtml#h2-112)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Accessing the Security Attributes</samp>](chapter11.xhtml#h2-113)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Security Descriptors</samp>](chapter11.xhtml#h1-85)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Querying Security Descriptors of Directory
    Objects</samp>](chapter11.xhtml#h2-114)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Assigning Security Descriptors to New
    Directory Objects</samp>](chapter11.xhtml#h2-115)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Assigning Security Descriptors to Existing
    Objects</samp>](chapter11.xhtml#h2-116)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Inspecting a Security Descriptor’s Inherited
    Security</samp>](chapter11.xhtml#h2-117)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Access Checks</samp>](chapter11.xhtml#h1-86)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Creating Objects</samp>](chapter11.xhtml#h2-118)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Deleting Objects</samp>](chapter11.xhtml#h2-119)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Listing Objects</samp>](chapter11.xhtml#h2-120)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Reading and Writing Attributes</samp>](chapter11.xhtml#h2-121)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Checking Multiple Attributes</samp>](chapter11.xhtml#h2-122)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Analyzing Property Sets</samp>](chapter11.xhtml#h2-123)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Inspecting Control Access Rights</samp>](chapter11.xhtml#h2-124)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Analyzing Write-Validated Access Rights</samp>](chapter11.xhtml#h2-125)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Accessing the SELF SID</samp>](chapter11.xhtml#h2-126)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Performing Additional Security Checks</samp>](chapter11.xhtml#h2-127)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Claims and Central Access Policies</samp>](chapter11.xhtml#h1-87)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Group Policies</samp>](chapter11.xhtml#h1-88)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Worked Example</samp>](chapter11.xhtml#h1-89)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Building the Authorization Context</samp>](chapter11.xhtml#h2-128)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Gathering Object Information</samp>](chapter11.xhtml#h2-129)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Running the Access Check</samp>](chapter11.xhtml#h2-130)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp>](chapter11.xhtml#h1-90)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">12'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: INTERACTIVE AUTHENTICATION</samp>](chapter12.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Creating a User’s Desktop</samp>](chapter12.xhtml#h1-91)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The LsaLogonUser API</samp>](chapter12.xhtml#h1-92)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Local Authentication</samp>](chapter12.xhtml#h2-131)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Domain Authentication</samp>](chapter12.xhtml#h2-132)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Logon and Console Sessions</samp>](chapter12.xhtml#h2-133)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Token Creation</samp>](chapter12.xhtml#h2-134)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Using the LsaLogonUser API from PowerShell</samp>](chapter12.xhtml#h1-93)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Creating a New Process with a Token</samp>](chapter12.xhtml#h1-94)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Service Logon Type</samp>](chapter12.xhtml#h1-95)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Worked Examples</samp>](chapter12.xhtml#h1-96)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Testing Privileges and Logon Account
    Rights</samp>](chapter12.xhtml#h2-135)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Creating a Process in a Different Console
    Session</samp>](chapter12.xhtml#h2-136)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Authenticating Virtual Accounts</samp>](chapter12.xhtml#h2-137)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp>](chapter12.xhtml#h1-97)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">13'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: NETWORK AUTHENTICATION</samp>](chapter13.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">NTLM Network Authentication</samp>](chapter13.xhtml#h1-98)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">NTLM Authentication Using PowerShell</samp>](chapter13.xhtml#h2-138)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Cryptographic Derivation Process</samp>](chapter13.xhtml#h2-139)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Pass-Through Authentication</samp>](chapter13.xhtml#h2-140)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Local Loopback Authentication</samp>](chapter13.xhtml#h2-141)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Alternative Client Credentials</samp>](chapter13.xhtml#h2-142)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The NTLM Relay Attack</samp>](chapter13.xhtml#h1-99)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Attack Overview</samp>](chapter13.xhtml#h2-143)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Active Server Challenges</samp>](chapter13.xhtml#h2-144)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Signing and Sealing</samp>](chapter13.xhtml#h2-145)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Target Names</samp>](chapter13.xhtml#h2-146)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Channel Binding</samp>](chapter13.xhtml#h2-147)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Worked Example</samp>](chapter13.xhtml#h1-100)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Overview</samp>](chapter13.xhtml#h2-148)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Code Module</samp>](chapter13.xhtml#h2-149)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Server Implementation</samp>](chapter13.xhtml#h2-150)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Client Implementation</samp>](chapter13.xhtml#h2-151)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The NTLM Authentication Test</samp>](chapter13.xhtml#h2-152)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp>](chapter13.xhtml#h1-101)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">14'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: KERBEROS</samp>](chapter14.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Interactive Authentication with Kerberos</samp>](chapter14.xhtml#h1-102)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Initial User Authentication</samp>](chapter14.xhtml#h2-153)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Network Service Authentication</samp>](chapter14.xhtml#h2-154)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Performing Kerberos Authentication in
    PowerShell</samp>](chapter14.xhtml#h1-103)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Decrypting the AP-REQ Message</samp>](chapter14.xhtml#h1-104)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Decrypting the AP-REP Message</samp>](chapter14.xhtml#h1-105)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Cross-Domain Authentication</samp>](chapter14.xhtml#h1-106)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Kerberos Delegation</samp>](chapter14.xhtml#h1-107)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Unconstrained Delegation</samp>](chapter14.xhtml#h2-155)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Constrained Delegation</samp>](chapter14.xhtml#h2-156)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">User-to-User Kerberos Authentication</samp>](chapter14.xhtml#h1-108)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Worked Examples</samp>](chapter14.xhtml#h1-109)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Querying the Kerberos Ticket Cache</samp>](chapter14.xhtml#h2-157)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Simple Kerberoasting</samp>](chapter14.xhtml#h2-158)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp>](chapter14.xhtml#h1-110)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">15'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: NEGOTIATE AUTHENTICATION AND OTHER SECURITY PACKAGES</samp>](chapter15.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Security Buffers</samp>](chapter15.xhtml#h1-111)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Using Buffers with an Authentication
    Context</samp>](chapter15.xhtml#h2-159)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Using Buffers with Signing and Sealing</samp>](chapter15.xhtml#h2-160)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Negotiate Protocol</samp>](chapter15.xhtml#h1-112)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Less Common Security Packages</samp>](chapter15.xhtml#h1-113)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Secure Channel</samp>](chapter15.xhtml#h2-161)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">CredSSP</samp>](chapter15.xhtml#h2-162)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Remote Credential Guard and Restricted
    Admin Mode</samp>](chapter15.xhtml#h1-114)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Credential Manager</samp>](chapter15.xhtml#h1-115)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Additional Request Attribute Flags</samp>](chapter15.xhtml#h1-116)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Anonymous Sessions</samp>](chapter15.xhtml#h2-163)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Identity Tokens</samp>](chapter15.xhtml#h2-164)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Network Authentication with a Lowbox
    Token</samp>](chapter15.xhtml#h1-117)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Authentication with the Enterprise Authentication
    Capability</samp>](chapter15.xhtml#h2-165)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Authentication to a Known Web Proxy</samp>](chapter15.xhtml#h2-166)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Authentication with Explicit Credentials</samp>](chapter15.xhtml#h2-167)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Authentication Audit Event Log</samp>](chapter15.xhtml#h1-118)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Worked Examples</samp>](chapter15.xhtml#h1-119)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Identifying the Reason for an Authentication
    Failure</samp>](chapter15.xhtml#h2-168)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Using a Secure Channel to Extract a
    Server’s TLS Certificate</samp>](chapter15.xhtml#h2-169)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Wrapping Up</samp>](chapter15.xhtml#h1-120)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Final Thoughts</samp>](chapter15.xhtml#h1-121)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">A'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: BUILDING A WINDOWS DOMAIN NETWORK FOR TESTING</samp>](appendix-A.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The Domain Network</samp>](appendix-A.xhtml#h1-122)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Installing and Configuring Windows Hyper-V</samp>](appendix-A.xhtml#h1-123)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">Creating the Virtual Machines</samp>](appendix-A.xhtml#h1-124)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The PRIMARYDC Server</samp>](appendix-A.xhtml#h2-170)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The GRAPHITE Workstation</samp>](appendix-A.xhtml#h2-171)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Book_11">The SALESDC Server</samp>](appendix-A.xhtml#h2-172)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">B'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: SDDL SID ALIAS MAPPING</samp>](appendix-B.xhtml)
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[<samp class="SANS_Futura_Std_Bold_B_11">INDEX</samp>](index.xhtml)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
