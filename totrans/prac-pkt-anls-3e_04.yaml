- en: '**4**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**WORKING WITH CAPTURED PACKETS**'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/common.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Now that you’ve been introduced to Wireshark, you’re ready to start capturing
    and analyzing packets. In this chapter, you’ll learn how to work with capture
    files, packets, and time-display formats. We’ll also cover more advanced options
    for capturing packets and dive into the world of filters.
  prefs: []
  type: TYPE_NORMAL
- en: '**Working with Capture Files**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: You’ll find that a good portion of your packet analysis will happen after your
    capture. Usually, you’ll perform several captures at various times, save them,
    and analyze them all at once. Therefore, Wireshark allows you to save your capture
    files to be analyzed later. You can also merge multiple capture files.
  prefs: []
  type: TYPE_NORMAL
- en: '***Saving and Exporting Capture Files***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: To save a packet capture, select **File** ▶ **Save As**. You should see the
    Save file as dialog, as shown in [Figure 4-1](ch04.xhtml#ch04fig1). You’ll be
    asked for a location to save your packet capture and for the file format you wish
    to use. If you don’t specify a file format, Wireshark will use the default *.pcapng*
    file format.
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f54-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-1: The Save file as dialog allows you to save your packet captures.*'
  prefs: []
  type: TYPE_NORMAL
- en: In many cases, you may only want to save a subset of the packets in your capture.
    To do so, select **File** ▶ **Export Specified Packets**. The dialog that appears
    is shown in [Figure 4-2](ch04.xhtml#ch04fig2). This is a great way to thin bloated
    packet-capture files. You can choose to save only packets in a specific number
    range, marked packets, or packets visible as the result of a display filter (marked
    packets and filters are discussed later in this chapter).
  prefs: []
  type: TYPE_NORMAL
- en: You can export your Wireshark capture data into several formats for viewing
    in other media or for importing into other packet analysis tools. Formats include
    plaintext, PostScript, comma-separated values (CSV), and XML. To export your packet
    capture in one of these formats, choose **File** ▶ **Export Packet Dissections**
    and then select the format for the exported file. You’ll see a Save As dialog
    containing options related to the format you’ve chosen.
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f55-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-2: The Export Specified Packets dialog allows you to have more granular
    control over the packets you choose to save.*'
  prefs: []
  type: TYPE_NORMAL
- en: '***Merging Capture Files***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Certain types of analysis require the ability to merge multiple capture files.
    This is a common practice when comparing two data streams or combining streams
    of the same traffic that were captured separately.
  prefs: []
  type: TYPE_NORMAL
- en: To merge capture files, open one of the files you want to merge and choose **File**
    ▶ **Merge** to bring up the Merge with capture file dialog, shown in [Figure 4-3](ch04.xhtml#ch04fig3).
    Select the new file you wish to merge into the already open file and then select
    the method to use for merging the files. You can prepend the selected file to
    the currently open one, append it, or merge the files chronologically based on
    their timestamps.
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f56-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-3: The Merge with capture file dialog allows you to merge two capture
    files.*'
  prefs: []
  type: TYPE_NORMAL
- en: '**Working with Packets**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: You will eventually encounter a situation involving a very large number of packets.
    As the number of packets grows into the thousands and even millions, you will
    need to navigate through packets more efficiently. For this purpose, Wireshark
    allows you to find and mark packets that match certain criteria. You can also
    print packets for easy reference.
  prefs: []
  type: TYPE_NORMAL
- en: '***Finding Packets***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: To find packets that match particular criteria, open the Find Packet bar, shown
    circled in [Figure 4-4](ch04.xhtml#ch04fig4), by pressing CTRL-F. This bar should
    appear between the Filter bar and the Packet List pane.
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f56-02.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-4: Finding packets in Wireshark based on specified criteria—in this
    case, packets matching the display filter expression* tcp'
  prefs: []
  type: TYPE_NORMAL
- en: 'This pane offers three options for finding packets:'
  prefs: []
  type: TYPE_NORMAL
- en: •     The Display filter option allows you to enter an expression-based filter
    that will find only those packets that satisfy that expression. This option is
    used in [Figure 4-4](ch04.xhtml#ch04fig4).
  prefs: []
  type: TYPE_NORMAL
- en: •     The Hex value option searches for packets with a hexadecimal value you
    specify.
  prefs: []
  type: TYPE_NORMAL
- en: •     The String option searches for packets with a text string you specify.
    You can specify the pane the search is performed in or make the search string
    case sensitive.
  prefs: []
  type: TYPE_NORMAL
- en: '[Table 4-1](ch04.xhtml#ch04tab1) shows examples of these search types.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Table 4-1:** Search Types for Finding Packets'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Search type** | **Examples** |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| Display filter | `not ip ip.addr==192.168.0.1 arp` |'
  prefs: []
  type: TYPE_TB
- en: '| Hex value | `00ff ffff 00ABB1f0` |'
  prefs: []
  type: TYPE_TB
- en: '| String | `Workstation1 UserB domain` |'
  prefs: []
  type: TYPE_TB
- en: Once you’ve decided which search type you will use, enter your search criteria
    in the text box and click **Find** to find the first packet that meets your criterion.
    To find the next matching packet, click **Find** again or press CTRL-N; find the
    previous matching packet by pressing CTRL-B.
  prefs: []
  type: TYPE_NORMAL
- en: '***Marking Packets***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: After you have found packets that match your criterion, you can mark those of
    particular interest. For example, marking packets will let you save only these
    packets. Also, you can find your marked packets quickly by their black background
    and white text, as shown in [Figure 4-5](ch04.xhtml#ch04fig5).
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f57-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-5: A marked packet is highlighted on your screen. In this example,
    the second packet is marked and appears darker.*'
  prefs: []
  type: TYPE_NORMAL
- en: To mark a packet, either right-click it in the Packet List pane and choose **Mark
    Packet** from the pop-up or click a packet in the Packet List pane and press CTRL-M.
    To unmark a packet, toggle this setting off by pressing CTRL-M again. You can
    mark as many packets as you wish in a capture. To jump forward and backward between
    marked packets, press SHIFT-CTRL-N and SHIFT-CTRL-B, respectively.
  prefs: []
  type: TYPE_NORMAL
- en: '***Printing Packets***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Although most analysis will take place on the computer screen, you may need
    to print captured data. I occasionally print out packets and tape them to my desk
    so I can quickly reference their contents while doing other analysis. Being able
    to print packets to a PDF file is also very convenient, especially when preparing
    reports.
  prefs: []
  type: TYPE_NORMAL
- en: To print captured packets, open the Print dialog by choosing **File** ▶ **Print**
    from the main menu, as shown in [Figure 4-6](ch04.xhtml#ch04fig6).
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f58-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-6: The Print dialog allows you to print the packets you specify.*'
  prefs: []
  type: TYPE_NORMAL
- en: As with the Export Specified Packets dialog, you can print a specific packet
    range, marked packets only, or packets displayed as the result of a filter. You
    can also select the level of detail you wish to print for each packet. Once you
    have selected the options, click **Print**.
  prefs: []
  type: TYPE_NORMAL
- en: '**Setting Time Display Formats and References**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Time is of the essence—especially in packet analysis. Everything that happens
    on a network is time sensitive, and you will need to examine trends and network
    latency in capture files frequently. Wireshark supplies several configurable options
    related to time. In this section, we’ll look at time display formats and references.
  prefs: []
  type: TYPE_NORMAL
- en: '***Time Display Formats***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Each packet that Wireshark captures is given a timestamp, which is applied to
    the packet by the operating system. Wireshark can show the absolute timestamp,
    which indicates the exact moment when the packet was captured, as well as the
    time in relation to the last captured packet and the beginning and end of the
    capture.
  prefs: []
  type: TYPE_NORMAL
- en: Options related to time display are found under the View heading on the main
    menu. The Time Display Format section, shown in [Figure 4-7](ch04.xhtml#ch04fig7),
    lets you configure the presentation format as well as the precision of the time
    display.
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f59-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-7: Several time display formats are available.*'
  prefs: []
  type: TYPE_NORMAL
- en: The presentation format options let you choose various settings for time display.
    These include date and time of day, UTC date and time of day, seconds since epoch,
    seconds since beginning of capture (the default setting), seconds since previous
    captured packet, and more.
  prefs: []
  type: TYPE_NORMAL
- en: The precision options allow you to set the time display precision to an automatic
    setting, which takes the format from the capture file, or to a manual setting,
    such as seconds, milliseconds, microseconds, and so on. We will be changing these
    options later in the book, so you should familiarize yourself with them now.
  prefs: []
  type: TYPE_NORMAL
- en: '**NOTE**'
  prefs: []
  type: TYPE_NORMAL
- en: '*When comparing packet data from multiple devices, be sure that the devices
    are synchronized with the same time source, especially if you are performing forensic
    analysis or troubleshooting. You can use the Network Time Protocol (NTP) to ensure
    network devices are synced. When examining packets from devices spanning more
    than one time zone, consider analyzing packets in UTC instead of local time to
    avoid confusion when reporting your findings.*'
  prefs: []
  type: TYPE_NORMAL
- en: '***Packet Time Referencing***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Packet time referencing allows you to configure a certain packet so that all
    subsequent time calculations are done in relation to that packet. This feature
    is particularly handy when you are examining a series of sequential events that
    are triggered at some point other than the start of the capture file.
  prefs: []
  type: TYPE_NORMAL
- en: To set a time reference to a packet, right-click the reference packet in the
    Packet List pane and choose **Set/Unset Time Reference**. To toggle this reference
    off, repeat the same action. You can also toggle a packet as a time reference
    on and off by selecting the packet you wish to reference in the Packet List pane
    and pressing CTRL-T.
  prefs: []
  type: TYPE_NORMAL
- en: When you enable a time reference on a packet, the Time column in the Packet
    List pane will display `*REF*`, as shown in [Figure 4-8](ch04.xhtml#ch04fig8).
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f60-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-8: Packet 4 with the packet time reference toggle enabled*'
  prefs: []
  type: TYPE_NORMAL
- en: Setting a packet time reference is useful only when the time display format
    of a capture is set to display the time in relation to the beginning of the capture.
    Any other setting will produce no usable results and indeed will generate a set
    of times that can be very confusing.
  prefs: []
  type: TYPE_NORMAL
- en: '***Time Shifting***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: In some cases, you might encounter packets from multiple sources that are not
    synchronized to the same time source. This is especially common when examining
    capture files taken from two locations that contain the same stream of data. While
    most administrators desire a state in which every device on their network is synced,
    it’s not uncommon for there to be a few seconds of time skew between certain types
    of devices. Wireshark provides the ability to shift the timestamp on packets to
    alleviate this problem during your analysis.
  prefs: []
  type: TYPE_NORMAL
- en: To shift the timestamp on one or more packets, select **Edit** ▶ **Time Shift**
    or press CTRL-SHIFT-T. On the Time Shift screen that opens, you can specify a
    time range to shift the entire capture file by, or you can specify a time to set
    individual packets to. In the example shown in [Figure 4-9](ch04.xhtml#ch04fig9),
    I’ve chosen to shift the timestamp of every packet in the capture by adding two
    minutes and five seconds to each packet.
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f61-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-9: The Time Shift dialog*'
  prefs: []
  type: TYPE_NORMAL
- en: '**Setting Capture Options**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: We looked at the Capture Interfaces dialog while walking through a very basic
    packet capture in the last chapter. Wireshark offers quite a few additional capture
    options that we didn’t address then. To access these options, choose **Capture**
    ▶ **Options**.
  prefs: []
  type: TYPE_NORMAL
- en: 'The Capture Interfaces dialog has a lot of bells and whistles, all designed
    to give you more flexibility while capturing packets. It’s divided into three
    tabs: Input, Output, and Options. We’ll examine each separately.'
  prefs: []
  type: TYPE_NORMAL
- en: '***Input Tab***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The main purpose of the Input tab ([Figure 4-10](ch04.xhtml#ch04fig10)) is to
    display all the interfaces available for capturing packets and some basic information
    for each interface. This includes the friendly name of the interface provided
    by the operating system, a traffic graph showing the throughput on the interface,
    and additional configuration options such as promiscuous mode status and buffer
    size. At the far right (not pictured), there is also a column for the applied
    capture filter, which we’ll talk about in “Capture Filters” on [page 65](ch04.xhtml#page_65).
  prefs: []
  type: TYPE_NORMAL
- en: In this section, you can click most of these options and edit them inline. For
    example, if you want to disable promiscuous mode on an interface, you can click
    that field and change it from enabled to disabled via the provided drop-down menu.
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f62-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-10: The Capture Interfaces Input options tab*'
  prefs: []
  type: TYPE_NORMAL
- en: '***Output Tab***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The Output tab ([Figure 4-11](ch04.xhtml#ch04fig11)) allows you to automatically
    store captured packets in a file, rather than capturing them first and then saving
    the file. Doing so offers you more flexibility in managing how packets are saved.
    You can choose to save them as a single file or a file set or even use a ring
    buffer (which we’ll cover in a moment) to manage the number of files created.
    To enable this option, enter a complete file path and name in the File text box.
    Alternatively, use the Browse... button to select a directory and provide a filename.
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f62-02.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-11: The Capture Interfaces Output options tab*'
  prefs: []
  type: TYPE_NORMAL
- en: When you are capturing a large amount of traffic or performing long-term captures,
    file sets can prove particularly useful. A *file set* is a grouping of multiple
    files separated by a particular condition. To save to a file set, check the **Create
    a new file automatically after...** option.
  prefs: []
  type: TYPE_NORMAL
- en: Wireshark uses various triggers to manage saving to file sets based upon a file
    size or time condition. To enable one of these triggers, select the radio button
    next to the size- or time-based option and then specify the value and unit on
    which to trigger. For instance, you can set a trigger that creates a new file
    after every 1MB of traffic captured or, as shown in [Figure 4-12](ch04.xhtml#ch04fig12),
    after every minute of traffic captured.
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f63-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-12: A file set created by Wireshark at one-minute intervals*'
  prefs: []
  type: TYPE_NORMAL
- en: The Use a ring buffer option lets you specify a certain number of files your
    file set will hold before Wireshark begins to overwrite files. Although the term
    *ring buffer* has multiple meanings, for our purposes, it is essentially a file
    set that specifies that once the last file it can hold has been written, when
    more data must be saved, the first file is overwritten. In other words, it establishes
    a first in, first out (FIFO) method of writing files. You can check this option
    and specify the maximum number of files you wish to cycle through. For example,
    say you choose to use multiple files for your capture with a new file created
    every hour, and you set your ring buffer to 6\. Once the sixth file has been created,
    the ring buffer will cycle back around and overwrite the first file rather than
    create a seventh file. This ensures that no more than six files (or in this case,
    hours) of data will remain on your hard drive, while still allowing new data to
    be written.
  prefs: []
  type: TYPE_NORMAL
- en: Lastly, the Output tab also lets you specify whether to use the .*pcapng* file
    format. If you plan to interact with your saved packets using a tool that isn’t
    capable of parsing .*pcapng*, you can select the traditional .*pcap* format.
  prefs: []
  type: TYPE_NORMAL
- en: '***Options Tab***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The Options tab contains a number of other packet-capturing choices, including
    display, name resolution, and capture termination options, shown in [Figure 4-13](ch04.xhtml#ch04fig13).
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f64-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-13: The Capture Interfaces Options tab*'
  prefs: []
  type: TYPE_NORMAL
- en: '**Display Options**'
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: The Display Options section controls how packets are shown as they are being
    captured. The Update list of packets in real-time option is self-explanatory and
    can be paired with the Automatically scroll during live capture option. When both
    of these options are enabled, all captured packets are displayed on the screen,
    with the most recently captured ones shown instantly.
  prefs: []
  type: TYPE_NORMAL
- en: '**WARNING**'
  prefs: []
  type: TYPE_NORMAL
- en: '*When paired, the Update list of packets in real-time and Automatically scroll
    during live capture options can be processor intensive, even when you are capturing
    a modest amount of data. Unless you have a specific need to see the packets in
    real time, it’s best to deselect both options.*'
  prefs: []
  type: TYPE_NORMAL
- en: The Show extra capture information dialog option lets you enable or suppress
    the display of a small window that shows the number and percentage of packets
    that have been captured, sorted by their protocol. I like to show the capture
    info dialog since I typically don’t allow for the live scrolling of packets during
    capture.
  prefs: []
  type: TYPE_NORMAL
- en: '**Name Resolution Settings**'
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: The Name Resolution section options allow you to enable automatic MAC (layer
    2), network (layer 3), and transport (layer 4) name resolution for your capture.
    We’ll discuss name resolution as a general topic in more depth, including its
    drawbacks, in [Chapter 5](ch05.xhtml#ch05).
  prefs: []
  type: TYPE_NORMAL
- en: '**Stop Capture Settings**'
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: The Stop capture automatically after... section lets you stop the running capture
    when certain conditions are met. As with multiple file sets, you can trigger the
    capture to stop based on file size and time interval, but you can also trigger
    on number of packets. These options can be used with the multiple-file options
    on the Output tab.
  prefs: []
  type: TYPE_NORMAL
- en: '**Using Filters**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Filters allow you to specify which packets you have available for analysis.
    Simply stated, a filter is an expression that defines criteria for the inclusion
    or exclusion of packets. If there are packets you don’t want to see, you can write
    a filter that gets rid of them. If there are packets you want to see exclusively,
    you can write a filter that shows only those packets.
  prefs: []
  type: TYPE_NORMAL
- en: 'Wireshark offers two main types of filters:'
  prefs: []
  type: TYPE_NORMAL
- en: •     *Capture filters* are specified when packets are being captured and will
    capture only those packets that are specified for inclusion/exclusion in the given
    expression.
  prefs: []
  type: TYPE_NORMAL
- en: •     *Display filters* are applied to an existing set of captured packets in
    order to hide unwanted packets or show desired packets based on the specified
    expression.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s look at capture filters first.
  prefs: []
  type: TYPE_NORMAL
- en: '***Capture Filters***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Capture filters are applied during the packet-capturing process to limit the
    packets delivered to the analyst from the start. One primary reason for using
    a capture filter is performance. If you know that you do not need to analyze a
    particular form of traffic, you can simply filter it out with a capture filter
    and save the processing power that would typically be used in capturing those
    packets.
  prefs: []
  type: TYPE_NORMAL
- en: The ability to create custom capture filters comes in handy when you’re dealing
    with large amounts of data. The analysis can be sped up by ensuring that you are
    looking at only the packet relevant to the issue at hand.
  prefs: []
  type: TYPE_NORMAL
- en: 'As an example, suppose you are troubleshooting an issue with a service running
    on port 262, but the server you are analyzing runs several different services
    on a variety of ports. Finding and analyzing only the traffic on one port would
    be quite a job in itself. To capture only the traffic on a specific port, you
    could use a capture filter. To do so, use the Capture Interfaces dialog as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Choose the **Capture** ▶ **Options** button next to the interface on which you
    want to capture packets. This will open the Capture Interfaces dialog.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Find the interface you wish to use and scroll to the Capture Filter option in
    the far-right column.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You can apply the capture filter by clicking in this column to enter an expression.
    We want our filter to show only traffic inbound and outbound to port 262, so enter
    **port 262**, as shown in [Figure 4-14](ch04.xhtml#ch04fig14). (We’ll discuss
    expressions in more detail in the next section.) The color of the cell should
    turn green, indicating that you’ve entered a valid expression; it will turn red
    if the expression is invalid.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![image](../images/f66-01.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: '*Figure 4-14: Creating a capture filter in the Capture Interfaces dialog*'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Once you have set your filter, click **Start** to begin the capture.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You should now see only port 262 traffic and be able to more efficiently analyze
    this particular data.
  prefs: []
  type: TYPE_NORMAL
- en: '**Capture/BPF Syntax**'
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: Capture filters are applied by libpcap/WinPcap and use the Berkeley Packet Filter
    (BPF) syntax. This syntax is common in several packet-sniffing applications, mostly
    because packet-sniffing applications tend to rely on the libpcap/WinPcap libraries,
    which allow for the use of BPFs. A knowledge of BPF syntax will be crucial as
    you dig deeper into networks at the packet level.
  prefs: []
  type: TYPE_NORMAL
- en: A filter created using the BPF syntax is called an *expression*, and each expression
    consists of one or more *primitives*. Primitives consist of one or more *qualifiers*
    (as listed in [Table 4-2](ch04.xhtml#ch04tab2)), followed by an ID name or number,
    as shown in [Figure 4-15](ch04.xhtml#ch04fig15).
  prefs: []
  type: TYPE_NORMAL
- en: '**Table 4-2:** The BPF Qualifiers'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Qualifier** | **Description** | **Examples** |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| Type | Identifies what the ID name or number refers to | `host, net, port`
    |'
  prefs: []
  type: TYPE_TB
- en: '| Dir | Specifies a transfer direction to or from the ID name or number | `src,
    dst` |'
  prefs: []
  type: TYPE_TB
- en: '| Proto | Restricts the match to a particular protocol | `ether, ip, tcp, udp,
    http, ftp` |'
  prefs: []
  type: TYPE_TB
- en: '![image](../images/f67-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-15: A sample capture filter*'
  prefs: []
  type: TYPE_NORMAL
- en: Given the components of an expression, a qualifier of `dst host` and an ID of
    192.168.0.10 would combine to form a primitive. This primitive alone is an expression
    that would capture traffic only with a destination IP address of 192.168.0.10.
  prefs: []
  type: TYPE_NORMAL
- en: 'You can use logical operators to combine primitives to create more advanced
    expressions. Three logical operators are available:'
  prefs: []
  type: TYPE_NORMAL
- en: •     Concatenation operator AND (`&&`)
  prefs: []
  type: TYPE_NORMAL
- en: •     Alternation operator OR (`||`)
  prefs: []
  type: TYPE_NORMAL
- en: •     Negation operator NOT (`!`)
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, the following expression will capture only traffic with a source
    IP address of 192.168.0.10 and a source or destination port of 80:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '**Hostname and Addressing Filters**'
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: Most filters you create will center on a particular network device or grouping
    of devices. Depending on the circumstances, filtering can be based on a device’s
    MAC address, IPv4 address, IPv6 address, or DNS hostname.
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, say you’re curious about the traffic of a particular host that
    is interacting with a server on your network. From the server, you can create
    a filter using the `host` qualifier that captures all traffic associated with
    that host’s IPv4 address:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'If you are on an IPv6 network, you would filter based on an IPv6 address using
    the `host` qualifier, as shown here:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'You can also filter based on a device’s hostname with the `host` qualifier,
    like so:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'Or, if you’re concerned that the IP address for a host might change, you can
    filter based on its MAC address as well by adding the `ether` protocol qualifier:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'The transfer direction qualifiers are often used in conjunction with filters,
    such as the ones in the previous examples, to capture traffic based on whether
    it’s going to or coming from a host. For example, to capture only traffic coming
    from a particular host, add the `src` qualifier:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'To capture only data destined for 172.16.16.149, use the `dst` qualifier:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'When you don’t use a type qualifier (`host`, `net`, or `port`) with a primitive,
    the `host` qualifier is assumed. Therefore, this expression, which excludes that
    qualifier, is the equivalent of the preceding example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '**Port Filters**'
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: 'In addition to filtering on hosts, you can filter based on the ports used in
    each packet. Port filtering can be used to filter for services and applications
    that use known service ports. For example, here’s a simple filter to capture traffic
    only to or from port 8080:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'To capture all traffic except that on port 8080, this would work:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'The port filters can be combined with transfer direction qualifiers. For example,
    to capture only traffic going to the web server listening on the standard HTTP
    port 80, use the `dst` qualifier:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '**Protocol Filters**'
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: 'Protocol filters let you filter packets based on certain protocols. They are
    used to match non–application layer protocols that can’t simply be defined by
    the use of a certain port. Thus, if you want to see only ICMP traffic, you could
    use this filter:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: 'To see everything but IPv6 traffic, this will do the trick:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: '**Protocol Field Filters**'
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: One of the real strengths of the BPF syntax is the ability that it gives us
    to examine every byte of a protocol header in order to create very specific filters
    based on that data. The advanced filters that we’ll discuss in this section will
    allow you to retrieve a specific number of bytes from a packet beginning at a
    particular location.
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, suppose that we want to filter based on the type field of an ICMP
    header. The type field is located at the very beginning of a packet, which puts
    it at offset 0\. To identify the location to examine within a packet, specify
    the byte offset in square brackets next to the protocol qualifier—`icmp[0]` in
    this example. This specification will return a 1-byte integer value that we can
    compare against. For instance, to get only ICMP packets that represent destination
    unreachable (type 3) messages, we use the equal to operator in our filter expression:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: 'To examine only ICMP packets that represent an echo request (type 8) or echo
    reply (type 0), use two primitives with the OR operator:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: These filters work great, but they filter based on only 1 byte of information
    within a packet header. You can also specify the length of the data to be returned
    in your filter expression by appending the byte length after the offset number
    within the square brackets, separated by a colon.
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, say we want to create a filter that captures all ICMP destination-unreachable,
    host-unreachable packets, identified by type 3, code 1\. These are 1-byte fields,
    located next to each other at offset 0 of the packet header. To do this, we create
    a filter that checks 2 bytes of data beginning at offset 0 of the packet header,
    and we compare that data against the hex value 0301 (type 3, code 1), like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: A common scenario is to capture only TCP packets with the RST flag set. We will
    cover TCP extensively in [Chapter 8](ch08.xhtml#ch08). For now, you just need
    to know that the flags of a TCP packet are located at offset 13\. This is an interesting
    field because it is collectively 1 byte in size as the flags field, but each particular
    flag is identified by a single bit within this byte. As I will discuss further
    in [Appendix B](ch15_appb.xhtml#ch15_appb), each bit in a byte represents some
    base 2 number. The bit the flag is stored in is specified by the number the bit
    represents, so the first bit would represent 1, the second 2, the third 4, and
    so on. Multiple flags can be set simultaneously in a TCP packet. Therefore, we
    can’t efficiently filter by using a single `tcp[13]` value because several values
    may represent the RST bit being set.
  prefs: []
  type: TYPE_NORMAL
- en: 'Instead, we must specify the location within the byte that we wish to examine
    by appending a single ampersand (`&`), followed by the number that represents
    where the flag is stored. The RST flag is at the bit representing the number 4
    within this byte, and the fact that this bit is set to 4 tells us that the RST
    flag is set. The filter looks like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: 'To see all packets with the PSH flag set, which is identified by the bit location
    representing the number 8 in the TCP flags at offset 13, our filter would use
    that location instead:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: '**Sample Capture Filter Expressions**'
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: You will often find that the success or failure of your analysis depends on
    your ability to create filters appropriate for your current situation. [Table
    4-3](ch04.xhtml#ch04tab3) shows a few common capture filters that you might use
    frequently.
  prefs: []
  type: TYPE_NORMAL
- en: '**Table 4-3:** Commonly Used Capture Filters'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Filter** | **Description** |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| `tcp[13] & 32 == 32` | TCP packets with the URG flag set |'
  prefs: []
  type: TYPE_TB
- en: '| `tcp[13] & 16 == 16` | TCP packets with the ACK flag set |'
  prefs: []
  type: TYPE_TB
- en: '| `tcp[13] & 8 == 8` | TCP packets with the PSH flag set |'
  prefs: []
  type: TYPE_TB
- en: '| `tcp[13] & 4 == 4` | TCP packets with the RST flag set |'
  prefs: []
  type: TYPE_TB
- en: '| `tcp[13] & 2 == 2` | TCP packets with the SYN flag set |'
  prefs: []
  type: TYPE_TB
- en: '| `tcp[13] & 1 == 1` | TCP packets with the FIN flag set |'
  prefs: []
  type: TYPE_TB
- en: '| `tcp[13] == 18` | TCP SYN-ACK packets |'
  prefs: []
  type: TYPE_TB
- en: '| `ether host` 00`:`00`:`00`:`00`:`00`:`00 | Traffic to or from your MAC address
    |'
  prefs: []
  type: TYPE_TB
- en: '| `!ether host` 00`:`00`:`00`:`00`:`00`:`00 | Traffic not to or from your MAC
    address |'
  prefs: []
  type: TYPE_TB
- en: '| `broadcast` | Broadcast traffic only |'
  prefs: []
  type: TYPE_TB
- en: '| `icmp` | ICMP traffic |'
  prefs: []
  type: TYPE_TB
- en: '| `icmp[0:2] == 0x0301` | ICMP destination unreachable, host unreachable |'
  prefs: []
  type: TYPE_TB
- en: '| `ip` | IPv4 traffic only |'
  prefs: []
  type: TYPE_TB
- en: '| `ip6` | IPv6 traffic only |'
  prefs: []
  type: TYPE_TB
- en: '| `udp` | UDP traffic only |'
  prefs: []
  type: TYPE_TB
- en: '***Display Filters***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: A display filter is one that, when applied to a capture file, tells Wireshark
    to display only packets that match that filter. You can enter a display filter
    in the Filter text box above the Packet List pane.
  prefs: []
  type: TYPE_NORMAL
- en: Display filters are used more often than capture filters because they allow
    you to filter the packet data you see without actually omitting the rest of the
    data in the capture file. That way, if you need to revert to the original capture,
    you can simply clear the filter expression. They are also a lot more powerful
    thanks to Wireshark’s extensive library of packet dissectors.
  prefs: []
  type: TYPE_NORMAL
- en: As an example, in some situations, you might use a display filter to clear irrelevant
    broadcast traffic from a capture file by filtering out ARP broadcasts from the
    Packet List pane when those packets don’t relate to the current problem being
    analyzed. However, because those ARP broadcast packets may be useful later, it’s
    better to filter them temporarily than it is to delete them.
  prefs: []
  type: TYPE_NORMAL
- en: To filter out all ARP packets in the capture window, place your cursor in the
    Filter text box at the top of the Packet List pane and enter !arp to remove all
    ARP packets from the list ([Figure 4-16](ch04.xhtml#ch04fig16)). To remove the
    filter, click the **X** button, and to save the filter for later, click the plus
    (+) button.
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f71-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-16: Creating a display filter using the Filter text box above the
    Packet List pane*'
  prefs: []
  type: TYPE_NORMAL
- en: There are two ways to apply display filters. One is to apply them directly using
    the appropriate syntax, as we did in this example. Another is to use the Display
    Filter Expression dialog to build your filter iteratively; this is the easier
    method when you are first starting to use filters. Let’s explore both methods,
    starting with the easier first.
  prefs: []
  type: TYPE_NORMAL
- en: '**The Display Filter Expression Dialog**'
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: The Display Filter Expression dialog, shown in [Figure 4-17](ch04.xhtml#ch04fig17),
    makes it easy for novice Wireshark users to create capture and display filters.
    To access this dialog, click the **Expression** button on the Filter toolbar.
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f72-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-17: The Display Filter Expression dialog allows for the easy creation
    of filters in Wireshark.*'
  prefs: []
  type: TYPE_NORMAL
- en: 'The left side of the dialog lists all possible protocol fields, and these fields
    specify all possible filter criteria. To create a filter, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: To view the criteria fields associated with a protocol, expand that protocol
    by clicking the arrow symbol next to it. Once you find the criterion you want
    to base your filter on, click to select it.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose how your selected field will relate to the criterion value you supply.
    This relation is specified as equal to, greater than, less than, and so on.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create your filter expression by specifying a criterion value that will relate
    to your selected field. You can define this value or select it from predefined
    ones programmed into Wireshark.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Your complete filter will be displayed at the bottom of the screen. When you’ve
    finished, click **OK** to insert it into the filter bar.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The Display Filter Expression dialog is great for novice users, but once you
    get the hang of things, you’ll find that manually entering filter expressions
    greatly increases your efficiency. The display filter expression syntax structure
    is simple, yet extremely powerful.
  prefs: []
  type: TYPE_NORMAL
- en: '**The Filter Expression Syntax Structure**'
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: When you begin using Wireshark more, you will want to start using the display
    filter syntax directly in the main window to save time. Fortunately, the syntax
    used for display filters follows a standard scheme and is easy to navigate. In
    most cases, this scheme is protocol-centric and follows the format protocol`.`feature`.`subfeature,
    as you saw when looking at the Display Filter Expression dialog. Now we will look
    at a few examples.
  prefs: []
  type: TYPE_NORMAL
- en: You will most often use a capture or display filter to see packets based on
    a specific protocol alone. For example, say you are troubleshooting a TCP problem
    and you want to see only TCP traffic in a capture file. If so, a simple `tcp`
    filter will do the job.
  prefs: []
  type: TYPE_NORMAL
- en: Now let’s look at things from the other side of the fence. Imagine that in the
    course of troubleshooting your TCP problem, you have used the ping utility quite
    a bit, thereby generating a lot of ICMP traffic. You could remove this ICMP traffic
    from your capture file with the filter `expression !icmp`.
  prefs: []
  type: TYPE_NORMAL
- en: 'Comparison operators allow you to compare values. For example, when troubleshooting
    TCP/IP networks, you will often need to view all packets that reference a particular
    IP address. The equal to comparison operator (`==`) will allow you to create a
    filter showing all packets with an IP address of 192.168.0.1:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: 'Now suppose that you need to view only packets that are less than 128 bytes.
    You can use the less than or equal to operator (`<=`) to accomplish this goal:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: '[Table 4-4](ch04.xhtml#ch04tab4) shows Wireshark’s comparison operators.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Table 4-4:** Wireshark Filter Expression Comparison Operators'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Operator** | **Description** |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| `==` | Equal to |'
  prefs: []
  type: TYPE_TB
- en: '| `!=` | Not equal to |'
  prefs: []
  type: TYPE_TB
- en: '| `>` | Greater than |'
  prefs: []
  type: TYPE_TB
- en: '| `<` | Less than |'
  prefs: []
  type: TYPE_TB
- en: '| `>=` | Greater than or equal to |'
  prefs: []
  type: TYPE_TB
- en: '| `<=` | Less than or equal to |'
  prefs: []
  type: TYPE_TB
- en: 'Logical operators allow you to combine multiple filter expressions into one
    statement, dramatically increasing the effectiveness of your filters. For example,
    say that you’re interested in displaying only packets to two IP addresses. You
    can use the `or` operator to create one expression that will display packets containing
    either IP address, like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: '[Table 4-5](ch04.xhtml#ch04tab5) lists Wireshark’s logical operators.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Table 4-5:** Wireshark Filter Expression Logical Operators'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Operator** | **Description** |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| `and` | Both conditions must be true. |'
  prefs: []
  type: TYPE_TB
- en: '| `or` | Either one of the conditions must be true. |'
  prefs: []
  type: TYPE_TB
- en: '| `xor` | One and only one condition must be true. |'
  prefs: []
  type: TYPE_TB
- en: '| `not` | Neither one of the conditions is true. |'
  prefs: []
  type: TYPE_TB
- en: '**Sample Display Filter Expressions**'
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: Although the concepts related to creating filter expressions are fairly simple,
    you will need to use several specific keywords and operators when creating new
    filters for various problems. [Table 4-6](ch04.xhtml#ch04tab6) shows some of the
    display filters that I use most often. For a complete list, see the Wireshark
    display filter reference at *[http://www.wireshark.org/docs/dfref/](http://www.wireshark.org/docs/dfref/)*.
  prefs: []
  type: TYPE_NORMAL
- en: '**Table 4-6:** Commonly Used Display Filters'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Filter** | **Description** |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| `!tcp.port==3389` | Filter out RDP traffic |'
  prefs: []
  type: TYPE_TB
- en: '| `tcp.flags.syn==1` | TCP packets with the SYN flag set |'
  prefs: []
  type: TYPE_TB
- en: '| `tcp.flags.reset==1` | TCP packets with the RST flag set |'
  prefs: []
  type: TYPE_TB
- en: '| `!arp` | Clear ARP traffic |'
  prefs: []
  type: TYPE_TB
- en: '| `http` | All HTTP traffic |'
  prefs: []
  type: TYPE_TB
- en: '| `tcp.port==23 &#124;&#124; tcp.port==21` | Telnet or FTP traffic |'
  prefs: []
  type: TYPE_TB
- en: '| `smtp &#124;&#124; pop &#124;&#124; imap` | Email traffic (SMTP, POP, or
    IMAP) |'
  prefs: []
  type: TYPE_TB
- en: '***Saving Filters***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Once you begin creating a lot of capture and display filters, you will find
    that you use certain ones frequently. Fortunately, you don’t need to type these
    in each time you want to use them, because Wireshark lets you save your filters
    for later use. To save a custom capture filter, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Select **Capture** ▶ **Capture Filters** to open the Capture Filter dialog.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a new filter by clicking the plus (+) button on the lower left side of
    the dialog.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter a name for your filter in the Filter Name box.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter the actual filter expression in the Filter String box.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the **OK** button to save your filter expression in the list.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'To save a custom display filter, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Type your filter into the Filter bar above the Packet List pane in the main
    window and click the **ribbon** button on the left side of the bar.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the **Save this Filter** option, and a list of saved display filters will
    be presented in a separate dialog. There you can provide a name for your filter
    before clicking **OK** to save it ([Figure 4-18](ch04.xhtml#ch04fig18)).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![image](../images/f75-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-18: You can save display filters directly from the main toolbar.*'
  prefs: []
  type: TYPE_NORMAL
- en: '***Adding Display Filters to a Toolbar***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'If you have filters that you find yourself flipping on and off frequently,
    one of the easiest ways to interact with them is to add filter toggles to the
    Filter bar just above the Packet List pane. To do this, complete the following
    steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Type your filter into the Filter bar above the Packet List pane in the main
    window and click the plus (+) button on the right side of the bar.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: A new bar will display below the Filter bar where you can provide a name for
    your filter in the Label field ([Figure 4-19](ch04.xhtml#ch04fig19)). This is
    the label that will be used to represent the filter on the toolbar. Once you’ve
    input something in this field, click **OK** to create a shortcut to this expression
    in the Filter toolbar.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![image](../images/f76-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-19: Adding a filter expression shortcut to the Filter toolbar*'
  prefs: []
  type: TYPE_NORMAL
- en: As you can see in [Figure 4-20](ch04.xhtml#ch04fig20), we’ve created a shortcut
    to a filter that will quickly show any TCP packets with the RST flag enabled.
    Additions to the filtering toolbar are saved to your configuration profile (as
    discussed in [Chapter 3](ch03.xhtml#ch03)), making them a powerful way to enhance
    your ability to identify problems in packet captures in various scenarios.
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f76-02.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Figure 4-20: Filtering using a toolbar shortcut*'
  prefs: []
  type: TYPE_NORMAL
- en: Wireshark includes several built-in filters that are great examples of what
    a filter should look like. You’ll want to use them (together with the Wireshark
    help pages) when creating your own filters. We’ll use filters in examples throughout
    this book.
  prefs: []
  type: TYPE_NORMAL
