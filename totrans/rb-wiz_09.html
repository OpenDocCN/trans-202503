<html><head></head><body>
  <div class="chapter" title="Chapter&#xA0;10.&#xA0;A Horse of a Different Color">&#13;
    <div class="titlepage">&#13;
      <h1 class="title" id="heading_id_2"><a id="horse_of_a_different_color"/>Chapter 10. A Horse of a Different Color</h1>&#13;
    </div>&#13;
&#13;
    <div class="sect1" title="Utter Panda-monium">&#13;
      <div class="titlepage">&#13;
        <h1 class="title" id="heading_id_3"><a id="utter_panda-monium"/>Utter Panda-monium</h1>&#13;
      </div>&#13;
&#13;
      <p><a class="indexterm" id="iddle1832"/>The King, the Queen, Ruben, and Scarlet spiraled down staircase after staircase toward the Royal Stables. Just when Ruben and Scarlet thought there would be no end to the twisty maze of stairs, the Queen reached a huge set of heavy oak doors and threw them open. They all ran blinking into the sudden light of the fields behind the palace, and only a stone’s throw away stood the entrance to the Royal Stables.</p>&#13;
&#13;
      <p>“Over here!” said the Queen. “Quickly now!”</p>&#13;
&#13;
      <p>They ran to the front gate of the stables, where two of the Queen’s guards were waiting. Each held a very familiar-looking Senior Apprentice to the Royal Plumber by the arm.</p>&#13;
&#13;
      <div class="informalfigure">&#13;
        <a id="med_id00048a"/>&#13;
&#13;
        <div class="mediaobject"><a id="med_id00048"/><img alt="image with no caption" src="../Images/httpatomoreillycomsourcenostarchimages2160049.png.jpg"/></div>&#13;
      </div>&#13;
&#13;
      <p>“Haldo!” gasped Ruben.</p>&#13;
&#13;
      <p>“Now, now,” said the King. “I’m sure there’s a reasonable explanation for all this.” Despite his words, the King looked worried. He turned to Haldo. “Haldo, what in the name of the Hashery’s glorious breakfast hash is the explanation for all this?”</p>&#13;
&#13;
      <p>Before Haldo could respond, the Queen approached the guards. “Haldo isn’t who I saw in my Royal Office,” she said. “There were four of them, and they were much shorter. Please release him.”</p>&#13;
&#13;
      <p>The guards nodded and dropped Haldo’s arms.</p>&#13;
&#13;
      <p>“Thank you, Your Highness,” Haldo said, brushing himself off.</p>&#13;
&#13;
      <p>“Why are you down here at the stables?” asked the King.</p>&#13;
&#13;
      <p>“That’s what we were just asking him,” said the guard with the crooked nose.</p>&#13;
&#13;
      <p>“I was trying to explain,” said Haldo. “You see, after searching through the Ambrose Caverns and finding nothing, I returned to my work as the Senior Apprentice to the Royal Plumber. I’d learned so much from Scarlet and Ruben about Ruby, though, that I could do a day’s work in just a few hours. I had a bit of spare time on my hands, so I took on the job of Part-Time Apprentice to the Royal Stableman as well.”</p>&#13;
&#13;
      <p>“Marvelous,” said the King, visibly relieved that Haldo was not the villain they’d been chasing. “A veritable jack-of-all-trades!”</p>&#13;
&#13;
      <p>“I’m not sure I’d go that far,” Haldo said, blushing slightly.</p>&#13;
&#13;
      <p>“Your Majesties,” said the guard without the crooked nose, “we chased a group of hooded figures from the Queen’s office, but lost track of them once they got out here to the stables. When we saw what had happened, Haldo was the only one around. We thought he might be involved, so we called the Queen.” He shrugged. “Turns out Haldo had come out to see what the trouble was and try to help.”</p>&#13;
&#13;
      <p>“One moment,” said the Queen. “When you saw <span class="emphasis"><em>what</em></span> had happened in the stables?”</p>&#13;
&#13;
      <p>The guards exchanged an uneasy look. “You’d better come see,” said the guard with the crooked nose.</p>&#13;
&#13;
      <p>The group hurried into the stables. The two guards pointed to the first stall, and the King, the Queen, Ruben, and Scarlet peered inside.</p>&#13;
&#13;
      <p>“Strangest horse I’ve ever seen,” said the King.</p>&#13;
&#13;
      <div class="informalfigure">&#13;
        <a id="med_id00049a"/>&#13;
&#13;
        <div class="mediaobject"><a id="med_id00049"/><img alt="image with no caption" src="../Images/httpatomoreillycomsourcenostarchimages2160051.png.jpg"/></div>&#13;
      </div>&#13;
&#13;
      <p>“That . . . is a panda,” said Ruben.</p>&#13;
&#13;
      <p>“And it’s red!” moaned the Queen. “Good heavens, what’s happened here?”</p>&#13;
&#13;
      <p>“It’s not supposed to be red?” Scarlet asked.</p>&#13;
&#13;
      <p>“Not at all!” said the Queen. “All royal pandas are supposed to be purple!” She ran to the next stall, then the next, then the next. “This one’s blue!” she cried. “And this one’s yellow! Not a single panda is purple!” She threw up her hands. “Whoever heard of a Purple Panda-monium Parade with pandas of every color <span class="emphasis"><em>except</em></span> purple?”</p>&#13;
&#13;
      <p>“Wait, the pandas were purple, but now they’re not?” said Ruben. “Aren’t they <span class="emphasis"><em>born</em></span> purple?”</p>&#13;
&#13;
      <p>“And what, exactly, is the Purple Panda-monium Parade?” Scarlet asked.</p>&#13;
&#13;
      <p>“One at a time,” said the Queen. She turned to Ruben “No, the pandas aren’t born purple. They’re born white, but we feed them special extra-nutritious food that turns them purple. As for the parade,” she said to Scarlet, “We hold it once a month to celebrate the peace and prosperity of the kingdom. We figure if there’s going to be a little craziness in our lives, we should at least be in control of it.” She sighed. “Of course, given all the chaos today, we won’t be able to hold the parade.”</p>&#13;
&#13;
      <p>“Not so fast,” said Scarlet. “I’ll bet we can fix this! It sounds like someone must have tampered with the pandas’ food. Where is it?”</p>&#13;
&#13;
      <p>“Over here,” said Haldo. “The food is prepared by the Panda Provisionator 3000.”</p>&#13;
&#13;
      <p>They all walked past the rows of stalls to the far side of the stable, where a huge round machine covered in dials and switches hummed away. A familiar-looking screen glowed in its center.</p>&#13;
&#13;
      <div class="informalfigure">&#13;
        <a id="med_id00050a"/>&#13;
&#13;
        <div class="mediaobject"><a id="med_id00050"/><img alt="image with no caption" src="../Images/httpatomoreillycomsourcenostarchimages2160053.png.jpg"/></div>&#13;
      </div>&#13;
&#13;
      <p>“A Computing Contraption!” said Ruben. “Does the Panda Provisionator 3000 run on Ruby?”</p>&#13;
&#13;
      <p>“Absolutely,” said Haldo. “Ever since you kids helped me fix the Mysterious Pipe, I’ve been learning as much Ruby as I can. I daresay I’ve gotten pretty good,” he said, hooking his thumbs behind the straps of his overalls. “I’ve even gotten the hang of the Panda Provisionator here.”</p>&#13;
&#13;
      <p>“Could you tell us if someone’s messed with the pandas’ food?” Ruben asked.</p>&#13;
&#13;
      <p>“And can you fix it?” asked the Queen, looking anxious.</p>&#13;
    </div>&#13;
&#13;
    <div class="sect1" title="Creating Modules">&#13;
      <div class="titlepage">&#13;
        <h1 class="title" id="heading_id_4"><a id="creating_modules"/>Creating Modules</h1>&#13;
      </div>&#13;
&#13;
      <p><a class="indexterm" id="iddle1199"/><a class="indexterm" id="iddle1285"/><a class="indexterm" id="iddle1535"/><a class="indexterm" id="iddle1552"/><a class="indexterm" id="iddle1771"/>“I think so,” said Haldo. “Let’s have a look.” He opened a file called <span class="emphasis"><em>colorize.rb</em></span> on the Computing Contraption, and this is what the group saw:</p><a id="pro_id00309"/>&#13;
      <pre class="programlisting">&#13;
module Colorize&#13;
  def color&#13;
    [:red, :blue, :green, :yellow].sample&#13;
  end&#13;
end&#13;
</pre>&#13;
&#13;
      <p>“Aha!” said Haldo. “I see the trouble here. Someone’s changed the <code class="literal">color</code> method to return a random color as a symbol—either red, blue, green, or yellow. That’s what the <code class="literal">sample</code> method does,” he explained. “It picks a random item from an array.”</p>&#13;
&#13;
      <p>“That’s why the pandas are all different colors <span class="emphasis"><em>except</em></span> purple!” Ruben said. “But wait a minute—there’s nothing about panda food in this file. And what does the first line mean?”</p>&#13;
&#13;
      <p>“That? That means this code is a <span class="emphasis"><em>module</em></span>,” said Haldo, scratching his heavy black beard. “You can think of a Ruby module as a bucket of handy information and methods that we can use whenever we need it.”</p>&#13;
&#13;
      <p>“It looks kind of like a class,” said Scarlet.</p>&#13;
&#13;
      <p>“It’s very much like a class!” said Haldo. “Like classes, modules have their own methods. In fact, that’s all modules really are: just collections of methods!”</p>&#13;
&#13;
      <p>“Then what’s the difference between classes and modules?” Ruben asked.</p>&#13;
&#13;
      <p>“Modules are actually <span class="emphasis"><em>exactly</em></span> like classes, only we can’t make new modules with the <code class="literal">new</code> method,” Haldo explained. “First, let’s do a lightning-quick review of classes.” He started up IRB and typed:</p><a id="pro_id00310"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">class FancyClass; end</span></strong></span>&#13;
=&gt; nil&#13;
</pre>&#13;
&#13;
      <p>“That just creates a new, empty class called <code class="literal">FancyClass</code>,” Haldo explained.</p>&#13;
&#13;
      <p><a class="indexterm" id="iddle1058"/><a class="indexterm" id="iddle1190"/><a class="indexterm" id="iddle1293"/><a class="indexterm" id="iddle1590"/><a class="indexterm" id="iddle1608"/><a class="indexterm" id="iddle1798"/>“What’s that semicolon for?” Scarlet asked.</p>&#13;
&#13;
      <p>“It’s just a way of telling Ruby you’re done with a line of code,” Haldo said. “Normally in IRB you do that by pressing <span class="smaller">RETURN</span> or <span class="smaller">ENTER</span> and starting a new line, but since our class and module definitions are empty, we can just use the semicolon to tell Ruby we’re done with one line and we’re starting a new one.” He shrugged. “Some people don’t like to use semicolons. To each her own! Now, let’s create an instance of our <code class="literal">FancyClass</code>.”</p><a id="pro_id00311"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">FancyClass.new</span></strong></span>&#13;
=&gt; #&lt;FancyClass:0x000001044d80c8&gt;&#13;
</pre>&#13;
&#13;
      <p>“You’ve created instances of classes before, right?” Haldo asked. Scarlet and Ruben nodded. “Good!” he said. “Now, let’s create a module and try to create an instance of it.”</p><a id="pro_id00312"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">module ImportantThings; end</span></strong></span>&#13;
=&gt; nil&#13;
&#13;
&gt;&gt; <span class="strong"><strong><span class="red">ImportantThings.new</span></strong></span>&#13;
NoMethodError: undefined method `new' for ImportantThings:Module&#13;
</pre>&#13;
&#13;
      <p>“Trying to create an instance of a module causes an error because modules don’t have the <code class="literal">new</code> method that classes do,” Haldo said.</p>&#13;
&#13;
      <p>“So if you can’t create instances of a module,” Ruben said, “what <span class="emphasis"><em>can</em></span> you do with it?”</p>&#13;
&#13;
      <p>“I’ll show you!” said Haldo. “Let’s create a module of our own.” He typed:</p><a id="pro_id00313"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">module Bucket</span></strong></span>&#13;
&gt;&gt;   <span class="strong"><strong><span class="red">MAX_BITS_AND_TRINKETS = 100</span></strong></span>&#13;
&#13;
&gt;&gt;   <span class="strong"><strong><span class="red">def announcing_bits_and_trinkets</span></strong></span>&#13;
&gt;&gt;     <span class="strong"><strong><span class="red">puts 'Step right up! Bits and trinkets available now!'</span></strong></span>&#13;
&gt;&gt;   <span class="strong"><strong><span class="red">end</span></strong></span>&#13;
&gt;&gt; <span class="strong"><strong><span class="red">end</span></strong></span>&#13;
=&gt; nil&#13;
</pre>&#13;
&#13;
      <p>“What’s <code class="literal">MAX_BITS_AND_TRINKETS</code>,” Scarlet asked, “and why is it in all caps?”</p>&#13;
    </div>&#13;
&#13;
    <div class="sect1" title="Constants">&#13;
      <div class="titlepage">&#13;
        <h1 class="title" id="heading_id_5"><a id="constants"/>Constants</h1>&#13;
      </div>&#13;
&#13;
      <p><a class="indexterm" id="iddle1214"/><a class="indexterm" id="iddle1400"/>“That’s a <span class="emphasis"><em>constant</em></span>,” said Haldo. “Constants are like variables, only their values don’t change once you set them. They start with a capital letter—for example, class and module names are constants—and while you <span class="emphasis"><em>technically</em></span> can reassign them during your Ruby program, Ruby will warn you if you do. See?” He typed:</p><a id="pro_id00314"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">RUBY = 'Wonderful!'</span></strong></span>&#13;
=&gt; "Wonderful!"&#13;
&#13;
&gt;&gt; <span class="strong"><strong><span class="red">RUBY = 'Stupendous!'</span></strong></span>&#13;
(irb):2: warning: already initialized constant RUBY =&gt;&#13;
"Stupendous!"&#13;
</pre>&#13;
&#13;
      <p>“When you create your own constant that isn’t a class or module—that is, just a name for a value that won’t change—you usually write it in ALL CAPS,” Haldo said.</p>&#13;
&#13;
      <p>“Can you use constants only inside modules?” Ruben asked.</p>&#13;
&#13;
      <p>“Nope!” Haldo said. “You can use them anywhere in your Ruby program. I just bring them up now because class names and module names are technically constants, since they start with a capital letter.”</p>&#13;
&#13;
      <p>“That’s pretty cool,” said Scarlet, “but how do we get to our ALL CAPS constants and methods if they’re stuck inside a module?”</p>&#13;
&#13;
      <p>“I’m glad you asked,” Haldo said, smiling. “Let’s have a look!” He typed some more:</p><a id="pro_id00315"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">class Announcer</span></strong></span>&#13;
&gt;&gt;   <span class="strong"><strong><span class="red">include Bucket</span></strong></span>&#13;
&gt;&gt; <span class="strong"><strong><span class="red">end</span></strong></span>&#13;
=&gt; Announcer&#13;
</pre>&#13;
&#13;
      <p>“Here, I’ve made an <code class="literal">Announcer</code> class that <span class="emphasis"><em>includes</em></span> the <code class="literal">Bucket</code> module. Our <code class="literal">Bucket</code> module contains a constant, <code class="literal">MAX_BITS_AND_TRINKETS</code>, which is set to <code class="literal">100</code>, and a method, <code class="literal">announcing_bits_and_trinkets</code>, that prints some text on the screen.</p>&#13;
&#13;
      <p><a class="indexterm" id="iddle1171"/><a class="indexterm" id="iddle1308"/>When we <code class="literal">include</code> a module in a class, the constants and methods in that module can be used by any instance of the class. Because we’ve included <code class="literal">Bucket</code> in <code class="literal">Announcer</code>, an <code class="literal">Announcer</code> can now use any of the constants and methods defined in <code class="literal">Bucket</code>! Let’s create an instance of <code class="literal">Announcer</code> and see what happens when we use a method we defined in <code class="literal">Bucket</code>.”</p><a id="pro_id00316"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">loud_lucy = Announcer.new</span></strong></span>&#13;
=&gt; #&lt;Announcer:0x00000103f0c5b8&gt;&#13;
&#13;
&gt;&gt; <span class="strong"><strong><span class="red">loud_lucy.announcing_bits_and_trinkets</span></strong></span>&#13;
Step right up! Bits and trinkets available now!&#13;
=&gt; nil&#13;
</pre>&#13;
&#13;
      <p>“Wow!” said Ruben. “<code class="literal">loud_lucy</code> knows how to use the <code class="literal">announcing_bits_and_trinkets</code> method, even though it’s defined in the <code class="literal">Bucket</code> module!”</p>&#13;
    </div>&#13;
&#13;
    <div class="sect1" title="Extending Your Knowledge">&#13;
      <div class="titlepage">&#13;
        <h1 class="title" id="heading_id_6"><a id="extending_your_knowledge"/>Extending Your Knowledge</h1>&#13;
      </div>&#13;
&#13;
      <p>“Exactly!” said Haldo. “But <code class="literal">include</code> isn’t the only way to get constants and methods defined in modules into other classes. Have a look at this.” He typed some more:</p><a id="pro_id00317"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">class Announcer</span></strong></span>&#13;
&gt;&gt;   <span class="strong"><strong><span class="red">extend Bucket</span></strong></span>&#13;
&gt;&gt; <span class="strong"><strong><span class="red">end</span></strong></span>&#13;
=&gt; Announcer&#13;
&#13;
&gt;&gt; <span class="strong"><strong><span class="red">Announcer.announcing_bits_and_trinkets</span></strong></span>&#13;
Step right up! Bits and trinkets available now!&#13;
=&gt; nil&#13;
</pre>&#13;
&#13;
      <p>“If we <code class="literal">extend</code> the module <code class="literal">Bucket</code> into the class, then those constants and methods can be used by the class itself,” Haldo explained. “In this case, the class <code class="literal">Announcer</code>—instead of its instance, <code class="literal">loud_lucy</code>—can use the method. You usually end up wanting your instances to have the method rather than your classes, so in my experience, you tend to <code class="literal">include</code> more often than you <code class="literal">extend</code>.”</p>&#13;
&#13;
      <p><a class="indexterm" id="iddle1410"/><a class="indexterm" id="iddle1548"/>“Remember when I said there was a Ruby trick that lets you mix the behavior of several classes into one?” asked the Queen. “This is how you do it!”</p>&#13;
    </div>&#13;
&#13;
    <div class="sect1" title="Mixins and Inheritance">&#13;
      <div class="titlepage">&#13;
        <h1 class="title" id="heading_id_7"><a id="mixins_and_inheritance"/>Mixins and Inheritance</h1>&#13;
      </div>&#13;
&#13;
      <p>“Wait,” said Ruben. “So you can have a class that inherits from another class <span class="emphasis"><em>and</em></span> includes modules to add extra methods?”</p>&#13;
&#13;
      <p>“See for yourself!” replied Haldo, and he typed:</p><a id="pro_id00318"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">module Enchanted</span></strong></span>&#13;
&gt;&gt;   <span class="strong"><strong><span class="red">def speak</span></strong></span>&#13;
&gt;&gt;     <span class="strong"><strong><span class="red">puts 'Hello there!'</span></strong></span>&#13;
&gt;&gt;   <span class="strong"><strong><span class="red">end</span></strong></span>&#13;
&gt;&gt; <span class="strong"><strong><span class="red">end</span></strong></span>&#13;
=&gt; nil&#13;
</pre>&#13;
&#13;
      <p>“First, I’ve just created an <code class="literal">Enchanted</code> module with a single <code class="literal">speak</code> method.”</p><a id="pro_id00319"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">class Animal</span></strong></span>&#13;
&gt;&gt;   <span class="strong"><strong><span class="red">def initialize(name)</span></strong></span>&#13;
&gt;&gt;     <span class="strong"><strong><span class="red">@name = name</span></strong></span>&#13;
&gt;&gt;   <span class="strong"><strong><span class="red">end</span></strong></span>&#13;
&gt;&gt; <span class="strong"><strong><span class="red">end</span></strong></span>&#13;
=&gt; nil&#13;
</pre>&#13;
&#13;
      <p>“Next, I’ve created an <code class="literal">Animal</code> class that takes care of setting the names of the <code class="literal">Animal</code> instances we create.”</p><a id="pro_id00320"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">class Dog &lt; Animal</span></strong></span>&#13;
&gt;&gt;   <span class="strong"><strong><span class="red">include Enchanted</span></strong></span>&#13;
&#13;
&gt;&gt;   <span class="strong"><strong><span class="red">def bark</span></strong></span>&#13;
&gt;&gt;     <span class="strong"><strong><span class="red">puts 'Arf!'</span></strong></span>&#13;
&gt;&gt;   <span class="strong"><strong><span class="red">end</span></strong></span>&#13;
&gt;&gt; <span class="strong"><strong><span class="red">end</span></strong></span>&#13;
=&gt; nil&#13;
</pre>&#13;
&#13;
      <p>“In the next step, I’ve created a <code class="literal">Dog</code> class that inherits from <code class="literal">Animal</code> and includes <code class="literal">Enchanted</code>. If we’ve done everything right, our <code class="literal">Dog</code> instances should be able to use the <code class="literal">Dog bark</code> method <span class="emphasis"><em>and</em></span> the <code class="literal">Enchanted speak</code> method. Let’s try it now!”</p><a id="pro_id00321"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">bigelow = Dog.new('Bigelow')</span></strong></span>&#13;
=&gt; #&lt;Dog:0x000001049df148 @name="Bigelow"&gt;&#13;
&#13;
&gt;&gt; <span class="strong"><strong><span class="red">bigelow.bark</span></strong></span>&#13;
Arf!&#13;
=&gt; nil&#13;
&#13;
&gt;&gt; <span class="strong"><strong><span class="red">bigelow.speak</span></strong></span>&#13;
Hello there!&#13;
=&gt; nil&#13;
</pre>&#13;
&#13;
      <p>“When we use a module this way, we call it a <span class="emphasis"><em>mixin</em></span>,” Haldo said, “because you’re mixing new constants and methods into an existing class. Basically, <code class="literal">Dog</code> now gets the powers of <code class="literal">Animal</code> and <code class="literal">Enchanted</code>, even though it only directly inherits from <code class="literal">Animal</code>. We can <code class="literal">include</code> as many classes as we like! Assuming we defined all these modules somewhere, we could use them all in a row:</p><a id="pro_id00322"/>&#13;
      <pre class="programlisting">&#13;
class Dog&#13;
  include Enchanted&#13;
  include Magical&#13;
  include AnythingWeLike&#13;
  # ...and so on and so forth&#13;
end&#13;
</pre>&#13;
&#13;
      <p>“So if you had a <code class="literal">Dog</code> class and the modules <code class="literal">Enchanted</code>, <code class="literal">Magical</code>, and <code class="literal">AnythingWeLike</code>,” said the King, “if you were to make a dog with the <code class="literal">Dog</code> class, that dog could use any of the methods defined in <code class="literal">Enchanted</code>, <code class="literal">Magical</code>, or <code class="literal">AnythingWeLike</code>.”</p>&#13;
&#13;
      <p>“Exactly,” Haldo said. “We could also <code class="literal">extend</code> our class with as many modules as we wanted.” He continued typing:</p><a id="pro_id00323"/>&#13;
      <pre class="programlisting">&#13;
class Dog&#13;
  extend Enchanted&#13;
  extend Magical&#13;
  extend AnythingWeLike&#13;
  # ...and so on and so forth&#13;
end&#13;
</pre>&#13;
&#13;
      <p><a class="indexterm" id="iddle1648"/>“That’s amazing!” said Scarlet.</p>&#13;
&#13;
      <p>“But hang on just a second,” Ruben said. “That means that somewhere on the Computing Contraption, there’s a file for the panda food that <code class="literal">include</code>s the <code class="literal">Colorize</code> module?”</p>&#13;
    </div>&#13;
&#13;
    <div class="sect1" title="Requiring Another File">&#13;
      <div class="titlepage">&#13;
        <h1 class="title" id="heading_id_8"><a id="requiring_another_file"/>Requiring Another File</h1>&#13;
      </div>&#13;
&#13;
      <p>“Absolutely correct,” said Haldo. “It happens to be called <span class="emphasis"><em>panda_food.rb</em></span>. Take a look!” And he opened the file for them all to see. “This is the code that controls the pandas’ food.”</p>&#13;
&#13;
      <div class="note" title="Note">&#13;
        <h3 class="title" id="heading_id_9"><a id="ch10note01"/>Note</h3>&#13;
&#13;
        <p><span class="emphasis"><em>The next few examples are just for you to follow along and read for now—running this code as is will cause an error! We’ll run this example ourselves later in the chapter.</em></span></p>&#13;
      </div><a id="pro_id00324"/>&#13;
      <pre class="programlisting">&#13;
<span class="ash">require './colorize'</span>&#13;
&#13;
<span class="ash">class PandaFood &lt; Food</span>&#13;
  <span class="ash">include Colorize</span>&#13;
&#13;
  <span class="ash">attr_reader :calories</span>&#13;
&#13;
  <span class="ash">CALORIES_PER_SERVING = 1000</span>&#13;
&#13;
  <span class="ash">def initialize</span>&#13;
    <span class="ash">@calories = CALORIES_PER_SERVING</span>&#13;
  <span class="ash">end</span>&#13;
<span class="ash">end</span>&#13;
</pre>&#13;
&#13;
      <p>“Here’s how it works,” Haldo said. “Let’s pick one of the pandas—Hogarth’s my favorite—and see if we can figure out what’s going on with his food.” He opened up IRB and typed:</p><a id="pro_id00325"/>&#13;
      <pre class="programlisting">&#13;
<span class="ash">&gt;&gt; <span class="strong"><strong>hogarths_food = PandaFood.new</strong></span></span>&#13;
<span class="ash">=&gt; #&lt;PandaFood:0x00000104480850 @calories=1000&gt;</span>&#13;
&#13;
<span class="ash">&gt;&gt; <span class="strong"><strong>hogarths_food.calories</strong></span></span>&#13;
<span class="ash">=&gt; 1000</span>&#13;
</pre>&#13;
&#13;
      <p><a class="indexterm" id="iddle1331"/><a class="indexterm" id="iddle1720"/>“<code class="literal">attr_accessor</code> gives us access to the <code class="literal">@calories</code> instance variable, which is <code class="literal">1000</code>,” Haldo explained. “Now let’s take a look at the color!”</p><a id="pro_id00326"/>&#13;
      <pre class="programlisting">&#13;
<span class="ash">&gt;&gt; <span class="strong"><strong>hogarths_food.color</strong></span></span>&#13;
<span class="ash">=&gt; :yellow</span>&#13;
</pre>&#13;
&#13;
      <p>“Hmm,” said Haldo. “Can that be right? Let’s try it again.”</p><a id="pro_id00327"/>&#13;
      <pre class="programlisting">&#13;
<span class="ash">&gt;&gt; <span class="strong"><strong>hogarths_food.color</strong></span></span>&#13;
<span class="ash">=&gt; :blue</span>&#13;
</pre>&#13;
&#13;
      <p>“There you have it!” Haldo said. “You see? That’s our trouble. Other Ruby programs running in the Panda Provisionator 3000 check the color of the panda food when they give instructions to the machine to make it, and they’re getting colors like yellow and blue, but not purple!”</p>&#13;
&#13;
      <p>“Then the pandas ate the food and changed color!” said Ruben. “Wow, that must happen pretty quickly.”</p>&#13;
&#13;
      <p>Haldo nodded. “The pandas were just fed. It actually takes a while for them to change from white to any other color, but once they’ve taken on a color, eating different-colored food will make their color change instantly.”</p>&#13;
&#13;
      <p>“So switching them back should be a piece of cake!” said Scarlet. “We just need to change the color back to purple.” She studied the screen for a minute. “Hey Haldo,” she said, “what’s this <code class="literal">require</code> bit do?”</p>&#13;
&#13;
      <p>“I’m glad you caught that,” said Haldo. “The <code class="literal">require</code> method pulls in Ruby code from a file <span class="emphasis"><em>outside</em></span> the file you’re currently working in! So you don’t need it for IRB when you’re just messing around, but if you’ve written out a Ruby file, you can use <code class="literal">require</code> to pull in code from a separate file. You don’t even need to type the <span class="emphasis"><em>.rb</em></span> file extension; you just type <code class="literal">require</code>, then the name of your file as a string, and you can use that code immediately.”</p>&#13;
&#13;
      <p><a class="indexterm" id="iddle1027"/><a class="indexterm" id="iddle1325"/><a class="indexterm" id="iddle1345"/>He created a file called <span class="emphasis"><em>test_colors.rb</em></span> and began typing:</p><a id="pro_id00328"/>&#13;
      <pre class="programlisting">&#13;
➊ <span class="ash">require './colorize'</span>&#13;
➋ <span class="ash">class TestColors</span>&#13;
➌   <span class="ash">include Colorize</span>&#13;
  <span class="ash">end</span>&#13;
&#13;
  <span class="ash">test = TestColors.new</span>&#13;
➍ <span class="ash">puts test.color</span>&#13;
</pre>&#13;
&#13;
      <p>Haldo closed the file. When he ran it with <code class="literal">ruby test_colors.rb</code>, this is what they saw:</p><a id="pro_id00329"/>&#13;
      <pre class="programlisting">&#13;
<span class="ash">$ <span class="strong"><strong>ruby test_color.rb</strong></span></span>&#13;
<span class="ash">blue</span>&#13;
<span class="ash">$ <span class="strong"><strong>ruby test_color.rb</strong></span></span>&#13;
<span class="ash">yellow</span>&#13;
</pre>&#13;
&#13;
      <p>“See?” Haldo said. “We can create our own file called <span class="emphasis"><em>test_colors.rb</em></span>, then <code class="literal">require</code> the <span class="emphasis"><em>colorize.rb</em></span> file inside it ➊. Once we do that, we can create our own <code class="literal">TestColors</code> class ➋, <code class="literal">include</code> the <code class="literal">Colorize</code> module from the <span class="emphasis"><em>colorize.rb</em></span> file we saw earlier ➌, and then use the <code class="literal">color</code> method ➍!”</p>&#13;
&#13;
      <p>“Nice!” said Ruben. “But why do we need the <code class="literal">./</code> in front of <code class="literal">colorize</code>?”</p>&#13;
&#13;
      <p>“That’s a little complicated,” said Haldo, “but the short answer is that when you want to <code class="literal">require</code> a Ruby file, you need to tell Ruby where to look for it. <code class="literal">./</code> says, ‘Look in this folder right here!’ If we needed to require something from a folder <span class="emphasis"><em>outside</em></span> the one we’re in, we’d use <span class="emphasis"><em>two</em></span> dots to tell Ruby to go up one folder. This can be confusing,” Haldo finished, “so I drew a couple of pictures to help myself remember. I think I still have them!” He rummaged around in his pocket for a moment, then pulled out a piece of paper, unfolded it, and showed it to the King, the Queen, Scarlet, and Ruben.</p>&#13;
&#13;
      <div class="informalfigure">&#13;
        <a id="med_id00051a"/>&#13;
&#13;
        <div class="mediaobject"><a id="med_id00051"/><img alt="image with no caption" src="../Images/httpatomoreillycomsourcenostarchimages2160055.png.jpg"/></div>&#13;
      </div>&#13;
&#13;
      <p><a class="indexterm" id="iddle1182"/><a class="indexterm" id="iddle1249"/><a class="indexterm" id="iddle1353"/><a class="indexterm" id="iddle1439"/>“I get it!” said Scarlet. “One dot and a slash means ‘look in the current folder,’ two dots and a slash means ‘go up one folder and look there,’ and anytime we need to go into folders within folders, we just use folder names separated by slashes.”</p>&#13;
&#13;
      <p>“Exactly right,” said Haldo.</p>&#13;
&#13;
      <p>“But is there ever a time when you <span class="emphasis"><em>don’t</em></span> need to use dots or slashes?” she asked.</p>&#13;
&#13;
      <p>“That’s also a bit complicated,” said Haldo, “but the short answer is yes. I can show you sometime, but there’s a way to use the Internet to download collections of Ruby files other people have written, called <span class="emphasis"><em>gems</em></span>, to use in your own code!”</p>&#13;
&#13;
      <p>“That sounds amazing!” said Scarlet.</p>&#13;
&#13;
      <p>“It is!” said Haldo. “When we get to the bottom of this mystery, I’ll be glad to show you.”</p>&#13;
&#13;
      <p>“I think I’ve got a handle on all this,” interrupted the King, “but I’ve been wondering about constants since you brought them up. Is including a module in a class the only way to get to its constants?”</p>&#13;
    </div>&#13;
&#13;
    <div class="sect1" title="Looking Up Constants">&#13;
      <div class="titlepage">&#13;
        <h1 class="title" id="heading_id_10"><a id="looking_up_constants"/>Looking Up Constants</h1>&#13;
      </div>&#13;
&#13;
      <p><a class="indexterm" id="iddle1016"/><a class="indexterm" id="iddle1197"/><a class="indexterm" id="iddle1216"/><a class="indexterm" id="iddle1288"/><a class="indexterm" id="iddle1567"/><a class="indexterm" id="iddle1582"/><a class="indexterm" id="iddle1778"/>“Not at all!” said Haldo. “Take a look.” He quickly typed into the Computing Contraption:</p><a id="pro_id00330"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">module APocketFullofMethods</span></strong></span>&#13;
&gt;&gt;   <span class="strong"><strong><span class="red">NUMBER_OF_METHODS = 42</span></strong></span>&#13;
&gt;&gt; <span class="strong"><strong><span class="red">end</span></strong></span>&#13;
=&gt; nil&#13;
&#13;
&gt;&gt; <span class="strong"><strong><span class="red">NUMBER_OF_METHODS</span></strong></span>&#13;
NameError: uninitialized constant NUMBER_OF_METHODS&#13;
&#13;
&gt;&gt; <span class="strong"><strong><span class="red">APocketFullofMethods::NUMBER_OF_METHODS</span></strong></span>&#13;
=&gt; 42&#13;
</pre>&#13;
&#13;
      <div class="note" title="Note">&#13;
        <h3 class="title" id="heading_id_11"><a id="ch10note02"/>Note</h3>&#13;
&#13;
        <p><span class="emphasis"><em>These examples will work if you try them out, so go ahead!</em></span></p>&#13;
      </div>&#13;
&#13;
      <p>“Here, I’ve defined a module called <code class="literal">APocketFullofMethods</code>,” Haldo said. “Inside it, I’ve put a constant, <code class="literal">NUMBER_OF_METHODS</code>, which equals 42. You see that if I try to get to <code class="literal">NUMBER_OF_METHODS</code> from outside the module, I get a <code class="literal">NameError</code>, but if I type <code class="literal">APocketFullofMethods::NUMBER_OF_METHODS</code>, I get <code class="literal">42</code>!”</p>&#13;
&#13;
      <p>“Wonderful!” said the King.</p>&#13;
&#13;
      <p>“But what are those two colons in a row for?” asked Scarlet.</p>&#13;
&#13;
      <p>“Ah, I’ve seen this before,” said the Queen. “That’s the <span class="emphasis"><em>scope resolution operator</em></span>, right, Haldo?”</p>&#13;
&#13;
      <p>“Oh, yes,” said Haldo, “but I find that name a bit confusing. Really, you can think of it as a way of looking things up: the four dots look like two little sets of eyes. It’s how we specify which module to look in to find something we’ve created.”</p>&#13;
&#13;
      <p>“That’s cool!” said Ruben.</p>&#13;
&#13;
      <p>“Isn’t it?” said Haldo, “Ruby modules are mostly good for two things. The first, as I showed you, is mixing new behavior into a Ruby class. The second is called <span class="emphasis"><em>namespacing</em></span>. You can think of it as making individual spaces for the things you name—mostly methods and constants—to live in.” He pushed his sunglasses up on his nose. “You see, if you define a method with a certain name, and then define it again, Ruby replaces the old version of <a class="indexterm" id="iddle1554"/><a class="indexterm" id="iddle1776"/>the method with the new one. But if you put a method inside a module with the same name as a method or constant outside the module, you can use them both!”</p>&#13;
&#13;
      <p>“Modules must create a new scope!” said Ruben. “So having two methods with the same name and putting one in a module is like having two identical sodas, only one’s in the fridge and the other’s not. With methods, one’s in the module (the fridge) and one isn’t, so you know which one’s which based on where it is.”</p>&#13;
&#13;
      <p>“Exactly,” said Haldo.</p>&#13;
&#13;
      <p>“And everything we just said about methods works for constants, too, right?” asked Scarlet.</p>&#13;
&#13;
      <p>“It does!” answered Haldo.</p>&#13;
&#13;
      <p>“What happens if you put one module inside another?” asked Ruben.</p>&#13;
&#13;
      <p>“You just need to keep using those <code class="literal">::</code> dots,” said Haldo. “For instance, if you had a module <code class="literal">Pastel</code> inside the <code class="literal">Colorize</code> module and you wanted to get to the <code class="literal">NUMBER_OF_PASTEL_COLORS</code> constant inside the <code class="literal">Pastel</code> module, you’d type <code class="literal">Colorize::Pastel::NUMBER_OF_PASTEL_COLORS</code>.”</p>&#13;
&#13;
      <p>“If things inside a module are namespaced, like you said,” Scarlet asked, “does that mean you can have two things with the same name, only one’s inside the module and one’s outside?”</p>&#13;
&#13;
      <p>“Absolutely!” Haldo said. He typed:</p><a id="pro_id00331"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">module Namespace</span></strong></span>&#13;
&gt;&gt;   <span class="strong"><strong><span class="red">GREETING = 'Hello from INSIDE the module!'</span></strong></span>&#13;
&gt;&gt; <span class="strong"><strong><span class="red">end</span></strong></span>&#13;
=&gt; nil&#13;
&#13;
&gt;&gt; <span class="strong"><strong><span class="red">GREETING = 'Hello from OUTSIDE the module!'</span></strong></span>&#13;
=&gt; "Hello from OUTSIDE the module!"&#13;
</pre>&#13;
&#13;
      <p>“Here, I’ve defined two constants with the same name: <code class="literal">GREETING</code>. The first one is inside the <code class="literal">Namespace</code> module, and the other is in the main scope, outside any module. Here’s how we tell Ruby which one to get.” He typed some more:</p><a id="pro_id00332"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">GREETING</span></strong></span>&#13;
=&gt; "Hello from OUTSIDE the module!"&#13;
&gt;&gt; <span class="strong"><strong><span class="red">Namespace::GREETING</span></strong></span>&#13;
=&gt; "Hello from INSIDE the module!"&#13;
</pre>&#13;
&#13;
      <p><a class="indexterm" id="iddle1186"/><a class="indexterm" id="iddle1796"/>“I get it!” said Ruben. “The two colons tell Ruby which scope to use!” He thought for a moment. “Can we do all of this for class methods, too? I mean, if a module can contain methods created with <code class="literal">def</code>, can’t it have methods that get added to the including class with <code class="literal">self.def</code>?”</p>&#13;
&#13;
      <p>Haldo nodded. “You <span class="emphasis"><em>can</em></span> use the scope resolution operator to get class methods as well as constants, but in Ruby, we usually get class methods using the dot, and constants using the two colons. Since the method is a class method,” he continued, “it’s just like calling a method on a regular old object. Remember, classes are objects! Here’s an example—we haven’t defined any of these methods, so the code won’t run, but it would look something like this:</p><a id="pro_id00333"/>&#13;
      <pre class="programlisting">&#13;
<span class="ash">MyClass.fancy_class_method</span>&#13;
<span class="ash">MyClass::CLASS_CONSTANT</span>&#13;
</pre>&#13;
&#13;
      <p>“Whew!” said the King, sitting down on a bale of hay. “I think I’ve got all this—surprisingly.” Scarlet and Ruben grinned at each other.</p>&#13;
&#13;
      <p>“What I <span class="emphasis"><em>don’t</em></span> understand,” the King continued, “is how these scoundrels broke the <code class="literal">Colorize</code> module so quickly. They were only in the stables for a few seconds! How fast do they type?”</p>&#13;
&#13;
      <p>“I think I might have just found the answer,” said the Queen, who had been inspecting the Panda Provisionator 3000. She reached around to the side of the machine and pulled out a small bit of scuffed metal.</p>&#13;
&#13;
      <p>“What’s that?” asked Haldo.</p>&#13;
&#13;
      <p>“This,” said the Queen, “is a Key-a-ma-Jigger. It’s a little device you can preload code onto. Our mischief-makers must have known something about how the Provisionator works and preloaded some code onto this little machine to break it. They just had to plug it in and run!”</p>&#13;
&#13;
      <p>“Sweet corn muffins!” said the King. “We’re up against professionals.”</p>&#13;
&#13;
      <p>“I’ll say,” said Ruben, frowning. “How are we going to catch them? They’ve got to be a mile away by now.”</p>&#13;
&#13;
      <p>The Queen had been studying the Key-a-ma-Jigger, and her mouth curled into a small smile. “I think I know that, too,” she <a class="indexterm" id="iddle1200"/>said. “Have a look! Key-a-ma-Jiggers are sold on little rings of five, and this one still has the ring on it. That means this was probably their last one!” She closed her fist around the tiny machine. “My guess is that they need more, and there’s only one place in the whole kingdom that makes Key-a-ma-Jiggers.”</p>&#13;
&#13;
      <p>“Where?” asked Scarlet, Ruben, and Haldo at the same time.</p>&#13;
&#13;
      <p>“Yes, dear, <span class="emphasis"><em>where</em></span>?” asked the King.</p>&#13;
&#13;
      <p>“The Refactory!” replied the Queen.</p>&#13;
&#13;
      <p>“The Refactory!” said Haldo. “That’s in the center of the kingdom. The Loop can take you there in just a few minutes!”</p>&#13;
&#13;
      <p>“Let’s go!” said the King. “We’ll take the express straight to the center of the kingdom. Let’s catch these poisonous perpetrators purple-handed!”</p>&#13;
&#13;
      <p>“To the Loop!” said the Queen. She turned to Haldo. “Haldo, do you mind staying behind and fixing the Provisionator?”</p>&#13;
&#13;
      <p>“Not at all, Your Highness,” he said. “It shouldn’t take long.”</p>&#13;
&#13;
      <p>“Thank you,” said the Queen. She turned to the others and said, “Quickly, now!” And with that, they ran out of the stables toward the Loop platform on the hill next to the palace.</p>&#13;
    </div>&#13;
&#13;
    <div class="sect1" title="A Horse of a Different Color">&#13;
      <div class="titlepage">&#13;
        <h1 class="title" id="heading_id_12"><a id="horse_of_a_different_color-id00009"/>A Horse of a Different Color</h1>&#13;
      </div>&#13;
&#13;
      <p>Now that you know how modules work, you can help Haldo fix up the Panda Provisionator and get all the pandas back to the right color! With any luck, you’ll have them all fixed up in time for the Purple Panda-monium Parade.</p>&#13;
&#13;
      <p>Let’s begin by making a new file called <span class="bolditalic red">colorize.rb</span> and typing the following code. We’ll actually be making <span class="emphasis"><em>two</em></span> files this time around: one for the module and one for the class that includes it.</p>&#13;
&#13;
      <p><span class="bolditalic red">colorize.rb</span></p><a id="pro_id00334"/>&#13;
      <pre class="programlisting">&#13;
module Colorize&#13;
  def color&#13;
    :purple&#13;
  end&#13;
end&#13;
</pre>&#13;
&#13;
      <p><a class="indexterm" id="iddle1074"/><a class="indexterm" id="iddle1649"/>First, we set up the <code class="literal">Colorize</code> module and created a very simple <code class="literal">color</code> method that just returns the color we want (<code class="literal">:purple</code>).</p>&#13;
&#13;
      <p>In another file <span class="emphasis"><em>in the same folder</em></span> on your computer, create the <span class="bolditalic red">panda_food.rb</span> file and type the following code into it. It might be a little weird writing two files instead of just one, but there’s nothing here you don’t already know how to do!</p>&#13;
&#13;
      <p><span class="bolditalic red">panda_food.rb</span></p><a id="pro_id00335"/>&#13;
      <pre class="programlisting">&#13;
➊ require './colorize'&#13;
&#13;
➋ class Food&#13;
    def serve&#13;
      puts 'Food is ready!'&#13;
    end&#13;
  end&#13;
&#13;
➌ class PandaFood &lt; Food&#13;
➍   include Colorize&#13;
&#13;
    attr_accessor :calories&#13;
&#13;
➎   CALORIES_PER_SERVING = 1000&#13;
&#13;
    def initialize&#13;
      @calories = CALORIES_PER_SERVING&#13;
    end&#13;
&#13;
    def serve&#13;
      puts 'One piping hot serving of panda food, coming up!'&#13;
    end&#13;
&#13;
➏   def analyze&#13;
      puts "This food contains #{@calories} calories and is #{color}."&#13;
    end&#13;
  end&#13;
&#13;
➐ hogarths_food = PandaFood.new&#13;
  puts hogarths_food.analyze&#13;
</pre>&#13;
&#13;
      <p>First, we <code class="literal">require</code> <span class="emphasis"><em>colorize.rb</em></span> in our <span class="emphasis"><em>panda_food.rb</em></span> file at ➊. Next, we define a very simple <code class="literal">Food</code> ➋ class that our <code class="literal">PandaFood</code> class inherits from ➌, and we include the <code class="literal">Colorize</code> module in our <code class="literal">PandaFood</code> class at ➍. We round it all out with a constant to tell us how many calories are in each serving ➎ and an <code class="literal">analyze</code> method to tell us about the food’s calorie content and color ➏. (You can’t be too careful when it comes to your food!) Finally, we create an instance of <code class="literal">PandaFood</code> and call the <code class="literal">analyze</code> method on it ➐.</p>&#13;
&#13;
      <p>As always, try running the code in your file by typing <span class="strong"><strong><span class="red"><code class="literal">ruby panda_food.rb</code></span></strong></span> from the command line. Make sure you’re in the same folder as your <span class="emphasis"><em>panda_food.rb</em></span> file and type:</p><a id="pro_id00336"/>&#13;
      <pre class="programlisting">&#13;
$ <span class="strong"><strong><span class="red">ruby panda_food.rb</span></strong></span>&#13;
</pre>&#13;
&#13;
      <p>You should see this:</p><a id="pro_id00337"/>&#13;
      <pre class="programlisting">&#13;
This food contains 1000 calories and is purple.&#13;
</pre>&#13;
&#13;
      <p>Purple panda food! Our pandas are saved!</p>&#13;
&#13;
      <p>This should work for Haldo’s purposes nicely, but you can make this code even better with a little elbow grease (which you can purchase directly from the Refactory for the low, low price of nine ninety-nine ninety-nine ninety-nine ninety-five). For example, our <code class="literal">Colorize</code> module has only one method, and all it does is return the color purple. How might we change the <code class="literal">color</code> method to set whatever color we wanted? What other methods might we want to add to <code class="literal">Colorize</code>?</p>&#13;
&#13;
      <p>We also don’t do a whole lot with our <code class="literal">Food</code> class—<code class="literal">PandaFood</code> overrides the only method <code class="literal">Food</code> has! What else could we add to <code class="literal">Food</code> to make it even better? (Hint: The possibilities are endless!)</p>&#13;
&#13;
      <p>Finally, remember the code Haldo saw in <a class="xref" href="../Text/ch10.html#creating_modules" title="Creating Modules">Creating Modules</a> that had been tampered with? It looked like this:</p><a id="pro_id00338"/>&#13;
      <pre class="programlisting">&#13;
module Colorize&#13;
  def color&#13;
    [:red, :blue, :green, :yellow].sample&#13;
  end&#13;
end&#13;
</pre>&#13;
&#13;
      <p><a class="indexterm" id="iddle1215"/><a class="indexterm" id="iddle1309"/><a class="indexterm" id="iddle1401"/><a class="indexterm" id="iddle1549"/><a class="indexterm" id="iddle1550"/><a class="indexterm" id="iddle1581"/>If you’re feeling adventurous, try changing the code in your <span class="emphasis"><em>colorize.rb</em></span> file to this code and then rerun <span class="strong"><strong><span class="red"><code class="literal">ruby panda_food.rb</code></span></strong></span>. See how the color changes each time, just like our heroes saw?</p>&#13;
    </div>&#13;
&#13;
    <div class="sect1" title="You Know This!">&#13;
      <div class="titlepage">&#13;
        <h1 class="title" id="heading_id_13"><a id="you_know_thisexclamation_mark-id00010"/>You Know This!</h1>&#13;
      </div>&#13;
&#13;
      <p>I can tell you’ve got a great grasp on all this module business. (I’m an excellent judge of many a character.) Let’s go over it one more time, though, just to make sure <span class="emphasis"><em>I</em></span> know it. Haldo did a lot of explaining and I didn’t do any, so I want to be sure this is all sealed up tight in my noggin.</p>&#13;
&#13;
      <p>First, we learned about modules and how they’re basically just like classes, except you can’t create instances of them with the <code class="literal">new</code> method. We saw that we could use modules as <span class="emphasis"><em>namespaces</em></span>, which is just a fancy way of saying they let us organize our code nicely, like so:</p><a id="pro_id00339"/>&#13;
      <pre class="programlisting">&#13;
module Bucket&#13;
  MAX_BITS_AND_TRINKETS = 100&#13;
&#13;
  def announcing_bits_and_trinkets&#13;
    puts 'Step right up! Bits and trinkets available now!'&#13;
  end&#13;
end&#13;
</pre>&#13;
&#13;
      <p>We also learned about <span class="emphasis"><em>constants</em></span> (like <code class="literal">MAX_BITS_AND_TRINKETS</code>), which are just like Ruby variables, only their values aren’t supposed to change. (You <span class="emphasis"><em>can</em></span> change them, but Ruby will issue a stern warning.) Constants are always CAPITALIZED.</p>&#13;
&#13;
      <p>We saw that we could also use modules as <span class="emphasis"><em>mixins</em></span> by using <code class="literal">include</code> or <code class="literal">extend</code>. When we use <code class="literal">include</code>, it adds all the methods in the module to instances of whatever class is doing the including; when we use <code class="literal">extend</code>, those module methods are added to the class itself:</p><a id="pro_id00340"/>&#13;
      <pre class="programlisting">&#13;
module Greetings&#13;
  def sailor&#13;
    puts 'Ahoy there!'&#13;
  end&#13;
  def pirate&#13;
    puts 'Avast, ye salty dog!'&#13;
  end&#13;
&#13;
  def robot&#13;
    puts 'BEEP BOOP WHAT IS UP'&#13;
  end&#13;
end&#13;
</pre>&#13;
&#13;
      <p><a class="indexterm" id="iddle1294"/><a class="indexterm" id="iddle1364"/><a class="indexterm" id="iddle1517"/><a class="indexterm" id="iddle1518"/><a class="indexterm" id="iddle1609"/>There, we’ve just created a <code class="literal">Greetings</code> module with a few methods. Next, we’ll create a <code class="literal">Message</code> class and include the <code class="literal">Greetings</code> module:</p><a id="pro_id00341"/>&#13;
      <pre class="programlisting">&#13;
class Message&#13;
  include Greetings&#13;
end&#13;
</pre>&#13;
&#13;
      <p>Then we’ll see that any instance of <code class="literal">Message</code> can use the methods defined in <code class="literal">Greetings</code>!</p><a id="pro_id00342"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">message = Message.new</span></strong></span>&#13;
=&gt; #&lt;Message:0x007fd6022c7948&gt;&#13;
&#13;
&gt;&gt; <span class="strong"><strong><span class="red">message.pirate</span></strong></span>&#13;
Avast, ye salty dog!&#13;
=&gt; nil&#13;
</pre>&#13;
&#13;
      <p>If we <code class="literal">extend Message</code> with <code class="literal">Greetings</code> instead, then the <code class="literal">Greetings</code> methods can be used by the <code class="literal">Message</code> class itself:</p><a id="pro_id00343"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">class Message</span></strong></span>&#13;
&gt;&gt;   <span class="strong"><strong><span class="red">extend Greetings</span></strong></span>&#13;
&gt;&gt; <span class="strong"><strong><span class="red">end</span></strong></span>&#13;
=&gt; nil&#13;
&#13;
&gt;&gt; <span class="strong"><strong><span class="red">Message.robot</span></strong></span>&#13;
BEEP BOOP WHAT IS UP&#13;
=&gt; nil&#13;
</pre>&#13;
&#13;
      <p><a class="indexterm" id="iddle1857"/>Remember, it’s the <code class="literal">Message</code> class <span class="emphasis"><em>itself</em></span> that now has the <code class="literal">robot</code> method, not an instance of <code class="literal">Message</code>! If we try to create an instance of <code class="literal">Message</code> and call the <code class="literal">robot</code> method on it, we’ll get an error:</p><a id="pro_id00344"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">my_message = Message.new</span></strong></span>&#13;
=&gt; #&lt;Message:0x000001030cdf88&gt;&#13;
&gt;&gt; <span class="strong"><strong><span class="red">my_message.robot</span></strong></span>&#13;
NoMethodError: undefined method `robot' for&#13;
#&lt;Message:0x000001030cdf88&gt;&#13;
</pre>&#13;
&#13;
      <p>But if a class <span class="emphasis"><em>includes</em></span> <code class="literal">Greetings</code>, then instances of that class have the method instead:</p><a id="pro_id00345"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">class Message</span></strong></span>&#13;
&gt;&gt;   <span class="strong"><strong><span class="red">include Greetings</span></strong></span>&#13;
&gt;&gt; <span class="strong"><strong><span class="red">end</span></strong></span>&#13;
&#13;
&gt;&gt; <span class="strong"><strong><span class="red">my_message = Message.new</span></strong></span>&#13;
=&gt; #&lt;Message:0x00000103108d18&gt;&#13;
&gt;&gt; <span class="strong"><strong><span class="red">my_message.robot</span></strong></span>&#13;
BEEP BOOP WHAT IS UP&#13;
=&gt; nil&#13;
</pre>&#13;
&#13;
      <p>By including modules into classes that already inherit from other classes, we can get all the benefits of inheriting from multiple classes with the simplicity of having just one superclass:</p><a id="pro_id00346"/>&#13;
      <pre class="programlisting">&#13;
module Enchanted&#13;
  def speak&#13;
    puts 'Hello there!'&#13;
  end&#13;
end&#13;
</pre>&#13;
&#13;
      <p>There, we’ve got our <code class="literal">Enchanted</code> module again with its tried-and-true <code class="literal">speak</code> method.</p><a id="pro_id00347"/>&#13;
      <pre class="programlisting">&#13;
class Animal&#13;
  def initialize(name)&#13;
    @name = name&#13;
  end&#13;
end&#13;
class Dog &lt; Animal&#13;
  include Enchanted&#13;
&#13;
  def bark&#13;
    puts 'Arf!'&#13;
  end&#13;
end&#13;
</pre>&#13;
&#13;
      <p><a class="indexterm" id="iddle1028"/><a class="indexterm" id="iddle1170"/><a class="indexterm" id="iddle1553"/><a class="indexterm" id="iddle1722"/>We’ve seen this before: we just define an <code class="literal">Animal</code> class and a <code class="literal">Dog</code> class that inherits from it. <code class="literal">Dog</code> has one method: <code class="literal">bark</code>.</p><a id="pro_id00348"/>&#13;
      <pre class="programlisting">&#13;
&gt;&gt; <span class="strong"><strong><span class="red">bigelow = Dog.new('Bigelow')</span></strong></span>&#13;
=&gt; #&lt;Dog:0x000001049df148 @name="Bigelow"&gt;&#13;
&#13;
&gt;&gt; <span class="strong"><strong><span class="red">bigelow.bark</span></strong></span>&#13;
Arf!&#13;
=&gt; nil&#13;
&#13;
&gt;&gt; <span class="strong"><strong><span class="red">bigelow.speak</span></strong></span>&#13;
Hello there!&#13;
=&gt; nil&#13;
</pre>&#13;
&#13;
      <p>Finally, we see that <code class="literal">Dog</code> instances like <code class="literal">bigelow</code> can use <code class="literal">bark</code> (which it got from <code class="literal">Dog</code>) and <code class="literal">speak</code> (which it got from <code class="literal">Enchanted</code>)!</p>&#13;
&#13;
      <p>This is all fine and dandy when our modules and classes are in the same file, but what happens when they’re not? That’s right: we can use <code class="literal">require</code>! To pull a file we wrote into another file, we just use the <code class="literal">require</code> method and give it a string with the name of the file we want (no <span class="emphasis"><em>.rb</em></span> file extension necessary). Remember, we need to use dots and slashes to tell Ruby where to look: <code class="literal">./</code> means “look in the current folder” and <code class="literal">../</code> means “go outside the current folder and look around.” If we want to go <span class="emphasis"><em>two</em></span> folders up, we’d use <code class="literal">../../</code>; if we wanted to get at a file called <span class="emphasis"><em>genius_idea_3.rb</em></span> in the current folder but nested inside the folders <span class="emphasis"><em>fancy_things</em></span> and <span class="emphasis"><em>genius_ideas</em></span>, we’d type <code class="literal">./fancy_things/genius_ideas/genius_idea_3</code>.</p>&#13;
&#13;
      <p><a class="indexterm" id="iddle1017"/><a class="indexterm" id="iddle1187"/><a class="indexterm" id="iddle1198"/><a class="indexterm" id="iddle1779"/>So for example, if we had <span class="emphasis"><em>colorize.rb</em></span> in the same folder as the following Ruby script, we’d write it like this:</p><a id="pro_id00349"/>&#13;
      <pre class="programlisting">&#13;
require './colorize'&#13;
class Food &lt; PandaFood&#13;
  include Colorize&#13;
   # ...and so on and so forth&#13;
end&#13;
</pre>&#13;
&#13;
      <p>Finally, you saw that we could use the <span class="emphasis"><em>scope resolution operator</em></span> to get at particular constants located in modules (even deeply nested ones!), and we can simply use the dot syntax we’re used to for getting ahold of class methods:</p><a id="pro_id00350"/>&#13;
      <pre class="programlisting">&#13;
MyClass::AModuleInsideThat::YetAnotherModule::MY_CONSTANT&#13;
MyClass.some_method&#13;
</pre>&#13;
&#13;
      <p>With that, you now officially know everything there is to know about Ruby classes and modules! (Okay, okay, there’s always more to learn, but you know all the stuff you’d use to write everyday Ruby programs.) You know so much Ruby, in fact, that we’re going to take a short break from learning new stuff to focus on <span class="emphasis"><em>re</em></span>writing some of the code we already know. Rewriting your code so it still does the same thing but looks nicer or runs faster is called <span class="emphasis"><em>refactoring</em></span>, and—as luck would have it!—that’s exactly what the Refactory is all about.</p>&#13;
    </div>&#13;
  </div>&#13;
</body></html>