<html><head></head><body>
<div id="sbo-rt-content"><section aria-labelledby="ch19" epub:type="chapter" role="doc-chapter">
<span aria-label="357" epub:type="pagebreak" id="pg_357" role="doc-pagebreak"/>
<hgroup>
<h2 class="CHAPTER" id="ch19">
<span class="CN"><span class="SANS_Futura_Std_Bold_Condensed_B_11">19</span></span>
<span class="CT"><span class="SANS_Dogma_OT_Bold_B_11">INHERITANCE</span></span>
</h2>
</hgroup>
<figure class="opener"><img alt="" class="opener" height="380" src="../images/opener.jpg" width="380"/>
</figure>
<p class="INTRO">This chapter covers perhaps the most powerful and important feature of OOP: <i>inheritance</i>. This is the capability of one or more classes, called <i>subclasses</i>, to automatically have all the same properties and methods as another class, called a <i>superclass</i>. Inheritance makes OOP more efficient: you have to define any general, shared members only once, in the superclass. Objects of the subclasses inherit those properties and methods, and they will also have whatever properties and methods are specific to the individual subclasses.</p>
<p class="TX">Associated with inheritance is the capability of subclasses to <i>override</i> inherited methods from their superclass when that general method isn’t appropriate to the particular subclass. As we’ll explore in this chapter, you can also have the best of both worlds (executing the inherited method <i>and</i> <span aria-label="358" epub:type="pagebreak" id="pg_358" role="doc-pagebreak"/>adding additional behavior through the subclass’s method) by using the <span class="SANS_TheSansMonoCd_W5Regular_11">parent</span> keyword. Additionally, we’ll discuss the third kind of protection PHP offers for methods and properties: <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span>. You’ll learn what distinguishes <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span> members of a class from <span class="SANS_TheSansMonoCd_W5Regular_11">public</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">private</span> members, and when to use each visibility designation.</p>
<section aria-labelledby="sec1" epub:type="division">
<h3 class="H1" id="sec1"><span id="toc-link_266"/><span class="SANS_Futura_Std_Bold_B_11">Inheritance as Generalization</span></h3>
<p class="TNI1">Inheritance simplifies code by identifying and generalizing properties and behaviors shared among classes of objects. Consider the properties identified for <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">Boat</span> objects shown in <a href="#fig19-1">Figure 19-1</a>.</p>
<figure class="IMG"><a id="fig19-1"/><img alt="" class="img70" height="256" src="../images/figure19-1.jpg" width="935"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 19-1: The</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">Car</span> <span class="SANS_Futura_Std_Book_Oblique_11">and</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">Boat</span> <span class="SANS_Futura_Std_Book_Oblique_11">classes, with common properties shown in bold</span></p></figcaption>
</figure>
<p class="TX">The first three properties of each class are identical: both <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">Boat</span> objects have a make and model, a number of passengers, and a top speed. To avoid redundancy, we can generalize these common properties (and any associated methods) into a superclass, which we’ll name <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span>. <a href="#fig19-2">Figure 19-2</a> shows this generalized <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> class with the three shared properties, as well as the simplified <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">Boat</span> classes, each now with just one property of its own.</p>
<figure class="IMG"><a id="fig19-2"/><img alt="" class="img70" height="472" src="../images/figure19-2.jpg" width="813"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 19-2: The</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">Vehicle</span> <span class="SANS_Futura_Std_Book_Oblique_11">superclass and the</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">Car</span> <span class="SANS_Futura_Std_Book_Oblique_11">and</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">Boat</span> <span class="SANS_Futura_Std_Book_Oblique_11">subclasses</span></p></figcaption>
</figure>
<p class="TX">The arrows going from <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">Boat</span> to <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> indicate that both <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">Boat</span> inherit from <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span>; that is, <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">Boat</span> are subclasses of the generalized <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> superclass. Notice that the visibility of the properties (public versus private) hasn’t been indicated in the diagram. For now, we’ll implement the classes by using simple public properties. Later in the chapter, we’ll refactor the classes by using the third visibility setting, <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span>.</p>
<p class="TX"><span aria-label="359" epub:type="pagebreak" id="pg_359" role="doc-pagebreak"/>Listing 19-1 implements the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> class shown in <a href="#fig19-2">Figure 19-2</a>. Start a new project and create <i>src/Vehicle.php</i> containing the code in this listing.</p>
<span id="lis19-1"/>
<pre><code>&lt;?php&#13;
class Vehicle&#13;
{&#13;
    public string $makeModel;&#13;
    public int $numPassengers;&#13;
    public float $topSpeed;&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-1: Implementing the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Vehicle</span> <span class="SANS_Futura_Std_Book_Oblique_11">superclass</span></p>
<p class="BodyContinued">We declare the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> class with three public properties: <span class="SANS_TheSansMonoCd_W5Regular_11">makeModel</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">numPassengers</span>, and <span class="SANS_TheSansMonoCd_W5Regular_11">topSpeed</span>.</p>
<p class="TX">Listing 19-2 implements the <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> subclass of <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span>, which should be created in <i>src/Car.php</i>.</p>
<span id="lis19-2"/>
<pre><code>&lt;?php&#13;
class Car extends Vehicle&#13;
{&#13;
    public string $bodyShape;&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-2: Implementing</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Car</span> <span class="SANS_Futura_Std_Book_Oblique_11">as a subclass of</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Vehicle</span></p>
<p class="TX">We declare that <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> should be a subclass of <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> simply by adding the <span class="SANS_TheSansMonoCd_W5Regular_11">extends</span> keyword followed by the superclass name at the start of the class declaration. Any <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> objects we create will automatically inherit all the properties and methods from the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> superclass, in addition to having the <span class="SANS_TheSansMonoCd_W5Regular_11">bodyShape</span> property declared directly in the <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> class.</p>
<section aria-labelledby="sec2" epub:type="division">
<h4 class="H2" id="sec2"><span id="toc-link_267"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Creating Objects from Subclasses</span></h4>
<p class="TNI1">To verify that our example of inheritance works, we’ll create a <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> object and set values for its properties—both the one declared directly in <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> and the ones inherited from <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span>. Create <i>public/index.php</i> containing the code in <a href="#lis19-3">Listing 19-3</a>.</p>
<span id="lis19-3"/>
<pre><code>&lt;?php&#13;
require_once __DIR__ .  '/../src/Vehicle.php';&#13;
require_once __DIR__ .  '/../src/Car.php';&#13;
&#13;
$car1 = new Car();&#13;
&#13;
$car1-&gt;bodyShape = 'Sedan';&#13;
$car1-&gt;makeModel = 'Ford Mustang';&#13;
$car1-&gt;numPassengers = 5;&#13;
$car1-&gt;topSpeed = 150;&#13;
&#13;
var_dump($car1);</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-3: Creating a</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Car</span> <span class="SANS_Futura_Std_Book_Oblique_11">object in</span> <span class="SANS_Futura_Std_Book_11">index.php</span></p>
<p class="TX"><span aria-label="360" epub:type="pagebreak" id="pg_360" role="doc-pagebreak"/>We first read in the files declaring the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> classes. It’s imperative to read in declarations for <i>all</i> the classes the code uses, including inherited classes such as <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span>, even though we won’t be directly creating objects of this class. The order we read in the files is important too: for the <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> class to be able to extend the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> class, we must have read in and executed the declaration for the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> class <i>before</i> reading in and declaring the <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> class. Otherwise, we’ll get an error about the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> class not being found.</p>
<blockquote>
<p class="Note"><span class="SANS_Dogma_OT_Bold_B_15">NOTE</span></p>
</blockquote>
<p class="NOTE-TXT"><i>Large projects may require tens, or even hundreds, of class declarations. In <a href="chapter20.xhtml">Chapter 20</a>, we’ll look at a way to read in all the class declarations in the required sequence with a single statement, using a script called an</i> <span class="note">autoloader</span><i>.</i></p>
<p class="TX">Next, we create a new <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> object and store a reference to it in the <span class="SANS_TheSansMonoCd_W5Regular_11">$car1</span> variable. Then we set values for the <span class="SANS_TheSansMonoCd_W5Regular_11">bodyShape</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">makeModel</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">numPassengers</span>, and <span class="SANS_TheSansMonoCd_W5Regular_11">topSpeed</span> properties. The syntax is the same whether the property was declared for the subclass or inherited from the superclass: either way, we simply use <span class="SANS_TheSansMonoCd_W5Regular_11">$car1-&gt;</span><span class="SANS_TheSansMonoCd_W5Regular_Italic_11">propertyName</span> <span class="SANS_TheSansMonoCd_W5Regular_11">=</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">value</span>. Finally, we use <span class="SANS_TheSansMonoCd_W5Regular_11">var_dump()</span> to output structured information about the <span class="SANS_TheSansMonoCd_W5Regular_11">$car1</span> variable and the object it refers to in memory. Here’s the result of running the index script at the command line:</p>
<pre><code>$ <b>php public/index.php</b>&#13;
object(Car)#1 (4) {&#13;
  ["bodyShape"]=&gt;&#13;
  string(5) "Sedan"&#13;
  ["makeModel"]=&gt;&#13;
  string(12) "Ford Mustang"&#13;
  ["numPassengers"]=&gt;&#13;
  int(5)&#13;
  ["topSpeed"]=&gt;&#13;
  float(150)&#13;
}</code></pre>
<p class="TX">The <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> object indeed has four properties, and we’ve successfully set all four, including the property declared in <i>Car.php</i> (<span class="SANS_TheSansMonoCd_W5Regular_11">bodyShape</span>) and the three properties inherited from the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> superclass.</p>
<p class="TX">Let’s complete our implementation of the class hierarchy from <a href="#fig19-2">Figure 19-2</a> by declaring the <span class="SANS_TheSansMonoCd_W5Regular_11">Boat</span> subclass. Create <i>src/Boat.php</i> and enter the code in <a href="#lis19-4">Listing 19-4</a>.</p>
<span id="lis19-4"/>
<pre><code>&lt;?php&#13;
class Boat extends Vehicle&#13;
{&#13;
    public string $countryOfRegistration;&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-4: Implementing the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Boat</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p>
<p class="TX">We declare that <span class="SANS_TheSansMonoCd_W5Regular_11">Boat</span> should inherit from <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span>, once again using the <span class="SANS_TheSansMonoCd_W5Regular_11">extends</span> keyword to establish the subclass/superclass relationship. The class has only one unique property, <span class="SANS_TheSansMonoCd_W5Regular_11">countryOfRegistration</span>, but <span class="SANS_TheSansMonoCd_W5Regular_11">Boat</span> objects will <span aria-label="361" epub:type="pagebreak" id="pg_361" role="doc-pagebreak"/>also inherit the three public properties of <span class="SANS_TheSansMonoCd_W5Regular_11">makeModel</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">numPassengers</span>, and <span class="SANS_TheSansMonoCd_W5Regular_11">topSpeed</span> from <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span>.</p>
</section>
<section aria-labelledby="sec3" epub:type="division">
<h4 class="H2" id="sec3"><span id="toc-link_268"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Using Multiple Levels of Inheritance</span></h4>
<p class="TNI1">Class hierarchies can involve many levels of inheritance: class <span class="SANS_TheSansMonoCd_W5Regular_11">A</span> could have a subclass <span class="SANS_TheSansMonoCd_W5Regular_11">B</span>, class <span class="SANS_TheSansMonoCd_W5Regular_11">B</span> could have a subclass <span class="SANS_TheSansMonoCd_W5Regular_11">C</span>, and so on. In this case, class <span class="SANS_TheSansMonoCd_W5Regular_11">C</span> would inherit methods and properties from both class <span class="SANS_TheSansMonoCd_W5Regular_11">B</span>, its immediate superclass, and from class <span class="SANS_TheSansMonoCd_W5Regular_11">A</span>, the superclass of its superclass. <a href="#fig19-3">Figure 19-3</a> illustrates how we might use this mechanism to further extend our hierarchy of vehicular classes.</p>
<figure class="IMG"><a id="fig19-3"/><img alt="" class="img70" height="731" src="../images/figure19-3.jpg" width="896"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 19-3: A three-level class hierarchy, with subclasses of subclasses</span></p></figcaption>
</figure>
<p class="TX">The class hierarchy features two subclasses of <span class="SANS_TheSansMonoCd_W5Regular_11">Boat</span>: <span class="SANS_TheSansMonoCd_W5Regular_11">MotorBoat</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">SailBoat</span>. All <span class="SANS_TheSansMonoCd_W5Regular_11">MotorBoat</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">SailBoat</span> objects will inherit the properties and methods of <span class="SANS_TheSansMonoCd_W5Regular_11">Boat</span>, their superclass. That includes the properties and methods that <span class="SANS_TheSansMonoCd_W5Regular_11">Boat</span> inherits from <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span>. Meanwhile, <span class="SANS_TheSansMonoCd_W5Regular_11">MotorBoat</span> objects will also have a special property of their own, <span class="SANS_TheSansMonoCd_W5Regular_11">engineSize</span>, while <span class="SANS_TheSansMonoCd_W5Regular_11">SailBoat</span> will have a unique <span class="SANS_TheSansMonoCd_W5Regular_11">numberOfMasts</span> property.</p>
<p class="TX">When it comes time to declare the <span class="SANS_TheSansMonoCd_W5Regular_11">MotorBoat</span> class, we’d start by writing <span class="SANS_TheSansMonoCd_W5Regular_11">class MotorBoat extends Boat</span>. We don’t need to also mention <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> in the <span class="SANS_TheSansMonoCd_W5Regular_11">MotorBoat</span> class declaration; the inheritance from <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> is already covered in the <i>src/Boat.php</i> class-declaration file.</p>
<p class="TX">Like most object-oriented languages, PHP permits each class to have only a single direct superclass. This safeguard prevents ambiguities as to where a property or method is being inherited from, but it also adds challenges when it comes to designing class hierarchies. For example, since cars and motorboats both have engines, it might make sense to create a <span class="SANS_TheSansMonoCd_W5Regular_11">MotorizedVehicle</span> subclass of <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span>. The <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> class would naturally inherit from <span class="SANS_TheSansMonoCd_W5Regular_11">MotorizedVehicle</span>, but what about <span class="SANS_TheSansMonoCd_W5Regular_11">MotorBoat</span>? Should it inherit from <span class="SANS_TheSansMonoCd_W5Regular_11">Boat</span> or <span class="SANS_TheSansMonoCd_W5Regular_11">MotorizedVehicle</span>? It can inherit directly from only one or the other. As <span aria-label="362" epub:type="pagebreak" id="pg_362" role="doc-pagebreak"/>this example illustrates, once class hierarchies get more complex, care must be taken in their design.</p>
</section>
</section>
<section aria-labelledby="sec4" epub:type="division">
<h3 class="H1" id="sec4"><span id="toc-link_269"/><span class="SANS_Futura_Std_Bold_B_11">Protected Visibility</span></h3>
<p class="TNI1">With the introduction of inheritance, a third visibility keyword, besides <span class="SANS_TheSansMonoCd_W5Regular_11">public</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">private</span>, becomes relevant: <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span>. When a method or property is declared <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span>, it becomes accessible to any subclasses that inherit it, but it can’t be accessed by code elsewhere in the project. For example, a protected property of the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> superclass could be accessed within <i>Car.php</i>, since <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> inherits from <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span>. By contrast, that protected property couldn’t be accessed within the general <i>index.php</i> file.</p>
<p class="TX">The <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span> visibility designation is more restrictive than <span class="SANS_TheSansMonoCd_W5Regular_11">public</span>, since public properties and methods can be accessed from anywhere within the project code. On the other hand, <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span> is less restrictive than <span class="SANS_TheSansMonoCd_W5Regular_11">private</span>. When a method or property is private, it’s accessible only within the class itself; not even methods of subclasses can directly access private properties and methods from their superclass.</p>
<p class="TX">To illustrate the distinction between the three visibility keywords, we’ll refactor the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> class. To begin, we’ll update the class to have private properties and public accessor methods, as we discussed in <span class="Xref"><a href="chapter18.xhtml">Chapter 18</a></span>. Then we’ll add the <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span> designation into the mix. <a href="#lis19-5">Listing 19-5</a> shows the first changes to <i>src/Vehicle.php</i>.</p>
<span id="lis19-5"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">class Vehicle</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">{</span>&#13;
    private <span class="TheSansMonoCd_W5Regular_Grey_11">string $makeModel;</span>&#13;
    private <span class="TheSansMonoCd_W5Regular_Grey_11">int $numPassengers;</span>&#13;
    private <span class="TheSansMonoCd_W5Regular_Grey_11">float $topSpeed;</span>&#13;
&#13;
  <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> public function getMakeModel(): string&#13;
    {&#13;
        return $this-&gt;makeModel;&#13;
    }&#13;
&#13;
    public function setMakeModel(string $makeModel): void&#13;
    {&#13;
        $this-&gt;makeModel = $makeModel;&#13;
    }&#13;
&#13;
    public function getNumPassengers(): int&#13;
    {&#13;
        return $this-&gt;numPassengers;&#13;
    }&#13;
&#13;
    public function setNumPassengers(int $numPassengers): void&#13;
    {&#13;
        $this-&gt;numPassengers = $numPassengers;&#13;
    }&#13;
&#13;
<span aria-label="363" epub:type="pagebreak" id="pg_363" role="doc-pagebreak"/>    public function getTopSpeed(): float&#13;
    {&#13;
        return $this-&gt;topSpeed;&#13;
    }&#13;
&#13;
    public function setTopSpeed(float $topSpeed): void&#13;
    {&#13;
        $this-&gt;topSpeed = $topSpeed;&#13;
    }&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-5: Revising the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Vehicle</span> <span class="SANS_Futura_Std_Book_Oblique_11">class to have private properties and public accessor methods</span></p>
<p class="TX">We declare all three class properties as <span class="SANS_TheSansMonoCd_W5Regular_11">private</span> rather than <span class="SANS_TheSansMonoCd_W5Regular_11">public</span>. This means they can’t be set directly. Instead, we’ve declared public getter and setter methods for each property <span aria-label="annotation1" class="CodeAnnotation">❶</span>.</p>
<p class="TX">We now need to update the index script to use the setter methods to set values for the <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> object. Modify <i>public/index.php</i> to match the code in <a href="#lis19-6">Listing 19-6</a>.</p>
<span id="lis19-6"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">require_once __DIR__ .  '/../src/Vehicle.php';</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">require_once __DIR__ .  '/../src/Car.php';</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">$car1 = new Car();</span>&#13;
&#13;
<span aria-label="annotation1" class="codeannotated_CodeAnnotation">❶</span> <span class="TheSansMonoCd_W5Regular_Grey_11">$car1-&gt;bodyShape = 'Sedan';</span>&#13;
&#13;
$car1-&gt;setMakeModel('Ford Mustang');&#13;
$car1-&gt;setNumPassengers(5);&#13;
$car1-&gt;setTopSpeed(150);&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">var_dump($car1);</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-6: Updating</span> <span class="SANS_Futura_Std_Book_11">index.php</span> <span class="SANS_Futura_Std_Book_Oblique_11">to set inherited properties via setter methods</span></p>
<p class="TX">We can still directly access the <span class="SANS_TheSansMonoCd_W5Regular_11">bodyShape</span> property declared in the <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> class <span aria-label="annotation1" class="CodeAnnotation">❶</span>, since it’s still set as <span class="SANS_TheSansMonoCd_W5Regular_11">public</span>. However, we now need to use the setter methods to assign values to the three inherited properties, <span class="SANS_TheSansMonoCd_W5Regular_11">makeModel</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">numPassengers</span>, and <span class="SANS_TheSansMonoCd_W5Regular_11">topSpeed</span>, since these properties are now declared as <span class="SANS_TheSansMonoCd_W5Regular_11">private</span> in the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> superclass. The <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> object inherits the accessor methods from <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span>, just as it inherits the properties themselves. Thanks to the accessor methods, <span class="SANS_TheSansMonoCd_W5Regular_11">var_dump()</span> will work as before.</p>
<p class="TX">Using public setter methods to update private properties within <i>index.php</i> makes sense; this is exactly what we did in <span class="Xref"><a href="chapter18.xhtml">Chapter 18</a></span>. But what if we want to use one of the properties inherited from <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> as part of a method declared in the <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> class? Let’s try this and see what happens. We’ll add a new <span class="SANS_TheSansMonoCd_W5Regular_11">getMakeModelShape()</span> method to <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> that returns a string summary of some of the object’s properties. Update <i>src/Car.php</i> to match the code in <a href="#lis19-7">Listing 19-7</a>.</p>
<span id="lis19-7"/>
<pre><code><span aria-label="364" epub:type="pagebreak" id="pg_364" role="doc-pagebreak"/><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">class Car extends Vehicle</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">{</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    public string $bodyShape;</span>&#13;
&#13;
    public function getMakeModelShape(): string&#13;
    {&#13;
        return "$this-&gt;makeModel, $this-&gt;bodyShape";&#13;
    }&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">}</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-7: Trying to access private superclass properties from a subclass</span></p>
<p class="TX">We declare the new <span class="SANS_TheSansMonoCd_W5Regular_11">getMakeModelShape()</span> method in the <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> class. This method attempts to insert the values of the <span class="SANS_TheSansMonoCd_W5Regular_11">makeModel</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">bodyShape</span> properties into a string. To see whether this method works, we’ll invoke it in our index script. Update <i>public/index.php</i> as shown in <a href="#lis19-8">Listing 19-8</a>.</p>
<span id="lis19-8"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">require_once __DIR__ .  '/../src/Vehicle.php';</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">require_once __DIR__ .  '/../src/Car.php';</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">$car1 = new Car();</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">$car1-&gt;bodyShape = 'Sedan';</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">$car1-&gt;setMakeModel('Ford Mustang');</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">$car1-&gt;setNumPassengers(5);</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">$car1-&gt;setTopSpeed(150);</span>&#13;
&#13;
print $car1-&gt;getMakeModelShape();</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-8: Testing the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">getMakeModelShape()</span> <span class="SANS_Futura_Std_Book_Oblique_11">method in</span> <span class="SANS_Futura_Std_Book_11">index.php</span></p>
<p class="TX">We’ve replaced the <span class="SANS_TheSansMonoCd_W5Regular_11">var_dump()</span> function call with a <span class="SANS_TheSansMonoCd_W5Regular_11">print</span> statement invoking the <span class="SANS_TheSansMonoCd_W5Regular_11">getMakeModelShape()</span> method of our <span class="SANS_TheSansMonoCd_W5Regular_11">$car1</span> object reference. However, if you now run the index script, you’ll get an <span class="SANS_TheSansMonoCd_W5Regular_11">Undefined property</span> warning, as shown here:</p>
<pre><code>$ <b>php public/index.php</b>&#13;
&#13;
Warning: Undefined property: Car::$makeModel in /Users/matt/src/Car.php&#13;
on line 10&#13;
, Sedan</code></pre>
<p class="TX">Statements in our <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> class methods have no access to inherited private properties, so the PHP engine simply can’t find a <span class="SANS_TheSansMonoCd_W5Regular_11">makeModel</span> property when it executes <span class="SANS_TheSansMonoCd_W5Regular_11">getMakeModelShape()</span>. Notice, however, that the warning message is followed by the text <span class="SANS_TheSansMonoCd_W5Regular_11">, Sedan</span>. This indicates that the index script continued executing despite the issue. Indeed, after continuing from its undefined property warning, the PHP engine had no problem with the <span aria-label="365" epub:type="pagebreak" id="pg_365" role="doc-pagebreak"/><span class="SANS_TheSansMonoCd_W5Regular_11">$this-&gt;bodyShape</span> portion of the <span class="SANS_TheSansMonoCd_W5Regular_11">getMakeModelShape()</span> method, since <span class="SANS_TheSansMonoCd_W5Regular_11">bodyShape</span> is a property defined directly on the <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> class itself.</p>
<p class="TX">One way for us to access the value of an inherited property could be to use the public getter method to access the <span class="SANS_TheSansMonoCd_W5Regular_11">makeModel</span> property, but in some situations it’s best not to offer public getter or setter methods for a property. A better solution when you want to give methods of a subclass direct access to a property or method inherited from its superclass, without making that property or method public, is to give the property or method <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span> visibility. For that, update the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> class as shown in <a href="#lis19-9">Listing 19-9</a>.</p>
<span id="lis19-9"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">class Vehicle</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">{</span>&#13;
  <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> protected string $makeModel;&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    private int $numPassengers;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    private float $topSpeed;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    public function getMakeModel(): string</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        return $this-&gt;makeModel;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Italic_11">--snip--</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-9: Using</span> <span class="TheSansMonoCd_W5Regular_Italic_11">protected</span> <span class="SANS_Futura_Std_Book_Oblique_11">visibility for</span> <span class="TheSansMonoCd_W5Regular_Italic_11">makeModel</span> <span class="SANS_Futura_Std_Book_Oblique_11">in the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Vehicle</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p>
<p class="TX">We now declare the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> property <span class="SANS_TheSansMonoCd_W5Regular_11">makeModel</span> to have <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span> visibility <span aria-label="annotation1" class="CodeAnnotation">❶</span>, which means it can be accessed directly by statements in the <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> subclass. Re-execute the index script and you’ll see the make, model, and shape string output with no warnings: <span class="SANS_TheSansMonoCd_W5Regular_11">Ford Mustang, Sedan</span>.</p>
<aside aria-labelledby="box-12" class="box">
<h4 class="BoxTitle" id="box-12"><span class="SANS_Dogma_OT_Bold_B_11">STEREOTYPING</span></h4>
<p class="BoxBodyFirst"><span class="SANS_Futura_Std_Book_11">UML allows us to introduce visual language abbreviations to simplify common code design features through a feature called stereotyping. Stereotypes are indicated by double chevron angle brackets (called</span> <span class="SANS_Futura_Std_Book_Oblique_11">guillemets</span><span class="SANS_Futura_Std_Book_11">) in the form «</span><span class="SANS_Futura_Std_Book_Oblique_11">StereotypeName</span><span class="SANS_Futura_Std_Book_11">». So, rather than laboriously listing public getter and setter methods for each property in our class diagrams, we can indicate that a property should have a getter and/or setter method by annotating the property with a stereotype. For example, «</span><span class="SANS_Futura_Std_Book_Oblique_11">get/set</span><span class="SANS_Futura_Std_Book_11">» indicates that a property should have both a getter and setter public method.</span></p>
</aside>
<p class="TX"><a href="#fig19-4">Figure 19-4</a> shows the UML diagram for our three classes, updated to indicate the visibility of each class property and method.</p>
<span aria-label="366" epub:type="pagebreak" id="pg_366" role="doc-pagebreak"/>
<figure class="IMG"><a id="fig19-4"/><img alt="" class="img70" height="477" src="../images/figure19-4.jpg" width="1029"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 19-4: An updated UML diagram showing the visibility settings for the class hierarchy</span></p></figcaption>
</figure>
<p class="TX">Within the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> class, the hash mark (<span class="SANS_TheSansMonoCd_W5Regular_11">#</span>) indicates the protected visibility of the <span class="SANS_TheSansMonoCd_W5Regular_11">makeModel</span> property, while the other two properties are shown as private with minus signs. All properties and methods for classes <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">Boat</span> are public and so indicated with plus signs. The <i>«get/set»</i> annotations in the diagram indicate public getter and setter accessor methods for all three properties of the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> class.</p>
<p class="TX">This example demonstrates the distinction between <span class="SANS_TheSansMonoCd_W5Regular_11">private</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span>. To illustrate the difference between the <span class="SANS_TheSansMonoCd_W5Regular_11">public</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span> visibility of properties, let’s modify the <i>public/index.php</i> script to try to directly set the value of the <span class="SANS_TheSansMonoCd_W5Regular_11">makeModel</span> property. Update the index script to match <a href="#lis19-10">Listing 19-10</a>.</p>
<span id="lis19-10"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">require_once __DIR__ .  '/../src/Vehicle.php';</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">require_once __DIR__ .  '/../src/Car.php';</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">$car1 = new Car();</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">$car1-&gt;bodyShape = 'Sedan';</span>&#13;
$car1-&gt;makeModel = 'Ford Mustang';&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">$car1-&gt;setNumPassengers(5);</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">$car1-&gt;setTopSpeed(150);</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">print $car1-&gt;getMakeModelShape();</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-10: Illustrating the difference between</span> <span class="TheSansMonoCd_W5Regular_Italic_11">public</span> <span class="SANS_Futura_Std_Book_Oblique_11">and</span> <span class="TheSansMonoCd_W5Regular_Italic_11">protected</span> <span class="SANS_Futura_Std_Book_Oblique_11">visibility</span></p>
<p class="TX">We set the value of the public <span class="SANS_TheSansMonoCd_W5Regular_11">bodyShape</span> property to <span class="SANS_TheSansMonoCd_W5Regular_11">'Sedan'</span> as before. Then we attempt to directly change the value stored in the <span class="SANS_TheSansMonoCd_W5Regular_11">makeModel</span> property of <span class="SANS_TheSansMonoCd_W5Regular_11">$car1</span> to the string <span class="SANS_TheSansMonoCd_W5Regular_11">'Ford Mustang'</span>. Execute this script and you’ll get a fatal error, as shown here:</p>
<pre><code>$ <b>php public/index.php</b>&#13;
&#13;
Fatal error: Uncaught Error: Cannot access protected property Car::$makeModel&#13;
in /Users/matt/public/index.php:13&#13;
<span aria-label="367" epub:type="pagebreak" id="pg_367" role="doc-pagebreak"/>Stack trace:&#13;
#0 {main}&#13;
  thrown in /Users/matt/public/index.php on line 13</code></pre>
<p class="TX">The <span class="SANS_TheSansMonoCd_W5Regular_11">makeModel</span> property has <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span> visibility, so it can’t be accessed from our index script. Only subclasses of <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> can access the property directly.</p>
</section>
<section aria-labelledby="sec5" epub:type="division">
<h3 class="H1" id="sec5"><span id="toc-link_270"/><span class="SANS_Futura_Std_Bold_B_11">Abstract Classes</span></h3>
<p class="TNI1">An <i>abstract class</i> is one that will never be used to create objects. Instead, abstract classes are commonly declared so their members (properties and methods) can be inherited by subclasses. The <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> class, for example, is an abstract class. We’ll never want to create a <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> object; we declared the class only to generalize common properties and methods from the <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">Boat</span> classes.</p>
<p class="TX">Another use of abstract classes is to declare static members, properties, or methods that relate to the class as a whole rather than to individual objects. We’ll explore static members in <span class="note_Xref"><a href="chapter25.xhtml">Chapter 25</a></span>.</p>
<p class="TX">It’s good practice to be as specific as possible about how a class and its members will be used. For that reason, if you know a class is abstract, it’s best to include the <span class="SANS_TheSansMonoCd_W5Regular_11">abstract</span> keyword when you’re declaring it. This keyword ensures that no object of the class can be created without triggering an error. To demonstrate, we’ll add the <span class="SANS_TheSansMonoCd_W5Regular_11">abstract</span> keyword to our <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> class declaration. Update <i>src/Vehicle.php</i> as shown in <a href="#lis19-11">Listing 19-11</a>.</p>
<span id="lis19-11"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
&#13;
abstract <span class="TheSansMonoCd_W5Regular_Grey_11">class Vehicle</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">{</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    protected string $makeModel;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Italic_11">--snip--</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-11: Declaring</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Vehicle</span> <span class="SANS_Futura_Std_Book_Oblique_11">as an abstract class</span></p>
<p class="TX">We declare that <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> is an abstract class by adding <span class="SANS_TheSansMonoCd_W5Regular_11">abstract</span> immediately before the <span class="SANS_TheSansMonoCd_W5Regular_11">class</span> keyword. If you run the index script again after making this change, you’ll see no difference in the behavior of the program. However, if you now attempt to create a <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> object, as shown in <a href="#lis19-12">Listing 19-12</a>, a fatal error will occur. Update <i>public/index.php</i> to match the listing.</p>
<span id="lis19-12"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">require_once __DIR__ .  '/../src/Vehicle.php';</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">require_once __DIR__ .  '/../src/Car.php';</span>&#13;
&#13;
<span aria-label="annotation1" class="codeannotated_CodeAnnotation">❶</span> $vehicle1 = new Vehicle();&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">$car1 = new Car();</span>&#13;
<span class="TheSansMonoCd_W5Regular_Italic_11">--snip--</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-12: Attempting to create an object of the abstract</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Vehicle</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p>
<p class="TX"><span aria-label="368" epub:type="pagebreak" id="pg_368" role="doc-pagebreak"/>We attempt to create an object of the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> class and store a reference to the created object in the <span class="SANS_TheSansMonoCd_W5Regular_11">$vehicle1</span> variable <span aria-label="annotation1" class="CodeAnnotation">❶</span>. Here’s what happens if you try to run this index script:</p>
<pre><code>$ <b>php public/index.php</b>&#13;
&#13;
Fatal error: Uncaught Error: Cannot instantiate abstract class Vehicle in&#13;
/Users/matt/public/index.php:5&#13;
Stack trace:&#13;
#0 {main}&#13;
  thrown in /Users/matt/public/index.php on line 5</code></pre>
<p class="TX">A fatal error occurs, with the message <span class="SANS_TheSansMonoCd_W5Regular_11">Cannot instantiate abstract class</span>. This is exactly what we want: by declaring the <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> class to be <span class="SANS_TheSansMonoCd_W5Regular_11">abstract</span>, we’ve guaranteed that no <span class="SANS_TheSansMonoCd_W5Regular_11">Vehicle</span> objects can be created.</p>
</section>
<section aria-labelledby="sec6" epub:type="division">
<h3 class="H1" id="sec6"><span id="toc-link_271"/><span class="SANS_Futura_Std_Bold_B_11">Overriding Inherited Methods</span></h3>
<p class="TNI1">In some cases, you might want to change the way an inherited method behaves on a subclass, as compared to the way it’s defined in the superclass. This is called <i>overriding</i> the method, and you do it by defining the method directly on the subclass and giving it the same name as the method inherited from the superclass. PHP gives precedence to properties and methods defined lower in the class hierarchy, so it will execute the method definition from the subclass rather than the one from the superclass.</p>
<p class="TX">Let’s illustrate with a superclass that declares a <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method, then a subclass that overrides this declaration with its own <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> implementation. <a href="#fig19-5">Figure 19-5</a> shows the UML diagram for the two classes we’ll use to investigate how to override inherited methods, with notes to indicate how each <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method should behave. We’ll be creating a general <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span> class and a <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> subclass of <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span>.</p>
<figure class="IMG"><a id="fig19-5"/><img alt="" class="img100" height="605" src="../images/figure19-5.jpg" width="1222"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 19-5: The</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">Dessert</span> <span class="SANS_Futura_Std_Book_Oblique_11">subclass overrides the</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">__toString()</span> <span class="SANS_Futura_Std_Book_Oblique_11">method inherited from</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">Food</span><span class="SANS_Futura_Std_Book_Oblique_11">.</span></p></figcaption>
</figure>
<p class="TX"><span aria-label="369" epub:type="pagebreak" id="pg_369" role="doc-pagebreak"/>The <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span> class has a <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method that generates a string in the form <span class="SANS_TheSansMonoCd_W5Regular_11">"(FOOD)</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">foodname</span><span class="SANS_TheSansMonoCd_W5Regular_11">"</span>, such as <span class="SANS_TheSansMonoCd_W5Regular_11">"(FOOD) apple"</span>. Meanwhile, the <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> subclass overrides this behavior with its own <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method that generates a string in the form <span class="SANS_TheSansMonoCd_W5Regular_11">"I am a Dessert named</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">foodname</span><span class="SANS_TheSansMonoCd_W5Regular_11">"</span>, such as <span class="SANS_TheSansMonoCd_W5Regular_11">"I am a Dessert named strawberry cheesecake"</span>.</p>
<p class="TX">First, we’ll declare the <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span> class. Create a new project, then create <i>src/Food.php</i> containing the code in <a href="#lis19-13">Listing 19-13</a>.</p>
<span id="lis19-13"/>
<pre><code>&lt;?php&#13;
class Food&#13;
{&#13;
    protected string $name;&#13;
&#13;
    public function __construct(string $name)&#13;
    {&#13;
        $this-&gt;name = $name;&#13;
    }&#13;
&#13;
    public function __toString(): string&#13;
    {&#13;
        return "(FOOD) $this-&gt;name";&#13;
    }&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-13: The</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Food</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p>
<p class="TX">We declare the <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span> class with one string property, <span class="SANS_TheSansMonoCd_W5Regular_11">name</span>, that has <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span> visibility so all subclasses can directly access it. The class has a constructor to initialize the <span class="SANS_TheSansMonoCd_W5Regular_11">name</span> property when each new object is created, as well as the <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method shown in <a href="#fig19-5">Figure 19-5</a>.</p>
<p class="TX">Let’s now declare <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> as a subclass of <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span>. Create <i>src/Dessert.php</i> and enter the contents of <a href="#lis19-14">Listing 19-14</a>.</p>
<span id="lis19-14"/>
<pre><code>&lt;?php&#13;
class Dessert extends Food&#13;
{&#13;
    public function __toString(): string&#13;
    {&#13;
        $message = "I am a Dessert named $this-&gt;name";&#13;
        return $message;&#13;
    }&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-14: The</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Dessert</span> <span class="SANS_Futura_Std_Book_Oblique_11">class, with its own</span> <span class="TheSansMonoCd_W5Regular_Italic_11">__toString()</span> <span class="SANS_Futura_Std_Book_Oblique_11">method</span></p>
<p class="TX">We declare that <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> is a subclass of (extends) <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span> and give it its own <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method, as illustrated in <a href="#fig19-5">Figure 19-5</a>. Since PHP prioritizes methods declared lower in the class hierarchy, this <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method will override the <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method defined for the <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span> superclass. Notice that we’ve introduced a local <span class="SANS_TheSansMonoCd_W5Regular_11">$message</span> variable in the <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> class’s <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method. This variable may seem unnecessary now, but we’ll return to this example and add to the message later in the chapter.</p>
<p class="TX"><span aria-label="370" epub:type="pagebreak" id="pg_370" role="doc-pagebreak"/>Test these classes by creating the <i>public/index.php</i> script that is shown in <a href="#lis19-15">Listing 19-15</a>. This script creates two objects, one <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span> object and one <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> object, and prints out each, which will result in the objects’ <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> methods being invoked.</p>
<span id="lis19-15"/>
<pre><code>&lt;?php&#13;
require_once __DIR__ . '/../src/Food.php';&#13;
require_once __DIR__ . '/../src/Dessert.php';&#13;
&#13;
$f1 = new Food('apple');&#13;
<span aria-label="annotation1" class="codeannotated_CodeAnnotation">❶</span> print $f1;&#13;
print '&lt;br&gt;';&#13;
&#13;
$f2 = new Dessert('strawberry cheesecake');&#13;
print $f2;</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-15: Creating and printing</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Food</span> <span class="SANS_Futura_Std_Book_Oblique_11">and</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Dessert</span> <span class="SANS_Futura_Std_Book_Oblique_11">objects in</span> <span class="SANS_Futura_Std_Book_11">index.php</span></p>
<p class="TX">We read in and execute the class declarations for <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span>, starting with the superclass. Then we create and print an object of each class, which will invoke the objects’ <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> methods <span aria-label="annotation1" class="CodeAnnotation">❶</span>. Here’s the browser output of running the web server and requesting a page:</p>
<pre><code>(FOOD) apple&#13;
I am a Dessert named strawberry cheesecake</code></pre>
<p class="TX">Notice that the <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> object outputs <span class="SANS_TheSansMonoCd_W5Regular_11">I am a Dessert named strawberry cheesecake</span>, demonstrating that it successfully overrode the <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method inherited from <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span> with its own definition of this method. Overriding one method doesn’t disrupt the subclass’s inheritance of any other methods or properties from its superclass, however. In this case, the <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> object still successfully inherited the <span class="SANS_TheSansMonoCd_W5Regular_11">name</span> property and <span class="SANS_TheSansMonoCd_W5Regular_11">__construct()</span> method from <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span>.</p>
<aside aria-labelledby="box-13" class="box">
<h4 class="BoxTitle" id="box-13"><span class="SANS_Dogma_OT_Bold_B_11">THE LISKOV SUBSTITUTION PRINCIPLE</span></h4>
<p class="BoxBodyFirst"><span class="SANS_Futura_Std_Book_11">In some cases of method overriding, such as the</span> <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> <span class="SANS_Futura_Std_Book_11">methods in our</span> <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span> <span class="SANS_Futura_Std_Book_11">and</span> <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> <span class="SANS_Futura_Std_Book_11">example, the superclass and subclass methods have an identical</span> <span class="SANS_Futura_Std_Book_Oblique_11">signature</span><span class="SANS_Futura_Std_Book_11">: the method name, parameter list, and return type match exactly. However, this isn’t necessary. Only the method name must match exactly between the superclass and subclass; other aspects of the method signatures can vary, as long as the subclass still satisfies the</span> <span class="SANS_Futura_Std_Book_Oblique_11">Liskov substitution principle (LSP)</span><span class="SANS_Futura_Std_Book_11">, named for Barbara Liskov, one of the first women to earn a PhD in computer science in the United States. This principle states that you must be able to substitute an object of a superclass with an object of a subclass without creating any unexpected behavior.</span></p>
<p class="BoxBody"><span aria-label="371" epub:type="pagebreak" id="pg_371" role="doc-pagebreak"/><span class="SANS_Futura_Std_Book_11">To adhere to the LSP, an overriding method’s signature can vary from that of the parent method in the following ways:</span></p>
<p class="BoxRunInPara"><span class="SANS_Futura_Std_Heavy_11">Make a mandatory parameter optional</span><span class="SANS_Futura_Std_Book_11">   For example, a superclass method</span> <span class="SANS_TheSansMonoCd_W5Regular_11">validUser(int $minAge)</span><span class="SANS_Futura_Std_Book_11">, which has the mandatory parameter</span> <span class="SANS_TheSansMonoCd_W5Regular_11">$minAge</span><span class="SANS_Futura_Std_Book_11">, could be overridden by a subclass method that provides a default value, making the parameter optional, such as</span> <span class="SANS_TheSansMonoCd_W5Regular_11">validUser(int $minAge = 18)</span><span class="SANS_Futura_Std_Book_11">.</span></p>
<p class="BoxRunInPara"><span class="SANS_Futura_Std_Heavy_11">Add new optional parameters</span><span class="SANS_Futura_Std_Book_11">   This would be demonstrated if the</span> <span class="SANS_TheSansMonoCd_W5Regular_11">validUser(int $minAge)</span> <span class="SANS_Futura_Std_Book_11">superclass method could be overridden by a subclass method that adds another optional parameter (with a default value), such as</span> <span class="SANS_TheSansMonoCd_W5Regular_11">validUser(int $minAge, int $maxAge = 65)</span><span class="SANS_Futura_Std_Book_11">.</span></p>
<p class="BoxRunInPara"><span class="SANS_Futura_Std_Heavy_11">Return a more specific type</span><span class="SANS_Futura_Std_Book_11">   An example of this would be if a superclass has a</span> <span class="SANS_TheSansMonoCd_W5Regular_11">getRandomFood()</span> <span class="SANS_Futura_Std_Book_11">method that returns a reference to a</span> <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span> <span class="SANS_Futura_Std_Book_11">object, this method could be overridden by a subclass method that returns a</span> <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> <span class="SANS_Futura_Std_Book_11">object instead (where</span> <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> <span class="SANS_Futura_Std_Book_11">is a subclass of</span> <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span><span class="SANS_Futura_Std_Book_11">). This kind of substitution with a more specific type is known as</span> <span class="SANS_Futura_Std_Book_Oblique_11">covariance</span><span class="SANS_Futura_Std_Book_11">.</span></p>
<p class="BoxRunInPara"><span class="SANS_Futura_Std_Heavy_11">Declare a parameter type to be less specific</span><span class="SANS_Futura_Std_Book_11">   For example, if a superclass has a method that takes a</span> <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> <span class="SANS_Futura_Std_Book_11">object as a parameter, a subclass could override it with a method that instead takes a</span> <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span> <span class="SANS_Futura_Std_Book_11">object as a parameter. This kind of substitution with a more general type is known as</span> <span class="SANS_Futura_Std_Book_Oblique_11">contravariance</span><span class="SANS_Futura_Std_Book_11">.</span></p>
</aside>
</section>
<section aria-labelledby="sec7" epub:type="division">
<h3 class="H1" id="sec7"><span id="toc-link_272"/><span class="SANS_Futura_Std_Bold_B_11">Augmenting Inherited Behavior</span></h3>
<p class="TNI1">Sometimes, rather than completely replace (override) an inherited method, you might want to <i>augment</i> the inherited method with additional behavior specific to the subclass. PHP provides the keyword <span class="SANS_TheSansMonoCd_W5Regular_11">parent</span> for this purpose: it allows you to reference a superclass’s method or property from within a subclass declaration file. To illustrate, we’ll modify the <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method of the <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> subclass. It will now generate a string by using the <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method from the parent <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span> class, then add a special message specific to <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> objects. Update <i>src/Dessert.php</i> as shown in <a href="#lis19-16">Listing 19-16</a>.</p>
<span id="lis19-16"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">class Dessert extends Food</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">{</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    public function __toString(): string</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
        $message = parent::__toString();&#13;
        $message .= " I am a Dessert!";&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        return $message;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">}</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-16: The updated</span> <span class="TheSansMonoCd_W5Regular_Italic_11">__toString()</span> <span class="SANS_Futura_Std_Book_Oblique_11">method of the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Dessert</span> <span class="SANS_Futura_Std_Book_Oblique_11">subclass</span></p>
<p class="TX">We invoke the <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method of the superclass (<span class="SANS_TheSansMonoCd_W5Regular_11">Food</span>), storing the result into the <span class="SANS_TheSansMonoCd_W5Regular_11">$message</span> variable. To access the superclass method, we use the <span aria-label="372" epub:type="pagebreak" id="pg_372" role="doc-pagebreak"/>keyword <span class="SANS_TheSansMonoCd_W5Regular_11">parent</span>, then the double-colon <i>scope-resolution operator</i> (<span class="SANS_TheSansMonoCd_W5Regular_11">::</span>), then the name of the method. Next, we use string concatenation to append <span class="SANS_TheSansMonoCd_W5Regular_11">" I am a Dessert!"</span> to the end of the message. All this happens within the definition of the <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> class’s <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method, meaning we’re still technically overriding the <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method from the superclass. It’s just that we’re using <span class="SANS_TheSansMonoCd_W5Regular_11">parent</span> to access the method definition from the superclass as we override it.</p>
<p class="TX">Visit the index web page now and you should see the following:</p>
<pre><code>(FOOD) apple&#13;
(FOOD) strawberry cheesecake I am a Dessert!</code></pre>
<p class="BodyContinued">The string returned by the <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> object is a combination of the string <span class="SANS_TheSansMonoCd_W5Regular_11">"(FOOD) strawberry cheesecake"</span> generated by the <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span> class’s <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method, plus the <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> object–specific <span class="SANS_TheSansMonoCd_W5Regular_11">"I am a Dessert!"</span> message added to the end.</p>
<p class="TX">Instead of using <span class="SANS_TheSansMonoCd_W5Regular_11">parent::</span> to access a method from a superclass, you can explicitly refer to the superclass by name, such as <span class="SANS_TheSansMonoCd_W5Regular_11">Food::</span> in our example. This is most useful in multilevel class hierarchies (for example, <span class="SANS_TheSansMonoCd_W5Regular_11">D</span> is a subclass of <span class="SANS_TheSansMonoCd_W5Regular_11">C</span> is a subclass of <span class="SANS_TheSansMonoCd_W5Regular_11">B</span> is a subclass of <span class="SANS_TheSansMonoCd_W5Regular_11">A</span>), where you may wish to reference an inherited class higher up in the hierarchy rather than the direct parent. In this case, naming the class explicitly is the only option, since the <span class="SANS_TheSansMonoCd_W5Regular_11">parent</span> keyword always refers to the direct parent class.</p>
<p class="TX">One common reason to augment a method rather than fully override it is to create a constructor tailored to a subclass. If the subclass has all the properties of the superclass plus some of its own, it’s efficient to create a constructor that starts by using <span class="SANS_TheSansMonoCd_W5Regular_11">parent::__construct()</span> to invoke the superclass’s constructor and finishes by setting the properties specific to the subclass. This way, you get to reuse any validation or other important logic in the superclass constructor method.</p>
<blockquote>
<p class="Note"><span class="SANS_Dogma_OT_Bold_B_15">NOTE</span></p>
</blockquote>
<p class="NOTE-TXT"><i>Constructors are exempt from the method signature rules of the LSP. It’s okay if the parameter lists of the subclass and superclass constructors aren’t compatible, as when the subclass constructor has extra, mandatory parameters.</i></p>
<p class="TX">To demonstrate how to augment a constructor, we’ll add a new <span class="SANS_TheSansMonoCd_W5Regular_11">calories</span> property to <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> objects. Then we’ll create a constructor for <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> objects that augments the <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span> constructor by setting <span class="SANS_TheSansMonoCd_W5Regular_11">calories</span> as well as <span class="SANS_TheSansMonoCd_W5Regular_11">name</span>. Update the <i>src/Dessert.php</i> file to match the code in <a href="#lis19-17">Listing 19-17</a>.</p>
<span id="lis19-17"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">class Dessert extends Food</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">{</span>&#13;
    private int $calories;&#13;
&#13;
  <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> public function __construct(string $name, int $calories)&#13;
    {&#13;
        parent::__construct($name);&#13;
        $this-&gt;setCalories($calories);&#13;
    }&#13;
&#13;
<span aria-label="373" epub:type="pagebreak" id="pg_373" role="doc-pagebreak"/>  <span aria-label="annotation2" class="Code_CodeAnnotation">❷</span> public function setCalories(int $calories)&#13;
    {&#13;
        $this-&gt;calories = $calories;&#13;
    }&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    public function __toString(): string</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $message = parent::__toString();</span>&#13;
        $message .= " I am a Dessert containing $this-&gt;calories calories!";&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        return $message;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">}</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-17: Adding an augmented constructor to the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Dessert</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p>
<p class="TX">We declare the new <span class="SANS_TheSansMonoCd_W5Regular_11">calories</span> property and make it private (since we don’t have any subclasses of <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> for this project). Then we declare a constructor method that takes in two parameters, the name and calories for the new <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> object to be created <span aria-label="annotation1" class="CodeAnnotation">❶</span>. Within the method definition, we use <span class="SANS_TheSansMonoCd_W5Regular_11">parent::</span> to invoke the constructor method for the <span class="SANS_TheSansMonoCd_W5Regular_11">Food</span> superclass, setting the <span class="SANS_TheSansMonoCd_W5Regular_11">name</span> property in the process. Then we finish the <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> constructor by setting the <span class="SANS_TheSansMonoCd_W5Regular_11">calories</span> property for the object. We use the setter method <span class="SANS_TheSansMonoCd_W5Regular_11">setCalories()</span>, which we declare next <span aria-label="annotation2" class="CodeAnnotation">❷</span>. Finally, we update the <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method to also output the value of the <span class="SANS_TheSansMonoCd_W5Regular_11">calories</span> property for the object so we’ll know the code is working.</p>
<p class="TX">We now need to add a value for the <span class="SANS_TheSansMonoCd_W5Regular_11">calories</span> property in our index script when we create a <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> object. Update <i>public/index.php</i> to match the code in <a href="#lis19-18">Listing 19-18</a>.</p>
<span id="lis19-18"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">require_once __DIR__ . '/../src/Food.php';</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">require_once __DIR__ . '/../src/Dessert.php';</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">$f1 = new Food('apple');</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">print $f1;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">print '&lt;br&gt;';</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">$f2 =</span> new Dessert('strawberry cheesecake', 99);&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">print $f2;</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-18: Adding a</span> <span class="TheSansMonoCd_W5Regular_Italic_11">calories</span> <span class="SANS_Futura_Std_Book_Oblique_11">argument to the index script</span></p>
<p class="TX">We create a <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> object with two arguments corresponding to the <span class="SANS_TheSansMonoCd_W5Regular_11">name</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">calories</span> properties. Here’s the result of visiting the web page:</p>
<pre><code>(FOOD) apple&#13;
(FOOD) strawberry cheesecake I am a Dessert containing 99 calories!</code></pre>
<p class="BodyContinued">The second message demonstrates that both <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> object properties were successfully set by the class’s constructor method, which augments that of its superclass. Also, it shows that we successfully augmented the <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method of the <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> subclass with a call to its parent superclass <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method.</p>
</section>
<section aria-labelledby="sec8" epub:type="division">
<span aria-label="374" epub:type="pagebreak" id="pg_374" role="doc-pagebreak"/>
<h3 class="H1" id="sec8"><span id="toc-link_273"/><span class="SANS_Futura_Std_Bold_B_11">Preventing Subclassing and Overriding</span></h3>
<p class="TNI1">In certain situations, you might never want to allow a subclass to be created from a class you declare. In this case, declare the class with the <span class="SANS_TheSansMonoCd_W5Regular_11">final</span> keyword, which prevents other classes from extending (subclassing) the class. The keyword goes at the very start of the class declaration (for example, <span class="SANS_TheSansMonoCd_W5Regular_11">final class Dessert</span>). You can also add the <span class="SANS_TheSansMonoCd_W5Regular_11">final</span> keyword to the declaration of an individual method to prevent the method from being overridden by a subclass.</p>
<p class="TX">The use of <span class="SANS_TheSansMonoCd_W5Regular_11">final</span>, especially for whole classes, is the subject of heated debate in the OOP community. It’s wise to declare classes or methods as <span class="SANS_TheSansMonoCd_W5Regular_11">final</span> only if you have a good justification for doing so. For example, if you have an API library, you might declare a class as <span class="SANS_TheSansMonoCd_W5Regular_11">final</span> to prevent anyone from subclassing it, since you don’t want to allow or encourage programmers to expect different behaviors besides those declared in the API. The <span class="SANS_TheSansMonoCd_W5Regular_11">final</span> declaration also helps prevent code from breaking between versions and across updates: when a class is <span class="SANS_TheSansMonoCd_W5Regular_11">final</span>, changes to the class’s internal implementation (private methods and properties) won’t have any unintended consequences outside the class.</p>
<section aria-labelledby="sec9" epub:type="division">
<h4 class="H2" id="sec9"><span id="toc-link_274"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Declaring a Class final</span></h4>
<p class="TNI1">Let’s create an example of a <span class="SANS_TheSansMonoCd_W5Regular_11">final</span> class and see how an error occurs if we try to declare a subclass of it. Start a new project and create <i>src/Product.php</i> as shown in <a href="#lis19-19">Listing 19-19</a>.</p>
<span id="lis19-19"/>
<pre><code>&lt;?php&#13;
<span aria-label="annotation1" class="codeannotated_CodeAnnotation">❶</span> final class Product&#13;
{&#13;
    private int $skuId;&#13;
    private string $description;&#13;
&#13;
  <span aria-label="annotation2" class="Code_CodeAnnotation">❷</span> public function __construct(int $skuId, string $description)&#13;
    {&#13;
        $this-&gt;skuId = $skuId;&#13;
        $this-&gt;description = $description;&#13;
    }&#13;
&#13;
    public function getSkuId(): int&#13;
    {&#13;
        return $this-&gt;skuId;&#13;
    }&#13;
&#13;
    public function getDescription(): string&#13;
    {&#13;
        return $this-&gt;description;&#13;
    }&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-19: The</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Product</span> <span class="SANS_Futura_Std_Book_Oblique_11">class, declared as</span> <span class="TheSansMonoCd_W5Regular_Italic_11">final</span></p>
<p class="TX">We declare the <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span> class, designating it as <span class="SANS_TheSansMonoCd_W5Regular_11">final</span> <span aria-label="annotation1" class="CodeAnnotation">❶</span>. This simple class has properties for a stock keeping unit (SKU) number and a text <span aria-label="375" epub:type="pagebreak" id="pg_375" role="doc-pagebreak"/>description, which are set in the class’s constructor <span aria-label="annotation2" class="CodeAnnotation">❷</span>. It also has a getter method for each property.</p>
<p class="TX">Next, we’ll attempt to extend <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span> by declaring a subclass. Create <i>src/MyProduct.php</i> containing the code in <a href="#lis19-20">Listing 19-20</a>.</p>
<span id="lis19-20"/>
<pre><code>&lt;?php&#13;
class MyProduct extends Product&#13;
{&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-20: The</span> <span class="TheSansMonoCd_W5Regular_Italic_11">MyProduct</span> <span class="SANS_Futura_Std_Book_Oblique_11">subclass of</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Product</span></p>
<p class="BodyContinued">We declare that <span class="SANS_TheSansMonoCd_W5Regular_11">MyProduct</span> is a subclass of <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span>, while leaving its body blank.</p>
<p class="TX">Now create a <i>public/index.php</i> script that reads in the two class declarations, as shown in <a href="#lis19-21">Listing 19-21</a>.</p>
<span id="lis19-21"/>
<pre><code>&lt;?php&#13;
require_once __DIR__ . '/../src/Product.php';&#13;
require_once __DIR__ . '/../src/MyProduct.php';</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-21: An index script reading the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Product</span> <span class="SANS_Futura_Std_Book_Oblique_11">and</span> <span class="TheSansMonoCd_W5Regular_Italic_11">MyProduct</span> <span class="SANS_Futura_Std_Book_Oblique_11">declarations</span></p>
<p class="TX">We don’t need any more than these two <span class="SANS_TheSansMonoCd_W5Regular_11">require_once</span> statements to demonstrate that classes declared <span class="SANS_TheSansMonoCd_W5Regular_11">final</span> can’t be extended. Execute the index script and you should see this: <span class="SANS_TheSansMonoCd_W5Regular_11">Fatal error: Class MyProduct may not inherit from final class Product</span>.</p>
</section>
<section aria-labelledby="sec10" epub:type="division">
<h4 class="H2" id="sec10"><span id="toc-link_275"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Declaring a Method final</span></h4>
<p class="TNI1">Declaring specific methods <span class="SANS_TheSansMonoCd_W5Regular_11">final</span> prevents them from being overridden while still allowing the class to have subclasses. Among other applications, this technique ensures that a method has consistent validation logic at all levels of the class hierarchy.</p>
<p class="TX">To illustrate, let’s modify our <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span> class, removing its overall <span class="SANS_TheSansMonoCd_W5Regular_11">final</span> declaration and adding a new method to set the <span class="SANS_TheSansMonoCd_W5Regular_11">skuId</span> property. The method will have validation to ensure that the SKU number is greater than 0. We’ll declare this method <span class="SANS_TheSansMonoCd_W5Regular_11">final</span>, so no subclass can replace it with a method that doesn’t contain the validation logic. Update the <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span> class declaration as shown in <a href="#lis19-22">Listing 19-22</a>.</p>
<span id="lis19-22"/>
<pre><code>&lt;?php&#13;
class Product&#13;
{&#13;
    protected int $skuId;&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    private string $description;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    public function __construct(int $skuId, string $description)</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $this-&gt;skuId = $skuId;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $this-&gt;description = $description;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
&#13;
<span aria-label="376" epub:type="pagebreak" id="pg_376" role="doc-pagebreak"/><span class="TheSansMonoCd_W5Regular_Grey_11">    public function getSkuId(): int</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        return $this-&gt;skuId;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    public function getDescription(): string</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        return $this-&gt;description;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
&#13;
    final public function setSkuId(int $skuId): void&#13;
    {&#13;
        if ($skuId &gt; 0)&#13;
            $this-&gt;skuId = $skuId;&#13;
    }&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">}</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-22: Adding a</span> <span class="TheSansMonoCd_W5Regular_Italic_11">final</span> <span class="SANS_Futura_Std_Book_Oblique_11">method to the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Product</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p>
<p class="TX">We remove the <span class="SANS_TheSansMonoCd_W5Regular_11">final</span> keyword from the overall class declaration, allowing this class to be extended, and we change the visibility of the <span class="SANS_TheSansMonoCd_W5Regular_11">skuId</span> property to <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span> so it can be used in subclass methods. Then we add a new <span class="SANS_TheSansMonoCd_W5Regular_11">final</span> setter method for the <span class="SANS_TheSansMonoCd_W5Regular_11">skuId</span> property that confirms the desired value is greater than 0.</p>
<p class="TX">Now update the <span class="SANS_TheSansMonoCd_W5Regular_11">MyProduct</span> class to match the contents of <a href="#lis19-23">Listing 19-23</a>, where we attempt to override the <span class="SANS_TheSansMonoCd_W5Regular_11">setSkuId()</span> method.</p>
<span id="lis19-23"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">class MyProduct extends Product</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">{</span>&#13;
  <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> public function setSkuId(int $skuId): void&#13;
    {&#13;
        $this-&gt;skuId = $skuId;&#13;
    }&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">}</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 19-23: Overriding the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">setSkuId()</span> <span class="SANS_Futura_Std_Book_Oblique_11">method in</span> <span class="TheSansMonoCd_W5Regular_Italic_11">MyProduct</span></p>
<p class="TX">We attempt to declare a <span class="SANS_TheSansMonoCd_W5Regular_11">setSkuId()</span> method directly on the <span class="SANS_TheSansMonoCd_W5Regular_11">MyProduct</span> class <span aria-label="annotation1" class="CodeAnnotation">❶</span>, without the greater-than-zero validation check. This isn’t permitted, since the <span class="SANS_TheSansMonoCd_W5Regular_11">setSkuId()</span> method in the <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span> superclass has been declared <span class="SANS_TheSansMonoCd_W5Regular_11">final</span>. If you run the index script again, you should see another fatal error noting that the <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span> class’s <span class="SANS_TheSansMonoCd_W5Regular_11">setSkuId()</span> method can’t be overridden.</p>
</section>
</section>
<section aria-labelledby="sec11" epub:type="division">
<span aria-label="377" epub:type="pagebreak" id="pg_377" role="doc-pagebreak"/>
<h3 class="H1" id="sec11"><span id="toc-link_276"/><span class="SANS_Futura_Std_Bold_B_11">Summary</span></h3>
<p class="TNI1">In this chapter, we explored several OOP features, most notably inheritance between classes. We also covered the related topics of <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span> visibility, which enables access to inherited properties and methods by subclasses, as well as method overriding and the invocation of inherited method behavior with the <span class="SANS_TheSansMonoCd_W5Regular_11">parent</span> keyword. Finally, we looked at how to restrict the usage of classes and methods through the <span class="SANS_TheSansMonoCd_W5Regular_11">abstract</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">final</span> keywords.</p>
</section>
<section aria-labelledby="sec12" epub:type="division">
<h3 class="H1" id="sec12"><span id="toc-link_277"/><span class="SANS_Futura_Std_Bold_B_11">Exercises</span></h3>
<p class="ListNumber">1.   Implement the <span class="SANS_TheSansMonoCd_W5Regular_11">Jam</span> class diagrammed in <a href="#fig19-6">Figure 19-6</a>.</p>
<figure class="IMG"><a id="fig19-6"/><img alt="" class="img100" height="936" src="../images/figure19-6.jpg" width="1329"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 19-6: The</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">Jam</span> <span class="SANS_Futura_Std_Book_Oblique_11">class and its</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">$food1</span> <span class="SANS_Futura_Std_Book_Oblique_11">object</span></p></figcaption>
</figure>
<p class="ListBody">Write an index script to create the <span class="SANS_TheSansMonoCd_W5Regular_11">$food1</span> object of the <span class="SANS_TheSansMonoCd_W5Regular_11">Jam</span> class shown in the diagram. Use a <span class="SANS_TheSansMonoCd_W5Regular_11">print</span> statement to invoke the object’s <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method.</p>
<p class="ListNumber">2.   Make a copy of your project from Exercise 1. Create two new classes, <span class="SANS_TheSansMonoCd_W5Regular_11">Spread</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">Honey</span>, and simplify the <span class="SANS_TheSansMonoCd_W5Regular_11">Jam</span> class as shown in <a href="#fig19-7">Figure 19-7</a>. Note the visibility of the properties for the <span class="SANS_TheSansMonoCd_W5Regular_11">Spread</span> class: # for <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span> and + for <span class="SANS_TheSansMonoCd_W5Regular_11">public</span>.</p>
<span aria-label="378" epub:type="pagebreak" id="pg_378" role="doc-pagebreak"/>
<figure class="IMG"><a id="fig19-7"/><img alt="" class="img100" height="1325" src="../images/figure19-7.jpg" width="1338"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 19-7: The</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">Jam</span> <span class="SANS_Futura_Std_Book_Oblique_11">and</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">Honey</span> <span class="SANS_Futura_Std_Book_Oblique_11">subclasses inheriting from</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">Spread</span></p></figcaption>
</figure>
<p class="ListBody">Update your index script to create and print one <span class="SANS_TheSansMonoCd_W5Regular_11">Jam</span> object and one <span class="SANS_TheSansMonoCd_W5Regular_11">Honey</span> object.</p>
<p class="ListBody">Hint: You may wish to simplify your string-creation code by creating a private helper method <span class="SANS_TheSansMonoCd_W5Regular_11">manukaString()</span> that returns the string <span class="SANS_TheSansMonoCd_W5Regular_11">(Manuka)</span> or <span class="SANS_TheSansMonoCd_W5Regular_11">(NOT Manuka)</span> depending on the value of the <span class="SANS_TheSansMonoCd_W5Regular_11">isManuka</span> property.</p>
<p class="ListNumber">3.   Examine the <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">Van</span> classes in <a href="#fig19-8">Figure 19-8</a> and plan out an abstract superclass to hold the common members of both classes.</p>
<figure class="IMG"><a id="fig19-8"/><img alt="" class="img60" height="245" src="../images/figure19-8.jpg" width="760"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 19-8: The</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">Car</span> <span class="SANS_Futura_Std_Book_Oblique_11">and</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">Van</span> <span class="SANS_Futura_Std_Book_Oblique_11">classes</span></p></figcaption>
</figure>
<p class="ListBody">Declare your superclass, as well as the <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">Van</span> classes. Then write an index script that creates one <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> and one <span class="SANS_TheSansMonoCd_W5Regular_11">Van</span> object and uses <span class="SANS_TheSansMonoCd_W5Regular_11">print</span> statements to invoke their <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> methods.</p>
<p class="ListNumber"><span aria-label="379" epub:type="pagebreak" id="pg_379" role="doc-pagebreak"/>4.   Test out the use of the <span class="SANS_TheSansMonoCd_W5Regular_11">final</span> keyword to prevent subclasses. Make a copy of your project from Exercise 2 and replace the <span class="SANS_TheSansMonoCd_W5Regular_11">abstract</span> keyword with the <span class="SANS_TheSansMonoCd_W5Regular_11">final</span> keyword at the beginning of your <span class="SANS_TheSansMonoCd_W5Regular_11">Spread</span> class declaration. Run your index script, and the <span class="SANS_TheSansMonoCd_W5Regular_11">Jam</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">Honey</span> class declarations should trigger a fatal error.</p>
</section>
</section>
</div></body></html>