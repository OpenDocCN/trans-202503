- en: <hgroup>
  prefs: []
  type: TYPE_NORMAL
- en: B ARRAY AND HASH TABLE OBJECTS
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: </hgroup>
  prefs: []
  type: TYPE_NORMAL
- en: '![](../images/chapter.jpg)'
  prefs: []
  type: TYPE_IMG
- en: In [Chapter 29](chapter29.xhtml), I demonstrated how to build, access, and update
    arrays and hash tables. These data structures, not often associated with bat files,
    are great applications of the equally atypical real-world Batch objects discussed
    in [Chapter 33](chapter33.xhtml).
  prefs: []
  type: TYPE_NORMAL
- en: In this appendix, I’ll bring these concepts together by presenting a well-commented
    object bat file for each data structure.
  prefs: []
  type: TYPE_NORMAL
- en: The Array Object
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Here are the full contents of the array object, *oArray.bat*:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'This bat file should be called often, so I’m using :: (two colons) for the
    remarks instead of the rem command just to cut down on what the interpreter writes
    to stdout.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Every call to this object passes at least two arguments: the name of an array
    and the method or action being invoked; depending on the method, another argument
    or two might be required. You can add elements to the end of an array or at a
    specific index; you can retrieve the first element, the next element, or an element
    at a particular index. The object has methods for removing an element at a certain
    index, getting the size of the array, and clearing or emptying the array. You
    can get the index of the first instance of a specific value or retrieve a boolean
    telling you whether that value exists anywhere in the array. You can even clone
    or copy the array.'
  prefs: []
  type: TYPE_NORMAL
- en: Instead of stepping through each method, I’ll let the comments do the talking.
    Notice that I’ve included a brief description of each method along with their
    required arguments.
  prefs: []
  type: TYPE_NORMAL
- en: There are, however, a few interesting bits of code worthy of mention. You’ll
    find plenty of examples of delayed expansion in this listing. In fact, a couple
    methods use nested for commands solely because of delayed expansion; each for
    command transforms a variable assigned in the outer for command into a variable
    resolvable with percent signs ([Chapter 20](chapter20.xhtml)). Also, the :IndexOf
    and :Contains methods perform similar functions. Instead of duplicating work,
    the latter calls the former, converting the result into a boolean. Likewise, multiple
    methods retrieve the array size by calling :GetSize. The :Clone method assigns
    all variables associated with one array to another, taking advantage of text replacement
    and the fact that array elements are thinly disguised ordinary variables.
  prefs: []
  type: TYPE_NORMAL
- en: 'You can call the object from another bat file to perform all of these functions.
    Here’s a small sampling:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: This code populates oneFriend and anotherFriend with Maude and Donny, respectively.
  prefs: []
  type: TYPE_NORMAL
- en: For the sake of readability, this object has minimal error handling and validation
    of the incoming parameters, but these relatively few lines of code stand ready
    to create, modify, and access any number of arrays.
  prefs: []
  type: TYPE_NORMAL
- en: The Hash Table Object
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Here are the full contents of the hash table object, *oHashTable.bat*:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'This object also accepts at least two parameters: the name of a hash table
    and the method or action being invoked. You can add a key-value pair to the data
    structure by invoking the :Put method and retrieve a value given a key via the
    :Get method. Other methods clear the entire hash table or remove just one pair.
    You can get the number of pairs and retrieve a boolean showing whether a key or
    value is present, and as in the array object, there is a clone method.'
  prefs: []
  type: TYPE_NORMAL
- en: Each method and its corresponding parameters are described in the comments at
    the beginning of the bat file. The most interesting method is :ContainsValue,
    which preemptively sets the boolean to false before performing a search for the
    value by looking at every pair. However, determining whether a key exists in the
    hash table requires little more than an if defined.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here are a few lines of code demonstrating a simple test of the object’s features:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: The aJob variable contains the value Poet after the completion of these commands.
  prefs: []
  type: TYPE_NORMAL
- en: You can call this object from multiple bat files and even build multiple hash
    tables from a single process. Now look for other instances where you can keep
    your main code simple by placing the interesting logic in a reusable object bat
    file.
  prefs: []
  type: TYPE_NORMAL
