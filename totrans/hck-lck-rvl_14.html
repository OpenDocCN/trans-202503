<html><head></head><body>
<div id="sbo-rt-content">
<section epub:type="chapter" role="doc-chapter" aria-labelledby="ch10">

<hgroup>
<h2 class="CHAPTER" id="ch10">

<span class="CN"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_277" aria-label=" Page 277. "/><samp class="SANS_Futura_Std_Bold_Condensed_B_11">10</samp></span>

<span class="CT"><samp class="SANS_Dogma_OT_Bold_B_11">BLUELEAKS EXPLORER</samp></span>

</h2>
</hgroup>

<p class="COS">In some ways, I spent the summer of 2020 like many other Americans. I mostly stayed at home, avoiding COVID-19 like the plague it is; I spent far too many hours doom-scrolling through social media feeds; and occasionally I put on an N95 mask, grabbed some hand sanitizer, and hit the streets to protest the police killings of George Floyd, Breonna Taylor, and countless other Black Americans. But I also spent much of that summer writing code that would make it easier for me and other journalists at The Intercept to make sense of the sprawling BlueLeaks dataset.</p>

<p class="TX">My efforts culminated in a piece of open source software, which I released as part of this book, called BlueLeaks Explorer. BlueLeaks Explorer is a web application that allows you to examine the BlueLeaks data almost as if you could log in as an admin on the actual websites that were <span role="doc-pagebreak" epub:type="pagebreak" id="pg_278" aria-label=" Page 278. "/>hacked. BlueLeaks Explorer is a little like a large Python script that makes all of the CSVs in BlueLeaks easier to work with, like the scripts you wrote in <span class="Xref"><a href="chapter9.xhtml">Chapter 9</a></span>.</p>

<p class="TX">In this chapter, you’ll continue to investigate the BlueLeaks dataset, this time using BlueLeaks Explorer. I’ll give you a thorough overview of the software, including how to set it up on your own computer and how to start researching BlueLeaks with it. I’ll conclude the chapter by explaining the technology behind the app and pointing you to its Python source code on GitHub. If you ever need to develop an app to investigate a specific dataset, you can use this chapter as inspiration.</p>

<section epub:type="division" aria-labelledby="sec1">

<h3 class="H1" id="sec1"><span id="h-242"/><samp class="SANS_Futura_Std_Bold_B_11">Undiscovered Revelations in BlueLeaks</samp></h3>

<p class="TNI">As discussed in the previous chapter, my BlueLeaks investigation focused on the data from the <i>ncric</i> folder. Even within that folder, I concentrated on the final two weeks of data, focusing on police surveillance of the Black Lives Matter movement. Other journalists dug into different parts of the dataset, investigating fusion centers in places like Maine and Texas.</p>

<p class="TX">Notably, journalist Nathan Bernard broke several stories for the local news-and-arts magazine <i>Mainer</i> based on BlueLeaks documents from the Maine Information and Analysis Center (MIAC), Maine’s fusion center. These included stories about MIAC disseminating unverified rumors, sometimes based on satirical social media posts, that were first spread by far-right activists on social media and then included in FBI and DHS intelligence reports, similar to the FBI warning discussed in <span class="Xref"><a href="chapter9.xhtml">Chapter 9</a></span> about a George Soros<span class="symbol">−</span>funded group hiring “professional anarchists.” “This bogus intel gives cops a dangerously distorted sense of what to expect during demonstrations by portraying peaceful protesters as highly trained, paid and organized criminal actors intent on causing mayhem,” Bernard wrote in one article.</p>

<p class="TX">Additionally, John Anderson and Brant Bingamon wrote a series of articles for the <i>Austin Chronicle</i>, a local paper in Austin, Texas, based on BlueLeaks documents from the Austin Regional Intelligence Center (ARIC), Austin’s fusion center. Anderson wrote about ARIC’s practice of monitoring for and distributing lists of local Black Lives Matter protests (just like NCRIC did during the summer of 2020) and about several SARs posted to ARIC, including one where the “suspicious activity” was someone mailing a package of toys to Lebanon. Bingamon wrote stories revealing that ARIC had monitored local leftist groups in Austin, and that some ARIC courses for law enforcement teach junk science—including a technique for detecting deception called Scientific Content Analysis (SCAN), which a 2016 study concluded has “no empirical support” (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4766305/"><i>https://<wbr/>www<wbr/>.ncbi<wbr/>.nlm<wbr/>.nih<wbr/>.gov<wbr/>/pmc<wbr/>/articles<wbr/>/PMC4766305<wbr/>/</i></a>).</p>

<p class="TX">MIAC, ARIC, and NCRIC are some of the BlueLeaks sites that have received the most interest, but many more haven’t gotten any attention at all. By the end of this chapter, you’ll have all the tools you need to do a deep dive on any BlueLeaks folder you choose and search for newsworthy revelations. To start, you’ll install BlueLeaks Explorer in Exercise 10-1.</p>

</section>

<section epub:type="division" aria-labelledby="sec2">

<h3 class="H1F" id="sec2"><span id="h-243"/><span role="doc-pagebreak" epub:type="pagebreak" id="pg_279" aria-label=" Page 279. "/><samp class="SANS_Futura_Std_Heavy_B_21">Exercise 10-1: Install BlueLeaks Explorer</samp></h3>

<p class="TNI">You can find BlueLeaks Explorer’s source code at <a href="https://github.com/micahflee/blueleaks-explorer"><i>https://<wbr/>github<wbr/>.com<wbr/>/micahflee<wbr/>/blueleaks<wbr/>-explorer</i></a>. That GitHub page includes instructions on how to get it up and running locally on your computer, but I’ll explain all the steps in this exercise as well.</p>

<p class="TX">The BlueLeaks Explorer app is packaged as a Docker image and published to Docker Hub at <a href="https://hub.docker.com/r/micahflee/blueleaks-explorer"><i>https://<wbr/>hub<wbr/>.docker<wbr/>.com<wbr/>/r<wbr/>/micahflee<wbr/>/blueleaks<wbr/>-explorer</i></a>. You’ll run it locally on your computer using Docker and point it at your BlueLeaks folder. Before you begin, make sure you’ve completed the exercises in <span class="Xref"><a href="chapter5.xhtml">Chapter 5</a></span> so that you understand how to use Docker and Docker Compose.</p>

<section epub:type="division" aria-labelledby="sec3">

<h4 class="H2" id="sec3"><span id="h-244"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Create the Docker Compose Configuration File</samp></h4>

<p class="TNI">Start by creating a new folder called <i>blueleaks-explorer</i>. This folder will require about 5GB of disk space. Create a new file in that folder called <i>docker-compose.yaml</i> and open it in your text editor.</p>
<blockquote>

<p class="NOTE"><span class="NoteHead"><samp class="SANS_Dogma_OT_Bold_B_21">NOTE</samp></span></p>
</blockquote>

<p class="NOTE-TXT"><i>If you’re using Windows, I recommend that you follow this chapter in Ubuntu with WSL rather than PowerShell (see <a href="appendixA.xhtml">Appendix A</a> for information about performance issues you might encounter when using Docker in Windows). You can open an Ubuntu terminal, create the</i> <span class="note_Italic">blueleaks-explorer</span> <i>folder in your Linux filesystem using</i> <samp class="SANS_TheSansMonoCd_W7Bold_Italic_BI_11">mkdir blueleaks-explorer</samp><i>, and edit the</i> <span class="note_Italic">docker-compose.yaml</span> <i>file in VS Code by running</i> <samp class="SANS_TheSansMonoCd_W7Bold_Italic_BI_11">code docker-compose.yaml</samp><i>, all from Ubuntu.</i></p>

<p class="TX">Here’s how I created the folder and made the <i>docker-compose.yaml</i> file on my Mac. You can do the same in Linux or Windows with WSL:</p>

<pre id="pre-421"><code>micah@trapdoor ~ % <b>mkdir blueleaks-explorer</b>

micah@trapdoor ~ % <b>cd ~/blueleaks-explorer</b>

micah@trapdoor blueleaks-explorer % <b>code docker-compose.yaml</b></code></pre>

<p class="TX">Add the following code to your <i>docker-compose.yaml</i> file, replacing <samp class="SANS_TheSansMonoCd_W5Regular_Italic_I_11">/Volumes/datasets/BlueLeaks-extracted</samp> with the path that maps to <i>/data /blueleaks</i> in your own <i>BlueLeaks-extracted</i> folder:</p>

<pre id="pre-422"><code>version: "3.9"

services:

  app:

    image: micahflee/blueleaks-explorer:latest

    ports:

      - "8000:80"

    volumes:

      - <var>/Volumes/datasets/BlueLeaks-extracted</var>:/data/blueleaks

      - ./databases:/data/databases

      - ./structures:/data/structures</code></pre>

<p class="TX">This file describes the settings for the BlueLeaks Explorer Docker container. The container is called <samp class="SANS_TheSansMonoCd_W5Regular_11">app</samp> and is set to use the latest version of the <samp class="SANS_TheSansMonoCd_W5Regular_11">micahflee/blueleaks-explorer</samp> Docker container image, which you’ll <span role="doc-pagebreak" epub:type="pagebreak" id="pg_280" aria-label=" Page 280. "/>download from Docker Hub. The <samp class="SANS_TheSansMonoCd_W5Regular_11">ports</samp> section maps port 8000 on your computer to port 80 inside the container. This means that once the BlueLeaks Explorer app is running, you can load it on your browser at <i>http://<wbr/>localhost:8000</i>. The <samp class="SANS_TheSansMonoCd_W5Regular_11">volumes</samp> section maps folders on your machine to folders inside the container.</p>

<p class="TX">Save the <i>docker-compose.yaml</i> file.</p>

</section>

<section epub:type="division" aria-labelledby="sec4">

<h4 class="H2" id="sec4"><span id="h-245"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Bring Up the Containers</samp></h4>

<p class="TNI">In a terminal window, change to the <i>blueleaks-explorer</i> folder that you just made, then run this command to download the BlueLeaks Explorer Docker image and start the server:</p>

<pre id="pre-423"><code><b>docker-compose up</b></code></pre>

<p class="TX">The first time you run the command, the output should end with something like this:</p>

<pre id="pre-424"><code>blueleaks-explorer-app-1  |  * Serving Flask app 'app'

blueleaks-explorer-app-1  |  * Debug mode: off

blueleaks-explorer-app-1  |    WARNING: This is a development server. Do not use

                              it in a production deployment. Use a production

                              WSGI server instead.

blueleaks-explorer-app-1  |  * Running on all addresses (0.0.0.0)

blueleaks-explorer-app-1  |  * Running on http://127.0.0.1:80

blueleaks-explorer-app-1  |  * Running on http://172.19.0.2:80

blueleaks-explorer-app-1  |  Press CTRL+C to quit</code></pre>

<p class="TX">At this point, BlueLeaks Explorer is running on your computer, but it hasn’t been initialized. If you load <i>http://<wbr/>localhost:8000</i> in your browser, you should get an error telling you as much.</p>

</section>

<section epub:type="division" aria-labelledby="sec5">

<h4 class="H2" id="sec5"><span id="h-246"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Initialize the Databases</samp></h4>

<p class="TNI">The first time you use BlueLeaks Explorer, you must run a script to convert the many CSV files in BlueLeaks into SQLite databases. SQLite is lightweight SQL database software that can store a whole database in a single file (you’ll learn more about SQL databases in <span class="Xref"><a href="chapter12.xhtml">Chapter 12</a></span>). All of the CSVs in BlueLeaks were originally formatted as SQL tables, which the hacker exported into CSV format. Converting these CSV files back into database tables makes it easier for the Python code that runs BlueLeaks Explorer to query for and access items within those tables, then display them in the web app. For example, when searching for SARs that contain a specific string, BlueLeaks Explorer might search all the BriefSummary fields in the SARs table, trying to find reports that mention that string.</p>

<p class="TX">To initialize BlueLeaks Explorer, open a separate terminal window, change to your <i>blueleaks-explorer</i> folder, and run this command:</p>

<pre id="pre-425"><code><b>docker-compose exec app poetry run python ./initialize.py</b></code></pre>

<p class="TX"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_281" aria-label=" Page 281. "/>This will run <samp class="SANS_TheSansMonoCd_W5Regular_11">poetry run python ./initialize.py</samp> in your already running <samp class="SANS_TheSansMonoCd_W5Regular_11">app</samp> container. The <i>initialize.py</i> Python script will take a while to finish running, since it’s transforming thousands of CSV files into hundreds of SQLite databases; it took my computer about 50 minutes.</p>
<blockquote>

<p class="NOTE"><span class="NoteHead"><samp class="SANS_Dogma_OT_Bold_B_21">NOTE</samp></span></p>
</blockquote>

<p class="NOTE-TXT"><i>If you’re curious about the details of what the initialization script is doing, take a look at the source code. BlueLeaks Explorer is open source, meaning you can check out the</i> <span class="note_Italic">initialize.py</span> <i>file in the project’s git repository at</i> <a href="https://github.com/micahflee/blueleaks-explorer/blob/main/src/initialize.py"><span class="note_LinkURL">https://github.com/micahflee/blueleaks-explorer/blob/main/src/initialize.py</span></a><i>.</i></p>

<p class="TX">When <i>initialize.py</i> finishes running, refresh <i>http://<wbr/>localhost:8000</i> in your web browser to pull up BlueLeaks Explorer, as shown in <a href="#fig10-1">Figure 10-1</a>.</p>
<figure class="IMG"><img class="img100" id="fig10-1" src="Images/Figure10-1.png" alt="A screenshot of the BlueLeaks Explorer app, loaded in a web browser at http://localhost:8080. The app says, “Choose a site to explore,” and the only site listed is “Northern California Regional Intelligence Center.”" width="696" height="194"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 10-1: The freshly installed BlueLeaks Explorer app</samp></p></figcaption>

</figure>

<p class="TX">Each fusion center is unique: it’s run by different people, has different priorities and goals, and keeps track of different data. To make the best use of BlueLeaks Explorer, you need to spend some time understanding how the data in your target fusion center is laid out. I call this layout the <i>structure</i> of a BlueLeaks site. This refers to which tables contain useful information (some tables are empty or contain irrelevant data about the website layout), which columns in those tables are useful, and how the various tables are related.</p>

<p class="TX">The top of every page in BlueLeaks Explorer includes three links, as shown in <a href="#fig10-1">Figure 10-1</a>: Explore Data, Define Structure, and Browse Files. It would be difficult to automatically figure out the structure of a BlueLeaks site, in part because it’s subjective—individual users determine what information is interesting or useless for their purposes. Therefore, the Define Structure page brings you to an editor where you can define your own structures for BlueLeaks sites. Under Explore Data, you can find structures you’ve already created for individual BlueLeaks sites. Since you’re running BlueLeaks Explorer locally on your own computer, you’ll have access only to structures you’ve made yourself or that are included in the BlueLeaks Explorer Docker image. Finally, Browse Files lists all of the files in BlueLeaks, enabling you to link to specific documents or embed images; it’s simply a web interface to the raw BlueLeaks data, as if you were looking at it in a file browser.</p><span role="doc-pagebreak" epub:type="pagebreak" id="pg_282" aria-label=" Page 282. "/>

<blockquote>

<p class="NOTE"><span class="NoteHead"><samp class="SANS_Dogma_OT_Bold_B_21">NOTE</samp></span></p>
</blockquote>

<p class="NOTE-TXT"><i>If you set up a VPN to hide your IP address from fusion center websites as described in “Covering Your Tracks with a VPN Service” in <a href="chapter9.xhtml">Chapter 9</a>, you may want to use a VPN for this chapter as well. Though BlueLeaks Explorer is hosted on your own computer, viewing content within it might load images from fusion center sites, and clicking links could bring you to those sites.</i></p>

<p class="TX">In the following section, you’ll begin by exploring the data for the NCRIC site using a structure that I’ve already created.</p>

</section>
</section>

<section epub:type="division" aria-labelledby="sec6">

<h3 class="H1" id="sec6"><span id="h-247"/><samp class="SANS_Futura_Std_Bold_B_11">The Structure of NCRIC</samp></h3>

<p class="TNI">BlueLeaks Explorer allows you to browse and search all of the tables in any BlueLeaks site that you have a structure for. To demonstrate the features of the app—including listing the tables in a BlueLeaks site, viewing and searching the data in those tables, viewing data from related tables, and viewing images and documents associated with rows of data—you’ll start by exploring the NCRIC data. This will help you understand how structures are constructed before you make your own.</p>

<section epub:type="division" aria-labelledby="sec7">

<h4 class="H2" id="sec7"><span id="h-248"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Exploring Tables and Relationships</samp></h4>

<p class="TNI">As directed in Exercise 10-1, make sure your BlueLeaks Explorer Docker container is running and load <i>http://<wbr/>localhost:8000</i> in your browser. From the Explore Data section, click <b>Northern California Regional Intelligence Center</b>. <a href="#fig10-2">Figure 10-2</a> shows this page.</p>
<figure class="IMG"><img class="img100" id="fig10-2" src="Images/Figure10-2.png" alt="A screenshot of NCRIC data in BlueLeaks Explorer. It lists all of the useful tables—examples include 911Centers, AgencyNames, and EmailBuilder—and the number of rows in each table." width="695" height="446"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 10-2: Viewing the NCRIC tables in BlueLeaks Explorer</samp></p></figcaption>

</figure>

<p class="TX"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_283" aria-label=" Page 283. "/>Here, you can see a list of tables in the <i>ncric</i> folder, as well as the number of rows of data in each table. The EmailBuilder table has 5,213 rows, for example. I’ve hidden all of the tables that are empty or contain information I considered irrelevant so that they don’t show up here.</p>

<p class="TX">When I first defined the NCRIC structure, I started by exploring the data in each table, one at a time (I’ll explain how you can do this for other parts of BlueLeaks later in the chapter). I found that the following tables contained the most interesting and potentially newsworthy data:</p>

<p class="RunInPara"><b>EmailBuilder</b> Contains all of the bulk email NCRIC sends out to its large list of local police and private industry partners</p>

<p class="RunInPara"><b>EventBuilder</b> Describes events that NCRIC put on, complete with their descriptions, PDF flyers, and lists of who attended</p>

<p class="RunInPara"><b>FormBuilder</b><samp class="SANS_Portrait_Text_Heavy_B_227">(AA)</samp><samp class="SANS_Portrait_Text_Heavy_B_227">(AA)</samp>Contains a list of forms on NCRIC’s website for a variety of purposes, like submitting SARs, requesting technical help, or even registering for an account with the fusion center</p>

<p class="RunInPara"><b>Requests</b> Includes requests from local police for the fusion center’s assistance with tasks like monitoring social media and breaking into locked phones</p>

<p class="RunInPara"><b>SARs</b> Contains suspicious activity reports, which, as you learned in the previous chapter, are files submitted to NCRIC in which people report behavior that they believe could be criminal or otherwise suspicious</p>

<p class="RunInPara"><b>SurveyForm</b> Includes surveys that NCRIC requests from attendees of events it has hosted</p>

<p class="TX">Different tables within BlueLeaks relate to each other in various ways. For example, as you know from the previous chapter, many of the BlueLeaks sites include the tables Documents and DocumentCategory. Both of these tables contain a field called DocumentCategoryID. One row in the Documents table in the <i>ncric</i> folder, for instance, describes a document titled <i>FBI NSIR Tradecraft Alert Voter Suppression</i>. The DocFilename field contains the path of a PDF. The DocumentCategoryID is 167. Looking at the row with that DocumentCategoryID in the DocumentCategory table, you can see that the CategoryName is Elections. Now you know that NCRIC put this document in the Elections category. In database-speak, two tables that are connected via a shared field have a <i>relationship</i>. The SurveyForm table, which lists surveys for attendees of NCRIC-hosted events to fill out, is also related to the Survey table, which includes the actual survey feedback.</p>

<p class="TX">BlueLeaks Explorer makes it easy to quickly find related information within a BlueLeaks site. Click the Documents table from the list of tables shown in <a href="#fig10-2">Figure 10-2</a>. You should see a list of documents, each on its own row in the Documents table. In the Search field, enter <b>Voter Suppression</b> to bring up the FBI NSIR Tradecraft Alert Voter Suppression document, shown in <a href="#fig10-3">Figure 10-3</a>.</p>
<span role="doc-pagebreak" epub:type="pagebreak" id="pg_284" aria-label=" Page 284. "/>

<figure class="IMG"><img class="img100" id="fig10-3" src="Images/Figure10-3.png" alt="A screenshot showing the FBI NSIR Tradecraft Alert Voter Suppression document. The fields shown include DocTitle, DateEntered, CategoryName, and CategoryDescription. The record also includes a preview of the associated file, FBIVoter_Suppression_NSIR_final copy2.pdf." width="695" height="742"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 10-3: Viewing the FBI NSIR Tradecraft Alert Voter Suppression document in BlueLeaks Explorer</samp></p></figcaption>

</figure>

<p class="TX">When you view a document row using the NCRIC structure I defined, BlueLeaks Explorer will show you a link to the file itself—in this case, a PDF. It also shows a preview of the file if it’s available (the path to the preview image is listed in the PreviewImage field), along with the document category—in this case, Elections.</p>

<p class="TX">If you click the filename link, the PDF will open. Dated October 16, 2018, the document warns, “The FBI assesses threat actors may use social media, namely Facebook and Twitter, to suppress voter turnout by posting disinformation on when and how to vote in the 2018 midterm election.” It points out examples of voter suppression tactics on social media from the 2016 election, such as a Spanish-language meme claiming that you can vote for Hillary Clinton by texting “Hillary” to a specific phone number—tricking voters into falsely believing they voted for Clinton.</p>

<p class="TX">Next, click <b>Permalink</b> under the Elections category to get to the category itself. Your URL should now be <i>http://<wbr/>localhost:8000<wbr/>/ncric<wbr/>/DocumentCategory<wbr/>/167</i>, <span role="doc-pagebreak" epub:type="pagebreak" id="pg_285" aria-label=" Page 285. "/>and from here you should see all 11 documents categorized in Elections. You can click Permalink under any of those documents to view it. You can easily flip between documents and their categories in this way because I defined a relationship in the NCRIC structure between the Document and DocumentCategory tables. The permalink brings you to a unique URL just for that row. During an investigation, you can keep track of any interesting items in the dataset using their permalinks so you can easily refer back to them later on. The Show All link will show all of the hidden fields for this row. I’ve configured the Documents table to show only a handful of fields: DocTitle, DateEntered, DocFilename, URL, PreviewImage, and the DocumentCategory relationship. Clicking Show All will show you the remaining hidden fields as well.</p>

</section>

<section epub:type="division" aria-labelledby="sec8">

<h4 class="H2" id="sec8"><span id="h-249"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Searching for Keywords</samp></h4>

<p class="TNI">For a concrete example of how BlueLeaks Explorer makes it easier to investigate the BlueLeaks documents, let’s revisit the SAR described in <span class="Xref">“Investigating a SAR”</span> in <span class="Xref"><a href="chapter9.xhtml">Chapter 9</a>,</span> in which a lawyer reported a student protester. This time, instead of manually grepping CSV files and copying and pasting big blocks of text from fields in spreadsheets for easier reading, you’ll do it all in BlueLeaks Explorer.</p>

<p class="TX">Go back to the NCRIC list of tables, click <b>SARs</b>, and search for <b>antifa</b> to find that specific row. <a href="#fig10-4">Figure 10-4</a> shows the record. The File1 row should display a clickable link to the PDF originally attached to the SAR, allowing you to quickly open the document. If you click it, you’ll immediately be able to read the PDF in another browser tab.</p>
<figure class="IMG"><img class="img100" id="fig10-4" src="Images/Figure10-4.png" alt="A screenshot showing details of the specific SAR filed by an investigator at the Marin County DA’s office about a student protester." width="602" height="501"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 10-4: Viewing a SAR in BlueLeaks Explorer</samp></p></figcaption>

</figure>

<p class="TX"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_286" aria-label=" Page 286. "/>Now that you have an idea of how to navigate BlueLeaks Explorer, it’s your turn to explore other parts of the BlueLeaks dataset beyond NCRIC.</p>

</section>
</section>

<section epub:type="division" aria-labelledby="sec9">

<h3 class="H1" id="sec9"><span id="h-250"/><samp class="SANS_Futura_Std_Bold_B_11">Building Your Own BlueLeaks Structure</samp></h3>

<p class="TNI">In this section, you’ll learn how to define your own structure for another BlueLeaks site, the Los Angeles Joint Regional Intelligence Center (JRIC). By the end of this section, you’ll have the tools you need to create structures for all of the BlueLeaks sites.</p>

<p class="TX">Building out a BlueLeaks Explorer site structure takes work, but it also helps you gain a much clearer understanding of the data. Once you’ve started cleaning up a few of the tables, you can spend time reading them, looking for newsworthy revelations. As you read, you’ll probably end up tweaking the structure to help you in your research, and you’ll also likely start cleaning up new tables as you discover relationships to them.</p>

<section epub:type="division" aria-labelledby="sec10">

<h4 class="H2" id="sec10"><span id="h-251"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Defining the JRIC Structure</samp></h4>

<p class="TNI">Some structures, like the one I constructed for NCRIC, are already included with BlueLeaks Explorer. To either edit existing structures or define new ones, load BlueLeaks Explorer in your browser and click <b>Define Structure</b> at the top of the screen. <a href="#fig10-5">Figure 10-5</a> shows the page that should pop up.</p>

<p class="TX">On the Define Structure page, every structure that is already defined is listed under Edit Structures. In <a href="#fig10-5">Figure 10-5</a>, this is just a single structure, NCRIC. To edit a structure, simply click its name. The BlueLeaks sites that don’t yet have a structure are listed by their folder name under Define a New Structure, along with a button to create that new structure. Scroll down until you see the listing for <i>jric</i>, and click <b>Create</b>.</p>
<figure class="IMG"><img class="img100" id="fig10-5" src="Images/Figure10-5.png" alt="A screenshot showing the Define Structure page in BlueLeaks Explorer. All of the defined structures are listed under “Edit structures,” and all of the BlueLeaks sites that don’t have structures yet are listed under “Define a new structure.”" width="695" height="402"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11"><a href="#fig10-5">Figure 10-5</a>: Viewing the Define Structure page in BlueLeaks Explorer</samp></p></figcaption>

</figure>

<p class="TX"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_287" aria-label=" Page 287. "/>In the page that opens, you can configure exactly how BlueLeaks Explorer should work when you investigate the JRIC data, as shown in <a href="#fig10-6">Figure 10-6</a>. The top of the page displays the name of the site, which defaults to the BlueLeaks folder name, <i>jric</i>.</p>
<figure class="IMG"><img class="img100" id="fig10-6" src="Images/Figure10-6.png" alt="A screenshot of the BlueLeaks Explorer page for editing the JRIC structure. It shows all the tables in JRIC, all fields for each table, and several options to define how these tables and fields act and relate to each other." width="696" height="627"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 10-6: Editing the JRIC structure in BlueLeaks Explorer</samp></p></figcaption>

</figure>

<p class="TX">Click <b>Rename</b> next to the site name and enter <b>Los Angeles Joint Regional Intelligence Center</b>. Every time you make a change like this, you should see the message “You have unsaved changes,” with a Save button, in the bottom-right corner. Click <b>Save</b>.</p>

<p class="TX">Below the site name, the Edit Structure page lists all of the tables in this BlueLeaks site. Next to each table name is the Rename button, as well as buttons to show or hide the table. BlueLeaks Explorer automatically detects tables that don’t have any rows and hides them by default; this is why the ASIOptions table starts out hidden. You can also manually hide tables that you don’t care about to reduce clutter when you’re actually investigating this site later on.</p>

<p class="TX">Now that you’ve created the JRIC structure, open the <b>Explore Data</b> link at the top in a separate browser tab. You should see that the Los Angeles <span role="doc-pagebreak" epub:type="pagebreak" id="pg_288" aria-label=" Page 288. "/>Joint Regional Intelligence Center site has been added to the list of sites to explore. <a href="#fig10-7">Figure 10-7</a> shows the new Explore Data page.</p>
<figure class="IMG"><img class="img80" id="fig10-7" src="Images/Figure10-7.png" alt="A screenshot from the Explore Data page after creating the JRIC structure. The JRIC site appears on this page above NCRIC." width="526" height="120"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 10-7: The Explore Data page after you’ve created the JRIC structure</samp></p></figcaption>

</figure>

<p class="TX">Any additional structures you create for other BlueLeaks sites will also appear on this page.</p>

<p class="TX">Click the JRIC link to pull up all the tables in this site. As you work through the rest of the section, and when building a structure in BlueLeaks Explorer in general, keep two tabs open: the Explore Data and Define Structure pages. This way, when you save changes in the Define Structure tab, you can refresh the Explore Data tab to see them implemented.</p>

</section>

<section epub:type="division" aria-labelledby="sec11">

<h4 class="H2" id="sec11"><span id="h-252"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Showing Useful Fields</samp></h4>

<p class="TNI">In Exercise 9-3, you wrote a Python script to automatically create a spreadsheet mapping the names of BlueLeaks folders to their associated organizations. You found this information in <i>Company.csv</i>, a spreadsheet with 108 different columns. Only a few fields in this spreadsheet proved to be relevant, which makes this a good table for practicing showing only useful fields.</p>

<p class="TX">In your Explore Data tab, click the Company table. You should see the page shown in <a href="#fig10-8">Figure 10-8</a>. There are 7 rows displayed, each containing all 108 different fields, some of which include lots of HTML. Because each row has so many fields, this figure shows only the fields at the beginning of the first row of data.</p>

<p class="TX">The text in these fields isn’t very readable yet, but that’s easy to fix. Back in your Define Structure tab, scroll down until you find the Company table. For each field, you can choose the type from a drop-down menu and toggle a checkbox to set whether or not you want it to appear in the Explore Data page. For example, you probably don’t care about the value of BannerAdHeight, so you’d want to hide that field.</p>

<p class="TX">You can also click the checkbox next to Show at the top of the table to toggle all the checkboxes at once. Click it now to uncheck—that is, hide—all of the fields in the Company table. From here, you can scroll through and select only the most useful fields to display.</p>
<span role="doc-pagebreak" epub:type="pagebreak" id="pg_289" aria-label=" Page 289. "/>

<figure class="IMG"><img class="img100" id="fig10-8" src="Images/Figure10-8.png" alt="A screenshot showing data from the JRIC’s Company table. Every field is shown, including those that are useless, so it’s a lot to scroll through." width="696" height="701"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 10-8: Exploring data in JRIC’s Company table before editing the structure</samp></p></figcaption>

</figure>

<p class="TX">By reading through the Explore Data page, I can guess that the most useful fields include URL, InitialPage, SiteHeader, and CompanyName. Back on the Define Structure page, check the boxes next to these fields to show them and then click <b>Save</b>. Refresh the Explore Data page. It should now look like <a href="#fig10-9">Figure 10-9</a>.</p>

<p class="TX">The Explore Data page still lists all seven rows in the Company table, but this time it shows only the four specific fields you selected, which makes it much easier to read through. As you can see from the second row of data, the Explore Data page also hides empty fields—the leads.jric.org row doesn’t have anything in its SiteHeader field, so BlueLeaks Explorer skips that field.</p>

<p class="TX">You can still see all of the hidden fields for any row by clicking the Show All button below it. In the course of an investigation, you might discover that a field you chose to hide is actually useful, in which case you can edit the structure again to display it.</p>
<span role="doc-pagebreak" epub:type="pagebreak" id="pg_290" aria-label=" Page 290. "/>

<figure class="IMG"><img class="img100" id="fig10-9" src="Images/Figure10-9.png" alt="A screenshot showing JRIC’s Company table with most fields hidden." width="695" height="617"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 10-9: Viewing JRIC’s Company table with the irrelevant fields hidden</samp></p></figcaption>

</figure>
</section>

<section epub:type="division" aria-labelledby="sec12">

<h4 class="H2" id="sec12"><span id="h-253"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Changing Field Types</samp></h4>

<p class="TNI">The Explore Data page is much more readable now, but it’s still not perfect. The SiteHeader field is hard to read because it’s a block of HTML. It would also be nice if CompanyName appeared at the top of the list of fields. Let’s make one more change to fix that.</p>

<p class="TX">Every field in BlueLeaks Explorer starts out as text, and it’s up to you to change the type if you think there’s a better way to display that field. Here are all of the types that are available:</p>

<p class="RunInPara"><b>text</b> Displays the value as text; this is the default for all fields</p>

<p class="RunInPara"><b>html</b> Renders the value as an HTML web page</p>

<p class="RunInPara"><b>pre</b> Displays the field’s value as text in a fixed-width font and preserves all of the original spacing (see the BriefSummary field in <a href="#fig10-4">Figure 10-4</a> for an example)</p>

<p class="RunInPara"><b>image</b><samp class="SANS_Portrait_Text_Heavy_B_227">(AA)</samp><samp class="SANS_Portrait_Text_Heavy_B_227">(AA)</samp>Loads an image from a path directly in your browser; choose this type only if the field contains a path to an image (see the PreviewImage field in <a href="#fig10-3">Figure 10-3</a> for an example)</p>

<p class="RunInPara"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_291" aria-label=" Page 291. "/><b>attachment</b> Displays a filepath as a text link directly to the file; choose this type only if the field contains a path to a non-image file (see the DocFilename field in <a href="#fig10-3">Figure 10-3</a> for an example)</p>

<p class="RunInPara"><b>survey</b> Recognizes the format of SurveyData fields, which appear only in Survey tables and contain feedback from attendees of events hosted by fusion centers—and makes the results easier to read</p>

<p class="TX">Back in the Edit Structure tab, find the SiteHeader field. This field has a Type drop-down menu that’s currently set to text; switch it to <b>html</b>. Now scroll down until you find the CompanyName field. Click the grip icon to the left of it and drag it to the top of the list of fields. Click <b>Save</b> again and refresh the Explore Data tab. Your Company table should now look like <a href="#fig10-10">Figure 10-10</a>.</p>
<figure class="IMG"><img class="img100" id="fig10-10" src="Images/Figure10-10.png" alt="A screenshot showing JRIC’s Company table after editing its structure. The SiteHeader field is now rendered as HTML instead of text and the CompanyName is now listed first for each row." width="696" height="701"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 10-10: Exploring JRIC’s Company table after editing its structure</samp></p></figcaption>

</figure>

<p class="TX">Because you changed the SiteHeader field type from text to HTML, BlueLeaks Explorer renders it as HTML and loads the JRIC header <span role="doc-pagebreak" epub:type="pagebreak" id="pg_292" aria-label=" Page 292. "/>image hosted from JRIC’s web server. <a href="#fig10-10">Figure 10-10</a> also shows that the CompanyName field is now listed first for each row.</p>

</section>

<section epub:type="division" aria-labelledby="sec13">

<h4 class="H2" id="sec13"><span id="h-254"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Adding JRIC’s Leads Table</samp></h4>

<p class="TNI">In your Explore Data tab, go back to the JRIC table listing. This time, click the Leads table. If you read through its rows, you’ll see that this table is full of SARs. It’s similar to NCRIC’s SARs table, except that its leads are submitted by both the fusion center’s partners and members of the public, and it appears to retain data forever, whereas the NCRIC SARs table includes only one month’s worth of SARs. To get more practice using BlueLeaks Explorer, including setting up a relationship between two tables, you’ll define the structure for the Leads table next.</p>

<p class="TX">In your Define Structure tab, find the Leads table, hide all of its columns, and repeat the steps you followed with the Company table to show only the useful fields, selecting the most appropriate type for each. After reading through the first several rows of Leads data in the Explore Data tab, I decided to show FormTimeStamp, County, PhoneNum, EmailAddress, ActivityDate, ActivityTime, ActivityDetails, fullname, Information, NSFormName, FUpload, and FUploadName. Feel free to show or hide different fields yourself.</p>

<p class="TX">After saving the structure and refreshing the Explore Data page, I get these fields from the first row in the Leads table:</p>

<p class="RunInPara"><b>FormTimeStamp</b> 06/07/20 00:39:09</p>

<p class="RunInPara"><b>County</b> Los Angeles</p>

<p class="RunInPara"><b>PhoneNum</b> <i>[redacted]</i></p>

<p class="RunInPara"><b>EmailAddress</b> <i>[redacted]</i>@torrenceca.gov</p>

<p class="RunInPara"><b>ActivityDate</b> 06/06/20 00:00:00</p>

<p class="RunInPara"><b>ActivityTime</b> 1345</p>

<p class="RunInPara"><b>ActivityDetails</b> On the above date and time officers were dispatched to a call of a suspicious package. Upon, arrival [<i>sic</i>] officers noticed that the package had bottles with a cloth items [<i>sic</i>] sticking out of the top of the bottle resembling a Molotov Cocktail. This package was in the general area of a BLM protest that was going on. (see attached report and photos)</p>

<p class="RunInPara"><b>NSFormName</b> PublicCountyLeadSheet</p>

<p class="RunInPara"><b>FUpload</b> LFU00010\984.docx</p>

<p class="RunInPara"><b>FUploadName</b> 200020437.docx</p>

<p class="TX">The FUpload and FUploadName fields both contain filenames. Notice that FUpload seems to be the path to a file inside the BlueLeaks dataset. Back in the Define Structure page, change the type of FUpload from text to attachment, save your changes, and refresh the Explore Data page. The FUpload field should now link to <i>http://<wbr/>localhost:8000<wbr/>/blueleaks<wbr/>-data<wbr/>/jric<wbr/>/files<wbr/>/LFU00010<wbr/>/984<wbr/>.docx</i>, which loads the document from your local copy of the <span role="doc-pagebreak" epub:type="pagebreak" id="pg_293" aria-label=" Page 293. "/>data. You can click this link to read it if you’re curious. The filename is <i>984.docx</i>, but it appears that the person who submitted this lead originally uploaded the file as <i>2000020437.docx</i>.</p>

<p class="TX">Looking through other rows in this Leads table, I also notice that values in the NSFormName field are different for different leads. My guess is that this field describes which form was filled out to add this lead to JRIC’s database. Most of the values for NSFormName appear to be PublicCountyLeadSheet or LeadSheetPrivateSectorAndPublic. Is the Leads table related to some other table that describes forms? Let’s find out.</p>

</section>

<section epub:type="division" aria-labelledby="sec14">

<h4 class="H2" id="sec14"><span id="h-255"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Building a Relationship</samp></h4>

<p class="TNI">Go back to the page listing all of the tables in JRIC and click the table named FormBuilder. This table doesn’t have a field called NSFormName, but it does have one called FormName. If you search the table for PublicCountyLeadSheet and LeadSheetPrivateSectorAndPublic, you will see that the row with ID 1 has a FormName value of PublicCounty LeadSheet, and the row with ID 2 has a FormName value of LeadSheet PrivateSectorAndPublic. (From the FormBuilder table page, you could sort it by FormBuilderID ascending to see these first two rows in that table as well.) Because the NSFormName field on the Leads table maps to the FormName field on the FormBuilder table, there’s a relationship between these two tables. Let’s create that relation in BlueLeaks Explorer.</p>

<p class="TX">Back in the Define Structure page, scroll down to the bottom of the Leads table. After the list of fields, there’s another section that says Field Maps to Table. Both Field and Table are drop-down menus. Click the Field drop-down menu to list all of the fields in this table and select <b>NSFormName</b>. Click the Table drop-down menu, which lists all of the other tables in this BlueLeaks site, and choose <b>FormBuilder</b>. Once you select the table, you should see a third drop-down menu that lets you choose the field in that table. Choose <b>FormName</b> and click <b>Create Relationship</b>. A prompt should pop up, asking, “What is the name of this relationship?” Enter <b>Form</b> and click <b>OK</b>, then save your changes.</p>

<p class="TX">Back in the Explore Data tab, navigate back to the Leads table. For each lead, you should now see all of the fields from the form that was used to submit the lead. However, as <a href="#fig10-11">Figure 10-11</a> shows, it’s difficult to read.</p>

<p class="TX">As you can see, the related form is displayed, but, like the Company table you worked with previously, far too many fields are shown, including blocks of HTML that are difficult to make sense of. To fix this, you’ll edit the structure of the FormBuilder table as you did with the Company and Leads tables. As you build structures, I recommend finishing one table so that it displays nicely, then moving on to related ones.</p>
<span role="doc-pagebreak" epub:type="pagebreak" id="pg_294" aria-label=" Page 294. "/>

<figure class="IMG"><img class="img100" id="fig10-11" src="Images/Figure10-11.png" alt="The Molotov Cocktail lead described in the text, now showing the fields from the form filled out to submit it." width="845" height="370"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 10-11: An item in the JRIC Leads table, now with a relationship to the FormBuilder table</samp></p></figcaption>

</figure>

<p class="TX">Go back to the Define Structure tab, find the FormBuilder table, and hide all of its fields. Check the boxes to show FormName and FormContent, and change FormContent’s type from text to <b>html</b>. You already added a relationship to the Leads table that links it to the FormBuilder table, so while you’re here, create a relationship in the other direction as well. Scroll down to the bottom of the FormBuilder table and add a new relationship: map the FormName field to the Leads table’s NSFormName field. This time, when you create the relationship, name it <i>Submissions</i>. Save your changes in the Define Structure tab.</p>

<p class="TX">In your Explore Data tab, navigate to the Leads page again to see what it looks like. Now as you scroll through each lead, you can see which form was filled out to submit it. <a href="#fig10-12">Figure 10-12</a> shows a different example from the Leads table.</p>

<p class="TX">In this case, a member of the public rather than a fusion center member filled out this form, using a fake name and email address (John Doe and <i>idont@thinkso.org</i>). They wrote a message, in all caps, about a fireworks store in Pahrump, Nevada, just over the border from California:</p>
<blockquote>

<p class="EX">ON SATURDAYS, ALL 3 STORES ARE PACKED AND OVER 90% OF THE TRAFFIC IS FROM CA. THEY ARE ALSO ALMOST ALL BLACK OR MEXICAN. NO DISRESPECT TO RACE, BUT DOESNT THAT SORT OF MEET YOUR PROFILE OF PROBLEMS LATELY? I DONT REALLY CARE ABOUT THE CAUSES EITHER WAY, BUT THE UNREST IS HURTING TRUMP. I WOULD BET YOU HAVE A FEW ANTIFA PEOPLE BUYING FIREWORKS TO CAUSE TROUBLE. JUST THOUGHT I WOULD MENTION IT.</p>
</blockquote>

<span role="doc-pagebreak" epub:type="pagebreak" id="pg_295" aria-label=" Page 295. "/>

<figure class="IMG"><img class="img100" id="fig10-12" src="Images/Figure10-12.png" alt="A screenshot showing a lead submitted by a member of the public, in the JRIC database, complete with the form that was used to submit it." width="846" height="764"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 10-12: An item in the JRIC Leads table, with a cleaned-up relationship to the FormBuilder table</samp></p></figcaption>

</figure>

<p class="TX">BlueLeaks Explorer shows you LeadSheetPrivateSectorAndPublic, the form that was filled out to submit this lead. Scroll to the bottom of the form and click <b>Permalink</b> to go to a page that shows just the LeadSheetPrivateSectorAndPublic form in the FormBuilder table. Because of the Submissions relationship you created, this page should show you everything that was submitted to JRIC using this form—all 1,949 leads submitted by the public.</p>

</section>
</section>

<section epub:type="division" aria-labelledby="sec15">

<h3 class="H1" id="sec15"><span id="h-256"/><samp class="SANS_Futura_Std_Bold_B_11">Verifying BlueLeaks Data</samp></h3>

<p class="TNI">Whenever you’re looking at leaked or hacked data, you should always do additional research outside of the dataset itself to help verify that the data is authentic and put it into context. By looking at the Company table in the previous section, you learned that the JRIC site is hosted at <a href="https://www.jric.org"><i>https://<wbr/>www<wbr/>.jric<wbr/>.org</i></a>. <span role="doc-pagebreak" epub:type="pagebreak" id="pg_296" aria-label=" Page 296. "/>Load that link in Tor Browser (covered in <span class="Xref"><a href="chapter2.xhtml">Chapter 2</a></span>) or while connected to a VPN, and check out the JRIC website.</p>

<p class="TX">At the time of writing, I could tell from the website that this fusion center focuses on the Los Angeles area. Some of the BlueLeaks sites went offline after the hack in 2020, but many, like JRIC, remained online. <a href="#fig10-13">Figure 10-13</a> shows JRIC’s website, loaded anonymously in Tor Browser.</p>
<figure class="IMG"><img class="img100" id="fig10-13" src="Images/Figure10-13.png" alt="The home page of JRIC’s website, loaded in Tor Browser." width="695" height="384"/>

<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 10-13: The home page of JRIC’s website,</samp> <samp class="SANS_Futura_Std_Book_11"><a href="https://www.jric.org">https://www.jric.org</a>,</samp> <samp class="SANS_Futura_Std_Book_Oblique_I_11">loaded in Tor Browser</samp></p></figcaption>

</figure>

<p class="TX">It wasn’t clear to me that JRIC was a fusion center focused on Los Angeles, or what its mission was, until I viewed its website. If you click around the JRIC site to get a better understanding of the types of information it collects, you can then use BlueLeaks Explorer to view that information. For example, if you click the Submit a SAR link at the top of the home page, you can find the forms that add SARs to the Leads table.</p>

<p class="TX">You’ve only explored a small amount of content in the JRIC data so far. Now it’s time to finish building the structure so you can explore the rest.</p>

</section>

<section epub:type="division" aria-labelledby="sec16">

<h3 class="H1F" id="sec16"><span id="h-257"/><samp class="SANS_Futura_Std_Heavy_B_21">Exercise 10-2: Finish Building the Structure for JRIC</samp></h3>

<p class="TNI">In the previous sections, you started building the structure for the JRIC data. You cleaned up the Company, Leads, and FormBuilder tables and created a relationship between the latter two tables, allowing you to see which form was submitted to create each lead and which leads were created from each form. In this exercise, you’ll use your newfound knowledge to finish defining the structure for the other tables in JRIC. This will give you a clearer understanding of exactly what data was stored there, making it much easier to continue your investigation. It will also give you practice creating structures for the rest of the BlueLeaks sites.</p>

<p class="TX"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_297" aria-label=" Page 297. "/>You can play with BlueLeaks Explorer however you wish to customize the JRIC structure to suit your preferences. However, if you’re not sure where to start, I recommend beginning with the first table (AgencyNames), then the second (Align), and so on, finishing with the last table (VideoOptions). If you run into a table that has a relationship to another table, work on the related table first before you continue down the list.</p>

<p class="TX">For example, here’s how I’d start the AgencyNames table. In the Explore Data tab, in the list of JRIC tables, click <b>AgencyNames</b>. This table has 1,396 rows, and each row has just two fields: AgencyNamesID and AgencyName. The names appear to be various military agencies, police departments, school districts, and other organizations—my guess is these are all of JRIC’s partners. This data is pretty easy to read and search by itself, so I’d consider this table done already.</p>

<p class="TX">Still in the Explore Data tab, I’d move on to the Align table. This has just three rows, with the Align field as Left, Right, or Center. This table is completely useless for the purposes of an investigation. In the Define Structure tab, find the Align table, click the <b>Hide</b> button, then click <b>Save</b>. Back in the Explore Data tab, refresh the page, and you’ll see that the Align table has disappeared.</p>

<p class="TX">I find that when building a BlueLeaks Explorer structure, it helps to read some raw data to begin with, just to try to understand what it is and how it should be formatted. If you see any fields that are obviously HTML, for example, change their type from text to <b>html</b>. Once you have an understanding of what the important fields are, you can hide the rest. And once you’re done deciding what fields to show and what their types should be, you can add any relationships as appropriate.</p>

<p class="TX">Once you’ve structured the JRIC data to more easily explore it, do some investigating. The JRIC data includes an entire series of training videos for the Terrorism Liaison Office, split into different modules. Check out the Video and VideoCategory tables; at the time of writing, no one has reported on this information.</p>

<p class="TX">Now that you know how to define structures in BlueLeaks Explorer, you can do the same for any other sites in the BlueLeaks dataset to investigate them in greater depth. BlueLeaks Explorer is most useful when paired with a tool like Aleph, described in <span class="Xref"><a href="chapter5.xhtml">Chapter 5</a></span>, that indexes the data so you can search it for keywords. If you index all of the data in BlueLeaks, you can search it all at once to find documents in various BlueLeaks sites. Then, once you discover the sites you’re interested in, you can do a deep dive on them using BlueLeaks Explorer.</p>

</section>

<section epub:type="division" aria-labelledby="sec17">

<h3 class="H1" id="sec17"><span id="h-258"/><samp class="SANS_Futura_Std_Bold_B_11">The Technology Behind BlueLeaks Explorer</samp></h3>

<p class="TNI">Sometimes a dataset is so complicated—and so newsworthy—that it’s worth writing a custom application just to help you make sense of it. BlueLeaks Explorer is one such application. The information covered in this book, especially in <span class="Xref"><a href="chapter7.xhtml">Chapters 7</a></span> and <span class="Xref"><a href="chapter8.xhtml">8</a></span>, provides a solid foundation for <span role="doc-pagebreak" epub:type="pagebreak" id="pg_298" aria-label=" Page 298. "/>the additional independent research required to build an app like this yourself.</p>

<p class="TX">There are many different ways to go about writing custom apps for investigating datasets. In this section, I describe the technologies and libraries I used to develop BlueLeaks Explorer: first those I used to build the <i>backend</i> (the web server), then those I used for the <i>frontend</i> (the user interface that runs in a web browser). I personally like this <i>tech stack</i>, or combination of technologies an app uses, but this is by no means an exhaustive list of possibilities. Most of the technologies described here are outside the scope of this book; this section provides just a brief introduction to inspire future research.</p>

<p class="TX">If you feel confident in your programming skills and are inclined to do so, you can make improvements to my BlueLeaks Explorer code in the git repo and submit them back into the project, since it’s open source.</p>

<section epub:type="division" aria-labelledby="sec18">

<h4 class="H2" id="sec18"><span id="h-259"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">The Backend</samp></h4>

<p class="TNI">I developed the backend of BlueLeaks Explorer in Python, relying on a third-party Python package called Flask, a simple framework for building web apps. You can learn more about using Flask at <a href="https://flask.palletsprojects.com"><i>https://<wbr/>flask<wbr/>.palletsprojects<wbr/>.com</i></a>. You can also check out the source code for BlueLeaks Explorer, specifically <i>app.py</i> at <a href="https://github.com/micahflee/blueleaks-explorer/blob/main/src/app.py"><i>https://<wbr/>github<wbr/>.com<wbr/>/micahflee<wbr/>/blueleaks<wbr/>-explorer<wbr/>/blob<wbr/>/main<wbr/>/src<wbr/>/app<wbr/>.py</i></a>, to see exactly how I used Flask for this project.</p>

<p class="TX">The backend also makes use of built-in Python modules, primarily <samp class="SANS_TheSansMonoCd_W5Regular_11">json</samp> (which you’ll learn about in the next chapter) and <samp class="SANS_TheSansMonoCd_W5Regular_11">sqlite3</samp>, which lets you run SQL queries on the SQLite databases that represent BlueLeaks sites. When a web browser loads the web server powered by Flask, the web server responds with HTML that loads some JavaScript code. This is the frontend, described in the following section.</p>

<p class="TX">The backend also implements an API, which allows the frontend to communicate with it. For example, when the frontend wants to know the list of sites that already have structures, it can load <i>/api/sites</i> on the backend, which returns this data in JSON format. If it wants to retrieve data in JSON format from a specific table on a specific site, it can load <i>/api/</i><span class="symbol_Italic">&lt;</span><i>site</i><span class="symbol_Italic">&gt;</span><i>/</i><span class="symbol_Italic">&lt;</span><i>table</i><span class="symbol_Italic">&gt;</span>. In this case, the Python code uses the <samp class="SANS_TheSansMonoCd_W5Regular_11">sqlite3</samp> module to look up this data in the SQlite3 database for that BlueLeaks site, and then returns what it finds to the frontend.</p>

</section>

<section epub:type="division" aria-labelledby="sec19">

<h4 class="H2" id="sec19"><span id="h-260"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">The Frontend</samp></h4>

<p class="TNI">To develop web applications, you’ll have to program not in Python but in JavaScript, since this is the programming language that web browsers understand. I developed the frontend of BlueLeaks Explorer using a JavaScript framework called Vue.js (<a href="https://vuejs.org"><i>https://<wbr/>vuejs<wbr/>.org</i></a>). If you’re like me and find that you really enjoy writing code, I recommend that you try learning JavaScript so that you can make web applications. You can find the frontend source code at <a href="https://github.com/micahflee/blueleaks-explorer/tree/main/src/frontend/src"><i>https://<wbr/>github<wbr/>.com<wbr/>/micahflee<wbr/>/blueleaks<wbr/>-explorer<wbr/>/tree<wbr/>/main<wbr/>/src<wbr/>/frontend<wbr/>/src</i></a>.</p>

<p class="TX"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_299" aria-label=" Page 299. "/>Using Vue.js, the BlueLeaks Explorer frontend includes a series of pages designed to display data it retrieves by making HTTP requests to the backend. When you save a structure that you’re working on in BlueLeaks Explorer, the frontend also sends data to the backend, which then saves the structure as a JSON file.</p>

</section>
</section>

<section epub:type="division" aria-labelledby="sec20">

<h3 class="H1" id="sec20"><span id="h-261"/><samp class="SANS_Futura_Std_Bold_B_11">Summary</samp></h3>

<p class="TNI">In this chapter, you got BlueLeaks Explorer up and running locally on your computer using Docker. You’ve learned how to define structures for each BlueLeaks site, make the data in the tables easier to read, and create relationships between tables. Now that you have the skills required to investigate anything in the sprawling BlueLeaks dataset, let me know if you find any revelations!</p>

<p class="TX">In the next chapter, you’ll learn more about the JSON file format. You’ll work with a dataset containing a million JSON files related to the January 6, 2021, attack on the US Capitol and continue to hone your Python skills by writing code to find the most important files within it.</p>

</section>
</section>

</div></body></html>