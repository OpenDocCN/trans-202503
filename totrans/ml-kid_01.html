<html><head></head><body><div id="sbo-rt-content"><section>
<header>
<figure class="opener">
<img src="Images/chapterart.png" alt=""/>
</figure>
<h1 class="chapterTitle">
<span class="ChapterNumber"><span epub:type="pagebreak" title="19" id="Page_19"/>3</span><br/>
<span class="ChapterTitle">Sorting Animal Pictures</span>
</h1>
</header>
<p class="ChapterIntro"><span class="OpenerCap"><img src="Images/Alphabet-W.png" alt="Alphabet-W" class="dropcap"/></span>e all love pictures. We take over a trillion digital photos every year, and that doesn’t even include other types of pictures that we make, like drawings and paintings. </p>
<p><span epub:type="pagebreak" title="20" id="Page_20"/>Using computers to sort pictures and help us find the ones we need is called <em>image recognition</em><em/>. To create an image recognition system, we collect lots of pictures of the same subject. Then we use those pictures to train an ML <em>model</em>, which identifies what those pictures have in common and uses that to recognize new pictures. </p>
<p>For example, if we want to train a computer to recognize photos of kittens, we collect lots of photos of kittens. ML systems use these photos to learn the shapes, patterns, and colors that often show up in kitten photos. The model can then recognize whether a photo has a kitten in it.</p>
<p>People use image recognition every day. Online photo-sharing tools use it to help sort the photos that we upload. Websites use it to describe the contents of photos to help people with visual disabilities know what’s in photos even if they can’t see them. Social media websites use it to recognize the faces of our friends and family in the photos we post. Companies use it to track when their logos or products are included in photos posted online so they know when they’re being talked about on social media. More importantly, doctors use it to help them recognize medical conditions in patients’ scans and photos. Doctors need to remember many different symptoms and signs of illness, so image recognition systems can help them by identifying things like skin tumors in photographs or cancer in a microscopic picture of a cell. </p>
<p>In this chapter, you’ll make your own image recognition system by training an ML model to recognize and automatically sort photos of animals. Let’s get started!</p>
<h2 id="h1-500563c03-0001">Build Your Project</h2>
<p class="BodyFirst">First, choose two types of animals that you want the computer to recognize. For this chapter, I chose cows and sheep to make a farm-themed Scratch project (see <a id="figureanchor3-1" href="#figure3-1">Figure 3-1</a>). You can choose any two animals you’d like, as long as you can easily find lots of photos of them.</p>
<span epub:type="pagebreak" title="21" id="Page_21"/><figure>
<img src="Images/f03001.png" alt="f03001"/>
<figcaption><p><a id="figure3-1" href="#figureanchor3-1">Figure 3-1:</a> Sorting photos of animals into groups</p></figcaption>
</figure>
<h3 id="h2-500563c03-0001">Train Your Model</h3>
<p class="BodyFirst">To train the computer to recognize different pictures of your two animals, you’ll need to collect lots of images of those animals and use them to train an ML model.</p>
<ol>
<li value="1">Create a new ML project, enter <code class="bold">Animal sorter</code> as its name, and set it to learn to recognize images.
<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<h2><span class="NoteHead">Note	</span></h2>
<p>If you’re not sure how to create an ML project, read the section <span class="xref" itemid="xref_target_“Creating a New ML Project” on page 9">“Creating a New ML Project” on page 9</span> in Chapter 2.</p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
</li>
<li value="2">Click <b>Train</b>, as shown in <a id="figureanchor3-2" href="#figure3-2">Figure 3-2</a>.
<span epub:type="pagebreak" title="22" id="Page_22"/><figure>
<img src="Images/f03002.png" alt="f03002"/>
<figcaption><p><a id="figure3-2" href="#figureanchor3-2">Figure 3-2:</a> Train is the first phase of an ML project.</p></figcaption>
</figure>
</li>
<li value="3">Click <b>Add new label</b> (see <a id="figureanchor3-3" href="#figure3-3">Figure 3-3</a>). Then enter the name of your first type of animal. 
<figure>
<img src="Images/f03003.png" alt="f03003"/>
<figcaption><p><a id="figure3-3" href="#figureanchor3-3">Figure 3-3:</a> Click <b>Add new label</b> to create a new bucket of training examples.</p></figcaption>
</figure>
</li>
<li value="4">Open a second window in your web browser (usually by selecting <b>File</b><span class="MenuArrow">▶</span><b>New Window</b>) and arrange your two windows side by side, as shown in <a id="figureanchor3-4" href="#figure3-4">Figure 3-4</a>. In the second window, search for photos of the first type of animal. In my case, I’ve searched for photos of cows.
<span epub:type="pagebreak" title="23" id="Page_23"/><figure>
<img src="Images/f03004.png" alt="f03004"/>
<figcaption><p><a id="figure3-4" href="#figureanchor3-4">Figure 3-4:</a> Arrange your two web browser windows side by side. </p></figcaption>
</figure>
</li>
<li value="5">Drag a photo from the search window and drop it into the training bucket for your first type of animal. You should see a thumbnail version of the photo in your training bucket, as shown in <a id="figureanchor3-5" href="#figure3-5">Figure 3-5</a>. If you don’t see it, try dragging and dropping the photo again.
<figure>
<img src="Images/f03005.png" alt="f03005"/>
<figcaption><p><a id="figure3-5" href="#figureanchor3-5">Figure 3-5:</a> Dropping photos of cows into my training bucket</p></figcaption>
</figure>
</li>
<li value="6"><span epub:type="pagebreak" title="24" id="Page_24"/>Repeat step 5 until you have at least 10 different photos of that animal, as shown in <a id="figureanchor3-6" href="#figure3-6">Figure 3-6</a>.
<figure>
<img src="Images/f03006.png" alt="f03006"/>
<figcaption><p><a id="figure3-6" href="#figureanchor3-6">Figure 3-6:</a> My training data for recognizing photos of cows</p></figcaption>
</figure>
</li>
<li value="7">Repeat steps 3 through 6 until you have at least 10 different photos for each type of animal, as shown in <a id="figureanchor3-7" href="#figure3-7">Figure 3-7</a>. 
<figure>
<img src="Images/f03007.png" alt="f03007"/>
<figcaption><p><a id="figure3-7" href="#figureanchor3-7">Figure 3-7:</a> Training data for my farm-themed project </p></figcaption>
</figure>
</li>
<li value="8"><span epub:type="pagebreak" title="25" id="Page_25"/>Click <b>Back to project</b> in the top-left corner of the screen.</li>
<li value="9">Click <b>Learn &amp; Test</b> (see <a id="figureanchor3-8" href="#figure3-8">Figure 3-8</a>).
<figure>
<img src="Images/f03008.png" alt="f03008"/>
<figcaption><p><a id="figure3-8" href="#figureanchor3-8">Figure 3-8:</a> Learn &amp; Test is the second phase of an ML project.</p></figcaption>
</figure>
</li>
<li value="10">Click <b>Train new machine learning model</b> (see <a id="figureanchor3-9" href="#figure3-9">Figure 3-9</a>).
<figure>
<img src="Images/f03009.png" alt="f03009"/>
<figcaption><p><a id="figure3-9" href="#figureanchor3-9">Figure 3-9:</a> Click <b>Train new machine learning model</b> to start the training.</p></figcaption>
</figure>
<p class="ListBody">The computer will use the examples you’ve collected to learn what the photos of each animal have in common. This can take a few minutes, but you can continue to the next step in your second web browser window while you wait.</p></li>
</ol>
<h3 id="h2-500563c03-0002"><span epub:type="pagebreak" title="26" id="Page_26"/>Prepare Your Project</h3>
<p class="BodyFirst">To test your ML model, you’ll need some new photos that you haven’t used for training. The computer will use what it learns from your training examples to try to recognize your two animals in these new photos. Then you’ll build a project in Scratch that tests how well your model performs. </p>
<ol>
<li value="1">Search for more photos of the animals you’ve chosen, and save them to your computer. To save a photo, right-click it and select <b>Save Picture</b> or <b>Save Image As</b>, as shown in <a id="figureanchor3-10" href="#figure3-10">Figure 3-10</a>. 
<figure>
<img src="Images/f03010.png" alt="f03010"/>
<figcaption><p><a id="figure3-10" href="#figureanchor3-10">Figure 3-10:</a> Saving test photos to the computer </p></figcaption>
</figure>

<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<h2><span class="NoteHead">Note	</span></h2>
<p>Don’t choose the same photos you used for training the model. You want to test how good the computer is at recognizing new photos, not how good it is at remembering them.</p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
</li>
<li value="2">Aim for at least five test photos of each type of animal that you chose, as shown in <a id="figureanchor3-11" href="#figure3-11">Figure 3-11</a>. 
<span epub:type="pagebreak" title="27" id="Page_27"/><figure>
<img src="Images/f03011.png" alt="f03011"/>
<figcaption><p><a id="figure3-11" href="#figureanchor3-11">Figure 3-11:</a> My folder for cow and sheep test photos </p></figcaption>
</figure>
</li>
<li value="3">Click <b>Back to project</b> in the top-left corner of the screen.</li>
<li value="4">Click <b>Make</b> (see <a id="figureanchor3-12" href="#figure3-12">Figure 3-12</a>).
<figure>
<img src="Images/f03012.png" alt="f03012"/>
<figcaption><p><a id="figure3-12" href="#figureanchor3-12">Figure 3-12:</a> Make is the third phase of an ML project.</p></figcaption>
</figure>
</li>
<li value="5">Click <b>Scratch 3</b>, and then click <b>Open in Scratch 3</b> to open a new window with Scratch.
<p class="ListBody">You should see new blocks representing your ML model in the Toolbox, as shown in <a id="figureanchor3-13" href="#figure3-13">Figure 3-13</a>.</p>
<span epub:type="pagebreak" title="28" id="Page_28"/><figure>
<img src="Images/f03013.png" alt="f03013"/>
<figcaption><p><a id="figure3-13" href="#figureanchor3-13">Figure 3-13:</a> New blocks for your ML project will automatically be added to the Scratch Toolbox.</p></figcaption>
</figure>
</li>
<li value="6">Create a backdrop for your project.
<p class="ListBody">In the bottom-right corner of the Scratch window, move your mouse pointer over the Choose a Backdrop icon, shown in <a id="figureanchor3-14" href="#figure3-14">Figure 3-14</a>. </p>
<figure>
<img src="Images/f03014.png" alt="f03014"/>
<figcaption><p><a id="figure3-14" href="#figureanchor3-14">Figure 3-14:</a> My farm background for sorting cows and sheep into two groups</p></figcaption>
</figure>
<p class="ListBody"><span epub:type="pagebreak" title="29" id="Page_29"/>You have a few options here. If you don’t like drawing, you can click <b>Choose a Backdrop </b>to pick a default background, or click <b>Upload Backdrop</b> to use a picture from the internet. To design your own background for your animals, click <b>Paint </b>and use the drawing and coloring tools in the <em>paint editor</em> to the left of the Code canvas. </p>
<p class="ListBody">No matter which option you choose, be sure to add clearly labeled sections to your backdrop for each type of animal. </p>
<p class="ListBody">I chose farm animals, so I drew a farm scene with signs labeled Cows and Sheep. You can draw something that fits with the animals you chose. For example, if you chose dogs and cats, you could draw a pet shop. If you chose lions and elephants, you could draw a zoo. </p></li>
<li value="7"><em/>Click the cat sprite, and then in the bottom-left corner of the screen, move your mouse pointer over the Choose a Costume icon. Click <b>Upload Costume</b>, as shown in <a id="figureanchor3-15" href="#figure3-15">Figure 3-15</a>.</li>
<li value="8">Select all of the test photos you saved in step 2 to upload all of them at once. 
<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<h2><span class="NoteHead">Note	</span></h2>
<p>Make sure you’re doing this for the sprite, not the backdrop. </p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
<figure>
<img src="Images/f03015.png" alt="f03015"/>
<figcaption><p><a id="figure3-15" href="#figureanchor3-15">Figure 3-15:</a> Click <b>Upload Costume</b> to add your test photos. You can delete the cat costumes from the costume pane on the left.</p></figcaption>
</figure>
</li>
<li value="9">If you missed any of your test photos, click <b>Upload Costume</b> again and repeat until you’ve uploaded all of the test photos from step 2. 
<p class="ListBody"><span epub:type="pagebreak" title="30" id="Page_30"/>We won’t need the Scratch cat costumes, so you can delete them. In the <em>costume pane</em> on the far left (see <a href="#figure3-15">Figure 3-15</a>), click the costume and then click the trash can in its top-right corner to delete it. </p>
<p class="ListBody">Make sure that you upload costumes for the same single sprite, as shown in <a id="figureanchor3-16" href="#figure3-16">Figure 3-16</a>. Don’t upload each photo as a new sprite. </p>
<figure>
<img src="Images/f03016.png" alt="f03016"/>
<figcaption><p><a id="figure3-16" href="#figureanchor3-16">Figure 3-16:</a> Upload additional costumes to the <em>same</em> sprite. </p></figcaption>
</figure>
</li>
<li value="10">Click the <b>Code</b> tab and copy the scripts shown in <a id="figureanchor3-17" href="#figure3-17">Figure 3-17</a>. 
<figure>
<img src="Images/f03017.png" alt="f03017"/>
<figcaption><p><a id="figure3-17" href="#figureanchor3-17">Figure 3-17:</a> Example code for sorting photos of animals </p></figcaption>
</figure>
</li>
</ol>
<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<span epub:type="pagebreak" title="31" id="Page_31"/><h2><span class="NoteHead">Note	</span></h2>
<p>If you’re not sure how to code in Scratch, read <span class="xref" itemid="xref_target_“Coding in Scratch” on “Coding in Scratch” on page xxii">“Coding in Scratch” on “Coding in Scratch” on page xxii</span> in the introduction to this book.</p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
<p>This code will go through each of your test photo costumes and use your ML model to recognize the animal and move it to the correct section. </p>
<ol class="none">
<li>The <code>go to x: 10 y: -145</code> block <span class="CodeAnnotation">1</span> sets the starting position for each photo. This script will start each photo at the bottom middle of the screen. Adjust these coordinates to a starting position that fits with your backdrop.</li>
<li>The <code>recognise image</code> block <span class="CodeAnnotation">2</span> uses your ML model to recognize the photo.</li>
<li>The <code>glide to x: pick random -200 to -50 y: pick random 50 to 150</code> block <span class="CodeAnnotation">3</span> moves the photo to a random position in the top left of the screen. Adjust these coordinates to the location on your backdrop where you want the photos of your first type of animal to go.</li>
<li><code>The glide to x: pick random 70 to 210 y: pick random 50 to 150</code> block <span class="CodeAnnotation">4</span> moves the photo to a random position in the top right of the screen. Adjust these coordinates to the location on your backdrop where you want the photos of your second type of animal to go.</li>
<li>The number in <code>if my variable is &lt; 14</code><span class="CodeAnnotation">5</span> refers to how many test photos you have. Set this value to the number of test costumes you saved in step 2 and uploaded in step 8. I have 14 costumes in my test sprite, so my script goes through 14 test photos. </li>
</ol>
<h3 id="h2-500563c03-0003">Test Your Model</h3>
<p class="BodyFirst">To test the model you’ve created, click the Green Flag in the top-left corner, as shown in <a id="figureanchor3-18" href="#figure3-18">Figure 3-18</a>. Your model will sort your test photos into two groups of animals.</p>
<p>Count how many photos your model moves to the correct side. That’s a simple way to measure how good your project is at sorting photos of your two animals. </p>
<span epub:type="pagebreak" title="32" id="Page_32"/><figure>
<img src="Images/f03018.png" alt="f03018"/>
<figcaption><p><a id="figure3-18" href="#figureanchor3-18">Figure 3-18:</a> Recognizing photos and sorting them into groups</p></figcaption>
</figure>
<p>If your model is getting a lot wrong, you can try to improve it using more training examples. Go back to the Train phase and drag in more photos of each of your animals. Then go back to the Learn &amp; Test phase and train the new, improved ML model. Run your Scratch script again to see if the new model sorts more of your test photos correctly.</p>
<h2 id="h1-500563c03-0002">Review and Improve Your Project</h2>
<p class="BodyFirst">You’ve successfully trained an ML model to recognize photos of animals! This project isn’t based on rules. You haven’t described how different animals look or given the computer specific instructions on how to recognize them. Instead, you’ve used ML to train the computer to do it. This approach is known as <em>supervised learning</em><em/> because you supervised the process by preparing sets of training examples for the computer to use.</p>
<p><span epub:type="pagebreak" title="33" id="Page_33"/>As long as your test photos are similar to your training photos, your model should work. However, if you test your model with pictures that differ somehow from your training photos, you’ll probably get different results. </p>
<p>For example, I tried replacing the costumes in my Scratch project with cartoon illustrations of cows and sheep instead of photographs. Then I ran my code again by clicking the Green Flag. As you can see in <a id="figureanchor3-19" href="#figure3-19">Figure 3-19</a>, my new model got a lot wrong.</p>
<figure>
<img src="Images/f03019.png" alt="f03019"/>
<figcaption><p><a id="figure3-19" href="#figureanchor3-19">Figure 3-19:</a> ML models get a lot wrong if the test inputs aren’t similar to the training inputs.</p></figcaption>
</figure>
<p>I got these results because the patterns my model learned to recognize from the training photos weren’t useful to help it recognize cartoon drawings. If you want a computer to be able to recognize photographs <em>and</em> cartoons, you need to train it with both. </p>
<p>Go back to the Train phase and create a new set of training examples that includes both photographs and cartoons, as shown in <a id="figureanchor3-20" href="#figure3-20">Figure 3-20</a>. I collected 10 example photos and 10 example cartoons in each bucket. </p>
<span epub:type="pagebreak" title="34" id="Page_34"/><figure>
<img src="Images/f03020.png" alt="f03020"/>
<figcaption><p><a id="figure3-20" href="#figureanchor3-20">Figure 3-20:</a> Training a computer to recognize both photos and cartoons</p></figcaption>
</figure>
<p>Then go back to the Learn &amp; Test phase and train a new ML model using your new set of training examples. This new set should teach the computer to identify patterns in photographs and cartoons so it can recognize both. <a id="figureanchor3-21" href="#figure3-21">Figure 3-21</a> shows how much better my updated ML model performed.</p>
<figure>
<img src="Images/f03021.png" alt="f03021"/>
<figcaption><p><a id="figure3-21" href="#figureanchor3-21">Figure 3-21:</a> Testing with a mixture of photographs and drawings </p></figcaption>
</figure>
<p><span epub:type="pagebreak" title="35" id="Page_35"/>As you can see, the more similar the test images are to the training images that the computer learns from, the better ML models perform. </p>
<p>What other changes could you make to improve your model?</p>
<h2 id="h1-500563c03-0003">What You Learned</h2>
<p class="BodyFirst">In this chapter, you used ML to create an image recognition system capable of recognizing and sorting pictures of animals. You learned some of the key principles in ML projects, such as improving your results by increasing the number of training images and making sure they’re similar to the images you want the computer to recognize. </p>
<p>You also learned that we can measure how well an image recognition system performs by trying it out with test pictures and counting how many it identifies correctly. You tried this yourself by creating a project in Scratch to test how well your ML model sorted a group of animal photos. </p>
<p>In the next chapter, you’ll train another image recognition system and use it to make a game. You’ll also learn about some of the ways that ML projects can go wrong.</p>
</section>
</div></body></html>