<html><head></head><body>
<h2 class="h2" id="ch01"><span epub:type="pagebreak" id="page_1"/><strong><span class="big">1</span></strong><br/><strong>UNDERSTANDING THREAT MODELS</strong></h2>&#13;
<div class="image1"><img src="graphics/common-01.jpg" alt="image"/></div>&#13;
<p class="noindent">If you come from the software penetrationtesting world, you’re probably already familiar with attack surfaces. For the rest of us, <em>attack surface</em> refers to all the possible ways to attack a target, from vulnerabilities in individual components to those that affect the entire vehicle.</p>&#13;
<p class="indent">When discussing the attack surface, we’re not considering how to exploit a target; we’re concerned only with the entry points into it. You might think of the attack surface like the surface area versus the volume of an object. Two objects can have the same volume but radically different surface areas. The greater the surface area, the higher the exposure to risk. If you consider an object’s volume its value, our goal in hardening security is to create a low ratio of risk to value.</p>&#13;
<h3 class="h3" id="ch01lev1sec1"><span epub:type="pagebreak" id="page_2"/><strong>Finding Attack Surfaces</strong></h3>&#13;
<p class="noindent">When evaluating a vehicle’s attack surface, think of yourself as an evil spy who’s trying to do bad things to a vehicle. To find weaknesses in the vehicle’s security, evaluate the vehicle’s perimeter, and document the vehicle’s environment. Be sure to consider all the ways that data can get into a vehicle, which are all the ways that a vehicle communicates with the outside world.</p>&#13;
<p class="indentb">As you examine the exterior of the vehicle, ask yourself these questions:</p>&#13;
<p class="bull">• What signals are received? Radio waves? Key fobs? Distance sensors?</p>&#13;
<p class="bull">• Is there physical keypad access?</p>&#13;
<p class="bull">• Are there touch or motion sensors?</p>&#13;
<p class="bull">• If the vehicle is electric, how does it charge?</p>&#13;
<p class="indenttb">As you examine the interior, consider the following:</p>&#13;
<p class="bull">• What are the audio input options: CD? USB? Bluetooth?</p>&#13;
<p class="bull">• Are there diagnostic ports?</p>&#13;
<p class="bull">• What are the capabilities of the dashboard? Is there a GPS? Bluetooth? Internet?</p>&#13;
<p class="indentt">As you can see, there are many ways data can enter the vehicle. If any of this data is malformed or intentionally malicious, what happens? This is where threat modeling comes in.</p>&#13;
<h3 class="h3" id="ch01lev1sec2"><strong>Threat Modeling</strong></h3>&#13;
<p class="noindent">Entire books have been written about threat modeling, but I’m going to give you just a quick tour so you can build your own threat models. (If you have further questions or if this section excites you, by all means, grab another book on the subject!)</p>&#13;
<p class="indent">When threat modeling a car, you collect information about the architecture of your target and create a diagram to illustrate how parts of the car communicate. You then use these maps to identify higher-risk inputs and to keep a checklist of things to audit; this will help you prioritize entry points that could yield the most return.</p>&#13;
<p class="indent">Threat models are typically made during the product development and design process. If the company producing a particular product has a good development life cycle, it creates the threat model when product development begins and continuously updates the model as the product moves through the development life cycle. Threat models are living documents that change as the target changes and as you learn more about a target, so you should update your threat model often.</p>&#13;
<p class="indent">Your threat model can consist of different levels; if a process in your model is complicated, you should consider breaking it down further by <span epub:type="pagebreak" id="page_3"/>adding more levels to your diagrams. In the beginning, however, Level 2 is about as far as you’ll be able to go. We’ll discuss the various levels in the following sections, beginning with Threat Level 0.</p>&#13;
<h4 class="h4" id="ch01lev2sec1"><strong><em>Level 0: Bird’s-Eye View</em></strong></h4>&#13;
<p class="noindent">At this level, we use the checklist we built when considering attack surfaces. Think about how data can enter the vehicle. Draw the vehicle in the center, and then label the external and internal spaces. <a href="ch01.html#ch1fig1">Figure 1-1</a> illustrates a possible Level 0 diagram.</p>&#13;
<p class="indent">The rectangular boxes are the inputs, and the circle in the center represents the entire vehicle. On their way to the vehicle, the inputs cross two dotted lines, which represent external and internal threats.</p>&#13;
<p class="indent">The vehicle circle doesn’t represent an input but rather a complex process—that is, a series of tasks that could be broken down further. Processes are numbered, and as you can see, this one is number 1.0. If you had more than one complex piece in your threat model, you would number those in succession. For instance, you would label a second process 2.0; a third, 3.0; and so on. As you learn about your vehicle’s features, you update the diagram. It’s okay if you don’t recognize all of the acronyms in the diagram yet; you will soon.</p>&#13;
<div class="image"><img src="graphics/f01-01.jpg" alt="image"/></div>&#13;
<p class="figcap"><a id="ch1fig1"/><em>Figure 1-1: Level 0 inputs</em></p>&#13;
<h4 class="h4" id="ch01lev2sec2"><strong><em>Level 1: Receivers</em></strong></h4>&#13;
<p class="noindent">To move on to the Level 1 diagram, pick a process to explore. Because we have only the one process in our diagram, let’s dig in to the vehicle process and focus on what each input talks to.</p>&#13;
<p class="indent">The Level 1 map shown in <a href="ch01.html#ch1fig2">Figure 1-2</a> is almost identical to that in Level 0. The only difference is that here we specify the vehicle connections that receive the Level 0 input. We won’t look at the receivers in depth just yet; we’re looking only at the basic device or area that the input talks to.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_4"/><img src="graphics/f01-02.jpg" alt="image"/></div>&#13;
<p class="figcap"><a id="ch1fig2"/><em>Figure 1-2: Level 1 map of inputs and vehicle connections</em></p>&#13;
<p class="indent">Notice in <a href="ch01.html#ch1fig2">Figure 1-2</a> that we number each receiver. The first digit represents the process label from the Level 0 diagram in <a href="ch01.html#ch1fig1">Figure 1-1</a>, and the second digit is the number of the receiver. Because the infotainment unit is both a complex process and an input, we’ve given it a process circle. We now have three other processes: immobilizer, ECU, and TPMS Receiver.</p>&#13;
<p class="indent">The dotted lines in the Level 1 map represent divisions between trust boundaries. The inputs at the top of the diagram are the least trusted, and the ones at the bottom are the most trusted. The more trust boundaries that a communication channel crosses, the more risky that channel becomes.</p>&#13;
<h4 class="h4" id="ch01lev2sec3"><span epub:type="pagebreak" id="page_5"/><strong><em>Level 2: Receiver Breakdown</em></strong></h4>&#13;
<p class="noindent">At Level 2, we examine the communication taking place inside the vehicle. Our sample diagram (<a href="ch01.html#ch1fig3">Figure 1-3</a>) focuses on a Linux-based infotainment console, receiver 1.1. This is one of the more complicated receivers, and it’s often directly connected to the vehicle’s internal network.</p>&#13;
<p class="indent">In <a href="ch01.html#ch1fig3">Figure 1-3</a>, we group the communications channels into boxes with dashed lines to once again represent trust boundaries. Now there’s a new trust boundary inside the infotainment console called kernel space. Systems that talk directly to the kernel hold higher risk than ones that talk to system applications because they may bypass any access control mechanisms on the infotainment unit. Therefore, the cellular channel is higher risk than the Wi-Fi channel because it crosses a trust boundary into kernel space; the Wi-Fi channel, on the other hand, communicates with the WPA supplicant process in user space.</p>&#13;
<div class="image"><img src="graphics/f01-03.jpg" alt="image"/></div>&#13;
<p class="figcap"><a id="ch1fig3"/><em>Figure 1-3: Level 2 map of the infotainment console</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_6"/>This system is a Linux-based in-vehicle infotainment (IVI) system, and it uses parts common to a Linux environment. In the kernel space, you see references to the kernel modules udev, HSI, and Kvaser, which receive input from our threat model. The udev module loads USB devices, HSI is a serial driver that handles cellular communication, and Kvaser is the vehicle’s network driver.</p>&#13;
<p class="indent">The numbering pattern for Level 2 is now <em>X</em>.<em>X</em>.<em>X</em>, and the identification system is the same as before. At Level 0, we took the vehicle process that was 1.0 and dove deeper into it. We then marked all processes within Level 1 as 1.1, 1.2, and so on. Next, we selected the infotainment process marked 1.1 and broke it down further for the Level 2 diagram. At Level 2, therefore, we labeled all complex processes as 1.1.1, 1.1.2, and so on. (You can continue the same numbering scheme as you dive even deeper into the processes. The numbering scheme is for documentation purposes; it allows you to reference the exact process at the appropriate level.)</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="bgblack">NOTE</span></strong></p>&#13;
<p class="notep"><em>Ideally at this stage, you’d map out which processes handle which inputs, but we’ll have to guess for now. In the real world, you’d need to reverse engineer the infotainment system to find this information.</em></p>&#13;
</div>&#13;
<p class="indent">When building or designing an automotive system, you should continue to drill down into as many complex processes as possible. Bring in the development team, and start discussing the methods and libraries used by each application so you can incorporate them into their own threat diagrams. You’ll likely find that the trust boundaries at the application level will usually be between the application and the kernel, between the application and the libraries, between the application and other applications, and even between functions. When exploring these connections, mark methods that have higher privileges or that handle more sensitive information.</p>&#13;
<h3 class="h3" id="ch01lev1sec3"><strong>Threat Identification</strong></h3>&#13;
<p class="noindent">Now that we’ve gone two levels deep into our threat modeling maps, we can begin to identify potential threats. Threat identification is often more fun to do with a group of people and a whiteboard, but you can do it on your own as a thought exercise.</p>&#13;
<p class="indent">Let’s try this exercise together. Start at Level 0—the bird’s-eye view—and consider potential high-level problems with inputs, receivers, and threat boundaries. Now let’s list all potential threats with our threat models.</p>&#13;
<h4 class="h4" id="ch01lev2sec4"><strong><em>Level 0: Bird’s-Eye View</em></strong></h4>&#13;
<p class="noindent">When determining potential threats at Level 0, try to stay high level. Some of these threats may seem unrealistic because you’re aware of additional hurdles or protections, but it’s important to include all possible threats in this list, even if some have already been addressed. The point here is to brainstorm all the risks of each process and input.</p>&#13;
<p class="indentb"><span epub:type="pagebreak" id="page_7"/>The high-level threats at Level 0 are that an attacker could:</p>&#13;
<p class="bull">• Remotely take over a vehicle</p>&#13;
<p class="bull">• Shut down a vehicle</p>&#13;
<p class="bull">• Spy on vehicle occupants</p>&#13;
<p class="bull">• Unlock a vehicle</p>&#13;
<p class="bull">• Steal a vehicle</p>&#13;
<p class="bull">• Track a vehicle</p>&#13;
<p class="bull">• Thwart safety systems</p>&#13;
<p class="bull">• Install malware on the vehicle</p>&#13;
<p class="indentt">At first, it may be difficult to come up with a bunch of attack scenarios. It’s often good to have people who are not engineers also participate at this stage because as a developer or an engineer, you tend to be so involved in the inner workings that it’s natural to discredit ideas without even meaning to.</p>&#13;
<p class="indent">Be creative; try to come up with the most James Bond–villain attack you can think of. Maybe think of other attack scenarios and whether they could also apply to vehicles. For example, consider ransomware, a malicious software that can encrypt or lock you out of your computer or phone until you pay money to someone controlling the software remotely. Could this be used on vehicles? The answer is yes. Write <em>ransomware</em> down.</p>&#13;
<h4 class="h4" id="ch01lev2sec5"><strong><em>Level 1: Receivers</em></strong></h4>&#13;
<p class="noindent">Threat identification at Level 1 focuses more on the connections of each piece rather than connections that might be made directly to an input. The vulnerabilities that we posit at this level relate to vulnerabilities that affect what connects to the devices in a vehicle.</p>&#13;
<p class="indent">We’ll break these down into threat groupings that relate to cellular, Wi-Fi, key fob (KES), tire pressure monitor sensor (TPMS), infotainment console, USB, Bluetooth, and controller area network (CAN) bus connections. As you can see in the following lists, there are many potential ways into a vehicle.</p>&#13;
<h5 class="h5" id="ch01lev3sec1"><strong>Cellular</strong></h5>&#13;
<p class="noindentb">An attacker could exploit the cellular connection in a vehicle to:</p>&#13;
<p class="bull">• Access the internal vehicle network from anywhere</p>&#13;
<p class="bull">• Exploit the application in the infotainment unit that handles incoming calls</p>&#13;
<p class="bull">• Access the subscriber identity module (SIM) through the infotainment unit</p>&#13;
<p class="bull">• Use a cellular network to connect to the remote diagnostic system (OnStar)</p>&#13;
<p class="bull">• Eavesdrop on cellular communications</p>&#13;
<p class="bull"><span epub:type="pagebreak" id="page_8"/>• Jam distress calls</p>&#13;
<p class="bull">• Track the vehicle’s movements</p>&#13;
<p class="bull">• Set up a fake Global System for Mobile Communications (GSM) base station</p>&#13;
<h5 class="h5" id="ch01lev3sec2"><strong>Wi-Fi</strong></h5>&#13;
<p class="noindentb">An attacker could exploit the Wi-Fi connection to:</p>&#13;
<p class="bull">• Access the vehicle network from up to 300 yards away or more</p>&#13;
<p class="bull">• Find an exploit for the software that handles incoming connections</p>&#13;
<p class="bull">• Install malicious code on the infotainment unit</p>&#13;
<p class="bull">• Break the Wi-Fi password</p>&#13;
<p class="bull">• Set up a fake dealer access point to trick the vehicle into thinking it’s being serviced</p>&#13;
<p class="bull">• Intercept communications passing through the Wi-Fi network</p>&#13;
<p class="bull">• Track the vehicle</p>&#13;
<h5 class="h5" id="ch01lev3sec3"><strong>Key Fob</strong></h5>&#13;
<p class="noindentb">An attacker could exploit the key fob connection to:</p>&#13;
<p class="bull">• Send malformed key fob requests that put the vehicle’s immobilizer in an unknown state. (The immobilizer is supposed to keep the vehicle locked so it can’t be hotwired. We need to ensure that it maintains proper functionality.)</p>&#13;
<p class="bull">• Actively probe an immobilizer to drain the car battery</p>&#13;
<p class="bull">• Lock out a key</p>&#13;
<p class="bull">• Capture cryptographic information leaked from the immobilizer during the handshake process</p>&#13;
<p class="bull">• Brute-force the key fob algorithm</p>&#13;
<p class="bull">• Clone the key fob</p>&#13;
<p class="bull">• Jam the key fob signal</p>&#13;
<p class="bull">• Drain the power from the key fob</p>&#13;
<h5 class="h5" id="ch01lev3sec4"><strong>Tire Pressure Monitor Sensor</strong></h5>&#13;
<p class="noindentb">An attacker could exploit the TPMS connection to:</p>&#13;
<p class="bull">• Send an impossible condition to the engine control unit (ECU), causing a fault that could then be exploited</p>&#13;
<p class="bull">• Trick the ECU into overcorrecting for spoofed road conditions</p>&#13;
<p class="bull"><span epub:type="pagebreak" id="page_9"/>• Put the TPMS receiver or the ECU into an unrecoverable state that might cause a driver to pull over to check for a reported flat or that might even shut down the vehicle</p>&#13;
<p class="bull">• Track a vehicle based on the TPMS unique IDs</p>&#13;
<p class="bull">• Spoof the TPMS signal to set off internal alarms</p>&#13;
<h5 class="h5" id="ch01lev3sec5"><strong>Infotainment Console</strong></h5>&#13;
<p class="noindentb">An attacker could exploit the infotainment console connection to:</p>&#13;
<p class="bull">• Put the console into debug mode</p>&#13;
<p class="bull">• Alter diagnostic settings</p>&#13;
<p class="bull">• Find an input bug that causes unexpected results</p>&#13;
<p class="bull">• Install malware to the console</p>&#13;
<p class="bull">• Use a malicious application to access the internal CAN bus network</p>&#13;
<p class="bull">• Use a malicious application to eavesdrop on actions taken by vehicle occupants</p>&#13;
<p class="bull">• Use a malicious application to spoof data displayed to the user, such as the vehicle location</p>&#13;
<h5 class="h5" id="ch01lev3sec6"><strong>USB</strong></h5>&#13;
<p class="noindentb">An attacker could use a USB port connection to:</p>&#13;
<p class="bull">• Install malware on the infotainment unit</p>&#13;
<p class="bull">• Exploit a flaw in the USB stack of the infotainment unit</p>&#13;
<p class="bull">• Attach a malicious USB device with specially crafted files designed to break importers on the infotainment unit, such as the address book and MP3 decoders</p>&#13;
<p class="bull">• Install modified update software on the vehicle</p>&#13;
<p class="bull">• Short the USB port, thus damaging the infotainment system</p>&#13;
<h5 class="h5" id="ch01lev3sec7"><strong>Bluetooth</strong></h5>&#13;
<p class="noindentb">An attacker could use a Bluetooth connection to:</p>&#13;
<p class="bull">• Execute code on the infotainment unit</p>&#13;
<p class="bull">• Exploit a flaw in the Bluetooth stack of the infotainment unit</p>&#13;
<p class="bull">• Upload malformed information, such as a corrupted address book designed to execute code</p>&#13;
<p class="bull">• Access the vehicle from close ranges (less than 300 feet)</p>&#13;
<p class="bull">• Jam the Bluetooth device</p>&#13;
<h5 class="h5" id="ch01lev3sec8"><span epub:type="pagebreak" id="page_10"/><strong>Controller Area Network</strong></h5>&#13;
<p class="noindentb">An attacker could exploit the CAN bus connection to:</p>&#13;
<p class="bull">• Install a malicious diagnostic device to send packets to the CAN bus</p>&#13;
<p class="bull">• Plug directly in to a CAN bus to attempt to start a vehicle without a key</p>&#13;
<p class="bull">• Plug directly in to a CAN bus to upload malware</p>&#13;
<p class="bull">• Install a malicious diagnostic device to track the vehicle</p>&#13;
<p class="bull">• Install a malicious diagnostic device to enable remote communications directly to the CAN bus, making a normally internal attack now an external threat</p>&#13;
<h4 class="h4" id="ch01lev2sec6"><strong><em>Level 2: Receiver Breakdown</em></strong></h4>&#13;
<p class="noindent">At Level 2, we can talk more about identifying specific threats. As we look at exactly which application handles which connection, we can start to perform validation based on possible threats.</p>&#13;
<p class="indent">We’ll break up threats into five groups: Bluez (the Bluetooth daemon), the wpa_supplicant (the Wi-Fi daemon), HSI (high-speed synchronous interface cellular kernel module), udev (kernel device manager), and the Kvaser driver (CAN transceiver driver). In the following lists, I’ve specified threats to each program.</p>&#13;
<h5 class="h5" id="ch01lev3sec9"><strong>Bluez</strong></h5>&#13;
<p class="noindentb">Older or unpatched versions of the Bluez daemon:</p>&#13;
<p class="bull">• May be exploitable</p>&#13;
<p class="bull">• May be unable to handle corrupt address books</p>&#13;
<p class="bull">• May not be configured to ensure proper encryption</p>&#13;
<p class="bull">• May not be configured to handle secure handshaking</p>&#13;
<p class="bull">• May use default passkeys</p>&#13;
<h5 class="h5" id="ch01lev3sec10"><strong>wpa_supplicant</strong></h5>&#13;
<p class="bull">• Older versions may be exploitable</p>&#13;
<p class="bull">• May not enforce proper WPA2 style wireless encryption</p>&#13;
<p class="bull">• May connect to malicious access points</p>&#13;
<p class="bull">• May leak information on the driver via BSSID (network interface)</p>&#13;
<h5 class="h5" id="ch01lev3sec11"><strong>HSI</strong></h5>&#13;
<p class="bull">• Older versions may be exploitable</p>&#13;
<p class="bull">• May be susceptible to injectable serial communication (man-in-the-middle attacks in which the attacker inserts serial commands into the data stream)</p>&#13;
<h5 class="h5" id="ch01lev3sec12"><span epub:type="pagebreak" id="page_11"/><strong>udev</strong></h5>&#13;
<p class="bull">• Older, unpatched versions may be susceptible to attack</p>&#13;
<p class="bull">• May not have a maintained whitelist of devices, allowing an attacker to load additional drivers or USB devices that were not tested or intended for use</p>&#13;
<p class="bull">• May allow an attacker to load foreign devices, such as a keyboard to access the infotainment system</p>&#13;
<h5 class="h5" id="ch01lev3sec13"><strong>Kvaser Driver</strong></h5>&#13;
<p class="bull">• Older, unpatched versions may be exploitable</p>&#13;
<p class="bull">• May allow an attacker to upload malicious firmware to the Kvaser device</p>&#13;
<p class="indentt">These lists of potential vulnerabilities are by no means exhaustive, but they should give you an idea of how this brainstorming session works. If you were to go to a Level 3 map of potential threats to your vehicle, you would pick one of the processes, like HSI, and start to look at its kernel source to identify sensitive methods and dependencies that might be vulnerable to attack.</p>&#13;
<h3 class="h3" id="ch01lev1sec4"><strong>Threat Rating Systems</strong></h3>&#13;
<p class="noindent">Having documented many of our threats, we can now rate them with a risk level. Common rating systems include DREAD, ASIL, and MIL-STD-882E. DREAD is commonly used in web testing, while the automotive industry and government use ISO 26262 ASIL and MIL-STD-882E, respectively, for threat rating. Unfortunately, ISO 26262 ASIL and MIL-STD-882E are focused on safety failures and are not adequate to handle malicious threats. More details on these standards can be found at <em><a href="http://opengarages.org/index.php/Policies_and_Guidelines">http://opengarages.org/index.php/Policies_and_Guidelines</a></em>.</p>&#13;
<h4 class="h4" id="ch01lev2sec7"><strong><em>The DREAD Rating System</em></strong></h4>&#13;
<p class="noindent">DREAD stands for the following:</p>&#13;
<p class="uln"><strong>Damage potential</strong> How great is the damage?</p>&#13;
<p class="uln"><strong>Reproducibility</strong> How easy is it to reproduce?</p>&#13;
<p class="uln"><strong>Exploitability</strong> How easy is it to attack?</p>&#13;
<p class="uln"><strong>Affected users</strong> How many users are affected?</p>&#13;
<p class="uln"><strong>Discoverabilty</strong> How easy is it to find the vulnerability?</p>&#13;
<p class="indent"><a href="ch01.html#ch1tab1">Table 1-1</a> lists the risk levels from 1 to 3 for each rating category.</p>&#13;
<p class="tabcaption"><span epub:type="pagebreak" id="page_12"/><a id="ch1tab1"/><strong>Table 1-1:</strong> DREAD Rating System</p>&#13;
<table class="topbot">&#13;
<thead>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"> </p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Rating category</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>High (3)</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Medium (2)</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Low (1)</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><strong>D</strong></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Damage potential</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Could subvert the security system and gain full trust, ultimately taking over the environment</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Could leak sensitive information</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Could leak trivial information</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><strong>R</strong></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Reproducibility</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Is always reproducible</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Can be reproduced only during a specific condition or window of time</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Is very difficult to reproduce, even given specific information about the vulnerability</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><strong>E</strong></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Exploitability</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Allows a novice attacker to execute the exploit</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Allows a skilled attacker to create an attack that could be used repeatedly</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Allows only a skilled attacker with in-depth knowledge to perform the attack</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><strong>A</strong></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Affected users</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Affects all users, including the default setup user and key customers</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Affects some users or specific setups</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Affects a very small percentage of users; typically affects an obscure feature</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><strong>D</strong></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Discoverability</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Can be easily found in a published explanation of the attack</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Affects a seldom-used part, meaning an attacker would need to be very creative to discover a malicious use for it</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Is obscure, meaning it’s unlikely attackers would find a way to exploit it</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent">Now we can apply each DREAD category from <a href="ch01.html#ch1tab1">Table 1-1</a> to an identified threat from earlier in the chapter and score the threat from low to high (1–3). For instance, if we take the Level 2 HSI threats discussed in “<a href="ch01.html#ch01lev2sec3">Level 2: Receiver Breakdown</a>” on <a href="ch01.html#page_10">page 10</a>, we can come up with threat ratings like the ones shown in <a href="ch01.html#ch1tab2">Table 1-2</a>.</p>&#13;
<p class="tabcaption"><a id="ch1tab2"/><strong>Table 1-2:</strong> HSI Level 2 Threats with DREAD Scores</p>&#13;
<table class="topbot">&#13;
<thead>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>HSI threats</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>D</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>R</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>E</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>A</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>D</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Total</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">An older, unpatched version of HSI that may be exploitable</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">3</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">3</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">2</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">3</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">3</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">14</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">An HSI that may be susceptible to injectable serial communication</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">2</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">2</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">2</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">3</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">3</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">12</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent">You can identify the overall rating by using the values in the Total column, as shown in <a href="ch01.html#ch1tab3">Table 1-3</a>.</p>&#13;
<p class="tabcaption"><a id="ch1tab3"/><strong>Table 1-3:</strong> DREAD Risk Scoring Chart</p>&#13;
<table class="topbot">&#13;
<thead>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Total</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Risk level</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">5–7</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Low</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">8–11</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Medium</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">12–15</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">High</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_13"/>When performing a risk assessment, it’s good practice to leave the scoring results visible so that the person reading the results can better understand the risks. In the case of the HSI threats, we can assign high risk to each of these threats, as shown in <a href="ch01.html#ch1tab4">Table 1-4</a>.</p>&#13;
<p class="tabcaption"><a id="ch1tab4"/><strong>Table 1-4:</strong> HSI Level 2 Threats with DREAD Risk Levels Applied</p>&#13;
<table class="topbot">&#13;
<thead>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>HSI threats</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>D</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>R</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>E</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>A</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>D</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Total</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Risk</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">An older, unpatched version of HSI that may be exploitable</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">3</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">3</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">2</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">3</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">3</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">14</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">High</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">An HSI that may be susceptible to injectable serial communication</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">2</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">2</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">2</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">3</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">3</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">12</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">High</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent">Although both risks are marked as high, we can see that the older version of the HSI model poses a slightly higher risk than do the injectable serial attacks, so we can make it a priority to address this risk first. We can also see that the reason why the injectable serial communication risk is lower is that the damage is less severe and the exploit is harder to reproduce than that of an old version of HSI.</p>&#13;
<h4 class="h4" id="ch01lev2sec8"><strong><em>CVSS: An Alternative to DREAD</em></strong></h4>&#13;
<p class="noindent">If DREAD isn’t detailed enough for you, consider the more detailed risk methodology known as the <em>common vulnerability scoring system (CVSS)</em>. CVSS offers many more categories and details than DREAD in three groups: base, temporal, and environmental. Each group is subdivided into sub areas—six for base, three for temporal, and five for environmental—for a total of 14 scoring areas! (For detailed information on how CVSS works, see <em><a href="http://www.first.org/cvss/cvss-guide">http://www.first.org/cvss/cvss-guide</a></em>.)</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="bgblack">NOTE</span></strong></p>&#13;
<p class="notep"><em>While we could use ISO 26262 ASIL or MIL-STD-882E when rating threats, we want more detail than just Risk = Probability × Severity. If you have to pick between these two systems for a security review, go with MIL-STD-882E from the Department of Defense (DoD). The Automotive Safety Integrity Level (ASIL) system will too often have a risk fall into the QM ranking, which basically translates to “meh.” The DoD’s system tends to result in a higher ranking, which equates to a higher value for the cost of a life. Also, MIL-STD-882E is designed to be applied throughout the life cycle of a system, including disposal, which is a nice fit with a secure development life cycle.</em></p>&#13;
</div>&#13;
<h3 class="h3" id="ch01lev1sec5"><strong>Working with Threat Model Results</strong></h3>&#13;
<p class="noindent">At this point, we have a layout of many of the potential threats to our vehicle, and we have them ranked by risk. Now what? Well, that depends on what team you’re on. To use military jargon, the attacker side is the “red team,” and the defender side is the “blue team.” If you’re on the red team, your next step is to start attacking the highest risk areas that are likely to have the best chance of success. If you’re on the blue team, go back to your risk chart and modify each threat with a countermeasure.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_14"/>For example, if we were to take the two risks in “<a href="ch01.html#ch01lev2sec7">The DREAD Rating System</a>” on <a href="ch01.html#page_11">page 11</a>, we could add a countermeasure section to each. <a href="ch01.html#ch1tab5">Table 1-5</a> includes the countermeasure for the HSI code execution risk, and <a href="ch01.html#ch1tab6">Table 1-6</a> includes the countermeasure for the risk of HSI interception.</p>&#13;
<p class="tabcaption"><a id="ch1tab5"/><strong>Table 1-5:</strong> HSI Code Execution Risk</p>&#13;
<table class="topbot">&#13;
<thead>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Threat</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Executes code in the kernel space</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Risk</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">High</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Attack technique</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Exploit vulnerability in older versions of HSI</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Countermeasures</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Kernel and kernel modules should be updated with the latest kernel releases</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="tabcaption"><a id="ch1tab6"/><strong>Table 1-6:</strong> Intercepting HSI Commands</p>&#13;
<table class="topbot">&#13;
<thead>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Threat</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Intercepts and injects commands from the cellular network</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Risk</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">High</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Attack technique</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Intercept serial communications over HSI</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Countermeasures</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">All commands sent over cellular are cryptographically signed</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent">Now you have a documented list of high-risk vulnerabilities with solutions. You can prioritize any solutions not currently implemented based on the risk of not implementing that solution.</p>&#13;
<h3 class="h3" id="ch01lev1sec6"><strong>Summary</strong></h3>&#13;
<p class="noindent">In this chapter you learned the importance of using threat models to identify and document your security posture, and of getting both technical and nontechnical people to brainstorm possible scenarios. We then drilled down into these scenarios to identify all potential risks. Using a scoring system, we ranked and categorized each potential risk. After assessing threats in this way, we ended up with a document that defined our current product security posture, any countermeasure currently in place, and a task list of high-priority items that still need to be addressed.</p>&#13;
</body></html>