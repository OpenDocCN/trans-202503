<html><head></head><body>
<h2 class="h2" id="ch20"><span epub:type="pagebreak" id="page_163"/>—20—<br/>Adding Suspects to the Search Tree</h2>&#13;
<p class="noindent">Frank studied the list of transfers for a few more minutes but failed to see anything suspicious. None of the recent transfer destinations were even remotely close to the capital, where most of the thefts had occurred. The nearest transfer had been to the city of Easterville—50 miles away—and the “Reason for Transfer” listed by the young officer’s captain had been “a persistent smell of feet.”</p>&#13;
<p class="indent">“This is everyone?” Frank asked, turning to Notation.</p>&#13;
<p class="indent">“Yes,” said Notation defensively. “This is every officer who transferred between stations in the last year.”</p>&#13;
<p class="indent">Frank frowned. The definition sounded wrong to him. It sounded incomplete. “What about initial transfers?” asked Frank.</p>&#13;
<p class="indent">“From the academy?” asked Notation.</p>&#13;
<p class="indent">“Yes,” said Frank. “What about transfers from the academy?”</p>&#13;
<p class="indent">“Well,” said Notation. “Those would be probationary initial transfers. They would be recorded in different ledgers.”</p>&#13;
<p class="indent">Frank nodded slowly. His mind raced.</p>&#13;
<p class="indent">“I can get—” Notation started.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_164"/>“No need,” Frank interrupted. “I promised the captain an update by this afternoon. I can pick up the ledgers then.”</p>&#13;
<p class="indent">“You’re going to see the captain?” asked Notation, surprised.</p>&#13;
<p class="indent">“Updating your clients is part of the life of a private eye,” said Frank.</p>&#13;
<p class="indent">“You can also tell the captain about Gretchen’s theory,” added Socks.</p>&#13;
<p class="indent">“What theory?” asked Notation, her eyes darting between Frank and Socks.</p>&#13;
<p class="indent">“Frank didn’t tell you?” asked Socks.</p>&#13;
<p class="indent">“No,” said Notation, through clenched teeth, “he did not.” Her hands were balled into fists at her side, but her face clearly said that she would very much prefer to use one of them to punch Frank in the nose.</p>&#13;
<p class="indent">“My mentor Gretchen thinks there will be an attack on the castle tomorrow night,” said Socks.</p>&#13;
<p class="indent">“She does?” asked Notation. Then, turning to Frank, she added, “That seems like a useful piece of information. Why didn’t you tell me?”</p>&#13;
<p class="indent">“It’s just speculation,” replied Frank with a shrug, but he avoided her eye.</p>&#13;
<p class="indent">“I should come with you to see the captain,” said Notation.</p>&#13;
<p class="indent">Frank balked. He hadn’t expected that. People usually dreaded updating Captain Donovan unless they could open the conversation with “Great news!” or “You’ll never guess what we found.” Going into his office with an update consisting of equal parts dead ends, unexplored leads, and life-threatening situations invited a loud and colorful lecture. Frank wouldn’t even be considering it if he didn’t need information himself.</p>&#13;
<p class="indent">“I need you to follow up on something else,” said Frank after only a brief pause. “Parallelized search, remember?” He reached into his pocket and felt around but found only his notepad, a few food <span epub:type="pagebreak" id="page_165"/>wrappers, and an old empty snail shell. The shell was a souvenir from his last case, a nasty affair involving a percussion band and numerous noise complaints. He pulled it from his pocket.</p>&#13;
<p class="indent">“See if you can find out anything about this,” he said.</p>&#13;
<p class="indent">“A shell?” Notation asked. “What does it have to do with the case?”</p>&#13;
<p class="indent">“I don’t know,” Frank hedged. “But Glass Box Billy might.”</p>&#13;
<p class="indent">Reluctantly, Notation took the shell and studied it. As she turned it over in her hands, she muttered, “Why does it have to be Billy? He’s always impossible to find.”</p>&#13;
<p class="indent">Frank turned to Socks, who was staring at the shell with a profoundly confused expression. “Can you maintain the binary search tree on our way to the station?”</p>&#13;
<p class="indent">“Uh, sure,” said Socks. “But it would be easier to just build a new one.”</p>&#13;
<p class="indent">Frank shook his head. “We’d need all these ledgers for that, and I don’t feel like lugging them halfway across the city. They look heavy.”</p>&#13;
<p class="indent">At that, Notation interrupted her investigation of the shell to shoot him another nasty look.</p>&#13;
<p class="center">_____________________</p>&#13;
<p class="noindent">Fifty-seven minutes later, Frank and Socks stood outside the police records office. The trip usually took less than 20 minutes, but they were slowed significantly by the large glowing binary search tree floating in front of Socks. Not only did it block his vision, causing him to trip over numerous ruts, but it was also the cause of much rubbernecking and endless questions from curious pedestrians, until Frank resorted to yelling “Out of the way! Dangerously unstable magic here,” as they walked. The warning worked quite well.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_166"/><img src="../images/f0166-01.jpg" alt="image"/></div>&#13;
<p class="indent">“Don’t you need to speak with the captain?” asked Socks.</p>&#13;
<p class="indent">“First we find our transfer,” said Frank. He never liked going into a meeting with a client empty-handed.</p>&#13;
<p class="indent">Every class at the police academy produced around 20 new officers, each of whom transferred to a station somewhere in the kingdom. As a result, the Ledger of Initial Assignments for the last 10 classes weighed at least 10 pounds. As with the other transfer ledgers, it was sorted by name rather than date.</p>&#13;
<p class="indent">“It looks like we have a couple hundred transfers to add to the tree,” Frank said as he found an empty desk in the paperwork common room. Due to the standard combination of security needs and high volumes of paperwork, no one was allowed to work in the records vault itself. Instead, all police stations included one or more workrooms immediately adjacent to the record room, containing nothing more than long wooden tables and individual study carrels.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_167"/>“We can’t just add nodes!” Socks exclaimed.</p>&#13;
<p class="indent">“Of course we can,” said Frank. “Adding to a binary search tree is easy. Start at the top, search downward as though you’re looking for the element and, when you hit a dead end, add the new entry below that node.</p>&#13;
<p class="indent">“Take this first transfer, 57 days ago. We start at the top. Because 57 is larger than the root node’s value of 55, we go to the right. Then we go left, because 57 is less than 67. Then we go left again, because 57 is less than 61. Finally, comparing 57 to 59, we ought to go down to the left node again, but we can’t because there is no left child. So we add the new node as the left child of 59.”</p>&#13;
<div class="image"><img src="../images/f0167-01.jpg" alt="image"/></div>&#13;
<p class="indent">Socks looked horrified.</p>&#13;
<p class="indent">“Here,” said Frank. “I’ll show you again. This transfer was 89 days ago. We go right, then right, then right again. And we add it as the left child of 91, because 89 is less than 91.”</p>&#13;
<div class="image"><img src="../images/f0167-02.jpg" alt="image"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_168"/>“That’s not what I mean,” insisted Socks. “What if the tree becomes unbalanced?”</p>&#13;
<p class="indent">“It could happen,” admitted Frank. “When you’re adding elements to a binary search tree, the resulting tree might be unbalanced. Our search algorithm will still work, though.”</p>&#13;
<p class="indent">“But searches could be inefficient on an unbalanced tree,” protested Socks.</p>&#13;
<p class="indent">“That’s true,” admitted Frank.</p>&#13;
<p class="indent">Adding nodes to a tree could cancel out one of the major advantages of a balanced binary search tree: that it makes many algorithms efficient. Each time you approximately double the number of nodes in a balanced binary search tree, you only need to add a single level. This means that for a simple search, such as looking up an element, you can double the amount of data while adding only one more step to your search. However, Socks was correct: this efficiency applies only if the tree is balanced. In the worst case, the tree forms a long line that you’re forced to search along. And when you’re adding arbitrary values, there are no guarantees that the tree will remain balanced.</p>&#13;
<p class="indent">“We’ll have to risk it,” Frank declared finally.</p>&#13;
<p class="indent">“But—”</p>&#13;
<p class="indent">“If our search isn’t as efficient as it could be, I’m willing to live with that. It’s a small price to pay for not having to carry those other books with us to build the tree from scratch. They looked heavy.”</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart"><span epub:type="pagebreak" id="page_169"/><strong>POLICE ALGORITHMS 101: BINARY SEARCH TREES</strong></p>&#13;
<p class="sbsub"><em><strong>Excerpt from Professor Drecker’s Lecture</strong></em></p>&#13;
<p class="noindent">Adding nodes to a binary search tree is similar to searching for a target value. We start at the root of the tree and progress downward as though searching for the value to insert. We progress to the left or right depending on whether the new value we’re inserting is smaller or larger than the value at the current node. The descent ends when we reach a dead end: a node without a child in the correct direction. At this point, we can create a new node and make it the (left or right) child.</p>&#13;
<div class="image"><img src="../images/f0169-01.jpg" alt="image"/></div>&#13;
<p class="indent">The cost of inserting a single element scales linearly with the depth of the tree. However, we have no guarantees that the tree will remain balanced as new nodes are inserted. In fact, it is easy for a tree to become unbalanced, with deep branches, depending on the order of insertions. For example, if we insert numbers in sorted order, all the additions can go down a single branch.<span epub:type="pagebreak" id="page_170"/></p>&#13;
<div class="image"><img src="../images/f0169-02.jpg" alt="image"/></div>&#13;
</div>&#13;
</body></html>