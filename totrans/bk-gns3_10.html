<html><head></head><body><div class="chapter" title="Chapter&#xA0;10.&#xA0;Cool Things To Do on a Rainy Day"><div class="titlepage"><div><div><h1 class="title"><a id="cool_things_to_do_on_a_rainy_day"/>Chapter 10. Cool Things To Do on a Rainy Day</h1></div></div></div><p><a id="iddle2305" class="indexterm"/><a id="iddle2309" class="indexterm"/>Now that you’ve seen GNS3’s most commonly used features, let’s explore some fun tricks you can do with your GNS3 projects. First, you’ll create a simulated Cisco access server that functions like its real Cisco counterpart.</p><p>Next, I’ll show you how to move your GNS3 projects from one operating system to another and how to copy your GNS3 virtual router configurations from GNS3 to real Cisco routers. Finally, you’ll look at sharing a project’s resource load using multiple PCs, create some nerdy labs, and simulate a few real network scenarios.</p><div class="sect1" title="Managing Devices from an Access Server"><div class="titlepage"><div><div><h1 class="title"><a id="managing_devices_from_an_access_server"/>Managing Devices from an Access Server</h1></div></div></div><p>An <span class="emphasis"><em>access server</em></span> allows you to manage all network devices from a central console so you can concurrently log on to multiple device consoles and easily switch between them. It’s an efficient way to manage devices on large Cisco networks, and with only a little effort you can create a fully functional virtual Cisco access server (sometimes called a <span class="emphasis"><em>terminal</em></span> or <span class="emphasis"><em>comm server</em></span>) to <a id="iddle1213" class="indexterm"/><a id="iddle1538" class="indexterm"/><a id="iddle1547" class="indexterm"/><a id="iddle1648" class="indexterm"/><a id="iddle1655" class="indexterm"/><a id="iddle1769" class="indexterm"/><a id="iddle1796" class="indexterm"/><a id="iddle1803" class="indexterm"/><a id="iddle2303" class="indexterm"/><a id="iddle2307" class="indexterm"/><a id="iddle2314" class="indexterm"/><a id="iddle2322" class="indexterm"/>manage your GNS3 devices. I find that using a virtual access server is a fast way to manage and configure devices in GNS3, and you can also do it to learn the commands and keystrokes of a real access server.</p><p>A GNS3 virtual access server has two components. The first is a Cloud node configured with a virtual interface; you’ll use a Loopback Adapter driver in Windows and a TAP adapter in Linux. The second is a Cisco Dynamips router that acts as the management console. Configuring the virtual access server itself varies slightly depending on your operating system. I’ll cover Windows and Ubuntu Linux, but the concepts apply to other Linux operating systems. Unfortunately, OS X is not supported at the time of writing.</p><div class="sect2" title="Installing the Virtual Interface"><div class="titlepage"><div><div><h2 class="title"><a id="installing_the_virtual_interface"/>Installing the Virtual Interface</h2></div></div></div><p>Whether you use Windows or Linux, you’ll need to install a virtual network adapter and assign it an IP address. On Windows, you’ll install a Loopback Adapter driver, and on Unix-based systems like Linux, you’ll install a TAP driver. If you’re a Linux user, you can skip to <a class="xref" href="ch10.html#configuring_a_tap_adapter_in_linux" title="Configuring a TAP Adapter in Linux">Configuring a TAP Adapter in Linux</a>.</p><div class="sect3" title="Configuring a Loopback Adapter in Windows"><div class="titlepage"><div><div><h3 class="title"><a id="configuring_a_loopback_adapter_in_window"/>Configuring a Loopback Adapter in Windows</h3></div></div></div><p>If you haven’t done so already, install the Microsoft Loopback Adapter driver. (Refer to <a class="xref" href="ch07.html#using_a_loopback_adapter_on_windows" title="Using a Loopback Adapter on Windows">Using a Loopback Adapter on Windows</a>.) After you’ve installed the adapter, assign it an IP address. The IP address and subnet mask you choose must be unique from any network adapters already configured on your PC and from any IP addresses that you plan to use in your GNS3 network topology.</p><p>To configure the adapter, open the Windows <span class="strong"><strong>Control Panel</strong></span> and select <span class="strong"><strong>Network and Sharing Center</strong></span>. Next, select <span class="strong"><strong>Change Adapter Settings</strong></span> to display a list of available adapters, as shown in <a class="xref" href="ch10.html#selecting_properties_to_configure_the_mi" title="Figure 10-1. Selecting Properties to configure the Microsoft Loopback Adapter driver">Figure 10-1</a>.</p><div class="figure"><a id="selecting_properties_to_configure_the_mi"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00143"/><img src="httpatomoreillycomsourcenostarchimages2209155.png.jpg" alt="Selecting Properties to configure the Microsoft Loopback Adapter driver"/></div></div><p class="title">Figure 10-1. Selecting Properties to configure the Microsoft Loopback Adapter driver</p></div><p><a id="iddle1220" class="indexterm"/><a id="iddle1649" class="indexterm"/><a id="iddle1732" class="indexterm"/><a id="iddle2199" class="indexterm"/><a id="iddle2274" class="indexterm"/><a id="iddle2312" class="indexterm"/>Right-click the Microsoft Loopback Adapter driver and select <span class="strong"><strong>Properties</strong></span>. From the Properties window, select <a class="firstterm" href="apd.html#gloss01_030"><em class="firstterm">Internet Protocol Version 4 (TCP/IPv4)</em></a> and then click the <span class="strong"><strong>Properties</strong></span> button to display the IP address settings, shown in <a class="xref" href="ch10.html#configuring_your_loopback_adapter_driver" title="Figure 10-2. Configuring your Loopback Adapter driver with an IP address">Figure 10-2</a>.</p><div class="figure"><a id="configuring_your_loopback_adapter_driver"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00144"/><img src="httpatomoreillycomsourcenostarchimages2209157.png.jpg" alt="Configuring your Loopback Adapter driver with an IP address"/></div></div><p class="title">Figure 10-2. Configuring your Loopback Adapter driver with an IP address</p></div><p>Select <span class="strong"><strong>Use the following IP address</strong></span> and enter a unique IP address and subnet mask. I’ve chosen 9.9.9.9 and 255.255.255.0, but any address and mask will work, as long as they’re unique from any addresses assigned to any Ethernet adapters in your PC, and from any addresses that you plan to use in your GNS3 network topology. There’s no need to include a default gateway address or provide any DNS servers because they won’t be used by the access server. When you’re finished, click <span class="strong"><strong>OK</strong></span> to complete the configuration. Now close any open windows and launch GNS3. If you’re a Linux user, read on; otherwise, you can skip to <a class="xref" href="ch10.html#preparing_the_gns3_server" title="Preparing the GNS3 Server">Preparing the GNS3 Server</a>.</p></div><div class="sect3" title="Configuring a TAP Adapter in Linux"><div class="titlepage"><div><div><h3 class="title"><a id="configuring_a_tap_adapter_in_linux"/>Configuring a TAP Adapter in Linux</h3></div></div></div><p>On Ubuntu Linux, you’ll use a virtual TAP adapter for the access server. Open a terminal and enter the following command to install the drivers:</p><a id="pro_id00156"/><pre class="programlisting">$ <span class="strong"><strong>sudo apt-get install uml-utilities</strong></span></pre><p>To enable tap0, enter the following command, replacing <span class="emphasis"><em><code class="literal">jneumann</code></em></span> with your Linux username:</p><a id="pro_id00157"/><pre class="programlisting">$ <span class="strong"><strong>sudo tunctl -u <span class="emphasis"><em>jneumann</em></span> -t tap0</strong></span></pre><p>Next, assign a unique IP address to the tap0 interface. The IP address and subnet mask you choose must be unique from any network adapters configured on your PC and from any IP addresses that you plan to use in your GNS3 network topology.</p><a id="pro_id00158"/><pre class="programlisting">$ <span class="strong"><strong>sudo ifconfig tap0 9.9.9.9 netmask 255.255.255.0 up</strong></span></pre><p>To ensure the tap0 interface maintains its IP address and is available after a reboot, you’ll need to change your Linux network settings.</p><p><a id="iddle1351" class="indexterm"/><a id="iddle1456" class="indexterm"/><a id="iddle1489" class="indexterm"/><a id="iddle1552" class="indexterm"/><a id="iddle1556" class="indexterm"/><a id="iddle1644" class="indexterm"/><a id="iddle2123" class="indexterm"/><a id="iddle2167" class="indexterm"/><a id="iddle2310" class="indexterm"/>Open the <span class="emphasis"><em>interfaces</em></span> file under <span class="emphasis"><em>/etc/networks/</em></span> in a text editor like pico or vi. You’ll need administrator privileges to make changes to the file, so log in as <span class="emphasis"><em>root</em></span> or run the editor with the <code class="literal">sudo</code> command, as in <code class="literal">sudo pico interfaces</code>. Then, append the following to the end of the file:</p><a id="pro_id00159"/><pre class="programlisting"><span class="strong"><strong>auto tap0</strong></span>
<span class="strong"><strong>iface tap0 inet static</strong></span>
        <span class="strong"><strong>pre-up tunctl -t tap0</strong></span>
        <span class="strong"><strong>up ifconfig tap0 up</strong></span>
        <span class="strong"><strong>down ifconfig tap0 down</strong></span>
        <span class="strong"><strong>address 9.9.9.9</strong></span>
        <span class="strong"><strong>netmask 255.255.255.0</strong></span></pre><p>With these commands in place, save the <span class="emphasis"><em>interfaces</em></span> file, close it, and reboot. When Ubuntu restarts, the TAP driver should automatically load, and interface tap0 should be ready to use.</p><div class="warning" title="Warning"><h3 class="title"><a id="ch10note01"/>Warning</h3><p><span class="emphasis"><em>Use caution when editing the</em></span> /etc/networks/interfaces <span class="emphasis"><em>file. Entering a typo here can prevent Ubuntu from booting properly.</em></span></p></div><p>Enter the <code class="literal">ifconfig</code> command to verify the tap0 settings:</p><a id="pro_id00160"/><pre class="programlisting">  $ ifconfig
  --<span class="emphasis"><em>snip</em></span>--
➊ tap0    Link encap:Ethernet HWaddr 16:81:25:c1:cc:8c
➋         inet addr:9.9.9.9 Bcast:9.9.9.9.255 Mask:255.255.255.0
           UP BROADCAST MULTICAST MTU:1500 Metric:1
           RX packets:0 errors:0 dropped:0 overruns:0 frame:0
           TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:500
           RX bytes:0 (0.0 B) TX bytes:0 (0.0 B)</pre><p>The output from <code class="literal">ifconfig</code> should show that the tap0 adapter is enabled ➊ and configured with an IP address ➋. After you’ve installed and configured a virtual adapter, you’ll need to set up the GNS3 server.</p></div></div><div class="sect2" title="Preparing the GNS3 Server"><div class="titlepage"><div><div><h2 class="title"><a id="preparing_the_gns3_server"/>Preparing the GNS3 Server</h2></div></div></div><p>On Windows, run GNS3 as administrator. Begin by binding the GNS3 server to the IP address of your virtual interface; otherwise, your access server will not work. Click <span class="strong"><strong>Edit</strong></span> ▸ <span class="strong"><strong>Preferences</strong></span> and choose <span class="strong"><strong>GNS3 server</strong></span> from the left column. Select the <span class="strong"><strong>Host binding</strong></span> drop-down menu and then select the IP address you assigned to the virtual interface, as shown in <a class="xref" href="ch10.html#changing_the_gns3_server_host_binding" title="Figure 10-3. Changing the GNS3 server host binding">Figure 10-3</a>.</p><p>In <a class="xref" href="ch10.html#changing_the_gns3_server_host_binding" title="Figure 10-3. Changing the GNS3 server host binding">Figure 10-3</a>, the IP address is 9.9.9.9 ➊. Click <span class="strong"><strong>Apply</strong></span> and <span class="strong"><strong>OK</strong></span>, and the GNS3 server should restart with the new host binding.</p><div class="figure"><a id="changing_the_gns3_server_host_binding"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00145"/><img src="httpatomoreillycomsourcenostarchimages2209159.png.jpg" alt="Changing the GNS3 server host binding"/></div></div><p class="title">Figure 10-3. Changing the GNS3 server host binding</p></div></div><div class="sect2" title="Creating a Virtual Access Server in GNS3"><div class="titlepage"><div><div><h2 class="title"><a id="creating_a_virtual_access_server_in_gns3"/>Creating a Virtual Access Server in GNS3</h2></div></div></div><p><a id="iddle1182" class="indexterm"/><a id="iddle1205" class="indexterm"/><a id="iddle1729" class="indexterm"/><a id="iddle1770" class="indexterm"/><a id="iddle1797" class="indexterm"/><a id="iddle1801" class="indexterm"/><a id="iddle1867" class="indexterm"/><a id="iddle1869" class="indexterm"/><a id="iddle1878" class="indexterm"/><a id="iddle2200" class="indexterm"/><a id="iddle2263" class="indexterm"/><a id="iddle2302" class="indexterm"/>With your GNS3 server bound to the virtual adapter’s IP address, you can create the virtual access server. The access server is created using two devices: a Cloud node and a Dynamips IOS router.</p><div class="sect3" title="Configuring the Cloud Node"><div class="titlepage"><div><div><h3 class="title"><a id="configuring_the_cloud_node"/>Configuring the Cloud Node</h3></div></div></div><p>Begin a project by adding a Cloud node to your workspace. Right-click the Cloud node and select <span class="strong"><strong>Configure</strong></span>. If you’re running Windows, select the <span class="strong"><strong>NIO Ethernet</strong></span> tab (shown in <a class="xref" href="ch10.html#configuring_the_cloud_node_with_a_loopba" title="Figure 10-4. Configuring the Cloud node with a Loopback Adapter driver in Windows">Figure 10-4</a>).</p><p>Click the drop-down menu under Generic Ethernet NIO and select your Microsoft Loopback Adapter driver (<span class="strong"><strong>Loopback1</strong></span> in this example); then click <span class="strong"><strong>Add, Apply</strong></span>, and <span class="strong"><strong>OK</strong></span> to complete the configuration.</p><p>If you’re running GNS3 on Ubuntu Linux, configure the Cloud node using tap0. Instead of NIO Ethernet, select the <span class="strong"><strong>NIO TAP</strong></span> tab and enter <span class="strong"><strong>tap0</strong></span> in the TAP interface field, as in <a class="xref" href="ch10.html#configuring_nio_tap_with_tap0_on_ubuntu" title="Figure 10-5. Configuring NIO TAP with tap0 on Ubuntu Linux">Figure 10-5</a>.</p><div class="figure"><a id="configuring_the_cloud_node_with_a_loopba"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00146"/><img src="httpatomoreillycomsourcenostarchimages2209161.png.jpg" alt="Configuring the Cloud node with a Loopback Adapter driver in Windows"/></div></div><p class="title">Figure 10-4. Configuring the Cloud node with a Loopback Adapter driver in Windows</p></div><div class="figure"><a id="configuring_nio_tap_with_tap0_on_ubuntu"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00147"/><img src="httpatomoreillycomsourcenostarchimages2209163.png.jpg" alt="Configuring NIO TAP with tap0 on Ubuntu Linux"/></div></div><p class="title">Figure 10-5. Configuring NIO TAP with tap0 on Ubuntu Linux</p></div><p><a id="iddle1329" class="indexterm"/><a id="iddle1771" class="indexterm"/><a id="iddle1798" class="indexterm"/><a id="iddle1868" class="indexterm"/><a id="iddle1870" class="indexterm"/><a id="iddle1879" class="indexterm"/><a id="iddle2093" class="indexterm"/><a id="iddle2201" class="indexterm"/><a id="iddle2311" class="indexterm"/>When you’re finished, click <span class="strong"><strong>Add, Apply</strong></span>, and <span class="strong"><strong>OK t</strong></span>o complete the Cloud node configuration.</p></div><div class="sect3" title="Configuring the Access Server Router"><div class="titlepage"><div><div><h3 class="title"><a id="configuring_the_access_server_router"/>Configuring the Access Server Router</h3></div></div></div><p>After configuring the Cloud node, add a Dynamips router to your workspace and create a link from the router to the Cloud node. Together, these two devices comprise the virtual access server, shown in <a class="xref" href="ch10.html#virtual_access_server" title="Figure 10-6. Virtual access server">Figure 10-6</a>. They will not be linked to any other devices in your GNS3 project.</p><div class="figure"><a id="virtual_access_server"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00148"/><img src="httpatomoreillycomsourcenostarchimages2209165.png.jpg" alt="Virtual access server"/></div></div><p class="title">Figure 10-6. Virtual access server</p></div><p>After linking the virtual access server components together, add more routers to your workspace to create a simple three-router network, as shown in <a class="xref" href="ch10.html#network_configured_with_a_virtual_cisco" title="Figure 10-7. Network configured with a virtual Cisco access server">Figure 10-7</a>. This is the network topology that will be managed using the virtual access server.</p><div class="figure"><a id="network_configured_with_a_virtual_cisco"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00149"/><img src="httpatomoreillycomsourcenostarchimages2209167.png.jpg" alt="Network configured with a virtual Cisco access server"/></div></div><p class="title">Figure 10-7. Network configured with a virtual Cisco access server</p></div><p><a class="xref" href="ch10.html#network_configured_with_a_virtual_cisco" title="Figure 10-7. Network configured with a virtual Cisco access server">Figure 10-7</a> shows that you have created a virtual access server using router R1 and a Cloud node (Cloud 1), and you have created a network topology that’s made up of three routers, named R2, R3, and R4.</p><p>Now that you’ve created both the access server and a GNS3 network topology, you can configure the access server router. Assign router R1 an IP address from the same network as your PC’s virtual adapter, and test connectivity from R1 to the virtual adapter interface. For example, if you assigned the virtual adapter the IP address 9.9.9.9 255.255.255.0 as I have, you could assign the access server router R1 any IP address in that network range. I use the IP address 9.9.9.8 and the subnet mask 255.255.255.0.</p><p>To configure the address on interface f0/0, open a console connection to router R1 and enter the following commands:</p><a id="pro_id00161"/><pre class="programlisting">R1&gt;<span class="strong"><strong>enable</strong></span>
R1#<span class="strong"><strong>configure terminal</strong></span>
R1(config)#<span class="strong"><strong>interface f0/0</strong></span>
R1(config-if)#<span class="strong"><strong>ip address 9.9.9.8 255.255.255.0</strong></span>
R1(config-if)#<span class="strong"><strong>no shutdown</strong></span>
R1(config-if)#<span class="strong"><strong>exit</strong></span>
R1(config)#<span class="strong"><strong>exit</strong></span>
R1#<span class="strong"><strong>ping 9.9.9.9</strong></span>
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 9.9.9.9, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 1/1/4 ms</pre><p><a id="iddle1010" class="indexterm"/><a id="iddle1118" class="indexterm"/><a id="iddle1151" class="indexterm"/><a id="iddle1189" class="indexterm"/><a id="iddle1211" class="indexterm"/><a id="iddle1236" class="indexterm"/><a id="iddle1277" class="indexterm"/><a id="iddle1449" class="indexterm"/><a id="iddle1662" class="indexterm"/><a id="iddle1961" class="indexterm"/><a id="iddle2124" class="indexterm"/><a id="iddle2209" class="indexterm"/><a id="iddle2218" class="indexterm"/><a id="iddle2300" class="indexterm"/><a id="iddle2313" class="indexterm"/>In this configuration, router R1’s interface f0/0 is linked to the Cloud node and configured with IP address 9.9.9.8 255.255.255.0. Test the connection between R1 and the virtual interface using a <code class="literal">ping</code> command. If the ping test is successful, you’re ready to move on. If the ping test is unsuccessful, verify that all your interfaces are enabled and that the virtual interface (loopback or TAP) is configured with the proper IP address and subnet mask.</p></div></div><div class="sect2" title="Configuring a Cisco IP Hostname Table"><div class="titlepage"><div><div><h2 class="title"><a id="configuring_a_cisco_ip_hostname_table"/>Configuring a Cisco IP Hostname Table</h2></div></div></div><p>After configuring an IP address on the virtual access server (R1), you’re ready to configure an IP hostname table using information gathered from the devices that the access server will manage. In this project, the devices are routers R2, R3, and R4. Using Cisco IOS commands, you’ll create an IP hostname table using the IP address of the virtual interface (9.9.9.9) and the console port numbers that GNS3 has assigned to the routers used in your network topology. A Cisco IP hostname table works much like a Unix hosts file, except that you’ll also include port numbers in the table. You’ll create an entry for each device in the topology that you want to manage.</p><p>Begin by finding the console port numbers for routers that the access server will manage. In this project, you’re interested only in the console port numbers for routers R2, R3, and R4. You can quickly find any device’s console port number by hovering your mouse over the device, as shown in <a class="xref" href="ch10.html#displaying_device_information" title="Figure 10-8. Displaying device information">Figure 10-8</a>.</p><div class="figure"><a id="displaying_device_information"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00150"/><img src="httpatomoreillycomsourcenostarchimages2209169.png.jpg" alt="Displaying device information"/></div></div><p class="title">Figure 10-8. Displaying device information</p></div><p>Router R2’s console is on port 2002. Because console port numbers are assigned sequentially as devices are added to a project, routers R2, R3, and R4 should have been assigned the console port numbers 2002, 2003, and 2004, respectively. If you’re unsure, hover your mouse over each device icon to verify the information.</p><div class="note" title="Note"><h3 class="title"><a id="ch10note02"/>Note</h3><p><span class="emphasis"><em>If you add multiple routers at the same time, instead of one at a time, the console port numbers may not be assigned in sequential order.</em></span></p></div><p><a id="iddle1656" class="indexterm"/><a id="iddle1753" class="indexterm"/><a id="iddle1819" class="indexterm"/><a id="iddle2140" class="indexterm"/><a id="iddle2276" class="indexterm"/><a id="iddle2306" class="indexterm"/>To create the IP hostname table, open a console on router R1 (the access server) and enter the following commands:</p><a id="pro_id00162"/><pre class="programlisting">R1#<span class="strong"><strong>configure terminal</strong></span>
R1(config)#<span class="strong"><strong>ip host R2 2002 9.9.9.9</strong></span>
R1(config)#<span class="strong"><strong>ip host R3 2003 9.9.9.9</strong></span>
R1(config)#<span class="strong"><strong>ip host R4 2004 9.9.9.9</strong></span>
R1(config)#<span class="strong"><strong>exit</strong></span>
R1#</pre><p>Notice the host port numbers correspond with the unique console port numbers from the three routers you want to manage, but the IP address is always the same; it is the IP address assigned to the virtual adapter (9.9.9.9). That’s because when the virtual access server opens a console to one of the lab routers, GNS3 creates a telnet session from the access server to the routers using the virtual adapter’s IP address. From there, it connects to the individual console port number that you assigned. For example, when the access server opens a console connection to router R2, GNS3 telnets to IP address 9.9.9.9 using port number 2002. This is similar to how an actual Cisco access server works.</p><p>Now, verify which hosts are configured on your virtual access server with the <code class="literal">show hosts</code> command.</p><a id="pro_id00163"/><pre class="programlisting">R1&gt;<span class="strong"><strong>show hosts</strong></span>
Default domain is not set
Name/address lookup uses static mappings

Codes: UN - unknown, EX - expired, OK - OK, ?? - revalidate
       temp - temporary, perm - permanent
       NA - Not Applicable None - Not defined

Host➊                      Port➋ Flags      Age Type  Address(es)➌
R2                         2002  (perm, OK)  0   IP    9.9.9.9
R3                         2003  (perm, OK)  0   IP    9.9.9.9
R4                         2004  (perm, OK)  1   IP    9.9.9.9</pre><p>This command displays the hostname ➊, port number ➋, and IP address ➌ for each host configured on the access server.</p><div class="sidebar"><a id="virtual_access_server_limitations"/><p class="title">Virtual Access Server Limitations</p><p>There are limitations as to what devices can be managed by the virtual access server. Because the GNS3 server is bound to a virtual adapter and runs “locally” on your PC, the virtual access server can manage only local devices.</p><p>On a Windows PC, you cannot manage VirtualBox virtual machines, including IOU, though you can manage QEMU devices, like Junos. On Ubuntu Linux, you can manage all devices, including Dynamips, IOU, QEMU, and VirtualBox, as long they’re running locally on your Linux PC.</p></div><p><a id="iddle1242" class="indexterm"/><a id="iddle1350" class="indexterm"/><a id="iddle2094" class="indexterm"/><a id="iddle2146" class="indexterm"/><a id="iddle2308" class="indexterm"/>To learn more about configuring and using a real Cisco access server, visit the Cisco website (<span class="emphasis"><em><a class="ulink" href="http://www.cisco.com/">http://www.cisco.com/</a></em></span>) and search for <span class="emphasis"><em>configuring a comm server</em></span>. For now, you should know all you need to try your virtual access server.</p></div><div class="sect2" title="Seeing the Virtual Access Server in Action"><div class="titlepage"><div><div><h2 class="title"><a id="seeing_the_virtual_access_server_in_acti"/>Seeing the Virtual Access Server in Action</h2></div></div></div><p>After you’ve fully configured the access server and started your project routers, you should be able to manage those routers using the access server. You can open a console connection to several routers, and easily switch between them.</p><div class="sect3" title="Opening Consoles"><div class="titlepage"><div><div><h3 class="title"><a id="opening_consoles"/>Opening Consoles</h3></div></div></div><p>Begin by opening a console connection to R1. Right-click router R1 and choose <span class="strong"><strong>Console</strong></span>. Next, type the name of a host you want to manage and press</p><a id="pro_id00164"/><pre class="programlisting">R1&gt;<span class="strong"><strong>R2</strong></span>
Translating "R2"
Trying R2 (9.9.9.9➊, 2002➋)... Open
Connected to Dynamips VM "R2" (ID 1, type c3600) - Console port
Press ENTER to get the prompt.

R2&gt;➌</pre><p>In this example, I open a session with router R2 by entering <span class="strong"><strong><code class="literal">R2</code></strong></span> from the access server command line. The output shows that a session is established using IP address 9.9.9.9 ➊ and port number 2002 ➋, and the prompt ➌ has changed to the router being managed (R2 in this example). After the session is open, you can configure the router as though you opened a console directly from GNS3.</p><p>When you’re finished configuring the router, return to the access server console; just press <span class="smaller">SHIFT</span>-<span class="smaller">CTRL</span>-6 and then press the <span class="strong"><strong>X</strong></span> key. (Cisco calls this combination of actions an <span class="emphasis"><em>escape sequence</em></span>.) After returning to the access server console, enter the name of another router in your project to open a console on it. Try entering <span class="strong"><strong><code class="literal">R3</code></strong></span> now, and configure the router however you’d like. When you’re done, use the escape sequence again to return to the access server.</p><p>Even though you’re currently logged on to the access server console, the sessions on the other two routers remain open. To display a list of open sessions and their corresponding connection numbers, enter the <code class="literal">show sessions</code> command.</p><a id="pro_id00165"/><pre class="programlisting">R1&gt;<span class="strong"><strong>show sessions</strong></span>
Conn Host                     Address          Byte  Idle  Conn Name
     1 R2                      9.9.9.9           0     0    R2
 ➊*  2 R3                     9.9.9.9           0     0    R3</pre><p><a id="iddle1159" class="indexterm"/><a id="iddle1215" class="indexterm"/><a id="iddle1225" class="indexterm"/><a id="iddle1299" class="indexterm"/><a id="iddle1367" class="indexterm"/><a id="iddle1371" class="indexterm"/><a id="iddle2075" class="indexterm"/><a id="iddle2226" class="indexterm"/><a id="iddle2301" class="indexterm"/><a id="iddle2304" class="indexterm"/>You should see two active connections (1 and 2). The asterisk ➊ next to Conn 2 indicates that router R3 was the last session used. To return to the last session, press <span class="smaller">ENTER</span>. To return to a different session, type a connection number and press <span class="smaller">ENTER</span>; for example, you’d enter <code class="literal">1</code> to return to router R2.</p></div><div class="sect3" title="Closing Consoles"><div class="titlepage"><div><div><h3 class="title"><a id="closing_consoles"/>Closing Consoles</h3></div></div></div><p>When you’re ready to disconnect from an open connection, enter the <code class="literal">disconnect</code> command followed by the connection number; then press <span class="smaller">ENTER</span> to confirm closing the session.</p><a id="pro_id00166"/><pre class="programlisting">R1&gt;<span class="strong"><strong>disconnect 2</strong></span>
Closing connection to R3 [confirm]
R1&gt;</pre><p>In this example, I’ve disconnected from router R3 (connection 2). After disconnecting a session, you will have to enter the hostname again to reconnect to the device.</p></div><div class="sect3" title="Setting Connection Timeouts"><div class="titlepage"><div><div><h3 class="title"><a id="setting_connection_timeouts"/>Setting Connection Timeouts</h3></div></div></div><p>You may want to adjust the timeout setting (via the console <code class="literal">exec-timeout</code> parameter) on your routers and access server to ensure that you’re not logged out automatically during idle times, such as when you’re not actively configuring a router. The default value is ten minutes, but it can be set higher, lower, or changed to infinite.</p><p>The following commands set the console timeout to zero minutes and zero seconds (infinite):</p><a id="pro_id00167"/><pre class="programlisting">R1&gt;<span class="strong"><strong>enable</strong></span>
R1#<span class="strong"><strong>configure terminal</strong></span>
R1(config)#<span class="strong"><strong>line console 0</strong></span>
R1(config-line)#<span class="strong"><strong>exec-timeout 0 0</strong></span></pre><p>GNS3’s default <span class="emphasis"><em>startup-config</em></span> should have already done this for you, but know that from a security standpoint, never allowing the router to time out is a bad idea in production environments. It is, however, highly convenient in lab environments such as GNS3.</p></div></div></div><div class="sect1" title="Deploying Configurations to Real Hardware"><div class="titlepage"><div><div><h1 class="title"><a id="deploying_configurations_to_real_hardwar"/>Deploying Configurations to Real Hardware</h1></div></div></div><p>One of the benefits of GNS3 is that it allows you to create and test network configurations that can later be used on real equipment. You simply export a router configuration in GNS3 and load it on a real Cisco IOS router.</p><div class="sect2" title="Exporting GNS3 Configurations to Cisco Routers"><div class="titlepage"><div><div><h2 class="title"><a id="exporting_gns3_configurations_to_cisco_r"/>Exporting GNS3 Configurations to Cisco Routers</h2></div></div></div><p>After thoroughly testing a router configuration inside GNS3, you’re ready to export it and load it on a real Cisco router. You can export all the routers in your project, or you can export the configuration of an individual device. <a id="iddle1160" class="indexterm"/><a id="iddle1216" class="indexterm"/><a id="iddle1369" class="indexterm"/><a id="iddle1504" class="indexterm"/><a id="iddle1507" class="indexterm"/><a id="iddle1509" class="indexterm"/><a id="iddle1613" class="indexterm"/><a id="iddle1971" class="indexterm"/><a id="iddle2077" class="indexterm"/><a id="iddle2105" class="indexterm"/><a id="iddle2164" class="indexterm"/>Before exporting a GNS3 IOS router configuration, log in to that router and save its <span class="emphasis"><em>running-config</em></span> file to the <span class="emphasis"><em>startup-config</em></span> file. The saved <span class="emphasis"><em>startup-config</em></span> is the configuration that will be exported by GNS3.</p><a id="pro_id00168"/><pre class="programlisting">R1#<span class="strong"><strong>copy running-config startup-config</strong></span></pre><p>If you have any IOU devices in your project, you’ll need to make copies of their <span class="emphasis"><em>running-config</em></span> files, too. Just log in to the device and enter the following command to create a text file of the IOU configuration:</p><a id="pro_id00169"/><pre class="programlisting">IOU#<span class="strong"><strong>copy running-config unix:initial-config.cfg</strong></span></pre><p>After you’ve saved a <span class="emphasis"><em>running-config</em></span> file, you can export all device configurations at the same time by selecting <span class="strong"><strong>File</strong></span> ▸ <span class="strong"><strong>Import/Export device configs</strong></span>. GNS3 should then show the dialog in <a class="xref" href="ch10.html#importsolidusexport_tool_for_configurati" title="Figure 10-9. Import/export tool for configuration files">Figure 10-9</a>.</p><div class="figure"><a id="importsolidusexport_tool_for_configurati"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00151"/><img src="httpatomoreillycomsourcenostarchimages2209171.png.jpg" alt="Import/export tool for configuration files"/></div></div><p class="title">Figure 10-9. Import/export tool for configuration files</p></div><p>Select <span class="strong"><strong>Export configs to a directory</strong></span> from the drop-down menu, click <span class="strong"><strong>OK</strong></span>, browse to the location where you want to save your configuration files, and click <span class="strong"><strong>Open</strong></span> to save the configurations. The exported configuration files will be named after the devices in your workspace, like <span class="emphasis"><em>R1_startup-config.cfg</em></span> and <span class="emphasis"><em>IOU1_initial-config.cfg</em></span>. For each IOS device, you’ll also see a <span class="emphasis"><em>private config</em></span> file that’s used only by GNS3 and contains SSH crypto keys. You don’t need to upload this to your real Cisco router. This export method is an all-or-nothing procedure that exports all the device configurations in your project. To export the configuration of a single device, save the configuration, right-click the device in your project, and select <span class="strong"><strong>Export config</strong></span>. The saved file will be named using the device name.</p></div><div class="sect2" title="Importing Cisco Router Configurations into GNS3"><div class="titlepage"><div><div><h2 class="title"><a id="importing_cisco_router_configurations_in"/>Importing Cisco Router Configurations into GNS3</h2></div></div></div><p>Now, let’s look at how to import a live Cisco router configuration into GNS3. Begin by logging on to your real Cisco router and saving its configuration to your PC, using FTP or TFTP. Use a text editor to clean up any interface name discrepancies. Next, append the name of the exported file with <code class="literal">.cfg</code> to ensure that GNS3 can recognize the file. If you haven’t done so already, save your GNS3 project and stop the GNS3 router that is the target for the import. Finally, right-click the GNS3 router and choose <span class="strong"><strong>Import config</strong></span>. Browse to the directory where you saved the <span class="emphasis"><em>.cfg</em></span> file, and select the file to import it into the router. When you restart your GNS3 router, it should load and run the IOS configuration that you copied from the live Cisco router.</p><div class="note" title="Note"><h3 class="title"><a id="ch10note03"/>Note</h3><p><span class="emphasis"><em>When moving configurations back and forth between real routers and GNS3, you may have to perform some IOS configuration cleanup. For example, your GNS3 router may have an interface named</em></span> FastEthernet 0/0 <span class="emphasis"><em>while your real Cisco router has an interface named</em></span> FastEthernet 0 <span class="emphasis"><em>instead. In this case, use a text editor and modify the file before importing it into GNS3.</em></span></p></div></div></div><div class="sect1" title="Copying GNS3 Projects Between Platforms"><div class="titlepage"><div><div><h1 class="title"><a id="copying_gns3_projects_between_platforms"/>Copying GNS3 Projects Between Platforms</h1></div></div></div><p><a id="iddle1318" class="indexterm"/><a id="iddle1570" class="indexterm"/><a id="iddle1612" class="indexterm"/><a id="iddle1909" class="indexterm"/><a id="iddle1910" class="indexterm"/><a id="iddle1965" class="indexterm"/><a id="iddle1994" class="indexterm"/><a id="iddle2283" class="indexterm"/>Someday you may want to have your projects run on a PC that uses a different operating system than your existing PC. If your GNS3 projects include only Dynamips IOS routers and switches, you can copy them between different platforms such as Windows and Linux with minimal effort. But if they’re made up of other device types such as IOU, QEMU, or VirtualBox, the process can get complicated. Either way, moving a project between platforms is mostly a matter of copying one or more projects from your old GNS3 projects folder to the projects folder on a new PC.</p><div class="sect2" title="IOS-Only Projects"><div class="titlepage"><div><div><h2 class="title"><a id="ios-only_projects"/>IOS-Only Projects</h2></div></div></div><p>If your project consists of only Dynamips routers, then almost no additional configuration is necessary, as long as the target computer has compatible image files. If the target PC is configured with different IOS image files or the images are stored in a different directory, GNS3 should prompt you to substitute the original image file with one that’s already configured on the target computer, as shown in <a class="xref" href="ch10.html#substituting_an_ios_image_file" title="Figure 10-10. Substituting an IOS image file">Figure 10-10</a>.</p><div class="figure"><a id="substituting_an_ios_image_file"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00152"/><img src="httpatomoreillycomsourcenostarchimages2209173.png.jpg" alt="Substituting an IOS image file"/></div></div><p class="title">Figure 10-10. Substituting an IOS image file</p></div><p>In this example, you’re moving a project from a Windows PC to a Linux host. Even though the <span class="emphasis"><em>c3725-adventerprisek9-mz-124-15.T14.image</em></span> file is configured on the Linux host in <a class="xref" href="ch10.html#substituting_an_ios_image_file" title="Figure 10-10. Substituting an IOS image file">Figure 10-10</a>, GNS3 was unable to locate it because Windows stores IOS image files using a different path than Linux.</p><p>In this case, GNS3 should display a list of configured IOS images and allow you to choose one. Use the drop-down menu to select an image and click <span class="strong"><strong>OK</strong></span>. After selecting the image, GNS3 should update the path information in the project file on the target PC. To make the change permanent, you have to save your project. All of the original IOS configurations should remain intact, and your project should run as expected. If it doesn’t, start again and try using a different image file.</p></div><div class="sect2" title="Projects with IOU Devices"><div class="titlepage"><div><div><h2 class="title"><a id="projects_with_iou_devices"/>Projects with IOU Devices</h2></div></div></div><p>Copying projects that contain IOU devices can be a bit more involved. The easiest method is to re-create the IOU devices in the project on the target PC and then upload the original IOU configuration. Before copying the project to a new platform, follow these steps:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Log on to each IOU device in the project and copy the running configuration to the <span class="emphasis"><em>unix:initial-config.cfg</em></span> file. Right-click an IOU device <a id="iddle1191" class="indexterm"/><a id="iddle1240" class="indexterm"/><a id="iddle1368" class="indexterm"/><a id="iddle1370" class="indexterm"/><a id="iddle1503" class="indexterm"/><a id="iddle1505" class="indexterm"/><a id="iddle1776" class="indexterm"/><a id="iddle1907" class="indexterm"/><a id="iddle1932" class="indexterm"/><a id="iddle2351" class="indexterm"/>and choose <span class="strong"><strong>Export config</strong></span> to save the configuration. Be sure to copy the exported configuration file to the new system when you copy your project.</p></li><li class="listitem"><p>Open the project on the target PC and resolve any IOS image file substitution issues (refer to <a class="xref" href="ch10.html#substituting_an_ios_image_file" title="Figure 10-10. Substituting an IOS image file">Figure 10-10</a>).</p></li><li class="listitem"><p>On the target PC, delete the IOU device from your project, add a new one, and link the IOU device to other project devices using the same interfaces as the original project.</p></li></ol></div><p>To import the configuration, follow these steps:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Right-click the IOU device on the target PC and click <span class="strong"><strong>Import config</strong></span>.</p></li><li class="listitem"><p>Browse to the directory where the IOU configuration is saved and select the file. Do this for each IOU device in your project.</p></li><li class="listitem"><p>When you’re finished, start all the devices in your new project and verify that everything works as expected. Log on to each IOU device and examine its configuration. If everything looks good, save your updated project.</p></li></ol></div><p>Finally, let’s look at transferring projects that use VirtualBox.</p></div><div class="sect2" title="Projects with VirtualBox Devices"><div class="titlepage"><div><div><h2 class="title"><a id="projects_with_virtualbox_devices"/>Projects with VirtualBox Devices</h2></div></div></div><p>If you’re using a VirtualBox device in your original project, you’ll have to export it to an OVA file. Launch VirtualBox and choose <span class="strong"><strong>File</strong></span> ▸ <span class="strong"><strong>Export Appliance</strong></span> to save the device file. With the OVA prepared, follow these steps:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>Copy the OVA file to the new PC, launch VirtualBox, and choose <span class="strong"><strong>File</strong></span> ▸ <span class="strong"><strong>Import Appliance</strong></span> to import the file.</p></li><li class="listitem"><p>Launch GNS3 and add the VirtualBox virtual machine under Preferences, as discussed in <a class="xref" href="ch05.html#importing_appliances" title="Importing Appliances">Importing Appliances</a>.</p></li><li class="listitem"><p>Add the device to your GNS3 project and link it to other devices, selecting the same interfaces that were used in the original project.</p></li></ol></div><p>When you start your project on the new PC, your VirtualBox devices should have the same configuration they had on the old PC.</p></div></div><div class="sect1" title="Exploring the GNS3 Console"><div class="titlepage"><div><div><h1 class="title"><a id="exploring_the_gns3_console"/>Exploring the GNS3 Console</h1></div></div></div><p>The GNS3 management console provides a command line interface that you can use to control project devices. Based on the original Dynagen console that was written for Dynamips, the management console has been adapted and updated for GNS3. I won’t cover every aspect of the console here, but I will show you some more useful things you can do with it.</p><p>By default, the management console should be visible when you launch GNS3. If not, select <span class="strong"><strong>View</strong></span> ▸ <span class="strong"><strong>Docks</strong></span> ▸ <span class="strong"><strong>Console</strong></span> to display the console window.</p><p><a id="iddle1001" class="indexterm"/><a id="iddle1174" class="indexterm"/><a id="iddle1258" class="indexterm"/><a id="iddle1455" class="indexterm"/><a id="iddle1831" class="indexterm"/><a id="iddle1947" class="indexterm"/><a id="iddle2038" class="indexterm"/><a id="iddle2135" class="indexterm"/><a id="iddle2144" class="indexterm"/><a id="iddle2158" class="indexterm"/><a id="iddle2169" class="indexterm"/>From the management prompt (<code class="literal">=&gt;</code>), enter <code class="literal">help</code> or a question mark (<code class="literal">?</code>) to see a list of commands. As you can see from the following listing, you can perform familiar tasks from the CLI, such as starting and stopping devices:</p><a id="pro_id00170"/><pre class="programlisting">=&gt; <span class="strong"><strong>?</strong></span>

Documented commands (type help &lt;topic&gt;):
========================================
console  debug  help  reload  show  start  stop  suspend  version</pre><p>To display the details and syntax of a specific command, enter <code class="literal">help</code> followed by a command name, as shown here:</p><a id="pro_id00171"/><pre class="programlisting">=&gt; <span class="strong"><strong>help show</strong></span>
   Show detail information about every device in current lab:
    show device

    Show detail information about a device:
    show device &lt;device_name&gt;

    Show the whole topology:
    show run

    Show topology info of a device:
    show run &lt;device_name&gt;</pre><p>The <code class="literal">show</code> command offers a lot of different options to display information about your hypervisors, devices, and configurations. For example, the <code class="literal">show run</code> command displays the entire contents of your project configuration file.</p><p>Two commands that are useful for testing networks are <code class="literal">suspend</code> and <code class="literal">start</code>. Together they can be used to simulate a router failure and recovery. Another helpful command is the <code class="literal">debug</code> command. It can provide useful information when a project isn’t running properly.</p></div><div class="sect1" title="Creating Projects Using Multiple PCs"><div class="titlepage"><div><div><h1 class="title"><a id="creating_projects_using_multiple_pcs"/>Creating Projects Using Multiple PCs</h1></div></div></div><p>You can run devices using multiple PCs, allowing you to distribute the resource load across multiple computers. Sharing resources lets you use one PC to design your projects while running the devices themselves on one or more other PCs. This means you can create and manage your GNS3 project using a low-end workstation (such as an old laptop) while actually running the devices on a high-end server. If you use multiple servers, you could build a GNS3 uberlab!</p><p>In this section, I’ll show you how to share resources in a basic client/server setup and cover strategies for creating an uberlab. Disable the firewalls on all PCs before you begin configuring client/server (or multiserver) load sharing, and let’s get started.</p><div class="sect2" title="A Dynamips Client/Server Setup"><div class="titlepage"><div><div><h2 class="title"><a id="dynamips_clientsolidusserver_setup"/>A Dynamips Client/Server Setup</h2></div></div></div><p><a id="iddle1175" class="indexterm"/><a id="iddle1176" class="indexterm"/><a id="iddle1314" class="indexterm"/><a id="iddle1435" class="indexterm"/><a id="iddle1568" class="indexterm"/><a id="iddle1645" class="indexterm"/><a id="iddle1737" class="indexterm"/><a id="iddle1806" class="indexterm"/><a id="iddle1830" class="indexterm"/><a id="iddle1915" class="indexterm"/><a id="iddle1946" class="indexterm"/><a id="iddle2060" class="indexterm"/><a id="iddle2126" class="indexterm"/><a id="iddle2132" class="indexterm"/><a id="iddle2270" class="indexterm"/><a id="iddle2422" class="indexterm"/>In this scenario, you operate GNS3 on one computer, while another GNS3 server runs on another PC. If you’re running GNS3 on OS X or Windows, this may sound familiar because that’s how the IOU virtual machine works. The IOU virtual machine runs on a virtual computer rather than on a separate PC, but otherwise, the concept is the same.</p><div class="sect3" title="Preparing Your Workstations"><div class="titlepage"><div><div><h3 class="title"><a id="preparing_your_workstations"/>Preparing Your Workstations</h3></div></div></div><p>In this example, I will use Windows for the client PC and Ubuntu Linux for the server PC. Begin by installing GNS3 on the two workstations. One workstation will be the client, where you configure and manage your projects, and the other is the server. The server will run only Dynamips routers, and it should have the better hardware because it will do most of the work. The more processing power and memory the server has, the better your devices will perform.</p><p>Launch GNS3 on each computer and configure an IOS image file. This lets you run both local and remote Dynamips routers at the same time and network them together using GNS3 from the client PC. When configuring GNS3 on the server PC, be sure to record the path and filename of your IOS image file. On my Ubuntu server, my image file path is <span class="emphasis"><em>/home/jneumann/GNS3/images/IOS/c3725-adventerprisek9-mz.124-15.T14.image</em></span>. You need this information to configure the remote Dynamips router on the client PC.</p><p>Next, find the IP address of each of your GNS3 PCs. In this example, my client PC is configured with the IP address 172.16.231.202, and my server PC is configured with the IP address 172.16.231.205. After configuring GNS3 and recording the IP and image path information, you should be ready to begin.</p></div><div class="sect3" title="Running gns3server"><div class="titlepage"><div><div><h3 class="title"><a id="running_gns3server"/>Running gns3server</h3></div></div></div><p>You must run the <code class="literal">gns3server</code> program from its install directory. Log on to the remote server PC and open a terminal window on Linux and OS X or a command prompt if you’re running Windows. On Windows, go to the <span class="emphasis"><em>C:\Program Files\GNS3</em></span> directory, and on OS X go to the <span class="emphasis"><em>/Applications/GNS3.app/Contents/Resources/Server/Contents/MacOS</em></span> directory.</p><p>When starting the server program, you have to specify the IP address of your server PC and the port number that the server will listen on; enter the command <code class="literal">gns3server --host</code> <span class="emphasis"><em><code class="literal">server-ip</code></em></span> <code class="literal">--port</code> <span class="emphasis"><em><code class="literal">port-number</code></em></span>. If you don’t know the IP address of your server PC, you can be lazy and use 0.0.0.0 and <code class="literal">gns3server</code> will listen on all configured interfaces. In the following example, I’ve started the <code class="literal">gns3server</code> program on Ubuntu Linux from the <span class="emphasis"><em>/usr/local/bin/</em></span> directory.</p><a id="pro_id00172"/><pre class="programlisting">$ <span class="strong"><strong>gns3server –-host 172.16.231.205 -–port 8000</strong></span>
2015-06-06 18:32:45 INFO main.py:145 GNS3 server version x.x
2015-06-06 18:32:45 INFO main.py:147 Copyright (c) 2007-2015 GNS3 Technologies
Inc.
2015-06-06 18:32:45 INFO main.py:150 Config file /home/jneumann/.config/GNS3/
gns3_server.conf loaded
2015-06-06 18:32:45 INFO main.py:163 Running with Python 3.4.2 and has PID 3436
2015-06-06 18:32:45 INFO main.py:72 Current locale is en_US.UTF-8
2015-06-06 18:32:45 WARNING project.py:397 Purge old temporary project f3b11fb8
-82ed-42c1-b66a-226198ce6189
2015-06-06 18:32:45 INFO server.py:214 ➊ Starting server on 172.16.231.205:8000</pre><p><a id="iddle1173" class="indexterm"/><a id="iddle1204" class="indexterm"/><a id="iddle1428" class="indexterm"/><a id="iddle1457" class="indexterm"/><a id="iddle1646" class="indexterm"/>After starting the server, you should see similar output, and if all goes well, the server will start on 172.16.231.205:8000 ➊, shown on the last line of the output. This indicates the server program is listening on IP address 172.16.231.205 using port number 8000.</p><div class="note" title="Note"><h3 class="title"><a id="ch10note04"/>Note</h3><p><span class="emphasis"><em>If you want the GNS3 server to listen on some other port number, say 8001, you can enter <code class="literal">gns3server --host 172.16.231.205 --port 8001</code> instead. To see a complete list of server options, enter <code class="literal">gns3server -–help</code> from the command line.</em></span></p></div></div><div class="sect3" title="Configuring the Client"><div class="titlepage"><div><div><h3 class="title"><a id="configuring_the_client"/>Configuring the Client</h3></div></div></div><p>That’s all there is to configuring the server, so you can turn your attention to the GNS3 client, a Windows PC in this example. In GNS3, select <span class="strong"><strong>Edit</strong></span> ▸ <span class="strong"><strong>Preferences</strong></span> and select <span class="strong"><strong>GNS3 Server</strong></span>, as shown in <a class="xref" href="ch10.html#setting_the_host_binding_to_the_ip_addre" title="Figure 10-11. Setting the host binding to the IP address of the Ethernet adapter">Figure 10-11</a>.</p><div class="figure"><a id="setting_the_host_binding_to_the_ip_addre"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00153"/><img src="httpatomoreillycomsourcenostarchimages2209175.png.jpg" alt="Setting the host binding to the IP address of the Ethernet adapter"/></div></div><p class="title">Figure 10-11. Setting the host binding to the IP address of the Ethernet adapter</p></div><p><a id="iddle1332" class="indexterm"/><a id="iddle1402" class="indexterm"/><a id="iddle1585" class="indexterm"/><a id="iddle1594" class="indexterm"/><a id="iddle2056" class="indexterm"/><a id="iddle2291" class="indexterm"/>Click the <span class="strong"><strong>Host binding</strong></span> drop-down menu and select the IP address of your Ethernet interface. On this PC, the address is 172.16.231.202. Click <span class="strong"><strong>Apply</strong></span> to complete the configuration.</p><p>Next, add the remote GNS3 server’s IP address to the remote server list on the client. Click the <span class="strong"><strong>Remote Servers</strong></span> tab, as shown in <a class="xref" href="ch10.html#configuring_the_remote_server_ip_on_the" title="Figure 10-12. Configuring the remote server IP on the client host">Figure 10-12</a>.</p><div class="figure"><a id="configuring_the_remote_server_ip_on_the"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00154"/><img src="httpatomoreillycomsourcenostarchimages2209177.png.jpg" alt="Configuring the remote server IP on the client host"/></div></div><p class="title">Figure 10-12. Configuring the remote server IP on the client host</p></div><p>In the Host field, enter the IP address of the remote GNS3 server. In this example, that IP address is 172.16.231.205. The default port number should be 8000, but you can change it if you’ve chosen some other port number on the remote PC. After adding the remote server, click <span class="strong"><strong>Apply</strong></span> to save the settings.</p><p>Next, select <span class="strong"><strong>Dynamips</strong></span> from the side menu and click the <span class="strong"><strong>General settings</strong></span> tab, as shown in <a class="xref" href="ch10.html#dynamips_server_settings" title="Figure 10-13. Dynamips server settings">Figure 10-13</a>.</p><p>Uncheck the <span class="strong"><strong>Use the local server</strong></span> setting and click <span class="strong"><strong>Apply</strong></span>. This ensures that you have the option to select a remote server when you configure a Dynamips router. Next, click <span class="strong"><strong>IOS routers</strong></span>, as shown in <a class="xref" href="ch10.html#configuring_a_remote_dynamips_router" title="Figure 10-14. Configuring a remote Dynamips router">Figure 10-14</a>.</p><div class="figure"><a id="dynamips_server_settings"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00155"/><img src="httpatomoreillycomsourcenostarchimages2209179.png.jpg" alt="Dynamips server settings"/></div></div><p class="title">Figure 10-13. Dynamips server settings</p></div><div class="figure"><a id="configuring_a_remote_dynamips_router"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00156"/><img src="httpatomoreillycomsourcenostarchimages2209181.png.jpg" alt="Configuring a remote Dynamips router"/></div></div><p class="title">Figure 10-14. Configuring a remote Dynamips router</p></div><p><a id="iddle1595" class="indexterm"/><a id="iddle1762" class="indexterm"/><a id="iddle1854" class="indexterm"/><a id="iddle2054" class="indexterm"/><a id="iddle2104" class="indexterm"/>Click <span class="strong"><strong>New</strong></span> to add a remote IOS router to your client PC, as shown in <a class="xref" href="ch10.html#selecting_the_remote_server_type" title="Figure 10-15. Selecting the Remote server type">Figure 10-15</a>.</p><div class="figure"><a id="selecting_the_remote_server_type"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00157"/><img src="httpatomoreillycomsourcenostarchimages2209183.png.jpg" alt="Selecting the Remote server type"/></div></div><p class="title">Figure 10-15. Selecting the Remote server type</p></div><p>Under Server type, select <span class="strong"><strong>Remote</strong></span> and uncheck <span class="strong"><strong>Load balance across all available remote servers</strong></span>. Click the <span class="strong"><strong>Run on Server</strong></span> drop-down menu, select your remote server’s IP address from the list, and click <span class="strong"><strong>Next</strong></span> to continue. Enter the path and IOS image name that you recorded from the remote server, as shown in <a class="xref" href="ch10.html#entering_the_remote_ios_image_path" title="Figure 10-16. Entering the remote IOS image path">Figure 10-16</a>.</p><div class="figure"><a id="entering_the_remote_ios_image_path"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00158"/><img src="httpatomoreillycomsourcenostarchimages2209185.png.jpg" alt="Entering the remote IOS image path"/></div></div><p class="title">Figure 10-16. Entering the remote IOS image path</p></div><p><a id="iddle1293" class="indexterm"/><a id="iddle1471" class="indexterm"/><a id="iddle2098" class="indexterm"/><a id="iddle2232" class="indexterm"/>After entering the path and filename, click <span class="strong"><strong>Next</strong></span> to continue. Enter a name in the Name field for your router, as shown in <a class="xref" href="ch10.html#naming_your_router" title="Figure 10-17. Naming your router">Figure 10-17</a>.</p><div class="figure"><a id="naming_your_router"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00159"/><img src="httpatomoreillycomsourcenostarchimages2209187.png.jpg" alt="Naming your router"/></div></div><p class="title">Figure 10-17. Naming your router</p></div><p>I’ve named my router <span class="emphasis"><em>c3725_on_Ubuntu</em></span> so that I can easily identify the router in the Devices toolbar, and I know from the name that it’s configured to run on a remote server.</p><p>At this point, you can click through the remaining options as if you’re configuring a local Dynamips router. Be sure to enter an Idle-PC value when asked, or calculate one if you haven’t already done so. Remember, Idle-PC values are calculated on a per-image basis, so the same value can be used on any PC that’s using the same IOS image file.</p><p>When you’re finished adding the router, it should be displayed in the Routers section of the Devices toolbar, as shown in <a class="xref" href="ch10.html#routers_section_of_the_devices_toolbar" title="Figure 10-18. Routers section of the Devices toolbar">Figure 10-18</a>.</p><p>This example has two c3725 routers; one is a local router installed on the Windows PC, and the other is installed on the remote Ubuntu server. When you create a project, you can use both routers in the same project, reducing the CPU and memory consumption on the client PC by half.</p><div class="figure"><a id="routers_section_of_the_devices_toolbar"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00160"/><img src="httpatomoreillycomsourcenostarchimages2209189.png.jpg" alt="Routers section of the Devices toolbar"/></div></div><p class="title">Figure 10-18. Routers section of the Devices toolbar</p></div><p>Now that you know how to set up GNS3 using multiple PCs, you can leverage the ability to create large GNS3 projects.</p><div class="sidebar"><a id="running_qemu_on_a_remote_server"/><p class="title">Running QEMU on a Remote Server</p><p><a id="iddle1177" class="indexterm"/><a id="iddle1436" class="indexterm"/><a id="iddle1832" class="indexterm"/><a id="iddle1948" class="indexterm"/><a id="iddle2261" class="indexterm"/><a id="iddle2396" class="indexterm"/>In addition to running IOU and IOS routers on a remote server, you can also run QEMU on a remote server. Just be sure to install QEMU on the server PC before you begin. The process of setting up a remote QEMU device on the client PC is almost the same as any other remote device. However, during the New QEMU VM wizard, you will need to select the QEMU binary file for the virtual machine, shown in <a class="xref" href="ch10.html#configuring_the_qemu_binary" title="Figure 10-19. Configuring the QEMU binary">Figure 10-19</a>.</p><div class="figure"><a id="configuring_the_qemu_binary"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00161"/><img src="httpatomoreillycomsourcenostarchimages2209191.png.jpg" alt="Configuring the QEMU binary"/></div></div><p class="title">Figure 10-19. Configuring the QEMU binary</p></div><p>GNS3 should query the remote server for a list of installed QEMU binary files, and the virtual machine that you create should run on the remote server using the binary file that you select. Use the drop-down menu to select a binary file for your virtual machine, usually <span class="emphasis"><em>qemu-system-i386</em></span> or <span class="emphasis"><em>qemu-system-x86_64</em></span>. Adjust the RAM size and click <span class="strong"><strong>Next</strong></span> . Configure the remaining options as if the virtual machine were a local device.</p></div></div></div><div class="sect2" title="Creating a GNS3 Uberlab"><div class="titlepage"><div><div><h2 class="title"><a id="creating_a_gns3_uberlab"/>Creating a GNS3 Uberlab</h2></div></div></div><p>GNS3 is all about scalability, and you can use it to create really large projects with dozens of switches and routers. One of the best ways to create an uberlab is to use multiple GNS3 servers. But what if you have one really fast computer and a few others that don’t perform as well? In that case, you may want to run more devices on one machine than the other. For example, you might run most of your routers on the high-end server and run fewer devices on the less powerful machines.</p><p><a id="iddle1078" class="indexterm"/><a id="iddle1086" class="indexterm"/><a id="iddle1088" class="indexterm"/><a id="iddle1091" class="indexterm"/><a id="iddle1094" class="indexterm"/><a id="iddle1110" class="indexterm"/><a id="iddle1127" class="indexterm"/><a id="iddle1129" class="indexterm"/><a id="iddle1132" class="indexterm"/><a id="iddle1135" class="indexterm"/><a id="iddle1197" class="indexterm"/><a id="iddle1446" class="indexterm"/><a id="iddle1513" class="indexterm"/><a id="iddle2116" class="indexterm"/>An uberlab doesn’t need to be confined to computers running on your local area network. If you’re using GNS3 on a corporate network with multiple sites connected by a VPN, you can use the client/server model to run a variety of hypervisors from across town or even across the country! All you have to do is start the <code class="literal">gns3server</code> application on a remote computer (over the VPN) and configure your local client using the IP address of the remote PC. The only difference between this and a regular client/server setup is that packets will be sent through the VPN to the remote server.</p></div></div><div class="sect1" title="Nerdy Labs for Fun and Profit"><div class="titlepage"><div><div><h1 class="title"><a id="nerdy_labs_for_fun_and_profit"/>Nerdy Labs for Fun and Profit</h1></div></div></div><p>You’ve explored the tools you need to configure all sorts of projects in GNS3, but what should you do with this newfound knowledge? You could study for certifications or just have some fun! In this section, I discuss both. Many of these projects are intended for advanced users, but feel free to modify them to create projects and challenges that are better suited for your skill level.</p><div class="sect2" title="Preparing for Cisco Exams"><div class="titlepage"><div><div><h2 class="title"><a id="preparing_for_cisco_exams"/>Preparing for Cisco Exams</h2></div></div></div><p>GNS3 is an amazing tool for education and certification, and it has everything you need to get Juniper or Cisco certified, starting at the entry-level JNCIA or CCNA all the way up to the crown jewel of Cisco certifications, the CCIE.</p><p>For entry-level exams such as CCNA or CCNP, start by searching online to find all sorts of network examples. You may even want to use the CBT Nuggets or Bryant Advantage videos with GNS3. Their videos are a good way to get started, and GNS3 is a great tool for experimenting with the concepts they introduce. If you’re studying for CCIE, you may want to use something like the INE workbooks (<span class="emphasis"><em><a class="ulink" href="http://www.ine.com/">http://www.ine.com/</a></em></span>). They’ve proven themselves as leaders in CCIE lab preparation.</p></div><div class="sect2" title="Securing Your Networks"><div class="titlepage"><div><div><h2 class="title"><a id="securing_your_networks"/>Securing Your Networks</h2></div></div></div><p>These days, just about everyone stores confidential information on some sort of network server, so having a secure network infrastructure isn’t just a good idea, it’s a way of preventing substantial financial losses, unwanted lawsuits, and entanglements with your firm’s errors and omissions (E&amp;O) insurance carrier.</p><p>In this section, I outline a few security-related challenges that can be fun and educational, and prevent data theft or loss.</p><div class="sect3" title="The “Hack My Rack” Challenge"><div class="titlepage"><div><div><h3 class="title"><a id="quotation_markhack_my_rackquotation_mark"/>The “Hack My Rack” Challenge</h3></div></div></div><p>Host a security competition with your friends! Each challenger creates a GNS3 project on their PC and applies as much security as they can to their devices. The challenge is for each user to crack the other users’ security. <a id="iddle1164" class="indexterm"/><a id="iddle1168" class="indexterm"/><a id="iddle1828" class="indexterm"/><a id="iddle1835" class="indexterm"/><a id="iddle1996" class="indexterm"/><a id="iddle2173" class="indexterm"/><a id="iddle2296" class="indexterm"/><a id="iddle2342" class="indexterm"/><a id="iddle2394" class="indexterm"/>After each user creates their own network on their PC, they’re allowed to install one VirtualBox virtual machine on their friend’s PC with any systemcracking tools they want to use. When the challengers are done creating their networks, they swap computers and start the clock. Now the Battle Royale begins! Use your VirtualBox virtual machine to crack into another challenger’s GNS3 network.</p></div><div class="sect3" title="Creating Cisco VPNs"><div class="titlepage"><div><div><h3 class="title"><a id="creating_cisco_vpns"/>Creating Cisco VPNs</h3></div></div></div><p>Create a Cisco site-to-site VPN or multisite VPN using Cisco routers and ASA devices. Try your hand at configuring a multihomed Cisco router with VPN failover. In this scenario, your WAN edge routers might have two or more interfaces configured with BGP to simulate WAN links to an Internet service provider. Someday you may want one of your own, or a client might need one. Learning how to do it in GNS3 is better than figuring it out on your client’s time!</p></div></div><div class="sect2" title="Practicing Real-World Scenarios"><div class="titlepage"><div><div><h2 class="title"><a id="practicing_real-world_scenarios"/>Practicing Real-World Scenarios</h2></div></div></div><p>The following project ideas are designed to get you thinking about life outside of the GNS3 sandbox. As a network administrator or engineer, you’ll need to understand the interworkings of multihomed networks, switch block design, and multiserver integration, just to name a few. Designing, running, and troubleshooting these types of networks in GNS3 is great preparation for the real world.</p><div class="sect3" title="Cisco Switch Block Design"><div class="titlepage"><div><div><h3 class="title"><a id="cisco_switch_block_design"/>Cisco Switch Block Design</h3></div></div></div><p>Understanding switching is an important part of managing networks. Although the GNS3 EtherSwitch router and IOU have restricted functionality, they’re useful for configuring and testing redundant switch blocks with protocols such as HSRP, VRRP, and GLBP. Try your hand at creating a fully redundant Cisco campus model switch block with Internet access.</p></div><div class="sect3" title="Multihomed Networks"><div class="titlepage"><div><div><h3 class="title"><a id="multihomed_networks"/>Multihomed Networks</h3></div></div></div><p>Although many small businesses connect to the Internet using a single static IP address, larger companies need more static IPs and BGP links to maintain their presence on the Internet. Using a few GNS3 routers and BGP, you can simulate a multihomed network connected to multiple Internet service providers. Add additional routers to your bogus ISP to simulate sites such as <span class="emphasis"><em><a class="ulink" href="http://www.google.com/">http://www.google.com/</a></em></span> or <span class="emphasis"><em><a class="ulink" href="http://www.gns3.com/">http://www.gns3.com/</a></em></span>. Then ping the bogus sites from your multihomed network.</p></div><div class="sect3" title="Multiple Vendor Integration"><div class="titlepage"><div><div><h3 class="title"><a id="multiple_vendor_integration"/>Multiple Vendor Integration</h3></div></div></div><p>Create a project using Cisco, Juniper, Arista, Linux, or any other routable device you can think of. Configure the devices using open standards such as RIP, OSPF, BGP, or other open standards that are supported by all the <a id="iddle2068" class="indexterm"/><a id="iddle2089" class="indexterm"/>vendors or use route redistribution to translate routes from one vendor device to another. The idea is to learn as much as you can about multi-vendor integration.</p></div><div class="sect3" title="Use Everything, Including the “Kitchen Sink”"><div class="titlepage"><div><div><h3 class="title"><a id="use_everythingcomma_including_the_quotat"/>Use Everything, Including the “Kitchen Sink”</h3></div></div></div><p>This project involves <span class="emphasis"><em>everything</em></span>! It’s simple: build the biggest, most badass project you can imagine. Use as many remote PCs as you can and run everything GNS3 has to offer: Cisco routers, switches, ASAs, IDSs/IPSs, Juniper, Firefly, Vyatta, Arista, and anything else you can think of. Apply every routing and switching protocol, and test end-to-end connectivity using <code class="literal">ping</code> or <code class="literal">traceroute</code>. Be sure to set up at least one ATM switch, a Frame Relay cloud, and a VPN or two.</p></div><div class="sect3" title="How Many Routers Does It Take to Blow Out a Lightbulb?"><div class="titlepage"><div><div><h3 class="title"><a id="how_many_routers_does_it_take_to_blow_ou"/>How Many Routers Does It Take to Blow Out a Lightbulb?</h3></div></div></div><p>Here’s a fun way to earn bragging rights. Challenge a friend to see whose PC can run the most routers in GNS3. With the right Idle-PC value, you may find that you can run more than 100 before Dynamips crashes or GNS3 starts to slow down too much to use. One trick is to run GNS3 on Linux because Dynamips seems to scale better on Linux than it does on Windows or OS X.</p></div><div class="sect3" title="Routers Gone Rogue"><div class="titlepage"><div><div><h3 class="title"><a id="routers_gone_rogue"/>Routers Gone Rogue</h3></div></div></div><p>This “fly in the ointment” challenge is another way to have fun with a friend. Each challenger builds a complex network using as many routers as they want. The more the better! The networks are then configured and thoroughly tested. Once both challengers are happy that their networks are running properly, they swap computers and break each other’s networks by changing a few configuration settings (dropping a fly in the ointment).</p><p>A break could be as simple as shutting down an interface or as complex as filtering BGP routes. It all depends on the skills of the individuals and the complexity of their networks. Once the networks are broken, the competitors swap computers again, and each tries to be the first to analyze and repair their original network.</p></div></div></div><div class="sect1" title="Final Thoughts"><div class="titlepage"><div><div><h1 class="title"><a id="final_thoughts-id00021"/>Final Thoughts</h1></div></div></div><p>A virtual Cisco access server takes some work to set up, but once configured, it’s an easy way to manage your devices. If you have a small project that uses only a few routers, then it may not be necessary. But if you have to manage a few dozen devices, it quickly becomes an invaluable tool.</p><p>GNS3 runs on multiple PC operating systems, but you’re not stuck with the one you’re currently using. Moving projects between systems is fairly straightforward, so don’t be afraid to try something new. GNS3 was designed using Linux and ported to Windows and OS X, so it runs great on Linux and generally uses fewer resources than it does running on Windows.</p><p>If you don’t have the newest PC hardware, you can load-balance hyper-visors across multiple PCs and create large projects that run better than they will on a single PC. This is also a great way to repurpose those old PCs you have lying around your home or office.</p><p>But the most important thing to remember about GNS3 is that it’s fun to use because you get to create networks that otherwise may be out of your reach. So be creative, and have fun!</p></div></div></body></html>