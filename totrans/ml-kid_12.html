<html><head></head><body><div id="sbo-rt-content"><section>
<header>
<figure class="opener">
<img src="Images/chapterart.png" alt="" width="855" height="416"/>
</figure>
<h1 class="chapterTitle">
<span class="ChapterNumber"><span epub:type="pagebreak" title="223" id="Page_223"/>14</span><br/>
<span class="ChapterTitle">Confusing the Computer</span>
</h1>
</header>
<p class="ChapterIntro"><span class="OpenerCap"><img src="Images/Alphabet-U.png" alt="Alphabet-U" class="dropcap" width="87" height="80"/></span>ntil now, we’ve been focused on the great things that we can do using ML, and on the ways that it is being used well in real-world applications. But, as you’ve seen throughout this book, ML systems are not perfect or all-knowing. Their behavior is determined by the training that we give them. The way that we train <span epub:type="pagebreak" title="224" id="Page_224"/>our ML systems will affect the responses that they give, and not always in a positive way. In this chapter, we’ll look at one of the most common challenges in creating AI systems: <em>bias</em><em/><em/><em/>.</p>
<p>The project in this chapter is based on an old story, sometimes described as the<em> Russian Tank problem</em><em/>, that is often told to AI students. It’s probably not true, but it illustrates the impact of bias in ML training sets.  </p>
<p>Here’s one example of how the story is told:</p>
<blockquote class="quote">
<p class="Blockquote">Once upon a time, the US Army decided to use ML to recognize tanks hiding behind trees in the woods. Researchers trained an ML model using photos of woods without tanks, and photos of the same woods with tanks hiding behind trees.</p>
<p class="Blockquote">The model seemed to do well with the researchers’ pictures, but when the US Army tested their system, it didn’t do any better than random guesses.</p>
<p class="Blockquote">It turned out that in the researchers’ training data, the photos of camouflaged tanks had been taken on a cloudy day, while photos of the plain forest had been taken on a sunny day. The ML model had learned to recognize cloudy days from sunny days, instead of recognizing camouflaged tanks.</p>
</blockquote>
<p>Here’s another version:</p>
<blockquote class="quote">
<p class="Blockquote">Once upon a time, the US Army tried training a computer to recognize the difference between Russian and American tanks. Researchers trained an ML model using photos they took of American tanks and spy photos they collected of Russian tanks. </p>
<p class="Blockquote">The model seemed to do well with the researchers’ pictures, but when the US Army tested their system, the ML model didn’t do any better than random guesses.</p>
<p class="Blockquote">It turned out that the researchers’ photos of American tanks were large, high resolution, and high quality. But the long-distance spy photos they were able to get of Russian tanks were all blurry, low resolution, and grainy. </p>
<p class="Blockquote">The ML model had learned to recognize the difference between grainy photos and high-quality photos, instead of between Russian and American tanks.</p>
</blockquote>
<p>As another example, when researchers at Stanford University were developing an ML system to recognize skin cancers from photos<span epub:type="pagebreak" title="225" id="Page_225"/>, they accidentally created an ML model that recognized rulers, because medical photographs of skin cancers normally include a ruler to show the size of the lesion or tumor.</p>
<p>The point is that, due to unintentional bias, ML systems can learn to spot patterns that their creators might not have been aware of or that weren’t intended to be treated as patterns. </p>
<p>In this chapter, you’ll train an image classifier to recognize pictures of objects, but you’ll introduce bias to make it get things wrong. We’ll see firsthand what sorts of problems can cause an ML model to make mistakes, and then we’ll talk about how we can avoid these problems and fix the model.</p>
<h2 id="h1-500563c14-0001">Build Your Project</h2>
<p class="BodyFirst">Choose two objects that you want to train the computer to recognize photographs of. Pick things that are obviously different. Don’t choose anything too personal, as you’ll need to upload the photos to the internet to do the project.</p>
<p>For my screenshots, I chose a lemon and a grapefruit that I found in my kitchen. You can choose anything you like, though.</p>
<p>Put the first object down somewhere and take 10 similar-looking photographs of it. You don’t need the photos to be high resolution. Small photos (under 800 pixels in width) will work best.</p>
<p>I put my grapefruit down on a wooden floor in a dark room, and took the photos shown in <a id="figureanchor14-1" href="#figure14-1">Figure 14-1</a>. </p>
<figure>
<img src="Images/f14001.png" alt="f14001" width="675" height="348"/>
<figcaption><p><a id="figure14-1" href="#figureanchor14-1">Figure 14-1:</a> Photos of my first object, a grapefruit </p></figcaption>
</figure>
<p><span epub:type="pagebreak" title="226" id="Page_226"/>Put the second object down somewhere different and take 10 photographs of it.</p>
<p>I put my lemon down on a cream-colored carpet in a bright, light room and took the photos shown in <a id="figureanchor14-2" href="#figure14-2">Figure 14-2</a>.</p>
<figure>
<img src="Images/f14002.png" alt="f14002" width="675" height="349"/>
<figcaption><p><a id="figure14-2" href="#figureanchor14-2">Figure 14-2:</a> Photos of my second object, a lemon </p></figcaption>
</figure>
<p>Don’t make the object too large in the photos. Try to keep the object in the same position in each photo, as shown in Figures <a href="#figure14-1">14-1</a> and <a href="#figure14-2">14-2</a>.</p>
<p>The aim is to make all 10 photographs very similar <em>within each set</em>, but to make everything—the object, the background, the lighting—different <em>between the two sets</em>. For example, if your photos of the first object are on a dark background, take your photos of the second object on a light background. But all<b> </b>the photos of the first object should be on the dark background, and all of the photos of the second object should be on the light background.</p>
<p>Here are some other ideas for how you could make your two sets of photographs different. </p>
<table id="tabular-500563c14-0001" border="1">
<thead>
<tr>
<td><b>If your photos of the first object are all…</b></td><td><b>Take all the photos of the second object…</b></td></tr>
</thead>
<tbody>
<tr>
<td>on a <em>dark</em> background</td><td>on a <em>light</em> background</td></tr>
<tr>
<td>on <em>tiles</em></td><td>on <em>grass</em></td></tr>
<tr>
<td><em>brightly lit</em></td><td><em>somewhere dark</em></td></tr>
<tr>
<td><em>clear</em>, <em>crisp</em>, and <em>focused</em></td><td><em>fuzzy</em> and <em>blurry</em></td></tr>
<tr>
<td><em>outdoors</em> with a garden in the background</td><td><em>indoors</em> with the same room in the background</td></tr>
</tbody>
</table>
<p><span epub:type="pagebreak" title="227" id="Page_227"/>Have another look at my photos. The photos in <a href="#figure14-1">Figure 14-1</a> have in common dark lighting, the dark brown surface, and the wooden pattern background. The photos in <a href="#figure14-2">Figure 14-2</a> have in common bright lighting, the cream surface, and the speckled carpet background. </p>
<p>You don’t have to copy my photos exactly. Be creative!</p>
<p>Once you’ve taken your 20 photos, you need to put them online somewhere to make them available for training. Choose any photo hosting web service that will let you upload photos to the internet for no charge. (If you already have an account with a photo sharing service, you might want to create a new one for this project, as your 20 similar photos of a couple of random household objects are probably not very interesting to share!)</p>
<p>The most important thing is to upload your photos somewhere they can be accessed without a login so that your ML system can access them and learn from them.</p>
<h3 id="h2-500563c14-0001">Train Your Model</h3>
<ol>
<li value="1">Go to <em><a href="https://machinelearningforkids.co.uk/" class="LinkURL">https://machinelearningforkids.co.uk/</a></em>. Create a new ML project, name it <code class="bold">Confuse the computer</code>, and set it to learn to recognize images.
<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<h2><span class="NoteHead">Note	</span></h2>
<p>If you’re not sure how to create an ML project, read the section <span class="xref" itemid="xref_target_“Creating a New ML Project” on page 9">“Creating a New ML Project” on page 9</span> in <span class="xref" itemid="xref_target_Chapter 2">Chapter 2</span>. </p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
</li>
<li value="2">Click <b>Train</b>, as shown in <a id="figureanchor14-3" href="#figure14-3">Figure 14-3</a>. 
<figure>
<img src="Images/f14003.png" alt="f14003" width="676" height="261"/>
<figcaption><p><a id="figure14-3" href="#figureanchor14-3">Figure 14-3:</a> Click <b>Train</b> to prepare your training buckets. </p></figcaption>
</figure>
</li>
<li value="3"><span epub:type="pagebreak" title="228" id="Page_228"/>Click <b>Add new label</b> and create two training buckets, as shown in <a id="figureanchor14-4" href="#figure14-4">Figure 14-4</a>. Name them after the two objects that you have chosen. (The name you choose won’t have any effect on the training, but it’s useful for you.) I named mine grapefruit and lemon.
<figure>
<img src="Images/f14004.png" alt="f14004" width="644" height="352"/>
<figcaption><p><a id="figure14-4" href="#figureanchor14-4">Figure 14-4:</a> Prepare two training buckets for your objects. </p></figcaption>
</figure>
</li>
<li value="4">Add the training images to your training buckets. To do so, arrange two browser windows side by side, as shown in <a id="figureanchor14-5" href="#figure14-5">Figure 14-5</a>. One should have your training buckets, and the other should have the photo sharing website with your photographs. 
<p class="ListBody">Drag the images from the photo sharing site and drop them into the appropriate training bucket.</p>
<figure>
<img src="Images/f14005.png" alt="f14005" width="605" height="331"/>
<figcaption><p><a id="figure14-5" href="#figureanchor14-5">Figure 14-5:</a> Arrange two browser windows side by side and drag the photos into your training buckets. </p></figcaption>
</figure>
</li>
<li value="5"><span epub:type="pagebreak" title="229" id="Page_229"/>Repeat step 4 until you’ve got all 20 photos in your training buckets, as shown in <a id="figureanchor14-6" href="#figure14-6">Figure 14-6</a>.
<figure>
<img src="Images/f14006.png" alt="f14006" width="677" height="371"/>
<figcaption><p><a id="figure14-6" href="#figureanchor14-6">Figure 14-6:</a> Drag all of your photos into the training buckets. </p></figcaption>
</figure>
</li>
<li value="6">Click <b>Back to project</b> in the top-left corner of the screen.</li>
<li value="7">Click <b>Learn &amp; Test</b>.</li>
<li value="8">Click <b>Train new machine learning model</b>, as shown in <a id="figureanchor14-7" href="#figure14-7">Figure 14-7</a>.</li>
</ol>
<figure>
<img src="Images/f14007.png" alt="f14007" width="676" height="368"/>
<figcaption><p><a id="figure14-7" href="#figureanchor14-7">Figure 14-7:</a> Start training an ML model. </p></figcaption>
</figure>
<p>It will take a few minutes for your ML model to train. While you’re waiting, continue to the next step to prepare your project. </p>
<h3 id="h2-500563c14-0002"><span epub:type="pagebreak" title="230" id="Page_230"/>Prepare Your Project</h3>
<p class="BodyFirst">Take another photograph of each of your two objects, <em>but this time, switch the backgrounds</em><em/>.</p>
<p>In other words, take a photo of the first object where you took the photos of the second object before. Take a photo of the second object where you took the photos of the first object before.</p>
<p>For me, that meant taking a photo of the lemon on a dark wooden floor, and a photo of the grapefruit on a brightly lit cream carpet. Compare the test photos I took in <a id="figureanchor14-8" href="#figure14-8">Figure 14-8</a> with the training photos in Figures <a href="#figure14-1">14-1</a> and <a href="#figure14-2">14-2</a>.</p>
<figure>
<img src="Images/f14008.png" alt="f14008" width="677" height="252"/>
<figcaption><p><a id="figure14-8" href="#figureanchor14-8">Figure 14-8:</a> Swap the backgrounds for your test photos. </p></figcaption>
</figure>
<p>You don’t need to upload these photos anywhere. You just need access to them on your computer to be able to use them for testing.</p>
<ol>
<li value="1">Click <b>Back to project</b> and then click <b>Make</b>, as shown in <a id="figureanchor14-9" href="#figure14-9">Figure 14-9</a>.
<figure>
<img src="Images/f14009.png" alt="f14009" width="676" height="262"/>
<figcaption><p><a id="figure14-9" href="#figureanchor14-9">Figure 14-9:</a> Time to make your test! </p></figcaption>
</figure>
</li>
<li value="2"><span epub:type="pagebreak" title="231" id="Page_231"/>Click <b>Scratch 3</b>, as shown in <a id="figureanchor14-10" href="#figure14-10">Figure 14-10</a>.
<figure>
<img src="Images/f14010.png" alt="f14010" width="676" height="277"/>
<figcaption><p><a id="figure14-10" href="#figureanchor14-10">Figure 14-10:</a> Click <b>Scratch 3</b> to test your model. </p></figcaption>
</figure>
</li>
<li value="3">Click <b>Open in Scratch 3</b>.</li>
<li value="4">Move your mouse pointer over the Choose a Sprite icon (the cat face) in the bottom-right corner. Click <b>Upload Sprite</b> as shown in <a id="figureanchor14-11" href="#figure14-11">Figure 14-11</a>. Upload one of your two new test photos.
<figure>
<img src="Images/f14011.png" alt="f14011" width="676" height="369"/>
<figcaption><p><a id="figure14-11" href="#figureanchor14-11">Figure 14-11:</a> Upload a new sprite. </p></figcaption>
</figure>
</li>
<li value="5">Copy the script shown in <a id="figureanchor14-12" href="#figure14-12">Figure 14-12</a>. This script tries to recognize the sprite costume image and displays what your ML model recognizes the photo as.
<span epub:type="pagebreak" title="232" id="Page_232"/><figure>
<img src="Images/f14012.png" alt="f14012" width="657" height="358"/>
<figcaption><p><a id="figure14-12" href="#figureanchor14-12">Figure 14-12:</a> Write a short test script. </p></figcaption>
</figure>
</li>
<li value="6">Click <b>Upload Sprite</b> again to upload your second test photograph. Create the same script as before for your second sprite, as shown in <a id="figureanchor14-13" href="#figure14-13">Figure 14-13</a>.</li>
</ol>
<figure>
<img src="Images/f14013.png" alt="f14013" width="676" height="376"/>
<figcaption><p><a id="figure14-13" href="#figureanchor14-13">Figure 14-13:</a> Upload a second sprite and add another test script. </p></figcaption>
</figure>
<h3 id="h2-500563c14-0003">Test Your Project</h3>
<p class="BodyFirst">It’s time to run your test! Your scripts should classify both of your new test photos and display what your ML model recognized them as. Click the Green Flag to test your ML model. </p>
<p>My results are shown in <a id="figureanchor14-14" href="#figure14-14">Figure 14-14</a>.</p>
<p>As you may have expected, your ML model probably gave the wrong answer.</p>
<span epub:type="pagebreak" title="233" id="Page_233"/><figure>
<img src="Images/f14014.png" alt="f14014" width="677" height="369"/>
<figcaption><p><a id="figure14-14" href="#figureanchor14-14">Figure 14-14:</a> Test results for my ML model </p></figcaption>
</figure>
<p>I trained an ML model with state-of-the-art advanced technology, but it couldn’t tell the difference between a lemon and a grapefruit—something that a person can do easily.</p>
<p>Why do you think it went so wrong?</p>
<h2 id="h1-500563c14-0002">Review and Fix Your Project</h2>
<p class="BodyFirst">There are several reasons why my ML model gave the wrong answer.</p>
<p>Think about the area taken up in the photos. The object made up about 5 percent of the overall area of my photos. About 95 percent of each photo was the background, as shown in <a id="figureanchor14-15" href="#figure14-15">Figure 14-15</a>.</p>
<figure>
<img src="Images/f14015.png" alt="f14015" width="614" height="377"/>
<figcaption><p><a id="figure14-15" href="#figureanchor14-15">Figure 14-15:</a> Most of my photos were background. </p></figcaption>
</figure>
<p><span epub:type="pagebreak" title="234" id="Page_234"/>When you collect training examples to create an ML model, you’re asking the computer to identify what those examples have in common so that it can recognize when it’s given something with similar characteristics in the future.</p>
<p>When I tested my model with the photo of a lemon, 95 percent of the photo was very, very similar to 95 percent of all of the training photos of grapefruits in <a href="#figure14-1">Figure 14-1</a>. There was nothing in the way that we trained the ML model to make it clear that the part we were interested in was just that 5 percent of the photo in the middle, not the rest. </p>
<p>When you look at the training photos and the test photos side by side, you can see why the model made the choice it did.</p>
<figure>
<img src="Images/f14016.png" alt="f14016" width="677" height="371"/>
<figcaption><p><a id="figure14-16" href="#figureanchor14-16">Figure 14-16:</a> Compare the test and training photos to understand why the ML model was wrong. </p></figcaption>
</figure>
<p>Taking the photos as a whole, the largest part of my test photo (on the right of <a id="figureanchor14-16" href="#figure14-16">Figure 14-16</a>) is very similar to the largest part of every training photo I had labeled as “grapefruit.” </p>
<p>ML systems are designed to identify and recognize patterns in the examples you give them—but <em>these won’t necessarily be the patterns that you intended or that you would’ve recognized</em>. </p>
<p>Can you think of a way to fix your project?</p>
<p>There are several things you could do. For example, if your object made up a much more significant proportion of the overall image, as shown in <a id="figureanchor14-17" href="#figure14-17">Figure 14-17</a>, that might help.</p>
<span epub:type="pagebreak" title="235" id="Page_235"/><figure>
<img src="Images/f14017.png" alt="f14017" width="491" height="375"/>
<figcaption><p><a id="figure14-17" href="#figureanchor14-17">Figure 14-17:</a> Try making your object larger in the photos. </p></figcaption>
</figure>
<p>But this solution would be useful only for projects where you could be sure that all test images would show a similarly large object.  </p>
<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<h2><span class="NoteHead">Note 	</span></h2>
<p>The only thing your training examples should have in common are the attributes that you want the ML model to recognize. </p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
<p>For this project, the best way to be sure of that is to take lots of photos of your two objects with different places, backgrounds, lighting, sizes, angles, and orientations. Change everything that you can think of between the training examples, so that the only thing they have in common is the object itself. </p>
<p>For example, <a id="figureanchor14-18" href="#figure14-18">Figure 14-18</a> shows a much better set of training images for my grapefruit.</p>
<figure>
<img src="Images/f14018.png" alt="f14018" width="664" height="334"/>
<figcaption><p><a id="figure14-18" href="#figureanchor14-18">Figure 14-18:</a> A better way to train the ML model </p></figcaption>
</figure>
<p><span epub:type="pagebreak" title="236" id="Page_236"/>Varying the training images’ backgrounds, lighting, and level of focus is a good start toward training the ML model to identify only the grapefruit itself as the common factor among the images. </p>
<p>We could make the training even better still. For example, these training images all have the grapefruit in the same position and at the same size. That’s fine if I can guarantee that objects in my test photos will be at the same size and position when I test the model. But for a truly flexible model, I could also add photos where the grapefruit is at different sizes and positions.</p>
<p>Try improving your training examples for your two objects and training a new ML model. </p>
<p>If you vary the training examples, does the model pass your test?</p>
<h2 id="h1-500563c14-0003">What You Learned</h2>
<p class="BodyFirst">In this chapter, you’ve learned how important it is to have variation in your training sets. Whether it’s a military project that accidentally recognizes the weather instead of camouflaged tanks, a university research project inventing a ruler detector instead of a skin cancer classifier, or simply a system that can’t tell a grapefruit from a lemon, you’ve seen the impact of having <em>unintentional bias</em><em/><em/> in the datasets used to train an ML model. </p>
<p>In the next chapter, you’ll see the risks of introducing <em>intentional bias</em> in ML projects.</p>
</section>
</div></body></html>