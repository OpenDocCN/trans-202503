<html><head></head><body>
<h2 class="h2" id="ch11"><a id="page_231"/><strong><span class="blue"><span class="big">11</span></span></strong><br/><strong>SAVING AND LOADING BUILDINGS WITH FILES AND MODULES</strong></h2>
<div class="image1"><img src="graphics/common01.jpg" alt="image"/></div>
<p class="noindent">Files are a major part of computing. They let you save data for long-term storage and load data for use in your programs. So far, the programs you’ve been working with have stored data only in variables. You’ve either used hardcoded data in your programs or taken data from user input. Although you can do amazing things with this data, you’re limited to single sessions and your own Minecraft world. Once you learn how to store and retrieve data, you can save and load your Minecraft creations into any Minecraft world, even your friends’ games!</p>
<p class="indent">In this chapter, you’ll learn how to get input from files and how to output data to files. You’ll use some built-in functions in Python and learn how to use two Python <em>modules</em>, the <code>pickle</code> and <code>shelve</code> modules, to store entire Minecraft creations.</p>
<p class="indent">Modules can extend what it’s possible to accomplish with Python. Using modules, you can draw pictures on the screen or run websites. Modules also provide functions for common tasks so you don’t have to write your own solutions.</p>
<p class="indent"><a id="page_232"/>You’ll also learn about pip, which is a very useful program for installing new modules. You’ll try it out by using the <code>Flask</code> module to make a simple website that connects to Minecraft and displays the player’s position.</p>
<h3 class="h3" id="ch11lev1sec01"><strong><span class="blue">USING FILES</span></strong></h3>
<p class="noindent">When you work with computers, you work with files all the time. Anytime you write a text document or some Python code and save it, you’re working with files. Text, pictures, videos, and music are all files! Even this book was stored as a text file while I was writing it. Python’s file-handling features are easy to learn and will let you create files, save files, and read information from files to do cool things in Minecraft. Let’s start with the basics and learn how to read and write to a text file in Python.</p>
<h4 class="h4" id="ch11lev2sec01"><strong><span class="blue">OPENING A FILE</span></strong></h4>
<p class="noindent">Opening a file is the first step when you’re working with files. To open a file in Python, you use the <code>open()</code> function, which takes two arguments: the file’s location and its permissions. A file’s <em>location</em> is where the file is stored on your computer. You’ll pass this into the <code>open()</code> function in the form of a string. The file’s <em>permissions</em> control whether or not Python is allowed to read or modify the file.</p>
<p class="indent">To open (or create) a text file named <em>secretFile.txt</em> in Python, you would use the argument <code>"secretFile.txt"</code>:</p>
<p class="programs">secretFile = <span class="rose">open</span>(<span class="green">"secretFile.txt"</span>, <span class="green">"w"</span>)</p>
<p class="indent">The second argument, <code>"w"</code>, is the permissions argument, which specifies what the program is allowed to do with the file. In this case, <code>w</code> means that the program can write data to the file <em>secretFile.txt</em>.</p>
<p class="indent">When a program calls the <code>open()</code> function with a filename, Python first checks whether a file already exists with that name. If the file exists, Python will use the contents of that file in the program. If it doesn’t exist, Python will create a new file with that name.</p>
<p class="indent">If you don’t specify a <em>directory</em> with your filename (a folder and a directory are the same thing), Python will look for the file in the directory where the program is located. If the file is stored in a different directory, you must specify that in the argument. For example, if <em>secretFile.txt</em> was in the <em>secrets</em> directory, the first argument would be <code>"/secrets/secretFile.txt"</code>:</p>
<p class="programs">secretFile = <span class="rose">open</span>(<span class="green">"/secrets/secretFile.txt"</span>, <span class="green">"w"</span>)</p>
<p class="indent">If you provide a directory in the argument and the directory doesn’t exist, or if the file doesn’t exist, you’ll get an error message.</p>
<p class="indentb">There are four options for the permissions argument:</p>
<p class="hanging"><code><span class="codestrong">w</code></span> This means <em>write only</em>. Write-only permissions let the program write new data to the file and overwrite content that is already in the file, <a id="page_233"/>but the program cannot read the contents of the file. If a file doesn’t exist with the name that you provide as the first argument, the program will create a new one.</p>
<p class="hanging"><code><span class="codestrong">r</code></span> This means <em>read only</em>. Read-only permissions let the program read the contents of the file, but the program is not allowed to modify the file’s contents. This permission cannot be used to create a new file.</p>
<p class="hanging"><code><span class="codestrong">r+</code></span> This means <em>read and write</em>. Read-and-write permissions let the program read and change the contents of the file. The program can also write over any content that is already in the file. However, if the file doesn’t exist, a new one will not be created; instead, you’ll get an error.</p>
<p class="hanging"><code><span class="codestrong">a</code></span> This stands for <em>append</em>. Append permissions let the program write new data only to the end of the file, leaving the other contents of the file intact. The program cannot read the contents of the file either. This permission can be used to create a new file.</p>
<p class="indentt">There are different circumstances in which you’d use each kind of permission. Let’s say you write some directions to an awesome diamond mine that you found, and you want to load the directions into Minecraft without accidentally changing them. In that case, you’d want to use the read-only permission to make sure nothing in the file changes. Alternatively, if you want someone to be able to add data to a file but you don’t want them to see the other data stored in the file, you would use the append permission. For instance, you could use append if you want to let your friends add notes to a shared travel log without letting them peak inside and read about all your secret treasure!</p>
<p class="indent">Next, you’ll learn how to write data to an open file, and you’ll learn how to close that file to use that data later.</p>
<h4 class="h4" id="ch11lev2sec02"><strong><span class="blue">WRITING TO AND SAVING A FILE</span></strong></h4>
<p class="noindent">The <code>write()</code> function writes data to a file that the program has opened. This is the bread and butter of working with files because it lets you save all kinds of data. You provide the data you want written to the file as an argument to the <code>write()</code> function.</p>
<p class="indent">For example, let’s open a file and write a simple string to it:</p>
<p class="programs">   secretFile = <span class="rose">open</span>(<span class="green">"secretFile.txt"</span>, <span class="green">"w"</span>)<br/>   secretFile.write(<span class="green">"This is a secret file. Shhh! Don't tell anyone."</span>)<br/><span class="ent">➊</span> secretFile.close()</p>
<p class="indent">First, you must open the file using the <code>open()</code> function. Next, use dot notation to call the <code>write()</code> function to write a string to <em>secretFile.txt</em>. Then, you need to call the <code>close()</code> function <span class="ent">➊</span>, which saves and closes the file. It’s important to remember to include the <code>close()</code> function; otherwise, the data will not be stored in the file.</p>
<p class="indent">Run the program and then open <em>secretFile.txt</em> in a text editor to see if your secret message was saved. Try changing the string to write something <a id="page_234"/>different to the file and run the program again. What happens? The old message should have been replaced with the new message! Try changing the message again, but instead of passing <code>"w"</code> pass in <code>"a"</code> instead. Now what happens? Pretty cool, huh?</p>
<h4 class="h4" id="ch11lev2sec03"><strong><span class="blue">READING A FILE</span></strong></h4>
<p class="noindent">The <code>read()</code> function reads the entire contents of a file that a program has opened. You may want to use the data in your program, modify the data and then send it back to the file, or output the data to make it easy to look at. Whatever the reason, you’ll use the <code>read()</code> function to read files.</p>
<p class="indent">To read a file, you must first open it and then remember to close it when you’re finished. It’s important to learn this habit when you’re working with files in your programs to avoid errors!</p>
<p class="indent">Let’s read a file and then output its contents so we can see what it says. This program, <em>showSecretFile.py</em>, outputs the contents of a file using the <code>read()</code> and <code>print()</code> functions:</p>
<p class="sidenote"><span class="blue"><em>showSecretFile.py</em></span></p>
<p class="programs">   secretFile = <span class="rose">open</span>(<span class="green">"secretFile.txt"</span>, <span class="green">"r"</span>)<br/><br/><span class="ent">➊</span> <span class="rose">print</span>(secretFile.read())<br/>   secretFile.close()</p>
<p class="indent">First, we open the file, and we pass in <code>"r"</code> as the permission argument so our program can read from the file. You could also pass in <code>"r+"</code>, but in this case we’re not writing to the file, so <code>"r"</code> is best. To print out the contents of <em>secretFile.txt</em>, we pass <code>secretFile.read()</code> to a <code>print</code> statement. Finally, even though we haven’t written any data to the file, it’s still a good idea to close it with the <code>close()</code> function.</p>
<p class="indent">Run the program to see what happens. The contents of <em>secretFile.txt</em> should be printed to the screen. Now you can read the file without having to open it in a text editor like you normally would!</p>
<h4 class="h4" id="ch11lev2sec04"><strong><span class="blue">READING A LINE OF A FILE</span></strong></h4>
<p class="noindent">Let’s say you have a long text document and you want to look at only part of it. This is where the <code>readline()</code> function comes in handy. Unlike the <code>read()</code> function, which gets the entire contents of the file, the <code>readline()</code> function gets a single line of the file at a time.</p>
<p class="indent">To try the <code>readline()</code> function, first add a bunch of text to <em>secretFile.txt</em>. You can do this either by using a text editor or by using your fancy new Python abilities to write a bunch of information to it! If you use Python to write to your file, add <code>\n</code> to your strings whenever you want a new line. For example, if you write <code>"Cool\nDance\nParty"</code> to a file, Python places <code>"Cool"</code> on one line, <code>"Dance"</code> on the next, and <code>"Party"</code> on the last line, like so:</p>
<p class="programs"><span class="blue1">Cool</span><br/><span class="blue1">Dance</span><br/><span class="blue1">Party</span></p>
<p class="indent"><a id="page_235"/>After you’ve added text to <em>secretFile.txt</em>, write this code into a Python file and save the file as <em>showSecretLines.py</em> in a new folder called <em>files</em>:</p>
<p class="sidenote"><span class="blue"><em>showSecretLines.py</em></span></p>
<p class="programs">secretFile = <span class="rose">open</span>(<span class="green">"secretFile.txt"</span>, <span class="green">"r"</span>)<br/><br/><span class="rose">print</span>(secretFile.readline())<br/><span class="rose">print</span>(secretFile.readline())<br/><span class="rose">print</span>(secretFile.readline())<br/><br/>secretFile.close()</p>
<p class="indent">Once again, you must open <em>secretFile.txt</em> before you can read from it using the <code>readline()</code> function. Because you want your <em>showSecretLines.py</em> program to read data from the file, you must pass in <code>r</code> (or <code>r+</code>) again. Next, include three <code>print</code> statements to print the first three lines of <em>secretFile.txt</em>. Finally, close the file again using <code>close()</code>.</p>
<p class="indent">The <code>readline()</code> function starts with the first line of your file. Each time the <code>readline()</code> function is used, it reads the next line automatically. This function is very handy for printing a couple of lines from the beginnings of text files.</p>
<div class="note">
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>
<p class="notep"><em>The</em> <code><span class="codeitalic">readline()</code></span> <em>function converts the file to a list of strings, where each item in the list represents a single line. If you want to print a line from the middle of a text document, you could write a loop to find and print a particular string in the list!</em></p>
</div>
<h4 class="h4a" id="ch11lev2sec05"><strong>MISSION #64: TO-DO LIST</strong></h4>
<p class="noindent">Sometimes you might not have much spare time to play Minecraft. You might build complex structures across several days in short sessions. As you add programs to open doors or teleport the player somewhere, your builds will become more complex and might take longer to finish. Working on projects across several days could cause you to forget what you were doing and what you need to do next. This happens to me often. Fortunately, you can make a program to help you remember!</p>
<p class="indent">The programs in this mission create a to-do list and display it in the Minecraft chat. You can use this program to keep track of your Minecraft goals so when you have to stop playing, you can easily pick up where you left off.</p>
<p class="indent">To make the to-do list, you’ll write two separate programs: one to write the list and the other to display the list. Let’s start by creating the program that writes the list.</p>
<h4 class="h4" id="ch11lev2sec06"><strong><span class="blue">PART 1: WRITING THE TO-DO LIST</span></strong></h4>
<p class="noindent">First, you need a program to create the items in the to-do list. <a href="ch11.html#ch11ex1">Listing 11-1</a> starts you off, using a <code>while</code> loop and the <code>input()</code> function to add items to the to-do list. Copy it into a file in IDLE and save it as <em>inputToDoList.py</em> in the <em>files</em> folder.</p>
<p class="sidenote"><a id="page_236"/><span class="blue"><em>inputToDoList.py</em></span></p>
<p class="programs"><span class="ent">➊</span> toDoFile =<br/><br/><span class="ent">➋</span> toDoList = <span class="green">""</span><br/><br/><span class="ent">➌</span> toDoItem = <span class="rose">input</span>(<span class="green">"Enter a to-do list item: "</span>)<br/><br/><span class="ent">➍</span> <span class="orange">while</span> toDoItem != <span class="green">"exit"</span>:<br/><span class="ent">➎</span>     toDoList = toDoList + toDoItem + <span class="green">"\n"</span><br/>       toDoItem = <span class="rose">input</span>(<span class="green">"Enter a to-do list item: "</span>)<br/><br/><span class="ent">➏</span> <span class="red"># Write the to-do list to the file</span><br/><span class="ent">➐</span> <span class="red"># Close the file</span></p>
<p class="examplet"><a id="ch11ex1"/><em>Listing 11-1: The start of the program to write items in your to-do list</em></p>
<p class="indent">The program creates an empty string called <code>toDoList</code> <span class="ent">➋</span>, which will store all the items for your to-do list when you enter them. Using the <code>input()</code> function, the program then asks you to enter an item into the to-do list <span class="ent">➌</span>. The <code>while</code> loop then checks whether the input is not equal to <code>"exit"</code> <span class="ent">➍</span>; if it’s not, the program adds your item to the to-do list with a new line at the end using <code>"\n"</code> <span class="ent">➎</span>. However, if you enter <code>"exit"</code>, the loop no longer runs, and you won’t be able to add any more items to the to-do list.</p>
<p class="indent">Your mission is to finish the program. To do that, you need to write the code that opens the file, writes <code>toDoList</code> to the file, and then closes the file. Use the <code>open()</code> function to open the file at the start of the program <span class="ent">➊</span>. You should open it with write permissions. Name the file that the function opens <em>toDoList.txt</em>. Your program will create the file if it doesn’t already exist in the directory.</p>
<p class="indent">At the end of the program, write the contents of the to-do list to the file so you can access it later. Use the <code>write()</code> function to write the <code>toDoList</code> variable to the <code>toDoFile</code> <span class="ent">➏</span>. After the file has been written to, make sure you close it with the <code>close()</code> function on the last line <span class="ent">➐</span>.</p>
<p class="indent"><a href="ch11.html#ch11fig1">Figure 11-1</a> shows me writing a to-do list with the program. When I’m finished, I type <code>exit</code>.</p>
<div class="image"><img src="graphics/f11-01.jpg" alt="image"/></div>
<p class="figcap"><a id="ch11fig1"/><em>Figure 11-1: Entering things to do, like build a cake forest and play hide-and-seek</em></p>
<h4 class="h4" id="ch11lev2sec07"><a id="page_237"/><strong><span class="blue">PART 2: DISPLAYING THE TO-DO LIST</span></strong></h4>
<p class="noindent">Now that you have a program to write a to-do list to a file, you need to display the to-do list in the Minecraft chat, one line at a time. <a href="ch11.html#ch11ex2">Listing 11-2</a> starts the program for you. Copy the listing into a new file and save it as <em>outputToDoList.py</em> in the <em>files</em> folder.</p>
<p class="sidenote"><span class="blue"><em>outputToDoList.py</em></span></p>
<p class="programs">   <span class="orange">from</span> mcpi.minecraft <span class="orange">import</span> Minecraft<br/>   mc = Minecraft.create()<br/><br/><span class="ent">➊</span> toDoList =<br/><br/>   <span class="orange">for</span> line <span class="orange">in</span> toDoList:<br/><span class="ent">➋</span>     <span class="red"># Output "line" to the chat</span></p>
<p class="examplet"><a id="ch11ex2"/><em>Listing 11-2: Program to output the to-do list file to the Minecraft chat</em></p>
<p class="indent"><a href="ch11.html#ch11ex2">Listing 11-2</a> uses a <code>for</code> loop to output each line in the <em>toDoList.txt</em> file to the Minecraft chat, one at a time. At the moment, the program is incomplete. To finish the program, add the <code>open()</code> function to open the <em>toDoList.txt</em> file that you created with <em>inputToDoList.py</em> <span class="ent">➊</span>. Make sure the file has read permissions. After you open the file, add code inside the <code>for</code> loop to output the string stored in the <code>line</code> variable to Minecraft’s chat <span class="ent">➋</span>. You’ll have to use the <code>readline()</code> and <code>postToChat()</code> functions to do this.</p>
<p class="indent"><a href="ch11.html#ch11fig2">Figure 11-2</a> shows my to-do list in the Minecraft chat.</p>
<div class="image"><img src="graphics/f11-02.jpg" alt="image"/></div>
<p class="figcap"><a id="ch11fig2"/><em>Figure 11-2: Now when I come back to building, I can see what I need to do.</em></p>
<h3 class="h3" id="ch11lev1sec02"><a id="page_238"/><strong><span class="blue">USING MODULES</span></strong></h3>
<p class="noindent"><em>Modules</em> are collections of functions that you can import into Python so you don’t have to write those functions in your programs. A module usually has a specific purpose, such as performing scientific calculations or making games, and a wide variety of modules are available for Python. You might be surprised to know that you’ve been using modules throughout this book! The Minecraft Python API is a module: every time you’ve written <code>from mcpi.minecraft import Minecraft</code>, you’ve been using a module. The Minecraft Python API module lets you connect your Python programs to Minecraft. Because it’s prewritten by someone else, you can use the module’s functions without having to write the code yourself.</p>
<p class="indent">Python comes with a bunch of modules that you can use in your programs. These modules, together with all the Python you’ve learned in this book so far, are called the <em>Python standard library</em>. You can also install modules that are not part of the standard library; we’ll do that in “<a href="ch11.html#ch11lev1sec04">Installing New Modules with pip</a>” on <a href="ch11.html#page_252">page 252</a>.</p>
<p class="indent">In this section, you’ll learn all the ways that you can set up your programs to use modules. As an example, we’ll use the <code>pickle</code> module, which provides more advanced ways to save and load data with files than just writing and reading data from them. Let’s look at the <code>pickle</code> module now.</p>
<h4 class="h4" id="ch11lev2sec08"><strong><span class="blue">THE PICKLE MODULE</span></strong></h4>
<p class="noindent">The <code>pickle</code> module is very useful when you’re writing complicated data to a file. For example, dictionaries and multidimensional lists are challenging to store and retrieve using the standard functions that we used earlier in the chapter. This is where the <code>pickle</code> module comes in handy.</p>
<p class="indent">The <code>pickle</code> module can save you hours of writing and debugging your own solutions for storing complex data. You can also use the <code>pickle</code> module on simple data: for example, you can use it to store numbers without converting them to and from strings, which is necessary for standard file input and output.</p>
<p class="indent">In other words, you can use the <code>pickle</code> module to save a variable’s value in a file and then read the variable’s value directly into another program without any extra processing. The data type remains the same as when you stored the value, even if the data type is a string, integer, float, or Boolean.</p>
<p class="indent">Next, you’ll learn how to import modules using <code>pickle</code> as an example. Then you’ll use <code>pickle</code> to save some complex data—an entire Minecraft building!</p>
<h4 class="h4" id="ch11lev2sec09"><strong><span class="blue">IMPORTING PICKLE</span></strong></h4>
<p class="noindent">To use any module’s functions, you need to import them by using the <code>import</code> keyword. Actually, you’ve already used the <code>import</code> keyword to import modules, such as the <code>time</code> module, as well as functions from the Python Minecraft API.</p>
<p class="indent"><a id="page_239"/>After you’ve imported the module into your program, you can use the module’s functions by using dot notation. Include the module name, a dot, and the function you want to use. Let’s import the <code>pickle</code> module and use a couple of its functions:</p>
<p class="programs"><span class="ent">➊</span> <span class="orange">import</span> pickle<br/><br/>   locations = {<span class="green">'John'</span>: <span class="green">'Forest'</span>, <span class="green">'Phillipa'</span>: <span class="green">'Mountains'</span>, <span class="green">'Pete'</span>: <span class="green">'City'</span>}<br/><br/><span class="ent">➋</span> secretFile= <span class="rose">open</span>(<span class="green">"secretFile.txt", "wb"</span>)<br/><span class="ent">➌</span> pickle.dump(locations, secretFile)</p>
<p class="indent">We import the <code>pickle</code> module at <span class="ent">➊</span>. Next we open <em>secretFile.txt</em> with a special file permission, <code>"wb"</code> <span class="ent">➋</span>. When you open a file with <code>pickle</code>, you must add <code>b</code> to the file permission. In this case, <code>"wb"</code> writes data to the file using a special format that the <code>pickle</code> module requires.</p>
<p class="indent">The <code>dump()</code> function writes to the file at <span class="ent">➌</span>. The <code>pickle</code> module’s <code>dump()</code> function stores a variable in a file. It takes two arguments: the data to be written to the file and the open file that it will write to. This example stores the locations of secret agents in a dictionary called <code>locations</code> and then dumps that dictionary in a file called <code>secretFile</code>. Because <code>dump()</code> belongs to the <code>pickle</code> module, you must use dot notation to specify both the module and the function with <code>pickle.dump()</code>. Unlike the standard file functions in Python, the <code>dump()</code> function saves the data to the file automatically—you don’t need to close the file with the <code>close()</code> function.</p>
<p class="indent">The <code>pickle</code> module also lets you read stored data. You can use <code>pickle</code>’s <code>load()</code> function to read the contents of a file. It takes one argument, the file that you want to load, and returns the contents of the file. The following example loads the <code>locations</code> dictionary we stored earlier. Add this code to the program:</p>
<p class="programs">   <span class="orange">import</span> pickle<br/><br/><span class="ent">➊</span> secretFile= <span class="rose">open</span>(<span class="green">"secretFile.txt"</span>, <span class="green">"rb"</span>)<br/>   locations = pickle.load(secretFile)</p>
<p class="indent">First we open the file with the permission <code>"rb"</code> <span class="ent">➊</span>, which allows your program to read a special data format that <code>pickle</code> uses. Then we load the dictionary.</p>
<p class="indent">Now that the dictionary has been loaded, you can treat it like any other dictionary. For example, you can access the value of one of the keys. Just add this code after the <code>pickle.load()</code> function:</p>
<p class="programs"><span class="rose">print</span>(locations[<span class="green">'Phillipa'</span>])</p>
<p class="indent">This will print <code>'Mountains'</code>, the value of the <code>'Phillipa'</code> key. That’s because the dictionary in the file is unchanged when it’s loaded into the <a id="page_240"/>program with <code>pickle</code>—it’s still a dictionary, so we can access its keys and values and use it just like any other Python dictionary. You could do the same with a list or a variable as well.</p>
<h4 class="h4" id="ch11lev2sec10"><strong><span class="blue">IMPORTING ONE FUNCTION WITH THE FROM CLAUSE</span></strong></h4>
<p class="noindent">Importing a module means you have access to all the functions in that module, but sometimes you need only one function in a module. If you want to import just one function, you use the <code>from</code> clause when you import the module. This clause lets you access the function without including the module name and dot notation every time you call a function. You would just write <code>function()</code> instead of <code>module.function()</code>.</p>
<p class="indent">Sometimes when you use the <code>pickle</code> module you might want to use only the <code>dump()</code> function, not its other functions. To do this, change the code that you wrote earlier so it looks like this:</p>
<p class="programs"><span class="ent">➊</span> <span class="orange">from</span> pickle <span class="orange">import</span> dump<br/><br/>   locations = {<span class="green">'John'</span>: <span class="green">'Forest'</span>, <span class="green">'Phillipa'</span>: <span class="green">'Mountains'</span>, <span class="green">'Pete'</span>: <span class="green">'City'</span>}<br/><br/>   secretFile= <span class="rose">open</span>(<span class="green">"secretFile"</span>, <span class="green">"wb"</span>)<br/><span class="ent">➋</span> dump(locations, secretFile)</p>
<p class="indent">The first line uses the <code>from</code> clause to import only the <code>dump()</code> function from the <code>pickle</code> module <span class="ent">➊</span>. The last line calls the <code>dump()</code> function <span class="ent">➋</span>. Notice that it doesn’t have dot notation. You just call the function name without referencing the module name.</p>
<p class="indent">You can also import more than one function from a module using <code>from</code>. All you need to do is separate the function names with a comma. For example, if you want to use the <code>dump()</code> and <code>load()</code> functions from <code>pickle</code> in the same file, you could import them both:</p>
<p class="programs"><span class="ent">➊</span> <span class="orange">from</span> pickle <span class="orange">import</span> dump, load<br/>   locations = {<span class="green">'John'</span>: <span class="green">'Forest'</span>, <span class="green">'Phillipa'</span>: <span class="green">'Mountains'</span>, <span class="green">'Pete'</span>: <span class="green">'City'</span>}<br/><br/>   secretFile= <span class="rose">open</span>(<span class="green">"secretFile"</span>, <span class="green">"wb"</span>)<br/><span class="ent">➋</span> dump(locations, secretFile)<br/><br/><span class="ent">➌</span> locations = load(secretFile)<br/>   <span class="rose">print</span>(locations[<span class="green">'Phillipa'</span>])</p>
<p class="indent">The first line uses the <code>from</code> clause with commas to import both the <code>dump()</code> and <code>load()</code> functions <span class="ent">➊</span>. This means that later in the program, you can use these functions without having to include the function name and dot notation, which you can see at <span class="ent">➋</span> and <span class="ent">➌</span>.</p>
<h4 class="h4" id="ch11lev2sec11"><a id="page_241"/><strong><span class="blue">IMPORTING ALL FUNCTIONS WITH *</span></strong></h4>
<p class="noindent">You can also import all the functions in a module so you don’t need to include the name of the module with dot notation every time you use it. You do this by entering an asterisk (<code>*</code>) at the end of the <code>import</code> statement, like this:</p>
<p class="programs"><span class="ent">➊</span> <span class="orange">from</span> pickle <span class="orange">import</span> *<br/>   locations = {<span class="green">'John'</span>: <span class="green">'Forest'</span>, <span class="green">'Phillipa'</span>: <span class="green">'Mountains'</span>, <span class="green">'Pete'</span>: <span class="green">'City'</span>}<br/><br/>   secretFile= <span class="rose">open</span>(<span class="green">"secretFile"</span>, <span class="green">"wb"</span>)<br/><span class="ent">➋</span> dump(locations, secretFile)<br/><br/><span class="ent">➌</span> locations = load(secretFile)<br/>   <span class="rose">print</span>(locations[<span class="green">'Phillipa'</span>])</p>
<p class="indent">Because this code imported all the functions in the module using an asterisk <span class="ent">➊</span>, we don’t need to use dot notation when we call the <code>dump()</code> <span class="ent">➋</span> and <code>load()</code> <span class="ent">➌</span> functions.</p>
<p class="indent">The <code>*</code> option is very handy, but it comes with a risk! If you’re working with multiple modules, two modules might share the same function names. When this happens, Python will get confused and you might get an error. So when you’re working with many modules, it’s best to avoid using the <code>*</code> option and instead import only the functions you need to use.</p>
<h4 class="h4" id="ch11lev2sec12"><strong><span class="blue">GIVING A MODULE A NICKNAME</span></strong></h4>
<p class="noindent">Sometimes you’ll want to rename a module because its name is too long and you want to use a shorter name in your program. Or, you want to change the module’s name to make it easier to remember. Or, perhaps you want to change its name because the module shares the same name as another module and you want to avoid conflicts.</p>
<p class="indent">You can use the <code>as</code> clause with the <code>import</code> statement to give a module an <em>alias</em>—a nickname. For example, this code imports the <code>pickle</code> module and renames it to <code>p</code>:</p>
<p class="programs"><span class="orange">import</span> pickle as p</p>
<p class="indent">Now, every time you want to use the <code>pickle</code> module, you can write <code>p</code> in your program instead of <code>pickle</code>. Here’s an example of this in action:</p>
<p class="programs">p.dump(locations, secretFile)</p>
<p class="indent">Notice that <code>p.dump()</code> is used instead of <code>pickle.dump()</code>. This saves you time because you don’t have to keep typing <code>pickle</code>!</p>
<h4 class="h4a" id="ch11lev2sec13"><a id="page_242"/><strong>MISSION #65: SAVE A BUILDING</strong></h4>
<p class="noindent">Building things is my favorite part of Minecraft. I’ve spent hours building houses, castles, villages, and so many other things. But when I move to another part of the map or to a different world, I have to leave my creations behind. I’m sure you’ve also had to abandon some awesome creations.</p>
<p class="indent">Wouldn’t it be cool if you could save your buildings and take them with you when you move into different worlds? Well, with <code>pickle</code> and the Python API, you can!</p>
<p class="indent">In this mission, you’ll develop two programs that will save and load buildings into your Minecraft game. One program will store the building, and the other will load the building. Both programs build on <em>duplicateArea.py</em> from <a href="ch10.html#ch10">Chapter 10</a> (<a href="ch10.html#page_225">page 225</a>).</p>
<h4 class="h4" id="ch11lev2sec14"><strong><span class="blue">PART 1: SAVING THE BUILDING</span></strong></h4>
<p class="noindent">The first program will save a building into a file. <a href="ch11.html#ch11ex3">Listing 11-3</a> includes the code to copy the building. Copy the listing into a file in IDLE and save it as <em>saveStructure.py</em> in the <em>files</em> folder.</p>
<p class="sidenote"><span class="blue"><em>saveStructure.py</em></span></p>
<p class="programs">   <span class="orange">from</span> mcpi.minecraft <span class="orange">import</span> Minecraft<br/>   mc = Minecraft.create()<br/><br/>   <span class="orange">import</span> pickle<br/><br/><br/>   <span class="orange">def</span> <span class="blue1">sortPair</span>(val1, val2):<br/>       <span class="orange">if</span> val1 &gt; val2:<br/>           <span class="orange">return</span> val2, val1<br/>       <span class="orange">else</span>:<br/>           <span class="orange">return</span> val1, val2<br/><br/><br/><span class="ent">➊</span> <span class="orange">def</span> <span class="blue1">copyStructure</span>(x1, y1, z1, x2, y2, z2):<br/>       x1, x2 = sortPair(x1, x2)<br/>       y1, y2 = sortPair(y1, y2)<br/>       z1, z2 = sortPair(z1, z2)<br/><br/>       width = x2 - x1<br/>       height = y2 - y1<br/>       length = z2 - z1<br/><br/>       structure = []<br/><br/>       <span class="rose">print</span>(<span class="green">"Please wait..."</span> )<br/><br/>       <span class="red"># Copy the structure</span><br/>       <span class="orange">for</span> row <span class="orange">in</span> <span class="rose">range</span>(height):<br/>           structure.append([])<br/>           <span class="orange">for</span> column <span class="orange">in</span> <span class="rose">range</span>(width):<br/>               structure[row].append([])<br/>               <span class="orange">for</span> depth <span class="orange">in</span> <span class="rose">range</span>(length):<br/><span class="ent">➋</span>                 block = mc.getBlock(x1 + column, y1 + row, z1 + depth)<br/>                   structure[row][column].append(block)<br/><br/>       <span class="orange">return</span> structure<br/><br/><span class="ent">➌</span> <span class="red"># Get the position of the first corner</span><br/>   <span class="rose">input</span>(<span class="green">"Move to the first position and press ENTER in this window"</span>)<br/>   pos1 = mc.player.getTilePos()<br/><br/>   x1 = pos1.x<br/>   y1 = pos1.y<br/>   z1 = pos1.z<br/><br/><span class="ent">➍</span> <span class="red"># Get the position of the second corner</span><br/>   <span class="rose">input</span>(<span class="green">"Move to the opposite corner and press ENTER in this window"</span>)<br/>   pos2 = mc.player.getTilePos()<br/><br/>   x2 = pos2.x<br/>   y2 = pos2.y<br/>   z2 = pos2.z<br/><br/><span class="ent">➎</span> structure = copyStructure( x1, y1, z1, x2, y2, z2)<br/><br/><span class="ent">➏</span> <span class="red"># Store the structure in a file</span></p>
<p class="examplet"><a id="ch11ex3"/><em>Listing 11-3: Incomplete code to store a building in a file</em></p>
<p class="indent"><a id="page_243"/>The <code>copyStructure()</code> function copies an area in the game into a set of three-dimensional lists <span class="ent">➊</span>. It takes two sets of coordinates as arguments. I’ve made a slight change in the <code>copyStructure()</code> function compared to <em>duplicateArea.py</em>. I’ve used the <code>getBlockWithData()</code> function instead of the <code>getBlock()</code> function <span class="ent">➋</span>. Rather than getting just the block ID for a block at certain coordinates, the <code>getBlockWithData()</code> function also gets the block’s state. This is useful for blocks like stairs, where the direction of the stairs is stored in the block state. When the structure is copied, stairs and other blocks that face a certain way will be built in the correct direction.</p>
<p class="indent">I’ve included some neat code so you can use the player’s position to set the coordinates of a building you want to copy. When you run the program, it asks you to move to the first corner of the structure and then press <small>ENTER</small> in the Python shell <span class="ent">➌</span>. The program uses the player’s position to get the first set of coordinates for the building. Next, it asks you to move to the opposite corner of the structure and do the same <span class="ent">➍</span>. As a result, you can just stand where you want to start copying your building instead of writing coordinates or hard-coding them into your program.</p>
<p class="indent">The values of these coordinate variables are passed to the function <code>copyStructure()</code> at <span class="ent">➎</span>. The returned value is stored in a variable called <code>structure</code>.</p>
<p class="indent">To complete the code, you need to open a new file with <code>pickle</code>. Call the new file <code>"pickleFile"</code>. Then write the code to store the building in the file. Do this by using the <code>pickle</code> module to write the value of the <code>structure</code> variable to a file <span class="ent">➏</span>.</p>
<p class="indent"><a id="page_244"/><a href="ch11.html#ch11fig3">Figure 11-3</a> shows a tower that I built in my Minecraft world.</p>
<div class="image"><img src="graphics/f11-03.jpg" alt="image"/></div>
<p class="figcap"><a id="ch11fig3"/><em>Figure 11-3: My tower that I want to copy</em></p>
<p class="indent">To copy the tower using <em>saveStructure.py</em>, I move to one corner and press <small>ENTER</small> in IDLE (<a href="ch11.html#ch11fig4">Figure 11-4</a>).</p>
<div class="image"><img src="graphics/f11-04.jpg" alt="image"/></div>
<p class="figcap"><a id="ch11fig4"/><em>Figure 11-4: Standing next to one corner of the tower</em></p>
<p class="indent">Then I fly to the opposite corner of the tower and press <small>ENTER</small> in IDLE a second time (<a href="ch11.html#ch11fig5">Figure 11-5</a>).</p>
<div class="image"><a id="page_245"/><img src="graphics/f11-05.jpg" alt="image"/></div>
<p class="figcap"><a id="ch11fig5"/><em>Figure 11-5: Flying to the opposite corner of the tower</em></p>
<p class="indent">Follow the same steps to use <em>saveStructure.py</em> to save one of your own buildings. Next we’ll complete the other half of the process and load our saved buildings into the game.</p>
<h4 class="h4" id="ch11lev2sec15"><strong><span class="blue">PART 2: LOADING THE BUILDING</span></strong></h4>
<p class="noindent">The second program needs to load the building into the game from the file (named <em>pickleFile</em>) created by <em>saveStructure.py</em>. <a href="ch11.html#ch11ex4">Listing 11-4</a> includes code from the <em>duplicateArea.py</em> program (<a href="ch10.html#page_225">page 225</a>) that places a building stored in lists. Copy the listing into a file in IDLE and save it as <em>loadStructure.py</em> in the <em>files</em> folder.</p>
<p class="sidenote"><span class="blue"><em>loadStructure.py</em></span></p>
<p class="programs">   <span class="orange">from</span> mcpi.minecraft <span class="orange">import</span> Minecraft<br/>   mc = Minecraft.create()<br/><br/>   <span class="orange">import</span> pickle<br/><br/><br/><span class="ent">➊</span> <span class="orange">def</span> <span class="blue1">buildStructure</span>(x, y, z, structure):<br/>       xStart = x<br/>       zStart = z<br/>       <span class="orange">for</span> row <span class="orange">in</span> structure:<br/>           <span class="orange">for</span> column <span class="orange">in</span> row:<br/>               <span class="orange">for</span> block <span class="orange">in</span> column:<br/>                   mc.setBlock(x, y, z, block.id, block.data)<br/>                   z += 1<br/>               x += 1<br/>               z = zStart<br/>           y += 1<br/>           x = xStart<br/><br/>   <span class="red"># Open and load the structure file</span><br/><span class="ent">➋</span> structure =<br/><br/><span class="ent">➌</span> pos = mc.player.getTilePos()<br/>   x = pos.x<br/>   y = pos.y<br/>   z = pos.z<br/><span class="ent">➍</span> buildStructure(x, y, z, structure)</p>
<p class="examplet"><a id="ch11ex4"/><em>Listing 11-4: When complete, this program will build a building from a file.</em></p>
<p class="indent"><a id="page_246"/>The <code>buildStructure()</code> function <span class="ent">➊</span> does most of the work in this program. It builds the structure in the game using four arguments: x-, y-, and z-coordinates and a structure stored in a three-dimensional list.</p>
<p class="indent">Import the <code>pickle</code> module so you can load the structure into the program, and then store it in the <code>structure</code> variable at <span class="ent">➋</span>. Using the <code>open()</code> function, open the <em>pickleFile</em> file that you saved the structure into. Then load it into the <code>structure</code> variable using <code>pickle</code>’s <code>load()</code> function. After the structure has been loaded, close <em>pickleFile</em> using <code>pickle</code>’s <code>close()</code> function.</p>
<p class="indent">Also included in <a href="ch11.html#ch11ex4">Listing 11-4</a> is some code that gets the player’s position to use as the starting location for the structure <span class="ent">➌</span>.</p>
<p class="indent">After the structure is loaded and the coordinates are set, pass the structure to the <code>buildStructure()</code> function along with a position <span class="ent">➍</span>, which will build the saved structure.</p>
<p class="indent"><a href="ch11.html#ch11fig6">Figure 11-6</a> shows the program in action. The building I saved earlier has been loaded into the game and rebuilt at a new position. Try it yourself—now you have the ability to take your creations with you wherever you go!</p>
<div class="image"><img src="graphics/f11-06.jpg" alt="image"/></div>
<p class="figcap"><a id="ch11fig6"/><em>Figure 11-6: Look, it’s a copy of my tower!</em></p>
<p class="indent">But what if you create a whole village and want to take it with you? You could save each building in its own file using <code>pickle</code>, but that’s not very convenient. The <code>pickle</code> module works great for saving a single building, but it’s not so good for saving a bunch of buildings. That’s where the <code>shelve</code> module comes in. Let’s look at that next.</p>
<h3 class="h3" id="ch11lev1sec03"><a id="page_247"/><strong><span class="blue">STORING LOTS OF DATA WITH THE SHELVE MODULE</span></strong></h3>
<p class="noindent">The <code>pickle</code> module can store only one piece of data at a time. In some programs, you might want to store several variables; if you use the <code>pickle</code> module, you’ll need to create several files, which can be difficult to manage.</p>
<p class="indent">Python’s <code>shelve</code> module solves this problem. It can store several items of data in a single file. It works like a dictionary in which each data value has a key that you can use to store and retrieve the data. Think of <code>shelve</code> like a shelf: each compartment in the shelf stores different data values.</p>
<h4 class="h4" id="ch11lev2sec16"><strong><span class="blue">OPENING A FILE WITH SHELVE</span></strong></h4>
<p class="noindent">After importing the <code>shelve</code> module, you’ll use its <code>open()</code> function to open a file. If the file doesn’t already exist, a new one will be created.</p>
<p class="indent">The following code opens the <em>locationsFile.db</em> file and stores it in the <code>shelveFile</code> variable:</p>
<p class="programs"><span class="orange">import</span> shelve<br/>shelveFile = shelve.open(<span class="green">"locationsFile.db"</span>)</p>
<p class="indent">The <code>open()</code> function takes only one argument, the name of the file. You don’t need to specify file permissions when you use the <code>shelve</code> module because it automatically grants read-and-write privileges.</p>
<p class="indent">When naming a file with the <code>shelve</code> module, you must include the <em>.db</em> extension at the end of the filename. You can see the <em>.db</em> at the end of my <em>locationsFile.db</em> file.</p>
<h4 class="h4" id="ch11lev2sec17"><strong><span class="blue">ADDING, MODIFYING, AND ACCESSING ITEMS WITH SHELVE</span></strong></h4>
<p class="noindent">The <code>shelve</code> module works like a dictionary. To add data to the file, you use square brackets with a key name to store a value. For example, let’s say a secret agent named Beatrice is on a submarine, and we want to store Beatrice’s location in the <code>shelveFile</code> dictionary:</p>
<p class="programs"><span class="orange">import</span> shelve<br/>shelveFile = shelve.open(<span class="green">"locationsFile.db"</span>)<br/>shelveFile[<span class="green">'Beatrice'</span>] = <span class="green">'Submarine'</span><br/>shelveFile.close()</p>
<p class="indent">First we open the file. Next, we give the <code>shelveFile</code> dictionary a key of <code>'Beatrice'</code> and the value <code>'Submarine'</code>. This line creates a new item in the <code>shelveFile</code> dictionary with the key <code>'Beatrice'</code> and the value <code>'Submarine'</code>.</p>
<p class="indent">Then we use <code>shelve</code>’s <code>close()</code> function to add the new data to the file and safely close the file.</p>
<p class="indent"><a id="page_248"/>If a key already exists in a shelve file, this code would update the old value to the new value. Let’s say that Beatrice finishes her mission and returns to headquarters. You could update Beatrice’s location like this:</p>
<p class="programs"><span class="orange">import</span> shelve<br/>shelveFile = shelve.open(<span class="green">'locationsFile.db'</span>)<br/>shelveFile[<span class="green">'Beatrice'</span>] = <span class="green">'Headquarters'</span><br/>shelveFile.close()</p>
<p class="indent">Now the corresponding value of the Beatrice key is <code>'Headquarters'</code>.</p>
<p class="indent">Accessing a value from <code>shelve</code> works just like a dictionary, too. You use keys to access specific values. For example, to print Beatrice’s location, we’d use the following code:</p>
<p class="programs"><span class="orange">import</span> shelve<br/>shelveFile = shelve.open(<span class="green">'locationsFile.db'</span>)<br/><span class="rose">print</span>(shelveFile[<span class="green">'Beatrice'</span>])</p>
<p class="indent">This will output Beatrice’s location, <code>Headquarters</code>.</p>
<p class="indent">Just like a standard dictionary, the <code>shelve</code> module can store any data type, including floats, strings, Booleans, multidimensional lists, other dictionaries, and so on. In fact, in the next mission you’ll store and access multidimensional lists to save and load multiple structures!</p>
<h4 class="h4a" id="ch11lev2sec18"><strong>MISSION #66: SAVE A COLLECTION OF STRUCTURES</strong></h4>
<p class="noindent">The programs in this mission will store and load all of your saved structures using a single file. This mission is once again divided into two programs: one for saving and the other for loading.</p>
<p class="indent">You’ll need to convert the programs from <a href="ch11.html#ch11lev2sec13">Mission #65</a> to use the <code>shelve</code> module instead of the <code>pickle</code> module. You’ll also add code to take user input so users can name their buildings. Open the <em>saveStructure.py</em> and <em>loadStructure.py</em> files and save them as <em>saveCollection.py</em> and <em>loadCollection.py</em>.</p>
<p class="indent">As we did in the previous mission, let’s make the changes to these programs in two parts.</p>
<h4 class="h4" id="ch11lev2sec19"><strong><span class="blue">PART 1: SAVING A STRUCTURE TO A COLLECTION</span></strong></h4>
<p class="noindent">Part of the original <em>saveStructure.py</em> file is included and annotated here to help identify where you’ll make the changes. Here’s the first line and the last few lines of <em>saveCollection.py</em>:</p>
<p class="sidenote"><span class="blue"><em>saveCollection.py</em></span></p>
<p class="programs"><span class="ent">➊</span> <span class="orange">import</span> pickle<br/><br/>   --<span class="codeitalic">snip</span>--<br/><br/>   <span class="red"># Name the structure</span><br/><span class="ent">➋</span> structureName = <span class="rose">input</span>(<span class="green">"What do you want to call the structure?"</span>)<br/>   <span class="red"># Store the structure in a file</span><br/><span class="ent">➌</span> pickleFile = <span class="rose">open</span>(<span class="green">"pickleFile"</span>, <span class="green">"wb"</span>)<br/><span class="ent">➍</span> pickleFile.dump(structure)</p>
<p class="indent"><a id="page_249"/>An extra line is added to the file to ask what you want to call the structure when you save it with <code>pickle</code> <span class="ent">➋</span>. For example, my version of the program asks “What do you want to call the structure?” and I can reply with something like “House” or “Cake forest.” Make sure you call each new structure by a different name; if a new structure has the same name as another one, the old structure will be overwritten by the new one.</p>
<p class="indent">To change this program to use the <code>shelve</code> module instead of <code>pickle</code>, you need to make two changes. First, swap the module import from <code>pickle</code> to <code>shelve</code> <span class="ent">➊</span>. Second, change the last few lines of the code to use <code>shelve</code> instead of <code>pickle</code>. Open a file called <em>structuresFile.db</em> and store it in a variable called <code>shelveFile</code> using the <code>shelve.open()</code> function <span class="ent">➌</span>. Then store the <code>structure</code> variable in a <code>shelve</code> dictionary using the <code>structureName</code> variable for the name of the dictionary’s key <span class="ent">➍</span>. It should look something like this: <code>shelveFile[structureName] = structure</code>. Finally, close <code>shelveFile</code> on the last line by using <code>close()</code>.</p>
<h4 class="h4" id="ch11lev2sec20"><strong><span class="blue">PART 2: LOADING A STRUCTURE FROM A COLLECTION</span></strong></h4>
<p class="noindent">Now you need to change the <em>loadCollection.py</em> file. I’ve removed the middle of the file to save space here and to make the bits you need to change easier to see:</p>
<p class="sidenote"><span class="blue"><em>loadCollection.py</em></span></p>
<p class="programs"><span class="ent">➊</span> <span class="orange">import</span> pickle<br/><br/>   --<span class="codeitalic">snip</span>--<br/><br/><span class="ent">➋</span> structure = pickle.load(<span class="green">"pickleFile"</span>)<br/><span class="ent">➌</span> structureName = <span class="rose">input</span>(<span class="green">"Enter the structure's name"</span>)<br/><br/>   pos = mc.player.getTilePos()<br/>   x = pos.x<br/>   y = pos.y<br/>   z = pos.z<br/><br/><span class="ent">➍</span> buildStructure(x, y, z, structureDictionary[structureName])</p>
<p class="indent">I’ve added an extra line to the code that asks for the name of the structure you want to build <span class="ent">➌</span>. Also, I added a bit of code to the last line that gets the structure from the <code>shelve</code> dictionary and passes it to the <code>buildStructure()</code> function.</p>
<p class="indent">You need to make a couple of changes to this program. First, as in <em>saveCollection.py</em>, change <code>import</code> to <code>shelve</code> instead of <code>pickle</code> <span class="ent">➊</span>. Second, load the <code>shelveFile</code> that you created in <em>saveCollection.py</em> by using <code>shelve.open()</code> <span class="ent">➋</span>. Store the data returned by the <code>shelve.open()</code> function in the variable <a id="page_250"/><code>structureDictionary</code> <span class="ent">➍</span>. The code should look something like the following: <code>structureDictionary = shelve.load("shelveFile")</code>.</p>
<p class="indent">All of the data for the structures, including their names and blocks, are stored in the <em>structuresFile.db</em> file, which means you don’t need to make any changes to <em>loadCollection.py</em> before you run it. All you need to do is enter the name of the structure that you want to use when you run the program.</p>
<p class="indent">Let’s see the program in action, using a structure from my Minecraft world. First, I copy the structure using <em>saveCollection.py</em> by flying to one corner of the structure and pressing <small>ENTER</small> (<a href="ch11.html#ch11fig7">Figure 11-7</a>).</p>
<div class="image"><img src="graphics/f11-07.jpg" alt="image"/></div>
<p class="figcap"><a id="ch11fig7"/><em>Figure 11-7: I move to one corner of the structure I want to save.</em></p>
<p class="indent">Next, I fly to the opposite corner of the structure and press <small>ENTER</small> again (<a href="ch11.html#ch11fig8">Figure 11-8</a>).</p>
<div class="image"><img src="graphics/f11-08.jpg" alt="image"/></div>
<p class="figcap"><a id="ch11fig8"/><em>Figure 11-8: I move to the opposite corner.</em></p>
<p class="indent"><a id="page_251"/>Then the program prompts me to enter a name for my structure. <a href="ch11.html#ch11fig9">Figure 11-9</a> shows that I’ve called my structure <code>"Cake tree"</code>.</p>
<div class="image"><img src="graphics/f11-09.jpg" alt="image"/></div>
<p class="figcap"><a id="ch11fig9"/><em>Figure 11-9: I enter the name that I want to save the structure as.</em></p>
<p class="indent">Finally, I run <em>loadCollection.py</em>, fly to the location where I want to build a copy of the structure, and enter the name of the structure I want to build (<a href="ch11.html#ch11fig10">Figure 11-10</a>). The program starts building in front of me, just like magic!</p>
<div class="image"><img src="graphics/f11-10.jpg" alt="image"/></div>
<p class="figcap"><a id="ch11fig10"/><em>Figure 11-10: Now when I want to create a copy, I just enter the name of the structure and it builds.</em></p>
<p class="indent">You can repeat this process with as many buildings or structures as you want; for example, I’ve made a copy of a hut in <a href="ch11.html#ch11fig11">Figure 11-11</a>. After you’ve copied a structure once, you can load it anytime you want just by running <em>loadCollection.py</em> and entering the structure’s name!</p>
<div class="image"><a id="page_252"/><img src="graphics/f11-11.jpg" alt="image"/></div>
<p class="figcap"><a id="ch11fig11"/><em>Figure 11-11: You can use the program to save multiple structures. Here I’ve copied a hut.</em></p>
<h3 class="h3" id="ch11lev1sec04"><strong><span class="blue">INSTALLING NEW MODULES WITH PIP</span></strong></h3>
<p class="noindent">In addition to <code>pickle</code> and <code>shelve</code>, you can import thousands of other modules to use in your Python programs. With so many modules available, correctly installing them is very important. To simplify installing modules, Python provides a package manager called pip. A <em>package manager</em> is software that has a database of other software that you can install on your computer. It also includes features that make it straightforward to install, upgrade, and uninstall the other software.</p>
<p class="indent">The pip package manager can install, upgrade, and remove packages in Python. It also has a large collection of modules that you can use in Python. This section shows you how to install a package using pip and showcases the <code>Flask</code> module, which you can use to build a website!</p>
<p class="indent">If you’re using the most recent version of Python 3, pip is preinstalled. If you’re using an earlier version of Python, pip may not be installed. The easiest way to get pip is to install the latest version of Python. (See “<a href="ch01.html#ch01lev2sec02">Installing Python</a>” on <a href="ch01.html#page_3">page 3</a> for Windows and on <a href="ch01.html#page_13">page 13</a> for Mac.)</p>
<p class="indent">Let’s look at how to use pip. Depending on the operating system you use, you can use pip in a couple of ways. Be sure to follow the instructions that match your computer!</p>
<h4 class="h4" id="ch11lev2sec21"><strong><span class="blue">USING PIP ON WINDOWS</span></strong></h4>
<p class="noindent">When using pip on Windows, you need to open the Windows command prompt. The command prompt is similar to the Python shell. It lets you input a single command on a line, which runs when you press <small>ENTER</small>.</p>
<p class="indent">To open the command prompt, press the Windows key or open the Start menu and search for <code>cmd</code>. When you open the program, you’ll see a black window (<a href="ch11.html#ch11fig12">Figure 11-12</a>).</p>
<div class="image"><a id="page_253"/><img src="graphics/f11-12.jpg" alt="image"/></div>
<p class="figcap"><a id="ch11fig12"/><em>Figure 11-12: The Windows command prompt</em></p>
<p class="indent">To use pip in the command prompt, type <code>pip</code> followed by the action you want it to take. For example, let’s install the Python module <code>Flask</code>, which you can use to make websites with Python. Enter the following command in the command prompt:</p>
<p class="programs">&gt; <span class="codestrong">pip install Flask</span></p>
<p class="indent">On the Python Package index website at <em><a href="http://pypi.python.org/">http://pypi.python.org/</a></em>, you can find many other Python modules that you can install.</p>
<h4 class="h4" id="ch11lev2sec22"><strong><span class="blue">USING PIP ON A MAC OR RASPBERRY PI</span></strong></h4>
<p class="noindent">If you’re using pip on a Mac or a Raspberry Pi, you’ll need to include <code>sudo</code> at the start of the command to get it to work. For example, enter this line:</p>
<p class="programs">$ <span class="codestrong">sudo pip install Flask</span></p>
<p class="indent">If you get an error, flip to <a href="ch01.html#ch01">Chapter 1</a> to double-check the Mac or Raspberry Pi installation instructions.</p>
<p class="indent">On the Python Package index website at <em><a href="http://pypi.python.org/">http://pypi.python.org/</a></em>, you can find many other Python modules that you can install.</p>
<h3 class="h3" id="ch11lev1sec05"><strong><span class="blue">USING A MODULE FROM PIP: FLASK</span></strong></h3>
<p class="noindent"><code>Flask</code> is a Python module that you can use to develop websites. In this section, you’ll learn how to set up a basic <code>Flask</code> website and then integrate the website with Minecraft so you can display your player’s position on a website!</p>
<p class="indent">With <code>Flask</code>, you need only a few lines of code to make and manage a website. You just write the Python code as you normally would and add <a id="page_254"/>some extra information related to <code>Flask</code>. Next, you run your code, and it makes a website that your computer can access. You can then view the website in your web browser.</p>
<p class="indent"><a href="ch11.html#ch11ex5">Listing 11-5</a> creates a basic <code>Flask</code> website that includes the most important piece of information about me: my name.</p>
<p class="sidenote"><span class="blue"><em>namePage.py</em></span></p>
<p class="programs">   <span class="orange">from</span> flask <span class="orange">import</span> Flask<br/><span class="ent">➊</span> app = Flask(__name__)<br/><br/><br/><span class="ent">➋</span> @app.route(<span class="green">"/"</span>)<br/>   <span class="orange">def</span> <span class="blue1">showName</span>():<br/><span class="ent">➌</span>     <span class="orange">return</span> <span class="green">"Craig Richardson"</span><br/><br/><span class="ent">➍</span> app.run()</p>
<p class="examplet"><a id="ch11ex5"/><em>Listing 11-5: A Python program that uses</em> <code><span class="codeitalic">Flask</code></span> <em>to create a website</em></p>
<p class="indent">To use <code>Flask</code>, you first need to create <code>Flask</code> using the <code>Flask()</code> function <span class="ent">➊</span>. The <code>__name__</code> argument tells <code>Flask</code> that your <code>Flask</code> project is contained in this file, and it doesn’t need to look anywhere else to find other parts of the program. Note the two underscores, not one, at the start and at the end of the <code>__name__</code> argument.</p>
<p class="indent">The <code>@app.route()</code> tag uses a decorator. <em>Decorators</em> provide additional information to Python about your functions. For example, in this program the <code>@app.route()</code> decorator tells <code>Flask</code> which part of the website the function will be used on. In this case, <code>"/"</code> tells <code>Flask</code> the <code>showName()</code> function will be used on the home page <span class="ent">➋</span>. The <code>return</code> statement in the function tells <code>Flask</code> what will be displayed on the page. In this example, it returns my name, so my name will be displayed on the page <span class="ent">➌</span>. The last line of the program tells Python to start <code>Flask</code> when this file is run <span class="ent">➍</span>.</p>
<p class="indent">Save this file as <em>namePage.py</em> in the <em>files</em> folder. Add your own text to make your own website.</p>
<p class="indent">To run the website, click <strong>Run</strong> <span class="ent">▸</span> <strong>Run Module</strong> in IDLE. The program runs and generates a website file that you can open in a web browser. To find the location of the website, you need to read the line of code that your program outputs when you start running it. When I run the program, the output looks like this:</p>
<p class="programs"><span class="blue1">* Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)</span></p>
<p class="indent">From this line, I can tell that entering <em>http://127.0.0.1:5000/</em> into a web browser will take me to the <code>Flask</code> website that I just started running. Now when I open the web browser and go to this site, I can see my name displayed on the page (<a href="ch11.html#ch11fig13">Figure 11-13</a>).</p>
<div class="note">
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>
<p class="notep"><em>The website you create in this program is available only on your computer at the moment. Only you can access this website—nobody else on the Internet can look at it.</em></p>
</div>
<div class="image"><a id="page_255"/><img src="graphics/f11-13.jpg" alt="image"/></div>
<p class="figcap"><a id="ch11fig13"/><em>Figure 11-13: Look at my website! You can change what’s displayed here to whatever you want. What will you write on your website?</em></p>
<p class="indent">To stop the program, go into IDLE and press <small>CTRL</small>-C or click <strong>Shell</strong> <span class="ent">▸</span> <strong>Restart Shell</strong>.</p>
<div class="note">
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>
<p class="notep"><em>This chapter covers only a very basic introduction to</em> <code><span class="codeitalic">Flask</code></span>. <code><span class="codeitalic">Flask</code></span> <em>is very useful to learn because it allows you to build interactive websites quickly with Python. If you want to know more about</em> <code><span class="codeitalic">Flask</code></span>, <em>check out this tutorial on the</em> <code><span class="codeitalic">Flask</code></span> <em>website at</em> <a href="http://flask.pocoo.org/docs/0.10/tutorial/">http://flask.pocoo.org/docs/0.10/tutorial/</a>.</p>
</div>
<h4 class="h4a" id="ch11lev2sec23"><strong>MISSION #67: POSITION WEBSITE</strong></h4>
<p class="noindent">One of Python’s best qualities is that it’s easy to integrate the features of different modules into a single program. You’ve been using the Minecraft Python API module throughout the book and have just learned about the <code>Flask</code> module. With just a few steps you can integrate the two.</p>
<p class="indent">In this mission, you’ll combine the Minecraft Python API with <code>Flask</code> to display a player’s position on a web page.</p>
<p class="indent">Create a new file in IDLE and save it as <em>positionPage.py</em> in the <em>files</em> folder. You need to get the player’s position from Minecraft and display it on the web page using a function with the <code>Flask @app.route("/")</code> tag. You can base the code on the example in <a href="ch11.html#ch11ex5">Listing 11-5</a>. Make the code display the position in the format <code>"x 10, y 110, z 12"</code>.</p>
<p class="indent">Run the program and check out your web page. Pretty cool, huh? Using <code>Flask</code> you can create web pages with all kinds of information on them. You can even upload these pages to the Internet to share with your friends!</p>
<h3 class="h3" id="ch11lev1sec06"><a id="page_256"/><strong><span class="blue">WHAT YOU LEARNED</span></strong></h3>
<p class="noindent">In this chapter, you were introduced to using files with Python. You learned how to read and write to files using Python’s standard library, giving you control over files when you create your own programs. You also learned how to use modules, which extend Python’s capabilities and what you can do in Python.</p>
<p class="indent">You explored the <code>pickle</code> module, the <code>shelve</code> module, and the pip package manager. The <code>pickle</code> and <code>shelve</code> modules are used for different purposes. The <code>pickle</code> module saves the value of a single variable, especially when it contains a multidimensional list or dictionary, which would be difficult to store and open using the standard library. The <code>shelve</code> module has the same strengths as the <code>pickle</code> module, but it gives you more flexibility to store several values at once in a dictionary-like structure. With pip, you learned how to install new modules. You were also introduced to the <code>Flask</code> module, which is a quick and flexible way to build websites with Python.</p>
<p class="indent">With this knowledge, you completed four missions. The first allowed you to create to-do lists, which you can display in the Minecraft game to remind you what you’re working on. The second made it possible to save buildings and load them into your current world and other worlds. The third mission modified the second mission so you could store all your buildings in a single file instead of a file for each building. The final mission showed you how to use the <code>Flask</code> module to create a web page that displays the player’s current position.</p>
<p class="indent">You’ve done a great job so far! The next chapter is the final chapter. You’ll learn about classes and object-oriented programming, a popular programming style that allows you to reuse code.</p>
</body></html>