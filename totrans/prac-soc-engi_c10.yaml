- en: '10'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Proactive Defense Techniques
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
- en: If you tell the truth, you don’t have to remember anything.
  id: totrans-2
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  id: totrans-3
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: —Mark Twain
  id: totrans-4
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![](image_fi/book_art/chapterart.png)'
  id: totrans-5
  prefs: []
  type: TYPE_IMG
- en: Now that we’ve covered the fundamentals of social engineering and OSINT collection,
    it’s time to talk about how an organization can minimize the impact of these attacks
    or even prevent them altogether. Although you’ll rarely be able to stop all attacks,
    you can take steps to reduce an attack’s success rate and lessen its harm if it
    does succeed.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
- en: 'This chapter covers three such techniques: awareness programs, reputation monitoring,
    and incident response. We’ll discuss the elements of a successful awareness program,
    explain how to implement OSINT monitoring and technical email controls, provide
    integration with incident response, and finally, produce threat intelligence.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
- en: Awareness Programs
  id: totrans-8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '*Awareness programs* are company initiatives designed to provide guidance to
    users in situations when they encounter—or, unfortunately, fall victim to—a social
    engineering attack. These programs are essential because they expose users, who
    are probably already receiving phishing emails, to tactics that malicious attackers
    may use without the potential negative outcome.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
- en: One approach to conducting these trainings is to teach users about common trends
    in the security industry. Offering this kind of general advice is rarely enough.
    Hopefully, the previous chapters of this book helped you understand that traditional
    security guidelines—such as looking for the green padlock in the address bar of
    your web browser, paying attention to spelling and grammar in emails, and checking
    link addresses—is no longer enough to prevent phishing attacks. Sure, some attackers
    still make those mistakes. But the sophisticated ones capable of doing catastrophic
    harm to an organization are not.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
- en: A better approach is to inform users about the specific problems that the organization
    faces as a result of phishing. For example, if the organization is experiencing,
    say, an influx of Nigerian Prince emails, or an aggressive business-email-compromise
    campaign that spoofs the CFO, letting users know the details will better equip
    them to resist these attacks. Users are likely to encounter one of these specific
    attacks, so they should know to look out for them.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
- en: How and When to Train
  id: totrans-12
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Though training should occur often to keep users aware of current trends, you
    also shouldn’t detract from their assigned duties. Offering awareness activities
    frequently enough for users to retain the lessons without becoming a nuisance
    is a delicate balance. I recommend providing training at least quarterly. Although
    monthly trainings provide more security, they can be cumbersome to both the users
    and those managing the program.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
- en: During this periodic education event, you should provide examples of phishing
    emails that the organization received since the last training. If your organization
    performed any testing, you could also distribute statistics like those discussed
    in Chapter 9. Most importantly, you should tell users the steps they must take
    if they receive a phishing email and the steps they must take if they fall victim.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在此周期性教育活动中，您应该提供自上次培训以来，组织收到的钓鱼邮件示例。如果您的组织进行了任何测试，您还可以分发类似于第9章中讨论的统计数据。最重要的是，您应该告诉用户，如果他们收到钓鱼邮件，应该采取哪些步骤，如果他们成为受害者，又该如何处理。
- en: When discussing the example phishing emails, point out any clues that indicate
    that the emails are fake. Do this from a logic, language, and technical standpoint.
    Draw attention to any requests that violate standard operating procedures or reason.
    For instance, raise the question of why the CFO on vacation in Thailand needs
    you to release $45 million, send it to a PayPal account, and then text a number
    in Belize. Point out the grammar errors, which could include missing key phrases,
    different spelling conventions (like *organize* in the United States instead of
    *organise* in other parts of the world), or using the wrong term for employees
    (*associate* for Walmart and *cast member* for Disney). Teach users to hover over
    links to see the page to which the email is trying to send them. Encourage them
    to forward suspicious emails to the security team. Discourage them from forwarding
    chain letters or responding to suspicious emails without first talking to the
    security team.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在讨论钓鱼邮件示例时，指出任何表明邮件是假冒的线索。从逻辑、语言和技术角度进行分析。特别注意任何违反标准操作程序或常理的请求。例如，可以提出这样一个问题：为什么正在泰国度假的首席财务官需要您释放4500万美元，将其发送到PayPal账户，然后再发送短信到伯利兹的某个号码？指出其中的语法错误，包括缺失关键短语、不同的拼写习惯（例如美国使用*organize*而其他地区使用*organise*），或员工称呼的不当（沃尔玛使用*associate*，迪士尼使用*cast
    member*）。教导用户将鼠标悬停在链接上，查看邮件试图引导他们访问的页面。鼓励他们将可疑邮件转发给安全团队。并且不鼓励他们在没有与安全团队沟通之前转发链式邮件或回复可疑邮件。
- en: In one type of successful program, “Security Thought of the Month” training,
    the security team discusses one concept related to social engineering, or any
    security-relevant topic, for that matter, per session. These concepts can coincide
    with previous or upcoming engagements. They can also complement current events.
    For example, in the United States, employers provide employees with tax forms
    in January, allowing them to meet the April 15 tax-return deadline. Coincidentally,
    many successful W-2 phishing attempts occur in the early weeks of January. Similarly,
    September or October tend to be the best months to talk about identity theft and
    e-commerce, because they come right before the holiday shopping season.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在一种成功的项目类型中，名为“本月安全思考”培训，安全团队每次讨论一个与社会工程学相关的概念，或任何与安全相关的话题。这些概念可以与之前或即将进行的工作交叉，也可以补充当前事件。例如，在美国，雇主在1月为员工提供税表，以便他们能够在4月15日的报税截止日期前完成申报。巧合的是，许多成功的W-2钓鱼攻击发生在1月的前几周。同样，9月或10月通常是讨论身份盗窃和电子商务的最佳时机，因为这正好在假日购物季节之前。
- en: Nonpunitive Policies
  id: totrans-17
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 非惩罚性政策
- en: One of the main reasons people fail to report falling victim to phishing emails—whether
    it be a click, a download, or information they entered into a web form—is that
    they are embarrassed they did so or fear for their job. But an unreported successful
    phishing attempt could cause significant downtime, or if the organization fell
    victim to ransomware, the purchase of Bitcoin or Apple gift cards to unlock it.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 人们未能报告自己成为钓鱼邮件受害者的主要原因之一，无论是点击、下载还是填写网页表单的信息，是因为他们感到尴尬或担心自己的工作。但如果成功的钓鱼攻击未被报告，可能会导致显著的停机时间，或者如果组织成为勒索病毒的受害者，还可能需要购买比特币或苹果礼品卡来解锁。
- en: Employees should know that it is acceptable to report that they’ve fallen victim
    to a social engineering attack. Although doing so may mean that they must complete
    additional training, they shouldn’t have to update their resumes as a result.
    Many social engineering firms put provisions in the contracts they sign with their
    clients that prevent employees from being fired as a result of the testing. (To
    my knowledge, this language has not been tested in court.) I have not been personally
    party to any litigation regarding such a provision nor am I intimately aware of
    anyone who has. Consult with your legal counsel before attempting to enact this
    in any contracts.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
- en: In rare cases, employees may need to be let go because they cannot grasp the
    concept of security awareness. This occurs if the employee becomes a greater liability
    than an asset. Still, terminating an employee’s contract should be the last resort.
    Begin by exhausting every attempt to train the employee, including going beyond
    the typical awareness programs. Also attempt to implement additional technical
    controls.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
- en: Incentives for Good Behavior
  id: totrans-21
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Though it’s not in your interest to punish people’s mistakes, it’s helpful to
    reinforce good behavior. Once again, however, doing so properly is a delicate
    balance. The reason it’s delicate is that, occasionally, people will try to game
    the system.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
- en: To provide an example of how offering incentives could go wrong, consider what
    happened to Wells Fargo in 2016\. Between 2009 and 2015, Wells Fargo had set unrealistic
    sales goals for its staff. The bank later discovered that these goals had incentivized
    5,300 employees to create fake Wells Fargo accounts, in some cases for family
    and friends, but in other cases for strangers. Management discovered this when
    the strangers started incurring fees.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
- en: To prevent employees from gaming the system, avoid offering incentives for reporting
    the *most* phishing attempts. Those incentives would encourage employees to get
    their emails on phishing lists, creating more work for the security team. Instead,
    you could incentivize reporting *clever* or *unique* phishing emails, passing
    all phishing simulations or reporting them, or something along these lines. The
    idea is to reward reporting in general, especially of clever or unique phishing
    attempts, rather than rewarding the largest quantity of reports. Should an organization
    base rewards on quantity and employees purposely get on phishing lists, eventually
    one may come through that looks real and the users fall victim; meanwhile, the
    security team is busy analyzing all the other emails they forwarded.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
- en: 'Here are a few free or low-cost prizes that you could offer:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
- en: Getting 15 minutes off for reporting a unique or widespread phishing email
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A $10 Amazon or Starbucks gift card
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A parking spot for a week
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Entry into a drawing for a big prize
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Free lunch for a week
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Providing anything of perceived value to employees for doing a good job will
    help reinforce the good behavior you seek. This is a bit of social engineering
    in itself, but it aims to bring about positive outcomes for employees and the
    organization.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 为员工提供任何被认为有价值的奖励，以表扬他们做得好的表现，有助于强化您希望看到的良好行为。这本身就是一种社会工程，但它旨在为员工和组织带来积极的成果。
- en: Running Phishing Campaigns
  id: totrans-32
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 进行钓鱼攻击演练
- en: Though controversial, running phishing campaigns as part of your training efforts
    can reliably expose your employees to realistic phishing attempts and allow you
    to test the organization’s response as a whole.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管有争议，将钓鱼攻击演练作为培训的一部分可以可靠地让员工接触到真实的钓鱼攻击尝试，并允许您测试整个组织的反应。
- en: The first decision you should make after deciding to simulate a phishing campaign
    is whether to conduct the engagements internally or hire a third party to do so.
    To choose the best option for your company, ask yourself how often you plan to
    run such engagements and what your budget is. If outsourced, phishing engagements
    may take 4 to 24 hours of billable work per engagement, depending on the SOW,
    scope, and complexity you desire. If you’d rather test internally, you must figure
    out who will conduct the engagement, what their other duties are, and what impact
    on your security posture their time away will present. If you have the budget
    to purchase a phishing simulation service from a non-consulting company such as
    Proofpoint, Cofense, or KnowBe4, you could take that route as well.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在决定模拟钓鱼攻击演练后，您应该做出的第一个决定是是否在内部进行，还是聘请第三方来执行此任务。为了选择最适合您公司的选项，请问问自己您计划多频繁地进行此类演练以及预算是多少。如果是外包，钓鱼攻击演练可能需要每次演练4到24小时的计费工作，具体取决于工作范围、要求和复杂度。如果您更愿意在内部进行测试，您需要弄清楚谁将负责执行演练，他们的其他职责是什么，以及他们离开岗位将对您的安全态势产生什么影响。如果您有预算购买像Proofpoint、Cofense或KnowBe4等非咨询公司的钓鱼模拟服务，您也可以选择这种方式。
- en: Reputation and OSINT Monitoring
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 声誉和开放源信息（OSINT）监控
- en: Proactive OSINT monitoring is just as essential as proactive social engineering.
    *OSINT monitoring*, or the practice of periodically conducting OSINT on oneself
    or one’s clients, is also sometimes called *brand and reputation* monitoring or
    *dark web monitoring*. The benefit of OSINT monitoring, in any form or flavor,
    is that it allows the organization to see what potential attackers can see. This
    allows the organization to act appropriately, ahead of an attack, whether by removing
    the data if possible, increasing monitoring, or implementing disinformation or
    deception.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 积极的开放源信息监控和积极的社会工程同样至关重要。*开放源信息监控*，即定期对自己或客户进行开放源信息的监测，有时也被称为*品牌和声誉*监控或*暗网监控*。无论哪种形式，开放源信息监控的好处在于它允许组织看到潜在攻击者可以看到的信息。这使得组织能够在攻击发生之前采取适当的措施，无论是尽可能删除数据、增加监控，还是实施虚假信息或欺骗。
- en: Since OSINT is largely passive, you can’t really run simulations to condition
    users in ways that prevent attackers from collecting OSINT. There are few opportunities
    for detection. In many cases, the OSINT may come from user accounts, and the organization
    can’t force a user to remove something from social media, unless it interferes
    with intellectual property through the Digital Millennium Copyright Act (DMCA)
    or some other legal criterion.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 由于开放源信息（OSINT）主要是被动的，您无法通过模拟来训练用户，防止攻击者收集OSINT。检测的机会很少。在许多情况下，OSINT可能来自用户账户，组织无法强制用户删除社交媒体上的内容，除非这些内容通过《数字千年版权法》（DMCA）或其他法律标准侵犯了知识产权。
- en: Implementing a Monitoring Program
  id: totrans-38
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 实施监控计划
- en: When implementing an OSINT monitoring program, focus on finding information
    that might pose risks to the business. Don’t use this as a means to spy on or
    pry into employees’ personal lives. One easy way to ensure that your testing remains
    ethical is to outsource the OSINT monitoring (discussed in “Outsourcing” next).
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 在实施开放源信息监控计划时，重点应该放在查找可能对业务构成风险的信息上。不要将其作为监视或侵犯员工个人生活的手段。确保您的测试保持道德的一个简单方法是将开放源信息监控外包（下文将讨论“外包”）。
- en: If your organization chooses to implement its own OSINT and reputation-monitoring
    program, it has to decide the parameters within which to operate. In doing so,
    it must define what to test for, when to test, and how to test. Since employees
    can post anything at any time, monthly or quarterly testing is a good practice.
    Otherwise, many of the considerations required to set up a phishing campaign are
    applicable here as well. Will the testing be automated or manual? What is your
    budget? How in-depth is the engagement expected to be? What is the scope? How
    will you ensure that you respect your employees’ privacy and agency to post to
    their social media?
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的组织决定实施自己的OSINT和声誉监控计划，它需要决定在何种参数范围内操作。在此过程中，它必须定义要测试的内容、测试的时间和测试的方式。由于员工可以随时发布任何内容，进行月度或季度测试是一个不错的做法。否则，设置网络钓鱼攻击时需要考虑的许多因素同样适用于此。测试将是自动化还是手动的？预算是多少？期望的参与深度如何？范围是什么？你将如何确保尊重员工的隐私以及他们在社交媒体上的发帖自由？
- en: Determining the amount of manual testing to conduct will drive the budget conversation.
    Having someone actively search for OSINT about an organization requires paying
    the investigator (and possibly the investigator’s employer). Automated code doesn’t
    require this, but the owner of the code may charge a fee for using the service.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 确定需要进行多少手动测试将直接影响预算的讨论。让某人主动搜索有关某个组织的开放源情报（OSINT）需要支付调查员的费用（并可能还需要支付调查员雇主的费用）。自动化代码则不需要这样做，但代码的拥有者可能会收取使用该服务的费用。
- en: Define a scope similar to the one used for social engineering engagements. This
    is essential to avoid violating your employees’ privacy. While the organization
    should care about what vendors, employees, contractors, visitors, and partners
    post publicly, avoid looking for content shared privately or between friends.
    Don’t force employees to connect with you on social media or try to join their
    friends lists by using fake accounts.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 定义一个类似于社会工程学参与中使用的范围。这对于避免侵犯员工隐私至关重要。虽然组织应该关注供应商、员工、承包商、访客和合作伙伴公开发布的内容，但要避免寻找私下或朋友之间共享的内容。不要强迫员工与你建立社交媒体联系或通过假账号尝试加入他们的好友列表。
- en: Outsourcing
  id: totrans-43
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 外包
- en: From my experience, it’s often best to have third parties handle the OSINT and
    reputation monitoring. When third parties collect OSINT on your employees, you
    can alleviate concerns that the organization spies on employees. It also keeps
    your organization’s security team away from personal accounts belonging to other
    employees, which reduces the chance of stalking or harassment accusations. Finally,
    it keeps actual abuse from occurring under the banner of security.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 根据我的经验，通常最好让第三方处理OSINT和声誉监控。当第三方收集关于员工的OSINT时，你可以缓解组织监视员工的担忧。它还可以将组织的安全团队与其他员工的个人账户隔离开，减少骚扰或跟踪指控的可能性。最后，它可以防止以安全名义发生实际的滥用行为。
- en: In addition to avoiding harassment claims, having third parties conduct OSINT
    monitoring allows the investigators to operate with minimal bias. They’re more
    likely to act as a sieve rather than a pump, meaning that they filter out the
    extraneous information, irrelevant to security, often by using automated web scanners
    with little to no malicious intent, and provide the organization with only relevant
    information.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 除了避免骚扰投诉外，委托第三方进行OSINT监控可以让调查员以最小的偏见进行操作。他们更有可能像筛子一样过滤信息，而不是像泵一样吸取信息，这意味着他们会过滤掉与安全无关的多余信息，通常通过使用自动化的网络扫描工具，几乎没有恶意意图，并仅提供与组织相关的信息。
- en: Incident Response
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 事件响应
- en: '*Incident response* is the set of predefined actions that an organization will
    take if an adverse event meets criteria that classify it as an incident. Part
    of being prepared is thinking through what may happen if social engineering is
    successful. The remainder is studying how your systems interact so that you can
    take steps to prevent widespread or catastrophic impact. As stated earlier in
    this book, the time to decide which actions to take is not during an active social
    engineering campaign.'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '*事件响应*是组织在不利事件满足某些条件后，会采取的预定义行动。准备的一部分是思考如果社会工程学攻击成功会发生什么。其余部分则是研究你的系统如何交互，以便采取措施防止广泛或灾难性的影响。正如本书前面所说，决定采取哪些行动的时机并不是在进行中的社会工程学攻击时。'
- en: The SANS Incident Response Process
  id: totrans-48
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SANS 事件响应流程
- en: 'The *SANS Institute*, an organization for security research and education,
    defines a cohesive incident response process that includes the following steps:
    preparation, identification, containment, eradication, recovery, and lessons learned
    ([Figure 10-1](#figure10-1)). Also known as *PICERL*, this incident response standard
    takes into account the entire life cycle of an incident, beginning before it is
    classified and ending after it is resolved. At each stage, you define the steps
    necessary to minimize the impact of the attack, restore services as quickly as
    possible, and fix the root cause of the event.'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '*SANS Institute*（一个从事安全研究和教育的组织）定义了一个完整的事件响应过程，包含以下步骤：准备、识别、遏制、根除、恢复和经验教训（[图10-1](#figure10-1)）。该事件响应标准也被称为*PICERL*，考虑了事件的整个生命周期，从事件分类前开始，到事件解决后结束。在每个阶段，你都需要定义必要的步骤，以最小化攻击的影响，尽快恢复服务，并修复事件的根本原因。'
- en: In the *preparation* phase—which often grows out of the *lessons learned* phase
    that follows an incident—you anticipate future incidents by running awareness
    programs, performing phishing simulations, and monitoring your OSINT.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 在*准备*阶段——通常是从事件后的*经验教训*阶段衍生出来——你通过开展意识提升项目、执行钓鱼模拟和监控你的开放源信息（OSINT）来预测未来的事件。
- en: 'The *identification* phase begins the moment the organization becomes aware
    of an event that the organization classifies as an incident. In a social engineering
    context, the following could trigger this phase: a user self-reporting clicking
    on a phish; a user self-reporting that they provided information or access to
    a caller over the phone; an alert about ransomware from malware prevention tools;
    server logs that indicate spidering, unusually high access, or downloads of public
    files; any emails received on a honeypot email address (which serves no purpose
    other than to be discovered by spidering tools); suspicious email alerts from
    email-filtering software like Proofpoint or Mimecast; or custom alerts based on
    internal and external threat intelligence.'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '*识别*阶段从组织意识到事件并将其分类为事件的那一刻开始。在社交工程的背景下，以下情况可能触发此阶段：用户自我报告点击了钓鱼邮件；用户自我报告通过电话向来电者提供了信息或访问权限；来自恶意软件防护工具的勒索软件警报；服务器日志显示蜘蛛爬行、异常高访问量或下载公共文件；任何通过蜜罐电子邮件地址接收到的电子邮件（该地址的唯一目的是被蜘蛛工具发现）；来自邮件过滤软件如Proofpoint或Mimecast的可疑邮件警报；或基于内部和外部威胁情报的自定义警报。'
- en: '![<<Circular arrow diagram shows steps of the SANS incident response process:
    Preparation, Identification, Containment, Eradication, Recovery, and Lessons Learned.>>](image_fi/500983c10/f10001.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![<<圆形箭头图展示了SANS事件响应过程的步骤：准备、识别、遏制、根除、恢复和经验教训。>>](image_fi/500983c10/f10001.png)'
- en: 'Figure 10-1: The SANS incident response process'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10-1：SANS 事件响应过程
- en: Once you’ve identified and classified an incident, you enter the *containment*
    phase, in which you take steps to ensure that the threat cannot spread further.
    When it comes to social engineering, containment action could include sinkholing
    a domain or removing an email from the email server and queue. You could also
    directly block a domain, IP address, or email address from being accessible from
    the organization’s network and systems. Finally, you might isolate a computer
    system from the rest of the network or put it in a sandbox, force a user password
    reset, or even deactivate affected user accounts. Once you’ve taken an action,
    you should send a mass email to users to prevent them from falling victim.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你识别并分类了一个事件，你就进入了*遏制*阶段，在这一阶段，你采取措施确保威胁不会进一步蔓延。在社交工程的情况下，遏制措施可能包括将域名定向到“黑洞”，或从邮件服务器和队列中删除电子邮件。你还可以直接阻止域名、IP
    地址或电子邮件地址无法从组织的网络和系统中访问。最后，你可能会将计算机系统与网络隔离，或将其放入沙箱环境，强制用户重置密码，甚至停用受影响的用户账户。一旦采取了这些行动，你应该向用户发送群发邮件，防止他们成为受害者。
- en: In the *eradication* phase, you solve the problem. You remove any malware that
    was installed. You analyze the incident’s root cause and begin to identify actions
    to help you recover. Unless malware is involved, this is usually a very short
    phase.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 在*根除*阶段，你需要解决问题。移除所有已安装的恶意软件。你需要分析事件的根本原因，并开始确定有助于恢复的措施。除非涉及恶意软件，否则这一阶段通常非常短暂。
- en: In the *recovery* phase, you take any actions necessary to recover from the
    incident entirely. This might mean reenabling user accounts, changing network
    configurations to remove sandboxes or other segregations enacted as a result of
    malicious activity, and reverting changes made by the malicious actor.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在*恢复*阶段，你需要采取一切必要措施，完全恢复事件后续的操作。这可能意味着重新启用用户账户、更改网络配置以移除因恶意活动实施的沙盒或其他隔离措施，并恢复恶意行为者所做的更改。
- en: After everything is back to normal, the *lessons learned* phase is when you
    analyze the root cause of the incident to determine existing gaps in your knowledge
    and execution. You’ll then remediate these gaps as part of the preparation phase.
    This is the time to be introspective and decide what could have been done better.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 一切恢复正常后，*经验教训*阶段是分析事件根本原因的时刻，确定你在知识和执行方面的现有漏洞。你将随后在准备阶段修补这些漏洞。这是一个反思的过程，决定有哪些地方可以做得更好。
- en: Responding to Phishing
  id: totrans-58
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 响应钓鱼邮件（Phishing）
- en: Now that you understand the basics of incident response, you need to define
    what users should do if they fall victim to the various kinds of social engineering
    attacks. Let’s start with phishing. A phishing email that contains links or files
    might allow an attacker to gain access to your systems. Your goal, then, should
    be to expedite containment and eradication.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经了解了事件响应的基本知识，你需要定义用户在成为各种社会工程攻击的受害者时应该做什么。我们先从钓鱼攻击开始。包含链接或文件的钓鱼邮件可能允许攻击者访问你的系统。因此，你的目标应该是加快封锁和清除攻击的速度。
- en: One tip for making rapid responses possible is to choose a single nonblack color
    for all networking cables. This will allow you to instruct employees to unplug
    that colored cable from the back of the computer or the wall. Bear in mind that
    systems may still be connected to the network wirelessly, and you should define
    behavior for disconnecting wireless devices as well.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 提供快速响应的一个小贴士是，为所有网络电缆选择一种非黑色的颜色。这将允许你指示员工将该颜色的电缆从电脑或墙壁后面拔掉。记住，系统可能仍然通过无线网络连接，你也应该定义断开无线设备连接的行为。
- en: Ask users to report the approximate time at which the incident occurred. This
    detail helps the security team locate the logs they should comb through, rather
    than leaving them with no clues as to where to look. Upon falling victim to the
    attack, users should either log out, lock their screen, power off, unplug from
    the network, or hibernate their system. The actions that a user should take depend
    on the organization’s capabilities and its potential response to a given incident.
    For example, if no forensic analysis will occur, there is no reason to hibernate
    the system. Alternatively, if the organization is going to rebuild the system
    from known, good media, the correct action may be to just shut down the system
    after gathering the artifacts.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 请要求用户报告事件发生的大致时间。这一细节有助于安全团队定位他们需要审查的日志，而不是让他们在没有任何线索的情况下不知道从哪里查起。成为攻击的受害者后，用户应该退出登录、锁屏、关机、断开网络连接，或使系统进入休眠状态。用户应该采取的行动取决于组织的能力及其对特定事件的响应。例如，如果不进行取证分析，就没有必要让系统进入休眠状态。相反，如果组织打算从已知的、良好的媒体重新构建系统，那么在收集到必要的证据后，正确的行动可能是关闭系统。
- en: The user should also report the source email address or website of the phish,
    any windows and applications that were open, and whether anything unusual happened
    on the screen.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 用户还应报告钓鱼邮件的发件人地址或钓鱼网站，任何打开的窗口和应用程序，以及屏幕上是否发生了任何异常。
- en: You should print out these guidelines, laminate them, and put them in each user’s
    physical workspace. At any given time, a user should be able to reference the
    sheet and perform the required actions.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该打印出这些指南，给它们做上塑封，并放在每个用户的工作空间中。任何时候，用户都应该能够参考这些指南并采取必要的行动。
- en: Responding to Vishing
  id: totrans-64
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 响应钓鱼电话（Vishing）
- en: While similar to phishing, vishing presents unique challenges. In the absence
    of monitoring all phone calls, the ability to identify and act upon vishing calls
    relies upon the staff reporting them, as well as knowing the actions to take in
    advance. No widespread or accurate intrusion detection systems (IDSs) or SEIMs
    encompass phone calls. Companies can monitor the internet traffic of any phones
    connected to the corporate Wi-Fi network, but not ordinary phone calls or their
    context. Fortunately, an attacker cannot (immediately) log in and take over a
    network from a phone call. Even if someone who is vishing gets information, technical
    controls might prevent them from causing further harm. Regardless, you must define
    actions for responding to vishing attempts.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然类似于网络钓鱼（phishing），但语音钓鱼（vishing）带来了独特的挑战。在无法监控所有电话的情况下，识别和应对语音钓鱼电话的能力依赖于员工的报告，以及事先了解应采取的措施。没有广泛或准确的入侵检测系统（IDS）或安全信息事件管理系统（SEIM）可以涵盖电话内容。公司可以监控连接到公司
    Wi-Fi 网络的任何手机的互联网流量，但无法监控普通电话或其背景信息。幸运的是，攻击者不能（立即）通过电话登录并接管网络。即使语音钓鱼者获取了信息，技术控制也可能防止他们造成进一步的危害。无论如何，你必须定义应对语音钓鱼尝试的行动。
- en: First, upon noticing that they are experiencing a vishing attack, users should
    either hang up, ask to call back, try to get information out of the caller, or
    lie to confuse the caller. Security management within the organization will need
    decide which actions to train employees to perform. A level of risk is associated
    with encouraging users to solicit information or lie; the user may give up valuable
    and accurate information inadvertently. Users should then contact information
    security and provide the approximate time at which the incident occurred, any
    actions they took, the phone number that called them, the information they were
    asked, and the information they provided. They should also provide any additional
    information about the caller, such as their accent, dialect, tone, or mood, or
    the presence of background noises.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，在发现自己遭遇语音钓鱼攻击时，用户应挂断电话、要求回拨、尝试从来电者那里获取信息，或者通过撒谎来迷惑来电者。组织内的安全管理人员需要决定训练员工执行哪些操作。鼓励用户索取信息或撒谎存在一定风险；用户可能无意中透露有价值且准确的信息。随后，用户应联系信息安全部门，提供事件发生的大致时间、所采取的任何行动、来电号码、被询问信息以及提供的信息。他们还应提供有关来电者的其他信息，如口音、方言、语气或情绪，或背景噪音的存在。
- en: Responding to OSINT Collection
  id: totrans-67
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 响应 OSINT 收集
- en: Detecting OSINT collection is hard, because platforms like Shodan, Censys, and
    Have I Been Pwned don’t automatically allow you to set alerts on queries, though
    you could write your own code to set alerts for whenever the organization’s assets
    appear on such platforms. Have I Been Pwned allows organizations that can demonstrate
    ownership of a domain to set up such alerts, but will not share any breached credentials
    belonging to accounts on the domain. But since OSINT collection typically takes
    place in the reconnaissance phase of an ethical hacking engagement, it’s common
    to see it occur alongside scanning and enumeration, which are detectable.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 检测 OSINT 收集很困难，因为像 Shodan、Censys 和 Have I Been Pwned 这样的平台并不会自动允许你对查询设置警报，尽管你可以编写自己的代码，设置警报，监控组织资产是否出现在这些平台上。Have
    I Been Pwned 允许能够证明拥有某个域名的组织设置这样的警报，但不会共享该域名下账户的任何被泄露的凭据。但由于 OSINT 收集通常发生在道德黑客参与的侦察阶段，因此通常会与扫描和枚举同时发生，而这些活动是可检测的。
- en: The first layer of detection lies within a CDN like Cloudflare or Amazon CloudFront,
    if used. The next layer is within the web server logs or the application logs
    of the web applications. These sources will educate the organization as to who
    is scanning and what is being scanned. Often this will lack the context needed
    to differentiate between web scanning en masse and an actual adversary attempting
    to collect OSINT or working through scanning and enumeration.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 第一层检测位于如 Cloudflare 或 Amazon CloudFront 等内容分发网络（CDN）中（如果使用的话）。下一层检测存在于 web 服务器日志或
    web 应用程序的应用日志中。这些来源将帮助组织了解谁在扫描以及扫描的内容。通常，这些信息缺乏区分大规模网页扫描和实际攻击者尝试收集 OSINT 或通过扫描和枚举工作的上下文。
- en: Decide what actions you should block. Examples can include blocking users after
    a certain number of 404 errors caused by spidering; blocking or rate-limiting
    spidering to a certain number of events per second; blocking anyone who downloads
    a certain number of public files, using a specific user-agent string in the browser
    or script; and blocking users who navigate to a honey page.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
- en: Handling Media Attention
  id: totrans-71
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Depending on the severity of the attack, the publicity it receives, and other
    events happening in the news cycle, the media may seek to speak with people from
    your organization during an incident. While doing so should not be your top priority,
    failing to respond to media inquiries can send a worse message than if you just
    admit that you don’t know all of the details at this time. While the media should
    reach out to the organization’s public relations team, some may attempt to contact
    and interview any employee.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
- en: To control the message being conveyed to the public, enforce a media blackout
    on all employees except those defined in your incident response plan. Provide
    unauthorized employees with a template response for handling such inquiries. This
    can be as simple a statement as “I am not authorized to discuss the details of
    the subject of your request” or a redirect to the designated media representative
    at the company.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
- en: The parties who are authorized to talk to the media must understand what tone
    to take, how to decline to answer, and whom to speak with in order to learn the
    facts they will share with journalists. Also define a person or committee to review
    and approve any messages that the public relations person will provide the media.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
- en: I also highly recommend consulting with your organization’s internal PR team
    and any external PR consultants that your organization uses. They will be able
    to speak to your organization’s specific policies and procedures, whereas I am
    speaking in more general terms.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
- en: How Users Should Report Incidents
  id: totrans-76
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: If you don’t tell users how they should report suspected incidents, they may
    bombard a gate guard who has no means of resolving the problem. One strategy is
    setting up a *phishing@organization.com* email address to collect the phishing
    emails that users receive. You might also set up *cyber@organization.com* or *incidents@organization.com*
    as catchall addresses that forward emails to the appropriate parties.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
- en: When a user has fallen victim to a phish and may have introduced malware to
    the environment, reporting via email may not be the best approach. That’s because
    it’s possible that the entire email system has been compromised and that attackers
    can read, block, or alter the message. Depending on the size of the organization
    and whether a user is onsite or remote, you could direct users to report the incident
    face-to-face, call a phone number, or send a message using private chat or a secure
    texting platform like Signal, Wickr, or Wire.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
- en: Technical Controls and Containment
  id: totrans-79
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: When it identifies a phishing email, the security team should collect the email,
    and any relevant information about it, while adhering to organizational policies
    and procedures. This will pay dividends when producing threat intelligence, which
    may be necessary depending on which industry the organization is in and whether
    it belongs to any Information Sharing and Analysis Centers (ISACs).
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
- en: From the email itself, you should collect the source email address, details
    about whether the email address was spoofed (which is discussed in Chapter 12),
    and the source IP address. You should also block the source addresses and check
    logs to see if any other users or hosts communicated with the source addresses.
    To analyze the attack further, use the tools discussed in Chapter 12.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
- en: If the phishing scheme involves a malicious file, you can upload it to the malware-detecting
    website VirusTotal to get a quick answer about the file’s content, assuming it
    is known malware. Additionally, take a cryptographic hash of the file, and check
    systems on the network for files that produce the same hash. Tune the SEIM to
    alert you about incoming instances of this file as well.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
- en: Sinkhole any IP addresses or URLs associated with the phishing email to redirect
    users to a benign page and set up alerts on workstations for those who attempt
    to access the malicious site. Once the email is sinkholed, the security team can
    contact all users, advising them to avoid the email. Once the incident is in the
    recovery phase, transition the information collected to threat intelligence and
    follow the organization’s guidance on publication and distribution.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  id: totrans-84
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Part of keeping your organization safe is keeping users informed, aware, and
    alert. By applying a nonpunitive policy coupled with incentives for positive behavior
    to reinforce desired actions, you can drastically improve the security posture
    of your organization while empowering employees to make good decisions. Once users
    are trained, know what to look for, and understand what to do when they fall victim
    to social engineering attacks, it is time to engage them by using internal or
    external testers to measure their adherence to the organization’s guidance.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
- en: Even after you train users, it’s still necessary to test them via phishing simulations
    and OSINT monitoring. People sometimes want to publicly share occasions like promotions,
    their last day on the job, or their first day on the job—and as discussed in Chapter
    5, they don’t think about other information they’re including in the frame of
    their photos. Similarly, people want to share their work experience so that they
    can demonstrate their competencies to hiring managers, but this makes the technical
    details listed in their resumes searchable.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
- en: Integrating your training with your incident response process is a crucial aspect
    of defending against social engineering. Awareness programs help the organization
    avoid invoking incident response in the first place, but they should also help
    the incident response process work more smoothly in instances where users fall
    victim.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 将培训与事件响应过程结合起来，是防御社交工程攻击的一个关键方面。意识提升项目帮助组织避免首先引发事件响应，但它们也应当帮助在用户成为受害者时，使事件响应过程更加顺利。
- en: Explicitly telling users what to do if they find themselves the victim of social
    engineering also dramatically improves the organization’s security posture. If
    nontechnical people are left to their own devices, asked to perform technical
    actions without direction, it’s likely that they’ll ignore the problem or try
    to cover it up. Defining steps for users and the security team to take when something
    goes wrong will save the organization a lot of headaches and allow it to focus
    on restoration.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 明确告知用户如果他们成为社交工程攻击的受害者应该怎么做，这也会显著提升组织的安全防护水平。如果没有技术背景的人员被要求在没有指导的情况下执行技术操作，他们很可能会忽视问题或试图掩盖它。为用户和安全团队定义应对措施，在问题发生时采取相应步骤，将为组织省去许多麻烦，并让其能够专注于恢复。
