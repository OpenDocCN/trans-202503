<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:ns="http://www.w3.org/2001/10/synthesis" lang="en-us" xml:lang="en-us">
	<head>
		<title>Ethical Hacking: A Hands-on Introduction to Breaking In</title>
		<link href="../styles/9781718501881.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:3776231c-affd-4772-8376-b44c973236be" name="Adept.expected.resource"/>
	</head>
	<body>
		<h2 class="h2" id="ch1"><span epub:type="pagebreak" id="page_1"/><strong><span class="big">1</span><br/>SETTING UP</strong></h2>
		<p class="verse"><em>A journey of a thousand miles begins with a single step.</em></p>
		<p class="chap-au">–Lao Tzu</p>
		<div class="imagec">
			<img alt="image" src="../images/common.jpg"/>
		</div>
		<p class="noindents">Welcome to the first step in your hacking journey. In this chapter, we’ll set up your lab environment, which will consist of five virtual machines:</p>
		<p class="noindenta"><strong>A pfSense Virtual Machine</strong> An open source router/firewall to protect the vulnerable virtual machines from outside hackers.</p>
		<p class="noindenta"><strong>A Kali Linux Virtual Machine</strong> The machine that contains the hacking tools discussed in this book.</p>
		<p class="noindenta"><strong>Two Ubuntu Linux Desktop Virtual Machines</strong> Machines that we’ll use to demonstrate attacks on desktop/laptop environments.</p>
		<p class="noindenta"><strong>A Metasploitable Virtual Machine</strong> The machine that we’ll use to demonstrate attacks on a Linux server.</p>
		<h3 class="h3" id="ch01lev1"><span epub:type="pagebreak" id="page_2"/><strong>Virtual Lab</strong></h3>
		<p class="noindent">Because it’s both unethical and illegal to hack into machines that you don’t own, the virtual lab we’ll set up in this chapter will provide an environment in which you can perform ethical hacks. <a href="ch01.xhtml#ch1fig1">Figure 1-1</a> shows an overview of the lab environment.</p>
		<div class="image" id="ch1fig1">
			<img alt="image" src="../images/ch01fig01.jpg"/>
		</div>
		<p class="figcap"><em>Figure 1-1: Virtual machine connections</em></p>
		<p class="indent">We’ll also set up two networks: a main internal network that is isolated from the internet by the pfSense firewall and a private network that is isolated from the main network behind a Metasploitable server. We’ll use that second setup to explore attacks in which hackers must first get past one machine to attack another, as is the case with firewalls. We’ll focus on setting up the main network in this chapter and save configuring the private network for <a href="ch14.xhtml#ch14">Chapter 14</a>.</p>
		<p class="indent">Don’t worry about understanding the technical details of these configurations for now; I’ll describe the infrastructure as we progress through the book. I recommend that you begin the setup process using a Windows, Linux, or macOS machine with at least 30GB of free hard drive space and 4GB of RAM. You will be running multiple virtual machines simultaneously, so you’ll need a relatively powerful machine.</p>
		<h3 class="h3" id="ch01lev2"><span epub:type="pagebreak" id="page_3"/><strong>Setting Up VirtualBox</strong></h3>
		<p class="noindent">To set up our networking environment, we’ll need to install <em>VirtualBox</em>. Think of VirtualBox as a program that lets you build virtual computers. You’ll choose your virtual machine’s specifications (for instance, hard drive, amount of RAM, and number of processors), and VirtualBox will assemble a virtual computer that can run programs just as you would on your laptop or desktop. VirtualBox is free to use on Linux, Mac, and Windows machines.</p>
		<p class="indent">Download VirtualBox from <em><a href="https://www.virtualbox.org/wiki/Downloads/">https://www.virtualbox.org/wiki/Downloads/</a></em>, taking care that you download the correct installation files for your computer’s operating system and architecture. Next, walk through the installation process, which will vary depending on the type of computer you’re using; however, you can agree to the default options as a general rule. Once the installation is complete, launch VirtualBox, and you should be greeted with a screen similar to <a href="ch01.xhtml#ch1fig2">Figure 1-2</a>.</p>
		<div class="image" id="ch1fig2">
			<img alt="image" src="../images/ch01fig02.jpg"/>
		</div>
		<p class="figcap"><em>Figure 1-2: The VirtualBox home screen</em></p>
		<h3 class="h3" id="ch01lev3"><strong>Setting Up pfSense</strong></h3>
		<p class="noindent">Now we’ll set up <em>pfSense</em>, an open source router/firewall that will protect our virtual machines from outside attacks. The following steps will guide you through setting up this machine. It’s important that you follow them carefully. First, download the pfSense source files from <em><a href="https://www.pfsense.org/download/">https://www.pfsense.org/download/</a></em>. Choose the AMD64 (64-bit) architecture, the DVD image (ISO) installer, and the server location closest to you before clicking the download button. <a href="ch01.xhtml#ch1fig3">Figure 1-3</a> shows these parameters.</p>
		<div class="image" id="ch1fig3">
			<span epub:type="pagebreak" id="page_4"/>
			<img alt="image" src="../images/ch01fig03.jpg"/>
		</div>
		<p class="figcap"><em>Figure 1-3: Choose these settings to download pfSense.</em></p>
		<p class="indent">Unzip the downloaded pfSense <em>iso.gz</em> file. If you’re on a Unix-based machine, you can do this by running the gunzip command by typing <span class="literal"><strong>gunzip</strong></span> followed by the name of the downloaded file (for example, <span class="literal">gunzip pfSense iso.gz</span> <span class="literal"><em>filename</em></span>) in your terminal. Launch VirtualBox and click the <strong>New</strong> button located in the top options bar, as shown in <a href="ch01.xhtml#ch1fig4">Figure 1-4</a>.</p>
		<div class="image" id="ch1fig4">
			<img alt="image" src="../images/ch01fig04.jpg"/>
		</div>
		<p class="figcap"><em>Figure 1-4: The New button is designated by the starburst symbol.</em></p>
		<p class="indent">You should be prompted to enter some information about your new machine. The examples that follow are for VirtualBox for macOS, but the Linux and Windows versions are similar. Enter <strong>pfSense</strong> as the name, <strong>BSD</strong> as the type, and <strong>FreeBSD (64-bit)</strong> as the version. Once you’ve changed these three options, as shown in <a href="ch01.xhtml#ch1fig5">Figure 1-5</a>, click <strong>Continue</strong>.</p>
		<div class="image" id="ch1fig5">
			<span epub:type="pagebreak" id="page_5"/>
			<img alt="image" src="../images/ch01fig05.jpg"/>
		</div>
		<p class="figcap"><em>Figure 1-5: Enter these settings when creating the pfSense virtual machine.</em></p>
		<p class="indent">The pfSense virtual machine doesn’t require much RAM, so set the memory size to <strong>1024MB</strong>. When prompted for virtual hard drive options, select <strong>Create a virtual hard disk now</strong>. Select <strong>VDI (VirtualBox Disk Image)</strong> for the hard disk file type. Make your new virtual hard disk dynamically allocated and set its size to 5GB, which should be more than enough space for the pfSense installation.</p>
		<div class="note">
			<p class="notet"><strong><span class="notes">NOTE</span></strong></p>
			<p class="notep"><em>When installing the new version of pfSense, users will need to select the Auto (UFS) BIOS option.</em></p>
		</div>
		<h4 class="h4" id="ch01lev4"><em><strong>Setting Up the Internal Network</strong></em></h4>
		<p class="noindent">You can think of the pfSense firewall as a gatekeeper that stands between the internet and your internal network. It will inspect traffic entering and leaving your network to ensure that your internal network is secure from outside attackers. This creates a safe place for you to add vulnerable machines that only you can attack.</p>
		<p class="indent">Right-click <strong>pfSense</strong> in your list of virtual machines and then click <strong>Settings</strong> (<a href="ch01.xhtml#ch1fig6">Figure 1-6</a>).</p>
		<div class="image" id="ch1fig6">
			<span epub:type="pagebreak" id="page_6"/>
			<img alt="image" src="../images/ch01fig06.jpg"/>
		</div>
		<p class="figcap"><em>Figure 1-6: Setting up Network Adapters</em></p>
		<p class="indent">Click the <strong>Network</strong> tab and make sure that the network adapter in the <strong>Adapter 1</strong> tab is enabled and attached to a <strong>Bridged Adapter</strong> with the same name as your wireless/Ethernet card. Enabling a Bridged Adapter creates a direct connection between the pfSense virtual machine and the internet. Next, click the <strong>Adapter 2</strong> tab and make sure <strong>Enable Network Adapter</strong> is enabled and that it is attached to an <strong>Internal Network</strong> that we will name <strong>Internal LAN</strong>. This internal network will connect pfSense to our other virtual machines. Once you click <strong>OK</strong>, the internal network should be available to other virtual machines.</p>
		<h4 class="h4" id="ch01lev5"><strong><em>Configuring pfSense</em></strong></h4>
		<p class="noindent">Now we’re ready to launch pfSense and configure our virtual router settings. Incorrectly configuring these settings could cause your virtual machines to have no internet access.</p>
		<p class="indent">Double-click <strong>pfSense</strong> in your list of virtual machines. You should see a screen similar to <a href="ch01.xhtml#ch1fig7">Figure 1-7</a>. Click the folder icon and then click the <strong>Add</strong> icon in the upper-left corner. Navigate to and select your pfSense ISO image and then click <strong>Start</strong>.</p>
		<div class="image" id="ch1fig7">
			<img alt="image" src="../images/ch01fig07.jpg"/>
		</div>
		<p class="figcap"><em>Figure 1-7: Selecting the pfSense ISO image</em></p>
		<p class="indent">The pfSense virtual machine should take some time to boot. Once it has booted, you should be greeted with a copyright and distribution notice screen. Press ENTER to accept and press ENTER again to install pfSense. As a rule of thumb, stick with the default options.</p>
		<p class="indent">After the install has completed, you should see another prompt asking if you want to reboot. Select <strong>Reboot</strong> and press ENTER. When pfSense <span epub:type="pagebreak" id="page_7"/>reboots, you’ll be directed to the copyright and distribution notice once again. This occurs because the pfSense virtual machine is again booting from the ISO image we used earlier. To fix this, first click the <strong>File</strong> tab in the upper left of the pfSense machine, and then click <strong>Close</strong>. You’ll see a dialog asking how you want to close the virtual machine. Select <strong>Power off the machine</strong> and click <strong>OK</strong>, as shown in <a href="ch01.xhtml#ch1fig8">Figure 1-8</a>.</p>
		<div class="image" id="ch1fig8">
			<img alt="image" src="../images/ch01fig08.jpg"/>
		</div>
		<p class="figcap"><em>Figure 1-8: Powering off pfSense to remove the ISO image</em></p>
		<p class="indent">Once the pfSense virtual machine is powered off, right-click it in your list of virtual machines and select <strong>Settings</strong>. Navigate to the <strong>Storage</strong> tab and right-click the ISO image you previously chose. Then select <strong>Remove Attachment</strong> as shown in <a href="ch01.xhtml#ch1fig9">Figure 1-9</a>. You’ll be asked to confirm that you want to delete the optical drive. Select <strong>Remove</strong> and then click <strong>OK</strong> in the lower right of the Settings screen.</p>
		<div class="image" id="ch1fig9">
			<img alt="image" src="../images/ch01fig09.jpg"/>
		</div>
		<p class="figcap"><em>Figure 1-9: Removing the pfSense ISO image</em></p>
		<p class="indent"><span epub:type="pagebreak" id="page_8"/>Now that you’ve removed the ISO image, double-click <strong>pfSense</strong> in your list of virtual machines. It should take some time to boot. Once pfSense has booted, you should see a screen that looks like this:</p>
		<p class="programs"><span class="codestrong1">Welcome to pfSense                (amd64) on pfSense</span><br/><br/>WAN (wan)       -&gt; em0        -&gt; v4/DHCP4: 192.1689.1.100/24<br/>LAN (lan)       -&gt; em1        -&gt; v4: 192.168.100.1/24<br/><br/>
0) Logout (SSH only)                  9) pfTop<br/>
1) Assign Interfaces                 10) Filter Logs<br/>
2) Set interface(s) IP address       11) Restart webConfigurator<br/>
3) Reset webConfigurator password    12) PHP shell + pfSense tools<br/>
4) Reset to factory defaults         13) Update from console<br/>
5) Reboot system                     14) Disable Secure Shell (sshd)<br/>
6) Halt system                       15) Restore recent configuration<br/>
7) Ping host                         16) Restart PHP-FPM<br/>
8) Shell</p>
		<h3 class="h3" id="ch01lev6"><strong>Setting Up Metasploitable</strong></h3>
		<p class="noindent">The Metasploitable virtual machine is a Linux server that has been intentionally designed to be vulnerable. It’s the machine that we’ll hack throughout this book. But before we do so, we need to prevent other people from accessing this machine. To do that, we’ll connect it to our internal network, which is protected by the pfSense firewall. The following steps outline how to obtain the virtual machine.</p>
		<p class="indent">Download the Metasploitable virtual machine from Sourceforge at <em><a href="https://sourceforge.net/projects/metasploitable/">https://sourceforge.net/projects/metasploitable/</a></em>. Although newer versions of Metasploitable are available, we’ll use version 2 because it’s easier to set up.</p>
		<p class="indent">Unzip the downloaded Metasploitable ZIP file, launch VirtualBox, and click the <strong>New</strong> button. Set your machine’s name to <strong>Metasploitable</strong>, its type to <strong>Linux</strong>, and its version to <strong>Ubuntu (64-bit)</strong>, and then click <strong>Continue</strong>. On the Memory Size page, use the suggested amount of memory. When prompted to choose a hard disk, select <strong>Use an existing virtual hard disk file</strong>, click the folder icon, and browse to your unzipped Metasploitable download. Select the file with the extension <em>.vmdk</em> and click <strong>Create</strong>. To configure the Metasploitable machine network settings, right-click the Metasploitable machine from your list of machines on the left and select <strong>Settings</strong>. Navigate to the <strong>Network</strong> tab. Under <strong>Adapter 1</strong>, select the <strong>Enable Network Adapter</strong> checkbox and select the internal network we created earlier (<strong>Internal LAN</strong>) in the <strong>Attached to</strong> drop-down menu, as shown in <a href="ch01.xhtml#ch1fig10">Figure 1-10</a>.</p>
		<div class="image" id="ch1fig10">
			<span epub:type="pagebreak" id="page_9"/>
			<img alt="image" src="../images/ch01fig10.jpg"/>
		</div>
		<p class="figcap"><em>Figure 1-10: Configuring the Metasploitable internal network</em></p>
		<p class="indent">Open the Metasploitable virtual machine in VirtualBox and wait for the terminal to finish loading. It should display the Metasploitable logo shown in <a href="ch01.xhtml#ch1fig11">Figure 1-11</a>.</p>
		<div class="note">
			<p class="notet"><strong><span class="notes">NOTE</span></strong></p>
			<p class="notep"><em>Your mouse pointer may disappear. This is because the virtual machine has captured it. Press the Host Key Combination (Right CTRL in Windows and Linux and CTRL-ALT in macOS) to get your mouse pointer back.</em></p>
		</div>
		<div class="image" id="ch1fig11">
			<img alt="image" src="../images/ch01fig11.jpg"/>
		</div>
		<p class="figcap"><em>Figure 1-11: The Metasploitable virtual machine after it has been started</em></p>
		<p class="indent">Log in using the username <strong>msfadmin</strong> and password <strong>msfadmin</strong>.</p>
		<h3 class="h3" id="ch01lev7"><strong>Setting Up Kali Linux</strong></h3>
		<p class="noindent"><em>Kali Linux</em> is a Linux distribution that contains a collection of penetration testing tools. We’ll use the Kali virtual machine to hack into the other <span epub:type="pagebreak" id="page_10"/>machines on our virtual network. Download the Kali Linux VirtualBox image from <em><a href="https://www.offensive-security.com/kali-linux-vm-vmware-virtualbox-image-download/">https://www.offensive-security.com/kali-linux-vm-vmware-virtualbox-image-download/</a></em>. Ensure that the files listed are Kali Linux VirtualBox images and not VMWare images, and select the VirtualBox image version that is suitable for your system (64-bit or 32-bit). Add the Kali machine to VirtualBox by right-clicking the downloaded <strong>OVA</strong> file and opening it using VirtualBox. You should be prompted with a screen containing the preconfigured settings for the machine. On the left side of the page, you should see a folder icon. Click it and select your downloaded OVA file.</p>
		<div class="note">
			<p class="notet"><strong><span class="notes">NOTE</span></strong></p>
			<p class="notep"><em>Ensure that your virtual machine is turned off before adjusting the network settings.</em></p>
		</div>
		<p class="indent">To configure network settings, right-click the Kali virtual machine from the list of machines on the left and then select <strong>Settings</strong>. Click the <strong>Network</strong> tab and then click <strong>Adapter 1</strong>. Select the <strong>Enable Network Adapter</strong> checkbox and set <strong>Attached to</strong> from the drop-down menu to <strong>Internal Network</strong>. Leave the name as “Internal LAN” and click <strong>OK</strong>.</p>
		<p class="indent">Open the Kali Linux virtual machine in VirtualBox. If your Kali Linux displays nothing but a black screen, make sure the <strong>PAE/NX</strong> checkbox is selected in <strong>Settings</strong> ▶<strong>General</strong> ▶<strong>Processors</strong>.</p>
		<p class="indent">Once your machine starts, you should see the Kali Linux login screen shown in <a href="ch01.xhtml#ch1fig12">Figure 1-12</a>.</p>
		<div class="image" id="ch1fig12">
			<img alt="image" src="../images/ch01fig12.jpg"/>
		</div>
		<p class="figcap"><em>Figure 1-12: The Kali Linux login screen</em></p>
		<p class="indent">Log in with the username <strong>kali</strong> and password <strong>kali</strong>.</p>
		<div class="note">
			<p class="notet"><strong><span class="notes">NOTE</span></strong></p>
			<p class="notep"><em>When installing VirtualBox on Windows, users will need to install the VirtualBox Extensions.</em></p>
		</div>
		<h3 class="h3" id="ch01lev8"><strong>Setting Up the Ubuntu Linux Desktop</strong></h3>
		<p class="noindent">Now we’ll set up the Ubuntu Linux Desktop virtual machine. We’ll use this machine to demonstrate how a hacker can attack a victim’s desktop or laptop. The following steps outline how to download and configure Ubuntu. Here, we’ll configure only the Ubuntu machine that is attached to our internal LAN. We’ll configure a second Ubuntu machine that is associated with the private network in <a href="ch14.xhtml#ch14">Chapter 14</a>.</p>
		<p class="indent">Download the latest Ubuntu ISO image from <em><a href="https://ubuntu.com/download/desktop/">https://ubuntu.com/download/desktop/</a></em>. Launch VirtualBox and click the <strong>New</strong> button in the top options bar, as depicted in <a href="ch01.xhtml#ch1fig4">Figure 1-4</a>. You should be prompted to <span epub:type="pagebreak" id="page_11"/>enter some information about your new machine. Enter <strong>Ubuntu</strong> as the name, <strong>Linux</strong> for the type, and <strong>Ubuntu (64-bit)</strong> for the version and click <strong>Continue</strong>. Next, allocate <strong>2048MB</strong> of RAM and a <strong>10GB</strong> hard disk. (Remember to attach the ISO image.) Ubuntu requires slightly more disk space and RAM than pfSense to run efficiently. Lastly, attach the Ubuntu Linux machine to the internal network as you did with the Metasploitable virtual machine.</p>
		<p class="indent">Start the Ubuntu machine, select your desired language, and click <strong>Install Ubuntu</strong>. <a href="ch01.xhtml#ch1fig13">Figure 1-13</a> shows an example of the first page of the setup screen.</p>
		<div class="image" id="ch1fig13">
			<img alt="image" src="../images/ch01fig13.jpg"/>
		</div>
		<p class="figcap"><em>Figure 1-13: The installation screen for Ubuntu Linux</em></p>
		<p class="indent">Shut down the Ubuntu virtual machine. We won’t need it again until <a href="ch10.xhtml#ch10">Chapter 10</a>.</p>
		<h3 class="h3" id="ch01lev9"><strong>Your First Hack: Exploiting a Backdoor in Metasploitable</strong></h3>
		<p class="noindent">Now that you’ve set up everything, let’s test the virtual lab infrastructure by executing an attack. Our goal is to gain access to the Metasploitable machine by exploiting a vulnerability called a <em>backdoor</em>. A backdoor is an intentional flaw that allows an attacker to gain unauthorized access.</p>
		<p class="indent">In July 2011, the security community discovered that an attacker had inserted a backdoor into the code of version 2.3.4 of vsftpd, an open source <span epub:type="pagebreak" id="page_12"/>UNIX FTP server. This is one disadvantage of open source software: it’s possible for malicious developers to compromise the open source project.</p>
		<p class="indent">This particular backdoor allows the attacker to gain access to the terminal on the vulnerable machine. All the attacker needs to do is log into the FTP server using a username ending in <span class="literal">:)</span> and an invalid password. Once the attack is activated, it opens a <em>shell</em> on port 6200. A shell is a program that connects to an attacker’s machine, allowing the attacker to execute terminal commands on the compromised machine.</p>
		<p class="indent">Let’s exploit the Metasploitable server, which contains this vulnerability. We’ll begin by obtaining the Metasploitable machine’s IP address.</p>
		<p class="indent">Before you continue, ensure that your pfSense virtual machine is running. You’ll need it to access the internet.</p>
		<h4 class="h4" id="ch01lev10"><strong><em>Getting the IP Address of the Metasploitable Server</em></strong></h4>
		<p class="noindent">The first step in most hacks is identifying the machine that we want to connect to. As we’ll discuss in more detail in <a href="ch02.xhtml#ch2">Chapter 2</a>, each machine has a unique IP address. In this section, we’ll show how to use the <span class="literal">netdiscover</span> tool to obtain the IP address of the Metasploitable server.</p>
		<p class="indent">Open the terminal on your Kali Linux machine by clicking the icon in the upper-left section of the menu. Enter the command <span class="literal"><strong>netdiscover</strong></span>. If your terminal says the command cannot be found or that you must be root to run it, run it as <span class="literal">sudo</span>:</p>
		<p class="programs">kali@kali:~$ <span class="codestrong1">sudo netdiscover</span></p>
		<p class="indent">The <span class="literal">netdiscover</span> tool searches multiple IP addresses on your network to discover those that are currently being used, letting you see all of the machines currently connected to the same LAN. After a couple of minutes, <span class="literal">netdiscover</span> should have discovered the Metasploitable server and its IP address, displaying it in a screen similar to this one:</p>
		<p class="programs">IP               At MAC Address     Count     Len  MAC Vendor / Hostname<br/>
---------------------------------------------------------------------------<br/>
192.168.100.1    08:00:27:3b:8f:ed      1      60  PCS Systemtechnik GmbH<br/>
192.168.100.101  08:00:27:fe:31:e6      1      60  PCS Systemtechnik GmbH</p>
		<p class="indent">For simplicity, ensure that you’re running only the pfSense, Metasploitable, and Kali virtual machines. This will reduce the number of virtual machines on the network and make it easier to read the <span class="literal">netdiscover</span> tool’s output.</p>
		<p class="indent">The first IP address belongs to the pfSense router, and the second belongs to the Metasploitable machine. (Your addresses may differ.) The machine with the lowest address is normally the router, or in this case, the firewall through which all traffic entering and exiting the network travels. Your Metasploitable server is most likely the second IP address.</p>
		<p class="indent">Now that you have the server’s IP address, you should be able to visit the web pages that the server is hosting. Click the blue Kali logo in the upper-left <span epub:type="pagebreak" id="page_13"/>corner of the Kali machine. Then, open the Kali Linux web browser, and enter the IP address you discovered, as shown in <a href="ch01.xhtml#ch1fig14">Figure 1-14</a>.</p>
		<div class="image" id="ch1fig14">
			<img alt="image" src="../images/ch01fig14.jpg"/>
		</div>
		<p class="figcap"><em>Figure 1-14: The Metasploitable machine in the Kali Linux browser</em></p>
		<p class="indent">If you can see the web page, it means that both your Metasploitable machine and the Kali Linux machine are correctly connected to the internal network.</p>
		<h4 class="h4" id="ch01lev11"><strong><em>Using the Backdoor to Gain Access</em></strong></h4>
		<p class="noindent">Now, we’ll exploit the backdoor to gain access to the Metasploitable machine. Connect to the FTP server using Netcat (<span class="literal">nc</span>), a command line tool that supports several networking functions. Here, we’ll use it to open a TCP socket to server. (We will discuss TCP sockets in <a href="ch03.xhtml#ch3">Chapter 3</a>.)</p>
		<p class="indent">Open the terminal on your Kali machine and enter the following commands:</p>
		<p class="programs">kali@kali:~$ <span class="codestrong1">nc <span class="codeitalic">&lt;IPaddressofyourMetasploitablevirtual machine&gt;</span> 21</span><br/><span class="codestrong1">user Hacker:)</span><br/><span class="codestrong1">pass invalid</span></p>
		<p class="indent">The value at the end of the first command is the port number. FTP servers normally run on port 21. We’ll discuss the concept of a port number in <a href="ch03.xhtml#ch3">Chapter 3</a>, but for now you can think of it as a communication channel <span epub:type="pagebreak" id="page_14"/>that the operating system assigns to a program. Program A may be communicating on channel 21, whereas program B may be communicating on channel 6200.</p>
		<p class="indent">Now that you’ve activated the shell associated with the backdoor, open a new terminal window, and enter the following command to connect to the shell that should be running on port 6200 on the Metasploitable machine:</p>
		<p class="programs">kali@kali:~$ <span class="codestrong1">nc -v <span class="codeitalic">&lt;IPaddressofyourMetasploitable virtualmachine&gt;</span> 6200</span></p>
		<p class="indent">After you’re connected, it will appear as though the terminal is unresponsive. But this is not the case, it’s just waiting for you to type something in. Type the <span class="literal"><strong>ls</strong></span> command to list all the files in the current directory.</p>
		<p class="indent">You should now be able to enter commands in your Kali Linux terminal and have them run as though they were entered on the terminal in the Metasploitable machine. For instance, use the shell to reboot the machine by entering the following commands in the terminal on your Kali machine and then observe what happens to your Metasploitable machine:</p>
		<p class="programs"><span class="codestrong1">whoami</span><br/><span class="codestrong1">reboot</span></p>
		<p class="indent">If the attack is executed correctly, the Metasploitable machine will reboot. Though restarting the machine might not seem that dangerous, an attacker with root privileges could do many more things; for example, delete all the data on a server by running the command <span class="literal"><strong>rm -rf/</strong></span>. Don’t run this command on Metasploitable! It will delete all the data on the machine, and you’ll have to repeat the setup process.</p>
		<p class="indent">How could we fix this vulnerability? Newer versions of vsftpd have identified and removed this issue, so the best way to secure this server is to update vsftpd. However, the Metasploitable machine is designed to be vulnerable; therefore, it is not configured to support updates.</p>
	</body>
</html>