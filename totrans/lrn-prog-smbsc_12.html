<html><head></head><body>
<h2 class="h2" id="ch12"><span epub:type="pagebreak" id="page_165"/><span class="big"><span class="blue"><strong>12</strong></span></span><br/><strong>BUILDING GRAPHICAL USER INTERFACES</strong></h2>&#13;
<div class="imagec"><img alt="image" src="graphics/common01.jpg"/></div>&#13;
<p class="noindent">Every device has a set of <em>interfaces</em>. For example, an interface could be the buttons on a microwave or in an elevator, the knobs on a dishwasher, or even the soda pop dispenser at your favorite burger joint. Computer programs have interfaces as well. Back in the day, programs had only text menus, but now we use different ways to interact with computers, such as the icons on your desktop.</p>&#13;
<p class="indent">Although you’ve written some very useful programs in this book, they don’t look like the programs you’re used to, such as a word processor, a paint program, a web browser, video games, and so on.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_166"/>Today, most programs use a <em>graphical user interface</em>, or <em>GUI</em> (pronounced “gooey,” but don’t worry, it’s not sticky). GUIs can have menus, buttons, text boxes, and more.</p>&#13;
<p class="indent">One example is the Calculator program shown in <a href="ch12.html#ch12fig1">Figure 12-1</a>. When a user clicks one of the number buttons in the program, that number appears in the box at the top of the window. And when the user clicks the = button, the program computes the result of the math operation and displays it.</p>&#13;
<p class="indent">In this chapter, you’ll learn about the <span class="literal">Controls</span> object, which lets you create graphical interfaces for your programs and games.</p>&#13;
<div class="image"><img alt="image" src="graphics/f12-01.jpg"/></div>&#13;
<p class="figcap"><a id="ch12fig1"/><em>Figure 12-1: The Calculator program’s user interface</em></p>&#13;
<h3 class="h3" id="ch12lev1sec01"><span class="blue"><strong>Design a User Interface with the Controls Object</strong></span></h3>&#13;
<p class="noindent">Let’s start with a simple program that lets users enter their first and last name, and then the program greets them by name with a friendly message. <a href="ch12.html#ch12fig2">Figure 12-2</a> shows you <em>FirstGUIApp.sb</em>, the GUI you’ll create. The gridlines and coordinate points in the figure aren’t part of the output, but they’re included to illustrate the x- and y-coordinates of the interface’s different components.</p>&#13;
<div class="image"><img alt="image" src="graphics/f12-02.jpg"/></div>&#13;
<p class="figcap"><a id="ch12fig2"/><em>Figure 12-2: The</em> FirstGUIApp.sb <em>user interface</em></p>&#13;
<h4 class="h4" id="ch12lev2sec01"><em><strong>Step 1: The Design Phase</strong></em></h4>&#13;
<p class="noindent">In this program, a user enters their first and last name in the text boxes and then clicks the Show Message button. If their first name is Alpaca and their last name is Bag, the program shows a message like the following (in the multiline text box).</p>&#13;
<p class="programs"><span epub:type="pagebreak" id="page_167"/>Hello there, Alpaca Bag!</p>&#13;
<p class="indent">Start Small Basic and enter the following two lines:</p>&#13;
<p class="programs"><span class="blue1">GraphicsWindow</span><span class="brown">.DrawText(</span><span class="red">20</span><span class="brown">,</span> <span class="red">20</span><span class="brown">,</span> <span class="red">"First name:"</span><span class="brown">)</span>  <span class="green"><span class="codeitalic">' Label</span></span><br/>fnText <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.AddTextBox(</span><span class="red">100</span><span class="brown">,</span> <span class="red">20</span><span class="brown">)</span>           <span class="green"><span class="codeitalic">' First name text box</span></span></p>&#13;
<p class="indent">The first statement draws the text <em>First name:</em> at position (20, 20). In the second statement, the <span class="literal">Controls</span> object creates a text box with its upper-left corner at (100, 20). The box’s identifier is saved in the variable <span class="literal">fnText</span> (first-name text box). You’ll need this identifier later when you want to know what the user entered in this text box.</p>&#13;
<p class="indent">Click <strong>Run</strong>, and you’ll see the <em>First name:</em> label and a text box placed to its right. The size of the text box is about 160×20 (the default size).</p>&#13;
<p class="indent">Next, add the following two lines to create the <em>Last name:</em> label and its associated text box:</p>&#13;
<p class="programs"><span class="blue1">GraphicsWindow</span><span class="brown">.DrawText(</span><span class="red">20</span><span class="brown">,</span> <span class="red">60</span><span class="brown">,</span> <span class="red">"Last name:"</span><span class="brown">)</span> <span class="green"><span class="codeitalic">' Label</span></span><br/>lnText <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.AddTextBox(</span><span class="red">100</span><span class="brown">,</span> <span class="red">60</span><span class="brown">)</span>         <span class="green"><span class="codeitalic">' Last name text box</span></span></p>&#13;
<p class="indent">Here, the box’s identifier is saved in <span class="literal">lnText</span> (last-name text box). Click <strong>Run</strong> again, and you should see the text boxes and their labels perfectly aligned in the graphics window.</p>&#13;
<p class="indent">Now you’ll create the Show Message button by calling the <span class="literal">Controls</span> object’s <span class="literal">AddButton()</span> method:</p>&#13;
<p class="programs">showBtn <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.AddButton(</span><span class="red">"Show Message"</span><span class="brown">,</span> <span class="red">280</span><span class="brown">,</span> <span class="red">20</span><span class="brown">)</span> <span class="green"><span class="codeitalic">' Button</span></span></p>&#13;
<p class="indent">The first argument of <span class="literal">AddButton()</span> is the button’s caption, <span class="literal">"Show Message"</span>. The second and the third arguments tell the <span class="literal">Controls</span> object where the upper-left corner of the button should go. The button’s identifier is saved in <span class="literal">showBtn</span> (show button). Click <strong>Run</strong> to see what you’ve just created. By default, the button’s width will be as wide as its label. Try lengthening or shortening the button’s label, and run the program again to see what happens.</p>&#13;
<p class="indent">Next, you need to add the last GUI element—the box that shows the output message. Because you can greet the user with a long message if you want to, let’s use a multiline text box. The multiline text box has horizontal and vertical scroll bars that appear automatically if needed, like Harry Potter’s Room of Requirement. To create a multiline text box, call the <span class="literal">AddMultiLineTextBox()</span> method:</p>&#13;
<p class="programs">msgText <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.AddMultiLineTextBox(</span><span class="red">100</span><span class="brown">,</span> <span class="red">100</span><span class="brown">)</span> <span class="green"><span class="codeitalic">' Message text box</span></span></p>&#13;
<p class="indent">Again, the two arguments specify the upper-left position of the box. The box’s identifier is saved in <span class="literal">msgText</span> (message text box); you’ll need it later to set the box’s text. Click <strong>Run</strong>, and you’ll see a multiline text box <span epub:type="pagebreak" id="page_168"/>located at (100, 100). By default, the size of this box is about 200×80. Let’s make this box wider by calling the <span class="literal">SetSize()</span> method. Add this line of code just after creating the multiline text box:</p>&#13;
<p class="programs"><span class="blue1">Controls</span><span class="brown">.SetSize(</span>msgText<span class="brown">,</span> <span class="red">280</span><span class="brown">,</span> <span class="red">80</span><span class="brown">)</span>  <span class="green"><span class="codeitalic">' Makes width = 280 and height = 80</span></span></p>&#13;
<p class="indent">The first argument is the identifier of the control you want to resize, in this case <span class="literal">msgText</span>. The second argument (<span class="literal">280</span>) is the width, and the third (<span class="literal">80</span>) is the height. If you run the code now, you’ll see an interface similar to the one shown earlier in <a href="ch12.html#ch12fig2">Figure 12-2</a>. Note that the upper-left corner of the message text box didn’t change when you called <span class="literal">SetSize()</span>.</p>&#13;
<h4 class="h4" id="ch12lev2sec02"><em><strong>Step 2: Program Interactivity</strong></em></h4>&#13;
<p class="noindent">You’ve created all the controls you need and positioned them where you wanted them. Next, you’ll make these controls interactive. You need to write some code that responds to the button’s click. When a user clicks the button, the program needs to read the contents of the first name and the last name text boxes and then display the greeting in the multiline text box. Add lines 13–21, as shown in <a href="ch12.html#ch12ex1">Listing 12-1</a>, to complete the program (you’ve already written lines 2–11 to create the GUI elements).</p>&#13;
<p class="programs"> 1 <span class="green"><span class="codeitalic">' FirstGUIApp.sb</span></span><br/> 2 <span class="blue1">GraphicsWindow</span><span class="brown">.DrawText(</span><span class="red">20</span><span class="brown">,</span> <span class="red">20</span><span class="brown">,</span> <span class="red">"First name:"</span><span class="brown">)</span>  <span class="green"><span class="codeitalic">' Label</span></span><br/> 3 fnText <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.AddTextBox(</span><span class="red">100</span><span class="brown">,</span> <span class="red">20</span><span class="brown">)</span>           <span class="green"><span class="codeitalic">' First name text box</span></span><br/> 4<br/> 5 <span class="blue1">GraphicsWindow</span><span class="brown">.DrawText(</span><span class="red">20</span><span class="brown">,</span> <span class="red">60</span><span class="brown">,</span> <span class="red">"Last name:"</span><span class="brown">)</span> <span class="green"><span class="codeitalic">' Label</span></span><br/> 6 lnText <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.AddTextBox(</span><span class="red">100</span><span class="brown">,</span> <span class="red">60</span><span class="brown">)</span>         <span class="green"><span class="codeitalic">' Last name text box</span></span><br/> 7<br/> 8 showBtn <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.AddButton(</span><span class="red">"Show Message"</span><span class="brown">,</span> <span class="red">280</span><span class="brown">,</span> <span class="red">20</span><span class="brown">)</span> <span class="green"><span class="codeitalic">' Button</span></span><br/> 9<br/>10 msgText <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.AddMultiLineTextBox(</span><span class="red">100</span><span class="brown">,</span> <span class="red">100</span><span class="brown">)</span>      <span class="green"><span class="codeitalic">' Message text box</span></span><br/>11 <span class="blue1">Controls</span><span class="brown">.SetSize(</span>msgText<span class="brown">,</span> <span class="red">280</span><span class="brown">,</span> <span class="red">80</span><span class="brown">)</span>        <span class="green"><span class="codeitalic">' Makes width = 280 and height = 80</span></span><br/>12<br/>13 <span class="blue1">Controls</span><span class="brown">.ButtonClicked =</span> OnButtonClicked  <span class="green"><span class="codeitalic">' Handler for button click</span></span><br/>14<br/>15 <span class="purple"><span class="codestrong">Sub</span></span> OnButtonClicked<br/>16   firstName <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.GetTextBoxText(</span>fnText<span class="brown">)</span>  <span class="green"><span class="codeitalic">' First name text box</span></span><br/>17   lastName <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.GetTextBoxText(</span>lnText<span class="brown">)</span>   <span class="green"><span class="codeitalic">' Last name text box</span></span><br/>18   fullName <span class="brown">=</span> firstName <span class="brown">+</span> <span class="red">" "</span> <span class="brown">+</span> lastName        <span class="green"><span class="codeitalic">' Constructs full name</span></span><br/>19   message <span class="brown">=</span> <span class="red">"Hello there, "</span> <span class="brown">+</span> fullName <span class="brown">+</span> <span class="red">"!"</span>   <span class="green"><span class="codeitalic">' Greeting message</span></span><br/>20   <span class="blue1">Controls</span><span class="brown">.SetTextBoxText(</span>msgText<span class="brown">,</span> message<span class="brown">)</span><br/>21 <span class="purple"><span class="codestrong">EndSub</span></span></p>&#13;
<p class="listcap"><a id="ch12ex1"/><em>Listing 12-1: Creating a simple GUI program</em></p>&#13;
<p class="indent">Line 13 registers a handler for the <span class="literal">ButtonClicked</span> event. This line tells the <span class="literal">Controls</span> object to call the <span class="literal">OnButtonClicked()</span> subroutine whenever the user clicks the Show Message button.</p>&#13;
<p class="indent">In the <span class="literal">OnButtonClicked()</span> subroutine, <span class="literal">GetTextBoxText()</span> is called first to get the text that’s entered into the first-name text box and save it into the <span epub:type="pagebreak" id="page_169"/><span class="literal">firstName</span> variable (line 16). This method takes one argument—the identifier of the text box whose text is needed. <span class="literal">GetTextBoxText()</span> is called again, but with a different argument, to get the text that’s entered into the last-name text box and save it into <span class="literal">lastName</span> (line 17). Then the <span class="literal">fullName</span> variable is set by concatenating <span class="literal">firstName</span> and <span class="literal">lastName</span> with a space between them (line 18). At line 19 you create your greeting message and save it in the <span class="literal">message</span> variable. Finally, you call <span class="literal">SetTextBoxText()</span> to set the text of the message text box. The first argument is the control’s identifier whose text is to be set, and the second argument is the new text (line 20). Run the program, enter some text in the text boxes, and then click the button to see how the program works.</p>&#13;
<p class="indent">In the next section, you’ll learn how to make GUI programs that have more than one button. Now you can push Small Basic’s buttons!</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch12sb01"><strong>TRY IT OUT 12-1</strong></p>&#13;
<p class="noindent">Using the code in <a href="ch12.html#ch12ex1">Listing 12-1</a>, take the first name and last name from the user, and then update the code to display a silly short story that includes the user’s name.</p>&#13;
</div>&#13;
<h3 class="h3" id="ch12lev1sec02"><span class="blue"><strong>Make a Colorful Drawing Program</strong></span></h3>&#13;
<p class="noindent">If you create a program with several buttons, the <span class="literal">ButtonClicked</span> event handler gets called when a user clicks any of these buttons. To find out which button was clicked, you can use the <span class="literal">Controls.LastClickedButton</span> property to get the clicked button’s identifier; it’s like asking your friend to tell you who noticed your brand-new shoes.</p>&#13;
<p class="indent">To show you how to use the <span class="literal">ButtonClicked</span> event when a program has more than one button, let’s add to the <em>Scribble.sb</em> program you made in <a href="ch11.html#ch11">Chapter 11</a> (see <a href="ch11.html#ch11ex4">Listing 11-4</a> on page 156). The user can select the pen’s color by clicking a button. Check out the program’s GUI in <a href="ch12.html#ch12fig3">Figure 12-3</a>.</p>&#13;
<div class="image"><img alt="image" src="graphics/f12-03.jpg"/></div>&#13;
<p class="figcap"><a id="ch12fig3"/><em>Figure 12-3: Sample output of</em> Scribble2.sb</p>&#13;
<p class="indent">Try out the updated program, <em>Scribble2.sb</em>, shown in <a href="ch12.html#ch12ex2">Listing 12-2</a>. You might notice that this program uses the same <span class="literal">OnMouseMove</span> event handler as the one in <a href="ch11.html#ch11ex4">Listing 11-4</a>.</p>&#13;
<p class="programs"> 1 <span class="green"><span class="codeitalic">' Scribble2.sb</span></span><br/> 2 btnR <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.AddButton(</span><span class="red">"Red"</span><span class="brown">,</span> <span class="red">10</span><span class="brown">,</span> <span class="red">30</span><span class="brown">)</span><br/> 3 btnG <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.AddButton(</span><span class="red">"Green"</span><span class="brown">,</span> <span class="red">10</span><span class="brown">,</span> <span class="red">65</span><span class="brown">)</span><br/> 4 btnB <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.AddButton(</span><span class="red">"Blue"</span><span class="brown">,</span> <span class="red">10</span><span class="brown">,</span> <span class="red">100</span><span class="brown">)</span><br/> 5 <span class="blue1">Controls</span><span class="brown">.SetSize(</span>btnR<span class="brown">,</span> <span class="red">60</span><span class="brown">,</span> <span class="red">30</span><span class="brown">)</span><br/> 6 <span class="blue1">Controls</span><span class="brown">.SetSize(</span>btnG<span class="brown">,</span> <span class="red">60</span><span class="brown">,</span> <span class="red">30</span><span class="brown">)</span><br/> 7 <span class="blue1">Controls</span><span class="brown">.SetSize(</span>btnB<span class="brown">,</span> <span class="red">60</span><span class="brown">,</span> <span class="red">30</span><span class="brown">)</span><br/> 8<br/> 9 <span class="blue1">GraphicsWindow</span><span class="brown">.MouseMove =</span> OnMouseMove<br/>10 <span class="blue1">Controls</span><span class="brown">.ButtonClicked =</span> OnButtonClicked<br/>11<br/>12 <span class="purple"><span class="codestrong">Sub</span></span> OnButtonClicked         <span class="green"><span class="codeitalic">' Changes the pen color</span></span><br/>13   <span class="purple"><span class="codestrong">If</span></span> <span class="brown">(</span><span class="blue1">Controls</span><span class="brown">.LastClickedButton =</span> btnR<span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span><br/>14     <span class="blue1">GraphicsWindow</span><span class="brown">.PenColor =</span> <span class="red">"Red"</span><br/>15   <span class="purple"><span class="codestrong">ElseIf</span></span> <span class="brown">(</span><span class="blue1">Controls</span><span class="brown">.LastClickedButton =</span> btnG<span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span><br/>16     <span class="blue1">GraphicsWindow</span><span class="brown">.PenColor =</span> <span class="red">"Green"</span><br/>17   <span class="purple"><span class="codestrong">Else</span></span><br/>18     <span class="blue1">GraphicsWindow</span><span class="brown">.PenColor =</span> <span class="red">"Blue"</span><br/>19   <span class="purple"><span class="codestrong">EndIf</span></span><br/>20 <span class="purple"><span class="codestrong">EndSub</span></span><br/>21<br/>22 <span class="purple"><span class="codestrong">Sub</span></span> OnMouseMove<br/>23   x <span class="brown">=</span> <span class="blue1">GraphicsWindow</span><span class="brown">.MouseX</span>   <span class="green"><span class="codeitalic">' Current x position of mouse</span></span><br/>24   y <span class="brown">=</span> <span class="blue1">GraphicsWindow</span><span class="brown">.MouseY</span>   <span class="green"><span class="codeitalic">' Current y position of mouse</span></span><br/>25<br/>26   <span class="purple"><span class="codestrong">If</span></span> <span class="brown">(</span><span class="blue1">Mouse</span><span class="brown">.IsLeftButtonDown)</span> <span class="purple"><span class="codestrong">Then</span></span><br/>27     <span class="blue1">GraphicsWindow</span><span class="brown">.DrawLine(</span>prevX<span class="brown">,</span> prevY<span class="brown">,</span> x<span class="brown">,</span> y<span class="brown">)</span><br/>28   <span class="purple"><span class="codestrong">EndIf</span></span><br/>29<br/>30   prevX <span class="brown">=</span> x <span class="green"><span class="codeitalic">' Updates the last (previous) position</span></span><br/>31   prevY <span class="brown">=</span> y<br/>32 <span class="purple"><span class="codestrong">EndSub</span></span></p>&#13;
<p class="listcap"><a id="ch12ex2"/><em>Listing 12-2: Clicking the buttons to change the pen color</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_170"/>Lines 2–4 create the three color selection buttons. The coordinates of the upper-left corner of the three buttons are (10, 30), (10, 65), and (10, 100). The statements in lines 5–7 set the size of each button to 60 <em>×</em> 30 (width = 60 and height = 30). Lines 9–10 register the handlers for the <span class="literal">MouseMove</span> and <span class="literal">ButtonClicked</span> events.</p>&#13;
<p class="indent">The program calls the <span class="literal">OnButtonClicked()</span> subroutine (line 12) when a user clicks any of the three buttons. To know which one was clicked, the subroutine uses an <span class="literal">If/ElseIf</span> ladder to compare the <span class="literal">LastClickedButton</span> property with the identifiers of the three buttons (lines 13–19). After identifying the clicked button, the subroutine sets the <span class="literal">PenColor</span> property (of <span class="literal">GraphicsWindow</span>) to the selected color. The <span class="literal">OnMouseMove()</span> subroutine is the same as the one in the previous version of the program, and it is defined on lines 22–32.</p>&#13;
<div class="note">&#13;
<p class="notet"><span class="notes"><strong>TIP</strong></span></p>&#13;
<p class="notep"><em>You can also write the</em> <span class="literal"><span class="codeitalic">OnButtonClicked()</span></span> <em>subroutine like this:</em></p>&#13;
<p class="programs"><span class="purple"><span class="codestrong">Sub</span></span> OnButtonClicked<br/>  btnID <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.LastClickedButton</span><br/>  <span class="blue1">GraphicsWindow</span><span class="brown">.PenColor =</span> <span class="blue1">Controls</span><span class="brown">.GetButtonCaption(</span>btnID<span class="brown">)</span><br/><span class="purple"><span class="codestrong">EndSub</span></span></p>&#13;
<p class="indent"><em>Instead of hardcoding the color of the clicked button, you get the color from the clicked button’s caption using the</em> <span class="literal"><span class="codeitalic">GetButtonCaption()</span></span> <em>method.</em></p>&#13;
</div>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch12sb02"><span epub:type="pagebreak" id="page_171"/><strong>TRY IT OUT 12-2</strong></p>&#13;
<p class="noindent">You can change the color of a button’s caption by setting the <span class="literal">BrushColor</span> property of <span class="literal">GraphicsWindow</span> before you create the button. Change <a href="ch12.html#ch12ex2">Listing 12-2</a> so the text color of each button matches its caption (write the text of the Blue button in blue, and so on).</p>&#13;
</div>&#13;
<h3 class="h3" id="ch12lev1sec03"><span class="blue"><strong>Explore Circuits with Code</strong></span></h3>&#13;
<p class="noindent">In this section, you’ll create a program that demonstrates an electrical series circuit. (Your skills are shocking!) The circuit includes a battery, three resistors, and a switch connected in series. A user can change the battery’s voltage and the values of the three resistors by entering their values in the text boxes. When the user enters a new value in any of the text boxes, the <span class="literal">Controls</span> object raises the <span class="literal">TextTyped</span> event. In response to this event, the program automatically calculates (and displays) the current that flows through the circuit and the voltages across each of the three resistors (see <a href="ch12.html#ch12fig4">Figure 12-4</a>).</p>&#13;
<div class="image"><img alt="image" src="graphics/f12-04.jpg"/></div>&#13;
<p class="figcap"><a id="ch12fig4"/><em>Figure 12-4: A program that shows you the operation of a series circuit</em></p>&#13;
<p class="indentb">Here are the equations that describe the science behind the program:</p>&#13;
<p class="itemlist"><strong>Total resistance</strong> <em>R<sub>tot</sub></em> = <em>R</em><sub>1</sub> + <em>R</em><sub>2</sub> + <em>R</em><sub>3</sub></p>&#13;
<p class="itemlist"><strong>Current through the circuit</strong> <em>I</em> = <em>V</em> ÷ <em>R<sub>tot</sub></em>, where <em>V</em> is the battery voltage</p>&#13;
<p class="itemlist"><strong>Voltage across <em>R</em><sub>1</sub></strong> <em>V</em><sub>1</sub> = <em>I</em> × <em>R</em><sub>1</sub></p>&#13;
<p class="itemlist"><strong>Voltage across <em>R</em><sub>2</sub></strong> <em>V</em><sub>2</sub> = <em>I</em> × <em>R</em><sub>2</sub></p>&#13;
<p class="itemlist"><strong>Voltage across <em>R</em><sub>3</sub></strong> <em>V</em><sub>3</sub> = <em>I</em> × <em>R</em><sub>3</sub></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_172"/>Let’s look at the computations. You calculate the total resistance (<em>R<sub>tot</sub></em>) by adding the values of the three resistors together. Next, you calculate the current (<em>I</em>) that flows in the circuit by dividing the battery voltage (<em>V</em>) by the total resistance. Then you calculate the voltage across each resistor by multiplying the current by the value of that resistor. (Try reading this paragraph aloud to your friends as if it’s super easy. It will blow their minds!)</p>&#13;
<p class="indent">The following steps guide you through creating this program. So buckle your seat belt, hold on tight, and get set to rocket into the exciting world of computer simulations.</p>&#13;
<h4 class="h4" id="ch12lev2sec03"><em><strong>Step 1: Open the Startup File</strong></em></h4>&#13;
<p class="noindent">To start creating this circuit simulator, open <em>SeriesCircuit_Incomplete.sb</em> from this chapter’s folder. The file contains comments that tell you where to add your code and empty placeholders for the subroutines you’ll write.</p>&#13;
<p class="indent">The folder for this chapter also includes the two background images you’ll need: <em>bkgndOff.bmp</em> and <em>bkgndOn.bmp</em> (see <a href="ch12.html#ch12fig5">Figure 12-5</a>; we added the image names for clarity). The two images are the same except for the state of the switch: the switch is in the open position in <em>bkgndOff.bmp</em> but is closed in <em>bkgndOn.bmp</em>.</p>&#13;
<div class="image"><img alt="image" src="graphics/f12-05.jpg"/></div>&#13;
<p class="figcap"><a id="ch12fig5"/><em>Figure 12-5: The two background images of</em> SeriesCircuit.sb</p>&#13;
<p class="indent">When you start writing the code for this program, you’ll see many hard-coded numbers. These numbers represent the coordinate points for the text boxes and labels and for checking the switch’s boundaries. To help you understand where these numbers come from, refer to <a href="ch12.html#ch12fig6">Figure 12-6</a>. In this figure, we added coordinate axes and gridlines on top of the background image, and we marked the coordinates of all the points you’ll use in the program.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_173"/><img alt="image" src="graphics/f12-06.jpg"/></div>&#13;
<p class="figcap"><a id="ch12fig6"/><em>Figure 12-6: Illustrating the magic numbers used in</em> SeriesCircuit.sb</p>&#13;
<h4 class="h4" id="ch12lev2sec04"><em><strong>Step 2: Add the Main Code</strong></em></h4>&#13;
<p class="noindent">As in the previous examples, you’ll start by designing the user interface. You’ll write the code to load the background images, create and position the GUI elements (the text boxes), and then register the event handlers. Add the main part of the program, which is shown in <a href="ch12.html#ch12ex3">Listing 12-3</a>.</p>&#13;
<p class="programs"> 1 <span class="green"><span class="codeitalic">' SeriesCircuit_Incomplete.sb</span></span><br/> 2 offImg <span class="brown">=</span> <span class="blue1">ImageList</span><span class="brown">.LoadImage(</span><span class="blue1">Program</span><span class="brown">.Directory +</span> <span class="red">"\bkgndOff.bmp"</span><span class="brown">)</span><br/> 3 onImg <span class="brown">=</span> <span class="blue1">ImageList</span><span class="brown">.LoadImage(</span><span class="blue1">Program</span><span class="brown">.Directory +</span> <span class="red">"\bkgndOn.bmp"</span><span class="brown">)</span><br/> 4 bkgndImg <span class="brown">=</span> offImg   <span class="green"><span class="codeitalic">' Starts with the switch-off image</span></span><br/> 5<br/> 6 <span class="blue1">GraphicsWindow</span><span class="brown">.Width =</span> <span class="blue1">ImageList</span><span class="brown">.GetWidthOfImage(</span>offImg<span class="brown">)</span><br/> 7 <span class="blue1">GraphicsWindow</span><span class="brown">.Height =</span> <span class="blue1">ImageList</span><span class="brown">.GetHeightOfImage(</span>offImg<span class="brown">)</span><br/> 8 <span class="blue1">GraphicsWindow</span><span class="brown">.DrawImage(</span>bkgndImg<span class="brown">,</span> <span class="red">0</span><span class="brown">,</span> <span class="red">0</span><span class="brown">)</span><br/> 9<br/>10 r1Text <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.AddTextBox(</span><span class="red">130</span><span class="brown">,</span> <span class="red">140</span><span class="brown">)</span>  <span class="green"><span class="codeitalic">' R1 text box</span></span><br/>11 r2Text <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.AddTextBox(</span><span class="red">270</span><span class="brown">,</span> <span class="red">140</span><span class="brown">)</span>  <span class="green"><span class="codeitalic">' R2 text box</span></span><br/>12 r3Text <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.AddTextBox(</span><span class="red">308</span><span class="brown">,</span> <span class="red">208</span><span class="brown">)</span>  <span class="green"><span class="codeitalic">' R3 text box</span></span><br/>13 vText <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.AddTextBox(</span><span class="red">57</span><span class="brown">,</span> <span class="red">218</span><span class="brown">)</span>    <span class="green"><span class="codeitalic">' Voltage text box</span></span><br/>14 <span class="blue1">Controls</span><span class="brown">.SetSize(</span>r1Text<span class="brown">,</span> <span class="red">42</span><span class="brown">,</span> <span class="red">25</span><span class="brown">)</span>        <span class="green"><span class="codeitalic">' Resizes the text boxes</span></span><br/>15 <span class="blue1">Controls</span><span class="brown">.SetSize(</span>r2Text<span class="brown">,</span> <span class="red">42</span><span class="brown">,</span> <span class="red">25</span><span class="brown">)</span><br/>16 <span class="blue1">Controls</span><span class="brown">.SetSize(</span>r3Text<span class="brown">,</span> <span class="red">42</span><span class="brown">,</span> <span class="red">25</span><span class="brown">)</span><br/>17 <span class="blue1">Controls</span><span class="brown">.SetSize(</span>vText<span class="brown">,</span> <span class="red">48</span><span class="brown">,</span> <span class="red">25</span><span class="brown">)</span><br/>18 <span class="blue1">Controls</span><span class="brown">.SetTextBoxText(</span>vText<span class="brown">,</span> <span class="red">10</span><span class="brown">)</span>      <span class="green"><span class="codeitalic">' Sets the initial values</span></span><br/>19 <span class="blue1">Controls</span><span class="brown">.SetTextBoxText(</span>r1Text<span class="brown">,</span> <span class="red">4</span><span class="brown">)</span><br/>20 <span class="blue1">Controls</span><span class="brown">.SetTextBoxText(</span>r2Text<span class="brown">,</span> <span class="red">4</span><span class="brown">)</span><br/>21 <span class="blue1">Controls</span><span class="brown">.SetTextBoxText(</span>r3Text<span class="brown">,</span> <span class="red">2</span><span class="brown">)</span><br/>22<br/>23 <span class="blue1">GraphicsWindow</span><span class="brown">.MouseDown =</span> OnMouseDown<br/>24 <span class="blue1">Controls</span><span class="brown">.TextTyped =</span> OnTextTyped</p>&#13;
<p class="listcap"><a id="ch12ex3"/><em>Listing 12-3: Setting up the GUI</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_174"/>You start by loading the two background images and saving their identifiers in the <span class="literal">offImg</span> and <span class="literal">onImg</span> variables (line 2–3). The <span class="literal">bkgndImg</span> variable holds the current background image, which changes when a user clicks the switch. When the program starts, the switch is open, so the program sets <span class="literal">bkgndImg = offImg</span> (line 4). Lines 6–7 adjust the width and height of the graphics window to match the size of the background image, and line 8 draws the background image (<span class="literal">offImg</span> in this case) in the graphics window.</p>&#13;
<p class="indent">Lines 10–17 create the four text boxes (for the three resistors and the battery voltage) and resize them so they’re exactly on top of their positions in the background image. In lines 18–21, you set default values for these text boxes. In line 23, you register a handler for the <span class="literal">MouseDown</span> event, because you’ll want to know when a user clicks the switch. Line 24 registers a handler for the <span class="literal">TextTyped</span> event, because you’ll calculate and display the values of <span class="literal">I</span>, <span class="literal">V1</span>, <span class="literal">V2</span>, and <span class="literal">V3</span> automatically when the user enters a new value in any of the four text boxes.</p>&#13;
<h4 class="h4" id="ch12lev2sec05"><em><strong>Step 3: Toggle the Switch</strong></em></h4>&#13;
<p class="noindent">When a user clicks the switch, you need to change the background image to toggle the switch. Add the <span class="literal">OnMouseDown()</span> subroutine in <a href="ch12.html#ch12ex4">Listing 12-4</a>.</p>&#13;
<p class="programs"> 1 <span class="purple"><span class="codestrong">Sub</span></span> OnMouseDown <span class="green"><span class="codeitalic">' Switches the background image</span></span><br/> 2   x <span class="brown">=</span> <span class="blue1">GraphicsWindow</span><span class="brown">.MouseX</span><br/> 3   y <span class="brown">=</span> <span class="blue1">GraphicsWindow</span><span class="brown">.MouseY</span><br/> 4   <span class="purple"><span class="codestrong">If</span></span> <span class="brown">((</span>x <span class="brown">&gt;</span> <span class="red">185</span><span class="brown">) And (</span>x <span class="brown">&lt;</span> <span class="red">245</span><span class="brown">) And (</span>y <span class="brown">&gt;</span> <span class="red">300</span><span class="brown">) And (</span>y <span class="brown">&lt;</span> <span class="red">340</span><span class="brown">))</span> <span class="purple"><span class="codestrong">Then</span></span><br/> 5     <span class="purple"><span class="codestrong">If</span></span> <span class="brown">(</span>bkgndImg <span class="brown">=</span> offImg<span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span><br/> 6       bkgndImg <span class="brown">=</span> onImg<br/> 7     <span class="purple"><span class="codestrong">Else</span></span><br/> 8       bkgndImg <span class="brown">=</span> offImg<br/> 9     <span class="purple"><span class="codestrong">EndIf</span></span><br/>10     UpdateUserInterface<span class="brown">()</span><br/>11   <span class="purple"><span class="codestrong">EndIf</span></span><br/>12 <span class="purple"><span class="codestrong">EndSub</span></span></p>&#13;
<p class="listcap"><a id="ch12ex4"/><em>Listing 12-4: Changing the background image</em></p>&#13;
<p class="indent">The subroutine starts by getting the x- and y-coordinates of the point where the mouse was clicked and setting them to the variables <span class="literal">x</span> and <span class="literal">y</span> (lines 2–3). Line 4 then checks if this point lies within the rectangular region of the switch; if the mouse was inside the boundaries of the switch, the subroutine toggles the current value of the <span class="literal">bkgndImg</span> variable (from on to off or from off to on) at lines 5–9 and then calls the <span class="literal">UpdateUserInterface()</span> subroutine to switch the background image and update the calculated values (line 10). As you’ll see in a moment, if the user opens the switch, the program shows only the <span class="literal">offImg</span> background image; the values of <span class="literal">I</span>, <span class="literal">V1</span>, <span class="literal">V2</span>, and <span class="literal">V3</span> won’t show because no current’s flowing through the circuit when the switch is open.</p>&#13;
<h4 class="h4" id="ch12lev2sec06"><span epub:type="pagebreak" id="page_175"/><em><strong>Step 4: Respond to Changes</strong></em></h4>&#13;
<p class="noindent">Add the <span class="literal">OnTextTyped()</span> subroutine in <a href="ch12.html#ch12ex5">Listing 12-5</a>. This subroutine is called when the user enters a new value in any of the four text boxes. As you can see, this subroutine just calls <span class="literal">UpdateUserInterface()</span>, which updates the UI to show the current values of <span class="literal">V</span>, <span class="literal">R1</span>, <span class="literal">R2</span>, and <span class="literal">R3</span> as well as the state of the switch.</p>&#13;
<p class="programs">1 <span class="purple"><span class="codestrong">Sub</span></span> OnTextTyped<br/>2   UpdateUserInterface<span class="brown">()</span><br/>3 <span class="purple"><span class="codestrong">EndSub</span></span></p>&#13;
<p class="listcap"><a id="ch12ex5"/><em>Listing 12-5: The</em> <span class="literal"><span class="codeitalic">OnTextTyped()</span></span> <em>subroutine</em></p>&#13;
<h4 class="h4" id="ch12lev2sec07"><em><strong>Step 5: Update the Program’s Interface</strong></em></h4>&#13;
<p class="noindent">Now add the <span class="literal">UpdateUserInterface()</span> subroutine in <a href="ch12.html#ch12ex6">Listing 12-6</a>.</p>&#13;
<p class="programs"> 1 <span class="purple"><span class="codestrong">Sub</span></span> UpdateUserInterface   <span class="green"><span class="codeitalic">' Puts new values on the background</span></span><br/> 2   <span class="blue1">GraphicsWindow</span><span class="brown">.DrawImage(</span>bkgndImg<span class="brown">,</span> <span class="red">0</span><span class="brown">,</span> <span class="red">0</span><span class="brown">)</span><br/> 3   <span class="purple"><span class="codestrong">If</span></span> <span class="brown">(</span>bkgndImg <span class="brown">=</span> onImg<span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span><br/> 4     R1 <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.GetTextBoxText(</span>r1Text<span class="brown">)</span><br/> 5     R2 <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.GetTextBoxText(</span>r2Text<span class="brown">)</span><br/> 6     R3 <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.GetTextBoxText(</span>r3Text<span class="brown">)</span><br/> 7     V <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.GetTextBoxText(</span>vText<span class="brown">)</span><br/> 8     Rtot <span class="brown">=</span> R1 <span class="brown">+</span> R2 <span class="brown">+</span> R3<br/> 9     <span class="purple"><span class="codestrong">If</span></span> <span class="brown">(</span>Rtot <span class="brown">&gt;</span> <span class="red">0</span><span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span><br/>10       I <span class="brown">=</span> V <span class="brown">/</span> Rtot<br/>11       V1 <span class="brown">=</span> <span class="blue1">Math</span><span class="brown">.Round(</span>I <span class="brown">*</span> R1 <span class="brown">*</span> <span class="red">100</span><span class="brown">) /</span> <span class="red">100</span><br/>12       V2 <span class="brown">=</span> <span class="blue1">Math</span><span class="brown">.Round(</span>I <span class="brown">*</span> R2 <span class="brown">*</span> <span class="red">100</span><span class="brown">) /</span> <span class="red">100</span><br/>13       V3 <span class="brown">=</span> <span class="blue1">Math</span><span class="brown">.Round(</span>I <span class="brown">*</span> R3 <span class="brown">*</span> <span class="red">100</span><span class="brown">) /</span> <span class="red">100</span><br/>14       I <span class="brown">=</span> <span class="blue1">Math</span><span class="brown">.Round(</span>I <span class="brown">*</span> <span class="red">100</span><span class="brown">) /</span> <span class="red">100</span><br/>15       <span class="blue1">GraphicsWindow</span><span class="brown">.DrawText(</span><span class="red">130</span><span class="brown">,</span> <span class="red">80</span><span class="brown">,</span> V1 <span class="brown">+</span> <span class="red">" V"</span><span class="brown">)</span><br/>16       <span class="blue1">GraphicsWindow</span><span class="brown">.DrawText(</span><span class="red">270</span><span class="brown">,</span> <span class="red">80</span><span class="brown">,</span> V2 <span class="brown">+</span> <span class="red">" V"</span><span class="brown">)</span><br/>17       <span class="blue1">GraphicsWindow</span><span class="brown">.DrawText(</span><span class="red">415</span><span class="brown">,</span> <span class="red">230</span><span class="brown">,</span> V3 <span class="brown">+</span> <span class="red">" V"</span><span class="brown">)</span><br/>18       <span class="blue1">GraphicsWindow</span><span class="brown">.DrawText(</span><span class="red">34</span><span class="brown">,</span> <span class="red">100</span><span class="brown">,</span> I <span class="brown">+</span> <span class="red">" A"</span><span class="brown">)</span><br/>19     <span class="purple"><span class="codestrong">EndIf</span></span><br/>20   <span class="purple"><span class="codestrong">EndIf</span></span><br/>21 <span class="purple"><span class="codestrong">EndSub</span></span></p>&#13;
<p class="listcap"><a id="ch12ex6"/><em>Listing 12-6: Updating the text boxes</em></p>&#13;
<p class="indent">The <span class="literal">UpdateUserInterface()</span> subroutine starts by redrawing the selected background image. If the switch is in the off position, the <span class="literal">If</span> statement on line 3 is false and the subroutine ends; the UI doesn’t show any of the computed values (because no current is flowing through the circuit). But if the switch is on (which means the current background image is set to <span class="literal">onImg</span>), the subroutine moves on to compute the values of <span class="literal">I</span>, <span class="literal">V1</span>, <span class="literal">V2</span>, and <span class="literal">V3</span>. It starts by collecting the content of the four text boxes (lines 4–7). It then computes the total resistance by adding the values <span class="literal">R1</span>, <span class="literal">R2</span>, and <span class="literal">R3</span> together <span epub:type="pagebreak" id="page_176"/>(line 8). If the total resistance is greater than 0 (line 9), the subroutine computes the current (<span class="literal">I</span>) that flows through the circuit (line 10) and the values of <span class="literal">V1</span>, <span class="literal">V2</span>, and <span class="literal">V3</span>, rounding each value to the nearest hundredth (lines 11–14). The subroutine then shows the computed values at the correct locations on top of the background image (lines 15–18).</p>&#13;
<p class="indent">Most of the work in this program was designing the GUI (drawing the background images and positioning the text boxes on top of the background image). Then you had to write the code for handling the events, performing the calculations, and displaying the results. Congratulations; you just made a virtual electrical circuit!</p>&#13;
<p class="indent">In the next section, you’ll write a GUI program that explains another object in the Small Basic library, the <span class="literal">Flickr</span> object.</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch12sb03"><strong>TRY IT OUT 12-3</strong></p>&#13;
<p class="noindent">Think of ways to change this simulation to something else. Use different background images, like architectural blueprints, a pizza, or a Google Maps photo of your neighborhood. Then update the placement of the text boxes and the logic/math of what’s entered to match your new theme. Head to <em><a href="http://tiny.cc/sharesimulation/">http://tiny.cc/sharesimulation/</a></em> to show off your program and to see what others have created.</p>&#13;
</div>&#13;
<h3 class="h3" id="ch12lev1sec04"><span class="blue"><strong>Program Your Own Image Viewer</strong></span></h3>&#13;
<p class="noindent">In this section, you’ll create an image viewer called <em>ImageViewer.sb</em> that displays images from Flickr (a photo-sharing website) based on search input from a user. Small Basic gives you an object, appropriately named <span class="literal">Flickr</span>, which gets images from the Flickr website: <em><a href="http://www.flickr.com/">http://www.flickr.com/</a></em>. <a href="ch12.html#ch12fig7">Figure 12-7</a> shows the GUI for this program.</p>&#13;
<div class="image"><img alt="image" src="graphics/f12-07.jpg"/></div>&#13;
<p class="figcap"><a id="ch12fig7"/><em>Figure 12-7: Sample output of</em> ImageViewer.sb</p>&#13;
<div class="note">&#13;
<p class="notet"><span epub:type="pagebreak" id="page_177"/><span class="notes"><strong>NOTE</strong></span></p>&#13;
<p class="notep"><em>You’ll need Small Basic version 1.1 or later to use the</em> <span class="literal"><span class="codeitalic">Flickr</span></span> <em>object.</em></p>&#13;
</div>&#13;
<p class="indent">The <em>ImageViewer.sb</em> program includes a text box into which the user enters the search tag and a button (labeled Next). When the user clicks the button, the program uses the <span class="literal">Flickr</span> object to get (and display) an image that matches the user’s search tag. The program is shown in <a href="ch12.html#ch12ex7">Listing 12-7</a>.</p>&#13;
<p class="programs"> 1 <span class="green"><span class="codeitalic">' ImageViewer.sb</span></span><br/> 2 <span class="blue1">GraphicsWindow</span><span class="brown">.DrawText(</span><span class="red">10</span><span class="brown">,</span> <span class="red">14</span><span class="brown">,</span> <span class="red">"Search for an image:"</span><span class="brown">)</span><br/> 3 tagText <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.AddTextBox(</span><span class="red">140</span><span class="brown">,</span> <span class="red">10</span><span class="brown">)</span><br/> 4 <span class="blue1">Controls</span><span class="brown">.SetSize(</span>tagText<span class="brown">,</span> <span class="red">160</span><span class="brown">,</span> <span class="red">26</span><span class="brown">)</span><br/> 5 <span class="blue1">Controls</span><span class="brown">.AddButton(</span><span class="red">"Next"</span><span class="brown">,</span> <span class="red">305</span><span class="brown">,</span> <span class="red">10</span><span class="brown">)</span><br/> 6<br/> 7 <span class="blue1">Controls</span><span class="brown">.ButtonClicked =</span> OnButtonClicked<br/> 8<br/> 9 <span class="purple"><span class="codestrong">Sub</span></span> OnButtonClicked<br/>10   tag <span class="brown">=</span> <span class="blue1">Controls</span><span class="brown">.GetTextBoxText(</span>tagText<span class="brown">)</span><br/>11   <span class="purple"><span class="codestrong">If</span></span> <span class="brown">(</span>tag <span class="brown">&lt;&gt;</span> <span class="red">""</span><span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span><br/>12     img <span class="brown">=</span> <span class="blue1">ImageList</span><span class="brown">.LoadImage(</span><span class="blue1">Flickr</span><span class="brown">.GetRandomPicture(</span>tag<span class="brown">))</span><br/>13     <span class="purple"><span class="codestrong">If</span></span> <span class="brown">(</span>img <span class="brown">=</span> <span class="red">""</span><span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span><br/>14       <span class="blue1">GraphicsWindow</span><span class="brown">.ShowMessage(</span><span class="red">"No images found."</span><span class="brown">,</span> <span class="red">"Sorry."</span><span class="brown">)</span><br/>15     <span class="purple"><span class="codestrong">Else</span></span><br/>16       <span class="blue1">GraphicsWindow</span><span class="brown">.Width =</span> <span class="blue1">ImageList</span><span class="brown">.GetWidthOfImage(</span>img<span class="brown">)</span><br/>17       <span class="blue1">GraphicsWindow</span><span class="brown">.Height =</span> <span class="blue1">ImageList</span><span class="brown">.GetHeightOfImage(</span>img<span class="brown">) +</span> <span class="red">40</span><br/>18       <span class="blue1">GraphicsWindow</span><span class="brown">.DrawImage(</span>img<span class="brown">,</span> <span class="red">0</span><span class="brown">,</span> <span class="red">40</span><span class="brown">)</span><br/>19     <span class="purple"><span class="codestrong">EndIf</span></span><br/>20   <span class="purple"><span class="codestrong">EndIf</span></span><br/>21 <span class="purple"><span class="codestrong">EndSub</span></span></p>&#13;
<p class="listcap"><a id="ch12ex7"/><em>Listing 12-7: Loading images from Flickr</em></p>&#13;
<p class="indent">The program starts by designing the GUI (lines 2–5) and registering the <span class="literal">ButtonClicked</span> event handler (line 7). When the button is clicked, the <span class="literal">OnButtonClicked()</span> subroutine gets the search text from the text box and saves it in the <span class="literal">tag</span> variable (line 10). If <span class="literal">tag</span> isn’t empty (line 11), the code searches Flickr using the given <span class="literal">tag</span> text for a random picture and then grabs the URL (line 12) by using <span class="literal">Flickr.GetRandomPicture()</span>.</p>&#13;
<p class="indent">That URL is passed to <span class="literal">ImageList.LoadImage()</span>, which loads an image from a file or the Internet and saves it into the <span class="literal">img</span> variable (line 12). If <span class="literal">img</span> is empty, which means Flickr didn’t find an image with the user’s tag, you let the user know in a message box (line 14). If Flickr found an image, you resize the graphics window to the dimensions of the loaded image (lines 16–17) and draw the image directly below the text box and the button (line 18).</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch12sb04"><span epub:type="pagebreak" id="page_178"/><strong>TRY IT OUT 12-4</strong></p>&#13;
<p class="noindent">Write a program to ask the user what their favorite animal is. Then search for that animal using the <span class="literal">Flickr</span> object and display the returned image. Next, ask the user, “Like this one?” and show them two buttons labeled Yes and No. If the user clicks Yes, display <em>Hooray!</em> in a message box. If they click No, display a different random picture of that animal and ask, “How about this one?” Continue these steps until the user clicks Yes. You’ve just turned a simple program into a game!</p>&#13;
</div>&#13;
<h3 class="h3a" id="ch12lev1sec05"><span class="blues"><strong>Programming Challenges</strong></span></h3>&#13;
<p class="noindent">If you get stuck, check out <em><a href="http://nostarch.com/smallbasic/">http://nostarch.com/smallbasic/</a></em> for the solutions and for more resources and review questions for teachers and students.</p>&#13;
<ol>&#13;
<li><p class="noindenta">In this program, you’ll create a hidden treasure game. Open the file <em>HiddenTreasure_Incomplete.sb</em> from this chapter’s folder. When you run the program, you’ll see the following interface.</p>&#13;
<div class="image1"><img alt="image" src="graphics/f0178-01.jpg"/></div>&#13;
<p class="indent">The purpose of the game is to guess the location of a hidden treasure. The player makes a guess by pressing one of the four buttons. If they guess correctly, they gain $10. Otherwise, they lose $5. The game ends after 10 rounds. Follow the comments shown in the program’s source code to write the missing code and complete the program.</p></li>&#13;
<li><span epub:type="pagebreak" id="page_179"/><p class="noindenta">In this exercise, you’ll create a program that computes the total cost of attending a special show at Sea World. Open the file <em>SeaWorld_Incomplete.sb</em> from this chapter’s folder. When you run the program, you’ll see the following user interface. The user enters the number of adult, senior, student, and VIP tickets they want to buy and then clicks the Compute button to calculate the total charge. Complete the program to display the total charge when the user clicks Compute.</p>&#13;
<div class="image1"><img alt="image" src="graphics/f0179-01.jpg"/></div><span epub:type="pagebreak" id="page_180"/></li>&#13;
</ol>&#13;
</body></html>