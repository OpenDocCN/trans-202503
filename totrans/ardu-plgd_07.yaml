- en: '**6'
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**6**'
- en: THE BATTERY SAVER**
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '**电池保护器**'
- en: '![image](../images/common-01.jpg)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/common-01.jpg)'
- en: This project was actually born back in the 1970s, when I built a very similar
    device for the first time. Its purpose is to disconnect a vehicle’s battery when
    an inadvertent drain would discharge the battery to the point where the vehicle
    would not start. Before the advent of computerized automobiles, it was common
    for drivers to park and leave the lights turned on only to come back to find a
    dead battery. Then, they had to find a way to call a service station (cell phones
    weren’t available) and get a boost. Worse, if the battery died and the car was
    left sitting long enough, the battery would become useless and have to be replaced.
    After remaining in a discharged state between 12 and 18 hours, most lead-acid
    batteries would go totally dead and could not be rejuvenated.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 这个项目实际上起源于1970年代，当时我第一次制作了一个非常类似的装置。其目的是在电池因不经意的电量消耗而导致车辆无法启动时，切断车辆的电池。在计算机化汽车出现之前，驾驶员常常会停车并忘记关灯，结果回来时发现电池没电。那时，他们必须找到办法呼叫服务站（因为没有手机），并启动电池。更糟的是，如果电池死掉且车辆放置时间过长，电池就会变得无法使用，必须更换。在12到18小时之间处于放电状态后，大多数铅酸电池会完全放电，无法恢复。
- en: But that was then. Now, many vehicles—particularly those equipped with automatic
    lighting systems—protect against such inconveniences with automatic (often delayed)
    shutoff for electrical systems. However, several types of vehicles still don’t
    have automatic shutdown systems or alarms to warn you that the lights are on.
    This project, shown in [Figure 6-1](ch06.xhtml#ch06fig1), is particularly useful
    for those vehicles.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 但那是过去的事了。现在，许多车辆，尤其是配备了自动照明系统的车辆，已经通过自动（通常是延迟）断电功能来防止这种不便情况的发生。然而，仍有几种类型的车辆没有自动关机系统或报警装置来提醒你灯光还开着。这个项目，如[图6-1](ch06.xhtml#ch06fig1)所示，对于这些车辆特别有用。
- en: '![image](../images/f06-01.jpg)'
  id: totrans-5
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f06-01.jpg)'
- en: '*Figure 6-1: The finished Battery Saver, boxed and ready to go (top), as well
    as a look inside (bottom)*'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '*图6-1：完成的电池保护器，包装好准备使用（上），以及内部构造（下）*'
- en: '**Boats, Tractors, and Other Vehicles**'
  id: totrans-7
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**船只、拖拉机和其他车辆**'
- en: Many road-worthy vehicles could benefit from the Battery Saver, but this project
    is targeted at other systems where an accidental discharge of a battery could
    be annoying—and expensive. Boats are particularly vulnerable. Even my small runabout
    has experienced problems. On more than one occasion, the running lights were left
    on during the day, and I did not notice until a couple of days later. The battery
    was totally dead, and it had to be replaced.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 许多适合上路的车辆都能从电池保护器中受益，但这个项目主要面向那些电池意外放电可能带来麻烦且昂贵的系统。船只尤为容易受到影响。即使是我的小型跑船也遇到过类似问题。曾多次在白天忘记关掉导航灯，直到几天后才发现。电池完全没电，必须更换。
- en: Leaving the running lights on isn’t the only way to accidentally drain a boat
    battery. Most inboard boats have a blower system designed to safely expel potentially
    explosive gases and fuel vapors from the bilge. Conventional wisdom (and the Coast
    Guard) says to keep the bilge blowers on before starting the engines, the entire
    time the boat is in service, and for at least 10 minutes after shutdown. It’s
    very easy to forget the blowers are on and then find you need to replace the battery
    or batteries the next time you use the boat.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 留下导航灯开着并不是唯一一种会意外耗尽船只电池的方式。大多数内舱船只都配备有排气系统，用于安全地排出可能爆炸的气体和燃油蒸气。常识（以及海岸警卫队）建议，在启动引擎前保持排气扇运转，船只运行时一直开着，并且至少在关闭引擎后再运行10分钟。很容易忘记排气扇还在开着，结果下次使用船只时发现需要更换电池。
- en: '**NOTE**'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*Before building the Battery Saver for a safety system like the blowers on
    a boat, read “[Notes of Caution](ch06.xhtml#ch06note1)” on [page 158](ch02.xhtml#page_58).
    There are some considerations to keep in mind that may require some minor wiring
    changes to the electrical system*.'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '*在为像船只排气扇这样的安全系统构建电池保护器之前，请阅读[《注意事项》](ch06.xhtml#ch06note1)中的内容，见[第158页](ch02.xhtml#page_58)。有一些需要注意的事项，可能会要求对电气系统做一些小的布线更改*。'
- en: 'Boats aren’t the only vulnerable vehicles, though. Riding mowers and tractors
    are also at risk for three reasons:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 船只并不是唯一易受影响的车辆。骑行割草机和拖拉机也有三种原因容易面临风险：
- en: • They are usually used only intermittently.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: • 它们通常只是间歇性使用。
- en: • Parking and/or headlight switches are often placed where it’s easy to accidentally
    bump them when getting on or off the vehicle. The switches can also be damaged
    by flying debris or rough terrain.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
- en: • They are usually used in daylight hours, so it can be hard to tell when the
    lights are on.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
- en: The Battery Saver can also protect powered tools, like tow-behind sprayers.
    It’s easy to leave these tools turned on when finished, and while most sprayer
    pumps don’t take too much current, leaving one on for, say, a day or two, will
    likely drain the battery.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
- en: '**Required Tools**'
  id: totrans-17
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Drill and drill bits
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
- en: Center punch
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
- en: 4-40 tap
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
- en: Hacksaw
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
- en: 400-grit sandpaper
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
- en: Countersink (Almost any 82° countersink will do. The material being formed is
    relatively soft, so no special materials are required.)
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
- en: Needle files (See [Figure 6-20](ch06.xhtml#ch06fig20). While only one is required,
    they usually come in sets.)
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
- en: Triangle file
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
- en: '**NOTES OF CAUTION**'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: If you create the Battery Saver as described in this chapter, it should work
    well. However, it is always possible for Murphy’s Law to cause a problem, so here
    are a few points to consider before you build.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
- en: Should the Battery Saver fail, it can be reset, but in the meantime, it will
    remove all power to the vehicle’s electrical system. *Do not* use the Battery
    Saver on any system where an electrical failure could cause catastrophic problems
    (such as on an aircraft) or result in bodily harm or property damage. That said,
    I have used the following unit in a car, on three agricultural tractors, and on
    two boats for well over a year (and earlier versions for several years) with no
    failures.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
- en: The Battery Saver includes a very high-current switch. It is possible that,
    under certain conditions, a resistance could develop such that when current is
    applied, the switch becomes extremely hot—perhaps hot enough to be a fire hazard.
    (For what it’s worth, this has never happened even on prototype versions.) All
    efforts have been made to eliminate problems like this—for example, the block
    that holds the Battery Saver’s copper contacts is made of a fire- and melt-resistant
    phenolic material—but overheating remains a hazard. Always check the heat of the
    Battery Saver before you touch it to make certain that it is not hot enough to
    burn you. Even the reset plunger could become warm enough to burn if the vehicle
    or Battery Saver malfunctions.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
- en: This last warning is specific to mariners. If you keep your boat in the water,
    chances are it has a built-in bilge pump and automatic float switch to keep it
    afloat when you’re not aboard. If you have multiple batteries, make sure the bilge
    pump is wired to a battery that isn’t in the circuit with the Battery Saver, as
    in [Figure 6-2](ch06.xhtml#ch06fig2). Otherwise, find the wire that provides current
    to the bilge pump/switch, and simply bypass the Battery Saver.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-02.jpg)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-2: Wiring the Battery Saver on a boat*'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: '**Parts List**'
  id: totrans-33
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: This parts list might look somewhat like a scavenger hunt, but everything can
    be found easily from a variety of sources. Getting the particular size or quantity,
    however, may be challenging, so read the list carefully to make sure you have
    everything before you start. And before shopping, look ahead to [Figure 6-13](ch06.xhtml#ch06fig13)
    on [page 170](ch06.xhtml#page_170) to see some of the more unusual parts, like
    the copper contacts.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: One Deek-Robot Pro Mini Arduino clone microcontroller board (There are several
    available, and some have different pinouts—particularly for pins A4 and A5.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
- en: '[Figure 6-3](ch06.xhtml#ch06fig3) shows the pinout for the one I used. Other
    units with different pinouts should work, but the connections on the shield must
    be changed.)'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
- en: One LM7805 voltage regulator
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
- en: 12V solenoid (This project uses an Electronic Goldmine G19852.)
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
- en: One 10-kilohm resistor
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
- en: One 5.6-kilohm resistor
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
- en: One 4.7-kilohm resistor
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
- en: One 470-ohm resistor
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
- en: One 4.7V Zener diode
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
- en: One 1N4002 diode or equivalent
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
- en: Two ZTX649 transistors
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
- en: One 1/2-inch phenolic sheet
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
- en: One 6×3/4×3/16–inch copper bar, which is part of a high-current switch (This
    is actually a piece of copper bus bar that is generally used in large electrical
    installations. See [Figure 6-4](ch06.xhtml#ch06fig4) for an example. To find this,
    you may need to do a little digging with an online search for *copper bus bar*.
    I bought a piece that was 3 feet long.)
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-03.jpg)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-3: Pinout of the Deek-Robot Pro Mini Arduino clone*'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-04.jpg)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-4: A copper bus bar, drilled out for the Battery Saver*'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
- en: One ABS plastic enclosure, like the Hammond 1591 STCL
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
- en: Two 1/4-inch brass rounds (You’ll use one of these as the pylon.)
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
- en: A small piece of sheet metal to use as the release
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
- en: One e-clip
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
- en: Four 1/2-inch, 4-40 flathead screws
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
- en: One 3/8-inch, 4-40 roundhead screw
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
- en: 3 oz of Permatex Silicone RTV sealant
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
- en: One matching pair of inline connectors (You can buy simple, cheap, inline connectors
    online, or you can make your own. I used Pololu’s 1×2 connector housing and male
    and female crimp pins, shown in [Figure 6-5](ch06.xhtml#ch06fig5). See “[Connectors
    Used in This Book](ch00.xhtml#ch00lev1sec6)” on [page 18](ch00.xhtml#page_18)
    for crimping techniques. You can also use telephone-style chicklets if you can
    find them.)
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-05.jpg)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-5: A pair of mating connectors used to connect the solenoid*'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
- en: 28-gauge hookup wire
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
- en: One solder lug (If you can’t find one, you can work around it by taking the
    power wire from the Arduino and wrapping it under the head of the screw, as shown
    in [Figure 6-7](ch06.xhtml#ch06fig7).)
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
- en: One battery cable to fit your storage battery on one side and a lug to attach
    to the Battery Saver on the other
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
- en: '**Downloads**'
  id: totrans-65
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Sketch**   *BatterySaver.ino*'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
- en: '**Templates**   *ReleaseLever.pdf, BatterySaverEnclosure.pdf*'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
- en: '**Shield**   *BatterySaver.pcb*'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
- en: '**The Schematic**'
  id: totrans-69
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: While the circuit is relatively simple, as shown in [Figure 6-6](ch06.xhtml#ch06fig6),
    there are a couple of key design elements to be aware of.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-06.jpg)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-6: Schematic for the Battery Saver*'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
- en: Notice that the circuit uses an LM7805 voltage regulator. In theory, the small
    regulator included in the Pro Mini board would be more than satisfactory because
    the load is relatively light. But under the hood of a car and around high-current
    systems and high-voltage electronics, there is a lot of stray electromagnetic
    energy bouncing around. While it’s improbable that this energy would cause a problem
    for the Battery Saver, it is well within the realm of possibility. The more robust
    1.5 A LM7805 regulator offers the Pro Mini another level of protection. In addition,
    capacitors C1 and C2 have been included to bypass any AC sneaking into the circuit
    and to prevent unwanted oscillation. Similarly, the 4.7V Zener diode (D1) protects
    the input of the Arduino from a voltage spike—which is very likely—on the 12V
    supply. It limits the voltage to A0 to only 4.7V.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
- en: The configuration of resistors R1 and R2 may look familiar from other projects.
    They comprise a voltage divider to lower the 12V supply to a level below the 5V
    maximum the Arduino input can tolerate. To be on the safe side, I selected a value
    of 10 kilohms for R1 and 5.6 kilohms for R2\. Both are standard values. This design
    should allow the battery voltage to jump to 14V before reaching the point where
    the Zener diode kicks in.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
- en: 'Diode D2 (1N4002 or equivalent) provides yet another level of defense: it protects
    against an inverse current that could be created when the magnetic field in the
    solenoid collapses. This is a standard protection device in inductors with an
    iron core, which can store magnetic energy and release it rapidly into the coil.
    The reverse voltage can reach relatively high levels and create significant currents,
    which could, in this case, damage the driver transistor and other components in
    the system.'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
- en: Transistors Q1 and Q2 are both ZTX649 silicon NPN transistors. I chose these
    transistors because they have sufficient drive capability and are inexpensive
    and readily available. I used the same model as in other projects. The high side
    of Q2 is brought to the red positive rail (VCC), as the LM7805 regulator supplies
    plenty of current. (You could just as easily connect the high side, or collector,
    of Q2 to the 12V supply, because Q2 is wired as an emitter follower and the voltage
    at the emitter will follow only the voltage at the base.) R4, a 470-ohm resistor,
    limits the current to LED 1.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
- en: LED1 indicates when the unit is operating. The circuit containing Q2 and LED1
    provides a blinking LED with a very short on cycle, which is consistent with this
    volume’s goal of blinking LEDs as often as possible.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
- en: '**NOTE**'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
- en: '*The Deek-Robot Pro Mini also has a red LED that indicates when it is turned
    on. This additional, although very small, constant current drain could contribute
    to the discharge of the battery. In the units that I installed, I unsoldered one
    end of the Pro Mini’s LED, which is kind of a delicate operation*.'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
- en: Transistor Q1, wired as a common emitter circuit, provides the drive for the
    solenoid. Resistor R3 (4.7 kilohms) drives the transistor and also protects it—a
    direct connection would allow too much current to flow in the base-emitter junction,
    resulting in potential damage. The high side of the solenoid is connected to positive
    12V to allow maximum voltage and current to flow through the solenoid coil without
    taxing the voltage regulator.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
- en: '***How the Battery Saver Prevents Draining***'
  id: totrans-81
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The Battery Saver comprises a very high-current switch that can be electrically
    turned off and a sensor circuit to detect when the battery is in jeopardy of dying.
    The high-current switch is required because it interrupts the main power from
    the battery, which includes the feed to a starter motor that can draw up to several
    hundred amps.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
- en: 'The high-current switch—which could also be considered a relay—is made of the
    three pieces of copper bus bar: a release bar, a solenoid, and a release lever.
    When the pieces of copper bus bar are connected, the battery is connected to its
    circuit as normal. When the solenoid is pulled in, the power is disconnected.'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
- en: The sensor circuit uses the power of the Arduino microcontroller. The Arduino
    continually monitors the battery, and if it senses that the power is diminishing,
    it calls for the high-current switch (relay) to be thrown. There are many ways
    to determine when a battery is reaching exhaustion, and this project simply looks
    at the voltage left in the battery. [Table 6-1](ch06.xhtml#ch06tab1) shows the
    voltage versus the remaining charge in a standard 12V, lead-acid storage battery.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
- en: '**Table 6-1:** Battery Charge State Versus Voltage'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
- en: '| **Battery charge level** | **Battery voltage** |'
  id: totrans-86
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-87
  prefs: []
  type: TYPE_TB
- en: '| 100% | 12.7V |'
  id: totrans-88
  prefs: []
  type: TYPE_TB
- en: '| 90% | 12.5V |'
  id: totrans-89
  prefs: []
  type: TYPE_TB
- en: '| 80% | 12.4V |'
  id: totrans-90
  prefs: []
  type: TYPE_TB
- en: '| 70% | 12.3V |'
  id: totrans-91
  prefs: []
  type: TYPE_TB
- en: '| 60% | 12.2V |'
  id: totrans-92
  prefs: []
  type: TYPE_TB
- en: '| 50% | 12.1V |'
  id: totrans-93
  prefs: []
  type: TYPE_TB
- en: '| 40% | 11.9V |'
  id: totrans-94
  prefs: []
  type: TYPE_TB
- en: '| 30% | 11.8V |'
  id: totrans-95
  prefs: []
  type: TYPE_TB
- en: '| 20% | 11.6V |'
  id: totrans-96
  prefs: []
  type: TYPE_TB
- en: '| <10% | 11.3V |'
  id: totrans-97
  prefs: []
  type: TYPE_TB
- en: The battery charge level quickly deteriorates with only a minimal reduction
    in voltage. In order to have at least 40 to 50 percent of the charge remaining,
    the drain on the battery must be stopped somewhere between 11.9V and 12.2V (shaded
    in [Table 6-1](ch06.xhtml#ch06tab1)), a voltage I will refer to from now on as
    the *trigger point*. In practical applications, empirical evidence shows that
    there is still plenty of juice left, even when battery voltage drops to 12.0V,
    11.90V, or even below. A battery in good condition under ideal circumstances could
    perform with perhaps as little as 30 percent of its capacity, but that would depend
    on the load, ambient temperature, and other factors, so I’m taking a very conservative
    view of about 12+V. Newer design batteries tend to do better.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
- en: While the state of charge is a good indication of remaining capacity in a battery,
    other factors—like internal resistance, battery discharge rate, and so on—could
    impact the usable state of charge remaining in a battery. A more accurate measurement
    of the capacity remaining in a fully charged battery might be current used, which
    can be calculated if the total energy in the battery is known. For example, if
    a battery has a capacity of 1,100 ampere-hours (A·h), you could calculate the
    point where 550 A·h remain and disconnect the battery then. However, because this
    project targets systems with batteries that range widely in capacity, I decided
    that measuring the battery voltage would be more than adequate.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
- en: '***Arduino to the Rescue***'
  id: totrans-100
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The Arduino microcontroller steps up to the task of measuring the battery voltage
    and throwing the disconnect switch at the appropriate voltage, but if that’s all
    it did, you could be in trouble. When turning on a vehicle, the starting motor
    uses a lot of current. Depending on the state of the battery (internal resistance
    and so on) and ambient conditions (temperature, for example) during the cranking
    process, the battery voltage can conceivably fall well below the critical shut-off
    voltage. The Battery Saver depends on the Arduino to give the vehicle enough time
    to start the motor.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
- en: Further, should the system shut down due to an inadvertent drain, you’ll need
    to ensure that when the Battery Saver is reset, it doesn’t immediately sense a
    critical battery voltage and shut down again. All of these functions are handled
    by the microcontroller, under orders from the sketch. While there are probably
    several different ways of handling it, the sketch implements *timing sequences*—rules
    to follow for when to take certain actions—to allow for the voltage drop during
    engine cranking. Similar timing rules give the user time to restart the engine
    after the Battery Saver is reset.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
- en: '**The Breadboard**'
  id: totrans-103
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Even though this project doesn’t require a lot of extra components and peripheral
    equipment, I still believe it’s useful to go through the exercise of wiring a
    breadboard. A working prototype gives a definitive proof of concept, and it allows
    you to play with the hardware and software prior to committing to the finished
    version. When working with the breadboard, I tested the circuit with a solenoid
    similar to the one used in the finished product (see [Figure 6-7](ch06.xhtml#ch06fig7)).
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-07.jpg)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-7: The breadboard I used to test the Battery Saver concept and put
    the software together. Testing your circuit with a solenoid is not required*.'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
- en: '[Figure 6-8](ch06.xhtml#ch06fig8) shows the breadboard operating the high-current
    switch; “[Construction](ch06.xhtml#ch06lev1sec9)” on [page 170](ch06.xhtml#page_170)
    describes how to build that switch. To test the circuit without making the high-current
    switch first, or to use a solenoid by itself (see [Figure 6-7](ch06.xhtml#ch06fig7)),
    you can connect a lamp, LED, relay, or some other component in place of the switch.
    Remember: if you use an LED or other polarized device, make certain to get the
    polarity correct.'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-08.jpg)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-8: The breadboard circuit operating the solenoid after the high-current
    switch has been assembled. Note the use of clip leads to hook up the Battery Saver
    to the breadboard. Diodes D1 and D2 and capacitors C1 and C2 were not included
    in the breadboard primarily because they are needed only when the project is in
    use*.'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
- en: 'The basic breadboard is fairly straightforward. Just follow these instructions
    to assemble it:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
- en: Connect the breadboard’s red positive rails together, and connect the blue negative
    rails together. Do not connect the positive rails to the negative rails as that
    will result in a direct short circuit.
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Insert the LM7805 voltage regulator so that the three terminals span three different
    rows. (See “[The Schematic](ch06.xhtml#ch06lev1sec5)” on [page 160](ch06.xhtml#page_160)
    for why an external voltage regulator was used rather than the Pro Mini’s onboard
    regulator.)
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Connect the input of the regulator to a positive 12V source. (See [Figure 6-9](ch06.xhtml#ch06fig9)
    for the pinout of the LM7805.)
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![image](../images/f06-09.jpg)'
  id: totrans-114
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: '*Figure 6-9: Pinout of the LM7805 regulator*'
  id: totrans-115
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Connect the center pin of the regulator to blue negative rail and the output
    pin to the red positive rail. When you power the circuit, the positive rail should
    have 5V coming from the output of the regulator.
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Insert the Pro Mini microcontroller board in the breadboard. Its position is
    not critical; anywhere in the general vicinity of where it is in [Figure 6-7](ch06.xhtml#ch06fig7)
    is fine.
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Insert resistors R1 (10 kilohm) and R2 (5.6 kilohm) into the breadboard. It’s
    easiest to insert them near the regulator. Then, connect one side of R1 directly
    to the regulator (input pin). The joining point of R1 and R2 should be located
    in an independent place on the board, and the other side of R2 goes directly to
    ground.
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Connect a jumper from the point where R1 and R2 join to pin A0 of the Pro Mini.
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Insert transistor Q1 (ZTX649) into the breadboard in an area with three open
    rows (see [Figure 6-10](ch06.xhtml#ch06fig10) for the pinout).
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Connect resistor R3 from the base of Q1 to pin D9 of the Pro Mini.
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Connect the emitter of Q1 to ground.
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Connect the collector of Q1 to the load (solenoid or other).
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Connect the other side of the load to positive 12V.
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Insert transistor Q2 into the breadboard. Connect its collector to one of the
    red positive rails.
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Connect the base of Q2 to pin D12 of the Pro Mini.
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Connect the emitter of Q2 to the positive side of LED1.
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Connect the negative side of LED1 to R4 (470 ohms).
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Connect the other end of R4 directly to the blue negative rail.
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Connect the negative side of the 12V supply to the blue negative rail.
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now, load the sketch onto the Pro Mini (see “[Connecting and Programming an
    Arduino Pro Mini](ch00.xhtml#ch00lev2sec4)” on [page 8](ch00.xhtml#page_8)), and
    take it for a test run. If you have a variable power supply with a voltage readout,
    setting the voltage will be easy; if you don’t have a variable power supply, I
    suggest building the Regulated Power Supply in [Chapter 3](ch03.xhtml#ch03). If
    you use a variable supply without a readout, just use your multimeter to monitor
    the voltage and observe the trigger point.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
- en: Start the power supply at 13V (12.7V is normal for a charged 12V lead-acid storage
    battery), and the monitor LED should blink slowly. Gradually lower the voltage,
    and write down the voltage when the flashing goes from slow to rapid. That voltage
    is the trigger point, and it should be around 11.9V to 12V.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-10.jpg)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-10: Pinout of the ZTX649 transistor*'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
- en: '**The Sketch**'
  id: totrans-135
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In developing the Battery Saver sketch, I went through several iterations to
    assure reliable functionality. One difficulty was avoiding false triggers when
    the sensed voltage jumped around because an engine or an accessory, such as a
    hydraulic tilt, was activated.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
- en: I used functions to adjust various sequences of operation independent of the
    main program. This isn’t a complex sketch, but writing simple functions is a useful
    technique when you want to avoid repeating code. I could have avoided functions
    in the final sketch, but I let them remain because they work well, and writing
    the sketch this way provides a good lesson in the use of functions.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: In this sketch, `timer()`, `timer2()`, and `timer3()` are the three functions
    used. The `timer()` function is for normal operation when the battery voltage
    is above the trigger point. The trigger point is the voltage at which the Battery
    Saver goes into timeout mode prior to shutting down. The `timer2()` function sets
    off a rapid flashing sequence once the trip threshold is reached and provides
    the timing—the fast LED sequence—prior to shutoff. Once `timer2()` has finished,
    `timer3()` is invoked, provided the voltage remains below the threshold; this
    disconnects the battery by activating the solenoid. If the voltage increases above
    the trigger point at any time during the timeout period, the Battery Saver returns
    to normal operation after `timer3()` times out. Many of the variables in this
    sketch can also be changed to vary blinking and delay sequences and threshold;
    they’re addressed in “[Operating the Battery Saver](ch06.xhtml#ch06lev1sec11)”
    on [page 180](ch06.xhtml#page_180).
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
- en: '**The Shield**'
  id: totrans-140
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: As you might guess from the breadboard, the shield is straightforward, too.
    Compared with handwiring, however, I believe it’s a lot easier and faster.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
- en: '***The PCB Layout***'
  id: totrans-142
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: '[Figure 6-11](ch06.xhtml#ch06fig11) shows my finished PCB, and [Figure 6-12](ch06.xhtml#ch06fig12)
    shows the layout image with silkscreen indicating the placement of the components.
    You can download a PCB layout for the shield at *[https://www.nostarch.com/arduinoplayground/](https://www.nostarch.com/arduinoplayground/)*.'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-11.jpg)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-11: The unpopulated Battery Saver board. The RLY connection is where
    you would connect the solenoid*.'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-12.jpg)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-12: The foil pattern for the shield on the Battery Saver. The silkscreen
    image is in gray*.'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
- en: Most of the components are located under the Pro Mini to save space. Other than
    that, there is nothing special about populating the shield. As in other projects,
    it’s not necessary to include headers for all the Pro Mini pins. Use all the pins
    that have connections with board traces and enough other pins to add mechanical
    stability. I always try to use at least one header for the very first pin, to
    aid in aligning the board while plugging it in.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
- en: The LED can be mounted directly to the board or can be mounted somewhere remotely
    with long wires. Just be sure to observe polarity. The Battery Saver may be located
    in an area where the operator can’t see the LED, so placing it in a remote location
    is a practical solution.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
- en: '***Preparing the Shield and Pro Mini Controller***'
  id: totrans-150
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: If you want to use a PCB, you can make the shield according to the layout provided
    with this book’s resource files, whether you etch that yourself or send it off
    to be professionally manufactured. You could also design your own shield PCB if
    you’re feeling ambitious or just solder everything to the prototyping board, but
    if you are using everything else from the parts list, just make sure your board
    has the same dimensions as the provided shield layout.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
- en: 'If you etch the PCB design I provide, drill the component holes next. I usually
    use a #66 drill. Solder a 2-inch wire to the plus 12V side of the shield, and
    solder the other side of the wire to a small solder lug. Solder a 15-inch wire
    to the ground terminal and then connect two wires to the solenoid connections.
    I used a small inline connector—made with Pololu #1950 crimp connector housings,
    #1931 male crimp pins, and #1215 female crimp pins—so I could remove the board
    easily if necessary. Almost any connector can be used.'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
- en: Both transistors are located under the shield, so when you solder them, make
    sure to push them down enough that they clear the bottom of the Pro Mini. See
    [Figures 6-11](ch06.xhtml#ch06fig11) and [6-12](ch06.xhtml#ch06fig12) for the
    transistor placement on the PCB.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
- en: I soldered the monitor LED directly to the board so it could be seen through
    the enclosure. However, you could also solder wires to the board and place the
    monitor LED in a location where it might be more visible outside your vehicle.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
- en: '**Construction**'
  id: totrans-155
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Building the rest of the Battery Saver involves a few mechanical challenges
    and requires the wits of a scavenger. [Figure 6-13](ch06.xhtml#ch06fig13) shows
    all the parts of the Battery Saver laid out. There is nothing complex about any
    of the parts.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-13.jpg)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-13: The components of the Battery Saver, completely disassembled.
    The cover of the enclosure is under the clear box. Note the short screws for fastening
    the spacer to the solenoid, so they don’t damage the solenoid coil*.'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
- en: 'There are only a handful of components in the Battery Saver: the enclosure,
    the phenolic contact support, the shield and Pro Mini controller, the copper contact
    assembly, the solenoid and mounting, the release lever and pylon, the release
    rod, and the springs and e-clip. The assembly instructions that follow are a little
    involved, but if you get stuck, just use [Figure 6-13](ch06.xhtml#ch06fig13) to
    keep things in perspective. When you’re done, the Battery Saver should look like
    [Figure 6-14](ch06.xhtml#ch06fig14).'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-14.jpg)'
  id: totrans-160
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-14: The completed Battery Saver with the cover off and the switch
    in the operating position. In this iteration, grooves were carved in the phenolic
    block for the positive and ground wires*.'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
- en: '***Preparing the Enclosure***'
  id: totrans-162
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Because the enclosure, a Hammond 1591 STCL, is an integral part of the design,
    I suggest starting there. Beyond a couple of holes and slots machined into the
    enclosure, there is very little else to do. [Figure 6-15](ch06.xhtml#ch06fig15)
    shows the holes I cut in detail; a template is included in this project’s resource
    files. There are only a few holes to cut, though, so you should be fine without
    the template if you follow these instructions carefully.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
- en: 'On the long sides of the enclosure, measure approximately 1 1/8 inches from
    the top—that is the side where the reset plunger will protrude through. This should
    locate you roughly at the fourth mounting rib. In the center of that rib, drill
    two #30—approximately 1/8-inch—holes 3/8 inches from either edge, and countersink
    both for a 4-40 screw. Do this on both sides of the enclosure.'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
- en: On each side, at the top of the next rib (going toward the top of the enclosure),
    cut a 1-inch-deep groove for the copper contact assembly. The shaded part of the
    side view in [Figure 6-15](ch06.xhtml#ch06fig15) shows where the groove should
    go on each side. The ABS plastic enclosure cuts easily with a hacksaw. Remove
    the cover and cut from the opening of the enclosure toward the back. For each
    groove, make two cuts so that when you remove the material between them, you will
    have a 3/16-inch-wide channel in both sides of the enclosure. A little over 1
    inch from the edge at the opening will do, but it’s not necessary to cut down
    to the back of the enclosure. You can even cut both sides at once, but just make
    sure the channels are directly opposite each other. Don’t worry if your cuts are
    a little off; that can be corrected later with a file. After you make the cuts,
    break off the material in the center and clean up the channel with a small triangle
    or flat file.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-15.jpg)'
  id: totrans-166
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-15: The holes and slot in the Battery Saver enclosure*'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
- en: Now, drill a 1/4-inch hole in the top of the enclosure, where the reset button
    will go, exactly centered on the top surface. Draw lines along that side’s diagonals
    from corner to corner, as illustrated in [Figure 6-15](ch06.xhtml#ch06fig15),
    and drill where the lines intersect. This hole is where the brass release rod
    for the reset plunger will go.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
- en: '***The Contact Support***'
  id: totrans-169
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'The contact support is perhaps the easiest part to make. First, cut the phenolic
    sheet to a 3×1 3/8–inch block. The phenolic material cuts easily with a hacksaw.
    Insert the block in the enclosure so the two holes you drilled through the ribs
    are in the center of the block. Mark the holes on both sides, drill them with
    a #43 drill bit, and tap them for a 4-40 screw. While you are working on the phenolic
    contact support, you can cut two grooves, or channels, for the power and ground
    wires on either side (shown later in [Figure 6-18](ch06.xhtml#ch06fig18)). The
    location is not critical as these are used only to run the positive and negative
    wires for the shield. I used the small Dremel tool in [Figure 6-16](ch06.xhtml#ch06fig16)
    to cut the grooves. Use two 4-40×3/8-inch flathead screws on each side to screw
    the phenolic piece in place.'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-16.jpg)'
  id: totrans-171
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-16: Dremel tool with small circular saw blade attached*'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
- en: With the phenolic contact support screwed in place, hold the drill as close
    to vertical as possible in the center of the largest face of the contact block.
    Drill a 1/4-inch hole that lines up with the 1/4-inch hole you previously drilled
    in the top of the enclosure. The easiest way to do this is to mount the contact
    support block and then use the hole in the top of the enclosure as a guide to
    drill the hole in the block. After drilling, put the contact support aside until
    you’re ready for the copper contact assembly.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
- en: '**NOTE**'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
- en: '*The enclosure is not a perfect rectangle because some relief is included to
    allow it to come out of the mold easily. Factor this in as you line up to drill
    the center hole. When I drilled the hole, I held the enclosure in a vise to eliminate
    the effect of the relief*.'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
- en: '***Preparing the Copper Contact Assembly***'
  id: totrans-176
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The copper contact assembly requires only a handful of holes. Cut a 4 3/4-inch
    section of the 3/16×3/4–inch copper bar, and drill the holes along the center
    of the 3/4-inch dimension, as outlined in [Figure 6-17](ch06.xhtml#ch06fig17).
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-17.jpg)'
  id: totrans-178
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-17: The base of the copper contact assembly, showing holes and spacing*'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
- en: 'For holes A and G, use a 9/32-inch bit. Holes B, C, E, and F should be drilled
    with a #30 bit; make sure to countersink them deeply enough for a 4-40 flathead
    screw. Finally, drill hole D with a 1/2-inch bit. Tap holes A and G for a 5/16×18×3/4–inch
    bolt, which will hold the battery cables.'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
- en: '**CAUTION**'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
- en: '*While copper is not hard, it tends to grab a drill bit and climb up the bit.
    Always hold the copper piece in a vise, in a clamp, or with pliers when drilling.
    Never attempt to hold the copper with unprotected hands*.'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
- en: 'When all seven holes are drilled, set the base of the copper contact on the
    phenolic contact support so that the 1/2-inch center hole in the copper is centered
    as closely as possible on the 1/4-inch center hole in the phenolic support and
    the bar is centered along the entire length of the contact support. Make sure
    the bar is equidistant from both sides of the support, hold the two pieces together
    firmly, and mark holes B, C, E, and F. Center punch the marks you just made in
    the contact support, drill them with a #43 drill, tap them for a 4-40 screw, and
    set the contact support aside again.'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
- en: Now, mark the exact center of the copper contact, which should perfectly bisect
    the 1/2-inch hole. Cut the piece in two at this marker; a hacksaw should work
    well for this. Then, cut a 3/4×3/4–inch square of your leftover 3/16×3/4–inch
    copper bar, and mark the center by making diagonal lines from corner to corner.
    Center punch and drill a 1/4-inch hole where those lines intersect. This copper
    square will become the actual contact.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
- en: 'The final hole to make in the copper contact assembly is somewhere between
    holes E and F, on the outer edge of the bar; look for the little screw sticking
    out of the contact bar in [Figure 6-18](ch06.xhtml#ch06fig18) (circled). Drill
    a #43 hole and tap for a 4-40 screw. This is where the switched positive voltage
    to the Pro Mini comes from. [Figure 6-18](ch06.xhtml#ch06fig18) shows all the
    contact and mounting hardware drilled.'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-18.jpg)'
  id: totrans-186
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-18: The contact and support hardware ready for assembly*'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
- en: '***Mounting Supplies for the Solenoid***'
  id: totrans-188
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Depending on your solenoid, the mounting process may vary slightly from the
    one described here. The frame of the solenoid I used had two holes tapped for
    a 4-40 screw in the bottom. However, there was precious little room between the
    frame and the coil, so I elected to look for an alternative mounting approach—a
    very aggressive double-sided adhesive. If you still want to mount the solenoid
    with screws, judge the screw length carefully. With either mounting approach,
    the solenoid was not high enough to line up with the release mechanism, so I had
    to add a platform.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
- en: '***Preparing the Release Rod, Springs, and E-Clip***'
  id: totrans-190
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: As with the other mechanical components of the Battery Saver, the release rod
    to reset the contacts just needs a little TLC. Begin with a section of 1/4-inch
    brass rod, and cut it to 4 1/4 inches in length. Measure 1 1/8 inches down from
    one end, and make a groove for the spring retaining clip to fit into, as shown
    in [Figure 6-19](ch06.xhtml#ch06fig19).
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
- en: In order to cut the groove, I mounted the bar in the chuck of an electric drill
    that I clamped to my workbench and used a hacksaw blade to carefully groove the
    piece, guiding the hacksaw blade with my fingers. The set on the hacksaw blade
    is a little wide, but the depth of the groove, not the width, is the important
    part. That said, the groove doesn’t have to be very deep. I recommend you cut
    the groove in small increments and keep trying the retaining clip until it fits
    snuggly.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
- en: '[Figure 6-19](ch06.xhtml#ch06fig19) also shows the configuration of the springs.
    The bottommost spring will rest on the phenolic block and keep the copper contact
    off the contact areas until the release rod is depressed. It should be small enough
    that it does not touch either side of the copper contacts. (Remember, the hole
    in the square contact is 1/2-inch wide, so the spring needs to be smaller than
    that.) When depressed, the top spring overrides the lower spring and keeps the
    upper part of the switch in firm contact with the lower sections. You can make
    fine adjustments of the spring length on a small grinder, or you can use a Dremel
    tool or a hand whetstone.'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-19.jpg)'
  id: totrans-194
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-19: The upper section of the release bar. There are two grooves in
    the bar; the lower one was made in error. The springs used on the release rod
    were selected from a standard spring assortment from Ace Hardware and cut down
    to fit the project*'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
- en: Now, measure 4 inches from the same end, and file the release groove in the
    lower half of the 1/4-inch release bar using a small needle file. [Figure 6-20](ch06.xhtml#ch06fig20)
    shows both the needle file used and the shape of the release groove. (You might
    want to use a hacksaw first to make the groove, and shape the upper side with
    a file.)
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-20.jpg)'
  id: totrans-197
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-20: A close up of the release groove in the bottom of the release
    rod (top) and the small needle file used to make the groove (bottom)*'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
- en: The shape of the release groove is not overly critical, but make sure there
    is a slight bevel on the top side. The swirls you see on the shaft were made with
    400-grit sandpaper I used to smooth the rod so it slides smoothly through the
    phenolic block and hole in the case and contact piece.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
- en: '***Making the Release Lever and Pylon***'
  id: totrans-200
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The release lever is made of a small piece of light-gauge steel sheet metal,
    approximately 0.060 inches thick. Use the pattern in [Figure 6-21](ch06.xhtml#ch06fig21)
    to cut the lever. In this book’s online resource files, you can find a PDF file
    of the lever template. Because the template is pretty small, you might try bonding
    the template to a blank piece of similarly sized stock, holding it in a pair of
    pliers (vise grips work well), and shaping the piece on a grindstone. Once you’ve
    bonded the template to the stock, you can also use a file to shape it.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-21.jpg)'
  id: totrans-202
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-21: The release lever template*'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
- en: 'With a pair of tin snips, I cut a rectangle first and then cut the shape of
    the release lever. I firmly clamped the piece in place with a vise so I could
    finish shaping it with a file. Mild steel files easily with a satisfying feel.
    (You could also shape the lever with a small grinding wheel or a Dremel tool with
    an abrasive wheel.) Make the piece a little oversized at first, as indicated in
    the template, as it may require some adjustment in the final assembly. The lever
    should be under pressure from the tension spring, and should securely hold the
    release rod so that the square copper piece is firmly in contact with the both
    sides of the bottom copper contact assembly. Both pivot holes in the lever—one
    to attach to the solenoid and one to attach to the release pylon—are drilled with
    a #30 drill.'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
- en: The pylon is for mounting the release lever to the enclosure, and it can be
    made of any scrap brass or aluminum you may have around. The pylon in [Figure
    6-22](ch06.xhtml#ch06fig22) was made from a 3/8-inch diameter brass rod. I reduced
    the top section’s diameter because I didn’t want the pylon to rub on the release
    rod, but that probably was not necessary.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-22.jpg)'
  id: totrans-206
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-22: The release lever, the pylon, and two screws*'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
- en: Cut the pylon to about 0.61 inches long so that when mounted inside the enclosure,
    the end attached to the release lever hits the release rod just below the center
    of its diameter. This dimension is dependent on how precisely the release rod
    hole is drilled into the center of the top of the enclosure. Run the release rod
    through the hole, and measure how far from the back of the enclosure its center
    is. The pylon should be a little shorter than that.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
- en: You can make the top of the pylon smaller by chucking it into a drill like a
    bit and spinning it on a file. When you finally assemble the Battery Saver, you
    may also have to adjust the height of the pylon slightly to accommodate the thickness
    of the release lever and altitude of the release rod if the hole was not drilled
    perfectly straight.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
- en: 'Drill a #43-sized hole near the center of the pylon all the way through, and
    tap for a 4-40 screw from both sides. One side will mount to the back of the enclosure,
    and the other will hold the release lever. To make sure the screw doesn’t go down
    too far and tighten against the release lever, I tapped down only about 3/16 inches
    so the screw bottomed out and jammed. [Figure 6-23](ch06.xhtml#ch06fig23) illustrates
    what the tapped pylon should look like.'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-23.jpg)'
  id: totrans-211
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-23: Inside the pylon*'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
- en: You can adjust either the length of the tapped hole or the length of the screw
    to make sure the release lever is free to move but secure, using the screw head
    as a bearing surface. For fastening both the release-lever bearing screw and the
    pylon mounting screw, I recommend using an anaerobic adhesive (such as Loctite
    Threadlocker) to secure the threads.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
- en: '***Assembling All the Parts***'
  id: totrans-214
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Now, we’re ready to start putting all the parts from [Figure 6-13](ch06.xhtml#ch06fig13)
    together and fastening them where they belong. The order of assembly is not overly
    critical, but more a matter of common sense. I’ll go through it step-by-step:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
- en: Start by screwing the copper contact pieces into the phenolic support. Make
    sure the screw heads are below the surface of the copper. This is critical to
    assure good contact with the contact bar. Prior to assembly, as an added measure
    to improve the contact area, I sanded both the contact pieces and contact cap
    with a 400-grit sandpaper. To assure flatness, I put the sandpaper on a flat surface
    and rubbed the copper on it.
  id: totrans-216
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Slide the phenolic support into the enclosure, and fasten it with the four 4-40×1/2-inch
    screws.
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Insert the release rod through the enclosure, and then thread it through the
    pressure spring, then through the copper contact, and finally through the release
    spring and down through the phenolic base. Insert the e-clip. This may be a little
    tricky. You’ll have to hold the clip with a pair of needle-nose pliers.
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Measure for the location of the pylon, and mount it to the enclosure with a
    4-40×1/2-inch flathead screw. The pylon should be inside the enclosure, and the
    screw should be threaded in from the outside.
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Screw the release lever to the pylon, and check by hand that it engages the
    release groove and secures the release rod. This is a little tricky, and you may
    have to adjust the release lever by grinding or filing it a little to fit in the
    release rod’s groove. Once you have the lever in place, you can operate it with
    your fingers and assure that it locks tightly to the release-rod groove.
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Install the spacer on the solenoid.
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Temporarily mount the solenoid to the enclosure, and screw the release lever
    to the solenoid. To do this, I first unfastened the release lever from the pylon
    and fastened the other end to the solenoid plunger. I then applied double-sided
    tape to the bottom of the spacer, juggled everything in place, and loosely placed
    the screw through the release lever and into the pylon.
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Exercise the release mechanism with the solenoid held in place. Once the release
    rod holds the top switch contact firmly down, mark the holes for the solenoid
    spacer.
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Drill and tap holes in the enclosure to securely mount the solenoid and spacer
    to the enclosure. Alternatively, fasten the solenoid with double-sided adhesive,
    such as 3M outdoor double-sided adhesive.
  id: totrans-224
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run the wires that will connect the solenoid to the Pro Mini circuit under the
    release rod, and connect them to the solenoid using the connectors.
  id: totrans-225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run the ground wire from the Pro Mini circuit under the release rod and out
    through the slotted opening for the copper bar. (It’s the dark wire sticking out
    of the enclosure on the left in [Figure 6-14](ch06.xhtml#ch06fig14).) You may
    want to either drill small holes in the phenolic for the wires or carve small
    grooves to run the wire through, using a Dremel tool and a small circular saw
    blade like the one shown in [Figure 6-16](ch06.xhtml#ch06fig16). You can also
    make a groove with a file or hacksaw.
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Attach the red positive voltage wire with the lug to the copper switch pole
    at the last hole you tapped in “[Preparing the Copper Contact Assembly](ch06.xhtml#ch06lev2sec7)”
    on [page 173](ch06.xhtml#page_173). Use a 4-40×3/8-inch roundhead screw.
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Mount the shield using small spacers. If you can’t find a solder lug, you can
    solder-tin the wire, form it so it fits around the screw snugly, and then tighten
    the screw.
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Compare your Battery Saver to the finished device in [Figure 6-14](ch06.xhtml#ch06fig14)
    to make sure everything looks right. When the battery voltage reaches the trigger
    point, the Arduino triggers the solenoid, which releases the lever. Freed from
    the release lever, the rod pops up from the spring tension of the lower spring.
    The lower spring holds the contact piece above the copper mounted to the phenolic
    block, opening the circuit. To reset the Battery Saver, just push the rod back
    down again. Before doing a final test, check the latching of the release lever
    and rod several times.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
- en: '**Installing the Battery Saver into a Vehicle**'
  id: totrans-230
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Connecting your Battery Saver to your vehicle takes only minutes. First, disconnect
    both the positive and negative terminals from your battery. Then, connect a short
    battery cable from the positive side of the battery to the input side of the Battery
    Saver. Take the output side of the Battery Saver and connect it to the cable that
    originally connected to the battery. Connect the black wire to the negative terminal
    that will be reconnected to the battery.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
- en: Mounting the entire enclosure will depend on where and how your vehicle’s battery
    and/or battery box are located. In many cases, the Battery Saver can simply hang
    from the battery cables. In other applications, I’ve used a heavy-duty cable tie
    to wrap around the entire battery and Battery Saver to hold it in place. In some
    cases, double-sided Velcro works well.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
- en: '**Operating the Battery Saver**'
  id: totrans-233
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In operation, once the Battery Saver is installed (see [Figure 6-24](ch06.xhtml#ch06fig24)),
    restore the ground connection to the battery and hook that ground connection to
    the Battery Saver. Then, set the Battery Saver by depressing the reset button—that
    is, the top of the release bar—until the unit is armed. You should hear or feel
    a click as you depress the reset button and the release lever engages.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-24.jpg)'
  id: totrans-235
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-24: The Battery Saver installed in my Boston Whaler runabout. The
    battery hooks up to the battery post and to the positive connection for the motor
    and accesssories. The ground lead of the battery was fed through the back of the
    battery box. The reset plunger is readily accessible*.'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
- en: '***Normal Operation***'
  id: totrans-237
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: As long as the battery is fully charged and above the threshold voltage, the
    “on” indicator will blink at the rate established in the `timer()` function, which
    is approximately once every 2.2 seconds. When the battery voltage drops below
    the threshold level, which is set at approximately 11.9V via variable `B` in the
    sketch, the indicator LED begins flashing rapidly. When the LED sequence finishes,
    which is after about 3 minutes, the voltage will be checked once again. If the
    voltage is still below the threshold, the battery is disconnected; otherwise,
    it just returns to normal operation.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
- en: When you reset the Battery Saver after it has shut off, it will resume operation.
    After reset, if the battery voltage is above the threshold, the indicator will
    blink at the usual rate of once every 2.2 seconds. Often when the drain is removed
    from a battery discharged to some level, the battery recovers somewhat on its
    own after a relatively short time. If, however, the voltage is below the threshold
    level, the indicator will blink rapidly for the timeout period, as indicated earlier,
    to allow for the operator to start the boat, tractor, or other vehicle. You can
    set the timeout period by changing the value of `j` in the `timer2()` function.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
- en: The maximum value of the `j` variable is set at 1,800 in the initial sketch,
    and incrementing or decrementing `j` will add or subtract 100 milliseconds from
    the total timeout period. Thus, to set the timeout period to 5 minutes, you would
    set the maximum value of `j` to 3,000.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
- en: '***Setting the Threshold Voltage***'
  id: totrans-241
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The threshold voltage is established by resistors R1 and R2 with values of 10,000
    and 5,600 ohms, respectively (see the schematic in [Figure 6-6](ch06.xhtml#ch06fig6)).
    These are set up as a voltage divider. According to the voltage divider calculation,
    whether you use a calculator or work it out with the formula, the voltage will
    be approximately 4.31V for a 12V input. Thus, you can calculate the exact threshold
    voltage at which you want the device to shut off the battery current by setting
    the threshold trigger point, which is `B` in the sketch, to whatever value you
    wish. While I calculated the theoretical value of the threshold, I experimented
    and found that a value of 387 establishes the shutoff threshold point at about
    11.9V.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
- en: '**ON BATTERY TYPES**'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
- en: I experimented with several batteries and loads and found setting `B` to 387
    consistently leaves at least half the energy in the battery after shutdown to
    restart the engine. On several different batteries, ranging from the small battery
    on a portable generator to large-capacity batteries for starting a truck, the
    same value seemed to work well.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
- en: That said, I have little experience with deep-cycle batteries and know that
    they have very different discharge parameters. If you want to attempt to use the
    Battery Saver for such batteries, take a look at their discharge rates and voltages,
    and set the threshold accordingly.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
- en: '***Protection from the Environment***'
  id: totrans-246
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Unfortunately, the Battery Saver is not weatherproof, and most applications
    call for it to be used in somewhat hostile environments. There are, however, a
    couple of possible solutions. On a variety of vehicles, including boats and tractors,
    I have wrapped the device in a plastic bag and tightly wrapped wire ties around
    the cables where they enter and exit the device.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
- en: But that’s not terribly attractive, and I took some abuse from the distaff side
    of the family, so I applied Permatex silicon RTV sealant around all the openings
    where the copper bar comes through—but not where the reset (brass) rod comes through—and
    sealed all the screws.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
- en: For the reset button, I had difficulty finding a protective covering nipple
    (you would be surprised at what I found on the web), so I settled for affixing
    the top of an eye dropper to the enclosure with the silicone sealant. This also
    keeps the reset bar—which is hot to 12V when depressed—from shorting out.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
- en: '***Applying Cool Amp***'
  id: totrans-250
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: While the copper-on-copper contacts work well, I burnished them with very fine
    sandpaper (400 grit) before assembly. Even though the untreated contacts have
    been used on a number of versions of the Battery Saver and have never failed,
    I decided to use Cool Amp, a simple-to-use silver-plating compound, for this version.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
- en: For very little cost, I was able to silver-plate the contact area of the contact
    bar and plate and thus reduce their resistance. [Figures 6-25](ch06.xhtml#ch06fig25)
    and [6-26](ch06.xhtml#ch06fig26) show the difference between unplated and plated
    copper.
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-25.jpg)'
  id: totrans-253
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-25: Battery Saver contacts after burnishing but before treatment
    with Cool Amp*'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-26.jpg)'
  id: totrans-255
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-26: Battery Saver contacts after silver plating with Cool Amp*'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
- en: While this additional lowering of resistance is probably not necessary, all
    the current for the vehicle passes through this contact, so I figured it wouldn’t
    hurt to be on the safe side. Further, I have used the Battery Saver in marine
    applications around saltwater, and the copper parts have acquired a green patina
    while the silver-plated areas have not.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
- en: I have used Cool Amp on a number of contacts, from motor-starting contacts to
    heavy-duty relay contacts, and it works well. You can learn more about Cool Amp
    at *[http://www.coolamp.com/](http://www.coolamp.com/)*.
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
- en: '**NOTE**'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
- en: '*Copper does not oxidize too rapidly and the most common oxide of copper is
    highly conductive, which is one reason it is commonly used for current switching.
    Silver has the same properties—only better*.'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
- en: '**MY ORIGINAL IDEA**'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
- en: I hold a US patent (4,149,093, now expired) on a device similar to the Battery
    Saver. The patent drawing is shown in [Figure 6-27](ch06.xhtml#ch06fig27). Notice
    how similar it is to this project, despite being made decades earlier. It had
    essentially the same function, even though microcontrollers hadn’t been invented
    yet!
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f06-27.jpg)'
  id: totrans-263
  prefs: []
  type: TYPE_IMG
- en: '*Figure 6-27: A patent drawing of the Battery Saver’s predecessor*'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
