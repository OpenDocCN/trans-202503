<html><head></head><body>
<div id="sbo-rt-content"><section aria-labelledby="header0701" class="chapter" epub:type="chapter" id="ch07" role="doc-chapter">
<header id="header0701">
<h1 class="cn"><span aria-label="105" class="page" epub:type="pagebreak" id="p105" role="doc-pagebreak"/><a class="xref" href="nsp-enoka501485-0007.xhtml#rch07">7</a></h1>
<h1 class="ct">Blocking Internet Advertisements</h1>
</header>
<figure class="figure">
<p class="fig"><img alt="Chapter opening icon" height="100" src="images/nsp-enoka501485-ct.jpg" width="100"/></p>
</figure>
<p class="pf"><span class="page" data-locator="p105"/>Companies monetize the internet through advertising, which has caused the number of online ads to proliferate (or more accurately, explode). These ads have become more insidious over time, as websites track your activity to display the promotions most likely to lead to purchases. Even worse, advertising has caused slower internet connections through websites becoming so bloated with autoplaying advertisements.</p>
<p>You can block ads from your network in several ways. This chapter will first discuss various browser ad-blocking solutions. Then, we’ll build an ad-blocking DNS proxy server using Pi-Hole to provide users with a much better browsing experience while also improving data and privacy protection.</p>
<section>
<h2 class="ah" id="ah0901"><span aria-label="106" class="page" epub:type="pagebreak" id="p106" role="doc-pagebreak"/><a class="xref" href="nsp-enoka501485-0007.xhtml#rah0901">Browser-Level Ad Blocking</a></h2>
<p class="paft">Most modern browsers have some form of ad-blocking technology built-in to the application itself. By default, some browsers prevent various trackers and scripts from operating as designed. These include social media trackers, cookies, fingerprinters, and cryptominers. Blocking <i>social media trackers</i> disallows sites such as Facebook, Twitter, and LinkedIn from tracking you as you browse websites that implement social media buttons or instant sharing links. <i>Cookies</i> are files used by sites to track information and user preferences between visits; this can leak your private information from one site to another. <i>Fingerprinters</i> are similar in that they identify a specific user by a number of metrics collected from their browsing habits, which allows advertisers to track your activity during a browsing session. Finally, <i>cryptominers</i> are applications (some might say malware) that use your computer hardware to mine cryptocurrency, such as Bitcoin. This is a highly resource-intensive process that can cause system instability. All of these can negatively impact your browsing experience and should be blocked.</p>
<p>Besides the built-in functionality provided by some web browsers, some of the most popular browser ad blockers are browser <i>extensions</i>, also known as <i>add-ons</i>—software that you can add to your browser to improve its functionality or add capabilities. For example, <i>Adblock Plus</i>—installable in most browsers—works by intercepting advertisements before they’re displayed to the user, though the ads are still downloaded to your computer.</p>
<p>Many websites can identify when browser extensions are in use and will either modify their content or completely block users from viewing web pages until the extension has been disabled or the site is allowlisted to play ads. Browser extensions are discussed further in <a class="xref" href="nsp-enoka501485-0020.xhtml#ch11">Chapter 11</a>. The following projects cover how to set up browser ad blocking for Google Chrome, Mozilla Firefox, and Brave browsers.</p>
<p class="hd" id="hd0901"><a class="xref" href="nsp-enoka501485-0007.xhtml#rhd0901"><span class="ccust2">#22: Blocking Ads in Google Chrome</span></a></p>
<p class="paft">Chrome’s ad blocker (<a class="url-i" href="https://www.google.com/chrome/">https://www.google.com/chrome/</a>) is designed to hide ads on websites that have too many ads or whose ads detract from the user experience, such as by flashing or making noise. Chrome also blocks ads on sites that put content behind a <i>paywall</i>, which obscures the website entirely until the user either allows the ads to display or pays a fee to view the content. This behavior applies to the Android version of Chrome in addition to the desktop version. It’s possible to activate or deactivate the built-in ad blocker, as well as to allowlist specific sites:</p>
<ol style="list-style-type:none">
<li class="nlf">1. At the top right of the Chrome browser, click the <b>More</b> icon (three horizontal lines).</li>
<li class="nl">2. Click <b>Settings▸Advanced▸Site Settings▸Ads</b>.</li>
<li class="nl">3. If the text “Blocked on sites that tend to show intrusive ads (recommended)” is displayed, Chrome is currently blocking ads for you.</li>
<li class="nll"><span aria-label="107" class="page" epub:type="pagebreak" id="p107" role="doc-pagebreak"/>4. If you’d like to turn ad blocking off, hit the toggle to switch the setting to <b>Allowed</b>.</li>
</ol>
<p>Another way to protect your privacy online is to use a private browsing window. Chrome’s <i>incognito mode</i> either won’t save your personal information or immediately deletes it (including tracking information such as cookies) when you close the browser. Your browsing history and internet searches won’t be saved. To open an incognito window, follow these steps:</p>
<ol style="list-style-type:none">
<li class="nlf">5. At the top right of the Chrome browser, click the <b>More</b> icon (three horizontal lines).</li>
<li class="nll">6. Click <b>New Private Window</b>.</li>
</ol>
<p>A new browser window will open that has a different appearance when compared to a normal Chrome window—text such as “You’ve gone Incognito” is typically displayed. This is how you know you’re browsing privately.</p>
<p class="hd" id="hd0902"><a class="xref" href="nsp-enoka501485-0007.xhtml#rhd0902"><span class="ccust2">#23: Blocking Ads in Mozilla Firefox</span></a></p>
<p class="paft">Firefox’s <i>Private</i> browsing (<a class="url-i" href="https://www.mozilla.org/">https://www.mozilla.org/</a>) windows block not only ads but also tracking content, including videos and other media displayed on a web page. To open a new Private window, follow these steps:</p>
<ol style="list-style-type:none">
<li class="nlf">1. At the top right of the Firefox browser, click the <b>More</b> icon (three horizontal lines).</li>
<li class="nll">2. Click <b>New Private Window</b>.</li>
</ol>
<p>You can change Firefox’s default behavior to disable tracking content in all Firefox windows, rather than just Private windows. To modify these settings, follow these steps:</p>
<ol style="list-style-type:none">
<li class="nlf">1. Click <b>More</b> in the top right of the Firefox window.</li>
<li class="nl">2. Click <b>Preferences▸Privacy &amp; Security</b>.</li>
<li class="nl">3. Set your Enhanced Tracking Protection settings to Standard (the default), Strict (provides greater privacy but may break some websites), or Custom.</li>
<li class="nl">4. Configure your Cookie settings to delete cookies on browser exit by ticking the <b>Delete Cookies and Site Data When Firefox is Closed</b> checkbox.</li>
<li class="nl">5. Make Firefox forget your browsing history by setting the History drop-down menu to <b>Never Remember History</b>.</li>
<li class="nll">6. Set permissions for things like your webcam and microphone so that Firefox isn’t able to watch or listen without authorization.</li>
</ol>
<p><span aria-label="108" class="page" epub:type="pagebreak" id="p108" role="doc-pagebreak"/>You can find more information on disabling trackers and other security and privacy settings in the Mozilla knowledge base at <a class="url-i" href="https://support.mozilla.org/en-US/kb/enhanced-tracking-protection-firefox-desktop/">https://support.mozilla.org/en-US/kb/enhanced-tracking-protection-firefox-desktop/</a>.</p>
<p class="hd" id="hd0903"><a class="xref" href="nsp-enoka501485-0007.xhtml#rhd0903"><span class="ccust2">#24: Controlling Brave’s Privacy Settings</span></a></p>
<p class="paft">Brave (<a class="url-i" href="https://brave.com/">https://brave.com/</a>) is a relatively new web browser based on Google’s Chromium (so it shares a lot of the same features as Chrome); all the extensions that are compatible with Chrome are also compatible with Brave. The great thing about Brave, when compared to other browsers, is that its goal is to provide a private, tracker- and ad-free experience for users. By having an aggressive approach to blocking ads in the browser, Brave claims not only to save you time and bandwidth while using the internet but also to reduce the amount of battery your browser uses.</p>
<p>Brave provides much more granular control over your security and privacy settings, and it makes these settings much easier to get to than other browsers:</p>
<ol style="list-style-type:none">
<li class="nlf">1. At the top right of the Brave browser, click the <b>More</b> icon (three horizontal lines).</li>
<li class="nl">2. Click <b>Settings▸Shields</b>.</li>
<li class="nl">3. Set Trackers &amp; Ads Blocking to Standard or Aggressive.</li>
<li class="nl">4. Turn on <b>Upgrade Connections to HTTPS</b>.</li>
<li class="nl">5. Set Cookie Blocking to Only Cross-site or All (your browser won’t remember your session information once closed).</li>
<li class="nll">6. Set Fingerprinting blocking to Standard or Strict (might break some websites).</li>
</ol>
<p>Experiment with these settings, as well as the social media blocking settings, until you find a combination that works for you.</p>
<p class="hd" id="hd0904"><a class="xref" href="nsp-enoka501485-0007.xhtml#rhd0904"><span class="ccust2">#25: Blocking Ads with Pi-Hole</span></a></p>
<p class="paft">Blocking ads with a browser extension or built-in tools is a great start to enhancing your internet browsing experience. However, those options apply to only one device at a time, and managing settings for multiple devices can quickly become onerous. Not only that, but some websites can block browser extensions. Blocking ads at the DNS level mitigates all of these issues.</p>
<p>The <i>Domain Name System (DNS)</i> enables your computer (or browser) to communicate with websites on the internet. All websites have an IP address (or more than one) assigned to them. Compared to IP addresses, the URLs that you use to access websites (for example, <a class="url-i" href="http://www.facebook.com">www.facebook.com</a>) are human-readable and easy to remember. Your computer translates that URL into an IP address to find the web server on the internet that serves Facebook to you—enter DNS. DNS acts like the postal service, in that IP addresses <span aria-label="109" class="page" epub:type="pagebreak" id="p109" role="doc-pagebreak"/>are equivalent to physical addresses, and URLs are like street names. DNS allows you to send and receive internet traffic to a specific address (or server) without having to remember the exact address (the IP address) of that server.</p>
<p>Given that advertising domains also use DNS to serve you ads, let’s build a <i>Pi-Hole</i> server to send all of those requests to a blackhole and provide your users with a better browsing experience. Pi-Hole is similar to the Squid proxy discussed in <a class="xref" href="nsp-enoka501485-0015.xhtml#ch06">Chapter 6</a>; it sits between you and the websites you want to browse, observing all internet traffic, identifying advertising at the DNS level via a curated list of known advertising domains and addresses, and allowing only legitimate, non-ad traffic to pass through to your browser. Pi-Hole is capable of blocking a larger percentage of ads than browser solutions, and it’s much harder for websites to detect and circumvent.</p>
<p>Set up an Ubuntu server in your local network, as discussed in <a class="xref" href="nsp-enoka501485-0010.xhtml#ch01">Chapter 1</a>, and add it to your network map and asset list. It’s possible to use a server located in the cloud, but exposing a DNS server to the open internet creates some technical challenges we won’t cover in this chapter. The right mitigating controls can solve these challenges, so if you choose to use a cloud server, proceed cautiously and do some research into how to mitigate the risks. If you’ve installed a perimeter firewall as discussed in <a class="xref" href="nsp-enoka501485-0012.xhtml#ch03">Chapter 3</a> and you create your Pi-Hole server using a virtual machine, the server should be located behind the firewall (that is, on the network side of the firewall, rather than the internet side).</p>
<p>It’s possible to use Pi-Hole in conjunction with Squid (discussed in <a class="xref" href="nsp-enoka501485-0015.xhtml#ch06">Chapter 6</a>) by using Pi-Hole to handle DNS requests and Squid to handle HTTP traffic. However, by default Squid uses an internal DNS client—this can’t be changed without rebuilding Squid, which is outside the scope of this book. If you choose to use both Squid and Pi-Hole, you can follow the instructions supplied for configuring each solution separately on your endpoints and achieve the same outcome.</p>
<section>
<h3 class="bh" id="bh0901"><a class="xref" href="nsp-enoka501485-0007.xhtml#rbh0901">Configure Pi-Hole</a></h3>
<p class="paft">Begin by creating a base Ubuntu server, as described in <a class="xref" href="nsp-enoka501485-0010.xhtml#ch01">Chapter 1</a>. Then, install the Pi-Hole server using the following steps:</p>
<ol style="list-style-type:none">
<li class="nlf">1. Log in to your Ubuntu server via SSH as a standard, non-root user. Then, download the Pi-Hole installation script from <a class="url-i" href="https://install.pi-hole.net/">https://install.pi-hole.net/</a>, make it executable, and execute the script using <code>sudo</code>:
              <pre>
<p class="cl3f">$ <code class="b">ssh</code> <code class="bi">user@your_server_ip</code></p>
<p class="cl3">$ <code class="b">wget -O basic-install.sh https://install.pi-hole.net</code></p>
<p class="cl3">$ <code class="b">chmod +x basic-install.sh</code></p>
<p class="cl3l">$ <code class="b">sudo ./basic-install.sh</code></p>
</pre>
</li>
<li class="nl">2. At this point, the automated installer will take over your terminal window. Read the various informational screens that come up, pressing <span class="ac">enter</span> to move to the next one.</li>
<li class="nll"><span aria-label="110" class="page" epub:type="pagebreak" id="p110" role="doc-pagebreak"/>3. When prompted to select an upstream DNS server, as shown in <a class="xref" href="nsp-enoka501485-0016.xhtml#fig0701">Figure 7-1</a>, choose whichever upstream (authoritative) DNS provider you’re comfortable with. Google or Quad9 is a good choice.
              <p class="pcust1"><span class="ccust1">Note</span> Use the arrow keys or TAB to navigate through the options, spacebar to select options, and ENTER to accept settings.</p>
<figure class="figure" id="fig0701">
<p class="fig"><img alt="The prompt to select an upstream DNS Provider contains a list of options, including Google (ECS), OpenDNS (ECS, DNSSEC), Level3, Comodo, DNS.WATCH, Quad9 (filtered, DNSSEC), and Quad9 (unfiltered, no DNSSEC). You can use your own by selecting “Custom.” Once you’ve selected a DNS Provider, click OK on the bottom left-hand side of the window, or click Cancel to revert changes." height="827" src="images/nsp-enoka501485-fig0701.jpg" style="width:95%; height:auto;" width="1200"/></p>
<figcaption>
<p class="figh"><span class="fighn">Figure 7-1</span>: Upstream DNS provider</p>
</figcaption>
</figure>
<p class="nlp">To perform DNS lookups, your Pi-Hole server will need an authoritative DNS server to query when it attempts to resolve domains that aren’t already cached by the proxy server. An <i>authoritative</i> DNS server is a nameserver that holds the actual DNS records for a particular domain or address, such as <a class="url-i" href="http://www.google.com">www.google.com</a>. By contrast, your server is <i>recursive</i>, an intermediary between you and your host and one or more authoritative DNS servers. When you make a request for a website, your device will pass this request to the Pi-Hole server, which will then farm this request out to an authoritative server to find the address of the website you want to view.</p>
</li>
<li class="nl">4. Select all the available blocklists when prompted.
              <p class="nlp">Pi-Hole uses <i>blocklists</i> (curated lists of advertising domains maintained by third parties) to identify and intercept advertisements on the internet. The chosen lists can be changed later.</p>
</li>
<li class="nl">5. Select IPv6 in addition to IPv4 at the protocol screen if you use IPv6 in your network.
              <p class="nlp"><span aria-label="111" class="page" epub:type="pagebreak" id="p111" role="doc-pagebreak"/>In most cases, IPv6 isn’t necessary. IPv6 provides internet-addressable IP space to endpoints, which you don’t need to do in this situation. It’s best to disable IPv6 to reduce your attack surface, unless you have a legitimate use for it.</p>
</li>
<li class="nl">6. The following screen indicates the static IP address and gateway of your server. If the address details listed on this page are correct, press ENTER to accept them. Otherwise, select <b>No</b> and press ENTER; then set your desired static IP details manually.
              <p class="nlp">The gateway for your Pi-Hole could be your firewall or router. Once you’ve configured or accepted the IP settings for your server, the automated installer will warn about configuring your router or DHCP server to reserve the IP address for this server. If you don’t do this, your network may encounter address conflicts, but most routers will be able to avoid this conflict without your input. (See “<a class="xref" href="nsp-enoka501485-0013.xhtml#ah0602">Static IP Addressing</a>” in <a class="xref" href="nsp-enoka501485-0013.xhtml#ch04">Chapter 4</a> for configuring static IP addresses on a router.) Press <span class="ac">enter</span> to acknowledge the warning.</p>
</li>
<li class="nl">7. Select <b>On</b> to install the web interface, which makes the server configuration easier to manage (even for advanced administrators), and then press ENTER.</li>
<li class="nl">8. Select <b>On</b> to install the web server offered by the automated installer, unless you plan to install your own (this is beyond the scope of this book).</li>
<li class="nl">9. Select <b>On</b> to log the DNS queries that pass through your Pi-Hole server.
              <p class="nlp">Since Pi-Hole is a proxy, it will record and cache all web requests that pass through it. This means that any endpoint configured to use your Pi-Hole server for DNS will have its browsing history recorded. If this poses concerns for your users, either get their permission or turn logging off. You don’t need logging to use Pi-Hole’s ad-blocking features, but enabling it can help troubleshoot any issues.</p>
</li>
<li class="nl">10. Select a privacy level that is acceptable within your network.
              <p class="nlp">Pi-Hole uses <i>Faster Than Light (FTL)</i> DNS, which provides statistics about Pi-Hole activity and displays it graphically. You’ll be able to see information such as how many ads were blocked, and for which endpoints, over a given period. FTL gets this data by parsing the Pi-Hole text logs. Like logging, this isn’t necessary for Pi-Hole to function and can cause privacy concerns for your users. Be sure to get their permission ahead of time, or set the privacy levels to Hide Domains and Clients, as shown in <a class="xref" href="nsp-enoka501485-0016.xhtml#fig0702">Figure 7-2</a>. Doing so will prompt FTL to collect anonymized data, allowing the statistics and graphical displays to function while preserving the privacy of your users. You could also decide to disable statistics entirely by turning logging off in the previous step.</p>
<figure class="figure" id="fig0702">
<p class="fig"><span aria-label="112" class="page" epub:type="pagebreak" id="p112" role="doc-pagebreak"/><img alt="Screenshot of the FTL DNS settings window that states “Select a privacy mode for FTL” and includes a link to learn more about privacy levels (https://docs.pi-hole.net/ftldns/privacylevels/) as well as the following options: Show everything, Hide domains, Hide domains and clients, and Anonymous mode." height="824" src="images/nsp-enoka501485-fig0702.jpg" style="width:95%; height:auto;" width="1200"/></p>
<figcaption>
<p class="figh"><span class="fighn">Figure 7-2</span>: FTL DNS settings</p>
</figcaption>
</figure>
</li>
<li class="nll">11. When the installation finishes, you’ll be presented with a screen showing your configuration, as well as the URL and administrator password for the web interface, as shown in <a class="xref" href="nsp-enoka501485-0016.xhtml#fig0703">Figure 7-3</a>. Be sure to record these values, ideally in a password vault (discussed in <a class="xref" href="nsp-enoka501485-0020.xhtml#ch11">Chapter 11</a>) for security and safety purposes; then press ENTER to return to the terminal.
              <figure class="figure" id="fig0703">
<p class="fig"><img alt="Screenshot of the Installation Complete window that contains the following information: “Configure your devices to use the Pi-hole as their DNS server using: IPv4: 172.16.90.11 IPv6: Not Configured; If you set a new IP address, you should restart the Pi. The install log is in /etc/pihole. View the web interface at http://pi.hole/admin or http://172.16.90.11/admin; Your Admin Webpage login password is rOhpBpI3.”" height="824" src="images/nsp-enoka501485-fig0703.jpg" style="width:95%; height:auto;" width="1200"/></p>
<figcaption>
<p class="figh"><span class="fighn">Figure 7-3</span>: Pi-Hole installation complete</p>
</figcaption>
</figure>
</li>
</ol>
<p><span aria-label="113" class="page" epub:type="pagebreak" id="p113" role="doc-pagebreak"/>You can change the administrator password with the following command:</p>
<pre>
<p class="cls">$ <code class="b">sudo pihole -a -p</code></p>
</pre>
<p>To keep Pi-Hole up-to-date, periodically run the following command:</p>
<pre>
<p class="cls">$ <code class="b">sudo pihole -up</code></p>
</pre>
<p>Ensuring that Pi-Hole and its components are up-to-date is crucial in keeping your Pi-Hole server, and your network, secure.</p>
</section>
<section>
<h3 class="bh" id="bh0902"><a class="xref" href="nsp-enoka501485-0007.xhtml#rbh0902">Using Pi-Hole</a></h3>
<p class="paft">Browse to the administrator URL displayed in the last configuration step (<i>http://&lt;your_server_ip&gt;/admin/</i>) where you should see the user dashboard. When a new update is available, you’ll be notified at the bottom of this screen, as in <a class="xref" href="nsp-enoka501485-0016.xhtml#fig0704">Figure 7-4</a>. At this time, it’s not possible to update Pi-Hole from the web interface; it must be updated using the commands in the previous section.</p>
<figure class="figure" id="fig0704">
<p class="fig"><img alt="At the bottom of the screen, under a link to Donate, is the following list: Pi-hole, Web Interface, FTL. Next to each of these items is the version number and text that says “Update available!” if an update is available." height="229" src="images/nsp-enoka501485-fig0704.jpg" style="width:95%; height:auto;" width="1200"/></p>
<figcaption>
<p class="figh"><span class="fighn">Figure 7-4</span>: Pi-Hole update required</p>
</figcaption>
</figure>
<p>Click <b>Login</b> on the left side of the screen and authenticate with your administrator username and password. The dashboard will then display more detailed information. You’ll find additional options in the administrator menu once logged in, as shown in <a class="xref" href="nsp-enoka501485-0016.xhtml#fig0705">Figure 7-5</a>.</p>
<figure class="figure" id="fig0705">
<p class="fig"><img alt="Pi-Hole’s admin dashboard contains a Main Navigation list on the left side. The Dashboard shows the number of Total queries, Queries Blocked, Percent Blocked, and Domains on Blocklist at the top. Underneath this, bar graphs show the Total queries over the last 24 hours and Client activity over the last 24 hours." height="662" src="images/nsp-enoka501485-fig0705.jpg" style="width:95%; height:auto;" width="1200"/></p>
<figcaption>
<p class="figh"><span class="fighn">Figure 7-5</span>: Pi-Hole administrator dashboard</p>
</figcaption>
</figure>
<p><span aria-label="114" class="page" epub:type="pagebreak" id="p114" role="doc-pagebreak"/>Brief descriptions of the important options in the navigation dashboard are as follows:</p>
<p class="pcust2"><span class="hemb">Query Log</span> A chronological, searchable history of all browser requests for websites that pass through the Pi-Hole proxy server.</p>
<p class="pcust2"><span class="hemb">Long-term Data</span> A more extensive history of requests to the proxy server that you can filter based on ranges of dates.</p>
<p class="pcust2"><span class="hemb">Whitelist</span> Websites that Pi-Hole blocks by default but to which you’d like to allow access.</p>
<p class="pcust2"><span class="hemb">Blacklist</span> Domains that the proxy may not block by default but that you’d like to block explicitly.</p>
<p class="pcust1"><span class="ccust1">Note</span> While we’ve been using allowlist/denylist, Pi-Hole uses whitelist/blacklist for its menu options and configuration. When discussing Pi-Hole, we’ll adhere to this terminology.</p>
<p class="pcust2"><span class="hemb">Disable</span> Disable the proxy for a set period.</p>
<p class="pcust2"><span class="hemb">Tools</span> Used to debug or update the blocklists, and review backend proxy logs. The backend logs provide debug information about Pi-Hole itself, rather than web traffic.</p>
<p class="pcust2"><span class="hemb">Tools▸Network</span> Displays all clients connected to the Pi-Hole server to help identify which endpoints are using the proxy and which may be bypassing it (your network map and asset list will come in handy).</p>
<p class="pcust2"><span class="hemb">Settings▸System</span> Contains the Pi-Hole proxy settings (including settings configured during installation); displays critical information; allows you to disable, restart, and power off the server; and lets you flush (delete) DNS proxy logs.</p>
<p class="pcust2"><span class="hemb">Settings▸DNS</span> Change the authoritative DNS servers used for domain name translation and modify the network interface on which requests are received and passed through the proxy filter (though the default settings are usually the safest).</p>
<p class="pcust2"><span class="hemb">Settings▸DHCP</span> Allows the Pi-Hole server to act as a DHCP server if desired.</p>
<p class="pcust2"><span class="hemb">Settings▸Privacy</span> Increase or decrease the level of privacy used when reporting about queries by choosing to link endpoints with their browsing activity or anonymize the data captured by the proxy.</p>
<p class="pcust2"><span class="hemb">Settings▸Teleporter</span> Imports or exports Pi-Hole settings to or from another server.</p>
<p class="pcust2"><span class="hemb">Logout</span> Logs you out of the administration dashboard.</p>
<p>Explore the various menus and options to familiarize yourself with Pi-Hole’s settings and configurations. Consider reading the manual as well to get a better understanding of how Pi-Hole works and how powerful it really is.</p>
</section>
<section>
<h3 class="bh" id="bh0903"><span aria-label="115" class="page" epub:type="pagebreak" id="p115" role="doc-pagebreak"/><a class="xref" href="nsp-enoka501485-0007.xhtml#rbh0903">Configure DNS on Your Endpoints</a></h3>
<p class="paft">At this point, there’s only one thing left to do: make your clients use the Pi-Hole server as their DNS server. You need to configure your DHCP server or router to push the DNS settings to devices that access the internet. Alternatively, you can configure each endpoint individually using its internal network settings. You might want to do this if you’d like only specific devices on the network to connect through the proxy while letting others connect to the internet directly. That said, making all devices go through the Pi-Hole server will provide the best experience to users and allow you to have better control of network traffic and identify issues earlier. The server will also cache more websites as users browse to them, which will make browsing to frequently visited sites faster for everyone.</p>
<p class="pcust1"><span class="ccust1">Note</span> Your router is capable of specifying the DNS server your endpoints use to access the internet. In the ASUS router we’ve been using as an example, it’s under Advanced Settings▸LAN▸DNS Server. Enter your Pi-Hole server’s IP address in the DNS Server1 box and click <b>Apply</b> to set the DNS server connected clients will use.</p>
<p>If you want only some of your endpoints to use the Pi-Hole server, either you can configure those clients using their local DNS settings or you can use the DNS settings in your pfSense firewall (if you implemented pfSense, as discussed in <a class="xref" href="nsp-enoka501485-0012.xhtml#ch03">Chapter 3</a>).</p>
<section>
<h4 class="ch" id="ch0901">Windows DNS Settings</h4>
<p class="paft">To configure the DNS settings on a Windows client, follow these steps:</p>
<ol style="list-style-type:none">
<li class="nlf">1. Open <b>Settings▸Network &amp; Internet4Change Adapter Options</b>.</li>
<li class="nl">2. Right-click <b>Ethernet Adapter</b>.</li>
<li class="nl">3. Click <b>Properties</b>.</li>
<li class="nl">4. Click <b>Internet Protocol Version 4 (TCP/IPv4)▸Properties</b>.</li>
<li class="nl">5. Select the <b>Use the Following DNS Server Addresses</b> radio button.</li>
<li class="nl">6. Enter the IP address of your Pi-Hole server in the Preferred DNS Server box.</li>
<li class="nl">7. Click <b>OK</b> and close all remaining windows.</li>
</ol>
</section>
<section>
<h4 class="ch" id="ch0902">macOS DNS Settings</h4>
<p class="paft">To configure your Mac to use your Pi-Hole server for DNS, follow these steps:</p>
<ol style="list-style-type:none">
<li class="nlf">1. Open <b>System Preferences▸Network</b>.</li>
<li class="nl">2. Select your network adapter (<b>Ethernet</b> or <b>Wi-Fi</b>) in the connection list on the left.</li>
<li class="nl">3. Click <b>Advanced▸DNS</b>.</li>
<li class="nl">4. Add your Pi-Hole server’s IP address to the DNS servers list on the left.</li>
<li class="nl">5. Click <b>OK▸Apply</b>.</li>
</ol>
</section>
<section>
<h4 class="ch" id="ch0903"><span aria-label="116" class="page" epub:type="pagebreak" id="p116" role="doc-pagebreak"/>Linux DNS Settings</h4>
<p class="paft">To route DNS requests through your Pi-Hole server on Linux endpoints, follow these steps:</p>
<ol style="list-style-type:none">
<li class="nlf">1. Open <b>Settings▸Network</b>.</li>
<li class="nl">2. Click the configuration <b>Cog</b> to the right of your Wired or Wireless connection.</li>
<li class="nl">3. Select the <b>IPv4</b> tab.</li>
<li class="nl">4. Enter your Pi-Hole server’s IP address in the DNS box.</li>
<li class="nl">5. Click <b>Apply</b>.</li>
</ol>
</section>
<section>
<h4 class="ch" id="ch0904">pfSense DNS Settings</h4>
<p class="paft">Using pfSense, you’re able to configure DNS settings either per client within the static IP addressing settings you will have used earlier or en masse by pointing your pfSense appliance at your Pi-Hole server for DNS. To send all DNS requests through your Pi-Hole server, enter your Pi-Hole IP address in the DNS servers box on the <b>Services▸DHCP Server</b> page. If you want to specify which endpoints will use the Pi-Hole server for DNS, follow these steps:</p>
<ol style="list-style-type:none">
<li class="nlf">1. Browse to the <b>Services▸DHCP Server</b> page of your pfSense appliance.</li>
<li class="nl">2. Find the Static Mapping option for the relevant endpoint in the DHCP Static Mappings table at the bottom of the page.</li>
<li class="nl">3. Click the <b>Edit</b> pencil icon for that endpoint.</li>
<li class="nl">4. Enter your Pi-Hole server’s IP address in the DNS box.</li>
<li class="nll">5. Click <b>Save▸Apply Changes</b>.</li>
</ol>
<p>Once you’ve configured your endpoints using any of the previous options, you can test your ad-blocking capability using a website like <a class="url-i" href="https://canyoublockit.com/">https://canyoublockit.com/</a>. Such websites provide several options for testing your ad blockers, whether they’re browser-based or something more substantial like Pi-Hole, from simple to advanced testing methods. If you run these tests and see no ads, your ad blocker is working. If you still see ads, review the earlier sections of this chapter and ensure your settings are correct. Log in to your Pi-Hole server and check the dashboard to see if your DNS queries are being seen by, and are therefore passing through, the server.</p>
</section>
</section>
</section>
<section>
<h2 class="ah" id="ah0902"><a class="xref" href="nsp-enoka501485-0007.xhtml#rah0902">Summary</a></h2>
<p class="paft">Regardless of how you choose to use Pi-Hole, you now have a means of monitoring and controlling internet usage in your network, and everyone should have a better internet browsing experience. You can choose to use Pi-Hole in addition to the Squid proxy you might have implemented in <a class="xref" href="nsp-enoka501485-0015.xhtml#ch06">Chapter 6</a>, or you can use either Squid or Pi-Hole without the other. Whichever solution you choose, you’ll experience the benefits associated with that technology. Alternatively, you can forego DNS-level ad blocking if you prefer to use browser-based blocking utilizing browser add-ons; the choice is yours.</p>
</section>
</section>
</div></body></html>