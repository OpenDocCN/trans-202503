<html><head></head><body>
<div id="book-content">
<div id="sbo-rt-content"><h2 class="h2" id="ch11"><span epub:type="pagebreak" id="page_267"/><strong><span class="big">11</span><br/>SMS FRAUD</strong></h2>&#13;
<div class="image1"><img src="../images/common.jpg" alt="Image" width="189" height="189"/></div>&#13;
<p class="noindentsa">Imagine that a TV program asks viewers to contribute $25 to a relief organization by texting a code to a designated phone number. If you send such a code, the charge will be added to your phone bill, then transferred to the charitable organization. You’ll find SMS messages like these used for a number of legitimate purposes, such as to respond to a political poll or guess the winner of a football game.</p>&#13;
<p class="indent">Often, however, malicious apps can send codes to premium services without the user’s consent. The victim won’t know that this is happening until they receive their phone bill at the end of the month and discover the mysterious charges. We refer to this type of abuse as <em>SMS fraud</em>. SMS fraud malware focuses on making unauthorized charges to the user’s account but doesn’t include other malicious activity that relies on text messages, such as spyware or banking trojan behavior.</p>&#13;
<p class="indent">In this chapter, we use the Extra-Trees classifier to evaluate the features useful for detecting Android SMS fraud apps. <a href="ch02.xhtml">Chapter 2</a> introduced numerous such families, including BeeKeeper, Camera, Joker, RuFraud, RuPlay, Taicliphot, Wallpaper, and WallySMS. Additionally, our tests <span epub:type="pagebreak" id="page_268"/>included Moundial, a smaller SMS fraud family previously unknown to the public that targeted Spanish Android users around 2014.</p>&#13;
<h3 class="h3" id="ch11lev1"><strong>SMS Fraud vs. Goodware</strong></h3>&#13;
<p class="noindent">If you take a look at the 20 most significant features for separating Android goodware from apps engaging in SMS fraud (<a href="ch11.xhtml#ch11fig1">Figure 11-1</a>), you should notice something interesting: although 11 of these features are permission-related, none involve SMS permissions. Perhaps this is because various legitimate apps might use such permissions to, for example, allow messaging from within the app. We’ll discuss other possibilities in “<a href="ch11.xhtml#ch11lev1sec2">The Absence of SMS Permissions</a>” on <a href="ch11.xhtml#ch11lev1sec2">page 270</a>.</p>&#13;
<p class="indent">Like ransomware and rooting malware, SMS fraud apps invoke the <code>org.apache.http.com.scheme</code> and <code>org.apache.http.com</code> APIs more often than goodware. On the other hand, goodware generally makes more calls to many Android APIs, such as <code>android.content.res</code>, <code>android.view</code>, <code>android.media.session</code>, <code>android.view.accessibility</code>, and <code>android.os</code>. The one exception is the Wi-Fi API (<code>android.net.wifi</code>), which provides classes for Wi-Fi connectivity. We are not sure why SMS fraud apps use this more than goodware. It may simply be an artifact of previous malware developed by the same developers.</p>&#13;
<h4 class="h4" id="ch11lev1sec1"><strong><em>Non-SMS Permissions</em></strong></h4>&#13;
<p class="noindent">We’ve described many of the significant permissions in previous chapters. Some of these don’t appear to serve any purpose. For example, <code>MOUNT_UNMOUNT_FILESYSTEMS</code> and <code>INSTALL_PACKAGES</code> are privileged permissions, and SMS fraud apps tend to declare these but never use them. These apps may also request the <code>READ_LOGS</code> permission, though this permission doesn’t enable malicious functionality for unprivileged applications.</p>&#13;
<p class="indent">Other permissions can enable an app to perform tasks common to many forms of malware. For example, the <code>KILL_BACKGROUND_PROCESSES</code> and <code>RESTART_PACKAGES</code> permissions, the latter of which was deprecated in Android 4.0.3 (Ice Cream Sandwich), may be used to kill undesirable processes as part of a defense strategy. Also, the <code>RECEIVE_BOOT_COMPLETED</code> permission provides the easiest way for malware to persist by automatically restarting after a phone reboot.</p>&#13;
<p class="indent">The remaining permissions have clear uses specific to SMS fraud. The <code>READ_PHONE_STATE</code> permission allows the app to read configuration settings for the phone’s telephony stack, for example to find out the device’s phone number or mobile carrier. As premium short codes are carrier-specific, malware needs this information to target the right mobile carrier. We see that the probability of this permission being requested by apps engaged in SMS fraud is over 80 percent, more than double the probability of goodware requesting it.</p>&#13;
<div class="image"><img id="ch11fig1" src="../images/ch11fig01.jpg" alt="Image" width="1846" height="929"/></div>&#13;
<p class="figcap"><em>Figure 11-1: Top 20 features that best distinguish Android SMS fraud malware from goodware using the Extra-Trees classifier</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_269"/><span epub:type="pagebreak" id="page_270"/>In <a href="ch10.xhtml">Chapter 10</a>, we noted that apps can use the <code>ACCESS_WIFI_STATE</code> permission to access the Android <code>WifiManager</code> and get the state of the device’s Wi-Fi connection. SMS fraud happens over the telephony stack rather than the Wi-Fi stack; even so, multiple SMS fraud families attempt to understand the device’s Wi-Fi state. This may be because these apps want to have the Wi-Fi stack as a backup option. The probability of this permission being requested by SMS fraud apps is almost exactly twice that of its being requested by goodware.</p>&#13;
<p class="indent">Apps use the <code>GET_TASKS</code> permission to identify the processes running on the device. Almost 70 percent of apps engaging in SMS fraud request this permission, compared to less than than 20 percent of goodware. Malicious apps may seek this permission for a number of reasons, such as to see whether there is an antivirus engine running.</p>&#13;
<p class="indent">The <code>SYSTEM_ALERT_WINDOW</code> permission is used to display notification windows, presumably to inform the user of legitimate issues. However, SMS fraud apps may use this capability to obscure the screen. For instance, if the compromised device’s mobile carrier sends a request to authenticate a potential SMS fraud transaction, this permission may enable the malware to obscure the window while it responds to the incoming text. The probability of SMS fraud apps requesting this permission is four to five times higher than the probability of goodware doing so.</p>&#13;
<h4 class="h4" id="ch11lev1sec2"><strong><em>The Absence of SMS Permissions</em></strong></h4>&#13;
<p class="noindent">The absence of SMS-related permissions in the top 20 features list may have surprised you. Surely, an SMS fraud app needs to write and send SMS messages in order to carry out its malicious work. If we look at the top 50 features, we’ll find the <code>WRITE_SMS</code> permission in position 33, suggesting that this permission is indeed somewhat important for distinguishing SMS fraud apps from goodware.</p>&#13;
<p class="indent">Still, the scarcity of other SMS-related permissions is puzzling. Because different classifiers identify the important features in different ways, we therefore checked whether other classifiers would consider these permissions more relevant. <a href="ch11.xhtml#ch11fig2">Figure 11-2</a> shows the top 20 features generated by the random forest classifier.</p>&#13;
<p class="indent">As you can see, this classifier uses very different features from the Extra-Trees classifier to separate goodware from SMS fraud apps. In fact, it ranks <code>SEND_SMS</code> as the most important feature! The probability of apps engaging in SMS fraud requesting this permission is over eight times that of goodware requesting it, according to this model. The <code>RECEIVE_SMS</code>, <code>WRITE_SMS</code>, and <code>READ_SMS</code> permissions all also appear in the list of top 20 features, with SMS fraud apps requesting all of them far more frequently than goodware.</p>&#13;
<p class="indent">We also looked at the top features suggested by the XGBoost classifier, shown in <a href="ch11.xhtml#ch11fig3">Figure 11-3</a>. Here too, we saw a different set of features identified as important, and <code>SEND_SMS</code> and <code>RECEIVE_SMS</code> appear in the top 20.</p>&#13;
<div class="image"><img id="ch11fig2" src="../images/ch11fig02.jpg" alt="Image" width="1874" height="922"/></div>&#13;
<p class="figcap"><em>Figure 11-2: Top 20 features that best distinguish Android SMS fraud malware from goodware using the random forest classifier</em></p>&#13;
<div class="image"><img id="ch11fig3" src="../images/ch11fig03.jpg" alt="Image" width="1872" height="922"/></div>&#13;
<p class="figcap"><em>Figure 11-3: Top 20 features that best distinguish Android SMS fraud malware from goodware using the XGBoost classifier</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_271"/><span epub:type="pagebreak" id="page_272"/><span epub:type="pagebreak" id="page_273"/>As these results indicate, different machine learning methods may identify different features as being the most important. For example, one method might consider every feature from the total set of features and measure the value of each by calculating the drop in predictive performance of a machine learning algorithm when that feature is removed. The greater the drop, the more important the feature is. Other methods might use well-known statistical models, such as mutual information or principal component analysis (PCA). In addition to the statistical methods used, the design and structure of the classifiers themselves influence the identification of different sets of prominent features.</p>&#13;
<p class="indent">Lastly, we constructed a decision tree for separating SMS fraud apps from goodware. You can see the first three levels of the decision tree in <a href="ch11.xhtml#ch11fig4">Figure 11-4</a>.</p>&#13;
<div class="image"><img id="ch11fig4" src="../images/ch11fig04.jpg" alt="Image" width="1401" height="633"/></div>&#13;
<p class="figcap"><em>Figure 11-4: A decision tree with a depth of three for distinguishing Android SMS fraud malware from goodware</em></p>&#13;
<p class="indent">This decision tree branches to the left child of a node when the condition stated in the node is true; otherwise, it branches to the right. The <code>SEND_SMS</code> permission is at level two in the tree, immediately below the root, attesting to the importance that this type of classifier places on it.</p>&#13;
<p class="indent">The right child of this node checks the number of times that classes in the <em>android.content.res</em> <span epub:type="pagebreak" id="page_274"/>package are called in an app’s source code. This package contains classes used to access various files and media, as well as parameters that configure the device. If the number of calls is smaller than or equal to 82.0 and the app requests the <code>SEND_SMS</code> permission, then there is a probability of 1106/1108 (almost 100 percent) of the app being an SMS fraud app.</p>&#13;
<p class="indent">Interestingly, two other branches in this decision tree do not depend at all on the <code>SEND_SMS</code> permission being used, which may explain why the initial set of top 20 features generated by the Extra-Trees classifier didn’t identify any SMS-related permissions. One of the paths checks the following: that there are fewer than 82 calls to classes in the <em>android.content.res</em> package, that the app does not request the <code>SEND_SMS</code> permission, and that there are more than 1.5 calls to classes in <em>org.apache.http.conn.scheme</em>. If all of these conditions are met, there is a 100 percent probability of the app being SMS fraud malware. The other path checks whether there are more than 82 calls to classes in <em>android.content.res</em> and more than 5.5 calls to classes in <em>org.apache.http.conn.scheme</em>, which also results in a 100 percent probability of the app being SMS fraud.</p>&#13;
<p class="indent">The results described in this section teach us a valuable lesson about machine learning for malware analysis: be sure to look at different classifiers for clues about what to examine manually in the code. Looking at the results generated by just one classifier, even one with high performance, may lead to skewed inferences about the importance of particular app elements.</p>&#13;
<h4 class="h4" id="ch11lev1sec3"><strong><em>Prediction Efficacy</em></strong></h4>&#13;
<p class="noindent"><a href="ch11.xhtml#ch11tab1">Table 11-1</a> shows the performance of various machine learning classifiers at predicting whether an app is engaged in SMS fraud or is goodware, given different sets and combinations of basic and advanced features.</p>&#13;
<p class="tabcap" id="ch11tab1"><strong>Table 11-1:</strong> Evaluation of Android SMS Fraud Malware vs. Goodware</p>&#13;
<table class="all">&#13;
<colgroup>&#13;
<col style="width:20%"/>&#13;
<col style="width:20%"/>&#13;
<col style="width:10%"/>&#13;
<col style="width:10%"/>&#13;
<col style="width:10%"/>&#13;
<col style="width:10%"/>&#13;
<col style="width:10%"/>&#13;
<col style="width:10%"/>&#13;
</colgroup>&#13;
<thead>&#13;
<tr>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>Feature set</strong></p></th>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>Best classifier</strong></p></th>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>AUC</strong></p></th>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>Precision</strong></p></th>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>Recall</strong></p></th>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>F1</strong></p></th>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>FPR</strong></p></th>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>FNR</strong></p></th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">API package</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">GBDT</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.9862</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.9483</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.9161</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.9319</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.0517</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.0293</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">Static (S</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">RF</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9792</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9780</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9208</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9485</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.0220</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.0275</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">Dynamic (S)</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">MLP</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.9056</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.8972</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.5759</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.7015</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.1028</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.1332</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">S + D</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">XGBoost</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9810</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9819</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9208</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9504</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.0181</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.0274</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">API + S + D</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">XGBoost</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.9975</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.9837</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.9642</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.9738</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.0163</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.0126</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">TSG</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">XGBoost</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9872</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9463</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9142</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9300</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.0537</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.0300</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">LM</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">RF</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.8737</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.6654</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.6748</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.6701</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.3346</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.1157</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">FC</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">SVM</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.8833</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9127</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.5024</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.6480</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.0873</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.1519</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">CG</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">RF</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.8519</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.9000</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.6532</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.7570</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.1000</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.1119</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">API + S + D + TSG</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">XGBoost</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9457</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.8845</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.8803</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.8824</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.1155</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.1199</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">API + S + D + LM</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">RF</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.9975</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.9827</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.9661</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.9743</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.0173</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.0119</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">API + S + D + FC</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">GBDT</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9974</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9837</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9651</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9743</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.0163</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.0123</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">API + S + D + CG</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">XGBoost</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.9975</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.9827</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.9642</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.9734</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.0173</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.0126</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">All features</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">XGBoost</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9974</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9827</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9642</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9734</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.0173</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.0126</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">Best late fusion</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">XGBoost</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.9973</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.9809</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.9670</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent"><strong>0.9739</strong></p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.0191</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.0116</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent">As these results show, using the late fusion approach, machine learning techniques are able to generate excellent results, with a precision of over 98 percent and a recall of over 96 percent.</p>&#13;
<h3 class="h3" id="ch11lev2"><strong>SMS Fraud vs. Other Malware</strong></h3>&#13;
<p class="noindent"><span epub:type="pagebreak" id="page_275"/><a href="ch11.xhtml#ch11fig5">Figure 11-5</a> shows the 20 most important features for distinguishing SMS fraud apps from other forms of malware, according to the Extra-Trees classifier. As you can see, SMS-related permissions play an important role here, so we’ll focus on those.</p>&#13;
<h4 class="h4" id="ch11lev1sec4"><strong><em>Permission-Related Features</em></strong></h4>&#13;
<p class="noindent">Although the Extra-Trees classifier does not rely on SMS-related permissions for distinguishing SMS fraud malware from goodware, it does find them useful for distinguishing this type of malware from other forms. Around 70 percent of SMS fraud apps seek the <code>SEND_SMS</code>, <code>READ_SMS</code>, and <code>RECEIVE_SMS</code> permissions, compared to less than 20 percent of other malware. Likewise, 50 percent of SMS fraud apps seek the <code>WRITE_SMS</code> permission, compared to about 20 percent of other malware. You might be wondering why some SMS fraud apps don’t need these permissions. The reason is that certain of these apps trick the user into sending premium SMS messages themselves. This doesn’t require the <code>SEND_SMS</code> permission; the app opens the default SMS app and hopes that the user will click the Send button on their own.</p>&#13;
<p class="indent">On a related note, we see that SMS fraud apps are more than twice as likely as other types of malware to request the <code>CALL_PHONE</code> permission (over 40 percent do, compared to less than 20 percent of other malware). One explanation for this difference could be that some SMS fraud families also dabble in other forms of telephony-related fraud. For example, the RuPlay family contains code to redirect outgoing calls to a phone number provided by the malware developers, while the BeeKeeper family contains code to both redirect outgoing calls and make new phone calls to these numbers. Redirecting outgoing calls also requires the <code>PROCESS_OUTGOING_CALLS</code> permission, which enables apps to learn about outgoing calls in the first place.</p>&#13;
<div class="image"><img id="ch11fig5" src="../images/ch11fig05.jpg" alt="Image" width="1900" height="948"/></div>&#13;
<p class="figcap"><span epub:type="pagebreak" id="page_276"/><em>Figure 11-5: Top 20 features that best distinguish Android SMS fraud malware from other malware using the Extra-Trees classifier</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_277"/><span epub:type="pagebreak" id="page_278"/>Also of note is that SMS fraud apps access the <code>READ_LOGS</code>, <code>ACCESS_WIFI_STATE</code>, and <code>RESTART_PACKAGES</code> permissions less frequently than other malware. However, like ransomware, they invoke the functions <code>org.apache.http.conn</code> and <code>org.apache.http.conn.schema</code> more frequently than other forms of malware. The same is also true for <code>org.apache.http.params</code> as well as some Android APIs, such as those from the packages <em>android.app</em>, <em>android.net</em>, <em>android.content</em>, and <em>android.content.pm</em>.</p>&#13;
<h4 class="h4" id="ch11lev1sec5"><strong><em>Prediction Efficacy</em></strong></h4>&#13;
<p class="noindent"><a href="ch11.xhtml#ch11tab2">Table 11-2</a> shows how our machine learning approaches perform at distinguishing between apps engaging in SMS fraud and other forms of malicious apps.</p>&#13;
<p class="tabcap" id="ch11tab2"><strong>Table 11-2:</strong> Metrics for Evaluating Android SMS Fraud Malware vs. Other Malware</p>&#13;
<table class="all">&#13;
<colgroup>&#13;
<col style="width:20%"/>&#13;
<col style="width:20%"/>&#13;
<col style="width:10%"/>&#13;
<col style="width:10%"/>&#13;
<col style="width:10%"/>&#13;
<col style="width:10%"/>&#13;
<col style="width:10%"/>&#13;
<col style="width:10%"/>&#13;
</colgroup>&#13;
<thead>&#13;
<tr>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>Feature set</strong></p></th>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>Best classifier</strong></p></th>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>AUC</strong></p></th>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>Precision</strong></p></th>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>Recall</strong></p></th>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>F1</strong></p></th>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>FPR</strong></p></th>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>FNR</strong></p></th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">API package</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">XGBoost</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.8075</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.8135</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.7921</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.8027</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.1865</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.2043</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">Static (S)</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">XGBoost</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.7739</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.7652</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.7926</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.7787</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.2348</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.2165</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">Dynamic (D)</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">RF</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.6756</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.6395</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.6739</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.6563</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.3605</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.3470</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">S + D</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">GBDT</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.7949</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.7977</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.7827</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.7901</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.2023</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.2151</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">API + S + D</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">GBDT</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.8209</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.8088</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.8172</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.8129</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.1912</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.1856</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">TSG</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">RF</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.7097</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.7110</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.7097</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.7104</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.2890</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.2917</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">LM</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">RF</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.7443</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.7611</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.5992</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.6705</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.2389</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.3328</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">FC</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">SVM</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.5459</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.5222</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.6211</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.5674</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.4778</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.4713</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">CG</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">RF</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.7443</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.7611</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.5992</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.6705</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.2389</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.3328</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">API + S + D + TSG</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">GBDT</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9180</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.8619</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.8351</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.8483</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.1381</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.1610</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">API + S + D + LM</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">XGBoost</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.8718</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.8385</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.7667</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.8010</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.1615</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.2166</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">API + S + D + FC</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">GBDT</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.8791</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.8388</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.7653</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.8004</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.1612</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.2171</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">API + S + D + CG</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">GBDT</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.8983</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.8688</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.7912</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.8282</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.1312</p></td>&#13;
<td style="vertical-align: top" class="gray tab"><p class="noindent">0.1932</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">All features</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">XGBoost</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.9168</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.8635</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.8285</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.8456</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.1365</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">0.1659</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">Best late fusion</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">XGBoost</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.9377</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.9273</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.9075</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent"><strong>0.9173</strong></p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.0727</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">0.0750</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent">Not surprisingly, predictive accuracy decreases when separating SMS fraud apps from other malware. Precision drops to under 93 percent, while recall drops to just below 92 percent. Nevertheless, these are still strong results.</p>&#13;
<h3 class="h3" id="ch11lev3"><strong>BeeKeeper: A Case Study</strong></h3>&#13;
<p class="noindent">Let’s take a look at the BeeKeeper SMS fraud malware <em>angrybirds.app</em> (v16, 51fe). Widely distributed around 2013, the malware targeted the Russian Beeline carrier. <a href="ch11.xhtml#ch11lis1">Listing 11-1</a> shows the list of permissions requested by the app.</p>&#13;
<pre>android.permission.READ_PHONE_STATE&#13;
android.permission.SEND_SMS&#13;
android.permission.RECEIVE_SMS&#13;
android.permission.INTERNET&#13;
android.permission.WAKE_LOCK&#13;
android.permission.DELETE_PACKAGES&#13;
android.permission.READ_SMS&#13;
android.permission.MODIFY_PHONE_STATE&#13;
android.permission.CALL_PHONE&#13;
android.permission.CALL_PRIVILEGED&#13;
android.permission.PROCESS_OUTGOING_CALLS&#13;
android.permission.WRITE_CONTACTS&#13;
android.permission.WRITE_EXTERNAL_STORAGE&#13;
android.permission.READ_CONTACTS&#13;
android.permission.RECEIVE_BOOT_COMPLETED&#13;
android.permission.RECEIVE_BOOT_COMPLETED&#13;
android.permission.ACCESS_WIFI_STATE&#13;
android.permission.BLUETOOTH&#13;
android.permission.INTERNET</pre>&#13;
<p class="list" id="ch11lis1"><em>Listing 11-1: All permissions requested by the BeeKeeper SMS fraud malware</em></p>&#13;
<p class="indent">You can see that it requests permissions like <code>SEND_SMS</code>, which is necessary for sending the text messages that perpetrate SMS fraud, and <code>RECEIVE_SMS</code>, which the malware uses to receive command-and-control messages over SMS when a network connection to its internet-based command-and-control server is unavailable. The <code>CALL_PHONE</code> and <code>PROCESS_OUTGOING_CALLS</code> permissions are also noteworthy. BeeKeeper uses these to make phone calls to numbers received from its command-and-control server and redirect outgoing calls to other numbers.</p>&#13;
<p class="indent"><a href="ch11.xhtml#ch11lis2">Listing 11-2</a> shows one of the several code sections involved in sending SMS fraud messages.</p>&#13;
<pre>public boolean load(Context context) {&#13;
  boolean result = false;&#13;
  log("Settings::load() start");&#13;
  try {&#13;
    Constants.imei = getImei(context);&#13;
    Constants.imsi = getImsi(context);&#13;
    Constants.phone = getPhone(context);&#13;
    Constants.country = getCountry(context);&#13;
    if (Constants.DEBUG) {&#13;
      Constants.imsi = "25001";&#13;
      Constants.data = decript("VY/atwQCBfBnL/CUcJj8Wf0+uk4xyqpeOhWE273WS5...")&#13;
    }&#13;
    log("json settings: " + new JSONObject(Constants.data).toString(4));&#13;
    SharedPreferences sharedPreferences = context.getSharedPreferences(&#13;
      SETTINGS, 1);&#13;
    if (sharedPreferences.contains("first")) {&#13;
      userAgree = sharedPreferences.getBoolean("userAgree", false);&#13;
      userCancel = sharedPreferences.getBoolean("userCancel", false);&#13;
      this.subscriptionTime = sharedPreferences.getLong("subscriptionTime", 0);&#13;
      this.repeatTime = sharedPreferences.getLong("repeatTime", 0);&#13;
      this.subscriptionPhone = sharedPreferences.getString(&#13;
        "subscriptionPhone", "");&#13;
      this.subscriptionMessage = sharedPreferences.getString(&#13;
        "subscriptionMessage", "");&#13;
      JSONArray jsonOperatorList = new JSONArray(&#13;
        sharedPreferences.getString("operators", ""));&#13;
      this.operators = new Vector&lt;&gt;();&#13;
      for (int i = 0; i &lt; jsonOperatorList.length(); i++) {&#13;
        JSONObject jsonOperator = jsonOperatorList.getJSONObject(i);&#13;
        Operator operator = new Operator();&#13;
        operator.name = jsonOperator.getString("name");&#13;
        operator.time = jsonOperator.getLong("time");&#13;
        this.operators.add(operator);&#13;
      }&#13;
      result = true;&#13;
    }&#13;
  } catch (Exception ex2) {&#13;
    ex2.printStackTrace();&#13;
  }&#13;
  log("Settings::load() end");&#13;
  return result;&#13;
}&#13;
&#13;
static void sendSms(JSONObject item) {&#13;
  try {&#13;
    Settings.sendSms(item.getString("phone"), item.getString&#13;
(Constants.JSON_TEXT));&#13;
  } catch (Exception ex) {&#13;
    Settings.log(ex);&#13;
  }&#13;
}</pre>&#13;
<p class="list" id="ch11lis2"><em>Listing 11-2: A heavily obfuscated code snippet showing the BeeKeeper SMS fraud malware sending SMS messages</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_279"/>You can see the app extracting the compromised device’s IMEI and IMSI numbers, its phone number, and its country. A very long encoded string argument passed to the <code>decript</code> method (which we’ve shortened here for brevity) is found inside an <code>if</code> statement whose condition is always false. We cannot be sure why the malware’s author made this choice; perhaps they wanted to prevent it from executing during testing, which they did by setting the <code>if</code> condition to false, and then never turned it back on. Lastly, the app acquires subscription information and executes the <code>sendSms</code> function.</p>&#13;
<h3 class="h3" id="ch11lev4"><strong>Predictions for SMS Fraud Samples</strong></h3>&#13;
<p class="noindent"><span epub:type="pagebreak" id="page_280"/><a href="ch11.xhtml#ch11tab3">Table 11-3</a> shows how our machine learning classifiers performed on 10 important SMS fraud samples.</p>&#13;
<p class="tabcap" id="ch11tab3"><strong>Table 11-3:</strong> Performance of Machine Learning Classifiers on SMS Fraud Families</p>&#13;
<table class="all">&#13;
<colgroup>&#13;
<col style="width:35%"/>&#13;
<col style="width:30%"/>&#13;
<col style="width:30%"/>&#13;
</colgroup>&#13;
<thead>&#13;
<tr>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>Sample name</strong></p></th>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>Distinguished from goodware</strong></p></th>&#13;
<th class="table-h" style="vertical-align: top"><p class="noindent-tab"><strong>Distinguished from other malware</strong></p></th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">BeeKeeper</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">Yes</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">Yes</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">Camera</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">Yes</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">No</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">HDC Bookmark</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">Yes</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">Yes</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">Joker</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">Yes</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">No</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">Moundial</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">Yes</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">Yes</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">RuFraud</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">Yes</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">Yes</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">RuPlay</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">Yes</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">Yes</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">TaiClipHot</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">Yes</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">Yes</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">Wallpaper</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">Yes</p></td>&#13;
<td style="vertical-align: top" class="gray"><p class="noindent">Yes</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top"><p class="noindent-tab">WallySMS</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">Yes</p></td>&#13;
<td style="vertical-align: top"><p class="noindent-tab">Yes</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent">As you can see, in every case, they (that is, our late fusion ensemble) correctly classified the samples as SMS fraud apps rather than goodware. However, there were two prediction errors when we used the classifiers to determine whether the samples were SMS fraud apps or another form of malware. Importantly, one of these errors occurred when classifying Joker, a malware family likely created by a large criminal syndicate that has taken extensive steps to evade detection. The malware’s many variants incorporate one evasion strategy after another in a cat-and-mouse game that has been going on since 2016, leading to increasingly complex anti-analysis methods.</p>&#13;
<h3 class="h3" id="ch11lev5"><strong>Up Next</strong></h3>&#13;
<p class="noindent">As you’ve seen in this chapter, machine learning models provided with a combination of features are able to successfully predict whether an app is goodware or an SMS fraud app. Permissions play a major role in these apps’ behavior and are also significant factors that distinguish SMS fraud apps from other Android malware. However, you’ve also seen that no single feature discussed since <a href="ch07.xhtml">Chapter 7</a> can, on its own, identify a particular kind of malware.</p>&#13;
<p class="indent">To maximize detection effectiveness, we recommend using these machine learning methods in conjunction with the manual analysis techniques described in <a href="part2.xhtml">Part II</a>. Use the machine learning models as a triage system, similar to the process employed in a hospital emergency room: analysts should first examine apps flagged as highly likely to be malicious before specialists take a deeper look.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_281"/>This is the last malware category chapter. In the next and final chapter, we will share our thoughts on the future of Android malware and the future of malware detection with machine learning.<span epub:type="pagebreak" id="page_282"/></p>&#13;
</div>
</div>
<div style="float: none; margin: 10px 0px 10px 0px; text-align: center;"><p><a href="https://oceanofpdf.com"><i>OceanofPDF.com</i></a></p></div></body></html>