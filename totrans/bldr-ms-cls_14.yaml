- en: Chapter 14. Rendering and Compositing
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '第14章 渲染与合成  '
- en: In this chapter, we move into the final stages of the projects as we turn each
    of the scenes into rendered images and tweak them to look their best. We begin
    by looking at Blender’s render settings, both for Blender Internal and Cycles,
    to determine how to get the best render in the shortest time possible. Following
    that discussion, I’ll cover using Blender’s node-based compositor to further refine,
    adjust, and grade these renders into final images. Finally, we’ll make a few tweaks
    to the renders in GIMP.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '在本章中，我们将进入项目的最后阶段，将每个场景转化为渲染图像，并调整它们使其看起来最佳。我们首先查看 Blender 的渲染设置，包括 Blender
    Internal 和 Cycles，以确定如何在最短的时间内获得最佳渲染效果。随后，我将介绍如何使用 Blender 的基于节点的合成器进一步优化、调整并调色，将这些渲染图像处理成最终图像。最后，我们将使用
    GIMP 对渲染图像做些许调整。  '
- en: The Render Tab
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '渲染选项卡  '
- en: We touched on the Render tab of the Properties editor when we used it to bake
    textures in [Chapter 10](ch10.html "Chapter 10. Texture Baking"). In this chapter,
    we’ll examine the other settings available in this tab. Many of these depend on
    which renderer is being used—Blender Internal or Cycles—so we will look at each
    in turn.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在[第10章](ch10.html "第10章. 纹理烘焙")中曾使用渲染选项卡来烘焙纹理。在本章中，我们将深入研究此选项卡中的其他设置。许多设置取决于使用的渲染器——Blender
    Internal 或 Cycles——因此我们将依次查看每种渲染器。
- en: Rendering with Blender Internal
  id: totrans-4
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '使用 Blender Internal 渲染  '
- en: The Render tab in Blender Internal is shown in [Figure 14-1](ch14.html#render_tab_of_the_properties_editorcomma
    "Figure 14-1. The Render tab of the Properties editor, shown here in Blender Internal").
    Let’s look at the settings available in each panel.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 'Blender Internal 的渲染选项卡如图 [14-1](ch14.html#render_tab_of_the_properties_editorcomma
    "图 14-1. Blender Internal 中的属性编辑器渲染选项卡") 所示。让我们来看看每个面板中的可用设置。  '
- en: Render Panel
  id: totrans-6
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '渲染面板  '
- en: This contains buttons for rendering your animation and playing back the results.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '这里包含了渲染动画和回放结果的按钮。  '
- en: '****Image/Animation****. These buttons render the current frame (F12) or every
    frame in the range set by the Frame Range settings in the Dimensions panel as
    an animation (CTRL-F12). You can play back the rendered animation with the play
    button.'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '****图像/动画****。这些按钮渲染当前帧（F12），或者渲染由“尺寸”面板中的“帧范围”设置指定的帧范围内的每一帧作为动画（CTRL-F12）。你可以通过播放按钮回放渲染后的动画。  '
- en: '****Display****. Display lets you set where the rendered image will appear.
    The Image editor option will render the image in an available UV Image editor
    if possible, or it will temporarily switch one of the other editors into a UV
    Image editor during rendering if necessary. The other options allow you to render
    full screen, in a new window, or in the background (Keep UI).'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '****显示****。显示设置让你设定渲染后的图像将显示的位置。如果可能，图像编辑器选项将渲染图像到一个可用的 UV 图像编辑器中，或者如果需要，渲染时临时切换其他编辑器为
    UV 图像编辑器。其他选项允许你全屏渲染、在新窗口中渲染，或在后台渲染（保持 UI）。  '
- en: '![The Render tab of the Properties editor, shown here in Blender Internal](httpatomoreillycomsourcenostarchimages1538852.png.jpg)Figure 14-1. The
    Render tab of the Properties editor, shown here in Blender Internal'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '![Blender Internal 中属性编辑器的渲染选项卡](httpatomoreillycomsourcenostarchimages1538852.png.jpg)
    图 14-1. Blender Internal 中属性编辑器的渲染选项卡  '
- en: Layers Panel
  id: totrans-11
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '层面板  '
- en: The Layers panel contains tools and options for creating different render layers
    and for choosing which scene layers contribute to your final renders. At the top
    of the panel, the Layer selector lets you select the render layer to work on.
    Use the checkboxes on the right to enable or disable rendering particular layers;
    use the + and **–** buttons on the right to add or delete render layers.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '层面板包含了创建不同渲染层的工具和选项，以及选择哪些场景层会对最终渲染产生影响。面板顶部的层选择器让你选择要处理的渲染层。右侧的复选框用于启用或禁用渲染特定的层；右侧的
    + 和 **–** 按钮用于添加或删除渲染层。  '
- en: '****Name****. This allows you to name the selected layer.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '****名称****。这个选项允许你为选中的层命名。  '
- en: '****Scene/Layer/Mask Layer****. These three sets of checkboxes let you choose
    which scene layers are used in your final renders and how. Enabling a layer under
    Scene turns the layer on in the 3D Viewport (just as the layers checkboxes in
    the 3D viewport header do). Layers must be checked under Scene to be renderable.
    Enable layers under Layer to make them render for the currently selected render
    layer; you can have multiple layers turned on under Scene, but only those checked
    under Layer will be rendered. Layers checked under Mask (but not under Layer)
    will mask out geometry on other layers, as shown in [Figure 14-2](ch14.html#using_layers_as_mask_layersdot_here_the
    "Figure 14-2. Using layers as mask layers. Here the monkey object is placed on
    layer 2, with everything else on layer 1\. On the left, both layers are checked
    under Layer, and everything renders as expected. On the right, layer 2 is used
    as a mask layer instead, so you see a transparent hole where the monkey head obscures
    the other objects.").'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '****场景/图层/蒙版图层****。这三个复选框组让您选择在最终渲染中使用哪些场景图层，以及如何使用它们。在场景下启用某个图层会使该图层在3D视口中显示（就像在3D视口头部的图层复选框一样）。图层必须在场景下勾选，才能进行渲染。在图层下启用图层，使其在当前选定的渲染图层中渲染；您可以在场景下打开多个图层，但只有在图层下勾选的图层会被渲染。在蒙版下勾选的图层（但未在图层下勾选）会遮挡其他图层中的几何体，如[图14-2](ch14.html#using_layers_as_mask_layersdot_here_the
    "图14-2 使用图层作为蒙版图层。这里猴子对象放在图层2上，其他所有对象都在图层1上。左侧，两个图层都在图层下勾选，一切正常渲染。右侧，图层2被用作蒙版图层，因此你会看到猴子头部遮挡其他物体的地方是透明的孔洞。")所示。'
- en: '****Light****. The Light option lets you specify a group of lights to be treated
    as the only lights in the scene when rendered.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '****光源****。光源选项允许您指定一组光源，在渲染时将其作为场景中的唯一光源进行处理。'
- en: '****Material****. As discussed in [Clay Renders and Material Override](ch13.html#clay_renders_and_material_override
    "Clay Renders and Material Override"), the Materials option lets you override
    the materials for a scene with a single material when rendering. We used this
    option in [Chapter 13](ch13.html "Chapter 13. Lighting") to produce a clay render
    of the Bat Creature project in order to test the lighting.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '****材质****。如[粘土渲染与材质覆盖](ch13.html#clay_renders_and_material_override "粘土渲染与材质覆盖")中所讨论的，材质选项允许您在渲染时使用单一材质覆盖场景中的材质。在[第13章](ch13.html
    "第13章 光照")中，我们使用此选项对蝙蝠生物项目进行粘土渲染，以便测试光照效果。'
- en: '****Include****. This offers a number of checkboxes that detail the types of
    surfaces and effects to be rendered with this layer. For example, you can turn
    on or off the rendering of *z*-transparent materials, fur, or solid materials.'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '****包含****。此选项提供多个复选框，详细描述了在渲染此图层时需要呈现的表面类型和效果。例如，您可以开启或关闭渲染*z*透明材料、毛发或固体材料。'
- en: '****Passes****. Within a layer, Blender can render other kinds of information
    and split up aspects of an image into different passes, such as shadows, environment
    lighting, and *z*-depth (the distance from the camera). This pass then contains
    only that data that can be used in compositing the final image. For example, you
    could use the *z*-depth pass as the input for a Defocus node to create depth of
    field, or you could use an ambient occlusion pass to add extra shadows to an image.
    Use the checkboxes under Passes to enable or disable various passes. Some passes
    can be excluded from the main render pass by toggling the camera icon to the right
    of the pass’s name.'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '****通道****。在一个图层内，Blender可以渲染其他类型的信息，并将图像的各个方面分割成不同的通道，例如阴影、环境光照和*z*深度（从相机到物体的距离）。该通道只包含这些数据，可以用于合成最终图像。例如，您可以使用*z*深度通道作为Defocus节点的输入来创建景深效果，或者使用环境光遮蔽通道为图像添加额外的阴影。使用通道下的复选框来启用或禁用不同的通道。通过切换通道名称右侧的相机图标，某些通道可以从主渲染通道中排除。'
- en: Dimensions
  id: totrans-19
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 尺寸
- en: This panel lets you set the dimensions in time (frames) and space (resolution)
    of your render or animation. The Resolution settings let you choose the size of
    your final render, while the Frame Range settings are used to specify the number
    of frames in your animation. Aspect Ratio sets the aspect ratio for the pixels
    in the image (some video formats use nonsquare pixels, but for stills, always
    use square 1:1 ratio pixels).
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 此面板允许您设置渲染或动画的时间（帧）和空间（分辨率）维度。分辨率设置让您选择最终渲染的大小，而帧范围设置用于指定动画中的帧数。宽高比设置图像像素的宽高比（某些视频格式使用非方形像素，但对于静态图像，总是使用方形1:1像素）。
- en: '![Using layers as mask layers. Here the monkey object is placed on layer 2,
    with everything else on layer 1\. On the left, both layers are checked under Layer,
    and everything renders as expected. On the right, layer 2 is used as a mask layer
    instead, so you see a transparent hole where the monkey head obscures the other
    objects.](httpatomoreillycomsourcenostarchimages1538854.png.jpg)Figure 14-2. Using
    layers as mask layers. Here the monkey object is placed on layer 2, with everything
    else on layer 1\. On the left, both layers are checked under Layer, and everything
    renders as expected. On the right, layer 2 is used as a mask layer instead, so
    you see a transparent hole where the monkey head obscures the other objects.'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '![使用图层作为遮罩图层。这里猴子物体放置在图层 2 上，其他所有物体放置在图层 1 上。左侧，两个图层都在“图层”下勾选，一切按预期渲染。右侧，图层
    2 被用作遮罩图层，因此你可以看到猴子头部遮挡其他物体的位置，形成透明空洞。](httpatomoreillycomsourcenostarchimages1538854.png.jpg)图
    14-2. 使用图层作为遮罩图层。这里猴子物体放置在图层 2 上，其他所有物体放置在图层 1 上。左侧，两个图层都在“图层”下勾选，一切按预期渲染。右侧，图层
    2 被用作遮罩图层，因此你可以看到猴子头部遮挡其他物体的位置，形成透明空洞。'
- en: You can use the Border and Crop settings to render a small patch of your image
    rather than the whole thing. To do so, switch to the camera view in the 3D Viewport
    (NUMPAD 0). Then press SHIFT-B and drag out a rectangle over the area you wish
    to restrict the render to. This will automatically enable the Border setting.
    Use the Crop setting to reduce an image’s dimensions to the size of your border
    region; otherwise, the remaining area will be filled with black.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用边框和裁剪设置来渲染图像的一小部分，而不是整个图像。为此，切换到 3D 视口中的相机视图（NUMPAD 0）。然后按下 SHIFT-B 并拖动出一个矩形，覆盖你希望限制渲染区域的部分。这将自动启用边框设置。使用裁剪设置将图像的尺寸缩小到你的边框区域的大小；否则，剩余区域将被填充为黑色。
- en: Anti-Aliasing and Motion Blur
  id: totrans-23
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 抗锯齿和运动模糊
- en: 'Aliasing is an artifact in a pixel-based image where sharp boundaries may look
    jagged due to the finite resolution of the image (see [Figure 14-3](ch14.html#anti-aliasing_reduces_the_appearance_of
    "Figure 14-3. Anti-aliasing reduces the appearance of jagged edges in renders.
    Left: No anti-aliasing. Right: Anti-aliasing turned on with the number of subsamples
    set to 8.")). Aliasing is often most obvious on the outlines of objects or shadows,
    but it can also crop up in textures or specular highlights. Anti-aliasing addresses
    this problem by taking multiple subsamples of each pixel with slightly different
    offsets and blending them, resulting in a smoother-looking boundary, as you can
    see in the figure.'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 锯齿效应是像素图像中的一种伪影，因图像的有限分辨率导致锐利的边界看起来呈锯齿状（参见[图 14-3](ch14.html#anti-aliasing_reduces_the_appearance_of
    "图 14-3. 抗锯齿减少渲染中锯齿边缘的出现。左：无抗锯齿。右：开启抗锯齿并将子采样数量设置为 8。")）。锯齿效应通常最明显出现在物体的轮廓或阴影上，但它也可能出现在纹理或高光中。抗锯齿通过对每个像素进行多个子采样，偏移略有不同并将其混合，从而解决这个问题，生成更加平滑的边界，正如图中所示。
- en: '![Anti-aliasing reduces the appearance of jagged edges in renders. Left: No
    anti-aliasing. Right: Anti-aliasing turned on with the number of subsamples set
    to 8.](httpatomoreillycomsourcenostarchimages1538856.png.jpg)Figure 14-3. Anti-aliasing
    reduces the appearance of jagged edges in renders. Left: No anti-aliasing. Right:
    Anti-aliasing turned on with the number of subsamples set to 8.'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '![抗锯齿减少渲染中锯齿边缘的出现。左：无抗锯齿。右：开启抗锯齿并将子采样数量设置为 8。](httpatomoreillycomsourcenostarchimages1538856.png.jpg)图
    14-3. 抗锯齿减少渲染中锯齿边缘的出现。左：无抗锯齿。右：开启抗锯齿并将子采样数量设置为 8。'
- en: 'Use the numbers on the left of the Anti-Aliasing panel to determine how many
    samples will be taken (more samples will result in smoother renders but longer
    render times). The drop-down menu on the right sets the type of filter used to
    blend the samples: The default of Mitchell-Netravali gives good results without
    taking too much sharpness out of the render, but when working with higher-resolution
    images, try Gaussian. Use the Full Sample option to make Blender maintain each
    sample separately, even during compositing, which can help with aliasing issues
    at the compositing stage.'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 使用抗锯齿面板左侧的数字来确定将进行多少个采样（更多的采样会导致渲染更加平滑，但渲染时间也会变长）。右侧的下拉菜单设置了用于混合样本的滤镜类型：默认的
    Mitchell-Netravali 滤镜能够在不削弱图像清晰度的情况下提供良好的结果，但当处理高分辨率图像时，可以尝试使用高斯滤镜。使用“完整采样”选项可以让
    Blender 在合成过程中保持每个样本的独立性，这有助于解决合成阶段的锯齿问题。
- en: Sampled motion blur is similar to anti-aliasing in that multiple samples are
    taken per pixel but at different times rather than different locations. This results
    in motion blur for fast-moving objects once the samples are blended together.
    (Essentially, the image is rendered multiple times, and the results are blended.)
    The number of samples is determined by the Motion Samples setting, and the amount
    of time in frames over which the samples are taken is determined by the Shutter
    setting.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 采样运动模糊类似于抗锯齿，不同的是它在不同的时间而不是不同的位置对每个像素进行多次采样。这样在样本合成后，会对快速移动的物体产生运动模糊效果。（本质上，图像被渲染多次，然后将结果混合。）采样的数量由运动采样设置决定，采样时间的帧数由快门设置决定。
- en: Shading
  id: totrans-28
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: Shading
- en: The Shading panel lets you turn on and off different rendering options, including
    Textures, Shadows, Subsurface Scattering, Environment Mapping, and Ray-Tracing
    options. To speed up renders, turn off unneeded shading options.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: Shading 面板让你开启或关闭不同的渲染选项，包括纹理、阴影、次表面散射、环境映射和光线追踪选项。为了加速渲染，可以关闭不需要的阴影选项。
- en: The Alpha drop-down menu lets you choose how to render the background of your
    image. Sky renders the sky colors and textures set in your global settings. The
    Straight Alpha and Premultiplied options render the background of your image as
    transparent. In the case of Premultiplied, the RGB values of transparent or partially
    transparent pixels are multiplied by the alpha value on output. This method of
    encoding alpha values is also referred to as *associated alpha* and is required
    for some image formats, like TIFF and PNG. It’s also useful for compositing because
    combining images this way gives better results, though Blender’s compositor has
    tools for working with both premultiplied and unpremultiplied alpha. Straight
    Alpha skips this step and renders unassociated alpha images instead.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: Alpha 下拉菜单让你选择如何渲染图像的背景。Sky 渲染你在全局设置中设置的天空颜色和纹理。Straight Alpha 和 Premultiplied
    选项将图像的背景渲染为透明。在 Premultiplied 的情况下，透明或部分透明像素的 RGB 值将在输出时与 alpha 值相乘。这种编码 alpha
    值的方法也被称为*关联 alpha*，并且对于某些图像格式（如 TIFF 和 PNG）是必需的。它对于合成也很有用，因为以这种方式合成图像会产生更好的效果，尽管
    Blender 的合成器有工具来处理预乘和非预乘 alpha。Straight Alpha 跳过这一步，而是渲染非关联 alpha 图像。
- en: Note
  id: totrans-31
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*If the above discussion on different methods of encoding alpha values seems
    complex, it’s because it is. I’ve covered it only very briefly here, but it’s
    actually a pretty deep topic. For more information, try searching [http://www.blender.org/](http://www.blender.org/)
    and the Blender wiki for Color Management.*'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '*如果上面关于不同编码 alpha 值方法的讨论让你觉得复杂，那是因为它确实很复杂。我这里只做了非常简要的介绍，但它实际上是一个相当深奥的话题。欲了解更多信息，可以尝试搜索
    [http://www.blender.org/](http://www.blender.org/) 和 Blender Wiki 的颜色管理内容。*'
- en: Performance
  id: totrans-33
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 性能
- en: The Performance panel contains a number of options that can affect how fast
    Blender will render and how much impact rendering will have on your computer’s
    resources. Blender splits up images to be rendered into multiple tiles, which
    are then rendered individually. The most important settings are Threads and Tiles.
    When set to Fixed, these settings let you specify how many tiles will be rendered
    at once (up to twice the number of processor cores you have).
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 性能面板包含一些选项，这些选项会影响 Blender 渲染的速度，以及渲染对你计算机资源的影响。Blender 会将图像分割成多个瓦片，然后逐个瓦片进行渲染。最重要的设置是线程和瓦片。设置为固定时，这些设置允许你指定一次渲染多少瓦片（最多是处理器核心数量的两倍）。
- en: The Tiles settings determine how the image to be rendered is broken up into
    tiles along the *x*- and *y*-axes. Tiles are rendered one at a time per thread,
    meaning that if you have eight threads, you will be able to render eight tiles
    simultaneously.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: Tiles 设置决定了要渲染的图像如何沿 *x* 和 *y* 轴被分割成瓦片。每个线程一次渲染一个瓦片，这意味着如果你有八个线程，你可以同时渲染八个瓦片。
- en: Tweaking the Tiles settings can make a big difference in your render times.
    Using too few tiles can mean that processor threads are left idle once all available
    tiles are being rendered, even if there is plenty of your image left to be rendered.
    Using too many tiles uses more memory without speeding up the render. The optimum
    number of tiles is generally between 16 (4×4) and 64 (8×8), with more complex
    scenes benefiting from more tiles.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 调整Tiles设置可以显著影响你的渲染时间。使用过少的Tiles可能意味着一旦所有可用的Tiles被渲染完，处理器线程就会处于空闲状态，即使图像还有很多内容未渲染。使用过多的Tiles则会消耗更多的内存，而不会加速渲染。最佳的Tiles数量通常在16（4×4）和64（8×8）之间，更复杂的场景可以从更多的Tiles中受益。
- en: The other settings in this panel are even more technical and can usually be
    left at their defaults. For more on these settings, try *[http://wiki.blender.org/](http://wiki.blender.org/)*.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 该面板中的其他设置更加技术性，通常可以保留默认设置。如需了解更多有关这些设置的信息，可以参考*[http://wiki.blender.org/](http://wiki.blender.org/)*。
- en: Post-Processing
  id: totrans-38
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 后期处理
- en: The Post-Processing settings determine the postprocessing effects applied to
    your image. The relevant ones are the checkboxes that turn on Compositing and
    the Sequencer (Compositing should be turned on). Dither adds subtle variation
    to the colors of pixels, preventing color banding in images with smooth gradients.
    The Edge setting draws cartoon lines around an image’s geometry, with the strength
    of the line effect determined by the Threshold setting and the color of the lines
    determined by the color selector directly below the Threshold setting.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 后期处理设置决定了应用于图像的后期处理效果。相关的选项是可以打开合成和序列器的复选框（合成应该被打开）。抖动效果会为像素的颜色添加微妙的变化，防止在具有平滑渐变的图像中出现颜色带状现象。边缘设置会在图像的几何体周围绘制卡通线条，线条效果的强度由阈值设置决定，线条的颜色由阈值设置下方的颜色选择器决定。
- en: Stamp
  id: totrans-40
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: Stamp
- en: The Stamp settings let you stamp your image with data about the render, such
    as the time it was rendered, the filename, the frame number, and so on. Stamp
    is often useful when rendering animations, but it’s not of much use to us for
    our projects.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: Stamp设置允许你在图像上印上有关渲染的数据，例如渲染时间、文件名、帧编号等。在渲染动画时，Stamp非常有用，但对于我们的项目来说并不太有用。
- en: Output
  id: totrans-42
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 输出
- en: The Output settings determine where the output of your renders is saved and
    in what format. Animation frames are saved automatically, but single-frame images
    must be saved manually. The default output directory (*/tmp/* on Mac and Linux
    systems or the Temp folder on Windows) determines where animation frames are saved,
    but you can change this to a directory of your choosing. The output format is
    determined by the drop-down menu, which includes options for what color information
    to save (black and white, RGB, or RGB and alpha).
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 输出设置决定了渲染结果保存的位置和格式。动画帧会自动保存，但单帧图像需要手动保存。默认的输出目录（在Mac和Linux系统上是*/tmp/*，在Windows上是Temp文件夹）决定了动画帧的保存位置，但你可以将其更改为你选择的目录。输出格式由下拉菜单决定，菜单中包括保存颜色信息的选项（黑白、RGB或RGB和Alpha）。
- en: Bake
  id: totrans-44
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 烘焙
- en: These settings are discussed in detail in [Chapter 11](ch11.html "Chapter 11. Texture
    Painting").
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 这些设置在[第11章](ch11.html "第11章. 纹理绘画")中有详细讨论。
- en: Rendering with Cycles
  id: totrans-46
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用Cycles渲染
- en: Many of the Render tab options remain the same in Cycles, so I will just cover
    the important differences here.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在Cycles中，许多渲染选项保持不变，所以我这里只会介绍重要的差异。
- en: Sampling
  id: totrans-48
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 采样
- en: The Sampling panel determines how many samples to calculate for each pixel in
    the image, which is the main way Cycles determines the quality and noisiness of
    your final image. The Render and Preview options determine how many samples to
    render for each pixel in an image before terminating the render. (Use Render for
    proper renders and Preview for the Cycles preview in the 3D Viewport.) More passes
    will result in less noise, but the number of passes required to get a noise-free
    image will vary widely according to the contents of your scene. Seed sets a random
    value for Cycles to use for sampling, and different seeds will produce different
    noise patterns.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 采样面板决定了图像中每个像素计算的样本数量，这是Cycles确定最终图像质量和噪点的主要方式。渲染和预览选项决定在结束渲染之前，每个像素渲染多少样本。（使用渲染进行正式渲染，使用预览进行3D视口中的Cycles预览。）更多的采样次数会减少噪点，但获得无噪点图像所需的次数会根据场景内容的不同而有所不同。种子设置了Cycles用于采样的随机值，不同的种子会产生不同的噪点模式。
- en: You can use the Clamp option to prevent *fireflies*, which are overly bright
    pixels caused by noise from bright lights or specular highlights. To do so, set
    the maximum brightness (the *clamp* value) for a sample to a nonzero number (a
    value of around 3 works well). This keeps overly bright samples from throwing
    off the average value of a pixel too much, though it comes at the cost of some
    accuracy in rendering. (If you leave this at the default of 0, this feature will
    not be used.)
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 Clamp 选项来防止*萤火虫*现象，即由强光源或镜面高光引起的噪点，导致过亮的像素。为此，将样本的最大亮度（*clamp* 值）设置为非零数值（大约
    3 的值效果不错）。这可以防止过亮的样本过度影响像素的平均值，尽管这会牺牲一些渲染的准确性。（如果你保持默认值 0，这个功能将不会启用。）
- en: Light Paths
  id: totrans-51
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: Light Paths
- en: The Light Paths panel supplements the options in the Samples panel, allowing
    you to go deeper into how Cycles renders your scene. Specifically the Light Paths
    panel lets you determine what types of rays to render and how many bounces to
    calculate before terminating a ray. More bounces give more accurate (and slightly
    brighter) renders, at the cost of extra render time.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: Light Paths 面板补充了 Samples 面板中的选项，使你可以更深入地了解 Cycles 渲染场景的方式。具体来说，Light Paths
    面板让你决定渲染哪些类型的光线，以及计算多少次反弹才会终止光线。更多的反弹能提供更准确（且稍微更亮）的渲染效果，但代价是更长的渲染时间。
- en: The Transparency, Light Paths, and Bounce settings define the maximum number
    of light bounces that Cycles will calculate for each type of interaction with
    light. The Max setting sets the overall maximum number of bounces, while the other
    settings restrict specific types of rays to fewer bounces. The Min setting for
    Transparency and Overall Bounces enables early termination of refracted rays,
    resulting in faster rendering with the loss of some accuracy.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: Transparency、Light Paths 和 Bounce 设置定义了 Cycles 在每种光与物体互动时计算的最大光线反弹次数。Max 设置决定了反弹的最大总数，而其他设置则限制特定类型的光线反弹次数。Transparency
    和 Overall Bounces 的 Min 设置可以提前终止折射光线，从而在牺牲一定准确度的情况下加速渲染。
- en: The No Caustics and Shadows options let you turn on and off caustics and ray-traced
    shadows to speed up rendering. Caustics are rays that have been reflected or refracted
    by glossy surfaces that then contribute to diffuse illumination. Examples include
    the bright patterns of sunlight in a swimming pool and light focused by a magnifying
    glass onto a surface.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '"No Caustics and Shadows" 选项允许你开启或关闭焦散和光线追踪阴影，从而加速渲染。焦散是经过光滑表面反射或折射的光线，这些光线会对漫反射光照产生贡献。例如，游泳池中的阳光亮斑和放大镜聚焦的光线在表面上的效果。'
- en: Film
  id: totrans-55
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 电影
- en: You can use the Film panel’s Exposure setting to change the exposure of your
    render to either brighten or darken scenes overall. (However, it’s best to change
    the settings on your lamps instead for finer control.) The Transparency checkbox
    determines whether your background renders as transparent or uses your global
    settings. The drop-down menu on the right sets the pixel filter type (with the
    width of the filter below it). Smaller widths produce sharper-looking edges but
    can cause aliasing. Larger widths give smoother renders at the expense of a small
    amount of blurring.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 Film 面板中的 Exposure 设置来调整渲染的曝光度，从而整体增加或减少场景的亮度。（然而，为了更精细的控制，最好调整灯光的设置。）Transparency
    复选框决定是否以透明背景渲染，或使用全局设置。右侧的下拉菜单设置像素过滤器类型（下方是过滤器的宽度）。较小的宽度会产生更锋利的边缘，但可能会导致锯齿状效果。较大的宽度会带来更平滑的渲染效果，但会有少许模糊。
- en: Layers
  id: totrans-57
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 层
- en: Cycles works much the same as Blender Internal when it comes to layers, but
    it supplies a different range of passes. Cycles will split up each kind of light
    ray (diffuse, glossy, and transmission) into separate passes and can split up
    those passes further into direct and indirect passes. These features can be useful
    when compositing.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 在层方面，Cycles 的工作方式与 Blender Internal 类似，但提供了不同范围的通道。Cycles 会将每种类型的光线（漫反射、光泽和传输）分割为单独的通道，并可以将这些通道进一步细分为直接和间接通道。在合成时，这些功能可能非常有用。
- en: Balancing Render Time and Quality
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 渲染时间与质量的平衡
- en: When rendering any CG scene, the aim is to get the nicest render possible in
    the shortest amount of time. This can be tricky given the number of variables
    you can change, all of which affect how long an image will take to render. Still,
    there are some general principles.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 在渲染任何计算机图形场景时，目标是以最短的时间获得最佳的渲染效果。考虑到可以调整的变量众多，且它们都会影响渲染时间，这可能会有些棘手。不过，依然有一些通用的原则。
- en: '****Start simple and be organized.**** Organize your objects onto layers to
    make it easier to render different aspects of the scene. Also, make sure you don’t
    have any unneeded objects in your scene on visible layers when rendering.'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '****从简单开始并保持有序。**** 将你的物体组织到图层中，这样更容易渲染场景的不同部分。同时，确保在渲染时没有任何不需要的物体出现在可见图层上。'
- en: '****Experiment.**** If your renders are slow, try changing one setting at a
    time to see what most affects your render times. For example, change a render
    setting or the number of samples on a lamp. Or enable or disable some aspect of
    a material, such as subsurface scattering or ray-traced reflections. Changing
    one thing at a time will let you see exactly what makes the most difference, whereas
    changing multiple settings forces you to guess which one altered your render time.
    If you find that something in particular is slowing down your renders without
    contributing much to the final image, get rid of it.'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '****实验。**** 如果你的渲染速度很慢，尝试一次改变一个设置，看看哪个设置对渲染时间影响最大。例如，改变渲染设置或灯光的采样数，或者启用或禁用材质的某个方面，比如次表面散射或光线追踪反射。一次只改变一个设置能让你准确看到哪个设置最有影响，而改变多个设置则会让你猜测是哪个设置改变了渲染时间。如果你发现某个设置特别减慢了渲染速度，但对最终图像贡献不大，就把它去掉。'
- en: '****Minimize surplus geometry.**** Once you have the camera angle that you
    want, start getting rid of objects that won’t be seen in your render by deleting
    them or temporarily shifting them to other layers. This will reduce the amount
    of geometry Blender has to keep track of when rendering and will speed up your
    renders! This trick is often helpful when working with environments.'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '****最小化多余的几何体。**** 一旦你找到了想要的相机角度，就开始删除那些在渲染中不会被看到的物体，或者暂时将它们移到其他图层。这样可以减少 Blender
    在渲染时需要追踪的几何体数量，从而加快渲染速度！在处理环境时，这个技巧尤其有用。'
- en: '****Simplify lighting.**** Try to simplify the settings on your lamps and see
    whether you can eliminate some. In particular, look at the shadow settings: Will
    a smaller shadow-buffer resolution really make much difference, or does a ray-traced
    lamp need quite so many samples?'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '****简化光照设置。**** 尝试简化灯光的设置，看看是否可以去除一些灯光。特别是，查看阴影设置：较小的阴影缓冲区分辨率是否真的会有很大差异，还是光线追踪灯光并不需要那么多的采样？'
- en: As you become more familiar with Blender, you’ll soon learn which settings impact
    render time for different aspects of scenes. In the meantime, the time you spend
    experimenting and simplifying your scene will almost always speed up render times.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 随着你对 Blender 越来越熟悉，你将很快学会哪些设置会影响不同场景方面的渲染时间。与此同时，你花费的时间去实验和简化场景，几乎总是能加快渲染时间。
- en: The Compositor
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 合成器
- en: You’ve pressed F12 to render, and your image is finished, right? Not quite.
    Now it’s time to post-process the final renders using Blender’s compositor and
    GIMP. Blender’s compositor is node based and uses the Node editor (which we explored
    in [Editing Node Materials](ch12.html#editing_node_materials "Editing Node Materials")).
    In this section, I’ll show you how to use the compositor to apply effects such
    as depth of field, bloom, and color grading and to combine separate render layers
    into one final image (see [Figure 14-5](ch14.html#default_node_tree_for_blenderapostrophes
    "Figure 14-5. The default node tree for Blender’s compositor is pretty basic.
    Whatever you connect to the sockets of the Composite node will become the final
    output of your render.")). I’ll also show you how to use GIMP for painting and
    touch-up.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 你已经按下了 F12 来渲染，并且图像完成了，对吧？其实不完全是。现在是时候使用 Blender 的合成器和 GIMP 对最终渲染结果进行后期处理了。Blender
    的合成器基于节点，并使用节点编辑器（我们在[编辑节点材质](ch12.html#editing_node_materials "编辑节点材质")一节中探讨过）。在这一节中，我将向你展示如何使用合成器应用效果，比如景深、辉光和色彩分级，以及如何将不同的渲染层合成为一张最终图像（参见[图
    14-5](ch14.html#default_node_tree_for_blenderapostrophes "图 14-5. Blender 合成器的默认节点树很简单。你连接到合成节点插座的任何内容都会成为渲染的最终输出。")）。我还将向你展示如何使用
    GIMP 进行绘画和修饰。
- en: Rendering and Compositing the Bat Creature
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 渲染与合成蝙蝠生物
- en: 'I wanted to show the final Bat Creature on a dark background with a little
    color grading. To facilitate this, I split the rendering into two layers: one
    for the fur and one for the rest of the body. I planned to create a simple, dark-colored
    background in the compositor with a slight vignette to darken the corners and
    keep the focus on the bat.'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 我想在暗色背景上展示最终的蝙蝠生物，并进行一些色彩分级。为了实现这个目标，我将渲染分成了两层：一层用于毛发，另一层用于身体的其余部分。我计划在合成器中创建一个简单的深色背景，并加上轻微的暗角效果来加深角落，保持注意力集中在蝙蝠身上。
- en: Render Layers
  id: totrans-70
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 渲染层
- en: As the first step toward splitting the Bat Creature into two *render layers*,
    I split my scene into four *scene layers*. On (scene) layer 1, I placed the body
    (with Subdivision Surface and Displace modifiers) and the teeth and nails. On
    layer 2, I placed the eye objects, along with the Hemi light I created to light
    just the eyes (using the This Layer Only option for the lamp). On layer 3, I placed
    the duplicated body that I had used to create the hair (with Emitter turned off
    in the Render panel of the Particles tab so that only the hair rendered). Finally,
    on layer 4, I placed my lamps, the camera, and my floor plane.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 作为将蝙蝠生物分割成两个*渲染层*的第一步，我将场景分成了四个*场景层*。在（场景）层1上，我放置了身体（带有细分曲面和位移修饰符）以及牙齿和指甲。层2上，我放置了眼睛对象，以及我创建的仅照亮眼睛的Hemi光源（使用“仅此层”选项来设置灯光）。在层3上，我放置了用于创建头发的复制身体（在粒子面板的渲染选项卡中关闭了“发射器”，确保只渲染头发）。最后，在层4上，我放置了我的灯光、相机和地面平面。
- en: Next, I set up two render layers. On the first, I disabled Strand under the
    Include settings of the Layers panel. For the other, I disabled Solid so that
    normal meshes wouldn’t be rendered while my strand hair would. I named the first
    layer *body* and the second *strand*.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我设置了两个渲染层。在第一个层上，我在“层”面板的“包含”设置中禁用了“Strand”选项。对于另一个层，我禁用了“Solid”选项，以便在渲染时不会渲染普通网格，而我的发丝会被渲染。我将第一个层命名为*body*，第二个层命名为*strand*。
- en: For the body layer, I enabled an ambient occlusion pass under Passes in the
    Layers panel. The result when rendered was two separate layers, as shown in [Figure 14-4](ch14.html#two_render_passes_for_the_bat_creature
    "Figure 14-4. The two render passes for the Bat Creature"). When looking at the
    render (choose **Render Result** from the image selector drop-down menu), you
    can switch between these layers using the drop-down menu in the header of the
    UV Image editor.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 对于“body”层，我在“层”面板的“通道”中启用了环境遮挡通道。渲染结果是两个独立的层，如[图14-4](ch14.html#two_render_passes_for_the_bat_creature
    "图14-4. 蝙蝠生物的两个渲染通道")所示。查看渲染结果（从图像选择器下拉菜单中选择**Render Result**），你可以在UV图像编辑器的标题栏的下拉菜单中切换这些层。
- en: In the Layers panel, the options and settings you choose apply only to the currently
    selected render layer. In other panels of the Render tab, options apply across
    all render layers. I set the Alpha option in the Shading panel to Straight Alpha
    and turned off Ray Tracing to speed up renders. (I didn’t need to use ray tracing
    since I was using buffered shadows for my spot lamps and approximate ambient occlusion.)
    I set the render size to 2200×3000 pixels in the Dimensions panel, and pressed
    Render (F12) to start rendering.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在“层”面板中，你选择的选项和设置仅适用于当前选定的渲染层。在渲染标签的其他面板中，选项适用于所有渲染层。我在“着色”面板中将Alpha选项设置为“Straight
    Alpha”，并关闭了光线追踪以加快渲染速度。（由于我使用的是缓冲阴影为聚光灯和近似环境遮挡，所以不需要使用光线追踪。）我在“尺寸”面板中将渲染尺寸设置为2200×3000像素，然后按下“渲染”（F12）开始渲染。
- en: Compositing the Passes
  id: totrans-75
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 合成通道
- en: 'After rendering, I used Blender’s compositor to combine the layers. I wanted
    to achieve certain effects with the compositor, in the following order:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 渲染后，我使用Blender的合成器将各层合成在一起。我希望通过合成器实现某些效果，顺序如下：
- en: Add some extra ambient occlusion to the body render layer.
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为身体渲染层添加一些额外的环境遮挡。
- en: Combine the body and fur layers into one image with a plain background.
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将身体层和毛发层合成到一张具有纯背景的图像中。
- en: Soften the lighting in the image using a bloom effect.
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用辉光效果软化图像中的光照。
- en: Apply some basic color grading to the image.
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对图像进行一些基础的色彩分级。
- en: Add a vignette to the image.
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为图像添加晕影效果。
- en: '![The two render passes for the Bat Creature](httpatomoreillycomsourcenostarchimages1538858.png.jpg)Figure 14-4. The
    two render passes for the Bat Creature'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '![蝙蝠生物的两个渲染通道](httpatomoreillycomsourcenostarchimages1538858.png.jpg)图14-4.
    蝙蝠生物的两个渲染通道'
- en: These effects (as with all things in the compositor) need to be applied in a
    particular order. Because each node is processed in the order it is connected,
    changing the order in which you apply nodes to your image can make a big difference.
    To begin compositing, make sure that Use Nodes is enabled and that you are editing
    the compositing nodes (not a material or texture). The default compositing node
    tree should look like [Figure 14-5](ch14.html#default_node_tree_for_blenderapostrophes
    "Figure 14-5. The default node tree for Blender’s compositor is pretty basic.
    Whatever you connect to the sockets of the Composite node will become the final
    output of your render.").
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
- en: The initial Render node will use the first render layer you created in the Layers
    panel, which in my case was the body layer. I added a second Render Layer node
    (SHIFT-A▸Input▸Render Layer) to hold my strand render layer, selecting it from
    the drop-down menu at the bottom of the Render Layer node.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
- en: '![The default node tree for Blender’s compositor is pretty basic. Whatever
    you connect to the sockets of the Composite node will become the final output
    of your render.](httpatomoreillycomsourcenostarchimages1538860.png.jpg)Figure 14-5. The
    default node tree for Blender’s compositor is pretty basic. Whatever you connect
    to the sockets of the Composite node will become the final output of your render.'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
- en: Extra Ambient Occlusion
  id: totrans-86
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Next, I used a Mix node (SHIFT-A▸Color▸Mix) to increase the strength of the
    ambient occlusion effect on the body render layer. I set the Blend mode of the
    Mix node to Multiply and used the Image output of the body render layer as the
    first input. I used the ambient occlusion pass (from the socket labeled AO) as
    the second input.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
- en: To increase the effect, I darkened the ambient occlusion pass with a Curves
    node before multiplying it with the image. To do so, I added an RGB Curves node
    and inserted it between the ambient occlusion output of the Render Layer node
    and the Multiply node. To do this quickly, drag the node over the connection between
    two other nodes (you should see the connection highlight) and release it to insert
    it in a chain between the other two nodes.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
- en: Finally, I made the curve on the RGB Curves node a bit steeper (see [Figure 14-6](ch14.html#adding_extra_ambient_occlusion_to_the_bo
    "Figure 14-6. Adding extra ambient occlusion to the body render layer with a Multiply
    node. The hair is then merged over the top, and the composite is placed over a
    gray background using an Alpha Over node.")).
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
- en: Combining the Body and Fur
  id: totrans-90
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Next, I added an Alpha Over node (SHIFT-A▸Color▸Alpha Over), connecting the
    body as the first input and the fur as the second. To get the correct results
    when compositing layers with straight alpha, which I selected when choosing the
    Render settings earlier (see [Render Layers](ch14.html#render_layers "Render Layers")),
    I enabled Convert Premultiply for this node. This should produce the expected
    result without any dark fringing.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
- en: To place the Bat Creature on a dark gray background, I used a second Alpha node
    with an RGB node as the first input (set to gray) and my newly merged body and
    hair layers as the second input, as shown in [Figure 14-6](ch14.html#adding_extra_ambient_occlusion_to_the_bo
    "Figure 14-6. Adding extra ambient occlusion to the body render layer with a Multiply
    node. The hair is then merged over the top, and the composite is placed over a
    gray background using an Alpha Over node.").
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 为了将蝙蝠生物放置在深灰色背景上，我使用了第二个 Alpha 节点，将第一个输入设置为 RGB 节点（设置为灰色），第二个输入设置为我新合并的身体和头发层，正如在[图14-6](ch14.html#adding_extra_ambient_occlusion_to_the_bo
    "图14-6：通过乘法节点为身体渲染层添加额外的环境光遮蔽。然后将头发合并在上面，最后使用 Alpha Over 节点将合成图放置在灰色背景上。")中所示。
- en: '![Adding extra ambient occlusion to the body render layer with a Multiply node.
    The hair is then merged over the top, and the composite is placed over a gray
    background using an Alpha Over node.](httpatomoreillycomsourcenostarchimages1538862.png.jpg)Figure 14-6. Adding
    extra ambient occlusion to the body render layer with a Multiply node. The hair
    is then merged over the top, and the composite is placed over a gray background
    using an Alpha Over node.'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '![通过乘法节点为身体渲染层添加额外的环境光遮蔽。然后将头发合并在上面，最后使用 Alpha Over 节点将合成图放置在灰色背景上。](httpatomoreillycomsourcenostarchimages1538862.png.jpg)
    图14-6：通过乘法节点为身体渲染层添加额外的环境光遮蔽。然后将头发合并在上面，最后使用 Alpha Over 节点将合成图放置在灰色背景上。'
- en: Bloom
  id: totrans-94
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 辉光
- en: Next, I added some bloom. *Bloom* is a common effect in both real and CG imagery,
    where light bleeds out from bright areas into darker ones, effectively lightening
    the image around darker areas. The real-world effect arises from imperfections
    in lenses, but I could mimic this by blurring my image and overlaying it on the
    original input.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我添加了一些辉光效果。*辉光*是现实和计算机图像中常见的效果，亮区的光线会渗透到暗区，实际上使图像中的暗区变亮。现实中的效果是由于镜头的缺陷产生的，但我可以通过模糊图像并将其叠加在原始图像上来模拟这一效果。
- en: To generate bloom, I created a Blur node (SHIFT-A▸Filter▸Blur) and set its type
    to Fast Gaussian. I also enabled the Relative option, which would allow me to
    specify the blur radius relative to the width of the image. This option is useful
    if you don’t know what final resolution you want to use for your render, because
    the amount of blurring won’t appear to change if you make the render smaller or
    larger. (It would if you defined the radius in pixels.)
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 为了生成辉光效果，我创建了一个模糊节点（SHIFT-A▸Filter▸Blur），并将其类型设置为快速高斯模糊。我还启用了相对选项，这样我就可以根据图像的宽度指定模糊半径。如果你不知道最终渲染的分辨率，这个选项非常有用，因为无论你将渲染图像缩小还是放大，模糊的程度看起来都不会发生变化。（如果你用像素来定义半径，那就会有不同的效果。）
- en: I set the *x* and *y* radii to 2 percent and selected **Y** under Aspect Correction
    to make sure the blur had the correct aspect ratio. (This applies only when using
    relative blur.) Then, I used an Add node with a factor of 0.2 to subtly add the
    result of the blurred image on top of the original.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 我将 *x* 和 *y* 半径设置为 2% 并选择了 **Y** 作为纵横比修正选项，以确保模糊效果具有正确的纵横比。（这仅适用于使用相对模糊时。）然后，我使用一个加法节点，因子设置为
    0.2，将模糊图像的结果微妙地叠加到原始图像上。
- en: The initial effect was too bright, so I used another RGB Curves node to darken
    the darker regions of the image before it was blurred so that only the brightest
    regions would contribute to the bloom. The resulting node tree is shown in [Figure 14-7](ch14.html#my_bloom_effect_and_the_node_tree_respon
    "Figure 14-7. My bloom effect and the node tree responsible. The composited hair
    and body are first put through an RGB curves node to add some contrast, then blurred
    and added back on top of the original composite.").
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 最初的效果太亮了，因此在进行模糊之前，我使用了另一个 RGB 曲线节点来将图像中的暗区变暗，这样只有最亮的区域会贡献到辉光效果中。最终的节点树如[图14-7](ch14.html#my_bloom_effect_and_the_node_tree_respon
    "图14-7：我的辉光效果和负责的节点树。合成后的头发和身体首先通过 RGB 曲线节点以增加对比度，然后被模糊并叠加回原始合成图。")所示。
- en: Color Correction
  id: totrans-99
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 色彩修正
- en: Next, I applied some basic color correction using the Color Balance node. This
    node is really useful for applying a range of color-grading effects to your renders.
    First, I added the Color Balance node. Then, I connected my composite-in-progress
    to its image input and turned the factor down to 0.6\. (The Color Balance node
    can produce a strong effect, so turning the factor down is an easy way to make
    it more subtle without having to make very small adjustments to the other controls.)
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 接着，我使用颜色平衡节点进行了一些基本的色彩校正。这个节点非常有用，可以在渲染中应用各种色彩分级效果。首先，我添加了颜色平衡节点。然后，我将正在合成的图像连接到它的图像输入，并将因子值调低到0.6。
    （颜色平衡节点可以产生强烈的效果，所以将因子值调低是一种轻松的方法，使其更加微妙，而无需对其他控制项进行非常小的调整。）
- en: '![My bloom effect and the node tree responsible. The composited hair and body
    are first put through an RGB curves node to add some contrast, then blurred and
    added back on top of the original composite.](httpatomoreillycomsourcenostarchimages1538864.png.jpg)Figure 14-7. My
    bloom effect and the node tree responsible. The composited hair and body are first
    put through an RGB curves node to add some contrast, then blurred and added back
    on top of the original composite.'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '![我的辉光效果和负责的节点树。合成后的头发和身体首先通过一个RGB曲线节点增加对比度，然后模糊处理并覆盖在原始合成图像之上。](httpatomoreillycomsourcenostarchimages1538864.png.jpg)图14-7。我的辉光效果和负责的节点树。合成后的头发和身体首先通过一个RGB曲线节点增加对比度，然后模糊处理并覆盖在原始合成图像之上。'
- en: The Color Balance node has three sets of controls, each of which sets an RGB
    color. You can set each input by using the color wheel to control the hue and
    saturation and using the vertical slider to control the color. The color you select
    is shown below in the color picker. You can also click the color picker to use
    Blender’s default color picker or to set RGB or HSV values manually.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 颜色平衡节点有三组控制，每组设置一个RGB颜色。你可以使用颜色轮来控制色调和饱和度，并使用垂直滑块来调整颜色。你选择的颜色将在颜色选择器下方显示。你还可以点击颜色选择器，使用Blender的默认颜色选择器，或者手动设置RGB或HSV值。
- en: The Color Balance node inputs are named *lift*, *gamma*, and *gain*, and they
    can be thought of as affecting the shadows, midtones, and highlights of an image.
    Thus, to give an image less prominent highlights, you could turn down the brightness
    of the lift input. To give it saturated red highlights, you could set the gain
    color toward red. In general, setting opposing colors for the lift and gain inputs
    often results in an image with nice color harmonies between the lights and darks.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 颜色平衡节点的输入分别命名为*lift*、*gamma*和*gain*，可以认为它们分别影响图像的阴影、中间调和高光。因此，为了使图像的高光不那么突出，你可以降低提升输入的亮度。为了让高光呈现饱和的红色，你可以将增益颜色设置为红色。一般来说，为提升和增益输入设置对立的颜色，通常会得到光暗之间有良好色调和谐的图像。
- en: 'In many Hollywood movies, the shadows are teal or blue, while the midtones
    and highlights are pushed toward orange—a color scheme that works well with the
    pinkish-orange of most lighter skin tones. For the Bat Creature, I opted for a
    slightly blue lift color and a slightly yellow gain color. The effect is shown
    in [Figure 14-8](ch14.html#adding_color_grading_to_the_render_of_th "Figure 14-8. Adding
    color grading to the render of the Bat Creature. Left: Before grading. Middle:
    The Color Balance node. Right: After grading.").'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多好莱坞电影中，阴影通常是青色或蓝色，而中间调和高光则偏向橙色——这种配色方案与大多数较浅肤色的粉橙色调非常匹配。对于蝙蝠生物，我选择了略微偏蓝的提升色和略微偏黄的增益色。效果如[图14-8](ch14.html#adding_color_grading_to_the_render_of_th
    "图14-8. 为蝙蝠生物的渲染添加色彩分级。左：分级前。中：颜色平衡节点。右：分级后。")所示。
- en: Adding a Vignette
  id: totrans-105
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 添加渐晕效果
- en: Next, I added a vignette to my image to slightly darken its corners and draw
    the viewer’s attention to the center of the frame. To create this effect, I took
    the alpha channel of my body layer and ran it thought a lens distortion filter
    with a distort value of 1\. This distorted the image into a circular shape with
    black corners, which was almost what I needed.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我为图像添加了渐晕效果，稍微加深了角落部分的颜色，吸引观众的注意力集中在画面的中心。为了创造这种效果，我取了身体层的alpha通道，并通过一个镜头失真滤镜进行处理，失真值设置为1。这将图像变形为一个圆形，中间保持清晰，角落部分变黑，这几乎就是我需要的效果。
- en: Then, I used a Blur node set to Fast Gaussian Blur with a relative radius of
    50 percent to blur the output of the Lens Distortion node. This gave the image
    a soft gradient out from the middle, which I then overlaid onto the color-corrected
    render.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我使用了一个设置为快速高斯模糊（Fast Gaussian Blur）的模糊节点，模糊半径设为50%。这个处理模糊了镜头失真节点的输出，给图像从中心向外的柔和渐变效果，随后我将其叠加到色彩校正后的渲染图像上。
- en: Finally, I added a Sharpen node with a very low Factor setting (around 0.05)
    to the end of the node tree and connected the output to the Composite node. The
    final node tree is shown in [Figure 14-9](ch14.html#compositing_node_tree_for_the_bat_creatu
    "Figure 14-9. The compositing node tree for the Bat Creature"), and the result
    is shown in [Figure 14-10](ch14.html#composited_output_for_the_bat_creature "Figure 14-10. The
    composited output for the Bat Creature").
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我在节点树的末尾添加了一个锐化节点，设置了非常低的因子（大约 0.05），并将输出连接到合成节点。最终的节点树如[图 14-9](ch14.html#compositing_node_tree_for_the_bat_creatu
    "图 14-9. 蝙蝠生物的合成节点树")所示，结果如[图 14-10](ch14.html#composited_output_for_the_bat_creature
    "图 14-10. 蝙蝠生物的合成输出")所示。
- en: Compositing Feedback and Viewer Nodes
  id: totrans-109
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 合成反馈与查看器节点
- en: Creating a final composite from your renders can be a long process that requires
    some experimentation. To aid in the process, Blender automatically recomposites
    your final render when you change the node tree. An alternative way to get a feel
    for how your node setup is working is to use the Viewer node, a secondary output
    node that lets you view any stage in your node tree.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 从你的渲染结果中创建最终合成可能是一个漫长的过程，且需要一些实验。为了帮助这一过程，Blender 在你更改节点树时会自动重新合成最终渲染结果。另一个感受节点设置工作方式的替代方法是使用“查看器节点”，这是一种辅助输出节点，允许你查看节点树中的任何阶段。
- en: '![Adding color grading to the render of the Bat Creature. Left: Before grading.
    Middle: The Color Balance node. Right: After grading.](httpatomoreillycomsourcenostarchimages1538866.png.jpg)Figure 14-8. Adding
    color grading to the render of the Bat Creature. Left: Before grading. Middle:
    The Color Balance node. Right: After grading.![The compositing node tree for the
    Bat Creature](httpatomoreillycomsourcenostarchimages1538868.png.jpg)Figure 14-9. The
    compositing node tree for the Bat Creature![The composited output for the Bat
    Creature](httpatomoreillycomsourcenostarchimages1538870.png.jpg)Figure 14-10. The
    composited output for the Bat Creature'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '![为蝙蝠生物的渲染添加色彩分级。左：分级前。中：色彩平衡节点。右：分级后。](httpatomoreillycomsourcenostarchimages1538866.png.jpg)图
    14-8. 为蝙蝠生物的渲染添加色彩分级。左：分级前。中：色彩平衡节点。右：分级后。![蝙蝠生物的合成节点树](httpatomoreillycomsourcenostarchimages1538868.png.jpg)图
    14-9. 蝙蝠生物的合成节点树![蝙蝠生物的合成输出](httpatomoreillycomsourcenostarchimages1538870.png.jpg)图
    14-10. 蝙蝠生物的合成输出'
- en: To create a Viewer node, press SHIFT-A▸**Output**▸**Viewer** in the Node editor.
    Whatever is connected as the input for this node will then show up in the UV Image
    editor if you select **Viewer Node** from the drop-down menu or check **Backdrop**
    in the background of the Node editor header.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建查看器节点，请在节点编辑器中按 SHIFT-A▸**输出**▸**查看器**。此节点的输入连接的任何内容，将显示在 UV 图像编辑器中，如果你从下拉菜单中选择**查看器节点**或在节点编辑器头部的背景中勾选**背景**。
- en: To quickly change which node the Viewer node is connected to, SHIFT-click any
    node in your setup. This allows you to easily go through your node tree, SHIFT-clicking
    each node in turn to see how it affects the composite. (You could create multiple
    Viewer nodes, but this method keeps your node tree clean.)
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 要快速更改查看器节点连接的节点，按住 SHIFT 并点击你设置中的任何节点。这使你可以轻松浏览节点树，逐个点击每个节点，查看它如何影响合成。（你也可以创建多个查看器节点，但这种方法保持了节点树的简洁。）
- en: Organizing Node Trees with Frames and Node Groups
  id: totrans-114
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用框架和节点组组织节点树
- en: Node setups for compositing can become quite complex as you add more and more
    nodes. If you don’t keep them organized, it can be difficult to come back later
    to determine what’s going on in your node tree. To help with this, Blender lets
    you organize nodes as Frame nodes and node groups.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 随着你添加越来越多的节点，合成用的节点设置可能变得相当复杂。如果不保持它们的组织结构，稍后回头查看节点树时可能会很困难。为了帮助解决这个问题，Blender
    允许你将节点组织成框架节点和节点组。
- en: Frame Nodes
  id: totrans-116
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 框架节点
- en: Frames are large, rectangular nodes with no inputs or outputs of their own;
    you place other nodes on top of them, which then “stick” to the frame node, allowing
    you to move collections of nodes together as one. You can label Frame nodes to
    mark the parts of your node setup (see [Figure 14-11](ch14.html#using_frames_to_organize_nodesdot_once_a
    "Figure 14-11. Using frames to organize nodes. Once assigned to a frame, multiple
    nodes can be dragged around together, making it easier to keep them organized."))
    by editing the node’s name in the Properties region (**N**). To unstick a node
    from a frame, you can use the shortcut ALT-P, or you can use ALT-F to unstick
    the node and automatically grab it to move it around.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 框架是大型的矩形节点，自己没有输入或输出；你可以将其他节点放置在它们上面，这些节点会“粘”到框架节点上，从而允许你将一组节点一起移动。你可以给框架节点加上标签，以标记节点设置的部分（参见[图14-11](ch14.html#using_frames_to_organize_nodesdot_once_a
    "图14-11. 使用框架组织节点。一旦分配到框架，多个节点可以一起拖动，使它们更容易保持有序。")）通过在属性区域（**N**）编辑节点的名称。要将节点从框架上“解粘”，你可以使用快捷键ALT-P，或者使用ALT-F将节点解粘并自动抓取它进行移动。
- en: Node Groups
  id: totrans-118
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 节点组
- en: Node groups are different from frames. To create a node group, select one or
    more nodes and press CTRL-G to group them into a single node. The new Group node
    should contain all of the selected nodes with the inputs and outputs required
    by the group as sockets. You can expand the group and look inside with TAB to
    modify its nodes and add extra inputs and outputs.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 节点组与框架不同。要创建一个节点组，选择一个或多个节点并按CTRL-G将它们组合成一个节点。新的组节点应包含所有选定的节点及其所需的输入和输出作为插座。你可以通过按TAB展开组并查看其中的节点，修改它们并添加额外的输入和输出。
- en: '![Using frames to organize nodes. Once assigned to a frame, multiple nodes
    can be dragged around together, making it easier to keep them organized.](httpatomoreillycomsourcenostarchimages1538872.png.jpg)Figure 14-11. Using
    frames to organize nodes. Once assigned to a frame, multiple nodes can be dragged
    around together, making it easier to keep them organized.'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: '![使用框架组织节点。一旦分配到框架，多个节点可以一起拖动，使它们更容易保持有序。](httpatomoreillycomsourcenostarchimages1538872.png.jpg)图14-11.
    使用框架组织节点。一旦分配到框架，多个节点可以一起拖动，使它们更容易保持有序。'
- en: When you expand a node group, its inputs and outputs will be shown on the left
    and right sides of the group respectively (see [Figure 14-12](ch14.html#working_with_node_groups
    "Figure 14-12. Working with node groups")). To add an input or output, drag a
    connection from one of the nodes in the group to this border; to remove a connection,
    click the **X** next to it. Use the arrows next to each input or output to reorder
    them and tidy up the group.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 当你展开一个节点组时，其输入和输出会分别显示在组的左右两侧（参见[图14-12](ch14.html#working_with_node_groups
    "图14-12. 使用节点组")）。要添加输入或输出，将一个节点的连接拖动到此边框；要移除连接，点击旁边的**X**。使用每个输入或输出旁边的箭头可以重新排序它们并整理节点组。
- en: 'Like all nodes, node groups can be duplicated and reused. Once duplicated,
    they behave like linked duplicate objects: A change within one instance of the
    group affects all instances the same way, which means that you can group commonly
    repeated chains of nodes and edit them all at once. Node groups can also be linked
    or appended from other *.blend* files, allowing you to reuse parts of your existing
    compositing setups.'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 和所有节点一样，节点组也可以复制和重复使用。一旦复制，它们就像是链接的重复对象：组内某个实例的更改会影响所有实例，从而使你可以将常重复的节点链条组合在一起，并一次性编辑它们。节点组也可以从其他*.blend*文件中链接或附加，从而使你可以重复使用现有合成设置中的部分内容。
- en: Retouching in GIMP
  id: totrans-123
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 在GIMP中修图
- en: Once you’re happy with your composite, you can call it final and save it as
    an image. Formats like PNG, TIFF, and Targa are good for this, being lossless
    formats (for saving images without losing quality). For posting to the Web, you
    may want to use the JPEG format, which compresses images much more, giving you
    a small file at the expense of a small loss in image quality. For the Bat Creature,
    though, I opted to fix some things in GIMP before calling it final. I wanted to
    soften some of the specular highlights on the nails and lighten the eyes a bit.
    I saved it as a Targa (*.tga*) file (F3 in the UV Image editor) and opened it
    in GIMP.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你对你的合成作品满意，就可以将其定为最终版本并保存为图像。像PNG、TIFF和Targa这样的格式适合此用途，因为它们是无损格式（用于保存不失真的图像）。对于在网页上发布，你可能希望使用JPEG格式，它可以大大压缩图像，从而获得较小的文件，虽然会牺牲一些图像质量。至于蝙蝠怪物，我选择在GIMP中先修复一些细节，然后再定为最终版本。我想柔化一些指甲上的高光，并稍微提亮眼睛。我将其保存为Targa（*.tga*）文件（在UV图像编辑器中按F3），并在GIMP中打开它。
- en: '![Working with node groups](httpatomoreillycomsourcenostarchimages1538874.png.jpg)Figure 14-12. Working
    with node groups'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: '![使用节点组](httpatomoreillycomsourcenostarchimages1538874.png.jpg)图14-12. 使用节点组'
- en: To lighten the eyes, I created a new layer and set its Blend mode to Overlay.
    Then, I painted white over the eyes. I also added subtle highlights, painting
    some distorted reflections by hand on a separate layer (this time with the Blend
    mode set to Normal).
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使眼睛变亮，我创建了一个新图层，并将其混合模式设置为叠加。然后，我在眼睛上涂抹了白色。我还添加了微妙的高光，在一个单独的图层上手动绘制了一些扭曲的反射（这次的混合模式设置为正常）。
- en: On the same layer as the reflections, I also darkened the highlights on some
    of the nails, picking colors from nearby areas with the color picker and painting
    over the bright highlights. (Make sure to turn on **Sample Merged** in the tool
    options to allow you to sample layers below the current one without switching
    to them.) Finally, on the original render layer, I used the Blur tool to slightly
    blur some of the hair on the feet in order to draw attention away from where it
    looked a bit too coarse.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 在与反射同一层上，我还将一些指甲上的高光进行了加深，使用颜色拾取器从附近的区域取色，并在明亮的高光上涂抹。（确保在工具选项中打开**合并采样**，这样可以在不切换到当前层的情况下采样下面的图层。）最后，在原始渲染图层上，我使用模糊工具轻微模糊了一些脚部的毛发，以便将注意力从看起来有点粗糙的部分移开。
- en: In [Figure 14-13](ch14.html#retouching_some_areas_of_the_composite_i "Figure 14-13. Retouching
    some areas of the composite in GIMP. I added some highlights to the eyes with
    one layer and brightened them overall with a second (with the Blend mode set to
    Overlay)."), you can see the retouched eyes. [Figure 14-14](ch14.html#retouched_bat_creature
    "Figure 14-14. The retouched Bat Creature") shows the completed Bat Creature project.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在[图14-13](ch14.html#retouching_some_areas_of_the_composite_i "图14-13. 在GIMP中修饰合成图的部分区域。我用一层为眼睛增加了高光，并用第二层整体提亮了眼睛（将混合模式设置为叠加）。")中，你可以看到修饰后的眼睛。[图14-14](ch14.html#retouched_bat_creature
    "图14-14. 修饰后的蝙蝠生物")展示了完成的蝙蝠生物项目。
- en: Rendering and Compositing the Spider Bot
  id: totrans-129
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 渲染和合成蜘蛛机器人
- en: To finalize the Spider Bot, I wanted to add color grading to the lighting (from
    [Chapter 13](ch13.html "Chapter 13. Lighting")), show some depth of field to communicate
    the robot’s small scale, and add some bloom.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 为了最终完成蜘蛛机器人，我想在灯光中添加颜色分级（参考[第13章](ch13.html "第13章. 灯光")），展示一些景深效果以传达机器人的小规模，并加入一些辉光效果。
- en: Depth of field is a real-world phenomenon that happens with images seen through
    a lens, whether that’s a camera or the human eye. Lenses can only focus perfectly
    on objects that are a certain distance away from them, a distance known as the
    *focal length*. Objects outside this distance become progressively more out of
    focus. The effect can be subtle (even not worth bothering with) or significant.
    In general, depth-of-field effects are most apparent when viewing objects at small
    scales.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 景深是现实世界中通过镜头看到的图像所发生的现象，无论是相机还是人眼。镜头只能对某个特定距离的物体进行完美聚焦，这个距离被称为*焦距*。超出这个距离的物体会逐渐变得模糊。这个效果可以是微妙的（甚至不值得处理），也可以是显著的。一般来说，景深效果在观看小规模物体时最为明显。
- en: '![Retouching some areas of the composite in GIMP. I added some highlights to
    the eyes with one layer and brightened them overall with a second (with the Blend
    mode set to Overlay).](httpatomoreillycomsourcenostarchimages1538876.png.jpg)Figure 14-13. Retouching
    some areas of the composite in GIMP. I added some highlights to the eyes with
    one layer and brightened them overall with a second (with the Blend mode set to
    Overlay).![The retouched Bat Creature](httpatomoreillycomsourcenostarchimages1538878.png.jpg)Figure 14-14. The
    retouched Bat Creature'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: '![在GIMP中修饰合成图的部分区域。我用一层为眼睛增加了高光，并用第二层整体提亮了眼睛（将混合模式设置为叠加）。](httpatomoreillycomsourcenostarchimages1538876.png.jpg)图14-13.
    在GIMP中修饰合成图的部分区域。我用一层为眼睛增加了高光，并用第二层整体提亮了眼睛（将混合模式设置为叠加）。![修饰后的蝙蝠生物](httpatomoreillycomsourcenostarchimages1538878.png.jpg)图14-14.
    修饰后的蝙蝠生物'
- en: Depth of Field in Cycles
  id: totrans-133
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Cycles中的景深
- en: There are two ways to create depth of field when rendering with Cycles. One
    is to use the Defocus node in Blender’s compositor. This works with both Blender
    Internal and Cycles and will be used for the Jungle Temple scene later in this
    chapter. The other way is to use Cycles’s “real” depth of field as a Camera setting
    when rendering.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用Cycles渲染时，有两种方式可以创建景深。第一种是使用Blender合成器中的Defocus节点。这适用于Blender Internal和Cycles，并将在本章稍后用于丛林神庙场景。另一种方式是使用Cycles的“真实”景深作为相机设置进行渲染。
- en: 'To use real depth of field, do the following:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用真实的景深，请按以下步骤操作：
- en: Select the active camera.
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择活动相机。
- en: In the Depth of Field panel on the Object Data tab of the Properties editor,
    set a distance from the camera to the *focal plane* (the distance where objects
    appear in focus).
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在属性编辑器的对象数据标签中的景深面板上，设置从相机到*焦平面*（物体出现对焦的距离）的距离。
- en: Set an aperture size to determine the amount of blurring. This can be specified
    in terms of either a radius or a number of F/Stops. Higher numbers give more blur
    with radius or less with F/Stops. For the Spider Bot, I used radius to set the
    depth of field to about 0.3.
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置光圈大小以确定模糊程度。光圈可以用半径或 F/Stop 数值来指定。较高的数值会导致更大的模糊效果（半径情况下），或者较少的模糊效果（F/Stop情况下）。对于
    Spider Bot，我使用了半径来设置景深为大约 0.3。
- en: Note
  id: totrans-139
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '*Cycles can also mimic the shape of an aperture like the one you might find
    on a real film or digital camera. To do this, set Blades to the number of sides
    of the aperture shape and set Rotation to rotate the shape.*'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: '*Cycles 还可以模拟像真实胶片或数码相机上的光圈形状。要实现这一点，设置 Blades 为光圈形状的边数，并设置 Rotation 来旋转形状。*'
- en: When setting the distance for the depth of field, you can either set a number
    manually with the Depth setting or specify an object using the selector under
    Focus. This causes the camera to ignore the Manual Depth setting and focus on
    the object’s center instead. It’s usually easiest to create an empty object, place
    it where you want the scene to be in focus, and then set this empty object as
    the depth-of-field target in the Camera settings.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 在设置景深的距离时，你可以通过 Depth 设置手动输入一个数值，或者使用 Focus 下的选择器来指定一个物体。这将使相机忽略手动设置的深度，而将焦点对准该物体的中心。通常最简单的方法是创建一个空物体，将其放置在你希望场景对焦的地方，然后将该空物体设置为相机设置中的景深目标。
- en: To better visualize the depth-of-field distance, enable the Limits option in
    the Display panel of the Camera settings. Blender then displays a line pointing
    out from the camera (describing the clipping distances) with a yellow cross at
    the depth-of-field distance.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更好地可视化景深距离，请在相机设置的显示面板中启用限制选项。此时，Blender 会从相机显示出一条指示线（描述裁剪距离），并在景深距离处显示一个黄色十字标记。
- en: Render Settings for the Spider Bot
  id: totrans-143
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Spider Bot 的渲染设置
- en: With depth of field set up, I was ready to render. I set the resolution of the
    render to 2600×3600, and in the Integrator panel of the Render tab, I set Render
    Samples to 1000 and Clamp to 2 to reduce the number of fireflies in the scene.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 在设置好景深后，我准备开始渲染。我将渲染分辨率设置为 2600×3600，并在渲染标签的集成面板中，将渲染样本数设置为 1000，Clamp 设置为 2，以减少场景中的火花噪点。
- en: I wanted light to bounce around my scene and illuminate the shadows, but almost
    all of the scene is in direct light, so I didn’t need to rely on bounced light
    too heavily. I set Max Bounces to 32 (with a minimum of 4 to allow early termination)
    and the three Light Paths settings to 32 as well. I didn’t need any render layers
    or extra passes, so I left the Layers panel alone and pressed Render (F12).
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 我希望光线在场景中反弹并照亮阴影，但场景几乎所有部分都在直射光下，因此我不需要过多依赖反射光。我将最大反射次数设置为 32（最小值为 4，以允许早期终止），并将三个光照路径设置为
    32。我不需要任何渲染层或额外的通道，因此我没有更改 Layers 面板，并按下了渲染（F12）。
- en: Compositing the Spider Bot
  id: totrans-146
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 合成 Spider Bot
- en: Next, I added some color grading and bloom to my final render. While Cycles
    provides some different render passes, the process of compositing is essentially
    the same as when using Blender Internal. I added bloom as I did with the Bat Creature,
    using a Blur node to blur the image and an Add node to add the result back onto
    the image. Again, I added an RGB Curves node before the Blur node to increase
    the contrast and slightly darken the image to be blurred.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我为最终渲染添加了一些色彩分级和辉光效果。虽然 Cycles 提供了一些不同的渲染通道，但合成过程与使用 Blender Internal 时基本相同。我像处理
    Bat Creature 时一样添加了辉光效果，使用模糊节点来模糊图像，再通过加法节点将结果添加回图像中。同样，我在模糊节点之前添加了一个 RGB 曲线节点，以增加对比度并略微加深图像的亮度，随后对其进行模糊。
- en: 'For color grading, I added a Color Balance node: I chose a purplish color for
    the Lift Color and a greenish tint for the Gain. I set the Gamma to slightly bluish
    and brightened up the highlights of the image a bit by setting the value of the
    gain slightly higher than 1.0\. (You can set numerical values for the RGB or HSV
    colors for Lift, Gamma, and Gain by clicking the color picker.) I then connected
    the output of the Color Balance node to the image socket Composite output node.
    The finished node tree is shown in [Figure 14-15](ch14.html#node_tree_for_compositing_the_spider_bot
    "Figure 14-15. The node tree for compositing the Spider Bot") and the resulting
    composite in [Figure 14-16](ch14.html#composited_spider_bot "Figure 14-16. The
    composited Spider Bot").'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
- en: Rendering and Compositing the Jungle Temple
  id: totrans-149
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The Jungle Temple was a complex scene, and my Render settings had a much greater
    impact on render times for this project. I set the render size of the image to
    2880×3840; the number of Render Samples in the Sampling settings to 5000; and
    Clamp to 3.0 to try to reduce noise a bit more quickly.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-151
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '*Although 5000 samples is a lot, I wasn’t particularly concerned about how
    long my render took. Primarily, this high number was necessary because there were
    a lot of soft shadows in the scene. For good results with fewer samples, you can
    try turning down the Size setting on some of the lamps in your scene at the cost
    of harder-edged shadows.*'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
- en: For bounces, I set the Max to 128 and Min to 8 to allow for probabilistic ray
    termination. Because I wanted to composite the final render on a background image
    of clouds and sky, I turned on Transparent under Film options.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
- en: I left the other Render options at their default and pressed F12 to render.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
- en: Background Required
  id: totrans-155
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: When compositing the Jungle Temple, I wanted to add bloom, depth of field, and
    some color grading. But first I needed to composite my render over a background,
    which meant creating a background in GIMP and then importing it into Blender with
    an Image Texture node for further compositing.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
- en: '![The node tree for compositing the Spider Bot](httpatomoreillycomsourcenostarchimages1538880.png.jpg)Figure 14-15. The
    node tree for compositing the Spider Bot![The composited Spider Bot](httpatomoreillycomsourcenostarchimages1538882.png.jpg)Figure 14-16. The
    composited Spider Bot'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
- en: Painting the Sky in GIMP
  id: totrans-158
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To create a sky background, I first saved my uncomposited render from Blender’s
    Image editor as a *.png* image with transparency (when saving, remember to choose
    **RGBA** next to the file type to save the transparency as well). Then, I opened
    the image in GIMP. To create a background for the top right-hand corner, I opened
    a sky texture from CGTextures as a layer (see [Figure 14-17](ch14.html#creating_a_background_for_the_jungle_tem
    "Figure 14-17. Creating a background for the Jungle Temple in GIMP, using an early,
    noisy render as a guide. The background was made with the same dimensions as the
    final image, but only the corner showing the sky is shown here. (The rest of the
    background image was black.) The render (on a separate layer) was hidden before
    saving the background.")) and put it below the render in my layer stack. I then
    scaled and positioned the background to put a nice bit of cloud in the top corner
    (as you can see in the first image in [Figure 14-17](ch14.html#creating_a_background_for_the_jungle_tem
    "Figure 14-17. Creating a background for the Jungle Temple in GIMP, using an early,
    noisy render as a guide. The background was made with the same dimensions as the
    final image, but only the corner showing the sky is shown here. (The rest of the
    background image was black.) The render (on a separate layer) was hidden before
    saving the background.")). To create a nighttime background, I used the Curves
    tool to really darken the clouds layer, while using the Hue-Saturation and Brightness
    tools (Colors▸Hue-Saturation) to reduce the saturation of the layer a bit so that
    the colors didn’t look too saturated.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 为了创建天空背景，我首先将Blender图像编辑器中未合成的渲染保存为带透明通道的*.png*图像（保存时，记得选择**RGBA**以便保存透明度）。然后，我在GIMP中打开了该图像。为了在右上角创建一个背景，我从CGTextures中打开了一个天空纹理作为一个层（见[图14-17](ch14.html#creating_a_background_for_the_jungle_tem
    "图14-17. 使用早期的噪声渲染作为指南，在GIMP中创建丛林神庙的背景。背景使用与最终图像相同的尺寸制作，但这里只显示了显示天空的角落。其余部分是黑色的背景。渲染层（在单独的层中）在保存背景之前被隐藏。")），并将其放在渲染层下方。我然后调整了背景的大小和位置，将一些云朵放置在右上角（如[图14-17](ch14.html#creating_a_background_for_the_jungle_tem
    "图14-17. 使用早期的噪声渲染作为指南，在GIMP中创建丛林神庙的背景。背景使用与最终图像相同的尺寸制作，但这里只显示了显示天空的角落。其余部分是黑色的背景。渲染层（在单独的层中）在保存背景之前被隐藏。")中的第一张图片所示）。为了创建一个夜空背景，我使用了曲线工具将云层调得更暗，同时使用色相/饱和度和亮度工具（颜色▸色相/饱和度）稍微降低了层的饱和度，以防颜色显得过于饱和。
- en: 'Next, I added some embellishments to the cloud image using the Dodge/Burn tool
    (set to Dodge) and added highlights to the edges of some clouds using a soft-edged
    brush. I also created a new transparent layer and set its Blend mode to Overlay.
    I then used this new layer to incorporate some extra colors around the clouds:
    a light blue around the edges of the leaves on the temple and some greens and
    yellows toward the corner. Throughout, my goal was to end up with a background
    that had a color palette similar to that of my rendered image.'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我使用加深/减淡工具（设置为减淡）对云层图像进行了一些装饰，并用软边刷在一些云的边缘添加了高光。我还创建了一个新的透明层，并将其混合模式设置为叠加。然后，我利用这个新层在云周围加入了一些额外的颜色：在神庙叶子边缘添加了一些浅蓝色，并在角落处加入了一些绿色和黄色。整个过程中，我的目标是最终得到一个色彩调色板与我的渲染图像相似的背景。
- en: Finally, I hid the render layer, saved the background on its own as an *.xcf*
    file (CTRL-S) so that I could edit it later, and exported it as a *.tga* image
    (CTRL-E). The background image and its various stages are shown in [Figure 14-17](ch14.html#creating_a_background_for_the_jungle_tem
    "Figure 14-17. Creating a background for the Jungle Temple in GIMP, using an early,
    noisy render as a guide. The background was made with the same dimensions as the
    final image, but only the corner showing the sky is shown here. (The rest of the
    background image was black.) The render (on a separate layer) was hidden before
    saving the background.").
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我隐藏了渲染层，将背景单独保存为*.xcf*文件（CTRL-S），以便稍后编辑，并将其导出为*.tga*图像（CTRL-E）。背景图像及其各个阶段如[图14-17](ch14.html#creating_a_background_for_the_jungle_tem
    "图14-17. 使用早期的噪声渲染作为指南，在GIMP中创建丛林神庙的背景。背景使用与最终图像相同的尺寸制作，但这里只显示了显示天空的角落。其余部分是黑色的背景。渲染层（在单独的层中）在保存背景之前被隐藏。")所示。
- en: Compositing the Temple
  id: totrans-162
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 合成神庙
- en: With my background created, I returned to Blender’s compositor. First, I had
    to add my background behind my render. To do so, I used the Alpha Over node with
    the background as the first input and my render as the second (see [Figure 14-18](ch14.html#compositing_the_background_in_gimp_with
    "Figure 14-18. Compositing the background in GIMP with an Alpha Over node. I also
    added a Curves node to darken it slightly.")).
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
- en: '![Creating a background for the Jungle Temple in GIMP, using an early, noisy
    render as a guide. The background was made with the same dimensions as the final
    image, but only the corner showing the sky is shown here. (The rest of the background
    image was black.) The render (on a separate layer) was hidden before saving the
    background.](httpatomoreillycomsourcenostarchimages1538884.png.jpg)Figure 14-17. Creating
    a background for the Jungle Temple in GIMP, using an early, noisy render as a
    guide. The background was made with the same dimensions as the final image, but
    only the corner showing the sky is shown here. (The rest of the background image
    was black.) The render (on a separate layer) was hidden before saving the background.![Compositing
    the background in GIMP with an Alpha Over node. I also added a Curves node to
    darken it slightly.](httpatomoreillycomsourcenostarchimages1538886.png.jpg)Figure 14-18. Compositing
    the background in GIMP with an Alpha Over node. I also added a Curves node to
    darken it slightly.'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
- en: Depth of Field
  id: totrans-165
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Next came some depth of field. When adding depth of field to the Spider Bot,
    I used physically correct, rendered depth of field. However, for the Jungle Scene,
    I used the compositor’s Defocus node. This method gives slightly less accurate
    results than rendered depth of field, but it allows for more control over which
    areas are blurred and which are not and lets us change the focus *after* we finish
    rendering, which gives us more flexibility.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
- en: 'The Defocus node requires two inputs: the image to be blurred and a black-and-white
    mask that determines how much to blur different parts of the image. For the mask,
    you can use either the *z*-buffer directly (check the **Use z-buffer input** checkbox),
    or you can use any black-and-white image as a simple mask by leaving it unchecked.
    If you choose to use the *z*-buffer directly, Blender will use the camera’s depth-of-field
    settings found in the Object Data tab of the Properties editor. Regions closer
    or farther than the depth-of-field distance will be blurred. If you turn this
    option off, Blender will use the value of the input to determine the amount of
    blurring so that white regions will be the most blurred and black the least.'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
- en: For the Jungle Temple scene, I opted to use the *z*-buffer directly, but I added
    a Blur node (with a radius of 6 pixels) between the *z*-buffer output and the
    *z*-input of the Defocus node to blur these values slightly. This method reduces
    the creation of artifacts on foreground objects, where objects that should be
    blurred appear to have sharp edges.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
- en: '![Adding depth of field and bloom to the composite](httpatomoreillycomsourcenostarchimages1538888.png.jpg)Figure 14-19. Adding
    depth of field and bloom to the composite'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
- en: Adding Bloom and Vignetting
  id: totrans-170
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Next, I added some bloom. As with the other projects, I blurred the image and
    combined it back over the image with an Add Mix node. I applied some vignetting
    by taking the alpha channel of the render, distorting it with the Lens Distortion
    node, blurring it with the Blur node, and then overlaying this on top of the image.
    The nodes for these stages are shown in [Figure 14-19](ch14.html#adding_depth_of_field_and_bloom_to_the_c
    "Figure 14-19. Adding depth of field and bloom to the composite").
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
- en: Color Grading
  id: totrans-172
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: To add color grading, I used two different nodes. First, I put the image through
    a Hue Correct node, which let me adjust the saturation (or hue or value) of specific
    colors within the image. Because I wanted to play up the oranges and greens before
    applying some extra grading, I adjusted the curve of the Hue Correct node by clicking
    the curve and dragging to add a new point, raising the profile of the curve in
    the orange and green areas, and lowering it slightly in the blues. This increased
    the saturation of the orange light from the temple entrance and the green of the
    leaves, making them more prominent. I ran the result through a Color Balance node,
    adding some blues to the shadows with a bluish lift color and some yellow and
    orange to the midtones and highlights with very slightly orange gamma and gain
    colors.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
- en: Finally, I added a Filter node at the end of the node tree, just before the
    Composite output node. I set this to Sharpen with a factor of 0.05 to add some
    very slight sharpening to the image.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
- en: This completes the compositing for the Jungle Temple scene. The complete node
    setup is shown in [Figure 14-20](ch14.html#node_tree_for_compositing_the_jungle_tem
    "Figure 14-20. The node tree for compositing the Jungle Temple, organized with
    frame nodes").
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
- en: '![The node tree for compositing the Jungle Temple, organized with frame nodes](httpatomoreillycomsourcenostarchimages1538890.png.jpg)Figure 14-20. The
    node tree for compositing the Jungle Temple, organized with frame nodes'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
- en: As a final adjustment, I opened the composite image in GIMP and cleaned up one
    or two remaining depth-of-field artifacts by hand with the Blur tool. I also cropped
    the image slightly to improve the composition. The result is shown in [Figure 14-21](ch14.html#final_result_for_the_jungle_temple
    "Figure 14-21. The final result for the Jungle Temple").
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
- en: In Review
  id: totrans-178
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This more or less completes each of the projects I set out to create for the
    book. In this chapter, I took the final scenes and rendered them using either
    Cycles or Blender Internal as render engines. Then I took the render output and
    used GIMP and Blender’s compositor to tweak and refine these results into my final
    images. The result is renders of the projects that I can now call finished.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
- en: Of course, there’s always another tweak that can be made, and in [Chapter 15](ch15.html
    "Chapter 15. Going Further"), we’ll look at a few more things that could be done
    with these projects to take them further.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
- en: '![The final result for the Jungle Temple](httpatomoreillycomsourcenostarchimages1538892.png.jpg)Figure 14-21. The
    final result for the Jungle Temple'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
