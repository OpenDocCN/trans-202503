- en: '4'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '4'
- en: Identification Challenge
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 识别挑战
- en: Though there are ancient ways for identifying marks, passwords, and certificates,
    unless you invent new ones and rotate them, the enemy will manage to infiltrate
    by having similar fake ones.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管有一些古老的识别标记、密码和证明方法，除非你发明新的并且定期更换，否则敌人最终会通过类似的假冒方式渗透进来。
- en: During a night attack, you may have the enemy follow you and get into the ranks
    of your allies. To prevent this, have a prearranged policy—a way to identify your
    allies.
  id: totrans-3
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在夜间进攻时，敌人可能会跟随你并进入你盟友的阵营。为了防止这种情况，必须有一个预定的政策——一种辨别盟友的方法。
- en: ''
  id: totrans-4
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '—Yoshimori Hyakushu #27'
  id: totrans-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '—吉守百首 #27'
- en: 'Imagine the following historical scenario: after dispatching a large group
    of troops on a night raid, a military commander must open the gates to allow them
    back inside their fortification. Night raids helped win battles, but they also
    presented opportunities for a counterattack. An enemy shinobi could forge or steal
    a uniform from the attacking troops and blend into their formation as they returned
    to their base.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 想象以下历史场景：在执行夜间突袭后，一位军事指挥官必须打开城门让部队重新进入防御工事。夜间突袭有助于赢得战斗，但也为反击提供了机会。敌方的忍者可以伪造或偷取袭击部队的制服，并在他们返回基地时混入队伍。
- en: 'To combat this threat, commanders implemented a onetime password for the raiders
    to use before they could pass through the gate—but this password was easily defeated:
    the disguised shinobi would overhear the password when it was spoken by the soldier
    ahead of them in line. So commanders tried other identification methods. Some
    required the raiders to all wear underwear of a certain secret color that could
    be inspected upon their return, but clever shinobi would carry or wear undergarments
    in multiple colors, then selectively pull back layers of underwear so only the
    correct color would be visible during inspection. Additional countermeasures included
    changing passwords multiple times per day (which still didn’t prevent a shinobi
    from overhearing the current password) and unique uniform insignia or tokens (which
    a shinobi could steal from the corpse of a dead soldier after the raid).'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 为了应对这一威胁，指挥官实施了一个一次性密码，袭击者必须在通过城门之前使用该密码——但这个密码很容易被破解：伪装成士兵的忍者会在排队时听到前方士兵说出的密码。因此，指挥官尝试了其他识别方法。有些要求袭击者穿戴某种特定颜色的内衣，以便在他们返回时进行检查，但聪明的忍者会携带或穿上多种颜色的内衣，然后有选择性地拉开内衣的层次，只露出正确颜色的部分以便检查。其他的对策包括一天多次更换密码（但这依然无法阻止忍者偷听到当前的密码）以及独特的制服标志或徽章（忍者可以在突袭后从死去士兵的尸体上偷走这些标志）。
- en: The shinobi categorized these techniques as either the art of open disguise
    (*yo-nin*, which translates literally to “light shinobi”) or the art of hidden
    infiltration (*in-nin*, which translates literally to “dark shinobi”). In this
    case, *open* refers to being plainly visible; for example, the attacker could
    wear the uniform of a defending soldier, fully expecting to be seen. *Hidden*,
    on the other hand, refers to trying not be seen, such as by using camouflage or
    blending into the shadows. Many of the assorted open disguise techniques described
    in *Bansenshūkai* could be used both offensively and defensively. Shinobi knew
    not only how to use these techniques for their own attacks but also how to spot
    enemy infiltrators. It was common for spies to replicate uniforms and crests or
    overhear passwords, so shinobi developed identification countermeasures to distinguish
    their allies from enemies.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 忍者将这些技巧分为两类，分别是明装忍术（*yo-nin*，字面意思是“光明忍者”）和暗藏忍术（*in-nin*，字面意思是“黑暗忍者”）。在这种情况下，*明装*指的是显而易见的，比如攻击者可以穿上防守士兵的制服，完全预计到自己会被看到。而*暗藏*则指的是尽量不被看到，比如使用伪装或融入阴影中。许多《万川集海》中描述的明装忍术技巧都可以在进攻和防守中同时使用。忍者不仅知道如何利用这些技巧进行攻击，还知道如何识别敌方的渗透者。间谍常常复制制服和纹章，或偷听密码，因此忍者发展出了识别对策，以区分盟友和敌人。
- en: 'One such identification technique was *matched pairs*, word combination challenges
    used to authenticate allies.^([1](b01.xhtml#endnote-36)) This technique is also
    known as *countersigns* or *challenge-response authentication*. The matched-pairs
    technique worked as follows: an unidentified person approached a guard at the
    gate of a castle and requested entry. The guard first checked to ensure that the
    stranger was wearing the correct uniform and bearing the proper crest. If they
    were, then the guard uttered a word—“tree,” for example. If the stranger did not
    respond with the correct prearranged match—“forest”—the guard knew they were dealing
    with an enemy. While the *Bansenshūkai* states that matched-pair phrases should
    be simple enough that “lower-rank” people can remember them, it advises against
    using common associations that an adversary might guess. So, instead of “snow”
    and “mountain,” a more desirable pair might be “snow” and “Mount Fuji.” The scroll
    recommends that shinobi work with commanders to generate 100 different pairs of
    matching words every 100 days and use a new pair every day.^([2](b01.xhtml#endnote-37))
    This large number of matching pairs would allow a sentry to rotate randomly through
    the list (if necessary) as each troop approached, making it unlikely that a disguised
    enemy could overhear the answer to the challenge word they would receive.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
- en: Matched pairs were used to reveal possible infiltrators. If the stranger answered
    the challenge incorrectly, they were quickly detained, interrogated, and possibly
    killed. Knowing these consequences, *Bansenshūkai* recommends that shinobi attempting
    to infiltrate an enemy camp style their appearance, behavior, and speech as that
    of a slovenly or lower-class soldier. This way, if they were asked to answer a
    matched-pair challenge they didn’t know, they could convincingly claim ignorance.^([3](b01.xhtml#endnote-38))
    Some readers may note that their financial institution has started implementing
    matched-word or image pairs for online authentication, but it should be noted
    that these websites do not require 100 different pairs and do not update them
    frequently, if at all. A small pool of static matched pairs makes it possible
    for an adversary to observe all the pairs and then perform unauthorized actions
    with the stolen authentication responses.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
- en: These historical examples underscore the challenges in trying to safeguard authentication
    from an advanced and dynamic adversary. In this chapter, we will touch on how
    difficult it can be to prove your identity, along with the various factors used
    in information assurance (IA) to authenticate someone’s identity. I will mention
    some of the techniques that modern cyber threat actors use to thwart the best
    efforts to authenticate only the correct people and highlight analogous shinobi
    tactics that illustrate why authentication will be a challenge for the foreseeable
    future. I will also provide readers with guidance on how they might apply shinobi
    authentication techniques to modern applications. The overall goal of this chapter
    is to help readers grasp the essential issues involved in this identification
    problem rather than getting lost in the expansive knowledge domain that authentication
    and cryptography have become.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 这些历史示例强调了在面对先进且动态的对手时，保护身份验证的挑战。在本章中，我们将讨论证明身份的困难，并介绍信息保障（IA）中用于身份验证的各种因素。我将提到一些现代网络威胁行为者用来阻挠身份验证的技术，强调类似忍者战术的策略，说明为什么身份验证在可预见的未来将是一项挑战。我还将为读者提供如何将忍者身份验证技术应用于现代应用程序的指导。本章的总体目标是帮助读者理解这一身份识别问题的关键问题，而不是迷失在身份验证和密码学这一广阔的知识领域中。
- en: Understanding Authentication
  id: totrans-12
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解身份验证
- en: '*Authentication* is the process of confirming a user’s identity before granting
    access to information systems, data, networks, physical grounds, and other resources.
    Authentication processes confirm user identities by asking for something the user
    knows, something the user has, or something the user is. For example, an authenticator
    might ask for a password (something the user knows), a token (something the user
    has), or a biometric (something the user is). Depending on the level of security
    necessary, organizations require *single-factor*, *two-factor*, or *multifactor*
    authentication.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '*身份验证*是确认用户身份的过程，在授予访问信息系统、数据、网络、物理场所和其他资源之前。身份验证过程通过询问用户所知道的内容、用户拥有的东西或用户本身的特征来确认用户身份。例如，身份验证器可能会要求输入密码（用户知道的东西）、令牌（用户拥有的东西）或生物特征（用户本身的特征）。根据所需的安全级别，组织可能需要*单因素*、*双因素*或*多因素*身份验证。'
- en: Mature organizations might also use *strong authentication*, which uses multiple
    layers of multifactor credentials. For example, the first step of strong authentication
    might require a username, password, and fingerprint, while the second step authenticates
    with a token and a onetime code sent over SMS. Increasingly, industry professionals
    are contemplating the feasibility of a fourth factor, such as a trusted person
    in the organization who would confirm the user’s identity. Interestingly, the
    matched-pair shinobi scenario starts with this test; the challenge is used only
    if no one in the area can validate the stranger’s identity.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 成熟的组织可能还会使用*强身份验证*，该方法使用多层次的多因素凭证。例如，强身份验证的第一步可能需要用户名、密码和指纹，而第二步则通过令牌和通过短信发送的一次性验证码进行验证。越来越多的行业专业人士正在考虑第四个因素的可行性，比如组织中的可信人员来确认用户的身份。有趣的是，匹配对忍者场景从这个测试开始；只有当周围没有人能够验证陌生人的身份时，才会使用这一挑战。
- en: Authentication failure is a critical security flaw. Users’ authenticated identities
    are tied to permissions that allow them to perform specific, often privileged,
    actions. An adversary who successfully piggybacks on a valid user’s authenticated
    connection has free access to the user’s resources and can conduct malicious activities
    on information systems, data, and networks.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 身份验证失败是一个关键的安全漏洞。用户的已验证身份与允许他们执行特定、通常是特权的操作的权限相关联。成功搭载在有效用户的身份验证连接上的对手，能够自由访问用户的资源，并可以在信息系统、数据和网络上进行恶意活动。
- en: Unfortunately, the authentication process is imperfect. Despite a slew of cyber
    authentication measures, it’s currently not possible to verify the identity of
    a user or process with complete certainty, as nearly every existing verification
    test can be spoofed (*spoofing* is the use of false data to impersonate another
    entity) or compromised. Adversaries use numerous techniques to steal passwords,
    intercept tokens, copy authentication hashes or tickets, and forge biometrics.
    If attackers gain unauthorized access to identity management systems, such as
    domain controllers, they can create and authenticate to fraudulently forged accounts.
    After users authenticate, their identities are rarely challenged during a session,
    unless password reentry is required to conduct privileged tasks. Similarly, shinobi
    in disguise could wander around the inside of a castle without being challenged—in
    both cases, it’s assumed those inside have been authenticated.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，认证过程并不完美。尽管有大量的网络认证措施，目前仍然无法完全确定地验证用户或进程的身份，因为几乎每个现有的验证测试都可能被伪造（*伪造*是使用虚假数据冒充其他实体）或被攻破。攻击者使用多种技术盗取密码、拦截令牌、复制认证哈希或票证，以及伪造生物识别数据。如果攻击者获得了身份管理系统的未经授权访问权限，如域控制器，他们可以创建和认证伪造的账户。用户认证后，他们的身份在会话期间很少受到挑战，除非需要重新输入密码以进行特权任务。同样，伪装成忍者的人也能在城堡内部自由行动而不被质疑——在这两种情况下，都假设内部人员已通过认证。
- en: Security technologies are evolving to fight authentication threats. One emerging
    solution, called *continuous* *authentication* or *active authentication*, constantly
    verifies user identities after the initial login. However, because continuous
    authentication dialogs might hinder the user experience, techniques are also being
    developed to monitor authentication through typing style, mouse movement, or other
    behavioral traits associated with user identities. Such techniques would catch
    adversaries who were physically accessing logged-in systems that had been left
    unattended, locking them out. This would also work with unauthorized remote access
    methods, such as Remote Desktop Protocol (RDP) sessions. Such techniques could
    identify attackers even if they used valid credentials and authenticators to log
    in. Of course, a person’s behavior may change. Moreover, even specific behaviors
    can be mimicked or simulated by sophisticated adversaries by incorporating user
    behavior reconnaissance into their attacks.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 安全技术正在不断发展，以应对认证威胁。一种新兴的解决方案，称为*持续* *认证*或*主动认证*，在初次登录后持续验证用户身份。然而，由于持续认证对话框可能会妨碍用户体验，因此也在开发一些技术，通过输入风格、鼠标移动或与用户身份相关的其他行为特征来监控认证。这些技术能够识别物理访问了无人看管的已登录系统的攻击者，将其锁定。这些技术同样适用于未经授权的远程访问方式，例如远程桌面协议（RDP）会话。即使攻击者使用有效的凭据和认证器登录，这些技术也能识别攻击者。当然，人的行为可能会发生变化。此外，即使是特定的行为，也可能被熟练的对手模仿或模拟，他们通过将用户行为侦察融入攻击中来实现。
- en: One possible implementation of the matched-pair model involves a human-machine
    interface that uses passive brainwave sensors connected to a system that verifies
    identity based on how the user thinks. Research demonstrates that humans generate
    unique brain patterns when they see an object with which they have interacted
    before or have a specific thought association. As such, showing a user controlled
    stimuli (such as matched-pair word or image combinations), monitoring the brain’s
    electrical responses, and matching them to a user profile could accurately authenticate
    the user. With enough unique challenge pairs dynamically generated with stylized
    permutations, it’s unlikely that adversaries could replay or simulate a user’s
    brainwave activity when prompted.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 匹配对模型的一种可能实现方式涉及使用被动脑波传感器的人工智能界面，这些传感器连接到一个基于用户思维模式来验证身份的系统。研究表明，当人类看到与自己有过互动的物体或有特定思维关联的物体时，会产生独特的脑波模式。因此，展示用户控制的刺激（如匹配对的词语或图像组合），监测大脑的电响应，并将其与用户档案匹配，可以准确地验证用户身份。通过动态生成足够多的独特挑战对，并使用风格化的排列组合，攻击者几乎不可能在提示下重放或模拟用户的脑波活动。
- en: In the next section, we’ll discuss some techniques you can use for matched-pair
    authentications.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将讨论一些可用于匹配对认证的技术。
- en: Developing Matched-Pair Authenticators
  id: totrans-20
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 开发匹配对认证器
- en: Following are a few suggestions for developing matched-pair authenticators and
    ideas for applying them.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是开发匹配对认证器的几个建议和应用思路。
- en: '**Work with the right commercial authentication vendors.** Seek out vendors
    that use challenge phrase authentication that is distinct from a user’s password,
    account name, or other identifying information that an adversary could compromise.
    While some financial organizations use matched-pair challenge phrases before they
    authorize account changes, unfortunately this method is typically used only when
    the user reports they’ve lost or forgotten their password, and the challenge phrases
    are static and don’t change.'
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**与合适的商业身份验证供应商合作。** 寻找使用与用户密码、账户名或其他可能被攻击者窃取的身份信息不同的挑战短语身份验证的供应商。尽管一些金融机构在授权账户更改之前使用匹配对挑战短语，但不幸的是，这种方法通常只在用户报告丢失或忘记密码时才会使用，而且挑战短语是静态的，不会发生变化。'
- en: '**Develop new authentication systems.** An authentication product might integrate
    with identity controls to present a matched-pair challenge to an authenticated
    user whenever they attempt to perform privileged actions, such as admin/root/system
    commands. Under this protocol, even if adversaries observed one or several challenge
    pairs, their request to perform privileged actions would be denied.'
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**开发新的身份验证系统。** 一款身份验证产品可以与身份控制系统集成，在经过身份验证的用户尝试执行特权操作（例如管理员/root/system 命令）时，向其展示一个匹配对挑战。在此协议下，即使攻击者观察到一个或多个挑战对，用户请求执行特权操作时也会被拒绝。'
- en: 'An ideal product uses two forms of matched-pair challenges: daily and user
    preset. The daily challenge, disseminated nondigitally in areas that are visible
    only to authorized personnel, challenges on-premise authentication requests with
    a word or image and asks the user to respond with the match. All other employees,
    including remote/VPN employees, establish a large set of matching word pairs that
    are not likely to be forgotten or misinterpreted. The organization chooses the
    pairs at random or rotates them to quickly pinpoint unauthorized users that have
    been authenticated on the network. (Note that to prevent an adversary from inserting
    their own matched pairs for compromised or spoofed credentials, there must be
    secured transmission, storage, and auditing of new matched pairs to the active
    challenge system.) Consider using a one-way interface to insert matched pairs
    in a secure controlled information facility (SCIF) or segmented room that requires
    manual authentication and authorization to enter and use. Other mechanisms could
    allow organizations to ambush an unidentified user by requiring access to their
    microphone, camera, location, running processes, running memory or cache, desktop
    screenshot, and other information on their connecting system, thereby better identifying
    the origin and identity of the threat.'
  id: totrans-24
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 理想的产品使用两种形式的匹配对挑战：每日挑战和用户预设挑战。每日挑战以非数字方式分发，只在授权人员可见的区域中展示，使用一个单词或图像挑战本地身份验证请求，并要求用户用匹配项作出回应。所有其他员工，包括远程/VPN
    员工，都会建立一组不容易忘记或误解的大量匹配单词对。组织可以随机选择这些对，或定期轮换它们，以便快速识别在网络上已通过身份验证的未经授权用户。（请注意，为防止攻击者插入他们自己的匹配对来伪造或篡改凭证，必须对新的匹配对进行安全传输、存储和审计。）考虑在需要手动身份验证和授权进入的安全受控信息设施（SCIF）或隔离房间中，使用单向接口插入匹配对。其他机制还可以让组织通过要求访问用户的麦克风、摄像头、位置、正在运行的进程、内存或缓存、桌面截图等信息，来更好地识别威胁的来源和身份。
- en: Recommended Security Controls and Mitigations
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 推荐的安全控制和缓解措施
- en: Where relevant, recommendations are presented with an applicable security control
    from the NIST 800-53 standard. Each should be evaluated in the context of matched-pair
    identification and authentication challenge responses.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 在相关情况下，推荐的方案会与 NIST 800-53 标准中的适用安全控制一起呈现。每个方案都应在匹配对标识和身份验证挑战响应的背景下进行评估。
- en: 'Implement session locks after set periods of time for privileged accounts,
    upon privileged user requests, or in reaction to suspicious behavior. Only reestablish
    access after the user provides a matched-pair challenge response. (A session lock
    may be preferable to a normal password lock because the challenge pair match is
    a single click or a simpler word than the user’s account password.) [AC-11: Session
    Lock; IA-2: Identification and Authentication (Organizational Users) | (1) Network
    Access to Privileged Accounts | (3) Local Access to Privileged Accounts; IA-10:
    Adaptive Identification and Authentication; IA-11: Re-Authentication]'
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Identify, document, and enforce security controls on which user actions may
    be performed on a system without passing the matched-pair challenge response—for
    example, contacting technical support or making emergency calls. [AC-14: Permitted
    Actions Without Identification or Authentication]'
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Develop matched-pair authentication processes that are resistant to replay
    attacks by establishing large sets of onetime challenge response authenticators.
    [IA-2: Identification and Authentication (Organizational Users) | (8) Network
    Access to Privileged Accounts—Replay Resistant]'
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Capture information that uniquely identifies user devices requesting authentication
    to gain intelligence on unidentified adversaries who fail the matched-pair challenge
    response. [IA-3: Device Identification and Authentication | (4) Device Attestation]'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Require in-person matched-pair input to mitigate compromise of the challenge
    response identification system. [IA-4: Identifier Management | (7) In-Person Registration]'
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Physically and logically segregate the matched-pair challenge response system
    and enforce strict access controls to safeguard it against compromise. [IA-5:
    Authenticator Management | (6) Protection of Authenticators]'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Debrief
  id: totrans-33
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This chapter highlighted the challenges faced by commanders who needed to verify
    the identity of their troops to prevent disguised shinobi from infiltrating their
    fortifications. You learned about the matched-pair identification technique, both
    how it was used by shinobi to detect enemies and what safeguards shinobi took
    against the technique when on the offensive. You also saw the modern analogs of
    this technique in computer security authentication and identification.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, you will use your understanding of authentication factors
    and historical challenge response to learn how two-step authentication is different
    from but complementary to matched pairs. I will discuss a concealed shinobi authentication
    technique, the double-sealed password, which can be used to detect sophisticated
    infiltrators.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
