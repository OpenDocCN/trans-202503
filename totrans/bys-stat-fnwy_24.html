<html><head></head><body>
<h2 class="h2" id="app01"><span epub:type="pagebreak" id="page_195"/><strong><span class="big">A</span><br/>A QUICK INTRODUCTION TO R</strong></h2>&#13;
<div class="image1"><img alt="Image" src="../images/common.jpg"/></div>&#13;
<p class="noindent">In this book, we use the R programming language to do some tricky mathematical work for us. R is a programming language that specializes in statistics and data science. If you don’t have experience with R, or with programming in general, don’t worry—this appendix will get you started.</p>&#13;
<h3 class="h3" id="app01lev1sec1"><span epub:type="pagebreak" id="page_196"/><strong>R and RStudio</strong></h3>&#13;
<p class="noindent">To run the code examples in this book, you’ll need to have R installed on your computer. To install R, visit <em><a href="https://cran.rstudio.com/">https://cran.rstudio.com/</a></em> and follow the installation steps for the operating system you’re using.</p>&#13;
<p class="indent">Once you’ve installed R, you should also install <em>RStudio</em>, an integrated development environment (IDE) that makes it extremely easy to run R projects. Download and install RStudio from <em><a href="http://www.rstudio.com/products/rstudio/download/">www.rstudio.com/products/rstudio/download/</a></em>.</p>&#13;
<p class="indent">When you open RStudio, you should be greeted with several panels (<a href="app01.xhtml#app01fig01">Figure A-1</a>).</p>&#13;
<div class="image"><a id="app01fig01"/><img alt="Image" src="../images/afig01.jpg"/></div>&#13;
<p class="figcap"><em>Figure A-1: Viewing the console in RStudio</em></p>&#13;
<p class="indent">The most important panel is the big one in the middle, called the <em>console</em>. In the console, you can enter any of the code examples from the book and run them simply by pressing <small>ENTER</small>. The console runs all the code you enter immediately, which makes it hard to keep track of the code you’ve written so far.</p>&#13;
<p class="indent">To write programs that you can save and come back to, you can place your code in an <em>R script</em>, which is a text file that you can load into the console later. R is an extremely interactive programming language, so rather than thinking of the console as a place you can test out code, think of R scripts as a way to quickly load tools you can use in the console.</p>&#13;
<h3 class="h3" id="app01lev1sec2"><span epub:type="pagebreak" id="page_197"/><strong>Creating an R Script</strong></h3>&#13;
<p class="noindent">To create an R script, go to <strong>File<span class="ent">▸</span>New File<span class="ent">▸</span>R Script</strong> in RStudio. This should create a new blank panel in the top left (<a href="app01.xhtml#app01fig02">Figure A-2</a>).</p>&#13;
<div class="image"><a id="app01fig02"/><img alt="Image" src="../images/afig02.jpg"/></div>&#13;
<p class="figcap"><em>Figure A-2: Creating an R script</em></p>&#13;
<p class="indent">In this panel, you can enter code and save it as a file. To run the code, simply click the <strong>Source</strong> button at the top right of the panel, or run individual lines by clicking the <strong>Run</strong> button. The Source button will automatically load your file into the console as though you had typed it there yourself.</p>&#13;
<h3 class="h3" id="app01lev1sec3"><strong>Basic Concepts in R</strong></h3>&#13;
<p class="noindent">We’ll be using R as an advanced calculator in this book, which means you’ll only need to understand a few basics to work through the problems and extend the examples in the book on your own.</p>&#13;
<h4 class="h4" id="app01lev2sec1"><strong><em>Data Types</em></strong></h4>&#13;
<p class="noindent">All programming languages have different types of data, which you can use for different purposes and manipulate in different ways. R has a rich variety of types and data structures, but we’ll only be using a very small number of them in this book.</p>&#13;
<h5 class="h5" id="app01lev3sec1"><span epub:type="pagebreak" id="page_198"/><strong>Doubles</strong></h5>&#13;
<p class="noindent">The numbers we use in R will all be of the type <em>double</em> (short for “double-precision floating-point,” which is the most common way to represent decimal numbers on a computer). The double is the default type for representing decimal numbers. Unless otherwise specified, all numbers you enter into the console are of the double type.</p>&#13;
<p class="indent">We can manipulate numbers in the double type using standard mathematical operations. For example, we can add two numbers with the <span class="literal">+</span> operator. Try this out in the console:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">5 + 2</span><br/>&#13;
[1] 7</p>&#13;
<p class="indent">We can also divide any numbers that give us decimal results using the <span class="literal">/</span> operator:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">5/2</span><br/>&#13;
[1] 2.5</p>&#13;
<p class="indent">We can multiply values with the <span class="literal">*</span> operator like so:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">5 * 2</span><br/>&#13;
[1] 10</p>&#13;
<p class="noindent">and take the exponential of a value using the <span class="literal">^</span> operator. For example, 5<sup>2</sup> is:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">5^2</span><br/>&#13;
[1] 25</p>&#13;
<p class="indent">We can also add <span class="literal">-</span> in front of a number to make it negative:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">5 - -2</span><br/>&#13;
[1] 7</p>&#13;
<p class="indent">And we can also use scientific notation with <span class="literal">e+</span>. So 5 × 10<sup>2</sup> is just:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">5e+2</span><br/>&#13;
[1] 500</p>&#13;
<p class="indent">If we use <span class="literal">e-</span> we get the same result as 5 × 10<sup>–2</sup>:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">5e-2</span><br/>&#13;
[1] 0.05</p>&#13;
<p class="indent">This is useful to know because sometimes R will return the result in scientific notation if it is too large to easily fit on the screen, like so:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">5*10^20</span><br/>&#13;
[1] 5e+20</p>&#13;
<h5 class="h5" id="app01lev3sec2"><span epub:type="pagebreak" id="page_199"/><strong>Strings</strong></h5>&#13;
<p class="noindent">Another important type in R is the <em>string</em>, which is just a group of characters used to represent text. In R, we surround a string with quotation marks, like this:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">"hello"</span><br/>&#13;
[1] "hello"</p>&#13;
<p class="indent">Note that if you put a number inside a string, you can’t use that number in regular numeric operations because strings and numbers are different types. For example:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">"2" + 2</span><br/>&#13;
Error in "2" + 2 : non-numeric argument to binary operator</p>&#13;
<p class="indent">We won’t be making much use of strings in this book. We’ll primarily use them to pass arguments to functions and to give labels to plots. But it’s important to remember them if you’re using text.</p>&#13;
<h5 class="h5" id="app01lev3sec3"><strong>Logicals</strong></h5>&#13;
<p class="noindent"><em>Logical</em> or <em>binary</em> types are true or false values represented by the codes <span class="literal">TRUE</span> and <span class="literal">FALSE</span>. Note that <span class="literal">TRUE</span> and <span class="literal">FALSE</span> aren’t strings—they’re not surrounded by quotes, and they’re written in all uppercase. (R also allows you to simply use <span class="literal">T</span> or <span class="literal">F</span> instead of writing out the full words.)</p>&#13;
<p class="indent">We can combine logical types with the symbols <span class="literal">&amp;</span> (“and”) and <span class="literal">|</span> (“or”) to perform basic logical operations. For example, if we wanted to know whether it’s possible for something to be both true <em>and</em> false at the same time, we might enter:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">TRUE &amp; FALSE</span></p>&#13;
<p class="indent">R would return:</p>&#13;
<p class="programs">[1] FALSE</p>&#13;
<p class="noindent">telling us that a value can’t be both true and false.</p>&#13;
<p class="indent">But what about true <em>or</em> false?</p>&#13;
<p class="programs">&gt; <span class="codestrong1">TRUE | FALSE</span><br/>&#13;
[1] TRUE</p>&#13;
<p class="indent">Like strings, in this book logical values will primarily be used to provide arguments to functions we’ll be using, or as the results of comparing two different values.</p>&#13;
<h4 class="h4" id="app01lev2sec2"><span epub:type="pagebreak" id="page_200"/><strong><em>Missing Values</em></strong></h4>&#13;
<p class="noindent">In practical statistics and data science, data is often missing some values. For example, say you have temperature data for the morning and afternoon of every day for a month, but something malfunctioned one day and you’re missing a morning temperature. Because missing values are so common, R has a special way of representing them: using the value <span class="literal">NA</span>. It’s important to have a way to handle missing values because they can mean very different things in different contexts. For example, when you’re measuring rainfall a missing value might mean there was no rain in the gauge, or it might mean that there was plenty of rain but temperatures were freezing that night, cracking the gauge and causing all the water to leak out. In the first case, we might consider missing values to mean 0, but in the latter case it’s not clear what the value should be. Keeping missing values separate from other values forces us to consider these differences.</p>&#13;
<p class="indent">To prompt us to make sense of what our missing values are whenever we try to use one, R will output <span class="literal">NA</span> for any operation using a missing value:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">NA + 2</span><br/>&#13;
[1] NA</p>&#13;
<p class="indent">As we’ll see in a bit, various functions in R can handle missing values in different ways, but you shouldn’t have to worry about missing values for the R you’ll use in this book.</p>&#13;
<h4 class="h4" id="app01lev2sec3"><strong><em>Vectors</em></strong></h4>&#13;
<p class="noindent">Nearly every programming language contains certain features that make it unique and especially suited to solving problems in its domain. R’s special feature is that it is a <em>vector language</em>. A vector is a list of values, and everything R does is an operation on a vector. We use the code <span class="literal">c(...)</span> to define vectors (but even if we put in just a single value, R does this for us!).</p>&#13;
<p class="indent">To understand how vectors work, let’s consider an example. Enter the next example in a script, rather than the console. We first create a new vector by assigning the variable <span class="literal">x</span> to the vector <span class="literal">c(1,2,3)</span> using the assignment operator <span class="literal">&lt;-</span> like so:</p>&#13;
<p class="programs">x &lt;- c(1,2,3)</p>&#13;
<p class="indent">Now that we have a vector, we can use it in our calculations. When we perform a simple operation, like adding <span class="literal">3</span> to <span class="literal">x</span>, when we enter this in the console, we get a rather unexpected result (especially if you’re used to another programming language):</p>&#13;
<p class="programs">&gt; <span class="codestrong1">x + 3</span><br/>&#13;
[1] 4 5 6</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_201"/>The result of <span class="literal">x + 3</span> tells us what happens if we add <span class="literal">3</span> to each value in our <span class="literal">x</span> vector. (In many other programming languages, we’d need to use a <span class="literal">for</span> loop or some other iterator to perform this operation.)</p>&#13;
<p class="indent">We can also add vectors to each other. Here, we’ll create a new vector containing three elements, each with a value of <span class="literal">2</span>. We’ll name this vector <span class="literal">y</span>, then add <span class="literal">y</span> to <span class="literal">x</span>:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">y &lt;- c(2,2,2)</span><br/>&#13;
&gt; <span class="codestrong1">x + y</span><br/>&#13;
[1] 3 4 5</p>&#13;
<p class="indent">As you can see, this operation added each element in <span class="literal">x</span> to its corresponding element in <span class="literal">y</span>.</p>&#13;
<p class="indent">What if we multiply our two vectors?</p>&#13;
<p class="programs">&gt; <span class="codestrong1">x * y</span><br/>&#13;
[1] 2 4 6</p>&#13;
<p class="indent">Each value in <span class="literal">x</span> was multiplied by its corresponding value in <span class="literal">y</span>. If the lists weren’t the same size, or a multiple of the same size, then we’d get an error. If a vector is a multiple of the same size, R will just repeatedly apply the smaller vector to the larger one. However, we won’t be making use of this feature in this book.</p>&#13;
<p class="indent">We can quite easily combine vectors in R by defining another vector based on the existing ones. Here, we’ll create the vector <span class="literal">z</span> by combining <span class="literal">x</span> and <span class="literal">y</span>:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">z &lt;- c(x,y)</span><br/>&#13;
&gt; <span class="codestrong1">z</span><br/>&#13;
[1] 1 2 3 2 2 2</p>&#13;
<p class="indent">Notice that this operation didn’t give us a vector of vectors; instead, we got a single vector that contains the values from both, in the order you set <span class="literal">x</span> and <span class="literal">y</span> when you defined <span class="literal">z</span>.</p>&#13;
<p class="indent">Learning to use vectors efficiently in R can be a bit tricky for beginners. Ironically, programmers who are experienced in a non-vector-based language often have the most difficulty. Don’t worry, though: in this book, we’ll use vectors to make reading code easier.</p>&#13;
<h3 class="h3" id="app01lev1sec4"><strong>Functions</strong></h3>&#13;
<p class="noindent"><em>Functions</em> are blocks of code that perform a particular operation on a value, and we’ll use them in R to solve problems.</p>&#13;
<p class="indent">In R and RStudio, all functions come equipped with documentation. If you enter <span class="literal">?</span> followed by a function name into the R console, you’ll get the full documentation for that function. For example, if you enter <span class="literal">?sum</span> into the RStudio console, you should see the documentation shown in <a href="app01.xhtml#app01fig03">Figure A-3</a> in the bottom-right screen.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_202"/><a id="app01fig03"/><img alt="Image" src="../images/afig03.jpg"/></div>&#13;
<p class="figcap"><em>Figure A-3: Viewing the documentation for the <span class="codeitalic">sum()</span> function</em></p>&#13;
<p class="indent">This documentation gives us the definition of the <span class="literal">sum()</span> function and some of its uses. The <span class="literal">sum()</span> function takes a vector’s values and adds them all together. The documentation says it takes <span class="literal">...</span> as an argument, which means it can accept any number of values. Usually these values will be a vector of numbers, but they can consist of multiple vectors, too.</p>&#13;
<p class="indent">The documentation also lists an <em>optional argument</em>: <span class="literal">na.rm = FALSE</span>. Optional arguments are arguments that you don’t have to pass in to the function for it to work; if you don’t pass an optional argument in, R will use the argument’s default value. In the case of <span class="literal">na.rm</span>, which automatically removes any missing values, the default value, after the equal sign, is <span class="literal">FALSE</span>. That means that, by default, <span class="literal">sum()</span> won’t remove missing values.</p>&#13;
<h4 class="h4" id="app01lev2sec4"><strong><em>Basic Functions</em></strong></h4>&#13;
<p class="noindent">Here are some of R’s most important functions.</p>&#13;
<h5 class="h5" id="app01lev3sec4"><strong>The length() and nchar() Functions</strong></h5>&#13;
<p class="noindent">The <span class="literal">length()</span> function will return the length of a vector:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">length(c(1,2,3))</span><br/>&#13;
[1] 3</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_203"/>Since there are three elements in this vector, the <span class="literal">length()</span> function returns <span class="literal">3</span>.</p>&#13;
<p class="indent">Because everything in R is a vector, you can use the <span class="literal">length()</span> function to find the length of anything—even a string, like <span class="literal">“doggies”</span>:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">length("doggies")</span><br/>&#13;
[1] 1</p>&#13;
<p class="indent">R tells us that <span class="literal">“doggies”</span> is a vector containing one string.</p>&#13;
<p class="indent">Now, if we had two strings, <span class="literal">“doggies”</span> and <span class="literal">“cats”</span>, we’d get:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">length(c("doggies","cats"))</span><br/>&#13;
[1] 2</p>&#13;
<p class="indent">To find the number of characters in a string, we use the <span class="literal">nchar()</span> function:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">nchar("doggies")</span><br/>&#13;
[1] 7</p>&#13;
<p class="indent">Note that if we use <span class="literal">nchar()</span> on the <span class="literal">c(“doggies”,”cats”)</span> vector, R returns a new vector containing the number of characters in each string:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">nchar(c("doggies","cats"))</span><br/>&#13;
[1] 7 4</p>&#13;
<h5 class="h5" id="app01lev3sec5"><strong>The sum(), cumsum(), and diff() Functions</strong></h5>&#13;
<p class="noindent">The <span class="literal">sum()</span> function takes a vector of numbers and adds all those numbers together:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">sum(c(1,1,1,1,1))</span><br/>&#13;
[1] 5</p>&#13;
<p class="indent">As we saw in the documentation in the previous section, <span class="literal">sum()</span> takes <span class="literal">...</span> as its argument, which means it can accept any number of values:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">sum(2,3,1)</span><br/>&#13;
[1] 6<br/>&#13;
&gt; <span class="codestrong1">sum(c(2,3),1)</span><br/>&#13;
[1] 6<br/>&#13;
&gt; <span class="codestrong1">sum(c(2,3,1))</span><br/>&#13;
[1] 6</p>&#13;
<p class="indent">As you can see, no matter how many vectors we provide, <span class="literal">sum()</span> adds them up as though they were a single vector of integers. If you wanted to sum up multiple vectors, you’d call <span class="literal">sum()</span> on them each separately.</p>&#13;
<p class="indent">Remember, also, that the <span class="literal">sum()</span> function takes the optional argument <span class="literal">na.rm</span>, which by default is set to <span class="literal">FALSE</span>. The <span class="literal">na.rm</span> argument determines if <span class="literal">sum()</span> removes <span class="literal">NA</span> values or not.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_204"/>If we leave <span class="literal">na.rm</span> set to <span class="literal">FALSE</span>, here’s what happens if we try to use <span class="literal">sum()</span> on a vector with a missing value:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">sum(c(1,NA,3))</span><br/>&#13;
[1] NA</p>&#13;
<p class="indent">As we saw when <span class="literal">NA</span> was introduced, adding a value to an <span class="literal">NA</span> value results in <span class="literal">NA</span>. If we’d like R to give us a number as an answer instead, we can tell <span class="literal">sum()</span> to remove <span class="literal">NA</span> values by setting <span class="literal">na.rm = TRUE</span>:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">sum(c(1,NA,3),na.rm = TRUE)</span><br/>&#13;
[1] 4</p>&#13;
<p class="indent">The <span class="literal">cumsum()</span> function takes a vector and calculates its <em>cumulative sum</em>—a vector of the same length as the input that replaces each number with the sum of the numbers that come before it (including that number). Here’s an example in code to make this clearer:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">cumsum(c(1,1,1,1,1))</span><br/>&#13;
[1] 1 2 3 4 5<br/>&#13;
&gt; <span class="codestrong1">cumsum(c(2,10,20))</span><br/>&#13;
[1] 2 12 32</p>&#13;
<p class="indent">The <span class="literal">diff()</span> function takes a vector and subtracts each number from the number that precedes it in the vector:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">diff(c(1,2,3,4,5))</span><br/>&#13;
[1] 1 1 1 1<br/>&#13;
&gt; <span class="codestrong1">diff(c(2,10,3))</span><br/>&#13;
[1]  8 -7</p>&#13;
<p class="indent">Notice that the result of the <span class="literal">diff()</span> function contains one fewer element than the original vector did. That’s because nothing gets subtracted from the first value in the vector.</p>&#13;
<h5 class="h5" id="app01lev3sec6"><strong>The : operator and the seq() Function</strong></h5>&#13;
<p class="noindent">Often, rather than manually listing each element of a vector, we’d prefer to generate vectors automatically. To automatically create a vector of whole numbers in a certain range, we can use the <span class="literal">:</span> operator to separate the start and end of the range. R can even figure out if you want to count up or down (the <span class="literal">c()</span> wrapping this operator is not strictly necessary):</p>&#13;
<p class="programs">&gt; <span class="codestrong1">c(1:5)</span><br/>&#13;
[1] 1 2 3 4 5<br/>&#13;
<br/>&#13;
&gt; <span class="codestrong1">c(5:1)</span><br/>&#13;
[1] 5 4 3 2 1</p>&#13;
<p class="indent">When you use <span class="literal">:</span>, R will count from the first value to the last.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_205"/>Sometimes we’ll want to count by something other than increments of one. The <span class="literal">seq()</span> function allows us to create vectors of a sequence of values that increment by a specified amount. The arguments to <span class="literal">seq()</span> are, in order:</p>&#13;
<ol>&#13;
<li class="noindent">The start of the sequence</li>&#13;
<li class="noindent">The end of the sequence</li>&#13;
<li class="noindent">The amount to increment the sequence by</li>&#13;
</ol>&#13;
<p class="indent">Here are some examples of using <span class="literal">seq()</span>:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">seq(1,1.1,0.05)</span><br/>&#13;
[1] 1.00 1.05 1.10<br/>&#13;
<br/>&#13;
&gt; <span class="codestrong1">seq(0,15,5)</span><br/>&#13;
[1]  0  5 10 15<br/>&#13;
<br/>&#13;
&gt; <span class="codestrong1">seq(1,2,0.3)</span><br/>&#13;
[1] 1.0 1.3 1.6 1.9</p>&#13;
<p class="indent">If we want to count down to a certain value using the <span class="literal">seq()</span> function, we use a minus value as our increment, like this:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">seq(10,5,-1)</span><br/>&#13;
[1] 10  9  8  7  6  5</p>&#13;
<h5 class="h5" id="app01lev3sec7"><strong>The ifelse() Function</strong></h5>&#13;
<p class="noindent">The <span class="literal">ifelse()</span> function tells R to take one of two actions based on some condition. This function can be a bit confusing if you’re used to the normal <span class="literal">if ... else</span> control structure in other languages. In R, it takes the following three arguments (in order):</p>&#13;
<ol>&#13;
<li class="noindent">A statement about a vector that may be either true or false of its values</li>&#13;
<li class="noindent">What happens in the case that the statement is true</li>&#13;
<li class="noindent">What happens in the case that the statement is false</li>&#13;
</ol>&#13;
<p class="indent">The <span class="literal">ifelse()</span> function operates on entire vectors at once. When it comes to vectors containing a single value, its use is pretty intuitive:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">ifelse(2 &lt; 3,"small","too big")</span><br/>&#13;
[1] "small"</p>&#13;
<p class="indent">Here the statement is that 2 is smaller than 3, and we ask R to output <span class="literal">“small”</span> if it is, and <span class="literal">“too big”</span> if it isn’t.</p>&#13;
<p class="indent">Suppose we have a vector <span class="literal">x</span> that contains multiple values:</p>&#13;
<p class="programs"><span class="codestrong1">&gt; x &lt;- c(1,2,3)</span></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_206"/>The <span class="literal">ifelse()</span> function will return a value for each element in the vector:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">ifelse(x &lt; 3,"small","too big")</span><br/>&#13;
[1] "small"   "small"   "too big"</p>&#13;
<p class="indent">We can also use vectors in the results arguments for the <span class="literal">ifelse()</span>. Suppose that, in addition to our <span class="literal">x</span> vector, we had another vector, <span class="literal">y</span>:</p>&#13;
<p class="programs"><span class="codestrong1">y &lt;- c(2,1,6)</span></p>&#13;
<p class="indent">We want to generate a new list that contains the greatest value from <span class="literal">x</span> and <span class="literal">y</span> for each element in the vector. We could use <span class="literal">ifelse()</span> to solve this very simply:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">ifelse(x &gt; y,x,y)</span><br/>&#13;
[1] 2 2 6</p>&#13;
<p class="indent">You can see R has compared the values in <span class="literal">x</span> to the respective value in <span class="literal">y</span> and outputs the largest of the two for each element.</p>&#13;
<h3 class="h3" id="app01lev1sec5"><strong>Random Sampling</strong></h3>&#13;
<p class="noindent">We’ll often use R to randomly sample values. This allows us to have the computer pick a random number or value for us. We use this sample to simulate activities like flipping a coin, playing “rock, paper, scissors,” or picking a number between 1 and 100.</p>&#13;
<h4 class="h4" id="app01lev2sec5"><strong><em>The runif() Function</em></strong></h4>&#13;
<p class="noindent">One way to randomly sample values is with the function <span class="literal">runif()</span>, short for “random uniform,” which takes a required argument <span class="literal">n</span> and gives that many samples in the range 0 to 1:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">runif(5)</span><br/>&#13;
[1] 0.8688236 0.1078877 0.6814762 0.9152730 0.8702736</p>&#13;
<p class="indent">We can use this function with <span class="literal">ifelse()</span> to generate a value <span class="literal">A</span> 20 percent of the time. In this case we’ll use <span class="literal">runif(5)</span> to create five random values between 0 and 1. Then if the value is less than 0.2, we’ll return <span class="literal">“A”</span>; otherwise, we’ll return <span class="literal">“B”</span>:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">ifelse(runif(5) &lt; 0.2,"A","B")</span><br/>&#13;
[1] "B" "B" "B" "B" "A"</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_207"/>Since the numbers we’re generating are random, we’ll get a different result each time we run the <span class="literal">ifelse()</span> function. Here are some possible outcomes:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">ifelse(runif(5) &lt; 0.2,"A","B")</span><br/>&#13;
[1] "B" "B" "B" "B" "B"<br/>&#13;
&gt; <span class="codestrong1">ifelse(runif(5) &lt; 0.2,"A","B")</span><br/>&#13;
 [1] "A" "A" "B" "B" "B"</p>&#13;
<p class="indent">The <span class="literal">runif()</span> function can take optional second and third arguments, which are the minimum and maximum values of the range to be uniformly sampled from. By default, the function uses the range between 0 and 1 inclusive, but you can set the range to be whatever you’d like:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">runif(5,0,2)</span><br/>&#13;
[1] 1.4875132 0.9368703 0.4759267 1.8924910 1.6925406</p>&#13;
<h4 class="h4" id="app01lev2sec6"><strong><em>The rnorm() Function</em></strong></h4>&#13;
<p class="noindent">We can also sample from a normal distribution using the <span class="literal">rnorm()</span> function, which we’ll discuss in more depth in the book (the normal distribution is covered in <a href="ch12.xhtml#ch12">Chapter 12</a>):</p>&#13;
<p class="programs">&gt; <span class="codestrong1">rnorm(3)</span><br/>&#13;
[1]  0.28352476  0.03482336 -0.20195303</p>&#13;
<p class="indent">By default, <span class="literal">rnorm()</span> samples from a normal distribution with a mean of 0 and standard deviation of 1, as is the case in this example. For readers unfamiliar with the normal distribution, this means that samples will have a “bell-shaped” distribution around 0, with most samples being close to 0 and very few being less than –3 or greater than 3.</p>&#13;
<p class="indent">The <span class="literal">rnorm()</span> function has two optional arguments, <span class="literal">mean</span> and <span class="literal">sd</span>, which allow you to set a different mean and standard deviation, respectively:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">rnorm(4,mean=2,sd=10)</span><br/>&#13;
[1] -12.801407  -9.648737   1.707625  -8.232063</p>&#13;
<p class="indent">In statistics, sampling from a normal distribution is often more common than sampling from a uniform distribution, so <span class="literal">rnorm()</span> comes in quite handy.</p>&#13;
<h4 class="h4" id="app01lev2sec7"><strong><em>The sample() Function</em></strong></h4>&#13;
<p class="noindent">Sometimes, we want to sample from something other than just a well-studied distribution. Suppose you have a drawer containing socks of many colors:</p>&#13;
<p class="programs"><span class="codestrong1">socks &lt;- c("red","grey","white","red","black")</span></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_208"/>If you wanted to simulate the act of randomly picking any two socks, you could use R’s <span class="literal">sample()</span> function, which takes as arguments a vector of values and the number of elements to sample:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">sample(socks,2)</span><br/>&#13;
[1] "grey" "red"</p>&#13;
<p class="indent">The <span class="literal">sample()</span> function behaves as though we’ve picked two random socks out of the drawer—without putting any back. If we sample five socks, we’ll get all of the socks we originally had in the drawer:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">sample(socks,5)</span><br/>&#13;
[1] "grey"  "red"   "red"   "black" "white"</p>&#13;
<p class="indent">That means that if we try to take six socks from the drawer where there are only five available socks, we’ll get an error:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">sample(socks,6)</span><br/>&#13;
Error in sample.int(length(x), size, replace, prob) :<br/>&#13;
  cannot take a sample larger than the population when 'replace = FALSE'</p>&#13;
<p class="indent">If we want to both sample and “put the socks back,” we can set the optional argument <span class="literal">replace</span> to <span class="literal">TRUE</span>. Now, each time we sample a sock, we put it back in the drawer. This allows us to sample more socks than are in the drawer. It also means the distribution of socks in the drawer never changes.</p>&#13;
<p class="programs">&gt; <span class="codestrong1">sample(socks,6,replace=TRUE)</span><br/>&#13;
[1] "black" "red"   "black" "red"   "black" "black"</p>&#13;
<p class="indent">With these simple sampling tools, you can run surprisingly sophisticated simulations in R that save you from doing a lot of math.</p>&#13;
<h4 class="h4" id="app01lev2sec8"><strong><em>Using set.seed() for Predictable Random Results</em></strong></h4>&#13;
<p class="noindent">The “random numbers” generated by R aren’t truly random numbers. As in all programming languages, random numbers are generated by a <em>pseudorandom number generator</em>, which takes a <em>seed value</em> and uses that to create a sequence of numbers that are random enough for most purposes. The seed value sets the initial state of the random number generator and determines which numbers will come next in the sequence. In R, we can manually set this seed using the <span class="literal">set.seed()</span> function. Setting the seed is extremely useful for cases when we want to use the same random results again:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">set.seed(1337)</span><br/>&#13;
&gt; <span class="codestrong1">ifelse(runif(5) &lt; 0.2,"A","B")</span><br/>&#13;
[1] "B" "B" "A" "B" "B"<br/>&#13;
<br/>&#13;
<span epub:type="pagebreak" id="page_209"/>&gt; <span class="codestrong1">set.seed(1337)</span><br/>&#13;
&gt; <span class="codestrong1">ifelse(runif(5) &lt; 0.2,"A","B")</span><br/>&#13;
[1] "B" "B" "A" "B" "B"</p>&#13;
<p class="indent">As you can see, when we used the same seed twice with the <span class="literal">runif()</span> function, it generated the same set of supposedly random values. The main benefit of using <span class="literal">set.seed()</span> is making the results reproducible. This can make tracking down bugs in programs that involve sampling much easier, since the results don’t change each time the program is run.</p>&#13;
<h3 class="h3" id="app01lev1sec6"><strong>Defining Your Own Functions</strong></h3>&#13;
<p class="noindent">Sometimes it’s helpful to write our own functions for specific operations we’ll have to perform repeatedly. In R, we can define functions using the keyword <span class="literal">function</span> (a <em>keyword</em> in a programming language is simply a special word reserved by the programming language for a specific use).</p>&#13;
<p class="indent">Here’s the definition of a function that takes a single argument, <span class="literal">val</span>—which here stands for the value the user will input to the function—and then doubles <span class="literal">val</span> and cubes it.</p>&#13;
<p class="programs">double_then_cube &lt;- function(val){<br/>&#13;
  (val*2)^3<br/>&#13;
}</p>&#13;
<p class="indent">Once we’ve defined our function, we can use it, just like R’s built-in functions. Here’s our <span class="literal">double_then_cube()</span> function applied to the number 8:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">double_then_cube(8)</span><br/>&#13;
[1] 4096</p>&#13;
<p class="indent">Also, because everything we did to define our function is <em>vectorized</em> (that is, all values work on vectors of values), our function will work on vectors as well as single values:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">double_then_cube(c(1,2,3))</span><br/>&#13;
[1] 8 64 216</p>&#13;
<p class="indent">We can define functions that take more than one argument as well. The <span class="literal">sum_then_square()</span> function, defined here, adds two arguments together, then squares the result:</p>&#13;
<p class="programs">sum_then_square &lt;- function(x,y){<br/>&#13;
  (x+y)^2<br/>&#13;
}</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_210"/>By including the two arguments <span class="literal">(x,y)</span> in the function definition, we’re telling R the <span class="literal">sum_then_square()</span> function expects two arguments. Now we can use our new function, like this:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">sum_then_square(2,3)</span><br/>&#13;
[1] 25<br/>&#13;
&gt; <span class="codestrong1">sum_then_square(c(1,2),c(5,3))</span><br/>&#13;
[1] 36 25</p>&#13;
<p class="indent">We can also define functions that require multiple lines. In R, when a function is called it will always return the result of the calculation on the final line of the function definition. That means we could have rewritten <span class="literal">sum_then_square()</span> like this:</p>&#13;
<p class="programs">sum_then_square &lt;- function(x,y){<br/>&#13;
  sum_of_args &lt;- x+y<br/>&#13;
  square_of_result &lt;- sum_of_args^2<br/>&#13;
  square_of_result<br/>&#13;
}</p>&#13;
<p class="indent">Typically, when you write functions, you’ll want to write them in an R script file so you can save them and reuse them later.</p>&#13;
<h3 class="h3" id="app01lev1sec7"><strong>Creating Basic Plots</strong></h3>&#13;
<p class="noindent">In R, we can quickly generate plots of data very easily. Though R has an extraordinary plotting library called <span class="literal">ggplot2</span>, which contains many useful functions for generating beautiful plots, we’ll restrict ourselves to R’s base plotting functions for now, which are plenty useful on their own.</p>&#13;
<p class="indent">To show how plotting works, we’ll create two vectors of values, our <span class="literal">xs</span> and our <span class="literal">ys</span>:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">xs &lt;- c(1,2,3,4,5)</span><br/>&#13;
&gt; <span class="codestrong1">ys &lt;- c(2,3,2,4,6)</span></p>&#13;
<p class="indent">Next, we can use these vectors as arguments to the <span class="literal">plot()</span> function, which will plot our data for us. The <span class="literal">plot()</span> function takes two arguments: the values of the plot’s points on the x-axis and the values of those points on the y-axis, in that order:</p>&#13;
<p class="programs">&gt; <span class="codestrong1">plot(xs,ys)</span></p>&#13;
<p class="indent">This function should generate the plot shown in <a href="app01.xhtml#app01fig04">Figure A-4</a> in the bottom-left window of RStudio.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_211"/><a id="app01fig04"/><img alt="Image" src="../images/afig04.jpg"/></div>&#13;
<p class="figcap"><em>Figure A-4: A simple plot created with R’s <span class="codeitalic">plot()</span> function</em></p>&#13;
<p class="indent">This plot shows the relationship between our <span class="literal">xs</span> values and their corresponding <span class="literal">ys</span> values. If we return to the function, we can give this plot a title using the optional <span class="literal">main</span> argument. We can also change the x- and y-axis labels with the <span class="literal">xlab</span> and <span class="literal">ylab</span> arguments, like this:</p>&#13;
<p class="programs">plot(xs,ys,<br/>&#13;
     main="example plot",<br/>&#13;
     xlab="x values",<br/>&#13;
     ylab="y values"<br/>&#13;
     )</p>&#13;
<p class="indent">The new labels should show up as they appear in <a href="app01.xhtml#app01fig05">Figure A-5</a>.</p>&#13;
<div class="image"><a id="app01fig05"/><img alt="Image" src="../images/afig05.jpg"/></div>&#13;
<p class="figcap"><em>Figure A-5: Changing the plot title and labels with the <span class="codeitalic">plot()</span> function</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_212"/>We can also change the plot’s type using the <span class="literal">type</span> argument. The first kind of plot we generated is called a <em>point plot</em>, but if we wanted to make a line plot, which draws a line through each value, we could set <span class="literal">type=”l”</span>:</p>&#13;
<p class="programs">plot(xs,ys,<br/>&#13;
     type="l",<br/>&#13;
     main="example plot",<br/>&#13;
     xlab="x values",<br/>&#13;
     ylab="y values"<br/>&#13;
     )</p>&#13;
<p class="indent">It would then look like <a href="app01.xhtml#app01fig06">Figure A-6</a>.</p>&#13;
<div class="image"><a id="app01fig06"/><img alt="Image" src="../images/afig06.jpg"/></div>&#13;
<p class="figcap"><em>Figure A-6: A line plot generated with R’s <span class="codeitalic">plot()</span> function</em></p>&#13;
<p class="indent">Or we can do both! An R function called <span class="literal">lines()</span> can add lines to an existing plot. It takes most of the same arguments as <span class="literal">plot()</span>:</p>&#13;
<p class="programs">plot(xs,ys,<br/>&#13;
     main="example plot",<br/>&#13;
     xlab="x values",<br/>&#13;
     ylab="y values"<br/>&#13;
     )<br/>&#13;
lines(xs,ys)</p>&#13;
<p class="indent"><a href="app01.xhtml#app01fig07">Figure A-7</a> shows the plot this function would generate.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_213"/><a id="app01fig07"/><img alt="Image" src="../images/afig07.jpg"/></div>&#13;
<p class="figcap"><em>Figure A-7: Adding lines to an existing plot with R’s <span class="codeitalic">lines()</span> function</em></p>&#13;
<p class="indent">There are many more amazing ways to use R’s basic plots, and you can consult <span class="literal">?plot</span> for more information on them. However, if you want to create truly beautiful plots in R, you should research the <span class="literal">ggplot2</span> library (<em><a href="https://ggplot2.tidyverse.org/">https://ggplot2.tidyverse.org/</a></em>).</p>&#13;
<h3 class="h3" id="app01lev1sec8"><strong>Exercise: Simulating a Stock Price</strong></h3>&#13;
<p class="noindent">Now let’s put everything we’ve learned together to create a simulated stock ticker! People often model stock prices using the cumulative sum of normally distributed random values. To start, we’ll simulate stock movement for a period of time by generating a sequence of values from 1 to 20, incrementing by 1 each time using the <span class="literal">seq()</span> function. We’ll call the vector representing the period of time <span class="literal">t.vals</span>.</p>&#13;
<p class="programs"> t.vals &lt;- seq(1,20,by=1)</p>&#13;
<p class="indent">Now <span class="literal">t.vals</span> is a vector containing the sequence of numbers from 1 to 20 incremented by 1. Next, we’ll create some simulated prices by taking the cumulative sum of a normally distributed value for each time in your <span class="literal">t.vals</span>. To do this we’ll use <span class="literal">rnorm()</span> to sample the number of values equal to the length of <span class="literal">t.vals</span>. Then we’ll use <span class="literal">cumsum()</span> to calculate the cumulative sum of this vector of values. This will represent the idea of a price moving up or down based on random motion; less extreme movements are more common than more extreme ones.</p>&#13;
<p class="programs"> price.vals &lt;- cumsum(rnorm(length(t.vals),mean=5,sd=10))</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_214"/>Finally, we can plot all these values to see how they look! We’ll use both the <span class="literal">plot()</span> and <span class="literal">lines()</span> functions, and label the axes according to what they represent.</p>&#13;
<p class="programs">plot(t.vals,price.vals,<br/>&#13;
     main="Simulated stock ticker",<br/>&#13;
     xlab="time",<br/>&#13;
     ylab="price")<br/>&#13;
lines(t.vals,price.vals)</p>&#13;
<p class="indent">The <span class="literal">plot()</span> and <span class="literal">lines()</span> functions should generate the plot shown in <a href="app01.xhtml#app01fig08">Figure A-8</a>.</p>&#13;
<div class="image"><a id="app01fig08"/><img alt="Image" src="../images/afig08.jpg"/></div>&#13;
<p class="figcap"><em>Figure A-8: The plot generated for our simulated stock ticker</em></p>&#13;
<h3 class="h3" id="app01lev1sec9"><strong>Summary</strong></h3>&#13;
<p class="noindent">This appendix should cover enough R to give you a grasp of the examples in this book. I recommend following along with the book’s chapters, then playing around by modifying the code examples to learn more. R also has some great online documentation if you want to take your experimentation further.</p>&#13;
</body></html>