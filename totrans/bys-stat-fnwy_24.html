<html><head></head><body>
<h2 class="h2" id="app01"><span epub:type="pagebreak" id="page_195"/><strong><span class="big">A</span><br/>A QUICK INTRODUCTION TO R</strong></h2>&#13;
<div class="image1"><img alt="Image" src="../images/common.jpg"/></div>&#13;
<p class="noindent">In this book, we use the R programming language to do some tricky mathematical work for us. R is a programming language that specializes in statistics and data science. If you don’t have experience with R, or with programming in general, don’t worry—this appendix will get you started.</p>&#13;
<h3 class="h3" id="app01lev1sec1"><span epub:type="pagebreak" id="page_196"/><strong>R and RStudio</strong></h3>&#13;
<p class="noindent">To run the code examples in this book, you’ll need to have R installed on your computer. To install R, visit <em><a href="https://cran.rstudio.com/">https://cran.rstudio.com/</a></em> and follow the installation steps for the operating system you’re using.</p>&#13;
<p class="indent">Once you’ve installed R, you should also install <em>RStudio</em>, an integrated development environment (IDE) that makes it extremely easy to run R projects. Download and install RStudio from <em><a href="http://www.rstudio.com/products/rstudio/download/">www.rstudio.com/products/rstudio/download/</a></em>.</p>&#13;
<p class="indent">When you open RStudio, you should be greeted with several panels (<a href="app01.xhtml#app01fig01">Figure A-1</a>).</p>&#13;
<div class="image"><a id="app01fig01"/><img alt="Image" src="../images/afig01.jpg"/></div>&#13;
<p class="figcap"><em>Figure A-1: Viewing the console in RStudio</em></p>&#13;
<p class="indent">The most important panel is the big one in the middle, called the <em>console</em>. In the console, you can enter any of the code examples from the book and run them simply by pressing <small>ENTER</small>. The console runs all the code you enter immediately, which makes it hard to keep track of the code you’ve written so far.</p>&#13;
<p class="indent">To write programs that you can save and come back to, you can place your code in an <em>R script</em>, which is a text file that you can load into the console later. R is an extremely interactive programming language, so rather than thinking of the console as a place you can test out code, think of R scripts as a way to quickly load tools you can use in the console.</p>&#13;
<h3 class="h3" id="app01lev1sec2"><span epub:type="pagebreak" id="page_197"/><strong>Creating an R Script</strong></h3>&#13;
<p class="noindent">To create an R script, go to <strong>File<span class="ent">▸</span>New File<span class="ent">▸</span>R Script</strong> in RStudio. This should create a new blank panel in the top left (<a href="app01.xhtml#app01fig02">Figure A-2</a>).</p>&#13;
<div class="image"><a id="app01fig02"/><img alt="Image" src="../images/afig02.jpg"/></div>&#13;
<p class="figcap"><em>Figure A-2: Creating an R script</em></p>&#13;
<p class="indent">In this panel, you can enter code and save it as a file. To run the code, simply click the <strong>Source</strong> button at the top right of the panel, or run individual lines by clicking the <strong>Run</strong> button. The Source button will automatically load your file into the console as though you had typed it there yourself.</p>&#13;
<h3 class="h3" id="app01lev1sec3"><strong>Basic Concepts in R</strong></h3>&#13;
<p class="noindent">We’ll be using R as an advanced calculator in this book, which means you’ll only need to understand a few basics to work through the problems and extend the examples in the book on your own.</p>&#13;
<h4 class="h4" id="app01lev2sec1"><strong><em>Data Types</em></strong></h4>&#13;
<p class="noindent">All programming languages have different types of data, which you can use for different purposes and manipulate in different ways. R has a rich variety of types and data structures, but we’ll only be using a very small number of them in this book.</p>&#13;
<h5 class="h5" id="app01lev3sec1"><span epub:type="pagebreak" id="page_198"/><strong>Doubles</strong></h5>&#13;
<p class="noindent">The numbers we use in R will all be of the type <em>double</em> (short for “double-precision floating-point,” which is the most common way to represent decimal numbers on a computer). The double is the default type for representing decimal numbers. Unless otherwise specified, all numbers you enter into the console are of the double type.</p>&#13;
<p class="indent">We can manipulate numbers in the double type using standard mathematical operations. For example, we can add two numbers with the <code>+</code> operator. Try this out in the console:</p>&#13;
<pre>&gt; <span class="codestrong1">5 + 2</span><br/>&#13;
[1] 7</pre>&#13;
<p class="indent">We can also divide any numbers that give us decimal results using the <code>/</code> operator:</p>&#13;
<pre>&gt; <span class="codestrong1">5/2</span><br/>&#13;
[1] 2.5</pre>&#13;
<p class="indent">We can multiply values with the <code>*</code> operator like so:</p>&#13;
<pre>&gt; <span class="codestrong1">5 * 2</span><br/>&#13;
[1] 10</pre>&#13;
<p class="noindent">and take the exponential of a value using the <code>^</code> operator. For example, 5<sup>2</sup> is:</p>&#13;
<pre>&gt; <span class="codestrong1">5^2</span><br/>&#13;
[1] 25</pre>&#13;
<p class="indent">We can also add <code>-</code> in front of a number to make it negative:</p>&#13;
<pre>&gt; <span class="codestrong1">5 - -2</span><br/>&#13;
[1] 7</pre>&#13;
<p class="indent">And we can also use scientific notation with <code>e+</code>. So 5 × 10<sup>2</sup> is just:</p>&#13;
<pre>&gt; <span class="codestrong1">5e+2</span><br/>&#13;
[1] 500</pre>&#13;
<p class="indent">If we use <code>e-</code> we get the same result as 5 × 10<sup>–2</sup>:</p>&#13;
<pre>&gt; <span class="codestrong1">5e-2</span><br/>&#13;
[1] 0.05</pre>&#13;
<p class="indent">This is useful to know because sometimes R will return the result in scientific notation if it is too large to easily fit on the screen, like so:</p>&#13;
<pre>&gt; <span class="codestrong1">5*10^20</span><br/>&#13;
[1] 5e+20</pre>&#13;
<h5 class="h5" id="app01lev3sec2"><span epub:type="pagebreak" id="page_199"/><strong>Strings</strong></h5>&#13;
<p class="noindent">Another important type in R is the <em>string</em>, which is just a group of characters used to represent text. In R, we surround a string with quotation marks, like this:</p>&#13;
<pre>&gt; <span class="codestrong1">"hello"</span><br/>&#13;
[1] "hello"</pre>&#13;
<p class="indent">Note that if you put a number inside a string, you can’t use that number in regular numeric operations because strings and numbers are different types. For example:</p>&#13;
<pre>&gt; <span class="codestrong1">"2" + 2</span><br/>&#13;
Error in "2" + 2 : non-numeric argument to binary operator</pre>&#13;
<p class="indent">We won’t be making much use of strings in this book. We’ll primarily use them to pass arguments to functions and to give labels to plots. But it’s important to remember them if you’re using text.</p>&#13;
<h5 class="h5" id="app01lev3sec3"><strong>Logicals</strong></h5>&#13;
<p class="noindent"><em>Logical</em> or <em>binary</em> types are true or false values represented by the codes <code>TRUE</code> and <code>FALSE</code>. Note that <code>TRUE</code> and <code>FALSE</code> aren’t strings—they’re not surrounded by quotes, and they’re written in all uppercase. (R also allows you to simply use <code>T</code> or <code>F</code> instead of writing out the full words.)</p>&#13;
<p class="indent">We can combine logical types with the symbols <code>&amp;</code> (“and”) and <code>|</code> (“or”) to perform basic logical operations. For example, if we wanted to know whether it’s possible for something to be both true <em>and</em> false at the same time, we might enter:</p>&#13;
<pre>&gt; <span class="codestrong1">TRUE &amp; FALSE</span></pre>&#13;
<p class="indent">R would return:</p>&#13;
<pre>[1] FALSE</pre>&#13;
<p class="noindent">telling us that a value can’t be both true and false.</p>&#13;
<p class="indent">But what about true <em>or</em> false?</p>&#13;
<pre>&gt; <span class="codestrong1">TRUE | FALSE</span><br/>&#13;
[1] TRUE</pre>&#13;
<p class="indent">Like strings, in this book logical values will primarily be used to provide arguments to functions we’ll be using, or as the results of comparing two different values.</p>&#13;
<h4 class="h4" id="app01lev2sec2"><span epub:type="pagebreak" id="page_200"/><strong><em>Missing Values</em></strong></h4>&#13;
<p class="noindent">In practical statistics and data science, data is often missing some values. For example, say you have temperature data for the morning and afternoon of every day for a month, but something malfunctioned one day and you’re missing a morning temperature. Because missing values are so common, R has a special way of representing them: using the value <code>NA</code>. It’s important to have a way to handle missing values because they can mean very different things in different contexts. For example, when you’re measuring rainfall a missing value might mean there was no rain in the gauge, or it might mean that there was plenty of rain but temperatures were freezing that night, cracking the gauge and causing all the water to leak out. In the first case, we might consider missing values to mean 0, but in the latter case it’s not clear what the value should be. Keeping missing values separate from other values forces us to consider these differences.</p>&#13;
<p class="indent">To prompt us to make sense of what our missing values are whenever we try to use one, R will output <code>NA</code> for any operation using a missing value:</p>&#13;
<pre>&gt; <span class="codestrong1">NA + 2</span><br/>&#13;
[1] NA</pre>&#13;
<p class="indent">As we’ll see in a bit, various functions in R can handle missing values in different ways, but you shouldn’t have to worry about missing values for the R you’ll use in this book.</p>&#13;
<h4 class="h4" id="app01lev2sec3"><strong><em>Vectors</em></strong></h4>&#13;
<p class="noindent">Nearly every programming language contains certain features that make it unique and especially suited to solving problems in its domain. R’s special feature is that it is a <em>vector language</em>. A vector is a list of values, and everything R does is an operation on a vector. We use the code <code>c(...)</code> to define vectors (but even if we put in just a single value, R does this for us!).</p>&#13;
<p class="indent">To understand how vectors work, let’s consider an example. Enter the next example in a script, rather than the console. We first create a new vector by assigning the variable <code>x</code> to the vector <code>c(1,2,3)</code> using the assignment operator <code>&lt;-</code> like so:</p>&#13;
<pre>x &lt;- c(1,2,3)</pre>&#13;
<p class="indent">Now that we have a vector, we can use it in our calculations. When we perform a simple operation, like adding <code>3</code> to <code>x</code>, when we enter this in the console, we get a rather unexpected result (especially if you’re used to another programming language):</p>&#13;
<pre>&gt; <span class="codestrong1">x + 3</span><br/>&#13;
[1] 4 5 6</pre>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_201"/>The result of <code>x + 3</code> tells us what happens if we add <code>3</code> to each value in our <code>x</code> vector. (In many other programming languages, we’d need to use a <code>for</code> loop or some other iterator to perform this operation.)</p>&#13;
<p class="indent">We can also add vectors to each other. Here, we’ll create a new vector containing three elements, each with a value of <code>2</code>. We’ll name this vector <code>y</code>, then add <code>y</code> to <code>x</code>:</p>&#13;
<pre>&gt; <span class="codestrong1">y &lt;- c(2,2,2)</span><br/>&#13;
&gt; <span class="codestrong1">x + y</span><br/>&#13;
[1] 3 4 5</pre>&#13;
<p class="indent">As you can see, this operation added each element in <code>x</code> to its corresponding element in <code>y</code>.</p>&#13;
<p class="indent">What if we multiply our two vectors?</p>&#13;
<pre>&gt; <span class="codestrong1">x * y</span><br/>&#13;
[1] 2 4 6</pre>&#13;
<p class="indent">Each value in <code>x</code> was multiplied by its corresponding value in <code>y</code>. If the lists weren’t the same size, or a multiple of the same size, then we’d get an error. If a vector is a multiple of the same size, R will just repeatedly apply the smaller vector to the larger one. However, we won’t be making use of this feature in this book.</p>&#13;
<p class="indent">We can quite easily combine vectors in R by defining another vector based on the existing ones. Here, we’ll create the vector <code>z</code> by combining <code>x</code> and <code>y</code>:</p>&#13;
<pre>&gt; <span class="codestrong1">z &lt;- c(x,y)</span><br/>&#13;
&gt; <span class="codestrong1">z</span><br/>&#13;
[1] 1 2 3 2 2 2</pre>&#13;
<p class="indent">Notice that this operation didn’t give us a vector of vectors; instead, we got a single vector that contains the values from both, in the order you set <code>x</code> and <code>y</code> when you defined <code>z</code>.</p>&#13;
<p class="indent">Learning to use vectors efficiently in R can be a bit tricky for beginners. Ironically, programmers who are experienced in a non-vector-based language often have the most difficulty. Don’t worry, though: in this book, we’ll use vectors to make reading code easier.</p>&#13;
<h3 class="h3" id="app01lev1sec4"><strong>Functions</strong></h3>&#13;
<p class="noindent"><em>Functions</em> are blocks of code that perform a particular operation on a value, and we’ll use them in R to solve problems.</p>&#13;
<p class="indent">In R and RStudio, all functions come equipped with documentation. If you enter <code>?</code> followed by a function name into the R console, you’ll get the full documentation for that function. For example, if you enter <code>?sum</code> into the RStudio console, you should see the documentation shown in <a href="app01.xhtml#app01fig03">Figure A-3</a> in the bottom-right screen.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_202"/><a id="app01fig03"/><img alt="Image" src="../images/afig03.jpg"/></div>&#13;
<p class="figcap"><em>Figure A-3: Viewing the documentation for the <span class="codeitalic">sum()</span> function</em></p>&#13;
<p class="indent">This documentation gives us the definition of the <code>sum()</code> function and some of its uses. The <code>sum()</code> function takes a vector’s values and adds them all together. The documentation says it takes <code>...</code> as an argument, which means it can accept any number of values. Usually these values will be a vector of numbers, but they can consist of multiple vectors, too.</p>&#13;
<p class="indent">The documentation also lists an <em>optional argument</em>: <code>na.rm = FALSE</code>. Optional arguments are arguments that you don’t have to pass in to the function for it to work; if you don’t pass an optional argument in, R will use the argument’s default value. In the case of <code>na.rm</code>, which automatically removes any missing values, the default value, after the equal sign, is <code>FALSE</code>. That means that, by default, <code>sum()</code> won’t remove missing values.</p>&#13;
<h4 class="h4" id="app01lev2sec4"><strong><em>Basic Functions</em></strong></h4>&#13;
<p class="noindent">Here are some of R’s most important functions.</p>&#13;
<h5 class="h5" id="app01lev3sec4"><strong>The length() and nchar() Functions</strong></h5>&#13;
<p class="noindent">The <code>length()</code> function will return the length of a vector:</p>&#13;
<pre>&gt; <span class="codestrong1">length(c(1,2,3))</span><br/>&#13;
[1] 3</pre>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_203"/>Since there are three elements in this vector, the <code>length()</code> function returns <code>3</code>.</p>&#13;
<p class="indent">Because everything in R is a vector, you can use the <code>length()</code> function to find the length of anything—even a string, like <code>“doggies”</code>:</p>&#13;
<pre>&gt; <span class="codestrong1">length("doggies")</span><br/>&#13;
[1] 1</pre>&#13;
<p class="indent">R tells us that <code>“doggies”</code> is a vector containing one string.</p>&#13;
<p class="indent">Now, if we had two strings, <code>“doggies”</code> and <code>“cats”</code>, we’d get:</p>&#13;
<pre>&gt; <span class="codestrong1">length(c("doggies","cats"))</span><br/>&#13;
[1] 2</pre>&#13;
<p class="indent">To find the number of characters in a string, we use the <code>nchar()</code> function:</p>&#13;
<pre>&gt; <span class="codestrong1">nchar("doggies")</span><br/>&#13;
[1] 7</pre>&#13;
<p class="indent">Note that if we use <code>nchar()</code> on the <code>c(“doggies”,”cats”)</code> vector, R returns a new vector containing the number of characters in each string:</p>&#13;
<pre>&gt; <span class="codestrong1">nchar(c("doggies","cats"))</span><br/>&#13;
[1] 7 4</pre>&#13;
<h5 class="h5" id="app01lev3sec5"><strong>The sum(), cumsum(), and diff() Functions</strong></h5>&#13;
<p class="noindent">The <code>sum()</code> function takes a vector of numbers and adds all those numbers together:</p>&#13;
<pre>&gt; <span class="codestrong1">sum(c(1,1,1,1,1))</span><br/>&#13;
[1] 5</pre>&#13;
<p class="indent">As we saw in the documentation in the previous section, <code>sum()</code> takes <code>...</code> as its argument, which means it can accept any number of values:</p>&#13;
<pre>&gt; <span class="codestrong1">sum(2,3,1)</span><br/>&#13;
[1] 6<br/>&#13;
&gt; <span class="codestrong1">sum(c(2,3),1)</span><br/>&#13;
[1] 6<br/>&#13;
&gt; <span class="codestrong1">sum(c(2,3,1))</span><br/>&#13;
[1] 6</pre>&#13;
<p class="indent">As you can see, no matter how many vectors we provide, <code>sum()</code> adds them up as though they were a single vector of integers. If you wanted to sum up multiple vectors, you’d call <code>sum()</code> on them each separately.</p>&#13;
<p class="indent">Remember, also, that the <code>sum()</code> function takes the optional argument <code>na.rm</code>, which by default is set to <code>FALSE</code>. The <code>na.rm</code> argument determines if <code>sum()</code> removes <code>NA</code> values or not.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_204"/>If we leave <code>na.rm</code> set to <code>FALSE</code>, here’s what happens if we try to use <code>sum()</code> on a vector with a missing value:</p>&#13;
<pre>&gt; <span class="codestrong1">sum(c(1,NA,3))</span><br/>&#13;
[1] NA</pre>&#13;
<p class="indent">As we saw when <code>NA</code> was introduced, adding a value to an <code>NA</code> value results in <code>NA</code>. If we’d like R to give us a number as an answer instead, we can tell <code>sum()</code> to remove <code>NA</code> values by setting <code>na.rm = TRUE</code>:</p>&#13;
<pre>&gt; <span class="codestrong1">sum(c(1,NA,3),na.rm = TRUE)</span><br/>&#13;
[1] 4</pre>&#13;
<p class="indent">The <code>cumsum()</code> function takes a vector and calculates its <em>cumulative sum</em>—a vector of the same length as the input that replaces each number with the sum of the numbers that come before it (including that number). Here’s an example in code to make this clearer:</p>&#13;
<pre>&gt; <span class="codestrong1">cumsum(c(1,1,1,1,1))</span><br/>&#13;
[1] 1 2 3 4 5<br/>&#13;
&gt; <span class="codestrong1">cumsum(c(2,10,20))</span><br/>&#13;
[1] 2 12 32</pre>&#13;
<p class="indent">The <code>diff()</code> function takes a vector and subtracts each number from the number that precedes it in the vector:</p>&#13;
<pre>&gt; <span class="codestrong1">diff(c(1,2,3,4,5))</span><br/>&#13;
[1] 1 1 1 1<br/>&#13;
&gt; <span class="codestrong1">diff(c(2,10,3))</span><br/>&#13;
[1]  8 -7</pre>&#13;
<p class="indent">Notice that the result of the <code>diff()</code> function contains one fewer element than the original vector did. That’s because nothing gets subtracted from the first value in the vector.</p>&#13;
<h5 class="h5" id="app01lev3sec6"><strong>The : operator and the seq() Function</strong></h5>&#13;
<p class="noindent">Often, rather than manually listing each element of a vector, we’d prefer to generate vectors automatically. To automatically create a vector of whole numbers in a certain range, we can use the <code>:</code> operator to separate the start and end of the range. R can even figure out if you want to count up or down (the <code>c()</code> wrapping this operator is not strictly necessary):</p>&#13;
<pre>&gt; <span class="codestrong1">c(1:5)</span><br/>&#13;
[1] 1 2 3 4 5<br/>&#13;
<br/>&#13;
&gt; <span class="codestrong1">c(5:1)</span><br/>&#13;
[1] 5 4 3 2 1</pre>&#13;
<p class="indent">When you use <code>:</code>, R will count from the first value to the last.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_205"/>Sometimes we’ll want to count by something other than increments of one. The <code>seq()</code> function allows us to create vectors of a sequence of values that increment by a specified amount. The arguments to <code>seq()</code> are, in order:</p>&#13;
<ol>&#13;
<li class="noindent">The start of the sequence</li>&#13;
<li class="noindent">The end of the sequence</li>&#13;
<li class="noindent">The amount to increment the sequence by</li>&#13;
</ol>&#13;
<p class="indent">Here are some examples of using <code>seq()</code>:</p>&#13;
<pre>&gt; <span class="codestrong1">seq(1,1.1,0.05)</span><br/>&#13;
[1] 1.00 1.05 1.10<br/>&#13;
<br/>&#13;
&gt; <span class="codestrong1">seq(0,15,5)</span><br/>&#13;
[1]  0  5 10 15<br/>&#13;
<br/>&#13;
&gt; <span class="codestrong1">seq(1,2,0.3)</span><br/>&#13;
[1] 1.0 1.3 1.6 1.9</pre>&#13;
<p class="indent">If we want to count down to a certain value using the <code>seq()</code> function, we use a minus value as our increment, like this:</p>&#13;
<pre>&gt; <span class="codestrong1">seq(10,5,-1)</span><br/>&#13;
[1] 10  9  8  7  6  5</pre>&#13;
<h5 class="h5" id="app01lev3sec7"><strong>The ifelse() Function</strong></h5>&#13;
<p class="noindent">The <code>ifelse()</code> function tells R to take one of two actions based on some condition. This function can be a bit confusing if you’re used to the normal <code>if ... else</code> control structure in other languages. In R, it takes the following three arguments (in order):</p>&#13;
<ol>&#13;
<li class="noindent">A statement about a vector that may be either true or false of its values</li>&#13;
<li class="noindent">What happens in the case that the statement is true</li>&#13;
<li class="noindent">What happens in the case that the statement is false</li>&#13;
</ol>&#13;
<p class="indent">The <code>ifelse()</code> function operates on entire vectors at once. When it comes to vectors containing a single value, its use is pretty intuitive:</p>&#13;
<pre>&gt; <span class="codestrong1">ifelse(2 &lt; 3,"small","too big")</span><br/>&#13;
[1] "small"</pre>&#13;
<p class="indent">Here the statement is that 2 is smaller than 3, and we ask R to output <code>“small”</code> if it is, and <code>“too big”</code> if it isn’t.</p>&#13;
<p class="indent">Suppose we have a vector <code>x</code> that contains multiple values:</p>&#13;
<pre><span class="codestrong1">&gt; x &lt;- c(1,2,3)</span></pre>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_206"/>The <code>ifelse()</code> function will return a value for each element in the vector:</p>&#13;
<pre>&gt; <span class="codestrong1">ifelse(x &lt; 3,"small","too big")</span><br/>&#13;
[1] "small"   "small"   "too big"</pre>&#13;
<p class="indent">We can also use vectors in the results arguments for the <code>ifelse()</code>. Suppose that, in addition to our <code>x</code> vector, we had another vector, <code>y</code>:</p>&#13;
<pre><span class="codestrong1">y &lt;- c(2,1,6)</span></pre>&#13;
<p class="indent">We want to generate a new list that contains the greatest value from <code>x</code> and <code>y</code> for each element in the vector. We could use <code>ifelse()</code> to solve this very simply:</p>&#13;
<pre>&gt; <span class="codestrong1">ifelse(x &gt; y,x,y)</span><br/>&#13;
[1] 2 2 6</pre>&#13;
<p class="indent">You can see R has compared the values in <code>x</code> to the respective value in <code>y</code> and outputs the largest of the two for each element.</p>&#13;
<h3 class="h3" id="app01lev1sec5"><strong>Random Sampling</strong></h3>&#13;
<p class="noindent">We’ll often use R to randomly sample values. This allows us to have the computer pick a random number or value for us. We use this sample to simulate activities like flipping a coin, playing “rock, paper, scissors,” or picking a number between 1 and 100.</p>&#13;
<h4 class="h4" id="app01lev2sec5"><strong><em>The runif() Function</em></strong></h4>&#13;
<p class="noindent">One way to randomly sample values is with the function <code>runif()</code>, short for “random uniform,” which takes a required argument <code>n</code> and gives that many samples in the range 0 to 1:</p>&#13;
<pre>&gt; <span class="codestrong1">runif(5)</span><br/>&#13;
[1] 0.8688236 0.1078877 0.6814762 0.9152730 0.8702736</pre>&#13;
<p class="indent">We can use this function with <code>ifelse()</code> to generate a value <code>A</code> 20 percent of the time. In this case we’ll use <code>runif(5)</code> to create five random values between 0 and 1. Then if the value is less than 0.2, we’ll return <code>“A”</code>; otherwise, we’ll return <code>“B”</code>:</p>&#13;
<pre>&gt; <span class="codestrong1">ifelse(runif(5) &lt; 0.2,"A","B")</span><br/>&#13;
[1] "B" "B" "B" "B" "A"</pre>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_207"/>Since the numbers we’re generating are random, we’ll get a different result each time we run the <code>ifelse()</code> function. Here are some possible outcomes:</p>&#13;
<pre>&gt; <span class="codestrong1">ifelse(runif(5) &lt; 0.2,"A","B")</span><br/>&#13;
[1] "B" "B" "B" "B" "B"<br/>&#13;
&gt; <span class="codestrong1">ifelse(runif(5) &lt; 0.2,"A","B")</span><br/>&#13;
 [1] "A" "A" "B" "B" "B"</pre>&#13;
<p class="indent">The <code>runif()</code> function can take optional second and third arguments, which are the minimum and maximum values of the range to be uniformly sampled from. By default, the function uses the range between 0 and 1 inclusive, but you can set the range to be whatever you’d like:</p>&#13;
<pre>&gt; <span class="codestrong1">runif(5,0,2)</span><br/>&#13;
[1] 1.4875132 0.9368703 0.4759267 1.8924910 1.6925406</pre>&#13;
<h4 class="h4" id="app01lev2sec6"><strong><em>The rnorm() Function</em></strong></h4>&#13;
<p class="noindent">We can also sample from a normal distribution using the <code>rnorm()</code> function, which we’ll discuss in more depth in the book (the normal distribution is covered in <a href="ch12.xhtml#ch12">Chapter 12</a>):</p>&#13;
<pre>&gt; <span class="codestrong1">rnorm(3)</span><br/>&#13;
[1]  0.28352476  0.03482336 -0.20195303</pre>&#13;
<p class="indent">By default, <code>rnorm()</code> samples from a normal distribution with a mean of 0 and standard deviation of 1, as is the case in this example. For readers unfamiliar with the normal distribution, this means that samples will have a “bell-shaped” distribution around 0, with most samples being close to 0 and very few being less than –3 or greater than 3.</p>&#13;
<p class="indent">The <code>rnorm()</code> function has two optional arguments, <code>mean</code> and <code>sd</code>, which allow you to set a different mean and standard deviation, respectively:</p>&#13;
<pre>&gt; <span class="codestrong1">rnorm(4,mean=2,sd=10)</span><br/>&#13;
[1] -12.801407  -9.648737   1.707625  -8.232063</pre>&#13;
<p class="indent">In statistics, sampling from a normal distribution is often more common than sampling from a uniform distribution, so <code>rnorm()</code> comes in quite handy.</p>&#13;
<h4 class="h4" id="app01lev2sec7"><strong><em>The sample() Function</em></strong></h4>&#13;
<p class="noindent">Sometimes, we want to sample from something other than just a well-studied distribution. Suppose you have a drawer containing socks of many colors:</p>&#13;
<pre><span class="codestrong1">socks &lt;- c("red","grey","white","red","black")</span></pre>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_208"/>If you wanted to simulate the act of randomly picking any two socks, you could use R’s <code>sample()</code> function, which takes as arguments a vector of values and the number of elements to sample:</p>&#13;
<pre>&gt; <span class="codestrong1">sample(socks,2)</span><br/>&#13;
[1] "grey" "red"</pre>&#13;
<p class="indent">The <code>sample()</code> function behaves as though we’ve picked two random socks out of the drawer—without putting any back. If we sample five socks, we’ll get all of the socks we originally had in the drawer:</p>&#13;
<pre>&gt; <span class="codestrong1">sample(socks,5)</span><br/>&#13;
[1] "grey"  "red"   "red"   "black" "white"</pre>&#13;
<p class="indent">That means that if we try to take six socks from the drawer where there are only five available socks, we’ll get an error:</p>&#13;
<pre>&gt; <span class="codestrong1">sample(socks,6)</span><br/>&#13;
Error in sample.int(length(x), size, replace, prob) :<br/>&#13;
  cannot take a sample larger than the population when 'replace = FALSE'</pre>&#13;
<p class="indent">If we want to both sample and “put the socks back,” we can set the optional argument <code>replace</code> to <code>TRUE</code>. Now, each time we sample a sock, we put it back in the drawer. This allows us to sample more socks than are in the drawer. It also means the distribution of socks in the drawer never changes.</p>&#13;
<pre>&gt; <span class="codestrong1">sample(socks,6,replace=TRUE)</span><br/>&#13;
[1] "black" "red"   "black" "red"   "black" "black"</pre>&#13;
<p class="indent">With these simple sampling tools, you can run surprisingly sophisticated simulations in R that save you from doing a lot of math.</p>&#13;
<h4 class="h4" id="app01lev2sec8"><strong><em>Using set.seed() for Predictable Random Results</em></strong></h4>&#13;
<p class="noindent">The “random numbers” generated by R aren’t truly random numbers. As in all programming languages, random numbers are generated by a <em>pseudorandom number generator</em>, which takes a <em>seed value</em> and uses that to create a sequence of numbers that are random enough for most purposes. The seed value sets the initial state of the random number generator and determines which numbers will come next in the sequence. In R, we can manually set this seed using the <code>set.seed()</code> function. Setting the seed is extremely useful for cases when we want to use the same random results again:</p>&#13;
<pre>&gt; <span class="codestrong1">set.seed(1337)</span><br/>&#13;
&gt; <span class="codestrong1">ifelse(runif(5) &lt; 0.2,"A","B")</span><br/>&#13;
[1] "B" "B" "A" "B" "B"<br/>&#13;
<br/>&#13;
<span epub:type="pagebreak" id="page_209"/>&gt; <span class="codestrong1">set.seed(1337)</span><br/>&#13;
&gt; <span class="codestrong1">ifelse(runif(5) &lt; 0.2,"A","B")</span><br/>&#13;
[1] "B" "B" "A" "B" "B"</pre>&#13;
<p class="indent">As you can see, when we used the same seed twice with the <code>runif()</code> function, it generated the same set of supposedly random values. The main benefit of using <code>set.seed()</code> is making the results reproducible. This can make tracking down bugs in programs that involve sampling much easier, since the results don’t change each time the program is run.</p>&#13;
<h3 class="h3" id="app01lev1sec6"><strong>Defining Your Own Functions</strong></h3>&#13;
<p class="noindent">Sometimes it’s helpful to write our own functions for specific operations we’ll have to perform repeatedly. In R, we can define functions using the keyword <code>function</code> (a <em>keyword</em> in a programming language is simply a special word reserved by the programming language for a specific use).</p>&#13;
<p class="indent">Here’s the definition of a function that takes a single argument, <code>val</code>—which here stands for the value the user will input to the function—and then doubles <code>val</code> and cubes it.</p>&#13;
<pre>double_then_cube &lt;- function(val){<br/>&#13;
  (val*2)^3<br/>&#13;
}</pre>&#13;
<p class="indent">Once we’ve defined our function, we can use it, just like R’s built-in functions. Here’s our <code>double_then_cube()</code> function applied to the number 8:</p>&#13;
<pre>&gt; <span class="codestrong1">double_then_cube(8)</span><br/>&#13;
[1] 4096</pre>&#13;
<p class="indent">Also, because everything we did to define our function is <em>vectorized</em> (that is, all values work on vectors of values), our function will work on vectors as well as single values:</p>&#13;
<pre>&gt; <span class="codestrong1">double_then_cube(c(1,2,3))</span><br/>&#13;
[1] 8 64 216</pre>&#13;
<p class="indent">We can define functions that take more than one argument as well. The <code>sum_then_square()</code> function, defined here, adds two arguments together, then squares the result:</p>&#13;
<pre>sum_then_square &lt;- function(x,y){<br/>&#13;
  (x+y)^2<br/>&#13;
}</pre>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_210"/>By including the two arguments <code>(x,y)</code> in the function definition, we’re telling R the <code>sum_then_square()</code> function expects two arguments. Now we can use our new function, like this:</p>&#13;
<pre>&gt; <span class="codestrong1">sum_then_square(2,3)</span><br/>&#13;
[1] 25<br/>&#13;
&gt; <span class="codestrong1">sum_then_square(c(1,2),c(5,3))</span><br/>&#13;
[1] 36 25</pre>&#13;
<p class="indent">We can also define functions that require multiple lines. In R, when a function is called it will always return the result of the calculation on the final line of the function definition. That means we could have rewritten <code>sum_then_square()</code> like this:</p>&#13;
<pre>sum_then_square &lt;- function(x,y){<br/>&#13;
  sum_of_args &lt;- x+y<br/>&#13;
  square_of_result &lt;- sum_of_args^2<br/>&#13;
  square_of_result<br/>&#13;
}</pre>&#13;
<p class="indent">Typically, when you write functions, you’ll want to write them in an R script file so you can save them and reuse them later.</p>&#13;
<h3 class="h3" id="app01lev1sec7"><strong>Creating Basic Plots</strong></h3>&#13;
<p class="noindent">In R, we can quickly generate plots of data very easily. Though R has an extraordinary plotting library called <code>ggplot2</code>, which contains many useful functions for generating beautiful plots, we’ll restrict ourselves to R’s base plotting functions for now, which are plenty useful on their own.</p>&#13;
<p class="indent">To show how plotting works, we’ll create two vectors of values, our <code>xs</code> and our <code>ys</code>:</p>&#13;
<pre>&gt; <span class="codestrong1">xs &lt;- c(1,2,3,4,5)</span><br/>&#13;
&gt; <span class="codestrong1">ys &lt;- c(2,3,2,4,6)</span></pre>&#13;
<p class="indent">Next, we can use these vectors as arguments to the <code>plot()</code> function, which will plot our data for us. The <code>plot()</code> function takes two arguments: the values of the plot’s points on the x-axis and the values of those points on the y-axis, in that order:</p>&#13;
<pre>&gt; <span class="codestrong1">plot(xs,ys)</span></pre>&#13;
<p class="indent">This function should generate the plot shown in <a href="app01.xhtml#app01fig04">Figure A-4</a> in the bottom-left window of RStudio.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_211"/><a id="app01fig04"/><img alt="Image" src="../images/afig04.jpg"/></div>&#13;
<p class="figcap"><em>Figure A-4: A simple plot created with R’s <span class="codeitalic">plot()</span> function</em></p>&#13;
<p class="indent">This plot shows the relationship between our <code>xs</code> values and their corresponding <code>ys</code> values. If we return to the function, we can give this plot a title using the optional <code>main</code> argument. We can also change the x- and y-axis labels with the <code>xlab</code> and <code>ylab</code> arguments, like this:</p>&#13;
<pre>plot(xs,ys,<br/>&#13;
     main="example plot",<br/>&#13;
     xlab="x values",<br/>&#13;
     ylab="y values"<br/>&#13;
     )</pre>&#13;
<p class="indent">The new labels should show up as they appear in <a href="app01.xhtml#app01fig05">Figure A-5</a>.</p>&#13;
<div class="image"><a id="app01fig05"/><img alt="Image" src="../images/afig05.jpg"/></div>&#13;
<p class="figcap"><em>Figure A-5: Changing the plot title and labels with the <span class="codeitalic">plot()</span> function</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_212"/>We can also change the plot’s type using the <code>type</code> argument. The first kind of plot we generated is called a <em>point plot</em>, but if we wanted to make a line plot, which draws a line through each value, we could set <code>type=”l”</code>:</p>&#13;
<pre>plot(xs,ys,<br/>&#13;
     type="l",<br/>&#13;
     main="example plot",<br/>&#13;
     xlab="x values",<br/>&#13;
     ylab="y values"<br/>&#13;
     )</pre>&#13;
<p class="indent">It would then look like <a href="app01.xhtml#app01fig06">Figure A-6</a>.</p>&#13;
<div class="image"><a id="app01fig06"/><img alt="Image" src="../images/afig06.jpg"/></div>&#13;
<p class="figcap"><em>Figure A-6: A line plot generated with R’s <span class="codeitalic">plot()</span> function</em></p>&#13;
<p class="indent">Or we can do both! An R function called <code>lines()</code> can add lines to an existing plot. It takes most of the same arguments as <code>plot()</code>:</p>&#13;
<pre>plot(xs,ys,<br/>&#13;
     main="example plot",<br/>&#13;
     xlab="x values",<br/>&#13;
     ylab="y values"<br/>&#13;
     )<br/>&#13;
lines(xs,ys)</pre>&#13;
<p class="indent"><a href="app01.xhtml#app01fig07">Figure A-7</a> shows the plot this function would generate.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_213"/><a id="app01fig07"/><img alt="Image" src="../images/afig07.jpg"/></div>&#13;
<p class="figcap"><em>Figure A-7: Adding lines to an existing plot with R’s <span class="codeitalic">lines()</span> function</em></p>&#13;
<p class="indent">There are many more amazing ways to use R’s basic plots, and you can consult <code>?plot</code> for more information on them. However, if you want to create truly beautiful plots in R, you should research the <code>ggplot2</code> library (<em><a href="https://ggplot2.tidyverse.org/">https://ggplot2.tidyverse.org/</a></em>).</p>&#13;
<h3 class="h3" id="app01lev1sec8"><strong>Exercise: Simulating a Stock Price</strong></h3>&#13;
<p class="noindent">Now let’s put everything we’ve learned together to create a simulated stock ticker! People often model stock prices using the cumulative sum of normally distributed random values. To start, we’ll simulate stock movement for a period of time by generating a sequence of values from 1 to 20, incrementing by 1 each time using the <code>seq()</code> function. We’ll call the vector representing the period of time <code>t.vals</code>.</p>&#13;
<pre> t.vals &lt;- seq(1,20,by=1)</pre>&#13;
<p class="indent">Now <code>t.vals</code> is a vector containing the sequence of numbers from 1 to 20 incremented by 1. Next, we’ll create some simulated prices by taking the cumulative sum of a normally distributed value for each time in your <code>t.vals</code>. To do this we’ll use <code>rnorm()</code> to sample the number of values equal to the length of <code>t.vals</code>. Then we’ll use <code>cumsum()</code> to calculate the cumulative sum of this vector of values. This will represent the idea of a price moving up or down based on random motion; less extreme movements are more common than more extreme ones.</p>&#13;
<pre> price.vals &lt;- cumsum(rnorm(length(t.vals),mean=5,sd=10))</pre>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_214"/>Finally, we can plot all these values to see how they look! We’ll use both the <code>plot()</code> and <code>lines()</code> functions, and label the axes according to what they represent.</p>&#13;
<pre>plot(t.vals,price.vals,<br/>&#13;
     main="Simulated stock ticker",<br/>&#13;
     xlab="time",<br/>&#13;
     ylab="price")<br/>&#13;
lines(t.vals,price.vals)</pre>&#13;
<p class="indent">The <code>plot()</code> and <code>lines()</code> functions should generate the plot shown in <a href="app01.xhtml#app01fig08">Figure A-8</a>.</p>&#13;
<div class="image"><a id="app01fig08"/><img alt="Image" src="../images/afig08.jpg"/></div>&#13;
<p class="figcap"><em>Figure A-8: The plot generated for our simulated stock ticker</em></p>&#13;
<h3 class="h3" id="app01lev1sec9"><strong>Summary</strong></h3>&#13;
<p class="noindent">This appendix should cover enough R to give you a grasp of the examples in this book. I recommend following along with the book’s chapters, then playing around by modifying the code examples to learn more. R also has some great online documentation if you want to take your experimentation further.</p>&#13;
</body></html>