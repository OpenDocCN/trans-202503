<html><head></head><body>
<h2 class="h2" id="ch1"><span epub:type="pagebreak" id="page_3"/><span class="big">1</span><br/>GETTING STARTED</h2>&#13;
<div class="image1"><img class="inline" src="../images/common.jpg" alt="Images"/></div>&#13;
<p class="noindent"><span class="bign">The name <em>PowerShell</em> refers to two things. One is a command line shell, installed by default on all recent versions of Windows (starting with Windows 7) and most recently available on Linux and macOS operating systems via PowerShell Core. The other is a scripting language.</span> Together they refer to one framework that can be used to automate everything from rebooting 100 servers at once to building a complete automation system that controls your entire data center.</p>&#13;
<p class="indent">In the first chapters of this book, you’ll use the PowerShell console to become familiar with the basics of PowerShell. Once you’ve covered the basics, you’ll graduate to more advanced topics including writing scripts, functions, and custom modules.</p>&#13;
<p class="indent">This chapter covers the basics: some fundamental commands, and how to find and read help pages.</p>&#13;
<h3 class="h3" id="ch1lev1"><span epub:type="pagebreak" id="page_4"/>Opening the PowerShell Console</h3>&#13;
<p class="noindent">The examples in this book use PowerShell v5.1, the version that comes with Windows 10. Newer versions of PowerShell have more features and bug fixes, but the basic syntax and core functionality of PowerShell hasn’t changed dramatically since version 2.</p>&#13;
<p class="indent">To open PowerShell in Windows 10, enter <strong>PowerShell</strong> in the Start menu. You should immediately see a Windows PowerShell option front and center. Clicking that option should bring up a blue console and a flashing cursor, as in <a href="ch01.xhtml#ch1fig1">Figure 1-1</a>.</p>&#13;
<div class="image"><img src="../images/01fig01.jpg" alt="Image"/></div>&#13;
<p class="figcap" id="ch1fig1"><em>Figure 1-1: A PowerShell console</em></p>&#13;
<p class="indent">The flashing cursor indicates that PowerShell is ready for your input. Note that your <em>prompt</em>—the line beginning with <span class="literal">PS&gt;</span>—will probably look different from mine; the file path in the prompt indicates your current location in the system. As you can see in my console’s title, I’ve right-clicked the PowerShell icon and run it as administrator. This gives me full rights, and starts me in the <em>C:\Windows\system32\WindowsPowerShell\v1.0</em> directory.</p>&#13;
<h3 class="h3" id="ch1lev2">Using DOS Commands</h3>&#13;
<p class="noindent">Once PowerShell is open, you can start exploring. If you’ve previously used the Windows command line, <em>cmd.exe</em>, you’ll be glad to know that all the commands you’re used to (for example, <span class="literal">cd</span>, <span class="literal">dir</span>, and <span class="literal">cls</span>) also work in PowerShell. Under the covers, these DOS “commands” aren’t really commands, but command <em>aliases</em>, or pseudonyms, that translate from commands you know to commands PowerShell knows. But for now, you don’t need to understand the difference—just consider them your familiar DOS friends!</p>&#13;
<p class="indent">Let’s try some of these commands. If you’re sitting at the <span class="literal">PS&gt;</span> prompt and want to check out a specific directory’s contents, first navigate to that directory with <span class="literal">cd</span>, short for <em>change directory</em>. Here you’ll go to the <em>Windows</em> directory:</p>&#13;
<pre>PS&gt; <span class="codestrong1">cd .\Windows\</span>&#13;
PS C:\Windows&gt;</pre>&#13;
<div class="sidebar">&#13;
<p class="sidebart"><span epub:type="pagebreak" id="page_5"/>USING TAB COMPLETION</p>&#13;
<p class="noindent">Notice that I specified the <em>Windows</em> directory with a dot and backslashes on either side: <span class="literal">.\Windows\</span>. In fact, you don’t have to type all this out because the PowerShell console has a great tab completion feature that lets you hit <span class="small">TAB</span> repeatedly to cycle through the commands that can be used, given what you’ve already typed.</p>&#13;
<p class="indent">For example, if you type <span class="small">GET-</span> followed by a <span class="small">TAB</span>, you can begin scrolling through all the commands that start with <span class="small">GET-</span>. Keep hitting <span class="small">TAB</span> to move forward through the commands; <span class="small">SHIFT-</span><span class="small">TAB</span> will move you backward. You can also use tab completion on parameters, which I’ll cover in “Exploring PowerShell Commands” on <a href="ch01.xhtml#page_6">page 6</a>, as you can see by typing <span class="literal">Get-Content -</span> followed by <span class="small">TAB</span>. This time, instead of cycling through commands, PowerShell begins cycling through the available parameters for the <span class="literal">Get-Content</span> command. When in doubt, press <span class="small">TAB</span>!</p>&#13;
</div>&#13;
<p class="indent">Once in the <em>C:\Windows</em> folder, you can use the <span class="literal">dir</span> command to list the contents of your current directory, as shown in <a href="ch01.xhtml#ch1list1">Listing 1-1</a>.</p>&#13;
<pre>PS C:\Windows&gt; <span class="codestrong1">dir</span>&#13;
&#13;
&#13;
    Directory: C:\Windows&#13;
&#13;
&#13;
Mode                LastWriteTime         Length Name&#13;
----                -------------         ------ ----&#13;
d-----        3/18/2019   4:03 PM                addins&#13;
d-----         8/9/2019  10:28 AM                ADFS&#13;
d-----        7/24/2019   5:39 PM                appcompat&#13;
d-----        8/19/2019  12:33 AM                AppPatch&#13;
d-----        9/16/2019  10:25 AM                AppReadiness&#13;
<span class="codeitalic1">--snip--</span></pre>&#13;
<p class="caption" id="ch1list1"><em>Listing 1-1: Displaying the content of the current directory with the <span class="codeitalic">dir</span> command</em></p>&#13;
<p class="indent">Entering <span class="literal">cls</span> will clear your screen and give you a fresh console again. If you’re familiar with <em>cmd.exe</em>, try some of the other <em>cmd.exe</em> commands you know to see if they work. Note that although the majority do, not all will. If you’re curious about which <em>cmd.exe</em> commands exist in PowerShell, once you have the PowerShell console up, you can enter <span class="literal">Get-Alias</span> in the PowerShell console to return many of the old-school <em>cmd.exe</em> commands you’re used to, like so:</p>&#13;
<pre>PS&gt; <span class="codestrong1">Get-Alias</span></pre>&#13;
<p class="indent">This will allow you to see all the built-in aliases and which PowerShell commands they map to.</p>&#13;
<h3 class="h3" id="ch1lev3"><span epub:type="pagebreak" id="page_6"/>Exploring PowerShell Commands</h3>&#13;
<p class="noindent">Like nearly all languages, PowerShell has <em>commands</em>, the generic term for named executable expressions. A command can be just about anything—from the legacy <em>ping.exe</em> tool to the <span class="literal">Get-Alias</span> command I referred to earlier. You can even build your own commands. However, if you try to use a nonexistent command, you’ll get the infamous red error text, as shown in <a href="ch01.xhtml#ch1list2">Listing 1-2</a>.</p>&#13;
<pre>PS&gt; <span class="codestrong1">foo</span>&#13;
foo : The term 'foo' is not recognized as the name of a cmdlet, function,&#13;
script file, or operable program. Check the spelling of the name, or if a&#13;
path was included, verify that the path is correct and try again.&#13;
At line:1 char:1&#13;
+ foo&#13;
+ ~~~&#13;
    + CategoryInfo          : ObjectNotFound: (foo:String) [], CommandNotFoundException&#13;
    + FullyQualifiedErrorId : CommandNotFoundException</pre>&#13;
<p class="caption" id="ch1list2"><em>Listing 1-2: An error is displayed when an unrecognized command is entered.</em></p>&#13;
<p class="indent">You can execute <span class="literal">Get-Command</span> to see a list of every command PowerShell is aware of by default. You might notice a common pattern. Most commands’ names follow the same scheme: <em>Verb</em>-<em>Noun</em>. This is a unique trait of PowerShell. To keep the language as intuitive as possible, Microsoft has set guidelines for command names. Although following this naming convention is optional, it is highly recommended for creating your own commands.</p>&#13;
<p class="indent">PowerShell commands come in a few flavors: cmdlets, functions, aliases, and sometimes external scripts. Most of the built-in commands from Microsoft are <em>cmdlets</em>, which are typically commands written in other languages like C#. By running the <span class="literal">Get-Command</span> command, as in <a href="ch01.xhtml#ch1list3">Listing 1-3</a>, you’ll see a <span class="literal">CommandType</span> field.</p>&#13;
<pre>PS&gt; <span class="codestrong1">Get-Command -Name Get-Alias</span>&#13;
&#13;
CommandType     Name                Version    Source&#13;
-----------     ----                -------    ------&#13;
Cmdlet          Get-Alias           3.1.0.0    Microsoft.PowerShell.Utility</pre>&#13;
<p class="caption" id="ch1list3"><em>Listing 1-3: Displaying the <span class="codeitalic">Get-Alias</span> command’s type</em></p>&#13;
<p class="indent"><em>Functions</em>, on the other hand, are commands written in PowerShell. You write functions to get things done; you can leave the cmdlets to the software developers. Cmdlets and functions are the most common command types you’ll be working with in PowerShell.</p>&#13;
<p class="indent">You’ll use the <span class="literal">Get-Command</span> command to explore the plethora of cmdlets and functions available in PowerShell. But as you may have just seen, entering <span class="literal">Get-Command</span> with no parameters will leave you tapping your finger for a few seconds as your console scrolls through all the commands available.</p>&#13;
<p class="indent">A lot of commands in PowerShell have <em>parameters</em>, which are values you give (or <em>pass</em>) to a command to customize its behavior. For instance, <span class="literal">Get-Command</span> has various parameters that allow you to return only specific <span epub:type="pagebreak" id="page_7"/>commands instead of all of them. Looking through <span class="literal">Get-Command</span>, you may have noticed common verbs such as <span class="literal">Get</span>, <span class="literal">Set</span>, <span class="literal">Update</span>, and <span class="literal">Remove</span>. If you guessed that all of the <span class="literal">Get</span> commands <em>get</em> information and the others modify information, you’d be right. In PowerShell, what you see is what you get. Commands are named intuitively and generally do what you’d expect.</p>&#13;
<p class="indent">Since you’re just starting out, you don’t want to change anything on your system. You do want to retrieve information from various sources. Using the <span class="literal">Verb</span> parameter on <span class="literal">Get-Command</span>, you can limit that huge list of commands to only those that use the <span class="literal">Get</span> verb, for example. To do this, enter the following command at the prompt:</p>&#13;
<pre>PS&gt; <span class="codestrong1">Get-Command -Verb Get</span></pre>&#13;
<p class="indent">You’ll probably agree that a few too many commands are still displayed, so you can limit the results even further by adding the <span class="literal">Noun</span> parameter to specify the <span class="literal">Content</span> noun, as in <a href="ch01.xhtml#ch1list4">Listing 1-4</a>.</p>&#13;
<pre>PS&gt; <span class="codestrong1">Get-Command -Verb Get -Noun Content</span>&#13;
&#13;
CommandType     Name                Version    Source&#13;
-----------     ----                -------    ------&#13;
Cmdlet          Get-Content         3.1.0.0    Microsoft.PowerShell.Management</pre>&#13;
<p class="caption" id="ch1list4"><em>Listing 1-4: Displaying only commands that contain the verb</em> Get <em>and the noun</em> Content</p>&#13;
<p class="indent">If these results are too narrow for you, you also can use <span class="literal">Noun</span> without the <span class="literal">Verb</span> parameter, as shown in <a href="ch01.xhtml#ch1list5">Listing 1-5</a>.</p>&#13;
<pre>PS&gt; <span class="codestrong1">Get-Command -Noun Content</span>&#13;
&#13;
CommandType     Name                Version    Source&#13;
-----------     ----                -------    ------&#13;
Cmdlet          Add-Content         3.1.0.0    Microsoft.PowerShell.Management&#13;
Cmdlet          Clear-Content       3.1.0.0    Microsoft.PowerShell.Management&#13;
Cmdlet          Get-Content         3.1.0.0    Microsoft.PowerShell.Management&#13;
Cmdlet          Set-Content         3.1.0.0    Microsoft.PowerShell.Management</pre>&#13;
<p class="caption" id="ch1list5"><em>Listing 1-5: Displaying only commands that contain the noun</em> Content</p>&#13;
<p class="indent">You can see that <span class="literal">Get-Command</span> allows you to separate out the verb and noun. If you’d rather define the entire command as one unit, you can use the <span class="literal">Name</span> parameter instead and specify the entire command name, as shown in <a href="ch01.xhtml#ch1list6">Listing 1-6</a>.</p>&#13;
<pre>PS&gt; <span class="codestrong1">Get-Command -Name Get-Content</span>&#13;
&#13;
CommandType     Name                Version    Source&#13;
-----------     ----                -------    ------&#13;
Cmdlet          Get-Content         3.1.0.0    Microsoft.PowerShell.Management</pre>&#13;
<p class="caption" id="ch1list6"><em>Listing 1-6: Finding the <span class="codeitalic">Get-Content</span> cmdlet by command name</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_8"/>As I said previously, lots of commands in PowerShell have parameters that customize their behavior. You can learn a command’s parameters by using the robust PowerShell help system.</p>&#13;
<h3 class="h3" id="ch1lev4">Getting Help</h3>&#13;
<p class="noindent">PowerShell’s documentation isn’t unique by any means, but the way the documentation and help content is integrated into the language is truly a work of art. In this section, you’ll learn how to display command help pages in the prompt window, get more general information on the language via About topics, and update your documentation with <span class="literal">Update-Help</span>.</p>&#13;
<h4 class="h4" id="ch1lev4sec1">Displaying the Docs</h4>&#13;
<p class="noindent">Similar to the <span class="literal">man</span> command in Linux, PowerShell has the <span class="literal">help</span> command and the <span class="literal">Get-Help</span> cmdlet. If you’re interested in seeing what one of those <span class="literal">Content</span> cmdlets does, you can pass that command name to the <span class="literal">Get-Help</span> command to retrieve the standard <span class="literal">SYNOPSIS</span>, <span class="literal">SYNTAX</span>, <span class="literal">DESCRIPTION</span>, <span class="literal">RELATED LINKS</span>, and <span class="literal">REMARKS</span> help sections. These sections provide a breakdown of what the command does, where you can find more information about the command, and even some related commands. <a href="ch01.xhtml#ch1list7">Listing 1-7</a> displays the documentation for the <span class="literal">Add-Content</span> command.</p>&#13;
<pre>PS&gt; <span class="codestrong1">Get-Help Add-Content</span>&#13;
&#13;
NAME&#13;
    Add-Content&#13;
&#13;
SYNOPSIS&#13;
    Appends content, such as words or data, to a file.&#13;
&#13;
<span class="codeitalic1">--snip--</span></pre>&#13;
<p class="caption" id="ch1list7"><em>Listing 1-7: The <span class="codeitalic">Add-Content</span> command’s help page</em></p>&#13;
<p class="indent">Providing just the command name to <span class="literal">Get-Help</span> is useful, but the most helpful part of this content is the <span class="literal">Examples</span> parameter. This parameter shows examples of real-world uses of the command in a variety of scenarios. Try <span class="literal">Get-Help</span> <span class="codeitalic">CommmandName</span> <span class="literal">-Examples</span> on any command and notice that nearly all built-in commands have examples to help you understand what they do. For example, you can run the command on the <span class="literal">Add-Content</span> cmdlet, as in <a href="ch01.xhtml#ch1list8">Listing 1-8</a>.</p>&#13;
<pre>PS&gt; <span class="codestrong1">Get-Help Add-Content -Examples</span>&#13;
&#13;
NAME&#13;
    Add-Content&#13;
<span epub:type="pagebreak" id="page_9"/>SYNOPSIS&#13;
    Appends content, such as words or data, to a file.&#13;
&#13;
&#13;
    -------------------------- EXAMPLE 1 --------------------------&#13;
&#13;
    C:\PS&gt;Add-Content -Path *.txt -Exclude help* -Value "END"&#13;
&#13;
    Description&#13;
&#13;
    -----------&#13;
&#13;
    This command adds "END" to all text files in the current directory,&#13;
    except for those with file names that begin with "help."&#13;
<span class="codeitalic1">--snip--</span></pre>&#13;
<p class="caption" id="ch1list8"><em>Listing 1-8: Getting sample usages of the <span class="codeitalic">Add-Content</span> command</em></p>&#13;
<p class="indent">If you want more information, the <span class="literal">Get-Help</span> cmdlet also has the <span class="literal">Detailed</span> and <span class="literal">Full</span> parameters, which give you a complete rundown on what that command does.</p>&#13;
<h4 class="h4" id="ch1lev4sec2">Learning About General Topics</h4>&#13;
<p class="noindent">In addition to help content for individual commands, the PowerShell help system provides <em>About topics</em>, which are help snippets for broader subjects and specific commands. For example, in this chapter you’re learning about some of PowerShell’s core commands. Microsoft has created an About topic that gives an overall explanation of these commands. To see it, you run <span class="codestrong">Get-Help about_Core_Commands</span>, as shown in <a href="ch01.xhtml#ch1list9">Listing 1-9</a>.</p>&#13;
<pre>PS&gt; <span class="codestrong1">Get-Help about_Core_Commands</span>&#13;
TOPIC&#13;
    about_Core_Commands&#13;
&#13;
SHORT DESCRIPTION&#13;
    Lists the cmdlets that are designed for use with Windows PowerShell&#13;
    providers.&#13;
&#13;
&#13;
LONG DESCRIPTION&#13;
    Windows PowerShell includes a set of cmdlets that are specifically&#13;
    designed to manage the items in the data stores that are exposed by Windows&#13;
    PowerShell providers. You can use these cmdlets in the same ways to manage&#13;
    all the different types of data that the providers make available to you.&#13;
    For more information about providers, type "get-help about_providers".&#13;
&#13;
&#13;
    For example, you can use the Get-ChildItem cmdlet to list the files in a&#13;
    file system directory, the keys under a registry key, or the items that&#13;
    are exposed by a provider that you write or download.&#13;
<span epub:type="pagebreak" id="page_10"/>    The following is a list of the Windows PowerShell cmdlets that are designed&#13;
    for use with providers:&#13;
&#13;
<span class="codeitalic1">--snip--</span></pre>&#13;
<p class="caption" id="ch1list9"><em>Listing 1-9: About topic for PowerShell’s core commands</em></p>&#13;
<p class="indent">To get a complete list of all the About topics available, use a wildcard for the <span class="literal">Name</span> parameter. In PowerShell, the <em>wildcard</em> character, an asterisk (<span class="literal">*</span>), can be used as a placeholder for zero or more characters. You can use a wildcard with the <span class="literal">Get-Help</span> command’s <span class="literal">Name</span> parameter, as in <a href="ch01.xhtml#ch1list10">Listing 1-10</a>.</p>&#13;
<pre>PS&gt; <span class="codestrong1">Get-Help -Name About*</span></pre>&#13;
<p class="caption" id="ch1list10"><em>Listing 1-10: Using a wildcard on the <span class="codeitalic">Get-Help</span> command’s <span class="codeitalic">Name</span> parameter</em></p>&#13;
<p class="indent">By appending the wildcard to <span class="literal">About</span>, you’re asking PowerShell to search for all possible topics that start with <em>About</em>. If there are multiple matches, PowerShell will display a list, with brief information about each. To get the full information about one of the matches, you’ll have to pass it into <span class="literal">Get-Help</span> directly, as shown previously in <a href="ch01.xhtml#ch1list9">Listing 1-9</a>.</p>&#13;
<p class="indent">Although the <span class="literal">Get-Help</span> command has a <span class="literal">Name</span> parameter, you can pass the parameter argument directly to it by entering <span class="literal">-Name</span>, as shown in <a href="ch01.xhtml#ch1list10">Listing 1-10</a>. This is known as using a <em>positional</em> <em>parameter</em>, which determines the value you’re passing in based on its (you guessed it) position in the command. Positional parameters are a shortcut that many PowerShell commands have, allowing you to reduce the number of keystrokes.</p>&#13;
<h3 class="h3" id="ch1lev5">Updating the Docs</h3>&#13;
<p class="noindent">The help system in PowerShell is a great asset for anyone who wants to learn more about the language, but one key feature makes this help system much better: it’s dynamic! Documentation tends to get stale after a while. A product ships with documentation, bugs creep in, new features get released, but the documentation on the system stays the same. PowerShell addresses this problem with <em>updatable help</em>, which allows the built-in PowerShell cmdlets and any other cmdlets—or functions built by others—to point to an internet URI in order to host up-to-date documentation. Simply enter <span class="literal">Update-Help</span>, and PowerShell will begin reading the help on your system and checking it against the various online locations.</p>&#13;
<p class="indent">Note that although updatable help is included with all built-in PowerShell cmdlets, it isn’t required for any third-party commands. Also, documentation is only as recent as the developer makes it. PowerShell provides the tools for developers to write better help content, but they still have to keep the repository containing their help files current. Finally, you may occasionally receive an error when running <span class="literal">Update-Help</span> if the location where the help is stored is not available anymore. In short, don’t expect <span class="literal">Update-Help</span> to <em>always</em> show the latest help content for every command in PowerShell.</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart"><span epub:type="pagebreak" id="page_11"/>RUNNING POWERSHELL AS ADMINISTRATOR</p>&#13;
<p class="noindent">At times it’s necessary to run the PowerShell console <em>as Administrator</em>. This typically happens when you need to modify files, the registry, or anything else that’s outside your user profile. For example, the <span class="literal">Update-Help</span> command mentioned previously needs to modify system-level files and cannot be run properly by a non-Administrator user.</p>&#13;
<p class="indent">You can run PowerShell as an Administrator by right-clicking in Windows PowerShell and then clicking <strong>Run as Administrator</strong>, as shown in <a href="ch01.xhtml#ch1fig2">Figure 1-2</a>.</p>&#13;
<div class="image"><img src="../images/01fig02.jpg" alt="Image"/></div>&#13;
<p class="figcap" id="ch1fig2"><em>Figure 1-2: Running PowerShell as Administrator</em></p>&#13;
</div>&#13;
<h3 class="h3" id="ch1lev6">Summary</h3>&#13;
<p class="noindent">In this chapter, you learned a few commands that will help you get started. When starting anything new, you’re not going to know what you don’t know. You just need a seed of knowledge that enables you to explore more by yourself. By understanding the basics of PowerShell commands and how to use <span class="literal">Get-Command</span> and <span class="literal">Get-Help</span>, you now have the tools you need to begin learning PowerShell. A big, exciting journey lies ahead of you!<span epub:type="pagebreak" id="page_12"/></p>&#13;
</body></html>