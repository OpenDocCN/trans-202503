<html><head></head><body>
<h2 class="h2" id="ch06"><span epub:type="pagebreak" id="page_155"/><strong><span class="big">6</span><br/>THE BATTERY SAVER</strong></h2>&#13;
<div class="image1"><img alt="image" src="../images/common-01.jpg"/></div>&#13;
<p class="noindent">This project was actually born back in the 1970s, when I built a very similar device for the first time. Its purpose is to disconnect a vehicle’s battery when an inadvertent drain would discharge the battery to the point where the vehicle would not start. Before the advent of computerized automobiles, it was common for drivers to park and leave the lights turned on only to come back to find a dead battery. Then, they had to find a way to call a service station (cell phones weren’t available) and get a boost. Worse, if the battery died and the car was left sitting long enough, the battery would become useless and have to be replaced. After remaining in a discharged state between 12 and 18 hours, most lead-acid batteries would go totally dead and could not be rejuvenated.</p>&#13;
<p class="indent">But that was then. Now, many vehicles—particularly those equipped with automatic lighting systems—protect against such inconveniences with automatic (often delayed) shutoff for electrical systems. However, several <span epub:type="pagebreak" id="page_156"/>types of vehicles still don’t have automatic shutdown systems or alarms to warn you that the lights are on. This project, shown in <a href="ch06.xhtml#ch06fig1">Figure 6-1</a>, is particularly useful for those vehicles.</p>&#13;
<div class="image"><img alt="image" src="../images/f06-01.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig1"/><em>Figure 6-1: The finished Battery Saver, boxed and ready to go (top), as well as a look inside (bottom)</em></p>&#13;
<h3 class="h3" id="ch06lev1sec1"><span epub:type="pagebreak" id="page_157"/><strong>Boats, Tractors, and Other Vehicles</strong></h3>&#13;
<p class="noindent">Many road-worthy vehicles could benefit from the Battery Saver, but this project is targeted at other systems where an accidental discharge of a battery could be annoying—and expensive. Boats are particularly vulnerable. Even my small runabout has experienced problems. On more than one occasion, the running lights were left on during the day, and I did not notice until a couple of days later. The battery was totally dead, and it had to be replaced.</p>&#13;
<p class="indent">Leaving the running lights on isn’t the only way to accidentally drain a boat battery. Most inboard boats have a blower system designed to safely expel potentially explosive gases and fuel vapors from the bilge. Conventional wisdom (and the Coast Guard) says to keep the bilge blowers on before starting the engines, the entire time the boat is in service, and for at least 10 minutes after shutdown. It’s very easy to forget the blowers are on and then find you need to replace the battery or batteries the next time you use the boat.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="bgblack">NOTE</span></strong></p>&#13;
<p class="notep"><em>Before building the Battery Saver for a safety system like the blowers on a boat, read “<a href="ch06.xhtml#ch06note1">Notes of Caution</a>” on <a href="ch02.xhtml#page_58">page 158</a>. There are some considerations to keep in mind that may require some minor wiring changes to the electrical system</em>.</p>&#13;
</div>&#13;
<p class="indentb">Boats aren’t the only vulnerable vehicles, though. Riding mowers and tractors are also at risk for three reasons:</p>&#13;
<p class="bull">• They are usually used only intermittently.</p>&#13;
<p class="bull">• Parking and/or headlight switches are often placed where it’s easy to accidentally bump them when getting on or off the vehicle. The switches can also be damaged by flying debris or rough terrain.</p>&#13;
<p class="bullb">• They are usually used in daylight hours, so it can be hard to tell when the lights are on.</p>&#13;
<p class="indent">The Battery Saver can also protect powered tools, like tow-behind sprayers. It’s easy to leave these tools turned on when finished, and while most sprayer pumps don’t take too much current, leaving one on for, say, a day or two, will likely drain the battery.</p>&#13;
<h3 class="h3" id="ch06lev1sec2"><strong>Required Tools</strong></h3>&#13;
<p class="noindent-s">Drill and drill bits</p>&#13;
<p class="noindent-s">Center punch</p>&#13;
<p class="noindent-s">4-40 tap</p>&#13;
<p class="noindent-s">Hacksaw</p>&#13;
<p class="noindent-s">400-grit sandpaper</p>&#13;
<p class="noindent-s">Countersink (Almost any 82° countersink will do. The material being formed is relatively soft, so no special materials are required.)</p>&#13;
<p class="noindent-s"><span epub:type="pagebreak" id="page_158"/>Needle files (See <a href="ch06.xhtml#ch06fig20">Figure 6-20</a>. While only one is required, they usually come in sets.)</p>&#13;
<p class="noindent-s">Triangle file</p>&#13;
<div class="box1">&#13;
<p class="boxtitle"><a id="ch06note1"/><strong>NOTES OF CAUTION</strong></p>&#13;
<p class="noindent">If you create the Battery Saver as described in this chapter, it should work well. However, it is always possible for Murphy’s Law to cause a problem, so here are a few points to consider before you build.</p>&#13;
<p class="indent">Should the Battery Saver fail, it can be reset, but in the meantime, it will remove all power to the vehicle’s electrical system. <em>Do not</em> use the Battery Saver on any system where an electrical failure could cause catastrophic problems (such as on an aircraft) or result in bodily harm or property damage. That said, I have used the following unit in a car, on three agricultural tractors, and on two boats for well over a year (and earlier versions for several years) with no failures.</p>&#13;
<p class="indent">The Battery Saver includes a very high-current switch. It is possible that, under certain conditions, a resistance could develop such that when current is applied, the switch becomes extremely hot—perhaps hot enough to be a fire hazard. (For what it’s worth, this has never happened even on prototype versions.) All efforts have been made to eliminate problems like this—for example, the block that holds the Battery Saver’s copper contacts is made of a fire- and melt-resistant phenolic material—but overheating remains a hazard. Always check the heat of the Battery Saver before you touch it to make certain that it is not hot enough to burn you. Even the reset plunger could become warm enough to burn if the vehicle or Battery Saver malfunctions.</p>&#13;
<p class="indent">This last warning is specific to mariners. If you keep your boat in the water, chances are it has a built-in bilge pump and automatic float switch to keep it afloat when you’re not aboard. If you have multiple batteries, make sure the bilge pump is wired to a battery that isn’t in the circuit with the Battery Saver, as in <a href="ch06.xhtml#ch06fig2">Figure 6-2</a>. Otherwise, find the wire that provides current to the bilge pump/switch, and simply bypass the Battery Saver.</p>&#13;
<div class="image"><img alt="image" src="../images/f06-02.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig2"/><em>Figure 6-2: Wiring the Battery Saver on a boat</em></p>&#13;
</div>&#13;
<h3 class="h3" id="ch06lev1sec3"><span epub:type="pagebreak" id="page_159"/><strong>Parts List</strong></h3>&#13;
<p class="noindentb">This parts list might look somewhat like a scavenger hunt, but everything can be found easily from a variety of sources. Getting the particular size or quantity, however, may be challenging, so read the list carefully to make sure you have everything before you start. And before shopping, look ahead to <a href="ch06.xhtml#ch06fig13">Figure 6-13</a> on <a href="ch06.xhtml#page_170">page 170</a> to see some of the more unusual parts, like the copper contacts.</p>&#13;
<p class="noindent-s">One Deek-Robot Pro Mini Arduino clone microcontroller board (There are several available, and some have different pinouts—particularly for pins A4 and A5.</p>&#13;
<p class="noindent-s"><a href="ch06.xhtml#ch06fig3">Figure 6-3</a> shows the pinout for the one I used. Other units with different pinouts should work, but the connections on the shield must be changed.)</p>&#13;
<p class="noindent-s">One LM7805 voltage regulator</p>&#13;
<p class="noindent-s">12V solenoid (This project uses an Electronic Goldmine G19852.)</p>&#13;
<p class="noindent-s">One 10-kilohm resistor</p>&#13;
<p class="noindent-s">One 5.6-kilohm resistor</p>&#13;
<p class="noindent-s">One 4.7-kilohm resistor</p>&#13;
<p class="noindent-s">One 470-ohm resistor</p>&#13;
<p class="noindent-s">One 4.7V Zener diode</p>&#13;
<p class="noindent-s">One 1N4002 diode or equivalent</p>&#13;
<p class="noindent-s">Two ZTX649 transistors</p>&#13;
<p class="noindent-s">One 1/2-inch phenolic sheet</p>&#13;
<p class="noindent-s">One 6×3/4×3/16–inch copper bar, which is part of a high-current switch (This is actually a piece of copper bus bar that is generally used in large electrical installations. See <a href="ch06.xhtml#ch06fig4">Figure 6-4</a> for an example. To find this, you may need to do a little digging with an online search for <em>copper bus bar</em>. I bought a piece that was 3 feet long.)</p>&#13;
<div class="image"><img alt="image" src="../images/f06-03.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig3"/><em>Figure 6-3: Pinout of the Deek-Robot Pro Mini Arduino clone</em></p>&#13;
<div class="image"><img alt="image" src="../images/f06-04.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig4"/><em>Figure 6-4: A copper bus bar, drilled out for the Battery Saver</em></p>&#13;
<p class="noindent-s"><span epub:type="pagebreak" id="page_160"/>One ABS plastic enclosure, like the Hammond 1591 STCL</p>&#13;
<p class="noindent-s">Two 1/4-inch brass rounds (You’ll use one of these as the pylon.)</p>&#13;
<p class="noindent-s">A small piece of sheet metal to use as the release</p>&#13;
<p class="noindent-s">One e-clip</p>&#13;
<p class="noindent-s">Four 1/2-inch, 4-40 flathead screws</p>&#13;
<p class="noindent-s">One 3/8-inch, 4-40 roundhead screw</p>&#13;
<p class="noindent-s">3 oz of Permatex Silicone RTV sealant</p>&#13;
<p class="noindent-s">One matching pair of inline connectors (You can buy simple, cheap, inline connectors online, or you can make your own. I used Pololu’s 1×2 connector housing and male and female crimp pins, shown in <a href="ch06.xhtml#ch06fig5">Figure 6-5</a>. See “<a href="ch00.xhtml#ch00lev1sec6">Connectors Used in This Book</a>” on <a href="ch00.xhtml#page_18">page 18</a> for crimping techniques. You can also use telephone-style chicklets if you can find them.)</p>&#13;
<div class="image"><img alt="image" src="../images/f06-05.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig5"/><em>Figure 6-5: A pair of mating connectors used to connect the solenoid</em></p>&#13;
<p class="noindent-s">28-gauge hookup wire</p>&#13;
<p class="noindent-s">One solder lug (If you can’t find one, you can work around it by taking the power wire from the Arduino and wrapping it under the head of the screw, as shown in <a href="ch06.xhtml#ch06fig7">Figure 6-7</a>.)</p>&#13;
<p class="noindent-s">One battery cable to fit your storage battery on one side and a lug to attach to the Battery Saver on the other</p>&#13;
<h3 class="h3" id="ch06lev1sec4"><strong>Downloads</strong></h3>&#13;
<p class="noindent-s"><strong>Sketch</strong>   <em>BatterySaver.ino</em></p>&#13;
<p class="noindent-s"><strong>Templates</strong>   <em>ReleaseLever.pdf, BatterySaverEnclosure.pdf</em></p>&#13;
<p class="noindent-s"><strong>Shield</strong>   <em>BatterySaver.pcb</em></p>&#13;
<h3 class="h3" id="ch06lev1sec5"><strong>The Schematic</strong></h3>&#13;
<p class="noindent">While the circuit is relatively simple, as shown in <a href="ch06.xhtml#ch06fig6">Figure 6-6</a>, there are a couple of key design elements to be aware of.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_161"/><img alt="image" src="../images/f06-06.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig6"/><em>Figure 6-6: Schematic for the Battery Saver</em></p>&#13;
<p class="indent">Notice that the circuit uses an LM7805 voltage regulator. In theory, the small regulator included in the Pro Mini board would be more than satisfactory because the load is relatively light. But under the hood of a car and around high-current systems and high-voltage electronics, there is a lot of stray electromagnetic energy bouncing around. While it’s improbable that this energy would cause a problem for the Battery Saver, it is well within the realm of possibility. The more robust 1.5 A LM7805 regulator offers the Pro Mini another level of protection. In addition, capacitors C1 and C2 have been included to bypass any AC sneaking into the circuit and to prevent unwanted oscillation. Similarly, the 4.7V Zener diode (D1) protects the input of the Arduino from a voltage spike—which is very likely—on the 12V supply. It limits the voltage to A0 to only 4.7V.</p>&#13;
<p class="indent">The configuration of resistors R1 and R2 may look familiar from other projects. They comprise a voltage divider to lower the 12V supply to a level below the 5V maximum the Arduino input can tolerate. To be on the safe side, I selected a value of 10 kilohms for R1 and 5.6 kilohms for R2. Both are standard values. This design should allow the battery voltage to jump to 14V before reaching the point where the Zener diode kicks in.</p>&#13;
<p class="indent">Diode D2 (1N4002 or equivalent) provides yet another level of defense: it protects against an inverse current that could be created when the magnetic field in the solenoid collapses. This is a standard protection device in inductors with an iron core, which can store magnetic energy and release it rapidly into the coil. The reverse voltage can reach relatively high levels and create significant currents, which could, in this case, damage the driver transistor and other components in the system.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_162"/>Transistors Q1 and Q2 are both ZTX649 silicon NPN transistors. I chose these transistors because they have sufficient drive capability and are inexpensive and readily available. I used the same model as in other projects. The high side of Q2 is brought to the red positive rail (VCC), as the LM7805 regulator supplies plenty of current. (You could just as easily connect the high side, or collector, of Q2 to the 12V supply, because Q2 is wired as an emitter follower and the voltage at the emitter will follow only the voltage at the base.) R4, a 470-ohm resistor, limits the current to LED 1.</p>&#13;
<p class="indent">LED1 indicates when the unit is operating. The circuit containing Q2 and LED1 provides a blinking LED with a very short on cycle, which is consistent with this volume’s goal of blinking LEDs as often as possible.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="bgblack">NOTE</span></strong></p>&#13;
<p class="notep"><em>The Deek-Robot Pro Mini also has a red LED that indicates when it is turned on. This additional, although very small, constant current drain could contribute to the discharge of the battery. In the units that I installed, I unsoldered one end of the Pro Mini’s LED, which is kind of a delicate operation</em>.</p>&#13;
</div>&#13;
<p class="indent">Transistor Q1, wired as a common emitter circuit, provides the drive for the solenoid. Resistor R3 (4.7 kilohms) drives the transistor and also protects it—a direct connection would allow too much current to flow in the base-emitter junction, resulting in potential damage. The high side of the solenoid is connected to positive 12V to allow maximum voltage and current to flow through the solenoid coil without taxing the voltage regulator.</p>&#13;
<h4 class="h4" id="ch06lev2sec1"><em><strong>How the Battery Saver Prevents Draining</strong></em></h4>&#13;
<p class="noindent">The Battery Saver comprises a very high-current switch that can be electrically turned off and a sensor circuit to detect when the battery is in jeopardy of dying. The high-current switch is required because it interrupts the main power from the battery, which includes the feed to a starter motor that can draw up to several hundred amps.</p>&#13;
<p class="indent">The high-current switch—which could also be considered a relay—is made of the three pieces of copper bus bar: a release bar, a solenoid, and a release lever. When the pieces of copper bus bar are connected, the battery is connected to its circuit as normal. When the solenoid is pulled in, the power is disconnected.</p>&#13;
<p class="indent">The sensor circuit uses the power of the Arduino microcontroller. The Arduino continually monitors the battery, and if it senses that the power is diminishing, it calls for the high-current switch (relay) to be thrown. There are many ways to determine when a battery is reaching exhaustion, and this project simply looks at the voltage left in the battery. <a href="ch06.xhtml#ch06tab1">Table 6-1</a> shows the voltage versus the remaining charge in a standard 12V, lead-acid storage battery.</p>&#13;
<p class="tabcaption"><span epub:type="pagebreak" id="page_163"/><a id="ch06tab1"/><strong>Table 6-1:</strong> Battery Charge State Versus Voltage</p>&#13;
<table class="topbot">&#13;
<thead>&#13;
<tr>&#13;
<td class="table_th" style="vertical-align: top;"><p class="table"><strong>Battery charge level</strong></p></td>&#13;
<td class="table_th" style="vertical-align: top;"><p class="table"><strong>Battery voltage</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td class="table" style="vertical-align: top;"><p class="table">100%</p></td>&#13;
<td class="table" style="vertical-align: top;"><p class="table">12.7V</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table" style="vertical-align: top;"><p class="table">90%</p></td>&#13;
<td class="table" style="vertical-align: top;"><p class="table">12.5V</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table" style="vertical-align: top;"><p class="table">80%</p></td>&#13;
<td class="table" style="vertical-align: top;"><p class="table">12.4V</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table" style="vertical-align: top;"><p class="table">70%</p></td>&#13;
<td class="table" style="vertical-align: top;"><p class="table">12.3V</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="tableb" style="vertical-align: top;"><p class="table">60%</p></td>&#13;
<td class="tableb" style="vertical-align: top;"><p class="table">12.2V</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="tableb" style="vertical-align: top;"><p class="table">50%</p></td>&#13;
<td class="tableb" style="vertical-align: top;"><p class="table">12.1V</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="tableb" style="vertical-align: top;"><p class="table">40%</p></td>&#13;
<td class="tableb" style="vertical-align: top;"><p class="table">11.9V</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table" style="vertical-align: top;"><p class="table">30%</p></td>&#13;
<td class="table" style="vertical-align: top;"><p class="table">11.8V</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table" style="vertical-align: top;"><p class="table">20%</p></td>&#13;
<td class="table" style="vertical-align: top;"><p class="table">11.6V</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table" style="vertical-align: top;"><p class="table">&lt;10%</p></td>&#13;
<td class="table" style="vertical-align: top;"><p class="table">11.3V</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent">The battery charge level quickly deteriorates with only a minimal reduction in voltage. In order to have at least 40 to 50 percent of the charge remaining, the drain on the battery must be stopped somewhere between 11.9V and 12.2V (shaded in <a href="ch06.xhtml#ch06tab1">Table 6-1</a>), a voltage I will refer to from now on as the <em>trigger point</em>. In practical applications, empirical evidence shows that there is still plenty of juice left, even when battery voltage drops to 12.0V, 11.90V, or even below. A battery in good condition under ideal circumstances could perform with perhaps as little as 30 percent of its capacity, but that would depend on the load, ambient temperature, and other factors, so I’m taking a very conservative view of about 12+V. Newer design batteries tend to do better.</p>&#13;
<p class="indent">While the state of charge is a good indication of remaining capacity in a battery, other factors—like internal resistance, battery discharge rate, and so on—could impact the usable state of charge remaining in a battery. A more accurate measurement of the capacity remaining in a fully charged battery might be current used, which can be calculated if the total energy in the battery is known. For example, if a battery has a capacity of 1,100 ampere-hours (A·h), you could calculate the point where 550 A·h remain and disconnect the battery then. However, because this project targets systems with batteries that range widely in capacity, I decided that measuring the battery voltage would be more than adequate.</p>&#13;
<h4 class="h4" id="ch06lev2sec2"><em><strong>Arduino to the Rescue</strong></em></h4>&#13;
<p class="noindent">The Arduino microcontroller steps up to the task of measuring the battery voltage and throwing the disconnect switch at the appropriate voltage, but if that’s all it did, you could be in trouble. When turning on a vehicle, the starting motor uses a lot of current. Depending on the state of the battery (internal resistance and so on) and ambient conditions (temperature, for <span epub:type="pagebreak" id="page_164"/>example) during the cranking process, the battery voltage can conceivably fall well below the critical shut-off voltage. The Battery Saver depends on the Arduino to give the vehicle enough time to start the motor.</p>&#13;
<p class="indent">Further, should the system shut down due to an inadvertent drain, you’ll need to ensure that when the Battery Saver is reset, it doesn’t immediately sense a critical battery voltage and shut down again. All of these functions are handled by the microcontroller, under orders from the sketch. While there are probably several different ways of handling it, the sketch implements <em>timing sequences</em>—rules to follow for when to take certain actions—to allow for the voltage drop during engine cranking. Similar timing rules give the user time to restart the engine after the Battery Saver is reset.</p>&#13;
<h3 class="h3" id="ch06lev1sec6"><strong>The Breadboard</strong></h3>&#13;
<p class="noindent">Even though this project doesn’t require a lot of extra components and peripheral equipment, I still believe it’s useful to go through the exercise of wiring a breadboard. A working prototype gives a definitive proof of concept, and it allows you to play with the hardware and software prior to committing to the finished version. When working with the breadboard, I tested the circuit with a solenoid similar to the one used in the finished product (see <a href="ch06.xhtml#ch06fig7">Figure 6-7</a>).</p>&#13;
<div class="image"><img alt="image" src="../images/f06-07.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig7"/><em>Figure 6-7: The breadboard I used to test the Battery Saver concept and put the software together. Testing your circuit with a solenoid is not required</em>.</p>&#13;
<p class="indent"><a href="ch06.xhtml#ch06fig8">Figure 6-8</a> shows the breadboard operating the high-current switch; “<a href="ch06.xhtml#ch06lev1sec9">Construction</a>” on <a href="ch06.xhtml#page_170">page 170</a> describes how to build that switch. To test the circuit without making the high-current switch first, or to use a solenoid by <span epub:type="pagebreak" id="page_165"/>itself (see <a href="ch06.xhtml#ch06fig7">Figure 6-7</a>), you can connect a lamp, LED, relay, or some other component in place of the switch. Remember: if you use an LED or other polarized device, make certain to get the polarity correct.</p>&#13;
<div class="image"><img alt="image" src="../images/f06-08.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig8"/><em>Figure 6-8: The breadboard circuit operating the solenoid after the high-current switch has been assembled. Note the use of clip leads to hook up the Battery Saver to the breadboard. Diodes D1 and D2 and capacitors C1 and C2 were not included in the breadboard primarily because they are needed only when the project is in use</em>.</p>&#13;
<p class="indentb">The basic breadboard is fairly straightforward. Just follow these instructions to assemble it:</p>&#13;
<ol>&#13;
<li><p class="noindent">Connect the breadboard’s red positive rails together, and connect the blue negative rails together. Do not connect the positive rails to the negative rails as that will result in a direct short circuit.</p></li>&#13;
<li><p class="noindent">Insert the LM7805 voltage regulator so that the three terminals span three different rows. (See “<a href="ch06.xhtml#ch06lev1sec5">The Schematic</a>” on <a href="ch06.xhtml#page_160">page 160</a> for why an external voltage regulator was used rather than the Pro Mini’s onboard regulator.)</p></li>&#13;
<li><p class="noindent">Connect the input of the regulator to a positive 12V source. (See <a href="ch06.xhtml#ch06fig9">Figure 6-9</a> for the pinout of the LM7805.)</p>&#13;
<div class="image"><img alt="image" src="../images/f06-09.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig9"/><em>Figure 6-9: Pinout of the LM7805 regulator</em></p></li>&#13;
<li><p class="noindent"><span epub:type="pagebreak" id="page_166"/>Connect the center pin of the regulator to blue negative rail and the output pin to the red positive rail. When you power the circuit, the positive rail should have 5V coming from the output of the regulator.</p></li>&#13;
<li><p class="noindent">Insert the Pro Mini microcontroller board in the breadboard. Its position is not critical; anywhere in the general vicinity of where it is in <a href="ch06.xhtml#ch06fig7">Figure 6-7</a> is fine.</p></li>&#13;
<li><p class="noindent">Insert resistors R1 (10 kilohm) and R2 (5.6 kilohm) into the breadboard. It’s easiest to insert them near the regulator. Then, connect one side of R1 directly to the regulator (input pin). The joining point of R1 and R2 should be located in an independent place on the board, and the other side of R2 goes directly to ground.</p></li>&#13;
<li><p class="noindent">Connect a jumper from the point where R1 and R2 join to pin A0 of the Pro Mini.</p></li>&#13;
<li><p class="noindent">Insert transistor Q1 (ZTX649) into the breadboard in an area with three open rows (see <a href="ch06.xhtml#ch06fig10">Figure 6-10</a> for the pinout).</p></li>&#13;
<li><p class="noindent">Connect resistor R3 from the base of Q1 to pin D9 of the Pro Mini.</p></li>&#13;
<li><p class="noindent">Connect the emitter of Q1 to ground.</p></li>&#13;
<li><p class="noindent">Connect the collector of Q1 to the load (solenoid or other).</p></li>&#13;
<li><p class="noindent">Connect the other side of the load to positive 12V.</p></li>&#13;
<li><p class="noindent">Insert transistor Q2 into the breadboard. Connect its collector to one of the red positive rails.</p></li>&#13;
<li><p class="noindent">Connect the base of Q2 to pin D12 of the Pro Mini.</p></li>&#13;
<li><p class="noindent">Connect the emitter of Q2 to the positive side of LED1.</p></li>&#13;
<li><p class="noindent">Connect the negative side of LED1 to R4 (470 ohms).</p></li>&#13;
<li><p class="noindent">Connect the other end of R4 directly to the blue negative rail.</p></li>&#13;
<li><p class="noindent">Connect the negative side of the 12V supply to the blue negative rail.</p></li>&#13;
</ol>&#13;
<p class="indent">Now, load the sketch onto the Pro Mini (see “<a href="ch00.xhtml#ch00lev2sec4">Connecting and Programming an Arduino Pro Mini</a>” on <a href="ch00.xhtml#page_8">page 8</a>), and take it for a test run. If you have a variable power supply with a voltage readout, setting the voltage will be easy; if you don’t have a variable power supply, I suggest building the Regulated Power Supply in <a href="ch03.xhtml#ch03">Chapter 3</a>. If you use a variable supply without a readout, just use your multimeter to monitor the voltage and observe the trigger point.</p>&#13;
<p class="indent">Start the power supply at 13V (12.7V is normal for a charged 12V lead-acid storage battery), and the monitor LED should blink slowly. Gradually lower the voltage, and write down the voltage when the flashing goes from slow to rapid. That voltage is the trigger point, and it should be around 11.9V to 12V.</p>&#13;
<div class="image"><img alt="image" src="../images/f06-10.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig10"/><em>Figure 6-10: Pinout of the ZTX649 transistor</em></p>&#13;
<h3 class="h3" id="ch06lev1sec7"><span epub:type="pagebreak" id="page_167"/><strong>The Sketch</strong></h3>&#13;
<p class="noindent">In developing the Battery Saver sketch, I went through several iterations to assure reliable functionality. One difficulty was avoiding false triggers when the sensed voltage jumped around because an engine or an accessory, such as a hydraulic tilt, was activated.</p>&#13;
<p class="indent">I used functions to adjust various sequences of operation independent of the main program. This isn’t a complex sketch, but writing simple functions is a useful technique when you want to avoid repeating code. I could have avoided functions in the final sketch, but I let them remain because they work well, and writing the sketch this way provides a good lesson in the use of functions.</p>&#13;
<p class="programs">/*The Battery Saver sketch, which uses multiple functions<br/>  to create timing sequences */<br/><br/>int led = 12;<br/>int Battin = A0;<br/>int Relay = 9;<br/>int volts = 0;<br/>int volts2 = 0;<br/>int volts3 = 0;<br/>int B = 387;    //Threshold trigger set point<br/><br/>void timer3() { //Shut off timer function<br/>  delay(200);<br/>  volts = analogRead(Battin); //Reset trigger point<br/>  volts3 = map(volts, 0, 1023, 0, 500);<br/>  if(volts3 &gt; B) {<br/>    digitalWrite(Relay, LOW);<br/>  }<br/>  else {<br/>    digitalWrite(Relay, HIGH);<br/>  }<br/>}<br/><br/>void timer2() { //Fast blink timer function -- low voltage<br/>  if(volts2 &lt; B) {<br/>    for(int j = 1; j &lt; 1800; j++) {<br/>      digitalWrite(led, HIGH);<br/>      delay(10);<br/>      digitalWrite(led, LOW);<br/>      delay(90);<br/>    }<br/>  }<br/>}<br/><br/>void timer() { //First timer function -- high voltage<br/>  if(volts2 &gt; B) {<br/>    digitalWrite(led, HIGH);<br/>    delay(200);<br/><span epub:type="pagebreak" id="page_168"/>    digitalWrite(led, LOW);<br/>    delay(1000);<br/>  }<br/>}<br/>void setup() {<br/>  Serial.begin(9600);<br/>  pinMode(Relay, OUTPUT);<br/>}<br/>void loop() {<br/>  delay(1000);<br/>  volts = analogRead(Battin);<br/>  volts2 = map(volts, 0, 1023, 0, 500);<br/><br/>  timer();<br/>  if(volts2 &lt; B) { //Set trigger point<br/>    timer2();<br/>  }<br/>  if(volts2 &lt; B) {<br/>    timer3();<br/>  }<br/>}</p>&#13;
<p class="indent">In this sketch, <span class="literal">timer()</span>, <span class="literal">timer2()</span>, and <span class="literal">timer3()</span> are the three functions used. The <span class="literal">timer()</span> function is for normal operation when the battery voltage is above the trigger point. The trigger point is the voltage at which the Battery Saver goes into timeout mode prior to shutting down. The <span class="literal">timer2()</span> function sets off a rapid flashing sequence once the trip threshold is reached and provides the timing—the fast LED sequence—prior to shutoff. Once <span class="literal">timer2()</span> has finished, <span class="literal">timer3()</span> is invoked, provided the voltage remains below the threshold; this disconnects the battery by activating the solenoid. If the voltage increases above the trigger point at any time during the timeout period, the Battery Saver returns to normal operation after <span class="literal">timer3()</span> times out. Many of the variables in this sketch can also be changed to vary blinking and delay sequences and threshold; they’re addressed in “<a href="ch06.xhtml#ch06lev1sec11">Operating the Battery Saver</a>” on <a href="ch06.xhtml#page_180">page 180</a>.</p>&#13;
<h3 class="h3" id="ch06lev1sec8"><strong>The Shield</strong></h3>&#13;
<p class="noindent">As you might guess from the breadboard, the shield is straightforward, too. Compared with handwiring, however, I believe it’s a lot easier and faster.</p>&#13;
<h4 class="h4" id="ch06lev2sec3"><em><strong>The PCB Layout</strong></em></h4>&#13;
<p class="noindent"><a href="ch06.xhtml#ch06fig11">Figure 6-11</a> shows my finished PCB, and <a href="ch06.xhtml#ch06fig12">Figure 6-12</a> shows the layout image with silkscreen indicating the placement of the components. You can download a PCB layout for the shield at <em><a href="https://www.nostarch.com/arduinoplayground/">https://www.nostarch.com/arduinoplayground/</a></em>.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_169"/><img alt="image" src="../images/f06-11.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig11"/><em>Figure 6-11: The unpopulated Battery Saver board. The RLY connection is where you would connect the solenoid</em>.</p>&#13;
<div class="image"><img alt="image" src="../images/f06-12.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig12"/><em>Figure 6-12: The foil pattern for the shield on the Battery Saver. The silkscreen image is in gray</em>.</p>&#13;
<p class="indent">Most of the components are located under the Pro Mini to save space. Other than that, there is nothing special about populating the shield. As in other projects, it’s not necessary to include headers for all the Pro Mini pins. Use all the pins that have connections with board traces and enough other pins to add mechanical stability. I always try to use at least one header for the very first pin, to aid in aligning the board while plugging it in.</p>&#13;
<p class="indent">The LED can be mounted directly to the board or can be mounted somewhere remotely with long wires. Just be sure to observe polarity. The Battery Saver may be located in an area where the operator can’t see the LED, so placing it in a remote location is a practical solution.</p>&#13;
<h4 class="h4" id="ch06lev2sec4"><em><strong>Preparing the Shield and Pro Mini Controller</strong></em></h4>&#13;
<p class="noindent">If you want to use a PCB, you can make the shield according to the layout provided with this book’s resource files, whether you etch that yourself or send it off to be professionally manufactured. You could also design your own shield PCB if you’re feeling ambitious or just solder everything to the prototyping board, but if you are using everything else from the parts list, just make sure your board has the same dimensions as the provided shield layout.</p>&#13;
<p class="indent">If you etch the PCB design I provide, drill the component holes next. I usually use a #66 drill. Solder a 2-inch wire to the plus 12V side of the shield, and solder the other side of the wire to a small solder lug. Solder a 15-inch wire to the ground terminal and then connect two wires to the solenoid connections. I used a small inline connector—made with Pololu #1950 crimp connector housings, #1931 male crimp pins, and #1215 female crimp pins—so I could remove the board easily if necessary. Almost any connector can be used.</p>&#13;
<p class="indent">Both transistors are located under the shield, so when you solder them, make sure to push them down enough that they clear the bottom of the Pro Mini. See <a href="ch06.xhtml#ch06fig11">Figures 6-11</a> and <a href="ch06.xhtml#ch06fig12">6-12</a> for the transistor placement on the PCB.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_170"/>I soldered the monitor LED directly to the board so it could be seen through the enclosure. However, you could also solder wires to the board and place the monitor LED in a location where it might be more visible outside your vehicle.</p>&#13;
<h3 class="h3" id="ch06lev1sec9"><strong>Construction</strong></h3>&#13;
<p class="noindent">Building the rest of the Battery Saver involves a few mechanical challenges and requires the wits of a scavenger. <a href="ch06.xhtml#ch06fig13">Figure 6-13</a> shows all the parts of the Battery Saver laid out. There is nothing complex about any of the parts.</p>&#13;
<div class="image"><img alt="image" src="../images/f06-13.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig13"/><em>Figure 6-13: The components of the Battery Saver, completely disassembled. The cover of the enclosure is under the clear box. Note the short screws for fastening the spacer to the solenoid, so they don’t damage the solenoid coil</em>.</p>&#13;
<p class="indent">There are only a handful of components in the Battery Saver: the enclosure, the phenolic contact support, the shield and Pro Mini controller, the copper contact assembly, the solenoid and mounting, the release lever and pylon, the release rod, and the springs and e-clip. The assembly instructions that follow are a little involved, but if you get stuck, just use <a href="ch06.xhtml#ch06fig13">Figure 6-13</a> to keep things in perspective. When you’re done, the Battery Saver should look like <a href="ch06.xhtml#ch06fig14">Figure 6-14</a>.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_171"/><img alt="image" src="../images/f06-14.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig14"/><em>Figure 6-14: The completed Battery Saver with the cover off and the switch in the operating position. In this iteration, grooves were carved in the phenolic block for the positive and ground wires</em>.</p>&#13;
<h4 class="h4" id="ch06lev2sec5"><em><strong>Preparing the Enclosure</strong></em></h4>&#13;
<p class="noindent">Because the enclosure, a Hammond 1591 STCL, is an integral part of the design, I suggest starting there. Beyond a couple of holes and slots machined into the enclosure, there is very little else to do. <a href="ch06.xhtml#ch06fig15">Figure 6-15</a> shows the holes I cut in detail; a template is included in this project’s resource files. There are only a few holes to cut, though, so you should be fine without the template if you follow these instructions carefully.</p>&#13;
<p class="indent">On the long sides of the enclosure, measure approximately 1 1/8 inches from the top—that is the side where the reset plunger will protrude through. This should locate you roughly at the fourth mounting rib. In the center of that rib, drill two #30—approximately 1/8-inch—holes 3/8 inches from either edge, and countersink both for a 4-40 screw. Do this on both sides of the enclosure.</p>&#13;
<p class="indent">On each side, at the top of the next rib (going toward the top of the enclosure), cut a 1-inch-deep groove for the copper contact assembly. The shaded part of the side view in <a href="ch06.xhtml#ch06fig15">Figure 6-15</a> shows where the groove should go on each side. The ABS plastic enclosure cuts easily with a hacksaw. Remove the cover and cut from the opening of the enclosure toward the back. For each groove, make two cuts so that when you remove the material between them, you will have a 3/16-inch-wide channel in both sides of the enclosure. A little over 1 inch from the edge at the opening will do, but it’s not necessary to cut down to the back of the enclosure. You can even cut both sides at once, but just make sure the channels are directly opposite each other. Don’t worry <span epub:type="pagebreak" id="page_172"/>if your cuts are a little off; that can be corrected later with a file. After you make the cuts, break off the material in the center and clean up the channel with a small triangle or flat file.</p>&#13;
<div class="image"><img alt="image" src="../images/f06-15.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig15"/><em>Figure 6-15: The holes and slot in the Battery Saver enclosure</em></p>&#13;
<p class="indent">Now, drill a 1/4-inch hole in the top of the enclosure, where the reset button will go, exactly centered on the top surface. Draw lines along that side’s diagonals from corner to corner, as illustrated in <a href="ch06.xhtml#ch06fig15">Figure 6-15</a>, and drill where the lines intersect. This hole is where the brass release rod for the reset plunger will go.</p>&#13;
<h4 class="h4" id="ch06lev2sec6"><em><strong>The Contact Support</strong></em></h4>&#13;
<p class="noindent">The contact support is perhaps the easiest part to make. First, cut the phenolic sheet to a 3×1 3/8–inch block. The phenolic material cuts easily with a hacksaw. Insert the block in the enclosure so the two holes you drilled through the ribs are in the center of the block. Mark the holes on both sides, drill them with a #43 drill bit, and tap them for a 4-40 screw. While you are working on the phenolic contact support, you can cut two grooves, or channels, for the power and ground wires on either side (shown later in <a href="ch06.xhtml#ch06fig18">Figure 6-18</a>). The location is not critical as these are used only to run the positive and negative wires for the shield. I used the small Dremel tool in <span epub:type="pagebreak" id="page_173"/><a href="ch06.xhtml#ch06fig16">Figure 6-16</a> to cut the grooves. Use two 4-40×3/8-inch flathead screws on each side to screw the phenolic piece in place.</p>&#13;
<div class="image"><img alt="image" src="../images/f06-16.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig16"/><em>Figure 6-16: Dremel tool with small circular saw blade attached</em></p>&#13;
<p class="indent">With the phenolic contact support screwed in place, hold the drill as close to vertical as possible in the center of the largest face of the contact block. Drill a 1/4-inch hole that lines up with the 1/4-inch hole you previously drilled in the top of the enclosure. The easiest way to do this is to mount the contact support block and then use the hole in the top of the enclosure as a guide to drill the hole in the block. After drilling, put the contact support aside until you’re ready for the copper contact assembly.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="bgblack">NOTE</span></strong></p>&#13;
<p class="notep"><em>The enclosure is not a perfect rectangle because some relief is included to allow it to come out of the mold easily. Factor this in as you line up to drill the center hole. When I drilled the hole, I held the enclosure in a vise to eliminate the effect of the relief</em>.</p>&#13;
</div>&#13;
<h4 class="h4" id="ch06lev2sec7"><em><strong>Preparing the Copper Contact Assembly</strong></em></h4>&#13;
<p class="noindent">The copper contact assembly requires only a handful of holes. Cut a 4 3/4-inch section of the 3/16×3/4–inch copper bar, and drill the holes along the center of the 3/4-inch dimension, as outlined in <a href="ch06.xhtml#ch06fig17">Figure 6-17</a>.</p>&#13;
<div class="image"><img alt="image" src="../images/f06-17.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig17"/><em>Figure 6-17: The base of the copper contact assembly, showing holes and spacing</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_174"/>For holes A and G, use a 9/32-inch bit. Holes B, C, E, and F should be drilled with a #30 bit; make sure to countersink them deeply enough for a 4-40 flathead screw. Finally, drill hole D with a 1/2-inch bit. Tap holes A and G for a 5/16×18×3/4–inch bolt, which will hold the battery cables.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="bgblack">CAUTION</span></strong></p>&#13;
<p class="notep"><em>While copper is not hard, it tends to grab a drill bit and climb up the bit. Always hold the copper piece in a vise, in a clamp, or with pliers when drilling. Never attempt to hold the copper with unprotected hands</em>.</p>&#13;
</div>&#13;
<p class="indent">When all seven holes are drilled, set the base of the copper contact on the phenolic contact support so that the 1/2-inch center hole in the copper is centered as closely as possible on the 1/4-inch center hole in the phenolic support and the bar is centered along the entire length of the contact support. Make sure the bar is equidistant from both sides of the support, hold the two pieces together firmly, and mark holes B, C, E, and F. Center punch the marks you just made in the contact support, drill them with a #43 drill, tap them for a 4-40 screw, and set the contact support aside again.</p>&#13;
<p class="indent">Now, mark the exact center of the copper contact, which should perfectly bisect the 1/2-inch hole. Cut the piece in two at this marker; a hacksaw should work well for this. Then, cut a 3/4×3/4–inch square of your leftover 3/16×3/4–inch copper bar, and mark the center by making diagonal lines from corner to corner. Center punch and drill a 1/4-inch hole where those lines intersect. This copper square will become the actual contact.</p>&#13;
<p class="indent">The final hole to make in the copper contact assembly is somewhere between holes E and F, on the outer edge of the bar; look for the little screw sticking out of the contact bar in <a href="ch06.xhtml#ch06fig18">Figure 6-18</a> (circled). Drill a #43 hole and tap for a 4-40 screw. This is where the switched positive voltage to the Pro Mini comes from. <a href="ch06.xhtml#ch06fig18">Figure 6-18</a> shows all the contact and mounting hardware drilled.</p>&#13;
<div class="image"><img alt="image" src="../images/f06-18.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig18"/><em>Figure 6-18: The contact and support hardware ready for assembly</em></p>&#13;
<h4 class="h4" id="ch06lev2sec8"><span epub:type="pagebreak" id="page_175"/><em><strong>Mounting Supplies for the Solenoid</strong></em></h4>&#13;
<p class="noindent">Depending on your solenoid, the mounting process may vary slightly from the one described here. The frame of the solenoid I used had two holes tapped for a 4-40 screw in the bottom. However, there was precious little room between the frame and the coil, so I elected to look for an alternative mounting approach—a very aggressive double-sided adhesive. If you still want to mount the solenoid with screws, judge the screw length carefully. With either mounting approach, the solenoid was not high enough to line up with the release mechanism, so I had to add a platform.</p>&#13;
<h4 class="h4" id="ch06lev2sec9"><em><strong>Preparing the Release Rod, Springs, and E-Clip</strong></em></h4>&#13;
<p class="noindent">As with the other mechanical components of the Battery Saver, the release rod to reset the contacts just needs a little TLC. Begin with a section of 1/4-inch brass rod, and cut it to 4 1/4 inches in length. Measure 1 1/8 inches down from one end, and make a groove for the spring retaining clip to fit into, as shown in <a href="ch06.xhtml#ch06fig19">Figure 6-19</a>.</p>&#13;
<p class="indent">In order to cut the groove, I mounted the bar in the chuck of an electric drill that I clamped to my workbench and used a hacksaw blade to carefully groove the piece, guiding the hacksaw blade with my fingers. The set on the hacksaw blade is a little wide, but the depth of the groove, not the width, is the important part. That said, the groove doesn’t have to be very deep. I recommend you cut the groove in small increments and keep trying the retaining clip until it fits snuggly.</p>&#13;
<p class="indent"><a href="ch06.xhtml#ch06fig19">Figure 6-19</a> also shows the configuration of the springs. The bottommost spring will rest on the phenolic block and keep the copper contact off the contact areas until the release rod is depressed. It should be small enough that it does not touch either side of the copper contacts. (Remember, the hole in the square contact is 1/2-inch wide, so the spring needs to be smaller than that.) When depressed, the top spring overrides the lower spring and keeps the upper part of the switch in firm contact with the lower sections. You can make fine adjustments of the spring length on a small grinder, or you can use a Dremel tool or a hand whetstone.</p>&#13;
<div class="image"><img alt="image" src="../images/f06-19.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig19"/><em>Figure 6-19: The upper section of the release bar. There are two grooves in the bar; the lower one was made in error. The springs used on the release rod were selected from a standard spring assortment from Ace Hardware and cut down to fit the project</em></p>&#13;
<p class="indent">Now, measure 4 inches from the same end, and file the release groove in the lower half of the 1/4-inch release bar using a small needle file. <span epub:type="pagebreak" id="page_176"/><a href="ch06.xhtml#ch06fig20">Figure 6-20</a> shows both the needle file used and the shape of the release groove. (You might want to use a hacksaw first to make the groove, and shape the upper side with a file.)</p>&#13;
<div class="image"><img alt="image" src="../images/f06-20.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig20"/><em>Figure 6-20: A close up of the release groove in the bottom of the release rod (top) and the small needle file used to make the groove (bottom)</em></p>&#13;
<p class="indent">The shape of the release groove is not overly critical, but make sure there is a slight bevel on the top side. The swirls you see on the shaft were made with 400-grit sandpaper I used to smooth the rod so it slides smoothly through the phenolic block and hole in the case and contact piece.</p>&#13;
<h4 class="h4" id="ch06lev2sec10"><em><strong>Making the Release Lever and Pylon</strong></em></h4>&#13;
<p class="noindent">The release lever is made of a small piece of light-gauge steel sheet metal, approximately 0.060 inches thick. Use the pattern in <a href="ch06.xhtml#ch06fig21">Figure 6-21</a> to cut the lever. In this book’s online resource files, you can find a PDF file of the lever template. Because the template is pretty small, you might try bonding the template to a blank piece of similarly sized stock, holding it in a pair of pliers (vise grips work well), and shaping the piece on a grindstone. Once you’ve bonded the template to the stock, you can also use a file to shape it.</p>&#13;
<div class="image"><img alt="image" src="../images/f06-21.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig21"/><em>Figure 6-21: The release lever template</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_177"/>With a pair of tin snips, I cut a rectangle first and then cut the shape of the release lever. I firmly clamped the piece in place with a vise so I could finish shaping it with a file. Mild steel files easily with a satisfying feel. (You could also shape the lever with a small grinding wheel or a Dremel tool with an abrasive wheel.) Make the piece a little oversized at first, as indicated in the template, as it may require some adjustment in the final assembly. The lever should be under pressure from the tension spring, and should securely hold the release rod so that the square copper piece is firmly in contact with the both sides of the bottom copper contact assembly. Both pivot holes in the lever—one to attach to the solenoid and one to attach to the release pylon—are drilled with a #30 drill.</p>&#13;
<p class="indent">The pylon is for mounting the release lever to the enclosure, and it can be made of any scrap brass or aluminum you may have around. The pylon in <a href="ch06.xhtml#ch06fig22">Figure 6-22</a> was made from a 3/8-inch diameter brass rod. I reduced the top section’s diameter because I didn’t want the pylon to rub on the release rod, but that probably was not necessary.</p>&#13;
<div class="image"><img alt="image" src="../images/f06-22.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig22"/><em>Figure 6-22: The release lever, the pylon, and two screws</em></p>&#13;
<p class="indent">Cut the pylon to about 0.61 inches long so that when mounted inside the enclosure, the end attached to the release lever hits the release rod just below the center of its diameter. This dimension is dependent on how precisely the release rod hole is drilled into the center of the top of the enclosure. Run the release rod through the hole, and measure how far from the back of the enclosure its center is. The pylon should be a little shorter than that.</p>&#13;
<p class="indent">You can make the top of the pylon smaller by chucking it into a drill like a bit and spinning it on a file. When you finally assemble the Battery Saver, you may also have to adjust the height of the pylon slightly to accommodate the thickness of the release lever and altitude of the release rod if the hole was not drilled perfectly straight.</p>&#13;
<p class="indent">Drill a #43-sized hole near the center of the pylon all the way through, and tap for a 4-40 screw from both sides. One side will mount to the back of the enclosure, and the other will hold the release lever. To make sure the screw doesn’t go down too far and tighten against the release lever, I tapped down only about 3/16 inches so the screw bottomed out and jammed. <a href="ch06.xhtml#ch06fig23">Figure 6-23</a> illustrates what the tapped pylon should look like.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_178"/><img alt="image" src="../images/f06-23.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig23"/><em>Figure 6-23: Inside the pylon</em></p>&#13;
<p class="indent">You can adjust either the length of the tapped hole or the length of the screw to make sure the release lever is free to move but secure, using the screw head as a bearing surface. For fastening both the release-lever bearing screw and the pylon mounting screw, I recommend using an anaerobic adhesive (such as Loctite Threadlocker) to secure the threads.</p>&#13;
<h4 class="h4" id="ch06lev2sec11"><em><strong>Assembling All the Parts</strong></em></h4>&#13;
<p class="noindent">Now, we’re ready to start putting all the parts from <a href="ch06.xhtml#ch06fig13">Figure 6-13</a> together and fastening them where they belong. The order of assembly is not overly critical, but more a matter of common sense. I’ll go through it step-by-step:</p>&#13;
<ol>&#13;
<li><p class="noindent">Start by screwing the copper contact pieces into the phenolic support. Make sure the screw heads are below the surface of the copper. This is critical to assure good contact with the contact bar. Prior to assembly, as an added measure to improve the contact area, I sanded both the contact pieces and contact cap with a 400-grit sandpaper. To assure flatness, I put the sandpaper on a flat surface and rubbed the copper on it.</p></li>&#13;
<li><p class="noindent">Slide the phenolic support into the enclosure, and fasten it with the four 4-40×1/2-inch screws.</p></li>&#13;
<li><p class="noindent">Insert the release rod through the enclosure, and then thread it through the pressure spring, then through the copper contact, and finally through the release spring and down through the phenolic base. Insert the e-clip. This may be a little tricky. You’ll have to hold the clip with a pair of needle-nose pliers.</p></li>&#13;
<li><p class="noindent">Measure for the location of the pylon, and mount it to the enclosure with a 4-40×1/2-inch flathead screw. The pylon should be inside the enclosure, and the screw should be threaded in from the outside.</p></li>&#13;
<li><p class="noindent"><span epub:type="pagebreak" id="page_179"/>Screw the release lever to the pylon, and check by hand that it engages the release groove and secures the release rod. This is a little tricky, and you may have to adjust the release lever by grinding or filing it a little to fit in the release rod’s groove. Once you have the lever in place, you can operate it with your fingers and assure that it locks tightly to the release-rod groove.</p></li>&#13;
<li><p class="noindent">Install the spacer on the solenoid.</p></li>&#13;
<li><p class="noindent">Temporarily mount the solenoid to the enclosure, and screw the release lever to the solenoid. To do this, I first unfastened the release lever from the pylon and fastened the other end to the solenoid plunger. I then applied double-sided tape to the bottom of the spacer, juggled everything in place, and loosely placed the screw through the release lever and into the pylon.</p></li>&#13;
<li><p class="noindent">Exercise the release mechanism with the solenoid held in place. Once the release rod holds the top switch contact firmly down, mark the holes for the solenoid spacer.</p></li>&#13;
<li><p class="noindent">Drill and tap holes in the enclosure to securely mount the solenoid and spacer to the enclosure. Alternatively, fasten the solenoid with double-sided adhesive, such as 3M outdoor double-sided adhesive.</p></li>&#13;
<li><p class="noindent">Run the wires that will connect the solenoid to the Pro Mini circuit under the release rod, and connect them to the solenoid using the connectors.</p></li>&#13;
<li><p class="noindent">Run the ground wire from the Pro Mini circuit under the release rod and out through the slotted opening for the copper bar. (It’s the dark wire sticking out of the enclosure on the left in <a href="ch06.xhtml#ch06fig14">Figure 6-14</a>.) You may want to either drill small holes in the phenolic for the wires or carve small grooves to run the wire through, using a Dremel tool and a small circular saw blade like the one shown in <a href="ch06.xhtml#ch06fig16">Figure 6-16</a>. You can also make a groove with a file or hacksaw.</p></li>&#13;
<li><p class="noindent">Attach the red positive voltage wire with the lug to the copper switch pole at the last hole you tapped in “<a href="ch06.xhtml#ch06lev2sec7">Preparing the Copper Contact Assembly</a>” on <a href="ch06.xhtml#page_173">page 173</a>. Use a 4-40×3/8-inch roundhead screw.</p></li>&#13;
<li><p class="noindent">Mount the shield using small spacers. If you can’t find a solder lug, you can solder-tin the wire, form it so it fits around the screw snugly, and then tighten the screw.</p></li>&#13;
</ol>&#13;
<p class="indent">Compare your Battery Saver to the finished device in <a href="ch06.xhtml#ch06fig14">Figure 6-14</a> to make sure everything looks right. When the battery voltage reaches the trigger point, the Arduino triggers the solenoid, which releases the lever. Freed from the release lever, the rod pops up from the spring tension of the lower spring. The lower spring holds the contact piece above the copper mounted to the phenolic block, opening the circuit. To reset the Battery Saver, just push the rod back down again. Before doing a final test, check the latching of the release lever and rod several times.</p>&#13;
<h3 class="h3" id="ch06lev1sec10"><span epub:type="pagebreak" id="page_180"/><strong>Installing the Battery Saver into a Vehicle</strong></h3>&#13;
<p class="noindent">Connecting your Battery Saver to your vehicle takes only minutes. First, disconnect both the positive and negative terminals from your battery. Then, connect a short battery cable from the positive side of the battery to the input side of the Battery Saver. Take the output side of the Battery Saver and connect it to the cable that originally connected to the battery. Connect the black wire to the negative terminal that will be reconnected to the battery.</p>&#13;
<p class="indent">Mounting the entire enclosure will depend on where and how your vehicle’s battery and/or battery box are located. In many cases, the Battery Saver can simply hang from the battery cables. In other applications, I’ve used a heavy-duty cable tie to wrap around the entire battery and Battery Saver to hold it in place. In some cases, double-sided Velcro works well.</p>&#13;
<h3 class="h3" id="ch06lev1sec11"><strong>Operating the Battery Saver</strong></h3>&#13;
<p class="noindent">In operation, once the Battery Saver is installed (see <a href="ch06.xhtml#ch06fig24">Figure 6-24</a>), restore the ground connection to the battery and hook that ground connection to the Battery Saver. Then, set the Battery Saver by depressing the reset button—that is, the top of the release bar—until the unit is armed. You should hear or feel a click as you depress the reset button and the release lever engages.</p>&#13;
<div class="image"><img alt="image" src="../images/f06-24.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig24"/><em>Figure 6-24: The Battery Saver installed in my Boston Whaler runabout. The battery hooks up to the battery post and to the positive connection for the motor and accesssories. The ground lead of the battery was fed through the back of the battery box. The reset plunger is readily accessible</em>.</p>&#13;
<h4 class="h4" id="ch06lev2sec12"><em><strong>Normal Operation</strong></em></h4>&#13;
<p class="noindent">As long as the battery is fully charged and above the threshold voltage, the “on” indicator will blink at the rate established in the <span class="literal">timer()</span> function, which is approximately once every 2.2 seconds. When the battery voltage drops below the threshold level, which is set at approximately 11.9V via <span epub:type="pagebreak" id="page_181"/>variable <span class="literal">B</span> in the sketch, the indicator LED begins flashing rapidly. When the LED sequence finishes, which is after about 3 minutes, the voltage will be checked once again. If the voltage is still below the threshold, the battery is disconnected; otherwise, it just returns to normal operation.</p>&#13;
<p class="indent">When you reset the Battery Saver after it has shut off, it will resume operation. After reset, if the battery voltage is above the threshold, the indicator will blink at the usual rate of once every 2.2 seconds. Often when the drain is removed from a battery discharged to some level, the battery recovers somewhat on its own after a relatively short time. If, however, the voltage is below the threshold level, the indicator will blink rapidly for the timeout period, as indicated earlier, to allow for the operator to start the boat, tractor, or other vehicle. You can set the timeout period by changing the value of <span class="literal">j</span> in the <span class="literal">timer2()</span> function.</p>&#13;
<p class="indent">The maximum value of the <span class="literal">j</span> variable is set at 1,800 in the initial sketch, and incrementing or decrementing <span class="literal">j</span> will add or subtract 100 milliseconds from the total timeout period. Thus, to set the timeout period to 5 minutes, you would set the maximum value of <span class="literal">j</span> to 3,000.</p>&#13;
<h4 class="h4" id="ch06lev2sec13"><em><strong>Setting the Threshold Voltage</strong></em></h4>&#13;
<p class="noindent">The threshold voltage is established by resistors R1 and R2 with values of 10,000 and 5,600 ohms, respectively (see the schematic in <a href="ch06.xhtml#ch06fig6">Figure 6-6</a>). These are set up as a voltage divider. According to the voltage divider calculation, whether you use a calculator or work it out with the formula, the voltage will be approximately 4.31V for a 12V input. Thus, you can calculate the exact threshold voltage at which you want the device to shut off the battery current by setting the threshold trigger point, which is <span class="literal">B</span> in the sketch, to whatever value you wish. While I calculated the theoretical value of the threshold, I experimented and found that a value of 387 establishes the shutoff threshold point at about 11.9V.</p>&#13;
<div class="box1">&#13;
<p class="boxtitle"><strong>ON BATTERY TYPES</strong></p>&#13;
<p class="noindent">I experimented with several batteries and loads and found setting <span class="literal">B</span> to 387 consistently leaves at least half the energy in the battery after shutdown to restart the engine. On several different batteries, ranging from the small battery on a portable generator to large-capacity batteries for starting a truck, the same value seemed to work well.</p>&#13;
<p class="indent">That said, I have little experience with deep-cycle batteries and know that they have very different discharge parameters. If you want to attempt to use the Battery Saver for such batteries, take a look at their discharge rates and voltages, and set the threshold accordingly.</p>&#13;
</div>&#13;
<h4 class="h4" id="ch06lev2sec14"><span epub:type="pagebreak" id="page_182"/><em><strong>Protection from the Environment</strong></em></h4>&#13;
<p class="noindent">Unfortunately, the Battery Saver is not weatherproof, and most applications call for it to be used in somewhat hostile environments. There are, however, a couple of possible solutions. On a variety of vehicles, including boats and tractors, I have wrapped the device in a plastic bag and tightly wrapped wire ties around the cables where they enter and exit the device.</p>&#13;
<p class="indent">But that’s not terribly attractive, and I took some abuse from the distaff side of the family, so I applied Permatex silicon RTV sealant around all the openings where the copper bar comes through—but not where the reset (brass) rod comes through—and sealed all the screws.</p>&#13;
<p class="indent">For the reset button, I had difficulty finding a protective covering nipple (you would be surprised at what I found on the web), so I settled for affixing the top of an eye dropper to the enclosure with the silicone sealant. This also keeps the reset bar—which is hot to 12V when depressed—from shorting out.</p>&#13;
<h4 class="h4" id="ch06lev2sec15"><em><strong>Applying Cool Amp</strong></em></h4>&#13;
<p class="noindent">While the copper-on-copper contacts work well, I burnished them with very fine sandpaper (400 grit) before assembly. Even though the untreated contacts have been used on a number of versions of the Battery Saver and have never failed, I decided to use Cool Amp, a simple-to-use silver-plating compound, for this version.</p>&#13;
<p class="indent">For very little cost, I was able to silver-plate the contact area of the contact bar and plate and thus reduce their resistance. <a href="ch06.xhtml#ch06fig25">Figures 6-25</a> and <a href="ch06.xhtml#ch06fig26">6-26</a> show the difference between unplated and plated copper.</p>&#13;
<div class="image"><img alt="image" src="../images/f06-25.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig25"/><em>Figure 6-25: Battery Saver contacts after burnishing but before treatment with Cool Amp</em></p>&#13;
<div class="image"><img alt="image" src="../images/f06-26.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig26"/><em>Figure 6-26: Battery Saver contacts after silver plating with Cool Amp</em></p>&#13;
<p class="indent">While this additional lowering of resistance is probably not necessary, all the current for the vehicle passes through this contact, so I figured it wouldn’t hurt to be on the safe side. Further, I have used the Battery Saver in marine applications around saltwater, and the copper parts have acquired a green patina while the silver-plated areas have not.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_183"/>I have used Cool Amp on a number of contacts, from motor-starting contacts to heavy-duty relay contacts, and it works well. You can learn more about Cool Amp at <em><a href="http://www.coolamp.com/">http://www.coolamp.com/</a></em>.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="bgblack">NOTE</span></strong></p>&#13;
<p class="notep"><em>Copper does not oxidize too rapidly and the most common oxide of copper is highly conductive, which is one reason it is commonly used for current switching. Silver has the same properties—only better</em>.</p>&#13;
</div>&#13;
<div class="box1">&#13;
<p class="boxtitle"><strong>MY ORIGINAL IDEA</strong></p>&#13;
<p class="noindent">I hold a US patent (4,149,093, now expired) on a device similar to the Battery Saver. The patent drawing is shown in <a href="ch06.xhtml#ch06fig27">Figure 6-27</a>. Notice how similar it is to this project, despite being made decades earlier. It had essentially the same function, even though microcontrollers hadn’t been invented yet!</p>&#13;
<div class="image"><img alt="image" src="../images/f06-27.jpg"/></div>&#13;
<p class="figcap"><a id="ch06fig27"/><em>Figure 6-27: A patent drawing of the Battery Saver’s predecessor</em><span epub:type="pagebreak" id="page_184"/></p>&#13;
</div>&#13;
</body></html>