- en: '7'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '7'
- en: Access to Time
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 时间的掌控
- en: You should start your attack with no delay and not prematurely but perfectly
    on time.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该毫不拖延地开始行动，而不是过早开始，而是恰到好处的时机。
- en: If you are going to set fire to the enemy’s castle or camp, you need to prearrange
    the ignition time with your allies.
  id: totrans-3
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 如果你打算攻打敌人的城堡或营地，你需要与盟友事先安排好点火的时间。
- en: ''
  id: totrans-4
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '—Yoshimori Hyakushu #83'
  id: totrans-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '—百首义盛 #83'
- en: When shinobi were on a mission, particularly at night, one of their most crucial
    and complex duties was keeping track of time. If this task seems simple, remember
    that shinobi did not have watches or clocks. They didn’t even have sand hourglasses
    until the early 1600s.^([1](b01.xhtml#endnote-51)) To send and receive signals
    at the proper time, coordinate attacks, know when the enemy would be vulnerable,
    and more, shinobi had to develop methods to tell time reliably.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 当忍者执行任务时，特别是在夜间，其中一个最关键且复杂的任务就是掌握时间。如果这个任务看起来很简单，请记住，忍者当时没有手表或钟表。直到17世纪初，他们甚至没有沙漏。^([1](b01.xhtml#endnote-51))为了在适当的时间发送和接收信号、协调攻击、了解敌人何时最脆弱等等，忍者们必须发展出可靠的时间感知方法。
- en: Historically, one way to mark the hours involved lighting incense or candles
    known to burn at a constant rate, then ringing a bell at certain intervals to
    announce the time. *Bansenshūkai* recommends using environmental cues, such as
    the movement of the stars, or weight-based instruments to tell time.^([2](b01.xhtml#endnote-52))
    These weight-based instruments were likely water clocks, sometimes called *clepsydras*,
    that used balance and water flow/weight mechanisms to accurately signal time intervals.
    Other scrolls include more abstruse options, such as tracking the change in dilation
    of a cat’s iris throughout the day or the subtle thermal expansions of a dwelling
    during the night, as these align with particular hours.^([3](b01.xhtml#endnote-53))
    Shinobi were even taught to derive the hour by being mindful of which nostril
    they were more actively breathing through. The scrolls explain how breath comes
    prominently in and out of one nostril, then alternates to the other, in regular
    intervals that can be used to track time. While this idea might seem like pseudoscience,
    in 1895, German scientist Richard Kayser observed and documented that during the
    day, blood pools on different sides of a person’s nose, causing a noticeable reduction
    in airflow in one of the nostrils, before alternating to the other nostril.^([4](b01.xhtml#endnote-54))
    Not only did the shinobi’s acute observational skills identify this phenomenon
    more than 300 years before its scientific publication in the West, but they also
    developed a practical application for it. For example, they might need to lie
    down in the crawl space of a floor beneath their target, where they would be unable
    to light candles or incense, use instruments to track time, or even dare open
    their eyes should the glint from their eye catch the target’s attention through
    the cracks of the floor. Under these uncomfortable circumstances, they would lie
    still and pay attention to their nose breath until the time to attack came—a stellar
    example of the shinobi’s discipline, ingenuity, and creativity.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 历史上，一种标记时间的方法是点燃已知以恒定速度燃烧的香或蜡烛，然后在特定时间间隔敲响钟声以报时。*万川集海*建议使用环境线索，如星星的运动，或基于重量的仪器来标记时间。^([2](b01.xhtml#endnote-52))这些基于重量的仪器很可能是水钟，有时被称为*水漏*，利用平衡和水流/重量机制准确地标记时间间隔。其他卷轴中还包括一些更为复杂的选项，比如追踪猫眼睛虹膜的膨胀变化，或观察夜间房屋的微妙热胀冷缩，因为这些变化与特定的时间点相符合。^([3](b01.xhtml#endnote-53))
    忍者们甚至被教导通过观察哪只鼻孔更活跃来推算时间。这些卷轴解释了呼吸是如何先从一个鼻孔明显进出，然后在规则的时间间隔后转到另一个鼻孔的。虽然这个想法可能看起来像伪科学，但在1895年，德国科学家理查德·凯瑟观察并记录到，在白天，血液会在人的鼻子两侧积聚，导致一个鼻孔的气流显著减少，然后再转到另一个鼻孔。^([4](b01.xhtml#endnote-54))不仅忍者们敏锐的观察能力在其西方科学出版三百多年之前就发现了这一现象，他们还为这一发现开发了实际应用。例如，他们可能需要躺在目标楼下的狭小空间中，在那里他们无法点燃蜡烛或香，也无法使用仪器来追踪时间，甚至不敢睁开眼睛，免得眼中的光芒通过地板的缝隙引起目标的注意。在这种不舒适的情况下，他们会保持静止，注意自己的鼻息，直到合适的时机到来——这正是忍者纪律、聪明才智和创造力的杰出例证。
- en: The multitude of references to time in the shinobi scrolls, combined with the
    arduous methods developed to track time, suggests that these techniques would
    not have been developed if keeping track of time were not crucial for a threat
    actor to operate effectively. The ubiquity of cheap, easy, and reliable ways of
    telling time in modern society has almost certainly conditioned us to take time
    and its measurement for granted.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 忍者卷轴中对时间的众多提及，以及为追踪时间而开发的艰难方法，表明如果追踪时间对威胁行为者的有效运作不至关重要，这些技术就不可能被开发出来。现代社会中普遍存在廉价、简便且可靠的计时方法，这几乎肯定已经使我们习惯性地将时间及其测量视为理所当然。
- en: 'In this chapter, we’ll reconsider the value and importance of time in digital
    systems while briefly reviewing how it is generated, used, and secured with existing
    best practices. Then we will ask: if accurate time is so important to an adversary,
    what might happen if we could keep time secret from them? Or deny the adversary
    access to time? Or even deceive them with an inaccurate time?'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将重新审视时间在数字系统中的价值和重要性，同时简要回顾其生成、使用和现有最佳实践的安全措施。然后我们将提出以下问题：如果准确的时间对对手如此重要，那么如果我们能够将时间对他们保密，会发生什么呢？或者拒绝对手访问时间？甚至通过不准确的时间来欺骗他们，会怎样呢？
- en: The Importance of Time
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 时间的重要性
- en: Time is necessary for the operation of almost every modern computer system.
    By synchronizing sequential logic and generating a clock signal that dictates
    intervals of function, computers establish finite pulses of time. These pulses
    are like the ticking of a clock in which systems perform operations on data in
    stable, reliable input/output environments. The vast, intricate networks and systems
    that run our governments, economies, businesses, and personal lives operate on
    these pulses, requesting the time continuously. They could not function without
    their clocks.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 时间对于几乎所有现代计算机系统的运行都是必要的。通过同步顺序逻辑并生成控制功能间隔的时钟信号，计算机建立了有限的时间脉冲。这些脉冲就像钟表的滴答声，系统在稳定、可靠的输入/输出环境中对数据进行操作。支撑我们政府、经济、企业和个人生活的庞大而复杂的网络和系统，依靠这些脉冲不断请求时间。如果没有时钟，它们将无法正常工作。
- en: Numerous security controls exist to protect time data. Identity authentication
    on Network Time Protocol (NTP) servers verifies that an attacker is not spoofing
    a system’s trusted source of time. Encryption and checksums—encryption encodes
    the communication, and checksums serve to detect errors during transmission—on
    the NTP server’s time data verify its integrity and protect it from tampering.
    Nonce is an arbitrary randomized number added to the time communication to prevent
    repeated-transmission errors. Timestamps and time synchronization logging compare
    the system’s time to that reported by an authoritative time source. NTP stays
    available and fault tolerant by leveraging multiple time sources and alternate
    propagation methods, and if access to NTP is denied or unavailable, backup methods
    can accurately estimate time based on the last synchronization. Additional security
    best practices call for timestamping audit records, locking out sessions based
    on inactivity, restricting access to accounts based on the time of day, assessing
    the validity of security certificates and keys based on time and date information,
    establishing when to create backups, and measuring how long to keep cached records.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 保护时间数据的安全控制措施有很多。网络时间协议（NTP）服务器上的身份验证可以验证攻击者是否伪装成系统的可信时间来源。加密和校验和——加密对通信进行编码，校验和用于检测传输过程中的错误——在NTP服务器的时间数据上验证其完整性并防止篡改。Nonce是添加到时间通信中的一个任意随机数字，用于防止重复传输错误。时间戳和时间同步日志将系统的时间与权威时间源报告的时间进行比较。NTP通过利用多个时间源和备用传播方法保持可用性和容错性，如果无法访问NTP或被拒绝访问，备用方法可以基于最后一次同步准确估算时间。其他安全最佳实践要求对审计记录进行时间戳标记，根据不活动锁定会话，限制基于时间的账户访问，基于时间和日期信息评估安全证书和密钥的有效性，确定何时创建备份，并衡量保留缓存记录的时长。
- en: These controls protect the integrity and availability of time data, but rarely
    is enough consideration given to protecting time data’s confidentiality. Almost
    any modern application can request the time at any moment, and it is generally
    permitted access not only to the date and time but also to clock libraries and
    functions. While NTP can encrypt the time data it communicates to a system, there
    is a notable lack of controls around restricting access to the current system
    time. Identifying this control gap is important because time is a critical piece
    of information adversaries use to spread malware. The destructive Shamoon malware,^([5](b01.xhtml#endnote-55))for
    instance, was set to execute at the start of the Saudi Arabian weekend to inflict
    maximum damage; it was designed to wipe all infected systems before anyone would
    notice.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 这些控制措施保护时间数据的完整性和可用性，但往往忽视了对时间数据机密性的保护。几乎任何现代应用都可以随时请求时间，且通常不仅可以访问日期和时间，还可以访问时钟库和相关功能。虽然NTP可以加密它传输的时间数据，但在限制对当前系统时间访问的控制措施方面明显存在缺失。识别这一控制空白很重要，因为时间是攻击者用来传播恶意软件的关键信息。例如，破坏性的Shamoon恶意软件，^([5](b01.xhtml#endnote-55))
    就是在沙特阿拉伯周末开始时执行的，以造成最大破坏；它被设计成在任何人注意到之前，清除所有受感染的系统。
- en: 'Other common attacks include disclosing confidential information, causing race
    conditions, forcing deadlocks, manipulating information states, and performing
    timing attacks to discover cryptography secrets. More sophisticated malware can
    use its access to time to:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 其他常见攻击包括泄露机密信息、造成竞争条件、强制死锁、操纵信息状态，以及执行计时攻击以发现加密秘密。更复杂的恶意软件可以利用其对时间的访问来：
- en: Sleep for a set period to avoid detection
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设定特定的睡眠时间以避免被检测
- en: Measure pi to 10 million digits, timing how long the calculation takes to determine
    whether the infected system is in a sandbox/detonation environment designed to
    catch malware
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 计算π到1000万位，计时计算所需的时间，以确定受感染的系统是否处于沙盒/引爆环境中，旨在捕捉恶意软件
- en: Attempt to contact its command and control (C2) based on specific time instructions
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 尝试根据特定的时间指令联系其指挥控制（C2）系统
- en: Discover metadata and other information through timing attacks that reveal the
    state, position, and capability of the target system
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过计时攻击发现元数据和其他信息，揭示目标系统的状态、位置和能力
- en: If administrators could deny access to time (local, real, and linear), conducting
    operations within targeted information systems would be much more difficult—and
    possibly infeasible—for the adversary. However, it is important to note that haphazardly
    limiting time queries will likely result in cascading failures and errors. A precise
    approach is needed to deny access to time.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 如果管理员能够拒绝对时间（本地时间、实际时间和线性时间）的访问，进行目标信息系统的操作将变得更加困难——并且可能对攻击者来说是不可行的。然而，重要的是要注意，随意限制时间查询可能会导致连锁故障和错误。因此，需要一种精确的方法来拒绝对时间的访问。
- en: Keeping Time Confidential
  id: totrans-20
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 保持时间机密
- en: Keep in mind that, because confidentiality is not as entrenched as other forms
    of time security, applying such security controls will require special effort
    from your organization and the greater security community.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，由于机密性不像其他形式的时间安全那样根深蒂固，实施这些安全控制将需要组织和更广泛的安全社区的特别努力。
- en: Determine Your Baseline
  id: totrans-22
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 确定基准
- en: Identify the software, applications, systems, and administrative commands in
    your environment that require access to time. Implement function hooking (interception
    of function calls) and logging to determine who and what is requesting time. After
    establishing this baseline, use it to detect abnormal time queries and inform
    a time-based needs assessment that will tailor additional security controls (for
    example, Just in Time [JIT]).
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 确定环境中需要访问时间的软件、应用程序、系统和管理命令。实施功能挂钩（拦截函数调用）和日志记录，以确定谁和什么在请求时间。在建立此基准后，利用它检测异常的时间查询，并开展基于时间的需求评估，以量身定制额外的安全控制（例如，及时[Just
    in Time] [JIT]）。
- en: Assess Technical Capability
  id: totrans-24
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 评估技术能力
- en: Contact your hardware manufacturers and software vendors to determine what technical
    controls can be enabled to restrict access to time functions. If there are no
    such controls, request that new features be implemented to encourage the industry
    to develop solutions around time confidentiality.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 联系硬件制造商和软件供应商，以确定可以启用哪些技术控制来限制对时间功能的访问。如果没有这样的控制措施，建议实施新功能，鼓励行业围绕时间机密性开发解决方案。
- en: Establish Policy
  id: totrans-26
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 建立政策
- en: Denying access to time is a nontraditional security control, but as with more
    customary controls, enforcement requires establishing strategic policy that details
    requirements—in this case, limiting access to time and monitoring attempts to
    access time. Wherever possible, incorporate the concept of time confidentiality
    in all change management decisions, procurement of new hardware and software,
    and SOC prioritization. Formally document new policies and ensure that your organization’s
    CISO approves them.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 否认对时间的访问是一种非传统的安全控制措施，但与更多常规控制措施一样，执行此措施需要建立战略性政策，详细说明要求——在此情况下，即限制对时间的访问并监控访问时间的尝试。尽可能将时间保密的概念融入所有变更管理决策、新硬件和软件的采购以及SOC优先级的安排中。正式记录新政策，并确保您组织的CISO批准这些政策。
- en: Recommended Security Controls and Mitigations
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 推荐的安全控制措施和缓解措施
- en: Where relevant, recommendations are presented with applicable security controls
    from the NIST 800-53 standard. Each should be evaluated with the concept of time
    confidentiality in mind.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在相关的情况下，提供与NIST 800-53标准中适用的安全控制措施相关的建议。每项建议都应以时间保密的概念为依据进行评估。
- en: 'Implement protections that block access to time data in timestamp logs or other
    information-monitoring logs. Preventing time spillage or timestamp leakage could
    require physical, environmental, media, and technical controls. [AU-9: Protection
    of Audit Information]'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '实施保护措施，阻止访问时间数据，如时间戳日志或其他信息监控日志。防止时间泄露或时间戳泄漏可能需要物理、环境、媒体和技术控制。[AU-9: 审计信息保护]'
- en: 'Review your current information architecture with respect to time, including
    the philosophy, requirements, and tactics necessary to implement access and confidentiality
    controls around time data in your environment. If stakeholders agree to time restrictions,
    document them in a security plan with an approved budget, resources, and time
    dedicated to implementation. [PL-8: Information Security Architecture]'
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '审查您当前的信息架构，重点考虑时间方面的哲学、需求和实施访问及保密控制所需的策略。如果利益相关者同意时间限制，请在安全计划中记录，并确保有批准的预算、资源和实施时间。[PL-8:
    信息安全架构]'
- en: 'Conduct a log review and internal hunt to discover communication occurring
    over port 123 to any unofficial NTP servers in your environment. Look for NTP
    communication to external NTP servers and consider blocking access to NTP servers
    you do not control. [SC-7: Boundary Protection]'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '执行日志审查和内部排查，发现通过端口123与您环境中的任何非官方NTP服务器进行的通信。查找与外部NTP服务器的NTP通信，并考虑阻止对您无法控制的NTP服务器的访问。[SC-7:
    边界保护]'
- en: Debrief
  id: totrans-33
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 简报
- en: In this chapter, you learned about some of the tools shinobi used to tell time
    and what they did with their knowledge of time. We discussed how important time
    can be to cyber operations and security, noting that current security practices
    focus primarily on the availability and integrity of time in systems. You were
    also exposed to a thought exercise that explored how to mitigate a shinobi attack
    through time manipulation.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章节中，您了解了一些忍者用来计时的工具，以及他们如何利用对时间的理解来行动。我们讨论了时间对网络操作和安全性的重要性，指出当前的安全实践主要集中在确保系统中的时间可用性和完整性。您还参与了一个思维练习，探讨了如何通过时间操控来减轻忍者攻击。
- en: In the following chapter, we will discuss how shinobi could turn many things
    into tools to accomplish tasks. Understanding what the equivalent digital “tools”
    are may help you detect and safeguard against novel weaponization of such tools
    or at least hamper their use.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的章节中，我们将讨论忍者如何将许多事物转化为工具来完成任务。理解这些工具的数字化“对应物”可能帮助您检测并防范这些工具的新型武器化，或者至少减少它们的使用。
