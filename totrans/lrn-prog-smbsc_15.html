<html><head></head><body>
<h2 class="h2" id="ch15"><span epub:type="pagebreak" id="page_207"/><span class="big"><span class="blue"><strong>15</strong></span></span><br/><strong>GROUPING DATA IN ONE-DIMENSIONAL ARRAYS</strong></h2>&#13;
<div class="imagec"><img alt="image" src="graphics/common01.jpg"/></div>&#13;
<p class="noindent">So far you’ve worked with variables to store single pieces of information, and you’ve created some pretty awesome programs. But you can create even more amazing programs by storing lots of information in a single variable! In Small Basic, you do that by using an array.</p>&#13;
<p class="indent">An <em>array</em> is a built-in data type that lets you work with groups of data. For example, you wouldn’t build a separate closet for every pair of shoes you own (unless you’re a giant who loves shoe shopping); you’d put them all in one closet. Well, arrays let you store many pieces of data together to make it easier to work with them all at once. You can think of the closet as a one-dimensional array that contains a row of shoe boxes.</p>&#13;
<p class="indent">Small Basic has two types of arrays: indexed arrays and associative arrays. The pieces of data in an <em>indexed array</em> are referenced using an integer index, such as <code>score[1]</code>, <code>name[3]</code>, and so on. This is like putting a numbered label on each shoe box in your closet. But the elements of an <em>associative array</em> are <span epub:type="pagebreak" id="page_208"/>referenced using a string index, such as <code>price["apple"]</code> or <code>address["John"]</code>. This chapter explores indexed arrays. We’ll cover associative arrays, also called <em>hashes</em> or <em>maps</em>, in the next chapter.</p>&#13;
<h3 class="h3" id="ch15lev1sec01"><span class="blue"><strong>Getting Started with Indexed Arrays</strong></span></h3>&#13;
<p class="noindent">Let’s say you want to write a program that takes four test scores from a user and then displays them along with their average value. Based on what you’ve learned so far, you might write a program like the one in <a href="ch15.html#ch15ex1">Listing 15-1</a>.</p>&#13;
<p class="programs"> 1 <span class="green"><span class="codeitalic">' Average1.sb</span></span><br/> 2 <span class="blue1">TextWindow</span><span class="brown">.Write(</span><span class="red">"Enter 4 scores. "</span><span class="brown">)</span><br/> 3 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"Press &lt;Enter&gt; after each score."</span><span class="brown">)</span><br/> 4 s1 <span class="brown">=</span> <span class="blue1">TextWindow</span><span class="brown">.ReadNumber()</span>    <span class="green"><span class="codeitalic">' Reads the 1st score</span></span><br/> 5 s2 <span class="brown">=</span> <span class="blue1">TextWindow</span><span class="brown">.ReadNumber()</span>    <span class="green"><span class="codeitalic">' Reads the 2nd score</span></span><br/> 6 s3 <span class="brown">=</span> <span class="blue1">TextWindow</span><span class="brown">.ReadNumber()</span>    <span class="green"><span class="codeitalic">' Reads the 3rd score</span></span><br/> 7 s4 <span class="brown">=</span> <span class="blue1">TextWindow</span><span class="brown">.ReadNumber()</span>    <span class="green"><span class="codeitalic">' Reads the 4th score</span></span><br/> 8 avg <span class="brown">= (</span>s1 <span class="brown">+</span> s2 <span class="brown">+</span> s3 <span class="brown">+</span> s4<span class="brown">) /</span> <span class="red">4</span>   <span class="green"><span class="codeitalic">' Calculates the average</span></span><br/> 9 <span class="blue1">TextWindow</span><span class="brown">.Write(</span><span class="red">"Numbers: "</span> <span class="brown">+</span> s1 <span class="brown">+</span> <span class="red">", "</span> <span class="brown">+</span> s2 <span class="brown">+</span> <span class="red">", "</span><span class="brown">)</span><br/>10 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>s3 <span class="brown">+</span> <span class="red">", "</span> <span class="brown">+</span> s4<span class="brown">)</span><br/>11 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"Average: "</span> <span class="brown">+</span> avg<span class="brown">)</span></p>&#13;
<p class="listcap"><a id="ch15ex1"/><em>Listing 15-1: Storing scores in separate variables</em></p>&#13;
<p class="indent">This program prompts the user to enter four scores (lines 2–3). It reads these scores and saves them in the four variables <code>s1</code>, <code>s2</code>, <code>s3</code>, and <code>s4</code> (lines 4–7). Then it computes the average (line 8), displays the four numbers on a single line (lines 9–10), and displays the computed average (line 11).</p>&#13;
<p class="indent">Now imagine that you want a user to input 100 scores instead of 4. Defining 100 variables and copying almost the same statement 100 times would take a long time. Well, Small Basic’s array stores a collection of values. Using an array, you don’t have to create each variable separately. You can put all the values into one <em>array variable</em>. For example, you can read 10 scores a user enters and store them in one array using this loop:</p>&#13;
<p class="programs"><span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">10</span><br/>  score[N] <span class="brown">=</span> <span class="blue1">TextWindow</span><span class="brown">.ReadNumber()</span><br/><span class="purple"><span class="codestrong">EndFor</span></span><br/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>score<span class="brown">)</span></p>&#13;
<p class="indent">Instead of creating 10 variables, like <code>s1</code>, <code>s2</code>, and so on to <code>s10</code>, you create one array variable called <code>score</code>. To refer to each piece of data in the <code>score</code> array, you use the syntax <code>score[N]</code>, where <code>N</code> is a variable that will take on the values 1 through 10. Writing <code>score[N]</code> is like writing <code>score[1]</code>, <code>score[2]</code>, ..., <code>score[10]</code>, and the <code>For</code> loop increments <code>N</code> for you.</p>&#13;
<p class="indent">Run this code. After you enter 10 different numbers, Small Basic displays the <code>score</code> array, and you can see all 10 values stored in it (we’ll show you a better way to display an array later in this chapter).</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_209"/>One way to think of an array is as a collection of variables that share the same name. For example, the average rainfall in the 10 largest US cities could be saved in <code>rainLevel[1]</code> through <code>rainLevel[10]</code>, and the daily sales for the 100 McDonalds in your area could be saved in <code>sales[1]</code> through <code>sales[100]</code>. Think of all the Happy Meals!</p>&#13;
<p class="indent">Arrays can help you organize your data in a way that makes the data much easier to change and use. The name of an array follows the same rules and guidelines you use for naming variables.</p>&#13;
<h3 class="h3" id="ch15lev1sec02"><span class="blue"><strong>Array Basics</strong></span></h3>&#13;
<p class="noindent">Each piece of information in an array is called an <em>element</em>. To access an element in an array, you use this syntax:</p>&#13;
<p class="programs"><span class="codeitalic">arrayName</span>[<span class="codeitalic">index</span>]</p>&#13;
<p class="indent">The <code><span class="codeitalic">arrayName</code></span> variable is the array’s name, and <code><span class="codeitalic">index</code></span> is an identifier, either a number or a string, that identifies an element in the array (see <a href="ch15.html#ch15fig1">Figure 15-1</a>). This syntax is known as an <em>indexed variable</em>, or a <em>subscripted variable</em>. The index, which is placed between square brackets, uniquely identifies one element in the array.</p>&#13;
<div class="image"><img alt="image" src="graphics/f15-01.jpg"/></div>&#13;
<p class="figcap"><a id="ch15fig1"/><em>Figure 15-1: Graphical representation of a one-dimensional array</em></p>&#13;
<p class="indent">You can treat an indexed variable just like a regular variable by using the proper syntax. For example, the following statements initialize and display the first three elements of the <code>score</code> array in <a href="ch15.html#ch15fig1">Figure 15-1</a>:</p>&#13;
<p class="programs">score[<span class="red">1</span>] <span class="brown">=</span> <span class="red">80</span><br/>score[<span class="red">2</span>] <span class="brown">=</span> <span class="red">85</span><br/>score[<span class="red">3</span>] <span class="brown">=</span> <span class="red">90</span><br/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>score[<span class="red">1</span>] <span class="brown">+</span> <span class="red">", "</span> <span class="brown">+</span> score[<span class="red">2</span>] <span class="brown">+</span> <span class="red">", "</span> <span class="brown">+</span> score[<span class="red">3</span>]<span class="brown">)</span></p>&#13;
<p class="indent">If you run this code, you’ll see this output:</p>&#13;
<p class="programs">80, 85, 90</p>&#13;
<p class="indent">If you wanted to change the first score, you could write this statement:</p>&#13;
<p class="programs">score[<span class="red">1</span>] <span class="brown">=</span> score[<span class="red">1</span>] <span class="brown">+</span> <span class="red">5</span></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_210"/>This line of code adds five to the first <code>score</code> at index 1. If you displayed the value of <code>score</code> now, you’d see that <code>score[1] = 85</code>. You could use the next statement to multiply the two elements at indices 1 and 2:</p>&#13;
<p class="programs">score[<span class="red">1</span>] <span class="brown">=</span> score[<span class="red">1</span>] <span class="brown">*</span> score[<span class="red">2</span>]</p>&#13;
<p class="indent">If <code>score[1]</code> is 80 and <code>score[2]</code> is 85, they are multiplied to get 6,800, which is saved back into <code>score[1]</code>. High score!</p>&#13;
<h3 class="h3" id="ch15lev1sec03"><span class="blue"><strong>Initializing Arrays</strong></span></h3>&#13;
<p class="noindent">Before using an array in your program, you need to fill it up (or initialize it) with some data. In Small Basic, you can do this in two ways: by direct (element-by-element) initialization or string initialization.</p>&#13;
<p class="indent">Let’s say you want to create an array that holds four scores (not the Abe Lincoln type). Here’s the direct way to do this:</p>&#13;
<p class="programs">score[<span class="red">1</span>] <span class="brown">=</span> <span class="red">80</span><br/>score[<span class="red">2</span>] <span class="brown">=</span> <span class="red">85</span><br/>score[<span class="red">3</span>] <span class="brown">=</span> <span class="red">90</span><br/>score[<span class="red">4</span>] <span class="brown">=</span> <span class="red">95</span></p>&#13;
<p class="indent">You can also use a <em>string initializer</em>, which allows you to set the four values in just one line like this:</p>&#13;
<p class="programs">score <span class="brown">=</span> <span class="red">"1=80;2=85;3=90;4=95;"</span></p>&#13;
<p class="indent">This string initializer has four tokens (or fields), which are terminated by semicolons. Each token is in this form (and no, you can’t exchange these tokens for prizes):</p>&#13;
<p class="programs"><span class="codeitalic">index</span>=<span class="codeitalic">value</span>;</p>&#13;
<p class="indent">In this example, the first token is <code>1=80</code>, the second is <code>2=85</code>, the third is <code>3=90</code>, and the fourth is <code>4=95</code>. The number before the equal sign is the element’s index, and the value after the equal sign is the value stored in that element. Note that there are no spaces before or after the equal sign. <a href="ch15.html#ch15fig2">Figure 15-2</a> shows you how this string initializer works.</p>&#13;
<div class="image"><img alt="image" src="graphics/f15-02.jpg"/></div>&#13;
<p class="figcap"><a id="ch15fig2"/><em>Figure 15-2: The syntax of an array’s string initializer</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_211"/>The string initializer lets you fill an array in one statement, but its syntax is a bit complex, and you could accidentally introduce errors in your code. Until you become more comfortable with arrays, we recommend that you stick to the basic element-by-element initialization technique in your programs. But if you do use the string initializer and run into problems, try reinitializing your array one element at a time. We’ll use both initialization types in this book, to save space and to get you more familiar with them.</p>&#13;
<div class="note">&#13;
<p class="notet"><span class="notes"><strong>NOTE</strong></span></p>&#13;
<p class="notep"><em>Small Basic lets you choose any numbers you want for indices. It even lets you use negative and decimal numbers, and it doesn’t require the indices to be consecutive. But in this book we’ll always use integer indices starting from 1 for the first array element.</em></p>&#13;
</div>&#13;
<p class="indent">Arrays and <code>For</code> loops are often used together. When the size of an array is known, you can use a <code>For</code> loop to cycle through and perform operations on every element in that array. The next examples show you how to use <code>For</code> loops to perform operations on arrays.</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch15sb01"><strong>TRY IT OUT 15-1</strong></p>&#13;
<p class="noindent">Suppose that the elements in array <code>S</code> and variables <code>A</code> and <code>B</code> have the values in <a href="ch15.html#ch15fig3">Figure 15-3</a>. What is <code>S[A], S[B], S[A * B - 2], S[A + B]</code>, and <code>S[A] - 2 * S[B]</code>?</p>&#13;
<div class="image"><img alt="image" src="graphics/f15-03.jpg"/></div>&#13;
<p class="figcap"><a id="ch15fig3"/><em>Figure 15-3: Values in</em> <code><span class="codeitalic">S</code></span> <em>array and variables</em> <code><span class="codeitalic">A</code></span> <em>and</em> <code><span class="codeitalic">B</code></span></p>&#13;
</div>&#13;
<h3 class="h3" id="ch15lev1sec04"><span class="blue"><strong>Filling Arrays with a For Loop</strong></span></h3>&#13;
<p class="noindent">Many times you’ll need to fill the elements of an array with a constant value, a random value, a value calculated from a formula, or a value entered by a user. Let’s look at each scenario!</p>&#13;
<h4 class="h4" id="ch15lev2sec01"><span epub:type="pagebreak" id="page_212"/><em><strong>Constant Initialization</strong></em></h4>&#13;
<p class="noindent">The following code snippet shows how to initialize the first 10 elements of a tasty array (named <code>scoobySnack</code>) with a constant value of 0.</p>&#13;
<p class="programs"><span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">10</span><br/>  scoobySnack[N] <span class="brown">=</span> <span class="red">0</span><br/><span class="purple"><span class="codestrong">EndFor</span></span></p>&#13;
<p class="indent">The <code>For</code> loop repeats 10 times. In the first iteration, the value of <code>N</code> is 1, so the loop sets <code>scoobySnack[1] = 0</code>. In the second iteration, the value of <code>N</code> is 2, so the loop sets <code>scoobySnack[2] = 0</code>, and so on. This creates an array with 10 elements, all of which are 0.</p>&#13;
<h4 class="h4" id="ch15lev2sec02"><em><strong>Random Initialization</strong></em></h4>&#13;
<p class="noindent">You can also fill the elements of the <code>scoobySnack</code> array with random numbers, like this:</p>&#13;
<p class="programs"><span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">10</span><br/>  scoobySnack[N] <span class="brown">=</span> <span class="blue1">Math</span><span class="brown">.GetRandomNumber(</span><span class="red">5</span><span class="brown">)</span><br/><span class="purple"><span class="codestrong">EndFor</span></span></p>&#13;
<p class="indent">The <code>For</code> loop iterates 10 times. In the <code>N</code>th iteration, the element at index <code>N</code>, <code>scoobySnack[N]</code>, is assigned a random number between 1 and 5. Try displaying the value of <code>scoobySnack</code> to see what random numbers you get! Add the following statement after you set <code>scoobySnack[N]</code> inside the <code>For</code> loop:</p>&#13;
<p class="programs"><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>scoobySnack[N]<span class="brown">)</span></p>&#13;
<h4 class="h4" id="ch15lev2sec03"><em><strong>Formula Initialization</strong></em></h4>&#13;
<p class="noindent">You can also initialize the elements of an array using a formula. In this example, you’ll set the <code>N</code>th element of the <code>scoobySnack</code> array to <code>N * 8</code>; this code will store the multiplication table of eight in your array:</p>&#13;
<p class="programs"><span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">10</span><br/>  scoobySnack[N] <span class="brown">=</span> N <span class="brown">*</span> <span class="red">8</span><br/><span class="purple"><span class="codestrong">EndFor</span></span></p>&#13;
<p class="indent">Add the code that displays the value of <code>scoobySnack</code> to see the results!</p>&#13;
<h4 class="h4" id="ch15lev2sec04"><em><strong>User Initialization</strong></em></h4>&#13;
<p class="noindent">What if you want to initialize the elements of your array using values entered by a user? The following program prompts the user to enter five numbers and press <small>ENTER</small> after each number. The program then starts a <code>For</code> loop to read the five numbers and store them in <code>thunderCat[1]</code>, <code>thunderCat[2]</code>, ..., <code>thunderCat[5]</code>.</p>&#13;
<p class="programs"><span epub:type="pagebreak" id="page_213"/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"Enter 5 numbers. Press Enter after each one."</span><span class="brown">)</span><br/><span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">5</span><br/>  thunderCat[N] <span class="brown">=</span> <span class="blue1">TextWindow</span><span class="brown">.ReadNumber()</span><br/><span class="purple"><span class="codestrong">EndFor</span></span></p>&#13;
<p class="indent">This technique is very useful for storing lots of data from a user. What other collections of data might you ask for? How about <code>breakfastMenu</code>, <code>favoriteGames</code>, <code>bestPasswords</code>, <code>funnyJokes</code>, or <code>frozenNames</code>?</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch15sb02"><strong>TRY IT OUT 15-2</strong></p>&#13;
<p class="noindent">Write a program that fills an array called <code>skeletor</code> with even integers from 20 to 40 (for example, <code>skeletor[1] = 20, skeletor[2] = 22</code>, ...).</p>&#13;
</div>&#13;
<h3 class="h3" id="ch15lev1sec05"><span class="blue"><strong>Displaying Arrays</strong></span></h3>&#13;
<p class="noindent">Let’s say we have an array named <code>age</code> that holds the ages of three brothers, like this:</p>&#13;
<p class="programs">age[<span class="red">1</span>] <span class="brown">=</span> <span class="red">14</span><br/>age[<span class="red">2</span>] <span class="brown">=</span> <span class="red">15</span><br/>age[<span class="red">3</span>] <span class="brown">=</span> <span class="red">16</span></p>&#13;
<p class="indent">You can display the contents of this array in two ways. The first and easiest way is to pass the array’s name to the <code>WriteLine()</code> method, like this:</p>&#13;
<p class="programs"><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>age<span class="brown">)</span></p>&#13;
<p class="indent">Here’s the output of this statement:</p>&#13;
<p class="programs">1=14;2=15;3=16;</p>&#13;
<p class="indent">This statement displays the elements of the array on a single line separated by semicolons. Each token in this string shows the index and the value of the array’s element at that index. Can you see now where the array’s string initializer syntax came from?</p>&#13;
<p class="indent">If you want to display the array in an easier-to-read format, you can use a <code>For</code> loop to display each element of the array in its own row:</p>&#13;
<p class="programs"><span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">3</span><br/>  <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"age["</span> <span class="brown">+</span> N <span class="brown">+</span> <span class="red">"] = "</span> <span class="brown">+</span> age[N]<span class="brown">)</span><br/><span class="purple"><span class="codestrong">EndFor</span></span></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_214"/>Here’s the output of this loop:</p>&#13;
<p class="programs">age[1] = 14<br/>age[2] = 15<br/>age[3] = 16</p>&#13;
<p class="indent">If you’re working with a short array, it’s fine to display it on a single line. But if you’re working with a lot of data, it’s best to display the array in a format that’s easy to read.</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch15sb03"><strong>TRY IT OUT 15-3</strong></p>&#13;
<p class="noindent">Write a program that fills an array called <code>burps</code> with five random numbers between 80 and 100 and then displays the array. Try displaying the array by passing the array’s name to <code>TextWindow.WriteLine()</code> and then by using a <code>For</code> loop. Which looks nicer?</p>&#13;
</div>&#13;
<h3 class="h3" id="ch15lev1sec06"><span class="blue"><strong>Processing Arrays</strong></span></h3>&#13;
<p class="noindent">Many programs involve processing the elements of an array, such as adding them and finding their average, minimum, maximum, and so on. You’ll learn how to do these tasks in this section.</p>&#13;
<h4 class="h4" id="ch15lev2sec05"><em><strong>Finding the Sum</strong></em></h4>&#13;
<p class="noindent">A superhero named Super Here-O wants to know how much money he rescued from 10 robbers in his town. The following program lets Super Here-O enter the amounts he rescued into an array named <code>moneyReturned</code>. The program finds the sum of all the elements of this array:</p>&#13;
<p class="programs">sum <span class="brown">=</span> <span class="red">0</span><br/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"Enter the 10 amounts that were returned:"</span><span class="brown">)</span><br/><span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">10</span><br/>  moneyReturned[N] <span class="brown">=</span> <span class="blue1">TextWindow</span><span class="brown">.ReadNumber()</span><br/>  sum <span class="brown">=</span> sum <span class="brown">+</span> moneyReturned[N]<br/><span class="purple"><span class="codestrong">EndFor</span></span><br/><span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">10</span><br/>  <span class="blue1">TextWindow</span><span class="brown">.Write(</span><span class="red">"$"</span> <span class="brown">+</span> moneyReturned[N]<span class="brown">)</span><br/>  <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">" rescued from robber "</span> <span class="brown">+</span> N<span class="brown">)</span><br/><span class="purple"><span class="codestrong">EndFor</span></span><br/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"$"</span> <span class="brown">+</span> sum <span class="brown">+</span> <span class="red">" was rescued by Super Here-O!"</span><span class="brown">)</span></p>&#13;
<p class="indent">To find the sum, you start by initializing the <code>sum</code> variable to 0. You then run a <code>For</code> loop to read each element of the <code>moneyReturned</code> array and add it to the <code>sum</code> variable. When the loop terminates, you start another loop to show <span epub:type="pagebreak" id="page_215"/>how much money was rescued from each robber, and then you display the total amount returned. Run the program to find out whether it’s enough money to buy a new superhero spandex suit!</p>&#13;
<h4 class="h4" id="ch15lev2sec06"><em><strong>Finding the Maximum Element</strong></em></h4>&#13;
<p class="noindent">Say you’re competing with nine of your good friends to see who has the most friends on Facebook. Use the following code snippet to find the largest value in an array named <code>friends</code>:</p>&#13;
<p class="programs">friends <span class="brown">=</span> <span class="red">"1=10;2=30;3=5;4=10;5=15;6=8;7=1;8=23;9=6;10=11"</span><br/>max <span class="brown">=</span> friends[<span class="red">1</span>]<br/><span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">2</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">10</span><br/>  <span class="purple"><span class="codestrong">If</span></span> <span class="brown">(</span>friends[N] <span class="brown">&gt;</span> max<span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span>  <span class="green"><span class="codeitalic">' Nth element is larger than max</span></span><br/>    max <span class="brown">=</span> friends[N]          <span class="green"><span class="codeitalic">' Update max to hold the new maximum</span></span><br/>  <span class="purple"><span class="codestrong">EndIf</span></span><br/><span class="purple"><span class="codestrong">EndFor</span></span><br/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"The most friends is "</span> <span class="brown">+</span> max + <span class="red">"."</span><span class="brown">)</span></p>&#13;
<p class="indent">First, we filled the 10 elements of the <code>friends</code> array with the number of Facebook friends that you and your nine closest friends have. In this example, your first friend has 10 friends, your second friend has 30, your third friend has 5, and so on, and you (number 10 in the array) have 11 friends. Feel free to change these numbers. The program starts by assuming that the first element, <code>friends[1]</code>, is the largest. It then enters a loop that examines the remaining elements of the array, starting at the second element. Every time it finds a number larger than the current maximum, it updates the maximum, <code>max</code>, to that number. When the loop terminates, the maximum value displays.</p>&#13;
<h3 class="h3" id="ch15lev1sec07"><span class="blue"><strong>Using String Values in Arrays</strong></span></h3>&#13;
<p class="noindent">Arrays aren’t restricted to numbers. You can also use arrays to store strings. Let’s say, for example, that you want to create an array to store the names of the books in your collection. You could initialize this array:</p>&#13;
<p class="programs">book[<span class="red">1</span>] <span class="brown">=</span> <span class="red">"The Hobbit"</span><br/>book[<span class="red">2</span>] <span class="brown">=</span> <span class="red">"Little Women"</span><br/>book[<span class="red">3</span>] <span class="brown">=</span> <span class="red">"My Little Pony vs Hello Kitty"</span></p>&#13;
<div class="note">&#13;
<p class="notet"><span class="notes"><strong>NOTE</strong></span></p>&#13;
<p class="notep"><em>You could also use a string initializer to initialize the</em> <code><span class="codeitalic">book</code></span> <em>array like this (make sure the entire statement is on one line):</em></p>&#13;
<p class="programs">book <span class="brown">=</span> <span class="red">"1=The Hobbit;2=Little Women;3=My Little Pony vs Hello Kitty"</span></p>&#13;
</div>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch15sb04"><span epub:type="pagebreak" id="page_216"/><strong>TRY IT OUT 15-4</strong></p>&#13;
<p class="noindent">Write a program that fills two arrays (<code>noun</code> and <code>verb</code>) with plural nouns and verbs of your choice. Have the program display random sentences in this form: <code>noun verb noun</code> (for example, dogs delight cats).</p>&#13;
</div>&#13;
<h3 class="h3" id="ch15lev1sec08"><span class="blue"><strong>Saving Records</strong></span></h3>&#13;
<p class="noindent">You can mix different data types within a single array. You can store numbers, both whole and decimal, and strings as different elements in the same array. For example, the following array is valid (do you know this building?):</p>&#13;
<p class="programs">arr[<span class="red">1</span>] <span class="brown">=</span> <span class="red">1600</span><br/>arr[<span class="red">2</span>] <span class="brown">=</span> <span class="red">"Pennsylvania Avenue NW"</span><br/>arr[<span class="red">3</span>] <span class="brown">=</span> <span class="red">20500</span></p>&#13;
<p class="indent">The first and third elements of this array are numbers. The second element is a string. These three elements could represent a home’s number, its street name, and its ZIP code, respectively. This is one way to create a <em>record</em>, which is a collection of related pieces of data, in Small Basic.</p>&#13;
<p class="indent">Whew! Well, we’ve covered more than enough to solve oodles of problems. Now let’s spend some time writing fun programs!</p>&#13;
<h3 class="h3" id="ch15lev1sec09"><span class="blue"><strong>Using Indexed Arrays</strong></span></h3>&#13;
<p class="noindent">The first example in this section shows you how to select random elements from an array. The second example simulates a Magic 8 Ball game in which the computer provides randomly selected answers to a player’s questions. Let’s get random!</p>&#13;
<h4 class="h4" id="ch15lev2sec07"><em><strong>Random Selection</strong></em></h4>&#13;
<p class="noindent">Let’s say we have a bag that contains 10 balls numbered 1 through 10, and we want to take out five random balls (see <a href="ch15.html#ch15fig4">Figure 15-4</a>). We’ll write a program that randomly selects five balls and then displays their numbers.</p>&#13;
<div class="image"><img alt="image" src="graphics/f15-04.jpg"/></div>&#13;
<p class="figcap"><a id="ch15fig4"/><em>Figure 15-4: Randomly selecting five balls from a bag</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_217"/>To create this program, we’ll use an array named <code>ball</code> to hold the numbers of the 10 balls (<code>ball[1] = 1</code>, <code>ball[2] = 2</code>, …, <code>ball[10] = 10</code>). Then the program selects a random number between 1 and 10 to pick a ball. For example, if it picks number 2, it sets <code>ball[2] = 0</code> to indicate that the second ball has been selected and is no longer available. Then it selects another random number. Let’s say that the second number is also 2. First, the program checks <code>ball[2]</code>. Because it’s 0, it knows that <code>ball[2]</code> has already been selected (you can’t take the same ball out of the bag twice!), and it picks another random number. It continues this until it selects five different random numbers. The complete program is shown in <a href="ch15.html#ch15ex2">Listing 15-2</a>.</p>&#13;
<p class="programs"> 1 <span class="green"><span class="codeitalic">' RandomSelect.sb</span></span><br/> 2 <span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">10</span>  <span class="green"><span class="codeitalic">' Puts the 10 balls in an array</span></span><br/> 3   ball[N] <span class="brown">=</span> N<br/> 4 <span class="purple"><span class="codestrong">EndFor</span></span><br/> 5<br/> 6 <span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">5</span>                     <span class="green"><span class="codeitalic">' Loops to select 5 balls</span></span><br/> 7   idx <span class="brown">=</span> <span class="blue1">Math</span><span class="brown">.GetRandomNumber(</span><span class="red">10</span><span class="brown">)</span>   <span class="green"><span class="codeitalic">' Gets random ball number</span></span><br/> 8   <span class="purple"><span class="codestrong">While</span></span> <span class="brown">(</span>ball[idx] <span class="brown">=</span> <span class="red">0</span><span class="brown">)</span>            <span class="green"><span class="codeitalic">' Ball already selected</span></span><br/> 9     idx <span class="brown">=</span> <span class="blue1">Math</span><span class="brown">.GetRandomNumber(</span><span class="red">10</span><span class="brown">)</span> <span class="green"><span class="codeitalic">' Gets another number</span></span><br/>10   <span class="purple"><span class="codestrong">EndWhile</span></span><br/>11<br/>12   <span class="blue1">TextWindow</span><span class="brown">.Write(</span>ball[idx] <span class="brown">+</span> <span class="red">", "</span><span class="brown">)</span> <span class="green"><span class="codeitalic">' Displays selected ball</span></span><br/>13   ball[idx] <span class="brown">=</span> <span class="red">0</span>                      <span class="green"><span class="codeitalic">' Marks it out (taken)</span></span><br/>14 <span class="purple"><span class="codestrong">EndFor</span></span><br/>15 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">""</span><span class="brown">)</span></p>&#13;
<p class="listcap"><a id="ch15ex2"/><em>Listing 15-2: Randomly selecting five different balls</em></p>&#13;
<p class="indent">The program starts by setting <code>ball[1] = 1</code>, <code>ball[2] = 2</code>, ..., <code>ball[10] = 10</code> in a <code>For</code> loop (lines 2–4). It then begins a loop to select the five balls (line 6). In each iteration of the loop, it picks a random number, <code>idx</code>, between 1 and 10 (line 7). A <code>While</code> loop continually sets <code>idx</code> until <code>ball[idx]</code> is not 0 (lines 8–10). After selecting a unique ball number, the program displays the number (line 12), and then it marks that ball as selected by setting its array element to 0 (line 13) so it doesn’t try to select that number again. Here’s a sample run of this program:</p>&#13;
<p class="programs">5, 9, 10, 1, 2,</p>&#13;
<p class="indent">Run the program to see which numbers you get!</p>&#13;
<h4 class="h4" id="ch15lev2sec08"><em><strong>A Magic 8 Ball</strong></em></h4>&#13;
<p class="noindent">In this example, we’ll write a program that simulates a Magic 8 Ball game. A user asks a yes or no question, and the computer answers. Of course, it’s just for fun, so don’t use it to make important decisions like choosing your spouse or house! The complete program is shown in <a href="ch15.html#ch15ex3">Listing 15-3</a>.</p>&#13;
<p class="programs"> 1 <span class="green"><span class="codeitalic">' Magic8Ball.sb</span></span><br/> 2 ans[<span class="red">1</span>] <span class="brown">=</span> <span class="red">"It is certain. Like really, really certain."</span><br/> 3 ans[<span class="red">2</span>] <span class="brown">=</span> <span class="red">"It is decidedly so. By me. I decided."</span><br/> 4 ans[<span class="red">3</span>] <span class="brown">=</span> <span class="red">"Without a doubt. Maybe one doubt."</span><br/> 5 ans[<span class="red">4</span>] <span class="brown">=</span> <span class="red">"Yes, definitely. Isn't it obvious?"</span><br/> 6 ans[<span class="red">5</span>] <span class="brown">=</span> <span class="red">"Very doubtful. The doubt is very full."</span><br/> 7 ans[<span class="red">6</span>] <span class="brown">=</span> <span class="red">"Maybe. Depends on the horse race."</span><br/> 8 ans[<span class="red">7</span>] <span class="brown">=</span> <span class="red">"No. Wait, yes. Wait, no. Yes, it's no."</span><br/> 9 ans[<span class="red">8</span>] <span class="brown">=</span> <span class="red">"Let me consult my Magic 8 Ball... It says yes."</span><br/>10 ans[<span class="red">9</span>] <span class="brown">=</span> <span class="red">"Outlook not so good. Restart Outlook."</span><br/>11 ans[<span class="red">10</span>] <span class="brown">=</span> <span class="red">"Try again. It's funny when you shake things."</span><br/>12<br/>13 <span class="purple"><span class="codestrong">While</span></span> <span class="brown">(</span><span class="red">"True"</span><span class="brown">)</span><br/>14   <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"Ask me a yes-no question. Do it!"</span><span class="brown">)</span><br/>15   ques <span class="brown">=</span> <span class="blue1">TextWindow</span><span class="brown">.Read()</span><br/>16   num <span class="brown">=</span> <span class="blue1">Math</span><span class="brown">.GetRandomNumber(</span><span class="red">10</span><span class="brown">)</span><br/>17   <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>ans[num]<span class="brown">)</span><br/>18   <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">""</span><span class="brown">)</span><br/>19 <span class="purple"><span class="codestrong">EndWhile</span></span></p>&#13;
<p class="listcap"><a id="ch15ex3"/><em>Listing 15-3: A Magic 8 Ball simulation</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_218"/>The game has 10 possible answers saved in the <code>ans</code> array. After initializing the array (lines 2–11), the game starts an infinite loop to interact with the user. In each iteration it asks the user to enter a yes or no question. It reads the user’s question (line 15), generates a random number between 1 and 10 (line 16), and uses that number to display one of the answers using <code>ans[num]</code> (line 17). After displaying the message, we display a blank line (line 18). For someone who doesn’t know the trick, the computer might look intelligent! Ask your friends to play this game, and see what they think.</p>&#13;
<p class="indent">How’re you feeling? Sharp as a sponge and fresh as a tack? Great, because it’s game creation time!</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch15sb05"><strong>TRY IT OUT 15-5</strong></p>&#13;
<p class="noindent">Modify the Magic 8 Ball game so it shows each answer only once. End the game when all the answers have been displayed.</p>&#13;
</div>&#13;
<h3 class="h3" id="ch15lev1sec10"><span class="blue"><strong>Create the Catch Apples Game</strong></span></h3>&#13;
<p class="noindent"><a href="ch15.html#ch15fig5">Figure 15-5</a> shows a game in which apples appear in random positions at the top of the graphics window at random times and fall to the ground. The player has to move the cart using the mouse to catch the apples before they hit the ground. Each apple is worth 1 point. Don’t worry about bruising the apples; they’re hard core!</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_219"/><img alt="image" src="graphics/f15-05.jpg"/></div>&#13;
<p class="figcap"><a id="ch15fig5"/><em>Figure 15-5: The Catch Apples game</em></p>&#13;
<p class="indent">Follow these steps to put this great game together one piece at a time.</p>&#13;
<h4 class="h4" id="ch15lev2sec09"><em><strong>Step 1: Open the Startup File</strong></em></h4>&#13;
<p class="noindent">Open the file <em>CatchApples_Incomplete.sb</em> in this chapter’s folder. The folder also has all the images you’ll need for this program. The startup file contains the main code (shown in <a href="ch15.html#ch15ex4">Listing 15-4</a>) and empty placeholders for the four subroutines that you’ll write. Let’s start with the main code.</p>&#13;
<p class="programs"> 1 <span class="green"><span class="codeitalic">' CatchApples_Incomplete.sb</span></span><br/> 2 <span class="blue1">GraphicsWindow</span><span class="brown">.Title =</span> <span class="red">"Catch Apples"</span><br/> 3 <span class="blue1">GraphicsWindow</span><span class="brown">.CanResize =</span> <span class="red">"False"</span><br/> 4 <span class="blue1">GraphicsWindow</span><span class="brown">.Width =</span> <span class="red">480</span><br/> 5 <span class="blue1">GraphicsWindow</span><span class="brown">.Height =</span> <span class="red">360</span><br/> 6 <span class="blue1">GraphicsWindow</span><span class="brown">.FontSize =</span> <span class="red">14</span><br/> 7 <span class="blue1">GraphicsWindow</span><span class="brown">.BrushColor =</span> <span class="red">"Black"</span><br/> 8<br/> 9 path <span class="brown">=</span> <span class="blue1">Program</span><span class="brown">.Directory</span><br/>10 <span class="blue1">GraphicsWindow</span><span class="brown">.DrawImage(</span>path <span class="brown">+</span> <span class="red">"\Background.png"</span><span class="brown">,</span> <span class="red">0</span><span class="brown">,</span> <span class="red">0</span><span class="brown">)</span><br/>11<br/>12 msgID <span class="brown">=</span> <span class="blue1">Shapes</span><span class="brown">.AddText(</span><span class="red">""</span><span class="brown">)</span><br/>13 <span class="blue1">Shapes</span><span class="brown">.Move(</span>msgID<span class="brown">,</span> <span class="red">240</span><span class="brown">,</span> <span class="red">0</span><span class="brown">)</span><br/>14<br/>15 MAX_APPLES <span class="brown">=</span> <span class="red">5</span>     <span class="green"><span class="codeitalic">' Change this to have more apples</span></span><br/>16 AddApples<span class="brown">()</span>        <span class="green"><span class="codeitalic">' Creates the apple array</span></span><br/>17<br/>18 cartImg <span class="brown">=</span> <span class="blue1">Shapes</span><span class="brown">.AddImage(</span>path <span class="brown">+</span> <span class="red">"\Cart.png"</span><span class="brown">)</span>  <span class="green"><span class="codeitalic">' 100x80 pixels</span></span><br/>19<br/>20 numMissed <span class="brown">=</span> <span class="red">0</span>   <span class="green"><span class="codeitalic">' Missed apples</span></span><br/>21 numCaught <span class="brown">=</span> <span class="red">0</span>   <span class="green"><span class="codeitalic">' Caught apples</span></span><br/>22<br/>23 <span class="purple"><span class="codestrong">While</span></span> <span class="brown">(</span><span class="red">"True"</span><span class="brown">)</span><br/>24   <span class="blue1">Shapes</span><span class="brown">.Move(</span>cartImg<span class="brown">,</span> <span class="blue1">GraphicsWindow</span><span class="brown">.MouseX -</span> <span class="red">50</span><span class="brown">,</span> <span class="red">280</span><span class="brown">)</span><br/>25   MoveApples<span class="brown">()</span><br/>26   <span class="blue1">Program</span><span class="brown">.Delay(</span><span class="red">5</span><span class="brown">)</span><br/>27 <span class="purple"><span class="codestrong">EndWhile</span></span></p>&#13;
<p class="listcap"><a id="ch15ex4"/><em>Listing 15-4: The main code for the Catch Apples game</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_220"/>In lines 2–7, we set the graphic window’s title; size, to match the size of the background image; font size; and font color. Then we draw the background image (line 10) and create the text shape that displays the number of caught and dropped apples (lines 12–13). The <code>MAX_APPLES</code> variable in line 15 is the maximum number of apples that will appear in the graphics window. Once you get the game running, experiment with this number to make the game easier or harder.</p>&#13;
<p class="indent">Line 16 calls the <code>AddApples()</code> subroutine to create the array that will hold the falling apples. Line 18 adds the cart’s image and saves its identifier in <code>cartImg</code>; we need this identifier to move the cart.</p>&#13;
<p class="indent">Lines 20–21 initialize the variables <code>numMissed</code> (the number of missed apples) and <code>numCaught</code> (the number of caught apples) to 0. The code then starts the game’s main loop (lines 23–27). In each iteration, we move the cart so its center lines up with the mouse’s x position (line 24). Because the cart’s width is 100 pixels, the cart’s left position is set to <code>MouseX – 50</code>. The cart’s y-position is fixed. We call the <code>MoveApples()</code> subroutine to make apples fall and check whether they touch the cart or the ground (line 25); then we wait 5 milliseconds before repeating these steps (line 26). But don’t tell your dad to wait 5 milliseconds, or he might think you’re sassing!</p>&#13;
<p class="indent">Run the game now, and move the mouse. The cart follows the mouse, but no apples appear yet. You’ll add the missing subroutines next to finish the game.</p>&#13;
<h4 class="h4" id="ch15lev2sec10"><em><strong>Step 2: Add the Apples</strong></em></h4>&#13;
<p class="noindent">Add the <code>AddApples()</code> subroutine in <a href="ch15.html#ch15ex5">Listing 15-5</a>.</p>&#13;
<p class="programs">1 <span class="purple"><span class="codestrong">Sub</span></span> AddApples<br/>2   <span class="purple"><span class="codestrong">For</span></span> aplNum <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> MAX_APPLES<br/>3     apple[aplNum] <span class="brown">=</span> <span class="blue1">Shapes</span><span class="brown">.AddImage(</span>path <span class="brown">+</span> <span class="red">"\Apple.png"</span><span class="brown">)</span><br/>4     scale <span class="brown">=(</span><span class="red">3</span> <span class="brown">+</span> <span class="blue1">Math</span><span class="brown">.GetRandomNumber(</span><span class="red">5</span><span class="brown">)) /</span> <span class="red">10</span><br/>5     <span class="blue1">Shapes</span><span class="brown">.Zoom(</span>apple[aplNum]<span class="brown">,</span> scale<span class="brown">,</span> scale<span class="brown">)</span><br/>6     SetApplePosition<span class="brown">()</span><br/>7   <span class="purple"><span class="codestrong">EndFor</span></span><br/>8 <span class="purple"><span class="codestrong">EndSub</span></span></p>&#13;
<p class="listcap"><a id="ch15ex5"/><em>Listing 15-5: The</em> <code><span class="codeitalic">AddApples()</code></span> <em>subroutine</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_221"/>The subroutine uses a <code>For</code> loop to create the five apples. In each iteration, we call <code>AddImage()</code> to load the apple’s image from the game’s folder and save the returned identifier in the <code>apple</code> array (line 3). The first apple is saved in <code>apple[1]</code>, the second apple is saved in <code>apple[2]</code>, and so on.</p>&#13;
<p class="indent">To add some variety to the apple game, we’ll change the sizes of the apples. In line 4, we set the <code>scale</code> variable to a random value from the set {0.4, 0.5, 0.6, 0.7, 0.8}, which is calculated by <code>(3 + Math.GetRandomNumber(5)) / 10</code>. In line 5, we pass that value to the <code>Zoom()</code> method to change the apple’s size. This sets the apple’s size to a fraction (between 40 and 80 percent) of its original size.</p>&#13;
<p class="indent">Next, we’ll call the <code>SetApplePosition()</code> subroutine to position the new apple. Let’s examine what this subroutine does.</p>&#13;
<h4 class="h4" id="ch15lev2sec11"><em><strong>Step 3: Position the Apples</strong></em></h4>&#13;
<p class="noindent">Add the <code>SetApplePosition()</code> subroutine in <a href="ch15.html#ch15ex6">Listing 15-6</a>.</p>&#13;
<p class="programs">1 <span class="purple"><span class="codestrong">Sub</span></span> SetApplePosition<br/>2   xPos <span class="brown">=</span> <span class="blue1">Math</span><span class="brown">.GetRandomNumber(</span><span class="red">420</span><span class="brown">)</span><br/>3   yPos <span class="brown">= -</span><span class="blue1">Math</span><span class="brown">.GetRandomNumber(</span><span class="red">500</span><span class="brown">)</span><br/>4   <span class="blue1">Shapes</span><span class="brown">.Move(</span>apple[aplNum]<span class="brown">,</span> xPos<span class="brown">,</span> yPos<span class="brown">)</span><br/>5 <span class="purple"><span class="codestrong">EndSub</span></span></p>&#13;
<p class="listcap"><a id="ch15ex6"/><em>Listing 15-6: The</em> <code><span class="codeitalic">SetApplePosition()</code></span> <em>subroutine</em></p>&#13;
<p class="indent">We set the horizontal position to a random integer between 1 and 420 (line 2) and the vertical position to a negative value between –1 and –500 (line 3). The call to <code>Move()</code> in line 4 puts the apple (at index <code>aplNum</code> in the <code>apple</code> array) at some invisible point above the top edge of the graphics window using the two numbers <code>xPos</code> and <code>yPos</code>. This way, when the apples start falling, they appear at the top of the screen at random times; the apple that was placed at <code>yPos = –100</code> appears sooner than the one placed at <code>yPos = –500</code> because it has less distance to fall. As you’ll see in a moment, we’ll also call this subroutine when the player catches or misses an apple.</p>&#13;
<h4 class="h4" id="ch15lev2sec12"><em><strong>Step 4: Move the Apples</strong></em></h4>&#13;
<p class="noindent">Now we’re ready to make it rain apples (give the cats and dogs a break). Add the code in <a href="ch15.html#ch15ex7">Listing 15-7</a> to the program in the placeholder for the <code>MoveApples()</code> subroutine.</p>&#13;
<p class="programs"> 1 <span class="purple"><span class="codestrong">Sub</span></span> MoveApples<br/> 2   <span class="purple"><span class="codestrong">For</span></span> aplNum <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> MAX_APPLES<br/> 3     xPos <span class="brown">=</span> <span class="blue1">Shapes</span><span class="brown">.GetLeft(</span>apple[aplNum]<span class="brown">)</span><br/> 4     yPos <span class="brown">=</span> <span class="blue1">Shapes</span><span class="brown">.GetTop</span> (apple[aplNum]<span class="brown">)</span><br/> 5     <span class="blue1">Shapes</span><span class="brown">.Move(</span>apple[aplNum]<span class="brown">,</span> xPos<span class="brown">,</span> yPos <span class="brown">+</span> <span class="red">1</span><span class="brown">)</span><br/> 6<br/> 7     CheckCatch<span class="brown">()</span>       <span class="green"><span class="codeitalic">' Checks if the apple landed in the cart</span></span><br/> 8     <span class="purple"><span class="codestrong">If</span></span> <span class="brown">(</span>gotIt <span class="brown">=</span> <span class="red">1</span><span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span><br/> 9       <span class="blue1">Sound</span><span class="brown">.PlayClick()</span><br/>10       numCaught <span class="brown">=</span> numCaught <span class="brown">+</span> <span class="red">1</span><br/>11       SetApplePosition<span class="brown">()</span><br/>12     <span class="purple"><span class="codestrong">ElseIf</span></span> <span class="brown">(</span>yPos <span class="brown">&gt;</span> <span class="red">320</span><span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span><br/>13       numMissed <span class="brown">=</span> numMissed <span class="brown">+</span> <span class="red">1</span><br/>14       SetApplePosition<span class="brown">()</span><br/>15     <span class="purple"><span class="codestrong">EndIf</span></span><br/>16   <span class="purple"><span class="codestrong">EndFor</span></span><br/>17<br/>18   msg <span class="brown">=</span> <span class="red">"Caught: "</span> <span class="brown">+</span> numCaught <span class="brown">+</span> <span class="red">"   Missed: "</span> <span class="brown">+</span> numMissed<br/>19   <span class="blue1">Shapes</span><span class="brown">.SetText(</span>msgID<span class="brown">,</span> msg<span class="brown">)</span><br/>20 <span class="purple"><span class="codestrong">EndSub</span></span></p>&#13;
<p class="listcap"><a id="ch15ex7"/><em>Listing 15-7: The</em> <code><span class="codeitalic">MoveApples()</code></span> <em>subroutine</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_222"/>In line 2, we start a <code>For</code> loop to drop five apples. We get the upper-left corner of each apple (lines 3–4), and then we move it down by 1 pixel (line 5). We then call <code>CheckCatch()</code> to see whether this apple was caught by the player (line 7). As you’ll see in a moment, this subroutine sets the <code>gotIt</code> flag to 1 if the player caught the apple; otherwise, it sets <code>gotIt</code> to 0. It’s okay if you miss an apple. You won’t hurt its peelings.</p>&#13;
<p class="indent">When <code>CheckCatch()</code> returns, we check the <code>gotIt</code> flag. If it’s 1 (line 8), that means the apple was caught by the player. In this case, we play a click sound, increment <code>numCaught</code> by 1, and call <code>SetApplePosition()</code> to reposition this apple and let it fall again (lines 9–11). On the other hand, if <code>gotIt</code> isn’t 1, we check the apple’s y-position to see whether it went below the cart’s center, which means that the player missed it (line 12). In this case, we increase <code>numMissed</code> by 1 and call <code>SetApplePosition()</code> to reposition this apple and let it fall again (lines 13–14). If the apple was neither caught nor missed, then it’s falling and will be processed again the next time we call <code>MoveApples()</code>.</p>&#13;
<p class="indent">After moving and checking the status of the five apples, we update the message that shows the number of caught and missed apples (lines 18–19).</p>&#13;
<h4 class="h4" id="ch15lev2sec13"><em><strong>Step 5: Catch or Miss</strong></em></h4>&#13;
<p class="noindent">The last piece to add is the <code>CheckCatch()</code> subroutine in <a href="ch15.html#ch15ex8">Listing 15-8</a>.</p>&#13;
<p class="programs"> 1 <span class="purple"><span class="codestrong">Sub</span></span> CheckCatch<br/> 2   xApple <span class="brown">=</span> <span class="blue1">Shapes</span><span class="brown">.GetLeft(</span>apple[aplNum]<span class="brown">) +</span> <span class="red">32</span> <span class="green"><span class="codeitalic">' Center point</span></span><br/> 3   yApple <span class="brown">=</span> <span class="blue1">Shapes</span><span class="brown">.GetTop(</span>apple[aplNum]<span class="brown">) +</span> <span class="red">32</span>  <span class="green"><span class="codeitalic">' Bottom point</span></span><br/> 4   xCart <span class="brown">=</span> <span class="blue1">Shapes</span><span class="brown">.GetLeft(</span>cartImg<span class="brown">) +</span> <span class="red">50</span>        <span class="green"><span class="codeitalic">' Center point</span></span><br/> 5   yCart <span class="brown">=</span> <span class="blue1">Shapes</span><span class="brown">.GetTop(</span>cartImg<span class="brown">) +</span> <span class="red">40</span>         <span class="green"><span class="codeitalic">' Around the center</span></span><br/> 6   xdiff <span class="brown">=</span> <span class="blue1">Math</span><span class="brown">.Abs(</span>xApple <span class="brown">-</span> xCart<span class="brown">)</span><br/> 7   ydiff <span class="brown">=</span> <span class="blue1">Math</span><span class="brown">.Abs(</span>yApple <span class="brown">-</span> yCart<span class="brown">)</span><br/> 8   gotIt <span class="brown">=</span> <span class="red">0</span>  <span class="green"><span class="codeitalic">' Assumes we didn't get the apple</span></span><br/> 9   <span class="purple"><span class="codestrong">If</span></span> <span class="brown">((</span>xdiff <span class="brown">&lt;</span> <span class="red">20</span><span class="brown">)</span> <span class="purple"><span class="codestrong">And</span></span> <span class="brown">(</span>ydiff <span class="brown">&lt;</span> <span class="red">20</span><span class="brown">))</span> <span class="purple"><span class="codestrong">Then</span></span><br/>10     gotIt <span class="brown">=</span> <span class="red">1</span> <span class="green"><span class="codeitalic">' We got it</span></span><br/>11   <span class="purple"><span class="codestrong">EndIf</span></span><br/>12 <span class="purple"><span class="codestrong">EndSub</span></span></p>&#13;
<p class="listcap"><a id="ch15ex8"/><em>Listing 15-8: The</em> <code><span class="codeitalic">CheckCatch()</code></span> <em>subroutine</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_223"/>This subroutine checks the distance between the center of an apple (whose index is given by <code>aplNum</code>) and the center of the cart. If the apple is within 20 pixels from the cart’s center, the subroutine sets <code>gotIt</code> to 1. Otherwise, it sets <code>gotIt</code> to 0.</p>&#13;
<p class="indent">The game is now complete, and you can play it! Maybe you’ll catch enough apples for an apple pie.</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch15sb06"><strong>TRY IT OUT 15-6</strong></p>&#13;
<p class="noindent">Currently, the Catch Apples game runs forever. Think of a way to end the game, and then implement it. Can you think of some other ways to improve the game? Maybe you could give the player more points if they catch a big apple! What about the statement to move the cart inside the <code>While</code> loop? Can you move this statement to a new <code>MouseMove</code> event handler?</p>&#13;
</div>&#13;
<h3 class="h3a" id="ch15lev1sec11"><span class="blues"><strong>Programming Challenges</strong></span></h3>&#13;
<p class="noindent">If you get stuck, check out <em><a href="http://nostarch.com/smallbasic/">http://nostarch.com/smallbasic/</a></em> for the solutions and for more resources and review questions for teachers and students.</p>&#13;
<ol>&#13;
<li><p class="noindenta">Write a program that simulates rolling a die. Make the program roll a die 10,000 times and keep track of how many times each number appears. A sample run of the program follows. (Hint: use an array named <code>dice</code> that has six elements. If you get 1 in a roll, increment <code>dice[1]</code>. If you get 2, increment <code>dice[2]</code>, and so on.)</p>&#13;
<p class="programs">Num  Count  Probability<br/>1    1640   0.164<br/>2    1670   0.167<br/>3    1638   0.1638<br/>4    1684   0.1684<br/>5    1680   0.168<br/>6    1688   0.1688</p></li>&#13;
<li><p class="noindenta">Open the file <em>PinBall.sb</em> in this chapter’s folder. This program simulates a pinball machine. As shown in the following illustration, the ball is dropped at the top of the machine. As it rolls down, it strikes fixed pins <span epub:type="pagebreak" id="page_224"/>and bounces to the left or to the right in a random fashion. At the end, the ball lands in one of the seven pockets. The program drops the ball 10,000 times and counts the number of times it lands in each pocket. Study the program and explain how it works.</p>&#13;
<div class="image1"><img alt="image" src="graphics/f0224-01.jpg"/></div></li>&#13;
<li><p class="noindenta">Open the file <em>FlowerAnatomy.sb</em> from this chapter’s folder. This program presents an educational game that quizzes the player on the parts of a flower (shown next). The player enters the letters to match the labeled parts of the flower and then clicks the Check button to check the answers. The program compares the user’s answers with the correct ones; then it shows you how the user did by placing a green check mark next to each correct answer and a red X next to each incorrect answer. Study the program and explain how it works.</p>&#13;
<div class="image1"><img alt="image" src="graphics/f0224-02.jpg"/></div></li>&#13;
<li><span epub:type="pagebreak" id="page_225"/><p class="noindenta">Open the file <em>USMapQuiz_Incomplete.sb</em> from this chapter’s folder. The folder also contains the background image shown here (and the <em>Yes</em> and <em>No</em> images from the previous exercise). Complete the program to make this quiz work. Display the two-letter abbreviations for the nine states and provide nine text boxes to let the player match each state with its code.</p>&#13;
<div class="image1"><img alt="image" src="graphics/f0225-01.jpg"/></div><span epub:type="pagebreak" id="page_226"/></li>&#13;
</ol>&#13;
</body></html>