<html><head></head><body><div id="sbo-rt-content"><section>&#13;
<header>&#13;
<h1 class="chapter">&#13;
<span class="ChapterNumber"><span epub:type="pagebreak" title="41" id="Page_41"/>5</span><br/>&#13;
<span class="ChapterTitle">Double-Sealed Password</span><br/>&#13;
<span class="ChapterSubtitle">Sometimes, a set of signs such as pinching the nose or holding the ear should be used with these passwords.</span></h1></header>&#13;
<blockquote class="Epigraph" epub:type="epigraph">&#13;
<p class="Epigraph"><span class="Regular">Aikei</span> identifying signs include techniques of <span class="Regular">tachisuguri isuguri</span>—that is, standing and sitting while giving passwords.</p>&#13;
<p class="EpigraphSource">—Bansenshūkai, Yo-Nin II</p>&#13;
</blockquote>&#13;
<p class="ChapterIntro">Both <em>Bansenshūkai</em> and the <em>Gunpo Jiyoshu</em> scrolls describe an open-disguise detection protocol supposedly devised by 14th-century samurai Kusunoki Masashige.<sup class="endnote"><a id="c05-noteref-39" href="b01.xhtml#endnote-39">1</a></sup> <em>Tachisuguri isuguri</em> signal techniques use gestures, posture, or body positioning as a secret authentication factor, thus adding a layer of security to the password verification process. These techniques form what’s called a <em>double-sealing</em><sup class="endnote"><a id="c05-noteref-40" href="b01.xhtml#endnote-40">2</a></sup> password system, designed to catch disguised enemy shinobi, even if they could pass other authentication challenges with stolen passwords, identifying marks, and correct challenge response words.</p>&#13;
<p><span epub:type="pagebreak" title="42" id="Page_42"/>In the most common example of tachisuguri isuguri, a person bearing the correct uniform and crest approaches a gate for entry. Not recognizing the stranger, the guard chooses to either sit or stand, then whispers a challenge word. If the visitor is an ally who has been briefed on the tachisuguri isuguri identification protocol, they perform the prearranged corresponding action in response—a non-obvious signal such as touching their nose or ear—and whisper the matching code word. The guard permits entry only if the stranger answers with both the correct code word and the correct physical movement. (There may be multiple ways to implement tachisuguri isuguri besides having the guard stand or sit, but unfortunately those methods are believed to be recorded in the <em>Teikairon</em> scroll, a lost supplemental section of <em>Bansenshūkai</em>.)<sup class="endnote"><a id="c05-noteref-41" href="b01.xhtml#endnote-41">3</a></sup></p>&#13;
<p>The simple brilliance of this technique is that the act of standing or sitting is usually not given a passing thought. Even a malicious observer trying to impersonate authorized personnel would likely fail to notice this second, silent challenge response. They may watch 100 people enter a gate using the same passphrase while the guard sits (because he recognizes them all), and thus they will not see how the interaction differs when the guard stands. Tachisuguri isuguri was successful enough that even other shinobi did not have adequate countermeasures to thwart it, though <em>Bansenshūkai</em> instructs shinobi to mirror what guards do and say at all checkpoints, even if the guards seem to be acting without conscious intent;<sup class="endnote"><a id="c05-noteref-42" href="b01.xhtml#endnote-42">4</a></sup> if nothing else, this could confuse the guard into believing the shinobi is disorganized or simply stupid. The scrolls also provide this helpful advice to any shinobi who fails an unknown tachisuguri isuguri challenge: either think fast and talk fast—or run for your life.<sup class="endnote"><a id="c05-noteref-43" href="b01.xhtml#endnote-43">5</a></sup></p>&#13;
<p>While the shinobi scrolls are not explicit in their definition of <em>double-sealing</em> and I have no evidence that the following hypothetical example actually occurred, I still feel it’s a plausible illustration of the concept. Seals, often impressed into wax, have been used since ancient times to secure the content of a letter or scroll. Ideally, each sender of communications had a unique metal stamp and so was the only person who could make a particular mark, thus verifying a document’s authenticity. In addition, if anyone other than the intended recipient were to open the letter or scroll, the seal would break, indicating that tampering had taken place. </p>&#13;
<p>However, spies learned that with special heating techniques, they could loosen the wax, remove the seal intact without harming the paper, read the missive’s contents, and then reseal the original document or affix the seal to a newly forged document that included misinformation. A counter to the technique of melting the paper side of the wax seal may have been to “double-seal” the wax. Imagine that instead of a single metal <span epub:type="pagebreak" title="43" id="Page_43"/>stamp, the author used a clamp or vice-like device with both a front and back stamp. The underside of the wax wafer would be given a hidden seal on the underside of the paper that could be inspected only by ripping the document open. Attempts at melting the seal off the paper might preserve the top seal but would destroy the second hidden seal, thus making the communication double-sealed.</p>&#13;
<p>You can see why double-sealing was adopted as an effective countermeasure against attempts to penetrate a single seal and how it helped detect the activity of enemy shinobi. In this chapter, I will note the difference between two-factor authentication and second-step authentication. I’ll also discuss how a modern second-step authenticator could be double-sealed to improve its effectiveness. I will then describe what I believe are the requirements and criteria for implementing double-sealed passwords, along with implementations that use existing authenticators and technology. My hope is that after performing the thought exercises and seeing my examples for implementations of double-sealed passwords, you will appreciate the genius of Kusunoki Masashige and try this highly intuitive idea out yourself.</p>&#13;
<h2 id="h1-500549c05-0001">A Concealed 2-Step Authentication</h2>&#13;
<p class="BodyFirst">Increasingly, more cyber authentication and identification protocols require a layer of security on top of a password. This is called <em>2-step authentication</em>: the second step requires a user to perform an additional authentication action, such as providing a secret code or clicking a button on an <em>out-of-band</em> <em>device</em> (that is, one not involved in the rest of the authentication process). Note the slight difference from last chapter’s two-<em>factor</em> authentication, which is used to prevent an adversary from accessing an account with stolen login credentials.</p>&#13;
<p>While the secret code (second step) can be randomized through software applications, it is typically generated each time using the same procedure. Unfortunately, this procedural rigidity gives adversaries a number of opportunities to compromise 2-step authentication methods. For example, a 2-step authentication code is typically sent in a cleartext, unsecured message that can be intercepted via phone cloning. In this case, a user who receives the code 12345 and enters that sequence at the passcode prompt also inadvertently provides the code to the adversary. The device used to authenticate—often a phone—can be stolen, hijacked via call forwarding, or cloned and used by the adversary to complete the authentication. Similarly, the out-of-band device established for delivering 2-step codes could be lost or stolen and used to bypass the authentication process, allowing the adversary to steal user-provided backup codes.</p>&#13;
<p><span epub:type="pagebreak" title="44" id="Page_44"/>A 2-step code that was double-sealed with a tachisuguri isuguri technique could mitigate some of the weaknesses inherent in authentication procedures. Each user should be able to establish a prearranged tachisuguri isuguri identifier that is unique and meaningful to them. For instance, suppose a user has been instructed, either orally or by another secure method, to transpose the digits in their 2-step code across the number 5 on the keypad—1 becomes 9, 2 becomes 8, and so on<sup class="endnote"><a id="c05-noteref-44" href="b01.xhtml#endnote-44">6</a></sup>—but only when the code displays in red font rather than the normal green. This color change is the silent tachisuguri isuguri factor, triggered when the system finds the authentication request suspicious due to the odd hour, an unrecognized device or different IP address making the request, or other criteria. (To conceal it from adversaries who may be observing logins, this protocol should not be used too frequently.) Now, when the legitimate user receives the red code 12345, they know to respond 98765, while an adversary who has stolen the user’s credentials but is not aware of the concealed rule enters 12345. This halts the authentication process, flags the account for investigation, and adds a 2-step authentication failure to the session. The 2-step authenticator then sends a hint—“Use authenticator protocol #5,” perhaps along with another red code, such as 64831 (to which the user should respond 46279). Another incorrect response triggers further alerts or account lockout.</p>&#13;
<h2 id="h1-500549c05-0002">Developing Double-Sealed Passwords</h2>&#13;
<p class="BodyFirst">A double-sealed security solution that integrates with industry-standard authorization controls would do the following:</p>&#13;
<ol class="decimal">&#13;
<li value="1">Be used only when the user’s identity is suspect, such as when users:&#13;
<ul>&#13;
<li>Log in from a new device, location, IP address, or time window</li>&#13;
<li>Report that their mobile device has been stolen or compromised</li>&#13;
<li>Lose their backup token, code, or password and need to reset their password</li>&#13;
</ul></li>&#13;
<li value="2">Use an out-of-band or side-channel communication method.</li>&#13;
<li value="3">Use a secret, rule-based knowledge factor. Each user should be able to customize the protocol to create a unique set of concealed rules.</li>&#13;
<li value="4">Leverage authentication factors that are easy to understand and remember, yet not obvious.</li>&#13;
<li value="5">Allow rules to be stacked on top of each other in the case of wrong consecutive guesses or enough time passing between authentication attempts.</li>&#13;
<li value="6"><span epub:type="pagebreak" title="45" id="Page_45"/>Enable the restriction, freezing, or locking out of an account that has failed authentication too many times. Most applications have a lockout after consecutive wrong passwords but not consecutive wrong 2-step authentication attempts.</li>&#13;
<li value="7">Not be described in any help desk SOPs or other documentation. Employees should also refrain from talking openly about the double-sealed security layer.</li>&#13;
</ol>&#13;
<p>Popularizing double-sealed security requires designers, engineers, and users to explore what is technically feasible and apply creative thinking. For example, consider the various input variations that can be used on existing mobile devices with a 2-step authentication app and require only that the user press Yes or No buttons to verify their identity. Following are some examples to demonstrate the range of possible responses when the user is given the tachisuguri isuguri signal in their 2-step authentication app:</p>&#13;
<ol class="decimal">&#13;
<li value="1">The user rotates their screen upside down before selecting Yes, and the app performs a silent inspection of the DeviceOrientation status to test whether it equals <code>portraitUpsideDown</code>.</li>&#13;
<li value="2">The user manipulates the physical volume buttons on the mobile device to set the <code>OutputVolume</code> to 0.0 (silent) or 1.0 (max) before selecting Yes, and the app performs a silent get of the volume float value to test whether it matches the intended value.</li>&#13;
<li value="3">The user waits to select Yes until they observe the mobile device clock roll over to the next minute, when they immediately select Yes. The app performs a silent timestamp request to compare the time of selection to HH:MM:0<em>X</em>, where <em>X</em> is less than 3 seconds.</li>&#13;
<li value="4">The user uses excessive pressure when selecting Yes on the mobile device, and the app performs a silent get of the <code>UITouch.force</code> of the event to determine whether it was greater than a preset threshold. </li>&#13;
<li value="5">The user performs multiple quick taps of the Yes button on the mobile device, and the app performs a silent get of the <code>tapCount</code> of the <code>UIEvent</code> to determine if it is less than 2.</li>&#13;
<li value="6">The user performs a gesture while selecting the Yes button on the mobile device, and the app performs a silent get of the <code>UIGestureRecognizer</code> to determine whether it was a <code>Pinch</code>, <code>LongPress</code>, <code>Swipe</code> (up, down, left, right), or <code>Rotation</code>.&#13;
<aside epub:type="sidebar">&#13;
<div class="top hr"><hr/></div>&#13;
<section class="box">&#13;
<h2><span epub:type="pagebreak" title="46" id="Page_46"/>Castle Theory Thought Exercise</h2>&#13;
<p class="BoxBodyFirst">Consider the scenario in which you are the ruler of a medieval castle with valuable assets within your stronghold. You’ve been told that your identifying marks, crests, secret signals, and other identification methods have been disclosed to enemy shinobi, who can replicate them and gain entry to your castle. You already change these passwords and signs three times a day, but you are told that shinobi can keep up with these changes, even though you are unsure how.</p>&#13;
<p>Consider how you might implement tachisuguri isuguri to catch enemy shinobi. Could you create nonbinary tachisuguri isuguri—in other words, concealed rules more complex than sitting or standing? How would you protect the tachisuguri isuguri authentication process to prevent the enemy shinobi from learning it? How could you layer tachisuguri isuguri to perform a test for operational security leaks among your personnel?</p>&#13;
<div class="bottom hr"><hr/></div>&#13;
</section>&#13;
</aside></li>&#13;
</ol>&#13;
<h2 id="h1-500549c05-0003">Recommended Security Controls and Mitigations</h2>&#13;
<p class="BodyFirst">Where relevant, recommendations are presented with an applicable security control from the NIST 800-53 standard. Each should be evaluated in terms of 2-step (double-sealed) authentication.</p>&#13;
<ol class="decimal">&#13;
<li value="1">Utilize Out-of-Band Authentication (OOBA) through a separate communication path to verify that authentication requests originate from verified users. [IA-2: Identification and Authentication | (13) Out-Of-Band Authentication]</li>&#13;
<li value="2">Ensure that staff do not disclose the existence of concealed rules for 2-step authentication. [IA-5: Authenticator Management | (6) Protection of Authenticators]</li>&#13;
<li value="3">Establish multiple double-sealed rules so the tachisuguri isuguri is not static. [IA-5: Authenticator Management | (7) No Embedded Unencrypted Static Authenticators]</li>&#13;
<li value="4">Implement out-of-band communication and establish double-sealed rules to maintain confidentiality. [SC-37: Out-Of-Band Channels]</li>&#13;
<li value="5">Carefully design error messages for failed authentication attempts so they do not reveal double-sealed password information that an adversary could exploit. [SI-11: Error Handling]</li>&#13;
</ol>&#13;
<h2 id="h1-500549c05-0004"><span epub:type="pagebreak" title="47" id="Page_47"/>Debrief</h2>&#13;
<p class="BodyFirst">In this chapter, you learned about an anti-shinobi authentication technique called the double-sealed password or tachisuguri isuguri. We covered the distinction between factors and steps in the identity verification process. Then we undertook a brief analysis of the criteria for a good tachisuguri isuguri authenticator along with several examples.</p>&#13;
<p>In the following chapter, we will discuss a shinobi concept called the hours of infiltration.  You’ll learn how certain hours of the day provide advantageous opportunities for infiltration. Understanding these time-based opportunities may help you choose when to implement or trigger tachisuguri isuguri authenticators in your organization, such as only during certain hours or on specific dates, to minimize the use of tachisuguri isuguri and safeguard its secrecy.</p>&#13;
</section>&#13;
</div></body></html>