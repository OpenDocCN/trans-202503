<html><head></head><body>
<h2 class="h2" id="ch12"><span epub:type="pagebreak" id="page_111"/><strong><span class="big">12</span><br/>THE NORMAL DISTRIBUTION</strong></h2>&#13;
<div class="image1"><img alt="Image" src="../images/common.jpg"/></div>&#13;
<p class="noindent">In the previous two chapters, you learned about two very important concepts: mean (μ), which allows us to estimate a measurement from various observations, and standard deviation (σ), which allows us to measure the spread of our observations.</p>&#13;
<p class="indent">On its own, each concept is useful, but together, they are even more powerful: we can use them as parameters for the most famous probability distribution of all, the <em>normal distribution</em>.</p>&#13;
<p class="indent">In this chapter you’ll learn how to use the normal distribution to determine an exact probability for your degree of certainty about one estimate proving true compared to others. The true goal of parameter estimation isn’t simply to estimate a value, but rather to assign a probability for a <em>range</em> of possible values. This allows us to perform more sophisticated reasoning with uncertain values.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_112"/>We established in the preceding chapter that the mean is a solid method of estimating an unknown value based on existing data, and that the standard deviation can be used to measure the spread of that data. By measuring the spread of our observations, we can determine how confidently we believe in our mean. It makes sense that the more spread out our observations, the less sure we are in our mean. The normal distribution allows us to precisely quantify <em>how</em> certain we are in various beliefs when taking our observations into account.</p>&#13;
<h3 class="h3" id="ch12lev1sec1"><strong>Measuring Fuses for Dastardly Deeds</strong></h3>&#13;
<p class="noindent">Imagine a mustachioed cartoon villain wants to set off a bomb to blow a hole in a bank vault. Unfortunately, he has only one bomb, and it’s rather large. He knows that if he gets 200 feet away from the bomb, he can escape to safety. It takes him 18 seconds to make it that far. If he’s any closer to the bomb, he risks death.</p>&#13;
<p class="indent">Although the villain has only one bomb, he has six fuses of equal size, so he decides to test out five of the six fuses, saving the last one for the bomb. The fuses are all the same size and should take the same amount of time to burn through. He sets off each fuse and measures how long it takes to burn through to make sure he has the 18 seconds he needs to get away. Of course, being in a rush leads to some inconsistent measurements. Here are the times he recorded (in seconds) for each fuse to burn through: 19, 22, 20, 19, 23.</p>&#13;
<p class="indent">So far so good: none of the fuses takes less than 18 seconds to burn. Calculating the mean gives us μ = 20.6, and calculating the standard deviation gives us σ = 1.62.</p>&#13;
<p class="indent">But now we want to determine a concrete probability for how likely it is that, given the data we have observed, a fuse will go off in <em>less</em> than 18 seconds. Since our villain values his life even more than the money, he wants to be 99.9 percent sure he’ll survive the blast, or he won’t attempt the heist.</p>&#13;
<p class="indent">In <a href="ch10.xhtml#ch10">Chapter 10</a>, you learned that the mean is a good estimate for the true value given a set of measurements, but we haven’t yet come up with any way to express how <em>strongly</em> we believe this value to be true.</p>&#13;
<p class="indent">In <a href="ch11.xhtml#ch11">Chapter 11</a>, you learned that you can quantify how spread out your observations are by calculating the standard deviation. It seems rational that this might also help us figure out how likely the alternatives to our mean might be. For example, suppose you drop a glass on the floor and it shatters. When you’re cleaning up, you might search adjacent rooms based on how dispersed the pieces of glass are. If, as shown in <a href="ch12.xhtml#ch12fig01">Figure 12-1</a>, the pieces are very close together, you would feel more confident that you don’t need to check for glass in the next room.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_113"/><a id="ch12fig01"/><img alt="Image" src="../images/12fig01.jpg"/></div>&#13;
<p class="figcap"><em>Figure 12-1: When the broken pieces are closer together, you’re more sure of where to clean up.</em></p>&#13;
<p class="indent">However, if the glass pieces are widely dispersed, as in <a href="ch12.xhtml#ch12fig02">Figure 12-2</a>, you’ll likely want to sweep around the entrance of the next room, even if you don’t immediately see broken glass there. Likewise, if the villain’s fuse timings are very spread out, even if he didn’t observe any fuses lasting less than 18 seconds, it’s possible that the real fuse could still burn through in less than 18 seconds.</p>&#13;
<div class="image"><a id="ch12fig02"/><img alt="Image" src="../images/12fig02.jpg"/></div>&#13;
<p class="figcap"><em>Figure 12-2: When the pieces are spread out, you’re less sure of where they might be.</em></p>&#13;
<p class="indent">When observations are scattered visually, we intuitively feel that there might be other observations at the extreme limits of what we can see. We <span epub:type="pagebreak" id="page_114"/>are also less confident in exactly where the center is. In the glass example, it’s harder to be sure of where the glass fell if you weren’t there to witness the fall and the glass fragments are dispersed widely.</p>&#13;
<p class="indent">We can quantify this intuition with the most studied and well-known probability distribution: the normal distribution.</p>&#13;
<h3 class="h3" id="ch12lev1sec2"><strong>The Normal Distribution</strong></h3>&#13;
<p class="noindent">The normal distribution is a continuous probability distribution (like the beta distribution in <a href="ch05.xhtml#ch05">Chapter 5</a>) that best describes the strength of possible beliefs in the value of an uncertain measurement, given a known mean and standard deviation. It takes μ and σ (the mean and standard deviation, respectively) as its only two parameters. A normal distribution with μ = 0 and σ = 1 has a bell shape, as shown in <a href="ch12.xhtml#ch12fig03">Figure 12-3</a>.</p>&#13;
<div class="image"><a id="ch12fig03"/><img alt="Image" src="../images/12fig03.jpg"/></div>&#13;
<p class="figcap"><em>Figure 12-3: A normal distribution with μ = 0 and σ = 1</em></p>&#13;
<p class="indent">As you can see, the center of the normal distribution is its mean. The width of a normal distribution is determined by its standard deviation. <a href="ch12.xhtml#ch12fig04">Figures 12-4</a> and <a href="ch12.xhtml#ch12fig05">12-5</a> show normal distributions with μ = 0 and σ = 0.5 and 2, respectively.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_115"/><a id="ch12fig04"/><img alt="Image" src="../images/12fig04.jpg"/></div>&#13;
<p class="figcap"><em>Figure 12-4: A normal distribution with μ = 0 and σ = 0.5</em></p>&#13;
<div class="image"><a id="ch12fig05"/><img alt="Image" src="../images/12fig05.jpg"/></div>&#13;
<p class="figcap"><em>Figure 12-5: A normal distribution with μ = 0 and σ = 2</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_116"/>As the standard deviation shrinks, so does the width of the normal distribution.</p>&#13;
<p class="indent">The normal distribution, as we’ve discussed, reflects how strongly we believe in our mean. So, if our observations are more scattered, we believe in a wider range of possible values and have less confidence in the central mean. Conversely, if all of our observations are more or less the same (meaning a small σ), we believe our estimate is pretty accurate.</p>&#13;
<p class="indent">When the <em>only</em> thing we know about a problem is the mean and standard deviation of the data we have observed, the normal distribution is the most honest representation of our state of beliefs.</p>&#13;
<h3 class="h3" id="ch12lev1sec3"><strong>Solving the Fuse Problem</strong></h3>&#13;
<p class="noindent">Going back to our original problem, we have a normal distribution with μ = 20.6 and σ = 1.62. We don’t really know anything else about the properties of the fuses beyond the recorded burn times, so we can model the data with a normal distribution using the observed mean and standard deviation (see <a href="ch12.xhtml#ch12fig06">Figure 12-6</a>).</p>&#13;
<div class="image"><a id="ch12fig06"/><img alt="Image" src="../images/12fig06.jpg"/></div>&#13;
<p class="figcap"><em>Figure 12-6: A normal distribution with μ = 20.6 and σ = 1.62</em></p>&#13;
<p class="indent">The question we want to answer is: what is the probability, given the data observed, that the fuse will run for 18 seconds or less? To solve this problem, we need to use the probability density function (PDF), a concept you first learned about in <a href="ch05.xhtml#ch05">Chapter 5</a>. The PDF for the normal distribution is:</p>&#13;
<div class="equ-image"><img alt="Image" src="../images/f0116-01.jpg"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_117"/>And to get the probability, we need to <em>integrate</em> this function over values less than 18:</p>&#13;
<div class="equ-image"><img alt="Image" src="../images/f0117-01.jpg"/></div>&#13;
<p class="indent">You can imagine integration as simply taking the area under the curve for the region you’re interested in, as shown in <a href="ch12.xhtml#ch12fig07">Figure 12-7</a>.</p>&#13;
<div class="image"><a id="ch12fig07"/><img alt="Image" src="../images/12fig07.jpg"/></div>&#13;
<p class="figcap"><em>Figure 12-7: The area under the curve that we’re interested in</em></p>&#13;
<p class="indent">The area of the shaded region represents the probability of the fuse lasting 18 seconds or less given the observations. Notice that even though none of the observed values was less than 18, because of the spread of the observations, the normal distribution in <a href="ch12.xhtml#ch12fig06">Figure 12-6</a> shows that a value of 18 or less is still possible. By integrating over all values less than 18, we can calculate the probability that the fuse will <em>not</em> last as long as our villain needs it to.</p>&#13;
<p class="indent">Integrating this function by hand is not an easy task. Thankfully, we have R to do the integration for us.</p>&#13;
<p class="indent">Before we do this, though, we need to determine what number to start integrating from. The normal distribution is defined on the range of all possible values from negative infinity (–∞) to infinity (∞). So in theory what we want is:</p>&#13;
<div class="equ-image"><img alt="Image" src="../images/f0117-02.jpg"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_118"/>But obviously we cannot integrate our function from negative infinity on a computer! Luckily, as you can see in <a href="ch12.xhtml#ch12fig06">Figures 12-6</a> and <a href="ch12.xhtml#ch12fig07">12-7</a>, the probability density function becomes an incredibly small value very quickly. We can see that the line in the PDF is nearly flat at 10, meaning there is virtually no probability in this region, so we can just integrate from 10 to 18. We could also choose a lower value, like 0, but because there’s effectively no probability in this region, it won’t change our result in any meaningful way. In the next section, we’ll discuss a heuristic that makes choosing a lower or upper bound easier.</p>&#13;
<p class="indent">We’ll integrate this function using R’s <span class="literal">integrate()</span> function and the <span class="literal">dnorm()</span> function (which is just R’s function for the normal distribution PDF), calculating the PDF of the normal distribution as follows:</p>&#13;
<p class="programs"><span class="codestrong1">integrate(function(x) dnorm(x,mean=20.6,sd=1.62),10,18)</span><br/>&#13;
0.05425369 with absolute error &lt; 3e-11</p>&#13;
<p class="indent">Rounding the value, we can see that <em>P</em>(fuse time &lt; 18) = 0.05, telling us there is a 5 percent chance that the fuse will last 18 seconds or less. Even villains value their own lives, and in this case our villain will attempt the bank robbery only if he is 99.9 percent sure that he can safely escape the blast. For today then, the bank is safe!</p>&#13;
<p class="indent">The power of the normal distribution is that we can reason probabilistically about a wide range of possible alternatives to our mean, giving us an idea of how realistic our mean is. We can use the normal distribution any time we want to reason about data for which we know only the mean and standard deviation.</p>&#13;
<p class="indent">However, this is also the danger of the normal distribution. In practice, if you have information about your problem besides the mean and standard deviation, it is usually best to make use of that. We’ll see an example of this in a later section.</p>&#13;
<h3 class="h3" id="ch12lev1sec4"><strong>Some Tricks and Intuitions</strong></h3>&#13;
<p class="noindent">While R makes integrating the normal distribution significantly easier than trying to solve the integral by hand, there’s a very useful trick that can simplify things even further when you’re working with the normal distribution. For <em>any</em> normal distribution with a known mean and standard deviation, you can estimate the area under the curve around μ in terms of σ.</p>&#13;
<p class="indent">For example, the area under the curve for the range from μ – σ (one standard deviation less than the mean) to μ + σ (one standard deviation greater than the mean) holds 68 percent of the mass of the distribution.</p>&#13;
<p class="indent">This means that 68 percent of the possible values fall within ± one standard deviation of the mean, as shown in <a href="ch12.xhtml#ch12fig08">Figure 12-8</a>.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_119"/><a id="ch12fig08"/><img alt="Image" src="../images/12fig08.jpg"/></div>&#13;
<p class="figcap"><em>Figure 12-8: Sixty-eight percent of the probability density (area under the curve) lies between one standard deviation of the mean in either direction.</em></p>&#13;
<p class="indent">We can continue by increasing our distance from the mean by multiples of σ. <a href="ch12.xhtml#ch12tab01">Table 12-1</a> gives probabilities for these other areas.</p>&#13;
<p class="tabcap" id="ch12tab01"><strong>Table 12-1:</strong> Areas Under the Curve for Different Means</p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:70%"/>&#13;
<col style="width:30%"/>&#13;
</colgroup>&#13;
<thead>&#13;
<tr>&#13;
<td class="table-h" style="vertical-align: top;"><p class="tab_th"><strong>Distance from the mean</strong></p></td>&#13;
<td class="table-h" style="vertical-align: top;"><p class="tab_th"><strong>Probability</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td class="table-b" style="vertical-align: top;"><p class="taba">σ</p></td>&#13;
<td class="table-b" style="vertical-align: top;"><p class="taba">68 percent</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-b" style="vertical-align: top;"><p class="taba">2σ</p></td>&#13;
<td class="table-b" style="vertical-align: top;"><p class="taba">95 percent</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-ba" style="vertical-align: top;"><p class="taba">3σ</p></td>&#13;
<td class="table-ba" style="vertical-align: top;"><p class="taba">99.7 percent</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent">This little trick is very useful for quickly assessing the likelihood of a value given even a small sample. All you need is a calculator to easily figure out the μ and σ, which means you can do some pretty accurate estimations even in the middle of a meeting!</p>&#13;
<p class="indent">As an example, when measuring snowfall in <a href="ch10.xhtml#ch10">Chapter 10</a> we had the following measurements: 6.2, 4.5, 5.7, 7.6, 5.3, 8.0, 6.9. For these measurements, the mean is 6.31 and the standard deviation is 1.17. This means that we can be 95 percent sure that the true value of the snowfall was somewhere between 3.97 inches (6.31 – 2 × 1.17) and 8.65 inches (6.31 + 2 × 1.17). No need to manually calculate an integral or boot up a computer to use R!</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_120"/>Even when we <em>do</em> want to use R to integrate, this trick can be useful for determining a minimum or maximum value to integrate from or to. For example, if we want to know the probability that the villain’s bomb fuse will last longer than 21 seconds, we don’t want to have to integrate from 21 to infinity. What can we use for our upper bound? We can integrate from 21 to 25.46 (which is 20.6 + 3 × 1.62), which is 3 standard deviations from our mean. Being three standard deviations from the mean will account for 99.7 percent of our total probability. The remaining 0.3 percent lies on either side of the distribution, so only half of that, 0.15 percent of our probability density, lies in the region greater than 25.46. So if we integrate from 21 to 25.46, we’ll only be missing a tiny amount of probability in our result. Clearly, we could easily use R to integrate from 21 to something really safe such as 30, but this trick allows us to figure out what “really safe” means.</p>&#13;
<h3 class="h3" id="ch12lev1sec5"><strong>“N Sigma” Events</strong></h3>&#13;
<p class="noindent">You may have heard an event being described in terms of <em>sigma events</em>, such as “the fall of the stock price was an eight-sigma event.” What this expression means is that the observed data is eight standard deviations from the mean. We saw the progression of one, two, and three standard deviations from the mean in <a href="ch12.xhtml#ch12tab01">Table 12-1</a>, which were values at 68, 95, and 99.7 percent, respectively. You can easily intuit from this that an eight-sigma event must be extremely unlikely. In fact, if you ever observe data that is five standard deviations from the mean, it’s likely a good sign that your normal distribution is not modeling the underlying data accurately.</p>&#13;
<p class="indent">To show the growing rarity of an event as it increases by <em>n</em> sigma, say you are looking at events you might observe on a given day. Some are very common, such as waking up to the sunrise. Others are less common, such as waking up and it being your birthday. <a href="ch12.xhtml#ch12tab02">Table 12-2</a> shows how many days it would take to expect the event to happen per one sigma increase.</p>&#13;
<p class="tabcap" id="ch12tab02"><strong>Table 12-2:</strong> Rarity of an Event as It Increases by <em>n</em> Sigma</p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:65%"/>&#13;
<col style="width:35%"/>&#13;
</colgroup>&#13;
<thead>&#13;
<tr>&#13;
<td class="table-h" style="vertical-align: top;"><p class="tab_th"><strong>(–/+) Distance from the mean</strong></p></td>&#13;
<td class="table-h" style="vertical-align: top;"><p class="tab_th"><strong>Expected every . . .</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td class="table-v" style="vertical-align: top;"><p class="taba">σ</p></td>&#13;
<td class="table-v" style="vertical-align: top;"><p class="taba">3 days</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-b" style="vertical-align: top;"><p class="taba">2σ</p></td>&#13;
<td class="table-b" style="vertical-align: top;"><p class="taba">3 weeks</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-v" style="vertical-align: top;"><p class="taba">3σ</p></td>&#13;
<td class="table-v" style="vertical-align: top;"><p class="taba">1 year</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-b" style="vertical-align: top;"><p class="taba">4σ</p></td>&#13;
<td class="table-b" style="vertical-align: top;"><p class="taba">4 decades</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-v" style="vertical-align: top;"><p class="taba">5σ</p></td>&#13;
<td class="table-v" style="vertical-align: top;"><p class="taba">5 millennia</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="table-ba" style="vertical-align: top;"><p class="taba">6σ</p></td>&#13;
<td class="table-ba" style="vertical-align: top;"><p class="taba">1.4 million years</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent">So a three-sigma event is like waking up and realizing it’s your birthday, but a six-sigma event is like waking up and realizing that a giant asteroid is crashing toward earth!</p>&#13;
<h3 class="h3" id="ch12lev1sec6"><span epub:type="pagebreak" id="page_121"/><strong>The Beta Distribution and the Normal Distribution</strong></h3>&#13;
<p class="noindent">You may remember from <a href="ch05.xhtml#ch05">Chapter 5</a> that the beta distribution allows us to estimate the true probability given that we have observed α desired outcomes and β undesired outcomes, where the total number of outcomes is α + β. Based on that, you might take some issue with the notion that the normal distribution is truly the best method to model parameter estimation given that we know only the mean and standard deviation of any given data set. After all, we could describe a situation where α = 3 and β = 4 by simply observing three values of 1 and four values of 0. This would give us μ = 0.43 and σ = 0.53. We can then compare the beta distribution with α = 3 and β = 4 to a normal distribution with μ = 0.43 and σ = 0.53, as shown in <a href="ch12.xhtml#ch12fig09">Figure 12-9</a>.</p>&#13;
<div class="image"><a id="ch12fig09"/><img alt="Image" src="../images/12fig09.jpg"/></div>&#13;
<p class="figcap"><em>Figure 12-9: Comparing the beta distribution to the normal distribution</em></p>&#13;
<p class="indent">It’s clear that these distributions are quite different. We can see that for both distributions the center of mass appears in roughly the same place, but the bounds for the normal distribution extend way beyond the limits of our graph. This demonstrates a key point: only when you know nothing about the data other than its mean and variance is it safe to assume a normal distribution.</p>&#13;
<p class="indent">For the beta distribution, we know that the value we’re looking for must lie in the range 0 to 1. The normal distribution is defined from –∞ to ∞, which often includes values that cannot possibly exist. However, in most cases this is not practically important because measurements out that far <span epub:type="pagebreak" id="page_122"/>are essentially impossible in probabilistic terms. But for our example of measuring the probability of an event happening, this missing information is important for modeling our problem.</p>&#13;
<p class="indent">So, while the normal distribution is a very powerful tool, it is no substitute for having more information about a problem.</p>&#13;
<h3 class="h3" id="ch12lev1sec7"><strong>Wrapping Up</strong></h3>&#13;
<p class="noindent">The normal distribution is an extension of using the mean for estimating a value from observations. The normal distribution combines the mean and the standard deviation to model how spread out our observations are from the mean. This is important because it allows us to reason about the error in our measurements in a probabilistic way. Not only can we use the mean to make our best guess, but we can also make probabilistic statements about ranges of possible values for our estimate.</p>&#13;
<h3 class="h3" id="ch12lev1sec8"><strong>Exercises</strong></h3>&#13;
<p class="noindent">Try answering the following questions to see how well you understand the normal distribution. The solutions can be found at <em><a href="https://nostarch.com/learnbayes/">https://nostarch.com/learnbayes/</a></em>.</p>&#13;
<ol>&#13;
<li class="noindent">What is the probability of observing a value five sigma greater than the mean or more?</li>&#13;
<li class="noindent">A fever is any temperature greater than 100.4 degrees Fahrenheit. Given the following measurements, what is the probability that the patient has a fever?&#13;
<p class="equ">100.0, 99.8, 101.0, 100.5, 99.7</p></li>&#13;
<li class="noindent">Suppose in <a href="ch11.xhtml#ch11">Chapter 11</a> we tried to measure the depth of a well by timing coin drops and got the following values:&#13;
<p class="equ">2.5, 3, 3.5, 4, 2</p>&#13;
<p class="indent">The distance an object falls can be calculated (in meters) with the following formula:</p>&#13;
<p class="equ">distance = 1/2 × G × time<sup>2</sup></p>&#13;
<p class="indent">where G is 9.8 m/s/s. What is the probability that the well is over 500 meters deep?</p></li>&#13;
<li class="noindent">What is the probability there is no well (i.e., the well is really 0 meters deep)? You’ll notice that probability is higher than you might expect, given your observation that there <em>is</em> a well. There are two good explanations for this probability being higher than it should. The first is that the normal distribution is a poor model for our measurements; the second is that, when making up numbers for an example, I chose values that you likely wouldn’t see in real life. Which is more likely to you?</li>&#13;
</ol>&#13;
</body></html>