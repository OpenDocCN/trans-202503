<html><head></head><body>
<h2 class="h2" id="ch05"><span epub:type="pagebreak" id="page_29"/>—5—<br/>Binary Search for a Smuggler’s Ship</h2>&#13;
<p class="noindent">The port of Usb was little more than a fishing village. A dozen weathered buildings clustered around the end of a single long pier. A few pockets of meager activity surrounded the most recent arrivals, but otherwise the town was reassuringly quiet.</p>&#13;
<p class="indent">Frank headed straight for the Crab’s Pinch, a fisherman’s bar renowned for its clam chowder and Wednesday night sea shanty contests. With any luck, one of his contacts would turn up before the day was out. After all, the Crab’s Pinch was the only place to go in Usb. So Frank planted himself at a table in the back corner, ordered the chowder, and waited.</p>&#13;
<p class="indent">It wasn’t long before a freelance smuggler named Mavis entered the dank little bar. Careful by nature, Mavis had never technically been convicted of a crime, though it was well-known that she’d once set her own ship on fire to destroy evidence. Frank got along with her well enough, at least once he’d left the force, and they even exchanged the occasional scrap of information.</p>&#13;
<p class="indent">Frank, having nursed his chowder for a solid hour, finally pushed away his bowl and motioned to Mavis. She hesitated a moment by the door before jostling her way through the bar.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_30"/><img src="../images/f0030-01.jpg" alt="image"/></div>&#13;
<p class="indent">“Mavis,” said Frank as she joined him in the corner, “how are you?”</p>&#13;
<p class="indent">“I was doing a lot better 10 minutes ago,” she spat.</p>&#13;
<p class="indent">Before Frank could ask, Officer Notation strode through the door and held up her hands. “Ladies and gentlemen,” she called. “If I could have your attention for a moment. I’m looking for a cart that came through here two nights ago.”</p>&#13;
<p class="indent">Frank cursed under his breath. So much for his lead.</p>&#13;
<p class="indent">“I come in from the dawn run, hoping for a bowl of hot chowder and a few minutes of peace,” Mavis complained. “Instead I get this copper clammering about donkey carts.”</p>&#13;
<p class="indent">Frank laughed dryly. “And until she goes away, you can’t unload your cargo. Right?”</p>&#13;
<p class="indent">Mavis scowled at him but didn’t object. Usb had never found success in either the fishing or shipping industries. The port did, <span epub:type="pagebreak" id="page_31"/>however, appeal to those criminals concerned with moving merchandise without dealing with nosy government officials. Frank would wager a month’s rent that there wasn’t a single ship at dock that wasn’t smuggling something.</p>&#13;
<p class="indent">“Do you know anything about the cart?” Frank dropped his voice to just above a whisper.</p>&#13;
<p class="indent">Mavis shrugged. “There’s always carts on the docks. This is a port, Frank. People move things.”</p>&#13;
<p class="indent">“This is a special cart,” Frank pressed. “A bunch of individual animal pens, like a giant array on wheels.”</p>&#13;
<p class="indent">“Sounds fancy,” said Mavis. “But I haven’t heard of any ships moving animals. I might have heard a rumor about a crate or two of miniature turtles, but nothing large enough to need a pen. You sure it came through here?”</p>&#13;
<p class="indent">Frank nodded. The smell had been like a fish-scented air freshener in an outhouse, and few places smelled as bad as Usb.</p>&#13;
<p class="indent">“Anybody casting off at that time?” he asked. If the thieves had transported the stolen documents this far, they wouldn’t have waited around.</p>&#13;
<p class="indent">“Only the <em>Retry Loop</em>,” said Mavis. “And I’m only telling you that because it’s public knowledge. I don’t know what it was carrying, and I don’t care.”</p>&#13;
<p class="indent">“Do you know when it returns?” asked Frank.</p>&#13;
<p class="indent">“Got back into port 19 hours ago,” replied Mavis. “Don’t know what it was carrying then either.”</p>&#13;
<p class="indent">Frank smiled widely. “Sounds like it’s time for me to take a stroll around town,” he said.</p>&#13;
<p class="indent">Mavis smiled halfheartedly at him and turned to flag down a waiter.</p>&#13;
<p class="indent">Frank made it less than 20 meters down the pier before Officer Notation marched up beside him.</p>&#13;
<p class="indent">“Mr. Runtime, this is my investigation,” she began. “If you have information—”</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_32"/>Frank stopped, causing her to pull up short. “What exactly are you investigating, Officer?” he asked.</p>&#13;
<p class="indent">It was better than Frank had hoped. Notation opened and closed her mouth a few times as a red flush spread up her neck.</p>&#13;
<p class="indent">“The captain doesn’t know you’re here, does he?” Frank asked. “This isn’t exactly an <em>official</em> investigation.”</p>&#13;
<p class="indent">“I don’t know what you’re—” started Officer Notation, but Frank cut her off.</p>&#13;
<p class="indent">“Cut the act,” he said. “The fact you’re out here alone is all the proof I need. You’re running this investigation on your own time. The question is, why?”</p>&#13;
<p class="indent">The flush had now finished its ascent of Officer Notation’s face. Her ears burned a particularly vivid shade of red.</p>&#13;
<p class="indent">“That’s none of your concern,” she said.</p>&#13;
<p class="indent">“It is when the captain comes to me because he can’t trust his own officers,” Frank replied calmly.</p>&#13;
<p class="indent">“The <em>captain</em> hired a washed-up gumshoe like <em>you</em>?”</p>&#13;
<p class="indent">“Yes. Because he can trust <em>me</em>.”</p>&#13;
<p class="indent">Officer Notation’s face grew hard and her eyes burned. For a second, Frank thought she might end this conversation with her billy club. But almost as quickly as her anger had flared, it deflated.</p>&#13;
<p class="indent">“I need to recover those documents,” she said mournfully. “It was my fault—I was on guard duty that night.”</p>&#13;
<p class="indent">“I see,” said Frank thoughtfully.</p>&#13;
<p class="indent">“I need to recover those documents,” repeated Officer Notation, sounding agitated. “I’ve only been on the force for a few months and—”</p>&#13;
<p class="indent">Frank cut her off and gave her what he hoped was a reassuring smile. This was what he had expected. Rookies rarely dealt well with their first mistakes, and Notation seemed more tightly wound than most. “We’re looking for the <em>Retry Loop</em>,” he said. “The Crannocks’ cart unloaded something there the night of the robbery. The ship docked 19 hours ago.”</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_33"/>He didn’t trust her, of course, but he wanted to keep her close, keep an eye on her. The fact that she had found the Crannocks meant she knew more than she had put in her report. Something was missing from her story, and he needed to find out what else she knew.</p>&#13;
<p class="indent">“We better get started,” said Notation, looking worriedly down the pier. “There are a lot of ships to check. Should we start at the front?” As most of the vessels in port belonged to smugglers, none of them displayed identification. They would have to ask each ship’s name in turn.</p>&#13;
<p class="indent">“We can do better than that,” Frank explained. “The harbormaster is fanatical about organization. He insists that the docked ships be sorted in order of their arrival time. The newest arrival gets a prime spot near town, where the crew can easily load and unload, but when a new ship arrives, the rest of them are forced to shift down to give it space in front.”</p>&#13;
<p class="indent">“That’s absurd,” protested Notation. “What a tremendous amount of wasted effort. Why would he do that?”</p>&#13;
<p class="indent">Frank chuckled. “He claims it’s for efficiency, but anyone who’s spent a week in Usb knows the truth. The harbormaster can’t stand the smell of rotting fish. Ships that remain in harbor without selling their loads become, well . . . fragrant. The harbormaster’s organizational scheme moves the ones that have been here longer away from his shack.”</p>&#13;
<p class="indent">Officer Notation stared at him. “Are you serious?” she asked finally.</p>&#13;
<p class="indent">Frank chuckled again. “Yes. You’ll start picking up these useful bits of information, too, once you’ve walked the beat awhile. The point is that we know the ships are in sorted order and we know the <em>Retry Loop</em> has been here for 19 hours, so we can just do a <em>binary search</em>.</p>&#13;
<p class="indent">“Our target value is 19, and our algorithm is binary search. Right now the search space is that whole line of ships, so we already have an upper and lower bound. If we use inclusive bounds, our lower <span epub:type="pagebreak" id="page_34"/>bound is the first ship and our upper bound is the last ship. If the <em>Retry Loop</em> is here, it obviously can’t be in front of the first ship or after the last ship.</p>&#13;
<p class="indent">“So we start with the middle ship and ask how long it’s been in port. If it’s been there less than 19 hours, then it must come before the <em>Retry Loop.</em> That will split our search space in two. And—”</p>&#13;
<p class="indent">“If it’s been there more than 19 hours, then it must come after the <em>Retry Loop</em>,” interrupted Notation. “I know about binary search. My Police Algorithms final was just two and a half months ago.”</p>&#13;
<p class="indent">With that, the two of them set off in search of the <em>Retry Loop.</em> The middle ship, a yellow schooner that smelled oddly of bananas, had been in port for 17 hours.</p>&#13;
<div class="image"><img src="../images/f0034-01.jpg" alt="image"/></div>&#13;
<p class="indent">That meant they could rule out the half of the ships at the front, including the middle ship. Frank adjusted the lower bound to the first ship that <em>could</em> be the <em>Retry Loop</em>, one ship past the yellow schooner.</p>&#13;
<div class="image"><img src="../images/f0034-02.jpg" alt="image"/></div>&#13;
<p class="indent">With the reduced search space, they chose a new middle point. It took a while to convince the captain of the next ship that they weren’t undercover customs officials. After 10 minutes, Notation shoved her badge under the captain’s nose, and his tone changed immediately to an irate whine as he informed them that his ship, the <em>Corrupt Packet</em>, had been stuck in port for 22 agonizing hours. He demanded they speak to the harbormaster on his behalf.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_35"/><img src="../images/f0035-01.jpg" alt="image"/></div>&#13;
<p class="indent">Since their target was 19 hours, they knew the <em>Retry Loop</em> would have to come before the <em>Corrupt Packet.</em> They changed the bounds again so that the ship to the left of the <em>Corrupt Packet</em> was now the upper bound.</p>&#13;
<div class="image"><img src="../images/f0035-02.jpg" alt="image"/></div>&#13;
<p class="indent">This left only two ships in the search range; they were rapidly nearing the end of the search. If neither of these ships was the <em>Retry Loop</em>, they would know for certain that it had left port, as once there were no more elements in the search space, they could rule out the entire search space.</p>&#13;
<p class="indent">Since there were only two ships left, they could choose either as their new middle point. Going with his gut, Frank picked the earlier ship, which happened to also be their lower bound. A quick chat with a crewmember loitering on the pier confirmed that the ship was indeed the <em>Retry Loop</em> and it had been in port for 19 hours.</p>&#13;
<div class="image"><img src="../images/f0035-03.jpg" alt="image"/></div>&#13;
<p class="indent">“Now what?” asked Officer Notation as they stood watching the ship.</p>&#13;
<p class="indent">“We use your shiny badge again,” Frank replied.</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart"><span epub:type="pagebreak" id="page_36"/><strong>POLICE ALGORITHMS 101: BINARY SEARCH</strong></p>&#13;
<p class="sbsub"><em><strong>Excerpts from Professor Drecker’s Lecture</strong></em></p>&#13;
<p class="noindent">A binary search algorithm is used to efficiently find a target value <em>v</em> in a sorted array <em>A</em>. Unlike in a linear scan, a binary search uses information about the structure of the data to make the search more efficient. The key to efficient algorithms is information. In this case, we use the fact that the array is sorted in increasing order:</p>&#13;
<p class="center1"><em>A</em>[<em>i</em>] ≤ <em>A</em>[<em>j</em>] for any pair of indexes <em>i</em> and <em>j</em> such that <em>i</em> &lt; <em>j</em></p>&#13;
<p class="indent">This might not seem like a lot of information, but it’s enough to make the search more efficient.</p>&#13;
<p class="indent">The binary search algorithm works by repeatedly dividing the search space in half and limiting the search to only one of those halves. The algorithm limits the active search space by tracking two bounds. The upper bound (<em>IndexHigh</em>) marks the highest index of the array that’s part of the active search space. The lower bound (<em>IndexLow</em>) marks the lowest index. Throughout the algorithm, if the target value is in the array, we guarantee the following:</p>&#13;
<p class="center1"><em>A</em>[<em>IndexLow</em>] ≤ <em>v</em> ≤ <em>A</em>[<em>IndexHigh</em>]</p>&#13;
<p class="indent">At each step in the search, we check the value halfway between the lower and upper bounds:</p>&#13;
<div class="image"><img src="../images/f0036-01.jpg" alt="image"/></div>&#13;
<p class="indent">We can then compare the value at this middle location, <em>A</em>[<em>IndexMid</em>], with the target value, <em>v</em>. If the middle point is less than the target value, <em>A</em>[<em>IndexMid</em>] &lt; <em>v</em>, we know that the target value must lie after the middle index. This allows <span epub:type="pagebreak" id="page_37"/>us to chop the search space in half again by making <em>IndexLow</em> = <em>IndexMid</em> + 1.</p>&#13;
<p class="indent">If the middle point is greater than the target value, <em>A</em>[<em>IndexMid</em>] &gt; <em>v</em>, we know the target value must lie before the middle index, which allows us to chop the search space in half by making <em>IndexHigh</em> = <em>IndexMid</em> – 1.</p>&#13;
<p class="indent">Of course, if we find <em>A</em>[<em>IndexMid</em>] equals <em>v</em>, we can immediately conclude the search. We found the target.</p>&#13;
<p class="indent">Let’s consider searching the following (sorted) array for the value 15. The boxes with dotted outlines correspond to the values the algorithm has checked, and the shaded elements are ones that have been eliminated from the search.</p>&#13;
<div class="image"><img src="../images/f0037-01.jpg" alt="image"/></div>&#13;
<p class="indent">The first midpoint check finds a value of 11, which is less than our target value of 15. Since we know the array is sorted in increasing order, we can rule out the midpoint and anything before it. We move our lower bound index appropriately (<em>IndexLow</em> = <em>IndexMid</em> + 1).</p>&#13;
<div class="image"><img src="../images/f0037-02.jpg" alt="image"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_38"/>Similarly, after the second comparison, we find a midpoint value of 52, which is greater than the target value. We can rule out the midpoint and everything after it. We move our upper bound index (<em>IndexHigh</em> = <em>IndexMid</em> – 1).</p>&#13;
<div class="image"><img src="../images/f0038-01.jpg" alt="image"/></div>&#13;
<p class="indent">Note that even though the lower bound’s index pointed to the target value (<em>v</em> = 15) for several iterations, we continued the search until the midpoint pointed to the target value. This is because our search checks only the value at the midpoint. We don’t check the values at the lower or upper indexes until the midpoint reaches them.</p>&#13;
<p class="indent">What happens if the target value is not in the array? As the search progresses, the bounds will move closer until there are no unexplored values between them. Since we are always moving one of the bounds <em>past</em> the midpoint index, we can stop the search when <em>IndexHigh</em> &lt; <em>IndexLow.</em> At that point we can guarantee the target value is not in the array.</p>&#13;
</div>&#13;
</body></html>