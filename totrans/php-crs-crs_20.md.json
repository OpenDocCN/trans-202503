["```\n<!doctype html>\n<html>\n<head>\n<title>login form</title>\n</head>\n<body>\n\n    <form action=\"/?action=login\" ❶ method=\"post\">\n        <label>Username:<input name=\"username\"></label>\n        <label>Password:<input name=\"password\" ❷ type=\"password\"><label>\n        <input type=\"submit\">\n    </form>\n\n</body>\n</html>\n```", "```\n<?php\n$homeLink =  $homeLink ?? '';\n$contactLink =  $contactLink ?? '';\n$loginLink =  $loginLink ?? '';\n\n$pageTitle =  $pageTitle ?? '';\n?>\n<!doctype HTML>\n<html>\n<head>\n    <meta name=\"viewport\" content=\"width=device-width\">\n    <title>Secure site: <?= $pageTitle ?></title> ❶\n    <link rel=\"stylesheet\" href=\"/css/login.css\">\n    <link rel=\"stylesheet\"\n          href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\"\n    >\n</head>\n<body class=\"container\">\n```", "```\n❶ <header class=\"navbar navbar-expand navbar-dark d-flex mb-3 bg-primary\">\n\n    <img src=\"/images/logo.png\" alt=\"logo\" width=\"200px\">\n\n    <ul class=\"navbar-nav p-2\">\n        <li class=\"nav-item\">\n          ❷ <a class=\"nav-link <?= $homeLink ?>\" href=\"/\">\n                Home\n            </a>\n        </li>\n\n        <li class=\"nav-item\">\n          ❸ <a class=\"nav-link <?= $contactLink ?>\" href=\"/?action=contact\">\n                Contact Us\n            </a>\n         </li>\n    </ul>\n\n    <ul class=\"navbar-nav ms-auto p-2\">\n        <li class=\"nav-item\">\n          ❹ <a class=\"nav-link <?= $loginLink ?>\" href=\"/?action=login\">\n                Login\n            </a>\n        </li>\n    </ul>\n</header>\n```", "```\n<div class=\"row bg-light p-5\">\n    <div class=\"col\">\n        <h1>MGW. <br>You know it makes sense!</h1>\n    </div>\n\n    <div class=\"col\">\n        <p>\n            Welcome to My Great Website (MGW).\n            <br>\n            Now with login security!\n </p>\n    </div>\n</div>\n```", "```\n<?php\n$pageTitle = 'Home Page';\n$homeLink = 'active';\nrequire_once '_header.php';\n?>\n\n❶ <h1><?= $pageTitle ?></h1>\n\n<p>\nWelcome to the secure website demo.\n</p>\n</body>\n</html>\n```", "```\n<?php\n❶ $pageTitle = 'Contact Us';\n❷ $contactLink = 'active';\nrequire_once '_header.php';\n?>\n\n<h1><?= $pageTitle ?></h1>\n\n❸ <p>\n    Contact us as follows:\n</p>\n\n<dl>\n    <dt>Email</dt>\n    <dd>enquiries@securitydemo.com</dd>\n\n    <dt>Phone</dt>\n    <dd>+123 22-333-4444</dd>\n\n    <dt>Address</dt>\n    <dd>1 Main Street,<br>Newtown,<br>Ireland</dd>\n</dl>\n\n</body>\n</html>\n```", "```\n<?php\n❶ $pageTitle = 'Secure Banking - Swiss bank account details';\nrequire_once '_header.php';\n?>\n\n<h1><?= $pageTitle ?></h1>\n\n❷ <p>\n    Welcome to the secure website demo.\n    <br>\n    Today's bank account number is 12294934503845 with code word \"green lawn\"\n</p>\n</body>\n</html>\n```", "```\n<?php\n$pageTitle = 'Login';\n$loginLink = 'active';\nrequire_once '_header.php';\n?>\n\n<div class=\"formLogin\">\n\n  ❶ <form action=\"/?action=login\" method=\"post\">\n      ❷ <div class=\"form-group row m-3\">\n            <label for=\"username\" class=\"col-form-label col-sm-3\">\n                Username:\n            </label>\n            <div class=\"col\">\n                <input name=\"username\" id=\"username\"\n                    placeholder=\"Your username\" class=\"form-control\"\n                >\n            </div>\n        </div>\n\n      ❸ <div class=\"form-group row m-3\">\n            <label for=\"password\" class=\"col-form-label col-sm-3\">\n                Password:\n            </label>\n            <div class=\"col\">\n                <input name=\"password\" id=\"password\" type=\"password\"\n                    placeholder=\"Your password\" class=\"form-control\"\n                >\n            </div>\n        </div>\n\n      ❹ <div class=\"form-group\">\n            <input type=\"submit\" class=\"btn btn-primary w-100\"\n                value=\"Log in\" class=\"form-control\"\n            >\n        </div>\n    </form>\n\n</div>\n</body>\n</html>\n```", "```\n.formLogin {\n    background-color: lightgray;\n    padding: 4rem;\n    max-width: 30rem;\n}\n```", "```\n<?php\nrequire_once __DIR__ . '/../src/functions.php';\n\n$action = filter_input(INPUT_GET, 'action');\n\nswitch ($action) {\n  ❶ case 'contact':\n        contact();\n        break;\n\n  ❷ case 'login':\n        $isSubmitted = ($_SERVER['REQUEST_METHOD'] === 'POST');\n        if ($isSubmitted) {\n            // POST method so process submitted login data\n            processLogin();\n        } else {\n            // GET method to display login form\n            loginForm();\n        }\n        break;\n\n  ❸ default:\n        home();\n}\n```", "```\n<?php\nfunction home(): void\n{\n    require_once __DIR__ . '/../templates/homepage.php';\n}\n\nfunction contact(): void\n{\n    require_once __DIR__ . '/../templates/contact.php';\n}\n\nfunction loginForm(): void\n{\n    require_once __DIR__ . '/../templates/login.php';\n}\n\nfunction secureBanking(): void\n{\n    require_once __DIR__ . '/../templates/secureBanking.php';\n}\n\nfunction showError($message): void\n{\n    require_once __DIR__ . '/../templates/error.php';\n}\n```", "```\n❶ function getUsers(): array\n{\n    $users = [];\n    $users['matt'] = 'smith';\n    $users['james'] = 'bond';\n    $users['jane'] = 'doe';\n\n    return $users;\n}\n\n❷ function processLogin(): void\n{\n    $username = filter_input(INPUT_POST, 'username');\n    $password = filter_input(INPUT_POST, 'password');\n\n  ❸ if (validLoginCredentials($username, $password)) {\n        secureBanking();\n    } else {\n        showError('invalid login credentials - try again');\n    }\n}\n\n❹ function validLoginCredentials($username, $password): bool\n{\n    $users = getUsers();\n\n    if (isset($users[$username])) {\n        $storedPassword = $users[$username];\n        if ($password == $storedPassword) {\n            return true;\n        }\n    }\n\n    // If get here, no matching username/password\n  ❺ return false;\n}\n```", "```\n<?php\n$pageTitle = 'Error page';\nrequire_once '_header.php';\n?>\n\n<div class=\"alert alert-danger\" role=\"alert\">\n    Sorry, there was a problem:\n    <p>\n      ❶ <?= $message ?>\n    </p>\n</div>\n</body>\n</html>\n```", "```\n<?php\nsession_start();\nrequire_once __DIR__ . '/../src/functions.php';\n\n$action = filter_input(INPUT_GET, 'action');\n\nswitch ($action) {\n case 'contact':\n contact();\n break;\n\n case 'login':\n $isSubmitted = ($_SERVER['REQUEST_METHOD'] === 'POST');\n if ($isSubmitted) {\n // POST method so process submitted login data\n processLogin();\n } else {\n // GET method to display login form\n loginForm();\n }\n break;\n\n ❶ case 'secured':\n        if (isLoggedIn()) {\n            secureBanking();\n        } else {\n            showError('invalid login credentials - try again');\n        }\n        break;\n\n default:\n home();\n}\n```", "```\nfunction isLoggedIn(): bool\n{\n    if (isset($_SESSION['username'])) {\n        return true;\n    } else {\n        return false;\n    }\n}\n```", "```\nfunction processLogin(): void\n{\n $username = filter_input(INPUT_POST, 'username');\n $password = filter_input(INPUT_POST, 'password');\n\n if (validLoginCredentials($username, $password)) {\n        $_SESSION['username'] = $username;\n secureBanking();\n } else {\n showError('invalid login credentials - try again');\n }\n}\n```", "```\n<?php\n$homeLink =  $homeLink ?? '';\n$contactLink =  $contactLink ?? '';\n$loginLink =  $loginLink ?? '';\n❶ $securedLink =  $securedLink ?? '';\n\n$pageTitle =  $pageTitle ?? '';\n?>\n\n--snip--\n\n<ul class=\"navbar-nav\">\n <li class=\"nav-item\">\n <a class=\"nav-link <?= $homeLink ?>\" href=\"/\">\n Home\n </a>\n </li>\n\n <li class=\"nav-item\">\n <a class=\"nav-link <?= $contactLink ?>\" href=\"/?action=contact\">\n Contact Us\n </a>\n </li>\n\n❷ <?php if (isLoggedIn()): ?>\n    <li class=\"nav-item\">\n      ❸ <a class=\"nav-link <?= $securedLink ?>\" href=\"/?action=secured\">\n            Secure banking\n        </a>\n    </li>\n<?php endif; ?>\n</ul>\n--snip--\n```", "```\n<?php\n$pageTitle = 'Secure Banking- Swiss bank account details';\n$securedLink = 'active';\nrequire_once '_header.php';\n?>\n--snip--\n```", "```\nfunction logout(): void\n{\n    $_SESSION = [];\n    home();\n}\n```", "```\n--snip--\n\n case 'secured':\n if (isLoggedIn()) {\n secureBanking();\n } else {\n showError('invalid login credentials - try again');\n }\n break;\n\n  ❶ case 'logout':\n        logout();\n        break;\n\n default:\n home();\n}\n```", "```\n--snip--\n <?php if (isLoggedIn()):?>\n <li class=\"nav-item\">\n <a class=\"nav-link <?= $securedLink ?>\" href=\"/?action=secured\">\n Secure Banking\n </a>\n </li>\n <?php endif; ?>\n\n </ul>\n\n <ul class=\"navbar-nav ms-auto p-2\">\n <li class=\"nav-item\">\n\n      ❶ <?php if (isLoggedIn()): ?>\n            <a class=\"nav-link\" href=\"/?action=logout\">\n                Logout\n            </a>\n      ❷ <?php else: ?>\n <a class=\"nav-link <?= $loginLink ?>\" href=\"/?action=login\">\n Login\n </a>\n        <?php endif; ?>\n\n </li>\n </ul>\n</header>\n```", "```\nfunction usernameFromSession(): string\n{\n    if (isset($_SESSION['username']))\n        return $_SESSION['username'];\n    else\n        return '';\n}\n```", "```\n--snip--\n<?php if (isLoggedIn()):?>\n    <span class=\"username\">\n        You are logged in as:\n        <strong><?= usernameFromSession() ?></strong>\n    </span>\n <a class=\"nav-link\" href=\"/?action=logout\">\n Logout\n </a>\n<?php else: ?>\n--snip--\n```", "```\n color: yellow;\n}\n```"]