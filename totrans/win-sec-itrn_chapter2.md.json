["```\nPS> **Get-NtSid -Name \"Users\"**\nName          Sid\n----          ---\nBUILTIN\\Users S-1-5-32-545 \n```", "```\nPS> **Get-NtSid -Sddl \"S-1-5-32-545\"**\nName          Sid\n----          ---\nBUILTIN\\Users S-1-5-32-545 \n```", "```\nPS> **Get-NtType**\nName\n----\nType\nDirectory\nSymbolicLink\nToken\nJob\nProcess\nThread\n`--snip--` \n```", "```\nPS> **ls NtObject:\\ | Sort-Object Name**\nName             TypeName\n----             --------\nArcName          Directory\nBaseNamedObjects Directory\nBindFltPort      FilterConnectionPort\nCallback         Directory\nCLDMSGPORT       FilterConnectionPort\nclfs             Device\nCsrSbSyncEvent   Event\nDevice           Directory\nDfs              SymbolicLink\nDosDevices       SymbolicLink\n`--snip--` \n```", "```\nPS> **ls NtObject:\\Dfs | Select-Object SymbolicLinkTarget**\nSymbolicLinkTarget\n------------------\n\\Device\\DfsClient\n\nPS> **Get-Item NtObject:\\Device\\DfsClient | Format-Table**\nName      TypeName\n----      --------\nDfsClient Device \n```", "```\nNTSTATUS NtCreateMutant(\n    HANDLE* FileHandle,\n    ACCESS_MASK DesiredAccess,\n    OBJECT_ATTRIBUTES* ObjectAttributes,\n    BOOLEAN InitialOwner\n); \n```", "```\nstruct OBJECT_ATTRIBUTES {\n    ULONG           Length;\n    HANDLE          RootDirectory;\n    UNICODE_STRING* ObjectName;\n    ULONG           Attributes;\n    PVOID           SecurityDescriptor;\n    PVOID           SecurityQualityOfService;\n} \n```", "```\nstruct UNICODE_STRING {\n    USHORT Length;\n    USHORT MaximumLength;\n    WCHAR* Buffer;\n}; \n```", "```\nPS> **Get-NtStatus**\nStatus     StatusName                Message\n------     ----------                -------\n00000000   STATUS_SUCCESS            STATUS_SUCCESS\n00000001   STATUS_WAIT_1             STATUS_WAIT_1\n00000080   STATUS_ABANDONED_WAIT_0   STATUS_ABANDONED_WAIT_0\n000000C0   STATUS_USER_APC           STATUS_USER_APC\n000000FF   STATUS_ALREADY_COMPLETE   The requested action was completed by...\n00000100   STATUS_KERNEL_APC         STATUS_KERNEL_APC\n00000101   STATUS_ALERTED            STATUS_ALERTED\n00000102   STATUS_TIMEOUT            STATUS_TIMEOUT\n00000103   STATUS_PENDING            The operation that was requested is p...\n`--snip--` \n```", "```\nPS> **Get-NtDirectory \\THISDOESNOTEXIST**\n❶ Get-NtDirectory : (0xC0000034) - Object Name not found.\n`--snip--`\n\nPS> **Get-NtStatus 0xC0000034 | Format-List**\nStatus         : 3221225524\n❷ StatusSigned   : -1073741772\nStatusName     : STATUS_OBJECT_NAME_NOT_FOUND\nMessage        : Object Name not found.\nWin32Error     : ERROR_FILE_NOT_FOUND\nWin32ErrorCode : 2\nCode           : 52\nCustomerCode   : False\nReserved       : False\nFacility       : FACILITY_DEFAULT\nSeverity       : STATUS_SEVERITY_ERROR \n```", "```\nPS> **Get-NtType | Select-Object Name, GenericMapping**\nName                            GenericMapping\n----                            --------------\nType                            R:00020000 W:00020000 E:00020000 A:000F0001\nDirectory                       R:00020003 W:0002000C E:00020003 A:000F000F\nSymbolicLink                    R:00020001 W:00020000 E:00020001 A:000F0001\nToken                           R:0002001A W:000201E0 E:00020005 A:000F01FF\n`--snip--` \n```", "```\nPS> **Get-NtTypeAccess -Type File**\nMask       Value                GenericAccess\n----       -----                -------------\n00000001   ReadData             Read, All\n00000002   WriteData            Write, All\n00000004   AppendData           Write, All\n00000008   ReadEa               Read, All\n00000010   WriteEa              Write, All\n00000020   Execute              Execute, All\n00000040   DeleteChild          All\n00000080   ReadAttributes       Read, Execute, All\n00000100   WriteAttributes      Write, All\n00010000   Delete               All\n00020000   ReadControl          Read, Write, Execute, All\n00040000   WriteDac             All\n00080000   WriteOwner           All\n00100000   Synchronize          Read, Write, Execute, All \n```", "```\nPS> **Get-NtAccessMask -FileAccess ReadData, ReadAttributes, ReadControl**\nAccess\n------\n00020081\n\nPS> **Get-NtAccessMask -FileAccess GenericRead**\nAccess\n------\n80000000\n\nPS> **Get-NtAccessMask -FileAccess GenericRead -MapGenericRights**\nAccess\n------\n00120089\n\nPS> **Get-NtAccessMask 0x120089 -AsTypeAccess File**\nReadData, ReadEa, ReadAttributes, ReadControl, Synchronize \n```", "```\nPS> **$mut = New-NtMutant**\nPS> **$mut.GrantedAccess**\nModifyState, Delete, ReadControl, WriteDac, WriteOwner, Synchronize\n\nPS> **$mut.GrantedAccessMask**\nAccess\n------\n001F0001 \n```", "```\nPS> **Get-NtHandle -ProcessId $pid**\nProcessId  Handle     ObjectType           Object               GrantedAccess\n---------  ------     ----------           ------               -------------\n22460      4          Process              FFFF800224F02080     001FFFFF\n22460      8          Thread               FFFF800224F1A140     001FFFFF\n22460      12         SymbolicLink         FFFF9184AC639FC0     000F0001\n22460      16         Mutant               FFFF800224F26510     001F0001\n`--snip--` \n```", "```\nPS> **$m = New-NtMutant \\BaseNamedObjects\\ABC**\nPS> **$m.IsClosed**\nFalse\n\nPS> **$m.Close()**\nPS> **$m.IsClosed**\nTrue\n\nPS> **Use-NtObject($m = New-NtMutant \\BaseNamedObjects\\ABC) {**\n    **$m.FullPath**\n**}**\n\\BaseNamedObjects\\ABC\n\nPS> **$m.IsClosed**\nTrue \n```", "```\n❶ PS> **$mut = New-NtMutant \"\\BaseNamedObjects\\ABC\"**\nPS> **$mut.GrantedAccess**\nModifyState, Delete, ReadControl, WriteDac, WriteOwner, Synchronize\n\n❷ PS> **Use-NtObject($dup = Copy-NtObject $mut) {**\n    **$mut**\n    **$dup**\n    **Compare-NtObject $mut $dup**\n**}**\nHandle Name NtTypeName Inherit ProtectFromClose\n------ ---- ---------- ------- ----------------\n1616   ABC  Mutant     False   False\n2212   ABC  Mutant     False   False\nTrue\n\n❸ PS> **$mask = Get-NtAccessMask -MutantAccess ModifyState**\nPS> **Use-NtObject($dup = Copy-NtObject $mut -DesiredAccessMask $mask) {**\n    **$dup.GrantedAccess**\n    **Compare-NtObject $mut $dup**\n**}**\nModifyState\nTrue \n```", "```\nPS> **$mut = New-NtMutant**\nPS> **$mut.ProtectFromClose = $true**\nPS> **Close-NtObject -SafeHandle $mut.Handle -CurrentProcess**\nSTATUS_HANDLE_NOT_CLOSABLE \n```", "```\nNTSTATUS NtQueryInformationProcess(\n    HANDLE                    Handle,\n    PROCESS_INFORMATION_CLASS InformationClass,\n    PVOID                     Information,\n    ULONG                     InformationLength,\n    PULONG                    ReturnLength\n) \n```", "```\nNTSTATUS NtSetInformationProcess(\n    HANDLE                    Handle,\n    PROCESS_INFORMATION_CLASS InformationClass,\n    PVOID                     Information,\n    ULONG                     InformationLength\n) \n```", "```\nPS> **Get-NtObjectInformationClass Process**\nKey                     Value\n---                     -----\nProcessBasicInformation     0\nProcessQuotaLimits          1\nProcessIoCounters           2\nProcessVmCounters           3\nProcessTimes                4\n`--snip--` \n```", "```\nPS> **$proc = Get-NtProcess -Current**\n❶ PS> **Get-NtObjectInformation $proc ProcessTimes**\nGet-NtObjectInformation : (0xC0000023) - {Buffer Too Small}\nThe buffer is too small to contain the entry. No information has been written to the buffer.\n`--snip--`\n\n❷ PS> **Get-NtObjectInformation $proc ProcessTimes -Length 32**\n43\n231\n39\n138\n`--snip--`\n\n❸ PS> **Get-NtObjectInformation $proc ProcessTimes -AsObject**\nCreateTime         ExitTime KernelTime UserTime\n----------         -------- ---------- --------\n132480295787554603 0        35937500   85312500 \n```", "```\nPS> **$proc | Format-List**\nSessionId       : 2\nProcessId       : 5484\nParentProcessId : 8108\nPebAddress      : 46725963776\n`--snip--`\n\nPS> **$proc.CreationTime**\nSaturday, October 24, 17:12:58 \n```", "```\nPS> **Get-NtObjectInformationClass Key**\nKey                     Value\n---                     -----\nKeyBasicInformation         0\n`--snip--`\n\nPS> **Get-NtObjectInformationClass Key -Set**\nKey                     Value\n---                     -----\nKeyWriteTimeInformation     0\n`--snip--` \n```", "```\nPS> **ls NtObject:\\Device**\nName                                     TypeName\n----                                     --------\n_HID00000034                             Device\nDBUtil_2_3                               Device\n000000c7                                 Device\n000000b3                                 Device\nUMDFCtrlDev-0f8ff736-55d7-11ea-b5d8-2... Device\n0000006a                                 Device\n`--snip--` \n```", "```\nPS> **Use-NtObject($f = Get-NtFile \"\\SystemRoot\\notepad.exe\") {**\n    **$f | Select-Object FullPath, NtTypeName**\n**}**\nFullPath                                    NtTypeName\n--------                                    ----------\n❶ \\Device\\HarddiskVolume3\\Windows\\notepad.exe File\n\nPS> **Get-Item NtObject:\\Device\\HarddiskVolume3**\nName            TypeName\n----            --------\nHarddiskVolume3 Device \n```", "```\nPS> **Get-NtKernelModule**\nName         ImageBase        ImageSize\n----         ---------        ---------\nntoskrnl.exe FFFFF8053BEAA000 11231232\nhal.dll      FFFFF8053BE07000 667648\nkd.dll       FFFFF8053B42E000 45056\nmsrpc.sys    FFFFF8053B48E000 393216\nksecdd.sys   FFFFF8053B45E000 172032\n`--snip--` \n```", "```\nPS> **Get-NtProcess -InfoOnly**\nPID PPID Name          SessionId\n--- ---- ----          ---------\n0   0    Idle          0\n4   0    System        0\n128 4    Secure System 0\n192 4    Registry      0\n812 4    smss.exe      0\n920 892  csrss.exe     0\n`--snip--`\n\nPS> **Get-NtThread -InfoOnly**\nTID PID ProcessName StartAddress\n--- --- ----------- ------------\n0   0   Idle        FFFFF8004C9CAFD0\n0   0   Idle        FFFFF8004C9CAFD0\n`--snip--` \n```", "```\nPS> **$proc = Get-NtProcess -ProcessId $pid**\nPS> **$proc.CommandLine**\n\"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\"\n\nPS> **$proc.Win32ImagePath**\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe \n```", "```\n❶ PS> **Get-NtVirtualMemory**\nAddress          Size   Protect          Type    State   Name\n-------          ----   -------          ----    -----   ----\n000000007FFE0000 4096   ReadOnly         Private Commit\n000000007FFEF000 4096   ReadOnly         Private Commit\n000000E706390000 241664 None             Private Reserve\n000000E7063CB000 12288  ReadWrite, Guard Private Commit\n000000E7063CE000 8192   ReadWrite        Private Commit\n000000F6583F0000 12288  ReadOnly         Mapped  Commit  powershell.exe.mui\n`--snip--`\n\n❷ PS> **$addr = Add-NtVirtualMemory -Size 1000 -Protection ReadWrite**\nPS> **Get-NtVirtualMemory -Address $addr**\nAddress          Size   Protect          Type    State   Name\n-------          ----   -------          ----    -----   ----\n000002624A440000 4096   ReadWrite        Private Commit\n\n❸ PS> **Read-NtVirtualMemory -Address $addr -Size 4 | Out-HexDump**\n00 00 00 00\n\n❹ PS> **Write-NtVirtualMemory -Address $addr -Data @(1,2,3,4)**\n4\n\n❺ PS> **Read-NtVirtualMemory -Address $addr -Size 4 | Out-HexDump**\n01 02 03 04\n\n❻ PS> **Set-NtVirtualMemory -Address $addr -Protection ExecuteRead -Size 4**\nReadWrite\n\n❼ PS> **Get-NtVirtualMemory -Address $addr**\nAddress          Size   Protect          Type    State   Name\n-------          ----   -------          ----    -----   ----\n000002624A440000 4096   ExecuteRead      Private Commit\n\n❽ PS> **Remove-NtVirtualMemory -Address $addr**\nPS> **Get-NtVirtualMemory -Address $addr**\nAddress          Size   Protect          Type    State   Name\n-------          ----   -------          ----    -----   ----\n000002624A440000 196608 NoAccess         None    Free \n```", "```\n❶ PS> **$s = New-NtSection -Size 4096 -Protection ReadWrite**\n❷ PS> **$m = Add-NtSection -Section $s -Protection ReadWrite**\nPS> **Get-NtVirtualMemory $m.BaseAddress**\nAddress          Size Protect   Type   State  Name\n-------          ---- -------   ----   -----  ----\n000001C3DD0E0000 4096 ReadWrite Mapped Commit\n\n❸ PS> **Remove-NtSection -Mapping $m**\nPS> **Get-NtVirtualMemory -Address 0x1C3DD0E0000**\nAddress          Size Protect   Type   State  Name\n-------          ---- -------   ----   -----  ----\n000001C3DD0E0000 4096 NoAccess  None   Free\n\n❹ PS> **Add-NtSection -Section $s -Protection ExecuteRead**\nException calling \"Map\" with \"9\" argument(s):\n  \"(0xC000004E) - A view to a section specifies a protection which is\n   incompatible with the initial view's protection.\" \n```", "```\nPS> **Get-NtVirtualMemory -Type Mapped | Where-Object Name -ne \"\"**\nAddress          Size    Protect  Type   State  Name\n-------          ----    -------  ----   -----  ----\n000001760DB90000 815104  ReadOnly Mapped Commit locale.nls\n000001760DC60000 12288   ReadOnly Mapped Commit powershell.exe.mui\n000001760DEE0000 20480   ReadOnly Mapped Commit winnlsres.dll\n000001760F720000 3371008 ReadOnly Mapped Commit SortDefault.nls\n`--snip--` \n```", "```\nPS> **$sect = New-NtSectionImage -Win32Path \"C:\\Windows\\notepad.exe\"**\n❶ PS> **$map = Add-NtSection -Section $sect -Protection ReadOnly**\nPS> **Get-NtVirtualMemory -Address $map.BaseAddress**\nAddress          Size   Protect     Type  State  Name\n-------          ----   -------     ----  -----  ----\n❷ 00007FF667150000 4096   ReadOnly    Image Commit notepad.exe\n\n❸ PS> **Get-NtVirtualMemory -Type Image -Name \"notepad.exe\"**\nAddress          Size   Protect     Type  State  Name\n-------          ----   -------     ----  -----  ----\n00007FF667150000 4096   ReadOnly    Image Commit notepad.exe\n00007FF667151000 135168 ExecuteRead Image Commit notepad.exe\n00007FF667172000 36864  ReadOnly    Image Commit notepad.exe\n00007FF66717B000 12288  WriteCopy   Image Commit notepad.exe\n00007FF66717E000 4096   ReadOnly    Image Commit notepad.exe\n00007FF66717F000 4096   WriteCopy   Image Commit notepad.exe\n00007FF667180000 8192   ReadOnly    Image Commit notepad.exe\n\n❹ PS> **Out-HexDump -Buffer $map -ShowAscii -Length 128**\n4D 5A 90 00 03 00 00 00 04 00 00 00 FF FF 00 00  - MZ..............\nB8 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00  - ........@.......\n00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  - ................\n00 00 00 00 00 00 00 00 00 00 00 00 F8 00 00 00  - ................\n0E 1F BA 0E 00 B4 09 CD 21 B8 01 4C CD 21 54 68  - ........!..L.!Th\n69 73 20 70 72 6F 67 72 61 6D 20 63 61 6E 6E 6F  - is program canno\n74 20 62 65 20 72 75 6E 20 69 6E 20 44 4F 53 20  - t be run in DOS\n6D 6F 64 65 2E 0D 0D 0A 24 00 00 00 00 00 00 00  - mode....$....... \n```", "```\nPS> **Get-AuthenticodeSignature \"$env:WinDir\\system32\\notepad.exe\" | Format-List**\nSignerCertificate : [Subject]\n    CN=Microsoft Windows, O=Microsoft Corporation, L=Redmond, S=Washington, C=US\n`--snip--`\nStatus            : Valid\nStatusMessage     : Signature verified.\nPath              : C:\\WINDOWS\\system32\\notepad.exe\nSignatureType     : Catalog\nIsOSBinary        : True \n```", "```\nPS> **ls NtObject:\\REGISTRY**\nName    TypeName\n----    --------\nA       Key\nMACHINE Key\nUSER    Key\nWC      Key \n```", "```\nPS> **$key = Get-NtKey \\Registry\\Machine\\SOFTWARE\\Microsoft\\.NETFramework**\nPS> **Get-NtKeyValue -Key $key**\nName                     Type   DataObject\n----                     ----   ----------\nEnable64Bit              Dword  1\nInstallRoot              String C:\\Windows\\Microsoft.NET\\Framework64\\\nUseRyuJIT                Dword  1\nDbgManagedDebugger       String \"C:\\Windows\\system32\\vsjitdebugger.exe\"...\nDbgJITDebugLaunchSetting Dword  16 \n```", "```\nPS> **$hs = Get-NtHandle -ObjectType File | Where-Object Name -Match Windows**\nPS> **$hs | Select-Object ProcessId, Handle, Name**\nProcessId Handle Name\n--------- ------ ----\n     3140     64 \\Device\\HarddiskVolume3\\Windows\\System32\n     3140   1628 \\Device\\HarddiskVolume3\\Windows\\System32\\en-US\\KernelBase.dll.mui\n     3428     72 \\Device\\HarddiskVolume3\\Windows\\System3\n     3428    304 \\Device\\HarddiskVolume3\\Windows\\System32\\en-US\\svchost.exe.mui\n     3428    840 \\Device\\HarddiskVolume3\\Windows\\System32\\en-US\\crypt32.dll.mui\n     3428   1604 \\Device\\HarddiskVolume3\\Windows\\System32\\en-US\\winnlsres.dll.mui\n`--snip--` \n```", "```\nPS> **$ss = Get-NtHandle -ObjectType Section -GroupByAddress |**\n**Where-Object ShareCount -eq 2**\nPS> **$mask = Get-NtAccessMask -SectionAccess MapWrite**\nPS> **$ss = $ss | Where-Object {Test-NtAccessMask $_.AccessIntersection $mask}**\nPS> **foreach($s in $ss) {**\n    **$count = ($s.ProcessIds | Where-Object {**\n        **Test-NtProcess -ProcessId $_ -Access DupHandle**\n    **}).Count**\n    **if ($count -eq 1) {**\n        **$s.Handles | Select ProcessId, ProcessName, Handle**\n    **}**\n**}**\nProcessId ProcessName Handle\n--------- ----------- ------\n     9100 Chrome.exe    4400\n     4072 audiodg.exe   2560 \n```", "```\nPS> **$sect = $handle.GetObject()**\nPS> **$map = Add-NtSection -Section $sect -Protection ReadWrite**\nPS> **$random = Get-RandomByte -Size $map.Length**\nPS> **Write-NtVirtualMemory -Mapping $map -Data $random**\n4096\n\nPS> **Out-HexDump -Buffer $map -Length 16 -ShowAddress -ShowHeader**\n                  00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\n-----------------------------------------------------------------\n000001811C860000: DF 24 04 E1 AB 2A E1 76 EB 19 00 8D 79 28 9C BA \n```", "```\nPS> **Show-NtSection -Section $sect** \n```", "```\nPS> **$proc = Get-NtProcess -ProcessId $pid -Access QueryLimitedInformation**\nPS> **Get-NtVirtualMemory -Process $proc | Where-Object {**\n    **$_.Protect -band \"ExecuteReadWrite\"**\n**}**\nAddress          Size  Protect          Type    State  Name\n-------          ----  -------          ----    -----  ----\n0000018176450000 4096  ExecuteReadWrite Private Commit\n0000018176490000 8192  ExecuteReadWrite Private Commit\n0000018176F60000 61440 ExecuteReadWrite Private Commit\n`--snip--`\n\nPS> **$proc.Close()** \n```"]