<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" epub:prefix="index: http://www.index.com/" lang="en" xml:lang="en">
<head>
<title>Chapter 14: UI Toolkit</title>
<link href="NSTemplate_v1.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:c2f206e1-36e8-4f89-b533-508263d6ec16" name="Adept.expected.resource"/>
</head>
<body epub:type="bodymatter chapter">
<section>
<header>
<h1 class="chapter">
<span class="ChapterNumber"><span epub:type="pagebreak" id="Page_137" title="137"/>14</span><br/>
<span class="ChapterTitle">UI Toolkit</span></h1>
</header>
<figure class="graphic">
<img alt="g14001" src="image_fi/502680c14/g14001.png"/></figure>

<p class="ChapterIntro"><span class="dropCap">T</span>he UI toolkit provides most of the visual elements on the screen. Buttons, text, animations, and the graphics that draw all of those things are all part of the UI toolkit on Android.</p>
<p>In late 2005, there was no UI toolkit (nor was there much of anything else, either). There was low-level graphics functionality that allowed some things to be drawn on the screen using the Skia library. And there were two conflicting ideas for how to build a UI toolkit on top of that graphics engine.</p>
<p>On one side, Mike Reed’s Skia team had a working system which used XML to describe the UI and JavaScript code to provide the programming logic.</p>
<p>On the other side, the framework team preferred a more code-centric approach.</p>
<p>This decision, like so many in Android, happened through sheer effort. Andy Rubin had recently decided that Android would use Java as the main programming language. Joe Onorato decided it was time to dive in and implement the UI layer in Java. “It was basically a furious ‘Let’s get something done’ time. Took about a day, 24-hour marathon.<sup class="FootnoteReference"><a href="#c14-footnote-1" id="c14-footnoteref-1">1</a></sup> I had Views [UI elements] up on screen.”</p>
<p><span epub:type="pagebreak" id="Page_138" title="138"/>Mathias Agopian said of Joe, “He didn’t tell anybody. One morning he showed up and said, ‘Problem solved, it’s in Java. Now we don’t have to talk about it anymore because it’s there.’”</p>
<p>Mike Reed remembered the decision to go with Joe’s implementation: “Joe came in with very clear ideas. Especially because we were remote [the Skia team was in North Carolina], we just took a step back and let it work itself out.”</p>
<p>Joe demoed his work to Andy, which didn’t go as well as he’d hoped. “The first time I showed it to Rubin, he was less than impressed. The first thing I did was draw a red X on the screen from the UI. Apparently, that was the thing that something would draw on Danger when it kernel-panicked.<sup class="FootnoteReference"><a href="#c14-footnote-2" id="c14-footnoteref-2">2</a></sup> I showed him what I thought was a major achievement: ‘Look, I got a View hierarchy done!’. But to him, it looked like the phone just crashed. He’s like, ‘Wow, you made the kernel panic.’”</p>
<p>But Joe’s work was significant. It allowed developers on the team to start writing other pieces of the system that needed UI functionality.</p>
<p>Of course, many parts of the system were in flux during early development, and the UI toolkit was one of them. The system that Joe built was multi-threaded.<sup class="FootnoteReference"><a href="#c14-footnote-3" id="c14-footnoteref-3">3</a></sup> This approach is unusual in UI toolkits, as it requires very careful coding to correctly handle requests coming in willy-nilly without regard to threading concerns. </p>
<p>In March of 2006, three months after Joe wrote the initial View system, Mike Cleron joined Android. He saw complexities mounting in the growing code base that depended on Joe’s multi-threaded UI toolkit.</p>
<h2 id="h1-502680c14-0001">Mike Cleron and the UI Toolkit Rewrite</h2>
<p class="BodyFirst">Mike Cleron never pictured himself going into computer science until he was in college. “I thought I was going to be an Econ major until I took Econ 1.” His computer science classes worked out better: “I really enjoyed my <span epub:type="pagebreak" id="Page_139" title="139"/>freshman year courses where we learned not about programming, but about data structures and algorithms. I thought binary tree traversal was the coolest thing ever. Big time nerd.</p>
<p>“It was the only thing I could possibly have gotten a degree in, because it was the only thing I could do still reasonably competently when the rest of my brain was shut down from exhaustion. I took a bunch of political science courses, close to being a major, but at one o’clock in the morning, 250 pages from finishing a 500 page reading assignment, I’m asleep. But when I’m 16 hours into a 16 hour programming assignment, my reptile brain is still letting me program in Emacs on my VT100.<sup class="FootnoteReference"><a href="#c14-footnote-4" id="c14-footnoteref-4">4</a></sup> I thought, ‘I’d better major in this because I can graduate.’”</p>
<p>He continued on in computer science, eventually getting his master’s degree, and stayed on at Stanford as a lecturer, developing some of the curriculum for undergraduates to make their on-ramp to computer science a little less severe than his had been (Mike’s was the first year that Stanford even offered a computer science degree). “My mission as a lecturer there was to try to make the people who followed in my footsteps have less of a difficult time than I did. They [Stanford] had basically taken all their graduate level courses, subtracted a hundred, and said ‘Now you have an undergraduate course.’ They all assumed that you’d already had a computer science education and now you just needed to know a little more about compilers or automata.”</p>
<p>Mike worked at Apple after he left academia, then moved to WebTV in 1996, where he worked with many future Android engineers. WebTV was acquired by Microsoft in 1997, and Mike continued working there for several more years.</p>
<p>In early 2006, Mike’s manager at Microsoft, Steve Horowitz, left to join the Android team at Google. “It was really Steve leaving that made me think it was time for me to go. I wasn’t having that much fun at Microsoft anymore, and Steve leaving wasn’t going to make it better.”</p>
<p>Steve said, “I remember having the talk with Mike Cleron, telling him before I had actually come to Google. I said, ‘Mike, I have to let you know that I’ve just accepted an offer to go lead engineering on the Android acquisition <span epub:type="pagebreak" id="Page_140" title="140"/>at Google.’ Before I could finish the sentence, he was like ‘Here’s my resume!’ Mike was my first hire, and came on board fairly soon after I did.”</p>
<p>Mike began life on Android by working on the UI toolkit, along with a host of other things, including the launcher<sup class="FootnoteReference"><a href="#c14-footnote-5" id="c14-footnoteref-5">5</a></sup> and the system UI. He eventually became the manager of what was called the “framework team,” which comprised the UI toolkit, the framework team,<sup class="FootnoteReference"><a href="#c14-footnote-6" id="c14-footnoteref-6">6</a></sup> and various parts of the system UI, like the lock screen, launcher, and the notification system.<sup class="FootnoteReference"><a href="#c14-footnote-7" id="c14-footnoteref-7">7</a></sup></p>
<p>One of Mike’s first projects after joining Android in March of 2006 was to rewrite the UI toolkit code that Joe Onorato had written. There was growing disagreement over the toolkit’s architecture; some people on the team felt that the multi-threaded nature of the system was causing undue complexity in both that code and in the apps that used it.</p>
<p>Mike figured there were three possible approaches for a UI toolkit. “The best outcome would be thread-safe, easy to use multi-threading. Second was single-threaded but at least you could wrap your head around it. Worst was multi-threaded but buggy, because you couldn’t reason about it. We were headed for the last thing.”</p>
<p>Mathias Agopian talked about writing code for the multi-threaded system. “When you wrote a View, you couldn’t write it the traditional way, with member variables.<sup class="FootnoteReference"><a href="#c14-footnote-8" id="c14-footnoteref-8">8</a></sup> That led to a lot of multi-threaded bugs because app developers were not used to it. In particular, Chris DeSalvo<sup class="FootnoteReference"><a href="#c14-footnote-9" id="c14-footnoteref-9">9</a></sup> was a fierce opponent to this multi-threaded thing. Joe and Chris were going at it, fighting all <span epub:type="pagebreak" id="Page_141" title="141"/>the time, Chris saying it was crap, didn’t work. Mike was trying to weigh in, see what could be done.”</p>
<p>Steve Horowitz got involved, as the director of the engineering team: “It was down to me deciding which one are we going to pick, because they could not convince one another. Honestly, I think we would’ve been okay with either direction, but I had to make a call.”</p>
<p>Mathias continued: “Joe literally dropped it: ‘Do whatever you want. It’s not mine anymore.’”</p>
<p>Mike then rewrote the UI toolkit to its current single-threaded form. “That’s the nastiest CL<sup class="FootnoteReference"><a href="#c14-footnote-10" id="c14-footnoteref-10">10</a></sup> that I worked on, trying to make all that stuff work in a different way.” Mike’s code formed the basis of the UI toolkit that the Android system had from that moment on.<sup class="FootnoteReference"><a href="#c14-footnote-11" id="c14-footnoteref-11">11</a></sup></p>
<p>Along the way, Mike wrote, or at least inherited and enhanced, other fundamental pieces of Android’s UI toolkit, like View (the basic building block of every UI class), ViewGroup (the parent and container of views), ListView (a list of data that could be scrolled and flung by the user), and various Layout classes (ViewGroups that define how their children are sized and positioned).</p>
<figure>
<img alt="" class="" src="image_fi/502680c14/f14001.png"/>
<figcaption><p>Mike Cleron, presenting at the first internal tech talk about Android at Google in August of 2007 (picture courtesy Brian Swetland)</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_142" title="142"/>But Android’s UI toolkit is more than just views and layout classes. For example, the UI toolkit is responsible for handling text.</p>
<h2 id="h1-502680c14-0002">Eric Fischer and TextView</h2>
<p class="BodyFirst">Mike Cleron said that when he arrived at Android, “Eric Fischer, as far as I could tell, just found TextView in a stone cavern in a mountain somewhere. There was TextView in finished form. I never saw anyone creating TextView. It’s just always been there.”</p>
<p>A few years earlier, Eric had worked with Mike Fleming at Eazel, a startup founded by some members of the early Macintosh team. Both Eric and Mike went to Danger when Eazel fell apart in 2001.</p>
<p>One of the appeals of small companies like Danger is the ability to work on many different kinds of projects, compared to the opportunities available on a team that supports just part of a larger product. While at Danger, Eric worked on everything from text and internationalization to the build system to performance optimization. Working at Danger also gave Eric, years later, an appreciation for the faster development process at Android. “Android offered the promise of much faster and more flexible development by giving Google, and not the carriers, final responsibility for what went into the software.”</p>
<p>Eric joined the Android team at Google in November of 2005. “My very first piece of code for Android was a C++ text storage class. For the first few weeks I was there, we thought we were going to write the user interface elements as C++ classes with JavaScript bindings.” A few weeks later, Andy made the call to standardize on Java for Android.</p>
<p>“Once we decided to use Java instead, one of the first steps toward getting a working system was writing a new implementation of the core classes of the Java standard library, and I did some of that. All of that code except for the time zone handling was, I believe, replaced by the Apache Commons implementation before the first public release.</p>
<p>“I touched some other parts of the software, but most of my work went into the text display and editing system. The earliest development hardware was candybar<sup class="FootnoteReference"><a href="#c14-footnote-12" id="c14-footnoteref-12">12</a></sup> phones with only a 12-key numeric keypad, which is why <span epub:type="pagebreak" id="Page_143" title="143"/>there is a <code>MultiTapKeyListener</code> class for that style of agonizingly slow text entry. Fortunately, we quickly moved on to the Sooner development hardware with a tiny QWERTY keyboard instead.</p>
<figure>
<img alt="" class="" src="image_fi/502680c14/f14002.png"/>
<figcaption><p>On the left is the early candybar phone, nicknamed Tornado, which the team used until the later Sooner device. The phone on the right is an HTC Excalibur, which was the basis for Sooner after some industrial design modifications (and replacing the Windows Mobile OS with Android). (Picture courtesy Eric Fischer.)</p></figcaption>
</figure>
<p>“I made sure to handle bidirectional text layout from the beginning, which was sufficient for Hebrew, but not for Arabic.”<sup class="FootnoteReference"><a href="#c14-footnote-13" id="c14-footnoteref-13">13</a></sup> </p>
<p>Software engineers tend to get emotionally attached to their code, and that was the case for Eric, who displayed his passion in the license plate for his car. “I had the California EBCDIC personalized license plate, for the 1960s IBM character code that competed with ASCII. Someone else in building 44 had UNICODE.”<sup class="FootnoteReference"><a href="#c14-footnote-14" id="c14-footnoteref-14">14</a></sup></p>
<span epub:type="pagebreak" id="Page_144" title="144"/><figure>
<img alt="" class="" src="image_fi/502680c14/f14003.png"/>
<figcaption><p>UNICODE battles EBCDIC as text standards in the Google parking lot (Eric Fischer’s car is the one with EBCDIC). (Picture courtesy Eric Fischer.)</p></figcaption>
</figure>
<p>Text rendering (drawing the actual pixels for the text that is seen on the screen) was handled at a different layer, by Skia, discussed in <span class="xref" itemid="xref_target_Chapter 11">Chapter 11</span> (“Graphics”). Skia rendered font characters into bitmaps (images) using an open source library called FreeType.<sup class="FootnoteReference"><a href="#c14-footnote-15" id="c14-footnoteref-15">15</a></sup></p>
<p>One of the pervasive problems in the early days of Android was performance; the limited capabilities of the hardware at that time drove many of the decisions about the software design and implementation. These decisions bled over into how the code was written for the platform and the applications. As Eric said, “All my attempts at generality were undermined by the urgent performance concerns of running fast enough to be usable on the very slow early hardware. I had to put in all kinds of special fast paths to avoid memory allocation and floating point math when laying out and drawing plain ASCII strings with no style markup and no transformations like ellipsizing or password-hiding.”</p>
<p>Eric observed an ongoing tension on the team, with disagreements on how things should be built. “Sometimes it felt like it shouldn’t have succeeded. It was a classic ‘second system effect’ where a lot of us had done something similar before and thought we could do it again without all the mistakes from the first time. Those of us coming from Danger wanted to <span epub:type="pagebreak" id="Page_145" title="145"/>make another user interface toolkit based on Java class inheritance, but get it right this time with a real operating system underneath and a robust service architecture on the other side of the network. The people coming from PalmSource wanted to do their activity lifecycle model and interprocess communication model again, but get it right this time. The people coming from Skia wanted to do QuickDraw GX again, but get it right this time. We were all wrong, and wrong in ways that clashed badly with each other. It took years of work to straighten out the consequences of all our bad early decisions and the interactions between them.”</p>
<h2 id="h1-502680c14-0003">Romain Guy and UI Toolkit Performance</h2>
<p class="BodyFirst">More help for the budding UI toolkit came later, in 2007, in the form of an intern from France, Romain Guy.</p>
<p>Romain became a tech journalist in high school, writing articles on various programming languages, operating systems, and coding techniques. This freelance job gave him experience in, and access to, many of the popular platforms and languages of that era. He was introduced to operating systems like Linux, AmigaOS, and BeOS, and he became an expert in Java.</p>
<p>Romain went to a university in France and majored in computer science. But that school leaned more heavily on leadership and project management skills than pure programming, and Romain preferred the programming part of software development. So he came to Silicon Valley.<sup class="FootnoteReference"><a href="#c14-footnote-16" id="c14-footnoteref-16">16</a></sup></p>
<p>Romain got an internship with Sun Microsystems,<sup class="FootnoteReference"><a href="#c14-footnote-17" id="c14-footnoteref-17">17</a></sup> where he spent a year working on Swing, the UI toolkit for the Java platform.</p>
<p><span epub:type="pagebreak" id="Page_146" title="146"/>The following year, in April of 2007, Romain came back to the US for an internship at Google. He landed on the Google Books team, where he was asked to work on a desktop application related to Gmail. It wasn’t a topic that excited him, and he only lasted a week on that project. He knew people at Google like Bob Lee (who transferred to Android’s core libraries team around the same time), Dick Wall (who worked on Android developer relations), and Cédric Beust (who was writing the Android Gmail app). They convinced Romain to come over to the Android team, and convinced management that the team needed him. Cédric asked Steve Horowitz to pull strings, and between Steve and Andy, they made it happen.<sup class="FootnoteReference"><a href="#c14-footnote-18" id="c14-footnoteref-18">18</a></sup> Romain transferred to the UI toolkit team, where he helped out Mike Cleron.</p>
<p>At the end of the summer, Romain flew back to France to pick up his degree and then returned to Google<sup class="FootnoteReference"><a href="#c14-footnote-19" id="c14-footnoteref-19">19</a></sup> to start a full-time job. He had gotten offers from both Sun and Google, but decided to join Google. “Sun had made me an offer that was much better than Google’s. I joined the Android team because I loved the vision, the reason why we were doing this. There were a lot of reasons for Google, but it was also the idea: it was a space that could use a good open source operating system. At that time, there was no such thing that was viable for consumers at scale.</p>
<p>“Linux already had something. But to me this had a better chance because it was focused on a particular product. It was not a spec or just an idea of an operating system; it was also building the product. It was clearly a challenge, and chances are it would not succeed, but we had a shot at it. The best way to make it happen was to help.</p>
<p>“It was actually part of what made the job so fun in the early days. Until probably Gingerbread,<sup class="FootnoteReference"><a href="#c14-footnote-20" id="c14-footnoteref-20">20</a></sup> or maybe even ICS,<sup class="FootnoteReference"><a href="#c14-footnote-21" id="c14-footnoteref-21">21</a></sup> it wasn’t clear it was successful <span epub:type="pagebreak" id="Page_147" title="147"/>enough to survive. Every release was not quite a ‘do-or-die,’ but it was ‘do-or-maybe you should be careful about what’s going to happen.’”</p>
<p>When Romain started as a full time employee, in October of 2007, the initial SDK was about to ship. There was still a lot of work to do on the platform to make it to 1.0. One of the first things he worked on was making touch input functional, which had become a hard requirement for that first release.</p>
<p>He also spent significant time and effort making the toolkit code faster. “Mike asked me to improve performance of invalidating<sup class="FootnoteReference"><a href="#c14-footnote-22" id="c14-footnoteref-22">22</a></sup> and re-layout.<sup class="FootnoteReference"><a href="#c14-footnote-23" id="c14-footnoteref-23">23</a></sup> Until then, <code>invalidate()</code><sup class="FootnoteReference"><a href="#c14-footnote-24" id="c14-footnoteref-24">24</a></sup> was really dumb; it would just go up the hierarchy and mark everything invalid. If you did it again, it would go back up again. It was really slow. So I spent a lot of time adding all those dirty flags.<sup class="FootnoteReference"><a href="#c14-footnote-25" id="c14-footnoteref-25">25</a></sup> That made a huge difference.”</p>
<p>But to do this work, he needed a tool that didn’t exist.</p>
<p>There is a grand tradition on the Android team of having many small, single-purpose developer tools, each of which worked a bit differently than the others, and none of which worked together. This has changed over time, and most of these apps are now incorporated into the Android Studio IDE so that developers have consistent tools. But in the early days, the tools were written separately, one by one, by the developers who needed them. </p>
<p>For the view invalidation performance work, Romain needed a new tool. “I wrote ‘hierarchyviewer’ because it was really hard to know what was getting invalidated. So I wrote this viewer that would show me the tree of views and blink them a different color when they were marked dirty, when they would draw, and when there was a <code>requestLayout()</code>.<sup class="FootnoteReference"><a href="#c14-footnote-26" id="c14-footnoteref-26">26</a></sup> As I was making optimizations, I could see what was happening. It would blink less!”</p>
<p><span epub:type="pagebreak" id="Page_148" title="148"/>Another UI performance project that Romain took on was ListView.</p>
<p>ListView is a container that holds (wait for it . . . ) a list of items. The trick with this element in particular is that it is, by its very nature, incredibly performance-sensitive. Its only purpose is to contain tons of data (images and text) and to be able to scroll through the items quickly. The key is “quickly.” As items are coming onto the screen, the UI toolkit has to create, size, and place all of these new items, which then disappear as soon as they scroll off the other edge of the screen. It’s a lot of effort to do all of this, and on that early hardware the toolkit couldn’t keep up with it, so the user experience was . . . not great.</p>
<p>When Romain inherited this widget from Mike Cleron, it was able to contain, render, and scroll items. But its performance was far from acceptable, so Romain put a huge amount of effort into optimizing it. Avoiding object and UI element creation was a general pattern of Android development at the time for performance reasons, and ListView was an easy place to see why that pattern evolved.</p>
<h2 id="h1-502680c14-0004">Launcher and Apps</h2>
<p class="BodyFirst">Like others on the team, Romain jumped into many other projects on Android in those early days (and beyond). Besides his core UI toolkit responsibilities, he took over the launcher application from Mike (who had started to lead the framework team and had other responsibilities beyond code), and also helped out on the Email<sup class="FootnoteReference"><a href="#c14-footnote-27" id="c14-footnoteref-27">27</a></sup> app when the contractor working on it left. Fortunately, Romain had relevant experience from his time as a tech journalist. “I had written articles on how to implement the IMAP protocol, so I was not completely out of my league. But that was on top of everything else that we were doing . . . which was a little much.”</p>
<p>He also helped out with other apps. Since the platform was new, a lot of functionality was developed in response to application requirements. Applications needed new features from the platform, so they worked with the platform team to implement them.</p>
<p><span epub:type="pagebreak" id="Page_149" title="149"/>One of the ongoing efforts for the apps teams at that time was performance. “Serving their needs was important, but also having them understand the cost of things. That’s why hierarchyviewer came to be, because apps were creating way too many views. View hierarchies were way too expensive for our devices. That was a way to show them, ‘You can see this monster tree that you’ve created, and this is very expensive for us.’ Despite all of the optimizations we had, that was very expensive. So it was a way to help them figure out how to optimize their code. That’s how I also came up with the <code>merge</code> tag, the <code>include</code> tag, and the <code>viewstub</code>,<sup class="FootnoteReference"><a href="#c14-footnote-28" id="c14-footnoteref-28">28</a></sup> to help them achieve what they need, but also reclaim some of that performance.”</p>
<h2 id="h1-502680c14-0005">Manifest Density</h2>
<p class="BodyFirst">After 1.0 shipped, there was still plenty of work to do to get the platform to the state the team originally envisioned. One of the projects that had begun early on but which wasn’t fully realized at 1.0 was support for different screen densities, which is described earlier in the Resources section of <span class="xref" itemid="xref_target_Chapter 13">Chapter 13</span> (“Framework”). After 1.0, Romain took over the work begun earlier by Dianne and finished it off in time for the Eclair release,<sup class="FootnoteReference"><a href="#c14-footnote-29" id="c14-footnoteref-29">29</a></sup> in the Fall of 2009.</p>
<p>Screen density has a direct impact on the quality of the images on that screen; a screen with higher density can represent more information in the same space, leading to sharper, better images. Higher-density screens have resulted in higher-quality phone and laptop displays over the last several years. Higher-density camera sensors have also led to higher-quality photos, as the megapixel count of images produced from those sensors has soared.<sup class="FootnoteReference"><a href="#c14-footnote-30" id="c14-footnoteref-30">30</a></sup></p>
<p>The initial G1 device, and all other Android devices until the Droid, had a density of 160 pixels per inch (PPI), which meant that there were 160 distinct color values (vertically and horizontally) in every inch of screen real <span epub:type="pagebreak" id="Page_150" title="150"/>estate. The Droid had a density of 265 PPI. This higher density meant that more information could be represented, resulting in, say, smoother curved lines and text, or images with more detail. But developers needed a way to define their UIs to take advantage of these changes in density.</p>
<p>The system that Dianne, and then Romain, implemented allowed developers to define their UIs independent of the actual size of the pixels on a device, using the unit <em>dp</em> (<em>density-independent pixel</em>). The system would then scale these UIs appropriately based on the actual density of the device that the application was running on. This mechanism for handling screen density, along with related capabilities in the resource system for serving up different assets based on the density and the entire UI layout system for handling UI organization independent of screen sizes, were critical as Android matured. Android changed from a platform running on top of only one kind of device (the G1 and its follow-on devices at the same size and density) to a world full of all kinds of screen sizes and densities as manufacturers started to introduce vastly different formats for their customers.</p>
<h2 id="h1-502680c14-0006">Toolkit Performance</h2>
<p class="BodyFirst">Many pieces make up what the team calls the UI toolkit, since it’s basically the visual side of the entire framework. What really defined the work for the team at that time (Joe, Mike, Eric, Romain, and others) was coming up with the toolkit APIs and core functionality, and then working on performance, performance, and performance.<sup class="FootnoteReference"><a href="#c14-footnote-31" id="c14-footnoteref-31">31</a></sup> The UI for Android is basically everything that the user sees, so performance for this front line of the platform is even more important, because problems there are so very noticeable. So the team kept optimizing things . . . and to some extent, still does.</p>
</section>
<section class="footnotes">
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-1" id="c14-footnote-1">1.</a></sup>  Joe: “I had The Postal Service / <em>Give Up</em> CD playing on repeat for that coding binge. I still have weird delirious memories when I hear that album.”</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-2" id="c14-footnote-2">2.</a></sup>  A kernel panic is essentially a complete OS crash. A Linux kernel panic is the equivalent of the Blue Screen of Death on Windows.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-3" id="c14-footnote-3">3.</a></sup>  An explanation of multi-threaded programming is . . . way beyond the scope of this book. Suffice it to say that a multi-threaded architecture is much more complicated than a single-threaded one because the UI code is not as much in control of when it is being called from various parts of the application, potentially in parallel on different threads.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-4" id="c14-footnote-4">4.</a></sup>  The VT100 was a video terminal connected to a larger computer in some back room, showing text characters. These terminals were common in the days before everyone had PCs, much less laptops, and pre-dated the graphical interfaces that became common after MacOS and Windows became pervasive. </p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-5" id="c14-footnote-5">5.</a></sup>  Launcher is what the team calls the home app, which consists of the home screen and the <em>all apps</em> screen. Launcher is in charge of starting (launching) applications when users tap on their icons.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-6" id="c14-footnote-6">6.</a></sup>  Yes, there was a framework team in the framework team. Recursion is so important in software that it’s used even in organizational structures. It all started out as a small group called the framework team, which did all of this stuff. But as the team grew and people focused on various aspects of it (like the system UI and UI toolkit), then the larger framework team comprised several sub-teams, including the actual “framework” team, which handled the non-UI portions of the APIs and OS. </p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-7" id="c14-footnote-7">7.</a></sup>  Mike continued to manage that overall framework team until 2018. He was my manager for several years when I worked on the UI toolkit team.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-8" id="c14-footnote-8">8.</a></sup>  The complexity of multi-threaded programming is that any thread can change values of things like member variables at any time. So if one thread assumes a certain value and then another thread changes it, it can lead to inconsistencies and unpredictable outcomes.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-9" id="c14-footnote-9">9.</a></sup>  Chris was an engineer on the framework team.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-10" id="c14-footnote-10">10.</a></sup>  CL = Changelist, discussed in the Jargon appendix.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-11" id="c14-footnote-11">11.</a></sup>  And still has, to this day. It’s much larger, of course, after a growing team of developers have worked on it, adding functionality and fixes over the last many years, but it’s still the fundamental View system that Joe wrote overnight and then Mike rewrote to be single-threaded.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-12" id="c14-footnote-12">12.</a></sup>  The “candybar” form factor, with the screen at the top and keyboard at the bottom, was named for its long, rectangular shape, which resembled a chocolate candy bar (maybe, if you squinted really hard and were really hungry for dessert).</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-13" id="c14-footnote-13">13.</a></sup>  Arabic languages require bi-directional text support, which was finally implemented years later in 2011 for the Ice Cream Sandwich release (Android 4.0) by Fabrice DiMeglio and engineers on Google’s internationalization team.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-14" id="c14-footnote-14">14.</a></sup>  ASCII and EBCDIC were competing standards for encoding text characters for computers. EBCDIC offered a larger character set (256 vs. 128), but was more complicated and non-intuitive for programmers. UNICODE is an international standard for text encoding, which incorporates ASCII (plus a lot more).</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-15" id="c14-footnote-15">15.</a></sup>  Coincidentally, FreeType was created by David Turner, who joined Android in late 2006 to work on completely unrelated technology, the Android emulator.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-16" id="c14-footnote-16">16.</a></sup>  This dynamic of programming vs. managing continues to this day. I have friends in, and have talked to many developers in, various countries where simply being a programmer is not respected, or compensated, as much as being a manager of programmers. But being good as a programmer doesn’t necessarily mean someone will be good at (or interested in) managing programmers. So developers that are passionate about programming and want to continue to do that job, while earning more money and respect than their society allows, end up either forming a consulting company (which bills companies for far more than the companies pay their full-time programmers) or giving up and moving to another place (like Silicon Valley) where the job of programming is more highly respected (and compensated). </p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-17" id="c14-footnote-17">17.</a></sup>  Sun is where I first met Romain, in 2005. I was on the same team, working on graphics. We started writing a book together on Java UI technology, which we finished while he was back in France, finishing his degree. The book is called <em>Filthy Rich Clients</em> . . . but that’s another story altogether.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-18" id="c14-footnote-18">18.</a></sup>  Dick Wall had that same conversation with Steve. Perhaps Romain wasn’t transferred because of their glowing recommendations as much as Steve wanting to stop people asking him about it.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-19" id="c14-footnote-19">19.</a></sup>  Meanwhile, I was still back at Sun, arguing that he should rejoin the Java client group there. But he decided to join Google and Android instead. In hindsight, he probably made the right career choice (one which I would make a few months later, leaving Sun in 2008 and eventually joining Android in 2010).</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-20" id="c14-footnote-20">20.</a></sup>  Android 2.3, released in late 2010</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-21" id="c14-footnote-21">21.</a></sup>  ICS = Ice Cream Sandwich, or Android 4.0, released in late 2011</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-22" id="c14-footnote-22">22.</a></sup>  “Invalidation” happens when UI objects have changed (like the text on a button changing) and may need to be redrawn.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-23" id="c14-footnote-23">23.</a></sup>  “Re-layout” happens when UI elements are added, removed, resized, or repositioned, causing other containers and elements to reposition and resize themselves accordingly.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-24" id="c14-footnote-24">24.</a></sup>  <span class="LiteralFootnote"><code>invalidate()</code></span> is the method that is called to trigger invalidation.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-25" id="c14-footnote-25">25.</a></sup>  The UI drawing code tends to be very fragile because there are many “flags” that hold information about the drawn state of each UI element. That complex logic helped Android become fast enough to be usable on those early devices. But it created code that was somewhat brittle and difficult to maintain. Many times, someone would fix a bug or implement a new feature only to trip over these flags and unintentionally break some of the invalidation logic.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-26" id="c14-footnote-26">26.</a></sup>  <span class="LiteralFootnote"><code>requestLayout()</code></span> is the method that is called to trigger the re-layout process mentioned earlier.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-27" id="c14-footnote-27">27.</a></sup>  Email was, at that time and for a few years after that, separate from Gmail. Gmail was the app used to retrieve mail for a Gmail account . . . and that’s it. Email was used to connect to other mail services on the backend, like Microsoft Exchange.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-28" id="c14-footnote-28">28.</a></sup>  <span class="LiteralFootnote"><code>merge</code></span>, <span class="LiteralFootnote"><code>include</code></span>, and <span class="LiteralFootnote"><code>viewstub</code></span> are all UI elements that essentially work like placeholders in the hierarchy and help minimize the number of views, and therefore the overhead for the toolkit.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-29" id="c14-footnote-29">29.</a></sup>  Eclair was the release that Droid shipped with. The Droid had a higher screen density than the previous devices, so it was important that the density work was finished by then.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-30" id="c14-footnote-30">30.</a></sup>  How fitting that Romain worked on pixel density; his hobby is landscape photography (you can see some of his work at <a class="LinkURL" href="https://www.flickr.com/romainguy">https://www.flickr.com/romainguy</a>, as well as on ChromeCast screensavers). So he benefited from advancements in hardware pixel density at the same time as he was enabling Android to take advantage of those improvements.</p></aside>
<aside class="FootnoteEntry"><p><sup class="FootnoteReference"><a href="#c14-footnoteref-31" id="c14-footnote-31">31.</a></sup>  Performance was everyone’s responsibility, but in late 2006 Jason Parks created the Turtle Team, a group of people who reviewed and worked on app performance on an ongoing basis.</p></aside>
</section>
</body>
</html>