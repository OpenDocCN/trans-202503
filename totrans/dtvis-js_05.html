<html><head></head><body><section class="chapter" title="Chapter&#xA0;5.&#xA0;Displaying Timelines" epub:type="chapter" id="displaying_timelines"><div class="titlepage"><div><div><h2 class="title">Chapter 5. Displaying Timelines</h2></div></div></div><p><a id="iddle2037" class="indexterm"/>The most compelling visualizations often succeed because they tell a story; they extract a narrative from data and reveal that narrative to their users. And as with any narrative, time is a critical component. If the data consists solely of numbers, a standard bar or line chart can easily show its evolution over time. If the data is not numerical, however, standard charts probably won’t work. This chapter considers several alternatives for time-based visualizations.</p><p><a id="iddle1125" class="indexterm"/><a id="iddle1784" class="indexterm"/><a id="iddle1795" class="indexterm"/><a id="iddle2034" class="indexterm"/>All are based on some variation of a timeline; one linear dimension represents time, and events are places along that dimension based on when they occurred. In all of the examples, we’ll consider the same underlying data: a possible chronology of the plays of William Shakespeare (<span class="emphasis"><em><a class="ulink" href="http://en.wikipedia.org/wiki/Chronology_of_Shakespeare%27s_plays" target="_top">http://en.wikipedia.org/wiki/Chronology_of_Shakespeare%27s_plays</a></em></span>).</p><p>We’ll look at three very different approaches for adding timelines to web pages. One option relies on a JavaScript library, and it follows a process similar to many other visualizations in the book. The other two techniques, however, offer a different perspective. In one, we won’t use a visualization library at all. Instead, we’ll build a timeline with basic JavaScript, HTML, and CSS, and we’ll see how to do that both with and without jQuery. The final example shows the other extreme. It relies on a full-featured web component available from an external website. In short, we’ll look at the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>How to use a library to create timelines</p></li><li class="listitem"><p>How to create timelines without a library using only JavaScript, HTML, and CSS</p></li><li class="listitem"><p>How to integrate a timeline component in a web page</p></li></ul></div><div class="sect1" title="Building Timelines with a Library"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="building_timelines_with_a_library">Building Timelines with a Library</h2></div></div></div><p>First, we’ll build the timeline using the Chronoline.js library (<span class="emphasis"><em><a class="ulink" href="http://stoicloofah.github.io/chronoline.js/" target="_top">http://stoicloofah.github.io/chronoline.js/</a></em></span>), which works a lot like most of the other JavaScript libraries we’ve used in the book. You include the library in your page, define your data, and let the library create the visualization.</p><div class="sect2" title="Step 1: Include the Required Libraries"><div class="titlepage"><div><div><h3 class="title" id="step_1_include_the_required_libr-id00022">Step 1: Include the Required Libraries</h3></div></div></div><p>The Chronoline.js library itself depends on a few other libraries, and we’ll need to include all of them in our pages.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>jQuery (<span class="emphasis"><em><a class="ulink" href="http://jquery.com/" target="_top">http://jquery.com/</a></em></span>)</p></li><li class="listitem"><p>qTip2, including its style sheet (<span class="emphasis"><em><a class="ulink" href="http://qtip2.com/" target="_top">http://qtip2.com/</a></em></span>)</p></li><li class="listitem"><p>Raphaël (<span class="emphasis"><em><a class="ulink" href="http://raphaeljs.com/" target="_top">http://raphaeljs.com/</a></em></span>)</p></li></ul></div><p>All of these libraries are popular enough for public content distribution networks to support, so we’ll use CloudFlare’s CDN in the following markup. We’ll have to use our own resources, however, to host Chronoline.js itself. That library also defines its own style sheet.</p><a id="pro_id00199"/><pre class="programlisting">   <span class="dodgerblue">&lt;!DOCTYPE</span> html<span class="dodgerblue">&gt;</span>
   <span class="steelblue"><span class="strong"><strong>&lt;html</strong></span></span> <span class="steelblue">lang=</span><span class="maroon">"en"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
     <span class="steelblue"><span class="strong"><strong>&lt;head&gt;</strong></span></span>
       <span class="steelblue"><span class="strong"><strong>&lt;meta</strong></span></span> <span class="steelblue">charset=</span><span class="maroon">"utf-8"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
       <span class="steelblue"><span class="strong"><strong>&lt;title&gt;&lt;/title&gt;</strong></span></span>
       <span class="steelblue"><span class="strong"><strong>&lt;link</strong></span></span> <span class="steelblue">rel=</span><span class="maroon">"stylesheet"</span> <span class="steelblue">type=</span><span class="maroon">"text/css"</span>
             <span class="steelblue">href=</span><span class="maroon">"//cdnjs.cloudflare.com/ajax/libs/qtip2/2.2.0/jquery.qtip.css"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
       <span class="steelblue"><span class="strong"><strong>&lt;link</strong></span></span> <span class="steelblue">rel=</span><span class="maroon">"stylesheet"</span> <span class="steelblue">type=</span><span class="maroon">"text/css"</span>
             <span class="steelblue">href=</span><span class="maroon">"css/chronoline.css"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
     <span class="steelblue"><span class="strong"><strong>&lt;/head&gt;</strong></span></span>
     <span class="steelblue"><span class="strong"><strong>&lt;body&gt;</strong></span></span>
➊   <span class="steelblue"><span class="strong"><strong>&lt;div</strong></span></span> <span class="steelblue">id=</span><span class="maroon">"timeline"</span><span class="steelblue"><span class="strong"><strong>&gt;&lt;/div&gt;</strong></span></span>
        <span class="steelblue"><span class="strong"><strong>&lt;script</strong></span></span> <span class="steelblue">src=</span><span class="maroon">"//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
        <span class="steelblue"><span class="strong"><strong>&lt;/script&gt;</strong></span></span>
        <span class="steelblue"><span class="strong"><strong>&lt;script</strong></span></span> <span class="steelblue">src=</span><span class="maroon">"//cdnjs.cloudflare.com/ajax/libs/qtip2/2.2.0/jquery.qtip.min.js"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
        <span class="steelblue"><span class="strong"><strong>&lt;/script&gt;</strong></span></span>
        <span class="steelblue"><span class="strong"><strong>&lt;script</strong></span></span> <span class="steelblue">src=</span><span class="maroon">"//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.2/raphael-min.js"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
        <span class="steelblue"><span class="strong"><strong>&lt;/script&gt;</strong></span></span>
       <span class="steelblue"><span class="strong"><strong>&lt;script</strong></span></span> <span class="steelblue">src=</span><span class="maroon">"js/chronoline.js"</span><span class="steelblue"><span class="strong"><strong>&gt;&lt;/script&gt;</strong></span></span>
     <span class="steelblue"><span class="strong"><strong>&lt;/body&gt;</strong></span></span>
   <span class="steelblue"><span class="strong"><strong>&lt;/html&gt;</strong></span></span></pre><p><a id="iddle1126" class="indexterm"/><a id="iddle2035" class="indexterm"/>As you can see at ➊, we’ve set aside a <code class="literal">&lt;div&gt;</code> to hold our timeline. We’ve also included the JavaScript libraries as the last part of the <code class="literal">&lt;body&gt;</code> element, as that provides the best browser performance.</p></div><div class="sect2" title="Step 2: Prepare the Data"><div class="titlepage"><div><div><h3 class="title" id="step_2_prepare_the_data-id00023">Step 2: Prepare the Data</h3></div></div></div><p>The data for our timeline comes from Wikipedia (<span class="emphasis"><em><a class="ulink" href="http://en.wikipedia.org/wiki/Chronology_of_Shakespeare%27s_plays" target="_top">http://en.wikipedia.org/wiki/Chronology_of_Shakespeare%27s_plays</a></em></span>). As a JavaScript object, that data might be structured like the following excerpt:</p><a id="pro_id00200"/><pre class="programlisting">[
  {
    <span class="maroon">"play"</span>: <span class="maroon">"The Two Gentlemen of Verona"</span>,
    <span class="maroon">"date"</span>: <span class="maroon">"1589-1591"</span>,
    <span class="maroon">"record"</span>: <span class="maroon">"Francis Meres'..."</span>,
    <span class="maroon">"published"</span>: <span class="maroon">"First Folio (1623)"</span>,
    <span class="maroon">"performance"</span>: <span class="maroon">"adaptation by Benjamin Victor..."</span>,
    <span class="maroon">"evidence"</span>: <span class="maroon">"The play contains..."</span>
}, {
    <span class="maroon">"play"</span>: <span class="maroon">"The Taming of the Shrew"</span>,
    <span class="maroon">"date"</span>: <span class="maroon">"1590-1594"</span>,
    <span class="maroon">"record"</span>: <span class="maroon">"possible version..."</span>,
    <span class="maroon">"published"</span>: <span class="maroon">"possible version..."</span>,
    <span class="maroon">"performance"</span>: <span class="maroon">"According to Philip Henslowe..."</span>,
    <span class="maroon">"evidence"</span>: <span class="maroon">"Kier Elam posits..."</span>
}, {
    <span class="maroon">"play"</span>: <span class="maroon">"Henry VI, Part 2"</span>,
    <span class="maroon">"date"</span>: <span class="maroon">"1590-1591"</span>,
    <span class="maroon">"record"</span>: <span class="maroon">"version of the..."</span>,
    <span class="maroon">"published"</span>: <span class="maroon">"version of the..."</span>,
    <span class="maroon">"performance"</span>: <span class="maroon">"although it is known..."</span>,
    <span class="maroon">"evidence"</span>: <span class="maroon">"It is known..."</span>
},
<span class="indianred"><span class="emphasis"><em>// Data set continues...</em></span></span></pre><p>You can see the complete data set in the book’s source code (<span class="emphasis"><em><a class="ulink" href="http://jsDataV.is/source/" target="_top">http://jsDataV.is/source/</a></em></span>).</p><p><a id="iddle1124" class="indexterm"/><a id="iddle1127" class="indexterm"/><a id="iddle1414" class="indexterm"/><a id="iddle1628" class="indexterm"/><a id="iddle2033" class="indexterm"/><a id="iddle2036" class="indexterm"/>Before we can use Chronoline.js, we have to convert the raw data into the format the library expects. Since we have jQuery available, we can take advantage of its <code class="literal">.map()</code> function for the conversion. (For details on <code class="literal">.map()</code>, see Step 7 of <a class="xref" href="ch02.html#selecting_chart_content" title="Selecting Chart Content">Selecting Chart Content</a> in <a class="xref" href="ch02.html#step_7_determine_chart_data_based_on_the" title="Step 7: Determine Chart Data Based on the Interaction State">Step 7: Determine Chart Data Based on the Interaction State</a>.)</p><a id="pro_id00201"/><pre class="programlisting">   <span class="steelblue"><span class="strong"><strong>var</strong></span></span> events = <span class="steelblue">$</span>.<span class="olive">map</span>(plays, <span class="steelblue"><span class="strong"><strong>function</strong></span></span>(play) {
       <span class="steelblue"><span class="strong"><strong>var</strong></span></span> event = {};
       <span class="steelblue">event</span>.<span class="olive">title</span> = <span class="steelblue">play</span>.<span class="olive">play</span>;
➊     <span class="steelblue"><span class="strong"><strong>if</strong></span></span> (<span class="steelblue">play</span>.<span class="steelblue">date</span>.<span class="olive">indexOf</span>(<span class="maroon">"-"</span>) !== -<span class="red">1</span>) {
           <span class="steelblue"><span class="strong"><strong>var</strong></span></span> daterange = <span class="steelblue">play</span>.<span class="steelblue">date</span>.<span class="olive">split</span>(<span class="maroon">"-"</span>);
➋         <span class="steelblue">event</span>.<span class="olive">dates</span> = [<span class="steelblue"><span class="strong"><strong>new</strong></span></span> <span class="olive">Date</span>(daterange[<span class="red">0</span>], <span class="red">0</span>, <span class="red">1</span>),
                          <span class="steelblue"><span class="strong"><strong>new</strong></span></span> <span class="olive">Date</span>(daterange[<span class="red">1</span>], <span class="red">11</span>, <span class="red">31</span>)]
       } <span class="steelblue"><span class="strong"><strong>else</strong></span></span> {
➌          <span class="steelblue">event</span>.<span class="olive">dates</span> = [<span class="steelblue"><span class="strong"><strong>new</strong></span></span> <span class="olive">Date</span>(<span class="steelblue">play</span>.<span class="olive">date</span>, <span class="red">0</span>, <span class="red">1</span>), <span class="steelblue"><span class="strong"><strong>new</strong></span></span> <span class="olive">Date</span>(<span class="steelblue">play</span>.<span class="olive">date</span>, <span class="red">11</span>, <span class="red">31</span>)]
       }
       <span class="steelblue"><span class="strong"><strong>return</strong></span></span> event;
   });</pre><p>As you can see from our data set, some of the plays have a single year as their date, while others have a range of years (two dates separated by a dash). To set the date range for Chronoline.js, we check for a dash at ➊. If one is present, we split the date string at that dash and set a multiyear range at ➋. Otherwise, we set the range to a single year at ➌.</p><div class="note" title="Note"><h3 class="title"><a id="ch05note01"/>Note</h3><p><span class="strong"><strong>Recall that the JavaScript <code class="literal">Date</code> object numbers months from <code class="literal">0</code> rather than <code class="literal">1</code>.</strong></span></p></div></div><div class="sect2" title="Step 3: Draw the Timeline"><div class="titlepage"><div><div><h3 class="title" id="step_3_draw_the_timeline">Step 3: Draw the Timeline</h3></div></div></div><p>To draw the timeline, we create a new <code class="literal">Chronoline</code> object, passing it the HTML container element, our event data, and any options. The HTML container element should be a native element, not a jQuery selection. To convert from a selection to a native element, we use the <code class="literal">get()</code> method. In this case, we want the first element, so we use the parameter <code class="literal">0</code>.</p><a id="pro_id00202"/><pre class="programlisting"><span class="olive">$</span>(<span class="steelblue"><span class="strong"><strong>function</strong></span></span>() {
    <span class="steelblue"><span class="strong"><strong>var</strong></span></span> timeline = <span class="steelblue"><span class="strong"><strong>new</strong></span></span> <span class="olive">Chronoline</span>(<span class="olive">$</span>(<span class="maroon">"#timeline"</span>).<span class="olive">get</span>(<span class="red">0</span>), events, {});
}</pre><p>If we try to use the default options of Chronoline.js with our data, however, the result is quite disappointing. (In fact, it’s illegible and not worth reproducing at this point.) We can fix that in the next step with some additional options.</p></div><div class="sect2" title="Step 4: Set Chronoline.js Options for the Data"><div class="titlepage"><div><div><h3 class="title" id="step_4_set_chronolinedotjs_options_for_t">Step 4: Set Chronoline.js Options for the Data</h3></div></div></div><p>The Chronoline.js library has default options that are well suited for its original application, but they don’t work so well for Shakespeare’s plays. Fortunately, we can change the options from the default values. As of this writing, Chronoline.js <a id="iddle1109" class="indexterm"/>doesn’t have much documentation on its options; to see the full set, you would normally have to examine the source code. We’ll cover the most important options here, though.</p><p>One of the most obvious problems with the Chonoline.js defaults is the date shown in the initial view. Chronoline.js starts by displaying the current date by default. Since our timeline ends in 1613, the user would have to scroll backward for a long time to see anything meaningful. We can change this view by giving Chronoline.js a different start date for the initial view:</p><a id="pro_id00203"/><pre class="programlisting">defaultStartDate: <span class="steelblue"><span class="strong"><strong>new</strong></span></span> <span class="olive">Date</span>(<span class="red">1589</span>, <span class="red">0</span>, <span class="red">1</span>),</pre><p>As long as we’re setting the timeline to start somewhere near Shakespeare’s lifetime, there’s no need for Chronoline.js to add a special mark for the current date, so we use this simple option to tell it not to bother:</p><a id="pro_id00204"/><pre class="programlisting">markToday: <span class="steelblue"><span class="strong"><strong>false</strong></span></span>,</pre><p>The next major problem to address is the labeling. By default, Chronoline.js tries to label every day on the timeline. As our events span 24 years, we don’t need that granularity. Instead, we can tell Chronoline.js just to label the years. For the same reason, we also need to change the checkmarks. Instead of every day, we need checkmarks only for every month.</p><p>To change both of these options, we supply Chronoline.js with a pair of functions to call.</p><a id="pro_id00205"/><pre class="programlisting">hashInterval: <span class="steelblue"><span class="strong"><strong>function</strong></span></span>(date) {
    <span class="steelblue"><span class="strong"><strong>return</strong></span></span> <span class="steelblue">date</span>.<span class="olive">getDate</span>() === <span class="red">1</span>;
},
labelInterval: <span class="steelblue"><span class="strong"><strong>function</strong></span></span>(date) {
    <span class="steelblue"><span class="strong"><strong>return</strong></span></span> <span class="steelblue">date</span>.<span class="olive">getMonth</span>() === <span class="red">0</span> &amp;&amp; <span class="steelblue">date</span>.<span class="olive">getDate</span>() === <span class="red">1</span>;
},</pre><p>Chronoline.js passes each of these functions a date object, and the functions return <code class="literal">true</code> or <code class="literal">false</code> depending on whether the date merits a checkmark or label. For checkmarks, we return <code class="literal">true</code> only on the first day of the month. We return <code class="literal">true</code> for labels only on January 1.</p><p>By default, Chronoline.js will try to show a full date for each label. Since we only want to label each year, we’ll change the label format to just show the year. The details for the format specification are based on a standard C++ library (<span class="emphasis"><em><a class="ulink" href="http://www.cplusplus.com/reference/ctime/strftime/" target="_top">http://www.cplusplus.com/reference/ctime/strftime/</a></em></span>).</p><a id="pro_id00206"/><pre class="programlisting">labelFormat: <span class="maroon">"%Y"</span>,</pre><p>For our last adjustments to the labeling, we remove the “sublabels” and “sub-sublabels” that Chronoline.js adds by default. Those labels don’t provide any value in our case.</p><a id="pro_id00207"/><pre class="programlisting">subLabel: <span class="steelblue"><span class="strong"><strong>null</strong></span></span>,
subSubLabel: <span class="steelblue"><span class="strong"><strong>null</strong></span></span>,</pre><p><a id="iddle1250" class="indexterm"/>We also want to change the span of time that Chronoline.js displays in the timeline. For our data, showing a span of five years at a time seems good.</p><a id="pro_id00208"/><pre class="programlisting">visibleSpan: DAY_IN_MILLISECONDS * <span class="red">366</span> * <span class="red">5</span>,</pre><p>Note that the variable <code class="literal">DAY_IN_MILLISECONDS</code> is defined by Chronoline.js itself. We’re free to use it in this or any other option setting.</p><p>Now we can address the timeline scrolling. Chronoline.js normally advances the timeline by a single day with each click. That would result in some rather tedious scrolling for our users. Instead of the default behavior, we’ll have Chronoline.js advance by a full year. As with the labels, we change this behavior by supplying Chronoline.js with a function. That function is passed a date object, and it should return a new date object to which Chronoline.js should scroll. In our case, we simply add or subtract one from the year value.</p><a id="pro_id00209"/><pre class="programlisting">scrollLeft: <span class="steelblue"><span class="strong"><strong>function</strong></span></span>(date) {
    <span class="steelblue"><span class="strong"><strong>return</strong></span></span> <span class="steelblue"><span class="strong"><strong>new</strong></span></span> <span class="olive">Date</span>(<span class="steelblue">date</span>.<span class="olive">getFullYear</span>() - <span class="red">1</span>, <span class="steelblue">date</span>.<span class="olive">getMonth</span>(), <span class="steelblue">date</span>.<span class="olive">getDate</span>());
},
scrollRight: <span class="steelblue"><span class="strong"><strong>function</strong></span></span>(date) {
    <span class="steelblue"><span class="strong"><strong>return</strong></span></span> <span class="steelblue"><span class="strong"><strong>new</strong></span></span> <span class="olive">Date</span>(<span class="steelblue">date</span>.<span class="olive">getFullYear</span>() + <span class="red">1</span>, <span class="steelblue">date</span>.<span class="olive">getMonth</span>(), <span class="steelblue">date</span>.<span class="olive">getDate</span>());
},</pre><p>The last few adjustments clean up the appearance and behavior of Chronoline.js. Adding some extra space (in our case, three months) before the start and after the end of the timeline gives the data a bit of room.</p><a id="pro_id00210"/><pre class="programlisting">timelinePadding: DAY_IN_MILLISECONDS * <span class="red">366</span> / <span class="red">4</span>,</pre><p>We can also make the scrolling animate smoothly instead of jumping, enable users to drag the timeline right or left, and improve the default browser tool tips.</p><a id="pro_id00211"/><pre class="programlisting">animated: <span class="steelblue"><span class="strong"><strong>true</strong></span></span>,
draggable: <span class="steelblue"><span class="strong"><strong>true</strong></span></span>,
tooltips: <span class="steelblue"><span class="strong"><strong>true</strong></span></span>,</pre><p>For the final tweaks, we can change the appearance of the timeline. To change the color and size of the events, we use the following options:</p><a id="pro_id00212"/><pre class="programlisting">eventAttrs: { <span class="indianred"><span class="emphasis"><em>// attrs for the bars and circles of the events</em></span></span>
    <span class="dodgerblue">fill</span>: <span class="maroon">"#ffa44f"</span>,
    <span class="dodgerblue">stroke</span>: <span class="maroon">"#ffa44f"</span>,
    <span class="maroon">"stroke-width"</span>: <span class="red">1</span>
},
eventHeight: <span class="red">10</span>,</pre><p><a id="iddle1079" class="indexterm"/><a id="iddle1537" class="indexterm"/><a id="iddle2029" class="indexterm"/>To change the color of the scroll buttons, we have to modify the <span class="emphasis"><em>chronoline.css</em></span> style sheet. The property to change is <code class="literal">background-color</code>.</p><a id="pro_id00213"/><pre class="programlisting"><span class="red">.chronoline-left</span><span class="red">:hover</span>,
<span class="red">.chronoline-right</span><span class="red">:hover</span> <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>opacity:</strong></span></span> <span class="dodgerblue">1</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>filter:</strong></span></span> alpha(opacity=<span class="dodgerblue">100</span>)<span class="steelblue"><span class="strong"><strong>;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>background-color:</strong></span></span> <span class="dodgerblue">#97aceb</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p>With those changes, we finally have a timeline of Shakespeare’s plays, as shown in <a class="xref" href="ch05.html#chronolinedotjs_library_creates_a_simple" title="Figure 5-1. The Chronoline.js library creates a simple, interactive timeline.">Figure 5-1</a>.</p><div class="figure"><a id="chronolinedotjs_library_creates_a_simple"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00074"/><img src="figs/web/05fig01.png.jpg" alt="The Chronoline.js library creates a simple, interactive timeline."/></div></div><div class="figure-title">Figure 5-1. The Chronoline.js library creates a simple, interactive timeline.</div></div><p>The resulting timeline looks pretty good, but the limitations of the library make it difficult to customize and enhance the timeline further. Next, we’ll build a new timeline from scratch without the library so we have complete control.</p></div></div><div class="sect1" title="Building Timelines with JavaScript"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="building_timelines_with_javascript">Building Timelines with JavaScript</h2></div></div></div><p>If you followed the example in the previous section, you might not be completely satisfied with the results. We did end up with an accurate timeline of Shakespeare’s plays, but the resulting visualization may not be communicating what you want. For example, the timeline doesn’t show the names of the plays unless the user hovers a mouse over that section of the graph. Perhaps we’d rather have the plays’ titles always visible. That kind of problem is a limitation of third-party libraries. The author of Chronoline.js didn’t see the need for displaying titles, so he didn’t offer the option. And unless we’re willing to take on the potentially daunting task of modifying the library’s source code, we can’t make the library do exactly what we want.</p><p>Fortunately, particularly in the case of timelines, we can take a completely different approach. We can create visualizations without using any third-party library at all, which will give us total control over the result. Timelines are especially amenable to this technique because they can be created with nothing more than text and styling. All it takes is a basic understanding of HTML and CSS, plus enough JavaScript to set things up and perhaps provide simple interactions.</p><p><a id="iddle1464" class="indexterm"/><a id="iddle1538" class="indexterm"/><a id="iddle1539" class="indexterm"/><a id="iddle2030" class="indexterm"/><a id="iddle2031" class="indexterm"/>That’s exactly what we’ll do in this example. We’ll start with the same data set as before. Instead of feeding that data into a third-party library, however, we’ll use plain old JavaScript (with an optional dose of jQuery) to construct a pure HTML representation of the data. Then we’ll use CSS to set the appearance of the timeline.</p><div class="sect2" title="Step 1: Prepare the HTML Skeleton"><div class="titlepage"><div><div><h3 class="title" id="step_1_prepare_the_html_skeleton">Step 1: Prepare the HTML Skeleton</h3></div></div></div><p>Without any required libraries, the HTML page for our timeline is pretty simple. All we need is a containing <code class="literal">&lt;div&gt;</code> with a unique <code class="literal">id</code> attribute.</p><a id="pro_id00214"/><pre class="programlisting"><span class="dodgerblue">&lt;!DOCTYPE</span> html<span class="dodgerblue">&gt;</span>
<span class="steelblue"><span class="strong"><strong>&lt;html</strong></span></span> <span class="steelblue">lang=</span><span class="maroon">"en"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
  <span class="steelblue"><span class="strong"><strong>&lt;head&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;meta</strong></span></span> <span class="steelblue">charset=</span><span class="maroon">"utf-8"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;title&gt;&lt;/title&gt;</strong></span></span>
  <span class="steelblue"><span class="strong"><strong>&lt;/head&gt;</strong></span></span>
  <span class="steelblue"><span class="strong"><strong>&lt;body&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;div</strong></span></span> <span class="steelblue">id=</span><span class="maroon">"timeline"</span><span class="steelblue"><span class="strong"><strong>&gt;&lt;/div&gt;</strong></span></span>
  <span class="steelblue"><span class="strong"><strong>&lt;/body&gt;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>&lt;/html&gt;</strong></span></span></pre></div><div class="sect2" title="Step 2: Start JavaScript Execution"><div class="titlepage"><div><div><h3 class="title" id="step_2_start_javascript_execution">Step 2: Start JavaScript Execution</h3></div></div></div><p>As soon as the browser has finished loading our page, we can start processing the data. As before, we’ll start with our data formatted as a JavaScript array. You can see the complete data set in the book’s source code (<span class="emphasis"><em><a class="ulink" href="http://jsDataV.is/source/" target="_top">http://jsDataV.is/source/</a></em></span>).</p><a id="pro_id00215"/><pre class="programlisting"><span class="steelblue">window</span>.<span class="olive">onload</span> = <span class="steelblue"><span class="strong"><strong>function</strong></span></span> () {
  <span class="steelblue"><span class="strong"><strong>var</strong></span></span> plays = [
    {
      <span class="maroon">"play"</span>: <span class="maroon">"The Two Gentlemen of Verona"</span>,
      <span class="maroon">"date"</span>: <span class="maroon">"1589-1591"</span>,
      <span class="maroon">"record"</span>: <span class="maroon">"Francis Meres'..."</span>,
      <span class="maroon">"published"</span>: <span class="maroon">"First Folio (1623)"</span>,
      <span class="maroon">"performance"</span>: <span class="maroon">"adaptation by Benjamin Victor..."</span>,
      <span class="maroon">"evidence"</span>: <span class="maroon">"The play contains..."</span>
    }, {
      <span class="maroon">"play"</span>: <span class="maroon">"The Taming of the Shrew"</span>,
      <span class="maroon">"date"</span>: <span class="maroon">"1590-1594"</span>,
      <span class="maroon">"record"</span>: <span class="maroon">"possible version..."</span>,
      <span class="maroon">"published"</span>: <span class="maroon">"possible version..."</span>,
      <span class="maroon">"performance"</span>: <span class="maroon">"According to Philip Henslowe..."</span>,
      <span class="maroon">"evidence"</span>: <span class="maroon">"Kier Elam posits..."</span>
    }, {
      <span class="maroon">"play"</span>: <span class="maroon">"Henry VI, Part 2"</span>,
      <span class="maroon">"date"</span>: <span class="maroon">"1590-1591"</span>,
      <span class="maroon">"record"</span>: <span class="maroon">"version of the..."</span>,
      <span class="maroon">"published"</span>: <span class="maroon">"version of the..."</span>,
      <span class="maroon">"performance"</span>: <span class="maroon">"although it is known..."</span>,
      <span class="maroon">"evidence"</span>: <span class="maroon">"It is known..."</span>
    },
    <span class="indianred"><span class="emphasis"><em>// Data set continues...</em></span></span>
}</pre></div><div class="sect2" title="Step 3: Create the Timeline in Semantic HTML"><div class="titlepage"><div><div><h3 class="title" id="step_3_create_the_timeline_in_semantic_h">Step 3: Create the Timeline in Semantic HTML</h3></div></div></div><p><a id="iddle1465" class="indexterm"/><a id="iddle1482" class="indexterm"/><a id="iddle1534" class="indexterm"/><a id="iddle1596" class="indexterm"/><a id="iddle1617" class="indexterm"/><a id="iddle1717" class="indexterm"/><a id="iddle1730" class="indexterm"/><a id="iddle1865" class="indexterm"/><a id="iddle1879" class="indexterm"/><a id="iddle1915" class="indexterm"/><a id="iddle2026" class="indexterm"/>To create the timeline in HTML, we first need to decide how to represent it. If you’re used to working with arbitrary <code class="literal">&lt;div&gt;</code> and <code class="literal">&lt;span&gt;</code> elements, you might think that’s the best approach here as well. Instead of jumping right to these generic elements, however, we should consider other HTML structures that more accurately convey the content. HTML that more closely reflects the meaning of the underlying content is known as <span class="emphasis"><em>semantic markup</em></span>, and it’s usually preferred over generic <code class="literal">&lt;div&gt;</code> and <code class="literal">&lt;span&gt;</code> tags. Semantic markup exposes the meaning of your content to computers such as search engines and screen readers for users with visual impairments, and it can improve your site’s search rank and accessibility. If we think about a timeline in the context of semantic markup, it’s easy to see that the time-line is really just a list. In fact, it’s a list with a specific order. We should build our HTML timeline, therefore, as an ordered list (<code class="literal">&lt;ol&gt;</code>) element. While we’re creating the <code class="literal">&lt;ol&gt;</code>, we can also give it a class name for CSS style rules we’ll be adding later.</p><a id="pro_id00216"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>var</strong></span></span> container = <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"timeline"</span>);
<span class="steelblue"><span class="strong"><strong>var</strong></span></span> list = <span class="steelblue">document</span>.<span class="olive">createElement</span>(<span class="maroon">"ol"</span>);
<span class="steelblue">list</span>.<span class="olive">className</span>=<span class="maroon">"timeline"</span>;
<span class="steelblue">container</span>.<span class="olive">appendChild</span>(list);</pre><p>Next we can iterate through the plays, creating an individual list item, <code class="literal">&lt;li&gt;</code>, for each one. For now, we’ll just insert the date and title as text.</p><a id="pro_id00217"/><pre class="programlisting"><span class="steelblue">plays</span>.<span class="olive">forEach</span>(<span class="steelblue"><span class="strong"><strong>function</strong></span></span>(play) {
    <span class="steelblue"><span class="strong"><strong>var</strong></span></span> listItem = <span class="steelblue">document</span>.<span class="olive">createElement</span>(<span class="maroon">"li"</span>);
    <span class="steelblue">listItem</span>.<span class="olive">textContent</span> = <span class="steelblue">play</span>.<span class="olive">date</span> + <span class="maroon">": "</span> + <span class="steelblue">play</span>.<span class="olive">play</span>;
    <span class="steelblue">list</span>.<span class="olive">appendChild</span>(listItem);
})</pre><p><a class="xref" href="ch05.html#pure_html_timeline_can_start_out_as_a_si" title="Figure 5-2. A pure HTML timeline can start out as a simple ordered list.">Figure 5-2</a> shows a truncated version of the resulting list. It may not look like much (yet), but it has the essential data and structure.</p><div class="figure"><a id="pure_html_timeline_can_start_out_as_a_si"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00075"/><img src="figs/web/05fig02.png.jpg" alt="A pure HTML timeline can start out as a simple ordered list."/></div></div><div class="figure-title">Figure 5-2. A pure HTML timeline can start out as a simple ordered list.</div></div><p>If you look at the resulting HTML that underlies that list, it’s pretty simple:</p><a id="pro_id00218"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>&lt;ol</strong></span></span> <span class="steelblue">class=</span><span class="maroon">"timeline"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;li&gt;</strong></span></span>1589-1591: The Two Gentlemen of Verona<span class="steelblue"><span class="strong"><strong>&lt;/li&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;li&gt;</strong></span></span>1590-1594: The Taming of the Shrew<span class="steelblue"><span class="strong"><strong>&lt;/li&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;li&gt;</strong></span></span>1590-1591: Henry VI, Part 2<span class="steelblue"><span class="strong"><strong>&lt;/li&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;li&gt;</strong></span></span>1591: Henry VI, Part 3<span class="steelblue"><span class="strong"><strong>&lt;/li&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;li&gt;</strong></span></span>1591: Henry VI, Part 1<span class="steelblue"><span class="strong"><strong>&lt;/li&gt;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>&lt;/ol&gt;</strong></span></span></pre><p><a id="iddle1132" class="indexterm"/><a id="iddle1249" class="indexterm"/><a id="iddle2015" class="indexterm"/>In the spirit of semantic HTML, we should stop and consider whether that markup can be improved. Since it appears first in our list items, let’s consider the date or date range for a play. Although there has been some controversy around the decision, HTML5 has defined support for a <code class="literal">&lt;time&gt;</code> element to contain dates and times. Using that element as a wrapper will make our dates more semantic. The second part of each list item is the title of the play. As it happens, HTML5’s <code class="literal">&lt;cite&gt;</code> element is perfect for that content. To quote the current standard (<span class="emphasis"><em><a class="ulink" href="http://html.spec.whatwg.org" target="_top">http://html.spec.whatwg.org</a></em></span>):</p><div class="blockquote"><blockquote class="blockquote"><p>The <code class="literal">&lt;cite&gt;</code> element represents the title of a work (e.g., a book, . . . <span class="strong"><strong>a play</strong></span>, [emphasis added] . . . etc). This can be a work that is being quoted or referenced in detail (i.e., a citation), or it can just be a work that is mentioned in passing.</p></blockquote></div><p>To add those elements to our code, we’ll have to distinguish between dates that are single years and those that are ranges. Looking for a dash (<code class="literal">-</code>) in the data will tell us which we have.</p><a id="pro_id00219"/><pre class="programlisting">   <span class="steelblue">plays</span>.<span class="olive">forEach</span>(<span class="steelblue"><span class="strong"><strong>function</strong></span></span>(play) {
       <span class="steelblue"><span class="strong"><strong>var</strong></span></span> listItem = <span class="steelblue">document</span>.<span class="olive">createElement</span>(<span class="maroon">"li"</span>);
       <span class="steelblue"><span class="strong"><strong>if</strong></span></span> (<span class="steelblue">play</span>.<span class="steelblue">date</span>.<span class="olive">indexOf</span>(<span class="maroon">"-"</span>) !== -<span class="red">1</span>) {
➊         <span class="steelblue"><span class="strong"><strong>var</strong></span></span> dates = <span class="steelblue">play</span>.<span class="steelblue">date</span>.<span class="olive">split</span>(<span class="maroon">"-"</span>);
           <span class="steelblue"><span class="strong"><strong>var</strong></span></span> time = <span class="steelblue">document</span>.<span class="olive">createElement</span>(<span class="maroon">"time"</span>);
           <span class="steelblue">time</span>.<span class="olive">textContent</span> = dates[<span class="red">0</span>];
           <span class="steelblue">listItem</span>.<span class="olive">appendChild</span>(time);
           time = <span class="steelblue">document</span>.<span class="olive">createElement</span>(<span class="maroon">"time"</span>);
           <span class="steelblue">time</span>.<span class="olive">textContent</span> = dates[<span class="red">1</span>];
➋         <span class="steelblue">listItem</span>.<span class="olive">appendChild</span>(time);
       } <span class="steelblue"><span class="strong"><strong>else</strong></span></span> {
           <span class="steelblue"><span class="strong"><strong>var</strong></span></span> time = <span class="steelblue">document</span>.<span class="olive">createElement</span>(<span class="maroon">"time"</span>);
           <span class="steelblue">time</span>.<span class="olive">textContent</span> = <span class="steelblue">play</span>.<span class="olive">date</span>;
           <span class="steelblue">listItem</span>.<span class="olive">appendChild</span>(time);
       }
       <span class="steelblue"><span class="strong"><strong>var</strong></span></span> cite = <span class="steelblue">document</span>.<span class="olive">createElement</span>(<span class="maroon">"cite"</span>);
       <span class="steelblue">cite</span>.<span class="olive">textContent</span> = <span class="steelblue">play</span>.<span class="olive">play</span>;
       <span class="steelblue">listItem</span>.<span class="olive">appendChild</span>(cite);
       <span class="steelblue">list</span>.<span class="olive">appendChild</span>(listItem);
   })</pre><p>Notice how we handle date ranges (➊ through ➋). Since a range has a start and end time, we create two distinct <code class="literal">&lt;time&gt;</code> elements. We don’t need to add any punctuation between the dates at this point.</p><p><a id="iddle1261" class="indexterm"/><a id="iddle1278" class="indexterm"/><a id="iddle1536" class="indexterm"/><a id="iddle2028" class="indexterm"/>Because we’re no longer including the punctuation, the resulting output (shown in <a class="xref" href="ch05.html#semantic_markup_simplifies_the_required" title="Figure 5-3. Semantic markup simplifies the required HTML, but it may require special styling.">Figure 5-3</a>) might look a little worse than before. Don’t worry, though; we’ll fix it soon.</p><div class="figure"><a id="semantic_markup_simplifies_the_required"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00076"/><img src="figs/web/05fig03.png.jpg" alt="Semantic markup simplifies the required HTML, but it may require special styling."/></div></div><div class="figure-title">Figure 5-3. Semantic markup simplifies the required HTML, but it may require special styling.</div></div><p>What <span class="emphasis"><em>is</em></span> much improved is the underlying HTML. The markup clearly identifies the type of content it contains: an ordered list of dates and citations.</p><a id="pro_id00220"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>&lt;ol</strong></span></span> <span class="steelblue">class=</span><span class="maroon">"timeline"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;li&gt;&lt;time&gt;</strong></span></span>1589<span class="steelblue"><span class="strong"><strong>&lt;/time&gt;&lt;time&gt;</strong></span></span>1591<span class="steelblue"><span class="strong"><strong>&lt;/time&gt;&lt;cite&gt;</strong></span></span>The Two Gentlemen of Verona
    <span class="steelblue"><span class="strong"><strong>&lt;/cite&gt;&lt;/li&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;li&gt;&lt;time&gt;</strong></span></span>1590<span class="steelblue"><span class="strong"><strong>&lt;/time&gt;&lt;time&gt;</strong></span></span>1594<span class="steelblue"><span class="strong"><strong>&lt;/time&gt;&lt;cite&gt;</strong></span></span>The Taming of the Shrew
    <span class="steelblue"><span class="strong"><strong>&lt;/cite&gt;&lt;/li&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;li&gt;&lt;time&gt;</strong></span></span>1590<span class="steelblue"><span class="strong"><strong>&lt;/time&gt;&lt;time&gt;</strong></span></span>1591<span class="steelblue"><span class="strong"><strong>&lt;/time&gt;&lt;cite&gt;</strong></span></span>Henry VI, Part 2<span class="steelblue"><span class="strong"><strong>&lt;/cite&gt;&lt;/li&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;li&gt;&lt;time&gt;</strong></span></span>1591<span class="steelblue"><span class="strong"><strong>&lt;/time&gt;&lt;cite&gt;</strong></span></span>Henry VI, Part 3<span class="steelblue"><span class="strong"><strong>&lt;/cite&gt;&lt;/li&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;li&gt;&lt;time&gt;</strong></span></span>1591<span class="steelblue"><span class="strong"><strong>&lt;/time&gt;&lt;cite&gt;</strong></span></span>Henry VI, Part 1<span class="steelblue"><span class="strong"><strong>&lt;/cite&gt;&lt;/li&gt;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>&lt;/ol&gt;</strong></span></span></pre></div><div class="sect2" title="Step 4: Include the Supporting Content"><div class="titlepage"><div><div><h3 class="title" id="step_4_include_the_supporting_content">Step 4: Include the Supporting Content</h3></div></div></div><p>When we created a timeline using the Chronoline.js library, we weren’t able to include the supporting content from Wikipedia, because the library did not offer that option. In this example, though, we have complete control over the content, so let’s include that information in our timeline. For most plays, our data includes its first official record, its first publication, its first performance, and a discussion of the evidence. This type of content is perfectly matched to the HTML <span class="emphasis"><em>description list</em></span> (<code class="literal">&lt;dl&gt;</code>), so that’s how we’ll add it to our page. It can follow the <code class="literal">&lt;cite&gt;</code> of the play’s title.</p><a id="pro_id00221"/><pre class="programlisting"><span class="steelblue">plays</span>.<span class="olive">forEach</span>(<span class="steelblue"><span class="strong"><strong>function</strong></span></span>(play) {
    <span class="indianred"><span class="emphasis"><em>// Additional code...</em></span></span>
    <span class="steelblue">listItem</span>.<span class="olive">appendChild</span>(cite);
    <span class="steelblue"><span class="strong"><strong>var</strong></span></span> descList = <span class="steelblue">document</span>.<span class="olive">createElement</span>(<span class="maroon">"dl"</span>);
    <span class="indianred"><span class="emphasis"><em>// Add terms to the list here</em></span></span>
    <span class="steelblue">listItem</span>.<span class="olive">appendChild</span>(descList);
    <span class="steelblue">list</span>.<span class="olive">appendChild</span>(listItem);
})</pre><p>We can define a mapping array to help add the individual terms to each play. That array maps the property name in our data set to the label we want to use in the content.</p><a id="pro_id00222"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>var</strong></span></span> descTerms = [
    { <span class="dodgerblue">key</span>: <span class="maroon">"record"</span>,      <span class="dodgerblue">label</span>: <span class="maroon">"First official record"</span>},
    { <span class="dodgerblue">key</span>: <span class="maroon">"published"</span>,   <span class="dodgerblue">label</span>: <span class="maroon">"First published"</span>},
    { <span class="dodgerblue">key</span>: <span class="maroon">"performance"</span>, <span class="dodgerblue">label</span>: <span class="maroon">"First recorded performance"</span>},
    { <span class="dodgerblue">key</span>: <span class="maroon">"evidence"</span>,    <span class="dodgerblue">label</span>: <span class="maroon">"Evidence"</span>},
];</pre><p><a id="iddle1251" class="indexterm"/><a id="iddle1292" class="indexterm"/><a id="iddle1400" class="indexterm"/>With that array we can quickly add the descriptions to our content. We iterate over the array using <code class="literal">.forEach()</code>.</p><a id="pro_id00223"/><pre class="programlisting">   <span class="steelblue">plays</span>.<span class="olive">forEach</span>(<span class="steelblue"><span class="strong"><strong>function</strong></span></span>(play) {
       <span class="indianred"><span class="emphasis"><em>// Additional code...</em></span></span>
       <span class="steelblue">listItem</span>.<span class="olive">appendChild</span>(cite);
       <span class="steelblue"><span class="strong"><strong>var</strong></span></span> descList = <span class="steelblue">document</span>.<span class="olive">createElement</span>(<span class="maroon">"dl"</span>);
       <span class="steelblue">descTerms</span>.<span class="olive">forEach</span>(<span class="steelblue"><span class="strong"><strong>function</strong></span></span>(term) {
➊         <span class="steelblue"><span class="strong"><strong>if</strong></span></span> (play[<span class="steelblue">term</span>.<span class="olive">key</span>]) {
               <span class="steelblue"><span class="strong"><strong>var</strong></span></span> descTerm = <span class="steelblue">document</span>.<span class="olive">createElement</span>(<span class="maroon">"dt"</span>);
               <span class="steelblue">descTerm</span>.<span class="olive">textContent</span> = <span class="steelblue">term</span>.<span class="olive">label</span>;
               <span class="steelblue">descList</span>.<span class="olive">appendChild</span>(descTerm);
               <span class="steelblue"><span class="strong"><strong>var</strong></span></span> descElem = <span class="steelblue">document</span>.<span class="olive">createElement</span>(<span class="maroon">"dd"</span>);
               <span class="steelblue">descElem</span>.<span class="olive">textContent</span> = play[<span class="steelblue">term</span>.<span class="olive">key</span>];
               <span class="steelblue">descList</span>.<span class="olive">appendChild</span>(descElem);
           }
       });
       <span class="steelblue">listItem</span>.<span class="olive">appendChild</span>(descList);
       <span class="steelblue">list</span>.<span class="olive">appendChild</span>(listItem);
   })</pre><p>At each iteration, we make sure that the data has content (➊) before creating the description item. A description item contains the term(s) being described in one <code class="literal">&lt;dt&gt;</code> tag and the description itself in a <code class="literal">&lt;dd&gt;</code> tag.</p><p>Our timeline is still lacking a bit of visual appeal, but it has a much richer set of content, as you can see in <a class="xref" href="ch05.html#html_makes_it_easy_to_add_extra_content" title="Figure 5-4. HTML makes it easy to add extra content to the list.">Figure 5-4</a>. In fact, even without any styling at all, it still communicates the essential data quite well.</p><p>Here’s the resulting markup (truncated for brevity):</p><a id="pro_id00224"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>&lt;ol</strong></span></span> <span class="steelblue">class=</span><span class="maroon">"timeline"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;li&gt;</strong></span></span>
        <span class="steelblue"><span class="strong"><strong>&lt;time&gt;</strong></span></span>1589<span class="steelblue"><span class="strong"><strong>&lt;/time&gt;&lt;time&gt;</strong></span></span>1591<span class="steelblue"><span class="strong"><strong>&lt;/time&gt;</strong></span></span>
        <span class="steelblue"><span class="strong"><strong>&lt;cite&gt;</strong></span></span>The Two Gentlemen of Verona<span class="steelblue"><span class="strong"><strong>&lt;/cite&gt;</strong></span></span>
        <span class="steelblue"><span class="strong"><strong>&lt;dl&gt;</strong></span></span>
            <span class="steelblue"><span class="strong"><strong>&lt;dt&gt;</strong></span></span>First official record<span class="steelblue"><span class="strong"><strong>&lt;/dt&gt;&lt;dd&gt;</strong></span></span>Francis Meres'...<span class="steelblue"><span class="strong"><strong>&lt;/dd&gt;</strong></span></span>
            <span class="steelblue"><span class="strong"><strong>&lt;dt&gt;</strong></span></span>First published<span class="steelblue"><span class="strong"><strong>&lt;/dt&gt;&lt;dd&gt;</strong></span></span>First Folio (1623)<span class="steelblue"><span class="strong"><strong>&lt;/dd&gt;</strong></span></span>
            <span class="steelblue"><span class="strong"><strong>&lt;dt&gt;</strong></span></span>First recorded performance<span class="steelblue"><span class="strong"><strong>&lt;/dt&gt;&lt;dd&gt;</strong></span></span>adaptation by...<span class="steelblue"><span class="strong"><strong>&lt;/dd&gt;</strong></span></span>
            <span class="steelblue"><span class="strong"><strong>&lt;dt&gt;</strong></span></span>Evidence<span class="steelblue"><span class="strong"><strong>&lt;/dt&gt;&lt;dd&gt;</strong></span></span>The play contains...<span class="steelblue"><span class="strong"><strong>&lt;/dd&gt;</strong></span></span>
        <span class="steelblue"><span class="strong"><strong>&lt;/dl&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;/li&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;li&gt;</strong></span></span>
        <span class="steelblue"><span class="strong"><strong>&lt;time&gt;</strong></span></span>1590<span class="steelblue"><span class="strong"><strong>&lt;/time&gt;&lt;time&gt;</strong></span></span>1594<span class="steelblue"><span class="strong"><strong>&lt;/time&gt;&lt;cite&gt;</strong></span></span>The Taming of the Shrew<span class="steelblue"><span class="strong"><strong>&lt;/cite&gt;</strong></span></span>
        <span class="steelblue"><span class="strong"><strong>&lt;dl&gt;</strong></span></span>
            <span class="steelblue"><span class="strong"><strong>&lt;dt&gt;</strong></span></span>First official record<span class="steelblue"><span class="strong"><strong>&lt;/dt&gt;&lt;dd&gt;</strong></span></span>possible version...<span class="steelblue"><span class="strong"><strong>&lt;/dd&gt;</strong></span></span>
            <span class="steelblue"><span class="strong"><strong>&lt;dt&gt;</strong></span></span>First published<span class="steelblue"><span class="strong"><strong>&lt;/dt&gt;&lt;dd&gt;</strong></span></span>possible version...<span class="steelblue"><span class="strong"><strong>&lt;/dd&gt;</strong></span></span>
            <span class="steelblue"><span class="strong"><strong>&lt;dt&gt;</strong></span></span>First recorded performance<span class="steelblue"><span class="strong"><strong>&lt;/dt&gt;&lt;dd&gt;</strong></span></span>According to Philip...<span class="steelblue"><span class="strong"><strong>&lt;/dd&gt;</strong></span></span>
            <span class="steelblue"><span class="strong"><strong>&lt;dt&gt;</strong></span></span>Evidence<span class="steelblue"><span class="strong"><strong>&lt;/dt&gt;&lt;dd&gt;</strong></span></span>Kier Elam posits...<span class="steelblue"><span class="strong"><strong>&lt;/dd&gt;</strong></span></span>
        <span class="steelblue"><span class="strong"><strong>&lt;/dl&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;/li&gt;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>&lt;/ol&gt;</strong></span></span></pre><div class="figure"><a id="html_makes_it_easy_to_add_extra_content"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00077"/><img src="figs/web/05fig04.png.jpg" alt="HTML makes it easy to add extra content to the list."/></div></div><div class="figure-title">Figure 5-4. HTML makes it easy to add extra content to the list.</div></div></div><div class="sect2" title="Step 5: Optionally Take Advantage of jQuery"><div class="titlepage"><div><div><h3 class="title" id="step_5_optionally_take_advantage_of_jque">Step 5: Optionally Take Advantage of jQuery</h3></div></div></div><p><a id="iddle1116" class="indexterm"/><a id="iddle1174" class="indexterm"/><a id="iddle1535" class="indexterm"/><a id="iddle1540" class="indexterm"/><a id="iddle1545" class="indexterm"/><a id="iddle1618" class="indexterm"/><a id="iddle2027" class="indexterm"/><a id="iddle2032" class="indexterm"/>Our code so far has used nothing but plain JavaScript. If you’re using jQuery on your web pages, you can shorten the code a bit by taking advantage of some jQuery features. If your web pages aren’t using jQuery already, the minor enhancements in this step don’t justify adding it, but if you’d like to see a more concise version, check out the book’s source code for an alternative.</p></div><div class="sect2" title="Step 6: Fix Timeline Problems with CSS"><div class="titlepage"><div><div><h3 class="title" id="step_6_fix_timeline_problems_with_css">Step 6: Fix Timeline Problems with CSS</h3></div></div></div><p>Now that we’ve built our timeline’s content in HTML, it’s time to define the styles that determine its appearance. Throughout this example, we’ll focus on the functional aspects of styling rather than pure visual elements such as fonts and colors, since you’ll probably want those visual styles to be specific to your own website.</p><p>The first step is a simple one. We want to get rid of the numbering (1, 2, 3 . . . ) that browsers normally add to ordered list items. A single rule banishes them from our timeline: by setting the <code class="literal">list-style-type</code> to <code class="literal">none</code>, we tell the browser not to add any special characters to our list items.</p><a id="pro_id00225"/><pre class="programlisting"><span class="red">.timeline</span> li <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>list-style-type:</strong></span></span> <span class="dodgerblue">none</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p><a id="iddle1001" class="indexterm"/><a id="iddle1018" class="indexterm"/><a id="iddle1091" class="indexterm"/><a id="iddle1271" class="indexterm"/><a id="iddle1569" class="indexterm"/><a id="iddle1597" class="indexterm"/>We can also use CSS rules to add some punctuation to our semantic HTML. First we look for places where two <code class="literal">&lt;time&gt;</code> elements appear right after each other, while skipping isolated <code class="literal">&lt;time&gt;</code> tags.</p><a id="pro_id00226"/><pre class="programlisting"><span class="red">.timeline</span> li &gt; time + time<span class="red">:before</span> <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>content:</strong></span></span> <span class="maroon">"-"</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p>The trick to finding <code class="literal">&lt;time&gt;</code> pairs is the CSS adjacent selector <code class="literal">+</code>. A rule with <code class="literal">time + time</code> specifies a <code class="literal">&lt;time&gt;</code> element that immediately follows a <code class="literal">&lt;time&gt;</code> element. To add the punctuation, we use the <code class="literal">:before</code> pseudoselector to specify what we want to happen <span class="emphasis"><em>before</em></span> this second <code class="literal">&lt;time&gt;</code> tag, and we set the <code class="literal">content</code> property to indicate the content we want inserted.</p><p>If you haven’t seen the <code class="literal">&gt;</code> before in a CSS rule, it’s the <span class="emphasis"><em>direct descendant selector</em></span>. In this example, it means that the <code class="literal">&lt;time&gt;</code> element must be an immediate child of the <code class="literal">&lt;li&gt;</code> element. We’re using this selector so our rules won’t inadvertently apply to other <code class="literal">&lt;time&gt;</code> elements that may be nested deeper within the list item’s content.</p><p>To finish up the punctuation, let’s add a colon and space after the last of the <code class="literal">&lt;time&gt;</code> elements in each list item.</p><a id="pro_id00227"/><pre class="programlisting"><span class="red">.timeline</span> li &gt; time<span class="red">:last-of-type:after</span> <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>content:</strong></span></span> <span class="maroon">": "</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p>We use two pseudoselectors for this rule. The <code class="literal">:last-of-type</code> selector targets the last <code class="literal">&lt;time&gt;</code> element in the list item. That’s the first <code class="literal">&lt;time&gt;</code> if there’s only one, and the second <code class="literal">&lt;time&gt;</code> if both are present. Then we add the <code class="literal">:after</code> pseudoselector to insert content after that <code class="literal">&lt;time&gt;</code> element.</p><p>With these changes, we’ve cleaned up all of the obvious problems with our timeline (see <a class="xref" href="ch05.html#css_styles_make_the_timeline_easier_to_r" title="Figure 5-5. CSS styles make the timeline easier to read without changing the markup.">Figure 5-5</a>).</p><div class="figure"><a id="css_styles_make_the_timeline_easier_to_r"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00078"/><img src="figs/web/05fig05.png.jpg" alt="CSS styles make the timeline easier to read without changing the markup."/></div></div><div class="figure-title">Figure 5-5. CSS styles make the timeline easier to read without changing the markup.</div></div><p>Now we can add a little flair to the visualization.</p></div><div class="sect2" title="Step 7: Add Styles to Visually Structure the Timeline"><div class="titlepage"><div><div><h3 class="title" id="step_7_add_styles_to_visually_structure">Step 7: Add Styles to Visually Structure the Timeline</h3></div></div></div><p><a id="iddle1307" class="indexterm"/><a id="iddle1533" class="indexterm"/><a id="iddle1598" class="indexterm"/><a id="iddle1759" class="indexterm"/><a id="iddle1783" class="indexterm"/><a id="iddle1973" class="indexterm"/><a id="iddle2016" class="indexterm"/><a id="iddle2025" class="indexterm"/>The next set of CSS styles will improve the visual structure of the timeline. First among those improvements will be making the timeline look more like, well, a <span class="emphasis"><em>line.</em></span> To do that, we can add a border to the left side of the <code class="literal">&lt;li&gt;</code> elements. At the same time, we’ll also want to make sure that those <code class="literal">&lt;li&gt;</code> elements don’t have any margins, as margins would introduce gaps in the border and break the continuity of the line.</p><a id="pro_id00228"/><pre class="programlisting"><span class="red">.timeline</span> li <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>border-left:</strong></span></span> <span class="dodgerblue">2px</span> <span class="dodgerblue">solid</span> <span class="dodgerblue">black</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span>
<span class="red">.timeline</span> dl,
<span class="red">.timeline</span> li <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>margin:</strong></span></span> <span class="dodgerblue">0</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p>These styles add a nice vertical line on the left side of our entire timeline. Now that we have that line, we can shift the dates over to the left side of it. The shift requires rules for the parent <code class="literal">&lt;li&gt;</code> as well as the <code class="literal">&lt;time&gt;</code> elements. For the parent <code class="literal">&lt;li&gt;</code> elements, we want their <code class="literal">position</code> specified as <code class="literal">relative</code>.</p><a id="pro_id00229"/><pre class="programlisting"><span class="red">.timeline</span> li <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>position:</strong></span></span> <span class="dodgerblue">relative</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p>By itself, this rule doesn’t actually change our timeline. It does, however, establish a <span class="emphasis"><em>positioning context</em></span> for any elements that are children of the <code class="literal">&lt;li&gt;</code>. Those children include the <code class="literal">&lt;time&gt;</code> elements that we want to move. With the <code class="literal">&lt;li&gt;</code> set to <code class="literal">position: relative</code>, we can now set the <code class="literal">&lt;time&gt;</code> children to <code class="literal">position: absolute</code>. This rule lets us specify exactly where the browser should place the time elements, <span class="emphasis"><em>relative</em></span> to the parent <code class="literal">&lt;li&gt;</code>. We want to move all <code class="literal">&lt;time&gt;</code> elements to the left, and we want to move the second <code class="literal">&lt;time&gt;</code> element down.</p><a id="pro_id00230"/><pre class="programlisting"><span class="red">.timeline</span> li &gt; time <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>position:</strong></span></span> <span class="dodgerblue">absolute</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>left:</strong></span></span> <span class="dodgerblue">-3.5em</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span>
<span class="red">.timeline</span> li &gt; time + time <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>top:</strong></span></span> <span class="dodgerblue">1em</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>left:</strong></span></span> <span class="dodgerblue">-3.85em</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p>In the previous code, the first selector targets both of our <code class="literal">&lt;time&gt;</code> tags, while the second selector, using the same <code class="literal">time + time</code> trick described earlier, targets only the second of two <code class="literal">&lt;time&gt;</code> tags.</p><p>By using <code class="literal">em</code> units rather than <code class="literal">px</code> (pixel) units for this shift, we define the shift to be relative to the current font size, regardless of what it is. That gives us the freedom to change the font size without having to go back and tweak any pixel positioning.</p><p><a id="iddle1590" class="indexterm"/><a id="iddle1734" class="indexterm"/><a id="iddle2056" class="indexterm"/>The specific values for the position shift may need adjustment depending on the specific font face, but, in general, we use a negative <code class="literal">left</code> position to shift content farther to the left than it would normally appear, and a positive <code class="literal">top</code> position to move the content down the page.</p><p>After moving the dates to the left of the vertical line, we’ll also want to shift the main content a bit to the right so it doesn’t crowd up against the line. The <code class="literal">padding-left</code> property takes care of that. And while we’re adjusting the left padding, we can also add a bit of padding on the bottom to separate each play from the other.</p><a id="pro_id00231"/><pre class="programlisting"><span class="red">.timeline</span> li <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>padding-left:</strong></span></span> <span class="dodgerblue">1em</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>padding-bottom:</strong></span></span> <span class="dodgerblue">1em</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p>With the dates and the main content on opposite sides of our vertical line, we no longer need any punctuation after the date, so we’ll remove the style that adds a colon after the last <code class="literal">&lt;time&gt;</code> element.</p><a id="pro_id00232"/><pre class="programlisting"><span class="red">.timeline</span> li &gt; time<span class="red">:last-of-type:after</span> <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>content:</strong></span></span> <span class="maroon">": "</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p>The fact that we’re able to make this change highlights one of the reasons for using CSS to add the colon in the first place. If we had included the punctuation explicitly in the markup (by, for example, generating it in the JavaScript code), then our markup would be more tightly coupled to our styles. If a style modification changed whether the colon was appropriate, we would have to go back and change the JavaScript as well. With the approach that we’re using here, however, styles and markup are much more independent. Any style changes are isolated to our CSS rules; no modifications to the JavaScript are required.</p><p>To further improve its visual styling, we can make a few other changes to our timeline. We can increase the font size for each play’s title to make that information more prominent. At the same time, we can add some extra spacing below the title and indent the description list a bit.</p><a id="pro_id00233"/><pre class="programlisting"><span class="red">.timeline</span> li &gt; cite <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>font-size:</strong></span></span> <span class="dodgerblue">1.5em</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>line-height:</strong></span></span> <span class="dodgerblue">1em</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>padding-bottom:</strong></span></span> <span class="dodgerblue">0.5em</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span>
<span class="red">.timeline</span> dl <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>padding-left:</strong></span></span> <span class="dodgerblue">1.5em</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p>For a last bit of polish, let’s add a bullet right on the vertical line to mark each play and tie the title more closely to the dates. We use a large bullet (several times the normal size) and position it right over the line.</p><a id="pro_id00234"/><pre class="programlisting"><span class="red">.timeline</span> li &gt; time<span class="red">:first-of-type:after</span> <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>content:</strong></span></span> <span class="maroon">"\2022"</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>font-size:</strong></span></span> <span class="dodgerblue">3em</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>line-height:</strong></span></span> <span class="dodgerblue">0.4em</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>position:</strong></span></span> <span class="dodgerblue">absolute</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>right:</strong></span></span> <span class="dodgerblue">-0.65em</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>top:</strong></span></span> <span class="dodgerblue">0.1em</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p><a id="iddle1108" class="indexterm"/><a id="iddle1262" class="indexterm"/><a id="iddle1277" class="indexterm"/><a id="iddle1279" class="indexterm"/><a id="iddle1532" class="indexterm"/><a id="iddle1667" class="indexterm"/><a id="iddle1731" class="indexterm"/><a id="iddle2024" class="indexterm"/>As you can see, the Unicode character for a bullet can be represented as <code class="literal">"\2022"</code>. The exact position values will depend on the specific font, but a bit of trial and error can perfect the adjustments.</p><p>Now our timeline is starting to look like an actual timeline (as shown in <a class="xref" href="ch05.html#additional_styles_clarify_the_structure" title="Figure 5-6. Additional styles clarify the structure of the timeline elements.">Figure 5-6</a>). In your own pages, you could include additional styles to define fonts, colors, and so on, but even without those decorations the visualization is effective.</p><div class="figure"><a id="additional_styles_clarify_the_structure"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00079"/><img src="figs/web/05fig06.png.jpg" alt="Additional styles clarify the structure of the timeline elements."/></div></div><div class="figure-title">Figure 5-6. Additional styles clarify the structure of the timeline elements.</div></div></div><div class="sect2" title="Step 8: Add Interactivity"><div class="titlepage"><div><div><h3 class="title" id="step_8_add_interactivity">Step 8: Add Interactivity</h3></div></div></div><p>The full details on all 40 of Shakespeare’s plays might be a little overwhelming for a first view of our timeline. The visualization would be more effective if it showed only the play titles at first, but let users reveal more details through interactions. Because we’re building this visualization ourselves, we have all the control necessary to make that happen.</p><p>First we’ll set up a few additional styles. There are several ways to hide the play details with CSS, the most obvious being the <code class="literal">display:none</code> property. As we’ll see a little later, though, a better choice for our timeline is setting the <code class="literal">max-height</code> to <code class="literal">0</code>. If the maximum height of an element is 0, then, in theory, it should be invisible. In practice, we also have to set the <code class="literal">overflow</code> property to <code class="literal">hidden</code>. Otherwise, even though the <code class="literal">&lt;dl&gt;</code> element itself has no height, the browser will display the content that overflows from it. Since we want our description lists to start out hidden, we can set that property as the default.</p><a id="pro_id00235"/><pre class="programlisting"><span class="red">.timeline</span> li dl <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>max-height:</strong></span></span> <span class="dodgerblue">0</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>overflow:</strong></span></span> <span class="dodgerblue">hidden</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p><a id="iddle1133" class="indexterm"/><a id="iddle1276" class="indexterm"/><a id="iddle1599" class="indexterm"/><a id="iddle1668" class="indexterm"/><a id="iddle1999" class="indexterm"/>To reveal a play’s details, users click on the play’s title in the <code class="literal">&lt;cite&gt;</code> element. To indicate to users that they can click on the title, we’ll change the mouse cursor from the normal arrow to the “clickable” hand. We can also change the <code class="literal">display</code> property from the default <code class="literal">inline</code> to <code class="literal">block</code>. That change gives users a larger and more consistent area to click.</p><a id="pro_id00236"/><pre class="programlisting"><span class="red">.timeline</span> li &gt; cite <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>cursor:</strong></span></span> <span class="dodgerblue">pointer</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>display:</strong></span></span> <span class="dodgerblue">block</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p>Finally, we need a way to reveal a play’s details. We’ll do that by adding a class of <code class="literal">"expanded"</code> to the <code class="literal">&lt;li&gt;</code> for the play. When that class is present, our styles should override the <code class="literal">max-height</code> of <code class="literal">0</code>.</p><a id="pro_id00237"/><pre class="programlisting"><span class="red">.timeline</span> li<span class="red">.expanded</span> dl <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>max-height:</strong></span></span> <span class="dodgerblue">40em</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p>The exact value for the expanded <code class="literal">max-height</code> will depend on the content. In general, though, it should be large enough to reveal the full details for the item. It’s okay to make it a little larger than necessary “just in case.” Don’t go overboard, however, and make it unreasonably large. (We’ll see why at the end of this step.)</p><p>With these styles in place, we can add a bit of JavaScript to control them. It won’t take much. The first step is writing an event handler that will be called when users click.</p><a id="pro_id00238"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>var</strong></span></span> clicked = <span class="steelblue"><span class="strong"><strong>function</strong></span></span>(ev) {
    <span class="steelblue"><span class="strong"><strong>if</strong></span></span> (<span class="steelblue">ev</span>.<span class="steelblue">target</span>.<span class="olive">nodeName</span> === <span class="maroon">"CITE"</span>) {
        <span class="indianred"><span class="emphasis"><em>// Code continues...</em></span></span>
    }
};</pre><p>This function takes a single parameter, specifically an <code class="literal">Event</code> object, with details about the click. One of those details is the <code class="literal">.target</code> property, which will contain a reference to the specific element of the page on which the user clicked. We care only about clicks on the <code class="literal">&lt;cite&gt;</code> elements.</p><p>Once we know that a <code class="literal">&lt;cite&gt;</code> was clicked, we find its parent <code class="literal">&lt;li&gt;</code> element. We can then check to see if the <code class="literal">&lt;li&gt;</code> has the <code class="literal">"expanded"</code> class. If it doesn’t, we add it. If the class is already present, we remove it.</p><a id="pro_id00239"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>var</strong></span></span> clicked = <span class="steelblue"><span class="strong"><strong>function</strong></span></span>(ev) {
    <span class="steelblue"><span class="strong"><strong>if</strong></span></span> (<span class="steelblue">ev</span>.<span class="steelblue">target</span>.<span class="olive">nodeName</span> === <span class="maroon">"CITE"</span>) {
        <span class="steelblue"><span class="strong"><strong>var</strong></span></span> li = <span class="steelblue">ev</span>.<span class="steelblue">target</span>.<span class="olive">parentNode</span>;
        <span class="steelblue"><span class="strong"><strong>if</strong></span></span> (<span class="steelblue">li</span>.<span class="olive">className</span> === <span class="maroon">"expanded"</span>) {
            <span class="steelblue">li</span>.<span class="olive">className</span> = <span class="maroon">""</span>;
        } <span class="steelblue"><span class="strong"><strong>else</strong></span></span> {
            <span class="steelblue">li</span>.<span class="olive">className</span> = <span class="maroon">"expanded"</span>;
        }
    }
};</pre><p><a id="iddle1016" class="indexterm"/><a id="iddle1134" class="indexterm"/><a id="iddle1135" class="indexterm"/><a id="iddle1136" class="indexterm"/><a id="iddle1178" class="indexterm"/><a id="iddle1600" class="indexterm"/><a id="iddle2073" class="indexterm"/>Our approach is a bit primitive because it allows only one class to be defined for the <code class="literal">&lt;li&gt;</code>. That’s all we need for this example, though, so we’ll stick with it.</p><div class="note" title="Note"><h3 class="title"><a id="ch05note02"/>Note</h3><p><span class="strong"><strong>Modern browsers have a more sophisticated interface for controlling the class attributes of elements. That interface is the <code class="literal">classList</code>, and it easily supports multiple classes per element, as well as toggling the class on and off with a single function. Older browsers (namely Ie9 and earlier) don’t support that interface, however. Since we don’t need the extra functionality, the older <code class="literal">className</code> is sufficient for this example.</strong></span></p></div><p>With our event handling function defined, we can associate it with clicks anywhere on the timeline. The standard <code class="literal">addEventListener</code> method creates the association for any element.</p><a id="pro_id00240"/><pre class="programlisting"><span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"timeline"</span>).<span class="olive">addEventListener</span>(<span class="maroon">"click"</span>, clicked);</pre><p>You might be curious as to why we’re associating an event listener with the entire timeline visualization instead of, for example, adding individual event listeners to each <code class="literal">&lt;cite&gt;</code>. That alternative would eliminate the need to check the event target in the handler; however, it turns out that it’s much less efficient than the approach we’re taking. Event listeners can consume a fair bit of JavaScript resources, and our page will perform better if we keep them to a minimum.</p><p>If you’re using jQuery, the required code is even simpler:</p><a id="pro_id00241"/><pre class="programlisting"><span class="olive">$</span>(<span class="maroon">"#timeline"</span>).<span class="olive">on</span>(<span class="maroon">"click"</span>, <span class="maroon">"cite"</span>, <span class="steelblue"><span class="strong"><strong>function</strong></span></span>() {
    <span class="olive">$</span>(<span class="steelblue"><span class="strong"><strong>this</strong></span></span>).<span class="olive">parent</span>(<span class="maroon">"li"</span>).<span class="olive">toggleClass</span>(<span class="maroon">"expanded"</span>);
})</pre><p>We’re almost ready to show our new and improved timeline to the world, but there’s one final refinement we can make. Our current version shows or hides a play’s details all at once. This transition can be abrupt to users, as content appears or disappears instantly. We can provide a better experience by gracefully transitioning between the two states, and a natural transition for this timeline is animating the height of the content. When the details are hidden, they have a height of 0. And when we want to show them, we will gradually animate the height to its natural value.</p><p>It’s possible to add these animations using JavaScript. The jQuery library, in fact, has a fairly extensive set of animation functions. In modern browsers, however, it is much better to animate content using CSS transitions. Web browsers are optimized for CSS, often offloading the computations to special high-performance <a id="iddle1263" class="indexterm"/><a id="iddle1280" class="indexterm"/><a id="iddle1304" class="indexterm"/><a id="iddle1453" class="indexterm"/><a id="iddle1669" class="indexterm"/><a id="iddle1692" class="indexterm"/><a id="iddle2071" class="indexterm"/><a id="iddle2154" class="indexterm"/>graphics coprocessors. In those cases, CSS-based animations can perform several orders of magnitude better than JavaScript. The only disadvantage to using CSS for animations is a lack of support in older browsers. But animation isn’t usually <span class="emphasis"><em>critical</em></span> to most web pages. Sure, it’s nice, but if a user with an older browser misses out on the graceful transitions, it isn’t the end of the world. The web page will still <span class="emphasis"><em>function</em></span> just fine.</p><p>The CSS <code class="literal">transition</code> property is the simplest way to define a CSS animation. It specifies the actual property to animate, the duration of the animation, and the <span class="emphasis"><em>easing function</em></span> to follow. Here’s a rule we could use in our example:</p><a id="pro_id00242"/><pre class="programlisting"><span class="red">.timeline</span> li dl <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>transition:</strong></span></span> max-height <span class="dodgerblue">500ms</span> ease-in-out<span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p>This rule defines a transition for the timeline’s <code class="literal">&lt;dl&gt;</code> elements. It specifies that the property to animate is <code class="literal">max-height</code>, so the transition will take effect whenever an element’s <code class="literal">max-height</code> property changes (and that’s precisely the property we modify when the <code class="literal">"expanded"</code> class is added or removed). The transition rule also specifies that the animation should take 500 milliseconds, and that it should “ease in” and “ease out.” This last property indicates that the animation should start slowly, speed up, and then slow down again before finishing. That behavior usually looks more natural than animating at a constant speed.</p><p>CSS transitions can animate many CSS properties, but there is one important constraint. Both the starting and ending values must be explicit. That constraint explains why we’re animating <code class="literal">max-height</code> instead of <code class="literal">height</code>, even though it’s really just <code class="literal">height</code> that we want to change. Unfortunately, we can’t animate <code class="literal">height</code>, because it has no explicit value when the description list is expanded. Every <code class="literal">&lt;dl&gt;</code> will have its own height based on its content, and there’s no way we can predict those values in our CSS. The <code class="literal">max-height</code> property, on the other hand, gives us explicit values for both states—<code class="literal">0</code> and <code class="literal">40em</code> in this example—so CSS can animate its transitions. We just have to be sure that no <code class="literal">&lt;dl&gt;</code> has content more than <code class="literal">40em</code> high. Otherwise, the extra content will be cut off. This doesn’t mean, however, that we should set the <code class="literal">max-height</code> for expanded <code class="literal">&lt;dl&gt;</code> elements to an astronomical value. To see why, consider what would happen if we transitioned <code class="literal">max-height</code> to <code class="literal">1000em</code> for a <code class="literal">&lt;dl&gt;</code> that needed only <code class="literal">10em</code> of height. Ignoring (for simplicity) the complications of easing, it would take only 1/100 of the full transition time before the full content of the element was visible. The animation that we had planned to take 500 milliseconds is over in 5 milliseconds instead.</p><p>There is one final complication with CSS transitions. Most browsers implemented the functionality before the official standard was finalized. To make sure their implementations wouldn’t conflict with potential changes in the official standards, browser vendors initially implemented transitions using a proprietary syntax. That syntax adds a prefix (<code class="literal">-webkit-</code> for Safari and Chrome, <code class="literal">-moz-</code> for Firefox, and <code class="literal">-o-</code> for Opera) to the property name. To cover all the major browsers, we must include a rule with each prefix.</p><a id="pro_id00243"/><pre class="programlisting"><span class="red">.timeline</span> li dl <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>-webkit-transition:</strong></span></span> max-height <span class="dodgerblue">500ms</span> ease-in-out<span class="steelblue"><span class="strong"><strong>;</strong></span></span>
       <span class="steelblue"><span class="strong"><strong>-moz-transition:</strong></span></span> max-height <span class="dodgerblue">500ms</span> ease-in-out<span class="steelblue"><span class="strong"><strong>;</strong></span></span>
         <span class="steelblue"><span class="strong"><strong>-o-transition:</strong></span></span> max-height <span class="dodgerblue">500ms</span> ease-in-out<span class="steelblue"><span class="strong"><strong>;</strong></span></span>
            <span class="steelblue"><span class="strong"><strong>transition:</strong></span></span> max-height <span class="dodgerblue">500ms</span> ease-in-out<span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><div class="note" title="Note"><h3 class="title"><a id="ch05note03"/>Note</h3><p><a id="iddle2020" class="indexterm"/><a id="iddle2040" class="indexterm"/><span class="strong"><strong>Internet Explorer doesn’t need a prefix, because Microsoft didn’t implement transitions until the standard was stable. Also, there’s no harm in specifying multiple prefixes, since browsers simply ignore properties they don’t understand.</strong></span></p></div><p>Now our handcrafted timeline responds perfectly to user interactions. <a class="xref" href="ch05.html#fully_interactive_timeline_requires_only" title="Figure 5-7. A fully interactive timeline requires only HTML, CSS, and a little JavaScript.">Figure 5-7</a> shows the complete visualization.</p><div class="figure"><a id="fully_interactive_timeline_requires_only"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00080"/><img src="figs/web/05fig07.png.jpg" alt="A fully interactive timeline requires only HTML, CSS, and a little JavaScript."/></div></div><div class="figure-title">Figure 5-7. A fully interactive timeline requires only HTML, CSS, and a little JavaScript.</div></div></div></div><div class="sect1" title="Using a Web Component"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="using_a_web_component">Using a Web Component</h2></div></div></div><p>In this example, we’ll look at another alternative approach; instead of building a timeline from scratch using low-level JavaScript, we’ll integrate a full-featured timeline component: TimelineJS (<span class="emphasis"><em><a class="ulink" href="http://timeline.knightlab.com/" target="_top">http://timeline.knightlab.com/</a></em></span>). In many ways this approach is the exact opposite of low-level JavaScript. At its most basic, it requires no coding at all; it can be as easy as embedding a YouTube video in a blog post. That method sacrifices a lot of control over the resulting visualization, however, so we’ll also look at ways to regain some of that control.</p><div class="sect2" title="Step 1: Preview the Standard Component"><div class="titlepage"><div><div><h3 class="title" id="step_1_preview_the_standard_component">Step 1: Preview the Standard Component</h3></div></div></div><p><a id="iddle2022" class="indexterm"/><a id="iddle2042" class="indexterm"/>Before we spend too much time customizing the visualization, it’s worthwhile to check out the component in its most basic form. Fortunately, TimelineJS makes this process very simple. The website (<span class="emphasis"><em><a class="ulink" href="http://timeline.knightlab.com/" target="_top">http://timeline.knightlab.com/</a></em></span>) will walk you through the steps in detail, but in a nutshell, they are as follows:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Create a Google Docs spreadsheet (<span class="emphasis"><em><a class="ulink" href="http://docs.google.com/" target="_top">http://docs.google.com/</a></em></span>) with data for the timeline.</p></li><li class="listitem"><p>Publish that spreadsheet for web access, which will create a URL for it.</p></li><li class="listitem"><p>Enter that URL into a form on the TimelineJS website, which will generate an HTML snippet.</p></li><li class="listitem"><p>Copy and paste the snippet into your web page.</p></li></ol></div><p><a class="xref" href="ch05.html#timelinejs_component_can_get_its_data_fr" title="Figure 5-8. The TimelineJS component can get its data from a Google Docs spreadsheet.">Figure 5-8</a> shows what the spreadsheet (<span class="emphasis"><em><a class="ulink" href="https://docs.google.com/spreadsheet/ccc?key=0An4ME25ELRdYdDk4WmRacmxjaDM0V0tDTk9vMnQxU1E#gid=0" target="_top">https://docs.google.com/spreadsheet/ccc?key=0An4ME25ELRdYdDk4WmRacmxjaDM0V0tDTk9vMnQxU1E#gid=0</a></em></span>) looks like for Shakespeare’s plays.</p><div class="figure"><a id="timelinejs_component_can_get_its_data_fr"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00081"/><img src="figs/web/05fig08.png.jpg" alt="The TimelineJS component can get its data from a Google Docs spreadsheet."/></div></div><div class="figure-title">Figure 5-8. The TimelineJS component can get its data from a Google Docs spreadsheet.</div></div><p><a id="iddle1479" class="indexterm"/>The HTML snippet that TimelineJS creates for this timeline is as follows:</p><a id="pro_id00244"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>&lt;iframe</strong></span></span> <span class="steelblue">src=</span><span class="maroon">"http://cdn.knightlab.com/libs/timeline/latest/embed/index.html?</span>
    <span class="maroon">source=0An4ME25ELRdYdDk4WmRacmxjaDM0V0tDTk9vMnQxU1E&amp;font=Bevan-PotanoSans&amp;</span>
    <span class="maroon">maptype=toner&amp;lang=en&amp;height=650"</span> <span class="steelblue">width=</span><span class="maroon">"100%"</span> <span class="steelblue">height=</span><span class="maroon">"650"</span>
<span class="steelblue">frameborder=</span><span class="maroon">"0"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>&lt;/iframe&gt;</strong></span></span></pre><p>When included in a page, that snippet results in fully interactive timeline for the chronology, as shown in <a class="xref" href="ch05.html#timelinejs_builds_a_complete_timeline_co" title="Figure 5-9. TimelineJS builds a complete timeline component within an &lt;iframe&gt;.">Figure 5-9</a>.</p><div class="figure"><a id="timelinejs_builds_a_complete_timeline_co"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00082"/><img src="figs/web/05fig09.png.jpg" alt="TimelineJS builds a complete timeline component within an &lt;iframe&gt;."/></div></div><div class="figure-title">Figure 5-9. TimelineJS builds a complete timeline component within an <code class="literal">&lt;iframe&gt;</code>.</div></div><p>If the result meets the needs of your visualization, you may not have to go any further. Many web pages that use TimelineJS do so in exactly this manner. There are some potential problems with the simplest approach, however:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>The data for the visualization must be available in a public Google Docs spreadsheet, so the approach may not be appropriate for confidential data.</p></li><li class="listitem"><p>The data source is a spreadsheet, so it may be difficult to update it often or show more real-time events. This problem doesn’t really affect our Shakespeare chronology, but if the timeline you’re creating shows real-time data such as trending topics on a social network, a static spreadsheet won’t be practical.</p></li><li class="listitem"><p>The embedded component has few styling options. Although the default styles and options that TimelineJS offers are quite attractive, they are very limited and may not be appropriate for your web page.</p></li><li class="listitem"><p><a id="iddle1546" class="indexterm"/><a id="iddle2021" class="indexterm"/><a id="iddle2023" class="indexterm"/><a id="iddle2041" class="indexterm"/><a id="iddle2043" class="indexterm"/>The timeline is embedded as an <code class="literal">&lt;iframe&gt;</code>, which gives TimelineJS complete control over what is displayed in that section of your page. While there is <span class="emphasis"><em>absolutely no indication</em></span> that the organizations supporting TimelineJS would do so, <span class="emphasis"><em>in theory</em></span> they could alter the content (for example, by including ads) in ways that your site might not find appropriate.</p></li></ul></div><p>Fortunately, none of these possible concerns need prevent us from adding beautiful TimelineJS visualizations to our web pages. The folks behind TimelineJS make all of the software available as open source, giving us the flexibility to address all of the aforementioned issues. We’ll see how in the rest of this example.</p></div><div class="sect2" title="Step 2: Include the Required Components"><div class="titlepage"><div><div><h3 class="title" id="step_2_include_the_required_components">Step 2: Include the Required Components</h3></div></div></div><p>To use TimelineJS, our web pages must include CSS style sheets and JavaScript code. For now we’ll stick with the default styles, so we need only a single additional style sheet. The main JavaScript is contained in timeline.js.</p><p>It’s not obvious, but TimelineJS also requires jQuery. When you embed a TimelineJS <code class="literal">&lt;iframe&gt;</code>, your main web page doesn’t have to include jQuery, because the <code class="literal">&lt;iframe&gt;</code> will include it. To integrate the timeline directly in our page, though, we have to include jQuery explicitly. We can, however, use a content distribution network instead of hosting it ourselves. (See <a class="xref" href="ch02.html" title="Chapter 2. Making Charts Interactive">Chapter 2</a> for more details on the advantages and disadvantages of content distribution networks.)</p><a id="pro_id00245"/><pre class="programlisting"><span class="dodgerblue">&lt;!DOCTYPE</span> html<span class="dodgerblue">&gt;</span>
<span class="steelblue"><span class="strong"><strong>&lt;html</strong></span></span> <span class="steelblue">lang=</span><span class="maroon">"en"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
  <span class="steelblue"><span class="strong"><strong>&lt;head&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;meta</strong></span></span> <span class="steelblue">charset=</span><span class="maroon">"utf-8"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;title&gt;&lt;/title&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;link</strong></span></span> <span class="steelblue">rel=</span><span class="maroon">"stylesheet"</span> <span class="steelblue">type=</span><span class="maroon">"text/css"</span> <span class="steelblue">href=</span><span class="maroon">"css/timeline.css"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
  <span class="steelblue"><span class="strong"><strong>&lt;/head&gt;</strong></span></span>
  <span class="steelblue"><span class="strong"><strong>&lt;body&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;script</strong></span></span> <span class="steelblue">src=</span><span class="maroon">"//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;/script&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;script</strong></span></span> <span class="steelblue">src=</span><span class="maroon">"js/timeline-min.js"</span><span class="steelblue"><span class="strong"><strong>&gt;&lt;/script&gt;</strong></span></span>
  <span class="steelblue"><span class="strong"><strong>&lt;/body&gt;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>&lt;/html&gt;</strong></span></span></pre><p>The HTML at this point doesn’t include the element in which we’ll place the timeline. There are some special constraints on that element, which we’ll consider when we add it to the page.</p></div><div class="sect2" title="Step 3: Prepare the Data"><div class="titlepage"><div><div><h3 class="title" id="step_3_prepare_the_data-id00024">Step 3: Prepare the Data</h3></div></div></div><p>Because TimelineJS supports several features that we haven’t used in the earlier examples, we’ll add a few additional properties to our data set. The overall format, though, looks the same as before:</p><a id="pro_id00246"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>var</strong></span></span> plays = [
  {
    <span class="maroon">"play"</span>: <span class="maroon">"The Two Gentlemen of Verona"</span>,
    <span class="maroon">"genre"</span>: <span class="maroon">"Comedies"</span>,
    <span class="maroon">"date"</span>: <span class="maroon">"1589-1591"</span>,
    <span class="maroon">"record"</span>: <span class="maroon">"Francis Meres'..."</span>,
    <span class="maroon">"published"</span>: <span class="maroon">"First Folio (1623)"</span>,
    <span class="maroon">"performance"</span>: <span class="maroon">"adaptation by Benjamin Victor..."</span>,
    <span class="maroon">"evidence"</span>: <span class="maroon">"The play contains..."</span>
  }, {
    <span class="maroon">"play"</span>: <span class="maroon">"The Taming of the Shrew"</span>,
    <span class="maroon">"genre"</span>: <span class="maroon">"Comedies"</span>,
    <span class="maroon">"date"</span>: <span class="maroon">"1590-1594"</span>,
    <span class="maroon">"record"</span>: <span class="maroon">"possible version..."</span>,
    <span class="maroon">"published"</span>: <span class="maroon">"possible version..."</span>,
    <span class="maroon">"performance"</span>: <span class="maroon">"According to Philip Henslowe..."</span>,
    <span class="maroon">"evidence"</span>: <span class="maroon">"Kier Elam posits..."</span>
  }, {
    <span class="maroon">"play"</span>: <span class="maroon">"Henry VI, Part 2"</span>,
    <span class="maroon">"genre"</span>: <span class="maroon">"Histories"</span>,
    <span class="maroon">"date"</span>: <span class="maroon">"1590-1591"</span>,
    <span class="maroon">"record"</span>: <span class="maroon">"version of the..."</span>,
    <span class="maroon">"published"</span>: <span class="maroon">"version of the..."</span>,
    <span class="maroon">"performance"</span>: <span class="maroon">"although it is known..."</span>,
    <span class="maroon">"evidence"</span>: <span class="maroon">"It is known..."</span>
    <span class="maroon">"media"</span>: <span class="maroon">"http://upload.wikimedia.org/wikipedia/commons/9/96/</span>
<span class="maroon">FirstFolioHenryVI2.jpg"</span>,
    <span class="maroon">"credit"</span>: <span class="maroon">"Wikimedia Commons"</span>,
    <span class="maroon">"caption"</span>: <span class="maroon">"Photo of the first page..."</span>
  <span class="indianred"><span class="emphasis"><em>// Data set continues...</em></span></span>
},</pre><p><a id="iddle2086" class="indexterm"/>As you can see, we’ve added genre information to the plays, as well as optional multimedia links, and text for credits and captions. With that starting point, we can rearrange the data to match what TimelineJS expects. The basic structure of that object, shown next, includes some overall properties (such as the headline), and an array of events. We can initialize it to an empty array.</p><a id="pro_id00247"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>var</strong></span></span> timelineData = {
    <span class="dodgerblue">headline</span>: <span class="maroon">"Chronology of Shakespeare's Plays"</span>,
    <span class="dodgerblue">type</span>: <span class="maroon">"default"</span>,
    <span class="dodgerblue">date</span>: []
};</pre><p>Note that the <code class="literal">type</code> property is required and should be set to <code class="literal">"default"</code>.</p><p>Now we iterate through the data set, adding events to <code class="literal">timelineData</code>. For the following code, we’ll use <code class="literal">forEach</code> for this iteration, but there are plenty of alternatives we could use here (including <code class="literal">for</code> loops, array <code class="literal">.map()</code> methods, or jQuery’s <code class="literal">$.each()</code> and <code class="literal">$.map()</code> functions).</p><a id="pro_id00248"/><pre class="programlisting"><span class="steelblue">plays</span>.<span class="olive">forEach</span>(<span class="steelblue"><span class="strong"><strong>function</strong></span></span>(play) {
    <span class="steelblue"><span class="strong"><strong>var</strong></span></span> start = <span class="steelblue">play</span>.<span class="olive">date</span>;
    <span class="steelblue"><span class="strong"><strong>var</strong></span></span> end = <span class="maroon">""</span>;
    <span class="steelblue"><span class="strong"><strong>if</strong></span></span> (<span class="steelblue">play</span>.<span class="steelblue">date</span>.<span class="olive">indexOf</span>(<span class="maroon">"-"</span>) !== -<span class="red">1</span>) {
        <span class="steelblue"><span class="strong"><strong>var</strong></span></span> dates = <span class="steelblue">play</span>.<span class="steelblue">date</span>.<span class="olive">split</span>(<span class="maroon">"-"</span>);
        start = dates[<span class="red">0</span>];
        end = dates[<span class="red">1</span>];
    }
});</pre><p><a id="iddle1972" class="indexterm"/><a id="iddle2019" class="indexterm"/><a id="iddle2039" class="indexterm"/>The first step in each iteration is parsing the date information. It can take one of two forms: either a single year (<code class="literal">"1591"</code>) or a range of years (<code class="literal">"1589-1591"</code>). Our code assumes a single date and makes adjustments if it finds two.</p><p>Now we can provide the full entry for the event in TimelineJS format by pushing the new object into the <code class="literal">timelineData.date</code> array.</p><a id="pro_id00249"/><pre class="programlisting"><span class="steelblue">timelineData</span>.<span class="steelblue">date</span>.<span class="olive">push</span>({
   <span class="dodgerblue">startDate</span>: start,
   <span class="dodgerblue">endDate</span>: end,
   <span class="dodgerblue">headline</span>: <span class="steelblue">play</span>.<span class="olive">play</span>,
   <span class="dodgerblue">text</span>: <span class="steelblue">play</span>.<span class="olive">evidence</span>,
   <span class="dodgerblue">tag</span>: <span class="steelblue">play</span>.<span class="olive">genre</span>,
   <span class="dodgerblue">asset</span>: {
       <span class="dodgerblue">media</span>: <span class="steelblue">play</span>.<span class="olive">media</span>,
       <span class="dodgerblue">credit</span>: <span class="steelblue">play</span>.<span class="olive">credit</span>,
       <span class="dodgerblue">caption</span>: <span class="steelblue">play</span>.<span class="olive">caption</span>
   }
});</pre></div><div class="sect2" title="Step 4: Create a Default Timeline"><div class="titlepage"><div><div><h3 class="title" id="step_4_create_a_default_timeline">Step 4: Create a Default Timeline</h3></div></div></div><p>With our HTML set up and our data set prepared, we can now call TimelineJS to create its default visualization. Figuring out exactly how to do that, however, isn’t quite as simple as looking in the documentation. That’s because TimelineJS assumes that it will be used primarily as an embedded and isolated component rather than an integrated part of a page. The documentation, therefore, describes how to use TimelineJS using the <span class="emphasis"><em>storyjs_embed.js</em></span> wrapper for embedded content. That wrapper loads all the TimelineJS resources (style sheets, JavaScript, fonts, and so on), and if we use it as intended, we’ll end up with most of the same problems as if we had simply embedded an <code class="literal">&lt;iframe&gt;</code>.</p><p>Fortunately, it’s not too difficult to skip all the embedding and simply access the JavaScript code directly. It requires only three steps:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Set up the configuration object.</p></li><li class="listitem"><p>Create a TimelineJS object.</p></li><li class="listitem"><p>Initialize the object using the configuration object.</p></li></ol></div><p><a id="iddle2127" class="indexterm"/><a id="iddle2192" class="indexterm"/>Here’s what these steps will look like in our JavaScript, with the details omitted for now:</p><a id="pro_id00250"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>var</strong></span></span> timelineConfig = {<span class="indianred"><span class="emphasis"><em>/* Needs properties */</em></span></span>};
<span class="steelblue"><span class="strong"><strong>var</strong></span></span> timelinejs = <span class="steelblue"><span class="strong"><strong>new</strong></span></span> <span class="steelblue">VMM</span>.<span class="olive">Timeline</span>(<span class="indianred"><span class="emphasis"><em>/* Needs parameters */</em></span></span>);
<span class="steelblue">timelinejs</span>.<span class="olive">init</span>(timelineConfig);</pre><p>We still need to fill in the exact configuration object and the parameters for the <code class="literal">VMM.Timeline</code> constructor. The configuration object is documented in the TimelineJS source (<span class="emphasis"><em><a class="ulink" href="https://github.com/NUKnightLab/TimelineJS#config-options" target="_top">https://github.com/NUKnightLab/TimelineJS#config-options</a></em></span>). We must provide a <code class="literal">type</code> (equal to <code class="literal">"timeline"</code>), dimensions, the data source, and the <code class="literal">id</code> of the HTML element into which the timeline should be placed. For example, we could use this:</p><a id="pro_id00251"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>var</strong></span></span> timelineConfig = {
       <span class="dodgerblue">type</span>:       <span class="maroon">"timeline"</span>,
       <span class="dodgerblue">width</span>:      <span class="maroon">"100%"</span>,
       <span class="dodgerblue">height</span>:     <span class="maroon">"600"</span>,
       <span class="dodgerblue">source</span>:     {<span class="dodgerblue">timeline</span>: timelineData},
       <span class="dodgerblue">embed_id</span>:   <span class="maroon">"timeline"</span>
};</pre><p>We have to pass many of those same parameters to the constructor. In particular, we provide the container’s <code class="literal">id</code> and the dimensions.</p><a id="pro_id00252"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>var</strong></span></span> timelinejs = <span class="steelblue"><span class="strong"><strong>new</strong></span></span> <span class="steelblue">VMM</span>.<span class="olive">Timeline</span>(<span class="maroon">"timeline"</span>,<span class="maroon">"100%"</span>,<span class="maroon">"600px"</span>);</pre><p>Finally, we have to build our HTML markup with care. TimelineJS styles its HTML appropriately for an embedded <code class="literal">&lt;iframe&gt;</code>, but those styles aren’t as compatible with a timeline that’s integrated in the page. In particular, it positions the time-line absolutely and sets its <code class="literal">z-index</code>. If we don’t compensate, the timeline will float out of the flow of the page content, which is almost certainly not desirable. There are several ways to adjust for this issue, and we’ll use a simple one in this example. Instead of a single <code class="literal">&lt;div&gt;</code>, we use two nested <code class="literal">&lt;div&gt;</code> elements. The inner <code class="literal">&lt;div&gt;</code> will contain the timeline, and the outer <code class="literal">&lt;div&gt;</code> establishes both a positioning context and size for the timeline.</p><a id="pro_id00253"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>&lt;div</strong></span></span> <span class="steelblue">style=</span><span class="maroon">"position:relative;height:600px;"</span><span class="steelblue"><span class="strong"><strong>&gt;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>&lt;div</strong></span></span> <span class="steelblue">id=</span><span class="maroon">"timeline"</span><span class="steelblue"><span class="strong"><strong>&gt;&lt;/div&gt;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>&lt;/div&gt;</strong></span></span></pre><p>Now when our JavaScript executes, it produces the integrated timeline shown in <a class="xref" href="ch05.html#with_a_little_extra_workcomma_we_can_emb" title="Figure 5-10. With a little extra work, we can embed a TimelineJS timeline directly in the page without an &lt;iframe&gt;.">Figure 5-10</a> with the default TimelineJS styling.</p><p><a id="iddle2017" class="indexterm"/><a id="iddle2018" class="indexterm"/><a id="iddle2038" class="indexterm"/>Before we leave this step, it’s worth considering how we’ve reached this point. We’ve taken a complete web component with explicit instructions for its use, and ignored those instructions. Instead, we’ve included only part of the component (albeit a major part). Figuring out how to use an isolated part of a web component (in a way that it isn’t necessarily intended for) can involve some guesswork and trial and error, and there is clearly some risk in this approach. Even if you manage to get it working now, a future update might invalidate your implementation. If you adopt this approach with your website, it’s a good idea to test the implementation thoroughly and to take extra care with any updates.</p><div class="figure"><a id="with_a_little_extra_workcomma_we_can_emb"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00083"/><img src="figs/web/05fig10.png.jpg" alt="With a little extra work, we can embed a TimelineJS timeline directly in the page without an &lt;iframe&gt;."/></div></div><div class="figure-title">Figure 5-10. With a little extra work, we can embed a TimelineJS timeline directly in the page without an <code class="literal">&lt;iframe&gt;</code>.</div></div></div><div class="sect2" title="Step 5: Adjust the Timeline Styles"><div class="titlepage"><div><div><h3 class="title" id="step_5_adjust_the_timeline_styles">Step 5: Adjust the Timeline Styles</h3></div></div></div><p>Now that we’ve addressed the issues that an <code class="literal">&lt;iframe&gt;</code> can cause, we can turn our attention to the timeline’s appearance. The <span class="emphasis"><em>timeline.css</em></span> stylesheet determines that appearance, and there are several alternatives for adjusting it.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: none"><p title="Modify timeline.css directly"><span class="title"><strong><span class="strong"><strong>Modify <span class="emphasis"><em>timeline.css</em></span> directly</strong></span></strong></span>. <a id="iddle1147" class="indexterm"/><a id="iddle1384" class="indexterm"/><a id="iddle1595" class="indexterm"/>Although this approach might seem the most obvious, it’s probably not what we should do. If you look at the file, you’ll notice that it’s compressed CSS that’s difficult to read and understand. Making the appropriate modifications will be challenging. Furthermore, if we later update to a new version of TimelineJS, that new version may well have a new <span class="emphasis"><em>timeline.css</em></span> file, and we’d have to start all over again.</p></li><li class="listitem" style="list-style-type: none"><p title="Work with the source code"><span class="title"><strong><span class="strong"><strong>Work with the source code</strong></span></strong></span>. TimelineJS authors its styles using the LESS (<span class="emphasis"><em><a class="ulink" href="http://lesscss.org/" target="_top">http://lesscss.org/</a></em></span>) CSS preprocessor. If you’re comfortable using a CSS preprocessor, you could modify the source and build your own custom version of <span class="emphasis"><em>timeline.css</em></span>. LESS has support for variables and mixins that make it easier to accommodate updates in the future. There are many applications that compile LESS into CSS; TimelineJS uses CodeKit (<span class="emphasis"><em><a class="ulink" href="https://incident57.com/codekit/" target="_top">https://incident57.com/codekit/</a></em></span>), which is available only for Apple’s Mac OS X, and the source code includes all of the appropriate application settings.</p></li><li class="listitem" style="list-style-type: none"><p title="Supersede timeline.css styles"><span class="title"><strong><span class="strong"><strong>Supersede <span class="emphasis"><em>timeline.css</em></span> styles</strong></span></strong></span>. Instead of changing the TimelineJS style sheet, leave it <span class="emphasis"><em>as is</em></span> and add custom styles with a higher priority than the default styles. This approach takes advantage of the <span class="emphasis"><em>cascade</em></span> in Cascading Style Sheets.</p></li></ul></div><p>For this example, we’ll use the last approach. We’ll identify the <span class="emphasis"><em>timeline.css</em></span> styles that we want to change and add new rules to our style sheet to take precedence over those styles. When CSS finds that multiple, conflicting rules apply to an element, it resolves the conflict by considering the specificity of the rules and their order in the document. We can give our rules priority by making them more specific than the <span class="emphasis"><em>timeline.css</em></span> rules, or by making them equally specific but including them after <span class="emphasis"><em>timeline.css</em></span>.</p><p>First we’ll tackle the fonts that TimelineJS uses. There’s nothing wrong with the default or optional fonts, but they may not match the style of our web page. In addition, downloading extra fonts will slow the performance of the page. The quickest way to find the styles that affect fonts is to look at one of the optional font selections that TimelineJS offers on its website. For example, if you select the “Merriweather &amp; News Cycle” option, you’ll see that TimelineJS adds an additional style sheet to the visualization, <span class="emphasis"><em>NewsCycle-Merriweather.css</em></span>, which defines all the font rules for this option:</p><a id="pro_id00254"/><pre class="programlisting"><span class="red">.vco-storyjs</span> <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>font-family:</strong></span></span> <span class="maroon">"News Cycle"</span>, <span class="dodgerblue">sans-serif</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span>

<span class="indianred"><span class="emphasis"><em>/* Additional styles... */</em></span></span>

<span class="red">.timeline-tooltip</span> <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>font-family:</strong></span></span> <span class="maroon">"News Cycle"</span>, <span class="dodgerblue">sans-serif</span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p>To use our own fonts, all we need to do is copy that file and replace <code class="literal">"News Cycle"</code> and <code class="literal">"Merriweather"</code> with our own choice—in this case, Avenir.</p><a id="pro_id00255"/><pre class="programlisting"><span class="red">.vco-storyjs</span> <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>font-family:</strong></span></span> <span class="maroon">"Avenir"</span>,<span class="maroon">"Helvetica Neue"</span>,Helvetica,Arial,<span class="dodgerblue">sans-serif</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>font-weight:</strong></span></span> <span class="dodgerblue">700</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span>

<span class="indianred"><span class="emphasis"><em>/* Additional styles... */</em></span></span>

<span class="red">.timeline-tooltip</span> <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>font-family:</strong></span></span> <span class="maroon">"Avenir"</span>, <span class="dodgerblue">sans-serif</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p>Customizing other aspects of the TimelineJS visualization is more challenging but not impossible. These customizations are rather fragile, however, as even the slightest change in the TimelineJS implementation could render them ineffective. If it’s important for your page, though, it can be done.</p><p>For our example, we’ll change the blue color that TimelineJS uses in the bottom section of the visualization. It uses that color to highlight the active item, to show the timeline marker, and for the event line. Finding the specific rules to override takes a bit of detective work with your browser’s developer tools, but here’s how to change the color from blue to green:</p><a id="pro_id00256"/><pre class="programlisting"><span class="red">.vco-timeline</span> <span class="red">.vco-navigation</span> <span class="red">.timenav</span> <span class="red">.content</span> <span class="red">.marker.active</span> <span class="red">.flag</span>
<span class="red">.flag-content</span> h3,
<span class="red">.vco-timeline</span> <span class="red">.vco-navigation</span> <span class="red">.timenav</span> <span class="red">.content</span> <span class="red">.marker.active</span> <span class="red">.flag-small</span>
<span class="red">.flag-content</span> h3 <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>color:</strong></span></span> <span class="dodgerblue">green</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span>
<span class="red">.vco-timeline</span> <span class="red">.vco-navigation</span> <span class="red">.timenav-background</span> <span class="red">.timenav-line</span> <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>background-color:</strong></span></span> <span class="dodgerblue">green</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span>
<span class="red">.vco-timeline</span> <span class="red">.vco-navigation</span> <span class="red">.timenav</span> <span class="red">.content</span> <span class="red">.marker</span> <span class="red">.line</span> <span class="red">.event-line</span>,
<span class="red">.vco-timeline</span> <span class="red">.vco-navigation</span> <span class="red">.timenav</span> <span class="red">.content</span> <span class="red">.marker.active</span> <span class="red">.line</span>
<span class="red">.event-line</span>,
<span class="red">.vco-timeline</span> <span class="red">.vco-navigation</span> <span class="red">.timenav</span> <span class="red">.content</span> <span class="red">.marker.active</span> <span class="red">.dot</span>,
<span class="red">.vco-timeline</span> <span class="red">.vco-navigation</span> <span class="red">.timenav</span> <span class="red">.content</span> <span class="red">.marker.active</span> <span class="red">.line</span> <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>background:</strong></span></span> <span class="dodgerblue">green</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p>Combining font changes with the alternative color scheme helps the visualization integrate more seamlessly in an overall web page, as <a class="xref" href="ch05.html#adjusting_the_css_for_timelinejs_can_hel" title="Figure 5-11. Adjusting the CSS for TimelineJS can help match its styles with the rest of the web page.">Figure 5-11</a> shows.</p><div class="figure"><a id="adjusting_the_css_for_timelinejs_can_hel"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00084"/><img src="figs/web/05fig11.png.jpg" alt="Adjusting the CSS for TimelineJS can help match its styles with the rest of the web page."/></div></div><div class="figure-title">Figure 5-11. Adjusting the CSS for TimelineJS can help match its styles with the rest of the web page.</div></div></div></div><div class="sect1" title="Summing Up"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="summing_up-id00025">Summing Up</h2></div></div></div><p>In this chapter, we’ve looked at a wide range of approaches for creating timeline visualizations. The most familiar approach relies on an open source library, but we also considered two other options. In one, we developed the code for a timeline from scratch, which gave us complete control over its appearance and behavior. For the other extreme, we examined a popular open source web component. Pages normally use that component by embedding <code class="literal">&lt;iframe&gt;</code> elements in the page, but we also saw that it’s possible to take the open source code and integrate it more seamlessly in our pages, even altering the visual styles if necessary.</p></div></section></body></html>