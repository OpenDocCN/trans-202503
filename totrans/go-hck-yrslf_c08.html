<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" epub:prefix="index: http://www.index.com/" lang="en" xml:lang="en">
	<head>
		<title>Chapter 8: Web Hacking</title>
		<link href="NSTemplate_v1.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:af29b7b1-e841-4e64-a1ef-e03d2d2c1d42" name="Adept.expected.resource"/>
	</head>
	<body epub:type="bodymatter chapter">
		<section>
			<header>
				<h1 class="chapter"><span class="ChapterNumber"><span epub:type="pagebreak" id="Page_91" title="91"/>8</span><br/><span class="ChapterTitle">Web Hacking</span></h1>
			</header>
			<figure class="opener">
				<img alt="" src="image_fi/book_art/chapterart.png"/>
			</figure>
			<p class="ChapterIntro">Hacking an individual computer might yield a handful of usernames, passwords, and other data. But hacking a web server could give an attacker <em>millions</em> of usernames and passwords to test on banking sites, email servers, and more.</p>
			<p>
				A 2019 attack on Quest Diagnostics through a flaw in its web payment page exposed 12 million patients’ records. In 2017, the credit bureau Equifax failed to protect 150 million people’s credit information, including birth dates, Social Security numbers, and addresses. A hack against Marriott in 2018 compromised 500 million travelers’ data, including credit card numbers and passport data. The largest data breach to date—the 2013 attack on web search engine and email platform Yahoo!—exposed all 3 <em>billion</em> users’ accounts, including email addresses and passwords.</p>
			<p>In this chapter, you’ll see how malicious hackers attack web applications with only a web browser and a few lines of code. You’ll also learn some common ways security professionals defend against web attacks, safeguarding millions (perhaps billions!) of people’s data from cybercriminals.</p>
			<h2 id="h1-502000c08-0001"><span epub:type="pagebreak" id="Page_92" title="92"/>The Metasploitable VM</h2>
			<p class="BodyFirst">We want to practice web hacking safely and ethically, so we’ll set up a web server in our virtual hacking lab. The creators of Metasploit also created an intentionally vulnerable web server, called Metasploitable, for training purposes. We’re going to use a version of that server that I’ve customized for you. Let’s add it to your virtual hacking lab:</p>
			<ol class="decimal">
				<li value="1">Go to <a class="LinkURL" href="https://www.nostarch.com/go-hck-yourself/">https://www.nostarch.com/go-hck-yourself/</a> and click the link to download the <em>Metasploitable2-gohack.ova</em> file to your host computer.</li>
				<li value="2">Double-click the downloaded file to open it in VirtualBox. The Import Virtual Appliance window will open, as shown in <a href="#figure8-1" id="figureanchor8-1">Figure 8-1</a>. Click <b>Import</b>.
					<figure>
						<img alt="f08001" class="" src="image_fi/502000c08/f08001.png"/>
						<figcaption>
							<p><a id="figure8-1">Figure 8-1</a>: Importing the <em>Metasploitable2-</em><em>gohack</em><em>.ova</em> file into VirtualBox</p>
						</figcaption>
					</figure>
					</li>
				<li value="3">Select the Metasploitable2 VM in the VirtualBox VM Manager and click <b>Settings</b>.</li>
				<li value="4">Go to the <b>Network</b> tab and make sure the Enable Network Adapter box is checked and shows Attached to: NAT Network and Name: PublicNAT, just as for our other VMs. The correct settings are shown in <a href="#figure8-2" id="figureanchor8-2">Figure 8-2</a>.<span epub:type="pagebreak" id="Page_93" title="93"/>
				<figure><img alt="f08002" class="" src="image_fi/502000c08/f08002.png"/><figcaption>
							<p><a id="figure8-2">Figure 8-2</a>: Making sure the Metasploitable VM is connected to the PublicNAT network</p>
						</figcaption>
					</figure>
					</li>
				<li value="5">Click <b>OK</b> to save these network settings. Your new Metasploitable VM is now ready to run!</li>
				<li value="6">Select Metasploitable in VirtualBox Manager and click <b>Start</b>. Because Metasploitable is a web server, not a desktop computer, it uses a text-based interface instead of a graphical user interface. If the interface is too small to read, go to the VM’s menu bar and select <b>View</b><span class="MenuArrow">▶</span><b>Virtual Screen 1</b><span class="MenuArrow">▶</span><b>Scale to 200%</b> (or another value that fits your screen).</li>
				<li value="7">Enter the username <code class="bold">msfadmin</code> and password <code class="bold">msfadmin</code>. The password won’t show up as you type in the terminal window on Metasploitable, but if you enter it correctly, the prompt will change from the login to a shell prompt like this one:
					<pre><code>msfadmin@metasploitable:~$</code></pre>
			</li>
				<li value="8">Enter this command:
					<pre><code>msfadmin@metasploitable:~$ <code class="bold">ip a</code></code></pre>
					<p class="ListBody">Metasploitable will respond with its IP address (<code>10.0.9.8</code> in my case):</p>
					<pre><code><var>--snip--</var>
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000 link/ether 08:00:27:11:23:67 brd ff:ff:ff:ff:ff:ff inet <span aria-label="annotation1" class="CodeAnnotationCode">1</span> <var>10.0.9.8</var>/24 brd 10.0.9.255 scope global eth0 <var>--snip--</var></code></pre>
					<p class="ListBody">Take note of the IP address <span aria-label="annotation1" class="CodeAnnotation">1</span>. You’ll need it to surf to the Metasploitable VM’s web server from your other virtual machines.</p>
					</li>
			</ol>
			<h2 id="h1-502000c08-0002"><span epub:type="pagebreak" id="Page_94" title="94"/>Web Hacking from a Browser</h2>
			<p class="BodyFirst">Web hacking is very common because it’s rewarding for attackers (remember, a successful attack against a web server can yield <em>millions</em> of users’ information at once), web servers are always on and connected to the internet, and the attacker needs only a web browser to do it. To see how it works, we’ll hack the Metasploitable server from the Edge browser in our Windows 10 VM.</p>
			<p>
				Start your Windows 10 VM in VirtualBox Manager. Log in with the credentials <code class="bold">IEUser</code> and <code class="bold">Passw0rd!</code>. Open the Edge browser (it’s the blue <em>e</em> swirl icon on the taskbar) and enter your Metasploitable VM’s IP address into the address bar. You’ll see the Metasploitable 2 home page shown in <a href="#figure8-3" id="figureanchor8-3">Figure 8-3</a>.</p>
			<figure>
				<img alt="f08003" class="" src="image_fi/502000c08/f08003.png"/>
				<figcaption>
					<p><a id="figure8-3">Figure 8-3</a>: From your Windows 10 VM, enter your Metasploitable VM’s IP address to see this home page.</p>
				</figcaption>
			</figure>
			<p>Metasploitable 2 contains five vulnerable web applications, but we’ll focus on just one of them: DVWA, or Darn Vulnerable Web App. This intentionally vulnerable open source web application was built to help web developers and security professionals learn basic hacks, as well as how to protect a web application from them. DVWA has different vulnerability levels so users can try hacking applications with varying degrees of security. We’ll set the security level to low, to simulate a web application with no added security.</p>
			<ol class="decimal">
				<li value="1">Click the <b>DVWA</b> link on the Metasploitable 2 home page. You’ll see the app’s login screen, shown in <a href="#figure8-4" id="figureanchor8-4">Figure 8-4</a>.</li>
				<li value="2">Enter <code class="bold">admin</code> as the username and <code class="bold">password</code> as the password to access DVWA. <span epub:type="pagebreak" id="Page_95" title="95"/>
				<figure><img alt="f08004" class="" src="image_fi/502000c08/f08004.png"/><figcaption>
							<p><a id="figure8-4">Figure 8-4</a>: The DVWA login screen with our credentials</p>
						</figcaption>
					</figure>
					</li>
				<li value="3">Click <b>DVWA Security </b>on the left.</li>
				<li value="4">Under the Script Security section, set the security level to <b>low</b> and click <b>Submit</b>, as shown in <a href="#figure8-5" id="figureanchor8-5">Figure 8-5</a>.
					<figure>
						<img alt="f08005" class="" src="image_fi/502000c08/f08005.png"/>
						<figcaption>
							<p><a id="figure8-5">Figure 8-5</a>: Setting the DVWA script security level to low</p>
						</figcaption>
					</figure>
					</li>
			</ol>
			<p>Now we’re ready to try out two kinds of web attacks on DVWA: cross-site scripting attacks and SQL injection attacks.</p>
			<h3 id="h2-502000c08-0001"><span epub:type="pagebreak" id="Page_96" title="96"/>Launching Cross-Site Scripting Attacks</h3>
			<p class="BodyFirst">In a<em> cross-site scripting (XSS) attack</em>, a hacker enters malicious code into a web page through a field intended for regular text input, such as a login form or a search field. XSS attacks are also known as <em>code injection</em> attacks, because hackers are able to enter, or <em>inject</em>, their own code into the web application. We’ll use two web languages—JavaScript and HyperText Markup Language (HTML)—to inject a script into DVWA.</p>
			<p>To test a web application for XSS vulnerabilities, you need only a single JavaScript command:</p>
			<pre><code>alert("You've been hacked!");</code></pre>
			<p>
				The command pops up an alert box reading “You’ve been hacked!” To inject it into a web page, we wrap the JavaScript code in the proper HTML tags, <code>&lt;script&gt;</code> and <code>&lt;/script&gt;</code>, like this:</p>
			<pre><code>&lt;script&gt;alert("You've been hacked!");&lt;/script&gt;</code></pre>
			<p>
				The HTML <code>&lt;script&gt;</code> tag tells a web page that a <em>script</em> (a short piece of code), usually in JavaScript, is beginning. The <code>&lt;/script&gt;</code> tag is called a closing tag, and it lets the web page know the script code is finished.</p>
			<h4 id="h3-502000c08-0001">Reflected Cross-Site Scripting</h4>
			<p class="BodyFirst">A <em>reflected XSS attack</em> takes advantage of pages that display, or <em>reflect</em>, a user’s input directly back to them on the web page, like an order form that asks for your name and address and then displays them to you to confirm that you typed them correctly. Attackers use reflected cross-site scripting to inject malicious HTML or JavaScript code into an unprotected web application. Let’s try it out!</p>
			<ol class="decimal">
				<li value="1">In DVWA on your Windows 10 VM, click <b>XSS reflected </b>on the left to open the Vulnerability: Reflected Cross Site Scripting (XSS) web page.
					<p class="ListBody">This page is designed to reflect your input into the What’s your name? text field by displaying it to you, after the word <em>Hello</em>. For example, if you enter the name <code>Bryson</code>, the page will respond with <code>Hello Bryson</code>.</p>
					</li>
				<li value="2">Instead of your name, enter the HTML/JavaScript command from the previous section into the name text field, as shown in <a href="#figure8-6" id="figureanchor8-6">Figure 8-6</a>:
					<pre><code><code class="bold">&lt;script&gt;alert("You've been hacked!");&lt;/script&gt;</code></code></pre>
			<span epub:type="pagebreak" id="Page_97" title="97"/>
					<figure><img alt="f08006" class="" src="image_fi/502000c08/f08006.png"/><figcaption>
							<p><a id="figure8-6">Figure 8-6</a>: Attacking the reflected XSS page by entering HTML and JavaScript into the text box</p>
						</figcaption>
					</figure>
					</li>
				<li value="3">Click <b>Submit</b>, and the web page will reload, popping up the message “You’ve been hacked!” as shown in <a href="#figure8-7" id="figureanchor8-7">Figure 8-7</a>.
					<figure>
						<img alt="f08007" class="" src="image_fi/502000c08/f08007.png"/>
						<figcaption>
							<p><a id="figure8-7">Figure 8-7</a>: The vulnerable web page pops up a message saying we’ve been hacked!</p>
						</figcaption>
					</figure>
					</li>
			</ol>
			<p>By combining a single line of HTML and JavaScript and entering it into an unprotected text box in DVWA, we injected our code into the web page. A malicious attacker could use the same technique to convince a user that their computer is really under attack and get them to call a toll-free number for “technical support.” In this common scam, criminals rent a call center to take worried victims’ credit card information and charge them for fake computer services.</p>
			<h4 id="h3-502000c08-0002">Stored Cross-Site Scripting</h4>
			<p class="BodyFirst">Most websites use databases to store user input or information that changes often, such as product information or customer data. If an attacker injects malicious code into a web form tied to a database, that malicious code gets stored in the database and becomes a permanent part of the web page. This type of attack, called a <em>stored XSS attack</em>, ensures that the malicious <span epub:type="pagebreak" id="Page_98" title="98"/>code will run every time someone views the affected web page. By contrast, our reflected XSS attack didn’t permanently change the web page since our injected code wasn’t saved to a database. We’ll try out a stored XSS attack now.</p>
			<ol class="decimal">
				<li value="1">Click <b>XSS stored</b> in the DVWA menu at the left. You’ll see a guestbook-like application that allows a user to save their name and a short message to the page.</li>
				<li value="2">Instead of signing the guestbook with your name and a nice message, enter just your name. Then, in the Message text box, enter the XSS attack code that we want to store in this page’s database, <code class="bold">&lt;script&gt;alert("You've been hacked!");&lt;/script&gt;</code>, as shown in <a href="#figure8-8" id="figureanchor8-8">Figure 8-8</a>.
					<figure>
						<img alt="f08008" class="" src="image_fi/502000c08/f08008.png"/>
						<figcaption>
							<p><a id="figure8-8">Figure 8-8</a>: Storing our malicious script in the XSS stored page in DVWA</p>
						</figcaption>
					</figure>
					</li>
				<li value="3">Click <b>Sign Guestbook</b>, and you’ll see the alert pop up, as shown in <a href="#figure8-9" id="figureanchor8-9">Figure 8-9</a>.
					<figure>
						<img alt="f08009" class="" src="image_fi/502000c08/f08009.png"/>
						<figcaption>
							<p><a id="figure8-9">Figure 8-9</a>: Our JavaScript alert will tell every visitor, “You’ve been hacked!”</p>
						</figcaption>
					</figure>
					</li>
			</ol>
			<p><span epub:type="pagebreak" id="Page_99" title="99"/>Unlike in the reflected attack, this alert will pop up every time someone visits the Stored Cross Site Scripting (XSS) guestbook page. You’ve used a database-driven web page to permanently store a malicious script in the DVWA website.</p>
			<p>
				JavaScript can do much more than pop up an alert message, though. Let’s change the browser’s <code>window.location</code> to redirect users to a completely different website:</p>
			<ol class="decimal">
				<li value="1">Load the XSS stored web page again and click <b>OK</b> to close the alert message pop-up.</li>
				<li value="2">This time, after entering your name as usual, enter the following code into the Message text box, as shown in <a href="#figure8-10" id="figureanchor8-10">Figure 8-10</a>:
					<pre><code><code class="bold">&lt;script&gt;window.location.href="https://www.nostarch.com/go-hck-yourself";&lt;/script&gt;</code></code></pre>
					<figure>
						<img alt="f08010alt" class="" src="image_fi/502000c08/f08010alt.png"/>
						<figcaption>
							<p><a id="figure8-10">Figure 8-10</a>: Entering a more malicious script that will redirect the user to a completely different web page</p>
						</figcaption>
					</figure>
					</li>
				<li value="3">Click <b>Sign Guestbook</b>, and you’ll see the alert pop-up we injected before. But as soon as you close the alert, you’ll be taken to <a class="LinkURL" href="https://www.nostarch.com/go-hck-yourself/">https://www.nostarch.com/go-hck-yourself/</a>. You can’t go back to the DVWA XSS stored page because every time you reload the page, it redirects to the <em>Go H*ck Yourself</em> web page.</li>
			</ol>
			<p>We’ve permanently hijacked the XSS stored page so that every visitor will be redirected to this book’s website instead. An attacker could do the same, or worse, to an unprotected web application in your employer’s website, your favorite online game or social media app, or even your local government website. To restore the site’s original functionality, the site administrator would have to access the database and delete the stored XSS code entirely.</p>
			<p>
				To reset the database in DVWA to delete the malicious code we entered, click <b>Setup </b>in the DVWA menu on the left, as shown in <a href="#figure8-11" id="figureanchor8-11">Figure 8-11</a>. Then click <b>Create / Reset Database</b>, and DVWA will reset the database to its original state.</p>
				<span epub:type="pagebreak" id="Page_100" title="100"/>
				<figure>
				<img alt="f08011" class="" src="image_fi/502000c08/f08011.png"/>
				<figcaption>
					<p><a id="figure8-11">Figure 8-11</a>: Clearing your stored XSS hacks</p>
				</figcaption>
			</figure>
			<h3 id="h2-502000c08-0002">Launching SQL Injection Attacks on Databases</h3>
			<p class="BodyFirst">Injecting malicious code <em>into</em> a website was scary, but how do hackers take sensitive data <em>from</em> a website? In this section, you’ll learn how web hackers use Structured Query Language (SQL) injection attacks to steal information directly from a website’s database. SQL is the language used to access most databases, and a <em>SQL injection</em> <em>(SQLi)</em> involves inserting malicious SQL code into a web application to trick the application’s database into revealing private information.<em> </em></p>
			<p>
				Databases contain <em>tables</em>, which look like spreadsheets of columns and rows. The columns are for different <em>fields</em> or pieces of information, like first name, last name, username, password, email address, and so on. The rows are for individual <em>records</em>. For example, each user in a table of users would occupy a separate row.</p>
			<p>
				When we access a database, we use a SQL <em>query</em>, like this one:</p>
			<pre><code>SELECT password FROM users WHERE username='Bryson'</code></pre>
			<p>
				This query requests the <code>password</code> field from the <code>users</code> table from the row or rows where the <code>username</code> field is <code>Bryson</code>. We can modify the query slightly to ask for <em>all</em> users’ passwords:</p>
			<pre><code>SELECT password FROM users WHERE username='Bryson' OR 1='1'</code></pre>
			<p>
				By adding an <code>OR</code> condition to the query, we’ve asked the database to select all the passwords from the <code>users</code> table. At every row, SQL will ask whether <code>username</code> equals <code>'Bryson'</code> or whether <code>1</code> equals <code>'1'</code> for that row. If either of these conditions is true, SQL will return the password for that row. Because one of the conditions is <em>always</em> true (1 is always equal to 1), the database will return <em>every</em> password in the <code>users</code> table.</p>
			<p><span epub:type="pagebreak" id="Page_101" title="101"/>Let’s inject some SQL queries into DVWA to steal information from the website’s database.</p>
			<ol class="decimal">
				<li value="1">In your Windows 10 VM’s Edge browser, make sure DVWA Script Security is set to low (as shown in <a href="#figure8-5">Figure 8-5</a> on page <span class="xref" itemid="xref_target_95">95</span>).</li>
				<li value="2">Click <b>SQL Injection</b> in the DVWA menu on the left. You’ll see a user lookup page like the one in <a href="#figure8-12" id="figureanchor8-12">Figure 8-12</a>. 
					<p class="ListBody">Normally, entering a User ID (such as 1) into the text box and clicking Submit reveals that particular user’s information. However, we’ll hack the form to show all the users.</p>
					</li>
				<li value="3">Reload the SQL Injection page if you’ve tried looking up a user. Then enter <code class="bold">' OR 1='1</code> into the User ID: text box, as shown in <a href="#figure8-12">Figure 8-12</a>.
					<figure>
						<img alt="f08012" class="" src="image_fi/502000c08/f08012.png"/>
						<figcaption>
							<p><a id="figure8-12">Figure 8-12</a>: Attacking the database by injecting SQL code into a vulnerable database search form</p>
						</figcaption>
					</figure>
					<aside epub:type="sidebar">
						<div class="top hr">
							<hr/>
						</div>
						<section class="note">
							<h2><span class="NoteHead">NOTE</span></h2>
							<p>
									Notice that the final quote (after <code>1='1</code>) doesn’t need to be entered. This is because the form inserts the user ID into SQL code that already has single quotes around it, like <code>user_id='2'</code>, so <code>' OR 1='1</code> enters the database as <code>user_id='' OR 1='1'</code>, yielding a statement that’s always true.</p>
							<div class="bottom hr">
								<hr/>
							</div>
						</section>
					</aside>
			</li>
				<li value="4">Click <b>Submit</b>, and you should see a listing of all users’ first names and last names (surnames), as shown in <a href="#figure8-13" id="figureanchor8-13">Figure 8-13</a>.</li>
				<li value="5">Now let’s extract all the DVWA usernames and passwords. Reload the SQL Injection page and enter the following SQL code into the search box under User ID:
					<pre><code><code class="bold">' union select user, password from users#</code></code></pre>
			<span epub:type="pagebreak" id="Page_102" title="102"/>
					<figure><img alt="f08013" class="" src="image_fi/502000c08/f08013.png"/><figcaption>
							<p><a id="figure8-13">Figure 8-13</a>: We’ve revealed all five users’ first and last names!</p>
						</figcaption>
					</figure>
					<p class="ListBody">The <code>union</code> command in SQL joins two query statements to access multiple tables at the same time. In this case, we’re combining the user ID lookup for first and last names with a query that will return usernames and passwords from the <code>users</code> table.</p>
					</li>
				<li value="6">Click <b>Submit</b>, and you’ll see all five users’ usernames and passwords in place of their first and last names, as shown in <a href="#figure8-14" id="figureanchor8-14">Figure 8-14</a>. All the passwords are in hashed form, but as you learned in Chapter 7, tools like Hashes.com or John the Ripper make short work of most password hashes.</li>
			</ol>
			<figure>
				<img alt="f08014" class="" src="image_fi/502000c08/f08014.png"/>
				<figcaption>
					<p><a id="figure8-14">Figure 8-14</a>: We’ve stolen all the usernames and password hashes from DVWA using a SQL injection attack!</p>
				</figcaption>
			</figure>
			<p><span epub:type="pagebreak" id="Page_103" title="103"/>As you can see, a hacker armed with a few short lines of JavaScript or SQL can damage a web application, redirect users to a malicious site, steal data, or worse. Fortunately, ethical hackers can help website owners defend against these attacks, tremendously improving the security of everyone’s online data.</p>
			<h2 id="h1-502000c08-0003">Securing Web Applications from XSS, SQLi, and More</h2>
			<p class="BodyFirst">DVWA shows both how to hack <em>and</em> how to secure web applications. In the bottom-right corner of every vulnerable page, there’s a View Source button that shows the page’s code. We’ll compare the source code of the low-security page with that of pages with higher security levels to learn how to protect against injection attacks.</p>
			<p>
				Still on the SQL Injection page with DVWA’s Script Security set to low, click <b>View Source</b> to see the source code for the user lookup application, including these two lines of code:</p>
			<pre><code>$id = $_GET['id']; 
$getid = "SELECT first_name, last_name FROM users WHERE user_id = '$id'"; </code></pre>
			<p>
				This web application is written in PHP, a popular web programming language. The first line of code gets the user’s input from a form field named <code>'id'</code> and stores it in a variable called <code>$id</code>. Then, it creates a SQL query using the user’s input. The user’s unmodified input becomes part of the code—this is a dangerous programming mistake, and it’s what allowed us to hack into the database.</p>
			<p>
				Click <b>DVWA Security</b> on the left, change the Script Security level to <b>medium</b>, and click <b>Submit</b>. Click <b>SQL Injection</b> to return to the user lookup application and then click <b>View Source</b> again. (If you have trouble switching security levels, close the Edge browser, reopen it, and log back in to DVWA.) This time, you’ll see a new line of code inserted between the two just listed:</p>
			<pre><code>$id = mysql_real_escape_string($id); </code></pre>
			<p>
				This line reformats the user’s input to add <em>escape characters</em> (like the backslash <code>\</code>) before any special characters the user typed, such as the single quote <code>'</code> we used in the <code>' OR 1='1</code> hack. Adding a backslash before a single quote tells the database to treat the single quote like it’s a part of the text, not part of a command. The <code>mysql_real_escape_string()</code> command makes the form safer by changing the single quote and other potentially malicious characters into their harmless escape sequence forms (<code>\'</code>) so that the database doesn’t treat them like code, but a motivated attacker could still get around this.</p>
			<p>
				Go back to the DVWA Security page and change the Script Security level to <b>high</b>. Then return to the SQL Injection page and click <b>View Source</b> one last time. Look for this code:</p>
			<pre><code>    $id = $_GET['id']; $id = stripslashes($id); $id = mysql_real_escape_string($id);<span epub:type="pagebreak" id="Page_104" title="104"/>    if (is_numeric($id)){ <var>--snip--</var></code></pre>
			<p>
				The high-security code uses the <code>stripslashes()</code> command to remove backslashes from the user’s text and <code>is_numeric()</code> to make sure you entered a number. Using <code>is_numeric()</code> is an example of form field <em>validation</em>: the command <code>is_numeric()</code> checks that the user’s submission is in an acceptable, expected format—in this case a numeric ID—and proceeds only if it is.</p>
			<p>
				View the source of some of the other pages at low, medium, and high security to discover other layers of commands that web developers use to protect their apps. For example, the secure version of the XSS-reflected page includes <code>htmlspecialchars()</code> to protect against HTML and JavaScript injection. To prevent user input from breaking the website or database code, the added commands in the higher-security versions of the source code <em>sanitize</em> the input, or remove potentially malicious code symbols (like the single quote, backslash, and angle bracket characters) from it, before that input is used on the site or in the database.</p>
			<h2 id="h1-502000c08-0004">The Takeaway</h2>
			<p class="BodyFirst">In this chapter, you learned that web servers are online and available to hackers around the globe 24/7. Moreover, a single unprotected web form can expose millions of users’ data to an attacker. You built an intentionally vulnerable web server, the Metasploitable VM, in your virtual hacking lab, and you used the DVWA web application to train yourself to test websites for two types of code injection: cross-site scripting (XSS) and SQL injection (SQLi).</p>
			<p>You used reflected and stored malicious JavaScript code to make a web page pop up an alert message and redirect the browser to a different website. You viewed the first and last names of all users in a database-driven web application using SQL, and then you learned how an attacker could steal usernames and password hashes from a web database. With the password-cracking tools we used in Chapter 7, an attacker could steal millions of usernames and passwords with very little skill or effort.</p>
			<p>With so much at stake, securing web applications from attacks is an important role for ethical hackers. It takes multiple layers of security to adequately protect web applications. You learned about several functions in the popular web-programming language PHP that sanitize user input by removing special code-related characters, protecting the server and database. You also saw an example of form field validation, checking a text field to make sure that a user entered an acceptable value.</p>
			<p>In the next chapter, you get to add one more set of skills to your ethical hacking toolbelt—mobile device hacking! You’ll learn how to keep yourself and your loved ones safe from the increasing number of mobile attacks.</p>
		</section>
	</body>
</html>