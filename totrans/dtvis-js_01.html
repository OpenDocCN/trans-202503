<html><head></head><body><section class="chapter" title="Chapter&#xA0;1.&#xA0;Graphing Data" epub:type="chapter" id="graphing_data"><div class="titlepage"><div><div><h2 class="title">Chapter 1. Graphing Data</h2></div></div></div><p><a id="iddle1896" class="indexterm"/>Many people think of data visualization as intricate interactive graphics of dazzling complexity. Creating effective visualizations, however, doesn’t require Picasso’s artistic skill or Turing’s programming expertise. In fact, when you consider the ultimate purpose of data visualization—helping users <span class="emphasis"><em>understand</em></span> data—simplicity is one of the most important features of an effective visualization. Simple, straightforward charts are often the easiest to understand.</p><p><a id="iddle1080" class="indexterm"/><a id="iddle1087" class="indexterm"/><a id="iddle1119" class="indexterm"/><a id="iddle1314" class="indexterm"/><a id="iddle1372" class="indexterm"/><a id="iddle1373" class="indexterm"/><a id="iddle1466" class="indexterm"/><a id="iddle1541" class="indexterm"/>After all, users have seen hundreds or thousands of bar charts, line charts, X/Y plots, and the like. They know the conventions that underlie these charts, so they can interpret a well-designed example effortlessly. If a simple, static chart presents the data best, use it. You’ll spend less effort creating your visualization, and your users will spend less effort trying to understand it.</p><p>There are many high-quality tools and libraries to help you get started with simple visualizations. With these tools, you can avoid reinventing the wheel, and you can be assured of a reasonably attractive presentation by sticking with the library defaults. We’ll look at several of these tools throughout the book, but for this chapter we’ll use the Flotr2 library (<span class="emphasis"><em><a class="ulink" href="http://www.humblesoftware.com/flotr2/" target="_top">http://www.humblesoftware.com/flotr2/</a></em></span>). Flotr2 makes it easy to add standard bar charts, line charts, and pie charts to any web page, and it also supports some less common chart types. We’ll take a look at all of these techniques in the examples that follow. Here’s what you’ll learn:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>How to create a basic bar chart</p></li><li class="listitem"><p>How to plot continuous data with a line chart</p></li><li class="listitem"><p>How to emphasize fractions with a pie chart</p></li><li class="listitem"><p>How to plot X/Y data with a scatter chart</p></li><li class="listitem"><p>How to show magnitudes of X/Y data with a bubble chart</p></li><li class="listitem"><p>How to display multidimensional data with a radar chart</p></li></ul></div><div class="sect1" title="Creating a Basic Bar Chart"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="creating_a_basic_bar_chart">Creating a Basic Bar Chart</h2></div></div></div><p>If you’re ever in doubt about what type of chart best explains your data, your first consideration should probably be the basic bar chart. We see bar charts so often that it’s easy to overlook how effective they can be. Bar charts can show the evolution of a value over time, or they can provide a straightforward comparison of multiple values. Let’s walk through the steps to build one.</p><div class="sect2" title="Step 1: Include the Required JavaScript"><div class="titlepage"><div><div><h3 class="title" id="step_1_include_the_required_javascript">Step 1: Include the Required JavaScript</h3></div></div></div><p>Since we’re using the Flotr2 library to create the chart, we need to include that library in our web pages. The Flotr2 package isn’t currently popular enough for public content distribution networks, so you’ll need to download a copy and host it on your own web server. We’ll use the minimized version (flotr2.min.js) since it provides the best performance.</p><p>Flotr2 doesn’t require any other JavaScript libraries (such as jQuery), but it does rely on the HTML canvas feature. Major modern browsers (Safari, Chrome, Firefox) support canvas, but until version 9, Internet Explorer (IE) did not. Unfortunately, there are still millions of users with IE8 (or even earlier). To support those users, we can include an additional library (excanvas.min.js) in our pages. That library is available from Google (<span class="emphasis"><em><a class="ulink" href="https://code.google.com/p/explorercanvas/" target="_top">https://code.google.com/p/explorercanvas/</a></em></span>). Start with the following skeleton for your HTML document:</p><a id="pro_id00001"/><pre class="programlisting">   <span class="dodgerblue">&lt;!DOCTYPE</span> html<span class="dodgerblue">&gt;</span>
   <span class="strong"><strong><span class="steelblue">&lt;html</span></strong></span> <span class="steelblue">lang=</span><span class="maroon">"en"</span><span class="strong"><strong><span class="steelblue">&gt;</span></strong></span>
     <span class="strong"><strong><span class="steelblue">&lt;head&gt;</span></strong></span>
       <span class="strong"><strong><span class="steelblue">&lt;meta</span></strong></span> <span class="steelblue">charset=</span><span class="maroon">"utf-8"</span><span class="strong"><strong><span class="steelblue">&gt;</span></strong></span>
       <span class="strong"><strong><span class="steelblue">&lt;title&gt;&lt;/title&gt;</span></strong></span>
     <span class="strong"><strong><span class="steelblue">&lt;/head&gt;</span></strong></span>
     <span class="strong"><strong><span class="steelblue">&lt;body&gt;</span></strong></span>
       <span class="indianred"><span class="emphasis"><em>&lt;!-- Page Content Here --&gt;</em></span></span>
➊     <span class="indianred"><span class="emphasis"><em>&lt;!--[if lt IE 9]&gt;&lt;script src="js/excanvas.min.js"&gt;&lt;/script&gt;&lt;![endif]--&gt;</em></span></span>
       <span class="strong"><strong><span class="steelblue">&lt;script</span></strong></span> <span class="steelblue">src=</span><span class="maroon">"js/flotr2.min.js"</span><span class="strong"><strong><span class="steelblue">&gt;&lt;/script&gt;</span></strong></span>
     <span class="strong"><strong><span class="steelblue">&lt;/body&gt;</span></strong></span>
   <span class="strong"><strong><span class="steelblue">&lt;/html&gt;</span></strong></span></pre><p><a id="iddle1082" class="indexterm"/><a id="iddle1083" class="indexterm"/><a id="iddle1315" class="indexterm"/><a id="iddle1374" class="indexterm"/>Since other browsers don’t need excanvas.min.js, we use some special markup at ➊ to make sure that only IE8 and earlier will load it. Also, notice that we’re including the JavaScript libraries at the end of the document. This approach lets the browser load the document’s entire HTML markup and begin laying out the page while it waits for the server to provide the JavaScript libraries.</p></div><div class="sect2" title="Step 2: Set Aside a &lt;div&gt; Element to Hold the Chart"><div class="titlepage"><div><div><h3 class="title" id="step_2_set_aside_a_less_thandivgreater_t">Step 2: Set Aside a &lt;div&gt; Element to Hold the Chart</h3></div></div></div><p>Within our document, we need to create a <code class="literal">&lt;div&gt;</code> element to contain the chart. This element must have an explicit height and width, or Flotr2 won’t be able to construct the chart. We can indicate the element’s size in a CSS style sheet, or we can place it directly on the element itself. Here’s how the document might look with the latter approach.</p><a id="pro_id00002"/><pre class="programlisting"><span class="dodgerblue">&lt;!DOCTYPE</span> html<span class="dodgerblue">&gt;</span>
<span class="strong"><strong><span class="steelblue">&lt;html</span></strong></span> <span class="steelblue">lang=</span><span class="maroon">"en"</span><span class="strong"><strong><span class="steelblue">&gt;</span></strong></span>
  <span class="strong"><strong><span class="steelblue">&lt;head&gt;</span></strong></span>
    <span class="strong"><strong><span class="steelblue">&lt;meta</span></strong></span> <span class="steelblue">charset=</span><span class="maroon">"utf-8"</span><span class="strong"><strong><span class="steelblue">&gt;</span></strong></span>
    <span class="strong"><strong><span class="steelblue">&lt;title&gt;&lt;/title&gt;</span></strong></span>
  <span class="strong"><strong><span class="steelblue">&lt;/head&gt;</span></strong></span>
  <span class="strong"><strong><span class="steelblue">&lt;body&gt;</span></strong></span>
    <span class="strong"><strong><span class="steelblue">&lt;div</span></strong></span> <span class="steelblue">id=</span><span class="maroon">"chart"</span> <span class="steelblue">style=</span><span class="maroon">"width:600px;height:300px;"</span><span class="strong"><strong><span class="steelblue">&gt;&lt;/div&gt;</span></strong></span>
    <span class="indianred"><span class="emphasis"><em>&lt;!--[if lt IE 9]&gt;&lt;script src="js/excanvas.min.js"&gt;&lt;/script&gt;&lt;![endif]--&gt;</em></span></span>
    <span class="strong"><strong><span class="steelblue">&lt;script</span></strong></span> <span class="steelblue">src=</span><span class="maroon">"js/flotr2.min.js"</span><span class="strong"><strong><span class="steelblue">&gt;&lt;/script&gt;</span></strong></span>
  <span class="strong"><strong><span class="steelblue">&lt;/body&gt;</span></strong></span>
<span class="strong"><strong><span class="steelblue">&lt;/html&gt;</span></strong></span></pre><p>Note that we’ve given the <code class="literal">&lt;div&gt;</code> an explicit <code class="literal">id</code> (<code class="literal">"chart"</code>) so we can reference it later. You’ll need to use a basic template like this (importing the Flotr2 library and setting up the <code class="literal">&lt;div&gt;</code>) for all the charts in this chapter.</p></div><div class="sect2" title="Step 3: Define the Data"><div class="titlepage"><div><div><h3 class="title" id="step_3_define_the_data">Step 3: Define the Data</h3></div></div></div><p>Now we can tackle the data that we want to display. For this example, I’ll use the number of Manchester City wins in the English Premier League for the past seven years. Of course you’ll want to substitute your actual data values, either with inline JavaScript (like the following example) or by another means (such as an AJAX call to the server).</p><a id="pro_id00003"/><pre class="programlisting"><span class="strong"><strong><span class="steelblue">&lt;script&gt;</span></strong></span>
<span class="strong"><strong><span class="steelblue">var</span></strong></span> wins = [[[<span class="red">2006</span>,<span class="red">13</span>],[<span class="red">2007</span>,<span class="red">11</span>],[<span class="red">2008</span>,<span class="red">15</span>],[<span class="red">2009</span>,<span class="red">15</span>],[<span class="red">2010</span>,<span class="red">18</span>],[<span class="red">2011</span>,<span class="red">21</span>],
             [<span class="red">2012</span>,<span class="red">28</span>]]];
&lt;<span class="steelblue">/script&gt;</span></pre><p><a id="iddle1084" class="indexterm"/><a id="iddle1376" class="indexterm"/><a id="iddle2161" class="indexterm"/>As you can see, we have three layers of arrays. Let’s start from the inside and work our way out. For Flotr2 charts, each data point is entered in a two-item array with an x-value and y-value. In our case we’re using the year as the x-value and the number of wins as the y-value. We collect all these values in another array called a <span class="emphasis"><em>series</em></span>. We place this series inside one more outer array. We could enter multiple series into this outer array, but for now we’re showing only one series. Here’s a quick summary of each layer:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Each data point consists of an x-value and a y-value packaged in an array.</p></li><li class="listitem"><p>Each series consists of a set of data points packaged in an array.</p></li><li class="listitem"><p>The data to chart consists of one or more series packaged in an array.</p></li></ul></div></div><div class="sect2" title="Step 4: Draw the Chart"><div class="titlepage"><div><div><h3 class="title" id="step_4_draw_the_chart">Step 4: Draw the Chart</h3></div></div></div><p>That’s all the setup we need. A simple call to the Flotr2 library, as shown here, creates our first attempt at a chart.</p><a id="pro_id00004"/><pre class="programlisting"><span class="steelblue">window</span>.<span class="olive">onload</span> = <span class="strong"><strong><span class="steelblue">function</span></strong></span> () {
    <span class="steelblue">Flotr</span>.<span class="olive">draw</span>(
        <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),
        wins,
        {
           <span class="dodgerblue">bars</span>: {
               <span class="dodgerblue">show</span>: <span class="strong"><strong><span class="steelblue">true</span></strong></span>
           }
        }
    );
};</pre><p>First we make sure the browser has loaded our document; otherwise, the <code class="literal">chart &lt;div&gt;</code> might not be present. That’s the point of <code class="literal">window.onload</code>. Once that event occurs, we call <code class="literal">Flotr.draw</code> with three parameters: the HTML element to contain the chart, the data for the chart, and any chart options (in this case, we specify options only to tell Flotr2 to create a bar chart from the data).</p><p>Since Flotr2 doesn’t require jQuery, we haven’t taken advantage of any of jQuery’s shortcuts in this example. If your page already includes jQuery, you can use the standard jQuery conventions for the Flotr2 charts in this chapter to execute the script after the window has loaded, and to find the <code class="literal">&lt;div&gt;</code> container for the chart.</p><p><a class="xref" href="ch01.html#flotr2_library_turns_data_into_a_basic_l" title="Figure 1-1. The Flotr2 library turns data into a basic (if unpolished) bar chart.">Figure 1-1</a> shows what you’ll see on the web page.</p><div class="figure"><a id="flotr2_library_turns_data_into_a_basic_l"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00001"/><img src="figs/web/01fig01.png.jpg" alt="The Flotr2 library turns data into a basic (if unpolished) bar chart."/></div></div><div class="figure-title">Figure 1-1. The Flotr2 library turns data into a basic (if unpolished) bar chart.</div></div><p><a id="iddle1089" class="indexterm"/><a id="iddle2122" class="indexterm"/>Now you have a bar chart, but it’s not showing the information very effectively. Let’s add some options incrementally until we get what we want.</p></div><div class="sect2" title="Step 5: Fix the Vertical Axis"><div class="titlepage"><div><div><h3 class="title" id="step_5_fix_the_vertical_axis">Step 5: Fix the Vertical Axis</h3></div></div></div><p>The most glaring problem with the vertical axis is its scale. By default, Flotr2 automatically calculates the range of the axis from the minimum and maximum values in the data. In our case the minimum value is 11 wins (from 2007), so Flotr2 dutifully uses that as its y-axis minimum. In bar charts, however, it’s almost always best to make 0 the y-axis minimum. If you don’t use 0, you risk overemphasizing the differences between values and confusing your users. Anyone who glances at the chart in <a class="xref" href="ch01.html#flotr2_library_turns_data_into_a_basic_l" title="Figure 1-1. The Flotr2 library turns data into a basic (if unpolished) bar chart.">Figure 1-1</a>, for example, might think that Manchester City did not win any matches in 2007. That certainly wouldn’t do the team any justice.</p><p>Another problem with the vertical axis is the formatting. Flotr2 defaults to a precision of one decimal place, so it adds the superfluous “.0” to all the labels. We can fix both of these problems by specifying some y-axis options.</p><a id="pro_id00005"/><pre class="programlisting"><span class="steelblue">Flotr</span>.<span class="olive">draw</span>(<span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>), [wins], {
    <span class="dodgerblue">bars</span>: {
        <span class="dodgerblue">show</span>: <span class="strong"><strong><span class="steelblue">true</span></strong></span>
    },
    <span class="dodgerblue">yaxis</span>: {
        <span class="dodgerblue">min</span>: <span class="red">0</span>,
        <span class="dodgerblue">tickDecimals</span>: <span class="red">0</span>
    }
});</pre><p><a id="iddle1086" class="indexterm"/><a id="iddle1457" class="indexterm"/><a id="iddle2009" class="indexterm"/><a id="iddle2176" class="indexterm"/>The <code class="literal">min</code> property sets the minimum value for the y-axis, and the <code class="literal">tickDecimals</code> property tells Flotr2 how many decimal places to show for the labels. In our case we don’t want any decimal places.</p><p>As you can see in <a class="xref" href="ch01.html#simple_options_help_flotr2_construct_a_b" title="Figure 1-2. Simple options help Flotr2 construct a better vertical axis.">Figure 1-2</a>, adding these options definitely improves the vertical axis since the values now start at zero and are formatted appropriately for integers.</p><div class="figure"><a id="simple_options_help_flotr2_construct_a_b"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00002"/><img src="figs/web/01fig02.png.jpg" alt="Simple options help Flotr2 construct a better vertical axis."/></div></div><div class="figure-title">Figure 1-2. Simple options help Flotr2 construct a better vertical axis.</div></div></div><div class="sect2" title="Step 6: Fix the Horizontal Axis"><div class="titlepage"><div><div><h3 class="title" id="step_6_fix_the_horizontal_axis">Step 6: Fix the Horizontal Axis</h3></div></div></div><p>The horizontal axis needs some work as well. Just as with the y-axis, Flotr2 assumes that the x-axis values are real numbers and shows one decimal place in the labels. Since we’re charting years, we could simply set the precision to 0, as we did for the y-axis. But that’s not a very general solution, since it won’t work when the x-values are non-numeric categories (like team names). For the more general case, let’s first change our data to use simple numbers rather than years for the x-values. Then we’ll create an array that maps those simple numbers to arbitrary strings, which we can use as labels.</p><a id="pro_id00006"/><pre class="programlisting"><span class="strong"><strong><span class="steelblue">var</span></strong></span> wins = [[[<span class="red">0</span>,<span class="red">13</span>],[<span class="red">1</span>,<span class="red">11</span>],[<span class="red">2</span>,<span class="red">15</span>],[<span class="red">3</span>,<span class="red">15</span>],[<span class="red">4</span>,<span class="red">18</span>],[<span class="red">5</span>,<span class="red">21</span>],[<span class="red">6</span>,<span class="red">28</span>]]];
<span class="strong"><strong><span class="steelblue">var</span></strong></span> years = [
    [<span class="red">0</span>, <span class="maroon">"2006"</span>],
    [<span class="red">1</span>, <span class="maroon">"2007"</span>],
    [<span class="red">2</span>, <span class="maroon">"2008"</span>],
    [<span class="red">3</span>, <span class="maroon">"2009"</span>],
    [<span class="red">4</span>, <span class="maroon">"2010"</span>],
    [<span class="red">5</span>, <span class="maroon">"2011"</span>],
    [<span class="red">6</span>, <span class="maroon">"2012"</span>]
];</pre><p><a id="iddle1090" class="indexterm"/><a id="iddle2014" class="indexterm"/>As you can see, instead of using the actual years for the x-values, we’re simply using 0, 1, 2, and so on. We then define a second array that maps those integer values to strings. Although here our strings are years (and thus numbers), they could be anything.</p><p>Another problem is a lack of spacing between the bars. By default, each bar takes up its full horizontal space, but that makes the chart look very cramped. We can adjust that with the <code class="literal">barWidth</code> property. Let’s set it to <code class="literal">0.5</code> so that each bar takes up only half the available space.</p><p>Here’s how we pass those options to Flotr2.</p><a id="pro_id00007"/><pre class="programlisting">   <span class="steelblue">Flotr</span>.<span class="olive">draw</span>(<span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>), wins, {
       <span class="dodgerblue">bars</span>: {
           <span class="dodgerblue">show</span>: <span class="strong"><strong><span class="steelblue">true</span></strong></span>,
           <span class="dodgerblue">barWidth</span>: <span class="red">0.5</span>
       },
       <span class="dodgerblue">yaxis</span>: {
           <span class="dodgerblue">min</span>: <span class="red">0</span>,
           <span class="dodgerblue">tickDecimals</span>: <span class="red">0</span>
       },
       <span class="dodgerblue">xaxis</span>: {
➊         <span class="dodgerblue">ticks</span>: years
       }
   });</pre><p>Note at ➊ that we use the <code class="literal">ticks</code> property of the x-axis to tell Flotr2 which labels match which x-values. Now we’re starting to get somewhere with our chart, as shown in <a class="xref" href="ch01.html#we_can_define_our_own_labels_for_the_hor" title="Figure 1-3. We can define our own labels for the horizontal axis.">Figure 1-3</a>. The x-axis labels are appropriate for years, and there is space between the bars to improve the chart’s legibility.</p><div class="figure"><a id="we_can_define_our_own_labels_for_the_hor"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00003"/><img src="figs/web/01fig03.png.jpg" alt="We can define our own labels for the horizontal axis."/></div></div><div class="figure-title">Figure 1-3. We can define our own labels for the horizontal axis.</div></div></div><div class="sect2" title="Step 7: Adjust the Styling"><div class="titlepage"><div><div><h3 class="title" id="step_7_adjust_the_styling">Step 7: Adjust the Styling</h3></div></div></div><p><a id="iddle1088" class="indexterm"/>Now that the chart is functional and readable, we can pay some attention to the aesthetics. Let’s add a title, get rid of the unnecessary grid lines, and adjust the coloring of the bars.</p><a id="pro_id00008"/><pre class="programlisting"><span class="steelblue">Flotr</span>.<span class="olive">draw</span>(<span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>), wins, {
    <span class="dodgerblue">title</span>: <span class="maroon">"Manchester City Wins"</span>,
    <span class="dodgerblue">colors</span>: [<span class="maroon">"#89AFD2"</span>],
    <span class="dodgerblue">bars</span>: {
        <span class="dodgerblue">show</span>: <span class="strong"><strong><span class="steelblue">true</span></strong></span>,
        <span class="dodgerblue">barWidth</span>: <span class="red">0.5</span>,
        <span class="dodgerblue">shadowSize</span>: <span class="red">0</span>,
        <span class="dodgerblue">fillOpacity</span>: <span class="red">1</span>,
        <span class="dodgerblue">lineWidth</span>: <span class="red">0</span>
    },
    <span class="dodgerblue">yaxis</span>: {
        <span class="dodgerblue">min</span>: <span class="red">0</span>,
        <span class="dodgerblue">tickDecimals</span>: <span class="red">0</span>
    },
    <span class="dodgerblue">xaxis</span>: {
        <span class="dodgerblue">ticks</span>: years
    },
    <span class="dodgerblue">grid</span>: {
        <span class="dodgerblue">horizontalLines</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>,
        <span class="dodgerblue">verticalLines</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>
    }
});</pre><p>As you can see in <a class="xref" href="ch01.html#additional_options_let_us_adjust_the_vis" title="Figure 1-4. Additional options let us adjust the visual styles of the chart.">Figure 1-4</a>, we now have a bar chart that Manchester City fans can be proud of.</p><div class="figure"><a id="additional_options_let_us_adjust_the_vis"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00004"/><img src="figs/web/01fig04.png.jpg" alt="Additional options let us adjust the visual styles of the chart."/></div></div><div class="figure-title">Figure 1-4. Additional options let us adjust the visual styles of the chart.</div></div><p><a id="iddle1081" class="indexterm"/><a id="iddle1155" class="indexterm"/><a id="iddle2162" class="indexterm"/>For any data set of moderate size, the standard bar chart is often the most effective visualization. Users are already familiar with its conventions, so they don’t have to put any extra effort into understanding the format. The bars themselves offer a clear visual contrast with the background, and they use a single linear dimension (height) to show differences between values, so users easily grasp the salient data.</p></div><div class="sect2" title="Step 8: Vary the Bar Color"><div class="titlepage"><div><div><h3 class="title" id="step_8_vary_the_bar_color">Step 8: Vary the Bar Color</h3></div></div></div><p>So far our chart has been monochromatic. That makes sense because we’re showing the same value (Manchester City wins) across time. But bar charts are also good for comparing different values. Suppose, for example, we wanted to show the total wins for multiple teams in one year. In that case, it makes sense to use a different color for each team’s bar. Let’s go over how we can do that.</p><p>First we need to restructure the data somewhat. Previously we’ve shown only a single series. Now we want a different series for each team. Creating multiple series lets Flotr2 color each independently. The following example shows how the new data series compares with the old. We’ve left the <code class="literal">wins</code> array in the code for comparison, but it’s the <code class="literal">wins2</code> array that we’re going to show now. Notice how the nesting of the arrays changes. Also, we’re going to label each bar with the team abbreviation instead of the year.</p><a id="pro_id00009"/><pre class="programlisting"><span class="strong"><strong><span class="steelblue">var</span></strong></span> wins = [[[<span class="red">0</span>,<span class="red">13</span>],[<span class="red">1</span>,<span class="red">11</span>],[<span class="red">2</span>,<span class="red">15</span>],[<span class="red">3</span>,<span class="red">15</span>],[<span class="red">4</span>,<span class="red">18</span>],[<span class="red">5</span>,<span class="red">21</span>],[<span class="red">6</span>,<span class="red">28</span>]]];
<span class="strong"><strong><span class="steelblue">var</span></strong></span> wins2 = [[[<span class="red">0</span>,<span class="red">28</span>]],[[<span class="red">1</span>,<span class="red">28</span>]],[[<span class="red">2</span>,<span class="red">21</span>]],[[<span class="red">3</span>,<span class="red">20</span>]],[[<span class="red">4</span>,<span class="red">19</span>]]];
<span class="strong"><strong><span class="steelblue">var</span></strong></span> teams = [
    [<span class="red">0</span>, <span class="maroon">"MCI"</span>],
    [<span class="red">1</span>, <span class="maroon">"MUN"</span>],
    [<span class="red">2</span>, <span class="maroon">"ARS"</span>],
    [<span class="red">3</span>, <span class="maroon">"TOT"</span>],
    [<span class="red">4</span>, <span class="maroon">"NEW"</span>]
];</pre><p>With those changes, our data is structured appropriately, and we can ask Flotr2 to draw the chart. When we do that, let’s use different colors for each team. Everything else is the same as before.</p><a id="pro_id00010"/><pre class="programlisting"><span class="steelblue">Flotr</span>.<span class="olive">draw</span>(<span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>), wins2, {
    <span class="dodgerblue">title</span>: <span class="maroon">"Premier League Wins (2011-2012)"</span>,
    <span class="dodgerblue">colors</span>: [<span class="maroon">"#89AFD2"</span>, <span class="maroon">"#1D1D1D"</span>, <span class="maroon">"#DF021D"</span>, <span class="maroon">"#0E204B"</span>, <span class="maroon">"#E67840"</span>],
    <span class="dodgerblue">bars</span>: {
        <span class="dodgerblue">show</span>: <span class="strong"><strong><span class="steelblue">true</span></strong></span>,
        <span class="dodgerblue">barWidth</span>: <span class="red">0.5</span>,
        <span class="dodgerblue">shadowSize</span>: <span class="red">0</span>,
        <span class="dodgerblue">fillOpacity</span>: <span class="red">1</span>,
        <span class="dodgerblue">lineWidth</span>: <span class="red">0</span>
    },
    <span class="dodgerblue">yaxis</span>: {
        <span class="dodgerblue">min</span>: <span class="red">0</span>,
        <span class="dodgerblue">tickDecimals</span>: <span class="red">0</span>
    },
    <span class="dodgerblue">xaxis</span>: {
        <span class="dodgerblue">ticks</span>: teams
    },
    <span class="dodgerblue">grid</span>: {
        <span class="dodgerblue">horizontalLines</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>,
        <span class="dodgerblue">verticalLines</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>
    }
});</pre><p><a id="iddle1085" class="indexterm"/><a id="iddle1294" class="indexterm"/><a id="iddle1375" class="indexterm"/><a id="iddle1462" class="indexterm"/>As you can see in <a class="xref" href="ch01.html#bar_charts_can_compare_different_quantit" title="Figure 1-5. Bar charts can compare different quantities at one point in time as well as the same quantity at different points in time.">Figure 1-5</a>, with a few minor adjustments we’ve completely changed the focus of our bar chart. Instead of showing a single team at different points in time, we’re now comparing different teams at the same point in time. That’s the versatility of a simple bar chart.</p><div class="figure"><a id="bar_charts_can_compare_different_quantit"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00005"/><img src="figs/web/01fig05.png.jpg" alt="Bar charts can compare different quantities at one point in time as well as the same quantity at different points in time."/></div></div><div class="figure-title">Figure 1-5. Bar charts can compare different quantities at one point in time as well as the same quantity at different points in time.</div></div><p>We’ve used a lot of different code fragments to put together these examples. If you want to see a complete example in a single file, check out this book’s source code at <span class="emphasis"><em><a class="ulink" href="http://jsDataV.is/source/" target="_top">http://jsDataV.is/source/</a></em></span>.</p></div><div class="sect2" title="Step 9: Work Around Flotr2 “Bugs”"><div class="titlepage"><div><div><h3 class="title" id="step_9_work_around_flotr2_quotation_mark">Step 9: Work Around Flotr2 “Bugs”</h3></div></div></div><p>If you’re building large web pages with a lot of content, you may run into a Flotr2 “bug” that can be quite annoying. I’ve put “bug” in quotation marks because the Flotr2 behavior is deliberate, but I believe it’s not correct. In the process of constructing its charts, Flotr2 creates dummy HTML elements so it can calculate their sizes. Flotr2 doesn’t intend these dummy elements to be visible on the page, so it “hides” them by positioning them off the screen. Unfortunately, what Flotr2 thinks is off the screen isn’t always. Specifically, line 2,281 of flotr2.js is:</p><a id="pro_id00011"/><pre class="programlisting"><span class="steelblue">D</span>.<span class="olive">setStyles</span>(div, { <span class="maroon">"position"</span> : <span class="maroon">"absolute"</span>, <span class="maroon">"top"</span> : <span class="maroon">"-10000px"</span> });</pre><p><a id="iddle1166" class="indexterm"/><a id="iddle1377" class="indexterm"/><a id="iddle1601" class="indexterm"/><a id="iddle1602" class="indexterm"/><a id="iddle1609" class="indexterm"/><a id="iddle2006" class="indexterm"/>Flotr2 intends to place these dummy elements 10,000 pixels above the top of the browser window. However, CSS absolute positioning can be relative to the containing element, which is not always the browser window. So if your document is more than 10,000 pixels high, you may find Flotr2 scattering text in random-looking locations throughout the page. There are a couple of ways to work around this bug, at least until the Flotr2 code is revised.</p><p>One option is to modify the code yourself. Flotr2 is open source, so you can freely download the full source code and modify it appropriately. One simple modification would position the dummy elements far to the right or left rather than above. Instead of <code class="literal">"top"</code> you could change the code to <code class="literal">"right"</code>. If you’re not comfortable making changes to the library’s source code, another option is to find and hide those dummy elements yourself. You should do this <span class="emphasis"><em>after</em></span> you’ve called <code class="literal">Flotr.draw()</code> for the last time. The latest version of jQuery can banish these extraneous elements with the following statement:</p><a id="pro_id00012"/><pre class="programlisting"><span class="olive">$</span>(<span class="maroon">".flotr-dummy-div"</span>).<span class="olive">parent</span>().<span class="olive">hide</span>();</pre></div></div><div class="sect1" title="Plotting Continuous Data with a Line Chart"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="plotting_continuous_data_with_a_line_cha">Plotting Continuous Data with a Line Chart</h2></div></div></div><p>Bar charts work great for visualizing a modest amount of data, but for more significant amounts of data, a line chart can present the information much more effectively. Line charts are especially good at revealing overall trends in data without bogging the user down in individual data points.</p><p>For our example, we’ll look at two measures that may be related: carbon dioxide (CO<sub>2</sub>) concentration in the atmosphere and global temperatures. We want to show how both measures have changed over time, and we’d like to see how strongly related the values are. A line chart is a perfect visualization tool for looking at these trends.</p><p>Just like for the bar chart, you’ll need to include the Flotr2 library in your web page and create a <code class="literal">&lt;div&gt;</code> element to contain the chart. Let’s start prepping the data.</p><div class="sect2" title="Step 1: Define the Data"><div class="titlepage"><div><div><h3 class="title" id="step_1_define_the_data">Step 1: Define the Data</h3></div></div></div><p>We’ll begin with CO<sub>2</sub> concentration measurements. The US National Oceanographic and Atmospheric Administration (NOAA) publishes measurements (<span class="emphasis"><em><a class="ulink" href="http://www.esrl.noaa.gov/gmd/ccgg/trends/co2_data_mlo.html" target="_top">http://www.esrl.noaa.gov/gmd/ccgg/trends/co2_data_mlo.html</a></em></span>) taken at Mauna Loa, Hawaii, from 1959 to the present day. The first few values are shown in the following excerpt.</p><a id="pro_id00013"/><pre class="programlisting"><span class="strong"><strong><span class="steelblue">var</span></strong></span> co2 = [
    [ <span class="red">1959</span>, <span class="red">315.97</span> ],
    [ <span class="red">1960</span>, <span class="red">316.91</span> ],
    [ <span class="red">1961</span>, <span class="red">317.64</span> ],
    [ <span class="red">1962</span>, <span class="red">318.45</span> ],
    <span class="indianred"><span class="emphasis"><em>// Data set continues...</em></span></span></pre><p><a id="iddle1285" class="indexterm"/><a id="iddle1366" class="indexterm"/><a id="iddle1605" class="indexterm"/>NOAA also publishes measurements of mean global surface temperature (<span class="emphasis"><em><a class="ulink" href="http://www.ncdc.noaa.gov/cmb-faq/anomalies.php" target="_top">http://www.ncdc.noaa.gov/cmb-faq/anomalies.php</a></em></span>). These values measure the difference from the baseline, which is currently taken to be the average temperature over the entire 20th century. Since the CO<sub>2</sub> measurements begin in 1959, we’ll use that as our starting point for temperature as well.</p><a id="pro_id00014"/><pre class="programlisting"><span class="strong"><strong><span class="steelblue">var</span></strong></span> temp = [
    [ <span class="red">1959</span>, <span class="red">0.0776</span> ],
    [ <span class="red">1960</span>, <span class="red">0.0280</span> ],
    [ <span class="red">1961</span>, <span class="red">0.1028</span> ],
    [ <span class="red">1962</span>, <span class="red">0.1289</span> ],
    <span class="indianred"><span class="emphasis"><em>// Data set continues...</em></span></span></pre></div><div class="sect2" title="Step 2: Graph the CO2 Data"><div class="titlepage"><div><div><h3 class="title" id="step_2_graph_the_co2_data">Step 2: Graph the CO<sub>2</sub> Data</h3></div></div></div><p>Graphing one data set is quite easy with Flotr2. We simply call the <code class="literal">draw()</code> method of the <code class="literal">Flotr</code> object. The only parameters the method requires are a reference to the HTML element in which to place the graph, and the data itself. The <code class="literal">lines</code> property of the data object indicates that we want a line chart.</p><a id="pro_id00015"/><pre class="programlisting"><span class="steelblue">Flotr</span>.<span class="olive">draw</span>(
    <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),
    [{ <span class="dodgerblue">data</span>: co2, <span class="dodgerblue">lines</span>: {<span class="dodgerblue">show</span>:<span class="strong"><strong><span class="steelblue">true</span></strong></span>} }]
);</pre><p>Since Flotr2 does not require jQuery, we’re not using any jQuery convenience functions in our example. If you do have jQuery on your pages, you can simplify the preceding code a little. In either case, <a class="xref" href="ch01.html#first_chart_shows_one_data_set" title="Figure 1-6. The first chart shows one data set.">Figure 1-6</a> shows the result.</p><div class="figure"><a id="first_chart_shows_one_data_set"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00006"/><img src="figs/web/01fig06.png.jpg" alt="The first chart shows one data set."/></div></div><div class="figure-title">Figure 1-6. The first chart shows one data set.</div></div><p><a id="iddle1604" class="indexterm"/><a id="iddle1608" class="indexterm"/><a id="iddle1693" class="indexterm"/><a id="iddle1796" class="indexterm"/>The chart clearly shows the trend in CO<sub>2</sub> concentration for the past 50-plus years.</p></div><div class="sect2" title="Step 3: Add the Temperature Data"><div class="titlepage"><div><div><h3 class="title" id="step_3_add_the_temperature_data">Step 3: Add the Temperature Data</h3></div></div></div><p>With a simple addition to our code, we can include temperature measurements in our chart.</p><a id="pro_id00016"/><pre class="programlisting"><span class="steelblue">Flotr</span>.<span class="olive">draw</span>(
    <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),
    [
        { <span class="dodgerblue">data</span>: co2, <span class="dodgerblue">lines</span>: {<span class="dodgerblue">show</span>:<span class="strong"><strong><span class="steelblue">true</span></strong></span>} },
        { <span class="dodgerblue">data</span>: temp, <span class="dodgerblue">lines</span>: {<span class="dodgerblue">show</span>:<span class="strong"><strong><span class="steelblue">true</span></strong></span>}, <span class="dodgerblue">yaxis</span>: <span class="red">2</span> }
    ]
);</pre><p>Note that we include the <code class="literal">yaxis</code> option for the temperature data and give it a value of <code class="literal">2</code>. That tells Flotr2 to use a different y-scale for the temperature data.</p><p>The chart in <a class="xref" href="ch01.html#single_chart_can_show_multiple_data_sets" title="Figure 1-7. A single chart can show multiple data sets.">Figure 1-7</a> now shows both measurements for the years in question, but it’s gotten a little cramped and confusing. The values butt up against the edges of the chart, and the grid lines are hard for users to interpret when there are multiple vertical axes.</p><div class="figure"><a id="single_chart_can_show_multiple_data_sets"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00007"/><img src="figs/web/01fig07.png.jpg" alt="A single chart can show multiple data sets."/></div></div><div class="figure-title">Figure 1-7. A single chart can show multiple data sets.</div></div></div><div class="sect2" title="Step 4: Improve the Chart’s Readability"><div class="titlepage"><div><div><h3 class="title" id="step_4_improve_the_chartapostrophes_read">Step 4: Improve the Chart’s Readability</h3></div></div></div><p>By using more Flotr2 options, we can make several improvements in our line chart’s readability. First we can eliminate the grid lines, since they aren’t relevant for the temperature measurements.</p><p><a id="iddle1293" class="indexterm"/><a id="iddle1429" class="indexterm"/><a id="iddle1459" class="indexterm"/><a id="iddle1603" class="indexterm"/><a id="iddle2121" class="indexterm"/><a id="iddle2123" class="indexterm"/><a id="iddle2180" class="indexterm"/>We can also extend the range of both vertical axes to provide a bit of breathing room for the chart. Both of these changes are additional options to the <code class="literal">draw()</code> method.</p><a id="pro_id00017"/><pre class="programlisting">   <span class="steelblue">Flotr</span>.<span class="olive">draw</span>(
       <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),
       [
           { <span class="dodgerblue">data</span>: co2, <span class="dodgerblue">lines</span>: {<span class="dodgerblue">show</span>:<span class="strong"><strong><span class="steelblue">true</span></strong></span>} },
           { <span class="dodgerblue">data</span>: temp, <span class="dodgerblue">lines</span>: {<span class="dodgerblue">show</span>:<span class="strong"><strong><span class="steelblue">true</span></strong></span>}, <span class="dodgerblue">yaxis</span>: <span class="red">2</span> }
       ],{
➊         <span class="dodgerblue">grid</span>: {<span class="dodgerblue">horizontalLines</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>, <span class="dodgerblue">verticalLines</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>},
➋         <span class="dodgerblue">yaxis</span>: {<span class="dodgerblue">min</span>: <span class="red">300</span>, <span class="dodgerblue">max</span>: <span class="red">400</span>},
➌         <span class="dodgerblue">y2axis</span>: {<span class="dodgerblue">min</span>: -<span class="red">0.15</span>, <span class="dodgerblue">max</span>: <span class="red">0.69</span>}
       }
   );</pre><p>The <code class="literal">grid</code> options at ➊ turn off the grid lines by setting both the <code class="literal">horizontalLines</code> and <code class="literal">verticalLines</code> properties to <code class="literal">false</code>. The <code class="literal">yaxis</code> options at ➋ specify the minimum and maximum value for the first vertical axis (CO<sub>2</sub> concentration), while the <code class="literal">y2axis</code> options at ➌ specify those values for the second vertical axis (temperature difference).</p><p>The resulting graph in <a class="xref" href="ch01.html#removing_grid_lines_and_expanding_the_ax" title="Figure 1-8. Removing grid lines and expanding the axes makes the chart easier to read.">Figure 1-8</a> is cleaner and easier to read.</p><div class="figure"><a id="removing_grid_lines_and_expanding_the_ax"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00008"/><img src="figs/web/01fig08.png.jpg" alt="Removing grid lines and expanding the axes makes the chart easier to read."/></div></div><div class="figure-title">Figure 1-8. Removing grid lines and expanding the axes makes the chart easier to read.</div></div></div><div class="sect2" title="Step 5: Clarify the Temperature Measurements"><div class="titlepage"><div><div><h3 class="title" id="step_5_clarify_the_temperature_measureme">Step 5: Clarify the Temperature Measurements</h3></div></div></div><p>The temperature measurements might still be confusing to users, since they’re not really temperatures; they’re actually deviations from the 20th-century average. Let’s convey that distinction by adding a line for that 20th-century average and explicitly labeling it. The simplest way to do that is to create a “dummy” data set and add that to the chart. The extra data set has nothing but zeros.</p><a id="pro_id00018"/><pre class="programlisting"><span class="strong"><strong><span class="steelblue">var</span></strong></span> zero = [];
<span class="strong"><strong><span class="steelblue">for</span></strong></span> (<span class="strong"><strong><span class="steelblue">var</span></strong></span> yr=<span class="red">1959</span>; yr&lt;<span class="red">2012</span>; yr++) { <span class="steelblue">zero</span>.<span class="olive">push</span>([yr, <span class="red">0</span>]); };</pre><p>When we add that data set to the chart, we need to indicate that it corresponds to the second y-axis. And since we want this line to appear as part of the chart framework rather than as another data set, let’s deemphasize it somewhat by setting its width to one pixel, coloring it dark gray, and disabling shadows.</p><a id="pro_id00019"/><pre class="programlisting"><span class="steelblue">Flotr</span>.<span class="olive">draw</span>(
    <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),
    [
        { <span class="dodgerblue">data</span>: zero, <span class="dodgerblue">lines</span>: {<span class="dodgerblue">show</span>:<span class="strong"><strong><span class="steelblue">true</span></strong></span>, <span class="dodgerblue">lineWidth</span>: <span class="red">1</span>}, <span class="dodgerblue">yaxis</span>: <span class="red">2</span>,
          <span class="dodgerblue">shadowSize</span>: <span class="red">0</span>, <span class="dodgerblue">color</span>: <span class="maroon">"#545454"</span> },
        { <span class="dodgerblue">data</span>: co2, <span class="dodgerblue">lines</span>: {<span class="dodgerblue">show</span>:<span class="strong"><strong><span class="steelblue">true</span></strong></span>} },
        { <span class="dodgerblue">data</span>: temp, <span class="dodgerblue">lines</span>: {<span class="dodgerblue">show</span>:<span class="strong"><strong><span class="steelblue">true</span></strong></span>}, <span class="dodgerblue">yaxis</span>: <span class="red">2</span> }
    ],{
        <span class="dodgerblue">grid</span>: {<span class="dodgerblue">horizontalLines</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>, <span class="dodgerblue">verticalLines</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>},
        <span class="dodgerblue">yaxis</span>: {<span class="dodgerblue">min</span>: <span class="red">300</span>, <span class="dodgerblue">max</span>: <span class="red">400</span>},
        <span class="dodgerblue">y2axis</span>: {<span class="dodgerblue">min</span>: -<span class="red">0.15</span>, <span class="dodgerblue">max</span>: <span class="red">0.69</span>}
    }
);</pre><p>As you can see, we’ve placed the zero line first among the data sets. With that order, Flotr2 will draw the actual data on top of the zero line, as shown in <a class="xref" href="ch01.html#dummy_data_set_can_emphasize_a_position" title="Figure 1-9. A dummy data set can emphasize a position on a chart axis.">Figure 1-9</a>, reinforcing its role as chart framework instead of data.</p><div class="figure"><a id="dummy_data_set_can_emphasize_a_position"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00009"/><img src="figs/web/01fig09.png.jpg" alt="A dummy data set can emphasize a position on a chart axis."/></div></div><div class="figure-title">Figure 1-9. A dummy data set can emphasize a position on a chart axis.</div></div></div><div class="sect2" title="Step 6: Label the Chart"><div class="titlepage"><div><div><h3 class="title" id="step_6_label_the_chart">Step 6: Label the Chart</h3></div></div></div><p><a id="iddle1560" class="indexterm"/><a id="iddle1606" class="indexterm"/><a id="iddle2011" class="indexterm"/><a id="iddle2046" class="indexterm"/>For the last step in this example, we’ll add appropriate labels to the chart. That includes an overall title, as well as labels for individual data sets. And to make it clear which axis refers to temperature, we’ll add a “°C” suffix to the temperature scale. We identify the label for each data series in the <code class="literal">label</code> option for that series. The overall chart title merits its own option, and we add the “°C” suffix using a <code class="literal">tickFormatter()</code> function.</p><a id="pro_id00020"/><pre class="programlisting">   <span class="steelblue">Flotr</span>.<span class="olive">draw</span>(
       <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),
       [ {
           <span class="dodgerblue">data</span>: zero,
           <span class="dodgerblue">label</span>: <span class="maroon">"20&lt;sup&gt;th&lt;/sup&gt;-Century Baseline Temperature"</span>,
           <span class="dodgerblue">lines</span>: {<span class="dodgerblue">show</span>:<span class="strong"><strong><span class="steelblue">true</span></strong></span>, <span class="dodgerblue">lineWidth</span>: <span class="red">1</span>},
           <span class="dodgerblue">shadowSize</span>: <span class="red">0</span>,
           <span class="dodgerblue">color</span>: <span class="maroon">"#545454"</span>
         },
         {
           <span class="dodgerblue">data</span>: temp,
           <span class="dodgerblue">label</span>: <span class="maroon">"Yearly Temperature Difference (°C)"</span>,
           <span class="dodgerblue">lines</span>: {<span class="dodgerblue">show</span>:<span class="strong"><strong><span class="steelblue">true</span></strong></span>}
         },
         {
           <span class="dodgerblue">data</span>: co2,
           <span class="dodgerblue">yaxis</span>: <span class="red">2</span>,
           <span class="dodgerblue">label</span>: <span class="maroon">"CO&lt;sub&gt;2&lt;/sub&gt; Concentration (ppm)"</span>,
           <span class="dodgerblue">lines</span>: {<span class="dodgerblue">show</span>:<span class="strong"><strong><span class="steelblue">true</span></strong></span>}
         }
       ],
       {
           <span class="dodgerblue">title</span>: <span class="maroon">"Global Temperature and CO&lt;sub&gt;2&lt;/sub&gt; Concentration (NOAA Data)"</span>,
           <span class="dodgerblue">grid</span>: {<span class="dodgerblue">horizontalLines</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>, <span class="dodgerblue">verticalLines</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>},
           <span class="dodgerblue">y2axis</span>: {<span class="dodgerblue">min</span>: -<span class="red">0.15</span>, <span class="dodgerblue">max</span>: <span class="red">0.69</span>,
➊                  <span class="dodgerblue">tickFormatter</span>: <span class="strong"><strong><span class="steelblue">function</span></strong></span>(val) {<span class="strong"><strong><span class="steelblue">return</span></strong></span> val+<span class="maroon">" °C"</span>;}}
           <span class="dodgerblue">yaxis</span>: {<span class="dodgerblue">min</span>: <span class="red">300</span>, <span class="dodgerblue">max</span>: <span class="red">400</span>},
       }
   );</pre><p>For each value on the axis, the formatter function is called with the value, and Flotr2 expects it to return a string to use for the label. As you can see at ➊, we simply append the <code class="literal">" °C"</code> string to the value.</p><p>Notice that we’ve also swapped the position of the CO<sub>2</sub> and temperature graphs. We’re now passing the temperature data series ahead of the CO<sub>2</sub> series. We did that so that the two temperature quantities (baseline and difference) appear next to each other in the legend, making their connection a little clearer to the user. <a id="iddle1607" class="indexterm"/><a id="iddle1751" class="indexterm"/><a id="iddle1755" class="indexterm"/><a id="iddle2082" class="indexterm"/>And because the temperature now appears first in the legend, we’ve also swapped the axes, so the temperature axis is on the left. Finally, we’ve adjusted the title of the chart for the same reason. <a class="xref" href="ch01.html#labeling_the_axes_and_adding_a_legend_co" title="Figure 1-10. Labeling the axes and adding a legend completes the chart.">Figure 1-10</a> shows the result.</p><div class="figure"><a id="labeling_the_axes_and_adding_a_legend_co"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00010"/><img src="figs/web/01fig10.png.jpg" alt="Labeling the axes and adding a legend completes the chart."/></div></div><div class="figure-title">Figure 1-10. Labeling the axes and adding a legend completes the chart.</div></div><p>A line chart like <a class="xref" href="ch01.html#labeling_the_axes_and_adding_a_legend_co" title="Figure 1-10. Labeling the axes and adding a legend completes the chart.">Figure 1-10</a> excels in visualizing this kind of data. Each data set contains over 50 points, making it impractical to present each individual point. And in fact, individual data points are not the focus of the visualization. Rather, we want to show <span class="emphasis"><em>trends</em></span>—the trends of each data set as well as that data set’s correlation to the others. Connecting the points with lines leads the user right to those trends and to the heart of our visualization.</p></div><div class="sect2" title="Step 7: Work Around Flotr2 “Bugs”"><div class="titlepage"><div><div><h3 class="title" id="step_7_work_around_flotr2_quotation_mark">Step 7: Work Around Flotr2 “Bugs”</h3></div></div></div><p>Be sure to refer to Step 9 of <a class="xref" href="ch01.html#creating_a_basic_bar_chart" title="Creating a Basic Bar Chart">Creating a Basic Bar Chart</a> in <a class="xref" href="ch01.html#step_9_work_around_flotr2_quotation_mark" title="Step 9: Work Around Flotr2 “Bugs”">Step 9: Work Around Flotr2 “Bugs”</a> to see how to work around some “bugs” in the Flotr2 library.</p></div></div><div class="sect1" title="Emphasizing Fractions Using a Pie Chart"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="emphasizing_fractions_using_a_pie_chart">Emphasizing Fractions Using a Pie Chart</h2></div></div></div><p>Pie charts don’t get a lot of love in the visualization community, and for a pretty good reason: they’re rarely the most effective way to communicate data. We will walk through the steps to create pie charts in this section, but first let’s take some time to understand the problems they introduce. <a class="xref" href="ch01.html#pie_charts_can_make_it_hard_to_compare_v" title="Figure 1-11. Pie charts can make it hard to compare values.">Figure 1-11</a>, for example, shows a simple pie chart. Can you tell from the chart which color is the largest? The smallest?</p><div class="figure"><a id="pie_charts_can_make_it_hard_to_compare_v"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00011"/><img src="figs/web/01fig11.png.jpg" alt="Pie charts can make it hard to compare values."/></div></div><div class="figure-title">Figure 1-11. Pie charts can make it hard to compare values.</div></div><p><a id="iddle1757" class="indexterm"/>It’s very hard to tell. That’s because humans are not particularly good at judging the relative size of areas, especially if those areas aren’t rectangles. If we really wanted to compare these five values, a bar chart works much better. <a class="xref" href="ch01.html#bar_charts_usually_make_comparisons_easi" title="Figure 1-12. Bar charts usually make comparisons easier.">Figure 1-12</a> shows the same values in a bar chart.</p><div class="figure"><a id="bar_charts_usually_make_comparisons_easi"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00012"/><img src="figs/web/01fig12.png.jpg" alt="Bar charts usually make comparisons easier."/></div></div><div class="figure-title">Figure 1-12. Bar charts usually make comparisons easier.</div></div><p>Now, of course, it’s easy to rank each color. With a bar chart we only have to compare one dimension—height. This yields a simple rule of thumb: if you’re comparing different values against one another, consider a bar chart first. It will almost always provide the best visualization.</p><p>One case, however, where pie charts can be quite effective is when we want to compare a single partial value against a whole. Say, for example, we want to visualize the percentage of the world’s population that lives in poverty. In that case, a pie chart may work quite well. Here’s how we can construct such a chart using Flotr2.</p><p>Just as in Step 1 of <a class="xref" href="ch01.html#creating_a_basic_bar_chart" title="Creating a Basic Bar Chart">Creating a Basic Bar Chart</a>, we need to include the Flotr2 library in our web page and set aside a <code class="literal">&lt;div&gt;</code> element to contain the chart we’ll construct.</p><div class="sect2" title="Step 1: Define the Data"><div class="titlepage"><div><div><h3 class="title" id="step_1_define_the_data-id00001">Step 1: Define the Data</h3></div></div></div><p><a id="iddle1286" class="indexterm"/><a id="iddle1367" class="indexterm"/><a id="iddle1430" class="indexterm"/><a id="iddle1460" class="indexterm"/><a id="iddle1752" class="indexterm"/><a id="iddle1753" class="indexterm"/><a id="iddle1892" class="indexterm"/><a id="iddle2124" class="indexterm"/>The data here is quite straightforward. According to the World Bank (<span class="emphasis"><em><a class="ulink" href="http://www.newgeography.com/content/003325-alleviating-world-poverty-a-progress-report" target="_top">http://www.newgeography.com/content/003325-alleviating-world-poverty-a-progress-report</a></em></span>), at the end of 2008, 22.4 percent of the world’s population lived on less than $1.25/day. That’s the fraction that we want to emphasize with our chart.</p><a id="pro_id00021"/><pre class="programlisting"><span class="strong"><strong><span class="steelblue">var</span></strong></span> data = [[[<span class="red">0</span>,<span class="red">22.4</span>]],[[<span class="red">1</span>,<span class="red">77.6</span>]]];</pre><p>Here we have an array with two data series: one for the percentage of the population in poverty (22.4) and a second series for the rest (77.6). Each series itself consists of an array of points. In this example, and for pie charts in general, there is only one point in each series, with an x-value and a y-value (which are each stored together in yet another, inner array). For pie charts, the x-values are irrelevant, so we simply include the placeholder values <code class="literal">0</code> and <code class="literal">1</code>.</p></div><div class="sect2" title="Step 2: Draw the Chart"><div class="titlepage"><div><div><h3 class="title" id="step_2_draw_the_chart">Step 2: Draw the Chart</h3></div></div></div><p>To draw the chart, we call the <code class="literal">draw()</code> method of the <code class="literal">Flotr</code> object. That method takes three parameters: the element in our HTML document in which to place the chart, the data for our chart, and any options. We’ll start with the minimum set of options required for a pie chart.</p><a id="pro_id00022"/><pre class="programlisting">   <span class="steelblue">window</span>.<span class="olive">onload</span> = <span class="strong"><strong><span class="steelblue">function</span></strong></span> () {
       <span class="steelblue">Flotr</span>.<span class="olive">draw</span>(<span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>), data, {
           <span class="dodgerblue">pie</span>: {
               <span class="dodgerblue">show</span>: <span class="strong"><strong><span class="steelblue">true</span></strong></span>
           },
           <span class="dodgerblue">yaxis</span>: {
➊             <span class="dodgerblue">showLabels</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>
           },
           <span class="dodgerblue">xaxis</span>: {
➋             <span class="dodgerblue">showLabels</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>
           },
           <span class="dodgerblue">grid</span>: {
➌             <span class="dodgerblue">horizontalLines</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>,
➍             <span class="dodgerblue">verticalLines</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>
           }
       });
   }</pre><p>As you can see, Flotr2 requires a few more options for a minimum pie chart than it does for other common chart types. For both the x- and y-axes we need to disable labels, which we do by setting the <code class="literal">showLabels</code> property to <code class="literal">false</code> at ➊ and ➋. We also have to turn off the grid lines, as a grid doesn’t make a lot of sense for a pie chart. We accomplish that by setting the <code class="literal">verticalLines</code> and <code class="literal">horizontalLines</code> properties of the <code class="literal">grid</code> option to <code class="literal">false</code> at ➌ and ➍.</p><p>Since Flotr2 doesn’t require jQuery, we’re not using any of the jQuery convenience functions in this example. If you do have jQuery for your pages, you can simplify this code a bit.</p><p><a id="iddle1241" class="indexterm"/><a id="iddle1287" class="indexterm"/><a id="iddle1368" class="indexterm"/><a id="iddle1557" class="indexterm"/><a id="iddle1564" class="indexterm"/><a id="iddle1754" class="indexterm"/><a id="iddle1756" class="indexterm"/><a id="iddle2047" class="indexterm"/><a class="xref" href="ch01.html#without_effective_labelingcomma_pie_char" title="Figure 1-13. Without effective labeling, pie charts can be difficult to interpret.">Figure 1-13</a> is a start, but it’s hard to tell exactly what the graph intends to show.</p><div class="figure"><a id="without_effective_labelingcomma_pie_char"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00013"/><img src="figs/web/01fig13.png.jpg" alt="Without effective labeling, pie charts can be difficult to interpret."/></div></div><div class="figure-title">Figure 1-13. Without effective labeling, pie charts can be difficult to interpret.</div></div></div><div class="sect2" title="Step 3: Label the Values"><div class="titlepage"><div><div><h3 class="title" id="step_3_label_the_values">Step 3: Label the Values</h3></div></div></div><p>The next step is to add some text labels and a legend to indicate what the chart is displaying. To label each quantity separately, we have to change the structure of our data. Instead of using an array of series, we’ll create an object to store each series. Each object’s <code class="literal">data</code> property will contain the corresponding series, and we’ll add a <code class="literal">label</code> property for the text labels.</p><a id="pro_id00023"/><pre class="programlisting"><span class="strong"><strong><span class="steelblue">var</span></strong></span> data = [
    {<span class="dodgerblue">data</span>: [[<span class="red">0</span>,<span class="red">22.4</span>]], <span class="dodgerblue">label</span>: <span class="maroon">"Extreme Poverty"</span>},
    {<span class="dodgerblue">data</span>: [[<span class="red">1</span>,<span class="red">77.6</span>]]}
];</pre><p>With our data structured this way, Flotr2 will automatically identify labels associated with each series. Now when we call the <code class="literal">draw()</code> method, we just need to add a <code class="literal">title</code> option. Flotr2 will add the title above the graph and create a simple legend identifying the pie portions with our labels. To make the chart a little more engaging, we’ll pose a question in our title. That’s why we’re labeling only one of the areas in the chart: the labeled area answers the question in the title.</p><a id="pro_id00024"/><pre class="programlisting"><span class="steelblue">Flotr</span>.<span class="olive">draw</span>(<span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),data, {
    <span class="dodgerblue">title</span>: <span class="maroon">"How Much of the World Lives on $1.25/Day?"</span>,
    <span class="dodgerblue">pie</span>: {
        <span class="dodgerblue">show</span>: <span class="strong"><strong><span class="steelblue">true</span></strong></span>
    },
    <span class="dodgerblue">yaxis</span>: {
        <span class="dodgerblue">showLabels</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>
    },
    <span class="dodgerblue">xaxis</span>: {
        <span class="dodgerblue">showLabels</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>
    },
    <span class="dodgerblue">grid</span>: {
        <span class="dodgerblue">horizontalLines</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>,
        <span class="dodgerblue">verticalLines</span>: <span class="strong"><strong><span class="steelblue">false</span></strong></span>
    }
});</pre><p><a id="iddle1853" class="indexterm"/><a id="iddle1863" class="indexterm"/>The chart in <a class="xref" href="ch01.html#labels_and_titles_can_help_make_a_chart" title="Figure 1-14. Labels and titles can help make a chart engaging.">Figure 1-14</a> reveals the data quite clearly.</p><div class="figure"><a id="labels_and_titles_can_help_make_a_chart"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00014"/><img src="figs/web/01fig14.png.jpg" alt="Labels and titles can help make a chart engaging."/></div></div><div class="figure-title">Figure 1-14. Labels and titles can help make a chart engaging.</div></div><p>Although pie charts have a bad reputation in the data visualization community, there are some applications for which they are quite effective. They’re not very good at letting users compare multiple values, but as shown in this example, they do provide a nice and easily understandable picture showing the proportion of a single value within a whole.</p></div><div class="sect2" title="Step 4: Work Around Flotr2 “Bugs”"><div class="titlepage"><div><div><h3 class="title" id="step_4_work_around_flotr2_quotation_mark">Step 4: Work Around Flotr2 “Bugs”</h3></div></div></div><p>Be sure to refer to Step 9 of <a class="xref" href="ch01.html#creating_a_basic_bar_chart" title="Creating a Basic Bar Chart">Creating a Basic Bar Chart</a> in <a class="xref" href="ch01.html#step_9_work_around_flotr2_quotation_mark" title="Step 9: Work Around Flotr2 “Bugs”">Step 9: Work Around Flotr2 “Bugs”</a> to see how to work around some “bugs” in the Flotr2 library.</p></div></div><div class="sect1" title="Plotting X/Y Data with a Scatter Chart"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="plotting_xsolidusy_data_with_a_scatter_c">Plotting X/Y Data with a Scatter Chart</h2></div></div></div><p>A bar chart is often most effective for visualizing data that consists primarily of a single quantity (such as the number of wins in the bar charts we created earlier). But if we want to explore the relationship between two different quantities, a scatter chart can be more effective. Suppose, for example, we wish to visualize the relationship between a country’s health-care spending (one quantity) and its life expectancy (the second quantity). Let’s step through an example to see how to create a scatter chart for that data.</p><p><a id="iddle1289" class="indexterm"/><a id="iddle1369" class="indexterm"/><a id="iddle1621" class="indexterm"/><a id="iddle1857" class="indexterm"/><a id="iddle1858" class="indexterm"/><a id="iddle1860" class="indexterm"/>Just as in Step 1 of <a class="xref" href="ch01.html#creating_a_basic_bar_chart" title="Creating a Basic Bar Chart">Creating a Basic Bar Chart</a>, we need to include the Flotr2 library in our web page and set aside a <code class="literal">&lt;div&gt;</code> element to contain the chart we’ll construct.</p><div class="sect2" title="Step 1: Define the Data"><div class="titlepage"><div><div><h3 class="title" id="step_1_define_the_data-id00002">Step 1: Define the Data</h3></div></div></div><p>For this example, we’ll use the 2012 report from the Organisation for Economic Co-operation and Development (OECD; <span class="emphasis"><em><a class="ulink" href="http://www.oecd-ilibrary.org/social-issues-migration-health/data/oecd-health-statistics_health-data-en" target="_top">http://www.oecd-ilibrary.org/social-issues-migration-health/data/oecd-health-statistics_health-data-en</a></em></span>). This report includes figures for health-care spending as a percent of gross domestic product, and average life expectancy at birth. (Although the report was released in late 2012, it contains data for 2010.) Here you can see a short excerpt of that data stored in a JavaScript array:</p><a id="pro_id00025"/><pre class="programlisting"><span class="strong"><strong><span class="steelblue">var</span></strong></span> health_data = [
    { <span class="dodgerblue">country</span>: <span class="maroon">"Australia"</span>,      <span class="dodgerblue">spending</span>:  <span class="red">9.1</span>, <span class="dodgerblue">life</span>: <span class="red">81.8</span> },
    { <span class="dodgerblue">country</span>: <span class="maroon">"Austria"</span>,        <span class="dodgerblue">spending</span>: <span class="red">11.0</span>, <span class="dodgerblue">life</span>: <span class="red">80.7</span> },
    { <span class="dodgerblue">country</span>: <span class="maroon">"Belgium"</span>,        <span class="dodgerblue">spending</span>: <span class="red">10.5</span>, <span class="dodgerblue">life</span>: <span class="red">80.3</span> },
    <span class="indianred"><span class="emphasis"><em>// Data set continues...</em></span></span></pre></div><div class="sect2" title="Step 2: Format the Data"><div class="titlepage"><div><div><h3 class="title" id="step_2_format_the_data">Step 2: Format the Data</h3></div></div></div><p>As is often the case, we’ll need to restructure the original data a bit so that it matches the format Flotr2 requires. The JavaScript code for that is shown next. We start with an empty <code class="literal">data</code> array and step through the source data. For each element in the source <code class="literal">health_data</code>, we extract the data point for our chart and push that data point into the <code class="literal">data</code> array.</p><a id="pro_id00026"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>var</strong></span></span> data = [];
<span class="steelblue"><span class="strong"><strong>for</strong></span></span> (<span class="steelblue"><span class="strong"><strong>var</strong></span></span> i = <span class="red">0</span>; i &lt; <span class="steelblue">health_data</span>.<span class="olive">length</span>; i++) {
    <span class="steelblue">data</span>.<span class="olive">push</span>([
        health_data[i].<span class="olive">spending</span>,
        health_data[i].<span class="olive">life</span>
    ]);
};</pre><p>Since Flotr2 doesn’t require jQuery, we’re not using any of the jQuery convenience functions in this example. But if you’re using jQuery for other reasons in your page, you could, for example, use the <code class="literal">.map()</code> function to simplify the code for this restructuring. (In Step 7 of <a class="xref" href="ch02.html#selecting_chart_content" title="Selecting Chart Content">Selecting Chart Content</a> in <a class="xref" href="ch02.html#step_7_determine_chart_data_based_on_the" title="Step 7: Determine Chart Data Based on the Interaction State">Step 7: Determine Chart Data Based on the Interaction State</a>, there’s a detailed example of the jQuery <code class="literal">.map()</code> function.)</p></div><div class="sect2" title="Step 3: Plot the Data"><div class="titlepage"><div><div><h3 class="title" id="step_3_plot_the_data">Step 3: Plot the Data</h3></div></div></div><p>Now all we need to do is call the <code class="literal">draw()</code> method of the <code class="literal">Flotr</code> object to create our chart. For a first attempt, we’ll stick with the default options.</p><a id="pro_id00027"/><pre class="programlisting"><span class="steelblue">Flotr</span>.<span class="olive">draw</span>(
    <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),
    [{ <span class="dodgerblue">data</span>: data, <span class="dodgerblue">points</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>} }]
);</pre><p><a id="iddle1060" class="indexterm"/><a id="iddle1854" class="indexterm"/>As you can see, Flotr2 expects at least two parameters. The first is the element in our HTML document in which we want the chart placed, and the second is the data for the chart. The data takes the form of an array. In general, Flotr2 can draw multiple series on the same chart, so that array might have multiple objects. In our case, however, we’re charting only one series, so the array has a single object. That object identifies the data itself, and it tells Flotr2 not to show points instead of lines.</p><p><a class="xref" href="ch01.html#default_scatter_chart_options_donapostro" title="Figure 1-15. The default scatter chart options don’t provide any margins.">Figure 1-15</a> shows our result. Notice how the points are pressed right up against the edges of the chart.</p><div class="figure"><a id="default_scatter_chart_options_donapostro"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00015"/><img src="figs/web/01fig15.png.jpg" alt="The default scatter chart options don’t provide any margins."/></div></div><div class="figure-title">Figure 1-15. The default scatter chart options don’t provide any margins.</div></div></div><div class="sect2" title="Step 4: Adjust the Chart’s Axes"><div class="titlepage"><div><div><h3 class="title" id="step_4_adjust_the_chartapostrophes_axes">Step 4: Adjust the Chart’s Axes</h3></div></div></div><p>The first attempt isn’t too bad, but Flotr2 automatically calculates the ranges for each axis, and its default algorithm usually results in a chart that’s too cramped. Flotr2 does have an <code class="literal">autoscale</code> option; if you set it, the library attempts to find sensible ranges for the associated axes automatically. Unfortunately, in my experience the ranges Flotr2 suggests rarely improve the default option significantly, so in most cases we’re better off explicitly setting them. Here’s how we do that for our chart:</p><a id="pro_id00028"/><pre class="programlisting"><span class="steelblue">Flotr</span>.<span class="olive">draw</span>(
    <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),
    [{
        <span class="dodgerblue">data</span>: data,
        <span class="dodgerblue">points</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>}
    }],
    {
        <span class="dodgerblue">xaxis</span>: {<span class="dodgerblue">min</span>: <span class="red">5</span>, <span class="dodgerblue">max</span>: <span class="red">20</span>},
        <span class="dodgerblue">yaxis</span>: {<span class="dodgerblue">min</span>: <span class="red">70</span>, <span class="dodgerblue">max</span>: <span class="red">85</span>}
    }
);</pre><p><a id="iddle1565" class="indexterm"/><a id="iddle1859" class="indexterm"/>We’ve added a third parameter to the <code class="literal">draw()</code> method that contains our options, which in this case are properties for the x- and y-axes. In each case, we’re explicitly setting a minimum and maximum value. By specifying ranges that give the data a little breathing room, we’ve made the chart in <a class="xref" href="ch01.html#specifying_our_own_axes_makes_the_chart" title="Figure 1-16. Specifying our own axes makes the chart easier to read.">Figure 1-16</a> much easier to read.</p><div class="figure"><a id="specifying_our_own_axes_makes_the_chart"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00016"/><img src="figs/web/01fig16.png.jpg" alt="Specifying our own axes makes the chart easier to read."/></div></div><div class="figure-title">Figure 1-16. Specifying our own axes makes the chart easier to read.</div></div></div><div class="sect2" title="Step 5: Label the Data"><div class="titlepage"><div><div><h3 class="title" id="step_5_label_the_data">Step 5: Label the Data</h3></div></div></div><p>Our chart so far looks reasonably nice, but it doesn’t tell users what they’re seeing. We need to add some labels to identify the data. A few more options can clarify the chart:</p><a id="pro_id00029"/><pre class="programlisting"><span class="steelblue">Flotr</span>.<span class="olive">draw</span>(
    <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),
    [{
        <span class="dodgerblue">data</span>: data, <span class="dodgerblue">points</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>}
    }],
    {
        <span class="dodgerblue">title</span>: <span class="maroon">"Life Expectancy vs. Health-Care Spending"</span>,
        <span class="dodgerblue">subtitle</span>: <span class="maroon">"(by country, 2010 OECD data)"</span>,
        <span class="dodgerblue">xaxis</span>: {<span class="dodgerblue">min</span>: <span class="red">5</span>, <span class="dodgerblue">max</span>: <span class="red">20</span>, ➊<span class="dodgerblue">tickDecimals</span>: <span class="red">0</span>,
                <span class="dodgerblue">title</span>: <span class="maroon">"Spending as Percentage of GDP"</span>},
        <span class="dodgerblue">yaxis</span>: {<span class="dodgerblue">min</span>: <span class="red">70</span>, <span class="dodgerblue">max</span>: <span class="red">85</span>, ➋<span class="dodgerblue">tickDecimals</span>: <span class="red">0</span>, <span class="dodgerblue">title</span>: <span class="maroon">"Years"</span>}
    }
);</pre><p><a id="iddle1252" class="indexterm"/><a id="iddle1458" class="indexterm"/><a id="iddle1856" class="indexterm"/><a id="iddle1861" class="indexterm"/><a id="iddle1862" class="indexterm"/><a id="iddle1974" class="indexterm"/><a id="iddle2010" class="indexterm"/><a id="iddle2049" class="indexterm"/>The <code class="literal">title</code> and <code class="literal">subtitle</code> options give the chart its overall title and subtitle, while the <code class="literal">title</code> properties within the <code class="literal">xaxis</code> and <code class="literal">yaxis</code> options name the labels for those axes. In addition to adding labels, we’ve told Flotr2 to drop the unnecessary decimal point from the x- and y-axis values by changing the <code class="literal">tickDecimals</code> property at ➊ and ➋. The chart in <a class="xref" href="ch01.html#labels_and_titles_clarify_the_chartapost" title="Figure 1-17. Labels and titles clarify the chart’s content.">Figure 1-17</a> looks much better.</p><div class="figure"><a id="labels_and_titles_clarify_the_chartapost"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00017"/><img src="figs/web/01fig17.png.jpg" alt="Labels and titles clarify the chart’s content."/></div></div><div class="figure-title">Figure 1-17. Labels and titles clarify the chart’s content.</div></div></div><div class="sect2" title="Step 6: Clarify the X-Axis"><div class="titlepage"><div><div><h3 class="title" id="step_6_clarify_the_x-axis">Step 6: Clarify the X-Axis</h3></div></div></div><p>Although our chart has definitely improved since our first attempt, there is still one nagging problem with the data presentation. The x-axis represents a percentage, but the labels for that axis show whole numbers. That discrepancy might cause our users some initial confusion, so let’s get rid of it. Flotr2 allows us to format the axis labels however we want. In this example, we simply wish to add a percentage symbol to the value. That’s easy enough:</p><a id="pro_id00030"/><pre class="programlisting">   <span class="steelblue">Flotr</span>.<span class="olive">draw</span>(
       <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),
       [{
           <span class="dodgerblue">data</span>: data, <span class="dodgerblue">points</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>}
       }],
       {
           <span class="dodgerblue">title</span>: <span class="maroon">"Life Expectancy vs. Health-Care Spending"</span>,
           <span class="dodgerblue">subtitle</span>: <span class="maroon">"(by country, 2010 OECD data)"</span>,
           <span class="dodgerblue">xaxis</span>: {<span class="dodgerblue">min</span>: <span class="red">5</span>, <span class="dodgerblue">max</span>: <span class="red">20</span>, <span class="dodgerblue">tickDecimals</span>: <span class="red">0</span>,
                  <span class="dodgerblue">title</span>: <span class="maroon">"Spending as Percentage of GDP"</span>,
➊                <span class="dodgerblue">tickFormatter</span>: <span class="steelblue"><span class="strong"><strong>function</strong></span></span>(val) {<span class="steelblue"><span class="strong"><strong>return</strong></span></span> val+<span class="maroon">"%"</span>}},
           <span class="dodgerblue">yaxis</span>: {<span class="dodgerblue">min</span>: <span class="red">70</span>, <span class="dodgerblue">max</span>: <span class="red">85</span>, <span class="dodgerblue">tickDecimals</span>: <span class="red">0</span>, <span class="dodgerblue">title</span>: <span class="maroon">"Years"</span>}
       }
   );</pre><p><a id="iddle1855" class="indexterm"/><a id="iddle2012" class="indexterm"/>The trick is the <code class="literal">tickFormatter</code> property of the <code class="literal">xaxis</code> options at ➊ in the preceding code. That property specifies a function. When <code class="literal">tickFormatter</code> is present, Flotr2 doesn’t draw the labels automatically. Instead, at each point where it would draw a label, it calls our function. The parameter passed to the function is the numeric value for the label. Flotr2 expects the function to return a string that it will use as the label. In our case we’re simply adding a percent sign after the value.</p><p>In <a class="xref" href="ch01.html#formatting_the_axis_labels_clarifies_the" title="Figure 1-18. Formatting the axis labels clarifies the content.">Figure 1-18</a>, with the addition of the percentage values labeling the horizontal axis, we have a chart that presents the data clearly.</p><div class="figure"><a id="formatting_the_axis_labels_clarifies_the"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00018"/><img src="figs/web/01fig18.png.jpg" alt="Formatting the axis labels clarifies the content."/></div></div><div class="figure-title">Figure 1-18. Formatting the axis labels clarifies the content.</div></div><p>The scatter chart excels at revealing relationships between two different variables. In this example, we can see how life expectancy relates to health-care spending. In aggregate, more spending yields longer life.</p></div><div class="sect2" title="Step 7: Answer Users’ Questions"><div class="titlepage"><div><div><h3 class="title" id="step_7_answer_usersapostrophe_questions">Step 7: Answer Users’ Questions</h3></div></div></div><p>Now that our chart successfully presents the data, we can start to look more carefully at the visualization from our users’ perspective. We especially want to anticipate any questions that users might have and try to answer them directly on the chart. There are at least three questions that emerge in the chart as it now stands:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>What countries are shown?</p></li><li class="listitem"><p>Are there any regional differences?</p></li><li class="listitem"><p>What’s that data point way over on the right?</p></li></ol></div><p><a id="iddle1691" class="indexterm"/><a id="iddle2054" class="indexterm"/>One way to answer those questions would be to add mouseovers (or tool tips) to each data point. But we’re not going to use that approach in this example for a couple of reasons. First (and most obviously), interactive visualizations are the subject of <a class="xref" href="ch02.html" title="Chapter 2. Making Charts Interactive">Chapter 2</a>; this chapter considers only static charts and graphs. Secondly, mouseovers and tool tips are ineffective for users accessing our site on a touch device, such as a smartphone or tablet. If we required users to have a mouse to fully understand our visualization, we might be neglecting a significant (and rapidly growing) number of them.</p><p>Our approach to this problem will be to divide our data into multiple series so that we can color and label each independently. Here’s the first step in breaking the data into regions:</p><a id="pro_id00031"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>var</strong></span></span> pacific_data = [
    {  <span class="dodgerblue">country</span>: <span class="maroon">"Australia"</span>,      <span class="dodgerblue">spending</span>:  <span class="red">9.1</span>, <span class="dodgerblue">life</span>: <span class="red">81.8</span> },
    {  <span class="dodgerblue">country</span>: <span class="maroon">"New Zealand"</span>,    <span class="dodgerblue">spending</span>: <span class="red">10.1</span>, <span class="dodgerblue">life</span>: <span class="red">81.0</span> },
];
<span class="steelblue"><span class="strong"><strong>var</strong></span></span> europe_data = [
    {  <span class="dodgerblue">country</span>: <span class="maroon">"Austria"</span>,        <span class="dodgerblue">spending</span>: <span class="red">11.0</span>, <span class="dodgerblue">life</span>: <span class="red">80.7</span> },
    {  <span class="dodgerblue">country</span>: <span class="maroon">"Belgium"</span>,        <span class="dodgerblue">spending</span>: <span class="red">10.5</span>, <span class="dodgerblue">life</span>: <span class="red">80.3</span> },
    {  <span class="dodgerblue">country</span>: <span class="maroon">"Czech Republic"</span>, <span class="dodgerblue">spending</span>:  <span class="red">7.5</span>, <span class="dodgerblue">life</span>: <span class="red">77.7</span> },

<span class="indianred"><span class="emphasis"><em>// Data set continues...</em></span></span>

<span class="steelblue"><span class="strong"><strong>var</strong></span></span> us_data = [
    {  <span class="dodgerblue">country</span>: <span class="maroon">"United States"</span>,  <span class="dodgerblue">spending</span>: <span class="red">17.6</span>, <span class="dodgerblue">life</span>: <span class="red">78.7</span> }
];</pre><p>Here, we’re giving the United States its own series, separate from the Americas series. That’s because the United States is the outlier data point on the far right of the chart. Our users probably want to know the specific country for that point, not just its region. For the other countries, a region alone is probably enough identification. As before, we need to restructure these arrays into Flotr2’s format. The code is the same as in Step 4; we’re just repeating it for each data set.</p><a id="pro_id00032"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>var</strong></span></span> pacific=[], europe=[], americas=[], mideast=[], asia=[], us=[];
<span class="steelblue"><span class="strong"><strong>for</strong></span></span> (i = <span class="red">0</span>; i &lt; <span class="steelblue">pacific_data</span>.<span class="olive">length</span>; i++) {
    <span class="steelblue">pacific</span>.<span class="olive">push</span>([ pacific_data[i].<span class="olive">spending</span>, pacific_data[i].<span class="olive">life</span> ]);
}
<span class="steelblue"><span class="strong"><strong>for</strong></span></span> (i = <span class="red">0</span>; i &lt; <span class="steelblue">europe_data</span>.<span class="olive">length</span>; i++) {
    <span class="steelblue">europe</span>.<span class="olive">push</span>([ europe_data[i].<span class="olive">spending</span>, europe_data[i].<span class="olive">life</span> ]);
}
<span class="indianred"><span class="emphasis"><em>// Code continues...</em></span></span></pre><p>Once we’ve separated the countries, we can pass their data to Flotr2 as distinct series. Here we see why Flotr2 expects arrays as its data parameter. Each series is a separate object in the array.</p><a id="pro_id00033"/><pre class="programlisting"><span class="steelblue">Flotr</span>.<span class="olive">draw</span>(
    <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),
    [
        { <span class="dodgerblue">data</span>: pacific,  <span class="dodgerblue">points</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>} },
        { <span class="dodgerblue">data</span>: europe,   <span class="dodgerblue">points</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>} },
        { <span class="dodgerblue">data</span>: americas, <span class="dodgerblue">points</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>} },
        { <span class="dodgerblue">data</span>: mideast,  <span class="dodgerblue">points</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>} },
        { <span class="dodgerblue">data</span>: asia,     <span class="dodgerblue">points</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>} },
        { <span class="dodgerblue">data</span>: us,       <span class="dodgerblue">points</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>} }
    ],{
        <span class="dodgerblue">title</span>: <span class="maroon">"Life Expectancy vs. Health-Care Spending"</span>,
        <span class="dodgerblue">subtitle</span>: <span class="maroon">"(by country, 2010 OECD data)"</span>,
        <span class="dodgerblue">xaxis</span>: {<span class="dodgerblue">min</span>: <span class="red">5</span>, <span class="dodgerblue">max</span>: <span class="red">20</span>, <span class="dodgerblue">tickDecimals</span>: <span class="red">0</span>,
                <span class="dodgerblue">title</span>: <span class="maroon">"Spending as Percentage of GDP"</span>,
                <span class="dodgerblue">tickFormatter</span>: <span class="steelblue"><span class="strong"><strong>function</strong></span></span>(val) {<span class="steelblue"><span class="strong"><strong>return</strong></span></span> val+<span class="maroon">"%"</span>}},
        <span class="dodgerblue">yaxis</span>: {<span class="dodgerblue">min</span>: <span class="red">70</span>, <span class="dodgerblue">max</span>: <span class="red">85</span>, <span class="dodgerblue">tickDecimals</span>: <span class="red">0</span>, <span class="dodgerblue">title</span>: <span class="maroon">"Years"</span>}
    }
);</pre><p>With the countries in different data series based on regions, Flotr2 now colors the regions distinctly, as shown in <a class="xref" href="ch01.html#splitting_the_data_into_multiple_data_se" title="Figure 1-19. Splitting the data into multiple data sets lets us assign different colors to each.">Figure 1-19</a>.</p><div class="figure"><a id="splitting_the_data_into_multiple_data_se"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00019"/><img src="figs/web/01fig19.png.jpg" alt="Splitting the data into multiple data sets lets us assign different colors to each."/></div></div><div class="figure-title">Figure 1-19. Splitting the data into multiple data sets lets us assign different colors to each.</div></div><p>For the final enhancement, we add a legend to the chart identifying the regions.</p><a id="pro_id00034"/><pre class="programlisting">   <span class="steelblue">Flotr</span>.<span class="olive">draw</span>(
       <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),
       [
           { <span class="dodgerblue">data</span>: pacific,  <span class="dodgerblue">label</span>: <span class="maroon">"Pacific"</span>, <span class="dodgerblue">points</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>} },
           { <span class="dodgerblue">data</span>: europe,   <span class="dodgerblue">label</span>: <span class="maroon">"Europe"</span>, <span class="dodgerblue">points</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>} },
           { <span class="dodgerblue">data</span>: americas, <span class="dodgerblue">label</span>: <span class="maroon">"Americas"</span>, <span class="dodgerblue">points</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>} },
           { <span class="dodgerblue">data</span>: mideast,  <span class="dodgerblue">label</span>: <span class="maroon">"Middle East"</span>, <span class="dodgerblue">points</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>} },
           { <span class="dodgerblue">data</span>: asia,     <span class="dodgerblue">label</span>: <span class="maroon">"Asia"</span>, <span class="dodgerblue">points</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>} },
           { <span class="dodgerblue">data</span>: us,       <span class="dodgerblue">label</span>: <span class="maroon">"United States"</span>, <span class="dodgerblue">points</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>} }
       ],{
           <span class="dodgerblue">title</span>: <span class="maroon">"Life Expectancy vs. Health-Care Spending (2010 OECD data)"</span>,
➊         <span class="dodgerblue">xaxis</span>: {<span class="dodgerblue">min</span>: <span class="red">5</span>, <span class="dodgerblue">max</span>: <span class="red">25</span>, <span class="dodgerblue">tickDecimals</span>: <span class="red">0</span>,
                  <span class="dodgerblue">title</span>: <span class="maroon">"Spending as Percentage of GDP"</span>,
                  <span class="dodgerblue">tickFormatter</span>: <span class="steelblue"><span class="strong"><strong>function</strong></span></span>(val) {<span class="steelblue"><span class="strong"><strong>return</strong></span></span> val+<span class="maroon">"%"</span>}},
           <span class="dodgerblue">yaxis</span>: {<span class="dodgerblue">min</span>: <span class="red">70</span>, <span class="dodgerblue">max</span>: <span class="red">85</span>, <span class="dodgerblue">tickDecimals</span>: <span class="red">0</span>, <span class="dodgerblue">title</span>: <span class="maroon">"Years"</span>},
➋         <span class="dodgerblue">legend</span>: {<span class="dodgerblue">position</span>: <span class="maroon">"ne"</span>}
       }
   );</pre><p>In order to make room for the legend, we increase the range of the x-axis at ➊ and position the legend in the northeast quadrant at ➋.</p><p>This addition gives us the final chart shown in <a class="xref" href="ch01.html#adding_a_legend_completes_the_chart" title="Figure 1-20. Adding a legend completes the chart.">Figure 1-20</a>.</p><div class="figure"><a id="adding_a_legend_completes_the_chart"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00020"/><img src="figs/web/01fig20.png.jpg" alt="Adding a legend completes the chart."/></div></div><div class="figure-title">Figure 1-20. Adding a legend completes the chart.</div></div></div><div class="sect2" title="Step 8: Work Around Flotr2 “Bugs”"><div class="titlepage"><div><div><h3 class="title" id="step_8_work_around_flotr2_quotation_mark">Step 8: Work Around Flotr2 “Bugs”</h3></div></div></div><p>Be sure to refer to Step 9 of <a class="xref" href="ch01.html#creating_a_basic_bar_chart" title="Creating a Basic Bar Chart">Creating a Basic Bar Chart</a> in <a class="xref" href="ch01.html#step_9_work_around_flotr2_quotation_mark" title="Step 9: Work Around Flotr2 “Bugs”">Step 9: Work Around Flotr2 “Bugs”</a> to see how to work around some “bugs” in the Flotr2 library.</p></div></div><div class="sect1" title="Adding Magnitudes to X/Y Data with a Bubble Chart"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="adding_magnitudes_to_xsolidusy_data_with">Adding Magnitudes to X/Y Data with a Bubble Chart</h2></div></div></div><p><a id="iddle1099" class="indexterm"/><a id="iddle1102" class="indexterm"/><a id="iddle1105" class="indexterm"/>Traditional scatter charts, like those described in the previous example, show the relationship between two values: the x-axis and the y-axis. Sometimes, however, two values are not adequate for the data we want to visualize. If we need to visualize three variables, we could use a scatter plot framework for two of the variables and then vary the size of the points according to the third variable. The resulting chart is a bubble chart.</p><p>Using bubble charts effectively requires some caution, though. As we saw earlier with pie charts, humans are not very good at accurately judging the relative areas of nonrectangular shapes, so bubble charts don’t lend themselves to precise comparisons of the bubble size. But if your third variable conveys only the general sense of a quantity rather than an accurate measurement, a bubble chart may be appropriate.</p><p>For this example we’ll use a bubble chart to visualize the path of Hurricane Katrina in 2005. Our x- and y-values will represent position (latitude and longitude), and we’ll ensure our users can interpret those values very accurately. For the third value—the bubble area—we’ll use the storm’s sustained wind speed. Since wind speed is only a general value anyway (as the wind gusts and subsides), a general impression is sufficient.</p><p>Just as in Step 1 of <a class="xref" href="ch01.html#creating_a_basic_bar_chart" title="Creating a Basic Bar Chart">Creating a Basic Bar Chart</a>, we need to include the Flotr2 library in our web page and set aside a <code class="literal">&lt;div&gt;</code> element to contain the chart we’ll construct.</p><div class="sect2" title="Step 1: Define the Data"><div class="titlepage"><div><div><h3 class="title" id="step_1_define_the_data-id00003">Step 1: Define the Data</h3></div></div></div><p>We’ll start our example with data taken from Hurricane Katrina observations by United States National Oceanic and Atmospheric Administration (NOAA). The data includes the latitude and longitude of the observation and the sustained wind speed in miles per hour.</p><a id="pro_id00035"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>var</strong></span></span> katrina = [
    { <span class="dodgerblue">north</span>: <span class="red">23.2</span>, <span class="dodgerblue">west</span>: <span class="red">75.5</span>, <span class="dodgerblue">wind</span>: <span class="red">35</span> },
    { <span class="dodgerblue">north</span>: <span class="red">24.0</span>, <span class="dodgerblue">west</span>: <span class="red">76.4</span>, <span class="dodgerblue">wind</span>: <span class="red">35</span> },
    { <span class="dodgerblue">north</span>: <span class="red">25.2</span>, <span class="dodgerblue">west</span>: <span class="red">77.0</span>, <span class="dodgerblue">wind</span>: <span class="red">45</span> },
    <span class="indianred"><span class="emphasis"><em>// Data set continues...</em></span></span></pre><p>For the bubble chart, Flotr2 needs each data point to be an array rather than an object, so let’s build a simple function to convert the source data into that format. To make the function more general, we can use an optional parameter to specify a filter function. And while we’re extracting data points, we can reverse the sign of the longitude so that west to east displays left to right.</p><a id="pro_id00036"/><pre class="programlisting">   <span class="steelblue"><span class="strong"><strong>function</strong></span></span> <span class="olive">get_points</span>(source_array, filter_function) {
➊     <span class="steelblue"><span class="strong"><strong>var</strong></span></span> result = [];
       <span class="steelblue"><span class="strong"><strong>for</strong></span></span> (<span class="steelblue"><span class="strong"><strong>var</strong></span></span> i=<span class="red">0</span>; i&lt;<span class="steelblue">source_array</span>.<span class="olive">length</span>; i++) {
           <span class="steelblue"><span class="strong"><strong>if</strong></span></span> ( (<span class="steelblue"><span class="strong"><strong>typeof</strong></span></span> filter_function === <span class="maroon">"undefined"</span>)
             || (<span class="steelblue"><span class="strong"><strong>typeof</strong></span></span> filter_function !== <span class="maroon">"function"</span>)
             || <span class="olive">filter_function</span>(source_array[i]) ) {
               <span class="steelblue">result</span>.<span class="olive">push</span>([
                   source_array[i].<span class="olive">west</span> * -<span class="red">1</span>,
                   source_array[i].<span class="olive">north</span>,
                   source_array[i].<span class="olive">wind</span>
               ]);
           }
       }
       <span class="steelblue"><span class="strong"><strong>return</strong></span></span> result;
   }</pre><p><a id="iddle1077" class="indexterm"/><a id="iddle1100" class="indexterm"/><a id="iddle1173" class="indexterm"/><a id="iddle1344" class="indexterm"/><a id="iddle1663" class="indexterm"/><a id="iddle1674" class="indexterm"/><a id="iddle1723" class="indexterm"/><a id="iddle1967" class="indexterm"/>The code for our function starts by setting the return value (<code class="literal">result</code>) to an empty array at ➊. Then it iterates through the input <code class="literal">source_array</code> one element at a time. If the <code class="literal">filter_function</code> parameter is available, and if it is a valid function, our code calls that function with the source array element as a parameter. If the function returns <code class="literal">true</code>, or if no function was passed in the parameter, then our code extracts the data point from the source element and pushes it onto the result array.</p><p>As you can see, the <code class="literal">filter_function</code> parameter is optional. If the caller omits it (or if it is not a valid function), then every point in the source ends up in the result. We won’t use the filter function right away, but it will come in handy for the later steps in this example.</p></div><div class="sect2" title="Step 2: Create a Background for the Chart"><div class="titlepage"><div><div><h3 class="title" id="step_2_create_a_background_for_the_chart">Step 2: Create a Background for the Chart</h3></div></div></div><p>Because the x- and y-values of our chart will represent position, a map makes the perfect chart background. To avoid any copyright concerns, we’ll use map images from Stamen Design (<span class="emphasis"><em><a class="ulink" href="http://stamen.com/" target="_top">http://stamen.com/</a></em></span>) that use data from OpenStreetMap (<span class="emphasis"><em><a class="ulink" href="http://openstreetmap.org/" target="_top">http://openstreetmap.org/</a></em></span>). Both are available under Creative Commons licenses, CC BY 3.0 (<span class="emphasis"><em><a class="ulink" href="http://creativecommons.org/licenses/by/3.0" target="_top">http://creativecommons.org/licenses/by/3.0</a></em></span>) and CC BY SA (<span class="emphasis"><em><a class="ulink" href="http://creativecommons.org/licenses/by-sa/3.0" target="_top">http://creativecommons.org/licenses/by-sa/3.0</a></em></span>), respectively.</p><p>Projections can be a tricky issue when you’re working with maps, but the smaller the mapped area, the less of an effect projections have, and they’re less critical in the center of the mapped region. For this example, with its relatively small area and action focused in the center, we’ll assume the map image uses a Mercator projection. That assumption lets us avoid any advanced mathematical transformations when converting from latitude and longitude to x- and y-values.</p><p><a class="xref" href="ch01.html#map_image_can_be_used_as_the_background" title="Figure 1-21. A map image can be used as the background for a chart.">Figure 1-21</a> shows the map image on which we’ll overlay the hurricane’s path.</p><div class="figure"><a id="map_image_can_be_used_as_the_background"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00021"/><img src="figs/web/01fig21.png.jpg" alt="A map image can be used as the background for a chart."/></div></div><div class="figure-title">Figure 1-21. A map image can be used as the background for a chart.</div></div></div><div class="sect2" title="Step 3: Plot the Data"><div class="titlepage"><div><div><h3 class="title" id="step_3_plot_the_data-id00004">Step 3: Plot the Data</h3></div></div></div><p><a id="iddle1104" class="indexterm"/><a id="iddle1284" class="indexterm"/><a id="iddle1370" class="indexterm"/>It will take us several iterations to get the chart looking the way we want, but let’s start with the minimum number of options. One parameter we will need to specify is the bubble radius. For static charts such as this example, it’s easiest to experiment with a few values to find the best size. A value of <code class="literal">0.3</code> seems effective for our chart. In addition to the options, the <code class="literal">draw()</code> method expects an HTML element that will contain the chart, as well as the data itself.</p><a id="pro_id00037"/><pre class="programlisting"><span class="steelblue">Flotr</span>.<span class="olive">draw</span>(
    <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),
    [{
      <span class="dodgerblue">data</span>: <span class="olive">get_points</span>(katrina),
      <span class="dodgerblue">bubbles</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>, <span class="dodgerblue">baseRadius</span>: <span class="red">0.3</span>}
    }]
);</pre><p>As you can see, we’re using our transformation function to extract the data from our source. The return value from that function serves directly as the second parameter to <code class="literal">draw()</code>.</p><p>For now, we haven’t bothered with the background image. We’ll add that to the chart once we’ve adjusted the data a bit. The result in <a class="xref" href="ch01.html#basic_bubble_chart_varies_the_size_of_th" title="Figure 1-22. A basic bubble chart varies the size of the data points.">Figure 1-22</a> still needs improvement, but it’s a working start.</p><div class="figure"><a id="basic_bubble_chart_varies_the_size_of_th"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00022"/><img src="figs/web/01fig22.png.jpg" alt="A basic bubble chart varies the size of the data points."/></div></div><div class="figure-title">Figure 1-22. A basic bubble chart varies the size of the data points.</div></div></div><div class="sect2" title="Step 4: Add the Background"><div class="titlepage"><div><div><h3 class="title" id="step_4_add_the_background">Step 4: Add the Background</h3></div></div></div><p>Now that we’ve seen how Flotr2 will plot our data, we can add in the background image. We’ll want to make a few other additions at the same time. First, as long as we’re adding the background, we can remove the grid lines. Second, let’s disable the axis labels; latitude and longitude values don’t have much meaning for the average user, and they’re certainly not necessary with the map. Finally, and most importantly, we need to adjust the scale of the chart to match the map image.</p><a id="pro_id00038"/><pre class="programlisting">   <span class="steelblue">Flotr</span>.<span class="olive">draw</span>(
       <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),
       [{
         <span class="dodgerblue">data</span>: <span class="olive">get_points</span>(katrina),
         <span class="dodgerblue">bubbles</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>, <span class="dodgerblue">baseRadius</span>: <span class="red">0.3</span>}
       }],
       {
➊         <span class="dodgerblue">grid</span>: {
               <span class="dodgerblue">backgroundImage</span>: <span class="maroon">"img/gulf.png"</span>,
               <span class="dodgerblue">horizontalLines</span>: <span class="steelblue"><span class="strong"><strong>false</strong></span></span>,
               <span class="dodgerblue">verticalLines</span>: <span class="steelblue"><span class="strong"><strong>false</strong></span></span>
           },
➋         <span class="dodgerblue">yaxis</span>: {<span class="dodgerblue">showLabels</span>: <span class="steelblue"><span class="strong"><strong>false</strong></span></span>, <span class="dodgerblue">min</span>: <span class="red">23.607</span>, <span class="dodgerblue">max</span>: <span class="red">33.657</span>},
➌         <span class="dodgerblue">xaxis</span>: {<span class="dodgerblue">showLabels</span>: <span class="steelblue"><span class="strong"><strong>false</strong></span></span>, <span class="dodgerblue">min</span>: -<span class="red">94.298</span>, <span class="dodgerblue">max</span>: -<span class="red">77.586</span>}
       }
   );</pre><p><a id="iddle1101" class="indexterm"/><a id="iddle1156" class="indexterm"/><a id="iddle1345" class="indexterm"/><a id="iddle1431" class="indexterm"/><a id="iddle2160" class="indexterm"/>We’ve added <code class="literal">grid</code> options starting at ➊ to tell Flotr2 to omit both horizontal and vertical grid lines, and they designate the background image. Our image shows latitude values from 23.607°N to 33.657°N and longitude from 77.586°W to 94.298°W. At ➋ and ➌ we provide those values as ranges for the <code class="literal">xaxis</code> and <code class="literal">yaxis</code> options, and disable labels for both axes. Note that because we’re dealing with longitudes west of 0, we’re using negative values.</p><p>At this point the chart in <a class="xref" href="ch01.html#with_a_map_as_the_background_imagecomma" title="Figure 1-23. With a map as the background image, the chart has a meaningful context.">Figure 1-23</a> is looking pretty good. We can clearly see the path of the hurricane and get a sense of how the storm strengthened and weakened.</p><div class="figure"><a id="with_a_map_as_the_background_imagecomma"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00023"/><img src="figs/web/01fig23.png.jpg" alt="With a map as the background image, the chart has a meaningful context."/></div></div><div class="figure-title">Figure 1-23. With a map as the background image, the chart has a meaningful context.</div></div></div><div class="sect2" title="Step 5: Color the Bubbles"><div class="titlepage"><div><div><h3 class="title" id="step_5_color_the_bubbles">Step 5: Color the Bubbles</h3></div></div></div><p>This example gives us a chance to provide even more information to our users without overly distracting them: we have the option to modify the bubble colors. Let’s use that freedom to indicate the Saffir-Simpson classification for storm intensity at each measurement point.</p><p>Here’s where we can take advantage of the filter option we included in the data formatting function. The Saffir-Simpson classification is based on wind speed, so we’ll filter based on the <code class="literal">wind</code> property. For example, here’s how to extract only those values that represent a Category 1 hurricane, with wind speeds from 74 to 95 miles per hour. The function we pass to <code class="literal">get_points</code> returns <code class="literal">true</code> only for appropriate wind speeds.</p><a id="pro_id00039"/><pre class="programlisting">cat1 = <span class="olive">get_points</span>(katrina, <span class="steelblue"><span class="strong"><strong>function</strong></span></span>(obs) {
    <span class="steelblue"><span class="strong"><strong>return</strong></span></span> (<span class="steelblue">obs</span>.<span class="olive">wind</span> &gt;= <span class="red">74</span>) &amp;&amp; (<span class="steelblue">obs</span>.<span class="olive">wind</span> &lt; <span class="red">95</span>);
});</pre><p>To have Flotr2 assign different colors to different strengths, we divide the data into multiple series with the following code. Each series gets its own color. In addition to the five hurricane categories, we’ve also parsed out the points for tropical storm and tropical depression strength.</p><a id="pro_id00040"/><pre class="programlisting"><span class="steelblue">Flotr</span>.<span class="olive">draw</span>(
    <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),
    [
      {
          <span class="dodgerblue">data</span>: <span class="olive">get_points</span>(katrina, <span class="steelblue"><span class="strong"><strong>function</strong></span></span>(obs) {
                    <span class="steelblue"><span class="strong"><strong>return</strong></span></span> (<span class="steelblue">obs</span>.<span class="olive">wind</span> &lt; <span class="red">39</span>);
                }),
          <span class="dodgerblue">color</span>: <span class="maroon">"#74add1"</span>,
          <span class="dodgerblue">bubbles</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>, <span class="dodgerblue">baseRadius</span>: <span class="red">0.3</span>, <span class="dodgerblue">lineWidth</span>: <span class="red">1</span>}
      },{
      <span class="indianred"><span class="emphasis"><em>// Options continue...</em></span></span>
      },{
          <span class="dodgerblue">data</span>: <span class="olive">get_points</span>(katrina, <span class="steelblue"><span class="strong"><strong>function</strong></span></span>(obs) {
                    <span class="steelblue"><span class="strong"><strong>return</strong></span></span> (<span class="steelblue">obs</span>.<span class="olive">wind</span> &gt;= <span class="red">157</span>);
                }),
          <span class="dodgerblue">color</span>: <span class="maroon">"#d73027"</span>,
          <span class="dodgerblue">label</span>: <span class="maroon">"Category 5"</span>,
          <span class="dodgerblue">bubbles</span>: {<span class="dodgerblue">show</span>:<span class="steelblue"><span class="strong"><strong>true</strong></span></span>, <span class="dodgerblue">baseRadius</span>: <span class="red">0.3</span>, <span class="dodgerblue">lineWidth</span>: <span class="red">1</span>}
      }
    ],{
        <span class="dodgerblue">grid</span>: {
            <span class="dodgerblue">backgroundImage</span>: <span class="maroon">"img/gulf.png"</span>,
            <span class="dodgerblue">horizontalLines</span>: <span class="steelblue"><span class="strong"><strong>false</strong></span></span>,
            <span class="dodgerblue">verticalLines</span>: <span class="steelblue"><span class="strong"><strong>false</strong></span></span>
        },
        <span class="dodgerblue">yaxis</span>: {<span class="dodgerblue">showLabels</span>: <span class="steelblue"><span class="strong"><strong>false</strong></span></span>, <span class="dodgerblue">min</span>: <span class="red">23.607</span>, <span class="dodgerblue">max</span>: <span class="red">33.657</span>},
        <span class="dodgerblue">xaxis</span>: {<span class="dodgerblue">showLabels</span>: <span class="steelblue"><span class="strong"><strong>false</strong></span></span>, <span class="dodgerblue">min</span>: -<span class="red">94.298</span>, <span class="dodgerblue">max</span>: -<span class="red">77.586</span>},
        <span class="dodgerblue">legend</span>: {<span class="dodgerblue">position</span>: <span class="maroon">"sw"</span>}
    }
);</pre><p>We’ve also added labels for the hurricane categories and placed a legend in the lower left of the chart, as you can see in <a class="xref" href="ch01.html#different_colors_can_indicate_wind_stren" title="Figure 1-24. Different colors can indicate wind strength.">Figure 1-24</a>.</p><div class="figure"><a id="different_colors_can_indicate_wind_stren"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00024"/><img src="figs/web/01fig24.png.jpg" alt="Different colors can indicate wind strength."/></div></div><div class="figure-title">Figure 1-24. Different colors can indicate wind strength.</div></div></div><div class="sect2" title="Step 6: Adjust the Legend Styles"><div class="titlepage"><div><div><h3 class="title" id="step_6_adjust_the_legend_styles">Step 6: Adjust the Legend Styles</h3></div></div></div><p><a id="iddle1103" class="indexterm"/><a id="iddle1593" class="indexterm"/><a id="iddle1733" class="indexterm"/>By default, Flotr2 seems to prefer all elements as large as possible. The legend in <a class="xref" href="ch01.html#different_colors_can_indicate_wind_stren" title="Figure 1-24. Different colors can indicate wind strength.">Figure 1-24</a> is a good example: it looks cramped and unattractive. Fortunately, the fix is rather simple: we simply add some CSS styles to give the legend padding. We can also set the legend’s background color explicitly rather than relying on Flotr2’s manipulation of opacity.</p><a id="pro_id00041"/><pre class="programlisting"><span class="red">.flotr-legend</span> <span class="steelblue"><span class="strong"><strong>{</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>padding:</strong></span></span> <span class="dodgerblue">5px</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
    <span class="steelblue"><span class="strong"><strong>background-color:</strong></span></span> <span class="dodgerblue">#ececec</span><span class="steelblue"><span class="strong"><strong>;</strong></span></span>
<span class="steelblue"><span class="strong"><strong>}</strong></span></span></pre><p>To prevent Flotr2 from creating its own background for the legend, set the opacity to <code class="literal">0</code>.</p><a id="pro_id00042"/><pre class="programlisting"><span class="steelblue">Flotr</span>.<span class="olive">draw</span>(
    <span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>)
        <span class="indianred"><span class="emphasis"><em>// Additional options...</em></span></span>
        legend: {<span class="dodgerblue">position</span>: <span class="maroon">"sw"</span>, <span class="dodgerblue">backgroundOpacity</span>: <span class="red">0</span>,},
        <span class="indianred"><span class="emphasis"><em>// Additional options...</em></span></span></pre><p>With that final tweak, we have the finished product of <a class="xref" href="ch01.html#bubble_chart_shows_a_third_dimension_lef" title="Figure 1-25. A bubble chart shows a third dimension (wind speed), as well as position.">Figure 1-25</a>. We don’t want to use the Flotr2 options to specify a title, because Flotr2 will shrink the chart area by an unpredictable amount (since we cannot predict the font sizing in the users’ browsers). That would distort our latitude transformation. Of course, it’s easy enough to use HTML to provide the title.</p><div class="figure"><a id="bubble_chart_shows_a_third_dimension_lef"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00025"/><img src="figs/web/01fig25.png.jpg" alt="A bubble chart shows a third dimension (wind speed), as well as position."/></div></div><div class="figure-title">Figure 1-25. A bubble chart shows a third dimension (wind speed), as well as position.</div></div><p><a id="iddle1787" class="indexterm"/><a id="iddle1790" class="indexterm"/>The bubble chart adds another dimension to the two-dimensional scatter chart. In fact, as in our example, it can add two further dimensions. The example uses bubble size to represent wind speed and color to indicate the hurricane’s classification. Both of these additional values require care, however. Humans are not good at comparing two-dimensional areas, nor can they easily compare relative shades or colors. We should never use the extra bubble chart dimensions to convey critical data or precise quantities. Rather, they work best in examples such as this—neither the exact wind speed nor the specific classification need be as precise as the location. Few people can tell the difference between 100- and 110-mile-per-hour winds, but they certainly know the difference between New Orleans and Dallas.</p></div><div class="sect2" title="Step 7: Work Around Flotr2 “Bugs”"><div class="titlepage"><div><div><h3 class="title" id="step_7_work_around_flotr2_quotat-id00005">Step 7: Work Around Flotr2 “Bugs”</h3></div></div></div><p>Be sure to refer to Step 9 of <a class="xref" href="ch01.html#creating_a_basic_bar_chart" title="Creating a Basic Bar Chart">Creating a Basic Bar Chart</a> in <a class="xref" href="ch01.html#step_9_work_around_flotr2_quotation_mark" title="Step 9: Work Around Flotr2 “Bugs”">Step 9: Work Around Flotr2 “Bugs”</a> to see how to work around some “bugs” in the Flotr2 library.</p></div></div><div class="sect1" title="Displaying Multidimensional Data with a Radar Chart"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="displaying_multidimensional_data_with_a">Displaying Multidimensional Data with a Radar Chart</h2></div></div></div><p>If you have data with many dimensions, a radar chart may be the most effective way to visualize it. Radar charts are not as common as other charts, though, and their unfamiliarity makes them a little harder for users to interpret. If you design a radar chart, be careful not to increase that burden.</p><p><a id="iddle1789" class="indexterm"/>Radar charts are most effective when your data has several characteristics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>You don’t have too many data points to show. Half a dozen data points is about the maximum that a radar chart can accommodate.</p></li><li class="listitem"><p>The data points have multiple dimensions. With two or even three dimensions to your data, you would probably be better off with a more traditional chart type. Radar charts come into play with data of four or more dimensions.</p></li><li class="listitem"><p>Each data dimension is a scale that can at least be ranked (from good to bad, say), if not assigned a number outright. Radar charts don’t work well with data dimensions that are merely arbitrary categories (such as political party or nationality).</p></li></ul></div><p>A classic use for radar charts is analyzing the performance of players on a sports team. Consider, for example, the 2012 starting lineup of Miami Heat, a team in the National Basketball Association (NBA). There are only five data points (the five players). There are multiple dimensions—points, assists, rebounds, blocks, steals, and so on—and each of those dimensions has a natural numeric value.</p><p><a class="xref" href="ch01.html#miami_heat_2011en_dash2012_season" title="Table 1-1. Miami Heat 2011–2012 Season">Table 1-1</a> shows the players’ 2011–2012 season averages per game, as well as the team totals (which include the contributions of nonstarters).</p><div class="table"><a id="miami_heat_2011en_dash2012_season"/><div class="table-title">Table 1-1. Miami Heat 2011–2012 Season</div><div class="table-contents"><table style="border-collapse: collapse; border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="c1"/><col class="c2"/><col class="c3"/><col class="c4"/><col class="c5"/><col class="c6"/></colgroup><thead><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Player</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Points</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Rebounds</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Assists</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Steals</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>Blocks</p></td></tr></thead><tbody><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Chris Bosh</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>17.2</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>7.9</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>1.6</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>0.8</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>0.8</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Shane Battier</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>5.4</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>2.6</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>1.2</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>1.0</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>0.5</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>LeBron James</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>28.0</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>8.4</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>6.1</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>1.9</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>0.8</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Dwyane Wade</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>22.3</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>5.0</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>4.5</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>1.7</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>1.3</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Mario Chalmers</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>10.2</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>2.9</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>3.6</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>1.4</p></td><td style="vertical-align: top; border-bottom: 0.5pt solid ; "><p>0.2</p></td></tr><tr><td style="vertical-align: top; border-right: 0.5pt solid ; "><p>Team total</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; "><p>98.2</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; "><p>41.3</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; "><p>19.3</p></td><td style="vertical-align: top; border-right: 0.5pt solid ; "><p>8.5</p></td><td style="vertical-align: top; "><p>5.3</p></td></tr></tbody></table></div></div><p>Just as in Step 1 of <a class="xref" href="ch01.html#creating_a_basic_bar_chart" title="Creating a Basic Bar Chart">Creating a Basic Bar Chart</a>, we need to include the Flotr2 library in our web page and set aside a <code class="literal">&lt;div&gt;</code> element to contain the chart we’ll construct.</p><div class="sect2" title="Step 1: Define the Data"><div class="titlepage"><div><div><h3 class="title" id="step_1_define_the_data-id00006">Step 1: Define the Data</h3></div></div></div><p>We’ll start with a typical JavaScript expression of the team’s statistics. For our example we’ll start with an array of objects corresponding to each starter, and a separate object for the entire team.</p><a id="pro_id00043"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>var</strong></span></span> players = [
    { <span class="dodgerblue">player</span>: <span class="maroon">"Chris Bosh"</span>,     <span class="dodgerblue">points</span>: <span class="red">17.2</span>, <span class="dodgerblue">rebounds</span>: <span class="red">7.9</span>, <span class="dodgerblue">assists</span>: <span class="red">1.6</span>,
      <span class="dodgerblue">steals</span>: <span class="red">0.8</span>, <span class="dodgerblue">blocks</span>: <span class="red">0.8</span> },
    { <span class="dodgerblue">player</span>: <span class="maroon">"Shane Battier"</span>,  <span class="dodgerblue">points</span>:  <span class="red">5.4</span>, <span class="dodgerblue">rebounds</span>: <span class="red">2.6</span>, <span class="dodgerblue">assists</span>: <span class="red">1.2</span>,
      <span class="dodgerblue">steals</span>: <span class="red">1.0</span>, <span class="dodgerblue">blocks</span>: <span class="red">0.5</span> },
    { <span class="dodgerblue">player</span>: <span class="maroon">"LeBron James"</span>,   <span class="dodgerblue">points</span>: <span class="red">28.0</span>, <span class="dodgerblue">rebounds</span>: <span class="red">8.4</span>, <span class="dodgerblue">assists</span>: <span class="red">6.1</span>,
      <span class="dodgerblue">steals</span>: <span class="red">1.9</span>, <span class="dodgerblue">blocks</span>: <span class="red">0.8</span> },
    { <span class="dodgerblue">player</span>: <span class="maroon">"Dwyane Wade"</span>,    <span class="dodgerblue">points</span>: <span class="red">22.3</span>, <span class="dodgerblue">rebounds</span>: <span class="red">5.0</span>, <span class="dodgerblue">assists</span>: <span class="red">4.5</span>,
      <span class="dodgerblue">steals</span>: <span class="red">1.7</span>, <span class="dodgerblue">blocks</span>: <span class="red">1.3</span> },
    { <span class="dodgerblue">player</span>: <span class="maroon">"Mario Chalmers"</span>, <span class="dodgerblue">points</span>: <span class="red">10.2</span>, <span class="dodgerblue">rebounds</span>: <span class="red">2.9</span>, <span class="dodgerblue">assists</span>: <span class="red">3.6</span>,
      <span class="dodgerblue">steals</span>: <span class="red">1.4</span>, <span class="dodgerblue">blocks</span>: <span class="red">0.2</span> }
];
<span class="steelblue"><span class="strong"><strong>var</strong></span></span> team = {
    <span class="dodgerblue">points</span>:   <span class="red">98.2</span>,
    <span class="dodgerblue">rebounds</span>: <span class="red">41.3</span>,
    <span class="dodgerblue">assists</span>:  <span class="red">19.3</span>,
    <span class="dodgerblue">steals</span>:    <span class="red">8.5</span>,
    <span class="dodgerblue">blocks</span>:    <span class="red">5.3</span>
};</pre><p><a id="iddle1558" class="indexterm"/>For an effective radar plot, we need to normalize all the values to a common scale. In this example, let’s translate raw statistics into team percentage. For example, instead of visualizing LeBron James’s scoring as 28.0, we’ll show it as 29 percent (28.0/98.2).</p><p>There are a couple of functions we can use to convert the raw statistics into an object to chart. The first function returns the <code class="literal">statistics</code> object for a single player. It simply searches through the <code class="literal">players</code> array looking for that player’s name. The second function steps through each statistic in the <code class="literal">team</code> object, gets the corresponding statistic for the named player, and normalizes the value. The returned object will have a <code class="literal">label</code> property equal to the player’s name, and an array of normalized statistics for that player.</p><a id="pro_id00044"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>var</strong></span></span> get_player = <span class="steelblue"><span class="strong"><strong>function</strong></span></span>(name) {
   <span class="steelblue"><span class="strong"><strong>for</strong></span></span> (<span class="steelblue"><span class="strong"><strong>var</strong></span></span> i=<span class="red">0</span>; i&lt;<span class="steelblue">players</span>.<span class="olive">length</span>; i++) {
       <span class="steelblue"><span class="strong"><strong>if</strong></span></span> (players[i].<span class="olive">player</span> === name) <span class="steelblue"><span class="strong"><strong>return</strong></span></span> players[i];
   }
}
<span class="steelblue"><span class="strong"><strong>var</strong></span></span> player_data = <span class="steelblue"><span class="strong"><strong>function</strong></span></span>(name) {
    <span class="steelblue"><span class="strong"><strong>var</strong></span></span> obj = {}, i = <span class="red">0</span>;
    <span class="steelblue">obj</span>.<span class="olive">label</span> = name;
    <span class="steelblue">obj</span>.<span class="olive">data</span> = [];
    <span class="steelblue"><span class="strong"><strong>for</strong></span></span> (<span class="steelblue"><span class="strong"><strong>var</strong></span></span> key <span class="steelblue"><span class="strong"><strong>in</strong></span></span> team) {
        <span class="steelblue">obj</span>.<span class="steelblue">data</span>.<span class="olive">push</span>([i, <span class="red">100</span>*<span class="olive">get_player</span>(name)[key]/team[key]]);
        i++;
    };
    <span class="steelblue"><span class="strong"><strong>return</strong></span></span> obj;
};</pre><p>For example, the function call <code class="literal">player_data(</code><span class="maroon"><code class="literal">"</code></span><code class="literal">LeBron James</code><span class="maroon"><code class="literal">"</code></span><code class="literal">)</code> returns the following object:</p><a id="pro_id00045"/><pre class="programlisting">{
    <span class="dodgerblue">label</span>: <span class="maroon">"LeBron James"</span>,
    <span class="dodgerblue">data</span>: [
               [<span class="red">0</span>,<span class="red">28.513238289205702</span>],
               [<span class="red">1</span>,<span class="red">20.33898305084746</span>],
               [<span class="red">2</span>,<span class="red">31.60621761658031</span>],
               [<span class="red">3</span>,<span class="red">22.352941176470587</span>],
               [<span class="red">4</span>,<span class="red">15.09433962264151</span>]
          ]
}</pre><p><a id="iddle1288" class="indexterm"/><a id="iddle1371" class="indexterm"/><a id="iddle1788" class="indexterm"/>For the specific statistics, we’re using a counter from 0 to 4. We’ll see how to map those numbers into meaningful values shortly.</p><p>Since Flotr2 doesn’t require jQuery, we aren’t taking advantage of any jQuery convenience function in the preceding code. We’re also not taking full advantage of the JavaScript standard (including methods such as <code class="literal">.each()</code>), because Internet Explorer releases prior to version 9 do not support those methods. If you have jQuery on your pages for other reasons, or if you don’t need to support older IE versions, you can simplify this code quite a bit.</p><p>The last bit of code we’ll use is a simple array of labels for the statistics in our chart. The order must match the order returned in <code class="literal">player_data()</code>.</p><a id="pro_id00046"/><pre class="programlisting"><span class="steelblue"><span class="strong"><strong>var</strong></span></span> labels = [
    [<span class="red">0</span>, <span class="maroon">"Points"</span>],
    [<span class="red">1</span>, <span class="maroon">"Rebounds"</span>],
    [<span class="red">2</span>, <span class="maroon">"Assists"</span>],
    [<span class="red">3</span>, <span class="maroon">"Steals"</span>],
    [<span class="red">4</span>, <span class="maroon">"Blocks"</span>]
];</pre></div><div class="sect2" title="Step 2: Create the Chart"><div class="titlepage"><div><div><h3 class="title" id="step_2_create_the_chart">Step 2: Create the Chart</h3></div></div></div><p>A single call to Flotr2’s <code class="literal">draw()</code> method is all it takes to create our chart. We need to specify the HTML element in which to place the chart, as well as the chart data. For the data, we’ll use the <code class="literal">get_player()</code> function shown previously.</p><a id="pro_id00047"/><pre class="programlisting">   <span class="steelblue">Flotr</span>.<span class="olive">draw</span>(<span class="steelblue">document</span>.<span class="olive">getElementById</span>(<span class="maroon">"chart"</span>),
       [
           <span class="olive">player_data</span>(<span class="maroon">"Chris Bosh"</span>),
           <span class="olive">player_data</span>(<span class="maroon">"Shane Battier"</span>),
           <span class="olive">player_data</span>(<span class="maroon">"LeBron James"</span>),
           <span class="olive">player_data</span>(<span class="maroon">"Dwyane Wade"</span>),
           <span class="olive">player_data</span>(<span class="maroon">"Mario Chalmers"</span>)
       ],{
➊         <span class="dodgerblue">title</span>:
               <span class="maroon">"2011/12 Miami Heat Starting Lineup — Contribution to Team Total"</span>,
➋         <span class="dodgerblue">radar</span>: { <span class="dodgerblue">show</span>: <span class="steelblue"><span class="strong"><strong>true</strong></span></span> },
➌         <span class="dodgerblue">grid</span>:  { <span class="dodgerblue">circular</span>: <span class="steelblue"><span class="strong"><strong>true</strong></span></span>, },
           <span class="dodgerblue">xaxis</span>: { <span class="dodgerblue">ticks</span>: labels, },
           <span class="dodgerblue">yaxis</span>: { <span class="dodgerblue">showLabels</span>: <span class="steelblue"><span class="strong"><strong>false</strong></span></span>, <span class="dodgerblue">min</span>:<span class="red">0</span>, <span class="dodgerblue">max</span>: <span class="red">33</span>, }
       }
   );</pre><p><a id="iddle2048" class="indexterm"/>This code also includes a few options. The <code class="literal">title</code> option at ➊ provides an overall title for the chart, and the <code class="literal">radar</code> option at ➋ tells Flotr2 the type of chart we want. With a radar chart, we also have to explicitly specify a circular (as opposed to rectangular) grid, so we do that with the <code class="literal">grid</code> option at ➌. The final two options detail the x- and y-axes. For the x-axis, we use our <code class="literal">labels</code> array to give each statistic a name, and for the y-axis, we forgo labels altogether and explicitly specify the minimum and maximum values.</p><p>The only real trick is making the HTML container wide enough to hold both the chart proper and the legend, since Flotr2 doesn’t do a great job of calculating the size appropriately. For a static chart such as this one, trial and error is the simplest approach and gives us the chart shown in <a class="xref" href="ch01.html#radar_charts_let_users_compare_multiple" title="Figure 1-26. Radar charts let users compare multiple data variables at once.">Figure 1-26</a>.</p><div class="figure"><a id="radar_charts_let_users_compare_multiple"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00026"/><img src="figs/web/01fig26.png.jpg" alt="Radar charts let users compare multiple data variables at once."/></div></div><div class="figure-title">Figure 1-26. Radar charts let users compare multiple data variables at once.</div></div><p>Although it’s certainly not a surprise to NBA fans, the chart clearly demonstrates the value of LeBron James to the team. He led the team in four of the five major statistical categories.</p><p>The radar chart lends itself only to a few specialized applications, but it can be effective when there is a modest number of variables, each of which is easily quantified. In <a class="xref" href="ch01.html#radar_charts_let_users_compare_multiple" title="Figure 1-26. Radar charts let users compare multiple data variables at once.">Figure 1-26</a>, each player’s area on the chart roughly corresponds to his total contribution across all of the variables. The relative size of the red area makes James’s total contribution strikingly clear.</p></div><div class="sect2" title="Step 3: Work Around Flotr2 “Bugs”"><div class="titlepage"><div><div><h3 class="title" id="step_3_work_around_flotr2_quotation_mark">Step 3: Work Around Flotr2 “Bugs”</h3></div></div></div><p>Be sure to refer to Step 9 of <a class="xref" href="ch01.html#creating_a_basic_bar_chart" title="Creating a Basic Bar Chart">Creating a Basic Bar Chart</a> in <a class="xref" href="ch01.html#step_9_work_around_flotr2_quotation_mark" title="Step 9: Work Around Flotr2 “Bugs”">Step 9: Work Around Flotr2 “Bugs”</a> to see how to work around some “bugs” in the Flotr2 library.</p></div></div><div class="sect1" title="Summing Up"><div class="titlepage"><div><div><h2 class="title" style="clear: both" id="summing_up-id00007">Summing Up</h2></div></div></div><p><a id="iddle1106" class="indexterm"/><a id="iddle1610" class="indexterm"/><a id="iddle1758" class="indexterm"/><a id="iddle1791" class="indexterm"/><a id="iddle1864" class="indexterm"/>The examples in this chapter provide a quick tour of the many types of standard data charts, the simplest and most straightforward tool for visualizing data. Each of these charts is especially effective for certain types of visualizations.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: none"><p title="Bar charts"><span class="title"><strong><span class="strong"><strong>Bar charts</strong></span></strong></span>. The workhorse of charts. Effective at showing the change of a quantity over a small number of regular time intervals, or at comparing several different quantities against one another.</p></li><li class="listitem" style="list-style-type: none"><p title="Line charts"><span class="title"><strong><span class="strong"><strong>Line charts</strong></span></strong></span>. More effective than bar charts when there is a large number of data values to show, or for showing quantities that vary on an irregular schedule.</p></li><li class="listitem" style="list-style-type: none"><p title="Pie charts"><span class="title"><strong><span class="strong"><strong>Pie charts</strong></span></strong></span>. Often overused but can be effective to highlight the proportion of a single value within a whole.</p></li><li class="listitem" style="list-style-type: none"><p title="Scatter charts"><span class="title"><strong><span class="strong"><strong>Scatter charts</strong></span></strong></span>. Effective for showing possible relationships between two values.</p></li><li class="listitem" style="list-style-type: none"><p title="Bubble charts"><span class="title"><strong><span class="strong"><strong>Bubble charts</strong></span></strong></span>. Adds a third value to scatter charts but should be used carefully, as it’s difficult to accurately assess the relative areas of circular regions.</p></li><li class="listitem" style="list-style-type: none"><p title="Radar charts"><span class="title"><strong><span class="strong"><strong>Radar charts</strong></span></strong></span>. Designed to show several aspects of the subject on one chart. Not as familiar to many users but can be effective for certain specialized cases.</p></li></ul></div></div></section></body></html>