["```\nSELECT county_name,\n       state_name,\n       pop_est_2019\nFROM us_counties_pop_est_2019\n1 WHERE pop_est_2019 >= (\n    SELECT percentile_cont(.9) WITHIN GROUP (ORDER BY pop_est_2019)\n    FROM us_counties_pop_est_2019\n    )\nORDER BY pop_est_2019 DESC;\n```", "```\n county_name            state_name      pop_est_2019\n----------------------- -------------------- ------------\nLos Angeles County      California               10039107\nCook County             Illinois                  5150233\nHarris County           Texas                     4713325\nMaricopa County         Arizona                   4485414\nSan Diego County        California                3338330\n`--snip--`\nCabarrus County         North Carolina             216453\nYuma County             Arizona                    213787\n```", "```\nCREATE TABLE us_counties_2019_top10 AS\nSELECT * FROM us_counties_pop_est_2019;\n\nDELETE FROM us_counties_2019_top10\nWHERE pop_est_2019 < (\n    SELECT percentile_cont(.9) WITHIN GROUP (ORDER BY pop_est_2019)\n    FROM us_counties_2019_top10\n    );\n```", "```\nSELECT round(calcs.average, 0) AS average,\n       calcs.median,\n       round(calcs.average - calcs.median, 0) AS median_average_diff\nFROM (\n   1 SELECT avg(pop_est_2019) AS average,\n            percentile_cont(.5)\n                WITHIN GROUP (ORDER BY pop_est_2019)::numeric AS median\n     FROM us_counties_pop_est_2019\n     )\n2 AS calcs;\n```", "```\naverage    median     median_average_diff\n-------    -------    -------------------\n 104468      25726                  78742\n```", "```\nSELECT census.state_name AS st,\n       census.pop_est_2018,\n       est.establishment_count,\n     1 round((est.establishment_count/census.pop_est_2018::numeric) * 1000, 1)\n           AS estabs_per_thousand\nFROM\n    (\n      2 SELECT st,\n               sum(establishments) AS establishment_count\n        FROM cbp_naics_72_establishments\n        GROUP BY st\n    )\n    AS est\nJOIN\n    (\n      3 SELECT state_name,\n               sum(pop_est_2018) AS pop_est_2018\n        FROM us_counties_pop_est_2019\n        GROUP BY state_name\n    )\n    AS census\n4 ON est.st = census.state_name\nORDER BY estabs_per_thousand DESC;\n```", "```\n st          pop_est_2018 establishment_count estabs_per_thousand\n-------------------- ------------ ------------------- -------------------\nDistrict of Columbia       701547                2754                 3.9\nMontana                   1060665                3569                 3.4\nVermont                    624358                1991                 3.2\nMaine                     1339057                4282                 3.2\nWyoming                    577601                1808                 3.1\n`--snip--`\nArizona                   7158024               13288                 1.9\nAlabama                   4887681                9140                 1.9\nUtah                      3153550                6062                 1.9\nMississippi               2981020                5645                 1.9\nKentucky                  4461153                8251                 1.8\n```", "```\nSELECT county_name,\n       state_name AS st,\n       pop_est_2019,\n       (SELECT percentile_cont(.5) WITHIN GROUP (ORDER BY pop_est_2019)\n        FROM us_counties_pop_est_2019) AS us_median\nFROM us_counties_pop_est_2019;\n```", "```\n county_name                     st          pop_est_2019 us_median\n--------------------------------- -------------------- ------------ ---------\nAutauga County                    Alabama                     55869     25726\nBaldwin County                    Alabama                    223234     25726\nBarbour County                    Alabama                     24686     25726\nBibb County                       Alabama                     22394     25726\nBlount County                     Alabama                     57826     25726\n`--snip--`\n```", "```\nSELECT county_name,\n       state_name AS st,\n       pop_est_2019,\n       pop_est_2019 - (SELECT percentile_cont(.5) WITHIN GROUP (ORDER BY pop_est_2019) 1\n                       FROM us_counties_pop_est_2019) AS diff_from_median\nFROM us_counties_pop_est_2019\nWHERE (pop_est_2019 - (SELECT percentile_cont(.5) WITHIN GROUP (ORDER BY pop_est_2019) 2\n                       FROM us_counties_pop_est_2019))\n       BETWEEN -1000 AND 1000;\n```", "```\n county_name             st       pop_est_2019 diff_from_median\n----------------------- -------------- ------------ ----------------\nCherokee County         Alabama               26196              470\nGeneva County           Alabama               26271              545\nCleburne County         Arkansas              24919             -807\nJohnson County          Arkansas              26578              852\nSt. Francis County      Arkansas              24994             -732\n`--snip--`\n```", "```\nCREATE TABLE retirees (\n    id int,\n    first_name text,\n    last_name text\n);\n\nINSERT INTO retirees\nVALUES (2, 'Janet', 'King'),\n       (4, 'Michael', 'Taylor');\n```", "```\nSELECT first_name, last_name\nFROM employees\nWHERE emp_id IN (\n    SELECT id\n    FROM retirees)\nORDER BY emp_id;\n```", "```\nfirst_name last_name\n---------- ---------\nJanet      King\nMichael    Taylor\n```", "```\nSELECT first_name, last_name\nFROM employees\nWHERE EXISTS (\n    SELECT id\n    FROM retirees\n    WHERE id = employees.emp_id);\n```", "```\nSELECT first_name, last_name\nFROM employees\nWHERE NOT EXISTS (\n    SELECT id\n    FROM retirees\n    WHERE id = employees.emp_id);\n```", "```\nfirst_name last_name\n---------- ---------\nJulia      Reyes\nArthur     Pappas\n```", "```\nSELECT county_name,\n       state_name,\n       pop_est_2018,\n       pop_est_2019,\n       raw_chg,\n       round(pct_chg * 100, 2) AS pct_chg\nFROM us_counties_pop_est_2019,\n     1 LATERAL (SELECT pop_est_2019 - pop_est_2018 AS raw_chg) rc,\n     2 LATERAL (SELECT raw_chg / pop_est_2018::numeric AS pct_chg) pc\nORDER BY pct_chg DESC;\n```", "```\n county_name     state_name  pop_est_2018 pop_est_2019 raw_chg pct_chg\n---------------- ------------ ------------ ------------ ------- -------\nLoving County    Texas                 148          169      21   14.19\nMcKenzie County  North Dakota        13594        15024    1430   10.52\nLoup County      Nebraska              617          664      47    7.62\nKaufman County   Texas              128279       136154    7875    6.14\nWilliams County  North Dakota        35469        37589    2120    5.98\n`--snip--`\n```", "```\n1 ALTER TABLE teachers ADD CONSTRAINT id_key PRIMARY KEY (id);\n\n2 CREATE TABLE teachers_lab_access (\n    access_id bigint PRIMARY KEY GENERATED ALWAYS AS IDENTITY,\n    access_time timestamp with time zone,\n    lab_name text,\n    teacher_id bigint REFERENCES teachers (id)\n);\n\n3 INSERT INTO teachers_lab_access (access_time, lab_name, teacher_id)\nVALUES ('2022-11-30 08:59:00-05', 'Science A', 2),\n       ('2022-12-01 08:58:00-05', 'Chemistry B', 2),\n       ('2022-12-21 09:01:00-05', 'Chemistry A', 2),\n       ('2022-12-02 11:01:00-05', 'Science B', 6),\n       ('2022-12-07 10:02:00-05', 'Science A', 6),\n       ('2022-12-17 16:00:00-05', 'Science B', 6);\n\nSELECT t.first_name, t.last_name, a.access_time, a.lab_name\nFROM teachers t\n4 LEFT JOIN LATERAL (SELECT *\n                   FROM teachers_lab_access\n                 5 WHERE teacher_id = t.id\n                   ORDER BY access_time DESC\n                   LIMIT 2)6 a\n7 ON true\nORDER BY t.id;\n```", "```\nfirst_name last_name      access_time         lab_name\n---------- --------- ----------------------  ------------\nJanet      Smith\nLee        Reynolds  2022-12-21 09:01:00-05  Chemistry A\nLee        Reynolds  2022-12-01 08:58:00-05  Chemistry B\nSamuel     Cole\nSamantha   Bush\nBetty      Diaz\nKathleen   Roush     2022-12-17 16:00:00-05  Science B\nKathleen   Roush     2022-12-07 10:02:00-05  Science A\n```", "```\n1 WITH large_counties (county_name, state_name, pop_est_2019)\nAS (\n  2 SELECT county_name, state_name, pop_est_2019\n    FROM us_counties_pop_est_2019\n    WHERE pop_est_2019 >= 100000\n   )\n3 SELECT state_name, count(*)\nFROM large_counties\nGROUP BY state_name\nORDER BY count(*) DESC;\n```", "```\n state_name      count\n-------------------- -----\nTexas                   40\nFlorida                 36\nCalifornia              35\nPennsylvania            31\nNew York                28\nNorth Carolina          28\n`--snip--`\n```", "```\nWITH\n  1 counties (st, pop_est_2018) AS\n    (SELECT state_name, sum(pop_est_2018)\n     FROM us_counties_pop_est_2019\n     GROUP BY state_name),\n\n  2 establishments (st, establishment_count) AS\n    (SELECT st, sum(establishments) AS establishment_count\n     FROM cbp_naics_72_establishments\n     GROUP BY st)\n\nSELECT counties.st,\n       pop_est_2018,\n       establishment_count,\n       round((establishments.establishment_count /\n              counties.pop_est_2018::numeric(10,1)) * 1000, 1)\n           AS estabs_per_thousand\n3 FROM counties JOIN establishments\nON counties.st = establishments.st\nORDER BY estabs_per_thousand DESC;\n```", "```\n1 WITH us_median AS\n    (SELECT percentile_cont(.5)\n     WITHIN GROUP (ORDER BY pop_est_2019) AS us_median_pop\n     FROM us_counties_pop_est_2019)\n\nSELECT county_name,\n       state_name AS st,\n       pop_est_2019,\n     2 us_median_pop,\n     3 pop_est_2019 - us_median_pop AS diff_from_median\n4 FROM us_counties_pop_est_2019 CROSS JOIN us_median\n5 WHERE (pop_est_2019 - us_median_pop)\n       BETWEEN -1000 AND 1000;\n```", "```\ncandidate    ward 1    ward 2    ward 3\n---------    ------    ------    ------\nCollins         602     1,799     2,112\nBanks           599     1,398     1,616\nRutherford      911       902     1,114\n```", "```\nCREATE EXTENSION tablefunc;\n```", "```\nCREATE TABLE ice_cream_survey (\n    response_id integer PRIMARY KEY,\n    office text,\n    flavor text\n);\n\nCOPY ice_cream_survey\nFROM '`C:\\YourDirectory\\`ice_cream_survey.csv'\nWITH (FORMAT CSV, HEADER);\n```", "```\nSELECT *\nFROM ice_cream_survey\nORDER BY response_id\nLIMIT 5;\n```", "```\nresponse_id    office      flavor\n-----------    --------    ----------\n          1    Uptown      Chocolate\n          2    Midtown     Chocolate\n          3    Downtown    Strawberry\n          4    Uptown      Chocolate\n          5    Midtown     Chocolate\n```", "```\nSELECT *\n1 FROM crosstab('SELECT 2 office,\n                      3 flavor,\n                      4 count(*)\n               FROM ice_cream_survey\n               GROUP BY office, flavor\n               ORDER BY office',\n\n            5 'SELECT flavor\n               FROM ice_cream_survey\n               GROUP BY flavor\n               ORDER BY flavor')\n\n6 AS (office text,\n    chocolate bigint,\n    strawberry bigint,\n    vanilla bigint);\n```", "```\noffice      chocolate    strawberry    vanilla\n--------    ---------    ----------    -------\nDowntown           23            32         19\nMidtown            41                       23\nUptown             22            17         23\n```", "```\nCREATE TABLE temperature_readings (\n    station_name text,\n    observation_date date,\n    max_temp integer,\n    min_temp integer,\n    CONSTRAINT temp_key PRIMARY KEY (station_name, observation_date)\n);\n\nCOPY temperature_readings\nFROM '`C:\\YourDirectory\\`temperature_readings.csv'\nWITH (FORMAT CSV, HEADER);\n```", "```\nSELECT *\nFROM crosstab('SELECT\n                1 station_name,\n                2 date_part(''month'', observation_date),\n                3 percentile_cont(.5)\n                      WITHIN GROUP (ORDER BY max_temp)\n               FROM temperature_readings\n               GROUP BY station_name,\n                        date_part(''month'', observation_date)\n               ORDER BY station_name',\n\n              'SELECT month\n               FROM 4 generate_series(1,12) month')\n\nAS (station text,\n    jan numeric(3,0),\n    feb numeric(3,0),\n    mar numeric(3,0),\n    apr numeric(3,0),\n    may numeric(3,0),\n    jun numeric(3,0),\n    jul numeric(3,0),\n    aug numeric(3,0),\n    sep numeric(3,0),\n    oct numeric(3,0),\n    nov numeric(3,0),\n    dec numeric(3,0)\n);\n```", "```\nstation                          jan  feb  mar  apr  may  jun  jul  aug  sep  oct  nov  dec\n------------------------------   ---  ---  ---  ---  ---  ---  ---  ---  ---  ---  ---  ---\nCHICAGO NORTHERLY ISLAND IL US    34   36   46   50   66   77   81   80   77   65   57   35\nSEATTLE BOEING FIELD WA US        50   54   56   64   66   71   76   77   69   62   55   42\nWAIKIKI 717.2 HI US               83   84   84   86   87   87   88   87   87   86   84   82\n```", "```\n1 CASE WHEN `condition` THEN `result`\n   2 WHEN `another_condition` THEN `result`\n   3 ELSE `result`\n4 END\n```", "```\nSELECT max_temp,\n       CASE WHEN max_temp >= 90 THEN 'Hot'\n            WHEN max_temp >= 70 AND max_temp < 90 THEN 'Warm'\n            WHEN max_temp >= 50 AND max_temp < 70 THEN 'Pleasant'\n            WHEN max_temp >= 33 AND max_temp < 50 THEN 'Cold'\n            WHEN max_temp >= 20 AND max_temp < 33 THEN 'Frigid'\n            WHEN max_temp < 20 THEN 'Inhumane'\n            ELSE 'No reading'\n        END AS temperature_group\nFROM temperature_readings\nORDER BY station_name, observation_date;\n```", "```\nmax_temp    temperature_group\n--------    -----------------\n      31    Frigid\n      34    Cold\n      32    Frigid\n      32    Frigid\n      34    Cold\n      `--snip--`\n```", "```\n1 WITH temps_collapsed (station_name, max_temperature_group) AS\n    (SELECT station_name,\n           CASE WHEN max_temp >= 90 THEN 'Hot'\n                WHEN max_temp >= 70 AND max_temp < 90 THEN 'Warm'\n                WHEN max_temp >= 50 AND max_temp < 70 THEN 'Pleasant'\n                WHEN max_temp >= 33 AND max_temp < 50 THEN 'Cold'\n                WHEN max_temp >= 20 AND max_temp < 33 THEN 'Frigid'\n                WHEN max_temp < 20 THEN 'Inhumane'\n                ELSE 'No reading'\n            END\n     FROM temperature_readings)\n\n2 SELECT station_name, max_temperature_group, count(*)\nFROM temps_collapsed\nGROUP BY station_name, max_temperature_group\nORDER BY station_name, count(*) DESC;\n```", "```\nstation_name                      max_temperature_group    count\n------------------------------    ---------------------    -----\nCHICAGO NORTHERLY ISLAND IL US    Warm                       133\nCHICAGO NORTHERLY ISLAND IL US    Cold                        92\nCHICAGO NORTHERLY ISLAND IL US    Pleasant                    91\nCHICAGO NORTHERLY ISLAND IL US    Frigid                      30\nCHICAGO NORTHERLY ISLAND IL US    Inhumane                     8\nCHICAGO NORTHERLY ISLAND IL US    Hot                          8\nSEATTLE BOEING FIELD WA US        Pleasant                   198\nSEATTLE BOEING FIELD WA US        Warm                        98\nSEATTLE BOEING FIELD WA US        Cold                        50\nSEATTLE BOEING FIELD WA US        Hot                          3\nWAIKIKI 717.2 HI US               Warm                       361\nWAIKIKI 717.2 HI US               Hot                          5\n```"]