<html><head></head><body>
<h2 class="h2" id="ch03"><span epub:type="pagebreak" id="page_66"/><span class="num">3</span> The Nine-Pixel Animation Machine</h2>&#13;
<p class="noindent1"><span epub:type="pagebreak" id="page_67"/><span class="red">We use monitors every day, on our phones, computers, tablets, and TVs. The displays on most present-day monitors are composed of millions of <span class="underline">pixels</span>, short for <span class="underline">picture elements</span>. Pixels are tiny points that the computer can light up in different colors; all the pixels together make up the text, images, and videos on the screen.</span></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_68"/>In this project, you’re going to build a simple monitor using LEDs. You’ll expand on your work with blinking LEDs and learn to use custom functions in Arduino. Finally, you’ll learn how to display secret characters on your very own Nine-Pixel Animation Machine. You can see ours in <a href="ch03.xhtml#ch03fig01">Figure 3-1</a>.</p>&#13;
<p class="figuret"><a id="ch03fig01"/><strong>FIGURE 3-1:</strong> A completed Nine-Pixel Animation Machine</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_1.jpg"/></div>&#13;
<p class="indent">You can use the Nine-Pixel Animation Machine to show letters and numbers, draw basic geometric shapes, and make plenty of other fun pixel art.</p>&#13;
<h3 class="h3" id="ch03lev1sec1"><strong>MATERIALS TO GATHER</strong></h3>&#13;
<p class="noindent">For this project, you’ll need a few more electronic components than you used in <a href="ch02.xhtml#ch02">Project 2</a>, specifically more LEDs. This project is simpler in terms of enclosure construction, however. The materials you’ll need are shown in <a href="ch03.xhtml#ch03fig02">Figures 3-2</a> and <a href="ch03.xhtml#ch03fig03">3-3</a>.</p>&#13;
<div class="noter">&#13;
<p class="notet"><strong>NOTE</strong></p>&#13;
<p class="notep"><em>In our project all the LEDs are the same color so the patterns are easier to see, but if you don’t have nine LEDs of the same color, you can mix them up.</em></p>&#13;
</div>&#13;
<h4 class="h4" id="ch03lev2sec1"><strong>Electronic Parts</strong></h4>&#13;
<p class="bull">• One SparkFun RedBoard (DEV-13975), Arduino Uno (DEV-11021), or any other Arduino-compatible board</p>&#13;
<p class="bull">• One USB Mini-B cable (CAB-11301 or your board’s USB cable; not shown)</p>&#13;
<p class="bull">• One solderless breadboard (PRT-12002)</p>&#13;
<p class="bull"><span epub:type="pagebreak" id="page_69"/>• Nine LEDs, preferably of the same color (COM-10049 for a pack of 20 red and yellow LEDs)</p>&#13;
<p class="bull">• Nine 330 Ω resistors (COM-11507 for a pack of 20)</p>&#13;
<p class="bull">• Male-to-male jumper wires (PRT-11026)</p>&#13;
<p class="bull">• Male-to-female jumper wires (PRT-09140*)</p>&#13;
<p class="bull">• (Optional) One 4 AA battery holder (PRT-09835*; not shown)</p>&#13;
<div class="noter">&#13;
<p class="notet"><strong>NOTE</strong></p>&#13;
<p class="notep"><em>The parts marked with an asterisk (*) do not come with the standard SparkFun Inventor’s Kit but are available in the separate add-on kit.</em></p>&#13;
</div>&#13;
<p class="figuret"><a id="ch03fig02"/><strong>FIGURE 3-2:</strong> Components for the Nine-Pixel Animation Machine</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_2.jpg"/></div>&#13;
<h4 class="h4" id="ch03lev2sec2"><strong>Other Materials and Tools</strong></h4>&#13;
<p class="bull">• Pencil</p>&#13;
<p class="bull">• Craft knife</p>&#13;
<p class="bull">• Metal ruler</p>&#13;
<p class="bull">• Wire cutters</p>&#13;
<p class="bull">• Glue (hot glue gun or craft glue)</p>&#13;
<p class="bull">• Graph paper (not shown)</p>&#13;
<p class="bull">• (Optional) Drill and a 3/16-inch drill bit</p>&#13;
<p class="bull">• (Optional) Soldering iron</p>&#13;
<p class="bull">• (Optional) Solder</p>&#13;
<p class="bull">• (Optional) Helping hands (not shown)</p>&#13;
<p class="bull">• Cardboard sheet (roughly 8 × 11 inches, or 20.5 × 30 cm; not shown)</p>&#13;
<p class="bull">• Enclosure template (see <a href="ch03.xhtml#ch03fig13">Figure 3-13</a> on page <a href="ch03.xhtml#page_83">83</a>)</p>&#13;
<p class="figuret"><span epub:type="pagebreak" id="page_70"/><a id="ch03fig03"/><strong>FIGURE 3-3:</strong> Recommended tools</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_3.jpg"/></div>&#13;
<h3 class="h3" id="ch03lev1sec2"><strong>BUILD THE NINE-PIXEL ANIMATION MACHINE PROTOTYPE</strong></h3>&#13;
<p class="noindent">This simple pixel art display will teach you to manage lots of wires in one circuit, which is important as your circuits grow larger. First, you’ll use the breadboard to make sure the circuit works, test a sketch, and get comfortable with all of the jumper wires. (We’ll show you how to transfer the LEDs to a display housing in “<a href="ch03.xhtml#ch03lev2sec6">Cardboard Construction</a>” on page <a href="ch03.xhtml#page_83">83</a>.) Notice that the circuit diagram in <a href="ch03.xhtml#ch03fig04">Figure 3-4</a> looks a lot like <a href="ch02.xhtml#ch02fig06">Figure 2-6</a> on page <a href="ch02.xhtml#page_43">43</a>. That’s because this project uses the same LED circuit, but instead of just three LEDs, it uses nine LEDs, each of which is independently controlled by a pin on the Arduino.</p>&#13;
<p class="figuret"><a id="ch03fig04"/><strong>FIGURE 3-4:</strong> Schematic diagram for the Nine-Pixel Animation Machine</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_4.jpg"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_71"/>In this section, you’ll use the breadboard to connect all nine LEDs to pins on the Arduino. With your components and jumper wires in hand, build the circuit in <a href="ch03.xhtml#ch03fig05">Figure 3-5</a> on your breadboard. If you want to practice building smaller LED circuits first, flip back to “<a href="ch02.xhtml#ch02lev2sec3">Connect the Red LED to the Breadboard</a>” on page <a href="ch02.xhtml#page_44">44</a> for a refresher.</p>&#13;
<p class="figuret"><a id="ch03fig05"/><strong>FIGURE 3-5:</strong> Nine LEDs connected to the Arduino, with the pin 13 LED at the top and the pin 5 LED at the bottom</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_5.jpg"/></div>&#13;
<p class="indent">Wiring up nine LEDs can make for a cluttered breadboard. To keep your breadboard organized, connect the ground rail (–) on the left side of your breadboard to the GND pin on the Arduino first. That’s the black wire in <a href="ch03.xhtml#ch03fig05">Figure 3-5</a>. Then, connect your first LED’s negative leg (the shorter one) to this ground rail through a 330 Ω resistor. In <a href="ch03.xhtml#ch03fig05">Figure 3-5</a>, the long leg of the LED is in row 1, and the shorter leg is in row 2. Finally, connect the long leg of the LED to pin 13 with a jumper wire from pin 13 of the Arduino to row 1 of the breadboard. Connect the other eight LEDs to pins 12 through 5 in the same way. And remember: the LED’s short leg is its negative leg. As you’re building this circuit, make sure that the shorter leg of each LED is connected to the ground rail of the breadboard through a resistor. When you’re done, your circuit should resemble the circuit in <a href="ch03.xhtml#ch03fig06">Figure 3-6</a>.</p>&#13;
<p class="figuret"><span epub:type="pagebreak" id="page_72"/><a id="ch03fig06"/><strong>FIGURE 3-6:</strong> Final prototype circuit of nine LEDs connected to the Arduino, with the pin 13 LED at the top and the pin 5 LED at the bottom</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_6.jpg"/></div>&#13;
<p class="indent">Once you’ve wired the nine LEDs, open the Arduino IDE and plug the Arduino into your computer with the USB cable. If you uploaded a sketch to the Arduino in a previous project, you might see the LEDs light up as it runs the last sketch you uploaded. Now let’s take a look at how you’ll code up all nine of these LEDs.</p>&#13;
<h3 class="h3" id="ch03lev1sec3"><strong>PROGRAM THE NINE-PIXEL ANIMATION MACHINE</strong></h3>&#13;
<p class="noindent">In previous projects, it’s been simple enough to use a bunch of <code>digitalWrite()</code> functions and <code>delay()</code> functions to control LEDs. But with nine LEDs, you’d have a really messy <code>loop()</code> function! Instead, you can write your own <em>custom function</em> to blink a single LED, and then use this function to control all the LEDs.</p>&#13;
<h4 class="h4" id="ch03lev2sec3"><strong>What Are Custom Functions?</strong></h4>&#13;
<p class="noindent">The Arduino language has 60 or so <em>built-in</em> (or predefined) functions that make it easier for you to interact with hardware using simple, single-line instructions. The <code>digitalWrite()</code> and <code>delay()</code> functions are two examples. Behind the scenes, the <code>digitalWrite()</code> function consists of more than 20 lines of code. Most of that code is complex, but the <code>digitalWrite()</code> function is easy to understand.</p>&#13;
<p class="indent">Even when you understand a big sketch, typing 20 or more lines of code each time you want to turn an LED on or off is tedious and error prone. Arduino’s built-in functions cover common tasks, but when you need to do something specific to your sketch, you’ll want <span epub:type="pagebreak" id="page_73"/>to write custom functions. Custom functions allow you to easily reuse code in other sketches, and they’ll make your <code>loop()</code> functions easier to read.</p>&#13;
<h5 class="h5" id="ch03lev3sec1"><strong>Write a Custom Function</strong></h5>&#13;
<p class="noindent">You can use custom functions to teach the Arduino new commands. Your first test function will blink an LED on and then off again, using a modified version of the code in <a href="ch03.xhtml#ch03ex01">Listing 3-1</a>.</p>&#13;
<p class="ex-caption"><a id="ch03ex01"/><strong>LISTING 3-1:</strong> A simple sketch that blinks an LED</p>&#13;
<div class="pre">&#13;
<pre><span class="green">void</span> <span class="green1">setup</span>()<br/>{<br/>  <span class="orange">pinMode</span>(13, <span class="green">OUTPUT</span>);<br/>}<br/><br/><span class="green">void</span> <span class="green1">loop</span>()<br/>{<br/>  <span class="orange">digitalWrite</span>(13, <span class="green">HIGH</span>);<br/>  <span class="orange">delay</span>(1000);<br/>  <span class="orange">digitalWrite</span>(13, <span class="green">LOW</span>);<br/>  <span class="orange">delay</span>(1000);<br/>}</pre>&#13;
</div>&#13;
<p class="indent">This code should look similar to the Blink example from <a href="ch01.xhtml#ch01">Project 1</a> (<a href="ch01.xhtml#ch01ex01">Listing 1-1</a> on page <a href="ch01.xhtml#page_28">28</a>). However, here we are using pin 13 explicitly instead of using the <code>LED_BUILTIN</code> system constant. This code turns the LED on, waits for a second, turns the LED off again, and then waits for another second before repeating. You’ll need to do this a lot in later projects, so we’ll show you how to put this code in a custom <code>blink()</code> function. To make your custom function as useful as possible, you’ll write it in a way that allows you to use any pin for any delay time.</p>&#13;
<p class="indent">First, open a new sketch, copy the code from <a href="ch03.xhtml#ch03ex01">Listing 3-1</a> into it, and save it. Then, define the <code>blink()</code> function below your <code>setup()</code> and <code>loop()</code> functions, as shown in <a href="ch03.xhtml#ch03ex02">Listing 3-2</a>.</p>&#13;
<p class="ex-caption"><a id="ch03ex02"/><strong>LISTING 3-2:</strong> A skeleton for a custom <code>blink()</code> function</p>&#13;
<div class="pre">&#13;
<pre><span class="ent">➊</span><span class="green">void</span> <span class="ent">➋</span><span class="orange">blink</span>(<span class="ent">➌</span><span class="green">int</span> pinNumber, <span class="green">int</span> delayTime)<br/>{<br/>  <span class="ash">//custom function code goes here</span><br/>}</pre>&#13;
</div>&#13;
<p class="indent">This is just the skeleton of the function. Function definitions always specify the data type that the function will return first <span class="ent">➊</span>. The <code>blink()</code> function asks the Arduino to perform a task without expecting any data back, so, just like the <code>setup()</code> and <code>loop()</code> functions, its data type is <code>void</code>.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_74"/>Next comes the function’s name <span class="ent">➋</span>, which in this case is <code>blink</code>. You can name Arduino functions almost anything you want, but they can’t start with a number or include any spaces or special characters. Also, to make sure the function’s purpose is clear when you’re reading over your sketch, we recommend using a name that’s descriptive and easy to remember.</p>&#13;
<p class="indent">After naming the function, define any parameters the function needs to work in parentheses <span class="ent">➌</span>. To make <code>blink()</code> as reusable as possible, provide a pin number and a delay time as parameters. These allow you to specify which LED to blink and for how long. Each of the <code>blink()</code> function’s parameters is an <code>int</code>. Notice that defining parameters is similar to declaring variables. That’s because parameters are basically variables that can only be used inside the function.</p>&#13;
<p class="indent">Finally, a custom function has its own set of curly brackets, which enclose all of the code you want a call to the function to represent. For the <code>blink()</code> function, this is the set of <code>digitalWrite()</code> and <code>delay()</code> functions from <a href="ch03.xhtml#ch03ex01">Listing 3-1</a>, as shown in <a href="ch03.xhtml#ch03ex03">Listing 3-3</a>. Add the code inside the curly brackets to your <code>blink()</code> function now.</p>&#13;
<p class="ex-caption"><a id="ch03ex03"/><strong>LISTING 3-3:</strong> Custom <code>blink()</code> function</p>&#13;
<div class="pre">&#13;
<pre><span class="green">void</span> <span class="orange">blink</span>(<span class="green">int</span> pinNumber, <span class="green">int</span> delayTime)<br/>{<br/>  <span class="orange">digitalWrite</span>(pinNumber, <span class="green">HIGH</span>);<br/>  <span class="orange">delay</span>(delayTime);<br/>  <span class="orange">digitalWrite</span>(pinNumber, <span class="green">LOW</span>);<br/>  <span class="orange">delay</span>(delayTime);<br/>}</pre>&#13;
</div>&#13;
<p class="indent">Notice that in the <code>digitalWrite()</code> and <code>delay()</code> function calls, the <code>blink()</code> function replaces the pin number <code>13</code> and the delay of <code>1000</code> ms with the <code>pinNumber</code> and <code>delayTime</code> parameters, respectively.</p>&#13;
<h5 class="h5" id="ch03lev3sec2"><strong>Use a Custom Function</strong></h5>&#13;
<p class="noindent">Now you can use your custom function in place of the code in your <code>loop()</code> function, as in <a href="ch03.xhtml#ch03ex04">Listing 3-4</a>.</p>&#13;
<p class="ex-caption"><a id="ch03ex04"/><strong>LISTING 3-4:</strong> Complete sketch using the new custom <code>blink()</code> function</p>&#13;
<div class="pre">&#13;
<pre><span class="green">void</span> <span class="green1">setup</span>()<br/>{<br/>  <span class="orange">pinMode</span>(13, <span class="green">OUTPUT</span>);<br/>}<br/><br/><span class="green">void</span> <span class="green1">loop</span>()<br/>{<br/>  <span class="orange">blink</span>(13, 1000);<br/>}<br/><span epub:type="pagebreak" id="page_75"/><br/><span class="green">void</span> <span class="orange">blink</span>(<span class="green">int</span> pinNumber, <span class="green">int</span> delayTime)<br/>{<br/>  <span class="orange">digitalWrite</span>(pinNumber, <span class="green">HIGH</span>);<br/>  <span class="orange">delay</span>(delayTime);<br/>  <span class="orange">digitalWrite</span>(pinNumber, <span class="green">LOW</span>);<br/>  <span class="orange">delay</span>(delayTime);<br/>}</pre>&#13;
</div>&#13;
<p class="indent">The modified <code>loop()</code> function calls the <code>blink()</code> function and passes it the pin number of the LED to blink (<code>13</code>) and the amount of time the light should stay on or off, in milliseconds (we suggest using <code>1000</code>, for 1 second). That’s it! Doesn’t this code look a lot cleaner and clearer?</p>&#13;
<p class="indent">Upload this sketch to your Arduino, and the LED on pin 13 should blink. Congratulations! You just “taught” the Arduino what <code>blink()</code> means, and you condensed four lines of code into a single instruction.</p>&#13;
<p class="indent">But custom functions are just one key to this project. You’ll also want to plan some nine-pixel patterns ahead of time to make them easier to program, so let’s do that now.</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart"><strong>TRY IT OUT: PLAY WITH PATTERNS</strong></p>&#13;
<p class="noindent">Before you finish the Nine-Pixel Animation Machine, spend some quality time with your more powerful <code>blink()</code> sketch. For example, change your <code>loop()</code> function as follows:</p>&#13;
<div class="pre">&#13;
<pre><span class="green">void</span> <span class="green1">loop</span>()<br/>{<br/> <span class="orange">blink</span>(13, 100);   <span class="ash">//short 100 ms blink on pin 13</span><br/> <span class="orange">blink</span>(13, 2000);  <span class="ash">//longer 2000 ms blink on pin 13</span><br/>}</pre>&#13;
</div>&#13;
<p class="indent">This makes the LED blink for 100 ms, followed by a longer blink of 2,000 ms. Try blinking the other LEDs to create your own patterns and sequences!</p>&#13;
</div>&#13;
<h4 class="h4" id="ch03lev2sec4"><strong>Design Your Artwork</strong></h4>&#13;
<p class="noindent">Grab colored pencils and graph paper, and put on your artist’s hat! You’re going to make some pixel art to display on the Nine-Pixel Animation Machine.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_76"/>Start by drawing several 3 × 3 grids, or print out a copy of the template shown in <a href="ch03.xhtml#ch03fig07">Figure 3-7</a>, which you’ll find in this book’s resource files. These drawings don’t have to be perfect; you’re just sketching out a few ideas.</p>&#13;
<p class="figuret"><a id="ch03fig07"/><strong>FIGURE 3-7:</strong> Blank grid planning template</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_7.jpg"/></div>&#13;
<p class="indent">We numbered the pixels with 13 in the upper-left corner and 5 in the lower-right corner. These numbers correspond to the LED pin numbers on the Arduino; this is how you’ll control the LEDs in the Nine-Pixel Animation Machine. When your canvas is ready, get creative: fill in the pixels to make your own patterns. <a href="ch03.xhtml#ch03fig08">Figure 3-8</a> shows some examples that we came up with during a department meeting . . . don’t tell our boss!</p>&#13;
<p class="figuret"><a id="ch03fig08"/><strong>FIGURE 3-8:</strong> Some pixel pattern examples</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_8.jpg"/></div>&#13;
<p class="indent">When you show these patterns and shapes in sequence, you can create animations! First, we’ll teach you to program two simple shapes, and then we’ll tackle a complete animation.</p>&#13;
<h4 class="h4" id="ch03lev2sec5"><strong>The Test Sketch</strong></h4>&#13;
<p class="noindent">Create a new sketch in the Arduino IDE, and add the <code>setup()</code> and <code>loop()</code> functions in <a href="ch03.xhtml#ch03ex05">Listing 3-5</a>.</p>&#13;
<p class="ex-caption"><span epub:type="pagebreak" id="page_77"/><a id="ch03ex05"/><strong>LISTING 3-5:</strong> <code>setup()</code> function for the Nine-Pixel Animation Machine</p>&#13;
<div class="pre">&#13;
<pre><span class="ash">//LED array is set up in this arrangement:</span><br/><span class="ash">//  13 ---- 12 ---- 11</span><br/><span class="ash">//  10 ----  9 ----- 8</span><br/><span class="ash">//   7 ----  6 ----- 5</span><br/><br/><span class="green">void</span> <span class="green1">setup</span>()<br/>{<br/>  <span class="orange">pinMode</span>(13, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(12, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(11, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(10, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(9, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(8, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(7, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(6, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(5, <span class="green">OUTPUT</span>);<br/>}<br/><br/><span class="green">void</span> <span class="green1">loop</span>()<br/>{<br/>}</pre>&#13;
</div>&#13;
<div class="noter">&#13;
<p class="notet"><strong>NOTE</strong></p>&#13;
<p class="notep"><em>We also suggest adding a comment with a diagram of the LED placement. Describing the circuit you’re writing code for in the sketch will help others re-create it and will remind you of the structure you’re working with as you develop your code.</em></p>&#13;
</div>&#13;
<p class="indent">This project uses nine LEDs on nine digital GPIO pins (13 through 5), so this <code>setup()</code> function has nine <code>pinMode()</code> functions. They’re all set as <code>OUTPUT</code> since they’re controlling LEDs.</p>&#13;
<h5 class="h5" id="ch03lev3sec3"><strong>Write a Function to Draw an X</strong></h5>&#13;
<p class="noindent">With the <code>pinMode()</code> functions in place, look at the shapes you drew by hand and pay attention to the numbers; they’ll help you write your custom function. <a href="ch03.xhtml#ch03fig09">Figure 3-9</a> shows an example to test with—a simple <em>X</em> pattern.</p>&#13;
<p class="figuret"><a id="ch03fig09"/><strong>FIGURE 3-9:</strong> A nine-pixel <em>X</em></p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_9.jpg"/></div>&#13;
<p class="indent">The <em>X</em> pattern in <a href="ch03.xhtml#ch03fig09">Figure 3-9</a> translates to the set of <code>digitalWrite()</code> functions in <a href="ch03.xhtml#ch03ex06">Listing 3-6</a>.</p>&#13;
<p class="ex-caption"><span epub:type="pagebreak" id="page_78"/><a id="ch03ex06"/><strong>LISTING 3-6:</strong> Code for displaying an <em>X</em> on the nine LEDs</p>&#13;
<div class="pre">&#13;
<pre><span class="orange">digitalWrite</span>(13, <span class="green">HIGH</span>);<br/><span class="orange">digitalWrite</span>(12, <span class="green">LOW</span>);<br/><span class="orange">digitalWrite</span>(11, <span class="green">HIGH</span>);<br/><br/><span class="orange">digitalWrite</span>(10, <span class="green">LOW</span>);<br/><span class="orange">digitalWrite</span>(9, <span class="green">HIGH</span>);<br/><span class="orange">digitalWrite</span>(8, <span class="green">LOW</span>);<br/><br/><span class="orange">digitalWrite</span>(7, <span class="green">HIGH</span>);<br/><span class="orange">digitalWrite</span>(6, <span class="green">LOW</span>);<br/><span class="orange">digitalWrite</span>(5, <span class="green">HIGH</span>);</pre>&#13;
</div>&#13;
<p class="indent">These <code>digitalWrite()</code> function calls turn on only the LEDs on the grid’s diagonals and turn off the rest. But drawing a single <em>X</em> takes nine lines of code! Instead of writing all of this out by hand every time, you can create a custom function to execute all of these calls with just one line of code.</p>&#13;
<p class="indent">Below the curly brackets of the <code>loop()</code> function, create a custom function named <code>xChar()</code> with the code in <a href="ch03.xhtml#ch03ex07">Listing 3-7</a>.</p>&#13;
<p class="ex-caption"><a id="ch03ex07"/><strong>LISTING 3-7:</strong> The <code>xChar()</code> custom function</p>&#13;
<div class="pre">&#13;
<pre><span class="green">void</span> xChar()<br/>{<br/>  <span class="orange">digitalWrite</span>(13, <span class="green">HIGH</span>);<br/>  <span class="orange">digitalWrite</span>(12, <span class="green">LOW</span>);<br/>  <span class="orange">digitalWrite</span>(11, <span class="green">HIGH</span>);<br/><br/>  <span class="orange">digitalWrite</span>(10, <span class="green">LOW</span>);<br/>  <span class="orange">digitalWrite</span>(9, <span class="green">HIGH</span>);<br/>  <span class="orange">digitalWrite</span>(8, <span class="green">LOW</span>);<br/><br/>  <span class="orange">digitalWrite</span>(7, <span class="green">HIGH</span>);<br/>  <span class="orange">digitalWrite</span>(6, <span class="green">LOW</span>);<br/>  <span class="orange">digitalWrite</span>(5, <span class="green">HIGH</span>);<br/>}</pre>&#13;
</div>&#13;
<p class="indent">We named this custom function <code>xChar()</code> because it displays an <em>X</em> character. This function won’t return anything, so its data type is <code>void</code>. Since the <code>digitalWrite()</code> calls from <a href="ch03.xhtml#ch03ex06">Listing 3-6</a> are inside this single custom function, you can keep your <code>loop()</code> code simple. Call the function <code>xChar()</code> inside your existing <code>loop()</code>, as shown in Listing 3-8.</p>&#13;
<p class="ex-caption"><a id="ch03ex08"/><strong>LISTING 3-8:</strong> <code>loop()</code> function with <code>xChar()</code> function call</p>&#13;
<div class="pre">&#13;
<pre><span class="orange">void</span> <span class="green1">loop</span>()<br/>{<br/>  xChar();<br/>}</pre>&#13;
</div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_79"/>This is a small step, but it’s very important. If you forget to actually call your custom function, its code will never run, and you’ll never display your <em>X</em>.</p>&#13;
<p class="indent">Upload this sketch to your Arduino now. Your LEDs are still in a vertical line rather than a grid, but your sketch can still help you test that you’ve got everything wired and coded correctly. Instead of an <em>X</em>, you should see every other LED turn on, starting at the top, as shown in <a href="ch03.xhtml#ch03fig10">Figure 3-10</a>. If the LEDs don’t light up as expected, double-check your wiring against the diagram in <a href="ch03.xhtml#ch03fig05">Figure 3-5</a> on page <a href="ch03.xhtml#page_71">71</a>, and check your <code>digitalWrite()</code> functions to make sure they’re all correct as well.</p>&#13;
<p class="indent">When you can see the right pattern, read on to create a second character.</p>&#13;
<p class="figuret"><a id="ch03fig10"/><strong>FIGURE 3-10:</strong> Prototype and correct sequence for an <em>X</em></p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_10.jpg"/></div>&#13;
<h5 class="h5" id="ch03lev3sec4"><strong>Write a Function to Draw an O</strong></h5>&#13;
<p class="noindent">Next, you’ll create an <em>O</em> like the one in <a href="ch03.xhtml#ch03fig11">Figure 3-11</a> to go with the <em>X</em>.</p>&#13;
<p class="figuret"><a id="ch03fig11"/><strong>FIGURE 3-11:</strong> A nine-pixel <em>O</em></p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_11.jpg"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_80"/>Pro tip: you can work smarter rather than harder here. Copy the entire <code>xChar()</code> function, paste the copy after the last curly bracket in <code>xChar()</code>, change its name to <code>oChar()</code>, and tweak it to look like Listing 3-9.</p>&#13;
<p class="ex-caption"><a id="ch03ex09"/><strong>LISTING 3-9:</strong> The <code>oChar()</code> custom function</p>&#13;
<div class="pre">&#13;
<pre><span class="green">void</span> oChar()<br/>{<br/>  <span class="orange">digitalWrite</span>(13, <span class="green">HIGH</span>);<br/>  <span class="orange">digitalWrite</span>(12, <span class="green">HIGH</span>);<br/>  <span class="orange">digitalWrite</span>(11, <span class="green">HIGH</span>);<br/><br/>  <span class="orange">digitalWrite</span>(10, <span class="green">HIGH</span>);<br/>  <span class="orange">digitalWrite</span>(9, <span class="green">LOW</span>);<br/>  <span class="orange">digitalWrite</span>(8, <span class="green">HIGH</span>);<br/><br/>  <span class="orange">digitalWrite</span>(7, <span class="green">HIGH</span>);<br/>  <span class="orange">digitalWrite</span>(6, <span class="green">HIGH</span>);<br/>  <span class="orange">digitalWrite</span>(5, <span class="green">HIGH</span>);<br/>}</pre>&#13;
</div>&#13;
<p class="indent">The only difference between <code>xChar()</code> and <code>oChar()</code> is which LEDs are turned on and which are turned off. Whereas <code>xChar()</code> turns on alternating LEDs, <code>oChar()</code> turns on every LED except the center one.</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart"><strong>TRY IT OUT: WRITE A CUSTOM FUNCTION FOR YOUR OWN IMAGE</strong></p>&#13;
<p class="noindent">We showed you how to write functions to draw an <em>X</em> and an <em>O</em>, but we’re sure you have your own lovely pixel art images in mind. Create a function that will blink out the patterns you made, and hang on to it for when you’re done building the Nine-Pixel Animation Machine.</p>&#13;
</div>&#13;
<h5 class="h5" id="ch03lev3sec5"><strong>Display the X and the O</strong></h5>&#13;
<p class="noindent">The goal now is to show an <em>X</em> character for a bit, then show an <em>O</em> character, and finally go back to the <em>X</em>. To show each character for a set time, you can add the <code>oChar()</code> function to your existing loop and slow the loop down with <code>delay()</code> calls. Update your sketch so that it looks like <a href="ch03.xhtml#ch03ex010">Listing 3-10</a>.</p>&#13;
<p class="ex-caption"><span epub:type="pagebreak" id="page_81"/><a id="ch03ex010"/><strong>LISTING 3-10:</strong> The <code>loop()</code> looks similar to the one in the Blink sketch but uses <code>xChar()</code> and <code>oChar()</code> instead of <code>digitalWrite()</code>.</p>&#13;
<div class="pre">&#13;
<pre><span class="ash">//LED array is set up in this arrangement:</span><br/><span class="ash">//  13 ---- 12 ---- 11</span><br/><span class="ash">//  10 ----  9 ----- 8</span><br/><span class="ash">//   7 ----  6 ----- 5</span><br/><br/><span class="green">void</span> <span class="green1">setup</span>()<br/>{<br/>  <span class="orange">pinMode</span>(13, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(12, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(11, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(10, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(9, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(8, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(7, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(6, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(5, <span class="green">OUTPUT</span>);<br/>}<br/><br/><span class="green">void</span> <span class="green1">loop</span>()<br/>{<br/>  <span class="ash">//blink between x and o characters</span><br/>  xChar();<br/>  <span class="orange">delay</span>(500);<br/>  oChar();<br/>  <span class="orange">delay</span>(500);<br/>}<br/><br/><span class="green">void</span> xChar()<br/>{<br/>  <span class="orange">digitalWrite</span>(13, <span class="green">HIGH</span>);<br/>  <span class="orange">digitalWrite</span>(12, <span class="green">LOW</span>);<br/>  <span class="orange">digitalWrite</span>(11, <span class="green">HIGH</span>);<br/><br/>  <span class="orange">digitalWrite</span>(10, <span class="green">LOW</span>);<br/>  <span class="orange">digitalWrite</span>(9, <span class="green">HIGH</span>);<br/>  <span class="orange">digitalWrite</span>(8, <span class="green">LOW</span>);<br/><br/>  <span class="orange">digitalWrite</span>(7, <span class="green">HIGH</span>);<br/>  <span class="orange">digitalWrite</span>(6, <span class="green">LOW</span>);<br/>  <span class="orange">digitalWrite</span>(5, <span class="green">HIGH</span>);<br/>}<br/><br/><span class="green">void</span> oChar()<br/>{<br/>  <span class="orange">digitalWrite</span>(13, <span class="green">HIGH</span>);<br/>  <span class="orange">digitalWrite</span>(12, <span class="green">HIGH</span>);<br/>  <span class="orange">digitalWrite</span>(11, <span class="green">HIGH</span>);<br/><span epub:type="pagebreak" id="page_82"/><br/>  <span class="orange">digitalWrite</span>(10, <span class="green">HIGH</span>);<br/>  <span class="orange">digitalWrite</span>(9, <span class="green">LOW</span>);<br/>  <span class="orange">digitalWrite</span>(8, <span class="green">HIGH</span>);<br/><br/>  <span class="orange">digitalWrite</span>(7, <span class="green">HIGH</span>);<br/>  <span class="orange">digitalWrite</span>(6, <span class="green">HIGH</span>);<br/>  <span class="orange">digitalWrite</span>(5, <span class="green">HIGH</span>);<br/>}</pre>&#13;
</div>&#13;
<p class="indent">This loop displays an <em>X</em> for 500 ms and then switches to an <em>O</em> for 500 ms. Upload the updated sketch to your Arduino, and run it to see how it works. Every LED except the middle one lights up when <code>oChar()</code> is called. <a href="ch03.xhtml#ch03fig12">Figure 3-12</a> shows what you’ll see as the LEDs blink.</p>&#13;
<p class="figuret"><a id="ch03fig12"/><strong>FIGURE 3-12:</strong> Switching between two patterns</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_12.jpg"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_83"/>Save your sketch now, because you’ll build on it later. But as long as the LEDs in this circuit are on the breadboard, they won’t display any recognizable picture. So next, we’ll show you how to make the display to see the Nine-Pixel Animation Machine in all its tiny glory.</p>&#13;
<h3 class="h3" id="ch03lev1sec4"><strong>BUILD THE NINE-PIXEL ANIMATION MACHINE ENCLOSURE</strong></h3>&#13;
<p class="noindent">The enclosure for this project is simply a cardboard display with holes for LEDs. There’s wiring to do as well, but once that’s done, you’ll be able to make all kinds of pixel art.</p>&#13;
<h4 class="h4" id="ch03lev2sec6"><strong>Cardboard Construction</strong></h4>&#13;
<p class="noindent">Find a sheet of cardboard that is clean and free of creases and bends. Our designs are based around cardboard about 1/8 inch thick, but you can use any similar board or panel materials. Some materials will be easier to cut than others, so pick yours based on the tools you have.</p>&#13;
<h5 class="h5" id="ch03lev3sec6"><strong>Cut Out the Parts</strong></h5>&#13;
<p class="noindent">Open the template shown in <a href="ch03.xhtml#ch03fig13">Figure 3-13</a> in this book’s resource files (<em><a href="https://www.nostarch.com/arduinoinventor/">https://www.nostarch.com/arduinoinventor/</a></em>) and trace it onto your cardboard. Try to line your templates up with the edge of the cardboard to make cutting easier.</p>&#13;
<p class="figuret"><a id="ch03fig13"/><strong>FIGURE 3-13:</strong> Enclosure template for the Nine-Pixel Animation Machine (not full size)</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_13.jpg"/></div>&#13;
<p class="indent">Once you’ve traced your pieces, cut them out. We highly recommend using a sharp craft knife and a metal ruler to get clean edges for your project. Remember craft knife safety: always pull (don’t push) the blade, and make multiple passes rather than digging in deeply on your first go.</p>&#13;
<p class="indent">After cutting your cardboard parts, make the LED holes in the front piece. You can drill them as shown in <a href="ch03.xhtml#ch03fig14">Figure 3-14</a>, punch them <span epub:type="pagebreak" id="page_84"/>with a hole punch, or even poke them out with a pencil. Just be sure to have a free LED on hand to test the size of each hole for a snug fit. If the holes are a little too large and you don’t mind making the LEDs a permanent feature of the project, you can hot glue them in.</p>&#13;
<p class="figuret"><a id="ch03fig14"/><strong>FIGURE 3-14:</strong> Drilling holes for LEDs. Use caution when drilling or ask an adult for help.</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_14.jpg"/></div>&#13;
<p class="indent">You should have four pieces cut out, as shown in <a href="ch03.xhtml#ch03fig15">Figure 3-15</a>. The base has the big hole in the middle; use its center piece to cut out two triangles to use as support braces. These triangles have tabs that fit into slots connecting the bottom piece to the front. Before assembling the parts, however, add labels so that you can keep your LEDs straight when you wire up your circuit.</p>&#13;
<p class="figuret"><a id="ch03fig15"/><strong>FIGURE 3-15:</strong> Cardboard pieces for the enclosure</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_15.jpg"/></div>&#13;
<h5 class="h5" id="ch03lev3sec7"><span epub:type="pagebreak" id="page_85"/><strong>Label the LED Holes</strong></h5>&#13;
<p class="noindent">Flip the front cardboard piece over, and number the LEDs so you have a connection guide. Start with pin 13 in the top right and count down as you go left, as shown in <a href="ch03.xhtml#ch03fig16">Figure 3-16</a>. You should finish with 5 in the lower-left corner.</p>&#13;
<p class="figuret"><a id="ch03fig16"/><strong>FIGURE 3-16:</strong> Labeling the back side of the LED grid</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_16.jpg"/></div>&#13;
<h5 class="h5" id="ch03lev3sec8"><strong>Add the LEDs</strong></h5>&#13;
<p class="noindent">With the cardboard flat, insert the nine LEDs through from the back side. You can reuse the LEDs from your breadboard prototype or grab new ones. As you insert the LEDs, keep them aligned with the long leg on the right side to make things easier when you start wiring them to the Arduino again. You want the LEDs to fit snugly, as shown in <a href="ch03.xhtml#ch03fig17">Figure 3-17</a>. If the hole is too big, you can add a dab of hot glue to secure it (but, again, keep in mind that you won’t be able to reuse the LEDs afterward).</p>&#13;
<p class="figuret"><a id="ch03fig17"/><strong>FIGURE 3-17:</strong> Inserting the LEDs</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_17.jpg"/></div>&#13;
<h5 class="h5" id="ch03lev3sec9"><span epub:type="pagebreak" id="page_86"/><strong>Assemble the Parts</strong></h5>&#13;
<p class="noindent">Now, gather the four pieces of cardboard to be assembled. You’ll probably need craft glue or a hot glue gun to secure all of the pieces together.</p>&#13;
<p class="indent">First, glue one of the triangles to the base to support the front plate, as shown in <a href="ch03.xhtml#ch03fig18">Figure 3-18</a>. See <a href="ch03.xhtml#ch03fig19">Figure 3-19</a> for the orientation of the support triangles. Repeat this process for the other triangle piece. Give the glue some time to dry before moving on.</p>&#13;
<p class="figuret"><a id="ch03fig18"/><strong>FIGURE 3-18:</strong> Adding support triangles to the base</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_18.jpg"/></div>&#13;
<p class="indent">With the support triangles in place, glue the front to the base. The front should fit snugly onto the tabs of the support triangles and sit on top of the base cardboard, as shown in <a href="ch03.xhtml#ch03fig19">Figure 3-19</a>. For extra strength, you may also want to add hot glue along the inside edges where the front plate connects to the base and support triangles.</p>&#13;
<p class="figuret"><a id="ch03fig19"/><strong>FIGURE 3-19:</strong> Adding the final piece of the project—the front</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_19.jpg"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_87"/>With the cardboard construction part of this project done, it’s time to wire the circuit.</p>&#13;
<h4 class="h4" id="ch03lev2sec7"><strong>Connect the Electronics</strong></h4>&#13;
<p class="noindent">There are a lot of wires in this project, so we’ll take it one step at a time. You’ll reuse the breadboard prototype circuit you built earlier in this chapter and simply use jumper wires to connect the nine LEDs to the Arduino.</p>&#13;
<p class="indent">There are two ways to approach this part of the project: the nonpermanent way, which uses male-to-female jumper wires, and the permanent way, which involves soldering. We’ll cover the nonpermanent approach, but if you do want to solder the LEDs to jumper wires, refer to “<a href="app01.xhtml#app01lev1sec2">How to Solder</a>” on page <a href="app01.xhtml#page_302">302</a> for a brief lesson before you attempt that.</p>&#13;
<p class="indent">If the LED legs are too long, you can snip them before attaching the jumper wires, but pay attention to which leg is positive (the long leg) and which is negative. Leave the positive leg a little longer so that you can still tell which leg is which; you could also draw a dot on the back of the box. Be sure to wear eye protection, too—when you’re trimming the legs, the little wire pieces can fly up in the air and toward your eyes!</p>&#13;
<p class="indent">Connect the female end of each jumper wire to one of the nine LEDs on the front plate. To keep things organized, use black wires to designate the negative side, and connect these to the shorter leg of the LED, as shown in <a href="ch03.xhtml#ch03fig20">Figure 3-20</a>. You can use any color for the positive side of each LED.</p>&#13;
<p class="figuret"><a id="ch03fig20"/><strong>FIGURE 3-20:</strong> Connecting the LEDs with male-to-female jumper wires</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_20.jpg"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_88"/>Once all nine LEDs are connected to male-to-female wires, connect the other end of each jumper wire to the breadboard, following the pin labels on the back side of your project. If you left the LEDs in the breadboard, remove those first, and simply plug the jumper wires into them as shown in <a href="ch03.xhtml#ch03fig21">Figure 3-21</a>.</p>&#13;
<p class="figuret"><a id="ch03fig21"/><strong>FIGURE 3-21:</strong> Nine LEDs connected to the breadboard with male-to-female jumper wires</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_21.jpg"/></div>&#13;
<p class="indent">Each wire connected to the negative leg of an LED (each black wire) connects to a resistor that is connected to the ground rail. Each positive wire connects to the Arduino pin written on the back of your LED array.</p>&#13;
<p class="indent">Once you’ve added all nine LEDs to the front of your display and completed your wiring, plug your Arduino into your computer with a USB cable. If everything is wired correctly, your display will show an alternating <em>X</em> and <em>O</em> pattern. If you have a battery pack, you can connect it as shown in <a href="ch03.xhtml#ch03fig22">Figure 3-22</a>.</p>&#13;
<p class="indent">If the test images don’t show properly, double-check that the LEDs are plugged into the correct Arduino pins. When you see the correct patterns, take a moment to bask in the glory of your new pixel art display, but don’t stop here! When you’re ready, try making a more complicated animation.</p>&#13;
<p class="figuret"><span epub:type="pagebreak" id="page_89"/><a id="ch03fig22"/><strong>FIGURE 3-22:</strong> The final display with cycling <em>X</em> and <em>O</em> characters</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_22.jpg"/></div>&#13;
<h3 class="h3" id="ch03lev1sec5"><strong>CREATE AN LED ANIMATION</strong></h3>&#13;
<p class="noindent">Your monitor can display any image you can draw on a 3×3 grid. An animation is just a series of images shown sequentially, so if you show a bunch of 3×3 images in a row, you’ll have a pixel art animation. We’ll show you how to design and display a spinning line.</p>&#13;
<h4 class="h4" id="ch03lev2sec8"><strong>Plan the Animation Sequence</strong></h4>&#13;
<p class="noindent">Let’s begin by translating a spinning line into a series of images. We started with a vertical line and rotated it around the display in four separate images, as shown in <a href="ch03.xhtml#ch03fig23">Figure 3-23</a>.</p>&#13;
<p class="figuret"><a id="ch03fig23"/><strong>FIGURE 3-23:</strong> Image progression of a spinning line</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_23.jpg"/></div>&#13;
<p class="indent">Save your program from <a href="ch03.xhtml#ch03ex010">Listing 3-10</a>, and then create a new sketch. Add the <code>setup()</code> and <code>loop()</code> functions in <a href="ch03.xhtml#ch03ex011">Listing 3-11</a>.</p>&#13;
<p class="ex-caption"><a id="ch03ex011"/><strong>LISTING 3-11:</strong> The <code>setup()</code> code for all nine LEDs</p>&#13;
<div class="pre">&#13;
<pre><span class="green">void</span> <span class="green1">setup</span>()<br/>{<br/>  <span class="orange">pinMode</span>(13, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(12, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(11, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(10, <span class="green">OUTPUT</span>);<br/><span epub:type="pagebreak" id="page_90"/>  <span class="orange">pinMode</span>(9, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(8, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(7, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(6, <span class="green">OUTPUT</span>);<br/>  <span class="orange">pinMode</span>(5, <span class="green">OUTPUT</span>);<br/>}<br/><br/><span class="green">void</span> <span class="green1">loop</span>()<br/>{<br/>  <span class="ash">//animation function call will go here</span><br/>}<br/><br/><span class="ash">//custom functions to show frames will go here</span></pre>&#13;
</div>&#13;
<p class="indent">Since you’re using the same LEDs you were in the <em>X</em> and <em>O</em> sketch, you can just copy the code from there into your new sketch.</p>&#13;
<h4 class="h4" id="ch03lev2sec9"><strong>Write Custom Functions</strong></h4>&#13;
<p class="noindent">Now, create a custom function for each image of your animation. This animation has four frames, so you’ll need four functions. Add the functions in <a href="ch03.xhtml#ch03ex012">Listing 3-12</a> to your sketch, after the closing bracket in the <code>loop()</code> function.</p>&#13;
<p class="ex-caption"><a id="ch03ex012"/><strong>LISTING 3-12:</strong> Custom functions to draw a spinning line</p>&#13;
<div class="pre">&#13;
<pre><span class="ent">➊</span> <span class="green">void</span> verticalLine()<br/>  {<br/>    <span class="orange">digitalWrite</span>(13, <span class="green">LOW</span>);<br/>    <span class="orange">digitalWrite</span>(12, <span class="green">HIGH</span>);<br/>    <span class="orange">digitalWrite</span>(11, <span class="green">LOW</span>);<br/><br/>    <span class="orange">digitalWrite</span>(10, <span class="green">LOW</span>);<br/>    <span class="orange">digitalWrite</span>(9, <span class="green">HIGH</span>);<br/>    <span class="orange">digitalWrite</span>(8, <span class="green">LOW</span>);<br/><br/>    <span class="orange">digitalWrite</span>(7, <span class="green">LOW</span>);<br/>    <span class="orange">digitalWrite</span>(6, <span class="green">HIGH</span>);<br/>    <span class="orange">digitalWrite</span>(5, <span class="green">LOW</span>);<br/>  }<br/><br/><span class="ent">➋</span> <span class="green">void</span> topLeftDiagonal()<br/>  {<br/>    <span class="orange">digitalWrite</span>(13, <span class="green">HIGH</span>);<br/>    <span class="orange">digitalWrite</span>(12, <span class="green">LOW</span>);<br/>    <span class="orange">digitalWrite</span>(11, <span class="green">LOW</span>);<br/><br/>    <span class="orange">digitalWrite</span>(10, <span class="green">LOW</span>);<br/>    <span class="orange">digitalWrite</span>(9, <span class="green">HIGH</span>);<br/>    <span class="orange">digitalWrite</span>(8, <span class="green">LOW</span>);<br/><span epub:type="pagebreak" id="page_91"/><br/>    <span class="orange">digitalWrite</span>(7, <span class="green">LOW</span>);<br/>    <span class="orange">digitalWrite</span>(6, <span class="green">LOW</span>);<br/>    <span class="orange">digitalWrite</span>(5, <span class="green">HIGH</span>);<br/>  }<br/><br/><span class="ent">➌</span> <span class="green">void</span> horizontalLine()<br/>  {<br/>    <span class="orange">digitalWrite</span>(13, <span class="green">LOW</span>);<br/>    <span class="orange">digitalWrite</span>(12, <span class="green">LOW</span>);<br/>    <span class="orange">digitalWrite</span>(11, <span class="green">LOW</span>);<br/><br/>    <span class="orange">digitalWrite</span>(10, <span class="green">HIGH</span>);<br/>    <span class="orange">digitalWrite</span>(9, <span class="green">HIGH</span>);<br/>    <span class="orange">digitalWrite</span>(8, <span class="green">HIGH</span>);<br/><br/>    <span class="orange">digitalWrite</span>(7, <span class="green">LOW</span>);<br/>    <span class="orange">digitalWrite</span>(6, <span class="green">LOW</span>);<br/>    <span class="orange">digitalWrite</span>(5, <span class="green">LOW</span>);<br/>  }<br/><br/><span class="ent">➍</span> <span class="green">void</span> topRightDiagonal()<br/>  {<br/>    <span class="orange">digitalWrite</span>(13, <span class="green">LOW</span>);<br/>    <span class="orange">digitalWrite</span>(12, <span class="green">LOW</span>);<br/>    <span class="orange">digitalWrite</span>(11, <span class="green">HIGH</span>);<br/><br/>    <span class="orange">digitalWrite</span>(10, <span class="green">LOW</span>);<br/>    <span class="orange">digitalWrite</span>(9, <span class="green">HIGH</span>);<br/>    <span class="orange">digitalWrite</span>(8, <span class="green">LOW</span>);<br/><br/>    <span class="orange">digitalWrite</span>(7, <span class="green">HIGH</span>);<br/>    <span class="orange">digitalWrite</span>(6, <span class="green">LOW</span>);<br/>    <span class="orange">digitalWrite</span>(5, <span class="green">LOW</span>);<br/>  }</pre>&#13;
</div>&#13;
<p class="indent">The <code>verticalLine()</code> function <span class="ent">➊</span> shows the first image in <a href="ch03.xhtml#ch03fig23">Figure 3-23</a>, the <code>topLeftDiagonal()</code> function <span class="ent">➋</span> shows the second image, the <code>horizontalLine()</code> function <span class="ent">➌</span> shows the third, and the <code>topRightDiagonal()</code> function <span class="ent">➍</span> shows the last. As with your previous custom function, these custom functions have the <code>void</code> data type, since they won’t return a value.</p>&#13;
<p class="indent">Custom functions can call other custom functions, too, so let’s call the four line functions inside a single <code>spinningLine()</code> function. Add the following code to your sketch, after the closing bracket in the <code>topRightDiagonal()</code> function.</p>&#13;
<div class="pre">&#13;
<pre><span epub:type="pagebreak" id="page_92"/><span class="green">void</span> spinningLine(<span class="green">int</span> delayTime)<br/>{<br/>  verticalLine();<br/>  <span class="orange">delay</span>(delayTime);<br/><br/>  topLeftDiagonal();<br/>  <span class="orange">delay</span>(delayTime);<br/><br/>  horizontalLine();<br/>  <span class="orange">delay</span>(delayTime);<br/><br/>  topRightDiagonal();<br/>  <span class="orange">delay</span>(delayTime);<br/>}</pre>&#13;
</div>&#13;
<p class="indent">This code shows a vertical line, a diagonal line, a horizontal line, and another diagonal line, with a delay after each line. Now, all you have to do is call <code>spinningLine()</code> inside the <code>loop()</code> function.</p>&#13;
<div class="noter">&#13;
<p class="notet"><strong>NOTE</strong></p>&#13;
<p class="notep"><em>You’ll find a complete listing of this code in the resource files at</em> <a href="https://nostarch.com/arduinoinventor/">https://nostarch.com/arduinoinventor/</a><em>.</em></p>&#13;
</div>&#13;
<h4 class="h4" id="ch03lev2sec10"><strong>Tweak Your loop() Function</strong></h4>&#13;
<p class="noindent">Add a call to your custom function inside your <code>loop()</code> function, as in <a href="ch03.xhtml#ch03ex013">Listing 3-13</a>. Remember that you still need to have all of those <code>pinMode()</code> commands in your <code>setup()</code> function.</p>&#13;
<p class="ex-caption"><a id="ch03ex013"/><strong>LISTING 3-13:</strong> Completed <code>loop()</code> function with the new custom function call <code>spinningLine(200)</code>;</p>&#13;
<div class="pre">&#13;
<pre><span class="green">void</span> <span class="green1">loop</span>()<br/>{<br/>  spinningLine(200);<br/>}</pre>&#13;
</div>&#13;
<p class="indent">Once you add the function and pass it a delay time parameter (the code uses <code>200</code>), upload your sketch to your Arduino. You’ll see a rotating line on your display. With this knowledge of sequencing LEDs and custom functions, you can make your own nine-pixel animation!</p>&#13;
<h3 class="h3" id="ch03lev1sec6"><strong>GOING FURTHER</strong></h3>&#13;
<p class="noindent">Custom functions will be useful when you want to reuse code later or organize your code. To take this project further, try designing more elaborate animations; you could even come up with your own alphabet and use your monitor to display a secret message.</p>&#13;
<h4 class="h4" id="ch03lev2sec11"><span epub:type="pagebreak" id="page_93"/><strong>Hack</strong></h4>&#13;
<p class="noindent">To take this project further, start by creating more elaborate animations. As you work through the next few projects, look for ways to incorporate your monitor—for example, maybe you could use a sensor to control an animation speed or display a sensor value in some interesting ways. Download a blank design template at <em><a href="https://www.nostarch.com/arduinoinventor/">https://www.nostarch.com/arduinoinventor/</a></em>.</p>&#13;
<h4 class="h4" id="ch03lev2sec12"><strong>Modify</strong></h4>&#13;
<p class="noindent">You’ve learned how to control a number of electronic components by using digital pins and custom functions. Try replacing your individual LEDs with different components. We suggest a <em>seven-segment display</em>, as shown in <a href="ch03.xhtml#ch03fig24">Figure 3-24</a>.</p>&#13;
<p class="figuret"><a id="ch03fig24"/><strong>FIGURE 3-24:</strong> A single seven-segment display</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_24.jpg"/></div>&#13;
<p class="indent">Each segment is an LED that you can control. There are seven individual segments (plus the decimal points), as shown in <a href="ch03.xhtml#ch03fig25">Figure 3-25</a>, and by turning specific segments on and off, you can make numbers and most letters of the English language.</p>&#13;
<p class="figuret"><a id="ch03fig25"/><strong>FIGURE 3-25:</strong> Illustration of the seven individual segments and the decimal point with a corresponding wiring diagram</p>&#13;
<div class="image"><img alt="Image" src="../images/fig3_25.jpg"/></div>&#13;
<p class="indent">You can control one of these displays the same way you control the Nine-Pixel Animation Machine: just create custom functions for each number. For a challenge, create a single function that lets you pass a number to display to it.</p>&#13;
</body></html>