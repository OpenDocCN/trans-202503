- en: A
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: A
- en: 'Maxing Out Your Credit Card: Setting Up a Test Lab'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 透支信用卡：搭建测试实验室
- en: '![](image_fi/book_art/chapterart.png)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/book_art/chapterart.png)'
- en: This appendix describes the equipment we used for the work covered in this book.
    If you’re setting up a hardware hacking lab, this appendix can also serve as a
    “shopping list” of useful equipment. We explore a range of options—everything
    for those with budgets ranging from millions to tens of dollars. We also provide
    many do-it-yourself options to help with lower-cost setups.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本附录描述了我们在本书中涉及的工作中使用的设备。如果你正在搭建硬件黑客实验室，本附录还可以作为一份有用设备的“购物清单”。我们探讨了从数百万到数十美元预算的各种选择，并提供了许多DIY选项，以帮助你搭建更低成本的实验环境。
- en: We introduce equipment based on specific outcomes you want to achieve, and we
    discuss this equipment roughly in the order we followed in the book itself. We
    also cover the basic equipment (multimeters and soldering irons) that you’ll spend
    a lot of time working with to prepare targets for more advanced analysis work.
    Our goal in this appendix is to provide a complete overview of what is involved
    in a lab to help with overall budgeting (and so we can more easily update this
    when we release the second edition).
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 我们根据你想要实现的特定目标来介绍设备，并大致按照本书中的顺序进行讨论。我们还涵盖了你在为更高级的分析工作准备目标时会用到的基本设备（多用表和焊接工具）。本附录的目的是提供一个关于实验室所需设备的完整概述，帮助你进行总体预算（也方便我们在发布第二版时进行更新）。
- en: We should make you aware of a clear conflict of interest with some of our recommendations.
    Colin cofounded NewAE Technology, Inc., and Jasper has (at the time of writing)
    been with Riscure for more than a decade; both companies manufacture and sell
    side-channel analysis and fault-injection equipment. Despite this, we’ve tried
    to keep our recommendations as clear as possible on technical reasons. We have
    included approximate pricing in US dollars, which is accurate as of early 2021\.
    Due to supply chain issues, prices will fluctuate, but we also want you to understand
    the difference between $50 and $50,000 budgets. Where well-documented low-cost
    DIY solutions are available, we’ve included them on the lower end of the cost
    scale.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要让你意识到一些推荐背后存在明确的利益冲突。Colin是NewAE Technology, Inc.的联合创始人，而Jasper（截至写作时）在Riscure工作已有十多年；这两家公司都生产和销售侧信道分析与故障注入设备。尽管如此，我们尽力确保我们的推荐基于技术理由，并尽可能保持清晰。我们提供了截至2021年初的美国美元价格估算。由于供应链问题，价格会有所波动，但我们也希望你理解$50和$50,000预算之间的差异。对于一些有良好文档记录的低成本DIY解决方案，我们已将其列在较低的成本区间。
- en: With such a huge selection of tools, where should you start? It’s hard to make
    specific recommendations, as everything depends on your overall goal and budget.
    If you just want to follow along with the examples in this book, you could get
    away with a ChipWhisperer-Nano or ChipWhisperer-Lite. If you want to perform black-box
    testing of a recent cryptographic device, you’ll likely need EM probes and a very
    fast digitizing solution. And unless you want to reimplement many attack algorithms,
    you’ll probably want a more complete software solution, such as the Riscure Inspector.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 面对如此众多的工具，你应该从哪里开始？很难给出具体的推荐，因为一切都取决于你的整体目标和预算。如果你只是想跟随本书中的示例，你可以选择ChipWhisperer-Nano或ChipWhisperer-Lite。如果你想对最新的加密设备进行黑盒测试，可能需要EM探针和非常快速的数字化解决方案。除非你想重新实现许多攻击算法，否则你可能会想要更完整的软件解决方案，如Riscure
    Inspector。
- en: 'Checking Connectivity and Voltages: $50 to $500'
  id: totrans-7
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检查连接性和电压：$50到$500
- en: 'Although the montage of hardware hacking that will be featured on *CSI: Cyber*
    will include reballing BGAs, carefully modifying circuit boards, and decapping
    chips with acid, most of your time in real life will be spent checking electrical
    connectivity. This testing includes looking for shorts on assembled boards, measuring
    what type of pullups might be on a line, tracing lines on a circuit board, and
    figuring out what pinout a cable you are using has.'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管《CSI：Cyber》中的硬件黑客蒙太奇会包括重新焊接BGA、精心修改电路板以及用酸腐蚀芯片，但在现实生活中，你的大部分时间将花在检查电气连接性上。此类测试包括检查组装电路板上的短路、测量线路上可能的拉电阻、追踪电路板上的线路，以及弄清楚你所使用的电缆的引脚排列。
- en: Add on to checking connectivity some other common tasks you can accomplish with
    a multimeter, such as measuring voltages and current draw, and you soon realize
    one of the most valuable tools as a hardware hacker is going to be your trusty
    *(digital) multimeter*.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 除了检查电气连接外，万用表还可以完成一些其他常见任务，例如测量电压和电流消耗，你很快就会意识到，作为硬件黑客，最有价值的工具之一就是你那可靠的*(数字)
    万用表*。
- en: We specifically mention the electrical connectivity check, as most multimeters
    include a “beeper function” that beeps when a short (or low resistance) is measured.
    The quality of this feature can vary a lot; check out Dave Jones’s *EEVBlog* YouTube
    channel for some great product reviews and comparisons.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 我们特别提到电气连接检查，因为大多数万用表都包括一个“蜂鸣器功能”，当测量到短路（或低电阻）时会发出蜂鸣声。这个功能的质量差异很大；可以查看 Dave
    Jones 的 *EEVBlog* YouTube 频道，那里有一些很棒的产品评论和对比。
- en: On the higher end, Fluke meters are likely the most well-known brand. Our number-one
    recommendation in this line is the Fluke 179/EDA2 kit. This kit in particular
    includes the TP910 test leads, which have a very fine point to easily probe QFN
    packages. The probe tips include both spring-loaded pogo pins (great for keeping
    the tip on a pin) and sharp stainless-steel tips (great for probing past solder
    mask or conformal coating). [Figure A-1](#figureA-1) shows an example of them
    in action. You can buy these probes separately and use them with other brands
    of meters as well, but check the jack specifications, as different meters do have
    slightly different-sized jacks. The TP910 test leads have the disadvantage that
    the thin and flexible cable is likely to be bent on smaller radii and eventually
    develops internal openings, especially near the end where flexing is most pronounced.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在高端产品中，Fluke 万用表可能是最知名的品牌。我们在这一系列中的首选推荐是 Fluke 179/EDA2 套件。特别是这个套件包括了 TP910
    测试引线，这些引线具有非常细的尖端，可以轻松探测 QFN 封装。探针的尖端既包括弹簧加载 pogo 引脚（非常适合将尖端固定在引脚上），也包括锐利的不锈钢探针（适合穿透焊接掩膜或涂层）。[图
    A-1](#figureA-1) 展示了它们在实际操作中的样子。你可以单独购买这些探针，并将其与其他品牌的万用表配合使用，但请检查插孔规格，因为不同品牌的万用表插孔大小略有不同。TP910
    测试引线的缺点是，细而灵活的电缆可能会在较小的弯曲半径下被弯曲，并最终在弯曲最明显的地方出现内部开口，特别是在末端。
- en: '![faa001](image_fi/278748b01/faa001.png)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![faa001](image_fi/278748b01/faa001.png)'
- en: 'Figure A-1: Fluke TP910 test leads with pogo pin (left) on QFN IC pad and sharp
    probe to pierce solder mask (right)'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-1：Fluke TP910 测试引线带有 pogo 引脚（左）连接 QFN IC 焊盘，锐利探针刺穿焊接掩膜（右）
- en: On the medium-to-lower end, the field opens up quite a bit. One recommendation
    is to stay away from low-cost Fluke (or other big brand) options, as they often
    seem to be limited in capability to avoid cannibalizing the higher-end options
    they also offer. An easy choice is often the *EEVBlog*-branded meters, which have
    generally been well tested and represent good value. Depending on your country,
    you may find many different options available locally, which makes it hard to
    specify specific models, but checking ratings on your local Amazon site is a good
    place to start.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在中低端市场，选择范围要广泛得多。一个建议是远离低成本的 Fluke（或其他大品牌）选项，因为它们通常似乎在功能上有限制，以避免与其高端选项相互竞争。一个简单的选择往往是
    *EEVBlog* 品牌的万用表，它们通常经过充分测试，性价比高。根据你所在的国家/地区，你可能会发现许多不同的本地可用选项，这使得指定具体型号变得困难，但在当地的
    Amazon 网站查看评级是一个不错的起点。
- en: If you go for a budget meter, it may still be worth splurging on a nicer lead
    set. While the meter electronics of a budget meter may be up to the task, the
    leads often feel cheap or have too large a point to be useful. Finding good leads
    with silicone insulation cable will be money well spent, as the leads are the
    part with which you’ll be spending a lot of hands-on time. Don’t be put off by
    the idea of spending more on the test leads than you did on the meter itself.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你选择预算型万用表，或许仍然值得在更好的引线套件上多花点钱。虽然预算型万用表的电子元件可能足够应付任务，但其引线通常感觉便宜，或者尖端太大，不便于使用。购买带有硅胶绝缘电缆的优质引线是值得投资的，因为引线是你将花费大量实际操作时间的部分。不要因为花在测试引线上的钱比万用表本身还多而感到不安。
- en: 'Fine-Pitch Soldering: $50 to $1,500'
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 精细间距焊接：$50 至 $1,500
- en: Soldering is another task you’ll find yourself doing frequently. We’re calling
    this *fine-pitch soldering* because beyond standard through-hole work, you’ll
    also be tacking wires onto test points and doing other tasks that require a soldering
    iron with a fine point. You’ll want a variety of options and not just the stock
    fine-point tip, as you’ll find the fine-point tip gets ruined fairly quickly.
    Soldering tips are generally made up of some internal copper slug that has rapid
    heat transfer and a thin layer of a metal that won’t react with the solder or
    oxidize (see [Figure A-2](#figureA-2)).
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 焊接是你会经常做的一项任务。我们称之为*细间距焊接*，因为除了标准的通孔焊接外，你还需要将电线焊接到测试点以及进行其他需要精细焊接铁头的任务。你需要多种选择，而不仅仅是标准的细头焊接铁头，因为你会发现细头焊接铁头很容易损坏。焊接铁头通常由内部的铜芯和一层不会与焊锡反应或氧化的金属组成（见[图A-2](#figureA-2)）。
- en: '![faa002](image_fi/278748b01/faa002.png)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![faa002](image_fi/278748b01/faa002.png)'
- en: 'Figure A-2: Soldering tip construction involves a copper core with a more robust
    plating, which is selected to survive interacting with the solder in use.'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 图A-2：焊接铁头的构造包括一个铜芯和一个更坚固的镀层，选择该镀层是为了能够耐受与焊锡的接触。
- en: As soon as the plating has a hole in it, the tip is generally trashed because
    it no longer offers good thermal connectivity. A smaller (finer) tip will typically
    develop holes quickly, especially if used to solder larger items that might cause
    you to push or rub the tip.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦镀层有了孔，焊接铁头通常就废掉了，因为它不再能提供良好的热连接。较小（更细）的焊接铁头通常会很快出现孔，尤其是当用来焊接较大的物品时，这可能会导致你推动或摩擦焊接铁头。
- en: One of the most popular soldering options is the Hakko FX-951, which features
    a number of very fine tips that are great for working with small surface-mount
    parts and tacking wire onto tiny parts. The unit itself is around $400, and the
    tip cartridges are relatively inexpensive (starting at $10). The tip cartridges
    have the heater and thermocouple integrated into them, meaning you get heat fairly
    close to the tip itself.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 最受欢迎的焊接选择之一是Hakko FX-951，它配有许多非常精细的焊接铁头，适合处理小型表面贴装元件和将电线焊接到微小的元件上。该设备本身大约$400，焊接铁头的耗材相对便宜（起价$10）。这些焊接铁头的加热器和热电偶是集成在一起的，这意味着你能将热量直接传递到焊接铁头附近。
- en: Another higher-end soldering tool that we love is the Metcal system, which uses
    something called “SmartHeat” (see [Figure A-3](#figureA-3)).
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个我们喜欢的高端焊接工具是Metcal系统，它使用一种叫做“SmartHeat”的技术（见[图A-3](#figureA-3)）。
- en: '![faa003](image_fi/278748b01/faa003.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![faa003](image_fi/278748b01/faa003.png)'
- en: 'Figure A-3: Metcal uses a heater that’s almost integrated with the tip (SmartHeat)
    to regulate tip temperature. In this system, the tip temperature is fixed, but
    it responds much faster than a tip with a separate thermometer.'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 图A-3：Metcal使用一种几乎与焊接铁头集成的加热器（SmartHeat）来调节焊接铁头的温度。在这个系统中，焊接铁头的温度是固定的，但它比使用独立温度计的焊接铁头反应要快得多。
- en: The heater is actually a special material with a Curie point (the temperature
    at which it changes its magnetic properties) selected to be the desired tip temperature.
    It’s integrated into the tip itself and driven with a high-power RF signal source,
    so the tip can go from soldering a small surface-mount resistor to desoldering
    a huge connector and respond almost instantly.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 这个加热器实际上是一种具有居里点（即改变其磁性特性的温度）的特殊材料，选定为所需的焊接铁头温度。它集成在焊接铁头中，并通过高功率射频信号源驱动，因此焊接铁头可以迅速从焊接小型表面贴装电阻到拆焊大型连接器。
- en: A common starting point is a Metcal MX-5210 base station ($800), which then
    requires you to select appropriate tips (it doesn’t even come with tips). For
    tips, part numbers STTC-125 and STTC-145 are good choices (around $30), and both
    work with lead-free solder. The base station and tips are all expensive, and the
    tips are more fragile than classic heater-based solutions.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 一个常见的起步点是Metcal MX-5210 基站（$800），然后你需要选择合适的焊接铁头（它甚至不带焊接铁头）。对于焊接铁头，STTC-125和STTC-145零件号是不错的选择（大约$30），并且两者都适用于无铅焊锡。基站和焊接铁头都很贵，而且这些焊接铁头比经典的加热器方案更易损坏。
- en: If you want the same sort of results at a lower cost, Thermaltronics offers
    lower-cost solutions using this same technology. The Thermaltronics TMT-9000S
    ($400) actually uses the same tip connection as the Metcal system, and thus it’s
    also a source of lower-cost tips for the Metcal base station.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想以更低的成本得到相似的效果，Thermaltronics 提供了使用相同技术的低成本方案。Thermaltronics TMT-9000S（$400）实际上使用了与Metcal系统相同的焊接铁头连接，因此它也可以为Metcal基站提供低成本的焊接铁头。
- en: JBC also has started offering good-value stations. In particular, the CDB and
    CDS lines are lower cost than Metcal stations, but with excellent performance.
    Depending on your country, you may find certain brands easier to source than others,
    and often the import or shipping costs may substantially shift the value of one
    station compared to another.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: JBC 也开始提供性价比高的焊接站。特别是 CDB 和 CDS 系列的价格低于 Metcal 焊接站，但性能非常出色。根据你所在的国家/地区，你可能会发现某些品牌比其他品牌更容易购买，并且通常进口或运输成本会显著影响一个焊接站的性价比。
- en: The Hakko FX-951, Metcal, Thermaltronics, and JBC are all still fairly high-end
    stations. You can get away with a much cheaper iron as well, but at the lower
    end, your specific market tends to determine the best value. One good option is
    the TS100 soldering iron (see [Figure A-4](#figureA-4)).
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: Hakko FX-951、Metcal、Thermaltronics 和 JBC 都是相对高端的焊接站。你也可以使用便宜得多的电烙铁，但在低端市场，你的具体需求往往决定了最具性价比的选择。一个不错的选择是
    TS100 焊接铁（参见 [图 A-4](#figureA-4)）。
- en: '![faa004](image_fi/278748b01/faa004.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![faa004](image_fi/278748b01/faa004.png)'
- en: 'Figure A-4: The TS100 is a low-cost iron that performs well relative to higher-priced
    irons.'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-4：TS100 是一款低成本的电烙铁，与高价电烙铁相比，表现相当出色。
- en: This soldering iron is unique because it runs on a DC input, which means it’s
    small and portable. You can easily run it off a car battery or AC-DC power adapter
    (such as your laptop power adapter). In practice, it works very well and has fast
    thermal recovery, but be sure to use a sufficiently strong power supply, ideally
    in the 19 to 24 V range, to provide the most power to the iron. The TS100 is available
    in kits with various-sized tips, or you can get the TS100 with a provided tip
    for less than the cost of some of the more expensive Metcal replacement tips (we
    told you the Metcal stuff was expensive).
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 这款焊接电烙铁非常独特，因为它使用直流电输入，这意味着它体积小且便于携带。你可以轻松通过汽车电池或交流-直流电源适配器（比如你的笔记本电源适配器）来运行它。在实际使用中，它表现非常好，且热恢复速度很快，但一定要使用足够强劲的电源，理想的电压范围是
    19 至 24 V，以提供最大功率。TS100 提供了不同大小的焊接头的套件，或者你也可以购买带有提供焊接头的 TS100，它的价格低于一些昂贵的 Metcal
    替换焊接头（我们说过，Metcal 的东西很贵）。
- en: 'Desoldering Through-Hole: $30 to $500'
  id: totrans-33
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 去除通孔焊锡：30 美元至 500 美元
- en: With any luck, you won’t ever need to remove a through-hole connector or similar
    from a printed circuit board (PCB). But sometimes it’s necessary, and it’s tricky
    to do when even a small amount of solder is left. Some of the basic tools, such
    as *solder* *wick* and a *solder sucker*, become difficult to use with more intense
    tasks.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 如果幸运的话，你可能永远不需要从印刷电路板（PCB）上移除通孔连接器或类似组件。但有时这是必须的，当即使是少量焊锡残留时，移除它也变得非常棘手。像 *吸锡带*
    和 *吸锡器* 这样的基本工具，在面对更复杂的任务时使用起来可能会更加困难。
- en: Instead, having something like a *solder removal “gun”* can be worthwhile. These
    have an active vacuum alongside a heater element, to heat up the solder at the
    same time as removing it from the component lead. [Figure A-5](#figureA-5) shows
    one stand-alone example, the Hakko FR-300, but you can find them as add-ons to
    various soldering workstations as well.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 相反，拥有像 *焊锡去除“枪”* 这样的工具是值得的。这些工具配备了一个加热元件和一个主动吸力装置，可以在加热焊锡的同时将其从组件引脚上吸走。[图 A-5](#figureA-5)
    展示了一个独立的例子，Hakko FR-300，但你也可以在各种焊接工作站中找到这种功能的附加装置。
- en: '![faa005](image_fi/278748b01/faa005.png)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![faa005](image_fi/278748b01/faa005.png)'
- en: 'Figure A-5: Hakko FR-301 is a popular through-hole removal tool, and the direct
    replacement for the FR-300 shown here.'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-5：Hakko FR-301 是一款流行的通孔去除工具，它是 FR-300 的直接替代品。
- en: 'No matter what you use to remove the solder from a board, adding a lower melting
    point solder onto the board first can help. If you are desoldering a lead-free
    process, for example, the solder will remain molten only for a short period of
    time before it cools too much. If you first add some leaded solder to the connection,
    it will remain molten for longer (warning: this means the board is no longer ROHS-compliant
    if you are trying to return it to service). You can extend this further by using
    products like the Chip Quik removal alloy SMD1NL (lead-free) or SMD1L (leaded),
    which are specifically designed to be added into a solder joint and result in
    a much lower melting temperature. Once the joint is cleaned up, it could be soldered
    again with “regular” solder to behave as normal.'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 无论你使用什么方式去除电路板上的焊锡，首先在电路板上添加低熔点焊锡会有帮助。例如，如果你在拆焊无铅工艺时，焊锡会保持液态的时间非常短，迅速冷却。如果你先在连接处加入一些含铅焊锡，它会保持液态更久（警告：这意味着如果你想将电路板恢复使用，它就不再符合
    ROHS 标准）。你可以通过使用像 Chip Quik 移除合金 SMD1NL（无铅）或 SMD1L（含铅）这样的产品来进一步延长液态时间，这些产品专为加入焊点并使其具有更低的熔点而设计。一旦焊点清理完毕，可以使用“常规”焊锡重新焊接，恢复正常功能。
- en: 'Soldering and Desoldering Surface Mount Devices: $100 to $500'
  id: totrans-39
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 焊接和拆焊表面贴装元件：$100 到 $500
- en: Surface-mount soldering has a wide range of requirements. We’ll focus on the
    most common tasks required for hardware hacking rather than all possible surface-mount
    jobs.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 表面贴装焊接有广泛的需求。我们将重点介绍硬件破解中最常见的任务，而不是所有可能的表面贴装工作。
- en: The single most important element for surface-mount soldering is the *hot air
    gun*. This device provides a flow of hot air that helps solder joints underneath
    parts. You can find various popular hot air tools at all sorts of ranges. As of
    this writing, a popular mid-range option is the Quick 861DW ([Figure A-6](#figureA-6)),
    which provides a reliable source of hot air with a good range of settings. Along
    with the hot air, you might need *nozzles*. Don’t worry about getting nozzles
    to fit every package you need, as you can move the smaller nozzles around the
    package surface for larger packages.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 对于表面贴装焊接来说，最重要的设备是*热风枪*。这种设备提供热空气流，帮助焊接元件下面的焊点。你可以找到各种受欢迎的热风工具，涵盖各种价位。截至本文撰写时，一款受欢迎的中档选择是
    Quick 861DW（[图 A-6](#figureA-6)），它提供可靠的热风源，并具备良好的设置范围。除了热风枪，你可能还需要*喷嘴*。不用担心要为每个封装购买合适的喷嘴，因为你可以通过在大封装表面上移动较小的喷嘴来适应需求。
- en: '![faa006](image_fi/278748b01/faa006.png)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![faa006](image_fi/278748b01/faa006.png)'
- en: 'Figure A-6: The Quick 861DW is a good mid-range hot air gun.'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-6：Quick 861DW 是一款中档热风枪。
- en: If you’re not sure about settings for the hot air gun, a good starting point
    is to adjust the temperature and flow rate such that a piece of paper becomes
    light brown from the heat as you move the gun around on the paper. You don’t want
    too fast a flow rate or you’ll blow parts around too. Before you start using one
    on important boards, get an old laptop or computer motherboard and see how many
    parts you can easily remove. If you get really good, start putting them back together.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你不确定热风枪的设置，好的起始点是调节温度和流量，使得当你将热风枪在纸上移动时，纸张变为浅棕色。你不想流量过大，否则会把元件吹走。在正式开始使用之前，先拿一台旧笔记本电脑或计算机主板，看看你能轻松拆卸多少个元件。如果你做得很好，试着将它们重新组装回去。
- en: If you plan on working with larger packages (such as BGAs), a *board pre-heater*
    can be useful. This tool makes hot air go onto the other side of the board, which
    means the hot air gun is used only to “peak” the temperature to the final value
    that will melt the solder.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你计划处理更大的封装（如 BGA），*电路板预热器*可能会很有用。这个工具可以将热风吹到电路板的另一面，这样热风枪只需要用来将温度“推高”到可以熔化焊锡的最终值。
- en: Many YouTube channels show this rework technique in more detail. Louis Rossmann’s
    channel shows repairs on laptops (especially MacBooks) and cell phones. These
    consumer devices often have extremely fine-pitch parts, and you can get a feel
    for what is possible with enough experience.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 很多 YouTube 频道更详细地展示了这种返工技术。Louis Rossmann 的频道展示了笔记本电脑（尤其是 MacBook）和手机的维修。这些消费电子设备通常具有非常细密的元件，通过足够的经验，你可以感受到什么是可能的。
- en: If you have limited surface-mount requirements, you might also consider the
    Chip Quik *removal* *alloy* SMD1L or SMD1NL mentioned earlier. This solder alloy
    has a very low melting point. It can be used with a regular soldering iron, and
    it stays molten long enough that you can bring your iron around an entire SMD
    chip—even some large packages like a TQFP-144! It works only with visible pads,
    of course, but it doesn’t require any additional tools beyond what you might already
    have, and the alloy itself is cheap (less than $20). Even with hot air equipment,
    it can be useful in situations where you have more heat-sensitive parts nearby
    that are difficult to mask off.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你有有限的表面贴装需求，你也可以考虑之前提到的Chip Quik *去除* *合金* SMD1L或SMD1NL。这种焊料合金的熔点非常低。它可以与常规电烙铁一起使用，并且在熔化后保持足够长的时间，足以让你用电烙铁绕过整个SMD芯片——即使是一些较大的封装，如TQFP-144！当然，它只适用于可见的焊盘，但它不需要任何额外的工具，只需要你可能已经拥有的设备，而且这种合金本身也很便宜（不到$20）。即使是使用热风设备，它也适用于一些热敏元件附近的情况，这些元件较难掩蔽。
- en: You’ll also likely run into *ball grid array (BGA)* packages that have solder
    balls on the bottom side, which may require you to “reball” them after removal.
    You can get fancy reballing jigs, but if you are working with them only occasionally,
    you might instead get away with a low-cost BGA stencil set. Since it can be hard
    to find useful instructions for the low-cost tools, we’ll re-create a technique
    that works for us in this book. We’ll use a cheap pack of stencils costing only
    about $20 (see [Figure A-7](#figureA-7)). We can smear solder paste onto the stencil,
    which will form nice balls when reheated. If you haven’t used solder paste before,
    it takes a bit of time to get the technique “just right.” Most of it has a limited
    shelf life and should be stored in a fridge. For this reason, we’ll give a quick
    rundown of a more reliable technique with those stencils.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可能会遇到带有焊球的*球栅阵列（BGA）*封装，这些焊球可能需要在拆卸后进行“重新焊球”。你可以购买高级的重新焊球夹具，但如果你只是偶尔使用这些封装，可能只需要购买一套低成本的BGA模板即可。由于低成本工具的使用说明较难找到，我们将在本书中重新创造一种适合我们的技巧。我们将使用一包便宜的模板，价格仅约$20（见[图A-7](#figureA-7)）。我们可以将焊膏涂抹到模板上，重新加热后，它将形成完美的焊球。如果你以前没有使用过焊膏，可能需要一些时间才能掌握技巧。大多数焊膏的保质期有限，应该存放在冰箱中。基于这一点，我们将简要介绍使用这些模板时更可靠的技巧。
- en: '![faa007](image_fi/278748b01/faa007.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![faa007](image_fi/278748b01/faa007.png)'
- en: 'Figure A-7: Example of a cheap set of stencils for BGA reballing'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 图A-7：用于BGA重新焊球的便宜模板示例
- en: 'With this type of cheap stencil, the most reliable reballing process is as
    follows:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这种便宜的模板，最可靠的重新焊球过程如下：
- en: Remove the old solder balls and solder with solder wick.
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 移除旧的焊球并使用除焊带进行焊接。
- en: Clean the area well with isopropyl alcohol (IPA) and/or flux remover.
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用异丙醇（IPA）和/或助焊剂清除剂彻底清洁区域。
- en: Tape the deballed chip to the bottom of the stencil.
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将去焊球的芯片粘贴到模板的底部。
- en: Smear paste-type flux (such as MG Chemicals 8341-10ML) onto the stencil (with
    the chip underneath it) with a squeegee such as credit card edge. Be careful not
    to cause any misalignment of the stencil.
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用刮刀（如信用卡边缘）将焊膏型助焊剂（例如MG Chemicals 8341-10ML）涂抹到模板上（模板下方是芯片）。小心不要造成模板错位。
- en: Using appropriately sized solder spheres, carefully push balls into each stencil
    hole. Ensure no spare balls are left on surface of the stencil. [Figure A-8](#figureA-8)
    shows the start of this process.
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用适当尺寸的焊球，小心地将球推入每个模板孔中。确保模板表面没有多余的焊球。[图A-8](#figureA-8)显示了该过程的开始。
- en: Heat the chip until balls reflow onto chip surface (see [Figure A-9](#figureA-9)),
    which will require the solder spheres to match the correct size for your device
    (marked on the stencil in this example). You may be able to find kits with multiple
    solder ball (sphere) sizes.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将芯片加热，直到焊球重新流动到芯片表面（见[图A-9](#figureA-9)），这要求焊球的尺寸与设备的焊盘尺寸相匹配（在此示例中，尺寸已标示在模板上）。你可能会找到带有多种焊球（球体）尺寸的工具包。
- en: '![faa008](image_fi/278748b01/faa008.png)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![faa008](image_fi/278748b01/faa008.png)'
- en: 'Figure A-8: Fluxed IC taped onto stencil. Note BGA does not exactly match stencil,
    leaving some dark-looking holes with missing pads.'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 图A-8：带助焊剂的IC粘贴在模板上。请注意，BGA与模板的匹配不完全，留下了些许没有焊盘的深色孔洞。
- en: Since many of these kits come from unknown sources (if you’re purchasing on
    Amazon), you may wish to use a more reputable source. Chip Quik makes several
    solder sphere kits; for example, if you’re using 0.4mm solder spheres, Chip Quik
    part number SMD2032-25000 is available from Digi-Key and provides 25,000 0.4mm
    solder spheres for less than $30.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这些套件很多来自未知来源（如果你在亚马逊上购买的话），你可能希望选择一个更有信誉的来源。Chip Quik 制作了多个焊球套件；例如，如果你使用的是
    0.4mm 的焊球，Chip Quik 的零件号 SMD2032-25000 可以通过 Digi-Key 购买，价格不到 $30，提供 25,000 个 0.4mm
    的焊球。
- en: As a final note on BGAs, investigate the availability of low-cost jigs and stencils
    for your part of interest. You can find several low-cost *BGA* *reballing jigs*
    for the more popular parts, and they simplify the task of holding the BGA and
    stencil together correctly aligned.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 最后关于BGA的注意事项，建议调查与你感兴趣的零件相关的低成本夹具和模板的可用性。你可以找到几个低成本的*BGA* *返球夹具*，它们适用于更常见的零件，简化了将BGA和模板正确对齐并固定的任务。
- en: '![faa009](image_fi/278748b01/faa009.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![faa009](image_fi/278748b01/faa009.png)'
- en: 'Figure A-9: Using hot air to melt solder balls to complete the task. The missing
    pads from [Figure A-8](#figureA-8) shouldn’t have balls in them—the extra balls,
    which cannot adhere to a pad, are at risk of coming out of the stencil holes and
    causing shorts.'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-9：使用热风熔化焊球完成任务。 [图 A-8](#figureA-8) 中丢失的焊盘不应有焊球——额外的焊球无法粘附到焊盘上，容易从模板孔中出来并导致短路。
- en: 'Modifying PCBs: $5 to $700'
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 修改 PCB：$5 到 $700
- en: Modifying PCBs, which includes cutting traces to insert resistors for shunts,
    rerouting traces, or tapping onto data lines, is another common task. While you
    can get away with a simple X-Acto knife for a lot of this work, a rotary tool
    may be useful.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 修改 PCB（包括切割线路以插入电阻器进行分流、重新布线或接入数据线）是另一项常见任务。虽然你可以使用简单的 X-Acto 刀来完成大部分工作，但旋转工具可能会更有用。
- en: The *rotary tool**s* you can purchase at the hardware store will typically have
    accessories that are too physically large to be useful on PCBs. Instead, look
    for one like the Foredom K.1070 High Speed Rotary Micromotor Kit (see [Figure
    A-10](#figureA-10)). This device can run up to 38,000 RPM, and you’ll realize
    the difference when holding it in your hand. This is due to the high-quality bearings
    that blow away the normal name-brand rotary tools you can buy from your local
    hardware store.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 你在五金店购买的*旋转工具*通常会配有太大尺寸的附件，这些附件不适合在 PCB 上使用。相反，应该寻找类似 Foredom K.1070 高速旋转微型电动工具套件（见
    [图 A-10](#figureA-10)）的工具。这款工具的转速最高可达 38,000 RPM，拿在手里时你会感受到差异。这是因为它使用了高质量的轴承，远远超过了你在当地五金店可以买到的普通品牌旋转工具。
- en: If you’re purchasing this specific tool, be sure to get with the 3/32-inch collet
    option. You can then get some tiny rotary tips for it, such as the Foredom AK211
    kit, which make it possible to drill up a single BGA ball from the rear side of
    a device or even to attach to a ball on a BGA that isn’t routed to the PCB.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你购买这款特定的工具，请务必选择带有 3/32 英寸卡盘选项的版本。这样你可以为其购买一些小型旋转头，如 Foredom AK211 套件，这样你就可以从设备的背面钻取一个单独的
    BGA 球，甚至可以附着在没有连接到 PCB 的 BGA 球上。
- en: You’ll also find a light *grinding tip* such as the Foredom A-71 useful. This
    tip makes it easy to remove the solder mask from the PCB without damaging the
    underlying trace, which is perfect when you are trying to tap into a number of
    traces, such as a data bus.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 你还会发现轻型*打磨头*，例如 Foredom A-71 非常有用。这款打磨头可以轻松去除 PCB 上的焊料掩膜而不会损坏底下的线路，非常适合你需要接入多个线路时，比如数据总线。
- en: '![faa010](image_fi/278748b01/faa010.png)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![faa010](image_fi/278748b01/faa010.png)'
- en: 'Figure A-10: Foredom High Speed Rotary Micromotor Kit'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-10：Foredom 高速旋转微型电动工具套件
- en: 'Optical Microscopes: $200 to $2,000'
  id: totrans-71
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 光学显微镜：$200 到 $2,000
- en: In line with requirements for modifying the PCB, you’ll likely need to observe
    such modifications. The normal standard for doing so is a *stereo vision microscope*
    (see [Figure A-11](#figureA-11)). These microscopes provide a stereo view that
    retains your depth perception, making it easier to see when your soldering iron
    or rotary tool is touching the PCB.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 根据修改 PCB 的需求，你可能需要观察这些修改。通常的标准是使用*立体显微镜*（见 [图 A-11](#figureA-11)）。这些显微镜提供立体视图，保持了你的深度感知，使你更容易看到当焊接铁或旋转工具接触到
    PCB 时。
- en: '![faa011](image_fi/278748b01/faa011.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![faa011](image_fi/278748b01/faa011.png)'
- en: 'Figure A-11: A low-cost AmScope single-boom optical microscope, with a total
    magnification of 10× or 20× (switchable)'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-11：一款低成本的 AmScope 单臂光学显微镜，具有 10× 或 20× 的总放大倍数（可切换）
- en: You may be able to find a surplus one locally, but if you are purchasing new,
    a low-cost option is the AmScope brand typically available on Amazon. When evaluating
    different options, consider that a double-arm boom makes it less likely the head
    will rotate on its own, which is a problem with some low-cost single-arm boom
    microscopes.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 你也许可以在本地找到一台二手显微镜，但如果是购买新的，低成本选项是AmScope品牌，通常可以在亚马逊上找到。在评估不同选项时，请考虑双臂支架显微镜比单臂支架显微镜更不容易自行旋转，这是一些低成本单臂支架显微镜常见的问题。
- en: The *total magnification* is a combination of the eyepiece magnification and
    the objective magnification. For circuit board soldering, a total magnification
    of 10× to 30× is useful, which could mean an objective magnification of 1× and
    eyepiece of 20×, for example. With some microscopes, you may find that you need
    to add a *Barlow lens* onto the objective stage. The Barlow lens provides a reduction
    in magnification (typical is 0.5×), but it increases the microscope’s focal range,
    so you have more space underneath the microscope to fit your circuit board and
    the tools you’re using on your board.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '*总放大倍数*是目镜放大倍数和物镜放大倍数的组合。对于电路板焊接，10×到30×的总放大倍数是有用的，例如，这可能意味着物镜放大倍数为1×，目镜为20×。有些显微镜，你可能会发现需要在物镜阶段添加一个*巴洛透镜*。巴洛透镜可以减少放大倍数（典型值为0.5×），但它增加了显微镜的焦距，这样你就有更多的空间在显微镜下放置你的电路板和工具。'
- en: 'Photographing Boards: $50 to $2,000'
  id: totrans-77
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 拍摄电路板：$50到$2,000
- en: If you’re documenting your work, you’ll also want to take photographs of board-level
    items, which requires using a microscope with some form of video camera. On the
    cheaper end are a variety of low-cost USB or Wi-Fi microscopes available on Amazon
    and similar. They provide great value for $20 to $40 ([Figure A-12](#figureA-12)
    shows an example).
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你在记录工作内容时，你也会想拍摄电路板级别的项目，这需要使用带有视频摄像头的显微镜。较便宜的选项包括亚马逊及类似平台上的多种低成本USB或Wi-Fi显微镜，它们提供了很高的性价比，价格在$20到$40之间（[图A-12](#figureA-12)展示了一个例子）。
- en: '![faa012](image_fi/278748b01/faa012.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![faa012](image_fi/278748b01/faa012.png)'
- en: 'Figure A-12: A low-cost USB microscope'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 图A-12：一款低成本USB显微镜
- en: If you are trying to use these USB microscopes for real-time soldering (as a
    replacement for the visual microscope), be aware they sometimes have lag due to
    the USB connection that can make real-time use difficult.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你试图将这些USB显微镜用于实时焊接（作为视觉显微镜的替代），请注意，由于USB连接，它们有时会出现延迟，这可能使得实时使用变得困难。
- en: If you purchase a *trinocular microscope* (instead of just a stereo microscope),
    you can add a camera to photograph exactly what you are seeing, and you can also
    broadcast the camera image to a screen for using in training or educational environments.
    You can find reasonable-cost trinocular microscopes for $500 to $1,000 from the
    low-cost AmScope manufacturer mentioned previously.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你购买一台*三目显微镜*（而不是仅仅购买立体显微镜），你可以添加相机来拍摄你所看到的图像，并且还可以将相机的图像广播到屏幕上，用于培训或教育环境。你可以从之前提到的低成本AmScope制造商那里找到价格合理的三目显微镜，价格在$500到$1,000之间。
- en: You can also find *monocular digital microscopes* that have only the camera
    portion, typically with HDMI and USB outputs. The lag through the HDMI/VGA outputs
    is usually much less than through USB, meaning that with an external monitor,
    they also can provide a good method of photographing or inspecting boards without
    eyestrain of looking through a microscope eyepiece. If you are planning on using
    the camera output for real-time feedback (such as soldering or probing), finding
    an HDMI or VGA output camera will save you the potential grief of discovering
    that the USB lag makes you feel slightly crazy.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以找到只包含相机部分的*单目数字显微镜*，通常带有HDMI和USB输出。通过HDMI/VGA输出的延迟通常比USB小，这意味着使用外部显示器时，它们也可以提供一个良好的拍照或检查电路板的方法，避免了长时间通过显微镜目镜观看所带来的眼睛疲劳。如果你计划将相机输出用于实时反馈（例如焊接或探针操作），选择一个具有HDMI或VGA输出的相机将帮助你避免因USB延迟而可能引发的困扰。
- en: 'Powering Targets: $10 to $1,000'
  id: totrans-84
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 目标电源供应：$10到$1,000
- en: Another frequent task will be powering targets, which is most easily done with
    a *bench-top power supply*. These allow you to configure voltage and (maximum)
    current to be supplied. A variety of them are available from normal test equipment
    suppliers, but a good value option is the DP832 from Rigol Technologies.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个常见的任务是为目标提供电源，这通常最容易通过*台式电源供应器*来完成。这些设备允许你配置要提供的电压和（最大）电流。各种电源供应器可从常规测试设备供应商处购买，但一个性价比高的选项是Rigol
    Technologies的DP832。
- en: A more complicated (in a good way) target power option is the EEZ Bench Box
    3, which is open source hardware and allows for a variety of computer control
    options.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 更复杂（以正面意义而言）的目标电源选择是 EEZ Bench Box 3，它是开源硬件，允许多种计算机控制选项。
- en: On the lower end, many additional choices are available for a bench-top supply.
    Your local store may stock a lower-cost bench-top supply. It’s hard to recommend
    a specific model, as the heavy transformer in many of the power supplies combined
    with different local-market certification requirements means a variety of vendors
    and solutions are available worldwide.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 在低端市场，许多额外的桌面电源选择可供选择。你当地的商店可能会有低成本的桌面电源。由于许多电源中的重型变压器与不同的本地市场认证要求相结合，全球范围内有各种不同的供应商和解决方案，因此很难推荐特定的型号。
- en: 'Targets that require only a simple power supply may allow you to use AC-DC
    “wall wart” power bricks, which can be found for free with discarded electronics.
    They can also be combined with low-cost no-name adjustable regulators that you
    can find on Amazon (or similar) to provide an adjustable power supply at very
    little cost. These inexpensive options come at a price: they have a relatively
    high noise output, which can negatively affect any side-channel analysis you want
    to perform later.'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 对于只需要简单电源的目标，你可以使用 AC-DC “墙插”电源砖，这些电源砖可以通过废弃电子设备免费获得。它们还可以与低成本的无品牌可调稳压器结合使用，你可以在亚马逊（或类似平台）上找到这些稳压器，从而以极低的成本提供可调电源。这些便宜的选项有一个代价：它们的噪声输出相对较高，可能会对你之后进行的任何旁信道分析产生负面影响。
- en: 'Viewing Analog Waveforms (Oscilloscopes): $300 to $25,000'
  id: totrans-89
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 查看模拟波形（示波器）：300美元到2.5万美元
- en: While *oscilloscopes* have several uses, normally you need to view analog waveforms
    as part of many tasks, such as seeing what I/O patterns are present between two
    devices, checking voltage levels, watching reset pin activity, or anything else.
    We also use them as part of our side-channel power analysis measurement, but we
    cover that use case separately from the more general investigation use case.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然*示波器*有多种用途，通常你需要查看模拟波形，这也是许多任务的一部分，例如查看两个设备之间的 I/O 模式、检查电压水平、观察复位引脚活动或其他任何事情。我们还将它们用于旁信道功率分析测量，但我们会在与更一般的调查用途分开讨论这种用例。
- en: Many options exist for general investigation. The most popular lower-cost oscilloscope
    brand is the Rigol, specifically the Rigol DS1054Z. Rigol oscilloscopes still
    have good-quality probes and reasonable performance, so despite being lower in
    cost, they don’t feel cheap like you might expect. More recently, Rigol also offers
    higher-performance devices that are still a much better value than the more well-known
    brands.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 进行一般调查有许多选择。最受欢迎的低成本示波器品牌是 Rigol，特别是 Rigol DS1054Z。Rigol 示波器仍然具有良好的探头质量和合理的性能，因此尽管价格较低，但它们并不会像你预期的那样显得便宜。最近，Rigol
    还推出了高性能设备，它们的性价比仍然比更知名的品牌要好。
- en: The more common brands, such as Keysight (previously Agilent & HP), Tektronix,
    and Teledyne LeCroy, offer a fairly wide variety of oscilloscopes as well. The
    companies often run promotions that bundle together various accessories, so even
    if you are on a budget, don’t discount the name-brand oscilloscopes. Watch for
    models that have only the name part of “name brand”—that is, those that are very
    low-cost “versions” but still have the name of the brand. These low-end devices
    are often rebranded versions of other manufactures scopes, which means they were
    not designed in-house and not actually using any of the long experience that goes
    into the high-end models. Also, because vendors don’t want to cannibalize the
    higher-end scope market, they often are limited in important ways that will make
    them less useful for “real” work (but fine for running labs in a university, for
    example). We’ll show you an example of that with the Keysight EDUX1002A scope
    in the next section, “Memory Depth,” where the EDUX1002A is limited in memory
    depth so is not very useful for power analysis work.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 更常见的品牌，如 Keysight（以前的 Agilent 和 HP）、Tektronix 和 Teledyne LeCroy，也提供相当种类的示波器。这些公司经常推出捆绑各种配件的促销活动，因此即使你预算有限，也不要排斥品牌示波器。注意那些只有“品牌名”部分的型号——也就是说，这些是非常低成本的“版本”，但仍然带有品牌名。这些低端设备通常是其他厂商示波器的重新品牌化版本，这意味着它们并不是内部设计的，也没有实际使用高端型号所涉及的丰富经验。而且，因为供应商不想蚕食高端示波器市场，它们通常在重要方面有限制，这会使它们在“实际”工作中不那么有用（但在大学实验室等地方使用则没问题）。我们将在下一节“内存深度”中通过
    Keysight EDUX1002A 示波器的例子来展示这一点，其中 EDUX1002A 的内存深度有限，因此不适合用于功率分析工作。
- en: If you have a larger budget, finding a name-brand device may make future expansion
    easier as you can tap into a large number of probes and accessories. While there
    is some cross-platform compatibility, many of the probes and accessories tend
    to work best with the original manufactured brand. Thus, you may wish to purchase
    a specific oscilloscope or brand due to planned future usage requiring a probe
    that Rigol (or similar) doesn’t offer. If you have the chance, it’s also worth
    test-driving a few different devices (often you can do this at a trade show).
    The interface does vary for different devices, so you might find you have a personal
    preference. Some companies even will let you rent high-end oscilloscopes by the
    day/week/month. If you’re outfitting a lab, spending some rental time ensuring
    that the scope will work in practice could save you from an expensive mistake.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的预算较高，选择一个知名品牌的设备可能会使未来扩展更加容易，因为你可以利用大量的探头和配件。虽然存在一定的跨平台兼容性，但许多探头和配件通常在原厂品牌的设备上工作最佳。因此，你可能会考虑购买某个特定的示波器或品牌，以便未来使用时需要的探头是Rigol（或类似品牌）没有提供的。如果有机会，最好亲自试用几款不同的设备（通常在展会时可以这样做）。不同设备的界面确实有所不同，因此你可能会发现自己有个人的偏好。一些公司甚至允许你按天/周/月租用高端示波器。如果你正在为实验室采购设备，花一些租赁时间确保示波器在实际应用中可行，可能会帮你避免一次昂贵的错误。
- en: 'As a final note on oscilloscope usage: another option is to use a computer-based
    scope, of which PicoScope is the most popular. We highly recommend these devices
    because you can get a lot of equipment in a small package. It’s also easy to script
    these devices, as an API is available in various languages. Some people prefer
    having physical knobs to twiddle, however, so using PC-based oscilloscopes is
    somewhat of a personal preference.'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 关于示波器使用的最后一点：另一种选择是使用基于计算机的示波器，其中PicoScope是最受欢迎的。我们强烈推荐这些设备，因为你可以在一个小巧的设备中获得大量功能。它们也容易编程，因为有多种语言的API可用。不过，有些人更喜欢物理旋钮的操作感，因此使用基于PC的示波器有时更多的是个人偏好。
- en: When it comes time to choosing an oscilloscope for general usage, the important
    considerations are the *sample rate* (typically in MS/s or GS/s), *analog bandwidth*,
    and *memory depth*. We’ll briefly cover what to look for with an eye on general
    usage (again, we’ll cover side-channel measurements in another section).
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 在选择用于一般用途的示波器时，重要的考虑因素包括*采样率*（通常以MS/s或GS/s为单位）、*模拟带宽*和*内存深度*。我们将简要讨论如何选择示波器，重点考虑一般用途（另外，我们将在其他部分讨论侧信道测量）。
- en: Memory Depth
  id: totrans-96
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 内存深度
- en: A large memory depth allows you to capture long waveforms of, for example, a
    device’s entire boot process. Lower-end oscilloscopes and low-cost name-brand
    scopes often have limited memory depths, even though the bandwidth and sample
    rate look good. For example, Keysight’s 1000-X series is designed to compete with
    the Rigol offerings. The DSOX1102A (at approximately $700) offers a memory depth
    of only 1 Mpts (Mega-Points, or million sample points). Its education version,
    the EDUX1002A (at approximately $500), offers a memory depth of an even smaller
    100 kpts. By comparison, the Rigol DS1054Z offers a memory depth of 24 Mpts. But
    what does that mean in practice?
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 较大的内存深度使你能够捕获长时间的波形，例如设备的整个启动过程。低端示波器和低成本品牌的示波器通常内存深度有限，即使它们的带宽和采样率看起来不错。例如，Keysight的1000-X系列旨在与Rigol的产品竞争。DSOX1102A（大约700美元）仅提供1
    Mpts（百万个采样点）的内存深度。其教育版EDUX1002A（大约500美元）提供的内存深度甚至更小，为100 kpts。相比之下，Rigol的DS1054Z提供24
    Mpts的内存深度。但这在实际使用中意味着什么呢？
- en: Assume you were sampling at 1 GS/s, meaning 1,000,000,000 samples are written
    to memory per second. While the EDUX1002A would store only 0.1ms of the waveform
    after the trigger (calculated by 100,000 sample memory/1,000,000,000 samples/s
    = 0.0001 second). The Rigol at the same sample rate would provide 24ms of recorded
    trace. If you need a longer trace, you could reduce the sample rate. If we could
    get away with a 100 MS/s recording rate, the Rigol would store 240ms of data,
    while the EDUX1002A would still store only 1ms of waveform. The Tektronix low-cost
    model (TBS1000) is even worse with a memory depth of a mere 2.5 kpts! Stepping
    up a little bit toward a mid-range Tektronix like the MDO3000 series gives a more
    reasonable 10 Mpts, so be aware when comparing the devices.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你以 1 GS/s 的速度进行采样，即每秒钟写入 10 亿个样本到存储器。虽然 EDUX1002A 在触发后只会存储 0.1 毫秒的波形（计算方式为
    100,000 样本存储/1,000,000,000 样本/秒 = 0.0001 秒）。同样的采样率下，Rigol 将提供 24 毫秒的记录波形。如果需要更长的波形记录，你可以降低采样率。如果我们将采样率降低到
    100 MS/s，Rigol 会存储 240 毫秒的数据，而 EDUX1002A 仍然只会存储 1 毫秒的波形。Tektronix 低端型号（TBS1000）甚至更差，存储深度仅为
    2.5 kpts！稍微升级到中端的 Tektronix，比如 MDO3000 系列，提供了更合理的 10 Mpts，因此在比较设备时需要留意这一点。
- en: One area where PC-based oscilloscopes shine is the memory depth. The low-end
    PicoScope 2204A series starts out at only 8 kpts, but stepping up a little bit
    to the 2206B (approximately $350) gives us 32 Mpts—that’s a larger buffer than
    some of the $10k or $20k scopes from the big brands.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: PC 基础的示波器在存储深度方面表现出色。低端的 PicoScope 2204A 系列起始时只有 8 kpts，但稍微提升到 2206B（约 350 美元），就能提供
    32 Mpts —— 这是一些大品牌的 1 万美元或 2 万美元示波器都没有的较大缓冲区。
- en: For general exploration, the memory depth matters, as we often don’t know what
    we are looking for right away. When it comes time for an actual attack, we rarely
    need such a large memory depth, since we are measuring a very specific moment
    in time. But if we need to record information about an entire boot process, we
    may have no idea which part of the 100ms boot actually matters. While we can trade
    off sample rate with memory depth to record more time, we would set a 1 Mpts buffer
    as the minimum we recommend. Buying a scope with too small a buffer is going to
    frustrate you when trying to observe more complex sequences of actions, and it
    will make some of the tasks we describe in this book difficult as well.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 对于一般的探索，存储深度很重要，因为我们通常并不知道自己正在寻找什么。到了实际攻击的时候，我们很少需要这么大的存储深度，因为我们测量的是一个非常特定的时刻。但如果我们需要记录整个启动过程的信息，我们可能无法立刻知道
    100 毫秒的启动过程中哪一部分才是关键。虽然我们可以通过调整采样率与存储深度之间的平衡来记录更长的时间，但我们推荐至少设置 1 Mpts 的缓冲区。购买缓冲区过小的示波器会让你在观察更复杂的动作序列时感到沮丧，并且会使得本书中描述的一些任务变得困难。
- en: Sample Rate
  id: totrans-101
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 采样率
- en: '*Sample rate* is the speed at which the internal analog-to-digital converter
    (ADC) is running. You’ll typically see something like 1 GS/s or 100 MS/s, which
    means 1 billion conversions and 100 million conversions per second, respectively.
    For general exploration, a good rule of thumb is to have a sample rate of 5× to
    10× faster than the digital signal you want to observe. If you are planning on
    probing SPI traffic at 50 MHz, this suggests you would need a 500 to 1,000 MS/s
    oscilloscope. This 5× to 10× rate means you can actually get a “feel” for the
    shape of the waveform, which is useful to see the actual speeds at which it’s
    changing, if there are any glitches in the waveform.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: '*采样率* 是内部模数转换器（ADC）运行的速度。你通常会看到类似于 1 GS/s 或 100 MS/s 的标识，分别意味着每秒进行 10 亿次转换和
    1 亿次转换。对于一般探索，一个好的经验法则是，采样率应比你想要观察的数字信号快 5 到 10 倍。如果你计划探测 50 MHz 的 SPI 流量，那么你可能需要一个
    500 到 1000 MS/s 的示波器。这种 5× 到 10× 的采样率意味着你可以真正“感知”波形的形状，这对于查看波形变化的实际速度以及是否存在波形故障是非常有用的。'
- en: If you sampled too slow, you’ll actually get an incorrect waveform due to an
    effect called *aliasing*. You can find theoretical diagrams of that, but what
    does it look like in real life? We generated a 60 MHz waveform and fed it into
    a scope, with the resulting scope screen shown in [Figure A-13](#figureA-13).
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的采样过于缓慢，实际上会由于一种叫做 *混叠* 的效应而导致错误的波形。你可以找到这种现象的理论图示，但它在现实生活中是什么样的呢？我们生成了一个
    60 MHz 的波形并将其输入到示波器中，得到的示波器屏幕如 [图 A-13](#figureA-13) 所示。
- en: '![faa013](image_fi/278748b01/faa013.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![faa013](image_fi/278748b01/faa013.png)'
- en: 'Figure A-13: A 60 MHz square wave from a signal generator, sampled at 2500
    MS/s'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-13：来自信号发生器的 60 MHz 方波，以 2500 MS/s 采样
- en: We then changed the scope sampling rate to 100 MS/s (see [Figure A-14](#figureA-14)).
    You’ll notice the frequency captured by the scope is not 60 MHz at all; you can
    see at the bottom of the figure that the scope recognizes a 33.59 MHz signal.
    If you didn’t know this was actually a 60 MHz signal, nothing would be obviously
    wrong! An oscilloscope normally will have an anti-aliasing filter to kill any
    frequencies above the scope’s maximum sample rate, but if you choose to sample
    too slowly (as we did here), you can still get into trouble.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们将示波器的采样率更改为100 MS/s（见[图A-14](#figureA-14)）。你会注意到，示波器捕获到的频率根本不是60 MHz；你可以在图的底部看到，示波器识别到的是33.59
    MHz的信号。如果你不知道这实际上是一个60 MHz的信号，什么也看不出明显的问题！示波器通常会有抗混叠滤波器，用来消除超过示波器最大采样率的频率，但如果你选择的采样速度太慢（像我们这里做的那样），你仍然会遇到问题。
- en: '[Figure A-15](#figureA-15) shows what happens if the sampling frequency goes
    down to 5 MS/s. Now the measured signal is reported at 19.88 Hz!'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: '[图A-15](#figureA-15)显示了如果采样频率降到5 MS/s会发生什么情况。现在测得的信号频率是19.88 Hz！'
- en: 'Though in principle 60 MHz is an integer multiple of 5 MHz, we would expect
    aliasing to show a 0 MHz signal: a flat line. However, in practice, both the signal
    generator and the oscilloscope frequency will oscillate slightly from the base
    frequency, which shows up as a (low) frequency due to aliasing.'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管在理论上60 MHz是5 MHz的整数倍，但我们会期望混叠显示为0 MHz信号：一条平直的线。然而，实际上，信号发生器和示波器的频率都会略微偏离基准频率，这会表现为由于混叠导致的（低）频率。
- en: '![faa014](image_fi/278748b01/faa014.png)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![faa014](image_fi/278748b01/faa014.png)'
- en: 'Figure A-14: A 60 MHz square wave from a signal generator, sampled at 100 MS/s;
    due to aliasing, the measured frequency is incorrect'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 图A-14：来自信号发生器的60 MHz方波，采样率为100 MS/s；由于混叠，测得的频率是不正确的。
- en: '![faa015](image_fi/278748b01/faa015.png)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![faa015](image_fi/278748b01/faa015.png)'
- en: 'Figure A-15: A 60 MHz square wave from a signal generator sampled at 5.00 MS/s;
    the measured frequency is the “beat frequency” between the signal generator clock
    and scope time base, which is an aliasing problem'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 图A-15：来自信号发生器的60 MHz方波，在5.00 MS/s采样下；测得的频率是信号发生器时钟和示波器时间基准之间的“拍频”，这是一个混叠问题。
- en: Bandwidth
  id: totrans-113
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 带宽
- en: Related to sample rate is the *analog bandwidth*. The oscilloscope’s front end
    will have a filter to prevent too high a frequency from coming through to the
    sample circuit, and the bandwidth represents where that frequency starts to “roll
    off.” Some amount of higher frequency still does get through, as the filter is
    not perfect. The accepted method to characterize a filter is called the “3 dB”
    point, which translates to an *attenuation* of the filtered signal to 70.7 percent
    of the actual amplitude.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 与采样率相关的是*模拟带宽*。示波器的前端会有一个滤波器，防止过高的频率传递到采样电路，带宽表示这个频率开始“衰减”的位置。仍然有一些高频信号会通过，因为滤波器并不完美。表征滤波器的公认方法称为“3
    dB”点，这意味着*衰减*后的信号幅度是实际幅度的70.7%。
- en: When a scope has a 100 MHz bandwidth, this means that if you put a 10 MHz 1
    V sine wave into the oscilloscope, you’d see a 10 MHz sine wave with an amplitude
    of 1 V (as expected). But if you put a 100 MHz sine wave into the oscilloscope,
    you’d see only a 0.707 V amplitude signal. As you increase the frequency of the
    sine wave, the amplitude of the sine wave is reduced.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 当示波器的带宽为100 MHz时，这意味着如果你将一个10 MHz、1 V的正弦波输入示波器，你会看到一个幅度为1 V的10 MHz正弦波（如预期）。但是如果你将一个100
    MHz的正弦波输入示波器，你只会看到一个幅度为0.707 V的信号。当你增加正弦波的频率时，正弦波的幅度会减小。
- en: If you are talking digital sampling, things look slightly different. A digital
    square wave actually has “infinite” frequencies present. In practice you don’t
    need such infinite bandwidth, but a 2.5× to 5× higher bandwidth than the digital
    wave will keep edges reasonably crisp. As an example, [Figure A-16](#figureA-16)
    shows an 18 MHz square wave being sampled at 2.5 GS/s with a 250 MHz analog bandwidth.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你讨论的是数字采样，情况稍有不同。数字方波实际上有“无限”的频率存在。实际上，你不需要如此无限的带宽，但比数字波形高2.5倍到5倍的带宽可以保持边缘的清晰度。举个例子，[图A-16](#figureA-16)显示了一个18
    MHz的方波，在2.5 GS/s的采样率下，用250 MHz的模拟带宽进行采样。
- en: '![faa016](image_fi/278748b01/faa016.png)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![faa016](image_fi/278748b01/faa016.png)'
- en: 'Figure A-16: An 18 MHz square wave comes through as clean with a 250 MHz bandwidth.'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 图A-16：一个18 MHz的方波通过250 MHz带宽时是干净的。
- en: Compare [Figure A-16](#figureA-16) with the same square wave with 20 MHz analog
    bandwidth in [Figure A-17](#figureA-17) (the oscilloscope we’re using has the
    ability to switch the bandwidth).
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 将[图 A-16](#figureA-16)与[图 A-17](#figureA-17)中相同的20 MHz模拟带宽的方波进行对比（我们使用的示波器具有切换带宽的能力）。
- en: Many scopes now have the bandwidth (and sometimes the sample rate) as an “in-field
    upgradable” solution, which means the oscilloscope hardware has a higher bandwidth
    present, but you need to pay to unlock that feature. The probes themselves may
    be matched to the model, so if you order the 100 MHz bandwidth scope, it ships
    only with probes that have a 100 MHz bandwidth as well. On many models you can
    find information about how that upgrade process works online, and you might find
    it works with your budget to purchase a lower-end scope that allows you to unlock
    higher sample rates and bandwidths later.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 现在许多示波器的带宽（有时还包括采样率）是“现场可升级”的解决方案，这意味着示波器硬件已经具备更高的带宽，但你需要付费解锁该功能。探头本身可能与型号匹配，因此如果你订购的是100
    MHz带宽的示波器，它只会配备100 MHz带宽的探头。在许多型号中，你可以在线查找到关于如何进行此升级过程的信息，你可能会发现，购买一个较低端的示波器并以后解锁更高的采样率和带宽符合你的预算。
- en: '![faa017](image_fi/278748b01/faa017.png)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![faa017](image_fi/278748b01/faa017.png)'
- en: 'Figure A-17: An 18 MHz square wave comes through as a sine wave with 20 MHz
    bandwidth since no higher frequency components are present.'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-17：一个18 MHz的方波以20 MHz带宽的正弦波形式出现，因为没有更高频率的成分。
- en: Other Features
  id: totrans-123
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 其他功能
- en: This book isn’t an “introduction to electronics” book, so we won’t dwell too
    much on other features. One thing you’ll often see is an ability to *decode* certain
    signals such as RS232 and I2C. It can be a useful feature, but in practice it’s
    often easier to use a logic analyzer for this (discussed next).
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 本书不是一本“电子学入门”书籍，因此我们不会过多地讨论其他功能。你经常会看到一种功能是能够*解码*某些信号，比如RS232和I2C。这是一个有用的功能，但在实践中，使用逻辑分析仪来完成这个任务通常更为简单（下面将进行讨论）。
- en: The one feature that *is* useful is when that decoding can also generate a trigger
    signal—that is, you can trigger the analog oscilloscope measurement on a digital
    I/O data byte. Many oscilloscopes that support decoding also support this real-time
    trigger functionality. You can also often send this trigger to a “Trigger Out”
    connector, which can trigger fault injection equipment.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: '*有用*的一个特性是，当解码功能还可以生成触发信号时——也就是说，你可以在数字I/O数据字节上触发模拟示波器测量。许多支持解码的示波器也支持这种实时触发功能。你通常也可以将这个触发信号发送到“触发输出”连接器，这样就能触发故障注入设备。'
- en: 'Viewing Logic Waveforms: $300 to $8,000'
  id: totrans-126
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 逻辑波形查看：$300 到 $8,000
- en: Compared to viewing analog waveforms, viewing digital waveforms normally means
    just being able to see zeros and ones on a data bus. A typical data capture looks
    something like [Figure A-18](#figureA-18), which is an example of monitoring an
    SPI data transaction along with a serial interface.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 与查看模拟波形相比，查看数字波形通常意味着只能在数据总线上看到零和一。一个典型的数据捕获类似于[图 A-18](#figureA-18)，这是监测SPI数据传输及串行接口的一个例子。
- en: There are a few main vendors of *logic analyzer* tools, but we’ll mostly concentrate
    on PC-based instruments because when using the logic analyzers, you are more often
    setting up digital decoding features and exporting data. It’s much easier to perform
    that on a PC, so logic analyzers generally lend themselves very well to being
    based on a PC platform.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 有几个主要的*逻辑分析仪*工具供应商，但我们将主要关注基于PC的仪器，因为在使用逻辑分析仪时，你更常设置数字解码功能并导出数据。在PC上执行这些操作要容易得多，因此逻辑分析仪通常非常适合基于PC平台。
- en: '![faa018](image_fi/278748b01/faa018.png)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![faa018](image_fi/278748b01/faa018.png)'
- en: 'Figure A-18: Example of a logic analyzer capture'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-18：逻辑分析仪捕获示例
- en: For PC-based platforms, the most well-known vendor is Saleae. That company’s
    products have been so successful that earlier versions remain widely counterfeited
    and available on various markets, sold as ultra-cheap (less than $10) logic analyzers.
    The most recent versions of Saleae analyzers feature both analog and digital measurements
    possible on each pin, which allows you to view what’s happening in “real life”
    (the analog domain), while also trying to translate to simple ones and zeros.
    That is also useful during an investigation, as sometimes you aren’t sure of the
    actual logic level in use (is it 1.8 V, 3.3 V, and so on?). The Saleae software
    makes it easy to decode various protocols and observe what is happening across
    the entire system. The software supports almost any protocol you are likely to
    run across, making it an easy recommendation as a critical part of your toolkit.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 对于基于PC的平台，最著名的供应商是Saleae。该公司的产品如此成功，以至于早期版本被广泛仿造并在各种市场上以超低价格（低于$10）出售，作为廉价的逻辑分析仪。Saleae分析仪的最新版本在每个引脚上都可以进行模拟和数字测量，这使你可以查看“现实生活”中的情况（模拟域），同时尝试将其转化为简单的1和0。这在调查过程中也非常有用，因为有时你不确定实际使用的逻辑电平（是1.8
    V、3.3 V等吗？）。Saleae的软件使得解码各种协议变得容易，并能观察整个系统中发生的情况。该软件支持几乎所有你可能遇到的协议，因此它是你工具箱中的关键部分，值得推荐。
- en: The Saleae Logic hardware works by streaming data back to your computer, which
    means there is no real limit on capture length. You can capture hours of data
    if your computer can keep up. Because digital data can be easily compressed (you
    don’t need to store constant states), the digital files are much more reasonable
    compared to analog measurement sampling.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: Saleae Logic硬件通过将数据流回计算机来工作，这意味着捕获长度没有实际限制。如果你的计算机能跟得上，你可以捕获数小时的数据。由于数字数据可以轻松压缩（你不需要存储常量状态），与模拟测量采样相比，数字文件要合理得多。
- en: The only downside of the Saleae Logic is the number of pins. The largest model
    with 16 inputs may not be enough. And while the Saleae Logic Pro 16 has 16 inputs,
    it can keep up the 500 MS/s sample rate only across six channels; enabling all
    16 channels drops the digital sample rate to 125 MS/s. If you plan on sniffing
    a large bus, the Saleae may not be the best choice.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: Saleae Logic的唯一缺点是引脚数量。最大型号的16个输入可能不足够。而尽管Saleae Logic Pro 16具有16个输入，但它只能在6个通道上保持500
    MS/s的采样率；启用所有16个通道会将数字采样率降至125 MS/s。如果你计划监听一个大型总线，Saleae可能不是最好的选择。
- en: If you need more signals, the Intronix LA1034 LogicPort is a relatively old
    instrument that remains highly competitive. It has 34 channels of inputs and samples
    at 500 MS/s across all 34 channels, giving it one of the best value propositions
    available on the market.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你需要更多的信号，Intronix LA1034 LogicPort是一款相对较旧的设备，但依然具有很强的竞争力。它具有34个输入通道，并且在所有34个通道上以500
    MS/s的速率进行采样，提供了市场上最具性价比的选择之一。
- en: We haven’t covered several vendors of other tools, but instead want to provide
    a few tips. If you want to go with a high-end tool, NCI Logic Analyzers makes
    the GoLogicXL series, which offers 4 GS/s across 36 or 72 channels. The GoLogicXL
    also offers hardware triggering, something we’ll cover next.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 我们没有涉及其他工具的几个供应商，而是想提供一些提示。如果你想选择一个高端工具，NCI Logic Analyzers生产的GoLogicXL系列提供了36或72个通道，采样速率为4
    GS/s。GoLogicXL还提供硬件触发功能，接下来我们将讨论这一点。
- en: 'Triggering on Serial Buses: $300 to $8,000'
  id: totrans-136
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 串行总线触发：$300到$8,000
- en: The Saleae logic analyzer works by downloading “raw” bits to the computer. The
    logic analyzer doesn’t understand whether it’s I2C, UART, or SPI traffic, which
    is fine for analysis, but what if you need to trigger on specific bytes?
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: Saleae逻辑分析仪通过将“原始”比特下载到计算机来工作。逻辑分析仪并不理解它是否是I2C、UART或SPI流量，这对于分析来说没问题，但如果你需要对特定字节进行触发怎么办？
- en: '*Triggering* on specific data is a common task. Many logic analyzers that advertise
    “hardware trigger” support triggering only on certain digital patterns presented
    to the logic analyzer inputs. For example, an 8-input logic analyzer can be configured
    to trigger on the pattern “10010111” or maybe even on a sequence of such patterns.
    It’s generally designed to support triggering on a memory access on a parallel
    bus, for example. But if we are trying to trigger on a serial protocol, this simple
    pattern-based trigger won’t be remotely flexible enough for us.'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: '*触发*特定数据是一个常见的任务。许多广告支持“硬件触发”的逻辑分析仪，仅能在提供给逻辑分析仪输入的特定数字模式上触发。例如，一个 8 输入的逻辑分析仪可以配置为在模式“10010111”上触发，甚至可能在这样模式的序列上触发。它通常设计为支持在并行总线上发生内存访问时触发。但如果我们尝试在串行协议上触发，这种简单的基于模式的触发就远远不够灵活了。'
- en: In that case, we’ll need a smarter logic analyzer, since the hardware capture
    device must understand enough about the protocol to actually trigger on specific
    data bytes. That is, the logic analyzer itself needs to decode the serial data
    in real time to create a trigger signal.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，我们需要一台更智能的逻辑分析仪，因为硬件捕获设备必须足够了解协议，才能在特定的数据字节上触发。也就是说，逻辑分析仪本身需要实时解码串行数据，以产生触发信号。
- en: Many logic analyzers don’t support this feature, as they rely on the flexibility
    of a computer to perform the protocol analysis. Some oscilloscopes with serial
    bus decoding do support triggering on decoded serial data, but it’s important
    to check that the feature can be used to generate a trigger on a specific data
    sequence before investing in any given oscilloscope.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 许多逻辑分析仪不支持此功能，因为它们依赖计算机的灵活性来执行协议分析。一些支持串行总线解码的示波器确实支持在解码后的串行数据上触发，但在投资任何给定的示波器之前，检查该功能是否能够用来在特定数据序列上生成触发信号是非常重要的。
- en: Many of the professional (expensive) logic analyzers will support such features.
    For example, the NCI GoLogicXL does support this feature, allowing you to match
    specific packets from various protocols, including SPI, CAN, I2C, and so on. This
    trigger output can then be routed to other devices—normally it’s shown triggering
    an oscilloscope, but we can use it for fault injection or other tasks as we please.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 许多专业（昂贵的）逻辑分析仪会支持此类功能。例如，NCI GoLogicXL 就支持这一功能，允许你匹配来自各种协议的特定数据包，包括 SPI、CAN、I2C
    等。然后可以将该触发输出路由到其他设备——通常是触发示波器，但我们可以根据需要将其用于故障注入或其他任务。
- en: On the lower-cost side, you’ll find some oscilloscopes offer a “trigger on serial
    data” feature, which may be a paid upgrade or available as part of various options
    you can enable on the oscilloscope in the field.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 在低成本的一侧，你会发现一些示波器提供“在串行数据上触发”功能，这可能是一个付费升级，或者是示波器在现场可启用的各种选项的一部分。
- en: 'Decoding Serial Protocols: $50 to $8,000'
  id: totrans-143
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 解码串行协议：$50 到 $8,000
- en: For UART serial I/O, you often need only a PC and serial cable. You can buy
    *USB-to-serial cables* that don’t include any level converters and directly interface
    to the TTL UART pins found in many embedded systems. Examples include cables based
    on the FTDI FT232R chip. You can use *GNU Screen* on Linux or *PuTTY* on Windows,
    or any number of other software applications to interface with the interconnection
    as if it were a terminal.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 UART 串行 I/O，通常只需要一台 PC 和串行电缆。你可以购买不包含任何电平转换器的*USB转串口电缆*，它们可以直接与许多嵌入式系统中的
    TTL UART 引脚连接。比如基于 FTDI FT232R 芯片的电缆。你可以在 Linux 上使用*GNU Screen*，在 Windows 上使用*PuTTY*，或者使用其他软件应用程序来与接口进行通信，就像它是一个终端一样。
- en: While the previous logic analysis section assumed you wanted to capture “raw”
    logic levels, that might not be needed. You might care only about the SPI data
    going across a bus, for example, which is an easier task to accomplish. This means
    you can use a device that implements the protocol you wish to sniff, and it will
    present only the “higher-level” data rather than specific bus transitions.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然前面的逻辑分析部分假设你想捕获“原始”逻辑电平，但这可能并不必要。你可能只关心例如通过总线传输的 SPI 数据，这是一个更容易完成的任务。这意味着你可以使用一个实现你想嗅探的协议的设备，它将只显示“更高层次”的数据，而不是具体的总线过渡。
- en: One frequent method is actually to implement the protocol yourself on a microcontroller
    and then forward that data to a computer over a serial interface. Arduinos often
    are used for this exact task. One advantage is that you can also build trigger
    logic; rather than purchasing an expensive logic analyzer, you may be able to
    build the trigger logic off a low-cost Arduino or similar.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 一个常见的方法是自行在微控制器上实现协议，然后通过串行接口将数据转发到计算机。Arduino通常用于这一特定任务。一个优势是，你还可以构建触发逻辑；而不是购买昂贵的逻辑分析仪，你可能能够通过低成本的Arduino或类似设备来构建触发逻辑。
- en: An open source tool designed to make this easier is the *GreatFET* by Great
    Scott Gadgets (see [Figure A-19](#figureA-19)). This tool has a microcontroller
    that exposes many of the usual interfaces you might need, such as SPI, I2C, and
    UART. In addition, it can run as a simple logic analyzer to capture the actual
    line-level transitions.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 一个旨在简化这一过程的开源工具是由Great Scott Gadgets开发的*GreatFET*（见[图A-19](#figureA-19)）。该工具具有一个微控制器，能够暴露许多你可能需要的常用接口，例如SPI、I2C和UART。此外，它还可以作为一个简单的逻辑分析仪，捕捉实际的线路级过渡。
- en: '![faa019](image_fi/278748b01/faa019.png)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![faa019](image_fi/278748b01/faa019.png)'
- en: 'Figure A-19: A GreatFET One interface device, available from Great Scott Gadgets
    (image source: Great Scott Gadgets)'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 图A-19：GreatFET One接口设备，来自Great Scott Gadgets（图片来源：Great Scott Gadgets）
- en: Whereas GreatFET relies on the microcontroller for the majority of decoding
    work, another open source tool called the *Glasgow Interface Explorer* ([https://github.com/GlasgowEmbedded/](https://github.com/GlasgowEmbedded/))
    has a small FPGA that is reconfigured to allow even more complex decoding actions.
    At the time of writing, Glasgow was just being released, but in theory, it allows
    almost perfectly timed trigger generation, so it could replace an expensive logic
    analyzer for the task of triggering based on protocol-level data. We wouldn’t
    normally mention tools without having used them, but this one has a unique feature
    set that will be an important addition to your toolset and is well worth exploring.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 与GreatFET依赖微控制器来处理大部分解码工作不同，另一个开源工具*Glasgow接口探测器*（[https://github.com/GlasgowEmbedded/](https://github.com/GlasgowEmbedded/)）配有一个小型FPGA，可重新配置以实现更复杂的解码操作。在撰写时，Glasgow刚刚发布，但理论上它能够实现几乎完美的定时触发生成，因此它有可能替代昂贵的逻辑分析仪，承担基于协议级数据触发的任务。我们通常不会提及尚未使用过的工具，但这个工具具有独特的功能集，值得作为你工具集的重要补充，值得深入探索。
- en: Commercial tools offer protocol sniffers as well. Total Phase offers a simple
    I2C/SPI sniffer called the Beagle I2C/SPI sniffer. It comes with a GUI that simplifies
    monitoring of large I2C or SPI transactions, which can be useful when reverse-engineering
    a complex bus.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 商业工具也提供协议嗅探器。Total Phase提供了一款简单的I2C/SPI嗅探器，叫做Beagle I2C/SPI嗅探器。它配有图形界面，简化了大规模I2C或SPI事务的监控，这在逆向工程复杂总线时非常有用。
- en: 'CAN Bus Sniffing and Triggering: $50 to $5,000'
  id: totrans-152
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CAN总线嗅探与触发：$50 至 $5,000
- en: The *Controller Area Network (CAN)* bus is used in a lot of automotive applications,
    and a number of low-cost and professional-grade solutions are available. Several
    tools can speak CAN, like the CANtact and CANbadger as well as Riscure’s Huracan.
    The latter was designed to be able to trigger external fault injection based on
    specific CAN traffic. Like many serial protocols, you might find basic triggering
    support available in a hardware logic analyzer or oscilloscope serial triggering
    module.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '*控制器局域网络（CAN）*总线在许多汽车应用中得到了广泛使用，并且有许多低成本和专业级的解决方案可供选择。一些工具可以进行CAN通信，如CANtact、CANbadger以及Riscure的Huracan。后者的设计目的是能够根据特定的CAN流量触发外部故障注入。像许多串行协议一样，你可能会在硬件逻辑分析仪或示波器的串行触发模块中找到基本的触发支持。'
- en: Linux also has CAN support. Via SocketCAN, you can use your favorite packet
    sniffer in Linux to look at CAN. But if you’d like more on CAN, check out Craig
    Smith’s *Car Hackers Handbook* (2016), published by No Starch Press and the OpenGarages
    website, for more CAN-related tools.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: Linux也支持CAN。通过SocketCAN，你可以在Linux中使用你最喜欢的数据包嗅探工具来查看CAN流量。如果你想了解更多关于CAN的内容，可以参考Craig
    Smith的*Car Hackers Handbook*（2016年），由No Starch Press出版，并且可以在OpenGarages网站上找到更多与CAN相关的工具。
- en: 'Ethernet Sniffing: $50'
  id: totrans-155
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 以太网嗅探：$50
- en: 'You may consider *Ethernet sniffing* “not a hardware topic,” but it’s definitely
    relevant for embedded system analysis: that box may just be revealing all kinds
    of interesting information about itself over the wire.'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能认为*以太网嗅探*“不是硬件话题”，但它对嵌入式系统分析确实很相关：那台设备可能正通过网络传输关于自身的各种有趣信息。
- en: Ethernet is probably the easiest high-speed interface to interact with, and
    no hardware hack is generally needed. Many small embedded devices have Ethernet
    ports, such as the Arduino controller with its Ethernet Shield, the Raspberry
    Pi, and many other sub-$10 devices. It’s just a matter of installing the right
    software, such as WireShark for sniffing, and then plugging in the Ethernet cable.
    If you’re trying to passively monitor Ethernet, it helps to use the *Throwing
    Star LAN Tap* from Great Scott Gadgets or an old-school network hub instead of
    a switch.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 以太网可能是最容易与之交互的高速接口，通常不需要硬件改动。许多小型嵌入式设备都有以太网端口，比如带以太网扩展板的 Arduino 控制器、树莓派以及许多其他低于
    10 美元的设备。只需安装正确的软件，如 WireShark 用于嗅探，然后插入以太网电缆。如果你试图被动监控以太网，使用 Great Scott Gadgets
    的 *Throwing Star LAN Tap* 或一台老式网络集线器（而不是交换机）会更有帮助。
- en: 'Interacting Through JTAG: $20 to $10,000'
  id: totrans-158
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 通过 JTAG 交互：$20 到 $10,000
- en: 'JTAG can be nice for debugging and inspecting a device. As we discussed in
    Chapter 2, JTAG has two main uses: *boundary scan* and *debugging*. The tools
    for each use case vary slightly. Some tools can be used for both, but the software
    is normally different.'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: JTAG 对于调试和检查设备非常有用。如我们在第二章中讨论的，JTAG 有两个主要用途：*边界扫描* 和 *调试*。这两种用途的工具略有不同。某些工具可以同时用于这两种用途，但软件通常是不同的。
- en: General JTAG and Boundary Scan
  id: totrans-160
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 通用 JTAG 和边界扫描
- en: Using JTAG requires you to “find” the JTAG port on a board. You may luck out
    if the target uses a standard pinout, but if not, the *JTAGulator* by Joe Grand
    can auto-detect JTAG pinouts. The JTAGulator is self-contained (it doesn’t rely
    on host computer software), so it tends to be very reliable and can also perform
    various boundary scan and debug tasks. It’s a slightly more niche tool than the
    general-purpose JTAG interface hardware, but the feature set is well designed
    for the more black-box work you end up doing when it comes to hardware hacking.
    It also supports various low-level boundary scan options, and even can work as
    a debug interface in some cases.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 JTAG 需要你在板上“找到” JTAG 端口。如果目标使用标准引脚排列，你可能会很幸运，但如果不是，Joe Grand 的 *JTAGulator*
    可以自动检测 JTAG 引脚排列。JTAGulator 是一个自包含的工具（不依赖于主机计算机的软件），因此它通常非常可靠，并且还可以执行各种边界扫描和调试任务。它比通用
    JTAG 接口硬件稍微更为小众，但其功能集非常适合硬件黑盒工作，它也支持各种低级别的边界扫描选项，甚至在某些情况下可以作为调试接口使用。
- en: For pure boundary scan tooling (toggling pins or checking states), the *TopJTAG*
    software is one of the best options, and it has a reasonable license fee cost.
    Many other commercial software for boundary scan are thousands of dollars and
    don’t work as well as TopJTAG.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 对于纯边界扫描工具（切换引脚或检查状态），*TopJTAG* 软件是最佳选择之一，而且其许可证费用合理。许多其他商业边界扫描软件的费用高达数千美元，而且表现不如
    TopJTAG。
- en: For open source boundary scan, the *Viveris JTAG Boundary Scanner* ([https://github.com/viveris/jtag-boundary-scanner/](https://github.com/viveris/jtag-boundary-scanner/))
    provides similar functionality, and open source Python bindings ([https://github.com/colinoflynn/pyjtagbs/](https://github.com/colinoflynn/pyjtagbs/)),
    called *pyjtagbs* (where *bs* obviously stands for boundary scan), allow usage
    of the library from Python code.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 对于开源边界扫描，*Viveris JTAG Boundary Scanner* ([https://github.com/viveris/jtag-boundary-scanner/](https://github.com/viveris/jtag-boundary-scanner/))
    提供类似的功能，开源 Python 绑定库 ([https://github.com/colinoflynn/pyjtagbs/](https://github.com/colinoflynn/pyjtagbs/))，名为
    *pyjtagbs*（其中 *bs* 显然是边界扫描的缩写），允许在 Python 代码中使用该库。
- en: These libraries require a hardware probe to interface to the device. The most
    commonly supported option (including both TopJTAG and others) is either a SEGGER
    J-Link or an FTDI FT2232H–based interface cable. The FTDI-based cables are not
    specific to any vendor, but one of the best options is Joe FitzPatrick’s *Tigard*
    board, which provides voltage translation with included voltage selection and
    breakout cables to make it easy to adapt to your target board.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 这些库需要一个硬件探针与设备进行连接。最常见的支持选项（包括 TopJTAG 和其他工具）是 SEGGER J-Link 或基于 FTDI FT2232H
    的接口电缆。基于 FTDI 的电缆并不特定于任何厂商，但最好的选项之一是 Joe FitzPatrick 的 *Tigard* 板，它提供电压转换，并附带电压选择和接线电缆，使其易于适配你的目标板。
- en: JTAG Debug
  id: totrans-165
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: JTAG 调试
- en: '*Debugging* means interacting with the debug core on the device, which allows
    you to read out or reprogram the device, at minimum, but it also means you can
    view and modify internal memory and registers. This again requires software and
    hardware solutions. The software typically involves two parts: the software that
    interfaces to the hardware and the higher-level debug software you (the human)
    interact with.'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '*调试* 意味着与设备上的调试核心进行交互，这至少允许你读取或重新编程设备，但它也意味着你可以查看和修改内部内存和寄存器。这同样需要软件和硬件的解决方案。软件通常涉及两个部分：与硬件接口的程序和你（人类）交互的更高级别调试软件。'
- en: For open source software, the *OpenOCD* project is the best-known option for
    the hardware interface portion, which supports a large number of hardware interfaces
    and target chips. Many of them use the FTDI FT2232H chip (for example, the Olimex
    ARM-USB-OCD-H, which you can purchase via Digi-Key/Mouser, and the Tigard board
    mentioned earlier).
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 对于开源软件，*OpenOCD* 项目是硬件接口部分最著名的选择，支持大量硬件接口和目标芯片。其中许多使用 FTDI FT2232H 芯片（例如 Olimex
    ARM-USB-OCD-H，你可以通过 Digi-Key/Mouser 购买，或之前提到的 Tigard 板）。
- en: Another good low-cost option is the *Black Magic Probe* by 1BitSquared. It’s
    an open source tool that supports many types of Arm Cortex-A or Cortex-M devices.
    Be sure to check the support list for your specific device. The Black Magic Probe
    doesn’t rely on OpenOCD but instead exposes the required interface for the higher-level
    debug tool.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个不错的低成本选择是 1BitSquared 的*Black Magic Probe*。这是一款开源工具，支持多种类型的 Arm Cortex-A
    或 Cortex-M 设备。务必检查你的特定设备是否在支持列表中。Black Magic Probe 不依赖于 OpenOCD，而是暴露所需的接口给更高级别的调试工具。
- en: Again, looking at open source options, the *GNU Debugger (GDB)* is the most
    likely higher-level interface software you will use, and it has a variety of GUIs
    built on top of it. The GDB software will interface to either OpenOCD or the Black
    Magic Probe.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 再看开源选项，*GNU 调试器（GDB）* 是你最有可能使用的更高级别的接口软件，并且它有许多基于 GDB 的 GUI。GDB 软件将与 OpenOCD
    或 Black Magic Probe 进行接口。
- en: Be aware the previous open-source tooling is mostly relevant to popular cores
    such as Arm devices (and RISC-V into the future). If you are looking at less popular
    devices, which are often found in automotive or industrial processors, you may
    have very limited (or no) open-source and low-cost options.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，前面提到的开源工具大多与流行核心（如 Arm 设备，未来可能包括 RISC-V）相关。如果你关注的是不太常见的设备，通常出现在汽车或工业处理器中，那么你可能会面临非常有限（或没有）开源和低成本选项。
- en: On the commercial (higher cost) end of the spectrum, several choices are available
    that involve both hardware and software solutions, and in our experience, they
    are often well worth the money. Most of the time these will support new devices
    before they are even released for general use, and if you are using tools in a
    professional environment, this can easily save you money compared to the cost
    (in time) of finding that your target device doesn’t work with OpenOCD and you
    need to add support for it.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 在商业（高成本）端，提供了多个涉及硬件和软件解决方案的选择，在我们的经验中，它们通常非常值得花钱。大多数情况下，这些工具会在新设备正式发布之前就提供支持，如果你在专业环境中使用工具，这可以节省你大量时间，因为你可能会发现目标设备与
    OpenOCD 不兼容，且需要为其添加支持。
- en: SEGGER makes the popular *J-Link* tool, which supports a huge number of Arm
    devices and is especially popular on Cortex-M series devices (some of the models
    support Cortex-A too). The SEGGER J-Link is available in several models. If you
    are a student, the SEGGER J-Link EDU is available at a much lower cost ($20) than
    any other professional tool. The different J-Link models also typically offer
    evaluation modes to allow you to sample certain features (such as the handy Ozone
    debugger offered with the company’s tools) that you wouldn’t otherwise be able
    to use. High-end SEGGER tools (such as J-Trace Pro) support very high-speed debug
    and trace interfaces.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: SEGGER 制造了流行的*J-Link*工具，支持大量 Arm 设备，特别是在 Cortex-M 系列设备上非常受欢迎（一些型号也支持 Cortex-A）。SEGGER
    J-Link 有多个型号。如果你是学生，SEGGER J-Link EDU 以比任何其他专业工具都要低的价格（$20）提供。不同的 J-Link 型号通常还提供评估模式，允许你体验某些功能（例如公司工具中提供的实用
    Ozone 调试器），这些功能否则是无法使用的。高端 SEGGER 工具（如 J-Trace Pro）支持非常高速的调试和跟踪接口。
- en: Lauterbach also has a number of JTAG products that support high-speed tracing
    and debugging. The Lauterbach tools, such as the PowerDebug Pro and PowerDebug
    USB 3, support several device architectures, including Arm, PowerPC, Intel, AVR,
    ARC, and so on. While the Lauterbach tools may be more expensive than other offerings,
    the potential device support list is huge and means the single tool may be more
    cost-effective than multiple separate tools. The ability to work with different
    architectures and device types will be useful if you plan on straying from the
    more common Arm devices.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: Lauterbach 也有多款支持高速跟踪和调试的 JTAG 产品。Lauterbach 工具，如 PowerDebug Pro 和 PowerDebug
    USB 3，支持多种设备架构，包括 Arm、PowerPC、Intel、AVR、ARC 等。虽然 Lauterbach 工具的价格可能高于其他产品，但其支持的设备种类非常丰富，因此一个工具可能比多个单独的工具更具成本效益。如果你计划使用不同的架构和设备类型，Lauterbach
    工具将非常有用。
- en: Other vendors provide tools that may be more suited to specific architectures
    as well. If you are using PowerPC devices that are common on some automotive ECUs,
    you may find that the PEmicro Multilink is a reasonable-cost offering ($200).
    In that case, the hardware interface tool also needs a separate software license
    for the debug, although you can freely use the GDB with an included GDB server
    interface for this debug tool.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 其他供应商也提供适用于特定架构的工具。如果你使用的是一些汽车电子控制单元（ECU）中常见的 PowerPC 设备，可能会发现 PEmicro Multilink
    是一种性价比较高的选择（$200）。在这种情况下，硬件接口工具还需要一个单独的软件许可证来进行调试，尽管你可以自由使用 GDB 及其附带的 GDB 服务器接口进行调试。
- en: 'PCIe Communication: $100 to $1,000'
  id: totrans-175
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PCIe 通信：$100 到 $1,000
- en: '*PCI Express (PCIe)* is seen in high-end embedded systems or PCs. PCIe FPGA
    boards are available from every vendor. With some HDL coding skills, these devices
    can be configured to log memory contents, poke at other hardware devices, or monitor
    and modify data in memory. They have a steep learning curve and generally are
    pricey, but Lattice periodically offers one of its PCIe-based ECP3 boards on sale.'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: '*PCI Express (PCIe)* 在高端嵌入式系统或个人电脑中较为常见。每个供应商都有提供 PCIe FPGA 开发板。有一定 HDL 编程技能的用户，可以配置这些设备来记录内存内容、与其他硬件设备交互，或监控并修改内存中的数据。它们有较高的学习曲线，而且通常价格不菲，但
    Lattice 会定期促销其基于 PCIe 的 ECP3 开发板。'
- en: '*PicoEVB* is a small FPGA-based platform that fits in a laptop using the M.2
    standard (see [Figure A-20](#figureA-20)). It’s a relatively low-cost solution
    that works with modern laptops, and it has several examples for getting PCIe transactions
    working.'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: '*PicoEVB* 是一款小型 FPGA 平台，符合笔记本电脑的 M.2 标准（见 [图 A-20](#figureA-20)）。它是一个相对低成本的解决方案，适用于现代笔记本电脑，并且提供多个示例来使
    PCIe 事务工作。'
- en: '![faa020](image_fi/278748b01/faa020.png)'
  id: totrans-178
  prefs: []
  type: TYPE_IMG
  zh: '![faa020](image_fi/278748b01/faa020.png)'
- en: 'Figure A-20: PicoEVB, an FPGA that fits in a laptop’s M.2 slot, can be used
    to explore PCIe.'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-20：PicoEVB，一款适用于笔记本 M.2 插槽的 FPGA，可以用来探索 PCIe。
- en: Broadcom has a “USB 3.0 to PCIe” bridge chip, the USB3380\. It can operate as
    a PCIe device connected to a system, but it’s configurable to pass traffic on
    to a USB host or initiate PCIe transactions on command from the USB host. The
    USB3880 reference boards are used for *SLOTSCREAMER*, an inexpensive, open source
    PCIe DMA attack board for dumping and modifying system memory via PCIe.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: Broadcom 有一款“USB 3.0 到 PCIe”桥接芯片，USB3380。它可以作为一个 PCIe 设备连接到系统，但也可以配置为将流量传递到
    USB 主机，或根据 USB 主机的命令发起 PCIe 事务。USB3880 参考开发板用于 *SLOTSCREAMER*，这是一款廉价的开源 PCIe DMA
    攻击板，用于通过 PCIe 导出和修改系统内存。
- en: 'USB Sniffing: $100 to $6,000'
  id: totrans-181
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: USB 嗅探：$100 到 $6,000
- en: One common task for working with computer peripherals is to *sniff USB traffic*.
    Several commercial solutions are available, but one of our favorites is the Total
    Phase Beagle 480 (see [Figure A-21](#figureA-21)). This device sniffs USB 2.0
    traffic (a more expensive version does USB 3.0 as well). While relatively expensive,
    the tool makes it easy to deal with the resulting USB data. As the USB protocol
    can be relatively complicated, you are paying more for the analysis software than
    for the physical hardware. Every USB device functions at least to some degree
    at USB 1.1 speeds; therefore, one trick is to insert an old USB 1.1 hub in between
    to make the device fall back to lower speeds.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 处理计算机外设时的一个常见任务是 *嗅探 USB 流量*。市面上有几款商业化的解决方案，但我们最喜欢的一款是 Total Phase Beagle 480（见
    [图 A-21](#figureA-21)）。该设备能够嗅探 USB 2.0 流量（更昂贵的版本也支持 USB 3.0）。虽然相对较贵，但该工具使得处理得到的
    USB 数据变得非常简单。由于 USB 协议相对复杂，你支付的更多是分析软件的费用，而非物理硬件。每个 USB 设备至少在 USB 1.1 速度下能够正常工作；因此，一个技巧是插入一个旧款的
    USB 1.1 集线器，从而使设备降速到较低的速度。
- en: When it comes to open source, several options are also available. If you need
    to manipulate USB traffic, the *FaceDancer* is a derivative of the GoodFET that
    allows you to emulate any arbitrary USB device in Python on a secondary system
    as well as perform USB man-in-the-middle attacks.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 在开源领域，也有多个选择。如果你需要操控USB流量，*FaceDancer* 是 GoodFET 的衍生工具，它允许你在辅助系统上使用 Python 模拟任何任意的
    USB 设备，并进行 USB 中间人攻击。
- en: '![faa021](image_fi/278748b01/faa021.png)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![faa021](image_fi/278748b01/faa021.png)'
- en: 'Figure A-21: Total Phase Beagle USB sniffers have an easy-to-use GUI to make
    decoding protocols simple.'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-21：Total Phase Beagle USB 嗅探器配有易于使用的图形界面，使得解码协议变得简单。
- en: Colin has developed the *PhyWhisperer-USB*, which sniffs USB 2.0 traffic. The
    PhyWhisperer-USB lacks the nice GUI software and buffer to deal with bursty traffic
    that the Total Phase Beagle 480 has, as the PhyWhisperer-USB is designed first
    for triggering on USB data.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: Colin 开发了 *PhyWhisperer-USB*，它可以嗅探 USB 2.0 流量。PhyWhisperer-USB 缺少 Total Phase
    Beagle 480 那样精美的图形界面软件和处理突发流量的缓冲区，因为 PhyWhisperer-USB 首先是为 USB 数据触发而设计的。
- en: The latest in USB sniffing and hacking can be found in the *LUNA* project by
    Kate Temkin and is also available from Great Scott Gadgets. As of this book’s
    writing, the tool was in a late beta state, but it uses a unique architecture
    that allows it to be used for sniffing, interposing, and all sorts of USB tasks,
    like the triggering tasks described next. We mention this tool despite not having
    used it ourselves, because the architecture is unique and it deserves a serious
    mention. Colin has often said that if LUNA was available when he started developing
    the PhyWhisperer-USB, he would have rather just bought a LUNA board himself! The
    LUNA board offers the ability to perform a wide variety of USB tasks well beyond
    just sniffing.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 最新的 USB 嗅探和破解技术可以在 Kate Temkin 的 *LUNA* 项目中找到，它也可以从 Great Scott Gadgets 购买。根据本书的写作时，工具处于晚期测试阶段，但它采用了独特的架构，允许它用于嗅探、插入和各种
    USB 任务，如接下来描述的触发任务。尽管我们自己没有使用过此工具，但由于其独特的架构，值得特别提及。Colin 曾经说过，如果 LUNA 在他开始开发 PhyWhisperer-USB
    时就已经上市，他宁愿自己购买 LUNA 板！LUNA 板能够执行远超嗅探之外的各种 USB 任务。
- en: 'USB Triggering: $250 to $6,000'
  id: totrans-188
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: USB 触发：$250 到 $6,000
- en: Besides just sniffing the USB data, you may also need to *trigger* on USB data.
    Triggering means that relative to the actual USB packet “going over the wire,”
    you need to generate a trigger signal. Several of the high-end USB sniffers can
    perform this task; for example, the Total Phase Beagle 480 has the capability
    to perform triggering based on USB packet data.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 除了仅嗅探 USB 数据外，你还可能需要在 USB 数据上进行 *触发*。触发意味着相对于实际传输的 USB 包“经过线缆”的时刻，你需要生成一个触发信号。一些高端的
    USB 嗅探器能够执行此任务；例如，Total Phase Beagle 480 就具备基于 USB 包数据进行触发的能力。
- en: A lower-cost option is the PhyWhisperer-USB, which is open source hardware and
    is sold by NewAE Technology, Inc. (see [Figure A-22](#figureA-22)).
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 一个低成本的选择是 PhyWhisperer-USB，它是开源硬件，由 NewAE Technology, Inc. 销售（见 [图 A-22](#figureA-22)）。
- en: '![faa022](image_fi/278748b01/faa022.png)'
  id: totrans-191
  prefs: []
  type: TYPE_IMG
  zh: '![faa022](image_fi/278748b01/faa022.png)'
- en: 'Figure A-22: PhyWhisperer-USB is an open source hardware tool for USB triggering
    and analysis.'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-22：PhyWhisperer-USB 是一个用于 USB 触发和分析的开源硬件工具。
- en: This tool is designed specifically for triggering on USB data packets, so it
    supports additional features, such as an ability to power-cycle the target and
    a Python 3 API to allow you to script the triggering mechanism. As previously
    mentioned, you may be able to perform some of these tasks with the LUNA project,
    so check the latest documentation for that project too.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 该工具专门为 USB 数据包触发设计，因此支持附加功能，如能够为目标设备重新上电，并且提供 Python 3 API 以允许你编写触发机制脚本。如前所述，你可能也能使用
    LUNA 项目执行其中一些任务，因此也请查看该项目的最新文档。
- en: 'USB Emulation: $100'
  id: totrans-194
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: USB 模拟：$100
- en: The previous tools concentrate on analyzing USB traffic but not modifying it.
    For modifications, the de facto tool is the open source *FaceDancer* project.
    While various hardware options are available, the GreatFET One (refer to [Figure
    A-19](#figureA-19)) is widely available commercially and supports the majority
    of features. The LUNA can also be used for interposing and emulating USB devices,
    and the use of an FPGA allows more complex operations than can be done in a microcontroller.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 前述工具专注于分析 USB 流量，而非修改它。要进行修改，事实上的工具是开源的 *FaceDancer* 项目。虽然有多种硬件选项可用，但 GreatFET
    One（见 [图 A-19](#figureA-19)）在商业上广泛可得，并且支持大多数功能。LUNA 也可以用于插入和模拟 USB 设备，而且 FPGA
    的使用使得它能够执行比微控制器更复杂的操作。
- en: 'SPI Flash Connections: $25 to $1,000'
  id: totrans-196
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SPI闪存连接：$25到$1,000
- en: Another common task is reading an *SPI flash memory chip*. Several options are
    available depending on what you need to accomplish. One commercial option is the
    SEGGER J-Link Plus (or any higher-end model in that series), which primarily serves
    as a robust debug adapter for Arm-based microcontrollers. If you are purchasing
    (or have) a J-Link for debug tasks, it serves as an excellent SPI Flash Programmer
    using the “J-Flash SPI” software.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个常见的任务是读取*SPI闪存芯片*。根据需要完成的任务，有几种可用的选项。一种商业选项是SEGGER J-Link Plus（或该系列中的任何高端型号），它主要作为一种强大的调试适配器，用于基于Arm的微控制器。如果你正在购买（或已经拥有）J-Link用于调试任务，它也可以作为一个优秀的SPI闪存编程器，使用“J-Flash
    SPI”软件。
- en: You’ll also likely want an *SOIC clip adapter* to attach to the SPI flash memory.
    These are commonly available from the manufacturer Pomona as part number 5250
    (lower-cost options are also available from no-name manufactures).
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能还需要一个*SOIC夹具适配器*，用于连接SPI闪存芯片。这些通常可以从制造商Pomona获得，型号为5250（也有一些来自无名制造商的低价选项）。
- en: Several options exist for interfacing with SPI devices. The FTDI FT232H chip
    is a beefed-up version of the FTDI USB-serial adapter that supports SPI as well.
    DediProg makes the StarProg-A line of devices designed primarily for programming
    EEPROMs in circuit, and the Minipro TL866II universal programmer can also flash
    some SPI devices in place. The *Flashrom* tool supports programming via a built-in
    SPI, for instance, in a Raspberry Pi or BeagleBone Black*,* as well as external
    programmers that include the FT232H chip, such as the Tigard mentioned earlier.
    For a price-conscious but still fairly easy-to-use alternative, look at the FlashcatUSB.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 有几种方式可以与SPI设备进行接口。FTDI FT232H芯片是FTDI USB-串行适配器的强化版，也支持SPI。DediProg生产StarProg-A系列设备，主要用于在电路中编程EEPROM，而Minipro
    TL866II通用编程器也可以就地刷写一些SPI设备。*Flashrom*工具支持通过内置的SPI进行编程，例如在Raspberry Pi或BeagleBone
    Black*上，以及包括FT232H芯片在内的外部编程器，如前面提到的Tigard。对于价格敏感但仍然相对易用的替代方案，可以考虑FlashcatUSB。
- en: To interface with SPI devices other than storage devices, your best bet is to
    use a *Bus Pirate* to communicate with the device interactively or a microcontroller
    that supports an SPI controller in hardware or software. In order to connect a
    reader and device physically, we recommend looking at *mini-grabber**s* and *SOIC
    clips*. The former are great for connecting to individual pins, whereas the clips
    allow you to connect to all pins of an SOIC package. More recently, you can find
    that Raspberry Pis make useful interface tools. They have the advantage of much
    faster speeds than the trusty Bus Pirate, which can take several minutes to dump
    a large SPI flash chip.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 要与除存储设备以外的SPI设备进行接口，最好的选择是使用*Bus Pirate*与设备进行交互式通信，或者使用支持SPI控制器的硬件或软件微控制器。为了物理连接读卡器和设备，推荐查看*mini-grabber**s*和*SOIC夹具*。前者适合连接到单个引脚，而夹具可以让你连接到SOIC封装的所有引脚。最近，你会发现Raspberry
    Pi是一个很有用的接口工具。它们的优势是速度比可靠的Bus Pirate要快得多，后者可能需要几分钟才能读取一个大型SPI闪存芯片。
- en: 'Power Analysis Measurements: $300 to $50,000'
  id: totrans-201
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 功率分析测量：$300到$50,000
- en: We are finally getting to equipment specific to this book. But, didn’t we already
    cover oscilloscopes? Isn’t that sufficient for power analysis measurements? The
    reality is you might find different requirements for power analysis measurements
    compared to more general exploration of a circuit. In fact, you might even end
    up using one piece of equipment for general exploration and another for performing
    the power analysis work.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 我们终于开始讨论本书特定的设备了。不过，我们不是已经讨论过示波器了吗？这难道不够用于功率分析测量吗？实际上，你可能会发现对于功率分析测量有与更一般的电路探索不同的需求。事实上，你甚至可能会用一台设备进行一般探索，而用另一台设备执行功率分析工作。
- en: For performing power analysis of a device, we are typically concerned about
    very small changes or very small measurements. You may be measuring waveforms
    that have a few mV peak-to-peak waveforms, for example, which differs from your
    normal task of probing a 3.3 V logic level signal. Understanding this requires
    you to check your oscilloscope’s *input sensitivity* specification. It is typically
    referenced *per division*, which is a call back to a time when oscilloscopes had
    fixed grid sizes (divisions) on the display. Even though the division is now drawn
    on digitally, that specification is still used.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 在对设备进行功率分析时，我们通常关注的是非常小的变化或非常小的测量。例如，你可能正在测量的波形可能只有几毫伏的峰峰值波形，这与正常的 3.3 V 逻辑电平信号探测任务不同。理解这一点需要检查示波器的*输入灵敏度*规格。该规格通常是以*每格*为单位，这是回溯到示波器显示屏上有固定网格尺寸（格线）的时代。即使现在的格线是通过数字方式绘制的，那个规格仍然被沿用。
- en: You’ll have to figure out how many divisions make a full input range; normally
    you’d find eight divisions vertically. Therefore, a scope with a 1 mV/div on the
    most sensitive range means 8 mV peak to peak. You would typically expect to find
    in the range of 10 to 100 mV peak-to-peak full scale at the most sensitive end
    (or ±5 to ±50 mV). Of course, you could be using an *amplifier* (or *active probe*)
    that provides a larger signal to the input of the oscilloscope.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要弄清楚多少个格线构成完整的输入范围；通常你会发现垂直方向上有八个格线。因此，具有 1 mV/格最灵敏范围的示波器意味着 8 mV 的峰峰值。你通常会期望在最灵敏的端点找到
    10 到 100 mV 的峰峰值全量程（或 ±5 到 ±50 mV）。当然，你也可能使用一个*放大器*（或*主动探头*）来提供更大的信号输入到示波器。
- en: Another critical feature for power analysis measurements is how the waveform
    is downloaded to a computer. While just exploring a device, you won’t care as
    much about that, but during power analysis, you’ll be performing statistical analysis
    across thousands to millions (or even billions) of power traces. Here, the PC-attached
    devices can be useful, as something like a PicoScope 6000 (see [Figure A-23](#figureA-23))
    has a USB 3.0 interface for rapid download of huge traces. You can even get internal
    PCIe-based capture cards, such as Cobra Express CompuScope or AlazerTech products
    that can stream directly to internal computer memory.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个进行功率分析测量时至关重要的特性是波形如何下载到计算机。虽然在单纯探索设备时，你不太关心这一点，但在功率分析期间，你将对成千上万甚至数百万（甚至数十亿）个功率轨迹进行统计分析。在这里，附带计算机的设备非常有用，因为像
    PicoScope 6000（参见[图 A-23](#figureA-23)）这样的设备具有 USB 3.0 接口，可快速下载大量波形数据。你甚至可以获得基于内置
    PCIe 的捕获卡，如 Cobra Express CompuScope 或 AlazerTech 的产品，它们可以直接将数据流传输到计算机内存。
- en: '![faa023](image_fi/278748b01/faa023.png)'
  id: totrans-206
  prefs: []
  type: TYPE_IMG
  zh: '![faa023](image_fi/278748b01/faa023.png)'
- en: 'Figure A-23: PicoScope 6000 USB scope being used for power analysis. This model
    has four channels, 350 MHz bandwidth, 5 GS/s max sampling rate, and a 2 GS (giga
    sample) memory buffer.'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-23：用于功率分析的 PicoScope 6000 USB 示波器。该型号有四个通道，350 MHz 带宽，最大采样率为 5 GS/s，以及 2
    GS（千兆样本）的内存缓冲区。
- en: If you are using a stand-alone scope, you’ll likely be using the network (Ethernet)
    interface. The majority of scopes support using this interface to download waveform
    data using a system called *VISA*. Unfortunately, it can be hard to know what
    the actual effective capture rate is using this method by studying only the datasheets.
    The higher-end models do tend to work well and allow rapid triggering and downloading,
    but lower-end devices may not always optimize this because the majority of scope
    users aren’t downloading data to a computer, so it’s not a highly optimized use
    case.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用的是独立式示波器，你可能会使用网络（以太网）接口。大多数示波器都支持使用该接口通过一个名为*VISA*的系统下载波形数据。不幸的是，仅通过研究数据表，可能很难知道这种方法下的实际有效捕获率。高端型号通常工作良好，允许快速触发和下载，但低端设备可能不会总是进行优化，因为大多数示波器用户并不将数据下载到计算机，因此这不是一个高度优化的使用场景。
- en: The final option to discuss for power analysis measurements is the *ChipWhisperer*
    capture hardware, which started as an open source project by Colin. The ChipWhisperer
    is slightly different from an oscilloscope because it *only* supports capturing
    small signals, as it contains a low-noise amplifier (LNA) in the frontend. The
    input sensitivity ranges from approximately 10 mV to 1 V, full scale, compared
    to a normal scope, which is somewhere in the range of 50 mV to 100 V. The ChipWhisperer
    capture hardware is also always *AC coupled*, which is to say it cannot measure
    a constant DC voltage. The work we’ll do with power analysis rarely needs this
    constant DC voltage, so by removing it at the front end, we can help simplify
    the capture hardware.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 讨论功率分析测量的最后一个选项是*ChipWhisperer*捕获硬件，它最初是由Colin作为一个开源项目发起的。ChipWhisperer与示波器略有不同，因为它*仅*支持捕获微弱信号，因为它的前端包含一个低噪声放大器（LNA）。其输入灵敏度范围大约从10
    mV到1 V满刻度，而普通示波器的范围大约是从50 mV到100 V。ChipWhisperer捕获硬件还始终是*交流耦合*的，这意味着它无法测量恒定的直流电压。我们在进行功率分析时，通常不需要这种恒定的直流电压，因此通过在前端去除它，可以帮助简化捕获硬件。
- en: 'The ChipWhisperer hardware is available in several variants: the major ones
    are ChipWhisperer-Nano ($50), ChipWhisperer-Lite (starting at $250), and ChipWhisperer-Pro
    ($3,800) hardware. Additional feature updates include an architecture update starting
    with the ChipWhisperer-Husky, which adds more features to the ChipWhisperer-Lite.
    The ChipWhisperer-Lite was the original board released as part of a Kickstarter,
    and it included the target built onto the same board (see [Figure A-24](#figureA-24)).
    The idea of this board is you can cut away the target to add your own later, but
    the board is now available with connectors and external targets to make it easier
    to work with external targets, typically as part of a starter kit, such as the
    NAE-SCAPACK-L1 or NAE-SCAPACK-L2.'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: ChipWhisperer硬件有多种变体：主要有ChipWhisperer-Nano（$50）、ChipWhisperer-Lite（起价$250）和ChipWhisperer-Pro（$3,800）硬件。额外的功能更新包括ChipWhisperer-Husky架构更新，增加了更多功能到ChipWhisperer-Lite。ChipWhisperer-Lite是最初作为Kickstarter项目发布的原始板，它包括了目标设备，且与同一块板一起（参见[图A-24](#figureA-24)）。这块板的设计理念是，你可以将目标去除，之后再添加你自己的目标，但现在该板已经提供了连接器和外部目标，使得与外部目标的工作更加便捷，通常作为入门套件的一部分，如NAE-SCAPACK-L1或NAE-SCAPACK-L2。
- en: '![faa024](image_fi/278748b01/faa024.png)'
  id: totrans-211
  prefs: []
  type: TYPE_IMG
  zh: '![faa024](image_fi/278748b01/faa024.png)'
- en: 'Figure A-24: The original ChipWhisperer-Lite includes capture hardware (left
    two-thirds of the board) and the target (right one-third of the board).'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 图A-24：原始的ChipWhisperer-Lite包含捕获硬件（板的左三分之二）和目标设备（板的右三分之一）。
- en: The other major difference with regular oscilloscopes is that the ChipWhisperer
    capture hardware uses a synchronous sampling method. [Figure A-25](#figureA-25)
    shows a regular oscilloscope setup, with an internal timebase that is used to
    decide when to sample. The time delay is effectively random between the clock
    edge of the device you are measuring and the oscilloscope sampling point, and
    it changes on every power trace. We can typically avoid this issue by sampling
    at a very fast rate; it’s not unusual with side-channel power analysis to capture
    at somewhere between 100 MS/s to 5 GS/s. The ChipWhisperer avoids this by instead
    synchronizing the sample points with the target device clock, which allows you
    to sample much more slowly but still achieve a highly successful attack. It *does*
    require access to a device clock to succeed, but in some cases, that’s something
    we do have access to. More secure devices (such as smart cards) will use internal
    oscillators that require clock extraction circuitry, but more basic microcontrollers
    will often use an external crystal we can latch onto.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 与普通示波器的另一个主要区别是ChipWhisperer捕获硬件使用了同步采样方法。[图A-25](#figureA-25)展示了一个普通示波器的设置，它使用内部时间基准来决定何时进行采样。时间延迟在被测设备的时钟边缘与示波器采样点之间实际上是随机的，而且每次功率轨迹都会发生变化。通常我们可以通过以非常快的速率进行采样来避免这个问题；在旁道功率分析中，以100
    MS/s到5 GS/s的速率采样是很常见的。ChipWhisperer通过将采样点与目标设备时钟同步，避免了这个问题，这使得你可以以较慢的速度进行采样，但仍然能够进行高成功率的攻击。它*确实*需要访问设备时钟才能成功，但在某些情况下，我们是可以访问的。更安全的设备（如智能卡）将使用内部振荡器，需要时钟提取电路，但更基础的微控制器通常会使用外部晶体，我们可以附加上去。
- en: This raises the question of how fast a sample rate we need for our attack to
    succeed. If we’re using synchronous sampling like the ChipWhisperer capture board
    does, the sample rate can be as low as 1× the device clock rate (that is, sampled
    at the device clock rate). If we’re using a regular oscilloscope, a typical rule
    of thumb would be to sample at 5× to 10× the device clock rate. Also make sure
    the bandwidths of the scope and the probes are at least as high as the sampling
    rate.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 这引出了一个问题，我们的攻击需要多快的采样率才能成功。如果我们使用类似 ChipWhisperer 捕获板的同步采样，则采样率可以低至设备时钟频率的 1
    倍（即以设备时钟频率进行采样）。如果我们使用常规示波器，通常的经验法则是采样频率为设备时钟频率的 5 倍至 10 倍。同时，确保示波器和探头的带宽至少与采样率相当。
- en: '![faa025](image_fi/278748b01/faa025.png)'
  id: totrans-215
  prefs: []
  type: TYPE_IMG
  zh: '![faa025](image_fi/278748b01/faa025.png)'
- en: 'Figure A-25: An asynchronous sample clock (as in a regular oscilloscope) causes
    some time jitter between the rising edge of the device sample clock (A, B, and
    C) and the next rising edge of the sample clock defining when the samples are
    taken.'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-25：一个异步采样时钟（如常规示波器中使用的）会导致设备采样时钟的上升沿（A、B 和 C）与定义采样时间的下一个上升沿之间存在一些时间抖动。
- en: We should add the disclaimer that the sample rate required will vary drastically
    with the algorithm attacked. For example, we can attack some slow algorithms even
    when sampling at 0.0001× the rate of the target device, as the algorithm itself
    is so slow that the leaked data does not require information on every clock cycle.
    Likewise, a hardware cryptographic implementation may leak information only at
    a small fraction of the clock cycle due to an unintended glitch, which means the
    5× to 10× faster rate may be insufficient, and even the synchronous sampling would
    still need substantial oversampling to catch the glitch.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该添加免责声明，即所需的采样率会随着攻击的算法不同而有很大变化。例如，我们可以在采样率仅为目标设备的 0.0001 倍时攻击一些较慢的算法，因为该算法本身非常慢，以至于泄露的数据并不需要每个时钟周期的信息。同样，硬件加密实现可能仅因意外故障在时钟周期的一个小部分泄露信息，这意味着
    5 倍到 10 倍的更高采样率可能不足以捕获此故障，即使是同步采样仍然需要大量过采样才能捕获故障。
- en: 'Triggering on Analog Waveforms: $3,800+'
  id: totrans-218
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 模拟波形触发：$3,800+
- en: Returning to the topic of *triggering*, triggering on an analog waveform is
    also useful. This means not just triggering on a rising or falling edge, but matching
    an exact pattern in the analog waveform. It’s often used inside channel analysis
    or fault injection to trigger right before some sensitive operation.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 回到*触发*的话题，模拟波形的触发也非常有用。这意味着不仅是对上升沿或下降沿进行触发，而是匹配模拟波形中的确切模式。它通常在通道分析或故障注入中使用，用来在某些敏感操作之前触发。
- en: Some oscilloscopes offer this feature, although it’s relatively rare and is
    usually only available in higher-end scopes, so you may need to use external hardware
    to accomplish this goal. The Riscure icWaves has a variety of features and is
    designed specifically to perform this triggering function.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 一些示波器提供这个功能，尽管它比较罕见，通常只在高端示波器中可用，因此你可能需要使用外部硬件来实现这个目标。Riscure icWaves 具有多种功能，专为执行此触发功能而设计。
- en: A simplified version of the pattern match is also built in to the ChipWhisperer-Pro,
    which allows for matching fewer sample points than the icWaves solutions. The
    ChipWhisperer-Pro can also serve as the power measurement platform, however, so
    it can be useful for performing multiple duties.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: ChipWhisperer-Pro 还内置了一个简化版本的模式匹配功能，它允许匹配比 icWaves 解决方案更少的采样点。ChipWhisperer-Pro
    也可以作为功率测量平台，因此它可以用于执行多个任务。
- en: Both the Riscure icWaves and ChipWhisperer-Pro use a sum of absolute difference
    (SAD) to perform the matching logic. They store a copy of the last *N* points
    of the waveform in a buffer and compare the last *N* points to some desired match
    pattern. If those points are close enough (small enough difference), a trigger
    signal is generated.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: Riscure icWaves 和 ChipWhisperer-Pro 都使用绝对差值和（SAD）来执行匹配逻辑。它们将波形的最后 *N* 个点存储在缓冲区中，并将这
    *N* 个点与某个期望的匹配模式进行比较。如果这些点足够接近（差异足够小），则会生成触发信号。
- en: 'Measuring Magnetic Fields: $25 to $10,000'
  id: totrans-223
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 测量磁场：$25 到 $10,000
- en: Another task you’ll find useful is measuring the strength of a *magnetic field*
    emitted from a device, which basically means that an *H-Field (magnetic field)
    probe* is required. The actual design of the probes is very basic—a simple loop
    antenna will pick up the magnetic field. The antenna is typically shielded to
    block the *E-field* (*electrical field*) as much as possible. [Figure A-26](#figureA-26)
    shows an example of several H-Field probes.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个你会发现有用的任务是测量设备发出的*磁场*强度，这基本上意味着需要一个*H-Field（磁场）探针*。探针的实际设计非常基础——一个简单的环形天线就能拾取磁场。天线通常被屏蔽，以尽可能阻挡*电场*（*E-field*）。[图A-26](#figureA-26)展示了几种H-Field探针的示例。
- en: '![faa026](image_fi/278748b01/faa026.png)'
  id: totrans-225
  prefs: []
  type: TYPE_IMG
  zh: '![faa026](image_fi/278748b01/faa026.png)'
- en: 'Figure A-26: H-Field probes from various manufacturers'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 图A-26：来自不同制造商的H-Field探针
- en: 'When purchasing a probe, you have several options to consider:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 购买探针时，你有几个选项需要考虑：
- en: '**Package-size probes**'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: '**封装尺寸探针**'
- en: Here we refer to *package-size probes* as those that are roughly capable of
    probing a single device, such as an IC or component. These larger magnetic field
    probes can be purchased as a *planar design*, which uses a PCB to reduce the cost.
    Examples of these include Beehive Electronics 101A probe set, TekBox TBPS01, and
    the ChipWhisperer NAE-HPROBE-15\. The ChipWhisperer NAE-HPROBE-15 also has design
    information published, which requires having a four-layer PCB fabricated but lets
    you tweak the design if required for your specific application.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们将*封装尺寸探针*定义为大致能够探测单个设备，如集成电路（IC）或组件的探针。这些较大的磁场探针可以作为*平面设计*购买，该设计使用PCB来降低成本。这些的例子包括Beehive
    Electronics 101A探针组、TekBox TBPS01和ChipWhisperer NAE-HPROBE-15。ChipWhisperer NAE-HPROBE-15还发布了设计信息，要求制作四层PCB，但如果需要针对特定应用调整设计，它允许你进行修改。
- en: The downside of the planar design is the probe must be placed flat onto the
    chip, which may not be physically possible. Various other orientations have been
    made of these designs as well; the most well known is the Langer EMV RF1 kit,
    which includes several probes that are sensitive to various magnetic field directions.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 平面设计的缺点是探针必须平放在芯片上，而这在物理上可能无法实现。也有各种其他方向的设计，这些设计较为著名的是Langer EMV RF1套件，其中包含几种对不同磁场方向敏感的探针。
- en: Due to the Langer EMV RF1 kit’s popularity, several lower-cost clones are now
    available. The Rigol NFP-3 kit contains similar probes to the Langer EMV kit.
    An even lower-cost option is the EM5030 probe set made by Cybertek. The Cybertek
    probes have a slightly thicker insulation, which will negatively affect sensitivity
    since you cannot physically get the actual probe itself as close to the magnetic
    field source.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 由于Langer EMV RF1套件的普及，现在有几种低成本的克隆产品可供选择。Rigol NFP-3套件包含与Langer EMV套件相似的探针。一个更低成本的选择是由Cybertek制造的EM5030探针组。Cybertek探针的绝缘层稍厚，这会对灵敏度产生负面影响，因为你无法将实际的探针本身物理上靠近磁场源。
- en: Some slightly smaller probes are also available, from Langer EMV and elsewhere.
    An example is the Morita Tech MT-545, which has a 1.6 mm diameter coil.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 还有一些稍小的探针可供选择，来自Langer EMV及其他厂商。例如，Morita Tech MT-545探针，其线圈直径为1.6毫米。
- en: '**Preamplifier**'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: '**前置放大器**'
- en: For all these sets (including the Langer EMV kit), you will need a *preamplifier*
    to provide reasonable signal level for your oscilloscope input. The vendors provide
    matching amplifiers for their sets, although little is vendor-specific to the
    amplifier itself. The various amplifier designs may have better or worse noise
    performance, but the design of a low noise amplifier is not a particularly difficult
    task. Besides the gain (typically 20 to 30 dB should be expected), the *noise
    figure (NF)* should be considered. The NF measures the degradation of the signal-to-noise
    ratio (SNR) between input to output, so a higher NF means the amplifier itself
    adds additional noise to the output. As an example, the Langer EMV PA 203 SMA
    amplifier specifies a gain of 20 dB and a noise figure of 4.5 dB.
  id: totrans-234
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于所有这些套件（包括Langer EMV套件），你需要一个*前置放大器*来为示波器输入提供合理的信号电平。供应商提供与其套件匹配的放大器，尽管放大器本身的设计与供应商关系不大。各种放大器设计可能在噪声性能上有所不同，但设计一个低噪声放大器并不是特别困难的任务。除了增益（通常应期望为20至30
    dB）外，*噪声系数（NF）*也应考虑。NF衡量的是输入与输出之间信噪比（SNR）的退化，因此较高的NF意味着放大器本身会向输出添加额外的噪声。例如，Langer
    EMV PA 203 SMA放大器的增益为20 dB，噪声系数为4.5 dB。
- en: If you are connecting the output of the amplifier to your oscilloscope, you
    may wish to select an amplifier with a matching bandwidth. For example, the Langer
    EMV PA 203 SMA amplifier specifies a usable frequency range of 100 kHz to 3 GHz.
    If you are connecting this to a 200 MHz bandwidth oscilloscope, the 3 GHz amplifier
    will typically have worse noise performance than a smaller bandwidth amplifier.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你将放大器的输出连接到示波器，你可能希望选择一个带宽匹配的放大器。例如，Langer EMV PA 203 SMA放大器指定的可用频率范围为100
    kHz到3 GHz。如果你将其连接到200 MHz带宽的示波器，3 GHz放大器通常会比带宽较小的放大器噪声性能差。
- en: One of the go-to companies for RF products is Mini-Circuits, which sells complete
    LNA devices such as the Mini-Circuits ZFL-1000LN+ (100 kHz to 1 GHz bandwidth,
    20 dB gain, 2.9 dB NF) for about $100\. You can reduce the bandwidth a bit with
    the ZFL-500LN+ (100 kHz to 500 MHz bandwidth, 24 dB gain, 2.9 dB NF), which has
    slightly higher gain. For the ultimate in a low-cost LNA, the BGA2801 can be used
    as a basis for a cheap LNA (100 kHz to 2.2 GHz, 22 dB gain, 4.3 dB NF). A sample
    design for an LNA based on the BGA2801 is available in the ChipWhisperer project
    (the NF of the complete amplifier will be worse than the NF of only the raw IC).
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 提供射频产品的公司之一是Mini-Circuits，它销售完整的LNA设备，如Mini-Circuits ZFL-1000LN+（100 kHz到1 GHz带宽，20
    dB增益，2.9 dB噪声系数），价格约为$100。你可以使用ZFL-500LN+（100 kHz到500 MHz带宽，24 dB增益，2.9 dB噪声系数）略微减少带宽，它具有稍高的增益。对于低成本LNA的极致选择，可以使用BGA2801作为廉价LNA的基础（100
    kHz到2.2 GHz，22 dB增益，4.3 dB噪声系数）。基于BGA2801的LNA设计示例可在ChipWhisperer项目中找到（完整放大器的噪声系数将比仅有原始IC的噪声系数更差）。
- en: '**Chip-scale and smaller probes**'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: '**芯片级及更小探头**'
- en: While the previous probe tips were mostly for measuring an entire device, we
    are calling a chip-scale probe one that can be used to probe smaller portions
    of the IC surface. Some of these can be built using similar techniques, but just
    with smaller coils. This can be used to create coils in the 300µm (0.3mm) size,
    such as the Langer EMV RF3 mini kit.
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 虽然之前的探头大多用于测量整个设备，但我们所说的芯片级探头是指可以用于探测IC表面更小部分的探头。有些探头可以使用类似的技术制造，只不过使用更小的线圈。这可以用来制造300µm（0.3mm）大小的线圈，例如Langer
    EMV RF3迷你套件。
- en: 'Even smaller tips are possible, such as the Langer EMV MFA 01 set that contains
    tips down to 100µm. A warning with such small tips: the tips must be very close
    to the measurement source, which in this case is the IC die. You will almost certainly
    need to decap or partially decap the IC being measured once you get to these very
    small probes.'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 更小的探头也有可能，比如Langer EMV MFA 01套件，包含了最小可达100µm的探头。使用如此小的探头时要注意：探头必须非常靠近测量源，在这种情况下就是IC芯片。你几乎肯定需要去除或部分去除被测IC的封装，才能使用这些非常小的探针。
- en: '**All in one**'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: '**一体化**'
- en: The smaller probe sizes also make it useful to consider integrating the amplifier
    even closer to the probe tip. The previously mentioned Langer EMV sets in the
    100µm to 250µm range contain an integrated amplifier, but complete solutions that
    contain both the probe and the amplifier are also available in slightly larger
    sizes. Riscure sells the EM Probe, which is closely integrated with the amplifier
    for a bandwidth of 1 GHz. It is designed specifically for XY scanning over the
    chip surface.
  id: totrans-241
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更小的探针尺寸也使得考虑将放大器集成到更靠近探头尖端的位置变得有意义。之前提到的Langer EMV套件在100µm到250µm范围内包含了集成放大器，但也有稍大尺寸的完整解决方案，既包含探头也包含放大器。Riscure销售的EM探头，放大器与探头紧密集成，带宽为1
    GHz。它专门设计用于芯片表面上的XY扫描。
- en: 'Clock Fault Injection: $100 to $30,000'
  id: totrans-242
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 时钟故障注入：$100到$30,000
- en: '*Clock fault injection* requires generating complex clock waveforms. [Figure
    A-27](#figureA-27) shows a sample clock fault injection waveform. The most straightforward
    way of doing this at reasonable cost is using the clock fault injection built
    in to any of the FPGA-based ChipWhisperer platforms, such as the ChipWhisperer-Lite
    or ChipWhisperer-Pro (the ChipWhisperer-Nano does not have an FPGA, so it cannot
    do clock fault injection).'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: '*时钟故障注入*需要生成复杂的时钟波形。[图A-27](#figureA-27)展示了一个时钟故障注入波形示例。以合理成本实现这一目标最直接的方式是使用任何基于FPGA的ChipWhisperer平台中的时钟故障注入功能，如ChipWhisperer-Lite或ChipWhisperer-Pro（ChipWhisperer-Nano没有FPGA，因此无法进行时钟故障注入）。'
- en: '![faa027](image_fi/278748b01/faa027.png)'
  id: totrans-244
  prefs: []
  type: TYPE_IMG
  zh: '![faa027](image_fi/278748b01/faa027.png)'
- en: 'Figure A-27: Example of a clock glitch waveform, a 7.37 MHz clock with a narrow
    pulse inserted'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 图A-27：时钟故障波形示例，7.37 MHz时钟插入窄脉冲
- en: The Riscure VC Glitcher and Riscure Spider can also perform clock fault injection
    and have more complex circuitry to generate glitch waveforms at a resolution of
    2ns. For lower-cost or DIY options, you will mostly be limited to implementing
    something in an FPGA board yourself. The implementation is out of scope for this
    book, but a low-cost FPGA board (such as the Digilent Arty) would be a good starting
    point. While you might consider using an arbitrary waveform generator (AWG), it
    can be difficult to generate the very fast digital waveform needed with an AWG.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: Riscure VC Glitcher和Riscure Spider也可以执行时钟故障注入，并且具有更复杂的电路来以2ns的分辨率生成故障波形。对于低成本或DIY选项，你将主要局限于自己在FPGA板上实现。实现过程超出了本书的范围，但低成本的FPGA板（例如Digilent
    Arty）是一个很好的起点。虽然你可能会考虑使用任意波形发生器（AWG），但用AWG生成非常快速的数字波形可能会比较困难。
- en: 'Voltage Fault Injection: $25 to $30,000'
  id: totrans-247
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 电压故障注入：$25,000至$30,000
- en: '*Voltage fault injection* typically requires switching between two or more
    voltage sources in quick succession. Compared to clock fault injection, it is
    easier to build your own voltage fault injection system. The typical DIY solution
    is to use a multiplexor IC, such as the MAX4619, with two different voltages on
    each input. You can switch between the regular to glitch voltage to insert faults.
    See Chapter 6, or check out Chris Gerlinsky’s presentation “Breaking Code Read
    Protection on the NXP LPC-Family Microcontrollers” (REcon Brussels, 2017).'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: '*电压故障注入*通常需要在短时间内在两个或多个电压源之间切换。与时钟故障注入相比，构建自己的电压故障注入系统更为容易。典型的DIY解决方案是使用多路复用器集成电路（如MAX4619），在每个输入端提供两种不同的电压。你可以在常规电压和故障电压之间切换来插入故障。请参见第六章，或查看Chris
    Gerlinsky的演示文稿《破解NXP LPC系列微控制器的代码读取保护》（REcon布鲁塞尔，2017年）。'
- en: The ChipWhisperer hardware platforms currently use a simple crowbar mechanism
    to generate voltage glitch waveforms (see [Figure A-28](#figureA-28)). The ChipWhisperer-Lite/Pro
    best support this mechanism, but it also works with the ChipWhisperer-Nano in
    a more limited fashion.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 目前，ChipWhisperer硬件平台使用简单的钳位机制来生成电压故障波形（参见[图A-28](#figureA-28)）。ChipWhisperer-Lite/Pro最佳支持此机制，但它也可以与ChipWhisperer-Nano一起使用，只是功能更加有限。
- en: '![faa028](image_fi/278748b01/faa028.png)'
  id: totrans-250
  prefs: []
  type: TYPE_IMG
  zh: '![faa028](image_fi/278748b01/faa028.png)'
- en: 'Figure A-28: Example of a VCC glitch waveform'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 图A-28：VCC故障波形示例
- en: For a more complete solution, the Riscure VC Glitcher and Riscure Spider can
    perform the voltage glitch generation (as well as clock glitch generation), and
    each has a more complex triggering circuitry compared to the ChipWhisperer platform.
    These devices allows for generation of a flexible analog waveform, compared to
    the more limited ChipWhisperer crowbar method.
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 对于更完整的解决方案，Riscure VC Glitcher和Riscure Spider可以执行电压故障生成（以及时钟故障生成），并且与ChipWhisperer平台相比，它们具有更复杂的触发电路。这些设备允许生成灵活的模拟波形，而与ChipWhisperer的限界方法相比，其能力更强。
- en: 'Voltage fault injection can also be done with a fast function generator. These
    generators are available at a reasonable cost, such as the Siglent SDG6022X ($1,500).
    You will need an amplifier to drive anything with it, which is available as a
    DIY solution using a high-current op-amp, or from Riscure (Glitch Amplifier or
    Glitch Amplifier 2), or NewAE Technology (ChipJabber). See “Shaping the Glitch:
    Optimizing Voltage Fault Injection Attacks” by Claudio Bozzato, Riccardo Focardi,
    and Francesco Palmarini for an example of the DIY solution being used on real
    devices. As you might already have a function generator available to you, building
    a DIY amplifier may be a relatively low-cost solution for your existing lab.'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 电压故障注入也可以通过快速函数发生器来实现。这些发生器以合理的价格可得，如Siglent SDG6022X（$1,500）。你需要一个放大器来驱动任何负载，可以使用高电流运算放大器作为DIY解决方案，或者使用Riscure（故障放大器或故障放大器2）或NewAE
    Technology（ChipJabber）的产品。参见Claudio Bozzato、Riccardo Focardi和Francesco Palmarini的《塑造故障：优化电压故障注入攻击》，了解在实际设备上使用DIY解决方案的示例。因为你可能已经有了函数发生器，构建一个DIY放大器可能是你现有实验室的低成本解决方案。
- en: 'Electromagnetic Fault Injection: $100 to $50,000'
  id: totrans-254
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 电磁故障注入：$100到$50,000
- en: '*Electromagnetic fault injection (EMFI)*is a powerful method of performing
    fault injection. EMFI roughly requires switching a high voltage onto a small inductor
    to generate a powerful magnetic field. Several purpose-built solutions currently
    are on the market in addition to DIY open source solutions.'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: '*电磁故障注入（EMFI）*是一种强大的故障注入方法。EMFI大致需要将高电压切换到一个小型电感器上，从而生成强大的磁场。除了DIY开源解决方案，目前市场上还有几种专门的解决方案。'
- en: For purpose-built equipment, Riscure’s EM-FI Transient Probe tool is the original
    and most widely used tool for performing EMFI. The device comes with injection
    tips of various sizes and polarities. NewAE Technology introduced the ChipSHOUTER
    EMFI tool, which also comes with various tips, along with several sample target
    boards. The Riscure EMFI tool and ChipSHOUTER are both designed for relatively
    fast repetition, as might be required for inserting multiple glitches into a system.
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 对于专用设备，Riscure的EM-FI瞬态探头工具是最初的且使用最广泛的EMFI工具。该设备配有各种尺寸和极性的注入探头。NewAE Technology推出了ChipSHOUTER
    EMFI工具，它同样配有多种探头，并附带若干样本目标板。Riscure EMFI工具和ChipSHOUTER都设计用于相对快速的重复操作，例如在系统中插入多个故障时可能需要的操作。
- en: Another purpose-built tool is the SGZ 21 burst generator (available in the E1
    set) with the S2 set H-Field injector tips from Langer EMV. This tool is designed
    for immunity testing instead of security analysis, so fewer details about its
    usage for fault injection testing are currently available.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个专用工具是SGZ 21脉冲发生器（可在E1套件中找到），以及Langer EMV的S2套件H场注入探头。该工具是为免疫测试而设计的，而非安全分析，因此目前关于其在故障注入测试中的使用细节较少。
- en: Morita Tech also makes both E-Field and H-Field injection probes (part number
    MT-676, with versions MT-676E and MT-676H, respectively, giving E- and H-Field
    injections). These products are made in Japan and appear to be easier to order
    domestically in Japan.
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: Morita Tech 还制造了E场和H场注入探头（部件号MT-676，分别有MT-676E和MT-676H版本，提供E场和H场注入）。这些产品在日本制造，并且在日本国内似乎更容易订购。
- en: Besides solutions offered specifically for EMFI, Avtech Electrosystems, Ltd.,
    offers a variety of pulse generators that can be used for EMFI. They require you
    to adapt the output to the specific EMFI coil, which requires validation that
    the pulse generator can drive an inductive load without any modifications.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 除了专门为EMFI提供的解决方案外，Avtech Electrosystems, Ltd. 还提供了各种脉冲发生器，可用于EMFI。它们要求你将输出适配到特定的EMFI线圈上，这需要验证脉冲发生器在没有任何修改的情况下能够驱动感性负载。
- en: Low-cost and DIY solutions are also available. A project called *BadFET* by
    Red Balloon Security is available, but it has the substantial downside of using
    a relatively dangerous (but easier to build) method of switching the high voltage
    onto the exposed injection coil. See Chapter 5 for a discussion of architectures
    related to EMFI tooling.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 也有低成本和DIY解决方案。Red Balloon Security 的一个名为*BadFET*的项目可以使用，但它有一个明显的缺点，就是采用了一种相对危险（但更容易构建）的方法，将高压切换到暴露的注入线圈上。关于与EMFI工具相关的架构，请参见第5章。
- en: 'Optical Fault Injection: $1,000 to $250,000'
  id: totrans-261
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 光学故障注入：$1,000 到 $250,000
- en: '*Optical fault injection* typically means the use of a laser to position a
    specific spot onto the IC die. A lower-cost option is using a flash tube along
    with a lens, as described in “Low-Cost Setup for Localized Semi-invasive Optical
    Fault Injection Attacks,” by Oscar M. Guillen, Michael Gruber, and Fabrizio De
    Santis.'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: '*光学故障注入*通常指使用激光将特定光点定位到IC芯片上。一个更低成本的选项是使用闪光管和镜头，正如Oscar M. Guillen、Michael
    Gruber和Fabrizio De Santis在《低成本局部半侵入式光学故障注入攻击设置》中所描述的那样。'
- en: For precise optical fault injection, a light (laser) *source*, an *XY positioning
    stage*, and a laser-optimized *microscope* setup are needed. For the light sources,
    a *backside attack* requires an IR (1064nm) laser, and *frontside attacks* require
    shorter wavelengths (880nm, 532nm, or shorter).
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 对于精确的光学故障注入，需要一个光源（激光）、一个*XY定位台*，以及一个激光优化的*显微镜*系统。对于光源，*背面攻击*需要红外（1064nm）激光，*前面攻击*则需要更短波长（880nm，532nm或更短）的激光。
- en: Several additions will make your life easier. An *additional Z stage* can help
    with automated focusing of the laser beam, and an *IR-sensitive camera* can allow
    you to position the beam from a PC. Similarly, an *IR light source* will allow
    you to see metal layers even through silicon, which helps positioning for backside
    attacks. Finally, some certifications require having a *dual-laser system* capable
    of delivering a laser pulse on two different areas of the die in one fault injection
    run. Riscure offers the Laser Station 2, which includes that feature and the aforementioned
    additions. Alphanov laser solutions also provide laser fault injection hardware,
    which can be integrated in Riscure laser systems or driven by eShard’s fault injection
    scripts in esDynamic.
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 几个附加功能可以让你的工作更加轻松。*额外的Z平台*可以帮助自动聚焦激光束，*红外线敏感相机*可以让你通过PC来定位激光束。同样，*红外线光源*将允许你透过硅看到金属层，这有助于背面攻击时的定位。最后，一些认证要求必须拥有*双激光系统*，能够在一次故障注入过程中在芯片的两个不同区域上发射激光脉冲。Riscure提供了包括该功能和上述附加功能的激光站2。Alphanov激光解决方案还提供激光故障注入硬件，可以集成到Riscure激光系统中，或通过eShard的故障注入脚本在esDynamic中驱动。
- en: 'Positioning Probes: $100 to $50,000'
  id: totrans-265
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 定位探针：$100到$50,000
- en: For H-Field probes, EMFI, and laser systems, precise *positioning* may be required
    over the target. That is typically done using an XY or XYZ table, which is sold
    for microscope purposes. A variety of XY(Z) tables can be found from suppliers
    such as Thorlabs, including both manual and electronic tables. Riscure offers
    the EM Probe Station and Laser Station, which both include stages. Other XY(Z)
    table suppliers can easily be found by searching for “microscope positioning stages.”
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 对于H-场探针、EMFI和激光系统，可能需要对目标进行精确的*定位*。通常是使用XY或XYZ台面来完成这一任务，这些台面是为了显微镜用途而销售的。像Thorlabs这样的供应商提供多种XY(Z)台面，包括手动和电子台面。Riscure提供了EM探针站和激光站，这两者都包含平台。其他XY(Z)台面供应商可以通过搜索“显微镜定位平台”轻松找到。
- en: To match with the ChipSHOUTER, NewAE offers the ChipShover XYZ table and controller.
    It’s based on open source firmware and can be used for positioning EM probes or
    other tools in addition to the ChipSHOUTER.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 为了与ChipSHOUTER匹配，NewAE提供了ChipShover XYZ台面和控制器。它基于开源固件，除了与ChipSHOUTER一起使用，还可以用于定位EM探针或其他工具。
- en: Low-cost versions of manual positioning stages are also available, such as those
    sold by AmScope (GT200 table) or an overseas supply company (AliExpress).
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 还可以找到一些低成本的手动定位平台，例如AmScope（GT200平台）或某些海外供应公司（AliExpress）出售的产品。
- en: A low-cost option for an XYZ table is to use a 3D printer stage. A 3D printer
    typically has sufficient accuracy for most of the work you will need to do with
    both H-Field probes (electromagnetic analysis) and EMFI (injection). Many 3D printers
    have 1 to 20µm step resolution, for example, which allows a relatively large amount
    of steps over the chip surface or target. For example, stepping over a 4×4mm chip
    die with 10µm step resolution means the 3D printer would have 400 steps in each
    X and Y direction. The ChipShover tool mentioned earlier is based on 3D printer
    firmware and provides an open source API you can use with most standard printers
    that simply process *G-code*, for example. G-code is a language specific for 3D
    printers.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 一个低成本的XYZ台面选项是使用3D打印机平台。3D打印机通常具有足够的精度，能够完成你需要用到的H-场探针（电磁分析）和EMFI（注入）等大多数工作。例如，许多3D打印机具有1到20µm的步进分辨率，这使得在芯片表面或目标上能够进行较大的步进。例如，在一个4×4mm的芯片上以10µm步进分辨率进行步进意味着3D打印机在X和Y方向上各有400个步进。前面提到的ChipShover工具基于3D打印机固件，提供了一个开源API，你可以与大多数标准打印机一起使用，这些打印机简单地处理*G-code*，例如。G-code是专门为3D打印机设计的语言。
- en: The important specifications to look for are the *step size* or *resolution*
    of the table, as well as the *repetition error*, usually expressed in µm. The
    former terms refer to the smallest step size the table can make, and the latter
    refers to the maximum expected error if you move from any point A to any point
    B. You can imagine this error is important for repeatability of faults.
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 需要关注的重要规格是台面的*步进大小*或*分辨率*，以及*重复误差*，通常以µm为单位表示。前者指的是台面能够做出的最小步进，后者指的是从任何点A到任何点B移动时的最大预期误差。你可以想象这个误差对于故障的可重复性是非常重要的。
- en: 'Target Devices: $10 to $10,000'
  id: totrans-271
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 目标设备：$10到$10,000
- en: During your research and development phase, you will need *target devices*.
    While you may have a specific target in mind to attack, starting with something
    you fully control is more reasonable. The most obvious target would be a development
    board for the device of interest. For example, if you are interested in an automotive
    device, such as a PowerPC MPC5777C (found in some ECUs), you could attempt to
    perform exploration on the actual ECU, but that will be difficult since you may
    not know anything about the schematic, program running, and so on. Instead, finding
    a development board for this part and working out your attack on it first would
    be better. Once you’ve explored the device itself, you can better understand how
    it works on the specific board. This advice applies even if you’re evaluating
    your own product, since your product may still make the evaluation more complicated
    than it would be on a stand-alone board.
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 在你的研究与开发阶段，你将需要*目标设备*。虽然你可能有一个特定的目标设备作为攻击对象，但从你完全控制的设备开始会更为合理。最显而易见的目标是该设备的开发板。例如，如果你对汽车设备感兴趣，例如
    PowerPC MPC5777C（某些 ECU 中使用的芯片），你可以尝试对实际的 ECU 进行探索，但这将会很困难，因为你可能对原理图、运行程序等信息一无所知。相反，找到该部件的开发板，并首先在开发板上进行攻击会更好。一旦你探索了该设备本身，就能更好地理解其在特定板上的工作原理。这一建议即使适用于你自己评估的产品，因为你的产品可能仍然会让评估过程变得比在独立板上复杂。
- en: On the lower-end, you can use something like an Arduino to run code and then
    modify it to perform power analysis and fault injection. Targets specifically
    designed for this analysis work do exist. One of the earliest commercially available
    targets was the *SASEBO Project* started by Akashi Satoh, which has now turned
    into the *SAKURA Project*. When looking up the SAKURA boards, don’t confuse them
    with the Renesas Electronics Sakura boards, which were released much later and
    use the same name.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 在低端，你可以使用类似 Arduino 的设备来运行代码，然后修改它进行功耗分析和故障注入。专门为此分析工作设计的目标确实存在。最早的商业可用目标之一是由
    Akashi Satoh 开始的 *SASEBO 项目*，该项目现已转变为 *SAKURA 项目*。在查找 SAKURA 板时，不要将其与 Renesas
    Electronics 后期发布的同名 Sakura 板混淆。
- en: Due to various licensing changes, the SAKURA boards can occasionally be difficult
    to find; see the SAKURA home page for information. They are currently available
    from TROCHE. [Figure A-29](#figureA-29) shows a SAKURA-G board. Most SAKURA boards
    target FPGAs, which allow you to implement algorithms in programmable hardware.
    The SAKURA boards have a range of FPGA sizes, including some very large FPGAs
    for complex algorithms.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 由于各种许可变更，SAKURA 板有时可能会很难找到；请参见 SAKURA 首页了解更多信息。它们目前可从 TROCHE 获取。[图 A-29](#figureA-29)
    显示了一个 SAKURA-G 板。大多数 SAKURA 板的目标是 FPGA，这使你能够在可编程硬件中实现算法。SAKURA 板提供了多种 FPGA 大小，包括一些用于复杂算法的非常大的
    FPGA。
- en: '![faa029](image_fi/278748b01/faa029.png)'
  id: totrans-275
  prefs: []
  type: TYPE_IMG
  zh: '![faa029](image_fi/278748b01/faa029.png)'
- en: 'Figure A-29: SAKURA-G is part of a range of useful FPGA-based target systems.'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-29：SAKURA-G 是一系列有用的基于 FPGA 的目标系统的一部分。
- en: The most widely available target boards are part of the ChipWhisperer project.
    Most of these targets are made available in the CW308 UFO Board,a base board onto
    which many targets can be fit. [Figure A-30](#figureA-30) shows a sample baseboard
    with target.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 最常见的目标板是 ChipWhisperer 项目的一部分。这些目标大多数都可以通过 CW308 UFO 板提供，CW308 UFO 板是一个基础板，可以安装许多目标。[图
    A-30](#figureA-30) 显示了一个带有目标的示例基础板。
- en: '![faa030](image_fi/278748b01/faa030.png)'
  id: totrans-278
  prefs: []
  type: TYPE_IMG
  zh: '![faa030](image_fi/278748b01/faa030.png)'
- en: 'Figure A-30: The ChipWhisperer UFO (CW308) has a variety of open source top
    modules you can use for testing various devices and algorithms.'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-30：ChipWhisperer UFO (CW308) 提供了多种开源顶级模块，可以用来测试各种设备和算法。
- en: This target system allows swapping of various test processors. Test devices
    for 8-bit XMEGA, 32-bit Arm, FPGA, PowerPC, and more are readily available. In
    addition, the schematic and full design files for the target portions are available
    at [https://github.com/newaetech/chipwhisperer-target-cw308t/](https://github.com/newaetech/chipwhisperer-target-cw308t/)
    if you need to modify the designs or want to build your own target boards.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 该目标系统允许更换各种测试处理器。可用的测试设备包括 8 位 XMEGA、32 位 Arm、FPGA、PowerPC 等。除此之外，目标部分的原理图和完整设计文件可以在
    [https://github.com/newaetech/chipwhisperer-target-cw308t/](https://github.com/newaetech/chipwhisperer-target-cw308t/)
    获取，如果你需要修改设计或想要构建自己的目标板。
- en: Besides the SAKURA boards for FPGA targets, the ChipWhisperer project also has
    the CW305 FPGA target, which has an Artix 7A100 FPGA target on which to implement
    your cryptographic algorithms (see [Figure A-31](#figureA-31)).
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 除了用于 FPGA 目标的 SAKURA 板，ChipWhisperer 项目还拥有 CW305 FPGA 目标，该目标搭载 Artix 7A100 FPGA，可以在其上实现加密算法（见[图
    A-31](#figureA-31)）。
- en: Riscure offers various smart cards as well as an embedded target called *Piñata*
    with its tools. These targets allow running more advanced algorithms and tests
    suited to the Riscure toolchain, including multiple faults and laser fault injection.
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: Riscure 提供各种智能卡以及一个名为*Piñata*的嵌入式目标，并配有其工具。这些目标允许运行更复杂的算法和测试，适用于 Riscure 工具链，包括多种故障和激光故障注入。
- en: '![faa031](image_fi/278748b01/faa031.png)'
  id: totrans-283
  prefs: []
  type: TYPE_IMG
  zh: '![faa031](image_fi/278748b01/faa031.png)'
- en: 'Figure A-31: The ChipWhisperer CW305 has an Artix A35/A100 FPGA target and
    allows you to implement algorithms in hardware.'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A-31：ChipWhisperer CW305 拥有 Artix A35/A100 FPGA 目标，允许您在硬件中实现算法。
