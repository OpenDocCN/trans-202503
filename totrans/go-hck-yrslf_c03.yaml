- en: '3'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Building Your Own Virtual Hacking Lab
  prefs: []
  type: TYPE_NORMAL
- en: '![](image_fi/book_art/chapterart.png)'
  prefs: []
  type: TYPE_IMG
- en: To learn hacking safely and ethically, you’ll use *virtual machines (VMs)*,
    programs that emulate separate computers within your physical desktop or laptop.
    You can isolate a VM so anything you do in it won’t affect your computer or your
    network. For example, if you open a file with a virus in a VM, the virus would
    infect only the virtual machine, not your real computer.
  prefs: []
  type: TYPE_NORMAL
- en: '*Virtualization software* lets you run a virtual machine (called a *guest*)
    on your desktop or laptop (the *host*). In this chapter, we’ll install VirtualBox,
    a free virtualization program, and the VirtualBox Extension Pack. Then we’ll create
    two VMs. The first will be an *attacking* VM running the Kali Linux operating
    system. You’ll use this VM to launch your hacks. The other virtual machine will
    be a *target* VM running Windows. You’ll direct your hacks at this machine. After
    setting up these two VMs, you’ll be able to safely try out hacking tools without
    affecting your computer or anyone else’s.'
  prefs: []
  type: TYPE_NORMAL
- en: Setting Up VirtualBox
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Follow these instructions to download and set up VirtualBox.
  prefs: []
  type: TYPE_NORMAL
- en: Go to the VirtualBox home page at [https://www.virtualbox.org/](https://www.virtualbox.org/)
    and click the **Download VirtualBox** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The VirtualBox Downloads page lists options for Windows, macOS, and multiple
    Linux host operating systems. Click the option that matches your computer to download
    the latest version of VirtualBox.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Open the downloaded file and follow the onscreen instructions to install VirtualBox.
    (Windows users should choose to run the file as an administrator; you must have
    administrator privileges to run VirtualBox.)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In addition to VirtualBox itself, you need to install the VirtualBox Extension
    Pack, which adds required features like support for attaching newer USB devices
    to your VMs. Go ahead and install it now.
  prefs: []
  type: TYPE_NORMAL
- en: Return to the VirtualBox Downloads page ([https://www.virtualbox.org/wiki/Downloads](https://www.virtualbox.org/wiki/Downloads)),
    find the VirtualBox Extension Pack section, and click **All supported platforms**
    to download the Extension Pack.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Open VirtualBox. (On Windows, be sure to right-click the VirtualBox icon and
    choose **Run as administrator**.)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Open the Extension Pack from your *Downloads* folder.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once the VirtualBox Extension Pack installation window opens, click **Install**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Creating a Kali Linux Virtual Machine
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now that you have VirtualBox, you’ll create your Kali Linux virtual machine.
    Kali is a version of the Linux operating system used by ethical hackers worldwide.
    It includes over 600 security and hacking tools, so it’s a perfect operating system
    for your attacking VM.
  prefs: []
  type: TYPE_NORMAL
- en: Go to [https://www.kali.org/downloads/](https://www.kali.org/downloads/), scroll
    down to the Virtual Machines section, and click the link to go to the VM Download
    Page.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the **Kali Linux VirtualBox Images** tab to see the download options compatible
    with VirtualBox. Make sure to look for VirtualBox images—there are also images
    made for VMware, a different software package that’s not compatible with VirtualBox.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click **Kali Linux VirtualBox 64-Bit** to download the VM. The file is around
    4GB, so download it somewhere with a fast internet connection.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Start VirtualBox and select **File**▶**Import Appliance**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the folder icon on the right and find your Kali Linux file. Select the
    file, click **Open**, and then click **Next** (on a PC) or **Continue** (on a
    Mac).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You should now see a list of settings for the Kali Linux VM you’re importing.
    Click **Import** to continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: When the VM has finished importing, you’ll see it listed on the left in the
    Oracle VM VirtualBox Manager, as shown in [Figure 3-1](#figure3-1).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![f03001](image_fi/502000c03/f03001.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 3-1: The Kali Linux VM appears in the list on the left of the VirtualBox
    Manager.'
  prefs: []
  type: TYPE_NORMAL
- en: As you add other VMs, they’ll appear in the list alongside Kali. For now, let’s
    test the new Kali VM to make sure it runs on your system.
  prefs: []
  type: TYPE_NORMAL
- en: Running the Kali VM
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Double-click the Kali Linux VM entry in your VirtualBox Manager panel to start
    up the Kali Linux virtual machine. The first time you run a VM in VirtualBox,
    you may encounter errors due to different settings on your Mac or PC. If you have
    any trouble running VirtualBox or starting your Kali VM, see Appendix B.
  prefs: []
  type: TYPE_NORMAL
- en: When the VM finishes booting, you’ll come to a login screen. Log in with the
    username `kali` and the password `kali`. After you log in, you’ll see a screen
    with the signature Kali dragon logo like the one shown in [Figure 3-2](#figure3-2).
    Welcome to Kali Linux!
  prefs: []
  type: TYPE_NORMAL
- en: Using a computer within a computer takes some getting used to. Once you click
    inside the VM window, your keyboard and mouse are “captured” for use within the
    VM. To return your mouse and keyboard to your physical (host) computer, click
    your mouse outside the VM window or press the *host key* on your keyboard. This
    should be the *right* CTRL key on a PC/Linux machine or the *left* COMMAND key
    on a Mac. If you ever need a reminder, the host key should also be identified
    in the bottom-right corner of the VM window.
  prefs: []
  type: TYPE_NORMAL
- en: '![f03002](image_fi/502000c03/f03002.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 3-2: Your Kali Linux VM is ready to go!'
  prefs: []
  type: TYPE_NORMAL
- en: If you find that the VM screen and icons are too small, go to **View**▶**Virtual
    Screen 1** and try changing the scale or resolution. Additionally, if you leave
    your VM alone for a while, the VM window may go blank. If this happens, click
    in the Kali window and press the spacebar to wake up the machine.
  prefs: []
  type: TYPE_NORMAL
- en: Take some time to explore Kali Linux. You won’t be able to connect to the internet
    until we set up the network later in the chapter, but you can still take a look
    around. Click the **Applications** menu at the top of the screen (the button with
    the dragon logo) to see some of Kali’s hundreds of programs and tools. They may
    seem intimidating now, but this book will teach you to use several of them, helping
    you become more confident in exploring others.
  prefs: []
  type: TYPE_NORMAL
- en: After you’ve looked around a bit, close the Kali Linux VM window. You should
    see the Close Virtual Machine pop-up window. Choose **Save the machine state**
    and click **OK**. Saving the machine state lets you pick up where you left off
    the next time you open the VM, like putting your computer to sleep instead of
    powering it completely down. However, if you ever need to reboot a VM after installing
    software or changing settings, you’ll need to choose **Power off the machine**
    instead.
  prefs: []
  type: TYPE_NORMAL
- en: Congratulations! You’ve set up your first virtual machine! If this is your first
    experience with Linux, give yourself a high five! With this Kali VM, you’ll be
    able to test dozens (or even hundreds) of hacks against other, target virtual
    machines to see how online attacks happen and how to defend against them. We’ll
    set up one of those target VMs next.
  prefs: []
  type: TYPE_NORMAL
- en: Creating a Windows VM
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: You’ll now create a second VM that runs Windows. As the most common desktop
    and laptop operating system in the world, Windows is the number one target for
    both ethical and unethical hackers, so it’s an important operating system to learn
    to attack and defend. We’ll download a fully functional Windows 10 VM from the
    Microsoft Edge Developer website.
  prefs: []
  type: TYPE_NORMAL
- en: Go to [https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/](https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/)
    (or search for the Microsoft Edge Developer Virtual Machines website).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose a Windows 10 virtual machine, select VirtualBox as your platform, and
    download the VM. The file is over 6GB, so download this VM somewhere with a fast
    internet connection.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Unzip the downloaded file.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Open VirtualBox and select **File**▶**Import Appliance**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the file icon on the right and find your Windows 10 VM. It will either
    be a *.ova* file or a *.ovf* file. Choose the file, then click **Continue**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You should now see a list of settings for the Windows 10 VM. Click **Import**
    to continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: When it’s done importing, the Windows VM will appear in the VirtualBox Manager
    list along with your Kali VM, as shown in [Figure 3-3](#figure3-3).![f03003](image_fi/502000c03/f03003.png)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Figure 3-3: After you import the Windows VM, you’ll have two VMs in your virtual
    ethical hacking lab!'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Now let’s turn on the Windows 10 VM to make sure it works. Double-click the
    Windows 10 VM in the VirtualBox Manager list. Once the VM loads, click within
    the window to show the Windows login prompt. Log in with the default username,
    `IEUser`, and the default password, `Passw0rd!` (with a zero in place of the letter
    *o*). If the password doesn’t work, check the Microsoft VM download page. The
    default password should be listed under the Download button.
  prefs: []
  type: TYPE_NORMAL
- en: Once the virtual desktop loads, click around and explore a bit. It’s just like
    a regular Windows computer. You won’t be able to surf the internet yet, but we’ll
    set up the virtual network in the next section. Once you’ve finished exploring
    the Windows VM, close the VM and select **Power off the machine**. You need to
    power off the VM completely to change the network settings.
  prefs: []
  type: TYPE_NORMAL
- en: You now have two virtual machines, a Kali Linux VM and a Windows 10 VM, in your
    ethical hacking lab. We’ll add more VMs as we need them in future chapters. As
    soon as we connect these two VMs together, you’ll be able to practice hacking
    and defending without endangering your laptop or desktop.
  prefs: []
  type: TYPE_NORMAL
- en: Connecting Your VMs to a Virtual Network
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: By default, new VMs are connected to a *host-only network*, meaning you can
    access them only from your host computer. To connect your VMs to each other and
    to the internet, we’ll create a *virtual network*. Connecting your Windows and
    Kali machines to a virtual network is like connecting them to the same Wi-Fi network.
  prefs: []
  type: TYPE_NORMAL
- en: In VirtualBox, go to **File**▶**Preferences** (or **VirtualBox**▶**Preferences**
    on a Mac).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to the **Network** tab and click the green Add icon (the one with the plus
    sign) to create a new virtual network.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: A new network (with a name like *NatNetwork*) should appear in the list. Make
    sure the box under the Active column next to the network name is checked.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the network, then click the Settings icon (the one with the yellow gear).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter `PublicNAT` into the Network Name box and change the Network CIDR text
    box by typing **10.0.9.0/24** to set the IP addresses for the VMs.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Leave the Supports DHCP checkbox selected and click **OK** twice to finish creating
    your network.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Our next task is to connect your VMs to the PublicNAT network you’ve created.
  prefs: []
  type: TYPE_NORMAL
- en: Connecting Your Kali VM
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: We’ll start by connecting your Kali VM to the network and testing out the connection.
  prefs: []
  type: TYPE_NORMAL
- en: In the Oracle VM VirtualBox Manager, click your Kali VM and then click **Settings**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Select the **Network** tab and choose **NAT Network** from the Attached to:drop-down
    list. In the Name: drop-down list, choose **PublicNAT**. Then click **OK** to
    save your changes.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Start the Kali VM and log in with the username `kali` and the password `kali`,
    as before.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once the Kali VM desktop appears, open the command line Terminal program by
    clicking the black box icon in the panel at the top left of your screen, circled
    in [Figure 3-4](#figure3-4).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Type the command `ip` `addr` and press **ENTER** to see information about your
    VM’s network connections.![f03004](image_fi/502000c03/f03004.png)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Figure 3-4: Checking the Kali VM’s IP address'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: You should see an IP address starting with `10.0.9` under the `eth0:` section,
    like the one circled in [Figure 3-4](#figure3-4).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: When Kali shows an IP address starting with 10.0.9, it’s connected to the PublicNAT
    network. If you don’t see an address like 10.0.9.*x*, go to **Machine**▶**Reset**
    to restart your Kali VM. When the VM reboots, run the `ip` `addr` command in the
    terminal again. If you still don’t see a 10.0.9.*x* IP address, go back and check
    yo*u*r Kali VM’s network settings in the VirtualBox Manager.
  prefs: []
  type: TYPE_NORMAL
- en: Connecting Your Windows VM
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Connecting your Windows VM to the PublicNAT network works almost exactly like
    connecting your Kali VM.
  prefs: []
  type: TYPE_NORMAL
- en: Go to the VirtualBox Manager, select your Windows VM, and click **Settings**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Click the **Network** tab, select **NAT Network** from the Attached to: drop-down
    list, and choose **PublicNAT** from the Name: drop-down list. Click **OK** to
    apply these settings.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Start your Windows VM and log in with the default password (`Passw0rd!`) as
    before.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: When the VM loads, click the Windows search bar (in the lower left of [Figure
    3-5](#figure3-5)), type `CMD`, and press **ENTER** to open the Windows command
    prompt, which is similar to the Kali Linux Terminal program.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter the command `ipconfig` to check the VM’s network settings.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You should see an IP address in the 10.0.9.*x* range, like the `10.0.9.5` address
    in [Figure 3-5](#figure3-5).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If your address starts with 10.0.9, you’ve successfully connected the Windows
    VM to the PublicNAT network. If not, go to **Machine**▶**Reset** to restart your
    Windows VM. Try the `ipconfig` command again. If you still don’t see a 10.0.9.*x*
    IP address, go back and check your VM’s network settings in the VirtualBox Manager.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![f03005](image_fi/502000c03/f03005.png)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: 'Figure 3-5: Checking your Windows VM’s network settings'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Finally, try testing your network’s internet connection. In your Windows VM,
    open the Microsoft Edge web browser and surf to any web address, like [https://www.nostarch.com/go-hck-yourself/](https://www.nostarch.com/go-hck-yourself/).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If you can’t access any websites, run through the previous steps one more time
    and try closing and restarting the Windows VM.
  prefs: []
  type: TYPE_NORMAL
- en: Updating Your VM Operating Systems
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now that your virtual machines are connected to the internet, we can update
    their operating systems to ensure they have access to the latest features. It’s
    always a good idea to update a computer’s operating system often, either by enabling
    automatic updates or by checking for updates at least once a month. Updating your
    operating system protects you against viruses, hackers, and other online threats.
    It’s one of the most important things you can do to defend against the latest
    cyberattacks.
  prefs: []
  type: TYPE_NORMAL
- en: Updating Kali Linux
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Follow these instructions to update Kali Linux:'
  prefs: []
  type: TYPE_NORMAL
- en: Start your Kali VM and open the terminal command line application again.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'At the terminal prompt, enter the following command to find out what software
    needs to be updated:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Kali will ask for your password the first time you use `sudo`. This command,
    short for “superuser do,” lets you run commands with administrator (or *superuser*)
    privileges. Type `kali` as your password and press **ENTER**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Now use this command to perform the updates:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: You may have to press `Y` to confirm certain updates. As the various software
    packages are updated, they’ll be listed in the terminal window, followed by the
    message `Done`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: When `apt` finishes updating Kali, close the machine and save the machine state.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Updating Windows
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Next we’ll update your Windows VM.
  prefs: []
  type: TYPE_NORMAL
- en: Launch the Windows VM, type `updates` into the Windows search bar, and choose
    **Check for updates** from the list of options.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If updates are available for Windows, you should see an Install now or a Restart
    now button. Click the button to install updates. You may have to restart your
    VM, just like you have to do sometimes for updates to your real computer.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: After your Windows VM finishes updating, close it and save the machine state.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The Takeaway
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this chapter, you set up the VirtualBox virtualization software and created
    two virtual machines, software functioning as computers within your actual computer.
    One of your VMs runs Kali Linux and will act as your attacking computer, while
    the other runs Windows and will act as your target computer. You also created
    a virtual network, named PublicNAT, to connect both VMs to the internet and to
    each other. Then you applied updates to your Kali and Windows VMs.
  prefs: []
  type: TYPE_NORMAL
- en: You’ve now set up a fully functional virtual hacking lab. Well done! With your
    two VMs and your virtual network, you’re ready to safely and ethically try out
    different hacks without affecting your physical computer. In the next chapter,
    we’ll start putting your lab to use by conducting some reconnaissance to see what
    kind of information can be turned up using just a search engine and social media.
  prefs: []
  type: TYPE_NORMAL
