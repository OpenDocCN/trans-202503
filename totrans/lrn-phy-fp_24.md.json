["```\n{-# OPTIONS -Wall #-}\n\nmodule Electricity where\n\nimport SimpleVec\n    ( Vec(..), R, (*^), iHat )\nimport Mechanics3D\n    ( ParticleState(..), defaultParticleState )\nimport MultipleObjects\n    ( TwoBodyForce, MultiParticleState(..), Force(..), statesMPS\n    , eulerCromerMPS, centralForce )\nimport Graphics.Gnuplot.Simple\n    ( Attribute(..), plotPaths )\n```", "```\ntype Charge = R\n```", "```\nelementaryCharge :: Charge\nelementaryCharge = 1.602176634e-19  -- in Coulombs\n```", "```\ncoulombMagnitude :: Charge -> Charge -> R -> R\ncoulombMagnitude q1 q2 r\n    = let k = 9e9  -- in N m^2 / C^2\n      in k * abs (q1 * q2) / r**2\n```", "```\ncoulombForce :: TwoBodyForce\ncoulombForce st1 st2\n    = let k = 9e9  -- N m^2 / C^2\n          q1 = charge st1\n          q2 = charge st2\n      in centralForce (\\r -> k * q1 * q2 / r**2) st1 st2\n```", "```\ntwoProtonStates :: R                     -- time step\n                -> MultiParticleState    -- initial 2-particle state\n                -> [MultiParticleState]  -- infinite list of states\ntwoProtonStates dt\n    = statesMPS (eulerCromerMPS dt) [InternalForce 1 0 coulombForce]\n```", "```\n-- protons are released from rest\ninitialTwoProtonState :: R  -- initial separation\n                      -> MultiParticleState\ninitialTwoProtonState d\n    = let protonMass = 1.673e-27  -- in kg\n      in MPS [defaultParticleState { mass   = protonMass\n                                   , charge = elementaryCharge\n                                   , posVec = (-d/2) *^ iHat\n                                   }\n             ,defaultParticleState { mass   = protonMass\n                                   , charge = elementaryCharge\n                                   , posVec = ( d/2) *^ iHat\n                                   }\n             ]\n```", "```\noneProtonVelocity :: R        -- dt\n                  -> R        -- starting separation\n                  -> [(R,R)]  -- (time,velocity) pairs\noneProtonVelocity dt d\n    = let state0 = initialTwoProtonState d\n      in [(time st2, xComp $ velocity st2)\n              | MPS [_,st2] <- twoProtonStates dt state0]\n```", "```\ntvPairs :: [(R,R)]\ntvPairs = takeWhile (\\(t,_) -> t <= 2e-2) $\n          oneProtonVelocity 1e-5 1e-2\n```", "```\nvelocityPlot :: IO ()\nvelocityPlot\n    = plotPaths [Title \"Two protons released from 1 cm\"\n                ,XLabel \"Time (s)\"\n                ,YLabel \"Proton velocity (m/s)\"\n                ,PNG \"protons.png\"\n                ,Key Nothing\n                ] $ [tvPairs\n                    ,[(t,1379*t) | t <- [0,1e-5..4e-3]]\n                    ,[(t,3.71)   | t <- [0,1e-3..2e-2]]]\n```", "```\nPrelude>  :l Electricity\n[1 of 6] Compiling Newton2          ( Newton2.hs, interpreted )\n[2 of 6] Compiling Mechanics1D      ( Mechanics1D.hs, interpreted )\n[3 of 6] Compiling SimpleVec        ( SimpleVec.hs, interpreted )\n[4 of 6] Compiling Mechanics3D      ( Mechanics3D.hs, interpreted )\n[5 of 6] Compiling MultipleObjects  ( MultipleObjects.hs, interpreted )\n[6 of 6] Compiling Electricity      ( Electricity.hs, interpreted )\nOk, six modules loaded.\n*Electricity> twoProtonStates 1e-5 (initialTwoProtonState 0.01) !! 500\nMPS {particleStates =\n     [ParticleState {mass = 1.673e-27,\n                     charge = 1.602176634e-19,\n                     time = 4.9999999999999645e-3,\n                     posVec = vec (-1.550866906307423e-2) 0.0 0.0,\n                     velocity = vec (-3.0582222353914252) 0.0 0.0},\n      ParticleState {mass = 1.673e-27,\n                     charge = 1.602176634e-19,\n                     time = 4.9999999999999645e-3,\n                     posVec = vec 1.550866906307423e-2 0.0 0.0,\n                     velocity = vec 3.0582222353914252 0.0 0.0}]}\n```", "```\noneProtonPosition :: R        -- dt\n                  -> R        -- starting separation\n                  -> [(R,R)]  -- (time,position) pairs\noneProtonPosition dt d\n    = undefined dt d\n\npositionPlot :: IO ()\npositionPlot = plotPaths [Title \"Two protons released from 1 cm\"\n                         ,XLabel \"Time (s)\"\n                         ,YLabel \"Proton position (m)\"\n                         ,PNG \"ProtonPosition.png\"\n                         ,Key Nothing\n                         ] $ [undefined $ oneProtonPosition 1e-5 1e-2\n                            ,undefined :: [(R,R)]]\n```"]