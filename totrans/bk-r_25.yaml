- en: '**21**'
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**21**'
- en: '**MULTIPLE LINEAR REGRESSION**'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '**多元线性回归**'
- en: '![image](../images/common-01.jpg)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/common-01.jpg)'
- en: Multiple linear regression is a straightforward generalization of the single-predictor
    models discussed in the previous chapter. It allows you to model your continuous
    response variable in terms of more than one predictor so you can measure the joint
    effect of several explanatory variables on the response variable. In this chapter,
    you’ll see how to model your response variable in this way, and you’ll use R to
    fit the model using least-squares. You’ll also explore other key statistical aspects
    of linear modeling in the R environment, such as transforming variables and including
    interactive effects.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 多元线性回归是对上一章讨论的单一预测变量模型的直接推广。它允许你通过多个预测变量来建模你的连续响应变量，从而衡量多个解释变量对响应变量的联合影响。在本章中，你将看到如何以这种方式建模响应变量，并使用R来通过最小二乘法拟合模型。你还将探索线性建模的其他关键统计方面，如变量转换和包含交互效应。
- en: Multiple linear regression represents an important part of the practice of statistics.
    It lets you control or adjust for multiple sources of influence on the value of
    the response, rather than just measuring the effect of one explanatory variable
    (in most situations, there is more than one contributor to the outcome measurements).
    At the heart of this class of methods is the intention to uncover potentially
    causal relationships between your response variable and the (joint) effect of
    any explanatory variables. In reality, causality itself is extremely difficult
    to establish, but you can strengthen any evidence of causality by using a well-designed
    study supported by sound data collection and by fitting models that might realistically
    gauge the relationships present in your data.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 多元线性回归是统计学实践中的一个重要部分。它允许你控制或调整多个因素对响应值的影响，而不仅仅是衡量一个解释变量的效果（在大多数情况下，结果的测量有多个因素共同作用）。这种方法的核心目标是揭示响应变量与任何解释变量（联合作用）的潜在因果关系。实际上，因果关系本身非常难以确立，但你可以通过设计良好的研究、支持有力的数据收集，及拟合能够合理衡量数据中关系的模型，来增强因果关系的证据。
- en: '**21.1 Terminology**'
  id: totrans-5
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**21.1 术语**'
- en: Before you look at the theory behind multiple regression models, it’s important
    to have a clear understanding of some terminology associated with variables.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在你了解多元回归模型背后的理论之前，首先要清楚理解一些与变量相关的术语。
- en: • A *lurking variable* influences the response, another predictor, or both,
    but goes unmeasured (or is not included) in a predictive model. For example, say
    a researcher establishes a link between the volume of trash thrown out by a household
    and whether the household owns a trampoline. The potential lurking variable here
    would be the number of children in the household—this variable is more likely
    to be positively associated with an increase in trash and chances of owning a
    trampoline. An interpretation that suggests owning a trampoline is a cause of
    increased waste would be erroneous.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: • *潜在变量*影响响应变量、另一个预测变量，或者两者，但在预测模型中未被测量（或未被包括）。例如，假设一位研究人员发现家庭丢弃垃圾的量与家庭是否拥有蹦床之间存在关联。这里的潜在变量可能是家庭中孩子的数量——这一变量更可能与垃圾量的增加和拥有蹦床的几率正相关。将蹦床的拥有与垃圾增加直接关联的解释是错误的。
- en: • The presence of a lurking variable can lead to spurious conclusions about
    causal relationships between the response and the other predictors, or it can
    mask a true cause-and-effect association; this kind of error is referred to as
    *confounding*. To put it another way, you can think of confounding as the entanglement
    of the effects of one or more predictors on the response.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: • 潜在变量的存在可能导致关于响应变量与其他预测变量之间因果关系的虚假结论，或者它可能掩盖一个真实的因果关系；这种错误被称为*混淆*。换句话说，你可以将混淆理解为一个或多个预测变量对响应变量的影响交织在一起。
- en: • A *nuisance* or *extraneous variable* is a predictor of secondary or no interest
    that has the potential to confound relationships between other variables and so
    affect your estimates of the other regression coefficients. Extraneous variables
    are included in the modeling as a matter of necessity, but the specific nature
    of their influence on the response is not the primary interest of the analysis.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: • 一个 *干扰* 或 *外部变量* 是一个次要的或不相关的预测变量，它有可能混淆其他变量之间的关系，从而影响你对其他回归系数的估计。外部变量作为必要的建模元素被包含在内，但它们对响应的具体影响并不是分析的主要关注点。
- en: These definitions will become clearer once you begin fitting and interpreting
    the regression models in [Section 21.3](ch21.xhtml#ch21lev1sec69). The main message
    I want to emphasize here, once more, is that correlation does not imply causation.
    If a fitted model finds a statistically significant association between a predictor
    (or predictors) and a response, it’s important to consider the possibility that
    lurking variables are contributing to the results and to attempt to control any
    confounding before you draw conclusions. Multiple regression models allow you
    to do this.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你开始拟合并解释回归模型，在[第21.3节](ch21.xhtml#ch21lev1sec69)中，这些定义将变得更加清晰。我想再次强调的主要信息是，相关性并不意味着因果关系。如果拟合的模型发现预测变量（或多个预测变量）与响应之间存在统计显著关联，那么考虑潜在变量可能对结果的影响是非常重要的，并且在得出结论之前，要尽量控制任何混杂因素。多元回归模型使你能够做到这一点。
- en: '**21.2 Theory**'
  id: totrans-11
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**21.2 理论**'
- en: Before you start using R to fit regression models, you’ll examine the technical
    definitions of a linear regression model with multiple predictors. Here, you’ll
    look at how the models work in a mathematical sense and get a glimpse of the calculations
    that happen “behind the scenes” when estimating the model parameters in R.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始使用 R 来拟合回归模型之前，你需要检查具有多个预测变量的线性回归模型的技术定义。在这里，你将从数学角度了解模型的工作原理，并一窥在 R 中估计模型参数时“幕后”发生的计算过程。
- en: '***21.2.1 Extending the Simple Model to a Multiple Model***'
  id: totrans-13
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***21.2.1 将简单模型扩展到多重模型***'
- en: Rather than having just one predictor, you want to determine the value of a
    continuous response variable *Y* given the values of *p* > 1 independent explanatory
    variables *X*[1], *X*[2], . . ., *X*[p]. The overarching model is defined as
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 与仅有一个预测变量不同，你希望根据 *p* > 1 个独立解释变量 *X*[1], *X*[2], . . ., *X*[p] 的值来确定一个连续响应变量
    *Y* 的值。总体模型定义为：
- en: '![image](../images/e21-1.jpg)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e21-1.jpg)'
- en: where *β*[0], . . . , *β*[p] are the regression coefficients and, as before,
    you assume independent, normally distributed residuals є ~ N(0, ˙) around the
    mean.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，*β*[0], . . . , *β*[p] 是回归系数，并且，如前所述，你假设残差 є ~ N(0, ˙) 独立、正态分布，围绕均值分布。
- en: In practice, you have *n* data records; each record provides values for each
    of the predictors *X*[*j*] ; *j* = {1, . . ., *p*}. The model to be fitted is
    given in terms of the mean response, conditional upon a particular realization
    of the set of explanatory variables
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在实践中，你有 *n* 个数据记录；每个记录为每个预测变量 *X*[*j*] 提供值；*j* = {1, . . ., *p*}。待拟合的模型是基于特定解释变量集合的实现条件下的均值响应给出的。
- en: '![image](../images/f0487-01.jpg)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f0487-01.jpg)'
- en: where the ![image](../images/bj.jpg) represent estimates of the regression coefficients.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，![image](../images/bj.jpg) 代表回归系数的估计值。
- en: In simple linear regression, where you have only one predictor variable, recall
    that the goal is to find the “line of best fit.” The idea of least-squares estimation
    for linear models with multiple independent predictors follows much the same motivation.
    Now, however, in an abstract sense you can think of the relationship between response
    and predictors as a multidimensional plane or surface. You want to find the surface
    that best fits your multivariate data in terms of minimizing the overall squared
    distance between itself and the raw response data.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在简单线性回归中，当你只有一个预测变量时，回顾一下，目标是找到“最佳拟合线”。对于多个独立预测变量的线性模型，最小二乘估计的思想是类似的。然而，现在你可以在抽象意义上将响应与预测变量之间的关系看作是一个多维平面或曲面。你要找到一个表面，它最能拟合你的多变量数据，并通过最小化该表面与原始响应数据之间的总平方距离来实现。
- en: More formally, for your *n* data records, the ![image](../images/bj.jpg) are
    found as the values that minimize the sum
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 更正式地，对于你的 *n* 数据记录，![image](../images/bj.jpg) 是通过最小化以下总和得到的值：
- en: '![image](../images/e21-2.jpg)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e21-2.jpg)'
- en: where *x* [*j*],[*i*] is the observed value of individual *i* for explanatory
    variable *X*[*j*] and *y[i]* is their response value.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，*x* [*j*],[*i*] 是第 *i* 个个体在解释变量 *X*[*j*] 上的观察值，*y[i]* 是他们的响应值。
- en: '***21.2.2 Estimating in Matrix Form***'
  id: totrans-24
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***21.2.2 矩阵形式的估计***'
- en: The computations involved in minimizing this squared distance (21.2) are made
    much easier by a *matrix representation* of the data. When dealing with *n* multivariate
    observations, you can write [Equation (21.1)](ch21.xhtml#ch21eq1) as follows,
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 通过数据的 *矩阵表示*，最小化此平方距离 (21.2) 的计算变得更加简便。在处理 *n* 个多变量观察值时，你可以将 [公式 (21.1)](ch21.xhtml#ch21eq1)
    写作如下，
- en: '***Y*** = ***X*** · + є,'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '***Y*** = ***X*** · + є,'
- en: where ***Y*** and є denote *n* × 1 column matrices such that
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 ***Y*** 和 є 表示 *n* × 1 的列矩阵，使得
- en: '![image](../images/f0487-02.jpg)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f0487-02.jpg)'
- en: 'Here, *y[i]* and є[*i*] refer to the response observation and random error
    term for the *i*th individual. The quantity ***β*** is a (*p* + 1) × 1 column
    matrix of the regression coefficients, and then the observed predictor data for
    all individuals and explanatory variables are stored in an *n* × (*p* + 1) matrix
    ***X***, called the *design matrix*:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，*y[i]* 和 є[*i*] 分别表示第 *i* 个个体的响应观察值和随机误差项。量 ***β*** 是一个 (*p* + 1) × 1 的回归系数列矩阵，而所有个体的观察预测数据和解释变量则存储在一个
    *n* × (*p* + 1) 的矩阵 ***X*** 中，这个矩阵被称为 *设计矩阵*：
- en: '![image](../images/f0488-01.jpg)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f0488-01.jpg)'
- en: 'The minimization of (21.2) providing the estimated regression coefficient values
    is then found with the following calculation:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 最小化 (21.2) 提供的估计回归系数值是通过以下计算得到的：
- en: '![image](../images/e21-3.jpg)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e21-3.jpg)'
- en: 'It’s important to note the following:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 需要注意以下几点：
- en: • The symbol · represents matrix multiplication, the superscript ^⊤ represents
    the transpose, and ^−¹ represents the inverse when applied to matrices (as per
    [Section 3.3](ch03.xhtml#ch03lev1sec14)).
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: • 符号 · 表示矩阵乘法，上标 ^⊤ 表示转置，^−¹ 表示逆矩阵（参见 [第3.3节](ch03.xhtml#ch03lev1sec14)）。
- en: • Extending the size of *β* and ***X*** (note the leading column of 1s in ***X***)
    to create structures of size *p* + 1 (as opposed to just the number of predictors
    *p*) allows for the estimation of the overall intercept *β*[0].
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: • 扩展 *β* 和 ***X*** 的大小（注意 ***X*** 中前导的 1 列）以创建 *p* + 1 的结构（而不仅仅是预测变量的数量 *p*），从而可以估计总体截距
    *β*[0]。
- en: • As well as (21.3), the design matrix plays a crucial role in the estimation
    of other quantities, such as the standard errors of the coefficients.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: • 除了 (21.3) 外，设计矩阵在估计其他量（如回归系数的标准误差）中也发挥着关键作用。
- en: '***21.2.3 A Basic Example***'
  id: totrans-37
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***21.2.3 一个基本示例***'
- en: 'You can manually estimate the *β[j]* (*j* = 0, 1, . . ., *p*) in R using the
    functions covered in [Chapter 3](ch03.xhtml#ch03): `%*%` (matrix multiplication),
    `t` (matrix transposition), and `solve` (matrix inversion). As a quick demonstration,
    let’s say you have two predictor variables: *X[1]* as continuous and *X[2]* as
    binary. Your target regression equation is therefore ![image](../images/f0488-01a.jpg).
    Suppose you collect the following data, where the response data, data for *X*[1],
    and data for *X*[2], for *n* = 8 individuals, are given in the columns `y`, `x1`,
    and `x2`, respectively.'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 [第3章](ch03.xhtml#ch03) 中介绍的函数在 R 中手动估计 *β[j]*（*j* = 0, 1, ..., *p*）：`%*%`（矩阵乘法）、`t`（矩阵转置）和
    `solve`（矩阵求逆）。作为一个快速示例，假设你有两个预测变量：*X[1]* 是连续的，*X[2]* 是二元的。因此，你的目标回归方程是 ![image](../images/f0488-01a.jpg)。假设你收集了以下数据，其中响应数据、*X*[1]
    和 *X*[2] 的数据，针对 *n* = 8 个个体，分别列在 `y`、`x1` 和 `x2` 列中。
- en: '[PRE0]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: To get your point estimates in ***β*** = [*β*[0], *β*[1], *β*[2]]^┬ for the
    linear model, you first have to construct ***X*** and ***Y*** as required by (21.3).
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 要获得线性模型中 ***β*** = [*β*[0], *β*[1], *β*[2]]^┬ 的点估计，你首先需要按照 (21.3) 的要求构造 ***X***
    和 ***Y***。
- en: '[PRE1]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Now all you have to do is execute the line corresponding to (21.3).
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你需要做的就是执行与公式 (21.3) 相对应的那行代码。
- en: '[PRE2]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: You’ve just used least-squares to fit your model based on the observed data
    in `demo.data`, which results in the estimates ![image](../images/f0489-01.jpg),
    ![image](../images/f0489-02.jpg), and ![image](../images/f0489-03.jpg).
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 你刚刚使用最小二乘法根据 `demo.data` 中的观察数据拟合了你的模型，得到了估计值 ![image](../images/f0489-01.jpg)、![image](../images/f0489-02.jpg)
    和 ![image](../images/f0489-03.jpg)。
- en: '**21.3 Implementing in R and Interpreting**'
  id: totrans-45
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**21.3 在 R 中实现与解释**'
- en: Ever helpful, R automatically builds the matrices and carries out all the necessary
    calculations when you instruct it to fit a multiple linear regression model. As
    in simple regression models, you use `lm` and just include any additional predictors
    when you specify the formula in the first argument. So that you can focus on the
    R syntax and on interpretation, I’ll focus only on *main effects* for the moment,
    and then you’ll explore more complex relationships later in the chapter.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: R 总是很有帮助，当你指示它拟合多元线性回归模型时，它会自动构建矩阵并执行所有必要的计算。与简单回归模型一样，你使用 `lm` 并在指定第一个参数的公式时包含任何额外的预测变量。为了让你能够专注于
    R 语法和结果解释，我暂时只关注*主效应*，然后你可以在本章后面探索更复杂的关系。
- en: When it comes to output and interpretation, working with multiple explanatory
    variables follows the same rules as you’ve seen in [Chapter 20](ch20.xhtml#ch20).
    Any numeric-continuous variables (or a categorical variable being treated as such)
    have a slope coefficient that provides a “per-unit-change” quantity. Any *k*-group
    categorical variables (factors, formally unordered) are dummy coded and provide
    *k* − 1 intercepts.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在输出和解释方面，使用多个解释变量遵循的规则与[第20章](ch20.xhtml#ch20)中看到的相同。任何数值型连续变量（或作为此类变量处理的分类变量）都有一个斜率系数，提供“每单位变化”的数量。任何
    *k* 类别的分类变量（因子，形式上是无序的）都采用虚拟编码，并提供 *k* − 1 个截距。
- en: '***21.3.1 Additional Predictors***'
  id: totrans-48
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***21.3.1 额外的预测变量***'
- en: 'Let’s first confirm the manual matrix calculations from a moment ago. Using
    the `demo.data` object, fit the multiple linear model and examine the coefficients
    from that object as follows:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们首先确认一下刚才手动计算的矩阵。使用 `demo.data` 对象，拟合多元线性模型，并按如下方式检查该对象的系数：
- en: '[PRE3]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: You’ll see that you obtain exactly the point estimates stored earlier in `BETA.HAT`.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 你将看到，你得到的正是之前在 `BETA.HAT` 中存储的点估计。
- en: With the response variable on the left as usual, you specify the multiple predictors
    on the right side of the `~` symbol; altogether this represents the formula argument.
    To fit a model with several main effects, use `+` to separate any variables you
    want to include. In fact, you’ve already seen this notation in [Section 19.2.2](ch19.xhtml#ch19lev2sec172),
    when investigating two-way ANOVA.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 按照惯例，响应变量位于左侧，你在 `~` 符号的右侧指定多个预测变量；所有这些一起构成了公式参数。为了拟合包含多个主效应的模型，使用 `+` 来分隔你想要包含的任何变量。事实上，你已经在[第19.2.2节](ch19.xhtml#ch19lev2sec172)中看到过这种符号，用于研究双因素方差分析。
- en: To study the interpretation of the parameter estimates of a multiple linear
    regression model, let’s return to the `survey` data set in the `MASS` package.
    In [Chapter 20](ch20.xhtml#ch20), you explored several simple linear regression
    models based on a response variable of student height, as well as stand-alone
    predictors of handspan (continuous) and sex (categorical, *k* = 2). You found
    that handspan was highly statistically significant, with the estimated coefficient
    suggesting an average increase of about 3.12 cm for each 1 cm increase in handspan.
    When you looked at the same *t*-test using sex as the explanatory variable, the
    model also suggested evidence against the null hypothesis, with “being male” adding
    around 13.14 cm to the mean height when compared to the mean for females (the
    category used as the reference level).
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 为了研究多元线性回归模型参数估计值的解释，我们回到 `MASS` 包中的 `survey` 数据集。在[第20章](ch20.xhtml#ch20)中，你探讨了几种简单的线性回归模型，基于学生身高作为响应变量，以及手掌跨度（连续型）和性别（分类变量，*k*
    = 2）作为独立预测变量。你发现手掌跨度在统计学上非常显著，估计系数表明手掌跨度每增加1厘米，身高平均增加约3.12厘米。当你使用性别作为解释变量查看相同的
    *t*-检验时，模型也提供了反对零假设的证据，表明“男性”与女性（作为参考类别）相比，平均身高多出约13.14厘米。
- en: What those models can’t tell you is the *joint effect* of sex and handspan on
    predicting height. If you include both predictors in a multiple linear model,
    you can (to some extent) reduce any confounding that might otherwise occur in
    the isolated fits of the effect of either single predictor on height.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 这些模型无法告诉你的是性别和手掌跨度对预测身高的*联合效应*。如果你在多元线性模型中同时包含这两个预测变量，你可以（在一定程度上）减少可能在单独拟合每个预测变量对身高影响时发生的混杂效应。
- en: '[PRE4]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The coefficient for handspan is now only about 1.59, almost half of its corresponding
    value (3.12 cm) in the stand-alone simple linear regression for height. Despite
    this, it’s still highly statistically significant in the presence of sex. The
    coefficient for sex has also reduced in magnitude when compared with its simple
    linear model and is also still significant in the presence of handspan. You’ll
    interpret these new figures in a moment.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 手掌跨度的系数现在只有大约1.59，几乎是其在独立的简单线性回归中与身高相关的系数（3.12厘米）的一半。尽管如此，在性别存在的情况下，它仍然具有高度的统计显著性。与其简单线性模型相比，性别的系数也有所减小，但在手掌跨度的存在下仍然显著。稍后你会解释这些新数字。
- en: As for the rest of the output, the `Residual standard error` still provides
    you with an estimate of the standard error of the random noise term є, and you’re
    also provided with an `R-squared` value. When associated with more than one predictor,
    the latter is formally referred to as the coefficient of *multiple* determination.
    The calculation of this coefficient, as in the single predictor setting, comes
    from the correlations between the variables in the model. I’ll leave the theoretical
    intricacies to more advanced texts, but it’s important to note that `R-squared`
    still represents the proportion of variability in the response that’s explained
    by the regression; in this example, it sits at around 0.51.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 至于其余的输出，`Residual standard error`仍然为你提供了随机噪声项є的标准误差估计值，同时还提供了一个`R-squared`值。当与多个预测变量关联时，后者正式被称为*多重*决定系数。这个系数的计算，与单一预测变量设置中的计算方式一样，来自于模型中各变量之间的相关性。我将理论上的复杂性留给更高级的文献，但需要注意的是，`R-squared`仍然代表了回归模型解释的响应变量的变异性比例；在这个例子中，它约为0.51。
- en: You can continue to add explanatory variables in the same way if you need to
    do so. In [Section 20.5.2](ch20.xhtml#ch20lev2sec186), you examined smoking frequency
    as a stand-alone categorical predictor for height and found that this explanatory
    variable provided no statistical evidence of an impact on the mean response. But
    could the smoking variable contribute in a statistically significant way if you
    control for handspan and sex?
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 如果需要，你可以继续以相同的方式添加解释变量。在[第20.5.2节](ch20.xhtml#ch20lev2sec186)中，你曾将吸烟频率作为单独的分类预测变量来分析身高，发现该解释变量并未提供对均值响应的显著统计影响。但是，如果你控制了手掌跨度和性别，吸烟变量是否能够以统计显著的方式做出贡献呢？
- en: '[PRE5]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Since it’s a categorical variable with *k* > 2 levels, `Smoke` is dummy coded
    (with heavy smokers as the default reference level), giving you three extra intercepts
    for the three nonreference levels of the variable; the fourth is incorporated
    into the overall intercept.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 由于吸烟是一个具有*k* > 2个水平的分类变量，`Smoke`采用虚拟编码（以重度吸烟者为默认参考水平），为该变量的三个非参考水平提供了三个额外的截距项；第四个则并入总体截距。
- en: In the `summary` of the latest fit, you can see that while handspan and sex
    continue to yield very small *p*-values, smoking frequency suggests no such evidence
    against the hypotheses of zero coefficients. The smoking variable has had little
    effect on the values of the other coefficients compared with the previous model
    in `survmult`, and the `R-squared` coefficient of multiple determination has barely
    increased.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 在最新拟合的`summary`中，你可以看到，尽管手掌跨度和性别继续产生非常小的*p*值，但吸烟频率并未提供与零系数假设相悖的证据。与`survmult`中的前一个模型相比，吸烟变量对其他系数值的影响很小，并且`R-squared`多重决定系数几乎没有增加。
- en: 'One question you might now ask is, if smoking frequency doesn’t benefit your
    ability to predict mean height in any substantial way, should you remove that
    variable from the model altogether? This is the primary goal of *model selection*:
    to find the “best” model for predicting the outcome, without fitting one that
    is unnecessarily complex (by including more explanatory variables than is required).
    You’ll look at some common ways researchers attempt to achieve this in [Section
    22.2](ch22.xhtml#ch22lev1sec73).'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 你现在可能会问，如果吸烟频率在预测均值身高方面没有实质性的帮助，是否应该将该变量从模型中完全移除？这是*模型选择*的主要目标：找到最适合预测结果的“最佳”模型，而不是拟合一个不必要复杂的模型（通过包含过多不必要的解释变量）。你将在[第22.2节](ch22.xhtml#ch22lev1sec73)中查看研究人员尝试实现这一目标的几种常见方法。
- en: '***21.3.2 Interpreting Marginal Effects***'
  id: totrans-63
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***21.3.2 边际效应的解释***'
- en: In multiple regression, the estimation of each predictor takes into account
    the effect of all other predictors present in the model. A coefficient for a specific
    predictor *Z* should therefore be interpreted as the change in the mean response
    for a one-unit increase in *Z*, while holding all other predictors constant.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 在多元回归中，每个预测因子的估计考虑了模型中所有其他预测因子的影响。因此，特定预测因子*Z*的系数应解释为在保持其他所有预测因子不变的情况下，*Z*增加一个单位时平均反应的变化。
- en: 'As you’ve determined that smoking frequency still appears to have no discernible
    impact on mean height when taking sex and handspan into consideration, return
    your focus to `survmult`, the model that includes only the explanatory variables
    of sex and handspan. Note the following:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 既然你已经确定吸烟频率在考虑性别和手掌跨度时似乎对平均身高没有明显影响，那么请将注意力重新集中到`survmult`，这个模型只包含性别和手掌跨度这两个解释变量。请注意以下几点：
- en: • For students of the same sex (that is, focusing on either just males or just
    females), a 1 cm increase in handspan leads to an estimated increase of 1.5944
    cm in mean height.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: • 对于相同性别的学生（即仅关注男性或仅关注女性），手掌跨度增加1厘米，预计平均身高将增加1.5944厘米。
- en: • For students of similar handspan, males on average will be 9.4898 cm taller
    than females.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: • 对于手掌跨度相似的学生，男性的平均身高比女性高9.4898厘米。
- en: • The difference in the values of the two estimated predictor coefficients when
    compared with their respective simple linear model fits, plus the fact that both
    continue to indicate evidence against the null hypothesis of “being zero” in the
    multivariate fit, suggests that confounding (in terms of the effect of both handspan
    and sex on the response variable of height) is present in the single-predictor
    models.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: • 当将两个估计的预测系数与各自的简单线性模型拟合进行比较时，值的差异，再加上两者在多元拟合中仍然表明反对“为零”这一零假设的证据，表明在单一预测模型中存在混杂（即手掌跨度和性别对身高反应变量的影响）。
- en: The final point highlights the general usefulness of multiple regression. It
    shows that, in this example, if you use only single predictor models, the determination
    of the “true” impact that each explanatory variable has in predicting the mean
    response is misleading since some of the change in height is determined by sex,
    but some is also attributed to handspan. It’s worth noting that the coefficient
    of determination (refer to [Section 20.3.3](ch20.xhtml#ch20lev2sec179)) for the
    `survmult` model is noticeably higher than the same quantity in either of the
    single-variate models, so you’re actually accounting for more of the variation
    in the response by using multiple regression.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一点突出了多元回归的一般用途。它表明，在此示例中，如果仅使用单一预测模型，确定每个解释变量在预测平均反应中所产生的“真实”影响是误导性的，因为身高的变化部分由性别决定，另一部分则归因于手掌跨度。值得注意的是，`survmult`模型的决定系数（参见[第20.3.3节](ch20.xhtml#ch20lev2sec179)）明显高于任何单变量模型中的同一数量，因此通过使用多元回归，实际上你考虑到了更多反应变量的变化。
- en: The fitted model itself can be thought of as
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 拟合的模型本身可以被视为
- en: '![image](../images/e21-4.jpg)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e21-4.jpg)'
- en: where “handspan” is the writing handspan supplied in centimeters and “sex” is
    supplied as either 1 (if male) or 0 (if female).
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，“手掌跨度”是以厘米为单位提供的写手手掌跨度，“性别”则以1（男性）或0（女性）的方式提供。
- en: '**NOTE**'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*The baseline (overall) intercept of around 137.687 cm represents the mean
    height of a female with a handspan of 0 cm—again, this is clearly not directly
    interpretable in the context of the application. For this kind of situation, some
    researchers center the offending continuous predictor (or predictors) on zero
    by subtracting the sample mean of all the observations on that predictor from
    each observation prior to fitting the model. The centered predictor data are then
    used in place of the original (untranslated) data. The resulting fitted model
    allows you to use the mean value of the untranslated predictor (in this case handspan)
    rather than a zero value in order to directly interpret the intercept estimate*
    ![image](../images/b0.jpg).'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '*基准（总体）截距约为137.687厘米，表示一个手掌跨度为0厘米的女性的平均身高——再次强调，这在应用的背景下显然无法直接解释。在这种情况下，一些研究者会通过从每个观察值中减去该预测因子所有观测值的样本均值，将问题中的连续预测因子（或多个预测因子）中心化为零，然后使用中心化后的数据进行模型拟合。通过这种方式拟合的模型允许你使用未转换预测因子（在此例中为手掌跨度）的均值，而不是零值，以便直接解释截距估计值*
    ![image](../images/b0.jpg)。'
- en: '***21.3.3 Visualizing the Multiple Linear Model***'
  id: totrans-75
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***21.3.3 可视化多元线性模型***'
- en: 'As shown here, “being male” simply changes the overall intercept by around
    9.49 cm:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 如图所示，“性别为男性”仅将整体截距改变约9.49厘米：
- en: '[PRE6]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Because of this, you could also write (21.4) as two equations. Here’s the equation
    for female students:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，你也可以将（21.4）写成两个方程式。这里是女性学生的方程：
- en: “Mean height” = 137.687 + 1.594 × “handspan”
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: “平均身高” = 137.687 + 1.594 × “手掌宽度”
- en: 'Here’s the equation for male students:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是男性学生的方程：
- en: '| “Mean height” | = | (137.687 + 9.4898) + 1.594 × “handspan” |'
  id: totrans-81
  prefs: []
  type: TYPE_TB
  zh: '| “平均身高” | = | (137.687 + 9.4898) + 1.594 × “手掌宽度” |'
- en: '|  | = | 147.177 + 1.594 × “handspan” |'
  id: totrans-82
  prefs: []
  type: TYPE_TB
  zh: '|  | = | 147.177 + 1.594 × “手掌宽度” |'
- en: 'This is handy because it allows you to visualize the multivariate model in
    much the same way as you can the simple linear models. This code produces [Figure
    21-1](ch21.xhtml#ch21fig1):'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 这很方便，因为它让你能够像可视化简单线性模型一样，可视化多变量模型。此代码生成了[图21-1](ch21.xhtml#ch21fig1)：
- en: '[PRE7]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: First, a scatterplot of the height and handspan observations, split by sex,
    is drawn. Then, `abline` adds the line corresponding to females and adds a second
    one corresponding to males, based on those two equations.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，绘制一个按照性别分割的身高和手掌宽度的散点图。然后，`abline`会添加一条对应女性的线，并基于这两个方程添加另一条对应男性的线。
- en: Although this plot might look like two separate simple linear model fits, one
    for each level of sex, it’s important to recognize that isn’t the case. You’re
    effectively looking at a representation of a multivariate model on a two-dimensional
    canvas, where the statistics that determine the fit of the two visible lines have
    been estimated “jointly,” in other words, when considering both predictors.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管这个图看起来像是两个独立的简单线性模型拟合，每个模型针对性别的一个水平，但重要的是要认识到事实并非如此。你实际上是在二维画布上查看多元模型的表示，其中决定这两条可见线拟合的统计量是“联合”估算的，换句话说，是在考虑两个预测变量的情况下估算的。
- en: '![image](../images/f21-01.jpg)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f21-01.jpg)'
- en: '*Figure 21-1: Visualizing the observed data and fitted multiple linear model
    of student height modeled by handspan and sex*'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '*图21-1：可视化观测数据和由手掌宽度及性别建模的学生身高的拟合多元线性模型*'
- en: '***21.3.4 Finding Confidence Intervals***'
  id: totrans-89
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***21.3.4 计算置信区间***'
- en: 'As in [Chapter 20](ch20.xhtml#ch20), you can easily find confidence intervals
    for any of the regression parameters in multiple regression models with `confint`.
    Using `survmult2`, the object of the fitted model for student height including
    the smoking frequency predictor, the output of a call to `confint` looks like
    this:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 如同[第20章](ch20.xhtml#ch20)中所述，你可以通过`confint`轻松找到任何回归参数的置信区间，在多元回归模型中，使用`survmult2`，即包含吸烟频率预测变量的学生身高拟合模型的对象，调用`confint`后的输出如下所示：
- en: '[PRE8]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Note that the `Wr.Hnd` and `SexMale` variables were shown to be statistically
    significant at the 5 percent level in the earlier model summary and that their
    95 percent confidence levels do not include the null value of zero. On the other
    hand, all the coefficients for the dummy variables associated with the smoking
    frequency predictor are all nonsignificant, and their confidence intervals clearly
    include zero. This reflects the fact that the smoking variable isn’t, as a whole,
    considered statistically significant in this particular model.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，在之前的模型总结中，`Wr.Hnd`和`SexMale`变量在5%的显著性水平下被证明是统计显著的，并且它们的95%置信区间不包括零值。另一方面，与吸烟频率预测变量相关的所有虚拟变量的系数都是不显著的，并且它们的置信区间明显包含零。这反映了吸烟变量在该模型中整体上不被认为是统计显著的。
- en: '***21.3.5 Omnibus F-Test***'
  id: totrans-93
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***21.3.5 总体F检验***'
- en: 'First encountered in [Section 20.5.2](ch20.xhtml#ch20lev2sec186) in the context
    of multilevel predictors, you can think of the omnibus *F*-test more generally
    for multiple regression models as a test with the following hypotheses:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第20.5.2节](ch20.xhtml#ch20lev2sec186)首次介绍过的多级预测变量的上下文中，你可以更一般地将总体*F*-检验应用于多元回归模型，作为一个包含以下假设的检验：
- en: '![image](../images/e21-5.jpg)'
  id: totrans-95
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e21-5.jpg)'
- en: 'The test is effectively comparing the amount of error attributed to the “null”
    model (in other words, one with an intercept only) with the amount of error attributed
    to the predictors when all the predictors are present. In other words, the more
    the predictors are able to model the response, the more error they explain, giving
    you a more extreme *F* statistic and therefore a smaller *p*-value. The single
    result makes the test especially useful when you have many explanatory variables.
    The test works the same regardless of the mix of predictors you have in a given
    model: one or more might be continuous, discrete, binary, and/or categorical with
    *k* > 2 levels. When multiple regression models are fitted, the amount of output
    alone can take time to digest and interpret, and care must be taken to avoid Type
    I errors (incorrect rejection of a true null hypothesis—refer to [Section 18.5](ch18.xhtml#ch18lev1sec58)).'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 该检验实际上是在比较“零”模型（换句话说，只有截距的模型）所归因的误差与在所有预测变量都存在时，预测变量所归因的误差。换句话说，预测变量能够更好地拟合响应变量时，解释的误差更多，从而得到更极端的
    *F* 统计量，因此 *p*-值更小。这个单一的结果使得当你有多个解释变量时，该检验尤其有用。无论你在给定模型中有多少种预测变量组合，检验方式都是相同的：一个或多个可能是连续的、离散的、二元的和/或具有
    *k* > 2 水平的分类变量。当拟合多个回归模型时，仅输出量的大小就可能需要时间来消化和解释，并且必须小心避免第一类错误（错误地拒绝真实的零假设—参见 [第18.5节](ch18.xhtml#ch18lev1sec58)）。
- en: 'The *F*-test helps boil all that down, allowing you to conclude either of the
    following:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '*F* 检验有助于简化这一过程，使你能够得出以下结论之一：'
- en: Evidence against H[0] if the associated *p*-value is smaller than your chosen
    significance level *α*, which suggests that your regression—your combination of
    the explanatory variables—does a significantly better job of predicting the response
    than if you removed *all* those predictors.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果相关的 *p*-值小于你选择的显著性水平 *α*，则反对 H[0] 的证据，这表明你的回归模型——你对解释变量的组合——在预测响应变量方面显著优于如果去掉
    *所有* 这些预测变量时的模型。
- en: No evidence against H[0] if the associated *p*-value is larger than *α*, which
    suggests that using the predictors has no tangible benefit over having an intercept
    alone.
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果相关的 *p*-值大于 *α*，则没有反对 H[0] 的证据，这表明使用预测变量相比单独使用截距并没有明显的好处。
- en: The downside is that the test doesn’t tell you which of the predictors (or which
    subset thereof) is having a beneficial impact on the fit of the model, nor does
    it tell you anything about their coefficients or respective standard errors.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 缺点是，检验并不能告诉你哪些预测变量（或哪些子集）对模型拟合产生了有益的影响，也无法告诉你它们的系数或各自的标准误。
- en: You can compute the *F*-test statistic using the coefficient of determination,
    *R*², from the fitted regression model. Let *p* be the number of regression parameters
    requiring estimation, excluding the intercept *β*[0]. Then,
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用拟合回归模型中的决定系数 *R*² 来计算 *F* 检验统计量。令 *p* 为需要估计的回归参数个数，排除截距 *β*[0]。然后，
- en: '![image](../images/e21-6.jpg)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/e21-6.jpg)'
- en: where *n* is the number of observations used in fitting the model (after records
    with missing values have been deleted). Then, under H[0] in (21.5), ![image](../images/f.jpg)
    follows an *F* distribution (see [Section 16.2.5](ch16.xhtml#ch16lev2sec145) and
    also [Section 19.1.2](ch19.xhtml#ch19lev2sec169)) with df[1] = *p*, df[2] = *n*−
    *p*−1 degrees of freedom. The *p*-value associated with (21.6) is yielded as the
    upper-tail area of that *F* distribution.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 *n* 是用于拟合模型的观测值数量（在删除了缺失值记录后）。然后，在 H[0] 假设下，如公式 (21.5) 所示，![image](../images/f.jpg)
    服从 *F* 分布（见 [第16.2.5节](ch16.xhtml#ch16lev2sec145)，以及 [第19.1.2节](ch19.xhtml#ch19lev2sec169)），其自由度为
    df[1] = *p*，df[2] = *n*− *p*−1。与公式 (21.6) 相关的 *p*-值是该 *F* 分布上尾区域的面积。
- en: As a quick exercise to confirm this, turn your attention back to the fitted
    multiple regression model `survmult2` in [Section 21.3.1](ch21.xhtml#ch21lev2sec193),
    which is the model for student height by handspan, sex, and smoking status from
    `survey`. You can extract the coefficient of multiple determination from the `summary`
    report (using the technique noted in [Section 20.3.4](ch20.xhtml#ch20lev2sec180)).
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 作为一个快速练习来确认这一点，回到在 [第21.3.1节](ch21.xhtml#ch21lev2sec193) 中拟合的多元回归模型 `survmult2`，这是基于
    `survey` 数据集中的手掌跨度、性别和吸烟状态来预测学生身高的模型。你可以从 `summary` 报告中提取多重决定系数（使用 [第20.3.4节](ch20.xhtml#ch20lev2sec180)
    中提到的技术）。
- en: '[PRE9]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: This matches the multiple R-squared value from [Section 21.3.1](ch21.xhtml#ch21lev2sec193).
    Then, you can get *n* as the original size of the data set in `survey` minus any
    missing values (reported as 30 in the earlier `summary` output).
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 这与[第21.3.1节](ch21.xhtml#ch21lev2sec193)中的多个R平方值相匹配。然后，你可以得到*n*，即`survey`数据集的原始大小减去任何缺失值（在之前的`summary`输出中报告为30）。
- en: '[PRE10]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: You get *p* as the number of estimated regression parameters (minus 1 for the
    intercept).
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 你得到*p*，即估计的回归参数的数量（减去1用于截距）。
- en: '[PRE11]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'You can then confirm the value of *n* − *p* − 1, which matches the `summary`
    output (`201 degrees of freedom`):'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，你可以确认*n* − *p* − 1的值，这与`summary`输出中的值相匹配（`201自由度`）：
- en: '[PRE12]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Finally, you find the test statistic ![image](../images/f.jpg) as dictated
    by (21.6), and you can use the `pf` function as follows to obtain the corresponding
    *p*-value for the test:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，你可以根据（21.6）找到检验统计量 ![image](../images/f.jpg)，并且你可以按如下方式使用`pf`函数来获得该检验的相应*p*-值：
- en: '[PRE13]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: You can see that the omnibus *F*-test for this example gives a *p*-value that’s
    so small, it’s effectively zero. These calculations match the relevant results
    reported in the output of `summary(survmult2)` completely.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以看到，这个例子的全局*F*-检验给出的*p*-值非常小，几乎为零。这些计算结果与`summary(survmult2)`输出中报告的相关结果完全一致。
- en: 'Looking back at the student height multiple regression fit based on handspan,
    sex, and smoking in `survmult2` in [Section 21.3.1](ch21.xhtml#ch21lev2sec193),
    it’s little surprise that with two of the predictors yielding small *p*-values,
    the omnibus *F*-test suggests strong evidence against H[0] based on (21.5). This
    highlights the “umbrella” nature of the omnibus test: although the smoking frequency
    variable itself doesn’t appear to contribute anything statistically important,
    the *F*-test for that model still suggests `survmult2` should be preferred over
    a “no-predictor” model, because both handspan and sex are important.'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 回顾基于手掌跨度、性别和吸烟情况的学生身高多重回归拟合（在`survmult2`中）[第21.3.1节](ch21.xhtml#ch21lev2sec193)，不难理解，两个预测变量的*p*-值较小，而全局*F*-检验基于（21.5）表明强烈反对H[0]的证据。这突出了全局检验的“伞形”特性：尽管吸烟频率变量本身似乎没有显著的统计贡献，但该模型的*F*-检验仍然表明，`survmult2`应该优于“不含预测变量”的模型，因为手掌跨度和性别都是重要的。
- en: '***21.3.6 Predicting from a Multiple Linear Model***'
  id: totrans-116
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***21.3.6 从多重线性模型进行预测***'
- en: Prediction (or *forecasting*) for multiple regression follows the same rules
    as for simple regression. It’s important to remember that point predictions found
    for a particular *covariate profile*—the collection of predictor values for a
    given individual—are associated with the mean (or *expected value*) of the response;
    that confidence intervals provide measures for mean responses; and that prediction
    intervals provide measures for raw observations. You also have to consider the
    issue of interpolation (predictions based on *x* values that fall within the range
    of the originally observed covariate data) versus extrapolation (prediction from
    *x* values that fall outside the range of said data). Other than that, the R syntax
    for `predict` is identical to that used in [Section 20.4](ch20.xhtml#ch20lev1sec65).
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 多重回归的预测（或*预测*）遵循与简单回归相同的规则。重要的是要记住，为特定*协变量特征*（给定个体的预测变量值的集合）找到的点预测是与响应的均值（或*期望值*）相关联的；置信区间提供均值响应的度量；而预测区间提供原始观察值的度量。你还必须考虑插值（基于*
    x *值的预测，这些值落在原始观察到的协变量数据的范围内）与外推（基于* x *值的预测，这些值超出了该数据的范围）的问题。除此之外，`predict`的R语法与[第20.4节](ch20.xhtml#ch20lev1sec65)中使用的完全相同。
- en: As an example, using the model fitted on student height as a linear function
    of handspan and sex (in `survmult`), you can estimate the mean height of a male
    student with a writing handspan of 16.5 cm, together with a confidence interval.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，使用在`survmult`中将学生身高拟合为手掌跨度和性别的线性函数的模型，你可以估计一位手掌跨度为16.5厘米的男性学生的平均身高，并给出置信区间。
- en: '[PRE14]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: The result indicates that you have an expected value of about 173.48 cm and
    that you can be 95 percent confident the true value lies somewhere between 170.94
    and 176.03 (rounded to 2 d.p.). In the same way, the mean height of a female with
    a handspan of 13 cm is estimated at 158.42 cm, with a 99 percent prediction interval
    of 139.76 to 177.07.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 结果表明，你的期望值约为173.48厘米，且你可以95%的置信度确认真实值介于170.94和176.03之间（四舍五入到小数点后两位）。同样，手掌跨度为13厘米的女性的平均身高估计为158.42厘米，99%的预测区间为139.76到177.07。
- en: '[PRE15]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: There are in fact two female students in the data set with writing handspans
    of 13 cm, as you can see in [Figure 21-1](ch21.xhtml#ch21fig1). Using your knowledge
    of subsetting data frames, you can inspect these two records and select the three
    variables of interest.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集中实际上有两名雌性学生的手掌跨度为13厘米，如[图21-1](ch21.xhtml#ch21fig1)所示。通过你对数据框子集操作的知识，你可以检查这两条记录，并选择三种感兴趣的变量。
- en: '[PRE16]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Now, the second female’s height falls well inside the prediction interval, but
    the first female’s height is significantly higher than the upper limit. It’s important
    to realize that, technically, nothing has gone wrong here in terms of the model
    fitting and interpretation—it’s still possible that an observation can fall outside
    a prediction interval, even a wide 99 percent interval, though it’s perhaps improbable.
    There could be any number of reasons for this occurring. First, the model could
    be inadequate. For example, you might be excluding important predictors in the
    fitted model and therefore have less predictive power. Second, although the prediction
    is within the range of the observed data, it has occurred at one extreme end of
    the range, where it’s less reliable because your data are relatively sparse. Third,
    the observation itself may be tainted in some way—perhaps the individual recorded
    her handspan incorrectly, in which case her invalid observation should be removed
    prior to model fitting. It’s with this critical eye that a good statistician will
    appraise data and models; this is a skill that I’ll emphasize further as this
    chapter unfolds.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，第二只雌性猫的身高落在预测区间内，但第一只雌性猫的身高显著高于上限。重要的是要意识到，从技术上讲，模型拟合和解释上并没有出错——尽管不太可能，但观察值可能会落在预测区间外，甚至是一个宽广的99%区间内。这种情况可能有许多原因。首先，模型可能不足。例如，你可能在拟合的模型中排除了重要的预测变量，从而使得预测能力较差。其次，尽管预测值在观察数据的范围内，但它发生在这个范围的极端端点，那里数据相对稀疏，因此预测值的可靠性较差。第三，观察值本身可能以某种方式受到污染——也许个体在记录手掌跨度时不准确，在这种情况下，她的不有效观察应在模型拟合前被移除。正是以这种批判性的眼光，一个优秀的统计学家会评估数据和模型；这是我将在本章中进一步强调的技能。
- en: '**Exercise 21.1**'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: '**练习21.1**'
- en: In the `MASS` package, you’ll find the data frame `cats`, which provides data
    on sex, body weight (in kilograms), and heart weight (in grams) for 144 household
    cats (see [Venables and Ripley, 2002](ref.xhtml#ref69), for further details);
    you can read the documentation with a call to `?cats`. Load the `MASS` package
    with a call to `library("MASS")`, and access the object directly by entering `cats`
    at the console prompt.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 在`MASS`包中，你会找到数据框`cats`，它提供了144只家猫的性别、体重（以千克为单位）和心脏重量（以克为单位）数据（有关更多详细信息，请参见[Venables
    and Ripley, 2002](ref.xhtml#ref69)）；你可以通过调用`?cats`来阅读文档。使用`library("MASS")`加载`MASS`包，并通过在控制台提示符下输入`cats`来直接访问该对象。
- en: Plot heart weight on the vertical axis and body weight on the horizontal axis,
    using different colors or point characters to distinguish between male and female
    cats. Annotate your plot with a legend and appropriate axis labels.
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将心脏重量绘制在纵轴上，将体重绘制在横轴上，使用不同的颜色或点字符来区分雄性和雌性猫。在图表上加上图例和适当的轴标签。
- en: Fit a least-squares multiple linear regression model using heart weight as the
    response variable and the other two variables as predictors, and view a model
    summary.
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用心脏重量作为响应变量，其他两个变量作为预测变量，拟合一个最小二乘多元线性回归模型，并查看模型摘要。
- en: Write down the equation for the fitted model and interpret the estimated regression
    coefficients for body weight and sex. Are both statistically significant? What
    does this say about the relationship between the response and predictors?
  id: totrans-129
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 写下拟合模型的方程，并解释体重和性别的回归系数估计值。这两个系数是否具有统计显著性？这说明响应变量和预测变量之间的关系如何？
- en: Report and interpret the coefficient of determination and the outcome of the
    omnibus *F*-test.
  id: totrans-130
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 报告并解释决定系数和整体*F*检验的结果。
- en: Tilman’s cat, Sigma, is a 3.4 kg female. Use your model to estimate her mean
    heart weight and provide a 95 percent prediction interval.
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Tilman的猫，Sigma，是一只体重3.4千克的雌性猫。使用你的模型来估计她的平均心脏重量，并提供一个95%的预测区间。
- en: Use `predict` to superimpose continuous lines based on the fitted linear model
    on your plot from (a), one for male cats and one for female. What do you notice?
    Does this reflect the statistical significance (or lack thereof) of the parameter
    estimates?
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`predict`根据拟合的线性模型，在你从（a）部分绘制的图表上叠加连续的线条，分别为雄性猫和雌性猫绘制。你注意到什么？这是否反映了参数估计的统计显著性（或缺乏统计显著性）？
- en: The `boot` package ([Davison and Hinkley, 1997](ref.xhtml#ref16); [Canty and
    Ripley, 2015](ref.xhtml#ref09)) is another library of R code that’s included with
    the standard installation but isn’t automatically loaded. Load `boot` with a call
    to `library("boot")`. You’ll find a data frame called `nuclear`, which contains
    data on the construction of nuclear power plants in the United States in the late
    1960s ([Cox and Snell, 1981](ref.xhtml#ref14)).
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: '`boot`包（[Davison 和 Hinkley, 1997](ref.xhtml#ref16); [Canty 和 Ripley, 2015](ref.xhtml#ref09)）是另一个与标准安装一起提供的R语言库，但不会自动加载。使用`library("boot")`来加载`boot`。你将找到一个名为`nuclear`的数据框，它包含关于1960年代末美国核电厂建设的数据（[Cox
    和 Snell, 1981](ref.xhtml#ref14)）。'
- en: Access the documentation by entering `?nuclear` at the prompt and examine the
    details of the variables. (Note there is a mistake for `date`, which provides
    the date that the construction permits were issued—it should read “measured in
    years since January 1 **1900** to the nearest month.”) Use `pairs` to produce
    a quick scatterplot matrix of the data.
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过在提示符下输入`?nuclear`访问文档，并检查变量的详细信息。（请注意，`date`存在一个错误，它提供了建筑许可证颁发的日期——它应该写为“自**1900年1月1日**以来的年份，取整到最近的月份。”）使用`pairs`生成数据的快速散点图矩阵。
- en: One of the original objectives was to predict the cost of further construction
    of these power plants. Create a fit and summary of a linear regression model that
    aims to model `cost` by `t1` and `t2`, two variables that describe different elapsed
    times associated with the application for and issue of various permits. Take note
    of the estimated regression coefficients and their significance in the fitted
    model.
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 原始目标之一是预测这些电厂进一步建设的成本。创建一个线性回归模型并总结，模型旨在通过`t1`和`t2`这两个描述申请和颁发各种许可证时所经历的不同时间的变量来建模`cost`。注意拟合模型中估计的回归系数及其显著性。
- en: Refit the model, but this time also include an effect for the date the construction
    permit was issued. Contrast the output for this new model against the previous
    one. What do you notice, and what does this information suggest about the relationships
    in the data with respect to these predictors?
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重新拟合模型，但这次还要考虑建筑许可证颁发日期的影响。将这个新模型的输出与之前的模型进行对比。你注意到了什么？这些信息表明了关于这些预测变量的数据关系？
- en: Fit a third model for power plant cost, using the predictors for “date of permit
    issue,” “power plant capacity,” and the binary variable describing whether the
    plant was sited in the northeastern United States. Write down the fitted model
    equation and provide 95 percent confidence intervals for each estimated coefficient.
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为电厂成本拟合第三个模型，使用“许可证颁发日期”、“电厂容量”和描述电厂是否位于美国东北部的二元变量作为预测变量。写出拟合模型方程，并为每个估计的系数提供95%的置信区间。
- en: The following table gives an excerpt of a historical data set compiled between
    1961 and 1973\. It concerns the annual murder rate in Detroit, Michigan; the data
    were originally presented and analyzed by Fisher ([1976](ref.xhtml#ref23)) and
    are reproduced here from Harraway ([1995](ref.xhtml#ref30)). In the data set you’ll
    find the number of murders, police officers, and gun licenses issued per 100,000
    population, as well as the overall unemployment rate as a percentage of the overall
    population.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格给出了1961年到1973年间汇编的历史数据的摘录。它涉及密歇根州底特律的年谋杀率；这些数据最初由Fisher（[1976](ref.xhtml#ref23)）提出并分析，现由Harraway（[1995](ref.xhtml#ref30)）在此处重现。在数据集中，你将找到每10万人中谋杀人数、警察人数和发放的枪支许可证数量，以及整体失业率占总人口的百分比。
- en: '| **Murders** | **Police** | **Unemployment** | **Guns** |'
  id: totrans-139
  prefs: []
  type: TYPE_TB
  zh: '| **谋杀** | **警察** | **失业率** | **枪支** |'
- en: '| --- | --- | --- | --- |'
  id: totrans-140
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| 8.60 | 260.35 | 11.0 | 178.15 |'
  id: totrans-141
  prefs: []
  type: TYPE_TB
  zh: '| 8.60 | 260.35 | 11.0 | 178.15 |'
- en: '| 8.90 | 269.80 | 7.0 | 156.41 |'
  id: totrans-142
  prefs: []
  type: TYPE_TB
  zh: '| 8.90 | 269.80 | 7.0 | 156.41 |'
- en: '| 8.52 | 272.04 | 5.2 | 198.02 |'
  id: totrans-143
  prefs: []
  type: TYPE_TB
  zh: '| 8.52 | 272.04 | 5.2 | 198.02 |'
- en: '| 8.89 | 272.96 | 4.3 | 222.10 |'
  id: totrans-144
  prefs: []
  type: TYPE_TB
  zh: '| 8.89 | 272.96 | 4.3 | 222.10 |'
- en: '| 13.07 | 272.51 | 3.5 | 301.92 |'
  id: totrans-145
  prefs: []
  type: TYPE_TB
  zh: '| 13.07 | 272.51 | 3.5 | 301.92 |'
- en: '| 14.57 | 261.34 | 3.2 | 391.22 |'
  id: totrans-146
  prefs: []
  type: TYPE_TB
  zh: '| 14.57 | 261.34 | 3.2 | 391.22 |'
- en: '| 21.36 | 268.89 | 4.1 | 665.56 |'
  id: totrans-147
  prefs: []
  type: TYPE_TB
  zh: '| 21.36 | 268.89 | 4.1 | 665.56 |'
- en: '| 28.03 | 295.99 | 3.9 | 1131.21 |'
  id: totrans-148
  prefs: []
  type: TYPE_TB
  zh: '| 28.03 | 295.99 | 3.9 | 1131.21 |'
- en: '| 31.49 | 319.87 | 3.6 | 837.60 |'
  id: totrans-149
  prefs: []
  type: TYPE_TB
  zh: '| 31.49 | 319.87 | 3.6 | 837.60 |'
- en: '| 37.39 | 341.43 | 7.1 | 794.90 |'
  id: totrans-150
  prefs: []
  type: TYPE_TB
  zh: '| 37.39 | 341.43 | 7.1 | 794.90 |'
- en: '| 46.26 | 356.59 | 8.4 | 817.74 |'
  id: totrans-151
  prefs: []
  type: TYPE_TB
  zh: '| 46.26 | 356.59 | 8.4 | 817.74 |'
- en: '| 47.24 | 376.69 | 7.7 | 583.17 |'
  id: totrans-152
  prefs: []
  type: TYPE_TB
  zh: '| 47.24 | 376.69 | 7.7 | 583.17 |'
- en: '| 52.33 | 390.19 | 6.3 | 709.59 |'
  id: totrans-153
  prefs: []
  type: TYPE_TB
  zh: '| 52.33 | 390.19 | 6.3 | 709.59 |'
- en: Create your own data frame in your R workspace and produce a scatterplot matrix.
    Which of the variables appears to be most strongly related to the murder rate?
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在R工作区中创建自己的数据框，并生成散点图矩阵。哪些变量似乎与谋杀率最强相关？
- en: Fit a multiple linear regression model using the number of murders as the response
    and all other variables as predictors. Write down the model equation and interpret
    the coefficients. Is it reasonable to state that all relationships between the
    response and the predictors are causal?
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用谋杀案件数作为响应变量，其他所有变量作为预测变量，拟合一个多元线性回归模型。写下模型方程并解释系数。是否可以合理地说，响应变量和预测变量之间的所有关系都是因果关系？
- en: Identify the amount of variation in the response attributed to the joint effect
    of the three explanatory variables. Then refit the model excluding the predictor
    associated with the largest (in other words, “most nonsignificant”) *p*-value.
    Compare the new coefficient of determination with that of the previous model.
    Is there much difference?
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定响应中由于三种解释变量的联合作用而产生的变化量。然后重新拟合模型，排除与最大（换句话说，“最不显著”）*p*值相关的预测变量。将新模型的决定系数与之前模型的决定系数进行比较。差异大吗？
- en: Use your model from (k) to predict the mean number of murders per 100,000 residents,
    with 300 police officers and 500 issued gun licenses. Compare this to the mean
    response if there were no gun licenses issued and provide 99 percent confidence
    intervals for both predictions.
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用(k)中的模型预测每10万人中谋杀案件的平均数量，假设有300名警察和500个发放的枪支许可证。将其与没有发放枪支许可证时的平均响应进行比较，并为两种预测提供99%的置信区间。
- en: '**21.4 Transforming Numeric Variables**'
  id: totrans-158
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**21.4 数值变量的转换**'
- en: Sometimes, the linear function as strictly defined by the standard regression
    equation, (21.1), can be inadequate when it comes to capturing relationships between
    a response and selected covariates. You might, for example, observe curvature
    in a scatterplot between two numeric variables to which a perfectly straight line
    isn’t necessarily best suited. To a certain extent, the requirement that your
    data exhibit such linear behavior in order for a linear regression model to be
    appropriate can be relaxed by simply transforming (typically in a nonlinear fashion)
    certain variables before any estimation or model fitting takes place.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，严格按照标准回归方程(21.1)定义的线性函数在捕捉响应与选择的协变量之间的关系时可能不足。例如，您可能会在两个数值变量之间的散点图中观察到曲线性，而完美的直线不一定是最佳拟合。某种程度上，可以通过在估计或模型拟合之前简单地对某些变量进行转换（通常是非线性转换）来放宽要求，即数据必须表现出线性行为，才能使线性回归模型适用。
- en: '*Numeric transformation* refers to the application of a mathematical function
    to your numeric observations in order to rescale them. Finding the square root
    of a number and converting a temperature from Fahrenheit to Celsius are both examples
    of a numeric transformation. In the context of regression, transformation is generally
    applied only to continuous variables and can be done in any number of ways. In
    this section, you’ll limit your attention to examples using the two most common
    approaches: *polynomial* and *logarithmic* transformations. However, note that
    the appropriateness of the methods used to transform variables, and any modeling
    benefits that might occur, can only really be considered on a case-by-case basis.'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '*数值转换*是指对数值观察值应用数学函数以便重新缩放它们。求一个数的平方根和将温度从华氏度转换为摄氏度都是数值转换的例子。在回归分析中，转换通常仅适用于连续变量，并且可以通过多种方式进行。在本节中，您将重点关注使用两种最常见方法的示例：*多项式*和*对数*转换。然而，请注意，所使用的转换变量方法是否适当，以及可能出现的建模优势，必须根据具体情况逐一评估。'
- en: Transformation in general doesn’t represent a universal solution to solving
    problems of nonlinearity in the trends in your data, but it can at least improve
    how faithfully a linear model is able to represent those trends.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 转换通常并不是解决数据趋势中非线性问题的普遍解决方案，但它至少可以改善线性模型对这些趋势的拟合程度。
- en: '***21.4.1 Polynomial***'
  id: totrans-162
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***21.4.1 多项式***'
- en: Following on from a comment made earlier, let’s say you observe a curved relationship
    in your data such that a straight line isn’t a sensible choice for modeling it.
    In an effort to fit your data more closely, a polynomial or *power* transformation
    can be applied to a specific predictor variable in your regression model. This
    is a straightforward technique that, by allowing *polynomial curvature* in the
    relationships, allows changes in that predictor to influence the response in more
    complex ways than otherwise possible. You achieve this by including additional
    terms in the model definition that represent the impact of progressively higher
    powers of the variable of interest on the response.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 继续前面提到的一个评论，假设你在数据中观察到一种曲线关系，这样一条直线就不再是合适的建模选择。为了更精确地拟合你的数据，可以对回归模型中的特定预测变量应用多项式或*幂次*变换。这是一种简单的技术，通过在关系中允许*多项式曲率*，使得该预测变量的变化能够以比通常更复杂的方式影响响应。你通过在模型定义中添加额外的项来实现这一点，这些项表示变量的更高次幂对响应的影响。
- en: 'To clarify the concept of polynomial curvature, consider the following sequence
    between −4 and 4, as well as the simple vectors computed from it:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更清晰地阐述多项式曲率的概念，考虑以下在−4到4之间的序列，以及由此计算出的简单向量：
- en: '[PRE17]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Here, you’re taking the original value of `x` and calculating specific functionals
    of it. The vector `y`, as a copy of `x`, is clearly linear (in technical terms,
    this is a “polynomial of order 1”). You assign `y2` to take on an additionally
    squared valued of `x`, providing *quadratic* behavior—a polynomial of order 2\.
    Lastly, the vector `y3` represents the results of a *cubic* function of the values
    of `x`, with the inclusion of `x` raised to the power of 3—a polynomial of order
    3.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，你需要对原始的`x`值进行特定函数运算。向量`y`作为`x`的副本，显然是线性的（从技术角度来看，这是“1阶多项式”）。你将`y2`赋值为`x`的平方，从而提供*二次*行为——2阶多项式。最后，向量`y3`表示`x`的*立方*函数的结果，其中包括`x`的3次方——3阶多项式。
- en: The following three lines of code produce, separately, the plots from left to
    right in [Figure 21-2](ch21.xhtml#ch21fig2).
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 以下三行代码分别生成[图21-2](ch21.xhtml#ch21fig2)中从左到右的图示。
- en: '[PRE18]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '![image](../images/f21-02.jpg)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f21-02.jpg)'
- en: '*Figure 21-2: Illustrating linear (left), quadratic (middle), and cubic functions
    (right) of* `x`'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '*图21-2：展示`x`的线性（左）、二次（中）和立方（右）函数*'
- en: Perhaps a bit more generally, let’s say you have data for a continuous predictor,
    *X*, that you want to use to model your response, *Y* . Following estimation in
    the usual way, linearly, the simple model is ![image](../images/f0503-01.jpg);
    a quadratic trend in *X* can be modeled via the multiple regression ![image](../images/f0503-02.jpg);
    a cubic relationship can be captured by ![image](../images/f0503-03.jpg); and
    so on. From the plots in [Figure 21-2](ch21.xhtml#ch21fig2), a good way to interpret
    the effects of including these extra terms is in the complexity of the curves
    that can be captured. At order 1, the linear relationship allows no curvature.
    At order 2, a quadratic function of any given variable allows one “bend.” At order
    3, the model can cope with two bends in the relationship, and this continues if
    you keep adding terms corresponding to increasing powers of the covariate. The
    regression coefficients associated with these terms (all implied to be 1 in the
    code that produced the previous plots) are able to control the specific appearance
    (in other words, the *strength* and *direction*) of the curvature.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 更普遍地说，假设你有一个连续预测变量*X*的数据，你希望用它来建模响应*Y*。按通常的方式线性估计，简单模型是 ![image](../images/f0503-01.jpg)；*X*的二次趋势可以通过多元回归
    ![image](../images/f0503-02.jpg) 来建模；立方关系可以通过 ![image](../images/f0503-03.jpg)
    捕捉；依此类推。从[图21-2](ch21.xhtml#ch21fig2)的图示中，可以很好地解释包括这些额外项的效果，即可以捕捉到的曲线的复杂度。在1阶时，线性关系不允许曲率；在2阶时，任何给定变量的二次函数允许一个“弯曲”；在3阶时，模型可以处理关系中的两个弯曲，继续添加对应于协变量更高次幂的项时，情况会如此继续。这些项相关的回归系数（在生成前述图表的代码中，所有回归系数都被假设为1）能够控制曲率的具体表现（换句话说，控制曲率的*强度*和*方向*）。
- en: '**Fitting a Polynomial Transformation**'
  id: totrans-172
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**拟合多项式变换**'
- en: Return your attention to the built-in `mtcars` data set. Consider the `disp`
    variable, which describes engine displacement volume in cubic inches, against
    a response variable of miles per gallon. If you examine a plot of the data in
    [Figure 21-3](ch21.xhtml#ch21fig3), you can see that there does appear to be a
    slight yet noticeable curve in the relationship between displacement and mileage.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 将注意力转回内置的`mtcars`数据集。考虑描述发动机排量（单位：立方英寸）的`disp`变量，并与响应变量（每加仑英里数）进行比较。如果你查看[图
    21-3](ch21.xhtml#ch21fig3)中的数据图，可以看到排量与里程之间的关系确实存在一个轻微但明显的曲线。
- en: '[PRE19]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '![image](../images/f21-03.jpg)'
  id: totrans-175
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f21-03.jpg)'
- en: '*Figure 21-3: Scatterplot of miles per gallon and engine displacement, for
    the* `mtcars` *data*'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 21-3：`mtcars`数据集中的每加仑英里数与发动机排量的散点图*'
- en: Is the straight line that a simple linear regression model would provide really
    the best way to represent this relationship? To investigate this, start by fitting
    that basic linear setup.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 简单线性回归模型提供的直线真的能最好地表示这种关系吗？为了调查这一点，首先拟合那个基础的线性模型。
- en: '[PRE20]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: This clearly indicates statistical evidence of a negative linear impact of displacement
    on mileage—for each additional cubic inch of displacement, the mean response decreases
    by about 0.041 miles per gallon.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 这清晰地表明排量对里程的负线性影响的统计证据——每增加一个立方英寸的排量，平均响应下降约0.041英里每加仑。
- en: 'Now, try to capture the apparent curve in the data by adding a quadratic term
    in `disp` to the model. You can do this in two ways. First, you could create a
    new vector in the workspace by simply squaring the `mtcars$disp` vector and then
    supplying the result to the formula in `lm`. Second, you could specify `disp^2`
    directly as an additive term in the formula. If you do it this way, it’s essential
    to wrap that particular expression in a call to `I` as follows:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，尝试通过在模型中添加`disp`的二次项来捕捉数据中的明显曲线。你可以通过两种方式实现这一点。首先，你可以通过简单地对`mtcars$disp`向量进行平方运算，创建一个新的向量并将结果提供给`lm`函数中的公式。其次，你可以直接在公式中将`disp^2`作为一个加法项指定。如果你选择这种方法，必须将该表达式包裹在`I`函数调用中，如下所示：
- en: '[PRE21]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Use of the `I` function around a given term in the formula is necessary when
    said term requires an arithmetic calculation—in this case, `disp^2`—before the
    model itself is actually fitted.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 当公式中的某一项需要进行算术计算时——在本例中是`disp^2`——才需要使用`I`函数对该项进行包裹，才能在模型拟合之前进行计算。
- en: Turning to the fitted multiple regression model itself, you can see that the
    contribution of the squared component is statistically significant—the output
    corresponding to `I(disp^2)` shows a *p*-value of 0.0031\. This implies that even
    if a linear trend is taken into account, the model that includes a quadratic component
    (which introduces a curve) is a better-fitting model. This conclusion is supported
    by a noticeably higher coefficient of determination compared to the first fit
    (0.7927 against 0.7183). You can see the fit of this quadratic curve in [Figure
    21-4](ch21.xhtml#ch21fig4) (code for which follows shortly).
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 回到拟合后的多元回归模型本身，可以看到平方项的贡献具有统计学显著性——对应于`I(disp^2)`的输出显示*p*-值为0.0031。这意味着，即使考虑了线性趋势，包含二次项（引入曲线）的模型也更适合拟合数据。这个结论得到了明显更高的决定系数支持（0.7927对比0.7183）。你可以在[图
    21-4](ch21.xhtml#ch21fig4)中看到这个二次曲线的拟合效果（相关代码稍后展示）。
- en: 'Here you might reasonably wonder whether you can improve the ability of the
    model to capture the relationship further by adding yet another higher-order term
    in the covariate of interest. To that end:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，你可能会合理地想知道，通过在相关变量中再添加一个更高阶项，是否能进一步提高模型捕捉关系的能力。为此：
- en: '[PRE22]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: The output shows that a cubic component also offers a statistically significant
    contribution. However, if you were to continue adding higher-order terms, you’d
    find that fitting a polynomial of order 4 to these data isn’t able to improve
    the fit at all, with several coefficients being rendered nonsignificant (the order
    4 fit isn’t shown).
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 输出结果显示，三次项同样提供了统计学显著的贡献。然而，如果你继续添加更高阶的项，你会发现拟合一个四阶多项式并不能改善拟合效果，几个系数被判定为不显著（四阶拟合结果未显示）。
- en: So, letting ŷ be miles per gallon and *x* be displacement in cubic inches, and
    expanding the e-notation from the previous output, the fitted multiple regression
    model is
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，设ŷ为每加仑英里数，*x*为排量（单位：立方英寸），并扩展前述输出中的科学计数法，拟合后的多元回归模型为
- en: ŷ = 50.7 − 0.3372*x* + 0.0011*x*² − 0.000001*x*³,
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: ŷ = 50.7 − 0.3372*x* + 0.0011*x*² − 0.000001*x*³，
- en: which is precisely what the order 3 line in the left panel of [Figure 21-4](ch21.xhtml#ch21fig4)
    reflects.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 这正是[图 21-4](ch21.xhtml#ch21fig4)左侧面板中3阶曲线所反映的内容。
- en: '**Plotting the Polynomial Fit**'
  id: totrans-190
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**绘制多项式拟合**'
- en: 'To address the plot itself, you visualize the data and the first (simple linear)
    model in `car.order1` in the usual way. To begin [Figure 21-4](ch21.xhtml#ch21fig4),
    execute the following code:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 要展示图表本身，你可以按常规方式可视化数据和`car.order1`中的第一个（简单线性）模型。首先，执行以下代码以开始[图 21-4](ch21.xhtml#ch21fig4)：
- en: '[PRE23]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '![image](../images/f21-04.jpg)'
  id: totrans-193
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f21-04.jpg)'
- en: '*Figure 21-4: Three different models, polynomials of orders 1, 2, and 3, fitted
    to the “mileage per displacement” relationship from the* `mtcars` *data set. Left:
    Visible plot limits constrained to the data. Right: Visible plot limits widened
    considerably to illustrate unreliability in extrapolation.*'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 21-4：三种不同的模型，1、2、3阶多项式，拟合“每单位排量的里程”关系，数据来自*`mtcars`*数据集。左：可视化图表的限制仅限于数据。右：可视化图表的限制大幅扩展，以说明外推的可靠性不足。*'
- en: It’s a little more difficult to add the line corresponding to either of the
    polynomial-termed models since `abline` is equipped to handle only straight-line
    trends. One way to do this is to make use of `predict` for each value in a sequence
    that represents the desired values of the explanatory variable. (I favor this
    approach because it also allows you to simultaneously calculate confidence and
    prediction bands if you want.) To add the line for the order 2 model only, first
    create the required sequence over the observed range of `disp`.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 添加与任何多项式模型对应的线条要稍微困难一些，因为`abline`只能处理直线趋势。实现这一点的一种方法是使用`predict`，对代表期望解释变量值的序列中的每个值进行预测。（我更倾向于这种方法，因为它还允许你同时计算置信区间和预测区间，如果你愿意的话。）要仅为2阶模型添加线条，首先要在观察到的`disp`范围内创建所需的序列。
- en: '[PRE24]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Here, the sequence has been widened a little by minus and plus 50 to predict
    a small amount on either side of the scope of the original covariate data, so
    the curve meets the edges of the graph. Then you make the prediction itself and
    superimpose the fitted line.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，序列通过减去和加上50来稍微扩大，以预测原始协变量数据范围两侧的少量值，因此曲线会接触到图表的边缘。然后进行预测，并将拟合线叠加上去。
- en: '[PRE25]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: You use the same technique, followed by the final addition of the legend, for
    the order 3 polynomial.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 对于3阶多项式，你使用相同的技术，接着最后添加图例。
- en: '[PRE26]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: The result of all this is on the left panel of [Figure 21-4](ch21.xhtml#ch21fig4).
    Even though you’ve used raw data from only one covariate, `disp`, the example
    illustrated here is considered multiple regression because more than one parameter
    (in addition to the universal intercept *β*[0]) required estimation in the order
    2 and 3 models.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 所有这些的结果都显示在[图 21-4](ch21.xhtml#ch21fig4)的左面板上。即使你只使用了来自单一协变量`disp`的原始数据，这里所展示的示例也被认为是多元回归，因为在2阶和3阶模型中，除了普遍的截距*β*[0]外，还需要估计多个参数。
- en: The different types of trend lines fitted to the mileage and displacement data
    clearly show different interpretations of the relationship. Visually, you could
    reasonably argue that the simple linear fit is inadequate at modeling the relationship
    between response and predictor, but it’s harder to come to a clear conclusion
    when choosing between the order 2 and order 3 versions. The order 2 fit captures
    the curve that tapers off as `disp` increases; the order 3 fit additionally allows
    for a bump (in technical terms a *saddle* or *inflection*), followed by a steeper
    downward trend in the same domain.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 对于里程和排量数据所拟合的不同类型趋势线，清楚地展示了对关系的不同解释。从视觉上来看，你可以合理地认为，简单线性拟合不足以建模响应变量与预测变量之间的关系，但当选择2阶和3阶版本时，得出明确结论就更困难。2阶拟合捕捉到了随着`disp`增加而逐渐变缓的曲线；3阶拟合则额外考虑了一个凸起（在技术术语中为*鞍点*或*拐点*），随后在相同范围内出现更陡的下降趋势。
- en: So, which model is “best”? In this case, the statistical significance of the
    parameters suggests that the order 3 model should be preferred. Having said that,
    there are other things to consider when choosing between different models, which
    you’ll think about more carefully in [Section 22.2](ch22.xhtml#ch22lev1sec73).
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，哪个模型是“最优”的呢？在这种情况下，参数的统计显著性表明应该优先选择3阶模型。话虽如此，在选择不同模型时还有其他因素需要考虑，这些你将在[第22.2节](ch22.xhtml#ch22lev1sec73)中更仔细地思考。
- en: '**Pitfalls of Polynomials**'
  id: totrans-204
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**多项式的陷阱**'
- en: One particular drawback associated with polynomial terms in linear regression
    models is the instability of the fitted trend when trying to perform any kind
    of extrapolation. The right plot in [Figure 21-4](ch21.xhtml#ch21fig4) shows the
    same three fitted models (MPG by displacement), but this time with a much wider
    scale for displacement. As you can see, the validity of these models is questionable.
    Though the order 2 and 3 models fit MPG acceptably within the range of the observed
    data, if you move even slightly outside the maximum threshold of observed displacement
    values, the predictions of the mean mileage go wildly off course. The order 2
    model in particular becomes completely nonsensical, suggesting a rapid improvement
    in MPG once the engine displacement rises over 500 cubic inches. You must keep
    this natural mathematical behavior of polynomial functions in mind if you’re considering
    using higher-order terms in your regression models.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
- en: To create this plot, the same code that created the left plot can be used; you
    simply use `xlim` to widen the *x*-axis range and define the `disp.seq` object
    to a correspondingly wider sequence (in this case, I just set `xlim=c(10,1000)`
    with matching `from` and `to` limits in the creation of `disp.seq`).
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
- en: '**NOTE**'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
- en: '*Models like this are still referred to as* linear *regression models, which
    might seem a bit confusing since the fitted trends for higher-order polynomials
    are clearly nonlinear. This is because* linear regression *refers to the fact
    that the function defining the mean response is linear in terms of the regression
    parameters* *β*[0], *β*[1], . . ., [*β*p]*. As such, any transformation applied
    to individual variables doesn’t affect the linearity of the function with respect
    to the coefficients themselves.*'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
- en: '***21.4.2 Logarithmic***'
  id: totrans-209
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: In statistical modeling situations where you have positive numeric observations,
    it’s common to perform a log transformation of the data to dramatically reduce
    the overall range of the data and bring extreme observations closer to a measure
    of centrality. In that sense, transforming to a logarithmic scale can help reduce
    the severity of heavily skewed data (see [Section 15.2.4](ch15.xhtml#ch15lev2sec136)).
    In the context of regression modeling, log transformations can be used to capture
    trends where apparent curves “flatten off,” without the same kind of instability
    outside the range of the observed data that you saw with some of the polynomials.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
- en: If you need to refresh your memory on logarithms, turn back to [Section 2.1.2](ch02.xhtml#ch02lev2sec18);
    it suffices here to note that the logarithm is the power to which you must raise
    a base value in order to obtain an *x* value. For example, in 3⁵ = 243, the logarithm
    is 5 and 3 is the base, expressed as log[3] 243 = 5\. Because of the ubiquity
    of the exponential function in common probability distributions, statisticians
    almost exclusively work with the natural log (logarithm to the base *e*). From
    here, assume all mentions of the log transformation refer to the natural log.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你需要复习对数的相关知识，可以回到[第2.1.2节](ch02.xhtml#ch02lev2sec18)；这里只需注意，对数是必须将基数提升到某个幂次才能得到*x*值。例如，3⁵
    = 243时，对数是5，3是基数，表示为log[3] 243 = 5。由于指数函数在常见概率分布中的普遍存在，统计学家几乎专门使用自然对数（以*e*为底的对数）。从这里开始，假设所有提到的对数转换都指的是自然对数。
- en: 'To briefly illustrate the typical behavior of the log transformation, take
    a look at [Figure 21-5](ch21.xhtml#ch21fig5), achieved with the following:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 简要说明对数转换的典型行为，请查看[图21-5](ch21.xhtml#ch21fig5)，该图通过以下方式实现：
- en: '[PRE27]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: This plots the log of the integers 1 to 1000 against the raw values, as well
    as plotting the negative log. You can see the way in which the log-transformed
    values taper off and flatten out as the raw values increase.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 这张图绘制了1到1000的整数的对数与原始值的关系，并且还绘制了负对数。你可以看到，对数转换后的值随着原始值的增加逐渐趋于平缓。
- en: '![image](../images/f21-05.jpg)'
  id: totrans-215
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f21-05.jpg)'
- en: '*Figure 21-5: The log function applied to integers 1 to 1000*'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: '*图21-5：应用于1到1000的整数的对数函数*'
- en: '**Fitting the Log Transformation**'
  id: totrans-217
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**拟合对数转换**'
- en: As noted, one use of the log transformation in regression is to allow this kind
    of curvature in situations when a perfectly straight line doesn’t suit the observed
    relationship. For an illustration, return to the `mtcars` examples and consider
    mileage as a function of both horsepower and transmission type (variables `hp`
    and `am`, respectively). Create a scatterplot of MPG against horsepower, with
    different colors distinguishing between automatic and manual cars.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，在回归分析中，使用对数转换的一种情况是当完美的直线不适合观察到的关系时，用来处理这种曲线性。为了说明这一点，回到`mtcars`的示例，考虑将里程作为马力和变速器类型（变量`hp`和`am`）的函数。创建一个散点图，显示MPG与马力的关系，用不同的颜色区分自动挡车和手动挡车。
- en: '[PRE28]'
  id: totrans-219
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: The plotted points shown in [Figure 21-6](ch21.xhtml#ch21fig6) suggest that
    curved trends in horsepower may be more appropriate than straight-line relationships.
    Note that you have to explicitly coerce the binary numeric `mtcars$am` vector
    to a factor here in order to use it as a selector for the vector of two colors.
    You’ll add the lines in after fitting the linear model.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: '[图21-6](ch21.xhtml#ch21fig6)中显示的绘制点表明，马力的曲线趋势可能比直线关系更为合适。请注意，你需要明确地将二进制数字型的`mtcars$am`向量强制转换为因子，以便将其用作两种颜色的向量选择器。你将在拟合线性模型后添加这些线。'
- en: '![image](../images/f21-06.jpg)'
  id: totrans-221
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f21-06.jpg)'
- en: '*Figure 21-6: Scatterplot of MPG on horsepower, split by transmission type,
    with lines corresponding to a multiple linear regression using a log-scaled effect
    of horsepower superimposed*'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: '*图21-6：根据变速器类型分割的MPG与马力的散点图，线条表示使用对数尺度马力效应的多元线性回归的结果*'
- en: Let’s do so using the log transformation of horsepower to try to capture the
    curved relationship. Since, in this example, you also want to account for the
    potential of transmission type to affect the response, this is included as an
    additional predictor variable as usual.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们使用马力的对数转换来尝试捕捉曲线关系。因为在这个例子中，你还想考虑变速器类型可能对响应产生的影响，所以按照惯例，这将作为一个额外的预测变量进行包含。
- en: '[PRE29]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: The output indicates jointly statistically significant effects of both log-horsepower
    and transmission type on mileage. Keeping transmission constant, the mean MPG
    drops by around 9.24 for each additional unit of log-horsepower. Having a manual
    transmission increases the mean MPG by roughly 4.2 (estimated in this order owing
    to the coding of `am`—`0` for automatic, `1` for manual; see `?mtcars`). The coefficient
    of determination shows 82.7 percent of the variation in the response is explained
    by this regression, suggesting a satisfactory fit.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 输出结果表明，马力对数和变速器类型对里程的影响在统计上显著。保持变速器类型不变时，马力对数每增加一个单位，平均MPG将下降大约9.24。手动变速器使得平均MPG增加约4.2（根据`am`的编码顺序来估计——`0`表示自动挡，`1`表示手动挡；参见`?mtcars`）。决定系数表明，该回归解释了响应变量82.7%的变异，表明拟合情况令人满意。
- en: '**Plotting the Log Transformation Fit**'
  id: totrans-226
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '**绘制对数变换拟合图**'
- en: To visualize the fitted model, you first need to calculate the fitted values
    for all desired predictor values. The following code creates a sequence of horsepower
    values (minus and plus 20 horsepower) and performs the required prediction for
    both transmission types.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 为了可视化拟合模型，你首先需要计算所有所需预测值的拟合值。以下代码创建了一系列马力值（增加和减少20马力），并对两种变速器类型执行所需的预测。
- en: '[PRE30]'
  id: totrans-228
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: In the above code, since you want to plot predictions for both possible values
    of `am`, when using `newdata` you need to replicate `hp.seq` twice. Then, when
    you provide values for `am` to `newdata`, one series of `hp.seq` is paired with
    an appropriately replicated `am` value of `0`, the other with `1`. The result
    of this is a vector of predictions of length twice that of `hp.seq`, `car.log.pred`,
    with the first `n` elements corresponding to automatic cars and the latter `n`
    to manuals.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 在上述代码中，由于你想绘制`am`的两种可能值的预测，当使用`newdata`时，你需要将`hp.seq`重复两次。然后，当你将`am`的值提供给`newdata`时，一组`hp.seq`与适当复制的`am`值0配对，另一组与值1配对。结果是一个预测向量，其长度是`hp.seq`的两倍，`car.log.pred`，前`n`个元素对应自动挡汽车，后`n`个元素对应手动挡汽车。
- en: 'Now you can add these lines to [Figure 21-6](ch21.xhtml#ch21fig6) with the
    following:'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你可以将这些线添加到[图 21-6](ch21.xhtml#ch21fig6)，如下所示：
- en: '[PRE31]'
  id: totrans-231
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: By examining the scatterplot, you can see that the fitted model appears to do
    a good job of estimating the joint relationship between horsepower/transmission
    and MPG. The statistical significance of transmission type in this model directly
    affects the difference between the two added lines. If `am` weren’t significant,
    the lines would be closer together; in that case, the model would be suggesting
    that one curve would be sufficient to capture the relationship. As usual, extrapolation
    too far outside the range of the observed predictor data isn’t a great idea, though
    it’s less unstable for log-transformed trends than for polynomial functions.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 通过检查散点图，你可以看到拟合模型似乎很好地估计了马力/变速器与MPG之间的联合关系。变速器类型在此模型中的统计显著性直接影响两条新增线之间的差异。如果`am`不显著，两条线会更接近；在这种情况下，模型会建议使用一条曲线就足以捕捉这种关系。像往常一样，将预测数据外推得过远并不是一个好主意，尽管对于对数变换趋势来说，它比多项式函数外推要稳定一些。
- en: '***21.4.3 Other Transformations***'
  id: totrans-233
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***21.4.3 其他变换***'
- en: Transformation can involve more than one variable of the data set and isn’t
    limited to just predictor variables either. In their original investigation into
    the `mtcars` data, Henderson and Velleman ([1981](ref.xhtml#ref32)) also noted
    the presence of the same curved relationships you’ve uncovered between the response
    and variables such as horsepower and displacement. They argued that it’s preferable
    to use gallons per mile (GPM) instead of MPG as the response variable to improve
    linearity. This would involve modeling a transformation of MPG, namely, that GPM
    = 1/MPG.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 变换可以涉及数据集中的多个变量，并且不仅限于预测变量。在他们对`mtcars`数据的原始研究中，Henderson 和 Velleman（[1981](ref.xhtml#ref32)）也注意到，你在响应变量与如马力和排量等变量之间发现的曲线关系。他们认为，使用每加仑英里数（GPM）作为响应变量，而非每加仑英里数（MPG），更能改善线性关系。这将涉及对MPG进行变换，即GPM
    = 1/MPG。
- en: The authors also commented on the limited influence that both horsepower and
    displacement have on GPM if the weight of the car is included in a fitted model,
    because of the relatively high correlations present among these three predictors
    (known as *multicollinearity*). To address this, the authors created a new predictor
    variable calculated as horsepower divided by weight. This measures, in their words,
    how “overpowered” a car is—and they proceeded to use that new predictor instead
    of horsepower or displacement alone. This is just some of the experimentation
    that took place in the search for an appropriate way to model these data.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 作者们还评论了当将汽车重量纳入拟合模型时，马力和排量对每加仑英里数（GPM）的影响有限，因为这三个预测变量之间存在相对较高的相关性（这被称为*多重共线性*）。为了解决这个问题，作者们创建了一个新的预测变量，即马力除以重量。他们用这个变量来衡量汽车的“过度动力”，并用这个新变量代替了单独的马力或排量。这只是他们在寻找适合的建模方法过程中进行的一些实验。
- en: To this end, however you choose to model your own data, the objective of transforming
    numeric variables should always be to fit a valid model that represents the data
    and the relationships more realistically and accurately. When reaching for this
    goal, there’s plenty of freedom in how you can transform numeric observations
    in applications of regression methods. For a further discussion on transformations
    in linear regression, [Chapter 7](ch07.xhtml#ch07) of Faraway ([2005](ref.xhtml#ref21))
    provides an informative introduction.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 为了实现这个目标，无论你选择以何种方式建模自己的数据，转化数值变量的目标应始终是拟合一个有效的模型，能够更真实、准确地表示数据和变量之间的关系。在追求这个目标时，你在回归方法的应用中如何转化数值观测值有很大的自由度。关于线性回归中转化的进一步讨论，请参考Faraway（[2005](ref.xhtml#ref21)）的第七章（[Chapter
    7](ch07.xhtml#ch07)），该章节提供了一个有益的介绍。
- en: '**Exercise 21.2**'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: '**练习 21.2**'
- en: The following table presents data collected in one of Galileo’s famous “ball”
    experiments, in which he rolled a ball down a ramp of different heights and measured
    how far it traveled from the base of the ramp. For more on this and other interesting
    examples, look at “Teaching Statistics with Data of Historic Significance” by
    Dickey and Arnold ([1995](ref.xhtml#ref17)).
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格展示了伽利略在其著名的“球体”实验中收集的数据，在这些实验中，他将一个球从不同高度的坡道上滚下，并测量球从坡道底部滚出的距离。有关更多信息以及其他有趣的例子，请查阅Dickey和Arnold的《用具有历史意义的数据教学统计学》（[1995](ref.xhtml#ref17)）。
- en: '| **Initial height** | **Distance** |'
  id: totrans-239
  prefs: []
  type: TYPE_TB
  zh: '| **初始身高** | **距离** |'
- en: '| --- | --- |'
  id: totrans-240
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| 1000 | 573 |'
  id: totrans-241
  prefs: []
  type: TYPE_TB
  zh: '| 1000 | 573 |'
- en: '| 800 | 534 |'
  id: totrans-242
  prefs: []
  type: TYPE_TB
  zh: '| 800 | 534 |'
- en: '| 600 | 495 |'
  id: totrans-243
  prefs: []
  type: TYPE_TB
  zh: '| 600 | 495 |'
- en: '| 450 | 451 |'
  id: totrans-244
  prefs: []
  type: TYPE_TB
  zh: '| 450 | 451 |'
- en: '| 300 | 395 |'
  id: totrans-245
  prefs: []
  type: TYPE_TB
  zh: '| 300 | 395 |'
- en: '| 200 | 337 |'
  id: totrans-246
  prefs: []
  type: TYPE_TB
  zh: '| 200 | 337 |'
- en: '| 100 | 253 |'
  id: totrans-247
  prefs: []
  type: TYPE_TB
  zh: '| 100 | 253 |'
- en: Create a data frame in R based on this table and plot the data points with distance
    on the *y*-axis.
  id: totrans-248
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在R中创建一个数据框架，基于此表格绘制数据点，距离放在*Y*-轴上。
- en: Galileo believed there was a quadratic relationship between initial height and
    the distance traveled.
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 伽利略认为初始身高和行进距离之间存在二次关系。
- en: Fit an order 2 polynomial in height, with distance as the response.
  id: totrans-250
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以身高为自变量，拟合一个二次多项式，距离作为因变量。
- en: Fit a cubic (order 3) and a quartic (order 4) model for these data. What do
    they tell you about the nature of the relationship?
  id: totrans-251
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对这些数据拟合一个三次（3阶）模型和一个四次（4阶）模型。它们告诉你关于关系性质的什么信息？
- en: Based on your models from (b), choose the one that you think best represents
    the data and plot the fitted line on the raw data. Add 90 percent confidence bands
    for mean distance traveled to the plot.
  id: totrans-252
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基于你在（b）部分建立的模型，选择你认为最能代表数据的模型，并将拟合线绘制到原始数据上。为图表添加90%的置信带，表示平均行进距离的置信区间。
- en: The contributed R package `faraway` contains a large number of data sets that
    accompany a linear regression textbook by Faraway ([2005](ref.xhtml#ref21)). Install
    the package and then call `library("faraway")` to load it. One of the data sets
    is `trees`, which provides data on the dimensions of felled trees of a certain
    type (see, for example, [Atkinson, 1985](ref.xhtml#ref04)).
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: '`faraway`贡献的R包包含大量数据集，配合Faraway的线性回归教材（[2005](ref.xhtml#ref21)）使用。安装该包后，调用`library("faraway")`加载它。该数据包中的一个数据集是`trees`，提供了某一类型被砍伐的树木的尺寸数据（例如，参见[Atkinson,
    1985](ref.xhtml#ref04)））。'
- en: Access the data object at the prompt and plot volume against girth (the latter
    along the *x*-axis).
  id: totrans-254
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在提示符下访问数据对象并绘制体积与胸围的关系（胸围放在*X*-轴上）。
- en: 'Fit two models with `Volume` as the response: one quadratic model in `Girth`
    and the other based on log transformations of both `Volume` and `Girth`. Write
    down the model equations for each and comment on the similarity (or difference)
    of the fits in terms of the coefficient of determination and the omnibus *F*-test.'
  id: totrans-255
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以`体积`为因变量，拟合两个模型：一个是`胸围`的二次模型，另一个是`体积`和`胸围`的对数变换模型。写出每个模型的方程，并评论两者在决定系数和全局*F*-检验方面的拟合相似性（或差异）。
- en: Use `predict` to add lines to the plot from (d) for each of the two models from
    (e). Use different line types; add a corresponding legend. Also include 95 percent
    prediction intervals, with line types matching those of the fitted values (note
    that for the model that involves log transformation of the response and the predictor,
    any returned values from `predict` will themselves be on the log scale; you have
    to back-transform these to the original scale using `exp` before the lines for
    that model can be superimposed). Comment on the respective fits and their estimated
    prediction intervals.
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `predict` 向 (d) 中的图表添加两种模型（来自 (e)）的线条。使用不同的线型；添加相应的图例。还应包括 95% 的预测区间，线型与拟合值的线型一致（注意，对于涉及响应变量和预测变量对数转换的模型，`predict`
    返回的值本身会是对数尺度的；你必须使用 `exp` 对这些值进行反向转换，才能将该模型的线条叠加到图表上）。对各自的拟合效果及其估计的预测区间进行评论。
- en: Lastly, turn your attention back to the `mtcars` data frame.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，将注意力转回到 `mtcars` 数据框。
- en: Fit and summarize a multiple linear regression model to determine mean MPG from
    horsepower, weight, and displacement.
  id: totrans-258
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 拟合并总结一个多元线性回归模型，用于根据马力、重量和排量来预测平均 MPG。
- en: In the spirit of Henderson and Velleman ([1981](ref.xhtml#ref32)), use `I` to
    refit the model in (g) in terms of GPM = 1/MPG. Which model explains a greater
    amount of variation in the response?
  id: totrans-259
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 参考 Henderson 和 Velleman（[1981](ref.xhtml#ref32)）的精神，使用 `I` 重新拟合 (g) 中的模型，以 GPM
    = 1/MPG 作为目标。哪个模型解释了响应变量中更多的变异？
- en: '**21.5 Interactive Terms**'
  id: totrans-260
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**21.5 交互项**'
- en: So far, you’ve looked only at the joint main effects of how predictors affect
    the outcome variable (and one-to-one transformations thereof). Now you’ll look
    at interactions between covariates. An *interactive effect* between predictors
    is an additional change to the response that occurs at particular combinations
    of the predictors. In other words, an interactive effect is present if, for a
    given covariate profile, the values of the predictors are such that they produce
    an effect that augments the stand-alone main effects associated with those predictors.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，你只看了预测变量如何影响结果变量的联合主效应（以及其一对一的转换）。现在，你将查看协变量之间的交互作用。预测变量之间的*交互效应*是对响应变量的额外变化，这种变化发生在特定的预测变量组合下。换句话说，如果对于给定的协变量配置，预测变量的值使得它们产生的效应会增强这些预测变量本身的独立主效应，那么就存在交互效应。
- en: '***21.5.1 Concept and Motivation***'
  id: totrans-262
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***21.5.1 概念与动机***'
- en: Diagrams such as those found in [Figure 21-7](ch21.xhtml#ch21fig7) are often
    used to help explain the concept of interactive effects. These diagrams show your
    mean response value, ŷ, on the vertical axis, as usual, and a predictor value
    for the variable *x[1]* on the horizontal axis. They also show a binary categorical
    variable *x*[2], which can be either zero or one. These hypothetical variables
    are labeled as such in the images.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 如[图 21-7](ch21.xhtml#ch21fig7)所示的图表，通常用于帮助解释交互效应的概念。这些图表如通常一样，展示了纵轴上的平均响应值 ŷ，以及横轴上变量
    *x[1]* 的预测值。它们还展示了一个二元分类变量 *x*[2]，其值可以是零或一。这些假设变量在图中被标记为这样。
- en: '![image](../images/f21-07.jpg)'
  id: totrans-264
  prefs: []
  type: TYPE_IMG
  zh: '![image](../images/f21-07.jpg)'
- en: '*Figure 21-7: Concept of an interactive effect between two predictors x*[1]
    *and x*[2]*, on the mean response value* ŷ*. Left: Only main effects of x*[1]
    *and x[2]* *influence* ŷ*. Right: An interaction between x*[1] *and x[2]* *is
    needed in addition to their main effects in order to model* ŷ.'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 21-7：两个预测变量 x*[1] *和 x*[2]* 之间的交互效应概念，对平均响应值*ŷ*的影响*。左图：仅有 x*[1]* 和 x[2]*
    的主效应*影响* ŷ*。右图：需要 x*[1]* 和 x[2]* 的交互效应，除了它们的主效应之外，以便对 ŷ 进行建模。'
- en: The left diagram shows the limit of the models you’ve considered so far in this
    chapter—that both *x[1]* and *x[2]* affect ŷ independently of each other. The
    right diagram, however, clearly shows that the effect of *x[1]* on ŷ changes completely
    depending on the value of *x*[2]. On the left, only main effects of *x[1]* and
    *x[2]* are needed to determine ŷ; on the right, main effects *and* an interactive
    effect between *x[1]* and *x[2]* are present.
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 左图展示了你在本章中迄今为止考虑的模型的限制——即 *x[1]* 和 *x[2]* 独立地影响 ŷ。而右图则清楚地显示，*x[1]* 对 ŷ 的影响完全取决于
    *x[2]* 的值。在左图中，仅需 *x[1]* 和 *x[2]* 的主效应来确定 ŷ；而在右图中，除了主效应外，还需要 *x[1]* 和 *x[2]* 之间的交互效应。
- en: '**NOTE**'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**'
- en: '*When estimating regression models, you always have to accompany interactions
    with the main effects of the relevant predictors, for reasons of interpretability.
    Since interactions are themselves best understood as an augmentation of the main
    effects, it makes no sense to remove the latter and leave in the former.*'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: '*在估计回归模型时，您总是需要将交互作用与相关预测变量的主效应一起考虑，这是出于可解释性的原因。由于交互作用本身最好理解为主效应的增强，因此没有意义去删除主效应而保留交互作用。*'
- en: For a good example of an interaction, think about pharmacology. Interactive
    effects between medicines are relatively common, which is why health care professionals
    often ask about other medicines you might be taking. Consider statins—drugs commonly
    used to reduce cholesterol. Users of statins are told to avoid grapefruit juice
    because it contains natural chemical compounds that inhibit the efficacy of the
    enzyme responsible for the correct metabolization of the drug. If an individual
    is taking statins and not consuming grapefruit, you would expect a negative relationship
    between cholesterol level and statin use (think about “statin use” either as a
    continuous or as a categorical dosage variable)—as statin use increases or is
    affirmative, the cholesterol level decreases. On the other hand, for an individual
    on statins who *is* consuming grapefruit, the nature of the relationship between
    cholesterol level and statin use could easily be different—weakened negative,
    neutral, or even positive. If so, since the effect of the statins on cholesterol
    changes according to the value of another variable—whether or not grapefruit is
    consumed—this would be considered an interaction between those two predictors.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 一个好的交互作用例子可以参考药理学。药物之间的交互效应是相对常见的，这也是为什么医疗专业人员通常会询问您可能正在服用的其他药物。考虑他汀类药物——一种常用于降低胆固醇的药物。服用他汀类药物的人被告知避免饮用葡萄柚汁，因为葡萄柚汁含有天然化学成分，能够抑制负责药物正确代谢的酶的效能。如果一个人正在服用他汀类药物并且没有饮用葡萄柚汁，您会预期胆固醇水平与他汀使用之间存在负相关关系（无论是将“他汀使用”视为连续变量还是分类剂量变量）——随着他汀使用量的增加或肯定，胆固醇水平下降。另一方面，对于那些正在服用他汀类药物并且*正在*饮用葡萄柚的人，胆固醇水平与他汀使用之间的关系可能完全不同——可能是负相关减弱、无关或甚至正相关。如果是这样，由于他汀对胆固醇的影响会根据另一个变量（是否饮用葡萄柚）的值而发生变化，这就被视为这两个预测变量之间的交互作用。
- en: Interactions can occur between categorical variables, numeric variables, or
    both. It’s most common to find *two-way* interactions—interactions between exactly
    two predictors—which is what you’ll focus on in [Sections 21.5.2](ch21.xhtml#ch21lev2sec203)
    to [21.5.4](ch21.xhtml#ch21lev2sec205). Three-way and higher-order interactive
    effects are technically possible but less common, partly because they are difficult
    to interpret in a real-world context. You’ll consider an example of these in [Section
    21.5.5](ch21.xhtml#ch21lev2sec206).
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 交互作用可以发生在分类变量、数值变量或两者之间。最常见的是*二元*交互作用——即恰好两个预测变量之间的交互作用，这也是您在[第21.5.2节](ch21.xhtml#ch21lev2sec203)到[第21.5.4节](ch21.xhtml#ch21lev2sec205)中将重点讨论的内容。三元及更高阶的交互效应在技术上是可能的，但较少见，部分原因是它们在实际应用中较难解释。您将在[第21.5.5节](ch21.xhtml#ch21lev2sec206)中考虑这些例子的情况。
- en: '***21.5.2 One Categorical, One Continuous***'
  id: totrans-271
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***21.5.2 一个分类变量，一个连续变量***'
- en: Generally, a two-way interaction between a categorical and a continuous predictor
    should be understood as effecting a change in the slope of the continuous predictor
    with respect to the nonreference levels of the categorical predictor. In the presence
    of a term for the continuous variable, a categorical variable with *k* levels
    will have *k* − 1 main effect terms, so there will be a further *k* − 1 interactive
    terms between all the alternative levels of the categorical variable and the continuous
    variable.
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，分类变量和连续变量之间的二元交互作用应该被理解为影响连续变量相对于分类变量非参考水平的斜率变化。在连续变量项存在的情况下，具有*k*个水平的分类变量将有*k*
    − 1个主效应项，因此将有*k* − 1个交互项，表示分类变量的所有替代水平与连续变量之间的交互作用。
- en: The different slopes for *x[1]* by category of *x[2]* for ŷ can be seen clearly
    on the right of [Figure 21-7](ch21.xhtml#ch21fig7). In such a situation, in addition
    to the main effects for *x[1]* and *x*[2], there would be one interactive term
    in the fitted model corresponding to *x[2]* = 1\. This defines the additive term
    needed to change the slope in *x[1]* for *x[2]* = 0 to the new slope in *x[1]*
    for *x[2]* = 1.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
- en: 'For an example, let’s access a new data set. In [Exercise 21.2](ch21.xhtml#ch21exc2),
    you looked at the `faraway` package ([Faraway, 2005](ref.xhtml#ref21)) to access
    the `trees` data. In this package, you’ll also find the `diabetes` object—a cardiovascular
    disease data set detailing characteristics of 403 African Americans (originally
    investigated and reported in [Schorling et al., 1997](ref.xhtml#ref59); [Willems
    et al., 1997](ref.xhtml#ref76)). Install `faraway` if you haven’t already and
    load it with `library("faraway")`. Restrict your attention to the total cholesterol
    level (`chol`—continuous), age of the individual (`age`—continuous), and body
    frame type (`frame`—categorical with *k* = 3 levels: `"small"` as the reference
    level, `"medium"`, and `"large"`). You can see the data in [Figure 21-8](ch21.xhtml#ch21fig8),
    which will be created momentarily.'
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
- en: You’ll look at modeling total cholesterol by age and body frame. It seems logical
    to expect that cholesterol is related to both age and body type, so it makes sense
    to also consider the possibility that the effect of age on cholesterol is different
    for individuals of different body frames. To investigate, let’s fit the multiple
    linear regression and include a two-way interaction between the two variables.
    In the call to `lm`, you specify the main effects first, using `+` as usual, and
    then specify an interactive effect of two predictors by using a colon (`:`) between
    them.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE32]'
  id: totrans-276
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: Inspecting the estimated model parameters in the output, you can see a main
    effect coefficient for `age`, main effect coefficients for the two levels of `frame`
    (that aren’t the reference level), and two further terms for the interactive effect
    of `age` with those same nonreference levels.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
- en: '**NOTE**'
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
- en: '*There’s actually a shortcut to doing this in R—the* cross-factor *notation.
    The same model shown previously could have been fitted by using* `chol~age*frame`
    *in* `lm`*; the symbol* `*` *between two variables in a formula should be interpreted
    as “include an intercept, all main effects, and the interaction.” I’ll use this
    shortcut from now on.*'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
- en: The output shows the significance of `age` and some evidence to support the
    presence of a main effect of `frame`. There’s also slight indication of significance
    of the interaction, though it’s weak. Assessing significance in this case, where
    one predictor is categorical with *k* > 2 levels, follows the same rule as noted
    in the discussion of multilevel variables in [Section 20.5.2](ch20.xhtml#ch20lev2sec186)—if
    at least one of the coefficients is significant, the entire effect should be deemed
    significant.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
- en: The general equation for the fitted model can be written down directly from
    the output.
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/e21-7.jpg)'
  id: totrans-282
  prefs: []
  type: TYPE_IMG
- en: I’ve used a colon (:) to denote the interactive terms to mirror the R output.
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
- en: For the reference level of the categorical predictor, body type “small,” the
    fitted model can be written down straight from the output.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
- en: “Mean total cholesterol” = 155.9636 + 0.9852 × “age”
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
- en: For a model with the main effects only, changing body type to “medium” or “large”
    would affect only the intercept—you know from [Section 20.5](ch20.xhtml#ch20lev1sec66)
    that the relevant effect is simply added to the outcome. The presence of the interaction,
    however, means that *in addition* to the change in the intercept, the main effect
    slope of `age` must now also be changed according to the relevant interactive
    term. For an individual with a “medium” frame, the model is
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
- en: '| “Mean total cholesterol” | = | 155.9636 + 0.9852 × “age” + 28.6051 − 0.3514
    × “age” |'
  id: totrans-287
  prefs: []
  type: TYPE_TB
- en: '|  | = | 184.5687 + (0.9852 − 0.3514) × “age” |'
  id: totrans-288
  prefs: []
  type: TYPE_TB
- en: '|  | = | 184.5687 + 0.6338 × “age” |'
  id: totrans-289
  prefs: []
  type: TYPE_TB
- en: and for an individual with a “large” frame, the model is
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
- en: '| “Mean total cholesterol” | = | 155.9636 + 0.9852 × “age” + 44.9474 − 0.8511
    × “age” |'
  id: totrans-291
  prefs: []
  type: TYPE_TB
- en: '|  | = | 200.911 + (0.9852 − 0.8511) × “age” |'
  id: totrans-292
  prefs: []
  type: TYPE_TB
- en: '|  | = | 200.911 + 0.1341 × “age” |'
  id: totrans-293
  prefs: []
  type: TYPE_TB
- en: 'You can easily calculate these in R by accessing the coefficients of the fitted
    model object:'
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE33]'
  id: totrans-295
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: Next, let’s sum the relevant components of this vector. Once you have the sums,
    you’ll be able to plot the fitted model.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE34]'
  id: totrans-297
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: The three lines are stored as numeric vectors of length 2, with the intercept
    first and the slope second. This is the form required by the optional `coef` argument
    of `abline`, which allows you to superimpose these straight lines on a plot of
    the raw data. The following code produces [Figure 21-8](ch21.xhtml#ch21fig8).
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE35]'
  id: totrans-299
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: '![image](../images/f21-08.jpg)'
  id: totrans-300
  prefs: []
  type: TYPE_IMG
- en: '*Figure 21-8: Fitted linear model, main effects, and interaction for mean total
    cholesterol by age and body frame*'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
- en: If you examine the fitted model in [Figure 21-8](ch21.xhtml#ch21fig8), it’s
    clear that inclusion of an interaction between age and body frame has allowed
    more flexibility in the way mean total cholesterol relates to the two predictors.
    The nonparallel nature of the three plotted lines reflects the concept illustrated
    in [Figure 21-7](ch21.xhtml#ch21fig7).
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
- en: I walked through this to illustrate how the concept works, but in practice you
    don’t need to go through all of these steps to find the point estimates (and any
    associated confidence intervals). You can predict from a fitted linear model with
    interactions in the same way as for main-effect-only models through the use of
    `predict`.
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
- en: '***21.5.3 Two Categorical***'
  id: totrans-304
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: You met the concept of interactions between two categorical explanatory variables
    in the introduction to two-way ANOVA in [Section 19.2](ch19.xhtml#ch19lev1sec60).
    There, you uncovered evidence of an interactive effect of wool type and tension
    on the mean number of warp breaks in lengths of yarn (based on the ready-to-use
    `warpbreaks` data frame). You then visualized the interaction with an interaction
    plot ([Figure 19-2](ch19.xhtml#ch19fig2) on [page 447](ch19.xhtml#page_447)),
    not unlike the diagrams in [Figure 21-7](ch21.xhtml#ch21fig7).
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
- en: Let’s implement the same model as the last `warpbreaks` example in [Section
    19.2.2](ch19.xhtml#ch19lev2sec172) in an explicit linear regression format.
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE36]'
  id: totrans-307
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: Here I’ve used the cross-factor symbol `*`, rather than `wool + tension + wool:tension`.
    When both predictors in a two-way interaction are categorical, there will be a
    term for each nonreference level of the first predictor combined with all nonreference
    levels of the second predictor. In this example, `wool` is binary with only *k*
    = 2 levels and `tension` has *k* = 3; therefore, the only interaction terms present
    are the “medium” (`M`) and “high” (`H`) tension levels (“low”, `L`, is the reference
    level) with wool type `B` (`A` is the reference level). Therefore, altogether
    in the fitted model, there are terms for `B`, `M`, `H`, `B:M`, and `B:H`.
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
- en: These results provide the same conclusion as the ANOVA analysis—there is indeed
    statistical evidence of an interactive effect between wool type and tension on
    mean breaks, on top of the contributing main effects of those predictors.
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
- en: The general fitted model can be understood as
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
- en: '| “Mean warp breaks” | = | 44.556 − 16.333 × “wool type B” |'
  id: totrans-311
  prefs: []
  type: TYPE_TB
- en: '|  |  | − 20.556 × “medium tension” |'
  id: totrans-312
  prefs: []
  type: TYPE_TB
- en: '|  |  | − 20.000 × “high tension” |'
  id: totrans-313
  prefs: []
  type: TYPE_TB
- en: '|  |  | + 21.111 × “wool type B : medium tension” |'
  id: totrans-314
  prefs: []
  type: TYPE_TB
- en: '|  |  | + 10.556 × “wool type B : high tension” |'
  id: totrans-315
  prefs: []
  type: TYPE_TB
- en: The additional interaction terms work the same way as the main effects—when
    only categorical predictors are involved, the model can be seen as a series of
    additive terms to the overall intercept. Exactly which ones you use in any given
    prediction depends on the covariate profile of a given individual.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s have a quick series of examples: for wool A at low tension, the mean
    number of warp breaks is predicted as simply the overall intercept; for wool A
    at high tension, you have the overall intercept and the main effect term for high
    tension; for wool B at low tension, you have the overall intercept and the main
    effect for wool type B only; and for wool B at medium tension, you have the overall
    intercept, the main effect for wool type B, the main effect for medium tension,
    *and* the interactive term for wool B with medium tension.'
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们快速看几个例子：对于低张力的羊毛A，预估的经向断裂数是简单地为整体截距；对于高张力的羊毛A，你有整体截距和高张力的主效应项；对于低张力的羊毛B，你只有整体截距和羊毛类型B的主效应项；而对于中等张力的羊毛B，你有整体截距、羊毛类型B的主效应、中等张力的主效应，*以及*羊毛B与中等张力的交互项。
- en: 'You can use `predict` to estimate the mean warp breaks for these four scenarios;
    they’re accompanied here with 90 percent confidence intervals:'
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用`predict`来估算这四种情境下的平均经向断裂数；这些估算结果会伴随90%的置信区间：
- en: '[PRE37]'
  id: totrans-319
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: '***21.5.4 Two Continuous***'
  id: totrans-320
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '***21.5.4 两个连续变量***'
- en: Finally, you’ll look at the situation when the two predictors are continuous.
    In this case, an interaction term operates as a modifier on the continuous plane
    that’s fitted using the main effects only. In a similar way to an interaction
    between a continuous and a categorical predictor, an interaction between two continuous
    explanatory variables allows the slope associated with one variable to be affected,
    but this time, that modification is made in a continuous way (that is, according
    to the value of the other continuous variable).
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，你将查看两个预测变量都是连续变量时的情况。在这种情况下，交互项作为修饰符作用于连续平面，这个平面仅使用主效应拟合。类似于连续变量与分类预测变量之间的交互作用，两个连续自变量之间的交互作用允许一个变量的斜率受另一个变量的值影响，而这种修饰是连续的（即根据另一个连续变量的值）。
- en: Returning to the `mtcars` data frame, consider MPG once more as a function of
    horsepower and weight. The fitted model, shown next, includes the interaction
    in addition to the main effects of the two continuous predictors. As you can see,
    there is a single estimated interactive term, and it is deemed significantly different
    from zero.
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 回到`mtcars`数据框，再次考虑MPG作为马力和重量的函数。接下来展示的拟合模型，除了包括两个连续预测变量的主效应外，还包含了交互作用项。正如你所看到的，有一个单独估算的交互项，并且它被认为显著不同于零。
- en: '[PRE38]'
  id: totrans-323
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: The model is written as
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 该模型写作如下：
- en: '| “Mean MPG” | = | 49.80842 − 0.12010 × “horsepower” |'
  id: totrans-325
  prefs: []
  type: TYPE_TB
  zh: '| “平均MPG” | = | 49.80842 − 0.12010 × “马力” |'
- en: '|  |  | − 8.21662 × “weight” |'
  id: totrans-326
  prefs: []
  type: TYPE_TB
  zh: '|  |  | − 8.21662 × “重量” |'
- en: '|  |  | + 0.02785 × “horsepower : weight” |'
  id: totrans-327
  prefs: []
  type: TYPE_TB
  zh: '|  |  | + 0.02785 × “马力 : 重量” |'
- en: '|  | = | 49.80842 − 0.12010 × “horsepower” |'
  id: totrans-328
  prefs: []
  type: TYPE_TB
  zh: '|  | = | 49.80842 − 0.12010 × “马力” |'
- en: '|  |  | − 8.21662 × “weight” |'
  id: totrans-329
  prefs: []
  type: TYPE_TB
  zh: '|  |  | − 8.21662 × “重量” |'
- en: '|  |  | + 0.02785 × “horsepower” × “weight” |'
  id: totrans-330
  prefs: []
  type: TYPE_TB
  zh: '|  |  | + 0.02785 × “马力” × “重量” |'
- en: The second version of the model equation provided here reveals for the first
    time an interaction expressed as the *product* of the values of the two predictors,
    which is exactly how the fitted model is used to predict the response. (Technically,
    this is the same as when at least one of the predictors is categorical—but the
    dummy coding simply results in zeros and ones for the respective terms, so multiplication
    just amounts to the presence or absence of a given term, as you’ve seen.)
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 这里提供的第二版本模型方程首次揭示了交互作用，该交互作用表示为两个预测变量值的*乘积*，这正是拟合模型用来预测响应的方式。（从技术上讲，这与至少一个预测变量是分类变量的情况相同——但是虚拟编码只会为相应项生成零和一，因此乘法实际上只是表示某一项的存在或缺失，正如你所看到的那样。）
- en: You can interpret an interaction between two continuous predictors by considering
    the sign (+ or −) of the coefficient. Negativity suggests that as the values of
    the predictors increase, the response is reduced after computing the result of
    the main effects. Positivity, as is the case here, suggests that as the values
    of the predictors increase, the effect is an additional increase, an amplification,
    on the mean response.
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过考虑系数的符号（+或−）来解释两个连续预测变量之间的交互作用。负值表明，随着预测变量值的增加，响应结果在计算了主效应后的数值会减少。正值，正如这里的情况，表明随着预测变量值的增加，效果会进一步增加，对平均响应产生放大作用。
- en: Contextually, the negative main effects of `hp` and `wt` indicate that mileage
    is naturally reduced for heavier, more powerful cars. However, positivity of the
    interactive effect suggests that this impact on the response is “softened” as
    horsepower or weight is increased. To put it another way, the negative relationship
    imparted by the main effects is rendered “less extreme” as the values of the predictors
    get bigger and bigger.
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
- en: '[Figure 21-9](ch21.xhtml#ch21fig9) contrasts the main-effects-only version
    of the model (obtained using `lm` with the formula `mpg~hp+wt`; not explicitly
    fitted in this section) with the interaction version of the model fitted just
    above as the object `car.fit`.'
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/f21-09.jpg)'
  id: totrans-335
  prefs: []
  type: TYPE_IMG
- en: '*Figure 21-9: Response surfaces for mean MPG by horsepower and weight, for
    a main-effects-only model (left), and one that includes the two-way interaction
    between the continuous predictors (right)*'
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
- en: The plotted *response surfaces* show the mean MPG on the vertical *z*-axis and
    the two predictor variables on the horizontal axes as marked. You can interpret
    the predicted mean MPG, based on a given horsepower and weight value, as a point
    on the surface. Note that both surfaces decrease in MPG (vertically along the
    *z*-axis) as you move to larger values of either predictor along the respective
    horizontal axes.
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
- en: I’ll show how these plots are created in [Chapter 25](ch25.xhtml#ch25). For
    now, they serve simply to highlight the aforementioned “softening” impact of the
    interaction in `car.fit`. On the left, the main-effects-only model shows a flat
    plane decreasing according to the negative linear slopes in each predictor. On
    the right, however, the presence of the positive interactive term flattens this
    plane out, meaning the rate of decrease is slowed as the values of the predictor
    variables increase.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
- en: '***21.5.5 Higher-Order Interactions***'
  id: totrans-339
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: As mentioned, two-way interactions are the most common kind of interactions
    you’ll encounter in applications of regression methods. This is because for three-way
    or higher-order terms, you need a lot more data for a reliable estimation of interactive
    effects, and there are a number of interpretative complexities to overcome. Three-way
    interactions are far rarer than two-way effects, and four-way and above are rarer
    still.
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
- en: In [Exercise 21.1](ch21.xhtml#ch21exc1), you used the `nuclear` data set found
    in the `boot` package (provided with the standard R installation), which includes
    data on the constructions of nuclear power plants in the United States. In the
    exercises, you focused mainly on date and time predictors related to construction
    permits to model the mean cost of construction for the nuclear power plants. For
    the sake of this example, assume you don’t have the data on these predictors.
    Can the cost of construction be adequately modeled using only the variables that
    describe characteristics of the plant itself?
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
- en: 'Load the `boot` package and access the `?nuclear` help page to find details
    on the variables: `cap` (continuous variable describing the capacity of the plant);
    `cum.n` (treated as continuous, describing the number of similar constructions
    the engineers had previously worked on); `ne` (binary, describing whether the
    plant was in the northeastern United States); and `ct` (binary, describing whether
    the plant had a cooling tower).'
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
- en: 'The following model is fitted with the final construction cost of the plant
    as the response; a main effect for capacity; and main effects of, and all two-way
    interactions and the three-way interaction among, `cum.n`, `ne`, and `ct`:'
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE39]'
  id: totrans-344
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: In this code, you specify the higher-order interactions by extending the number
    of variables connected with a `*` (using `*` instead of `:` since you want to
    include all the lower-order effects of those three predictors as well).
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
- en: In the estimated results, the main effect for `cap` is positive, showing that
    an increased power capacity is tied to an increased construction cost. All other
    main effects are negative, which at face value seems to imply that a reduced construction
    cost is associated with more experienced engineers, plants constructed in the
    Northeast, and plants with a cooling tower. However, this isn’t an accurate statement
    since you haven’t yet considered the interactive terms in those predictors. All
    estimated two-way interactive effects are positive—having more experienced engineers
    means a higher construction cost in the Northeast regardless of whether there’s
    a cooling tower, and having more experienced engineers also means higher costs
    for plants *with* a cooling tower, regardless of region.
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
- en: Cost is also dramatically increased for plants in the Northeast with a cooling
    tower, regardless of the experience of the engineer. All that being said, the
    negative three-way interaction suggests that the increased cost associated with
    more experienced engineers working in the Northeast *and* on a plant with a cooling
    tower is lessened somewhat after the main effects and two-way interactive effects
    are calculated.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
- en: At the least, this example highlights the complexities associated with interpreting
    model coefficients for higher-order interactions. It’s also possible that statistically
    significant high-order interactions crop up due to lurking variables that have
    gone unaccounted for, that is, that the significant interactions are a spurious
    manifestation of patterns in the data that simpler terms involving those missing
    predictors could explain just as well (if not better). In part, this motivates
    the importance of adequate *model selection*, which is up next in the discussion.
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
- en: '**Exercise 21.3**'
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
- en: Return your attention to the `cats` data frame in package `MASS`. In the first
    few problems in [Exercise 21.1](ch21.xhtml#ch21exc1), you fitted the main-effect-only
    model to predict the heart weights of domestic cats by total body weight and sex.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
- en: Fit the model again, and this time include an interaction between the two predictors.
    Inspect the model summary. What do you notice in terms of the parameter estimates
    and their significance when compared to the earlier main-effect-only version?
  id: totrans-351
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Produce a scatterplot of heart weight on body weight, using different point
    characters or colors to distinguish the observations according to sex. Use `abline`
    to add two lines denoting the fitted model. How does this plot differ from the
    one in [Exercise 21.1](ch21.xhtml#ch21exc1) (d)?
  id: totrans-352
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Predict the heart weight of Tilman’s cat using the new model (remember that
    Sigma is a 3.4 kg female) accompanied by a 95 percent prediction interval. Compare
    it to the main-effects-only model from the earlier exercise.
  id: totrans-353
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In [Exercise 21.2](ch21.xhtml#ch21exc2), you accessed the `trees` data frame
    in the contributed `faraway` package. After loading the package, access the `?trees`
    help file; you’ll find the volume and girth measurements you used earlier, as
    well as data on the height of each tree.
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
- en: Without using any transformations of the data, fit and inspect a main-effects-only
    model for predicting volume from girth and height. Then, fit and inspect a second
    version of this model including an interaction.
  id: totrans-355
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Repeat (d), but this time use the log transformation of all variables. What
    do you notice about the significance of the interaction between the untransformed
    and transformed models? What does this suggest about the relationships in the
    data?
  id: totrans-356
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Turn back to the `mtcars` data set and remind yourself of the variables in the
    help file `?mtcars`.
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
- en: Fit a linear model for `mpg` based on a two-way interaction between `hp` and
    `factor(cyl)` and their main effects, as well as a main effect for `wt`. Produce
    a summary of the fit.
  id: totrans-358
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Interpret the estimated coefficients for the interaction between horsepower
    and the (categorical) number of cylinders.
  id: totrans-359
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Suppose you’re keen on purchasing a 1970s performance car. Your mother advises
    you to purchase a “practical and economical” car that’s capable of an average
    MPG value of at least 25\. You see three vehicles advertised: car 1 is a four-cylinder,
    100 horsepower car that weighs 2100 lbs; car 2 is an eight-cylinder, 210 horsepower
    car that weighs 3900 lbs; and car 3 is a six-cylinder, 200 horsepower car that
    weighs 2900 lbs.'
  id: totrans-360
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Use your model to predict the mean MPG for each of the three cars; provide 95
    percent confidence intervals. Based on your point estimates only, which car would
    you propose to your mother?
  id: totrans-361
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: You still want the most gas-guzzling car you can own with your mother’s blessing,
    so you decide to be sneaky and base your decision on what the confidence intervals
    tell you instead. Does this change your choice of vehicle?
  id: totrans-362
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Important Code in This Chapter**'
  id: totrans-363
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: '| **Function/operator** | **Brief description** | **First occurrence** |'
  id: totrans-364
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  id: totrans-365
  prefs: []
  type: TYPE_TB
- en: '| `I` | Include arithmetic term | [Section 21.4.1](ch21.xhtml#ch21lev2sec199),
    [p. 505](ch21.xhtml#page_505) |'
  id: totrans-366
  prefs: []
  type: TYPE_TB
- en: '| `:` | Interaction term | [Section 21.5.2](ch21.xhtml#ch21lev2sec203), [p.
    516](ch21.xhtml#page_516) |'
  id: totrans-367
  prefs: []
  type: TYPE_TB
- en: '| `*` | Cross-factor operator | [Section 21.5.3](ch21.xhtml#ch21lev2sec204),
    [p. 519](ch21.xhtml#page_519) |'
  id: totrans-368
  prefs: []
  type: TYPE_TB
