<html><head></head><body><div id="sbo-rt-content"><section>
<header>
<figure class="opener">
<img src="Images/chapterart.png" alt=""/>
</figure>
<h1 class="chapterTitle">
<span class="ChapterNumber"><span epub:type="pagebreak" title="167" id="Page_167"/>11</span><br/>
<span class="ChapterTitle">Chatbots</span>
</h1>
</header>
<p class="ChapterIntro"><span class="OpenerCap"><img src="Images/Alphabet-I.png" alt="Alphabet-I" class="dropcap"/></span>n the last chapter, we talked about <em>intent classification</em><em/>: building ML systems that can recognize the meaning (the intention) of text. We talked about one common use of intent classification, which is to build smart assistants that can understand what we’re telling them and carry out our commands.</p>
<p><span epub:type="pagebreak" title="168" id="Page_168"/>In this chapter, we’ll look at how ML models that understand the meaning of text can be used to build <em>question answering (QA)</em><em/><em> systems</em>. QA systems recognize and respond to our questions, discovering the answers automatically from a set of documents.</p>
<p>Unlike search engines, which return a list of web pages, QA systems return a specific answer to a specific question. This is more challenging, as it requires a deep understanding of both the question and the meaning of the web pages or documents that may contain the answers. For example, the correct answer to a question like “Who was President Cleveland’s wife?” is “Frances Folsom,” not a list of documents that include biographies of US presidents. </p>
<p>QA has been a goal and active area of AI research for many years. For example, the US National Institute of Standards and Technology (NIST) has run a QA competition every year since 1999, where universities and companies compete to see which of their computer systems can answer the most questions correctly. </p>
<p>Perhaps better known is the IBM QA computer system Watson, which, as mentioned in <span class="xref" itemid="xref_target_Chapter 1">Chapter 1</span>, competed on the US television quiz show <em>Jeopardy!</em> and beat two champions. <em>Jeopardy!</em> is known for asking complex and sometimes tricky questions on a huge variety of topics, and therefore is a particularly challenging test for a computer.</p>
<p><em>Chatbots</em><em/>, programs that imitate human conversation, are a simpler task for computers than QA systems, for many reasons. First, a chatbot is generally created to answer questions about a single fairly small and specific topic, whereas QA systems attempt to answer questions on any topic. </p>
<p>In addition, chatbot responses are often prepared in advance. Simple chatbots usually aren’t expected to be able to find the answer for themselves. Complex chatbots may have more detailed scripts that allow for follow-up or clarifying questions, but the general principle is the same. </p>
<p>Chatbots are becoming very common. They’re often used for customer service, where companies need to answer questions from the public about their products and services. Frequently asked questions can be quickly and efficiently answered, with more complex questions quickly redirected to human customer service representatives. </p>
<p>You can find chatbots and virtual assistants on many websites and phone apps—taking your pizza order, recommending clothing and fashion accessories, answering questions about the <span epub:type="pagebreak" title="169" id="Page_169"/>weather, managing your bank account, arranging meetings and appointments, finding a restaurant and booking a table, offering advice to help you manage a medical condition, and much more.</p>
<p>In this project, you’ll create your own chatbot and train it to answer questions on a topic of your choice (as shown in <a id="figureanchor11-1" href="#figure11-1">Figure 11-1</a>). We’ll follow this process:</p>
<ol>
<li value="1">Predict questions that users might ask.</li>
<li value="2">Collect examples of how to ask each of those questions.</li>
<li value="3">Use those examples to train an ML model.</li>
<li value="4">Prepare the answer the computer should give when it recognizes each question.</li>
</ol>
<figure>
<img src="Images/f11001.png" alt="f11001"/>
<figcaption><p><a id="figure11-1" href="#figureanchor11-1">Figure 11-1:</a> Chatbots use ML to answer our questions. </p></figcaption>
</figure>
<p>Let’s get started!</p>
<h2 id="h1-500563c11-0001">Build Your Project</h2>
<p class="BodyFirst">Decide what you’d like your chatbot to answer questions about. This can be any topic you like, but here are a few suggestions to help if you can’t think of one:</p>
<ul>
<li>Your favorite book</li>
<li>Your favorite TV show</li>
<li><span epub:type="pagebreak" title="170" id="Page_170"/>Your favorite sports team</li>
<li>Your favorite actor, author, or music artist</li>
<li>Space, planets, and the solar system</li>
<li>Dinosaurs</li>
<li>A period of history, such as ancient Rome or the Viking Age</li>
</ul>
<p>For the screenshots in this chapter, I made a chatbot that answers questions about the moon. </p>
<h3 id="h2-500563c11-0001">Prepare Your Character</h3>
<p class="BodyFirst">Go to Scratch at <a href="https://machinelearningforkids.co.uk/scratch3/" class="LinkURL">https://machinelearningforkids.co.uk/scratch3/</a> and add a backdrop and a character for your QA chatbot.</p>
<p>Make sure the scene you create matches your topic. For example, if you’re making a chatbot to answer questions about the Roman Empire, you could draw a Roman centurion in a battlefield. </p>
<p>For my chatbot about the moon, I drew a space-themed backdrop, as shown in <a id="figureanchor11-2" href="#figure11-2">Figure 11-2</a>.</p>
<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<h2><span class="NoteHead">Note	</span></h2>
<p>For a refresher on creating a backdrop, see step 6 <span class="xref" itemid="xref_target_on page 28">on page 28</span> in <span class="xref" itemid="xref_target_Chapter 3">Chapter 3</span>. For a review of creating a sprite, see step 9<span class="xref" itemid="xref_target_ on page 59"> on page 59</span> in <span class="xref" itemid="xref_target_Chapter 5">Chapter 5</span>.</p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
<figure>
<img src="Images/f11002.png" alt="f11002"/>
<figcaption><p><a id="figure11-2" href="#figureanchor11-2">Figure 11-2:</a> Create a custom backdrop for your chatbot character.</p></figcaption>
</figure>
<p><span epub:type="pagebreak" title="171" id="Page_171"/>For my chatbot character, I made a moon sprite and added cartoon eyes and a mouth, as shown in <a id="figureanchor11-3" href="#figure11-3">Figure 11-3</a>. </p>
<figure>
<img src="Images/f11003.png" alt="f11003"/>
<figcaption><p><a id="figure11-3" href="#figureanchor11-3">Figure 11-3:</a> Create a custom sprite for your chatbot character. </p></figcaption>
</figure>
<p>If you’d prefer not to draw, you can click Choose a Backdrop or Choose a Sprite to select a premade option. Or, you can click Upload a Sprite or Upload a Backdrop to use pictures you’ve saved from the internet. For example, if you’re making a chatbot about your favorite band, you could use a photo of them. If you’re making a chatbot about a school or company, you could use its logo. </p>
<p>Once you’ve created your chatbot scene, make sure you save your Scratch project, as you’ll need it later. If you’re not sure how to do that, read the section <span class="xref" itemid="xref_target_“Saving Your Work” on page xxiv">“Saving Your Work” on page xxiv</span> in the introduction.</p>
<h3 id="h2-500563c11-0002">Train Your Model</h3>
<ol>
<li value="1">Create a new ML project, name it <code class="bold">Chatbot</code>, and set it to learn to recognize text in your preferred language. 
<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<h2><span class="NoteHead">Note	</span></h2>
<p>If you’re not sure how to create an ML project, read the section <span class="xref" itemid="xref_target_“Creating a New ML Project” on page 9">“Creating a New ML Project” on page 9</span> in <span class="xref" itemid="xref_target_Chapter 2">Chapter 2</span>.</p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
</li>
<li value="2">Click <b>Train</b>, as shown in <a id="figureanchor11-4" href="#figure11-4">Figure 11-4</a>.
<span epub:type="pagebreak" title="172" id="Page_172"/><figure>
<img src="Images/f11004.png" alt="f11004"/>
<figcaption><p><a id="figure11-4" href="#figureanchor11-4">Figure 11-4:</a> Train is the first phase of an ML project.</p></figcaption>
</figure>
</li>
<li value="3">Think of the most common question people might ask about your chosen topic.
<p class="ListBody">For my topic, the moon, I’m guessing that people will ask how big the moon is.</p>
<p class="ListBody">When you’ve chosen your first question, click <b>Add new label</b>, as shown in <a id="figureanchor11-5" href="#figure11-5">Figure 11-5</a>, and type in a word or two that represents that question. For example, I used size for my training bucket label.</p>
<figure>
<img src="Images/f11005.png" alt="f11005"/>
<figcaption><p><a id="figure11-5" href="#figureanchor11-5">Figure 11-5:</a> Create a bucket to represent examples of your first question. </p></figcaption>
</figure>
</li>
<li value="4">Click <b>Add example</b><b/> and enter a way to ask that question, as shown in <a id="figureanchor11-6" href="#figure11-6">Figure 11-6</a>.
<span epub:type="pagebreak" title="173" id="Page_173"/><figure>
<img src="Images/f11006.png" alt="f11006"/>
<figcaption><p><a id="figure11-6" href="#figureanchor11-6">Figure 11-6:</a> Add examples of different ways to ask the first question.</p></figcaption>
</figure>
<p class="ListBody">Think of how different people might phrase the question when they ask it. You don’t need to worry about the answer for now.</p>
<p class="ListBody">Type in as many ways of asking this question as you can think of, making sure you have at least five examples. These examples will be used to train an ML model to recognize when someone is asking this question.</p>
<p class="ListBody">If your chatbot looks like the topic you’re asking questions about (like my cartoon moon answering questions about the moon), then you could include some example questions directed to the character, such as “How big are you?”.</p></li>
<li value="5">Think of more types of questions about your topic. Click <b>Add new label</b> again to create a training bucket for each type of question, and <b>Add example</b> to add examples of how to ask that question. As before, you need at least five examples for each type of question.
<p class="ListBody">For my project, I started with four types of questions, with five examples for each (see <a id="figureanchor11-7" href="#figure11-7">Figure 11-7</a>). Your project will vary depending on your topic and the number of questions you can think of for it.</p>
<span epub:type="pagebreak" title="174" id="Page_174"/><figure>
<img src="Images/f11007.png" alt="f11007"/>
<figcaption><p><a id="figure11-7" href="#figureanchor11-7">Figure 11-7:</a> Write examples of the different types of questions someone could ask.</p></figcaption>
</figure>
<p class="ListBody">For your topic, you’re guessing what the most common questions are and imagining the different ways that people might ask them. Real-world ML projects often collect these examples from actual customers or users so that the computer can learn what questions are really being asked, and how. For example, a shop training a virtual assistant to answer questions about setting up televisions will keep a record of questions that customers have called to ask in the past. Or a bank training a virtual assistant to answer questions about savings accounts will keep a record of questions customers have typed into chat windows on the bank’s website. Both businesses can use these examples of real questions phrased by real people to train their ML models.</p>
<p class="ListBody">We saw in <span class="xref" itemid="xref_target_Chapter 3">Chapter 3</span> that ML models give better answers when trained with data that is similar to what the project will need to do. You learned that if you want an ML model to recognize photos of different animals, you should train it with photos, and if you want it to recognize cartoons, you should train it with cartoons.</p>
<p class="ListBody">Text ML models work in a similar way. When we train them with questions phrased in the way that real people ask questions, they’ll give better answers. The best way to do this for <span epub:type="pagebreak" title="175" id="Page_175"/>real-world ML projects is to find existing examples rather than making them up like we’re doing for this project. </p></li>
<li value="6">Click <b>Back to project</b> in the top-left corner of the screen.</li>
<li value="7">Click <b>Learn &amp; Test</b>, as shown in <a id="figureanchor11-8" href="#figure11-8">Figure 11-8</a>.
<figure>
<img src="Images/f11008_new.png" alt="f11008_new"/>
<figcaption><p><a id="figure11-8" href="#figureanchor11-8">Figure 11-8:</a> Learn &amp; Test is the second phase of an ML project.</p></figcaption>
</figure></li>
<li value="8">Click <b>Train new machine learning model</b>, as shown in <a id="figureanchor11-9" href="#figure11-9">Figure 11-9</a>. 
<p class="ListBody">The computer will use the examples you’ve written to learn how to recognize questions that people ask about your topic. This process might take a minute or so. The computer is using this time to learn what the questions in each training bucket have in common, such as the words you used, the way you phrased the questions, how short or long the questions are, and much more. </p>
</li>
</ol>
<figure>
<img src="Images/f11009.png" alt="f11009"/>
<figcaption><p><a id="figure11-9" href="#figureanchor11-9">Figure 11-9:</a> Train an ML model using the examples that you’ve written. </p></figcaption>
</figure>
<h3 id="h2-500563c11-0003"><span epub:type="pagebreak" title="176" id="Page_176"/>Prepare Your Project</h3>
<p class="BodyFirst">Now that you have a character and an ML model, it’s time to combine them to create your chatbot.</p>
<ol>
<li value="1">Click <b>Back to project</b> in the top-left corner of the screen.</li>
<li value="2">Click <b>Make</b>, as shown in <a id="figureanchor11-10" href="#figure11-10">Figure 11-10</a>.
<figure>
<img src="Images/f11010.png" alt="f11010"/>
<figcaption><p><a id="figure11-10" href="#figureanchor11-10">Figure 11-10:</a> Make is the third phase of an ML project.</p></figcaption>
</figure>
</li>
<li value="3">Click <b>Scratch 3</b>, and then click <b>Open in Scratch 3</b>. Scratch will open with a new set of blocks for your Chatbot ML project. </li>
<li value="4">Click <b>File</b><span class="MenuArrow">▶</span><b> Load from your computer</b>,<b> </b>as shown in <a id="figureanchor11-11" href="#figure11-11">Figure 11-11</a>, to open the project you saved earlier with your chatbot scene.
<figure>
<img src="Images/f11011.png" alt="f11011"/>
<figcaption><p><a id="figure11-11" href="#figureanchor11-11">Figure 11-11:</a> Open the project with the scene you created before. </p></figcaption>
</figure>
</li>
<li value="5"><span epub:type="pagebreak" title="177" id="Page_177"/>Copy the script shown in <a id="figureanchor11-12" href="#figure11-12">Figure 11-12</a>.
<figure>
<img src="Images/f11012.png" alt="f11012"/>
<figcaption><p><a id="figure11-12" href="#figureanchor11-12">Figure 11-12:</a> Sample script to create a simple chatbot </p></figcaption>
</figure>
<p class="ListBody">This script will ask you to type in a question and then use the ML model you’ve trained to recognize what you asked. </p>
<p class="ListBody">Your script should differ from mine, as mine has the questions about the moon that I trained my ML model with. Be sure to use your question types instead.</p>
<p class="ListBody">You’ll also need to put the answers to the questions on your topic here. If you don’t know them, now’s the time to do some research to find the answers your chatbot should give!</p></li>
<li value="6">Click <b>File</b><span class="MenuArrow">▶</span><b>Save to your computer </b>to save your project.</li>
</ol>
<h3 id="h2-500563c11-0004">Test Your Project</h3>
<p class="BodyFirst">Click the Green Flag and try asking your chatbot a question. Does it give you the right answer?</p>
<h2 id="h1-500563c11-0002">Review and Improve Your Project</h2>
<p class="BodyFirst">You’ve created a simple chatbot that can recognize and answer the most common questions about a topic of your choice. Well done!</p>
<p>What could you do to improve your chatbot?</p>
<h3 id="h2-500563c11-0005"><span epub:type="pagebreak" title="178" id="Page_178"/>Responding and Recording When Users Report Mistakes</h3>
<p class="BodyFirst">AI systems cannot correctly understand everything, so you could improve your ML project by training it to handle mistakes. A good way to handle mistakes is to train your ML model to recognize when someone complains about the results it gives. </p>
<p>Go back to the Train phase and add a new training bucket called <code class="bold">mistake</code>. Fill it with examples of how someone might complain that the ML model got something wrong, as shown in <a id="figureanchor11-13" href="#figure11-13">Figure 11-13</a>.</p>
<p>For example, you might add <code class="bold">That's not what I meant</code> to the mistake bucket.</p>
<figure>
<img src="Images/f11013.png" alt="f11013"/>
<figcaption><p><a id="figure11-13" href="#figureanchor11-13">Figure 11-13:</a> Collect examples of how a user might complain about a mistake the model makes.</p></figcaption>
</figure>
<p>Once you’ve added at least five examples, you’ll need to return to the Learn &amp; Test phase to train a new ML model. </p>
<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<h2><span class="NoteHead">Note	</span></h2>
<p>You’ll also need to close and reopen Scratch so it can use commands from the mistake bucket. Make sure you save your project before you close it so that you don’t have to build your script again.</p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
<p>When your chatbot recognizes that someone complains, the simplest response it can give is to apologize to them. Update your script as shown in <a id="figureanchor11-14" href="#figure11-14">Figure 11-14</a>.</p>
<span epub:type="pagebreak" title="179" id="Page_179"/><figure>
<img src="Images/f11014_new.png" alt="f11014_new"/>
<figcaption><p><a id="figure11-14" href="#figureanchor11-14">Figure 11-14:</a> Update your script so that it apologizes if the user complains. </p></figcaption>
</figure>
<p>You can make your project even better by keeping a record of the mistakes. For example, I created a new list called mistakes (to do this, click <b>Variables</b> in the Toolbox, click <b>Make a List</b>, and enter the name <code class="bold">mistakes</code>) and updated the script as shown in <a id="figureanchor11-15" href="#figure11-15">Figure 11-15</a> so that if someone complains about the answer they get, their question is added to the list.</p>
<figure>
<img src="Images/f11015.png" alt="f11015"/>
<figcaption><p><a id="figure11-15" href="#figureanchor11-15">Figure 11-15:</a> Keep a record of questions that the chatbot gets wrong. </p></figcaption>
</figure>
<p><span epub:type="pagebreak" title="180" id="Page_180"/>When I asked, “Who was the first man on the moon?” my model told me how far the moon is from the Earth. Then, when I replied with, “No, that isn’t what I asked for,” my question about the first man on the moon was added to the mistakes list.</p>
<p>Tracking mistakes is a common technique used to improve real-world ML projects. The list of mistakes is used as a collection of examples to train the next version of the ML model. </p>
<p>What else could you do to improve your chatbot?</p>
<h3 id="h2-500563c11-0006">Recognizing When a User Isn’t Happy</h3>
<p class="BodyFirst">Your chatbot users might not always tell you when your ML system gets something wrong. So are there other ways that you can tell when it makes mistakes?</p>
<p>In <span class="xref" itemid="xref_target_Chapter 7">Chapter 7</span>, you learned about training an ML model to recognize tone and emotion in writing. You could combine that technique with this project to make your chatbot recognize when users are getting angry or annoyed. </p>
<p>Train two ML models: one to recognize the meaning of questions (as you’ve just done) and the other to recognize emotion (such as “annoyed” and “not annoyed,” similar to your project in <span class="xref" itemid="xref_target_Chapter 7">Chapter 7</span>). If the second ML model has a high degree of confidence that the user sounds annoyed, your chatbot should apologize instead of trying to answer the question again. </p>
<p>Detecting the user’s tone, and apologizing when necessary, is a common technique used for chatbots that communicate with members of the public, such as for customer service. People can get annoyed if some technology consistently misunderstands them. If systems can recognize when things are going badly and apologize, the customer may be happier. In such cases, these systems will also commonly call for a human customer service representative or manager to join the conversation and help. </p>
<p>Is there anything else you could do to improve your project?</p>
<h3 id="h2-500563c11-0007">Answering Only When the ML Model Is Confident</h3>
<p class="BodyFirst">Recognizing when the user is annoyed is a good thing. But it’s often better to avoid annoying the user in the first place! You can use the confidence score to prevent your chatbot from giving wrong answers.</p>
<p><span epub:type="pagebreak" title="181" id="Page_181"/>You learned in <span class="xref" itemid="xref_target_Chapter 7">Chapter 7</span> that the confidence score is a percentage returned by an ML model that shows how confident the model is that it has correctly recognized whatever it’s been trained on. </p>
<p>In this project, if the confidence score is low, it means the ML model isn’t sure that it understood the question. You could modify your chatbot code as shown in <a id="figureanchor11-16" href="#figure11-16">Figure 11-16</a> so that if the model doesn’t understand the question, the chatbot apologizes rather than simply guessing the answer, and the question gets added to the list of examples to train the model with in the future. </p>
<figure>
<img src="Images/f11016.png" alt="f11016"/>
<figcaption><p><a id="figure11-16" href="#figureanchor11-16">Figure 11-16:</a> Handle low confidence scores by recording the questions to use in future training. </p></figcaption>
</figure>
<h2 id="h1-500563c11-0003"><span epub:type="pagebreak" title="182" id="Page_182"/>ML and Ethics </h2>
<p class="BodyFirst">These suggestions for improving your project are based on common real-world approaches to ML projects. As you’ve seen, collecting training data takes a lot of time and effort. To save time, some companies using ML collect just enough training examples to make an ML model basically work, and then allow their customers to start using it (sometimes describing it as a<em>beta</em> to explain why it still gets some things wrong). Then they collect poor experiences their customers have with their ML model so that they can improve their training data. This might mean collecting examples of customer questions that the ML model had a low confidence score in, or where the customer reported that the answer was unhelpful. The company then reviews these customer questions and sorts them into the right training buckets. </p>
<p>Companies say they do this because it means their ML model will do a better job of answering questions in the future. The more representative they make the training examples they use, the better answers their system can give. But sometimes this surprises people who don’t realize that questions they ask their smart devices can be recorded by the device’s manufacturer. Try searching the web for news stories about the maker of your favorite smart device listening to what people ask the device. How many articles can you find? What do you think of these reactions?</p>
<p>What do you think this means for the responsibilities of the people who create ML systems? Do you think it’s ethical for ML developers to collect training examples from their customers or users? Do you think they should tell users that this is happening? And how would you explain it to users who might not realize what training examples are, or why they’re so important for training ML systems? </p>
<h2 id="h1-500563c11-0004">What You Learned</h2>
<p class="BodyFirst">In this chapter, you learned that ML models can be trained to understand and respond to questions people ask. You learned the differences between question answering (QA) systems and their simpler counterpart, chatbots. You then designed a custom chatbot and trained an ML model to recognize the most common questions about a topic of your choosing. You saw a few different ways you could extend your chatbot to improve its performance and <span epub:type="pagebreak" title="183" id="Page_183"/>accuracy, such as by tracking mistakes, responding appropriately to customers’ feedback and tone, and using the confidence score to decide when a question should be directed to a person (for example, in a customer service setting). Finally, you learned about some of the ethical questions to consider when training ML models with feedback from real people.</p>
<p>In the next chapter, we’ll switch gears and train an ML model for the first time to recognize numbers in a simplified version of the video game <em>Pac-Man</em>.</p>
</section>
</div></body></html>