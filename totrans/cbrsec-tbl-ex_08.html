<html><head></head><body>
<div id="book-content">
<div id="sbo-rt-content"><section epub:type="chapter" role="doc-chapter" aria-labelledby="ch6">&#13;
<span role="doc-pagebreak" epub:type="pagebreak" id="pg_119" aria-label="119"/>&#13;
<hgroup>&#13;
<h2 class="CHAPTER" id="ch6">&#13;
<span class="CN"><span class="SANS_Futura_Std_Bold_Condensed_B_11">6</span></span>&#13;
<span class="CT"><span class="SANS_Dogma_OT_Bold_B_11">ENGAGING A TECHNICAL AUDIENCE</span></span>&#13;
</h2>&#13;
</hgroup>&#13;
<figure class="opener"><img class="opener" src="../images/opener.jpg" alt="" width="381" height="380"/>&#13;
</figure>&#13;
<p class="CO">In this chapter, we focus on exercises designed to engage and challenge a technical audience, such as information technology and information security staff. Depending on the organization, participants might include team members from the security operations center and the help desk, database and network administrators, and relevant technical management, among others. Because the examples in this chapter are more technical than the example scenarios in <span class="Xref1"><a href="chapter7.xhtml">Chapters 7</a></span> and <span class="Xref1"><a href="chapter8.xhtml">8</a></span>, you’ll need to make significant changes to address the technical nuances of your organization.</p>&#13;
<p class="TX">In general, the discussions that arise during a technical exercise should focus on the people, processes, and technology in place to handle the given <span role="doc-pagebreak" epub:type="pagebreak" id="pg_120" aria-label="120"/>scenario, with specific emphasis on the technological issues to address during a cybersecurity incident. However, the exercise shouldn’t lose sight of the fact that technology exists to enable the business. If the developed scenario would elicit a collective “So what?” from business leaders, it’s possible the exercise isn’t aligned with the organization’s needs.</p>&#13;
<section epub:type="division" aria-labelledby="sec1">&#13;
<h3 class="H1" id="sec1"><span id="h-131"/><span class="SANS_Futura_Std_Bold_B_11">A Widespread Phishing Campaign</span></h3>&#13;
<p class="TNI">Organizations frequently want to evaluate their ability to respond to large phishing campaigns, in which several users click a malicious link or engage with a suspicious email in harmful ways.</p>&#13;
<p class="TX">The audience for this scenario should include technical staff from the help desk, information technology, and information security teams, as well as the email administrators (if not a part of the previously listed functions). It would also be wise to involve certain members of the teams’ leadership, as the scenario might require higher-level decision-making for issues impacting the business.</p>&#13;
<section epub:type="division" aria-labelledby="sec2">&#13;
<h4 class="H2" id="sec2"><span id="h-132"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">The Scenario</span></h4>&#13;
<p class="TNI">This tabletop walks through a basic phishing attack on a decentralized organization and includes an active exploitation of the environment. An <i>active exploitation</i> indicates that a threat actor is currently in the environment. Because phishing is a common threat, you could easily simplify or expand the following storyboard, adjusting it to the intended participants and their experience.</p>&#13;
<p class="TX">In the introduction to the scenario, the manager of the Baton Rouge location for Southwest Truck Sales, which sells large commercial vehicles, calls the help desk and says, “I think I’ve made a mistake. I received an email from the CEO about annual bonuses and merit increases. I downloaded the attached file, but the document is blank. I need help accessing the file.”</p>&#13;
<ul class="BL">&#13;
<li class="BL">How will the help desk handle a call like this?</li>&#13;
<li class="BL">Is the help desk trained to recognize a potential phishing attempt?</li>&#13;
<li class="BL">What immediate technical steps is the help desk trained to ask the caller to perform? Are these steps adequate in this situation?</li>&#13;
<li class="BL">Whom, if anyone, should this issue be escalated to, based on the single report?</li>&#13;
</ul>&#13;
<section epub:type="division" aria-labelledby="sec3">&#13;
<h5 class="H3" id="sec3"><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 1</span></h5>&#13;
<p class="TNI">While investigating the manager’s system, the help desk receives additional calls from other Southwest Truck Sales locations reporting a suspicious email from the CEO regarding bonuses. Some users report opening a file attached to the email.</p>&#13;
<ul class="BL">&#13;
<li class="BL">What steps are end users trained to perform if they encounter a phishing email? In this scenario, are these steps adequate?</li>&#13;
<li class="BL"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_121" aria-label="121"/>Are those steps user-friendly? Are end users expected to call the help desk, or are there other ways of reporting an issue?</li>&#13;
<li class="BL">Is this scenario now classified as an event or an incident?</li>&#13;
<li class="BL">If it is an incident, what is its current severity level?</li>&#13;
<li class="BL">Do additional parties need to be notified about the details of this issue?</li>&#13;
<li class="BL">Will the help desk investigate the various tickets in concert, or will its team members operate separately?</li>&#13;
<li class="BL">At this point, who oversees the investigation?</li>&#13;
<li class="BL">Can the email be recovered and examined by information security personnel? Who would perform these tasks?</li>&#13;
</ul>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec4">&#13;
<h5 class="H3" id="sec4"><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 2</span></h5>&#13;
<p class="TNI">Information technology investigates the issue and finds that the email was sent to over 25 percent of the Southwest Truck Sales staff. It appears that at least 36 users from 6 locations opened the email, but whether these employees opened the attachment is unclear.</p>&#13;
<ul class="BL">&#13;
<li class="BL">How will the organization investigate who opened the attachment? Is the organization able to quickly make this determination?</li>&#13;
<li class="BL">Can the organization query systems across the information technology infrastructure to look for evidence of the file, such as the filename or hash value?</li>&#13;
<li class="BL">Is it possible to determine what, if anything, the file does upon opening, and what it contains?</li>&#13;
<li class="BL">Can information technology pull the email from inboxes so that additional staff members don’t open it and potentially click or download the attachment?</li>&#13;
<li class="BL">Because Southwest Truck Sales has locations spread over a large geographic area, does the information technology team have the capability to examine system artifacts in real time? Can the information technology team capture data sets (such as RAM or logs) if deemed necessary?</li>&#13;
<li class="BL">Does information security have the required skill sets to analyze the email and attachment? Will an outside vendor be required to provide analysis? If so, what is the process to engage them?</li>&#13;
</ul>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec5">&#13;
<h5 class="H3" id="sec5"><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 3</span></h5>&#13;
<p class="TNI">Information security investigates the attachment. After opening it, the victim is prompted to enter their domain username and password to access the sensitive contents of the malicious document. Once the credentials are entered, the document opens and appears to be blank. Information security confirms that a PowerShell script runs and downloads additional files to the system after the user enters their credentials.</p>&#13;
<p class="TX"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_122" aria-label="122"/>During their analysis, the information security team identifies indicators of compromise (IoCs), including registry changes, MD5 hashes of specific files, and IP addresses that the compromised system attempts to contact.</p>&#13;
<ul class="BL">&#13;
<li class="BL">How will the compromised user credentials and the impacted systems be addressed?</li>&#13;
<li class="BL">Besides the PowerShell script, are there any additional sources of information that could be used to determine if other users have been affected?</li>&#13;
<li class="BL">Does the PowerShell script trigger any alerts from the organization’s security tools?</li>&#13;
<li class="BL">Can the remaining systems in the environment be queried to determine which ones have the malicious files? Are the registry changes, MD5 hash values, and IP addresses recorded in any system or network artifacts?</li>&#13;
</ul>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec6">&#13;
<h5 class="H3" id="sec6"><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 4</span></h5>&#13;
<p class="TNI">The investigation reveals that at least 23 systems at 5 locations have the malicious files. The systems belong to a range of users, including employees from finance, human resources, and management. Additionally, one outlier, a privileged IT administrator who has access to domain admin credentials, was compromised. Some users reported entering their credentials when prompted, but others did not remember the specific actions they took. The privileged IT administrator believed they entered their credentials but was not 100 percent sure.</p>&#13;
<ul class="BL">&#13;
<li class="BL">How will the organization handle the accounts of users who clicked the attachment?</li>&#13;
<li class="BL">Is it possible to determine whether domain credentials have been compromised? If they are, could they be used by someone outside the corporate environment?</li>&#13;
<li class="BL">Should the incident be escalated to other positions in the organization? Also, are the correct people still leading the response?</li>&#13;
<li class="BL">What other evidence should be collected, and how can the response team ensure that it is properly handled?</li>&#13;
<li class="BL">Is there a process to change all user account passwords across the organization, including domain admin and service account passwords, due to the potential domain admin account compromise? Can the process be executed quickly (within a few hours)? Will there be an impact on business operations?</li>&#13;
<li class="BL">When was the last time a global password reset was tested or conducted?</li>&#13;
<li class="BL">Do any existing network logs record activity that emanates from the systems?</li>&#13;
</ul>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec7">&#13;
<h5 class="H3" id="sec7"><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 5</span></h5>&#13;
<p class="TNI">Technical staff have reset credentials across the organization. They have reimaged impacted systems and are in the process of rebuilding them. <span role="doc-pagebreak" epub:type="pagebreak" id="pg_123" aria-label="123"/>Based on network logs, it does not appear that further lateral movement (that is, spread throughout other parts of the network) has occurred.</p>&#13;
<ul class="BL">&#13;
<li class="BL">Should the organization consider implementing multifactor authentication from remote/VPN access to reduce the risk of such an attack in the future? What about for any administrative access?</li>&#13;
<li class="BL">What is the process to monitor systems and the environment for reinfection post-incident?</li>&#13;
<li class="BL">Are there system and network logs that can be checked for internal lateral movement or other unusual use of suspected compromised credentials?</li>&#13;
<li class="BL">Who, if anyone, should be notified following the incident?</li>&#13;
<li class="BL">Does this incident necessitate a formal lessons-learned process?</li>&#13;
</ul>&#13;
</section>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec8">&#13;
<h4 class="H2" id="sec8"><span id="h-133"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Possible Modifications</span></h4>&#13;
<p class="TNI">To adapt the scenario, consider making the following modifications:</p>&#13;
<ul class="BL">&#13;
<li class="BL">The email originates from a legitimate email address within the organization.</li>&#13;
<li class="BL">The email originates from a legitimate partner, a vendor, or other notable external relationship.</li>&#13;
<li class="BL">Lateral movement occurs, and a critical application server is accessed.</li>&#13;
<li class="BL">The phishing email goes unreported.</li>&#13;
<li class="BL">The email includes a link, as opposed to a file attachment. When clicked, this link may lead to a spoofed website, a file download, or another malicious site.</li>&#13;
<li class="BL">The issue is widespread; for example, in a global organization, it affects three-quarters of all global sites.</li>&#13;
<li class="BL">The threat actor gains access to the network and is undetected for an extended period.</li>&#13;
<li class="BL">Specific logs are either available or unavailable, impacting the investigation.</li>&#13;
</ul>&#13;
</section>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec9">&#13;
<h3 class="H1" id="sec9"><span id="h-134"/><span class="SANS_Futura_Std_Bold_B_11">Ransomware Affecting File Servers (the Technical Version)</span></h3>&#13;
<p class="TNI">As of this writing, ransomware continues to plague organizations globally and is the top threat for most of them. When used in a tabletop exercise, this scenario can often evolve into lengthy discussions on the best way to contain the spread, the validity of organizational backups, and whether the company has the means to restore the environment.</p>&#13;
<p class="TX">While a ransomware scenario can focus on both the technical and nontechnical aspects of the incident, the particular scenario we discuss here focuses on the technical ones. Other avenues of discussion, such as when to <span role="doc-pagebreak" epub:type="pagebreak" id="pg_124" aria-label="124"/>involve the cyber insurance provider and whether to pay the ransom, may emerge but shouldn’t be discussed in depth in a technical exercise. Instead, save them for an executive ransomware tabletop, covered in <span class="Xref1"><a href="chapter7.xhtml">Chapter 7</a></span>.</p>&#13;
<section epub:type="division" aria-labelledby="sec10">&#13;
<h4 class="H2"><span id="sec10"/><span id="h-135"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">The Scenario</span></h4>&#13;
<p class="TNI">In this ransomware scenario, we’ll include a moderate level of exploitation of the server environment but assume that the backups and Active Directory environments remain unaffected. The threat actor will gain initial access via a phishing email and move laterally into the server farm.</p>&#13;
<p class="TX">The scenario begins when a staff member of Maine Pharma, a large pharmaceutical research firm, calls the help desk because they’re unable to access files on their laptop. The caller has attempted to reboot, to no avail. They’re frantic, as they have a big presentation later that day and can’t access their slideshow.</p>&#13;
<ul class="BL">&#13;
<li class="BL">How will the help desk personnel handle this call? Do they remotely access the end-user system? If so, how?</li>&#13;
<li class="BL">Does the help desk escalate this issue to anyone else? If so, to whom, and how?</li>&#13;
<li class="BL">Given the facts known thus far, is this considered a security event or incident?</li>&#13;
</ul>&#13;
<section epub:type="division" aria-labelledby="sec11">&#13;
<h5 class="H3"><span id="sec11"/><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 1</span></h5>&#13;
<p class="TNI">The help desk receives additional calls reporting similar behavior throughout Maine Pharma. Several employees report a message on their desktop demanding a ransom payment of 20 Bitcoin to a given Bitcoin wallet in exchange for access to the decryption keys and the encrypted data.</p>&#13;
<ul class="BL">&#13;
<li class="BL">Is the help desk trained to recognize a potential ransomware event?</li>&#13;
<li class="BL">Is this now a security event or incident? What is its severity?</li>&#13;
<li class="BL">Who else should be pulled into the incident at this time? How will they be notified?</li>&#13;
<li class="BL">Who is leading the response?</li>&#13;
<li class="BL">Is it possible to determine the extent of the spread of the ransomware?</li>&#13;
<li class="BL">How can the affected endpoints be contained? Is there a tool in place that can help with the isolation process, or will it have to be done manually?</li>&#13;
<li class="BL">How quickly can isolation occur? Are approvals required to isolate certain systems, and if so, how long will those approvals take?</li>&#13;
<li class="BL">Should we consider isolating non-affected critical systems, such as Active Directory, backups, or other business-critical systems? (This assumes systems are not impacted yet.) If so, how will these systems be isolated?</li>&#13;
<li class="BL">How will evidence found during the investigation be preserved?</li>&#13;
</ul>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec12">&#13;
<span role="doc-pagebreak" epub:type="pagebreak" id="pg_125" aria-label="125"/>&#13;
<h5 class="H3"><span id="sec12"/><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 2</span></h5>&#13;
<p class="TNI">Users are now reporting an inability to access files on numerous Maine Pharma file servers. It has been four hours since the issue was first discovered.</p>&#13;
<ul class="BL">&#13;
<li class="BL">Is the inability to access these systems connected to the ransomware attack?</li>&#13;
<li class="BL">How can the impacted servers be checked for potential ransomware?</li>&#13;
<li class="BL">How can the organization tell which systems the threat actor has gained access to?</li>&#13;
<li class="BL">Has the severity of the incident increased? If so, to what level? And who else needs to be engaged?</li>&#13;
<li class="BL">Can the organization get ahead of the apparent spread of activity throughout the environment?</li>&#13;
</ul>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec13">&#13;
<h5 class="H3"><span id="sec13"/><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 3</span></h5>&#13;
<p class="TNI">Information security determines that the initial access to Maine Pharma occurred when a finance user clicked a link in a spear phishing email. This attack took advantage of an unpatched vulnerability in Microsoft Word known to be under active exploitation. Microsoft announced the vulnerability three weeks before the phishing email was sent, and a patch has been available since that announcement.</p>&#13;
<ul class="BL">&#13;
<li class="BL">How often are patches applied and rolled out to the organization?</li>&#13;
<li class="BL">How is the organization monitoring newly announced patches, especially out-of-cycle, highly critical ones?</li>&#13;
<li class="BL">Is there a process to expedite vulnerabilities under active exploitation?</li>&#13;
<li class="BL">Can systems be monitored for their patch level? Is it possible to have a complete inventory of all systems that lack the relevant patches?</li>&#13;
<li class="BL">What systems are in place to monitor for phishing? Is it possible to pull the phishing email from mailboxes?</li>&#13;
</ul>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec14">&#13;
<h5 class="H3"><span id="sec14"/><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 4</span></h5>&#13;
<p class="TNI">After consultation with Maine Pharma’s senior leadership, the organization determines that it will not entertain a ransom and must restore its data from available backups. Primary backups appear unaffected by the ransomware.</p>&#13;
<ul class="BL">&#13;
<li class="BL">How will the organization verify that the backups are safe to use?</li>&#13;
<li class="BL">When was the last time backup restoration was tested?</li>&#13;
<li class="BL">What needs to occur before systems can be restored and placed back into production?</li>&#13;
<li class="BL">How are systems validated to ensure they are not impacted by any malware or vulnerabilities?</li>&#13;
<li class="BL"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_126" aria-label="126"/>How quickly can the organization restore all impacted servers to a usable state?</li>&#13;
<li class="BL">Which systems will take priority in the restoration process?</li>&#13;
<li class="BL">How will the restored data be reconciled?</li>&#13;
</ul>&#13;
</section>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec15">&#13;
<h4 class="H2"><span id="sec15"/><span id="h-136"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Possible Modifications</span></h4>&#13;
<p class="TNI">To adapt the scenario, consider introducing the following elements:</p>&#13;
<ul class="BL">&#13;
<li class="BL">The organization lacks the personnel or skill sets to respond to the incident and attempt restoration.</li>&#13;
<li class="BL">The ransomware has fully encrypted primary and secondary backups, rendering them unusable.</li>&#13;
<li class="BL">The threat actor gains access to and encrypts the Active Directory servers or virtualization hypervisor environments.</li>&#13;
<li class="BL">The threat actor has exfiltrated data and threatens to release the contents if the organization doesn’t make a larger payment.</li>&#13;
<li class="BL">Sensitive data, such as intellectual property or employees’ health plan information, is accessed and exfiltrated.</li>&#13;
<li class="BL">The organization pays the ransom and receives the encryption keys. With this modification, how long will it take for information technology to recover? How would we validate that the decryption keys or tooling function as expected?</li>&#13;
<li class="BL">The ransomware has encrypted key systems, such as domain controllers, and the backups are found to be corrupted.</li>&#13;
<li class="BL">The ransom payment is higher or lower than 20 Bitcoin.</li>&#13;
</ul>&#13;
</section>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec16">&#13;
<h3 class="H1" id="sec16"><span id="h-137"/><span class="SANS_Futura_Std_Bold_B_11">A Malware Outbreak via a Zero-Day Vulnerability</span></h3>&#13;
<p class="TNI">In 1988, the Morris Worm spread rapidly across the internet, affecting computers across the world. As technology continues to evolve, so, too, will the attacks that organizations face. Malware outbreaks are a common occurrence in organizations, and the news is littered with examples of these widespread incidents. In this section, we cover one such event.</p>&#13;
<p class="TX">The malware discussed in this scenario is fictional. To make the scenario more relevant to your organization, try changing it to a variant that has recently emerged or to a fictitious version of a known piece of malware. Consider the current threat landscape as well as the business impact, and modify the scenario accordingly.</p>&#13;
<section epub:type="division" aria-labelledby="sec17">&#13;
<h4 class="H2"><span id="sec17"/><span id="h-138"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">The Scenario</span></h4>&#13;
<p class="TNI">A new malware variant, dubbed ROBber, is spreading across organizations worldwide. The malware installs a remote access trojan and keystroke logger on infected endpoints. It then archives the logs of recorded keystrokes and sends them to a command-and-control server once a day. As the exercise <span role="doc-pagebreak" epub:type="pagebreak" id="pg_127" aria-label="127"/>begins, this information is not yet known, but it will come into play later in the exercise.</p>&#13;
<p class="TX">The exercise begins with Microsoft issuing an advisory regarding a zero-day vulnerability affecting systems running Internet Information Services (IIS) version 10 and below. According to the advisory, a patch is not yet available; however, Microsoft suggests immediately disabling systems running the affected versions. The advisory also included several IP addresses, which Microsoft recommends blocking. Microsoft indicates that additional details will be provided once available.</p>&#13;
<p class="TX">Threat groups have already started to exploit this vulnerability, and the security community has published additional advisories that involve several IoCs, including multiple IP addresses and one domain. Systems found beaconing to these addresses should be considered compromised.</p>&#13;
<p class="TX">Dave’s Crazy Donuts, a regional breakfast chain with more than 200 stores specializing in unique donuts and coffee, runs a number of IIS systems as part of its information technology infrastructure.</p>&#13;
<ul class="BL">&#13;
<li class="BL">How does Dave’s Crazy Donuts stay informed of security advisories and identify those that might impact its environment? Is someone on staff tasked with monitoring security advisories? Do critical advisories have a process for immediate escalation?</li>&#13;
<li class="BL">How—and how quickly—would the organization respond to such an alert?</li>&#13;
<li class="BL">How would the organization determine whether its systems have any IoC-related activity?</li>&#13;
<li class="BL">Who is responsible for checking network traffic to the flagged IP addresses?</li>&#13;
<li class="BL">How can the organization verify what, if any, systems are running IIS version 10 or earlier? How long would it take to perform this task?</li>&#13;
</ul>&#13;
<section epub:type="division" aria-labelledby="sec18">&#13;
<h5 class="H3"><span id="sec18"/><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 1</span></h5>&#13;
<p class="TNI">A review of network logs within Dave’s Crazy Donuts indicates irregular traffic to IP address 1.2.3.4 over SSH (TCP/22) every day at 12:22 <small>PM</small>. This IP address is not included in the list from Microsoft, but it is also unknown to the organization. The traffic originates from 46 different workstations and servers in the organization (representing eight restaurant locations, as well as the corporate headquarters) and is similar in nature to the traffic mentioned in the available threat posts.</p>&#13;
<ul class="BL">&#13;
<li class="BL">What tools are available to investigate the content of the observed TCP/22 network traffic?</li>&#13;
<li class="BL">How can the company determine whether the irregular traffic stems from the vulnerability reported by Microsoft or from a separate issue?</li>&#13;
<li class="BL">Is this behavior considered a cybersecurity incident? If so, what is its severity?</li>&#13;
<li class="BL">Are there other parties in management or on other technical teams that must be notified about the details of this issue?</li>&#13;
<li class="BL"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_128" aria-label="128"/>How will the destination IP address be investigated? What about the source systems?</li>&#13;
<li class="BL">What network logs are collected, and how long are they maintained? Is there a log retention policy?</li>&#13;
<li class="BL">Will any containment measures be deployed? Is it typical for users to need to use SSH to access hosts on the internet, or could this service be disabled? Is there a business need to access servers and network equipment within the environment over SSH?</li>&#13;
</ul>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec19">&#13;
<h5 class="H3"><span id="sec19"/><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 2</span></h5>&#13;
<p class="TNI">As the organization investigates the incident, it discovers 18 new systems, all containing the same 3 suspicious files, exhibiting similar behavior but beaconing to a new IP address, 1.2.3.9, also on port TCP/22. The original systems have also started sending data to this new IP address now that the previous address has been blocked.</p>&#13;
<ul class="BL">&#13;
<li class="BL">What actions can (and should) be taken to contain the incident now that the issue appears to be spreading rapidly?</li>&#13;
<li class="BL">If information technology determines that specific containment steps are appropriate, are there limitations on shutting down certain systems that may impact restaurant operations at Dave’s Crazy Donuts? Is there a documented approval process the team must undergo before taking action on those systems?</li>&#13;
<li class="BL">Should the incident be escalated, either internally or externally?</li>&#13;
<li class="BL">Who in the organization can investigate the suspicious files? Alternatively, should a third party come in to investigate these files? If consulting with a third party, does the organization have an incident response firm on retainer or know whom to contact?</li>&#13;
<li class="BL">Are there threat intelligence sources the organization can consult to better understand the malicious files or IP addresses in use?</li>&#13;
<li class="BL">Is it possible to identify the contents of the SSH connection?</li>&#13;
</ul>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec20">&#13;
<h5 class="H3"><span id="sec20"/><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 3</span></h5>&#13;
<p class="TNI">CISA and Microsoft release a joint advisory on malware spreading at a rapid pace, dubbed ROBber. According to the report, the malware drops several files on the system, including a remote access trojan and a keystroke logger.</p>&#13;
<p class="TX">The hashes of the files have been included in the advisory. CISA advises that organizations block traffic to specific network blocks and disable internal versions of IIS up to and including version 10. Systems can be brought back online only after being patched or, if infected, completing specific remediation steps.</p>&#13;
<p class="TX">The malware also creates a logfile of the collected keystrokes in a temporary folder.</p>&#13;
<ul class="BL">&#13;
<li class="BL">How can the organization determine if the malware released in the advisory is the same malware affecting its systems?</li>&#13;
<li class="BL"><span role="doc-pagebreak" epub:type="pagebreak" id="pg_129" aria-label="129"/>How quickly can the organization determine whether these IoCs exist on the network? How long would this process take?</li>&#13;
<li class="BL">Given that the files were found at eight different restaurant locations scattered across a geographic area, is the organization able to quickly investigate the systems?</li>&#13;
<li class="BL">How would the technical team understand the business implications of disabling IIS services? What alternatives could the team enact to ensure operational continuity? How long would it take to implement those contingencies?</li>&#13;
<li class="BL">Legal has instructed information security to preserve the keystroke logging files in case sensitive data was captured and exfiltrated. Is this possible, and if so, what is the impact on the response efforts?</li>&#13;
<li class="BL">Are there network logs that may have recorded the exfiltration of the files containing the keystrokes?</li>&#13;
</ul>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec21">&#13;
<h5 class="H3"><span id="sec21"/><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 4</span></h5>&#13;
<p class="TNI">A quick review of the IoCs in the advisory confirms Dave’s Crazy Donuts has been compromised by ROBber. Current web servers, including the main e-commerce site, are running IIS 8.5 and are all impacted by the malware. Additional systems have been infected as well.</p>&#13;
<ul class="BL">&#13;
<li class="BL">Given that the main e-commerce site runs many aspects of the business, including enabling customers to place orders and pick them up from their local store, would the organization disconnect the site from the internet temporarily to contain the incident? Who can authorize an action that impacts the business, and is this option technically feasible?</li>&#13;
<li class="BL">If the authorized decision-maker prefers to not impact restaurant operations, how would this incident be contained?</li>&#13;
</ul>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec22">&#13;
<h5 class="H3"><span id="sec22"/><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 5</span></h5>&#13;
<p class="TNI">It’s been 24 hours since the outbreak began, and the incident appears to have been contained. No new infections have occurred, and a review of the keystroke logger’s logfiles shows that it hasn’t captured anything business critical or sensitive. The CEO asks for a timeline for getting all the restaurants back to full operation.</p>&#13;
<ul class="BL">&#13;
<li class="BL">Who certifies that the incident has been fully remediated and that restoration activities can begin?</li>&#13;
<li class="BL">How will the company begin restoring systems to a known good state? In what order, and by whom?</li>&#13;
<li class="BL">Does the organization have additional resources (internal or external) that can aid in the restoration process?</li>&#13;
<li class="BL">How long will it realistically take to restore the systems at the various Dave’s Crazy Donuts locations? Do the systems have defined recovery time objectives?</li>&#13;
</ul>&#13;
</section>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec23">&#13;
<span role="doc-pagebreak" epub:type="pagebreak" id="pg_130" aria-label="130"/>&#13;
<h4 class="H2"><span id="sec23"/><span id="h-139"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Possible Modifications</span></h4>&#13;
<p class="TNI">To adapt the scenario, consider making the following modifications:</p>&#13;
<ul class="BL">&#13;
<li class="BL">Rather than a zero-day vulnerability, the initial access vector is a phishing email, a drive-by download, an infected USB, or something else.</li>&#13;
<li class="BL">The malware impacts a greater number of systems or targets other systems that may be particularly sensitive.</li>&#13;
<li class="BL">The timing of the injections differs; for example, the organization first discovers anomalous traffic during routine baseline checks.</li>&#13;
<li class="BL">Keystroke logfiles include sensitive information or customer data.</li>&#13;
<li class="BL">The internet-bound network traffic occurs via TCP/80 or TCP/443.</li>&#13;
<li class="BL">The investigation produces different IoCs than those contained in the CISA advisories, raising the question of whether the organization should share that information and, if so, how.</li>&#13;
</ul>&#13;
</section>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec24">&#13;
<h3 class="H1" id="sec24"><span id="h-140"/><span class="SANS_Futura_Std_Bold_B_11">A Supply Chain Compromise</span></h3>&#13;
<p class="TNI">Compared to other cybersecurity incidents, the 2020 SolarWinds compromise was unique. SolarWinds was responsible for distributing software updates for products being used in organizations across the globe, so it had an established, trusted relationship with systems in those organizations’ networks. Threat actors leveraged that trust to distribute malicious code to unsuspecting organizations, a type of attack known as a <i>supply chain attack</i>.</p>&#13;
<p class="TX">After the SolarWinds incident, organizations began assessing if and how they could verify the safety of software provided by third parties. The compromise also garnered considerable interest from governments due to its national security implications. One well-placed attack had impacted thousands of SolarWinds clients, including government agencies.</p>&#13;
<p class="TX">The following scenario imagines that a fictitious company experiences a supply chain attack via its endpoint detection and response (EDR) provider. We highly recommend modifying this scenario to involve a product currently in use in your organization’s environment. As with the previous scenario, consider the current threat landscape and modify the scenario accordingly.</p>&#13;
<section epub:type="division" aria-labelledby="sec25">&#13;
<h4 class="H2"><span id="sec25"/><span id="h-141"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">The Scenario</span></h4>&#13;
<p class="TNI">Endpoint protection company NoMoreBadStuff (NMBS) supplies EDR solutions to organizations across the globe. NMBS monitors approximately 10 percent of all the workstations in Fortune 500 companies with its NMBS EDR endpoint. A state-sponsored threat group, APT39, has gained access to NMBS’s network and compromised the latest release of the EDR tool, which has been pushed to the majority of NMBS’s clients.</p>&#13;
<p class="TX">In the introduction to the exercise, NMBS releases an advisory indicating that APT39 has compromised its build process and inserted malicious code. The compromise is limited to version 19.3 of the EDR. NMBS has since released version 19.4, which removes the malicious code, and has <span role="doc-pagebreak" epub:type="pagebreak" id="pg_131" aria-label="131"/>issued an emergency patching advisory stating that the update should be installed without delay.</p>&#13;
<p class="TX">Superior Automotive Parts, a large automotive parts manufacturer and distributor, is running NMBS’s EDR tool on all its Windows endpoints (including servers). The company quickly becomes aware of the issue via social media.</p>&#13;
<ul class="BL">&#13;
<li class="BL">How often does Superior Automotive Parts review advisories? How long would it take to act upon such a notification? Are relevant staff notified of such alerts?</li>&#13;
<li class="BL">How can the response team gain more insight into APT39’s tactics, techniques, and procedures?</li>&#13;
<li class="BL">Is it possible to inventory all systems within Superior Automotive Parts running the vulnerable version? How long would this take?</li>&#13;
<li class="BL">Should the update be rolled out immediately? How can the organization determine if the new version is safe?</li>&#13;
<li class="BL">Until the update is rolled out onto impacted systems, should each system be disconnected from the network? If the systems are disconnected, will this impact the update process?</li>&#13;
</ul>&#13;
<section epub:type="division" aria-labelledby="sec26">&#13;
<h5 class="H3"><span id="sec26"/><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 1</span></h5>&#13;
<p class="TNI">NMBS releases additional information indicating that the malicious version created rules in the security platform to ignore APT39’s toolset, enable other potentially malicious activities, and silence related alerts. Immediately following the initial installation and a time delay of 90 minutes, the compromised EDR software installs the SEAWEED backdoor on the system and connects to IP address 2.4.3.4, indicating that SEAWEED is ready for connections from threat actors.</p>&#13;
<p class="TX">At this time, Superior Automotive Parts is unaware of any malicious activities on its systems.</p>&#13;
<ul class="BL">&#13;
<li class="BL">What does the organization do with this new information from NMBS?</li>&#13;
<li class="BL">Who will investigate the environment for the backdoor? What about the callback to 2.4.3.4?</li>&#13;
<li class="BL">How long are network logs available for? Is there a stated policy for log retention?</li>&#13;
<li class="BL">Does this new information change how the organization plans to proceed?</li>&#13;
<li class="BL">Is this a cybersecurity incident, as defined by the organization’s incident response plan?</li>&#13;
<li class="BL">Who needs to be notified?</li>&#13;
</ul>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec27">&#13;
<h5 class="H3"><span id="sec27"/><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 2</span></h5>&#13;
<p class="TNI">A review of network logs for the last 30 days shows that several of Superior Automotive Parts’ systems have connected to the IP address 2.4.3.4. The <span role="doc-pagebreak" epub:type="pagebreak" id="pg_132" aria-label="132"/>connections occurred just two days after version 19.3 (the malicious version) was installed on all systems. Additional connections have occurred periodically since then, most recently this morning.</p>&#13;
<ul class="BL">&#13;
<li class="BL">Does this new revelation change the severity of the incident?</li>&#13;
<li class="BL">Does this latest information change the course of action agreed upon during the scenario’s introduction?</li>&#13;
<li class="BL">How will the organization contain this incident?</li>&#13;
</ul>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec28">&#13;
<h5 class="H3"><span id="sec28"/><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 3</span></h5>&#13;
<p class="TNI">Further review of network logs shows a large exfiltration of data from internal IP 192.168.4.5 over FTP. This exfiltration occurred three days ago at 5:24 <small>AM</small>.</p>&#13;
<ul class="BL">&#13;
<li class="BL">What is this system, and what data resides on it?</li>&#13;
<li class="BL">How can evidence be captured on this system?</li>&#13;
<li class="BL">Does the organization have the resources to collect a full disk image and memory dump from the system?</li>&#13;
<li class="BL">Does the organization need to maintain a chain of custody?</li>&#13;
<li class="BL">Is it possible to determine what data was exfiltrated?</li>&#13;
<li class="BL">Was FTP previously blocked outbound? If so, how was this traffic allowed?</li>&#13;
</ul>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec29">&#13;
<h5 class="H3"><span id="sec29"/><span class="SANS_Futura_Std_Bold_Condensed_B_11">Inject 4</span></h5>&#13;
<p class="TNI">The CEO has requested “all hands on deck” to quickly roll out the newest version of NMBS, rebuild systems, and get the organization back online. They are requesting an ETA on this effort. In total, 43 systems have communicated with the IP address 2.4.3.4: 16 servers and 27 endpoints.</p>&#13;
<ul class="BL">&#13;
<li class="BL">What is the protocol for reestablishing the trust of hosts known to be compromised? Will the systems be cleaned up or restored from trusted sources?</li>&#13;
<li class="BL">Based on the circumstances, what personnel does Superior Automotive Parts have to support patching the systems, removing malicious software and connections, or rebuilding systems?</li>&#13;
<li class="BL">Does the organization have the personnel for around-the-clock coverage to support remediation efforts?</li>&#13;
<li class="BL">Does Superior Automotive Parts work with vendors that could provide supplemental personnel on an emergency basis?</li>&#13;
<li class="BL">Based on the number of impacted systems, what is the anticipated time for recovery? How are systems prioritized?</li>&#13;
<li class="BL">Should passwords be reset globally? Will this include domain admins and service accounts?</li>&#13;
<li class="BL">Has a global password reset ever occurred or been tested?</li>&#13;
</ul>&#13;
</section>&#13;
</section>&#13;
<section epub:type="division" aria-labelledby="sec30">&#13;
<span role="doc-pagebreak" epub:type="pagebreak" id="pg_133" aria-label="133"/>&#13;
<h4 class="H2"><span id="sec30"/><span id="h-142"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Possible Modifications</span></h4>&#13;
<p class="TNI">To adapt the scenario, consider making the following modifications:</p>&#13;
<ul class="BL">&#13;
<li class="BL">The threat actor is an actual adversary targeting your specific industry vertical or actively exploiting organizations at the time of the tabletop exercise.</li>&#13;
<li class="BL">The organization determines that no data exfiltration occurred.</li>&#13;
<li class="BL">The organization is not under active exploitation but does have the compromised software installed.</li>&#13;
<li class="BL">This supply chain compromise affected a close business partner, which you could involve in the tabletop exercise.</li>&#13;
<li class="BL">The IP addresses, ports, and services are specific to critical assets for your organization.</li>&#13;
<li class="BL">The organization relies on a key vendor to support remediation efforts, and the vendor is unable to commit to a restoration timeline.</li>&#13;
</ul>&#13;
</section>&#13;
</section>&#13;
</section>&#13;
</div>
</div>
</body></html>