<html><head></head><body>
<div id="sbo-rt-content"><section aria-labelledby="ch25" epub:type="chapter" role="doc-chapter">
<span aria-label="475" epub:type="pagebreak" id="pg_475" role="doc-pagebreak"/>
<hgroup>
<h2 class="CHAPTER" id="ch25">
<span class="CN"><span class="SANS_Futura_Std_Bold_Condensed_B_11">25</span></span>
<span class="CT"><span class="SANS_Dogma_OT_Bold_B_11">STATIC METHODS, PROPERTIES, AND ENUMERATIONS</span></span>
</h2>
</hgroup>
<figure class="opener"><img alt="" class="opener" height="380" src="../images/opener.jpg" width="380"/>
</figure>
<p class="INTRO">In this chapter, we’ll explore <i>static members</i>. Unlike the instance-level properties and methods we’ve been using so far, which are accessible through the individual objects of a class, static properties and methods are accessed through the class as a whole. As such, you don’t have to create an object of a class to use its static members.</p>
<p class="TX">We’ll discuss how to work with static members and illustrate their usefulness in situations such as storing information about all the instances of a class or sharing resources across an entire application. We’ll also touch on enumerations, which provide a way to list all possible values for a data type.</p>
<section aria-labelledby="sec1" epub:type="division">
<h3 class="H1" id="sec1"><span id="toc-link_328"/><span class="SANS_Futura_Std_Bold_B_11">Storing Class-Wide Information</span></h3>
<p class="TNI1">One common use of static members is to keep track of information about all instances of a class. This is handy when a message needs to be sent to <span aria-label="476" epub:type="pagebreak" id="pg_476" role="doc-pagebreak"/>all objects of a class, or when a calculation must be based on just the class’s current instances. Consider the <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> class diagrammed in <a href="#fig25-1">Figure 25-1</a>.</p>
<figure class="IMG"><a id="fig25-1"/><img alt="" class="img100" height="745" src="../images/figure25-1.jpg" width="1656"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 25-1: An</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">AudioClip</span> <span class="SANS_Futura_Std_Book_Oblique_11">class with static members</span></p></figcaption>
</figure>
<p class="TX">The <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> class has instance members for storing details about a given audio file. These are the <span class="SANS_TheSansMonoCd_W5Regular_11">title</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">durationSeconds</span> properties, with their associated getters and setters. The constructor and <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method are instance members as well, since they pertain to creating or summarizing the contents of a particular object. Meanwhile, the class has a <span class="SANS_TheSansMonoCd_W5Regular_11">maxClipDurationSeconds</span> property that tracks the longest duration of any <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> objects that have been created. This is a good use of a static member (indicated by underlining in the diagram), since the property holds information pertaining to all the objects of the class. The property’s getter method should also be static.</p>
<p class="TX">To see how static members are useful for storing class-wide information, we’ll declare the <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> class and create three instances of it. The diagram shows how each instance will have its own values for the <span class="SANS_TheSansMonoCd_W5Regular_11">title</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">durationSeconds</span> properties. For example, <span class="SANS_TheSansMonoCd_W5Regular_11">clip1</span> will have a <span class="SANS_TheSansMonoCd_W5Regular_11">title</span> of <span class="SANS_TheSansMonoCd_W5Regular_11">'Hello World'</span> and a <span class="SANS_TheSansMonoCd_W5Regular_11">durationSeconds</span> of <span class="SANS_TheSansMonoCd_W5Regular_11">2</span>.</p>
<p class="TX">Create a new project folder and add the usual <i>composer.json</i> file declaring that <span class="SANS_TheSansMonoCd_W5Regular_11">Mattsmithdev</span> namespaced classes are located in the <i>src</i> folder. Generate the autoloader file by entering <span class="SANS_TheSansMonoCd_W7Bold_11">composer dump-autoload</span> at the command line. Then declare the <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> class by creating <i>src/AudioClip.php</i> and entering the contents of <a href="#lis25-1">Listing 25-1</a>.</p>
<span id="lis25-1"/>
<pre><code>&lt;?php&#13;
namespace Mattsmithdev;&#13;
&#13;
class AudioClip&#13;
{&#13;
    // --- Static (per-class) members ---&#13;
  <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> private static int $maxClipDurationSeconds = -1;&#13;
&#13;
<span aria-label="477" epub:type="pagebreak" id="pg_477" role="doc-pagebreak"/>  <span aria-label="annotation2" class="Code_CodeAnnotation">❷</span> public static function getMaxClipDurationSeconds(): int&#13;
    {&#13;
        return self::$maxClipDurationSeconds;&#13;
    }&#13;
&#13;
    // --- Object (instance) members ---&#13;
  <span aria-label="annotation3" class="Code_CodeAnnotation">❸</span> private string $title;&#13;
    private int $durationSeconds = 0;&#13;
&#13;
  <span aria-label="annotation4" class="Code_CodeAnnotation">❹</span> public function __construct(string $title, int $durationSeconds)&#13;
    {&#13;
        $this-&gt;setTitle($title);&#13;
        $this-&gt;setDurationSeconds($durationSeconds);&#13;
    }&#13;
&#13;
    public function getTitle(): string&#13;
    {&#13;
        return $this-&gt;title;&#13;
    }&#13;
&#13;
    public function setTitle(string $title): void&#13;
    {&#13;
        $this-&gt;title = $title;&#13;
    }&#13;
&#13;
    public function getDurationSeconds(): int&#13;
    {&#13;
        return $this-&gt;durationSeconds;&#13;
    }&#13;
&#13;
  <span aria-label="annotation5" class="Code_CodeAnnotation">❺</span> public function setDurationSeconds(int $durationSeconds): void&#13;
    {&#13;
        // Exit with no action if negative&#13;
        if ($durationSeconds &lt; 0) return;&#13;
&#13;
        $this-&gt;durationSeconds = $durationSeconds;&#13;
&#13;
        if ($durationSeconds &gt; self::$maxClipDurationSeconds) {&#13;
            self::$maxClipDurationSeconds = $durationSeconds;&#13;
        }&#13;
    }&#13;
&#13;
  <span aria-label="annotation6" class="Code_CodeAnnotation">❻</span> public function __toString(): string&#13;
    {&#13;
        return "(AudioClip) $this-&gt;title ($this-&gt;durationSeconds seconds) \n";&#13;
    }&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 25-1: The</span> <span class="TheSansMonoCd_W5Regular_Italic_11">AudioClip</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p>
<p class="TX">We declare <span class="SANS_TheSansMonoCd_W5Regular_11">maxClipDurationSeconds</span> by using the <span class="SANS_TheSansMonoCd_W5Regular_11">static</span> keyword to specify that this is a static member that exists independent of any objects of the <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> class <span aria-label="annotation1" class="CodeAnnotation">❶</span>. We initialize it to <span class="SANS_TheSansMonoCd_W5Regular_11">-1</span>, ensuring that whatever the duration of the first <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> object to be created, its duration will be greater than <span class="SANS_TheSansMonoCd_W5Regular_11">-1</span> <span aria-label="478" epub:type="pagebreak" id="pg_478" role="doc-pagebreak"/>and so will be stored in this static property. We’ll see how this is done later, as part of the <span class="SANS_TheSansMonoCd_W5Regular_11">setDurationSeconds()</span> setter method.</p>
<p class="TX">We set <span class="SANS_TheSansMonoCd_W5Regular_11">maxClipDurationSeconds</span> to be private, but we declare a public getter method, <span class="SANS_TheSansMonoCd_W5Regular_11">getMaxClipDurationSeconds()</span>, which is also static <span aria-label="annotation2" class="CodeAnnotation">❷</span>. Making this method public allows code inside and outside the class to query the value of the longest <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> object that’s been created since the program or request has been running. We’ll explore what this implies and how this property is used shortly.</p>
<p class="TX">We next declare two instance-level properties for each <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> object, <span class="SANS_TheSansMonoCd_W5Regular_11">title</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">durationSeconds</span> <span aria-label="annotation3" class="CodeAnnotation">❸</span>, with a default value of <span class="SANS_TheSansMonoCd_W5Regular_11">0</span> for the latter to ensure that it’s set even if an invalid argument is provided at construction. The class’s constructor method <span aria-label="annotation4" class="CodeAnnotation">❹</span> takes in initial values for these two properties and sets them in the object by invoking the appropriate setters.</p>
<p class="TX">The instance-level accessor methods are all straightforward, save for <span class="SANS_TheSansMonoCd_W5Regular_11">setDurationSeconds()</span>, which has custom validation logic <span aria-label="annotation5" class="CodeAnnotation">❺</span>. A clip’s duration should never be negative, so we first test for this and use <span class="SANS_TheSansMonoCd_W5Regular_11">return</span> to halt execution of the method with no further action if a negative value is provided. If we make it past that point, we know the provided argument is <span class="SANS_TheSansMonoCd_W5Regular_11">0</span> or positive, so we store it in the object’s <span class="SANS_TheSansMonoCd_W5Regular_11">durationSeconds</span> property.</p>
<p class="TX">Then we check whether the object’s new duration is greater than the value stored in the <span class="SANS_TheSansMonoCd_W5Regular_11">maxClipDurationSeconds</span> static property. If it is, we update this property to equal the new duration. Since <span class="SANS_TheSansMonoCd_W5Regular_11">maxClipDurationSeconds</span> starts off with a sentinel value of <span class="SANS_TheSansMonoCd_W5Regular_11">-1</span>, and because of our validation at the beginning of the method, we know that no <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> objects will ever have a negative duration. Therefore, as soon as the first clip has been created with a valid duration, this static property will be set accordingly.</p>
<p class="TX">Notice that we have to use <span class="SANS_TheSansMonoCd_W5Regular_11">self::</span> to access the <span class="SANS_TheSansMonoCd_W5Regular_11">maxClipDurationSeconds</span> property. This <i>scope resolution operator</i> (<span class="SANS_TheSansMonoCd_W5Regular_11">::</span>) is the syntax for accessing a static member from within the same class.</p>
<p class="TX">We complete the declaration of the class with the <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method <span aria-label="annotation6" class="CodeAnnotation">❻</span>. It returns a string summarizing an <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> object’s contents, in the form <span class="SANS_TheSansMonoCd_W5Regular_11">(AudioClip)</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">title</span> <span class="SANS_TheSansMonoCd_W5Regular_11">(</span><span class="SANS_TheSansMonoCd_W5Regular_Italic_11">durationSeconds</span> <span class="SANS_TheSansMonoCd_W5Regular_11">seconds)</span>.</p>
<p class="TX">Now let’s put our class to work through an index script that creates <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> objects and outputs the changing value of the static <span class="SANS_TheSansMonoCd_W5Regular_11">maxClip DurationSeconds</span> property. Create <i>public/index.php</i> as shown in <a href="#lis25-2">Listing 25-2</a>.</p>
<span id="lis25-2"/>
<pre><code>&lt;?php&#13;
require_once __DIR__ . '/../vendor/autoload.php';&#13;
&#13;
use Mattsmithdev\AudioClip;&#13;
&#13;
print '- Max AudioClip duration so far = '&#13;
    . AudioClip::getMaxClipDurationSeconds() . PHP_EOL;&#13;
&#13;
$clip1 = new AudioClip('hello world', 2);&#13;
print $clip1;&#13;
&#13;
print '- Max AudioClip duration so far = '&#13;
    . AudioClip::getMaxClipDurationSeconds() . PHP_EOL;&#13;
&#13;
<span aria-label="479" epub:type="pagebreak" id="pg_479" role="doc-pagebreak"/>$clip2 = new AudioClip('bad duration', -10);&#13;
print $clip2;&#13;
&#13;
print '- Max AudioClip duration so far = '&#13;
    . AudioClip::getMaxClipDurationSeconds() . PHP_EOL;&#13;
&#13;
$clip3 = new AudioClip('My Way', 275);&#13;
print $clip3;&#13;
&#13;
print '- Max AudioClip duration so far = '&#13;
    . AudioClip::getMaxClipDurationSeconds() . PHP_EOL;</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 25-2: The</span> <span class="SANS_Futura_Std_Book_11">index.php</span> <span class="SANS_Futura_Std_Book_Oblique_11">script</span></p>
<p class="TX">First, we print a message displaying the value of <span class="SANS_TheSansMonoCd_W5Regular_11">maxClipDurationSeconds</span>, accessed via the public static <span class="SANS_TheSansMonoCd_W5Regular_11">getMaxClipDurationSeconds()</span> method. Since we haven’t yet instantiated any <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> objects, the property should still have its initial value of <span class="SANS_TheSansMonoCd_W5Regular_11">-1</span>. Notice that we have to prefix the static member’s name with <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip::</span> rather than <span class="SANS_TheSansMonoCd_W5Regular_11">self::</span>, since we’re writing this code from the index script and not from within the static members’ class. We then create three <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> objects, <span class="SANS_TheSansMonoCd_W5Regular_11">$clip1</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">$clip2</span>, and <span class="SANS_TheSansMonoCd_W5Regular_11">$clip3</span>, printing each one and then displaying the value of <span class="SANS_TheSansMonoCd_W5Regular_11">maxClipDurationSeconds</span> again.</p>
<p class="TX">Here’s the output of running the index script:</p>
<pre><code>- Max AudioClip duration so far = -1&#13;
(AudioClip) hello world (2 seconds)&#13;
- Max AudioClip duration so far = 2&#13;
(AudioClip) bad duration (0 seconds)&#13;
- Max AudioClip duration so far = 2&#13;
(AudioClip) My Way (275 seconds)&#13;
- Max AudioClip duration so far = 275</code></pre>
<p class="TX">The max duration starts with a value of <span class="SANS_TheSansMonoCd_W5Regular_11">-1</span>, but each time an <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> object with a nonnegative duration is created, this value is updated if the new clip is the longest, through the logic in the <span class="SANS_TheSansMonoCd_W5Regular_11">setDurationSeconds()</span> method. After creating the <span class="SANS_TheSansMonoCd_W5Regular_11">hello world</span> object, the max duration goes from <span class="SANS_TheSansMonoCd_W5Regular_11">-1</span> to <span class="SANS_TheSansMonoCd_W5Regular_11">2</span>. The value doesn’t change after the <span class="SANS_TheSansMonoCd_W5Regular_11">bad duration</span> object is created with an invalid duration of <span class="SANS_TheSansMonoCd_W5Regular_11">-10</span>. (Notice from the object’s printout that its duration is stored as <span class="SANS_TheSansMonoCd_W5Regular_11">0</span>, the default value, rather than <span class="SANS_TheSansMonoCd_W5Regular_11">-10</span>, thanks to our initial validation logic in the <span class="SANS_TheSansMonoCd_W5Regular_11">setDurationSeconds()</span> method.) Finally, after creating the <span class="SANS_TheSansMonoCd_W5Regular_11">My Way</span> object, the max duration is updated to <span class="SANS_TheSansMonoCd_W5Regular_11">275</span>.</p>
<p class="TX">Our logic for updating <span class="SANS_TheSansMonoCd_W5Regular_11">maxClipDurationSeconds</span> has worked well for demonstration purposes, but it isn’t actually a good way to keep track of the longest <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> object, since it assumes that all the objects exist for the entire run of the application. Say we decide that we no longer want one of the audio clips (the user might choose to delete it from a list). Our current logic provides no way to roll back the maximum clip duration if that clip is deleted. A better approach might be to have an array of active <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> objects. Each time a clip is removed, we could then loop through the array and recalculate the duration of the longest active clip.</p>
</section>
<section aria-labelledby="sec2" epub:type="division">
<span aria-label="480" epub:type="pagebreak" id="pg_480" role="doc-pagebreak"/>
<h3 class="H1" id="sec2"><span id="toc-link_329"/><span class="SANS_Futura_Std_Bold_B_11">Static Properties vs. Class Constants</span></h3>
<p class="TNI1">Static properties aren’t to be confused with class constants. In both cases, only one copy of the static property or class constant exists on the class itself, rather than a separate copy on each instance of the class. However, class constants are immutable, so their value never changes. By contrast, the value of a static property can change (as you saw with <span class="SANS_TheSansMonoCd_W5Regular_11">maxClipDurationSeconds</span>), just like the value of an ordinary property of an object. In this sense, the term <i>static</i> can be a bit misleading. All PHP object-oriented properties, whether they’re per-object instance properties or per-class static properties, begin with a dollar sign, which distinguishes them from constants.</p>
<p class="TX">Use a class constant when you have a value that should apply to all objects of a class and should never change. We’ve met class constants previously; one example is the <span class="SANS_TheSansMonoCd_W5Regular_11">PATH_TO_TEMPLATES</span> constant used to create the <span class="SANS_TheSansMonoCd_W5Regular_11">Twig\Environment</span> object for templating. In this case, the filepath to the templates folder should never change and would apply equally to any and all <span class="SANS_TheSansMonoCd_W5Regular_11">Twig\Environment</span> objects. Other uses of a class constant include defining special values, like setting the maximum score for a school grade point average (GPA) to <span class="SANS_TheSansMonoCd_W5Regular_11">4.0</span> or the neutral value for the pH acidity scale to <span class="SANS_TheSansMonoCd_W5Regular_11">7.0</span>.</p>
<p class="TX">In the case of our <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> class, we might have class constants defining details like the number of channels or the sampling rate of the audio files, on the assumption that these will be standard across all audio clips. To explore the difference between class constants and static properties, we’ll add some class constants to our <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> project now. <a href="#fig25-2">Figure 25-2</a> shows an updated diagram of the <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> class.</p>
<figure class="IMG"><a id="fig25-2"/><img alt="" class="img100" height="773" src="../images/figure25-2.jpg" width="1679"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 25-2: Adding class constants and an extra method to the</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">AudioClip</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p></figcaption>
</figure>
<p class="TX">The diagram shows that the <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> class will now offer four public class constants, which are indicated as <span class="SANS_TheSansMonoCd_W5Regular_11">{read-only}</span> in class diagrams. For our project, we’ll make some assumptions about the audio clips that the class represents: they’ll all be stereo (two channels) and store 16 bits per sample <span aria-label="481" epub:type="pagebreak" id="pg_481" role="doc-pagebreak"/>(CD-quality digital audio). The number of samples per second will always be 44,100, which is a common audio sampling rate. These values are indicated by the <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> class constants <span class="SANS_TheSansMonoCd_W5Regular_11">NUM_CHANNELS</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">BITS_PER_SAMPLE</span>, and <span class="SANS_TheSansMonoCd_W5Regular_11">SAMPLES_PER _SECOND</span>, and together they’re used to calculate the <span class="SANS_TheSansMonoCd_W5Regular_11">BITS_PER_SECOND</span> constant.</p>
<blockquote>
<p class="Note"><span class="SANS_Dogma_OT_Bold_B_15">NOTE</span></p>
</blockquote>
<p class="NOTE-TXT"><i>For a more realistic example, these constants could be replaced by instance properties, since not all audio clips may conform to the standard laid out by the constants.</i></p>
<p class="TX">We’ll also add a new <span class="SANS_TheSansMonoCd_W5Regular_11">getSizeBits()</span> method that uses the class constants to calculate the number of bits required to store the audio clip in memory or on disk. Additionally, we’ll include the value from this new method as part of the object summary returned by the <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method.</p>
<p class="TX">To implement all these changes, edit the <i>src/AudioClip.php</i> file as shown in <a href="#lis25-3">Listing 25-3</a>.</p>
<span id="lis25-3"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">namespace Mattsmithdev;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">class AudioClip</span>&#13;
{&#13;
    const NUM_CHANNELS = 2;&#13;
&#13;
    const BITS_PER_SAMPLE = 16;&#13;
&#13;
    const SAMPLES_PER_SECOND = 44100;&#13;
&#13;
    const BITS_PER_SECOND = self::NUM_CHANNELS&#13;
        * self::BITS_PER_SAMPLE * self::SAMPLES_PER_SECOND;&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Italic_11">--snip--</span>&#13;
&#13;
    public function getSizeBits(): int&#13;
    {&#13;
        return self::BITS_PER_SECOND * $this-&gt;durationSeconds;&#13;
    }&#13;
&#13;
  <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> <span class="TheSansMonoCd_W5Regular_Grey_11">public function __toString(): string</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
        $numBitsFormatted = number_format($this-&gt;getSizeBits());&#13;
        return "(AudioClip) $this-&gt;title "&#13;
            . "($this-&gt;durationSeconds seconds), $numBitsFormatted bits \n";&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">}</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 25-3: Adding constants and the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">getSizeBits()</span> <span class="SANS_Futura_Std_Book_Oblique_11">method to the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">AudioClip</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p>
<p class="TX">It’s common to list constants first when declaring a class, before any properties and methods, so we begin the <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> class by declaring the constants <span class="SANS_TheSansMonoCd_W5Regular_11">NUM_CHANNELS</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">BITS_PER_SAMPLE</span>, and <span class="SANS_TheSansMonoCd_W5Regular_11">SAMPLES_PER_SECOND</span>, with the values described previously. Then we declare <span class="SANS_TheSansMonoCd_W5Regular_11">BITS_PER_SECOND</span>, which is an example of a <i>calculated constant</i> since its value is determined based on the values of the other constants rather than being set directly. By precalculating this <span aria-label="482" epub:type="pagebreak" id="pg_482" role="doc-pagebreak"/>value and storing it as a constant, we avoid having to repeat the calculation every time we need to convert from seconds of audio to bits of data. Notice the use of <span class="SANS_TheSansMonoCd_W5Regular_11">self::</span> to access the other constants in the <span class="SANS_TheSansMonoCd_W5Regular_11">BITS_PER_SECOND</span> calculation. This syntax applies to accessing class constants from within the class, just as it does to accessing static members.</p>
<p class="TX">Next, we declare <span class="SANS_TheSansMonoCd_W5Regular_11">getSizeBits()</span>, a useful extra getter method for each <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> object. It returns an integer representing the number of bits required to store the audio clip, found by multiplying the precalculated <span class="SANS_TheSansMonoCd_W5Regular_11">BITS _PER_SECOND</span> constant by the object’s <span class="SANS_TheSansMonoCd_W5Regular_11">durationSeconds</span> property. We also update the <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method <span aria-label="annotation1" class="CodeAnnotation">❶</span>, summarizing an <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> object’s contents including its size in bits, thanks to our new method. Notice that we use the built-in <span class="SANS_TheSansMonoCd_W5Regular_11">number_format()</span> function to create a temporary <span class="SANS_TheSansMonoCd_W5Regular_11">$numBitsFormatted</span> string variable. With the function’s default settings, this creates a more readable representation of the number with a comma separator every three digits.</p>
<p class="TX">Here’s the terminal output of running the index script again (no changes to the index script are needed):</p>
<pre><code>- Max AudioClip duration so far = -1&#13;
(AudioClip) hello world (2 seconds), 2,822,400 bits&#13;
- Max AudioClip duration so far = 2&#13;
(AudioClip) bad duration (0 seconds), 0 bits&#13;
- Max AudioClip duration so far = 2&#13;
(AudioClip) My Way (275 seconds), 388,080,000 bits&#13;
- Max AudioClip duration so far = 275</code></pre>
<p class="TX">Each <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> object printout now ends with the integer number of bits the clip data occupies, thanks to our class constants. Even for a two-second clip, over 2 million bits are needed (which is why we’ve formatted the number of bits with comma separators).</p>
</section>
<section aria-labelledby="sec3" epub:type="division">
<h3 class="H1" id="sec3"><span id="toc-link_330"/><span class="SANS_Futura_Std_Bold_B_11">Utility Classes with Static Members</span></h3>
<p class="TNI1">Static members may also be created as part of <i>utility classes</i>; these exist to help other classes do their work and aren’t used to create objects. A utility class’s static members might store helpful information or perform basic, general-purpose calculations that might have uses in other projects or other parts of the current project.</p>
<p class="TX">Continuing with our <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> example, let’s say we want to display the size of each audio clip in megabytes rather than bits. We’ll need a way to convert from bits to megabytes. We could refactor the <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> class’s <span class="SANS_TheSansMonoCd_W5Regular_11">getSizeBits()</span> method to make the necessary calculation. This calculation, along with supporting pieces of information such as the number of bits in a byte, is general enough that it might be useful to other, non-audio parts of the project or to other projects entirely. Therefore, locating the necessary code in a utility class makes sense.</p>
<p class="TX">We’ll create a utility class called <span class="SANS_TheSansMonoCd_W5Regular_11">SizeUtilities</span> to help the <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> class calculate memory size. Often, utility classes aren’t used to create objects, and this will be the case for <span class="SANS_TheSansMonoCd_W5Regular_11">SizeUtilities</span>. Since an object of this class will <span aria-label="483" epub:type="pagebreak" id="pg_483" role="doc-pagebreak"/>never be instantiated, we’ll declare <span class="SANS_TheSansMonoCd_W5Regular_11">SizeUtilities</span> as <span class="SANS_TheSansMonoCd_W5Regular_11">abstract</span>. By extension, since there will never be a <span class="SANS_TheSansMonoCd_W5Regular_11">SizeUtilities</span> object, all the class’s members need to be accessible through the class as a whole. That is, <span class="SANS_TheSansMonoCd_W5Regular_11">SizeUtilities</span> must consist of class-level constants and static members. <a href="#fig25-3">Figure 25-3</a> shows a diagram of the modified <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> class and the new <span class="SANS_TheSansMonoCd_W5Regular_11">SizeUtilities</span> utility class.</p>
<figure class="IMG"><a id="fig25-3"/><img alt="" class="img100" height="1039" src="../images/figure25-3.jpg" width="1674"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 25-3: A class diagram of</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">AudioClip</span> <span class="SANS_Futura_Std_Book_Oblique_11">and</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">SizeUtilities</span> <span class="SANS_Futura_Std_Book_Oblique_11">demonstrating static methods and properties</span></p></figcaption>
</figure>
<p class="TX">The <span class="SANS_TheSansMonoCd_W5Regular_11">SizeUtilities</span> class offers three public class constants indicated as <span class="SANS_TheSansMonoCd_W5Regular_11">{read-only}</span> in the diagram: <span class="SANS_TheSansMonoCd_W5Regular_11">BITS_PER_BYTE</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">BYTES_PER_KILOBYTE</span>, and <span class="SANS_TheSansMonoCd_W5Regular_11">BITS_PER _MEGABYTE</span>. These will be useful for calculating file sizes. The class also offers a public static method called <span class="SANS_TheSansMonoCd_W5Regular_11">bitsToMegaBytes()</span> that takes in a number of bits as a parameter and returns the corresponding number of megabytes to a given number of decimal places (or two by default). Meanwhile, the <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> class declares a new <span class="SANS_TheSansMonoCd_W5Regular_11">getSizeMegaBytes()</span> method that returns a float representing the memory required for the clip in megabytes, with the help of the <span class="SANS_TheSansMonoCd_W5Regular_11">SizeUtilities</span> class. Notice that the <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> class also has a modified <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method that includes the file size in megabytes in the object summary.</p>
<p class="TX">Let’s declare the <span class="SANS_TheSansMonoCd_W5Regular_11">SizeUtilities</span> class. Create <i>src/SizeUtilities.php</i> containing the code in <a href="#lis25-4">Listing 25-4</a>.</p>
<span id="lis25-4"/>
<pre><code>&lt;?php&#13;
namespace Mattsmithdev;&#13;
&#13;
abstract class SizeUtilities&#13;
{&#13;
    const BITS_PER_BYTE = 8;&#13;
<span aria-label="484" epub:type="pagebreak" id="pg_484" role="doc-pagebreak"/>    const BYTES_PER_KILOBTYE = 1024;&#13;
    const BITS_PER_MEGABTYE =&#13;
        self::BITS_PER_BYTE * self::BYTES_PER_KILOBTYE * 1024;&#13;
&#13;
    public static function bitsToMegaBytes(int $bits): float&#13;
    {&#13;
        return $bits / self::BITS_PER_MEGABTYE;&#13;
    }&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 25-4: The</span> <span class="TheSansMonoCd_W5Regular_Italic_11">SizeUtilities</span> <span class="SANS_Futura_Std_Book_Oblique_11">class with constants and a static method</span></p>
<p class="TX">We declare <span class="SANS_TheSansMonoCd_W5Regular_11">SizeUtilities</span> as <span class="SANS_TheSansMonoCd_W5Regular_11">abstract</span>, since all members of this class are either constants or static. Its <span class="SANS_TheSansMonoCd_W5Regular_11">BITS_PER_BYTE</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">BYTES_PER_KILOBYTE</span> constants have values of <span class="SANS_TheSansMonoCd_W5Regular_11">8</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">1024</span>, respectively, and the <span class="SANS_TheSansMonoCd_W5Regular_11">BITS_PER_MEGABYTE</span> constant is calculated based on them. The class’s <span class="SANS_TheSansMonoCd_W5Regular_11">bitsToMegaBytes()</span> static method takes in a number of bits and divides it by the <span class="SANS_TheSansMonoCd_W5Regular_11">BITS_PER_MEGABYTE</span> constant to return the equivalent number of megabytes.</p>
<p class="TX">Next, update <i>src/AudioClip.php</i> as shown in <a href="#lis25-5">Listing 25-5</a>.</p>
<span id="lis25-5"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">namespace Mattsmithdev;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">class AudioClip</span>&#13;
{&#13;
<span class="TheSansMonoCd_W5Regular_Italic_11">--snip--</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    public function getSizeBits(): int</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        return self::BITS_PER_SECOND * $this-&gt;durationSeconds;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
&#13;
    public function getSizeMegaBytes(): float&#13;
    {&#13;
      <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> return SizeUtilities::bitsToMegaBytes($this-&gt;getSizeBits());&#13;
    }&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    public function __toString(): string 2</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
        $numMegaBytesFormatted = number_format($this-&gt;getSizeMegaBytes(), 2);&#13;
        return "(AudioClip) $this-&gt;title "&#13;
            . "($this-&gt;durationSeconds seconds), $numMegaBytesFormatted MB \n";&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">}</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 25-5: Updating the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">AudioClip</span> <span class="SANS_Futura_Std_Book_Oblique_11">class to use</span> <span class="TheSansMonoCd_W5Regular_Italic_11">SizeUtilities</span></p>
<p class="TX">We add the <span class="SANS_TheSansMonoCd_W5Regular_11">getSizeMegaBytes()</span> method, which returns a float representing the size of the <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> object in megabytes. The method gets the size in bits and passes it to the public static <span class="SANS_TheSansMonoCd_W5Regular_11">bitsToMegaBytes()</span> method declared in our <span class="SANS_TheSansMonoCd_W5Regular_11">SizeUtilities</span> class <span aria-label="annotation1" class="CodeAnnotation">❶</span>. This is a good example of how to use public static methods in other classes: we don’t have to create an object of the <span class="SANS_TheSansMonoCd_W5Regular_11">SizeUtilities</span> <span aria-label="485" epub:type="pagebreak" id="pg_485" role="doc-pagebreak"/>class in order to use its public static method. Instead, we simply write <span class="SANS_TheSansMonoCd_W5Regular_11">SizeUtilities::</span> followed by the name of the method.</p>
<p class="TX">In the new <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method, we create a temporary <span class="SANS_TheSansMonoCd_W5Regular_11">$numMegaBytesFormatted</span> variable holding the clip size in megabytes, formatted as a string with two decimal places. We then include the value of this variable as part of the string returned by the method. Once again, we don’t need to make any changes to the index script to test our updates, since we’re still using <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> to output information. Here’s the terminal output of the updates:</p>
<pre><code>- Max AudioClip duration so far = -1&#13;
(AudioClip) hello world (2 seconds), 0.34 MB&#13;
- Max AudioClip duration so far = 2&#13;
(AudioClip) bad duration (0 seconds), 0 MB&#13;
- Max AudioClip duration so far = 2&#13;
(AudioClip) My Way (275 seconds), 46.26 MB&#13;
- Max AudioClip duration so far = 275</code></pre>
<p class="TX">The size of each <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> object is now given in megabytes. Our new utility class has successfully helped the <span class="SANS_TheSansMonoCd_W5Regular_11">AudioClip</span> class make the necessary bits-to-megabytes conversions through its static method and class constants.</p>
</section>
<section aria-labelledby="sec4" epub:type="division">
<h3 class="H1" id="sec4"><span id="toc-link_331"/><span class="SANS_Futura_Std_Bold_B_11">Sharing Resources Across an Application</span></h3>
<p class="TNI1">Another use of static methods is to offer a functionality (such as reading from or writing to a database, or appending messages to a logfile) to all parts of a software system, without each part of the system needing to duplicate the required setup code. The idea is to create an abstract class with static methods that do the necessary legwork, like establishing a database connection or setting up a logger and log handler. Then you can call those static methods from anywhere in your code whenever you need that functionality. This makes processes like logging or working with a database connection quite straightforward.</p>
<p class="TX">To illustrate how this works, let’s create a project that allows logging from anywhere in the system just by writing something like this:</p>
<pre><code>Logger::debug('my message');</code></pre>
<p class="BodyContinued">For this to work, we’ll need a <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class with a public static <span class="SANS_TheSansMonoCd_W5Regular_11">debug()</span> method that can be invoked from anywhere in the system. This method will handle the mechanics of the logging process so that the other parts of the system don’t have to.</p>
<p class="TX">Start a new project folder and create the usual <i>composer.json</i> file to autoload the <span class="SANS_TheSansMonoCd_W5Regular_11">Mattsmithdev</span> namespaced classes. Then enter this command at the command line to add the Monolog library to the project:</p>
<pre><code>$ <b>composer require monolog/monolog</b></code></pre>
<p class="BodyContinued"><span aria-label="486" epub:type="pagebreak" id="pg_486" role="doc-pagebreak"/>Since we have a <i>composer.json</i> file, Composer will also generate the autoloader scripts at this step, in addition to loading the Monolog library. All the relevant files will be in your project’s <i>vendor</i> directory.</p>
<p class="TX">Next, create a custom <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class in <i>src/Logger.php</i> as shown in <a href="#lis25-6">Listing 25-6</a>.</p>
<span id="lis25-6"/>
<pre><code>&lt;?php&#13;
namespace Mattsmithdev;&#13;
&#13;
<span aria-label="annotation1" class="codeannotated_CodeAnnotation">❶</span> use Monolog\Logger as MonologLogger;&#13;
use Monolog\Handler\StreamHandler;&#13;
&#13;
abstract class Logger&#13;
{&#13;
    const PATH_TO_LOG_FILE = __DIR__ . '/../logs/debug.log';&#13;
&#13;
  <span aria-label="annotation2" class="Code_CodeAnnotation">❷</span> public static function debug(string $message): void&#13;
    {&#13;
        $logger = new MonologLogger('channel1');&#13;
        $logger-&gt;pushHandler(new StreamHandler(self::PATH_TO_LOG_FILE));&#13;
        $logger-&gt;debug($message);&#13;
    }&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 25-6: The</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Logger</span> <span class="SANS_Futura_Std_Book_Oblique_11">class with a public static logging method</span></p>
<p class="TX">We declare our <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class in the <span class="SANS_TheSansMonoCd_W5Regular_11">Mattsmithdev</span> namespace to avoid a naming collision with the Monolog library’s <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class and designate it as <span class="SANS_TheSansMonoCd_W5Regular_11">abstract</span> since we won’t ever need to instantiate it. The <span class="SANS_TheSansMonoCd_W5Regular_11">use</span> statements allow us to refer to the necessary Monolog classes in our code without having to write fully qualified namespaces. Notice that we alias Monolog’s <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class as <span class="SANS_TheSansMonoCd_W5Regular_11">MonologLogger</span> to better differentiate it from our own class <span aria-label="annotation1" class="CodeAnnotation">❶</span>.</p>
<p class="TX">Inside the class, we create a constant for the filepath to <i>logs/debug.log</i>. Then we declare <span class="SANS_TheSansMonoCd_W5Regular_11">debug()</span> as a public static method that takes a <span class="SANS_TheSansMonoCd_W5Regular_11">$message</span> string parameter <span aria-label="annotation2" class="CodeAnnotation">❷</span>. The method creates a new <span class="SANS_TheSansMonoCd_W5Regular_11">MonologLogger</span> object for <span class="SANS_TheSansMonoCd_W5Regular_11">channel1</span> and assigns it a log handler for writing to the debug logfile, then uses the Monolog class’s <span class="SANS_TheSansMonoCd_W5Regular_11">debug()</span> method to log <span class="SANS_TheSansMonoCd_W5Regular_11">$message</span> to the logfile.</p>
<p class="TX">Now create an index script in <i>public/index.php</i> containing the code in <a href="#lis25-7">Listing 25-7</a>.</p>
<span id="lis25-7"/>
<pre><code>&lt;?php&#13;
require_once __DIR__ . '/../vendor/autoload.php';&#13;
use Mattsmithdev\Application;&#13;
$app = new Application();&#13;
$app-&gt;run();</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 25-7: Creating an</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Application</span> <span class="SANS_Futura_Std_Book_Oblique_11">object in</span> <span class="SANS_Futura_Std_Book_11">index.php</span></p>
<p class="TX">We read in and execute the Composer-generated autoloader, create an object of the <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class, and invoke its <span class="SANS_TheSansMonoCd_W5Regular_11">run()</span> method. This is the same basic pattern for the index script of an object-oriented web application that we discussed in <span class="Xref"><a href="chapter21.xhtml">Chapter 21</a></span>.</p>
<p class="TX"><span aria-label="487" epub:type="pagebreak" id="pg_487" role="doc-pagebreak"/>Finally, declare the <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class in <i>src/Application.php</i> as shown in <a href="#lis25-8">Listing 25-8</a>. The class includes code for logging messages via our <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class’s static method.</p>
<span id="lis25-8"/>
<pre><code>&lt;?php&#13;
namespace Mattsmithdev;&#13;
&#13;
class Application&#13;
{&#13;
    public function run(): void&#13;
    {&#13;
        print 'Hello, world!';&#13;
        Logger::debug('Hello, world! printed out');&#13;
        Logger::debug('another log message');&#13;
    }&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 25-8: The</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Application</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p>
<p class="TX">In the <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class’s <span class="SANS_TheSansMonoCd_W5Regular_11">run()</span> method, we print out a <span class="SANS_TheSansMonoCd_W5Regular_11">'Hello, world!'</span> message. Then we invoke the static <span class="SANS_TheSansMonoCd_W5Regular_11">debug()</span> method of our <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class to log messages to the debug logfile. Notice that we don’t need to create a <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> object or include any setup code (such as declaring a path to the logfile or creating a log handler) in the <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class itself; everything is handled by the static method we defined on the <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class. If the <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> classes were in different namespaces, all we’d need to do is add a <span class="SANS_TheSansMonoCd_W5Regular_11">use</span> statement or fully qualify the class when using it, like this:</p>
<pre><code>Mattsmithdev\Logger::debug('Hello, world! printed out');</code></pre>
<p class="TX">We can confirm that the two messages have been appended to the logfile by viewing the contents of <i>logs/debug.log</i> after running the index script. Remember to use the <span class="SANS_TheSansMonoCd_W5Regular_11">cat</span> command (macOS and Unix) or <span class="SANS_TheSansMonoCd_W5Regular_11">type</span> (Windows), as discussed in <span class="Xref"><a href="chapter24.xhtml">Chapter 24</a></span>. You should see something like this:</p>
<pre><code>$ <b>cat debug.log</b>&#13;
[2025-01-30T10:49:54.516974 + 00:00]&#13;
channel1.DEBUG: Hello, world! printed out [] []&#13;
&#13;
[2025-01-30T10:49:54.519278 + 00:00]&#13;
channel1.DEBUG: another log message [] []</code></pre>
<p class="TX">We’ve successfully used our static method to append messages to the logfile. If we wanted, we could add optional arguments to this method to change the name and location of the logfile, log to different channels, or provide a context array such as an <span class="SANS_TheSansMonoCd_W5Regular_11">Exception</span> object. This basic example has illustrated generally how a class can offer a single static method to make it easy for any part of a software system to utilize its functionality.</p>
</section>
<section aria-labelledby="sec5" epub:type="division">
<span aria-label="488" epub:type="pagebreak" id="pg_488" role="doc-pagebreak"/>
<h3 class="H1" id="sec5"><span id="toc-link_332"/><span class="SANS_Futura_Std_Bold_B_11">Saving Resources with the Singleton Pattern</span></h3>
<p class="TNI1">The approach we used in the preceding section to share resources across an application can work in many situations, but in some cases, such as creating a connection to a database or setting up a mailing or file-writing object, the static method’s task takes up enough time and memory to impair the application’s performance. In cases like these, an object-oriented design technique called the <i>singleton pattern</i> can help conserve computing resources while still making an operation available throughout an application.</p>
<p class="TX">Take a look back the last section of <a href="#lis25-6">Listing 25-6</a>, where we declared our <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class. According to our definition of the static <span class="SANS_TheSansMonoCd_W5Regular_11">debug()</span> method, a new <span class="SANS_TheSansMonoCd_W5Regular_11">MonologLogger</span> object and a new <span class="SANS_TheSansMonoCd_W5Regular_11">StreamHandler</span> object will be created each time the method is invoked to log a debug message. In our application’s <span class="SANS_TheSansMonoCd_W5Regular_11">run()</span> method in <a href="#lis25-8">Listing 25-8</a>, we invoked this method twice, so four objects were created to log the two messages, which is a bit wasteful. When operations are resource expensive, a more efficient approach is to perform them once and then <i>cache</i> (store) the created resources for future use. The singleton pattern is one way of doing this.</p>
<p class="TX">The singleton pattern declares a class with a private constructor, along with logic to ensure that, at most, we create only one object of the class. The class offers a public static method named <span class="SANS_TheSansMonoCd_W5Regular_11">getInstance()</span> that returns a reference to the single instance of the class. If no instance exists, one is created the first time the <span class="SANS_TheSansMonoCd_W5Regular_11">getInstance()</span> method is invoked. Otherwise, the class caches, or keeps a record of, the single instance, so it can be returned again the next time <span class="SANS_TheSansMonoCd_W5Regular_11">getInstance()</span> is called.</p>
<p class="TX">Anytime you need to use the singleton class, you’d write something like this from anywhere in your code:</p>
<pre><code>$myObject = Singleton::getInstance();</code></pre>
<p class="BodyContinued">This stores a reference to the sole instance of the singleton class in the <span class="SANS_TheSansMonoCd_W5Regular_11">$myObject</span> variable. You can then use the <span class="SANS_TheSansMonoCd_W5Regular_11">Singleton</span> class’s resources through the <span class="SANS_TheSansMonoCd_W5Regular_11">$myObject</span> reference. <a href="#lis25-9">Listing 25-9</a> shows the typical skeleton for singleton-style classes.</p>
<span id="lis25-9"/>
<pre><code>&lt;?php&#13;
class Singleton&#13;
{&#13;
    private static ?Singleton $instance = NULL;&#13;
&#13;
    private function __construct()&#13;
    {&#13;
        // -- Do the resource-expensive work here --&#13;
    }&#13;
&#13;
    public static function getInstance(): Singleton&#13;
    {&#13;
      <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> if (self::$instance == NULL)&#13;
        {&#13;
<span aria-label="489" epub:type="pagebreak" id="pg_489" role="doc-pagebreak"/>          <span aria-label="annotation2" class="Code_CodeAnnotation">❷</span> self::$instance = new Singleton();&#13;
        }&#13;
&#13;
        return self::$instance;&#13;
    }&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 25-9: The</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Singleton</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p>
<p class="TX">We declare a private static property called <span class="SANS_TheSansMonoCd_W5Regular_11">instance</span>, initializing it to <span class="SANS_TheSansMonoCd_W5Regular_11">NULL</span>. Ultimately, this property will hold a reference to the only object of the singleton class. Then we declare a private constructor method where any resource-hungry work can be completed. Since the constructor has been declared as private, it can’t be invoked with the <span class="SANS_TheSansMonoCd_W5Regular_11">new</span> keyword from anywhere outside the class itself.</p>
<p class="TX">Next, we declare the only public member of this class, the static <span class="SANS_TheSansMonoCd_W5Regular_11">getInstance()</span> method. This method first tests whether the <span class="SANS_TheSansMonoCd_W5Regular_11">instance</span> is <span class="SANS_TheSansMonoCd_W5Regular_11">NULL</span> <span aria-label="annotation1" class="CodeAnnotation">❶</span>. If so, this must be the first time that this method has been invoked, so a new <span class="SANS_TheSansMonoCd_W5Regular_11">Singleton</span> object is created (which calls the constructor, triggering the resource-heavy work), and the reference to the new object is stored in the static <span class="SANS_TheSansMonoCd_W5Regular_11">instance</span> property <span aria-label="annotation2" class="CodeAnnotation">❷</span>. Then the method returns the object reference in <span class="SANS_TheSansMonoCd_W5Regular_11">instance</span>, making the object available for use elsewhere in the application.</p>
<p class="TX">Let’s modify the previous section’s project to save computing resources by using the singleton pattern. This way, we’ll have to create the <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> object and log handler only once, no matter how many messages we log. We’ll also make our application more flexible by making our custom <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class a subclass of Monolog’s <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class so that we can use any of the latter’s methods and optional arguments (for example, to provide context data and to log at different severity levels through the inherited methods).</p>
<p class="TX">First, update the declaration of the <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class in <i>src/Logger.php</i> to match <a href="#lis25-10">Listing 25-10</a>. This redesigned class is closely modeled on the skeletal <span class="SANS_TheSansMonoCd_W5Regular_11">Singleton</span> class demonstrated in <a href="#lis25-9">Listing 25-9</a>.</p>
<span id="lis25-10"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">namespace Mattsmithdev;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">use Monolog\Logger as MonologLogger;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">use Monolog\Handler\StreamHandler;</span>&#13;
&#13;
<span aria-label="annotation1" class="codeannotated_CodeAnnotation">❶</span> class Logger extends MonologLogger&#13;
{&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    const PATH_TO_LOG_FILE = __DIR__ . '/../logs/debug.log';</span>&#13;
&#13;
    private static ?Logger $instance = NULL;&#13;
&#13;
    private function __construct()&#13;
    {&#13;
        parent::__construct('channel1');&#13;
        $this-&gt;pushHandler(new StreamHandler(self::PATH_TO_LOG_FILE));&#13;
    }&#13;
&#13;
<span aria-label="490" epub:type="pagebreak" id="pg_490" role="doc-pagebreak"/>  <span aria-label="annotation2" class="Code_CodeAnnotation">❷</span> public static function getInstance(): Logger&#13;
    {&#13;
        if (self::$instance == NULL)&#13;
        {&#13;
            self::$instance = new Logger();&#13;
        }&#13;
&#13;
        return self::$instance;&#13;
    }&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 25-10: Implementing the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Logger</span> <span class="SANS_Futura_Std_Book_Oblique_11">class with the singleton pattern</span></p>
<p class="TX">We declare our <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class as a subclass of the Monolog <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class (aliased as <span class="SANS_TheSansMonoCd_W5Regular_11">MonoLogger</span>) <span aria-label="annotation1" class="CodeAnnotation">❶</span>. Since we’ll be creating one instance of this class, we no longer declare it to be <span class="SANS_TheSansMonoCd_W5Regular_11">abstract</span>. Next, we initialize the private static <span class="SANS_TheSansMonoCd_W5Regular_11">instance</span> property to <span class="SANS_TheSansMonoCd_W5Regular_11">NULL</span> and declare a private constructor. The constructor uses <span class="SANS_TheSansMonoCd_W5Regular_11">parent::</span> to call the Monolog <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class’s constructor, creating a new object with <span class="SANS_TheSansMonoCd_W5Regular_11">channel1</span>, then assigns it a log handler to the debug logfile. Since all this is encapsulated within the private constructor, it will happen only once.</p>
<p class="TX">We also declare the public static <span class="SANS_TheSansMonoCd_W5Regular_11">getInstance()</span> method, typical for singleton classes <span aria-label="annotation2" class="CodeAnnotation">❷</span>. The method follows the logic described in <a href="#lis25-9">Listing 25-9</a>, creating and returning a <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> object if <span class="SANS_TheSansMonoCd_W5Regular_11">instance</span> is <span class="SANS_TheSansMonoCd_W5Regular_11">NULL</span>, or simply returning the instance if it’s been created already.</p>
<p class="TX">Now let’s update the <span class="SANS_TheSansMonoCd_W5Regular_11">run()</span> method of our <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class. We’ll obtain a reference to the single instance of our <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class, then use that object reference to log some entries. Modify <i>src/Application.php</i> to match <a href="#lis25-11">Listing 25-11</a>.</p>
<span id="lis25-11"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">namespace Mattsmithdev;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">class Application</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">{</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    public function run(): void</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        print 'Hello, world!';</span>&#13;
        Logger::getInstance()-&gt;warning('I am a warning.');&#13;
        Logger::getInstance()-&gt;error('I am a test error!',&#13;
            ['exception' =&gt; new \Exception('example of exception object')]);&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">}</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 25-11: The</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Application</span> <span class="SANS_Futura_Std_Book_Oblique_11">class updated to use our singleton</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Logger</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p>
<p class="TX">We get a reference to the singleton instance of <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> by writing <span class="SANS_TheSansMonoCd_W5Regular_11">Logger::getInstance()</span> and use it to log a warning-severity message <span class="SANS_TheSansMonoCd_W5Regular_11">via</span> the <span class="SANS_TheSansMonoCd_W5Regular_11">warning()</span> method inherited from the Monolog <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class. Since this is the first attempt to get the singleton instance, the <span class="SANS_TheSansMonoCd_W5Regular_11">instance</span> property of our <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class will be <span class="SANS_TheSansMonoCd_W5Regular_11">NULL</span>, and a new <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> object will be created and a reference to it saved in <span class="SANS_TheSansMonoCd_W5Regular_11">instance</span>.</p>
<p class="TX">Then we again get a reference to the singleton instance of <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> and log an error-severity message, creating and passing a second parameter of <span aria-label="491" epub:type="pagebreak" id="pg_491" role="doc-pagebreak"/>a new <span class="SANS_TheSansMonoCd_W5Regular_11">Exception</span> object as the context. This time, the <span class="SANS_TheSansMonoCd_W5Regular_11">instance</span> property of <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> isn’t <span class="SANS_TheSansMonoCd_W5Regular_11">NULL</span>, so the reference to the existing object is returned. In this way, both logs have been created by a single instance of the <span class="SANS_TheSansMonoCd_W5Regular_11">Logger</span> class, saving time and resources while still making the logging functionality available anywhere in the application.</p>
<p class="TX">Use the <span class="SANS_TheSansMonoCd_W5Regular_11">cat</span> or <span class="SANS_TheSansMonoCd_W5Regular_11">type</span> command to view the contents of <i>logs/debug.log</i> after running the index script. You should see something like this:</p>
<pre><code>$ <b>cat debug.log</b>&#13;
[2025-01-30T14:37:32.728758 + 00:00]&#13;
channel1.WARNING: I am a warning. [] []&#13;
&#13;
[2025-01-30T14:37:32.730002 + 00:00]&#13;
channel1.ERROR: I am a test error! {"exception":"[object]&#13;
(Exception(code: 0): example of exception object&#13;
    at /Users/matt/src/Application.php:13)"} []</code></pre>
<p class="BodyContinued">Both messages were successfully appended to the logfile, including the <span class="SANS_TheSansMonoCd_W5Regular_11">Exception</span> object context data added to the error-level log entry.</p>
<p class="TX">You’ve seen how the singleton pattern can be useful. However, many programmers consider it an <i>antipattern</i>, a solution to a common problem that ends up being worse than the problem it’s attempting to solve. Critics of the singleton pattern object to it being a form of global program state, which makes testing code more difficult since code using the singleton can’t be tested separately from the singleton itself. Also, the singleton has <i>global visibility</i>, meaning that any code in an application might be dependent on it. More complex code analysis is therefore needed to determine which parts of an application are or aren’t dependent on the globally visible singleton. On the other hand, proponents argue that the reduction in resource usage is enough to outweigh some overhead in testing or the design of other parts of the application.</p>
</section>
<section aria-labelledby="sec6" epub:type="division">
<h3 class="H1" id="sec6"><span id="toc-link_333"/><span class="SANS_Futura_Std_Bold_B_11">Enumerations</span></h3>
<p class="TNI1">To <i>enumerate</i> is to list out every possibility, one by one, and in computer programming, an <i>enumeration</i> is a list of all the possible values for a data type. A good example of an enumerated data type is <span class="SANS_TheSansMonoCd_W5Regular_11">bool</span>, which lists its only two possible values as <span class="SANS_TheSansMonoCd_W5Regular_11">true</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">false</span>. Booleans are built into the language, but since version 8.1, PHP allows you to create and use your own custom enumerations, also known as <i>enum classes</i>.</p>
<p class="TX">Enum classes are useful when you have data items that can take only one of a closed set of values. For example, a pizza order can be designated as being for delivery or pickup, an employee’s work status can be full-time or part-time, and a playing card’s suit can be hearts, diamonds, clubs, or spades. While you could use a Boolean property when you have only two potential values (for example, <span class="SANS_TheSansMonoCd_W5Regular_11">$fullTime = false</span>), enum classes are more appropriate when you have more than two possibilities. Even for just two possible values, defining them through an enum class makes the choice more explicit.</p>
<p class="TX"><span aria-label="492" epub:type="pagebreak" id="pg_492" role="doc-pagebreak"/>Inside an enum class, you declare each of the possible cases for that class, where each case is an object of the class. For example, you might have a playing card <span class="SANS_TheSansMonoCd_W5Regular_11">Suit</span> enum class with possible cases <span class="SANS_TheSansMonoCd_W5Regular_11">HEARTS</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">DIAMONDS</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">CLUBS</span>, and <span class="SANS_TheSansMonoCd_W5Regular_11">SPADES</span>. To reference the cases of an enum class, you use the same double-colon syntax (the scope resolution operator) as when using a static member or class constant (for example, <span class="SANS_TheSansMonoCd_W5Regular_11">$card1Suit = Suit::SPADES</span>).</p>
<p class="TX">Because of this shared syntax, enum classes bear some relationship to static members and class constants. The key difference is that each case of an enum class is a proper <i>object</i> of that class, whereas class constants and static properties and methods are <i>members</i> of a class. Crucially, this means that enum classes can serve as the data types for properties of other classes, and for function parameters and return values.</p>
<p class="TX">As a simple example, <a href="#lis25-12">Listing 25-12</a> shows the declaration of an enum class for the suits of a deck of playing cards. Declare this enum class in a file called <i>Suit.php</i>, just like an ordinary class declaration file.</p>
<span id="lis25-12"/>
<pre><code>&lt;?php&#13;
namespace Mattsmithdev;&#13;
&#13;
enum Suit&#13;
{&#13;
    case CLUBS;&#13;
    case DIAMONDS;&#13;
    case HEARTS;&#13;
    case SPADES;&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 25-12: The</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Suit</span> <span class="SANS_Futura_Std_Book_Oblique_11">enum class</span></p>
<p class="TX">After the namespace, we use the <span class="SANS_TheSansMonoCd_W5Regular_11">enum</span> keyword followed by the class name <span class="SANS_TheSansMonoCd_W5Regular_11">Suit</span>. Then we declare four cases for this enum class, representing the four playing card suits. Because the enumeration cases serve a similar function as class constants (that is, defining fixed values), I tend to write them in all capital letters, although many programmers capitalize only the first letter of each case.</p>
<p class="TX">We can now assign an object of the <span class="SANS_TheSansMonoCd_W5Regular_11">Suit</span> enum class to a variable. To illustrate, <a href="#lis25-13">Listing 25-13</a> shows a simple <span class="SANS_TheSansMonoCd_W5Regular_11">Card</span> class that harnesses the <span class="SANS_TheSansMonoCd_W5Regular_11">Suit</span> enum.</p>
<span id="lis25-13"/>
<pre><code>&lt;?php&#13;
namespace Mattsmithdev;&#13;
&#13;
class Card&#13;
{&#13;
  <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> private Suit $suit;&#13;
    private int $number;&#13;
&#13;
    public function getSuit(): Suit&#13;
    {&#13;
        return $this-&gt;suit;&#13;
    }&#13;
&#13;
<span aria-label="493" epub:type="pagebreak" id="pg_493" role="doc-pagebreak"/>    public function setSuit(Suit $suit): void&#13;
    {&#13;
        $this-&gt;suit = $suit;&#13;
    }&#13;
&#13;
    public function getNumber(): int&#13;
    {&#13;
        return $this-&gt;number;&#13;
    }&#13;
&#13;
    public function setNumber(int $number): void&#13;
    {&#13;
        $this-&gt;number = $number;&#13;
    }&#13;
&#13;
  <span aria-label="annotation2" class="Code_CodeAnnotation">❷</span> public function __toString(): string&#13;
    {&#13;
        return "CARD: the " . $this-&gt;number . " of " . $this-&gt;suit-&gt;name;&#13;
    }&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 25-13: The</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Card</span> <span class="SANS_Futura_Std_Book_Oblique_11">class with a</span> <span class="TheSansMonoCd_W5Regular_Italic_11">suit</span> <span class="SANS_Futura_Std_Book_Oblique_11">property that uses the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Suit</span> <span class="SANS_Futura_Std_Book_Oblique_11">enum class</span></p>
<p class="TX">We first declare <span class="SANS_TheSansMonoCd_W5Regular_11">suit</span> as a property of the <span class="SANS_TheSansMonoCd_W5Regular_11">Suit</span> data type <span aria-label="annotation1" class="CodeAnnotation">❶</span>. Again, since enums are considered classes, they can be used as valid data types. We also give the class a <span class="SANS_TheSansMonoCd_W5Regular_11">number</span> property, and we provide simple getters and setters for both <span class="SANS_TheSansMonoCd_W5Regular_11">suit</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">number</span>. Then we declare a <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method to output the details of the <span class="SANS_TheSansMonoCd_W5Regular_11">Card</span> object’s properties <span aria-label="annotation2" class="CodeAnnotation">❷</span>. In it, we get a string version of the enum object’s name from its <span class="SANS_TheSansMonoCd_W5Regular_11">name</span> property, accessed with the expression <span class="SANS_TheSansMonoCd_W5Regular_11">$this-&gt;suit-&gt;name</span>.</p>
<p class="TX">Listing 25-14 shows a simple index script to demonstrate the use of the <span class="SANS_TheSansMonoCd_W5Regular_11">Suit</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">Card</span> classes.</p>
<span id="lis25-14"/>
<pre><code>&lt;?php&#13;
require_once __DIR__ . '/../vendor/autoload.php';&#13;
&#13;
use Mattsmithdev\Suit;&#13;
use Mattsmithdev\Card;&#13;
&#13;
$card1 = new Card();&#13;
<span aria-label="annotation1" class="codeannotated_CodeAnnotation">❶</span> $card1-&gt;setSuit(Suit::SPADES);&#13;
$card1-&gt;setNumber(1);&#13;
&#13;
print $card1;</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 25-14: Using</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Card</span> <span class="SANS_Futura_Std_Book_Oblique_11">and</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Suit</span> <span class="SANS_Futura_Std_Book_Oblique_11">in an index script</span></p>
<p class="TX">After providing <span class="SANS_TheSansMonoCd_W5Regular_11">use</span> statements for the two classes, we create a new <span class="SANS_TheSansMonoCd_W5Regular_11">Card</span> object and set its <span class="SANS_TheSansMonoCd_W5Regular_11">suit</span> property to be a reference to the <span class="SANS_TheSansMonoCd_W5Regular_11">SPADES</span> case of the <span class="SANS_TheSansMonoCd_W5Regular_11">Suit</span> enum class, using the double-colon <span class="SANS_TheSansMonoCd_W5Regular_11">Suit::SPADES</span> syntax to reference the case <span aria-label="annotation1" class="CodeAnnotation">❶</span>. We also set the <span class="SANS_TheSansMonoCd_W5Regular_11">number</span> of this <span class="SANS_TheSansMonoCd_W5Regular_11">Card</span> object to <span class="SANS_TheSansMonoCd_W5Regular_11">1</span> (representing an ace). <span aria-label="494" epub:type="pagebreak" id="pg_494" role="doc-pagebreak"/>Then we print the details of the <span class="SANS_TheSansMonoCd_W5Regular_11">$card1</span> variable, which will invoke its <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method. Here’s the output of running this index script:</p>
<pre><code>$ <b>php public/index.php</b>&#13;
CARD: the 1 of SPADES</code></pre>
<p class="BodyContinued">The output shows the <span class="SANS_TheSansMonoCd_W5Regular_11">number</span> property of <span class="SANS_TheSansMonoCd_W5Regular_11">1</span> and the string <span class="SANS_TheSansMonoCd_W5Regular_11">SPADES</span>, the name of the <span class="SANS_TheSansMonoCd_W5Regular_11">Suit</span> enum class referenced in the object’s <span class="SANS_TheSansMonoCd_W5Regular_11">suit</span> property.</p>
<section aria-labelledby="sec7" epub:type="division">
<h4 class="H2" id="sec7"><span id="toc-link_334"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Backed Enums</span></h4>
<p class="TNI1">Besides giving enum cases names like <span class="SANS_TheSansMonoCd_W5Regular_11">SPADES</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">HEARTS</span>, you can also associate an integer or string value with each case. When you give the cases values, the class is called a <i>value-backed enum</i>, or <i>backed enum</i> for short. The type of <span class="SANS_TheSansMonoCd_W5Regular_11">int</span> or <span class="SANS_TheSansMonoCd_W5Regular_11">string</span> must be declared after the enum class name, and every case must be assigned a value; otherwise, an error will occur.</p>
<p class="TX">Let’s turn <span class="SANS_TheSansMonoCd_W5Regular_11">Suit</span> into a backed enum by assigning a string value for each case. We could choose strings that exactly match the case names (<span class="SANS_TheSansMonoCd_W5Regular_11">'HEARTS'</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">'CLUBS'</span>, and so on), or we could have a bit of fun and assign strings with the corresponding card suit symbols. See <a href="#lis25-15">Listing 25-15</a> for the updated <span class="SANS_TheSansMonoCd_W5Regular_11">Suit</span> declaration.</p>
<span id="lis25-15"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">namespace Mattsmithdev;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">enum Suit:</span> string&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">{</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    case CLUBS</span> = '♣'<span class="TheSansMonoCd_W5Regular_Grey_11">;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    case DIAMONDS</span> = '♦'<span class="TheSansMonoCd_W5Regular_Grey_11">;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    case HEARTS</span> = '♥'<span class="TheSansMonoCd_W5Regular_Grey_11">;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    case SPADES</span> = '♠'<span class="TheSansMonoCd_W5Regular_Grey_11">;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">}</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 25-15: Turning</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Suit</span> <span class="SANS_Futura_Std_Book_Oblique_11">into a backed enum class</span></p>
<p class="TX">We declare <span class="SANS_TheSansMonoCd_W5Regular_11">Suit</span> as a string-backed enum by adding a colon and the <span class="SANS_TheSansMonoCd_W5Regular_11">string</span> type after the class name. Then we assign the string <span class="SANS_TheSansMonoCd_W5Regular_11">'</span>♣<span class="SANS_TheSansMonoCd_W5Regular_11">'</span> as the value for the <span class="SANS_TheSansMonoCd_W5Regular_11">CLUBS</span> case, as well as the corresponding symbols for the other three suits. To retrieve the value of a backed enum, use its public <span class="SANS_TheSansMonoCd_W5Regular_11">value</span> property. For example, if the <span class="SANS_TheSansMonoCd_W5Regular_11">$card1Suit</span> variable were a reference to a <span class="SANS_TheSansMonoCd_W5Regular_11">Suit</span> enum object, we’d get its string value with the expression <span class="SANS_TheSansMonoCd_W5Regular_11">$card1Suit-&gt;value</span>. These values are read-only; once they’re set in the enum class declaration, they can’t be changed from elsewhere in the code.</p>
</section>
<section aria-labelledby="sec8" epub:type="division">
<h4 class="H2" id="sec8"><span id="toc-link_335"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">An Array of All Cases</span></h4>
<p class="TNI1">All enum classes have a built-in static method called <span class="SANS_TheSansMonoCd_W5Regular_11">cases()</span> that returns an array of all the case objects for the enumeration. We can use this to build an array of the values associated with the cases. For example, <a href="#lis25-16">Listing 25-16</a> shows an index script that does just this by looping through each <span class="SANS_TheSansMonoCd_W5Regular_11">Suit</span> case object and appending its string value to an array for printout.</p>
<span id="lis25-16"/>
<pre><code><span aria-label="495" epub:type="pagebreak" id="pg_495" role="doc-pagebreak"/>&lt;?php&#13;
require_once __DIR__ . '/../vendor/autoload.php';&#13;
use Mattsmithdev\Suit;&#13;
&#13;
$cases = Suit::cases();&#13;
$caseStrings = [];&#13;
foreach ($cases as $case) {&#13;
    $caseStrings[] = $case-&gt;value;&#13;
}&#13;
print implode($caseStrings);</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 25-16: Creating an array of all</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Suit</span> <span class="SANS_Futura_Std_Book_Oblique_11">enum case values</span></p>
<p class="TX">We call the <span class="SANS_TheSansMonoCd_W5Regular_11">Suit::cases()</span> static method to obtain a <span class="SANS_TheSansMonoCd_W5Regular_11">$cases</span> array holding an instance of each possible <span class="SANS_TheSansMonoCd_W5Regular_11">Suit</span> case. Then we initialize <span class="SANS_TheSansMonoCd_W5Regular_11">$caseStrings</span> as an empty array. Next, we loop through the <span class="SANS_TheSansMonoCd_W5Regular_11">Suit</span> case objects in <span class="SANS_TheSansMonoCd_W5Regular_11">$cases</span> and append their string values to the <span class="SANS_TheSansMonoCd_W5Regular_11">$caseStrings</span> array. Finally, we print out the array of strings as a single string by using the built-in <span class="SANS_TheSansMonoCd_W5Regular_11">implode()</span> function. Here’s the output of running this index script at the command line:</p>
<pre><code>$ <b>php public/index.php</b>&#13;
♣♦♥♠</code></pre>
<p class="TX">All four suit characters have been printed out on the same line. Here we’ve simply printed out the case values, but we could use a similar looping technique to, for example, create a drop-down menu of all the case values from an enum class so that a user can select one of the options.</p>
</section>
</section>
<section aria-labelledby="sec9" epub:type="division">
<h3 class="H1" id="sec9"><span id="toc-link_336"/><span class="SANS_Futura_Std_Bold_B_11">Summary</span></h3>
<p class="TNI1">In this chapter, we explored static members of classes: properties and methods that aren’t related directly to individual objects but belong to the class as a whole. You saw how static members can be accessed within the class via <span class="SANS_TheSansMonoCd_W5Regular_11">self::</span> and outside the class via <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">ClassName</span><span class="SANS_TheSansMonoCd_W5Regular_11">::</span> (assuming the static member is public). You learned about uses of static members, including to record class-wide information, provide common methods through utility classes, and share functionality across an application, through either an abstract class or the singleton design pattern. We also discussed the related concepts of class constants and enumeration classes.</p>
</section>
<section aria-labelledby="sec10" epub:type="division">
<h3 class="H1" id="sec10"><span id="toc-link_337"/><span class="SANS_Futura_Std_Bold_B_11">Exercises</span></h3>
<p class="ListNumber">1.   Create a new project to implement a <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> class representing various cars. As shown in <a href="#fig25-4">Figure 25-4</a>, this class should have instance properties for <span class="SANS_TheSansMonoCd_W5Regular_11">make</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">model</span>, and <span class="SANS_TheSansMonoCd_W5Regular_11">price</span>, and a constructor taking in values for each instance property when a new object is created. You should also have private static properties for <span class="SANS_TheSansMonoCd_W5Regular_11">totalPrice</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">numInstances</span>.</p>
<span aria-label="496" epub:type="pagebreak" id="pg_496" role="doc-pagebreak"/>
<figure class="IMG"><a id="fig25-4"/><img alt="" class="img100" height="960" src="../images/figure25-4.jpg" width="1534"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 25-4: The</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">Car</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p></figcaption>
</figure>
<p class="ListBody">Each time a new <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> object is created, the constructor method should increment <span class="SANS_TheSansMonoCd_W5Regular_11">numInstances</span> and add the price of the new <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> object to <span class="SANS_TheSansMonoCd_W5Regular_11">totalPrice</span>.</p>
<p class="ListNumber">2.   Add a public static <span class="SANS_TheSansMonoCd_W5Regular_11">averagePrice()</span> method to the <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> class from Exercise 1 that uses the static <span class="SANS_TheSansMonoCd_W5Regular_11">numInstances</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">totalPrice</span> properties to calculate and return the average price of all <span class="SANS_TheSansMonoCd_W5Regular_11">Car</span> objects that have been created.</p>
<p class="ListNumber">3.   Create a new project featuring an enum class called <span class="SANS_TheSansMonoCd_W5Regular_11">DietType</span> with three cases: <span class="SANS_TheSansMonoCd_W5Regular_11">VEGAN</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">VEGETARIAN</span>, and <span class="SANS_TheSansMonoCd_W5Regular_11">CARNIVORE</span>. Also create a <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> class that has a <span class="SANS_TheSansMonoCd_W5Regular_11">name</span> property (a string) and a <span class="SANS_TheSansMonoCd_W5Regular_11">diet</span> property (a <span class="SANS_TheSansMonoCd_W5Regular_11">DietType</span> enum case), as well as a <span class="SANS_TheSansMonoCd_W5Regular_11">__toString()</span> method that summarizes the <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> object in the form <span class="SANS_TheSansMonoCd_W5Regular_11">'(DESSERT)</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">Dessert Name</span> <span class="SANS_TheSansMonoCd_W5Regular_11">(</span><span class="SANS_TheSansMonoCd_W5Regular_Italic_11">DietType</span> <span class="SANS_TheSansMonoCd_W5Regular_11">dish)'</span>. Write an index script that creates a <span class="SANS_TheSansMonoCd_W5Regular_11">Dessert</span> object and prints its details. The output should be something like this:</p>
<pre><code>(DESSERT) Eton Mess (VEGETARIAN dish)</code></pre>
</section>
</section>
</div></body></html>