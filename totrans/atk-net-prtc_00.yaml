- en: '**INTRODUCTION**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: When first introduced, the technology that allowed devices to connect to a network
    was exclusive to large companies and governments. Today, most people carry a fully
    networked computing device in their pocket, and with the rise of the Internet
    of Things (IoT), you can add devices such as your fridge and our home’s security
    system to this interconnected world. The security of these connected devices is
    therefore increasingly important. Although you might not be too concerned about
    someone disclosing the details of how many yogurts you buy, if your smartphone
    is compromised over the same network as your fridge, you could lose all your personal
    and financial information to a malicious attacker.
  prefs: []
  type: TYPE_NORMAL
- en: This book is named *Attacking Network Protocols* because to find security vulnerabilities
    in a network-connected device, you need to adopt the mind-set of the attacker
    who wants to exploit those weaknesses. Network protocols communicate with other
    devices on a network, and because these protocols must be exposed to a public
    network and often don’t undergo the same level of scrutiny as other components
    of a device, they’re an obvious attack target.
  prefs: []
  type: TYPE_NORMAL
- en: '**Why Read This Book?**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Many books discuss network traffic capture for the purposes of diagnostics and
    basic network analysis, but they don’t focus on the security aspects of the protocols
    they capture. What makes this book different is that it focuses on analyzing custom
    protocols to find security vulnerabilities.
  prefs: []
  type: TYPE_NORMAL
- en: This book is for those who are interested in analyzing and attacking network
    protocols but don’t know where to start. The chapters will guide you through learning
    techniques to capture network traffic, performing analysis of the protocols, and
    discovering and exploiting security vulnerabilities. The book provides background
    information on networking and network security, as well as practical examples
    of protocols to analyze.
  prefs: []
  type: TYPE_NORMAL
- en: Whether you want to attack network protocols to report security vulnerabilities
    to an application’s vendor or just want to know how your latest IoT device communicates,
    you’ll find several topics of interest.
  prefs: []
  type: TYPE_NORMAL
- en: '**What’s in This Book?**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'This book contains a mix of theoretical and practical chapters. For the practical
    chapters, I’ve developed and made available a networking library called Canape
    Core, which you can use to build your own tools for protocol analysis and exploitation.
    I’ve also provided an example networked application called *SuperFunkyChat*, which
    implements a user-to-user chat protocol. By following the discussions in the chapters,
    you can use the example application to learn the skills of protocol analysis and
    attack the sample network protocols. Here is a brief breakdown of each chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: '**[Chapter 1: The Basics of Networking](../Text/ch01.xhtml#ch01)**'
  prefs: []
  type: TYPE_NORMAL
- en: This chapter describes the basics of computer networking with a particular focus
    on TCP/IP, which forms the basis of application-level network protocols. Subsequent
    chapters assume that you have a good grasp of the network basics. This chapter
    also introduces the approach I use to model application protocols. The model breaks
    down the application protocol into flexible layers and abstracts complex technical
    detail, allowing you to focus on the bespoke parts of the protocol you’re analyzing.
  prefs: []
  type: TYPE_NORMAL
- en: '**[Chapter 2: Capturing Application Traffic](../Text/ch02.xhtml#ch02)**'
  prefs: []
  type: TYPE_NORMAL
- en: This chapter introduces the concepts of passive and active capture of network
    traffic, and it’s the first chapter to use the Canape Core network libraries for
    practical tasks.
  prefs: []
  type: TYPE_NORMAL
- en: '**[Chapter 3: Network Protocol Structures](../Text/ch03.xhtml#ch03)**'
  prefs: []
  type: TYPE_NORMAL
- en: This chapter contains details of the internal structures that are common across
    network protocols, such as the representation of numbers or human-readable text.
    When you’re analyzing captured network traffic, you can use this knowledge to
    quickly identify common structures, speeding up your analysis.
  prefs: []
  type: TYPE_NORMAL
- en: '**[Chapter 4: Advanced Application Traffic Capture](../Text/ch04.xhtml#ch04)**'
  prefs: []
  type: TYPE_NORMAL
- en: This chapter explores a number of more advanced capture techniques that complement
    the examples in [Chapter 2](../Text/ch02.xhtml#ch02). The advanced capture techniques
    include configuring Network Address Translation to redirect traffic of interest
    and spoofing the address resolution protocol.
  prefs: []
  type: TYPE_NORMAL
- en: '**[Chapter 5: Analysis from the Wire](../Text/ch05.xhtml#ch05)**'
  prefs: []
  type: TYPE_NORMAL
- en: This chapter introduces methods for analyzing captured network traffic using
    the passive and active techniques described in [Chapter 2](../Text/ch02.xhtml#ch02).
    In this chapter, we begin using the *SuperFunkyChat* application to generate example
    traffic.
  prefs: []
  type: TYPE_NORMAL
- en: '**[Chapter 6: Application Reverse Engineering](../Text/ch06.xhtml#ch06)**'
  prefs: []
  type: TYPE_NORMAL
- en: This chapter describes techniques for reverse engineering network-connected
    programs. Reverse engineering allows you to analyze a protocol without needing
    to capture example traffic. These methods also help to identify how custom encryption
    or obfuscation is implemented so you can better analyze traffic you’ve captured.
  prefs: []
  type: TYPE_NORMAL
- en: '**[Chapter 7: Network Protocol Security](../Text/ch07.xhtml#ch07)**'
  prefs: []
  type: TYPE_NORMAL
- en: This chapter provides background information on techniques and cryptographic
    algorithms used to secure network protocols. Protecting the contents of network
    traffic from disclosure or tampering as it travels over public networks is of
    the utmost importance for network protocol security.
  prefs: []
  type: TYPE_NORMAL
- en: '**[Chapter 8: Implementing the Network Protocol](../Text/ch08.xhtml#ch08)**'
  prefs: []
  type: TYPE_NORMAL
- en: This chapter explains techniques for implementing the application network protocol
    in your own code so you can test the protocol’s behavior to find security weaknesses.
  prefs: []
  type: TYPE_NORMAL
- en: '**[Chapter 9: The Root Causes of Vulnerabilities](../Text/ch09.xhtml#ch09)**'
  prefs: []
  type: TYPE_NORMAL
- en: This chapter describes common security vulnerabilities you’ll encounter in a
    network protocol. When you understand the root causes of vulnerabilities, you
    can more easily identify them during analysis.
  prefs: []
  type: TYPE_NORMAL
- en: '**[Chapter 10: Finding and Exploiting Security Vulnerabilities](../Text/ch10.xhtml#ch10)**'
  prefs: []
  type: TYPE_NORMAL
- en: This chapter describes processes for finding security vulnerabilities based
    on the root causes in [Chapter 9](../Text/ch09.xhtml#ch09) and demonstrates a
    number of ways of exploiting them, including developing your own shell code and
    bypassing exploit mitigations through return-oriented programming.
  prefs: []
  type: TYPE_NORMAL
- en: '**[Appendix: Network Protocol Analysis Toolkit](../Text/app01.xhtml#app01)**'
  prefs: []
  type: TYPE_NORMAL
- en: In the appendix, you’ll find descriptions of some of the tools I commonly use
    when performing network protocol analysis. Many of the tools are described briefly
    in the main body of the text as well.
  prefs: []
  type: TYPE_NORMAL
- en: '**How to Use This Book**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: If you want to start with a refresher on the basics of networking, read [Chapter
    1](../Text/ch01.xhtml#ch01) first. When you’re familiar with the basics, proceed
    to [Chapters 2](../Text/ch02.xhtml#ch02), [3](../Text/ch03.xhtml#ch03), and [5](../Text/ch05.xhtml#ch05)
    for practical experience in capturing network traffic and learning the network
    protocol analysis process.
  prefs: []
  type: TYPE_NORMAL
- en: With the knowledge of the principles of network traffic capture and analysis,
    you can then move on to [Chapters 7](../Text/ch07.xhtml#ch07) through [10](../Text/ch10.xhtml#ch10)
    for practical information on how to find and exploit security vulnerabilities
    in these protocols. [Chapters 4](../Text/ch04.xhtml#ch04) and [6](../Text/ch06.xhtml#ch06)
    contain more advanced information about additional capture techniques and application
    reverse engineering, so you can read them after you’ve read the other chapters
    if you prefer.
  prefs: []
  type: TYPE_NORMAL
- en: For the practical examples, you’ll need to install .NET Core (*[https://www.microsoft.com/net/core/](https://www.microsoft.com/net/core/)*),
    which is a cross-platform version of the .NET runtime from Microsoft that works
    on Windows, Linux, and macOS. You can then download releases for Canape Core from
    *[https://github.com/tyranid/CANAPE.Core/releases/](https://github.com/tyranid/CANAPE.Core/releases/)*
    and *SuperFunkyChat* from *[https://github.com/tyranid/ExampleChatApplication/releases/](https://github.com/tyranid/ExampleChatApplication/releases/)*;
    both use .NET Core as the runtime. Links to each site are available with the book’s
    resources at *[https://www.nostarch.com/networkprotocols/](https://www.nostarch.com/networkprotocols/)*.
  prefs: []
  type: TYPE_NORMAL
- en: To execute the example Canape Core scripts, you’ll need to use the *CANAPE.Cli*
    application, which will be in the release package downloaded from the Canape Core
    Github repository. Execute the script with the following command line, replacing
    `script.csx` with the name of the script you want to execute.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: All example listings for the practical chapters as well as packet captures are
    available on the book’s page at *[https://www.nostarch.com/networkprotocols/](https://www.nostarch.com/networkprotocols/)*.
    It’s best to download these example listings before you begin so you can follow
    the practical chapters without having to enter a large amount of source code manually.
  prefs: []
  type: TYPE_NORMAL
- en: '**Contact Me**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: I’m always interested in receiving feedback, both positive and negative, on
    my work, and this book is no exception. You can email me at *[attacking.network.protocols@gmail.com](mailto:attacking.network.protocols@gmail.com).*
    You can also follow me on Twitter *@tiraniddo* or subscribe to my blog at *[https://tyranidslair.blogspot.com/](https://tyranidslair.blogspot.com/)*
    where I post some of my latest advanced security research.
  prefs: []
  type: TYPE_NORMAL
