<html><head></head><body>
<h2 class="h2" id="ch08"><span epub:type="pagebreak" id="page_129"/>8<br/>THE AUTOMATIC TEXTING MACHINE</h2>&#13;
<p class="noindent"><span class="big1">IN THIS CHAPTER, YOU’LL SET UP YOUR RASPBERRY PI TO SEND TEXT MESSAGES TO A REGISTERED MOBILE PHONE. ONCE YOU HAVE THAT BIT WORKING, YOU’LL CREATE A SIMPLE AUTOMATIC TEXT-REMINDER SERVICE: YOU’LL CODE A TIME AND A SHORT MESSAGE, AND WHEN THE SPECIFIED TIME IS REACHED, THE MESSAGE WILL BE SENT TO A NUMBER YOU INPUT. <span epub:type="pagebreak" id="page_130"/>FOR EXAMPLE, YOU MIGHT SEND YOURSELF A MESSAGE TO REMIND YOU TO TAKE THE DOG FOR A WALK OR TO PICK SOMEONE UP, OR YOU MIGHT SEND A MESSAGE TO SOMEONE ELSE TO REMIND THEM EACH DAY THAT THEY OWE YOU $5!</span></p>&#13;
<h3 class="h3" id="ch08lev1sec1">WHAT YOU’LL NEED</h3>&#13;
<p class="noindent">Here are the items you’ll need for this project:</p>&#13;
<ul>&#13;
<li class="noindent">Raspberry Pi</li>&#13;
<li class="noindent">A basic mobile phone that can send and receive SMS</li>&#13;
</ul>&#13;
<h3 class="h3" id="ch08lev1sec2">A LITTLE ABOUT SMS</h3>&#13;
<p class="noindent">On December 3, 1992, the first <em>Short Message Service (SMS)</em> message, more commonly known as a <em>text message</em>, was sent from a computer. It read <em>Happy Christmas</em>. This inexpensive, fast, and easy service proved an incredibly popular method of communication between mobile phone devices.</p>&#13;
<h3 class="h3" id="ch08lev1sec3">CREATING A SIMPLE TEXT SENDER</h3>&#13;
<p class="noindent">You’ll create a simplified text sender that will send whatever message you type as input to the designated number. The first step is to set up your own account with <em>Twilio</em>, a cloud-based communications company. Twilio allows you to write program code that can make and receive phone calls, send SMS texts, collect call duration statistics, and much more.</p>&#13;
<p class="indent">Because Twilio is a cloud-based service, it uses an <em>application programming interface (API)</em>. An API is a set of tools that lets you interact with web-based applications through code. You use the API to interact with Twilio’s web services to, for example, send an SMS message or check a call log. The Twilio website lets you create a free trial account, which is all you need for this project.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong>NOTE</strong></p>&#13;
<p class="notep"><em>You can set up the Twilio credentials on another computer and then log back into Twilio on your Pi if you find that easier</em>.</p>&#13;
</div>&#13;
<h4 class="h4" id="ch08lev2sec1">Signing Up for a Twilio Account</h4>&#13;
<p class="noindent">On your Pi, head over to the Twilio website at <em><a href="https://www.twilio.com/">https://www.twilio.com/</a></em>. Click the red <strong>Sign up and start building</strong> button in the middle of the page, as shown in <a href="ch08.xhtml#ch08fig01">Figure 8-1</a>.</p>&#13;
<div class="image"><img alt="Image" src="../images/08fig01.jpg"/></div>&#13;
<p class="figcap" id="ch08fig01"><strong>FIGURE 8-1</strong> <span epub:type="pagebreak" id="page_131"/>Starting at the Twilio landing page</p>&#13;
<p class="indent">Sign up for an account by filling in the form, which may have changed since the time of writing. Enter your first name, last name, an email address, and what you want your password to be. The password must be at least 14 characters long. Once you have completed these steps, click the red <strong>Start your free trial</strong> button. <a href="ch08.xhtml#ch08fig02">Figure 8-2</a> shows all these options.</p>&#13;
<div class="image"><img alt="Image" src="../images/08fig02.jpg"/></div>&#13;
<p class="figcap" id="ch08fig02"><strong>FIGURE 8-2</strong> Signing up for a Twilio account</p>&#13;
<p class="indent">You should have been sent a verification email with a hyperlink at the address you used to sign up. Click the link in your email to verify your email address and assure the site that you’re not a bot.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_132"/>Now, you’ll have to further assure the site that you’re not a bot. (Proving you are a human is a two-step process!) Add your mobile phone number and click the <strong>Verify</strong> button. You need to input a valid number because Twilio will send a verification code to the phone number you entered. You will need this code to continue.</p>&#13;
<p class="indent">Your phone should then receive an SMS message with a verification number. On the Twilio page, enter the verification number and click <strong>Submit</strong>, as shown in <a href="ch08.xhtml#ch08fig03">Figure 8-3</a>.</p>&#13;
<div class="image"><img alt="Image" src="../images/08fig03.jpg"/></div>&#13;
<p class="figcap" id="ch08fig03"><strong>FIGURE 8-3</strong> Well done, human.</p>&#13;
<p class="indent">You’re now verified as a human being; you can rest easy!</p>&#13;
<p class="indent">You will be asked a series of questions about coding, which may have changed since the time of writing, so I’ll guide you through the questions broadly. If you’re asked if you code, say yes. You should be given a list of languages to choose from. Choose Python.</p>&#13;
<p class="indent">Now you will be asked something like <strong>What is your goal today?</strong> Select the option closest to <strong>Use Twilio in a project</strong>. You should also be asked what you want to do first, in which case select the option that involves sending or receiving an SMS.</p>&#13;
<p class="indent">Once that’s all done, you should be taken to your dashboard, which should look something like <a href="ch08.xhtml#ch08fig04">Figure 8-4</a>.</p>&#13;
<div class="image"><img alt="Image" src="../images/08fig04.jpg"/></div>&#13;
<p class="figcap" id="ch08fig04"><strong>FIGURE 8-4</strong> The Twilio dashboard</p>&#13;
<h3 class="h3" id="ch08lev1sec4"><span epub:type="pagebreak" id="page_133"/>SETTING UP A TWILIO PHONE NUMBER</h3>&#13;
<p class="noindent">The last step to set up your account is to acquire a Twilio phone number, which will be used to send the SMS messages from your Pi. Click the <strong>Get a Trial Number</strong> button. (If you can’t see the Get a Trial Number button in your dashboard, go to click the symbol with the three dots, as shown in the highlighted section of <a href="ch08.xhtml#ch08fig04">Figure 8-4</a>, in the menu to the left, and click <strong>Programmable SMS</strong>. From there, click <strong>Get Started</strong>, and then <strong>Get a number</strong>.)</p>&#13;
<p class="indent">Twilio will recommend a suitable phone number for you to use. Double-check that the number is registered to the country you reside in and that it’s SMS enabled, as shown in <a href="ch08.xhtml#ch08fig05">Figure 8-5</a>.</p>&#13;
<div class="image"><img alt="Image" src="../images/08fig05.jpg"/></div>&#13;
<p class="figcap" id="ch08fig05"><strong>FIGURE 8-5</strong> Twilio will choose a number for you; make sure it is based in your country and can receive and send text messages.</p>&#13;
<p class="indent">If the number isn’t SMS enabled, you’ll have to acquire another one by clicking <strong>Search for a different number</strong>, and you might be charged a small fee. Once you’ve checked that the details are correct, write down the phone number for later and click <strong>Choose This Number</strong>.</p>&#13;
<p class="indent">You’ve now set up your Twilio account, and you have a new phone number to use in your Python program. You are now ready to create your project and write the program that will send SMS texts to a phone number.</p>&#13;
<h4 class="h4" id="ch08lev2sec2">Creating a Project</h4>&#13;
<p class="noindent">Now it is time to set up your project and name it. At this point, Twilio will also show you your project’s authorization codes and credentials. Under “PROJECT NAME,” enter <strong>SMS_Phone</strong>, or any other name as long as it has SMS in it. The Dashboard will now display the title SMS_Phone Dashboard, as shown in <a href="ch08.xhtml#ch08fig06">Figure 8-6</a>.</p>&#13;
<p class="indent">When you created your Twilio account you also created an ACCOUNT SID and authorization token, which you’ll need later to control communication to your verified mobile phone. You will see that the AUTH TOKEN is not displayed for security reasons. To access the token press the copy button next to it. You can now paste the token into your program code.</p>&#13;
<div class="image"><img alt="Image" src="../images/08fig06.jpg"/></div>&#13;
<p class="figcap" id="ch08fig06"><strong>FIGURE 8-6</strong> <span epub:type="pagebreak" id="page_134"/>You’ll find your project credentials here.</p>&#13;
<h4 class="h4" id="ch08lev2sec3">Installing Twilio</h4>&#13;
<p class="noindent">To install Twilio, open the terminal window and enter the following:</p>&#13;
<pre><span class="codegreen">pi@raspberrypi</span>:- <span class="codeblue">$</span> <span class="codestrong1">sudo pip3 install twilio</span></pre>&#13;
<p class="indent">The relevant Python packages will be downloaded and installed onto your Raspberry Pi. Then restart the Pi, and when it loads, open IDLE 3, which is located on the Programming menu.</p>&#13;
<h4 class="h4" id="ch08lev2sec4">Writing the Code</h4>&#13;
<p class="noindent">Copy the code in <a href="ch08.xhtml#ch08ex01">Listing 8-1</a> into the file, and save it as <em>SMS.py</em>.</p>&#13;
<pre><span class="ent">❶</span> <span class="codeorg">from</span> twilio.rest <span class="codeorg">import</span> Client&#13;
 &#13;
   <span class="codered"># Find these values at https://twilio.com/user/account</span>&#13;
<span class="ent">❷</span> account_sid = <span class="codegreen1">"</span><span class="codeitalic1"><span class="codegreen1">XXXXXXXXXXXXXXXXXXXXXXXXXXXX</span></span><span class="codegreen1">"</span>&#13;
<span class="ent">❸</span> auth_token = <span class="codegreen1">"</span><span class="codeitalic1"><span class="codegreen1">XXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span></span><span class="codegreen1">"</span>&#13;
&#13;
<span class="ent">❹</span> message_text = input(<span class="codegreen1">"Please enter your message "</span>)&#13;
&#13;
<span class="ent">❺</span> client = Client(account_sid, auth_token)&#13;
   <span class="codered"># Replace +999 with your own phone number and +000 with your Twilio</span>&#13;
   <span class="codered">number</span>&#13;
&#13;
<span class="ent">❻</span> message = client.messages.create(to = <span class="codegreen1">"</span><span class="codeitalic1"><span class="codegreen1">+999</span></span><span class="codegreen1">"</span>, from_=<span class="codegreen1">"</span><span class="codeitalic1">+000</span><span class="codegreen1">"</span>,&#13;
   body = message_text) &#13;
&#13;
<span class="ent">❼</span> <span class="codepurple">print</span> (<span class="codegreen1">"Your message is being sent")</span>&#13;
<span class="ent">❽</span> <span class="codepurple">print</span> (<span class="codegreen1">"check your phone"</span>)</pre>&#13;
<p class="caption"><a id="ch08ex01"/><strong>LISTING 8-1</strong> The simple text-sender code</p>&#13;
<p class="indent">You begin by importing the <code>Client()</code> function from <code>twilio.rest</code> <span class="ent">❶</span>. <em>Representational State Transfer (REST)</em> is a method of transferring information between a computer device (your Raspberry Pi) and a <span epub:type="pagebreak" id="page_135"/>web-based service (Twilio’s cloud services). You import <code>Client()</code> so you can use REST from Twilio.</p>&#13;
<p class="indent">Next, you need to add your account security identifier (SID) <span class="ent">❷</span> and the authorization token <span class="ent">❸</span>. You have already found both values on your dashboard on the Twilio website, so just copy and paste them into your code in place of the <span class="codeitalic">X</span> placeholders. If you choose to type these codes, ensure that you use the correct letter case.</p>&#13;
<p class="indent">You then create a variable called <code>message_text</code> <span class="ent">❹</span> and give it a phrase to prompt the user for input: <code>input("Please enter your message ")</code>. This code line prompts the user (in this example, the user is you) to type in the SMS message they want to send; your program can send any text you want it to rather than a standard preset message.</p>&#13;
<p class="indent">To utilize the client to send the SMS message, you put your <code>account_sid</code> and your <code>auth_token</code> in a variable called <code>client</code> <span class="ent">❺</span>. With that, you can create a line of code to combine your message, your Twilio credentials, and the relevant phone numbers and then transmit the SMS message.</p>&#13;
<p class="indent">You create a variable called <code>message</code> and add the command <code>client.messages.create()</code>. When called, <code>message</code> collects the details from your <code>client</code> variable and creates an object to reference the Python Twilio class to create the SMS message <span class="ent">❻</span>.</p>&#13;
<p class="indent">To the same <code>message</code> variable, you add the mobile number you registered and verified with Twilio after the <code>to =</code> code. You’ll need to replace the <span class="codeitalic">+999</span> currently in the code with the cell number that you’re sending the message to (but make sure to keep the plus sign).</p>&#13;
<p class="indent">After <code>from_=</code>, you enter the Twilio-enabled phone number you set up in place of the <span class="codeitalic">+000</span> currently in the code. Next, you add the <code>message_text</code> variable, which contains the body of the text message. This completes the line of code to send the message.</p>&#13;
<p class="indent">Then you add a simple confirmation line to print when the message has been sent <span class="ent">❼</span> and another line to act as a reminder to check the mobile phone that the message has been sent to, the recipient of the message <span class="ent">❽</span>.</p>&#13;
<p class="indent">Let’s try it out! Save the program and run it, making sure the registered mobile phone is switched on. When the program runs, you’ll be prompted to enter a short message. Enter your message and press <span class="small">ENTER</span>; you should see the message appear on your mobile phone, as shown in <a href="ch08.xhtml#ch08fig07">Figure 8-7</a>.</p>&#13;
<div class="image"><img alt="Image" src="../images/08fig07.jpg"/></div>&#13;
<p class="figcap" id="ch08fig07"><strong>FIGURE 8-7</strong> <span epub:type="pagebreak" id="page_136"/>Receiving a Twilio message on your phone</p>&#13;
<h3 class="h3" id="ch08lev1sec5">CREATING THE AUTOMATIC SMS REMINDER MACHINE</h3>&#13;
<p class="noindent">Now that you have a basic SMS program set up, you can combine it with other Python features to create an automatic SMS reminder system, as shown in <a href="ch08.xhtml#ch08fig08">Figure 8-8</a>. You’ll enter your reminder message and then enter the time the reminder needs to be sent.</p>&#13;
<div class="image"><img alt="Image" src="../images/08fig08.jpg"/></div>&#13;
<p class="figcap" id="ch08fig08"><strong>FIGURE 8-8</strong> An automatic text reminder</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_137"/>The program checks the current time on your Raspberry Pi. When it reaches the designated time, it sends the reminder message to your phone. Because the time needs to be accurate, I recommend that you connect your Pi to the internet. That way, the time will be updated each time the Pi is booted up, and your reminder program will respond at the correct time.</p>&#13;
<h4 class="h4" id="ch08lev2sec5">Setting Up and Validating the Format</h4>&#13;
<p class="noindent">Open a new file in IDLE 3 or your Python code editor and add the first section of the code, as shown in <a href="ch08.xhtml#ch08ex02">Listing 8-2</a>. Save it as <em>reminder_machine.py</em>.</p>&#13;
<pre><span class="ent">❶</span> <span class="codeorg">from</span> twilio.rest <span class="codeorg">import</span> Client&#13;
   <span class="codeorg">import</span> time&#13;
   <span class="codeorg">import</span> datetime&#13;
   <span class="codeorg">import</span> sys&#13;
&#13;
   <span class="codered"># Find these values at https://twilio.com/user/account</span>&#13;
<span class="ent">❷</span> account_sid = <span class="codegreen1">"</span><span class="codeitalic1"><span class="codegreen1">XXXXXXXXXXXXXXXXXXXXXXX</span></span><span class="codegreen1">"</span>&#13;
   auth_token = <span class="codegreen1">"</span><span class="codeitalic1"><span class="codegreen1">XXXXXXXXXXXXXXXXXXXXXXXXX</span></span><span class="codegreen1">"</span>&#13;
   client = Client(account_sid, auth_token)&#13;
&#13;
   <span class="codered"># validation for time</span>&#13;
<span class="ent">❸</span> <span class="codeorg">def</span> <span class="codeblue1">isTimeFormat</span>(<span class="codepurple">input</span>):&#13;
    <span class="ent">❹</span> <span class="codeorg">try</span>:&#13;
       <span class="ent">❺</span> time.strptime(<span class="codepurple">input</span>, <span class="codegreen1">'%H:%M'</span>)&#13;
       <span class="ent">❻</span> <span class="codeorg">return True</span>&#13;
    <span class="ent">❼</span> <span class="codeorg">except</span> <span class="codepurple">ValueError</span>:&#13;
       <span class="ent">❽</span> <span class="codeorg">return</span> <span class="codeorg">False</span></pre>&#13;
<p class="caption"><a id="ch08ex02"/><strong>LISTING 8-2</strong> The first part of the <span class="codeitalic">reminder_machine.py</span> code</p>&#13;
<p class="indent">Again, you need to import the Twilio <code>Client</code> <span class="ent">❶</span>. But you also import the <code>time</code> module to add short delays and the <code>datetime</code> module to access the Raspberry Pi’s current time. You also add the <code>sys</code> module, which lets you use command line functions with the program.</p>&#13;
<p class="indent">As before, you need to add your Twilio account credentials to the variables <code>account_sid</code> and <code>auth_token</code> and then combine them into the variable named <code>client</code> <span class="ent">❷</span>.</p>&#13;
<p class="indent">This next bit is new: you need to set up a simple validation to check that the input time is in the correct format. The user needs to input the format of <em>hours:minutes</em>, like this: 11:10. If a user enters the time incorrectly as 1110 or 111:0, the program will fail because it would never match the Pi’s time. To check for the correct format, you create a function called <code>isTimeFormat()</code> <span class="ent">❸</span>, and then you use a <code>try</code> method to validate the input <span class="ent">❹</span>. On the next line, you use the <span epub:type="pagebreak" id="page_138"/>function <code>time.strptime()</code> <span class="ent">❺</span> to check that the input time is in the format <code>%H:%M</code>, which is <em>hours:minutes</em>, or 00:00.</p>&#13;
<p class="indent">If the time entered is in the correct format, the validation check returns the value <code>True</code> <span class="ent">❻</span>. If an error occurs <span class="ent">❼</span> or the value doesn’t match the correct formatting, the value <code>False</code> is returned <span class="ent">❽</span>. You’ll use these values later to trigger the continuation of the program to the next stage or to prompt the user to reenter the time in the correct format.</p>&#13;
<h4 class="h4" id="ch08lev2sec6">Coding the Reminder Message</h4>&#13;
<p class="noindent">Now you’re ready to add the second code section, which introduces what the program does and asks the user to enter their reminder message and time. Add <a href="ch08.xhtml#ch08ex03">Listing 8-3</a> to the bottom of the <em>reminder_machine.py</em> file.</p>&#13;
<pre><span class="ent">❶</span> <span class="codepurple">print</span> (<span class="codegreen1">"Welcome to the reminder machine"</span>)&#13;
<span class="ent">❷</span> <span class="codepurple">print</span> (<span class="codegreen1">""</span>)&#13;
<span class="ent">❸</span> time.sleep(1)&#13;
<span class="ent">❹</span> reminder = input(<span class="codegreen1">"Please enter your message "</span>)&#13;
   <span class="codepurple">print</span> (<span class="codegreen1">""</span>)&#13;
&#13;
   <span class="codered"># validation check for time format</span>&#13;
<span class="ent">❺</span> check = <span class="codeorg">False</span>&#13;
&#13;
<span class="ent">❻</span> <span class="codeorg">while</span> check == <span class="codeorg">False</span>:&#13;
    <span class="ent">❼</span> reminder_time = input(<span class="codegreen1">"Please enter the reminder time.</span>&#13;
      <span class="codegreen1">For example 09:45 "</span>)&#13;
    <span class="ent">❽</span> check = isTimeFormat(reminder_time)&#13;
      <span class="codepurple">print</span> (<span class="codegreen1">""</span>)&#13;
    <span class="ent">❾</span> <span class="codepurple">print</span> (check)&#13;
      <span class="codepurple">print</span> (<span class="codegreen1">""</span>)</pre>&#13;
<p class="caption"><a id="ch08ex03"/><strong>LISTING 8-3</strong> The second part of your <span class="codeitalic">reminder_machine.py</span> program</p>&#13;
<p class="indent">You start with a simple <code>print()</code> and a statement to notify the user that the reminder machine is running and ready <span class="ent">❶</span>. Then you add a blank line to print between each statement to make them easier to read <span class="ent">❷</span> and pause for a second to allow the user to read the welcome message and instructions <span class="ent">❸</span>.</p>&#13;
<p class="indent">Next, you create a variable that prompts the user to enter their reminder message <span class="ent">❹</span> and then store the message.</p>&#13;
<p class="indent">Then you check that the <code>time</code> value is in the correct format, 00:00. You set it to <code>False</code> by default <span class="ent">❺</span>. You create a <code>while</code> statement that runs only while the <code>isTimeFormat()</code> validation check value is <code>False</code> <span class="ent">❻</span>. Because you set it to <code>False</code> in the previous line, the <code>while</code> loop keeps looping.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_139"/>Inside the <code>while</code> loop, you prompt the user to enter the time they want the reminder sent and store this in the variable <code>reminder_time</code> <span class="ent">❼</span>.</p>&#13;
<p class="indent">To check that the time the user inputs matches the correct format, you call the <code>isTimeFormat()</code> function you created in <a href="ch08.xhtml#ch08ex02">Listing 8-2</a> and input the value stored in the <code>reminder_time</code> variable <span class="ent">❽</span>.</p>&#13;
<p class="indent">Depending on whether the time has been input in the correct format, the function will return either <code>True</code> or <code>False</code>. If the returned value is <code>False</code>, the time input is in an incorrect format and the <code>while</code> loop runs again, prompting the user to enter the time in the correct format.</p>&#13;
<p class="indent">When the returned value is <code>True</code>, the time format input is correct, and the program continues to line <span class="ent">❾</span> and prints the validation value. This is for your testing purposes: you can comment out the line at <span class="ent">❾</span> after the program is operational by placing a <code>#</code> on the left side of the line so it looks like this: <code># print (check)</code>.</p>&#13;
<h4 class="h4" id="ch08lev2sec7">Matching Times and Sending the Message</h4>&#13;
<p class="noindent">The final section of the program, shown in <a href="ch08.xhtml#ch08ex04">Listing 8-4</a>, compares the Raspberry Pi’s current time with the reminder time and, when they match, sends out the message.</p>&#13;
<pre><span class="ent">❶</span> <span class="codeorg">while</span> <span class="codeorg">True</span>:&#13;
    <span class="ent">❷</span> current_time = datetime.datetime.now().time()&#13;
       <span class="codered"># print (current_time)</span>&#13;
&#13;
    <span class="ent">❸</span> current_time = str(current_time) <span class="codered"># swap the time to a string</span>&#13;
&#13;
    <span class="ent">❹</span> current_time = current_time[0:5]&#13;
&#13;
    <span class="ent">❺</span> <span class="codeorg">if</span> reminder_time == current_time:&#13;
            <span class="ent">❻</span> <span class="codepurple">print</span> (<span class="codegreen1">"Reminder Time"</span>)&#13;
            <span class="ent">❼</span> message = client.messages.create(to = <span class="codegreen1">"+</span><span class="codeitalic1"><span class="codegreen1">999999</span></span><span class="codegreen1">"</span>,&#13;
               from_=<span class="codegreen1">"+</span><span class="codeitalic1"><span class="codegreen1">00000000</span></span><span class="codegreen1">"</span>, body=reminder)&#13;
            <span class="ent">❽</span> time.sleep(60)&#13;
            <span class="ent">❾</span> sys.exit()&#13;
    <span class="codeorg">else</span>:&#13;
            <span class="ent">❿</span> time.sleep(1)</pre>&#13;
<p class="caption"><a id="ch08ex04"/><strong>LISTING 8-4</strong> The final part of <span class="codeitalic">reminder_machine.py</span>: sending the message!</p>&#13;
<p class="indent">First, you create a <code>while True</code> loop to keep this section of the program running continuously, checking the current time and comparing it to the reminder time <span class="ent">❶</span>.</p>&#13;
<p class="indent">Next, you store the current date-time reading from the Raspberry Pi operating system in a variable called <code>current_time</code> <span class="ent">❷</span>. You’ll print this value for testing purposes, but once the program is functioning, <span epub:type="pagebreak" id="page_140"/>comment it out. The value will be in the format <em>hours:minutes:seconds:milliseconds</em>, which contains more data than you require. So before you use the date-time value, you convert it into a string <span class="ent">❸</span> and then slice it down to just the first five characters <span class="ent">❹</span> to match the 00:00 format.</p>&#13;
<p class="indent">Now you can compare <code>reminder_time</code> with the current time: the next line checks whether, say, 11:10 equals 11:10 <span class="ent">❺</span>, and if the two values match, the program prints a line indicating it’s reminder time <span class="ent">❻</span>!</p>&#13;
<p class="indent">To send the message, you create a variable called <code>message</code> and add the <code>to</code> and <code>from</code> phone numbers. Then you add the reminder message you entered and stored in the <code>reminder</code> variable as the body of the message <span class="ent">❼</span>. The <code>client.messages.create()</code> function creates and sends the message to your mobile phone.</p>&#13;
<p class="indent">The lines of code <span class="ent">❷</span> to <span class="ent">❿</span> are placed within a <code>while</code> loop, meaning that the program is continuously checking the conditions and sending messages when those conditions are met. If you left the program code like this, it would send you as many messages as possible in the minute that matches the time you have set. To avoid this continuous messaging, you add a delay of 60 seconds before the next line of code runs <span class="ent">❽</span>. As a result, the time will move on to, say, 11:11 and no longer match when the loop runs again.</p>&#13;
<p class="indent">You add code to exit the program by calling the system exit command from the terminal <span class="ent">❾</span>. In the final line of the program, you add a delay of 1 second, and then the whole loop will start again <span class="ent">❿</span>.</p>&#13;
<p class="indent">That completes the program. You can now save and execute it. Keep an eye on the levels of indentation. If you have any trouble getting the program to run, first check that the lines are indented at the correct level.</p>&#13;
<p class="indent">Enter your reminder message and reminder time. Then leave your Raspberry Pi running, and you’ll be sent your text at the allocated time!</p>&#13;
<h3 class="h3" id="ch08lev1sec6">WRAPPING UP</h3>&#13;
<p class="noindent">You can use your automatic texting machine for all kinds of things, especially now that you have a Twilio account set up. Check out the Twilio documentation to find out what you can do (<em><a href="http://www.twilio.com/docs/quickstart">www.twilio.com/docs/quickstart</a></em>). As one tip, why not try your hand at detective work: use Twilio to trace messages and phone calls to and from the phone connected to Twilio. You’ll find the code for this hack at <em><a href="http://www.tecoed.co.uk/spooking-a-mobile.html">www.tecoed.co.uk/spooking-a-mobile.html</a></em>.</p>&#13;
</body></html>