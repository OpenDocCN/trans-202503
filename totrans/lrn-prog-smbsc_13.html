<html><head></head><body>
<h2 class="h2" id="ch13"><span epub:type="pagebreak" id="page_181"/><span class="big"><span class="blue"><strong>13</strong></span></span><br/><strong>REPEATING FOR LOOPS</strong></h2>&#13;
<div class="imagec"><img alt="image" src="graphics/common01.jpg"/></div>&#13;
<p class="noindent">Have you ever noticed that no matter how many times you take out the trash, clean dirty dishes, and do laundry, you always have to do it again? What if you only had to do each task once, and then you created a robot version of yourself to do it every time after that? That would be amazing!</p>&#13;
<p class="indent">In the Small Basic universe, automating repetitive tasks is a breeze. You only have to write code for a repetitive task once, and then you can use a loop to repeat that task as many times as you need.</p>&#13;
<p class="indent">Small Basic uses two types of loop statements: <code>For</code> <em>loops</em> and <code>While</code> <em>loops</em>. In this chapter, you’ll learn about <code>For</code> loops, explore nested <code>For</code> loops in depth, and create some programs that take advantage of your computer’s passion for repetition. You’ll learn how to use <code>For</code> loops in a wide range of practical applications. Let’s get loopy!</p>&#13;
<h3 class="h3" id="ch13lev1sec01"><span epub:type="pagebreak" id="page_182"/><span class="blue"><strong>The For Loop</strong></span></h3>&#13;
<p class="noindent">Let’s say you want to make a program that displays the multiplication table for nine: 1 <em>×</em> 9, 2 <em>×</em> 9, 3 <em>×</em> 9, through 10 <em>×</em> 9. Your first attempt might look like this:</p>&#13;
<pre><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">" 1 x 9 = "</span> <span class="brown">+ (</span><span class="red">1</span> <span class="brown">*</span> <span class="red">9</span><span class="brown">))</span><br/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">" 2 x 9 = "</span> <span class="brown">+ (</span><span class="red">2</span> <span class="brown">*</span> <span class="red">9</span><span class="brown">))</span><br/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">" 3 x 9 = "</span> <span class="brown">+ (</span><span class="red">3</span> <span class="brown">*</span> <span class="red">9</span><span class="brown">))</span><br/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">" 4 x 9 = "</span> <span class="brown">+ (</span><span class="red">3</span> <span class="brown">*</span> <span class="red">9</span><span class="brown">))</span><br/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">" 5 x 9 = "</span> <span class="brown">+ (</span><span class="red">3</span> <span class="brown">*</span> <span class="red">9</span><span class="brown">))</span><br/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">" 6 x 9 = "</span> <span class="brown">+ (</span><span class="red">3</span> <span class="brown">*</span> <span class="red">9</span><span class="brown">))</span><br/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">" 7 x 9 = "</span> <span class="brown">+ (</span><span class="red">3</span> <span class="brown">*</span> <span class="red">9</span><span class="brown">))</span><br/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">" 8 x 9 = "</span> <span class="brown">+ (</span><span class="red">3</span> <span class="brown">*</span> <span class="red">9</span><span class="brown">))</span><br/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">" 9 x 9 = "</span> <span class="brown">+ (</span><span class="red">3</span> <span class="brown">*</span> <span class="red">9</span><span class="brown">))</span><br/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"10 x 9 = "</span> <span class="brown">+ (</span><span class="red">10</span> <span class="brown">*</span> <span class="red">9</span><span class="brown">))</span></pre>&#13;
<p class="indent">Phew! Look at that wall-o-code! Although Small Basic lets you easily copy and paste selected statements, this program repeats a lot of code. What if you want to display the multiplication table up to 100 or 1000? Clearly, this isn’t the best way to write your program. Here’s a version of this program that uses a <code>For</code> loop to get the same result:</p>&#13;
<pre><span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">10</span><br/>  <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>N <span class="brown">+</span> <span class="red">" x 9 = "</span> <span class="brown">+ (</span>N <span class="brown">*</span> <span class="red">9</span><span class="brown">))</span><br/><span class="purple"><span class="codestrong">EndFor</span></span></pre>&#13;
<p class="indent">Run this program and check out what happens. Wasn’t that easier than writing out every line? Now you’ve seen the power of loops!</p>&#13;
<p class="indent">The loop runs the same statement but with a different value of <code>N</code> each time. First, the code sets the value of <code>N</code> to 1, which is the value we want to start creating the multiplication table from. Next, it runs all the statements between the <code>For</code> and the <code>EndFor</code> keywords. In this case, it runs the <code>WriteLine()</code> method, replacing <code>N</code> with its current value. This is called an <em>iteration</em> of the loop.</p>&#13;
<p class="indent">Then it sets <code>N</code> to 2. The value of <code>N</code> is compared with the ending value (or <em>terminal value</em>) of the loop, which is 10 in this case. If <code>N</code> is less than 10, the statements in the body of the <code>For</code> loop run again, completing another iteration of the loop. Note that the <code>For</code> loop automatically increases <code>N</code> by 1 during each iteration. This process continues, using <code>N = 3</code>, then <code>N = 4</code>, all the way to <code>N = 10</code>.</p>&#13;
<p class="indent">After the program runs the tenth iteration, it moves to the statement after the <code>EndFor</code> keyword (if there is one), and the loop is complete.</p>&#13;
<p class="indent">Now that you’ve seen a basic <code>For</code> loop in action, look at the syntax in <a href="ch13.html#ch13fig1">Figure 13-1</a>.</p>&#13;
<div class="image"><img alt="image" src="graphics/f13-01.jpg"/></div>&#13;
<p class="figcap"><a id="ch13fig1"/><em>Figure 13-1: Syntax of a basic</em> <code><span class="codeitalic">For</code></span> <em>loop</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_183"/>Each <code>For</code> loop starts with the keyword <code>For</code>. The statements contained between the <code>For</code> and <code>EndFor</code> keywords are called the <em>body</em> of the <code>For</code> loop. The variable, <code>N</code>, is the <em>loop control variable</em> (or <em>loop counter</em>). It controls the number of times the loop runs, and it’s treated like any other variable in the program. The <code>1 To 10</code> part of the statement determines how many times the loop runs.</p>&#13;
<p class="indent">It’s important to note that the condition to check whether or not the loop runs is tested at the top of the loop. For example, the following code sets <code>N</code> to 1 and then compares it to a terminal value of –10. Because 1 is greater than –10, the code won’t run even once:</p>&#13;
<pre><span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="brown">-</span><span class="red">10</span><br/>  <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>N<span class="brown">)</span>    <span class="green"><span class="codeitalic">' This won't be executed</span></span><br/><span class="purple"><span class="codestrong">EndFor</span></span></pre>&#13;
<p class="indent">Let’s look at some fun examples that show you how to use a <code>For</code> loop.</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch13sb01"><strong>TRY IT OUT 13-1</strong></p>&#13;
<p class="noindent">Think about some other repetitive tasks that you could automate with a loop. Describe a program you’d build with a <code>For</code> loop.</p>&#13;
</div>&#13;
<h4 class="h4" id="ch13lev2sec01"><em><strong>Magical Moving Text</strong></em></h4>&#13;
<p class="noindent">In this example, you’ll create a program that moves a word or sentence across the text window from left to right. <a href="ch13.html#ch13fig2">Figure 13-2</a> shows that with each iteration, the word displayed in the last iteration disappears, so the text appears to be animated, moving across the screen to the right.</p>&#13;
<div class="image"><img alt="image" src="graphics/f13-02.jpg"/></div>&#13;
<p class="figcap"><a id="ch13fig2"/><em>Figure 13-2: Using the</em> <code><span class="codeitalic">Write()</code></span> <em>method to move a word across the text window</em></p>&#13;
<p class="indent">Recall that in <a href="ch02.html#ch02">Chapter 2</a> you used the <code>CursorLeft</code> property to display text in different places inside the text window. In this example, you’ll set <code>CursorLeft</code> to 0 and use the <code>Write()</code> method to write the word. After a short delay, you’ll change <code>CursorLeft</code> to 1 and write the word again. You’ll then change <code>CursorLeft</code> to 2, then 3, and so on. Using a <code>For</code> loop, you’ll automate this process to make it look like the word is moving across the text window. Enter the program in <a href="ch13.html#ch13ex1">Listing 13-1</a>.</p>&#13;
<pre><span epub:type="pagebreak" id="page_184"/>1 <span class="green"><span class="codeitalic">' MovingWord.sb</span></span><br/>2 <span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">0</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">40</span><br/>3   <span class="blue1">TextWindow</span><span class="brown">.CursorLeft =</span> N<br/>4   <span class="blue1">TextWindow</span><span class="brown">.Write(</span><span class="red">" Moving"</span><span class="brown">)</span> <span class="green"><span class="codeitalic">' Erases the previous line</span></span><br/>5   <span class="blue1">Program</span><span class="brown">.Delay(</span><span class="red">250</span><span class="brown">)</span>          <span class="green"><span class="codeitalic">' Delays so you can read it</span></span><br/>6 <span class="purple"><span class="codestrong">EndFor</span></span><br/>7 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">""</span><span class="brown">)</span></pre>&#13;
<p class="listcap"><a id="ch13ex1"/><em>Listing 13-1: Moving a word across the text window</em></p>&#13;
<p class="indent">The program starts a loop that runs from <code>N = 0 To 40</code> (line 2). During each iteration, it sets the <code>CursorLeft</code> property equal to the loop counter <code>N</code> (line 3) and then uses the <code>Write()</code> method to write the word (line 4). The space before the text <code>Moving</code> helps to erase the previous word. The <code>Program.Delay(250)</code> call at line 5 causes the program to wait for 250 milliseconds before it starts the next iteration of the loop. When the loop ends, the program writes an empty line (line 7).</p>&#13;
<p class="indent">Let’s move on to another example.</p>&#13;
<div class="note">&#13;
<p class="notet"><span class="notes"><strong>TIP</strong></span></p>&#13;
<p class="notep"><em>Although it isn’t required, indenting the statements in the body of a</em> <code><span class="codeitalic">For</code></span> <em>loop makes your code easier to read.</em></p>&#13;
</div>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch13sb02"><strong>TRY IT OUT 13-2</strong></p>&#13;
<p class="noindent">Change <a href="ch13.html#ch13ex1">Listing 13-1</a> to animate your own message to your friends or family members and share it with them. Mine is “I Like Tacos!”</p>&#13;
</div>&#13;
<h4 class="h4" id="ch13lev2sec02"><em><strong>Adding ’em Up</strong></em></h4>&#13;
<p class="noindent">In programming, loops are used in different ways. One important use of loops is called an <em>accumulator loop</em>, which accumulates (or adds up) a value during each iteration of the loop. Accumulator loops are commonly used to keep count of values in programs.</p>&#13;
<p class="indent">Let’s say you need to find the sum of all integers from 1 to 10: 1 + 2 + 3 + ... + 10. That’s what the program in <a href="ch13.html#ch13ex2">Listing 13-2</a> does.</p>&#13;
<pre>1 <span class="green"><span class="codeitalic">' Sum.sb</span></span><br/>2 sum <span class="brown">=</span> <span class="red">0</span><br/>3 <span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">10</span><br/>4   sum <span class="brown">=</span> sum <span class="brown">+</span> N     <span class="green"><span class="codeitalic">' Adds the new value of N to the sum</span></span><br/>5 <span class="purple"><span class="codestrong">EndFor</span></span><br/>6 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"sum = "</span> <span class="brown">+</span> sum<span class="brown">)</span></pre>&#13;
<p class="listcap"><a id="ch13ex2"/><em>Listing 13-2: Using a</em> <code><span class="codeitalic">For</code></span> <em>loop to add numbers</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_185"/>The program uses a variable named <code>sum</code> to hold the running total (this variable is usually called an <em>accumulator</em>). The program starts by initializing <code>sum</code> to 0 (line 2). Then a <code>For</code> loop with a loop counter named <code>N</code> runs from 1 to 10 (line 3). During each iteration, the program adds the value of <code>N</code> to the accumulator by using the statement at line 4. This statement adds the current value of <code>N</code> to the current value of <code>sum</code> and stores the result back into <code>sum</code>. After the first iteration, <code>sum</code> is 1 (0 + 1); after the second iteration, <code>sum</code> is 3 (1 + 2); after the third iteration, <code>sum</code> is 6 (3 + 3); and so on. When the loop ends, the program displays the value of the <code>sum</code> variable on line 6: <code>sum = 55</code>.</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch13sb03"><strong>TRY IT OUT 13-3</strong></p>&#13;
<p class="noindent">When the great mathematician Carl Gauss first went to school, his teacher asked the class to find the sum of all the numbers between 1 and 100, that is, 1 + 2 + 3 + 4 + ... + 100. Gauss took one look at the problem and immediately put his answer on the teacher’s desk. The teacher was amazed—Gauss was right! Write a program to find the answer that Gauss worked out in his head. Of course, Gauss didn’t use Small Basic, but he did find a shortcut. Can you figure out his secret method?</p>&#13;
</div>&#13;
<h4 class="h4" id="ch13lev2sec03"><em><strong>Formatting Your Output</strong></em></h4>&#13;
<p class="noindent">The way you display the output of a program is often just as important as the information you display. If the output is difficult to read, people won’t be able to understand what the information means. A well-laid-out display is an essential part of your program design, but getting the formatting right can be tedious. To make it easier, you can use <code>For</code> loops. For example, let’s use a <code>For</code> loop to write a program that outputs the squares of 1 to 5 in a table format (see <a href="ch13.html#ch13fig3">Figure 13-3</a>).</p>&#13;
<div class="image"><img alt="image" src="graphics/f13-03.jpg"/></div>&#13;
<p class="figcap"><a id="ch13fig3"/><em>Figure 13-3: The output of</em> SquareTable.sb</p>&#13;
<p class="indent">Enter and run the program in <a href="ch13.html#ch13ex3">Listing 13-3</a>.</p>&#13;
<pre> 1 <span class="green"><span class="codeitalic">' SquareTable.sb</span></span><br/> 2 <span class="blue1">TextWindow</span><span class="brown">.Title =</span> <span class="red">"Table of Squares"</span><br/> 3 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">" Number     Square"</span><span class="brown">)</span><br/> 4 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"========   ========="</span><span class="brown">)</span><br/> 5<br/> 6 <span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">5</span><br/> 7   <span class="blue1">TextWindow</span><span class="brown">.CursorLeft =</span> <span class="red">3</span>   <span class="green"><span class="codeitalic">' Moves to middle of col 1</span></span><br/> 8   <span class="blue1">TextWindow</span><span class="brown">.Write(</span>N<span class="brown">)</span>         <span class="green"><span class="codeitalic">' Writes the number</span></span><br/> 9   <span class="blue1">TextWindow</span><span class="brown">.CursorLeft =</span> <span class="red">14</span>  <span class="green"><span class="codeitalic">' Moves to next column</span></span><br/>10   <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>N <span class="brown">*</span> N<span class="brown">)</span> <span class="green"><span class="codeitalic">' Writes its square</span></span><br/>11 <span class="purple"><span class="codestrong">EndFor</span></span></pre>&#13;
<p class="listcap"><a id="ch13ex3"/><em>Listing 13-3: Using a</em> <code><span class="codeitalic">For</code></span> <em>loop to display tabular data</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_186"/>Lines 3–4 write the headers for the two table columns. The loop at line 6 writes the five numbers and their squares. The <code>TextWindow.CursorLeft</code> property sets the desired position under each column (lines 7 and 9). Each time the code loops, it displays the correct value in its proper spot.</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch13sb04"><strong>TRY IT OUT 13-4</strong></p>&#13;
<p class="noindent">The famous song <em>Twelve Days of Christmas</em> goes like this: “On the first day of Christmas my true love gave to me a partridge in a pear tree. On the second day of Christmas my true love gave to me two turtle doves and a partridge in a pear tree. On the third day of…” and so on for 12 days. On the twelfth day, the singer received 12 + 11 + ... + 2 + 1 gifts. Write a program that shows the total gifts received on each of the 12 days. Include two columns in your output: the day number and the total gifts received on that day.</p>&#13;
</div>&#13;
<h4 class="h4" id="ch13lev2sec04"><em><strong>Drawing All Kinds of Lines</strong></em></h4>&#13;
<p class="noindent">You can use <code>For</code> loops to change all kinds of values, including visual displays. <a href="ch13.html#ch13ex4">Listing 13-4</a> draws 10 lines of increasing width in the graphics window.</p>&#13;
<pre>1 <span class="green"><span class="codeitalic">' Lines.sb</span></span><br/>2 <span class="blue1">GraphicsWindow</span><span class="brown">.Title =</span> <span class="red">"Lines"</span><br/>3 <span class="blue1">GraphicsWindow</span><span class="brown">.PenColor =</span> <span class="red">"Blue"</span><br/>4 <span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">10</span><br/>5   <span class="blue1">GraphicsWindow</span><span class="brown">.PenWidth =</span> N<br/>6   y <span class="brown">=</span> N <span class="brown">*</span> <span class="red">15</span>    <span class="green"><span class="codeitalic">' Vertical position of the line</span></span><br/>7   <span class="blue1">GraphicsWindow</span><span class="brown">.DrawLine(</span><span class="red">0</span><span class="brown">,</span> y<span class="brown">,</span> <span class="red">200</span><span class="brown">,</span> y<span class="brown">)</span><br/>8 <span class="purple"><span class="codestrong">EndFor</span></span></pre>&#13;
<p class="listcap"><a id="ch13ex4"/><em>Listing 13-4: Increasing the line width with each iteration</em></p>&#13;
<p class="indent">After setting the window’s title and the pen’s color (lines 2–3), the program starts a <code>For</code> loop with a loop counter named <code>N</code> that runs from 1 to 10 (line 4). In each iteration, the program sets the pen’s width to the current value of <code>N</code> (line 5), sets the vertical position of the line (line 6), and then draws a line that is 200 pixels long (line 7). The output is shown in <a href="ch13.html#ch13fig4">Figure 13-4</a>.</p>&#13;
<div class="image"><img alt="image" src="graphics/f13-04.jpg"/></div>&#13;
<p class="figcap"><a id="ch13fig4"/><em>Figure 13-4: The output of</em> Lines.sb</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch13sb05"><span epub:type="pagebreak" id="page_187"/><strong>TRY IT OUT 13-5</strong></p>&#13;
<p class="noindent">What does the following program do? Run the program to check your answer.</p>&#13;
<pre><span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">200</span><br/>  <span class="blue1">GraphicsWindow</span><span class="brown">.PenColor =</span> <span class="blue1">GraphicsWindow</span><span class="brown">.GetRandomColor()</span><br/>  x2 <span class="brown">=</span> <span class="blue1">Math</span><span class="brown">.GetRandomNumber(</span><span class="red">300</span><span class="brown">)</span><br/>  y2 <span class="brown">=</span> <span class="blue1">Math</span><span class="brown">.GetRandomNumber(</span><span class="red">300</span><span class="brown">)</span><br/>  <span class="blue1">GraphicsWindow</span><span class="brown">.DrawLine(</span><span class="red">0</span><span class="brown">,</span> <span class="red">0</span><span class="brown">,</span> x2<span class="brown">,</span> y2<span class="brown">)</span><br/><span class="purple"><span class="codestrong">EndFor</span></span></pre>&#13;
</div>&#13;
<h3 class="h3" id="ch13lev1sec02"><span class="blue"><strong>Changing the Step Size</strong></span></h3>&#13;
<p class="noindent">The previous section showed you the syntax of the <code>For</code> loop that automatically increases the loop counter by one after each iteration. But <code>For</code> loops have a general form that lets you control the <code>Step</code> size of the loop’s control variable to increase it or decrease it by however much you want. Here’s the general form of the <code>For</code> loop:</p>&#13;
<pre><span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red"><span class="codeitalic">A</span></span> <span class="purple"><span class="codestrong">To</span></span> <span class="red"><span class="codeitalic">B</span></span> <span class="purple"><span class="codestrong">Step</span></span> <span class="red"><span class="codeitalic">C</span></span><br/>  <span class="codeitalic">Statement(s)</span><br/><span class="purple"><span class="codestrong">EndFor</span></span></pre>&#13;
<p class="indent">It works like the simplified loop you saw earlier. But instead of incrementing the loop counter <code>N</code> by one, you can decide how much to change <code>N</code>. You do this by setting the amount in the <code>Step</code> size, <code><span class="codeitalic">C</code></span>, which can be a positive or negative number or any Small Basic expression. Let’s look at some examples that show you how to use this general form of the <code>For</code> loop.</p>&#13;
<h4 class="h4" id="ch13lev2sec05"><em><strong>Counting Down by Twos</strong></em></h4>&#13;
<p class="noindent">In this example, the program counts from a starting value (10 in this case) down to 0, subtracting 2 at a time so the program writes the numbers 10, 8, 6, 4, 2, 0 in the text window. Enter and run the program in <a href="ch13.html#ch13ex5">Listing 13-5</a>.</p>&#13;
<pre>1 <span class="green"><span class="codeitalic">' CountDown.sb</span></span><br/>2 <span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">10</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">0</span> <span class="purple"><span class="codestrong">Step</span></span> <span class="brown">-</span><span class="red">2</span>    <span class="green"><span class="codeitalic">' Uses a negative step size</span></span><br/>3   <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>N<span class="brown">)</span><br/>4 <span class="purple"><span class="codestrong">EndFor</span></span></pre>&#13;
<p class="listcap"><a id="ch13ex5"/><em>Listing 13-5: Counting down with</em> <code><span class="codeitalic">Step</code></span></p>&#13;
<p class="indent">A negative value was used for the <code>Step</code> size (line 2) to reduce the value of the loop counter by 2 after each iteration.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_188"/>Here’s the output:</p>&#13;
<pre>10<br/>8<br/>6<br/>4<br/>2<br/>0</pre>&#13;
<h4 class="h4" id="ch13lev2sec06"><em><strong>Making a Fractional Step</strong></em></h4>&#13;
<p class="noindent">The <code>Step</code> size doesn’t have to be an integer value. You can also use a decimal value, as shown in <a href="ch13.html#ch13ex6">Listing 13-6</a>.</p>&#13;
<pre> 1  <span class="green"><span class="codeitalic">' DecimalStep.sb</span></span><br/> 2  <span class="blue1">GraphicsWindow</span><span class="brown">.FontSize =</span> <span class="red">10</span><br/> 3  <span class="blue1">GraphicsWindow</span><span class="brown">.BrushColor =</span> <span class="red">"Black"</span><br/> 4<br/> 5  yPos <span class="brown">=</span> <span class="red">0</span><br/> 6  <span class="purple"><span class="codestrong">For</span></span> angle <span class="brown">=</span> <span class="red">0</span> <span class="purple"><span class="codestrong">To</span></span> <span class="brown">(</span><span class="red">2</span> <span class="brown">*</span> <span class="blue1">Math</span><span class="brown">.PI)</span> <span class="purple"><span class="codestrong">Step</span></span> <span class="red">0.3</span><br/> 7    xPos <span class="brown">=</span> <span class="red">100</span> <span class="brown">* (</span><span class="red">1</span> <span class="brown">+</span> <span class="blue1">Math</span><span class="brown">.Sin(</span>angle<span class="brown">))</span><br/> 8    <span class="blue1">GraphicsWindow</span><span class="brown">.DrawText(</span>xPos<span class="brown">,</span> yPos<span class="brown">,</span> <span class="red">"Hello"</span><span class="brown">)</span><br/> 9    yPos <span class="brown">=</span> yPos <span class="brown">+</span> <span class="red">8</span><br/>10 <span class="purple"><span class="codestrong">EndFor</span></span></pre>&#13;
<p class="listcap"><a id="ch13ex6"/><em>Listing 13-6: Making a design with text</em></p>&#13;
<p class="indent">The loop counter in this example is an angle (in radians) that uses the values from 0 to 2π in increments of 0.3 (line 6). In each iteration, the sine of the angle is computed, and the answer is used to set the horizontal position of the cursor (line 7). The word <code>Hello</code> is then displayed at that position (line 8), and the variable <code>yPos</code> is adjusted to set the vertical position for the next output text (line 9). Experimenting with different <code>Step</code> sizes can create some very cool stuff, like the wavy design shown in <a href="ch13.html#ch13fig5">Figure 13-5</a>.</p>&#13;
<div class="image"><img alt="image" src="graphics/f13-05.jpg"/></div>&#13;
<p class="figcap"><a id="ch13fig5"/><em>Figure 13-5: The output of</em> DecimalStep.sb</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch13sb06"><strong>TRY IT OUT 13-6</strong></p>&#13;
<p class="noindent">Write a program that finds the sum of all odd numbers from 5 to 25.</p>&#13;
</div>&#13;
<h3 class="h3" id="ch13lev1sec03"><span epub:type="pagebreak" id="page_189"/><span class="blue"><strong>Nested Loops</strong></span></h3>&#13;
<p class="noindent">The statements in the body of a <code>For</code> loop can be any Small Basic statement, including another <code>For</code> loop. <em>Nesting</em> is when you put one <code>For</code> loop inside another <code>For</code> loop (no birds are involved). Using nested loops allows you to create iterations in two or more dimensions. This technique is important, and you can use it to solve a wide range of programming problems.</p>&#13;
<p class="indent">To understand the idea of nested <code>For</code> loops, you’ll examine a program that causes your computer to “jump” four times and “clap” three times after each jump. Because the program needs to count two actions (jumps and claps), it needs to use two loops, as shown in <a href="ch13.html#ch13ex7">Listing 13-7</a>. The counter for the outer loop, <code>j</code>, runs from 1 to 4. The counter for the inner loop, <code>c</code>, runs from 1 to 3.</p>&#13;
<pre>1 <span class="green"><span class="codeitalic">' NestedLoops.sb</span></span><br/>2 <span class="purple"><span class="codestrong">For</span></span> j <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">4</span>     <span class="green"><span class="codeitalic">' The jump counter</span></span><br/>3   <span class="blue1">TextWindow</span><span class="brown">.Write(</span><span class="red">"Jump "</span> <span class="brown">+</span> j <span class="brown">+</span> <span class="red">": "</span><span class="brown">)</span><br/>4   <span class="purple"><span class="codestrong">For</span></span> c <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">3</span>   <span class="green"><span class="codeitalic">' The clap counter</span></span><br/>5     <span class="blue1">TextWindow</span><span class="brown">.Write(</span><span class="red">"Clap "</span> <span class="brown">+</span> c <span class="brown">+</span> <span class="red">" "</span><span class="brown">)</span><br/>6   <span class="purple"><span class="codestrong">EndFor</span></span><br/>7   <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">""</span><span class="brown">)</span><br/>8 <span class="purple"><span class="codestrong">EndFor</span></span></pre>&#13;
<p class="listcap"><a id="ch13ex7"/><em>Listing 13-7: Nesting</em> <code><span class="codeitalic">For</code></span> <em>loops</em></p>&#13;
<p class="indent">In the first iteration of the outer loop (where <code>j = 1</code>), the inner loop repeats three times (for the three values of <code>c</code>); each time, it writes the word <code>Clap</code> followed by a space, the current value of <code>c</code>, and another space (line 5). When you nest <code>For</code> loops like this, the inner loop goes through all its iterations for each iteration of the outer loop. So the first iteration of the outer loop makes the program display <code>Jump 1: Clap 1 Clap 2 Clap 3</code>. When the inner loop ends, the program outputs an empty line (line 7) to move the cursor to the beginning of the next line, and the second iteration of the outer loop starts with <code>j = 2</code>. The inner loop runs again for <code>c = 1</code>, <code>2</code>, and <code>3</code>. This causes the program to display <code>Jump 2: Clap 1 Clap 2 Clap 3</code>. This continues, so the program displays <code>Jump 3: Clap 1 Clap 2 Clap 3</code> and then <code>Jump 4: Clap 1 Clap 2 Clap 3</code>. Then the program ends. Perhaps your computer wants to be a cheerleader!</p>&#13;
<p class="indent"><a href="ch13.html#ch13fig6">Figure 13-6</a> helps to explain how the program works. The outer circle represents each time the outer loop runs: for example, at the top of the outer circle, when <code>j = 1</code> in the outer loop, the inner loop runs three times, where <code>c = 1</code>, <code>c = 2</code>, and <code>c = 3</code>. Follow the outer loop and think through each inner loop. Continue until you get all the way around the outer circle.</p>&#13;
<div class="image"><span epub:type="pagebreak" id="page_190"/><img alt="image" src="graphics/f13-06.jpg"/></div>&#13;
<p class="figcap"><a id="ch13fig6"/><em>Figure 13-6: How</em> NestedLoops.sb <em>works</em></p>&#13;
<p class="indent">The output should look like this:</p>&#13;
<pre>Jump 1: Clap 1 Clap 2 Clap 3<br/>Jump 2: Clap 1 Clap 2 Clap 3<br/>Jump 3: Clap 1 Clap 2 Clap 3<br/>Jump 4: Clap 1 Clap 2 Clap 3</pre>&#13;
<p class="indent">Now let’s look at other problems where nested <code>For</code> loops come in handy!</p>&#13;
<h4 class="h4" id="ch13lev2sec07"><em><strong>Tessellating for Fun</strong></em></h4>&#13;
<p class="noindent">In this example, an application covers the graphics window by stamping a small image over it. The complete program is shown in <a href="ch13.html#ch13ex8">Listing 13-8</a>.</p>&#13;
<pre> 1 <span class="green"><span class="codeitalic">' Stamp.sb</span></span><br/> 2 <span class="blue1">GraphicsWindow</span><span class="brown">.Title =</span> <span class="red">"Stamp"</span><br/> 3<br/> 4 path <span class="brown">=</span> <span class="blue1">Program</span><span class="brown">.Directory</span><br/> 5 img <span class="brown">=</span> <span class="blue1">ImageList</span><span class="brown">.LoadImage(</span>path <span class="brown">+</span> <span class="red">"\Trophy.ico"</span><span class="brown">)</span><br/> 6<br/> 7 width <span class="brown">=</span> <span class="blue1">ImageList</span><span class="brown">.GetWidthOfImage(</span>img<span class="brown">)</span>    <span class="green"><span class="codeitalic">' Width of image</span></span><br/> 8 height <span class="brown">=</span> <span class="blue1">ImageList</span><span class="brown">.GetHeightOfImage(</span>img<span class="brown">)</span>  <span class="green"><span class="codeitalic">' Height of image</span></span><br/> 9<br/>10 <span class="blue1">GraphicsWindow</span><span class="brown">.Width =</span> <span class="red">8</span> <span class="brown">*</span> width    <span class="green"><span class="codeitalic">' 8 columns</span></span><br/>11 <span class="blue1">GraphicsWindow</span><span class="brown">.Height =</span> <span class="red">3</span> <span class="brown">*</span> height  <span class="green"><span class="codeitalic">' 3 rows</span></span><br/>12<br/>13 <span class="purple"><span class="codestrong">For</span></span> row <span class="brown">=</span> <span class="red">0</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">2</span>      <span class="green"><span class="codeitalic">' 3 rows</span></span><br/>14   <span class="purple"><span class="codestrong">For</span></span> col <span class="brown">=</span> <span class="red">0</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">7</span>    <span class="green"><span class="codeitalic">' 8 columns</span></span><br/>15     <span class="blue1">GraphicsWindow</span><span class="brown">.DrawImage(</span>img<span class="brown">,</span> col <span class="brown">*</span> width<span class="brown">,</span> row <span class="brown">*</span> height<span class="brown">)</span><br/>16   <span class="purple"><span class="codestrong">EndFor</span></span><br/>17 <span class="purple"><span class="codestrong">EndFor</span></span></pre>&#13;
<p class="listcap"><a id="ch13ex8"/><em>Listing 13-8: Stamping a pattern across the graphics window</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_191"/>Copy the <em>Trophy.ico</em> file from this chapter’s folder to your application’s folder, and then run this program to see the result. Your screen should look like <a href="ch13.html#ch13fig7">Figure 13-7</a>. Way to go, champ!</p>&#13;
<div class="image"><img alt="image" src="graphics/f13-07.jpg"/></div>&#13;
<p class="figcap"><a id="ch13fig7"/><em>Figure 13-7: The output of</em> Stamp.sb</p>&#13;
<p class="indent">The program loads an image file (<em>Trophy.ico</em>) from your application’s folder and saves the image’s identifier in a variable named <code>img</code> (line 5). This is done by calling the <code>ImageList</code> object’s <code>LoadImage()</code> method. The program then uses the <code>ImageList</code> object’s methods to tell you the width and height of the loaded image in pixels (lines 7–8). The image’s identifier (the <code>img</code> variable) is passed as an argument to the called methods. In lines 10–11, the program resizes the graphics window to hold eight horizontal and three vertical copies of the image. The program then uses a nested loop to stamp the image at different positions in the graphics window. The outer loop runs for three rows, and the inner loop runs for eight columns, for a total of 24 (3 <em>×</em> 8) iterations (lines 13–14). In each iteration, the x- and y-positions of the image are computed based on the dimensions of the image, and the image is drawn at that location (line 15). Now your trophy collection is bigger than Michael Jordan’s is!</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch13sb07"><strong>TRY IT OUT 13-7</strong></p>&#13;
<p class="noindent">Update <a href="ch13.html#ch13ex8">Listing 13-8</a> to stamp a different image instead of a trophy. Then show your friends and family!</p>&#13;
</div>&#13;
<h4 class="h4" id="ch13lev2sec08"><em><strong>Multiple Nesting Levels</strong></em></h4>&#13;
<p class="noindent">You can have more than two levels of nesting. <a href="ch13.html#ch13ex9">Listing 13-9</a> displays all possible combinations of quarters, dimes, and nickels that add up to 50 cents.</p>&#13;
<pre> 1 <span class="green"><span class="codeitalic">' CoinsAdder.sb</span></span><br/> 2 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"Quarters    Dimes    Nickels"</span><span class="brown">)</span><br/> 3 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"--------    -----    -------"</span><span class="brown">)</span><br/> 4<br/> 5 <span class="purple"><span class="codestrong">For</span></span> Q <span class="brown">=</span> <span class="red">0</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">2</span>       <span class="green"><span class="codeitalic">' Quarters</span></span><br/> 6   <span class="purple"><span class="codestrong">For</span></span> D <span class="brown">=</span> <span class="red">0</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">5</span>     <span class="green"><span class="codeitalic">' Dimes</span></span><br/> 7     <span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">0</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">10</span>  <span class="green"><span class="codeitalic">' Nickels</span></span><br/> 8       <span class="purple"><span class="codestrong">If</span></span> <span class="brown">(</span>Q <span class="brown">*</span> <span class="red">25</span> <span class="brown">+</span> D <span class="brown">*</span> <span class="red">10</span> <span class="brown">+</span> N <span class="brown">*</span> <span class="red">5</span> <span class="brown">=</span> <span class="red">50</span><span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span><br/> 9         <span class="blue1">TextWindow</span><span class="brown">.Write(</span>Q<span class="brown">)</span><br/>10         <span class="blue1">TextWindow</span><span class="brown">.CursorLeft =</span> <span class="red">13</span><br/>11         <span class="blue1">TextWindow</span><span class="brown">.Write(</span>D<span class="brown">)</span><br/>12         <span class="blue1">TextWindow</span><span class="brown">.CursorLeft =</span> <span class="red">24</span><br/>13         <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>N<span class="brown">)</span><br/>14       <span class="purple"><span class="codestrong">EndIf</span></span><br/>15     <span class="purple"><span class="codestrong">EndFor</span></span><br/>16   <span class="purple"><span class="codestrong">EndFor</span></span><br/>17 <span class="purple"><span class="codestrong">EndFor</span></span></pre>&#13;
<p class="listcap"><a id="ch13ex9"/><em>Listing 13-9: Listing the combinations of coins that add up to 50 cents</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_192"/>The first loop initially keeps track of quarters by setting <code>Q = 0</code>. The second loop runs six times and counts all the dimes: <code>For D = 0 To 5</code>. For each pass of the second loop, the third loop runs 11 times, keeping track of the nickels: <code>For N = 0 To 10</code>. That means the <code>If</code> condition in line 8 is checked 198 times (3 <em>×</em> 6 × 11)! If the coin values total 50, that combination is displayed (lines 9–13). While looping through, the code uses the <code>CursorLeft</code> property to line up the columns and rows properly. Here’s the output:</p>&#13;
<pre>Quarters    Dimes    Nickels<br/>--------    -----    -------<br/>0            0          10<br/>0            1          8<br/>0            2          6<br/>0            3          4<br/>0            4          2<br/>0            5          0<br/>1            0          5<br/>1            1          3<br/>1            2          1<br/>2            0          0</pre>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch13sb08"><strong>TRY IT OUT 13-8</strong></p>&#13;
<p class="noindent">Write a program that finds all the sets of three integers that are less than 20 and can be the sides of a right triangle.</p>&#13;
</div>&#13;
<h3 class="h3a" id="ch13lev1sec04"><span class="blues"><strong>Programming Challenges</strong></span></h3>&#13;
<p class="noindent">If you get stuck, check out <em><a href="http://nostarch.com/smallbasic/">http://nostarch.com/smallbasic/</a></em> for the solutions and for more resources and review questions for teachers and students.</p>&#13;
<ol>&#13;
<li><p class="noindenta">Write a <code>For</code> loop that displays this output:</p>&#13;
<pre>I had 1 slices of pizza.<br/>I had 2 slices of pizza.<br/>I had 3 slices of pizza.<br/>...<br/>I had 10 slices of pizza.</pre></li>&#13;
<li><span epub:type="pagebreak" id="page_193"/><p class="noindenta">Although the pizza in the previous exercise is very yummy, it’s not grammatically correct, because the program outputs <code>1 slices of pizza</code>. Fix the program so that its output is grammatically correct (and you won’t embarrass your English teacher). (Hint: use an <code>If</code> statement inside the <code>For</code> loop.)</p></li>&#13;
<li><p class="noindenta">We built a game for you to quiz Alice on her multiplication so she’ll be ready for the queen’s questions. The program generates 10 random multiplication questions and asks Alice to enter the answer for each question. Alice earns one point for each correct answer. If she enters a wrong answer, show her the correct answer. The program ends by showing her total score. Re-create the program, run it, and explain how it works:</p>&#13;
<pre>score <span class="brown">=</span> <span class="red">0</span><br/><span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="red">10</span>   <span class="green"><span class="codeitalic">' Asks 10 questions</span></span><br/>  n1 <span class="brown">=</span> <span class="blue1">Math</span><span class="brown">.GetRandomNumber(</span><span class="red">10</span><span class="brown">)</span><br/>  n2 <span class="brown">=</span> <span class="blue1">Math</span><span class="brown">.GetRandomNumber(</span><span class="red">10</span><span class="brown">)</span><br/><br/>  <span class="blue1">TextWindow</span><span class="brown">.Write(</span>n1 <span class="brown">+</span> <span class="red">" x "</span> <span class="brown">+</span> n2 <span class="brown">+</span> <span class="red">"? "</span><span class="brown">)</span><br/>  ans <span class="brown">=</span> <span class="blue1">TextWindow</span><span class="brown">.ReadNumber()</span><br/><br/>  <span class="purple"><span class="codestrong">If</span></span> <span class="brown">(</span>ans <span class="brown">=</span> n1 <span class="brown">*</span> n2<span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span>   <span class="green"><span class="codeitalic">' Increases the score</span></span><br/>    score <span class="brown">=</span> score <span class="brown">+</span> <span class="red">1</span><br/>  <span class="purple"><span class="codestrong">Else</span></span>                      <span class="green"><span class="codeitalic">' Shows the correct answer</span></span><br/>    <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"Incorrect --&gt; "</span> <span class="brown">+ (</span>n1 <span class="brown">*</span> n2<span class="brown">))</span><br/>  <span class="purple"><span class="codestrong">EndIf</span></span><br/><span class="purple"><span class="codestrong">EndFor</span></span><br/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"Your score is: "</span> <span class="brown">+</span> score <span class="brown">+</span> <span class="red">"/10"</span><span class="brown">)</span></pre></li>&#13;
<li><p class="noindenta">Write a program that draws the following image. (Hint: use a <code>For</code> loop to draw the line pattern for each of the four corners.)</p>&#13;
<div class="image1"><img alt="image" src="graphics/f0193-01.jpg"/></div><span epub:type="pagebreak" id="page_194"/></li>&#13;
</ol>&#13;
</body></html>