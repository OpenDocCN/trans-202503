<html><head></head><body>
<div id="sbo-rt-content"><section>
<header>
<h1 class="chapter">
<span class="ChapterNumber"><span epub:type="pagebreak" id="Page_147" title="147"/><a class="XrefDestination" id="8"/><span class="XrefDestination" id="xref-502727c08-001"/>8</span><br/>
<span class="ChapterTitle"><a class="XrefDestination" id="Polyalphabeticciphers"/><span class="XrefDestination" id="xref-502727c08-002"/>Polyalphabetic ciphers</span></h1>
</header>
<figure class="graphic">
<img alt="" class="" height="475" src="image_fi/502727c08/g08001.png" width="844"/></figure>
<p class="BodyFirst"><span epub:type="pagebreak" id="Page_148" title="148"/>The fourth inscription on <em>Kryptos</em>, the sculpture located at CIA headquarters in Langley, Virginia, is the most famous unsolved crypto mystery created in the last four decades. The other three ciphertexts on this artwork have been solved.</p>
<p><em>Kryptos</em> and at least two other artworks by the sculptor Jim Sanborn involve a kind of encryption called a <em>polyalphabetic cipher</em>, meaning a cipher that switches between different substitution tables. An overview of <em>Kryptos</em> is given in <span class="xref" itemid="xref_target_Appendix A">Appendix A</span>.</p>
<h2 id="h1-502727c08-0001"><a class="XrefDestination" id="Howapolyalphabeticcipherworks"/><span class="XrefDestination" id="xref-502727c08-003"/>How a polyalphabetic cipher works</h2>
<p class="BodyFirst">To introduce polyalphabetic ciphers, we start with a miniature sculpture (called a maquette) that Sanborn made in the late 1980s, before he created the actual sculpture (<a href="#figure8-1" id="figureanchor8-1">Figure 8-1</a>). This shoebox-sized model looks similar to the original but bears a completely different message.</p>
<figure>
<img alt="" class="" height="448" src="image_fi/502727c08/F08001.png" width="694"/>
<figcaption><p><a id="figure8-1">Figure 8-1</a>: A shoebox-sized maquette of <em>Kryptos</em> with a simpler encryption. The cipher used is the most common polyalphabetic encryption method: the Vigenère cipher<em>.</em></p></figcaption>
</figure>
<p>For decades, this maquette was unknown to the public; but in 2015, Ed Scheidt, Sanborn’s crypto consultant, showed it to participants at a <em>Kryptos</em> meeting organized by Elonka.<sup class="endnote"><a href="b06.xhtml#c08-endnote-1" id="c08-noteref-1">1</a></sup> Here’s the encrypted part:</p>
<p class="BodyCustom"><code>TIJVMSRSHVXOMCJVXOENA</code></p>
<p class="BodyCustom"><code>KQUUCLWYXVHZTFGJMKJHG</code></p>
<p class="BodyCustom"><code>DYRPMASMZZNAKCUEURRHJ</code></p>
<p class="BodyCustom"><code>KLGEMVFMOKCUEURKSVVMZ</code></p>
<p class="BodyCustom"><code>YYZIUTJJUJCZZITRFHVCT</code></p>
<p class="BodyCustom"><code>XNNVBGIXKJNZFXKTBVYYX</code></p>
<p class="BodyCustom"><code>NBZYIAKNVEKPYZIUTJYCA</code></p>
<p class="BodyContinued"><span epub:type="pagebreak" id="Page_149" title="149"/>Jew-Lee Lann-Briere and Bill Briere broke the cryptogram a few hours after the dinner was over, using only paper and pencil. After publication, Christoph Tenzer found the solution as well. It turned out that Sanborn had used the so-called Vigenère cipher to encrypt this message.</p>
<h3 id="h2-502727c08-0001"><a class="XrefDestination" id="Vigenèrecipher"/><span class="XrefDestination" id="xref-502727c08-004"/>Vigenère cipher</h3>
<p class="BodyFirst">The cipher today known as the Vigenère cipher was first described in the sixteenth century by Giovan Battista Bellaso (1505–?). Later, in the nineteenth century, its invention was misattributed to Bellaso’s contemporary Blaise de Vigenère (1523–1596). We’ll explain how this encryption method works using the plaintext of the cryptogram on the <em>Kryptos</em> maquette (which contains a few spelling errors; the last word resulted from a mistake Sanborn made):<sup class="endnote"><a href="b06.xhtml#c08-endnote-2" id="c08-noteref-2">2</a></sup></p>
<p class="BodyCustom"><code>CODES MAY BE DIVIDED INTU TWO DIFFERENT CLASSES, NAMELY SUBSTITUTIONAL AND TRANSPOSITIONAL TYPES, THE TRANSPOSITIONAL BEING THE HARDEST TO DECHPHER WHTHOUT TPNQJHFCDZDHIU.</code></p>
<p class="BodyContinued">To encrypt this message using the Vigenère cipher, we repeatedly write some keyword on the line below our plaintext, assign each letter a number value (e.g., <code class="bold">A</code> = <code>0</code>, <code class="bold">B</code> = <code>1</code>, <code class="bold">C</code> = <code>2</code>, etc.), and then add the letters of the plaintext and keyword column-wise. If the result is greater than twenty-five, we subtract twenty-six. Each number is then converted back into a letter.</p>
<p>Sanborn reportedly intended to use the keyword <code>GRU</code>. However, he started encrypting his plaintext with the second letter of his key, effectively changing it to <code>RUG</code>. For purposes of this demonstration, we’ll consider the keyword to be <code>RUG</code>:</p>
<p class="BodyCustom"><code>CODES MAY BE DIVIDED INTU TWO DIFFERENT CLASSES NAMELY SUBSTITUTIONAL . . .</code></p>
<p class="BodyCustom"><code>RUGRU GRU GR UGRUGRU GRUG RUG RUGRUGRUG RUGRUGR UGRUGR UGRUGRUGRUGRUG . . .</code></p>
<p class="BodyCustom"><code>---------------------------------------------------------------------------</code></p>
<p class="BodyCustom"><code>TIJVM SRS HV XOMCJVX OENA KQU UCLWYXVHZ TFGJMKJ HGDYRP MASMZZNAKCUEUR . . .</code></p>
<p class="BodyContinued">We get the exact ciphertext written on the miniature sculpture. To decrypt the ciphertext, we subtract the keyword from the ciphertext.</p>
<p>It is easy to see that a Vigenère cipher effectively consists of several Caesar ciphers (<a href="#figure8-2" id="figureanchor8-2">Figure 8-2</a>). So, with a three-letter keyword (<code>RUG</code>), we derive the following:</p>
<ul class="disc">
<li>The first, fourth, seventh, and tenth letters of the plaintext are encrypted with a Caesar cipher and with the key <code class="bold">A</code> = <code>R</code>.</li>
<li>For letters two, five, and eight, the Caesar substitution <code class="bold">A</code> = <code>U</code> is applied.</li>
<li>The third Caesar cipher key is <code class="bold">A </code>= <code>G</code>.</li>
</ul>
<p>Note that Sanborn defined the scheme <code class="bold">A</code> = <code>0</code>, <code class="bold">B</code> = <code>1</code>, <code class="bold">C</code> = <code>2</code>, etc. This is the way the Vigenère cipher is usually used today, because computer-savvy people tend to start counting at zero. However, before the computer age, almost all Vigenère encipherers used the scheme <code class="bold">A</code> = <code>1</code>, <code class="bold">B</code> = <code>2</code>, <code class="bold">C</code> = <code>3</code>, etc.</p>
<span epub:type="pagebreak" id="Page_150" title="150"/><figure>
<img alt="" class="" height="429" src="image_fi/502727c08/f08002.png" width="686"/>
<figcaption><p><a id="figure8-2">Figure 8-2</a>: A Vigenère cipher with a three-letter keyword (here, <var>RUG</var>) can be regarded as consisting of three Caesar ciphers.</p></figcaption>
</figure>
<p>Today, numerous computer programs and commonly available utilities implement the Vigenère cipher.</p>
<h3 id="h2-502727c08-0002"><a class="XrefDestination" id="Otherpolyalphabeticciphers"/><span class="XrefDestination" id="xref-502727c08-005"/>Other polyalphabetic ciphers</h3>
<p class="BodyFirst">The Vigenère cipher originated from the insight that a simple substitution cipher is easy to break with frequency analysis. An obvious way to prevent this is to use several substitution tables instead of one and to switch among them. If we have, say, five substitution tables, we can use the first one for the first letter of the plaintext, the second one for the second letter, and so on. When we have reached the sixth plaintext letter, we return to the first substitution table.</p>
<p>The second row of a substitution table is sometimes referred to as a <em>cipher alphabet</em>, or simply <em>alphabet</em>, in cryptology. Because a simple substitution cipher is based on only one substitution table, it is called <em>monoalphabetic</em>. A cipher that switches between different substitution tables is called <em>polyalphabetic</em>. The Vigenère cipher is a polyalphabetic cipher, because it uses as many substitution tables as there are letters in the keyword. For example, when it uses the keyword <code>RUG</code> (like on the <em>Kryptos</em> maquette), three tables are applied:</p>
<p class="BodyCustom"><code class="bold">ABCDEFGHIJKLMNOPQRSTUVWXYZ</code></p>
<p class="BodyCustom"><code>--------------------------</code></p>
<p class="BodyCustom"><code>RSTUVWXYZABCDEFGHIJKLMNOPQ</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code class="bold">ABCDEFGHIJKLMNOPQRSTUVWXYZ</code></p>
<p class="BodyCustom"><code>--------------------------</code></p>
<p class="BodyCustom"><code>UVWXYZABCDEFGHIJKLMNOPQRST</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_151" title="151"/><code class="bold">ABCDEFGHIJKLMNOPQRSTUVWXYZ</code></p>
<p class="BodyCustom"><code>--------------------------</code></p>
<p class="BodyCustom"><code>GHIJKLMNOPQRSTUVWXYZABCDEF</code></p>
<p class="BodyContinued">We can conveniently merge these three tables into one called a Vigenère table:</p>
<p class="BodyCustom"><code class="bold">  ABCDEFGHIJKLMNOPQRSTUVWXYZ</code></p>
<p class="BodyCustom"><code>  --------------------------</code></p>
<p class="BodyCustom"><code>1 RSTUVWXYZABCDEFGHIJKLMNOPQ</code></p>
<p class="BodyCustom"><code>2 UVWXYZABCDEFGHIJKLMNOPQRST</code></p>
<p class="BodyCustom"><code>3 GHIJKLMNOPQRSTUVWXYZABCDEF</code></p>
<p class="BodyContinued">This merged table includes three alphabets, represented by the lines numbered 1, 2, and 3.</p>
<p>Apart from the Vigenère cipher, many other polyalphabetic ciphers are mentioned in cryptologic literature. For an overview, check out the website of the American Cryptogram Association, which has done a great job of classifying encryption methods.<sup class="endnote"><a href="b06.xhtml#c08-endnote-3" id="c08-noteref-3">3</a></sup> In this book, we limit ourselves to those polyalphabetic ciphers we have encountered in practice. All of these can be regarded as variants of the Vigenère cipher.</p>
<h3 id="h2-502727c08-0003"><a class="XrefDestination" id="One-timepad"/><span class="XrefDestination" id="xref-502727c08-006"/>One-time pad</h3>
<p class="BodyFirst">The Vigenère cipher becomes more secure the longer the keyword is. For maximum security, we could even choose a key that is as long as the message! This can be done by using very long text, for instance, a poem or a paragraph from a novel.</p>
<p>It is, however, much more common to use a key that has a sequence of random letters of the same length as the plaintext, for example, the random string <code>LAVBF HJHWQ UIELS KJFLS JFKSA JHFQI UDAJL KX</code>. Now, the plaintext <code class="bold">I TRAVEL OVER THE SEA AND RIDE THE ROLLING SKY</code> (taken from the 1975 Fairport Convention song “Rising for the Moon”) encrypts as follows:</p>
<p class="BodyCustom"><code>Plaintext:    </code><code class="bold">ITRA VELOVE RT HESEAAN DRIDE THER OLLINGS KY</code></p>
<p class="BodyCustom"><code>Key:          LAVB FHJHWQ UI ELSKJFL SJFKS AJHF QIUDAJL KX</code></p>
<p class="BodyCustom"><code>--------------------------------------------------------------------------</code></p>
<p class="BodyCustom"><code>Ciphertext:   TTMB ALUVRU LB LPKOJFY VANNW TQLW ETFLNPD UV</code></p>
<p class="BodyContinued">We call this type of cipher a <em>one-time pad</em>. The name comes from early implementations of the cipher, when the random-letter sequence was distributed as a pad of paper that allowed the top sheet to be torn off and destroyed after use.</p>
<p>If used properly, meaning the key is random and only used once, then the one-time pad is an encryption method that cannot be broken. This is because, with this method, any plaintext can be encrypted to every possible ciphertext of the same length. Considered the other way, a single ciphertext could be decrypted to any possible plaintext of that length, with no way of distinguishing one possible plaintext from another.</p>
<p>Because of its security, the one-time pad used to be very popular. Militaries and diplomatic services heavily used it in the early Cold War era <span epub:type="pagebreak" id="Page_152" title="152"/>of the 1950s. Many spies communicated via one-time pad encryption with their case officers, who provided them with a long list of random letters or numbers to use as keys.</p>
<p>Cipher machines also applied the one-time pad. Most of these devices looked like typewriters, and virtually all of them used a binary version of the one-time pad scheme that was also known as the Vernam cipher, after Gilbert S. Vernam (1890–1960). This means that every character was encoded as a sequence of zeros and ones; the key, too, was a series of zeros and ones usually taken from a punched tape. Adding the plaintext to the ciphertext meant applying an <em>exclusive-or operation</em> (see <span class="xref" itemid="xref_target_Appendix C">Appendix C</span>).</p>
<p>However, all users of the one-time pad faced a serious problem: they needed a huge amount of key material and, as a result, elaborate processes to distribute these keys to the users. This is because, by definition, each key can only be used once, and a one-time pad’s key is always as long as the message to be encrypted. This laborious key handling is the reason the one-time pad began to lose its significance when electronics and computer technology emerged in the 1960s and a new generation of encryption methods became available.</p>
<h2 id="h1-502727c08-0002"><a class="XrefDestination" id="Howtodetectapolyalphabeticcipher"/><span class="XrefDestination" id="xref-502727c08-007"/>How to detect a polyalphabetic cipher</h2>
<p class="BodyFirst">To detect a Vigenère cipher, we need a frequency analysis and the index of coincidence of the ciphertext. <a href="#figure8-3" id="figureanchor8-3">Figure 8-3</a> shows the letter frequencies of the Vigenère-encrypted text on the <em>Kryptos</em> maquette and, for comparison, that of a typical English text. Note that the frequency of the most common letter is 7.48% in this Vigenère cryptogram, compared to around 11.89% in plain English. In general, the frequency distribution of a Vigenère cryptogram is flatter than that of a text encrypted in a simple substitution cipher: frequent letters are less frequent and rare letters are less rare.</p>
<figure>
<img alt="" class="" height="312" src="image_fi/502727c08/f08003.png" width="694"/>
<figcaption><p><a id="figure8-3">Figure 8-3</a>: The letter frequency diagrams of a Vigenère ciphertext (top) and an English plaintext (bottom). As can be seen, the frequency distribution of a Vigenère cryptogram is flatter. (Note that the scales are slightly different between the two diagrams.)</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_153" title="153"/>Remember that the index of coincidence of an English text (i.e., the probability that two randomly drawn letters of the cryptogram are the same) is about 6.7%. This doesn’t change if the text is encrypted in a simple substitution cipher. The index of coincidence of the <em>Kryptos</em> maquette text is about 4.3%, which is considerably lower. (We can compute this value with the Cipher Tools utilities at <a class="LinkURL" href="https://rumkin.com/tools/cipher/">https://rumkin.com/tools/cipher/</a> or the dCode website at <a class="LinkURL" href="https://dcode.fr/en">https://dcode.fr/en</a>.) Completely random text has an index of coincidence of around 3.8%. In general, the index of coincidence of a Vigenère cryptogram lies somewhere between the values of plain language and random text. A one-time pad cryptogram is indistinguishable from random text and therefore has an index of coincidence of about 3.8%.</p>
<p>It is important to note that polyalphabetic ciphers often resemble letter-pair substitutions. We will explain in <span class="xref" itemid="xref_target_Chapter 12"><a href="c12.xhtml">Chapter 12</a></span> how to distinguish between these two techniques.</p>
<h2 id="h1-502727c08-0003"><a class="XrefDestination" id="Howtobreakapolyalphabeticcipher"/><span class="XrefDestination" id="xref-502727c08-008"/>How to break a polyalphabetic cipher</h2>
<p class="BodyFirst">For centuries, the Vigenère cipher and other polyalphabetic ciphers were widely considered unbreakable, deemed “le chiffre indéchiffrable.” Of course, this designation was far from justified, since, as early as the seventeenth century, word guessing had been described as a method for solving systems of this kind.<sup class="endnote"><a href="b06.xhtml#c08-endnote-4" id="c08-noteref-4">4</a></sup> In the nineteenth century, Kasiski’s method (discussed later in this section) was developed. Today, there are many approaches to breaking polyalphabetic ciphers, most of which work well as long as one is not dealing with a one-time pad. Some of these codebreaking methods can be employed manually; others require computer support. Like many other encryption algorithms covered in this book, most polyalphabetic ciphers can be attacked with the computerized hill-climbing method (see <span class="xref" itemid="xref_target_Chapter 16"><a href="c16.xhtml">Chapter 16</a></span>).</p>
<p>In the following, we will focus on the Vigenère cipher and introduce a number of methods to solve it. Most of these can also be transferred to other polyalphabetic ciphers and, even if they can be applied manually, have long been implemented in computer programs. If you enter “Vigenère solver” in a search engine, you will find numerous websites that break Vigenère cryptograms with various methods (sometimes not even documenting the method used). In addition, you can, of course, use a utility such as CrypTool 2 or dCode for solving a Vigenère cipher with various methods.</p>
<h3 id="h2-502727c08-0004"><a class="XrefDestination" id="Wordguessing"/><span class="XrefDestination" id="xref-502727c08-009"/>Word guessing</h3>
<p class="BodyFirst">In the 1990s, when Klaus was a computer science student at a German university, he was tasked with solving a cryptogram as homework—something he had never done before. He knew that the cipher was a Vigenère and that the text and keyword were in English. Also, the mapping between letters and numbers was performed according to the <code class="bold">A</code> = <code>0</code>, <code class="bold">B</code> = <code>1</code>, <code class="bold">C</code> = <code>2</code> scheme. Here’s an excerpt of the ciphertext:</p>
<p class="BodyCustom"><code>"VMFA CKT ZM, KK ZSSH,", YX QTER, "DCL VYG'P KNB PHS DJCB. MFN ATJ'H QWV BL YNCSH FY RAA PZZCWMSAF NBUXDBJWYSCR." FX PFNSU MM FWYJ VZL CRAG GZRSC YESWQVEW UQH YVVR HNOH BCLEBG'P RT WK.</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_154" title="154"/><code>TPMDIW ZRR GG PVJ ALW YGZ GVIVEAAAR FH YBK.</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>"B'I UFAV," AC LWWI, "KV'EJ LAS BVF KSLPG KWILR."</code></p>
<p class="BodyContinued">As can be seen, punctuation and spaces are visible. This made it possible, as with an Aristocrat cipher, to guess words. For instance, the letter sequences <code>YX QTER</code> are located between two passages in quotation marks, which probably indicate direct speech. Klaus thought that <code class="bold">HE SAID</code> was a good guess. To check this hypothesis, he subtracted the plaintext from the guessed plaintext:</p>
<p class="BodyCustom"><code>YX QTER</code></p>
<p class="BodyCustom"><code>HE SAID</code></p>
<p class="BodyCustom"><code>-------</code></p>
<p class="BodyCustom"><code>RT YTWO</code></p>
<p class="BodyContinued">For a computer science student, the rest of the keyword was not hard to guess: it’s <code>FORTYTWO</code>, the answer to the ultimate question of life, the universe, and everything in Douglas Adams’s bestselling 1979 novel <em>The Hitchhiker’s Guide to the Galaxy</em> (see <a href="#figure8-4" id="figureanchor8-4">Figure 8-4</a>). Decrypting the whole text with this keyword revealed that the plaintext had been taken from the novel, as well. Klaus had solved the challenge, igniting his lifelong interest in codebreaking.</p>
<figure>
<img alt="" class="" height="508" src="image_fi/502727c08/f08004.png" width="312"/>
<figcaption><p><a id="figure8-4">Figure 8-4</a>: A Vigenère-encrypted passage from Douglas Adams’s famous 1979 novel was the first cryptogram ever broken by author Klaus Schmeh. The keyword was <code>FORTYTWO</code>.</p></figcaption>
</figure>
<h3 id="h2-502727c08-0005"><span epub:type="pagebreak" id="Page_155" title="155"/><a class="XrefDestination" id="Checkingforrepeatingpatterns(Kasiski’smethod)"/><span class="XrefDestination" id="xref-502727c08-010"/>Checking for repeating patterns (Kasiski’s method)</h3>
<p class="BodyFirst">If no punctuation or spaces are given, breaking a Vigenère cipher becomes a little more difficult. Nevertheless, a skilled codebreaker can solve a simple Vigenère cryptogram in under twenty minutes without computer support. Here is a larger encrypted excerpt from the previous example, with punctuation and spaces omitted:</p>
<p class="BodyCustom"><code>KWWMC XJGJQ FGBLH OYSIA CPWGT IKHDM DSMCL LCTJR QMZGE BJTWC</code></p>
<p class="BodyCustom"><code>EMMYW PNUPX JEKKG ICEBH VSWHY TRPWG FRMTL VEBLI GAGLC OWRVG</code></p>
<p class="BodyCustom"><code>NTPVR FCIPH OGJFN TQTOH MSPLY RKBQM YNKTJ WSCKA CKSCW RJACP</code></p>
<p class="BodyCustom"><code>WGFQR KZHJP FGVWJ BBSKC IFBXO QJBUX BYNCR OETNX ICWSJ ICVET</code></p>
<p class="BodyCustom"><code>NQREJ RDSBO JYMKP MKOKT LWOVF PSRYG ZKTFB XBYKF YVVEM VWZHC    5</code></p>
<p class="BodyCustom"><code>LGABH QZFZH SLHMJ BFNEA PVTIX AFXZW IBKDL HSWYV VPYLW ZXCRW</code></p>
<p class="BodyCustom"><code>GKAQY ARECE EBJRV LAXJR FBKHD ZABLV ZLIAW BYVFN EAEBY SIOCG</code></p>
<p class="BodyCustom"><code>EBLUV GCKWH NCELY GZFFQ ZTJFE LNBXA YWOCO IXZJX ZVNGX XLXOH</code></p>
<p class="BodyCustom"><code>MOKAC AWRSC UBQVA FSWSE CFKBL CCHGW YVFFR VRXNW XHZVQ TJRYV</code></p>
<p class="BodyCustom"><code>VHLEU JJGKB EXOZJ TKBLF NZUFF LQXNC KVZLK BCVYM RGAXO HWMNX    10</code></p>
<p class="BodyCustom"><code>PXWDW CEHSG YSIGK HSMJS XGRUM NPHMS KNKTJ RFDIX BBHSH HZHLY</code></p>
<p class="BodyCustom"><code>KFQWK MJXBI WVRMQ AAKFG SRLHI SFBJT EKAOY KRKPB KFNBW TAMDS</code></p>
<p class="BodyCustom"><code>BOJTL XNJTI JPMKN WJRDT LMKRF MYXUT ODFFK BANHO WZPGC KRCZG</code></p>
<p class="BodyCustom"><code>RGBPK FWWVW ZXYOZ GVLMF AHMWE ZFTZU TBVLC KECZG CRUKK BLKZM</code></p>
<p class="BodyCustom"><code>FAEGO CSPFB YVBOJ MMLAS YVRMY KPVZF UXLMO VTIJX EHPQQ SRKCW    15</code></p>
<p class="BodyCustom"><code>KIYCW MFXSO DPVYM KAHMS UTWPW GTIKV MFACK TZMKK ZSSHY XQTER</code></p>
<p class="BodyCustom"><code>DCLVY GPKNB PHSDJ CBMFN ATJHQ WVBLY NCSHF YRAAP ZZCWM SAFNB</code></p>
<p class="BodyCustom"><code>UXDBJ WYSCR FXPFN SUMMF WYJVZ LCRAG GZRSC YESWQ VEWUQ HYVVR</code></p>
<p class="BodyCustom"><code>HNOHB CLEBG PRTWK TPMDI WZRRG GPVJA LWYGZ GVIVE AAARF HYBKB</code></p>
<p class="BodyCustom"><code>IUFAV ACLWW IKVEJ LASBV FKSLP GKWIL RBIOK FRBBR KIWSX HGGCH    20</code></p>
<p class="BodyCustom"><code>TVROC MKOHQ VIRBP GFWUF PINCX GVKEK EDUWE ZFBOT ZFYTR TJRWC</code></p>
<p class="BodyCustom"><code>CEGGC WYFFN LWPVJ HFIMY DWXVV TBMDW XPPIY LOVFG XHRMK PJPLB</code></p>
<p class="BodyCustom"><code>JMWBI WKLEH EBLHF UCUQW QHWBP LPWAS YXYKZ CKWKL YBZOW HYNPP</code></p>
<p class="BodyCustom"><code>DMXWK ZMBJU YCSXZ NEZYA IIPHO GJFJA MHGVN GWBLZ AFFHY BKYKF</code></p>
<p class="BodyCustom"><code>FPZMR AABXH FINXZ OSRGN RBPOB OPTET EBBVR MBHUC ZAVTL PDMXW    25</code></p>
<p class="BodyCustom"><code>KZMMP CGSSN GEPVJ GRBBB PGFPP IYLOM TIMXE HPHTP LBJWX MUOJL</code></p>
<p class="BodyCustom"><code>CLXMU OJLCL WFJRV OGVAG BVZVF THZTK JHKXL STDCX RHZFN JVYPH</code></p>
<p class="BodyCustom"><code>IDTWE MYMKD TWEMZ OAFDT RLRPD WQGKH RAAFU SFIJX ZOXVW KMFLC</code></p>
<p class="BodyCustom"><code>NBKUR HLCNB KTTXN MKOJM NXKDQ SCBTB JUFHG HGGPQ GSZGE TLCNB</code></p>
<p class="BodyCustom"><code>KWGKA QYZPB LUAHB SVGYK ACKHV GEBRS SHFPM GZSWK YTRLO CLFVT    30</code></p>
<p class="BodyCustom"><code>RTXCZ HGHGG POYVR MQHIO SMGXM IHSTT GHGGP PFFVL MDASS HFZCM</code></p>
<p class="BodyCustom"><code>PVJFV TLWSV FHJLM ZNSFH RUMNP DTWEM ZMDOY GFFYG UDJCG ECHBD</code></p>
<p class="BodyCustom"><code>TWEMY TNSXC BXCGP CLSKM FXNSY VVRMY PSSKZ LFMDO YDVHN EAKTI</code></p>
<p class="BodyCustom"><code>CWHNO HTBTX YGZTT FREJP KFPCL MUAAF JHYXF XHZYV VRUTJ HJRKH</code></p>
<p class="BodyCustom"><code>ZXIFU FFLQX NKFBK XBMKP JOKIM BJHID FBLMZ KFGEM YGUKM SIXGG    35</code></p>
<p class="BodyCustom"><code>LOWHZ VSEWF NHNTQ CQGYO ERAHJ JJBZX LMLCN BKTTX NMQCE ZUTUT</code></p>
<p class="BodyCustom"><code>WCDIM BJHXO STLWY VJKFN JWDOA SRGGV AZNHK ECVKH YOXXY MLCNB</code></p>
<p class="BodyCustom"><code>KWUBP VFLVL MOAFY VVWMH NOSRJ ICGZO UZVTQ TJHFA FNLMK TYWDX</code></p>
<p class="BodyCustom"><code>YMLCN BKXUA EQMKF NJWXS YVVGC TNSXH GNZMK DTWEM BAEGB WWXMY</code></p>
<p class="BodyCustom"><code>YCZFJ XUTJH JRTEG FXWSU IHQXO PZHYX UTJHJ RRQCL DSIWU GRDJC    40</code></p>
<p class="BodyCustom"><code>BKYRF XFIXH CBIXZ OCSJA CYHIX VVWFH PZDIE WCKPV JRVKG LEJJU</code></p>
<p class="BodyCustom"><code>IBLLK TYVV</code></p>
<p><span epub:type="pagebreak" id="Page_156" title="156"/>The trick is to first discover the length of the keyword. Once we know it, solving a Vigenère cipher means solving a few Caesar ciphers. A good way to guess the keyword length is to look for repeating patterns in a cryptogram, a technique referred to as <em>Kasiski’s method</em>. For instance, in lines 22 and 26, we find the repeating pattern <code>PPIYLO</code>:</p>
<figure class="graphic">
<img alt="" class="" height="167" src="image_fi/502727c08/g08002.png" width="694"/></figure>
<p class="BodyContinued">The distance between the beginnings of the first and the second appearance of the pattern is 192 letters.</p>
<p>In lines 28 and 33, we find another repeating pattern, <code>DTWEMY</code>:</p>
<figure class="graphic">
<img alt="" class="" height="200" src="image_fi/502727c08/g08003.png" width="694"/></figure>
<p class="BodyContinued">This time, the number of letters before the repetition begins is 248.</p>
<p>In line 28, a third repetition can be found, <code>DTWEM</code>:</p>
<figure class="graphic">
<img alt="" class="" height="52" src="image_fi/502727c08/g08004.png" width="694"/></figure>
<p class="BodyContinued">Here, the distance is 8.</p>
<p>The distances we have found are 192, 248, and 8. The greatest common divisor of these three numbers is 8. This means that the key length is probably 8 or a divisor of 8. A keyword length of 8 means that we are dealing with eight Caesar ciphers. In the next step, we therefore perform eight frequency counts. We start by counting the letters at positions 1, 9, 17, 25, 33, 41, and so on. Here is what we get:</p>
<figure class="graphic">
<img alt="" class="" height="177" src="image_fi/502727c08/g08005.png" width="694"/></figure>
<p class="BodyContinued"><span epub:type="pagebreak" id="Page_157" title="157"/>If we compare this with the frequencies of an ordinary English text (see <span class="xref" itemid="xref_target_Appendix B">Appendix B</span>), we see that the Caesar cipher used here is a direct one-to-one correlation, with <code class="bold">A</code> = <code>F</code>, <code class="bold">B</code> = <code>G</code>, <code class="bold">C</code> = <code>H</code> . . . This means that the first letter of the keyword is probably <code>F</code>.</p>
<p>Now let’s count the letters at positions 2, 10, 18, and so on:</p>
<figure class="graphic">
<img alt="" class="" height="172" src="image_fi/502727c08/g08006.png" width="694"/></figure>
<p class="BodyContinued">This time, we get <code class="bold">A</code> = <code>O</code>, <code class="bold">B</code> = <code>P</code>, <code class="bold">C</code> = <code>Q</code> . . . The second keyword letter therefore is very likely to be <code>O</code>.</p>
<p>If we repeat this procedure six more times, we get the letters <code>F</code>, <code>O</code>, <code>R</code>, <code>T</code>, <code>Y</code>, <code>T</code>, <code>W</code>, and <code>O</code>. This suggests that the keyword length really is eight. If we had received a keyword like <code>FORTFORT</code>, we would know that the four-letter <code>FORT</code> was the actual keyword. Using the keyword <code>FORTYTWO</code>, we can easily decrypt the ciphertext and retrieve the <em>Hitchhiker’s Guide to the Galaxy</em> excerpt.</p>
<h3 id="h2-502727c08-0006"><a class="XrefDestination" id="Usingtheindexofcoincidence"/><span class="XrefDestination" id="xref-502727c08-011"/>Using the index of coincidence</h3>
<p class="BodyFirst">Kasiski’s method is usually the best way to determine the Vigenère keyword length by hand. If a computer is available, there are better methods. Quite often, the index of coincidence can help us determine the number of letters in the keyword. A good way to use this value is to assume different keyword lengths (for instance, lengths between three and twenty-five) and compute the index of coincidence for each case. Assuming an English plaintext, the index of coincidence that is the closest to a normal English value of 6.7% is probably correct.</p>
<p>The dCode website (<a class="LinkURL" href="https://dcode.fr/en">https://dcode.fr/en</a>) provides us with a tool that performs such a test. Here are the results we get for <em>The Hitchhiker’s Guide to the Galaxy</em> excerpt:</p>
<ol class="none">
<li>Length = 24: index of coincidence = 6.4%</li>
<li>Length = 8: index of coincidence = 6.3%</li>
<li>Length = 16: index of coincidence = 6.2%</li>
<li>Length = 4: index of coincidence = 4.9%</li>
<li>Length = 12: index of coincidence = 4.9%</li>
<li>Length = 20: index of coincidence = 4.8%</li>
<li>Length = 26: index of coincidence = 4.6%</li>
<li>Length = 14: index of coincidence = 4.6%</li>
</ol>
<p>The keyword length of twenty-four renders the highest index of coincidence, which is closest to the English 6.7%. Twenty-four is wrong, but we can live with this, because it is a multiple of 8. When we solve twenty-four Caesar <span epub:type="pagebreak" id="Page_158" title="158"/>ciphers in the next step, we will get <code>FORTYTWOFORTYTWOFORTYTWO</code> as the keyword. The second guess (a keyword length of 8 letters) is the correct one.</p>
<p>Now that we know the keyword length, we can tell the dCode utility to solve the cryptogram. By solving a Caesar cipher for each letter of the keyword, dCode renders the correct solution. This is shown in <a href="#figure8-5" id="figureanchor8-5">Figure 8-5</a>.</p>
<figure>
<img alt="" class="keyline" height="483" src="image_fi/502727c08/f08005.png" width="555"/>
<figcaption><p><a id="figure8-5">Figure 8-5</a>: The website dCode (<a class="LinkURL" href="https://dcode.fr/en">https://dcode.fr/en</a>) provides tools to solve a Vigenère cipher step-by-step.</p></figcaption>
</figure>
<p>Let’s now try the same with the text on the <em>Kryptos</em> maquette. Here is what dCode delivers us:</p>
<ol class="none">
<li>Length = 3: index of coincidence = 6.3%</li>
<li>Length = 6: index of coincidence = 6.2%</li>
<li>Length = 9: index of coincidence = 5.9%</li>
<li>Length = 13: index of coincidence = 5.2%</li>
<li>Length = 11: index of coincidence = 4.9%</li>
<li>Length = 12: index of coincidence = 5.5%</li>
<li>Length = 15: index of coincidence = 5.8%</li>
<li>Length = 18: index of coincidence = 5.9%</li>
<li>Length = 8: index of coincidence = 4.3%</li>
<li>Length = 1: index of coincidence = 4.3%</li>
</ol>
<p>As can be seen, the keyword length of three provides the best result. This is correct, as the keyword is <code>RUG</code>.</p>
<p>William Friedman, who introduced the index of coincidence to codebreaking, developed a formula that uses it to compute an estimated <span epub:type="pagebreak" id="Page_159" title="159"/>keyword length from the ciphertext. This formula is known as the <em>Friedman test</em>. It requires fewer calculations than performing the index-of-coincidence comparisons we just walked through, but it is also less accurate, especially if the plaintext language is not known. For a detailed treatise on the index-of-coincidence method and the Friedman test, we recommend Craig Bauer’s book <em>Secret History</em>.<sup class="endnote"><a href="b06.xhtml#c08-endnote-5" id="c08-noteref-5">5</a></sup></p>
<h3 id="h2-502727c08-0007"><a class="XrefDestination" id="Dictionaryattacks"/><span class="XrefDestination" id="xref-502727c08-012"/>Dictionary attacks</h3>
<p class="BodyFirst">Another way to break a Vigenère cipher is the so-called dictionary attack, which requires the use of a computer program. A dictionary attack requires a long list of words, called a <em>dictionary</em>, which is stored in a file. Dictionary files of all kinds are available on the internet in great numbers. For example, there are files containing the 20,000 most popular words of the English language. Similar collections have been created for many other languages, geographical expressions, names, abbreviations, and more. In addition, there are programs that create dozens of different versions of a given word (for instance, <em>CALIFORNIA</em>, <em>CALIFORNYA</em>, <em>CALIF</em>, <em>CA</em>, <em>AINROFILAC</em> . . .).</p>
<p>A program executing a dictionary attack on the Vigenère cipher takes one word after another from such a source, derives different versions of it, and uses each one as a possible key to decrypt the ciphertext. Then it checks whether the result looks like plain English (or whatever language is used). Methods to distinguish meaningful text from gibberish will be introduced in <span class="xref" itemid="xref_target_Chapter 16"><a href="c16.xhtml">Chapter 16</a></span>. When the test for meaningful language is positive, the deciphering has succeeded; otherwise, the next keyword candidate is tested.</p>
<p>While trying to break a Vigenère cipher with a dictionary attack is feasible,<sup class="endnote"><a href="b06.xhtml#c08-endnote-6" id="c08-noteref-6">6</a></sup> it is not very common. This is probably because more powerful computer-based attacks on the Vigenère cipher are available, such as hill climbing, which is discussed in <span class="xref" itemid="xref_target_Chapter 16"><a href="c16.xhtml">Chapter 16</a></span>.</p>
<h3 id="h2-502727c08-0008"><a class="XrefDestination" id="TobiasSchrödel’smethod"/><span class="XrefDestination" id="xref-502727c08-013"/>Tobias Schrödel’s method</h3>
<p class="BodyFirst">In 2008, our colleague, the German crypto expert Tobias Schrödel, published a hitherto unknown Vigenère cipher-breaking method in <em>Cryptologia</em>.<sup class="endnote"><a href="b06.xhtml#c08-endnote-7" id="c08-noteref-7">7</a></sup> This attack is based on the elimination of rare letter combinations in both the plaintext and the keyword. It requires a computer program (and, in fact, is part of CrypTool 1, the forerunner of CrypTool 2). Tobias’s method is particularly helpful in cases when the message is not much longer than the keyword (e.g., a fifteen-letter plaintext encrypted with a seven-letter keyword). However, the keyword must be a real word and not a random-letter sequence—otherwise, eliminating rare letter combinations is useless.</p>
<p>In his article, Tobias introduces the ciphertext <code>IZRUOJVREFLFZKSWSE</code>, which was encrypted with a Vigenère cipher. The traditional methods used to attack a Vigenère cipher don’t work here. For instance, no words can be guessed, because the text contains no spaces. In addition, the cryptogram is short, and there are no repetitions that might reveal the keyword length. Even if we know or guess the length of the keyword, performing, say, six frequency analyses won’t help, because there are too few letters.</p>
<p><span epub:type="pagebreak" id="Page_160" title="160"/>However, Tobias’s method can break this cryptogram. By eliminating rare letter combinations, it finds that the common trigraphs <em>BLA</em> and <em>HOR</em> generate <code>IZR</code> (the first three letters of the ciphertext) when one is encrypted with the other. Based on frequency considerations, the method next suggests <em>BLACK</em> and <em>HORSE</em> as extensions of the two trigraphs. It is not clear which word is the keyword and which is the plaintext, but further tests reveal that the keyword <code>HORSE</code> makes sense. When it is used to decrypt the cryptogram, the resulting plaintext is <code class="bold">BLACK CHAMBER IS OPEN</code>.</p>
<h3 id="h2-502727c08-0009"><a class="XrefDestination" id="OtherVigenèrebreakingmethods"/><span class="XrefDestination" id="xref-502727c08-014"/>Other Vigenère breaking methods</h3>
<p class="BodyFirst">In her 1939 book <em>Cryptanalysis</em>, Helen Fouché Gaines described a linguistic approach to solving a Vigenère cipher.<sup class="endnote"><a href="b06.xhtml#c08-endnote-8" id="c08-noteref-8">8</a></sup> It requires luck and a lot of trial and error. Richard Hayes described a similar but more advanced technique, based on common trigraphs, in 1943.<sup class="endnote"><a href="b06.xhtml#c08-endnote-9" id="c08-noteref-9">9</a></sup> Both methods are rarely used today, as more powerful alternatives have emerged since the advent of computer technology.</p>
<p>Another method we won’t discuss in this book is Viterbi analysis, which is based on hidden Markov models. Interesting articles about this approach have been published in the scientific journal <em>Cryptologia</em>.<sup class="endnote"><a href="b06.xhtml#c08-endnote-10" id="c08-noteref-10">10</a></sup><sup>, </sup><sup class="endnote"><a href="b06.xhtml#c08-endnote-11" id="c08-noteref-11">11</a></sup></p>
<h3 id="h2-502727c08-0010"><a class="XrefDestination" id="Howtobreakaone-timepad"/><span class="XrefDestination" id="xref-502727c08-015"/>How to break a one-time pad</h3>
<p class="BodyFirst">As we mentioned, it is impossible to break a one-time pad if the key is a random sequence without any regularities and is only used once. However, more often than not over the course of history, these requirements have been breached. One of the most common mistakes occurred when the same key was used several times.</p>
<p>In the following, we explain how a one-time pad can be broken if the same key is employed for two messages. To demonstrate this, let’s first encrypt the plaintext <code class="bold">WASHINGTON</code> with the (random) key <code>KDFYDVKHAP</code>:</p>
<p class="BodyCustom"><code>WASHINGTON</code></p>
<p class="BodyCustom"><code>KDFYDVKHAP</code></p>
<p class="BodyCustom"><code>----------</code></p>
<p class="BodyCustom"><code>GDXFLIQAOC</code></p>
<p class="BodyContinued">Next, we encrypt the plaintext <code class="bold">CALIFORNIA</code> with the same key:</p>
<p class="BodyCustom"><code>CALIFORNIA</code></p>
<p class="BodyCustom"><code>KDFYDVKHAP</code></p>
<p class="BodyCustom"><code>----------</code></p>
<p class="BodyCustom"><code>MDQGIJBUIP</code></p>
<p class="BodyContinued">Now, we decrypt the first plaintext with the second one:</p>
<p class="BodyCustom"><code>WASHINGTON</code></p>
<p class="BodyCustom"><code>CALIFORNIA</code></p>
<p class="BodyCustom"><code>----------</code></p>
<p class="BodyCustom"><code>UAHZDZPGGN</code></p>
<p class="BodyContinued"><span epub:type="pagebreak" id="Page_161" title="161"/>If we decrypt the first ciphertext with the second one, we receive the same result:</p>
<p class="BodyCustom"><code>GDXFLIQAOC</code></p>
<p class="BodyCustom"><code>MDQGIJBUIP</code></p>
<p class="BodyCustom"><code>----------</code></p>
<p class="BodyCustom"><code>UAHZDZPGGN</code></p>
<p class="BodyContinued">This means that if a codebreaker knows both ciphertexts (<code>GDXFLIQAOC</code> and <code>MDQGIJBUIP</code>) and that one of the plaintexts is <code class="bold">WASHINGTON</code>, they can easily derive the second plaintext, <code class="bold">CALIFORNIA</code>. This also works the other way around: if <code class="bold">CALIFORNIA</code> is known, <code class="bold">WASHINGTON</code> can be derived.</p>
<p>We can easily generalize this approach to longer messages. If a cryptanalyst knows two one-time pad ciphertexts encrypted with the same key and has a crib in one of the two cryptograms, they can easily derive a part of the other plaintext. If the latter part is, say, <code class="bold">E UNITED S</code>, this can be extended to <code class="bold">THE UNITED STATES</code>, which means that <code class="bold">TH</code> and <code class="bold">TATES</code> become new cribs. With this method, it may be possible to completely derive both plaintexts.</p>
<h2 id="h1-502727c08-0004"><a class="XrefDestination" id="Successstories"/><span class="XrefDestination" id="xref-502727c08-016"/>Success stories</h2>
<h3 id="h2-502727c08-0011"><a class="XrefDestination" id="TheDianaDorsmessage"/><span class="XrefDestination" id="xref-502727c08-017"/>The Diana Dors message</h3>
<p class="BodyFirst">English actress Diana Dors (1931–1984) was once considered the British counterpart to Marilyn Monroe. In dozens of films, she played a seductive blonde and lived a private life worthy of a film diva. Before dying of cancer at age fifty-two, she gave her son Mark Dawson an encrypted message, telling him that it described the whereabouts of a substantial sum that she had hidden away: £2 million.</p>
<p>The headline of the text was encrypted using a pigpen cipher:</p>
<figure class="graphic">
<img alt="" class="" height="43" src="image_fi/502727c08/g08007.png" width="694"/></figure>
<p class="BodyContinued">After some research, Dawson deciphered this to <code class="bold">LOCATIONS AND NAMES</code>. It turned out that his mother had used the following substitution table:</p>
<figure class="graphic">
<img alt="" class="" height="114" src="image_fi/502727c08/g08008.png" width="347"/></figure>
<p><span epub:type="pagebreak" id="Page_162" title="162"/>The main part of the cryptogram was written in ordinary letters:</p>
<p class="BodyCustom"><code>EAWVL XEIMO RZTIC SELKM KMRUQ</code></p>
<p class="BodyCustom"><code>QPYFC ZAOUA TNEYS QOHVQ YPLYS</code></p>
<p class="BodyCustom"><code>OEOEW TCEFY ZZEPI NYAUD RZUGM</code></p>
<p class="BodyCustom"><code>SSONV JDAER SZNVS QSHRK XPVCC</code></p>
<p class="BodyCustom"><code>WUAEJ JTWGC WQRCC NRBKZ VIITF</code></p>
<p class="BodyCustom"><code>RZLTS VOAIB NQZOK VANJJ TFAJO</code></p>
<p class="BodyCustom"><code>GYUEB XZHRY UFSDM ZEBRK GIECJ</code></p>
<p class="BodyCustom"><code>QZHFY QBYVU FNEGD EDIXF YZHOM</code></p>
<p class="BodyCustom"><code>PMNLQ XFHFO UXAEB HZSNO EAUIL</code></p>
<p class="BodyCustom"><code>JXIWD KTUDN MCCGC EURDG SRBCW</code></p>
<p class="BodyCustom"><code>GMNKC RLHER HETVP GWOGC WANVJ</code></p>
<p class="BodyCustom"><code>NGYTZ RALTM TAYTL UUSKM QIRZH</code></p>
<p class="BodyContinued">As Dawson couldn’t decipher this ciphertext, he consulted a team of British cryptologists, including Andrew Clark, who succeeded in breaking the cryptogram. However, the message’s meaning remained a mystery. A 2004 TV documentary later chronicled the team’s work.<sup class="endnote"><a href="b06.xhtml#c08-endnote-12" id="c08-noteref-12">12</a></sup></p>
<p>To begin with, Clark and his colleagues performed a few statistical analyses of the cryptogram. The results proved consistent with a Vigenère cipher, and they had no trouble breaking it (probably by first determining the keyword length using one of the methods described earlier in this chapter). The keyword turned out to be <code>DMARYFLUCK</code> (likely derived from Dors’s legal name, Diana Mary Fluck).</p>
<p>Here is how the first line is decrypted:</p>
<p class="BodyCustom"><code>Ciphertext:   EAWVL XEIMO RZTIC SELKM KMRUQ . . .</code></p>
<p class="BodyCustom"><code>Key:          DMARY FLUCK DMARY FLUCK DMARY . . .</code></p>
<p class="BodyCustom"><code>Plaintext:    </code><code class="bold">BOWEN STOKE ONTRE NTRIC HARDS . . .</code></p>
<p class="BodyContinued">The text consisted of a list of surnames, each followed by a city in England or Wales:</p>
<ol class="none">
<li><code>Bowen, Stoke-on-Trent</code></li>
<li><code>Richards, Leeds</code></li>
<li><code>Woodcock, Winchester</code></li>
<li><code>Wilson, York</code></li>
<li><code>Downey, Kingston Upon Hull</code></li>
<li><code>Grant, Nottingham</code></li>
<li><code>Sebastian, Leicester</code></li>
<li><code>Leigh, Ipswich</code></li>
<li><code>Morris, Cardiff</code></li>
<li><code>Mason, Slough</code></li>
<li><code>Edmundson, Portsmouth</code></li>
<li><code>Padwell, London</code></li>
<li><code>Pyewacket, Brighton</code></li>
<li><span epub:type="pagebreak" id="Page_163" title="163"/><code>McManus, Sunderland</code></li>
<li><code>Coyle, Bournemouth</code></li>
<li><code>Humphries, Birmingham</code></li>
<li><code>Dante, Manchester</code></li>
<li><code>Bluestone, Liverpool</code></li>
<li><code>Cooper, Bristol</code></li>
</ol>
<p>The meaning of this list is not known, and we have no idea whether these names refer to real people. Diana Dors’s son never found the millions his mother had allegedly left behind, and it is doubtful that this estate really existed. Although Dors had done well during her early career, she declared bankruptcy in 1968 and from then on supported herself with minor engagements.</p>
<h3 id="h2-502727c08-0012"><a class="XrefDestination" id="Kryptos1and2"/><span class="XrefDestination" id="xref-502727c08-018"/>Kryptos 1 and 2</h3>
<p class="BodyFirst">The two panels on the right side of the <em>Kryptos</em> sculpture located at CIA headquarters show a Vigenère-type table with an alphabet written in the following order. The letters of the word <code class="bold">KRYPTOS</code> are shifted to the beginning:</p>
<p class="BodyCustom"><code>KRYPTOSABCDEFGHIJLMNQUVWXZ</code></p>
<p class="BodyContinued">The top-left panel contains the following ciphertext:</p>
<p class="BodyCustom"><code>EMUFPHZLRFAXYUSDJKZLDKRNSHGNFIVJ</code></p>
<p class="BodyCustom"><code>YQTQUXQBQVYUVLLTREVJYQTMKYRDMFD</code></p>
<p class="BodyCustom"><code>VFPJUDEEHZWETZYVGWHKKQETGFQJNCE</code></p>
<p class="BodyCustom"><code>GGWHKK?DQMCPFQZDQMMIAGPFXHQRLG</code></p>
<p class="BodyCustom"><code>TIMVMZJANQLVKQEDAGDVFRPJUNGEUNA</code></p>
<p class="BodyCustom"><code>QZGZLECGYUXUEENJTBJLBQCRTBJDFHRR</code></p>
<p class="BodyCustom"><code>YIZETKZEMVDUFKSJHKFWHKUWQLSZFTI</code></p>
<p class="BodyCustom"><code>HHDDDUVH?DWKBFUFPWNTDFIYCUQZERE</code></p>
<p class="BodyCustom"><code>EVLDKFEZMOQQJLTTUGSYQPFEUNLAVIDX</code></p>
<p class="BodyCustom"><code>FLGGTEZ?FKZBSFDQVGOGIPUFXHHDRKF</code></p>
<p class="BodyCustom"><code>FHQNTGPUAECNUVPDJMQCLQUMUNEDFQ</code></p>
<p class="BodyCustom"><code>ELZZVRRGKFFVOEEXBDMVPNFQXEZLGRE</code></p>
<p class="BodyCustom"><code>DNQFMPNZGLFLPMRJQYALMGNUVPDXVKP</code></p>
<p class="BodyCustom"><code>DQUMEBEDMHDAFMJGZNUPLGEWJLLAETG</code></p>
<p>As you can read about in <span class="xref" itemid="xref_target_Appendix A">Appendix A</span>, this cryptogram was broken independently at least three times by codebreakers who were not aware of each other’s achievements. In this section, we provide the approach used by CIA employee David Stein, who was the second one to solve it. His work is documented in a paper that is available online.<sup class="endnote"><a href="b06.xhtml#c08-endnote-13" id="c08-noteref-13">13</a></sup></p>
<p>Stein started by performing a frequency analysis. He realized that the encrypted message had the appearance of a Vigenère cryptogram. Using Friedman’s method, based on the index of coincidence, Stein found out that the most likely keyword length was eight. This was confirmed by the <span epub:type="pagebreak" id="Page_164" title="164"/>repetition of the trigraph <code>DQM</code> after eight letters in the fourth line (Kasiski’s method):</p>
<p class="BodyCustom"><code class="bold">D Q M</code><code> C P F Q Z </code><code class="bold">D Q M</code></p>
<p class="BodyCustom"><code>1 2 3 4 5 6 7 8</code></p>
<p>Stein’s first guess was that the <code>DQM</code> trigraph stood for the most common trigraph in the English language, <code class="bold">THE</code>. In another attack on the ciphertext, he did an additional frequency analysis. Knowing that a Vigenère cipher with an eight-letter keyword is equivalent to eight Caesar encryptions, Stein counted the frequencies of every eighth letter. However, neither of these approaches led to a solution.</p>
<p>He then guessed that a Vigenère cipher with a permutated alphabet—one starting with <code>KRYPTOS</code>, as on the other side of the sculpture—had been used. Based on this assumption, he tried to solve the eight Caesar ciphers with frequency analysis once again. This time, he was on the right track. The Vigenère keyword he found was <code>ABSCISSA</code>, a word referring to the <em>x</em>-coordinate of a point on a graph. The <code>DQM</code> ciphertext came out to <code class="bold">THE(Y)</code> and <code class="bold">THE</code>.</p>
<p>However, only lines 3 through 13 of the encrypted message produced meaningful plaintext, while the first two decrypted to gibberish. Stein guessed that these two lines were encrypted with the same method but a different keyword. This conjecture proved correct, and Stein determined that the keyword for those lines was <code>PALIMPSEST</code>. (A <em>palimpsest</em> is a manuscript page whose text has been scraped or washed off so that it can be reused for another text, in such a way that bits of the older message can be seen through the new one.) Here’s the Vigenère table used to encrypt lines 1 and 2 (note the keyword <code>PALIMPSEST</code> in the first column):</p>
<p class="BodyCustom"><code>KRYPTOSABCDEFGHIJLMNQUVWXZ</code></p>
<p class="BodyCustom"><code>--------------------------</code></p>
<p class="BodyCustom"><code>PTOSABCDEFGHIJLMNQUVWXZKRY</code></p>
<p class="BodyCustom"><code>ABCDEFGHIJLMNQUVWXZKRYPTOS</code></p>
<p class="BodyCustom"><code>LMNQUVWXZKRYPTOSABCDEFGHIJ</code></p>
<p class="BodyCustom"><code>IJLMNQUVWXZKRYPTOSABCDEFGH</code></p>
<p class="BodyCustom"><code>MNQUVWXZKRYPTOSABCDEFGHIJL</code></p>
<p class="BodyCustom"><code>PTOSABCDEFGHIJLMNQUVWXZKRY</code></p>
<p class="BodyCustom"><code>SABCDEFGHIJLMNQUVWXZKRYPTO</code></p>
<p class="BodyCustom"><code>EFGHIJLMNQUVWXZKRYPTOSABCD</code></p>
<p class="BodyCustom"><code>SABCDEFGHIJLMNQUVWXZKRYPTO</code></p>
<p class="BodyCustom"><code>TOSABCDEFGHIJLMNQUVWXZKRYP</code></p>
<p class="BodyContinued">The plaintext of the first two lines reads as follows. It includes a misspelled word:</p>
<p class="BodyCustom"><code>BETWEEN SUBTLE SHADING AND THE ABSENCE OF LIGHT LIES THE NUANCE OF IQLUSION</code></p>
<p><span epub:type="pagebreak" id="Page_165" title="165"/>For lines 3 through 13, Sanborn used the following Vigenère table based on the keyword <code>ABSCISSA</code>:</p>
<p class="BodyCustom"><code>KRYPTOSABCDEFGHIJLMNQUVWXZ</code></p>
<p class="BodyCustom"><code>--------------------------</code></p>
<p class="BodyCustom"><code>ABCDEFGHIJLMNQUVWXZKRYPTOS</code></p>
<p class="BodyCustom"><code>BCDEFGHIJLMNQUVWXZKRYPTOSA</code></p>
<p class="BodyCustom"><code>SABCDEFGHIJLMNQUVWXZKRYPTO</code></p>
<p class="BodyCustom"><code>CDEFGHIJLMNQUVWXZKRYPTOSAB</code></p>
<p class="BodyCustom"><code>IJLMNQUVWXZKRYPTOSABCDEFGH</code></p>
<p class="BodyCustom"><code>SABCDEFGHIJLMNQUVWXZKRYPTO</code></p>
<p class="BodyCustom"><code>SABCDEFGHIJLMNQUVWXZKRYPTO</code></p>
<p class="BodyCustom"><code>ABCDEFGHIJLMNQUVWXZKRYPTOS</code></p>
<p>Here is the corresponding plaintext result (including another spelling error):</p>
<p class="BodyCustom"><code>IT WAS TOTALLY INVISIBLE HOWS THAT POSSIBLE? THEY USED THE EARTHS MAGNETIC FIELD X THE INFORMATION WAS GATHERED AND TRANSMITTED UNDERGRUUND TO AN UNKNOWN LOCATION X DOES LANGLEY KNOW ABOUT THIS? THEY SHOULD ITS BURIED OUT THERE SOMEWHERE X WHO KNOWS THE EXACT LOCATION? ONLY WW THIS WAS HIS LAST MESSAGE X THIRTY EIGHT DEGREES FIFTY SEVEN MINUTES SIX POINT FIVE SECONDS NORTH SEVENTY SEVEN DEGREES EIGHT MINUTES FORTY FOUR SECONDS WEST ID BY ROWS</code></p>
<p>In 2006, several years after the solution was made publicly available, Sanborn, the creator of <em>Kryptos</em>, indicated that the last three words of the plaintext, <code class="bold">ID BY ROWS</code>, were wrong because of a missing <code>S</code> in the last line of the ciphertext. The intended ending of the plaintext was <code class="bold">X LAYER TWO</code>. None of the previous solvers had noticed this error, as by mere coincidence, the expression <code class="bold">ID BY ROWS</code> seemed to make sense.</p>
<h3 id="h2-502727c08-0013"><a class="XrefDestination" id="TheCyrillicProjector"/><span class="XrefDestination" id="xref-502727c08-019"/>The Cyrillic Projector</h3>
<p class="BodyFirst">Sanborn is the creator not only of <em>Kryptos</em> but also of several other encrypted works. For example, in the 1990s, he created another sculpture bearing an encrypted message: the <em>Cyrillic Projector</em>. It was first displayed in his gallery shows, and then in 1997, it found its way to its current location on the campus of the University of North Carolina at Charlotte. The <em>Cyrillic Projector</em> consists of a large bronze cylinder over two meters high, with hundreds of letters carved into it. A bright light in the center of the sculpture shines through the letters, projecting their images around the courtyard.</p>
<p>Like in <em>Kryptos</em>, the letters on the <em>Cyrillic Projector</em> are carved into four panels that form the cylinder. The two panels located out of sight in <a href="#figure8-6" id="figureanchor8-6">Figure 8-6</a> display a Vigenère-type tableau in the Russian (Cyrillic) alphabet, transposed such that the letters of the word <span class="NSSymbol">ТЕНЬ</span> (Russian for <em>shadow</em>) occur at the beginning. It is important to note that the untransposed order of the letters in the Cyrillic alphabet varies depending on, among other things, the region where it is used. The letter order used for the <em>Cyrillic Projector</em> is not the most common one.</p>
<span epub:type="pagebreak" id="Page_166" title="166"/><figure>
<img alt="" class="" height="464" src="image_fi/502727c08/F08006.png" width="694"/>
<figcaption><p><a href="#figureanchor8-6" id="figure8-6">Figure 8-6</a>: The <em>Cyrillic Projector</em>, located on the campus of the University of North Carolina at Charlotte, is a sculpture bearing an encrypted inscription. The upper-right photograph shows Elonka serving as a screen for the projected word <span class="LiteralInCaption"><code>MEDUSA</code></span> (the only portion not written in Cyrillic letters).</p></figcaption>
</figure>
<p>The text on the two other panels (shown in the picture) is an encrypted message. It is written in Cyrillic script, too, except for the word <code>MEDUSA</code> in the fourteenth line. In Cyrillic, one would expect this to be spelled <code>MEДУЗA</code>; the use of Latin letters instead gives a hint about one of the keys.</p>
<p>The ciphertext on the <em>Cyrillic Projector</em> is reproduced here:</p>
<p class="BodyCustom"><code>ЛTФEЮTФЯЙЯMПXЦФAЧHЩПBБГЖЧCКЬГГЛЗДЭЙП</code></p>
<p class="BodyCustom"><code>ЪКXCЙPЭAФHФПЩBПEЦPДФAЩШTКCXCЧЫУXXEЮ</code></p>
<p class="BodyCustom"><code>КУMЛEЧЛЫTOБHEЯЖЖИЬHЭЗЩЦPЛЫБПHФOИИAБЬ</code></p>
<p class="BodyCustom"><code>ПИКЛEУPЫCMЪШЛЛБXMXЛЖШPAЩPЙЛПEOOЙЙBЦ</code></p>
<p class="BodyCustom"><code>ИЪЛБXЦPЫЧCКAPCPBЯЭФКЮФPЮMOЯЗOЛOДЭШPЗУ</code></p>
<p class="BodyCustom"><code>ДXMAЭXOЙГЙЮФMЩXXCBИИЗXAГЙЯЬПCИБPPШOM</code></p>
<p class="BodyCustom"><code>КTCУЯГXУЬЛEУPЫCMЪШCППЯЯЦШУШAЦЧПИMШH</code></p>
<p class="BodyCustom"><code>PБЧPЯЫMИУPAДФAИЮЙЫЦЯЛOHУФЖOФШXФЖCБ</code></p>
<p class="BodyCustom"><code>BЪЧДЦCФБMДЭШPЗУДXУPБШTOКЩЪMXПOTOXOЩЧ</code></p>
<p class="BodyCustom"><code>ЖAЦДЩPAЮГOЙBPБГЮБЗГEЖPЙЛПEOOЙЙBЦHЗПГФ</code></p>
<p class="BodyCustom"><code>ЦЗAИBЯЮФЛЪЦXCЧЫШЬБEOMЩШЖTЭДЙOTTФXПP</code></p>
<p class="BodyCustom"><code>ПЛOДЭЩPЗУДXКПГФOЦБЩЪMMЭКЧEPЛMКЪЦЦЗЩЛ</code></p>
<p class="BodyCustom"><code>ФЦЧЪЩКBHФAECДПTДФПPЯЙКЮHXBЦБЮEИCЧЯЧЦ</code></p>
<p class="BodyCustom"><code>XMЖЛCПPЧУЛЭШЖЫИИMEDUSAИHXEЗЛЧЗPЗЙКЛ</code></p>
<p class="BodyCustom"><code>ППEBЛЧCXЦЫOЙBPБУДXCBЪГЖЧCКAPCPBЯЭФPЩФ</code></p>
<p class="BodyCustom"><code>ЯЦЩПЪЗЫTФOЙЙУCДTЮTBCБPXCПБЩЛШКУBЙЙГЗ</code></p>
<p class="BodyCustom"><code>ЙAЧЛЬPЙЭMДЧЧPЬCTHКЙEКДOБЖБЛШИЫЙБЙИДPP</code></p>
<p class="BodyCustom"><code>ЦXOЩЖBЪКБЧКЖHФПШЦЗУЙДЯГAЧЙКУЗФEЦИЯИ</code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_167" title="167"/><code>ЙФЭБЛCДTГЗШPЖEДФЩЖЙЯHБOOЬШФПЮКЗЦУДИ</code></p>
<p class="BodyCustom"><code>HXEOXПOЙAXДЭCБЩЙЖЭШBЪOДЩBУCЛMЩГЖШУД</code></p>
<p class="BodyCustom"><code>ИГЛEШКПУУEЧДЛCУЦЮTЮHXЪПБУПPЬГИУCБЙЙПЮ</code></p>
<p class="BodyCustom"><code>ГAФФEШБФБMЙПИMЪЮКЩXXTHФЩШПEЯБЧККЩ</code></p>
<p class="BodyCustom"><code>BЙЩЗЛЮCBЮЙКУКФCЫTЫCBЛCЛЬЗУЦИКЩДPCУPЗ</code></p>
<p class="BodyCustom"><code>XPФЙPЭMPXФЛКФAЙЙКУAЛЩГMЙЖШЪЙЬЩКФHФ</code></p>
<p class="BodyCustom"><code>ИДЙPФГКУКAЯЙOУMATЭTЦКBEЖOЙИДЦДКГЩФEЖ</code></p>
<p class="BodyCustom"><code>БЮXЛECCЭCHЩЩXПOЬДЖЙЙЗГEИTЙMAШЙЙУMФC</code></p>
<p class="BodyCustom"><code>ЫTЫCBCИДCДPБФHУOPУШTБЗПЪДЗЯЫAAЧКУMAЯX</code></p>
<p class="BodyCustom"><code>TMЦPИЦЗЩЛЛEУУПФЖTЭДУXPШЙOPБЭЦЙOПЙЛЪЙ</code></p>
<p class="BodyCustom"><code>TЧШЙAФHПШФЭMБЩЪЖTПДЛPШБШБЧPЖЫMHЧЗЫ</code></p>
<p class="BodyCustom"><code>TЙЖЪCMЪЧДXКЛHЦПЗXPФЙPЭMPXФMЫБBЪЧБШEФ</code></p>
<p class="BodyCustom"><code>БЖTЩBBЪУБЧКЖAЦПЫГШAMИПPЙЪГOЦКЙГPЛЮБУ</code></p>
<p class="BodyCustom"><code>CПБЮPPXФTЫXЖTГИЙКAФMTHКЙФФHЦЙЫCЧБШE</code></p>
<p class="BodyContinued">After Sanborn made the sculpture accessible to the public, several years passed before anyone seriously tried to break the encryption. In 2003, a group of seventy <em>Kryptos</em> enthusiasts led by Elonka finally took up the cause. Group member Randall Bollig captured multiple photos of the <em>Cyrillic Projector</em>. Through weeks of painstaking work, three other group members, Elonka, Bill Houck, and Brian Hill, each created an independent transcript. They later compared their transcripts to generate a fully accurate one. (Imagine the difficulty of transcribing Cyrillic letters read from backward images of a cylindrical sculpture!) Elonka then published the corrected transcript on her website.<sup class="endnote"><a href="b06.xhtml#c08-endnote-14" id="c08-noteref-14">14</a></sup></p>
<p>Soon after the transcript was published, two hobbyist codebreakers, Frank Corr and Mike Bales, independently broke the encryption. Neither announced a full English solution, as they didn’t speak Russian, the language of the plaintext, and couldn’t translate it. When Elonka learned of their potential success, she located a native speaker, Anatoly Kolker. He was a colleague of Elonka’s father, Stanley Dunin, at the World Bank. Anatoly confirmed that the solution was written in Russian and provided the final English translation. The plaintext proved to be composed of two texts from the Cold War. It starts as follows:</p>
<p class="BodyCustom"><code>B Ы C O Ч A Й Ъ И M И C К У C C T B O M B T A Й H O Й P A З B E Д К E C П И T A E . . .</code></p>
<p>The cipher used turned out to be a Vigenère variant with the keyword <code>MEДУЗA</code> (<code>MEDUSA</code>) and the alphabet reordered in the same way as on the tableau, with the letters <code>T</code>, <code>E</code><code class="bold"/>,<code>H</code>, and <code>Ь</code> transposed to the beginning.<sup class="endnote"><a href="b06.xhtml#c08-endnote-15" id="c08-noteref-15">15</a></sup> To create the Vigenère tableau necessary for encrypting the plaintext, we first need the following table:</p>
<p class="BodyCustom"><code>  АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ</code></p>
<p class="BodyCustom"><code>----------------------------------</code></p>
<p class="BodyCustom"><code>А ТЕНЬАБВГДЖЗИЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯ</code></p>
<p class="BodyCustom"><code>Б ЕНЬАБВГДЖЗИЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯТ</code></p>
<p class="BodyCustom"><code>В НЬАБВГДЖЗИЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕ</code></p>
<p class="BodyCustom"><code>Г ЬАБВГДЖЗИЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕН</code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_168" title="168"/><code>Д АБВГДЖЗИЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬ</code></p>
<p class="BodyCustom"><code>Е БВГДЖЗИЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬА</code></p>
<p class="BodyCustom"><code>Ж ВГДЖЗИЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬАБ</code></p>
<p class="BodyCustom"><code>З ГДЖЗИЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬАБВ</code></p>
<p class="BodyCustom"><code>И ДЖЗИЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬАБВГ</code></p>
<p class="BodyCustom"><code>Й ЖЗИЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬАБВГД</code></p>
<p class="BodyCustom"><code>К ЗИЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬАБВГДЖ</code></p>
<p class="BodyCustom"><code>Л ИЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬАБВГДЖЗ</code></p>
<p class="BodyCustom"><code>М ЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬАБВГДЖЗИ</code></p>
<p class="BodyCustom"><code>Н КЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬАБВГДЖЗИЙ</code></p>
<p class="BodyCustom"><code>О ЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬАБВГДЖЗИЙК</code></p>
<p class="BodyCustom"><code>П МОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬАБВГДЖЗИЙКЛ</code></p>
<p class="BodyCustom"><code>Р ОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬАБВГДЖЗИЙКЛМ</code></p>
<p class="BodyCustom"><code>С ПРСУФХШЦЧЩЪЫЭЮЯТЕНЬАБВГДЖЗИЙКЛМО</code></p>
<p class="BodyCustom"><code>Т РСУФХШЦЧЩЪЫЭЮЯТЕНЬАБВГДЖЗИЙКЛМОП</code></p>
<p class="BodyCustom"><code>У СУФХШЦЧЩЪЫЭЮЯТЕНЬАБВГДЖЗИЙКЛМОПР</code></p>
<p class="BodyCustom"><code>Ф УФХШЦЧЩЪЫЭЮЯТЕНЬАБВГДЖЗИЙКЛМОПРС</code></p>
<p class="BodyCustom"><code>Х ФХШЦЧЩЪЫЭЮЯТЕНЬАБВГДЖЗИЙКЛМОПРСУ</code></p>
<p class="BodyCustom"><code>Ц ХШЦЧЩЪЫЭЮЯТЕНЬАБВГДЖЗИЙКЛМОПРСУФ</code></p>
<p class="BodyCustom"><code>Ч ШЦЧЩЪЫЭЮЯТЕНЬАБВГДЖЗИЙКЛМОПРСУФХ</code></p>
<p class="BodyCustom"><code>Ш ЦЧЩЪЫЭЮЯТЕНЬАБВГДЖЗИЙКЛМОПРСУФХШ</code></p>
<p class="BodyCustom"><code>Щ ЧЩЪЫЭЮЯТЕНЬАБВГДЖЗИЙКЛМОПРСУФХШЦ</code></p>
<p class="BodyCustom"><code>Ъ ЩЪЫЭЮЯТЕНЬАБВГДЖЗИЙКЛМОПРСУФХШЦЧ</code></p>
<p class="BodyCustom"><code>Ы ЪЫЭЮЯТЕНЬАБВГДЖЗИЙКЛМОПРСУФХШЦЧЩ</code></p>
<p class="BodyCustom"><code>Ь ЫЭЮЯТЕНЬАБВГДЖЗИЙКЛМОПРСУФХШЦЧЩЪ</code></p>
<p class="BodyCustom"><code>Э ЭЮЯТЕНЬАБВГДЖЗИЙКЛМОПРСУФХШЦЧЩЪЫ</code></p>
<p class="BodyCustom"><code>Ю ЮЯТЕНЬАБВГДЖЗИЙКЛМОПРСУФХШЦЧЩЪЫЭ</code></p>
<p class="BodyCustom"><code>Я ЯТЕНЬАБВГДЖЗИЙКЛМОПРСУФХШЦЧЩЪЫЭЮ</code></p>
<p class="BodyContinued">As can be seen, the Cyrillic alphabet (<code>А</code>,<code>Б</code>,<code>В</code>,<code>Г</code> . . .) is used to index the rows of the table. To encrypt this message, only the rows <code>M</code>,<code>E</code>,<code>Д</code>,<code>У</code>,<code>З</code>, and <code>A</code> are relevant. We arrange them such that they form the word <code>MEДУЗA</code>:</p>
<p class="BodyCustom"><code>  АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ</code></p>
<p class="BodyCustom"><code>----------------------------------</code></p>
<p class="BodyCustom"><code>М ЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬАБВГДЖЗИ</code></p>
<p class="BodyCustom"><code>Е БВГДЖЗИЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬА</code></p>
<p class="BodyCustom"><code>Д АБВГДЖЗИЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬ</code></p>
<p class="BodyCustom"><code>У СУФХШЦЧЩЪЫЭЮЯТЕНЬАБВГДЖЗИЙКЛМОПР</code></p>
<p class="BodyCustom"><code>З ГДЖЗИЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯТЕНЬАБВ</code></p>
<p class="BodyCustom"><code>А ТЕНЬАБВГДЖЗИЙКЛМОПРСУФХШЦЧЩЪЫЭЮЯ</code></p>
<p class="BodyContinued">The following lines show how the plaintext is mapped to the ciphertext using the reduced table:</p>
<p class="BodyCustom"><code>Plaintext:    </code><code class="bold">BЫCOЧAЙЪИMИ . . .</code></p>
<p class="BodyCustom"><code>Ciphertext:   ЛTФEЮTФЯЙЯM . . .</code></p>
<p class="BodyContinued">We will leave the full solution as an exercise for those readers who wish to try, Cold War–style, to decipher a message in the Cyrillic alphabet!</p>
<h3 id="h2-502727c08-0014"><span epub:type="pagebreak" id="Page_169" title="169"/><a class="XrefDestination" id="Thouless’ssecondcryptogramfromthecrypt"/><span class="XrefDestination" id="xref-502727c08-020"/>Thouless’s second cryptogram from the crypt</h3>
<p class="BodyFirst">In 1948, British psychologist and parapsychologist Robert Thouless (1894–1984) started an unusual experiment.<sup class="endnote"><a href="b06.xhtml#c08-endnote-16" id="c08-noteref-16">16</a></sup> He took a short text, encrypted it, and published the ciphertext, keeping the plaintext and key secret. His plan was to channel the key from the beyond after his death. If somebody received the correct key via this paranormal method, they would be able to decipher the cryptogram. This experiment, if successful, would prove that there is life after death and that the dead can communicate with the living—which would certainly be one of the greatest discoveries in the history of science.</p>
<p>As far as we know, Thouless’s experiment did not prove successful—nobody ever came up with a correct solution received from the beyond. This is also true for a similar message created by Thouless’s fellow parapsychologist T.E. Wood, whose cryptogram is covered later in this chapter.</p>
<p>To be on the safe side, Thouless even published a second ciphertext in 1948, encrypted in a different way. However, his plan was foiled, as just a few weeks later, an unknown codebreaker solved his first ciphertext. In response, Thouless created a third cryptogram. This means that altogether, he left behind three messages in 1948. The first and third are encrypted with variations of a Playfair cipher and are covered in <span class="xref" itemid="xref_target_Chapter 12"><a href="c12.xhtml">Chapter 12</a></span>.</p>
<p>The encryption method Thouless used for the second message is complicated but has some elements that are similar to the Vigenère cipher. It used a phrase or text passage as a key. Here’s an example:</p>
<p class="BodyCustom"><code>TO BE OR NOT TO BE THAT IS THE QUESTION</code></p>
<p class="BodyContinued">From this phrase, he eliminated words that had already appeared in the sequence (in this case, <code class="bold">TO</code> and <code class="bold">BE</code>), thus shortening the text:</p>
<p class="BodyCustom"><code>TO BE OR NOT THAT IS THE QUESTION</code></p>
<p class="BodyContinued">Next, he converted each letter to a number (such that <code class="bold">A </code>= <code>1</code>, <code class="bold">B </code>= <code>2</code>, <code class="bold">C </code>= <code>3</code> . . .):</p>
<p class="BodyCustom"><code>20.15 2.5 15.18 14.15.20 20.8.1.20 9.19 20.8.5 17.21.5.19.20.9.15.14</code></p>
<p class="BodyContinued">Lastly, he added the numbers in each word. For example, the word <code>NOT</code> yielded 14 + 15 + 20 = 49. If the result was larger than 26, he repeatedly subtracted 26 until he could derive a value between 1 and 26. In our example, we thus get the following number sequence to be used as the key:</p>
<p class="BodyCustom"><code>9 7 7 23 23 2 7 16</code></p>
<p class="BodyContinued">To encrypt a message, he added each number to the respective letter of the plaintext. If the result was larger than 26, he reduced it by 26 once again. For the plaintext <code class="bold">NEBRASKA</code>, we get the ciphertext <code>WLIOXURQ</code>:</p>
<p class="BodyCustom"><code>Plaintext:    </code><code class="bold">N  E  B  R   A  S  K  A</code></p>
<p class="BodyCustom"><code>Key:          9  7  7  23 23 2  7 16</code></p>
<p class="BodyCustom"><code>Ciphertext:   W  L  I  O   X  U  R  Q</code></p>
<p><span epub:type="pagebreak" id="Page_170" title="170"/>Using this method, Thouless produced the following ciphertext for his second message:</p>
<p class="BodyCustom"><code>INXPH CJKGM JIRPR FBCVY WYWES NOECN SCVHE GYRJQ</code></p>
<p class="BodyCustom"><code>TEBJM TGXAT TWPNH CNYBC FNXPF LFXRV QWQL</code></p>
<p class="BodyContinued">Thouless described the sentence he had used for the key as an “identifiable passage in a printed work.” Because the cryptogram consists of seventy-four letters, this passage had at least seventy-four words (though it could have had more, as Thouless had removed any duplicate words).</p>
<p>Thouless died in 1984, leaving his second and third cryptograms still unsolved. The third was broken (through non-psychic means) a decade later (see <span class="xref" itemid="xref_target_Chapter 12"><a href="c12.xhtml">Chapter 12</a></span>), while his second cryptogram remained unsolved for decades. Then, in August 2019, Klaus received a notice from Richard Bean, a computer expert and codebreaker from Brisbane, Australia,<sup class="endnote"><a href="b06.xhtml#c08-endnote-17" id="c08-noteref-17">17</a></sup> who claimed to have broken this challenge. Klaus and his readers checked Richard’s solution, and it proved correct.</p>
<p>Richard believed that the only way to solve the second Thouless challenge was to find the text that had been used as the key. Hoping that Thouless had taken this text from a publicly available book, Richard decided to start a search at Project Gutenberg, which is the largest digital book collection available on the internet. Just about every book Thouless might have known about in 1948 is available today in the Gutenberg collection.</p>
<p>Richard downloaded 37,000 (!) books from Project Gutenberg. Then, using a computer program, he extracted all possible phrases consisting of seventy-four words, not counting repetitions, which resulted in a collection of hundreds of millions of key candidates. Next, he let his program decrypt Thouless’s ciphertext with every one of the candidate phrases and had it check whether the result looked like English. For this test, he used hexagraph frequencies (see <span class="xref" itemid="xref_target_Chapter 16"><a href="c16.xhtml">Chapter 16</a></span>).</p>
<p>After several days of computation time, Richard’s computer program deemed that the following plaintext had the closest resemblance to English text:</p>
<p class="BodyCustom"><code>CEVHHZGMKLUCCESSFULEXPERIMENTSOFTNEKKIWTDXDAU</code></p>
<p class="BodyCustom"><code>GIVESTRVMGEVIDENCEFOROXRVIVAL</code></p>
<p>This letter sequence didn’t look completely correct, but it was clear that there were fragments of recognizable English text within it. When Richard spotted the fragments <code class="bold">UCCESSFULEXPERIMENTSOF</code> and <code class="bold">EVIDENCEFOR</code>, he realized that he was close to the solution. After a few adjustments, the following plaintext appeared:</p>
<p class="BodyCustom"><code>A NUMBER OF SUCCESSFUL EXPERIMENTS OF THIS KIND WOULD GIVE STRONG EVIDENCE FOR SURVIVAL</code></p>
<p class="BodyContinued">After seventy-one years, Thouless’s second challenge was broken! Though, of course, not in the way he had intended.</p>
<p>As it turned out, the passage Thouless had used as his key came from Project Gutenberg book 41215, <em>Selected Poems of Francis Thompson</em> (1908). <span epub:type="pagebreak" id="Page_171" title="171"/>The passage in question consisted of the first seventy-four words (not counting doubles) of a poem titled “The Hound of Heaven.” This excerpt from the poem is reproduced here, with duplicates crossed out:</p>
<p class="BodyCustom">I FLED HIM, DOWN THE NIGHTS AND <span class="Strikethrough">DOWN THE</span> DAYS;</p>
<p class="BodyCustom"><span class="Strikethrough">I FLED HIM, DOWN THE</span> ARCHES OF <span class="Strikethrough">THE</span> YEARS;</p>
<p class="BodyCustom"><span class="Strikethrough">I FLED HIM, DOWN THE</span> LABYRINTHINE WAYS</p>
<p class="BodyCustom"><span class="Strikethrough">OF</span> MY OWN MIND; <span class="Strikethrough">AND</span> IN <span class="Strikethrough">THE</span> MIST <span class="Strikethrough">OF</span> TEARS</p>
<p class="BodyCustom"><span class="Strikethrough">I</span> HID FROM <span class="Strikethrough">HIM, AND</span> UNDER RUNNING LAUGHTER</p>
<p class="BodyCustom">UP VISTAED HOPES <span class="Strikethrough">I</span> SPED;</p>
<p class="BodyCustom"><span class="Strikethrough">AND</span> SHOT, PRECIPITATED,</p>
<p class="BodyCustom">ADOWN TITANIC GLOOMS <span class="Strikethrough">OF</span> CHASMÈD FEARS,</p>
<p class="BodyCustom"><span class="Strikethrough">FROM</span> THOSE STRONG FEET THAT FOLLOWED, <span class="Strikethrough">FOLLOWED</span> AFTER.</p>
<p class="BodyCustom">BUT WITH UNHURRYING CHASE</p>
<p class="BodyCustom"><span class="Strikethrough">AND</span> UNPERTURBÈD PACE</p>
<p class="BodyCustom">DELIBERATE SPEED, MAJESTIC INSTANCY,</p>
<p class="BodyCustom">THEY BEAT<span class="Strikethrough">—AND A</span> VOICE <span class="Strikethrough">BEAT</span></p>
<p class="BodyCustom">MORE INSTANT THAN <span class="Strikethrough">THE FEET—</span></p>
<p class="BodyCustom">‘ALL THINGS BETRAY THEE, WHO BETRAYEST ME.’</p>
<p class="BodyCustom"><span class="Strikethrough">I</span> PLEADED, OUTLAW-WISE,</p>
<p class="BodyCustom">BY MANY <span class="Strikethrough">A</span> HEARTED CASEMENT, CURTAINED RED,</p>
<p class="BodyCustom">TRELLISED . . .</p>
<p class="BodyContinued">Richard had even known this poem. Its creator, Francis Thompson (1859–1907), was a well-known English poet of the Victorian era. “The Hound of Heaven” was his most famous work.</p>
<p>In 1995, Jim Gillogly and Larry Harnisch, who solved Thouless’s third message (see <span class="xref" itemid="xref_target_Chapter 12"><a href="c12.xhtml">Chapter 12</a></span>), had started a very similar attack on Thouless’s second challenge.<sup class="endnote"><a href="b06.xhtml#c08-endnote-18" id="c08-noteref-18">18</a></sup> They tried several hundred books from Project Gutenberg, to no avail. As it turned out, their attempt on the second message had simply come too early. The book that contained the passage they were looking for, which would have helped them solve the second message, entered the Gutenberg collection just seventeen years later, in 2012.</p>
<h3 id="h2-502727c08-0015"><a class="XrefDestination" id="TheSmithyCode"/><span class="XrefDestination" id="xref-502727c08-021"/>The Smithy Code</h3>
<p class="BodyFirst">In early 2006, authors Michael Baigent and Richard Leigh filed suit against Random House, the publisher of Dan Brown’s bestselling 2003 novel <em>The Da Vinci Code</em>. They alleged that parts of this bestseller were plagiarized from their 1982 nonfiction book <em>Holy Blood, Holy Grail</em>. Judge Peter Smith, who presided over the trial, ruled against Baigent and Leigh, arguing that, as a novelist, Brown was free to use ideas from a nonfictional work in a fictional context.</p>
<p>Incredibly, Smith hid his own code in his written judgment! He italicized forty-one letters throughout the text, producing the following character sequence:</p>
<p class="BodyCustom"><em>smithycodeJaeiextostgpsacgreamqwfkadpmqzv</em></p>
<p class="BodyContinued"><span epub:type="pagebreak" id="Page_172" title="172"/>After “smithy code,” the rest of the characters represent an encrypted message:</p>
<p class="BodyCustom"><var>Jaeiextostgpsacgreamqwfkadpmqzvs</var></p>
<p class="BodyContinued">The assumption that this line is a cryptogram is supported by the following sentence contained in Smith’s text: “The key to solving the conundrum posed by this judgment is in reading HBHG and DVC.” HBHG and DVC are abbreviations of the book titles involved in the trial, namely, <em>Holy Blood, Holy Grail</em> and<em> The Da Vinci Code</em>.</p>
<p>Many codebreakers all over the world tried to decipher the “Smithy Code” message, and Dan Tench, a British lawyer and journalist, was the first one to succeed (after a few hints from the judge).<sup class="endnote"><a href="b06.xhtml#c08-endnote-19" id="c08-noteref-19">19</a></sup> Based on frequency analysis, Tench guessed that he was dealing with a Vigenère cipher or a similar polyalphabetic encryption system. The repetition of the digraph <code>MQ</code> after eight letters suggested that Smith had used an eight-letter keyword. (This reasoning is an application of Kasiski’s method.)</p>
<p>Following Smith’s hint that the solution to the challenge could be found in the two books involved in the lawsuit, Tench tried to use Fibonacci numbers as the key. The Fibonacci sequence is a famous pattern that starts with 1, 1 and continues with numbers that are the sum of the two preceding ones, like this: 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, and so forth. Fibonacci numbers play a role in both <em>Holy Blood, Holy Grail</em> and<em> The Da Vinci Code</em>, so it seemed plausible that Smith had used them as a key of some sort.</p>
<p>Assuming that Smith had applied an eight-character Vigenère keyword, Tench tried the first eight Fibonacci numbers: <code>1</code>, <code>1</code>, <code>2</code>, <code>3</code>, <code>5</code>, <code>8</code>, <code>13</code>, and <code>21</code>. After some trial and error, he saw that this keyword delivered meaningful words when added to the ciphertext (instead of the usual method of being subtracted from it). In addition, each number in the key had to be diminished by one. So, instead of <code>1</code>, <code>1</code>, <code>2</code>, <code>3</code>, <code>5</code>, <code>8</code>, <code>13</code>, <code>21</code>, it started with <code>0</code>, <code>0</code>, <code>1</code>, <code>2</code>, <code>4</code>, <code>7</code>, <code>12</code>, <code>20</code>, and then repeated. There was a further twist: the judge’s key combined the fourth and fifth numbers of the modified Fibonacci sequence, which became <code>0</code>, <code>0</code>, <code>24</code>, <code>2</code>, <code>4</code>, <code>7</code>, <code>12</code>, <code>20</code>. Here’s a description of the decryption process:</p>
<p class="BodyCustom"><code>Ciphertext: J  a  e  i  e  x  t  o  s  t  g  p  s  a  c</code></p>
<p class="BodyCustom"><code>Key:        0  0  24 2  4  7  12 20 0  0  24 2  4  7  12</code></p>
<p class="BodyCustom"><code>Plaintext:  </code><code class="bold">J  A  C  K  I  E  F  I  S  T  E  R  W  H  O</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>Ciphertext: g  r  e  a  m  q  w  f  k  a  d  p  m  q  z  v</code></p>
<p class="BodyCustom"><code>Key:        20 0  0  24 2  4  7  12 20 0  0  24 2  4  7  12</code></p>
<p class="BodyCustom"><code>Plaintext:  </code><code class="bold">A  R  E  Y  O  U  D  R  E  A  D  N  O  U  G  H</code></p>
<p>This produced the following plaintext:</p>
<p class="BodyCustom"><code>JACKIEFISTERWHOAREYOUDREADNOUGH</code></p>
<p class="BodyContinued">The text contains two mistakes: the <code class="bold">T</code> should be an <code class="bold">H</code>, and a <code class="bold">T</code> is missing at the end. Here’s the correct plaintext:</p>
<p class="BodyCustom"><code>JACKIE FISHER WHO ARE YOU DREADNOUGHT</code></p>
<p class="BodyContinued"><span epub:type="pagebreak" id="Page_173" title="173"/>These words refer to Admiral Jackie Fisher (1841–1920), an important figure in British naval history, and the battleship HMS <em>Dreadnought</em>, which Fisher commissioned and planned. Judge Smith was known to be a great admirer of Jackie Fisher, and the launch of the first dreadnought-class battleship, whose design was revolutionary and made all earlier battleships obsolete, had taken place one hundred years before the trial. This cryptogram was his way of commemorating the centennial.</p>
<h2 id="h1-502727c08-0005"><a class="XrefDestination" id="Challenges"/><span class="XrefDestination" id="xref-502727c08-022"/>Challenges</h2>
<h3 id="h2-502727c08-0016"><a class="XrefDestination" id="TheSchoolingchallenge"/><span class="XrefDestination" id="xref-502727c08-023"/>The Schooling challenge</h3>
<p class="BodyFirst">In 1896, British statistician and journalist John Holt Schooling (1859–1927) published a challenge cipher.<sup class="endnote"><a href="b06.xhtml#c08-endnote-20" id="c08-noteref-20">20</a></sup> It consists of a sequence of two-digit numbers. To make things a little easier, we will also reveal that each number represents a letter, as shown in the following table (note that <code class="bold">J</code> is missing):</p>
<p class="BodyCustom"><code>  12345</code></p>
<p class="BodyCustom"><code>  -----</code></p>
<p class="BodyCustom"><code>1|ABCDE</code></p>
<p class="BodyCustom"><code>2|FGHIK</code></p>
<p class="BodyCustom"><code>3|LMNOP</code></p>
<p class="BodyCustom"><code>4|QRSTU</code></p>
<p class="BodyCustom"><code>5|VWXYZ</code></p>
<p class="BodyContinued">The substitution takes place as follows: <code class="bold">A </code>= <code>11</code>, <code class="bold">B </code>= <code>12</code>, <code class="bold">C </code>= <code>13</code> . . . <code class="bold">Y </code>= <code>54</code>, <code class="bold">Z</code> = <code>55</code>. We can then define a Vigenère cipher based on this number system. For instance, if we encrypt the plaintext <code class="bold">CODEBREAKING</code> (<code>13 34 14 15 12 42 15 11 25 24 33 22</code>) with the keyword <code>ABC</code> (<code>11 12 13</code>), we get:</p>
<p class="BodyCustom"><code>13 34 14 15 12 42 15 11 25 24 33 22</code></p>
<p class="BodyCustom"><code>11 12 13 11 12 13 11 12 13 11 12 13</code></p>
<p class="BodyCustom"><code>-----------------------------------</code></p>
<p class="BodyCustom"><code>24 46 27 26 24 55 26 23 38 35 45 35</code></p>
<p>Here’s a ciphertext Schooling created with this method, using the keyword <code>TYRANT</code>:</p>
<p class="BodyCustom"><code>76 69 57 55 65 59 68 87 77 22 75 68 87 88 75 43 67 77 58 65 96</code></p>
<p class="BodyContinued">Can you solve this challenge cipher?</p>
<h3 id="h2-502727c08-0017"><a class="XrefDestination" id="AGermanradiomessagefromtheSecondWorldWar"/><span class="XrefDestination" id="xref-502727c08-024"/>A German radio message from the Second World War</h3>
<p class="BodyFirst">In October 1941, a US Coast Guard unit intercepted the following radio message transmitted from Hamburg, Germany, to a recipient in Rio de Janeiro, Brazil:<sup class="endnote"><a href="b06.xhtml#c08-endnote-21" id="c08-noteref-21">21</a></sup></p>
<p class="BodyCustom"><code>DDLUX CQSFV INNNW FRFZA GQBGI</code></p>
<p class="BodyCustom"><code>WREKU ZPRIY HJXFS JRUJP TYXRH</code></p>
<p class="BodyCustom"><code>SABWC GQFYD MIWYP VHJBE KMEHJ</code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_174" title="174"/><code>WGQAI JYNPV USQLJ DHOIV HQXRN</code></p>
<p class="BodyCustom"><code>HSJRU VJKTY NPPBI SEKKV OIVSC</code></p>
<p class="BodyCustom"><code>GQBTS NUPXS FVHQU WBFFS PTXQT</code></p>
<p class="BodyCustom"><code>FSXJQ FWJSW UWPTC JIWHH PJHQD</code></p>
<p class="BodyCustom"><code>HUVFZ DPJBF XFAVH URBHQ TLDLU</code></p>
<p class="BodyCustom"><code>XCQSD ESQXU</code></p>
<p class="BodyContinued">American codebreakers soon discovered that this message was encrypted with a Vigenère cipher. The plaintext is in German, and the key is not a word but is derived from a mathematical constant. Can you break this cryptogram?</p>
<h2 id="h1-502727c08-0006"><a class="XrefDestination" id="Unsolvedcryptograms"/><span class="XrefDestination" id="xref-502727c08-025"/>Unsolved cryptograms</h2>
<h3 id="h2-502727c08-0018"><a class="XrefDestination" id="Wood’scryptogramfromthecrypt"/><span class="XrefDestination" id="xref-502727c08-026"/>Wood’s cryptogram from the crypt</h3>
<p class="BodyFirst">Robert Thouless, whose unusual life-after-death experiments were discussed in a <span class="xref" itemid="xref_target_previous section of this chapter">previous section of this chapter</span>, encouraged others to perform similar attempts at communicating after their death. The more people who took encryption keys to their grave, he hoped, the higher the probability that somebody would be able to channel this information from the beyond. One person who answered this call to arms was solicitor T.E. Wood (1887–1972) from Bournemouth, United Kingdom. Wood used the same method as Thouless used for his second message for encryption, which means that his key is a passage from a text available to the public (such as a book chapter). However, he added a twist; his plaintext was written in multiple languages, and his key was taken from a non-English work. Wood’s cryptogram is reproduced below.</p>
<p class="BodyCustom"><code>FVAMI NTKFX XWATB OIZVV X</code></p>
<p class="BodyContinued">Wood’s encrypted message is unsolved to date. Apparently, nobody has yet received the key from the beyond!</p>
</section>
</div></body></html>