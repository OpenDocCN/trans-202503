<html><head></head><body>
<div id="sbo-rt-content"><section>
<header>
<h1 class="chapter">
<span class="ChapterNumber"><span epub:type="pagebreak" id="Page_219" title="219"/><a class="XrefDestination" id="11"/><span class="XrefDestination" id="xref-502727c11-001"/>11</span><br/>
<span class="ChapterTitle"><a class="XrefDestination" id="Turninggrilletranspositionciphers"/><span class="XrefDestination" id="xref-502727c11-002"/>Turning grille transposition ciphers</span></h1>
</header>
<figure class="graphic">
<img alt="" class="" height="475" src="image_fi/502727c11/g11001.png" width="844"/></figure>
<p class="BodyFirst"><span epub:type="pagebreak" id="Page_220" title="220"/>It should come as no surprise that there are types of transposition ciphers other than the two systems, complete and incomplete columnar transposition, covered in the previous chapters. Here are a few examples:</p>
<ol class="upper-alpha">
<li value="1"><em>Rubik’s Cube encryption</em>: Douglas W. Mitchell proposed a transposition cipher that uses a Rubik’s Cube.<sup class="endnote"><a href="b06.xhtml#c11-endnote-1" id="c11-noteref-1">1</a></sup> The plaintext is written on the fields of the cube. A sequence of moves forms the key. Subsequently, one reads the ciphertext from the cube. When used properly, this kind of encryption is difficult, yet not impossible, to break.<sup class="endnote"><a href="b06.xhtml#c11-endnote-2" id="c11-noteref-2">2</a></sup></li>
<li value="2"><em>Crossword encryption</em>: In World War II, German spies sometimes used crossword puzzles as keys for transposition ciphers.<sup class="endnote"><a href="b06.xhtml#c11-endnote-3" id="c11-noteref-3">3</a></sup> The sender wrote their message in the empty fields while the black fields remained empty. Afterward, the letters were read out column-wise. The receiver had to follow the same procedure with the same crossword puzzle in reverse order. Though this system is clever, we know today that enemy cryptanalysts of the era broke it.</li>
<li value="3"><em>Rasterschlüssel 44</em>: The German army also used this kind of transposition cipher during World War II. It is based on rectangular forms that look similar to crossword puzzles.<sup class="endnote"><a href="b06.xhtml#c11-endnote-4" id="c11-noteref-4">4</a></sup> This system was mainly applied to less-important messages and as an Enigma substitute. The British could break this kind of encryption, but deciphering it was laborious and often took several days. As the intelligence gained from these decipherments was usually not vital, they finally gave up trying to break Rasterschlüssel 44 messages, deciding it was not worth the effort.</li>
</ol>
<p><a href="#figure11-1" id="figureanchor11-1">Figure 11-1</a> illustrates these three transposition types.</p>
<figure>
<img alt="" class="" height="229" src="image_fi/502727c11/f11001.png" width="694"/>
<figcaption><p><a id="figure11-1">Figure 11-1</a>: Examples of various transposition types: (a) a Rubik’s Cube being used as a cipher device; (b) an encryption method based on a crossword puzzle (used by a secret agent in World War II); and (c) a form used for the German World War II cipher Rasterschlüssel 44</p></figcaption>
</figure>
<p>There are many other types of transposition ciphers commonly mentioned in cryptography books; however, we have not included them here because they tend not to be used in practice, only as puzzle challenges for crypto-enthusiasts. For example, competitions of the American Cryptogram Association routinely include systems such as the rail fence cipher and route transposition.<sup class="endnote"><a href="b06.xhtml#c11-endnote-5" id="c11-noteref-5">5</a></sup></p>
<p><span epub:type="pagebreak" id="Page_221" title="221"/>Apart from these, there is one transposition method encountered so often that it merits its own chapter: the turning grille encryption.</p>
<h2 id="h1-502727c11-0001"><a class="XrefDestination" id="Howturninggrilleencryptionworks"/><span class="XrefDestination" id="xref-502727c11-003"/>How turning grille encryption works</h2>
<p class="BodyFirst">The sample Christmas card in <a href="#figure11-2" id="figureanchor11-2">Figure 11-2</a>, which could have been sent in 2009 from one crypto-enthusiast to another, bears an encrypted inscription consisting of thirty-six letters: <code>TDHOAA PYHPEH UNFYAS MFNROH OLTIII NLMGYT</code>.</p>
<figure>
<img alt="" class="" height="235" src="image_fi/502727c11/f11002.png" width="694"/>
<figcaption><p><a id="figure11-2">Figure 11-2</a>: A Christmas card encrypted with a turning grille</p></figcaption>
</figure>
<p>The plaintext of this inscription is <code class="bold">HAPPY HOLIDAYS FROM THE HUNTINGTON FAMILY</code>. It was encrypted with a so-called turning grille, also known as a Fleissner grille after nineteenth-century crypto book author Edouard Fleissner von Wostrowitz (1825–1888).</p>
<p>A <em>turning grille</em> is usually a square stencil with holes that is used in four steps. In each step, a quarter of the plaintext is written into the holes from left to right and top to bottom. Each step is followed by a ninety-degree clockwise turn of the grille. For example, here are the steps for encrypting the aforementioned <code class="bold">HAPPY HOLIDAYS . . .</code> message with a 6 × 6 grille:</p>
<figure class="graphic">
<img alt="" class="" height="195" src="image_fi/502727c11/g11002.png" width="694"/></figure>
<p>When we remove the stencil after the fourth step, we get the message on the Christmas card:</p>
<p class="BodyCustom"><code>T D H O A A</code></p>
<p class="BodyCustom"><code>P Y H P E H</code></p>
<p class="BodyCustom"><code>U N F Y A S</code></p>
<p class="BodyCustom"><code>M F N R O H</code></p>
<p class="BodyCustom"><code>O L T I I I</code></p>
<p class="BodyCustom"><code>N L M G Y T</code></p>
<p><span epub:type="pagebreak" id="Page_222" title="222"/>The turning grille encryption method is a transposition cipher. The grille can be of any size but must be square. Most turning grilles we have encountered have an even number of rows and columns, because if the stencil uses an odd number of rows, there will be a “center” to the square, which usually remains empty.</p>
<p>The larger a turning grille, the more secure it is.</p>
<p>To construct a turning grille, one can proceed, as shown in <a href="#figure11-3" id="figureanchor11-3">Figure 11-3</a>, by following these steps:</p>
<ol class="decimal">
<li value="1">Begin with a rectangular matrix that is one-quarter the size of the final grille. For example, if your final grille is 6 × 6, meaning that it has four quarters, each of which is 3 × 3, start with one of those 3 × 3 sections. In this smaller section, which has nine possible positions, write the numbers 1 through 4 in random locations, filling in all nine locations. (No matter the size of your grille, you will always use the numbers 1 through 4, as these represent the four directions in which the grille will be turned.)</li>
<li value="2">Place the smaller matrix on top of the larger grille’s top-left corner and copy the 1 sections to the larger grille. Next, move the smaller matrix to the top right of the grille, rotate it ninety degrees clockwise, and then mark the 2s in the larger grille. Move the smaller matrix to the bottom right of the grille, again rotating it ninety degrees clockwise, and then mark the 3s. Finally, move the smaller matrix to the bottom left of the grille, rotating it again by ninety degrees, and mark the 4s.</li>
<li value="3">Punch or cut holes in the larger matrix wherever there is a number.</li>
</ol>
<p>The grille constructed in <a href="#figure11-3">Figure 11-3</a> is the one that was used to encrypt the Christmas card.</p>
<figure>
<img alt="" class="" height="390" src="image_fi/502727c11/f11003.png" width="694"/>
<figcaption><p><a id="figure11-3">Figure 11-3</a>: A turning grille can be constructed with a square matrix that is filled with numbers from 1 to 4 at random. The resulting grille is four times as big.</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_223" title="223"/>A message encrypted with this stencil must have exactly thirty-six letters. If it has fewer, we’ll need to add a few nulls.</p>
<h2 id="h1-502727c11-0002"><a class="XrefDestination" id="Howtodetectaturninggrilleencryption"/><span class="XrefDestination" id="xref-502727c11-004"/>How to detect a turning grille encryption</h2>
<p class="BodyFirst">Turning grille cryptograms are usually easy to detect. If a message is written in a square form and if frequency analysis indicates that it is a transposition cipher, chances are that you are dealing with a turning grille ciphertext. Of course, it is easy to arrange a message of this kind in a form other than a square, but experience shows that many turning grille users waive this simple security measure. The message in <a href="#figure11-4" id="figureanchor11-4">Figure 11-4</a>, which was published by Dutch cryptologist Auguste Kerckhoffs (1835–1903) in his 1883 book <em>La</em> <em>Cryptographie Militaire</em>, is a typical example.<sup class="endnote"><a href="b06.xhtml#c11-endnote-6" id="c11-noteref-6">6</a></sup></p>
<figure>
<img alt="" class="" height="288" src="image_fi/502727c11/f11004.png" width="291"/>
<figcaption><p><a id="figure11-4">Figure 11-4</a>: A turning grille cryptogram created by Auguste Kerckhoffs in the nineteenth century</p></figcaption>
</figure>
<p>If a message is not written in square form, the message length is a possible indicator that you are dealing with a turning grille. A turning grille with an even line length produces messages that have the length of a squared even number (for instance, 16, 36, 64, or 100). If the line length is odd and the square in the middle is left empty, the message length is a squared odd number minus one (for instance, 24 or 48). Of course, this length, too, can be changed, for instance, by adding a few nulls. But again, in our experience, most turning grille users do not take this extra step to make their system more secure.</p>
<h2 id="h1-502727c11-0003"><a class="XrefDestination" id="Howtobreakaturninggrilleencryption"/><span class="XrefDestination" id="xref-502727c11-005"/>How to break a turning grille encryption</h2>
<p class="BodyFirst">Breaking a turning grille cryptogram works very well with hill climbing cryptanalysis, which is an iterative computer technique we will introduce in <span class="xref" itemid="xref_target_Chapter 16"><a href="c16.xhtml">Chapter 16</a></span>. Still, it is possible to break a turning grille cryptogram by hand, though you usually need a crib or at least a few letters from the plaintext that can be guessed. We will demonstrate this strategy with the cipher message on the simulated birthday card in <a href="#figure11-5" id="figureanchor11-5">Figure 11-5</a>.</p>
<span epub:type="pagebreak" id="Page_224" title="224"/><figure>
<img alt="" class="" height="386" src="image_fi/502727c11/f11005.png" width="694"/>
<figcaption><p><a id="figure11-5">Figure 11-5</a>: The message on this birthday card (created by the authors for this book) is encrypted using a turning grille cipher.</p></figcaption>
</figure>
<p>Here’s a transcript of the message:</p>
<p class="BodyCustom"><code>H L H O D V</code></p>
<p class="BodyCustom"><code>T A I A E P</code></p>
<p class="BodyCustom"><code>Y B P E T T</code></p>
<p class="BodyCustom"><code>I Y L O H T</code></p>
<p class="BodyCustom"><code>Y B O L W Y</code></p>
<p class="BodyCustom"><code>I E R U T N</code></p>
<p>This cryptogram consists of thirty-six letters written in a square. Analysis reveals letter frequencies that are similar to that of the English language. We therefore assume that we are dealing with a turning grille encryption.</p>
<p>Can we guess a plaintext word? Considering that this message is a birthday greeting, BIRTHDAY is a promising candidate. This guess is confirmed by the fact that the letters B, I, R, T, H, D, A, and Y all appear in the cryptogram.</p>
<p>One of the inherent properties of every turning grille message is that the average distance between two letters that are neighbors in the plaintext is four (i.e., there are three letters in between them), no matter the size of the grid. This is because the grille always has exactly four different positions.</p>
<p>So, our first step is to find the letters of the crib, bearing in mind this average letter interval. If we look for BIRTHDAY, finding the word’s start is easy, as there is only one B in the message. Continuing on to the right, we encounter an I five cells later. There are also an R and a T in the following line:</p>
<figure class="graphic">
<img alt="" class="" height="103" src="image_fi/502727c11/g11003.png" width="283"/></figure>
<p><span epub:type="pagebreak" id="Page_225" title="225"/>Assuming that we have discovered the letters BIRT from BIRTHDAY, we now turn the grille 180 degrees and place it along the top of the grid to see which letters are “seen through the holes”:</p>
<figure class="graphic">
<img alt="" class="" height="103" src="image_fi/502727c11/g11004.png" width="283"/></figure>
<p>The four squares we have identified show the letters LOVE—a word that makes sense on a birthday card. Let’s now look for the letters HDAY, which we expect to follow BIRT. As the T of BIRT stands close to the end of the cryptogram, we need to look for HDAY at its beginning. There are four different possibilities (indicated by squares with solid lines; the dotted squares indicate the letter sequences we get when we turn this proposed grille fragment by 180 degrees):</p>
<figure class="graphic">
<img alt="" class="" height="150" src="image_fi/502727c11/g11005.png" width="844"/></figure>
<p>The potential four-letter sequences we get when turning the grille are TWEN, HLIR, TOEN, and TOEU. All of these might appear in an English text. However, as we are dealing with a birthday card, TWEN makes the most sense, because TWENTY or TWENTIETH might refer to the age of the receiver. This means that the first of the four options is the most likely one. Now, we have identified two four-hole fragments of the grille. They can be connected to one five-hole fragment, as shown in <a href="#figure11-6" id="figureanchor11-6">Figure 11-6</a>.</p>
<figure>
<img alt="" class="" height="363" src="image_fi/502727c11/f11006.png" width="511"/>
<figcaption><p><a id="figure11-6">Figure 11-6</a>: Two grille fragments that fit together</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_226" title="226"/>The N of TWEN is the last letter in the last line. If we assume that the next letter is T (as in TWENTY or TWENTIETH), we need to look at the top of the grid for the continuation. As an aid, we turn the five-hole grille fragment by ninety degrees.</p>
<figure class="graphic">
<img alt="" class="" height="275" src="image_fi/502727c11/g11006.png" width="277"/></figure>
<p>In fact, the grille fragment now indicates a T at a position that makes sense. What letters might be between the T and BIRT? The sequence IETH would make sense, as it renders TWENTIETH BIRTHDAY. The positions of the I and the H of IETH are clear. (Note that the I at the beginning of the fourth line can’t be the right one, as there is no ETH after it.) There are two Es, but the first one is already used. It is unclear, though, which of the two Ts is the right one:</p>
<figure class="graphic">
<img alt="" class="" height="275" src="image_fi/502727c11/g11007.png" width="277"/></figure>
<p>To determine which T is correct, we again turn the grille fragment by 180 degrees:</p>
<figure class="graphic">
<img alt="" class="" height="258" src="image_fi/502727c11/g11008.png" width="277"/></figure>
<p><span epub:type="pagebreak" id="Page_227" title="227"/>It should be apparent that the letter sequence BILLY is more likely than BYLLY. This means that the second T is the right one.</p>
<p>We have now found the position of eight of the nine holes in the grille. For the remaining one, there are four choices: I, T, Y, and L:</p>
<figure class="graphic">
<img alt="" class="" height="283" src="image_fi/502727c11/g11009.png" width="284"/></figure>
<p>Only Y makes sense here, as it renders us HAPPYTWEN for the first nine letters of the plaintext. We are done. <a href="#figure11-7" id="figureanchor11-7">Figure 11-7</a> shows the grille we have derived.</p>
<figure>
<img alt="" class="" height="353" src="image_fi/502727c11/f11007.png" width="694"/>
<figcaption><p><a id="figure11-7">Figure 11-7</a>: The grille used to encrypt the birthday card</p></figcaption>
</figure>
<p>The plaintext is <code class="bold">HAPPY TWENTIETH BIRTHDAY TO YOU LOVE BILLY</code>.</p>
<h2 id="h1-502727c11-0004"><a class="XrefDestination" id="Successstories"/><span class="XrefDestination" id="xref-502727c11-006"/>Success stories</h2>
<h3 id="h2-502727c11-0001"><a class="XrefDestination" id="PaoloBonavoglia’sturninggrillesolution"/><span class="XrefDestination" id="xref-502727c11-007"/>Paolo Bonavoglia’s turning grille solution</h3>
<p class="BodyFirst">Our colleague Paolo Bonavoglia, a prolific modern author of articles about Italian cryptologic history, is also the grandson of Luigi Sacco (1883–1970). Sacco was a notable Italian cryptologist who, among other achievements, <span epub:type="pagebreak" id="Page_228" title="228"/>set up a cipher office for the Italian army during World War I to break messages from the Austrian and German armies.</p>
<p>In a notebook that his grandfather left behind, Paolo found numerous German ciphertexts, including the one depicted in <a href="#figure11-8" id="figureanchor11-8">Figure 11-8</a>.<sup class="endnote"><a href="b06.xhtml#c11-endnote-7" id="c11-noteref-7">7</a></sup> He set out to solve this apparently unsolved message. The letter <code>Ö</code>, which appears in the first line, confirmed to Paolo that the message was in German. His eye was also immediately drawn to the presence of the letters <code>X</code> and <code>Y</code> in the lower-left corner, as both letters are quite rare in German texts. Paolo therefore suspected that the two letters had been used as nulls to complete the grille.</p>
<figure>
<img alt="" class="" height="452" src="image_fi/502727c11/f11008.png" width="448"/>
<figcaption><p><a id="figure11-8">Figure 11-8</a>: A turning grille cryptogram Paolo Bonavoglia found in a notebook belonging to his grandfather, Luigi Sacco</p></figcaption>
</figure>
<p>In addition, Paolo guessed that the cryptogram contained the word SUCHE (SEARCH) or SUCHEN (TO SEARCH), starting on the right-hand side. Any of the text’s four Ss, three Us, four Es, and two Ns could form one of these words. Paolo had to check dozens of combinations, but after many attempts, he found the following solution:</p>
<p class="BodyCustom">ES WURDEN DREI PUNKTE GESEHEN ÖTLLICH WEITESRSSUCHEN XY</p>
<p>The word ÖTLLICH is misspelled; it should be ÖSTLICH (EAST OF). This message translates to: THREE POINTS HAVE BEEN SEEN. KEEP ON SEARCHING IN THE EAST XY.</p>
<p>Paolo published his solution in 2017, and shortly afterward, New Zealand–based crypto expert Bart Wenmeckers broke the same cryptogram with a computer-based hill-climbing method (see <span class="xref" itemid="xref_target_Chapter 16"><a href="c16.xhtml">Chapter 16</a></span>).</p>
<p>As an interesting side note, while we were writing our book and asking these brilliant codebreakers to assist with reviewing our work, when Tobias Schrödel proofread this chapter in 2020, he discovered something previously unknown! Double-checking Sacco’s notebook page containing the <span epub:type="pagebreak" id="Page_229" title="229"/>turning grille cryptogram, he noticed a sequence of forty-eight numbers, starting with 1, 37, 25, 26, 38, and 2. He realized that this was the solution of the ciphertext: letter 1 in the ciphertext (E) is at position 1 in the plaintext, letter 2 in the ciphertext (E) is at position 37 in the plaintext, letter 3 in the ciphertext (N) is at position 25 in the plaintext, and so on.</p>
<p>Tobias sent this information to Paolo, who had not made the connection; this meant that his grandfather had solved this ciphertext and left an encrypted clue behind!</p>
<h3 id="h2-502727c11-0002"><a class="XrefDestination" id="AndréLangie’sturninggrillesolution"/><span class="XrefDestination" id="xref-502727c11-008"/>André Langie’s turning grille solution</h3>
<p class="BodyFirst">In his marvelous 1922 book <em>Cryptography</em>, Swiss cryptologist André Langie (1871–1961) tells the story of a gentleman who received an encrypted message while staying in a hotel called the North Pole.<sup class="endnote"><a href="b06.xhtml#c11-endnote-8" id="c11-noteref-8">8</a></sup> The sender was a person this gentleman knew, and the two had agreed that the cipher would be a turning grille. However, the man in the hotel had lost the notes that contained a description of the grille, so he could not decrypt the message. Thus, he contacted Langie.</p>
<p>Here is the sixty-four-character English version of the message. Different versions were provided in each translation of the book:</p>
<p class="BodyCustom" style="white-space: pre-wrap;overflow-wrap: break-word;word-break: break-all;">AITEGFLYTBOEEHREAUWNANOARRDRTEETHOSHFPETAPOTOYHLRETIHENEMGAOARNT</p>
<p>To decrypt the message, Langie wrote it down in a grid format and numbered the sixty-four squares for easy identification (see <a href="#figure11-9" id="figureanchor11-9">Figure 11-9</a>). Langie’s attention was immediately drawn to the letters A and T (squares 1 and 3), as AT is a common word in English and one that might easily form the beginning of a message. Accordingly, he marked the position of these two letters on tracing paper and turned his grille by 180 degrees.</p>
<figure>
<img alt="" class="" height="413" src="image_fi/502727c11/f11009.png" width="412"/>
<figcaption><p><a id="figure11-9">Figure 11-9</a>: A turning grille cryptogram solved by André Langie in the early twentieth century</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_230" title="230"/>The marks on the tracing paper coincided with the letters R and T (squares 62 and 64). RT is a common word ending, and it is evident that, from the last two lines, one could easily extract the word HEART in squares 53, 54 (or 56), 59 (or 61), 62, and 64. Marking these and again reversing the tracing paper, Langie found, in the corresponding squares—1, 3, 4 (or 6), 9 (or 11), and 12—the letters ATE (or F), T (or O), and E. As this was not very satisfactory, he abandoned the combination and tried another.</p>
<p>Next, Langie turned his attention to the second line and decided to mark THE (squares 9, 14, and 16), the most common trigraph in English. Reversing the tracing paper brought the marks to the corresponding squares 49, 51, and 56 in the sixth line, indicating the letters RTE—a promising combination. Looking for the vowel that preceded it, Langie first noticed the O (in square 45). Three squares earlier (at 42) was a P. He now had the group PORTE, which seemed to call for the final R, which occurred in the last line, at square 62.</p>
<p>Langie again turned the paper by 180 degrees, which brought to light T (square 3) and NO (20 and 23), producing the sequence TTHENO. The first of these letters was doubtlessly the final one of some other word, and the last two were the beginning of a new word.</p>
<p>The next step was, tentatively, to begin the construction of the grille, which Langie did by drawing squares around the letters PORTER (42, 45, 49, 51, 56, and 62). He then made a small mark on each of these six letters. Next, he turned the tracing paper, this time by only ninety degrees. His six marked squares now covered the letters IOUSAG (2, 11, 18, 35, 41, and 58). These he labeled with a different mark.</p>
<figure class="graphic">
<img alt="" class="" height="413" src="image_fi/502727c11/g11010.png" width="412"/></figure>
<p>A further turn brought him to the group <code>TTHENO</code> (squares 3, 9, 14, 16, 20, and 23), which he marked, too:</p>
<span epub:type="pagebreak" id="Page_231" title="231"/><figure class="graphic">
<img alt="" class="" height="413" src="image_fi/502727c11/g11011.png" width="412"/></figure>
<p>A final turn produced <code>LAEHEN</code> (squares 7, 24, 30, 47, 54, and 63), which he indicated in another way:</p>
<figure class="graphic">
<img alt="" class="" height="413" src="image_fi/502727c11/g11012.png" width="412"/></figure>
<p>Langie had now neutralized twenty-four out of the sixty-four squares, thereby considerably narrowing his field of research. Coming back to his original group, <code class="bold">PORTER</code>, he looked for a word likely to precede it and was favorably inclined toward <code class="bold">THE</code> (32, 36, and 39). There were two <code>H</code>s between the <code>T</code> and <code>E</code>, and he adopted the second experimentally.</p>
<p>Marking these and reversing the tracing paper, Langie found the three corresponding letters to be <code>RTH</code> (26, 29, and 33). This enlarged the group <code>TTHENO</code> to <code>T</code> <code class="bold">THE NORTH</code>—a result that proved he was on the right track. Accordingly, he marked in four colors the corresponding letters in the four positions, bringing the total number of neutralized squares to thirty-six.</p>
<p><span epub:type="pagebreak" id="Page_232" title="232"/>Progress subsequently was by leaps and bounds. For instance, upon scrutinizing the words THE NORTH and the unmarked letters following them, Langie discerned a P and an O and thought of POLE. These letters were duly found in squares 38, 43, 48, and 50. Having marked these and the corresponding letters in the other positions, he found that only twelve squares remained to be accounted for. With some additional guessing, he deduced the following plaintext:</p>
<p class="BodyCustom">IF YOU ARE STAYING AT THE NORTH POLE HOTEL BEWARE OF THE MANAGER AND THE PORTER</p>
<h3 id="h2-502727c11-0003"><a class="XrefDestination" id="KarldeLeeuw’sturninggrillesolution"/><span class="XrefDestination" id="xref-502727c11-009"/>Karl de Leeuw’s turning grille solution</h3>
<p class="BodyFirst">In 1993, crypto expert Karl de Leeuw, who is a colleague of ours, and crypto expert Hans van der Meer found in an Amsterdam archive an encrypted message (<a href="#figure11-10" id="figureanchor11-10">Figure 11-10</a>) left behind by Dutch governor and Prince of Orange William V (1748–1806).<sup class="endnote"><a href="b06.xhtml#c11-endnote-9" id="c11-noteref-9">9</a></sup> The cryptogram’s shape suggested that the writer had used a 16 × 16 turning grille. As the message was too long for the grille’s 256 fields, some fields contained two letters.</p>
<p>The letter frequencies indicated that the plaintext language was German. The letter Ü in the second-to-last position of the third line, with its distinctive dots, confirmed this suspicion.</p>
<figure>
<img alt="" class="" height="603" src="image_fi/502727c11/f11010.png" width="538"/>
<figcaption><p><a id="figure11-10">Figure 11-10</a>: Eighteenth-century turning grille cryptogram solved by Karl de Leeuw and Hans van der Meer in the twentieth century</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_233" title="233"/>In 1993, the technique of breaking turning grille ciphers with computer support (such as with hill climbing) was still in its infancy. Karl and Hans therefore tried their luck with manual methods, which is usually quite difficult when the stencil is as large as the one used here. Nevertheless, the two found a surprisingly simple way to decipher the cryptogram. They took advantage of the fact that the writer had been sloppy when placing letters into the holes. This can be seen most clearly in line 6, where the letters E (at position 8), I (at position 10), and N (at position 16) are written slightly lower than the others, which implies that they were all written with the stencil in a certain position.</p>
<figure class="graphic">
<img alt="" class="" height="158" src="image_fi/502727c11/g11013.png" width="694"/></figure>
<p>In line 7, the same applies to G, E, G, and A:</p>
<figure class="graphic">
<img alt="" class="" height="125" src="image_fi/502727c11/g11014.png" width="694"/></figure>
<p>In the eighth line, though not quite so clear, N, G, E, and N are a little lower than the other letters, too. Together, these letters form EINGEGANGEN, which is a German word meaning GONE IN.</p>
<p>Reversing the stencil resulted in BIERWELCHESI, which also makes sense in German (BIER means BEER and WELCHES means WHICH). Based on these observations, Karl and Hans were able to reconstruct the positions of eleven holes, which gave them a total of forty-four letters. Then, with the technique described earlier in this chapter, they could solve the rest of the message. The grille they derived can be seen in <a href="#figure11-11" id="figureanchor11-11">Figure 11-11</a>. Here’s the plaintext:</p>
<p class="BodyCustom">die franszosen sind laut eingegangener erkundigung und nach richt von camberg abmarchiret es sollen aber dem verlaut nach andere an deren stelle einrucken vielleicht fürchten sie das en gelische bier welches ihnen wohl übel bekommen durfte wan es recht getruncken wird ich wünschet dass sie die rechte maass be kommen mögten [separation mark] koenig</p>
<p class="BodyContinued">It translates to the following:</p>
<p class="BodyCustom">According to an inquiry that has arrived and a message, the French have left Camberg. However, according to rumors, others will replace <span epub:type="pagebreak" id="Page_234" title="234"/>them soon. Perhaps they fear the English beer, which will make them sick when it is drunk. I hope they will get the right amount of it. Koenig</p>
<figure>
<img alt="" class="" height="485" src="image_fi/502727c11/f11011.png" width="486"/>
<figcaption><p><a id="figure11-11">Figure 11-11</a>: The turning grille Karl de Leeuw and Hans van der Meer derived when they solved the message left behind by Dutch governor William V. This message was written in a somewhat sloppy way, which allowed it to be solved more easily. In addition, the regular pattern of the holes is helpful for a codebreaker.</p></figcaption>
</figure>
<p>Apparently, the author of this note was joking about English beer—certainly an interesting find, especially because they took the time to encrypt the joke!</p>
<h3 id="h2-502727c11-0004"><a class="XrefDestination" id="TheMathiasSandorfcryptogram"/><span class="XrefDestination" id="xref-502727c11-010"/>The Mathias Sandorf cryptogram</h3>
<p class="BodyFirst">In his famous 1885 novel <em>Mathias Sandorf</em>, French author Jules Verne (1828–1905) describes two petty criminals who find an encrypted message attached to the leg of a carrier pigeon and later find a turning grille that they use to decrypt the cryptogram (<a href="#figure11-12" id="figureanchor11-12">Figure 11-12</a>). The message reads as follows:</p>
<p class="BodyCustom"><code>IHNALZ ARNURO ODXHNP AEEEIL SPESDR EEDGNC</code></p>
<p class="BodyCustom"><code>ZAEMEN TRVREE ESTLEV ENNIOS ERSSUR TOEEDT</code></p>
<p class="BodyCustom"><code>RUIOPN MTQSSL EEUART NOUPVG OUITSE ERTUEE</code></p>
<p>In 2000, German cryptology professor Klaus Pommerening published a paper that explains how a codebreaker could have solved the message without knowing the grille.<sup class="endnote"><a href="b06.xhtml#c11-endnote-10" id="c11-noteref-10">10</a></sup> The codebreaking process Pommerening describes is too lengthy to be covered in full in our book, so we will use a few shortcuts.</p>
<p><span epub:type="pagebreak" id="Page_235" title="235"/>Let’s start with Pommerening’s assumptions that the plaintext is in French, that each line of thirty-six letters is encrypted separately with a 6 × 6 turning grille, and that the same grille was used for each line.</p>
<p>For cryptanalysts, one of the nice things about the French language is that the letter Q is relatively frequent in short words, such as QUE, QUOI, and QUEL, and that, as in many other languages, Q is usually followed by a U. (The word CINQ, which means FIVE, is the only common exception.) This means that, when working with a French plaintext, looking for a Q is a good start. As we can see, the third row contains a Q in position 9. Unfortunately, in the same line are five Us, which makes things a little more complex.</p>
<figure>
<img alt="" class="" height="550" src="image_fi/502727c11/f11012.png" width="694"/>
<figcaption><p><a id="figure11-12">Figure 11-12</a>: The 1885 novel <em>Mathias Sandorf</em> by Jules Verne contains a message encrypted with a turning grille.</p></figcaption>
</figure>
<p>Pommerening knew that the same grille had been used for all three lines, so he could apply the technique of multiple anagramming (see <span class="xref" itemid="xref_target_Chapter 9"><a href="c09.xhtml">Chapter 9</a></span>) to check the most plausible combination. With this method, the five Us after the Q in the third line lead to the following five options in the first and second lines:</p>
<p class="BodyCustom"><code>NH NX NE NP NG</code></p>
<p class="BodyCustom"><code>VA VT VN VR VE</code></p>
<p class="BodyCustom"><code>QU QU QU QU QU</code></p>
<p>While the letter pairs NH, NX, VT, and VN are rare in French, NG and VE are quite common. For this reason, the last option looks best, so <span epub:type="pagebreak" id="Page_236" title="236"/>Pommerening assumed that it was correct. As QU is usually followed by E or I in French, he had eight plausible possibilities to proceed:</p>
<p class="BodyCustom"><code>NGN NGO NGD NGE NGR NGE NGN NGC</code></p>
<p class="BodyCustom"><code>VEE VEE VES VES VER VET VED VET</code></p>
<p class="BodyCustom"><code>QUI QUE QUE QUI QUE QUE QUE QUE</code></p>
<p>Possibilities 4, 5, and 6 look promising. Typically, a codebreaker would have to check all three options, but to make things easier, let’s select the fifth block (the correct one, as will become clear). As another shortcut, we assume, based on the content of the novel, that NGR is a part of the word HONGRIE, which is French for HUNGARY. This assumption is supported by the fact that the first row of the cryptogram also contains the letters H and O (even two of each), providing Pommerening with four possible arrangements:</p>
<p class="BodyCustom"><code>HONGR HONGR HONGR HONGR</code></p>
<p class="BodyCustom"><code>AEVER AEVER LEVER LEVER</code></p>
<p class="BodyCustom"><code>ULQUE UEQUE ALQUE AEQUE</code></p>
<p>Pommerening now chose block 3, as the letter sequences <code class="bold">LEVER</code> and <code class="bold">ALQUE</code> make sense in French, while the letter combination <code>AE</code> is quite rare. He continued by appending an <code>I</code> to <code>HONGR</code> (remember that we want to construct the word <code class="bold">HONGRIE</code>), which produced two possibilities:</p>
<p class="BodyCustom"><code>HONGRI HONGRI</code></p>
<p class="BodyCustom"><code>LEVERZ LEVERO</code></p>
<p class="BodyCustom"><code>ALQUER ALQUEV</code></p>
<p>The second possibility seemed more plausible, as ERZ is not a common trigraph in French. Pommerening now needed an E after HONGRI, resulting in six variants:</p>
<p class="BodyCustom"><code>HONGRIE HONGRIE HONGRIE HONGRIE HONGRIE HONGRIE</code></p>
<p class="BodyCustom"><code>LEVERON LEVERON LEVEROI LEVEROS LEVEROT LEVEROO</code></p>
<p class="BodyCustom"><code>ALQUEVO ALQUEVU ALQUEVP ALQUEVI ALQUEVA ALQUEVR</code></p>
<p>He recognized here the word LEVERONT (“will stand up”), with the last letter missing. This meant that the initial two options were the most likely ones. The first appeared to be the correct one, as VO in the last line could be extended to VOUS (“you”). To produce this word, Pommerening added a U (omitting the S, as there were several choices for it):</p>
<p class="BodyCustom"><code>HONGRIEX</code></p>
<p class="BodyCustom"><code>LEVERONT</code></p>
<p class="BodyCustom"><code>ALQUEVOU</code></p>
<p>The X didn’t fit especially well, but it could be padding. As the word LEVERONT is reflexive (the complete expression is SE LEVERONT), Pommerening now needed an E in the second line, before LEVERONT. <span epub:type="pagebreak" id="Page_237" title="237"/>Two of the ten Es in the second row were already absorbed, but there were still eight choices:</p>
<p class="BodyCustom"><code>NHONGRIEX LHONGRIEX RHONGRIEX OHONGRIEX</code></p>
<p class="BodyCustom"><code>ELEVERONT ELEVERONT ELEVERONT ELEVERONT</code></p>
<p class="BodyCustom"><code>IALQUEVOU PALQUEVOU SALQUEVOU EALQUEVOU</code></p>
<p class="BodyCustom"> </p>
<p class="BodyCustom"><code>NHONGRIEX AHONGRIEX SHONGRIEX DHONGRIEX</code></p>
<p class="BodyCustom"><code>ELEVERONT ELEVERONT ELEVERONT ELEVERONT</code></p>
<p class="BodyCustom"><code>RALQUEVOU NALQUEVOU OALQUEVOU TALQUEVOU</code></p>
<p>Options 1, 3, 5, and 6 looked the most promising. In a real codebreaking process, one would have to follow all four paths to find out the right one. However, this is only a summary, so we will only cover option 6, which is the correct one. In order to get SE LEVERONT, Pommerening needed an S at the beginning of the second line. There were four to choose from:</p>
<p class="BodyCustom"><code>DAHONGRIEX LAHONGRIEX EAHONGRIEX SAHONGRIEX</code></p>
<p class="BodyCustom"><code>SELEVERONT SELEVERONT SELEVERONT SELEVERONT</code></p>
<p class="BodyCustom"><code>ENALQUEVOU GNALQUEVOU INALQUEVOU TNALQUEVOU</code></p>
<p>The second option renders LA HONGRIE (“the Hungary) in the first line, which looks good, as the French usually refer to nations with a definite article. Pommerening now searched the third row for extensions. He found SIGNAL QUE VOUS (“signal that you” or “signal which you”). Adding an I on the left side of the third line yielded two possibilities:</p>
<p class="BodyCustom"><code>NLAHONGRIEX ELAHONGRIEX</code></p>
<p class="BodyCustom"><code>ESELEVERONT SSELEVERONT</code></p>
<p class="BodyCustom"><code>IGNALQUEVOU IGNALQUEVOU</code></p>
<p>The first option led to nothing, so Pommerening took the second and added an S on the left side of the third line:</p>
<p class="BodyCustom"><code>UELAHONGRIEX RELAHONGRIEX DELAHONGRIEX</code></p>
<p class="BodyCustom"><code>RSSELEVERONT ESSELEVERONT USSELEVERONT</code></p>
<p class="BodyCustom"><code>SIGNALQUEVOU SIGNALQUEVOU SIGNALQUEVOU</code></p>
<p>The third variant stood out because of the sequence DE LA HONGRIE (“from Hungary”) in the first line.</p>
<p>For space reasons, we’ll skip the rest of the multiple-anagramming process. Pommerening proceeded to solve the rest of the cryptogram, resulting in the following plaintext:</p>
<p class="BodyCustom"><code>SSEPOURLI NDEPENDAN CEDELAHON GRIEXRZAH</code></p>
<p class="BodyCustom"><code>SENVERREZ DETRIESTE TOUSSELEV ERONTENMA</code></p>
<p class="BodyCustom"><code>TOUTESTPR ETAUPREMI ERSIGNALQ UEVOUSNOU</code></p>
<p>However, this message only makes sense if one reads the third line first, then the second, and then the first:</p>
<p class="BodyCustom"><code>TOUTESTPR ETAUPREMI ERSIGNALQ UEVOUSNOU</code></p>
<p class="BodyCustom"><code>SENVERREZ DETRIESTE TOUSSELEV ERONTENMA</code></p>
<p class="BodyCustom"><code>SSEPOURLI NDEPENDAN CEDELAHON GRIEXRZAH</code></p>
<p><span epub:type="pagebreak" id="Page_238" title="238"/>With punctuation, the plaintext reads as follows:</p>
<p class="BodyCustom">TOUT EST PRÊT. AU PREMIER SIGNAL QUE VOUS NOUS ENVERREZ DE TRIESTE, TOUS SE LÈVERONT EN MASSE POUR L’INDÉPENDANCE DE LA HONGRIE. XRZAH.</p>
<p>It translates to this:</p>
<p class="BodyCustom">All is ready. At the first signal you send us from Trieste, all will stand up en masse for the independence of Hungary. Xrzah </p>
<p class="BodyContinued">XRZAH is the sender’s codename.</p>
<p>The French plaintext (TOUT EST PRÊT . . .) is exactly the message contained in Jules Verne’s French original edition of <em>Mathias Sandorf</em>. In the English translation of this novel (at least, the one we found online), the message was not translated.</p>
<p>Note that Pommerening didn’t use any special information about turning grilles in his codebreaking process. He used only multiple anagramming to determine the order of the thirty-six letters in each line.</p>
<p>Identifying the kind of grille used is usually trivial if one knows both the plaintext and the ciphertext. However, in this case, no turning grille can produce the given ciphertext from the given plaintext, at least with typical methods. However, if we write each line backward, we can find a grille that fits. The turning grille used for this transformation can be seen in <a href="#figure11-13" id="figureanchor11-13">Figure 11-13</a>.</p>
<figure>
<img alt="" class="" height="357" src="image_fi/502727c11/f11013.png" width="350"/>
<figcaption><p><a id="figure11-13">Figure 11-13</a>: The turning grille used for the cipher message in Jules Verne’s 1885 novel <em>Mathias Sandorf</em>. The letters seen through the holes read (from the bottom) (HON)GRIE XRZAH (Hungary XRZAH), the final part of the plaintext.</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_239" title="239"/>As has been shown, the third line of the plaintext needs to be read before the second and the first one. In addition, each line must be read backward. These observations can be explained in a simple way: the encipherer wrote the whole message backward before encrypting it in chunks of thirty-six letters, each with a 6 × 6 turning grille.</p>
<h2 id="h1-502727c11-0005"><a class="XrefDestination" id="Challenges"/><span class="XrefDestination" id="xref-502727c11-011"/>Challenges</h2>
<h3 id="h2-502727c11-0005"><a class="XrefDestination" id="TheFriedmans’Christmascard"/><span class="XrefDestination" id="xref-502727c11-012"/>The Friedmans’ Christmas card</h3>
<p class="BodyFirst">The Christmas card in <a href="#figure11-14" id="figureanchor11-14">Figure 11-14</a> was created by world-renowned codebreakers William and Elizebeth Friedman in 1928.<sup class="endnote"><a href="b06.xhtml#c11-endnote-11" id="c11-noteref-11">11</a></sup></p>
<figure>
<img alt="" class="" height="550" src="image_fi/502727c11/f11014.png" width="694"/>
<figcaption><p><a id="figure11-14">Figure 11-14</a>: An encrypted Christmas card sent by William and Elizebeth Friedman in 1928</p></figcaption>
</figure>
<p>Here’s a transcript. Note that, in the original, the number 28 at the end is treated as one character:</p>
<p class="BodyCustom"><code> ABFWORREC</code></p>
<p class="BodyCustom"><code>U SRIYEPN G</code></p>
<p class="BodyCustom"><code>CT HARSI OS</code></p>
<p class="BodyCustom"><code>YMO UTE AWN</code></p>
<p class="BodyCustom"><code>ETLM   AESP</code></p>
<p class="BodyCustom"><code>OSRQ   DUOI</code></p>
<p class="BodyCustom"><code>GHRO   TEOE</code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_240" title="240"/><code>FTX MTE UAP</code></p>
<p class="BodyCustom"><code>GI RTASM NH</code></p>
<p class="BodyCustom"><code>O DGCSAIH E</code></p>
<p class="BodyCustom"><code> NEETRREE28</code></p>
<p>This cryptogram is straightforward to solve, possibly to make it easier for the Friedmans’ non-cryptanalyst friends! Just use the turning grille depicted on the left side of the card. If you want a harder challenge, try to decipher this encrypted message without using the grille.</p>
<h3 id="h2-502727c11-0006"><a class="XrefDestination" id="Jew-LeeandBill’sCryptocablegram"/><span class="XrefDestination" id="xref-502727c11-013"/>Jew-Lee and Bill’s Cryptocablegram</h3>
<p class="BodyFirst">The “Cryptocablegram” in <a href="#figure11-15" id="figureanchor11-15">Figure 11-15</a> was created by modern codebreaking enthusiasts Jew-Lee Lann-Briere and Bill Briere for their talk about William and Elizebeth Friedman at the NSA Symposium on Cryptologic History in 2017.</p>
<figure>
<img alt="" class="" height="683" src="image_fi/502727c11/f11015.png" width="578"/>
<figcaption><p><a id="figure11-15">Figure 11-15</a>: A challenge cipher created by Jew-Lee Lann-Briere and Bill Briere</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_241" title="241"/>Jew-Lee and Bill applied two encryption steps to the plaintext. First, they encrypted it with a simple substitution cipher. Then, they used a turning grille. Here’s the table that inverts the substitution:</p>
<p class="BodyCustom"><code>ABCDEFGHIJKLMNOPQRSTUVWXYZ</code></p>
<p class="BodyCustom"><code>HJKLOPQSTUVWXYZFRIEDMANBCG</code></p>
<p>There is an easy way to solve this cryptogram—and a hard one. Without any further hints, can you decipher this turning grille encryption?</p>
<h3 id="h2-502727c11-0007"><a class="XrefDestination" id="AMysteryTwisterC3challenge"/><span class="XrefDestination" id="xref-502727c11-014"/>A MysteryTwister challenge</h3>
<p class="BodyFirst">MysteryTwister (<a class="LinkURL" href="https://mysterytwister.org">https://mysterytwister.org</a>) is a large crypto puzzle website with hundreds of challenges, ranging from easy to difficult, and a community of thousands of members trying to solve them to gain points. One of its many difficult cryptograms involves a turning grille (<a href="#figure11-16" id="figureanchor11-16">Figure 11-16</a>).<sup class="endnote"><a href="b06.xhtml#c11-endnote-12" id="c11-noteref-12">12</a></sup></p>
<figure>
<img alt="" class="" height="288" src="image_fi/502727c11/f11016.png" width="288"/>
<figcaption><p><a id="figure11-16">Figure 11-16</a>: A 2011 turning grille challenge available on the MysteryTwister website</p></figcaption>
</figure>
<p>The solution is an English sentence. If you want a hint, check out <a class="LinkURL" href="https://codebreaking-guide.com/challenges/">https://codebreaking-guide.com/challenges/</a>.</p>
<h3 id="h2-502727c11-0008"><a class="XrefDestination" id="AKerckhoffscryptogram"/><span class="XrefDestination" id="xref-502727c11-015"/>A Kerckhoffs cryptogram</h3>
<p class="BodyFirst">Earlier in this chapter, we introduced a turning grille cryptogram published in 1883 by Auguste Kerckhoffs (<a href="#figure11-4">Figure 11-4</a>). The plaintext is French. Can you solve it?</p>
</section>
</div></body></html>