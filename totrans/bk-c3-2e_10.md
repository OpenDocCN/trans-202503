## **10**

**COLOR AND OPACITY**

![Image](graphics/common-01.jpg)

Color in CSS2 was based around the *Red*, *Green*, *Blue (RGB)* model; whether you used hexadecimal or `rgb()` function values, you had to combine those three colors to add color to your pages. Of course, designers speak in terms of shades and tints: When a designer says to use a “50 percent tint” of a certain color, developers have had to use the RGB model to match that color, which has often involved some chicanery with a graphics package to find the exact tone needed.

The CSS Color Module (*[http://www.w3.org/TR/css3-color/](http://www.w3.org/TR/css3-color/)*) has a solution to that problem—and more besides. For starters, it introduces the concepts of *opacity* through the `opacity` property and the *Alpha* color channel. In addition, the CSS Color Module adds an entirely new color model, which is more intuitive and easier to tweak to find the perfect tone.

The Color Module is a W3C Recommendation and is well implemented in IE9 and above and every other major browser, so with perhaps a bit of careful coding to provide a fallback for older versions of IE, you can begin to use its properties and values straightaway.

### **The opacity Property**

Opacity is, strictly speaking, the measure of an object’s resistance to light—the more opaque something is, the less light it lets through. An object with no opacity is fully transparent.

In CSS, opacity is measured using the `opacity` property. In essence, with `opacity`, you are setting how much of the background can be seen through the specified element. The `opacity` property has the following syntax:

```
E { opacity: number; }
```

The `*number*` value is a decimal fraction—that is, a number between 0.0 and 1.0—where 0.0 is fully transparent, 1.0 is fully opaque, and any value between those two is a blend of opacity and transparency. For example, to set an element to be 50 percent opaque (or 50 percent transparent, depending on whether your glass is half empty or half full), you use the following rule:

```
E { opacity: 0.5; }
```

To further demonstrate, I’ll show a set of elements—a parent `div`, with a child `div`, which in turn has a child `p`—repeated three times:

```
<div class="parent">
    <div class="child">
        <p>…</p>
    </div>
</div>
```

I’ll apply the same rules to each set of elements, except for a change to the `opacity` value. Here are the relevant rules for this example:

```
.parent { background-color: black; }
.child { background-color: white; }
.child.semi-opaque-1 { opacity: 0.66; }
.child.semi-opaque-2 { opacity: 0.33; }
```

You can see the output in [Figure 10-1](ch10.html#ch10fig1). The `.child` element in the first (left) example has no explicitly set value for `opacity`, so it defaults to 1.0, or fully opaque—its background is white. The next (middle) `.child` has a value of `0.66`, so its opacity is reduced by a third, causing the white background to appear as a light gray (a blend of the black background color of the parent and the white background color of the element itself, which shows through). Finally, the last (right) `.child` has an `opacity` value of `0.33`, so it can be considered two-thirds transparent, making the box a darker gray color.

![Image](graphics/f10-01.jpg)

*Figure 10-1: The effect of differing* `*opacity*` *values on three identical elements*

Now, here’s an extremely important point to remember about this property: Opacity affects not only the element it’s applied to but also all of that element’s children. If I set an `opacity` value of 0.5 on an element, its children will never be more opaque than that. This setting can’t be overruled by any other property—or rather, you can never make an element more opaque than its parent, but you *can* make it less opaque.

This may make the `opacity` property seem somewhat limiting, as you can’t apply it to elements with children without also applying it to their children. CSS3 has a new method to get around this limitation, however; it’s called the Alpha channel, and I explain it in the next section.

### **New and Extended Color Values**

CSS2.1 allowed three methods for specifying color values: keywords (`black`), hexadecimal notation (`#000000`), and RGB (`0`,`0`,`0`). In CSS3, the range is expanded by a completely new method of specifying colors (see “[Hue, Saturation, Lightness](ch10.html#ch10leve1sec119)” on [page 116](ch10.html#page_116)), as well as the introduction of opacity through the Alpha channel.

#### ***The Alpha Channel***

The *Alpha channel* (*Alpha* for short) is the measure of the opacity of a color—as opposed to the `opacity` property, which is the measure of the opacity of an element. So, although color values using Alpha can be inherited by child elements like any other color value, the overall opacity of the element is not affected.

CSS3 introduces Alpha as a value in the *RGBA* color model. RGBA stands for *Red*, *Green*, *Blue*, *Alpha*, and is applied with the `rgba()` function. The syntax is the same as for the `rgb()` function value used in CSS2, but with the Alpha value specified by an extra comma-separated argument at the end:

```
E { color: rgba(red, green, blue, alpha); }
```

The value of the `*alpha*` argument is the same as the value provided for opacity: a decimal fraction from 0.0 to 1.0, which is once again a measure between full transparency (0.0) and full opacity (1.0). If you want an element to have a foreground color of black at 50 percent opacity, you use the following code:

```
E { color: rgba(0,0,0,0.5); }
```

As mentioned, `rgba()` differs from the `opacity` property in two ways: First, `rgba()` is a color value, so you couldn’t, for example, use it to change the opacity of an image (or an element with a background image). Second, although the value of the `rgba()` function can be inherited, child elements can overrule with an `rgba()` value of their own.

To more precisely illustrate the difference between the two, I’ll create two identical code blocks using the following markup:

```
<div class="box">
    <div class="text">
        <h1>…</h1>
    </div>
</div>
```

I’ll apply the following CSS rules to this markup: both elements will get the same rules except that I’ll set the `opacity` of one and give an `rgba()` value to the `background-color` of another, both with the same decimal fraction value of `0.5`:

```
.box { background-image: url('monkey.svg'); }
.text { background-color: white; }
.opacity { opacity: 0.5; }
.rgba { background-color: rgba(255,255,255,0.5); }
```

The results are shown in [Figure 10-2](ch10.html#ch10fig2), and the difference is pretty clear. Both boxes have the same level of transparency, but in the first, the `opacity` value has been inherited by its child `p` element, also making the text semitransparent. In the second box, the `rgba()` value is applied strictly to the `background-color` of the `.text` element, so the `p` element retains its fully opaque black `color`.

![Image](graphics/f10-02.jpg)

*Figure 10-2: Comparing opacity (left) and RGBA (right)*

Having established that `rgba()` is not the same as `opacity`, let’s see how it works. Being a color value, it can obviously be used for backgrounds, borders, shadows, and so on. The following code shows some examples of `rgba` applied to different properties:

```
➊ .shadow .text { box-shadow: 10px 10px 4px rgba(0,0,0,0.7); }
➋ .border .text { border: 10px solid rgba(0,0,0,0.5); }
➌ .text-semi p { color: rgba(0,0,0,0.6); }
➍ .text-shadow p { text-shadow: 5px 5px 1px rgba(0,0,0,0.6); }
```

[Figure 10-3](ch10.html#ch10fig3) shows these properties in action. Moving clockwise from top left, in the first box, `rgba` lowers the opacity of `box-shadow`; setting the Alpha value to `0.7` ➊ allows some of the background to show through, making the shadow more “realistic.” The next example shows a 50 percent opaque black `border` ➋ (which I used in the example shown in [Figure 8-6](ch08.html#ch08fig6) on [page 93](ch08.html#page_93)). In the next example, the Alpha value of the `color` property has been set to `0.6` ➌, which makes the text appear semi-opaque. And finally the last example shows another shadow effect, this time on the `text-shadow` property. The Alpha value is set at `0.6` ➍, which, once again, makes for a more realistic shadow.

![Image](graphics/f10-03.jpg)

*Figure 10-3: RGBA applied to different properties*

##### **RGBA and Graceful Degradation**

Older browsers that don’t support RGBA values (notably IE8) will ignore any rules that use them and default to a previously specified or inherited value. To compensate, you should specify the color twice—first without and then with an Alpha value—using the cascade to ensure the right color is implemented:

```
p {
    color: #F00;
    color: rgba(255,0,0,0.75);
}
```

In this example, browsers that don’t support RGBA values ignore the second `color` property and apply the first `color` property. Of course, this result means that a fully opaque color will be used instead of a semiopaque one, so check your design thoroughly to make sure it isn’t negatively affected.

The same goes for all new color values introduced in the rest of this chapter.

#### ***Hue, Saturation, Lightness***

I mentioned earlier in the chapter that CSS3 brings a new notations system for color, and that system is known as HSL. Summing up exactly what HSL is without providing a course in color theory is hard, but I’ll do my best: *HSL*—which stands for *Hue*, *Saturation*, *Lightness* (sometimes called *Luminance*)—is a cylindrical-coordinate representation of color space. Still not clear? Take a look at [Figure 10-4](ch10.html#ch10fig4).

![Image](graphics/f10-04.jpg)

*Figure 10-4: The HSL color notation method ^([1](footnote.html#footnote5))*

All the possible colors are arranged in a cylinder with a central axis. The angle around the axis is the *hue*; the distance from the axis is the *saturation*; and the distance along the axis is the *lightness*. The combination of those three values creates a unique color.

*Hue* represents the major colors, starting and ending with red (0 or 360) and including all the main colors between. Think of the colors of the visible spectrum (or the colors of the rainbow) you learned about in school—red, orange, yellow, green, blue, indigo, and violet—arranged around the circumference of a circle; the value of hue is a degree around that circumference that points to a specific color.

*Saturation* is the strength or intensity of that color: 0 percent is zero intensity, which makes the color a shade of gray, and 100 percent is full strength, the most intense version of that color.

*Lightness* is the brightness or darkness of the color: 50 percent is the true color, 0 percent is black, and 100 percent is white.

If you’ve never encountered HSL before and my explanation has still left you baffled, don’t worry—for our purposes, you just need to understand that HSL is applied with the `hsl()` color value function. It takes three arguments, with a similar syntax to `rgb()`:

```
E { color: hsl(hue,saturation,lightness); }
```

The `*hue*` value is a number between 0 and 360 (the degrees around the hue wheel), and `*saturation*` and `*lightness*` accept values from 0 percent to 100 percent. Some simple color examples with their hexadecimal and RGB equivalents are shown in [Table 10-1](ch10.html#ch10table1).

**Table 10-1**: Common Color Equivalents for Four Color Values

| **HSL** | **RGB** | **Hexadecimal** | **Keyword** |
| 0,0%,0% | 0,0,0 | #000000 | `black` |
| 360,0%,100% | 255,255,255 | #FFFFFF | `white` |
| 0,100%,50% | 255,0,0 | #FF0000 | `red` |
| 120,100%,25% | 0,128,0 | #008000 | `green` |
| 240,100%,50% | 0,0,255 | #0000FF | `blue` |

**NOTE**
*Even if you are using a 0 (zero) value for saturation and lightness, you must still specify the value as a percentage.*

[Table 10-1](ch10.html#ch10table1) doesn’t actually tell the whole story—many different combinations of values allow you to create pure white, for example. Really, the best way to learn more about HSL is to get a color picker that supports it and play around for a while. Photoshop and most other graphics packages have an HSL color picker, and you should also be able to find color conversion tools online. Be careful, however, not to confuse HSL with *Hue, Saturation, Value (HSV)*—although they use an identical syntax, the color values are mapped differently so you will not get the same results.

The advantage of HSL over RGB (or hexadecimal) is that it allows you to try different variants of a color more quickly, such as making a certain color lighter/darker or more/less intense. The flexibility of HSL makes it more useful for web designers. If you’re a developer coding from other people’s designs, however, you may want to continue using RGB. HSL is simply a new alternative to consider.

#### ***HSLA***

If you’ve decided that HSL is the color method for you, then you’ll also be able to utilize the Alpha channel for transparency with the `hsla()` color value function. Like its counterpart `rgba()`, `hsla()` simply extends the color scheme with an extra argument in the function:

```
E { color: hsl(hue,saturation,lightness,alpha); }
```

So, for example, if you want an element with a `color` value of red and 50 percent opacity, you use this rule:

```
E { color: hsl(0,100%,50%,0.5); }
```

#### ***The Color Variable: currentColor***

In addition to the new color methods I’ve just described, CSS3 also introduces a new `color` value keyword: `currentColor`. This keyword acts as a variable for the current color: the value of `currentColor` for an element is the value of its own `color` property. So when an element has a `color` value of, say, `red`, the value of `currentColor` is also `red`. You can then use that to set a color value on a different property without having to specify `red` again.

The following example should clarify the usefulness of `currentColor`. First, I take the following markup:

```
<h2>The Central Intelligence Agency (<abbr>CIA</abbr>). </h2>
<h2 class="ccolor">The Federal Bureau of Investigation (<abbr>FBI</abbr>)</h2>
```

and I apply this CSS to it:

```
h2 { color: black; }
.ccolor {
    background-color: black;
    color: white;
}
h2 abbr { border-bottom: 6px double currentColor; }
```

One `h2` displays in black (`black`) text on the default (`white`) background, and the other in `white` text on a `black` background. Next, I use the `currentColor` keyword as a value for the `border-bottom` property on the `abbr` elements. You can see the result in [Figure 10-5](ch10.html#ch10fig5).

![Image](graphics/f10-05.jpg)

*Figure 10-5: A demonstration of the* `*currentColor*` *color value keyword*

Because the first `h2` has a `color` value of `black`, the color of the `border-bottom` property of the `abbr` element is also `black`. Because the second `h2` has a `color` value of `white`, the `border-bottom` property of the `abbr` element has the same color. These values have taken on the `color` property of their parent elements.

The `currentColor` keyword means I don’t have to specify the color of the border for every instance of the `abbr` element. In this example, I don’t have to use an extra rule—without it, I have to use something like this:

```
h2 abbr { border-bottom: 6px double black; }
.ccolor abbr { border-bottom-color: white; }
```

Although this may not seem like a big savings, the addition of `currentColor` means I can update the parent element color and not have to worry about setting the color on any relevant children. On a large site with many different color combinations, you can see that `currentColor` would be extremely handy.

### **Summary**

The introduction of the `opacity` property and the Alpha channel to CSS3 may seem minor, but transparency unlocks some significant changes to page designs; overlapping colors have long been a staple of print design, but this style never made serious inroads into web design because of how difficult it was to implement.

And although the HSL color model doesn’t impact how visitors experience your website, it allows you as an author to experiment with color more easily during the design process.

In the next chapter, I’ll complete the quartet of chapters on element decoration with a look at the gradient background.

### **Color and Opacity: Browser Support**

|  | **Chrome** | **Firefox** | **Safari** | **IE** |
| `opacity` | Yes | Yes | Yes | Yes |
| RGBA values | Yes | Yes | Yes | Yes |
| HSL values | Yes | Yes | Yes | Yes |
| HSLA values | Yes | Yes | Yes | Yes |
| `currentColor` value | Yes | Yes | Yes | Yes |