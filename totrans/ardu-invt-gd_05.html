<html><head></head><body>
<h2 class="h2" id="ch04"><span epub:type="pagebreak" id="page_94"/><span class="num">4</span> Reaction Timer</h2>&#13;
<p class="noindent1"><span epub:type="pagebreak" id="page_95"/><span class="red">An average human reacts to a visual <span class="underline">stimulus</span>, like a light turning on, in about 215 milliseconds. This is the time it takes for a signal you see with your eyes to travel to your brain and out to your limbs to respond. The reaction timer is a great project to demonstrate this time delay, and it also makes for a fun game! How fast are you and your friends?</span></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_96"/>In this chapter, you’ll learn how to build your own reaction timer using Arduino. The full project is shown in <a href="ch04.xhtml#ch04fig01">Figure 4-1</a>. The concept behind it is simple: the Arduino will turn on an LED, start a timer, and wait until you press a button. When you see the LED turn on, you press the button as quickly as you can, and the Arduino will report back to your computer the time between the light coming on and you pressing the button. The Arduino has a 16 MHz clock, which means that it can process 16 million instructions per second! That’s <em>fast</em>, and it makes the Arduino perfect for this project.</p>&#13;
<p class="figuret"><a id="ch04fig01"/><strong>FIGURE 4-1:</strong> The completed Reaction Timer project</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_1.jpg"/></div>&#13;
<h3 class="h3" id="ch04lev1sec1"><strong>MATERIALS TO GATHER</strong></h3>&#13;
<p class="noindent">Like the previous projects in this book, the Reaction Timer uses LEDs, resistors, wires, and an Arduino. Unlike other projects, this one also includes a button to make the game interactive, and to make it look spiffy we suggest a custom cardboard enclosure. <a href="ch04.xhtml#ch04fig02">Figures 4-2</a> and <a href="ch04.xhtml#ch04fig03">4-3</a> show the parts and materials you’ll need for this project.</p>&#13;
<h4 class="h4" id="ch04lev2sec1"><strong>Electronic Parts</strong></h4>&#13;
<p class="bull">• One SparkFun RedBoard (DEV-13975), Arduino Uno (DEV-11021), or any other Arduino-compatible board</p>&#13;
<p class="bull">• One USB Mini-B cable (CAB-11301 or your board’s USB cable)</p>&#13;
<p class="bull">• One solderless breadboard (PRT-12002)</p>&#13;
<p class="bull"><span epub:type="pagebreak" id="page_97"/>• One red LED, one blue LED, and one green LED (COM-12062)</p>&#13;
<p class="bull">• Three 330 Ω resistors (COM-08377, or COM-11507 for a pack of 20)</p>&#13;
<p class="bull">• One 10 kΩ resistor (COM-08374, or COM-11508 for a pack of 20)</p>&#13;
<p class="bull">• One push button (COM-10302)</p>&#13;
<p class="bull">• Male-to-male jumper wires (PRT-11026)</p>&#13;
<p class="bull">• Male-to-female jumper wires (PRT-09140*)</p>&#13;
<div class="noter">&#13;
<p class="notet"><strong>NOTE</strong></p>&#13;
<p class="notep"><em>The parts marked with an asterisk (*) do not come with the standard SparkFun Inventor’s Kit but are available in the separate add-on kit.</em></p>&#13;
</div>&#13;
<p class="figuret"><a id="ch04fig02"/><strong>FIGURE 4-2:</strong> Components and materials for the Reaction Timer</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_2.jpg"/></div>&#13;
<h4 class="h4" id="ch04lev2sec2"><strong>Other Materials and Tools</strong></h4>&#13;
<p class="bull">• Pencil</p>&#13;
<p class="bull">• Craft knife</p>&#13;
<p class="bull">• Metal ruler</p>&#13;
<p class="bull">• Glue (hot glue gun or craft glue)</p>&#13;
<p class="bull">• (Optional) Drill and 3/16-inch and 5/16-inch drill bits</p>&#13;
<p class="bull">• (Optional) Wire cutters (not shown)</p>&#13;
<p class="bull">• Cardboard (about 12 inches square) or a cardboard box</p>&#13;
<p class="bull">• Enclosure template (see <a href="ch04.xhtml#ch04fig16">Figure 4-16</a> on page <a href="ch04.xhtml#page_115">115</a>)</p>&#13;
<p class="bull">• (Optional) Ping-pong ball</p>&#13;
<p class="figuret"><span epub:type="pagebreak" id="page_98"/><a id="ch04fig03"/><strong>FIGURE 4-3:</strong> Recommended tools</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_3.jpg"/></div>&#13;
<h3 class="h3" id="ch04lev1sec2"><strong>NEW COMPONENT: THE PUSH BUTTON</strong></h3>&#13;
<p class="noindent">This project revolves around two components: an LED and a button. The button switch is an <em>input</em> to an Arduino pin, which means that the sketch can react to a change in the voltage on that pin. Inputs like buttons let you create circuits that people can interact with.</p>&#13;
<h4 class="h4" id="ch04lev2sec3"><strong>How Push Buttons Work</strong></h4>&#13;
<p class="noindent">There are many different kinds of push buttons, but they all work in a similar manner. A <em>push button</em> is really an electrical switch. Push buttons like the ones in <a href="ch04.xhtml#ch04fig04">Figure 4-4</a> are small, spring-loaded devices that connect two sides together electrically for as long as you apply pressure, like the keys on your keyboard. And they’re everywhere—in remote controls, garage door openers, coffee makers, radios, game controllers, and so much more!</p>&#13;
<p class="figuret"><a id="ch04fig04"/><strong>FIGURE 4-4:</strong> A variety of push buttons</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_4.jpg"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_99"/>These nifty input devices are really simple on the inside. <a href="ch04.xhtml#ch04fig05">Figure 4-5</a> shows the schematics for both a push button and a switch.</p>&#13;
<p class="figuret"><a id="ch04fig05"/><strong>FIGURE 4-5:</strong> Schematic drawings for a push button and a switch</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_5.jpg"/></div>&#13;
<p class="indent">When you flip a switch on, a piece of metal inside closes the gap between two contacts, like a gate. When you press a push button, metal pushes straight down to bridge that gap. Find a push button in your supplies for this project and examine it. Even though the schematic symbol in <a href="ch04.xhtml#ch04fig05">Figure 4-5</a> shows only two contacts, most standard push buttons for breadboards have four legs. <a href="ch04.xhtml#ch04fig06">Figure 4-6</a> shows a more accurate illustration of the contacts inside, along with how a button like that might look on the breadboard. When you plug one in, the legs should straddle the ditch in the middle of the breadboard.</p>&#13;
<p class="figuret"><a id="ch04fig06"/><strong>FIGURE 4-6:</strong> Push button schematic and button correctly placed on a breadboard with legs straddling the ditch</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_6.jpg"/></div>&#13;
<p class="indent">Push buttons are fantastic inputs in projects, because everyone knows how they work. Push buttons are also pretty simple to connect in a circuit with an Arduino. Let’s look at how that works.</p>&#13;
<h4 class="h4" id="ch04lev2sec4"><strong>Using Resistors with Push Buttons</strong></h4>&#13;
<p class="noindent">To use any button as an input to an Arduino, you’ll need to use a <em>pull-up resistor circuit</em> like the one in <a href="ch04.xhtml#ch04fig07">Figure 4-7</a>. A pull-up resistor connects to a power source on one side and to an input component (like a button) on the other. The part of a circuit that needs to detect input is connected at the intersection of the resistor and the button.</p>&#13;
<p class="indent">In the configuration shown in <a href="ch04.xhtml#ch04fig07">Figure 4-7</a>, the resistor to 5 V <em>pulls</em> the Arduino pin’s default voltage <em>up</em> to 5 V, which is considered <span class="literal">HIGH</span>. When the button is pushed, a path is created between the Arduino pin and ground, and the Arduino pin reads a <span class="literal">LOW</span> voltage. This works because current always flows along the path of least <span epub:type="pagebreak" id="page_100"/>resistance: when the button isn’t pressed, the Arduino pin 10 kΩ resistor is the only path the current can access, but when the button <em>is</em> pressed, it offers a path with effectively zero resistance.</p>&#13;
<p class="figuret"><a id="ch04fig07"/><strong>FIGURE 4-7:</strong> Pull-up resistor and push button circuit</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_7.jpg"/></div>&#13;
<h3 class="h3" id="ch04lev1sec3"><strong>BUILD THE REACTION TIMER PROTOTYPE</strong></h3>&#13;
<p class="noindent">The Reaction Timer combines an LED circuit similar to the ones in previous projects with the button circuit from <a href="ch04.xhtml#ch04fig07">Figure 4-7</a> to make the supercircuit in <a href="ch04.xhtml#ch04fig08">Figure 4-8</a>, which lights an LED and detects button presses.</p>&#13;
<p class="figuret"><a id="ch04fig08"/><strong>FIGURE 4-8:</strong> Schematic diagram for the Reaction Timer prototype</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_8.jpg"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_101"/> Take out your breadboard and wire up a single LED and a button, as shown in <a href="ch04.xhtml#ch04fig09">Figures 4-9</a> and <a href="ch04.xhtml#ch04fig10">4-10</a>. You’ll use this prototype to test your code before building the final Reaction Timer.</p>&#13;
<p class="figuret"><a id="ch04fig09"/><strong>FIGURE 4-9:</strong> Wiring diagram for the Reaction Timer circuit</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_9.jpg"/></div>&#13;
<p class="figuret"><a id="ch04fig10"/><strong>FIGURE 4-10:</strong> Final prototype circuit of the Reaction Timer with a single button and a single LED</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_10.jpg"/></div>&#13;
<p class="indent">As you connect this circuit, note the two different resistance values: 330 Ω for the LED and 10 kΩ for the push button. (See “<a href="app01.xhtml#app01lev1sec4">Resistors and Bands</a>” on page <a href="app01.xhtml#page_308">308</a> for details on how to determine the value of a resistor from its color bands.) The resistor on the LED <span epub:type="pagebreak" id="page_102"/>is a current-limiting resistor and should be tied to ground, while the resistor on the push button is a pull-up resistor connecting pin 3 to 5 V. But your circuit can’t do anything without the code, so let’s look at that now.</p>&#13;
<h3 class="h3" id="ch04lev1sec4"><strong>PROGRAM THE REACTION TIMER</strong></h3>&#13;
<p class="noindent">As your sketches and circuits become more complex, you’ll find it helpful to organize your thoughts by listing each action you want the Arduino to take, in the order you want it to happen. Some programmers refer to a list like this as <em>pseudocode</em>. Here’s our pseudocode for the Reaction Timer:</p>&#13;
<p class="olist">1. Wait a random amount of time before turning on the LED (to prevent predicting/gaming the Reaction Timer).</p>&#13;
<p class="olist">2. Turn on the LED.</p>&#13;
<p class="olist">3. Record the starting time.</p>&#13;
<p class="olist">4. Start a timer and wait for a button press.</p>&#13;
<p class="olist">5. When the button is pressed, calculate the reaction time as the timer value minus the starting time.</p>&#13;
<p class="olist">6. Report the time back.</p>&#13;
<p class="indent">Pretty simple, right? Let’s open up Arduino and look at the sketch.</p>&#13;
<h4 class="h4" id="ch04lev2sec5"><strong>Write the setup() Function</strong></h4>&#13;
<p class="noindent">Open a new sketch and type the initialization and the <span class="literal">setup()</span> code shown in <a href="ch04.xhtml#ch04ex01">Listing 4-1</a>.</p>&#13;
<p class="ex-caption"><a id="ch04ex01"/><strong>LISTING 4-1:</strong> <span class="literal">setup()</span> and initialization code for the Reaction Timer</p>&#13;
<div class="pre">&#13;
<p class="programs"><span class="ent">➊</span> <span class="green">unsigned int</span> waitTime;   <span class="ash">//random wait time before</span><br/>                           <span class="ash">//turning on LED</span><br/>  <span class="green">unsigned int</span> startTime;  <span class="ash">//zero reference time</span><br/>  <span class="green">unsigned int</span> reactTime;  <span class="ash">//calculated reaction time</span><br/><br/>  <span class="green">void</span> <span class="green1">setup</span>()<br/>  {<br/><span class="ent">➋</span>   <span class="orange"><strong>Serial</strong></span>.<span class="orange">begin</span>(9600);   <span class="ash">//sets up serial</span><br/>                           <span class="ash">//communication</span><br/>    <span class="orange">pinMode</span>(13, OUTPUT);   <span class="ash">//sets pin 13 as an OUTPUT for the</span><br/>                           <span class="ash">//stimulus LED</span><br/><span class="ent">➌</span>   <span class="orange">pinMode</span>(3, INPUT);     <span class="ash">//sets pin 3 as an INPUT for the</span><br/>                           <span class="ash">//button</span><br/>  }</p>&#13;
</div>&#13;
<div class="noter">&#13;
<p class="notet"><strong>NOTE</strong></p>&#13;
<p class="notep"><em>The</em> <em><span class="literal">unsigned int</span></em> <em>data type can hold values from 0 to 65,535 (2<sup>16</sup> – 1).</em></p>&#13;
</div>&#13;
<p class="indent">First, the namespace defines three <span class="literal">unsigned int</span> variables <span class="ent">➊</span> to store the <span class="literal">waitTime</span>, <span class="literal">startTime</span>, and <span class="literal">reactTime</span> values.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_103"/>Next comes the <span class="literal">setup()</span> function, which has a new instruction: <span class="literal">Serial.begin(9600)</span> <span class="ent">➋</span>. Make sure to capitalize <span class="literal">Serial</span> and leave no spaces between <span class="literal">Serial</span>, the period, and <span class="literal">begin</span>. This instruction is a little different from previous commands because it has a period that divides the <em>object</em> and the <em>method</em>. An <em>object</em> is a concept used in computer programming that is similar to a special type of variable that can have different functions or actions. Here <span class="literal">Serial</span> is the name of the object we’re using. The functions that an object can perform are called <em>methods</em>. The <span class="literal">begin()</span> method initializes or begins <em>serial communication</em> between your Arduino and your computer, which allows the Arduino to send and receive data through the USB cable. For this command, the number in the parentheses, <span class="literal">9600</span>, sets the communication rate to 9,600 bits per second (or <em>baud</em>). The Arduino will use serial communication to report your reaction time back to your computer. The <span class="literal">Serial</span> object has many other methods, which we’ll introduce throughout this book, to handle data between the computer and the Arduino.</p>&#13;
<p class="indent">Finally, you’ll set up your pins. This project uses a single LED on pin 13 to indicate when to press the button, so you once again use pin 13 as an <span class="literal">OUTPUT</span> using the <span class="literal">pinMode()</span> function. Then set pin 3 with the <span class="literal">pinMode()</span> function <span class="ent">➌</span> using the <span class="literal">INPUT</span> keyword. You use <span class="literal">INPUT</span> here because Arduino needs to be able to detect button presses, not output to the button.</p>&#13;
<h4 class="h4" id="ch04lev2sec6"><strong>Write the loop() Function</strong></h4>&#13;
<p class="noindent">Now let’s write the <span class="literal">loop()</span> part of the sketch. Enter the code in <a href="ch04.xhtml#ch04ex02">Listing 4-2</a> after your <span class="literal">setup()</span> function.</p>&#13;
<p class="ex-caption"><a id="ch04ex02"/><strong>LISTING 4-2:</strong> The <span class="literal">loop()</span> function for the Reaction Timer</p>&#13;
<div class="pre">&#13;
<p class="programs">  <span class="green">void</span> <span class="green1">loop</span>()<br/>  {<br/>  <span class="ash">//prints the challenge instructions</span><br/><span class="ent">➊</span>   <span class="orange"><strong>Serial</strong></span>.<span class="orange">println</span>(<span class="blue1">"When the LED turns on, push the button!"</span>);<br/>    <span class="orange"><strong>Serial</strong></span>.<span class="orange">println</span>(<span class="blue1">"Now, watch the LED. Ready?"</span>);<br/><span class="ent">➋</span>   waitTime = <span class="orange">random</span>(2000, 4000); <span class="ash">//random wait time</span><br/>                                   <span class="ash">//from 2000 to 4000 ms</span><br/><span class="ent">➌</span>   <span class="orange">delay</span>(waitTime);               <span class="ash">//delay random wait time</span><br/><br/>    <span class="ash">//turn on the LED!</span><br/>    <span class="orange">digitalWrite</span>(13, <span class="green">HIGH</span>);<br/><br/>    startTime = <span class="ent">➍</span><span class="orange">millis</span>(); <span class="ash">//set zero time reference</span><br/><span epub:type="pagebreak" id="page_104"/>    <span class="ash">//loop to wait until button is pressed</span><br/><span class="ent">➎</span>   <span class="green1">while</span>(<span class="orange">digitalRead</span>(3) == <span class="green">HIGH</span>)<br/>    {<br/>    }<br/><br/><span class="ent">➏</span>   reactTime = <span class="orange">millis</span>() - startTime; <span class="ash">//calculation of</span><br/>                                      <span class="ash">//reaction time</span><br/>    <span class="orange">digitalWrite</span>(13, <span class="green">LOW</span>);            <span class="ash">//turn off LED!</span><br/><br/>    <span class="ash">//display information to Serial Monitor</span><br/><span class="ent">➐</span>   <span class="orange"><strong>Serial</strong></span>.<span class="orange">print</span>(<span class="blue1">"Nice job! Your reaction time was "</span>);<br/><span class="ent">➑</span>   <span class="orange"><strong>Serial</strong></span>.<span class="orange">print</span>(reactTime);<br/><span class="ent">➒</span>   <span class="orange"><strong>Serial</strong></span>.<span class="orange">println</span>(<span class="blue1">" milliseconds"</span>);<br/>    <span class="orange">delay</span>(1000);  <span class="ash">//short delay before starting again</span><br/>  }</p>&#13;
</div>&#13;
<p class="indent">First, this code uses the <span class="literal">Serial.println()</span> method <span class="ent">➊</span> to show a message prompt explaining how to play the game. The <span class="literal">println()</span> method sends text to the computer and adds a newline character to move the cursor down one line. When this method is called, any text between quotation marks (<span class="literal">" "</span>) is displayed on the Arduino IDE’s Serial Monitor. The Serial Monitor is like a simple chat window, or <em>terminal</em>, that allows you to send and receive data between the Arduino and your computer. You can open the Serial Monitor by clicking the magnifying glass button in the top-right corner of the Arduino IDE (shown in <a href="ch04.xhtml#ch04fig11">Figure 4-11</a>), by clicking Tools <span class="ent">▸</span> Serial Monitor, or by using the hotkey <small>CTRL</small>-<small>SHIFT</small>-M.</p>&#13;
<p class="figuret"><a id="ch04fig11"/><strong>FIGURE 4-11:</strong> Opening the Serial Monitor through the Arduino IDE</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_11.jpg"/></div>&#13;
<p class="indent">We’ll look at the Serial Monitor in just a moment.</p>&#13;
<h5 class="h5" id="ch04lev3sec1"><strong>Generate the Delay Time</strong></h5>&#13;
<p class="noindent">To make the Reaction Timer less predictable, the sketch calls the <span class="literal">random()</span> function <span class="ent">➋</span> to generate a random <span class="literal">waitTime</span>. The <span class="literal">random()</span> function takes a minimum value and a maximum value as arguments and returns a <em>pseudorandom number</em> (a number that appears to be random but isn’t; this is explained in more detail in “<a href="ch04.xhtml#ch04sb01">Try It Out: Make <span class="literal">waitTime</span> More Random</a>” on page <a href="ch04.xhtml#page_109">109</a>). In this example, the <span class="literal">waitTime</span> variable is set to a “random” number between 2,000 and 4,000 and is passed to <span class="literal">delay()</span> <span class="ent">➌</span> before the LED turns on. This prevents you and your friends from predicting when to press the button.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_105"/>When the LED turns on, a call to the <span class="literal">millis()</span> function <span class="ent">➍</span> captures the starting time. The <span class="literal">millis()</span> function checks the Arduino’s internal timer and returns the number of milliseconds since the Arduino was turned on or reset. The <span class="literal">millis()</span> function is handy for any Arduino project that involves timing.</p>&#13;
<h5 class="h5" id="ch04lev3sec2"><strong>Check the Button with a while() Loop</strong></h5>&#13;
<p class="noindent">After fetching the start time, the sketch uses a <span class="literal">while()</span> loop <span class="ent">➎</span> to wait for a button press. In Arduino, as in many other programming languages, a <span class="literal">while()</span> loop runs the code inside its curly brackets as long as the expression between its parentheses is <span class="literal">true</span>. In this case, the expression is</p>&#13;
<div class="pre">&#13;
<p class="programs"><span class="orange">digitalRead</span>(3) == <span class="green">HIGH</span></p>&#13;
</div>&#13;
<p class="indent">The <span class="literal">digitalRead()</span> command reads the voltage on the pin specified between the parentheses and returns a value of <span class="literal">HIGH</span> or <span class="literal">LOW</span> depending on if it sees 5 V or GND. This call checks the voltage on pin 3. Remember that pull-up resistor on the push button? The button’s normal state is open, and the pin defaults to <span class="literal">HIGH</span> until you press the button to close the circuit. When you press the button, pin 3 connects to ground, and the state becomes <span class="literal">LOW</span>. The double equal sign (<span class="literal">==</span>) checks equality. (See “<a href="ch04.xhtml#ch04sb02">Logical Comparison Operators</a>” on page <a href="ch04.xhtml#page_106">106</a>.)</p>&#13;
<p class="indent">As long as the button isn’t pressed, the expression is <span class="literal">true</span>, and the <span class="literal">while()</span> loop should repeat, preventing the sketch from executing any code after. Notice, however, that there’s no actual code inside the loop. This is referred to as a <em>holding</em> or <em>blocking loop</em>, and rather than executing any code itself, it just prevents other code from executing. When the button is pressed, the expression becomes <span class="literal">false</span>, and the sketch proceeds.</p>&#13;
<h5 class="h5" id="ch04lev3sec3"><strong>Calculate and Display the Reaction Time</strong></h5>&#13;
<p class="noindent">Next, the sketch computes the reaction time <span class="ent">➏</span> by subtracting the <span class="literal">startTime</span> from the current timer value, which is fetched with the <span class="literal">millis()</span> command.</p>&#13;
<p class="indent">As a final step, the LEDs are turned off, and the <span class="literal">reactTime</span> value is printed to the serial communication line. To make the information more readable, the sketch prints the string <span class="literal">"Nice job! Your reaction time was "</span> to the Serial Monitor using the <span class="literal">print()</span> method <span class="ent">➐</span> of the <span class="literal">Serial</span> object. This method sends the text between the quotation marks and doesn’t move the cursor to a new line. In fact, it keeps the cursor on the same line so that you can append more information, like the actual reaction time, which is added at <span class="ent">➑</span> with <span class="literal">Serial.print(reactTime);</span>. The sentence is finished with a call to the <span class="literal">println()</span> method <span class="ent">➒</span>, which prints the string <span class="literal">" milliseconds"</span> and then moves the cursor to a new line.</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch04sb02"><span epub:type="pagebreak" id="page_106"/><strong>LOGICAL COMPARISON OPERATORS</strong></p>&#13;
<p class="noindent"><em>Logical comparison operators</em> perform operations that test one value against another value. For example, the double equal sign (<span class="literal">==</span>) compares two values to see whether they are equal. A logical operation can return only one of two values: <span class="literal">true</span>, meaning the comparison evaluates correctly, or <span class="literal">false</span>, meaning it doesn’t evaluate correctly. In Arduino, there are many ways to compare two values, and all of the operators are listed in the following table:</p>&#13;
<table class="all">&#13;
<tr>&#13;
<td class="tablecr"><p class="center"><strong>OPERATOR</strong></p></td>&#13;
<td class="tablec"><p class="center"><strong>COMPARISON</strong></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="tablecr"><p class="center"><span class="red1"><span class="literal">==</span></span></p></td>&#13;
<td class="tablec"><p class="center"><span class="red1">Equal to</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="tablecr"><p class="center"><span class="red1"><span class="literal">!=</span></span></p></td>&#13;
<td class="tablec"><p class="center"><span class="red1">Not equal to</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="tablecr"><p class="center"><span class="red1"><span class="literal">&gt;</span></span></p></td>&#13;
<td class="tablec"><p class="center"><span class="red1">Greater than</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="tablecr"><p class="center"><span class="red1"><span class="literal">&gt;=</span></span></p></td>&#13;
<td class="tablec"><p class="center"><span class="red1">Greater than or equal to</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="tablecr"><p class="center"><span class="red1"><span class="literal">&lt;</span></span></p></td>&#13;
<td class="tablec"><p class="center"><span class="red1">Less than</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="tablecr1"><p class="center"><span class="red1"><span class="literal">&lt;=</span></span></p></td>&#13;
<td class="tablec1"><p class="center"><span class="red1">Less than or equal to</span></p></td>&#13;
</tr>&#13;
</table>&#13;
<p class="indent">For example, if you enter <span class="literal">2 == 4</span> in the Arduino IDE, it will return <span class="literal">false</span>, because two is not equal to four. However, if you enter <span class="literal">2 &lt;= 4</span> in the Arduino IDE, it will return <span class="literal">true</span>, because two is less than or equal to four. In sketches, comparison operators are often used with <span class="literal">if()</span> or <span class="literal">while()</span> statements to run a certain block of code based on a certain condition. For example, the <span class="literal">while()</span> loop in <a href="ch04.xhtml#ch04ex02">Listing 4-2</a> says, “while <span class="literal">digitalRead(3) == HIGH</span> is <span class="literal">true</span>, repeat the holding loop; otherwise, skip to the next bit of code.”</p>&#13;
<p class="indent">A common bug is to mistakenly use a single equal sign when working with comparisons. Remember: a single equal sign sets a variable, whereas the double equal sign compares the two values.</p>&#13;
<p class="indent">You’ll use comparison operators more and more as you start to evaluate data your Arduino gathers from various sensors and inputs, and we’ll use some of them later in this chapter, too.</p>&#13;
</div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_107"/>Notice that every character must be explicitly printed, including any spaces you want between numbers or characters. You can use the <span class="literal">print()</span> and <span class="literal">println()</span> methods, as in this example, to combine, format, or organize text that you display in the Serial Monitor.</p>&#13;
<p class="indent">The final line of code in the <span class="literal">loop()</span> function is a short <span class="literal">delay()</span> function to pause the sketch before it loops back and starts the Reaction Timer again.</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart"><strong>SPECIAL COMMAND CHARACTERS</strong></p>&#13;
<p class="noindent">When printing data or text, you must represent every individual character, including spaces, and every formatting command in your code. There’s a set of reserved characters, called <em>escape sequences</em>, to indicate special formatting. For example, <span class="literal">\n</span> moves the cursor to a new line; so, <span class="literal">Serial.print("Hello Arduino!\n");</span> is equivalent to <span class="literal">Serial.println("Hello Arduino!");</span>.</p>&#13;
<p class="indent">You can use escape sequences in your <span class="literal">print</span> statements to add formatting or other special characters to your text. The following table lists a handful of useful escape sequences.</p>&#13;
<table class="all">&#13;
<tr>&#13;
<td class="tablecr"><p class="center"><strong>ESCAPE SEQUENCE</strong></p></td>&#13;
<td class="tablec"><p class="center"><strong>RESULT</strong></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="tablecr"><p class="center"><span class="red1"><span class="literal">\t</span></span></p></td>&#13;
<td class="tablec"><p class="center"><span class="red1">Tab</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="tablecr"><p class="center"><span class="red1"><span class="literal">\n</span></span></p></td>&#13;
<td class="tablec"><p class="center"><span class="red1">New line</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="tablecr"><p class="center"><span class="red1"><span class="literal">\'</span></span></p></td>&#13;
<td class="tablec"><p class="center"><span class="red1">Single quotation mark</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="tablecr"><p class="center"><span class="red1"><span class="literal">\"</span></span></p></td>&#13;
<td class="tablec"><p class="center"><span class="red1">Double quotation mark</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td class="tablecr"><p class="center"><span class="red1"><span class="literal">\x<em>hh</em></span></span></p></td>&#13;
<td class="tablec"><p class="center"><span class="red1">ASCII character, where <span class="literal"><em>hh</em></span> is a hexadecimal number</span></p></td>&#13;
</tr>&#13;
</table>&#13;
</div>&#13;
<h4 class="h4" id="ch04lev2sec7"><span epub:type="pagebreak" id="page_108"/><strong>Test the Reaction Timer Sketch</strong></h4>&#13;
<p class="noindent">That’s all the code you need to test your Reaction Timer game circuit! Save your sketch, compile it, and upload it to your Arduino now. To see the data that your sketch sends on the serial communication line, open the Serial Monitor window by clicking <strong>Tools <span class="ent">▸</span> Serial Monitor</strong> or the magnifying glass button in the upper-right corner of the IDE.</p>&#13;
<p class="indent">Notice that the bottom-right corner of the Serial Monitor has a pull-down menu to control the serial data rate in <em>baud</em> (bits per second), which defaults to 9,600 baud (see <a href="ch04.xhtml#ch04fig12">Figure 4-12</a>). This is the same value this sketch uses to initialize the <span class="literal">Serial</span> object, using the <span class="literal">Serial.begin(9600)</span> instruction. Always check that the Serial Monitor speed is the same as the rate set in the sketch with <span class="literal">Serial.begin()</span>—otherwise, you may just get gibberish!</p>&#13;
<p class="figuret"><a id="ch04fig12"/><strong>FIGURE 4-12:</strong> The Arduino IDE’s Serial Monitor window testing the Reaction Timer</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_12.jpg"/></div>&#13;
<div class="noter">&#13;
<p class="notet"><strong>NOTE</strong></p>&#13;
<p class="notep"><em>Some components, such as GPS or a serial-enabled LCD screen, will communicate with the Arduino at different baud rates, so when using a new part, it’s a good idea to check what rate it uses and set that in the sketch.</em></p>&#13;
</div>&#13;
<p class="indent">You can set the serial data rate to any standard rate from 300 to 250,000 baud, but 9,600 baud is the most common speed. Generally speaking, slower speeds are more reliable and use less power and fewer resources on the Arduino, but they also introduce a delay that slows down the <span class="literal">loop()</span>. If you need a really fast response and don’t care much about power usage, you can use a faster baud rate.</p>&#13;
<p class="indent">Now, let’s play! Run the sketch and watch your LED closely. When it lights up, push the button. Your code will print your reaction time, in milliseconds, to the Serial Monitor, like in <a href="ch04.xhtml#ch04fig12">Figure 4-12</a>. How fast are you? Go challenge one of your friends! The average is about 215 ms. How do <em>you</em> measure up?</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch04sb01"><span epub:type="pagebreak" id="page_109"/><strong>TRY IT OUT: MAKE WAITTIME MORE RANDOM</strong></p>&#13;
<p class="noindent">In most digital devices like an Arduino, it’s hard to get a <em>truly</em> random number because the random number is generated through a mathematical calculation. On an Arduino, each time the <span class="literal">random()</span> function is called, the function bases its calculation on the previous result from <span class="literal">random()</span>. Because the next “random” number is calculated from the previous result, the sequence of numbers will always be the same.</p>&#13;
<p class="indent">For example, on our Arduino (and probably yours), the first call to <span class="literal">random(2000, 4000)</span> will always set <span class="literal">waitTime</span> to <span class="literal">2807</span>. The second number generated will always be <span class="literal">3249</span>, the third will be <span class="literal">2073</span>, and so on.</p>&#13;
<p class="indent">You can make the <span class="literal">waitTime</span> value appear more random by calling the function <span class="literal">randomSeed()</span> in your <span class="literal">setup()</span> function. This generates a <em>seed</em> value that tells <span class="literal">random()</span> where the pseudorandom sequence should start. When your Arduino starts running a sketch, the seed defaults to <span class="literal">1</span>, which is why <span class="literal">2807</span> is always the first number generated by the <span class="literal">random(2000, 4000)</span> call.</p>&#13;
<p class="indent">To make your Reaction Timer behave more randomly, add this line of code to your <span class="literal">setup()</span> routine, just before the closing curly bracket:</p>&#13;
<div class="pre">&#13;
<p class="programs"><span class="orange">randomSeed</span>(<span class="orange">analogRead</span>(A5));</p>&#13;
</div>&#13;
<p class="indent">This seeds the random-number generator with the current voltage value on the Arduino’s analog pin A5. We’ll cover <span class="literal">analogRead()</span> in more detail in Chapter 5, but for now, just know that it reads the voltage level on the analog pin passed to it. Because pin A5 isn’t connected to anything in the Reaction Timer, the voltage <em>floats</em>, or bounces around somewhat unpredictably.</p>&#13;
<p class="indent">If you choose to add this line of code, then each time you run your sketch, the first call to <span class="literal">random(2000, 4000)</span> should return a different number. To confirm, add these two lines of code after the <span class="literal">delay(waitTime)</span> call in your sketch:</p>&#13;
<div class="pre">&#13;
<p class="programs"><span class="orange"><strong>Serial</strong></span>.<span class="orange">print</span>(<span class="blue1">"waitTime = "</span>);<br/><span class="orange"><strong>Serial</strong></span>.<span class="orange">println</span>(waitTime);</p>&#13;
</div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_110"/>Now, comment out the <span class="literal">randomSeed()</span> call by adding <span class="literal">//</span> at the beginning of the line, run your sketch a few times, and note the initial <span class="literal">waitTime</span> values printed. Uncomment the <span class="literal">randomSeed()</span> call and repeat the process. Over time and a lot of data points, there will still be a pattern, but that’s a topic for another book—or perhaps for a degree in computer science!</p>&#13;
</div>&#13;
<h4 class="h4" id="ch04lev2sec8"><strong>Play Again?</strong></h4>&#13;
<p class="noindent">To play again, simply press the Arduino’s reset button—the brass-colored button near the corner of the board, shown in <a href="ch04.xhtml#ch04fig13">Figure 4-13</a>. This will restart your code and let you play again. Watch the LED closely. Are you any faster?</p>&#13;
<p class="figuret"><a id="ch04fig13"/><strong>FIGURE 4-13:</strong> Press the reset button to play again.</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_13.jpg"/></div>&#13;
<h4 class="h4" id="ch04lev2sec9"><strong>Add a Game Element</strong></h4>&#13;
<p class="noindent">To add a little carnival-game style to this project, you can add a visual speed indicator to show if you’re faster than a given reaction time. We suggest starting with the average, 215 ms, as the time to beat. To do this, you’ll need to add two more LEDs: a green one to indicate that you were faster than the time set in the code and a red one to say you were slower. Since you already used pin 13 for the stimulus LED, you’ll connect these two LEDs to pins 11 and 12. Add these to your breadboard as shown in <a href="ch04.xhtml#ch04fig14">Figures 4-14</a> and <a href="ch04.xhtml#ch04fig15">4-15</a>.</p>&#13;
<p class="figuret"><span epub:type="pagebreak" id="page_111"/><a id="ch04fig14"/><strong>FIGURE 4-14:</strong> Circuit diagram with two extra LEDs</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_14.jpg"/></div>&#13;
<p class="figuret"><a id="ch04fig15"/><strong>FIGURE 4-15:</strong> Completed wiring of the new circuit with two extra LEDs</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_15.jpg"/></div>&#13;
<h5 class="h5" id="ch04lev3sec4"><strong>Update the Code for Extra LEDs</strong></h5>&#13;
<p class="noindent">Now that you have these two indicator LEDs, you’ll add a few extra lines of code to your project to turn on the green LED if you’re faster than the time to beat and the red LED if you’re not.</p>&#13;
<p class="indent">You’ll need to add a <span class="literal">pinMode()</span> command for pins 12 and 11 and set these up as <span class="literal">OUTPUT</span>s to control your new LEDs. The changes to the <span class="literal">setup()</span> function are shown in <a href="ch04.xhtml#ch04ex03">Listing 4-3</a> (the existing code is shown in light gray).</p>&#13;
<p class="ex-caption"><span epub:type="pagebreak" id="page_112"/><a id="ch04ex03"/><strong>LISTING 4-3:</strong> The modified <span class="literal">setup()</span> function for the Reaction Timer with the extra speed-indicator LEDs</p>&#13;
<div class="pre">&#13;
<p class="programs"><span class="ash1">void setup()</span><br/><span class="ash1">{</span><br/>  <span class="ash1">Serial.begin(9600);   //sets up serial</span><br/>                        <span class="ash1">//communication</span><br/>  <span class="ash1">pinMode(13, OUTPUT);  //sets pin 13 as an OUTPUT for the</span><br/>                        <span class="ash1">//stimulus LED</span><br/>  <span class="orange">pinMode</span>(12, OUTPUT);  <span class="ash">//sets pin 12 as an OUTPUT for the</span><br/>                        <span class="ash">//green LED</span><br/>  <span class="orange">pinMode</span>(11, OUTPUT);  <span class="ash">//sets pin 11 as an OUTPUT for the</span><br/>                        <span class="ash">//red LED</span><br/>  <span class="ash1">pinMode(3, INPUT);    //sets pin 3 as an INPUT for the</span><br/>                        <span class="ash1">//button</span><br/><span class="ash1">}</span></p>&#13;
</div>&#13;
<p class="indent">You simply inserted two extra <span class="literal">pinMode()</span> instructions for the two extra LEDs that you’re going to add.</p>&#13;
<h5 class="h5" id="ch04lev3sec5"><strong>Control the Flow with if() and else()</strong></h5>&#13;
<p class="noindent">Now you’ll need to add a little bit of decision logic into your sketch. In Arduino programming, an <span class="literal">if()</span> statement allows you to control the direction and flow of a sketch. It tells the code “if this is true, run the code in the following curly brackets.” The general syntax for the <span class="literal">if()</span> statement is shown in <a href="ch04.xhtml#ch04ex04">Listing 4-4</a>.</p>&#13;
<p class="ex-caption"><a id="ch04ex04"/><strong>LISTING 4-4:</strong> Generic <span class="literal">if()</span> statement in Arduino</p>&#13;
<div class="pre">&#13;
<p class="programs">  <span class="green1">if</span>(<span class="ent">➊</span><em>expression</em>)  <span class="ash">//if <em>expression</em> is true, run the code in</span><br/>                   <span class="ash">//the following loop</span><br/>    {<br/>    <span class="ent">➋</span><br/>    }<br/><span class="ent">➌</span> <span class="green1">else</span> <span class="ash">//otherwise, run the code in this loop instead</span><br/>    {<br/>    <span class="ent">➍</span><br/>    }</p>&#13;
</div>&#13;
<p class="indent">The <em><span class="literal">expression</span></em> <span class="ent">➊</span> is a Boolean expression that is either <span class="literal">true</span> or <span class="literal">false</span>, like the ones we discussed earlier in “<a href="ch04.xhtml#ch04sb02">Logical Comparison Operators</a>” on page <a href="ch04.xhtml#page_106">106</a>. If the expression is <span class="literal">true</span>, the sketch will start executing any code between the curly brackets <span class="ent">➋</span>. If it’s not <span class="literal">true</span>, the sketch skips over the curly brackets and goes to the next statement. Oftentimes, the <span class="literal">if()</span> statement is paired with an <span class="literal">else</span> <span class="ent">➌</span>. If the expression is not <span class="literal">true</span>, the sketch skips over the first set of curly brackets <span class="ent">➋</span> and continues on to the code that is part of the <span class="literal">else</span> statement <span class="ent">➍</span>.</p>&#13;
<p class="indent">For the Reaction Timer game, you’ll use an <span class="literal">if()</span> statement to turn on the green LED if the reaction time is less than or equal to <span epub:type="pagebreak" id="page_113"/>215 ms and the red LED if the reaction time is greater than 215 ms. You’ll be able to change this value to make it harder or easier, but this is a good middling value for now. <a href="ch04.xhtml#ch04ex05">Listing 4-5</a> shows the code to do this.</p>&#13;
<p class="ex-caption"><a id="ch04ex05"/><strong>LISTING 4-5:</strong> Code snippet of the <span class="literal">if()</span> statement for the Reaction Timer game</p>&#13;
<div class="pre">&#13;
<p class="programs"><span class="ent">➊</span> <span class="green1">if</span> (<span class="ent">➋</span>reactTime &lt;= 215)<br/>  {<br/><span class="ent">➌</span>   <span class="orange">digitalWrite</span>(12, <span class="green">HIGH</span>);  <span class="ash">//green LED ON</span><br/><span class="ent">➍</span>   <span class="orange">digitalWrite</span>(11, <span class="green">LOW</span>);   <span class="ash">//red LED OFF</span><br/>  }<br/><span class="ent">➎</span> <span class="green1">else</span><br/>  {<br/>    <span class="orange">digitalWrite</span>(12, <span class="green">LOW</span>);   <span class="ash">//green LED OFF</span><br/>    <span class="orange">digitalWrite</span>(11, <span class="green">HIGH</span>);  <span class="ash">//red LED ON</span><br/>  }</p>&#13;
</div>&#13;
<p class="indent">You can see at <span class="ent">➊</span> that the sketch uses the <span class="literal">if()</span> statement to perform this logic. The Boolean expression, <span class="literal">reactTime &lt;= 215</span> <span class="ent">➋</span>, checks whether the value from <span class="literal">reactTime</span> is less than or equal to <span class="literal">215</span>, and if it is, the green LED turns on <span class="ent">➌</span>. When the green LED turns on, the red LED needs to be off, so you add one extra instruction <span class="ent">➍</span> to do that. Finally, you add the <span class="literal">else</span> statement <span class="ent">➎</span> to turn the red LED on if the <span class="literal">if()</span> statement evaluates to <span class="literal">false</span>.</p>&#13;
<h4 class="h4" id="ch04lev2sec10"><strong>Upload the Complete Code for the Reaction Timer</strong></h4>&#13;
<p class="noindent">The new <span class="literal">if()</span> statement should be placed within the <span class="literal">loop()</span>, after the code to turn off the red LED, as shown in <a href="ch04.xhtml#ch04ex06">Listing 4-6</a>. (The <em><span class="literal">snip</span></em> indicates where existing code has been omitted on the page for length.)</p>&#13;
<p class="ex-caption"><a id="ch04ex06"/><strong>LISTING 4-6:</strong> Adding the <span class="literal">if()</span> statement for the green and red LED game indicators</p>&#13;
<div class="pre">&#13;
<p class="programs"><span class="ash1">--<em>snip</em>--</span><br/><br/>  <span class="ash1">//loop to wait until button is pressed</span><br/>  <span class="ash1">while(digitalRead(3) == HIGH)</span><br/>  <span class="ash1">{</span><br/>  <span class="ash1">}</span><br/><br/>  <span class="ash1">reactTime = millis() - startTime;  //calculation of reaction</span><br/>                                     <span class="ash1">//time</span><br/><br/>  <span class="ash1">digitalWrite(13, LOW);             //turn off LED!</span><br/><br/>  <span class="green1">if</span> (reactTime &lt;= 215)<br/>  {<br/>    <span class="orange">digitalWrite</span>(12, <span class="green">HIGH</span>);  <span class="ash">//green LED ON</span><br/>    <span class="orange">digitalWrite</span>(11, <span class="green">LOW</span>);   <span class="ash">//red LED OFF</span><br/>  }<br/><span epub:type="pagebreak" id="page_114"/>  <span class="green1">else</span><br/>  {<br/>    <span class="orange">digitalWrite</span>(12, <span class="green">LOW</span>);   <span class="ash">//green LED OFF</span><br/>    <span class="orange">digitalWrite</span>(11, <span class="green">HIGH</span>);  <span class="ash">//red LED ON</span><br/>  }<br/><br/><span class="ash1">//display information to Serial Monitor</span><br/><span class="ash1">--<em>snip</em>--</span></p>&#13;
</div>&#13;
<p class="indent">After you’ve added the new code, upload the whole sketch to your Arduino. Open the Serial Monitor and play a game to make sure it all works as expected. Can you get the green light to turn on? You have to be fast!</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart"><strong>GAMING THE GAME: CONTROL THE DIFFICULTY</strong></p>&#13;
<p class="noindent">As with all games, with the Reaction Timer, sometimes you’ll need to adjust the difficulty level. Since you’re the programmer, you get to control the game. If 215 ms is too fast or too slow, you can adjust your game <em>threshold</em> by changing the number in the line <span class="literal">if (reactTime &lt;= 215)</span>.</p>&#13;
<p class="indent">Want to make it impossible to beat? Change this value to a low number like 100 ms. Want to be nice and make it easier? Change it to a number like 500 ms. You’re writing the code, so you get to decide the rules of the game!</p>&#13;
</div>&#13;
<h3 class="h3" id="ch04lev1sec5"><strong>BUILD THE REACTION TIMER ENCLOSURE</strong></h3>&#13;
<p class="noindent">When your prototype works, it’s time to build a more permanent enclosure. To keep this project as simple as possible, our version of the Reaction Timer is designed to fit into a small SparkFun box. The top of the box measures 3 7/8 inches × 5 inches, but you can put your game in anything you have lying around the house—an old cereal box, oatmeal container, or anything else made of a sturdy cardboard.</p>&#13;
<p class="indent">We made our Reaction Timer look like an old-school carnival game with a few fun clip-art drawings we found, but you can make yours look however you want. <a href="ch04.xhtml#ch04fig16">Figure 4-16</a> shows a template for the outside of our box. For this design, we have a hole for the button, a <span epub:type="pagebreak" id="page_115"/>hole for the stimulus LED, and two holes for indicator LEDs—one to show that you’re faster than a ninja and the other to show that you’re as slow as a turtle. You can download the template with this book’s resources via <em><a href="https://www.nostarch.com/arduinoinventor/">https://www.nostarch.com/arduinoinventor/</a></em> or just cut holes for the LEDs and buttons anywhere you like on your box.</p>&#13;
<p class="figuret"><a id="ch04fig16"/><strong>FIGURE 4-16:</strong> Template for the Reaction Timer carnival game cover art (not full size)</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_16.jpg"/></div>&#13;
<h4 class="h4" id="ch04lev2sec11"><strong>Cut Out the Cardboard</strong></h4>&#13;
<p class="noindent">If you use our template, print it and then glue or tape it to the front of your box. Whether you use the template or not, you’ll need to make a total of four holes in the cardboard for the three LEDs and the button. You can use a craft knife or a drill to <em>carefully</em> cut out the holes, as shown in <a href="ch04.xhtml#ch04fig17">Figure 4-17</a>. The LEDs are 5 mm in diameter, so a 3/16-inch drill bit is a pretty close fit. For the button hole, we recommend using a 5/16-inch drill bit, if you’re drilling, or a sharp pencil.</p>&#13;
<p class="figuret"><a id="ch04fig17"/><strong>FIGURE 4-17:</strong> Cutting out the holes from a cardboard box</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_17.jpg"/></div>&#13;
<h4 class="h4" id="ch04lev2sec12"><span epub:type="pagebreak" id="page_116"/><strong>Assemble the Electronics</strong></h4>&#13;
<p class="noindent">Now that you have the holes cut out of your Reaction Timer box, you need to add the electronic components. You’re going to move the three LEDs and the button from the breadboard to the exterior of your new cardboard box so that players can see them.</p>&#13;
<h5 class="h5" id="ch04lev3sec6"><strong>Attach the LEDs and Button to the Cardboard</strong></h5>&#13;
<p class="noindent">First, press the LEDs through their three holes from the back side of the cardboard, making sure that each sits snugly. If the holes you cut are too big and the LEDs are a little loose, simply add a small dab of glue to keep them in, as in <a href="ch04.xhtml#ch04fig18">Figure 4-18</a>.</p>&#13;
<p class="figuret"><a id="ch04fig18"/><strong>FIGURE 4-18:</strong> Moving the LEDs to your project box/ cardboard</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_18.jpg"/></div>&#13;
<p class="indent">Next, add the button. The push buttons that come in the SparkFun Inventor’s Kit have a cap that pops off. Remove the button cap, insert the button from the inside of the box, and glue the button onto the cardboard, as in <a href="ch04.xhtml#ch04fig19">Figure 4-19</a>. Reattach the button cap on the top side of the cardboard. Players are going to mash this button as they try to get the best score possible, so use a lot of glue to make sure it’s secure! When the glue is dry, try the button out. You need to be able to press the button in all the way, so make sure the cap doesn’t get caught on any cardboard when you press it down.</p>&#13;
<p class="figuret"><span epub:type="pagebreak" id="page_117"/><a id="ch04fig19"/><strong>FIGURE 4-19:</strong> Secure the button in place with a lot of glue.</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_19.jpg"/></div>&#13;
<div class="noter">&#13;
<p class="notet"><strong>NOTE</strong></p>&#13;
<p class="notep"><em>If using hot glue, be cautious when gluing the button to the cardboard. Hot glue is hot!</em></p>&#13;
</div>&#13;
<h5 class="h5" id="ch04lev3sec7"><strong>Reconnect the Components to the Arduino</strong></h5>&#13;
<p class="noindent">Now, use male-to-female jumper wires to connect the LEDs to the breadboard. Remember that the shorter leg of the LED needs to connect to ground (GND) in the circuit, and each of the longer legs should connect to its respective pin on the Arduino, through a 330 Ω resistor. Because the LED legs are a bit long, you may need to clip them back with wire cutters. A strategy we often use is to cut the shorter leg just a little shorter so that you can always tell which leg is the negative leg, as shown in <a href="ch04.xhtml#ch04fig20">Figure 4-20</a>.</p>&#13;
<p class="figuret"><a id="ch04fig20"/><strong>FIGURE 4-20:</strong> Cutting back the LED legs. Keep the short leg short!</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_20.jpg"/></div>&#13;
<p class="indent">If you can’t tell which leg is longer, you can also look at the shape of the plastic lens on the LED. There is typically a flat edge on the side nearest to the negative leg of the LED. The flat edge is subtle, but if you look closely, you should be able to see it.</p>&#13;
<p class="indent">Press the female ends of the male-to-female jumper wires onto the ends of the LEDs so that they fit snugly, like in <a href="ch04.xhtml#ch04fig21">Figure 4-21</a>. To keep things organized and easy to follow, we recommend using a black wire for the negative (short leg) of the LED.</p>&#13;
<p class="figuret"><span epub:type="pagebreak" id="page_118"/><a id="ch04fig21"/><strong>FIGURE 4-21:</strong> Connecting the LED to the jumper wires</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_21.jpg"/></div>&#13;
<p class="indent">Once the jumper wires are connected to all three LEDs, connect the male ends to the breadboard circuit. The wires for the stimulus LED should go to E2 and E3, for the green LED to E8 and E9, and for the red LED to E12 and E13.</p>&#13;
<p class="indent">Next, reconnect the button to the circuit. The button has four legs, but you only need to connect to two legs on one side of the button. Connect one male-to-female wire to one leg and another to the other leg, as in <a href="ch04.xhtml#ch04fig22">Figure 4-22</a>. Then, plug one wire into the same breadboard row that connects the 10 kΩ resistor and Arduino pin 3, and plug the other into GND on the breadboard. (If you wired up your breadboard prototype just like the diagram in <a href="ch04.xhtml#ch04fig14">Figure 4-14</a>, then connect these wires to E20 and E22 on the breadboard.) Because the button is just a switch, it doesn’t matter which wire you plug into GND.</p>&#13;
<p class="figuret"><a id="ch04fig22"/><strong>FIGURE 4-22:</strong> Connecting the male-to-female jumper wires to two legs on one side of the button</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_22.jpg"/></div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_119"/>With your components in place, plug your Arduino into the computer and open the Serial Monitor to make sure your circuit still works. You should see your instruction messages on the Serial Monitor. When the blue LED lights, press the button as fast as you can. The Serial Monitor should show your reaction time, and either the red or green LED should turn on, based on how fast you were.</p>&#13;
<p class="indent">If your circuit doesn’t seem to be working, check that all of your connections are secure, and compare your circuit to <a href="ch04.xhtml#ch04fig14">Figures 4-14</a> and <a href="ch04.xhtml#ch04fig15">4-15</a> to make sure the connections are correct.</p>&#13;
<h4 class="h4" id="ch04lev2sec13"><strong>Spice Up Your Game Enclosure</strong></h4>&#13;
<p class="noindent">To finish up, add some bling to your new game. Use your imagination! You might want to cover your Reaction Timer with your favorite stickers or paint the box. We love using ping-pong balls in our projects, and since we had a half left over from <a href="ch02.xhtml#ch02">Project 2</a>, we decided to glue it on top of the blue LED, as in <a href="ch04.xhtml#ch04fig23">Figure 4-23</a>.</p>&#13;
<p class="figuret"><a id="ch04fig23"/><strong>FIGURE 4-23:</strong> Carnival-themed Reaction Timer game</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_23.jpg"/></div>&#13;
<h3 class="h3" id="ch04lev1sec6"><strong>GOING FURTHER</strong></h3>&#13;
<p class="noindent">Next, try combining what you learned in the first three projects with what you know from this project to make it more interesting—add even more LEDs, or maybe make the game suitable for two players.</p>&#13;
<h4 class="h4" id="ch04lev2sec14"><strong>Hack</strong></h4>&#13;
<p class="noindent">Add two more LEDs to make a four-LED scale that will show your speed more accurately. Faster reaction times will light up more LEDs. To do this, you’ll need the help of a nested <span class="literal">if()</span>–<span class="literal">else if()</span> control <span epub:type="pagebreak" id="page_120"/>statement. You can stack your condition statements to tell the code what to do in different conditions, so if the first logical expression is <span class="literal">false</span>, the next one is tested; if that’s also <span class="literal">false</span>, the next is tested; and so on until the final <span class="literal">else()</span> statement, which runs if none of the previous conditions were <span class="literal">true</span>. <a href="ch04.xhtml#ch04ex07">Listing 4-7</a> shows an example of this conditional logic. It assumes you’ve added two extra LEDs connected to pins 10 and 9. Don’t forget the <span class="literal">pinMode()</span> commands you’ll have to add to the <span class="literal">setup()</span>!</p>&#13;
<p class="ex-caption"><a id="ch04ex07"/><strong>LISTING 4-7:</strong> Snippet of nested <span class="literal">if()–else if()</span> statement</p>&#13;
<div class="pre">&#13;
<p class="programs"><span class="ent">➊</span>   <span class="green1">if</span> (reactTime &lt;= 215)<br/>    {<br/>      <span class="ash">//turn all LEDs on</span><br/>      <span class="orange">digitalWrite</span>(12, <span class="green">HIGH</span>);<br/>      <span class="orange">digitalWrite</span>(11, <span class="green">HIGH</span>);<br/>      <span class="orange">digitalWrite</span>(10, <span class="green">HIGH</span>);<br/>      <span class="orange">digitalWrite</span>(9, <span class="green">HIGH</span>);<br/>    }<br/><span class="ent">➋</span>   <span class="green1">else if</span> (reactTime &lt;= 250)<br/>    {<br/>      <span class="ash">//turn three LEDs on</span><br/>      <span class="orange">digitalWrite</span>(12, <span class="green">LOW</span>);<br/>      <span class="orange">digitalWrite</span>(11, <span class="green">HIGH</span>);<br/>      <span class="orange">digitalWrite</span>(10, <span class="green">HIGH</span>);<br/>      <span class="orange">digitalWrite</span>(9, <span class="green">HIGH</span>);<br/>    }<br/><span class="ent">➌</span>   <span class="green1">else if</span> (reactTime &lt;= 300)<br/>    {<br/>      <span class="ash">//turn two LEDs on</span><br/>      <span class="orange">digitalWrite</span>(12, <span class="green">LOW</span>);<br/>      <span class="orange">digitalWrite</span>(11, <span class="green">LOW</span>);<br/>      <span class="orange">digitalWrite</span>(10, <span class="green">HIGH</span>);<br/>      <span class="orange">digitalWrite</span>(9, <span class="green">HIGH</span>);<br/>    }<br/><span class="ent">➍</span>   <span class="green1">else</span><br/>    {<br/>      <span class="ash">//turn one LED on</span><br/>      <span class="orange">digitalWrite</span>(12, <span class="green">LOW</span>);<br/>      <span class="orange">digitalWrite</span>(11, <span class="green">LOW</span>);<br/>      <span class="orange">digitalWrite</span>(10, <span class="green">LOW</span>);<br/>      <span class="orange">digitalWrite</span>(9, <span class="green">HIGH</span>);<br/>}</p>&#13;
</div>&#13;
<p class="indent">The <span class="literal">if()</span> statement at <span class="ent">➊</span> checks whether the reaction time is less than or equal to 215 ms and lights up all four LEDs. Then two <span class="literal">else if()</span> statements catch times between 215 ms and 250 ms <span class="ent">➋</span>, <span epub:type="pagebreak" id="page_121"/>lighting up three LEDs, and between 250 ms and 300 ms <span class="ent">➌</span>, lighting up two LEDs. Finally, an <span class="literal">else</span> statement <span class="ent">➍</span> catches all times slower than 300 ms and lights up a single LED.</p>&#13;
<p class="indent">If you need a little more help with the code, check out our example sketch in the resources at <em><a href="https://www.nostarch.com/arduinoinventor/">https://www.nostarch.com/arduinoinventor/</a></em>.</p>&#13;
<h4 class="h4" id="ch04lev2sec15"><strong>Modify</strong></h4>&#13;
<p class="noindent">One fun way to modify this project would be to make it a two-player game. You could add a second button and repurpose your LEDs to indicate which player is faster. In this modification, the green LED will light up if Player 1 is faster, and the red LED will light up if Player 2 is faster.</p>&#13;
<p class="indent">First, add a second button. <a href="ch04.xhtml#ch04fig24">Figure 4-24</a> shows the additional button at the bottom of the breadboard. Notice that it’s just a duplication of the pull-up resistor/button combination circuit that you built for the first button.</p>&#13;
<p class="figuret"><a id="ch04fig24"/><strong>FIGURE 4-24:</strong> Adding a second button for two-player mode</p>&#13;
<div class="image"><img alt="Image" src="../images/fig4_24.jpg"/></div>&#13;
<div class="noter">&#13;
<p class="notet"><strong>NOTE</strong></p>&#13;
<p class="notep"><em>If both players hit the buttons at exactly the same time, the game will favor Player 1 (the green LED). Although this would be a really rare occurrence, how would you modify the code to light up both LEDs if both buttons are pressed at the same time?</em></p>&#13;
</div>&#13;
<p class="indent">The complete code for the two-player modification is available, along with the wiring diagram for the modification, at <em><a href="https://www.nostarch.com/arduinoinventor/">https://www.nostarch.com/arduinoinventor/</a></em>.</p>&#13;
<p class="indent">Now, go and take your new game out on the town. Are you faster than your family? Are you faster than your friends? Who is the fastest person you know?</p>&#13;
</body></html>