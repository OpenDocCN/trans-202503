<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:ns="http://www.w3.org/2001/10/synthesis" lang="en-us" xml:lang="en-us">
	<head>
		<title>Ethical Hacking: A Hands-on Introduction to Breaking In</title>
		<link href="../styles/9781718501881.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:3776231c-affd-4772-8376-b44c973236be" name="Adept.expected.resource"/>
	</head>
	<body>
		<h2 class="h2" id="contents"><span epub:type="pagebreak" id="page_ix"/><strong>CONTENTS IN DETAIL</strong></h2>
		<p class="toc-chapa"><a href="acknowledgments.xhtml#acknowledgments"><strong>ACKNOWLEDGMENTS</strong></a></p>
		<p class="toc-chapa"><a href="foreword.xhtml#foreword"><strong>FOREWORD</strong></a></p>
		<p class="toc-chapa"><a href="introduction.xhtml#introduction"><strong>INTRODUCTION</strong></a></p>
		<p class="toc-lev1"><a href="introduction.xhtml#ch00lev1">Why Read This Book?</a></p>
		<p class="toc-lev1"><a href="introduction.xhtml#ch00lev2">Installing Python</a></p>
		<p class="toc-lev1"><a href="introduction.xhtml#ch00lev3">What Is in the Book?</a></p>
		<p class="toc-lev2"><a href="introduction.xhtml#ch00lev4">Part I: Networking Fundamentals</a></p>
		<p class="toc-lev2"><a href="introduction.xhtml#ch00lev5">Part II: Cryptography</a></p>
		<p class="toc-lev2"><a href="introduction.xhtml#ch00lev6">Part III: Social Engineering</a></p>
		<p class="toc-lev2"><a href="introduction.xhtml#ch00lev7">Part IV: Exploitation</a></p>
		<p class="toc-lev2"><a href="introduction.xhtml#ch00lev8">Part V: Controlling the Network</a></p>
		<p class="toc-lev1"><a href="introduction.xhtml#ch00lev9">Reaching Out</a></p>
		<p class="toc-chapa"><a href="ch01.xhtml#ch1"><strong>1<br/>SETTING UP</strong></a></p>
		<p class="toc-lev1"><a href="ch01.xhtml#ch01lev1">Virtual Lab</a></p>
		<p class="toc-lev1"><a href="ch01.xhtml#ch01lev2">Setting Up VirtualBox</a></p>
		<p class="toc-lev1"><a href="ch01.xhtml#ch01lev3">Setting Up pfSense</a></p>
		<p class="toc-lev2"><a href="ch01.xhtml#ch01lev4">Setting Up the Internal Network</a></p>
		<p class="toc-lev2"><a href="ch01.xhtml#ch01lev5">Configuring pfSense</a></p>
		<p class="toc-lev1"><a href="ch01.xhtml#ch01lev6">Setting Up Metasploitable</a></p>
		<p class="toc-lev1"><a href="ch01.xhtml#ch01lev7">Setting Up Kali Linux</a></p>
		<p class="toc-lev1"><a href="ch01.xhtml#ch01lev8">Setting Up the Ubuntu Linux Desktop</a></p>
		<p class="toc-lev1"><a href="ch01.xhtml#ch01lev9">Your First Hack: Exploiting a Backdoor in Metasploitable</a></p>
		<p class="toc-lev2"><a href="ch01.xhtml#ch01lev10">Getting the IP Address of the Metasploitable Server</a></p>
		<p class="toc-lev2"><a href="ch01.xhtml#ch01lev11">Using the Backdoor to Gain Access</a></p>
		<p class="toc-part"><a href="part01.xhtml#part01"><strong>PART I<br/>NETWORK FUNDAMENTALS</strong></a></p>
		<p class="toc-chapa"><a href="ch02.xhtml#ch2"><span epub:type="pagebreak" id="page_x"/><strong>2<br/>CAPTURING TRAFFIC WITH ARP SPOOFING</strong></a></p>
		<p class="toc-lev1"><a href="ch02.xhtml#ch02lev12">How the Internet Transmits Data</a></p>
		<p class="toc-lev2"><a href="ch02.xhtml#ch02lev13">Packets</a></p>
		<p class="toc-lev2"><a href="ch02.xhtml#ch02lev14">MAC Addresses</a></p>
		<p class="toc-lev2"><a href="ch02.xhtml#ch02lev15">IP Addresses</a></p>
		<p class="toc-lev2"><a href="ch02.xhtml#ch02lev16">ARP Tables</a></p>
		<p class="toc-lev1"><a href="ch02.xhtml#ch02lev17">ARP Spoofing Attacks</a></p>
		<p class="toc-lev1"><a href="ch02.xhtml#ch02lev18">Performing an ARP Spoofing Attack</a></p>
		<p class="toc-lev1"><a href="ch02.xhtml#ch02lev19">Detecting an ARP Spoofing Attack</a></p>
		<p class="toc-lev1"><a href="ch02.xhtml#ch02lev20">Exercises</a></p>
		<p class="toc-lev2"><a href="ch02.xhtml#ch02lev21">Inspect ARP Tables</a></p>
		<p class="toc-lev2"><a href="ch02.xhtml#ch02lev22">Implement an ARP Spoofer in Python</a></p>
		<p class="toc-lev2"><a href="ch02.xhtml#ch02lev23">MAC Flooding</a></p>
		<p class="toc-chapa"><a href="ch03.xhtml#ch3"><strong>3<br/>ANALYZING CAPTURED TRAFFIC</strong></a></p>
		<p class="toc-lev1"><a href="ch03.xhtml#ch03lev1">Packets and the Internet Protocol Stack</a></p>
		<p class="toc-lev2"><a href="ch03.xhtml#ch03lev2">The Five-Layer Internet Protocol Stack</a></p>
		<p class="toc-lev1"><a href="ch03.xhtml#ch03lev8">Viewing Packets in Wireshark</a></p>
		<p class="toc-lev1"><a href="ch03.xhtml#ch03lev9">Analyzing Packets Collected by Your Firewall</a></p>
		<p class="toc-lev2"><a href="ch03.xhtml#ch03lev10">Capturing Traffic on Port 80</a></p>
		<p class="toc-lev1"><a href="ch03.xhtml#ch03lev11">Exercises</a></p>
		<p class="toc-lev2"><a href="ch03.xhtml#ch03lev12">pfSense</a></p>
		<p class="toc-lev2"><a href="ch03.xhtml#ch03lev13">Exploring Packets in Wireshark</a></p>
		<p class="toc-chapa"><a href="ch04.xhtml#ch4"><strong>4<br/>CRAFTING TCP SHELLS AND BOTNETS</strong></a></p>
		<p class="toc-lev1"><a href="ch04.xhtml#ch04lev1">Sockets and Process Communication</a></p>
		<p class="toc-lev2"><a href="ch04.xhtml#ch04lev2">TCP Handshakes</a></p>
		<p class="toc-lev2"><a href="ch04.xhtml#ch04lev3">A TCP Reverse Shell</a></p>
		<p class="toc-lev1"><a href="ch04.xhtml#ch04lev4">Accessing the Victim Machine</a></p>
		<p class="toc-lev2"><a href="ch04.xhtml#ch04lev5">Scanning for Open Ports</a></p>
		<p class="toc-lev2"><a href="ch04.xhtml#ch04lev6">Exploiting a Vulnerable Service</a></p>
		<p class="toc-lev1"><a href="ch04.xhtml#ch04lev7">Writing a Reverse Shell Client</a></p>
		<p class="toc-lev1"><a href="ch04.xhtml#ch04lev8">Writing a TCP Server That Listens for Client Connections</a></p>
		<p class="toc-lev1"><a href="ch04.xhtml#ch04lev9">Loading the Reverse Shell onto the Metasploitable Server</a></p>
		<p class="toc-lev1"><a href="ch04.xhtml#ch04lev10">Botnets</a></p>
		<p class="toc-lev1"><a href="ch04.xhtml#ch04lev11">Exercises</a></p>
		<p class="toc-lev2"><a href="ch04.xhtml#ch04lev12">A Multiclient Bot Server</a></p>
		<p class="toc-lev2"><a href="ch04.xhtml#ch04lev13">SYN Scans</a></p>
		<p class="toc-lev2"><a href="ch04.xhtml#ch04lev14">Detecting XMas Scans</a></p>
		<p class="toc-part"><span epub:type="pagebreak" id="page_xi"/><a href="part02.xhtml#part02"><strong>PART II<br/>CRYPTOGRAPHY</strong></a></p>
		<p class="toc-chapa"><a href="ch05.xhtml#ch5"><strong>5<br/>CRYPTOGRAPHY AND RANSOMWARE</strong></a></p>
		<p class="toc-lev1"><a href="ch05.xhtml#ch05lev1">Encryption</a></p>
		<p class="toc-lev2"><a href="ch05.xhtml#ch05lev2">One-Time Pad</a></p>
		<p class="toc-lev2"><a href="ch05.xhtml#ch05lev3">Pseudorandom Generators</a></p>
		<p class="toc-lev2"><a href="ch05.xhtml#ch05lev4">Insecure Block Ciphers Modes</a></p>
		<p class="toc-lev2"><a href="ch05.xhtml#ch05lev5">Secure Block Ciphers Modes</a></p>
		<p class="toc-lev1"><a href="ch05.xhtml#ch05lev6">Encrypting and Decrypting a File</a></p>
		<p class="toc-lev1"><a href="ch05.xhtml#ch05lev7">Email Encryption</a></p>
		<p class="toc-lev2"><a href="ch05.xhtml#ch05lev8">Public-Key Cryptography</a></p>
		<p class="toc-lev2"><a href="ch05.xhtml#ch05lev9">Rivest–Shamir–Adleman Theory</a></p>
		<p class="toc-lev2"><a href="ch05.xhtml#ch05lev10">The RSA Math</a></p>
		<p class="toc-lev1"><a href="ch05.xhtml#ch05lev11">Encrypting a File with RSA</a></p>
		<p class="toc-lev2"><a href="ch05.xhtml#ch05lev12">Optimal Asymmetric Encryption Padding</a></p>
		<p class="toc-lev1"><a href="ch05.xhtml#ch05lev13">Writing Ransomware</a></p>
		<p class="toc-lev1"><a href="ch05.xhtml#ch05lev14">Exercises</a></p>
		<p class="toc-lev2"><a href="ch05.xhtml#ch05lev15">The Ransomware Server</a></p>
		<p class="toc-lev2"><a href="ch05.xhtml#ch05lev16">Extending the Ransomware Client</a></p>
		<p class="toc-lev2"><a href="ch05.xhtml#ch05lev17">Unsolved Codes</a></p>
		<p class="toc-chapa"><a href="ch06.xhtml#ch6"><strong>6<br/>TLS AND DIFFIE-HELLMAN</strong></a></p>
		<p class="toc-lev1"><a href="ch06.xhtml#ch06lev1">Transport Layer Security</a></p>
		<p class="toc-lev2"><a href="ch06.xhtml#ch06lev2">Message Authentication</a></p>
		<p class="toc-lev2"><a href="ch06.xhtml#ch06lev3">Certificate Authorities and Signatures</a></p>
		<p class="toc-lev2"><a href="ch06.xhtml#ch06lev5">Certificate Authorities</a></p>
		<p class="toc-lev1"><a href="ch06.xhtml#ch06lev6">Using Diffie-Hellman to Compute a Shared Key</a></p>
		<p class="toc-lev2"><a href="ch06.xhtml#ch06lev7">Step 1: Generating the Shared Parameters</a></p>
		<p class="toc-lev2"><a href="ch06.xhtml#ch06lev8">Step 2: Generating the Public–Private Key Pair</a></p>
		<p class="toc-lev2"><a href="ch06.xhtml#ch06lev9">Why Can’t a Hacker Calculate the Private Key?</a></p>
		<p class="toc-lev2"><a href="ch06.xhtml#ch06lev10">Step 3: Exchanging Key Shares and Nonces</a></p>
		<p class="toc-lev2"><a href="ch06.xhtml#ch06lev11">Step 4: Calculating the Shared Secret Key</a></p>
		<p class="toc-lev2"><a href="ch06.xhtml#ch06lev12">Step 5: Key Derivation</a></p>
		<p class="toc-lev2"><a href="ch06.xhtml#ch06lev13">Attacking Diffie-Hellman</a></p>
		<p class="toc-lev1"><a href="ch06.xhtml#ch06lev14">Elliptic-Curve Diffie-Hellman</a></p>
		<p class="toc-lev2"><a href="ch06.xhtml#ch06lev15">The Math of Elliptic Curves</a></p>
		<p class="toc-lev2"><a href="ch06.xhtml#ch06lev16">The Double and Add Algorithm</a></p>
		<p class="toc-lev2"><a href="ch06.xhtml#ch06lev17">Why Can’t a Hacker Use G<sub>xy</sub> and a<sub>xy</sub> to Calculate the Private Key A?</a></p>
		<p class="toc-lev1"><a href="ch06.xhtml#ch06lev18">Writing TLS Sockets</a></p>
		<p class="toc-lev2"><a href="ch06.xhtml#ch06lev19">The Secure Client Socket</a></p>
		<p class="toc-lev2"><a href="ch06.xhtml#ch06lev20">The Secure Server Socket</a></p>
		<p class="toc-lev1"><a href="ch06.xhtml#ch06lev21"><span epub:type="pagebreak" id="page_xii"/>SSL Stripping and HSTS Bypass</a></p>
		<p class="toc-lev1"><a href="ch06.xhtml#ch06lev22">Exercise: Add Encryption to your Ransomware Server</a></p>
		<p class="toc-part"><a href="part03.xhtml#part03"><strong>PART III<br/>SOCIAL ENGINEERING</strong></a></p>
		<p class="toc-chapa"><a href="ch07.xhtml#ch7"><strong>7<br/>PHISHING AND DEEPFAKES</strong></a></p>
		<p class="toc-lev1"><a href="ch07.xhtml#ch07lev1">A Sophisticated and Sneaky Social Engineering Attack</a></p>
		<p class="toc-lev1"><a href="ch07.xhtml#ch07lev2">Faking Emails</a></p>
		<p class="toc-lev2"><a href="ch07.xhtml#ch07lev3">Performing a DNS Lookup of a Mail Server</a></p>
		<p class="toc-lev2"><a href="ch07.xhtml#ch07lev4">Communicating with SMTP</a></p>
		<p class="toc-lev2"><a href="ch07.xhtml#ch07lev5">Writing an Email Spoofer</a></p>
		<p class="toc-lev2"><a href="ch07.xhtml#ch07lev6">Spoofing SMTPS Emails</a></p>
		<p class="toc-lev1"><a href="ch07.xhtml#ch07lev7">Faking Websites</a></p>
		<p class="toc-lev1"><a href="ch07.xhtml#ch07lev8">Creating Deepfake Videos</a></p>
		<p class="toc-lev2"><a href="ch07.xhtml#ch07lev9">Accessing Google Colab</a></p>
		<p class="toc-lev2"><a href="ch07.xhtml#ch07lev10">Importing the Machine Learning Models</a></p>
		<p class="toc-lev1"><a href="ch07.xhtml#ch07lev11">Exercises</a></p>
		<p class="toc-lev2"><a href="ch07.xhtml#ch07lev12">Voice Cloning</a></p>
		<p class="toc-lev2"><a href="ch07.xhtml#ch07lev13">Phishing at Scale</a></p>
		<p class="toc-lev2"><a href="ch07.xhtml#ch07lev14">SMTP Auditing</a></p>
		<p class="toc-chapa"><a href="ch08.xhtml#ch8"><strong>8<br/>SCANNING TARGETS</strong></a></p>
		<p class="toc-lev1"><a href="ch08.xhtml#ch08lev1">Link Analysis</a></p>
		<p class="toc-lev2"><a href="ch08.xhtml#ch08lev2">Maltego</a></p>
		<p class="toc-lev2"><a href="ch08.xhtml#ch08lev3">Leaked Credential Databases</a></p>
		<p class="toc-lev2"><a href="ch08.xhtml#ch08lev4">SIM Jacking</a></p>
		<p class="toc-lev1"><a href="ch08.xhtml#ch08lev5">Google Dorking</a></p>
		<p class="toc-lev1"><a href="ch08.xhtml#ch08lev6">Scanning the Entire Internet</a></p>
		<p class="toc-lev2"><a href="ch08.xhtml#ch08lev7">Masscan</a></p>
		<p class="toc-lev2"><a href="ch08.xhtml#ch08lev11">Shodan</a></p>
		<p class="toc-lev1"><a href="ch08.xhtml#ch08lev12">IPv6 and NAT Limitations</a></p>
		<p class="toc-lev2"><a href="ch08.xhtml#ch08lev13">Internet Protocol Version 6 (IPv6)</a></p>
		<p class="toc-lev2"><a href="ch08.xhtml#ch08lev14">NAT</a></p>
		<p class="toc-lev1"><a href="ch08.xhtml#ch08lev15">Vulnerability Databases</a></p>
		<p class="toc-lev1"><a href="ch08.xhtml#ch08lev16">Vulnerability Scanners</a></p>
		<p class="toc-lev1"><a href="ch08.xhtml#ch08lev17">Exercises</a></p>
		<p class="toc-lev2"><a href="ch08.xhtml#ch08lev18">nmap Scans</a></p>
		<p class="toc-lev2"><a href="ch08.xhtml#ch08lev19">Discover</a></p>
		<p class="toc-lev2"><a href="ch08.xhtml#ch08lev20">Writing Your Own OSINT Tool</a></p>
		<p class="toc-part"><span epub:type="pagebreak" id="page_xiii"/><a href="part04.xhtml#part04"><strong>PART IV<br/>EXPLOITATION</strong></a></p>
		<p class="toc-chapa"><a href="ch09.xhtml#ch9"><strong>9<br/>FUZZING FOR ZERO-DAY VULNERABILITIES</strong></a></p>
		<p class="toc-lev1"><a href="ch09.xhtml#ch09lev1">Case Study: Exploiting the Heartbleed OpenSSL Vulnerability</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev2">Creating an Exploit</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev3">Starting the Program</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev4">Writing the Client Hello Message</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev5">Reading the Server Response</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev6">Crafting the Malicious Heartbeat Request</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev7">Reading the Leaked Memory Contents</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev8">Writing the Exploit Function</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev9">Putting It Together</a></p>
		<p class="toc-lev1"><a href="ch09.xhtml#ch09lev10">Fuzzing</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev11">A Simplified Example</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev12">Writing Your Own Fuzzer</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev13">American Fuzzy Lop</a></p>
		<p class="toc-lev1"><a href="ch09.xhtml#ch09lev18">Symbolic Execution</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev19">A Symbolic Execution of the Test Program</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev20">Limitations of Symbolic Execution</a></p>
		<p class="toc-lev1"><a href="ch09.xhtml#ch09lev21">Dynamic Symbolic Execution</a></p>
		<p class="toc-lev1"><a href="ch09.xhtml#ch09lev22">Using DSE to Crack a Passcode</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev23">Creating an Executable Binary</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev24">Installing and Running Angr</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev25">The Angr Program</a></p>
		<p class="toc-lev1"><a href="ch09.xhtml#ch09lev26">Exercises</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev27">Capture the Flag Games with Angr</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev28">Fuzzing Web Protocols</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev29">Fuzzing an Open Source Project</a></p>
		<p class="toc-lev2"><a href="ch09.xhtml#ch09lev30">Implement Your Own Concolic Execution Engine</a></p>
		<p class="toc-chapa"><a href="ch10.xhtml#ch10"><strong>10<br/>BUILDING TROJANS</strong></a></p>
		<p class="toc-lev1"><a href="ch10.xhtml#ch10lev1">Case Study: Re-Creating Drovorub by Using Metasploit</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev2">Building the Attacker’s Server</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev3">Building the Victim Client</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev4">Uploading the Implant</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev5">Using the Attacker Agent</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev6">Why We Need a Victim Kernel Module</a></p>
		<p class="toc-lev1"><a href="ch10.xhtml#ch10lev7">Hiding an Implant in a Legitimate File</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev8">Creating a Trojan</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev11">Hosting the Trojan</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev12">Downloading the Infected File</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev13">Controlling the Implant</a></p>
		<p class="toc-lev1"><a href="ch10.xhtml#ch10lev14"><span epub:type="pagebreak" id="page_xiv"/>Evading Antivirus by Using Encoders</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev15">The Base64 Encoder</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev16">Writing a Metasploit Module</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev17">Shikata Ga Nai Encoder</a></p>
		<p class="toc-lev1"><a href="ch10.xhtml#ch10lev18">Creating a Windows Trojan</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev19">Hiding the Trojan in Minesweeper</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev20">Hiding the Trojan in a Word Document (or Another Innocent File)</a></p>
		<p class="toc-lev1"><a href="ch10.xhtml#ch10lev21">Creating an Android Trojan</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev22">Deconstructing the APK to View the Implant</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev23">Rebuilding and Signing the APK</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev24">Testing the Android Trojan</a></p>
		<p class="toc-lev1"><a href="ch10.xhtml#ch10lev25">Exercises</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev26">Evil-Droid</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev27">Writing Your Own Python Implant</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev28">Obfuscate Your Implant</a></p>
		<p class="toc-lev2"><a href="ch10.xhtml#ch10lev29">Build a Platform-Specific Executable</a></p>
		<p class="toc-chapa"><a href="ch11.xhtml#ch11"><strong>11<br/>BUILDING AND INSTALLING LINUX ROOTKITS</strong></a></p>
		<p class="toc-lev1"><a href="ch11.xhtml#ch11lev1">Writing a Linux Kernel Module</a></p>
		<p class="toc-lev2"><a href="ch11.xhtml#ch11lev2">Backing Up Your Kali Linux Virtual Machine</a></p>
		<p class="toc-lev2"><a href="ch11.xhtml#ch11lev3">Writing the Code</a></p>
		<p class="toc-lev2"><a href="ch11.xhtml#ch11lev4">Compiling and Running Your Kernel Module</a></p>
		<p class="toc-lev1"><a href="ch11.xhtml#ch11lev5">Modifying System Calls</a></p>
		<p class="toc-lev2"><a href="ch11.xhtml#ch11lev6">How System Calls Work</a></p>
		<p class="toc-lev2"><a href="ch11.xhtml#ch11lev7">Hooking Syscalls</a></p>
		<p class="toc-lev1"><a href="ch11.xhtml#ch11lev8">Hooking the Shutdown Syscall</a></p>
		<p class="toc-lev1"><a href="ch11.xhtml#ch11lev9">Hiding Files</a></p>
		<p class="toc-lev2"><a href="ch11.xhtml#ch11lev10">The linux_dirent struct</a></p>
		<p class="toc-lev2"><a href="ch11.xhtml#ch11lev11">Writing the Hooking Code</a></p>
		<p class="toc-lev1"><a href="ch11.xhtml#ch11lev12">Using Armitage to Exploit a Host and Install a Rootkit</a></p>
		<p class="toc-lev2"><a href="ch11.xhtml#ch11lev13">Scanning the Network</a></p>
		<p class="toc-lev2"><a href="ch11.xhtml#ch11lev14">Exploiting a Host</a></p>
		<p class="toc-lev2"><a href="ch11.xhtml#ch11lev15">Installing a Rootkit</a></p>
		<p class="toc-lev1"><a href="ch11.xhtml#ch11lev16">Exercises</a></p>
		<p class="toc-lev2"><a href="ch11.xhtml#ch11lev17">The Keylogger</a></p>
		<p class="toc-lev2"><a href="ch11.xhtml#ch11lev18">Self-Hiding Module</a></p>
		<p class="toc-chapa"><a href="ch12.xhtml#ch12"><strong>12<br/>STEALING AND CRACKING PASSWORDS</strong></a></p>
		<p class="toc-lev1"><a href="ch12.xhtml#ch12lev1">SQL Injection</a></p>
		<p class="toc-lev1"><a href="ch12.xhtml#ch12lev2">Stealing Passwords from a Website’s Database</a></p>
		<p class="toc-lev2"><a href="ch12.xhtml#ch12lev3">Enumerating Reachable Files on the Web Server</a></p>
		<p class="toc-lev2"><a href="ch12.xhtml#ch12lev4">Performing SQL Injection</a></p>
		<p class="toc-lev1"><a href="ch12.xhtml#ch12lev5"><span epub:type="pagebreak" id="page_xv"/>Writing Your Own SQL Injection Tool</a></p>
		<p class="toc-lev2"><a href="ch12.xhtml#ch12lev6">Understanding HTTP Requests</a></p>
		<p class="toc-lev2"><a href="ch12.xhtml#ch12lev7">Writing the Injection Program</a></p>
		<p class="toc-lev1"><a href="ch12.xhtml#ch12lev8">Using SQLMap</a></p>
		<p class="toc-lev1"><a href="ch12.xhtml#ch12lev9">Hashing Passwords</a></p>
		<p class="toc-lev2"><a href="ch12.xhtml#ch12lev10">The Anatomy of the MD5 Hash</a></p>
		<p class="toc-lev2"><a href="ch12.xhtml#ch12lev11">Cracking Hashes</a></p>
		<p class="toc-lev2"><a href="ch12.xhtml#ch12lev12">Salting Hashes with a Nonce</a></p>
		<p class="toc-lev1"><a href="ch12.xhtml#ch12lev13">Building a Salted Hash Cracker</a></p>
		<p class="toc-lev1"><a href="ch12.xhtml#ch12lev14">Popular Hash Cracking and Brute-Forcing Tools</a></p>
		<p class="toc-lev2"><a href="ch12.xhtml#ch12lev15">John the Ripper</a></p>
		<p class="toc-lev2"><a href="ch12.xhtml#ch12lev16">Hashcat</a></p>
		<p class="toc-lev2"><a href="ch12.xhtml#ch12lev17">Hydra</a></p>
		<p class="toc-lev1"><a href="ch12.xhtml#ch12lev18">Exercises</a></p>
		<p class="toc-lev2"><a href="ch12.xhtml#ch12lev19">NoSQL Injection</a></p>
		<p class="toc-lev2"><a href="ch12.xhtml#ch12lev20">Brute-Forcing Web Logins</a></p>
		<p class="toc-lev2"><a href="ch12.xhtml#ch12lev21">Burp Suite</a></p>
		<p class="toc-chapa"><a href="ch13.xhtml#ch13"><strong>13<br/>SERIOUS CROSS-SITE SCRIPTING EXPLOITATION</strong></a></p>
		<p class="toc-lev1"><a href="ch13.xhtml#ch13lev1">Cross-Site Scripting</a></p>
		<p class="toc-lev2"><a href="ch13.xhtml#ch13lev2">How JavaScript Can Be Malicious</a></p>
		<p class="toc-lev2"><a href="ch13.xhtml#ch13lev3">Stored XSS Attacks</a></p>
		<p class="toc-lev2"><a href="ch13.xhtml#ch13lev4">Reflected XSS Attacks</a></p>
		<p class="toc-lev1"><a href="ch13.xhtml#ch13lev5">Finding Vulnerabilities with OWASP Zed Attack Proxy</a></p>
		<p class="toc-lev1"><a href="ch13.xhtml#ch13lev6">Using Browser Exploitation Framework Payloads</a></p>
		<p class="toc-lev2"><a href="ch13.xhtml#ch13lev7">Injecting the BeEF Hook</a></p>
		<p class="toc-lev2"><a href="ch13.xhtml#ch13lev8">Performing a Social Engineering Attack</a></p>
		<p class="toc-lev1"><a href="ch13.xhtml#ch13lev9">Moving from Browser to Machine</a></p>
		<p class="toc-lev2"><a href="ch13.xhtml#ch13lev10">Case Study: Exploiting an Old Version of the Chrome Browser</a></p>
		<p class="toc-lev2"><a href="ch13.xhtml#ch13lev11">Installing Rootkits via Website Exploitation</a></p>
		<p class="toc-lev1"><a href="ch13.xhtml#ch13lev12">Exercise: Hunting for Bugs in a Bug Bounty Program</a></p>
		<p class="toc-part"><a href="part05.xhtml#part05"><strong>PART V<br/>CONTROLLING THE NETWORK</strong></a></p>
		<p class="toc-chapa"><a href="ch14.xhtml#ch14"><strong>14<br/>PIVOTING AND PRIVILEGE ESCALATION</strong></a></p>
		<p class="toc-lev1"><a href="ch14.xhtml#ch14lev1">Pivoting from a Dual-Homed Device</a></p>
		<p class="toc-lev2"><a href="ch14.xhtml#ch14lev2">Configuring a Dual-Homed Device</a></p>
		<p class="toc-lev2"><a href="ch14.xhtml#ch14lev3">Connecting a Machine to Your Private Network</a></p>
		<p class="toc-lev2"><a href="ch14.xhtml#ch14lev4">Pivoting with Metasploit</a></p>
		<p class="toc-lev2"><a href="ch14.xhtml#ch14lev5">Writing an Attacker Proxy</a></p>
		<p class="toc-lev1"><a href="ch14.xhtml#ch14lev6"><span epub:type="pagebreak" id="page_xvi"/>Extracting Password Hashes on Linux</a></p>
		<p class="toc-lev2"><a href="ch14.xhtml#ch14lev7">Where Linux Stores Usernames and Passwords</a></p>
		<p class="toc-lev2"><a href="ch14.xhtml#ch14lev8">Performing a Dirty COW Privilege Escalation Attack</a></p>
		<p class="toc-lev1"><a href="ch14.xhtml#ch14lev9">Exercises</a></p>
		<p class="toc-lev2"><a href="ch14.xhtml#ch14lev10">Adding NAT to Your Dual-Homed Device</a></p>
		<p class="toc-lev2"><a href="ch14.xhtml#ch14lev11">Suggested Reading on Windows Privilege Escalation</a></p>
		<p class="toc-chapa"><a href="ch15.xhtml#ch15"><strong>15<br/>MOVING THROUGH THE CORPORATE WINDOWS NETWORK</strong></a></p>
		<p class="toc-lev1"><a href="ch15.xhtml#ch15lev1">Creating a Windows Virtual Lab</a></p>
		<p class="toc-lev1"><a href="ch15.xhtml#ch15lev2">Extracting Password Hashes with Mimikatz</a></p>
		<p class="toc-lev1"><a href="ch15.xhtml#ch15lev3">Passing the Hash with NT LAN Manager</a></p>
		<p class="toc-lev1"><a href="ch15.xhtml#ch15lev4">Exploring the Corporate Windows Network</a></p>
		<p class="toc-lev1"><a href="ch15.xhtml#ch15lev5">Attacking the DNS Service</a></p>
		<p class="toc-lev1"><a href="ch15.xhtml#ch15lev6">Attacking Active Directory and LDAP Services</a></p>
		<p class="toc-lev2"><a href="ch15.xhtml#ch15lev7">Writing an LDAP Query Client</a></p>
		<p class="toc-lev2"><a href="ch15.xhtml#ch15lev8">Using SharpHound and Bloodhound for LDAP Enumeration</a></p>
		<p class="toc-lev1"><a href="ch15.xhtml#ch15lev9">Attacking Kerberos</a></p>
		<p class="toc-lev2"><a href="ch15.xhtml#ch15lev10">The Pass-the-Ticket Attack</a></p>
		<p class="toc-lev2"><a href="ch15.xhtml#ch15lev11">The Golden Ticket and DC Sync Attacks</a></p>
		<p class="toc-lev1"><a href="ch15.xhtml#ch15lev12">Exercise: Kerberoasting</a></p>
		<p class="toc-chapa"><a href="ch16.xhtml#ch16"><strong>16<br/>NEXT STEPS</strong></a></p>
		<p class="toc-lev1"><a href="ch16.xhtml#ch16lev1">Setting Up a Hardened Hacking Environment</a></p>
		<p class="toc-lev2"><a href="ch16.xhtml#ch16lev2">Remaining Anonymous with Tor and Tails</a></p>
		<p class="toc-lev2"><a href="ch16.xhtml#ch16lev3">Setting Up a Virtual Private Server</a></p>
		<p class="toc-lev2"><a href="ch16.xhtml#ch16lev4">Setting Up SSH</a></p>
		<p class="toc-lev2"><a href="ch16.xhtml#ch16lev5">Installing Your Hacking Tools</a></p>
		<p class="toc-lev2"><a href="ch16.xhtml#ch16lev6">Hardening the Server</a></p>
		<p class="toc-lev2"><a href="ch16.xhtml#ch16lev7">Auditing Your Hardened Server</a></p>
		<p class="toc-lev1"><a href="ch16.xhtml#ch16lev8">Other Topics</a></p>
		<p class="toc-lev2"><a href="ch16.xhtml#ch16lev9">Software-Defined Radios</a></p>
		<p class="toc-lev2"><a href="ch16.xhtml#ch16lev10">Attacking Cellular Infrastructure</a></p>
		<p class="toc-lev2"><a href="ch16.xhtml#ch16lev11">Escaping the Air Gap</a></p>
		<p class="toc-lev2"><a href="ch16.xhtml#ch16lev12">Reverse Engineering</a></p>
		<p class="toc-lev2"><a href="ch16.xhtml#ch16lev13">Physical Hacking Tools</a></p>
		<p class="toc-lev2"><a href="ch16.xhtml#ch16lev14">Forensics</a></p>
		<p class="toc-lev2"><a href="ch16.xhtml#ch16lev15">Hacking Industrial Systems</a></p>
		<p class="toc-lev2"><a href="ch16.xhtml#ch16lev16">Quantum Computation</a></p>
		<p class="toc-lev1"><a href="ch16.xhtml#ch16lev17">Connect with Others</a></p>
		<p class="toc-chapa"><a href="index.xhtml#index"><strong>INDEX</strong></a></p>
	</body>
</html>