<html><head></head><body>
<h2 class="h2" id="ch09"><a id="page_157"/><strong>9</strong></h2>
<p class="h2a"><strong>ZOMBIE DISTRACTORS</strong></p>
<div class="image1"><img src="graphics/f0001-01.jpg" alt="image"/></div>
<p class="noindent">It doesn’t take much to fool a zombie so you can make a quick escape (see <a href="ch09.html#ch09fig1">Figure 9-1</a>). They are rather lacking in brains, after all. The projects in this chapter are designed to draw zombies’ attention away from you using flashes of light, loud sounds, and decoy movements. Imagine you have a herd of zombies lurching around the garage door but you need to get to your last remaining car battery. These distractors will allow you to draw the zombies away from the door or even lure them into a fatal zombie trap, perhaps involving fire and a big hole in the ground.</p>
<p class="indent">The first project uses flash units from disposable cameras to produce a disorienting series of flashes to confuse the zombies. The second project uses sound and movement to attract the zombies’ attention. Build these projects and affix them to key locations in your base so you can direct zombies away from you.</p>
<div class="image"><a id="page_158"/><img src="graphics/f09-01.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig1">Figure 9-1:</a> Smile please!</p>
<h3 class="h3" id="ch00lev1sec156"><strong>PROJECT 15: ARDUINO FLASH DISTRACTOR</strong></h3>
<p class="noindent">This flash distractor combines an Arduino and old disposable cameras to produce a timed series of flashes that will confound your brain-hungry foes. Proprietors of old-fashioned photo developer stores are often happy for you to take armfuls of used disposable film cameras off their hands. This is especially true if the proprietors are the animated deceased. They might appear to grumble at you, but I assure you, whatever groaning noises they make are entirely coincidental.</p>
<p class="indent"><a href="ch09.html#ch09fig2">Figure 9-2</a> shows the completed zombie flash distractor with three salvaged single-use flash cameras, modified to allow the flashes to be triggered by an Arduino. The three cameras are taped together as a block with all the flashes pointing outward.</p>
<div class="image"><a id="page_159"/><img src="graphics/f09-02.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig2">Figure 9-2:</a> The completed zombie flash distractor</p>
<p class="indent">The three flash modules are arranged so that each one points at a right angle to every other, giving 270 degrees of coverage. You will need a separate Arduino for this project as you will not want to position this right next to your control center.</p>
<div class="note">
<p class="notet"><span class="font1"><strong>WARNING</strong></span></p>
<p class="noindent">If you have a pacemaker or heart problems, or if flashing lights give you seizures, do <span class="underline">not</span> build this project.</p>
</div>
<div class="sidebar">
<p class="sidebart"><strong>WARNING: HIGH VOLTAGES AND BRIGHT FLASHES</strong></p>
<p class="noindent">Flashguns in disposable cameras operate at up to 400V DC. If you want to avoid an unpleasant shock, exercise extreme caution when taking the cameras apart and handling the flash modules. Many parts of the module will be at high voltage and can remain so for hours or even days. Before using the modules, make sure to follow the instructions in “<a href="ch09.html#ch00lev1sec161">Step 3: Make the Camera Safe</a>!” on <a href="ch09.html#page_163">page 163</a> to safely discharge the capacitor.</p>
</div>
<h4 class="h4" id="ch00lev1sec157"><a id="page_160"/><strong>WHAT YOU WILL NEED</strong></h4>
<p class="noindentb">To make this project, you will need the following parts:</p>
<table border="0" cellpadding="0" cellspacing="0" class="topbot" width="100%">
<thead>
<tr>
<th valign="top" class="table_th"><p class="table1"><strong>ITEMS</strong></p></th>
<th valign="top" class="table_th"><p class="table1"><strong>NOTES</strong></p></th>
<th valign="top" class="table_th"><p class="table1"><strong>SOURCE</strong></p></th>
</tr>
</thead>
<tbody>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> Arduino Uno</p></td>
<td valign="top" class="table"><p class="table">Arduino Uno R3</p></td>
<td valign="top" class="table"><p class="table">Adafruit, Fry’s (7224833), Sparkfun</p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> Relay shield</p></td>
<td valign="top" class="table"><p class="table">4-channel relay shield</p></td>
<td valign="top" class="table"><p class="table">eBay, <a href="http://www.sainsmart.com/">http://www.sainsmart.com/</a></p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> Disposable cameras</p></td>
<td valign="top" class="table"><p class="table">3 used disposable flash cameras</p></td>
<td valign="top" class="table"><p class="table">Photo store</p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> 9V battery</p></td>
<td valign="top" class="table"><p class="table">PP3 type 9V battery, or larger 9V or 12V battery pack</p></td>
<td valign="top" class="table"><p class="table">Hardware store</p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> 9V Arduino battery lead</p></td>
<td valign="top" class="table"><p class="table">DC power jack to 9V battery clip adapter</p></td>
<td valign="top" class="table"><p class="table">Adafruit (80), eBay</p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> Double-core wire</p></td>
<td valign="top" class="table"><p class="table">Three 6-inch (15 cm) lengths of bell wire or other double-core wire</p></td>
<td valign="top" class="table"><p class="table">Hardware store, scavenge</p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> Gaffer or electrical tape</p></td>
<td valign="top" class="table"><p class="table"> </p></td>
<td valign="top" class="table"><p class="table">Auto parts store</p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> 100 Ω resistor</p></td>
<td valign="top" class="table"><p class="table">For discharging the camera’s flash capacitor</p></td>
<td valign="top" class="table"><p class="table">Mouser (293-100-RC)</p></td>
</tr>
</tbody>
</table>
<p class="indent">There are few uses for spent disposable cameras and a store’s only alternative is to pay for someone to take them away, so if you ask store owners nicely, they may give you a stack for free.</p>
<p class="indent">Along with a perfectly fine flash module, each camera will generally have an almost unused AA or AAA battery. Try to get a set of cameras that are similar to each other, ideally cameras of the same make. (In the bag of cameras I took away, the most common brand was Fuji, so I based the project on that design. However, the instructions should be sufficiently general to work with any disposable camera.) Also, find cameras that have a switch that turns the flash on for multiple photos, not the sort that make you press the flash button between each shot. For example, look at the camera at the front of <a href="ch09.html#ch09fig2">Figure 9-2</a>. It has a kind of lever that keeps the flash turned on (bottom center of the figure).</p>
<p class="indent">The relay shield was bought on eBay, and when you attach it to the Arduino, it connects a relay to Arduino pins 4, 5, 6, and 7. If you end up with a slightly different relay shield, just check which digital Arduino pins it uses and make the necessary changes in the Arduino sketch (see “<a href="ch11.html#ch00lev1sec215">Software</a>” on <a href="ch09.html#page_166">page 166</a>).</p>
<p class="indent">The 100 Ω resistor is used to discharge the large, high-voltage capacitor used in the flash module to avoid the risk of electric shocks. It plays no other part in the build.</p>
<h4 class="h4" id="ch00lev1sec158"><a id="page_161"/><strong>CONSTRUCTION</strong></h4>
<p class="noindent"><a href="ch09.html#ch09fig3">Figure 9-3</a> shows the wiring involved in this project.</p>
<div class="image"><img src="graphics/f09-03.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig3">Figure 9-3:</a> The flash distractor, spread out</p>
<p class="indent">Each of the disposable cameras has a short length of double-core wire leaving one side of its case. These wires connect to the switch contact inside the camera that is used to trigger the flash. I’ll describe how to create this setup for one camera in construction Steps 2 to 5, and you’ll need to repeat those steps for all three cameras.</p>
<p class="indent">Each pair of leads connects to one pair of relay contacts on the shield so that the Arduino can trigger each flash independently.</p>
<p class="indent">Each camera also has its own AA or AAA battery that powers the flash, while the Arduino and relay shield are powered from a 9V battery connected to the DC barrel jack of the Arduino. This makes the project completely portable, so you can place it wherever needed to create a distraction that lets you escape.</p>
<h5 class="h5" id="ch00lev1sec159"><strong>STEP 1: SORT THE CAMERAS</strong></h5>
<p class="noindent">First, sort your bag of cameras by type. To make this project simpler to build, try to pick out three identical cameras. The modules I used were all Fujifilm, though the branding on the cardboard covers differed.</p>
<div class="note">
<p class="notet"><span class="font1"><strong>WARNING</strong></span></p>
<p class="noindent">Do not try out the Flash of the camera at this stage! It will charge the camera’s capacitor, and you’ll get shocked later when you lever the camera body apart with your fingers. seriously, this really hurts!</p>
</div>
<h5 class="h5" id="ch00lev1sec160"><a id="page_162"/><strong>STEP 2: REMOVE THE TOP CASING FROM A CAMERA</strong></h5>
<p class="noindent">Used cameras may have already been partly disassembled when the photo processor removed the 35mm film canister. The processors do this quickly rather than tidily, so there’ll probably be cardboard and bits of plastic hanging off. <a href="ch09.html#ch09fig4">Figure 9-4</a> shows the steps involved in taking a camera case apart.</p>
<div class="image"><img src="graphics/f09-04.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig4">Figure 9-4:</a> Disassembling a camera</p>
<p class="indent">You are at risk of shock during this step, so take care not to touch the circuit board or any contacts or wires within the camera.</p>
<p class="indent">First, remove the cardboard from the camera body (<a href="ch09.html#ch09fig4">Figure 9-4</a>a). Next, use a flathead screwdriver with a plastic handle (to provide insulation from shock) to lever apart the plastic catches holding the two halves of the camera body together. Remove the front half of the camera case, exposing the PCB and lens (<a href="ch09.html#ch09fig4">Figure 9-4</a>b). Now remove the lens assembly. Break it off if you have to; it’s not needed anymore. This will expose the two contacts shown circled in <a href="ch09.html#ch09fig4">Figure 9-4</a>c, which fire the flash when they are touched together.</p>
<h5 class="h5" id="ch00lev1sec161"><a id="page_163"/><strong>STEP 3: MAKE THE CAMERA SAFE!</strong></h5>
<p class="noindent">Before you have rendered the camera module safe, treat it the same way you would a small but vicious rodent. Don’t handle it directly. If you need to move it around or flip it over, poke it with something like a plastic pen. Otherwise, you might injure yourself, and you need to be in top condition to stay ahead of the zombies.</p>
<p class="indent">Identify the flash module’s capacitor. The capacitor will be a large metallic cylinder with two leads connecting it to the PCB. The capacitor stores all the energy that is rapidly discharged into the flash to set it off. In <a href="ch09.html#ch09fig5">Figure 9-5</a>, the entire flash module has been removed from the camera body to make it easier to see the capacitor, but follow the capacitor discharge steps below without removing the whole PCB if you can.</p>
<div class="image"><img src="graphics/f09-05.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig5">Figure 9-5:</a> Discharging the capacitor</p>
<p class="indent">To discharge the flash module’s capacitor, bend the legs of your 100 Ω resistor so they are roughly as far apart as the legs of the capacitor. Gently grip the body of the resistor with pliers (with insulated handles) and touch the resistor leads across the capacitor leads. If the capacitor is charged, there will probably be a very small spark. Hold the resistor in place for a second or so to make sure the capacitor actually discharges.</p>
<p class="indent">Now, check whether the capacitor is empty by measuring the voltage with your voltmeter set to its maximum DC voltage range. (The voltage range needs to be 500V or more.) It doesn’t matter if there are a few volts left in the capacitor, but if you see more than 10V, then discharge it a bit longer with the resistor. Once the voltage is below 10V, it is safe for you to handle the PCB without fear of electrical shock.</p>
<h5 class="h5" id="ch00lev1sec162"><a id="page_164"/><strong>STEP 4: ATTACH LEADS TO THE TRIGGER CONTACTS</strong></h5>
<p class="noindent">Solder about 6 inches (15 cm) of double-core wire to the flash contacts, as shown in <a href="ch09.html#ch09fig6">Figure 9-6</a>. In the camera I used, there was a handy plastic peg that allowed the two contacts to be kept well apart. If this is not the case for your camera, then you may need to wrap the soldered contacts in electrical insulating tape or put heatshrink over the contacts to keep them apart.</p>
<div class="image"><img src="graphics/f09-06.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig6">Figure 9-6:</a> Leads soldered to the trigger contacts</p>
<h5 class="h5" id="ch00lev1sec163"><strong>STEP 5: REASSEMBLE AND TEST THE MODIFIED FLASH MODULE</strong></h5>
<p class="noindent">Fit the front cover of the camera back on, allowing the double-core wire to escape through one side of the camera. If you need more space to snake the wires out, use a pair of diagonal cutters to cut a hole in the plastic cover.</p>
<p class="indent">Test this flash before repeating the procedure for the other two cameras. The trigger contacts of these cameras are sometimes at 400V, so for safety, use a screwdriver with an insulated handle.</p>
<p class="indent">Turn on the flash switch for the camera. You should see a charging light or LED come on. The camera will probably make a whining noise as the flash charges. This sound is created by the capacitor filling up. When you think the charging is complete (or after, say, 10 seconds), use the screwdriver to connect the two trigger leads, as shown in <a href="ch09.html#ch09fig7">Figure 9-7</a>.</p>
<p class="indent">The camera should flash when you connect the leads with the screwdriver. Hurray! That’s one camera ready for action. Before moving on to Step 6, repeat Steps 2 through 5 for the other two cameras.</p>
<div class="image"><a id="page_165"/><img src="graphics/f09-07.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig7">Figure 9-7:</a> Testing the modified camera</p>
<h5 class="h5" id="ch00lev1sec164"><strong>STEP 6: CONNECT THE CAMERAS TO THE RELAY SHIELD</strong></h5>
<p class="noindent">Fit the relay shield onto your Arduino, making sure that all the pins of the shield engage properly with the sockets on the Arduino.</p>
<p class="indent"><a href="ch09.html#ch09fig8">Figure 9-8</a> shows how the cameras are wired up to the relay shield.</p>
<div class="image"><img src="graphics/f09-08.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig8">Figure 9-8:</a> Attaching leads from the cameras to the relay shield’s trigger contacts</p>
<p class="indent"><a id="page_166"/>Each relay on the relay shield has three screw terminals: NO, COM, and NC. When the relay is not activated, the terminals NC and COM are connected, but when the relay is activated, COM becomes connected to NO. This means that the leads to each camera need to go into the COM and NO connections of each relay. It does not matter which way around the leads go.</p>
<p class="indent">When your cameras are connected to their relays, attach the battery clip–to–barrel jack adapter to the Arduino, as shown in <a href="ch09.html#ch09fig9">Figure 9-9</a>.</p>
<div class="image"><img src="graphics/f09-09.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig9">Figure 9-9:</a> Attaching the battery lead to the Arduino</p>
<p class="indent">Before attaching the battery itself, however, you need to upload the software for the project, so you may as well power the Arduino from the USB lead while you program it.</p>
<h4 class="h4" id="ch00lev1sec165"><strong>SOFTWARE</strong></h4>
<p class="noindent">All the source code for this book is available at <em><a href="http://www.nostarch.com/zombies/">http://www.nostarch.com/zombies/</a></em>. Visit the link provided there and download the code now, if you’ve not done so already. See <a href="app03.html#app03">Appendix C</a> for instructions on how to install the Arduino sketch.</p>
<p class="indent">The Arduino sketch for this project is called <em>Project_15_Flasher</em>, and it’s in the source file directory of the same name. I’ll walk you through this sketch now.</p>
<p class="indent">To begin, we define a constant integer array, <code>flashPins</code>:</p>
<pre>const int flashPins[] = {7, 6, 5};</pre>
<p class="indent"><a id="page_167"/>The <code>flashPins</code> array defines the Arduino pins used to trigger each of the flash modules. Change these pin numbers if your relay shield uses different pins to control the relays.</p>
<p class="indent">Next, we define two more constants, which you can alter to adjust the zombie distractor:</p>
<pre>const long overallDelay = 20; // seconds<br/>const long delayBetweenFlashes = 1; // seconds </pre>
<p class="indent">The <code>overallDelay</code> constant determines how many seconds elapse between each flashing cycle. This value is set to 20 seconds by default. Note, this delay needs to be long enough to enable the capacitor inside the camera to recharge.</p>
<p class="indent">The <code>delayBetweenFlashes</code> value sets the gap between each of the flashes being triggered in a cycle. This is set to one second by default. Note that both constants are <code>long</code> rather than <code>int</code>. That’s because <code>int</code> constants have a maximum value of +/–32,767, which would give a maximum delay of 32.767 seconds; that might not be long enough to keep a zombie distracted while you escape. Fortunately, the <code>long</code> data type has a maximum value of over +/–2,000,000. You can run a long way in 2,000 seconds!</p>
<p class="indent">Now we add a <code>setup</code> function:</p>
<pre>void setup()<br/>{<br/>  pinMode(flashPins[0], OUTPUT);<br/>  pinMode(flashPins[1], OUTPUT);<br/>  pinMode(flashPins[2], OUTPUT);<br/>}</pre>
<p class="indent">The <code>setup</code> function sets all the relay pins to be digital outputs.</p>
<p class="indent">With the <code>pinMode</code> functions in place, we add a short <code>loop</code> function:</p>
<pre>void loop()<br/>{<br/>  flashCircle();<br/>  delay(overallDelay * 1000);<br/>}</pre>
<p class="indent">This <code>loop</code> function calls the <code>flashCircle</code> function and waits for <code>overallDelay</code> <em>seconds</em> before starting the whole process again.</p>
<p class="indent">Let’s look at the <code>flashCircle</code> function definition now:</p>
<pre>void flashCircle()<br/>{<br/>  for (int i = 0; i &lt; 3; i++)<br/>  {<br/>    digitalWrite(flashPins[i], HIGH);<br/>    delay(200);<br/><a id="page_168"/>    digitalWrite(flashPins[i], LOW);<br/>    delay(delayBetweenFlashes * 1000);<br/>  }</pre>
<p class="indent">This function loops over the flash pins and gives each a <code>HIGH</code> pulse for 200 milliseconds, setting off the flash. There is then a pause before the next flash, set by <code>delayBetweenFlashes</code>. The value of <code>delayBetweenFlashes</code> is multiplied by 1,000 because in Arduino, the <code>delay</code> function’s parameter is in milliseconds.</p>
<h4 class="h4" id="ch00lev1sec166"><strong>USING THE FLASH DISTRACTOR</strong></h4>
<p class="noindent">Before you tape together all the parts of the flash distractor, test it with the parts laid out as shown in <a href="ch09.html#ch09fig3">Figure 9-3</a>. Turn on the flash switches of each camera and attach the 9V battery to the battery clip. The flash units should flash in turn, before pausing for 20 seconds and then repeating the cycle.</p>
<p class="indent">When you know your Arduino can activate the flashes, tape everything together, or if you prefer, stick the cameras together with a hot glue gun. Make sure to leave yourself access to the cameras’ battery compartments so you can change the batteries.</p>
<p class="indent">The small 9V battery that powers the Arduino will probably last about four or five hours. If you need to power the distractor for longer, then <a href="ch09.html#ch09fig10">Figure 9-10</a> shows some other options.</p>
<div class="image"><img src="graphics/f09-10.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig10">Figure 9-10:</a> Options for powering the Arduino</p>
<p class="indent"><a id="page_169"/>A 6 × AA battery holder will last around 10 times as long as the PP3 9V battery, but for the ultimate battery duration, you can use one of your car batteries with the cigarette lighter–to–barrel jack adapter shown on the left of <a href="ch09.html#ch09fig10">Figure 9-10</a>. However, the AA batteries in the cameras won’t last more than a few hundred flashes before they need replacing, so if you plan to reuse your distractors—as you might if you’re in a zombie-rich neighborhood—keep an extra set of batteries on you.</p>
<p class="indent">I suggest you stockpile a few flash distractors and always keep one complete unit in your bag when you venture out for supplies or reconnaissance. Then, if there’s a mob of zombies between you and that grocery store you want to scavenge from, just set up the distractor, wait out of sight as it draws the zombies, and when the coast is clear, make a stealthy dash for the doors.</p>
<p class="indent">You might want to use the flash distractor in combination with the next project to maximize your ability to distract the undead.</p>
<div class="note">
<p class="notet"><span class="font1"><strong>NOTE</strong></span></p>
<p class="noindent">This project has no on/off switch, so when you are not using it, unplug the 9V battery and turn off the flash switches on the cameras. You could also use an in-line power switch like this: <a href="https://www.adafruit.com/products/1125/">https://www.adafruit.com/products/1125/</a>.</p>
</div>
<h3 class="h3" id="ch00lev1sec167"><strong>PROJECT 16: ARDUINO MOVEMENT AND SOUND DISTRACTOR</strong></h3>
<p class="noindent">Remember the smoke alarm that we used to make “<a href="ch07.html#ch00lev1sec121">Project 11: Quiet Fire Alarm</a>” on <a href="ch07.html#page_120">page 120</a>? In this project, we’ll use the piezo buzzer we removed from that smoke alarm, along with a waving flag powered by a servo motor, to make a lot of distracting noise and movement.</p>
<p class="indent"><a href="ch09.html#ch09fig11">Figure 9-11</a> shows the project in action. Next to the project, I’ve shown a coiled cigarette lighter adapter, which you can use as an alternative to the AA battery pack if you want to power the setup from a car battery for long-term usage.</p>
<div class="image"><img src="graphics/f09-11.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig11">Figure 9-11:</a> Sound and movement in disharmony</p>
<h4 class="h4" id="ch00lev1sec168"><a id="page_170"/><strong>WHAT YOU WILL NEED</strong></h4>
<p class="noindentb">To make this project, you will need the following parts:</p>
<table border="0" cellpadding="0" cellspacing="0" class="topbot" width="100%">
<thead>
<tr>
<th valign="top" class="table_th"><p class="table1"><strong>ITEMS</strong></p></th>
<th valign="top" class="table_th"><p class="table1"><strong>NOTES</strong></p></th>
<th valign="top" class="table_th"><p class="table1"><strong>SOURCE</strong></p></th>
</tr>
</thead>
<tbody>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> Arduino Uno</p></td>
<td valign="top" class="table"><p class="table">Arduino Uno R3</p></td>
<td valign="top" class="table"><p class="table">Adafruit, Fry’s (7224833), Sparkfun</p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> 6 × AA battery holder</p></td>
<td valign="top" class="table"><p class="table">9V battery pack</p></td>
<td valign="top" class="table"><p class="table">Adafruit (248)</p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> 9V Arduino battery lead</p></td>
<td valign="top" class="table"><p class="table">DC power jack-to-9V battery clip adapter</p></td>
<td valign="top" class="table"><p class="table">Adafruit (80), eBay</p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> Jumper wires</p></td>
<td valign="top" class="table"><p class="table">3 long male-to-male jumper wires</p></td>
<td valign="top" class="table"><p class="table">Adafruit (760)</p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> 100 Ω Resistor</p></td>
<td valign="top" class="table"><p class="table">2W or 1/4W</p></td>
<td valign="top" class="table"><p class="table">Mouser (594-5083NW100R0J or 293-100-RC)</p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> Pin header</p></td>
<td valign="top" class="table"><p class="table">2-way pin header</p></td>
<td valign="top" class="table"><p class="table">Adafruit (392), eBay</p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> Servo motor</p></td>
<td valign="top" class="table"><p class="table">Small or standard</p></td>
<td valign="top" class="table"><p class="table">Adafruit (155 or 196), eBay, hobby store</p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> Buzzer</p></td>
<td valign="top" class="table"><p class="table">Discarded from the smoke detector of Project 11 or another high-volume buzzer</p></td>
<td valign="top" class="table"><p class="table">Security store, smoke alarm</p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> Wooden upright (a post or rod)</p></td>
<td valign="top" class="table"><p class="table"> </p></td>
<td valign="top" class="table"><p class="table">Hardware store</p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> Base</p></td>
<td valign="top" class="table"><p class="table">Wood or plastic, for attachment of the upright</p></td>
<td valign="top" class="table"><p class="table">Hardware store</p></td>
</tr>
<tr>
<td valign="top" class="table"><p class="table-b"><img src="graphics/square.jpg" alt="image"/> Wooden food skewer and paper</p></td>
<td valign="top" class="table"><p class="table">To make a flag</p></td>
<td valign="top" class="table"><p class="table">Household items</p></td>
</tr>
</tbody>
</table>
<p class="indent">The power for this project is supplied through the Arduino barrel jack. The same power options as used in “<a href="ch09.html#ch00lev1sec156">Project 15: Arduino Flash Distractor</a>” on <a href="ch09.html#page_158">page 158</a> also apply to this project.</p>
<p class="indent">If you just want to wave a small, lightweight flag like the one shown in <a href="ch09.html#ch09fig11">Figure 9-11</a>, a small servo motor will work just fine, but for something bigger, use a standard servo. Just be aware that if you use a bigger servo, you may find that your Arduino resets because of voltage drops caused by the load of the bigger motor. In this case, you can power the servo from a separate 6V battery pack as described at <em><a href="http://communityofrobots.com/tutorial/kawal/how-connect-servo-arduino/">http://communityofrobots.com/tutorial/kawal/how-connect-servo-arduino/</a></em>.</p>
<p class="indent">Also note that while this project is intended to use the buzzer removed from the smoke detector of “<a href="ch07.html#ch00lev1sec121">Project 11: Quiet Fire Alarm</a>” on <a href="ch07.html#page_120">page 120</a>, you can also just use a new buzzer.</p>
<h4 class="h4" id="ch00lev1sec169"><a id="page_171"/><strong>CONSTRUCTION</strong></h4>
<p class="noindent"><a href="ch09.html#ch09fig12">Figure 9-12</a> shows the wiring diagram for the project.</p>
<div class="image"><img src="graphics/f09-12.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig12">Figure 9-12:</a> Wiring diagram for the distractor</p>
<p class="indent">The male-to-male jumper wires in the supply list will link the servo motor, which terminates in a three-way socket, to the Arduino. You’ll connect the resistor and one buzzer lead to a pair of header pins so that you can plug the buzzer into the Arduino, too.</p>
<h5 class="h5" id="ch00lev1sec170"><strong>STEP 1: REMOVE THE PIEZO BUZZER FROM THE SMOKE ALARM COVER</strong></h5>
<p class="noindent">The smoke alarm’s buzzer may be integrated into the smoke alarm cover. In that case, don’t try to remove the buzzer; you can use it while it’s still attached to the cover, or you can just scavenge a different buzzer. If the buzzer looks like it will come away, then remove it as shown in <a href="ch09.html#ch09fig13">Figure 9-13</a> to make the project a little more compact.</p>
<div class="image"><a id="page_172"/><img src="graphics/f09-13.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig13">Figure 9-13:</a> Removing the buzzer from the smoke alarm cover</p>
<h5 class="h5" id="ch00lev1sec171"><strong>STEP 2: SOLDER THE HEADER PINS, BUZZER, AND RESISTOR</strong></h5>
<p class="noindent">Check your buzzer: you only need two buzzer leads, so if it has three, see “<a href="ch07.html#ch00lev1sec121">Project 11: Quiet Fire Alarm</a>” on <a href="ch07.html#page_120">page 120</a> to work out which two of the three leads you need.</p>
<p class="indent">Once you have that cleared up, solder the 100 Ω resistor to one buzzer lead—it doesn’t matter which one. Solder the other end of the resistor to one of the header pins and the other buzzer lead to the other header pin. You may wish to strengthen these soldered connections using heatshrink (see “<a href="app02.html#ch00lev1sec230">Using Heatshrink</a>” on <a href="app02.html#page_235">page 235</a>) or electrical tape. These connections are shown in <a href="ch09.html#ch09fig14">Figure 9-14</a>.</p>
<div class="image"><img src="graphics/f09-14.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig14">Figure 9-14:</a> Soldering the buzzer, resistor, and header pins</p>
<h5 class="h5" id="ch00lev1sec172"><a id="page_173"/><strong>STEP 3: TEST THE PIEZO SOUNDER</strong></h5>
<p class="noindent">Before we go further, we’ll test the buzzer using the USB connection to power the Arduino. This step will help us find the optimum frequency of the buzzer to make it as loud as possible.</p>
<p class="indent">Plug the header pins into the Arduino pins 8 and 9. It does not matter which way around the pins are (<a href="ch09.html#ch09fig15">Figure 9-15</a>).</p>
<div class="image"><img src="graphics/f09-15.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig15">Figure 9-15:</a> Connecting the buzzer to the Arduino</p>
<p class="indent">If you haven’t downloaded all of this book’s programs yet, go to <em><a href="https://www.nostarch.com/zombies/">https://www.nostarch.com/zombies/</a></em> and download the <em>Project_16_Sounder_Test</em> Arduino sketch. Load this sketch onto your Arduino and then open the serial monitor (<a href="ch09.html#ch09fig16">Figure 9-16</a>). This is not the final sketch for the project; it’s just a test sketch that will let us find the best frequency value to use in the main sketch.</p>
<div class="image"><img src="graphics/f09-16.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig16">Figure 9-16:</a> Setting the frequency using the serial monitor</p>
<p class="indent">In the input field, enter <span class="codestrong">4000</span> and click <strong>Send</strong>—this number is the frequency of the sound your buzzer will emit. You should hear a very loud sound at that frequency for a second. Try entering different frequency values to find the one that gives the highest volume; it will probably be around <code>4000</code>.</p>
<p class="indent"><a id="page_174"/>To reduce the strain on your ears, you can turn the buzzer over or cover the hole where the sound emerges to muffle the volume. When you have found the optimum frequency, make a note of the value.</p>
<div class="note">
<p class="notet"><span class="font1"><strong>NOTE</strong></span></p>
<p class="noindent">This is definitely something to do when there are no zombies around.</p>
</div>
<div class="sidebar">
<p class="sidebart"><strong>PIEZO BUZZERS</strong></p>
<p class="noindent">Piezo buzzers (also called sounders) contain crystals that change shape when a current is passed through them. The current changes hundreds of times per second, and as the crystals change shape, sound waves are produced. Although you can drive a piezo buzzer by connecting one lead to GND and supplying a signal to the other lead, you get a higher volume by using two Arduino outputs to completely reverse the polarity of the buzzer with each cycle. <a href="ch09.html#ch09fig17">Figure 9-17</a> shows how this works.</p>
<div class="image"><img src="graphics/f09-17.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig17">Figure 9-17:</a> Generating an alternating voltage on the piezo buzzer with an Arduino. Pins A and B are outputs on the Arduino.</p>
<p class="indent">When one Arduino output is high, the other is low and vice versa. This complete reversal of the polarity across the piezo buzzer effectively allows a 10V peak swing of voltage across the buzzer rather than the 5V obtainable from just switching one pin.</p>
<p class="indent">Your distractor will not be as loud as the original smoke detector, which typically uses the same trick but with 9V rather than 5V. However, it should be pretty loud.</p>
</div>
<h5 class="h5" id="ch00lev1sec173"><a id="page_175"/><strong>STEP 4: MAKE A FLAG</strong></h5>
<p class="noindent">My distractor waves a flag, but yours doesn’t have to. Once you have the servo moving, you can attach pretty much anything that will attract the attention of zombies. Try a scrap of rotting meat to get a good zombie-attracting scent going, or if your servo is powerful enough, you might salvage a severed hand for a more realistic human distraction.</p>
<p class="indent">Assuming that you just want to wave a flag, the simple arrangement from <a href="ch09.html#ch09fig11">Figure 9-11</a> uses a piece of paper folded and glued to a wooden kebab skewer.</p>
<h5 class="h5" id="ch00lev1sec174"><strong>STEP 5: ATTACH THE FLAG TO THE SERVO MOTOR</strong></h5>
<p class="noindent">Servo motors generally come with a range of arms and a retaining screw to fix the arm in place on the motor. In this project, I chose the wheel fixture and glued the skewer to it with strong epoxy glue (<a href="ch09.html#ch09fig18">Figure 9-18</a>).</p>
<div class="image"><img src="graphics/f09-18.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig18">Figure 9-18:</a> Attaching the flag to the servo</p>
<p class="indent">Don’t fit the servo motor’s retaining screw just yet, as you will need to adjust the position of the servo arm to accommodate the range of movement (around 160 degrees) once the whole project is up and running.</p>
<h5 class="h5" id="ch00lev1sec175"><strong>STEP 6: ATTACH THE SERVO MOTOR TO A BASE</strong></h5>
<p class="noindent">For an upright to attach to the servo motor, I’ve used a length of wood. To attach the servo, cut a little notch in the wood to fit the servo using a wood saw or small electric hobby cutter. Then use the servo mounting holes and some small screws to fix the servo in place.</p>
<p class="indent"><a id="page_176"/>As an exercise in ingenuity, I’ll leave it up to you to find the best way to attach your servo to your upright. Here, I used a small piece of scrap aluminum to hold the servo in the notch. Epoxy glue would also work.</p>
<p class="indent">Now, attach the upright to a base. I drilled a hole in the underside of a flat piece of acrylic and attached the wooden upright with a screw. You may prefer to fix the upright directly to some existing structure, rather than using a freestanding arrangement. (Again, I’ll leave the details to your discretion.)</p>
<p class="indent">I used the Arduino mounting holes and two more screws to fix the Arduino to the upright as well, but this is entirely optional. Similarly, I stuck the buzzer onto the upright with some glue (<a href="ch09.html#ch09fig19">Figure 9-19</a>).</p>
<div class="image"><img src="graphics/f09-19.jpg" alt="image"/></div>
<p class="figuret"><a id="ch09fig19">Figure 9-19:</a> Attaching the Arduino and buzzer to the upright</p>
<h5 class="h5" id="ch00lev1sec176"><strong>STEP 7: CONNECTING THE SERVO</strong></h5>
<p class="noindent">Servo motors have leads with three connections that terminate in a single three-hole socket: the black or brown lead is the ground connection, the red lead is the positive power supply, and the third orange or yellow lead is the control signal.</p>
<p class="indent">To begin wiring, plug the three male-to-male header leads into the servo’s three-hole socket. Run the orange (or yellow) control lead of the servo to pin 10 of the Arduino. Run the black (or brown) ground lead to one of the GND terminals on the Arduino. Finally, connect the red positive supply of <a id="page_177"/>the servo to the 5V Arduino pin. Remember: if you are using a large servo, you will probably need an external 6V battery pack, as discussed in “<a href="ch11.html#ch00lev1sec207">What You Will Need</a>” on <a href="ch09.html#page_170">page 170</a>.</p>
<h4 class="h4" id="ch00lev1sec177"><strong>SOFTWARE</strong></h4>
<p class="noindent">All the source code for this book is available from <em><a href="http://www.nostarch.com/zombies/">http://www.nostarch.com/zombies/</a></em>, and the Arduino sketch for this project is called <em>Project_16_sound_ movement</em>. Download it now and load it onto your Arduino. If you need a refresher on how, follow the directions in <a href="app03.html#app03">Appendix C</a>.</p>
<p class="indent">Servos are often used with Arduinos, so there is a built-in library that makes them easy to use together. We import this library at the top of the sketch.</p>
<pre>#include &lt;Servo.h&gt; </pre>
<p class="indent">Three constants define the behavior of the servo, and tweaking the values of these constants will alter the servo’s actions:</p>
<pre>const int minServoAngle = 10;<br/>const int maxServoAngle = 170;<br/>const int stepPause = 5;</pre>
<p class="indent">Servos have a range of movement of 180 degrees. The constants <code>minServoAngle</code> and <code>maxServoAngle</code> restrict this range between 10 and 170 degrees rather than the full 0 to 180 degrees, because most servos struggle to cover the full 180 degrees.</p>
<p class="indent">The constant <code>stepPause</code> sets the delay in milliseconds between each movement of the servo. If you really want to grab a zombie’s attention, reduce this number to make the servo move more quickly.</p>
<p class="indent">In the next section of code, we define constants for each Arduino pin used.</p>
<pre>const int sounderPinA = 8;<br/>const int sounderPinB = 9;<br/>const int servoPin = 10;</pre>
<p class="indent">A final constant called <code>f</code> specifies the buzzer frequency:</p>
<pre>const long f = 3800; // Find f using Project_16_sounder_test</pre>
<p class="indent">Set <code>f</code> to your buzzer’s loudest frequency, which you should have noted in “<a href="ch09.html#ch00lev1sec172">Step 3: Test the Piezo Sounder</a>” on <a href="ch09.html#page_173">page 173</a>.</p>
<p class="indent">Next, to use the servo library, we define a <code>Servo</code> object called <code>arm</code>:</p>
<pre>Servo arm;</pre>
<p class="indent"><a id="page_178"/>With all the constants and global variables defined, we add a <code>setup</code> function to initialize the servo and define the two pins used for the buzzer:</p>
<pre>void setup()<br/>{<br/>  arm.attach(servoPin);<br/>  pinMode(sounderPinA, OUTPUT);<br/>  pinMode(sounderPinB, OUTPUT);<br/>}</pre>
<p class="indent">The <code>loop</code> function that follows calls two functions to wave the flag and to sound the buzzer:</p>
<pre>void loop()<br/>{<br/>  wave();<br/>  wave();<br/>  makeNoise();<br/>}</pre>
<p class="indent">The <code>wave</code> function is called twice to waggle the flag back and forth. In case a bit of movement isn’t enough to catch a zombie’s attention, <code>makeNoise</code> is also called to sound the buzzer. With any luck, the zombies will mistake the noises and movement for something with a brain and will head straight for the distraction!</p>
<p class="indent">At the end of the sketch, define the functions that cause the distractions:</p>
<pre>void wave()<br/>{<br/>  // Wave vigorously from left to right<br/>  for (int angle = minServoAngle; angle &lt; maxServoAngle; angle++)<br/>  {<br/>    arm.write(angle);<br/>    delay(stepPause);<br/>  }<br/>  for (int angle = maxServoAngle; angle &gt; minServoAngle; angle--)<br/>  {<br/>    arm.write(angle);<br/>    delay(stepPause);<br/>  }<br/>}</pre>
<p class="indent">The <code>wave</code> function contains two loops: one loop moves the servo from its minimum to its maximum angle at the preselected speed, and the second loop does the reverse.</p>
<p class="indent"><a id="page_179"/>Now, let’s look at <code>makeNoise</code>:</p>
<pre>void makeNoise()<br/>{<br/>  for (int i = 0; i &lt; 5; i++)<br/>  {<br/>    beep(500);<br/>    delay(1000);<br/>  }<br/>}</pre>
<p class="indent">This function contains a loop that calls the <code>beep</code> function five times for five beeps of the buzzer. The parameter to <code>beep</code> is the duration of the sound in milliseconds (in this case, 500). Between each beep there is a delay of one second (1000 milliseconds).</p>
<div class="note">
<p class="notet"><span class="font1"><strong>NOTE</strong></span></p>
<p class="noindent">If using the same values all the time causes local zombies to become immune to your distractor’s effects, try tweaking the numbers you pass to <span class="codestrong">beep</span> and <span class="codestrong">delay</span>. You could even randomize the values, using Arduino’s <span class="codestrong">random()</span> function.</p>
</div>
<p class="indent">The <code>beep</code> function itself generates the AC signal on the two buzzer pins:</p>
<pre>   void beep(long duration)<br/>   {<br/><span class="ent">➊</span>   long sounderPeriodMicros = 500000l / f;<br/><span class="ent">➋</span>   long cycles = (duration * 1000) / sounderPeriodMicros / 2;<br/>     for (int i = 0; i &lt; cycles; i++)<br/>     {<br/>       digitalWrite(sounderPinA, HIGH);<br/>       digitalWrite(sounderPinB, LOW);<br/>       delayMicroseconds(sounderPeriodMicros);<br/>       digitalWrite(sounderPinA, LOW);<br/>       digitalWrite(sounderPinB, HIGH);<br/>       delayMicroseconds(sounderPeriodMicros); <br/>     }<br/>   }</pre>
<p class="indent">First, we calculate the period of each oscillation <span class="ent">➊</span> using the frequency <code>f</code>. The resulting value must be further divided by 2 <span class="ent">➋</span>, because what we really want is the duration of delay between swapping the polarity of the pins, and we need two such delays for a complete oscillation.</p>
<p class="indent">Using that divided period, the <code>beep</code> function calculates the total number of cycles needed to produce a beep of the correct duration. The <code>for</code> loop that follows uses this information to generate the pulses that are needed.</p>
<h4 class="h4" id="ch00lev1sec178"><a id="page_180"/><strong>USING THE SOUND AND MOVEMENT DISTRACTOR</strong></h4>
<p class="noindent">Both of the projects in this chapter need to be kept dry. To weatherproof the sound and movement distractor, you might craft some kind of housing or protective roof shelter. If your build is freestanding, a large plastic bin with a lid could do the trick. I’m sure you can scavenge one from the nearest abandoned discount retail store.</p>
<p class="indent">Just cut off one side of the bin so the zombies can see and hear the distractor, affix the project itself to the lid, and snap the bin on top, upside down. Attach this box to a lever and pulley system, and you could even lower it to the ground from the safety of your base, creating a new sport: zombie fishing. Who says you can’t have fun during an apocalypse?</p>
<p class="indentb">Of course, the sound and movement distractor has many practical postapocalyptic uses, too:</p>
<p class="bull">• Place it opposite the most vulnerable point in your stronghold to draw away attacking zombie hordes and give you time to reinforce your bunker.</p>
<p class="bull">• Plant it by your zombie pit to draw them into the trap.</p>
<p class="bull">• Sneak it into your neighbor’s yard to thin out the competition for survivor salvage.</p>
<p class="indentt">In case you want to find other survivors (whether to join forces or avoid them), in the next chapter, we’ll look at using wireless technology to communicate.</p>
</body></html>