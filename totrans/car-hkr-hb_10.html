<html><head></head><body>
<h2 class="h2" id="ch10"><span epub:type="pagebreak" id="page_177"/><strong><span class="big">10</span></strong><br/><strong>VEHICLE-TO-VEHICLE COMMUNICATION</strong></h2>&#13;
<div class="image1"><img src="graphics/common-01.jpg" alt="image"/></div>&#13;
<p class="noindent">The latest trend in vehicle technology is <em>vehicle-to-vehicle (V2V) communication</em>—or in the case of vehicles communicating with roadside devices, <em>vehicle-to-infrastructure (V2I) communication</em>. V2V communication is primarily designed to communicate safety and traffic warnings to vehicles through a dynamic mesh network between vehicles and roadside devices called the <em>intelligent transportation system</em>. This mesh connects various nodes—vehicles or devices—in the network and relays information between them.</p>&#13;
<p class="indent">The promise of V2V is so great that in February 2014 the US Department of Transportation announced its desire to implement a mandate requiring that V2V-based communication be included in all new light vehicles, though as of this writing nothing has been finalized.</p>&#13;
<p class="indent">V2V is the first automotive protocol to consider cybersecurity threats at the design stage, rather than after the fact. The details of V2V implementation and interoperation between countries are still being determined, so many processes and security measures are still undecided. Nevertheless, in <span epub:type="pagebreak" id="page_178"/>this chapter, we’ll review the current design considerations in an attempt to offer guidelines for what to expect. We’ll detail the thinking behind different approaches and discuss the types of technologies likely to be deployed in the V2V space. We’ll also discuss several protocols used in V2V communications and the types of data they’ll transmit, and we’ll review V2V’s security considerations as well as areas for security researchers to focus on.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="bgblack">NOTE</span></strong></p>&#13;
<p class="notep"><em>Because this chapter focuses on a technology yet to be implemented, we won’t cover the reasons behind various features, nor will we discuss the ways that manufacturers can implement each feature because all of that detail is subject to change.</em></p>&#13;
</div>&#13;
<h3 class="h3" id="ch10lev1sec1"><strong>Methods of V2V Communication</strong></h3>&#13;
<p class="noindent">In the world of V2V communication, vehicles and roadside devices interact in one of three ways: via existing cellular networks; using <em>dedicated short-range communication (DSRC)</em>, which is a short-range communication protocol; or via a combination of communication methods. In this chapter we’ll focus on DSRC, as it’s the most common method of V2V communication.</p>&#13;
<p class="term"><strong>Cellular Networks</strong></p>&#13;
<p class="termlist">Cellular communication doesn’t require roadside sensors, and existing cellular networks already have a security system in place, so communication can rely on security methods provided by the cellular carriers. The security provided by cellular networks is at the wireless level (GSM), not the protocol level. If the connected device is using IP traffic, then standard IP security, such as an encryption and reduction of attack surfaces, still needs to be applied.</p>&#13;
<p class="term"><strong>DSRC</strong></p>&#13;
<p class="termlist">DSRC requires the installation of specialized equipment in modern vehicles and new roadside equipment. Because DSRC is designed specifically for V2V communication, security measures can be implemented prior to widespread adoption. DSRC is also more reliable than cellular communication, with lower latency. (See “<a href="ch10.html#ch10lev1sec2">The DSRC Protocol</a>” on <a href="ch10.html#page_179">page 179</a> for more on DSRC.)</p>&#13;
<p class="term"><strong>Hybrid</strong></p>&#13;
<p class="termlista">The hybrid approach combines cellular networks with DSRC, Wi-Fi, satellite, and any other communication that makes sense, such as future wireless communication protocols.</p>&#13;
<p class="termlisti">In this chapter, we’ll focus on DSRC because it’s unique to the V2V infrastructure. The DSRC protocol will be the main protocol deployed by V2V, and you may see it mixed with other communication methods.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="bgblack">NOTE</span></strong></p>&#13;
<p class="notep"><em>You can use traditional methods to analyze communication, such as cellular, Wi-Fi, satellite, and so on. Evidence of these signals communicating doesn’t necessarily mean the vehicle is using V2V communication. However, if you see DSRC being transmitted, you’ll know that V2V has been implemented in that vehicle.</em></p>&#13;
</div>&#13;
<div class="box1">&#13;
<p class="boxtitle"><span epub:type="pagebreak" id="page_179"/><strong>FUN WITH V2V ACRONYMS</strong></p>&#13;
<p class="noindentb">The auto industry loves acronyms as much as any government does, and V2V is no exception. In fact, the lack of any universal V2V standard between countries means that the world of V2V acronyms can be especially messy because there’s little consistency and a good dose of confusion. To help you out, here are some acronyms that you’ll run into when researching V2V-related topics:</p>&#13;
<p class="noindent"><strong>ASD</strong> Aftermarket safety device</p>&#13;
<p class="noindent"><strong>DSRC</strong> Dedicated short-range communication</p>&#13;
<p class="noindent"><strong>OBE</strong> Onboard equipment</p>&#13;
<p class="noindent"><strong>RSE</strong> Roadside equipment</p>&#13;
<p class="noindent"><strong>SCMS</strong> Security Credentials Management System</p>&#13;
<p class="noindent"><strong>V2I, C2I</strong> Vehicle-to-infrastructure, or car-to-infrastructure (Europe)</p>&#13;
<p class="noindent"><strong>V2V, C2C</strong> Vehicle-to-vehicle, or car-to-car (Europe)</p>&#13;
<p class="noindent"><strong>V2X, C2X</strong> Vehicle-to-anything, or car-to-anything (Europe)</p>&#13;
<p class="noindent"><strong>VAD</strong> Vehicle awareness device</p>&#13;
<p class="noindent"><strong>VII, ITS</strong> Vehicle infrastructure integration, intelligent transportation system</p>&#13;
<p class="noindent"><strong>WAVE</strong> Wireless access for vehicle environments</p>&#13;
<p class="noindent"><strong>WSMP</strong> WAVE short-message protocol</p>&#13;
</div>&#13;
<h3 class="h3" id="ch10lev1sec2"><strong>The DSRC Protocol</strong></h3>&#13;
<p class="noindent">DRSC is a one- or two-way short-range wireless communication system specifically built for vehicle communications between vehicles and roadside devices, or from vehicle to vehicle.</p>&#13;
<p class="indent">DSRC operates in the 5.85 to 5.925 GHz band reserved for V2V and V2I. The transmit power used by a DSRC device will dictate its range. Roadside equipment can transmit at higher-power ranges, allowing up to a 1,000 m specification, while vehicles can broadcast only at a power level that provides closer to 300 m ranges.</p>&#13;
<p class="indent">DSRC is based on the wireless 802.11p and 1609.x protocols. DSRC-and Wi-Fi-based systems, such as wireless access for vehicle environments (WAVE), use IEEE 1609.3 specification or the WAVE short-message protocol (WSMP). These messages are single packets with no more than 1,500 bytes and typically less than 500 bytes. (Network sniffers such as Wireshark can decode WAVE packets, which allows for easy sniffing of traffic.)</p>&#13;
<p class="indent">DSRC data rates depend on the number of users accessing the local system at the same time. A single user on the system would typically see data rates of 6 to 12Mbps, while users in a high-traffic area—say, an eight-lane freeway—would likely see 100 to 500Kbps. A typical DSRC system can handle almost 100 users in high-traffic conditions, but if the vehicles are traveling around 60 km/h, or 37 mph, it’ll usually support around only 32 users. <span epub:type="pagebreak" id="page_180"/>(These data rates are estimated from the Department of Transportation’s paper “Communications Data Delivery System Analysis for Connected Vehicles.”<sup><a id="fn_01" href="footnote.html#fn01">1</a></sup>)</p>&#13;
<p class="indent">The number of channels dedicated to the 5.9 GHz range of the DSRC system varies between countries. For example, the US system is designed to support seven channels with one channel that acts as a dedicated control channel reserved for sending short high-priority management packets. The European design supports three channels with no dedicated control channel. This disparity is largely due to the fact that each country has different drivers for the technology: Europe’s system is market driven, while the US system has a strong vehicle safety initiative behind it. Therefore, while the protocols will interoperate, the types of messages supported and sent will differ significantly. (In Japan, DSRC is currently being used for toll collection, but the Japanese are also planning to use a 760 MHz band for crash avoidance. The Japanese 5.8 GHz channels don’t use 802.11p, but they should still support the 1609.2 V2V security framework.)</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="bgblack">NOTE</span></strong></p>&#13;
<p class="notep"><em>While both Europe and the United States use 802.11p with ECDSA-256 encryption, the two systems are not 100 percent compatible. As of this writing, they incorporate various technical differences, such as where the signing stack is placed in the packet. There’s no good technical reason for this lack of standardization, so this will hopefully be fixed before widespread adoption.</em></p>&#13;
</div>&#13;
<h4 class="h4" id="ch10lev2sec1"><strong><em>Features and Uses</em></strong></h4>&#13;
<p class="noindent">All DSRC implementations offer convenience and safety features, but their features differ. For example, the European DSRC system will use DSRC for the following:</p>&#13;
<p class="uln"><strong>Car sharing</strong> Would work like today’s vehicle sharing, such as car2go, except that instead of using a third-party vehicle dongle attached to the OBD-II connector to control the vehicle, it would use the V2I protocols</p>&#13;
<p class="uln"><strong>Connections to points of interest</strong> Similar to the points of interest, such as restaurants or gas stations, in a traditional navigation system but would be broadcast to passing vehicles</p>&#13;
<p class="uln"><strong>Diagnostics and maintenance</strong> Would report the reason why a vehicle’s engine light is on via DSRC instead of having to read codes from an OBD connector</p>&#13;
<p class="uln"><strong>Driving profiles for insurance purposes</strong> Would replace insurance-style dongles that record driving behavior</p>&#13;
<p class="uln"><strong>Electronic toll notification</strong> Would allow for automated payments at toll booths (already being tested in Japan)</p>&#13;
<p class="uln"><span epub:type="pagebreak" id="page_181"/><strong>Fleet management</strong> Would allow for the monitoring of fleets of vehicles, such as those used for trucking and transportation services</p>&#13;
<p class="uln"><strong>Parking information</strong> Would record duration of parking and could displace traditional parking meters</p>&#13;
<p class="indenttb">Security-driven areas like the United States are more concerned with communicating warnings about things like the following:</p>&#13;
<p class="uln"><strong>Emergency vehicles approaching</strong> Would notify vehicles of an approaching emergency vehicle</p>&#13;
<p class="uln"><strong>Hazardous locations</strong> Would warn drivers of hazards, such as an icy bridge or road surface, or falling rocks</p>&#13;
<p class="uln"><strong>Motorcycle approaches</strong> Would signal the approach of a passing motorcycle</p>&#13;
<p class="uln"><strong>Road works</strong> Would notify drivers of upcoming construction</p>&#13;
<p class="uln"><strong>Slow vehicles</strong> Would provide early notification of traffic congestion or traffic slowdowns due to slow-moving farm or oversized vehicles</p>&#13;
<p class="uln"><strong>Stationary (crash) vehicles</strong> Would warn of vehicles that have broken down or were in a recent collision</p>&#13;
<p class="uln"><strong>Stolen vehicle recovery</strong> Might work similarly to a LoJack-like service in that it would allow law enforcement to locate a stolen vehicle based on a radio beacon</p>&#13;
<p class="indent">Additional types of communication categories that could be implemented via DSRC include traffic management; law enforcement, such as communicating speeds or tracking vehicles; driver assistance, such as parking assistance or lane guidance; and highway automation projects, such as self-driving vehicles that use V2I roadways to assist in guidance.</p>&#13;
<h4 class="h4" id="ch10lev2sec2"><strong><em>Roadside DSRC Systems</em></strong></h4>&#13;
<p class="noindent">Roadside DSRC systems are also used to pass standardized messages and updates to vehicles with information such as traffic data and hazard or road works warnings. The European Telecommunications Standards Institute (ETSI) has designed two formats for continuous traffic data, both of which use 802.11p: the cooperative awareness message (CAM) and the decentralized environmental notification message (DENM).</p>&#13;
<h5 class="h5" id="ch10lev3sec1"><strong>CAMs for Periodic Vehicle Status Exchanges</strong></h5>&#13;
<p class="noindent">CAMs are broadcast periodically through the V2X network. ETSI defines the packet size of a CAM as 800 bytes and the reporting rate at 2 Hz. This protocol is still in its preliminary stages. If you encounter CAMs in the future, they may vary from the proposal, but we’re including the current proposed characteristics to give you a sense of what you can expect from the CAM protocol in the future.</p>&#13;
<p class="indent">CAM packets consist of an ITS PDU header and station ID as well as one or more station characteristics and vehicle common parameters.</p>&#13;
<p class="indentb"><span epub:type="pagebreak" id="page_182"/>Station characteristics may include the following:</p>&#13;
<p class="bull">• Mobile ITS station</p>&#13;
<p class="bull">• Physical relevant ITS station</p>&#13;
<p class="bull">• Private ITS station</p>&#13;
<p class="bull">• Profile parameters</p>&#13;
<p class="bull">• Reference position</p>&#13;
<p class="indentt">Vehicle common parameters may consist of the following:</p>&#13;
<p class="bull">• Acceleration</p>&#13;
<p class="bull">• Acceleration confidence</p>&#13;
<p class="bull">• Acceleration controllability</p>&#13;
<p class="bull">• Confidence ellipse</p>&#13;
<p class="bull">• Crash status (optional)</p>&#13;
<p class="bull">• Curvature</p>&#13;
<p class="bull">• Curvature change (optional)</p>&#13;
<p class="bull">• Curvature confidence</p>&#13;
<p class="bull">• Dangerous goods (optional)</p>&#13;
<p class="bull">• Distance-to-stop line (optional)</p>&#13;
<p class="bull">• Door open (optional)</p>&#13;
<p class="bull">• Exterior lights</p>&#13;
<p class="bull">• Heading confidence</p>&#13;
<p class="bull">• Occupancy (optional)</p>&#13;
<p class="bull">• Station length</p>&#13;
<p class="bull">• Station-length confidence (optional)</p>&#13;
<p class="bull">• Station width</p>&#13;
<p class="bull">• Station-width confidence (optional)</p>&#13;
<p class="bull">• Turn advice (optional)</p>&#13;
<p class="bull">• Vehicle speed</p>&#13;
<p class="bull">• Vehicle-speed confidence</p>&#13;
<p class="bull">• Vehicle type</p>&#13;
<p class="bull">• Yaw rate</p>&#13;
<p class="bull">• Yaw rate confidence</p>&#13;
<p class="indentt">Although some of these parameters are marked as optional, they’re actually mandatory in certain situations. For example, a basic vehicle profile—station ID of 111 in binary—must report crash status and whether the vehicle is carrying dangerous goods, if known. An emergency vehicle—station ID <span epub:type="pagebreak" id="page_183"/>of 101 in binary—must report whether its lights and sirens are in use. Public transportation vehicles—station ID also 101—are required to report when their entry door is open or closed and may also report schedule deviation and occupancy count.</p>&#13;
<h5 class="h5" id="ch10lev3sec2"><strong>DENMs for Event-Triggered Safety Notifications</strong></h5>&#13;
<p class="noindentb">DENMs are event-driven messages. While CAMs are periodically sent so that they’re regularly updated, DENMs are triggered by safety and road hazard warnings. Messages might be sent in cases of:</p>&#13;
<p class="bull">• Collision risks (determined by roadside devices)</p>&#13;
<p class="bull">• Entering hazardous locations</p>&#13;
<p class="bull">• Hard braking</p>&#13;
<p class="bull">• High wind levels</p>&#13;
<p class="bull">• Poor visibility</p>&#13;
<p class="bull">• Precipitation</p>&#13;
<p class="bull">• Road adhesion</p>&#13;
<p class="bull">• Road work</p>&#13;
<p class="bull">• Signal violations</p>&#13;
<p class="bull">• Traffic jams</p>&#13;
<p class="bull">• Vehicles involved in an accident</p>&#13;
<p class="bull">• Wrong-way driving</p>&#13;
<p class="indentt">These messages stop either when the condition that triggered them is gone or after a set expiry period.</p>&#13;
<p class="indent">DENMs can also be sent to cancel or negate an event. For instance, if roadside equipment identified that a vehicle was going the wrong way down a street, it could send an event to notify nearby drivers. Once that driver had moved the vehicle into the proper lane, the equipment could send a cancel event to signal that the risk had passed.</p>&#13;
<p class="indent"><a href="ch10.html#ch10tab1">Table 10-1</a> shows the packet structure and byte position of a DENM packet.</p>&#13;
<p class="tabcaption"><a id="ch10tab1"/><strong>Table 10-1:</strong> Packet Structure and Byte Position of a DENM Packet</p>&#13;
<table class="topbot">&#13;
<thead>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Container</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Name</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Byte start position</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Byte end position</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Notes</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table"><strong>ITS Header</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">Protocol Version</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">1</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">1</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">ITS Version</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table"> </p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">Message ID</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">2</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">2</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">Message Type</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table"> </p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">Generation Time</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">3</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">8</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">Timestamp</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><span epub:type="pagebreak" id="page_184"/><p class="table"><strong>Management</strong></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Originator ID</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">9</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">12</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">ITS Station ID</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"> </p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Sequence Number</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">13</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">14</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"> </p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"> </p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Data Version</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">15</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">15</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">255 = Cancel</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"> </p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Expiry Time</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">16</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">21</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Timestamp</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"> </p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Frequency</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">21</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">21</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Transmission Frequency</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"> </p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Reliability</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">22</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">22</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Probability event is true. Bit 1..7</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"> </p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">IsNegation</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">22</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">22</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">1 == Negate. Bit 0</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table"><strong>Situation</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">CauseCode</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">23</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">23</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table"> </p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table"> </p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">SubCauseCode</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">24</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">24</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table"> </p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table"> </p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">Severity</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">25</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">25</p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table"> </p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><strong>Location</strong></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Latitude</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">26</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">29</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"> </p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"> </p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Longitude</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">30</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">33</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"> </p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"> </p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Altitude</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">34</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">35</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"> </p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"> </p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Accuracy</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">36</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">39</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"> </p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"> </p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Reserved</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">40</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><em>n</em></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">Variable size</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent">There are optional messages as well. For example, the situation container could include <code>TrafficFlowEffect</code>, <code>LinkedCause</code>, <code>EventCharacteristics</code>, <code>VehicleCommonParameters</code>, and <code>ProfileParameters</code>, just as in the CAN structure.</p>&#13;
<h4 class="h4" id="ch10lev2sec3"><strong><em>WAVE Standard</em></strong></h4>&#13;
<p class="noindentb">The WAVE standard is a DSRC-based system used in the United States for vehicle packet communication. The WAVE standard incorporates the 802.11p standard as well as the range of 1609.x standards across the OSI model. The purposes of these standards are as follows:</p>&#13;
<p class="uln"><strong>802.11p</strong> Defines the 5.9 GHz WAVE protocol (a modification of the Wi-Fi standard); also has random local MAC addressing</p>&#13;
<p class="uln"><strong>1609.2</strong> Security services</p>&#13;
<p class="uln"><strong>1609.3</strong> UDP/TCP IPv6 and LLC support</p>&#13;
<p class="uln"><strong>1609.4</strong> Defines channel usage</p>&#13;
<p class="uln"><strong>1609.5</strong> Communication manager</p>&#13;
<p class="uln"><strong>1609.11</strong> Over-the-air electronic payment and data exchange protocol</p>&#13;
<p class="uln"><strong>1609.12</strong> WAVE identifier</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="bgblack">NOTE</span></strong></p>&#13;
<p class="notep"><em>To explore the WAVE standard in more detail, you can use the OSI numbers in the preceding list to pull up the relevant reference documentation online.</em></p>&#13;
</div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_185"/>WSMP is used in both service and control channels. WAVE uses IPv6, the most recent Internet protocol, for service channels only. IPv6 is configured by the WAVE management entity (WME) and also handles channel assignments and monitors service announcements. (The WME is unique to WAVE and handles the overhead and maintenance of the protocol.) Control channels are used for service announcements and short messages from safety applications.</p>&#13;
<p class="indent">WSMP messages are formatted as shown in <a href="ch10.html#ch10fig1">Figure 10-1</a>.</p>&#13;
<div class="image"><img src="graphics/f10-01.jpg" alt="image"/></div>&#13;
<p class="figcap"><em><a id="ch10fig1"/>Figure 10-1: WSMP message format</em></p>&#13;
<p class="indent">The type of application provided by a roadside device, or hosted by a vehicle, is defined by the provider service identifier (PSID). The actual announcement of a service comes from a WAVE service announcement (WSA) packet, the structure of which is shown in <a href="ch10.html#ch10tab2">Table 10-2</a>.</p>&#13;
<p class="tabcaption"><a id="ch10tab2"/><strong>Table 10-2:</strong> WAVE Service Announcement Packet</p>&#13;
<table class="topbot">&#13;
<thead>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Section</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Elements</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table"><strong>WSA header</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">WAVE version<br/>EXT Fields</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><strong>Service Info</strong></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">WAVE Element ID<br/>PSID<br/>Service Priority<br/>Channel Index<br/>EXT Fields</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table"><strong>Channel Info</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th1"><p class="table">WAVE Element<br/>Operating Channel<br/>Channel Number<br/>Adaptable<br/>Data Rate<br/>Transmit Power<br/>EXT. Fields</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table"><strong>WAVE Routing Advertisement</strong></p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">WAVE Element<br/>Router Lifetime<br/>IP Prefix<br/>Prefix Length<br/>Default Gateway<br/>Gateway MAC<br/>Primary DNS<br/>EXT. Fields</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_186"/>If the vehicle’s PSID matches that of an advertised PSID, the vehicle will begin communications.</p>&#13;
<h4 class="h4" id="ch10lev2sec4"><strong><em>Tracking Vehicles with DSRC</em></strong></h4>&#13;
<p class="noindent">One attack that utilizes DSRC communications is vehicle tracking. If attackers can create their own DSRC receiver by buying a DSRC-capable device or using software-defined radio (SDR), they could receive information about vehicles within the receiver’s range—such as the size, location, speed, direction, and historical path up to the last 300 m—and use this information to track a target vehicle. For example, if an attacker knew the make and model of a target vehicle and the size of the target, they could set up a receiver near the target’s home to remotely detect when the target moves out of range of the DSRC receiver. This would tell the attacker when the owner had left their house. This method would allow an attacker to continue to track and identify vehicle activity despite the owner’s attempts to obscure identifying information.</p>&#13;
<p class="indentb">Information on vehicle size is transmitted in the following four fields:</p>&#13;
<p class="bull">• Length</p>&#13;
<p class="bull">• Body width</p>&#13;
<p class="bull">• Body height</p>&#13;
<p class="bull">• Bumper height (optional)</p>&#13;
<p class="indentt">This information should be accurate to within a fraction of an inch because it’s set by the manufacturer. The attacker could use this size information to accurately determine the make and model of a car. For instance, <a href="ch10.html#ch10tab3">Table 10-3</a> lists the dimensions for a Honda Accord.</p>&#13;
<p class="tabcaption"><a id="ch10tab3"/><strong>Table 10-3:</strong> Honda Accord Dimensions</p>&#13;
<table class="topbot">&#13;
<thead>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Length</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Body width</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Body height</strong></p></td>&#13;
<td style="vertical-align: top;" class="table_th"><p class="table"><strong>Bumper height</strong></p></td>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table"><p class="table">191.4 inches</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">72.8 inches</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">57.5 inches</p></td>&#13;
<td style="vertical-align: top;" class="table"><p class="table">5.8 inches</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent">Given these dimensions and a bit more information, such as the estimated time a target might pass a sensor, an attacker could determine whether a target has passed a sensor and track that target.</p>&#13;
<h3 class="h3" id="ch10lev1sec3"><strong>Security Concerns</strong></h3>&#13;
<p class="noindent">There are other attack potentials in the implementation of V2V, as was investigated by the Crash Avoidance Metrics Partnership (CAMP), a group of several auto manufacturers working to conduct different safety-related studies, in December of 2010. CAMP performed an attack analysis on V2V systems through its Vehicle Safety Consortium (VSC3). The analysis <span epub:type="pagebreak" id="page_187"/>focused primarily on the core DSRC/WAVE protocol, and attempted to match attacker objectives with potential attacks. <a href="ch10.html#ch10fig2">Figure 10-2</a> shows a summary of the consortium’s findings by attacker objective.</p>&#13;
<div class="image"><img src="graphics/f10-02.jpg" alt="image"/></div>&#13;
<p class="figcap"><em><a id="ch10fig2"/>Figure 10-2: Attacker objectives crossed with attacks</em></p>&#13;
<p class="indent">This table shows some of the goals a malicious actor may have when attacking V2V systems and the types of attacks they might launch in order to achieve those objectives. The top columns of the chart define an attacker’s possible objectives and the areas they might focus on. The chart is rather simplistic but might give you some idea as to which areas to research further.</p>&#13;
<h3 class="h3" id="ch10lev1sec4"><span epub:type="pagebreak" id="page_188"/><strong>PKI-Based Security Measures</strong></h3>&#13;
<p class="noindent">While much of the technology and security behind V2V is still being ironed out, we do know that the security for cellular, DSRC, and hybrid communications is based on a public key infrastructure (PKI) model much like the SSL model on websites. By generating public and private key pairs, PKI systems allow users to create digital signatures for use in encrypting and decrypting documents sent over networks. Public keys can be openly exchanged and are used to encrypt data between destinations. Once encrypted, only private keys can be used to decrypt the data. The data is signed with the sender’s private key in order to verify its origin.</p>&#13;
<p class="indent">PKI uses public key cryptography and central certificate authorities (CAs) to validate public keys. The CA is a trusted source that can hand out and revoke public keys for a given destination. The V2V PKI system is sometimes also referred to as the <em>Security Credentials Management System (SCMS)</em>.</p>&#13;
<p class="indentb">For a PKI system to function, it must enforce the following:</p>&#13;
<p class="uln"><strong>Accountability</strong> Identities should be verifiable using trusted signatures.</p>&#13;
<p class="uln"><strong>Integrity</strong> Signed data must be verifiable to make sure that it hasn’t been altered in transit.</p>&#13;
<p class="uln"><strong>Nonrepudiation</strong> Transactions must be signed.</p>&#13;
<p class="uln"><strong>Privacy</strong> Traffic must be encrypted.</p>&#13;
<p class="uln"><strong>Trust</strong> The CA must be trusted.</p>&#13;
<p class="indentt">V2V and V2I systems rely on PKI and a CA to secure data transmission, though the identity of the CA has yet to be determined. This is the same system that your browser uses on the Internet. On your browser’s Settings screen, you should find a HTTPS/SSL section listing all authorized root authorities. When you buy a certificate from one of these CAs and use it on a web server, other browsers will verify this certificate against the CA to ensure it’s trusted. In a normal PKI system, the company that set up the environment controls the CA, but in V2V, government groups or countries will likely control the CA.</p>&#13;
<h4 class="h4" id="ch10lev2sec5"><strong><em>Vehicle Certificates</em></strong></h4>&#13;
<p class="noindent">The PKI systems used to secure today’s Internet communication have large certificate files, but due to limited storage space and the need to avoid congestion on the DSRC channels, vehicle PKI systems require shorter keys. To accommodate this need, vehicle PKI systems use elliptical curve cryptography (ECDSA-256) keys, which generate certificates that are one-eighth the size of Internet certificates.</p>&#13;
<p class="indent">The vehicles participating in V2V communication use two types of certificates:</p>&#13;
<p class="term"><strong>Long-term certificate (LTC)</strong></p>&#13;
<p class="termlist">This certificate contains vehicle identifiers and can be revoked. It’s used to get short-term certificate refills.</p>&#13;
<p class="term"><span epub:type="pagebreak" id="page_189"/><strong>Short-term, pseudonym certificate (PC)</strong></p>&#13;
<p class="termlist">This certificate has a short expiry time and, therefore, doesn’t need to be revoked because it simply expires. It’s used for anonymous transfers, which are designed for common messages like braking or road conditions.</p>&#13;
<h4 class="h4" id="ch10lev2sec6"><strong><em>Anonymous Certificates</em></strong></h4>&#13;
<p class="noindent">PKI systems are traditionally set up to identify the sender, but with information being broadcast to unknown vehicles and devices, it’s important to ensure that V2V systems don’t send information that can be traced back, such as packets signed by the source.</p>&#13;
<p class="indent">For that reason, there’s a provision in the V2V spec that allows you to sign packets anonymously, with only enough information to show that the packet came from a “certified terminal.” Though this is more secure than sending packets signed by the author, it would still be possible for someone to examine the anonymous certificate signature on a given route and determine the route that vehicle is traveling (in the same way that you might use the unique ID transmitted from a tire pressure monitor sensor to track a vehicle’s progress). To compensate for this, the spec states that the device should use short-lived certificates that will last for only five minutes.</p>&#13;
<p class="indent">Currently, however, the systems being developed are planning to use 20 or more certificates that are all simultaneously valid with a lifetime of a week, which could prove to be a security flaw.</p>&#13;
<h4 class="h4" id="ch10lev2sec7"><strong><em>Certificate Provisioning</em></strong></h4>&#13;
<p class="noindent">Certificates are generated through a process called certificate provisioning. V2V systems use a lot of short-term certificates, which need to be provisioned on a regular basis in order to replenish a device’s certificates so that it can use them for anonymous messaging. The full details of how privacy works in V2V certificate systems is actually quite complicated, as the CAMP diagram in <a href="ch10.html#ch10fig3">Figure 10-3</a> shows.</p>&#13;
<p class="indentb">Prepare yourself for a lot of larvae references—as in caterpillar, cocoon, and butterfly—as we review how the certificate-provisioning process works:</p>&#13;
<ol>&#13;
<li><p class="noindent">First, the device—that is, the vehicle—generates what’s known as a “caterpillar” keypair, which sends the public key and an Advanced Encryption Standard (AES) expansion number to the Registration Authority (RA).</p></li>&#13;
<li><p class="noindent">The RA generates a bunch of what are known as “cocoon” public keys from the caterpillar public key as well as the expansion number. These become new private keys. The number of keys is arbitrary and not correlated with the device requesting the keys. (As of this writing, the request includes some ID information from the linkage authorities and <em>should</em> shuffle the request with requests from other vehicles. This shuffling is designed to help obscure which vehicle made each request in an attempt to improve privacy.)</p></li>&#13;
<li><p class="noindent"><span epub:type="pagebreak" id="page_190"/>The Pseudonym Certificate Authority (PCA) randomizes the cocoon keys and generates the “butterfly” keys. These are then returned to the originating device over an encrypted channel so the RA can’t see the contents.</p></li>&#13;
</ol>&#13;
<div class="image"><img src="graphics/f10-03.jpg" alt="image"/></div>&#13;
<p class="figcap"><em><a id="ch10fig3"/>Figure 10-3: Certificate-provisioning flow graph</em></p>&#13;
<p class="indent">In theory, the originating device can request enough short-term keys to last the vehicle’s lifetime, which is why the certificate revocation list (CRL)is important. If a vehicle has one month’s worth of certificates, it won’t check for new updates until that month is up, so a bad actor can continue to communicate with this vehicle until there’s an update. If the vehicle has a year’s worth or more of certificates and no CRL functionality, then things can get real bad real fast because it won’t be able to identify bad actors.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="bgblack">NOTE</span></strong></p>&#13;
<p class="notep"><em>Notice the location obscurer proxy (LOP) in the certificate-provisioning chart. This is a filter to remove identifiable information, such as location, from the request. A request</em> should <em>get through an LOP before the RA sees it.</em></p>&#13;
</div>&#13;
<h4 class="h4" id="ch10lev2sec8"><span epub:type="pagebreak" id="page_191"/><strong><em>Updating the Certificate Revocation List</em></strong></h4>&#13;
<p class="noindent">The CRL is a list of “bad” certificates. Certificates sometimes go bad because they’re compromised by an attacker or lost by their owner or because a device is misbehaving for some reason that the CA considers detrimental. A device must update its CRL so that it can determine which certificates, if any, are no longer trustworthy.</p>&#13;
<p class="indent">The CRL can be large, and it isn’t always feasible to download the entire list through DSRC or opportunistic Wi-Fi. Therefore, most systems will implement an incremental update period, which the manufacturer decides, but even that can cause issues. DSRC requires roadside devices to send the list, but in order to receive large chunks of data, the vehicle must travel past the roadside devices slowly enough that they have enough time to receive the CRL. Because most devices will be situated on major highways, with only a few on side roads, the only opportunity a vehicle might have to receive an updated list is during a traffic jam. The best way to retrieve an updated CRL is, therefore, through cellular or full-satellite communication, though that’s still slow. With high-speed cellular or full-satellite links, it would be possible to receive incremental updates or full downloads if required.</p>&#13;
<p class="indent">One possible way to distribute an updated CRL is to have vehicles communicate updates to each other via the V2V interface itself. While a vehicle may not be in contact with a roadside device long enough to complete an update, it’s sure to encounter hundreds, if not thousands, of other vehicles on a journey.</p>&#13;
<h5 class="h5" id="ch10lev3sec3"><strong>Risks of V2V Updates</strong></h5>&#13;
<p class="noindent">While updating via the V2V interface is very tempting because it lowers the infrastructure cost and overhead significantly (because you don’t need to invest in lots of additional roadside infrastructure) it has its limits. For one, a vehicle could receive a CRL download only from nearby cars traveling in the same direction long enough to complete the download; cars going in opposite directions may pass by too quickly. This V2V method also provides the opportunity for a bad actor to inject a bad CRL that could either block legitimate devices or hide bad actors, and that bad CRL could then circulate through traffic like a virus.</p>&#13;
<p class="indent">Unfortunately, V2V protocol security focuses entirely on communication protocols. The onboard system, such as the ECU, is responsible for requesting and storing CRLs, reporting misbehavior, and sending vehicle information, but this unsecured system provides an easy gateway for attackers to inject their code. Instead of taking over the device performing the actual V2V communication, they could simply modify the ECU firmware or spoof packets on the bus, and the V2V device would then faithfully sign and send the information out to the network. It’s because of this latter vulnerability that this method has been unofficially dubbed the <em>epidemic distribution model</em>.</p>&#13;
<h5 class="h5" id="ch10lev3sec4"><span epub:type="pagebreak" id="page_192"/><strong>Linkage Authorities</strong></h5>&#13;
<p class="noindent">When dealing with thousands of pseudonym, or short-term, certificates, revocation can be a nightmare, and that’s where the linkage authority (LA) comes in. The LA can revoke all generated certificates from a vehicle with just one CRL entry. In this way, even if bad actors gather numerous certificates before being identified and blocked, the LA can still shut them down.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="bgblack">NOTE</span></strong></p>&#13;
<p class="notep"><em>Most V2V systems are being designed to support an internal blacklist that’s separate from the CRL. A manufacturer or device may blacklist any device.</em></p>&#13;
</div>&#13;
<h4 class="h4" id="ch10lev2sec9"><strong><em>Misbehavior Reports</em></strong></h4>&#13;
<p class="noindent">V2V and V2I systems are being designed to allow for the ability to send misbehavior reports on anything from standard vehicle malfunctions to notifications of hackers messing with the system. These misbehavior reports are then supposed to trigger the revocation of certificates. But how does a vehicle know whether it has a hacked packet? The answer differs for each automotive industry, but the general concept is that the ECU—or some other device—would receive a packet and check whether it “makes sense.” For example, the receiving device might validate a message against a GPS signal or identify reports of a vehicle traveling at improbable speeds, say 500 mph. When something erroneous is detected, the vehicle should send a misbehavior report, which would eventually lead to revocation of that certificate. A misbehavior authority (MA) would be tasked with identifying and revoking certificates from the misbehaving device.</p>&#13;
<p class="indent">One interesting scenario to consider is that of a vehicle with a low CRL update interval—or that of a vehicle that hasn’t been near a roadside device in awhile—leaving it with an outdated revocation list. Such a vehicle might unknowingly forward incorrect information, which would cause it to be reported as a bad actor and which might lead to revocation of its certificate. What happens then? When can the vehicle be trusted again?</p>&#13;
<p class="indent">When performing security testing, make sure to include these possible scenarios in your research.</p>&#13;
<h3 class="h3" id="ch10lev1sec5"><strong>Summary</strong></h3>&#13;
<p class="noindent">This chapter discussed the plan for V2V communication. V2V devices are still in development and many deployment decisions are still to be made. As this technology rolls out, the various vendors will interpret the rules differently and in ways that could lead to interesting security gaps. Hopefully as these early devices start to trickle out into the marketplace, this chapter will be a useful guide for performing security audits.</p>&#13;
</body></html>