<html><head></head><body><div id="sbo-rt-content"><h2 class="h2" id="ch18"><span epub:type="pagebreak" id="page_169"/><strong><span class="big">18</span></strong><br/><strong>SUMMING UP</strong></h2>&#13;
<div class="image1"><img src="Images/common01.jpg" alt="image" width="190" height="190"/></div>&#13;
<p class="noindent">So, we reach the end of the book! We covered a lot of material, but you should now feel like you are ready to go out in the world and build websites in a safe, secure manner.</p>&#13;
<p class="indent">Let’s finish with a brief recap. This chapter presents 21 commandments of web security that will help you remember the key lessons from each chapter. Follow these simple steps, and the likelihood of you being hacked will be close to zero.</p>&#13;
<p class="noindentt"><strong>Automate Your Release Process</strong></p>&#13;
<p class="noindent">Be able to build your code from a single command line call. Keep your code in source control and decide on a branching strategy. Separate configuration from code, so it is easy to build testing environments. Use a testing environment to validate functionality before each release. Automate the deployment of code to each environment. Make sure your release process is reliable, reproducible, and revertible. Always know which version of the code is running on each environment, and be able to roll back to a prior version in a simple fashion.</p>&#13;
<p class="noindentt"><span epub:type="pagebreak" id="page_170"/><strong>Do (Thorough) Code Reviews</strong></p>&#13;
<p class="noindent">Make sure every code change is reviewed by at least one team member who is not the original author before it is approved for release. Ensure that team members have time to critically assess code changes, and understand that reviewing code is just as important as writing it.</p>&#13;
<p class="noindentt"><strong>Test Your Code (to the Point of Boredom)</strong></p>&#13;
<p class="noindent">Write unit tests to make assertions about critical sections of your codebase, and run them as part of your build process. Run your unit tests on a continuous integration server with each change. Measure the percentage of your codebase that is executed when unit tests are run, and always try to increase this coverage number. Write tests to reproduce software bugs <em>before</em> fixing the bug. Test until fear turns into boredom!</p>&#13;
<p class="noindentt"><strong>Anticipate Malicious Input</strong></p>&#13;
<p class="noindent">All parts of the HTTP request will be manipulated by hackers, so be ready. Construct queries to databases and the operating system by using parameterized statements so you are protected against injection attacks.</p>&#13;
<p class="noindentt"><strong>Neutralize File Uploads</strong></p>&#13;
<p class="noindent">If your users can upload files to your website, make sure those files cannot be executed. Ideally, upload files to a content delivery network (CDN). If you need more fine-grained permissions for files, host them in a content management system (CMS). As a last resort, save uploaded files in a separate disk partition and make sure they are not written to disk with executable permissions.</p>&#13;
<p class="noindentt"><strong>Escape Content While Writing HTML</strong></p>&#13;
<p class="noindent">Attackers will attempt to inject malicious JavaScript in your web pages by smuggling JavaScript into your database or hiding it in HTTP parameters. Make sure any dynamic content written to your web pages is escaped—replace HTML control characters with safe entity encodings. This applies on the client side as well as the server side! If possible, disable the execution of inline JavaScript altogether by using the <code>Content-Security-Policy</code> response header.</p>&#13;
<p class="noindentt"><strong>Be Suspicious of HTTP Requests from Other Sites</strong></p>&#13;
<p class="noindent">HTTP requests originating from other domains may be malicious—for instance, an attacker may have tricked one of your users into clicking a disguised link. Make sure <code>GET</code> requests to your site are side-effect free: they should be used only to retrieve resources. Ensure that other types of requests (such as <code>POST</code> requests used to initiate login) originate from your site by incorporating anti-forgery cookies in your HTML forms and any HTTP requests initiated by JavaScript. Strip cookies from requests initiated outside your web domain by adding the <code>SameSite</code> attribute to your <code>Set-Cookie</code> HTTP response header.</p>&#13;
<p class="noindentt"><strong>Hash and Salt Your Passwords</strong></p>&#13;
<p class="noindent">If you store passwords in your database, encrypt them with a strong, one-way hash function such as <code>bcrypt</code> before saving them. Add an element of randomness to each hash by adding a salt.</p>&#13;
<p class="noindentt"><span epub:type="pagebreak" id="page_171"/><strong>Don’t Admit Who Your Users Are</strong></p>&#13;
<p class="noindent">The only person who should know whether a user has signed up to your site is the user themselves. Make sure login forms and password reset pages do not permit a hacker to mine your site for a list of users: keep error and information messages generic, whether a username exists or not.</p>&#13;
<p class="noindentt"><strong>Protect Your Cookies</strong></p>&#13;
<p class="noindent">If an attacker can steal your cookies, they can hijack your users’ identities. Add the <code>HttpOnly</code> keyword to your <code>Set-Cookie</code> response headers so cookies cannot be read by malicious JavaScript. Add the <code>Secure</code> keyword so that cookies are sent only over HTTPS.</p>&#13;
<p class="noindentt"><strong>Protect Sensitive Resources (Even If You Don’t Link to Them)</strong></p>&#13;
<p class="noindent">Check that a user has permissions to access any sensitive resource on your site before returning it in an HTTP request—even if that resource isn’t listed in search pages or linked to from elsewhere.</p>&#13;
<p class="noindentt"><strong>Avoid Using Direct File References</strong></p>&#13;
<p class="noindent">Avoid passing and evaluating file paths in HTTP requests. Use your web server’s built-in URL resolution for evaluating paths to resources, or refer to files by opaque identifiers.</p>&#13;
<p class="noindentt"><strong>Don’t Leak Information</strong></p>&#13;
<p class="noindent">Minimize the amount of information an attacker can learn about your tech stack. Turn off any <code>Server</code> header in your HTTP responses and make sure your session parameter name is generic in your <code>Set-Cookie</code> header. Avoid telltale file suffixes in URLs. Make sure to turn off detailed client-side error reporting in your production environment. Obfuscate the JavaScript libraries you used during your build process.</p>&#13;
<p class="noindentt"><strong>Use Encryption (Correctly)</strong></p>&#13;
<p class="noindent">Purchase a security certificate for your domain and install it on your web server along with your private encryption key. Divert all traffic to HTTPS, and add the <code>Secure</code> keyword to your <code>Set-Cookie</code> response header to ensure that cookies are never sent over unencrypted HTTP. Update your web server regularly to keep on top of encryption standards.</p>&#13;
<p class="noindentt"><strong>Secure Your Dependencies (and Services)</strong></p>&#13;
<p class="noindent">Use a package manager to import third-party code during the build process and fix each package to a specific version number. Keep on top of security advisories for the packages you use and update them regularly. Store your configuration securely—outside source control! Use the SafeFrame standard for any advertisements you host.</p>&#13;
<p class="noindentt"><strong>Defuse Your XML Parser</strong></p>&#13;
<p class="noindent">Turn off processing of inline document type declarations in your XML parser.</p>&#13;
<p class="noindentt"><strong>Send Email Securely</strong></p>&#13;
<p class="noindent">Whitelist which servers are permitted to send email from your domain by using a Sender Policy Framework (SPF) record in your domain records. <span epub:type="pagebreak" id="page_172"/>Allow mail recipients to verify the <code>From</code> address of any email you send and to detect attempts to tamper with an email by using DomainKeys Identified Mail (DKIM).</p>&#13;
<p class="noindentt"><strong>Check Your Redirects (If You Have Any)</strong></p>&#13;
<p class="noindent">If you redirect to a URL stored in part of the HTTP request—for example, after a user logs in—check that the URL is local to your domain rather than an external website. Otherwise, these open redirects will be used to disguise malicious links in emails.</p>&#13;
<p class="noindentt"><strong>Don’t Allow Your Site to Be Framed</strong></p>&#13;
<p class="noindent">Don’t allow your website to be enclosed in an <code>&lt;iframe&gt;</code> unless you have a specific need to do so. Disable framing by adding <code>Content-Security-Policy: frame-ancestors 'none'</code> to your HTTP responses.</p>&#13;
<p class="noindentt"><strong>Lock Down Your Permissions</strong></p>&#13;
<p class="noindent">Follow the principle of least privilege—ensure that each process and software component runs with the minimum number of permissions required. Think through what an attacker might try to do if they compromise any part of your system, and mitigate the harm. Ensure that your web server process is not running as a root operating system account. Limit the directories on disk that your web server can access. Prevent unnecessary network calls from your web server. Have your web server connect to your database under an account with limited permissions.</p>&#13;
<p class="noindentt"><strong>Detect and Be Ready for Surges in Traffic</strong></p>&#13;
<p class="noindent">Use real-time monitoring to detect high traffic volumes to your website. Build for scale by using a CDN, client-side cookies, caching, and asynchronous processing. Be able to easily scale up the number of servers hosting your site. If malicious traffic becomes a problem, deploy a firewall or intrusion prevention system, or consider signing up for distributed-denial-of-service protection.</p>&#13;
</div>



  </body></html>