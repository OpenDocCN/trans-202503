<html><head></head><body><div class="chapter" title="Chapter&#xA0;6.&#xA0;Juniper Olive and VSRX Firefly"><div class="titlepage"><div><div><h1 class="title"><a id="juniper_olive_and_vsrx_firefly"/>Chapter 6. Juniper Olive and VSRX Firefly</h1></div></div></div><p><a id="iddle1535" class="indexterm"/><a id="iddle1690" class="indexterm"/><a id="iddle1691" class="indexterm"/><a id="iddle1808" class="indexterm"/><a id="iddle1917" class="indexterm"/><a id="iddle2019" class="indexterm"/><a id="iddle2023" class="indexterm"/>You can install and run Juniper routers with GNS3 in several ways. In this chapter, I show you how to use VirtualBox and Quick Emulator (QEMU) to create GNS3-ready Juniper devices and then install Juniper’s vSRX Firefly firewall.</p><p>QEMU is an open source PC emulator similar to VirtualBox. It’s less polished but has many powerful features and is fully integrated into GNS3. Using QEMU, you can run many network operating systems including Cisco ASA, IDS, IOS-XR, NX-OSv, and a special version of Juniper’s Junos OS known as Juniper Olive. In this chapter, I focus only on Juniper.</p><div class="sect1" title="Installing QEMU on Windows and OS X"><div class="titlepage"><div><div><h1 class="title"><a id="installing_qemu_on_windows_and_os_x"/>Installing QEMU on Windows and OS X</h1></div></div></div><p>If you installed GNS3 on Windows or OS X, then QEMU should have been installed for you already. The GNS3 installer may have installed two versions of QEMU: a stable version that was configured automatically during the <a id="iddle1741" class="indexterm"/><a id="iddle2036" class="indexterm"/><a id="iddle2155" class="indexterm"/><a id="iddle2273" class="indexterm"/>GNS3 installation and a newer version that contains additional, untested features. If you need your projects to be completely stable, I recommend using only the preconfigured version.</p><p>If you installed GNS3 using the defaults outlined in <a class="xref" href="ch02.html" title="Chapter 2. Installing a Basic GNS3 System">Chapter 2</a>, you should find the QEMU applications under <span class="emphasis"><em>C:\Program Files\GNS3\qemu-0.13.0</em></span> on both 32-bit and 64-bit Windows systems, but keep in mind that this directory will change as new versions of QEMU are introduced and added to GNS3. On OS X, you should find QEMU under <span class="emphasis"><em>/Applications/GNS3.app/Contents/Resources/qemu/bin/</em></span>.</p></div><div class="sect1" title="Installing QEMU on Linux"><div class="titlepage"><div><div><h1 class="title"><a id="installing_qemu_on_linux"/>Installing QEMU on Linux</h1></div></div></div><p>QEMU on Ubuntu can be installed using a package or compiled from source code. To install from a package, update your package manager and install QEMU from the command line.</p><a id="pro_id00034"/><pre class="programlisting">$ <span class="strong"><strong>sudo apt-get update</strong></span>
$ <span class="strong"><strong>sudo apt-get install qemu</strong></span></pre><p>Alternatively, you can install the <code class="literal">qemu-system-x86</code> package. This is a much smaller installation that should be capable of running any operating system that you want to use with GNS3. To install the x86 architecture–only version of QEMU, use the following commands:</p><a id="pro_id00035"/><pre class="programlisting">$ <span class="strong"><strong>sudo apt-get install qemu-system-x86</strong></span>
$ <span class="strong"><strong>sudo apt-get install qemu-utils</strong></span></pre><p>You may want to compile QEMU from source code, depending on what version of QEMU is available for your system. Although precompiled packages of QEMU exist on many Linux distributions, they may not be the newest version available and may not include the GTK toolkit that provides the QEMU graphical user interface. In that case, you can access the QEMU interface by installing a VNC viewer program, like GNC Viewer.</p><p>When you install from source code, you also have to install other packages required by QEMU before compiling the source. Update your package manager and install these packages now:</p><a id="pro_id00036"/><pre class="programlisting">$ <span class="strong"><strong>sudo apt-get update</strong></span>
$ <span class="strong"><strong>sudo apt-get install flex</strong></span>
$ <span class="strong"><strong>sudo apt-get install bison</strong></span>
$ <span class="strong"><strong>sudo apt-get install zlib1g-dev</strong></span>
$ <span class="strong"><strong>sudo apt-get install libglib2.0-dev</strong></span>
$ <span class="strong"><strong>sudo apt-get install libgtk2.0-dev</strong></span>
$ <span class="strong"><strong>sudo apt-get install libncurses5-dev</strong></span>
$ <span class="strong"><strong>sudo apt-get install libpcap-dev</strong></span>
$ <span class="strong"><strong>sudo apt-get install dh-autoreconf</strong></span></pre><p><a id="iddle1389" class="indexterm"/><a id="iddle1675" class="indexterm"/><a id="iddle1686" class="indexterm"/><a id="iddle1706" class="indexterm"/>Next, download the QEMU source code from the QEMU website (<span class="emphasis"><em><a class="ulink" href="http://www.qemu-project.org/">http://www.qemu-project.org/</a></em></span>) and unzip the file, as shown here:</p><a id="pro_id00037"/><pre class="programlisting">$ <span class="strong"><strong>wget http://www.qemu-project.org/download/qemu-2.1.2.tar.bz2</strong></span>
$ <span class="strong"><strong>bunzip2 qemu-2.1.2.tar.bz2</strong></span>
$ <span class="strong"><strong>tar xvf qemu-2.1.2.tar</strong></span></pre><p>After unzipping the files, move to the QEMU installation directory and enter the <code class="literal">configure</code> and <code class="literal">make</code> commands to compile the source code.</p><a id="pro_id00038"/><pre class="programlisting">$ <span class="strong"><strong>cd qemu-2.1.2</strong></span>
$ <span class="strong"><strong>./configure</strong></span>
$ <span class="strong"><strong>make</strong></span></pre><p>Finally, complete the process by installing the compiled files on your system. This must be done using elevated root privileges.</p><a id="pro_id00039"/><pre class="programlisting">$ <span class="strong"><strong>sudo make install</strong></span></pre><p>When the installation is complete, you should find QEMU binaries under <span class="emphasis"><em>/usr/local/bin/</em></span>, and the QEMU support files should be in the <span class="emphasis"><em>/usr/local/share/qemu/</em></span> directory.</p><p>With QEMU installed, you’re ready to start creating and using QEMU devices in GNS3.</p></div><div class="sect1" title="Introducing Juniper"><div class="titlepage"><div><div><h1 class="title"><a id="introducing_juniper"/>Introducing Juniper</h1></div></div></div><p>Most people have heard of Cisco, but relatively few have heard of Juniper Networks. Like Cisco, Juniper produces a wide range of networking hardware, and Internet service providers use its extremely high-throughput devices to efficiently route billions of packets for their customers.</p><p>All Juniper devices are designed around a common FreeBSD code base, though not every Juniper device runs the FreeBSD operating system. Instead, they use its kernel only as a framework for another operating system known as Junos OS. However, because Junos OS is designed around FreeBSD, you can run a special version of the software on your PC called Juniper Olive.</p><p>Juniper Olive is a functional version of Junos OS. Because it runs on a regular PC and not an actual Juniper chassis, it lacks the proprietary ASIC hardware to achieve the high throughput of a real Juniper device. Otherwise, it’s the real deal and not a simulation of the operating system. This makes it well suited for studying for the Juniper Networks Certified Associate (JNCIA) certification and other entry-level certifications.</p><div class="note" title="Note"><h3 class="title"><a id="ch06note01"/>Note</h3><p><a id="iddle1387" class="indexterm"/><a id="iddle1533" class="indexterm"/><a id="iddle1687" class="indexterm"/><a id="iddle1695" class="indexterm"/><a id="iddle1697" class="indexterm"/><a id="iddle2385" class="indexterm"/><span class="emphasis"><em>Juniper provides another virtual router called vMX that runs on bare-metal x86 hardware or as a virtual machine using QEMU, VirtualBox, or VMware, which allows it to be integrated into GNS3. It’s what Juniper calls a scalable “pay as you grow” solution.</em></span></p></div><div class="sidebar"><a id="juniper_extends_an_olive_branch"/><p class="title">Juniper Extends an Olive Branch</p><p>Juniper Olive is rumored to be an in-house version of Junos OS that’s meant to be used only by Juniper developers and not intended for public consumption, but only Juniper knows for sure. If you contact the company, you’ll be told it’s an “unsupported version.” Juniper won’t provide you with the software, and Juniper certainly won’t give you any support. However, GNS3 fully supports Juniper Olive integration, allowing you to add Juniper routers to your GNS3 projects.</p></div></div><div class="sect1" title="Installing Juniper"><div class="titlepage"><div><div><h1 class="title"><a id="installing_juniper"/>Installing Juniper</h1></div></div></div><p>It’s been said that if you give a person a fish, you feed them for a day, but if you teach a person to fish, you feed them for a lifetime. This adage holds true when creating a Juniper Olive, so let’s go fishing! Although there are many ways to configure and install Olive (including scripts that automate the process or preconfigured virtual machines that can be found on the Internet), learning to do it manually allows you to adjust the parameters as necessary when new Olive versions become available.</p><p>When used with GNS3, the Juniper Olive software is often installed using VirtualBox or QEMU. In this section, you’ll work with QEMU, but before you can create an Olive, your system must meet the following requirements:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>8GB available disk space</p></li><li class="listitem"><p>1024MB available memory for QEMU/Juniper</p></li><li class="listitem"><p>QEMU installed on your system</p></li><li class="listitem"><p>FreeBSD-4.11 mini ISO</p></li><li class="listitem"><p>Juniper Olive software</p></li></ul></div><p>Let’s look at how to create an Olive and where to get the software to do it.</p><div class="sect2" title="Process Overview"><div class="titlepage"><div><div><h2 class="title"><a id="process_overview"/>Process Overview</h2></div></div></div><p>The Juniper Olive installation software works a lot like a common parasite, with FreeBSD as its unsuspecting host. To create an Olive, you’ll install a copy of FreeBSD using QEMU or VirtualBox. Next, you’ll copy a gzipped tarball of the Juniper Olive software to your FreeBSD virtual machine. <a id="iddle1103" class="indexterm"/><a id="iddle1384" class="indexterm"/><a id="iddle1500" class="indexterm"/><a id="iddle1670" class="indexterm"/><a id="iddle1671" class="indexterm"/><a id="iddle1679" class="indexterm"/><a id="iddle1680" class="indexterm"/><a id="iddle1684" class="indexterm"/><a id="iddle1813" class="indexterm"/><a id="iddle2015" class="indexterm"/>There, you’ll unzip the package and make a small modification, and then you’ll zip the files back into a FreeBSD installable package. Finally, you’ll install the package and reboot the FreeBSD system.</p><p>This is where things get interesting. The first time you boot your system, the Juniper Olive software invades its FreeBSD host. It will repartition the FreeBSD hard disk, copy new files to the system, and keep any FreeBSD files that it needs. When it’s finished, you should have a functional Juniper router.</p></div><div class="sect2" title="Acquiring FreeBSD"><div class="titlepage"><div><div><h2 class="title"><a id="acquiring_freebsd"/>Acquiring FreeBSD</h2></div></div></div><p>A FreeBSD CD image is required to install FreeBSD with QEMU. Several versions are available that are suitable for creating Juniper Olive, but I recommend a mini ISO. It contains all the necessary files, and it’s the fastest to download. Download the <span class="emphasis"><em>4.11-RELEASE-i386-miniinst.iso</em></span> file from the FreeBSD archive (<span class="emphasis"><em><a class="ulink" href="ftp://ftp-archive.freebsd.org/">ftp://ftp-archive.freebsd.org/</a></em></span>). I recommend this FreeBSD version instead of more recent ones because it seems to work well with almost any Olive version.</p><div class="note" title="Note"><h3 class="title"><a id="ch06note02"/>Note</h3><p><span class="emphasis"><em>You can find a ready-to-use QEMU (and VirtualBox) image with FreeBSD already installed at the GNS3 website</em></span> (<a class="ulink" href="http://www.gns3.com/">http://www.gns3.com/</a>) <span class="emphasis"><em>in the Download section, under QEMU appliances.</em></span></p></div></div><div class="sect2" title="Acquiring Juniper Olive Software"><div class="titlepage"><div><div><h2 class="title"><a id="acquiring_juniper_olive_software"/>Acquiring Juniper Olive Software</h2></div></div></div><p>Next, you need to acquire the Juniper Olive software. The software is available as a FreeBSD installable package and should have a name like <span class="emphasis"><em>jinstall-12.1R1.9-domestic-olive.tgz</em></span>. Because Juniper Olive is not supported by Juniper, you cannot get a copy of the software directly from Juniper.</p></div></div><div class="sect1" title="Creating a Juniper Olive CD Image File"><div class="titlepage"><div><div><h1 class="title"><a id="creating_a_juniper_olive_cd_image_file"/>Creating a Juniper Olive CD Image File</h1></div></div></div><p>After you have the Juniper Olive software, you need a way to copy the package to your FreeBSD virtual machine to install it. There’s more than one way to do this, but the simplest way is to mount an ISO image file on your FreeBSD virtual machine, just as you would a regular CD. Before you can do that, you have to create your own ISO image of the Olive software.</p><div class="sect2" title="Creating an ISO in Windows"><div class="titlepage"><div><div><h2 class="title"><a id="creating_an_iso_in_windows"/>Creating an ISO in Windows</h2></div></div></div><p>To create an ISO image file using Windows, you first need to install ISO image creation software. I recommend ISO Recorder (<span class="emphasis"><em><a class="ulink" href="http://isorecorder.alexfeinman.com/isorecorder.htm">http://isorecorder.alexfeinman.com/isorecorder.htm</a></em></span>). It’s free, easy to install, and works well. Download the software and launch the installer. Then click <span class="strong"><strong>Next</strong></span> and follow the prompts to complete the installation.</p><p>After installing ISO Recorder, you should be able to create an ISO image of the Juniper Olive software. Create a folder and copy your gzipped Olive file into the folder (named <span class="emphasis"><em>juniper-olive</em></span>, for example). Then, right-click the folder and select <span class="strong"><strong>Create ISO image file</strong></span>.</p><p><a id="iddle1454" class="indexterm"/><a id="iddle1745" class="indexterm"/><a id="iddle1820" class="indexterm"/><a id="iddle1923" class="indexterm"/>The ISO Recorder Creation Wizard appears, as shown in <a class="xref" href="ch06.html#iso_recorder_creation_wizard" title="Figure 6-1. ISO Recorder Creation Wizard">Figure 6-1</a>.</p><div class="figure"><a id="iso_recorder_creation_wizard"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00050"/><img src="httpatomoreillycomsourcenostarchimages2208969.png.jpg" alt="ISO Recorder Creation Wizard"/></div></div><p class="title">Figure 6-1. ISO Recorder Creation Wizard</p></div><p>Under Create image, select the <span class="strong"><strong>Directory</strong></span> radio button, change the Image format to <span class="strong"><strong>CD</strong></span>, click <span class="strong"><strong>Next</strong></span>, and follow the prompts to create your ISO image. After you have a Juniper ISO, you’re ready to install Juniper Olive on Windows.</p></div><div class="sect2" title="Creating an ISO in OS X"><div class="titlepage"><div><div><h2 class="title"><a id="creating_an_iso_in_os_x"/>Creating an ISO in OS X</h2></div></div></div><p>On computers running OS X, copy your Juniper image file to a folder and use <code class="literal">hdiutil</code> to create an ISO image of the folder’s contents. In the following listing, I’ve created an ISO image file named <span class="emphasis"><em>juniper-olive.iso</em></span> using a folder named <span class="emphasis"><em>JUNOS</em></span>:</p><a id="pro_id00040"/><pre class="programlisting">$ <span class="strong"><strong>mkdir JUNOS</strong></span>
$ <span class="strong"><strong>cp jinstall-12.1R1.9-domestic.tgz JUNOS</strong></span>
$ <span class="strong"><strong>hdiutil makehybrid -iso -joliet -o juniper-olive.iso JUNOS</strong></span></pre><p>Now that you have a suitable ISO of the Olive software, you’re ready to install Juniper Olive on OS X.</p></div><div class="sect2" title="Creating an ISO in Linux"><div class="titlepage"><div><div><h2 class="title"><a id="creating_an_iso_in_linux"/>Creating an ISO in Linux</h2></div></div></div><p>Creating an ISO image on Ubuntu Linux is almost the same as on OS X, except you use the <code class="literal">mkisofs</code> application. Copy your Juniper image file to a folder (<span class="emphasis"><em>JUNOS</em></span>, for example) and enter the following commands to create the ISO:</p><a id="pro_id00041"/><pre class="programlisting">$ <span class="strong"><strong>mkdir JUNOS</strong></span>
$ <span class="strong"><strong>cp jinstall-12.1R1.9-domestic.tgz JUNOS</strong></span>
$ <span class="strong"><strong>mkisofs -o juniper-olive.iso JUNOS</strong></span></pre><p><a id="iddle1081" class="indexterm"/><a id="iddle1385" class="indexterm"/><a id="iddle1391" class="indexterm"/><a id="iddle1392" class="indexterm"/><a id="iddle1693" class="indexterm"/><a id="iddle1925" class="indexterm"/><a id="iddle2009" class="indexterm"/><a id="iddle2017" class="indexterm"/><a id="iddle2026" class="indexterm"/><a id="iddle2027" class="indexterm"/><a id="iddle2033" class="indexterm"/><a id="iddle2208" class="indexterm"/>Now that you have your ISO, there are only a few things left to do before you create a Juniper Olive.</p></div></div><div class="sect1" title="Installing and Configuring FreeBSD Using QEMU"><div class="titlepage"><div><div><h1 class="title"><a id="installing_and_configuring_freebsd_using"/>Installing and Configuring FreeBSD Using QEMU</h1></div></div></div><p>The first step in creating a Juniper Olive is to create a QEMU virtual machine of FreeBSD. QEMU doesn’t have a graphical user interface, so you’ll do everything from the command line. You will use the <code class="literal">qemu-img</code> program to create a virtual disk image file and the <code class="literal">qemu</code> program to install and test your virtual machine.</p><div class="note" title="Note"><h3 class="title"><a id="ch06note03"/>Note</h3><p><span class="emphasis"><em>Not all QEMU installations are alike. On some installations, the QEMU application file might be named</em></span> qemu-system-i386 <span class="emphasis"><em>or</em></span> qemu-system-x86_64<span class="emphasis"><em>, or you may have both installed. If you’re unsure, check your QEMU installation directory.</em></span></p></div><div class="sect2" title="Preparing Your Build Directory"><div class="titlepage"><div><div><h2 class="title"><a id="preparing_your_build_directory"/>Preparing Your Build Directory</h2></div></div></div><p>Start by creating a build directory and then copy the FreeBSD installation ISO and the Juniper Olive ISO files to the directory, as in the following example:</p><a id="pro_id00042"/><pre class="programlisting">$ <span class="strong"><strong>mkdir Juniper</strong></span>
$ <span class="strong"><strong>cp 4.11-RELEASE-i386-miniinst.iso Juniper</strong></span>
$ <span class="strong"><strong>cp juniper-olive.iso Juniper</strong></span></pre><p>If you’re using Windows, open a command prompt window and enter the following commands instead:</p><a id="pro_id00043"/><pre class="programlisting">c: <span class="strong"><strong>mkdir Juniper</strong></span>
c: <span class="strong"><strong>copy 4.11-RELEASE-i386-miniinst.iso Juniper</strong></span>
c: <span class="strong"><strong>copy juniper-olive.iso Juniper</strong></span></pre><p>Now that everything is prepped in your build directory, you can begin installing the system.</p></div><div class="sect2" title="Installing a Junos-Friendly FreeBSD System"><div class="titlepage"><div><div><h2 class="title"><a id="installing_a_junos-friendly_freebsd_syst"/>Installing a Junos-Friendly FreeBSD System</h2></div></div></div><p>In this section, you’ll create a virtual hard disk using <code class="literal">qemu-img</code> and install FreeBSD on the virtual disk. I’ll only cover the basics of preparing FreeBSD for Olive and won’t go into a lot of detail about FreeBSD itself.</p><div class="sect3" title="Preliminary Checks for Windows and OS X"><div class="titlepage"><div><div><h3 class="title"><a id="preliminary_checks_for_windows_and_os_x"/>Preliminary Checks for Windows and OS X</h3></div></div></div><p>If you’re a Windows user, install the Telnet Client application from the Programs and Features Control Panel before you begin.</p><p>If you’re a OS X user, you’ll want to add the QEMU file directory to your OS X search path. Verify the installation path to your QEMU files. If you installed QEMU manually, you should look for the <span class="emphasis"><em>qemu-img</em></span> file in <span class="emphasis"><em>/opt/local/bin</em></span> or <span class="emphasis"><em>/usr/local/bin</em></span>. If you’re using QEMU that was installed <a id="iddle1393" class="indexterm"/><a id="iddle1685" class="indexterm"/><a id="iddle1707" class="indexterm"/><a id="iddle2025" class="indexterm"/><a id="iddle2034" class="indexterm"/><a id="iddle2316" class="indexterm"/>with GNS3, you should find the file under <span class="emphasis"><em>/Applications/GNS3.app/Contents/Resources/qemu/bin/</em></span>. Enter the following commands to add the QEMU binaries to your OS X search path. Make a backup copy of your <code class="literal">.bash_profile</code> file before you begin.</p><a id="pro_id00044"/><pre class="programlisting">$ <span class="strong"><strong>cd ~</strong></span>
$ <span class="strong"><strong>cp .bash_profile .bash_profile-backup</strong></span>
$ <span class="strong"><strong>sudo echo 'export PATH=/Applications/GNS3.app/Contents/Resources/qemu/</strong></span>
<span class="strong"><strong>bin:$PATH' &gt;&gt; .bash_profile</strong></span></pre><p>After entering the commands, close and reopen a terminal window to enable the new search path. To verify your path is correct, enter the following command:</p><a id="pro_id00045"/><pre class="programlisting">$ <span class="strong"><strong>echo $PATH</strong></span></pre><p>The previous command will display your path configuration. If it’s not correct, you may need to restore your <span class="emphasis"><em>.bash_profile-backup</em></span> file and try again. If it is correct, then you’re ready to move on.</p></div><div class="sect3" title="Getting Started"><div class="titlepage"><div><div><h3 class="title"><a id="getting_started"/>Getting Started</h3></div></div></div><p>Begin the installation by creating an 8GB virtual disk image file named <span class="emphasis"><em>juniper.img</em></span> in your build directory. The <span class="emphasis"><em>qemu-img</em></span> command options used here should work on all Unix-like systems.</p><a id="pro_id00046"/><pre class="programlisting">$ <span class="strong"><strong>cd Juniper</strong></span>
$ <span class="strong"><strong>qemu-img create juniper.img 8G</strong></span></pre><p>Next, boot QEMU from the FreeBSD mini ISO using the following command:</p><a id="pro_id00047"/><pre class="programlisting">$ <span class="strong"><strong>qemu-system-i386 -m 512 -hda juniper.img -localtime -cdrom 4.11-RELEASE</strong></span>
<span class="strong"><strong>i386-miniinst.iso</strong></span></pre><p>Windows users should open a command prompt window and use the following commands instead. Be sure to enter the <code class="literal">path</code> command if QEMU isn’t already in your Windows path.</p><a id="pro_id00048"/><pre class="programlisting">c: <span class="strong"><strong>cd Juniper</strong></span>
c: <span class="strong"><strong>path="c:\program files\GNS3\qemu-0.13.0"</strong></span>
c: <span class="strong"><strong>qemu-img create juniper.img 8G</strong></span>
c: <span class="strong"><strong>qemu-system-i386w -m 512 -hda juniper.img -localtime -cdrom 4.11-RELEASE-</strong></span>
<span class="strong"><strong>i386-miniinst.iso</strong></span></pre><p>When FreeBSD boots, the Kernel Configuration Menu appears, as shown in <a class="xref" href="ch06.html#freebsd_kernel_configuration_menu" title="Figure 6-2. FreeBSD Kernel Configuration Menu">Figure 6-2</a>.</p><div class="figure"><a id="freebsd_kernel_configuration_menu"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00051"/><img src="httpatomoreillycomsourcenostarchimages2208971.png.jpg" alt="FreeBSD Kernel Configuration Menu"/></div></div><p class="title">Figure 6-2. FreeBSD Kernel Configuration Menu</p></div><p><a id="iddle1374" class="indexterm"/><a id="iddle1390" class="indexterm"/><a id="iddle1692" class="indexterm"/><a id="iddle1708" class="indexterm"/><a id="iddle1936" class="indexterm"/><a id="iddle2016" class="indexterm"/><a id="iddle2024" class="indexterm"/><a id="iddle2195" class="indexterm"/>Press <span class="smaller">ENTER</span> to skip the kernel configuration and continue with the installation.</p><p>Next, the FreeBSD sysinstall Main Menu appears, shown in <a class="xref" href="ch06.html#sysinstall_main_menu" title="Figure 6-3. sysinstall Main Menu">Figure 6-3</a>.</p><div class="figure"><a id="sysinstall_main_menu"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00052"/><img src="httpatomoreillycomsourcenostarchimages2208973.png.jpg" alt="sysinstall Main Menu"/></div></div><p class="title">Figure 6-3. sysinstall Main Menu</p></div><p>Use the arrow to move down, select <span class="strong"><strong>Standard</strong></span> to begin a standard installation, and then press <span class="smaller">ENTER</span> to continue.</p></div><div class="sect3" title="Partitioning the Filesystem"><div class="titlepage"><div><div><h3 class="title"><a id="partitioning_the_filesystem"/>Partitioning the Filesystem</h3></div></div></div><p>The next screen, shown in <a class="xref" href="ch06.html#fdisk_partitioning_message_screen" title="Figure 6-4. FDISK partitioning message screen">Figure 6-4</a>, displays basic information about using the FDISK Partition Editor.</p><div class="figure"><a id="fdisk_partitioning_message_screen"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00053"/><img src="httpatomoreillycomsourcenostarchimages2208975.png.jpg" alt="FDISK partitioning message screen"/></div></div><p class="title">Figure 6-4. FDISK partitioning message screen</p></div><p><a id="iddle1518" class="indexterm"/>Read the instructions and press <span class="smaller">ENTER</span> to continue to the FDISK Partition Editor menu, shown in <a class="xref" href="ch06.html#fdisk_partition_editor_menu" title="Figure 6-5. FDISK Partition Editor menu">Figure 6-5</a>.</p><div class="figure"><a id="fdisk_partition_editor_menu"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00054"/><img src="httpatomoreillycomsourcenostarchimages2208977.png.jpg" alt="FDISK Partition Editor menu"/></div></div><p class="title">Figure 6-5. FDISK Partition Editor menu</p></div><p>The FDISK Partition Editor allows you to choose how much disk space you want to allocate to FreeBSD. Choose <span class="strong"><strong>A</strong></span> to use the entire disk and then select <span class="strong"><strong>Q</strong></span> to finish.</p><p>The Install Boot Manager menu should appear next, as shown in <a class="xref" href="ch06.html#install_boot_manager_menu" title="Figure 6-6. Install Boot Manager menu">Figure 6-6</a>.</p><div class="figure"><a id="install_boot_manager_menu"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00055"/><img src="httpatomoreillycomsourcenostarchimages2208979.png.jpg" alt="Install Boot Manager menu"/></div></div><p class="title">Figure 6-6. Install Boot Manager menu</p></div><p><a id="iddle1519" class="indexterm"/>Use the arrow to move down, select <span class="strong"><strong>Standard</strong></span> to install a standard master boot record (MBR), and press <span class="smaller">ENTER</span> to continue.</p><p>FreeBSD then displays a message about creating BSD partitions inside your newly created FDISK partition, as shown in <a class="xref" href="ch06.html#bsd_partition_message" title="Figure 6-7. BSD partition message">Figure 6-7</a>.</p><div class="figure"><a id="bsd_partition_message"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00056"/><img src="httpatomoreillycomsourcenostarchimages2208981.png.jpg" alt="BSD partition message"/></div></div><p class="title">Figure 6-7. BSD partition message</p></div><p>After reading the message, press <span class="smaller">ENTER</span> to continue to the FreeBSD Disklabel Editor.</p><p><a id="iddle1704" class="indexterm"/>The next step is to create <span class="emphasis"><em>Juniper-compatible partitions</em></span>. It’s important to pay close attention to how you partition the virtual hard disk because the Juniper Olive package must see the correct FreeBSD partitions or the installation will fail. You also must create your partitions in a specific order.</p><p>To create your first partition, select <span class="strong"><strong>C</strong></span> and type the partition size in the field provided, as shown in <a class="xref" href="ch06.html#specify_a_partition_size" title="Figure 6-8. Specify a partition size.">Figure 6-8</a>.</p><div class="figure"><a id="specify_a_partition_size"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00057"/><img src="httpatomoreillycomsourcenostarchimages2208983.png.jpg" alt="Specify a partition size."/></div></div><p class="title">Figure 6-8. Specify a partition size.</p></div><p>I entered 1024M to create a 1GB partition. Press <span class="smaller">ENTER</span> to accept this value, and you’ll see the partition type option screen, shown in <a class="xref" href="ch06.html#choose_a_partition_type" title="Figure 6-9. Choose a partition type.">Figure 6-9</a>.</p><div class="figure"><a id="choose_a_partition_type"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00058"/><img src="httpatomoreillycomsourcenostarchimages2208985.png.jpg" alt="Choose a partition type."/></div></div><p class="title">Figure 6-9. Choose a partition type.</p></div><p><a id="iddle2062" class="indexterm"/>Press <span class="smaller">ENTER</span> to create a filesystem (FS) partition type, and you’ll be given the option to choose the mount point for the partition, as shown in <a class="xref" href="ch06.html#choose_a_mount_point_for_the_partitiondo" title="Figure 6-10. Choose a mount point for the partition.">Figure 6-10</a>.</p><div class="figure"><a id="choose_a_mount_point_for_the_partitiondo"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00059"/><img src="httpatomoreillycomsourcenostarchimages2208987.png.jpg" alt="Choose a mount point for the partition."/></div></div><p class="title">Figure 6-10. Choose a mount point for the partition.</p></div><p>To create a mount point for your root partition, type a forward slash (<span class="strong"><strong><code class="literal">/</code></strong></span>) and press <span class="smaller">ENTER</span> to complete the configuration of your first partition.</p><p>Using <a class="xref" href="ch06.html#freebsd_partitioning_for_juniper_olive" title="Table 6-1. FreeBSD Partitioning for Juniper Olive">Table 6-1</a>, follow the same procedure to create the complete filesystem layout. The order is important! After creating your root partition (<code class="literal">/</code>), work your way down the list, finishing with the <code class="literal">/var</code> partition. When you get to the swap partition, make sure you choose <code class="literal">swap</code> and not <code class="literal">FS</code> as your partition type. The <code class="literal">/var</code> partition is last, so when you create it, accept the default partition block size. This value uses the remaining free space on your partition. Remember, if the partitions are not created in sequential order, the partition names won’t match the mount points, and Juniper Olive won’t install properly.</p><div class="table"><a id="freebsd_partitioning_for_juniper_olive"/><p class="title">Table 6-1. FreeBSD Partitioning for Juniper Olive</p><div class="table-contents"><table summary="FreeBSD Partitioning for Juniper Olive" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col/><col/><col/></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Part</p></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>Mount</p></th><th style="border-bottom: 0.5pt solid ; " valign="top"><p>Size</p></th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>ad0s1a</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p><code class="literal">/</code></p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>1024 MB</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>ad0s1b</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p><code class="literal">swap</code></p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>1024 MB</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p>ad0s1e</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " valign="top"><p><code class="literal">/config</code></p></td><td style="border-bottom: 0.5pt solid ; " valign="top"><p>1024 MB</p></td></tr><tr><td style="border-right: 0.5pt solid ; " valign="top"><p>ad0s1f</p></td><td style="border-right: 0.5pt solid ; " valign="top"><p><code class="literal">/var</code></p></td><td style="" valign="top"><p>remaining space</p></td></tr></tbody></table></div></div><p>There are many ways to partition FreeBSD in preparation for the Olive install, but I’ve found this method to be the most reliable across different versions of Juniper Olive. When you’re done, the filesystem should look exactly like the one in <a class="xref" href="ch06.html#fully_configured_partition_layout_suitab" title="Figure 6-11. Fully configured partition layout suitable for Juniper Olive">Figure 6-11</a>.</p><div class="figure"><a id="fully_configured_partition_layout_suitab"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00060"/><img src="httpatomoreillycomsourcenostarchimages2208989.png.jpg" alt="Fully configured partition layout suitable for Juniper Olive"/></div></div><p class="title">Figure 6-11. Fully configured partition layout suitable for Juniper Olive</p></div><p>Once you’ve configured all the partitions, choose <span class="strong"><strong>Q</strong></span> to complete the partitioning process and then choose your distribution set, as shown in <a class="xref" href="ch06.html#freebsd_distribution_choices" title="Figure 6-12. FreeBSD distribution choices">Figure 6-12</a>.</p><div class="figure"><a id="freebsd_distribution_choices"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00061"/><img src="httpatomoreillycomsourcenostarchimages2208991.png.jpg" alt="FreeBSD distribution choices"/></div></div><p class="title">Figure 6-12. FreeBSD distribution choices</p></div><p>Use the arrow keys to scroll down, select <span class="strong"><strong>Minimal</strong></span>, and then press the spacebar to make the selection. Now press <span class="smaller">TAB</span> to select <span class="strong"><strong>OK</strong></span> and press <span class="smaller">ENTER</span> to finish.</p></div><div class="sect3" title="Finishing Installation of FreeBSD"><div class="titlepage"><div><div><h3 class="title"><a id="finishing_installation_of_freebsd"/>Finishing Installation of FreeBSD</h3></div></div></div><p><a id="iddle1386" class="indexterm"/><a id="iddle1520" class="indexterm"/><a id="iddle1525" class="indexterm"/><a id="iddle1688" class="indexterm"/>Next, choose your installation media, as shown in <a class="xref" href="ch06.html#choosing_an_installation_media" title="Figure 6-13. Choosing an installation media">Figure 6-13</a>.</p><div class="figure"><a id="choosing_an_installation_media"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00062"/><img src="httpatomoreillycomsourcenostarchimages2208993.png.jpg" alt="Choosing an installation media"/></div></div><p class="title">Figure 6-13. Choosing an installation media</p></div><p>Press <span class="smaller">ENTER</span> to choose <span class="strong"><strong>CD/DVD</strong></span> as your installation media, and the installation will begin. When it’s finished, the message shown in <a class="xref" href="ch06.html#file_installation_complete_message" title="Figure 6-14. File installation complete message">Figure 6-14</a> appears.</p><div class="figure"><a id="file_installation_complete_message"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00063"/><img src="httpatomoreillycomsourcenostarchimages2208995.png.jpg" alt="File installation complete message"/></div></div><p class="title">Figure 6-14. File installation complete message</p></div><p>Because you’re using FreeBSD as a host for Junos OS, you don’t need to concern yourself with any of the FreeBSD configuration questions that follow this screen. Answer “no” to all remaining questions, and when asked to <a id="iddle1112" class="indexterm"/><a id="iddle1388" class="indexterm"/><a id="iddle1534" class="indexterm"/><a id="iddle1689" class="indexterm"/><a id="iddle1705" class="indexterm"/><a id="iddle1823" class="indexterm"/>create a password for the root account, press <span class="smaller">ENTER</span> to leave it blank. When you’re finished answering questions, allow the system to reboot, log on as <span class="emphasis"><em>root</em></span>, and shut down FreeBSD using the <code class="literal">halt</code> command. Then close the window and quit the QEMU program.</p></div></div></div><div class="sect1" title="Installing the Juniper Olive Package in FreeBSD"><div class="titlepage"><div><div><h1 class="title"><a id="installing_the_juniper_olive_package_in"/>Installing the Juniper Olive Package in FreeBSD</h1></div></div></div><p>Now that the FreeBSD installation is complete, you can install the Juniper Olive package.</p><div class="sect2" title="Getting Your Olive Up and Running"><div class="titlepage"><div><div><h2 class="title"><a id="getting_your_olive_up_and_running"/>Getting Your Olive Up and Running</h2></div></div></div><p>Boot FreeBSD using QEMU with the following command to ensure that you can mount the <span class="emphasis"><em>juniper-olive.iso</em></span> CD image file you created earlier. (On Windows, replace <code class="literal">qemu-system-i386</code> with <code class="literal">qemu-system-i386w</code>.)</p><a id="pro_id00049"/><pre class="programlisting"><span class="strong"><strong>qemu-system-i386 -m 512 -hda juniper.img -localtime -cdrom juniper-olive.iso</strong></span></pre><p>If FreeBSD loads correctly, a login prompt should appear. Log in as <span class="emphasis"><em>root</em></span> at the prompt; you shouldn’t need to enter a password, so just press <span class="smaller">ENTER</span>. Then use the <code class="literal">mount</code> command to mount the <span class="emphasis"><em>juniper-olive.iso</em></span> CD image.</p><a id="pro_id00050"/><pre class="programlisting"># <span class="strong"><strong>mount /cdrom</strong></span></pre><p>Create a temporary directory named <span class="emphasis"><em>olive</em></span> on the <code class="literal">/var</code> partition and extract the Juniper Olive package into the temporary directory.</p><a id="pro_id00051"/><pre class="programlisting"># <span class="strong"><strong>mkdir /var/tmp/olive</strong></span>
# <span class="strong"><strong>cd /var/tmp/olive</strong></span>
# <span class="strong"><strong>tar zxvf /cdrom/jinstall-12.1R1.9-domestic.tgz</strong></span></pre><p>Next, modify Junos OS to allow you to install the software on your QEMU virtual machine.</p><a id="pro_id00052"/><pre class="programlisting"># <span class="strong"><strong>mkdir temp</strong></span>
# <span class="strong"><strong>cd temp</strong></span>
# <span class="strong"><strong>tar zxvf ../pkgtools.tgz</strong></span>
# <span class="strong"><strong>cp /usr/bin/true bin/checkpic</strong></span></pre><p>Extract the <span class="emphasis"><em>pkgtools</em></span> directory from <span class="emphasis"><em>pkgtools.tgz</em></span> to another <span class="emphasis"><em>temp</em></span> directory within the <span class="emphasis"><em>olive</em></span> directory, and replace the <span class="emphasis"><em>checkpic</em></span> file with the FreeBSD <span class="emphasis"><em>true</em></span> file. This removes the Junos OS checkpic protection.</p><p>After the modification, gzip the <span class="emphasis"><em>temp</em></span> directory contents back into a tarball named <span class="emphasis"><em>pkgtools.tgz</em></span> and remove the <span class="emphasis"><em>temp</em></span> directory you created.</p><a id="pro_id00053"/><pre class="programlisting"># <span class="strong"><strong>tar zcvf ../pkgtools.tgz *</strong></span>
# <span class="strong"><strong>cd ..</strong></span>
# <span class="strong"><strong>rm -rf temp</strong></span></pre><p><a id="iddle1447" class="indexterm"/><a id="iddle1521" class="indexterm"/><a id="iddle2046" class="indexterm"/>Next, create a new Olive installation package and install it on your FreeBSD system. In the following listing, I’ve named the installation package <span class="emphasis"><em>olive.tgz</em></span>:</p><a id="pro_id00054"/><pre class="programlisting"># <span class="strong"><strong>tar zcvf ../olive.tgz *</strong></span>
# <span class="strong"><strong>pkg_add -f ../olive.tgz</strong></span></pre><p>After you install the Olive package, you should see an error message followed by some warning messages, which tell you that the package will erase any files that aren’t Junos configuration files and that you need to reboot to load the Junos OS software.</p><p>Any other onscreen instructions displayed can be ignored because they apply to an actual Juniper router, not an Olive installation on a PC. However, before continuing, you need to shut down the FreeBSD system using the <code class="literal">halt</code> command and quit QEMU.</p><a id="pro_id00055"/><pre class="programlisting"># <span class="strong"><strong>halt</strong></span></pre><p>The final step in installing Olive is to reboot the system and give the package time to complete its takeover of FreeBSD. At this point, you must provide the installer with extra memory, or the install will fail. Although Junos OS runs comfortably with 512MB of RAM, the installer needs 1024MB of RAM to create the RAM disk that it uses during installation.</p><p>In Linux and OS X, boot Juniper Olive with 1024MB of RAM to complete the installation, as follows:</p><a id="pro_id00056"/><pre class="programlisting">$ <span class="strong"><strong>sudo qemu-system-i386 -m 1024 -hda juniper.img -serial telnet:127.0.0.1:1001,</strong></span>
<span class="strong"><strong>server,nowait,nodelay -localtime</strong></span></pre><p>Windows users should enter the following command instead:</p><a id="pro_id00057"/><pre class="programlisting">c: <span class="strong"><strong>qemu-system-i386w -m 1024 -hda juniper.img -serial telnet:127.0.0.1:1001,</strong></span>
<span class="strong"><strong>server,nowait,nodelay -localtime</strong></span></pre><p>After you boot the system, you can watch the Olive software being installed by using telnet to connect to port 1001 of your localhost. (On Windows you may have to install the Telnet Client program from the Programs and Features Control Panel first.) Open a second Windows command prompt or terminal window, and enter the following command to see the installation output displayed on the console:</p><a id="pro_id00058"/><pre class="programlisting"><span class="strong"><strong>telnet localhost 1001</strong></span></pre><p>I highly recommend monitoring your install. It’s a great way to troubleshoot whether something goes wrong. Otherwise, you won’t know why an installation failed. A common problem is that not enough memory has been allocated to your virtual machine; another is that your partition sizes are too small or were created incorrectly.</p><p><a id="iddle1058" class="indexterm"/><a id="iddle1298" class="indexterm"/><a id="iddle1682" class="indexterm"/>The Juniper Olive installation can take 15 minutes or longer, depending on your hardware, because the installer performs a lot of tasks, such as repartitioning your FreeBSD hard drive and extracting various packages. When everything is complete, the system should automatically reboot, load Junos OS, and present you with what appears to be a FreeBSD login prompt, shown in <a class="xref" href="ch06.html#successful_junos_os_boot_messages_and_lo" title="Figure 6-15. Successful Junos OS boot messages and login">Figure 6-15</a>.</p><div class="figure"><a id="successful_junos_os_boot_messages_and_lo"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00064"/><img src="httpatomoreillycomsourcenostarchimages2208997.png.jpg" alt="Successful Junos OS boot messages and login"/></div></div><p class="title">Figure 6-15. Successful Junos OS boot messages and login</p></div><p>This prompt is where you’ll log in to Junos OS. If you see the previous messages and the login prompt, then your Juniper router is ready to use.</p></div><div class="sect2" title="Backing Up Juniper Olive"><div class="titlepage"><div><div><h2 class="title"><a id="backing_up_juniper_olive"/>Backing Up Juniper Olive</h2></div></div></div><p>After you create a working Olive, make a backup copy of the image for safekeeping. After all, who wants to go through all that work again? Not me!</p><p>First, properly shut down Junos OS to prevent triggering a dirty filesystem. A dirty filesystem occurs when files have not been properly closed. This condition can cause file corruption and can even break the Junos operating system. If the filesystem is marked as dirty, a filesystem check is triggered the next time you start Junos OS, and it may take longer than usual to boot until the system is checked and marked clean again (meaning no errors were found, or all errors were fixed).</p><p>To shut down Junos OS, log in as <span class="emphasis"><em>root</em></span> (no password necessary) and enter the following commands:</p><a id="pro_id00059"/><pre class="programlisting">Login: <span class="strong"><strong>root</strong></span>
root@% <span class="strong"><strong>cli</strong></span>
root&gt; <span class="strong"><strong>request system halt</strong></span>
Halt the system ? [yes,no] (no) <span class="strong"><strong>yes</strong></span></pre><p><a id="iddle1212" class="indexterm"/><a id="iddle1683" class="indexterm"/><a id="iddle2028" class="indexterm"/><a id="iddle2080" class="indexterm"/>It’s safe to quit QEMU after you see a message indicating that the operating system has halted, as shown here:</p><a id="pro_id00060"/><pre class="programlisting">The operating system has halted.
Please press any key to reboot.</pre><p>To make a backup copy of your Juniper image, enter the following command from the directory where your image file is saved:</p><a id="pro_id00061"/><pre class="programlisting">$ <span class="strong"><strong>cp juniper.img backup-juniper.img</strong></span></pre><p>Windows users can use this command instead:</p><a id="pro_id00062"/><pre class="programlisting">c: <span class="strong"><strong>copy juniper.img backup-juniper.img</strong></span></pre><p>Now that you have a Juniper router, you need to configure GNS3 so it can be used in your projects.</p></div></div><div class="sect1" title="Configuring a Juniper Router in GNS3"><div class="titlepage"><div><div><h1 class="title"><a id="configuring_a_juniper_router_in_gns3"/>Configuring a Juniper Router in GNS3</h1></div></div></div><p>To configure a Juniper router in GNS3, select <span class="strong"><strong>Edit</strong></span> ▸ <span class="strong"><strong>Preferences</strong></span> on Windows and Linux or <span class="strong"><strong>GNS3</strong></span> ▸ <span class="strong"><strong>Preferences</strong></span> on OS X. Double-click <a class="firstterm" href="apd.html#gloss01_050"><em class="firstterm">QEMU</em></a> from the sidebar and select <span class="strong"><strong>QEMU VMs</strong></span> to open the QEMU VMs preferences window, shown in <a class="xref" href="ch06.html#qemu_vms_preferences_window" title="Figure 6-16. QEMU VMs preferences window">Figure 6-16</a>.</p><div class="figure"><a id="qemu_vms_preferences_window"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00065"/><img src="httpatomoreillycomsourcenostarchimages2208999.png.jpg" alt="QEMU VMs preferences window"/></div></div><p class="title">Figure 6-16. QEMU VMs preferences window</p></div><p><a id="iddle1063" class="indexterm"/><a id="iddle1358" class="indexterm"/><a id="iddle1681" class="indexterm"/><a id="iddle1859" class="indexterm"/><a id="iddle1887" class="indexterm"/><a id="iddle2008" class="indexterm"/><a id="iddle2014" class="indexterm"/><a id="iddle2021" class="indexterm"/><a id="iddle2035" class="indexterm"/><a id="iddle2037" class="indexterm"/>From here you can create, edit, and delete QEMU virtual machines, allowing you to bring your Juniper virtual machine into GNS3.</p><div class="sect2" title="Adding the Juniper Virtual Machine to GNS3"><div class="titlepage"><div><div><h2 class="title"><a id="adding_the_juniper_virtual_machine_to_gn"/>Adding the Juniper Virtual Machine to GNS3</h2></div></div></div><p>To add your Juniper virtual machine to GNS3, click <span class="strong"><strong>New</strong></span> to start the New QEMU VM wizard. Enter a name for your virtual machine and leave Type set to <span class="strong"><strong>Default</strong></span>. Click <span class="strong"><strong>Next</strong></span> to set the QEMU binary and memory options, shown in <a class="xref" href="ch06.html#setting_qemu_binary_and_memory" title="Figure 6-17. Setting QEMU binary and memory">Figure 6-17</a>.</p><div class="figure"><a id="setting_qemu_binary_and_memory"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00066"/><img src="httpatomoreillycomsourcenostarchimages2209001.png.jpg" alt="Setting QEMU binary and memory"/></div></div><p class="title">Figure 6-17. Setting QEMU binary and memory</p></div><p>Select <span class="strong"><strong>qemu-system-i386</strong></span> from the Qemu binary drop-down menu. You’re choosing this QEMU program because Juniper Olive runs on a 32-bit version of FreeBSD. Give your Olive 512MB of RAM and then click <span class="strong"><strong>Next</strong></span>. Click <span class="strong"><strong>Browse</strong></span> to locate and select the <span class="emphasis"><em>juniper.img</em></span> file that you created previously, and then click <span class="strong"><strong>Finish</strong></span>.</p><div class="note" title="Note"><h3 class="title"><a id="ch06note04"/>Note</h3><p><span class="emphasis"><em>Two QEMU binary applications are often used in GNS3: <code class="literal">qemu-system-i386</code> and <code class="literal">qemu-system-x86_64</code>. The difference between them is that <code class="literal">qemu-system-i386</code> is designed to emulate 32-bit architecture, and <code class="literal">qemu-system-x86_64</code> is designed to emulate 64-bit architecture. The <code class="literal">qemu-system-x86_64</code> application is supposed to be 32-bit backward compatible, but it is not compatible with all 32-bit virtual machines (including IOS-XRv, for example).</em></span></p></div></div><div class="sect2" title="Adding Ethernet Interfaces"><div class="titlepage"><div><div><h2 class="title"><a id="adding_ethernet_interfaces"/>Adding Ethernet Interfaces</h2></div></div></div><p>After creating your virtual machine, go back and add more Ethernet interfaces. I recommend using six interfaces. Highlight your virtual machine and select <span class="strong"><strong>Edit</strong></span>. Click the <span class="strong"><strong>Network</strong></span> tab and change the number of interfaces to 6. Now select the <span class="strong"><strong>Advanced settings</strong></span> tab and enter the <span class="strong"><strong>-nographic</strong></span> option under Additional settings, as shown in <a class="xref" href="ch06.html#qemu_advanced_options" title="Figure 6-18. QEMU advanced options">Figure 6-18</a>.</p><div class="figure"><a id="qemu_advanced_options"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00067"/><img src="httpatomoreillycomsourcenostarchimages2209003.png.jpg" alt="QEMU advanced options"/></div></div><p class="title">Figure 6-18. QEMU advanced options</p></div><p><a id="iddle1163" class="indexterm"/><a id="iddle1696" class="indexterm"/><a id="iddle2081" class="indexterm"/><a id="iddle2217" class="indexterm"/>The -nographic option prevents the QEMU GUI interface from displaying when you start your QEMU virtual machine. Although the GUI can be useful in troubleshooting a virtual machine, it’s more often a nuisance and should be disabled. This option can be used with any QEMU virtual machine, not only Juniper. When you’re done, click <span class="strong"><strong>OK</strong></span> to close the window and then click <span class="strong"><strong>Apply</strong></span> and <span class="strong"><strong>OK</strong></span> to save all your changes.</p></div></div><div class="sect1" title="Testing a Juniper Router"><div class="titlepage"><div><div><h1 class="title"><a id="testing_a_juniper_router"/>Testing a Juniper Router</h1></div></div></div><p>Before creating projects that include Juniper routers, it’s a good idea to test connectivity between a Cisco router and a Juniper router. If you’re unable to successfully ping between the devices, there might be a problem with your installation, and it’s better to find out early before you spend hours designing a project that doesn’t work.</p><p>Drag a Cisco router node and a Juniper router node to your workspace from the Devices toolbar, and create a link from the Cisco router to interface e0 of the Juniper router, as shown in <a class="xref" href="ch06.html#connecting_a_cisco_router_to_a_juniper_r" title="Figure 6-19. Connecting a Cisco router to a Juniper router">Figure 6-19</a>.</p><p>Start the routers and open a console to the Cisco router. Assign an IP address to the interface that’s connected to your Juniper router (f0/0, in this example).</p><div class="figure"><a id="connecting_a_cisco_router_to_a_juniper_r"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00068"/><img src="httpatomoreillycomsourcenostarchimages2209005.png.jpg" alt="Connecting a Cisco router to a Juniper router"/></div></div><p class="title">Figure 6-19. Connecting a Cisco router to a Juniper router</p></div><a id="pro_id00063"/><pre class="programlisting">R1&gt; <span class="strong"><strong>enable</strong></span>
R1# <span class="strong"><strong>configure-terminal</strong></span>
R1(config)# <span class="strong"><strong>interface f0/0</strong></span>
R1(config-if)# <span class="strong"><strong>ip address 10.10.10.1 255.255.255.0</strong></span>
R1(config-if)# <span class="strong"><strong>no shutdown</strong></span></pre><p><a id="iddle1228" class="indexterm"/><a id="iddle1694" class="indexterm"/><a id="iddle1702" class="indexterm"/><a id="iddle1958" class="indexterm"/><a id="iddle2359" class="indexterm"/>Now open a console to your Juniper router, log on, and configure an IP address using the same subnet as your Cisco router.</p><a id="pro_id00064"/><pre class="programlisting">  Login: <span class="strong"><strong>root</strong></span>
  root@% <span class="strong"><strong>cli</strong></span>
  root&gt; <span class="strong"><strong>edit</strong></span>
➊ root# <span class="strong"><strong>set system root-authentication plain-text password</strong></span>
  New password: <span class="strong"><strong>olive1</strong></span>
  Retype new password: <span class="strong"><strong>olive1</strong></span>
  root# <span class="strong"><strong>set interfaces em0 unit 0 family inet address 10.10.10.2/24</strong></span>
  root# <span class="strong"><strong>commit</strong></span>
  commit complete</pre><p>For security, Junos OS requires that you assign a root password ➊ before you can commit any other configuration changes to the router, so do that now. I set the password to <span class="emphasis"><em>olive1</em></span>, but you can enter any password you want.</p><div class="note" title="Note"><h3 class="title"><a id="ch06note05"/>Note</h3><p><span class="emphasis"><em>In this example, you can see that Juniper syntax is entirely different from Cisco syntax. If Juniper syntax is new to you, visit the Juniper website</em></span> (<a class="ulink" href="http://www.juniper.net/">http://www.juniper.net/</a>) <span class="emphasis"><em>for detailed information about configuring Juniper routers.</em></span></p></div><p>After configuring both devices, ping your Cisco router to test connectivity.</p><a id="pro_id00065"/><pre class="programlisting">root# <span class="strong"><strong>exit</strong></span>
root&gt; <span class="strong"><strong>ping 10.10.10.1</strong></span></pre><p>If the ping test fails, there could be a problem with your IP addresses or QEMU installation. If you compiled QEMU from source code, verify that you installed a version known to work with Juniper Olive. If necessary, compile and reinstall QEMU again. If the problem persists, try installing or compiling another version of QEMU.</p><p>You can also create an Olive using VirtualBox. The procedure is basically the same as QEMU, but you’ll use the VirtualBox GUI tools instead of the command line. When you create your VirtualBox virtual machine, set Type to BSD and set Version to FreeBSD (32-bit).</p></div><div class="sect1" title="Running Juniper vSRX Firefly"><div class="titlepage"><div><div><h1 class="title"><a id="running_juniper_vsrx_firefly"/>Running Juniper vSRX Firefly</h1></div></div></div><p>In addition to Junos OS, you can run a virtual version of Juniper’s SRX Firewall, called <span class="emphasis"><em>vSRX Firefly</em></span>. If you register with Juniper, you can download an evaluation of Firefly from the website for free (<span class="emphasis"><em><a class="ulink" href="http://www.juniper.net/">http://www.juniper.net/</a></em></span>). You’ll want to download the Firefly VMware Appliance - FOR EVALUATION! <a id="iddle1002" class="indexterm"/><a id="iddle1253" class="indexterm"/><a id="iddle1699" class="indexterm"/><a id="iddle1700" class="indexterm"/><a id="iddle1904" class="indexterm"/><a id="iddle1929" class="indexterm"/><a id="iddle2294" class="indexterm"/><a id="iddle2352" class="indexterm"/>package. As you can see from the name, it’s designed to run on VMware, but you can tweak it to run on VirtualBox or QEMU. I’m covering VirtualBox here, so make sure the VirtualBox program is installed on your system before you begin.</p><p>After you’ve downloaded the Firefly software, notice that it’s an Open Virtual Appliance (OVA) file, named something like <span class="emphasis"><em>junos-vsrx-ver.x-domestic.ova</em></span>. An OVA file is a special package file that can be unarchived using the <code class="literal">tar</code> command. To extract the contents from the file on Linux or OS X, use the following command:</p><a id="pro_id00066"/><pre class="programlisting">$ <span class="strong"><strong>tar xvf junos-vsrx-ver.x-domestic.ova</strong></span></pre><div class="note" title="Note"><h3 class="title"><a id="ch06note06"/>Note</h3><p><span class="emphasis"><em>If you’re running Windows, you can use the 7-zip application</em></span> (<a class="ulink" href="http://www.7-zip.org/">http://www.7-zip.org/</a>) <span class="emphasis"><em>to extract the files.</em></span></p></div><p>After all the files have been extracted, you need to convert the VMware virtual machine disk file (the file with extension <span class="emphasis"><em>.vmdk</em></span>) to a virtual disk image (VDI) file that can be used by VirtualBox. To convert the file, use the <code class="literal">vboxmanage</code> utility that comes with VirtualBox.</p><a id="pro_id00067"/><pre class="programlisting">$ <span class="strong"><strong>vboxmanage clonehd -format VDI junos-vsrx-ver.x-domestic-disk1.vmdk</strong></span>
<span class="strong"><strong>junos-vsrx-ver.x-domestic-disk1.vdi</strong></span></pre><p>After converting the disk image, you can delete all the Firefly files except the new VDI image file (<span class="emphasis"><em>junos-vsrx-ver.x-domestic-disk1.vdi</em></span> in this example). This is the hard disk image file that you will import into VirtualBox.</p><div class="sect2" title="Creating a Firefly Virtual Machine with VirtualBox"><div class="titlepage"><div><div><h2 class="title"><a id="creating_a_firefly_virtual_machine_with"/>Creating a Firefly Virtual Machine with VirtualBox</h2></div></div></div><p>You need to create a new virtual machine in VirtualBox and import the Firefly hard disk image file. Launch VirtualBox and click <span class="strong"><strong>New</strong></span> to open the Create Virtual Machine dialog, shown in <a class="xref" href="ch06.html#create_virtual_machine_dialog" title="Figure 6-20. Create Virtual Machine dialog">Figure 6-20</a>.</p><div class="figure"><a id="create_virtual_machine_dialog"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00069"/><img src="httpatomoreillycomsourcenostarchimages2209007.png.jpg" alt="Create Virtual Machine dialog"/></div></div><p class="title">Figure 6-20. Create Virtual Machine dialog</p></div><p>Give the virtual machine a name (<span class="emphasis"><em>Firefly</em></span> in this example), set Type to <a class="firstterm" href="apd.html#gloss01_009"><em class="firstterm">BSD</em></a>, and set Version to <span class="strong"><strong>FreeBSD (32-bit)</strong></span>. When you’re done, click <span class="strong"><strong>Next</strong></span> to assign the memory size, as shown in <a class="xref" href="ch06.html#adjust_the_memory_size" title="Figure 6-21. Adjust the memory size.">Figure 6-21</a>.</p><div class="figure"><a id="adjust_the_memory_size"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00070"/><img src="httpatomoreillycomsourcenostarchimages2209009.png.jpg" alt="Adjust the memory size."/></div></div><p class="title">Figure 6-21. Adjust the memory size.</p></div><p>Follow the instructions from Juniper to set the proper memory size. In this example, I’ve chosen 2048 MB, because that’s what Juniper recommends for my version of Firefly. When you’re done, click <span class="strong"><strong>Next</strong></span>, and check <span class="strong"><strong>Use an existing virtual hard drive file</strong></span>, as shown in <a class="xref" href="ch06.html#choose_the_junos_vsrx_firefly_vdi_hard_d" title="Figure 6-22. Choose the Junos vSRX Firefly VDI hard disk image file.">Figure 6-22</a>.</p><p>Use the browse icon to locate and choose the VDI image file you created previously. When you’re finished, click the <span class="strong"><strong>Create</strong></span> button to create the virtual machine.</p><div class="figure"><a id="choose_the_junos_vsrx_firefly_vdi_hard_d"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00071"/><img src="httpatomoreillycomsourcenostarchimages2209011.png.jpg" alt="Choose the Junos vSRX Firefly VDI hard disk image file."/></div></div><p class="title">Figure 6-22. Choose the Junos vSRX Firefly VDI hard disk image file.</p></div></div><div class="sect2" title="Giving Your Virtual Machine More Processors"><div class="titlepage"><div><div><h2 class="title"><a id="giving_your_virtual_machine_more_process"/>Giving Your Virtual Machine More Processors</h2></div></div></div><p><a id="iddle1181" class="indexterm"/><a id="iddle1678" class="indexterm"/><a id="iddle1698" class="indexterm"/><a id="iddle1701" class="indexterm"/><a id="iddle1973" class="indexterm"/><a id="iddle2349" class="indexterm"/><a id="iddle2370" class="indexterm"/><a id="iddle2398" class="indexterm"/>After creating the virtual machine, you have to increase the number of processors to two because vSRX Firefly needs two processors to run properly. If your virtual machine is configured with only one processor, Firefly will boot and run, but you will not be able to see or configure any Ethernet interfaces.</p><p>Select your virtual machine name in VirtualBox, go to <span class="strong"><strong>Settings</strong></span> ▸ <span class="strong"><strong>System</strong></span>, and click the <span class="strong"><strong>Processor</strong></span> tab, shown in <a class="xref" href="ch06.html#processor_tab_under_system" title="Figure 6-23. The Processor tab under System">Figure 6-23</a>.</p><div class="figure"><a id="processor_tab_under_system"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00072"/><img src="httpatomoreillycomsourcenostarchimages2209013.png.jpg" alt="The Processor tab under System"/></div></div><p class="title">Figure 6-23. The Processor tab under System</p></div><p>Use the slider tool to select two processors, and click <span class="strong"><strong>OK</strong></span>. After you’ve configured your Firefly virtual machine, right-click your virtual machine in VirtualBox and select <span class="strong"><strong>Clone</strong></span> to create a copy of it to work with in GNS3. The original virtual machine will remain unused, and you’ll always have a clean, unconfigured master of your virtual machine.</p><p>Once you’re done creating the Firefly virtual machine, you’ll need to add it to GNS3 before you can use it in your projects.</p></div><div class="sect2" title="Adding vSRX Firefly to GNS3"><div class="titlepage"><div><div><h2 class="title"><a id="adding_vsrx_firefly_to_gns3"/>Adding vSRX Firefly to GNS3</h2></div></div></div><p>Launch GNS3 and select <span class="strong"><strong>Edit</strong></span> ▸ <span class="strong"><strong>Preferences</strong></span> on Windows and Linux or <span class="strong"><strong>GNS3</strong></span> ▸ <span class="strong"><strong>Preferences</strong></span> on OS X. Double-click <span class="strong"><strong>VirtualBox</strong></span> in the pane on the left, and select <span class="strong"><strong>VirtualBox VMs</strong></span> to open the VirtualBox VMs preferences window, shown in <a class="xref" href="ch06.html#virtualbox_vms_preferences_window" title="Figure 6-24. VirtualBox VMs preferences window">Figure 6-24</a>.</p><p>To add your Firefly VirtualBox virtual machine to GNS3, click <span class="strong"><strong>New</strong></span> to start the New Virtual VM wizard. Select your Firefly virtual machine from the drop-down menu and click <span class="strong"><strong>Finish</strong></span>. Next, click <span class="strong"><strong>Edit</strong></span>.</p><div class="figure"><a id="virtualbox_vms_preferences_window"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00073"/><img src="httpatomoreillycomsourcenostarchimages2209015.png.jpg" alt="VirtualBox VMs preferences window"/></div></div><p class="title">Figure 6-24. VirtualBox VMs preferences window</p></div><p><a id="iddle1703" class="indexterm"/><a id="iddle1997" class="indexterm"/><a id="iddle2096" class="indexterm"/><a id="iddle2371" class="indexterm"/>On the General settings tab, place a check next to <span class="strong"><strong>Enable remote console</strong></span> and <span class="strong"><strong>Start VM in headless mode</strong></span>. This will allow you to use the console to log on to Firefly. Finally, click the <span class="strong"><strong>Network</strong></span> tab, change the number of interfaces to 6, and set the network type to <span class="strong"><strong>Paravirtualized Network (virtio net)</strong></span>. You’re now ready to create a project using Firefly.</p></div><div class="sect2" title="Creating a Project with a Zone-Based Firewall"><div class="titlepage"><div><div><h2 class="title"><a id="creating_a_project_with_a_zone-based_fir"/>Creating a Project with a Zone-Based Firewall</h2></div></div></div><p>In this section, you’ll create a simple project using vSRX Firefly as a network firewall. Firefly is similar in functionality to Cisco’s ASA firewall, but it’s different to configure. I won’t go into a lot of detail, but this project should get you started. If you want to learn more about Juniper SRX, you can find plenty of detailed documents at Juniper’s website (<span class="emphasis"><em><a class="ulink" href="https://www.juniper.net/">https://www.juniper.net/</a></em></span>).</p><p>Let’s start by creating the GNS3 project shown in <a class="xref" href="ch06.html#vsrx_firefly_project" title="Figure 6-25. vSRX Firefly project">Figure 6-25</a>. Drag a Firefly device from the End Devices toolbar to your workspace. Next, drag two Cisco routers to your workspace and link the devices together. Link R1’s interface f0/0 to interface e1 of vSRX Firefly. Link R2’s interface f0/0 to interface e0 of vSRX Firefly.</p><div class="figure"><a id="vsrx_firefly_project"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00074"/><img src="httpatomoreillycomsourcenostarchimages2209017.png.jpg" alt="vSRX Firefly project"/></div></div><p class="title">Figure 6-25. vSRX Firefly project</p></div><p>Router R1 will be configured to use a Firefly trust zone. R1 represents a trusted host on your LAN. Router R2 will be configured to use a Firefly untrust zone. The untrust zone represents an untrusted network, like the Internet. You’ll configure Firefly so that your trusted host (R1) can ping your untrusted host (R2) through the vSRX Firefly firewall using NAT.</p><p>Begin by configuring router R1 with an IP address and default gateway.</p><a id="pro_id00068"/><pre class="programlisting">R1(config)# <span class="strong"><strong>interface f0/0</strong></span>
R1(config-if)# <span class="strong"><strong>ip address 192.168.1.100 255.255.255.0</strong></span>
R1(config-if)# <span class="strong"><strong>no shutdown</strong></span>
R1(config-if)# <span class="strong"><strong>ip route 0.0.0.0 0.0.0.0 192.168.1.1</strong></span></pre><p>Next, configure an IP address on the untrusted router R2. No gateway configuration is necessary here.</p><a id="pro_id00069"/><pre class="programlisting">R2(config)# <span class="strong"><strong>interface f0/0</strong></span>
R2(config-if)# <span class="strong"><strong>ip address 100.1.1.1 255.255.255.0</strong></span>
R2(config-if)# <span class="strong"><strong>no shutdown</strong></span></pre><p>With the router IP addresses configured, you can turn your attention to Firefly. Log on using the root account to configure the vSRX Firefly firewall. Because this is a new installation, you should not be asked for a password. After logging on, enter the following commands to create your firewall; you’ll start by creating a password and configuring the network settings:</p><a id="pro_id00070"/><pre class="programlisting">  root@%<span class="strong"><strong>cli</strong></span>
  root&gt;<span class="strong"><strong>edit</strong></span>
➊ root#<span class="strong"><strong>set system root-authentication plain-text-password</strong></span>
  New password:<span class="strong"><strong>firefly1</strong></span>
  Retype new password:<span class="strong"><strong>firefly1</strong></span>
➋ root#<span class="strong"><strong>set interface ge-0/0/0.0 family inet address 100.1.1.2/24</strong></span>
➌ root#<span class="strong"><strong>set interface ge-0/0/1.0 family inet address 192.168.1.1/24</strong></span>
➍ root#<span class="strong"><strong>set routing-options static route 0.0.0.0/0 next-hop 100.1.1.1</strong></span></pre><p><a id="iddle1551" class="indexterm"/><a id="iddle2118" class="indexterm"/><a id="iddle2145" class="indexterm"/>Like a Juniper router, you cannot save any configuration changes on an SRX device until you’ve assigned a password to the root account, so start by going to edit mode and creating a root password ➊. I’ve entered <span class="emphasis"><em>firefly1</em></span>, but you can choose any password you’d like.</p><p>Next, at ➋, you set the IP address on the WAN interface (ge-0/0/0.0), and at ➌, you set the LAN interface (ge-0/0/1.0). Finally, at ➍, set the default gateway address using the untrusted router’s IP address (100.1.1.1).</p><p>Complete the configuration by defining your security zones and security trust policies.</p><a id="pro_id00071"/><pre class="programlisting">➊ root#<span class="strong"><strong>set security zones security-zone trust interfaces ge-0/0/1.0</strong></span>
➋ root#<span class="strong"><strong>set security nat source rule-set interface-nat from zone trust</strong></span>
➌ root#<span class="strong"><strong>set security nat source rule-set interface-nat to zone untrust</strong></span>
➍ root#<span class="strong"><strong>set security nat source rule-set interface-nat rule rule1 match</strong></span>
   <span class="strong"><strong>source-address 0.0.0.0/0 destination-address 0.0.0.0/0</strong></span>
➎ root#<span class="strong"><strong>set security nat source rule-set interface-nat rule rule1 then source-nat</strong></span>
   <span class="strong"><strong>interface</strong></span>
➏ root#<span class="strong"><strong>set security policies from-zone trust to-zone untrust policy permit-all</strong></span>
   <span class="strong"><strong>match source-address any destination-address any application any</strong></span>
➐ root#<span class="strong"><strong>set security policies from-zone trust to-zone untrust policy permit-all</strong></span>
   <span class="strong"><strong>then permit</strong></span>
➑ root#<span class="strong"><strong>commit</strong></span></pre><p>Assign your LAN interface to the <code class="literal">trust</code> zone ➊. Set the interface-nat source zone to <code class="literal">trust</code> ➋ and the interface-nat destination zone to <code class="literal">untrust</code> ➌, and create a rule that matches any source and destination IP addresses (0.0.0.0/0) ➍. In a production environment, you would tighten this up a bit, but for your practice GNS3 lab, it’s fine. Now configure NAT overloading on the WAN interface ➎.</p><div class="note" title="Note"><h3 class="title"><a id="ch06note07"/>Note</h3><p><span class="emphasis"><em>vSRX Firefly’s <code class="literal">interface-nat</code> command is used to achieve the equivalent of Cisco NAT/PAT overloading.</em></span></p></div><p>To finish the configuration, define the type of traffic that’s allowed to go between the zones ➏. In this case, you’re allowing all protocols and applications from the <code class="literal">trust</code> zone to the <code class="literal">untrust</code> zone. Finally, create the security policy ➐ and commit your changes ➑, and you’re done!</p><p>Verify your configuration by entering the <code class="literal">show security nat source summary</code> command.</p><a id="pro_id00072"/><pre class="programlisting">root&gt;show security nat source summary
Total port number usage for port translation pool: 0
Maximum port number for port translation pool: 33554432
Total pools: 0

Total rules: 1
Rule name     Rule set            From          To           Action
rule1➊       interface-nat➋     trust➌        untrust➍    interface➎</pre><p><a id="iddle1676" class="indexterm"/><a id="iddle2020" class="indexterm"/>This information indicates that <code class="literal">rule1</code> ➊ allows packets via NAT ➋ from the <code class="literal">trust</code> zone ➌ to the <code class="literal">untrust</code> zone ➍, and IP data sourced from the <code class="literal">trust</code> zone will be overloaded onto the untrusted interface ➎. By default, that’s interface ge-0/0/0.0 (your WAN interface). If your summary matches the one in this book after entering the command, then you’re ready to test the connection. If your output looks different, then you’ve probably mistyped something, so you need to go back and check all your configuration settings.</p><p>Log on to router R1 and enter the <code class="literal">ping</code> command to test connectivity with router R2.</p><a id="pro_id00073"/><pre class="programlisting">R1#<span class="strong"><strong>ping 100.1.1.1</strong></span>

Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 100.1.1.1, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 4/10/24 ms</pre><p>If your ping is successful, as indicated by <code class="literal">!!!!!</code>, then you’ve done everything correctly. If it failed, then you may need to go back and check your configuration settings. You should also make sure your Cisco routers have the correct IP addresses and subnet masks and that the Ethernet interfaces are not shut down.</p></div></div><div class="sect1" title="Final Thoughts"><div class="titlepage"><div><div><h1 class="title"><a id="final_thoughts-id00015"/>Final Thoughts</h1></div></div></div><p>In this chapter, you learned about Juniper and Juniper Olive, and I showed you how to create a Juniper Olive using QEMU and VirtualBox. I also introduced you to vSRX Firefly, and I provided some insight about how to configure a basic zone-based firewall using an SRX device.</p><p>In most cases, Juniper runs a little slower using QEMU than using VirtualBox. However, QEMU allows you to add an unlimited number of Juniper routers to your projects without cloning, and GNS3 will store your Juniper configurations with your projects. As a rule, VirtualBox loads and runs devices faster than QEMU, but your configurations are saved with each virtual machine instance in VirtualBox, not in GNS3. Because of this, you have to create a unique virtual machine instance of your devices using the VirtualBox clone feature. The cloned devices are then used in your GNS3 projects.</p><p>Juniper is less popular than Cisco in the corporate world, but it’s a big player in larger environments, like campus sites and the ISP routing and switching market. If you take your networking career into one of those realms, Juniper certification could set you apart from other applicants, and GNS3 is a great way to learn Juniper routers and SRX devices! You should start with JNCIA certification, which is the entry-level Juniper certification (Juniper’s equivalent to Cisco CCNA), and it’s a prerequisite for more advanced certifications. Juniper’s training website (<span class="emphasis"><em><a class="ulink" href="http://www.juniper.net/us/en/training/">http://www.juniper.net/us/en/training/</a></em></span>) provides all the information you need to get started.</p></div></div></body></html>