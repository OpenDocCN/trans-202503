<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" epub:prefix="index: http://www.index.com/" lang="en" xml:lang="en">
<head>
<title>Chapter 6: Gathering OSINT About People</title>
<link href="NSTemplate_v1.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:5e8bb34b-260b-4fef-91f3-caabb4446e65" name="Adept.expected.resource"/>
</head>
<body epub:type="bodymatter chapter">
<section>
<header>
<h1 class="chapter">
<span class="ChapterNumber"><span epub:type="pagebreak" id="Page_71" title="71"/>6</span><br/>
<span class="ChapterTitle">Gathering OSINT About People</span></h1>
</header>
<figure class="opener">
<img alt="" src="image_fi/book_art/chapterart.png"/>
</figure>
<p class="ChapterIntro">While previous chapters focused on gathering OSINT about businesses, this chapter focuses on gathering OSINT about people by using a range of tools. You’ll learn how to target a person by hunting for information such as their likes, dislikes, social connections, and password reset questions. We’ll also continue to use our target as leverage against a business by gathering OSINT from pictures that they’ve taken while at their workplace, resumes, complaints or grievances, their bragging about work, and travel, to name just a few. </p>
<h2 id="h1-500983c06-0001"><span epub:type="pagebreak" id="Page_72" title="72"/>Using OSINT Tools for Analyzing Email Addresses</h2>
<p class="BodyFirst">Often, when you begin an attack, all you have is an email address. While that may be enough for phishing attacks, you might need to know more about your target to perform other tasks. In these cases, you can use the email address to gather more information about the target, such as usernames, photos, social media accounts, and physical locations. The following tools allow you to search for OSINT about a person by using nothing but their email addresses. </p>
<p>All of this information is passed through what I call the <em>OSINT Heartbeat</em>. The OSINT Heartbeat is the act of expanding and contracting the information you’ve collected—making it possible to focus on the target at a micro level, and to then expand outward, to the adjacent people, accounts, and associations at a macro level. The most vital aspect of the OSINT Heartbeat is discerning what information has an intelligence context and what does not. This process is important for avoiding the tunnel vision that comes from focusing too closely on a target, making you miss other important data points.</p>
<h3 id="h2-500983c06-0001">Finding Out If a User Has Been Breached with Have I Been Pwned </h3>
<p class="BodyFirst">The <code>hipb_breach</code> and <code>hibp_paste</code> modules in Recon-ng search Troy Hunt’s Have I Been Pwned (HIBP) website (<a class="LinkURL" href="https://haveibeenpwned.com/">https://haveibeenpwned.com/</a>) and associated databases to determine whether an email address entered has been involved in any data breaches. </p>
<p>I often use these modules to build a dossier on how employees of my target company use their work emails. This is a good indication of the maturity of the company’s security program. For example, some people, such as those who manage social media accounts, may need to have a Facebook or LinkedIn account associated with their work emails. However, the janitor or associate-level help desk technician probably does not. </p>
<p>To use HIBP modules in Recon-ng, simply load the module, set the <code>SOURCE</code> field to the email address or list you want to search, and then enter the <code>run</code> command: </p>
<pre><code>[recon-ng][book] &gt; <b>modules search hibp</b>
[*] Searching installed modules for 'hibp'...
  Recon
    recon/contacts-credentials/hibp_breach
    recon/contacts-credentials/hibp_paste
[recon-ng][default][hibp_breach] &gt; <b>run</b>
[*] bill@nostarch.com =&gt; Breach found! Seen in the Adapt breach that occurred on 2018-11-05.
[*] bill@nostarch.com =&gt; Breach found! Seen in the AndroidForums breach that occurred on 2011-10-30.
[*] bill@nostarch.com =&gt; Breach found! Seen in the AntiPublic breach that occurred on 2016-12-16.</code></pre>
<p>You can also manually search for records on the main HIBP website. Some of the records that come up are private, meaning you can see them <span epub:type="pagebreak" id="Page_73" title="73"/>only if you can confirm you own the email via an automated email process, or confirm that you own the entire domain (or are an authorized system administrator of it). To check for every email within an entire domain, you must be able to demonstrate ownership, typically through a DNS TXT record. The hack of the dating website Ashley Madison is an example of this.</p>
<h3 id="h2-500983c06-0002">Enumerating Social Media Accounts with Sherlock</h3>
<p class="BodyFirst"><em>Sherlock</em> (<a class="LinkURL" href="https://github.com/sherlock-project/sherlock/">https://github.com/sherlock-project/sherlock/</a>) is a Python 3 tool written and maintained by the Sherlock Project. It scours various social media sites in search of usernames. The list of sites that Sherlock checks is shorter than other tools, but still useful. </p>
<p>To install and use Sherlock, follow these steps:</p>
<pre><code><b>git clone https://github.com/sherlock-project/sherlock</b>
<b>cd sherlock</b>
<b>pip3 install -r requirements.txt</b>
<b>python3 sherlock.py </b><var class="bold">OPTIONS USERNAME</var></code></pre>
<p>Sherlock will provide results similar to WhatsMyName and Recon-ng. Use whichever tool you prefer, but always use multiple tools to increase the quality or fidelity of the data you collect.</p>
<h3 id="h2-500983c06-0003">Enumerating Website Accounts with WhatsMyName</h3>
<p class="BodyFirst"><em>WhatsMyName</em> (<a class="LinkURL" href="https://github.com/WebBreacher/WhatsMyName/">https://github.com/WebBreacher/WhatsMyName/</a>) is a tool written by Micah Hoffman that enumerates websites where a particular username exists. This is an effective way to check a user’s possible behavior and web activity. You can also enact WhatsMyName on Recon-ng as the <code>profiler</code> module. In addition, Chris Poulter at OSINT Combine collaborated with Hoffman to create a WhatsMyName web application (<a class="LinkURL" href="https://whatsmyname.app/">https://whatsmyname.app/</a>).<em> </em></p>
<p>At the time of this writing, WhatsMyName checks over 250 sites. To restrict the number of sites checked or to add to the list, simply edit the<em> web_accounts_list.json</em> file with the proper JSON syntax, as in the following example:</p>
<pre><code>    {
         "name" : "YouTube",
         "check_uri" : "https://www.youtube.com/user/<var>account</var>/videos",
         "account_existence_code" : "200",
         "account_existence_string" : "name\" content=",
         "account_missing_string" : " This channel does not exist",
         "account_missing_code" : "404",
         "known_accounts" : ["test"],
         "category" : "video",
         "valid" : true
      }</code></pre>
<p><span epub:type="pagebreak" id="Page_74" title="74"/>If you’d like to check a site that isn’t included in the JSON file, you can simply research how the site processes HTTP requests, including the parameters it uses and the HTTP response codes to expect. You then would simply copy the entry into the file. </p>
<p>Run WhatsMyName by using the following command: </p>
<pre><code><b>root@kali:/opt/WhatsMyName# python3 web_accounts_list_checker.py -u nostarchpress</b>
 -  190 sites found in file.
 -  Looking up https://500px.com/nostarchpress
 -  Looking up https://9gag.com/u/nostarchpress
<var>--snip--</var>
 -  Looking up https://api.github.com/users/nostarchpress
[+] Found user at https://api.github.com/users/nostarchpress
 -  Looking up https://gitlab.com/nostarchpress
[+] Found user at https://gitlab.com/nostarchpress
 -  Looking up https://www.goodreads.com/user/show/nostarchpress
 -  Looking up https://www.gpsies.com/mapUser.do?username=nostarchpress</code></pre>
<p>As you execute the script, a <code>[+]</code> should appear beside each site at which WhatsMyName detects an account.</p>
<h2 id="h1-500983c06-0002">Analyzing Passwords with Pwdlogy</h2>
<p class="BodyFirst"><em>Pwdlogy</em> (pronounced <em>Password-ology</em>) is a tool written by tch1001 that allows hackers to build a word list for a given user based on terms that they frequently use and topics that are meaningful to them. You’ll do some manual analysis of your own and then populate a list. The tool then alters this list by adding characters to what you’ve input and alternating the characters to make a much longer word list. Attackers can then use that word list for password-guessing attacks and related activities. </p>
<p>While on the surface this may not seem particularly useful for a social engineer, with a little ingenuity, it can be. For example, imagine you are phishing a particular user and have approval to use a password-reset pretext. In other words, you can poll the user for information, possibly by handing them a survey or while making small talk. Using this information, you can populate a list in Pwdlogy and use it for testing. If you have fewer than 10 users to phish, you could discover how they create new passwords by using this method. If you have hundreds or thousands, this might not work as well. </p>
<p>To install and use Pwdlogy, enter the following commands:</p>
<pre><code><b>git clone https://github.com/tch1001/pwdlogy</b>
<b>cd pwdlogy</b>
<b>python3 pwdlogy</b></code></pre>
<p><span epub:type="pagebreak" id="Page_75" title="75"/>These commands will clone the code from GitHub to your system, and then move you into the directory and execute it with Python. To create your list for Pwdlogy, use OSINT to collect the following information about each user:</p>
<ul>
<li>Spouse, sibling, parents, and children names</li>
<li>The names of pets</li>
<li>Favorite words and numbers</li>
<li>Birthdays</li>
</ul>
<p>As a defender, you could then restrict users from using any variant of items from this list as passwords and require them to choose something different. This would allow you to reduce the probability of someone guessing user passwords, but it would do nothing for password reuse or password stuffing as a result of data breaches outside your organization.</p>
<p>Alternatively, you could use the list in a conversation or phish to grab a target’s attention. For instance, ask how the victim’s spouse or child is doing, by name. A penetration tester may use this information for <em>password spraying</em> (an attack in which you try the same passwords with several usernames, as opposed to traditional <em>password cracking</em>, which involves trying several possible passwords for a single user) or other technical means to gain access to an account.</p>
<h2 id="h1-500983c06-0003">Analyzing a Target’s Images</h2>
<p class="BodyFirst">Some of the searches I showed throughout this chapter uncovered images, and analyzing those images further can give us important information about a target. I search for four things when looking at pictures for OSINT analysis. </p>
<p>First, I look at the <em>foreground</em>, or what the picture is actually meant to tell us, whether it be about a person, a scene, or anything else. Next, I look at the <em>background</em>. For instance, is there tacky hotel wallpaper that could tie this picture to a specific location or chain? I then look at what is <em>missing</em> in the picture. What should be here? I think of this as one of those comparing-two-pictures challenges. Has something been photoshopped out? Has something been moved out of frame? </p>
<p>Finally, I look at the <em>Exchangeable Image File (EXIF)</em> data. The EXIF format is a standard for still images that defines the images, sounds, and other tags that digital cameras, smartphones, and other systems produce. Since all cameras and smartphones have the capability to produce such data, we can collect varying levels of OSINT about pictures and the people who took them. </p>
<p>In this section, I’ll cover a few ways to analyze EXIF data.</p>
<h3 id="h2-500983c06-0004"><span epub:type="pagebreak" id="Page_76" title="76"/>Manually Analyzing EXIF Data</h3>
<p class="BodyFirst">Let’s analyze the EXIF data for the picture shown in <a href="#figure6-1" id="figureanchor6-1">Figure 6-1</a>.</p>
<figure>
<img alt="&lt;&lt;Bank of the River Darent in Eynsford, England. Shows a portion of the river with trees and tall grasses in the background.&gt;&gt;" class="" src="image_fi/500983c06/f06001.png"/>
<figcaption><p><a id="figure6-1">Figure 6-1</a>: Image sent to me by a student for analysis</p></figcaption>
</figure>
<p>To analyze the EXIF data, right-click the image and select <b>Get Info </b>on a Mac. On Windows and Linux, right-click the image and select <b>Properties</b>. This should open a window that has EXIF data viewable (<a href="#figure6-2" id="figureanchor6-2">Figure 6-2</a>).</p>
<p>Here, we see the image type and when I downloaded it. We get the dimensions, make, and model of the camera that took it—in this case, an iPhone X. At the bottom, we see the latitude and longitude of the location where the image was taken, which is information that smartphones typically include.</p>
<h3 id="h2-500983c06-0005">Analyzing Images by Using ExifTool</h3>
<p class="BodyFirst"><em>ExifTool</em> is a tool that can automatically analyze EXIF data and give you a lot more information than a manual analysis can. Some of this information could be particularly helpful if you’re profiling a company onsite, learning about company culture, or targeting a mobile device for exploitation. Another useful application is if you are competing in one of Trace Labs’ Search Party CTFs (<a class="LinkURL" href="https://www.tracelabs.org/getinvolved/ctf/">https://www.tracelabs.org/getinvolved/ctf/</a>).</p>
<span epub:type="pagebreak" id="Page_77" title="77"/><figure>
<img alt="&lt;&lt;EXIF data for 6-1.jpg. Outlined in red are Image kind, size, file location, creation date, last modified date, device make and model, and latitude and longitude.&gt;&gt;" class="" src="image_fi/500983c06/f06002.png"/>
<figcaption><p><a id="figure6-2">Figure 6-2</a>: Getting EXIF info on a MacBook</p></figcaption>
</figure>
<p>To install ExifTool in Kali, run the following:</p>
<pre><code><b>apt-get install exiftool</b></code></pre>
<p>To analyze a file, run this: </p>
<pre><code><b>exiftool</b><b> </b><var class="bold">filename</var></code></pre>
<p>Alternatively, you can use Jeffrey’s Image Metadata Viewer (<a class="LinkURL" href="http://exif.regex.info/exif.cgi">http://exif.regex.info/exif.cgi</a>), an online version of ExifTool. This is helpful if you’re trying to avoid downloading a file or are explicitly working with only online images. You can provide the tool a file or a link, and it will post the results onscreen.</p>
<p><span epub:type="pagebreak" id="Page_78" title="78"/>Let’s start the analysis by looking at the MACB times<em>.</em> <em>MACB</em> is a forensic term for the times when a file was <em>modified</em>, <em>accessed, changed</em>, and <em>“born”</em> (created). In this case, it shows when I downloaded this file from my email: </p>
<pre><code>root@kali:~/Documents# <b>exiftool IMG_4438.JPG</b> 
ExifTool Version Number         : 11.65
File Modification Date/Time     : 2019:09:14 00:41:45-04:00</code></pre>
<p>Next, after the file type, you see the camera’s make and model, as well as the device’s orientation while taking the picture and that flash wasn’t used: </p>
<pre><code>File Type                       : JPEG
JFIF Version                    : 1.01
Exif Byte Order                 : Big-endian (Motorola, MM)
Make                            : Apple
Camera Model Name               : iPhone X
<var>--snip--</var></code></pre>
<p>The software field is also incredibly important, because in this case, it tells us the version of Apple iOS that the phone that took the picture is running:</p>
<pre><code>Software                        : 12.3.1
Create Date                     : 2019:08:03 11:39:02
<var>--snip--</var>
Scene Type                      : Directly photographed
Custom Rendered                 : Portrait HDR</code></pre>
<p>Next, you see the lens make and model. This should be similar to the camera make and model. In this case, you’re able to see that the back dual camera of the iPhone X was used and that it was in the Northern and Eastern hemispheres (basically, Europe or parts of Asia): </p>
<pre><code>Lens Info                       : 4-6mm f/1.8-2.4
Lens Make                       : Apple
Lens Model                      : iPhone X back dual camera 6mm f/2.4
GPS Latitude Ref                : North
GPS Longitude Ref               : East
GPS Altitude Ref                : Above Sea Level
GPS Speed Ref                   : km/h
GPS Speed                       : 0.2333080322</code></pre>
<p>The <em>image direction</em> is the direction (between 0.000 and 359.99º) the photographer was pointing in:</p>
<pre><code>GPS Img Direction Ref           : True North
GPS Img Direction               : 221.1058655
<var>--snip--</var>
Digital Creation Time           : 11:39:02
Digital Creation Date           : 2019:08:03</code></pre>
<p><span epub:type="pagebreak" id="Page_79" title="79"/>In the final pieces of analysis, you’re able to see how long the phone has been off the charger, the elevation, and the latitude and longitude: </p>
<pre><code>Image Size                      : 4032x3024
Megapixels                      : 12.2
Scale Factor To 35 mm Equivalent: 8.7
Shutter Speed                   : 1/163
Create Date                     : 2019:08:03 11:39:02.291
Date/Time Original              : 2019:08:03 11:39:02.291
GPS Altitude                    : 16.6 m Above Sea Level
GPS Latitude                    : 51 deg 22' 4.87" N
GPS Longitude                   : 0 deg 12' 37.68" E
Date/Time Created               : 2019:08:03 11:39:02
Digital Creation Date/Time      : 2019:08:03 11:39:02</code></pre>
<p>This allows you to confirm the location where the picture was taken by using a mapping application. For example, if this was a picture of an unlocked Windows 7 computer on a desk, you could use the coordinates to find out the address of the facility where the picture was taken, as well as a possible company whose office the picture was taken in. </p>
<p>Let’s try this now. Take the latitude and longitude, and then drop it in Google Maps, generating the image shown in <a href="#figure6-3" id="figureanchor6-3">Figure 6-3</a>. </p>
<figure>
<img alt="&lt;&lt;Google Maps screenshot displays street view image of Riverside, Eynsford, England, at latitude and longitude scraped from EXIF data. Shows crowd of people picnicking on the grass.&gt;&gt;" class="" src="image_fi/500983c06/f06003.png"/>
<figcaption><p><a id="figure6-3">Figure 6-3</a>: Google Maps entry for the latitude and longitude taken from EXIF data</p></figcaption>
</figure>
<p>This scene confirms that the picture was taken near the Plough Inn along the River Darent in Eynsford, England.</p>
<h2 id="h1-500983c06-0004"><span epub:type="pagebreak" id="Page_80" title="80"/>Analyzing Social Media Without Tools</h2>
<p class="BodyFirst">In this section, I’ll address the most useful aspects of common social media platforms for OSINT gathering. In general, you should focus on habits, culture, and connections. <em>Habits </em>include how often users post, the terms they use, and similar behavior. <em>Culture</em> includes the norms that the person or organization follows. <em>Connections</em>, or other users in a target’s network, are a tricky beast. I don’t advocate connecting with personal accounts as part of engagements, because these accounts aren’t owned by the company paying you. </p>
<h3 id="h2-500983c06-0006">LinkedIn</h3>
<p class="BodyFirst">On LinkedIn, check whether the target is a <em>LinkedIn Open Networker (LION),</em> or someone who will accept all connection requests. Also, enumerate their colleagues. Look at their information, which will likely include some accomplishments. You may also find email addresses or links to their other social media websites.</p>
<h3 id="h2-500983c06-0007">Instagram</h3>
<p class="BodyFirst">On Instagram, you can see whom a target interacts with the most. You can also confirm what someone looks like apart from their headshots and build a dossier that will help you behave like the people they spend time with. People don’t like to admit it, but they usually associate with a type.</p>
<h3 id="h2-500983c06-0008">Facebook</h3>
<p class="BodyFirst">Facebook might let you learn more about a person than you ever wanted to, or conversely, it may be like trying to get blood from a turnip. Some people are extremely privacy conscientious, and Facebook offers the most granular privacy controls, with the typical settings Only Me, Specific Friends, Friends Only, Friends of Friends, and Public.</p>
<p>If a person shares publicly on Facebook, you can learn about relationships, travel, and political and religious affiliations. Even if someone has their privacy set to Friends or stricter, you can still see everything they post or comment on publicly (like the local news), unless they have you blocked. </p>
<h3 id="h2-500983c06-0009">Twitter</h3>
<p class="BodyFirst">In terms of privacy controls, Twitter has only three options: protected/locked, blocked, and default. <em>Protected/locked</em> allows the user to approve who can see their tweets. This is different than blocked; if a user <em>blocks</em> another user but lacks the protected/locked setting, the blocked user can still see the other user’s tweets from another account. If protected, then they will have to submit a request for approval. The <em>default</em> setting shows everything to everyone, unless they’re blocked or muted. Twitter is especially helpful for collecting information about public figures, technologists, early adopters of emerging technologies, political pundits, and sports fans.</p>
<h2 id="h1-500983c06-0005"><span epub:type="pagebreak" id="Page_81" title="81"/>Case Study: The Dinner That Gave All the Gold Away</h2>
<p class="BodyFirst">Some time ago, I was having dinner at a local sit-down restaurant. I was seated near two women who, based on their conversation, sounded like old friends catching up. The first woman—let’s call her Wanda—was asking the most questions, while the other one—let’s call her Tammy—shared information without discretion. </p>
<p>Wanda asked Tammy where she was working, and Tammy replied with the company name, as well as how the name came about (it was a variation of the owner’s name). She said she’d worked there for five years, and then explained what she did for the company, revealing that it was a bakery. She went on to vent about her frustrations and talk about her triumphs. </p>
<p>Wanda asked Tammy if she was married yet. Tammy talked about her ex-boyfriend, Steven, and their shared custody of Leif. She also mentioned Steven’s mom, who lived in Tulsa, then told Wanda that Steven’s mom was kind of afraid of Leif. I wondered: what kind of grandmother was afraid of their grandchild? Wait, I thought. Maybe Leif wasn’t a human child. Sure enough, Wanda asked if Tammy wanted real kids and which breed Leif is. Tammy replied with a comment about her body image and some health issues, and then informed her friend that Leif was a year-old mutt. </p>
<p>Finally, Tammy talked about her new boyfriend, Dick, and his career as a comedian. Wanda asked how Dick felt about sharing custody of Leif, and Tammy replied with a story about Dick and Steven doing a couple of things together with Leif and going to concerts together. </p>
<p>This might seem innocuous enough, but using this conversation, here is what I found out, and how:</p>
<p class="ListHead"><b>The bakery owner’s name</b></p>
<ol class="none">
<li>I searched for the bakery’s name, then looked at comments with replies and ratings on Facebook.</li>
</ol>
<p class="ListHead"><b>The name of the bakery owner’s daughter and employee</b></p>
<ol class="none">
<li>I looked through bakery photos, then found the owner’s public relationship statuses on Facebook.</li>
</ol>
<p class="ListHead"><b>The name of the owner’s son-in-law</b></p>
<ol class="none">
<li>Again, through the owner’s public relationship statuses.</li>
</ol>
<p class="ListHead"><b>Tammy’s name</b></p>
<ol class="none">
<li>I got creative and started reading Facebook reviews of the bakery. Knowing from the conversation that Tammy started working at the bakery five years ago, I looked for reviews in that time frame. I found a five-star review with no text or testimonial, and recognized the poster by her profile picture. </li>
</ol>
<p class="ListHead"><b>The identity of Dick, the boyfriend</b></p>
<ol class="none">
<li>I checked Tammy’s photos and relationship status on Facebook, and then confirmed the finding by using the relationship status and profession listed on his Facebook page. </li>
</ol>
<p class="ListHead"><b><span epub:type="pagebreak" id="Page_82" title="82"/>The identity of Steven, the ex-boyfriend</b></p>
<ol class="none">
<li>Tammy had three Facebook friends named Steven, but only one of them had a mother living in Tulsa. I confirmed this finding by looking through pictures and cross-referencing Leif (a very ugly dog, by the way). </li>
</ol>
<p class="ListHead"><b>Tammy and Dick’s home address, and pictures of the home</b></p>
<ol class="none">
<li>Along with clues on their Facebook pages, I checked Melissa Property Data Explorer property records and Google Street view.</li>
</ol>
<p>In the wrong hands, this information could be fodder for identity theft, a home invasion, or worse. How could this have been mitigated or prevented?</p>
<ul>
<li>I could have not listened. But once you get into OSINT and social engineering, it becomes kind of hard to turn off.</li>
<li>Tammy and Wanda could have been less descriptive or spoken more quietly. Tammy, Dick, Steven, and Wanda could have used better sharing settings and privacy controls on their social media. All parties could have been vaguer about what they said or posted or used disinformation to throw social engineers off their trail.</li>
</ul>
<h2 id="h1-500983c06-0006">Conclusion</h2>
<p class="BodyFirst">The purpose of collecting people OSINT is to better understand the threats that employees introduce to their employer and to potentially build rapport with them in social engineering engagements. There are several sources of people OSINT, including pictures, friends, social media, and routine things like email addresses, usernames, and IP addresses. To use these tools ethically, treat them as a means to learn more about the company, not the individual person. Remember: stay away from interacting with personal accounts.</p>
<p/>
</section>
</body>
</html>