<html><head></head><body>
<div id="sbo-rt-content" class="calibre1"><section aria-labelledby="ch2" epub:type="chapter" role="doc-chapter">
<hgroup>
<h2 class="title" id="ch2">
<span class="cn"><span aria-label=" Page 11. " epub:type="pagebreak" id="pg_11" role="doc-pagebreak" class="calibre2"/><span class="sans_dogma_ot_bold_b_">2</span></span>
<span class="ct1"><span class="sans_dogma_ot_bold_b_">VARIABLES AND VALUES</span></span>
</h2>
</hgroup>
<figure class="opener"><img alt="" class="opener1" height="407" src="../images/chapter.jpg" width="408"/>
</figure>
<p class="chapterintro">Now that we’re ready to start coding, we’ll explore variables, values, and the Batch <span class="sans_thesansmonocd_w5regular_1">set</span> command, which assigns values to variables. Although these topics may seem trivial if you’ve coded in other languages, Batch has some unique quirks that are worth noting.</p>
<p class="tx">You’ll learn how to display the value of a variable in the console to confirm that it has been set correctly. Additionally, I’ll introduce the <i class="calibre6">command separator</i>, which allows you to enter multiple commands on a single line. I’ll also show you how to create remarks and set variables that are saved on your computer and remain available even after the bat file is closed. Finally, you’ll learn how to access documentation for any Batch command at the command prompt, a useful skill for anyone working with bat files.</p>
<section aria-labelledby="sec1" epub:type="division">
<h3 class="h" id="sec1"><span id="h1-17"/><span aria-label=" Page 12. " epub:type="pagebreak" id="pg_12" role="doc-pagebreak"/><span class="sans_futura_std_bold_b_">Setting and Resolving a Variable</span></h3>
<p class="tni">A <i class="calibre6">variable</i> is a named field defining a place in memory that holds a value for later use. Many if not most languages allow, and usually require, variables to be defined as a particular data type, often some sort of text or number, before they can be assigned a value. Batch will have none of this; variables come into existence the first time they are “set” to a value, and that value can contain letters, numbers, and other characters. It’s then up to the coder to treat them as certain data types, or not. In <span class="xref"><a href="chapter5.xhtml" class="calibre3">Chapters 5</a></span> and <span class="xref"><a href="chapter6.xhtml" class="calibre3">6</a></span> I’ll return to ways to handle data types, but this chapter focuses on the seemingly simple task of assigning a value to a variable.</p>
<p class="tx">To consider one example of a variable, a coder might have a field that contains the state of their mood; whether it be for narcissistic or obsessive-compulsive reasons is of little importance. The variable is defined as or named <span class="sans_thesansmonocd_w5regular_">myMood</span>, and two possible values out of many are <span class="sans_thesansmonocd_w5regular_">happy</span> and <span class="sans_thesansmonocd_w5regular_">sad</span>. To set the variable to <span class="sans_thesansmonocd_w5regular_">happy</span>, you would use, obviously enough, the <span class="sans_thesansmonocd_w5regular_">set</span> command:</p>
<pre class="pre"><code class="calibre11">set myMood=happy</code></pre>
<p class="tni">After this executes, the <span class="sans_thesansmonocd_w5regular_">myMood</span> variable contains the value <span class="sans_thesansmonocd_w5regular_">happy</span>.</p>
<p class="tx">If the topic is particularly bewildering, the following command wipes out the prior value and replaces it with a different one:</p>
<pre class="pre"><code class="calibre11">set myMood=nonplussed</code></pre>
<p class="tx">But how do you know for sure the value of this or any other variable? In Batch, the act of revealing the value of a variable is referred to as <i class="calibre6">resolving a variable</i>, and it’s usually done by surrounding the variable with percent signs. That is, <span class="sans_thesansmonocd_w5regular_">%myMood%</span> will resolve to <span class="sans_thesansmonocd_w5regular_">nonplussed</span> after the prior <span class="sans_thesansmonocd_w5regular_">set</span> command executes. Now, to actually see the results of resolving a variable, we’ll need a bit of a digression—a very important digression.</p>
</section>
<section aria-labelledby="sec2" epub:type="division">
<h3 class="h" id="sec2"><span id="h1-18"/><span class="sans_futura_std_bold_b_">Displaying the Value of a Variable</span></h3>
<p class="tni">In this section, you’ll learn how to quickly display the resolved value of a variable on your computer screen, but this technique will be useful for far more than just that. We’ll return to it in future chapters to demonstrate many other features of Batch, such as using it as a testing technique, which is instrumental for any Batch coder.</p>
<section aria-labelledby="sec3" epub:type="division">
<h4 class="h1" id="sec3"><span id="h2-1"/><span class="sans_futura_std_heavy_oblique_bi_">Writing to the Console</span></h4>
<p class="tni">To display the contents of a variable on the screen, we need two additional commands: <span class="sans_thesansmonocd_w5regular_">echo</span> and <span class="sans_thesansmonocd_w5regular_">pause</span>. To demonstrate, let’s create a small bat file. Open a new folder on your computer, perhaps <i class="calibre6">C:\Batch\</i>, and in it, create a bat file called <i class="calibre6">Mood.bat</i> that contains the three lines shown in <a href="#Lis2-1" class="calibre3">Listing 2-1</a>.</p>
<span id="Lis2-1"/>
<pre class="pre"><code class="calibre11"><span aria-label=" Page 13. " epub:type="pagebreak" id="pg_13" role="doc-pagebreak"/>set myMood=happy
echo My mood is %myMood%.
pause
</code></pre>
<p class="listingcaption"><span class="futura_std_book_oblique_i_">Listing 2-1: The bat file,</span> <span class="sans_futura_std_book_">Mood.bat</span><span class="futura_std_book_oblique_i_">, displays a resolved variable.</span></p>
<p class="tx">If you double-click or open <i class="calibre6">Mood.bat</i>, the bat file should execute, and a black window with white text should appear. This window is the DOS window, or <i class="calibre6">console</i>, which is how I’ll refer to it throughout this book.</p>
<p class="tx">We’ve already discussed the <span class="sans_thesansmonocd_w5regular_">set</span> command in the first line of <a href="#Lis2-1" class="calibre3">Listing 2-1</a>. In this context, the <span class="sans_thesansmonocd_w5regular_">echo</span> command writes out the remainder of the statement, excluding the space succeeding the actual text <span class="sans_thesansmonocd_w5regular_">echo</span>, to the console. The text <span class="sans_thesansmonocd_w5regular_">My mood is</span> and a trailing space is displayed, followed by the contents or the value of <span class="sans_thesansmonocd_w5regular_">myMood</span>—that is, the text <span class="sans_thesansmonocd_w5regular_">happy</span>—and the trailing period. The <span class="sans_thesansmonocd_w5regular_">pause</span> command keeps the console open. Without it, the window would open and close before you could read it.</p>
<p class="tx"><a href="#Lis2-2" class="calibre3">Listing 2-2</a> shows everything written to the console when this bat file executes, which is more than you may have expected.</p>
<span id="Lis2-2"/>
<pre class="pre"><code class="calibre11">C:\Batch&gt;set myMood=happy

C:\Batch&gt;echo My mood is happy.
My mood is happy.

C:\Batch&gt;pause
Press any key to continue . . .
</code></pre>
<p class="listingcaption"><span class="futura_std_book_oblique_i_">Listing 2-2: The console display of the</span> <span class="sans_futura_std_book_">Mood.bat</span> <span class="futura_std_book_oblique_i_">bat file</span></p>
<p class="tx">Each command is preceded with the current directory, <i class="calibre6">C:\Batch\</i>, followed by a greater-than sign (<span class="sans_thesansmonocd_w5regular_">&gt;</span>) as a delimiter. (You’ll learn more about the current directory in <span class="xref"><a href="chapter8.xhtml" class="calibre3">Chapter 8</a></span>. For now, just consider it to be the path of the bat file being executed.)</p>
<p class="tx">The first line shows the execution of the <span class="sans_thesansmonocd_w5regular_">set</span> command, and the second shows the execution of the <span class="sans_thesansmonocd_w5regular_">echo</span> command. The third line is the result of executing that <span class="sans_thesansmonocd_w5regular_">echo</span>—that is, the output to the console described in <a href="#Lis2-2" class="calibre3">Listing 2-2</a>. You can tell that it’s not a command because of the lack of the preceding text <i class="calibre6">C:\Batch&gt;</i>. More important, <span class="sans_thesansmonocd_w5regular_">%myMood%</span> resolves to the text <span class="sans_thesansmonocd_w5regular_">happy</span>. The <span class="sans_thesansmonocd_w5regular_">pause</span> command also creates output, the text <span class="sans_thesansmonocd_w5regular_">Press any key to continue ...</span> , and as the message indicates, the execution is on hold until any key is depressed, at which point the bat file will end, and the console will close. Also, notice that the <span class="sans_thesansmonocd_w5regular_">set</span> command doesn’t produce any output since it’s just setting the value of a variable—there’s nothing to output.</p>
</section>
<section aria-labelledby="sec4" epub:type="division">
<h4 class="h1" id="sec4"><span id="h2-2"/><span class="sans_futura_std_heavy_oblique_bi_">Cleaning Up the Console</span></h4>
<p class="tni">One problem with what’s written to the console is that it’s a mess with commands interspersed with the desired output from the <span class="sans_thesansmonocd_w5regular_">echo</span> and <span class="sans_thesansmonocd_w5regular_">pause</span> commands. In <span class="xref"><a href="chapter12.xhtml" class="calibre3">Chapter 12</a></span>, you’ll learn more about the various outputs and how to manage them; here we’ll just look at a quick means of cleaning this up. <span aria-label=" Page 14. " epub:type="pagebreak" id="pg_14" role="doc-pagebreak"/>An <span class="sans_thesansmonocd_w5regular_">echo</span> command followed by the argument <span class="sans_thesansmonocd_w5regular_">off</span> is executed at the top of the <i class="calibre6">Mood.bat</i> bat file from <a href="#Lis2-1" class="calibre3">Listing 2-1</a>:</p>
<pre class="pre"><code class="calibre11">@echo off
set myMood=happy
echo My mood is %myMood%.
pause
</code></pre>
<p class="tni">This <span class="sans_thesansmonocd_w5regular_">echo off</span> command suppresses not the actual output of the subsequent commands but rather the lines showing that each of those commands is being executed—that is, the line prefixed with the current directory. Also, prefixing the <span class="sans_thesansmonocd_w5regular_">echo</span> command with the at sign (<span class="sans_thesansmonocd_w5regular_">@</span>) suppresses its own execution from being written to the console.</p>
<p class="tx">Compared to <a href="#Lis2-2" class="calibre3">Listing 2-2</a>, the console display is now much cleaner when the modified bat file is executed:</p>
<pre class="pre"><code class="calibre11">My mood is happy.
Press any key to continue . . .
</code></pre>
<p class="tx">Now we can easily demonstrate how to initialize the <span class="sans_thesansmonocd_w5regular_">myMood</span> variable to the <span class="sans_thesansmonocd_w5regular_">gloomy</span> value and then reset it to the <span class="sans_thesansmonocd_w5regular_">cheerful</span> value:</p>
<pre class="pre"><code class="calibre11">@echo off
set myMood=gloomy
echo My mood is %myMood%.
set myMood=cheerful
echo Now my mood is %myMood%.
pause
</code></pre>
<p class="tx">The result shows the same variable resolved to two different values at two different times:</p>
<pre class="pre"><code class="calibre11">My mood is gloomy.
Now my mood is cheerful.
Press any key to continue . . .
</code></pre>
<p class="tx">As our bat files become more complex, the <span class="sans_thesansmonocd_w5regular_">echo</span> command can send the output to someplace other than the console (see <span class="xref"><a href="chapter12.xhtml" class="calibre3">Chapter 12</a></span> for more details). Prepending the command with <span class="sans_thesansmonocd_w5regular_">&gt; con</span> explicitly redirects the data to the console:</p>
<pre class="pre"><code class="calibre11">&gt; con echo This will always get to the "con" or console</code></pre>
<p class="tx">This technique will be very useful in coming chapters to demonstrate what’s going on in a code snippet. For the sake of brevity, I won’t include the initial <span class="sans_thesansmonocd_w5regular_">echo off</span> and trailing <span class="sans_thesansmonocd_w5regular_">pause</span> commands in later examples, but I encourage you to add them to clean up and hold open the console.</p>
</section>
</section>
<section aria-labelledby="sec5" epub:type="division">
<h3 class="h" id="sec5"><span id="h1-19"/><span aria-label=" Page 15. " epub:type="pagebreak" id="pg_15" role="doc-pagebreak"/><span class="sans_futura_std_bold_b_">The Idiosyncrasies of the set Command</span></h3>
<p class="tni">Setting variables is usually a straightforward topic for most coding languages, but Batch isn’t like most coding languages. All Batch coders need to understand the following idiosyncrasies of the <span class="sans_thesansmonocd_w5regular_">set</span> command to avoid some level of future pain.</p>
<section aria-labelledby="sec6" epub:type="division">
<h4 class="h1" id="sec6"><span id="h2-3"/><span class="sans_futura_std_heavy_oblique_bi_">Case Sensitivity</span></h4>
<p class="tni">Closely inspect the following two commands. They look a little different but are functionally equivalent:</p>
<pre class="pre"><code class="calibre11">SET myMood=whimsical
set MYMOOD=whimsical
</code></pre>
<p class="tx">Batch commands and variables are case-insensitive. Here the <span class="sans_thesansmonocd_w5regular_">set</span> command is uppercase in one command and lowercase in the other, but the interpreter treats them both the same. You also could’ve used <span class="sans_thesansmonocd_w5regular_">Set</span> with no change in functionality. For good measure, <span class="sans_thesansmonocd_w5regular_">sET</span> and <span class="sans_thesansmonocd_w5regular_">SeT</span> also work in the same fashion, but you’d have to be a real contrarian to code in such a manner. Likewise, you can use the <span class="sans_thesansmonocd_w5regular_">myMood</span>, <span class="sans_thesansmonocd_w5regular_">MYMOOD</span>, and <span class="sans_thesansmonocd_w5regular_">mymood</span> variables interchangeably. The value, however, is stored just as it’s typed, so it’s case-sensitive. If the variable is set to <span class="sans_thesansmonocd_w5regular_">WHIMSICAL</span>, it will be resolved as <span class="sans_thesansmonocd_w5regular_">WHIMSICAL</span>; likewise, if it’s set to <span class="sans_thesansmonocd_w5regular_">Whimsical</span>, it will be resolved as <span class="sans_thesansmonocd_w5regular_">Whimsical</span>.</p>
<p class="tx">It’s all a matter of style and personal preference. I find that many bat files have far too much content capitalized. Capitalization is meant to make something stand out, but nothing stands out when everything is flashing neon. Most Batch coders capitalize all the letters in command names, but in this book I use only lowercase characters for all Batch commands. Also, I greatly prefer camel case variables.</p>
<blockquote class="calibre8">
<p class="warning"><span class="sans_dogma_ot_bold_b_1">NOTE</span></p>
</blockquote>
<p class="warning-txt">Camel case <i class="calibre6">text is easily readable even though it contains multiple words not separated by spaces or other characters. The first letter of camel case text can be either uppercase (head up) or lowercase (head down). But to qualify as camel case, the first letter of all subsequent words must be capitalized with the rest of the word being lowercase. An example of the</i> <span class="copyright_accent">head up</span> <i class="calibre6">variant (also called</i> Pascal <i class="calibre6">or</i> upper camel case<i class="calibre6">) is MyMood. The corresponding</i> <span class="copyright_accent">head down</span> <i class="calibre6">variant (also called</i> dromedary <i class="calibre6">or</i> lower camel case<i class="calibre6">) would be myMood. Imagine a camel drinking water with his head down.</i></p>
</section>
<section aria-labelledby="sec7" epub:type="division">
<h4 class="h1" id="sec7"><span id="h2-4"/><span class="sans_futura_std_heavy_oblique_bi_">Valid Variable Characters</span></h4>
<p class="tni">Most programming languages have strict rules concerning the list of permissible characters in variable names. Typically, numbers and the 26 letters of the alphabet, uppercase and lowercase, are allowed, with just a few special characters to boot. But Batch is unique in that nearly every character on the keyboard is a valid variable name character, although you should avoid using numbers as the first character in a variable name. (While you can set variables named with a leading digit, resolving them is problematic, and I’ll explain why in <span class="xref"><a href="chapter3.xhtml" class="calibre3">Chapter 3</a></span>.)</p>
<p class="tx"><span aria-label=" Page 16. " epub:type="pagebreak" id="pg_16" role="doc-pagebreak"/>A few characters are illegal because they have specific uses in Batch; for example, the tilde (<span class="sans_thesansmonocd_w5regular_">~</span>), ampersand (<span class="sans_thesansmonocd_w5regular_">&amp;</span>), percent sign (<span class="sans_thesansmonocd_w5regular_">%</span>), and the less-than (<span class="sans_thesansmonocd_w5regular_">&lt;</span>) and greater-than (<span class="sans_thesansmonocd_w5regular_">&gt;</span>) signs are reserved characters, but several others would surprise any coder not already familiar with Batch. The three <span class="sans_thesansmonocd_w5regular_">set</span> commands in <a href="#Lis2-3" class="calibre3">Listing 2-3</a> successfully set these three variables with odd-looking single-character names to their respective descriptions.</p>
<span id="Lis2-3"/>
<pre class="pre"><code class="calibre11">set ;=semicolon
set @=at
set #=hashtag

&gt; con echo %;% %@% %#%
</code></pre>
<p class="listingcaption"><span class="futura_std_book_oblique_i_">Listing 2-3: Setting variables with odd-looking single-character names</span></p>
<p class="tx">The <span class="sans_thesansmonocd_w5regular_">echo</span> command in <a href="#Lis2-3" class="calibre3">Listing 2-3</a> writes the text <span class="sans_thesansmonocd_w5regular_">semicolon at hashtag</span> to the console.</p>
<p class="tx">Even the following monstrosity stores the text <span class="sans_thesansmonocd_w5regular_">This actually works</span> in the variable with a dollar sign, dot, and mismatched brackets:</p>
<pre class="pre"><code class="calibre11">set var$with.odd[chars}=This actually works</code></pre>
<p class="tni">This variable name demonstrates what’s possible, but it’s hard to read and not recommended.</p>
<p class="tx">Judicious use of such characters in variable names, however, can be a handy tool. For example, a group of related variables might all have a leading or trailing underscore as a visual cue to that relationship; <span class="sans_thesansmonocd_w5regular_">number</span> can be abbreviated as <span class="sans_thesansmonocd_w5regular_">#</span>, which is even more succinct than <span class="sans_thesansmonocd_w5regular_">nbr</span> and clearer than <span class="sans_thesansmonocd_w5regular_">no</span>. Much later in this book I’ll use this interesting feature to build arrays and hash tables with meaningful names containing brackets.</p>
</section>
<section aria-labelledby="sec8" epub:type="division">
<h4 class="h1" id="sec8"><span id="h2-5"/><span class="sans_futura_std_heavy_oblique_bi_">Spaces Around the Assignment Operator</span></h4>
<p class="tni">The following classic rookie mistake bites most new Batch coders familiar with other languages. Inspect the <span class="sans_thesansmonocd_w5regular_">set</span> command shown in <a href="#Lis2-4" class="calibre3">Listing 2-4</a> carefully.</p>
<span id="Lis2-4"/>
<pre class="pre"><code class="calibre11">set X = Hello
&gt; con echo The value of X is "%X%".
</code></pre>
<p class="listingcaption"><span class="futura_std_book_oblique_i_">Listing 2-4: Setting a variable with spaces around the equal sign</span></p>
<p class="tx">If you expect the result of the <span class="sans_thesansmonocd_w5regular_">echo</span> command to be</p>
<pre class="pre"><code class="calibre11">The value of X is "Hello".</code></pre>
<p class="tni">that would be an understandable mistake, but a mistake nonetheless. The result is actually this:</p>
<pre class="pre"><code class="calibre11">The value of X is "".</code></pre>
<p class="tni"><span aria-label=" Page 17. " epub:type="pagebreak" id="pg_17" role="doc-pagebreak"/>The empty quotes mean that <span class="sans_thesansmonocd_w5regular_">X</span> isn’t set or is set to null, meaning nothing at all, not even a space.</p>
<blockquote class="calibre8">
<p class="warning"><span class="sans_dogma_ot_bold_b_1">NOTE</span></p>
</blockquote>
<p class="warning-txt"><i class="calibre6">In <a href="chapter1.xhtml" class="calibre3">Chapter 1</a>, I mentioned that inside the command prompt, the syntax and output can differ in comparison to a bat file, and this is a prime example. The same code entered at the command prompt displays the attempted resolution of the unset variable very differently:</i></p>
<pre class="pre"><code class="calibre11"><span class="sans_thesansmonocd_w5regular_">The value of X is "%X%".</span>
</code></pre>
<blockquote class="calibre8">
<p class="notecontinued"><i class="calibre6">I won’t be noting every discrepancy in the pages ahead, so if you see any future anomalies working at the command prompt, try putting the code in a bat file.</i></p>
</blockquote>
<p class="tx">Now, the <span class="sans_thesansmonocd_w5regular_">set</span> command in <a href="#Lis2-4" class="calibre3">Listing 2-4</a> isn’t all that complex, and it clearly is setting <span class="sans_thesansmonocd_w5regular_">X</span> to the text <span class="sans_thesansmonocd_w5regular_">Hello</span>, correct? Furthermore, it looks a lot like assignment commands in other more modern languages that would’ve performed the assignment as desired.</p>
<p class="tx">This is our first <i class="calibre6">batveat</i> (Batch caveat; see the <span class="xref">Introduction</span> for details on batveats). The key to this issue is the space preceding the equal sign. The Batch interpreter is as literal as difficult teenagers, too smart and unforgiving for their own good. The variable name starts with the first nonspace character after the <span class="sans_thesansmonocd_w5regular_">set</span> command and ends with the character just before the assignment operator or equal sign—no matter what that character is. Therefore, the variable being set here is two characters in length, an <span class="sans_thesansmonocd_w5regular_">X</span> followed by a space:</p>
<pre class="pre"><code class="calibre11">set X = Hello</code></pre>
<p class="tni">The <span class="sans_thesansmonocd_w5regular_">%X%</span> resolved to nothing, but <span class="sans_thesansmonocd_w5regular_">%X %</span> does have a value, and that value is <span class="sans_thesansmonocd_w5regular_">Hello</span>, correct? Not quite; this is our second batveat. The value of the variable is the string of characters after the equal sign extending to the end of the statement. Therefore, the assigned value is the space after the equal sign followed by the five characters in the word <span class="sans_thesansmonocd_w5regular_">Hello</span>.</p>
<p class="tx">Let’s modify the <span class="sans_thesansmonocd_w5regular_">echo</span> command from <a href="#Lis2-4" class="calibre3">Listing 2-4</a> like so:</p>
<pre class="pre"><code class="calibre11">set X = Hello
&gt; con echo The value of X-space is "%X %".
</code></pre>
<p class="tx">Resolving the variable with the trailing space now reveals its value, which contains a leading space:</p>
<pre class="pre"><code class="calibre11">The value of X-space is " Hello".</code></pre>
<p class="tx">This works, but typically a variable name with a trailing space is an accident waiting to happen. We even can embed spaces in the middle of a variable name, but there’s a big difference between being able to do something and it being a good idea. This in no way should be construed as an invitation to create cryptic code; it’s more of a warning about spaces around the equal sign in a <span class="sans_thesansmonocd_w5regular_">set</span> command.</p>
<p class="tx"><span aria-label=" Page 18. " epub:type="pagebreak" id="pg_18" role="doc-pagebreak"/>Taking one last pass of <a href="#Lis2-4" class="calibre3">Listing 2-4</a>, let’s remove the spaces before and after the equal sign and go back to the original <span class="sans_thesansmonocd_w5regular_">echo</span> command:</p>
<pre class="pre"><code class="calibre11">set X=Hello
&gt; con echo The value of X is "%X%".
</code></pre>
<p class="tx">Finally, we get the desired result written to the console:</p>
<pre class="pre"><code class="calibre11">The value of X is "Hello".</code></pre>
<p class="tx">An even easier mistake to make is to add an unintentional space or two to the end of a line trailing the value. Because it won’t be obvious just looking at the text in the editor, it’s quite easy to miss. (In Notepad++, go to <b class="calibre10">View</b> <span class="sans_thesansmonocd_w5regular_">▶</span> <b class="calibre10">Show Symbol</b> <span class="sans_thesansmonocd_w5regular_">▶</span> <b class="calibre10">Show Space and Tab</b> to represent spaces as faint dots. Other good editors will have a similar feature.)</p>
<p class="tx">There are valid reasons to prepend or append a variable’s value with spaces, as you’ll learn later in this book, but be careful not to do it by accident. However, I’m hard-pressed to come up with an example of a variable’s name legitimately being appended with one or more spaces. Ensure that there’s no space between the variable name and the equal sign when using a basic <span class="sans_thesansmonocd_w5regular_">set</span> command.</p>
</section>
</section>
<section aria-labelledby="sec9" epub:type="division">
<h3 class="h" id="sec9"><span id="h1-20"/><span class="sans_futura_std_bold_b_">The Command Separator</span></h3>
<p class="tni">The ampersand is a special character that functions as a command separator; it’s not treated like simple text. For instance, you can string the three lines of code from <a href="#Lis2-3" class="calibre3">Listing 2-3</a> together into a single line, with each command separated by the <span class="sans_thesansmonocd_w5regular_">&amp;</span> character:</p>
<pre class="pre"><code class="calibre11">set ;=semicolon&amp; set @=at&amp; set #=hashtag</code></pre>
<p class="tni">This is functionally equivalent to the three commands on three distinct lines.</p>
<p class="tx">On occasion this technique is useful for consolidating simple and similar commands, but using it excessively can make the code difficult to read. However, I’ve found two very handy uses for the command separator.</p>
<section aria-labelledby="sec10" epub:type="division">
<h4 class="h1" id="sec10"><span id="h2-6"/><span class="sans_futura_std_heavy_oblique_bi_">Appending Remarks to a Command</span></h4>
<p class="tni">One use of the command separator is to add text at the end of a line so that it’s treated as a comment. The <span class="sans_thesansmonocd_w5regular_">rem</span> command creates a <i class="calibre6">remark</i> out of the text that follows it. Typically, we place a <span class="sans_thesansmonocd_w5regular_">rem</span> command on the line (or lines) preceding some interesting code as a comment, but we also can attach it to a specific command with the command separator. For instance, the following two lines perform the same logic:</p>
<pre class="pre"><code class="calibre11">set myMood=reflective
set myMood=reflective&amp; rem This is a thoughtful and contemplative mood.
</code></pre>
<p class="tni"><span aria-label=" Page 19. " epub:type="pagebreak" id="pg_19" role="doc-pagebreak"/>The second line, however, provides a little more information to anyone reading the code.</p>
</section>
<section aria-labelledby="sec11" epub:type="division">
<h4 class="h1" id="sec11"><span id="h2-7"/><span class="sans_futura_std_heavy_oblique_bi_">Terminating a Command</span></h4>
<p class="tni">The second use of the command separator is to terminate a command definitively so the coder can clearly delineate the existence or nonexistence of any trailing spaces. Is the following command setting the variable to null, a space, or multiple spaces?</p>
<pre class="pre"><code class="calibre11">set myMood=</code></pre>
<p class="tni">As written, it is impossible to tell (unless you make your editor display spaces as visible characters).</p>
<p class="tx">If you hadn’t read the earlier discussion, the following command might appear to be setting the variable to an ampersand:</p>
<pre class="pre"><code class="calibre11">set myMood=&amp;</code></pre>
<p class="tni">But this command unequivocally tells the reader that the variable is being set to null because the statement is terminated by the ampersand immediately after the equality operator.</p>
<p class="tx">Likewise, there are instances when the coder might want a variable to be a certain length (you’ll see a great application of this when formatting reports in <span class="xref"><a href="chapter22.xhtml" class="calibre3">Chapter 22</a></span>). The following sets the variable to a 10-byte left- justified value containing the text <span class="sans_thesansmonocd_w5regular_">pensive</span> followed by three spaces:</p>
<pre class="pre"><code class="calibre11">set myMood=pensive    &amp;</code></pre>
<p class="tni">Without the ampersand it would be quite difficult to determine how many spaces come after the text, if any. Technically, the ampersand isn’t separating two commands, but it definitely is terminating the one command.</p>
</section>
</section>
<section aria-labelledby="sec12" epub:type="division">
<h3 class="h" id="sec12"><span id="h1-21"/><span class="sans_futura_std_bold_b_">Displaying Variable Information</span></h3>
<p class="tni">The <span class="sans_thesansmonocd_w5regular_">set</span> command has one more interesting use. When used without an equal sign, it writes out the value of the variable, so if the <span class="sans_thesansmonocd_w5regular_">myMood</span> variable is already defined, you can enter this command in a bat file:</p>
<pre class="pre"><code class="calibre11">set myMood</code></pre>
<p class="tx">The resulting output written to the console might be as follows:</p>
<pre class="pre"><code class="calibre11">myMood=hopeful</code></pre>
<p class="tx">If only the first part of the variable name is typed after the <span class="sans_thesansmonocd_w5regular_">set</span> command, all variables that start with that text will be displayed. Thus, the <span aria-label=" Page 20. " epub:type="pagebreak" id="pg_20" role="doc-pagebreak"/>following command might output more than the value of the <span class="sans_thesansmonocd_w5regular_">myMood</span> variable:</p>
<pre class="pre"><code class="calibre11">set myM</code></pre>
<p class="tx">Maybe, just maybe, it might output this:</p>
<pre class="pre"><code class="calibre11">Mymar=A Genus of Fairyflies
myMood=hopeful
</code></pre>
<p class="tx">It’s unlikely that such a variable would’ve been set, but if it does exist and if these were the only two variables set on the machine starting with <span class="sans_thesansmonocd_w5regular_">mym</span>, that would’ve been the output. Note that the command finds all variables, regardless of case. Also notice the example of a variable value containing embedded spaces.</p>
<p class="tx">After seeing this technique work with complete variable names and then partial variable names, we can extend it to no variable name at all:</p>
<pre class="pre"><code class="calibre11">set</code></pre>
<p class="tx">This command without arguments generates a list of all active variables, those loaded when the bat file started, along with any additions and modifications to the list from the bat file itself.</p>
</section>
<section aria-labelledby="sec13" epub:type="division">
<h3 class="h" id="sec13"><span id="h1-22"/><span class="sans_futura_std_bold_b_">Persistently Setting a Variable</span></h3>
<p class="tni">The <span class="sans_thesansmonocd_w5regular_">set</span> command is ephemeral in nature. It defines variables in a particular Batch stream until the variable is reassigned or the script terminates, at which point all variables set via the <span class="sans_thesansmonocd_w5regular_">set</span> command vanish into the ether. But at times we’ll want a variable to be accessible to other processes or other bat files on the computer—and for long after the original bat file has terminated, even after the computer is shut down and rebooted. What we want is an extreme <span class="sans_thesansmonocd_w5regular_">set</span> command, or a <i class="calibre6">set Xtreme</i> command. Aptly named, we have the <span class="sans_thesansmonocd_w5regular_">setx</span> command just for this purpose. (Truthfully, I have no idea where the name of the command originated, but it’s a story I tell at parties. In the <span class="xref">Introduction</span> you were warned about inviting my ilk to parties.)</p>
<p class="tx">It would be logical to assume that the syntax of the <span class="sans_thesansmonocd_w5regular_">set</span> and <span class="sans_thesansmonocd_w5regular_">setx</span> commands would be the same. What else would you expect other than a variable, an equal sign, and a value? It’s a bit puzzling why, but this isn’t the case. The <span class="sans_thesansmonocd_w5regular_">setx</span> command doesn’t call for an equal sign. Instead, the variable name and value are delimited (or separated) by a space or spaces like so:</p>
<pre class="pre"><code class="calibre11">setx myMood puzzled</code></pre>
<p class="tx">While discussing the <span class="sans_thesansmonocd_w5regular_">set</span> command, it became clear that variable names and values can indeed contain spaces. That obviously presents a predicament when a space is the delimiter in the command that sets the variable. But encasing the variable name and/or value in double quotes makes quick <span aria-label=" Page 21. " epub:type="pagebreak" id="pg_21" role="doc-pagebreak"/>work of the issue. This command creates a variable with a two-word name and assigns it a two-word value:</p>
<pre class="pre"><code class="calibre11">setx "my mood"  "cautiously optimistic"</code></pre>
<p class="tx">To test this, first execute the previous statement in one bat file, and then execute the following command in another bat file or even at the command prompt:</p>
<pre class="pre"><code class="calibre11">set my m</code></pre>
<p class="tni">To see the effect, you must start the second bat file or open the command prompt <i class="calibre6">after</i> the <span class="sans_thesansmonocd_w5regular_">setx</span> command completes, because the interpreter loads a session with the computer’s existing variables when that session begins.</p>
<p class="tx">All variables starting with <span class="sans_thesansmonocd_w5regular_">my m</span> (case-insensitive and inclusive of the embedded space) will be displayed, including the variable <span class="sans_thesansmonocd_w5regular_">my mood</span>. Unless this variable is reassigned by some other process, such as a future <span class="sans_thesansmonocd_w5regular_">setx</span> command, it’ll exist with this value for as long as the computer is operable.</p>
<p class="tx">The <span class="sans_thesansmonocd_w5regular_">setx</span> command is a great tool to aid in the development of compiled code. When a particular program being developed eventually runs in production, it’ll obviously be running on a different machine with its own environment variables. While animating that program, some IDEs have a good mechanism of simulating those environment variables and the setting of file connectors; others sadly do not. I’ve seen a few inelegant solutions to get around this shortcoming, but a great solution is to actually set all the needed values on your development machine before animating.</p>
<p class="tx">For each program developed in certain languages, I’ll create a bat file with a series of <span class="sans_thesansmonocd_w5regular_">setx</span> commands, one for each variable that needs to be set persistently. After executing the bat file, I can animate the program, and it’ll find all the environment variables that I expect it to find when it’ll later execute in its production environment. If I want to animate a different program, I can first run the bat file associated with it, quickly and easily, and if I feel a need to restore some variables to their prior state when I’m done, I can create a bat file for that as well. (Some IDEs store all variables from the environment just once when it opens. If your IDE behaves this way, ensure that you run the bat file before opening the IDE.)</p>
</section>
<section aria-labelledby="sec14" epub:type="division">
<h3 class="h" id="sec14"><span id="h1-23"/><span class="sans_futura_std_bold_b_">Command Line Help</span></h3>
<p class="tni">The last Batch command that I’ll introduce in this chapter is the command that documents the ones I’ve already discussed along with all of the many others to come. The <span class="sans_thesansmonocd_w5regular_">help</span> command accepts another command as its argument and returns a wealth of information about the command, starting with a brief description of its function and its general syntax.</p>
<p class="tx">I’ll demonstrate with the <span class="sans_thesansmonocd_w5regular_">set</span> command simply because it’s been so central to this chapter. To invoke the <span class="sans_thesansmonocd_w5regular_">help</span> command, enter it into a command prompt (type <b class="calibre10">CMD</b> into the Windows Start menu and press <small class="calibre5">ENTER</small>). <span aria-label=" Page 22. " epub:type="pagebreak" id="pg_22" role="doc-pagebreak"/>Then, to receive more details on the <span class="sans_thesansmonocd_w5regular_">set</span> command in particular, enter the following:</p>
<pre class="pre"><code class="calibre11"><b class="calibre10">help set</b></code></pre>
<p class="tx">The interpreter produces far too much information about the <span class="sans_thesansmonocd_w5regular_">set</span> command to display here in its entirety, but here are the first few lines:</p>
<pre class="pre"><code class="calibre11">Displays, sets, or removes cmd.exe environment variables.

SET [variable=[string]]

  variable  Specifies the environment-variable name.
  string    Specifies a series of characters to assign to the variable.
</code></pre>
<p class="tx">The command’s brief description is followed immediately by its general syntax, which obviously starts with the command name itself. All text inside of square brackets (also called hard brackets) is optional. The square brackets surrounding the text, <span class="sans_thesansmonocd_w5regular_">[variable=[string]]</span>, indicate that the command can work with or without the text inside. Remember that the <span class="sans_thesansmonocd_w5regular_">set</span> command used without an argument returns a list of all active variables. The nested square brackets take it a step further, indicating that <span class="sans_thesansmonocd_w5regular_">string</span> is also optional—that is, <span class="sans_thesansmonocd_w5regular_">variable</span> can be set to nothing at all.</p>
<p class="tx">The help for some commands gives examples of the command’s use along with additional notes and a list of available options. An <i class="calibre6">option</i> is a setting or tweak assigned to a command to turn on or off some additional functionality. They’re also called <i class="calibre6">switches</i>; in fact, the <span class="sans_thesansmonocd_w5regular_">help</span> command frustratingly uses the two terms interchangeably. For consistency, I’ll use only the more popular term <i class="calibre6">option</i>, but if someone mentions a Batch command switch, they’re referring to an option.</p>
<p class="tx">Options are usually defined with a forward slash followed by a single letter, but you’ll eventually encounter some that are more complex. Scroll down in the command prompt displaying the help for the <span class="sans_thesansmonocd_w5regular_">set</span> command to see two interesting and useful options. The <span class="sans_thesansmonocd_w5regular_">/A</span> option allows for the command to perform arithmetic (<span class="xref"><a href="chapter6.xhtml" class="calibre3">Chapter 6</a></span>). The <span class="sans_thesansmonocd_w5regular_">/P</span> or prompt option is used to set a variable with user-entered data (<span class="xref"><a href="chapter15.xhtml" class="calibre3">Chapter 15</a></span>).</p>
<p class="tx">In <span class="xref"><a href="chapter1.xhtml" class="calibre3">Chapter 1</a></span>, what was possibly your first bat file contained a command to copy some files. I won’t cover the details of the <span class="sans_thesansmonocd_w5regular_">xcopy</span> command until <span class="xref"><a href="chapter7.xhtml" class="calibre3">Chapter 7</a></span>, but in the previous chapter it used three options (<span class="sans_thesansmonocd_w5regular_">/F</span>, <span class="sans_thesansmonocd_w5regular_">/S</span>, and <span class="sans_thesansmonocd_w5regular_">/Y</span>). What those do exactly isn’t important—yet. What’s important is that they turn some functionality on or off and that they’re documented with the <span class="sans_thesansmonocd_w5regular_">help</span> command.</p>
<p class="tx">Some commands have many options, others just a few, and others still none. As I introduce commands, I’ll detail options that I find important and useful, but you’ll want to use the <span class="sans_thesansmonocd_w5regular_">help</span> command to find a more complete list. Some undocumented options, however, aren’t found with the <span class="sans_thesansmonocd_w5regular_">help</span> command, and to uncover those gems, go to <i class="calibre6"><a href="https://ss64.com/nt/" class="calibre3">https://<wbr/>ss64<wbr/>.com<wbr/>/nt<wbr/>/</a></i> or some other resource.</p>
<p class="tx"><span aria-label=" Page 23. " epub:type="pagebreak" id="pg_23" role="doc-pagebreak"/>I recommend using <span class="sans_thesansmonocd_w5regular_">help</span> when you first work with a particular command or as a reminder of available options. Try using it for any of the other commands mentioned in this chapter, even the <span class="sans_thesansmonocd_w5regular_">help</span> command itself. Yes, entering this at the command prompt</p>
<pre class="pre"><code class="calibre11"><b class="calibre10">help help</b></code></pre>
<p class="tni">displays documentation about the <span class="sans_thesansmonocd_w5regular_">help</span> command.</p>
<blockquote class="calibre8">
<p class="warning"><span class="sans_dogma_ot_bold_b_1">NOTE</span></p>
</blockquote>
<p class="warning-txt"><i class="calibre6">Following any Batch command with</i> <span class="sans_thesansmonocd_w7bold_italic_bi_">/?</span> <i class="calibre6">retrieves the same information. That is, entering</i> <span class="sans_thesansmonocd_w7bold_italic_bi_">set /?</span> <i class="calibre6">works the same way as</i> <span class="sans_thesansmonocd_w7bold_italic_bi_">help set</span><i class="calibre6">.</i></p>
</section>
<section aria-labelledby="sec15" epub:type="division">
<h3 class="h" id="sec15"><span id="h1-24"/><span class="sans_futura_std_bold_b_">Summary</span></h3>
<p class="tni">Batch coding can be complex, and even something as seemingly simple as setting variables can have some nuances. In this chapter, I detailed the <span class="sans_thesansmonocd_w5regular_">set</span> command and its quirks as well as compared it to the <span class="sans_thesansmonocd_w5regular_">setx</span> command, which sets variables persistently. You also learned how to resolve variables and display them on the console. You can now add remarks to your bat files, use the command separator for multiple purposes, and, most important, quickly access documentation for any command.</p>
<p class="tx">In the next chapter, we’ll delve further into variables, specifically the scope of variables. We’ll examine how to define where and when variables possess certain values and how to enable the powerful feature of delayed expansion. As a preview, I’ll let you in on a secret: one variable’s value can be the name of a second variable with its own value.</p>
</section>
</section>
</div></body></html>