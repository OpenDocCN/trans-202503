<html><head></head><body>
<div id="sbo-rt-content"><section>
<header>
<h1 class="chapter">
<span class="ChapterNumber"><span epub:type="pagebreak" id="Page_243" title="243"/><a class="XrefDestination" id="12"/><span class="XrefDestination" id="xref-502727c12-001"/>12</span><br/>
<span class="ChapterTitle"><a class="XrefDestination" id="Digraphsubstitution"/><span class="XrefDestination" id="xref-502727c12-002"/>Digraph substitution</span></h1>
</header>
<figure class="graphic">
<img alt="" class="" height="475" src="image_fi/502727c12/g12001.png" width="844"/></figure>
<p class="BodyFirst"><span epub:type="pagebreak" id="Page_244" title="244"/>In his 1563 book <em>De Furtivis Literarum Notis</em>, Italian polymath and cryptologist Giambattista della Porta (1535–1615) proposed an interesting encryption method. Instead of replacing single letters, his system substituted letter pairs (also known as digraphs). In the centuries that followed, different variants of this digraph substitution were developed—including the so-called Playfair cipher. In this chapter, we will cover both methods: Playfair and Porta’s original system.</p>
<h2 id="h1-502727c12-0001"><a class="XrefDestination" id="Howgeneraldigraphsubstitutionworks"/><span class="XrefDestination" id="xref-502727c12-003"/>How general digraph substitution works</h2>
<p class="BodyFirst">The method Giambattista della Porta suggested is based on a digraph substitution table with 400 unique entries. It provides a different symbol for each possible letter pair, as shown in <a href="#figure12-1" id="figureanchor12-1">Figure 12-1</a>.<sup class="endnote"><a href="b06.xhtml#c12-endnote-1" id="c12-noteref-1">1</a></sup> (The alphabet he used had twenty letters.)</p>
<figure>
<img alt="" class="" height="760" src="image_fi/502727c12/f12001.png" width="619"/>
<figcaption><p><a id="figure12-1">Figure 12-1</a>: Giambattista della Porta suggested this substitution table, which provides a different symbol for every digraph.</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_245" title="245"/>For example, if we wanted to encrypt the word <code class="bold">STREET</code> using this table, we would first need to think of it as a sequence of three digraphs: <code class="bold">ST</code>, <code class="bold">RE</code>, and <code class="bold">ET</code>. If we look up each pair in the table (using the first letter along the top of the table and the second letter along the right-hand side), we get this:</p>
<figure class="graphic">
<img alt="" class="" height="118" src="image_fi/502727c12/g12002.png" width="299"/></figure>
<p>However, Porta’s table was probably never used in practice, as dealing with 400 different symbols is quite cumbersome. Other cipher designers preferred replacing digraphs with three-digit substitutes (we will provide an example of this in <span class="xref" itemid="xref_target_Chapter 16"><a href="c16.xhtml">Chapter 16</a></span>), but in the end, it turned out that the most convenient way to replace a digraph is with another digraph. Here’s an excerpt, from the top left-hand corner of a table with 26 × 26, or 676, entries, that substitutes a new digraph for every existing one:</p>
<p class="BodyCustom"><code class="bold">  A  B  C  D  E  F  G  H  I  . . .</code></p>
<p class="BodyCustom"><code class="bold">A</code><code> KF SW JL OO QA CP DA BN CX . . .</code></p>
<p class="BodyCustom"><code class="bold">B</code><code> LH WS WM CO XE YP WW NV CH . . .</code></p>
<p class="BodyCustom"><code class="bold">C</code><code> JX KV AS PI CS PX NU SR LS . . .</code></p>
<p class="BodyCustom"><code class="bold">D</code><code> TR AL FG AD WU QM GH PG JC . . .</code></p>
<p class="BodyCustom"><code class="bold">E</code><code> ND SG RE AT NA TU RX SS OD . . .</code></p>
<p class="BodyCustom"><code>. . .</code></p>
<p>Using this table, the word <code class="bold">BEAD</code> encrypts to <code>SGTR</code> (again, assuming that the first letter of each digraph is taken from the top row). The alphabets at the top and on the left can also be written in a keyword-dependent way. The following table, for instance, was created with the keywords <code class="bold">AMERICA</code> and <code class="bold">BALL</code>:</p>
<p class="BodyCustom"><code class="bold">  A  M  E  R  I  C  B  D  F  . . .</code></p>
<p class="BodyCustom"><code class="bold">B</code><code> KF SW JL OO QA CP DA BN CX . . .</code></p>
<p class="BodyCustom"><code class="bold">A</code><code> LH WS WM CO XE YP WW NV CH . . .</code></p>
<p class="BodyCustom"><code class="bold">L</code><code> JX KV AS PI CS PX NU SR LS . . .</code></p>
<p class="BodyCustom"><code class="bold">C</code><code> TR AL FG AD WU QM GH PG JC . . .</code></p>
<p class="BodyCustom"><code class="bold">D</code><code> ND SG RE AT NA TU RX SS OD . . .</code></p>
<p class="BodyCustom"><code>. . .</code></p>
<p>When using such a table, one usually keeps the digraphs in the matrix constant while changing the two keywords frequently.</p>
<h2 id="h1-502727c12-0002"><a class="XrefDestination" id="HowthePlayfaircipherworks"/><span class="XrefDestination" id="xref-502727c12-004"/>How the Playfair cipher works</h2>
<p class="BodyFirst">Even a table with 26 × 26 (or 676) entries is quite tedious to build and use. For this reason, digraph substitution with an exhaustive table, though reasonably secure, never played much of a role in the history of cryptography. Instead of using a large table, practitioners tended to prefer a <span epub:type="pagebreak" id="Page_246" title="246"/>set of rules more desirable for substituting digraphs. While they could have constructed such a rules set in numerous ways, only one method (with many variants) was frequently used in practice: the Playfair cipher. It was invented by Charles Wheatstone (1802–1875) in 1854 and later recommended to the British military by Lord Lyon Playfair (1818–1898), hence the name.<sup class="endnote"><a href="b06.xhtml#c12-endnote-2" id="c12-noteref-2">2</a></sup></p>
<p>British psychologist and parapsychologist Robert Thouless (1894–1984), who appears several times in our book, created two famous cryptograms of this type. Remember from <span class="xref" itemid="xref_target_Chapter 8"><a href="c08.xhtml">Chapter 8</a></span> that, in 1948, Thouless started an interesting experiment: in order to check whether it was possible to send a message from the realm of the dead to the living, he published an encrypted text, keeping the plaintext and the keyword secret. His plan was to channel the keyword from the beyond after his death. Before his death in 1984, Thouless published three trials of his parapsychological experiment: two with Playfair and one with a polyalphabetic system. His two Playfair attempts are covered in this chapter.</p>
<p>In his first trial, Thouless encrypted a Shakespearean quote using the Playfair system. The plaintext was this:</p>
<p class="BodyCustom"><code>BALM OF HURT MINDS GREAT NATURE'S SECOND COURSE CHIEF NOURISHER IN LIFE'S FEAST</code></p>
<p>Written in digraphs, this reads:</p>
<p class="BodyCustom"><code>BA LM OF HU RT MI ND SG RE AT NA TU RE SS EC ON DC OU RS EC HI EF NO UR IS HE RI NL IF ES FE AS T</code></p>
<p>Typically, the Playfair cipher requires that no pair consist of two equal letters, because the standard set of rules has no method for encrypting an identical pair, as we will explain shortly. Therefore, as is often done in these cases, Thouless added an <code>X</code> between the two <code>S</code>s:</p>
<p class="BodyCustom"><code>BA LM OF HU RT MI ND SG RE AT NA TU RE SX SE CO ND CO UR SE CH IE FN OU RI SH ER IN LI FE SF EA ST</code></p>
<p>If the number of letters in this plaintext were odd, he would have had to add another <code>X</code> in the last position so that each letter belonged to a pair, but this is not necessary here. Thouless chose, as his keyword, <code class="bold">SURPRISE</code>. Based on this word, he used the following transposed alphabet. It starts with the keyword, omits repeating letters, and considers I and J to be equivalent in order to produce an alphabet of twenty-five letters: <code>SURPIEABCDFGHKLMNOQTVWXYZ</code>. Next, Thouless wrote this alphabet out in a 5 × 5 grid (also known as a Playfair matrix):</p>
<p class="BodyCustom"><code>S U R P I</code></p>
<p class="BodyCustom"><code>E A B C D</code></p>
<p class="BodyCustom"><code>F G H K L</code></p>
<p class="BodyCustom"><code>M N O Q T</code></p>
<p class="BodyCustom"><code>V W X Y Z</code></p>
<p><span epub:type="pagebreak" id="Page_247" title="247"/>From here, Thouless replaced the plaintext digraphs (<code class="bold">BA</code>, <code class="bold">LM</code>, <code class="bold">OF</code>, <code class="bold">HU</code> . . .) according to the following most common three Playfair rules, which are visualized in <a href="#figure12-2" id="figureanchor12-2">Figure 12-2</a>:</p>
<p class="RunInPara"><span class="RunInHead">Rule 1</span>  If the two letters are neither in the same column nor in the same row (which is the most frequent case), find a rectangle formed by the two letters when they are at opposite corners and replace the two letters with the other two corner letters (replacing the upper plaintext letter with the other upper letter in the rectangle and the lower plaintext letter with the other lower letter). In this example, <code class="bold">LM</code> becomes <code>FT</code>.</p>
<p class="RunInPara"><span class="RunInHead">Rule 2</span>  If the two letters are in the same row, replace each one with its neighbor to the right. Here, <code class="bold">BA</code> becomes <code>CB</code>.</p>
<p class="RunInPara"><span class="RunInHead">Rule 3</span>  If the two letters are in the same column, replace each one with its lower neighbor. In our example, <code class="bold">AN</code> becomes <code>GW</code>.</p>
<figure>
<img alt="" class="" height="152" src="image_fi/502727c12/f12002.png" width="694"/>
<figcaption><p><a id="figure12-2">Figure 12-2</a>: The Playfair cipher replaces letter pairs based on three rules.</p></figcaption>
</figure>
<p>When we apply the Playfair rules to the 5 × 5 grid shown above, the Shakespeare quote encrypts to the following:</p>
<p class="BodyCustom"><code>CB FT MH GR IO TS TA UF SB DN WG NI SB RV EF BQ TA BQ RP EF BK SD GM NR PS RF BS UT TD MF EM AB IM</code></p>
<p>This is the cryptogram Robert Thouless published in 1948. He wrote it in five-letter groups, except for the last six letters:</p>
<p class="BodyCustom"><code>CBFTM HGRIO TSTAU FSBDN WGNIS BRVEF BQTAB</code></p>
<p class="BodyCustom"><code>QRPEF BKSDG MNRPS RFBSU TTDMF EMA BIM</code></p>
<p>To learn more about the follow-up to this experiment, see <span class="xref" itemid="xref_target_Chapter 8"><a href="c08.xhtml">Chapter 8</a></span>.</p>
<p>Of course, the Playfair method we described can be modified in many ways. For instance, we can use a 4 × 6 or a 5 × 6 Playfair matrix, instead of the 5 × 5 version. The 5 × 6 matrix provides room for a few more characters, such as a space, a period, or meaningless letters (nulls). The replacement rules can be changed in many ways, as well. For instance, one can add a rule for substituting double letters or for shifting letters to the left instead of to the right.</p>
<p>In World War II, the German army implemented a Playfair version that used two 5 × 5 matrices instead of one, constructing each grid with a different keyword. This system was known as the Doppelkasten (“Double Box”) method.<sup class="endnote"><a href="b06.xhtml#c12-endnote-3" id="c12-noteref-3">3</a></sup> Examples can be found in back issues of the academic journal <em>Cryptologia</em>.</p>
<h2 id="h1-502727c12-0003"><span epub:type="pagebreak" id="Page_248" title="248"/><a class="XrefDestination" id="Howtodetectageneraldigraphsubstitution"/><span class="XrefDestination" id="xref-502727c12-005"/>How to detect a general digraph substitution</h2>
<p class="BodyFirst">Klaus created the following ciphertext with a general digraph substitution, not a Playfair cipher. He published it as a challenge for his blog readers, to test whether a digraph substitution cryptogram of this length could be solved. We will come back to this story in the “<span class="xref" itemid="xref_target_Challenges">Challenges</span>” section of this chapter.<sup class="endnote"><a href="b06.xhtml#c12-endnote-4" id="c12-noteref-4">4</a></sup></p>
<p class="BodyCustom"><code>UNGOZIHIJGSLGVWPIVGJSOKEFMAHSDBDGLUBUNZIWPIEBIUNKFVOUNB</code></p>
<p class="BodyCustom"><code>DSLPPHELVAQBAHEBIFJMHKVFLHXQQEFSLQQBDAQRIBVBIBYGJMOSOZB</code></p>
<p class="BodyCustom"><code>SDUXZINXUNEQVKUGYHUNVOWPSGSMGEFLFKRUHELFPHGVUXFGHRJYFUH</code></p>
<p class="BodyCustom"><code>IPBMHUNVOWPSGHXVKRSSGPHPWQXPLKCXGUNFGBICJFGJGCLLCFPNXUN</code></p>
<p class="BodyCustom"><code>TUUKKIZBKFABEQNHRFWLKCYHDJHJOPBZRLAHQVFTHETGRQRJTDAYDTX</code></p>
<p class="BodyCustom"><code>TVDBDKFEFZKSDHETUFVIQBIYABDEXZIKCHXRUKQRLGECJAQAOBKZIOB</code></p>
<p class="BodyCustom"><code>TEFMFRZNZACLWDWAUNEBBISLMREQKWRJRCUGHERGJMXONWGJHIPBEYG</code></p>
<p class="BodyCustom"><code>DZOHXIXKFOXFLKVRUDWAOBIDLSRRICSICJGKFZBBUMRFMGQKFYBXOHE</code></p>
<p class="BodyCustom"><code>TGHEOAMUEMWLAYRJWPKIGXUOSKZIHIJGSLHIGIBLFUXXUKUQPHGEGWH</code></p>
<p class="BodyCustom"><code>IOPZIBDLVBUKQRJSMUGFPWLWPSGPHFIKVYXCJLVULKVQSZIBDLVBUUI</code></p>
<p class="BodyCustom"><code>SRRUGJAIYXXGLKQXFRPBUOJIBTGHGDTGRCICUNVOWPSGDTLIEMTAVOU</code></p>
<p class="BodyCustom"><code>NVUQQKCRTLHBDAIUXFGOAKPBTKVFLAHVWRHWAUGKCXGUNFGBIXAGJHE</code></p>
<p class="BodyCustom"><code>HXGLBIRNGDOEBPUQSGBDIKACVORUBLKVVLZIHIJGSLWPIEUNCEPHFOM</code></p>
<p class="BodyCustom"><code>KFVMHUGNOPKBGLKCGCLHEXFAYUOMKTAGDZOHEKFLVBWKVPLGXBPHEGI</code></p>
<p class="BodyCustom"><code>XOTJWURUUNCLSOFMKVWGFMFPIKGJLLJYOGDWFRGLFQQEYDFVCAHYZPJ</code></p>
<p class="BodyCustom"><code>GKFBIRQHEBAHELFHEFSVUCLWDBWIGJGDRAYVKFPWLZNLQFGGJQAKFBL</code></p>
<p class="BodyCustom"><code>FUWQPWGJOBSLRIVVBXBDVUMHYIZYBZKFGQLWROZIOBMACTPHSMGECLF</code></p>
<p class="BodyCustom"><code>GVOSGUNTUJYOGBIHECERCUGWDEMFGKPAYSQKCBWONQVGEKVDHBIDWPH</code></p>
<p class="BodyCustom"><code>EMGEAQAONOEXZIOBMAUNTUPHFYNXXGUNFGBIFNFMMFOXJBBDCLBIBIF</code></p>
<p class="BodyCustom"><code>JMHKVFLFJMHXNHXVKUNKFZBTFFMHMFVLVWLYHHEMFOFICOJVUYXMFZN</code></p>
<p class="BodyCustom"><code>WLLWICLVSDZIFSEBUNNXVUFIHARCXOZKMMFPKVRUUNVOWPSGLCQWUGC</code></p>
<p class="BodyCustom"><code>ECJTGHIVKWAFLPHAQVKPHHJSGMFHMRLDDHJZUBPTDBOFGVOSGUNTUJY</code></p>
<p class="BodyCustom"><code>OGXGUNFGBIXAFMWAAQFPAIEQQQKCFIHAQWFIBPGLUBZNNNSOWDXMXGU</code></p>
<p class="BodyCustom"><code>NFGBIEAHAKCAHAQSGRLMSKFWDBAHEFVMHWGPHFYBIUNTUJYOGAIYXWA</code></p>
<p class="BodyCustom"><code>ZIFLYNKCRUSOKVLKBOWARIBIHJ</code></p>
<p>It is fairly easy to distinguish a digraph substitution from a simple substitution cipher by using frequency analysis. Look at the two diagrams in <a href="#figure12-3" id="figureanchor12-3">Figure 12-3</a>. The top part shows the frequency of letters in our ciphertext, and the lower part shows the frequency of letters in a simple-substitution-cipher encryption of the same plaintext. As can be seen, the frequency distribution of the upper chart, with digraph substitution, is a lot flatter (i.e., the frequent letters are less frequent, and the rare letters are less rare).</p>
<p>The index of coincidence is different, too. While an English text encrypted in a simple substitution cipher (as well as plain English) has an index of coincidence of 6.7%, our letter pair cryptogram has an index of coincidence of only 4.3%. </p>
<p>But what about other ciphers that are not simple substitutions? Do they have a similar frequency distribution?</p>
<span epub:type="pagebreak" id="Page_249" title="249"/><figure>
<img alt="" class="" height="362" src="image_fi/502727c12/f12003.png" width="636"/>
<figcaption><p><a id="figure12-3">Figure 12-3</a>: The letter frequency distributions of a digraph substitution (top) and a simple substitution cipher (bottom)</p></figcaption>
</figure>
<p>We can conduct a frequency count of the digraphs to help determine whether the algorithm is Playfair, another digraph system, transposition, polyalphabetic, or something else. However, the digraph frequency count we need to use here is different from the one we applied in <span class="xref" itemid="xref_target_Chapter 4"><a href="c04.xhtml">Chapter 4</a></span>, where we included overlapping pairs. For instance, the string <code>ABCDEF</code> consists of five overlapping digraphs (<code>AB</code>, <code>BC</code>, <code>CD</code>, <code>DE</code>, and <code>EF</code>). In the context of a digraph substitution, we should consider nonoverlapping pairs only. <code>ABCDEF</code> consists of three of these: <code>AB</code>, <code>CD</code>, and <code>EF</code>. Mathematically speaking, if there is an even number of <em>n</em> letters in a text, there are <em>n –</em> 1 overlapping digraphs and <em>n</em>/2 nonoverlapping ones.</p>
<p><a href="#figure12-4" id="figureanchor12-4">Figure 12-4</a> shows a (nonoverlapping) digraph frequency analysis of our cryptogram, followed by a digraph frequency analysis of the same plaintext encrypted in a Vigenère cipher. We used <a class="LinkURL" href="https://dcode.fr/en">https://dcode.fr/en</a> to count the letter pairs and Excel to plot the diagrams. Note that there are only about 220 different pairs in the digraph cryptogram, while there are some 380 in the Vigenère cryptogram.</p>
<p>The lower part of the diagram also shows that only a few letter pairs in the Vigenère cryptogram have a frequency of over 1%, while in the upper part, we see some twenty-five of these in the digraph substitution cryptogram, with the most frequent one almost reaching 4%.</p>
<p>It is worth noting that, even in longer English texts, the plaintexts will show properties of only having about three hundred different digraphs, regardless of whether we count overlapping digraphs or not. All other possible digraphs (of the 676 total) would probably have a frequency of zero. This is because, in English, many letter pairs such as <em>QZ</em>, <em>VH</em>, <em>II</em>, and <em>JN</em> are extremely rare.</p>
<p>All in all, the risk of confusing a digraph substitution with another cipher is not very high if one compares the frequency counts of nonoverlapping digraphs.</p>
<span epub:type="pagebreak" id="Page_250" title="250"/><figure>
<img alt="" class="" height="361" src="image_fi/502727c12/f12004.png" width="694"/>
<figcaption><p><a id="figure12-4">Figure 12-4</a>: Two frequency distribution charts using nonoverlapping digraphs. The pattern for our digraph substitution cryptogram (top) looks different from that of a Vigenère ciphertext (bottom) because fewer digraphs appear, while the frequencies of the most common digraphs are much higher (above 3.0).</p></figcaption>
</figure>
<h2 id="h1-502727c12-0004"><a class="XrefDestination" id="HowtodetectaPlayfaircipher"/><span class="XrefDestination" id="xref-502727c12-006"/>How to detect a Playfair cipher</h2>
<p class="BodyFirst">How can we check whether a certain cryptogram has been created with a Playfair cipher? As an example, consider a message sent in World War II. During the war, the US Navy and the United States’ allies used the Playfair cipher frequently for tactical communication in the Pacific. One story involves <em>PT-109</em>, a patrol torpedo boat commanded by the young naval officer and later president, John F. Kennedy.<sup class="endnote"><a href="b06.xhtml#c12-endnote-5" id="c12-noteref-5">5</a></sup> After the much larger Japanese destroyer <em>Amagiri</em> crashed into<em> PT-109</em>, slicing it in half and sinking it, the American crew swam for miles and finally washed up on the beach of nearby Plum Pudding Island.</p>
<p>Australian coastwatcher Sublieutenant Arthur Reginald Evans, who observed the crash, received and decrypted multiple messages in Playfair and coordinated a rescue effort involving dispatching one of his teams of Solomon Islanders to try to find the crew.<sup class="endnote"><a href="b06.xhtml#c12-endnote-6" id="c12-noteref-6">6</a></sup> At the suggestion of one of his team members, Biuku Gasa, Kennedy sent a note (in English) carved into a coconut with his pocketknife. We will come back to this story in <span class="xref" itemid="xref_target_Chapter 15"><a href="c15.xhtml">Chapter 15</a></span>. For now, we are only interested in one of the Playfair messages (<a href="#figure12-5" id="figureanchor12-5">Figure 12-5</a>) sent to Evans, which reported the loss of <em>PT-109</em>.</p>
<p>The plaintext of this Playfair cryptogram, received at 9:20 <span class="KeyCaps">am</span> on August 7, 1943, five days after the crash, is noted on the upper half of the sheet and reproduced here:</p>
<p class="BodyCustom"><code>ELEVEN SURVIVORS PT BOAT ON GROSS IS X HAVE SENT FOOD AND LETTER ADVISING SENIOR COME HERE WITHOUT DELAY X WARN AVIATION OF CANOES CROSSING FERGUSON RE</code></p>
<p><span epub:type="pagebreak" id="Page_251" title="251"/>As you can see, this message has 125 letters. The <code class="bold">RE</code> at the end stands for Reginald Evans, while <code class="bold">GROSS IS</code> means Gross Island (also known as Cross Island or Nauru). The <code class="bold">X</code> represents a period.</p>
<figure>
<img alt="" class="" height="457" src="image_fi/502727c12/f12005.png" width="694"/>
<figcaption><p><a id="figure12-5">Figure 12-5</a>: The Playfair-encrypted message received by the Australian coastwatcher Sublieutenant Arthur (“Reg”) Reginald Evans, which reported the loss of <em>PT-109</em> in World War II</p></figcaption>
</figure>
<p>This message used the key <code class="bold">PHYSICAL EXAMINATION</code> and an encryption method that is almost identical to the standard Playfair technique we saw earlier in this chapter, with three minor exceptions. First, pairs of equal letters are not avoided by adding an additional letter; instead, they are simply left unchanged. For instance, the <code class="bold">TT</code> in <code class="bold">LETTER</code> encrypts to a ciphertext <code>TT</code>. Second, <code>J</code> is used as an equivalent of <code>I</code> in the ciphertext. Third, the last letter of the message, <code class="bold">E</code>, for “Evans,” being unpaired because of the odd number of letters in the text, is left unchanged, without being paired with a padding letter.</p>
<p>Detecting a Playfair cipher can be quite easy, as it produces messages that have a number of very special and easy-to-see properties:</p>
<ul class="disc">
<li>The number of letters in the ciphertext is even.</li>
<li>The letter <code>J</code> does not appear because it is represented by <code>I</code>.</li>
<li>No digraph consists of two letters of the same kind.</li>
</ul>
<p>However, all these properties can be hidden easily, as the World War II Playfair ciphertext above shows. This message has an uneven number of letters because the last one is left unencrypted; it includes a J, which is used as an equivalent of <code>I</code>; and it has identical digraphs, which are double letters left unchanged instead of avoided by the insertion of an <code>X</code>. However, in most cases we have encountered in practice, the encipherer of a Playfair cryptogram does not take these precautions.</p>
<p><span epub:type="pagebreak" id="Page_252" title="252"/>If these criteria are not sufficient to identify the use of a Playfair cipher, we can turn to statistics to learn more. While counting nonoverlapping digraphs helps to distinguish digraph substitution from many other ciphers, it doesn’t differentiate a Playfair cipher from a general digraph substitution based on a 26 × 26 chart. To do that, we can perform an ordinary frequency count of the individual letters. The frequency distribution of a Playfair cryptogram is flatter—meaning that the frequent letters are less frequent, while the rare ones are less rare—than that of a simple substitution cipher, but less flat than that of a general digraph substitution (see <a href="#figure12-6" id="figureanchor12-6">Figure 12-6</a>).</p>
<figure>
<img alt="" class="" height="604" src="image_fi/502727c12/f12006.png" width="694"/>
<figcaption><p><em><a href="#figureanchor12-6" id="figure12-6">Figure 12-6</a>: </em>The frequency distribution of a Playfair cryptogram (top) is flatter than the distribution of a simple substitution cipher (bottom), but it is not as flat as the distribution of a general digraph substitution (middle).</p></figcaption>
</figure>
<h2 id="h1-502727c12-0005"><a class="XrefDestination" id="Howtobreakadigraphsubstitution"/><span class="XrefDestination" id="xref-502727c12-007"/>How to break a digraph substitution</h2>
<p class="BodyFirst">We can break the Playfair cipher, as well as digraph substitution in general, quite effectively and without a crib, using a computer program that implements hill climbing (see <span class="xref" itemid="xref_target_Chapter 16"><a href="c16.xhtml">Chapter 16</a></span>). In the following sections, we introduce a couple of other methods and then focus on one that can be used manually. As will become clear, a general digraph substitution is harder to break, requiring more ciphertext than a Playfair cipher.</p>
<h3 id="h2-502727c12-0001"><span epub:type="pagebreak" id="Page_253" title="253"/><a class="XrefDestination" id="Frequencyanalysis"/><span class="XrefDestination" id="xref-502727c12-008"/>Frequency analysis</h3>
<p class="BodyFirst">One way to attack a digraph substitution is to perform digraph frequency analysis of the nonoverlapping variant. The most frequent digraphs in the English language are <em>TH</em>, <em>HE</em>, <em>IN</em>, and <em>ER</em>. A more comprehensive list is available in <span class="xref" itemid="xref_target_Appendix B">Appendix B</span>. However, this method only works for long cryptograms. You’ll need about 2,000 letters to get a meaningful digraph frequency chart. Unfortunately, digraph substitution cryptograms are rarely this long in practice, so we rarely use frequency analysis alone to attack a digraph substitution.</p>
<h3 id="h2-502727c12-0002"><a class="XrefDestination" id="Dictionaryattacks"/><span class="XrefDestination" id="xref-502727c12-009"/>Dictionary attacks</h3>
<p class="BodyFirst">If a cryptogram has been created with a Playfair cipher based on a keyword (as shown above), we can try a dictionary attack by using a computer program that decrypts the cryptogram with one keyword candidate after another until the resulting plaintext candidate looks like a meaningful text. To check whether a letter sequence looks meaningful, the program can employ a fitness function, as described in <span class="xref" itemid="xref_target_Chapter 16"><a href="c16.xhtml">Chapter 16</a></span>. The keyword candidates can be taken from a dictionary file (i.e., a file that lists all common words of a certain language). There are plenty of dictionary files, containing millions of words from many languages, available online. We describe an example of a dictionary attack on a Playfair cryptogram in the <span class="xref" itemid="xref_target_“Success stories”">“Success stories”</span> section of this chapter.</p>
<h3 id="h2-502727c12-0003"><a class="XrefDestination" id="Manualattacks"/><span class="XrefDestination" id="xref-502727c12-010"/>Manual attacks</h3>
<p class="BodyFirst">It is definitely possible to break the Playfair cipher without computer support. However, it is considerably more difficult than solving a simple substitution cipher or a complete columnar transposition cipher—especially if we are dealing with a ciphertext that is no longer than, say, 200 letters. Most Playfair messages we have encountered are of this kind.</p>
<p>Solving a Playfair cryptogram manually usually requires knowing or guessing the plaintext equivalents of a few ciphertext digraphs and deriving others from those, following a few rules we will introduce here. In doing so, we will reconstruct the Playfair matrix used. Of course, this method becomes easier if we have a crib. Our success therefore depends on the crib available, the quality of our guesses, the length of the ciphertext, and chance.</p>
<p>It is important to note that different Playfair matrices may implement the same cipher. Generally speaking, a Playfair matrix can be circularly shifted column-wise and row-wise without changing the encryption method it defines. For example, the following three matrices are equivalent:</p>
<p class="BodyCustom"><code>S U R P I  U R P I S  V W X Y Z</code></p>
<p class="BodyCustom"><code>E A B C D  A B C D E  S U R P I</code></p>
<p class="BodyCustom"><code>F G H K L  G H K L F  E A B C D</code></p>
<p class="BodyCustom"><code>M N O Q T  N O Q T M  F G H K L</code></p>
<p class="BodyCustom"><code>V W X Y Z  W X Y Z V  M N O Q T</code></p>
<p><span epub:type="pagebreak" id="Page_254" title="254"/>It is therefore possible that the matrix we reconstruct while deciphering a message is a column-wise and row-wise circularly shifted version of the one the message creator used. Once we’ve found a matrix, we can discover the likely original orientation by seeing which shift produces a plausible keyword.</p>
<p>To break a Playfair cipher (in English), we can use a number of rules that are derived from weaknesses of this system:</p>
<ol class="decimal">
<li value="1">We mentioned that digraph frequencies are hard to exploit unless a cryptogram has thousands of letters. Nevertheless, we might be able to use the fact that in English texts, some letter pairs, such as <em>TH</em>, <em>HE</em>, <em>IN</em>, and <em>ER</em>, are especially frequent, while others, including <em>QG</em> and <em>JN</em>, are almost nonexistent.</li>
<li value="2">The most frequent tetragraphs (i.e., groups of four letters) in the English language are <em>THER</em>, <em>TION</em>, <em>ATIO</em>, and <em>THAT</em>. This means that two of the most frequent digraphs (<em>TH</em> and <em>ER</em>) form <em>THER</em>, one of the most frequent tetragraphs.</li>
<li value="3">If <em>&lt;letter1&gt;&lt;letter2&gt;</em> encrypts to <em>&lt;letter3&gt;&lt;letter4&gt;</em>, then <em>&lt;letter2&gt;&lt;letter1&gt;</em> will encrypt to <em>&lt;letter4&gt;&lt;letter3&gt;</em>. For instance, if <code class="bold">AB</code> encrypts to <code>XY</code>, then <code class="bold">BA</code> will encrypt to <code>YX</code>.</li>
<li value="4">The most frequent pair of digraphs that is routinely mirrored is <em>ER</em>/<em>RE</em>, followed by <em>ES</em>/<em>SE</em>.</li>
<li value="5">No letter will ever be encrypted to itself. For instance, <code class="bold">AB</code> won’t become <code>AY</code> or <code>YB</code>.</li>
<li value="6">If <em>&lt;letter1&gt;&lt;letter2&gt;</em> is replaced with <em>&lt;letter2&gt;&lt;letter3&gt;</em>, the letters <em>&lt;letter1&gt;&lt;letter2&gt;&lt;letter3&gt;</em> will appear in a row or column together in exactly that order. The same is true if <em>&lt;letter1&gt;&lt;letter2&gt;</em> is replaced by <em>&lt;letter3&gt;&lt;letter1&gt;</em>. For instance, if <code class="bold">XY</code> is replaced with <code>YZ</code>, you’ll find the letters <code>XYZ</code> in a row or column rather than as part of a rectangle. Similarly, if <code class="bold">XY</code> is replaced with <code>ZX</code>, the letters <code>XZY</code> will be in a row or column in that order.</li>
<li value="7">If <em>&lt;letter1&gt;</em> and <em>&lt;letter2&gt;</em> form a rectangle in the Playfair matrix (which happens in sixteen of twenty-four cases), the following rule holds: if <em>&lt;letter1&gt;&lt;letter2&gt;</em> encrypts to <em>&lt;letter3&gt;&lt;letter4&gt;</em>, then <em>&lt;letter3&gt;&lt;letter4&gt;</em> encrypts to <em>&lt;letter1&gt;&lt;letter2&gt;</em>. For instance, if <code>A</code> and <code>B</code> form a rectangle, then if <code class="bold">AB</code> encrypts to <code>XY</code>, <code class="bold">XY</code> encrypts to <code>AB</code>.</li>
<li value="8">Each letter can only be encrypted to five specific ciphertext letters in any Playfair tableau.</li>
<li value="9">Letters that appear in a row or column with frequent letters (especially <code>E</code> and <code>T</code>) are more frequent in the ciphertext than others.</li>
<li value="10">If the Playfair cipher uses a keyword in the way shown above, it is likely that the more frequent letters will appear at the top of the square. In many cases, the letters <code>VWXYZ</code> form the last line because these letters have a low frequency (and thus have a low likelihood of occurring in the keyword). The line <code>UVWXZ</code> is also encountered quite often at the bottom of a matrix, because <code>Y</code> is more frequent than its neighbors.</li>
</ol>
<p><span epub:type="pagebreak" id="Page_255" title="255"/>To apply these rules, we’ll now break a Playfair message described in Chapter 26 of Dorothy L. Sayers’s 1932 crime novel <em>Have His Carcase</em> (<a href="#figure12-7" id="figureanchor12-7">Figure 12-7</a>).</p>
<figure>
<img alt="" class="" height="480" src="image_fi/502727c12/f12008.png" width="335"/>
<figcaption><p><a id="figure12-7">Figure 12-7</a>: Dorothy L. Sayers’s 1932 crime novel <em>Have His Carcase</em> contains a Playfair cryptogram.</p></figcaption>
</figure>
<p>Here is the encrypted message:</p>
<p class="BodyCustom"><code>XNATNX</code></p>
<p class="BodyCustom"><code>RBEXMG</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>PRBFX ALI MKMG BFFY, MGTSQ IMRRY. ZBZE</code></p>
<p class="BodyCustom"><code>FLOX P.M. MSIU FKX FLDYPC FKAP RPD KL DONA</code></p>
<p class="BodyCustom"><code>FMKPC FM NOR ANXP.</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>SOLFA TGMZ DXL LKKZM VXI BWHNZ MBFFY</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>MG. TSQ A NVPD NMM VFYQ. CIU ROGA K.C. RAC</code></p>
<p class="BodyCustom"><code>RRMTN S.B. IF H.P. HNZ ME? SSPXLZ DFAX LRAEL</code></p>
<p class="BodyCustom"><code>TLMK. XATL RPX BM AEBF HS MPIKATL TO</code></p>
<p class="BodyCustom"><code>HOKCCI HNRY. TYM VDSM SUSSX GAMKR. BG AIL</code></p>
<p class="BodyCustom"><code>AXH NZMLF HVUL KNN RAGY QWMCK. MNQS</code></p>
<p class="BodyCustom"><code>TOIL AXFA AN IHMZS RPT HO KFLTIM. IF MTGNLU</code></p>
<p class="BodyCustom"><code>H.M. CLM KLZM AHPE ALF AKMSM, ZULPR FHQ --</code></p>
<p class="BodyCustom"><code>CMZT SXS RSMKRS GNKS FVMP RACY OSS QESBH</code></p>
<p class="BodyCustom"><code>NAE UZCK CON MGBNRY RMAL RSH NZM, BKTQAP</code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_256" title="256"/><code>MSH NZM TO ILG MELMS NAGMIU KC KC.</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>TQKFX BQZ NMEZLI BM ZLFA AYZ MARS UP QOS</code></p>
<p class="BodyCustom"><code>KMXBP SUE UMIL PRKBG MSK QD.</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>NAP DZMTB N.B. OBE XMG SREFZ DBS AM IMHY</code></p>
<p class="BodyCustom"><code>GAKY R. MULBY M.S. SZLKO GKG LKL GAW</code></p>
<p class="BodyCustom"><code>XNTED BHMB XZD NRKZH PSMSKMN A.M. MHIZP</code></p>
<p class="BodyCustom"><code>DK MIM, XNKSAK C KOK MNRL CFL INXF HDA</code></p>
<p class="BodyCustom"><code>GAIQ.</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>GATLM Z DLFA A QPHND MV AK MV MAG C.P.R.</code></p>
<p class="BodyCustom"><code>XNATNX PD GUN MBKL I OLKA GLDAGA KQB</code></p>
<p class="BodyCustom"><code>FTQO SKMX GPDH NW LX SULMY ILLE MKH</code></p>
<p class="BodyCustom"><code>BEALF MRSK UFHA AKTS.</code></p>
<p>Here is the same text broken into digraphs:</p>
<p class="BodyCustom"><code>XN AT NX RB EX MG PR BF XA LI</code></p>
<p class="BodyCustom"><code>MK MG BF FY MG TS QI MR RY ZB</code></p>
<p class="BodyCustom"><code>ZE FL OX PM MS IU FK XF LD YP</code></p>
<p class="BodyCustom"><code>CF KA PR PD KL DO NA FM KP CF</code></p>
<p class="BodyCustom"><code>MN OR AN XP SO LF AT GM ZD XL</code></p>
<p class="BodyCustom"><code>LK KZ MV XI BW HN ZM BF FY MG</code></p>
<p class="BodyCustom"><code>TS QA NV PD NM MV FY QC IU RO</code></p>
<p class="BodyCustom"><code>GA KC RA CR RM TN SB IF HP HN</code></p>
<p class="BodyCustom"><code>ZM ES SP XL ZD FA XL RA EL TL</code></p>
<p class="BodyCustom"><code>MK XA TL RP XB MA EB FH SM PI</code></p>
<p class="BodyCustom"><code>KA TL TO HO KC CI HN RY TY MV</code></p>
<p class="BodyCustom"><code>DS MS US SX GA MK RB GA IL AX</code></p>
<p class="BodyCustom"><code>HN ZM LF HV UL KN NR AG YQ WM</code></p>
<p class="BodyCustom"><code>CK MN QS TO IL AX FA AN IH MZ</code></p>
<p class="BodyCustom"><code>SR PT HO KF LT IM IF MT GN LU</code></p>
<p class="BodyCustom"><code>HM CL MK LZ MA HP EA LF AK MS</code></p>
<p class="BodyCustom"><code>MZ UL PR FH QC MZ TS XS RS MK</code></p>
<p class="BodyCustom"><code>RS GN KS FV MP RA CY OS SQ ES</code></p>
<p class="BodyCustom"><code>BH NA EU ZC KC ON MG BN RY RM</code></p>
<p class="BodyCustom"><code>AL RS HN ZM BK TQ AP MS HN ZM</code></p>
<p class="BodyCustom"><code>TO IL GM EL MS NA GM IU KC KC</code></p>
<p class="BodyCustom"><code>TQ KF XB QZ NM EZ LI BM ZL FA</code></p>
<p class="BodyCustom"><code>AY ZM AR SU PQ OS KM XB PS UE</code></p>
<p class="BodyCustom"><code>UM IL PR KB GM SK QD NA PD ZM</code></p>
<p class="BodyCustom"><code>TB NB OB EX MG SR EF ZD BS AM</code></p>
<p class="BodyCustom"><code>IM HY GA KY RM UL BY MS SZ LK</code></p>
<p class="BodyCustom"><code>OG KG LK LG AW XN TE DB HM BX</code></p>
<p class="BodyCustom"><code>ZD NR KZ HP SM SK MN AM MH IZ</code></p>
<p class="BodyCustom"><code>PD KM IM XN KS AK CK OK MN RL</code></p>
<p class="BodyCustom"><code>CF LI NX FH DA GA IQ GA TL MZ</code></p>
<p class="BodyCustom"><code>DL FA AQ PH ND MV AK MV MA GC</code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_257" title="257"/><code>PR XN AT NX PD GU NM BK LI OL</code></p>
<p class="BodyCustom"><code>KA GL DA GA KQ BF TQ OS KM XG</code></p>
<p class="BodyCustom"><code>PD HN WL XS UL MY IL LE MK HB</code></p>
<p class="BodyCustom"><code>EA LF MR SK UF HA AK TS</code></p>
<p>Before we start deciphering, we have to do some statistical analysis. The ciphertext has 696 letters. <a href="#figure12-8" id="figureanchor12-8">Figure 12-8</a> shows the letter and nonoverlapping digraph frequencies. <code>M</code> is the most frequent character in the cryptogram. This suggests that it is in a line or column with <code>E</code>, the most frequent letter of the English language.</p>
<figure>
<img alt="" class="" height="309" src="image_fi/502727c12/f12007.png" width="694"/>
<figcaption><p><a id="figure12-8">Figure 12-8</a>: Frequency analysis of the letters (top) and the digraphs (bottom) in the Playfair cryptogram described in Dorothy L. Sayers’s 1932 crime novel <em>Have His Carcase</em></p></figcaption>
</figure>
<p>The most frequent reversible letter pairs appearing in the ciphertext are the following:</p>
<ol class="none">
<li><code>ZM</code>/<code>MZ</code> appears seven and four times, respectively.</li>
<li><code>MK</code>/<code>KM</code> appears six and three times, respectively.</li>
<li><code>IL</code>/<code>LI</code> appears five and four times, respectively.</li>
</ol>
<p>It is possible to solve a Playfair cryptogram by applying only the rules mentioned so far. However, doing so requires a lot of trial and error—a procedure that is too lengthy and complex to document in this book. To make things a little easier, we’ll assume that we have some information about the contents of the text. Researching the context in which a cipher message was created can be a powerful tool. In this example, we learn the following:</p>
<ul class="disc">
<li>This message was sent from Warsaw, Poland.</li>
<li>A treaty concluded with Poland might be mentioned.</li>
<li>The recipient of the message is usually addressed as “His Serene Highness.”</li>
</ul>
<p>This information delivers us a few cribs. For instance, the first line of the cryptogram consists of only six letters: <code>XN AT NX</code>. Note that the third letter pair is the reverse of the first one, which means that its plaintext <span epub:type="pagebreak" id="Page_258" title="258"/>representation is a reversed version of the other, too. Because the letter was sent from Warsaw, it appears that <code class="bold">WARSAW</code> is a potential match. So, let’s use <code class="bold">WARSAW</code> as a first crib. If our guess is correct, we can conclude the following:</p>
<p class="BodyCustom"><code class="bold">WA</code> = <code>XN</code></p>
<p class="BodyCustom"><code class="bold">RS</code> = <code>AT</code></p>
<p class="BodyCustom"><code class="bold">AW</code> = <code>NX</code></p>
<p>Moreover, by reversing the letter pair of the second statement, we get this:</p>
<p class="BodyCustom"><code class="bold">SR</code> = <code>TA</code></p>
<p>The digraphs <code>XN AT NX</code> (<code class="bold">WARSAW</code>) appear again on line 32 of the ciphertext. Before it, we find the letter pair <code>PR</code>. With five appearances, <code>PR</code> is one of the twelve most frequent digraphs in the ciphertext. What does it stand for? Possibilities like <code class="bold">THWARSAW</code>, <code class="bold">ENWARSAW</code>, <code class="bold">ERWARSAW</code>, and <code class="bold">ONWARSAW</code>, as well as a few other guesses based on letter pair frequencies, are unlikely. The most plausible option is <code class="bold">TOWARSAW</code>, which gives us the following:</p>
<p class="BodyCustom"><code class="bold">TO</code> = <code>PR</code></p>
<p>Again, we gain another mapping by reversing the letters:</p>
<p class="BodyCustom"><code class="bold">OT</code> = <code>RP</code></p>
<p>Based on rule 7 for breaking Playfair messages, listed earlier in this chapter, we can assume that the following six statement pairs are most likely correct. These mappings result from switching the plaintext and ciphertext in the statements we already know, and each has a probability of sixteen in twenty-four (or 66.6%) of being correct:</p>
<p class="BodyCustom"><code class="bold">XN</code> = <code>WA</code></p>
<p class="BodyCustom"><code class="bold">NX</code> = <code>AW</code></p>
<p class="BodyCustom"><code class="bold">AT</code> = <code>RS</code></p>
<p class="BodyCustom"><code class="bold">TA</code> = <code>SR</code></p>
<p class="BodyCustom"><code class="bold">PR</code> = <code>TO</code></p>
<p class="BodyCustom"><code class="bold">RP</code> = <code>OT</code></p>
<p>To check if these mappings are plausible, we can look at their frequencies. <code>WA</code> doesn’t appear in the ciphertext, so we don’t have to worry about it. <code>AW</code> appears once; at the moment, we can’t say whether it really stands for <code class="bold">NX</code>, but <code class="bold">NX</code> is a plausible digraph, provided that the letter <code class="bold">X</code> was used to separate pairs of equal letters. Furthermore, <code class="bold">AT</code> = <code>RS</code> and <code class="bold">TA</code> = <code>SR</code> are plausible because <code>RS</code> appears three times in the ciphertext, as expected for the ciphertext equivalent of the common letter pair <code class="bold">AT</code>. It is hard to say whether <code class="bold">PR</code> = <code>TO</code> and <code class="bold">RP</code> = <code>OT</code> make sense, but to keep things simple, we take it as given that they do. (In real life, further analysis would be necessary to confirm this.)</p>
<p>In conclusion, we assume that all of these mappings are correct. Now, we fill in the letter pairs we have guessed so far:</p>
<p class="BodyCustom"><code>XN AT NX RB EX MG PR BF XA LI</code></p>
<p class="BodyCustom"><code class="bold">WA RS AW          TO</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_259" title="259"/><code>MK MG BF FY MG TS QI MR RY ZB</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>ZE FL OX PM MS IU FK XF LD YP</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>CF KA PR PD KL DO NA FM KP CF</code></p>
<p class="BodyCustom"><code class="bold">      TO</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>MN OR AN XP SO LF AT GM ZD XL</code></p>
<p class="BodyCustom"><code class="bold">RS</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>LK KZ MV XI BW HN ZM BF FY MG</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>TS QA NV PD NM MV FY QC IU RO</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>GA KC RA CR RM TN SB IF HP HN</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>ZM ES SP XL ZD FA XL RA EL TL</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>MK XA TL RP XB MA EB FH SM PI</code></p>
<p class="BodyCustom"><code class="bold">         OT</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>KA TL TO HO KC CI HN RY TY MV</code></p>
<p class="BodyCustom"><code> </code><code class="bold">PR</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>DS MS US SX GA MK RB GA IL AX</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>HN ZM LF HV UL KN NR AG YQ WM</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>CK MN QS TO IL AX FA AN IH MZ</code></p>
<p class="BodyCustom"><code class="bold">         PR</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>SR PT HO KF LT IM IF MT GN LU</code></p>
<p class="BodyCustom"><code class="bold">TA</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>HM CL MK LZ MA HP EA LF AK MS</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>MZ UL PR FH QC MZ TS XS RS MK</code></p>
<p class="BodyCustom"><code class="bold">      TO                AT</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>RS GN KS FV MP RA CY OS SQ ES</code></p>
<p class="BodyCustom"><code class="bold">AT</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>BH NA EU ZC KC ON MG BN RY RM</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>AL RS HN ZM BK TQ AP MS HN ZM</code></p>
<p class="BodyCustom"><code class="bold">   AT</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_260" title="260"/><code>TO IL GM EL MS NA GM IU KC KC</code></p>
<p class="BodyCustom"><code class="bold">PR</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>TQ KF XB QZ NM EZ LI BM ZL FA</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>AY ZM AR SU PQ OS KM XB PS UE</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>UM IL PR KB GM SK QD NA PD ZM</code></p>
<p class="BodyCustom"><code> </code><code class="bold">TO</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>TB NB OB EX MG SR EF ZD BS AM</code></p>
<p class="BodyCustom"><code class="bold">               TA</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>IM HY GA KY RM UL BY MS SZ LK</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>OG KG LK LG AW XN TE DB HM BX</code></p>
<p class="BodyCustom"><code> </code><code class="bold">NX WA</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>ZD NR KZ HP SM SK MN AM MH IZ</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>PD KM IM XN KS AK CK OK MN RL</code></p>
<p class="BodyCustom"><code class="bold">         WA</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>CF LI NX FH DA GA IQ GA TL MZ</code></p>
<p class="BodyCustom"><code class="bold">      AW</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>DL FA AQ PH ND MV AK MV MA GC</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>PR XN AT NX PD GU NM BK LI OL</code></p>
<p class="BodyCustom"><code class="bold">TO WA RS AW</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>KA GL DA GA KQ BF TQ OS KM XG</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>PD HN WL XS UL MY IL LE MK HB</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>EA LF MR SK UF HA AK TS</code></p>
<p>These known letter pairs are not sufficient to reconstruct complete words. Additional guesses are necessary, and admittedly, this is not an easy task. The following sequence (starting on line 17 of the cryptogram) might be helpful: <code>RS MK RS</code>, which decrypts to <code class="bold">AT**AT</code>. Remember that <code>MK</code> is an especially frequent reversible letter pair in our ciphertext. Does it stand for <code class="bold">RE</code>, the most common reversible letter pair in the English language? If so, we get <code class="bold">ATREAT</code>, which might stand for a <code class="bold">TREATY</code>. Remember that <code class="bold">TREATY</code> is a word we expect to appear in the plaintext. The new guess gives us this:</p>
<p class="BodyCustom"><code class="bold">RE</code> = <code>MK</code> and <code class="bold">ER </code>= <code>KM</code></p>
<p><span epub:type="pagebreak" id="Page_261" title="261"/>Assuming that we have identified the word <code class="bold">TREATY</code>, we could plausibly guess that the phrase <code class="bold">WITH POLAND</code> follows it. Remember that we know that the plaintext might mention a treaty with Poland. This means that <code>RS MK RS GN KS FV MP RA</code> could stand for <code class="bold">AT RE AT YW IT HP OL AN</code>, giving us the following pairings (including their reversed versions):</p>
<p class="BodyCustom"><code class="bold">YW</code> = <code>GN</code> and <code class="bold">WY</code> = <code>NG</code></p>
<p class="BodyCustom"><code class="bold">IT</code> = <code>KS</code> and <code class="bold">TI</code> = <code>SK</code></p>
<p class="BodyCustom"><code class="bold">HP</code> = <code>FV</code> and <code class="bold">PH</code> = <code>VF</code></p>
<p class="BodyCustom"><code class="bold">OL</code> = <code>MP</code> and <code class="bold">LO</code> = <code>PM</code></p>
<p class="BodyCustom"><code class="bold">AN</code> = <code>RA</code> and <code class="bold">NA</code> = <code>AR</code></p>
<p>The last substitution pair (<code class="bold">AN</code> = <code>RA</code> and <code class="bold">NA</code> =<code>AR</code>) also indicates that one line or column of the substitution table contains the letters <code>NAR</code>, in that order (according to rule 6). Here’s our next look at the ciphertext and the plaintext parts we already know:</p>
<p class="BodyCustom"><code>XN AT NX RB EX MG PR BF XA LI</code></p>
<p class="BodyCustom"><code class="bold">WA RS AW          TO</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>MK MG BF FY MG TS QI MR RY ZB</code></p>
<p class="BodyCustom"><code class="bold">RE</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>ZE FL OX PM MS IU FK XF LD YP</code></p>
<p class="BodyCustom"><code class="bold">         LO</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>CF KA PR PD KL DO NA FM KP CF</code></p>
<p class="BodyCustom"><code class="bold">      TO          ON</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>MN OR AN XP SO LF AT GM ZD XL</code></p>
<p class="BodyCustom"><code class="bold">      NO    PA    RS</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>LK KZ MV XI BW HN ZM BF FY MG</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>TS QA NV PD NM MV FY QC IU RO</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>GA KC RA CR RM TN SB IF HP HN</code></p>
<p class="BodyCustom"><code class="bold">   ED AN</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>ZM ES SP XL ZD FA XL RA EL TL</code></p>
<p class="BodyCustom"><code class="bold">   IL                AN</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>MK XA TL RP XB MA EB FH SM PI</code></p>
<p class="BodyCustom"><code class="bold">RE       OT</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>KA TL TO HO KC CI HN RY TY MV</code></p>
<p class="BodyCustom"><code class="bold">      PR    ED</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_262" title="262"/><code>DS MS US SX GA MK RB GA IL AX</code></p>
<p class="BodyCustom"><code class="bold">               RE</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>HN ZM LF HV UL KN NR AG YQ WM</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>CK MN QS TO IL AX FA AN IH MZ</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>SR PT HO KF LT IM IF MT GN LU</code></p>
<p class="BodyCustom"><code class="bold">TA                      YW</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>HM CL MK LZ MA HP EA LF AK MS</code></p>
<p class="BodyCustom"><code class="bold">      RE</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>MZ UL PR FH QC MZ TS XS RS MK</code></p>
<p class="BodyCustom"><code> </code><code class="bold">TO                AT RE</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>RS GN KS FV MP RA CY OS SQ ES</code></p>
<p class="BodyCustom"><code class="bold">AT YW IT HP OL AN</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>BH NA EU ZC KC ON MG BN RY RM</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>AL RS HN ZM BK TQ AP MS HN ZM</code></p>
<p class="BodyCustom"><code class="bold">   AT</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>TO IL GM EL MS NA GM IU KC KC</code></p>
<p class="BodyCustom"><code class="bold">PR</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>TQ KF XB QZ NM EZ LI BM ZL FA</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>AY ZM AR SU PQ OS KM XB PS UE</code></p>
<p class="BodyCustom"><code class="bold">      NA          ER</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>UM IL PR KB GM SK QD NA PD ZM</code></p>
<p class="BodyCustom"><code class="bold">      TO       TI    ON</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>TB NB OB EX MG SR EF ZD BS AM</code></p>
<p class="BodyCustom"><code class="bold">               TA</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>IM HY GA KY RM UL BY MS SZ LK</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>OG KG LK LG AW XN TE DB HM BX</code></p>
<p class="BodyCustom"><code class="bold">            NX WA</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>ZD NR KZ HP SM SK MN AM MH IZ</code></p>
<p class="BodyCustom"><code class="bold">               TI</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>PD KM IM XN KS AK CK OK MN RL</code></p>
<p class="BodyCustom"><code class="bold">   ER    WA IT</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_263" title="263"/><code>CF LI NX FH DA GA IQ GA TL MZ</code></p>
<p class="BodyCustom"><code class="bold">      AW</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>DL FA AQ PH ND MV AK MV MA GC</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>PR XN AT NX PD GU NM BK LI OL</code></p>
<p class="BodyCustom"><code class="bold">TO WA RS AW</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>KA GL DA GA KQ BF TQ OS KM XG</code></p>
<p class="BodyCustom"><code class="bold">                     AP ER</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>PD HN WL XS UL MY IL LE MK HB</code></p>
<p class="BodyCustom"><code class="bold">                        RE</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>EA LF MR SK UF HA AK TS</code></p>
<p class="BodyCustom"><code class="bold">         TI</code></p>
<p>Now, we extend <code class="bold">APER</code> to <code class="bold">PAPER</code>, a plausible word in a diplomatic message. But which letter comes before <code class="bold">P</code>? In other words, what is the <code class="bold">*</code> in <code class="bold">*P</code> = <code>TQ</code>? Because <code>TQ</code> appears three times in the cryptogram, we can almost be sure that the missing letter is <code class="bold">S</code>, producing <code class="bold">SP</code> = <code>TQ</code>, as <code class="bold">SP</code> is the most frequent letter pair ending with a <code class="bold">P</code> in English. Including the reverse pairing, we get this:</p>
<p class="BodyCustom"><code class="bold">SP</code> = <code>TQ</code> and <code class="bold">PS</code> = <code>QT</code></p>
<p>What might come before <code class="bold">SPAPERS</code>? The best option looks to be <code class="bold">HIS PAPERS</code>, giving us <code class="bold">HI</code> = <code>BF</code> and the reverse, <code class="bold">IH</code> = <code>FB</code>. The expression <code class="bold">PA**RS</code> in the fifth line of the ciphertext might also stand for <code class="bold">PAPERS</code>, which gives us the statements <code class="bold">PE</code> = <code>LF</code> and <code class="bold">EP</code> = <code>FL</code>.</p>
<p>Now, recall our third crib. Say we know that the expression <code class="bold">HIS SERENE HIGHNESS</code> usually appears early in the letter. In this case, it probably follows the word <code class="bold">TO</code> in the first line. Including the reversed versions, this crib reveals the statements <code class="bold">SX</code> = <code>XA</code>, <code class="bold">XS</code> = <code>AX</code>, <code class="bold">SE</code> = <code>LI</code>, <code class="bold">ES</code> = <code>IL</code>, <code class="bold">NE</code> = <code>MG</code>, <code class="bold">EN</code> = <code>GM</code>, <code class="bold">GH</code> = <code>FY</code>, and <code class="bold">HG</code> = <code>YF</code>.</p>
<p>According to rule 6, the statement <code class="bold">SX</code> = <code>XA</code> indicates that the letters <code>SXA</code> are found in a row or line of the Playfair matrix, in this order, and without any other letter in between. Remember that we also identified the letter sequence <code>NAR</code> as belonging to a line or row. Because both triples contain an <code>A</code>, we can reconstruct the following part of the matrix:</p>
<p class="BodyCustom"><code> S</code></p>
<p class="BodyCustom"><code> X</code></p>
<p class="BodyCustom"><code>NAR</code></p>
<p>Combining this with the statements <code class="bold">WA</code> = <code>XN</code> and <code class="bold">RS</code> = <code>AT</code>, which we already know, we get the following:</p>
<p class="BodyCustom"><code> ST</code></p>
<p class="BodyCustom"><code>WX</code></p>
<p class="BodyCustom"><code>NAR</code></p>
<p><span epub:type="pagebreak" id="Page_264" title="264"/>Let’s now apply our newly detected statements to the ciphertext:</p>
<p class="BodyCustom"><code>XN AT NX RB EX MG PR BF XA LI</code></p>
<p class="BodyCustom"><code class="bold">WA RS AW       NE TO HI SX SE</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>MK MG BF FY MG TS QI MR RY ZB</code></p>
<p class="BodyCustom"><code class="bold">RE NE HI GH NE</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>ZE FL OX PM MS IU FK XF LD YP</code></p>
<p class="BodyCustom"><code class="bold">   EP    LO</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>CF KA PR PD KL DO NA FM KP CF</code></p>
<p class="BodyCustom"><code class="bold">      TO          ON</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>MN OR AN XP SO LF AT GM ZD XL</code></p>
<p class="BodyCustom"><code class="bold">      NO    PA PE RS EN</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>LK KZ MV XI BW HN ZM BF FY MG</code></p>
<p class="BodyCustom"><code class="bold">                     HI GH NE</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>TS QA NV PD NM MV FY QC IU RO</code></p>
<p class="BodyCustom"><code class="bold">                  GH</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>GA KC RA CR RM TN SB IF HP HN</code></p>
<p class="BodyCustom"><code class="bold">   ED AN</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>ZM ES SP XL ZD FA XL RA EL TL</code></p>
<p class="BodyCustom"><code class="bold">                     AN</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>MK XA TL RP XB MA EB FH SM PI</code></p>
<p class="BodyCustom"><code class="bold">RE SX    OT</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>KA TL TO HO KC CI HN RY TY MV</code></p>
<p class="BodyCustom"><code class="bold">      PR    ED</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>DS MS US SX GA MK RB GA IL AX</code></p>
<p class="BodyCustom"><code class="bold">               RE       ES SX</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>HN ZM LF HV UL KN NR AG YQ WM</code></p>
<p class="BodyCustom"><code class="bold">      PE</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>CK MN QS TO IL AX FA AN IH MZ</code></p>
<p class="BodyCustom"><code class="bold">            ES SX</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>SR PT HO KF LT IM IF MT GN LU</code></p>
<p class="BodyCustom"><code class="bold">TA                      YW</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>HM CL MK LZ MA HP EA LF AK MS</code></p>
<p class="BodyCustom"><code class="bold">      RE             PE</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_265" title="265"/><code>MZ UL PR FH QC MZ TS XS RS MK</code></p>
<p class="BodyCustom"><code class="bold">      TO                AT RE</code></p>
<p class="BodyCustom"><code>RS GN KS FV MP RA CY OS SQ ES</code></p>
<p class="BodyCustom"><code class="bold">AT YW IT HP OL AN</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>BH NA EU ZC KC ON MG BN RY RM</code></p>
<p class="BodyCustom"><code class="bold">   ON             NE</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>AL RS HN ZM BK TQ AP MS HN ZM</code></p>
<p class="BodyCustom"><code class="bold">   AT          SP</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>TO IL GM EL MS NA GM IU KC KC</code></p>
<p class="BodyCustom"><code class="bold">PR ES EN       ON EN</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>TQ KF XB QZ NM EZ LI BM ZL FA</code></p>
<p class="BodyCustom"><code class="bold">SP                SE</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>AY ZM AR SU PQ OS KM XB PS UE</code></p>
<p class="BodyCustom"><code class="bold">      NA          ER</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>UM IL PR KB GM SK QD NA PD ZM</code></p>
<p class="BodyCustom"><code class="bold">   ES TO    EN TI    ON</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>TB NB OB EX MG SR EF ZD BS AM</code></p>
<p class="BodyCustom"><code class="bold">            EN TA</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>IM HY GA KY RM UL BY MS SZ LK</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>OG KG LK LG AW XN TE DB HM BX</code></p>
<p class="BodyCustom"><code class="bold">            NX WA</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>ZD NR KZ HP SM SK MN AM MH IZ</code></p>
<p class="BodyCustom"><code class="bold">               TI</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>PD KM IM XN KS AK CK OK MN RL</code></p>
<p class="BodyCustom"><code class="bold">   ER    WA IT</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>CF LI NX FH DA GA IQ GA TL MZ</code></p>
<p class="BodyCustom"><code class="bold">   SE AW</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>DL FA AQ PH ND MV AK MV MA GC</code></p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>PR XN AT NX PD GU NM BK LI OL</code></p>
<p class="BodyCustom"><code class="bold">TO WA RS AW             SE</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>KA GL DA GA KQ BF TQ OS KM XG</code></p>
<p class="BodyCustom"><code class="bold">               HI SP AP ER</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_266" title="266"/><code>PD HN WL XS UL MY IL LE MK HB</code></p>
<p class="BodyCustom"><code class="bold">                  ES    RE</code></p>
<p class="BodyCustom"><code class="bold"> </code></p>
<p class="BodyCustom"><code>EA LF MR SK UF HA AK TS</code></p>
<p class="BodyCustom"><code class="bold">   PE    TI</code></p>
<p>For brevity’s sake, we’ll skip the rest of the codebreaking process. In the end, we receive the following plaintext:</p>
<p class="BodyCustom"><code>WARSAW AD IUNE TO HIS X SERENE HIGHNESQS GRANDX DUKE PAVLO ALEXEIVITCHQ HEIR TO THE THRONE OF THE ROMANOVS PAPERS ENTRUSTED TO US BYX YOUR HIGHNESQS NOW THOROUGHLY EXAMINED AND MARQRIAGE OF YOUR ILQLUSTRIOUS ANCESTRESXS TO TSAR NICHOLAS FIRST PROVED BEYONDQ DOUBT ALXL IS IN READINESXS YOUR PEOPLE GROANING UNDER OPQPRESXSION OF BRUTAL SOVIETS EAGERLY WELCOME RETURN OF IMPERIAL RULE TO HOLY RUSQSIA TREATY WITH POLAND HAPQPILY CONCLUDED MONEY AND ARMS AT YOUR DISPOSAL YOUR PRESENCE ALONE NEXEDED SPIES AT WORK USE CAUTION BURN ALXL PAPERS ALQL CLUES TO IDENTITY ON THURSDAY AH IUNE TAKE TRAIN REACHING DARLEY HALT X TEN FIFTEQEN X WALK BY COASTROAD TO FLATIRON ROCK X THERE AWAIT RIDER FROM THESE A WHO BRINGS INSTRUCTIONS FOR YOUR IOURNEY TO WARSAW THE WORD IS EMPIRE Q BRING THIS PAPER WITH YOU QSILENCE SECRECY IMPERATIVE BORISQ</code></p>
<p>Here’s the complete Playfair matrix, which is based on the keyword <code class="bold">MONARCHY</code>. We can circularly shift rows and columns with respect to the matrix to reproduce a meaningful keyword:</p>
<p class="BodyCustom"><code>M O N A R</code></p>
<p class="BodyCustom"><code>C H Y B D</code></p>
<p class="BodyCustom"><code>E F G I K</code></p>
<p class="BodyCustom"><code>L P Q S T</code></p>
<p class="BodyCustom"><code>U V W X Z</code></p>
<p>We might now find it interesting to take a second look at the text statistics generated at the start of our analysis. <code>M</code>, which is the most frequent letter in the cryptogram, appears in the same column as <code>E</code>—just as we expected. The most frequent digraphs, <code>ZM</code>, <code>HN</code>, and <code>GA</code>, decrypt to <code class="bold">UR</code>, <code class="bold">YO</code>, and <code class="bold">IN</code>. The digraph <code class="bold">UR</code> is not typically this common in an English text; here, its frequent appearance is caused by the example’s frequent use of the word <code class="bold">YOUR</code>. The plaintext equivalents of the frequent reversible digraphs, <code>ZM</code>/<code>MZ</code>, <code>MK</code>/<code>KM</code>, and <code>IL</code>/<code>LI</code>, are <code class="bold">UR</code>/<code class="bold">RU</code>, <code class="bold">RE</code>/<code class="bold">ER</code>, and <code class="bold">ES</code>/<code class="bold">SE</code>. Again, <code class="bold">UR</code>/<code class="bold">RU</code> appears more commonly than one would expect, but things like this happen in the life of a codebreaker. All in all, text statistics were not particularly helpful in breaking this Playfair cryptogram, though they may be in other cases.</p>
<p>It should now be clear that manually breaking a Playfair cryptogram is a difficult task. Although we had several cribs (which we cannot, of course, always expect in practice), we had to make a few quite optimistic guesses. We also cheated by only following the guesses we knew were correct. A real codebreaking process would require a lot more trial and error. Still, in the pre-computer age, people really did solve Playfair encryptions with the method described here. We can’t help but tip our hats to them.</p>
<p><span epub:type="pagebreak" id="Page_267" title="267"/>If you are looking for resources that explain the techniques introduced in this chapter in more detail, check out the cited chapters in <em>Cryptanalysis</em> by Helen Fouché Gaines,<sup class="endnote"><a href="b06.xhtml#c12-endnote-7" id="c12-noteref-7">7</a></sup> <em>Manual for the Solution of Military Ciphers</em> by Parker Hitt,<sup class="endnote"><a href="b06.xhtml#c12-endnote-8" id="c12-noteref-8">8</a></sup> or <em>Cryptography</em> by André Langie.<sup class="endnote"><a href="b06.xhtml#c12-endnote-9" id="c12-noteref-9">9</a></sup> In <em>Solution of a Playfair Cipher</em>, Alf Monge also walks through the breaking of a Playfair cryptogram consisting of only thirty letters.<sup class="endnote"><a href="b06.xhtml#c12-endnote-10" id="c12-noteref-10">10</a></sup></p>
<h2 id="h1-502727c12-0006"><a class="XrefDestination" id="Successstories"/><span class="XrefDestination" id="xref-502727c12-011"/>Success stories</h2>
<h3 id="h2-502727c12-0004"><a class="XrefDestination" id="Thouless’sfirstmessage"/><span class="XrefDestination" id="xref-502727c12-012"/>Thouless’s first message</h3>
<p class="BodyFirst">As mentioned earlier in this chapter, British parapsychologist Robert Thouless (1894–1984) published a Playfair message in 1948, intending to psychically transmit its key after his death (see <span class="xref" itemid="xref_target_Chapter 8"><a href="c08.xhtml">Chapter 8</a></span> for details).<sup class="endnote"><a href="b06.xhtml#c12-endnote-11" id="c12-noteref-11">11</a></sup> This message is reproduced here and in <a href="#figure12-9" id="figureanchor12-9">Figure 12-9</a>:</p>
<p class="BodyCustom"><code>CBFTM HGRIO TSTAU FSBDN WGNIS BRVEF BQTAB</code></p>
<p class="BodyCustom"><code>QRPEF BKSDG MNRPS RFBSU TTDMF EMA BIM</code></p>
<p>A codebreaker, who wanted to stay anonymous, deciphered this message only a few weeks after its publication, causing Thouless’s first attempt at his experiment to fail. We do not know how this individual deciphered this cryptogram—the codebreaker is referenced only briefly in Thouless’s next paper—but we can make a few educated guesses.</p>
<figure>
<img alt="" class="" height="446" src="image_fi/502727c12/f12009.png" width="694"/>
<figcaption><p><a id="figure12-9">Figure 12-9</a>: Robert Thouless (pictured) wanted to channel the solution to this Playfair-encrypted message after his death in order to prove that the dead can communicate with the living. However, long before Thouless died, a codebreaker solved the cryptogram—without psychic powers.</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_268" title="268"/>As Thouless did not reveal the encryption system he had used, the first hurdle involved finding out his method. Frequency analysis clearly shows that Thouless had not used a simple substitution cipher. The unknown codebreaker probably saw that the message didn’t contain a <code>J </code>and had an even number of letters, as is typical of a Playfair cipher. The fact that no digraph in the ciphertext consists of two identical letters is consistent with Playfair, too. Considering all this evidence, the codebreaker had enough reason to conclude that they were dealing with a Playfair cryptogram.</p>
<p>But, once they had identified the system as Playfair, how did they solve it? In his 2017 book <em>Unsolved</em><em>!</em>, our colleague Craig Bauer points to a few promising starting points.<sup class="endnote"><a href="b06.xhtml#c12-endnote-12" id="c12-noteref-12">12</a></sup> We mentioned earlier in this chapter that the last line of a Playfair matrix derived from a keyword is often <code>VWXYZ</code>, because these five letters are unlikely to be included in a keyword in English. In this case, this assumption turns out to be correct. In addition, Craig writes:</p>
<blockquote class="blockquote">
<p class="Blockquote">We see that some digraphs (<code>BQ</code>, <code>EF</code>, <code>SB</code>, and <code>TA</code>) appear twice. These are likely to represent high-frequency digraphs in normal English. A lot of trial and error may be involved in matching these up correctly, but cryptanalysts are patient.</p>
</blockquote>
<p>It might also have helped that Thouless’s message contains <code>BS</code> and <code>SB</code>, a reversing digraph. The most frequent reversing digraph in English texts is <em>ER</em>/<em>RE</em>. So, does <code>BS</code> stand for <code class="bold">ER</code> and <code>SB</code> for <code class="bold">RE</code>, or vice versa? It turns out that the mappings <code>BS</code> = <code class="bold">ER</code> and <code>SB</code> = <code class="bold">RE</code> are correct.</p>
<p>The unknown codebreaker might also have taken a completely different approach. While Thouless did not reveal the cipher he used, he mentioned that the plaintext was a Shakespearean quote. Perhaps the codebreaker worked through a list of famous Shakespeare quotes, looking for one that contains the same digraph repetitions as the ciphertext. The pattern <code>BQTABQ</code>, consisting of two identical digraphs with a different one in between, might have been helpful for this purpose. It is certainly possible to identify the correct plaintext in this way.</p>
<p>Whichever method the codebreaker used, they finally came up with the following Playfair matrix (based on the keyword <code class="bold">SURPRISE</code>):</p>
<p class="BodyCustom"><code>S U R P I</code></p>
<p class="BodyCustom"><code>E A B C D</code></p>
<p class="BodyCustom"><code>F G H K L</code></p>
<p class="BodyCustom"><code>M N O Q T</code></p>
<p class="BodyCustom"><code>V W X Y Z</code></p>
<p>From this matrix, they derived the following plaintext, which is from Shakespeare’s <em>Macbeth</em>, Act 2, Scene 2, and proved correct: <code class="bold">BALM OF HURT MINDS GREAT NATURE’S SECOND COURSE CHIEF NOURISHER IN LIFE’S FEAST.</code></p>
<h3 id="h2-502727c12-0005"><a class="XrefDestination" id="Thouless’sthirdmessage"/><span class="XrefDestination" id="xref-502727c12-013"/>Thouless’s third message</h3>
<p class="BodyFirst">Robert Thouless’s third cryptogram is also encrypted with the Playfair cipher (see <span class="xref" itemid="xref_target_Chapter 8"><a href="c08.xhtml">Chapter 8</a></span> for the background story). However, this time, Thouless double-encrypted the message, using Playfair twice with two <span epub:type="pagebreak" id="Page_269" title="269"/>different keywords, in order to increase its security. Between the two encryptions, he added the same letter to the start and end of the result, to make decryption a bit more difficult. Here’s the cryptogram he published:</p>
<p class="BodyCustom"><code>BTYRR OOFLH KCDXK FWPCZ KTADR GFHKA</code></p>
<p class="BodyCustom"><code>HTYXO ALZUP PYPVF AYMMF SDLR UVUB</code></p>
<p>This time, Thouless revealed the cipher he had used but kept the two keywords secret.</p>
<p>When he died in 1984, the solution remained unknown, and the interesting part of his experiment began. The Survival Research Foundation, an organization that studied after-death communications, offered a $1,000 reward for the correct solution to the second or third message, so long as it was provided by 1987.<sup class="endnote"><a href="b06.xhtml#c12-endnote-13" id="c12-noteref-13">13</a></sup></p>
<p>To our knowledge, nobody ever received the two keywords from the realm of the dead, and the reward was never paid. So, Thouless’s messages did not prove that the dead could communicate with the living. Or perhaps the dead simply can’t remember keywords!</p>
<p>In 1995, renowned codebreaker Jim Gillogly and his partner Larry Harnisch started a project that aimed to solve Thouless’s second and third messages. They never solved the second but did succeed in breaking the third. It should come as no surprise that, rather than using psychic powers, the partners applied codebreaking methods and a computer.</p>
<p>As a first step, their computer program attempted to decrypt the message using each entry in a file of 64,000 keyword candidates (a dictionary attack). But, of course, this trial-and-error decryption could do only half of the job, as Thouless had used two Playfairs in a row. A question remained: How could they determine whether one keyword was correct without knowing the other one?</p>
<p>Gillogly and Harnisch found two simple ways to check this. First, they used the fact that Thouless had added the same letter to the start and the end of his intermediate result. Second, they knew that the decryption they performed needed to result in another Playfair cryptogram. As mentioned, Playfair cryptograms have certain predictable properties, such as a lack of double letters. A computer program could easily check both conditions.</p>
<p>Of the 64,000 keyword candidates Gillogly and Harnisch checked, 1,385 produced a result that fulfilled both criteria (they had the same first and last letters and no identical digraphs). For each of these candidates, they applied a second Playfair decryption, testing all 64,000 keywords, which resulted in about 88 million combinations. Next, for each combination, their program checked whether the plaintext candidate looked like an English text by analyzing its trigraph frequencies.</p>
<p>After 8.5 hours of calculations, the computer program returned a potential solution. Using <code class="bold">BLACK</code> as the first keyword and <code class="bold">BEAUTY</code> as the second one, the program produced a readable English sentence. The choice of keywords sounded plausible, as Robert Thouless certainly knew Anna Sewell’s famous 1877 novel <em>Black Beauty</em>. The problem was solved:</p>
<p class="BodyCustom"><code>THIS IS A CIPHER WHICH WILL NOT BE READ UNLESS I GIVE THE KEY WORDS X</code></p>
<p><span epub:type="pagebreak" id="Page_270" title="270"/>Gillogly and Harnisch presented their solution in the scientific journal <em>Cryptologia</em>, in a 1996 paper titled “Cryptograms from the Crypt.”<sup class="endnote"><a href="b06.xhtml#c12-endnote-14" id="c12-noteref-14">14</a></sup> Unfortunately, this was too late to earn the $1,000 prize. So, Gillogly and Harnisch ended their article with this lament: “Our successful computational séance must be its own reward.”</p>
<h2 id="h1-502727c12-0007"><a class="XrefDestination" id="Challenges"/><span class="XrefDestination" id="xref-502727c12-014"/>Challenges</h2>
<h3 id="h2-502727c12-0006"><a class="XrefDestination" id="ThecryptograminNationalTreasureBookofSecrets"/><span class="XrefDestination" id="xref-502727c12-015"/>The cryptogram in National Treasure: Book of Secrets</h3>
<p class="BodyFirst">Let’s try an easy challenge. In the 2007 movie <em>National Treasure: Book of Secrets</em>, the following Playfair cryptogram appears:</p>
<p class="BodyCustom"><code>ME IK QO TX CQ TE ZX CO MW QC TE HN FB IK ME HA KR QC UN GI KM AV</code></p>
<p>The keyword is <code class="bold">DEATH</code>. Can you decrypt it?</p>
<h2 id="h1-502727c12-0008"><a class="XrefDestination" id="Unsolvedcryptograms"/><span class="XrefDestination" id="xref-502727c12-016"/>Unsolved cryptograms</h2>
<h3 id="h2-502727c12-0007"><a class="XrefDestination" id="Theworldrecorddigraphchallenge"/><span class="XrefDestination" id="xref-502727c12-017"/>The world record digraph challenge</h3>
<p class="BodyFirst">The shortest message created with a general digraph substitution that was ever broken has a length of 750 letters.<sup class="endnote"><a href="b06.xhtml#c12-endnote-15" id="c12-noteref-15">15</a></sup> We’ll cover this record in <span class="xref" itemid="xref_target_Chapter 16"><a href="c16.xhtml">Chapter 16</a></span>, when we discuss the hill-climbing method.</p>
<p>Klaus created the following shorter ciphertext, encrypted in the same way, in March 2020, to encourage his blog readers to improve the record:</p>
<p class="BodyCustom"><code>UGBZAEHINYQLBPZLNFTLUEBMULTLSLZPBZPZKPOVUGYSQPNYHL</code></p>
<p class="BodyCustom"><code>RYFHATQKRHTZEHPDQUUGYSUJOVYTUGYVRHAJNFTLUEXFRUEOOJ</code></p>
<p class="BodyCustom"><code>TZOSLUPZEICVADYMYLCRBZXOUGSVDJOIDYRHTZOSWZROYNKJRM</code></p>
<p class="BodyCustom"><code>EIXOREOVNFTLUESAMNDJHIIWJGKRYFUBTIQPULBPRMJORECJCY</code></p>
<p class="BodyCustom"><code>WZZPQRXXVNOSZLBLNYJMPLYNOVLCLKIOGUKUKFSAKAQRSVQXUJ</code></p>
<p class="BodyCustom"><code>IOANYSWZSDKUKFLNRMEIRJYVEOLXLKMEYKERHXZPBZXOZXQPCR</code></p>
<p class="BodyCustom"><code>KSYOSVHNTLIXKRYFUBTIMGWIZLOSONRMIDKYNYLCFFOMTTLLJH</code></p>
<p class="BodyCustom"><code>WTADHLYNRHMZADOGMUKBWZZPPQBZBZNOCRHINYNFTLUEYNOVBZ</code></p>
<p class="BodyCustom"><code>NOQPGCQMRHTZIDKYNYCRBZXOUGSVTTQPOSDYXOMQKKVNEALUYV</code></p>
<p class="BodyCustom"><code>RMUFPYNXZAVLRHTZNYQXMFYVUCMZSAJMBZZPXPBZMNVFUCJTNY</code></p>
<p class="BodyCustom"><code>QXGHEITPPYFWKUZFPZQUDEVLDBOMGRUEKFSCYTVNANLDRMNBYV</code></p>
<p class="BodyCustom"><code>UTFNUJMUMMEOIXIISDVNZPMNRYRCTFUGZPDNUTLXJNSSVNCRJC</code></p>
<p>Also known as the Bigram 600 challenge, this message consists of 600 letters and has (as of this writing) withstood all attempts to break it.</p>
<h3 id="h2-502727c12-0008"><a class="XrefDestination" id="TheworldrecordPlayfairchallenge"/><span class="XrefDestination" id="xref-502727c12-018"/>The world record Playfair challenge</h3>
<p class="BodyFirst">While general digraph substitution appears to protect a 600-letter plaintext quite well, as evidenced by the ciphertext in the previous section, the Playfair cipher has proven much easier to attack. As of this writing, the <span epub:type="pagebreak" id="Page_271" title="271"/>shortest Playfair cryptogram created with a random Playfair matrix (i.e., without a keyword) ever to have been solved consists of just twenty-six letters. We will cover this record in <span class="xref" itemid="xref_target_Chapter 16"><a href="c16.xhtml">Chapter 16</a></span>, when we address hill climbing. The thirty-letter Playfair ciphertext broken in 1936 by Alf Monge, which we mentioned earlier in this chapter, was based on a keyword and therefore doesn’t count in this category.</p>
<p>In January 2020, Klaus, always seeking to challenge his blog readers, published an even shorter Playfair cryptogram containing only twenty-four letters:<sup class="endnote"><a href="b06.xhtml#c12-endnote-16" id="c12-noteref-16">16</a></sup></p>
<p class="BodyCustom"><code>VYRSTKSVSDQLARMWTLRZNVUC</code></p>
<p>Can you decipher this message? If so, you may set a new record!</p>
</section>
</div></body></html>