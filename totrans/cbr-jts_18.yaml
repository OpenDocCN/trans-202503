- en: '18'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '18'
- en: Covert Communication
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 隐秘通信
- en: When a shinobi is going to communicate with the general after he has gotten
    into the enemy’s castle, the shinobi needs to let his allies know where he is.
    It is essential to arrange for the time and place to do this.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 当忍者进入敌人城堡后，若需要与将军沟通，忍者必须让他的盟友知道他的位置。安排好时间和地点来完成这一点是至关重要的。
- en: For success on a night attack, send shinobi in advance to know the details of
    the enemy’s position before you give your orders.
  id: totrans-3
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 为了夜袭成功，先派忍者前往敌方位置进行侦察，了解敌情，才能下达指令。
- en: ''
  id: totrans-4
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '—Yoshimori Hyakushu #12'
  id: totrans-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '—百首义盛 #12'
- en: Because shinobi were first and foremost experts in espionage, they had to safely
    relay secret messages containing scouting reports, attack plans, and other critical
    information to help their lords and allies make informed tactical and strategic
    decisions. Similarly, lords, generals, and other shinobi needed to covertly tell
    an infiltrated shinobi when to set a fire or execute other tactics. These messages
    had to be easily deciphered by the recipient shinobi but indiscernible to everyone
    else.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 由于忍者首先是间谍专家，他们必须安全地传递包含侦察报告、攻击计划和其他关键信息的秘密消息，以帮助他们的领主和盟友做出明智的战术和战略决策。同样，领主、将军和其他忍者也需要秘密地告知潜入的忍者何时放火或执行其他战术。这些消息必须让接收的忍者易于解码，但对其他人来说却无法辨认。
- en: The *Bansenshūkai*, *Ninpiden*, and *Gunpo Jiyoshu* scrolls all describe secret
    methods shinobi used to communicate with other shinobi, friendly armies, or their
    employers after infiltrating enemy territory. Some are brutally simple. The *Bansenshūkai*
    describes hiding a message in the belly of a fish or even inside a person (use
    your imagination) who can easily travel across borders without suspicion. Common
    choices were monks and beggars. Obfuscation techniques discussed in the same scroll
    include cutting a message into several pieces and sending each piece by a different
    courier, to be reassembled by the recipient, as well as making inks from tangerine
    juice, rusty water, sake, or castor oil that dry invisibly on paper but are revealed
    with fire. Shinobi even developed the *shinobi iroha*—a custom alphabet indecipherable
    to non-shinobi—and used fragmented words or characters to create contextual ambiguity
    that only the shinobi meant to receive the message would understand.^([1](b01.xhtml#endnote-127))
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '*万善集海*、*忍秘传*和*军法事要集*卷轴都描述了忍者用来与其他忍者、友军或雇主在潜入敌方领土后进行沟通的秘密方法。有些方法极其简单。*万善集海*描述了将消息隐藏在鱼肚子里，甚至藏在人体内（请发挥你的想象力），这些“携带者”可以轻松穿越边境而不引起怀疑。常见的选择有僧侣和乞丐。同一卷轴中讨论的伪装技巧包括将信息切割成几块，并通过不同的信使发送每一块，接收者将其重新拼接，以及用橘子汁、铁锈水、清酒或蓖麻油制作的墨水，这些墨水在纸上干后不可见，但通过火焰可以显现。忍者甚至开发了*忍者五十音*——一种非忍者无法破译的自定义字母表，并通过碎片化的词语或字符创造出只有目标接收者才能理解的上下文模糊性。^([1](b01.xhtml#endnote-127))'
- en: A popular—and direct—method of sending secret messages was *yabumi*, wherein
    what appears to be a normal arrow actually has a secret scroll rolled around the
    bamboo shaft, along with marks on the fletching to identify the recipient. Given
    the logistical realities of feudal Japan, shinobi could not always guarantee that
    they could fire a *yabumi* arrow at a prearranged time and place, so they developed
    an arrow “handshake” that, to an outsider, might have looked like a skirmish.
    If one side saw a specific number of arrows shot rapidly at the same spot, they
    returned fire with a specific number of arrows aimed to land in front of the shooter.
    This signal and countersignal established a friendly connection. The shinobi could
    then shoot the *yabumi* arrow, which would be picked up and delivered to the intended
    target.^([2](b01.xhtml#endnote-128)) This method of communication became so common
    that the *Gunpo Jiyoshu* manual warns that the enemy may send deceptive letters
    by arrow; thus, the recipient should closely examine *yabumi* messages using some
    of the linguistic techniques described earlier in this book.^([3](b01.xhtml#endnote-129))
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 一种流行的——且直接的方法——是发送秘密信息的*耶布米*，其方式是看似正常的箭矢，其实箭杆上卷有一卷秘密卷轴，并且箭羽上有标记，以识别接收者。考虑到封建日本的物流现实，忍者不能总是确保能够在预定的时间和地点射出*耶布米*箭，因此他们发明了一种箭矢“握手”信号，对外人来说，这可能看起来像是一次小规模冲突。如果一方看到特定数量的箭矢迅速射向同一位置，他们则回射一定数量的箭矢，目标是落在射手的前方。这个信号和反信号建立了友好联系。忍者随后可以射出*耶布米*箭，箭矢会被捡起并送达预定目标。^([2](b01.xhtml#endnote-128))
    这种通讯方法变得如此普遍，以至于《军法事要书》警告敌人可能通过箭矢发送欺骗性信件；因此，接收者应使用本书前面描述的语言技巧仔细检查*yabumi*消息。^([3](b01.xhtml#endnote-129))
- en: For long-distance signaling or when sending a scroll wasn’t feasible, shinobi
    devised flag, fire, smoke, and lamp signals (*hikyakubi*). When even these were
    not possible, they employed secret drums, gongs, and conches. A loud, unique blast
    of the signaling device told the shinobi inside enemy lines to prepare to receive
    a secret communication. The exact signal pattern was agreed upon one to six days
    before infiltration to avoid confusion. After the initial *hikyakubi* signal,
    the message was delivered through drum, gong, or conch signals.^([4](b01.xhtml#endnote-130))
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 对于长距离信号传递或当发送卷轴不可行时，忍者设计了旗帜、火焰、烟雾和灯光信号（*hikyakubi*）。当这些方法都不可行时，他们使用了秘密的鼓声、锣声和海螺声。一声响亮、独特的信号装置爆炸声告诉忍者准备接收秘密通讯。这种信号模式在渗透前的1到6天内达成一致，以避免混淆。在初始的*hikyakubi*信号之后，消息通过鼓、锣或海螺信号传递。^([4](b01.xhtml#endnote-130))
- en: In this chapter, we will look at how the covert communication methods of the
    shinobi closely resemble modern malware command and control communication. We
    will discuss why command and control communications are needed and their role
    in threat activity. We’ll touch on various techniques that modern adversaries
    have used to covertly conduct this communication. We will also explore various
    defenses against this technique and the challenges of using it. Lastly, we’ll
    list a large collection of security best practices to defend against command and
    control communications. The fact that the shinobi scrolls offer no guidance around
    how to stop covert communication suggests there may not be a good solution for
    it.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将探讨忍者的隐秘通讯方法如何与现代恶意软件的指挥与控制通讯非常相似。我们将讨论为何指挥与控制通讯是必需的，以及它们在威胁活动中的作用。我们将简要讨论现代对手用于隐秘进行这种通讯的各种技术。我们还将探索针对这种技术的各种防御措施以及使用它的挑战。最后，我们将列出一大批安全最佳实践，用以防范指挥与控制通讯。忍者卷轴未提供如何阻止隐秘通讯的指导，这表明可能没有有效的解决方案。
- en: Command and Control Communication
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 指挥与控制通讯
- en: It is typically not feasible for malware to be wholly independent and autonomous.
    If it were, the malware would be exceedingly large, complex, suspicious, and visible
    to defenders. Rather, most malware needs tactical guidance from its controllers
    during a threat campaign, so threat actors use a technique called *command and
    control* (abbreviated as C2, CnC, or C&C) to communicate with malware, backdoors,
    implants, and compromised systems under their control in target networks. Operators
    use C2 communication to send commands to a compromised system, prompting it to
    execute actions such as downloading data, updating its configuration, or even
    deleting itself. The C2 implant can also initiate communication by sending statistics
    or valuable files, asking for new commands, or beaconing back to report that the
    system is online, along with its location and current status. Cyber threat actors
    often establish C2 infrastructure such as domain names, IPs, and websites one
    to six weeks prior to infiltration.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件通常无法完全独立和自主。如果能做到这一点，恶意软件将异常庞大、复杂、可疑，并且容易被防御者发现。实际上，大多数恶意软件在威胁活动期间需要来自其控制者的战术指导，因此，威胁行为者使用一种称为*命令与控制*（缩写为C2、CnC或C&C）的方法与恶意软件、后门、植入物和受控系统进行通信。操作员通过C2通信向受损系统发送命令，促使其执行诸如下载数据、更新配置甚至自我删除等操作。C2植入物还可以通过发送统计数据或有价值的文件、请求新命令，或者回报系统在线的状态以及位置和当前状态来发起通信。网络威胁行为者通常在渗透前一至六周建立C2基础设施，例如域名、IP和网站。
- en: C2 functionality is widely known, and many firewalls, IDS/IPS, and other security
    devices and controls can prevent adversaries from communicating directly to target
    systems or vice versa. To bypass these controls, threat actors continually develop
    more advanced C2 techniques, tactics, and procedures (TTPs). For example, C2 data
    can be embedded in the payload of a ping or in commands hidden in pictures hosted
    on public websites. Adversaries have used C2 in Twitter feeds and comments on
    trusted sites. They have also used C2 to establish proxies and email relays on
    compromised systems; they then communicate over known protocols and safe sites
    that are not blocked by security controls and devices. Phones plugged into compromised
    systems can be infected with malware that, upon USB connection, “calls” the C2
    via cell phone towers, bypassing firewalls and other network defenses and facilitating
    communication between the infected host and the C2 while the phone’s battery charges.
    Some C2 communication methods use blinking LEDs (like a signal fire), vary CPU
    temperature (like a smoke signal), use the sounds of hard drives or PC speakers
    (like signal drums), and leverage electromagnetic spectrum waves to bypass the
    air gap to a nearby machine.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: C2功能广为人知，许多防火墙、IDS/IPS和其他安全设备与控制措施能够阻止对手直接与目标系统通信或相反。为了绕过这些控制，威胁行为者不断开发更先进的C2技术、战术和程序（TTPs）。例如，C2数据可以嵌入到ping负载中，或者隐藏在托管在公共网站上的图片中的命令里。对手曾经在Twitter动态和受信网站的评论中使用C2。他们还通过C2在受损系统上建立代理和电子邮件中继；然后，他们通过已知的协议和安全网站进行通信，这些网站未被安全控制和设备阻止。插入受损系统的手机可能会感染恶意软件，该恶意软件在USB连接时通过手机塔“呼叫”C2，从而绕过防火墙和其他网络防御，并在手机充电时促进感染主机与C2之间的通信。一些C2通信方法使用闪烁的LED灯（像信号火炬）、变化的CPU温度（像烟雾信号）、硬盘或PC扬声器的声音（像信号鼓）以及利用电磁波谱来绕过空气隔离与附近机器进行通信。
- en: 'Threat actors layer C2 communications with obfuscation, encryption, and other
    confidentiality techniques to maintain contact with a compromised system without
    disclosing evidence of the commands to the victims. Adversaries may avoid detection
    by:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁行为者通过混淆、加密和其他保密技术对C2通信进行层叠，以便在不透露命令证据的情况下与受损系统保持联系。对手可能通过以下方式避免被检测：
- en: Limiting the amount of data that is communicated on a daily basis so the daily
    amount never seems anomalous (for example, 100MB max per day to mask downloading
    1.5TB over two weeks)
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 限制每天传输的数据量，使得每日传输量看起来不异常（例如，每天最多100MB，以掩盖在两周内下载1.5TB）
- en: Sending or receiving beacons only during active user time to blend in with legitimate
    user traffic (for example, not beaconing very often in the small hours of the
    morning on a Sunday or holiday)
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 仅在活跃用户时间发送或接收信标，以便与合法用户流量混合（例如，不在周日或假日的清晨频繁发送信标）
- en: Rotating to new, random, or dynamic C2 points to avoid statistical anomalies
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定期切换到新的、随机的或动态的C2点，以避免统计异常
- en: Regularly generating pseudo-legitimate traffic to avoid scrutiny from behavior
    analysis
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定期生成伪合法流量以避免行为分析的审查
- en: Disabling or deleting activity logs to hide from forensics
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 禁用或删除活动日志，以避免取证分析
- en: Advanced C2 TTPs can be particularly sinister, virtually undetectable, and hard
    to block. Consider the example of a Windows IT admin who has implemented such
    strict firewall controls that the only site they can visit is *technet.microsoft.com*,
    the official Microsoft web portal for IT professionals. Only the HTTPS protocol
    is allowed, antivirus is current and running, and the operating system is fully
    patched. No external programs such as email, Skype, or iTunes are running, with
    the exception of the Microsoft TechNet website, which the admin needs to do their
    job. That may sound secure, but consider that Chinese APT17 (also called Deputy
    Dog or Aurora Panda) encoded hidden IP addresses in comments posted on Microsoft
    TechNet pages—comments that communicated with a BLACKCOFFEE remote access trojan
    on a compromised system.^([5](b01.xhtml#endnote-131)) If anyone had inspected
    proxy traffic, behavior analysis, anomaly heuristics, IDS signatures, antivirus,
    or firewall alerts, nothing notable would have indicated that malicious communications
    were happening.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 高级C2（指挥与控制）战术、技术和程序（TTPs）可能特别危险，几乎无法被检测到，也很难阻止。考虑一下一个Windows IT管理员的例子，他们已经实施了如此严格的防火墙控制，以至于唯一能访问的站点是*technet.microsoft.com*，这是微软为IT专业人员提供的官方技术门户网站。仅允许HTTPS协议，防病毒软件已更新并在运行，操作系统也已经完全打上补丁。没有外部程序，如电子邮件、Skype或iTunes在运行，只有管理员需要使用的微软TechNet网站。听起来这似乎很安全，但要考虑到中国APT17（也被称为Deputy
    Dog或Aurora Panda）将隐藏的IP地址编码在发布在微软TechNet页面上的评论中——这些评论与一个名为BLACKCOFFEE的远程访问木马通信，后者驻留在被攻陷的系统中。^([5](b01.xhtml#endnote-131))
    如果有人检查了代理流量、行为分析、异常启发式、IDS签名、防病毒软件或防火墙警报，什么显著的迹象都不会表明恶意通信正在发生。
- en: Advanced defense efforts to counter sophisticated C2s typically involve air
    gapping the systems, but new C2 communication techniques have been developed in
    recent years. One example is using a USB loaded with rootkits or compromised firmware
    and malware that, once plugged into a system, initiate communications with the
    implant on the compromised system, collect the packaged data, and discreetly upload
    it for exfiltration to an external C2\.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 针对复杂的C2的高级防御工作通常包括将系统与外界隔离（空气隔离），但近年来，新的C2通信技术已经得到发展。一个例子是使用带有rootkit或被攻陷固件和恶意软件的USB设备，一旦插入系统，就会与被攻陷系统上的植入物进行通信，收集打包的数据，并巧妙地上传以便外泄到外部C2服务器。
- en: Controlling Coms
  id: totrans-22
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 控制通信
- en: It is common for organizations to subscribe to multiple threat indicator feeds.
    These feeds continually supply the organization with malicious URLs, IPs, and
    domains that have been observed working as C2s. The organization will then alert
    and/or block those threats in their firewalls and security devices. This is a
    good starting point for defending against C2s, but there is an endless supply
    of new URLs, IPs, and domains, allowing threat actors to take up new identities
    and evade the threat indicator feeds. Both old and new approaches are needed to
    address C2s, some of which are suggested below.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 许多组织通常订阅多个威胁指标源，这些源不断提供恶意的URL、IP地址和域名，这些地址和域名被观察到作为C2服务器工作。然后，组织会在其防火墙和安全设备中发出警报和/或阻止这些威胁。这是防御C2的一种良好起点，但新URL、IP和域名的源源不断地出现，使得威胁行为者可以采用新的身份并避开威胁指标源。因此，需要采取新旧方法来应对C2，其中一些方法如下所示。
- en: '*Follow best practices.* While it may be impractical or even impossible to
    prevent all C2 communications, you can block basic or moderately advanced C2s
    by implementing cybersecurity best practices: know your network, set boundary
    and flow controls, establish whitelists, and authorize hunt teams to proactively
    block or intercept C2 communications. Do not take shortcuts on best practices.
    Rather, commit to doing solid security work. Document, test, and validate your
    best practices and consult with independent third-party assessors for additional
    measures and validation. Invest in improving security while maintaining and bettering
    your existing best-practice infrastructure.'
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*遵循最佳实践。* 虽然完全阻止所有C2通信可能不切实际，甚至是不可能的，但通过实施网络安全最佳实践，你可以阻止基础或中级的C2。具体来说，了解你的网络、设置边界和流量控制、建立白名单并授权猎杀小组主动阻止或拦截C2通信。不要在最佳实践上走捷径，而是要致力于做扎实的安全工作。记录、测试和验证你的最佳实践，并请独立的第三方评估人员提供额外的措施和验证。投资于提升安全性，同时保持并改善你现有的最佳实践基础设施。'
- en: '*Implement segmentation with “remote viewing” controls.* Network segmentation
    and isolation means establishing multiple networks and machines, such as an intranet
    machine and an unclassified internet machine that are segmented from each other.
    Segmentation should prevent C2 communication from bridging across boundaries.
    Unfortunately, it’s common for users to briefly plug their intranet machine into
    the internet to download documents or libraries or commit some other breach of
    security protocol. One approach to such issues is to configure the intranet machine
    so it remotely views another isolated machine that is connected to the internet.
    The isolated internet box is not physically or directly accessible by users; they
    may issue commands and view the screen, but they do not receive the actual raw
    information from the isolated internet box in their remote viewing box. The remote
    viewing box is effectively a TV monitor displaying another computer in a different
    room. As such, C2 communication, malware, and exploits cannot jump through the
    video signal to cause harm.'
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*实施带有“远程查看”控制的分段策略。* 网络分段和隔离意味着建立多个网络和机器，例如内联网机器和一个与之隔离的非机密互联网机器。分段应防止C2通信跨越边界。遗憾的是，用户通常会将其内联网机器临时接入互联网以下载文档或库，或者进行其他安全协议的违规行为。解决此类问题的一种方法是配置内联网机器，使其远程查看另一台连接到互联网的隔离机器。该隔离的互联网机器对用户既不可物理访问，也不可直接访问；他们只能发出命令并查看屏幕，但无法从隔离的互联网机器中接收到实际的原始信息。远程查看机器实际上就像一台显示另一台计算机的电视监视器。因此，C2通信、恶意软件和漏洞无法通过视频信号跳跃进入造成损害。'
- en: Recommended Security Controls and Mitigations
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 推荐的安全控制和缓解措施
- en: Where relevant, recommendations are presented with applicable security controls
    from the NIST 800-53 standard. Each should be evaluated with the concept of C2s
    in mind.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在相关情况下，提出的建议将与NIST 800-53标准中的适用安全控制一起呈现。每项建议都应考虑C2的概念进行评估。
- en: 'Implement safeguards on systems, network boundaries, and network egress points
    that look for signs of data exfiltration on your network. This could mean blocking
    encrypted tunnels that your sensors cannot intercept, along with looking for evidence
    of unauthorized protocols, data formats, data watermarks, sensitive data labels,
    and large files or streams exiting your network. [AC-4: Information Flow Enforcement
    | (4) Content Check Encrypted Information; SC-7: Boundary Protection | (10) Prevent
    Exfiltration; SI-4: System Monitoring | (10) Visibility of Encrypted Communications]'
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '在系统、网络边界和网络出口点实施保护措施，寻找网络中数据外泄的迹象。这可能意味着阻止加密隧道，防止您的传感器无法拦截，同时还要寻找未经授权的协议、数据格式、水印、敏感数据标签以及离开您网络的大文件或数据流的证据。
    [AC-4: 信息流控制 | (4) 内容检查加密信息；SC-7: 边界保护 | (10) 防止数据外泄；SI-4: 系统监控 | (10) 加密通信的可见性]'
- en: 'Establish multiple networks with isolation and segmentation between internet
    and intranet resources. Restrict critical internal systems from connecting to
    the internet. [AC-4: Information Flow Enforcement | (21) Physical and Logical
    Separation of Information Flows; CA-3: System Interconnections | (1) Unclassified
    National Security System Connections | (2) Classified National Security System
    Connections | (5) Restrictions on External System Connections; SC-7: Boundary
    Protection | (1) Physically Separated Subnetworks | (11) Restrict Incoming Communications
    Traffic | (22) Separate Subnets for Connecting to Different Security Domains]'
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '建立多个网络，并在互联网与内联网资源之间进行隔离和分段。限制关键内部系统与互联网的连接。 [AC-4: 信息流控制 | (21) 信息流的物理与逻辑分隔；CA-3:
    系统互联 | (1) 非机密国家安全系统连接 | (2) 机密国家安全系统连接 | (5) 限制外部系统连接；SC-7: 边界保护 | (1) 物理隔离子网
    | (11) 限制进入通信流量 | (22) 用于连接不同安全域的子网]'
- en: 'Restrict remote access to any systems with critical information. [AC-17: Remote
    Access]'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '限制对任何包含关键信息的系统的远程访问。 [AC-17: 远程访问]'
- en: 'Implement restrictions and configuration controls to detect and prevent unauthorized
    wireless communications. [AC-18: Wireless Access | (2) Monitoring Unauthorized
    Connections; PE-19: Information Leakage; SC-31: Covert Channel Analysis; SC-40:
    Wireless Link Protection; SI-4: System Monitoring | (15) Wireless to Wireline
    Communications]'
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '实施限制和配置控制，以检测和防止未经授权的无线通信。 [AC-18: 无线访问 | (2) 监控未经授权的连接；PE-19: 信息泄漏；SC-31:
    隐蔽通道分析；SC-40: 无线链路保护；SI-4: 系统监控 | (15) 无线到有线通信]'
- en: 'Train your security team and employees to identify C2 communications. [AT-3:
    Role-based Training | (4) Suspicious Communications and Anomalous System Behavior;
    SI-4: System Monitoring | (11) Analyze Communications Traffic Anomalies | (13)
    Analyze Traffic and Event Patterns | (18) Analyze Traffic and Covert Exfiltration]'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '训练你的安全团队和员工识别C2通信。[AT-3: 基于角色的培训 | (4) 可疑通信和异常系统行为；SI-4: 系统监控 | (11) 分析通信流量异常
    | (13) 分析流量和事件模式 | (18) 分析流量和隐蔽外泄]'
- en: 'Deny any unauthorized software that could be a C2 backdoor or implant from
    running on your systems. [CM-7: Least Functionality | (5) Authorized Software–Whitelisting]'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '阻止任何未经授权的软件在你的系统上运行，这些软件可能是C2后门或植入物。[CM-7: 最小功能 | (5) 授权软件–白名单]'
- en: 'Safeguard direct physical connections to systems that bypass security controls
    and boundaries; these include switch closets, Ethernet wall jacks, and computer
    interfaces. [PE-6: Monitoring Physical Access; SC-7: Boundary Protection | (14)
    Protects Against Unauthorized Physical Connections | (19) Block communication
    from non-organizationally configured hosts]'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '保护绕过安全控制和边界的直接物理连接到系统；这些包括交换机机柜、以太网墙插座和计算机接口。[PE-6: 监控物理访问；SC-7: 边界保护 | (14)
    防止未经授权的物理连接 | (19) 阻止来自非组织配置主机的通信]'
- en: 'Require inspection and scanning of removable media that enters or leaves your
    organization to prevent personnel from manually performing C2 communication through
    delivery and removal of external media. [PE-16: Delivery and Removal]'
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '要求检查和扫描进入或离开贵组织的可移动媒体，以防止员工通过交付和移除外部媒体手动执行C2通信。[PE-16: 交付和移除]'
- en: 'Implement a whitelist to deny communication to any resource or address that
    has not been approved for an exception. Many C2 sites are brand-new domains with
    no history of legitimate use by your organization. [SC-7: Boundary Protection
    | (5) Deny by Default—Allow by Exception]'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '实施白名单，以拒绝与任何未获批准作为例外的资源或地址的通信。许多C2站点是全新的域名，贵组织没有合法使用的历史。[SC-7: 边界保护 | (5) 默认拒绝—例外允许]'
- en: Debrief
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 汇报
- en: In this chapter, we reviewed the various communication methods shinobi used
    to receive and send commands to allies. We described various modern C2 methods,
    along with their comparative shinobi methods. However, we only scratched the surface,
    as it’s very likely that the most sophisticated C2 techniques have yet to be discovered.
    Just like the best of the shinobi’s covert communication methods were never written
    down, we may never learn of the genius and creativity behind the most advanced
    C2 techniques. We discussed several best practices, including whitelisting and
    encryption inspection, as ways to mitigate an adversary’s C2s, but an ideal solution
    to the problem remains to be found.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们回顾了忍者用来接收和发送命令给盟友的各种通信方法。我们描述了各种现代C2方法及其对应的忍者方法。然而，我们仅仅触及了表面，因为最复杂的C2技术可能尚未被发现。就像忍者最好的隐蔽通信方法从未被记录下来一样，我们可能永远无法了解最先进C2技术背后的天才和创造力。我们讨论了几种最佳实践，包括白名单和加密检查，作为减轻对手C2的方式，但这一问题的理想解决方案仍待发现。
- en: In the next chapter, we will discuss shinobi call signs. These were methods
    of communicating with allies inside enemy territory by leaving unique marks or
    messages. Similar to a dead drop, call signs never leave the boundaries of an
    environment, so traditional methods of blocking or detecting C2 communication
    generally do not work against them.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章，我们将讨论忍者的呼号。这些是通过留下独特的标记或信息与盟友在敌方领土内进行通信的方法。类似于死信箱，呼号从不超出环境边界，因此传统的C2通信阻止或检测方法通常无法对其起作用。
