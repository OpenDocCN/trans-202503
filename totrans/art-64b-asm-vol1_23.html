<html><head></head><body>
<section><header>
<h1 class="Appendix"><span class="AppendixNumber"><span epub:type="pagebreak" title="925" id="Page_925"/>D</span><br/>
<span class="AppendixTitle">The Windows Command Line Interpreter</span></h1>
</header>
<figure class="opener">
<img src="image_fi/book_art/chapterart.png" alt=""/>
</figure>
<p class="ChapterIntro">Microsoft’s MASM is (mostly) a tool that you use from the Windows command line. Therefore, to use MASM properly (at least with respect to all the examples in this book), you will need to be comfortable using the Windows command line interpreter (CLI). </p>
<p><span class="xref" itemid="xref_target_Appendix C">Appendix C</span> shows how to set up the Windows CLI so you can use it. This appendix briefly describes some common commands you will use in the CLI.</p>
<h2 id="h1-501089b04-0001">	D.1	Command Line Syntax</h2>
<p class="BodyFirst">A basic Windows CLI command takes the form</p>
<pre><code><var>command options </var></code></pre>
<p class="BodyContinued"><span epub:type="pagebreak" title="926" id="Page_926"/>where <var>command</var> is either a built-in CLI command, an executable program on disk (typically having an <em>.exe</em> filename suffix), or a batch filename (with a <em>.bat</em> suffix), and <var>options</var> is a list of zero or more options for the command. The options are command-specific.</p>
<p>Probably the most common example in this book of an executable program you would run from the command line is the <em>ml64.exe</em> program (the MASM assembler). The Microsoft linker (<em>link.exe</em>), librarian (<em>lib.exe</em>), nmake (<em>nmake.exe</em>), and the MSVC compiler (<em>cl.exe</em>) are also examples of executable programs you might run from the command line. </p>
<p>All of the sample programs appearing in this book are also examples of commands you could run from the command line. For example, the following command executes the <em>build.bat</em> batch file to build the <em>listing2-1.exe</em> executable file (from <span class="xref" itemid="xref_target_Chapter 2">Chapter 2</span>):</p>
<pre><code>build listing2-1</code></pre>
<p>Immediately after building the <em>listing2-1.exe</em> executable file, you can run it from the command line. Here’s the command and the output it produces:</p>
<pre><code>C:\&gt;<b>listing2-1</b>
Calling Listing 2-1:
i=1, converted to hex=1
j=123, converted to hex=7b
k=456789, converted to hex=6f855
Listing 2-1 terminated</code></pre>
<p>The <em>listing2-1.exe</em> executable file doesn’t support any command line options. If you type anything after the <code>listing2-1</code> command on the command line, the <em>listing2-1.exe</em> program will ignore that text.</p>
<p>Although most options are command-specific, you can apply certain command line options to most programs you run from the command line: specifically, <em>I/O redirection</em>. Many console applications write data to the <em>standard output device </em>(the console window). All of the <code>print</code> and <code>printf</code> function calls appearing throughout this book, for example, write their data to the standard output device. Normally, all output sent to the standard output device appears as text written to the command line (console) window. </p>
<p>However, you can tell Windows to send this data to a file (or even another device) by using an <em>output redirection option</em>. The output redirection option takes the form</p>
<pre><code><var>command options </var>&gt;<var>filename more_options</var></code></pre>
<p class="BodyContinued">where <var>command</var> is the command name, <var>options</var> and <var>more_options</var> are zero or more command line options (not containing an output redirection option), and <var>filename</var> is the name of the file where you would like to have the output from <var>command</var> sent. Consider the following command line:</p>
<pre><code>listing2-1 &gt;listing2-1.txt</code></pre>
<p><span epub:type="pagebreak" title="927" id="Page_927"/>Executing this command produces no output to the display. However, you will discover that this command creates a new text file on the disk. That text file will contain the output from the <em>listing2-1.exe</em> program (given earlier).</p>
<p>The Windows CLI also supports <em>standard input redirection</em> using the syntax</p>
<pre><code><var>command options </var>&lt;<var>filename more_options</var></code></pre>
<p class="BodyContinued">where <var>command</var> is the command name, <var>options</var> and <var>more_options</var> are zero or more command line options (not containing an input redirection option), and <var>filename</var> is the name of the file from which <var>command</var> will read its input. </p>
<p>Input redirection causes a program that would normally read data from the user (at the keyboard, which is the standard input device) to instead read the data from a text file. For example, suppose you executed the <code>listing2-1</code> command given earlier and redirected the output to the <em>listing2-1.txt</em> output file. Consider the following command (from <span class="xref" itemid="xref_target_Chapter 1">Chapter 1</span>) that reads a line of text from the user (in this particular example, I typed <code class="bold">hello</code> in response to the program’s request for input):</p>
<pre><code>C:\&gt;<b>build listing1-8</b>
C:\&gt;<b>echo off</b>
 Assembling: listing1-8.asm
c.cpp
C:\&gt;<b>listing1-8</b>
Calling Listing 1-8:
Enter a string: <b>hello</b>
User entered: 'hello'
Listing 1-8 terminated</code></pre>
<p>Now consider the following command:</p>
<pre><code>C:\&gt;<b>listing1-8 &lt;listing2-1.txt</b>
Calling Listing 1-8:
Enter a string: User entered: 'Calling Listing 2-1:'
Listing 1-8 terminated</code></pre>
<p>In this example, the input is redirected from the <em>listing2-1.txt</em> file produced by the earlier execution of <em>listing2-1.exe</em>. The <em>listing1-8.exe</em> program reads the first line of that file as input (rather than reading a line of text from the keyboard). The program doesn’t echo the text read from the file (including the newline character); this is why the <code>User entered: 'Calling Listing 2-1:'</code> text appears on the same line as the <code>Enter a string:</code> prompt. When actually reading data from the keyboard, the system echoes the data to the display (including the newline character). This doesn’t happen when redirecting the input from a file. </p>
<p>The file contains several lines of text. However, <em>listing1-8.exe</em> reads only one line of text, so it ignores the remaining lines in the <em>listing2-1.txt</em> file.</p>
<p><span epub:type="pagebreak" title="928" id="Page_928"/>You can redirect both the standard input and the standard output on the same command. Consider the following:</p>
<pre><code>C:\&gt;listing1-8 &lt;listing2-1.txt &gt;listing1-8.txt</code></pre>
<p>This reads the data from the <em>listing2-1.txt</em> file and sends all the output to the <em>listing1-8.txt</em> file.</p>
<p>When redirecting the output from a program to a text file, if the output file already exists, Windows will delete that file prior to writing the standard output text to that file. You can also instruct Windows to append the output from the command to the existing file by using the following output redirection syntax (using two greater-than symbols):</p>
<pre><code><var>command options </var>&gt;&gt;<var>filename more_options</var></code></pre>
<p>Command line options other than the redirection options are usually filenames (for example, <code>ml64 mySource.asm</code>) or options that control the command’s behavior (such as ml64’s <code>/c</code> or <code>/Fl</code> command line options you’ll find used throughout this book). By convention, most Windows CLI commands use a slash character (<code>/</code>) as a prefix before actual options (as opposed to filenames). This is a convention, not a hard requirement. </p>
<p>Some commands, for example, use the Unix convention of a dash or hyphen character (<code>-</code>) instead of (or in addition to) the slash character. It’s really an application-specific choice. See the documentation for the particular program you are using for the details. All the built-in CLI commands, and most Microsoft CLI programs, use the slash character to designate options.</p>
<h2 id="h1-501089b04-0002">	D.2	Directory Names and Drive Letters</h2>
<p class="BodyFirst">Many commands accept or require a file or directory pathname as a command line option. Pathnames consist of two major components: a drive letter and the directory or file pathname. A drive letter is a single alphabetic character (A to Z) followed by a colon; for example:</p>
<pre><code>A: B: C: etc.</code></pre>
<p>Drive letters are not case-sensitive. <code>A:</code> is equivalent to <code>a:</code> on the command line. Windows reserves drive letters A: and B: for floppy drives. As you don’t often see floppy disk drives on modern machines, you won’t likely use these drive letters. However, if you have a really old machine . . .</p>
<p>C: is the default drive letter for the boot drive. If you have only one hard drive (or SSD) in your machine, Windows will probably associate C: with that drive. The examples appearing throughout this book assume you’re operating on drive C: (though this is by no means a requirement).</p>
<p>If you have multiple drives (either multiple physical drive units, or you’ve partitioned your hard drive into multiple logical drives), Windows <span epub:type="pagebreak" title="929" id="Page_929"/>usually associates consecutive drive letters (D:, E:, and so forth) with these additional drives. You can reassign drive letters, if you like, so there is no guarantee that all drive letters will be contiguous in the alphabet.</p>
<p>You can switch the default drive letter by typing the letter and a colon, by themselves, on the command line. For example,</p>
<pre><code>D:</code></pre>
<p class="BodyContinued">switches the default drive to D:, assuming such a drive exists. If the drive does not exist, Windows will complain that the system cannot find the specified drive and will not change the default drive.</p>
<p>Normally (you can change this), Windows displays the current drive letter as part of the command line prompt (by default, it displays the default pathname as well). For example, a typical Windows command line prompt looks like this:</p>
<pre><code>C:\&gt;</code></pre>
<p>The <code>\</code> character appearing in the command prompt is the current (default) directory. In this case, <code>\</code> by itself indicates the root (or main) directory on the C: drive. Had the current directory been something else, Windows would have listed that after the drive letter. For example, had the current directory been <code>\WINDOWS</code>, the CLI would have displayed the following as the command line prompt:</p>
<pre><code>C:\WINDOWS&gt;</code></pre>
<p>Windows, as you’re probably aware, has a hierarchical filesystem, allowing subdirectories inside (sub)directories. The backslash character separates directory names in a full pathname. You’ll commonly see two pathname forms in Windows: full pathnames and partial pathnames<em>. </em></p>
<p><em>Full pathnames</em> begin with a backslash (<code>\</code>) character and start from the root directory. <em>Partial pathnames</em> do not begin with a backslash, and the path begins with the current (default) directory (the first subdirectory in the partial pathname must appear in the current default subdirectory).</p>
<p>Spaces normally separate options on a command line. If a space appears in a pathname, you must surround the entire pathname with quotes; for example:</p>
<pre><code>"\This\Path name\has\a\space"</code></pre>
<p>The CLI supports a pair of <em>wildcard</em> characters in pathnames. The asterisk character (<code>*</code>) will match zero or more characters. The question mark character (<code>?</code>) will match zero or one character. </p>
<p>A command must explicitly support wildcard characters; the Windows CLI commands support wildcard options, as do most Microsoft tools (for example, <em>ml64.exe</em>). Not all executable files support wildcards in filenames, <span epub:type="pagebreak" title="930" id="Page_930"/>however. Wildcard characters are usable in directory names as well as filenames. They will not, however, replace the backslash character (<code>\</code>) in a pathname.</p>
<h2 id="h1-501089b04-0003">	D.3	Some Useful Built-in Commands</h2>
<p class="BodyFirst">The Windows CLI contains many built-in commands (commands that are part of the <em>cmd.exe</em> program and don’t require a separate <em>.exe</em> or <em>.bat</em> file). There are far too many built-in commands to consider here (and you wouldn’t use most of them); therefore, this section presents just a handful of the most commonly used commands.</p>
<h3 id="h2-501089b04-0001">D.3.1	The cd and chdir Commands</h3>
<p class="BodyFirst">The <code>cd</code> (<em>change directory</em>) command switches the default directory to the directory you specify as the command line option. Note that <code>chdir</code> is a synonym for <code>cd</code>. Its syntax is</p>
<pre><code>cd <var>directory_name</var></code></pre>
<p class="BodyContinued">where <var>directory_name</var> is a full or partial pathname to the new directory. For example:</p>
<pre><code>cd \masm32\examples</code></pre>
<p>The <code>cd</code> command does not normally change the default drive letter, even if you specify it as part of the pathname. For example, if the current drive letter is D:, the following command will not directly change the default drive letter and pathname:</p>
<pre><code>D:\&gt;cd C:\masm32\examples
D:\&gt;</code></pre>
<p>Notice that the command prompt remains <code>D:\&gt;</code> after the <code>cd</code> command. However, if you switch to the C: drive (using the <code>C:</code> command), Windows will set the default directory as per the previous command:</p>
<pre><code>D:&gt;C:
C:\masm32\examples&gt;</code></pre>
<p>As you can see, the default directory is associated with a drive letter (and each drive letter maintains its own default directory).</p>
<p>If you want to switch both the drive letter and the pathname with the <code>cd</code> command, just supply the <code>/d</code> option before the pathname:</p>
<pre><code>D:\&gt;cd /d C:\masm32\examples
C:\masm32\examples</code></pre>
<p><span epub:type="pagebreak" title="931" id="Page_931"/>Don’t forget that if a pathname contains spaces, you must enclose the pathname in quotes when using the <code>cd</code> command:</p>
<pre><code>cd /d "C:\program files"</code></pre>
<p>The following displays help information about the <code>cd</code> command:</p>
<pre><code>cd /?</code></pre>
<p>If you issue the <code>cd</code> command by itself (no command line arguments), this command displays the current (default) pathname.</p>
<h3 id="h2-501089b04-0002">D.3.2	The cls Command</h3>
<p class="BodyFirst">The <code>cls</code> command clears the screen (at least, the command window). This is useful when you want to clear the screen prior to a compilation and want to see only the messages associated with that particular compilation when scrolling back through the command window.</p>
<h3 id="h2-501089b04-0003">D.3.3	The copy Command</h3>
<p class="BodyFirst">The <code>copy</code> command copies one or more files to a different location. Typically, you use this command to make backup copies of a file in the current directory or to make a copy of a file into a different subdirectory. The syntax for this command is as follows:</p>
<pre><code>copy <var>source_filename destination_filename</var></code></pre>
<p>This command duplicates the file specified by <var>source_filename</var> and names that duplicate <var>destination_filename</var>. Both names can be full or partial pathnames.</p>
<p>The <code>copy</code> command supports several command line options (in addition to the source and destination filenames). You probably won’t use those options very often. For more details, issue the following help command:</p>
<pre><code>copy /?</code></pre>
<h3 id="h2-501089b04-0004">D.3.4	The date Command</h3>
<p class="BodyFirst">The <code>date</code> command, by itself, displays the current system date and prompts you to enter a new date (which will permanently set the system date—so be careful using this!). With a <code>/t</code> command line option, this command will only display the date and not ask you to change it. Here’s an example:</p>
<pre><code>C:\&gt;date /t
Sat 02/23/2019</code></pre>
<p>As usual, <code>date /?</code> displays the help information for this command.</p>
<h3 id="h2-501089b04-0005"><span epub:type="pagebreak" title="932" id="Page_932"/>D.3.5	The del (erase) Command</h3>
<p class="BodyFirst">The <code>del</code> command (<code>erase</code> is a synonym for <code>del</code>) will delete the file(s) you specify as the command line options. The syntax is</p>
<pre><code>del <var>options files_to_delete</var></code></pre>
<p class="BodyContinued">where <var>options</var> is command line options beginning with a slash, and <var>files_to_delete</var> is a list of filenames (pathnames), separated by spaces or commas, to be deleted. This command accepts wildcard characters; for example, the following command deletes all the <em>.obj</em> files appearing in the current directory:</p>
<pre><code>del *.obj</code></pre>
<p>It goes without saying that you should be very careful when using this command, especially when using wildcard characters. For example, consider the following command (which is probably a typo):</p>
<pre><code>del * .obj</code></pre>
<p>This deletes all the files in the current directory and then attempts to delete a file named <em>.obj</em> (which won’t exist after this command has deleted all the files in the subdirectory).</p>
<p>Some useful command line options are associated with this command. Use the <code>/?</code> option to learn about them:</p>
<pre><code>C:\&gt;del /?</code></pre>
<h3 id="h2-501089b04-0006">D.3.6	The dir Command</h3>
<p class="BodyFirst">The <code>dir</code> (<em>directory</em>) command is one of the more useful CLI commands. It displays a directory listing (a list of files in a directory). </p>
<p>Without any command line options, this command displays all the files in the current directory. With a single drive letter (and colon) as the argument, this command displays all the files in the default directory on the specified drive. With a pathname that leads to a subdirectory, this command displays all the files in the specified directory. With a pathname that leads to a single filename, this command displays the directory information about that particular file.</p>
<p>As usual, this command supports several command line options beginning with the slash character. Use <code>dir /?</code> to get the help information for this command.</p>
<h3 id="h2-501089b04-0007">D.3.7	The more Command</h3>
<p class="BodyFirst">The <code>more</code> command displays the text in a text file one screenful at a time. After displaying a screenful of text, it waits for the user to press <span class="KeyCaps">enter</span> or spacebar on the keyboard. Pressing spacebar advances the output another <span epub:type="pagebreak" title="933" id="Page_933"/>screenful of text; pressing <span class="KeyCaps">enter</span> advances the output by one line. Pressing Q terminates the program.</p>
<p>The <code>more</code> command expects one or more filenames on the command line as arguments. If you specify two or more files, <code>more</code> will display the output in order. The <code>more</code> command also allows several command line options. You can use the following command to learn about them:</p>
<pre><code>more /?</code></pre>
<h3 id="h2-501089b04-0008">D.3.8	The move Command</h3>
<p class="BodyFirst">The <code>move</code> command moves a file from one location to another (possibly renaming the file while moving it). It is similar to <code>copy</code>, though <code>move</code> deletes the file from its original location after moving it. The basic syntax for this command is the following:</p>
<pre><code>move <var>original_file new_file</var></code></pre>
<p>As usual, the <code>/?</code> command line option provides help for this command.</p>
<h3 id="h2-501089b04-0009">D.3.9	The ren and rename Commands</h3>
<p class="BodyFirst">The <code>ren</code> command (<code>rename</code> is a synonym) changes the name of a file. The syntax is </p>
<pre><code>ren <var>original_filename new_filename</var></code></pre>
<p class="BodyContinued">where (obviously) <var>original_filename</var> is the old filename you want to change and <var>new_filename</var> is the new name of the file you want to use. The new and old files must be in the same directory. Use the <code>move</code> command if you want to move the file to a new directory while renaming it.</p>
<h3 id="h2-501089b04-0010">D.3.10	The rd and rmdir Commands</h3>
<p class="BodyFirst">The <code>rd</code> command (<code>rmdir</code> is a synonym) removes (deletes) a directory. The directory must be empty before using this command (though the <code>/s</code> option can override this). The basic syntax for this command is</p>
<pre><code>rd <var>directory_path</var></code></pre>
<p class="BodyContinued">where <var>directory_path</var> is the path to the directory you wish to remove. Use the <code>rd /?</code> command to get help.</p>
<h3 id="h2-501089b04-0011">D.3.11	The time Command</h3>
<p class="BodyFirst">With no arguments, the <code>time</code> command displays the current system time and prompts you to change it. With a <code>/t</code> command line argument, <code>time</code> simply displays the current time. Use <code>/?</code> to display help information for this command.</p>
<h2 id="h1-501089b04-0004"><span epub:type="pagebreak" title="934" id="Page_934"/>	D.4 	For More Information</h2>
<p class="BodyFirst">This appendix has provided only the tiniest introduction to the Windows command line interpreter—just enough information to be able to effectively compile and run assembly language programs using MASM. The CLI supports many dozens of built-in commands (if not over a hundred). One place to learn about these commands is <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/cmd/." class="LinkURL">https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/cmd/.</a></p>
</section>
</body></html>