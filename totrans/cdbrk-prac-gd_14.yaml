- en: '14'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '14'
- en: Dictionary codes and book ciphers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 字典密码和书本密码
- en: '![](image_fi/502727c14/g14001.png)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/502727c14/g14001.png)'
- en: In 1918, toward the end of World War I, a German radio station sent the following
    message to a recipient in Mexico:^([1](b06.xhtml#c14-endnote-1))
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 1918年，第一次世界大战接近结束时，一家德国广播电台向墨西哥的接收人发送了以下消息：^([1](b06.xhtml#c14-endnote-1))
- en: '`49138 27141 51336 02062 49140 41345`'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '`49138 27141 51336 02062 49140 41345`'
- en: '`42635 02306 12201 15726 27918 30348`'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '`42635 02306 12201 15726 27918 30348`'
- en: '`53825 46020 40429 37112 48001 38219`'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '`53825 46020 40429 37112 48001 38219`'
- en: '`50015 43827 50015 04628 01315 55331`'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '`50015 43827 50015 04628 01315 55331`'
- en: '`20514 37803 19707 33104 33951 29240`'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '`20514 37803 19707 33104 33951 29240`'
- en: '`02062 42749 33951 40252 38608 14913`'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '`02062 42749 33951 40252 38608 14913`'
- en: '`33446 16329 55936 24909 27143 01158`'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '`33446 16329 55936 24909 27143 01158`'
- en: '`42635 04306 09501 49713 55927 50112`'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '`42635 04306 09501 49713 55927 50112`'
- en: '`13747 24255 27143 02803 24909 15742`'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '`13747 24255 27143 02803 24909 15742`'
- en: '`49513 22810 16733 41362 24909 17256`'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '`49513 22810 16733 41362 24909 17256`'
- en: '`19707 49419 39408 19801 34011 06336`'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '`19707 49419 39408 19801 34011 06336`'
- en: '`15726 47239 29901 37013 42635 19707`'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '`15726 47239 29901 37013 42635 19707`'
- en: '`42022 30334 06733 04156 39501 03237`'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '`42022 30334 06733 04156 39501 03237`'
- en: '`14521 37320 13503 42635 33951 29901`'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '`14521 37320 13503 42635 33951 29901`'
- en: '`49117 46633 02062 16636 19707 01426`'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '`49117 46633 02062 16636 19707 01426`'
- en: '`11511 42635 11239 04156 02914 12201`'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: '`11511 42635 11239 04156 02914 12201`'
- en: '`23145 55331 49423 03455 12201 30205`'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '`23145 55331 49423 03455 12201 30205`'
- en: '`33951 30219 50015 04156 43827 06420`'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '`33951 30219 50015 04156 43827 06420`'
- en: '`23309 19707 33104 42635 00308 29240`'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '`23309 19707 33104 42635 00308 29240`'
- en: '`05732 54628 01355 39338 02914 12201`'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '`05732 54628 01355 39338 02914 12201`'
- en: '`06420 11511 24909 27142 33951 49223`'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '`06420 11511 24909 27142 33951 49223`'
- en: '`49618 42022 42635 17212 55320 15726`'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '`49618 42022 42635 17212 55320 15726`'
- en: '`12201 06420 38219 21060 46633 37406`'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '`12201 06420 38219 21060 46633 37406`'
- en: '`43644 33558 22527`'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '`43644 33558 22527`'
- en: A US listening post recorded the message and forwarded it to MI-8, the US wartime
    codebreaking unit, for analysis. Herbert Yardley, MI-8’s famous lead, soon guessed
    that this cryptogram had been created with a so-called dictionary code.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 一家美国监听站记录了该消息并将其转发给美国战争期间的密码破译单位MI-8进行分析。MI-8的著名负责人赫伯特·亚德利很快猜测到，这个密码是通过一种所谓的字典密码创建的。
- en: We will use the analysis of this message as an example in this chapter.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在本章中使用此消息的分析作为示例。
- en: How dictionary codes and book ciphers work
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 字典密码和书本密码的工作原理
- en: A *dictionary code*, which typically uses a commercially available dictionary,
    records the page and position of a word in the book as its ciphertext representation.
    This chapter’s first example used the English-French half of *Clifton’s Nouveau
    Dictionnaire Français*, according to Yardley’s report. The five-digit group `43827`,
    for instance, stood for the twenty-seventh word listed on page 438 of this dictionary.
    (As we discussed in [Chapter 7](c07.xhtml), a dictionary code is not a cipher
    because it encrypts words, not letters.)
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: '*字典密码*，通常使用商业上可用的字典，通过记录单词在书中的页码和位置作为其密文表示。根据亚德利的报告，本章的第一个例子使用了*克利夫顿的法语新词典*的英法部分。例如，五位数字`43827`代表了该字典第438页上的第27个单词。（正如我们在[第7章](c07.xhtml)中讨论的那样，字典密码不是一种密码，因为它加密的是单词，而不是字母。）'
- en: 'The following list explains the five-letter groups in the cryptogram’s first
    line:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 以下列表解释了密码文中的第一行五个字母组：
- en: '`49138` (p. 491, 38th word): `TELEGRAM`'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`49138`（第491页，第38个词）：`电报`'
- en: '`27141` (p. 271, 41st word): `JANUARY`'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`27141`（第271页，第41个词）：`1月`'
- en: '`51336` (p. 513, 36th word): `TWO`'
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`51336`（第513页，第36个词）：`二`'
- en: '`02062` (p. 20, 62nd word): `AND`'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`02062`（第20页，第62个词）：`和`'
- en: '`49140` (p. 491, 40th word): `TELEGRAPHIC`'
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`49140`（第491页，第40个词）：`电报`'
- en: '`41345` (p. 413, 45th word): `REPORT`'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`41345`（第413页，第45个词）：`报告`'
- en: 'Thus, the plaintext starts as follows: `TELEGRAM` `[FROM] JANUARY TWO AND TELEGRAPHIC
    REPORT [FROM] S. ANTHONY DELMAR VIA SPAIN RECEIVED.`'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，明文的开头如下：`电报` `[来自] 1月2日，来自西班牙通过圣安东尼·德尔马的电报报告已接收。`
- en: A similar encryption scheme can be defined with any other book, such as a novel.
    We call these *book ciphers*. As it is usually quite difficult to find a particular
    word in a novel (unless it is a common expression like `THE`, `AND`, or `IF`),
    a book cipher usually references single letters instead of whole words, which
    is why it is a cipher, not a code.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 一种类似的加密方案可以通过任何其他书籍定义，例如小说。我们称这些为*书本密码*。由于通常在小说中找到特定单词非常困难（除非是像`THE`、`AND`或`IF`这样的常用表达），所以书本密码通常引用单个字母而不是整个单词，这也是它成为密码，而不是代码的原因。
- en: A prominent user of a book cipher was Nicholas Trist (1800–1874), a US diplomat
    sent to Mexico by President James K. Polk in 1848, toward the end of the Mexican-American
    War. Trist negotiated a treaty with the Mexican government, which resulted in
    the annexation of a great deal of territory that became all or part of ten modern
    states.^([2](b06.xhtml#c14-endnote-2))
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 使用书籍密码的著名人物是尼古拉斯·特里斯特（Nicholas Trist，1800–1874），他是美国的一位外交官，1848年由总统詹姆斯·K·波尔克派往墨西哥，正值美墨战争结束之际。特里斯特与墨西哥政府谈判达成了一项条约，导致大量领土被吞并，成为了现代十个州的一部分或全部。^([2](b06.xhtml#c14-endnote-2))
- en: In order to protect letters sent to and from Washington, Trist needed an encryption
    system. He devised two of them, both book ciphers. See the “Success stories” section
    of this chapter for the sleuthing that was needed to find the correct book.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 为了保护往来华盛顿的信件，特里斯特需要一种加密系统。他设计了两种加密方式，都使用书籍密码。请参见本章的“成功案例”部分，了解为找到正确书籍所需的侦查工作。
- en: 'The following text is (partially) encrypted in his first cipher:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 以下文本是用他的第一个密码（部分）加密的：
- en: '`Sir,`'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '`先生，`'
- en: '`In my last I said, “I consider the probabilities of an early peace very strong.”
    The enclosed will be found to corroborate this belief. 1,2,3,10—15,13,4,1—39,26,11,31—44,75,121,31—/47,1,6,16/7,3,15,20,24,27,28,29/,,8,1,9/,,9,1/,,2,5/,,1,1/,,1,16,29/69,2,1/,,
    6,7/,,2,3,2/,,6,4,6,10,8/ under date July 29: 5,33,25,4—30,105,44,45,58—from a
    foreign merchant to this correspondent here . . .`'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '`在我最后的信中，我说过：“我认为早日和平的可能性非常大。”随信附上的内容将证明这一点。1,2,3,10—15,13,4,1—39,26,11,31—44,75,121,31—/47,1,6,16/7,3,15,20,24,27,28,29/,,8,1,9/,,9,1/,,2,5/,,1,1/,,1,16,29/69,2,1/,,6,7/,,2,3,2/,,6,4,6,10,8/
    日期为7月29日：5,33,25,4—30,105,44,45,58—来自一位外国商人的来信 . . .`'
- en: 'The book Trist used was an 1827 textbook for learning Spanish: *True Principles
    of the Spanish Language* by José Borras. Trist probably thought that a book of
    this kind in the possession of an American traveler in Mexico would not raise
    suspicion.'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 特里斯特使用的书是一本1827年的西班牙语学习教材：《西班牙语的真正原理》（*True Principles of the Spanish Language*），作者为José
    Borras。特里斯特可能认为，在美国旅行者手中，这种书籍在墨西哥不会引起怀疑。
- en: 'Each number group in Trist’s first cipher, separated by commas, represents
    one or more letters taken from *True Principles of the Spanish Language* in the
    following way: page, line, letter, letter . . . This means that the group `1,2,3,10`
    encodes two letters, while the group `7,3,15,20,24,27,28,29` encodes six.'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 特里斯特第一个密码中的每个数字组，以逗号分隔，代表从《西班牙语的真正原理》一书中提取的一个或多个字母，具体方式如下：页码、行号、字母、字母 . . .
    这意味着数字组`1,2,3,10`编码了两个字母，而数字组`7,3,15,20,24,27,28,29`编码了六个字母。
- en: Likewise, `47,1,6,16` encodes two letters. If we know that the first line on
    page 47 is . . .
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，`47,1,6,16`编码了两个字母。如果我们知道第47页的第一行是 . . .
- en: '`TABLE TWENTY-FIFTH – The fly and the bull`'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '`表格第二十五：苍蝇与公牛`'
- en: . . . then we can conclude that the numbers `47,1,6,16` stand for the letters
    `T` and `H` (the spaces and the dash are not counted). If a number group starts
    with two missing numbers (as in `,,2,3,2`), then the page and line number from
    the previous group are used.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: . . . 然后我们可以得出结论，数字`47,1,6,16`代表字母`T`和`H`（空格和破折号不算在内）。如果一个数字组以两个缺失的数字开始（如`,,2,3,2`），则使用前一个数字组的页码和行号。
- en: 'Many other book ciphers have existed in the course of history. We even mentioned
    one in [Chapter 6](c06.xhtml): the system used to encrypt the second Beale cryptogram,
    where the “book” was the Declaration of Independence. Instead of identifying each
    letter with three numbers (page, line, and position), Beale’s cipher recorded
    only the position of words. This means that the first word in the Declaration
    of Independence is number `1`, the second word is number `2`, and so on. To encode
    the plaintext, only the first letter of the word is used.'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 历史上还存在许多其他书籍密码。我们甚至在[第6章](c06.xhtml)中提到过一种：用于加密第二个比尔密码的系统，其中“书籍”是《独立宣言》。与通过三组数字（页码、行号和位置）来识别每个字母不同，比尔的密码仅记录单词的位置。这意味着《独立宣言》中的第一个单词是数字`1`，第二个单词是数字`2`，以此类推。为了编码明文，只使用单词的第一个字母。
- en: Nicholas Trist devised a second cipher based on the same concept as Beale’s
    and using the same book as his other cipher. In a letter, he mentioned “`a short
    note` `[sent] to` `121,13,1,2,17,5,9,20`.” We can decrypt these eight letters,
    encrypted in his second cipher, by looking at the first page of the book ([Figure
    14-1](#figure14-1)). If you attempt this, you’ll see that the expression `121,13,1,2,17,5,9,20`
    decrypts to `MR THNTON`. This probably refers to a Mr. Thornton. (Trist seems
    to have omitted two letters of the name.)
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 尼古拉斯·特里斯特设计了第二种基于贝尔密码概念的密码，并使用与他其他密码相同的书籍。在一封信中，他提到“`一封简短的便条` `[发给]` `121,13,1,2,17,5,9,20`。”我们可以通过查看这本书的第一页来解密这八个字母，这些字母被加密在他的第二种密码中（见[图14-1](#figure14-1)）。如果你尝试解密，你会发现表达式`121,13,1,2,17,5,9,20`解密为`MR
    THNTON`。这可能指的是一位名叫Thornton先生的人。（特里斯特似乎遗漏了名字中的两个字母。）
- en: '![](image_fi/502727c14/f14001.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/502727c14/f14001.png)'
- en: 'Figure 14-1: The first page of the book Nicholas Trist used for his book ciphers,
    *True Principles of the Spanish Language*'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14-1：尼古拉斯·特里斯特在其书籍密码中使用的《西班牙语言真理原则》一书的首页，*西班牙语言真理原则*。
- en: Dictionary codes and book ciphers were quite popular in the early years of the
    United States. During the American Revolution, Benedict Arnold, a traitor, encrypted
    a number of letters in a book cipher using Sir William Blackstone’s *Commentaries
    on the Laws of England*.^([3](b06.xhtml#c14-endnote-3)) As the book cipher proved
    cumbersome, he soon switched to a dictionary code based on *Nathan* *Bailey’s
    Dictionary*.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 词典码和书籍密码在美国初期非常流行。在美国独立战争期间，叛徒本尼迪克特·阿诺德使用威廉·布莱克斯通爵士的*《英格兰法律评论》*进行加密，发送了许多书籍密码的信件。^([3](b06.xhtml#c14-endnote-3))
    由于书籍密码显得繁琐，他很快转而使用基于*纳森·贝利词典*的词典码。
- en: Alexander Hamilton, one of the Founders of the United States and the hero of
    the eponymous Broadway musical by Lin-Manuel Miranda, was given a description
    of a dictionary code by his father-in-law, Philip Schuyler, whose system was based
    on the 1777 edition of *Entick’s Spelling Dictionary*.^([4](b06.xhtml#c14-endnote-4))
    History has not recorded whether Hamilton ever used this code, but we do know
    that both the English and the US militaries employed this dictionary for the purposes
    of encryption. British generals Charles Cornwallis and Henry Clinton used it during
    the Revolutionary War, and a record suggests that US Vice President Aaron Burr,
    who killed Hamilton for unrelated reasons in a famous duel in 1804, used the 1805
    version of that same dictionary in his own correspondence.^([5](b06.xhtml#c14-endnote-5))
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 亚历山大·汉密尔顿，美国开国元勋之一，也是林-曼努埃尔·米兰达同名百老汇音乐剧的主角，曾由他的岳父菲利普·斯凯勒描述了一个词典码系统，该系统基于1777年版的*《恩蒂克拼写词典》*。^([4](b06.xhtml#c14-endnote-4))
    历史没有记录汉密尔顿是否曾使用这个密码，但我们知道英美两国的军队都使用过这个词典进行加密。英国将领查尔斯·康沃利斯和亨利·克林顿在美国独立战争期间使用过它，而且有记录显示，美国副总统亚伦·伯尔——因在1804年与汉密尔顿进行决斗并致其死——也曾在他的信件中使用过1805年版的同一本词典。^([5](b06.xhtml#c14-endnote-5))
- en: How to detect a dictionary code or book cipher
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何检测词典码或书籍密码
- en: Detecting a dictionary code can be quite simple. For instance, look at the World
    War II–era message shown in [Figure 14-2](#figure14-2).^([6](b06.xhtml#c14-endnote-6))
    This is an English translation of a German telegram.^([7](b06.xhtml#c14-endnote-7))
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 检测词典码其实非常简单。例如，看看[图14-2](#figure14-2)所示的二战时期的消息。^([6](b06.xhtml#c14-endnote-6))
    这是一个德语电报的英文翻译。^([7](b06.xhtml#c14-endnote-7))
- en: '![](image_fi/502727c14/f14002.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/502727c14/f14002.png)'
- en: 'Figure 14-2: This (translated) telegram from World War II includes two dictionary
    code expressions.'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 图14-2：这份（已翻译的）来自二战时期的电报包含了两个词典码表达式。
- en: The numbers `244`, `1345`, and `4992` are probably codegroups from an unidentified
    codebook and are not relevant here.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 数字`244`、`1345`和`4992`可能是来自某个未识别的密码本的密码组，且与此处无关。
- en: Of note, this cryptogram contains the expressions `264/6` and `112/3`. The most
    popular encryption methods that produce expressions using this slash format are
    dictionary codes and book ciphers. If this suspicion is correct, `264` in `264/6`
    probably stands for the page, while `6` represents the position of a word or letter.
    In fact, the two expressions were taken from the *Langenscheidt’s Lilliput Dictionary
    English–German*; `264/6` stands for `PIER` and `112/3` for `DECEMBER`.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 值得注意的是，这个密码包含了表达式`264/6`和`112/3`。使用这种斜杠格式的常见加密方法有词典码和书籍密码。如果这个推测正确，`264`中的`264/6`可能代表页码，而`6`则代表单词或字母的位置。事实上，这两个表达式来自于*Langenscheidt的小型英德词典*；`264/6`代表`PIER`，`112/3`代表`DECEMBER`。
- en: 'If there is no visible separation between the page number and the word position,
    detecting a dictionary code or a book cipher is a little more difficult. Such
    a system can, for instance, easily be confused with a code or nomenclator (see
    [Chapter 7](c07.xhtml)). In those cases, here is some helpful information: typically,
    there are fewer than one hundred words on a dictionary page and usually even fewer
    than fifty. So, if a cryptogram contains digit groups in the form `XXXYY`, one
    should check whether `YY` is smaller than fifty in every instance.'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 如果页面编号和单词位置之间没有明显的分隔，那么检测字典密码或书籍密码会稍微困难一些。这样的系统，例如，可以很容易与代码或命名法混淆（见[第7章](c07.xhtml)）。在这种情况下，以下是一些有用的信息：通常，字典页面上有不到一百个单词，通常甚至不到五十个。所以，如果密码包含以`XXXYY`形式的数字组，应该检查每个实例中`YY`是否小于五十。
- en: Of course, the code may be a reversed system such as `YY-XXX` or some other
    scrambled method. Also, if the number is greater than fifty, a book cipher, where
    larger numbers of words fit on one page, might have been used. For example, the
    Beale system counted the hundreds of words in the Declaration of Independence
    from beginning to end.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，代码可能是反转系统，例如`YY-XXX`，或者其他某种混乱的方法。此外，如果数字大于五十，可能使用了书籍密码，其中大量的单词会适合在一页上。例如，Beale系统从头到尾数过《独立宣言》中的几百个单词。
- en: How to break a dictionary code or book cipher
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何破解字典密码或书籍密码
- en: Breaking a dictionary code or book cipher can be very difficult. If the code
    is used properly, and if the cryptanalyst does not know the book, it may even
    be impossible. However, the book can sometimes be found. Also, as is always the
    case in cryptography, the codebreaker can profit from mistakes the encipherer
    has made.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 破解字典密码或书籍密码可能非常困难。如果密码使用得当，并且密码分析员不知道所用的书籍，甚至可能不可能破解。然而，书籍有时可以被找到。此外，正如密码学中的常见情况一样，破译者可以利用加密者的失误来获益。
- en: Identifying the book or dictionary
  id: totrans-67
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 确定书籍或字典
- en: 'The most obvious way to break a dictionary code or a book cipher is to find
    the book it is based on. We have already seen an example (probably fictional)
    in [Chapter 6](c06.xhtml): according to the Beale pamphlet, a man deciphered the
    second Beale cryptogram after identifying that it had used the Declaration of
    Independence for encryption.'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 破解字典密码或书籍密码最直接的方法是找到其所基于的书籍。我们已经在[第6章](c06.xhtml)看到过一个例子（可能是虚构的）：根据Beale小册子，一名男子在识别出《独立宣言》被用作加密后破解了第二个Beale密码。
- en: Another (definitely fictitious) case occurs in the 1915 Sherlock Holmes novel
    *The Valley of Fear* by Arthur Conan Doyle. In this novel, Holmes receives an
    encrypted message from a certain Fred Porlock and suspects that he is dealing
    with a book-cipher cryptogram. He concludes that the book used is widely available,
    large (with at least 534 pages), and printed in two columns per page. Most almanacs
    meet these conditions exactly.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个（绝对是虚构的）例子出现在亚瑟·柯南·道尔1915年的福尔摩斯小说*《恐怖山谷》*中。在这部小说中，福尔摩斯收到了一条来自某个弗雷德·波洛克的加密信息，并怀疑他正在处理一本书籍密码的密码。福尔摩斯推测所用的书籍是广泛可得的，大型（至少有534页），每页有两列。大多数年鉴正好符合这些条件。
- en: Holmes first tries the latest edition of *Whitaker’s Almanack*, which he had
    received only a few days earlier, to no avail. He then tries the previous edition
    of the same book—and it works. With this almanac, Holmes is able to decipher the
    message and uncover a warning that “some devilry” is intended. Of course, in the
    end, he solves the case.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 福尔摩斯首先尝试了他几天前才收到的*《惠特克年鉴》*最新版本，但没有成功。接着，他尝试了同一本书的前一版本——并且成功了。借助这本年鉴，福尔摩斯解读出了信息，并揭示了一个警告，说明“某些恶行”将会发生。当然，最终他解决了案件。
- en: Reconstructing the dictionary
  id: totrans-71
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 重建字典
- en: In his 1922 book *Cryptography*, Swiss cryptologist André Langie reports on
    the following cryptogram he was asked to solve:^([8](b06.xhtml#c14-endnote-8))
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 在他1922年的著作*《密码学》*中，瑞士密码学家安德烈·朗吉报告了他被要求破解的下列密码:^([8](b06.xhtml#c14-endnote-8))
- en: '`5761 3922 7642 0001 9219 6448 6016 4570 4368 7159`'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: '`5761 3922 7642 0001 9219 6448 6016 4570 4368 7159`'
- en: '`8686 8576 1378 2799 6018 4212 3940 0644 7262 8686`'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '`8686 8576 1378 2799 6018 4212 3940 0644 7262 8686`'
- en: '`7670 4049 3261 4176 6638 4833 4827 0001 3696 6062`'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '`7670 4049 3261 4176 6638 4833 4827 0001 3696 6062`'
- en: '`8686 2137 4049 2485 7948 0300 9712 0300 4212 9576`'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '`8686 2137 4049 2485 7948 0300 9712 0300 4212 9576`'
- en: '`2475 8576 8337 0702 9185`'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: '`2475 8576 8337 0702 9185`'
- en: As can be seen, the message consists of forty-five four-digit numbers. At first
    glance, it doesn’t look like a dictionary code, as separating the four-digit numbers
    into “page” numbers and “word” numbers doesn’t make sense unless the dictionary
    used has about a hundred pages with about a hundred entries per page, which is
    not very likely.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 如上所示，消息由四十五个四位数字组成。乍一看，这不像是字典密码，因为将四位数字分为“页码”和“单词”号码并没有意义，除非所使用的字典大约有一百页，每页大约有一百个条目，这种情况并不太可能。
- en: But what if the sender of the message numbered the entries of a dictionary from
    beginning to end, without including the page number? This option becomes much
    more likely when we consider that the number `0001` appears twice in this text.
    The first entry in an English dictionary is usually the article *A*. As *A* is
    a common word, it is plausible that it appears twice in a text of this length.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 但是，如果消息的发送者按从头到尾的顺序对字典中的条目进行编号，而没有包含页码呢？当我们考虑到数字`0001`在此文本中出现了两次时，这种情况就变得更加可能。英文词典中的第一个条目通常是词条*A*。由于*A*是一个常见词，因此它在这样一个长度的文本中出现两次是合理的。
- en: 'Let’s assume that we may be dealing with a dictionary cipher of this kind.
    Here is a sorted list of the four-digit numbers appearing in the text:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们可能正在处理这种类型的字典密码。以下是文本中出现的四位数字的排序列表：
- en: '`0001, 0001, 0300, 0300, 0644, 0702, 1378, 2137, 2475, 2485, 2799, 3261, 3696,
    3922, 3940, 4049, 4049, 4176, 4212, 4212, 4368, 4570, 4827, 4833, 5761, 6016,
    6018, 6062, 6448, 6638, 7159, 7262, 7642, 7670, 7948, 8337, 8576, 8576, 8686,
    8686, 8686, 9185, 9219, 9576, 9712`'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: '`0001, 0001, 0300, 0300, 0644, 0702, 1378, 2137, 2475, 2485, 2799, 3261, 3696,
    3922, 3940, 4049, 4049, 4176, 4212, 4212, 4368, 4570, 4827, 4833, 5761, 6016,
    6018, 6062, 6448, 6638, 7159, 7262, 7642, 7670, 7948, 8337, 8576, 8576, 8686,
    8686, 8686, 9185, 9219, 9576, 9712`'
- en: 'Along with `0001`, we see that other groupings are repeated as well: `0300`,
    `4049`, `4212`, `8576`, and `8686`.'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 除了`0001`，我们还可以看到其他组也有重复的情况：`0300`、`4049`、`4212`、`8576`和`8686`。
- en: The following table might be helpful. It shows how words with starting letters
    *A* through *Z* are distributed in a dictionary containing the 10,000 most frequent
    English words.^([9](b06.xhtml#c14-endnote-9)) Along with the words’ starting positions,
    this table shows how, for some letters, there are significantly fewer pages of
    entries than for others.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格可能会有所帮助。它展示了从字母*A*到*Z*的词汇在包含10000个最常见英文单词的字典中的分布情况。^([9](b06.xhtml#c14-endnote-9))
    除了单词的起始位置之外，这个表格还展示了对于某些字母来说，条目的页数明显少于其他字母。
- en: '`A 0001 – 0643`'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: '`A 0001 – 0643`'
- en: '`B 0644 – 1178`'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: '`B 0644 – 1178`'
- en: '`C 1179 – 2160`'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: '`C 1179 – 2160`'
- en: '`D 2161 – 2755`'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '`D 2161 – 2755`'
- en: '`E 2756 – 3177`'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '`E 2756 – 3177`'
- en: '`F 3178 – 3599`'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '`F 3178 – 3599`'
- en: '`G 3600 – 3926`'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '`G 3600 – 3926`'
- en: '`H 3927 – 4295`'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: '`H 3927 – 4295`'
- en: '`I 4296 – 4717`'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '`I 4296 – 4717`'
- en: '`J 4718 – 4800`'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '`J 4718 – 4800`'
- en: '`K 4801 – 4877`'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: '`K 4801 – 4877`'
- en: '`L 4878 – 5216`'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: '`L 4878 – 5216`'
- en: '`M 5217 – 5710`'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '`M 5217 – 5710`'
- en: '`N 5711 – 5871`'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '`N 5711 – 5871`'
- en: '`O 5872 – 6109`'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '`O 5872 – 6109`'
- en: '`P 6110 – 6960`'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '`P 6110 – 6960`'
- en: '`Q 6961 – 7019`'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '`Q 6961 – 7019`'
- en: '`R 7020 – 7513`'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '`R 7020 – 7513`'
- en: '`S 7514 – 8715`'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: '`S 7514 – 8715`'
- en: '`T 8716 – 9298`'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '`T 8716 – 9298`'
- en: '`U 9299 – 9453`'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: '`U 9299 – 9453`'
- en: '`V 9454 – 9637`'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '`V 9454 – 9637`'
- en: '`W 9638 – 9929`'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: '`W 9638 – 9929`'
- en: '`X 9930 – 9941`'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: '`X 9930 – 9941`'
- en: '`Y 9442 – 9971`'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '`Y 9442 – 9971`'
- en: '`Z 9972 – 10000`'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '`Z 9972 – 10000`'
- en: Now look at group `0300`, which appears twice in the cryptogram. If we are correct
    about the encryption system used, it is very likely that this word starts with
    an `A` and that the second letter is located somewhere in the middle of the alphabet.
    `AND` is a good candidate.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 现在看看组`0300`，它在密码中出现了两次。如果我们对所使用的加密系统是正确的，那么很可能这个单词以`A`开头，并且第二个字母位于字母表的中间位置。`AND`是一个很好的候选词。
- en: The number `8686` appears three times in the cryptogram, which makes it the
    most frequent digit group in this ciphertext. Close to it is `8576`, which appears
    twice. According to the table we created, the words at these locations should
    start with `S`. But are there two common English words starting with `S` so close
    to each other in the alphabet? `STILL` and `SUCH` might be candidates, but further
    inspection shows that these are not good matches.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 数字`8686`在密码中出现了三次，这使它成为此密文中出现频率最高的数字组。与之接近的是`8576`，它出现了两次。根据我们创建的表格，这些位置的单词应该以`S`开头。但字母表中是否有两个以`S`开头的常见英语单词如此接近呢？`STILL`和`SUCH`可能是候选词，但进一步检查显示它们并不是很好的匹配。
- en: 'Instead, let’s assume that the letter distribution in the dictionary used by
    the message’s author differs a little from the one in our table. Perhaps looking
    at words starting with `T` will work. In fact, there are two words that seem to
    fit: `THE` and `TO`. This guess is confirmed by the fact that the sequence `8686
    8576` appears in the ciphertext, and `TO THE` is a common word pair.'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 相反，我们假设消息作者所使用的词典中的字母分布与我们表中的略有不同。或许看一下以`T`开头的单词会有帮助。事实上，有两个单词似乎适合：`THE`和`TO`。这个猜测得到了验证，因为在密文中出现了`8686
    8576`，而`TO THE`是一个常见的词组。
- en: 'Based on our guesses, we can sketch the following:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 根据我们的猜测，我们可以绘制出以下内容：
- en: '`5761 3922 7642 0001 9219 6448 6016 4570 4368 7159`'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: '`5761 3922 7642 0001 9219 6448 6016 4570 4368 7159`'
- en: '`A`'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: '`A`'
- en: '`8686 8576 1378 2799 6018 4212 3940 0644 7262 8686`'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '`8686 8576 1378 2799 6018 4212 3940 0644 7262 8686`'
- en: '`TO``THE``TO`'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: '`TO``THE``TO`'
- en: '`7670 4049 3261 4176 6638 4833 4827 0001 3696 6062`'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: '`7670 4049 3261 4176 6638 4833 4827 0001 3696 6062`'
- en: '`A`'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: '`A`'
- en: '`8686 2137 4049 2485 7948 0300 9712 0300 4212 9576`'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: '`8686 2137 4049 2485 7948 0300 9712 0300 4212 9576`'
- en: '`TO``AND``AND`'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: '`TO``AND``AND`'
- en: '`2475 8576 8337 0702 9185`'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: '`2475 8576 8337 0702 9185`'
- en: '`THE`'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: '`THE`'
- en: 'The next step is to try to guess all other starting letters based on the distribution
    table:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是根据分布表尝试猜测所有其他的起始字母：
- en: '`5761 3922 7642 0001 9219 6448 6016 4570 4368 7159`'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: '`5761 3922 7642 0001 9219 6448 6016 4570 4368 7159`'
- en: '`N G S A T P O I I R`'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '`N G S A T P O I I R`'
- en: '`8686 8576 1378 2799 6018 4212 3940 0644 7262 8686`'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '`8686 8576 1378 2799 6018 4212 3940 0644 7262 8686`'
- en: '`TO THE C E O H H B R TO`'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '`TO THE C E O H H B R TO`'
- en: '`7670 4049 3261 4176 6638 4833 4827 0001 3696 6062`'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: '`7670 4049 3261 4176 6638 4833 4827 0001 3696 6062`'
- en: '`S H F H P K K A G O`'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '`S H F H P K K A G O`'
- en: '`8686 2137 4049 2485 7948 0300 9712 0300 4212 9576`'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: '`8686 2137 4049 2485 7948 0300 9712 0300 4212 9576`'
- en: '`TO C H D S AND W AND H Y`'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: '`TO C H D S AND W AND H Y`'
- en: '`2475 8576 8337 0702 9185`'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: '`2475 8576 8337 0702 9185`'
- en: '`D THE S B T`'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '`D THE S B T`'
- en: Admittedly, it gets difficult from here. We need to guess more words, but we
    only know the (probable) initial letter of each one.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 毋庸置疑，从这里开始就变得困难了。我们需要猜测更多的单词，但我们只能知道每个单词的（可能的）首字母。
- en: To make things a little easier, let’s assume that we know a small part of the
    plaintext (i.e., a crib). Say that we have been told that this message is military
    in nature and that it contains information about an enemy offensive. In fact,
    the numbers `2799` and `6018` in the second line might stand for `ENEMY OFFENSIVE`.
    If this is the case, `1378`, which stands between `TO THE` and `ENEMY OFFENSIVE`,
    might be `COMING`. The number `6016` in the first line is pretty close to `6018`
    (`OFFENSIVE`). The most likely decryption is `OF`.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 为了让事情稍微简单一点，假设我们知道明文的一小部分（即一个线索）。假设我们已经得知，这条消息是关于军事的，且包含敌人进攻的信息。事实上，第二行中的数字`2799`和`6018`可能代表`ENEMY
    OFFENSIVE`。如果是这样的话，`1378`，它位于`TO THE`和`ENEMY OFFENSIVE`之间，可能是`COMING`。第一行中的数字`6016`与`6018`（`OFFENSIVE`）非常接近。最可能的解密结果是`OF`。
- en: 'The second-highest number, `9576`, is probably a `W` word, perhaps `WERE` or
    `WILL`. It is followed by `2475`, a D word, which is itself followed by `THE`.
    What can it be? Alphabetically, it occurs somewhere between `COMING` (`1378`)
    and `ENEMY` (`2799`). The interval between these two is `1421`, and the difference
    between `1378` and `2475` is `1097`, roughly three-fourths of the interval. This
    leads us to the *Dis* and *Dos*. There is another number in the text occupying
    about the same dictionary position: `2485`. Either `2475` or `2485` might be `DO`.
    Suppose we assign `DO` to `2485` and look for a word closely preceding it that
    suits our context. A dictionary file shows us `DIVULGE` and `DIVIDE`. The numbers
    `0300` through `8576` may therefore stand for `AND YOU AND I WILL DIVIDE THE`.'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 第二高的数字`9576`可能是一个`W`开头的单词，或许是`WERE`或`WILL`。接下来是`2475`，一个以`D`开头的单词，后面跟着`THE`。这可能是什么呢？按字母顺序，它出现在`COMING`（`1378`）和`ENEMY`（`2799`）之间。这两个词的间隔是`1421`，而`1378`和`2475`之间的差值是`1097`，大约是间隔的四分之三。这将我们引导到了*Dis*和*Dos*。文本中还有另一个数字，它大致占据相同的词典位置：`2485`。`2475`或`2485`可能是`DO`。假设我们将`DO`分配给`2485`，并寻找一个适合我们上下文的、紧接着它的单词。字典文件向我们展示了`DIVULGE`和`DIVIDE`。因此，数字`0300`到`8576`可能代表`AND
    YOU AND I WILL DIVIDE THE`。
- en: To solve the rest of the cryptogram, we can use similar guesses. We will certainly
    make a false step occasionally, but every word established strengthens our foothold.
    The more words we guess, the easier it will be to find further ones. Here’s the
    plaintext we finally receive. (The first word is not known but is probably a name
    starting with `M`.)
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 要解开其余的密文，我们可以使用类似的猜测。我们肯定会偶尔犯错，但每一个被确定的单词都会增强我们的立足点。我们猜的单词越多，找到更多单词就会变得更容易。这里是我们最终得到的明文。（第一个单词未知，但很可能是以`M`开头的名字。）
- en: '`???? HAS SECURED A VALUABLE PIECE OF INFORMATION IN REGARD TO THE COMING ENEMY
    OFFENSIVE. I HAVE BEEN REQUESTED TO SEND HIM FIVE HUNDRED POUNDS. IT IS A GOOD
    OPPORTUNITY TO DENOUNCE HIM. DO SO, AND YOU AND I WILL DIVIDE THE SUM BETWEEN
    US.`'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: '`???? 已经获得了关于即将到来的敌人进攻的宝贵情报。我已被要求送给他五百英镑。这是揭发他的一个好机会。照做，你我将分担这笔钱。`'
- en: Breaking a dictionary code in this way is certainly not easy. However, as will
    be shown in the “Success stories” section of this chapter, it is possible.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 以这种方式破解字典密码确实不容易。然而，正如本章“成功案例”部分所展示的那样，这是可能的。
- en: Treating a book cipher like a simple substitution cipher
  id: totrans-141
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 把书本密码当作简单的替换密码来处理
- en: Depending on its construction, a book cipher can also be regarded as a simple
    substitution cipher, homophonic cipher, or nomenclator. This means that we can
    solve certain book cipher cryptograms using the techniques for breaking encryptions
    of each of those types. As an example, look at the handwritten dedication we found
    in a used copy of the esteemed Martin Gardner’s 1972 book *Codes, Ciphers and
    Secret Writing*, which is a very basic introduction to cryptology (see [Figure
    14-3](#figure14-3)).^([10](b06.xhtml#c14-endnote-10))
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 根据其构造方式，书本密码也可以被看作是一个简单的替换密码、同音密码或命名法。这意味着我们可以使用每种类型的加密破解技术来解决某些书本密码密码。举个例子，看看我们在一本二手书《密码、暗号与密写》中找到的手写献辞，这本书是著名的马丁·加德纳于1972年出版的，是一本关于密码学的非常基础的入门书籍（见[图14-3](#figure14-3)）。^([10](b06.xhtml#c14-endnote-10))
- en: '![](image_fi/502727c14/f14003.png)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/502727c14/f14003.png)'
- en: 'Figure 14-3: A dedication encrypted using a book cipher'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 图14-3：用书本密码加密的献辞
- en: 'Here’s a transcript:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个抄本：
- en: '`1-11,1-9,1-4,1-4,1-12 78-3,3-3,1-8,1-5,1-11,5-1,1-9,1-12`'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: '`1-11,1-9,1-4,1-4,1-12 78-3,3-3,1-8,1-5,1-11,5-1,1-9,1-12`'
- en: 'There are multiple ways to solve this cryptogram, but if we look at it as nothing
    more than a simple substitution cipher, we could use the following strategy. First,
    let’s replace each hyphenated two-number group with a letter, going from left
    to right and introducing a new letter each time we encounter a new number pair.
    That would transcribe this cryptogram as follows:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 解决这个密码的方法有很多种，但如果我们仅仅把它看作是一个简单的替换密码，我们可以采用以下策略。首先，让我们用字母替换每一组由连字符分隔的两位数字，从左到右，每次遇到新的数字对时引入一个新的字母。这将把这个密码转录为以下内容：
- en: '`ABCCD EFGHAIBD`'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: '`ABCCD EFGHAIBD`'
- en: 'Among the many words that match the pattern `ABCCD` is `HAPPY`. (A quick way
    to find such word-pattern matches is with a program such as CrypTool 2.) If we
    then replace the letters accordingly, it gives us the following second word: `****H*AY`.
    It’s not very hard from there to guess that the plaintext is `HAPPY BIRTHDAY`.'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多符合`ABCCD`模式的单词中，有一个是`HAPPY`。（快速找到这样的单词模式匹配的方法是使用像CrypTool 2这样的程序。）如果我们然后根据字母替换，它给出了以下第二个单词：`****H*AY`。从这里猜测，明文很容易是`HAPPY
    BIRTHDAY`。
- en: As another way of solving it (perhaps the method originally intended), if we
    look at the first paragraph of Gardner’s *Codes, Ciphers and Secret Writing* .
    . .
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 作为另一种解决方法（可能是最初意图的方式），如果我们查看加德纳的*《密码、暗号与密写》*第一段……
- en: '`Cryptography, the writing and deciphering of messages . . .`'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: '`密码学，消息的编写和解码……`'
- en: . . . we see that we are dealing with a book cipher. Here, `1-11` stands for
    the eleventh letter of the first word, `H`; `1-9` for the ninth letter of the
    first word, `A`; and so on.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: ……我们看到我们正在处理一个书本密码。在这里，`1-11`代表第一个单词的第十一字母`H`；`1-9`代表第一个单词的第九字母`A`；依此类推。
- en: Success stories
  id: totrans-153
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 成功案例
- en: The FIDES ads
  id: totrans-154
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: FIDES广告
- en: 'Between 1862 and 1866, a series of twenty-three advertisements was published
    in the London paper *The Times*. Each ad started with the word `FIDES`, and most
    were at least partially encrypted.^([11](b06.xhtml#c14-endnote-11)) Here are a
    few examples:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 在1862年到1866年之间，伦敦报纸*《泰晤士报》*刊登了23条广告。每则广告都以单词`FIDES`开头，大多数广告至少部分加密过。^([11](b06.xhtml#c14-endnote-11))以下是几个例子：
- en: '`1862-10-31`'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '`1862-10-31`'
- en: '`FIDES (Thought).—No myth, but a neighbouring town, where I shall be detained
    a little time. I shall be in for a few hours on Monday, and must take my chance
    of meeting you between 2 and 3 o’clock. Perhaps I may hear from you meantime.
    Direct to P.O.`'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: '`FIDES（思考）。——不是神话，而是一个邻近的城市，我将被扣留一段时间。我将在星期一待几个小时，并且必须在2点到3点之间有机会与你见面。也许我会在这段时间内收到你的消息。请寄到P.O.。`'
- en: '`1864-06-22`'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '`1864-06-22`'
- en: '`FIDES.–DOCUMENTS will AWAIT your ARRIVAL at No. 3\. on and after Tuesday next.
    Both of your letters to hand. (58.62) (171.53) (248.74) (152.79) (223.84) (25.21)
    (222.64) (132.74). James gone to Egypt instead.`'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: '`FIDES.–DOCUMENTS will AWAIT your ARRIVAL at No. 3\. on and after Tuesday next.
    Both of your letters to hand. (58.62) (171.53) (248.74) (152.79) (223.84) (25.21)
    (222.64) (132.74). James gone to Egypt instead.`'
- en: '`1864-07-21`'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '`1864-07-21`'
- en: '`FIDES.–(218.57) (106.11) (8.93) (17.61) (223.64) (146.7) (244.53) (224.21)
    (20) (192.5) (160.19) (99.39) (No. 8) (251.70) (1) (223.64) (58.89) (151.79) (226.69)
    (8.93) (40.12) (149.9) (248.101) (167.12) (252.35) (12.31) (135.100) (149.9) (145.76)
    (225.53) (212.25) (20) (241.6) (222.22) (78.45) (12.31) (66.28) (252.33) (158.33)
    (6.65) (20) (2) (11.50) (142.37) (223.87) (12.31) (142.37) (105.33) (142.37) (157.20)
    (58.62) (133.89) (250.86).`'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '`FIDES.–(218.57) (106.11) (8.93) (17.61) (223.64) (146.7) (244.53) (224.21)
    (20) (192.5) (160.19) (99.39) (No. 8) (251.70) (1) (223.64) (58.89) (151.79) (226.69)
    (8.93) (40.12) (149.9) (248.101) (167.12) (252.35) (12.31) (135.100) (149.9) (145.76)
    (225.53) (212.25) (20) (241.6) (222.22) (78.45) (12.31) (66.28) (252.33) (158.33)
    (6.65) (20) (2) (11.50) (142.37) (223.87) (12.31) (142.37) (105.33) (142.37) (157.20)
    (58.62) (133.89) (250.86).`'
- en: Our source for the `FIDES` cryptograms is, of course, the wonderful 2005 book
    *The Agony Column Codes & Ciphers* by Jean Palmer (a pen name of Tony Gaffney),
    which we have referenced many times in previous chapters.^([12](b06.xhtml#c14-endnote-12))
    Gaffney solved most of the encrypted ads listed in his book himself; however,
    he hadn’t yet found a solution to the `FIDES` cryptograms when his book was published
    in 2005.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的`FIDES`密码来源，当然是2005年由Jean Palmer（Tony Gaffney的笔名）所著的《*The Agony Column Codes
    & Ciphers*》一书，我们在之前的章节中多次引用过该书。^([12](b06.xhtml#c14-endnote-12)) Gaffney自己解开了书中列出的绝大多数加密广告；然而，在2005年这本书出版时，他还未能解开`FIDES`密码。
- en: 'A few years later, Gaffney once again tried to solve the `FIDES` cryptograms,
    this time assuming that he was dealing with a dictionary code, in which case,
    an expression like `146.7` stood for the seventh word on page 146\. Based on frequency
    analysis and cribs provided by the cleartext part of the advertisements, Gaffney
    was able to make some guesses. However, in order to completely solve the mystery,
    he needed to find the dictionary used. After many hours of searching the British
    Library, he had looked through no fewer than forty-eight English dictionaries
    from the nineteenth century. The forty-ninth proved to be the one that fit: *Johnson’s
    Pocket Dictionary of the English Language*, published in 1862.'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 几年后，Gaffney再次尝试解密`FIDES`密码，这次他假设自己处理的是一本字典密码，在这种情况下，像`146.7`这样的表达代表第146页的第七个单词。通过频率分析和广告中明文部分提供的线索，Gaffney能够做出一些猜测。然而，为了彻底解决这个谜题，他需要找到所使用的字典。经过多小时在英国图书馆的搜索，他翻阅了至少48本19世纪的英文词典。第49本证明是符合要求的：*Johnson’s
    Pocket Dictionary of the English Language*，出版于1862年。
- en: From there, it became clear exactly how the code worked. The first number of
    each pair turned out to be the page number plus one. The second number was the
    word number counted from the bottom of the page, starting from the right-hand
    column and then continuing down the left-hand one. In addition, `1` represented
    `I` and `2` represented `YOU`; `20` stood for a comma or a period.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 从那里开始，密码的工作原理变得清晰了。每对数字的第一个数字实际上是页码加一。第二个数字是从页面底部开始的单词编号，从右栏开始，然后继续向下到左栏。此外，`1`代表`I`，`2`代表`YOU`；`20`代表逗号或句号。
- en: The advertisement dated “1864-06-22” decrypts to `DARLING PRECIOUS WEARY OAF
    THOU BETTER THAN LIFE`. Some of these words might have made sense only to the
    people involved! The complete decryptions are available in Klaus’s 2014 blog post.^([13](b06.xhtml#c14-endnote-13))
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 日期为“1864-06-22”的广告解密为`DARLING PRECIOUS WEARY OAF THOU BETTER THAN LIFE`。这些词语中的一些可能只有相关人员才会明白！完整的解密内容可以在Klaus
    2014年的博客文章中找到。^([13](b06.xhtml#c14-endnote-13))
- en: Nicholas Trist’s key book
  id: totrans-166
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Nicholas Trist的关键著作
- en: Earlier in this chapter, we mentioned that US diplomat Nicholas Trist used two
    book ciphers to communicate with the US government during his stay in Mexico.^([14](b06.xhtml#c14-endnote-14))
    Crypto-historian Ralph E. Weber described these ciphers in his 1979 book *United
    States Diplomatic Codes and Ciphers*, but he couldn’t decipher all of Trist’s
    messages, as he didn’t know the book Trist had used.^([15](b06.xhtml#c14-endnote-15))
    All he knew was that both of Trist’s ciphers were based on the same book.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章前面，我们提到美国外交官Nicholas Trist在他驻墨西哥期间使用了两本书密码与美国政府进行通信。^([14](b06.xhtml#c14-endnote-14))
    加密历史学家Ralph E. Weber在他1979年出版的《*美国外交密码和暗号*》一书中描述了这些密码，但他无法解密Trist的所有信息，因为他不知道Trist所使用的书籍。^([15](b06.xhtml#c14-endnote-15))
    他只知道Trist的两个密码都是基于同一本书。
- en: A few years later, when cryptologist Stephen M. Matyas read Weber’s book, he
    decided to try to solve the mystery.^([16](b06.xhtml#c14-endnote-16)) Matyas observed
    that Trist mentioned a few facts about his key book in a letter, describing it
    as a small volume containing the dedication “To the British Nation.” He also mentioned
    that it was divided into at least two parts and was written by a person in Washington
    who had been sent to Spain as consul. In addition, Weber found out that the book’s
    text began with the words, “The study of foreign languages . . .”
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 几年后，当密码学家斯蒂芬·M·马特亚斯读到韦伯的书时，他决定尝试解决这个谜团。马特亚斯注意到特里斯在一封信中提到了他的关键书籍的一些事实，描述它是一本题为“致英国民族”的小册子。他还提到，它至少分为两个部分，是由一位被派往西班牙担任领事的华盛顿人写的。此外，韦伯发现这本书的文本以“外语学习…”开头。
- en: To identify the author of Trist’s key book, Matyas compiled a list of all people
    who had been sent from Washington to Spain or a Spanish colony as a consul. The
    final list contained approximately fifty people, many of whom, surprisingly, had
    published books. After some research, Matyas identified a man named José Borras
    as the most promising candidate. Borras, a US consul in Barcelona, had published
    a book titled *True Principles of the Spanish Language* in 1827\. This book fit
    with the description, especially because it dealt with a foreign language.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确认特里斯的主要作品的作者，马特亚斯编制了一份所有从华盛顿派往西班牙或西班牙殖民地担任领事的人员名单。最终名单包括大约五十人，其中许多人令人惊讶地出版了书籍。经过一番调查，马特亚斯确定了一个名叫何塞·博拉斯的最有希望的候选人。博拉斯是巴塞罗那的美国领事，在1827年出版了一本名为《西班牙语的真实原理》的书。这本书符合描述，特别是因为涉及外语。
- en: Matyas managed to locate a copy of the book in the Newberry Library in Chicago,
    and it did indeed contain the dedication and starting words he was looking for.
    With a bit more work, the mystery was solved, and Nicholas Trist’s correspondence
    could be deciphered. For examples, see the beginning of this chapter.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 马特亚斯设法在芝加哥的纽伯瑞图书馆找到了这本书的一本副本，它确实包含了他寻找的致辞和开头词。经过一些工作，谜团解开了，尼古拉斯·特里斯的通信得以解密。详见本章开头的例子。
- en: How William Friedman broke a Hindu conspiracy encryption
  id: totrans-171
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 威廉·弗里德曼如何破解印度阴谋加密
- en: During World War I, Hindu groups in India began a rebellion against their British
    colonizers, and certain members of these groups operated from the United States
    to deliver arms and logistical support. The US authorities treated the Hindu conspirators
    as criminals violating weapons laws and planning a revolution against the British,
    who were considered friendly.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 第一次世界大战期间，印度的印度教团体开始反抗他们的英国殖民者，这些团体的某些成员从美国运送武器和后勤支持。美国当局将这些印度阴谋者视为违反武器法的罪犯，并计划对友好的英国进行革命。
- en: In 1917, a Scotland Yard representative in the United States forwarded to William
    Friedman a stack of encrypted correspondence that had been intercepted from Hindu
    conspirators. At the time, Friedman’s codebreaking career had just begun.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 1917年，英国苏格兰场的一名代表将从印度阴谋者那里截获的一叠加密信件转发给威廉·弗里德曼。当时，弗里德曼的破译生涯刚刚开始。
- en: Along with the letters, the representative provided Friedman with a list of
    suspects, the names of whom he could use as cribs. Unfortunately, neither the
    correspondence nor the suspects’ names have ever been published. The only available
    information about this story (as far as we know) comes from a 1920 report by Friedman
    himself^([17](b06.xhtml#c14-endnote-17)) and a short treatise contained in the
    1996 edition of David Kahn’s book *The Codebreakers*.^([18](b06.xhtml#c14-endnote-18))
    Neither of these provides much information about the content of the encrypted
    messages.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 代表除了这些信件外，还向弗里德曼提供了一份嫌疑人名单，他可以用作破译的线索。不幸的是，这些信件和嫌疑人的名字从未被公开。关于这个故事的唯一可用信息（据我们所知）来自弗里德曼自己的1920年报告和1996年戴维·卡恩书籍《密码破译者》的短文。这两者都没有提供关于加密消息内容的详细信息。
- en: According to Friedman’s report, the encrypted letters consisted of a series
    of numbers in groups of three, such as `7-11-3`, `8-5-6`, and `3-9-15`. After
    preliminary study, Friedman concluded that he was dealing with a book cipher.
    Each figure group seemed to refer to a page, line, and letter position in a certain
    book. For instance, `7-11-3` represented the third letter in line 11 on page 7.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 根据弗里德曼的报告，密文由一系列按三组数字分组的数字组成，如 `7-11-3`、`8-5-6` 和 `3-9-15`。经过初步研究，弗里德曼得出结论，他正在处理的是一本书的密码。每个数字组似乎指向一本书中的页面、行和字母位置。例如，`7-11-3`
    表示第7页第11行中的第3个字母。
- en: Friedman had no idea which book the conspirators might have used. However, he
    realized that they had not applied their encryption method properly, as only the
    more important parts of the messages were encrypted. The parts left in cleartext
    provided Friedman with helpful hints regarding what the message was about. The
    ciphertext was also presented with word breaks, revealing the lengths of the words,
    and the senders chose the same number groupings to represent certain letters again
    and again, although it would have been more secure to refer to different pages,
    lines, and positions to encode the same character.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 弗里德曼不知道阴谋者可能使用了哪本书。然而，他意识到他们没有正确应用加密方法，因为只有消息中较重要的部分被加密了。那些保留为明文的部分给了弗里德曼一些有用的线索，帮助他推测消息内容。密文也以单词间断的方式呈现，揭示了单词的长度，而发送者则反复选择相同的数字组合来代表某些字母，尽管如果选择不同的页面、行和位置来编码相同的字符会更安全。
- en: Another poor technique used by the conspirators was consecutive sequences, such
    as `7-11-3`, `7-11-4`, `7-11-5`, and `7-11-6`, which revealed that a certain word
    or word part appeared in both the plaintext and the book. For example, the conspirators
    might have encrypted the plaintext word `APPLE` using the word `APPLE` in the
    key book, meaning the ciphertext numbers would have all been consecutive. Moreover,
    the senders often preferred the first appearance of a letter in a line, so frequent
    letters typically received low numbers while the rare ones were represented by
    higher numbers.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 阴谋者使用的另一种糟糕技术是连续的数字序列，如 `7-11-3`、`7-11-4`、`7-11-5` 和 `7-11-6`，这揭示了某个单词或单词的一部分同时出现在明文和书中。例如，阴谋者可能使用密钥书中的单词
    `APPLE` 来加密明文单词 `APPLE`，这意味着密文中的数字会是连续的。此外，发送者通常喜欢选择某一行中某个字母的首次出现，因此频繁出现的字母通常会获得较低的数字，而稀有的字母则用较高的数字表示。
- en: 'After considerable study, Friedman finally found a passage in one of the encrypted
    messages that appeared to represent the name of one of the suspects. We don’t
    know what this name was, but in his description of the incident, Kahn provides
    another example of a text fragment that Friedman could have guessed. Look at the
    following two encrypted words (each on a different line):'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 在经过大量研究后，弗里德曼终于在其中一条加密信息中找到了一个片段，看起来是某个嫌疑人的名字。我们并不知道这个名字是什么，但在事件的描述中，卡恩提供了另一个弗里德曼可能猜到的文本片段。请看以下两组加密词（每组在不同的行）：
- en: '![83-1-2 83-1-11 83-1-25 83-1-1 83-1-8 83-1-13 83-1-18 83-1-3 83-1-1 83-1-6[line
    break]83-1-3 83-1-6](image_fi/502727c14/two-line-equation.png)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![83-1-2 83-1-11 83-1-25 83-1-1 83-1-8 83-1-13 83-1-18 83-1-3 83-1-1 83-1-6[line
    break]83-1-3 83-1-6](image_fi/502727c14/two-line-equation.png)'
- en: If we number each letter based on its order of appearance, then the letters
    in these two words form the pattern `1234567849 89`. Note that the characters
    `4`, `8`, and `9` are repeated; with modern cryptanalytic tools, this pattern
    could be solved quite quickly. Friedman noticed that the third character in the
    sequence, which appears in the ciphertext as `83-1-25`, has a higher number than
    the other characters, indicating that it was probably the twenty-fifth letter
    of a line in the book. Friedman suspected that this was a rare letter; otherwise,
    the position number would have been lower. Through a mixture of persistence, intuition,
    and luck, he was able to determine that the letter was `V` and that these two
    words were `REVOLUTION IN`.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们根据字母出现的顺序为每个字母编号，那么这两组词的字母组成了 `1234567849 89` 的模式。注意，字符 `4`、`8` 和 `9` 被重复了；如果使用现代的密码分析工具，这个模式可以很快被破解。弗里德曼注意到序列中的第三个字符，在密文中表示为
    `83-1-25`，它的编号比其他字符高，表明它可能是书中某一行的第25个字母。弗里德曼怀疑这是一个罕见的字母；否则，位置编号会更低。通过坚持不懈的努力、直觉和一点运气，他终于确定这个字母是
    `V`，而这两组词是 `REVOLUTION IN`。
- en: 'Friedman later wrote:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 弗里德曼后来写道：
- en: From this, fragment by fragment, the plaintext of the messages was constructed,
    and not only the plaintext of the message, but we could state with reasonable
    certainty that on page so-and-so of the unknown book used, line so-and-so of that
    page, appeared the word “Germany.” In another page and line, “government,” and
    elsewhere, “constitution” and the like. From such evidence as that, we deduced
    that the subject matter of this unknown book was political economy.
  id: totrans-182
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 从中，我们逐步重建了消息的明文，不仅是消息的明文，而且我们可以相当确定地说，某本未知书籍的某页、某行上出现了“德国”一词。在另一页和另一行上，则出现了“政府”，而在其他地方则是“宪法”等类似词汇。凭借这样的证据，我们推断出这本未知书籍的主题是政治经济学。
- en: As the trial of the conspirators grew near, the Department of Justice told Friedman
    that they would find it helpful to know the title of the key book in order to
    convince the jury that the messages had been correctly decrypted. Friedman and
    his team consulted book dealers throughout the United States and England, asking
    for a book about political economy that contained certain words at certain positions.
    When the trial opened, however, the book had not been identified.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 随着阴谋者的审判临近，司法部告诉弗里德曼，他们认为了解关键书籍的书名将有助于说服陪审团相信消息已经被正确解密。弗里德曼和他的团队联系了美国和英国的书商，询问是否有一本政治经济学的书，书中某些特定位置有特定的词汇。然而，当审判开始时，书籍仍未被确定。
- en: 'Friedman prepared to explain the cipher in court without referencing the book
    used—and then, while staying in a Chicago hotel, waiting for his testimony to
    be scheduled, he happened to walk past McClurg’s, Chicago’s biggest bookstore.
    Rummaging through the political economy section, he found himself holding the
    book he’d been searching for: *Germany and the Germans*, by Price Collier (1913).
    The mystery was solved just in time.'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 弗里德曼准备在法庭上解释这个密码，而不引用所使用的书籍——然后，在芝加哥的一家酒店里，他正等待安排作证的时间时，偶然走过了芝加哥最大书店McClurg's。翻阅政治经济学部分时，他发现自己手中拿着他一直在寻找的书：《德国与德国人》，作者Price
    Collier（1913年）。谜团终于在最后时刻解开。
- en: When Friedman double-checked his work against the book, he found out that over
    95% of his results were correct. Our sources don’t mention how Friedman’s testimony
    was received, but we know that quite a few of the Hindu conspirators were found
    guilty. This was the first major codebreaking success of Friedman’s career. Many
    others would follow.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 当弗里德曼再次核对他的工作与书籍时，他发现自己95%以上的结果是正确的。我们的资料没有提到弗里德曼的证词是如何被接受的，但我们知道，许多印度阴谋者被判有罪。这是弗里德曼职业生涯中的第一次重大破译成功，之后他还有许多类似的成就。
- en: A dictionary code message sent to Robert E. Lee
  id: totrans-186
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 发送给罗伯特·E·李的字典密码消息
- en: '[Figure 14-4](#figure14-4) shows an encrypted note sent to Civil War general
    Robert E. Lee in 1862.^([19](b06.xhtml#c14-endnote-19)) (We found it on the Civil
    War Day by Day website created by the Louis Round Wilson Special Collections Library
    at the University of North Carolina, Chapel Hill,^([20](b06.xhtml#c14-endnote-20))
    and on Satoshi Tomokiyo’s Cryptiana website.^([21](b06.xhtml#c14-endnote-21)))The
    encrypted part of this message consists of units, each of which is composed of
    a number, a letter (`L`, `M`, or `R`), and another number.'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: '[图14-4](#figure14-4)展示了一封1862年发送给美国内战将领罗伯特·E·李的加密便条。^([19](b06.xhtml#c14-endnote-19))（我们在北卡罗来纳大学教堂山分校路易斯·朗德·威尔逊特藏图书馆创建的《美国内战日记》网站上找到了这份文件，^([20](b06.xhtml#c14-endnote-20))
    也在佐藤智清的Cryptiana网站上找到了这份文件。^([21](b06.xhtml#c14-endnote-21)))该消息的加密部分由若干单元组成，每个单元由一个数字、一个字母（`L`、`M`或`R`）和另一个数字构成。'
- en: '![](image_fi/502727c14/f14004.png)'
  id: totrans-188
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/502727c14/f14004.png)'
- en: 'Figure 14-4: This message sent to Robert E. Lee is encrypted with a dictionary
    code.'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 图14-4：这条发送给罗伯特·E·李的消息使用了字典密码加密。
- en: 'Here’s a transcript of the encrypted note provided by crypto-hobbyists David
    Allen Wilson and Thomas Bosbach:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是由密码爱好者David Allen Wilson和Thomas Bosbach提供的加密便条的文字记录：
- en: '`31\. August 2017`'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: '`2017年8月31日`'
- en: '`General R.E. Lee April 8th 1862`'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: '`罗伯特·E·李将军 1862年4月8日`'
- en: '`There are 45 R 1 here for 174 R 16 40 M 10\. 228 L 33\. More to 108 L 13\.
    250 R 18 of them, 153 R 22 239 L 29\. Will 157 R 17\. Can not the government 195
    R 11 45 R 1 for the 176 M 23 250 R 18? I hope enough for 174 R 16 40 M 10 will
    56 L 26 to-Morrow.`'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: '`这里有45个R 1，对应174个R 16 40 M 10\. 228 L 33\. 更多的是108 L 13\. 250 R 18，其中153 R
    22 239 L 29\. 将会157 R 17\. 政府能否为176 M 23 250 R 18提供195 R 11 45 R 1? 我希望174 R 16
    40 M 10能在明天56 L 26之前足够。`'
- en: '`J.E. Johnston`'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: '`J.E. Johnston`'
- en: The most likely explanation for this pattern is that the ciphertext passages
    are encrypted using a dictionary code, with the first number of each unit standing
    for the page, the letter for the column (left, middle, or right), and the second
    number for the line. The book, maybe an English dictionary, has at least 250 pages
    and thirty-three lines per page.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 这种模式最可能的解释是，这些密文段落使用了字典密码加密，每个单元的第一个数字代表页码，字母代表列（左、中或右），第二个数字代表行。该书可能是一本至少有250页，每页有三十三行的英文字典。
- en: Above some of the units, somebody has already written what appears to be proposed
    plaintext representations. For instance, `45 R 1` is decrypted to `ARMS`, while
    `228 L 33` allegedly stands for `ROUTE`. Are these decryptions correct? If so,
    why did the author only decrypt some of the words? Does that second sentence,
    starting with `ROUTE MORE TO`, even make sense? And is it plausible that the word
    `ARMS` is listed on page 45 of a 250-page dictionary, which might only have a
    few pages of words starting with the letter *A*? It is possible that the cipher
    involves additional tricks, like adding a number to the page number, but the encryption
    systems popular during the Civil War are generally not known to be so sophisticated.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 在一些单元的上方，已经有人写下了似乎是提议的明文表示。例如，`45 R 1` 被解密为 `ARMS`，而 `228 L 33` 显然代表 `ROUTE`。这些解密正确吗？如果正确，为什么作者只解密了部分单词？那个以
    `ROUTE MORE TO` 开头的第二个句子是否有意义？而且，`ARMS` 这个词出现在一本250页的字典的第45页上是否合理？这本字典可能只有几页是以字母*A*开头的单词。可能这个密码涉及更多技巧，比如将数字加到页码上，但美国内战期间流行的加密系统通常并不复杂到这种程度。
- en: 'Klaus didn’t know the answers to these questions when he introduced this encrypted
    message on his *Cipherbrain* blog in 2017\. Several readers searched for a dictionary
    that could make sense of the ciphertext sections. This search was simplified by
    the requirements, as there weren’t too many English dictionaries published around
    the 1860s with three columns per page and about 250 pages. Finally, a reader nicknamed
    Davidsch found it: the *Noah Webster, William Greenleaf Webster Dictionary* from
    1857\. It immediately became clear that the alleged plaintext representations
    noted above some of the ciphertext units were wrong.'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 克劳斯在2017年于他的*Cipherbrain*博客上发布这段加密信息时，并不知道这些问题的答案。几位读者开始寻找可以解释密文部分的字典。这项搜索被简化了，因为在1860年代出版的英文字典并不多，这些字典每页有三列，大约250页。最终，一位昵称为Davidsch的读者找到了它：1857年版的*诺亚·韦伯斯特，威廉·格林利夫·韦伯斯特字典*。很快就清楚了，上述一些密文单元所标注的疑似明文表示是错误的。
- en: 'Using the dictionary, blog reader Thomas Bosbach soon provided the following
    decryption of the message (the plaintext decryptions are in parentheses):'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 使用字典后，博客读者托马斯·博斯巴赫很快提供了以下信息的解密（明文解密部分括在括号内）：
- en: '`There are 45R1 (cars) here for 174R16 (one) 40M10 (brigade). 228L33 (six)
    more to 108L13 (follow). 250R18 (three) of them, 153R22 (long-) 239L29 (street)
    will 157R17 (march). Can not the government 195R11 (procure) 45R1 (cars) for the
    176M23 (other) 250R18 (three)? I hope enough for 174R14 (one) 40M10 (brigade)
    will 56L26 (come) to-morrow.`'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: '`这里有45R1（汽车）用于174R16（一个）40M10（旅）。228L33（六个）更多的到108L13（跟随）。250R18（三个）他们，153R22（长）239L29（街道）将157R17（行进）。政府不能为176M23（其他）250R18（三个）购买45R1（汽车）吗？我希望足够的174R14（一个）40M10（旅）将56L26（明天）到来。`'
- en: Challenges
  id: totrans-200
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 挑战
- en: Dan Brown’s book cipher challenge
  id: totrans-201
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 丹·布朗的书籍密码挑战
- en: 'In the lower-right corner of the back cover of Dan Brown’s bestselling 2003
    novel *The Da Vinci Code*, a darkly printed circular pattern can be seen:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 在丹·布朗2003年畅销小说*达·芬奇密码*的封底右下角，可以看到一个深色印刷的圆形图案：
- en: '![](image_fi/502727c14/g14002.png)'
  id: totrans-203
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/502727c14/g14002.png)'
- en: 'Here’s a transcript:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是转录内容：
- en: '`20 11 11 68 • 1 10 11 61 15 • 5 8 73 11 •`'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: '`20 11 11 68 • 1 10 11 61 15 • 5 8 73 11 •`'
- en: Each number refers to the first letter in the respective chapter of the novel.
    (For those readers who do not have the book, we provide this information at [https://codebreaking-guide.com/challenges/](https://codebreaking-guide.com/challenges/).)
    When rearranged correctly, the letters spell out a Latin sentence representing
    a motto of the United States.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 每个数字都对应于小说中相应章节的第一个字母。（对于那些没有这本书的读者，我们提供了此信息 [https://codebreaking-guide.com/challenges/](https://codebreaking-guide.com/challenges/)。）当正确排列时，这些字母拼出了一个拉丁语句子，代表了美国的座右铭。
- en: A dictionary code challenge
  id: totrans-207
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 字典密码挑战
- en: 'In 2018, Klaus introduced a dictionary code challenge on his blog.^([22](b06.xhtml#c14-endnote-22))
    To create his dictionary, he first looked for a text file containing the 10,000
    most popular words, acronyms, and initialisms of the English language, and then
    he made a few changes (adding words such as “ZZTOP,” deleting a few others, and
    so on) in order to foil any codebreaker trying to guess which file he had used.
    Next, he sorted the words alphabetically in a spreadsheet. The resulting list
    became his codebook, with each word referenced by its position in the list. Here
    are the start and the end of the list:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 2018年，克劳斯在他的博客上发布了一个字典编码挑战。^([22](b06.xhtml#c14-endnote-22)) 为了创建他的字典，他首先寻找了一份包含10,000个最流行的英语单词、缩略语和首字母缩写的文本文件，然后进行了几处修改（比如添加了“ZZTOP”等单词，删除了一些其他的单词等），以防止任何密码破译者猜出他使用的文件。接着，他将单词按字母顺序排列在电子表格中。最终的列表成为了他的密码本，每个单词都有一个位置编号。以下是该列表的开头和结尾：
- en: '`0001: A`'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: '`0001: A`'
- en: '`0002: AAA`'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: '`0002: AAA`'
- en: '`0003: AAAA`'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: '`0003: AAAA`'
- en: '`0004: AACHEN`'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: '`0004: 亚琛`'
- en: '`0005: AARON`'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: '`0005: AARON`'
- en: '`0006: AATEAM`'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: '`0006: AATEAM`'
- en: '`0007: AB`'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: '`0007: AB`'
- en: '`0008: ABANDONED`'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: '`0008: 废弃`'
- en: '`0009: ABC`'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: '`0009: ABC`'
- en: '`0010: ABERDEEN`'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: '`0010: 阿伯丁`'
- en: '`. . .`'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: '`. . .`'
- en: '`9992: ZONING`'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: '`9992: 区域划分`'
- en: '`9993: ZOO`'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: '`9993: 动物园`'
- en: '`9994: ZOOM`'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: '`9994: 放大`'
- en: '`9995: ZOOPHILIA`'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: '`9995: 动物恋`'
- en: '`9996: ZOPE`'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: '`9996: ZOPE`'
- en: '`9997: ZSHOP`'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: '`9997: ZSHOP`'
- en: '`9998: ZSHOPS`'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: '`9998: ZSHOPS`'
- en: '`9999: ZUT`'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: '`9999: ZUT`'
- en: '`10000: ZZTOP`'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: '`10000: ZZTOP`'
- en: 'The word list contains not only full words and abbreviations but also the twenty-six
    letters of the alphabet. These are treated as ordinary words, which means, for
    instance, that `E` comes between `DYNAMICS` and `EACH`. If a word one wants to
    encrypt does not appear on the dictionary list, it can be encoded letter by letter.
    Using this codebook, Klaus encrypted a plaintext consisting of about seventy words,
    which resulted in the following ciphertext:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 该单词列表不仅包含完整的单词和缩写，还包括26个字母。这些字母被当作普通单词处理，例如，`E`排在`DYNAMICS`和`EACH`之间。如果想加密的单词不在字典列表中，可以逐字母进行编码。使用这个密码本，克劳斯加密了大约70个单词的明文，得到了以下密文：
- en: '`8456 0619 8928 6116 9216 5992 9061 1263 0001 5326 2272 2827 5884 1142 8993
    4906 8322 6163 8928 6841 6694 3564 8928 7658 6323 8928 1142 0212 0016 6207 4906
    8785 0001 5069 0371 9647 0307 8928 9652 0212 8192 4316 5602 9967 9804 7254 0001
    5385 4424 8928 1449 6163 4714 8949 4692 0001 8515 2212 6205 8928 7278 8131 6163
    4714 9967 9804 3458 0001 9861 1390 2012 0001 2546 8926 9804 4139 9967 9061 2365
    8928 5992 5589`'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: '`8456 0619 8928 6116 9216 5992 9061 1263 0001 5326 2272 2827 5884 1142 8993
    4906 8322 6163 8928 6841 6694 3564 8928 7658 6323 8928 1142 0212 0016 6207 4906
    8785 0001 5069 0371 9647 0307 8928 9652 0212 8192 4316 5602 9967 9804 7254 0001
    5385 4424 8928 1449 6163 4714 8949 4692 0001 8515 2212 6205 8928 7278 8131 6163
    4714 9967 9804 3458 0001 9861 1390 2012 0001 2546 8926 9804 4139 9967 9061 2365
    8928 5992 5589`'
- en: Blog reader Norbert Biermann solved this challenge on the same day. Can you
    do it, too?
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 博客读者诺伯特·比尔曼当天就解开了这个谜题。你也能做到吗？
- en: Unsolved cryptograms
  id: totrans-232
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 未解密的密码谜题
- en: Two encrypted newspaper advertisements from 1873
  id: totrans-233
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1873年的两则加密报纸广告
- en: In 1873, two encrypted newspaper ads were published in London’s *Daily Telegraph*.^([23](b06.xhtml#c14-endnote-23))^,
    ^([24](b06.xhtml#c14-endnote-24)) They are reproduced here. (Note that `TOUJOURS
    BLEU` is French for `ALWAYS BLUE`.)
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 1873年，两则加密的报纸广告在伦敦的*《每日电讯报》*上刊登。^([23](b06.xhtml#c14-endnote-23))^, ^([24](b06.xhtml#c14-endnote-24))
    它们在此被重现。（请注意，`TOUJOURS BLEU`是法语，意为`ALWAYS BLUE`。）
- en: '`1873-02-07`'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: '`1873-02-07`'
- en: '`TOUJOURS BLEU.–7.64\. 13,141\. 24.24\. 18,299\. 1,317 8,481X–1,274\. 32,561
    29,375 13,127 28,801\. 32,561\. 21,8 21,221X 28,59\. 39,629\. 28,59 39,629 29,544
    25,138 29,219 7,64X–29,219 17,77 6,582 1,384 16,243 29,219 19,367 8,226 18,176
    33,383X–36,547\. 8,39 2,379 2,4 27,609 32,561 9,324 21,367 9,629 28,59 12,361
    32,104 6,381 1,268 38,498 25,411 32,561 2,140X–1,268 14,527 33,212 38,616 8,335X–2,495
    3,379 20,320 32,561 29,422 1,257 24,24 24,485 40,618 1,268 40,338 15,198\. 21,367X–19,420
    2,407X–25,618 11,390 40,629 32,252 27,538X–18,411 10,422 2,185X–27,254 2,221X–40,204
    8,347 20,388 8,347 40,325 8,347 36,621 8,347 25,239 32,24 1,268 8,306 1,268 8,306
    1,268 5,58 40,629 5,19 5,19 4,386X 22,451 29,329 22,451X–12,262X 15,50 10,66X
    13,572 32,561 1,384 12,579 12,194 40,325X 8,347 7,518 12,629 29,219 26,106 1,624
    21,556X 40,238 16,438 2,555X.`'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: '`TOUJOURS BLEU.–7.64\. 13,141\. 24.24\. 18,299\. 1,317 8,481X–1,274\. 32,561
    29,375 13,127 28,801\. 32,561\. 21,8 21,221X 28,59\. 39,629\. 28,59 39,629 29,544
    25,138 29,219 7,64X–29,219 17,77 6,582 1,384 16,243 29,219 19,367 8,226 18,176
    33,383X–36,547\. 8,39 2,379 2,4 27,609 32,561 9,324 21,367 9,629 28,59 12,361
    32,104 6,381 1,268 38,498 25,411 32,561 2,140X–1,268 14,527 33,212 38,616 8,335X–2,495
    3,379 20,320 32,561 29,422 1,257 24,24 24,485 40,618 1,268 40,338 15,198\. 21,367X–19,420
    2,407X–25,618 11,390 40,629 32,252 27,538X–18,411 10,422 2,185X–27,254 2,221X–40,204
    8,347 20,388 8,347 40,325 8,347 36,621 8,347 25,239 32,24 1,268 8,306 1,268 8,306
    1,268 5,58 40,629 5,19 5,19 4,386X 22,451 29,329 22,451X–12,262X 15,50 10,66X
    13,572 32,561 1,384 12,579 12,194 40,325X 8,347 7,518 12,629 29,219 26,106 1,624
    21,556X 40,238 16,438 2,555X.`'
- en: '`1873-02-27`'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: '`1873-02-27`'
- en: '`ANTETYPE.–8.347, 20.388X 1.317, 12.269, 20.28, 10.622, 15.50, 2.495 8.481\.
    32.561\. 8.501X 1.268, 32,252, 12.455, 1.317, 8.226, 6.630 9.266, 2.4, 7.73X 24.627,
    32.561, 27.556, 31.302\. 28.185, 19.31X 25.264, 1.268, 32.252, 12.629, 29.219,
    2.555X 21.367, 9.629, 12.361, 15.50, 25.138X 1.268, 13.572, 35.562, 2.555X 1.268,
    8.306, 39.558, 11.606, 7.518X 40.204`'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: '`ANTETYPE.–8.347, 20.388X 1.317, 12.269, 20.28, 10.622, 15.50, 2.495 8.481\.
    32.561\. 8.501X 1.268, 32,252, 12.455, 1.317, 8.226, 6.630 9.266, 2.4, 7.73X 24.627,
    32.561, 27.556, 31.302\. 28.185, 19.31X 25.264, 1.268, 32.252, 12.629, 29.219,
    2.555X 21.367, 9.629, 12.361, 15.50, 25.138X 1.268, 13.572, 35.562, 2.555X 1.268,
    8.306, 39.558, 11.606, 7.518X 40.204`'
- en: Both ads mainly consist of number groups divided into two parts by a period
    or comma. The numbers before the period/comma are smaller than the ones after
    it, a pattern consistent with a book cipher. An expression such as `12.269` might
    stand for the 269th letter on page twelve of a certain book. The `X` at the end
    of some groups might mean that, instead of one letter, the group represents a
    whole word. Not much more is known about these two cryptograms.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 两个广告主要由数字组组成，这些数字组通过句点或逗号分为两部分。句点/逗号前的数字小于句点/逗号后的数字，这种模式与书籍密码一致。像`12.269`这样的表达可能代表某本书第十二页的第269个字母。某些数字组末尾的`X`可能意味着，该组代表一个完整的单词，而不仅仅是一个字母。目前对于这两个密码的了解并不多。
