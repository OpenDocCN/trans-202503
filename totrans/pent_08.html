<html><head></head><body><section class="chapter" epub:type="chapter" id="information_gathering-id00018" title="Chapter&#xA0;5.&#xA0;Information Gathering"><div class="titlepage"><div><div><h2 class="title">Chapter 5. Information Gathering</h2></div></div></div><p><a class="indexterm" id="iddle1509"/>In this chapter we begin the information-gathering phase of penetration testing. The goal of this phase is to learn as much about our clients as we can. Does the CEO reveal way too much on Twitter? Is the system administrator writing to archived listservs, asking about how to secure a Drupal install? What software are their web servers running? Are the Internet-facing systems listening on more ports than they should? Or, if this is an internal penetration test, what is the IP address of the domain controller?</p><p>We’ll also start to interact with our target systems, learning as much as we can about them without actively attacking them. We’ll use the knowledge gained in this phase to move on to the threat-modeling phase where we think like attackers and develop plans of attack based on the information <a class="indexterm" id="iddle1512"/><a class="indexterm" id="iddle1817"/><a class="indexterm" id="iddle1861"/>we’ve gathered. Based on the information we uncover, we’ll actively search for and verify vulnerabilities using vulnerability-scanning techniques, which are covered in the next chapter.</p><div class="sect1" title="Open Source Intelligence Gathering"><div class="titlepage"><div><div><h2 class="title" id="open_source_intelligence_gathering" style="clear: both">Open Source Intelligence Gathering</h2></div></div></div><p>We can learn a good deal about our client’s organization and infrastructure before we send a single packet their way, but information gathering can still be a bit of a moving target. It isn’t feasible to study the online life of every employee, and given a large amount of gathered information, it can be difficult to discern important data from noise. If the CEO tweets frequently about a favorite sports team, that team’s name may be the basis for her webmail password, but it could just as easily be entirely irrelevant. Other times it will be easier to pick up on something crucial. For instance, if your client has online job postings for a system administrator who is an expert in certain software, chances are those platforms are deployed in the client’s infrastructure.</p><p>As opposed to intelligence gained from covert sources such as dumpster diving, dumping website databases, and social engineering, <span class="emphasis"><em>open source intelligence</em></span> (or <span class="emphasis"><em>OSINT</em></span>) is gathered from legal sources like public records and social media. The success of a pentest often depends on the results of the information-gathering phase, so in this section, we will look at a few tools to obtain interesting information from these public sources.</p><div class="sect2" title="Netcraft"><div class="titlepage"><div><div><h3 class="title" id="netcraft">Netcraft</h3></div></div></div><p>Sometimes the information that web servers and web-hosting companies gather and make publicly available can tell you a lot about a website. For instance, a company called Netcraft logs the uptime and makes queries about the underlying software. (This information is made publicly available at <span class="emphasis"><em><a class="ulink" href="http://www.netcraft.com/" target="_top">http://www.netcraft.com/</a></em></span>.) Netcraft also provides other services, and their antiphishing offerings are of particular interest to information security.</p><p>For example, <a class="xref" href="ch05.xhtml#netcraftapostrophes_results_for_bulbsecu" title="Figure 5-1. Netcraft’s results for bulbsecurity.com">Figure 5-1</a> shows the result when we query <span class="emphasis"><em><a class="ulink" href="http://www.netcraft.com/" target="_top">http://www.netcraft.com/</a></em></span> for <span class="emphasis"><em><a class="ulink" href="http://www.bulbsecurity.com" target="_top">http://www.bulbsecurity.com</a></em></span>. As you can see, <span class="emphasis"><em>bulbsecurity.com</em></span> was first seen in March 2012. It was registered through GoDaddy, has an IP address of 50.63.212.1, and is running Linux with an Apache web server.</p><p>Armed with this information, when pentesting <span class="emphasis"><em>bulbsecurity.com</em></span>, we could start by ruling out vulnerabilities that affect only Microsoft IIS servers. Or, if we wanted to try social engineering to get credentials to the website, we could write an email that appears to be from GoDaddy, asking the administrator to log in and check some security settings.</p><div class="figure"><a id="netcraftapostrophes_results_for_bulbsecu"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00058"/><img alt="Netcraft’s results for bulbsecurity.com" src="httpatomoreillycomsourcenostarchimages2030306.png.jpg"/></div></div><div class="figure-title">Figure 5-1. Netcraft’s results for bulbsecurity.com</div></div></div><div class="sect2" title="Whois Lookups"><div class="titlepage"><div><div><h3 class="title" id="whois_lookups">Whois Lookups</h3></div></div></div><p><a class="indexterm" id="iddle1286"/><a class="indexterm" id="iddle1864"/><a class="indexterm" id="iddle2455"/>All domain registrars keep records of the domains they host. These records contain information about the owner, including contact information. For example, if we run the Whois command line tool on our Kali machine to query for information about <span class="emphasis"><em>bulbsecurity.com</em></span>, as shown in <a class="xref" href="ch05.xhtml#whois_information_for_bulbsecuritydotcom" title="Example 5-1. Whois information for bulbsecurity.com">Example 5-1</a>, we see that I used private registration, so we won’t learn much.</p><div class="example"><a id="whois_information_for_bulbsecuritydotcom"/><div class="example-title">Example 5-1. Whois information for bulbsecurity.com</div><div class="example-contents"><pre class="programlisting">root@kali:~# <span class="strong"><strong>whois bulbsecurity.com</strong></span>&#13;
  Registered through: GoDaddy.com, LLC (http://www.godaddy.com)&#13;
   Domain Name: BULBSECURITY.COM&#13;
      Created on: 21-Dec-11&#13;
      Expires on: 21-Dec-12&#13;
      Last Updated on: 21-Dec-11&#13;
&#13;
   Registrant: ❶&#13;
   Domains By Proxy, LLC&#13;
   DomainsByProxy.com&#13;
   14747 N Northsight Blvd Suite 111, PMB 309&#13;
   Scottsdale, Arizona 85260&#13;
   United States&#13;
&#13;
   Technical Contact: ❷&#13;
      Private, Registration  BULBSECURITY.COM@domainsbyproxy.com&#13;
      Domains By Proxy, LLC&#13;
      DomainsByProxy.com&#13;
      14747 N Northsight Blvd Suite 111, PMB 309&#13;
      Scottsdale, Arizona 85260&#13;
      United States&#13;
      (480) 624-2599      Fax -- (480) 624-2598&#13;
&#13;
   Domain servers in listed order:&#13;
      NS65.DOMAINCONTROL.COM ❸&#13;
      NS66.DOMAINCONTROL.COM</pre></div></div><p><a class="indexterm" id="iddle1275"/><a class="indexterm" id="iddle1283"/><a class="indexterm" id="iddle1849"/><a class="indexterm" id="iddle1859"/>This site has private registration, so both the registrant ❶ and technical contact ❷ are domains by proxy. Domains by proxy offer private registration, hiding your personal details in the Whois information for the domains you own. However, we do see the domain servers ❸ for <span class="emphasis"><em>bulbsecurity.com</em></span>.</p><p>Running Whois queries against other domains will show more interesting results. For example, if you do a Whois lookup on <span class="emphasis"><em>georgiaweidman.com</em></span>, you might get an interesting blast from the past, including my college phone number.</p></div><div class="sect2" title="DNS Reconnaissance"><div class="titlepage"><div><div><h3 class="title" id="dns_reconnaissance">DNS Reconnaissance</h3></div></div></div><p>We can also use Domain Name System (DNS) servers to learn more about a domain. DNS servers translate the human-readable URL <span class="emphasis"><em><a class="ulink" href="http://www.bulbsecurity.com" target="_top">www.bulbsecurity.com</a></em></span> into an IP address.</p><div class="sect3" title="Nslookup"><div class="titlepage"><div><div><h4 class="title" id="nslookup">Nslookup</h4></div></div></div><p>For example, we could use a command line tool such as Nslookup, as shown in <a class="xref" href="ch05.xhtml#nslookup_information_for_wwwdotbulbsecur" title="Example 5-2. Nslookup information for www.bulbsecurity.com">Example 5-2</a>.</p><div class="example"><a id="nslookup_information_for_wwwdotbulbsecur"/><div class="example-title">Example 5-2. Nslookup information for www.bulbsecurity.com</div><div class="example-contents"><pre class="programlisting">root@Kali:~# <span class="strong"><strong>nslookup www.bulbsecurity.com</strong></span>&#13;
Server:    75.75.75.75&#13;
Address:   75.75.75.75#53&#13;
&#13;
Non-authoritative answer:&#13;
www.bulbsecurity.com    canonical name = bulbsecurity.com.&#13;
Name:    bulbsecurity.com&#13;
Address: 50.63.212.1 ❶</pre></div></div><p>Nslookup returned the IP address of <span class="emphasis"><em><a class="ulink" href="http://www.bulbsecurity.com" target="_top">www.bulbsecurity.com</a></em></span>, as you can see at ❶.</p><p>We can also tell Nslookup to find the mail servers for the same website by looking for MX records (DNS speak for email), as shown in <a class="xref" href="ch05.xhtml#nslookup_information_for_bulbsecuritydot" title="Example 5-3. Nslookup information for bulbsecurity.com’s mail servers">Example 5-3</a>.</p><div class="example"><a id="nslookup_information_for_bulbsecuritydot"/><div class="example-title">Example 5-3. Nslookup information for bulbsecurity.com’s mail servers</div><div class="example-contents"><pre class="programlisting">root@kali:~# <span class="strong"><strong>nslookup</strong></span>&#13;
&gt; <span class="strong"><strong>set type=mx</strong></span>&#13;
&gt; <span class="strong"><strong>bulbsecurity.com</strong></span>&#13;
Server:    75.75.75.75&#13;
Address:   75.75.75.75#53&#13;
&#13;
Non-authoritative answer:&#13;
bulbsecurity.com    mail exchanger = 40 ASPMX2.GOOGLEMAIL.com.&#13;
bulbsecurity.com    mail exchanger = 20 ALT1.ASPMX.L.GOOGLE.com.&#13;
bulbsecurity.com    mail exchanger = 50 ASPMX3.GOOGLEMAIL.com.&#13;
bulbsecurity.com    mail exchanger = 30 ALT2.ASPMX.L.GOOGLE.com.&#13;
bulbsecurity.com    mail exchanger = 10 ASPMX.L.GOOGLE.com.</pre></div></div><p><a class="indexterm" id="iddle1284"/><a class="indexterm" id="iddle1478"/><a class="indexterm" id="iddle1480"/><a class="indexterm" id="iddle2553"/>Nslookup says <span class="emphasis"><em>bulbsecurity.com</em></span> is using Google Mail for its email servers, which is correct because I use Google Apps.</p></div><div class="sect3" title="Host"><div class="titlepage"><div><div><h4 class="title" id="host">Host</h4></div></div></div><p>Another utility for DNS queries is Host. We can ask Host for the name-servers for a domain with the command <code class="literal">host -t ns</code> <span class="emphasis"><em><code class="literal">domain</code></em></span>. A good example for domain queries is <span class="emphasis"><em>zoneedit.com</em></span>, a domain set up to demonstrate zone transfer vulnerabilities, as shown here.</p><a id="pro_id00084"/><pre class="programlisting">root@kali:~# <span class="strong"><strong>host -t ns zoneedit.com</strong></span>&#13;
zoneedit.com name server ns4.zoneedit.com.&#13;
zoneedit.com name server ns3.zoneedit.com.&#13;
--<span class="emphasis"><em>snip</em></span>--</pre><p>This output shows us all the DNS servers for <span class="emphasis"><em>zoneedit.com</em></span>. Naturally, because I mentioned that this domain was set up to demonstrate zone transfers, that’s what we are going to do next.</p></div><div class="sect3" title="Zone Transfers"><div class="titlepage"><div><div><h4 class="title" id="zone_transfers">Zone Transfers</h4></div></div></div><p>DNS zone transfers allow name servers to replicate all the entries about a domain. When setting up DNS servers, you typically have a primary name server and a backup server. What better way to populate all the entries in the secondary DNS server than to query the primary server for all of its entries?</p><p>Unfortunately, many system administrators set up DNS zone transfers insecurely, so that anyone can transfer the DNS records for a domain. <span class="emphasis"><em>zoneedit.com</em></span> is an example of such a domain, and we can use the <code class="literal">host</code> command to download all of its DNS records. Use the <code class="literal">-l</code> option to specify the domain to transfer, and choose one of the name servers from the previous command, as shown in <a class="xref" href="ch05.xhtml#zone_transfer_of_zoneeditdotcom" title="Example 5-4. Zone transfer of zoneedit.com">Example 5-4</a>.</p><div class="example"><a id="zone_transfer_of_zoneeditdotcom"/><div class="example-title">Example 5-4. Zone transfer of zoneedit.com</div><div class="example-contents"><pre class="programlisting">root@kali:~# <span class="strong"><strong>host -l zoneedit.com ns2.zoneedit.com</strong></span>&#13;
Using domain server:&#13;
Name: ns2.zoneedit.com&#13;
Address: 69.72.158.226#53&#13;
Aliases:&#13;
&#13;
zoneedit.com name server ns4.zoneedit.com.&#13;
zoneedit.com name server ns3.zoneedit.com.&#13;
zoneedit.com name server ns15.zoneedit.com.&#13;
zoneedit.com name server ns8.zoneedit.com.&#13;
zoneedit.com name server ns2.zoneedit.com.&#13;
zoneedit.com has address 64.85.73.107&#13;
www1.zoneedit.com has address 64.85.73.41&#13;
dynamic.zoneedit.com has address 64.85.73.112&#13;
bounce.zoneedit.com has address 64.85.73.100&#13;
--<span class="emphasis"><em>snip</em></span>--&#13;
mail2.zoneedit.com has address 67.15.232.182&#13;
--<span class="emphasis"><em>snip</em></span>--</pre></div></div><p><a class="indexterm" id="iddle1324"/><a class="indexterm" id="iddle1863"/><a class="indexterm" id="iddle2301"/><a class="indexterm" id="iddle2346"/>There are pages and pages of DNS entries for <span class="emphasis"><em>zoneedit.com</em></span>, which gives us a good idea of where to start in looking for vulnerabilities for our pentest. For example, <span class="emphasis"><em>mail2.zoneedit.com</em></span> is probably a mail server, so we should look for potentially vulnerable software running on typical email ports such as 25 (Simple Mail Transfer Protocol) and 110 (POP3). If we can find a webmail server, any usernames we find may lead us in the right direction so that we can guess passwords and gain access to sensitive company emails.</p></div></div><div class="sect2" title="Searching for Email Addresses"><div class="titlepage"><div><div><h3 class="title" id="searching_for_email_addresses">Searching for Email Addresses</h3></div></div></div><p>External penetration tests often find fewer services exposed than internal ones do. A good security practice is to expose only those services that must be accessed remotely, like web servers, mail servers, VPN servers, and maybe SSH or FTP, and only those services that are mission critical. Services like these are common attack surfaces, and unless employees use two-factor authentication, accessing company webmail can be simple if an attacker can guess valid credentials.</p><p>One excellent way to find usernames is by looking for email addresses on the Internet. You might be surprised to find corporate email addresses publicly listed on parent-teacher association contact info, sports team rosters, and, of course, social media.</p><p>You can use a Python tool called theHarvester to quickly scour thousands of search engine results for possible email addresses. theHarvester can automate searching Google, Bing, PGP, LinkedIn, and others for email addresses. For example, in <a class="xref" href="ch05.xhtml#running_theharvester_against_bulbsecurit" title="Example 5-5. Running theHarvester against bulbsecurity.com">Example 5-5</a>, we’ll look at the first 500 results in all search engines for <span class="emphasis"><em>bulbsecurity.com</em></span>.</p><div class="example"><a id="running_theharvester_against_bulbsecurit"/><div class="example-title">Example 5-5. Running theHarvester against bulbsecurity.com</div><div class="example-contents"><pre class="programlisting">root@kali:~# <span class="strong"><strong>theharvester -d bulbsecurity.com -l 500 -b all</strong></span>&#13;
&#13;
*******************************************************************&#13;
*                                                                 *&#13;
* | |_| |__   ___    /\  /\__ _ _ ____   _____  ___| |_ ___ _ __  *&#13;
* | __| '_ \ / _ \  / /_/ / _` | '__\ \ / / _ \/ __| __/ _ \ '__| *&#13;
* | |_| | | |  __/ / __  / (_| | |   \ V /  __/\__ \ ||  __/ |    *&#13;
*  \__|_| |_|\___| \/ /_/ \__,_|_|    \_/ \___||___/\__\___|_|    *&#13;
*                                                                 *&#13;
* TheHarvester Ver. 2.2a                                          *&#13;
* Coded by Christian Martorella                                   *&#13;
* Edge-Security Research                                          *&#13;
* cmartorella@edge-security.com                                   *&#13;
*******************************************************************&#13;
&#13;
Full harvest..&#13;
[-] Searching in Google..&#13;
    Searching 0 results...&#13;
    Searching 100 results...&#13;
    Searching 200 results...&#13;
    Searching 300 results...&#13;
--<span class="emphasis"><em>snip</em></span>--&#13;
&#13;
 [+] Emails found:&#13;
------------------&#13;
georgia@bulbsecurity.com&#13;
&#13;
[+] Hosts found in search engines:&#13;
------------------------------------&#13;
50.63.212.1:www.bulbsecurity.com&#13;
&#13;
--<span class="emphasis"><em>snip</em></span>--</pre></div></div><p><a class="indexterm" id="iddle1659"/><a class="indexterm" id="iddle1860"/>There’s not too much to be found for <span class="emphasis"><em>bulbsecurity.com</em></span>, but theHarvester does find my email address, <span class="emphasis"><em>georgia@bulbsecurity.com</em></span>, and the website, <span class="emphasis"><em><a class="ulink" href="http://www.bulbsecurity.com" target="_top">www.bulbsecurity.com</a></em></span>, as well as other websites I share virtual hosting with. You may find more results if you run theHarvester against your organization.</p></div><div class="sect2" title="Maltego"><div class="titlepage"><div><div><h3 class="title" id="maltego">Maltego</h3></div></div></div><p>Paterva’s Maltego is a data-mining tool designed to visualize open source intelligence gathering. Maltego has both a commercial and a free community edition. The free Kali Linux version, which we’ll use in this book, limits the results it returns, but we can still use it to gather a good deal of interesting information very quickly. (The paid version offers more results and functionality. To use Maltego on your pentests, you will need a paid license.)</p><div class="note" title="Note"><h3 class="title"><a id="ch05note01"/>Note</h3><p>Feel free to use Maltego to study other Internet footprints, including your own, your company’s, your high school arch nemesis’s, and so on. Maltego uses information publicly available on the Internet, so it is perfectly legal to do reconnaissance on any entity.</p></div><p>To run Maltego, enter <span class="strong"><strong><code class="literal">maltego</code></strong></span> at the command line. The Maltego GUI should launch. You will be prompted to create a free account at the Paterva website and log in. Once logged in, choose <span class="strong"><strong>Open a blank graph and let me play around</strong></span>, and then click <span class="strong"><strong>Finish</strong></span>, as shown in <a class="xref" href="ch05.xhtml#opening_a_new_maltego_graph" title="Figure 5-2. Opening a new Maltego graph">Figure 5-2</a>.</p><div class="figure"><a id="opening_a_new_maltego_graph"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00059"/><img alt="Opening a new Maltego graph" src="httpatomoreillycomsourcenostarchimages2030308.png.jpg"/></div></div><div class="figure-title">Figure 5-2. Opening a new Maltego graph</div></div><p>Now select the <span class="strong"><strong>Palette</strong></span> option from the left-hand border. As you can see, we can gather information about all sorts of entities.</p><p>Let’s start with the <span class="emphasis"><em>bulbsecurity.com</em></span> domain, as shown in <a class="xref" href="ch05.xhtml#adding_an_entity_to_the_graph" title="Figure 5-3. Adding an entity to the graph">Figure 5-3</a>. Expand the Infrastructure option from the Palette (on the left of the Maltego window) and drag a Domain entity from the Palette onto the new graph. By default, the domain is <span class="emphasis"><em>paterva.com</em></span>. To change it to <span class="emphasis"><em>bulbsecurity.com</em></span>, either double-click the text or change the text field at the right side of the screen.</p><div class="figure"><a id="adding_an_entity_to_the_graph"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00060"/><img alt="Adding an entity to the graph" src="httpatomoreillycomsourcenostarchimages2030310.png.jpg"/></div></div><div class="figure-title">Figure 5-3. Adding an entity to the graph</div></div><p>Once the domain is set, you can run transforms (Maltego-speak for queries) on it, instructing Maltego to search for interesting information. Let’s start with a couple of simple transforms, which you can view by right-clicking the domain icon and choosing <span class="strong"><strong>Run Transform</strong></span>, as shown in <a class="xref" href="ch05.xhtml#maltego_transforms" title="Figure 5-4. Maltego transforms">Figure 5-4</a>.</p><p>In the figure, we can see all the transforms available for a domain entity. As you work with different entities, different transform options will be available. Let’s find the MX records for the <span class="emphasis"><em>bulbsecurity.com</em></span> domain and, thus, where the mail servers are. Under <span class="strong"><strong>All Transforms</strong></span>, choose the <span class="strong"><strong>To DNS Name – MX (mail server)</strong></span> transform.</p><p>As expected from our previous research, Maltego returns Google Mail servers, indicating that <span class="emphasis"><em>bulbsecurity.com</em></span> uses Google Apps for email. We can run the simple <span class="strong"><strong>To Website [Quick lookup]</strong></span> transform to get the website address of <span class="emphasis"><em>bulbsecurity.com</em></span>. See <a class="xref" href="ch05.xhtml#transform_results" title="Figure 5-5. Transform results">Figure 5-5</a> for the results from both this and the previous transform.</p><div class="figure"><a id="maltego_transforms"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00061"/><img alt="Maltego transforms" src="httpatomoreillycomsourcenostarchimages2030312.png.jpg"/></div></div><div class="figure-title">Figure 5-4. Maltego transforms</div></div><div class="figure"><a id="transform_results"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00062"/><img alt="Transform results" src="httpatomoreillycomsourcenostarchimages2030314.png.jpg"/></div></div><div class="figure-title">Figure 5-5. Transform results</div></div><p><a class="indexterm" id="iddle1862"/><a class="indexterm" id="iddle1953"/>Maltego correctly finds <span class="emphasis"><em><a class="ulink" href="http://www.bulbsecurity.com" target="_top">www.bulbsecurity.com</a></em></span>. Attacking the Google Mail servers will likely be out of the scope of any pentest, but more infor-mation on the <span class="emphasis"><em><a class="ulink" href="http://www.bulbsecurity.com" target="_top">www.bulbsecurity.com</a></em></span> website would certainly be useful. We can run transforms on any entity on the graph, so select the website <span class="emphasis"><em><a class="ulink" href="http://www.bulbsecurity.com" target="_top">www.bulbsecurity.com</a></em></span> to gather data on it. For instance, we can run the transform <span class="strong"><strong>ToServerTechnologiesWebsite</strong></span> to see what software <span class="emphasis"><em><a class="ulink" href="http://www.bulbsecurity.com" target="_top">www.bulbsecurity.com</a></em></span> is running, as shown in <a class="xref" href="ch05.xhtml#wwwdotbulbsecuritydotcom_software" title="Figure 5-6. www.bulbsecurity.com software">Figure 5-6</a>.</p><div class="figure"><a id="wwwdotbulbsecuritydotcom_software"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00063"/><img alt="www.bulbsecurity.com software" src="httpatomoreillycomsourcenostarchimages2030316.png.jpg"/></div></div><div class="figure-title">Figure 5-6. <a class="ulink" href="http://www.bulbsecurity.com" target="_top">www.bulbsecurity.com</a> software</div></div><p>Maltego finds that <span class="emphasis"><em><a class="ulink" href="http://www.bulbsecurity.com" target="_top">www.bulbsecurity.com</a></em></span> is an Apache web server with PHP, Flash, and so on, along with a WordPress install. WordPress, a commonly used blogging platform, has a long history of security issues (like a lot of software). We’ll look at exploiting website vulnerabilities in <a class="xref" href="ch14.xhtml" title="Chapter 14. Web Application Testing">Chapter 14</a>. (Let’s hope I am keeping my WordPress blog up to date, or else I might wake up to find my site defaced one day. How embarrassing!)</p><p>You can find additional information and tutorials about Maltego at <span class="emphasis"><em><a class="ulink" href="http://www.paterva.com/" target="_top">http://www.paterva.com/</a></em></span>. Spend some time using Maltego transforms to find interesting information about your organization. In skilled hands, Maltego can turn hours of reconnaissance work into minutes with the same quality results.</p></div></div><div class="sect1" title="Port Scanning"><div class="titlepage"><div><div><h2 class="title" id="port_scanning" style="clear: both">Port Scanning</h2></div></div></div><p>When you start a pentest, the potential scope is practically limitless. The client could be running any number of programs with security issues: They could have misconfiguration issues in their infrastructure that could lead to compromise; weak or default passwords could give up the keys to the kingdom on otherwise secure systems; and so on. Pentests often narrow your <a class="indexterm" id="iddle1257"/><a class="indexterm" id="iddle1668"/><a class="indexterm" id="iddle1815"/><a class="indexterm" id="iddle1954"/><a class="indexterm" id="iddle1963"/><a class="indexterm" id="iddle2104"/><a class="indexterm" id="iddle2164"/><a class="indexterm" id="iddle2184"/><a class="indexterm" id="iddle2198"/>scope to a particular IP range and nothing more, and you won’t help your client by developing a working exploit for the latest and greatest server-side vulnerability if they don’t use the vulnerable software. We need to find out which systems are active and which software we can talk to.</p><div class="sect2" title="Manual Port Scanning"><div class="titlepage"><div><div><h3 class="title" id="manual_port_scanning">Manual Port Scanning</h3></div></div></div><p>For example, in the previous chapter we saw that exploiting the MS08-067 vulnerability can be an easy win for attackers and pentesters alike. To use this exploit, we need to find a Windows 2000, XP, or 2003 box with an SMB server that is missing the MS08-067 Microsoft patch available on the network. We can get a good idea about the network-based attack surface by mapping the network range and querying systems for listening ports.</p><p>We can do this manually by connecting to ports with a tool such as telnet or Netcat and recording the results. Let’s use Netcat to connect to the Windows XP machine on port 25, the default port for the Simple Mail Transfer Protocol (SMTP).</p><a id="pro_id00085"/><pre class="programlisting">root@kali:~# <span class="strong"><strong>nc -vv 192.168.20.10 25</strong></span>&#13;
nc: 192.168.20.10 (192.168.20.10) 25 [smtp]❶ open&#13;
nc: using stream socket&#13;
nc: using buffer size 8192&#13;
nc: read 66 bytes from remote&#13;
220 bookxp SMTP Server SLmail 5.5.0.4433 Ready&#13;
ESMTP spoken here&#13;
nc: wrote 66 bytes to local</pre><p>As it turns out, the Windows XP box is running an SMTP server on port 25 ❶. After we connected, the SMTP server announced itself as <code class="literal">SLMail -version 5.5.0.4433</code>.</p><p>Now, keep in mind that admins can change banners like this to say anything, even sending attackers and pentesters on a wild goose chase, studying vulnerabilities for a product that is not deployed. In most cases, however, versions in software banners will be fairly accurate, and just connecting to the port and viewing the banner provides a starting point for our pentesting research. Searching the Web for information about <code class="literal">SLMail version 5.5.0.4433</code> may yield some interesting results.</p><p>On the other hand, connecting to every possible TCP and UDP port on just one machine and noting the results can be time consuming. Luckily, computers are excellent at repetitive tasks like this, and we can use port-scanning tools such as Nmap to find listening ports for us.</p><div class="note" title="Note"><h3 class="title"><a id="ch05note02"/>Note</h3><p>Everything we have done so far in this chapter is completely legal. But once we start actively querying systems, we are moving into murky legal territory. Attempting to break into computers without permission is, of course, illegal in many countries. Though stealthy scan traffic may go unnoticed, you should practice the skills we study in the rest of this chapter (and the rest of this book) only on your target virtual machines or other systems you own or have written permission to test (known in the trade as a get-out-of-jail-free card).</p></div></div><div class="sect2" title="Port Scanning with Nmap"><div class="titlepage"><div><div><h3 class="title" id="port_scanning_with_nmap">Port Scanning with Nmap</h3></div></div></div><p><a class="indexterm" id="iddle1411"/><a class="indexterm" id="iddle1414"/><a class="indexterm" id="iddle1453"/><a class="indexterm" id="iddle1836"/><a class="indexterm" id="iddle1840"/><a class="indexterm" id="iddle1924"/><a class="indexterm" id="iddle1956"/><a class="indexterm" id="iddle2272"/><a class="indexterm" id="iddle2282"/>Nmap is an industry standard for port scanning. Entire books have been written just about using Nmap, and the manual page may seem a bit daunting. We will cover the basics of port scanning here and come back to the tool in later chapters.</p><p>Firewalls with intrusion-detection and prevention systems have made great strides in detecting and blocking scan traffic, so you might run an Nmap scan and receive no results at all. Though you could be hired to perform an external pentest against a network range with no live hosts, it’s more likely that you’re being blocked by a firewall. On the other hand, your Nmap results might instead say that every host is alive, and will be listening on every port if your scan is detected.</p><div class="sect3" title="A SYN Scan"><div class="titlepage"><div><div><h4 class="title" id="syn_scan">A SYN Scan</h4></div></div></div><p>Let’s start by running a SYN scan against our target machines. A <span class="emphasis"><em>SYN scan</em></span> is a TCP scan that does not finish the TCP handshake. A TCP connection starts with a three-way handshake: SYN ▸ SYN-ACK ▸ ACK, as shown in <a class="xref" href="ch05.xhtml#tcp_three-way_handshake" title="Figure 5-7. TCP three-way handshake">Figure 5-7</a>.</p><div class="figure"><a id="tcp_three-way_handshake"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00064"/><img alt="TCP three-way handshake" src="httpatomoreillycomsourcenostarchimages2030318.png.jpg"/></div></div><div class="figure-title">Figure 5-7. TCP three-way handshake</div></div><p>In a SYN scan, Nmap sends the SYN and waits for the SYN-ACK if the port is open but never sends the ACK to complete the connection. If the SYN packet receives no SYN-ACK response, the port is not available; either it’s closed or the connection is being filtered. This way, Nmap finds out if a port is open without ever fully connecting to the target machine. The syntax for a SYN scan is the <code class="literal">-sS</code> flag.</p><p>Next, as you can see in <a class="xref" href="ch05.xhtml#running_an_nmap_syn_scan" title="Example 5-6. Running an Nmap SYN scan">Example 5-6</a>, we specify the IP address(s) or range to scan. Finally, we use the <code class="literal">-o</code> option to output our Nmap results to a file. The <code class="literal">-oA</code> option tells Nmap to log our results in all formats: <span class="emphasis"><em>.nmap</em></span>, <span class="emphasis"><em>.gnmap</em></span> (greppable Nmap), and XML. Nmap format, like the output that Nmap prints to the screen in <a class="xref" href="ch05.xhtml#running_an_nmap_syn_scan" title="Example 5-6. Running an Nmap SYN scan">Example 5-6</a>, is nicely formatted and easy to read. Greppable Nmap (as the name implies) is formatted to be used with the <code class="literal">grep</code> utility to search for specific information. XML format is a standard used to import Nmap results into other tools. <a class="xref" href="ch05.xhtml#running_an_nmap_syn_scan" title="Example 5-6. Running an Nmap SYN scan">Example 5-6</a> shows the results of the SYN scan.</p><div class="note" title="Note"><h3 class="title"><a id="ch05note03"/>Note</h3><p>It is always a good idea to take good notes of everything we do on our pentest. Tools such as Dradis are designed specifically to track pentest data, but as long as you have notes of everything you did when you get to the reporting phase, you will be okay. I personally am more of a pen-and-paper user, or at best, a creating-a-long-Word-document-with-all-of-my-results type. The methods used for tracking results vary from pentester to pentester. Outputting your Nmap results to files is a good way to make sure you have a record of your scan. Also, you can use the Linux command script to record everything printed to your terminal—another good way to keep track of everything you have done.</p></div><div class="example"><a id="running_an_nmap_syn_scan"/><div class="example-title">Example 5-6. Running an Nmap SYN scan</div><div class="example-contents"><pre class="programlisting">root@kali:~# <span class="strong"><strong>nmap -sS 192.168.20.10-12 -oA booknmap</strong></span>&#13;
Starting Nmap 6.40 ( http://nmap.org ) at 2015-12-18 07:28 EST&#13;
Nmap scan report for 192.168.20.10&#13;
Host is up (0.00056s latency).&#13;
Not shown: 991 closed ports&#13;
PORT     STATE SERVICE&#13;
21/tcp   open  ftp ❷&#13;
25/tcp   open  smtp ❺&#13;
80/tcp   open  http ❸&#13;
106/tcp  open  pop3pw ❺&#13;
110/tcp  open  pop3 ❺&#13;
135/tcp  open  msrpc&#13;
139/tcp  open  netbios-ssn ❹&#13;
443/tcp  open  https ❸&#13;
445/tcp  open  microsoft-ds ❹&#13;
1025/tcp open  NFS-or-IIS&#13;
3306/tcp open  mysql ❻&#13;
5000/tcp open  upnp&#13;
MAC Address: 00:0C:29:A5:C1:24 (VMware)&#13;
&#13;
Nmap scan report for 192.168.20.11&#13;
Host is up (0.00031s latency).&#13;
Not shown: 993 closed ports&#13;
PORT     STATE SERVICE&#13;
21/tcp   open  ftp ❷&#13;
22/tcp   open  ssh&#13;
80/tcp   open  http ❸&#13;
111/tcp  open  rpcbind&#13;
139/tcp  open  netbios-ssn ❹&#13;
445/tcp  open  microsoft-ds ❹&#13;
2049/tcp open  nfs&#13;
MAC Address: 00:0C:29:FD:0E:40 (VMware)&#13;
&#13;
Nmap scan report for 192.168.20.12&#13;
Host is up (0.0014s latency).&#13;
Not shown: 999 filtered ports&#13;
PORT     STATE SERVICE&#13;
80/tcp   open  http ❶&#13;
135/tcp  open  msrpc&#13;
MAC Address: 00:0C:29:62:D5:C8 (VMware)&#13;
&#13;
Nmap done: 3 IP addresses (3 hosts up) scanned in 1070.40 seconds</pre></div></div><p><a class="indexterm" id="iddle1842"/><a class="indexterm" id="iddle2283"/><a class="indexterm" id="iddle2364"/>As you can see, Nmap returns a handful of ports on the Windows XP and Linux boxes. We will see as we move through the next few chapters that nearly all of these ports contain vulnerabilities. Hopefully, that won’t be the case on your pentests, but in an attempt to introduce you to many types of vulnerabilities you will encounter in the field, our pentesting lab has been condensed into these three machines.</p><p>That said, just because a port is open does not mean that vulnerabilities are present. Rather it leaves us with the possibility that vulnerable software might be running on these ports. Our Windows 7 machine is listening only on port 80 ❶, the traditional port for HTTP web servers, and port 139 for remote procedure call. There may be exploitable software listening on ports that are not allowed through the Windows firewall, and there may be vulnerable software running locally on the machine, but at the moment we can’t attempt to exploit anything directly over the network except the web server.</p><p>This basic Nmap scan has already helped us focus our pentesting efforts. Both the Windows XP and Linux targets are running FTP servers ❷, web servers ❸, and SMB servers ❹. The Windows XP machine is also running a mail server that has opened several ports ❺ and a MySQL server ❻.</p></div><div class="sect3" title="A Version Scan"><div class="titlepage"><div><div><h4 class="title" id="version_scan">A Version Scan</h4></div></div></div><p>Our SYN scan was stealthy, but it didn’t tell us much about the software that is actually running on the listening ports. Compared to the detailed version information we got by connecting to port 25 with Netcat, the SYN scan’s results are a bit lackluster. We can use a full TCP scan (<code class="literal">nmap -sT</code>) or go a step further and use Nmap’s version scan (<code class="literal">nmap -sV</code>) to get more data. With the version scan shown in <a class="xref" href="ch05.xhtml#running_an_nmap_version_scan" title="Example 5-7. Running an Nmap version scan">Example 5-7</a>, Nmap completes the connection and then attempts to determine what software is running and, if possible, the version, using techniques such as banner grabbing.</p><div class="example"><a id="running_an_nmap_version_scan"/><div class="example-title">Example 5-7. Running an Nmap version scan</div><div class="example-contents"><pre class="programlisting">root@kali:~# <span class="strong"><strong>nmap -sV 192.168.20.10-12 -oA bookversionnmap</strong></span>&#13;
&#13;
Starting Nmap 6.40 ( http://nmap.org ) at 2015-12-18 08:29 EST&#13;
Nmap scan report for 192.168.20.10&#13;
Host is up (0.00046s latency).&#13;
Not shown: 991 closed ports&#13;
PORT     STATE SERVICE      VERSION&#13;
21/tcp   open  ftp          FileZilla ftpd 0.9.32 beta&#13;
25/tcp   open  smtp         SLmail smtpd 5.5.0.4433&#13;
79/tcp   open  finger       SLMail fingerd&#13;
80/tcp   open  http         Apache httpd 2.2.12 ((Win32) DAV/2 mod_ssl/2.2.12 OpenSSL/0.9.8k&#13;
                              mod_autoindex_color PHP/5.3.0 mod_perl/2.0.4 Perl/v5.10.0)&#13;
106/tcp  open  pop3pw       SLMail pop3pw&#13;
110/tcp  open  pop3         BVRP Software SLMAIL pop3d&#13;
135/tcp  open  msrpc        Microsoft Windows RPC&#13;
139/tcp  open  netbios-ssn&#13;
443/tcp  open  ssl/http     Apache httpd 2.2.12 ((Win32) DAV/2 mod_ssl/2.2.12 OpenSSL/0.9.8k&#13;
                              mod_autoindex_color PHP/5.3.0 mod_perl/2.0.4 Perl/v5.10.0)&#13;
445/tcp  open  microsoft-ds Microsoft Windows XP microsoft-ds&#13;
1025/tcp open  msrpc        Microsoft Windows RPC&#13;
3306/tcp open  mysql        MySQL (unauthorized)&#13;
5000/tcp open  upnp         Microsoft Windows UPnP&#13;
MAC Address: 00:0C:29:A5:C1:24 (Vmware)&#13;
Service Info: Host: georgia.com; OS: Windows; CPE: cpe:/o:microsoft:windows&#13;
&#13;
Nmap scan report for 192.168.20.11&#13;
Host is up (0.00065s latency).&#13;
Not shown: 993 closed ports&#13;
PORT     STATE SERVICE              VERSION&#13;
21/tcp   open  ftp                  vsftpd 2.3.4 ❶&#13;
22/tcp   open  ssh                  OpenSSH 5.1p1 Debian 3ubuntu1 (protocol 2.0)&#13;
80/tcp   open  http                 Apache httpd 2.2.9 ((Ubuntu) PHP/5.2.6-2ubuntu4.6 with&#13;
                                      Suhosin-Patch)&#13;
111/tcp  open  rpcbind (rpcbind V2) 2 (rpc #100000)&#13;
139/tcp  open  netbios-ssn          Samba smbd 3.X (workgroup: WORKGROUP)&#13;
445/tcp  open  netbios-ssn          Samba smbd 3.X (workgroup: WORKGROUP)&#13;
2049/tcp open  nfs (nfs V2-4)       2-4 (rpc #100003)&#13;
MAC Address: 00:0C:29:FD:0E:40 (VMware)&#13;
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:kernel&#13;
&#13;
Nmap scan report for 192.168.20.12&#13;
Host is up (0.0010s latency).&#13;
Not shown: 999 filtered ports&#13;
PORT     STATE SERVICE        VERSION&#13;
80/tcp   open  http           Microsoft IIS httpd 7.5&#13;
135/tcp  open  msrpc          Microsoft Windows RPC&#13;
MAC Address: 00:0C:29:62:D5:C8 (VMware)&#13;
&#13;
Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .&#13;
Nmap done: 3 IP addresses (3 hosts up) scanned in 20.56 seconds</pre></div></div><p><a class="indexterm" id="iddle1841"/><a class="indexterm" id="iddle2325"/>This time we gained much more information about our Windows XP and Linux targets. For example, we knew there was an FTP server on the Linux box, but now we have reasonable assurance that the FTP server is Very Secure FTP version 2.3.4 ❶. We’ll use this output to search for potential vulnerabilities in the next chapter. As for our Windows 7 system, we found out only that it’s running Microsoft IIS 7.5, a fairly up-to-date version. It’s possible to install IIS 8 on Windows 7, but it’s not officially supported. The version itself would not raise any red flags to me. We will find that the application installed on this IIS server is the real issue in <a class="xref" href="ch14.xhtml" title="Chapter 14. Web Application Testing">Chapter 14</a>.</p><div class="note" title="Note"><h3 class="title"><a id="ch05note04"/>Note</h3><p>Keep in mind that Nmap may report the wrong version in some cases (for instance, if the software has been updated, but the welcome banner is not edited as part of the patch), but at the very least, its version scan gave us a good place to begin further research.</p></div></div><div class="sect3" title="UDP Scans"><div class="titlepage"><div><div><h4 class="title" id="udp_scans">UDP Scans</h4></div></div></div><p>Both Nmap’s SYN and version scans are TCP scans that do not query UDP ports. Because UDP is connectionless, the scanning logic is a bit different. In a UDP scan (<code class="literal">-sU</code>), Nmap sends a UDP packet to a port. Depending on the port, the packet sent is protocol specific. If it receives a response, the port is considered open. If the port is closed, Nmap will receive an ICMP Port Unreachable message. If Nmap receives no response whatsoever, then either the port is open and the program listening does not respond to Nmap’s query, or the traffic is being filtered. Thus, Nmap is not always able to distinguish between an open UDP port and one that is filtered by a firewall. See <a class="xref" href="ch05.xhtml#running_a_udp_scan" title="Example 5-8. Running a UDP scan">Example 5-8</a> for a UDP scan example.</p><div class="example"><a id="running_a_udp_scan"/><div class="example-title">Example 5-8. Running a UDP scan</div><div class="example-contents"><pre class="programlisting">root@kali:~# <span class="strong"><strong>nmap -sU 192.168.20.10-12 -oA bookudp</strong></span>&#13;
&#13;
Starting Nmap 6.40 ( http://nmap.org ) at 2015-12-18 08:39 EST&#13;
Stats: 0:11:43 elapsed; 0 hosts completed (3 up), 3 undergoing UDP Scan&#13;
UDP Scan Timing: About 89.42% done; ETC: 08:52 (0:01:23 remaining)&#13;
Nmap scan report for 192.168.20.10&#13;
Host is up (0.00027s latency).&#13;
Not shown: 990 closed ports&#13;
PORT     STATE         SERVICE&#13;
69/udp   open|filtered tftp ❶&#13;
123/udp  open          ntp&#13;
135/udp  open          msrpc&#13;
137/udp  open          netbios-ns&#13;
138/udp  open|filtered netbios-dgm&#13;
445/udp  open|filtered microsoft-ds&#13;
500/udp  open|filtered isakmp&#13;
1026/udp open          win-rpc&#13;
1065/udp open|filtered syscomlan&#13;
1900/udp open|filtered upnp&#13;
MAC Address: 00:0C:29:A5:C1:24 (VMware)&#13;
&#13;
Nmap scan report for 192.168.20.11&#13;
Host is up (0.00031s latency).&#13;
Not shown: 994 closed ports&#13;
PORT     STATE         SERVICE&#13;
68/udp   open|filtered dhcpc&#13;
111/udp  open          rpcbind&#13;
137/udp  open          netbios-ns&#13;
138/udp  open|filtered netbios-dgm&#13;
2049/udp open          nfs ❷&#13;
5353/udp open          zeroconf&#13;
MAC Address: 00:0C:29:FD:0E:40 (VMware)&#13;
&#13;
Nmap scan report for 192.168.20.12&#13;
Host is up (0.072s latency).&#13;
Not shown: 999 open|filtered ports&#13;
PORT     STATE         SERVICE&#13;
137/udp  open          netbios-ns&#13;
MAC Address: 00:0C:29:62:D5:C8 (VMware)&#13;
&#13;
Nmap done: 3 IP addresses (3 hosts up) scanned in 1073.86 seconds</pre></div></div><p><a class="indexterm" id="iddle1839"/><a class="indexterm" id="iddle1966"/><a class="indexterm" id="iddle2551"/>For example, on the Windows XP system, the TFTP port (UDP 69) may be open or filtered ❶. On the Linux target, Nmap was able to glean that the Network File System port is listening ❷. Because only two TCP ports responded on the Windows 7 box, it’s fair to assume that a firewall is in place, in this case the built-in Windows firewall. Likewise, the Windows firewall is filtering all traffic except to one UDP port. (If the Windows firewall were not in place, our UDP scan might give us more information.)</p></div><div class="sect3" title="Scanning a Specific Port"><div class="titlepage"><div><div><h4 class="title" id="scanning_a_specific_port">Scanning a Specific Port</h4></div></div></div><p>By default, Nmap scans only the 1,000 ports it considers the most “interesting,” not the 65,535 possible TCP or UDP ports. The default Nmap scan will catch common running services, but in some cases it will miss a listening port or two. To scan specific ports, use the <code class="literal">-p</code> flag with Nmap. For example, to scan port 3232 on the Windows XP target, see <a class="xref" href="ch05.xhtml#running_an_nmap_scan_on_a_specific_port" title="Example 5-9. Running an Nmap scan on a specific port">Example 5-9</a>.</p><div class="example"><a id="running_an_nmap_scan_on_a_specific_port"/><div class="example-title">Example 5-9. Running an Nmap scan on a specific port</div><div class="example-contents"><pre class="programlisting">root@Kali:~# <span class="strong"><strong>nmap -sS -p 3232 192.168.20.10</strong></span>&#13;
&#13;
Starting Nmap 6.40 ( http://nmap.org ) at 2015-12-18 09:03 EST&#13;
Nmap scan report for 192.168.20.10&#13;
Host is up (0.00031s latency).&#13;
PORT     STATE SERVICE&#13;
3232/tcp open  unknown&#13;
MAC Address: 00:0C:29:A5:C1:24 (VMware)</pre></div></div><p>Sure enough, when we tell Nmap to scan 3232, it returns <code class="literal">open</code>, which shows that this port is worth checking out, in addition to the default Nmap scanned ports. However, if we try to probe the port a bit more aggressively with a version scan (see <a class="xref" href="ch05.xhtml#running_a_version_scan_against_a_specifi" title="Example 5-10. Running a version scan against a specific port">Example 5-10</a>), the service listening on the port crashes, as shown in <a class="xref" href="ch05.xhtml#zervit_server_crashes_when_scanned_by_nm" title="Figure 5-8. The Zervit server crashes when scanned by Nmap.">Figure 5-8</a>.</p><div class="note" title="Note"><h3 class="title"><a id="ch05note05"/>Note</h3><p>A good rule of thumb is to specify ports 1 through 65535 on your pentests, just to make sure there’s nothing listening on those other “uninteresting” ports.</p></div><div class="example"><a id="running_a_version_scan_against_a_specifi"/><div class="example-title">Example 5-10. Running a version scan against a specific port</div><div class="example-contents"><pre class="programlisting">root@kali:~# <span class="strong"><strong>nmap -p 3232 -sV 192.168.20.10</strong></span>&#13;
Starting Nmap 6.40 ( http://nmap.org ) at 2015-04-28 10:19 EDT&#13;
Nmap scan report for 192.168.20.10&#13;
Host is up (0.00031s latency).&#13;
PORT     STATE SERVICE VERSION&#13;
3232/tcp open  unknown&#13;
1 service unrecognized despite returning data❶. If you know the service/version, please submit the following fingerprint at http://www.insecure.org/cgi-bin/servicefp-submit.cgi : ❷&#13;
SF-Port3232-TCP:V=6.25%I=7%D=4/28%Time=517D2FFC%P=i686-pc-linux-gnu%r(GetR&#13;
SF:equest,B8,"HTTP/1\.1\x20200\x20OK\r\nServer:\x20Zervit\x200\.4\r\n❸X-Pow&#13;
SF:ered-By:\x20Carbono\r\nConnection:\x20close\r\nAccept-Ranges:\x20bytes\&#13;
SF:r\nContent-Type:\x20text/html\r\nContent-Length:\x2036\r\n\r\n&lt;html&gt;\r\&#13;
SF:n&lt;body&gt;\r\nhi\r\n&lt;/body&gt;\r\n&lt;/html&gt;");&#13;
MAC Address: 00:0C:29:13:FA:E3 (VMware)</pre></div></div><div class="figure"><a id="zervit_server_crashes_when_scanned_by_nm"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00065"/><img alt="The Zervit server crashes when scanned by Nmap." src="httpatomoreillycomsourcenostarchimages2030320.png.jpg"/></div></div><div class="figure-title">Figure 5-8. The Zervit server crashes when scanned by Nmap.</div></div><p><a class="indexterm" id="iddle2102"/><a class="indexterm" id="iddle2552"/>In the process of crashing the listening service, Nmap can’t figure out what software is running as noted at ❶, but it does manage to get a fingerprint of the service. Based on the HTML tags in the fingerprint at ❷, this service appears to be a web server. According to the <code class="literal">Server:</code> field, it is something called Zervit 0.4 ❸.</p><p>At this point, we have crashed the service, and we may never see it again on our pentest, so any potential vulnerabilities may be a moot point. Of course, in our lab we can just switch over to our Windows XP target and restart the Zervit server.</p><div class="note" title="Note"><h3 class="title"><a id="ch05note06"/>Note</h3><p>Though hopefully you won’t make any services crash on your pentests, there is always a possibility that you will run into a particularly sensitive service that was not coded to accept anything other than expected input, such that even seemingly benign traffic like an Nmap scan causes it to crash. SCADA systems are particularly notorious for this sort of behavior. You always want to explain this to your client. When working with computers, there are no guarantees.</p></div><p>We’ll return to the Nmap tool in the next chapter when we use the Nmap Scripting Engine (NSE) to learn detailed vulnerability information about our target systems before beginning exploitation.</p></div></div></div><div class="sect1" title="Summary"><div class="titlepage"><div><div><h2 class="title" id="summary-id00019" style="clear: both">Summary</h2></div></div></div><p>In this chapter we’ve managed to cover a lot of ground very quickly just by using publicly available sources and port scanners. We used tools such as theHarvester and Maltego to scour the Internet for information such as email addresses and websites. We used the Nmap port scanner to find out which ports are listening on our target virtual machines. Based on the output we’ve discovered, we can now do some research on known vulnerabilities as we start to think like attackers and actively seek exploitable vulnerabilities in the systems. In the next chapter, we’ll cover the vulnerability analysis phase of penetration testing.</p></div></section></body></html>