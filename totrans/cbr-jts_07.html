<html><head></head><body><div id="sbo-rt-content"><section>&#13;
<header>&#13;
<h1 class="chapter">&#13;
<span class="ChapterNumber"><span epub:type="pagebreak" title="57" id="Page_57"/>7</span><br/>&#13;
<span class="ChapterTitle">Access to Time</span><br/>&#13;
<span class="ChapterSubtitle">You should start your attack with no delay and not prematurely but perfectly on time.</span></h1></header>&#13;
<blockquote class="Epigraph" epub:type="epigraph">&#13;
<p class="Epigraph">If you are going to set fire to the enemy’s castle or camp, you need to prearrange the ignition time with your allies.</p>&#13;
<p class="EpigraphSource">—Yoshimori Hyakushu #83</p>&#13;
</blockquote>&#13;
<p class="ChapterIntro">When shinobi were on a mission, particularly at night, one of their most crucial and complex duties was keeping track of time. If this task seems simple, remember that shinobi did not have watches or clocks. They didn’t even have sand hourglasses until the early 1600s.<sup class="endnote"><a id="c07-noteref-51" href="b01.xhtml#endnote-51">1</a></sup> To send and receive signals at the proper time, coordinate attacks, know when the enemy would be vulnerable, and more, shinobi had to develop methods to tell time reliably.</p>&#13;
<p>Historically, one way to mark the hours involved lighting incense or candles known to burn at a constant rate, then ringing a bell at certain intervals to announce the time. <em>Bansenshūkai</em> recommends using environmental cues, such as the movement of the stars, or weight-based instruments to tell time.<sup class="endnote"><a id="c07-noteref-52" href="b01.xhtml#endnote-52">2</a></sup> These weight-based instruments were likely <span epub:type="pagebreak" title="58" id="Page_58"/>water clocks, sometimes called <em>clepsydras</em>, that used balance and water flow/weight mechanisms to accurately signal time intervals. Other scrolls include more abstruse options, such as tracking the change in dilation of a cat’s iris throughout the day or the subtle thermal expansions of a dwelling during the night, as these align with particular hours.<sup class="endnote"><a id="c07-noteref-53" href="b01.xhtml#endnote-53">3</a></sup> Shinobi were even taught to derive the hour by being mindful of which nostril they were more actively breathing through. The scrolls explain how breath comes prominently in and out of one nostril, then alternates to the other, in regular intervals that can be used to track time. While this idea might seem like pseudoscience, in 1895, German scientist Richard Kayser observed and documented that during the day, blood pools on different sides of a person’s nose, causing a noticeable reduction in airflow in one of the nostrils, before alternating to the other nostril.<sup class="endnote"><a id="c07-noteref-54" href="b01.xhtml#endnote-54">4</a></sup> Not only did the shinobi’s acute observational skills identify this phenomenon more than 300 years before its scientific publication in the West, but they also developed a practical application for it. For example, they might need to lie down in the crawl space of a floor beneath their target, where they would be unable to light candles or incense, use instruments to track time, or even dare open their eyes should the glint from their eye catch the target’s attention through the cracks of the floor. Under these uncomfortable circumstances, they would lie still and pay attention to their nose breath until the time to attack came—a stellar example of the shinobi’s discipline, ingenuity, and creativity. </p>&#13;
<p>The multitude of references to time in the shinobi scrolls, combined with the arduous methods developed to track time, suggests that these techniques would not have been developed if keeping track of time were not crucial for a threat actor to operate effectively. The ubiquity of cheap, easy, and reliable ways of telling time in modern society has almost certainly conditioned us to take time and its measurement for granted. </p>&#13;
<p>In this chapter, we’ll reconsider the value and importance of time in digital systems while briefly reviewing how it is generated, used, and secured with existing best practices. Then we will ask: if accurate time is so important to an adversary, what might happen if we could keep time secret from them? Or deny the adversary access to time? Or even deceive them with an inaccurate time? </p>&#13;
<h2 id="h1-500549c07-0001">The Importance of Time</h2>&#13;
<p class="BodyFirst">Time is necessary for the operation of almost every modern computer system. By synchronizing sequential logic and generating a clock signal that dictates intervals of function, computers establish finite pulses of time. These pulses are like the ticking of a clock in which systems perform <span epub:type="pagebreak" title="59" id="Page_59"/>operations on data in stable, reliable input/output environments. The vast, intricate networks and systems that run our governments, economies, businesses, and personal lives operate on these pulses, requesting the time continuously. They could not function without their clocks.</p>&#13;
<p>Numerous security controls exist to protect time data. Identity authentication on Network Time Protocol (NTP) servers verifies that an attacker is not spoofing a system’s trusted source of time. Encryption and checksums—encryption encodes the communication, and checksums serve to detect errors during transmission—on the NTP server’s time data verify its integrity and protect it from tampering. Nonce is an arbitrary randomized number added to the time communication to prevent repeated-transmission errors. Timestamps and time synchronization logging compare the system’s time to that reported by an authoritative time source. NTP stays available and fault tolerant by leveraging multiple time sources and alternate propagation methods, and if access to NTP is denied or unavailable, backup methods can accurately estimate time based on the last synchronization. Additional security best practices call for timestamping audit records, locking out sessions based on inactivity, restricting access to accounts based on the time of day, assessing the validity of security certificates and keys based on time and date information, establishing when to create backups, and measuring how long to keep cached records.</p>&#13;
<p>These controls protect the integrity and availability of time data, but rarely is enough consideration given to protecting time data’s confidentiality. Almost any modern application can request the time at any moment, and it is generally permitted access not only to the date and time but also to clock libraries and functions. While NTP can encrypt the time data it communicates to a system, there is a notable lack of controls around restricting access to the current system time. Identifying this control gap is important because time is a critical piece of information adversaries use to spread malware. The destructive Shamoon malware,<sup class="endnote"><a id="c07-noteref-55" href="b01.xhtml#endnote-55">5</a></sup><sup> </sup>for instance, was set to execute at the start of the Saudi Arabian weekend to inflict maximum damage; it was designed to wipe all infected systems before anyone would notice. </p>&#13;
<p>Other common attacks include disclosing confidential information, causing race conditions, forcing deadlocks, manipulating information states, and performing timing attacks to discover cryptography secrets. More sophisticated malware can use its access to time to:</p>&#13;
<ul>&#13;
<li>Sleep for a set period to avoid detection</li>&#13;
<li>Measure pi to 10 million digits, timing how long the calculation takes to determine whether the infected system is in a sandbox/detonation environment designed to catch malware</li>&#13;
<li><span epub:type="pagebreak" title="60" id="Page_60"/>Attempt to contact its command and control (C2) based on specific time instructions</li>&#13;
<li>Discover metadata and other information through timing attacks that reveal the state, position, and capability of the target system</li>&#13;
</ul>&#13;
<p>If administrators could deny access to time (local, real, and linear), conducting operations within targeted information systems would be much more difficult—and possibly infeasible—for the adversary. However, it is important to note that haphazardly limiting time queries will likely result in cascading failures and errors. A precise approach is needed to deny access to time.</p>&#13;
<h2 id="h1-500549c07-0002">Keeping Time Confidential</h2>&#13;
<p class="BodyFirst">Keep in mind that, because confidentiality is not as entrenched as other forms of time security, applying such security controls will require special effort from your organization and the greater security community.</p>&#13;
<h3 id="h2-500549c07-0001">Determine Your Baseline</h3>&#13;
<p class="BodyFirst">Identify the software, applications, systems, and administrative commands in your environment that require access to time. Implement function hooking (interception of function calls) and logging to determine who and what is requesting time. After establishing this baseline, use it to detect abnormal time queries and inform a time-based needs assessment that will tailor additional security controls (for example, Just in Time [JIT]).</p>&#13;
<h3 id="h2-500549c07-0002">Assess Technical Capability</h3>&#13;
<p class="BodyFirst">Contact your hardware manufacturers and software vendors to determine what technical controls can be enabled to restrict access to time functions. If there are no such controls, request that new features be implemented to encourage the industry to develop solutions around time confidentiality.</p>&#13;
<h3 id="h2-500549c07-0003">Establish Policy</h3>&#13;
<p class="BodyFirst">Denying access to time is a nontraditional security control, but as with more customary controls, enforcement requires establishing strategic policy that details requirements—in this case, limiting access to time and monitoring attempts to access time. Wherever possible, incorporate the concept of time confidentiality in all change management decisions, procurement of new hardware and software, and SOC prioritization. Formally document new policies and ensure that your organization’s CISO approves them.</p>&#13;
<aside epub:type="sidebar">&#13;
<div class="top hr"><hr/></div>&#13;
<section class="box">&#13;
<h2><span epub:type="pagebreak" title="61" id="Page_61"/>Castle Theory Thought Exercise</h2>&#13;
<p class="BoxBodyFirst">Consider the scenario in which you are the ruler of a medieval castle with valuable assets within. You receive credible threat intelligence that a shinobi has infiltrated your castle with orders to set it on fire at precisely 3:00 <span class="SmallCaps">am.</span> At night, a guard in a tower burns a candle clock and strikes a bell every 120 minutes to keep the other night guards on schedule—a sound you believe the shinobi will also hear.</p>&#13;
<p>How can you control access to time to mitigate this threat? Which trusted individuals within your castle require access to time, and to whom can you deny complete access? Using only informational control of time, what actions can you take to thwart the attack or discover the shinobi? </p>&#13;
<div class="bottom hr"><hr/></div>&#13;
</section>&#13;
</aside>&#13;
<h2 id="h1-500549c07-0003">Recommended Security Controls and Mitigations</h2>&#13;
<p class="BodyFirst">Where relevant, recommendations are presented with applicable security controls from the NIST 800-53 standard. Each should be evaluated with the concept of time confidentiality in mind.</p>&#13;
<ol class="decimal">&#13;
<li value="1">Implement protections that block access to time data in timestamp logs or other information-monitoring logs. Preventing time spillage or timestamp leakage could require physical, environmental, media, and technical controls. [AU-9: Protection of Audit Information]</li>&#13;
<li value="2">Review your current information architecture with respect to time, including the philosophy, requirements, and tactics necessary to implement access and confidentiality controls around time data in your environment. If stakeholders agree to time restrictions, document them in a security plan with an approved budget, resources, and time dedicated to implementation. [PL-8: Information Security Architecture]</li>&#13;
<li value="3">Conduct a log review and internal hunt to discover communication occurring over port 123 to any unofficial NTP servers in your environment. Look for NTP communication to external NTP servers and consider blocking access to NTP servers you do not control. [SC-7: Boundary Protection]</li>&#13;
</ol>&#13;
<h2 id="h1-500549c07-0004"><span epub:type="pagebreak" title="62" id="Page_62"/>Debrief</h2>&#13;
<p class="BodyFirst">In this chapter, you learned about some of the tools shinobi used to tell time and what they did with their knowledge of time. We discussed how important time can be to cyber operations and security, noting that current security practices focus primarily on the availability and integrity of time in systems. You were also exposed to a thought exercise that explored how to mitigate a shinobi attack through time manipulation. </p>&#13;
<p>In the following chapter, we will discuss how shinobi could turn many things into tools to accomplish tasks. Understanding what the equivalent digital “tools” are may help you detect and safeguard against novel weaponization of such tools or at least hamper their use.</p>&#13;
</section>&#13;
</div></body></html>