- en: '**16'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'INTRODUCTION TO THE BAYES FACTOR AND POSTERIOR ODDS: THE COMPETITION OF IDEAS**'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/common.jpg)'
  prefs: []
  type: TYPE_IMG
- en: In the previous chapter, we saw that we can view a hypothesis test as an extension
    of parameter estimation. In this chapter, we’ll think about hypothesis tests instead
    as a way to compare ideas with an important mathematical tool called the *Bayes
    factor*. The Bayes factor is a formula that tests the plausibility of one hypothesis
    by comparing it to another. The result tells us how many times more likely one
    hypothesis is than the other.
  prefs: []
  type: TYPE_NORMAL
- en: We’ll then see how to combine the Bayes factor with our prior beliefs to come
    up with the posterior odds, which tells us how much stronger one belief is than
    the other at explaining our data.
  prefs: []
  type: TYPE_NORMAL
- en: '**Revisiting Bayes’ Theorem**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Chapter 6](ch06.xhtml#ch06) introduced Bayes’ theorem, which takes the following
    form:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0158-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Recall that there are three parts of this formula that have special names:'
  prefs: []
  type: TYPE_NORMAL
- en: '*P*(*H* | *D*) is the *posterior probability*, which tells us how strongly
    we should believe in our hypothesis, given our data.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*P*(*H*) is the *prior belief*, or the probability of our hypothesis prior
    to looking at the data.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*P*(*D* | *H*) is the *likelihood* of getting the existing data if our hypothesis
    were true.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The last piece, *P*(*D*), is the probability of the data observed independent
    of the hypothesis. We need *P*(*D*) in order to make sure that our posterior probability
    is correctly placed somewhere between 0 and 1\. If we have all of these pieces
    of information, we can calculate exactly how strongly we should believe in our
    hypothesis given the data we’ve observed. But as I mentioned in [Chapter 8](ch08.xhtml#ch08),
    *P*(*D*) is often very hard to define. In many cases, it’s not obvious how we
    can figure out the probability of our data. *P*(*D*) is also totally unnecessary
    if all we care about is comparing the relative strength of two different hypotheses.
  prefs: []
  type: TYPE_NORMAL
- en: 'For these reasons, we often use the *proportional form* of Bayes’ theorem,
    which allows us to analyze the strength of our hypotheses without knowing *P*(*D*).
    It looks like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '*P*(*H* | *D*) ∝ *P*(*H*) × *P*(*D* | *H*)'
  prefs: []
  type: TYPE_NORMAL
- en: 'In plain English, the proportional form of Bayes’ theorem says that the posterior
    probability of our hypothesis is proportional to the prior multiplied by the likelihood.
    We can use this to compare two hypotheses by examining the ratio of the prior
    belief multiplied by the likelihood for each hypothesis using the *ratio of posteriors*
    formula:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0158-02.jpg)'
  prefs: []
  type: TYPE_IMG
- en: What we have now is a ratio of how well each of our hypotheses explains the
    data we’ve observed. That is, if the ratio is 2, then *H*[1] explains the observed
    data twice as well as *H*[2], and if the ratio is 1/2, then *H*[2] explains the
    data twice as well as *H*[1].
  prefs: []
  type: TYPE_NORMAL
- en: '**Building a Hypothesis Test Using the Ratio of Posteriors**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The ratio of posteriors formula gives us the *posterior odds*, which allows
    us to test hypotheses or beliefs we have about data. Even when we do know *P*(*D*),
    the posterior odds is a useful tool because it allows us to compare ideas. To
    better understand the posterior odds, we’ll break down the ratio of posteriors
    formula into two parts: the likelihood ratio, or the Bayes factor, and the ratio
    of prior probabilities. This is a standard, and very helpful, practice that makes
    it much easier to reason about the likelihood and the prior probability separately.'
  prefs: []
  type: TYPE_NORMAL
- en: '***The Bayes Factor***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Using the ratio of posteriors formula, let’s assume that *P*(*H*[1]) = *P*(*H*[2])—that
    is, that our prior belief in each hypothesis is the same. In that case, the ratio
    of prior beliefs in the hypotheses is just 1, so all that’s left is:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0159-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: This is the Bayes factor, the ratio between the likelihoods of two hypotheses.
  prefs: []
  type: TYPE_NORMAL
- en: Take a moment to really think about what this equation is saying. When we consider
    how we’re going to argue for our *H*[1]—that is, our belief about the world—we
    think about gathering evidence that supports our beliefs. A typical argument,
    therefore, involves building up a set of data, *D*[1], that supports *H*[1], and
    then arguing with a friend who has gathered a set of data, *D*[2], that supports
    their hypothesis, *H*[2].
  prefs: []
  type: TYPE_NORMAL
- en: In Bayesian reasoning, though, we’re not gathering evidence to support our ideas;
    we’re looking to see how well our ideas explain the evidence in front of us. What
    this ratio tells us is the likelihood of what we’ve seen given what *we* believe
    to be true compared to what *someone else* believes to be true. Our hypothesis
    wins when it explains the world better than the competing hypothesis.
  prefs: []
  type: TYPE_NORMAL
- en: If, however, the competing hypothesis explains the data much better than ours,
    it might be time to change our beliefs. The key here is that in Bayesian reasoning,
    we don’t worry about supporting our beliefs—we are focused on how well our beliefs
    support the data we observe. In the end, data can either confirm our ideas or
    lead us to change our minds.
  prefs: []
  type: TYPE_NORMAL
- en: '***Prior Odds***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'So far we have assumed that the prior probability of each hypothesis is the
    same. This is clearly not always the case: a hypothesis may explain the data well
    even if it is very unlikely. If you’ve lost your phone, for example, both the
    belief that you left it in the bathroom and the belief that aliens took it to
    examine human technology explain the data quite well. However, the bathroom hypothesis
    is clearly much more likely. This is why we need to consider the ratio of prior
    probabilities:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0160-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: This ratio compares the probability of two hypotheses before we look at the
    data. When used in relation to the Bayes factor, this ratio is called the *prior
    odds* in our *H*[1] and written as *O*(*H*[1]). This representation is helpful
    because it lets us easily note how strongly (or weakly) we believe in the hypothesis
    we’re testing. When this number is greater than 1, it means the prior odds favor
    our hypothesis, and when it is a fraction less than 1, it means they’re against
    our hypothesis. For example, *O*(*H*[1]) = 100 means that, without any other information,
    we believe *H*[1] is 100 times more likely than the alternative hypothesis. On
    the other hand, when *O*(*H*[1]) = 1/100, the alternative hypothesis is 100 times
    more likely than ours.
  prefs: []
  type: TYPE_NORMAL
- en: '***Posterior Odds***'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'If we put together the Bayes factor and the prior odds, we get the posterior
    odds:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0160-02.jpg)'
  prefs: []
  type: TYPE_IMG
- en: The posterior odds calculates how many times better our hypothesis explains
    the data than a competing hypothesis.
  prefs: []
  type: TYPE_NORMAL
- en: '[Table 16-1](ch16.xhtml#ch16tab01) lists some guidelines for evaluating various
    posterior odds values.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Table 16-1:** Guidelines for Evaluating Posterior Odds'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Posterior odds** | **Strength of evidence** |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 1 to 3 | Interesting, but nothing conclusive |'
  prefs: []
  type: TYPE_TB
- en: '| 3 to 20 | Looks like we’re on to something |'
  prefs: []
  type: TYPE_TB
- en: '| 20 to 150 | Strong evidence in favor of *H*[1] |'
  prefs: []
  type: TYPE_TB
- en: '| > 150 | Overwhelming evidence |'
  prefs: []
  type: TYPE_TB
- en: We can look at the reciprocal of these odds to decide when to change our mind
    about an idea.
  prefs: []
  type: TYPE_NORMAL
- en: While these values can serve as a useful guide, Bayesian reasoning is still
    a form of reasoning, which means you have to use some judgment. If you’re having
    a casual disagreement with a friend, a posterior odds of 2 might be enough to
    make you feel confident. If you’re trying to figure out if you’re drinking poison,
    a posterior odds of 100 still might not cut it.
  prefs: []
  type: TYPE_NORMAL
- en: Next, we’ll look at two examples in which we use the Bayes factor to determine
    the strength of our beliefs.
  prefs: []
  type: TYPE_NORMAL
- en: '**Testing for a Loaded Die**'
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: 'We can use the Bayes factor and posterior odds as a form of hypothesis testing
    in which each test is a competition between two ideas. Suppose your friend has
    a bag with three six-sided dice in it, and one die is weighted so that it lands
    on 6 half the time. The other two are traditional dice whose probability of rolling
    a 6 is ⅙. Your friend pulls out a die and rolls 10 times, with the following results:'
  prefs: []
  type: TYPE_NORMAL
- en: 6, 1, 3, 6, 4, 5, 6, 1, 2, 6
  prefs: []
  type: TYPE_NORMAL
- en: We want to figure out if this is the loaded die or a regular die. We can call
    the loaded die *H*[1] and the regular die *H*[2].
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s start by working out the Bayes factor:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0161-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The first step is calculating *P*(*D* | *H*), or the likelihood of *H*[1] and
    *H*[2] given the data we’ve observed. In this example, your friend rolled four
    6s and six non-6s. We know that if the die is loaded, the probability of rolling
    a 6 is 1/2 and the probability of rolling any non-6 is also 1/2\. This means the
    likelihood of seeing this data given that we’ve used the loaded die is:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0161-02.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'In the case of the fair die, the probability of rolling a 6 is 1/6, while the
    probability of rolling anything else is 5/6\. This means our likelihood of seeing
    this data for *H*[2], the hypothesis that the die is fair, is:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0161-03.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Now we can compute our Bayes factor, which will tell us how much better *H*[1]
    is than *H*[2] at explaining our data, assuming each hypothesis was equally probable
    in the first place (meaning that the prior odds ratio is 1):'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0161-04.jpg)'
  prefs: []
  type: TYPE_IMG
- en: This means that *H*[1], the belief that the die is loaded, explains the data
    we observed almost four times better than *H*[2].
  prefs: []
  type: TYPE_NORMAL
- en: 'However, this is true only if *H*[1] and *H*[2] are both just as likely to
    be true in the first place. But we know there are two fair dice in the bag and
    only one loaded die, which means that each hypothesis was *not* equally likely.
    Based on the distribution of the dice in the bag, we know that these are the prior
    probabilities for each hypothesis:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0162-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'From these, we can calculate the prior odds for *H*[1]:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0162-02.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Because there is only one loaded die in the bag and two fair dice, we’re twice
    as likely to pull a fair die than a loaded one. With our prior odds for *H*[1],
    we can now compute our full posterior odds:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0162-03.jpg)'
  prefs: []
  type: TYPE_IMG
- en: While the initial likelihood ratio showed that *H*[1] explained the data almost
    four times as well as *H*[2], the posterior odds shows us that, because *H*[1]
    is only half as likely as *H*[2], *H*[1] is actually only about twice as strong
    of an explanation as *H*[2].
  prefs: []
  type: TYPE_NORMAL
- en: From this, if you absolutely had to draw a conclusion about whether the die
    was loaded or not, your best bet would be to say that it is indeed loaded. However,
    a posterior odds of less than 2 is not particularly strong evidence in favor of
    *H*[1]. If you really wanted to know whether or not the die was loaded, you would
    need to roll it a few more times until the evidence in favor of one hypothesis
    or the other was great enough for you to make a stronger decision.
  prefs: []
  type: TYPE_NORMAL
- en: Now let’s look at a second example of using the Bayes factor to determine the
    strength of our beliefs.
  prefs: []
  type: TYPE_NORMAL
- en: '**Self-Diagnosing Rare Diseases Online**'
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: Many people have made the mistake of looking up their symptoms and ailments
    online late at night, only to find themselves glued to the screen in terror, sure
    they are the victim of some strange and terrible disease! Unfortunately for them,
    their analysis almost always excludes Bayesian reasoning, which might help alleviate
    some unnecessary anxiety. In this example, let’s assume you’ve made the mistake
    of looking up your symptoms and have found two possible ailments that fit. Rather
    than panicking for no reason, you’ll use posterior odds to weigh the odds of each.
  prefs: []
  type: TYPE_NORMAL
- en: 'Suppose you wake up one day with difficulty hearing and a ringing (tinnitus)
    in one ear. It annoys you all day, and when you get home from work, you decide
    it’s high time to search the web for potential causes of your symptoms. You become
    increasingly concerned, and finally come to two possible hypotheses:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Earwax impaction** You have too much earwax in one ear. A quick visit to
    the doctor will clear up this condition.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Vestibular schwannoma** You have a brain tumor growing on the myelin sheath
    of the vestibular nerve, causing irreversible hearing loss and possibly requiring
    brain surgery.'
  prefs: []
  type: TYPE_NORMAL
- en: Of the two, the possibility of vestibular schwannoma is the most worrying. Sure,
    it could be just earwax, but what if it’s not? What if you *do* have a brain tumor?
    Since you’re most worried about the possibility of a brain tumor, you decide to
    make this your *H*[1]. Your *H*[2] is the hypothesis that you have too much earwax
    in one ear.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s see if posterior odds can calm you down.
  prefs: []
  type: TYPE_NORMAL
- en: 'As in our last example, we’ll start our exploration by looking at the likelihood
    of observing these symptoms if each hypothesis were true, and compute the Bayes
    factor. This means we need to compute *P*(*D* | *H*). You’ve observed two symptoms:
    hearing loss and tinnitus.'
  prefs: []
  type: TYPE_NORMAL
- en: 'For vestibular schwannoma, the probability of experiencing hearing loss is
    94 percent, and the probability of experiencing tinnitus is 83 percent, which
    means the probability of having hearing loss and tinnitus if you have vestibular
    schwannoma is:'
  prefs: []
  type: TYPE_NORMAL
- en: '*P* (*D* | *H*[1]) = 0.94 × 0.89 = 0.78'
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, we’ll do the same for *H*[2]. For earwax impaction, the probability of
    experiencing hearing loss is 63 percent, and the probability of experiencing tinnitus
    is 55 percent. The likelihood of having your symptoms if you have impacted earwax
    is:'
  prefs: []
  type: TYPE_NORMAL
- en: '*P* (*D* | *H*[2]) = 0.63 × 0.55 = 0.35'
  prefs: []
  type: TYPE_NORMAL
- en: 'Now we have enough information to look at our Bayes factor:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0163-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Yikes! Looking at just the Bayes factor doesn’t do much to help alleviate your
    concerns of having a brain tumor. Taking only the likelihood ratio into account,
    it appears that you’re more than twice as likely to experience these symptoms
    if you have vestibular schwannoma than if you have earwax impaction! Luckily,
    we’re not done with our analysis yet.
  prefs: []
  type: TYPE_NORMAL
- en: 'The next step is to determine the prior odds of each hypothesis. Symptoms aside,
    how likely is it for someone to have one issue versus the other? We can find epidemiological
    data for each of these diseases. It turns out that vestibular schwannoma is a
    rare condition. Only 11 in 1,000,000 people contract it each year. The prior odds
    look like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0164-01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Unsurprisingly, earwax impaction is much, much more common, with 37,000 cases
    per 1,000,000 people in a year:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0164-02.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'To get the prior odds for *H*[1], we need to look at the ratio of these two
    prior probabilities:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0164-03.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Based on prior information alone, a given person is about 3,700 times more
    likely to have an earwax impaction than vestibular schwannoma. But before you
    can breathe easy, we need to compute the full posterior odds. This just means
    multiplying our Bayes factor by our prior odds:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Image](../images/f0164-04.jpg)'
  prefs: []
  type: TYPE_IMG
- en: This result shows that *H*[2] is about 1,659 times more likely than *H*[1].
    Finally, you can relax, knowing that a visit to the doctor in the morning for
    a simple ear cleaning will likely clear all this up!
  prefs: []
  type: TYPE_NORMAL
- en: In everyday reasoning, it’s easy to overestimate the probability of scary situations,
    but by using Bayesian reasoning, we can break down the real risks and see how
    likely they actually are.
  prefs: []
  type: TYPE_NORMAL
- en: '**Wrapping Up**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In this chapter, you learned how to use the Bayes factor and posterior odds
    to compare two hypotheses. Rather than focusing on providing data to support our
    beliefs, the Bayes factor tests how well our beliefs support the data we’ve observed.
    The result is a ratio that reflects how many times better one hypothesis explains
    the data than the other. We can use it to strengthen our prior beliefs when they
    explain the data better than alternative beliefs. On the other hand, when the
    result is a fraction, we might want to consider changing our minds.
  prefs: []
  type: TYPE_NORMAL
- en: '**Exercises**'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Try answering the following questions to see how well you understand the Bayes
    factor and posterior odds. The solutions can be found at *[https://nostarch.com/learnbayes/](https://nostarch.com/learnbayes/)*.
  prefs: []
  type: TYPE_NORMAL
- en: Returning to the dice problem, assume that your friend made a mistake and suddenly
    realized that there were, in fact, two loaded dice and only one fair die. How
    does this change the prior, and therefore the posterior odds, for our problem?
    Are you more willing to believe that the die being rolled is the loaded die?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Returning to the rare diseases example, suppose you go to the doctor, and after
    having your ears cleaned you notice that your symptoms persist. Even worse, you
    have a new symptom: vertigo. The doctor proposes another possible explanation,
    labyrinthitis, which is a viral infection of the inner ear in which 98 percent
    of cases involve vertigo. However, hearing loss and tinnitus are less common in
    this disease; hearing loss occurs only 30 percent of the time, and tinnitus occurs
    only 28 percent of the time. Vertigo is also a possible symptom of vestibular
    schwannoma, but occurs in only 49 percent of cases. In the general population,
    35 people per million contract labyrinthitis annually. What is the posterior odds
    when you compare the hypothesis that you have labyrinthitis against the hypothesis
    that you have vestibular schwannoma?'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
