<html><head></head><body>
<h2 class="h2" id="ch12"><span epub:type="pagebreak" id="page_369"/><strong><span class="big">12</span><br/>UTILITIES</strong></h2>&#13;
<p class="quote">“<em>See, the world is full of things more powerful than us. But if you know how to catch a ride, you can go places,” Raven says.<br/>“Right. I’m totally hip to what you’re saying.”<br/>—Neal Stephenson</em>, Snow Crash</p>&#13;
<div class="image1"><img src="../images/common.jpg" alt="Image"/></div>&#13;
<p class="noindent">The stdlib and Boost libraries provide a throng of types, classes, and functions that satisfy common programming needs. Together, this motley collection of tools is called <em>utilities</em>. Aside from their small, uncomplicated, and focused nature, utilities vary functionally.</p>&#13;
<p class="indent">In this chapter, you’ll learn about several simple <em>data structures</em> that handle many routine situations where you need objects to contain other objects. A discussion of <em>dates and times</em> follows, including coverage of several provisions for encoding calendars and clocks and for measuring elapsed time. The chapter wraps up with a trek through many <em>numerical and mathematical tools</em> available to you.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>&#13;
<p class="notep"><em>The discussions of dates/times and numerics/math will be of great interest to certain readers and of only passing interest to others. If you are in the latter category, feel free to skim these sections.</em></p>&#13;
</div>&#13;
<h3 class="h3" id="ch12lev1sec1"><strong><span epub:type="pagebreak" id="page_370"/>Data Structures</strong></h3>&#13;
<p class="indent">Between them, the stdlib and Boost libraries provide a venerable collection of useful <em>data structures</em>. A <em>data structure</em> is a type that stores objects and permits some set of operations over those stored objects. There is no magic compiler pixie dust that makes the utility data structures in this section work; you could implement your own versions with sufficient time and effort. But why reinvent the wheel?</p>&#13;
<h4 class="h4" id="ch12lev2sec1"><strong><em>tribool</em></strong></h4>&#13;
<p class="indent">The <em>tribool</em> is a <code>bool</code>-like type that supports three states rather than two: true, false, and indeterminate. Boost offers <code>boost::logic::tribool</code> in the <code>&lt;boost/logic/tribool.hpp&gt;</code> header. <a href="ch12.xhtml#ch12ex01">Listing 12-1</a> demonstrates how to initialize Boost a <code>tribool</code> using <code>true</code>, <code>false</code>, and the <code>boost::logic::indeterminate</code> type.</p>&#13;
<pre>#include &lt;boost/logic/tribool.hpp&gt;&#13;
&#13;
using boost::logic::indeterminate; <span class="ent">➊</span>&#13;
boost::logic::tribool t = true<span class="ent">➋</span>, f = false<span class="ent">➌</span>, i = indeterminate<span class="ent">➍</span>;</pre>&#13;
<p class="listing"><a id="ch12ex01"/><em>Listing 12-1: Initializing Boost <code>tribool</code></em></p>&#13;
<p class="indent">For convenience, a <code>using</code> declaration pulls in <code>indeterminate</code> from <code>boost::logic</code> <span class="ent">➊</span>. Then you initialize the <code>tribool t</code> equal to <code>true</code> <span class="ent">➋</span>, <code>f</code> equal to <code>false</code> <span class="ent">➌</span>, and <code>i</code> equal to <code>indeterminate</code> <span class="ent">➍</span>.</p>&#13;
<p class="indent">The <code>tribool</code> class implicitly converts to <code>bool</code>. If a <code>tribool</code> is <code>true</code>, it converts to <code>true</code>; otherwise, it converts to <code>false</code>. The <code>tribool</code> class also supports <code>operator!</code>, which returns <code>true</code> if <code>tribool</code> is <code>false</code>; otherwise, it returns <code>false</code>. Finally, <code>indeterminate</code> supports <code>operator()</code>, which takes a single <code>tribool</code> argument and returns <code>true</code> if that argument is <code>indeterminate</code>; otherwise, it returns <code>false</code>.</p>&#13;
<p class="indent"><a href="ch12.xhtml#ch12ex02">Listing 12-2</a> samples these Boolean conversions.</p>&#13;
<pre>TEST_CASE("Boost tribool converts to bool") {&#13;
  REQUIRE(t); <span class="ent">➊</span>&#13;
  REQUIRE_FALSE(f); <span class="ent">➋</span>&#13;
  REQUIRE(!f); <span class="ent">➌</span>&#13;
  REQUIRE_FALSE(!t); <span class="ent">➍</span>&#13;
  REQUIRE(indeterminate(i)); <span class="ent">➎</span>&#13;
  REQUIRE_FALSE(indeterminate(t)); <span class="ent">➏</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex02"/><em>Listing 12-2: Converting a <code>tribool</code> to a <code>bool</code></em></p>&#13;
<p class="indent">This test demonstrates the basic results from <code>bool</code> conversion <span class="ent">➊</span><span class="ent">➋</span>, <code>operator!</code> <span class="ent">➌</span><span class="ent">➍</span>, and <code>indeterminate</code> <span class="ent">➍➎</span>.</p>&#13;
<h5 class="h5" id="ch12lev3sec1"><strong>Boolean Operations</strong></h5>&#13;
<p class="noindent">The <code>tribool</code> class supports all the Boolean operators. Whenever a <code>tribool</code> expression doesn’t involve an <code>indeterminate</code> value, the result is the same as <span epub:type="pagebreak" id="page_371"/>the equivalent Boolean expression. Whenever an <code>indeterminate</code> is involved, the result can be <code>indeterminate</code>, as <a href="ch12.xhtml#ch12ex03">Listing 12-3</a> illustrates.</p>&#13;
<pre>TEST_CASE("Boost Tribool supports Boolean operations") {&#13;
  auto t_or_f = t || f;&#13;
  REQUIRE(t_or_f); <span class="ent">➊</span>&#13;
  REQUIRE(indeterminate(t &amp;&amp; indeterminate)); <span class="ent">➋</span>&#13;
  REQUIRE(indeterminate(f || indeterminate)); <span class="ent">➌</span>&#13;
  REQUIRE(indeterminate(!i)); <span class="ent">➍</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex03"/><em>Listing 12-3: The <code>boost::tribool</code> supports Boolean operations.</em></p>&#13;
<p class="indent">Because neither <code>t</code> nor <code>f</code> is indeterminate, <code>t || f</code> evaluates just like an ordinary Boolean expression, so <code>t_or_f</code> is <code>true</code> <span class="ent">➊</span>. Boolean expressions that involve an indeterminate can be indeterminate. Boolean AND <span class="ent">➋</span>, OR <span class="ent">➌</span>, and NOT <span class="ent">➍</span> evaluate to <code>indeterminate</code> if there isn’t enough information.</p>&#13;
<h5 class="h5" id="ch12lev3sec2"><strong>When to Use tribool</strong></h5>&#13;
<p class="noindent">Aside from describing the vital status of Schrödinger’s cat, you can use <code>tri</code><code>bool</code> in settings in which operations can take a long time. In such settings, a <code>tribool</code> could describe whether the operation was successful. An <code>indeterminate</code> value could model that the operation is still pending.</p>&#13;
<p class="indent">The <code>tribool</code> class makes for neat, concise <code>if</code> statements, as shown in <a href="ch12.xhtml#ch12ex04">Listing 12-4</a>.</p>&#13;
<pre>TEST_CASE("Boost Tribool works nicely with if statements") {&#13;
  if (i) FAIL("Indeterminate is true."); <span class="ent">➊</span>&#13;
  else if (!i) FAIL("Indeterminate is <span class="codestrong1">false</span>."); <span class="ent">➋</span>&#13;
  else {} // OK, indeterminate <span class="ent">➌</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex04"/><em>Listing 12-4: Using an <code>if</code> statement with <code>tribool</code></em></p>&#13;
<p class="indent">The first expression <span class="ent">➊</span> evaluates only if the <code>tribool</code> is <code>true</code>, the second expression <span class="ent">➋</span> evaluates only if it’s <code>false</code>, and the third only executes in the <code>indeterminate</code> case <span class="ent">➌</span>.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>&#13;
<p class="notep"><em>The mere mention of a <code>tribool</code> might have caused you to scrunch up your face in disgust. Why, you might ask, couldn’t you just use an integer where 0 is false, 1 is true, and any other value is indeterminate? You could, but consider that the <code>tribool</code> type supports all the usual Boolean operations while correctly propagating indeterminate values. Again, why reinvent the wheel?</em></p>&#13;
</div>&#13;
<h5 class="h5" id="ch12lev3sec3"><strong>A Partial List of Supported Operations</strong></h5>&#13;
<p class="noindent"><a href="ch12.xhtml#ch12tab01">Table 12-1</a> provides a list of the most supported <code>boost::tribool</code> operations. In this table, <code>tb</code> is a <code>boost::tribool</code>.</p>&#13;
<p class="tabcap"><span epub:type="pagebreak" id="page_372"/><a id="ch12tab01"/><strong>Table 12-1:</strong> The Most Supported <code>boost::tribool</code> Operations</p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:30%"/>&#13;
<col style="width:70%"/>&#13;
</colgroup>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Operation</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Notes</strong></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>tribool{}</code> <code>tribool{ false }</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Constructs a <code>tribool</code> with value <code>false</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>tribool{ true }</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Constructs a <code>tribool</code> with value <code>true</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>tribool{ indeterminate }</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Constructs a <code>tribool</code> with value <code>indeterminate</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">tb</span><code>.safe_bool()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Evaluates to <code>true</code> if <span class="codestrong">tb</span> is <code>true</code>, else <code>false</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>indeterminate(</code><span class="codestrong">tb</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Evaluates to <code>true</code> if <span class="codestrong">tb</span> is <code>indeterminate</code>, else <code>false</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">!tb</span></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Evaluates to <code>true</code> if <span class="codestrong">tb</span> is <code>false</code>, else <code>false</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">tb1</span><code> &amp;&amp;</code> <span class="codestrong">tb2</span></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Evaluates to <code>true</code> if <span class="codestrong">tb1</span> and <span class="codestrong">tb2</span> are <code>true</code>; evaluates to <code>false</code> if <span class="codestrong">tb1</span> or <span class="codestrong">tb2</span> are <code>false</code>; otherwise, <code>indeterminate</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">tb1</span> <code>||</code> <span class="codestrong">tb2</span></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Evaluates to <code>true</code> if <span class="codestrong">tb1</span> or <span class="codestrong">tb2</span> are <code>true</code>; evaluates to <code>false</code> if <span class="codestrong">tb1</span> and <span class="codestrong">tb2</span> are <code>false</code>; otherwise, <code>indeterminate</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba"><code>bool{</code> <span class="codestrong">tb</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba">Evaluates to <code>true</code> if <span class="codestrong">tb</span> is true, else <code>false</code>.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<h4 class="h4" id="ch12lev2sec2"><strong><em>optional</em></strong></h4>&#13;
<p class="indent">An <em>optional</em> is a class template that contains a value that might or might not be present. The primary use case for an <code>optional</code> is the return type of a function that might fail. Rather than throwing an exception or returning multiple values, a function can instead return an <code>optional</code> that will contain a value if the function succeeded.</p>&#13;
<p class="indent">The stdlib has <code>std::optional</code> in the <code>&lt;optional&gt;</code> header, and Boost has <code>boost::optional</code> in the <code>&lt;boost/optional.hpp&gt;</code> header.</p>&#13;
<p class="indent">Consider the setup in <a href="ch12.xhtml#ch12ex05">Listing 12-5</a>. The function <code>take</code> wants to return an instance of <code>TheMatrix</code> only if you take a <code>Pill::Blue</code>; otherwise, <code>take</code> returns a <code>std::nullopt</code>, which is a stdlib-provided constant <code>std::optional</code> type with uninitialized state.</p>&#13;
<pre>#include &lt;optional&gt;&#13;
&#13;
struct TheMatrix { <span class="ent">➊</span>&#13;
  TheMatrix(int x) : iteration { x } { }&#13;
  const int iteration;&#13;
};&#13;
&#13;
enum Pill { Red, Blue }; <span class="ent">➋</span>&#13;
&#13;
std::optional&lt;TheMatrix&gt;<span class="ent">➌</span> take(Pill pill<span class="ent">➍</span>) {&#13;
  if(pill == Pill::Blue) return TheMatrix{ 6 }; <span class="ent">➎</span>&#13;
  return std::nullopt; <span class="ent">➏</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex05"/><em>Listing 12-5: A <code>take</code> function returning a <code>std::optional</code></em></p>&#13;
<p class="indent">The <code>TheMatrix</code> type takes a single <code>int</code> constructor argument and stores it into the <code>iteration</code> member <span class="ent">➊</span>. The <code>enum</code> called <code>Pill</code> takes the values <code>Red</code> and <span epub:type="pagebreak" id="page_373"/><code>Blue</code> <span class="ent">➋</span>. The <code>take</code> function returns a <code>std::optional&lt;TheMatrix&gt;</code> <span class="ent">➌</span> and accepts a single <code>Pill</code> argument <span class="ent">➍</span>. If you pass <code>Pill::Blue</code> to the take function, it returns a <code>TheMatrix</code> instance <span class="ent">➎</span>; otherwise, it returns a <code>std::nullopt</code> <span class="ent">➏</span>.</p>&#13;
<p class="indent">First, consider <a href="ch12.xhtml#ch12ex06">Listing 12-6</a>, where you take the blue pill.</p>&#13;
<pre>TEST_CASE("std::optional contains types") {&#13;
  if (auto matrix_opt = take(Pill::Blue)) { <span class="ent">➊</span>&#13;
    REQUIRE(matrix_opt-&gt;iteration == 6); <span class="ent">➋</span>&#13;
    auto&amp; matrix = matrix_opt.value(); &#13;
    REQUIRE(matrix.iteration == 6); <span class="ent">➌</span>&#13;
  } else {&#13;
    FAIL("The optional evaluated to false.");&#13;
  }&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex06"/><em>Listing 12-6: A test exploring the <code>std::optional</code> type with <code>Pill::Blue</code></em></p>&#13;
<p class="indent">You take the blue pill, which results in the <code>std::optional</code> result containing an initialized <code>TheMatrix</code>, so the <code>if</code> statement’s conditional expression evaluates to <code>true</code> <span class="ent">➊</span>. <a href="ch12.xhtml#ch12ex06">Listing 12-6</a> also demonstrates the use of <code>operator-&gt;</code> <span class="ent">➋</span> and <code>value()</code> <span class="ent">➌</span> to access the underlying value.</p>&#13;
<p class="indent">What happens when you take the red pill? Consider <a href="ch12.xhtml#ch12ex07">Listing 12-7</a>.</p>&#13;
<pre>TEST_CASE("std::optional can be empty") {&#13;
  auto matrix_opt = take(Pill::Red); <span class="ent">➊</span>&#13;
  if (matrix_opt) FAIL("The Matrix is not empty."); <span class="ent">➋</span>&#13;
  REQUIRE_FALSE(matrix_opt.has_value()); <span class="ent">➌</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex07"/><em>Listing 12-7: A test exploring the <code>std::optional</code> type with <code>Pill::Red</code></em></p>&#13;
<p class="indent">You take the red pill <span class="ent">➊</span>, and the resulting <code>matrix_opt</code> is empty. This means <code>matrix_opt</code> converts to <code>false</code> <span class="ent">➋</span> and <code>has_value()</code> also returns <code>false</code> <span class="ent">➌</span>.</p>&#13;
<h5 class="h5" id="ch12lev3sec4"><strong>A Partial List of Supported Operations</strong></h5>&#13;
<p class="noindent"><a href="ch12.xhtml#ch12tab02">Table 12-2</a> provides a list of the most supported <code>std::optional</code> operations. In this table, <code>opt</code> is a <code>std::optional&lt;T&gt;</code> and <code>t</code> is an object of type <code>T</code>.</p>&#13;
<p class="tabcap"><a id="ch12tab02"/><strong>Table 12-2:</strong> The Most Supported <code>std::optional</code> Operations</p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:30%"/>&#13;
<col style="width:70%"/>&#13;
</colgroup>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Operation</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Notes</strong></p>&#13;
</td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>optional&lt;T&gt;{}</code><br/><code>optional&lt;T&gt;{std::nullopt}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Constructs an empty <code>optional</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>optional&lt;T&gt;{</code> <span class="codestrong">opt</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Copy constructs an <code>optional</code> from <span class="codestrong">opt</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>optional&lt;T&gt;{ move(</code><span class="codestrong">opt</span><code>) }</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Move constructs an <code>optional</code> from <span class="codestrong">opt</span>, which is empty after the constructor completes.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>optional&lt;T&gt;{</code> <code>t</code> <code>}</code> <span class="codestrong">opt</span> <code>=</code> <span class="codestrong">t</span></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Copies <span class="codestrong">t</span> into <code>optional</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>optional&lt;T&gt;{ move(</code><code>t</code><code>) }</code> <span class="codestrong">opt</span> = <code>move(</code><span class="codestrong">t</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Moves <span class="codestrong">t</span> into <code>optional</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span epub:type="pagebreak" id="page_374"/><span class="codestrong">opt</span><code>-&gt;</code><span class="codestrong">mbr</span></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Member dereference; accesses the <span class="codestrong">mbr</span> member of object contained by <span class="codestrong">opt</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>*</code><span class="codestrong">opt</span> <span class="codestrong">opt</span><code>.value()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Returns a reference to the object contained by <span class="codestrong">opt</span>; <code>value()</code> checks for empty and throws <code>bad_optional_access</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">opt</span><code>.value_or(</code><span class="codestrong">T</span><code>{ ... })</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">If <span class="codestrong">opt</span> contains an object, returns a copy; else returns the argument.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>bool{</code> <span class="codestrong">opt</span> <code>}</code><br/><span class="codestrong">opt</span><code>.has_value()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Returns <code>true</code> if <span class="codestrong">opt</span> contains an object, else <code>false</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">opt1</span><code>.swap(</code><span class="codestrong">opt2</span><code>)</code> <code>swap(</code><span class="codestrong">opt1</span><code>,</code> <span class="codestrong">opt2</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Swaps the objects contained by <span class="codestrong">opt1</span> and <span class="codestrong">opt2</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">opt</span><code>.reset()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Destroys object contained by <span class="codestrong">opt</span>, which is empty after <code>reset</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">opt</span><code>.emplace(...)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Constructs a type in place, forwarding all arguments to the appropriate constructor.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>make_optional&lt;T&gt;(...)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Convenience function for constructing an <code>optional</code>; forwards arguments to the appropriate constructor.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b2"><p class="taba"><span class="codestrong">opt1</span> <code>==</code> <span class="codestrong">opt2</span></p>&#13;
<p class="taba"><span class="codestrong">opt1</span> <code>!=</code> <span class="codestrong">opt2</span></p>&#13;
<p class="taba"><span class="codestrong">opt1</span> <code>&gt;</code> <span class="codestrong">opt2</span></p>&#13;
<p class="taba"><span class="codestrong">opt1</span> <code>&gt;=</code> <span class="codestrong">opt2</span></p>&#13;
<p class="taba"><span class="codestrong">opt1</span> <code>&lt;</code> <span class="codestrong">opt2</span></p>&#13;
<p class="taba"><span class="codestrong">opt1</span> <code>&lt;=</code> <span class="codestrong">opt2</span></p></td>&#13;
<td style="vertical-align: top;" class="table-b2"><p class="taba">When evaluating equality of two <code>optional</code> objects, <code>true</code> if both are empty or if both contain objects and those objects are equal; else <code>false</code>. For comparison, an empty <code>optional</code> is always less than an optional containing a value. Otherwise, the result is the comparison of the contained types.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<h4 class="h4" id="ch12lev2sec3"><strong><em>pair</em></strong></h4>&#13;
<p class="noindent">A <em>pair</em> is a class template that contains two objects of different types in a single object. The objects are ordered, and you can access them via the members <code>first</code> and <code>second</code>. A <code>pair</code> supports comparison operators, has defaulted copy/move constructors, and works with structured binding syntax.</p>&#13;
<p class="indent">The stdlib has <code>std::pair</code> in the <code>&lt;utility&gt;</code> header, and Boost has <code>boost::pair</code> in the <code>&lt;boost/pair.hpp&gt;</code> header.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>&#13;
<p class="notep"><em>Boost also has <code>boost::compressed_pair</code> available in the <code>&lt;boost/compressed_pair.hpp&gt;</code> header. It’s slightly more efficient when one of the members is empty.</em></p>&#13;
</div>&#13;
<p class="indent">First, you create some simple types to make a pair out of, such as the simple <code>Socialite</code> and <code>Valet</code> classes in <a href="ch12.xhtml#ch12ex08">Listing 12-8</a>.</p>&#13;
<pre>#include &lt;utility&gt;&#13;
&#13;
struct Socialite { const char* birthname; };&#13;
struct Valet { const char* surname; };&#13;
Socialite bertie{ "Wilberforce" };&#13;
Valet reginald{ "Jeeves" };</pre>&#13;
<p class="listing"><a id="ch12ex08"/><em>Listing 12-8: The <code>Socialite</code> and <code>Valet</code> classes</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_375"/>Now that you have a <code>Socialite</code> and a <code>Valet</code>, <code>bertie</code> and <code>reginald</code>, you can construct a <code>std::pair</code> and experiment with extracting elements. <a href="ch12.xhtml#ch12ex09">Listing 12-9</a> uses the <code>first</code> and <code>second</code> members to access the contained types.</p>&#13;
<pre>TEST_CASE("std::pair permits access to members") {&#13;
  std::pair&lt;Socialite, Valet&gt; inimitable_duo{ bertie, reginald }; <span class="ent">➊</span>&#13;
  REQUIRE(inimitable_duo.first.birthname == bertie.birthname); <span class="ent">➋</span>&#13;
  REQUIRE(inimitable_duo.second.surname == reginald.surname); <span class="ent">➌</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex09"/><em>Listing 12-9: The <code>std::pair</code> supports member extraction.</em></p>&#13;
<p class="indent">You construct a <code>std::pair</code> by passing in the objects you want to copy <span class="ent">➊</span>. You use the <code>first</code> and <code>second</code> members of <code>std::pair</code> to extract the <code>Socialite</code> <span class="ent">➋</span> and <code>Valet</code> <span class="ent">➌</span> out of <code>inimitable_duo</code>. Then you can compare the <code>birthname</code> and <code>surname</code> members of these to their originals.</p>&#13;
<p class="indent"><a href="ch12.xhtml#ch12ex10">Listing 12-10</a> shows <code>std::pair</code> member extraction and structured binding syntax.</p>&#13;
<pre>TEST_CASE("std::pair works with structured binding") {&#13;
  std::pair&lt;Socialite, Valet&gt; inimitable_duo{ bertie, reginald };&#13;
  auto&amp; [idle_rich, butler] = inimitable_duo; <span class="ent">➊</span>&#13;
  REQUIRE(idle_rich.birthname == bertie.birthname); <span class="ent">➋</span>&#13;
  REQUIRE(butler.surname == reginald.surname); <span class="ent">➌</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex10"/><em>Listing 12-10: The <code>std::pair</code> supports structured binding syntax.</em></p>&#13;
<p class="indent">Here you use the structured binding syntax <span class="ent">➊</span> to extract references to the <code>first</code> and <code>second</code> members of <code>inimitable_duo</code> into <code>idle_rich</code> and <code>butler</code>. As in <a href="ch12.xhtml#ch12ex09">Listing 12-9</a>, you ensure that the <code>birthname</code> <span class="ent">➋</span> and <code>surname</code> <span class="ent">➌</span> match the originals.</p>&#13;
<h5 class="h5" id="ch12lev3sec5"><strong>A Partial List of Supported Operations</strong></h5>&#13;
<p class="noindent"><a href="ch12.xhtml#ch12tab03">Table 12-3</a> provides a list of the most supported <code>std::pair</code> operations. In this table, <code>pr</code> is a <code>std::pair&lt;A, B&gt;</code>, <code>a</code> is an object of type <code>A</code>, and <code>b</code> is an object of type <code>B</code>.</p>&#13;
<p class="tabcap"><a id="ch12tab03"/><strong>Table 12-3:</strong> The Most Supported <code>std::pair</code> Operations</p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:30%"/>&#13;
<col style="width:70%"/>&#13;
</colgroup>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Operation</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Notes</strong></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>pair&lt;...&gt;{}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Constructs an empty <code>pair</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>pair&lt;...&gt;{</code> <span class="codestrong">pr</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Copy constructs from <span class="codestrong">pr</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>pair&lt;...&gt;{ move(</code><span class="codestrong">pr</span><code>) }</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Move constructs from <span class="codestrong">pr</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>pair&lt;...&gt;{</code> <span class="codestrong">a</span><code>,</code> <span class="codestrong">b</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Constructs a <code>pair</code> by copying <span class="codestrong">a</span> and <span class="codestrong">b</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>pair&lt;...&gt;{ move(</code><span class="codestrong">a</span><code>), move(</code><span class="codestrong">b</span><code>) }</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Constructs a <code>pair</code> by moving <span class="codestrong">a</span> and <span class="codestrong">b</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">pr1</span> <code>=</code> <span class="codestrong">pr2</span></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Copy assigns from <span class="codestrong">pr2</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">pr1</span> = <code>move(</code><span class="codestrong">pr2</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Move assigns from <span class="codestrong">pr2</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span epub:type="pagebreak" id="page_376"/><span class="codestrong">pr</span><code>.first</code><br/><code>get&lt;0&gt;(</code><span class="codestrong">pr</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Returns a reference to the <code>first</code> element.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">pr</span><code>.second</code><br/><code>get&lt;1&gt;(</code><span class="codestrong">pr</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Returns a reference to the <code>second</code> element.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>get&lt;</code><span class="codestrong">T</span><code>&gt;(</code><span class="codestrong">pr</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">If <code>first</code> and <code>second</code> have different types, returns a reference to the element of type <span class="codestrong">T</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">pr1</span><code>.swap(</code><span class="codestrong">pr2</span><code>)</code><br/><code>swap(</code><span class="codestrong">pr1</span><code>,</code> <span class="codestrong">pr2</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Swaps the objects contained by <span class="codestrong">pr1</span> and <span class="codestrong">pr2</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>make_pair&lt;...&gt;(</code><span class="codestrong">a</span><code>,</code> <span class="codestrong">b</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Convenience function for constructing a <code>pair</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba"><span class="codestrong">pr1</span> <code>==</code> <span class="codestrong">pr2</span></p>&#13;
<p class="taba"><span class="codestrong">pr1</span> <code>!=</code> <span class="codestrong">pr2</span></p>&#13;
<p class="taba"><span class="codestrong">pr1</span> <code>&gt;</code> <span class="codestrong">pr2</span></p>&#13;
<p class="taba"><span class="codestrong">pr1</span> <code>&gt;=</code> <span class="codestrong">pr2</span></p>&#13;
<p class="taba"><span class="codestrong">pr1</span> <code>&lt;</code> <span class="codestrong">pr2</span></p>&#13;
<p class="taba"><span class="codestrong">pr1</span> <code>&lt;=</code> <span class="codestrong">pr2</span></p></td>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba">Equal if both <code>first</code> and <code>second</code> are equal.<br/>Greater than/less than comparisons begin with <code>first</code>. If <code>first</code> members are equal, compare <code>second</code> members.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<h4 class="h4" id="ch12lev2sec4"><strong><em>tuple</em></strong></h4>&#13;
<p class="noindent">A <em>tuple</em> is a class template that takes an arbitrary number of heterogeneous elements. It’s a generalization of <code>pair</code>, but a <code>tuple</code> doesn’t expose its members as <code>first</code>, <code>second</code>, and so on like a <code>pair</code>. Instead, you use the non-member function template <code>get</code> to extract elements.</p>&#13;
<p class="indent">The stdlib has <code>std::tuple</code> and <code>std::get</code> in the <code>&lt;tuple&gt;</code> header, and Boost has <code>boost::tuple</code> and <code>boost::get</code> in the <code>&lt;boost/tuple/tuple.hpp&gt;</code> header.</p>&#13;
<p class="indent">Let’s add a third class, <code>Acquaintance</code>, to test a <code>tuple</code>:</p>&#13;
<pre>struct Acquaintance { const char* nickname; };&#13;
Acquaintance hildebrand{ "Tuppy" };</pre>&#13;
<p class="indent">To extract these elements, you have two modes of using <code>get</code>. In the primary case, you can always provide a template parameter corresponding to the zero-based index of the element you want to extract. In the event the <code>tuple</code> doesn’t contain elements with the same types, you can alternatively provide a template parameter corresponding to the type of the element you want to extract, as <a href="ch12.xhtml#ch12ex11">Listing 12-11</a> illustrates.</p>&#13;
<pre>TEST_CASE("std::tuple permits access to members with std::get") {&#13;
  using Trio = std::tuple&lt;Socialite, Valet, Acquaintance&gt;;&#13;
  Trio truculent_trio{ bertie, reginald, hildebrand };&#13;
  auto&amp; bertie_ref = std::get&lt;0&gt;(truculent_trio); <span class="ent">➊</span>&#13;
  REQUIRE(bertie_ref.birthname == bertie.birthname);&#13;
&#13;
  auto&amp; tuppy_ref = std::get&lt;Acquaintance&gt;(truculent_trio); <span class="ent">➋</span>&#13;
  REQUIRE(tuppy_ref.nickname == hildebrand.nickname);&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex11"/><em>Listing 12-11: A <code>std::tuple</code> supports member extraction and structured binding syntax.</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_377"/>You can build a <code>std::tuple</code> in an analogous way to how you built a <code>std::pair</code>. First, you extract the <code>Socialite</code> member with <code>get&lt;0&gt;</code> <span class="ent">➊</span>. Because <code>Socialite</code> is the first template parameter, you use 0 for the <code>std::get</code> template parameter. Then you extract the <code>Acquaintance</code> member with <code>std::get&lt;Acquaintance&gt;</code> <span class="ent">➋</span>. Because there’s only one element of type <code>Acquaintance</code>, you’re permitted to use this mode of <code>get</code> access.</p>&#13;
<p class="indent">Like <code>pair</code>, <code>tuple</code> also allows structured binding syntax.</p>&#13;
<h5 class="h5" id="ch12lev3sec6"><strong>A Partial List of Supported Operations</strong></h5>&#13;
<p class="noindent"><a href="ch12.xhtml#ch12tab04">Table 12-4</a> provides a list of the most supported <code>std::tuple</code> operations. In this table, <code>tp</code> is a <code>std::tuple&lt;A, B&gt;</code>, <code>a</code> is an object of type <code>A</code>, and <code>b</code> is an object of type <code>B</code>.</p>&#13;
<p class="tabcap"><a id="ch12tab04"/><strong>Table 12-4:</strong> The Most Supported <code>std::tuple</code> Operations</p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:30%"/>&#13;
<col style="width:70%"/>&#13;
</colgroup>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Operation</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Notes</strong></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>tuple&lt;...&gt;{</code> <span class="codestrong">[alc]</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Constructs an empty <code>tuple</code>. Uses <code>std::allocate</code> as default allocator <span class="codestrong">alc</span>.</p></td></tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>tuple&lt;...&gt;{</code> <span class="codestrong">[alc]</span><code>,</code> <span class="codestrong">tp</span><code> }</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Copy constructs from <span class="codestrong">tp</span>. Uses <code>std::allocate</code> as default allocator <span class="codestrong">alc</span>.</p></td></tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>tuple&lt;...&gt;{</code> <span class="codestrong">[alc]</span><code>,move(</code><span class="codestrong">tp</span><code>) }</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Move constructs from <span class="codestrong">tp</span>. Uses <code>std::allocate</code> as default allocator <span class="codestrong">alc</span>.</p></td></tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>tuple&lt;...&gt;{</code> <span class="codestrong">[alc]</span><code>,</code> <span class="codestrong">a</span><code>,</code> <span class="codestrong">b</span><code> }</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Constructs a <code>tuple</code> by copying <span class="codestrong">a</span> and <span class="codestrong">b</span>. Uses <code>std::allocate</code> as default allocator <span class="codestrong">alc</span>.</p></td></tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>tuple&lt;...&gt;{</code> <span class="codestrong">[alc]</span><code>, move(</code><span class="codestrong">a</span><code>), move(</code><span class="codestrong">b</span><code>) }</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Constructs a <code>tuple</code> by moving <span class="codestrong">a</span> and <span class="codestrong">b</span>. Uses <code>std::allocate</code> as default allocator <span class="codestrong">alc</span>.</p></td></tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">tp1</span><code> =</code> <span class="codestrong">tp2</span></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Copy assigns from <span class="codestrong">tp2</span>.</p></td></tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">tp1</span> = <code>move(</code><span class="codestrong">tp2</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Move assigns from <span class="codestrong">tp2</span>.</p></td></tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>get&lt;</code><span class="codestrong">i</span><code>&gt;(</code><span class="codestrong">tp</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Returns a reference to the <span class="codestrong">i</span>th element (zero-based).</p></td></tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>get&lt;</code><span class="codestrong">T</span><code>&gt;(</code><span class="codestrong">tp</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Returns a reference to the element of type <span class="codestrong">T</span>. Fails to compile if more than one element share this type.</p></td></tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">tp1</span><code>.swap(</code><span class="codestrong">tp2</span><code>)</code><br/><code>swap(</code><span class="codestrong">tp1</span><code>,</code> <span class="codestrong">tp2</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Swaps the objects contained by <span class="codestrong">tp1</span> and <span class="codestrong">tp2</span>.</p></td></tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>make_tuple&lt;...&gt;(</code><span class="codestrong">a</span><code>,</code> <span class="codestrong">b</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Convenience function for constructing a <code>tuple</code>.</p></td></tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>tuple_cat&lt;...&gt;(</code><span class="codestrong">tp1</span><code>,</code> <span class="codestrong">tp2</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Concatenates all the tuples passed in as arguments.</p></td></tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba"><span class="codestrong">tp1</span> <code>==</code> <span class="codestrong">tp2</span></p>&#13;
<p class="taba"><span class="codestrong">tp1</span> <code>!=</code> <span class="codestrong">tp2</span></p>&#13;
<p class="taba"><span class="codestrong">tp1</span> <code>&gt;</code> <span class="codestrong">tp2</span></p>&#13;
<p class="taba"><span class="codestrong">tp1</span> <code>&gt;=</code> <span class="codestrong">tp2</span></p>&#13;
<p class="taba"><span class="codestrong">tp1</span> <code>&lt;</code> <span class="codestrong">tp2</span></p>&#13;
<p class="taba"><span class="codestrong">tp1</span> <code>&lt;=</code> <span class="codestrong">tp2</span></p></td>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba">Equal if all elements are equal.<br/>Greater than/less than comparisons proceed from first element to last.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<h4 class="h4" id="ch12lev2sec5"><strong><em><span epub:type="pagebreak" id="page_378"/>any</em></strong></h4>&#13;
<p class="indent">An <em>any</em> is a class that stores single values of any type. It is <em>not</em> a class template. To convert an <code>any</code> into a concrete type, you use an <em>any cast</em>, which is a non-member function template. Any cast conversions are type safe; if you attempt to cast an <code>any</code> and the type doesn’t match, you get an exception. With <code>any</code>, you can perform some kinds of generic programming <em>without templates</em>.</p>&#13;
<p class="indent">The stdlib has <code>std::any</code> in the <code>&lt;any&gt;</code> header, and Boost has <code>boost::any</code> in the <code>&lt;boost/any.hpp&gt;</code> header.</p>&#13;
<p class="indent">To store a value into an <code>any</code>, you use the <code>emplace</code> method template. It takes a single template parameter corresponding to the type you want to store into <code>any</code> (the <em>storage type</em>). Any arguments you pass into <code>emplace</code> get forwarded to an appropriate constructor for the given storage type. To extract the value, you use <code>any_cast</code>, which takes a template parameter corresponding to the current storage type of <code>any</code> (called the <em>state</em> of <code>any</code>). You pass the <code>any</code> as the sole parameter to <code>any_cast</code>. As long as the state of <code>any</code> matches the template parameter, you get the desired type out. If the state doesn’t match, you get a <code>bad_any_cast</code> exception.</p>&#13;
<p class="indent"><a href="ch12.xhtml#ch12ex12">Listing 12-12</a> illustrates these basic interactions with a <code>std::any</code>.</p>&#13;
<pre>#include &lt;any&gt;&#13;
&#13;
struct EscapeCapsule {&#13;
  EscapeCapsule(int x) : weight_kg{ x } { }&#13;
  int we<a id="_idTextAnchor481"/>ight_kg;&#13;
}; <span class="ent">➊</span>&#13;
&#13;
TEST_CASE("std::any allows us to std::any_cast into a type") {&#13;
  std::any hagunemnon; <span class="ent">➋</span>&#13;
  hagunemnon.emplace&lt;EscapeCapsule&gt;(600); <span class="ent">➌</span>&#13;
  auto capsule = std::any_cast&lt;EscapeCapsule&gt;(hagunemnon); <span class="ent">➍</span>&#13;
  REQUIRE(capsule.weight_kg == 600);&#13;
  REQUIRE_THROWS_AS(std::any_cast&lt;float&gt;(hagunemnon), std::bad_any_cast); <span class="ent">➎</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex12"/><em>Listing 12-12: The <code>std::any</code> and <code>std::any_cast</code> allow you to extract concrete types.</em></p>&#13;
<p class="indent">You declare the <code>EscapeCapsule</code> class <span class="ent">➊</span>. Within the test, you construct an empty <code>std::any</code> called <code>hagunemnon</code> <span class="ent">➋</span>. Next, you use <code>emplace</code> to store an <code>EscapeCapsule</code> with <code>weight_kg = 600</code> <span class="ent">➌</span>. You can extract the <code>EscapeCapsule</code> back <span epub:type="pagebreak" id="page_379"/>out using <code>std::any_cast</code> <span class="ent">➍</span>, which you store into a new <code>EscapeCapsule</code> called <code>capsule</code>. Finally, you show that attempting to invoke <code>any_cast</code> to cast the <code>hagunemnon</code> into a <code>float</code> results in a <code>std::bad_any_cast</code> exception <span class="ent">➎</span>.</p>&#13;
<h5 class="h5" id="ch12lev3sec7"><strong>A Partial List of Supported Operations</strong></h5>&#13;
<p class="noindent"><a href="ch12.xhtml#ch12tab05">Table 12-5</a> provides a list of the most supported <code>std::any</code> operations. In this table, <code>ay</code> is a <code>std::any</code> and <code>t</code> is an object of type <code>T</code>.</p>&#13;
<p class="tabcap"><a id="ch12tab05"/><strong>Table 12-5:</strong> The Most Supported <code>std::any</code> Operations</p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:30%"/>&#13;
<col style="width:70%"/>&#13;
</colgroup>&#13;
<tbody>&#13;
<tr>&#13;
<th style="vertical-align: top;" class="table-h"><p class="taba"><strong>Operation</strong></p></th>&#13;
<th style="vertical-align: top;" class="table-h"><p class="taba"><strong>Notes</strong></p></th>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>any{}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Constructs an empty <code>any</code> object.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>any{</code> <span class="codestrong">ay</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Copy constructs from <span class="codestrong">ay</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>any{ move(</code><span class="codestrong">ay</span><code>) }</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Move constructs from <span class="codestrong">ay</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>any{ move(</code><span class="codestrong">t</span><code>) }</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Constructs an <code>any</code> object containing an in-place constructed object from <span class="codestrong">t</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">ay</span> <code> =</code> <span class="codestrong">t</span></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Destructs the object currently contained by <span class="codestrong">ay</span>; copies <span class="codestrong">t</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">ay</span> <code> = move(</code><span class="codestrong">t</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Destructs the object currently contained by <span class="codestrong">ay</span>; moves <span class="codestrong">t</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">ay1</span> <code> =</code> <span class="codestrong">ay2</span></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Copy assigns from <span class="codestrong">ay2</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">ay1</span> <code> = move(</code><span class="codestrong">ay2</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Move assigns from <span class="codestrong">ay2</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">ay</span><code>.emplace&lt;</code><span class="codestrong">T</span><code>&gt;(...)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Destructs the object currently contained by <span class="codestrong">ay</span>; constructs a <span class="codestrong">T</span> in place, forwarding the arguments <code>...</code> to the appropriate constructor.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">ay</span><code>.reset()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Destroys the currently contained object.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">ay1</span><code>.swap(</code><span class="codestrong">ay2</span><code>)</code><br/><code>swap(</code><span class="codestrong">ay1</span><code>,</code> <span class="codestrong">ay2</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Swaps the objects contained by <span class="codestrong">ay1</span> and <span class="codestrong">ay2</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>make_any&lt;</code><span class="codestrong">T</span><code>&gt;(...)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Convenience function for constructing an <code>any</code> constructs a <span class="codestrong">T</span> in place, forwarding the arguments <code>...</code> to the appropriate constructor.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba"><span class="codestrong">t</span> <code> = any_cast&lt;</code><span class="codestrong">T</span><code>&gt;(</code><span class="codestrong">ay</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba">Casts <span class="codestrong">ay</span> into type <span class="codestrong">T</span>. Throws a <code>std::bad_any_cast</code> if the type <span class="codestrong">T</span> doesn’t match the contained object’s type.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<h4 class="h4" id="ch12lev2sec6"><strong><em>variant</em></strong></h4>&#13;
<p class="noindent">A <em>variant</em> is a class template that stores single values whose types are restricted to the user-defined list provided as template parameters. The variant is a type-safe <code>union</code> (refer to “Unions” on <a href="ch02.xhtml#page_53">page 53</a>). It shares a lot of functionality with the <code>any</code> type, but <code>variant</code> requires that you explicitly enumerate all the types that you’ll store.</p>&#13;
<p class="indent">The stdlib has <code>std::variant</code> in the <code>&lt;variant&gt;</code> header, and Boost has <code>boost::variant</code> in the <code>&lt;boost/variant.hpp&gt;</code> header.</p>&#13;
<p class="indent"><a href="ch12.xhtml#ch12ex13">Listing 12-13</a> demonstrates creating another type called <code>BugblatterBeast</code> for <code>variant</code> to contain alongside <code>EscapeCapsule</code>.</p>&#13;
<pre>#include &lt;variant&gt;&#13;
&#13;
struct BugblatterBeast {&#13;
  BugblatterBeast() : is_ravenous{ true }, weight_kg{ 20000 } { }&#13;
  bool is_ravenous;&#13;
  int weight_kg; <span class="ent">➊</span>&#13;
};</pre>&#13;
<p class="listing"><a id="ch12ex13"/><em>Listing 12-13: The <code>std::variant</code> can hold an object from one of a list of predefined types.</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_380"/>Aside from also containing a <code>weight_kg</code> member <span class="ent">➊</span>, <code>BugblatterBeast</code> is totally independent from <code>EscapeCapsule</code>.</p>&#13;
<h5 class="h5" id="ch12lev3sec8"><strong>Constructing a variant</strong></h5>&#13;
<p class="noindent">A <code>variant</code> can only be default constructed if one of two conditions is met:</p>&#13;
<ul>&#13;
<li class="noindent">The first template parameter is default constructible.</li>&#13;
<li class="noindent">It is <code>monostate</code>, a type intended to communicate that a variant can have an empty state.</li>&#13;
</ul>&#13;
<p class="indent">Because <code>BugblatterBeast</code> is default constructible (meaning it has a default constructor), make it the first type in the template parameter list so your variant is also default constructible, like so:</p>&#13;
<pre>std::variant&lt;BugblatterBeast, EscapeCapsule&gt; hagunemnon;</pre>&#13;
<p class="indent">To store a value into a <code>variant</code>, you use the <code>emplace</code> method template. As with <code>any</code>, a <code>variant</code> takes a single template parameter corresponding to the type you want to store. This template parameter must be contained in the list of template parameters for the <code>variant</code>. To extract a value, you use either of the non-member function templates <code>get</code> or <code>get_if</code>. These accept either the desired type or the index into the template parameter list corresponding to the desired type. If <code>get</code> fails, it throws a <code>bad_variant_access</code> exception, while <code>get_if</code> returns a <code>nullptr</code>.</p>&#13;
<p class="indent">You can determine which type corresponds with the current state of <code>variant</code> using the <code>index()</code> member, which returns the index of the current object’s type within the template parameter list.</p>&#13;
<p class="indent"><a href="ch12.xhtml#ch12ex14">Listing 12-14</a> illustrates how to use <code>emplace</code> to change the state of a <code>vari</code><code>ant</code> and <code>index</code> to determine the type of the contained object.</p>&#13;
<pre>TEST_CASE("std::variant") {&#13;
  std::variant&lt;BugblatterBeast, EscapeCapsule&gt; hagunemnon;&#13;
  REQUIRE(hagunemnon.index() == 0); <span class="ent">➊</span>&#13;
&#13;
  hagunemnon.emplace&lt;EscapeCapsule&gt;(600); <span class="ent">➋</span>&#13;
  REQUIRE(hagunemnon.index() == 1); <span class="ent">➌</span>&#13;
&#13;
  REQUIRE(std::get&lt;EscapeCapsule&gt;(hagunemnon).weight_kg == 600); <span class="ent">➍</span>&#13;
  REQUIRE(std::get&lt;1&gt;(hagunemnon).weight_kg == 600); <span class="ent">➎</span>&#13;
  REQUIRE_THROWS_AS(std::get&lt;0&gt;(hagunemnon), std::bad_variant_access); <span class="ent">➏</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex14"/><em>Listing 12-14: A <code>std::get</code> allows you to extract concrete types from <code>std::variant</code>.</em></p>&#13;
<p class="indent">After default constructing <code>hagunemnon</code>, invoking <code>index</code> yields 0 because this is the index of the correct template parameter <span class="ent">➊</span>. Next, you emplace <span epub:type="pagebreak" id="page_381"/>an <code>EscapeCapsule</code> <span class="ent">➋</span>, which causes <code>index</code> to return 1 instead <span class="ent">➌</span>. Both <code>std::get&lt;EscapeCapsule&gt;</code> <span class="ent">➍</span> and <code>std::get&lt;1&gt;</code> <span class="ent">➎</span> illustrate identical ways of extracting the contained type. Finally, attempting to invoke <code>std::get</code> to obtain a type that doesn’t correspond with the current state of <code>variant</code> results in a <code>bad_variant_access</code> <span class="ent">➏</span>.</p>&#13;
<p class="indent">You can use the non-member function <code>std::visit</code> to apply a callable object to a variant. This has the advantage of dispatching the correct function to handle whatever the contained object is without having to specify it explicitly with <code>std::get</code>. <a href="ch12.xhtml#ch12ex15">Listing 12-15</a> illustrates the basic usage.</p>&#13;
<pre>TEST_CASE("std::variant") {&#13;
  std::variant&lt;BugblatterBeast, EscapeCapsule&gt; hagunemnon;&#13;
  hagunemnon.emplace&lt;EscapeCapsule&gt;(600); <span class="ent">➊</span>&#13;
  auto lbs = std::visit([](auto&amp; x) { return 2.2*x.weight_kg; }, hagunemnon); <span class="ent">➋</span>&#13;
  REQUIRE(lbs == 1320); <span class="ent">➌</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex15"/><em>Listing 12-15: The <code>std::visit</code> allows you to apply a callable object to a contained type of <code>std::variant</code>.</em></p>&#13;
<p class="indent">First, you invoke <code>emplace</code> to store the value 600 into <code>hagunemnon</code> <span class="ent">➊</span>. Because both <code>BugblatterBeast</code> and <code>EscapeCapsule</code> have a <code>weight_kg</code> member, you can use <code>std::visit</code> on <code>hagunemnon</code> with a lambda that performs the correct conversion (2.2 lbs per kg) to the <code>weight_kg</code> field <span class="ent">➋</span> and returns the result <span class="ent">➌</span> (notice that you don’t have to include any type information).</p>&#13;
<h5 class="h5" id="ch12lev3sec9"><strong>Comparing variant and any</strong></h5>&#13;
<p class="noindent">The universe is big enough to accommodate both <code>any</code> and <code>variant</code>. It’s not possible to recommend one over the other generally, because each has its strengths and weaknesses.</p>&#13;
<p class="indent">An <code>any</code> is more flexible; it can take <em>any</em> type, whereas <code>variant</code> is only allowed to contain an object of a predetermined type. It also mostly avoids templates, so it’s generally easier to program with.</p>&#13;
<p class="indent">A <code>variant</code> is less flexible, making it safer. Using the <code>visit</code> function, you can check for the safety of operations at compile time. With <code>any</code>, you would need to build your own <code>visit</code>-like functionality, and it would require runtime checking (for example, of the result of <code>any_cast</code>).</p>&#13;
<p class="indent">Finally, <code>variant</code> can be more performant than <code>any</code>. Although <code>any</code> is allowed to perform dynamic allocation if the contained type is too large, <code>variant</code> is not.</p>&#13;
<h5 class="h5" id="ch12lev3sec10"><strong>A Partial List of Supported Operations</strong></h5>&#13;
<p class="noindent"><a href="ch12.xhtml#ch12tab06">Table 12-6</a> provides a list of the most supported <code>std::variant</code> operations. In this table, <code>vt</code> is a <code>std::variant</code> and <code>t</code> is an object of type <code>T</code>.</p>&#13;
<p class="tabcap"><a id="ch12tab06"/><span epub:type="pagebreak" id="page_382"/><strong>Table 12-6:</strong> The Most Supported <code>std::variant</code> Operations</p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:40%"/>&#13;
<col style="width:60%"/>&#13;
</colgroup>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Operation</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Notes</strong></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>variant&lt;...&gt;{}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Constructs an empty <code>variant</code> object. First template parameter must be default constructible.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>variant&lt;...&gt;{</code> <span class="codestrong">vt</span> <code> }</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Copy constructs from <span class="codestrong">vt</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>variant&lt;...&gt;{ move(</code><span class="codestrong">vt</span><code>) }</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Move constructs from <span class="codestrong">vt</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>variant&lt;...&gt;{ move(</code><span class="codestrong">t</span><code>) }</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Constructs an <code>variant</code> object containing an in-place constructed object.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">vt</span> <code> =</code> <span class="codestrong">t</span></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Destructs the object currently contained by <span class="codestrong">vt</span>; copies <span class="codestrong">t</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">vt</span> <code> = move(</code><span class="codestrong">t</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Destructs the object currently contained by <span class="codestrong">vt</span>; moves <span class="codestrong">t</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">vt1</span> <code> =</code> <span class="codestrong">vt2</span></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Copy assigns from <span class="codestrong">vt2</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">vt1</span> <code> = move(</code><span class="codestrong">vt2</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Move assigns from <span class="codestrong">vt2</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">vt</span><code>.emplace&lt;</code><span class="codestrong">T</span><code>&gt;(...)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Destructs the object currently contained by <span class="codestrong">vt</span>; constructs a <span class="codestrong">T</span> in place, forwarding the arguments <code>...</code> to the appropriate constructor.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">vt</span><code>.reset()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Destroys the currently contained object.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">vt</span><code>.index()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Returns the zero-based index of the type of the currently contained object. (Order determined by template parameters of the <code>std::variant</code>.)</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">vt1</span><code>.swap(</code><span class="codestrong">vt2</span><code>)</code><br/><code>swap(</code><span class="codestrong">vt1</span><code>,</code> <span class="codestrong">vt2</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Swaps the objects contained by <span class="codestrong">vt1</span> and <span class="codestrong">vt2</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>make_variant&lt;</code><span class="codestrong">T</span><code>&gt;(...)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Convenience function for constructing a <code>tuple</code>; constructs a <span class="codestrong">T</span> in place, forwarding the arguments <code>...</code> to the appropriate constructor.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>std::visit(</code><span class="codestrong">vt</span><code>,</code> <span class="codestrong">callable</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Invokes <span class="codestrong">callable</span> with contained object.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>std::holds_alternative&lt;</code><span class="codestrong">T</span><code>&gt;(</code><span class="codestrong">vt</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Returns <code>true</code> if the contained object’s type is <span class="codestrong">T</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>std::get&lt;</code><span class="codestrong">I</span><code>&gt;(</code><span class="codestrong">vt</span><code>)</code><br/><code>std::get&lt;</code><span class="codestrong">T</span><code>&gt;(</code><span class="codestrong">vt</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Returns contained object if its type is <span class="codestrong">T</span> or the <span class="codestrong">i</span>th type. Otherwise, throws <span class="codestrong">std::bad_variant_access</span> exception.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>std::get_if&lt;</code><span class="codestrong">I</span><code>&gt;(&amp;</code><span class="codestrong">vt</span><code>)</code><br/><code>std::get_if&lt;</code><span class="codestrong">T</span><code>&gt;(&amp;</code><span class="codestrong">vt</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Returns a pointer to the contained object if its type is <span class="codestrong">T</span> or the <span class="codestrong">i</span>th type. Otherwise, returns <code>nullptr</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b2"><p class="taba"><span class="codestrong">vt1</span> <code>==</code> <span class="codestrong">vt2</span></p>&#13;
<p class="taba"><span class="codestrong">vt1</span> <code>!=</code> <span class="codestrong">vt2</span></p>&#13;
<p class="taba"><span class="codestrong">vt1</span> <code>&gt;</code> <span class="codestrong">vt2</span></p>&#13;
<p class="taba"><span class="codestrong">vt1</span> <code>&gt;=</code> <span class="codestrong">vt2</span></p>&#13;
<p class="taba"><span class="codestrong">vt1</span> <code>&lt;</code> <span class="codestrong">vt2</span></p>&#13;
<p class="taba"><span class="codestrong">vt1</span> <code>&lt;=</code> <span class="codestrong">vt2</span></p></td>&#13;
<td style="vertical-align: top;" class="table-b2"><p class="taba">Compares the contained objects of <span class="codestrong">vt1</span> and <span class="codestrong">vt2</span>.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<h3 class="h3" id="ch12lev1sec2"><strong>Date and Time</strong></h3>&#13;
<p class="noindent">Between stdlib and Boost, a number of libraries are available that handle dates and times. When handling calendar dates and times, look to Boost’s DateTime library. When you’re trying get the current time or measure elapsed time, look to Boost’s or stdlib’s Chrono libraries and to Boost’s Timer library.</p>&#13;
<h4 class="h4" id="ch12lev2sec7"><strong><em><span epub:type="pagebreak" id="page_383"/>Boost DateTime</em></strong></h4>&#13;
<p class="indent">Boost DateTime library supports date programming with a rich system based on the Gregorian calendar, which is the most widely used civil calendar internationally. Calendars are more complicated than they might seem at first glance. For example, consider the following excerpt from the US Naval Observatory’s Introduction to Calendars, which describes the basics of leap years:</p>&#13;
<p class="bq">Every year that is exactly divisible by four is a leap year, except for years that are exactly divisible by 100, but these centurial years are leap years if they are exactly divisible by 400. For example, the years 1700, 1800, and 1900 are not leap years, but the year 2000 is.</p>&#13;
<p class="indent">Rather than attempting to build your own solar calendar functions, just include DateTime’s date-programming facilities with the following header:</p>&#13;
<pre>#include &lt;boost/date_time/gregorian/gregorian.hpp&gt;</pre>&#13;
<p class="indent">The principal type you’ll use is the <code>boost::gregorian::date</code>, which is the primary interface for date-programming.</p>&#13;
<h5 class="h5" id="ch12lev3sec11"><strong>Constructing a date</strong></h5>&#13;
<p class="noindent">Several options are available for constructing a <code>date</code>. You can default construct a <code>date</code>, which sets its value to the special date <code>boost::gregorian::not_a_</code><code>date_time</code>. To construct a <code>date</code> with a valid date, you can use a constructor that accepts three arguments: a year, a month, and a date. The following statement constructs a <code>date d</code> with the date September 15, 1986:</p>&#13;
<pre>boost::gregorian::date d{ 1986, 9, 15 };</pre>&#13;
<p class="indent">Alternatively, you can construct a date from a string using the <code>boost:: gregorian::from_string</code> utility function, like this:</p>&#13;
<pre>auto d = boost::gregorian::from_string("1986/9/15");</pre>&#13;
<p class="indent">If you pass an invalid date, the <code>date</code> constructor will throw an exception, such as <code>bad_year</code>, <code>bad_day_of_month</code>, or <code>bad_month</code>. For example, <a href="ch12.xhtml#ch12ex16">Listing 12-16</a> attempts to construct a date with September 32, 1986.</p>&#13;
<pre>TEST_CASE("Invalid boost::Gregorian::dates throw exceptions") {&#13;
  using boost::gregorian::date;&#13;
  using boost::gregorian::bad_day_of_month;&#13;
&#13;
  REQUIRE_THROWS_AS(date(1986, 9, 32), bad_day_of_month); <span class="ent">➊</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex16"/><em>Listing 12-16: The <code>boost::gregorian::date</code> constructor throws exceptions for bad dates.</em></p>&#13;
<p class="indent">Because September 32 isn’t a valid day of the month, the <code>date</code> constructor throws a <code>bad_day_of_month</code> exception <span class="ent">➊</span>.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span epub:type="pagebreak" id="page_384"/><span class="notes">NOTE</span></strong></p>&#13;
<p class="notep"><em>Due to a limitation in Catch, you cannot use braced initialization for <span class="codeitalic">date</span> in the <code>REQUIRE_THROWS_AS</code> macro</em> <span class="ent">➊</span>.</p>&#13;
</div>&#13;
<p class="indent">You can obtain the current day from the environment using the non-member function <code>boost::gregorian::day_clock::local_day</code> or <code>boost::gregorian:: day_clock::universal_day</code> to obtain the local day based on the system’s time zone settings and the UTC day, respectively:</p>&#13;
<pre>auto d_local = boost::gregorian::day_clock::local_day();&#13;
auto d_univ = boost::gregorian::day_clock::universal_day();</pre>&#13;
<p class="indent">Once you construct a date, you can’t change its value (it’s <em>immutable</em>). However, dates support copy construction and copy assignment.</p>&#13;
<h5 class="h5" id="ch12lev3sec12"><strong>Accessing Date Members</strong></h5>&#13;
<p class="noindent">You can inspect the features of a <code>date</code> through its many <code>const</code> methods. <a href="ch12.xhtml#ch12tab07">Table 12-7</a> provides a partial list. In this table, <code>d</code> is a <code>date</code>.</p>&#13;
<p class="tabcap"><a id="ch12tab07"/><strong>Table 12-7:</strong> The Most Supported <code>boost::gregorian::date</code> Accessors</p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:40%"/>&#13;
<col style="width:60%"/>&#13;
</colgroup>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Accessor</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Notes</strong></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">d</span><code>.year()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Returns the year portion of the <code>date</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">d</span><code>.month()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Returns the month portion of the <code>date</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">d</span><code>.day()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Returns the day portion of the <code>date</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">d</span><code>.day_of_week()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Returns the day of the week as an <code>enum</code> of type <code>greg_day_of_week</code>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">d</span><code>.day_of_year()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Returns the day of the year (from 1 to 366 inclusive).</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">d</span><code>.end_of_month()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Returns a date object set to the last day of the month of <span class="codestrong">d</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">d</span><code>.is_not_a_date()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Returns <code>true</code> if <span class="codestrong">d</span> is not a date.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b2"><p class="taba"><span class="codestrong">d</span><code>.week_number()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b2"><p class="taba">Returns the ISO 8601 week number.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent"><a href="ch12.xhtml#ch12ex17">Listing 12-17</a> illustrates how to construct a <code>date</code> and use the accessors in <a href="ch12.xhtml#ch12tab07">Table 12-7</a>.</p>&#13;
<pre>TEST_CASE("boost::gregorian::date supports basic calendar functions") {&#13;
  boost::gregorian::date d{ 1986, 9, 15 }; <span class="ent">➊</span>&#13;
  REQUIRE(d.year() == 1986); <span class="ent">➋</span>&#13;
  REQUIRE(d.month() == 9); <span class="ent">➌</span>&#13;
  REQUIRE(d.day() == 15); <span class="ent">➍</span>&#13;
  REQUIRE(d.day_of_year() == 258); <span class="ent">➎</span>&#13;
  REQUIRE(d.day_of_week() == boost::date_time::Monday); <span class="ent">➏</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex17"/><em>Listing 12-17: The <code>boost::gregorian::date</code> supports basic calendar functions.</em></p>&#13;
<p class="indent">Here, you construct a <code>date</code> from September 15, 1986 <span class="ent">➊</span>. From there, you extract the year <span class="ent">➋</span>, month <span class="ent">➌</span>, day <span class="ent">➍</span>, day of the year <span class="ent">➎</span>, and day of the week <span class="ent">➏</span>.</p>&#13;
<h5 class="h5" id="ch12lev3sec13"><span epub:type="pagebreak" id="page_385"/><strong>Calendar Math</strong></h5>&#13;
<p class="noindent">You can perform simple calendar math on dates. When you subtract one date from another, you get a <code>boost::gregorian::date_duration</code>. The main functionality of <code>date_duration</code> is storing an integral number of days, which you can extract using the <code>days</code> method. <a href="ch12.xhtml#ch12ex18">Listing 12-18</a> illustrates how to compute the number of days elapsed between two <code>date</code> objects.</p>&#13;
<pre>TEST_CASE("boost::gregorian::date supports calendar arithmetic") {&#13;
  boost::gregorian::date d1{ 1986, 9, 15 }; <span class="ent">➊</span>&#13;
  boost::gregorian::date d2{ 2019, 8, 1 }; <span class="ent">➋</span>&#13;
  auto duration = d2 - d1; <span class="ent">➌</span>&#13;
  REQUIRE(duration.days() == 12008); <span class="ent">➍</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex18"/><em>Listing 12-18: Subtracting <code>boost::gregorian::date</code> objects yields a <code>boost::gregorian:: date_duration</code>.</em></p>&#13;
<p class="indent">Here, you construct a <code>date</code> for September 15, 1986 <span class="ent">➊</span> and for August 1, 2019 <span class="ent">➋</span>. You subtract these two dates to yield a <code>date_duration</code> <span class="ent">➌</span>. Using the <code>days</code> method, you can extract the number of days between the two dates <span class="ent">➍</span>.</p>&#13;
<p class="indent">You can also construct a <code>date_duration</code> using a <code>long</code> argument corresponding to the number of days. You can add a <code>date_duration</code> to a date to obtain another date, as <a href="ch12.xhtml#ch12ex19">Listing 12-19</a> illustrates.</p>&#13;
<pre>TEST_CASE("date and date_duration support addition") {&#13;
  boost::gregorian::date d1{ 1986, 9, 15 }; <span class="ent">➊</span>&#13;
  boost::gregorian::date_duration dur{ 12008 }; <span class="ent">➋</span>&#13;
  auto d2 = d1 + dur; <span class="ent">➌</span>&#13;
  REQUIRE(d2 == boost::gregorian::from_string("2019/8/1")); <span class="ent">➍</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex19"/><em>Listing 12-19: Adding a <code>date_duration</code> to a <code>date</code> yields another <code>date</code>.</em></p>&#13;
<p class="indent">You construct a <code>date</code> for September 15, 1986 <span class="ent">➊</span> and 12,008 days for <code>duration</code> <span class="ent">➋</span>. From <a href="ch12.xhtml#ch12ex18">Listing 12-18</a>, you know that this day plus 12008 yields August 1, 2019. So after adding them <span class="ent">➌</span>, the resulting day is as you expect <span class="ent">➍</span>.</p>&#13;
<h5 class="h5" id="ch12lev3sec14"><strong>Date Periods</strong></h5>&#13;
<p class="noindent">A <em>date period</em> represents the interval between two dates. DateTime provides a <code>boost::gregorian::date_period</code> class, which has three constructors, as described in <a href="ch12.xhtml#ch12tab08">Table 12-8</a>. In this table, constructors <code>d1</code> and <code>d2</code> are <code>date</code> arguments and <code>dp</code> is a <code>date_period</code>.</p>&#13;
<p class="tabcap"><a id="ch12tab08"/><strong>Table 12-8:</strong> Supported <code>boost::gregorian::date_period</code> Constructors</p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:40%"/>&#13;
<col style="width:60%"/>&#13;
</colgroup>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Accessor</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Notes</strong></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>date_period{</code> <span class="codestrong">d1</span><code>,</code> <span class="codestrong">d2</span>  <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Creates a period including <span class="codestrong">d1</span> but not <span class="codestrong">d2</span>; invalid if <span class="codestrong">d2</span> &lt;= <span class="codestrong">d1</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>date_period{</code>  <span class="codestrong">d</span><code>,</code> <span class="codestrong">n_days</span>  <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Creates a period frome <span class="codestrong">d</span> to <span class="codestrong">d+n_days</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba"><code>date_period{</code> <span class="codestrong">dp</span>  <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba">Copy constructor.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_386"/>The <code>date_period</code> class supports many operations, such as the <code>contain</code> method, which takes a <code>date</code> argument and returns <code>true</code> if the argument is contained in the <code>period</code>. <a href="ch12.xhtml#ch12ex20">Listing 12-20</a> illustrates this operation.</p>&#13;
<pre>TEST_CASE(+boost::gregorian::date supports periods+) {&#13;
  boost::gregorian::date d1{ 1986, 9, 15 }; <span class="ent">➊</span>&#13;
  boost::gregorian::date d2{ 2019, 8, 1 }; <span class="ent">➋</span>&#13;
  boost::gregorian::date_period p{ d1, d2 }; <span class="ent">➌</span>&#13;
  REQUIRE(p.contains(boost::gregorian::date{ 1987, 10, 27 })); <span class="ent">➍</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex20"/><em>Listing 12-20: Using the <code>contains</code> method on a <code>boost::gregorian::date_period</code> to determine whether a date falls within a particular time interval</em></p>&#13;
<p class="indent">Here, you construct two dates, September 15, 1986 <span class="ent">➊</span> and August 1, 2019 <span class="ent">➋</span>, which you use to construct a <code>date_period</code> <span class="ent">➌</span>. Using the <code>contains</code> method, you can determine that the <code>date_period</code> contains the date October 27, 1987 <span class="ent">➍</span>.</p>&#13;
<p class="indent"><a href="ch12.xhtml#ch12tab09">Table 12-9</a> contains a partial list of other <code>date_period</code> operations. In this table, <code>p</code>, <code>p1</code>, and <code>p2</code> are <code>date_period</code> classes and <code>d</code> is a <code>date</code>.</p>&#13;
<p class="tabcap"><a id="ch12tab09"/><strong>Table 12-9:</strong> Supported <code>boost::gregorian::date_period</code> Operations</p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:40%"/>&#13;
<col style="width:60%"/>&#13;
</colgroup>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Accessor</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Notes</strong></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">p</span><code>.begin()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Returns the first day.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">p</span><code>.last()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Returns the last day.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">p</span><code>.length()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Returns the number of days contained.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">p</span><code>.is_null()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Returns <code>true</code> if the period is invalid (for example, end is before start).</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">p</span><code>.contains(</code><span class="codestrong">d</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Returns <code>true</code> if <span class="codestrong">d</span> falls within <span class="codestrong">p</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">p1</span><code>.contains(</code><span class="codestrong">p2</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Returns <code>true</code> if all of <span class="codestrong">p2</span> falls within <span class="codestrong">p1</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">p1</span><code>.intersects(</code><span class="codestrong">p2</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Returns <code>true</code> if any of <span class="codestrong">p2</span> falls within <span class="codestrong">p1</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">p</span><code>.is_after(</code><span class="codestrong">d</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Returns <code>true</code> if <span class="codestrong">p</span> falls after <span class="codestrong">d</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba"><span class="codestrong">p</span><code>.is_before(</code><span class="codestrong">d</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba">Returns <code>true</code> if <span class="codestrong">p</span> falls before <span class="codestrong">d</span>.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<h3 class="h3" id="ch12lev1sec3"><strong>Other DateTime Features</strong></h3>&#13;
<p class="noindent">The Boost DateTime library contains three broad categories of programming:</p>&#13;
<p class="bq"><strong>Date</strong> Date programming is the calendar-based programming you just toured.</p>&#13;
<p class="bq"><strong>Time</strong> Time programming, which allows you to work with clocks with microsecond resolution, is available in the <code>&lt;boost/date_time/posix_time/</code><code>posix_time.hpp&gt;</code> header. The mechanics are similar to date programming, but you work with clocks instead of Gregorian calendars.</p>&#13;
<p class="bq"><strong>Local-time</strong> Local-time programming is simply time-zone-aware time programming. It’s available in the <code>&lt;boost/date_time/time_zone_base.hpp&gt;</code> header.</p>&#13;
<div class="note">&#13;
<p class="notet"><span epub:type="pagebreak" id="page_387"/><strong><span class="notes">NOTE</span></strong></p>&#13;
<p class="notep"><em>For brevity, this chapter won’t go into detail about time and local-time programming. See the Boost documentation for information and examples.</em></p>&#13;
</div>&#13;
<h4 class="h4" id="ch12lev2sec8"><strong><em>Chrono</em></strong></h4>&#13;
<p class="noindent">The stdlib Chrono library provides a variety of clocks in the <code>&lt;chrono&gt;</code> header. You typically use these when you need to program something that depends on time or for timing your code.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>&#13;
<p class="notep"><em>Boost also offers a Chrono library in the <code>&lt;boost/chrono.hpp&gt;</code> header. It’s a superset of stdlib’s Chrono library, which includes, for example, process- and thread-specific clocks and user-defined output formats for time.</em></p>&#13;
</div>&#13;
<h5 class="h5" id="ch12lev3sec15"><strong>Clocks</strong></h5>&#13;
<p class="noindent">Three clocks are available in Chrono library; each provides a different guarantee, and all reside in the <code>std::chrono</code> namespace:</p>&#13;
<ul>&#13;
<li class="noindent">The <code>std::chrono::system_clock</code> is the system-wide, real-time clock. It’s sometimes also called the <em>wall clock</em>, the elapsed real time since an implementation-specific start date. Most implementations specify the Unix start date of January 1, 1970, at midnight.</li>&#13;
<li class="noindent">The <code>std::chrono::steady_clock</code> guarantees that its value will never decrease. This might seem absurd to guarantee, but measuring time is more complicated than it seems. For example, a system might have to contend with leap seconds or inaccurate clocks.</li>&#13;
<li class="noindent">The <code>std::chrono::high_resolution_clock</code> has the shortest <em>tick</em> period available: a tick is the smallest atomic change that the clock can measure.</li></ul>&#13;
<p class="indent">Each of these three clocks supports the static member function <code>now</code>, which returns a time point corresponding to the current value of the clock.</p>&#13;
<h5 class="h5" id="ch12lev3sec16"><strong>Time Points</strong></h5>&#13;
<p class="indent">A <em>time point</em> represents a moment in time, and Chrono encodes time points using the <code>std::chrono::time_point</code> type. From a user perspective, <code>time_point</code> objects are very simple. They provide a <code>time_since_epoch</code> method that returns the amount of time elapsed between the time point and the clock’s <em>epoch</em>. This elapsed time is called a <em>duration</em>.</p>&#13;
<p class="indent">An epoch is an implementation-defined reference time point denoting the beginning of a clock. The Unix Epoch (or POSIX time) begins on January 1, 1970, whereas the Windows Epoch begins on January 1, 1601 (corresponding with the beginning of a 400-year, Gregorian-calendar cycle).</p>&#13;
<p class="indent">The <code>time_since_epoch</code> method is not the only way to obtain a duration from a <code>time_point</code>. You can obtain the duration between two <code>time_point</code> objects by subtracting them.</p>&#13;
<h5 class="h5" id="ch12lev3sec17"><strong><span epub:type="pagebreak" id="page_388"/>Durations</strong></h5>&#13;
<p class="indent">A <code>std::chrono::duration</code> represents the time between the two <code>time_point</code> objects. Durations expose a <code>count</code> method, which returns the number of clock ticks in the duration.</p>&#13;
<p class="indent"><a href="ch12.xhtml#ch12ex21">Listing 12-21</a> shows how to obtain the current time from each of the three available clocks, extract the time since each clock’s epoch as a&#13;
duration, and then convert them to ticks.</p>&#13;
<pre>TEST_CASE("std::chrono supports several clocks") {&#13;
  auto sys_now = std::chrono::system_clock::now(); <span class="ent">➊</span>&#13;
  auto hires_now = std::chrono::high_resolution_clock::now(); <span class="ent">➋</span>&#13;
  auto steady_now = std::chrono::steady_clock::now(); <span class="ent">➌</span>&#13;
&#13;
  REQUIRE(sys_now.time_since_epoch().count() &gt; 0); <span class="ent">➍</span>&#13;
  REQUIRE(hires_now.time_since_epoch().count() &gt; 0); <span class="ent">➎</span>&#13;
  REQUIRE(steady_now.time_since_epoch().count() &gt; 0); <span class="ent">➏</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex21"/><em>Listing 12-21: The <code>std::chrono</code> supports several kinds of clocks.</em></p>&#13;
<p class="indent">You obtain the current time from the <code>system_clock</code> <span class="ent">➊</span>, the <code>high_resolu</code><span class="literal">tion&#13;
&#13;
_clock</span> <span class="ent">➋</span>, and the <code>steady_clock</code> <span class="ent">➌</span>. For each clock, you convert the time point into a <code>duration</code> since the clock’s epoch using the <code>time_since_epoch</code> method. You immediately call <code>count</code> on the resulting duration to yield a tick count, which should be greater than zero <span class="ent">➍ ➎ ➏</span>.</p>&#13;
<p class="indent">In addition to deriving durations from time points, you can construct them directly. The <code>std::chrono</code> namespace contains helper functions to generate durations. For convenience, Chrono offers a number of user-defined duration literals in the <code>std::literals::chrono_literals</code> namespace. These provide some syntactic sugar, convenient language syntax that makes life easier for the developer, for defining duration literals.</p>&#13;
<p class="indent"><a href="ch12.xhtml#ch12tab10">Table 12-10</a> shows the helper functions and their literal equivalents, where each expression corresponds to an hour’s duration.</p>&#13;
<p class="tabcap"><a id="ch12tab10"/><strong>Table 12-10:</strong> <code>std::chrono</code> Helper Functions and User-Defined Literals for Creating Durations</p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:40%"/>&#13;
<col style="width:60%"/>&#13;
</colgroup>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Helper function</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Literal equivalent</strong></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>nanoseconds(3600000000000)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>3600000000000ns</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>microseconds(3600000000)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>3600000000us</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>milliseconds(3600000)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>3600000ms</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>seconds(3600)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>3600s</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>minutes(60)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>60m</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b2"><p class="taba"><code>hours(1)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b2"><p class="taba"><code>1h</code></p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_389"/>For example, <a href="ch12.xhtml#ch12ex22">Listing 12-22</a> illustrates how to construct a duration of 1 second with <code>std::chrono::seconds</code> and another duration of 1,000 milliseconds using the <code>ms</code> duration literal.</p>&#13;
<pre>#include &lt;chrono&gt;&#13;
TEST_CASE("std::chrono supports several units of measurement") {&#13;
  using namespace std::literals::chrono_literals; <span class="ent">➊</span>&#13;
  auto one_s = std::chrono::seconds(1); <span class="ent">➋</span>&#13;
  auto thousand_ms = 1000ms; <span class="ent">➌</span>&#13;
  REQUIRE(one_s == thousand_ms); <span class="ent">➍</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex22"/><em>Listing 12-22: The <code>std::chrono</code> supports many units of measurement, which are comparable.</em></p>&#13;
<p class="indent">Here, you bring in the <code>std::literals::chrono_literals</code> namespace so you have access to the duration literals <span class="ent">➊</span>. You construct a duration called <code>one_s</code> from the <code>seconds</code> helper function <span class="ent">➋</span> and another called <code>thousand_ms</code> from the <code>ms</code> duration literal <span class="ent">➌</span>. These are equivalent because a second contains a thousand milliseconds <span class="ent">➍</span>.</p>&#13;
<p class="indent">Chrono provides the function template <code>std::chrono::duration_cast</code> to cast a duration from one unit to another. As with other cast-related function templates, such as <code>static_cast</code>, <code>duration_cast</code> takes a single template parameter corresponding to the target duration and a single argument corresponding to the duration you want to cast.</p>&#13;
<p class="indent"><a href="ch12.xhtml#ch12ex23">Listing 12-23</a> illustrates how to cast a <code>nanosecond</code> duration into a <code>second</code> duration.</p>&#13;
<pre>TEST_CASE("std::chrono supports duration_cast") {&#13;
  using namespace std::chrono; <span class="ent">➊</span>&#13;
  auto billion_ns_as_s = duration_cast&lt;seconds<span class="ent">➋</span>&gt;(1'000'000'000ns<span class="ent">➌</span>);&#13;
  REQUIRE(billion_ns_as_s.count() == 1); <span class="ent">➍</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex23"/><em>Listing 12-23: The <code>std::chrono</code> supports <code>std::chrono::duration_cast</code>.</em></p>&#13;
<p class="indent">First, you bring in the <code>std::chrono</code> namespace for easy access to <code>duration_cast</code>, the duration helper functions, and the duration literals <span class="ent">➊</span>. Next, you use the <code>ns</code> duration literal to specify a billion-nanosecond duration <span class="ent">➌</span>, which you pass as the argument to <code>duration_cast</code>. You specify the template parameter of <code>duration_cast</code> as seconds <span class="ent">➋</span>, so the resulting duration, <code>billion_ns_as_s</code>, equals 1 second <span class="ent">➍</span>.</p>&#13;
<h5 class="h5" id="ch12lev3sec18"><strong>Waiting</strong></h5>&#13;
<p class="noindent">Sometimes, you’ll use durations to specify some period of time for your program to wait. The stdlib provides concurrency primitives in the <code>&lt;thread&gt;</code> header, which contains the non-member function <code>std::this_thread::sleep_</code><code>for</code>. The <code>sleep_for</code> function accepts a <code>duration</code> argument corresponding to how long you want the current thread of execution to wait or “sleep.”</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_390"/><a href="ch12.xhtml#ch12ex24">Listing 12-24</a> shows how to employ <code>sleep_for</code>.</p>&#13;
<pre>#include &lt;thread&gt;&#13;
#include &lt;chrono&gt;&#13;
TEST_CASE("std::chrono used to sleep") {&#13;
  using namespace std::literals::chrono_literals; <span class="ent">➊</span>&#13;
  auto start = std::chrono::system_clock::now(); <span class="ent">➋</span>&#13;
  std::this_thread::sleep_for(100ms); <span class="ent">➌</span>&#13;
  auto end = std::chrono::system_clock::now(); <span class="ent">➍</span>&#13;
  REQUIRE(end - start &gt;= 100ms); <span class="ent">➎</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex24"/><em>Listing 12-24: The <code>std::chrono</code> works with <code>&lt;thread&gt;</code> to put the current thread to sleep.</em></p>&#13;
<p class="indent">As before, you bring in the <code>chrono_literals</code> namespace so you have access to the duration literals <span class="ent">➊</span>. You record the current time according to <code>sys</code><code>tem_</code><code>clock</code>, saving the resulting <code>time_point</code> into the <code>start</code> variable <span class="ent">➋</span>. Next, you invoke <code>sleep_for</code> with a 100-millisecond duration (a tenth of a second) <span class="ent">➌</span>. You then record the current time again, saving the resulting <code>time_point</code> into <code>end</code> <span class="ent">➍</span>. Because the program slept for 100 milliseconds between calls to <code>std::chrono::system_clock</code>, the duration resulting from subtracting <code>start</code> from <code>end</code> should be at least <code>100ms</code> <span class="ent">➎</span>.</p>&#13;
<h5 class="h5" id="ch12lev3sec19"><strong>Timing</strong></h5>&#13;
<p class="noindent">To optimize code, you absolutely need accurate measurements. You can use Chrono to measure how long a series of operations takes. This enables you to establish that a particular code path is actually responsible for observed performance issues. It also enables you to establish an objective measure for the progress of your optimization efforts.</p>&#13;
<p class="indent">Boost’s Timer library contains the <code>boost::timer::auto_cpu_timer</code> class in the <code>&lt;boost/timer/timer.hpp&gt;</code> header, which is an RAII object that begins timing in its constructor and stops timing in its destructor.</p>&#13;
<p class="indent">You can build your own makeshift <code>Stopwatch</code> class using just the stdlib Chrono library. The <code>Stopwatch</code> class can keep a reference to a <code>duration</code> object. In the <code>Stopwatch</code> destructor, you can set the <code>duration</code> via its reference. <a href="ch12.xhtml#ch12ex25">Listing 12-25</a> provides an implementation.</p>&#13;
<pre>#include &lt;chrono&gt;&#13;
&#13;
struct Stopwatch {&#13;
  Stopwatch(std::chrono::nanoseconds&amp; result<span class="ent">➊</span>)&#13;
    : result{ result }, <span class="ent">➋</span>&#13;
    start{ std::chrono::high_resolution_clock::now() } { } <span class="ent">➌</span>&#13;
  ~Stopwatch() {&#13;
    result = std::chrono::high_resolution_clock::now() - start; <span class="ent">➍</span>&#13;
  }&#13;
private:&#13;
  std::chrono::nanoseconds&amp; result;&#13;
<span epub:type="pagebreak" id="page_391"/>  const std::chrono::time_point&lt;std::chrono::high_resolution_clock&gt; start;&#13;
};</pre>&#13;
<p class="listing"><a id="ch12ex25"/><em>Listing 12-25: A simple <code>Stopwatch</code> class that computes the duration of its lifetime</em></p>&#13;
<p class="indent">The <code>Stopwatch</code> constructor requires a single <code>nanoseconds</code> reference <span class="ent">➊</span>, which you store into the <code>result</code> field with a member initializer <span class="ent">➋</span>. You also save the current time of the <code>high_resolution_clock</code> by setting the <code>start</code> field&#13;
&#13;
to the result of <code>now()</code> <span class="ent">➌</span>. In the <code>Stopwatch</code> destructor, you again invoke <code>now()</code> on the <code>high_resolution_clock</code> and subtract <code>start</code> to obtain the duration of the lifetime of <code>Stopwatch</code>. You use the <code>result</code> reference to write the <code>duration</code> <span class="ent">➍</span>.</p>&#13;
<p class="indent"><a href="ch12.xhtml#ch12ex26">Listing 12-26</a> shows the <code>Stopwatch</code> in action, performing a million floating-point divisions within a loop and computing the average time elapsed per iteration.</p>&#13;
<pre>#include &lt;cstdio&gt;&#13;
#include &lt;cstdint&gt;&#13;
#include &lt;chrono&gt;&#13;
&#13;
struct Stopwatch {&#13;
--<span class="codeitalic1">snip</span>--&#13;
};&#13;
int main() {&#13;
  const size_t n = 1'000'000; <span class="ent">➊</span>&#13;
  std::chrono::nanoseconds elapsed; <span class="ent">➋</span>&#13;
  {&#13;
    Stopwatch stopwatch{ elapsed }; <span class="ent">➌</span>&#13;
    volatile double result{ 1.23e45 }; <span class="ent">➍</span>&#13;
    for (double i = 1; i &lt; n; i++) {&#13;
      result /= i; <span class="ent">➎</span>&#13;
    }&#13;
  }&#13;
  auto time_per_division = elapsed.count() / double{ n }; <span class="ent">➏</span>&#13;
  printf("Took %gns per division.", time_per_division); <span class="ent">➐</span>&#13;
}&#13;
--------------------------------------------------------------------------&#13;
<span class="color1">Took 6.49622ns per division. <span class="ent">➐</span></span></pre>&#13;
<p class="listing"><a id="ch12ex26"/><em>Listing 12-26: Using the <code>Stopwatch</code> to estimate the time taken for <code>double</code> division</em></p>&#13;
<p class="indent">First, you initialize a variable <code>n</code> to a million, which stores the total number of iterations your program will make <span class="ent">➊</span>. You declare the <code>elapsed</code> variable, which will store the time elapsed across all the iterations <span class="ent">➋</span>. Within a block, you declare a <code>Stopwatch</code> and pass an <code>elapsed</code> reference to the constructor <span class="ent">➌</span>. Next, you declare a <code>double</code> called <code>result</code> with a junk value in it <span class="ent">➍</span>. You declare this variable <code>volatile</code> so the compiler doesn’t try to optimize the loop away. Within the loop, you do some arbitrary, floating-point division <span class="ent">➎</span>.</p>&#13;
<p class="indent">Once the block completes, <code>stopwatch</code> destructs. This writes the duration of <code>stopwatch</code> to <code>elapsed</code>, which you use to compute the average number of nanoseconds per loop iteration and store into the <code>time_per_addition</code> variable <span class="ent">➏</span>. You conclude the program by printing <code>time_per_division</code> with <code>printf</code> <span class="ent">➐</span>.</p>&#13;
<h3 class="h3" id="ch12lev1sec4"><strong><span epub:type="pagebreak" id="page_392"/>Numerics</strong></h3>&#13;
<p class="noindent">This section discusses handling numbers with a focus on common mathematical functions and constants; handling complex numbers; generating random numbers, numeric limits, and conversions; and computing ratios.</p>&#13;
<h4 class="h4" id="ch12lev2sec9"><strong><em>Numeric Functions</em></strong></h4>&#13;
<p class="noindent">The stdlib Numerics and Boost Math libraries provide a profusion of numeric/mathematical functions. For the sake of brevity, this chapter presents only quick references. For detailed treatment, see [numerics] in the ISO C++ 17 Standard and the Boost Math documentation.</p>&#13;
<p class="indent"><a href="ch12.xhtml#ch12tab11">Table 12-11</a> provides a partial list of many common, non-member mathematical functions available in the stdlib’s Math library.</p>&#13;
<p class="tabcap"><a id="ch12tab11"/><strong>Table 12-11:</strong> A Partial List of Common Math Functions in the stdlib</p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:20%"/>&#13;
<col style="width:40%"/>&#13;
<col style="width:10%"/>&#13;
<col style="width:10%"/>&#13;
<col style="width:20%"/>&#13;
</colgroup>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Function</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Computes the . . .</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Ints</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Floats</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Header</strong></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>abs(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Absolute value of <span class="codestrong">x</span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"/>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>&lt;cstdlib&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>div(</code><span class="codestrong">x</span><code>,</code> <span class="codestrong">y</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Quotient and remainder of <span class="codestrong">x</span> divided by <span class="codestrong">y</span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"/>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>&lt;cstdlib&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>abs(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Absolute value of <span class="codestrong">x</span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"/>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>fmod(</code><span class="codestrong">x</span><code>,</code> <span class="codestrong">y</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Remainder of floating-point division of <span class="codestrong">x</span> by <span class="codestrong">y</span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b"/>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>remainder(</code><span class="codestrong">x</span><code>,</code> <span class="codestrong">y</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Signed remainder of dividing <span class="codestrong">x</span> by <span class="codestrong">y</span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>fma(</code><span class="codestrong">x</span><code>,</code> <span class="codestrong">y</span><code>,</code> <span class="codestrong">z</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Multiply the first two arguments and add their product to the third argument; also called fused multiplication addition; that is, <span class="codestrong">x</span> <span class="codestrong">* y</span> <code>+</code> <span class="codestrong">z</span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>max(</code><span class="codestrong">x</span><code>,</code> <span class="codestrong">y</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Maximum of <span class="codestrong">x</span> and <span class="codestrong">y</span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>&lt;algorithm&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>min(</code><span class="codestrong">x</span><code>,</code> <span class="codestrong">y</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Minimum of <span class="codestrong">x</span> and <span class="codestrong">y</span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>&lt;algorithm&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>exp(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Value of <code>e</code><sup><span class="codestrong">x</span></sup>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>exp2(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Value of <code>2<sup><span class="codestrong">x</code></sup></span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>log(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Natural log of x; that is, ln x.</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>log10(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Common log of x; that is, log10 x.</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>log2(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Base 2 log of x; that is, log10 x.</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>gcd(</code><span class="codestrong">x</span><code>,</code> <span class="codestrong">y</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Greatest common denominator of <span class="codestrong">x</span> and <span class="codestrong">y</span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"/>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>&lt;numeric&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>lcm(</code><span class="codestrong">x</span><code>,</code> <span class="codestrong">y</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Least common multiple of <span class="codestrong">x</span> and <span class="codestrong">y</span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"/>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>&lt;numeric&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>erf(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Gauss error function of <span class="codestrong">x</span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>pow(</code><span class="codestrong">x</span><code>,</code> <span class="codestrong">y</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Value of <span class="codestrong">x<sup>y</sup></span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>sqrt(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Square root of <span class="codestrong">x</span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>cbrt(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Cube root of <span class="codestrong">x</span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>hypot(</code><span class="codestrong">x</span><code>,</code> <span class="codestrong">y</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Square root of <span class="codestrong">x</span><sup>2</sup> <code>+</code> <span class="codestrong">y</span><sup>2</sup>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>sin(</code><span class="codestrong">x</span><code>)</code></p>&#13;
<p class="taba"><code>cos(</code><span class="codestrong">x</span><code>)</code></p>&#13;
<p class="taba"><code>tan(</code><span class="codestrong">x</span><code>)</code></p>&#13;
<p class="taba"><code>asin(</code><span class="codestrong">x</span><code>)</code></p>&#13;
<p class="taba"><code>acos(</code><span class="codestrong">x</span><code>)</code></p>&#13;
<p class="taba"><code>atan(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Associated trigonometric function value.</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span epub:type="pagebreak" id="page_393"/><code>sinh(</code><span class="codestrong">x</span><code>)</code></p>&#13;
<p class="taba"><code>cosh(</code><span class="codestrong">x</span><code>)</code></p>&#13;
<p class="taba"><code>tanh(</code><span class="codestrong">x</span><code>)</code></p>&#13;
<p class="taba"><code>asinh(</code><span class="codestrong">x</span><code>)</code></p>&#13;
<p class="taba"><code>acosh(</code><span class="codestrong">x</span><code>)</code></p>&#13;
<p class="taba"><code>atanh(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Associated hyperbolic function value.</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>ceil(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Nearest integer greater than or equal to <span class="codestrong">x</span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>floor(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Nearest integer less than or equal to <span class="codestrong">x</span>.</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>round(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Nearest integer equal to <span class="codestrong">x</span>; rounds away from zero in midpoint cases.</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>isfinite(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Value <code>true</code> if <span class="codestrong">x</span> is a finite number.</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba"><code>isinf(</code><span class="codestrong">x</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba">Value <code>true</code> if <span class="codestrong">x</span> is an infinite number.</p></td>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba">✓</p></td>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba"><code>&lt;cmath&gt;</code></p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>&#13;
<p class="notep"><em>Other specialized mathematical functions are in the <code>&lt;cmath&gt;</code> header. For example, functions to compute Laguerre and Hermite polynomials, elliptic integrals, cylindrical Bessel and Neumann functions, and the Riemann zeta function appear in the header.</em></p>&#13;
</div>&#13;
<h4 class="h4" id="ch12lev2sec10"><strong><em>Complex Numbers</em></strong></h4>&#13;
<p class="noindent">A <em>complex number</em> is of the form <code>a+bi</code>, where <code>i</code> is an <em>imaginary number</em> that, when multiplied by itself, equals negative one; that is, <code>i*i=-1</code>. Imaginary numbers have applications in control theory, fluid dynamics, electrical engineering, signal analysis, number theory, and quantum physics, among other fields. The <code>a</code> portion of a complex number is called its <em>real component</em>, and the <code>b</code> portion is called the <em>imaginary component</em>.</p>&#13;
<p class="indent">The stdlib offers the <code>std::complex</code> class template in the <code>&lt;complex&gt;</code> header. It accepts a template parameter for the underlying type of the real and imaginary component. This template parameter must be one of the fundamental floating-point types.</p>&#13;
<p class="indent">To construct a <code>complex</code>, you can pass in two arguments: the real and the imaginary components. The <code>complex</code> class also supports copy construction and copy assignment.</p>&#13;
<p class="indent">The non-member functions <code>std::real</code> and <code>std::imag</code> can extract the real and imaginary components from a <code>complex</code>, respectively, as <a href="ch12.xhtml#ch12ex27">Listing 12-27</a> illustrates.</p>&#13;
<pre>#include &lt;complex&gt;&#13;
&#13;
TEST_CASE("std::complex has a real and imaginary component") {&#13;
  std::complex&lt;double&gt; a{0.5, 14.13}; <span class="ent">➊</span>&#13;
  REQUIRE(std::real(a) == Approx(0.5)); <span class="ent">➋</span>&#13;
  REQUIRE(std::imag(a) == Approx(14.13)); <span class="ent">➌</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex27"/><em>Listing 12-27: Constructing a <code>std::complex</code> and extracting its components</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_394"/>You construct a <code>std::complex</code> with a real component of 0.5 and an imaginary component of 14.13 <span class="ent">➊</span>. You use <code>std::real</code> to extract the real component <span class="ent">➋</span> and <code>std::imag</code> to extract the imaginary component <span class="ent">➌</span>.</p>&#13;
<p class="indent"><a href="ch12.xhtml#ch12tab12">Table 12-12</a> contains a partial list of supported operations with <code>std::complex</code>.</p>&#13;
<p class="tabcap"><a id="ch12tab12"/><strong>Table 12-12:</strong> A Partial List of <code>std::complex</code> Operations</p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:40%"/>&#13;
<col style="width:60%"/>&#13;
</colgroup>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Operation</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Notes</strong></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span class="codestrong">c1+c2</span></p>&#13;
<p class="taba"><span class="codestrong">c1-c2</span></p>&#13;
<p class="taba"><span class="codestrong">c1*c2</span></p>&#13;
<p class="taba"><span class="codestrong">c1/c2</span></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Performs addition, subtraction, multiplication, and division.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span class="codestrong">c+s</span></p>&#13;
<p class="taba"><span class="codestrong">c-s</span></p>&#13;
<p class="taba"><span class="codestrong">c*s</span></p>&#13;
<p class="taba"><span class="codestrong">c/s</span></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Converts the scalar <span class="codestrong">s</span> into a complex number with the real component equal to the scalar value and the imaginary component equal to zero. This conversion supports the corresponding complex operation (addition, subtraction, multiplication, or division) in the preceding row.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>real</code><code>(</code><span class="codestrong">c</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Extracts real component.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>imag</code><code>(</code><span class="codestrong">c</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Extracts imaginary component.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>abs</code><code>(</code><span class="codestrong">c</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Computes magnitude.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>arg</code><code>(</code><span class="codestrong">c</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Computes the phase angle.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>norm</code><code>(</code><span class="codestrong">c</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Computes the squared magnitude.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>conj</code><code>(</code><span class="codestrong">c</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Computes the complex conjugate.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>proj</code><code>(</code><span class="codestrong">c</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Computes Riemann sphere projection.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>sin</code><code>(</code><span class="codestrong">c</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Computes the sine.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>cos</code><code>(</code><span class="codestrong">c</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Computes the cosine.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>tan</code><code>(</code><span class="codestrong">c</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Computes the tangent.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>asin</code><code>(</code><span class="codestrong">c</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Computes the arcsine.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>acos</code><code>(</code><span class="codestrong">c</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Computes the arccosine.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>atan</code><code>(</code><span class="codestrong">c</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Computes the arctangent.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba"><span class="codestrong">c</span> <code>= polar(</code><span class="codestrong">m</span><code>,</code> <span class="codestrong">a</span><code>)</code></p></td>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba">Computes complex number determined by magnitude <span class="codestrong">m</span> and angle <span class="codestrong">a</span>.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<h4 class="h4" id="ch12lev2sec11"><strong><em>Mathematical Constants</em></strong></h4>&#13;
<p class="noindent">Boost offers a suite of commonly used mathematical constants in the <code>&lt;boost /math/constants/constants.hpp&gt;</code> header. More than 70 constants are available,  and you can obtain them in <code>float</code>, <code>double</code>, or <code>long double</code> form by obtaining the relevant global variable from the <code>boost::math::float_constants</code>, <code>boost::math::double_constants</code>, and <code>boost::math::long_double_constants</code> respectively.</p>&#13;
<p class="indent">One of the many constants available is <code>four_thirds_pi</code>, which approximates 4<code>π</code>/3. The formula for computing the volume of a sphere of radius <em>r</em> is 4π<em>r</em><sup>3</sup>/3, so you could pull in this constant to make computing such a volume easy. <a href="ch12.xhtml#ch12ex28">Listing 12-28</a> illustrates how to compute the volume of a sphere with radius 10.</p>&#13;
<pre><span epub:type="pagebreak" id="page_395"/>#include &lt;cmath&gt;&#13;
#include &lt;boost/math/constants/constants.hpp&gt;&#13;
&#13;
TEST_CASE("boost::math offers constants") {&#13;
  using namespace boost::math::double_constants; <span class="ent">➊</span>&#13;
  auto sphere_volume = four_thirds_pi * std::pow(10, 3); <span class="ent">➋</span>&#13;
  REQUIRE(sphere_volume == Approx(4188.7902047));&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex28"/><em>Listing 12-28: The <code>boost::math</code> namespace offers constants</em></p>&#13;
<p class="indent">Here, you pull in the namespace <code>boost::math::double_constants</code>, which brings all the <code>double</code> versions of the Boost Math constants <span class="ent">➊</span>. Next, you calculate the <code>sphere_volume</code> by computing <code>four_thirds_pi</code> times 10<sup>3</sup> <span class="ent">➋</span>.</p>&#13;
<p class="indent"><a href="ch12.xhtml#ch12tab13">Table 12-13</a> provides some of the more commonly used constants in Boost Math.</p>&#13;
<p class="tabcap"><a id="ch12tab13"/><strong>Table 12-13:</strong> Some of the Most Common Boost Math Constants</p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:25%"/>&#13;
<col style="width:25%"/>&#13;
<col style="width:25%"/>&#13;
<col style="width:25%"/>&#13;
</colgroup>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Constant</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Value</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Approx.</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Note</strong></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>half</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">1/2</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">0.5</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"/>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>third</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">1/3</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">0.333333</p></td>&#13;
<td style="vertical-align: top;" class="table-b"/>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>two_thirds</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">2/3</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">0.66667</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"/>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>three_quarters</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">3/4</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">0.75</p></td>&#13;
<td style="vertical-align: top;" class="table-b"/>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>root_two</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">√2</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">1.41421</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"/>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>root_three</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">√3</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">1.73205</p></td>&#13;
<td style="vertical-align: top;" class="table-b"/>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>half_root_two</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">√2 / 2</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">0.707106</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"/>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>ln_two</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">ln(2)</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">0.693147</p></td>&#13;
<td style="vertical-align: top;" class="table-b"/>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>ln_ten</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">ln(10)</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">2.30258</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"/>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>pi</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">π</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">3.14159</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Archimedes’ constant</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>two_pi</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">2π</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">6.28318</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Circumference of unit circle</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>four_thirds_pi</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">4π/3</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">4.18879</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Volume of unit sphere</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>one_div_two_pi</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">1/(2π)</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">1.59155</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Gaussian integrals</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>root_pi</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">√ π</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">1.77245</p></td>&#13;
<td style="vertical-align: top;" class="table-b"/>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>e</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">e</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">2.71828</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Euler’s constant e</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>e_pow_pi</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">e<sup>π</sup></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">23.14069</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Gelfond’s constant</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>root_e</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">√e</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">1.64872</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"/>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>log10_e</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">log10(e)</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">0.434294</p></td>&#13;
<td style="vertical-align: top;" class="table-b"/>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>degree</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">π / 180</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">0.017453</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Number of radians per degree</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>radian</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">180 / π</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">57.2957</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Number of degrees per radian</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>sin_one</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">sin(1)</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">0.84147</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"/>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>cos_one</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">cos(1)</p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">0.5403</p></td>&#13;
<td style="vertical-align: top;" class="table-b"/>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>phi</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">(1 + √5) / 2</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">1.61803</p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Phidias’ golden ratio φ</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b2"><p class="taba"><code>ln_phi</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b2"><p class="taba">ln(φ)</p></td>&#13;
<td style="vertical-align: top;" class="table-b2"><p class="taba">0.48121</p></td>&#13;
<td style="vertical-align: top;" class="table-b2"/>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<h4 class="h4" id="ch12lev2sec12"><span epub:type="pagebreak" id="page_396"/><strong><em>Random Numbers</em></strong></h4>&#13;
<p class="indent">In some settings, it’s often necessary to generate random numbers. In scientific computing, you might need to run large numbers of simulations based on random numbers. Such numbers need to emulate draws from random processes with certain characteristics, such as coming from a Poisson or normal distribution. In addition, you usually want these simulations to be repeatable, so the code responsible for generating randomness—the random number engine—should produce the same output given the same input. Such random number engines are sometimes called pseudo-random number engines.</p>&#13;
<p class="indent">In cryptography, you might require random numbers to instead secure information. In such settings, it must be virtually impossible for someone to obtain a similar stream of random numbers; so accidental use of pseudorandom number engines often seriously compromises an otherwise secure&#13;
cryptosystem.</p>&#13;
<p class="indent">For these reasons and others, <em>you should never attempt to build your own random number generator</em>. Building a correct random number generator is surprisingly difficult. It’s too easy to introduce patterns into your random number generator, which can have nasty and hard to diagnose side effects on systems that use your random numbers as input.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>&#13;
<p class="notep"><em>If you’re interested in random number generation, refer to <a href="ch02.xhtml#ch02">Chapter 2</a> of Stochastic Simulation by Brian D. Ripley for scientific applications and <a href="ch02.xhtml#ch02">Chapter 2</a> of Serious Cryptography by Jean-Philippe Aumasson for cryptographic applications.</em></p>&#13;
</div>&#13;
<p class="indent">If you’re in the market for random numbers, look no further than the Random libraries available in the stdlib in the <code>&lt;random&gt;</code> header or in Boost in the <code>&lt;boost/math/...&gt;</code> headers.</p>&#13;
<h5 class="h5" id="ch12lev3sec20"><strong>Random Number Engines</strong></h5>&#13;
<p class="noindent">Random number engines generate random bits. Between Boost and stdlib, there is a dizzying array of candidates. Here’s a general rule: if you need repeatable pseudo-random numbers, consider using the Mersenne Twister engine <code>std::mtt19937_64</code>. If you need cryptographically secure random numbers, consider using <code>std::random_device</code>.</p>&#13;
<p class="indent">The Mersenne Twister has some desirable statistical properties for simulations. You provide its constructor with an integer seed value, which completely determines the sequence of random numbers. All random engines are function objects; to obtain a random number, use the function call <code>operator()</code>. <a href="ch12.xhtml#ch12ex29">Listing 12-29</a> shows how to construct a Mersenne Twister engine with the seed 91586 and invoke the resulting engine three times.</p>&#13;
<pre>#include &lt;random&gt;&#13;
TEST_CASE("mt19937_64 is pseudorandom") {&#13;
  std::mt19937_64 mt_engine{ 91586 }; <span class="ent">➊</span>&#13;
<span epub:type="pagebreak" id="page_397"/>  REQUIRE(mt_engine() == 8346843996631475880); <span class="ent">➋</span>&#13;
  REQUIRE(mt_engine() == 2237671392849523263); <span class="ent">➌</span>&#13;
  REQUIRE(mt_engine() == 7333164488732543658); <span class="ent">➍</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex29"/><em>Listing 12-29: The <code>mt19937_64</code> is a pseudo-random number engine.</em></p>&#13;
<p class="indent">Here, you construct an <code>mt19937_64</code> Mersenne Twister engine with the seed 91586 <span class="ent">➊</span>. Because it’s a pseudo-random engine, you’re guaranteed to get the same sequence of random numbers <span class="ent">➋ ➌ ➍</span> each time. This sequence is determined entirely by the seed.</p>&#13;
<p class="indent"><a href="ch12.xhtml#ch12ex30">Listing 12-30</a> illustrates how to construct a <code>random_device</code> and invoke it to obtain a cryptographically secure random value.</p>&#13;
<pre>TEST_CASE("std::random_device is invocable") {&#13;
  std::random_device rd_engine{}; <span class="ent">➊</span>&#13;
  REQUIRE_NOTHROW(rd_engine()); <span class="ent">➋</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex30"/><em>Listing 12-30: The <code>random_device</code> is a function object.</em></p>&#13;
<p class="indent">You construct a <code>random_device</code> using the default constructor <span class="ent">➊</span>. The resulting object <code>rd_engine</code> <span class="ent">➋</span> is invokable, but you should treat the object as opaque. Unlike the Mersenne Twister in <a href="ch12.xhtml#ch12ex29">Listing 12-29</a>, <code>random_device</code> is unpredictable by design.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>&#13;
<p class="notep"><em>Because computers are deterministic by design, the <code>std::random_device</code> cannot make any strong guarantees about cryptographic security.</em></p>&#13;
</div>&#13;
<h5 class="h5" id="ch12lev3sec21"><strong>Random Number Distributions</strong></h5>&#13;
<p class="noindent">A <em>random number distribution</em> is a mathematical function that maps a number to a probability density. Roughly, the idea is that if you take infinite samples from a random variable that has a particular distribution and you plot the relative frequencies of your sample values, that plot would look like the distribution.</p>&#13;
<p class="indent">Distributions break out into two broad categories: <em>discrete</em> and <em>continu</em><em>ous</em>. A simple analogy is that discrete distributions map integral values, and continuous distributions map floating-point values.</p>&#13;
<p class="indent">Most distributions accept customization parameters. For example, the normal distribution is a continuous distribution that accepts two parameters: a mean and a variance. Its density has a familiar bell shape centered around the mean, as shown in <a href="ch12.xhtml#ch12fig01">Figure 12-1</a>. The discrete uniform distribution is a random number distribution that assigns equal probability to the numbers between some minimum and maximum. Its density looks perfectly flat across its range from minimum to maximum, as shown in <a href="ch12.xhtml#ch12fig02">Figure 12-2</a>.</p>&#13;
<div class="image"><img src="../images/fig12_1.jpg" alt="image"/></div>&#13;
<p class="figcap" id="ch12fig01"><em>Figure 12-1: A representation of the normal distribution’s probability density function</em></p>&#13;
<div class="image"><img src="../images/fig12_2.jpg" alt="image"/></div>&#13;
<p class="figcap" id="ch12fig02"><em>Figure 12-2: A representation of the uniform distribution’s probability density function</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_398"/>You can easily generate random numbers from common statistical distributions, such as the uniform and the normal, using the same stdlib Random library. Each distribution accepts some parameters in its constructor, corresponding to the underlying distribution’s parameters. To draw a random variable from the distribution, you use the function call <code>operator()</code> and pass in an instance of a random number engine, such as a Mersenne Twister.</p>&#13;
<p class="indent">The <code>std::uniform_int_distribution</code> is a class template available in the <code>&lt;random&gt;</code> header that takes a single template parameter corresponding to the type you want returned by draws from the distribution, like an <code>int</code>. You specify the uniform distribution’s minimum and maximum by passing them in as constructor parameters. Each number in the range has equal probability. It’s perhaps the most common distribution to arise in general software engineering contexts.</p>&#13;
<p class="indent"><a href="ch12.xhtml#ch12ex31">Listing 12-31</a> illustrates how to take a million draws from a uniform distribution with a minimum of 1 and a maximum of 10 and compute the sample mean.</p>&#13;
<pre>TEST_CASE("std::uniform_int_distribution produces uniform ints") {&#13;
  std::mt19937_64 mt_engine{ 102787 }; <span class="ent">➊</span>&#13;
  std::uniform_int_distribution&lt;int&gt; int_d{ 0, 10 }; <span class="ent">➋</span>&#13;
  const size_t n{ 1'000'000 }; <span class="ent">➌</span>&#13;
  int sum{}; <span class="ent">➍</span>&#13;
  for (size_t i{}; i &lt; n; i++)&#13;
    sum += int_d(mt_engine); <span class="ent">➎</span>&#13;
  const auto sample_mean = sum / double{ n }; <span class="ent">➏</span>&#13;
  REQUIRE(sample_mean == Approx(5).epsilon(.1)); <span class="ent">➐</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex31"/><em>Listing 12-31: The <code>uniform_int_distribution</code> simulates draws from the discrete uniform distribution.</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_399"/>You construct a Mersenne Twister with the seed 102787 <span class="ent">➊</span> and then construct a <code>uniform_int_distribution</code> with a minimum of 0 and a maximum of 10 <span class="ent">➋</span>. Then you initialize a variable <code>n</code> to hold the number of iterations <span class="ent">➌</span> and initialize a variable to hold the <code>sum</code> of all the uniform random variables <span class="ent">➍</span>. In the loop, you draw random variables from the uniform distribution with <code>operator()</code>, passing in the Mersenne Twister instance <span class="ent">➎</span>.</p>&#13;
<p class="indent">The mean of a discrete uniform distribution is the minimum plus the maximum divided by 2. Here, <code>int_d</code> has a mean of 5. You can compute a sample mean by dividing <code>sum</code> by the number of samples <code>n</code> <span class="ent">➏</span>. With high confidence, you assert that this <code>sample_mean</code> is approximately 5 <span class="ent">➐</span>.</p>&#13;
<h5 class="h5" id="ch12lev3sec22"><strong>A Partial List of Random Number Distributions</strong></h5>&#13;
<p class="noindent"><a href="ch12.xhtml#ch12tab14">Table 12-14</a> contains a partial list of the random number distributions in <code>&lt;random&gt;</code>, their default template parameters, and their constructor parameters.</p>&#13;
<p class="tabcap"><a id="ch12tab14"/><strong>Table 12-14:</strong> Random Number Distributions in <code>&lt;random&gt;</code></p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:40%"/>&#13;
<col style="width:60%"/>&#13;
</colgroup>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Distribution</strong></p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th"><strong>Notes</strong></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>uniform_int_distribution&lt;int&gt;{</code> <span class="codestrong">min</span><code>,</code> <span class="codestrong">max</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Discrete uniform distribution with minimum <span class="codestrong">min</span> and maximum <span class="codestrong">max</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>uniform_real_distribution&lt;double&gt;{</code> <span class="codestrong">min</span><code>,</code> <span class="codestrong">max</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Continuous uniform distribution with minimum <span class="codestrong">min</span> and maximum <span class="codestrong">max</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>normal_distribution&lt;double&gt;{</code> <span class="codestrong">m</span><code>,</code> <span class="codestrong">s</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Normal distribution with mean <span class="codestrong">m</span> and standard deviation <span class="codestrong">s</span>. Commonly used to model the additive product of many independent random variables. Also called the Gaussian distribution.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>lognormal_distribution&lt;double&gt;{</code> <span class="codestrong">m</span><code>,</code> <span class="codestrong">s</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Log-normal distribution with mean <span class="codestrong">m</span> and standard deviation <span class="codestrong">s</span>. Commonly used to model the multiplicative product of many independent random variables. Also called Galton’s distribution.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>chi_squared_distribution&lt;double&gt;{</code> <span class="codestrong">n</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Chi-squared distribution with degrees of freedom <span class="codestrong">n</span>. Commonly used in inferential statistics.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>cauchy_distribution&lt;double&gt;{</code> <span class="codestrong">a</span><code>,</code> <span class="codestrong">b</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Cauchy distribution with location parameter <span class="codestrong">a</span> and scale parameter <span class="codestrong">b</span>.<br/>Used in physics. Also called the Lorentz distribution.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>fisher_f_distribution&lt;double&gt;{</code> <span class="codestrong">m</span><code>,</code> <span class="codestrong">n</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">F distribution with degrees of freedom <span class="codestrong">m</span> and <span class="codestrong">n</span>. Commonly used in inferential statistics. Also called the Snedecor distribution.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>student_t_distribution&lt;double&gt;{</code> <span class="codestrong">n</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">T distribution with degrees of freedom <span class="codestrong">n</span>. Commonly used in inferential statistics. Also called the Student’s T distribution.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><span epub:type="pagebreak" id="page_400"/><code>bernoulli_distribution{</code> <span class="codestrong">p</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Bernoulli distribution with success probability <span class="codestrong">p</span>. Commonly used to model the result of a single, Boolean-valued outcome.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>binomial_distribution&lt;int&gt;{</code> <span class="codestrong">n</span><code>,</code> <span class="codestrong">p</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Binomial distribution with <span class="codestrong">n</span> trials and success probability <span class="codestrong">p</span>. Commonly used to model the number of successes when sampling with replacement in a series of Bernoulli experiments.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>geometric_distribution&lt;int&gt;{</code> <span class="codestrong">p</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Geometric distribution with success probability <span class="codestrong">p</span>. Commonly used to model the number of failures occurring before the first success in a series of Bernoulli experiments.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>poisson_distribution&lt;int&gt;{</code> <span class="codestrong">m</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Poisson distribution with mean <span class="codestrong">m</span>. Commonly used to model the number of events occurring in a fixed interval of time.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>exponential_distribution&lt;double&gt;{</code> <span class="codestrong">l</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Exponential distribution with mean 1/<span class="codestrong">l</span>, where <span class="codestrong">l</span> is known as the lambda parameter. Commonly used to model the amount of time between events in a Poisson process.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>gamma_distribution&lt;double&gt;{</code> <span class="codestrong">a</span><code>,</code> <span class="codestrong">b</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Gamma distribution with shape parameter <span class="codestrong">a</span> and scale parameter <span class="codestrong">b</span>. Generalization of the exponential distribution and chi-squared distribution.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>weibull_distribution&lt;double&gt;{</code> <span class="codestrong">k</span><code>,</code> <span class="codestrong">l</span> <code>}</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Weibull distribution with shape parameter <span class="codestrong">k</span> and scale parameter <span class="codestrong">l</span>. Commonly used to model time to failure.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b2"><p class="taba"><code>extreme_value_distribution&lt;double&gt;{</code> <span class="codestrong">a</span><code>,</code> <span class="codestrong">b</span> <code> }</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b2"><p class="taba">Extreme value distribution with location parameter <span class="codestrong">a</span> and scale parameter <span class="codestrong">b</span>. Commonly used to model maxima of independent random variables. Also called the Gumbel type-I distribution.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>&#13;
<p class="notep"><em>Boost Math offers more random number distributions in the <code>&lt;boost/math/...&gt;</code> series of headers, for example, the beta, hypergeometric, logistic, and inverse normal distributions.</em></p>&#13;
</div>&#13;
<h4 class="h4" id="ch12lev2sec13"><strong><em>Numeric Limits</em></strong></h4>&#13;
<p class="noindent">The stdlib offers the class template <code>std::numeric_limits</code> in the <code>&lt;limits&gt;</code> header to provide you with compile time information about various <span epub:type="pagebreak" id="page_401"/>properties for arithmetic types. For example, if you want to identify the smallest finite value for a given type <code>T</code>, you can use the static member function <code>std::numeric_limits&lt;T&gt;::min()</code> to obtain it.</p>&#13;
<p><a href="ch12.xhtml#ch12ex32">Listing 12-32</a> illustrates how to use <code>min</code> to facilitate an underflow.</p>&#13;
<pre>#include &lt;limits&gt;&#13;
TEST_CASE("std::numeric_limits::min provides the smallest finite value.") {&#13;
  auto my_cup = std::numeric_limits&lt;int&gt;::min(); <span class="ent">➊</span>&#13;
  auto underfloweth = my_cup - 1; <span class="ent">➋</span>&#13;
  REQUIRE(my_cup &lt; underfloweth); <span class="ent">➌</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex32"/><em>Listing 12-32: Using <code>std::numeric_limits&lt;T&gt;::min()</code> to facilitate an <code>int</code> underflow. Although at press time the major compilers produce code that passes the test, this program contains undefined behavior.</em></p>&#13;
<p class="indent">First, you set the <code>my_cup</code> variable equal to the smallest possible <code>int</code> value by using <code>std::numeric_limits&lt;int&gt;::min()</code> <span class="ent">➊</span>. Next, you intentionally cause an underflow by subtracting 1 from <code>my_cup</code> <span class="ent">➋</span>. Because <code>my_cup</code> is the minimum value an <code>int</code> can take, <code>my_cup</code> runneth under, as the saying goes. This causes the deranged situation that <code>underfloweth</code> is greater than <code>my_cup</code> <span class="ent">➌</span>, even though you initialized <code>underfloweth</code> by subtracting from <code>my_cup</code>.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>&#13;
<p class="notep"><em>Such silent underflows have been the cause of untold numbers of software security vulnerabilities. Don’t rely on this undefined behavior!</em></p>&#13;
</div>&#13;
<p class="indent">Many static member functions and member constants are available on <code>std::numeric_limits</code>. <a href="ch12.xhtml#ch12tab15">Table 12-15</a> lists some of the most common.</p>&#13;
<p class="tabcap"><a id="ch12tab15"/><strong>Table 12-15:</strong> Some Common Member Constants in <code>std::numeric_limits</code></p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:40%"/>&#13;
<col style="width:60%"/>&#13;
</colgroup>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th">Operation</p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th">Notes</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>numeric_limits&lt;</code><span class="codestrong">T</span><code>&gt;::is_signed</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>true</code> if <span class="codestrong">T</span> is signed.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>numeric_limits&lt;</code><span class="codestrong">T</span><code>&gt;::is_integer</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>true</code> if <span class="codestrong">T</span> is an integer.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>numeric_limits&lt;</code><span class="codestrong">T</span><code>&gt;::has_infinity</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Identifies whether <span class="codestrong">T</span> can encode an infinite value. (Usually, all floating-point types have an infinite value, whereas integral types don’t.)</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>numeric_limits&lt;</code><span class="codestrong">T</span><code>&gt;::digits10</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Identifies the number of digits <span class="codestrong">T</span> can represent.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>numeric_limits&lt;</code><span class="codestrong">T</span><code>&gt;::min()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Returns the smallest value of <span class="codestrong">T</span>.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b2"><p class="taba"><code>numeric_limits&lt;</code><span class="codestrong">T</span><code>&gt;::max()</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b2"><p class="taba">Returns the largest value of <span class="codestrong">T</span>.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>&#13;
<p class="notep"><em>Boost Integer provides some additional facilities for introspecting integer types, such as determining the fastest or smallest integer, or the smallest integer with at least <em>N</em> bits.</em></p>&#13;
</div>&#13;
<h4 class="h4" id="ch12lev2sec14"><strong><em>Boost Numeric Conversion</em></strong></h4>&#13;
<p class="noindent">Boost provides the Numeric Conversion library, which contains a collection of tools to convert between numeric objects. The <code>boost::converter</code> class template in the <code>&lt;boost/numeric/conversion/converter.hpp&gt;</code> header encapsulates <span epub:type="pagebreak" id="page_402"/>code to perform a specific numeric conversion from one type to another. You must provide two template parameters: the target type <code>T</code> and the source type <span class="codestrong">S</span>. You can specify a numeric converter that takes a <code>double</code> and converts it to an <code>int</code> with the simple type alias <code>double_to_int</code>:</p>&#13;
<pre>#include &lt;boost/numeric/conversion/converter.hpp&gt;&#13;
using double_to_int = boost::numeric::converter&lt;int<span class="ent">➊</span>, double<span class="ent">➋</span>&gt;;</pre>&#13;
<p class="indent">To convert with your new type alias <code>double_to_int</code>, you have several options. First, you can use its static method <code>convert</code>, which accepts a <code>double</code> <span class="ent">➋</span> and returns an <code>int</code> <span class="ent">➊</span>, as <a href="ch12.xhtml#ch12ex33">Listing 12-33</a> illustrates.</p>&#13;
<pre>TEST_CASE("boost::converter offers the static method convert") {&#13;
  REQUIRE(double_to_int::convert(3.14159) == 3);&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex33"/><em>Listing 12-33: The <code>boost::converter</code> offers the static method <code>convert</code>.</em></p>&#13;
<p class="indent">Here, you simply invoke the <code>convert</code> method with the value 3.14159, which <code>boost::convert</code> converts to 3.</p>&#13;
<p class="indent">Because <code>boost::convert</code> provides the function call <code>operator()</code>, you can construct a function object <code>double_to_int</code> and use it to convert, as in <a href="ch12.xhtml#ch12ex34">Listing 12-34</a>.</p>&#13;
<pre>TEST_CASE("boost::numeric::converter implements operator()") {&#13;
  double_to_int dti; <span class="ent">➊</span>&#13;
  REQUIRE(dti(3.14159) == 3); <span class="ent">➋</span>&#13;
  REQUIRE(double_to_int{}(3.14159) == 3); <span class="ent">➌</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex34"/><em>Listing 12-34: The <code>boost::converter</code> implements <code>operator()</code>.</em></p>&#13;
<p class="indent">You construct a <code>double_to_int</code> function object called <code>dti</code> <span class="ent">➊</span>, which you invoke with the same argument, 3.14159 <span class="ent">➋</span>, as in <a href="ch12.xhtml#ch12ex33">Listing 12-33</a>. The result is the same. You also have the option of constructing a temporary function object and using <code>operator()</code> directly, which yields identical results <span class="ent">➌</span>.</p>&#13;
<p class="indent">A major advantage of using <code>boost::converter</code> instead of alternatives like <code>static_cast</code> is runtime bounds checking. If a conversion would cause an overflow, <code>boost::converter</code> will throw a <code>boost::numeric::positive_overflow</code> or <code>boost::numeric::negative_overflow</code>. <a href="ch12.xhtml#ch12ex35">Listing 12-35</a> illustrates this behavior when you attempt to convert a very large <code>double</code> into an <code>int</code>.</p>&#13;
<pre>#include &lt;limits&gt;&#13;
TEST_CASE("boost::numeric::converter checks for overflow") {&#13;
  auto yuge = std::numeric_limits&lt;double&gt;::max(); <span class="ent">➊</span>&#13;
  double_to_int dti; <span class="ent">➋</span>&#13;
  REQUIRE_THROWS_AS(dti(yuge)<span class="ent">➌</span>, boost::numeric::positive_overflow<span class="ent">➍</span>);&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex35"/><em>Listing 12-35: The <code>boost::converter</code> checks for overflow.</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_403"/>You use <code>numeric_limits</code> to obtain a <code>yuge</code> value <span class="ent">➊</span>. You construct a <code>double _</code><code>to_int</code> converter <span class="ent">➋</span>, which you use to attempt a conversion of <code>yuge</code> to an <code>int</code> <span class="ent">➌</span>. This throws a <code>positive_overflow</code> exception because the value is too large to store <span class="ent">➍</span>.</p>&#13;
<p class="indent">It’s possible to customize the conversion behavior of <code>boost::converter</code> using template parameters. For example, you can customize the overflow handling to throw a custom exception or perform some other operation. You can also customize rounding behavior so that rather than truncating off the decimal from a floating-point value, you perform custom rounding. See the Boost Numeric Conversion documentation for details.</p>&#13;
<p class="indent">If you’re happy with the default <code>boost::converter</code> behavior, you can use the <code>boost::numeric_cast</code> function template as a shortcut. This function template accepts a single template parameter corresponding to the target type of the conversion and a single argument corresponding to the source number. <a href="ch12.xhtml#ch12ex36">Listing 12-36</a> provides an update to <a href="ch12.xhtml#ch12ex35">Listing 12-35</a> that uses <code>boost::numeric_cast</code> instead.</p>&#13;
<pre>#include &lt;limits&gt;&#13;
#include &lt;boost/numeric/conversion/cast.hpp&gt;&#13;
&#13;
TEST_CASE("boost::boost::numeric_cast checks overflow") {&#13;
  auto yuge = std::numeric_limits&lt;double&gt;::max(); <span class="ent">➊</span>&#13;
  REQUIRE_THROWS_AS(boost::numeric_cast&lt;int&gt;(yuge), <span class="ent">➋</span>&#13;
                    boost::numeric::positive_overflow <span class="ent">➌</span>);&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex36"/><em>Listing 12-36: The <code>boost::numeric_cast</code> function template also performs runtime bounds checking.</em></p>&#13;
<p class="indent">As before, you use <code>numeric_limits</code> to obtain a <code>yuge</code> value <span class="ent">➊</span>. When you try to <code>numeric_cast</code> <code>yuge</code> into an <code>int</code> <span class="ent">➋</span>, you get a <code>positive_overflow</code> exception because the value is too large to store <span class="ent">➌</span>.</p>&#13;
<div class="note">&#13;
<p class="notet"><strong><span class="notes">NOTE</span></strong></p>&#13;
<p class="notep"><em>The <code>boost::numeric_cast</code> function template is a suitable replacement for the <code>narrow_cast</code> you hand-rolled in <a href="ch06.xhtml#ch06ex06">Listing 6-6</a> on <a href="ch06.xhtml#page_154">page 154</a>.</em></p>&#13;
</div>&#13;
<h4 class="h4" id="ch12lev2sec15"><strong><em>Compile-Time Rational Arithmetic</em></strong></h4>&#13;
<p class="noindent">The stdlib <code>std::ratio</code> in the <code>&lt;ratio&gt;</code> header is a class template that enables you to compute rational arithmetic at compile time. You provide two template parameters to <code>std::ratio</code>: a numerator and a denominator. This defines a new type that you can use to compute rational expressions.</p>&#13;
<p class="indent">The way you perform compile-time computation with <code>std::ratio</code> is by using template metaprogramming techniques. For example, to multiply two <code>ratio</code> types, you can use the <code>std::ratio_multiply</code> type, which takes the two <code>ratio</code> types as template parameters. You can extract the numerator and denominator of the result using static member variables on the resulting type.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_404"/><a href="ch12.xhtml#ch12ex37">Listing 12-37</a> illustrates how to multiply 10 by 2/3 at compile time.</p>&#13;
<pre>#include &lt;ratio&gt;&#13;
&#13;
TEST_CASE("std::ratio") {&#13;
  using ten = std::ratio&lt;10, 1&gt;; <span class="ent">➊</span>&#13;
  using two_thirds = std::ratio&lt;2, 3&gt;; <span class="ent">➋</span>&#13;
  using result = std::ratio_multiply&lt;ten, two_thirds&gt;; <span class="ent">➌</span>&#13;
  REQUIRE(result::num == 20); <span class="ent">➍</span>&#13;
  REQUIRE(result::den == 3); <span class="ent">➎</span>&#13;
}</pre>&#13;
<p class="listing"><a id="ch12ex37"/><em>Listing 12-37: Compile time rational arithmetic with <code>std::ratio</code></em></p>&#13;
<p class="indent">You declare the <code>std::ratio</code> types <code>ten</code> <span class="ent">➊</span> and <code>two_thirds</code> <span class="ent">➋</span> as type aliases. To compute the product of <code>ten</code> and <code>two_thirds</code>, you again declare another type, <code>result</code>, using the <code>std::ratio_multiply</code> template <span class="ent">➌</span>. Using the static members <code>num</code> and <code>den</code>, you can extract the result, 20/3 <span class="ent">➍ ➎</span>.</p>&#13;
<p class="indent">Of course, it’s always better to do computation at compile time rather than at runtime when you can. Your programs will be more efficient because they’ll need to do less computation when they run.</p>&#13;
<h5 class="h5" id="ch12lev3sec23"><strong>A Partial List of Random Number Distributions</strong></h5>&#13;
<p class="noindent"><a href="ch12.xhtml#ch12tab16">Table 12-16</a> contains a partial list of the operations provided by stdlib’s <code>&lt;ratio&gt;</code> library.</p>&#13;
<p class="tabcap"><a id="ch12tab16"/><strong>Table 12-16:</strong> A Partial List of Operations Available in <code>&lt;ratio&gt;</code></p>&#13;
<table class="topbot-d">&#13;
<colgroup>&#13;
<col style="width:40%"/>&#13;
<col style="width:60%"/>&#13;
</colgroup>&#13;
<tbody>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th">Distribution</p></td>&#13;
<td style="vertical-align: top;" class="table-h"><p class="tab_th">Notes</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>ratio_add&lt;</code><span class="codestrong">r1</span><code>,</code> <span class="codestrong">r2</span><code>&gt;</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Adds <span class="codestrong">r1</span> and <span class="codestrong">r2</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>ratio_subtract&lt;</code><span class="codestrong">r1</span><code>,</code> <span class="codestrong">r2</span><code>&gt;</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Subtracts <span class="codestrong">r2</span> from <span class="codestrong">r1</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>ratio_multiply&lt;</code><span class="codestrong">r1</span><code>,</code> <span class="codestrong">r2</span><code>&gt;</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Multiplies <span class="codestrong">r1</span> and <span class="codestrong">r2</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>ratio_divide&lt;</code><span class="codestrong">r1</span><code>,</code> <span class="codestrong">r2</span><code>&gt;</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Divides <span class="codestrong">r1</span> by <span class="codestrong">r2</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>ratio_equal&lt;</code><span class="codestrong">r1</span><code>,</code> <span class="codestrong">r2</span><code>&gt;</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Tests whether <span class="codestrong">r1</span> equals <span class="codestrong">r2</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>ratio_not_equal&lt;</code><span class="codestrong">r1</span><code>,</code> <span class="codestrong">r2</span><code>&gt;</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Tests whether <span class="codestrong">r1</span> is not equal to <span class="codestrong">r2</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>ratio_less&lt;</code><span class="codestrong">r1</span><code>,</code> <span class="codestrong">r2</span><code>&gt;</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Tests whether <span class="codestrong">r1</span> is less than <span class="codestrong">r2</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>ratio_greater&lt;</code><span class="codestrong">r1</span><code>,</code> <span class="codestrong">r2</span><code>&gt;</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Tests whether <span class="codestrong">r1</span> is greater than <span class="codestrong">r2</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>ratio_less_equal&lt;</code><span class="codestrong">r1</span><code>,</code> <span class="codestrong">r2</span><code>&gt;</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Tests whether <span class="codestrong">r1</span> is less than or equal to <span class="codestrong">r2</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>ratio_greater_equal&lt;</code><span class="codestrong">r1</span><code>,</code> <span class="codestrong">r2</span><code>&gt;</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Tests whether <span class="codestrong">r1</span> is greater than or equal to <span class="codestrong">r2</span></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>micro</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Literal: <code>ratio&lt;1, 1000000&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>milli</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Literal: <code>ratio&lt;1, 1000&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>centi</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Literal: <code>ratio&lt;1, 100&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>deci</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Literal: <code>ratio&lt;1, 10&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>deca</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Literal: <code>ratio&lt;10, 1&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><span epub:type="pagebreak" id="page_405"/><code>hecto</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Literal: <code>ratio&lt;100, 1&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba"><code>kilo</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b1"><p class="taba">Literal: <code>ratio&lt;1000, 1&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba"><code>mega</code></p></td>&#13;
<td style="vertical-align: top;" class="table-b"><p class="taba">Literal: <code>ratio&lt;1000000, 1&gt;</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba"><code>giga</code></p></td>&#13;
<td style="vertical-align: top;" class="table-ba"><p class="taba">Literal: <code>ratio&lt;1000000000, 1&gt;</code></p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<h3 class="h3" id="ch12lev1sec5"><strong>Summary</strong></h3>&#13;
<p class="indent">In this chapter, you examined a potpourri of small, simple, focused utilities that service common programming needs. Data structures, such as <code>tribool</code>, <code>optional</code>, <code>pair</code>, <code>tuple</code>, <code>any</code>, and <code>variant</code> handle many commonplace scenarios in which you need to contain objects within a common structure. In the coming chapters, a few of these data structures will make repeat appearances throughout the stdlib. You also learned about date/time and numerics/math facilities. These libraries implement very specific functionality, but when you have such requirements, these libraries are invaluable.</p>&#13;
<div class="box5" id="bm01">&#13;
<p class="boxtitle-d"><strong>EXERCISES</strong></p>&#13;
<p class="noindent"><strong>12-1.</strong> Reimplement the <code>narrow_cast</code> in <a href="ch06.xhtml#ch06ex06">Listing 6-6</a> to return a <code>std::optional</code>. If the cast would result in a narrowing conversion, return an empty optional rather than throwing an exception. Write a unit test that ensures your solution works.</p>&#13;
<p class="noindent"><strong>12-2.</strong> Implement a program that generates random alphanumeric passwords and writes them to the console. You can store the alphabet of possible characters into a <code>char[]</code> and use the discrete uniform distribution with a minimum of zero and a maximum of the last index of your alphabet array. Use a cryptographically secure random number engine.</p>&#13;
</div>&#13;
<div class="box6" id="bm02">&#13;
<p class="boxtitle-d"><strong>FURTHER READING</strong></p>&#13;
<ul>&#13;
<li class="noindent"><em>ISO International Standard ISO/IEC (2017) — Programming Language C++</em> (International Organization for Standardization; Geneva, Switzerland; <em><a href="https://isocpp.org/std/the-standard/">https://isocpp.org/std/the-standard/</a></em>)</li>&#13;
<li class="noindent"><em>The Boost C++ Libraries</em>, 2nd Edition, by Boris Schäling (XML Press, 2014)</li>&#13;
<li class="noindent"><em>The C++ Standard Library: A Tutorial and Reference</em>, 2nd Edition, by Nicolai M. Josuttis (Addison-Wesley Professional, 2012)</li>&#13;
</ul>&#13;
</div>&#13;
</body></html>