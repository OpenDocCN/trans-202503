- en: <hgroup>
  id: totrans-0
  prefs: []
  type: TYPE_NORMAL
  zh: <hgroup>
- en: AFTERWORD
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 后记
- en: </hgroup>
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: </hgroup>
- en: '![](../images/chapter.jpg)'
  id: totrans-3
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/chapter.jpg)'
- en: I hope that you’ve enjoyed reading this book half as much as I’ve enjoyed writing
    it. For me, this project was a new, exciting, and illuminating endeavor. It’s
    my first, and quite possibly only, book. If you had told me upon high school graduation
    that I’d someday be an author, I never would’ve believed you.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 我希望你读这本书的乐趣，能够与我写这本书的乐趣半分相当。对我来说，这个项目是一次全新、激动人心且富有启发性的尝试。这是我的第一本书，也可能是唯一的一本。如果你在我高中毕业时告诉我，我有一天会成为一名作者，我绝对不相信你。
- en: I was a math kid, and I also excelled at a BASIC coding course that was offered
    my senior year. I did well enough in English, but I then considered writing to
    be a chore. In college, I enjoyed two technical writing courses as part of my
    major, but the idea of a book still would’ve seemed absurd. After many years of
    reading different types of books and articles, I slowly began to appreciate the
    creative outlet that is writing. I dabbled here and there but never published
    anything, not even a blog. Sometime around my 50th birthday and after years of
    coding bat files, the hint of an inkling of an idea for writing this book took
    shallow root, but I wasn’t yet ready to act upon this most bizarre midlife crisis,
    if that’s what it was.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 我是一个数学迷，而且在我高年级时的一门BASIC编程课程中也表现优秀。我在英语课上成绩还不错，但当时我认为写作是一项苦差事。在大学时，作为我的专业课程，我上过两门技术写作课，但即便如此，写一本书的想法依然显得荒谬。经过多年阅读不同类型的书籍和文章后，我渐渐开始欣赏写作这一创造性输出。虽然偶尔尝试过写作，但从未发表过任何作品，甚至没有写过博客。大约在我50岁生日时，经过多年的BAT文件编程，我脑海中开始有了写这本书的一个微弱的想法，虽然那时我并没有准备好去面对这场看似荒唐的中年危机（如果它真的是一种危机的话）。
- en: More than two years later, in May 2020, two events collided that left me with
    some spare time allowing me to put fingertips to keyboard. (By this point in the
    computer age, we should have a better digital euphemism for “put pen to paper.”)
    First, the realization that the coronavirus pandemic would last more than a couple
    of months became glaringly obvious. I had plenty of vacation time and no travel
    plans. Second, after a decade and a half of intense parenting, including the coaching
    of several youth sports teams, my son reached an age where instead of demanding
    my time, he demanded the exact opposite (like most teenagers).
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 两年多后的2020年5月，两个事件碰撞在一起，使我有了一些空闲时间，可以把手指放到键盘上。 （在计算机时代，我们应该有一个更好的数字化委婉说法来代替“提笔写作”）。首先，显而易见的是，新冠疫情将持续超过几个月。我有充足的假期时间，却没有旅行计划。其次，在经历了十五年的紧张育儿生活，包括教导多个青少年运动队之后，我的儿子到了一个年龄，开始不再要求我陪伴，反而要求我完全放手（像大多数青少年一样）。
- en: 'My wife and I (while sometimes dragging our son along) did a fair amount of
    hiking that summer. I also did a lot of running, but I returned to the idea of
    this book, especially with the knowledge that normality wouldn’t be returning
    before temperatures dropped in the Northeast. Sporadically and in no particular
    order, I wrote a chapter here and there, not knowing if I’d post them on a blog
    or find some other medium, but before long I knew that I wanted to write a book,
    an actual physical book. As the mercury dropped, I wrote every weekend, and this
    continued through to the spring and summer ... and the next fall, and beyond.
    (I code fast but write slow.) My wife to me in early June 2021: “So what do you
    want for Father’s Day, other than to be left alone so that you can write?”'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 我和妻子（虽然有时是强行带着儿子）那个夏天做了相当多的远足。我也跑了不少步，但我还是回到了这本书的构思，尤其是意识到正常生活在东北地区的气温降下之前是不会恢复的。我时不时地、没有特定顺序地写了一章又一章，不知道是要将它们发布在博客上，还是找其他媒介，但很快我知道，我想写一本书，一本真正的实体书。随着气温的下降，我每个周末都写作，这种状态一直持续到春天、夏天……再到下一个秋天，甚至更久。（我写代码很快，但写作很慢。）2021年6月初，我妻子对我说：“那么，父亲节你想要什么，除了一个人待着，好让你写作？”
- en: After a couple of years, I presented what I thought was a finished product to
    No Starch Press. To my amazement, my publisher of first choice signed me up. Being
    a novice, my manuscript was raw, and they had some great ideas about how I could
    organize and improve what I had without losing my voice. (As for my voice, I write
    first for myself and then consider possible critiques. Who would write “the hint
    of an inkling of an idea?” Is it pretentious or just inane? I don’t know, but
    I like it and can only hope you do too.)
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 经过几年的努力，我将我认为已经完成的作品呈现给了 No Starch Press。令我惊讶的是，我的首选出版社签约了我。作为新手，我的手稿还很粗糙，但他们提出了一些很好的建议，帮助我在不失去个人风格的前提下改进和组织内容。（至于我的风格，我首先是为自己写作，然后才考虑可能的评论。谁会写“一个若有若无的想法的迹象”？这算是矫情还是空洞呢？我不知道，但我喜欢这样，只能希望你也喜欢。）
- en: More than 90 percent of what’s in this book represents the type of coding and
    techniques that I’ve used often personally and professionally. As for the small
    amount of material that I had to research, I hope that I’ve blended it seamlessly
    (and indistinguishably) with what’s in my wheelhouse.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 本书中的90%以上内容代表了我个人和职业生涯中经常使用的编程和技术。至于那些我必须研究的小部分内容，我希望我能够将它们与我擅长的内容无缝地融合在一起，做到不留痕迹。
- en: For most coding languages, the idea of a single book covering the majority of
    the language’s functionality would be ludicrous. For instance, there are introductory
    Python books, others for Python and web development, and yet others for Python
    and databases, just to name a few. But Batch scripting is a more manageable subject.
    I hope that I’ve included most of the important features about the language for
    beginners and experts alike, but no book can be truly comprehensive.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 对于大多数编程语言来说，一本书涵盖该语言大部分功能的想法是荒谬的。例如，有介绍 Python 的入门书籍，还有一些专注于 Python 和 Web 开发的书籍，甚至还有一些专注于
    Python 和数据库的书籍，仅举几例。但是批处理脚本是一个相对更易于管理的主题。我希望我已经包括了对初学者和专家都很重要的大部分语言特性，但没有任何一本书可以做到真正的全面性。
- en: Many commands haven’t made it into these pages. For instance, the curl command
    transfers data from and to a server, cipher encrypts and decrypts files, and runas
    runs a bat file under a different user profile. There are other commands specific
    to system administration that I haven’t covered, and I’ve left others out because
    I simply don’t find them useful. I haven’t mentioned the replace command (until
    now) because Batch has much better tools available for replacing one file with
    another.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 许多命令没有被纳入到本书中。例如，curl 命令用于从服务器传输数据，cipher 命令用于加密和解密文件，runas 命令用于在不同的用户配置文件下运行批处理文件。还有一些特定于系统管理的命令我没有涉及，而有些命令我之所以没有包含，是因为我认为它们不太实用。我之前没有提到
    replace 命令（直到现在）是因为批处理有更好的工具来用一个文件替换另一个文件。
- en: For those remaining pieces of Batch that I haven’t covered, I hope you now have
    the tools to perform your own research. More than once, I’ve mentioned that you
    can find a full list of commands including a description, syntax, options, and
    examples at *[https://<wbr>ss64<wbr>.com<wbr>/nt<wbr>/](https://ss64.com/nt/)*.
    You can scroll through the list of commands looking for something that might be
    useful for a particular problem or if you’ve heard of a certain command for configuring
    internet protocols and want to learn more, just click on **ipconfig** and explore.
    No book is going to have everything, but I hope that you’ve found this one to
    contain the essentials, and much more.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 对于那些我没有涉及的批处理语言的部分，我希望你现在已经有了自己进行研究的工具。我曾多次提到，你可以在 *[https://<wbr>ss64<wbr>.com<wbr>/nt<wbr>/](https://ss64.com/nt/)*
    上找到一个完整的命令列表，包括描述、语法、选项和示例。你可以浏览命令列表，寻找可能对某个特定问题有用的命令，或者如果你听说过某个用于配置互联网协议的命令并想了解更多，只需点击
    **ipconfig** 进行探索。没有任何一本书能够包含所有内容，但我希望你能在这本书中找到必备的知识，甚至更多。
- en: For the coders finishing this book, the next time you’re working on a simple
    bat file that needs something a little out of the ordinary—arrays, booleans, floating-point
    arithmetic, stacks, maybe even an object—I hope that you don’t immediately fall
    back on writing some compiled code. Depending on the situation, a few lines of
    Batch might be the most efficient solution.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 对于完成本书的编程人员，下次当你在处理一个需要一些不同寻常的内容——数组、布尔值、浮点运算、栈，甚至可能是对象——的简单批处理文件时，我希望你不要立刻回过头去编写一些编译代码。根据具体情况，几行批处理代码可能是最有效的解决方案。
- en: For the noncoders, if you made it all the way through [Part III](part3.xhtml),
    consider yourself an honorary coder. But more to the point, the next time you
    have a redundant task that must be done at certain intervals, perhaps daily, consider
    Batch. Run a simple bat file at the end of the day to copy your day’s work to
    a backup server or a shared directory. If a few reports need to be merged into
    a single file, don’t cut and paste. Impress your boss and co-workers, and maybe
    even yourself.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 对于非程序员来说，如果你已经读完了[第三部分](part3.xhtml)，可以认为自己是一个荣誉程序员。但更重要的是，下次如果你遇到必须在特定时间间隔内（可能是每日）完成的重复任务，考虑使用Batch。每天结束时运行一个简单的bat文件，将你当天的工作复制到备份服务器或共享目录。如果需要将几个报告合并为一个文件，不要进行剪切粘贴。给你的老板和同事留下深刻印象，或许你自己也会觉得惊讶。
- en: 'Along these lines, I have one last bat file to share. As I was writing this
    book, I obviously backed up to the cloud, but I also wanted a date-stamped folder
    of the current state of all Word documents, bat files, and anything else associated
    with this book, and I wanted to make this backup at the end of each day of writing.
    Just before logging off, I would plug a thumb drive into my laptop and run a bat
    file containing just this code from my desktop:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 按照这个思路，我有一个最后的bat文件想要分享。当我写这本书的时候，显然我会将文件备份到云端，但我也希望有一个带有日期戳的文件夹，里面存放着所有Word文档、bat文件和与这本书相关的其他文件，并且我希望在每个写作日的结束时进行备份。每次登出前，我都会将U盘插入我的笔记本电脑，并从桌面运行一个仅包含以下代码的bat文件：
- en: '[PRE0]'
  id: totrans-16
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: This quick and dirty bat file builds a datestamp for the target folder name
    under *D:\Batch\*. The xcopy command creates my backup from *C:\Batch\*, and the
    pause command holds the window open so that I’ll know if I’ve run out of disk
    space. This was an incredibly simple solution that fit my needs, but you can expand
    on this to build a more robust bat file.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 这个简单粗暴的bat文件为目标文件夹的名称生成日期戳，文件夹位于*D:\Batch\*。xcopy命令会从*C:\Batch\*创建备份，而pause命令会保持窗口打开，这样我就能知道是否磁盘空间已满。这是一个非常简单的解决方案，满足了我的需求，但你可以在此基础上扩展，构建一个更强大的bat文件。
- en: I consider myself a scripting evangelist, in general, and a Batch evangelist,
    in particular. Coders too often fall back on compiled code for tasks more easily
    and efficiently performed with a script. In [Chapter 1](chapter1.xhtml), I defined
    the word *batphile* as a “lover of nocturnal flying mammals.” I’d now like to
    assign to it a secondary definition, “lover of bat files.” (Batfilephile is painfully
    clunky.) I hope that if you weren’t already, you’re now a proud batphile—in at
    least one sense of the word. Some fear the flying mammals, but they’re fascinating
    animals and rather adorable.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 我通常认为自己是一个脚本推广者，尤其是Batch脚本推广者。程序员们常常在需要执行一些可以更轻松、更高效地通过脚本完成的任务时，依赖编译过的代码。在[第一章](chapter1.xhtml)中，我将*batphile*一词定义为“喜欢夜行飞行哺乳动物的人”。现在，我想给它一个次要的定义，“喜欢bat文件的人”。（Batfilephile听起来实在太笨拙了。）我希望如果你还不是，现在至少在某种意义上你已经是一个骄傲的batphile了。有些人害怕这些飞行哺乳动物，但它们是迷人的动物，而且相当可爱。
