<html><head></head><body><div class="appendix" title="Appendix&#xA0;A.&#xA0;Help! I&#x2019;ve Fallen and I can&#x2019;t Get Up"><div class="titlepage"><div><div><h1 class="title"><a id="helpexclamation_mark_iapostropheve_falle"/>Appendix A. Help! I’ve Fallen and I can’t Get Up</h1></div></div></div><p><a id="iddle1375" class="indexterm"/><a id="iddle2244" class="indexterm"/><a id="iddle2252" class="indexterm"/><a id="iddle2254" class="indexterm"/><a id="iddle2256" class="indexterm"/>GNS3 is a complex program, and like anything complex, it will occasionally behave in unexpected ways. I’ve already included troubleshooting tips throughout the book, so in this appendix I won’t provide a lot of break-fix information. Instead, I will provide you with basic strategies for solving problems, and I’ll cover a few common problems and possible solutions.</p><div class="sect1" title="Identifying the Problem"><div class="titlepage"><div><div><h1 class="title"><a id="identifying_the_problem"/>Identifying the Problem</h1></div></div></div><p>GNS3 problems broadly fall into two categories.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p title="Sudden Problems"><span class="title"><strong><span class="strong"><strong>Sudden Problems</strong></span></strong></span>. Problems that occur with a previously working project.</p></li><li class="listitem"><p title="Feature Problems"><span class="title"><strong><span class="strong"><strong>Feature Problems</strong></span></strong></span>. Problems that occur when implementing a new feature.</p></li></ul></div><p><a id="iddle1252" class="indexterm"/><a id="iddle1320" class="indexterm"/><a id="iddle1573" class="indexterm"/><a id="iddle1590" class="indexterm"/><a id="iddle1791" class="indexterm"/><a id="iddle2050" class="indexterm"/><a id="iddle2085" class="indexterm"/><a id="iddle2243" class="indexterm"/><a id="iddle2248" class="indexterm"/>Sudden problems appear out of nowhere. Your project may have been running fine for weeks, and then all of a sudden it won’t open, or when it does open, devices refuse to start. Feature problems typically occur when creating a new project or implementing a new feature in an existing project. Both problem types can be frustrating, and if you use GNS3 for any length of time, you’re likely to encounter at least one of them.</p></div><div class="sect1" title="Sudden Problems"><div class="titlepage"><div><div><h1 class="title"><a id="sudden_problems"/>Sudden Problems</h1></div></div></div><p>When a project has been running well and suddenly develops a problem, it usually indicates that something has changed. Something could have changed on your PC, within GNS3, or in the project itself. For GNS3’s part, it could be that you inadvertently changed a setting or made changes to a helper application such as Dynamips, QEMU, or VirtualBox. It could also mean that you upgraded to a problematic version of GNS3. Whenever a new version of GNS3 is released, it’s always a good idea to test it using a spare PC or virtual machine before you upgrade your production environment. This section provides tips to help correct a few sudden problems.</p><div class="sect2" title="Stopping Dynamips Crashes"><div class="titlepage"><div><div><h2 class="title"><a id="stopping_dynamips_crashes"/>Stopping Dynamips Crashes</h2></div></div></div><p>An unstable Dynamips program can result in lost connections to devices. In this case, you may see a GNS3 console error message indicating that Dynamips has stopped running, as shown in <a class="xref" href="apa.html#communication_failure_with_dynamips" title="Figure A-1. Communication failure with Dynamips">Figure A-1</a>.</p><div class="figure"><a id="communication_failure_with_dynamips"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00162"/><img src="httpatomoreillycomsourcenostarchimages2209193.png.jpg" alt="Communication failure with Dynamips"/></div></div><p class="title">Figure A-1. Communication failure with Dynamips</p></div><p>This message may indicate that you’re running software in your PC that conflicts with Dynamips, that you have an unstable Dynamips build, or that you don’t have enough free PC resources, such as memory or CPU cycles. Try closing any nonessential applications, rebooting your PC, disabling all antivirus/antispam software, and disabling your firewall. If Dynamips continues to crash, you may have to re-install or restore Dynamips or GNS3 from a backup.</p></div><div class="sect2" title="When IOS Images Fail to Load"><div class="titlepage"><div><div><h2 class="title"><a id="when_ios_images_fail_to_load"/>When IOS Images Fail to Load</h2></div></div></div><p>Router memory is a common problem that can cause Dynamips routers to misbehave. When a router refuses to start, check the Cisco RAM requirements for the exact version of the IOS image you’re using—you may have assigned it too much memory or not enough. To verify the requirements, <a id="iddle1143" class="indexterm"/><a id="iddle1245" class="indexterm"/><a id="iddle1571" class="indexterm"/><a id="iddle1885" class="indexterm"/><a id="iddle2114" class="indexterm"/>visit the Cisco Feature Navigator website; browse to <span class="emphasis"><em><a class="ulink" href="http://tools.cisco.com/ITDIT/CFN/jsp/index.jsp">http://tools.cisco.com/ITDIT/CFN/jsp/index.jsp</a></em></span>. From here, you can use the Search by Software feature to enter the details of your IOS, and the navigator will provide you with the requirements.</p><p>If the RAM setting of an IOS router is set too low, the router may either fail to start or crash upon starting, and the GNS3 Console window may display an error message, like the one shown in <a class="xref" href="apa.html#failed_to_load_cisco_ios_image_error_mes" title="Figure A-2. Failed to load Cisco IOS image error message">Figure A-2</a>.</p><div class="figure"><a id="failed_to_load_cisco_ios_image_error_mes"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00163"/><img src="httpatomoreillycomsourcenostarchimages2209195.png.jpg" alt="Failed to load Cisco IOS image error message"/></div></div><p class="title">Figure A-2. Failed to load Cisco IOS image error message</p></div><p>In this case, you should reconfigure the router and assign it more memory. Right-click the router and select <span class="strong"><strong>Configure</strong></span> to bring up the GNS3 Node Configurator. Choose your router name from the pane on the left and click the <span class="strong"><strong>Memories and disks</strong></span> tab to display the RAM setting.</p><p>If you increase the memory and the router still refuses to start, you may have a corrupted IOS image file and should try a different one.</p><p>When you have a corrupt IOS image file, it may not display any error messages in the GNS3 Console window. Instead, the router console may be unresponsive or display information that may provide a clue about the problem, as in <a class="xref" href="apa.html#ios_image_fails_to_load" title="Figure A-3. IOS image fails to load">Figure A-3</a>.</p><div class="figure"><a id="ios_image_fails_to_load"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00164"/><img src="httpatomoreillycomsourcenostarchimages2209197.png.jpg" alt="IOS image fails to load"/></div></div><p class="title">Figure A-3. IOS image fails to load</p></div><p><a id="iddle1591" class="indexterm"/><a id="iddle1792" class="indexterm"/><a id="iddle2086" class="indexterm"/><a id="iddle2249" class="indexterm"/>The console output shows that IOS is flinging exception errors at an alarming rate. This can indicate that the IOS image file is corrupt or that it’s been misconfigured in GNS3. Verify and correct the image settings using the Cisco Feature Navigator or replace the image file if necessary.</p></div><div class="sect2" title="Resolving IOS Memory Errors"><div class="titlepage"><div><div><h2 class="title"><a id="resolving_ios_memory_errors"/>Resolving IOS Memory Errors</h2></div></div></div><p>Adding too much memory to a Dynamips router can prevent a router from booting properly. For instance, the maximum RAM handled by a c7200 with NPE-400 is 512MB. If you add more, say 1024MB, you may see an error message in the GNS3 Console window or the following message displayed in the router console:</p><a id="pro_id00173"/><pre class="programlisting">Cisco IOS Software, 7200 Software (C7200-ADVENTERPRISEK9-M), Version 15.2(4)
S2, RELEASE SOFTWARE (fc1)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2012 by Cisco Systems, Inc.
Compiled Tue 11-Dec-12 13:32 by prod_rel_team

!!! WARNING - VM is not running, will be unresponsive (status=1) !!!</pre><p>The router console message, <code class="literal">!!! WARNING - VM is not running, will be unresponsive (status=1) !!!</code>, is a clear indication that this router has crashed on startup. In this case, stop the device and check its configuration. The issue indicated here is that the device has been assigned too much memory. To correct the problem, reduce the amount of memory assigned to the device or replace the IOS image file with a different version.</p><p>Even when a router appears to run properly, you may encounter errors while configuring IOS. Here is an interesting situation where a router boots successfully even though it’s low on memory but displays error messages while being configured:</p><a id="pro_id00174"/><pre class="programlisting">R1(config-if)#<span class="strong"><strong>ip nat inside</strong></span>
% NBAR ERROR: parsing stopped
% NBAR Error : Activation failed due to insufficient dynamic memory
% NBAR Error: Stile could not add protocol node
%NAT: Error activating CNBAR on the interface Vlan1
R1(config-if)#
*Mar 1 00:00:57.127: %LINEPROTO-5-UPDOWN: Line protocol on Interface NVI0,
changed state to up
*Mar 1 00:00:57.251: %SYS-2-MALLOCFAIL: Memory allocation of 10260 bytes
failed from 0x62915CD4, alignment 0
Pool: Processor Free: 18968 Cause: Memory fragmentation
Alternate Pool: None Free: 0 Cause: No Alternate pool
 -Process= "Exec", ipl= 0, pid= 195, -Traceback= 0x6148BFF8 0x60016604
0x6001C564 0x6001CBBC 0x636756E4 0x62915CDC 0x628F468C 0x628F88C4 0x628F5968
0x628F87A0 0x628F5968 0x628F8344 0x628F5968 0x628F5B2C 0x62928FBC 0x62933A20
R1(config-if)#
*Mar 1 00:00:57.275: %NBAR-2-NOMEMORY: No memory available for StILE lmalloc,
-Traceback= 0x6148BFF8 0x62915CF8 0x628F468C 0x628F88C4 0x628F5968 0x628F87A0
0x628F5968 0x628F8344 0x628F5968 0x628F5B2C 0x62928FBC 0x62933A20 0x62920BD0
0x6293DF70 0x6293E2F0 0x61C77C70
R1(config-if)#</pre><p><a id="iddle1262" class="indexterm"/><a id="iddle1264" class="indexterm"/><a id="iddle1294" class="indexterm"/><a id="iddle1326" class="indexterm"/><a id="iddle1714" class="indexterm"/><a id="iddle1748" class="indexterm"/><a id="iddle1815" class="indexterm"/><a id="iddle1866" class="indexterm"/><a id="iddle1924" class="indexterm"/><a id="iddle1952" class="indexterm"/><a id="iddle2102" class="indexterm"/><a id="iddle2130" class="indexterm"/><a id="iddle2251" class="indexterm"/><a id="iddle2272" class="indexterm"/>In this example, router R1 was running fine until I attempted to configure network address translation. Because this router is low on memory, Cisco IOS immediately displays memory allocation error messages. Assigning more memory to the router in GNS3 should correct the problem.</p></div><div class="sect2" title="Resolving NIO Errors"><div class="titlepage"><div><div><h2 class="title"><a id="resolving_nio_errors"/>Resolving NIO Errors</h2></div></div></div><p>NIO errors occur most often when you’re attempting to link a GNS3 device to a physical Ethernet adapter in your PC using the Cloud node. If you’re having trouble linking devices to each other or to a Cloud node or if you receive an NIO error message like the one shown in <a class="xref" href="apa.html#unable_to_create_generic_ethernet_nio_er" title="Figure A-4. Unable to create generic Ethernet NIO error message">Figure A-4</a>, you may have a permissions problem.</p><div class="figure"><a id="unable_to_create_generic_ethernet_nio_er"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00165"/><img src="httpatomoreillycomsourcenostarchimages2209199.png.jpg" alt="Unable to create generic Ethernet NIO error message"/></div></div><p class="title">Figure A-4. Unable to create generic Ethernet NIO error message</p></div><p>In this case, you may need to assign yourself elevated privileges. If you’re running GNS3 on Windows, launch GNS3 using the administrator account: right-click the GNS3 icon, and select <span class="strong"><strong>Run as Administrator</strong></span>. If you’re using OS X, you may need to assign ownership permissions to the <span class="emphasis"><em>/dev/tap</em></span> or <span class="emphasis"><em>/dev/bpf</em></span> device files, as in the following example:</p><a id="pro_id00175"/><pre class="programlisting">$ <span class="strong"><strong>sudo chown $(id -un):$(id -gn) /dev/bpf*</strong></span>
$ <span class="strong"><strong>sudo chown $(id -un):$(id -gn) /dev/tap*</strong></span></pre><p>These commands will assign the currently logged-in user’s user ID to the device files, allowing your user account to use the files while running GNS3. You will have to set these permissions each time you reboot your Mac because OS X resets all device file permissions at startup.</p><p>For a high degree of security, use the <code class="literal">setcap</code> command to elevate the capabilities of the <span class="emphasis"><em>dynamips</em></span> file. On Ubuntu, you may need to install libcap2 before entering the <code class="literal">setcap</code> command.</p><a id="pro_id00176"/><pre class="programlisting">$ <span class="strong"><strong>sudo apt-get install libcap2</strong></span>
$ <span class="strong"><strong>sudo setcap cap_net_raw,cap_net_admin+eip /usr/local/bin/dynamips</strong></span></pre><div class="sidebar"><a id="linux_security_considerations"/><p class="title">Linux Security Considerations</p><p><a id="iddle1113" class="indexterm"/><a id="iddle1114" class="indexterm"/><a id="iddle1241" class="indexterm"/><a id="iddle1355" class="indexterm"/><a id="iddle1626" class="indexterm"/><a id="iddle1643" class="indexterm"/><a id="iddle1816" class="indexterm"/><a id="iddle2063" class="indexterm"/><a id="iddle2131" class="indexterm"/><a id="iddle2241" class="indexterm"/>If you’re running Linux, you may need to run Dynamips with elevated permissions. For this, there are two methods to choose from depending on your Linux distribution.</p><p>You can use the Linux <code class="literal">chown</code> and <code class="literal">chmod</code> commands, or you can use the <code class="literal">setcap</code> command. Both methods should resolve a permissions issue, but the <code class="literal">chmod</code>/<code class="literal">chown</code> method is less secure because it gives the Dynamips application the ability to run with full root-level permissions. If malicious code were to get into Dynamips, your entire Linux security could be compromised. The Linux <code class="literal">setcap</code> command allows you to assign root-like capabilities to a file, without actually giving the file root-level permissions. This gives Dynamips the permissions it needs, without compromising Linux security by over-subscribing root-level permissions. Therefore, it’s the preferred method to fix GNS3 NIO errors.</p><p>Unfortunately, <code class="literal">setcap</code> is not available across all Linux platforms, but it is supported on Ubuntu and most Debian-based systems.</p></div><p>If you’re unable to use the <code class="literal">setcap</code> command, instead use the <code class="literal">chown</code> and <code class="literal">chmod</code> commands to elevate Dynamips with root-level privileges.</p><a id="pro_id00177"/><pre class="programlisting">$ <span class="strong"><strong>sudo chown root /usr/local/bin/dynamips</strong></span>
$ <span class="strong"><strong>sudo chmod 4755 /usr/local/bin/dynamips</strong></span></pre><p>If you’re unable to connect an IOU device to a physical adapter or a virtual TAP adapter on Linux, try applying the <code class="literal">setcap</code> commands to the iouyap application. This works because iouyap is the GNS3 software that bridges IOU devices to other GNS3 devices, as well as virtual and physical interfaces. Here, you give iouyap the same elevated capabilities that you just gave Dynamips:</p><a id="pro_id00178"/><pre class="programlisting">$ <span class="strong"><strong>sudo setcap cap_net_raw,cap_net_admin+eip /usr/local/bin/iouyap</strong></span></pre><p>Another possible NIO problem is the method you choose for connecting GNS3 to your physical Ethernet adapter. This is especially true on Windows PCs. If you’re using Windows 7, when attempting to connect GNS3 to the Internet, create a bridge using your physical Ethernet adapter and a loopback adapter (described in <a class="xref" href="ch07.html#connecting_gns3_devices_to_the_internet" title="Connecting GNS3 Devices to the Internet">Connecting GNS3 Devices to the Internet</a>). If you’re running Windows 8, you may get better results if you connect the Cloud node directly to your physical Ethernet adapter or use Internet Connection Sharing.</p></div><div class="sect2" title="Correcting Console Problems"><div class="titlepage"><div><div><h2 class="title"><a id="correcting_console_problems"/>Correcting Console Problems</h2></div></div></div><p>Console problems could prevent a console from opening, cause it to open and immediately close, or cause it to act sluggish or unresponsive when configuring a device. There are a number of reasons why a console connection <a id="iddle1317" class="indexterm"/><a id="iddle1467" class="indexterm"/><a id="iddle1469" class="indexterm"/><a id="iddle1473" class="indexterm"/><a id="iddle1790" class="indexterm"/><a id="iddle2012" class="indexterm"/><a id="iddle2073" class="indexterm"/><a id="iddle2210" class="indexterm"/><a id="iddle2330" class="indexterm"/><a id="iddle2350" class="indexterm"/>might misbehave. Most often the problem occurs because of improperly configured settings in GNS3, such as QEMU device settings or VirtualBox settings, but it could also be a problem with a device image, such as a corrupt IOU or ASA image file.</p><p>When a console won’t open, first check the GNS3 Console Application preference. Open <span class="strong"><strong>Preferences</strong></span>, select <span class="strong"><strong>General</strong></span> from the pane on the left, click the <span class="strong"><strong>Console Applications</strong></span> tab, and make sure the terminal type listed under Preconfigured terminal commands matches your operating system’s terminal program. If not, use the drop-down menu to select your terminal; then click <span class="strong"><strong>Set, Apply</strong></span>, and <span class="strong"><strong>OK</strong></span> to save the configuration.</p><p>If you find that you are immediately disconnected after you open a console, then your firewall may be blocking the network connection from the console application to your GNS3 device. If the device is a QEMU device, the problem is often related to the QEMU virtual machine itself or its configuration. First, verify that you’ve assigned the correct amount of memory to the QEMU virtual machine. You can visit the GNS3 Jungle forums or a third-party vendor website to verify the requirements for the device. If the memory allocation is correct and the problem persists, check the QEMU virtual machine device properties. Go to <span class="strong"><strong>Preferences</strong></span> and select <span class="strong"><strong>QEMU VMs</strong></span> from the pane on the left. Select your QEMU device from the list, click <span class="strong"><strong>Edit</strong></span>, and click the <span class="strong"><strong>Advanced settings</strong></span> tab. Verify that the options under Additional Settings are correct. If they’re not, fix the entry and try again.</p><p>Similarly, you can troubleshoot your VirtualBox virtual machines by examining the virtual machine’s settings. Go to <span class="strong"><strong>Preferences</strong></span> and select <span class="strong"><strong>VirtualBox VMs</strong></span> from the pane on the left. Select your VirtualBox device from the list, click <span class="strong"><strong>Edit</strong></span>, and click the <span class="strong"><strong>General settings</strong></span> tab. Verify the Enable Remote Console and Start VM in Headless Mode options are configured correctly for your VirtualBox virtual machine.</p><p>If your console is sluggish when you start a Dynamips router, the router may not have been assigned an optimal Idle-PC value. A poorly chosen Idle-PC value can be just as devastating on your CPU as having no value set at all. To verify or set your Idle-PC value, right-click the router, select <span class="strong"><strong>Configure</strong></span> to open the Node Configurator, and check your Idle-PC value on the <span class="strong"><strong>Advanced</strong></span> tab. If the router has been assigned an Idle-PC value and the device is consuming a lot of CPU, then you may need to recalculate the value. (See <a class="xref" href="ch03.html#setting_a_manual_idle-pc_value" title="Setting a Manual Idle-PC Value">Setting a Manual Idle-PC Value</a>.)</p><p>Your console may also be sluggish if you’ve changed any of the Dynamips advanced optimization settings, such as Idlemax or Idlesleep. Idlemax and Idlesleep are used in conjunction with the Idle-PC value; Idlemax determines how often to sleep while executing idle loops in the router code, and the Idlesleep value determines how long to sleep. Try resetting them to their default values by clicking the <span class="strong"><strong>Reset</strong></span> button, as shown in <a class="xref" href="apa.html#advanced_router_configuration" title="Figure A-5. Advanced router configuration">Figure A-5</a>.</p><p>The GNS3 development team has determined that the default values of Idlemax and Idlesleep are optimal for most users, but you may be able to squeeze out a little better CPU performance by altering them as described in <a class="xref" href="apa.html#conserving_resources" title="Conserving Resources">Conserving Resources</a>.</p><div class="figure"><a id="advanced_router_configuration"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00166"/><img src="httpatomoreillycomsourcenostarchimages2209201.png.jpg" alt="Advanced router configuration"/></div></div><p class="title">Figure A-5. Advanced router configuration</p></div><p><a id="iddle1221" class="indexterm"/><a id="iddle1376" class="indexterm"/><a id="iddle1611" class="indexterm"/><a id="iddle2240" class="indexterm"/><a id="iddle2245" class="indexterm"/><a id="iddle2331" class="indexterm"/>If the sluggish console is an IOU device and you’re using the IOU virtual machine (required for Windows and OS X), try assigning more memory to the IOU virtual machine in VirtualBox.</p></div></div><div class="sect1" title="Feature Problems"><div class="titlepage"><div><div><h1 class="title"><a id="feature_problems"/>Feature Problems</h1></div></div></div><p>Feature problems occur when you try to implement a feature of GNS3 that you haven’t used before, and they usually result from some sort of user error. GNS3 has a lot of features and options, and projects can get complicated rather quickly, particularly when you run GNS3 using multiple PCs or when you add QEMU and VirtualBox virtual machines to your projects. Feature problems may also lie within the configuration of your devices.</p><div class="sect2" title="Configuration Issues"><div class="titlepage"><div><div><h2 class="title"><a id="configuration_issues"/>Configuration Issues</h2></div></div></div><p>If you’re experiencing a network routing problem inside a project, it may be that you’ve made a mistake configuring your device’s network operating system; after all, GNS3 is a learning tool, and you’re going to make mistakes along the way. When configuring features using operating systems such as Arista, IOS, and Junos OS, it’s easy to make a mistake that could break your network. Check your device configurations and make sure you haven’t assigned the wrong subnet mask to an IP address or forgotten to bring up <a id="iddle1057" class="indexterm"/><a id="iddle1223" class="indexterm"/><a id="iddle1372" class="indexterm"/><a id="iddle1400" class="indexterm"/><a id="iddle1429" class="indexterm"/><a id="iddle1510" class="indexterm"/><a id="iddle1577" class="indexterm"/><a id="iddle2246" class="indexterm"/><a id="iddle2257" class="indexterm"/><a id="iddle2286" class="indexterm"/>an interface. One way to prevent these sorts of problems is to configure your GNS3 project devices just as you would an actual network. Start with a few devices, configure and test them, and then keep adding and testing devices until you’ve created a fully functional project.</p></div><div class="sect2" title="Using Unsupported IOS Images"><div class="titlepage"><div><div><h2 class="title"><a id="using_unsupported_ios_images"/>Using Unsupported IOS Images</h2></div></div></div><p>In short, don’t try to use unsupported images. Dynamips supports a limited number of Cisco routers (see <a class="xref" href="apb.html" title="Appendix B. Cisco Hardware Compatible with GNS3">Appendix B</a> for a complete list). If you see an unsupported image error, as shown in <a class="xref" href="apa.html#unsupported_ios_image_error" title="Figure A-6. Unsupported IOS image error">Figure A-6</a>, when attempting to install an image file, it’s because the image file is not supported by GNS3.</p><div class="figure"><a id="unsupported_ios_image_error"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00167"/><img src="httpatomoreillycomsourcenostarchimages2209203.png.jpg" alt="Unsupported IOS image error"/></div></div><p class="title">Figure A-6. Unsupported IOS image error</p></div><p>In <a class="xref" href="apa.html#unsupported_ios_image_error" title="Figure A-6. Unsupported IOS image error">Figure A-6</a>, I tried to use an image file from a Cisco c850 router platform not supported by GNS3. The only option when you see this error message is to discard the file and replace it with one that is supported by GNS3.</p></div></div><div class="sect1" title="The Nuclear Option"><div class="titlepage"><div><div><h1 class="title"><a id="nuclear_option"/>The Nuclear Option</h1></div></div></div><p>If you continue to encounter problems with GNS3 after trying the actions discussed so far, you can take the nuclear option as a last resort and clear the GNS3 settings file. Once you nuke the file, you’ll lose all of your GNS3 settings, and you’ll have to reconfigure GNS3 as though it’s a newly installed system.</p><div class="note" title="Note"><h3 class="title"><a id="app01note01"/>Note</h3><p><span class="emphasis"><em>None of your saved projects should be affected by clearing the GNS3 settings file, nor should VirtualBox or QEMU devices in those projects.</em></span></p></div><p>Before you begin, back up your existing configuration file. This will give you the option of returning to the old settings if you need to do so. Go to <span class="strong"><strong>Preferences</strong></span> and choose the <span class="strong"><strong>General</strong></span> preference; then, in the new window select the <span class="strong"><strong>General</strong></span> tab, as shown in <a class="xref" href="apa.html#exporting_and_clearing_the_gns3_configur" title="Figure A-7. Exporting and clearing the GNS3 configuration file">Figure A-7</a>.</p><p>The GNS3 settings file is displayed under Configuration file ➊. To back up the file, click the <span class="strong"><strong>Export</strong></span> ➌ button. Choose a name and a location to save the file. Note the location of the original file (in this example, it’s <span class="emphasis"><em>/home/jneumann/.config/GNS3/gns3_gui.conf</em></span>), and once the export is complete, close GNS3 and delete or rename this original file. Now when you reopen GNS3, all the preferences will be cleared as though you have installed it for the first time. If you decide that clearing the file was a mistake, you can use <span class="strong"><strong>Import</strong></span> ➋ to reinstate the original GNS3 settings file.</p><div class="figure"><a id="exporting_and_clearing_the_gns3_configur"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00168"/><img src="httpatomoreillycomsourcenostarchimages2209205.png.jpg" alt="Exporting and clearing the GNS3 configuration file"/></div></div><p class="title">Figure A-7. Exporting and clearing the GNS3 configuration file</p></div><div class="note" title="Note"><h3 class="title"><a id="app01note02"/>Note</h3><p><a id="iddle1453" class="indexterm"/><a id="iddle1968" class="indexterm"/><a id="iddle2247" class="indexterm"/><a id="iddle2253" class="indexterm"/><span class="emphasis"><em>On rare occasions, the GNS3 settings file can become corrupted. Keep a current backup of your</em></span> GNS3 settings <span class="emphasis"><em>file at all times so you can revert to a working version if needed.</em></span></p></div></div><div class="sect1" title="Overburdened Hardware"><div class="titlepage"><div><div><h1 class="title"><a id="overburdened_hardware"/>Overburdened Hardware</h1></div></div></div><p>When GNS3 is running slow and devices are crashing, it may be a clue that you’re overburdening your PC’s processor with too many devices; this will certainly slow down console response and can cause Dynamips to crash. If that’s the case, consider trimming down your project, upgrading your PC, or using multiple PCs with GNS3. A great way to create large projects without overworking your CPU is to load share your hypervisors across multiple PCs, as described in <a class="xref" href="ch10.html#creating_projects_using_multiple_pcs" title="Creating Projects Using Multiple PCs">Creating Projects Using Multiple PCs</a>.</p></div><div class="sect1" title="Resolving Port Number Conflicts"><div class="titlepage"><div><div><h1 class="title"><a id="resolving_port_number_conflicts"/>Resolving Port Number Conflicts</h1></div></div></div><p>At some point, other software on your computer will probably conflict with GNS3. This often happens when the software is using a port number that GNS3 needs. If the port number used is the same as your GNS3 server application, GNS3 will load, but the server should select another port number.</p><p><a id="iddle1047" class="indexterm"/><a id="iddle1108" class="indexterm"/><a id="iddle1248" class="indexterm"/><a id="iddle1839" class="indexterm"/><a id="iddle2239" class="indexterm"/>When this happens, investigate the problem using the <code class="literal">netstat</code> command, which should be included on both Windows and Unix-based systems such as Linux and OS X.</p><a id="pro_id00179"/><pre class="programlisting">$ <span class="strong"><strong>netstat -an|more</strong></span>

Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State
tcp        0      0 127.0.1.1:53            0.0.0.0:*               LISTEN
tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:8000            0.0.0.0:*               LISTEN
tcp        0      0 127.0.0.1:39191         127.0.0.1:800➊         TIME WAIT
tcp6       0      0 ::1:631                 :::*                    LISTEN
tcp6       1      0 ::1:53974               ::1:631                 CLOSE WAIT
udp        0      0 0.0.0.0:59759           0.0.0.0:*
udp        0      0 0.0.0.0:39309           0.0.0.0:*
udp        0      0 127.0.1.1:53            0.0.0.0:*
udp        0      0 0.0.0.0:68              0.0.0.0:*
udp        0      0 0.0.0.0:631             0.0.0.0:*
udp        0      0 0.0.0.0:5353            0.0.0.0:*
udp6       0      0 :::57463                :::*
udp6       0      0 :::45876                :::*
udp6       0      0 :::5353                 :::*</pre><p>TCP port number 8000 ➊ is the default port number reserved for the GNS3 server program, but the <code class="literal">netstat</code> output shows that another application is using this port. To solve this problem, find the offending application and close it or change the default port number used by GNS3. To change the port number, go to <span class="strong"><strong>Preferences</strong></span> ▸ <span class="strong"><strong>Servers</strong></span> ▸ <span class="strong"><strong>Local Server Port</strong></span> and set the port number to something other than 8000, such as 8001.</p></div><div class="sect1" title="Troubleshooting an ASA"><div class="titlepage"><div><div><h1 class="title"><a id="troubleshooting_an_asa"/>Troubleshooting an ASA</h1></div></div></div><p>When you install an ASA in GNS3, make sure you select <span class="strong"><strong>ASA 8.4(2)</strong></span> from the <span class="strong"><strong>Type</strong></span> drop-down menu during the installation wizard. The GNS3 wizard should then autofill the required fields with the correct information.</p><p>If your ASA is configured correctly but it locks up or runs poorly, the ASA may be causing high CPU usage, which in turn causes your PC’s overall performance to suffer. You can greatly reduce the CPU usage by adjusting the CPU limit percentage for your ASA. Go to <span class="strong"><strong>Preferences</strong></span>, select your ASA, click <span class="strong"><strong>Edit</strong></span>, and enable <span class="strong"><strong>CPU throttling</strong></span>. Be careful, though, because limiting the ASA CPU usage too much can also cause an ASA to become unresponsive. For the best results, try adjusting the setting until you find a sweet spot that reduces CPU usage without negatively impacting performance.</p></div><div class="sect1" title="Conserving Resources"><div class="titlepage"><div><div><h1 class="title"><a id="conserving_resources"/>Conserving Resources</h1></div></div></div><p><a id="iddle1059" class="indexterm"/><a id="iddle1231" class="indexterm"/><a id="iddle1280" class="indexterm"/><a id="iddle1468" class="indexterm"/><a id="iddle1781" class="indexterm"/><a id="iddle1991" class="indexterm"/><a id="iddle2041" class="indexterm"/><a id="iddle2059" class="indexterm"/>On the whole, GNS3 does a good job of handling projects of almost any size, provided you have the proper hardware resources, but the larger your project becomes, the more likely you are to encounter problems. The best way to avoid these problems is to take a minimalist approach when creating a project and avoid adding unnecessary complexity to your designs.</p><div class="sect2" title="Select Devices Carefully"><div class="titlepage"><div><div><h2 class="title"><a id="select_devices_carefully"/>Select Devices Carefully</h2></div></div></div><p>In GNS3, always choose devices that use the least amount of RAM and CPU consumption. For example, avoid using a c7200 router, which requires 512MB of RAM, if you can get by using a c3700 router that uses only 128MB. When using Dynamips devices, use the same device model for all routers in your project; GNS3 can then share resources between them. Using several different router models can lead to resource consumption and poor performance. You can also use emulated devices, such as the Ethernet switch node rather than an EtherSwitch router, to conserve both memory and processor.</p></div><div class="sect2" title="Optimize Idle-PC Values"><div class="titlepage"><div><div><h2 class="title"><a id="optimize_idle-pc_values"/>Optimize Idle-PC Values</h2></div></div></div><p>To reduce system resource usage, fine-tune your Idle-PC values. Your current values may be fine when you’re running a small number of IOS devices, but larger projects will benefit from more optimized values.</p><p>To find the best values for you, first put your computer in a mostly idle state: restart it and close all programs, including antivirus software. If you’re using Windows, close as many applications from the system tray as you can. When you’re ready, add a router to your workspace, start it, right-click the router, and choose <span class="strong"><strong>Idle-PC</strong></span> to begin calculating Idle-PC values. During the process, carefully monitor your CPU after applying each new value, and record all the values. Look for the one that uses the least resources, and when you find it, apply it to the device.</p></div></div><div class="sect1" title="Backing Up Your Projects"><div class="titlepage"><div><div><h1 class="title"><a id="backing_up_your_projects"/>Backing Up Your Projects</h1></div></div></div><p>Backing up your GNS3 projects is important, especially as they grow more complex and take more time to create. No one likes to lose the work they’ve spent hours creating! You can either back up the entire GNS3 folder, back up your projects folder, or back up individual project folders.</p><p>Regularly backing up the entire GNS3 folder is the best way to ensure you always have a current copy of all projects and images, but it can be time-consuming and may require a fair amount of disk space.</p><p>If you’re short on time or resources, at least back up individual projects from the projects folder. Make sure you still have a backup copy of your entire GNS3 folder and then update the full GNS3 backup by copying individual projects to the backup as needed. The disadvantage to this approach is that it relies on you remembering to copy new or updated projects every <a id="iddle1196" class="indexterm"/><a id="iddle1412" class="indexterm"/><a id="iddle1424" class="indexterm"/><a id="iddle1426" class="indexterm"/><a id="iddle2151" class="indexterm"/><a id="iddle2255" class="indexterm"/>time you update your backup, and you may forget to back up an important project. I know from experience that discovering you’ve just lost all the work that you put into a complex project can be a sobering revelation.</p><p>I suggest a complete backup strategy, as well as backing up individual projects as you create them. You could create large projects in phases and test each component along the way and, once you have a group of components working properly, back up the project. Then, repeat this procedure until the project is fully configured and your network is functional. Employing GNS3 snapshots while creating complex projects can also be helpful: if you make a mistake, just revert to a working state by restoring a snapshot (refer to <a class="xref" href="ch04.html#using_the_gns3_toolbar" title="Using the GNS3 Toolbar">Using the GNS3 Toolbar</a>). But no matter which backup strategy you choose, the simplest way to store your backup project files is by copying the entire project folder to a large thumb drive or external hard disk.</p></div><div class="sect1" title="Welcome to the Jungle"><div class="titlepage"><div><div><h1 class="title"><a id="welcome_to_the_jungle"/>Welcome to the Jungle</h1></div></div></div><p>When a problem is too great for you to figure out on your own, don’t be afraid to ask for help. The GNS3 website (<span class="emphasis"><em><a class="ulink" href="http://www.gns3.com/">http://www.gns3.com/</a></em></span>) provides a plethora of information and houses a dedicated forum, called the <span class="emphasis"><em>GNS3 Jungle</em></span>. Here you can report problems, ask questions, and help other users with their questions. To access the GNS3 Jungle, go to the GNS3 site and select <span class="strong"><strong>Community</strong></span>.</p><p>Before posting a question, search the site to see whether your question has already been asked and answered. The GNS3 Jungle has an extremely active member base, so questions generally receive quick responses. If you do post a question and it doesn’t receive an answer as quickly as you’d like, please don’t repost it or reply to your own post to bump it up the list. Posting the same question multiple times will only confuse the people trying to help. Usually when a question goes unanswered, it’s because no one currently viewing the forum has the answer. Be patient, and someone should respond in due time.</p><p>When asking a question, I recommend providing the following information:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>GNS3 version</p></li><li class="listitem"><p>Name and version of your operating system</p></li><li class="listitem"><p>Platform specifics (32-bit or 64-bit, processor, and RAM)</p></li><li class="listitem"><p>A clear description of the problem</p></li><li class="listitem"><p>A screenshot of error messages (if applicable)</p></li><li class="listitem"><p>A screenshot of preference settings (if applicable)</p></li><li class="listitem"><p>Topology (if applicable)</p></li><li class="listitem"><p>Device configurations (if applicable)</p></li></ul></div><p>Detailed information helps your fellow GNS3 users determine your problem and return a solution more quickly.</p></div><div class="sect1" title="Final Thoughts"><div class="titlepage"><div><div><h1 class="title"><a id="final_thoughts-id00022"/>Final Thoughts</h1></div></div></div><p>Although GNS3 generally runs well, problems do crop up from time to time. In this appendix, you looked at some common problems and basic troubleshooting strategies for correcting those problems.</p><p>You learned that firewalls, antivirus software, and occasionally a TCP/IP-based application can wreak havoc on GNS3. When in doubt, disable your firewall, disable your antivirus software, and close any unnecessary programs before launching GNS3.</p><p>You also learned that often the fastest way to fix a broken project is to restore the project from a backup. You should always keep a current backup copy of the entire GNS3 folder and your GNS3 settings file. Restoring data from a backup is the surest way to get up and running after a disaster.</p></div></div></body></html>