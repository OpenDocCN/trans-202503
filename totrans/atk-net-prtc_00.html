<html><head></head><body>
<h2 class="h2a" id="ch00"><span epub:type="pagebreak" id="page_xxi"/><strong>INTRODUCTION</strong></h2>&#13;
<p class="noindent_first">When first introduced, the technology that allowed devices to connect to a network was exclusive to large companies and governments. Today, most people carry a fully networked computing device in their pocket, and with the rise of the Internet of Things (IoT), you can add devices such as your fridge and our home’s security system to this interconnected world. The security of these connected devices is therefore increasingly important. Although you might not be too concerned about someone disclosing the details of how many yogurts you buy, if your smartphone is compromised over the same network as your fridge, you could lose all your personal and financial information to a malicious attacker.</p>&#13;
<p class="indent">This book is named <em>Attacking Network Protocols</em> because to find security vulnerabilities in a network-connected device, you need to adopt the mind-set of the attacker who wants to exploit those weaknesses. Network protocols communicate with other devices on a network, and because these <span epub:type="pagebreak" id="page_xxii"/>protocols must be exposed to a public network and often don’t undergo the same level of scrutiny as other components of a device, they’re an obvious attack target.</p>&#13;
<h3 class="h3" id="ch00lev1sec2"><strong>Why Read This Book?</strong></h3>&#13;
<p class="noindent">Many books discuss network traffic capture for the purposes of diagnostics and basic network analysis, but they don’t focus on the security aspects of the protocols they capture. What makes this book different is that it focuses on analyzing custom protocols to find security vulnerabilities.</p>&#13;
<p class="indent">This book is for those who are interested in analyzing and attacking network protocols but don’t know where to start. The chapters will guide you through learning techniques to capture network traffic, performing analysis of the protocols, and discovering and exploiting security vulnerabilities. The book provides background information on networking and network security, as well as practical examples of protocols to analyze.</p>&#13;
<p class="indent">Whether you want to attack network protocols to report security vulnerabilities to an application’s vendor or just want to know how your latest IoT device communicates, you’ll find several topics of interest.</p>&#13;
<h3 class="h3" id="ch00lev1sec3"><strong>What’s in This Book?</strong></h3>&#13;
<p class="noindent">This book contains a mix of theoretical and practical chapters. For the practical chapters, I’ve developed and made available a networking library called Canape Core, which you can use to build your own tools for protocol analysis and exploitation. I’ve also provided an example networked application called <em>SuperFunkyChat</em>, which implements a user-to-user chat protocol. By following the discussions in the chapters, you can use the example application to learn the skills of protocol analysis and attack the sample network protocols. Here is a brief breakdown of each chapter:</p>&#13;
<p class="noindentt"><strong><a href="../Text/ch01.xhtml#ch01">Chapter 1: The Basics of Networking</a></strong></p>&#13;
<p class="hang2">This chapter describes the basics of computer networking with a particular focus on TCP/IP, which forms the basis of application-level network protocols. Subsequent chapters assume that you have a good grasp of the network basics. This chapter also introduces the approach I use to model application protocols. The model breaks down the application protocol into flexible layers and abstracts complex technical detail, allowing you to focus on the bespoke parts of the protocol you’re analyzing.</p>&#13;
<p class="noindentt"><strong><a href="../Text/ch02.xhtml#ch02">Chapter 2: Capturing Application Traffic</a></strong></p>&#13;
<p class="hang2">This chapter introduces the concepts of passive and active capture of network traffic, and it’s the first chapter to use the Canape Core network libraries for practical tasks.</p>&#13;
<p class="noindentt"><span epub:type="pagebreak" id="page_xxiii"/><strong><a href="../Text/ch03.xhtml#ch03">Chapter 3: Network Protocol Structures</a></strong></p>&#13;
<p class="hang2">This chapter contains details of the internal structures that are common across network protocols, such as the representation of numbers or human-readable text. When you’re analyzing captured network traffic, you can use this knowledge to quickly identify common structures, speeding up your analysis.</p>&#13;
<p class="noindentt"><strong><a href="../Text/ch04.xhtml#ch04">Chapter 4: Advanced Application Traffic Capture</a></strong></p>&#13;
<p class="hang2">This chapter explores a number of more advanced capture techniques that complement the examples in <a href="../Text/ch02.xhtml#ch02">Chapter 2</a>. The advanced capture techniques include configuring Network Address Translation to redirect traffic of interest and spoofing the address resolution protocol.</p>&#13;
<p class="noindentt"><strong><a href="../Text/ch05.xhtml#ch05">Chapter 5: Analysis from the Wire</a></strong></p>&#13;
<p class="hang2">This chapter introduces methods for analyzing captured network traffic using the passive and active techniques described in <a href="../Text/ch02.xhtml#ch02">Chapter 2</a>. In this chapter, we begin using the <em>SuperFunkyChat</em> application to generate example traffic.</p>&#13;
<p class="noindentt"><strong><a href="../Text/ch06.xhtml#ch06">Chapter 6: Application Reverse Engineering</a></strong></p>&#13;
<p class="hang2">This chapter describes techniques for reverse engineering network-connected programs. Reverse engineering allows you to analyze a protocol without needing to capture example traffic. These methods also help to identify how custom encryption or obfuscation is implemented so you can better analyze traffic you’ve captured.</p>&#13;
<p class="noindentt"><strong><a href="../Text/ch07.xhtml#ch07">Chapter 7: Network Protocol Security</a></strong></p>&#13;
<p class="hang2">This chapter provides background information on techniques and cryptographic algorithms used to secure network protocols. Protecting the contents of network traffic from disclosure or tampering as it travels over public networks is of the utmost importance for network protocol security.</p>&#13;
<p class="noindentt"><strong><a href="../Text/ch08.xhtml#ch08">Chapter 8: Implementing the Network Protocol</a></strong></p>&#13;
<p class="hang2">This chapter explains techniques for implementing the application network protocol in your own code so you can test the protocol’s behavior to find security weaknesses.</p>&#13;
<p class="noindentt"><strong><a href="../Text/ch09.xhtml#ch09">Chapter 9: The Root Causes of Vulnerabilities</a></strong></p>&#13;
<p class="hang2">This chapter describes common security vulnerabilities you’ll encounter in a network protocol. When you understand the root causes of vulnerabilities, you can more easily identify them during analysis.</p>&#13;
<p class="noindentt"><strong><a href="../Text/ch10.xhtml#ch10">Chapter 10: Finding and Exploiting Security Vulnerabilities</a></strong></p>&#13;
<p class="hang2">This chapter describes processes for finding security vulnerabilities based on the root causes in <a href="../Text/ch09.xhtml#ch09">Chapter 9</a> and demonstrates a number of ways of exploiting them, including developing your own shell code and bypassing exploit mitigations through return-oriented programming.</p>&#13;
<p class="noindentt"><span epub:type="pagebreak" id="page_xxiv"/><strong><a href="../Text/app01.xhtml#app01">Appendix: Network Protocol Analysis Toolkit</a></strong></p>&#13;
<p class="hang2">In the appendix, you’ll find descriptions of some of the tools I commonly use when performing network protocol analysis. Many of the tools are described briefly in the main body of the text as well.</p>&#13;
<h3 class="h3" id="ch00lev1sec4"><strong>How to Use This Book</strong></h3>&#13;
<p class="noindent">If you want to start with a refresher on the basics of networking, read <a href="../Text/ch01.xhtml#ch01">Chapter 1</a> first. When you’re familiar with the basics, proceed to <a href="../Text/ch02.xhtml#ch02">Chapters 2</a>, <a href="../Text/ch03.xhtml#ch03">3</a>, and <a href="../Text/ch05.xhtml#ch05">5</a> for practical experience in capturing network traffic and learning the network protocol analysis process.</p>&#13;
<p class="indent">With the knowledge of the principles of network traffic capture and analysis, you can then move on to <a href="../Text/ch07.xhtml#ch07">Chapters 7</a> through <a href="../Text/ch10.xhtml#ch10">10</a> for practical information on how to find and exploit security vulnerabilities in these protocols. <a href="../Text/ch04.xhtml#ch04">Chapters 4</a> and <a href="../Text/ch06.xhtml#ch06">6</a> contain more advanced information about additional capture techniques and application reverse engineering, so you can read them after you’ve read the other chapters if you prefer.</p>&#13;
<p class="indent">For the practical examples, you’ll need to install .NET Core (<em><a href="https://www.microsoft.com/net/core/">https://www.microsoft.com/net/core/</a></em>), which is a cross-platform version of the .NET runtime from Microsoft that works on Windows, Linux, and macOS. You can then download releases for Canape Core from <em><a href="https://github.com/tyranid/CANAPE.Core/releases/">https://github.com/tyranid/CANAPE.Core/releases/</a></em> and <em>SuperFunkyChat</em> from <em><a href="https://github.com/tyranid/ExampleChatApplication/releases/">https://github.com/tyranid/ExampleChatApplication/releases/</a></em>; both use .NET Core as the runtime. Links to each site are available with the book’s resources at <em><a href="https://www.nostarch.com/networkprotocols/">https://www.nostarch.com/networkprotocols/</a></em>.</p>&#13;
<p class="indent">To execute the example Canape Core scripts, you’ll need to use the <em>CANAPE.Cli</em> application, which will be in the release package downloaded from the Canape Core Github repository. Execute the script with the following command line, replacing <code><span class="codeitalic">script.csx</code></span> with the name of the script you want to execute.</p>&#13;
<pre>dotnet exec CANAPE.Cli.dll <code><span class="codeitalic">script.csx</code></span></pre>&#13;
<p class="indent">All example listings for the practical chapters as well as packet captures are available on the book’s page at <em><a href="https://www.nostarch.com/networkprotocols/">https://www.nostarch.com/networkprotocols/</a></em>. It’s best to download these example listings before you begin so you can follow the practical chapters without having to enter a large amount of source code manually.</p>&#13;
<h3 class="h3" id="ch00lev1sec5"><strong>Contact Me</strong></h3>&#13;
<p class="noindent">I’m always interested in receiving feedback, both positive and negative, on my work, and this book is no exception. You can email me at <em><a href="mailto:attacking.network.protocols@gmail.com">attacking.network.protocols@gmail.com</a>.</em> You can also follow me on Twitter <em>@tiraniddo</em> or subscribe to my blog at <em><a href="https://tyranidslair.blogspot.com/">https://tyranidslair.blogspot.com/</a></em> where I post some of my latest advanced security research.</p>&#13;
</body></html>