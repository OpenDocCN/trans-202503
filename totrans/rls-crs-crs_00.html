<html><head></head><body><div class="preface" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="introduction"/>Introduction</h1></div></div></div><p>The Ruby on Rails framework emphasizes developer productivity, making it possible to
      implement sites that would once have taken months to build in a matter of weeks—or even
      days! Thanks to the Ruby programming language and principles such as <span class="emphasis"><em>convention over
        configuration</em></span> and <span class="emphasis"><em>don’t repeat yourself</em></span>, Rails
      developers spend less time configuring their applications and more time writing code.</p><p>Ruby on Rails is also a <span class="emphasis"><em>full-stack</em></span> web framework, meaning it handles
      everything from accessing data in a database to rendering web pages in the browser. As a
      full-stack framework, Rails is made up of a seemingly endless list of different components,
      such as Active Record, the asset pipeline, CoffeeScript, Sass, jQuery, turbolinks, and a
      variety of testing frameworks.</p><p>This book aims to cut through that list and explain exactly what you need to know to
      develop your own Ruby on Rails applications. After you gain some experience with the
      fundamentals of Rails, I’ll introduce and explain new components of the framework as
      needed.</p><p><a class="indexterm" id="iddle1694"/><a class="indexterm" id="iddle1738"/><a class="indexterm" id="iddle1741"/><a class="indexterm" id="iddle1743"/><a class="indexterm" id="iddle2031"/><a class="indexterm" id="iddle2120"/>By the end, you’ll know how to build your own Rails application from
      scratch. You’ll add tests to ensure features work as expected, protect your application
      and your users from security vulnerabilities, optimize your application’s performance,
      and finally deploy your application to your own server.</p><div class="sect1" title="Who This Book Is For"><div class="titlepage"><div><div><h1 class="title"><a id="who_this_book_is_for"/>Who This Book Is For</h1></div></div></div><p>I assume you have some experience with web development before starting this book. You
        should be familiar with HTML and CSS. You should know what an <code class="literal">H1</code> element
        is and how to add images and links to a web page. Some knowledge of object-oriented
        programming is helpful but not required.</p><p>You’ll use your computer’s terminal (or command prompt) to enter commands,
        but you don’t need much prior experience with terminal commands to follow the
        examples. In addition to the terminal, you’ll also need a text editor for writing Ruby
        code. Many Rails developers use a vintage editor, such as Vim or Emacs.</p><p>If you don’t already have a preferred text editor, I recommend Sublime Text. A
        free trial of Sublime Text is available online at <span class="emphasis"><em><a class="ulink" href="http://www.sublimetext.com/">http://www.sublimetext.com/</a></em></span>. The free trial version never expires,
        but it does occasionally prompt you to purchase a license.</p></div><div class="sect1" title="Overview"><div class="titlepage"><div><div><h1 class="title"><a id="overview"/>Overview</h1></div></div></div><p>This book is divided into two parts. The first part covers the fundamentals of the Ruby
        language and the Ruby on Rails framework. The second covers advanced topics in both Ruby and
        Ruby on Rails. There are exercises at the end of every chapter, and solutions for them
        appear at the end of the book.</p><p><span class="strong"><strong><a class="xref" href="ch01.html" title="Chapter 1. Ruby Fundamentals">Chapter 1</a></strong></span> covers the basics
        of Ruby, including datatypes, control flow, methods, and classes.</p><p><span class="strong"><strong><a class="xref" href="ch02.html" title="Chapter 2. Rails Fundamentals">Chapter 2</a></strong></span> covers the
        basics of Ruby on Rails. Topics include Rails principles, the directory structure used by
        Rails applications, and common Rails commands. You’ll create your first Rails
        application at the end of this chapter!</p><p><span class="strong"><strong><a class="xref" href="ch03.html" title="Chapter 3. Models">Chapter 3</a></strong></span>, <span class="strong"><strong><a class="xref" href="ch04.html" title="Chapter 4. Controllers">Chapter 4</a></strong></span>, and <span class="strong"><strong><a class="xref" href="ch05.html" title="Chapter 5. Views">Chapter 5</a></strong></span> describe the three parts of the model-view-controller
        architecture used by Rails.</p><p><span class="strong"><strong><a class="xref" href="ch06.html" title="Chapter 6. Deployment">Chapter 6</a></strong></span> covers creating a Git
        repository to store your application and deploying your application to the web using
        Heroku.</p><p>Once you understand the fundamentals of Ruby and Ruby on Rails, you’re ready for
        more advanced topics.</p><p><span class="strong"><strong><a class="xref" href="ch07.html" title="Chapter 7. Advanced Ruby">Chapter 7</a></strong></span> covers Ruby modules,
        the Ruby object model, and even a bit of metaprogramming.</p><p><span class="strong"><strong><a class="xref" href="ch08.html" title="Chapter 8. Advanced Active Record">Chapter 8</a></strong></span> covers more
        advanced Active Record associations. You’ll also build the data model for a new
        application at the end of this chapter.</p><p><span class="strong"><strong><a class="xref" href="ch09.html" title="Chapter 9. Authentication">Chapter 9</a></strong></span> covers the
        authentication system used by your new application. This system allows users sign up for an
        account, log in to your application, and log off.</p><p><span class="strong"><strong><a class="xref" href="ch10.html" title="Chapter 10. Testing">Chapter 10</a></strong></span> covers automated testing
        for each part of your application using the MiniTest framework included with Ruby. This
        chapter also discusses test-driven development.</p><p><span class="strong"><strong><a class="xref" href="ch11.html" title="Chapter 11. Security">Chapter 11</a></strong></span> covers common web
        application security vulnerabilities and explains how to make sure your application is
        secure.</p><p><span class="strong"><strong><a class="xref" href="ch12.html" title="Chapter 12. Performance">Chapter 12</a></strong></span> covers performance
        optimizations for Rails applications. Topics include the optimization features already built
        in to Rails, SQL query optimizations, and caching.</p><p><span class="strong"><strong><a class="xref" href="ch13.html" title="Chapter 13. Debugging">Chapter 13</a></strong></span> explains several ways to
        track down bugs. Learn how to add to the log files generated by your application and how to
        use the interactive debugger for really tough bugs.</p><p><span class="strong"><strong><a class="xref" href="ch14.html" title="Chapter 14. Web APIs">Chapter 14</a></strong></span> explains how to use the
        GitHub API and then covers the process of creating your own API for your application.</p><p>Finally, <span class="strong"><strong><a class="xref" href="ch15.html" title="Chapter 15. Custom Deployment">Chapter 15</a></strong></span> explains
        the process of setting up your own server on the Amazon cloud and deploying your application
        using Capistrano.</p></div><div class="sect1" title="Installation"><div class="titlepage"><div><div><h1 class="title"><a id="installation"/>Installation</h1></div></div></div><p>To follow the examples and complete the exercises in this book, you’ll need the
        Ruby programming language, the Ruby on Rails framework, the Git version control system, and
        the Heroku Toolbelt.</p><p>The Ruby language website provides installation instructions at <span class="emphasis"><em><a class="ulink" href="https://www.ruby-lang.org/en/installation/">https://www.ruby-lang.org/en/installation/</a></em></span>. Rails is distributed as a
        collection of Ruby gems, which you’ll download and install with a single command that
        depends on your operating system. (The Ruby on Rails website also provides instructions at
            <span class="emphasis"><em><a class="ulink" href="http://rubyonrails.org/download/">http://rubyonrails.org/download/</a></em></span>.) You can download
        Git at <span class="emphasis"><em><a class="ulink" href="http://git-scm.com/downloads/">http://git-scm.com/downloads/</a></em></span>.</p><p>Once you’ve installed Ruby, Rails, and Git, install the latest version of the
        Heroku Toolbelt, which you’ll use to deploy your applications to Heroku. Download the
        Heroku Toolbelt installer from <span class="emphasis"><em><a class="ulink" href="https://toolbelt.heroku.com/">https://toolbelt.heroku.com/</a></em></span>, and then follow the instructions there to complete the installation.</p><div class="sect2" title="Ruby, Rails, and Git"><div class="titlepage"><div><div><h2 class="title"><a id="rubycomma_railscomma_and_git"/>Ruby, Rails, and Git</h2></div></div></div><p>The sections below contain detailed installation instructions for Ruby, Rails, and Git
          on Mac OS X, Linux, and Windows. If you’re using Mac OS X or Linux, also see <a class="xref" href="pr03.html#multiple_ruby_versions" title="Multiple Ruby Versions">Multiple Ruby Versions</a> for an alternative way to install Ruby. There’s
          a tool called pik for managing multiple Ruby versions on Windows, but it hasn’t been
          updated since 2012, so I won’t cover it here.</p><div class="sect3" title="Mac OS X"><div class="titlepage"><div><div><h3 class="title"><a id="mac_os_x"/>Mac OS X</h3></div></div></div><p>Check your current version of Ruby with <code class="literal">ruby --version</code>. If you
            have Mac OS X Mavericks, you should already have Ruby version 2.0.0. Otherwise, you need
            to install a newer version.</p><p>Even if you already have Ruby 2.0.0, I recommend using the Homebrew package manager
            on Mac OS X. Homebrew is an easy way to install and update common development tools on
            Mac OS X. Instructions for downloading and installing Homebrew are online at
                <span class="emphasis"><em><a class="ulink" href="http://brew.sh/">http://brew.sh/</a></em></span>. Once you install Homebrew, open
            a terminal and enter the command <span class="strong"><strong><code class="literal">brew install
                ruby</code></strong></span> to install the latest version of Ruby.</p><p>Next, install Ruby on Rails with the command <span class="strong"><strong><code class="literal">gem
                install rails</code></strong></span>. Then use Homebrew again to install Git by
            entering the command <span class="strong"><strong><code class="literal">brew install
              git</code></strong></span>.</p></div><div class="sect3" title="Linux"><div class="titlepage"><div><div><h3 class="title"><a id="linux"/>Linux</h3></div></div></div><p>Installation instructions for Linux differ slightly based on which Linux
            distribution you are using. First, check your package manager; it may have a recent
            version of Ruby. If so, just install that package as you would any other.</p><p>If not, you’ll need to install Ruby from source. Download the current stable
            version from <span class="emphasis"><em><a class="ulink" href="https://www.ruby-lang.org/en/downloads/">https://www.ruby-lang.org/en/downloads/</a></em></span>. Unpack the file and then enter the following commands in a
            terminal:</p><a id="pro_id00001"/><pre class="programlisting">$ <span class="strong"><strong>./configure</strong></span>
$ <span class="strong"><strong>make</strong></span>
$ <span class="strong"><strong>sudo make install</strong></span></pre><p>Once the installation is complete, install Ruby on Rails by entering the command
              <span class="strong"><strong><code class="literal">sudo gem install rails</code></strong></span>.</p><p>Every Linux distribution includes Git. Install Git with your package manager if
            it’s not already installed on your system.</p></div><div class="sect3" title="Windows"><div class="titlepage"><div><div><h3 class="title"><a id="windows"/>Windows</h3></div></div></div><p>You’ll use RubyInstaller to install Ruby. Download the RubyInstaller and the
            matching Development Kit from <span class="emphasis"><em><a class="ulink" href="http://rubyinstaller.org/downloads/">http://rubyinstaller.org/downloads/</a></em></span>.</p><p>First, click the latest Ruby version on the RubyInstaller download page to download
            the installer; at the time of writing, it’s <span class="emphasis"><em>2.1.5</em></span>. Then
            scroll down to the section labeled Development Kit and click the link under your version
            of Ruby to download the Development Kit. As of this writing, for Ruby 2.1, you’d
            choose <span class="emphasis"><em>DevKit-mingw64-32-4.7.2-20130224-1151-sfx.exe</em></span>. If you are
            using a 64-bit version of Windows, then download the 64-bit version of the installer and
            the matching 64-bit Development Kit, currently
              <span class="emphasis"><em>DevKit-mingw64-64-4.7.2-20130224-1151-sfx.exe</em></span>.</p><p>Once these downloads finish, double-click the RubyInstaller file and then follow the
            prompts on your screen to install Ruby. Be sure to check the box next to <span class="emphasis"><em>Add Ruby executables to your PATH</em></span>. Once that is complete, double-click the
            <span class="emphasis"><em>DevKit</em></span> file and enter the path <span class="emphasis"><em>C:\DevKit</em></span> to extract the files. Now open a command prompt and enter the following commands to install the Development Kit:</p><a id="I_programlisting_id386162"/><pre class="programlisting">$ cd C:\DevKit
$ ruby dk.rb init
$ ruby dk.rb install</pre><p>Some users see SSL errors when trying to install gems. Updating to the latest version of the <code class="literal">gem</code> command corrects these errors. Enter the following command to update your version of <code class="literal">gem</code>:</p><a id="I_programlisting_id386177"/><pre class="programlisting">$ gem update --system –-clear-sources –-source http://rubygems.org</pre><p>Once you’ve installed Ruby and the Development Kit, install Rails by entering <span class="strong"><strong><code class="literal">gem install
              rails</code></strong></span>. This will connect to the RubyGems server, then download
            and install the various packages that make up the Ruby on Rails framework.</p><p>Finally, download the latest version of Git and double-click the file to complete
            the installation.</p><div class="note" title="Note"><h3 class="title">Note</h3><p>Note: Throughout this book I ask you to enter commands such as <code class="literal">bin/rake</code> and <code class="literal">bin/rails</code>. These commands don’t work on Windows. Windows users, please add <code class="literal">ruby</code> before these commands. For example, you will enter <code class="literal">ruby bin/rake</code> and <code class="literal">ruby bin/rails</code>.</p></div></div></div><div class="sect2" title="Multiple Ruby Versions"><div class="titlepage"><div><div><h2 class="title"><a id="multiple_ruby_versions"/>Multiple Ruby Versions</h2></div></div></div><p>Several third-party tools exist to make it easier to install and manage multiple
          versions of Ruby on a single computer. This can be useful if you maintain several
          different applications or if you want to test an application on a different version of
          Ruby.</p><p>The Ruby on Rails website recommends managing your Ruby installation with
            <code class="literal">rbenv</code> and the <code class="literal">ruby-build</code> plugin. The
            <code class="literal">rbenv</code> command switches between Ruby versions and
            <code class="literal">ruby-build</code> provides the <code class="literal">rbenv install</code> command that
          you use to install different versions of Ruby.</p><div class="sect3" title="Installing rbenv"><div class="titlepage"><div><div><h3 class="title"><a id="installing_rbenv"/>Installing rbenv</h3></div></div></div><p>If you’re using Mac OS X, both <code class="literal">rbenv</code> and
              <code class="literal">ruby-build</code> can be installed using Homebrew. Instructions for
            installing Homebrew are online at <span class="emphasis"><em><a class="ulink" href="http://brew.sh/">http://brew.sh/</a></em></span>.</p><p>Open a Terminal, enter <span class="strong"><strong><code class="literal">brew install rbenv
                ruby-build</code></strong></span>, and skip to <a class="xref" href="ch15.html#installing_ruby-id00034" title="Installing Ruby">Installing Ruby</a>.</p><p>On Linux, install <code class="literal">rbenv</code> and <code class="literal">ruby-build</code> by
            cloning the code from GitHub as shown below. Complete installation instructions are
            available online at <span class="emphasis"><em><a class="ulink" href="https://github.com/sstephenson/rbenv/">https://github.com/sstephenson/rbenv/</a></em></span>.</p><p>First, make sure you have the proper development tools installed. The
              <code class="literal">ruby-build</code> wiki at <span class="emphasis"><em><a class="ulink" href="https://github.com/sstephenson/ruby-build/wiki/">https://github.com/sstephenson/ruby-build/wiki/</a></em></span> contains a
            suggested build environment for most popular Linux distributions. For example, on
            Ubuntu, enter the following command to install everything you need to compile
            Ruby.</p><a id="pro_id00002"/><pre class="programlisting">$ <span class="strong"><strong>sudo apt-get install autoconf bison build-essential git \</strong></span>
                       <span class="strong"><strong>libssl-dev libyaml-dev libreadline6 \</strong></span>
                       <span class="strong"><strong>libreadline6-dev zlib1g zlib1g-dev</strong></span>
Reading package lists... Done
Building dependency tree
--<span class="emphasis"><em>snip</em></span>--
Do you want to continue? [Y/n]</pre><p>Type the letter <span class="strong"><strong><code class="literal">y</code></strong></span> to install
            these packages, and press <span class="smaller">ENTER</span>. Packages needed for
            other Linux distributions are listed on the wiki page above.</p><p>Next, enter the following command to clone the <code class="literal">rbenv</code> git
            repository into your home directory.</p><a id="pro_id00003"/><pre class="programlisting">$ <span class="strong"><strong>git clone https://github.com/sstephenson/rbenv.git ~/.rbenv</strong></span>
Cloning into '/home/ubuntu/.rbenv'...
--<span class="emphasis"><em>snip</em></span>--
Checking connectivity... done.</pre><p>Then, add the <span class="emphasis"><em>~/.rbenv/bin</em></span> directory to your
              <code class="literal">$PATH</code> and add a line to your <span class="emphasis"><em>.bashrc</em></span> file to
            initialize <code class="literal">rbenv</code> each time you log on.</p><a id="pro_id00004"/><pre class="programlisting">$ <span class="strong"><strong>echo 'export PATH="$HOME/.rbenv/bin:$PATH"' &gt;&gt; ~/.bashrc</strong></span>
$ <span class="strong"><strong>echo 'eval "$(rbenv init -)"' &gt;&gt; ~/.bashrc</strong></span>
$ <span class="strong"><strong>source ~/.bashrc</strong></span></pre><p>Finally, install <code class="literal">ruby-build</code> by cloning its git repository into
            the <code class="literal">rbenv</code> plugins directory with the following command.</p><a id="pro_id00005"/><pre class="programlisting">$ <span class="strong"><strong>git clone https://github.com/sstephenson/ruby-build.git \</strong></span>
            <span class="strong"><strong>~/.rbenv/plugins/ruby-build</strong></span>
Cloning into '/home/ubuntu/.rbenv/plugins/ruby-build'...
--<span class="emphasis"><em>snip</em></span>--
Checking connectivity... done.</pre><p>Once you have <code class="literal">rbenv</code> and <code class="literal">ruby-build</code> installed,
            you’re ready to install Ruby.</p></div><div class="sect3" title="Installing Ruby"><div class="titlepage"><div><div><h3 class="title"><a id="installing_ruby"/>Installing Ruby</h3></div></div></div><p>Enter the command <span class="strong"><strong><code class="literal">rbenv install
              -l</code></strong></span> to list the currently available Ruby versions.</p><a id="pro_id00006"/><pre class="programlisting">$ <span class="strong"><strong>rbenv install -l</strong></span>
Available versions:
  1.8.6-p383
  1.8.6-p420
  1.8.7-p249
  1.8.7-p302
  --<span class="emphasis"><em>snip</em></span>--</pre><p>Ignore the versions with words such as <span class="emphasis"><em>jruby</em></span>,
              <span class="emphasis"><em>rbx</em></span>, and <span class="emphasis"><em>ree</em></span> at the beginning. For now, just
            focus on the version numbers. The latest version as of this writing is 2.1.1. If there
            is a newer version when you install rbenv, replace 2.1.1 with the correct version number
            in the command below.</p><a id="pro_id00007"/><pre class="programlisting">$ <span class="strong"><strong>rbenv install 2.1.1</strong></span>
Downloading yaml-0.1.6.tar.gz...
--<span class="emphasis"><em>snip</em></span>--
Installed ruby-2.1.1 to /home/ubuntu/.rbenv/versions/2.1.1</pre><p>Once this completes, enter <span class="strong"><strong><code class="literal">rbenv global
                2.1.1</code></strong></span> to set your system’s global default Ruby version.
            Now install Ruby on Rails by entering <span class="strong"><strong><code class="literal">gem install
                rails</code></strong></span>. Finally, update <code class="literal">rbenv</code> by entering
              <span class="strong"><strong><code class="literal">rbenv rehash</code></strong></span>. You can learn more
            about how <code class="literal">rbenv</code> lets you switch Ruby versions at the
              <code class="literal">rbenv</code> website <span class="emphasis"><em><a class="ulink" href="https://github.com/sstephenson/rbenv/">https://github.com/sstephenson/rbenv/</a></em></span>.</p></div></div></div></div></body></html>