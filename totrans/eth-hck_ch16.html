<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:ns="http://www.w3.org/2001/10/synthesis" lang="en-us" xml:lang="en-us">
	<head>
		<title>Ethical Hacking: A Hands-on Introduction to Breaking In</title>
		<link href="../styles/9781718501881.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:3776231c-affd-4772-8376-b44c973236be" name="Adept.expected.resource"/>
	</head>
	<body>
		<h2 class="h2" id="ch16"><span epub:type="pagebreak" id="page_323"/><strong><span class="big">16</span><br/>NEXT STEPS</strong></h2>
		<p class="verse"><em>And now these three remain: faith, hope, and love. But the greatest of these is love.</em></p>
		<p class="chap-au">–1 Corinthians 13:13</p>
		<div class="imagec">
			<img alt="image" src="../images/common.jpg"/>
		</div>
		<p class="noindents">Before ending this book, I want to give you some tools for continuing your ethical hacking journey. In this chapter, you’ll set up your own hacking server, which will allow you to audit systems outside of your virtual environment. You can use this server to perform attacks, like those described in this book, on real systems. Once you have set up your server, I will discuss some of the exciting ethical hacking topics I didn’t cover in this book, including attacking wireless networks and software-defined radios, reverse engineering malicious binaries, hacking industrial systems, and exploring quantum computation.</p>
		<h3 class="h3" id="ch16lev1"><span epub:type="pagebreak" id="page_324"/><strong>Setting Up a Hardened Hacking Environment</strong></h3>
		<p class="noindent">So far, we’ve performed all of our attacks within our virtual environment. But if you want to audit systems outside your virtual environment, you’ll need to set up a hardened <em>virtual private server (VPS)</em>, a virtual machine running on a server in a datacenter, with a public IP address. Using a remote VPS has several advantages, including anonymity and the ability to easily assign yourself a public IP address, allowing your server to communicate with other machines on the internet. This will enable you to communicate with remote shells on devices outside of your virtual environment.</p>
		<p class="indent">However, having a public IP address also means that other machines on the internet can detect and scan your VPS, so you must make sure it is secure. We commonly refer to the process of securing a machine as <em>hardening</em>.</p>
		<p class="indent">Alternatively, you could set up a personal desktop or laptop computer as your own private server. But if you do, you’ll need to set up port forwarding so that the NAT in your home router knows to forward incoming packets to your server. Setting up your own server has some other disadvantages. For example, the IP address associated with an attack could easily be traced back to you.</p>
		<p class="indent">In this section, we’ll walk through the process of setting up a secure and anonymous hacking VPS.</p>
		<h4 class="h4" id="ch16lev2"><strong><em>Remaining Anonymous with Tor and Tails</em></strong></h4>
		<p class="noindent">Before you set up your VPS, you’ll want a way to avoid detection. You’ve probably heard of using <em>Tor</em> to remain anonymous on the internet. Tor is a network of computers that routes its traffic from machine to machine like a game of telephone, making it difficult to detect the machine from which the traffic originated because no node knows both the source and destination.</p>
		<p class="indent">To use Tor, a user first receives a list of Tor nodes from a public, trusted source called the <em>Tor Directory Authorities</em>, and then establishes an encrypted connection to a node in the network known as the <em>entry node</em>. The Tor client will use the encrypted connection with the entry node to establish an encrypted connection with another node. This is analogous to placing an encrypted envelope within another envelope, and it prevents intermediate Tor nodes from reading the message. This process of establishing encrypted connections within other encrypted connections continues until the Tor client selects a node to use as the <em>exit node</em>. The exit node is a node that establishes a connection to the server or website that the user wants to access. The packet that is sent to the server will contain the source address of the Tor exit node only. This means that, from the server’s perspective, the traffic will have appeared to have originated from the exit node (<a href="ch16.xhtml#ch16fig1">Figure 16-1</a>).</p>
		<div class="image" id="ch16fig1">
			<span epub:type="pagebreak" id="page_325"/>
			<img alt="image" src="../images/ch16fig01.jpg"/>
		</div>
		<p class="figcap"><em>Figure 16-1: How the Tor network transmits data</em></p>
		<p class="indent">It is important to note that Tor does not hide the fact that you are using Tor from your ISP or from state actors. The list of Tor relays is public and your ISP can see the IP addresses it routes on your behalf. Thus, your ISP can detect your first connection to a Tor relay. However, tracking subsequent Tor relay connections is more difficult, especially if they are located outside of the country where the connection was initiated. This means that your ISP can detect that you are using Tor, but they can’t determine what sites you are visiting by using it. State actors can guess which sites a Tor user visits using a <em>correlation attack</em>, an attack in which a state actor monitors when a user sends traffic into Tor and when the traffic exits. By looking at timing and traffic patterns, a state-level actor can guess which sites you access. You can learn more about these attacks by reading by Yixin Sun’s paper “RAPTOR: Routing Attacks on Privacy in Tor” (<em>USENIX Security Symposium</em>, 2015).</p>
		<p class="indent">Tor also does not encrypt this final leg in the connection, so you must ensure that you establish a secure connection with the server by using HTTPS. Lastly, Tor doesn’t protect you from the server you’re accessing. Any data that you provide to that server can be extracted if it is compromised or subpoenaed, and if you visit a malicious site using Tor, the site could still compromise your machine by installing malware that will de-anonymize your session.</p>
		<p class="indent"><em>Tails</em> is a Linux distribution created by the Tor project that routes all traffic through Tor. It also includes the <em>Tor Browser Bundle</em>, which is a web browser that comes preinstalled with HTTPS Everywhere and NoScript. Recall from <a href="ch02.xhtml#ch2">Chapter 2</a> that HTTPS Everywhere is a tool that tries to limit the amount of unencrypted traffic your browser sends. This reduces the likelihood that someone intercepting traffic will discover you. NoScript is a browser plug-in that prevents JavaScript from being executed in your browser, preventing an attacker from using JavaScript to load a reverse shell <span epub:type="pagebreak" id="page_326"/>onto your machine. Tails also includes a Bitcoin wallet. You can run Tails from a USB stick, and it will not write to the disk, leaving no sign of the system after you unplug the USB stick. You can find instructions for downloading and installing Tails at <em><a href="https://tails.boum.org/install/index.en.html">https://tails.boum.org/install/index.en.html</a></em>.</p>
		<h4 class="h4" id="ch16lev3"><strong><em>Setting Up a Virtual Private Server</em></strong></h4>
		<p class="noindent">After you’ve downloaded and installed Tails, use it to set up your VPS.</p>
		<p class="indent">Services like Amazon Web Services, DigitalOcean, and Vultr make setting up a VPS easy and affordable. However, this comes at the cost of anonymity given that the service will have your name and billing information. Thus, consider using <em><a href="https://BitLaunch.io/">https://BitLaunch.io/</a></em> to remain anonymous by using Bitcoin to purchase a VPS. It works with either DigitalOcean or Vultr. The Bitcoin blockchain is public, and it stores all transactions between users. So, everyone sees that user X paid user Y two Bitcoin; however, no one sees user X’s or Y’s real names, only their public keys. Other cryptocurrencies, like Monero, hide transaction information, making transactions untraceable.</p>
		<p class="indent"><a href="ch16.xhtml#ch16fig2">Figure 16-2</a> shows an overview of the setup. An attacker running Tails uses the Tor network to anonymously access the VPS. They then use this VPS to communicate with a reverse shell on the victim’s machine.</p>
		<div class="image" id="ch16fig2">
			<img alt="image" src="../images/ch16fig02.jpg"/>
		</div>
		<p class="figcap"><em>Figure 16-2: Using Tails to connect to the VPS</em></p>
		<p class="indent">If the victim discovers the reverse shell, they will be able to trace the attack back to the VPS, but it will be difficult for them to trace the attack back through the Tor network to the attacker.</p>
		<h4 class="h4" id="ch16lev4"><strong><em>Setting Up SSH</em></strong></h4>
		<p class="noindent">After you’ve set up your VPS, it’s an excellent idea to configure SSH keys so that you can securely access it remotely. You shouldn’t use username and password pairs, because tools like Hydra allow attackers to brute-force <span epub:type="pagebreak" id="page_327"/>username and password combinations. Instead, it’s best to log in using asymmetric cryptography techniques.</p>
		<p class="indent">To do so, you’ll generate a public–private key pair and then upload a copy of the public key to the server, which it will use to authenticate the user. <a href="ch16.xhtml#ch16fig3">Figure 16-3</a> shows an overview of this authentication process.</p>
		<div class="image" id="ch16fig3">
			<img alt="image" src="../images/ch16fig03.jpg"/>
		</div>
		<p class="figcap"><em>Figure 16-3: Using asymmetric cryptography to authenticate with an SSH server</em></p>
		<p class="indent">The client initiates the connection <span class="ent">➊</span>. Then, the server responds by sending a challenge nonce <span class="ent">➋</span>. Once the client receives the nonce, it encrypts the nonce with the client’s private key and sends the encrypted nonce back to the server <span class="ent">➌</span>. The server then decrypts the nonce using the client’s public key, and if the nonce matches, the client is authenticated <span class="ent">➍</span>. Now let’s generate the public–private key pair on the Tails device.</p>
		<p class="indent">Run the command <span class="literal"><strong>ssh-keygen</strong></span> in the Tails machine to create a public–private key pair using the ECDSA algorithm discussed in <a href="ch06.xhtml#ch6">Chapter 6</a>:</p>
		<p class="programs">amnesia@amnesia$ <span class="codestrong1">ssh-keygen -t ecdsa -b 521</span><br/><br/>Generating public/private ecdsa key pair.<br/>Enter file in which to save the key (/home/amnesia/.ssh/id_ecdsa):<br/>Enter passphrase (empty for no passphrase):<br/>Enter same passphrase again:<br/>Your identification has been saved in /home/amnesia/.ssh/id_ecdsa<br/>Your public key has been saved in /home/amnesia/.ssh/id_ecdsa.pub<br/>The key fingerprint is:<br/>SHA256:ZaQogDeZobktFCJIorwJkjWRxLmLSsdcVRbX1BjvQHs amnesia@amnesia<br/>The key's randomart image is:<br/>
+---[ECDSA 521]---+<br/>
|**BB    .+o.o++  |<br/>
|O=Xo   o.o. .oo. |<br/>
|B+ o. o . o  o E |</p>
		<p class="indent">Save the keys to the default path by pressing ENTER when prompted for the filename. Next, create a long and secure passphrase. If someone gains access to your Tails operating system and steals the secret key, they could try cracking the passphrase using a dictionary-based attack and access your VPS.</p>
		<p class="indent"><span epub:type="pagebreak" id="page_328"/>After you’ve generated your key pairs, you’ll need to copy your public key to the server. Copy your public key to the server by using the <span class="literal">ssh-copy-id</span> utility:</p>
		<p class="programs">$ <span class="codestrong1">ssh-copy-id -i /home/amnesia/.ssh/id_ecdsa.pub hacker@192.168.1.114</span><br/>
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/amnesia/.<br/>
    
			<img alt="image" src="../images/arrow01.jpg"/>
			 ssh/id_ecdsa.pub"<br/>
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to<br/>
    
			<img alt="image" src="../images/arrow01.jpg"/>
			 filter out any that are already installed<br/>
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are<br/>
    
			<img alt="image" src="../images/arrow01.jpg"/>
			 prompted now it is to install the new keys<br/>hacker@192.168.1.114's password:**your_password<br/><span class="codestrong1">Number of key(s) added: 1</span></p>
		<p class="indent">At this point, you should be able to log in to the machine as follows:</p>
		<p class="programs">amnesia@amnesia$ <span class="codestrong1">ssh hacker@<span class="codeitalic">&lt;VPS IP address&gt;</span></span></p>
		<p class="indent">Now that you’ve set up authentication using asymmetric cryptography, it is also a good idea to edit the <em>ssh_config</em> file to prevent password logins and root logins. You can open this file in Vim like this:</p>
		<p class="programs">root@debian:~/# <span class="codestrong1">vim /etc/ssh/sshd_config</span></p>
		<h4 class="h4" id="ch16lev5"><strong><em>Installing Your Hacking Tools</em></strong></h4>
		<p class="noindent">Now that you have your VPS set up and can connect to it securely and anonymously, it’s time to install the hacking tools you’ll need. You can choose to follow one of two approaches to setting up your VPS. The first approach is to install only the tools you need. For example, if you’re testing for XSS vulnerabilities, you could create a server that runs the BeEF Framework and nothing else. This approach minimizes the number of applications running on your VPS, thereby reducing its attack surface. (Remember that the only tools you can truly trust are those that you’ve built yourself.)</p>
		<p class="indent">Alternatively, you could create a general-purpose machine containing many hacking tools. Started by David Kennedy, the <em>PenTesters Framework (PTF)</em> contains Python scripts that make it easy to download and install the latest hacking tools. PTF is also an excellent resource for discovering new tools.</p>
		<p class="indent">You don’t need to create your own custom machine. You could also install Kali Linux or Parrot OS on your VPS. However, these machine don’t come with an SSH server installed, so you’ll need to install an SSH server to log in remotely.</p>
		<p class="indent">Here, we’ll assume that you’ve elected to create a custom VPS running Debian Linux, but these scripts should work on most Linux-based systems. <span epub:type="pagebreak" id="page_329"/>First, install <span class="literal">git</span> on your VPS (<span class="literal"><strong>apt-get install git</strong></span>) and then clone the PTF repository to your new VPS:</p>
		<p class="programs">git clone https://github.com/trustedsec/ptf.git</p>
		<p class="indent">Next, install <span class="literal">python3-pip</span>, use <span class="literal">pip3</span> to install the requirements, and run PTF (<span class="literal">./ptf</span>):</p>
		<p class="programs">cd ptf pip3<br/>install -r requirements.txt<br/>
./ptf</p>
		<p class="indent">When you want to use a module, install it by specifying the path to the installation script:</p>
		<p class="programs">ptf&gt; <span class="codestrong1">use modules/exploitation/metasploit</span><br/>ptf:(modules/exploitation/metasploit)&gt;install</p>
		<p class="indent">You can find all the installation scripts by looking in the Git repository. After the tool installs, you can use it just as you did before. Run the following command to install every tool:</p>
		<p class="programs">ptf&gt; <span class="codestrong1">use modules/install_update_all</span><br/>
[*] You are about to install/update everything. Proceed? [yes/no]:<span class="codestrong1">yes</span></p>
		<p class="indent">This installation will take some time.</p>
		<h4 class="h4" id="ch16lev6"><strong><em>Hardening the Server</em></strong></h4>
		<p class="noindent">Hardening is the process of configuring your server to protect it from attack. For example, you might password-protect the GRUB boot loader to prevent an attacker from modifying the boot process. Or you can install a tool like <em>ArpWatch</em>, developed by Lawrence Berkeley National Laboratory, to detect ARP spoofing attacks.</p>
		<p class="indent">Be careful when hardening your machine because you can end up locking yourself out of it or limiting its capabilities. For example, it’s common to disable compilers to prevent an attacker from compiling malware on your server. However, as an ethical hacker, you’ll need a compiler to compile your tools, so you might prefer to skip this hardening step.</p>
		<p class="indent">The <em>Center for Internet Security (CIS)</em> maintains a list of recommendations for securing systems called the CIS Benchmarks. Use these to harden your VPS, and keep them in mind when auditing a company’s security. Open source tools like <span class="literal">Jshielder</span>, <span class="literal">debian-cis</span>, and <span class="literal">nixarmor</span> will automatically apply many of the CIS recommendations to your server. You can install <span class="literal">JShielder</span> as follows:</p>
		<p class="programs">root@debian:~/# <span class="codestrong1">git clone https://github.com/Jsitech/JShielder</span></p>
		<p class="indent"><span epub:type="pagebreak" id="page_330"/>Navigate to the <em>JShielder</em> folder and run the <em>JShielder.sh</em> script (<span class="literal">.\JShielder</span>), which will prompt you to select the operating system that you’d like to harden:</p>
		<p class="programs">------------------------------------------------------------------------<br/>
[+] SELECT YOUR LINUX DISTRIBUTION<br/>
------------------------------------------------------------------------<br/><br/>
1. Ubuntu Server 16.04 LTS<br/>
2. Ubuntu Server 18.04 LTS<br/>
3. Linux CentOS 7 (Coming Soon)<br/>
4. Debian GNU/Linux 8 (Coming Soon)<br/>
5. Debian GNU/Linux 9 (Coming Soon)<br/>
6. Red Hat Linux 7 (Coming Soon)<br/>
7. Exit</p>
		<p class="indent">These hardening tools will often install rootkit detection tools like <span class="literal">rkhunter</span> or <span class="literal">chkrootkit</span>. They might also install intrusion prevention systems like <span class="literal">fail2ban</span>, which updates your firewall’s rules to ban IP addresses after multiple failed login attempts.</p>
		<p class="indent">Many automatic hardening tools will use the <span class="literal">iptables</span> utility to configure the firewall’s rules. If you’d like to alter firewall rules yourself, you can use one of several frontends developed for iptables. The best one is the <em>Uncomplicated Firewall</em>, which you can install by using the following command:</p>
		<p class="programs">root@debian:~/# <span class="codestrong1">sudo apt-get install ufw</span></p>
		<p class="indent">After you’ve installed it, you can begin configuring your firewall using only a couple of commands. For example, the following command sets the default policy to deny all incoming packets:</p>
		<p class="programs">root@debian:~/# <span class="codestrong1">ufw default deny incoming</span></p>
		<p class="indent">You then can start adding some exceptions. For example, we might want to allow SSH connections and connections on port 8080 so that implants can connect to our server:</p>
		<p class="programs">root@debian:~/# <span class="codestrong1">ufw allow ssh</span><br/>root@debian:~/# <span class="codestrong1">ufw allow 8080</span></p>
		<p class="indent">When you’re done configuring the rules, enable the firewall by running the <span class="literal"><strong>ufw enable</strong></span> command:</p>
		<p class="programs">root@debian:~/# <span class="codestrong1">ufw enable</span></p>
		<p class="indent">Finally, use the <span class="literal">ufw status</span> command to view the firewall’s state and a summary of the rules:</p>
		<p class="programs">root@debian:~/# <span class="codestrong1">ufw status</span><br/>Status: active<br/><br/><br/><span epub:type="pagebreak" id="page_331"/>To                         Action      From<br/>
--                         ------      ----<br/>
22/tcp                     ALLOW       Anywhere<br/>
8080                       ALLOW       Anywhere<br/>
22/tcp (v6)                ALLOW       Anywhere (v6)<br/>
8080 (v6)                  ALLOW       Anywhere (v6)</p>
		<p class="indent">Another useful tool called <em>SELinux</em> was developed by the NSA and Red Hat, and it adds an extra policy attribute to the operating system’s files. This policy attribute, in conjunction with the SELinux policy rules, governs how these files are accessed and modified. When a process attempts to access a file, SELinux will check the file’s policy attributes to determine if process is allowed to access the file. SELinux also logs the accesses it blocks, making these logs a great place to check for suspected intrusions.</p>
		<p class="indent">Run the following command to install SELinux with the default policy:</p>
		<p class="programs">sudo apt-get install selinux-basics selinux-policy-default auditd</p>
		<p class="indent">When the installation completes, activate SELinux and reboot your system:</p>
		<p class="programs">root@debian:~/# <span class="codestrong1">sudo selinux-activate</span></p>
		<p class="indent">In addition to hardening your server, you should also enable full disk encryption.</p>
		<h4 class="h4" id="ch16lev7"><strong><em>Auditing Your Hardened Server</em></strong></h4>
		<p class="noindent">After you have hardened your system, do a quick audit to see how well you did. The open source tool <em>Lynis</em> lets you audit your system against the CIS benchmarks. Run the following command to install Lynis:</p>
		<p class="programs">root@debian:~/# <span class="codestrong1">sudo apt-get install lynis</span></p>
		<p class="indent">Then run it using <span class="literal"><strong>sudo</strong></span>:</p>
		<p class="programs">   root@debian:~/#  <span class="codestrong1">sudo lynis audit system</span><br/>
                        ...<br/>
     Lynis security scan details:<br/><br/><span class="ent">➊</span> Hardening index : 84 [##############      ]<br/>
   Tests performed : 260<br/>
   Plugins enabled : 1<br/><br/>
   Components:<br/>
   - Firewall               [V]<br/>
   - Malware scanner        [V]<br/><br/>
   Scan mode:<br/>
   Normal [V]  Forensics [ ]  Integration [ ]  Pentest [ ]<br/><br/>
   <span epub:type="pagebreak" id="page_332"/>Lynis modules:<br/>
   - Compliance status      [?]<br/>
   - Security audit         [V]<br/>
   - Vulnerability scan     [V]<br/><br/>
   Files:<br/><span class="ent">➋</span> - Test and debug information      : /var/log/lynis.log<br/>
   - Report data                     : /var/log/lynis-report.dat<br/>
                        ...</p>
		<p class="indent">The report will print areas where you can improve and gives you a hardening index score <span class="ent">➊</span>. The associated detailed report <span class="ent">➋</span> contains output of each test that Lynis ran. For example, Lynis checks to see whether the server has the Snort intrusion detection system installed. The results of this test are available in the report.</p>
		<h3 class="h3" id="ch16lev8"><strong>Other Topics</strong></h3>
		<p class="noindent">I’ve chosen to highlight the following topics because I find them interesting and I hope that by sharing them they will spark your interest, as well. Let’s begin by looking at one of my favorite topics, software-defined radios.</p>
		<h4 class="h4" id="ch16lev9"><strong><em>Software-Defined Radios</em></strong></h4>
		<p class="noindent">So far, we’ve focused on collecting and analyzing electrical signals that flow across the wires in our network. But radio signals loaded with information float around us every day. These signals include cellular and satellite communications, police radio chatter, and even the FM signals for car stereos.</p>
		<p class="indent"><em>Software-defined radios (SDRs)</em> convert radio signals into digital signals that you can analyze on a computer. SDRs are also programmable, letting you convert an SDR into an AM receiver like the one you would find in a car or even receive satellite images from NOAA weather satellites. My favorite SDR application uses it as a ground station to communicate with the amateur radio transpoders on the Es’hail 2/QO-100 geosynchronous satellite. The transponders on this satellite are free and publicly available to any amateur radio enthusiast.</p>
		<p class="indent">There are several SDRs on the market. I recommend the <em>ADALM-Pluto RF</em> developed by Analog Devices, an entry-level SDR with amazing documentation. The Pluto runs Linux, and you can write programs to process the digital values it records.</p>
		<p class="indent">There are also great open source tools for working with SDR. <em>GNU Radio</em> allows you to visually program an SDR by dragging and dropping blocks of functionality. You can install it on Kali Linux by running the following command:</p>
		<p class="programs">kali@kali:~$ <span class="codestrong1">sudo apt-get install gnuradio</span></p>
		<p class="indent"><span epub:type="pagebreak" id="page_333"/>The NSA also has its own SDR tool, called <em>Redhawk</em>, which it has made publicly available. The documentation on Redhawk is impressive. You can read more about Redhawk on its website at <em><a href="https://redhawksdr.org">https://redhawksdr.org</a></em>.</p>
		<p class="indent">One of the best resources for learning about SDRS is <em><a href="https://sdrforengineers.github.io">https://sdrforengineers.github.io</a></em>. It has several coding examples, as well as video lectures by Alexander Wyglinski, and labs by Travis Collins (see the flipped class section at <em><a href="https://www.youtube.com/playlist?list=PLBfTSoOqoRnOTBTLahXBlxaDUNWdZ3FdS">https://www.youtube.com/playlist?list=PLBfTSoOqoRnOTBTLahXBlxaDUNWdZ3FdS</a></em>).</p>
		<h4 class="h4" id="ch16lev10"><strong><em>Attacking Cellular Infrastructure</em></strong></h4>
		<p class="noindent">Attacking the public cellular infrastructure is illegal and unethical. If you try any of the attacks described here, you should use a Faraday cage, a device that will isolate your test environment and prevent any signals from entering or leaving the cage, to keep you from intercepting any outside signals.</p>
		<p class="indent">That said, specialized hacking tools can do things like track cellphone users. Each mobile subscriber is assigned an ID called the <em>international mobile subscriber identity (IMSI)</em> that permanently identifies them as a 4G subscriber. When a subscriber moves to a new location, their cellphone registers their IMSI with a tower in that area. The Harris Corporation makes a tool, called <em>Stingray</em>, that allows law enforcement agencies to track cellphone subscribers. It works by pretending to be a cell tower. When a user is within range of a Stingray, their cellphone will connect to it and send the subscriber’s IMSI.</p>
		<p class="indent">Stingrays are expensive, but you can use an SDR to build your own IMSI catcher. One example of an open source IMSI catcher project is <em>IMSI-catcher</em> (<em><a href="https://github.com/Oros42/IMSI-catcher">https://github.com/Oros42/IMSI-catcher</a></em>). Once an attacker has a subscriber’s IMSI, the attacker can impersonate the subscriber, make calls, and send text messages. By pretending to be a cell tower, an attacker can also perform a downgrade attack. Thus, a fake cell tower can force a cellphone to downgrade from 4G to a less secure 2G or 3G connection.</p>
		<h4 class="h4" id="ch16lev11"><strong><em>Escaping the Air Gap</em></strong></h4>
		<p class="noindent">Suppose that you have a machine containing information that you really want to protect. You might decide to completely disconnect the machine from the network. Machines that are disconnected in this way are called airgapped machines.</p>
		<p class="indent">However, sometimes even disconnecting the machine isn’t enough. For example, an attacker could compromise the supply chain and insert malicious code into a machine before it is shipped to the victim. This way, they could still steal information from the machine even if it isn’t connected to a network; in the absence of a network, an attacker must create their own by some other means.</p>
		<p class="indent">In 2014, Michael Hanspach and Michael Goetz showed it was possible to build a network of computers that communicated using ultrasonic signals. This approach has been used in other applications. For example, the Singaporean marketing company Silverpush embedded ultrasonic beacons in TV <span epub:type="pagebreak" id="page_334"/>ads. These beacons were picked up by apps on users’ smartphones, allowing Silverpush to monitor what ads a user watched. This is part of a broader strategy called <em>cross-device tracking</em> and is a great example of making a network where none exists.</p>
		<p class="indent">More recently, a project called <em>System Bus Radio</em> (<em><a href="https://github.com//fulldecent/system-bus-radio">https://github.com//fulldecent/system-bus-radio</a></em>) demonstrated that a computer’s hardware bus could be transformed into a transmitter by sending carefully crafted messages. This is a clever way to create a radio transmitter on a machine that doesn’t have one. A receiver outside the building then could pick up these signals.</p>
		<h4 class="h4" id="ch16lev12"><strong><em>Reverse Engineering</em></strong></h4>
		<p class="noindent">Throughout the book, we’ve looked at the design and architecture of malware. However, as an ethical hacker, you’ll likely encounter more complex malware written by malicious actors. You’ll need to reverse engineer such malware to discover how it works. There are several excellent books on this topic. One of the best ones, <em>Practical Malware Analysis: The Hands-On Guide to Dissecting Malicious Software</em> by Michael Sikorski and Andrew Honig (No Starch Press, 2012), has several useful labs. The <em>Malware Must Die</em> blog at <em><a href="https://blog.malwaremustdie.org">https://blog.malwaremustdie.org</a></em> also has great posts on malware analysis. I recommend adding it to your RSS feed. I also recommend <em>The Ghidra Book: The Definitive Guide</em> by Chris Eagle and Kara Nance (No Starch Press, 2020), to learn more about the Ghidra reverse-engineering tool.</p>
		<h4 class="h4" id="ch16lev13"><strong><em>Physical Hacking Tools</em></strong></h4>
		<p class="noindent">If you have physical access to the network or machine that you’re trying to hack, you’ll be able to use physical tools to compromise the network. <em>Hak5</em> makes an amazing collection of physical hacking tools. For example, the <em>USB Rubber Ducky</em> is a USB stick that emulates a keyboard. When the attacker plugs it into a machine, it will enter commands and download a payload. <em>Bash Bunny</em> is a mini Linux computer that can emulate any USB device and allows you to run custom scripts. The <em>LAN Turtle</em> is a man-in-the-middle tool that you can install on an Ethernet cable. The <em>Shark Jack</em> is a miniature computer that can be plugged in to any open networking port. Lastly, the <em>Wi-Fi Pineapple</em> is a malicious Wi-Fi router that you can use to compromise devices when they connect to it. You can purchase all these tools together in the Hak5 field kit.</p>
		<h4 class="h4" id="ch16lev14"><strong><em>Forensics</em></strong></h4>
		<p class="noindent">As an ethical hacker, you might find yourself investigating attacks. For example, an enterprise might ask you to investigate how it was compromised. In these cases, you’ll find the <em>Computer Aided INvestigative Environment (CAINE)</em> Linux distribution helpful. CAINE is loaded with a collection of amazing forensics analysis tools that allow you to recover deleted files and photographs, analyze hard drives, and even investigate attacks on mobile devices.</p>
		<h4 class="h4" id="ch16lev15"><span epub:type="pagebreak" id="page_335"/><strong><em>Hacking Industrial Systems</em></strong></h4>
		<p class="noindent">In 2010, the Stuxnet malware attacked an Iranian facility used to enrich uranium. The malware caused the centrifuges in the facility to spin out of control, resulting in their catastrophic failure.</p>
		<p class="indent">In particular, Stuxnet targeted the facility’s <em>programmable logic controllers (PLCs)</em>, which are small computer modules used in industrial control systems. Years later, hackers continue to discover new PLC vulnerabilities. In 2016, Ralf Spenneberg, Maik Brueggemann, and Hendrik Schwartke presented malware called the <em>PLC-Blaster</em> at a Black Hat conference. And in 2017, another cyberattack occurred at a chemical plant in Saudi Arabia. The malware, nicknamed Triton, also targeted PLCs in the plant.</p>
		<p class="indent">Failures of industrial systems can be catastrophic, so we must audit and secure these systems. The <em>Cybersecurity and Infrastructure Security Agency (CISA)</em> maintains information on vulnerabilities affecting industrial control systems, which you can find at <em><a href="https://us-cert.cisa.gov/ics/">https://us-cert.cisa.gov/ics/</a></em>.</p>
		<h4 class="h4" id="ch16lev16"><strong><em>Quantum Computation</em></strong></h4>
		<p class="noindent">The invention of a scalable quantum computer has the potential to revolutionize cybersecurity. For example, we would be able to easily crack 2,048-bit RSA encryption and search through large databases quickly. Once we have a scalable quantum computer, we’ll also be able to develop new quantum machine learning algorithms. However, many of these ideas are still in the early research phase. Because quantum computing is still an active area of research, it can be difficult to find resources that help you to get started as a beginner. Qiskit’s textbook at <em><a href="https://qiskit.org/textbook/preface.html">https://qiskit.org/textbook/preface.html</a></em> is a fantastic read, filled with interactive exercises. The book will take you from not knowing anything about quantum computation to writing a scalable version of Shor’s quantum algorithm for factoring numbers. It also includes math primers to help you understand quantum computation.</p>
		<h3 class="h3" id="ch16lev17"><strong>Connect with Others</strong></h3>
		<p class="noindent">Whether you choose to be an active member of the hacking community or a quiet and invisible observer, here are some communities that you can join to share your creations and keep up to date on emerging trends. My personal favorite is Hacker News (<em><a href="https://news.ycombinator.com">https://news.ycombinator.com</a></em>), a forum created by the venture capital firm Y Combinator. People post new developments and interesting papers there all the time. Attending conferences like Defcon, Black Hat, and Usenix is another great way to meet people and listen to cutting-edge research talks. Lastly, join the Hack the Box (<em><a href="https://hackthebox.eu">https://hackthebox.eu</a></em>) community. Hack the Box has an extensive collection of vulnerable machines that you can practice hacking.</p>
		<p class="indent">Remember: always act ethically.<span epub:type="pagebreak" id="page_336"/></p>
	</body>
</html>