<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" lang="en" xml:lang="en">
<head>
<title>JavaScript Crash Course</title>
<meta content="text/html; charset=utf-8" http-equiv="default-style"/>
<link href="../styles/stylesheet.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:26ab05bf-a247-42ca-b08d-ede069333d2b" name="Adept.expected.resource"/>
</head>
<body epub:type="bodymatter">
<section aria-labelledby="ch8" epub:type="chapter" role="doc-chapter">
<hgroup>
<h2 class="CHAPTER" id="ch8">
<span class="CN"><span aria-label=" Page 127. " epub:type="pagebreak" id="pg_127" role="doc-pagebreak"/><samp class="SANS_Futura_Std_Bold_Condensed_B_11">8</samp></span>
<span class="CT"><samp class="SANS_Dogma_OT_Bold_B_11">EVENT-BASED PROGRAMMING</samp></span>
</h2>
</hgroup>
<figure class="opener"><img alt="" class="opener" src="../images/opener.png"/>
</figure>
<p class="INTROTNI2">When a user clicks a button, scrolls, or simply moves the mouse within a web page, that action creates an <i>event</i>. An event is the browser’s way of signaling that an action happened in the DOM. Events allow us to create interactive web applications that respond to the user’s actions. We do this by writing <i>handlers</i> for specific events: functions that are called when an event occurs. Using event handlers, we can change the color of an element when the user clicks it, move an element around the screen when the user presses a certain key, and much more.</p>
<p class="TX">In this chapter you’ll learn how to write event handlers to respond to some common DOM events. In this way, you’ll add interactivity to your web pages.</p>
<section aria-labelledby="sec1" epub:type="division">
<h3 class="H1" id="sec1"><span id="h1-42"/><span aria-label=" Page 128. " epub:type="pagebreak" id="pg_128" role="doc-pagebreak"/><samp class="SANS_Futura_Std_Bold_B_11">Event Handlers</samp></h3>
<p class="TNI1">Events are how the browser tells JavaScript that something has occurred in the DOM. It’s almost as if every time the mouse moves over the window, or a key is pressed, the browser is shouting, “Hey, the mouse moved! A key was pressed!” These shouts happen all the time, but your JavaScript code can respond to them only if you explicitly tell it to listen for them. You do this by writing a JavaScript event handler that will perform some action when a certain type of event occurs.</p>
<p class="TX">An <i>event handler</i> is a function triggered by a specific event type on a specific element. For example, you could attach a handler to a particular <span class="SANS_TheSansMonoCd_W5Regular_11">h1</span> element that handles clicks on that element. Let’s try that out now. We’ll create a simple web page with a heading and use an event handler to log a message to the console when the heading is clicked.</p>
<p class="TX">First, you’ll need an HTML file. Create a new directory called <i>chapter8</i> and make a new file in that directory called <i>index.html</i>. Enter the content shown in <a href="#Lis8-1">Listing 8-1</a>.</p>
<span id="Lis8-1"/>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Event Handlers&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1 id="main-heading"&gt;Hello &lt;em&gt;World!&lt;/em&gt;&lt;/h1&gt;
    &lt;script src="script.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p class="CodeListingCaption"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Listing 8-1: An</samp> <samp class="SANS_Futura_Std_Book_11">index.html</samp> <samp class="SANS_Futura_Std_Book_Oblique_I_11">file for exploring event handlers</samp></p>
<p class="TX">As usual, our HTML file has a single <span class="SANS_TheSansMonoCd_W5Regular_11">html</span> element containing a <span class="SANS_TheSansMonoCd_W5Regular_11">head</span> with some metadata and a <span class="SANS_TheSansMonoCd_W5Regular_11">body</span> with some content. Specifically, the <span class="SANS_TheSansMonoCd_W5Regular_11">body</span> contains an <span class="SANS_TheSansMonoCd_W5Regular_11">h1</span> element with an ID of <span class="SANS_TheSansMonoCd_W5Regular_11">main-heading</span>, and part of the heading text is wrapped in an <span class="SANS_TheSansMonoCd_W5Regular_11">em</span> element (short for <i>emphasis</i>), which by default italicizes that portion of the text. It also contains a <span class="SANS_TheSansMonoCd_W5Regular_11">script</span> element with a link to the file <i>script.js</i>. In a moment, that’s where we’ll write the code for our event handler.</p>
<p class="TX">Overall, this file is very similar to the <i>index.html</i> file we created in <a href="chapter7.xhtml">Chapter 7</a>, with one important difference: the <span class="SANS_TheSansMonoCd_W5Regular_11">script</span> element is inside the <span class="SANS_TheSansMonoCd_W5Regular_11">body</span> element, not the <span class="SANS_TheSansMonoCd_W5Regular_11">head</span> element. This is a bit of a cheat to get around a problem with how web browsers read web pages. As described in the previous chapter, the browser builds a model of the page called the DOM. It builds the DOM incrementally by reading through the HTML file from top to bottom. Anytime the browser reaches a <span class="SANS_TheSansMonoCd_W5Regular_11">script</span> element, it executes the whole script before continuing. That means that if we had our <span class="SANS_TheSansMonoCd_W5Regular_11">script</span> element in the <span class="SANS_TheSansMonoCd_W5Regular_11">head</span>, and we looked up the <span class="SANS_TheSansMonoCd_W5Regular_11">h1</span> element in that script, the <span class="SANS_TheSansMonoCd_W5Regular_11">h1</span> element wouldn’t be in the DOM yet! By placing the <span class="SANS_TheSansMonoCd_W5Regular_11">script</span> element at the end of the body, we can be sure that all the page content has been loaded into the DOM <i>before</i> we run our JavaScript.</p>
<p class="TX"><span aria-label=" Page 129. " epub:type="pagebreak" id="pg_129" role="doc-pagebreak"/>Now create a file called <i>script.js</i> in the same directory as the HTML code, and enter the script shown in <a href="#Lis8-2">Listing 8-2</a>. This script adds an event handler for when the user clicks the <span class="SANS_TheSansMonoCd_W5Regular_11">h1</span> element.</p>
<span id="Lis8-2"/>
<pre><code>let heading = document.querySelector("#main-heading");

heading.addEventListener("click", () =&gt; {
  console.log("You clicked the heading!");
});
</code></pre>
<p class="CodeListingCaption"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Listing 8-2: Creating an event handler in</samp> <samp class="SANS_Futura_Std_Book_11">script.js</samp></p>
<p class="TX">Using the DOM API’s <span class="SANS_TheSansMonoCd_W5Regular_11">querySelector</span> method, we get the element with the ID <span class="SANS_TheSansMonoCd_W5Regular_11">main-heading</span> and save it as the variable <span class="SANS_TheSansMonoCd_W5Regular_11">heading</span>. You may recall from <a href="chapter7.xhtml">Chapter 7</a> that this method returns the first element to match the selector. In our case, there’s only one <span class="SANS_TheSansMonoCd_W5Regular_11">main-heading</span> element, so we know this method will select the element we want. We then use the <span class="SANS_TheSansMonoCd_W5Regular_11">addEventListener</span> method on the <span class="SANS_TheSansMonoCd_W5Regular_11">heading</span> element to attach an event handler to that element. <span class="SANS_TheSansMonoCd_W5Regular_11">addEventListener</span> tells JavaScript to watch for a particular event happening on the element, and to execute some function when it does.</p>
<blockquote>
<p class="NOTE"><samp class="SANS_Dogma_OT_Bold_B_21">NOTE</samp></p>
</blockquote>
<p class="NOTE-TXT"><i>Although the DOM API uses the term</i> <span class="note_Italic">listener</span><i>, the term</i> <span class="note_Italic">handler</span> <i>is more commonly used to describe a function that reacts to an event.</i></p>
<p class="TX">The <span class="SANS_TheSansMonoCd_W5Regular_11">addEventListener</span> method has two required arguments. The first is the event type. This is a string representing the type of event to respond to, such as <span class="SANS_TheSansMonoCd_W5Regular_11">"click"</span> (for mouse clicks), <span class="SANS_TheSansMonoCd_W5Regular_11">"keydown"</span> (for keyboard key presses), or <span class="SANS_TheSansMonoCd_W5Regular_11">"scroll"</span> (for window scrolling). We’ve specified <span class="SANS_TheSansMonoCd_W5Regular_11">"click"</span>. The second argument is the function to execute when the specified event happens. This function is the event handler. It will be called anytime the event happens on the element <span class="SANS_TheSansMonoCd_W5Regular_11">addEventListener</span> was called on. In this case, the function, which logs a message to the console, will be called anytime someone clicks the <span class="SANS_TheSansMonoCd_W5Regular_11">heading</span> element.</p>
<blockquote>
<p class="NOTE"><samp class="SANS_Dogma_OT_Bold_B_21">NOTE</samp></p>
</blockquote>
<p class="NOTE-TXT"><i>As explained in <a href="chapter5.xhtml">Chapter 5</a>, when a function is passed as an argument to another function, it’s known as a</i> <span class="note_Italic">callback function</span><i>, or simply a</i> <span class="note_Italic">callback</span><i>. All event handlers are callback functions, since they’re passed as arguments to the <span class="SANS_TheSansMonoCd_W5Regular_11">addEventListener</span> method.</i></p>
<p class="TX">Open <i>index.html</i> in your browser and open the console. When you click the heading, you should see the message <span class="SANS_TheSansMonoCd_W5Regular_11">"You clicked the heading!"</span> printed to the console. Congratulations: you’ve made your first interactive web page!</p>
<section aria-labelledby="sec2" epub:type="division">
<aside aria-label="box-26" class="box" id="sec2">
<h4 class="BH" id="box-26"><samp class="SANS_Dogma_OT_Bold_B_11">TRY IT YOURSELF</samp></h4>
<p class="BoxListNumber"><samp class="SANS_Futura_Std_Bold_B_11">  8-1.</samp><samp class="SANS_Futura_Std_Book_11">  Add a</samp> <span class="SANS_TheSansMonoCd_W5Regular_11">p</span> <samp class="SANS_Futura_Std_Book_11">element to the page and attach a</samp> <span class="SANS_TheSansMonoCd_W5Regular_11">click</span> <samp class="SANS_Futura_Std_Book_11">event handler to it.</samp></p>
</aside>
</section>
<section aria-labelledby="sec3" epub:type="division">
<h4 class="H2" id="sec3"><span id="h2-58"/><span aria-label=" Page 130. " epub:type="pagebreak" id="pg_130" role="doc-pagebreak"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Event Bubbling</samp></h4>
<p class="TNI1">When an event is triggered on an element, it also gets triggered on all the element’s ancestors (that is, the parent of the element, the parent’s parent, and so on). For instance, when you clicked the <span class="SANS_TheSansMonoCd_W5Regular_11">h1</span> element in the previous example, you were also technically clicking the <span class="SANS_TheSansMonoCd_W5Regular_11">body</span> element that contains the <span class="SANS_TheSansMonoCd_W5Regular_11">h1</span> element. This makes sense intuitively; if you click some text in a box, you’re also clicking the box. Therefore, if you had a separate handler attached to the <span class="SANS_TheSansMonoCd_W5Regular_11">body</span> element, it would also receive the <span class="SANS_TheSansMonoCd_W5Regular_11">click</span> event. This progression of events from children to ancestors is known as <i>event bubbling</i>.</p>
<p class="TX">Let’s harness bubbling by adding event handlers to the <span class="SANS_TheSansMonoCd_W5Regular_11">em</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">body</span> elements in our web page. Like our <span class="SANS_TheSansMonoCd_W5Regular_11">h1</span> event handler, these new handlers will log a message to the console when their elements are clicked. Since <span class="SANS_TheSansMonoCd_W5Regular_11">em</span> is a child of <span class="SANS_TheSansMonoCd_W5Regular_11">h1</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">h1</span> is a child of <span class="SANS_TheSansMonoCd_W5Regular_11">body</span>, a single click on <span class="SANS_TheSansMonoCd_W5Regular_11">em</span> should trigger the handlers attached to all three elements.</p>
<p class="TX">Add the code in <a href="#Lis8-3">Listing 8-3</a> to the end of <i>script.js</i>.</p>
<span id="Lis8-3"/>
<pre><code><var>--snip--</var>
document.querySelector("em").addEventListener("click", () =&gt; {
  console.log("You clicked the em element!");
});

document.querySelector("body").addEventListener("click", () =&gt; {
  console.log("You clicked the body element!");
});
</code></pre>
<p class="CodeListingCaption"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Listing 8-3: Adding more handlers to</samp> <samp class="SANS_Futura_Std_Book_11">script.js</samp></p>
<p class="TX">This snippet adds two handlers, one to the <span class="SANS_TheSansMonoCd_W5Regular_11">em</span> element and one to the <span class="SANS_TheSansMonoCd_W5Regular_11">body</span> element, but we do it slightly differently from how we created the <span class="SANS_TheSansMonoCd_W5Regular_11">main-heading</span> handler in <a href="#Lis8-2">Listing 8-2</a>. Instead of saving each element to a variable, we just call <span class="SANS_TheSansMonoCd_W5Regular_11">addEventListener</span> directly on the result of the <span class="SANS_TheSansMonoCd_W5Regular_11">document.querySelector</span> method. This technique of calling a method directly on the return value of another method is known as <i>method chaining</i>: we chain multiple method calls together, so that the result of the first link in the chain is used as the object for the next method call. I used the longer technique for <a href="#Lis8-2">Listing 8-2</a> because it makes it more explicit that <span class="SANS_TheSansMonoCd_W5Regular_11">addEventListener</span> is being called on an element, but the chaining technique is often preferred because of its terseness.</p>
<p class="TX">Reload <i>index.html</i> and open the console. When you click the word <i>World!</i> you should see the following output:</p>

<pre><code>You clicked the em element!
You clicked the heading!
You clicked the body element!
</code></pre>
<p class="TX">When you click the <span class="SANS_TheSansMonoCd_W5Regular_11">em</span> element, the handler function on that element is the first to get called. After that, the handler function on the <span class="SANS_TheSansMonoCd_W5Regular_11">h1</span> element is called, followed by the one on the <span class="SANS_TheSansMonoCd_W5Regular_11">body</span> element. This is because the event “bubbles up” through the DOM, from the innermost element to the outermost element. If you click the non-italic part of the heading, you’ll see just the <span class="SANS_TheSansMonoCd_W5Regular_11">main-heading</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">body</span> handlers triggered.</p>
</section>
<section aria-labelledby="sec4" epub:type="division">
<h4 class="H2" id="sec4"><span id="h2-59"/><span aria-label=" Page 131. " epub:type="pagebreak" id="pg_131" role="doc-pagebreak"/><samp class="SANS_Futura_Std_Bold_Condensed_Oblique_BI_11">Event Delegation</samp></h4>
<p class="TNI1">One of the more common uses for event bubbling is <i>event delegation</i>, a technique where you use a single handler to respond to events on multiple child or other descendant elements. For example, imagine you have a list of words, where each list item is a separate HTML element, and you want to handle clicks on each item in the same way. By adding a single handler to the list items’ parent element, you can catch events on each item with only a few lines of code.</p>
<p class="TX">To illustrate event delegation, we’ll write a simple application that builds up and displays a sentence based on words that you click in a list. First, we’ll update our HTML file to include a list of words and an empty <span class="SANS_TheSansMonoCd_W5Regular_11">p</span> element that we’ll populate dynamically with the words of your choice. Then, we’ll write the necessary event handler with JavaScript to take clicked words and add them to the <span class="SANS_TheSansMonoCd_W5Regular_11">p</span> element for display. Finally, we’ll add some CSS rules to make the application easier to interact with.</p>
<p class="TX">There are two types of lists in HTML: ordered (numbered) lists and unordered (bulleted) lists. We’ll use an unordered list, which is created with the <span class="SANS_TheSansMonoCd_W5Regular_11">ul</span> (<i>unordered list</i>) element. Each individual item in the list is wrapped in an <span class="SANS_TheSansMonoCd_W5Regular_11">li</span> (<i>list item</i>) element. Therefore, the event resulting from a click on any <span class="SANS_TheSansMonoCd_W5Regular_11">li</span> element will bubble up to the parent <span class="SANS_TheSansMonoCd_W5Regular_11">ul</span> element.</p>
<p class="TX">Update <i>index.html</i> as shown in <a href="#Lis8-4">Listing 8-4</a>.</p>
<span id="Lis8-4"/>
<pre><code><span class="gray">&lt;!DOCTYPE html&gt;</span>
<span class="gray">&lt;html&gt;</span>
<span class="gray">  &lt;head&gt;</span>
<span class="gray">    &lt;</span><span class="gray">title&gt;Event Handlers&lt;/title&gt;</span>
<span class="gray">  &lt;/head&gt;</span>
<span class="gray">  &lt;body&gt;</span>
<span class="gray">    &lt;h1 id</span><span class="gray">="main-heading"&gt;Hello &lt;em&gt;World!&lt;/em&gt;&lt;/h1&gt;</span>

    &lt;ul id="word-list"&gt;
      &lt;li&gt;The&lt;/li&gt;
      &lt;li&gt;Dog&lt;/li&gt;
      &lt;li&gt;Cat&lt;/li&gt;
      &lt;li&gt;Is&lt;/li&gt;
      &lt;li&gt;Was&lt;/li&gt;
      &lt;li&gt;And&lt;/li&gt;
      &lt;li&gt;Hungry&lt;/li&gt;
      &lt;li&gt;Green&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p id="sentence"&gt;&lt;/p&gt;

<span class="gray">    &lt;script src="script.js"&gt;&lt;/script&gt;</span>
<span class="gray">  &lt;/body&gt;</span>
<span class="gray">&lt;/html&gt;</span>
</code></pre>
<p class="CodeListingCaption"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Listing 8-4: Adding a list to</samp> <samp class="SANS_Futura_Std_Book_11">index.html</samp></p>
<p class="TX">This adds an unordered list of words to the document, as well as an empty <span class="SANS_TheSansMonoCd_W5Regular_11">p</span> element, which we’ll be modifying with JavaScript.</p>
<p class="TX"><span aria-label=" Page 132. " epub:type="pagebreak" id="pg_132" role="doc-pagebreak"/>Next, we’ll write an event handler for the <span class="SANS_TheSansMonoCd_W5Regular_11">ul</span> element to handle clicks on any of the list items. The handler will take the word that was clicked and add it to the <span class="SANS_TheSansMonoCd_W5Regular_11">p</span> element, allowing you to build up a sentence one word at a time. Delete all the code in <i>script.js</i> and replace it with <a href="#Lis8-5">Listing 8-5</a>.</p>
<span id="Lis8-5"/>
<pre><code>let wordList = document.querySelector("#word-list");
let sentence = document.querySelector("#sentence");

wordList.addEventListener("click", <span aria-label="annotation1" class="CodeAnnotationCode">❶</span> event =&gt; {
<span aria-label="annotation2" class="CodeAnnotationCode">❷</span> let word = event.target.textContent;
  sentence.textContent += word;
  sentence.textContent += " ";
});
</code></pre>
<p class="CodeListingCaption"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Listing 8-5: Delegating events</samp></p>
<p class="TX">First we look up the two elements we care about using <span class="SANS_TheSansMonoCd_W5Regular_11">document.query Selector</span>: the <span class="SANS_TheSansMonoCd_W5Regular_11">ul</span> with the word list, and the empty <span class="SANS_TheSansMonoCd_W5Regular_11">p</span> element. Next, we add a <span class="SANS_TheSansMonoCd_W5Regular_11">click</span> handler to the <span class="SANS_TheSansMonoCd_W5Regular_11">ul</span> element. This example is a little different from our previous handlers because the callback function has a parameter, which we’re calling <span class="SANS_TheSansMonoCd_W5Regular_11">event</span> <span aria-label="annotation1" class="CodeAnnotationCode">❶</span>. If we give a handler function a single parameter (in this case, <span class="SANS_TheSansMonoCd_W5Regular_11">event</span>, but the exact name isn’t important), the parameter represents an object through which the DOM API passes information about the event that just happened. That information, which includes the element that was clicked, the element’s text content, and so on, then becomes available for use within the callback function.</p>
<p class="TX">In our example, we use the <span class="SANS_TheSansMonoCd_W5Regular_11">event</span> object to determine what word was clicked and store it in the variable <span class="SANS_TheSansMonoCd_W5Regular_11">word</span> <span aria-label="annotation2" class="CodeAnnotationCode">❷</span>. We find out which specific element was clicked with the <span class="SANS_TheSansMonoCd_W5Regular_11">event</span> object’s <span class="SANS_TheSansMonoCd_W5Regular_11">target</span> property. When you click one of the <span class="SANS_TheSansMonoCd_W5Regular_11">li</span> elements, <span class="SANS_TheSansMonoCd_W5Regular_11">event.target</span> will be the <span class="SANS_TheSansMonoCd_W5Regular_11">li</span> element you clicked, not the <span class="SANS_TheSansMonoCd_W5Regular_11">ul</span> (the <span class="SANS_TheSansMonoCd_W5Regular_11">ul</span> element is available with the <span class="SANS_TheSansMonoCd_W5Regular_11">currentTarget</span> property). Then we use the <span class="SANS_TheSansMonoCd_W5Regular_11">textContent</span> property, which returns the text of that element. Putting it together, if you were to click on the first <span class="SANS_TheSansMonoCd_W5Regular_11">li</span> element, then <span class="SANS_TheSansMonoCd_W5Regular_11">event.target.textContent</span> would return the string <span class="SANS_TheSansMonoCd_W5Regular_11">"The"</span>, and that string would become the value of the variable <span class="SANS_TheSansMonoCd_W5Regular_11">word</span>.</p>
<p class="TX">Now that we have the word the user clicked, we can add it to the sentence. We use the <span class="SANS_TheSansMonoCd_W5Regular_11">+=</span> operator to append the word to the text content of the <span class="SANS_TheSansMonoCd_W5Regular_11">sentence</span> element. You may recall that <span class="SANS_TheSansMonoCd_W5Regular_11">sentence.textContent += word;</span> essentially converts to <span class="SANS_TheSansMonoCd_W5Regular_11">sentence.textContent = sentence.textContent + word;</span>. In other words, we’re taking the <span class="SANS_TheSansMonoCd_W5Regular_11">sentence</span> element’s existing text content, adding the string stored in <span class="SANS_TheSansMonoCd_W5Regular_11">word</span> to the end, and reassigning that text to the element’s text content. Then, after adding the word to the sentence, we use the same <span class="SANS_TheSansMonoCd_W5Regular_11">+=</span> trick to append a space to the end of the sentence in preparation for the next word that gets added.</p>
<p class="TX">Open <i>index.html</i> again in your browser. You should see the list of words. You won’t see the empty <span class="SANS_TheSansMonoCd_W5Regular_11">p</span> element because it doesn’t have any content yet. As you click words from the list, you should see them being added to the <span class="SANS_TheSansMonoCd_W5Regular_11">p</span> element.</p>
<p class="TX">To finish off our application, we need to add a small amount of CSS. JavaScript and CSS often go hand in hand because the styling can give helpful tips to the user that certain elements are interactive. In this case we’ll add two hints via CSS: we’ll modify the list items to change the mouse pointer to a finger when it hovers over them, so they look more “clickable,” <span aria-label=" Page 133. " epub:type="pagebreak" id="pg_133" role="doc-pagebreak"/>and we’ll give the element that’s currently under the mouse pointer an underline so it’s easier to tell which word you’re about to click (which isn’t always obvious when the mouse is in the vertical space between words).</p>
<p class="TX">Create a new CSS file called <i>style.css</i> and add the two CSS declarations shown in <a href="#Lis8-6">Listing 8-6</a>.</p>
<span id="Lis8-6"/>
<pre><code>li {
  cursor: pointer;
}

li:hover {
  text-decoration: underline;
}
</code></pre>
<p class="CodeListingCaption"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Listing 8-6: Adding styling in</samp> <samp class="SANS_Futura_Std_Book_11">style.css</samp></p>
<p class="TX">To change the cursor for <span class="SANS_TheSansMonoCd_W5Regular_11">li</span> elements, we use <span class="SANS_TheSansMonoCd_W5Regular_11">cursor: pointer</span>. This changes the cursor from the default arrow to a hand with a finger when it is over an <span class="SANS_TheSansMonoCd_W5Regular_11">li</span> element, as happens when you hover over a link on a web page. The <span class="SANS_TheSansMonoCd_W5Regular_11">li:hover</span> selector uses the <span class="SANS_TheSansMonoCd_W5Regular_11">:hover</span> pseudo-class. A <i>pseudo-class</i> is a kind of selector that applies only when an element is in a certain state: <span class="SANS_TheSansMonoCd_W5Regular_11">li:hover</span> matches any <span class="SANS_TheSansMonoCd_W5Regular_11">li</span> element that the mouse is currently hovering over. When the pointer is over an <span class="SANS_TheSansMonoCd_W5Regular_11">li</span> element, we use <span class="SANS_TheSansMonoCd_W5Regular_11">text-decoration: underline</span> to underline the text of that element.</p>
<p class="TX">To include this CSS on the page, add a <span class="SANS_TheSansMonoCd_W5Regular_11">link</span> element to the <span class="SANS_TheSansMonoCd_W5Regular_11">head</span> of the <i>index.html</i> file, as shown in <a href="#Lis8-7">Listing 8-7</a>.</p>
<span id="Lis8-7"/>
<pre><code><span class="gray">&lt;!DOCTYPE html&gt;</span>
<span class="gray">&lt;html&gt;</span>
<span class="gray">  &lt;</span><span class="gray">head&gt;</span>
<span class="gray">    &lt;title&gt;Event Handlers&lt;/title&gt;</span>
    &lt;link rel="stylesheet" href="style.css"&gt;
<span class="gray">  &lt;/head</span><span class="gray">&gt;</span>
<var>--snip--</var>
</code></pre>
<p class="CodeListingCaption"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Listing 8-7: Including</samp> <samp class="SANS_Futura_Std_Book_11">style.css</samp> <samp class="SANS_Futura_Std_Book_Oblique_I_11">in</samp> <samp class="SANS_Futura_Std_Book_11">index.html</samp></p>
<p class="TX">Now when you hover over one of the list items, the cursor will change, and the currently hovered word will be underlined, as shown in <a href="chapter8.xhtml#fig8-1">Figure 8-1</a>.</p>
<figure class="IMG"><img alt="" class="img6" id="fig8-1" src="../images/Figure_8-1.png"/>
<figcaption><p class="CAP"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Figure 8-1: Using CSS to give hints to users</samp></p></figcaption>
</figure>
<p class="TX"><span aria-label=" Page 134. " epub:type="pagebreak" id="pg_134" role="doc-pagebreak"/>With that styling, our sentence-building application is complete! Event delegation simplified the JavaScript we wrote by letting us attach a single event handler, rather than using a separate handler for each list item.</p>
</section>
</section>
<section aria-labelledby="sec5" epub:type="division">
<h3 class="H1" id="sec5"><span id="h1-43"/><samp class="SANS_Futura_Std_Bold_B_11">Mouse Movement Events</samp></h3>
<p class="TNI1">The DOM produces events when the mouse moves, with the event name <span class="SANS_TheSansMonoCd_W5Regular_11">mousemove</span>. These <span class="SANS_TheSansMonoCd_W5Regular_11">mousemove</span> events are triggered on an element while the mouse moves over that element, and we can listen for them with the <span class="SANS_TheSansMonoCd_W5Regular_11">addEventListener</span> method, just as we did for mouse clicks. Let’s set up a simple <span class="SANS_TheSansMonoCd_W5Regular_11">mousemove</span> handler to see it in action. The handler will log the mouse’s position to the console as the mouse moves around the web page.</p>
<p class="TX">Still working within your <i>chapter8</i> project folder, add the code in <a href="#Lis8-8">Listing 8-8</a> to the end of <i>script.js</i>.</p>
<span id="Lis8-8"/>
<pre><code><var>--snip--</var>
document.querySelector("html").addEventListener("mousemove", e =&gt; {
  console.log(`mousemove x: ${e.clientX}, y: ${e.clientY}`);
});
</code></pre>
<p class="CodeListingCaption"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Listing 8-8: A mousemove event handler</samp></p>
<p class="TX">In this listing, we add a <span class="SANS_TheSansMonoCd_W5Regular_11">mousemove</span> event handler to the <span class="SANS_TheSansMonoCd_W5Regular_11">html</span> element. Since the <span class="SANS_TheSansMonoCd_W5Regular_11">html</span> element encompasses the entire web page, this handler will respond to movements of the mouse anywhere in the browser window. The handler logs a message to the console including the <span class="SANS_TheSansMonoCd_W5Regular_11">clientX</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">clientY</span> properties of the event, which tell us the x- and y-coordinates of the mouse relative to the browser window. In this example I’m using the shorter name <span class="SANS_TheSansMonoCd_W5Regular_11">e</span> for the event parameter, rather than <span class="SANS_TheSansMonoCd_W5Regular_11">event</span>, as in <a href="#Lis8-5">Listing 8-5</a>. Remember, the name of the parameter doesn’t matter; if the event handler callback function has a single parameter, that parameter will carry information about the event.</p>
<p class="TX">Refresh <i>index.html</i> in your browser and move the mouse pointer over the page. You should see messages similar to the following logged to the console:</p>

<pre><code>mousemove x: 434, y: 47
mousemove x: 429, y: 47
mousemove x: 425, y: 48
mousemove x: 421, y: 51
mousemove x: 416, y: 51
mousemove x: 413, y: 54
mousemove x: 408, y: 55
</code></pre>
<p class="TX">There are two important things to note as you watch the console. First, the coordinates start at 0 in the top-left corner of the browser window, increasing as you go across and down. The x-coordinate increases as you move right, and the y-coordinate increases as you move down. This follows the standard convention for computer graphics.</p>
<p class="TX"><span aria-label=" Page 135. " epub:type="pagebreak" id="pg_135" role="doc-pagebreak"/>Second, there are “gaps,” or locations that the mouse appears to jump over. This is because <span class="SANS_TheSansMonoCd_W5Regular_11">mousemove</span> events aren’t triggered continuously, but some limited number of times per second. The exact number depends on the mouse, the browser, and the computer, but it tends to be in the low hundreds. Therefore, if you move the mouse fast enough, there will be locations on the screen that the mouse seems to skip over, because the events weren’t triggering fast enough.</p>
<p class="TX">Now that you’ve seen <span class="SANS_TheSansMonoCd_W5Regular_11">mousemove</span> events in action, we can try to do something slightly more interesting with them. In this next example, we’ll make a box move around the page, following your cursor. To do that we’ll need to modify our HTML, CSS, and JavaScript files. The HTML change is simple. Add the new line in <a href="#Lis8-9">Listing 8-9</a> to <i>index.html</i>.</p>
<span id="Lis8-9"/>
<pre><code><var>--snip--</var>
<span class="gray">    &lt;</span><span class="gray">p id="sentence"&gt;&lt;/p&gt;</span>

    &lt;div id="box"&gt;&lt;/div&gt;

<span class="gray">    &lt;script src="script.js"</span><span class="gray">&gt;&lt;/script&gt;</span>
<span class="gray">  &lt;/body&gt;</span>
<span class="gray">&lt;/html&gt;</span>
</code></pre>
<p class="CodeListingCaption"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Listing 8-9: Adding a div to</samp> <samp class="SANS_Futura_Std_Book_11">index.html</samp></p>
<p class="TX">Here we’re using a new HTML element called <span class="SANS_TheSansMonoCd_W5Regular_11">div</span>, short for <i>content division</i>. It will become the movable box on our page. The <span class="SANS_TheSansMonoCd_W5Regular_11">div</span> element is HTML’s generic container element. This means that it’s an element that can contain other elements, but by default has no appearance and no specific <i>meaning</i> (unlike <span class="SANS_TheSansMonoCd_W5Regular_11">ul</span>, which means a list, or <span class="SANS_TheSansMonoCd_W5Regular_11">h1</span>, which means a heading). We’ll use CSS to give the <span class="SANS_TheSansMonoCd_W5Regular_11">div</span> element an appearance next. Add the contents of <a href="#Lis8-10">Listing 8-10</a> to the end of <i>style.css</i>.</p>
<span id="Lis8-10"/>
<pre><code>--<var>snip</var>--
#box {
  position: fixed;
  left: 0px;
  top: 0px;
  width: 10px;
  height: 10px;
  background-color: hotpink;
}
</code></pre>
<p class="CodeListingCaption"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Listing 8-10: Styling the div with CSS</samp></p>
<p class="TX">Here we’re using <span class="SANS_TheSansMonoCd_W5Regular_11">#box</span> to select the element with the ID <span class="SANS_TheSansMonoCd_W5Regular_11">box</span>. There are a number of declarations within this ruleset. The first, <span class="SANS_TheSansMonoCd_W5Regular_11">position: fixed</span>, tells the browser to put this element at the position specified next, by the <span class="SANS_TheSansMonoCd_W5Regular_11">left</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">top</span> declarations. We indicate <span class="SANS_TheSansMonoCd_W5Regular_11">0px</span> for both, which tells the browser to put the element at the very top-left corner of the browser <i>viewport</i>, the part of the browser that shows the content. We specify the <span class="SANS_TheSansMonoCd_W5Regular_11">width</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">height</span> of the <span aria-label=" Page 136. " epub:type="pagebreak" id="pg_136" role="doc-pagebreak"/>element to be 10 pixels each. Finally, we give our 10×10 box a background color that’s sure to jump out: hot pink.</p>
<p class="TX">Refresh the page now, and you’ll see a small pink square appear in the top-left corner. Now it’s time to write an event handler so you can move the square with your mouse. Modify <i>script.js</i> as shown in <a href="#Lis8-11">Listing 8-11</a>.</p>
<span id="Lis8-11"/>
<pre><code><span class="gray">let wordList = document.querySelector("#word-list");</span>
<span class="gray">let sentence </span><span class="gray">= document.querySelector("#sentence");</span>

<span class="gray">wordList.addEventListener("click", event =&gt; {</span>
<span class="gray">  let word = event.target.textContent;</span>
<span class="gray">  sentence.textContent += word;</span>
<span class="gray">  sentence.textContent += " ";</span>
<span class="gray">});</span>

let box = document.querySelector("#box");

<span class="gray">document.querySelector("html").addEventListener("mousemove", e =&gt; {</span>
  box.style.left = e.clientX + "px";
  box.style.top = e.clientY + "px";
<span class="gray">});</span>
</code></pre>
<p class="CodeListingCaption"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Listing 8-11: Moving the div with JavaScript</samp></p>
<p class="TX">The first addition here is to find the box using <span class="SANS_TheSansMonoCd_W5Regular_11">document.querySelector</span> and save a reference to the element in the variable <span class="SANS_TheSansMonoCd_W5Regular_11">box</span>. Next, we modify the <span class="SANS_TheSansMonoCd_W5Regular_11">mousemove</span> event handler we wrote earlier. In order to move the box around, we’re modifying its <span class="SANS_TheSansMonoCd_W5Regular_11">style</span> property, which is an object representing the CSS applied to the element. For example, setting a value for <span class="SANS_TheSansMonoCd_W5Regular_11">box.style.left</span> has the same effect as updating the value of <span class="SANS_TheSansMonoCd_W5Regular_11">left</span> in the CSS file. In our handler, we set both the <span class="SANS_TheSansMonoCd_W5Regular_11">left</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">top</span> values using the current position of the mouse.</p>
<p class="TX">As mentioned in <a href="chapter7.xhtml">Chapter 7</a>, numeric values in CSS require a unit. We can’t just assign a number, like <span class="SANS_TheSansMonoCd_W5Regular_11">box.style.left = 10</span>. Instead, we have to provide a string including the units, like <span class="SANS_TheSansMonoCd_W5Regular_11">box.style.left = "10px"</span>. This is why we include <span class="SANS_TheSansMonoCd_W5Regular_11">+ "px"</span> at the end of each statement in our event handler. If <span class="SANS_TheSansMonoCd_W5Regular_11">e.clientX</span> is <span class="SANS_TheSansMonoCd_W5Regular_11">50</span>, then <span class="SANS_TheSansMonoCd_W5Regular_11">e.clientX + "px"</span> will give the string <span class="SANS_TheSansMonoCd_W5Regular_11">"50px"</span>, which gets assigned to the <span class="SANS_TheSansMonoCd_W5Regular_11">box.style.left</span> property, updating the left position of the box. As the mouse moves, this handler will be called with <span class="SANS_TheSansMonoCd_W5Regular_11">e.clientX</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">e.clientY</span> set to the current position of the mouse, and so the pink box will move around as your mouse moves. Refresh the page and give it a try!</p>
<section aria-labelledby="sec6" epub:type="division">
<aside aria-label="box-27" class="box" id="sec6">
<h4 class="BH" id="box-27"><samp class="SANS_Dogma_OT_Bold_B_11">TRY IT YOURSELF</samp></h4>
<p class="BoxListNumber"><samp class="SANS_Futura_Std_Bold_B_11">  8-2.</samp><samp class="SANS_Futura_Std_Book_11">  What happens if you modify the values that set the box’s position? For example, what would happen if you multiplied</samp> <span class="SANS_TheSansMonoCd_W5Regular_11">e.clientX</span> <samp class="SANS_Futura_Std_Book_11">by 2, or added 50 to</samp> <span class="SANS_TheSansMonoCd_W5Regular_11">e.clientY</span><samp class="SANS_Futura_Std_Book_11">?</samp></p>
</aside>
</section>
</section>
<section aria-labelledby="sec7" epub:type="division">
<h3 class="H1" id="sec7"><span id="h1-44"/><span aria-label=" Page 137. " epub:type="pagebreak" id="pg_137" role="doc-pagebreak"/><samp class="SANS_Futura_Std_Bold_B_11">Keyboard Events</samp></h3>
<p class="TNI1">Keyboard events are triggered when keys are pressed on the keyboard. We’ll focus on one keyboard event, called <span class="SANS_TheSansMonoCd_W5Regular_11">keydown</span>, which is triggered when a key is pressed down. (As you might expect, there’s a corresponding event called <span class="SANS_TheSansMonoCd_W5Regular_11">keyup</span> that is triggered when a key is released.)</p>
<p class="TX">We’ll add a handler to our web page that simply logs <span class="SANS_TheSansMonoCd_W5Regular_11">keydown</span> events to the console as they happen. Add the code in <a href="#Lis8-12">Listing 8-12</a> to the end of <i>script.js</i>.</p>
<span id="Lis8-12"/>
<pre><code><var>--snip--</var>
document.querySelector("html").addEventListener("keydown", e =&gt; {
  console.log(e);
});
</code></pre>
<p class="CodeListingCaption"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Listing 8-12: Logging keydown events</samp></p>
<p class="TX">As in <a href="#Lis8-11">Listing 8-11</a>, we’re adding an event handler to the <span class="SANS_TheSansMonoCd_W5Regular_11">html</span> element, meaning it will apply to the entire web page, but this time we’re handling the <span class="SANS_TheSansMonoCd_W5Regular_11">keydown</span> event. This event will be triggered whenever you press down a key on your keyboard. Our handler logs <span class="SANS_TheSansMonoCd_W5Regular_11">e</span> to the console, meaning the entire <span class="SANS_TheSansMonoCd_W5Regular_11">event</span> object will be logged when a key is pressed.</p>
<p class="TX">Try reloading the page to see the handler in action. You’ll need to open the console, then click inside the document to give it <i>focus</i>. This just means that the key presses will get sent to your web page, instead of to the console’s text input. As long as everything’s set up correctly, you should see events being logged to the console as you type, as shown here:</p>

<pre><code><span class="code_MenuArrow"></span>KeyboardEvent {isTrusted: true, key: "h", code: "KeyH", location: 0, ctrlKey: false, …}
<span class="codewide_MenuArrow"><span class="code_MenuArrow"></span></span>KeyboardEvent {isTrusted: true, key: "e", code: "KeyE", location: 0, ctrlKey: false, …}
<span class="codewide_MenuArrow"><span class="code_MenuArrow"></span></span>KeyboardEvent {isTrusted: true, key: "l", code: "KeyL", location: 0, ctrlKey: false, …}
<span class="codewide_MenuArrow"><span class="code_MenuArrow"></span></span>KeyboardEvent {isTrusted: true, key: "l", code: "KeyL", location: 0, ctrlKey: false, …}
<span class="code_MenuArrow"></span>KeyboardEvent {isTrusted: true, key: "o", code: "KeyO", location: 0, ctrlKey: false, …}
</code></pre>
<p class="TX">Click the arrow next to one of the events to see the properties each event has. As you’ll see, there are a lot, but we mostly care about which key was pressed, which we can find with the <span class="SANS_TheSansMonoCd_W5Regular_11">key</span> property. We’ll use this information next to move the pink box around using the keyboard.</p>
<p class="TX">In order to move the box around, we’ll create two new variables to keep track of its x- and y-positions. Then we’ll update those variables with an event handler when specific keys are pressed. Update <i>script.js</i> as shown in <a href="#Lis8-13">Listing 8-13</a>. (Note that the <span class="SANS_TheSansMonoCd_W5Regular_11">mousemove</span> handler has been removed in this listing.)</p>
<span id="Lis8-13"/>
<pre><code><span class="gray">let wordList = document.querySelector("#word-list");</span>
<span class="gray">let sentence = document.querySelector("#sentence");</span>

<span class="gray">wordList.addEventListener("click", event =&gt; {</span>
<span class="gray">  let word = event.target.textContent;</span>
<span class="gray">  sentence.textContent += word;</span>
<span class="gray">  sentence.textContent += " ";</span>
<span class="gray">});</span>

<span aria-label=" Page 138. " epub:type="pagebreak" id="pg_138" role="doc-pagebreak"/><span class="gray">let box = document.querySelector("#box");</span>

let currentX = 0
let currentY = 0

<span class="gray">document.querySelector("html").addEventListener("keydown", e =&gt; {</span>
  if (e.key == "w") {
    currentY -= 5;
  } else if (e.key == "a") {
    currentX -= 5;
  } else if (e.key == "s") {
    currentY += 5;
  } else if (e.key == "d") {
    currentX += 5;
<span class="gray">  }</span>

  box.style.left = currentX + "px";
  box.style.top = currentY + "px";
});
</code></pre>
<p class="CodeListingCaption"><samp class="SANS_Futura_Std_Book_Oblique_I_11">Listing 8-13: Using keydown events to move the box</samp></p>
<p class="TX">We create two variables called <span class="SANS_TheSansMonoCd_W5Regular_11">currentX</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">currentY</span> to store the location of the box. Then we modify our <span class="SANS_TheSansMonoCd_W5Regular_11">keydown</span> handler to include an <span class="SANS_TheSansMonoCd_W5Regular_11">if…else</span> statement that checks to see if the event’s <span class="SANS_TheSansMonoCd_W5Regular_11">key</span> property matches any of <span class="SANS_TheSansMonoCd_W5Regular_11">"w"</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">"a"</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">"s"</span>, or <span class="SANS_TheSansMonoCd_W5Regular_11">"d"</span>. If so, that indicates one of those four keys has been pressed (I’m using these keys as they’re typically used for movement in games). Depending on which key has been pressed, we add or subtract <span class="SANS_TheSansMonoCd_W5Regular_11">5</span> to or from <span class="SANS_TheSansMonoCd_W5Regular_11">currentX</span> or <span class="SANS_TheSansMonoCd_W5Regular_11">currentY</span>, corresponding to the box moving 5 pixels up, down, left, or right. After we update the appropriate variable, we update the style of the box with <span class="SANS_TheSansMonoCd_W5Regular_11">box.style.left</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">box.style.top</span>, as we did in <a href="#Lis8-11">Listing 8-11</a>. This time, however, we use the values of <span class="SANS_TheSansMonoCd_W5Regular_11">currentX</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">currentY</span> to change the CSS.</p>
<p class="TX">When you reload the page, try pressing and holding down <span class="KeyCaps">S</span> or <span class="KeyCaps">D</span> to make the box move down or to the right. You should notice that holding the key down results in the box continuing to move, as the keyboard sends repeated <span class="SANS_TheSansMonoCd_W5Regular_11">keydown</span> events. This is the normal behavior of a computer keyboard when you hold down a key. The exact repeat speed is controlled by your operating system.</p>
<section aria-labelledby="sec8" epub:type="division">
<aside aria-label="box-28" class="box" id="sec8">
<h4 class="BH" id="box-28"><samp class="SANS_Dogma_OT_Bold_B_11">TRY IT YOURSELF</samp></h4>
<p class="BoxListNumber"><samp class="SANS_Futura_Std_Bold_B_11">  8-3.</samp><samp class="SANS_Futura_Std_Book_11">  The</samp> <span class="SANS_TheSansMonoCd_W5Regular_11">event</span> <samp class="SANS_Futura_Std_Book_11">object for a</samp> <span class="SANS_TheSansMonoCd_W5Regular_11">keydown</span> <samp class="SANS_Futura_Std_Book_11">event has a Boolean property called</samp> <span class="SANS_TheSansMonoCd_W5Regular_11">repeat</span> <samp class="SANS_Futura_Std_Book_11">that tells you if the current</samp> <span class="SANS_TheSansMonoCd_W5Regular_11">keydown</span> <samp class="SANS_Futura_Std_Book_11">was generated as a repeat from holding down the key. How could you modify the</samp> <span class="SANS_TheSansMonoCd_W5Regular_11">keydown</span> <samp class="SANS_Futura_Std_Book_11">handler to respond only to actual key presses, and not automatic repeats? Hint: one approach is to use the</samp> <span class="SANS_TheSansMonoCd_W5Regular_11">return</span> <samp class="SANS_Futura_Std_Book_11">keyword to return early from the handler function.</samp></p>
</aside>
</section>
</section>
<section aria-labelledby="sec9" epub:type="division">
<h3 class="H1" id="sec9"><span id="h1-45"/><span aria-label=" Page 139. " epub:type="pagebreak" id="pg_139" role="doc-pagebreak"/><samp class="SANS_Futura_Std_Bold_B_11">Summary</samp></h3>
<p class="TNI1">In this chapter you learned the basics of DOM events and event handling. DOM events are how the browser tells your code that something happened on your page. You can respond to these events with event handlers, JavaScript functions that are executed when a certain event happens to a certain DOM element. Event handlers allow you to create web pages that respond interactively to the user’s actions. In particular, you saw how to write event handlers triggered by clicks, mouse movements, and key presses.</p>
</section>
</section>
</body>
</html>