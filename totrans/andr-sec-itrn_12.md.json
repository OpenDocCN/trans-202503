["```\n# **getenforce**\nEnforcing\n# **setenforce 0**\n# **getenforce**\nPermissive\n```", "```\n# **ps -Z**\nLABEL                                   USER    PID    PPID     NAME\nu:r:init:s0➊                            root    1      0        /init\nu:r:kernel:s0                           root    2      0        kthreadd\nu:r:kernel:s0                           root    3      2        ksoftirqd/0\n--*snip*--\nu:r:healthd:s0➋              root    175    1        /sbin/healthd\nu:r:servicemanager:s0➌       system  176    1        /system/bin/\nservicemanager\nu:r:vold:s0➍                 root    177    1        /system/bin/vold\nu:r:init:s0                             nobody  178    1        /system/bin/rmt_storage\nu:r:netd:s0                             root    179    1        /system/bin/netd\nu:r:debuggerd:s0                        root    180    1        /system/bin/debuggerd\nu:r:rild:s0                             radio   181    1        /system/bin/rild\n--*snip*--\nu:r:platform_app:s0                     u0_a12  950    183      com.android.systemui\nu:r:media_app:s0                        u0_a5   1043   183      android.process.media\nu:r:radio:s0                            radio   1141   183      com.android.phone\nu:r:nfc:s0                              nfc     1163   183      com.android.nfc\nu:r:untrusted_app:s0                    u0_a7   1360   183      com.google.android.gms\n--*snip*--\n```", "```\n# **ls -Z**\ndrwxr-xr-x root        root              u:object_r:cgroup:s0 acct\ndrwxrwx--- system      cache             u:object_r:cache_file:s0 cache\n-rwxr-x--- root        root              u:object_r:rootfs:s0 charger\n--*snip*--\ndrwxrwx--x system      system            u:object_r:system_data_file:s0 data\n-rw-r--r-- root        root              u:object_r:rootfs:s0 default.prop\ndrwxr-xr-x root        root              u:object_r:device:s0 dev\nlrwxrwxrwx root        root              u:object_r:rootfs:s0 etc -> /system/etc\n-rw-r--r-- root        root              u:object_r:rootfs:s0 file_contexts\ndr-xr-x--- system      system            u:object_r:sdcard_external:s0 firmware\n-rw-r----- root        root              u:object_r:rootfs:s0 fstab.hammerhead\n-rwxr-x--- root        root              u:object_r:rootfs:s0 init\n--*snip*--\n```", "```\nattribute file_type;➊\nattribute domain;➋\n\ntype system_data_file, file_type, data_file_type;➌\ntype untrusted_app, domain;➍\n```", "```\nuser u roles { r } level s0 range s0 - mls_systemhigh;\n```", "```\nrole r;➊\nrole r types domain;➋\n```", "```\ntype adbd, domain;\npermissive adbd;➊\n--*snip*--\n```", "```\n--*snip*--\n# file-related classes\nclass filesystem\nclass file\nclass dir\nclass fd\nclass lnk_file\nclass chr_file\nclass blk_file\nclass sock_file\nclass fifo_file\n--*snip*--\n```", "```\n--*snip*--\ncommon file\n{\n    ioctl\n    read\n\n    write\n    create\n    getattr\n    setattr\n    lock\n    --*snip*--\n}➊\n--*snip*--\nclass dir\ninherits file\n{\n\n    add_name\n    remove_name\n    reparent\n    search\n    rmdir\n    --*snip*--\n}➋\n--*snip*--\n```", "```\n# wpa - wpa supplicant or equivalent\ntype wpa, domain;\npermissive wpa;➊\ntype wpa_exec, exec_type, file_type;\n\ninit_daemon_domain(wpa)➋\nunconfined_domain(wpa)➌\ntype_transition wpa wifi_data_file:sock_file wpa_socket;➍\n```", "```\n# domain_trans(olddomain, type, newdomain)\ndefine(`domain_trans', `\nallow $1 $2:file { getattr open read execute };\nallow $1 $3:process transition;\nallow $3 $2:file { entrypoint read execute };\nallow $3 $1:process sigchld;\ndontaudit $1 $3:process noatsecure;\nallow $1 $3:process { siginh rlimitinh };\n')➊\n# domain_auto_trans(olddomain, type, newdomain)\ndefine(`domain_auto_trans', `\ndomain_trans($1,$2,$3)\ntype_transition $1 $2:process $3;\n')➋\n# init_daemon_domain(domain)\n define(`init_daemon_domain', `\ndomain_auto_trans(init, $1_exec, $1)\ntmpfs_domain($1)\n')➌\n--*snip*--\n```", "```\nrule_name source_type target_type : class perm_set;\n```", "```\ntype vold, domain;\ntype vold_exec, exec_type, file_type;\ninit_daemon_domain(vold)\n--*snip*--\nallow vold sdcard_type:filesystem { mount remount unmount };➊\n--*snip*--\nallow vold self:capability { sys_ptrace kill };➋\n--*snip*--\n```", "```\ntype installd, domain;\n--*snip*--\ndontaudit installd self:capability sys_admin;➊\n--*snip*--\n```", "```\n--*snip*--\nneverallow { domain -init } kernel:security load_policy;\n```", "```\n--*snip*--\nint security_binder_set_context_mgr(struct task_struct *mgr);➊\nint security_binder_transaction(struct task_struct *from,\n                                struct task_struct * to);➋\nint security_binder_transfer_binder(struct task_struct *from,\n                                    struct task_struct *to);➌\nint security_binder_transfer_file(struct task_struct *from,\n                                  struct task_struct *to, struct file *file);➍\n--*snip*--\n```", "```\n--*snip*--\nstruct security_class_mapping secclass_map[] = {\n    --*snip*--\n    {\"binder\", {\"impersonate\", \"call\", \"set_context_mgr\", \"transfer\", NULL} },\n    { NULL }\n  };\n```", "```\n--*snip*--\non early-init\n    --*snip*--\n    setcon u:r:init:s0➊\n    start ueventd\n--*snip*--\non post-fs-data\n    chown system system /data\n    chmod 0771 /data\n    restorecon /data➋\n--*snip*--\nservice ueventd /sbin/ueventd\n    class core\n    critical\n    seclabel u:r:ueventd:s0➌\n--*snip*--\non property:selinux.reload_policy=1➍\n    restart ueventd\n    restart installd\n--*snip*--\n```", "```\n/                            u:object_r:rootfs:s0➊\n/adb_keys                    u:object_r:rootfs:s0\n/default.prop                u:object_r:rootfs:s0\n/fstab\\..*                   u:object_r:rootfs:s0\n--*snip*--\n/dev(/.*)?                   u:object_r:device:s0➋\n/dev/akm8973.*               u:object_r:akm_device:s0\n/dev/accelerometer           u:object_r:accelerometer_device:s0\n--*snip*--\n/system(/.*)?                u:object_r:system_file:s0➌\n/system/bin/ash              u:object_r:shell_exec:s0\n/system/bin/mksh             u:object_r:shell_exec:s0\n--*snip*--\n/data(/.*)?                  u:object_r:system_data_file:s0➍\n/data/backup(/.*)?           u:object_r:backup_data_file:s0\n/data/secure/backup(/.*)?    u:object_r:backup_data_file:s0\n--*snip*--\n```", "```\ntype vold, domain;\n--*snip*--\nallow vold vold_prop:property_service set;➊\nallow vold powerctl_prop:property_service set;➋\nallow vold ctl_default_prop:property_service set;➌\n--*snip*--\n```", "```\n--*snip*--\nvold.                     u:object_r:vold_prop:s0➊\nsys.powerctl              u:object_r:powerctl_prop:s0➋\nctl.                      u:object_r:ctl_default_prop:s0➌\n--*snip*--\n```", "```\nisSystemServer=true domain=system➊\nuser=system domain=system_app type=system_data_file➋\nuser=bluetooth domain=bluetooth type=bluetooth_data_file\nuser=nfc domain=nfc type=nfc_data_file\nuser=radio domain=radio type=radio_data_file\nuser=_app domain=untrusted_app type=app_data_file levelFrom=none➌\nuser=_app seinfo=platform domain=platform_app type=platform_app_data_file➍\nuser=_app seinfo=shared domain=shared_app type=platform_app_data_file➎\nuser=_app seinfo=media domain=media_app type=platform_app_data_file\nuser=_app seinfo=release domain=release_app type=platform_app_data_file\nuser=_isolated domain=isolated_app➏\nuser=shell domain=shell type=shell_data_file\n```", "```\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<policy>\n\n    <!-- Platform dev key in AOSP -->\n    <signer signature=\"@PLATFORM\" >➊\n      <seinfo value=\"platform\" />\n    </signer>\n\n    <!-- Media dev key in AOSP -->\n    <signer signature=\"@MEDIA\" >➋\n      <seinfo value=\"media\" />\n    </signer>\n\n    <!-- shared dev key in AOSP -->\n    <signer signature=\"@SHARED\" >➌\n      <seinfo value=\"shared\" />\n    </signer>\n\n    <!-- release dev key in AOSP -->\n    <signer signature=\"@RELEASE\" >➍\n      <seinfo value=\"release\" />\n    </signer>\n\n    <!-- All other keys -->\n    <default>➎\n      <seinfo value=\"default\" />\n    </default>\n\n</policy>\n```", "```\n# **dmesg |grep 'avc:'**\n--*snip*--\n<5>[18743.725707] type=1400 audit(1402061801.158:256): avc: denied { getattr\n} for pid=9574 comm=\"zygote\" path=\"socket:[8692]\" dev=\"sockfs\" ino=8692\nscontext=u:r:untrusted_app:s0 tcontext=u:r:zygote:s0 tclass=unix_stream_socket\n--*snip*--\n```", "```\n$**seinfo sepolicy**\n\nStatistics for policy file: sepolicy\nPolicy Version & Type: v.26 (binary, mls)\n\n   Classes:                84    Permissions:     249\n   Sensitivities:           1    Categories:     1024\n   Types:                 267    Attributes:       21\n   Users:                   1    Roles:             2\n   Booleans:                1    Cond. Expr.:       1\n   Allow:                1140    Neverallow:        0\n   Auditallow:              0    Dontaudit:        36\n   Type_trans:            132    Type_change:       0\n   Type_member:             0    Role allow:        0\n   Role_trans:              0    Range_trans:       0\n   Constraints:            63    Validatetrans:     0\n   Initial SIDs:           27    Fs_use:           14\n   Genfscon:               10    Portcon:           0\n   Netifcon:                0    Nodecon:           0\n   Permissives:            42    Polcap:            2\n```", "```\n$ **seinfo -adomain -x sepolicy**\n   domain\n      nfc\n      platform_app\n      media_app\n      clatd\n      netd\n      sdcardd\n      zygote\n--*snip*--\n```", "```\n$**sesearch --allow -s zygote -d sepolicy**\nFound 40 semantic av rules:\n   allow zygote zygote_exec : file { read execute execute_no_trans entrypoint open } ;\n   allow zygote init : process sigchld ;\n   allow zygote rootfs : file { ioctl read getattr lock open } ;\n   allow zygote rootfs : dir { ioctl read getattr mounton search open } ;\n   allow zygote tmpfs : filesystem mount ;\n   allow zygote tmpfs : dir { write create setattr mounton add_name search } ;\n--*snip*--\n```", "```\ntype installd, domain;\ntype installd_exec, exec_type, file_type;\n\ninit_daemon_domain(installd)➊\nrelabelto_domain(installd)➋\ntypeattribute installd mlstrustedsubject;➌\nallow installd self:capability { chown dac_override fowner fsetid setgid setuid };➍\n--*snip*--\nallow installd dalvikcache_data_file:file create_file_perms;➎\nallow installd data_file_type:dir create_dir_perms;➏\nallow installd data_file_type:dir { relabelfrom relabelto };➐\nallow installd data_file_type:{ file_class_set } { getattr unlink };➑\nallow installd apk_data_file:file r_file_perms;➒\n--*snip*--\nallow installd system_file:file x_file_perms;➓\n--*snip*--\n```", "```\nallow unconfineddomain self:capability_class_set *;➊\nallow unconfineddomain kernel:security ~load_policy;➋\nallow unconfineddomain kernel:system *;\nallow unconfineddomain self:memprotect *;\nallow unconfineddomain domain:process *;➌\nallow unconfineddomain domain:fd *;\nallow unconfineddomain domain:dir r_dir_perms;\nallow unconfineddomain domain:lnk_file r_file_perms;\nallow unconfineddomain domain:{ fifo_file file } rw_file_perms;\nallow unconfineddomain domain:socket_class_set *;\nallow unconfineddomain domain:ipc_class_set *;\nallow unconfineddomain domain:key *;\nallow unconfineddomain fs_type:filesystem *;\nallow unconfineddomain {fs_type dev_type file_type}:{ dir blk_file lnk_file sock_file fifo_file\n} ~relabelto;\nallow unconfineddomain {fs_type dev_type file_type}:{ chr_file file } ~{entrypoint relabelto};\nallow unconfineddomain node_type:node *;\nallow unconfineddomain node_type:{ tcp_socket udp_socket rawip_socket } node_bind;\nallow unconfineddomain netif_type:netif *;\nallow unconfineddomain port_type:socket_class_set name_bind;\nallow unconfineddomain port_type:{ tcp_socket dccp_socket } name_connect;\nallow unconfineddomain domain:peer recv;\nallow unconfineddomain domain:binder { call transfer set_context_mgr };\nallow unconfineddomain property_type:property_service set;\n```", "```\n--*snip*--\nallow appdomain zygote:fd use;➊\nallow appdomain zygote_tmpfs:file read;➋\n--*snip*--\nallow appdomain system:fifo_file rw_file_perms;\nallow appdomain system:unix_stream_socket { read write setopt };\nbinder_call(appdomain, system)➌\n\nallow appdomain surfaceflinger:unix_stream_socket { read write setopt };\nbinder_call(appdomain, surfaceflinger)➍\n\nallow appdomain app_data_file:dir create_dir_perms;\nallow appdomain app_data_file:notdevfile_class_set create_file_perms;➎\n--*snip*--\n```", "```\ntype untrusted_app, domain;\npermissive untrusted_app;➊\napp_domain(untrusted_app)➋\nnet_domain(untrusted_app)➌\nbluetooth_domain(untrusted_app)➍\n\nallow untrusted_app tun_device:chr_file rw_file_perms;➎\n\nallow untrusted_app sdcard_internal:dir create_dir_perms;\nallow untrusted_app sdcard_internal:file create_file_perms;➏\n\nallow untrusted_app sdcard_external:dir create_dir_perms;\nallow untrusted_app sdcard_external:file create_file_perms;➐\n\nallow untrusted_app asec_apk_file:dir { getattr };\nallow untrusted_app asec_apk_file:file r_file_perms;➑\n--*snip*--\n```"]