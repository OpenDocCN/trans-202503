<html><head></head><body>
<div id="sbo-rt-content"><section aria-labelledby="ch22" epub:type="chapter" role="doc-chapter">
<span aria-label="427" epub:type="pagebreak" id="pg_427" role="doc-pagebreak"/>
<hgroup>
<h2 class="CHAPTER" id="ch22">
<span class="CN"><span class="SANS_Futura_Std_Bold_Condensed_B_11">22</span></span>
<span class="CT"><span class="SANS_Dogma_OT_Bold_B_11">STRUCTURING AN OBJECT-ORIENTED WEB APPLICATION</span></span>
</h2>
</hgroup>
<figure class="opener"><img alt="" class="opener" height="380" src="../images/opener.jpg" width="380"/>
</figure>
<p class="INTRO">In the preceding chapter, we used object- oriented PHP code to create a simple two-page website controlled from an <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class. In this chapter, we’ll revisit that website and explore how to further leverage OOP techniques to improve its structure. You’ll learn how to use multiple classes to compartmentalize the application logic, and you’ll see how inheritance can help share code among those classes to cut down on redundancy.</p>
<p class="TX">Dividing the application logic across multiple classes will help make the site more manageable. This may seem trivial for a two-page website, but imagine if the site grew to include tens, hundreds, or thousands of pages. The <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class would quickly become unwieldy. It would be imperative to organize the code into different types of actions and assign those actions to different classes.</p>
<p class="TX"><span aria-label="428" epub:type="pagebreak" id="pg_428" role="doc-pagebreak"/>For our application in <span class="Xref"><a href="chapter21.xhtml">Chapter 21</a></span>, two main types of actions need to be performed. The first is deciding what to do when a request comes into the web server. We can assign this task to a front-controller class that will examine each incoming request, including its URL pattern and any data variables received, and decide which type of page is appropriate to be returned to the web client.</p>
<p class="TX">The other main action is displaying the requested page. We can assign this task to a range of page-generating controller classes. One such class might be designed for displaying basic pages (such as home and Contact Us), another for displaying pages with security features like logging in and updating passwords, another for product listings, and so on. Each of these page-controller classes can operate knowing that the front controller has already made the decision to return the appropriate page.</p>
<section aria-labelledby="sec1" epub:type="division">
<h3 class="H1" id="sec1"><span id="toc-link_303"/><span class="SANS_Futura_Std_Bold_B_11">Separating Display and Front-Controller Logic</span></h3>
<p class="TNI1">Let’s start the process of improving our application architecture by separating the front-controller decision logic (in the <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class) from the basic page-generation actions for the home page and Contact Us page. We’ll move the latter into a new class called <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span>. The name reflects that the home page is the default page displayed when the URL pattern <span class="SANS_TheSansMonoCd_W5Regular_11">/</span> is requested, but the class could also reasonably be named <span class="SANS_TheSansMonoCd_W5Regular_11">BasicPageController</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">HomePageController</span>, or something similar.</p>
<p class="TX">Copy <i>src/Application.php</i>, name the copy <i>src/DefaultController.php</i>, and delete the <span class="SANS_TheSansMonoCd_W5Regular_11">run()</span> method from this new <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span> class. Also make the <span class="SANS_TheSansMonoCd_W5Regular_11">homepage()</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">contactUs()</span> methods public so that they can still be called from the <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class. After these changes, the file should match <a href="#lis22-1">Listing 22-1</a>.</p>
<span id="lis22-1"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">namespace Mattsmithdev;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">use \Twig\Loader\FilesystemLoader;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">use \Twig\Environment;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">class</span> DefaultController&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">{</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    const PATH_TO_TEMPLATES = __DIR__ . '/../templates';</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    private Environment $twig;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    public function __construct()</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $loader = new FilesystemLoader(self::PATH_TO_TEMPLATES);</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $this-&gt;twig = new Environment($loader);</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
&#13;
    public <span class="TheSansMonoCd_W5Regular_Grey_11">function homepage()</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $template = 'homepage.xhtml.twig';</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $args = [];</span>&#13;
&#13;
<span aria-label="429" epub:type="pagebreak" id="pg_429" role="doc-pagebreak"/><span class="TheSansMonoCd_W5Regular_Grey_11">        $html = $this-&gt;twig-&gt;render($template, $args);</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        print $html;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
&#13;
    public <span class="TheSansMonoCd_W5Regular_Grey_11">function contactUs()</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $template = 'contactUs.xhtml.twig';</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $args = [];</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $html = $this-&gt;twig-&gt;render($template, $args);</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        print $html;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">}</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 22-1: Declaring the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">DefaultController</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p>
<p class="TX">This new <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span> class has a constant for the path to the template files, a <span class="SANS_TheSansMonoCd_W5Regular_11">twig</span> property for rendering the templates, a constructor method, and <span class="SANS_TheSansMonoCd_W5Regular_11">homepage()</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">contactUs()</span> methods for displaying the two pages of the web application.</p>
<p class="TX">Now that we’ve encapsulated the logic for displaying the web pages in a separate class, we can simplify the <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class to focus only on deciding which page to display. All we need to keep in <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> is the <span class="SANS_TheSansMonoCd_W5Regular_11">run()</span> method, which will determine which page to display and invoke the corresponding <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span> method. Update <i>src/Application.php</i> as shown in <a href="#lis22-2">Listing 22-2</a>.</p>
<span id="lis22-2"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">namespace Mattsmithdev;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">class Application</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">{</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    public function run(): void</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $defaultController = new DefaultController();</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $action = filter_input(INPUT_GET, 'action');</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        switch ($action) {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">            case 'contact':</span>&#13;
              <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> $defaultController-&gt;contactUs();&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">                break;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">            case 'home':</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">            default:</span>&#13;
              <span aria-label="annotation2" class="Code_CodeAnnotation">❷</span> $defaultController-&gt;homepage();&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        }</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">}</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 22-2: The simplified</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Application</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p>
<p class="TX">Our updated <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class’s only content, the <span class="SANS_TheSansMonoCd_W5Regular_11">run()</span> method, begins by creating a new <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span> object. Then, in the <span class="SANS_TheSansMonoCd_W5Regular_11">switch</span> statement, we invoke either that object’s <span class="SANS_TheSansMonoCd_W5Regular_11">contactUs()</span> method <span aria-label="annotation1" class="CodeAnnotation">❶</span> or <span class="SANS_TheSansMonoCd_W5Regular_11">homepage()</span> method <span aria-label="annotation2" class="CodeAnnotation">❷</span> <span aria-label="430" epub:type="pagebreak" id="pg_430" role="doc-pagebreak"/>to display the appropriate page based on the action received in the HTTP request.</p>
<p class="TX">In this new arrangement, <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> is functioning as a true front controller: it receives requests from the client and decides how to respond. Meanwhile, the code that generates and prints a response has been delegated to the <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span> class. For our simple two-page site, this may seem like software architecture overkill, but for more sophisticated websites, this separation of front-controller logic from page-generation logic means that when we add methods for many pages, we won’t end up with a single, overcrowded <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class trying to do too many things.</p>
<p class="TX">For example, say we have some pages that can be accessed only by a logged-in user. We could encapsulate the methods for displaying these pages in a <span class="SANS_TheSansMonoCd_W5Regular_11">SecureActions</span> controller class. Then we would check whether the user is logged in within the front-controller <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class and invoke methods of <span class="SANS_TheSansMonoCd_W5Regular_11">SecureActions</span> only if the user is logged in. Otherwise, we could offer the user an error page or login page as appropriate.</p>
<p class="TX">Another example of the value of separating front-controller actions from page controllers is testing the incoming URL patterns for data parameters. Let’s say some of the pages of our website display news items by using a <span class="SANS_TheSansMonoCd_W5Regular_11">NewsItem</span> page controller class. The methods of this class need the ID of the news item to be retrieved from a database or file store, based on a URL pattern such as <i>/?action=news&amp;id=&lt;id&gt;</i>. In this case, our front controller can check for an integer ID along with the <span class="SANS_TheSansMonoCd_W5Regular_11">news</span> action, then pass that ID to an appropriate <span class="SANS_TheSansMonoCd_W5Regular_11">NewsItem</span> object method. If no such integer ID is found in the URL, we can offer the user an error page instead.</p>
<p class="TX">In both of these examples, the methods in the page-controller classes can be written knowing that any required checks and decisions (determining whether the user is logged in or retrieving a news item ID) have already taken place and been satisfied. We’re separating the decision of <i>what to do</i> (the front controller) from the actions that define <i>how we do it</i> (the page-controller class methods).</p>
</section>
<section aria-labelledby="sec2" epub:type="division">
<h3 class="H1" id="sec2"><span id="toc-link_304"/><span class="SANS_Futura_Std_Bold_B_11">Using Multiple Controller Classes</span></h3>
<p class="TNI1">Our <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span> class works well for displaying simple pages with static content such as the home page, but pages with other features would benefit from being organized within their own specialized controller classes. For example, an e-commerce site would likely have several kinds of pages related to products: a list of all available products, search results showing products that match a particular user query, pages showing the details of a single product, and so on. Each of these pages would likely need a way of interacting with objects of a <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span> class, perhaps passed to the page templates in a <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> array or a single <span class="SANS_TheSansMonoCd_W5Regular_11">$product</span> object.</p>
<p class="TX">Our <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span> class isn’t currently equipped to handle these kinds of product-related operations. We could extend and modify the class, but a more logical approach would be to create a separate <span class="SANS_TheSansMonoCd_W5Regular_11">ProductController</span> class to handle the specialized operations required to display pages related <span aria-label="431" epub:type="pagebreak" id="pg_431" role="doc-pagebreak"/>to products. Similarly, pages that include login forms might have their own <span class="SANS_TheSansMonoCd_W5Regular_11">LoginController</span> class, pages for displaying and editing a shopping cart would have their own <span class="SANS_TheSansMonoCd_W5Regular_11">CartController</span> class, and so on.</p>
<p class="TX">To illustrate the benefit of multiple controller classes, and to demonstrate how easy it is to add more pages and sections to an object-oriented web application, we’ll add a Product List page to our website, as shown in <a href="#fig22-1">Figure 22-1</a>, and we’ll create a <span class="SANS_TheSansMonoCd_W5Regular_11">ProductController</span> class for displaying this page.</p>
<figure class="IMG"><a id="fig22-1"/><img alt="" class="img100" height="1066" src="../images/figure22-1.jpg" width="1691"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 22-1: The Product List page we’ll create</span></p></figcaption>
</figure>
<p class="TX">Our new page will display the name and price of a collection of products, where each product is an instance (object) of a <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span> class. Using Twig template inheritance, we’ll give the page the same navigation bar and header content as the other pages of the website. We’ll coordinate the page’s display from our new <span class="SANS_TheSansMonoCd_W5Regular_11">ProductController</span> class, which will be designed specifically to gather <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span> objects in an array that can be passed to the Twig template.</p>
<p class="TX">To build the new page, we’ll first create the <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span> class to represent each product’s name and price. Create a new file, <i>src/Product.php</i>, containing the code in <a href="#lis22-3">Listing 22-3</a>.</p>
<span id="lis22-3"/>
<pre><code>&lt;?php&#13;
namespace Mattsmithdev;&#13;
&#13;
class Product&#13;
{&#13;
    public string $name;&#13;
    public float $price;&#13;
&#13;
<span aria-label="432" epub:type="pagebreak" id="pg_432" role="doc-pagebreak"/>  <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> public function __construct(string $name, float $price)&#13;
    {&#13;
        $this-&gt;name = $name;&#13;
        $this-&gt;price = $price;&#13;
    }&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 22-3: The</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Product</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p>
<p class="TX">We declare two public properties for each <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span> object: <span class="SANS_TheSansMonoCd_W5Regular_11">name</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">price</span>. Then we declare a constructor method <span aria-label="annotation1" class="CodeAnnotation">❶</span> that will take in initial values for each of these properties when creating a new <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span> object.</p>
<p class="TX">Now that we have a <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span> class, we can create the <span class="SANS_TheSansMonoCd_W5Regular_11">ProductController</span> class for displaying the page. Create a new <i>src/ProductController.php</i> file as shown in <a href="#lis22-4">Listing 22-4</a>.</p>
<span id="lis22-4"/>
<pre><code>&lt;?php&#13;
namespace Mattsmithdev;&#13;
use \Twig\Loader\FilesystemLoader;&#13;
use \Twig\Environment;&#13;
&#13;
class ProductController&#13;
{&#13;
    const PATH_TO_TEMPLATES = __DIR__ . '/../templates';&#13;
&#13;
    private Environment $twig;&#13;
&#13;
    public function __construct()&#13;
    {&#13;
        $loader = new FilesystemLoader(self::PATH_TO_TEMPLATES);&#13;
        $this-&gt;twig = new Environment($loader);&#13;
    }&#13;
&#13;
    public function productList()&#13;
    {&#13;
        $product1 = new Product('Hammer', 9.99);&#13;
        $product2 = new Product('Bag of nails', 6.00);&#13;
        $product3 = new Product('Bucket', 2.00);&#13;
      <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> $products = [$product1, $product2, $product3];&#13;
&#13;
        $template = 'productList.xhtml.twig';&#13;
        $args = [&#13;
          <span aria-label="annotation2" class="Code_CodeAnnotation">❷</span> 'products' =&gt; $products&#13;
        ];&#13;
&#13;
      <span aria-label="annotation3" class="Code_CodeAnnotation">❸</span> $html = $this-&gt;twig-&gt;render($template, $args);&#13;
        print $html;&#13;
    }&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 22-4: The</span> <span class="SANS_Futura_Std_Book_11">src/ProductController.php</span> <span class="SANS_Futura_Std_Book_Oblique_11">file declaring the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">ProductController</span> <span class="SANS_Futura_Std_Book_Oblique_11">class</span></p>
<p class="TX"><span aria-label="433" epub:type="pagebreak" id="pg_433" role="doc-pagebreak"/>The <span class="SANS_TheSansMonoCd_W5Regular_11">ProductController</span> class’s constructor method is similar to that of the <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span> class: it performs the setup necessary for working with the Twig templates. What distinguishes this controller from the other is its <span class="SANS_TheSansMonoCd_W5Regular_11">productList()</span> method for displaying the new Product List page.</p>
<p class="TX">Within that method, we create three <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span> objects and package them into a <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> array <span aria-label="annotation1" class="CodeAnnotation">❶</span>. Then we set the <span class="SANS_TheSansMonoCd_W5Regular_11">$template</span> variable to <span class="SANS_TheSansMonoCd_W5Regular_11">'productList.xhtml.twig'</span>, the new Twig template file we’ll create to list all the products. We next construct the <span class="SANS_TheSansMonoCd_W5Regular_11">$args</span> array. It maps the <span class="SANS_TheSansMonoCd_W5Regular_11">'products'</span> key (which will become a Twig variable name) to <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span>, our array of <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span> objects <span aria-label="annotation2" class="CodeAnnotation">❷</span>. Then we pass the <span class="SANS_TheSansMonoCd_W5Regular_11">$template</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">$args</span> variables to Twig to generate the HTML needed for the page <span aria-label="annotation3" class="CodeAnnotation">❸</span>.</p>
<p class="TX">We next need to update the front-controller logic in our <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class to call the <span class="SANS_TheSansMonoCd_W5Regular_11">ProductController</span> class’s <span class="SANS_TheSansMonoCd_W5Regular_11">productList()</span> method when the value of <span class="SANS_TheSansMonoCd_W5Regular_11">action</span> in the URL is <span class="SANS_TheSansMonoCd_W5Regular_11">products</span>. Update <i>src/Application.php</i> to match <a href="#lis22-5">Listing 22-5</a>.</p>
<span id="lis22-5"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">namespace Mattsmithdev;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">class Application</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">{</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    public function run(): void</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $defaultController = new DefaultController();</span>&#13;
      <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> $productController = new ProductController();&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $action = filter_input(INPUT_GET, 'action');</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        switch ($action) {</span>&#13;
          <span aria-label="annotation2" class="Code_CodeAnnotation">❷</span> case 'products':&#13;
                $productController-&gt;productList();&#13;
                break;&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">            case 'contact':</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">                $defaultController-&gt;contactUs();</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">                break;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">            case 'home':</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">            default:</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">                $defaultController-&gt;homepage();</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        }</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">}</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 22-5: Updating the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Application</span> <span class="SANS_Futura_Std_Book_Oblique_11">class to handle the</span> <span class="TheSansMonoCd_W5Regular_Italic_11">products</span> <span class="SANS_Futura_Std_Book_Oblique_11">case</span></p>
<p class="TX">In the <span class="SANS_TheSansMonoCd_W5Regular_11">run()</span> method, we create <span class="SANS_TheSansMonoCd_W5Regular_11">$productController</span>, a variable referencing a new <span class="SANS_TheSansMonoCd_W5Regular_11">ProductController</span> object <span aria-label="annotation1" class="CodeAnnotation">❶</span>. Then we add a new case to the <span class="SANS_TheSansMonoCd_W5Regular_11">switch</span> statement <span aria-label="annotation2" class="CodeAnnotation">❷</span>. When the action in the URL has the value <span class="SANS_TheSansMonoCd_W5Regular_11">products</span>, we’ll send a message to our <span class="SANS_TheSansMonoCd_W5Regular_11">ProductController</span> object to invoke its <span class="SANS_TheSansMonoCd_W5Regular_11">productList()</span> method.</p>
<p class="TX">We can now write the Twig template to loop through and display the provided array of products. Create the new Twig template file <i>templates/productList.xhtml.twig</i> as shown in <a href="#lis22-6">Listing 22-6</a>.</p>
<span id="lis22-6"/>
<pre><code><span aria-label="434" epub:type="pagebreak" id="pg_434" role="doc-pagebreak"/>{% extends 'base.xhtml.twig' %}&#13;
&#13;
{% block pageTitle %}Product List{% endblock %}&#13;
&#13;
{% block productsLink %}active{% endblock %}&#13;
&#13;
{% block main %}&#13;
&lt;p&gt;&#13;
    Here is a list of our products.&#13;
&lt;/p&gt;&#13;
&#13;
&lt;dl class="container bg-light"&gt;&#13;
<span aria-label="annotation1" class="codeannotated_CodeAnnotation">❶</span> {% for product in products %}&#13;
    &lt;dt&gt;{{product.name}}&lt;/dt&gt;&#13;
    &lt;dd&gt; $ {{product.price | number_format(2)}}&lt;/dd&gt;&#13;
{% else %}&#13;
    &lt;dt&gt;(sorry, there are no products to list)&lt;/dt&gt;&#13;
{% endfor %}&#13;
&lt;/dl&gt;&#13;
&#13;
{% endblock %}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 22-6: The</span> <span class="SANS_Futura_Std_Book_11">productList.xhtml.twig</span> <span class="SANS_Futura_Std_Book_Oblique_11">template</span></p>
<p class="TX">Like our other page templates, this one inherits from <i>base.xhtml.twig</i>, giving it access to all the content shared across pages. We’re therefore able to focus on just filling in the blocks from that base template that need to be customized. First, we override the <span class="SANS_TheSansMonoCd_W5Regular_11">pageTitle</span> Twig block with the text <span class="SANS_TheSansMonoCd_W5Regular_11">Product List</span>. Then we override the <span class="SANS_TheSansMonoCd_W5Regular_11">productsLink</span> Twig block with the text <span class="SANS_TheSansMonoCd_W5Regular_11">active</span> to highlight this page’s link in the navigation bar (we’ll add a new navigation bar link to the base template next).</p>
<p class="TX">Next, we override the <span class="SANS_TheSansMonoCd_W5Regular_11">main</span> Twig block with the page-specific body content. The centerpiece of this content is a loop through all the <span class="SANS_TheSansMonoCd_W5Regular_11">Product</span> objects in the <span class="SANS_TheSansMonoCd_W5Regular_11">products</span> Twig array variable to generate the items of an HTML definition list <span aria-label="annotation1" class="CodeAnnotation">❶</span>. The <span class="SANS_TheSansMonoCd_W5Regular_11">name</span> of each product is declared as the definition term (<span class="SANS_TheSansMonoCd_W5Regular_11">&lt;dt&gt;</span>), and the definition data element (<span class="SANS_TheSansMonoCd_W5Regular_11">&lt;dd&gt;</span>) is the <span class="SANS_TheSansMonoCd_W5Regular_11">price</span> of the product, formatted to two decimal places by using the Twig <span class="SANS_TheSansMonoCd_W5Regular_11">number_format</span> filter. If the <span class="SANS_TheSansMonoCd_W5Regular_11">products</span> array is empty, a Twig <span class="SANS_TheSansMonoCd_W5Regular_11">else</span> statement will display an appropriate message.</p>
<p class="TX">Our final action to get our Product List page working is to add a new item to its navigation bar in the base template. Update <i>templates/base.xhtml.twig</i> to match <a href="#lis22-7">Listing 22-7</a>.</p>
<span id="lis22-7"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Italic_11">--snip--</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">&lt;body class="container"&gt;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">&lt;header class="navbar navbar-expand navbar-dark bg-dark"&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    &lt;img src="/images/logo.png" alt="logo" width="200px"&gt;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    &lt;ul class="navbar-nav"&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        &lt;li class="nav-item"&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">            &lt;a class="nav-link {% block homeLink %}{% endblock %}" href="/"&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">                Home</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">            &lt;/a&gt;</span>&#13;
<span aria-label="435" epub:type="pagebreak" id="pg_435" role="doc-pagebreak"/><span class="TheSansMonoCd_W5Regular_Grey_11">        &lt;/li&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        &lt;li class="nav-item"&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">            &lt;a class="nav-link {% block contactLink %}{% endblock %}" href="/?action=contact"&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">                Contact Us</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">            &lt;/a&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        &lt;/li&gt;</span>&#13;
        &lt;li class="nav-item"&gt;&#13;
            &lt;a class=&#13;
"nav-link {% block productsLink %}{% endblock %}" href="/?action=products"&#13;
            &gt;&#13;
                Product List&#13;
            &lt;/a&gt;&#13;
        &lt;/li&gt;&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    &lt;/ul&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">&lt;/header&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Italic_11">--snip--</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 22-7: Adding the product list link to the</span> <span class="SANS_Futura_Std_Book_11">base.xhtml.twig</span> <span class="SANS_Futura_Std_Book_Oblique_11">template</span></p>
<p class="TX">We add a third item to the navigation bar for the Product List page. As with the other links, we include a <span class="SANS_TheSansMonoCd_W5Regular_11">class</span> attribute containing a Twig block named <span class="SANS_TheSansMonoCd_W5Regular_11">productsLink</span> so the link can be styled <span class="SANS_TheSansMonoCd_W5Regular_11">active</span> as needed.</p>
<p class="TX">We’ve now added a Product List page to our website. In the new <span class="SANS_TheSansMonoCd_W5Regular_11">ProductController</span> class, our <span class="SANS_TheSansMonoCd_W5Regular_11">productList()</span> method creates an array of objects and uses the Twig template <i>templates/productList.xhtml.twig</i> to create the HTML for the page. Adding a new navigation link to our base Twig template was easy. Clicking that link creates a <span class="SANS_TheSansMonoCd_W5Regular_11">GET</span> request with <span class="SANS_TheSansMonoCd_W5Regular_11">action=products</span>. In our <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class front controller, an instance of the <span class="SANS_TheSansMonoCd_W5Regular_11">ProductController</span> is created so that when this value of <span class="SANS_TheSansMonoCd_W5Regular_11">action</span> is found in the request URL, the <span class="SANS_TheSansMonoCd_W5Regular_11">productList()</span> method can be invoked. In all, the majority of the new code for this product list feature is well organized in its own controller class and corresponding Twig template.</p>
</section>
<section aria-labelledby="sec3" epub:type="division">
<h3 class="H1" id="sec3"><span id="toc-link_305"/><span class="SANS_Futura_Std_Bold_B_11">Sharing Controller Features Through Inheritance</span></h3>
<p class="TNI1">As a last step, let’s use the OOP principle of inheritance to streamline our controller classes. Right now, <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">ProductController</span> share several lines of identical code: both declare a <span class="SANS_TheSansMonoCd_W5Regular_11">PATH_TO_TEMPLATES</span> constant, have a private <span class="SANS_TheSansMonoCd_W5Regular_11">twig</span> property, and have identical constructor methods to create a <span class="SANS_TheSansMonoCd_W5Regular_11">Twig\Environment</span> object. If we were to create more controller classes (for login security, shopping carts, and so on), they would also need this identical code.</p>
<p class="TX">To avoid all this repetition, we’ll take the common properties and behaviors all controller classes should have and make them part of a general <span class="SANS_TheSansMonoCd_W5Regular_11">Controller</span> superclass. The individual controller classes, such as <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">ProductController</span>, will inherit from this superclass and extend it with their own unique properties and methods. <a href="#fig22-2">Figure 22-2</a> shows a diagram of the class structure we’ll create.</p>
<span aria-label="436" epub:type="pagebreak" id="pg_436" role="doc-pagebreak"/>
<figure class="IMG"><a id="fig22-2"/><img alt="" class="img60" height="610" src="../images/figure22-2.jpg" width="711"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 22-2: The</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">Controller</span> <span class="SANS_Futura_Std_Book_Oblique_11">superclass and its</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">DefaultController</span> <span class="SANS_Futura_Std_Book_Oblique_11">and</span> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">ProductController</span> <span class="SANS_Futura_Std_Book_Oblique_11">subclasses</span></p></figcaption>
</figure>
<p class="TX">We’ll declare our new <span class="SANS_TheSansMonoCd_W5Regular_11">Controller</span> class as <span class="SANS_TheSansMonoCd_W5Regular_11">abstract</span>, meaning we can never actually create a <span class="SANS_TheSansMonoCd_W5Regular_11">Controller</span> object. This is fitting since the <span class="SANS_TheSansMonoCd_W5Regular_11">Controller</span> class exists only to store the general code that all controllers should have and to be subclassed by the specific controller classes we’ll want to instantiate. Remember, declaring a class <span class="SANS_TheSansMonoCd_W5Regular_11">abstract</span> is a way to tell other programmers (and yourself in the future) that you don’t want the class to be instantiated.</p>
<p class="TX">In <a href="#fig22-2">Figure 22-2</a>, notice the plus signs (<span class="SANS_TheSansMonoCd_W5Regular_11">+</span>) denoting public methods and constants, as well as the hash mark (<span class="SANS_TheSansMonoCd_W5Regular_11">#</span>) next to the <span class="SANS_TheSansMonoCd_W5Regular_11">twig</span> property in the <span class="SANS_TheSansMonoCd_W5Regular_11">Controller</span> superclass, which indicates this property has <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span> visibility, not <span class="SANS_TheSansMonoCd_W5Regular_11">public</span> or <span class="SANS_TheSansMonoCd_W5Regular_11">private</span>. We wouldn’t want this <span class="SANS_TheSansMonoCd_W5Regular_11">twig</span> property to be public, since it could be incorrectly changed or used by any code in the web application with access to a <span class="SANS_TheSansMonoCd_W5Regular_11">Controller</span> object or one of its subclasses. However, if we were to make the <span class="SANS_TheSansMonoCd_W5Regular_11">twig</span> property private, the code in the methods of our subclasses wouldn’t have access to it either. This would be a problem, since using Twig to render templates is a core behavior of all our controller classes.</p>
<p class="TX">Giving the <span class="SANS_TheSansMonoCd_W5Regular_11">twig</span> property protected visibility ensures that subclasses of <span class="SANS_TheSansMonoCd_W5Regular_11">Controller</span> can access it, while preventing direct access by any code outside the <span class="SANS_TheSansMonoCd_W5Regular_11">Controller</span> class hierarchy. This is a useful real-world example of the inheritance concepts we examined in <span class="Xref"><a href="chapter19.xhtml">Chapter 19</a></span>.</p>
<p class="TX">Listing 22-8 shows the code for the <span class="SANS_TheSansMonoCd_W5Regular_11">Controller</span> superclass. Create <i>src/Controller.php</i> containing the code from this listing.</p>
<span id="lis22-8"/>
<pre><code>&lt;?php&#13;
namespace Mattsmithdev;&#13;
&#13;
use \Twig\Loader\FilesystemLoader;&#13;
use \Twig\Environment;&#13;
&#13;
<span aria-label="annotation1" class="codeannotated_CodeAnnotation">❶</span> abstract class Controller&#13;
{&#13;
    const PATH_TO_TEMPLATES = __DIR__ . '/../templates';&#13;
&#13;
  <span aria-label="annotation2" class="Code_CodeAnnotation">❷</span> protected Environment $twig;&#13;
&#13;
<span aria-label="437" epub:type="pagebreak" id="pg_437" role="doc-pagebreak"/>    public function __construct()&#13;
    {&#13;
        $loader = new FilesystemLoader(self::PATH_TO_TEMPLATES);&#13;
        $this-&gt;twig = new Environment($loader);&#13;
    }&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 22-8: The</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Controller</span> <span class="SANS_Futura_Std_Book_Oblique_11">superclass</span></p>
<p class="TX">We declare the class to be <span class="SANS_TheSansMonoCd_W5Regular_11">abstract</span> so it can’t be instantiated <span aria-label="annotation1" class="CodeAnnotation">❶</span>, and we designate the <span class="SANS_TheSansMonoCd_W5Regular_11">twig</span> property as <span class="SANS_TheSansMonoCd_W5Regular_11">protected</span> so it will be available to the subclasses <span aria-label="annotation2" class="CodeAnnotation">❷</span>. Otherwise, this code is identical to the code at the start of our <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">ProductController</span> classes. Now that this code lives in the <span class="SANS_TheSansMonoCd_W5Regular_11">Controller</span> class, the redundant parts can be removed. <a href="#lis22-9">Listing 22-9</a> shows the much-simplified <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span> class code.</p>
<span id="lis22-9"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">namespace Mattsmithdev;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">class DefaultController</span> extends Controller&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">{</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    private function homepage()</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $template = 'homepage.xhtml.twig';</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $args = [];</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $html = $this-&gt;twig-&gt;render($template, $args);</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        print $html;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    private function contactUs()</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $template = 'contactUs.xhtml.twig';</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $args = [];</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $html = $this-&gt;twig-&gt;render($template, $args);</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        print $html;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">}</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 22-9: The simplified</span> <span class="TheSansMonoCd_W5Regular_Italic_11">DefaultController</span> <span class="SANS_Futura_Std_Book_Oblique_11">class, a subclass of</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Controller</span></p>
<p class="TX">We declare that <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span> extends the <span class="SANS_TheSansMonoCd_W5Regular_11">Controller</span> class, allowing it to inherit the constructor and <span class="SANS_TheSansMonoCd_W5Regular_11">twig</span> property. Thanks to this inheritance, <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span> now has only two methods of its own, for displaying the home page and Contact Us templates. We can similarly streamline the <span class="SANS_TheSansMonoCd_W5Regular_11">ProductController</span> class code, as shown in <a href="#lis22-10">Listing 22-10</a>.</p>
<span id="lis22-10"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">namespace Mattsmihdev;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">class ProductController</span> extends Controller&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">{</span>&#13;
<span aria-label="438" epub:type="pagebreak" id="pg_438" role="doc-pagebreak"/><span class="TheSansMonoCd_W5Regular_Grey_11">    public function productList()</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $product1 = new Product('Hammer', 9.99);</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $product2 = new Product('Bag of nails', 6.00);</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $product3 = new Product('Bucket', 2.00);</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $products = [$product1, $product2, $product3];</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $template = 'productList.xhtml.twig';</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $args = [</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">            'products' =&gt; $products</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        ];</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        $html = $this-&gt;twig-&gt;render($template, $args);</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        print $html;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    }</span>&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 22-10: The simplified</span> <span class="TheSansMonoCd_W5Regular_Italic_11">ProductController</span> <span class="SANS_Futura_Std_Book_Oblique_11">class, a subclass of</span> <span class="TheSansMonoCd_W5Regular_Italic_11">Controller</span></p>
<p class="TX">Again, we use <span class="SANS_TheSansMonoCd_W5Regular_11">extends Controller</span> when declaring the class so that <span class="SANS_TheSansMonoCd_W5Regular_11">ProductController</span> will inherit from <span class="SANS_TheSansMonoCd_W5Regular_11">Controller</span>. The only method specific to the subclass is <span class="SANS_TheSansMonoCd_W5Regular_11">productList()</span> for displaying the Product List page.</p>
<p class="TX">We’ve now successfully used inheritance to abstract the common <span class="SANS_TheSansMonoCd_W5Regular_11">twig</span> property and its initialization into a <span class="SANS_TheSansMonoCd_W5Regular_11">Controller</span> superclass. This has simplified the two page-controller classes, while still providing exactly the same functionality.</p>
</section>
<section aria-labelledby="sec4" epub:type="division">
<h3 class="H1" id="sec4"><span id="toc-link_306"/><span class="SANS_Futura_Std_Bold_B_11">Summary</span></h3>
<p class="TNI1">In this chapter, we improved the architecture of our object-oriented web application. We separated the overall front-controller logic governing the site, located in the <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class, from the page-controller logic for displaying the individual web pages. The latter is divided between an abstract <span class="SANS_TheSansMonoCd_W5Regular_11">Controller</span> superclass, which contains the Twig setup code required for displaying any web page, and multiple subclasses containing just the code for logic specific to displaying particular kinds of pages.</p>
<p class="TX">The example site in this chapter has only three pages: a home page, a Contact Us page, and a Product List page. However, the architecture demonstrated in this chapter can easily be scaled up for complex websites with hundreds or thousands of pages and complex features like session interactions, shopping carts, login security, and more.</p>
</section>
<section aria-labelledby="sec5" epub:type="division">
<h3 class="H1" id="sec5"><span id="toc-link_307"/><span class="SANS_Futura_Std_Bold_B_11">Exercises</span></h3>
<p class="ListNumber">1.   Make a copy of the project from this chapter and add a fourth page for a privacy policy. Follow these steps:</p>
<p class="ListLetterSub">a.   Create a <i>privacy.xhtml.twig</i> template.</p>
<p class="ListLetterSub">b.   Add a new <span class="SANS_TheSansMonoCd_W5Regular_11">privacyPolicy()</span> method to the <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span> class that displays the new template.</p>
<p class="ListLetterSub"><span aria-label="439" epub:type="pagebreak" id="pg_439" role="doc-pagebreak"/>c.   Add a <span class="SANS_TheSansMonoCd_W5Regular_11">Privacy Policy</span> navigation bar link in the <i>base.xhtml.twig</i> template with the URL <span class="SANS_TheSansMonoCd_W5Regular_11">?action=privacy</span>.</p>
<p class="ListLetterSub">d.   Add a new case to the <span class="SANS_TheSansMonoCd_W5Regular_11">switch</span> statement in the <span class="SANS_TheSansMonoCd_W5Regular_11">run()</span> method of the <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class that invokes the <span class="SANS_TheSansMonoCd_W5Regular_11">privacyPolicy()</span> method of the <span class="SANS_TheSansMonoCd_W5Regular_11">DefaultController</span> object if the value of <span class="SANS_TheSansMonoCd_W5Regular_11">action</span> in the URL is <span class="SANS_TheSansMonoCd_W5Regular_11">privacy</span>.</p>
<p class="ListNumber">2.   Make a copy of your project from Exercise 1, and add a fifth page for listing company staff. Follow these steps:</p>
<p class="ListLetterSub">a.   Create a <span class="SANS_TheSansMonoCd_W5Regular_11">Staff</span> class to represent staff details, including <span class="SANS_TheSansMonoCd_W5Regular_11">firstName</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">lastName</span>, and <span class="SANS_TheSansMonoCd_W5Regular_11">email</span> properties.</p>
<p class="ListLetterSub">b.   Create a new subclass of <span class="SANS_TheSansMonoCd_W5Regular_11">Controller</span> named <span class="SANS_TheSansMonoCd_W5Regular_11">StaffController</span>. Give it a <span class="SANS_TheSansMonoCd_W5Regular_11">list()</span> method that creates two or three staff objects and passes them as an array to the Twig <span class="SANS_TheSansMonoCd_W5Regular_11">render()</span> method, along with the template name <i>staff.xhtml.twig</i>.</p>
<p class="ListLetterSub">c.   Add a new <span class="SANS_TheSansMonoCd_W5Regular_11">Staff List</span> navigation bar link in the <i>base.xhtml.twig</i> template with the URL <span class="SANS_TheSansMonoCd_W5Regular_11">?action=staffList</span>.</p>
<p class="ListLetterSub">d.   Create a <i>staff.xhtml.twig</i> template, based on the <i>productList.xhtml.twig</i> template, that uses Twig code to loop through and print out each <span class="SANS_TheSansMonoCd_W5Regular_11">Staff</span> object in the received array.</p>
<p class="ListLetterSub">e.   In the <span class="SANS_TheSansMonoCd_W5Regular_11">run()</span> method of the <span class="SANS_TheSansMonoCd_W5Regular_11">Application</span> class, create a new <span class="SANS_TheSansMonoCd_W5Regular_11">$staffController</span> object that’s an instance of the <span class="SANS_TheSansMonoCd_W5Regular_11">StaffController</span> class. Then add a new <span class="SANS_TheSansMonoCd_W5Regular_11">switch</span> statement case that calls <span class="SANS_TheSansMonoCd_W5Regular_11">$staffController-&gt;list()</span> if the value of <span class="SANS_TheSansMonoCd_W5Regular_11">action</span> in the URL is <span class="SANS_TheSansMonoCd_W5Regular_11">staffList</span>.</p>
</section>
</section>
</div></body></html>