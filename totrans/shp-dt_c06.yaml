- en: '6'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '6'
- en: Newer Applications of Geometry in Machine Learning
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 几何在机器学习中的新应用
- en: '![](image_fi/book_art/chapterart.png)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/book_art/chapterart.png)'
- en: In [Chapter 5](c05.xhtml), we explored the contributions of metric geometry
    to machine learning and its myriad uses in model measurements and input. However,
    geometry has provided many other contributions to machine learning; in this chapter,
    we’ll explore tangent-space-based approaches to model estimation, exterior calculus,
    tools related to the intersection of curves (which can be used to replace linear
    algebra in algorithms), and rank-based models that involve vector fields acting
    on datasets’ tangent spaces. We’ll see how these tools can help in supervised
    learning on small datasets, help communities plan for disasters, and discern choice
    preferences of customers.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第5章](c05.xhtml)中，我们探讨了度量几何对机器学习的贡献及其在模型测量和输入中的众多应用。然而，几何学还为机器学习提供了许多其他贡献；在本章中，我们将探讨基于切空间的模型估计方法、外部微积分、与曲线交点相关的工具（可以用来替代算法中的线性代数），以及涉及向量场作用于数据集切空间的基于秩的模型。我们将看到这些工具如何在小数据集的监督学习中发挥作用，帮助社区规划灾难应对，并辨别客户的选择偏好。
- en: Working with Nonlinear Spaces
  id: totrans-4
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 处理非线性空间
- en: Our first tool helps mathematicians and machine learning engineers work with
    nonlinear spaces such as manifolds; it’s the definition of a point’s *tangent
    space*. Thinking back to calculus classes, we recall the *tangent lines* of a
    function are lines that touch a point on a curve without crossing the curve—where
    the slope of the curve equals the slope of the tangent line (giving the first
    derivative of the curve). Consider the sine wave example and a point on that sine
    wave, along with its tangent line, shown in [Figure 6-1](#figure6-1).
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的第一个工具帮助数学家和机器学习工程师处理诸如流形之类的非线性空间；它是定义一个点的*切空间*。回想一下微积分课程，我们记得*切线*是与曲线上的一点接触而不穿越曲线的线——在该点上，曲线的斜率等于切线的斜率（即曲线的导数）。考虑[图6-1](#figure6-1)中的正弦波示例和该波上的一个点，以及它的切线。
- en: '![](image_fi/503083c06/f06001.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/503083c06/f06001.png)'
- en: 'Figure 6-1: A sine wave example with tangent line drawn at one of the local
    maxima'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 图6-1：一个正弦波示例，在局部最大值之一处画出的切线
- en: This kind of tangent line works well in two dimensions. However, trying to define
    tangent lines to a point on a surface gets trickier, as many (infinitely many)
    lines can be tangent to a given point (see [Figure 6-2](#figure6-2), point A).
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 这种切线在二维空间中效果很好。然而，尝试定义一个曲面上某点的切线会变得更加复杂，因为许多（无穷多个）切线都可以与给定点相切（见[图6-2](#figure6-2)，A点）。
- en: '![](image_fi/503083c06/f06002r.png)'
  id: totrans-9
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/503083c06/f06002r.png)'
- en: 'Figure 6-2: An ellipse with multiple possible tangent lines through point A'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 图6-2：一个椭圆，包含多个通过A点的可能切线
- en: In fact, the lines in [Figure 6-2](#figure6-2) form a two-dimensional plane
    tangent to point A, akin to a sheet of paper that touches the ellipse at point
    A. What one could do is glue this *tangent plane* to point A, as in [Figure 6-3](#figure6-3).
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 事实上，[图6-2](#figure6-2)中的线条构成了一个与A点相切的二维平面，类似于一张在A点与椭圆相切的纸片。你可以将这个*切平面*粘贴到A点，如[图6-3](#figure6-3)所示。
- en: '![](image_fi/503083c06/f06003r.png)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/503083c06/f06003r.png)'
- en: 'Figure 6-3: An ellipse with point A and the tangent plane associated with point
    A that extends tangent lines to tangent planes and spaces'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 图6-3：一个椭圆，包含A点和与A点相关的切平面，切平面延伸出切线和切空间
- en: In the case of higher-dimensional objects, the tangent spaces can grow to involve
    more dimensions (it can be 3-dimensional, 100-dimensional, or even an infinite-dimensional
    box). These tangent spaces have a nice connection to linear algebra. Remember
    that a vector space can be defined by a set of independent vectors collected into
    a matrix, called the *basis* of the space, technically known as *Hamel basis*.
    The basis for the tangent space of an object at a point, in fact, is the set of
    a point’s partial derivatives. As mentioned earlier, in a one-dimensional space,
    this is exactly the slope of the tangent line. This gives a nice Euclidean space
    associated with each point on the manifold, which can be used to derive unit distances
    between points, provide mappings to a Euclidean space from a manifold, and understand
    multicollinearity. Multicollinearity occurs when variables are strongly correlated,
    which results in matrix columns or rows that are identical or nearly identical
    (causing singular matrices). Multicollinearity is a problem for regression-based
    algorithms, as it leads to redundant predictors and singular matrices. Variables
    with perfect overlap of variance (highly collinear predictors) will have the same
    tangent space or at least share some overlapping tangent space.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 对于高维对象，切空间可能涉及更多的维度（可以是三维、100维，甚至是无限维的盒子）。这些切空间与线性代数有着紧密的联系。请记住，向量空间可以通过一组独立的向量组成一个矩阵来定义，这组向量被称为该空间的*基*，在技术上称为*哈梅尔基*。实际上，某个点上对象的切空间的基是该点的偏导数集合。如前所述，在一维空间中，这恰好是切线的斜率。这为流形上每个点提供了一个优美的欧几里得空间，可用于推导点与点之间的单位距离，提供从流形到欧几里得空间的映射，并理解多重共线性。多重共线性发生在变量之间高度相关时，这会导致矩阵的列或行完全相同或几乎相同（从而导致奇异矩阵）。多重共线性是回归算法中的一个问题，因为它会导致冗余的预测变量和奇异矩阵。具有完美方差重叠（高度共线的预测变量）的变量将具有相同的切空间，或者至少共享一些重叠的切空间。
- en: Introducing dgLARS
  id: totrans-15
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 引入dgLARS
- en: One useful machine learning algorithm based on tangent spaces is the *dgLARS*
    algorithm (dgLARS stands for “differential geometry least angle regression”).
    dgLARS extends traditional least angle regression (LARS) to an algorithm that
    fits to a given model’s error tangent space. The LARS algorithm traditionally
    starts with each coefficient in the regression model set to 0, with predictors
    added progressively according to which predictor is most correlated with the outcome;
    coefficients are adjusted through least squares computation until a higher correlation
    enters the model. When multiple predictors have entered the model, coefficients
    are increased in joint least squares directions.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 基于切空间的一个有用的机器学习算法是*dgLARS*算法（dgLARS代表“微分几何最小角回归”）。dgLARS将传统的最小角回归（LARS）扩展为一个适应给定模型误差切空间的算法。LARS算法通常从回归模型中每个系数设为0开始，根据与结果最相关的预测变量逐步添加预测变量；通过最小二乘法计算调整系数，直到一个更高相关性的变量进入模型。当多个预测变量进入模型时，系数将沿联合最小二乘方向增大。
- en: dgLARS considers the model’s tangent space, scaling the score function used
    to optimize the coefficients. Each update to the model is done using the square
    root of a tool called the *conditional Fisher information*. The conditional Fisher
    information roughly measures the amount of information a given variable contains
    relative to a target (such as an outcome variable). For more technical-minded
    readers, the Fisher information of a parameter is the variance of the parameter’s
    score, which is the partial derivative of that parameter with respect to the natural
    logarithm of the likelihood function.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: dgLARS考虑了模型的切空间，调整用于优化系数的评分函数。每次模型更新都使用一个工具的平方根，该工具被称为*条件Fisher信息*。条件Fisher信息大致衡量给定变量相对于目标（如结果变量）所包含的信息量。对于技术背景的读者来说，参数的Fisher信息是该参数评分的方差，评分是该参数对似然函数的自然对数的偏导数。
- en: Let’s make this concrete with an example. Say we are creating a model to understand
    factors that impact adolescent risk-taking behaviors, such as drug use or petty
    crime. We may have many known factors measured already (such as family socioeconomic
    status, secondary school grades, and prior school or legal incidents). However,
    we’d like to compare an index from a survey we’ve designed to measure risk propensity
    in adolescents (index 1) to a known index that measures risk-taking in adults
    (index 2). Both surveys likely capture different types of information and different
    levels of relevant information with respect to our risk outcomes ([Figure 6-4](#figure6-4)).
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过一个实例来具体化这个问题。假设我们正在创建一个模型，以了解影响青少年冒险行为的因素，如吸毒或小偷小摸。我们可能已经测量了许多已知因素（如家庭社会经济状况、中学成绩以及之前的学校或法律事件）。然而，我们希望将我们设计的衡量青少年风险倾向的调查（索引
    1）与一个衡量成人风险行为的已知调查（索引 2）进行比较。这两份调查可能会捕获不同类型的信息，并且在与我们的风险结果相关的信息量方面有所不同（[图 6-4](#figure6-4)）。
- en: '![](image_fi/503083c06/f06004.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/503083c06/f06004.png)'
- en: 'Figure 6-4: Comparison of number of questions loading onto a risk index'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6-4：加载到风险指数上的问题数量比较
- en: In the [Figure 6-5](#figure6-5) example, survey 1’s index contains a greater
    volume of information. However, there may be some overlap between the variables
    or irrelevant information in survey 2’s index, and it would be nice to have a
    measurement that can capture such information. Perhaps there is some overlap of
    information between the questions asked and some irrelevant information in each
    survey as well. Let’s consider unique and relevant information contained in each
    risk-propensity survey ([Figure 6-5](#figure6-5)).
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 在[图 6-5](#figure6-5)示例中，调查问卷 1 的索引包含了更多的信息量。然而，调查问卷 2 的索引中可能存在一些变量的重叠或无关信息，如果能有一个能够捕获此类信息的测量方法那就更好了。也许每个调查中的问题之间存在信息重叠，或者包含了一些无关的信息。让我们考虑每个风险倾向调查中包含的独特且相关的信息（[图
    6-5](#figure6-5)）。
- en: '![](image_fi/503083c06/f06005.png)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/503083c06/f06005.png)'
- en: 'Figure 6-5: Two adjusted measures of relevant information captured in index
    questions'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6-5：在索引问题中捕获的相关信息的两种调整测量方法
- en: From [Figure 6-5](#figure6-5), we see that index 1 and index 2 contain some
    irrelevant information and some overlapping information. Index 1 does seem to
    contain a bit more information than index 2, and if we had to choose which survey
    to administer to a larger population of at-risk adolescents, we’d be better off
    starting with index 1.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 从[图 6-5](#figure6-5)可以看出，索引 1 和索引 2 包含了一些无关信息和一些重叠信息。索引 1 确实似乎包含比索引 2 更多的信息，如果我们必须选择一个调查问卷来对更多处于风险中的青少年进行调查，我们最好从索引
    1 开始。
- en: This is a bit how Fisher information and variable selection in dgLARS happen.
    Technically, a *score* is calculated through partial derivatives of the model’s
    log likelihood function, and the variance of this score is the Fisher information,
    which can be entered into a matrix to capture information across partial derivatives
    of the model. Interestingly, this matrix can also be derived as the Hessian of
    the relative entropy (Kullback–Leiber divergence), and the Fisher information
    gives the curvature of relative entropy in this case. At a less technical level,
    the Fisher information used to select variables has to do with both a statistical
    measure (the log likelihood function) and the information geometry of the independent
    variables being considered.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 这有点像 Fisher 信息和 dgLARS 中的变量选择。技术上，*得分*是通过模型的对数似然函数的偏导数计算出来的，这个得分的方差就是 Fisher
    信息，可以将其输入到矩阵中以捕获模型的偏导数中的信息。有趣的是，这个矩阵也可以通过相对熵（Kullback-Leibler 散度）的 Hessian 导出，而
    Fisher 信息在这种情况下给出了相对熵的曲率。从一个较低技术层面的角度来看，用于选择变量的 Fisher 信息既与统计度量（对数似然函数）有关，又与所考虑的自变量的信息几何结构有关。
- en: 'In the case of generalized linear models, the Fisher information matrix can
    be used to derive a score called the *conditional Rao score*, which can test whether
    the coefficient for a given variable is statistically different from 0\. If the
    score is not statistically different from 0, the variable is dropped from consideration
    in the model. In the dgLARS algorithm, these calculations are done by searching
    coefficient vectors in the model error’s tangent space, starting with the null
    model. This space’s geometry is then iteratively partitioned into three sets:
    *selected predictors*, which have good fit scores in the error tangent space;
    *redundant predictors*, which share an error tangent space with selected predictors;
    and *nonselected predictors*, which have poor fit scores in the error tangent
    space. Thus, dgLARS leverages information about the model’s geometry to find a
    best-fitting model.'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: dgLARS has had success on problems involving more predictors than observations
    in datasets, and many of the publications on this algorithm focus on genomics
    applications, where the number of patients might be 300 and the number of genes
    sequences might be in the 1,000,000 range. R provides a package, dglars, that
    implements this algorithm for generalized linear models, including link functions
    for logistic regression, Poisson regression, linear regression, and gamma regression.
    For those unfamiliar with generalized linear regression, a *link function* essentially
    is a special type of transformation of a dependent variable that allows regression
    to work mathematically for count variables, binary variables, and other types
    of not normally distributed dependent variables (with some restrictions on the
    geometry of the distribution).
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
- en: Now that we’ve covered some of the theory, let’s put it into practice.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
- en: Predicting Depression with dgLARS
  id: totrans-29
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: We’d like to predict self-reported depression based on school issues and IQ.
    The data we’ll use is self-reported school issues in a self-selected sample of
    profoundly gifted Quora users (with IQs above 155), including seven main school
    issues (bullying, teacher hostility, boredom, depression, lack of motivation,
    outside learning, put in remediation courses). The data was reported across 22
    individuals who provided scores in the profoundly gifted range and discussed at
    least one of the issues of interest in a school system, with a bias toward users
    in the United States. This dataset was collected from the platform and processed
    manually to obtain a final dataset with categories of school issues for posters
    who met the IQ criterion. You can find the dataset in the book’s files. Let’s
    load the data first with the code in [Listing 6-1](#listing6-1).
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Listing 6-1: A script that loads the Quora dataset'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: 'The code in [Listing 6-1](#listing6-1) loads a dataset examining educational
    interventions and a psychological metric of self-esteem. Now let’s modify the
    script to run the dgLARS algorithm on the dataset. The R package gives us the
    option of doing cross-validation or running the algorithm without cross-validation.
    Let’s modify [Listing 6-1](#listing6-1) to run both model options:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: '[列表 6-1](#listing6-1)中的代码加载了一个数据集，研究了教育干预和自尊心的心理学度量。现在，让我们修改脚本，使用dgLARS算法在该数据集上运行。R包提供了交叉验证或不使用交叉验证运行算法的选项。让我们修改[列表
    6-1](#listing6-1)来运行这两种模型选项：'
- en: '[PRE1]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'This runs the cross-validated and non-cross-validated dgLARS algorithms on
    the full set of student data. The cross-validated version does not work well on
    small datasets with sparse predictors, so if you run into an error, keep trying
    to run the cross-validated version, as some partitions may produce an error related
    to splitting and fitting models to the splits. The output from the two dgLARS
    algorithms should agree on many predictors, though the cross-validated split version
    of the algorithm may vary a bit, as the data is randomly partitioned. Let’s add
    our script to look at the summary of the first model:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码在完整的学生数据集上运行交叉验证和非交叉验证的dgLARS算法。交叉验证版本在具有稀疏预测变量的小数据集上效果不好，因此如果遇到错误，请继续尝试运行交叉验证版本，因为某些分区可能会出现与拆分和拟合模型相关的错误。两个dgLARS算法的输出应该在许多预测变量上达成一致，尽管交叉验证拆分版本的算法可能会有所不同，因为数据是随机分区的。接下来，让我们添加脚本来查看第一个模型的总结：
- en: '[PRE2]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: No factors are selected as important predictors in this model. There are a few
    main reasons why no factors might be selected by the model, including the existence
    of subpopulations with opposite effects that “average out” the angles of the subpopulations,
    the existence of outliers that warp the geometry, or a true null effect for predictors.
    Model fit is reasonable, with an Akaike information criterion (AIC) of 20.86 and
    a residual deviance much smaller than the null deviance with no terms added to
    the model. The dispersion parameter tells us that the data fits reasonably well
    to the binomial distribution (see how `g` is close to 1) without problems in the
    distribution that sometimes occur in real-world data.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个模型中，没有任何因素被选为重要的预测变量。没有因素被选择的主要原因有几个，包括存在具有相反效应的亚群体，这些效应会“平均”掉亚群体的角度，存在扭曲几何形状的异常值，或者预测变量的真实零效应。模型拟合合理，Akaike信息准则（AIC）为20.86，残差偏差比没有加入任何项的零偏差要小得多。离散度参数告诉我们数据很好地拟合了二项分布（见`g`接近1），没有出现现实数据中有时会遇到的分布问题。
- en: 'Now let’s add to our script to look at the results from the cross-validated
    trials:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们在脚本中添加代码，查看交叉验证试验的结果：
- en: '[PRE3]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The cross-validated model should give a bit different result than the non-cross-validated
    model, suggesting the models are finding some consistency but not completely overlapping
    across folds. In the cross-validated model, profoundly gifted children put in
    remedial courses tend to have higher rates of depression, and children like the
    ones in this sample who are put in remedial courses and start showing signs of
    depression may benefit from this intervention. As you can see, bullying is also
    a potential issue leading to depression, suggesting something we likely already
    know: that bullying in general shouldn’t be tolerated in a school for optimal
    mental health outcomes.'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 交叉验证模型的结果应该会与非交叉验证模型略有不同，表明模型在不同的折叠中找到了一些一致性，但并不完全重叠。在交叉验证模型中，被安排在补救课程中的天才儿童往往有更高的抑郁率，而像本样本中那些被安排进入补救课程并开始出现抑郁迹象的儿童可能从这种干预中受益。正如你所看到的，欺凌也是导致抑郁的潜在问题，这暗示了我们可能已经知道的事情：一般来说，学校里应该不容忍欺凌，以促进最佳的心理健康结果。
- en: Given the small sample size, it’s likely that a generalized linear regression
    model would struggle to estimate the coefficients. The necessary sample size for
    topology- and geometry-based linear models seems to be smaller than linear regression,
    and the consistent results on this problem suggest these models can work on very,
    very small data. However, there is still probably a minimum sample size needed
    for cross-validation, so it’s best to avoid doing even these analyses if the sample
    size is less than 10.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 鉴于样本量较小，广义线性回归模型可能难以估计系数。基于拓扑和几何的线性模型所需的样本量似乎比线性回归模型要小，而在这个问题上得到的一致结果表明，这些模型可以在非常非常小的数据集上工作。然而，交叉验证可能仍然需要最小的样本量，因此如果样本量少于10，最好避免进行这些分析。
- en: Predicting Credit Default with dgLARS
  id: totrans-42
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用 dgLARS 预测信用违约
- en: To understand how dgLARS works on a larger dataset with a binary outcome (logistic
    regression) and more observations and variables, let’s consider another dataset.
    The UCI credit default dataset includes 30,000 credit cases in Taiwan (late 2005)
    and 23 predictors of defaulting, including demographics (age, marriage status,
    education status, and gender), credit limit, and prior usage and payment information.
    The goals of our analysis are to figure out what predictors are related to whether
    an account ends up defaulting and to assess the model fit of our dgLARS model.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 为了理解 dgLARS 在具有二元结果（逻辑回归）和更多观察值及变量的大型数据集上的表现，让我们考虑另一个数据集。UCI 信用违约数据集包括 30,000
    个台湾信用案例（2005 年底），并有 23 个违约预测因子，包括人口统计学特征（年龄、婚姻状况、教育状况和性别）、信用额度以及前期使用和支付信息。我们分析的目标是弄清楚哪些预测因子与账户是否会违约相关，并评估我们的
    dgLARS 模型的拟合度。
- en: Let’s get started on this with the code in [Listing 6-2](#listing6-2).
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过[列表 6-2](#listing6-2)中的代码开始。
- en: '[PRE4]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Listing 6-2: A script that loads, processes, and analyzes the UCI credit default
    dataset with the dgLARS and cross-validated dgLARS algorithms'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 6-2：一个加载、处理和分析 UCI 信用违约数据集的脚本，使用 dgLARS 和交叉验证的 dgLARS 算法
- en: This should yield two models with coefficients for most predictors. The first
    model is the non-cross-validated model version (DG), and the second model is the
    cross-validated version (DG1). [Table 6-1](#table6-1) shows results from our run
    of the code.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 这应该会生成两个包含大多数预测因子系数的模型。第一个模型是非交叉验证版本（DG），第二个模型是交叉验证版本（DG1）。[表 6-1](#table6-1)展示了我们运行代码后的结果。
- en: 'Table 6-1: Coefficients of Terms in the UCI Credit Default dgLARS Model'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 表 6-1：UCI 信用违约 dgLARS 模型中的各项系数
- en: '| **Column1** | **DG estimate** | **DG1 estimate** |'
  id: totrans-49
  prefs: []
  type: TYPE_TB
  zh: '| **Column1** | **DG 估计** | **DG1 估计** |'
- en: '| --- | --- | --- |'
  id: totrans-50
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Int. | –1.47 | –1.45 |'
  id: totrans-51
  prefs: []
  type: TYPE_TB
  zh: '| Int. | –1.47 | –1.45 |'
- en: '| LIMIT_BAL | –0.10 | –0.09 |'
  id: totrans-52
  prefs: []
  type: TYPE_TB
  zh: '| LIMIT_BAL | –0.10 | –0.09 |'
- en: '| SEX | –0.05 | –0.04 |'
  id: totrans-53
  prefs: []
  type: TYPE_TB
  zh: '| SEX | –0.05 | –0.04 |'
- en: '| EDUCATION | –0.08 | –0.07 |'
  id: totrans-54
  prefs: []
  type: TYPE_TB
  zh: '| EDUCATION | –0.08 | –0.07 |'
- en: '| MARRIAGE | –0.08 | –0.07 |'
  id: totrans-55
  prefs: []
  type: TYPE_TB
  zh: '| MARRIAGE | –0.08 | –0.07 |'
- en: '| AGE | 0.07 | 0.06 |'
  id: totrans-56
  prefs: []
  type: TYPE_TB
  zh: '| AGE | 0.07 | 0.06 |'
- en: '| PAY_0 | 0.65 | 0.65 |'
  id: totrans-57
  prefs: []
  type: TYPE_TB
  zh: '| PAY_0 | 0.65 | 0.65 |'
- en: '| PAY_2 | 0.10 | 0.09 |'
  id: totrans-58
  prefs: []
  type: TYPE_TB
  zh: '| PAY_2 | 0.10 | 0.09 |'
- en: '| PAY_3 | 0.09 | 0.09 |'
  id: totrans-59
  prefs: []
  type: TYPE_TB
  zh: '| PAY_3 | 0.09 | 0.09 |'
- en: '| PAY_4 | 0.03 | 0.03 |'
  id: totrans-60
  prefs: []
  type: TYPE_TB
  zh: '| PAY_4 | 0.03 | 0.03 |'
- en: '| PAY_5 | 0.04 | 0.04 |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| PAY_5 | 0.04 | 0.04 |'
- en: '| PAY_6 | 0.01 | 0.01 |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| PAY_6 | 0.01 | 0.01 |'
- en: '| BILL_AMT1 | –0.39 | –0.15 |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| BILL_AMT1 | –0.39 | –0.15 |'
- en: '| BILL_AMT2 | 0.16 | 0.02 |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| BILL_AMT2 | 0.16 | 0.02 |'
- en: '| BILL_AMT3 | 0.09 | 0.02 |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| BILL_AMT3 | 0.09 | 0.02 |'
- en: '| BILL_AMT5 | 0.03 | 0.00 |'
  id: totrans-66
  prefs: []
  type: TYPE_TB
  zh: '| BILL_AMT5 | 0.03 | 0.00 |'
- en: '| BILL_AMT6 | 0.02 | 0.00 |'
  id: totrans-67
  prefs: []
  type: TYPE_TB
  zh: '| BILL_AMT6 | 0.02 | 0.00 |'
- en: '| PAY_AMT1 | –0.22 | –0.17 |'
  id: totrans-68
  prefs: []
  type: TYPE_TB
  zh: '| PAY_AMT1 | –0.22 | –0.17 |'
- en: '| PAY_AMT2 | –0.22 | –0.19 |'
  id: totrans-69
  prefs: []
  type: TYPE_TB
  zh: '| PAY_AMT2 | –0.22 | –0.19 |'
- en: '| PAY_AMT3 | –0.05 | –0.05 |'
  id: totrans-70
  prefs: []
  type: TYPE_TB
  zh: '| PAY_AMT3 | –0.05 | –0.05 |'
- en: '| PAY_AMT4 | –0.06 | –0.06 |'
  id: totrans-71
  prefs: []
  type: TYPE_TB
  zh: '| PAY_AMT4 | –0.06 | –0.06 |'
- en: '| PAY_AMT5 | –0.05 | –0.05 |'
  id: totrans-72
  prefs: []
  type: TYPE_TB
  zh: '| PAY_AMT5 | –0.05 | –0.05 |'
- en: '| PAY_AMT6 | –0.04 | –0.03 |'
  id: totrans-73
  prefs: []
  type: TYPE_TB
  zh: '| PAY_AMT6 | –0.04 | –0.03 |'
- en: Some of the biggest predictors of default include the prior month’s billing
    and payment history. Those with lower usage (`BILL_AMT1`), lower payments (`PAY_AMT1`),
    and on-time payments (`PAY_0`) are less likely to default on payment in the following
    month. This makes a lot of sense, given that most lending metrics prioritize lending
    at the best rates to those with low loads of debt and a track record of on-time
    payment.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 一些最大的违约预测因素包括前一个月的账单和支付历史。使用较少（`BILL_AMT1`）、较低支付（`PAY_AMT1`）和按时支付（`PAY_0`）的人更不容易在下个月违约。这非常有道理，因为大多数贷款指标优先考虑向那些债务负担较轻且有按时支付记录的人提供最佳利率的贷款。
- en: The cross-validated dgLARS model penalizes prior month usage and payment total
    less than the non-cross-validated model, suggesting that prior month on-time payment
    is more important than specific numbers. The AIC score on the first model is fairly
    large (27,924), but it is quite a bit smaller than the null model’s AIC score
    (31,705), indicating a better fit than the null model even with several predictors
    included.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 交叉验证的 dgLARS 模型对前一个月的使用和支付总额的惩罚较小，表明前一个月的按时支付比具体的数值更为重要。第一个模型的 AIC 值相当大（27,924），但比零模型的
    AIC 值（31,705）小得多，表明即使包含了多个预测变量，第一个模型的拟合度也优于零模型。
- en: 'Now let’s compare this model with logistic regression and compare the AIC fit
    statistics, adding the following to our script:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们将此模型与逻辑回归进行比较，并比较 AIC 拟合统计量，将以下内容添加到我们的脚本中：
- en: '[PRE5]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: This snippet of code runs the logistic regression on the dataset and calculates
    the model’s AIC. In this example, the AIC should come out to around 27,925, almost
    exactly that of the dgLARS models. This suggests a convergence of logistic regression
    and the dgLARS algorithm; at this large a sample size, this result is expected.
    Logistic regression is the typical tool for large sample sizes, and it doesn’t
    seem that we get a gain from using dgLARS in this case. However, given the convergence
    on large sample sizes, it’s likely that dgLARS gives quality results at the smaller
    sample sizes that won’t work with logistic regression.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码在数据集上运行逻辑回归并计算模型的AIC。在这个例子中，AIC应该大约为27,925，几乎与dgLARS模型的AIC完全相同。这表明逻辑回归和dgLARS算法在收敛性上的一致性；在如此大的样本量下，这一结果是可以预期的。逻辑回归是处理大样本量的典型工具，而在这种情况下，使用dgLARS似乎没有带来额外的收益。然而，考虑到在大样本量下的收敛性，dgLARS很可能在较小的样本量下能够提供质量较高的结果，而逻辑回归在这种情况下无法工作。
- en: Applying Discrete Exterior Derivatives
  id: totrans-79
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 应用离散外微分
- en: Another useful tool that has come out of differential geometry is *discrete
    exterior derivatives*. Discrete exterior derivatives involve building up discrete
    shapes from lower-dimensional discrete shapes. In prior chapters, we examined
    the concept of homology, which counts the holes in a given object; technically,
    this is done by finding an object’s boundaries at a specific dimension. For instance,
    consider the boundaries of a triangle ([Figure 6-6](#figure6-6)).
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个来自微分几何的有用工具是*离散外微分*。离散外微分涉及从低维离散形状构建离散形状。在前几章中，我们研究了同调的概念，它用于计算给定对象中的孔洞；从技术上讲，这是通过找到对象在特定维度下的边界来实现的。例如，考虑三角形的边界（见[图
    6-6](#figure6-6)）。
- en: '![](image_fi/503083c06/f06006.png)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/503083c06/f06006.png)'
- en: 'Figure 6-6: The boundaries of a triangle'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6-6：三角形的边界
- en: We can take this a step further and break down lines into each point connected
    by the line, as in [Figure 6-7](#figure6-7).
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以更进一步，将线段分解为线段连接的每一个点，如[图 6-7](#figure6-7)所示。
- en: '![](image_fi/503083c06/f06007r.png)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/503083c06/f06007r.png)'
- en: 'Figure 6-7: The boundaries of a line'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6-7：线段的边界
- en: Just as we can take apart shapes by identifying and separating out boundaries,
    we can also build shapes up from lower-dimensional boundaries by combining those
    boundaries. Technically, this is called *cohomology*, which is the realm of discrete
    exterior calculus. We might start with two points that are related in some way
    (perhaps within a certain distance of each other or sharing a characteristic)
    and connect them with a line ([Figure 6-8](#figure6-8)).
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 就像我们可以通过识别并分离出边界来拆解形状一样，我们也可以通过组合边界来从低维边界构建形状。从技术上讲，这被称为*上同调*，是离散外微积分的领域。我们可能从两个在某种方式上相关的点（例如在一定距离内，或共享某个特征）开始，并用一条线将它们连接起来（见[图
    6-8](#figure6-8)）。
- en: '![](image_fi/503083c06/f06008r.png)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/503083c06/f06008r.png)'
- en: 'Figure 6-8: Two points built into a line'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6-8：构建成一条线的两个点
- en: For more technically minded readers, we’re looking at the discrete version of
    differential forms, which are cochains on simplicial complexes. These differential
    forms have vector fields associated with them. We can then define operators that
    change those fields or objects, combine them, or count what exists within a field
    or cochain. This allows us to wrangle certain types of data to understand problems
    like resource capacity in electrical grids or burden of disease within social
    networks (or even rendering graphics across groups of pixels within a computer
    screen).
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 对于更具技术背景的读者，我们正在查看微分形式的离散版本，这些形式是单纯形复形上的同调链。这些微分形式有与之相关的向量场。我们可以定义运算符，改变这些场或对象，结合它们，或计算某个场或同调链内存在的内容。这使我们能够处理某些类型的数据，理解诸如电网资源容量、社会网络中的疾病负担（甚至是在计算机屏幕内的像素组间渲染图形）等问题。
- en: This can continue up to arbitrarily many dimensions, with lines building up
    triangles and triangles building up tetrahedra and so on. We can also jump levels
    with discrete exterior derivatives, going from points to triangles or tetrahedra
    rather than lines. Thus, discrete data, such as rendering pixel data or engineering
    data, can be grouped and connected for further study.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 这个过程可以扩展到任意多的维度，线段构成三角形，三角形构成四面体，以此类推。我们也可以通过离散外微分跳跃维度，从点跳跃到三角形或四面体，而不是通过线段。因此，离散数据，如渲染像素数据或工程数据，可以被分组并连接起来以供进一步研究。
- en: One of the newer applications of discrete exterior derivatives (and homology)
    is within social network analysis. As we mentioned in prior chapters, graphs are
    discrete objects of zero and one dimension (points and lines); however, connections
    between individuals can be extended from two-way mutual interactions (lines connecting
    points) to cliques of 3-way (triangle) or 4-way (tetrahedron) or 100-way mutual
    interactions (a very large dimensional sort of object), as demonstrated by three
    colleagues mutually connected in [Figure 6-9](#figure6-9).
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 离散外微分（和同调）的最新应用之一是社交网络分析。如我们在前几章提到的，图是零维和一维的离散对象（点和线）；然而，个体之间的连接可以从双向相互作用（连接点的线）扩展到三方（三角形）或四方（四面体）或100方的相互作用（非常大维度的对象），正如[图
    6-9](#figure6-9)中三位同事相互连接所示。
- en: '![](image_fi/503083c06/f06009.png)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/503083c06/f06009.png)'
- en: 'Figure 6-9: A graph of three colleagues working on projects together represented
    through a three-way interaction'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6-9：通过三方互动表示的三位同事共同工作项目的图形
- en: On the left of [Figure 6-9](#figure6-9), we see three colleagues (Colleen, Jodelle,
    and Yaé) who collaborate in pairs but have not worked on a project involving all
    three of them. On the right of [Figure 6-9](#figure6-9), we see a representation
    of a project that involves all three colleagues working together. If they collaborate
    on many papers, we can sum up their two-way collaborations and their three-way
    collaborations to get a summary total for each *n*-way collaboration. This might
    be useful for understanding the strength of this collaborative network’s parts.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 在[图 6-9](#figure6-9)的左侧，我们看到三位同事（Colleen、Jodelle 和 Yaé）成对协作，但并未共同参与过三人合作的项目。在[图
    6-9](#figure6-9)的右侧，我们看到一个涉及三位同事共同合作的项目的表示。如果他们合作了许多论文，我们可以总结他们的双向合作和三方合作，从而得到每个*n*方合作的总和。这对于理解这个协作网络的各个部分的强度可能很有用。
- en: Let’s explore how these concepts can help in disaster logistics planning. Suppose
    there are four towns in a region with all towns connected to at least one other
    town by a road. Suppose also that each town has its own stock of supplies (perhaps
    liters of water for each resident) in case a cyclone hits the region and limits
    transportation for days or weeks. We can model this by creating a graph in R using
    the code in [Listing 6-3](#listing6-3).
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们探索这些概念如何帮助灾难物流规划。假设在一个地区有四个城镇，每个城镇通过道路与至少一个其他城镇相连接。假设每个城镇都有自己的物资储备（可能是每个居民的水量），以防飓风袭击该地区并限制交通数天或数周。我们可以通过在
    R 中使用[清单 6-3](#listing6-3)中的代码来建模这一情况。
- en: '[PRE6]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Listing 6-3: A script that generates the example graph of connected towns,
    plots the graph, adds resources to each town, visualizes these resources, and
    analyzes mutually connected town resources'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 清单 6-3：一个脚本，生成连接城镇的示例图，绘制该图，向每个城镇添加资源，可视化这些资源，并分析相互连接的城镇资源。
- en: '[Listing 6-3](#listing6-3) creates a matrix of towns connected by roads and
    then converts this into a weighted graph. Once it is in graph form, we can add
    in information about resources available in each town and plot a picture with
    this information included, along with the distances between towns connected by
    a road. We can then calculate mutual resources between towns and minimum travel
    distances from a given town to another. This will help us assess resources available
    in a disaster and the best routes down which to send supplies.'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '[清单 6-3](#listing6-3)创建一个由道路连接的城镇矩阵，然后将其转换为加权图。一旦转换为图形，我们可以添加每个城镇中可用资源的信息，并绘制包含这些信息的图像，以及通过道路连接的城镇之间的距离。然后，我们可以计算城镇之间的相互资源以及从某一城镇到另一城镇的最短旅行距离。这将帮助我们评估灾难中可用的资源以及最佳的物资运输路线。'
- en: '[Listing 6-3](#listing6-3)’s first plot should output a diagram showing which
    towns are connected and the number of miles between towns, as shown in [Figure
    6-10](#figure6-10).'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '[清单 6-3](#listing6-3)的第一个图形应输出一个图，显示哪些城镇是连接的，以及城镇之间的英里数，如[图 6-10](#figure6-10)所示。'
- en: '![](image_fi/503083c06/f06010.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/503083c06/f06010.png)'
- en: 'Figure 6-10: A plot of town connectivity and miles of road between connected
    towns'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6-10：城镇连接性图和连接城镇之间的道路英里数
- en: '[Figure 6-10](#figure6-10) shows that towns 2, 3, and 4 are connected by multiple
    roads, such that if one road is blocked, the town can still be reached by looping
    around through another town. However, town 1 is relatively isolated despite being
    located only 4 miles from the nearest town. The road connecting towns 2 and 3
    is quite long (perhaps this is a back road that meanders through a densely wooded
    area or around several canals).'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
- en: The second `plot` in [Listing 6-3](#listing6-3) should output a graph that adds
    total resources for each town, as shown in [Figure 6-11](#figure6-11).
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
- en: '![](image_fi/503083c06/F06011r.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6-11: A plot of town connectivity, miles of road between connected towns,
    and resources within each town'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
- en: '[Figure 6-11](#figure6-11) gives us a richer understanding of connectivity
    and potentially shared resources among the four towns. Notice that town 1 has
    a relatively small water supply stocked for the disaster (10 liters per resident).
    However, if the road between towns 1 and 4 holds up during the disaster, it is
    easy to move some of the water from town 4 (with 200 liters per resident) to town
    1, such that town 1 has sufficient water. It’s also easy to move water between
    towns 4 and 2 (which has 500 liters per resident stocked up) provided the road
    directly connecting these towns holds up in the disaster.'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
- en: The maximal clique calculation yields mutually connected towns (towns with mutual
    *n*-way connections). This gives a connection between towns 1 and 4 (with the
    single road) and towns 2, 3, and 4, which are mutually connected. From this information,
    we can calculate resources at each town’s disposal should the roads hold between
    towns. Towns 1 and 4 mutually contain 210 resident-liters; the three-way clique
    (towns 2, 3, and 4) contains 780 resident-liters.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
- en: Using a shortest path algorithm, we can calculate shortest routes between any
    two towns to understand how quickly supplies might be routed between towns should
    supplies run low in a given town and roads are not damaged by the disaster. [Table
    6-2](#table6-2) gives the miles that would need to be driven between towns in
    this scenario.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
- en: 'Table 6-2: Shortest Distances Between Pairs of Towns'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
- en: '|  | **Town 1** | **Town 2** | **Town 3** | **Town 4** |'
  id: totrans-110
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- |'
  id: totrans-111
  prefs: []
  type: TYPE_TB
- en: '| **Town 1** | 0 | 6 | 10 | 4 |'
  id: totrans-112
  prefs: []
  type: TYPE_TB
- en: '| **Town 2** | 6 | 0 | 8 | 2 |'
  id: totrans-113
  prefs: []
  type: TYPE_TB
- en: '| **Town 3** | 10 | 8 | 0 | 6 |'
  id: totrans-114
  prefs: []
  type: TYPE_TB
- en: '| **Town 4** | 4 | 2 | 6 | 0 |'
  id: totrans-115
  prefs: []
  type: TYPE_TB
- en: The longest route in this scenario (10 miles) is trying to get supplies from
    town 3 to town 1 when town 1 runs low on water. Notice that it’s shorter to bypass
    the longest road to route supplies between towns 2 and 3 (8 miles versus 12 miles).
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
- en: 'We can examine a scenario where one or more roads is damaged in the disaster
    by adding to [Listing 6-3](#listing6-3) to remove roads connecting towns and re-examine
    mutual supplies and shortest paths:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: This script removes a link between towns 2 and 4, recalculating the metrics
    to help us assess how the situation has changed with the blockage of the road
    between towns 2 and 4\. These modifications should yield a plot of situation 2
    similar to [Figure 6-12](#figure6-12).
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 这个脚本移除了镇2和镇4之间的链接，并重新计算了度量，以帮助我们评估由于镇2和镇4之间道路的阻断，情境发生了哪些变化。这些修改应产生一个类似于[图6-12](#figure6-12)的情境2图。
- en: '![](image_fi/503083c06/F06012r.png)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![](image_fi/503083c06/F06012r.png)'
- en: 'Figure 6-12: A modified plot of situation 1 with one road destroyed in the
    disaster'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 图6-12：情境1的修改版图，其中一条道路在灾难中被摧毁
- en: As [Figure 6-12](#figure6-12) shows, this scenario breaks the triangle present
    in situation 1, isolating town 2\. If town 1’s water supply runs low, the water
    must be shared between towns 1 and 2 with the expectation that it may be difficult
    to move water from town 2 to replenish the supplies.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 如[图6-12](#figure6-12)所示，这种情境打破了情境1中的三角形，孤立了镇2。如果镇1的水源短缺，水必须在镇1和镇2之间共享，并且预计从镇2向镇1输送水源可能会很困难。
- en: If we look at the cliques, we can see two-way connections among towns, and mutual
    supplies between towns are more spread out than in the three-way connection present
    in situation 1\. Towns 2 and 3 have a decent mutual supply, but the other towns
    may have delays in routing needed water. In addition, the miles needed to travel
    increases, as we can see in the shortest path table ([Table 6-3](#table6-3)).
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们查看这些团体，可以看到城镇之间的双向连接，且城镇间的相互供应比情境1中的三向连接更为分散。镇2和镇3之间有一个不错的相互供应，但其他镇可能会在所需水源的传输上产生延迟。此外，如在最短路径表中所示（[表6-3](#table6-3)），需要行驶的里程也增加了。
- en: 'Table 6-3: Shortest Distances Among Pairs of Towns'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 表6-3：城镇对之间的最短距离
- en: '|  | **Town 1** | **Town 2** | **Town 3** | **Town 4** |'
  id: totrans-125
  prefs: []
  type: TYPE_TB
  zh: '|  | **镇1** | **镇2** | **镇3** | **镇4** |'
- en: '| --- | --- | --- | --- | --- |'
  id: totrans-126
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- |'
- en: '| **Town 1** | 0 | 22 | 10 | 4 |'
  id: totrans-127
  prefs: []
  type: TYPE_TB
  zh: '| **镇1** | 0 | 22 | 10 | 4 |'
- en: '| **Town 2** | 22 | 0 | 12 | 18 |'
  id: totrans-128
  prefs: []
  type: TYPE_TB
  zh: '| **镇2** | 22 | 0 | 12 | 18 |'
- en: '| **Town 3** | 10 | 12 | 0 | 6 |'
  id: totrans-129
  prefs: []
  type: TYPE_TB
  zh: '| **镇3** | 10 | 12 | 0 | 6 |'
- en: '| **Town 4** | 4 | 18 | 6 | 0 |'
  id: totrans-130
  prefs: []
  type: TYPE_TB
  zh: '| **镇4** | 4 | 18 | 6 | 0 |'
- en: Routing water from the town with the largest supply (town 2) has become a lot
    more difficult, with greatly increased expected travel times. Should scenario
    2 appear likely, it’s probably best to redistribute the water prior to the disaster
    to avoid delays in routing.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 从水源最多的城镇（镇2）调度水变得更加困难，预计的行驶时间大幅增加。如果情境2有可能发生，最好在灾难发生前重新分配水源，以避免传输延迟。
- en: Discrete exterior derivatives have other applications. Graphics rendering and
    engineering problems have been particular areas of interest within discrete exterior
    derivatives (and discrete exterior calculus in general). A few of the more common
    applications in engineering are flux and flow calculations on discrete objects
    or computer modeling of processes. Within graphics rendering, graphs are typically
    replaced with more general meshes.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 离散外微分算子有其他应用。图形渲染和工程问题是离散外微分算子（以及离散外微积分）特别感兴趣的领域。工程中的一些常见应用包括对离散对象的通量和流量计算，或对过程的计算机建模。在图形渲染中，图通常被更一般的网格所替代。
- en: In some instances, it is easier to use cohomology (and its tool, discrete exterior
    derivatives) to study an object or point cloud than to use persistent homology,
    as the end result will find the same boundaries and objects. However, little has
    been done to make explicit R packages for applying discrete exterior derivatives
    to data, and code must be parsed together as in [Listing 6-3](#listing6-3). Automation
    and object manipulation code would help facilitate the adoption of discrete exterior
    derivatives within data science and other fields.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些情况下，使用上同调（及其工具：离散外微分算子）来研究对象或点云比使用持久同调要容易，因为最终结果会找到相同的边界和对象。然而，关于如何将离散外微分算子应用于数据的R包开发很少，因此代码必须像在[清单6-3](#listing6-3)中一样手动解析。自动化和对象操作代码将有助于推动离散外微分算子在数据科学和其他领域的采用。
- en: Nonlinear Algebra in Machine Learning Algorithms
  id: totrans-134
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 机器学习算法中的非线性代数
- en: Another intriguing and recent development with respect to geometry in machine
    learning is the notion of nonlinear algebra in machine learning algorithms. Many
    machine learning algorithms rely heavily on linear algebra to compute things such
    as gradients, least squares estimators, and so on. However, in relationships and
    spaces that aren’t flat or involving straight lines, the linear algebra provides
    only an approximation of quantities calculated. Take a look at [Figure 6-13](#figure6-13),
    which shows a straight line (assumed by linear algebra tools, such as those used
    in regression) and a curved line (which may cause an estimation problem for linear
    algebra tools).
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
- en: '![](image_fi/503083c06/f06013r.png)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6-13: A straight line and curved line'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
- en: Nonlinearity introduces error into the calculations and final result of an algorithm
    when curves and nonlinear spaces are estimated using linear tools. Imagine using
    a ruler to measure the lower line in [Figure 6-13](#figure6-13). It would be hard
    to get an exact length of the line relative to the straight line above. If the
    length of the line were a quantity that needed to be minimized or maximized by
    an algorithm, such a measurement could potentially find a nonglobal solution or
    distort the quantity enough to cause problems in predictive accuracy or model
    fit statistics like sum of square error or Bayesian information criterion.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
- en: One proposed alternative to linear algebraic calculations within machine algorithms
    is to use *numerical algebraic geometry*, a branch of nonlinear algebra that deals
    with the intersections of curves. For instance, consider the two-dimensional ellipse
    intersected by a one-dimensional curve, shown in [Figure 6-14](#figure6-14).
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
- en: '![](image_fi/503083c06/f06014r.png)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6-14: A plot of a curve intersecting an ellipse'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
- en: Different types of matrices and matrix operations can be used to solve nonlinear
    systems analogously to how linear algebra solves linear systems; numbers populating
    a matrix are simply replaced with polynomial equations. Some of these intersecting
    curve problems are nonconvex problems, which often pose issues to machine learning
    algorithms and the linear algebra powering them.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
- en: '*Convex optimization problems* are those in which the optimization function
    creates a region in which a line passing through the region is in the region continuously
    (rather than passing multiple regions and nonregions within the object), as shown
    in [Figure 6-15](#figure6-15).'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
- en: '![](image_fi/503083c06/f06015r.png)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6-15: A convex object'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
- en: If, however, the region contains holes or indents, this is no longer the case,
    and the region is designated as *nonconvex*, such as in [Figure 6-16](#figure6-16),
    where the hole inside the region splits the interior set into the set within the
    region and the set within the hole.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
- en: '![](image_fi/503083c06/f06016r.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6-16: A nonconvex object'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
- en: Optimization algorithms often struggle with nonconvex functions and regions
    within the optimization function, as the linear programming commonly used to solve
    these problems isn’t as amenable to nonconvex optimization problems and as stepwise
    methods can get stuck in the local optima around the hole or divots in the region.
    Unfortunately, many real-world datasets and the optimization functions used on
    them involve nonconvex regions. Numerical algebraic geometry offers an accurate
    solution for nonconvex optimization problems, which come up often in real-world
    data situations. Once the system of polynomials is set up in matrix form, many
    software platforms and programs exist to do the computations, including the Bertini
    and Macauley software, which can connect to both R and Python. This allows for
    solvers that work well in nonconvex optimization problems.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
- en: Several recent publications and workshops in numerical algebraic geometry suggest
    that nonlinear algebra is a viable alternative to the current machinery in algorithms
    for other types of problems that may be convex, loosening mathematical assumptions
    and providing improvements in accuracy. One recent paper (Evans, 2018) found that
    the local geometry of many possible solutions overlaps for many types of statistical
    models (including Lasso, ARIMA models for time-series data, and Bayesian networks).
    This means that algorithms can’t distinguish well between potential predictor
    sets or parameter values in the model space, particularly for the sample sizes
    commonly used and suggested for these problems. One can solve this problem by
    either fitting the model in tangent space, as we saw in the previous section,
    or using numerical algebraic geometry instead of linear algebra for optimization.
    This suggests some immediate applications of numerical algebraic geometry and
    other nonlinear approaches to machine learning algorithms for improved algorithm
    performance and model fits.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
- en: Unfortunately, packages to implement these algorithms do not exist in R at this
    time, so we won’t explore this further in an example.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
- en: Comparing Choice Rankings with HodgeRank
  id: totrans-152
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Discerning choice preference across a population of customers is a common machine
    learning task. For instance, a company might want customers to compare items on
    a list of potential new features in software to prioritize the engineering team’s
    time in the coming year. Comparing choice rankings also helps companies market
    new products and services to existing users and derive new campaigns for items
    that are likely to sell well with existing customers.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
- en: Let’s look at a simple example of ranking activity preference for a day at the
    beach. Perhaps we’re looking at data that a hotel collected from recent guests
    on which activities they preferred during their stay; this would allow them to
    prioritize beach usage and staff hiring to meet future demand for the main activities
    their guests prefer. Here, we have three choices of activity (lying on the beach,
    swimming, or surfing), with one preference as a clear favorite (surfing). [Figure
    6-17](#figure6-17) summarizes this simple situation.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
- en: '![](image_fi/503083c06/f06017.png)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6-17: A diagram ranking three choices relative to the other choices'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
- en: 'We can complicate this problem by adding a potentially new fourth activity
    that is preferred to the other three: kiteboarding. The ranking is still relatively
    easy to compute, as all activities are preferred to lying on the beach, one is
    preferable only to lying on the beach (swimming), one is preferred to every activity
    but kiteboarding (surfing), and one is preferred to the other three (kiteboarding),
    as shown in [Figure 6-18](#figure6-18).'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
- en: '![](image_fi/503083c06/f06018.png)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6-18: A diagram with another activity added to the preference data'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
- en: All of the information is given in the diagram, with this particular person
    filling out all choices relative to each other. This is rarely the case with real-world
    data, as shown in [Figure 6-19](#figure6-19).
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
- en: '![](image_fi/503083c06/f06019.png)'
  id: totrans-161
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6-19: An incomplete preference diagram of the four activities'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
- en: However, this information still shows a strong preference toward kiteboarding,
    with all pair-ranks existing for kiteboarding pairs and all pair-ranks pointing
    toward kiteboarding as the most preferred activity. In real-world data, it’s common
    not only to have missing information but to have preference loops in the data,
    such as the one in [Figure 6-20](#figure6-20), where surfing is preferred to swimming,
    and kiteboarding is preferred to surfing but not to swimming.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
- en: '![](image_fi/503083c06/f06020.png)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6-20: An example of incomplete and inconsistent ranking preference data'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
- en: This gives a local inconsistency of where kiteboarding and swimming might rank
    relative to each other when other options are available. However, surfing and
    kiteboarding are preferred to two other activities, suggesting they rank toward
    the top of possible options, and kiteboarding is preferred to surfing (giving
    a tiebreaker of sorts).
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
- en: The situation becomes a bit more nebulous when no consistent preferences exist
    globally, with each activity preferred to another activity, as shown in [Figure
    6-21](#figure6-21).
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
- en: '![](image_fi/503083c06/f06021.png)'
  id: totrans-168
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6-21: A diagram of incomplete preference data with no consistent preferences'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
- en: In the case of [Figure 6-21](#figure6-21), nothing can be said about which activity
    would be preferred to other activities, and results of the analyses would be inconclusive.
    This is common when customers are asked to rank features in financial apps or
    guests are asked to rank preferred activities. Most customers will exist in subgroups
    with their own unique needs, which might be the opposite needs of another important
    customer subgroup. It’s a challenge to prioritize features for development or
    choices to give guests to please the largest number of customers.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
- en: 'Many algorithms exist to do pairwise-rank comparisons to get a ranked list
    of preferences relative to each other (SVMRank, PageRank, and more); however,
    in general, they do not provide information about local and global inconsistencies
    in rank that might influence where an item or choice is placed relative to others.
    Algebraic geometry recently added a tool to the collection of pairwise-rank algorithms
    that can decompose the ranking results to include information about local and
    global inconsistencies of items; that would be *HodgeRank*, which can derive this
    information by leveraging an algebraic-geometry-based theorem common in engineering
    problems: the Hodge–Helmholtz decomposition.'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
- en: '*The Hodge*–*Helmholtz decomposition* partitions a vector flow (or flow on
    a graph) into three distinct components, shown in [Figure 6-22](#figure6-22):
    the *gradient flow*, which is locally and globally consistent; the *curl flow*,
    which is locally consistent but globally inconsistent; and the *harmonic flow*,
    which is locally inconsistent but globally consistent.'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
- en: '![](image_fi/503083c06/f06022.png)'
  id: totrans-173
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6-22: A diagram showing the flows broken down by the Hodge–Helmholtz
    decomposition'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
- en: In the beach examples, [Figure 6-20](#figure6-20) has a curl flow involving
    swimming, surfing, and kiteboarding (also harmonic if another activity is not
    ranked there). [Figure 6-21](#figure6-21) is an example of global harmonic flow
    (as well as local curl flow).
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
- en: The HodgeRank algorithm essentially extends PageRank for pairwise-ranking problems;
    the math boils down to a least squares problem on the graph data, allowing for
    assessments of global ranking and local ranking consistency. Thus, suspicious
    rankings can be flagged for a human analyst’s review. The algorithm also allows
    for a lot of missing data in the original pairwise ranking sets, making it widely
    applicable to the often-incomplete data on ranking problems in the real world
    (where users won’t click through three million video options to rank each relative
    to all of the others!). While a package does not exist in R and thus we will not
    walk through an example, implementations do exist in Matlab, and readers familiar
    with Matlab who are interested in this algorithm are encouraged to use the resources
    listed for HodgeRank.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  id: totrans-177
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this chapter, we learned about newer algorithms derived from differential
    and algebraic geometry and explored the use of both dgLARS and discrete exterior
    calculus on data analysis problems, including the Quora gifted sample, a credit-lending
    sample, and a disaster-planning scenario. Many more algorithms are being developed,
    and we’ve given an overview of how nonlinear algebra and Hodge theory have contributed
    to machine learning in recent years, impacting important types of industry problems
    (such as preference ranking and parametric model estimation).
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we’ll return to persistent homology and examine another
    tool of algebraic topology called the Mapper algorithm. Both of these will be
    used on our student sample introduced in this chapter.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
