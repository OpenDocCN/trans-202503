<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" epub:prefix="index: http://www.index.com/" lang="en" xml:lang="en">
	<head>
		<title>Chapter 5: Social Engineering and Phishing Attacks</title>
		<link href="NSTemplate_v1.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:af29b7b1-e841-4e64-a1ef-e03d2d2c1d42" name="Adept.expected.resource"/>
	</head>
	<body epub:type="bodymatter chapter">
		<section>
			<header>
				<h1 class="chapter"><span class="ChapterNumber"><span epub:type="pagebreak" id="Page_43" title="43"/>5</span><br/><span class="ChapterTitle">Social Engineering and Phishing Attacks </span></h1>
			</header>
			<figure class="opener">
				<img alt="" src="image_fi/book_art/chapterart.png"/>
			</figure>
			<p class="ChapterIntro">In this chapter, you’ll use your virtual hacking lab to learn one of the most common and successful ways that attackers access victims’ computers and accounts: social engineering.</p>
			<p><em>Social engineering</em> means tricking people into giving out sensitive or valuable information like passwords, credit card numbers, or medical data. Researchers estimate that 94 to 98 percent of all computer attacks start with some form of social engineering. In movies, hackers often do something really advanced to break into a network, but in the real world, they usually just send an email tricking someone into giving up their username and password. This social engineering technique is known as <em>phishing</em>.</p>
			<p>In this chapter, you’ll learn about the dangers of social engineering by creating a phishing website and sending a phishing email. You’ll see how easy it is for attackers to fool people into giving up their usernames and passwords and how to protect yourself against phishing attacks.</p>
			<h2 id="h1-502000c05-0001"><span epub:type="pagebreak" id="Page_44" title="44"/>How Social Engineering Works</h2>
			<p class="BodyFirst">Social engineering takes advantage of our human desire to be social, help others, and be part of a group, or it manipulates our basic human emotions like fear, curiosity, or greed to trick us into making a security mistake or giving away sensitive information. Peer pressure is a form of social engineering: it persuades someone to do something they wouldn’t normally do because “everyone else” is doing it or for fear of missing out. Similarly, online scammers use social engineering to manipulate us into making bad decisions without thinking about the consequences.</p>
			<p>In the physical world, con artists and criminals socially engineer their way into secure buildings by dressing like a delivery person or a utility worker, or they “tailgate” behind someone by carrying a large box and asking someone to hold the door open for them. Once inside, they “shoulder surf” by watching over someone’s shoulder while they enter a password.</p>
			<p>In the digital world, social engineers use email, social media, ads, websites, text messages, automated phone calls, and other technologies. Online criminals can fool unsuspecting users into clicking a bad link, logging in to a fake website, accepting a fake friend request, entering their credit card information, downloading and running malware, or giving out their personal details.</p>
			<p>The most common type of social engineering attack is phishing. In a phishing attack, an attacker uses email to trick you into downloading files infected with malware or visiting a malicious website disguised as the login page for an online service. If you log in to the fake service, the attacker gets your username and password.</p>
			<p>
				To understand how easy it is for an attacker to set up a phishing attack, we’ll set one up ourselves using your Kali Linux VM. Seeing how it’s done will help you spot even the best phishing emails <em>before</em> you click one.</p>
			<h2 id="h1-502000c05-0002">Creating a Phishing Website</h2>
			<p class="BodyFirst">We’ll start by creating a phishing website that looks just like the Twitter login page. The site will capture and store usernames and passwords.</p>
			<ol class="decimal">
				<li value="1">Launch your Kali Linux VM and click the Kali icon on the menu panel at the top left of the screen. Open the <em>13 - Social Engineering Tools</em> folder and find the <em>Social Engineering Toolkit (SET)</em> application, as shown in <a href="#figure5-1" id="figureanchor5-1">Figure 5-1</a>. This program, also called the Social-Engineer Toolkit, enables security professionals to develop advanced social engineering attacks to test a company’s security. This type of ethical hacking is called <em>penetration testing</em> (<em>pentesting</em> for short) because you’re testing whether you can penetrate a company’s defenses. 
					<aside epub:type="sidebar">
						<div class="top hr">
							<hr/>
						</div>
						<section class="note">
							<h2><span class="NoteHead">WARNING</span></h2>
							<p>	Security teams must have the explicit written permission of the company’s owner to perform pentesting. Without such permission, make sure you phish only yourself.</p>
							<div class="bottom hr">
								<hr/>
							</div>
						</section>
					</aside>
			<span epub:type="pagebreak" id="Page_45" title="45"/>
					<figure>
						<img alt="f05001" class="" src="image_fi/502000c05/f05001.png"/>
						<figcaption>
							<p><a id="figure5-1">Figure 5-1</a>: Find the <em>13 - Social Engineering Tools</em> folder and the SET application.</p>
						</figcaption>
					</figure>
					</li>
				<li value="2">Click the SET icon to open the Social Engineering Toolkit. If prompted for your password, enter <code class="bold">kali</code>. (Note that you may not see your password as you type.) As the application loads, SET will ask you to accept the terms of use, as shown in <a href="#figure5-2" id="figureanchor5-2">Figure 5-2</a>. Enter <code class="bold">Y</code> to agree to use SET for lawful purposes only. 
					<aside epub:type="sidebar">
						<div class="top hr">
							<hr/>
						</div>
						<section class="note">
							<h2><span class="NoteHead">NOTE</span></h2>
							<p>
									Both Kali Linux and the Social Engineering Toolkit update often, so some of the menu options may change. However, you should still be able to find the same features discussed here. If you make a wrong selection along the way, just enter <code>99</code> to return to the previous menu.</p>
							<div class="bottom hr">
								<hr/>
							</div>
						</section>
					</aside>
			</li>
				<li value="3">You should now see something like the main SET menu shown in <a href="#listing5-1" id="listinganchor5-1">Listing 5-1</a>. 
					<pre><code>Select from the menu: 1) Social-Engineering Attacks 2) Penetration Testing (Fast-Track) 3) Third Party Modules 4) Update the Social-Engineer Toolkit 5) Update SET configuration 6) Help, Credits, and About 99) Exit the Social-Engineer Toolkit
set&gt;</code></pre>
					<p class="CodeListingCaption"><a id="listing5-1">Listing 5-1</a>: The main SET menu</p>
					<span epub:type="pagebreak" id="Page_46" title="46"/>
					<figure>
						<img alt="f05002" class="" src="image_fi/502000c05/f05002.png"/>
						<figcaption>
							<p><a id="figure5-2">Figure 5-2</a>: To use SET, you must agree to the terms of service.</p>
						</figcaption>
					</figure>
					</li>
				<li value="4">Enter <code class="bold">1</code> to select Social-Engineering Attacks. This should bring you to the Attacks menu, as shown in <a href="#listing5-2" id="listinganchor5-2">Listing 5-2</a>.
					<pre><code>   1) Spear-Phishing Attack Vectors 2) Website Attack Vectors 3) Infectious Media Generator 4) Create a Payload and Listener 5) Mass Mailer Attack <em>--snip--</em></code></pre>
					<p class="CodeListingCaption"><a id="listing5-2">Listing 5-2</a>: The SET Attacks menu</p>
					</li>
				<li value="5">Under the Attacks menu, enter <code class="bold">2</code> to select Website Attack Vectors. This should take you to the Website Attack Vectors menu, shown in <a href="#listing5-3" id="listinganchor5-3">Listing 5-3</a>.
					<pre><code>   1) Java Applet Attack Method  2) Metasploit Browser Exploit Method 3) Credential Harvester Attack Method 4) Tabnabbing Attack Method 5) Web Jacking Attack Method <em>--snip--</em></code></pre>
					<p class="CodeListingCaption"><a id="listing5-3">Listing 5-3</a>: The SET Website Attack Vectors menu</p>
					</li>
				<li value="6"><span epub:type="pagebreak" id="Page_47" title="47"/>Enter <code class="bold">3</code> to select Credential Harvester Attack Method. This should open the Credential Harvester Attack menu, which gives us a few options, as shown in <a href="#listing5-4" id="listinganchor5-4">Listing 5-4</a>.
					<pre><code>   1) Web Templates 2) Site Cloner 3) Custom Import</code></pre>
					<p class="CodeListingCaption"><a id="listing5-4">Listing 5-4</a>: The SET Credential Harvester Attack menu</p>
					</li>
				<li value="7">We’ll use the second option, Site Cloner, to make a <em>clone</em>, or exact copy, of a real website for our phishing attack. This kind of phishing is called <em>credential harvesting</em> because its goal is to collect people’s <em>credentials</em>, or usernames and passwords. Press <code class="bold">2</code> to select Site Cloner and then press <b>ENTER</b>.</li>
			</ol>
			<h3 id="h2-502000c05-0001">Cloning a Login Page</h3>
			<p class="BodyFirst">SET’s Site Cloner will help you set up a clone of almost any login page. It downloads all the code needed to display an existing login page, such as for a social media platform, a bank, or an email service. As we saw when we used your browser’s Inspect tool in Chapter 1, this code is publicly available. Site Cloner then creates an exact copy of the page using the downloaded code. All that remains is to find a way to trick a user into entering their username and password into the cloned page.</p>
			<p>Follow these steps to clone the Twitter login page.</p>
			<ol class="decimal">
				<li value="1">First, the Site Cloner asks for the IP address of the machine that will store victims’ usernames and passwords. By default, the prompt shows the IP address of your Kali VM. In my case, that’s 10.0.9.4, as shown in the SET prompt:
					<pre><code>set:webattack&gt; IP address for the POST back in Harvester/Tabnabbing [10.0.9.4]:</code></pre>
					<p class="ListBody">If the IP address for your Kali VM is different, write it down, as you’ll need it later. Press <b>ENTER</b> to continue.</p>
					</li>
				<li value="2">SET should next ask for the URL of the site you want to clone:
					<pre><code>set:webattack&gt; Enter the url to clone:</code></pre>
					<p class="ListBody">For a successful credential-harvesting attack, you need to clone a login page that asks for a username and password on the same screen. Most online services, including many social media sites, fit this description, but some bank sites and email sites, including Gmail and Outlook, ask for the username on one screen and the password on another screen to prevent attacks like this one.</p>
					<p class="ListBody"><span epub:type="pagebreak" id="Page_48" title="48"/>We’ll clone the Twitter login page. Enter <code class="bold">https://twitter.com/login</code> into the SET window:</p>
					<pre><code>set:webattack&gt; Enter the url to clone: <code class="bold">https://twitter.com/login</code></code></pre>
			</li>
				<li value="3">SET should now say it’s cloning the website. It may ask you to press <span class="KeyCaps">ENTER</span> again to continue. If SET asks you to confirm anything else, press <code>Y</code> or <span class="KeyCaps">ENTER</span> as requested.</li>
				<li value="4">After a moment, you’ll see a message confirming that the SET Credential Harvester Attack is running:
					<pre><code>[*] The Social-Engineer Toolkit Credential Harvester Attack
[*] Credential Harvester is running on port 80
[*] Information will be displayed to you as it arrives below:</code></pre>
			</li>
			</ol>
			<p>SET was able to start a temporary web server on your Kali VM that victims can surf to. Now it’s waiting for victims to type their information into the site.</p>
			<h3 id="h2-502000c05-0002">Let’s Harvest Some Credentials!</h3>
			<p class="BodyFirst">Let’s test our phishing website to see if it works. While leaving the terminal window open, click the Kali icon on the menu panel and go to <b>Favorites</b><span class="MenuArrow">▶</span><b>Web Browser</b>. Once the browser opens, enter <code class="bold">localhost</code> into the address bar. You should see an almost perfect replica of the Twitter home page, as shown in <a href="#figure5-3" id="figureanchor5-3">Figure 5-3</a>. (Web pages change from time to time, as do browsers, so what you see may look slightly different.) The only way to tell that the page isn’t real is to look in the address bar.</p>
			<figure>
				<img alt="f05003" class="keyline" src="image_fi/502000c05/f05003.png"/>
				<figcaption>
					<p><a id="figure5-3">Figure 5-3</a>: The cloned Twitter home page looks identical to the real one.</p>
				</figcaption>
			</figure>
			<p><span epub:type="pagebreak" id="Page_49" title="49"/>First, you should see the address you entered (<em>localhost</em>) instead of the real address (<a class="LinkURL" href="https://twitter.com">https://twitter.com</a>). Second, there’s no secure site lock icon next to the address bar, so the browser is telling you that the page isn’t secure.</p>
			<aside epub:type="sidebar">
				<div class="top hr">
					<hr/>
				</div>
				<section class="note">
					<h2><span class="NoteHead">NOTE</span></h2>
					<p>
							If your cloned website doesn’t appear correctly, the site may have implemented security controls to prevent cloning, making phishing harder for attackers. Close the SET terminal window and launch SET again. Follow the steps in the previous section to clone a different website. Additionally, keep in mind that your browser in Kali will display pages using the Kali-Dark theme by default, with light text on a dark background. If you’d like to change to a lighter color theme, like the one shown in <a href="#figure5-3">Figure 5-3</a>, go to the Kali menu button, click <b>Settings</b><span class="MenuArrow">▶</span><b>Appearance</b>, and choose <b>Kali-Light</b>.</p>
					<div class="bottom hr">
						<hr/>
					</div>
				</section>
			</aside>
			<p>
				Now that we know our cloned site looks like the real thing, let’s see if it can capture login details. Click <b>Log in</b> to go to the login page. Enter a made-up username and password and click <b>Log in</b> again.</p>
			<aside epub:type="sidebar">
				<div class="top hr">
					<hr/>
				</div>
				<section class="note">
					<h2><span class="NoteHead">WARNING</span></h2>
					<p>	Never enter your real username and password into a phishing form, even one that you created yourself. You can accidentally give away your password if anyone else ever uses your Kali virtual machine, because the SET phishing web form stores passwords in a simple text file.</p>
					<div class="bottom hr">
						<hr/>
					</div>
				</section>
			</aside>
			<p>
				I’ve entered a username of GeorgeJetson with the password Jane!!!, as shown in <a href="#figure5-4" id="figureanchor5-4">Figure 5-4</a>.</p>
			<figure>
				<img alt="f05004" class="keyline" src="image_fi/502000c05/f05004.png"/>
				<figcaption>
					<p><a id="figure5-4">Figure 5-4</a>: Enter fake information into your SET cloned site; never enter your real username and password on a phishing site.</p>
				</figcaption>
			</figure>
			<p><span epub:type="pagebreak" id="Page_50" title="50"/>Once you submit your fake login credentials, SET will redirect your browser to the real Twitter website, <a class="LinkURL" href="https://twitter.com/">https://twitter.com/</a>. You can tell it’s the real site from the address bar, where you’ll see the lock icon. SET takes the victim to the real login page to make them think that they mistyped their login information. This time, they log in to the real site without ever realizing that an attacker stole their credentials.</p>
			<p>Now open the terminal window running SET. If your phishing website worked correctly, you’ll see a screen full of web form data that was submitted. Scroll up if needed, and you’ll see the username and password you entered:</p>
			<pre><code>[*] WE GOT A HIT! Printing the output:
...
POSSIBLE USERNAME FIELD FOUND: session[username_or_email]=GeorgeJetson
POSSIBLE PASSWORD FIELD FOUND: session[password]=Jane!!!</code></pre>
			<p>If SET didn’t retrieve the login information, fill out the cloned form again. If you still can’t find the username and password you entered, close SET and try cloning a different site.</p>
			<p>As long as SET is running, you can submit usernames and passwords to your form by going to your Kali IP address in any browser that has access to your Kali VM’s network. That means you can start up your Windows VM, pretend you’re a phishing victim surfing to your Kali VM’s IP address (10.0.9.4 or similar), and enter a username and password into the fake page.</p>
			<h3 id="h2-502000c05-0003">Creating a Phishing Email</h3>
			<p class="BodyFirst">The final step in a phishing attack is to create and send a phishing email with a link to your phishing site’s IP address. Remember, SET’s Site Cloner is running a fake version of the Twitter login page on your Kali VM, so it uses your Kali VM’s IP address. In your Kali or Windows VM, log in to your email account and compose a new email. Your phishing email can be as simple as this:</p>
			<blockquote class="blockquote">
				<p class="Blockquote"><code>Subject: Unusual account activity</code></p>
				<p class="Blockquote"><code>Message: Someone attempted to log in to your Twitter account from Budapest, Hungary. If this wasn't you, please log in to your account and check your Security settings: http://10.0.9.4.</code></p>
			</blockquote>
			<p>Email the message to yourself and open it on either your Kali or Windows 10 VM while SET is running. Clicking the link should take you to your cloned phishing site!</p>
			<p>
				Most people, however, probably wouldn’t click the link in the email. The email doesn’t look like a regular message from Twitter, and the link shows an IP address rather than the Twitter URL. To create a more convincing phishing scam, an attacker might instead copy a real email from Twitter, one that uses the Twitter logo and style, and paste it into a new message. Then they would change the text and links to try to convince people to click through to the cloned site. <a href="#figure5-5" id="figureanchor5-5">Figure 5-5</a> shows an example I cooked up.</p>
				<span epub:type="pagebreak" id="Page_51" title="51"/>
				<figure>
				<img alt="f05005" class="" src="image_fi/502000c05/f05005.png"/>
				<figcaption>
					<p><a id="figure5-5">Figure 5-5</a>: I converted a real email from Twitter into a phishing email by changing the text and hyperlinks.</p>
				</figcaption>
			</figure>
			<p>
				I made it look like someone tried to hack the user’s account from North Korea to motivate them to click the link to check their “Security settings.” Next, I added a hyperlink for the text “Security settings” that takes the user to my cloned login page. In most email programs, you can insert a hyperlink by highlighting the text you want to turn into a link, clicking the chain-link icon (boxed in <a href="#figure5-5">Figure 5-5</a>), and entering the link address. With the suspicious IP address hidden behind the text “Security settings,” people are more likely to click through to the phishing site.</p>
			<p>Now that you understand phishing attacks, let’s look at how you can defend yourself against them.</p>
			<h2 id="h1-502000c05-0003">Protecting Yourself Against Phishing Attacks</h2>
			<p class="BodyFirst">You can protect yourself from email scams with just a few simple tips:</p>
			<ul>
				<li>Mouse over links in your email (don’t click them!) to see if the link address is suspicious, either because it’s misspelled or unusually long/numeric. The address usually appears at or near the bottom of the screen in your browser or email program when you do this. (You can also use VirusTotal to check a link address for malware, as we did back in Chapter 4.)</li>
				<li>
					Check the From: and To: fields of the email to make sure both are authentic. Look for misspellings or different domain names, like <em>gmail.com</em> instead of <em>yourbank.com</em>, in the sender’s address.</li>
				<li><span epub:type="pagebreak" id="Page_52" title="52"/>If you’re asked for personal information, think carefully about who’s asking for it, what’s being asked for, and why the information is needed.</li>
				<li>If you’re ever unsure about the source of an email, don’t click or open anything. Call the person or company (using a real phone number, not one found in the email) to verify any important transactions or urgent problems.</li>
			</ul>
			<p>
				If you suspect that an email is fake, open a separate web browser window and visit the real website by entering the real URL or searching online for the business name. Double-check the address bar to make sure the URL is what you expect. Even then, only enter your username and password into a login page if the site is secure. You can tell if a website is secure if the URL begins with <em>https://</em> and the secure website lock symbol appears in your browser’s address bar.</p>
			<h2 id="h1-502000c05-0004">The Takeaway</h2>
			<p class="BodyFirst">In this chapter, you learned that social engineers use human emotions against their victims to lure them into making the wrong choice, both in person and online. You learned about the most common online social engineering attack—phishing.</p>
			<p>To understand how easy and effective phishing is, you cloned a login page with the Social Engineering Toolkit (SET) in Kali Linux that allowed you to harvest the credentials of unsuspecting users. You created a phishing email linking to the cloned page, and you saw how attackers can create more convincing emails by starting with a real email, then changing the text and links.</p>
			<p>You learned to protect yourself from phishing attacks by looking carefully at the From: and To: fields in any email asking you to click a link, open a document, or take any action out of the ordinary. You also learned to check links by mousing over each one and examining the URL. Strange or misspelled web addresses, as well as unusually long or numeric IP addresses in a URL, can be clues that the address might be from a phishing attack. When in doubt, don’t click any links in an email. Instead, open a separate browser window, type the domain name of the real website where you have an account, and log in directly.</p>
			<p>In the next chapter, you’ll add another important tool to your hacking repertoire: malware. Malware will allow you to remotely take over another computer so you can steal files, log keystrokes, and even access the user’s webcam.</p>
		</section>
	</body>
</html>