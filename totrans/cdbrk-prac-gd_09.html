<html><head></head><body>
<div id="sbo-rt-content"><section>
<header>
<h1 class="chapter">
<span class="ChapterNumber"><span epub:type="pagebreak" id="Page_175" title="175"/><a class="XrefDestination" id="9"/><span class="XrefDestination" id="xref-502727c09-001"/>9</span><br/>
<span class="ChapterTitle"><a class="XrefDestination" id="Completecolumnartranspositionciphers"/><span class="XrefDestination" id="xref-502727c09-002"/>Complete columnar transposition ciphers</span></h1>
</header>
<figure class="graphic">
<img alt="" class="" height="475" src="image_fi/502727c09/g09001.png" width="844"/></figure>
<p class="BodyFirst"><span epub:type="pagebreak" id="Page_176" title="176"/>In 1935, somebody sent the anonymous message shown in <a href="#figure9-1" id="figureanchor9-1">Figure 9-1</a> to President Franklin D. Roosevelt.<sup class="endnote"><a href="b06.xhtml#c09-endnote-1" id="c09-noteref-1">1</a></sup><sup>, </sup><sup class="endnote"><a href="b06.xhtml#c09-endnote-2" id="c09-noteref-2">2</a></sup> While the second line, <code class="bold">OR ELSE YOU DIE</code>, is readable, the first is obviously encrypted. We can recover the plaintext by writing the message in lines of two letters each:</p>
<p class="BodyCustom"><code>ND</code></p>
<p class="BodyCustom"><code>OI</code></p>
<p class="BodyCustom"><code>MD</code></p>
<p class="BodyCustom"><code>EY</code></p>
<p class="BodyCustom"><code>LO</code></p>
<p class="BodyCustom"><code>AU</code></p>
<p class="BodyCustom"><code>EE</code></p>
<p class="BodyCustom"><code>TV</code></p>
<p class="BodyCustom"><code>IE</code></p>
<p class="BodyCustom"><code>BR</code></p>
<figure>
<img alt="" class="" height="255" src="image_fi/502727c09/f09001.png" width="490"/>
<figcaption><p><a id="figure9-1">Figure 9-1</a>: An anonymous encrypted message sent to President Franklin D. Roosevelt in 1935</p></figcaption>
</figure>
<p>Notice that, from top to bottom, the second column reads, <code class="bold">DIDYOUEVER</code>. The first column, from the bottom up, reads, <code class="bold">BITEALEMON</code>. These produce the intended plaintext, <code class="bold">DID YOU EVER BITE A LEMON?</code></p>
<p>Roosevelt suffered from polio (or a similar disease that, at the time, could not be distinguished from it). According to a since-refuted theory, lemon juice can cure polio. It seems the sender of this message wanted to recommend the lemon juice therapy to Roosevelt in this unconventional way.</p>
<p>One special thing about the encryption method used here is that no letter or word of the plaintext has been substituted. Instead, only the order of the letters has been changed. A cipher with this property is referred to as a <em>transposition cipher</em>.</p>
<h2 id="h1-502727c09-0001"><a class="XrefDestination" id="Howcompletecolumnartranspositioncipherswork"/><span class="XrefDestination" id="xref-502727c09-003"/>How complete columnar transposition ciphers work</h2>
<p class="BodyFirst">There are as many different transposition ciphers as there are ways to change the order of the letters in a message. The Roosevelt plaintext consists of twenty letters, which means that there are 2,432,902,008,176,640,000 (over two quintillion) ways to reorder it! In general, a message with <em>n</em> letters <span epub:type="pagebreak" id="Page_177" title="177"/>can be transposed in <em>n</em>-factorial (<em>n</em>! = 1 × 2 × 3 × 4 × 5 × . . . × <em>n</em>) ways and not necessarily distinct. However, using a random transposition method for encryption is not practical. Instead, a convenient transposition rule needs to be defined.</p>
<p>The postcard in <a href="#figure9-2" id="figureanchor9-2">Figure 9-2</a> was written with a transposition rule that is certainly convenient, but not very secure.<sup class="endnote"><a href="b06.xhtml#c09-endnote-3" id="c09-noteref-3">3</a></sup></p>
<figure>
<img alt="" class="" height="426" src="image_fi/502727c09/f09002.png" width="693"/>
<figcaption><p><a id="figure9-2">Figure 9-2</a>: This encrypted postcard is not very hard to decipher.</p></figcaption>
</figure>
<p>As will become obvious after you look at it for a moment, the message on the postcard is written backward. Writing in this way is an especially simple variant of a transposition cipher. Another approach is to write every word of a plaintext backward. The author of the following newspaper ad, published in the<em> Morning Pos</em><em>t</em> on April 4, 1888, used this method:<sup class="endnote"><a href="b06.xhtml#c09-endnote-4" id="c09-noteref-4">4</a></sup></p>
<p class="BodyCustom"><code>Ma gniyrt ym tseb ot esaelp uoy.</code></p>
<p>It should be clear that, to be of practical value in terms of concealing a message from an unwanted recipient, a transposition rule needs to be more complex. In addition, it should be possible to vary the transposition based on a key. For instance, we could divide a message into blocks of five letters and rearrange each block according to a defined scheme. Using such a scheme, the plaintext <code class="bold">SWISS CHEESECAKE</code> can be encrypted as follows:</p>
<figure class="graphic">
<img alt="" class="" height="161" src="image_fi/502727c09/g09002.png" width="455"/></figure>
<p><span epub:type="pagebreak" id="Page_178" title="178"/>This explains how the sign in <a href="#figure9-3" id="figureanchor9-3">Figure 9-3</a>, which we encountered at a party, was encrypted. It used the key <code class="bold">1</code> = <code>5</code>, <code class="bold">2</code> = <code>1</code>, <code class="bold">3</code> = <code>2</code>, <code class="bold">4</code> = <code>4</code>, <code class="bold">5</code> = <code>3</code>, or simply <code>5</code>, <code>1</code>, <code>2</code>, <code>4</code>, <code>3</code>.</p>
<figure>
<img alt="" class="" height="418" src="image_fi/502727c09/f09003.png" width="694"/>
<figcaption><p><a id="figure9-3">Figure 9-3</a>: The name of this cake is encrypted in a transposition cipher.</p></figcaption>
</figure>
<p>This method is equivalent to the following, which uses the keyword <code>TABLE</code>. First, we write the message in lines below the keyword:</p>
<p class="BodyCustom"><code>TABLE</code></p>
<p class="BodyCustom"><code>-----</code></p>
<p class="BodyCustom"><code>SWISS</code></p>
<p class="BodyCustom"><code>CHEES</code></p>
<p class="BodyCustom"><code>ECAKE</code></p>
<p>Then, we sort the columns such that the letters of the keyword are in alphabetical order:</p>
<p class="BodyCustom"><code>ABELT</code></p>
<p class="BodyCustom"><code>-----</code></p>
<p class="BodyCustom"><code>WISSS</code></p>
<p class="BodyCustom"><code>HESEC</code></p>
<p class="BodyCustom"><code>CAEKE</code></p>
<p>This produces the ciphertext <code>WISSS HESEC CAEKE</code> that we saw on the sign.</p>
<p>We could expand on this line-based transposition by transcribing the letters column-wise, which results in the following encrypted message: <code>WHC IEA SSE SEK SCE</code>. We could also transcribe the message from the bottom up, from right to left, or in some other way.</p>
<p>The strength of transposition ciphers was long underestimated. Many cipher designers thought that rearranging letters was less secure than replacing them. Only in the twentieth century did it become known that transposition ciphers can be quite secure.</p>
<p><span epub:type="pagebreak" id="Page_179" title="179"/>In this chapter, we will limit ourselves to cases in which the plaintext is written in lines of equal length, transposed column-wise, and transcribed in an arbitrary direction. In addition, we will assume that the last line is filled completely, containing no blank spaces. Transpositions of this kind are called “complete columnar transpositions.” The Roosevelt cryptogram shown earlier in this chapter is a complete columnar transposition, with a line length of two. So is the backward-written postcard (where the line length is equal to the message length). The newspaper ad that spells every word backward is definitely a transposition but not a complete columnar transposition, because it is not based on lines of constant length.</p>
<h2 id="h1-502727c09-0002"><a class="XrefDestination" id="Howtodetectacompletecolumnartransposition"/><span class="XrefDestination" id="xref-502727c09-004"/>How to detect a complete columnar transposition cipher</h2>
<p class="BodyFirst">From a codebreaker’s perspective, the nice thing about a transposition cipher (of any kind) is that the message’s letter frequencies do not change as a result of encryption. Therefore, frequency analysis helps us detect a cipher of this type. For instance, look at the following encrypted ad from the <em>Evening Standard</em> published on June 16, 1882:<sup class="endnote"><a href="b06.xhtml#c09-endnote-5" id="c09-noteref-5">5</a></sup></p>
<p class="BodyCustom"><code>ECALAP Ardnaxela eht ta sekal elpirt eht no strecnoc ocserf la eh tot og syadrutasdna syadsruht syadseut no.</code></p>
<p>If we perform a frequency analysis . . .</p>
<figure class="graphic">
<img alt="" class="" height="167" src="image_fi/502727c09/g09003.png" width="694"/></figure>
<p class="BodyContinued">. . . we see that <code>A</code>, <code>E</code>, and <code>T</code> are especially frequent, while <code>B</code>, <code>Q</code>, <code>J</code>, <code>M</code>, <code>V</code>, <code>W</code>, and <code>Z</code> don’t appear at all. This is consistent with a short text written in English (in a longer text, we would expect <code>E</code> to be more frequent than <code>A</code>). The only common kind of encryption algorithm that produces a ciphertext with these letter frequencies is a transposition cipher.</p>
<p>Just like the letter frequencies, the index of coincidence doesn’t change when a transposition cipher is applied. Using CrypTool 2 or <a class="LinkURL" href="http://dcode.fr/en">http://dcode.fr/en</a>, we can compute the index of coincidence of the 1882 newspaper ad as 7.0%, which is very close to the index of coincidence of the English language, 6.7%.</p>
<h2 id="h1-502727c09-0003"><a class="XrefDestination" id="Howtobreakacompletecolumnartranspositioncipher"/><span class="XrefDestination" id="xref-502727c09-005"/>How to break a complete columnar transposition cipher</h2>
<p class="BodyFirst">There are multiple ways to decrypt line-based transpositions with constant line lengths (i.e., complete columnar transposition ciphers). In each technique, detecting the length of the lines plays a key role.</p>
<h3 id="h2-502727c09-0001"><span epub:type="pagebreak" id="Page_180" title="180"/><a class="XrefDestination" id="Thearrange-and-readmethod"/><span class="XrefDestination" id="xref-502727c09-006"/>The arrange-and-read method</h3>
<p class="BodyFirst">Let’s take another look at the encrypted note sent to President Roosevelt: <code>NDOIMDEYLOAUEETVIEBR</code>. This message consists of twenty letters. Assuming that we are dealing with a complete columnar transposition, there are only a few possible line lengths, namely, the divisors of twenty: two, four, five, and ten.</p>
<p>As a first attempt, let’s write the message in lines of ten characters:</p>
<p class="BodyCustom"><code>NDOIMDEYLO</code></p>
<p class="BodyCustom"><code>AUEETVIEBR</code></p>
<p>Now, let’s try reading this two-line text in all four directions: from left to right, backward, from top to bottom, and bottom-up. However, no matter which way we read it, it makes no sense. So next, let’s try five-letter lines:</p>
<p class="BodyCustom"><code>NDOIM</code></p>
<p class="BodyCustom"><code>DEYLO</code></p>
<p class="BodyCustom"><code>AUEET</code></p>
<p class="BodyCustom"><code>VIEBR</code></p>
<p>Still nothing. Here is the message written in four-letter lines:</p>
<p class="BodyCustom"><code>NDOI</code></p>
<p class="BodyCustom"><code>MDEY</code></p>
<p class="BodyCustom"><code>LOAU</code></p>
<p class="BodyCustom"><code>EETV</code></p>
<p class="BodyCustom"><code>IEBR</code></p>
<p>Again, we read these lines in the four different ways; nothing stands out. Let’s move on to two-letter lines:</p>
<p class="BodyCustom"><code>ND</code></p>
<p class="BodyCustom"><code>OI</code></p>
<p class="BodyCustom"><code>MD</code></p>
<p class="BodyCustom"><code>EY</code></p>
<p class="BodyCustom"><code>LO</code></p>
<p class="BodyCustom"><code>AU</code></p>
<p class="BodyCustom"><code>EE</code></p>
<p class="BodyCustom"><code>TV</code></p>
<p class="BodyCustom"><code>IE</code></p>
<p class="BodyCustom"><code>BR</code></p>
<p>Now the first column, read from the bottom-up, says <code class="bold">BITE A LEMON</code>. Or perhaps it’s easier to first see the second column, read downward: <code class="bold">DID YOU EVER</code>. The cryptogram is solved. Sometimes, breaking a complete columnar transposition cipher is as simple as that!</p>
<p>Let’s look at another example of this kind. The cryptogram in <a href="#figure9-4" id="figureanchor9-4">Figure 9-4</a> is a challenge ciphertext published by the British intelligence agency GCHQ in 2013.<sup class="endnote"><a href="b06.xhtml#c09-endnote-6" id="c09-noteref-6">6</a></sup></p>
<span epub:type="pagebreak" id="Page_181" title="181"/><figure>
<img alt="" class="" height="292" src="image_fi/502727c09/F09004.png" width="694"/>
<figcaption><p><a id="figure9-4">Figure 9-4</a>: A challenge cryptogram published by the British intelligence agency GCHQ</p></figcaption>
</figure>
<p>Frequency analysis reveals that the letter frequencies match the English language quite well, except for the many <code>Q</code>s. We can therefore assume that this ciphertext was created with a transposition cipher and that <code>Q</code> stands for the space character.</p>
<p>The cryptogram consists of 143 letters. There are only two factors of 143, both of which are prime numbers: 11 and 13. Assuming that we are dealing with a complete columnar transposition, we should check line lengths of eleven and thirteen. Let’s start with eleven:</p>
<p class="BodyCustom"><code>AWVLIQIQVTQ</code></p>
<p class="BodyCustom"><code>OSQOELGCVII</code></p>
<p class="BodyCustom"><code>QWDLCUQEEOE</code></p>
<p class="BodyCustom"><code>NNWWOAOLTDN</code></p>
<p class="BodyCustom"><code>UQTGAWTSMDO</code></p>
<p class="BodyCustom"><code>QTLAOQSDCHP</code></p>
<p class="BodyCustom"><code>QQIQDQQTQOO</code></p>
<p class="BodyCustom"><code>TUDBNIQHBHH</code></p>
<p class="BodyCustom"><code>TDUTEETFDUE</code></p>
<p class="BodyCustom"><code>AUMORESQEQE</code></p>
<p class="BodyCustom"><code>MLTMETIRECL</code></p>
<p class="BodyCustom"><code>ICAIQATUNQR</code></p>
<p class="BodyCustom"><code>ALTENEINRKG</code></p>
<p>No matter how we read this paragraph—left to right, backward, from top to bottom, or bottom-up—it does not look like real language. Next, let’s check the thirteen-letter line variant:</p>
<p class="BodyCustom"><code>AWVLIQIQVTQOS</code></p>
<p class="BodyCustom"><code>QOELGCVIIQWDL</code></p>
<p class="BodyCustom"><code>CUQEEOENNWWOA</code></p>
<p class="BodyCustom"><code>OLTDNUQTGAWTS</code></p>
<p class="BodyCustom"><code>MDOQTLAOQSDCH</code></p>
<p class="BodyCustom"><code>PQQIQDQQTQOOT</code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_182" title="182"/><code>UDBNIQHBHHTDU</code></p>
<p class="BodyCustom"><code>TEETFDUEAUMOR</code></p>
<p class="BodyCustom"><code>ESQEQEMLTMETI</code></p>
<p class="BodyCustom"><code>RECLICAIQATUN</code></p>
<p class="BodyCustom"><code>QRALTENEINRKG</code></p>
<p>If we read the first column from top to bottom, we get <code>AQCOMPUTERQ</code>. Remembering that <code>Q</code> stands for a blank space, this message makes sense. Reading it column-wise with the <code>Q</code>s replaced by spaces, the paragraph becomes this:</p>
<p class="BodyCustom"><code>A COMPUTER WOULD DESERVE TO BE CALLED INTELLIGENT IF IT COULD DECEIVE A HUMAN INTO BELIEVING THAT IT WAS HUMAN WWW DOT METRO DOT CO DOT UK SLASH TURING</code></p>
<p>The plaintext is a summary of what is commonly known as the “Turing Test,” named after the brilliant mathematician Alan Turing (1912–1954).</p>
<h3 id="h2-502727c09-0002"><a class="XrefDestination" id="Vowelfrequenciesandmultipleanagramming"/><span class="XrefDestination" id="xref-502727c09-007"/>Vowel frequencies and multiple anagramming</h3>
<p class="BodyFirst">The arrange-and-read method we just covered only works if the second step of the transposition, permutation of the columns, is omitted. If this is not the case, we need more sophisticated codebreaking methods. To proceed, it will be helpful to know that the ratio of vowels to consonants in the English language is roughly forty to sixty. More than three vowels or consonants occurring in a row are possible, but they are rarely seen in practice.</p>
<p>Let’s look at the following cryptogram taken from <em>Military Cryptanalysis IV</em> by William Friedman (1959):<sup class="endnote"><a href="b06.xhtml#c09-endnote-7" id="c09-noteref-7">7</a></sup></p>
<figure class="graphic">
<img alt="" class="" height="197" src="image_fi/502727c09/g09004.png" width="694"/></figure>
<p>Frequency analysis reveals a distribution very similar to that of the English language, suggesting that this ciphertext was probably created with a transposition cipher. We start by assuming that it is a complete columnar transposition.</p>
<p>As the message consists of 126 letters, the possible line lengths are two, three, six, seven, nine, fourteen, eighteen, twenty-one, forty-two, and sixty-three. Lines of two, three, and six are insecure, because there is little to transpose; and twenty-one, forty-two, and sixty-three are impractical because the lines are too long. Therefore, these line lengths are rarely used. Thus, we start by examining the line lengths of seven, nine, fourteen, and eighteen.</p>
<p><span epub:type="pagebreak" id="Page_183" title="183"/>If we write the ciphertext in lines of seven letters, we get the following table. (Since we assume that the ciphertext was read out column-wise, we are writing the text in columns instead of rows.)</p>
<p class="BodyCustom"><code>1    IONTTUM</code></p>
<p class="BodyCustom"><code>2    LONRCPA</code></p>
<p class="BodyCustom"><code>3    HEVRUOS</code></p>
<p class="BodyCustom"><code>4    HEUIVLA</code></p>
<p class="BodyCustom"><code>5    DETIRRF</code></p>
<p class="BodyCustom"><code>6    TELAASA</code></p>
<p class="BodyCustom"><code>7    IIBRUOT</code></p>
<p class="BodyCustom"><code>8    EOFIOMY</code></p>
<p class="BodyCustom"><code>9    OEAVOTE</code></p>
<p class="BodyCustom"><code>10   EFENONC</code></p>
<p class="BodyCustom"><code>11   UTDLFFF</code></p>
<p class="BodyCustom"><code>12   DRFRDRX</code></p>
<p class="BodyCustom"><code>13   HRONAAR</code></p>
<p class="BodyCustom"><code>14   THYRONT</code></p>
<p class="BodyCustom"><code>15   SNCWNFG</code></p>
<p class="BodyCustom"><code>16   OEAEAME</code></p>
<p class="BodyCustom"><code>17   NAPTJNT</code></p>
<p class="BodyCustom"><code>18   STDUIDA</code></p>
<p>Lines 12 and 15 consist of consonants only. As seven consonants in a row are almost impossible in an English text, we conclude that we are on the wrong track. Let’s now try nine-letter lines, again written in columns from top to bottom:</p>
<p class="BodyCustom"><code>1    ISTBRTATF</code></p>
<p class="BodyCustom"><code>2    LORFIUONA</code></p>
<p class="BodyCustom"><code>3    HNRAITNFT</code></p>
<p class="BodyCustom"><code>4    HSHEACARY</code></p>
<p class="BodyCustom"><code>5    DONDRUJAE</code></p>
<p class="BodyCustom"><code>6    TOEFIVINC</code></p>
<p class="BodyCustom"><code>7    IEAOVRUFF</code></p>
<p class="BodyCustom"><code>8    EETYNAPMX</code></p>
<p class="BodyCustom"><code>9    OENCLUONR</code></p>
<p class="BodyCustom"><code>10   EENAROLDT</code></p>
<p class="BodyCustom"><code>11   UIVPNORMG</code></p>
<p class="BodyCustom"><code>12   DOUDROSAE</code></p>
<p class="BodyCustom"><code>13   HETTWFOST</code></p>
<p class="BodyCustom"><code>14   TFLREDMAA</code></p>
<p>This looks better. The number of vowels in each line is plausible. We’ll keep the nine-letter variant in mind as a promising candidate.</p>
<p>The next candidate is the fourteen-letter version:</p>
<p class="BodyCustom"><code>1    IFOFNETNTOUNMC</code></p>
<p class="BodyCustom"><code>2    LUOTNDRLCFPFAF</code></p>
<p class="BodyCustom"><code>3    HDERVFRRUDORSX</code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_184" title="184"/><code>4    HHERUOINVALAAR</code></p>
<p class="BodyCustom"><code>5    DTEHTYIRRORNFT</code></p>
<p class="BodyCustom"><code>6    TSENLCAWANSFAG</code></p>
<p class="BodyCustom"><code>7    IOIEBAREUAOMTE</code></p>
<p class="BodyCustom"><code>8    ENOAFPITOJMNYT</code></p>
<p class="BodyCustom"><code>9    OSETADVUOITDEA</code></p>
<p>The ten vowels in line 7, while not impossible, are pretty improbable. So, this guess is not a good first choice. Here’s the last candidate, with eighteen letters per line:</p>
<p class="BodyCustom"><code>1    IESETTBYRNTAAPTMFX</code></p>
<p class="BodyCustom"><code>2    LOOERNFCILUUOONNAR</code></p>
<p class="BodyCustom"><code>3    HENERNAAIRTONLFDTT</code></p>
<p class="BodyCustom"><code>4    HUSIHVEPANCOARRMYO</code></p>
<p class="BodyCustom"><code>5    DDOONUDDRRUOJSAAEE</code></p>
<p class="BodyCustom"><code>6    THOEETFTIWVFIONSCT</code></p>
<p class="BodyCustom"><code>7    OTEFALORVERDUMFAFA</code></p>
<p>This looks good, too.</p>
<p>We now have two good candidates (lines of nine and eighteen letters), one unlikely one (lines of fourteen letters), and one that is extremely unlikely (lines of seven letters). We will proceed with the two good candidates by applying a technique called <em>multiple anagramming</em>. This method consists of rearranging the columns of a block until a meaningful word appears in one of the lines. Then we check if the other rearranged lines look like they might have been taken from an English text, too. If this is the case, we are probably on the right track; if not, we’ll try another word.</p>
<p>Let’s first look for words that can be spelled by permuting the lines of the eighteen-letter-line candidates, checking for lines that may contain anagrammed words of interest. In line 4, we see the letters we need to spell <code>ARMY</code>—a likely word in a military message. Let’s use it for our first multiple-anagramming try. As there are two <code>A</code>s and two <code>R</code>s in the fourth line, we can construct this word in four possible ways:</p>
<p class="BodyCustom"><code>9  14 16 17   13 14 16 17   9  15 16 17   13 15 16 17</code></p>
<p class="BodyCustom"><code>R  P  M  F    A  P  M  F    R  T  M  F    A  T  M  F</code></p>
<p class="BodyCustom"><code>I  O  N  A    O  O  N  A    I  N  N  A    O  N  N  A</code></p>
<p class="BodyCustom"><code>I  L  D  T    N  L  D  T    I  F  D  T    N  F  D  T</code></p>
<p class="BodyCustom"><code class="bold">A  R  M  Y    A  R  M  Y    A  R  M  Y    A  R  M  Y</code></p>
<p class="BodyCustom"><code>R  S  A  E    J  S  A  E    R  A  A  E    J  A  A  E</code></p>
<p class="BodyCustom"><code>I  O  S  C    I  O  S  C    I  N  S  C    I  N  S  C</code></p>
<p class="BodyCustom"><code>V  M  A  F    U  M  A  F    V  F  A  F    U  F  A  F</code></p>
<p>The first possibility is very unlikely, as the patterns <code>RPMF</code> in the first line and <code>VMAF</code> in the last line are not common English tetragraphs. The second block is not much better—look at <code>APMF</code> in the first line and <code>JSAE</code> in the fifth. For similar reasons, the third and the fourth combinations don’t make sense either. We have reached a dead end.</p>
<p><span epub:type="pagebreak" id="Page_185" title="185"/>Let’s look for another word we can spell. We easily find a few, some of which can be formed in different ways. For instance, the letters <code>T</code>, <code>T</code>, <code>T</code>, <code>T</code>, <code>O</code>, <code>O</code>, and <code>W</code> in line 6 might spell <code class="bold">TWO</code> (numbers are common in military messages). The following are eight ways to assemble this word:</p>
<p class="BodyCustom"><code>1 10  3   6 10  3   8 10  3    18 10 3</code></p>
<p class="BodyCustom"><code>I  N  S   T  N  S   Y  N  S    X  N  S</code></p>
<p class="BodyCustom"><code>L  L  O   N  L  O   C  L  O    R  L  O</code></p>
<p class="BodyCustom"><code>H  R  N   N  R  N   A  R  N    T  R  N</code></p>
<p class="BodyCustom"><code>H  N  S   V  N  S   P  N  S    O  N  S</code></p>
<p class="BodyCustom"><code>D  R  O   U  R  O   D  R  O    E  R  O</code></p>
<p class="BodyCustom"><code class="bold">T  W  O   T  W  O   T  W  O    T  W  O</code></p>
<p class="BodyCustom"><code>I  E  E   L  E  E   R  E  E    A  E  E</code></p>
<p class="BodyCustom"> </p>
<p class="BodyCustom"><code>1 10 14   6 10 14   8 10 14  18 10 14</code></p>
<p class="BodyCustom"><code>I  N  P   T  N  P   Y  N  P   X  N  P</code></p>
<p class="BodyCustom"><code>L  L  O   N  L  O   C  L  O   R  L  O</code></p>
<p class="BodyCustom"><code>H  R  N   N  R  N   A  R  N   T  R  N</code></p>
<p class="BodyCustom"><code>D  R  S   U  R  S   D  R  S   E  R  S</code></p>
<p class="BodyCustom"><code class="bold">T  W  O   T  W  O   T  W  O   T  W  O</code></p>
<p class="BodyCustom"><code>I  E  M   L  E  M   R  E  M   A  E  M</code></p>
<p>Each of these eight guesses leads to letter combinations in other lines that don’t appear very often in English texts, such as <code>HNR</code>, <code>VNR</code>, and <code>XNP</code>. We seem to be on the wrong track again.</p>
<p>Next, we could try <code class="bold">AIR FORCE</code>, which might appear in line 2. As there are four <code>O</code>s and two <code>R</code>s in this row, there are eight ways to spell it. Other possibilities include <code class="bold">BY TRAIN</code> in line 1, <code class="bold">THOSE</code> in line 6, and <code class="bold">OVER</code> in line 7. However, all of these lead to implausible letter combinations in other lines.</p>
<p>Reluctantly, we conclude that the eighteen-character-long-line candidate is probably not correct, so we turn to the nine-letter-long block:</p>
<p class="BodyCustom"><code>1    ISTBRTATF</code></p>
<p class="BodyCustom"><code>2    LORFIUONA</code></p>
<p class="BodyCustom"><code>3    HNRAITNFT</code></p>
<p class="BodyCustom"><code>4    HSHEACARY</code></p>
<p class="BodyCustom"><code>5    DONDRUJAE</code></p>
<p class="BodyCustom"><code>6    TOEFIVINC</code></p>
<p class="BodyCustom"><code>7    IEAOVRUFF</code></p>
<p class="BodyCustom"><code>8    EETYNAPMX</code></p>
<p class="BodyCustom"><code>9    OENCLUONR</code></p>
<p class="BodyCustom"><code>10   EENAROLDT</code></p>
<p class="BodyCustom"><code>11   UIVPNORMG</code></p>
<p class="BodyCustom"><code>12   DOUDROSAE</code></p>
<p class="BodyCustom"><code>13   HETTWFOST</code></p>
<p class="BodyCustom"><code>14   TFLREDMAA</code></p>
<p><span epub:type="pagebreak" id="Page_186" title="186"/>While looking for likely candidates, we find a few words related to numbers. The first line provides the letters we might need to form the word <code class="bold">FIRST</code>. Both lines 6 and 7 contain the letters of the word <code class="bold">FIVE</code>. Because <code class="bold">V</code> is a relatively uncommon letter, let’s take <code class="bold">FIVE</code> in line 6 as our first guess. The line contains two <code class="bold">I</code>s, so there are two ways to spell the word:</p>
<p class="BodyCustom"><code>4 5 6 3   4 7 6 3</code></p>
<p class="BodyCustom"><code>B R T T   B A T T</code></p>
<p class="BodyCustom"><code>F I U R   F O U R</code></p>
<p class="BodyCustom"><code>A I T R   A N T R</code></p>
<p class="BodyCustom"><code>E A C H   E A C H</code></p>
<p class="BodyCustom"><code>D R U N   D J U N</code></p>
<p class="BodyCustom"><code class="bold">F I V E   F I V E</code></p>
<p class="BodyCustom"><code>O V R A   O U R A</code></p>
<p class="BodyCustom"><code>Y N A T   Y P A T</code></p>
<p class="BodyCustom"><code>C L U N   C O U N</code></p>
<p class="BodyCustom"><code>A R O N   A L O N</code></p>
<p class="BodyCustom"><code>P N O V   P R O V</code></p>
<p class="BodyCustom"><code>D R O U   D S O U</code></p>
<p class="BodyCustom"><code>T W F T   T O F T</code></p>
<p class="BodyCustom"><code>R E D L   R M D L</code></p>
<p>It should be immediately clear that the second block looks very promising. In addition to FIVE, it produces the English words FOUR and EACH, along with promising word fragments such as BATT, OURA, COUN, ALON, and PROV. Only the last line, RMDL, doesn’t look like English, but this might be due to an abbreviation. Let’s assume that this guess is correct.</p>
<p>How can we proceed? Since we think we know columns 4, 7, 6, and 3, it’s best to check which of the five remaining columns (1, 2, 5, 8, and 9) makes the most sense if put in front of the block we have chosen. There are five options:</p>
<p class="BodyCustom"><code>1 4 7 6 3   2 4 7 6 3   5 4 7 6 3   8 4 7 6 3   9 4 7 6 3</code></p>
<p class="BodyCustom"><code>I B A T T   S B A T T   R B A T T   T B A T T   F B A T T</code></p>
<p class="BodyCustom"><code>L F O U R   O F O U R   I F O U R   N F O U R   A F O U R</code></p>
<p class="BodyCustom"><code>H A N T R   N A N T R   I A N T R   F A N T R   T A N T R</code></p>
<p class="BodyCustom"><code>H E A C H   S E A C H   A E A C H   R E A C H   Y E A C H</code></p>
<p class="BodyCustom"><code>D D J U N   O D J U N   R D J U N   A D J U N   E D J U N</code></p>
<p class="BodyCustom"><code>T </code><code class="bold">F I V E</code><code>   O </code><code class="bold">F I V E</code><code>   I </code><code class="bold">F I V E</code><code>   N</code><code class="bold"> F I V E</code><code>   C </code><code class="bold">F I V E</code></p>
<p class="BodyCustom"><code>I O U R A   E O U R A   V O U R A   F O U R A   F O U R A</code></p>
<p class="BodyCustom"><code>E Y P A T   E Y P A T   N Y P A T   M Y P A T   X Y P A T</code></p>
<p class="BodyCustom"><code>O C O U N   E C O U N   L C O U N   N C O U N   R C O U N</code></p>
<p class="BodyCustom"><code>E A L O N   E A L O N   R A L O N   D A L O N   T A L O N</code></p>
<p class="BodyCustom"><code>U P R O V   I P R O V   N P R O V   M P R O V   G P R O V</code></p>
<p class="BodyCustom"><code>D D S O U   O D S O U   R D S O U   A D S O U   E D S O U</code></p>
<p class="BodyCustom"><code>H T O F T   E T O F T   W T O F T   S T O F T   T T O F T</code></p>
<p class="BodyCustom"><code>T R M D L   F R M D L   E R M D L   A R M D L   A R M D L</code></p>
<p><span epub:type="pagebreak" id="Page_187" title="187"/>The fourth option, 84763, produces the best results: REACH, NFOUR, and MYPAT. Most of the other five-letter groups can easily be imagined as having been taken from an English text. The remaining columns (1, 2, 5, and 9) can now easily be added in a similar way. We check the placement of each one before or after our existing block to see what makes the most sense. In the end, we get the following:</p>
<p class="BodyCustom"><code>FIRSTBATT</code></p>
<p class="BodyCustom"><code>ALIONFOUR</code></p>
<p class="BodyCustom"><code>THINFANTR</code></p>
<p class="BodyCustom"><code>YHASREACH</code></p>
<p class="BodyCustom"><code>EDROADJUN</code></p>
<p class="BodyCustom"><code>CTIONFIVE</code></p>
<p class="BodyCustom"><code>FIVEFOURA</code></p>
<p class="BodyCustom"><code>XENEMYPAT</code></p>
<p class="BodyCustom"><code>ROLENCOUN</code></p>
<p class="BodyCustom"><code>TEREDALON</code></p>
<p class="BodyCustom"><code>GUNIMPROV</code></p>
<p class="BodyCustom"><code>EDROADSOU</code></p>
<p class="BodyCustom"><code>THWESTOFT</code></p>
<p class="BodyCustom"><code>ATEFARMDL</code></p>
<p class="BodyContinued">This plaintext can be read line-wise. X is used as a period:</p>
<p class="BodyCustom">FIRST BATTALION FOURTH INFANTRY HAS REACHED ROAD JUNCTION FIVE FIVE FOUR A. ENEMY PATROL ENCOUNTERED ALONG UNIMPROVED ROAD SOUTHWEST OF TATE FARM DL</p>
<p>Half of that tetragraph of consonants we saw above, RMDL, is the end of the word FARM. We are not certain what the remaining letters, DL, might mean. Perhaps a signature or filler letters to reach a certain message length?</p>
<p>As should have become clear, multiple anagramming is a <em>nondeterministic</em> method, meaning that it is possible to come up with multiple solution candidates. Thus, it must be done with care, creativity, and trial and error. There are, however, some tricks that might simplify the codebreaking process:</p>
<ol class="decimal">
<li value="1">The letter <em>Q</em> is very helpful for multiple anagramming, as it is usually followed by a <em>U</em>.</li>
<li value="2">The letters <em>J</em>, <em>V</em>, and <em>Z</em> are almost always followed by a vowel.</li>
<li value="3">The letters <em>A</em>, <em>O</em>, and <em>U</em> are usually followed by a consonant.</li>
<li value="4">The letter <em>H</em> is usually preceded by a consonant and followed by a vowel.</li>
</ol>
<p>If you want to learn more about multiple anagramming, we recommend Helen Fouché Gaines’s classic 1939 book <em>Cryptanalysis</em>.<sup class="endnote"><a href="b06.xhtml#c09-endnote-8" id="c09-noteref-8">8</a></sup></p>
<h2 id="h1-502727c09-0004"><span epub:type="pagebreak" id="Page_188" title="188"/><a class="XrefDestination" id="Successstories"/><span class="XrefDestination" id="xref-502727c09-008"/>Success stories</h2>
<h3 id="h2-502727c09-0003"><a class="XrefDestination" id="DonaldHill’sdiary"/><span class="XrefDestination" id="xref-502727c09-009"/>Donald Hill’s diary</h3>
<p class="BodyFirst">Donald Hill (ca. 1915–1995) was a British military pilot in World War II. Stationed in Hong Kong, he was captured by the Japanese and sent to a prisoner-of-war camp. After four years of incarceration, he was released. Even before his years in captivity, Hill had kept a diary. But because British soldiers were not allowed to keep private notes, he used numbers instead of letters and camouflaged the diary as a collection of multiplication tables, titling his booklet <em>Russel’s Mathematical Tables</em>. This did not look suspicious, as multiplication tables were quite common before pocket calculators were invented. While in captivity, Hill continued to write his journal.</p>
<p>After his return to England, Hill married his fiancée and never again talked about his diary or its contents. Only after Hill’s death in 1995 did his wife investigate the strange number sequences in the booklet he left behind. She asked mathematics professor Philip Aston from the University of Surrey to analyze them. He was able to deduce their meaning and published a paper about his deciphering of the diary.<sup class="endnote"><a href="b06.xhtml#c09-endnote-9" id="c09-noteref-9">9</a></sup> The story of Donald Hill is also told in Andro Linklater’s 2001 book <em>The Code of Love</em>.<sup class="endnote"><a href="b06.xhtml#c09-endnote-10" id="c09-noteref-10">10</a></sup></p>
<p>When Aston first examined Hill’s alleged mathematical tables, he saw that most of the pages were filled with groups of four digits (see <a href="#figure9-5" id="figureanchor9-5">Figure 9-5</a>). These numbers were purportedly multiplication results, but the results didn’t fit with the multiplications. Aston concluded that the real purpose of these numbers was to encode a text.</p>
<figure>
<img alt="" class="" height="508" src="image_fi/502727c09/f09005.png" width="636"/>
<figcaption><p><a id="figure9-5">Figure 9-5</a>: Prisoner-of-war Donald Hill disguised his diary as a collection of mathematical tables. In addition, he used a transposition cipher.</p></figcaption>
</figure>
<p><span epub:type="pagebreak" id="Page_189" title="189"/>The most obvious way to interpret the numbers was that each four-digit group encoded two letters. (In other words, each digit pair encoded a letter.) When Aston saw that almost all digit pairs represented numbers between ten and thirty-five, he determined that the most obvious encoding was <code class="bold">A</code> = <code>10</code>, <code class="bold">B</code> = <code>11</code>, <code class="bold">C</code> = <code>12</code>, <code class="bold">D</code> = <code>13</code>, etc. Aston performed a frequency analysis based on this encoding and saw that the letter frequencies almost exactly matched the ones of the English language. However, the letter sequences he received didn’t make sense. So, he assumed that Hill had used a transposition cipher in addition to the substitution.</p>
<p>Taking a closer look at the numbers in the diary, Aston noticed that occasionally, a group consisting of four zeros (<code>0000</code>) appeared. This didn’t fit with the encoding. Aston’s guess was that these zero-blocks were separators. As it turned out, there were exactly 561 four-digit groups (1,122 letters) between each two separators. This made it likely that Hill had applied a transposition cipher on units of 1,122 letters.</p>
<p>One can arrange 1,122 letters in a rectangle very easily because the number 1,122 has many factors. This suggested that Hill had applied a complete columnar transposition cipher using a rectangle size such as 66 × 17, 11 × 102, or 33 × 34. Aston didn’t have to search very long for the best guess, however, as on the first diary page were written a right-hand arrow next to the number <code>340</code> and a down arrow next to the number <code>330</code>. Aston assumed that the zeros in these numbers were there to confuse the reader, and then he arranged one of the 1,122-letter units in a table containing thirty-three columns and thirty-four lines. Writing the text line-wise in such a table quickly produced meaningful words in the columns. To our regret, Aston’s paper doesn’t describe what exactly he saw, but the 33 × 34 table may have looked like this:</p>
<p class="BodyCustom"><code>DMSTIINSKDSEATALDSGMTOOARNRRBUENDE</code></p>
<p class="BodyCustom"><code>IBABLAWTBAARMRLEETHEOENPTIEESTAOOF</code></p>
<p class="BodyCustom"><code>WEFLMMESYMBSEALTTWTIASEPWSTTANRTAT</code></p>
<p class="BodyCustom"><code>AREAADDTTALCRTWEHEENSUPEEIAHMOAUNR</code></p>
<p class="BodyCustom"><code>KSTZCIAHHGAOTEELEARDHPLANMREOCNNYE</code></p>
<p class="BodyCustom"><code>EEYIHSSEEEZMCDVYBRSIETARTMYINAOSTP</code></p>
<p class="BodyCustom"><code>TSANITHBFBEEAFEBLESALNNHYIRRGSMCHR</code></p>
<p class="BodyCustom"><code>HCNGNUDOTOAONIGUATWNTSEEMNILSUIAIA</code></p>
<p class="BodyCustom"><code>EODAEROMGTNVCRORZOOTEMIATENETANRNY</code></p>
<p class="BodyCustom"><code>ORBNSBWBHHOELETNELORRONDNNGWTLORGI</code></p>
<p class="BodyCustom"><code>TTYDAENETWTRIIWETDPOTKTIUTSIATUEEN</code></p>
<p class="BodyCustom"><code>HEASROTREAHAPNHDSTDONEANTHUSEISDXG</code></p>
<p class="BodyCustom"><code>EDMIEEOSRLEGPTIWTHOPTACGEEPGRERWCT</code></p>
<p class="BodyCustom"><code>RBINBAFPSRRAEOCTOAWSHNTOSLTUUSOEEH</code></p>
<p class="BodyCustom"><code>OYRKURLATUBIROHTOTNGEDWUOLONITAHPA</code></p>
<p class="BodyCustom"><code>FOAFRLISHSANIUIHFWOETITRFTSTNOROTT</code></p>
<p class="BodyCustom"><code>FVCINYGSEADBNRSTIENTRHAWCHAHSPOPTT</code></p>
<p class="BodyCustom"><code>IELNTAHOBRLOTPPWEAUPEETAOEYEOEFEOH</code></p>
<p class="BodyCustom"><code>CREAOSTVEEYMHLRORRSAXTTYNRTRNRPAME</code></p>
<p class="BodyCustom"><code>ETNLUTSEEGDBEAERCEANCWETCEHEESLNAB</code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_190" title="190"/><code>RHOLTHJRSOATANCEEANITOMHEGATAOADNO</code></p>
<p class="BodyCustom"><code>SIOYIEUHTNMWFETDATDCTWPENOTSINNWOM</code></p>
<p class="BodyCustom"><code>ORNTNCSEEEAGTSOHNWPKEATRTEWARNEEUB</code></p>
<p class="BodyCustom"><code>VTEHCOTAWOGTEWUODAOYMLTERSAMCESTRS</code></p>
<p class="BodyCustom"><code>EYIELLLDINERHRSTSRUAEROSAMRARLANDW</code></p>
<p class="BodyCustom"><code>RFSYUONBTEDENGLHHWNNNUPNTYWDAENSEO</code></p>
<p class="BodyCustom"><code>BIHMDNTUHBLDOTIEETADTSUOESTRFIDPFN</code></p>
<p class="BodyCustom"><code>RGIATIITBEEOOVTATICRTATTDITUTGNEET</code></p>
<p class="BodyCustom"><code>EHTKNAMTOEACNETVSHOUHROTAEHSLHICNE</code></p>
<p class="BodyCustom"><code>ATAEGLEHMSVKBTLYCJNSEEUMTEJHETNTCX</code></p>
<p class="BodyCustom"><code>KEFOTSTEBTISOHEBOACHYLTETPAFFCETEP</code></p>
<p class="BodyCustom"><code>FRTFHEOFSENAMESOMPETFETTAAPOTIBHPL</code></p>
<p class="BodyCustom"><code>ASEFECHIGIGABMOMPANNIFHOCNARBVOEOO</code></p>
<p>The first column, beginning from the top, contains the message <code class="bold">I WAKE THE OTHER OFFICERS</code>. The second column, <code>MBERSESCORTEDBYOVE</code>, does not appear to directly follow the first column but certainly looks like a fragment of English. It was clear that the order of the columns had to be changed. Had Donald Hill used a keyword for this transposition? Again, Aston didn’t have to search very long for a solution. On the front page of the diary, he found the full names of Hill and his fiancée, consisting of thirty-four letters:</p>
<p class="BodyCustom"><code>DONALD SAMUEL HILL PAMELA SEELY KIRRAGE</code></p>
<p>Sorted alphabetically, these thirty-four letters read as follows:</p>
<p class="BodyCustom"><code>AAAAADDEEEEEGHIIKLLLLLLMMNOPRRSSUY</code></p>
<p>To decrypt the diary, Aston wrote these letters in the first line of the table:</p>
<p class="BodyCustom"><code>AAAAADDEEEEEGHIIKLLLLLLMMNOPRRSSUY</code></p>
<p class="BodyCustom"><code>----------------------------------</code></p>
<p class="BodyCustom"><code>DMSTIINSKDSEATALDSGMTOOARNRRBUENDE</code></p>
<p class="BodyCustom"><code>IBABLAWTBAARMRLEETHEOENPTIEESTAOOF</code></p>
<p class="BodyCustom"><code>. . .</code></p>
<p>Then he rearranged the columns such that the keyword appeared again:</p>
<p class="BodyCustom"><code>DONALDSAMUELHILLPAMELASEELYKIRRAGE</code></p>
<p class="BodyCustom"><code>----------------------------------</code></p>
<p class="BodyCustom"><code>IRNDSNEMADSGTAMTRSRKOTNDSOEDLBUIAE</code></p>
<p class="BodyCustom"><code>AETITWABPOTHRLEOEATBEBOAANFEESTLMR</code></p>
<p class="BodyCustom"><code>MTSWWEREPASTALIATFWYSLTMBEITTANMES</code></p>
<p class="BodyCustom"><code>DATAEDARENTETWNSHEETUAUALPRHEMOARC</code></p>
<p class="BodyCustom"><code>IRMKAANSAYHREEDHETNHPZNGALEELOCCIO</code></p>
<p class="BodyCustom"><code>SYMERSOERTESDVIETYTEIISEZAPBYNAHCM</code></p>
<p class="BodyCustom"><code>TRITEHMSHHBSFEALRAYFNNCBENRLBGSIAE</code></p>
<p class="BodyCustom"><code>UINHTDICEIOWIGNTLNMISGAOAEAAUSUNNO</code></p>
<p class="BodyCustom"><code>RNEEOONOANMOROTEEDIGMARTNIYZRTAECV</code></p>
<p class="BodyCustom"><code>BGNOLWORDGBOETRRWBNHONRHONIENTLSLE</code></p>
<p class="BodyCustom"><code>ESTTDNUTIEEPIWOIIYUTKDEWTTNIEHTAIR</code></p>
<p class="BodyCustom"><span epub:type="pagebreak" id="Page_191" title="191"/><code>DUHHTTSENXRDNHONSATEESDAHAGSDEIRPA</code></p>
<p class="BodyCustom"><code>EPEBHORDGCSOTIPTGMERAIWLECTTWREEPG</code></p>
<p class="BodyCustom"><code>ATLRAFOBOEPWOCSHUISSNNERRTHOIUSBEA</code></p>
<p class="BodyCustom"><code>ROLOTLAYUPANOHGENROTDKHUBWAOTITURI</code></p>
<p class="BodyCustom"><code>LSTFWIRORTSOUIEITAFHTFOSAETFHNORIN</code></p>
<p class="BodyCustom"><code>YAHFEGOVWTSNRSTRHCCEHIPADATITSPNNB</code></p>
<p class="BodyCustom"><code>AYETAHFEAOOUPPPEELOBENERLTHEWOETTO</code></p>
<p class="BodyCustom"><code>STRCRTPRYMVSLRAXRENETAAEYTERONROHM</code></p>
<p class="BodyCustom"><code>THEEESLTTAEAAENCENCEWLNGDEBCRESUEB</code></p>
<p class="BodyCustom"><code>HAGRAJAHHNRNNCIIIOESOLDOAMOEEAOTAI</code></p>
<p class="BodyCustom"><code>ETOSTUNIEOHDEICTSONTWYWNMPMADINIFN</code></p>
<p class="BodyCustom"><code>CWEOWSERRUEPSOKEANTEATEEATBNHRNNTG</code></p>
<p class="BodyCustom"><code>OASVATSTERAOWUYMMERWLHIOGTSDOCECET</code></p>
<p class="BodyCustom"><code>LRMERIAYSDDUESAEAIAIRENNEOWSTRLLRH</code></p>
<p class="BodyCustom"><code>OWYRWNNFNEBRGLNNDSTTUYSEDPOHHAEUNE</code></p>
<p class="BodyCustom"><code>NISBITDIOFUAITDTRHEHSMPBLUNEEFIDOD</code></p>
<p class="BodyCustom"><code>ITLRTINGTETCVTRTUIDBAAEEETTIATGIOO</code></p>
<p class="BodyCustom"><code>AHEEHMIHINTOETUHSTAORKCEAOESVLHNNC</code></p>
<p class="BodyCustom"><code>LJEAJENTMCHNTLSEHATMEETSVUXCYETGBK</code></p>
<p class="BodyCustom"><code>SAPKATEHEEECEEHYFFTBLOTTITPOBFCTOS</code></p>
<p class="BodyCustom"><code>EPAFPOBRTPFEESIFOTASEFHENTLMOTIHMA</code></p>
<p class="BodyCustom"><code>CANAAHOSOOINMONTRECGFFEIGHOPMBVEBN</code></p>
<p>Now, the deciphering was complete. Read column-wise, here is the plaintext, a diary entry written on December 8, 1941:</p>
<p class="BodyCustom"><code>I am disturbed early as the Colonial Secretary rings up to say that war with Japan is imminent. Hell there goes my sleep and I wake the other officers. Over breakfast we are told that we are at war with Japan. We dash down to flights just in time to hear an ominous roar of planes and nine bombers escorted by over thirty fighters appear heading our way. There's no time to do anything except to man our defense posts. The bombers pass overhead but the fighters swoop down on us and pour a concentrated fire into our planes. We give them all we've got which is precious little. Some Indian troops get panicky and rush into a shelter, in their excitement they fire their Lewis gun. There is a mad rush for safety and by a miracle no one is hit. After twenty minutes of concentrated attack by the fighters the Beeste with bombs goes up in smoke and the two Walrus are left blazing and sink. Finally they make off, not unscarred we hope, and we inspect the damage. Both Walrus are gone, one Beeste is ablaze, another badly damaged, leaving one plane intact. We attempt to put out the fire praying that the bombs won't explode. The blaze is too fierce and she is completely burned with two red hot heavy bombs amongst the ruins. One aircraft left but no casualties to personnel. Eight civil machines are burnt out including the American clipper. In the afternoon, bombers come over again bombing the docks an . . .</code></p>
<p><span epub:type="pagebreak" id="Page_192" title="192"/>The rest of the diary can be read in Aston’s 1997 paper and in the 2001 book <em>The Code of Love</em> by Andro Linklater.</p>
<h3 id="h2-502727c09-0004"><a class="XrefDestination" id="ThePabloWaberskispycase"/><span class="XrefDestination" id="xref-502727c09-010"/>The Pablo Waberski spy case</h3>
<p class="BodyFirst">In his 1931 book <em>The American Black Chamber</em>, which caused a scandal because of its discussion of America’s secret cryptographic abilities, American codebreaker Herbert Yardley (1889–1958) describes a German transposition cipher.<sup class="endnote"><a href="b06.xhtml#c09-endnote-11" id="c09-noteref-11">11</a></sup> According to Yardley, on February 10, 1918, during World War I, American agents arrested a man on the Mexican border who called himself Pablo Waberski. The investigators suspected that the detainee was actually a German secret agent named Lothar Witzke.<sup class="endnote"><a href="b06.xhtml#c09-endnote-12" id="c09-noteref-12">12</a></sup><sup>, </sup><sup class="endnote"><a href="b06.xhtml#c09-endnote-13" id="c09-noteref-13">13</a></sup> Sewn into the left sleeve of the suspect’s coat, they found the following encrypted note:<sup class="endnote"><a href="b06.xhtml#c09-endnote-14" id="c09-noteref-14">14</a></sup></p>
<p class="BodyCustom"><code>SEOFNATUPK ASIHEIHBBN UERSDAUSNN</code></p>
<p class="BodyCustom"><code>LRSEGGIESN NKLEZNSIMN EHNESHMPPB</code></p>
<p class="BodyCustom"><code>ASUEASRIHT HTEURMVNSM EAINCOUASI</code></p>
<p class="BodyCustom"><code>INSNRNVEGD ESNBTNNRCN DTDRZBEMUK</code></p>
<p class="BodyCustom"><code>KOLSELZDNN AUEBFKBPSA TASECISDGT</code></p>
<p class="BodyCustom"><code>IHUKTNAEIE TIEBAEUERA THNOIEAEEN</code></p>
<p class="BodyCustom"><code>HSDAEAIAKN ETHNNNEECD CKDKONESDU</code></p>
<p class="BodyCustom"><code>ESZADEHPEA BBILSESOOE ETNOUZKDML</code></p>
<p class="BodyCustom"><code>NEUIIURMRN ZWHNEEGVCR EODHICSIAC</code></p>
<p class="BodyCustom"><code>NIUSNRDNSO DRGSURRIEC EGRCSUASSP</code></p>
<p class="BodyCustom"><code>EATGRSHEHO ETRUSEELCA UMTPAATLEE</code></p>
<p class="BodyCustom"><code>CICXRNPRGA AWSUTEMAIR NASNUTEDEA</code></p>
<p class="BodyCustom"><code>ERRREOHEIM EAHKTMUHDT COKDTGCEIO</code></p>
<p class="BodyCustom"><code>EEFIGHIHRE LITFIUEUNL EELSERUNMA</code></p>
<p class="BodyCustom"><code>ZNAI</code></p>
<p>Herbert Yardley was commissioned to crack this encryption. He and his team performed a frequency analysis and a few other statistical tests. These revealed that <code>E</code> was the most frequent letter, followed by <code>N</code>, while <code>Q</code>, <code>X</code>, and <code>Y</code> were completely absent. These features are typical of the German language (see <span class="xref" itemid="xref_target_Appendix B">Appendix B</span>), suggesting the author had used a transposition cipher.</p>
<p>Yardley knew how to break such an encryption with the help of common digraphs (pairs of letters). In German, the letter <code>C</code> is particularly helpful, because it usually precedes <code>H</code>, occasionally precedes <code>K</code>, and is rarely found in front of any other letter. Yardley therefore tagged all <code>C</code>s in the text and then looked for <code>H</code>s. Then he determined the distances between each <code>C</code> and <code>H</code>. As it turned out, a distance of 108 letters appeared conspicuously often. When Yardley transcribed the message in lines of length 108, he received the following letter sequences:</p>
<p class="BodyCustom"><code>SEOFNATUPK ASIHEIHBBN UERSDAUSNN LRSEGGIESN NKLEZNSIMN . . .</code></p>
<p class="BodyCustom"><code>CNDTDRZBEM UKKOLSELZD NNAUEBFKBP SATASECISD GTIHUKTNAE . . .</code></p>
<p class="BodyCustom"><code>HPEABBILSE SOOEETNOUZ KDMLNEUIIU RMRNZWHNEE GVCREODHIC . . .</code></p>
<p class="BodyCustom"><code>AATLEECICX RNPRGAAWSU TEMAIRNASN UTEDEAERRR EOHEIMEAHK . . .</code></p>
<p><span epub:type="pagebreak" id="Page_193" title="193"/>Read from top to bottom, virtually every column produced a four-letter sequence typical of the German language: column 1 is <code>SCHA</code>, column 10 is <code>KMEX</code>, and column 20 contains <code>NDZU</code>. Next, Yardley and his team organized the columns in a meaningful order, which turned out to be fairly straightforward. For instance, <code>KMEX</code>, followed by <code>IKOP</code>, produced the word <code class="bold">MEXIKO</code> (German for <code class="bold">MEXICO</code>). In the end, Yardley was able to read the following plaintext:</p>
<p class="BodyCustom"><code>AN DIE KAISERLICHEN KONSULARBEHOERDEN IN DER REPUBLIK MEXIKO PUNKT STRENG GEHEIM AUSRUFUNGSZEICHEN DER INHABER DIESES IST EIN REICHSANGEHOERIGER DER UNTER DEM NAMEN PABLO WABERSKI ALS RUSSE REIST PUNKT ER IST DEUTSCHER GEHEIMAGENT PUNKT ABSATZ ICH BITTE IHM AUF ANSUCHEN SCHUTZ UND BEISTAND ZU GEWAEHREN KOMMA IHM AUCH AUF VERLANGEN BIS ZU EINTAUSEND PESOS ORO NACIONAL VORZUSCHIESSEN UND SEINE CODETELEGRAMME AN DIESE GESANDTSCHAFT ALS KONSULARAMTLICHE DEPESCHEN ABZUSENDEN PUNKT</code></p>
<p class="BodyCustom"><code>VON ECKHARDT</code></p>
<p>Here’s a translation:</p>
<p class="BodyCustom"><code>To the Imperial consular authorities in the Republic of Mexico. Top secret! The owner of this [paper] is a member of the Reich, who travels under the name Pablo Waberski as a Russian. He is a German secret agent. I kindly ask you to grant him protection and support on request, to pay him up to 1000 Pesos Oro National on request, and to send his encrypted telegram</code><code>s to this consulate as diplomatic correspondence.</code></p>
<p class="BodyCustom"><code>Von Eckhardt</code></p>
<p>This letter proved that the suspect, Pablo Waberski, was in fact a German spy. He was sentenced to death in 1918. After the war, when relations between Germany and the US improved, he was pardoned, and his charges were eventually dismissed in 1923.</p>
<h2 id="h1-502727c09-0005"><a class="XrefDestination" id="Challenges"/><span class="XrefDestination" id="xref-502727c09-011"/>Challenges</h2>
<h3 id="h2-502727c09-0005"><a class="XrefDestination" id="TheLampedusamessage"/><span class="XrefDestination" id="xref-502727c09-012"/>The Lampedusa message</h3>
<p class="BodyFirst">The 1980 book<em> Love in Code</em> by Donald McCormick is a nice overview of the use of encryption by lovers.<sup class="endnote"><a href="b06.xhtml#c09-endnote-15" id="c09-noteref-15">15</a></sup> It covers hundreds of years of encrypted love letters, diaries, newspaper advertisements, and other cryptograms created by romantic couples seeking to keep their communications private. In one of the chapters, titled “Love at War,” McCormick reports on a woman who lived on the tiny Italian island of Lampedusa in the Mediterranean Sea when the US Army bombarded it in 1943.<sup class="endnote"><a href="b06.xhtml#c09-endnote-16" id="c09-noteref-16">16</a></sup> This woman painted the following message in bold letters on a white cloth and put it on the beach for the intruders to see:</p>
<p class="BodyCustom"><code>TSURT EM, SYOB. I NEEUQ FO ASUDEPMAL</code></p>
<p><span epub:type="pagebreak" id="Page_194" title="194"/>It is a lot easier to decipher this cryptogram than to understand its meaning. The woman was never identified, and the purpose of this message is not known.</p>
<h3 id="h2-502727c09-0006"><a class="XrefDestination" id="TheFriedmans’lovemessages"/><span class="XrefDestination" id="xref-502727c09-013"/>The Friedmans’ love messages</h3>
<p class="BodyFirst">William and Elizebeth Friedman (1891–1962 and 1892–1980, respectively) were a codebreaking dream team. Both had long careers as cryptanalysts working for the military, the police, and other institutions. In 2017, US author Jason Fagone wrote a fascinating book about Elizebeth Friedman that covers not only the couple’s codebreaking work, but also their courtship and marriage.<sup class="endnote"><a href="b06.xhtml#c09-endnote-17" id="c09-noteref-17">17</a></sup> (Many other biographical books about Elizebeth have appeared recently; see <span class="xref" itemid="xref_target_Chapter 17"><a href="c17.xhtml">Chapter 17</a></span>.<sup class="endnote"><a href="b06.xhtml#c09-endnote-18" id="c09-noteref-18">18</a></sup><sup>, </sup><sup class="endnote"><a href="b06.xhtml#c09-endnote-19" id="c09-noteref-19">19</a></sup>)</p>
<p>William and Elizebeth were allegedly so enthusiastic about crypto that they even used encryption in their private life. <a href="#figure9-6" id="figureanchor9-6">Figure 9-6</a> shows a love message William wrote to Elizebeth around 1917, as well as another one Elizebeth sent back to him. Both messages are encrypted in a simple transposition cipher. While William’s plaintext is in English, Elizebeth’s is in French. Can you solve these two cryptograms?</p>
<figure>
<img alt="" class="" height="281" src="image_fi/502727c09/f09006.png" width="694"/>
<figcaption><p><a id="figure9-6">Figure 9-6</a>: A message sent from William Friedman (signed “Biwy”) to his wife Elizebeth around 1917 and another sent back to him (signed “Elsbeth”). Both are encrypted in a simple transposition.</p></figcaption>
</figure>
<h3 id="h2-502727c09-0007"><a class="XrefDestination" id="Anencrypted“agony”ad"/><span class="XrefDestination" id="xref-502727c09-014"/>An encrypted “agony” ad</h3>
<p class="BodyFirst">We’ve already mentioned<em> The Agony Column Codes &amp; Ciphers</em>, Jean Palmer’s 2005 book that lists over a thousand encrypted newspaper ads. Some (but not very many) of these ads are encrypted in transposition ciphers. The following were published in the British <em>Evening Standard</em> in 1882:<sup class="endnote"><a href="b06.xhtml#c09-endnote-20" id="c09-noteref-20">20</a></sup></p>
<p class="BodyCustom"><code>CEM.—I e g c n e h d n h a o a s s b i s e r c g d h l i h u s a c c b k h e i e .</code> Monday, July 31, 1882</p>
<p class="BodyCustom"><code> </code></p>
<p class="BodyCustom"><code>CEM.—Key 11. – L k e o i s v s t e s o e e m l d y o d b v e n s e d t p l i a a n a e g l m s l y h b r m n e b e m r s e a o u t f W e y r w o i h o a e u v n l e y e.</code> Saturday, August 5, 1882</p>
<p><span epub:type="pagebreak" id="Page_195" title="195"/>The first message is in German and the second is in English. Can you solve them?</p>
<h3 id="h2-502727c09-0008"><a class="XrefDestination" id="Yardley’seleventhciphergram"/><span class="XrefDestination" id="xref-502727c09-015"/>Yardley’s eleventh ciphergram</h3>
<p class="BodyFirst">Chapter 11 of Herbert Yardley’s 1932 book <em>Ciphergrams</em><sup class="endnote"><a href="b06.xhtml#c09-endnote-21" id="c09-noteref-21">21</a></sup> describes an encrypted message sent from a radio station in Mexico to a German spy in the United States during World War I. This story, including the message, is fictional, but breaking the encryption (a complete columnar transposition cipher) is still entertaining:</p>
<p class="BodyCustom"><code>TSKGL AATYI LTLPA SAHLM DPLGI ENEAI WTUEN N</code></p>
<p>Hint: Count!</p>
<h3 id="h2-502727c09-0009"><a class="XrefDestination" id="EdgarAllanPoe’sfirstchallenge"/><span class="XrefDestination" id="xref-502727c09-016"/>Edgar Allan Poe’s first challenge</h3>
<p class="BodyFirst">In 1841, Edgar Allan Poe published two cryptograms allegedly created by a W.B. Tyler. The second of these cryptograms, along with the background story, is covered in <span class="xref" itemid="xref_target_Chapter 6"><a href="c06.xhtml">Chapter 6</a></span>. The first message was broken in 1991 by Poe expert Terence Whalen of the University of Illinois at Chicago, though his dissertation was not published until 1994. In the meantime, it was also solved independently by John Hodgson in 1993.<sup class="endnote"><a href="b06.xhtml#c09-endnote-22" id="c09-noteref-22">22</a></sup> The cipher turned out to be a simple substitution cipher without spaces, combined with a transposition.</p>
<p>Tyler’s first cryptogram is depicted in <a href="#figure9-7" id="figureanchor9-7">Figure 9-7</a>.</p>
<figure>
<img alt="" class="" height="307" src="image_fi/502727c09/f09007.png" width="675"/>
<figcaption><p><a id="figure9-7">Figure 9-7</a>: This reproduction of a cryptogram published by Edgar Allan Poe in 1841 was solved 150 years later.</p></figcaption>
</figure>
<p>As can be seen, Tyler used a nonstandard alphabet. Some cryptanalysts believed this to be a simple substitution cipher without spaces (a Patristocrat), but that assumption didn’t lead anywhere. When Whalen studied the correspondence between Tyler and Poe, he found a hint stating that the letters of each word in the message were reversed. Further analysis showed that the trigraph <code>,†§</code> was especially frequent. Whalen <span epub:type="pagebreak" id="Page_196" title="196"/>guessed that it stood for <code>EHT</code>, the reversed version of <code class="bold">THE</code>, which is the most frequent trigraph in the English language.</p>
<p>Whalen’s guess proved correct. Knowing three letters and the cipher method, he could decipher the message. Can you do it, too?</p>
<h3 id="h2-502727c09-0010"><a class="XrefDestination" id="AnIRAmessage"/><span class="XrefDestination" id="xref-502727c09-017"/>An IRA message</h3>
<p class="BodyFirst">Courtesy of master codebreaker Jim Gillogly, here is a message sent by an IRA member in the 1920s and encrypted in a complete columnar transposition system:<sup class="endnote"><a href="b06.xhtml#c09-endnote-23" id="c09-noteref-23">23</a></sup></p>
<p class="BodyCustom"><code>TTSEW UDSEE OOEHS BERTN TCEUG EHYNT CLCER TNMEF KCUFE HDPDE SIDRN EESDT TREDM EIHUS WHRTB DLETI IEERE TAIRF FLABI FOPWV EEROI RTLAC OWNOT ATLAE</code></p>
<p>Hint: Count the letters. Can you find any good factors?</p>
</section>
</div></body></html>