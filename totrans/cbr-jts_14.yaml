- en: '14'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Ghost on the Moon
  prefs: []
  type: TYPE_NORMAL
- en: According to Japanese legend, if you knew how to seek the ghost who tends trees
    on the moon, he could invite you to the moon to eat the leaves of his tree, making
    you invisible.
  prefs: []
  type: TYPE_NORMAL
- en: In normal times, before the need arises, you should find someone as an undercover
    agent who will become the betrayer, an enemy you plant and thus make a ninja of
    him and have him within the enemy castle, camp or vassalage, exactly as the ghost
    in the legend, Katsuraotoko, is stationed on the moon.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: —Bansenshūkai, Yo-nin I ^([1](b01.xhtml#endnote-93))
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: As part of its array of sophisticated infiltration techniques, the *Bansenshūkai*
    describes a long-term open-disguise tactic called “ghost on the moon.” This tactic
    was designed to acquire privileged information and access through a planted secret
    agent. First, a shinobi recruits a person who is trustworthy, smart, wise, courageous,
    and loyal. Or, if the recruit is not loyal to begin with, the scroll suggests
    taking their family members hostage for the duration of the mission to make them
    “loyal.” Then, the shinobi plants the agent in a foreign province or castle. There,
    they will spend years working earnestly with the target to build up their reputation,
    connections, knowledge, and access. Ideally, the plant will be working closely
    with enemy leadership. The mole must always maintain plausible, reliable, and
    conspicuous means of contact with the shinobi. If this enemy stronghold ever becomes
    a target for attack, the shinobi handler can call on the undercover agent for
    high-confidence intelligence, insider assistance, sabotage, and offensive actions
    against the enemy, including assassination.^([2](b01.xhtml#endnote-94)) And while
    the ghost on the moon gambit took years to pay off, to patient and tactful shinobi,
    the reward was worth the time investment.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we will look at the ghost on the moon as a type of insider
    threat. It can help to think of hardware implants, by way of analogy, as trying
    to find ghosts on the moon with a telescope. For that reason, we’ll cover the
    subject of implants, supply chain security, and covert hardware backdoors. We
    will also compare the characteristics of a ghost on the moon plant with ideal
    hardware implants. We’ll touch on supply chain risk management and threat-hunting
    strategies, with the caveat that underlying issues make this threat nearly impossible
    to fully defend against.
  prefs: []
  type: TYPE_NORMAL
- en: Implants
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Corporate espionage and nation-state spy activities historically have relied
    on strategically placed agents to accomplish specific long-term missions. Today,
    technology offers newer and cheaper ways to get the results that have traditionally
    been possible only with human actors. For example, suppose your organization bought
    and installed a foreign-manufactured router on its network years ago, and it has
    functioned perfectly. But, unbeknownst to your security team, an adversary has
    just activated a hidden implant installed at the factory, providing direct, unfiltered
    backdoor access to your most sensitive systems and data.
  prefs: []
  type: TYPE_NORMAL
- en: The cybersecurity industry classifies this kind of attack as a *supply chain
    attack*. Here, *supply chain* refers to the products and services associated with
    an organization’s business activities or systems; examples include hardware, software,
    and cloud hosting. In the previous example, the router performs the necessary
    business activity of moving digital information over the network to conduct ecommerce.
  prefs: []
  type: TYPE_NORMAL
- en: 'While heuristics or threat hunting can detect abnormal router behavior, there
    is no foolproof way to defend against covert implants. Some organizations may
    use quality assurance representatives to monitor manufacturing, but they cannot
    ensure that every system is built correctly. However, several cybersecurity best
    practices can mitigate a router-based supply chain attack. A proactive organization
    could:'
  prefs: []
  type: TYPE_NORMAL
- en: Perform a threat analysis of all router manufacturers and then use the results
    to acquire a router less likely to ship with compromised hardware or software
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Employ a trusted, secure shipping service and procure chain of custody for the
    router to prevent malicious interception
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Conduct forensic inspection of the router upon delivery to validate that it
    has not been compromised or altered from the expected specifications
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Secure the router with tamper protections and detection technologies to identify
    and mitigate unauthorized alterations
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Note that these steps are not limited to routers. Organizations can take these
    precautions on every service, device, system, component, and software application
    in their supply chain.
  prefs: []
  type: TYPE_NORMAL
- en: Covert implants are as valuable to modern nation-states as they were to shinobi,
    because the need to discover and defend against them poses difficult, long-term
    organizational challenges. Cybersecurity professionals continually test new concepts
    to address those challenges. For example, an organization can restrict trust and
    access to all systems under the assumption that they have already been compromised.
    However, the significant impact they have on business operations renders many
    of these concepts a practical impossibility.
  prefs: []
  type: TYPE_NORMAL
- en: Protections from Implants
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Organizations attempting to weigh or x-ray every system to find something out
    of place will likely find themselves lost in the process of trying to manage their
    supply chain. What’s more, advanced threat actors capable of supply chain compromises
    are likely to embed malicious functions in the default design of the system. In
    this way, only *they* know the secret to enabling the implant, and it exists in
    every system. And while an organization’s inspection process may be able to see
    a threat, it might not understand what it’s looking at. This is the scope of this
    problem—it’s like trying to find a ghost on the moon. That said, guidance for
    protecting your organization from these implants is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '*Identify supply chain attack conditions.* Create a list of components in your
    supply chain that have ghost on the moon potential. Include elements that:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Are considered high trust
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Can communicate
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Can provide lateral or direct access to sensitive information or systems
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Are not easily inspected
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Are not regularly replaced or updated
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Specifically, look at software and hardware that communicates with external
    systems or exerts control over systems that can perform signal or communication
    functions (such as firmware on routers, network interface cards [NICs], and VPN
    concentrators). An implant can also exist as a hardware device, such as an extremely
    thin metal interface placed inside the PCI interface socket to act as a man-in-the-middle
    against the NIC, altering the data flow, integrity, confidentiality, and availability
    of network communications for that interface.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Imagine what your antivirus, hypervisor, vulnerability scanner, or forensic
    analyst cannot inspect or test in your environment. A key feature of ghost on
    the moon supply chain candidates is their ability to persist in the target’s environment,
    which likely requires targeting components that do not break or wear down regularly,
    are not easily replaced or upgraded with cheaper versions over time, are too important
    to turn off or dispose of, and are difficult to modify and update (such as firmware,
    BIOS, UEFI, and MINIX). Autonomy and stealth requirements for this class of supply
    chain implant mean the implant needs to avoid inspection, scans, and other types
    of integrity testing while having access to some form of processor instruction
    or execution.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '*Implement supply chain protections.* Implement supply chain safeguards and
    protections as needed. A ghost on the moon supply chain attack is one of the most
    challenging to detect, prevent, or mitigate. Thus, many organizations simply accept
    or ignore this risk. It can be useful to start with first principles—fundamental
    truths about security and the purpose of your business—and then use these truths
    as a rubric to evaluate the threat your organization faces. Review “A Contemporary
    Look at Saltzer and Schroeder’s 1975 Design Principles”^([3](b01.xhtml#endnote-95))
    or other core security works to determine appropriate mitigations for this threat.
    It could also be helpful to abstract the problems to higher-level concepts, where
    they become familiar and understood, and then attempt to solve them. Consider
    the following Castle Theory Thought Exercise.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Recommended Security Controls and Mitigations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Where relevant, recommendations are presented with applicable security controls
    from the NIST 800-53 standard. Each should be evaluated with the concept of ghost
    on the moon in mind.
  prefs: []
  type: TYPE_NORMAL
- en: 'Consider introducing heterogeneity into the supply chain by isolating, segmenting,
    and layering a diverse set of supply chain components. Supply chain diversity
    greatly reduces the potential impact of a compromised component. [SC-29: Heterogeneity]'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Analyze your organization’s procurement process to identify areas in which
    you can reduce the risk of a supply chain attack. Use techniques such as blind
    buying, trusted shipping, restricting purchases from certain companies or countries,
    amending purchasing contract language, and randomizing or minimizing acquisition
    time. [SA-12: Supply Chain Protection | (1) Acquisition Strategies/Tools/Methods]'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Consider delaying non-security updates or acquisition of new, untested software,
    hardware, and services for as long as possible. Implement advanced countermeasures
    to limit a sophisticated actor’s opportunity to target your organization. [SA-12:
    Supply Chain Protection | (5) Limitation of Harm]'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Purchase or assess multiple instances of the same hardware, software, component,
    or service through different vendors to identify alterations or non-genuine elements.
    [SA-12: Supply Chain Protection | (10) Validate as Genuine and Not Altered; SA-19:
    Component Authenticity; SI-7: Software, Firmware, and Information Integrity |
    (12) Integrity Verification]'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Install independent, out-of-band monitoring mechanisms and sanity tests to
    verify that high-trust components suspected of supply chain attack are not performing
    covert communications or altering data streams. [SI-4: Information System Monitoring
    | (11) Analyze Communications Traffic Anomalies | (17) Integrated Situational
    Awareness | (18) Analyze Traffic/Covert Exfiltration]'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Debrief
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this chapter, we reviewed the shinobi technique of hiring trusted allies
    to work inside an organization and position themselves to be as useful to the
    shinobi as possible. We compared this type of plant to hardware implants and discussed
    the theory behind what devices and systems would be suitable for hardware implants.
    We talked about supply chain attacks, along with ways to potentially detect them.
    The thought exercise challenged you to detect a compromised scribe who has privileged
    access to communications; the scribe represents a router, VPN, or other layer
    3 device meant to be transparent to the communicators, highlighting how difficult
    it can be to determine when such a device is compromised.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will discuss the shinobi’s backup plan if you do happen
    to catch them or their plant. The shinobi would often plant false evidence ahead
    of time, long before their covert mission, enabling them to shift blame if caught.
    When successful, this tactic tricks the victim into believing an ally betrayed
    them, and this deception itself harms the target.
  prefs: []
  type: TYPE_NORMAL
