- en: '14'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '14'
- en: Ghost on the Moon
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 月球上的鬼魂
- en: According to Japanese legend, if you knew how to seek the ghost who tends trees
    on the moon, he could invite you to the moon to eat the leaves of his tree, making
    you invisible.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 根据日本传说，如果你知道如何寻找月球上种树的鬼魂，他会邀请你到月球上吃他树上的叶子，使你变得隐形。
- en: In normal times, before the need arises, you should find someone as an undercover
    agent who will become the betrayer, an enemy you plant and thus make a ninja of
    him and have him within the enemy castle, camp or vassalage, exactly as the ghost
    in the legend, Katsuraotoko, is stationed on the moon.
  id: totrans-3
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在正常情况下，在需求出现之前，你应该找到一个作为卧底的人，他将成为背叛者，一个你派遣的敌人，这样你就能让他成为忍者，并将他安置在敌人的城堡、营地或封地中，正如传说中的月球上的鬼魂桂男（Katsuraotoko）驻扎在月球上一样。
- en: ''
  id: totrans-4
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: —Bansenshūkai, Yo-nin I ^([1](b01.xhtml#endnote-93))
  id: totrans-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: —《万川集海》，四忍 I ^([1](b01.xhtml#endnote-93))
- en: As part of its array of sophisticated infiltration techniques, the *Bansenshūkai*
    describes a long-term open-disguise tactic called “ghost on the moon.” This tactic
    was designed to acquire privileged information and access through a planted secret
    agent. First, a shinobi recruits a person who is trustworthy, smart, wise, courageous,
    and loyal. Or, if the recruit is not loyal to begin with, the scroll suggests
    taking their family members hostage for the duration of the mission to make them
    “loyal.” Then, the shinobi plants the agent in a foreign province or castle. There,
    they will spend years working earnestly with the target to build up their reputation,
    connections, knowledge, and access. Ideally, the plant will be working closely
    with enemy leadership. The mole must always maintain plausible, reliable, and
    conspicuous means of contact with the shinobi. If this enemy stronghold ever becomes
    a target for attack, the shinobi handler can call on the undercover agent for
    high-confidence intelligence, insider assistance, sabotage, and offensive actions
    against the enemy, including assassination.^([2](b01.xhtml#endnote-94)) And while
    the ghost on the moon gambit took years to pay off, to patient and tactful shinobi,
    the reward was worth the time investment.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 作为其一系列复杂渗透技巧的一部分，*《万川集海》*描述了一种长期的伪装策略，叫做“月球上的鬼魂”。这个策略旨在通过安插秘密特工来获取特权信息和访问权限。首先，一个忍者招募一个值得信赖、聪明、睿智、勇敢和忠诚的人。或者，如果招募的人一开始不忠诚，卷轴建议在任务期间以他们的家人作为人质，以确保他们变得“忠诚”。然后，忍者将特工安插到一个外省或城堡。在那里，他们将花费多年时间与目标真诚合作，建立自己的声誉、关系、知识和访问权限。理想情况下，这个卧底将与敌方领导层密切合作。卧底必须始终保持可信、可靠且显眼的联系方式，以便与忍者保持联系。如果这个敌人的据点成为攻击目标，忍者的指挥官可以召唤卧底提供高可信度的情报、内部支持、破坏行动以及对敌人的进攻行动，包括刺杀。^([2](b01.xhtml#endnote-94))
    而尽管“月球上的鬼魂”策略需要数年才能见效，但对于耐心和圆滑的忍者而言，回报是值得的。
- en: In this chapter, we will look at the ghost on the moon as a type of insider
    threat. It can help to think of hardware implants, by way of analogy, as trying
    to find ghosts on the moon with a telescope. For that reason, we’ll cover the
    subject of implants, supply chain security, and covert hardware backdoors. We
    will also compare the characteristics of a ghost on the moon plant with ideal
    hardware implants. We’ll touch on supply chain risk management and threat-hunting
    strategies, with the caveat that underlying issues make this threat nearly impossible
    to fully defend against.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将把月球上的鬼魂看作一种内部威胁。可以通过类比，把硬件植入物想象成试图用望远镜寻找月球上的鬼魂。因此，我们将探讨植入物、供应链安全和隐秘硬件后门等话题。我们还将比较月球鬼魂植物与理想硬件植入物的特点。我们将简要讨论供应链风险管理和威胁狩猎策略，但需要注意的是，潜在问题使得完全防范这种威胁几乎不可能。
- en: Implants
  id: totrans-8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 植入物
- en: Corporate espionage and nation-state spy activities historically have relied
    on strategically placed agents to accomplish specific long-term missions. Today,
    technology offers newer and cheaper ways to get the results that have traditionally
    been possible only with human actors. For example, suppose your organization bought
    and installed a foreign-manufactured router on its network years ago, and it has
    functioned perfectly. But, unbeknownst to your security team, an adversary has
    just activated a hidden implant installed at the factory, providing direct, unfiltered
    backdoor access to your most sensitive systems and data.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 企业间谍活动和国家间谍行为历史上依赖于战略性地安置的特工来完成特定的长期任务。今天，技术提供了更新、更廉价的方式来获得传统上只有通过人工干预才能实现的结果。例如，假设贵组织几年前购买并安装了一台外国制造的路由器，并且它运行完美无缺。但在你们的安全团队不知情的情况下，敌对方刚刚激活了在工厂中安装的隐藏植入物，提供了对你们最敏感系统和数据的直接、未过滤的后门访问。
- en: The cybersecurity industry classifies this kind of attack as a *supply chain
    attack*. Here, *supply chain* refers to the products and services associated with
    an organization’s business activities or systems; examples include hardware, software,
    and cloud hosting. In the previous example, the router performs the necessary
    business activity of moving digital information over the network to conduct ecommerce.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 网络安全行业将这种攻击分类为*供应链攻击*。这里的*供应链*指的是与组织的业务活动或系统相关的产品和服务；例如，硬件、软件和云托管。在前面的例子中，路由器执行了将数字信息通过网络传输以进行电子商务的必要业务活动。
- en: 'While heuristics or threat hunting can detect abnormal router behavior, there
    is no foolproof way to defend against covert implants. Some organizations may
    use quality assurance representatives to monitor manufacturing, but they cannot
    ensure that every system is built correctly. However, several cybersecurity best
    practices can mitigate a router-based supply chain attack. A proactive organization
    could:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管启发式方法或威胁狩猎可以检测到异常的路由器行为，但没有万无一失的方法来防御隐蔽植入物。一些组织可能会使用质量保证代表来监控生产，但他们不能确保每个系统都按正确的方式构建。然而，几项网络安全最佳实践可以缓解基于路由器的供应链攻击。一家积极主动的组织可以：
- en: Perform a threat analysis of all router manufacturers and then use the results
    to acquire a router less likely to ship with compromised hardware or software
  id: totrans-12
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对所有路由器制造商进行威胁分析，然后根据结果选择不太可能携带被妥协硬件或软件的路由器。
- en: Employ a trusted, secure shipping service and procure chain of custody for the
    router to prevent malicious interception
  id: totrans-13
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用受信任的、安全的运输服务，并获取路由器的交付链以防止恶意拦截。
- en: Conduct forensic inspection of the router upon delivery to validate that it
    has not been compromised or altered from the expected specifications
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在交付后对路由器进行法医检查，验证其是否没有被妥协或从预期的规格中改变。
- en: Secure the router with tamper protections and detection technologies to identify
    and mitigate unauthorized alterations
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为路由器提供防篡改保护和检测技术，以识别和减轻未经授权的修改。
- en: Note that these steps are not limited to routers. Organizations can take these
    precautions on every service, device, system, component, and software application
    in their supply chain.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，这些步骤不限于路由器。组织可以在其供应链中的每个服务、设备、系统、组件和软件应用程序上采取这些预防措施。
- en: Covert implants are as valuable to modern nation-states as they were to shinobi,
    because the need to discover and defend against them poses difficult, long-term
    organizational challenges. Cybersecurity professionals continually test new concepts
    to address those challenges. For example, an organization can restrict trust and
    access to all systems under the assumption that they have already been compromised.
    However, the significant impact they have on business operations renders many
    of these concepts a practical impossibility.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 隐蔽植入物对现代国家来说与对忍者一样有价值，因为发现并防御这些植入物的需求给组织带来了困难且长期的挑战。网络安全专业人员不断测试新的概念来应对这些挑战。例如，组织可以假设所有系统已经遭到妥协，并限制信任和访问。然而，这些概念对业务运营的重大影响使得许多做法在实践中几乎不可能实施。
- en: Protections from Implants
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 防护措施——来自植入物的防护
- en: 'Organizations attempting to weigh or x-ray every system to find something out
    of place will likely find themselves lost in the process of trying to manage their
    supply chain. What’s more, advanced threat actors capable of supply chain compromises
    are likely to embed malicious functions in the default design of the system. In
    this way, only *they* know the secret to enabling the implant, and it exists in
    every system. And while an organization’s inspection process may be able to see
    a threat, it might not understand what it’s looking at. This is the scope of this
    problem—it’s like trying to find a ghost on the moon. That said, guidance for
    protecting your organization from these implants is as follows:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 试图对每个系统进行称重或X射线检查以发现异常的组织，很可能会在管理供应链的过程中迷失方向。而且，能够进行供应链破坏的高级威胁行为者，很可能会将恶意功能嵌入到系统的默认设计中。通过这种方式，只有*他们*知道启用植入物的秘密，并且它存在于每个系统中。尽管一个组织的检查过程可能能够发现威胁，但它可能无法理解所看到的内容。这就是这个问题的范围——就像试图在月球上找到一个幽灵。因此，保护你的组织免受这些植入物的指导建议如下：
- en: '*Identify supply chain attack conditions.* Create a list of components in your
    supply chain that have ghost on the moon potential. Include elements that:'
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*识别供应链攻击条件*。创建一个供应链组件的清单，列出那些具有月球幽灵潜力的组件。包括以下元素：'
- en: Are considered high trust
  id: totrans-21
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 被视为高度可信
- en: Can communicate
  id: totrans-22
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 能进行通信
- en: Can provide lateral or direct access to sensitive information or systems
  id: totrans-23
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 能够提供横向或直接访问敏感信息或系统
- en: Are not easily inspected
  id: totrans-24
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不易检查
- en: Are not regularly replaced or updated
  id: totrans-25
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不经常更换或更新
- en: Specifically, look at software and hardware that communicates with external
    systems or exerts control over systems that can perform signal or communication
    functions (such as firmware on routers, network interface cards [NICs], and VPN
    concentrators). An implant can also exist as a hardware device, such as an extremely
    thin metal interface placed inside the PCI interface socket to act as a man-in-the-middle
    against the NIC, altering the data flow, integrity, confidentiality, and availability
    of network communications for that interface.
  id: totrans-26
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 具体而言，检查与外部系统通信或控制能够执行信号或通信功能的系统的软件和硬件（例如路由器上的固件、网络接口卡[NIC]和VPN集中器）。植入物也可以作为硬件设备存在，例如放置在PCI接口插槽中的极薄金属接口，充当NIC的中间人，改变数据流、完整性、机密性和网络通信的可用性。
- en: Imagine what your antivirus, hypervisor, vulnerability scanner, or forensic
    analyst cannot inspect or test in your environment. A key feature of ghost on
    the moon supply chain candidates is their ability to persist in the target’s environment,
    which likely requires targeting components that do not break or wear down regularly,
    are not easily replaced or upgraded with cheaper versions over time, are too important
    to turn off or dispose of, and are difficult to modify and update (such as firmware,
    BIOS, UEFI, and MINIX). Autonomy and stealth requirements for this class of supply
    chain implant mean the implant needs to avoid inspection, scans, and other types
    of integrity testing while having access to some form of processor instruction
    or execution.
  id: totrans-27
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 想象一下你的杀毒软件、虚拟机监控程序、漏洞扫描器或取证分析师在你的环境中无法检查或测试的内容。月球上的幽灵供应链候选者的一个关键特征是它们能够在目标环境中持久存在，这通常需要针对那些不易经常损坏或磨损、不易被便宜版本替换或升级、重要到无法关闭或丢弃、并且难以修改和更新的组件（例如固件、BIOS、UEFI和MINIX）。这一类供应链植入的自主性和隐匿性要求意味着植入物必须避开检查、扫描以及其他类型的完整性测试，同时能够访问某种形式的处理器指令或执行。
- en: '*Implement supply chain protections.* Implement supply chain safeguards and
    protections as needed. A ghost on the moon supply chain attack is one of the most
    challenging to detect, prevent, or mitigate. Thus, many organizations simply accept
    or ignore this risk. It can be useful to start with first principles—fundamental
    truths about security and the purpose of your business—and then use these truths
    as a rubric to evaluate the threat your organization faces. Review “A Contemporary
    Look at Saltzer and Schroeder’s 1975 Design Principles”^([3](b01.xhtml#endnote-95))
    or other core security works to determine appropriate mitigations for this threat.
    It could also be helpful to abstract the problems to higher-level concepts, where
    they become familiar and understood, and then attempt to solve them. Consider
    the following Castle Theory Thought Exercise.'
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*实施供应链保护措施*。根据需要实施供应链保障和保护措施。月球上的幽灵供应链攻击是最难以检测、预防或缓解的攻击之一。因此，许多组织干脆接受或忽视这一风险。从基本原则入手——关于安全性和业务目的的基本真理——然后将这些真理作为评估组织面临的威胁的准则可能会很有帮助。可以参考《盐泽与施罗德的1975年设计原则的当代视角》^([3](b01.xhtml#endnote-95))或其他核心安全工作，来确定应对这一威胁的适当缓解措施。也可以通过将问题抽象到更高层次的概念，使其变得熟悉并得到理解，然后再尝试解决它们，这也是一种有效的方法。可以考虑以下的城堡理论思维练习。'
- en: Recommended Security Controls and Mitigations
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 推荐的安全控制和缓解措施
- en: Where relevant, recommendations are presented with applicable security controls
    from the NIST 800-53 standard. Each should be evaluated with the concept of ghost
    on the moon in mind.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在相关的情况下，建议使用适用的 NIST 800-53 标准中的安全控制。每一项建议都应结合“月球上的幽灵”这一概念进行评估。
- en: 'Consider introducing heterogeneity into the supply chain by isolating, segmenting,
    and layering a diverse set of supply chain components. Supply chain diversity
    greatly reduces the potential impact of a compromised component. [SC-29: Heterogeneity]'
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '考虑通过隔离、分段和分层多样化的供应链组件，将异质性引入供应链。供应链多样性大大降低了受损组件可能带来的影响。[SC-29: 异质性]'
- en: 'Analyze your organization’s procurement process to identify areas in which
    you can reduce the risk of a supply chain attack. Use techniques such as blind
    buying, trusted shipping, restricting purchases from certain companies or countries,
    amending purchasing contract language, and randomizing or minimizing acquisition
    time. [SA-12: Supply Chain Protection | (1) Acquisition Strategies/Tools/Methods]'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '分析你组织的采购流程，找出可以减少供应链攻击风险的领域。可以使用诸如盲目采购、可信运输、限制从某些公司或国家购买、修改采购合同条款、随机化或最小化采购时间等技术。[SA-12:
    供应链保护 | (1) 采购策略/工具/方法]'
- en: 'Consider delaying non-security updates or acquisition of new, untested software,
    hardware, and services for as long as possible. Implement advanced countermeasures
    to limit a sophisticated actor’s opportunity to target your organization. [SA-12:
    Supply Chain Protection | (5) Limitation of Harm]'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '考虑尽可能延迟非安全性更新或新采购的未经测试的软件、硬件和服务。实施先进的反制措施，以限制精密攻击者针对你组织的机会。[SA-12: 供应链保护 |
    (5) 限制伤害]'
- en: 'Purchase or assess multiple instances of the same hardware, software, component,
    or service through different vendors to identify alterations or non-genuine elements.
    [SA-12: Supply Chain Protection | (10) Validate as Genuine and Not Altered; SA-19:
    Component Authenticity; SI-7: Software, Firmware, and Information Integrity |
    (12) Integrity Verification]'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '通过不同的供应商购买或评估相同硬件、软件、组件或服务的多个实例，以识别修改或不真实的元素。[SA-12: 供应链保护 | (10) 验证为真实且未修改；SA-19:
    组件真实性；SI-7: 软件、固件和信息完整性 | (12) 完整性验证]'
- en: 'Install independent, out-of-band monitoring mechanisms and sanity tests to
    verify that high-trust components suspected of supply chain attack are not performing
    covert communications or altering data streams. [SI-4: Information System Monitoring
    | (11) Analyze Communications Traffic Anomalies | (17) Integrated Situational
    Awareness | (18) Analyze Traffic/Covert Exfiltration]'
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '安装独立的、带外的监控机制和合理性测试，以验证被怀疑受到供应链攻击的高信任组件没有执行隐蔽通信或篡改数据流。[SI-4: 信息系统监控 | (11)
    分析通信流量异常 | (17) 集成情境意识 | (18) 分析流量/隐蔽外泄]'
- en: Debrief
  id: totrans-36
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 汇报
- en: In this chapter, we reviewed the shinobi technique of hiring trusted allies
    to work inside an organization and position themselves to be as useful to the
    shinobi as possible. We compared this type of plant to hardware implants and discussed
    the theory behind what devices and systems would be suitable for hardware implants.
    We talked about supply chain attacks, along with ways to potentially detect them.
    The thought exercise challenged you to detect a compromised scribe who has privileged
    access to communications; the scribe represents a router, VPN, or other layer
    3 device meant to be transparent to the communicators, highlighting how difficult
    it can be to determine when such a device is compromised.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们回顾了忍者技术中雇佣可信赖的盟友在组织内工作，并使自己尽可能地为忍者提供帮助的策略。我们将这种类型的“间谍”与硬件植入物进行了比较，并讨论了哪些设备和系统适合用于硬件植入物的理论。我们谈到了供应链攻击，并探讨了潜在的检测方法。思维练习挑战你识别一个具有特权访问权限的被妥协的书记员；书记员代表了一个路由器、VPN
    或其他层 3 设备，这些设备应该对通讯双方透明，强调了当此类设备被妥协时，判断它是否被入侵的困难。
- en: In the next chapter, we will discuss the shinobi’s backup plan if you do happen
    to catch them or their plant. The shinobi would often plant false evidence ahead
    of time, long before their covert mission, enabling them to shift blame if caught.
    When successful, this tactic tricks the victim into believing an ally betrayed
    them, and this deception itself harms the target.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将讨论忍者的备份计划，假如你确实抓住了他们或他们的“间谍”。忍者通常会提前植入虚假证据，在他们的隐秘任务之前很久就进行准备，以便在被抓时将责任转移。当成功时，这一策略会欺骗受害者，让他们相信是盟友背叛了他们，而这种欺骗本身就对目标造成伤害。
