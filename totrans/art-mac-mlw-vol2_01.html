<html><head></head><body>
<div id="book-content">
<div id="sbo-rt-content"><section epub:type="part" role="doc-part" aria-labelledby="pt1">&#13;
<span role="doc-pagebreak" epub:type="pagebreak" id="pg_1" aria-label="1"/>&#13;
<hgroup>&#13;
&#13;
<h1 class="PART" id="pt1">&#13;
<span class="PN"><span class="SANS_Futura_Std_Bold_Condensed_B_11">PART I</span></span>&#13;
<span class="PT"><span class="Sans_Dogma_B">DATA COLLECTION</span></span>&#13;
</h1>&#13;
</hgroup>&#13;
<p class="PCO">Malware detection begins with data collection. All malicious code performs actions on an infected system that deviate from the norm. Therefore, by collecting sufficient data, you can uncover any infection.</p>&#13;
<p class="TX">Symptoms of digital pathogens often reflect the malware’s goals or capabilities. For example, if a computer is infected with adware, you’ll likely see browser subversions or hijacked search pages. In the case of a stealthy backdoor, you may observe a listening socket that allows an attacker to remotely control the infected system or its unauthorized network traffic. And any malware that wants to survive a reboot will have to persist, resulting in noticeable filesystem modifications.</p>&#13;
<p class="TX">In <a href="part1.xhtml">Part I</a>, I discuss how security software could programmatically collect data from a macOS system to detect any digital infections, just as a doctor might when checking whether a human patient is sick. Most malicious code on macOS systems runs as a stand-alone process, so I’ll start this section by discussing programmatic methods of querying the system to retrieve a snapshot of all running processes. Then we’ll extract information about each process, such as their arguments, hierarchies, loaded libraries, and much more. If any running process is indeed malware, the information we extract here should readily reveal this fact.</p>&#13;
<p class="TX">Subsequent chapters will bolster our malware detection capabilities by illustrating how to extract other types of data, either from specific items or from the system as a whole. I’ll discuss code signing by delving into <span role="doc-pagebreak" epub:type="pagebreak" id="pg_2" aria-label="2"/>mechanisms and APIs to obtain and validate cryptographic code signing signatures. This information can further uncover malware, but equally importantly, it also allows us to ignore trusted items in our hunt for malicious code. I’ll also show how to glean important data from Mach-O binaries, the network, and Apple’s proprietary Background Task Management database used to manage persistent items.</p>&#13;
</section>&#13;
</div>
</div>
</body></html>