<html><head></head><body><div id="sbo-rt-content"><section>
<header>
<figure class="opener">
<img src="Images/chapterart.png" alt=""/>
</figure>
<h1 class="chapterTitle">
<span class="ChapterNumber"><span epub:type="pagebreak" title="185" id="Page_185"/>12</span><br/>
<span class="ChapterTitle">Avoiding the Monster</span>
</h1>
</header>
<p class="ChapterIntro"><span class="OpenerCap"><img src="Images/Alphabet-A.png" alt="Alphabet-A" class="dropcap"/></span>I and ML have exciting potential for the future of computer games, such as computer game characters that learn to understand your words and actions. There are already games where characters behave like the chatbots you learned about in the last chapter. However, the opportunity for truly intelligent games that adapt as they are played is enormous.</p>
<p><span epub:type="pagebreak" title="186" id="Page_186"/>In this chapter, we’ll look at the reverse situation: not how AI can contribute to game development, but how games have been used in AI development.</p>
<p>Games provide a simulation environment with a well-defined goal, a way to collect training examples, and a way to measure effectiveness, which makes them a great platform for the research and development of computer systems that can learn.</p>
<p><em>Pac-Man</em> (and <em>Ms. Pac-Man</em>) is an example of a classic computer game that has regularly been used in AI research. The <em>Ms. Pac-Man AI competition</em><em/>, where academics submit ML systems that compete to see which is best at playing the game, has been held multiple times since 2007 and is still used as a task for AI students and researchers today.</p>
<p>In this chapter, you’ll try training an ML system to play a simplified version of <em>Pac-Man</em>, where the objective is to navigate a character through a maze while avoiding a monster (see <a id="figureanchor12-1" href="#figure12-1">Figure 12-1</a>).</p>
<p>Let’s get started! </p>
<figure>
<img src="Images/f12001.png" alt="f12001"/>
<figcaption><p><a id="figure12-1" href="#figureanchor12-1">Figure 12-1:</a> A simple video game we can train an ML system to play</p></figcaption>
</figure>
<h2 id="h1-500563c12-0001"><span epub:type="pagebreak" title="187" id="Page_187"/>Build Your Project</h2>
<p class="BodyFirst">Before we start, try the game for yourself so you understand what we’ll be training the computer to do. First, go to <a href="https://machinelearningforkids.co.uk/scratch3/" class="LinkURL">https://machinelearningforkids.co.uk/scratch3/</a> and click <b>Project templates</b> in the top menu bar, as shown in <a id="figureanchor12-2" href="#figure12-2">Figure 12-2</a>.</p>
<figure>
<img src="Images/f12002.png" alt="f12002"/>
<figcaption><p><a id="figure12-2" href="#figureanchor12-2">Figure 12-2:</a> Access the game from the <b>Project templates</b> menu. </p></figcaption>
</figure>
<p>Click the <b>Avoid the monster</b> game as shown in <a id="figureanchor12-3" href="#figure12-3">Figure 12-3</a>. </p>
<figure>
<img src="Images/f12003.png" alt="f12003"/>
<figcaption><p><a id="figure12-3" href="#figureanchor12-3">Figure 12-3:</a> Click <b>Avoid the monster</b> in the list of project templates.</p></figcaption>
</figure>
<p>In this game, you play as the character <em>nano</em>, which starts off in the bottom-left corner of the Stage. Your objective is to avoid the monster, which starts off in the top-right corner of the Stage, for as long as you can.</p>
<p><span epub:type="pagebreak" title="188" id="Page_188"/>You control nano using the arrow keys to change direction. Nano can only follow the grid, so you can only move up, down, left, and right. You can’t move diagonally. </p>
<p>When you’re not pressing an arrow key, nano will just continue in whatever direction you last pressed. </p>
<p>Nano can’t move faster than the monster. The game’s code uses a timer so that both nano and the monster can make only one move per second.</p>
<p>There are two walls in the way. Neither nano nor the monster is allowed to go through the walls. </p>
<p>Give the game a try. Click the full-screen icon in the controls at the top right and then click the Green Flag. </p>
<p>How long can you avoid the monster?</p>
<h3 id="h2-500563c12-0001">Describe the State of the Game</h3>
<p class="BodyFirst">The game board can be represented as a graph, as shown in <a id="figureanchor12-4" href="#figure12-4">Figure 12-4</a>. </p>
<figure>
<img src="Images/f12004.png" alt="f12004"/>
<figcaption><p><a id="figure12-4" href="#figureanchor12-4">Figure 12-4:</a> Think of the game board as a graph with x- and y-axes. </p></figcaption>
</figure>
<p>Using this graph, you can describe the locations of nano and the monster as a pair of coordinates. For example, in <a href="#figure12-4">Figure 12-4</a> the monster is at <em>x</em> = 7 and <em>y</em> = 3.</p>
<p>We’ll use this representation of the game to describe it to the computer. </p>
<p>We want to give the computer four numbers so that it can decide to move nano up, down, left, or right to avoid the monster. </p>
<p><span epub:type="pagebreak" title="189" id="Page_189"/>For example, if we input the coordinates shown in <a id="figureanchor12-5" href="#figure12-5">Figure 12-5</a>, the computer could decide to move nano up. </p>
<figure>
<img src="Images/f12005.png" alt="f12005"/>
<figcaption><p><a id="figure12-5" href="#figureanchor12-5">Figure 12-5:</a> Nano is at <em>x</em> = 5, <em>y</em> = 5, and the monster is at <em>x</em> = 7, <em>y</em> = 3. </p></figcaption>
</figure>
<p>Your objective for this project is to train an ML model to decide on the best direction to avoid the monster. </p>
<h3 id="h2-500563c12-0002">Train Your Model</h3>
<p class="BodyFirst">To train the computer to play the game, you need to collect examples of the game being played. The best way to do this is to play the game yourself and use your playing to train the computer. </p>
<p>The first step is to prepare the training buckets where you’ll store examples of the moves you make.</p>
<ol>
<li value="1">Go to <em><a href="https://machinelearningforkids.co.uk/" class="LinkURL">https://machinelearningforkids.co.uk/</a></em>. Create a new ML project, name it <code class="bold">Avoid the monster</code>, and set it to learn to recognize numbers.
<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<h2><span class="NoteHead">Note	</span></h2>
<p>If you’re not sure how to create an ML project, read the section <span class="xref" itemid="xref_target_“Creating a New ML Project” on page 9">“Creating a New ML Project” on page 9</span> in <span class="xref" itemid="xref_target_Chapter 2">Chapter 2</span>.</p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
</li>
<li value="2">Click <b>Add a value</b>, type <code class="bold">nano x</code> for the value name, and set <b>Type of value</b> to <b>number</b>. Click <b>Add another value</b> and then add three more values named <code class="bold">nano y</code>, <code class="bold">monster x</code>, and <code class="bold">monster y</code>, as shown in <a id="figureanchor12-6" href="#figure12-6">Figure 12-6</a>. Once you’ve added all four values, click <b>Create</b>.
<p class="ListBody"><span epub:type="pagebreak" title="190" id="Page_190"/>These values will store the coordinates of the two characters on the graph.</p>
<figure>
<img src="Images/f12006.png" alt="f12006"/>
<figcaption><p><a id="figure12-6" href="#figureanchor12-6">Figure 12-6:</a> Prepare the values for the Avoid the monster project. </p></figcaption>
</figure>
</li>
<li value="3">Click <b>Train</b>, as shown in <a id="figureanchor12-7" href="#figure12-7">Figure 12-7</a>.
<figure>
<img src="Images/f12007.png" alt="f12007"/>
<figcaption><p><a id="figure12-7" href="#figureanchor12-7">Figure 12-7:</a> Click <b>Train</b> to prepare your training buckets. </p></figcaption>
</figure>
</li>
<li value="4">Click <b>Add new label</b>, as shown in <a id="figureanchor12-8" href="#figure12-8">Figure 12-8</a>, and create four training buckets for the four directions nano can move. Call them <code class="bold">go left</code>, <code class="bold">go right</code>, <code class="bold">go up</code>, and <code class="bold">go down</code>. (The underscores will be added automatically.)
<span epub:type="pagebreak" title="191" id="Page_191"/><figure>
<img src="Images/f12008.png" alt="f12008"/>
<figcaption><p><a id="figure12-8" href="#figureanchor12-8">Figure 12-8:</a> Prepare four training buckets for the four directions nano can move.</p></figcaption>
</figure>
<p class="ListBody">For example, imagine nano is at coordinates <em>x</em> = 2, <em>y</em> = 3 and the monster is at the coordinates <em>x</em> = 6, <em>y</em> = 7 while you’re playing the game. If you pressed the right arrow to move nano to the right, that set of numbers would be added to the go_right training bucket, as shown in <a id="figureanchor12-9" href="#figure12-9">Figure 12-9</a>.</p>
<figure>
<img src="Images/f12009.png" alt="f12009"/>
<figcaption><p><a id="figure12-9" href="#figureanchor12-9">Figure 12-9:</a> Moves that you make while playing the game will be added to the training buckets.</p></figcaption>
</figure>
<p class="ListBody">The next step is to collect lots and lots of examples that we can use to train an ML model. We’ll collect training examples by playing the game. </p></li>
<li value="5"><span epub:type="pagebreak" title="192" id="Page_192"/>Click <b>Back to project</b> and then click <b>Make</b>, as shown in <a id="figureanchor12-10" href="#figure12-10">Figure 12-10</a>.
<figure>
<img src="Images/f12010.png" alt="f12010"/>
<figcaption><p><a id="figure12-10" href="#figureanchor12-10">Figure 12-10:</a> Click <b>Make</b> to use your project in Scratch. </p></figcaption>
</figure>
</li>
<li value="6">Click <b>Scratch 3</b>, as shown in <a id="figureanchor12-11" href="#figure12-11">Figure 12-11</a>.
<figure>
<img src="Images/f12011.png" alt="f12011"/>
<figcaption><p><a id="figure12-11" href="#figureanchor12-11">Figure 12-11:</a> Click <b>Scratch 3</b> to go back to Scratch. </p></figcaption>
</figure>
</li>
<li value="7">Click <b>straight into Scratch</b>, as shown in <a id="figureanchor12-12" href="#figure12-12">Figure 12-12</a>.
<aside epub:type="sidebar">
<div class="top hr"><hr/></div>
<section class="note">
<h2><span class="NoteHead">Note	</span></h2>
<p>The page will warn you that you don’t have an ML model yet, but that’s fine—you’ll be using Scratch to collect training data. </p>
<div class="bottom hr"><hr/></div>
</section>
</aside>
</li>
<li value="8">Click <b>Project templates</b> in the top menu bar.</li>
<li value="9">Click <b>Avoid the monster</b> to open the template again, this time with blocks from your ML project. 
<span epub:type="pagebreak" title="193" id="Page_193"/><figure>
<img src="Images/f12012.png" alt="f12012"/>
<figcaption><p><a id="figure12-12" href="#figureanchor12-12">Figure 12-12:</a> Click <b>straight into Scratch</b> even though you don’t have an ML model yet.</p></figcaption>
</figure>
</li>
<li value="10">Click the <b>Stage</b> backdrop at the bottom right of the screen. In the Code Area, find the first <code class="bold">When Green Flag clicked</code> script, as shown in <a id="figureanchor12-13" href="#figure12-13">Figure 12-13</a>.
<figure>
<img src="Images/f12013.png" alt="f12013"/>
<figcaption><p><a id="figure12-13" href="#figureanchor12-13">Figure 12-13:</a> Find the first, shorter green flag script in the Code Area. </p></figcaption>
</figure>
</li>
<li value="11">In the Toolbox, click <b>Avoid the monster</b> and drag the blocks with the names of your training buckets into the script as shown in <a id="figureanchor12-14" href="#figure12-14">Figure 12-14</a>. Make sure the directions match; for example, drag <code class="bold">go_left</code> into the <code class="bold">set left to</code> block.
<span epub:type="pagebreak" title="194" id="Page_194"/><figure>
<img src="Images/f12014.png" alt="f12014"/>
<figcaption><p><a id="figure12-14" href="#figureanchor12-14">Figure 12-14:</a> Add your project labels to the script. </p></figcaption>
</figure>
</li>
<li value="12">Scroll down in the Code Area to find the <code class="bold">define nano-decision</code> script, as shown in <a id="figureanchor12-15" href="#figure12-15">Figure 12-15</a>. 
<figure>
<img src="Images/f12015.png" alt="f12015"/>
<figcaption><p><a id="figure12-15" href="#figureanchor12-15">Figure 12-15:</a> Find the <code class="bold">define nano-decision</code> script. </p></figcaption>
</figure>
</li>
<li value="13">From the <b>Avoid the monster</b> group in the Toolbox, drag a new <code class="bold">add training data</code> block to the script, as shown in <a id="figureanchor12-16" href="#figure12-16">Figure 12-16</a>. This block will add every move that you make while playing the game to your training examples. 
<p class="ListBody"><span epub:type="pagebreak" title="195" id="Page_195"/>Click <b>Variables</b> in the Toolbox and drag the blocks shown in <a href="#figure12-16">Figure 12-16</a> into the <code class="bold">add training data</code> block. For each move, the coordinates for your character and the monster will be added, together with the decision you made, to your training examples.</p>
<figure>
<img src="Images/f12016.png" alt="f12016"/>
<figcaption><p><a id="figure12-16" href="#figureanchor12-16">Figure 12-16:</a> Update the <code class="bold">define nano-decision</code> script.</p></figcaption>
</figure>
</li>
<li value="14">Now you need to save your project so that you can return to it later. First, in the <b>Scratch Project</b> text box in the top menu bar, type <code class="bold">Avoid the monster TRAINING</code> as shown in <a id="figureanchor12-17" href="#figure12-17">Figure 12-17</a>. This tells you that this version of the project is where you play the game to train your ML model. 
<p class="ListBody">Then click <b>File</b><span class="MenuArrow">▶</span><b>Save to your computer</b>.</p>
<figure>
<img src="Images/f12017.png" alt="f12017"/>
<figcaption><p><a id="figure12-17" href="#figureanchor12-17">Figure 12-17:</a> Update the project name before saving this version. </p></figcaption>
</figure>
</li>
<li value="15"><span epub:type="pagebreak" title="196" id="Page_196"/>Play the game! 
<p class="ListBody">In the controls at the top right of the screen, click the full-screen icon and then click the Green Flag to start the game. Use the arrow keys to control the nano character like you did before.</p>
<p class="ListBody">Do your best to avoid the monster for as long as possible. The better you play, the better the ML model can learn.</p>
<p class="ListBody">When you think you’ve played for long enough, click the red Stop Sign.</p>
<p class="ListBody">You can see the moves that you’ve made if you go back to the Train phase, as shown in <a id="figureanchor12-18" href="#figure12-18">Figure 12-18</a>. You may need to refresh the page to see the latest examples.</p>
<figure>
<img src="Images/f12018.png" alt="f12018"/>
<figcaption><p><a id="figure12-18" href="#figureanchor12-18">Figure 12-18:</a> Moves that you made while playing should be displayed in your training buckets. </p></figcaption>
</figure>
</li>
<li value="16">Play a few more games until you think you’ve collected examples of all the situations nano could get into.</li>
<li value="17">It’s time to train an ML model using the examples you’ve collected. Click <b>Back to project</b> and then click <b>Learn &amp; Test</b>, as shown in <a id="figureanchor12-19" href="#figure12-19">Figure 12-19</a>.
<span epub:type="pagebreak" title="197" id="Page_197"/><figure>
<img src="Images/f12019.png" alt="f12019"/>
<figcaption><p><a id="figure12-19" href="#figureanchor12-19">Figure 12-19:</a> Click <b>Learn &amp; Test</b> to train a model using the moves you’ve collected. </p></figcaption>
</figure>
</li>
<li value="18">Click <b>Train new machine learning model</b>, as shown in <a id="figureanchor12-20" href="#figure12-20">Figure 12-20</a>.</li>
</ol>
<figure>
<img src="Images/f12020.png" alt="f12020"/>
<figcaption><p><a id="figure12-20" href="#figureanchor12-20">Figure 12-20:</a> Train a new ML model using your playing moves. </p></figcaption>
</figure>
<h3 id="h2-500563c12-0003">Test Your Game</h3>
<p class="BodyFirst">You’ve trained an ML model to play the game! The best way to test your model is to let the ML model take control of the nano character and see how long it can avoid the monster for. </p>
<p><span epub:type="pagebreak" title="198" id="Page_198"/>We’ll need to modify our Scratch project so that it can be controlled by the ML model, not the arrow keys.</p>
<ol>
<li value="1">Find the <code class="bold">when arrow key pressed</code> scripts in the Code Area. There are four of them, as shown in <a id="figureanchor12-21" href="#figure12-21">Figure 12-21</a>: <code class="bold">when left arrow key pressed</code>, <code class="bold">when right arrow key pressed</code>, <code class="bold">when up arrow key pressed</code>, and <code class="bold">when down arrow key pressed</code>. 
<p class="ListBody">Delete the scripts either by clicking each block and pressing the <span class="KeyCaps">delete</span> key or by right-clicking each block and choosing <b>Delete Block</b>. Be sure to delete every block in all four scripts so that you can’t take control of the character with any arrow key.</p>
<figure>
<img src="Images/f12021.png" alt="f12021"/>
<figcaption><p><a id="figure12-21" href="#figureanchor12-21">Figure 12-21:</a> Delete the four <code class="bold">when arrow key pressed</code> scripts so you can no longer control nano. </p></figcaption>
</figure>
</li>
<li value="2">Find the <code class="bold">define nano-decision</code> block that you updated before. Using blocks from the <b>Variables</b> and <b>Avoid the monster</b> groups in the Toolbox, update the script again so that it looks like <a id="figureanchor12-22" href="#figure12-22">Figure 12-22</a>.
<p class="ListBody">Instead of learning from your arrow keys, now you want the computer to make decisions using your ML model. </p>
<figure>
<img src="Images/f12022.png" alt="f12022"/>
<figcaption><p><a id="figure12-22" href="#figureanchor12-22">Figure 12-22:</a> Update the <code class="bold">define nano-decision</code> script so that your ML model is controlling the game. </p></figcaption>
</figure>
</li>
<li value="3"><span epub:type="pagebreak" title="199" id="Page_199"/>Find the longer <code class="bold">when Green Flag clicked</code> script and remove the <code class="bold">wait 1 second</code> block. 
<p class="ListBody">This will make the game run a little quicker so that you don’t have to wait for each move. The updated script will look like <a id="figureanchor12-23" href="#figure12-23">Figure 12-23</a>. (The arrow shows where the block was before I removed it.)</p>
<figure>
<img src="Images/f12023.png" alt="f12023"/>
<figcaption><p><a id="figure12-23" href="#figureanchor12-23">Figure 12-23:</a> Remove the <code class="bold">wait 1 second</code> block. </p></figcaption>
</figure>
</li>
<li value="4">Now you need to save your project again so that you can return to it later. This time, enter the name <code class="bold">Avoid the monster</code><code class="bold">TESTING</code> in the text box so you’ll know that this version of the project is where you let the ML model play. Then, click <b>File</b><span class="MenuArrow">▶</span><b>Save to your computer</b>. </li>
<li value="5">Click the full-screen icon and then click the Green Flag.
<p class="ListBody">Watch your ML model try to keep nano safe from the monster (<a id="figureanchor12-24" href="#figure12-24">Figure 12-24</a>)!</p>
</li>
</ol>
<span epub:type="pagebreak" title="200" id="Page_200"/><figure>
<img src="Images/f12024.png" alt="f12024"/>
<figcaption><p><a id="figure12-24" href="#figureanchor12-24">Figure 12-24:</a> Your ML project in action </p></figcaption>
</figure>
<h2 id="h1-500563c12-0002">Review and Improve Your Project</h2>
<p class="BodyFirst">How did your ML model do?</p>
<p>The longer it managed to avoid the monster, the better it did. If you’ve done really well, it’ll be able to avoid the monster forever. Because the monster moves at the same speed as nano, as long as your ML model doesn’t make any mistakes, it’s possible for nano to always stay ahead of the monster. </p>
<p>What difference does the amount of training make?</p>
<p>Try opening your <em>training</em> version of the Scratch project and add more training examples by playing the game for a little longer. Then, go back to the Learn &amp; Test phase and train a new ML model using your extra training examples. Finally, open your <em>testing</em> version of the Scratch project and watch the new ML model play the game. </p>
<p>Did the extra training help?</p>
<p><span epub:type="pagebreak" title="201" id="Page_201"/>Try doing this a few times to see how the amount of training affects how well your ML model plays. </p>
<p>The type of ML model you’ve trained in this project is called a <em>decision tree classifier</em><em/>, because the way the model makes decisions about its next moves can be drawn as a sort of tree, as shown in <a id="figureanchor12-25" href="#figure12-25">Figure 12-25</a>. To see a diagram of your ML model, in the Learn &amp; Test phase, click <b>Describe your model! </b>next to the Test button. </p>
<figure>
<img src="Images/f12025.png" alt="f12025"/>
<figcaption><p><a id="figure12-25" href="#figureanchor12-25">Figure 12-25:</a> A decision tree </p></figcaption>
</figure>
<p>The decision tree diagram can help you understand how your ML model is making <em>predictions</em> about the outcome of each move. </p>
<p>Each box on the tree describes a test; for example, monster x &lt; 3 means “is the x-coordinate of the monster less than 3?” If the test is true, the tree follows the left-hand arrow. If the test is not true, the tree follows the right-hand arrow. </p>
<p>The ML model starts at the top of the tree and follows the arrows identified by the tests until it reaches the bottom of the tree.</p>
<p>To see an example of the decision process, enter some coordinates for nano and the monster into the boxes to the right of your decision tree, and click <b>Test</b>. The diagram will highlight the way your ML model made a prediction for those coordinates. When there are no more arrows to follow and it reaches the bottom of the tree, you’ll find the final prediction, as shown in <a id="figureanchor12-26" href="#figure12-26">Figure 12-26</a>. </p>
<span epub:type="pagebreak" title="202" id="Page_202"/><figure>
<img src="Images/f12026.png" alt="f12026"/>
<figcaption><p><a id="figure12-26" href="#figureanchor12-26">Figure 12-26:</a> Highlighting the coordinates used to make a prediction about the outcome of a move</p></figcaption>
</figure>
<p>Test your model with a few different sets of coordinates to understand how it has learned to make predictions.</p>
<h2 id="h1-500563c12-0003">What You Learned</h2>
<p class="BodyFirst">In this chapter, you learned that ML models can be trained to recognize patterns in sets of numbers. You used a decision tree classifier to train a model to play a simplified version of the game <em>Pac-Man</em>, using sets of x- and y-coordinates to make decisions about its next moves based on their predicted outcome. </p>
<p>A decision tree is not the only way to train an ML model to make predictions based on numbers, but it’s a popular choice because it’s very quick to train and one of the easiest techniques to understand. In previous chapters, you’ve been using neural networks, which can be more powerful but are more complicated and harder to understand. </p>
<p>You’ve seen that, as with other ML models you’ve trained before, the model’s performance improves as you collect more training examples. In the next chapter, you’ll learn more about the difference the amount of training data makes on ML projects.</p>
</section>
</div></body></html>