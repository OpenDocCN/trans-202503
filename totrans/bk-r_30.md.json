["```\nR> palette()\n[1] \"black\"   \"red\"    \"green3\"  \"blue\"   \"cyan\"   \"magenta\"\n[7] \"yellow\"  \"gray\"\n```", "```\nR> col2rgb(c(\"black\",\"green3\",\"pink\"))\n      [,1] [,2] [,3]\nred      0    0  255\ngreen    0  205  192\nblue     0    0  203\n```", "```\nR> rgb(t(col2rgb(c(\"black\",\"green3\",\"pink\"))),maxColorValue=255)\n[1] \"#000000\" \"#00CD00\" \"#FFC0CB\"\n```", "```\npcol <- function(cols){\n        n <- length(cols)\n        dev.new(width=7,height=7)\n        par(mar=rep(1,4))\n        plot(1:5,1:5,type=\"n\",xaxt=\"n\",yaxt=\"n\",ann=FALSE)\n        for(i in 1:n){\n                pt <- locator(1)\n                rgbval <- col2rgb(cols[i])\n                points(pt,cex=4,pch=19,col=cols[i])\n                text(pt$x+1,pt$y,family=\"mono\",\n                     label=paste(\"\\\"\",cols[i],\"\\\"\",\"\\nR: \",rgbval[1],\n                                 \"  G: \",rgbval[2],\"  B: \",rgbval[3],\n                                 \"\\nhex: \",rgb(t(rgbval),maxColorValue=255),\n                                 sep=\"\"))\n        }\n}\n```", "```\nR> mycols <- c(\"black\",\"blue\",\"royalblue2\",\"pink\",\"magenta\",\"purple\",\n               \"violet\",\"coral\",\"lightgray\",\"seagreen4\",\"red\",\"red2\",\n               \"yellow\",\"lemonchiffon3\")\nR> pcol(mycols)\n```", "```\nR> N <- 600\nR> rbow <- rainbow(N)\nR> heat <- heat.colors(N)\nR> terr <- terrain.colors(N)\nR> topo <- topo.colors(N)\nR> cm <- cm.colors(N)\nR> gry1 <- gray.colors(N)\nR> gry2 <- gray(level=seq(0,1,length=N))\n```", "```\nR> dev.new(width=8,height=3)\nR> par(mar=c(1,8,1,1))\nR> plot(1,1,xlim=c(1,N),ylim=c(0.5,7.5),type=\"n\",xaxt=\"n\",yaxt=\"n\",ann=FALSE)\nR> points(rep(1:N,7),rep(7:1,each=N),pch=19,cex=3,\n          col=c(rbow,heat,terr,topo,cm,gry1,gry2))\nR> axis(2,at=7:1,labels=c(\"rainbow\",\"heat.colors\",\"terrain.colors\",\n                          \"topo.colors\",\"cm.colors\",\"gray.colors\",\"gray\"),\n        family=\"mono\",las=1)\n```", "```\nR> puryel.colors <- colorRampPalette(colors=c(\"purple\",\"yellow\"))\n```", "```\nR> blues <- colorRampPalette(colors=c(\"navyblue\",\"lightblue\"))\n```", "```\nR> fours <- colorRampPalette(colors=c(\"black\",\"hotpink\",\"seagreen4\",\"tomato\"))\nR> patriot.colors <- colorRampPalette(colors=c(\"red\",\"white\",\"blue\"))\n```", "```\nR> py <- puryel.colors(N)\nR> bls <- blues(N)\nR> frs <- fours(N)\nR> pat <- patriot.colors(N)\nR> dev.new(width=8,height=2)\nR> par(mar=c(1,8,1,1))\nR> plot(1,1,xlim=c(1,N),ylim=c(0.5,4.5),type=\"n\",xaxt=\"n\",yaxt=\"n\",ann=FALSE)\nR> points(rep(1:N,4),rep(4:1,each=N),pch=19,cex=3,col=c(py,bls,frs,pat))\nR> axis(2,at=4:1,labels=c(\"peryel.colors\",\"blues\",\"fours\",\"patriot.colors\"),\n        family=\"mono\",las=1)\n```", "```\nR> surv <- na.omit(survey[,c(\"Wr.Hnd\",\"NW.Hnd\",\"Height\")])\n```", "```\nR> NW.pal <- colorRampPalette(colors=c(\"red4\",\"yellow2\"))\n```", "```\nR> k <- 5\nR> ryc <- NW.pal(k)\nR> ryc\n[1] \"#8B0000\" \"#A33B00\" \"#BC7700\" \"#D5B200\" \"#EEEE00\"\n```", "```\nR> NW.breaks <- seq(min(surv$NW.Hnd),max(surv$NW.Hnd),length=k+1)\nR> NW.breaks\n[1] 12.5 14.7 16.9 19.1 21.3 23.5\n```", "```\nR> NW.fac <- cut(surv$NW.Hnd,breaks=NW.breaks,include.lowest=TRUE)\nR> as.numeric(NW.fac)\n  [1] 3 4 3 4 3 3 3 4 3 3 2 4 3 3 4 4 4 5 4 3 4 4 5 4 3 3 4 4 2 3 5\n [32] 3 2 3 4 1 3 5 5 3 3 5 4 3 4 5 3 2 3 4 5 3 4 3 3 4 3 3 3 4 2 3\n [63] 2 3 3 3 3 4 3 5 3 3 3   --snip-\nR> NW.cols <- ryc[as.numeric(NW.fac)]\nR> NW.cols\n  [1] \"#BC7700\" \"#D5B200\" \"#BC7700\" \"#D5B200\" \"#BC7700\" \"#BC7700\"\n  [7] \"#BC7700\" \"#D5B200\" \"#BC7700\" \"#BC7700\"   --snip--\n```", "```\nR> plot(surv$Wr.Hnd,surv$Height,col=NW.cols,pch=19)\n```", "```\nnormalize <- function(datavec){\n    lo <- min(datavec,na.rm=TRUE)\n    up <- max(datavec,na.rm=TRUE)\n    datanorm <- (datavec-lo)/(up-lo)\n    return(datanorm)\n}\n```", "```\nR> surv$NW.Hnd\n  [1] 18.0 20.5 18.9 20.0 17.7 17.7 17.3 19.5 18.5 17.2 16.0 20.2\n [13] 17.0 18.0 19.2 20.5 20.9 22.0 20.7    --snip-\nR> normalize(surv$NW.Hnd)\n  [1] 0.50000000 0.72727273 0.58181818 0.68181818 0.47272727\n  [6] 0.47272727 0.43636364 0.63636364     --snip--\n```", "```\nR> NW.pal2 <- colorRamp(colors=c(\"red4\",\"yellow2\"))\n```", "```\nR> ryc2 <- NW.pal2(normalize(surv$NW.Hnd))\n```", "```\nR> NW.cols2 <- rgb(ryc2,maxColorValue=255)\nR> NW.cols2\n  [1] \"#BC7700\" \"#D3AD00\" \"#C48A00\" \"#CEA200\" \"#B97000\" \"#B97000\"\n  [7] \"#B66700\" \"#CA9700\" \"#C18100\" \"#B56500\"   --snip--\n```", "```\nR> plot(surv$Wr.Hnd,surv$Height,col=NW.cols2,pch=19)\n```", "```\nR> library(\"shape\")\nR> plot(surv$Wr.Hnd,surv$Height,col=NW.cols2,pch=19,\n        xlab=\"Writing handspan (cm)\",ylab=\"Height (cm)\")\nR> colorlegend(NW.pal(200),zlim=range(surv$NW.Hnd),zval=seq(13,23,by=2),\n               posx=c(0.3,0.33),posy=c(0.5,0.9),main=\"Nonwriting handspan\")\n```", "```\nR> par(mar=c(5,4,4,6))\nR> plot(surv$Wr.Hnd,surv$Height,col=NW.cols2,pch=19,\n        xlab=\"Writing handspan (cm)\",ylab=\"Height (cm)\")\nR> colorlegend(NW.pal(200),zlim=range(surv$NW.Hnd),zval=13.5:22.5,digit=1,\n               posx=c(0.89,0.91),main=\"Nonwriting\\nhandspan\")\n```", "```\nR> rgb(cbind(255,0,0),maxColorValue=255)\n[1] \"#FF0000\"\nR> rgb(cbind(255,0,0),maxColorValue=255,alpha=0)\n[1] \"#FF000000\"\nR> rgb(cbind(255,0,0),maxColorValue=255,alpha=102)\n[1] \"#FF000066\"\nR> rgb(cbind(255,0,0),maxColorValue=255,alpha=255)\n[1] \"#FF0000FF\"\n```", "```\nR> adjustcolor(rgb(cbind(255,0,0),maxColorValue=255),alpha.f=0.4)\n[1] \"#FF000066\"\n```", "```\nR> keycols <- c(\"blue\",\"red\",\"yellow\")\nR> depth.pal <- colorRampPalette(keycols)\nR> depth.pal2 <- colorRamp(keycols)\n```", "```\nR> depth.cols <- rgb(depth.pal2(normalize(quakes$depth)),maxColorValue=255,\n                     alpha=0.6*255)\n```", "```\nR> plot(quakes$mag,quakes$stations,pch=19,cex=2,col=depth.cols,\n        xlab=\"Magnitude\",ylab=\"No. of stations\")\n```", "```\nR> colorlegend(adjustcolor(depth.pal(20),alpha.f=0.6),\n               zlim=range(quakes$depth),zval=seq(100,600,100),\n               posx=c(0.3,0.32),posy=c(0.5,0.9),left=TRUE,main=\"Depth\")\n```", "```\nR> pwid <- iris$Petal.Width\nR> plen <- iris$Petal.Length\nR> swid <- iris$Sepal.Width\nR> slen <- iris$Sepal.Length\n```", "```\nR> library(\"scatterplot3d\")\nR> scatterplot3d(x=pwid,y=plen,z=swid)\n```", "```\nR> scatterplot3d(x=pwid,y=plen,z=swid,highlight.3d=TRUE,type=\"h\",\n                 lty.hplot=2,lty.hide=3,xlab=\"Petal width\",\n                 ylab=\"Petal length\",zlab=\"Sepal width\",\n                 main=\"Iris Flower Measurements\")\n```", "```\nR> keycols <- c(\"purple\",\"yellow2\",\"blue\")\nR> slen.pal <- colorRampPalette(keycols)\nR> slen.pal2 <- colorRamp(keycols)\nR> slen.cols <- rgb(slen.pal2(normalize(slen)),maxColorValue=255)\n```", "```\nR> scatterplot3d(x=pwid,y=plen,z=swid,color=slen.cols,\n                 pch=c(19,17,15)[as.numeric(iris$Species)],type=\"h\",\n                 lty.hplot=2,lty.hide=3,xlab=\"Petal width\",\n                 ylab=\"Petal length\",zlab=\"Sepal width\",\n                 main=\"Iris Flower Measurements\")\n```", "```\nR> legend(\"bottomright\",legend=levels(iris$Species),pch=c(19,17,15))\n```", "```\nR> colorlegend(slen.pal(200),zlim=range(slen),zval=5:7,digit=1,\n               posx=c(0.1,0.13),posy=c(0.7,0.9),left=TRUE,\n               main=\"Sepal length\")\n```", "```\nR> xcoords <- 1:6\nR> xcoords\n[1] 1 2 3 4 5 6\nR> ycoords <- 1:4\nR> ycoords\n[1] 1 2 3 4\n```", "```\nR> xycoords <- expand.grid(x=xcoords,y=ycoords)\n```", "```\nR> z <- letters[1:24]\nR> cbind(xycoords,z)\n  x y z\n1 1 1 a\n2 2 1 b\n3 3 1 c\n4 4 1 d\n\n--snip--\n\n21 3 4 u\n22 4 4 v\n23 5 4 w\n24 6 4 x\n```", "```\nR> nx <- length(xcoords)\nR> ny <- length(ycoords)\nR> zmat <- matrix(z,nrow=nx,ncol=ny)\nR> zmat\n     [,1] [,2] [,3] [,4]\n[1,] \"a\"  \"g\"  \"m\"  \"s\"\n[2,] \"b\"  \"h\"  \"n\"  \"t\"\n[3,] \"c\"  \"i\"  \"o\"  \"u\"\n[4,] \"d\"  \"j\"  \"p\"  \"v\"\n[5,] \"e\"  \"k\"  \"q\"  \"w\"\n[6,] \"f\"  \"l\"  \"r\"  \"x\"\n```", "```\nR> dim(volcano)\n[1] 87 61\nR> contour(x=1:nrow(volcano),y=1:ncol(volcano),z=volcano,asp=1)\n```", "```\nR> car.fit <- lm(mpg~hp*wt,data=mtcars)\nR> car.fit\n\nCall:\nlm(formula = mpg ~ hp * wt, data = mtcars)\n\nCoefficients:\n(Intercept)           hp            wt       hp:wt\n   49.80842     -0.12010      -8.21662     0.02785\n```", "```\nR> len <- 20\nR> hp.seq <- seq(min(mtcars$hp),max(mtcars$hp),length=len)\nR> wt.seq <- seq(min(mtcars$wt),max(mtcars$wt),length=len)\nR> hp.wt <- expand.grid(hp=hp.seq,wt=wt.seq)\nR> nrow(hp.wt)\n[1] 400\nR> hp.wt[1:5,]\n         hp    wt\n1  52.00000 1.513\n2  66.89474 1.513\n3  81.78947 1.513\n4  96.68421 1.513\n5 111.57895 1.513\n```", "```\nR> car.pred <- predict(car.fit,newdata=hp.wt)\n```", "```\nR> car.pred.mat <- matrix(car.pred,nrow=len,ncol=len)\n```", "```\nR> contour(x=hp.seq,y=wt.seq,z=car.pred.mat,levels=32:8,lty=2,lwd=1.5,\n           xaxs=\"i\",yaxs=\"i\",xlab=\"Horsepower\",ylab=\"Weight\",\n           main=\"Mean MPG model\")\n```", "```\nR> quak.dens <- kde2d(x=quakes$long,y=quakes$lat,n=100)\n```", "```\nR> dim(quak.dens$z)\n[1] 100 100\n```", "```\nR> contour(quak.dens$x,quak.dens$y,quak.dens$z)\n```", "```\nR> contour(quak.dens$x,quak.dens$y,quak.dens$z,nlevels=50,drawlabels=FALSE,\n           xaxs=\"i\",yaxs=\"i\",xlab=\"Longitude\",ylab=\"Latitude\")\nR> points(quakes$long,quakes$lat,cex=0.7)\n```", "```\nR> plot(quakes$long,quakes$lat,cex=0.5,col=\"gray\",xaxs=\"i\",yaxs=\"i\",\n        xlab=\"Longitude\",ylab=\"Latitude\")\n```", "```\nR> quak.levs <- c(0.001,0.005,0.01,0.015)\n```", "```\nR> contour(quak.dens$x,quak.dens$y,quak.dens$z,add=TRUE,levels=quak.levs,\n           drawlabels=FALSE,lty=4:1,lwd=2)\n```", "```\nR> legend(\"bottomleft\",legend=quak.levs,lty=4:1,lwd=2,\n          title=\"Kernel estimate (contours)\")\n```", "```\nR> filled.contour(x=hp.seq,y=wt.seq,z=car.pred.mat,\n           color.palette=colorRampPalette(c(\"white\",\"red4\")),\n           xlab=\"Horsepower\",ylab=\"Weight\",\n           key.title=title(main=\"Mean MPG\",cex.main=0.8))\n```", "```\nR> filled.contour(x=quak.dens$x,y=quak.dens$y,z=quak.dens$z,\n                  color.palette=topo.colors,nlevels=30,xlab=\"Longitude\",\n                  ylab=\"Latitude\",key.title=title(main=\"KDE\",cex.main=0.8),\n                  plot.axes={axis(1);axis(2);\n                             points(quakes$long,quakes$lat,cex=0.5,\n                                    col=adjustcolor(\"black\",alpha=0.3))})\n```", "```\nR> image(x=1:nrow(volcano),y=1:ncol(volcano),z=volcano,asp=1)\n```", "```\nR> car.fit <- lm(mpg~hp*wt,data=mtcars)\nR> len <- 20\nR> hp.seq <- seq(min(mtcars$hp),max(mtcars$hp),length=len)\nR> wt.seq <- seq(min(mtcars$wt),max(mtcars$wt),length=len)\nR> hp.wt <- expand.grid(hp=hp.seq,wt=wt.seq)\nR> car.pred.mat <- matrix(predict(car.fit,newdata=hp.wt),nrow=len,ncol=len)\n```", "```\nR> blues <- colorRampPalette(c(\"cyan\",\"navyblue\"))\nR> par(mar=c(5,4,4,5))\nR> image(hp.seq,wt.seq,car.pred.mat,col=blues(10),\n         xlab=\"Horsepower\",ylab=\"Weight\")\nR> colorlegend(col=blues(10),zlim=range(car.pred.mat),zval=seq(10,30,5),\n               main=\"Mean\\nMPG\")\n```", "```\nR> car.fit <- lm(mpg~hp*wt,data=mtcars)\nR> len <- 50\nR> hp.seq <- seq(min(mtcars$hp),max(mtcars$hp),length=len)\nR> wt.seq <- seq(min(mtcars$wt),max(mtcars$wt),length=len)\nR> hp.wt <- expand.grid(hp=hp.seq,wt=wt.seq)\nR> car.pred.mat <- matrix(predict(car.fit,newdata=hp.wt),nrow=len,ncol=len)\n```", "```\nR> par(mar=c(5,4,4,5))\nR> image(hp.seq,wt.seq,car.pred.mat,col=blues(100),\n         xlab=\"Horsepower\",ylab=\"Weight\")\nR> contour(hp.seq,wt.seq,car.pred.mat,add=TRUE,lty=2)\nR> colorlegend(col=blues(100),zlim=range(car.pred.mat),zval=seq(10,30,5),\n               main=\"Mean\\nMPG\")\n```", "```\nR> plot(chorley$x,chorley$y,xlab=\"Eastings (km)\",ylab=\"Northings (km)\")\n```", "```\nR> chor.dens <- kde2d(x=chorley$x,y=chorley$y,n=256)\n```", "```\nR> rbow <- rainbow(200,start=0,end=5/6)\n```", "```\nR> image(x=chor.dens$x,y=chor.dens$y,z=chor.dens$z,col=rbow)\n```", "```\nR> plot(chorley$window,add=TRUE)\n```", "```\nR> chor.WIN <- chorley$window\nR> range(chorley$x)\n[1] 346.6 364.1\nR> WIN.xr <- chor.WIN$xrange\nR> WIN.xr\n[1] 343.45 366.45\nR> range(chorley$y)\n[1] 412.6 430.3\nR> WIN.yr <- chor.WIN$yrange\nR> WIN.yr\n[1] 410.41 431.79\n```", "```\nR> image(chor.dens$x,chor.dens$y,chor.dens$z,col=rbow,\n         xlim=WIN.xr,ylim=WIN.yr)\nR> plot(chor.WIN,add=TRUE)\n```", "```\nR> chor.dens.WIN <- kde2d(chorley$x,chorley$y,n=256,lims=c(WIN.xr,WIN.yr))\nR> image(chor.dens.WIN$x,chor.dens.WIN$y,chor.dens.WIN$z,col=rbow)\nR> plot(chor.WIN,add=TRUE)\n```", "```\nR> inside.owin(x=c(355,345),y=c(420,415),w=chor.WIN)\n[1]  TRUE FALSE\n```", "```\nR> chor.xy <- expand.grid(chor.dens.WIN$x,chor.dens.WIN$y)\nR> nrow(chor.xy)\n[1] 65536\n```", "```\nR> chor.outside <- !inside.owin(x=chor.xy[,1],y=chor.xy[,2],w=chor.WIN)\n```", "```\nR> chor.out.mat <- matrix(chor.outside,nrow=256,ncol=256)\nR> chor.dens.WIN$z[chor.out.mat] <- NA\n```", "```\nR> dev.new(width=7.5,height=7)\nR> par(mar=c(5,4,4,7))\nR> image(chor.dens.WIN$x,chor.dens.WIN$y,chor.dens.WIN$z,col=rbow,\n         xlab=\"Eastings\",ylab=\"Northings\",bty=\"l\",asp=1)\nR> plot(chor.WIN,lwd=2,add=TRUE)\nR> colorlegend(col=rbow,zlim=range(chor.dens.WIN$z,na.rm=TRUE),\n               zval=seq(0,0.02,0.0025),main=\"KDE\",digit=4,posx=c(0.85,0.87))\n```", "```\nR> car.fit <- lm(mpg~hp*wt,data=mtcars)\nR> len <- 20\nR> hp.seq <- seq(min(mtcars$hp),max(mtcars$hp),length=len)\nR> wt.seq <- seq(min(mtcars$wt),max(mtcars$wt),length=len)\nR> hp.wt <- expand.grid(hp=hp.seq,wt=wt.seq)\nR> car.pred.mat <- matrix(predict(car.fit,newdata=hp.wt),nrow=len,ncol=len)\n```", "```\nR> persp(x=hp.seq,y=wt.seq,z=car.pred.mat)\n```", "```\nR> persp(x=hp.seq,y=wt.seq,z=car.pred.mat,theta=-30,phi=23,\n         xlab=\"Horsepower\",ylab=\"Weight\",zlab=\"mean MPG\")\n```", "```\nR> persp(x=hp.seq,y=wt.seq,z=car.pred.mat,theta=40,phi=30,ticktype=\"detailed\",\n         xlab=\"Horsepower\",ylab=\"Weight\",zlab=\"mean MPG\")\n```", "```\nR> persp(x=hp.seq,y=wt.seq,z=car.pred.mat,theta=40,phi=30,ticktype=\"detailed\",\n         shade=0.6,border=NA,expand=0.8,\n         xlab=\"Horsepower\",ylab=\"Weight\",zlab=\"mean MPG\")\n```", "```\nR> chor.WIN <- chorley$window\nR> chor.dens.WIN <- kde2d(chorley$x,chorley$y,n=256,\n                          lims=c(chor.WIN$xrange,chor.WIN$yrange))\nR> chor.xy <- expand.grid(chor.dens.WIN$x,chor.dens.WIN$y)\nR> chor.out.mat <- matrix(!inside.owin(x=chor.xy[,1],y=chor.xy[,2],w=chor.WIN),\n                          256,256)\nR> chor.dens.WIN$z[chor.out.mat] <- NA\n```", "```\nR> zm <- chor.dens.WIN$z\nR> nr <- nrow(zm)\nR> nc <- ncol(zm)\nR> zf <- (zm[-1,-1]+zm[-1,-nc]+zm[-nr,-1]+zm[-nr,-nc])/4\nR> dim(zf)\n[1] 255 255\n```", "```\nR> rbow <- rainbow(200,start=0,end=5/6)\nR> zf.breaks <- seq(min(zf,na.rm=TRUE),max(zf,na.rm=TRUE),length=201)\nR> zf.colors <- cut(zf,breaks=zf.breaks,include.lowest=TRUE)\n```", "```\nR> par(mar=c(0,1,0,7))\nR> persp(chor.dens.WIN$x,chor.dens.WIN$y,chor.dens.WIN$z,border=NA,\n         col=rbow[zf.colors],theta=-30,phi=30,scale=FALSE,expand=750,\n         xlab=\"Eastings (km)\",ylab=\"Northings (km)\",zlab=\"Kernel estimate\")\nR> colorlegend(col=rbow,zlim=range(chor.dens.WIN$z,na.rm=TRUE),\n               zval=seq(0,0.02,0.0025),main=\"KDE\",digit=4,\n               posx=c(0.85,0.87),posy=c(0.2,0.8))\n```", "```\npersprot <- function(skip=1,...){\n    for(i in seq(90,20,by=-skip)){\n        persp(phi=i,theta=0,...)\n    }\n    for(i in seq(0,360,by=skip)){\n        persp(phi=20,theta=i,...)\n    }\n}\n```", "```\nR> quak.dens <- kde2d(x=quakes$long,y=quakes$lat,n=50)\n```", "```\nR> persprot(x=quak.dens$x,y=quak.dens$y,z=quak.dens$z,border=\"red3\",shade=0.4,\n            ticktype=\"detailed\",xlab=\"Longitude\",ylab=\"Latitude\",\n            zlab=\"Kernel estimate\")\n```"]