<html><head></head><body>
<div id="book-content">
<div id="sbo-rt-content"><h2 class="h2" id="ch15"><span epub:type="pagebreak" id="page_93"/><strong><span class="big">15</span><br/>DATA AUGMENTATION FOR TEXT</strong></h2>&#13;
<div class="image1"><img src="../images/common.jpg" alt="Image" width="252" height="252"/></div>&#13;
<p class="noindent">How is data augmentation useful, and what are the most common augmentation techniques for text data?</p>&#13;
<p class="indent">Data augmentation is useful for artificially increasing dataset sizes to improve model performance, such as by reducing the degree of overfitting, as discussed in <a href="ch05.xhtml">Chapter 5</a>. This includes techniques often used in computer vision models, like rotation, scaling, and flipping.</p>&#13;
<p class="indent">Similarly, there are several techniques for augmenting text data. The most common include synonym replacement, word deletion, word position swapping, sentence shuffling, noise injection, back translation, and text generated by LLMs. This chapter discusses each of these, with optional code examples in the <em>supplementary/q15-text-augment</em> subfolder at <em><a href="https://github.com/rasbt/MachineLearning-QandAI-book">https://github.com/rasbt/MachineLearning-QandAI-book</a></em>.</p>&#13;
<h3 class="h3" id="ch00lev70"><strong>Synonym Replacement</strong></h3>&#13;
<p class="noindent">In <em>synonym replacement</em>, we randomly choose words in a sentence—often nouns, verbs, adjectives, and adverbs—and replace them with synonyms. For example, we might begin with the sentence “The cat quickly jumped over the lazy dog,” and then augment the sentence as follows: “The cat rapidly jumped over the idle dog.”</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_94"/>Synonym replacement can help the model learn that different words can have similar meanings, thereby improving its ability to understand and generate text. In practice, synonym replacement often relies on a thesaurus such as WordNet. However, using this technique requires care, as not all synonyms are interchangeable in all contexts. Most automatic text replacement tools have settings for adjusting replacement frequency and similarity thresholds. However, automatic synonym replacement is not perfect, and you might want to apply post-processing checks to filter out replacements that might not make sense.</p>&#13;
<h3 class="h3" id="ch00lev71"><strong>Word Deletion</strong></h3>&#13;
<p class="noindent"><em>Word deletion</em> is another data augmentation technique to help models learn. Unlike synonym replacement, which alters the text by substituting words with their synonyms, word deletion involves removing certain words from the text to create new variants while trying to maintain the overall meaning of the sentence. For example, we might begin with the sentence “The cat quickly jumped over the lazy dog” and then remove the word <em>quickly</em>: “The cat jumped over the lazy dog.”</p>&#13;
<p class="indent">By randomly deleting words in the training data, we teach the model to make accurate predictions even when some information is missing. This can make the model more robust when encountering incomplete or noisy data in real-world scenarios. Also, by deleting nonessential words, we may teach the model to focus on key aspects of the text that are most relevant to the task at hand.</p>&#13;
<p class="indent">However, we must be careful not to remove critical words that may significantly alter a sentence’s meaning. For example, it would be suboptimal to remove the word <em>cat</em> in the previous sentence: “The quickly jumped over the lazy dog.” We must also choose the deletion rate carefully to ensure that the text still makes sense after words have been removed. Typical deletion rates might range from 10 percent to 20 percent, but this is a general guideline and could vary significantly based on the specific use case.</p>&#13;
<h3 class="h3" id="ch00lev72"><strong>Word Position Swapping</strong></h3>&#13;
<p class="noindent">In <em>word position swapping</em>, also known as <em>word shuffling</em> or <em>permutation</em>, the positions of words in a sentence are swapped or rearranged to create new versions of the sentence. If we begin with “The cat quickly jumped over the lazy dog,” we might swap the positions of some words to get the following: “Quickly the cat jumped the over lazy dog.”</p>&#13;
<p class="indent">While these sentences may sound grammatically incorrect or strange in English, they provide valuable training information for data augmentation because the model can still recognize the important words and their associations with each other. However, this method has its limitations. For example, shuffling words too much or in certain ways can drastically change <span epub:type="pagebreak" id="page_95"/>the meaning of a sentence or make it completely nonsensical. Moreover, word shuffling may interfere with the model’s learning process, as the positional relationships between certain words can be vital in these contexts.</p>&#13;
<h3 class="h3" id="ch00lev73"><strong>Sentence Shuffling</strong></h3>&#13;
<p class="noindent">In <em>sentence shuffling</em>, entire sentences within a paragraph or a document are rearranged to create new versions of the input text. By shuffling sentences within a document, we expose the model to different arrangements of the same content, helping it learn to recognize thematic elements and key concepts rather than relying on specific sentence order. This promotes a more robust understanding of the document’s overall topic or category. Consequently, this technique is particularly useful for tasks that deal with document-level analysis or paragraph-level understanding, such as document classification, topic modeling, or text summarization.</p>&#13;
<p class="indent">In contrast to the aforementioned word-based methods (word position swapping, word deletion, and synonym replacement), sentence shuffling maintains the internal structure of individual sentences. This avoids the problem of altering word choice or order such that sentences become grammatically incorrect or change meaning entirely.</p>&#13;
<p class="indent">Sentence shuffling is useful when the order of sentences is not crucial to the overall meaning of the text. Still, it may not work well if the sentences are logically or chronologically connected. For example, consider the following paragraph: “I went to the supermarket. Then I bought ingredients to make pizza. Afterward, I made some delicious pizza.” Reshuffling these sentences as follows disrupts the logical and temporal progression of the narrative: “Afterward, I made some delicious pizza. Then I bought ingredients to make pizza. I went to the supermarket.”</p>&#13;
<h3 class="h3" id="ch00lev74"><strong>Noise Injection</strong></h3>&#13;
<p class="noindent"><em>Noise injection</em> is an umbrella term for techniques used to alter text in various ways and create variation in the texts. It may refer either to the methods described in the previous sections or to character-level techniques such as inserting random letters, characters, or typos, as shown in the following examples:</p>&#13;
<p class="noindentin"><strong>Random character insertion</strong>     “The cat qzuickly jumped over the lazy dog.” (Inserted a <em>z</em> in the word <em>quickly</em>.)</p>&#13;
<p class="noindentin"><strong>Random character deletion</strong>     “The cat quickl jumped over the lazy dog.” (Deleted <em>y</em> from the word <em>quickly</em>.)</p>&#13;
<p class="noindentin"><strong>Typo introduction</strong>     “The cat qickuly jumped over the lazy dog.” (Introduced a typo in <em>quickly</em>, changing it to <em>qickuly</em>.)<span epub:type="pagebreak" id="page_96"/></p>&#13;
<p class="indenta">These modifications are beneficial for tasks that involve spell-checking and text correction, but they can also help make the model more robust to imperfect inputs.</p>&#13;
<h3 class="h3" id="ch00lev75"><strong>Back Translation</strong></h3>&#13;
<p class="noindent"><em>Back translation</em> is one of the most widely used techniques to create variation in texts. Here, a sentence is first translated from the original language into one or more different languages, and then it is translated back into the original language. Translating back and forth often results in sentences that are semantically similar to the original sentence but have slight variations in structure, vocabulary, or grammar. This generates additional, diverse examples for training without altering the overall meaning.</p>&#13;
<p class="indent">For example, say we translate “The cat quickly jumped over the lazy dog” into German. We might get “Die Katze sprang schnell über den faulen Hund.” We could then translate this German sentence back into English to get “The cat jumped quickly over the lazy dog.”</p>&#13;
<p class="indent">The degree to which a sentence changes through back translation depends on the languages used and the specifics of the machine translation model. In this example, the sentence remains very similar. However, in other cases or with other languages, you might see more significant changes in wording or sentence structure while maintaining the same overall meaning.</p>&#13;
<p class="indent">This method requires access to reliable machine translation models or services, and care must be taken to ensure that the back-translated sentences retain the essential meaning of the original sentences.</p>&#13;
<h3 class="h3" id="ch00lev76"><strong>Synthetic Data</strong></h3>&#13;
<p class="noindent"><em>Synthetic data generation</em> is an umbrella term that describes methods and techniques used to create artificial data that mimics or replicates the structure of real-world data. All methods discussed in this chapter can be considered synthetic data generation techniques since they generate new data by making small changes to existing data, thus maintaining the overall meaning while creating something new.</p>&#13;
<p class="indent">Modern techniques to generate synthetic data now also include using decoder-style LLMs such as GPT (decoder-style LLMs are discussed in more detail in <a href="ch17.xhtml">Chapter 17</a>). We can use these models to generate new data from scratch by using “complete the sentence” or “generate example sentences” prompts, among others. We can also use LLMs as alternatives to back translation, prompting them to rewrite sentences as shown in <a href="ch15.xhtml#ch15fig1">Figure 15-1</a>.<span epub:type="pagebreak" id="page_97"/></p>&#13;
<div class="image"><img id="ch15fig1" src="../images/15fig01.jpg" alt="Image" width="760" height="416"/></div>&#13;
<p class="figcap"><em>Figure 15-1: Using an LLM to rewrite a sentence</em></p>&#13;
<p class="indent">Note that an LLM, as shown in <a href="ch15.xhtml#ch15fig1">Figure 15-1</a>, runs in a nondeterministic mode by default, which means we can prompt it multiple times to obtain a variety of rewritten sentences.</p>&#13;
<h3 class="h3" id="ch00lev77"><strong>Recommendations</strong></h3>&#13;
<p class="noindent">The data augmentation techniques discussed in this chapter are commonly used in text classification, sentiment analysis, and other NLP tasks where the amount of available labeled data might be limited.</p>&#13;
<p class="indent">LLMs are usually pretrained on such a vast and diverse dataset that they may not rely on these augmentation techniques as extensively as in other, more specific NLP tasks. This is because LLMs aim to capture the statistical properties of the language, and the vast amount of data on which they are trained often provides a sufficient variety of contexts and expressions. However, in the fine-tuning stages of LLMs, where a pretrained model is adapted to a specific task with a smaller, task-specific dataset, data augmentation techniques might become more relevant again, mainly if the task-specific labeled dataset size is limited.</p>&#13;
<h3 class="h3" id="ch00lev78"><strong>Exercises</strong></h3>&#13;
<p class="number1"><strong>15-1.</strong> Can the use of text data augmentation help with privacy concerns?</p>&#13;
<p class="number1"><strong>15-2.</strong> What are some instances where data augmentation may not be beneficial for a specific task?</p>&#13;
<h3 class="h3" id="ch00lev79"><strong>References</strong></h3>&#13;
<ul>&#13;
<li class="noindent">The WordNet thesaurus: George A. Miller, “WordNet: A Lexical Database for English” (1995), <em><a href="https://dl.acm.org/doi/10.1145/219717.219748">https://dl.acm.org/doi/10.1145/219717.219748</a></em>.<span epub:type="pagebreak" id="page_98"/></li>&#13;
</ul>&#13;
</div>
</div>
</body></html>