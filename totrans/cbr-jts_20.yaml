- en: '20'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Light, Noise, and Litter Discipline
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
- en: The traditions of the ancient shinobi say you should lock the doors before you
    have a look at the enemy with fire.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: If you have to steal in as a shinobi when it is snowing, the first thing you
    must be careful about is your footsteps.
  id: totrans-3
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  id: totrans-4
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '—Yoshimori Hyakushu #53'
  id: totrans-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Avoiding unwanted attention was a core discipline of their trade, and shinobi
    trained diligently on being stealthy. If lanterns emitted light that disturbed
    animals, footsteps echoed and woke a sleeping target, or food waste alerted a
    guard to the presence of an intruder, then a shinobi put their mission—if not
    their life—in jeopardy. As such, the scrollsprovide substantial guidance around
    moving and operating tactically while maintaining light, noise, and litter discipline.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
- en: Light discipline includes general tactics. For example, the scrolls recommend
    that infiltrating shinobi lock a door from the inside before igniting a torch
    to prevent the light (and any people in the room) from escaping.^([1](b01.xhtml#endnote-135))
    It also includes specific techniques. *Bansenshūkai* details a number of clever
    tools for light management, such asthe *torinoko* fire egg. This is a bundle of
    special flammable material with an ember at the center, compressed to the shape
    and size of an egg. The egg rests in the shinobi’s palm such that opening or closing
    the hand controls the amount of oxygen that reaches the ember, brightening or
    dimming the light and allowing the carrier to direct the light in specific, narrow
    directions.^([2](b01.xhtml#endnote-136)) With this tool, a shinobi could quickly
    open their hand to see who was sleeping inside a room, then instantly extinguish
    the light by making a tight fist. Thus, the fire egg has the same on-demand directional
    and on/off light control as a modern tactical flashlight.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
- en: Silence was critical for shinobi, and the scrolls describe an array of techniques
    to remain quiet while infiltrating a target. The *Ninpiden* suggests biting down
    on a strip of paper to dampen the sound of breathing. Similarly, some shinobi
    moved through close quarters by grabbing the soles of their feet with the palms
    of their hands, then walking on their hands to mute the sound of footsteps. This
    technique must have required considerable practice and conditioning to execute
    successfully. It was also common for shinobi to carry oil or other viscous substances
    to grease creaky gate hinges or wooden sliding doors—anything that might squeak
    and alert people to their presence. The scrolls also warn against applying these
    liquids too liberally, as they could visibly pool, tipping off a guard to the
    fact that someone had trespassed.^([3](b01.xhtml#endnote-137))
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
- en: 'Not all shinobi noise discipline techniques minimized noise. The scrolls also
    provide guidance for creating a purposeful ruckus. *Shōninki* describes a noise
    discipline technique called *kutsukae*, or “changing your footwear,” which actually
    involves varying your footsteps rather than putting on different shoes. An infiltrating
    shinobi can shuffle, skip, fake a limp, take choppy steps, or make audible but
    distinct footstep noises to deceive anyone listening. Then, when they change to
    their natural gait, listeners assume they’re hearing a different person or erroneously
    believe that the person they’re tracking suddenly stopped.^([4](b01.xhtml#endnote-138))
    The *Ninpiden* describes clapping wooden blocks together or yelling “Thief!” or
    “Help!” to simulate an alarm, testing the guards’ reaction to noise.^([5](b01.xhtml#endnote-139))
    *Bansenshūkai* describes a more controlled noise test, in which a shinobi near
    a target or guard whispers progressively more loudly to determine the target’s
    noise detection threshold. Noise tests help shinobi make specific observations
    about how the target responds, including:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
- en: How quickly did the target react?
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Was there debate between guards about hearing a noise?
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Did guards emerge quickly and alertly, with weapons in hand?
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Did the noise seem to catch the target off guard?
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Was the target completely oblivious?
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: These observations not only tell the shinobi how keen the target’s awareness
    and hearing are but also reveal the target’s skill and preparation in responding
    to events—information the shinobi can use to tailor the infiltration.^([6](b01.xhtml#endnote-140))
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
- en: In terms of physical evidence, shinobi used “leave no trace” long before it
    was an environmental mantra. A tool called *nagabukuro* (or “long bag”) helps
    with both sound and litter containment. When shinobi scaled a high wall and needed
    to cut a hole to crawl through, they hung the large, thick, leather *nagabukuro*
    bag lined with fur or felt beneath them to catch debris falling from the wall
    and muffle the sound. The shinobi could then lower the scraps quietly to a discreet
    place on the ground below. This was much better option than letting debris crash
    to the ground or splash into a moat.^([7](b01.xhtml#endnote-141))
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we abstract the light, noise, and litter of shinobi infiltrators
    into their cyber threat equivalents. We will review some tools and techniques
    that threat groups have used to minimize the evidence they leave behind, as well
    as some procedural tradecraft disciplines. We’ll discuss the topic of detecting
    “low and slow” threats, along with modifying your environment so it works to your
    advantage. The thought exercise will look at a technique used by shinobi to mask
    their footsteps that could in theory be applied to modern digital systems. At
    the end of the chapter, we’ll cover detection discipline as a way to counter a
    sophisticated adversary—one who is mindful of the observables they may leave (or
    not leave) in your network.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
- en: Cyber Light, Noise, and Litter
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The digital world does not always behave in the same ways as the physical world.
    It can be challenging to understand and continuously hunt for the cyber equivalents
    of light, noise, and litter. Because defenders lack the time, resources, and capability
    to monitor and hunt within digital systems under their control, an adversary’s
    light, noise, and/or litter trail too often goes undocumented. As a result, threat
    actors may have an easier time performing cyber infiltration than physical infiltration.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
- en: Many scanning and exploitation tools and frameworks, such as Nmap,^([8](b01.xhtml#endnote-142))
    have throttling modes or other “low-and-slow” methods that attempt to exercise
    discipline on the size of packets or payloads, packet frequency, and bandwidth
    usage on a target network. Adversaries have developed extremely small malicious
    files (for instance, the China Chopper can be less than 4KB^([9](b01.xhtml#endnote-143)))
    that exploit defenders’ assumption that a file with such a slight footprint won’t
    cause harm. Malware can be configured to minimize the amount of noise it makes
    by beaconing command and control (C2) posts infrequently, or it can minimize the
    noise in process logs or memory by purposefully going to sleep or executing a
    no-operation (NOP) for long periods. To avoid leaving digital litter that could
    reveal its presence, certain malware does not drop any files to disk. Adversaries
    and malware on neighboring network infrastructure can choose to passively collect
    information, leading to a slow but fruitful understanding of the environment inside
    the target. Notably, many of these threats also choose to accept the risk of cyber
    light, noise, and/or litter that results from running their campaigns.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
- en: 'It is reasonable to assume that sufficiently advanced adversaries have procedures
    to limit cyber light, noise, and litter, such as:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
- en: Limiting communication with a target to less than 100MB per day
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ensuring that malware artifacts, files, and strings are not easily identified
    as litter that could reveal their own presence or be attributed to the malware
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: “Silencing” logs, alerts, tripwires, and other sensors so security is not alerted
    to the intruder's presence
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It seems that most current security devices and systems are designed to trigger
    in response to the exact signature of a known threat, such as a specific IP, event
    log, or byte pattern. Even with specialized software that shows analysts threat
    activity in real time, such as Wireshark,^([10](b01.xhtml#endnote-144)) it takes
    significant effort to collect, process, and study this information. Contrast this
    workflow with that of hearing footsteps and reacting. Because humans cannot perceive
    the digital realm with our senses in the same way that we perceive the physical
    environment, security measures are basically guards with visual and hearing impairments
    waiting for a prompt to take action against a threat across the room.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
- en: Detection Discipline
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Unfortunately, there is no ideal solution for catching someone skilled in the
    ways of not being caught. Some threat actors have such an advantage over defenders
    in this realm that they can gain unauthorized access to the security team’s incident
    ticket tool and monitor it for any new investigations that reference their own
    threat activity. However, there are improvements to be made, training to be had,
    countermeasures to deploy, and tricks defenders can try to trip up or catch the
    threat in a tradecraft error.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，对于那些精于隐匿技巧的人来说，并没有理想的解决方案。一些威胁行为者在这一领域拥有相对于防御者的巨大优势，他们可以未经授权访问安全团队的事件工单工具，并监控其中任何提及他们自己威胁活动的新调查。然而，仍然可以做出改进，进行培训，部署对策，并尝试一些防御技巧来使威胁者犯错或被捕。
- en: '*Practice awareness.* As part of training for threat hunting, incident response,
    and security analysis, teach your security team to look for indications of an
    adversary’s light, noise, or litter.'
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*练习警觉性*。作为威胁狩猎、事件响应和安全分析培训的一部分，教导您的安全团队寻找敌人轻微痕迹、噪音或杂乱的迹象。'
- en: '*Install squeaky gates.* Consider implementing deceptive attack sensing and
    warning (AS&W) indicators, such as security events that go off every minute on
    domain controllers or other sensitive systems or networking devices. For example,
    you might implement a warning that says “[Security Event Log Alert]: Windows failed
    to activate Windows Defender/Verify this version of Windows.” This may deceive
    an infiltrating adversary into thinking you’re not paying attention to your alerts,
    prompting the adversary to “turn off” or “redirect” security logs away from your
    sensors or analysts. The sudden absence of the false alert will inform your defenders
    of the adversary’s presence (or, in the case of a legitimate crash, of the need
    to reboot the system or have IT investigate the outage).'
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*安装嘎吱作响的门*。考虑实现欺骗性攻击感知和警告（AS&W）指示器，例如，在域控制器或其他敏感系统或网络设备上每分钟触发的安全事件。例如，您可以实施一个警告，内容为“[安全事件日志警报]：Windows
    未能激活 Windows Defender/验证此版本的 Windows。”这可能会误导渗透者认为您没有关注警报，从而促使对方“关闭”或“重定向”安全日志，避开您的传感器或分析人员。假如虚假警报突然消失，这将通知您的防御人员敌人的存在（或者，在正常崩溃的情况下，告知需要重启系统或由
    IT 部门调查故障）。'
- en: '*Break out the wooden clappers.* Consider how an advanced adversary could purposefully
    trigger alerts or cause noticeable network noise from a protected or hidden location
    in your environment (that is, attacking known honeypots) to observe your security
    team’s ability to detect and respond. This is the cyber equivalent of a ninja
    running through your house at night slamming two pieces of wood together to test
    your response. It’s reasonable to assume that some adversaries may assess your
    security in this way so they can determine whether they can use zero days or other
    covert techniques without fear of discovery.'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*打响木质响板*。考虑一下，先进的敌人可能如何故意触发警报或从您环境中的受保护或隐藏位置产生明显的网络噪音（即，攻击已知的蜜罐），以观察您的安全团队的检测和响应能力。这相当于网络中的忍者，在夜晚悄悄跑过您的房子，用两块木板猛地拍打，测试您的反应。可以合理假设，一些敌人可能会以这种方式评估您的安全防御，以便确定他们是否可以在不被发现的情况下使用零日漏洞或其他隐秘技巧。'
- en: Recommended Security Controls and Mitigations
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 推荐的安全控制和缓解措施
- en: Where relevant, recommendations are presented with applicable security controls
    from the NIST 800-53 standard. Each should be evaluated in terms of the light,
    noise, and litter that might accompany an attack.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 在相关情况下，提出的建议会配有适用的 NIST 800-53 标准中的安全控制。每一项建议都应从攻击可能伴随的光、噪音和杂乱因素进行评估。
- en: 'Determine your organization’s detection capabilities by simulating network
    infiltration by both loud-and-fast and low-and-slow adversaries. Document which
    logs are associated with which observable activity and where you may have sensory
    dead spots. [AU-2: Audit Events; CA-8: Penetration Testing; SC-42: Sensor Capability
    and Data]'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过模拟网络渗透，确定您组织的检测能力，既模拟快速攻击的敌人，也模拟缓慢潜行的敌人。记录哪些日志与哪些可观察活动相关，并找出可能存在的感知盲点。[AU-2：审计事件；CA-8：渗透测试；SC-42：传感器能力和数据]
- en: 'Correlate incident logs, alerts, and observables with documented threat actions
    to better educate your staff and test your perception of how threats will “sound”
    on the network. [IR-4: Incident Handling | (4) Information Correlation]'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将事件日志、警报和可观察信息与已记录的威胁行动进行关联，以更好地教育您的团队并测试您对威胁在网络上“发出的声音”的感知。[IR-4：事件处理 | (4)
    信息关联]
- en: 'Tune your sandboxes and detonation chambers to look for indicators of a threat
    actor who is attempting to exercise the cyber equivalent of light, noise, and
    litter discipline. [SC-44: Detonation Chambers]'
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '调整你的沙盒和引爆室，以寻找潜在威胁行为者的迹象，他们试图执行网络领域中的光、噪音和垃圾纪律。[SC-44: 引爆室]'
- en: 'Use non-signature-based detection methods to look for covert disciplined activity
    designed to avoid signature identification. [SI-3: Malicious Code Protection |
    (7) Nonsignature-Based Detection]'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '使用非基于签名的检测方法，寻找旨在避免签名识别的隐秘有序活动。[SI-3: 恶意代码防护 | (7) 非基于签名的检测]'
- en: 'Deploy information system monitoring to detect stealth activity. Avoid placing
    oversensitive sensors in high-activity areas. [SI-4: Information System Monitoring]'
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '部署信息系统监控以检测隐秘活动。避免在高活动区域放置过于敏感的传感器。[SI-4: 信息系统监控]'
- en: Debrief
  id: totrans-38
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 简报
- en: In this chapter, we reviewed the precautions shinobi took and the tools they
    used to hide evidence of their activity—for example, measuring how much noise
    they could make before alerting the guards and learning what the target was likely
    to do if shinobi activity were discovered. We discussed several cyber tools that
    adversaries have used and how they might be understood as the equivalent of light
    and noise—evidence that can be detected by defenders. Lastly, we reviewed potential
    countermeasures that defenders can take.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们回顾了忍者采取的预防措施和他们用来隐藏活动证据的工具——例如，衡量他们能制造多少噪音才不会引起警卫警觉，并了解如果忍者活动被发现，目标可能采取的行动。我们讨论了敌对方使用的几种网络工具，以及这些工具如何被理解为相当于光和噪音——这些都是防御者可以检测到的证据。最后，我们回顾了防御者可以采取的潜在对策。
- en: In the next chapter, we will discuss circumstances that assist shinobi in infiltration
    because they mitigate the problems of light, noise, and litter. For example, a
    strong rainstorm would mask noise, obscure visibility, and clear away evidence
    of their presence. A cyber defender can consider analogous circumstances to protect
    their systems.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将讨论有助于忍者渗透的情况，因为这些情况能够减轻光、噪音和垃圾的问题。例如，一场强烈的暴风雨可以掩盖噪音，遮挡视线，清除他们存在的证据。网络防御者可以考虑类似的情况来保护他们的系统。
