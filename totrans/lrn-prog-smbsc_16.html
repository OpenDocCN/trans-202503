<html><head></head><body>
<h2 class="h2" id="ch16"><span epub:type="pagebreak" id="page_227"/><span class="big"><span class="blue"><strong>16</strong></span></span><br/><strong>STORING DATA WITH ASSOCIATIVE ARRAYS</strong></h2>&#13;
<div class="imagec"><img alt="image" src="graphics/common01.jpg"/></div>&#13;
<p class="noindent">On social websites like Facebook and LinkedIn, people enter information into text boxes, such as their names, relationship statuses, and even regular updates to their friends (like, “Oh noes!! I just stepped on a bug, and I think I got bug poisoning!”). Programs that need to search or filter this data may use associative arrays to store the various parts of the text.</p>&#13;
<p class="indent">In addition to the indexed arrays you used in <a href="ch15.html#ch15">Chapter 15</a>, Small Basic supports other types of arrays that can simplify many programming tasks. In this chapter, you’ll start by learning about <em>associative arrays</em>. Then you’ll learn about the <code>Array</code> object, use it to create some fun applications, and even turn your computer into a poet!</p>&#13;
<h3 class="h3" id="ch16lev1sec01"><span epub:type="pagebreak" id="page_228"/><span class="blue"><strong>Associative Arrays</strong></span></h3>&#13;
<p class="noindent">In the previous chapter, you learned how to use an integer index to access an array’s elements. But in Small Basic, an array’s index can also be a string. Arrays indexed by strings are called <em>associative arrays</em>, <em>maps</em>, or <em>dictionaries</em>. In this book, we’ll call them associative arrays. Just like an indexed array, an associative array can store values of any type. You can use an associative array to create an association between a set of <em>keys</em> (string indices) and a set of values, which is called creating a <em>map</em> of key-value pairs.</p>&#13;
<p class="indent">The following code shows a simple example of an associative array in action. It’s a list of states keyed by their two-letter abbreviations:</p>&#13;
<pre>state[<span class="red">"CA"</span>] <span class="brown">=</span> <span class="red">"California"</span><br/>state[<span class="red">"MI"</span>] <span class="brown">=</span> <span class="red">"Michigan"</span><br/>state[<span class="red">"OH"</span>] <span class="brown">=</span> <span class="red">"Ohio"</span><br/><span class="green"><span class="codeitalic">' ... and so on</span></span></pre>&#13;
<p class="indent">To display the name of a state, you simply use its corresponding key and the proper syntax. For example, to display <code>Michigan</code>, you can write this statement:</p>&#13;
<pre><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>state[<span class="red">"MI"</span>]<span class="brown">)</span></pre>&#13;
<p class="indent">By writing the name of the array followed by the key enclosed in square brackets, you can access the corresponding item. An associative array works like a <em>lookup table</em> that maps keys to values; if you know the key, you can find its value very quickly.</p>&#13;
<p class="indent">To learn how to use associative arrays, let’s write a program that keeps track of the ages of your friends by name. Enter the program in <a href="ch16.html#ch16ex1">Listing 16-1</a>.</p>&#13;
<pre>1 <span class="green"><span class="codeitalic">' AssociativeArray.sb</span></span><br/>2 age[<span class="red">"Bert"</span>] <span class="brown">=</span> <span class="red">17</span><br/>3 age[<span class="red">"Ernie"</span>] <span class="brown">=</span> <span class="red">16</span><br/>4 age[<span class="red">"Zoe"</span>] <span class="brown">=</span> <span class="red">16</span><br/>5 age[<span class="red">"Elmo"</span>] <span class="brown">=</span> <span class="red">17</span><br/>6 <span class="blue1">TextWindow</span><span class="brown">.Write(</span><span class="red">"Enter the name of your friend: "</span><span class="brown">)</span><br/>7 name <span class="brown">=</span> <span class="blue1">TextWindow</span><span class="brown">.Read()</span><br/>8 <span class="blue1">TextWindow</span><span class="brown">.Write(</span>name <span class="brown">+</span> <span class="red">" is ["</span><span class="brown">)</span><br/>9 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>age[name] <span class="brown">+</span> <span class="red">"] years old."</span><span class="brown">)</span></pre>&#13;
<p class="listcap"><a id="ch16ex1"/><em>Listing 16-1: Using associative arrays</em></p>&#13;
<p class="indent">Lines 2–5 create an associative array named <code>age</code> with four elements in it. You can add more if you’d like, or you can change the array to store the ages of your own friends. Line 6 asks you to enter a friend’s name, and line 7 reads it into the <code>name</code> variable. In line 9, <code>age[name]</code> looks up the age of that friend.</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_229"/>Let’s look at some sample runs of this program:</p>&#13;
<pre>Enter the name of your friend: <span class="codestrong">Ernie</span><br/>Ernie is [16] years old.<br/><br/>Enter the name of your friend: <span class="codestrong">ernie</span><br/>ernie is [16] years old.</pre>&#13;
<p class="indent">Note that the key is case insensitive: it doesn’t matter if you enter <code>age["Ernie"]</code>, <code>age["ernie"]</code>, or even <code>age["ERNIE"]</code>. If the array contains a key named <code>Ernie</code>, regardless of its case, Small Basic returns the value for that key.</p>&#13;
<p class="indent">Let’s say you forget which friends’ names you stored in the array, and you try to access the age of someone you forgot to include:</p>&#13;
<pre>Enter the name of your friend: <span class="codestrong">Grover</span><br/>Grover is [] years old.</pre>&#13;
<p class="indent">If the array doesn’t contain a certain key, Small Basic returns an empty string, which is why <code>age["Grover"]</code> is empty.</p>&#13;
<div class="sidebar1">&#13;
<p class="sidebart1" id="ch16sb01"><strong>ASSOCIATIVE ARRAYS VS. THE IF/ELSEIF LADDER</strong></p>&#13;
<p class="noindent">In programming, there are usually lots of different ways to approach a particular problem. Here’s another way to write the program like the one in <a href="ch16.html#ch16ex1">Listing 16-1</a>:</p>&#13;
<pre><span class="blue1">TextWindow</span><span class="brown">.Write(</span><span class="red">"Enter the name of your friend: "</span><span class="brown">)</span><br/>name <span class="brown">=</span> <span class="blue1">TextWindow</span><span class="brown">.Read()</span><br/><span class="purple"><span class="codestrong">If</span></span> <span class="brown">(</span>name <span class="brown">=</span> <span class="red">"Bert"</span><span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span><br/>  age <span class="brown">=</span> <span class="red">17</span><br/><span class="purple"><span class="codestrong">ElseIf</span></span> <span class="brown">(</span>name <span class="brown">=</span> <span class="red">"Ernie"</span><span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span><br/>  age <span class="brown">=</span> <span class="red">16</span><br/><span class="purple"><span class="codestrong">ElseIf</span></span> <span class="brown">(</span>name <span class="brown">=</span> <span class="red">"Zoe"</span><span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span><br/>  age <span class="brown">=</span> <span class="red">16</span><br/><span class="purple"><span class="codestrong">ElseIf</span></span> <span class="brown">(</span>name <span class="brown">=</span> <span class="red">"Elmo"</span><span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span><br/>  age <span class="brown">=</span> <span class="red">17</span><br/><span class="purple"><span class="codestrong">Else</span></span><br/>  age <span class="brown">=</span> <span class="red">""</span><br/><span class="purple"><span class="codestrong">EndIf</span></span><br/><span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>name <span class="brown">+</span> <span class="red">" is ["</span> <span class="brown">+</span> age <span class="brown">+</span> <span class="red">"] years old."</span><span class="brown">)</span></pre>&#13;
<p class="indent">Although this program seems similar to the one in <a href="ch16.html#ch16ex1">Listing 16-1</a>, the two have one important difference: here, string comparison is case sensitive. If you enter <code>ernie</code> (with a lowercase <em>e</em>), the program displays the following output:</p>&#13;
<pre>ernie is [] years old.</pre>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_230"/>The expression <code>If("ernie" = "Ernie")</code> is false. This version of the program is also harder to read and write. When you need to map between a set of keys and values, it’s best to use associative arrays so you don’t have to worry about case.</p>&#13;
</div>&#13;
<h3 class="h3" id="ch16lev1sec02"><span class="blue"><strong>Putting Associative Arrays to Use</strong></span></h3>&#13;
<p class="noindent">Now that you understand the basics of associative arrays, let’s examine a couple of programs that show you how to use them.</p>&#13;
<h4 class="h4" id="ch16lev2sec01"><em><strong>Days in French</strong></em></h4>&#13;
<p class="noindent">The first example translates the days of the week from English to French. This program prompts a user to enter the name of a day in English and outputs that name in French. Enter the code in <a href="ch16.html#ch16ex2">Listing 16-2</a>.</p>&#13;
<pre> 1 <span class="green"><span class="codeitalic">' FrenchDays.sb</span></span><br/> 2 day[<span class="red">"Sunday"</span>] <span class="brown">=</span> <span class="red">"Dimanche"</span><br/> 3 day[<span class="red">"Monday"</span>] <span class="brown">=</span> <span class="red">"Lundi"</span><br/> 4 day[<span class="red">"Tuesday"</span>] <span class="brown">=</span> <span class="red">"Mardi"</span><br/> 5 day[<span class="red">"Wednesday"</span>] <span class="brown">=</span> <span class="red">"Mercredi"</span><br/> 6 day[<span class="red">"Thursday"</span>] <span class="brown">=</span> <span class="red">"Jeudi"</span><br/> 7 day[<span class="red">"Friday"</span>] <span class="brown">=</span> <span class="red">"Vendredi"</span><br/> 8 day[<span class="red">"Saturday"</span>] <span class="brown">=</span> <span class="red">"Samedi"</span><br/> 9<br/>10 <span class="blue1">TextWindow</span><span class="brown">.Write(</span><span class="red">"Enter the name of a day: "</span><span class="brown">)</span><br/>11 name <span class="brown">=</span> <span class="blue1">TextWindow</span><span class="brown">.Read()</span><br/>12 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>name <span class="brown">+</span> <span class="red">" in French is "</span> <span class="brown">+</span> day[name]<span class="brown">)</span></pre>&#13;
<p class="listcap"><a id="ch16ex2"/><em>Listing 16-2: An English-to-French translator</em></p>&#13;
<p class="indent">The <code>day</code> array stores the French names for the days of the week (lines 2–8). Each key in the array is the day’s name in English. The program prompts the user to enter the name of a day in English (line 10) and stores the user’s input in the <code>name</code> variable (line 11). The program then looks up the French name using the user’s input as a key, using the syntax <code>day[name]</code>, and displays it (line 12). Here’s the output from a sample run:</p>&#13;
<pre>Enter the name of a day: <span class="codestrong">Monday</span><br/>Monday in French is Lundi</pre>&#13;
<p class="indent">Do you know any other languages? Change the program to help your friends learn how to say the days of the week in a new language. Feeling sneaky? You could even make up your own secret language!</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch16sb02"><span epub:type="pagebreak" id="page_231"/><strong>TRY IT OUT 16-1</strong></p>&#13;
<p class="noindent">What’s the output of <a href="ch16.html#ch16ex2">Listing 16-2</a> if the user enters an invalid day name (like <em>Windsday</em>)? Update the program to display an error message when this happens. Use an <code>If</code> statement like this one:</p>&#13;
<pre><span class="purple"><span class="codestrong">If</span></span> <span class="brown">(</span>day[name] <span class="brown">=</span> <span class="red">""</span><span class="brown">)</span> <span class="purple"><span class="codestrong">Then</span></span><br/>  <span class="green"><span class="codeitalic">' Tell the user they entered a wrong name</span></span><br/><span class="purple"><span class="codestrong">Else</span></span><br/>  <span class="green"><span class="codeitalic">' Show the French translation</span></span><br/><span class="purple"><span class="codestrong">EndIf</span></span></pre>&#13;
</div>&#13;
<h4 class="h4" id="ch16lev2sec02"><em><strong>Storing Records</strong></em></h4>&#13;
<p class="noindent">Business is booming, and Moe Mows, a local lawn-mowing service in your town, has hired you to write a program that displays the contact information of its customers. When the company enters a customer’s name, the program needs to display the customer’s home address, phone number, and email address. Enter the program in <a href="ch16.html#ch16ex3">Listing 16-3</a>.</p>&#13;
<pre> 1 <span class="green"><span class="codeitalic">' MoeMows.sb</span></span><br/> 2 address[<span class="red">"Natasha"</span>] <span class="brown">=</span> <span class="red">"3215 Romanoff Rd"</span><br/> 3 phone[<span class="red">"Natasha"</span>] <span class="brown">=</span> <span class="red">"(321) 555 8745"</span><br/> 4 email[<span class="red">"Natasha"</span>] <span class="brown">=</span> <span class="red">"blackwidow64@shield.com"</span><br/> 5<br/> 6 address[<span class="red">"Tony"</span>] <span class="brown">=</span> <span class="red">"8251 Stark St"</span><br/> 7 phone[<span class="red">"Tony"</span>] <span class="brown">=</span> <span class="red">"(321) 555 4362"</span><br/> 8 email[<span class="red">"Tony"</span>] <span class="brown">=</span> <span class="red">"ironman63@shield.com"</span><br/> 9<br/>10 <span class="blue1">TextWindow</span><span class="brown">.Write(</span><span class="red">"Name of customer: "</span><span class="brown">)</span><br/>11 name <span class="brown">=</span> <span class="blue1">TextWindow</span><span class="brown">.Read()</span><br/>12 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"Address...: "</span> <span class="brown">+</span> address[name]<span class="brown">)</span><br/>13 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"Phone.....: "</span> <span class="brown">+</span> phone[name]<span class="brown">)</span><br/>14 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"Email.....: "</span> <span class="brown">+</span> email[name]<span class="brown">)</span></pre>&#13;
<p class="listcap"><a id="ch16ex3"/><em>Listing 16-3: Building a simple database</em></p>&#13;
<p class="indent">The program uses three associative arrays: <code>address</code>, <code>phone</code>, and <code>email</code>. All three arrays use the customer’s name as a key, and the arrays are used collectively to store customers’ records. A <em>record</em> is a collection of related data items. In this example, each customer’s record has three fields: address, phone, and email. Whether the program has two records or 1,000 records, the search is done the same way. For example, the statement <code>address[name]</code> in line 12 returns the value associated with the key <code>name</code> in the <code>address</code> array. We don’t have to search the <code>address</code> array; Small Basic does this for us, for free!</p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_232"/>Here’s the output from a sample run of this program:</p>&#13;
<pre>Name of customer: <span class="codestrong">Tony</span><br/>Address...: 8251 Stark St<br/>Phone.....: (321) 555 4362<br/>Email.....: ironman63@shield.com</pre>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch16sb03"><strong>TRY IT OUT 16-2</strong></p>&#13;
<p class="noindent">Update the program in <a href="ch16.html#ch16ex3">Listing 16-3</a> to store the contact information of some of your friends (but not all 500 of your Facebook friends). Add another array that stores the birth date of each friend. You’ll never forget a birthday again!</p>&#13;
</div>&#13;
<h3 class="h3" id="ch16lev1sec03"><span class="blue"><strong>The Array Object</strong></span></h3>&#13;
<p class="noindent">The <code>Array</code> object in the Small Basic library can help you find important information about the arrays in your programs. In this section, we’ll explore this object in detail and look at some examples on how to use it. To explore the <code>Array</code> object, let’s start by entering the following code:</p>&#13;
<pre>name <span class="brown">=</span> <span class="red">"Bart"</span>         <span class="green"><span class="codeitalic">' An ordinary variable</span></span><br/>age[<span class="red">"Homer"</span>] <span class="brown">=</span> <span class="red">18</span>     <span class="green"><span class="codeitalic">' An associative array with two elements</span></span><br/>age[<span class="red">"Marge"</span>] <span class="brown">=</span> <span class="red">17</span><br/>score[<span class="red">1</span>] <span class="brown">=</span> <span class="red">90</span>         <span class="green"><span class="codeitalic">' An indexed array with one element</span></span></pre>&#13;
<p class="indent">This code defines an ordinary variable called <code>name</code>, an associative array called <code>age</code> that has two elements, and an indexed array called <code>score</code> that has one element. You’ll use these arrays in the examples that follow. What can the <code>Array</code> object tell you? Let’s find out!</p>&#13;
<h4 class="h4" id="ch16lev2sec03"><em><strong>Is It an Array?</strong></em></h4>&#13;
<p class="noindent">Do you think Small Basic knows that <code>name</code> is an ordinary variable and that <code>age</code> and <code>score</code> are arrays? Run the program in <a href="ch16.html#ch16ex4">Listing 16-4</a> to find out.</p>&#13;
<pre>1 <span class="green"><span class="codeitalic">' IsArray.sb</span></span><br/>2 name <span class="brown">=</span> <span class="red">"Bart"</span><br/>3 age[<span class="red">"Homer"</span>] <span class="brown">=</span> <span class="red">18</span><br/>4 age[<span class="red">"Marge"</span>] <span class="brown">=</span> <span class="red">17</span><br/>5 score[<span class="red">1</span>] <span class="brown">=</span> <span class="red">90</span><br/>6 ans1 <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.IsArray(</span>name<span class="brown">)</span>       <span class="green"><span class="codeitalic">' Returns "False"</span></span><br/>7 ans2 <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.IsArray(</span>age<span class="brown">)</span>        <span class="green"><span class="codeitalic">' Returns "True"</span></span><br/>8 ans3 <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.IsArray(</span>score<span class="brown">)</span>      <span class="green"><span class="codeitalic">' Returns "True"</span></span><br/>9 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>ans1 <span class="brown">+</span> <span class="red">", "</span> <span class="brown">+</span> ans2 <span class="brown">+</span> <span class="red">", "</span> <span class="brown">+</span> ans3<span class="brown">)</span></pre>&#13;
<p class="listcap"><a id="ch16ex4"/><em>Listing 16-4: Demonstrating the</em> <code><span class="codeitalic">IsArray()</code></span> <em>method</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_233"/>This code uses the <code>Array</code> object’s <code>IsArray()</code> method. If the variable is an array, this method returns <code>"True"</code>; otherwise, it returns <code>"False"</code>. This method shows that the variables <code>age</code> and <code>score</code> are arrays, but the <code>name</code> variable isn’t an array. The <code>IsArray()</code> method can help you to be sure that the variables in your programs are arrays.</p>&#13;
<h4 class="h4" id="ch16lev2sec04"><em><strong>How Big Is an Array?</strong></em></h4>&#13;
<p class="noindent">The <code>Array</code> object can also tell you how many elements are stored in your arrays. Run the program in <a href="ch16.html#ch16ex5">Listing 16-5</a>.</p>&#13;
<pre>1 <span class="green"><span class="codeitalic">' GetItemCount.sb</span></span><br/>2 name <span class="brown">=</span> <span class="red">"Bart"</span><br/>3 age[<span class="red">"Homer"</span>] <span class="brown">=</span> <span class="red">18</span><br/>4 age[<span class="red">"Marge"</span>] <span class="brown">=</span> <span class="red">17</span><br/>5 score[<span class="red">1</span>] <span class="brown">=</span> <span class="red">90</span><br/>6 ans1 <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.GetItemCount(</span>name<span class="brown">)</span>       <span class="green"><span class="codeitalic">' Returns: 0</span></span><br/>7 ans2 <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.GetItemCount(</span>age<span class="brown">)</span>        <span class="green"><span class="codeitalic">' Returns: 2</span></span><br/>8 ans3 <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.GetItemCount(</span>score<span class="brown">)</span>      <span class="green"><span class="codeitalic">' Returns: 1</span></span><br/>9 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>ans1 <span class="brown">+</span> <span class="red">", "</span> <span class="brown">+</span> ans2 <span class="brown">+</span> <span class="red">", "</span> <span class="brown">+</span> ans3<span class="brown">)</span></pre>&#13;
<p class="listcap"><a id="ch16ex5"/><em>Listing 16-5: Demonstrating the</em> <code><span class="codeitalic">GetItemCount()</code></span> <em>method</em></p>&#13;
<p class="indent">The <code>GetItemCount()</code> method returns the number of items in the specified array. Note how <code>GetItemCount(name)</code> returns 0, because <code>name</code> isn’t an array. The other two calls return the number of elements in each array. Use <code>GetItemCount()</code> to keep track of how many items you’re storing in an array. You might use this method in a game that allows the player to store items in an inventory and you want to check how many items they have picked up.</p>&#13;
<h4 class="h4" id="ch16lev2sec05"><em><strong>Does It Have a Particular Index?</strong></em></h4>&#13;
<p class="noindent">You can also use the <code>Array</code> object to find out whether one of your arrays contains a certain index. To see how, run the program in <a href="ch16.html#ch16ex6">Listing 16-6</a>.</p>&#13;
<pre> 1 <span class="green"><span class="codeitalic">' ContainsIndex.sb</span></span><br/> 2 age[<span class="red">"Homer"</span>] <span class="brown">=</span> <span class="red">18</span><br/> 3 age[<span class="red">"Marge"</span>] <span class="brown">=</span> <span class="red">17</span><br/> 4 score[<span class="red">1</span>] <span class="brown">=</span> <span class="red">90</span><br/> 5 ans1 <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.ContainsIndex(</span>age<span class="brown">,</span> <span class="red">1</span><span class="brown">)</span>       <span class="green"><span class="codeitalic">' Returns "False"</span></span><br/> 6 ans2 <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.ContainsIndex(</span>age<span class="brown">,</span> <span class="red">"homer"</span><span class="brown">)</span> <span class="green"><span class="codeitalic">' Returns "True"</span></span><br/> 7 ans3 <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.ContainsIndex(</span>age<span class="brown">,</span> <span class="red">"Lisa"</span><span class="brown">)</span>  <span class="green"><span class="codeitalic">' Returns "False"</span></span><br/> 8 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>ans1 <span class="brown">+</span> <span class="red">", "</span> <span class="brown">+</span> ans2 <span class="brown">+</span> <span class="red">", "</span> <span class="brown">+</span> ans3<span class="brown">)</span><br/> 9<br/>10 ans1 <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.ContainsIndex(</span>score<span class="brown">,</span> <span class="red">"1"</span><span class="brown">)</span>   <span class="green"><span class="codeitalic">' Returns "True"</span></span><br/>11 ans2 <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.ContainsIndex(</span>score<span class="brown">,</span> <span class="red">1</span><span class="brown">)</span>     <span class="green"><span class="codeitalic">' Returns "True"</span></span><br/>12 ans3 <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.ContainsIndex(</span>score<span class="brown">,</span> <span class="red">2</span><span class="brown">)</span>     <span class="green"><span class="codeitalic">' Returns "False"</span></span><br/>13 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>ans1 <span class="brown">+</span> <span class="red">", "</span> <span class="brown">+</span> ans2 <span class="brown">+</span> <span class="red">", "</span> <span class="brown">+</span> ans3<span class="brown">)</span></pre>&#13;
<p class="listcap"><a id="ch16ex6"/><em>Listing 16-6: Demonstrating the</em> <code><span class="codeitalic">ContainsIndex()</code></span> <em>method</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_234"/>The <code>ContainsIndex()</code> method takes two arguments. The first argument is the name of the array, and the second argument is the index you’re checking for. The method returns <code>"True"</code> or <code>"False"</code> depending on whether the index exists in the array.</p>&#13;
<p class="indent">Line 6 shows that searching for the index is case insensitive, which is why the search for the index <code>homer</code> returns <code>"True"</code>. Also, searching the <code>score</code> array for index <code>"1"</code> (as a string) or index <code>1</code> (as a number) both returned <code>"True"</code>.</p>&#13;
<p class="indent">If you’re not sure whether an array includes a particular index, you can use the <code>ContainsIndex()</code> method to find out. This method is especially helpful if you’re working with very long arrays.</p>&#13;
<h4 class="h4" id="ch16lev2sec06"><em><strong>Does It Have a Particular Value?</strong></em></h4>&#13;
<p class="noindent">The <code>Array</code> object also offers a method that checks whether an array contains a certain value. Run the program in <a href="ch16.html#ch16ex7">Listing 16-7</a> to discover how the <code>ContainsValue()</code> method works.</p>&#13;
<pre>1 <span class="green"><span class="codeitalic">' ContainsValue.sb</span></span><br/>2 age[<span class="red">"Homer"</span>] <span class="brown">=</span> <span class="red">18</span><br/>3 age[<span class="red">"Marge"</span>] <span class="brown">=</span> <span class="red">17</span><br/>4 score[<span class="red">1</span>] <span class="brown">=</span> <span class="red">90</span><br/>5 ans1 <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.ContainsValue(</span>age<span class="brown">,</span> <span class="red">18</span><span class="brown">)</span>   <span class="green"><span class="codeitalic">' Returns "True"</span></span><br/>6 ans2 <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.ContainsValue(</span>age<span class="brown">,</span> <span class="red">20</span><span class="brown">)</span>   <span class="green"><span class="codeitalic">' Returns "False"</span></span><br/>7 ans3 <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.ContainsValue(</span>score<span class="brown">,</span> <span class="red">90</span><span class="brown">)</span> <span class="green"><span class="codeitalic">' Returns "True"</span></span><br/>8 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span>ans1 <span class="brown">+</span> <span class="red">", "</span> <span class="brown">+</span> ans2 <span class="brown">+</span> <span class="red">", "</span> <span class="brown">+</span> ans3<span class="brown">)</span></pre>&#13;
<p class="listcap"><a id="ch16ex7"/><em>Listing 16-7: Demonstrating the</em> <code><span class="codeitalic">ContainsValue()</code></span> <em>method</em></p>&#13;
<p class="indent">The <code>ContainsValue()</code> method returns <code>"True"</code> or <code>"False"</code> depending on whether the value it checks for exists in the array.</p>&#13;
<div class="note">&#13;
<p class="notet"><span class="notes"><strong>NOTE</strong></span></p>&#13;
<p class="notep"><em>Unlike the</em> <code><span class="codeitalic">ContainsIndex()</code></span> <em>method, the</em> <code><span class="codeitalic">ContainsValue()</code></span> <em>method is case sensitive. So it’s best to be consistent with your casing!</em></p>&#13;
</div>&#13;
<h4 class="h4" id="ch16lev2sec07"><em><strong>Give Me All the Indices</strong></em></h4>&#13;
<p class="noindent">Another useful method of the <code>Array</code> object is <code>GetAllIndices()</code>. This method returns an array that has all the indices of a given array. The first element of the returned array has an index of 1. To understand how this method works, run the program in <a href="ch16.html#ch16ex8">Listing 16-8</a>.</p>&#13;
<pre>1 <span class="green"><span class="codeitalic">' GetAllIndices.sb</span></span><br/>2 age[<span class="red">"Homer"</span>] <span class="brown">=</span> <span class="red">18</span><br/>3 age[<span class="red">"Marge"</span>] <span class="brown">=</span> <span class="red">17</span><br/>4 names <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.GetAllIndices(</span>age<span class="brown">)</span><br/>5 <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"Indices of the age array:"</span><span class="brown">)</span><br/>6 <span class="purple"><span class="codestrong">For</span></span> N <span class="brown">=</span> <span class="red">1</span> <span class="purple"><span class="codestrong">To</span></span> <span class="blue1">Array</span><span class="brown">.GetItemCount(</span>names<span class="brown">)</span><br/>7   <span class="blue1">TextWindow</span><span class="brown">.WriteLine(</span><span class="red">"Index"</span> <span class="brown">+</span> N <span class="brown">+</span> <span class="red">" = "</span> <span class="brown">+</span> names[N]<span class="brown">)</span><br/>8 <span class="purple"><span class="codestrong">EndFor</span></span></pre>&#13;
<p class="listcap"><a id="ch16ex8"/><em>Listing 16-8: Demonstrating the</em> <code><span class="codeitalic">GetAllIndices()</code></span> <em>method</em></p>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_235"/>Line 4 calls <code>GetAllIndices()</code> to find all the indices of the <code>age</code> array. This method returns an array, which it saves in the <code>names</code> identifier. The code then starts a loop that runs from the first to the last element in <code>names</code>. Note how the code uses the <code>GetItemCount()</code> method to figure out this value. Here’s the output of this code:</p>&#13;
<pre>Indices of the age array:<br/>Index1 = Homer<br/>Index2 = Marge</pre>&#13;
<p class="indent">Now let’s put the methods you’ve learned to good use. Do you think your computer is intelligent enough to write poems? Well, let’s see!</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch16sb04"><strong>TRY IT OUT 16-3</strong></p>&#13;
<p class="noindent">Open the file <em>AnimalSpeed.sb</em> from this chapter’s folder. This game quizzes the player on the top speed (in miles per hour) of different animals. The program has an associative array that looks like this:</p>&#13;
<pre>speed[<span class="red">"cheetah"</span>] <span class="brown">=</span> <span class="red">70</span><br/>speed[<span class="red">"antelope"</span>] <span class="brown">=</span> <span class="red">60</span><br/>speed[<span class="red">"lion"</span>] <span class="brown">=</span> <span class="red">50</span><br/><span class="green"><span class="codeitalic">' ... and so on</span></span></pre>&#13;
<p class="indent">Run this game to see how it works. Which <code>Array</code> object methods does the game use? Explain how the game works, and then come up with some ideas to make the game more fun. Make sure you do all of this assignment. Don’t be a cheetah!</p>&#13;
</div>&#13;
<h3 class="h3" id="ch16lev1sec04"><span class="blue"><strong>Your Computer the Poet</strong></span></h3>&#13;
<p class="noindent">Now let’s use what we’ve learned about associative arrays to write a program that generates poems. This artificial poet selects words randomly from five lists (<code>article</code>, <code>adjective</code>, <code>noun</code>, <code>verb</code>, and <code>preposition</code>) and combines them into a fixed pattern. To give the poems a central theme, all the words in these lists are related to love and nature. Of course, we might still end up with some silly poetry, but that’s just as fun!</p>&#13;
<div class="note">&#13;
<p class="notet"><span class="notes"><strong>NOTE</strong></span></p>&#13;
<p class="notep"><em>The idea of this program is adapted from Daniel Watt’s</em> Learning with Logo <em>(McGraw-Hill, 1983).</em></p>&#13;
</div>&#13;
<p class="indent"><span epub:type="pagebreak" id="page_236"/><a href="ch16.html#ch16fig1">Figure 16-1</a> shows the user interface for the application.</p>&#13;
<div class="image"><img alt="image" src="graphics/f16-01.jpg"/></div>&#13;
<p class="figcap"><a id="ch16fig1"/><em>Figure 16-1: The user interface for</em> Poet.sb</p>&#13;
<p class="indentb">Every time you click the New button, the poet recites a new poem. Each poem includes three lines that follow these patterns:</p>&#13;
<p class="bull">• Line 1: article, adjective, noun</p>&#13;
<p class="bull">• Line 2: article, noun, verb, preposition, article, adjective, noun</p>&#13;
<p class="bull">• Line 3: adjective, adjective, noun</p>&#13;
<p class="indentt">The following sections guide you through the creation of this program.</p>&#13;
<h4 class="h4" id="ch16lev2sec08"><em><strong>Step 1: Open the Startup File</strong></em></h4>&#13;
<p class="noindent">Open the file <em>Poet_Incomplete.sb</em> from this chapter’s folder. The file contains one subroutine named <code>CreateLists()</code>, which creates the five lists you’ll need in this program. This subroutine was added to save you from having to type a whole bunch of words. This is what it looks like:</p>&#13;
<pre><span class="purple"><span class="codestrong">Sub</span></span> CreateLists<br/>  article <span class="brown">=</span> <span class="red">"1=a;2=the;...;5=every;"</span><br/>  adjective <span class="brown">=</span> <span class="red">"1=beautiful;2=blue;...;72=young;"</span><br/>  noun <span class="brown">=</span> <span class="red">"1=baby;2=bird;...;100=winter;"</span><br/>  verb <span class="brown">=</span> <span class="red">"1=admires;2=amuses;...;92=whispers;"</span><br/>  prepos <span class="brown">=</span> <span class="red">"1=about;2=above;...;37=without;"</span><br/><span class="purple"><span class="codestrong">EndSub</span></span></pre>&#13;
<p class="indent">The ellipses (<code>...</code>) take the place of the missing array elements, but you can see all these elements when you open the file. Note that the article array also includes other determiners, such as one, each, and every.</p>&#13;
<h4 class="h4" id="ch16lev2sec09"><span epub:type="pagebreak" id="page_237"/><em><strong>Step 2: Set Up the Graphical User Interface</strong></em></h4>&#13;
<p class="noindent">Add the code in <a href="ch16.html#ch16ex9">Listing 16-9</a> to the beginning of the program file to set up the graphical user interface (GUI) and register the button’s event handler.</p>&#13;
<pre> 1 <span class="blue1">GraphicsWindow</span><span class="brown">.Title =</span> <span class="red">"The Poet"</span><br/> 2 <span class="blue1">GraphicsWindow</span><span class="brown">.CanResize =</span> <span class="red">"False"</span><br/> 3 <span class="blue1">GraphicsWindow</span><span class="brown">.Width =</span> <span class="red">480</span><br/> 4 <span class="blue1">GraphicsWindow</span><span class="brown">.Height =</span> <span class="red">360</span><br/> 5 <span class="blue1">GraphicsWindow</span><span class="brown">.FontBold =</span> <span class="red">"False"</span><br/> 6 <span class="blue1">GraphicsWindow</span><span class="brown">.FontItalic =</span> <span class="red">"True"</span><br/> 7 <span class="blue1">GraphicsWindow</span><span class="brown">.FontSize =</span> <span class="red">16</span><br/> 8<br/> 9 path <span class="brown">=</span> <span class="blue1">Program</span><span class="brown">.Directory</span><br/>10 <span class="blue1">GraphicsWindow</span><span class="brown">.DrawImage(</span>path <span class="brown">+</span> <span class="red">"\Background.png"</span><span class="brown">,</span> <span class="red">0</span><span class="brown">,</span> <span class="red">0</span><span class="brown">)</span><br/>11 <span class="blue1">Controls</span><span class="brown">.AddButton(</span><span class="red">"New"</span><span class="brown">,</span> <span class="red">10</span><span class="brown">,</span> <span class="red">10</span><span class="brown">)</span><br/>12<br/>13 CreateLists<span class="brown">()</span><br/>14<br/>15 artCount <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.GetItemCount(</span>article<span class="brown">)</span><br/>16 adjCount <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.GetItemCount(</span>adjective<span class="brown">)</span><br/>17 nounCount <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.GetItemCount(</span>noun<span class="brown">)</span><br/>18 verbCount <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.GetItemCount(</span>verb<span class="brown">)</span><br/>19 prepCount <span class="brown">=</span> <span class="blue1">Array</span><span class="brown">.GetItemCount(</span>prepos<span class="brown">)</span><br/>20<br/>21 <span class="blue1">Controls</span><span class="brown">.ButtonClicked =</span> OnButtonClicked<br/>22 OnButtonClicked<span class="brown">()</span></pre>&#13;
<p class="listcap"><a id="ch16ex9"/><em>Listing 16-9: Setting up the GUI</em></p>&#13;
<p class="indent">The program starts by initializing the graphics window (lines 1–7), drawing the background image (lines 9–10), and creating the New button (line 11). Next, it calls the <code>CreateLists()</code> subroutine to initialize the five indexed arrays (line 13). Then the program uses the <code>Array</code> object to get the number of items in each array and saves these values in lines 15–19. This way, you can append more elements to the end of these arrays without affecting the rest of the program. For example, if you wanted to add a 73rd adjective, you could add <code>73=callipygous;</code> within the quotes at the end of the <code>adjectives</code> array line in the <code>CreateLists()</code> subroutine. Because line 16 in <a href="ch16.html#ch16ex9">Listing 16-9</a> gets the count of the elements in that array, the new elements you add are automatically counted and randomly selected for the poem, just like the other elements.</p>&#13;
<p class="indent">Finally, the program registers a handler for the <code>ButtonClicked</code> event (line 21) and calls the handler subroutine to display the first poem (line 22).</p>&#13;
<h4 class="h4" id="ch16lev2sec10"><em><strong>Step 3: Respond to Button Clicks</strong></em></h4>&#13;
<p class="noindent">Now you need to add the <code>OnButtonClicked()</code> subroutine, which is shown in <a href="ch16.html#ch16ex10">Listing 16-10</a>.</p>&#13;
<pre><span epub:type="pagebreak" id="page_238"/> 1 <span class="purple"><span class="codestrong">Sub</span></span> OnButtonClicked<br/> 2   <span class="blue1">GraphicsWindow</span><span class="brown">.DrawImage(</span>path <span class="brown">+</span> <span class="red">"\Background.png"</span><span class="brown">,</span> <span class="red">0</span><span class="brown">,</span> <span class="red">0</span><span class="brown">)</span><br/> 3<br/> 4   MakeLine<span class="brown">1()</span>  <span class="green"><span class="codeitalic">' Constructs poemLine1</span></span><br/> 5   MakeLine<span class="brown">2()</span>  <span class="green"><span class="codeitalic">' Constructs poemLine2</span></span><br/> 6   MakeLine<span class="brown">3()</span>  <span class="green"><span class="codeitalic">' Constructs poemLine3</span></span><br/> 7<br/> 8   <span class="blue1">GraphicsWindow</span><span class="brown">.DrawText(</span><span class="red">180</span><span class="brown">,</span> <span class="red">140</span><span class="brown">,</span> poemLine1<span class="brown">)</span><br/> 9   <span class="blue1">GraphicsWindow</span><span class="brown">.DrawText(</span><span class="red">100</span><span class="brown">,</span> <span class="red">165</span><span class="brown">,</span> poemLine2<span class="brown">)</span><br/>10   <span class="blue1">GraphicsWindow</span><span class="brown">.DrawText(</span><span class="red">180</span><span class="brown">,</span> <span class="red">190</span><span class="brown">,</span> poemLine3<span class="brown">)</span><br/>11 <span class="purple"><span class="codestrong">EndSub</span></span></pre>&#13;
<p class="listcap"><a id="ch16ex10"/><em>Listing 16-10: The</em> <code><span class="codeitalic">OnButtonClicked()</code></span> <em>subroutine</em></p>&#13;
<p class="indent">This subroutine redraws the background image to clear the graphics window (line 2). It then calls the three subroutines that author the three lines of the poem (lines 4–6) and draws these lines in the graphics window (lines 8–10). Next, you’ll add the three missing subroutines.</p>&#13;
<h4 class="h4" id="ch16lev2sec11"><em><strong>Step 4: Write the Poem’s First Line</strong></em></h4>&#13;
<p class="noindent">The poem’s first line is written in this form: article, adjective, noun. Add the subroutine in <a href="ch16.html#ch16ex11">Listing 16-11</a>, which creates the poem’s first line and assigns it to the <code>poemLine1</code> variable.</p>&#13;
<pre>1 <span class="purple"><span class="codestrong">Sub</span></span> MakeLine1<br/>2   art1 <span class="brown">=</span> article[<span class="blue1">Math</span><span class="brown">.GetRandomNumber(</span>artCount<span class="brown">)</span>]<br/>3   adj1 <span class="brown">=</span> adjective[<span class="blue1">Math</span><span class="brown">.GetRandomNumber(</span>adjCount<span class="brown">)</span>]<br/>4   noun1 <span class="brown">=</span> noun[<span class="blue1">Math</span><span class="brown">.GetRandomNumber(</span>nounCount<span class="brown">)</span>]<br/>5   poemLine1 <span class="brown">=</span> art1 <span class="brown">+</span> <span class="red">" "</span> <span class="brown">+</span> adj1 <span class="brown">+</span> <span class="red">" "</span> <span class="brown">+</span> noun1<br/>6 <span class="purple"><span class="codestrong">EndSub</span></span></pre>&#13;
<p class="listcap"><a id="ch16ex11"/><em>Listing 16-11: The</em> <code><span class="codeitalic">MakeLine1()</code></span> <em>subroutine</em></p>&#13;
<p class="indent">The <code>MakeLine1()</code> subroutine selects three random words from the <code>article</code>, <code>adjective</code>, and <code>noun</code> arrays and stores the values in <code>art1</code>, <code>adj1</code>, and <code>noun1</code> (lines 2–4). It then fills <code>poemLine1</code> by appending these variables with a whitespace in between them (line 5).</p>&#13;
<h4 class="h4" id="ch16lev2sec12"><em><strong>Step 5: Write the Poem’s Second and Third Lines</strong></em></h4>&#13;
<p class="noindent">The <code>MakeLine2()</code> and <code>MakeLine3()</code> subroutines are very similar to the <code>MakeLine1()</code> subroutine. The second line takes this form: article, noun, verb, preposition, article, adjective, noun. The third line takes this form: adjective, adjective, noun. Create these subroutines on your own. If you get stuck, open the file <em>Poet.sb</em> to see how we wrote these subroutines. When you’re done, recite your favorite poem output to your family or friends, and see if they think you wrote it!</p>&#13;
<div class="sidebar">&#13;
<p class="sidebart" id="ch16sb05"><span epub:type="pagebreak" id="page_239"/><strong>TRY IT OUT 16-4</strong></p>&#13;
<p class="noindent">Run your poet program several times to see what a machine poet is capable of authoring. Come up with different poem patterns, and teach this poet how to create them. Then change the words to any words (and any amount of words) that you want! Head to <em><a href="http://tiny.cc/sbpoet/">http://tiny.cc/sbpoet/</a></em> to share your poem program with the community and to see what others created.</p>&#13;
</div>&#13;
<div class="note">&#13;
<p class="notet"><span class="notes"><strong>NOTE</strong></span></p>&#13;
<p class="notep"><em>The</em> <code><span class="codeitalic">Array</code></span> <em>object includes three more methods that create a different type of array:</em> <code><span class="codeitalic">SetValue()</code></span>, <code><span class="codeitalic">GetValue()</code></span>, <em>and</em> <code><span class="codeitalic">RemoveValue()</code></span><em>. Although these methods work well, the bracketed style of array is more universal among programming languages and is the reason this book focuses on that style.</em></p>&#13;
</div>&#13;
<h3 class="h3a" id="ch16lev1sec05"><span class="blues"><strong>Programming Challenges</strong></span></h3>&#13;
<p class="noindent">If you get stuck, check out <em><a href="http://nostarch.com/smallbasic/">http://nostarch.com/smallbasic/</a></em> for the solutions and for more resources and review questions for teachers and students.</p>&#13;
<ol>&#13;
<li><p class="noindenta">Write a program that keeps track of your friends’ phone numbers. Use an associative array that uses your friends’ names as keys; for example, <code>phone["Yoda"] = "555-1138"</code>.</p></li>&#13;
<li><p class="noindenta">Write a program that saves book information. The key is the ISBN of the book. For each book, you need to know the title, the author, and the publication year. Use three associative arrays: <code>title[ISBN]</code>, <code>author[ISBN]</code>, and <code>year[ISBN]</code>.</p></li>&#13;
<li><p class="noindenta">Open the file <em>VirtualPiano.sb</em> from this chapter’s folder. The program implements a virtual piano using the keyboard. Explain how the program works.<span epub:type="pagebreak" id="page_240"/></p></li>&#13;
</ol>&#13;
</body></html>