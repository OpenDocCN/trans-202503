["```\nR> dbinom(18,size=20,prob=0.07) + dbinom(19,size=20,prob=0.07) +\n   dbinom(20,size=20,prob=0.07)\n[1] 2.69727e-19\n```", "```\nR> snacks <- c(87.7,80.01,77.28,78.76,81.52,74.2,80.71,79.5,77.87,81.94,80.7,\n               82.32,75.78,80.19,83.91,79.4,77.52,77.62,81.4,74.89,82.95,\n               73.59,77.92,77.18,79.83,81.23,79.28,78.44,79.01,80.47,76.23,\n               78.89,77.14,69.94,78.54,79.7,82.45,77.29,75.52,77.21,75.99,\n               81.94,80.41,77.7)\n```", "```\nR> n <- length(snacks)\nR> snack.mean <- mean(snacks)\nR> snack.mean\n[1] 78.91068\nR> snack.sd <- sd(snacks)\nR> snack.sd\n[1] 3.056023\n```", "```\nR> snack.se <- snack.sd/sqrt(n)\nR> snack.se\n[1] 0.4607128\n```", "```\nR> snack.T <- (snack.mean-80)/snack.se\nR> snack.T\n[1] -2.364419\n```", "```\nR> pt(snack.T,df=n-1)\n[1] 0.01132175\n```", "```\nR> snack.mean+c(-1,1)*qt(0.975,n-1)*snack.se\n[1] 77.98157 79.83980\n```", "```\nR> t.test(x=snacks,mu=80,alternative=\"less\")\n\n        One Sample t-test\n\ndata:  snacks\nt = -2.3644, df = 43, p-value = 0.01132\nalternative hypothesis: true mean is less than 80\n95 percent confidence interval:\n     -Inf 79.68517\nsample estimates:\nmean of x\n 78.91068\n```", "```\nR> t.test(x=snacks,mu=80,alternative=\"two.sided\")$conf.int\n[1] 77.98157 79.83980\nattr(,\"conf.level\")\n[1] 0.95\n```", "```\nR> snacks2 <- c(80.22,79.73,81.1,78.76,82.03,81.66,80.97,81.32,80.12,78.98,\n                79.21,81.48,79.86,81.06,77.96,80.73,80.34,80.01,81.82,79.3,\n                79.08,79.47,78.98,80.87,82.24,77.22,80.03,79.2,80.95,79.17,81)\n```", "```\nR> snack2.mean <- mean(snacks2)\nR> snack2.mean\n[1] 80.1571\nR> snack2.sd <- sd(snacks2)\nR> snack2.sd\n[1] 1.213695\n```", "```\nR> t.test(x=snacks2,y=snacks,alternative=\"greater\",conf.level=0.9)\n\n        Welch Two Sample t-test\n\ndata:  snacks2 and snacks\nt = 2.4455, df = 60.091, p-value = 0.008706\nalternative hypothesis: true difference in means is greater than 0\n90 percent confidence interval:\n 0.5859714       Inf\nsample estimates:\nmean of x mean of y\n 80.15710  78.91068\n```", "```\nR> (snack2.mean-snack.mean) +\n   c(-1,1)*qt(0.95,df=60)*sqrt(snack.sd^2/44+snack2.sd^2/31)\n[1] 0.3949179 2.0979120\n```", "```\nR> snack.sd/snack2.sd\n[1] 2.51795\n```", "```\nR> men <- c(102,87,101,96,107,101,91,85,108,67,85,82)\nR> women <- c(73,81,111,109,143,95,92,120,93,89,119,79,90,126,62,92,77,106,\n              105,111)\n```", "```\nR> mean(men)\n[1] 92.66667\nR> sd(men)\n[1] 12.0705\nR> mean(women)\n[1] 98.65\nR> sd(women)\n[1] 19.94802\n```", "```\nR> sd(women)/sd(men)\n[1] 1.652626\n```", "```\nR> t.test(x=men,y=women,alternative=\"two.sided\",conf.level=0.95,var.equal=TRUE)\n\n        Two Sample t-test\ndata:  men and women\nt = -0.9376, df = 30, p-value = 0.3559\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -19.016393   7.049727\nsample estimates:\nmean of x mean of y\n 92.66667  98.65000\n```", "```\nR> rate.before <- c(52,66,89,87,89,72,66,65,49,62,70,52,75,63,65,61)\nR> rate.after <- c(51,66,71,73,70,68,60,51,40,57,65,53,64,56,60,59)\n```", "```\nR> rate.d <- rate.after-rate.before\nR> rate.d\n [1]  -1   0 -18 -14 -19  -4  -6 -14  -9  -5  -5   1 -11  -7  -5  -2\n```", "```\nR> rate.dbar <- mean(rate.d)\nR> rate.dbar\n[1] -7.4375\nR> rate.sd <- sd(rate.d)\nR> rate.sd\n[1] 6.196437\n```", "```\nR> rate.T <- rate.dbar/(rate.sd/sqrt(16))\nR> rate.T\n[1] -4.801146\nR> pt(rate.T,df=15)\n[1] 0.000116681\n```", "```\nR> t.test(x=rate.after,y=rate.before,alternative=\"less\",conf.level=0.95,\n          paired=TRUE)\n\n        Paired t-test\n\ndata:  rate.after and rate.before\nt = -4.8011, df = 15, p-value = 0.0001167\nalternative hypothesis: true difference in means is less than 0\n95 percent confidence interval:\n      -Inf -4.721833\nsample estimates:\nmean of the differences\n                -7.4375\n```", "```\nR> rate.dbar-qt(0.975,df=15)*(rate.sd/sqrt(16))\n[1] -10.73935\n```", "```\nR> rate.dbar+qt(0.975,df=15)*(rate.sd/sqrt(16))\n[1] -4.135652\n```", "```\nsick <- c(0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,1,1,1,0,0,0,1)\n```", "```\nR> sum(sick)\n[1] 8\nR> p.hat <- mean(sick)\nR> p.hat\n[1] 0.2758621\n```", "```\nR> 29*0.2\n[1] 5.8\nR> 29*0.8\n[1] 23.2\n```", "```\nR> Z <- (p.hat-0.2)/sqrt(0.2*0.8/29)\nR> Z\n[1] 1.021324\n```", "```\nR> 2*(1-pnorm(Z))\n[1] 0.3071008\n```", "```\nR> p.hat+c(-1,1)*qnorm(0.975)*sqrt(p.hat*(1-p.hat)/29)\n[1] 0.1131927 0.4385314\n```", "```\nR> prop.test(x=sum(sick),n=length(sick),p=0.2,correct=FALSE)\n\n        1-sample proportions test without continuity correction\n\ndata:  sum(sick) out of length(sick), null probability 0.2\nX-squared = 1.0431, df = 1, p-value = 0.3071\nalternative hypothesis: true p is not equal to 0.2\n95 percent confidence interval:\n 0.1469876 0.4571713\nsample estimates:\n        p\n0.2758621\n```", "```\nR> x1 <- 180\nR> n1 <- 233\nR> p.hat1 <- x1/n1\nR> p.hat1\n[1] 0.7725322\nR> x2 <- 175\nR> n2 <- 197\nR> p.hat2 <- x2/n2\nR> p.hat2\n[1] 0.8883249\n```", "```\nR> p.star <- (x1+x2)/(n1+n2)\nR> p.star\n[1] 0.8255814\n```", "```\nR> Z <- (p.hat2-p.hat1)/sqrt(p.star*(1-p.star)*(1/n1+1/n2))\nR> Z\n[1] 3.152693\n```", "```\nR> 1-pnorm(Z)\n[1] 0.0008088606\n```", "```\nR> prop.test(x=c(x2,x1),n=c(n2,n1),alternative=\"greater\",correct=FALSE)\n\n   2-sample test for equality of proportions without continuity correction\n\ndata:  c(x2, x1) out of c(n2, n1)\nX-squared = 9.9395, df = 1, p-value = 0.0008089\nalternative hypothesis: greater\n95 percent confidence interval:\n 0.05745804 1.00000000\nsample estimates:\n   prop 1    prop 2\n0.8883249 0.7725322\n```", "```\nR> (p.hat2-p.hat1) +\n   c(-1,1)*qnorm(0.975)*sqrt(p.hat1*(1-p.hat1)/n1+p.hat2*(1-p.hat2)/n2)\n[1] 0.04628267 0.18530270\n```", "```\nR> hairy <- c(2,3,2,3,2,1,3,3,2,2,3,2,2,2,3,3,3,2,3,2,2,2,1,3,2,2,2,1,2,2,3,\n              2,2,2,2,1,2,1,1,1,2,2,2,3,1,2,1,2,1,2,1,3,3)\n```", "```\nR> x <- seq(0,20,length=100)\nR> plot(x,dchisq(x,df=1),type=\"l\",xlim=c(0,15),ylim=c(0,0.5),ylab=\"density\")\nR> lines(x,dchisq(x,df=5),lty=2)\nR> lines(x,dchisq(x,df=10),lty=3)\nR> abline(h=0,col=\"gray\")\nR> abline(v=0,col=\"gray\")\nR> legend(\"topright\",legend=c(\"df=1\",\"df=5\",\"df=10\"),lty=1:3)\n```", "```\nR> n <- length(hairy)\nR> n\n[1] 53\nR> hairy.tab <- table(hairy)\nR> hairy.tab\nhairy\n 1  2  3\n11 28 14\nR> hairy.tab/n\nhairy\n        1         2         3\n0.2075472 0.5283019 0.2641509\n```", "```\nR> expected <- 1/3*n\nR> expected\n[1] 17.66667\nR> hairy.matrix <- cbind(1:3,hairy.tab,expected,\n                         (hairy.tab-expected)^2/expected)\nR> dimnames(hairy.matrix) <- list(c(\"clean\",\"beard OR mous.\",\n                                    \"beard AND mous.\"),\n                                  c(\"i\",\"Oi\",\"Ei\",\"(Oi-Ei)^2/Ei\"))\nR> hairy.matrix\n                i Oi       Ei (Oi-Ei)^2/Ei\nclean           1 11 17.66667    2.5157233\nbeard OR mous.  2 28 17.66667    6.0440252\nbeard AND mous. 3 14 17.66667    0.7610063\n```", "```\nR> X2 <- sum(hairy.matrix[,4])\nR> X2\n[1] 9.320755\n```", "```\nR> 1-pchisq(X2,df=2)\n[1] 0.009462891\n```", "```\nR> chisq.test(x=hairy.tab)\n\n        Chi-squared test for given probabilities\n\ndata:  hairy.tab\nX-squared = 9.3208, df = 2, p-value = 0.009463\n```", "```\nR> chisq.test(x=hairy.tab,p=c(0.25,0.5,0.25))\n\n        Chi-squared test for given probabilities\n\ndata:  hairy.tab\nX-squared = 0.5094, df = 2, p-value = 0.7751\n```", "```\nR> skin <- matrix(c(20,32,8,52,9,72,8,32,16,64,30,12),4,3,\n                  dimnames=list(c(\"Injection\",\"Tablet\",\"Laser\",\"Herbal\"),\n                  c(\"None\",\"Partial\",\"Full\")))\nR> skin\n          None Partial Full\nInjection   20       9   16\nTablet      32      72   64\nLaser        8       8   30\nHerbal      52      32   12\n```", "```\nR> kr <- nrow(skin)\nR> kc <- ncol(skin)\n```", "```\nR> rowSums(skin)\nInjection    Tablet    Laser    Herbal\n       45       168       46        96\nR> colSums(skin)\n   None Partial    Full\n    112     121     122\n```", "```\nR> rep(colSums(skin),each=kr)\n   None    None    None    None Partial Partial Partial Partial    Full\n    112     112     112     112     121     121     121     121     122\n   Full    Full    Full\n    122     122     122\nR> rep(colSums(skin),each=kr)*rowSums(skin)\n   None    None    None    None Partial Partial Partial Partial   Full\n   5040   18816    5152   10752    5445   20328    5566   11616   5490\n   Full    Full    Full\n  20496    5612   11712\nR> rep(colSums(skin),each=kr)*rowSums(skin)/sum(skin)\n    None     None     None     None  Partial  Partial  Partial  Partial\n14.19718 53.00282 14.51268 30.28732 15.33803 57.26197 15.67887 32.72113\n    Full     Full     Full     Full\n15.46479 57.73521 15.80845 32.99155\nR> skin.expected <- matrix(rep(colSums(skin),each=kr)*rowSums(skin)/sum(skin),\n                           nrow=kr,ncol=kc,dimnames=dimnames(skin))\nR> skin.expected\n              None  Partial     Full\nInjection 14.19718 15.33803 15.46479\nTablet    53.00282 57.26197 57.73521\nLaser     14.51268 15.67887 15.80845\nHerbal    30.28732 32.72113 32.99155\n```", "```\nR> skin.array <- array(data=cbind(skin,skin.expected,\n                                  (skin-skin.expected)^2/skin.expected),\n                       dim=c(kr,kc,3),\n                       dimnames=list(dimnames(skin)[[1]],dimnames(skin)[[2]],\n                                     c(\"O[i,j]\",\"E[i,j]\",\n                                       \"(O[i,j]-E[i,j])^2/E[i,j]\")))\nR> skin.array\n, , O[i,j]\n\n          None Partial Full\nInjection   20       9   16\nTablet      32      72   64\nLaser        8       8   30\nHerbal      52      32   12\n\n, , E[i,j]\n\n              None  Partial     Full\nInjection 14.19718 15.33803 15.46479\nTablet    53.00282 57.26197 57.73521\nLaser     14.51268 15.67887 15.80845\nHerbal    30.28732 32.72113 32.99155\n\n, , (O[i,j]-E[i,j])^2/E[i,j]\n\n                None   Partial        Full\nInjection   2.371786 2.6190199  0.01852279\nTablet      8.322545 3.7932587  0.67978582\nLaser       2.922614 3.7607992 12.74002590\nHerbal     15.565598 0.0158926 13.35630339\n```", "```\nR> X2 <- sum(skin.array[,,3])\nR> X2\n[1] 66.16615\n```", "```\nR> 1-pchisq(X2,df=(kr-1)*(kc-1))\n[1] 2.492451e-12\n```", "```\nR> chisq.test(x=skin)\n\n        Pearson's Chi-squared test\n\ndata:  skin\nX-squared = 66.1662, df = 6, p-value = 2.492e-12\n```", "```\ntypeI.tester <- function(mu0,sigma,n,alpha,ITERATIONS=10000){\n    pvals <- rep(NA,ITERATIONS)\n    for(i in 1:ITERATIONS){\n        temporary.sample <- rnorm(n=n,mean=mu0,sd=sigma)\n        temporary.mean <- mean(temporary.sample)\n        temporary.sd <- sd(temporary.sample)\n        pvals[i] <- 1-pt((temporary.mean-mu0)/(temporary.sd/sqrt(n)),df=n-1)\n    }\n    return(mean(pvals<alpha))\n}\n```", "```\nR> typeI.tester(mu0=0,sigma=1,n=40,alpha=0.05)\n[1] 0.0489\n```", "```\nR> typeI.tester(mu0=-4,sigma=0.3,n=60,alpha=0.01)\n[1] 0.0108\n```", "```\nR> critval <- qnorm(1-0.05,mean=0,sd=1/sqrt(30))\nR> critval\n[1] 0.3003078\n```", "```\nR> pnorm(critval,mean=0.5,sd=1/sqrt(30))\n[1] 0.1370303\n```", "```\ntypeII.tester <- function(mu0,muA,sigma,n,alpha,ITERATIONS=10000){\n    pvals <- rep(NA,ITERATIONS)\n    for(i in 1:ITERATIONS){\n        temporary.sample <- rnorm(n=n,mean=muA,sd=sigma)\n        temporary.mean <- mean(temporary.sample)\n        temporary.sd <- sd(temporary.sample)\n        pvals[i] <- 1-pt((temporary.mean-mu0)/(temporary.sd/sqrt(n)),df=n-1)\n    }\n    return(mean(pvals>=alpha))\n}\n```", "```\nR> typeII.tester(mu0=0,muA=0.5,sigma=1,n=30,alpha=0.05)\n[1] 0.1471\n```", "```\nR> typeII.tester(mu0=0,muA=0.5,sigma=1,n=30,alpha=0.01)\n[1] 0.3891\n```", "```\nR> typeII.tester(mu0=0,muA=0.5,sigma=1.1,n=30,alpha=0.01)\n[1] 0.4815\nR> typeII.tester(mu0=0,muA=0.5,sigma=1.2,n=30,alpha=0.01)\n[1] 0.5501\n```", "```\nR> typeII.tester(mu0=0,muA=0.5,sigma=1.2,n=20,alpha=0.01)\n[1] 0.7319\nR> typeII.tester(mu0=0,muA=0.5,sigma=1.2,n=40,alpha=0.01)\n[1] 0.4219\n```", "```\nR> typeII.tester(mu0=0,muA=0.4,sigma=1.2,n=40,alpha=0.01)\n[1] 0.6147\nR> typeII.tester(mu0=0,muA=0.6,sigma=1.2,n=40,alpha=0.01)\n[1] 0.2287\n```", "```\npower.tester <- function(nvec,...){\n    nlen <- length(nvec)\n    result <- rep(NA,nlen)\n    pbar <- txtProgressBar(min=0,max=nlen,style=3)\n    for(i in 1:nlen){\n        result[i] <- 1-typeII.tester(n=nvec[i],...)\n        setTxtProgressBar(pbar,i)\n    }\n    close(pbar)\n    return(result)\n}\n```", "```\nR> sample.sizes <- 5:100\n```", "```\nR> pow <- power.tester(nvec=sample.sizes,\n                       mu0=0,muA=0.6,sigma=1.2,alpha=0.01,ITERATIONS=5000)\n  |====================================================================| 100%\nR> pow\n [1] 0.0630 0.0752 0.1018 0.1226 0.1432 0.1588 0.1834 0.2162 0.2440 0.2638\n[11] 0.2904 0.3122 0.3278 0.3504 0.3664 0.3976 0.4232 0.4478 0.4680 0.4920\n[21] 0.5258 0.5452 0.5552 0.5616 0.5916 0.6174 0.6326 0.6438 0.6638 0.6844\n[31] 0.6910 0.7058 0.7288 0.7412 0.7552 0.7718 0.7792 0.7950 0.8050 0.8078\n[41] 0.8148 0.8316 0.8480 0.8524 0.8600 0.8702 0.8724 0.8800 0.8968 0.8942\n[51] 0.8976 0.9086 0.9116 0.9234 0.9188 0.9288 0.9320 0.9378 0.9370 0.9448\n[61] 0.9436 0.9510 0.9534 0.9580 0.9552 0.9648 0.9656 0.9658 0.9684 0.9756\n[71] 0.9742 0.9770 0.9774 0.9804 0.9806 0.9804 0.9806 0.9854 0.9848 0.9844\n[81] 0.9864 0.9886 0.9890 0.9884 0.9910 0.9894 0.9906 0.9930 0.9926 0.9938\n[91] 0.9930 0.9946 0.9948 0.9942 0.9942 0.9956\n```", "```\nR> minimum.n <- sample.sizes[min(which(pow>=0.8))]\nR> minimum.n\n[1] 43\n```", "```\nR> pow2 <- power.tester(nvec=sample.sizes,\n                        mu0=0,muA=0.6,sigma=1.2,alpha=0.05,ITERATIONS=5000)\n  |====================================================================| 100%\nR> minimum.n2 <- sample.sizes[min(which(pow2>0.8))]\nR> minimum.n2\n[1] 27\n```", "```\nR> plot(sample.sizes,pow,xlab=\"sample size n\",ylab=\"simulated power\")\nR> points(sample.sizes,pow2,col=\"gray\")\nR> abline(h=0.8,lty=2)\nR> abline(v=c(minimum.n,minimum.n2),lty=3,col=c(\"black\",\"gray\"))\nR> legend(\"bottomright\",legend=c(\"alpha=0.01\",\"alpha=0.05\"),\n          col=c(\"black\",\"gray\"),pch=1)\n```"]