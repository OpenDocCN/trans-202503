<html><head></head><body><div class="chapter" title="Chapter&#xA0;9.&#xA0;Cisco IOS On UNIX and NX-OSv"><div class="titlepage"><div><div><h1 class="title"><a id="cisco_ios_on_unix_and_nx-osv"/>Chapter 9. Cisco IOS On UNIX and NX-OSv</h1></div></div></div><p><a id="iddle1322" class="indexterm"/><a id="iddle1627" class="indexterm"/>In this chapter, I’ll discuss strategies for installing and integrating Cisco IOU devices with GNS3. You’ll also learn how to install and run Cisco’s next-generation switch operating system (NX-OS) using VirtualBox and NX-OSv.</p><div class="sect1" title="Cisco IOU"><div class="titlepage"><div><div><h1 class="title"><a id="cisco_iou"/>Cisco IOU</h1></div></div></div><p>Cisco IOU is one of the cooler things to happen to the Cisco education community in a long time. IOU functions similarly to Dynamips but uses far fewer resources. Like Dynamips, IOU allows you to add routers and switches to your GNS3 projects. Unlike Dynamips, IOU images emulate the features of an IOS technology train rather than the hardware component of a particular Cisco model. Each IOU image file is a self-contained binary application that runs an instance of a device. There are images <a id="iddle1153" class="indexterm"/><a id="iddle1414" class="indexterm"/><a id="iddle1619" class="indexterm"/><a id="iddle1629" class="indexterm"/><a id="iddle2186" class="indexterm"/>designed for routing, switching, voice over IP (VoIP), and Pagent (for generating IP traffic). IOU doesn’t require a hypervisor to emulate Cisco hardware, often making IOU devices less memory hungry and CPU intensive than Dynamips devices. The obvious advantage here is that you can create larger topologies on a modestly configured PC.</p><p>In 2010, Cisco integrated IOU into the Cisco Learning Network to provide online virtual labs for CCNA and CCNP students. The labs are inexpensive and well designed. If you’re interested in Cisco Learning Labs, you should check out the Cisco Learning Center (<span class="emphasis"><em><a class="ulink" href="http://learningnetwork.cisco.com/">http://learningnetwork.cisco.com/</a></em></span>).</p><p>As the name implies, IOS on Unix runs only on Unix-based systems. Sometimes referred to as IOS on Linux (IOL), it was developed on Solaris Unix and Linux.</p><div class="sect2" title="What IOU Means to GNS3"><div class="titlepage"><div><div><h2 class="title"><a id="what_iou_means_to_gns3"/>What IOU Means to GNS3</h2></div></div></div><p>After Cisco announced it was moving away from industry-standard hardware in favor of proprietary integrated service router (ISR) hardware, the GNS3 community wondered whether the end of Dynamips and GNS3 had arrived. Without access to the technical specifications for the new proprietary hardware, it would be impossible to create a new hypervisor required to run the latest IOS software. Eventually, the old Dynamips devices would stop getting IOS updates and become obsolete.</p><p>Cisco actually keeps IOS current for the 7200 series routers that GNS3 uses, but all other GNS3 routers stop cold at IOS release 12.4(15)T, which imposes limits on learning modern technologies such as VoIP. This is why IOU is exciting. It breathes new life into GNS3 by allowing you to integrate updated IOS technologies into your GNS3 projects—and that’s pretty cool!</p></div><div class="sect2" title="Switching, Switching, and More Switching!"><div class="titlepage"><div><div><h2 class="title"><a id="switchingcomma_switchingcomma_and_more_s"/>Switching, Switching, and More Switching!</h2></div></div></div><p>One of the best reasons to integrate IOU into GNS3 is that you can use many of Cisco’s advanced switching features, which are missing from the NM-16ESW module in Dynamips (refer to <a class="xref" href="apc.html" title="Appendix C. NM-16ESW and IOU L2 Limitations">Appendix C</a>). These features allow GNS3 to step up its game and become an all-inclusive training tool for more advanced certifications like CCIE.</p><p>With IOU, you no longer have to purchase physical switches and create a breakout switch or use funny little tricks like ISL bridging to access real switches. Using a GNS3 EtherSwitch router, it’s now possible to create a regular 802.1Q trunk link from your Dynamips switches to an IOU switch block running on your PC. IOU switches are stable, run fast, and, unlike physical switches, are completely portable, which means they can travel with you on a laptop as part of your GNS3 projects.</p></div><div class="sect2" title="IOU Images"><div class="titlepage"><div><div><h2 class="title"><a id="iou_images"/>IOU Images</h2></div></div></div><p><a id="iddle1496" class="indexterm"/><a id="iddle1616" class="indexterm"/><a id="iddle1625" class="indexterm"/><a id="iddle1631" class="indexterm"/><a id="iddle1633" class="indexterm"/><a id="iddle1750" class="indexterm"/><a id="iddle1811" class="indexterm"/><a id="iddle1921" class="indexterm"/><a id="iddle2333" class="indexterm"/>IOU images are designed around IOS features, and their filenames often reveal what features they include, much like IOS image filenames. For example, let’s break down the filename of an IOU switch named <span class="emphasis"><em>I86BI_LINUXL2-UPK9-M-15.0</em></span>.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p title="I86BI"><span class="title"><strong><span class="strong"><strong>I86BI</strong></span></strong></span>. Indicates this is an Intel 32-bit binary image.</p></li><li class="listitem"><p title="LINUX"><span class="title"><strong><span class="strong"><strong>LINUX</strong></span></strong></span>. Indicates it runs on Linux.</p></li><li class="listitem"><p title="L2"><span class="title"><strong><span class="strong"><strong>L2</strong></span></strong></span>. Indicates it’s an L2/L3 switch.</p></li><li class="listitem"><p title="UPK9"><span class="title"><strong><span class="strong"><strong>UPK9</strong></span></strong></span>. Indicates the image contains advanced cryptographic features such as 3DES/AES.</p></li><li class="listitem"><p title="M"><span class="title"><strong><span class="strong"><strong>M</strong></span></strong></span>. Indicates it’s a mainline IOS.</p></li><li class="listitem"><p title="15.0"><span class="title"><strong><span class="strong"><strong>15.0</strong></span></strong></span>. Specifies the IOS version the image is based on.</p></li></ul></div><p>Using this information, you should be able to look at almost any IOU filename to quickly determine what features it includes.</p></div><div class="sect2" title="Things to Know Before Installing IOU"><div class="titlepage"><div><div><h2 class="title"><a id="things_to_know_before_installing_iou"/>Things to Know Before Installing IOU</h2></div></div></div><p>By default, a standard GNS3 installation doesn’t allow you to run IOU devices. IOU devices are Linux binary files, so they can be run using a Linux operating system only. Typically, images are 32-bit binary files, but with the proper library files, you can easily run them on 64-bit Linux systems. If you’re running GNS3 on Windows or OS X, you have to install a virtualization program like VirtualBox and run your IOU devices using a Linux virtual machine. Fortunately, GNS3 provides an IOU virtual machine that you can download from the GNS3 website. The GNS3 IOU virtual machine is ready to run IOU images, provides an easy way for you to upload your images, and doesn’t require that you know how to use Linux commands.</p><p>The upside to running GNS3 in Linux is that installing and configuring IOU is more straightforward, and everything should run seamlessly without extra configuration. The downside is that you have to know a little something about Linux, but in my opinion, that’s a small price to pay. When you run GNS3 on Windows or OS X, you have to configure it to communicate with the Linux virtual machine over TCP/IP, which can be a pain to manage. If your workstation or IOU virtual machine’s IP addresses change (which often happens), you’ll have to reconfigure GNS3 to use the new IP addresses. Also, when you upgrade GNS3, you have to upgrade the GNS3 server software that runs on the IOU virtual machine. The version numbers must be identical, or IOU will not run. These steps are unnecessary when you run both GNS3 and IOU on Linux.</p></div></div><div class="sect1" title="Setting Up IOU on a Linux PC"><div class="titlepage"><div><div><h1 class="title"><a id="setting_up_iou_on_a_linux_pc"/>Setting Up IOU on a Linux PC</h1></div></div></div><p><a id="iddle1532" class="indexterm"/><a id="iddle1620" class="indexterm"/><a id="iddle1715" class="indexterm"/><a id="iddle1740" class="indexterm"/><a id="iddle1944" class="indexterm"/><a id="iddle2192" class="indexterm"/><a id="iddle2271" class="indexterm"/><a id="iddle2413" class="indexterm"/>There are some distinct advantages to running GNS3 and IOU on a Linux PC. The big one is that you don’t need to use an IOU virtual machine because on Linux IOU image files run natively. This means you don’t have to give up precious resources, such as CPU cycles and memory, that would be taken by the IOU virtual machine. Another advantage is that you can use Wireshark to capture and monitor packets between two IOU devices, which you can’t do when using the IOU virtual machine. This is because the .<span class="emphasis"><em>pcap</em></span> capture file, which is created when you start a Wireshark capture, is saved on the IOU virtual machine and not locally, so Wireshark cannot access the file.</p><p>If you’re running GNS3 on Linux, follow the instructions in this section to get IOU up and running. Otherwise, skip ahead to <a class="xref" href="ch09.html#using_the_gns3_iou_virtual_machine_on_wi" title="Using the GNS3 IOU Virtual Machine on Windows and OS X">Using the GNS3 IOU Virtual Machine on Windows and OS X</a>.</p><div class="sect2" title="Installing IOU"><div class="titlepage"><div><div><h2 class="title"><a id="installing_iou"/>Installing IOU</h2></div></div></div><p>When you run an IOU image, the image looks for the file <span class="emphasis"><em>libcrypto.so.4</em></span> and won’t run without it. Although a libcrypto library file may already be installed on your system, you should install <span class="emphasis"><em>libssl1.0.0</em></span> because this version is proven to be stable with IOU images. Next, create a symbolic link (sym-link) from <span class="emphasis"><em>libcrypto.so.1.0.0</em></span> to <span class="emphasis"><em>libcrypto.so.4</em></span>; a symlink is the Linux equivalent of a Windows shortcut. If you’re using a 32-bit version of Ubuntu, install libcrypto using the following commands:</p><a id="pro_id00132"/><pre class="programlisting">$ <span class="strong"><strong>sudo apt-get install libssl1.0.0</strong></span>
$ <span class="strong"><strong>sudo ln -s /lib/i386-linux-gnu/libcrypto.so.1.0.0 /lib/libcrypto.so.4</strong></span></pre><p>When running a 64-bit Ubuntu system, you’ll need to install the 32-bit libssl package before you can configure libcrypto and run a 32-bit IOU image. If you have a 32-bit Ubuntu system, you can disregard the next commands.</p><a id="pro_id00133"/><pre class="programlisting">$ <span class="strong"><strong>sudo apt-get install libssl1.0.0:i386</strong></span>
$ <span class="strong"><strong>sudo ln -s /lib/i386-linux-gnu/libcrypto.so.1.0.0 /lib/i386-linux-gnu/</strong></span>
<span class="strong"><strong>libcrypto.so.4</strong></span></pre><p>If you’re not running Ubuntu, then you may need to do a little research to configure libcrypto on your system because not all Linux systems use the same library files and versions or even store the files in the same directories as Ubuntu. The key is that the libcrypto file must be symlinked to <span class="emphasis"><em>libcrypto.so.4</em></span>.</p><p>After you’ve configured <span class="emphasis"><em>libcrypto.so.4</em></span>, copy one or more IOU image files to your Ubuntu system. You have to make the IOU files executable before they’ll run; here’s how:</p><a id="pro_id00134"/><pre class="programlisting">$ <span class="strong"><strong>sudo chmod 555 I86BI_LINUXL2-UPK9-M-15.0.bin</strong></span></pre><p><a id="iddle1067" class="indexterm"/><a id="iddle1379" class="indexterm"/><a id="iddle1514" class="indexterm"/><a id="iddle1622" class="indexterm"/><a id="iddle1641" class="indexterm"/><a id="iddle1716" class="indexterm"/><a id="iddle1746" class="indexterm"/>Next, install the dependencies for the GNS3 iouyap application. This program is responsible for setting up communication between IOU and other GNS3 devices, like Dynamips routers. Begin by installing bison and flex, two packages that are needed before iouyap can compile.</p><a id="pro_id00135"/><pre class="programlisting">$ <span class="strong"><strong>sudo apt-get install bison</strong></span>
$ <span class="strong"><strong>sudo apt-get install flex</strong></span></pre><p>Now, install and compile the iniparser program using the following commands:</p><a id="pro_id00136"/><pre class="programlisting">$ <span class="strong"><strong>sudo apt-get install git</strong></span>
$ <span class="strong"><strong>git clone http://github.com/ndevilla/iniparser.git</strong></span>
$ <span class="strong"><strong>cd iniparser</strong></span>
$ <span class="strong"><strong>make</strong></span>
$ <span class="strong"><strong>sudo cp libiniparser.* /usr/lib/</strong></span>
$ <span class="strong"><strong>sudo cp src/iniparser.h /usr/local/include</strong></span>
$ <span class="strong"><strong>sudo cp src/dictionary.h /usr/local/include</strong></span></pre><p>A ZIP file containing iouyap should have been included in your GNS3 for Linux download. Unzip <span class="emphasis"><em>iouyap-&lt;x&gt;.zip</em></span>, replacing <span class="emphasis"><em>&lt;x&gt;</em></span> with the version you have, and compile the program using the following commands:</p><a id="pro_id00137"/><pre class="programlisting">$ <span class="strong"><strong>cd iouyap-x</strong></span>
$ <span class="strong"><strong>sudo make</strong></span>
$ <span class="strong"><strong>sudo make install</strong></span></pre><p>If necessary, copy the compiled application to the <span class="emphasis"><em>/usr/local/bin</em></span> directory.</p><a id="pro_id00138"/><pre class="programlisting">$ <span class="strong"><strong>sudo copy iouyap /usr/local/bin</strong></span></pre><p>Now that all the applications are installed, you need to do some configuration.</p></div><div class="sect2" title="Creating a License File"><div class="titlepage"><div><div><h2 class="title"><a id="creating_a_license_file"/>Creating a License File</h2></div></div></div><p>Before running IOU, you have to create a license file that contains the hostname of your PC and a valid license key. The license key is generated from your Linux hostname, so make sure you’re satisfied with your PC’s hostname. If you change your hostname, you’ll need to enter a new license key.</p><p>Once you have obtained a license key, use a text editor to create the license file. I usually name my file .<span class="emphasis"><em>iourc</em></span>, but any name will do. The following is an example of a license file for a PC named Ubuntu using the license key 1234567812345678. The hostname is case sensitive, so take care when entering it in the license file.</p><a id="pro_id00139"/><pre class="programlisting">[license]
Ubuntu = 1234567812345678</pre><p><a id="iddle1028" class="indexterm"/><a id="iddle1030" class="indexterm"/><a id="iddle1209" class="indexterm"/><a id="iddle1237" class="indexterm"/><a id="iddle1403" class="indexterm"/><a id="iddle1461" class="indexterm"/><a id="iddle1581" class="indexterm"/><a id="iddle1609" class="indexterm"/><a id="iddle1642" class="indexterm"/><a id="iddle1730" class="indexterm"/><a id="iddle1937" class="indexterm"/><a id="iddle1939" class="indexterm"/><a id="iddle2127" class="indexterm"/><a id="iddle2280" class="indexterm"/>If you’re unsure what your Linux host is named, you can use the <code class="literal">hostname</code> command from your terminal to display the name.</p></div><div class="sect2" title="Configuring GNS3"><div class="titlepage"><div><div><h2 class="title"><a id="configuring_gns3"/>Configuring GNS3</h2></div></div></div><p>Next, set the path to the iouyap application and your IOU license file in the IOS on UNIX preferences. The iouyap application is used to bridge Dynamips, and other GNS3 devices, with IOU devices so that all your devices can be seamlessly networked together. Select <span class="strong"><strong>Edit</strong></span> ▸ <span class="strong"><strong>Preferences</strong></span> and then select <span class="strong"><strong>IOS on UNIX</strong></span> from the left menu, as shown in <a class="xref" href="ch09.html#ios_on_unix_preferencescomma_general_set" title="Figure 9-1. IOS on UNIX preferences, General settings tab">Figure 9-1</a>.</p><div class="figure"><a id="ios_on_unix_preferencescomma_general_set"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00121"/><img src="httpatomoreillycomsourcenostarchimages2209111.png.jpg" alt="IOS on UNIX preferences, General settings tab"/></div></div><p class="title">Figure 9-1. IOS on UNIX preferences, General settings tab</p></div><p>On the General settings tab, set the path and name of your license file in Path to IOURC. This refers to the IOU license file you created earlier. Also, set the file path to your <span class="emphasis"><em>iouyap</em></span> file in Path to iouyap, typically <span class="emphasis"><em>/usr/ local/bin/iouyap</em></span>. Next, go to the Server settings tab, shown in <a class="xref" href="ch09.html#ios_on_unix_preferencescomma_server_sett" title="Figure 9-2. IOS on UNIX preferences, Server settings tab">Figure 9-2</a>.</p><p>Select the <span class="strong"><strong>Always use the local server (Linux only)</strong></span> checkbox so that IOU uses the local PC for GNS3 and IOU integration. Then, go to the Advanced settings tab, shown in <a class="xref" href="ch09.html#ios_on_unix_preferencescomma_advanced_se" title="Figure 9-3. IOS on UNIX preferences, Advanced settings tab">Figure 9-3</a>.</p><p>Each IOU device is assigned a unique console port number within the defined range. Don’t change these values unless the range conflicts with other IP-based applications running on your PC; the same is true for the UDP tunneling port range. UDP ports are used to set up network communication between IOU and other GNS3 devices.</p><div class="figure"><a id="ios_on_unix_preferencescomma_server_sett"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00122"/><img src="httpatomoreillycomsourcenostarchimages2209113.png.jpg" alt="IOS on UNIX preferences, Server settings tab"/></div></div><p class="title">Figure 9-2. IOS on UNIX preferences, Server settings tab</p></div><div class="figure"><a id="ios_on_unix_preferencescomma_advanced_se"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00123"/><img src="httpatomoreillycomsourcenostarchimages2209115.png.jpg" alt="IOS on UNIX preferences, Advanced settings tab"/></div></div><p class="title">Figure 9-3. IOS on UNIX preferences, Advanced settings tab</p></div><p><a id="iddle2128" class="indexterm"/><a id="iddle2281" class="indexterm"/><a id="iddle1497" class="indexterm"/><a id="iddle1638" class="indexterm"/><a id="iddle1855" class="indexterm"/>Finally, expand <span class="strong"><strong>IOS on UNIX</strong></span> in the left menu of the Preferences window to display the IOU devices section, shown in <a class="xref" href="ch09.html#adding_iou_images_to_gns3" title="Figure 9-4. Adding IOU images to GNS3">Figure 9-4</a>. From here, you can add one or more IOU image files to GNS3.</p><div class="figure"><a id="adding_iou_images_to_gns3"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00124"/><img src="httpatomoreillycomsourcenostarchimages2209117.png.jpg" alt="Adding IOU images to GNS3"/></div></div><p class="title">Figure 9-4. Adding IOU images to GNS3</p></div><p>To add an IOU image file to GNS3, click the <span class="strong"><strong>New</strong></span> button to start the New IOU device wizard, shown in <a class="xref" href="ch09.html#new_iou_device_wizard" title="Figure 9-5. New IOU device wizard">Figure 9-5</a>.</p><div class="figure"><a id="new_iou_device_wizard"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00125"/><img src="httpatomoreillycomsourcenostarchimages2209119.png.jpg" alt="New IOU device wizard"/></div></div><p class="title">Figure 9-5. New IOU device wizard</p></div><p><a id="iddle1013" class="indexterm"/><a id="iddle1373" class="indexterm"/><a id="iddle1405" class="indexterm"/><a id="iddle1462" class="indexterm"/><a id="iddle1511" class="indexterm"/><a id="iddle1608" class="indexterm"/><a id="iddle1615" class="indexterm"/><a id="iddle1624" class="indexterm"/><a id="iddle1720" class="indexterm"/><a id="iddle1852" class="indexterm"/><a id="iddle1884" class="indexterm"/>Enter a name for your new device (<span class="emphasis"><em>IOU_L2</em></span> in this example); then click the <span class="strong"><strong>Browse</strong></span> button to locate and select your IOU image file. When you’re done, click <span class="strong"><strong>Finish</strong></span> to complete the wizard. Once added, your IOU image file should be copied to your GNS3 user directory under <span class="emphasis"><em>GNS3/images/IOU</em></span>.</p><p>To configure an IOU device, drag an IOU device icon from the Devices toolbar to your workspace. Right-click the device and choose <span class="strong"><strong>Configure</strong></span> to open the Node configurator (shown in <a class="xref" href="ch09.html#iou_node_configurator" title="Figure 9-6. IOU Node configurator">Figure 9-6</a>).</p><div class="figure"><a id="iou_node_configurator"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00126"/><img src="httpatomoreillycomsourcenostarchimages2209121.png.jpg" alt="IOU Node configurator"/></div></div><p class="title">Figure 9-6. IOU Node configurator</p></div><p>The options on the General settings tab allow you to rename your device and change the IOU image file, console port number, and default RAM and NVRAM values.</p><p>You can change the number of Ethernet and serial adapters installed by adjusting the values on the Network tab. The default is two of each adapter, but they provide four interfaces each, giving you a total of eight Ethernet and eight serial interfaces. This should be plenty for most projects, but you can easily adjust the quantity to meet your needs. The total combined number of adapters (Ethernet and serial) can’t exceed 16, for a total of 64 interfaces per IOU device.</p><p>An IOU device can be linked to any other GNS3 device, just as you would a standard Dynamips router or switch. You can even <span class="emphasis"><em>hot-link</em></span> them to devices, meaning links can be formed between the devices after they’re started.</p><p>To export an IOU configuration, enter <span class="strong"><strong><code class="literal">copy running-config unix:initial -config.cfg</code></strong></span> from the IOU console and then right-click the IOU device in your workspace and select <span class="strong"><strong>Export config</strong></span>. You will then be prompted for a filename and location, where the file will be saved. You can import a configuration by selecting <span class="strong"><strong>Import config</strong></span> instead.</p><p>If you want to run IOU in Windows or OS X, read the next section. If not, you can skip ahead to <a class="xref" href="ch09.html#nx-osv" title="NX-OSv">NX-OSv</a>.</p></div></div><div class="sect1" title="Using the GNS3 IOU Virtual Machine on Windows and OS X"><div class="titlepage"><div><div><h1 class="title"><a id="using_the_gns3_iou_virtual_machine_on_wi"/>Using the GNS3 IOU Virtual Machine on Windows and OS X</h1></div></div></div><p><a id="iddle1425" class="indexterm"/><a id="iddle1506" class="indexterm"/><a id="iddle1634" class="indexterm"/><a id="iddle1637" class="indexterm"/><a id="iddle1812" class="indexterm"/><a id="iddle1906" class="indexterm"/><a id="iddle1922" class="indexterm"/><a id="iddle1931" class="indexterm"/><a id="iddle2334" class="indexterm"/><a id="iddle2358" class="indexterm"/>As I mentioned in <a class="xref" href="ch09.html#things_to_know_before_installing_iou" title="Things to Know Before Installing IOU">Things to Know Before Installing IOU</a>, Windows and OS X systems can run IOU only using a Linux virtual machine. If you haven’t done so already, download and install VirtualBox (<span class="emphasis"><em><a class="ulink" href="https://www.virtualbox.org/">https://www.virtualbox.org/</a></em></span>). Accepting the default installation settings should provide everything you need for running an IOU virtual machine.</p><p>After installing VirtualBox, visit the GNS3 website (<span class="emphasis"><em><a class="ulink" href="http://www.gns3.com/">http://www.gns3.com/</a></em></span>) and download the OVA file named <span class="emphasis"><em>GNS3 IOU VM.ova</em></span>. This is a Linux virtual machine that’s been preconfigured with all the tools you need to run IOU, but it doesn’t include any IOU image files. Instead, it provides a web-based utility that allows you to easily upload your image files to the appliance, but you’ll need to import the appliance into VirtualBox before you can use it.</p><div class="sect2" title="Importing the GNS3 IOU Virtual Machine into VirtualBox"><div class="titlepage"><div><div><h2 class="title"><a id="importing_the_gns3_iou_virtual_machine_i"/>Importing the GNS3 IOU Virtual Machine into VirtualBox</h2></div></div></div><p>Start by launching the VirtualBox application. After the application loads, select <span class="strong"><strong>File</strong></span> ▸ <span class="strong"><strong>Import Appliance</strong></span>. You should be presented with the Import Virtual Appliance dialog, shown in <a class="xref" href="ch09.html#select_the_virtual_appliance" title="Figure 9-7. Select the virtual appliance.">Figure 9-7</a>.</p><div class="figure"><a id="select_the_virtual_appliance"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00127"/><img src="httpatomoreillycomsourcenostarchimages2209123.png.jpg" alt="Select the virtual appliance."/></div></div><p class="title">Figure 9-7. Select the virtual appliance.</p></div><p>Use the browse icon to locate and select the <span class="emphasis"><em>GNS3 IOU VM.ova</em></span> file. In <a class="xref" href="ch09.html#select_the_virtual_appliance" title="Figure 9-7. Select the virtual appliance.">Figure 9-7</a>, my virtual machine is located in my <span class="emphasis"><em>Downloads</em></span> directory, <span class="emphasis"><em>C:\Users\jneumann\Downloads</em></span>. Once you select the file, click <span class="strong"><strong>Next</strong></span> and verify the appliance settings. They should look similar to <a class="xref" href="ch09.html#virtual_appliance_settings" title="Figure 9-8. Virtual Appliance settings">Figure 9-8</a>.</p><div class="figure"><a id="virtual_appliance_settings"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00128"/><img src="httpatomoreillycomsourcenostarchimages2209125.png.jpg" alt="Virtual Appliance settings"/></div></div><p class="title">Figure 9-8. Virtual Appliance settings</p></div><p><a id="iddle1014" class="indexterm"/><a id="iddle1075" class="indexterm"/><a id="iddle1785" class="indexterm"/><a id="iddle1840" class="indexterm"/><a id="iddle2045" class="indexterm"/>You should be able to accept the suggested appliance settings. Notice that the default RAM setting is 2048MB. I’ve found that the RAM can be reduced to 1024MB if you’re using only a couple of IOU devices in your projects. Doing so reduces the overall amount of memory used in your PC and may help GNS3 perform better if you’re strapped for resources. If you’re unsure, then just accept the defaults and click <span class="strong"><strong>Import</strong></span> to complete the import. You can always modify the settings later.</p><p>After importing the virtual machine, click <span class="strong"><strong>Settings</strong></span> and then click <span class="strong"><strong>Network</strong></span> to access the Network pane, shown in <a class="xref" href="ch09.html#bridge_the_network_adapter_to_your_pc" title="Figure 9-9. Bridge the network adapter to your PC.">Figure 9-9</a>.</p><div class="figure"><a id="bridge_the_network_adapter_to_your_pc"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00129"/><img src="httpatomoreillycomsourcenostarchimages2209127.png.jpg" alt="Bridge the network adapter to your PC."/></div></div><p class="title">Figure 9-9. Bridge the network adapter to your PC.</p></div><p><a id="iddle1498" class="indexterm"/><a id="iddle1617" class="indexterm"/><a id="iddle1632" class="indexterm"/><a id="iddle2290" class="indexterm"/>From the Adapter 1 tab, select the <span class="strong"><strong>Enable Network Adapter</strong></span> option. Then, choose <span class="strong"><strong>Bridged Adapter</strong></span> next to the Attached to field. When you’re finished, click <span class="strong"><strong>OK</strong></span>. This bridges your virtual machine’s Ethernet adapter to your PC and allows it to access the Internet so you can install additional packages, if needed.</p></div><div class="sect2" title="Uploading IOU Image Files"><div class="titlepage"><div><div><h2 class="title"><a id="uploading_iou_image_files"/>Uploading IOU Image Files</h2></div></div></div><p>Now that you’ve imported the GNS3 IOU virtual machine, you should be able to run the virtual machine and upload your IOU image files. To power on the virtual machine, select <span class="strong"><strong>GNS3 IOU VM</strong></span>, as in <a class="xref" href="ch09.html#select_and_start_your_gns3_iou_virtual_m" title="Figure 9-10. Select and start your GNS3 IOU virtual machine.">Figure 9-10</a>, and click <span class="strong"><strong>Start</strong></span>.</p><div class="figure"><a id="select_and_start_your_gns3_iou_virtual_m"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00130"/><img src="httpatomoreillycomsourcenostarchimages2209129.png.jpg" alt="Select and start your GNS3 IOU virtual machine."/></div></div><p class="title">Figure 9-10. Select and start your GNS3 IOU virtual machine.</p></div><p>It’s normal for the virtual machine to take a minute or two to start because it’s booting a fully functional Linux OS. After the virtual machine is up and running, a console message similar to the following should be displayed on the screen:</p><a id="pro_id00140"/><pre class="programlisting">Welcome to GNS3 IOU appliance
Use 172.16.231.204 to configure a remote server in GNS3 Preferences
Use your browser with http://172.16.231.204:8000/upload to upload IOS images

gns3-iouvm login:</pre><p><a id="iddle1210" class="indexterm"/><a id="iddle1490" class="indexterm"/><a id="iddle1610" class="indexterm"/><a id="iddle1623" class="indexterm"/><a id="iddle1652" class="indexterm"/><a id="iddle1717" class="indexterm"/><a id="iddle2403" class="indexterm"/>Notice that the screen instructs you to use your PC’s web browser to upload IOU image files to the appliance. For this to work, your PC and the GNS3 IOU virtual machine must each have an IP address assigned from your local network. In this example, my virtual machine’s IP address is 172.16.231.204.</p><div class="note" title="Note"><h3 class="title"><a id="ch09note01"/>Note</h3><p><span class="emphasis"><em>Sometimes the IOU virtual machine may not display the IP address. In that case, log on to the virtual machine using the username</em></span> root <span class="emphasis"><em>and the password</em></span> cisco. <span class="emphasis"><em>Then enter</em></span> <span class="bolditalic"><code class="literal">ifconfig eth0</code></span> <span class="emphasis"><em>to display the IP address of your virtual machine’s Ethernet interface.</em></span></p></div><p>To upload an IOU image file, open your web browser and browse to the IP address, using port 8000 as instructed. After entering the URL (<span class="emphasis"><em><a class="ulink" href="http://172.16.231.204:8000/upload">http://172.16.231.204:8000/upload</a></em></span> in this example), you should be presented with a web page like the one in <a class="xref" href="ch09.html#select_and_upload_your_iou_image_filesdo" title="Figure 9-11. Select and upload your IOU image files.">Figure 9-11</a>.</p><div class="figure"><a id="select_and_upload_your_iou_image_filesdo"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00131"/><img src="httpatomoreillycomsourcenostarchimages2209131.png.jpg" alt="Select and upload your IOU image files."/></div></div><p class="title">Figure 9-11. Select and upload your IOU image files.</p></div><p>Use the <span class="strong"><strong>Browse...</strong></span> button to select an IOU image file from your PC. Once selected, click <span class="strong"><strong>upload</strong></span> to complete the process. Repeat this step for each image you want to use with GNS3 and your IOU license file. Images are stored on the IOU virtual machine under <span class="emphasis"><em>/home/gns3/GNS3/images</em></span>, and the path is displayed on the web page for later reference. You’ll need this information when you configure your IOU images in GNS3, so it’s a good idea to highlight and copy the full path and filename now. That way, you won’t have to type it later.</p></div><div class="sect2" title="Configuring GNS3 for IOU"><div class="titlepage"><div><div><h2 class="title"><a id="configuring_gns3_for_iou"/>Configuring GNS3 for IOU</h2></div></div></div><p>Now that IOU is ready, you just have to prepare GNS3. First, create a plaintext license file on your PC using the hostname <span class="emphasis"><em>gns3-iouvm</em></span>, as in the following example. Replace 1234567812345678 with your license number.</p><a id="pro_id00141"/><pre class="programlisting">[license]
gns3-iouvm = 1234567812345678</pre><p><a id="iddle1404" class="indexterm"/><a id="iddle1427" class="indexterm"/><a id="iddle1582" class="indexterm"/><a id="iddle1635" class="indexterm"/><a id="iddle1653" class="indexterm"/><a id="iddle1938" class="indexterm"/><a id="iddle2055" class="indexterm"/><a id="iddle2335" class="indexterm"/>A common name that’s often used for the IOU license file is .<span class="emphasis"><em>iourc</em></span>, but you can use any name that makes sense to you (for example, you might call it <span class="emphasis"><em>iou-license.txt</em></span>), and the license file can be stored anywhere on your system.</p><p>After you’ve created the license file, you’re ready to configure the GNS3 preferences for IOU. Launch GNS3, select <span class="strong"><strong>Edit</strong></span> ▸ <span class="strong"><strong>Preferences</strong></span> on Windows or <span class="strong"><strong>GNS3</strong></span> ▸ <span class="strong"><strong>Preferences</strong></span> on OS X, and select <span class="strong"><strong>GNS3 server</strong></span>, as shown in <a class="xref" href="ch09.html#gns3_server_preferencescomma_remote_serv" title="Figure 9-12. GNS3 server preferences, Remote servers tab">Figure 9-12</a>.</p><div class="figure"><a id="gns3_server_preferencescomma_remote_serv"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00132"/><img src="httpatomoreillycomsourcenostarchimages2209133.png.jpg" alt="GNS3 server preferences, Remote servers tab"/></div></div><p class="title">Figure 9-12. GNS3 server preferences, Remote servers tab</p></div><p>Select the Remote servers tab. Under Host ➊ enter the IP address of your GNS3 IOU virtual machine, click <span class="strong"><strong>Add</strong></span>, and then click <span class="strong"><strong>Apply</strong></span>. In this example, the IP address of my GNS3 IOU virtual machine is 172.16.231.204.</p><p>Next, tell GNS3 where to find the IOU license file. Click <span class="strong"><strong>IOS on UNIX</strong></span> from the pane on the left and select the General settings tab, shown in <a class="xref" href="ch09.html#ios_on_unix_preferencescomma_gen-id00019" title="Figure 9-13. IOS on UNIX preferences, General settings tab">Figure 9-13</a>.</p><p>Click the <span class="strong"><strong>Browse...</strong></span> button to the right of the Path to IOURC field to locate your license file. Select the file and then click <span class="strong"><strong>Add</strong></span> and <span class="strong"><strong>Apply</strong></span>. In this example, the path to my license file is <span class="emphasis"><em>C:\Users\jneumann\GNS3\iourc_license.txt</em></span>.</p><div class="figure"><a id="ios_on_unix_preferencescomma_gen-id00019"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00133"/><img src="httpatomoreillycomsourcenostarchimages2209135.png.jpg" alt="IOS on UNIX preferences, General settings tab"/></div></div><p class="title">Figure 9-13. IOS on UNIX preferences, General settings tab</p></div><p><a id="iddle1499" class="indexterm"/><a id="iddle1618" class="indexterm"/><a id="iddle1639" class="indexterm"/><a id="iddle1856" class="indexterm"/>Next, expand <span class="strong"><strong>IOS on UNIX</strong></span> in the pane on the left to display IOU devices, as shown in <a class="xref" href="ch09.html#iou_devices_preferences" title="Figure 9-14. IOU devices preferences">Figure 9-14</a>.</p><p>The final configuration step is to add the path to an IOU image file. Select the <span class="strong"><strong>IOS devices</strong></span> preference and click <span class="strong"><strong>New</strong></span> to start the wizard. Under Server type, make sure there’s a check next to <span class="strong"><strong>Remote</strong></span> and click <span class="strong"><strong>Next</strong></span>. A message about choosing a path to your image should appear; click <span class="strong"><strong>OK</strong></span>, and you should see the New IOU device window, shown in <a class="xref" href="ch09.html#new_iou_device_window" title="Figure 9-15. New IOU device window">Figure 9-15</a>.</p><p>Enter a name for your IOU device (<span class="emphasis"><em>IOU_L2</em></span>, for example) and then enter the IOU image path. Because IOU images are installed on the Linux virtual machine, you’ll have to enter the “Linux pathname” to your image file. That path is <span class="emphasis"><em>/home/gns3/GNS3/images/&lt;image_name&gt;</em></span>. In this example I’ve entered <span class="emphasis"><em>/home/gns3/GNS3/images/i86bi-linux-l2-adventerprisek9-15.1a.bin</em></span>. You can find this information on the IOU web page that you used to upload your image files (refer to <a class="xref" href="ch09.html#select_and_upload_your_iou_image_filesdo" title="Figure 9-11. Select and upload your IOU image files.">Figure 9-11</a>). Be careful to enter the path and filename correctly; otherwise, IOU won’t work. I recommend copying and pasting the information directly from the IOU virtual machine web page to avoid any confusion.</p><div class="figure"><a id="iou_devices_preferences"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00134"/><img src="httpatomoreillycomsourcenostarchimages2209137.png.jpg" alt="IOU devices preferences"/></div></div><p class="title">Figure 9-14. IOU devices preferences</p></div><div class="figure"><a id="new_iou_device_window"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00135"/><img src="httpatomoreillycomsourcenostarchimages2209139.png.jpg" alt="New IOU device window"/></div></div><p class="title">Figure 9-15. New IOU device window</p></div><p><a id="iddle1640" class="indexterm"/><a id="iddle1857" class="indexterm"/>When you’re finished, click <span class="strong"><strong>Finish</strong></span> to close the wizard and then click <span class="strong"><strong>Apply</strong></span> and <span class="strong"><strong>OK</strong></span> to complete the configuration. Once you’ve added an IOU image, you’re ready to start using IOU devices in your projects.</p><p><a id="iddle1422" class="indexterm"/><a id="iddle1628" class="indexterm"/><a id="iddle1630" class="indexterm"/><a id="iddle1636" class="indexterm"/><a id="iddle1978" class="indexterm"/><a id="iddle2095" class="indexterm"/><a id="iddle2187" class="indexterm"/><a id="iddle2288" class="indexterm"/><a id="iddle2336" class="indexterm"/><a id="iddle2379" class="indexterm"/>If you upgrade GNS3 to a new version, you also have to upgrade the server on your GNS3 IOU virtual machine to the same version, or it won’t work. To upgrade the server, log on to the GNS3 IOU virtual machine and enter the following commands, replacing <span class="emphasis"><em><code class="literal">version</code></em></span> with your version of GNS3:</p><a id="pro_id00142"/><pre class="programlisting">Login: <span class="strong"><strong>root</strong></span>
Password: <span class="strong"><strong>cisco</strong></span>
# <span class="strong"><strong>pip3 install gns3-server==<span class="emphasis"><em>version</em></span></strong></span></pre></div><div class="sect2" title="IOU in Action"><div class="titlepage"><div><div><h2 class="title"><a id="iou_in_action"/>IOU in Action</h2></div></div></div><p>Now let’s create a simple project that allows an IOU switch to route TCP/IP traffic between two VLANs. Start by creating the project shown in <a class="xref" href="ch09.html#vlan_routing_using_an_iou_switch" title="Figure 9-16. VLAN routing using an IOU switch">Figure 9-16</a>.</p><div class="figure"><a id="vlan_routing_using_an_iou_switch"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00136"/><img src="httpatomoreillycomsourcenostarchimages2209141.png.jpg" alt="VLAN routing using an IOU switch"/></div></div><p class="title">Figure 9-16. VLAN routing using an IOU switch</p></div><p>In this project, you’ll configure an IOU L2 switch with two VLANs (VLAN 10 and VLAN 20). Then you’ll assign router R1 to VLAN 10 and router R2 to VLAN 20. In this lab, the IOU switch will route packets between the two VLANs so that R1 and R2 can ping each other. Start by configuring the IOU1 switch as follows:</p><a id="pro_id00143"/><pre class="programlisting">  IOU1# <span class="strong"><strong>configure terminal</strong></span>
➊ IOU1(config)# <span class="strong"><strong>ip routing</strong></span>
➋ IOU1(config)# <span class="strong"><strong>vlan 10</strong></span>
  IOU1(config-vlan)# <span class="strong"><strong>vlan 20</strong></span>
➌ IOU1(config-vlan)# <span class="strong"><strong>interface vlan 10</strong></span>
➍ IOU1(config-if)# <span class="strong"><strong>ip address 192.168.1.1 255.255.255.0</strong></span>
➎ IOU1(config-if)# <span class="strong"><strong>no shutdown</strong></span>
  IOU1(config-if)# <span class="strong"><strong>interface vlan 20</strong></span>
  IOU1(config-if)# <span class="strong"><strong>ip address 192.168.2.1 255.255.255.0</strong></span>
  IOU1(config-if)# <span class="strong"><strong>no shutdown</strong></span>
➏ IOU1(config)# <span class="strong"><strong>interface Ethernet 0/0</strong></span>
➐ IOU1(config-if)# <span class="strong"><strong>switchport mode access</strong></span>
➑ IOU1(config-if)# <span class="strong"><strong>switchport access vlan 10</strong></span>
  IOU1(config-if)# <span class="strong"><strong>no shutdown</strong></span>
  IOU1(config-if)# <span class="strong"><strong>interface Ethernet 0/1</strong></span>
  IOU1(config-if)# <span class="strong"><strong>switchport mode access</strong></span>
  IOU1(config-if)# <span class="strong"><strong>switchport access vlan 20</strong></span>
  IOU1(config-if)# <span class="strong"><strong>no shutdown</strong></span></pre><p><a id="iddle1657" class="indexterm"/><a id="iddle1874" class="indexterm"/><a id="iddle1898" class="indexterm"/><a id="iddle1963" class="indexterm"/><a id="iddle2172" class="indexterm"/><a id="iddle2374" class="indexterm"/>Enable IP routing ➊ and then create the two VLANs (10 and 20) using the <code class="literal">vlan</code> command ➋. Next, create a switched virtual interface (SVI) ➌ for each VLAN and assign each SVI an IP address ➍. Use the <code class="literal">no shutdown</code> command ➎ to bring up the interface. Now go under the physical interfaces ➏ that are connected to R1 and R2, make them access ports ➐, and assign them to the appropriate VLAN ➑.</p><p>Next, configure an IP address on router R1.</p><a id="pro_id00144"/><pre class="programlisting">R1(config)# <span class="strong"><strong>interface f0/0</strong></span>
R1(config-if)# <span class="strong"><strong>ip address 192.168.1.100 255.255.255.0</strong></span>
R1(config-if)# <span class="strong"><strong>no shutdown</strong></span>
R1(config-if)# <span class="strong"><strong>ip route 0.0.0.0 0.0.0.0 192.168.1.1</strong></span></pre><p>After assigning the IP address to F0/0 on R1, set the default gateway address to 192.168.1.1 so that the router will use IOU1 for its gateway. Finally, configure R2 in a similar manner.</p><a id="pro_id00145"/><pre class="programlisting">R2(config)# <span class="strong"><strong>interface f0/0</strong></span>
R2(config-if)# <span class="strong"><strong>ip address 192.168.2.100 255.255.255.0</strong></span>
R2(config-if)# <span class="strong"><strong>no shutdown</strong></span>
R2(config-if)# <span class="strong"><strong>ip route 0.0.0.0 0.0.0.0 192.168.2.1</strong></span></pre><p>After configuring the project, you can test VLAN routing using the <code class="literal">ping</code> command. Router R1 should be able to ping router R2 through the IOU1 switch, as in the following:</p><a id="pro_id00146"/><pre class="programlisting">R1# <span class="strong"><strong>ping 192.168.2.100</strong></span>

Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 192.168.1.100, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 16/24/32 ms</pre><p>That’s all it takes to get IOU devices up and running with GNS3. Now let’s take a look at Cisco’s newest operating system, NX-OS.</p></div></div><div class="sect1" title="NX-OSv"><div class="titlepage"><div><div><h1 class="title"><a id="nx-osv"/>NX-OSv</h1></div></div></div><p>Cisco NX-OS runs on a data-center class of switches known as Nexus. Though similar to IOS, NX-OS is not IOS and uses a different set of configuration commands. NX-OSv, sometimes called Titanium, is a Linux virtual machine that runs an NX-OS simulator using virtualization software, like <a id="iddle1254" class="indexterm"/><a id="iddle1502" class="indexterm"/><a id="iddle1512" class="indexterm"/><a id="iddle1786" class="indexterm"/><a id="iddle1896" class="indexterm"/><a id="iddle1897" class="indexterm"/><a id="iddle2356" class="indexterm"/>VirtualBox. NX-OSv is not a complete OS simulation, and it’s missing a lot of functionality. It provides just enough features and commands to give you a feel for how NX-OS works, and it can be networked to GNS3 devices. After you’ve acquired an NX-OSv image, make a copy and keep it in a safe place in case your working copy gets corrupted in some way.</p><p>Create a directory for NX-OSv under your GNS3 directory and copy the NX-OSv image file there. You should have a file named <span class="emphasis"><em>N7K.vmdk</em></span>. Your filename may be different depending on your version of NX-OSv. With your image file in place, it’s time to get NX-OSv wired up in VirtualBox.</p><div class="sect2" title="Importing NX-OSv into VirtualBox"><div class="titlepage"><div><div><h2 class="title"><a id="importing_nx-osv_into_virtualbox"/>Importing NX-OSv into VirtualBox</h2></div></div></div><p>NX-OSv usually comes ready to run in the form of a single virtual machine hard disk file (.<span class="emphasis"><em>vmdk</em></span> file), and you can run it using VMware, VirtualBox, or QEMU. VirtualBox is free and runs NX-OSv reliably, even on PCs with older processors such as the Core 2 Duo, so I’ll cover VirtualBox here. Configuration consists of importing the hard disk image file into a custom Linux virtual machine and adjusting a couple of settings. If you don’t have VirtualBox installed on your PC, download and install it now.</p><p>Launch VirtualBox and click <span class="strong"><strong>New</strong></span> to create a new virtual machine. You should be presented with the Create Virtual Machine wizard, shown in <a class="xref" href="ch09.html#create_virtual_machine_wizardcomma_name" title="Figure 9-17. Create Virtual Machine wizard, Name and operating system window">Figure 9-17</a>.</p><div class="figure"><a id="create_virtual_machine_wizardcomma_name"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00137"/><img src="httpatomoreillycomsourcenostarchimages2209143.png.jpg" alt="Create Virtual Machine wizard, Name and operating system window"/></div></div><p class="title">Figure 9-17. Create Virtual Machine wizard, Name and operating system window</p></div><p>Enter a name for the device, set Type to <span class="strong"><strong>Linux</strong></span> and Version to <span class="strong"><strong>Other Linux (64-bit)</strong></span>, and then click <span class="strong"><strong>Next</strong></span> to continue. You should be presented with the Memory size window, shown in <a class="xref" href="ch09.html#create_virtual_machine_wizardcomma_memor" title="Figure 9-18. Create Virtual Machine wizard, Memory size window">Figure 9-18</a>.</p><p>To adjust the memory size, use the slider or enter the amount in the field provided. NX-OSv runs best with 2048MB of RAM. When you’re done, click <span class="strong"><strong>Next</strong></span> to configure the hard drive settings, shown in <a class="xref" href="ch09.html#create_virtual_machine_wizardcomma_hard" title="Figure 9-19. Create Virtual Machine wizard, Hard drive window">Figure 9-19</a>.</p><div class="figure"><a id="create_virtual_machine_wizardcomma_memor"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00138"/><img src="httpatomoreillycomsourcenostarchimages2209145.png.jpg" alt="Create Virtual Machine wizard, Memory size window"/></div></div><p class="title">Figure 9-18. Create Virtual Machine wizard, Memory size window</p></div><div class="figure"><a id="create_virtual_machine_wizardcomma_hard"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00139"/><img src="httpatomoreillycomsourcenostarchimages2209147.png.jpg" alt="Create Virtual Machine wizard, Hard drive window"/></div></div><p class="title">Figure 9-19. Create Virtual Machine wizard, Hard drive window</p></div><p><a id="iddle1157" class="indexterm"/><a id="iddle1203" class="indexterm"/><a id="iddle1448" class="indexterm"/><a id="iddle1723" class="indexterm"/><a id="iddle1895" class="indexterm"/><a id="iddle2227" class="indexterm"/><a id="iddle2262" class="indexterm"/><a id="iddle2372" class="indexterm"/>To attach the NX-OS virtual hard drive to your virtual machine, select <span class="strong"><strong>Use an existing virtual hard drive file</strong></span> and click the browse icon to locate your NX-OSv .<span class="emphasis"><em>vmdk</em></span> file. Select the file and click <span class="strong"><strong>Create</strong></span> to finish creating the virtual machine.</p></div><div class="sect2" title="Configuring GNS3 for NX-OSv"><div class="titlepage"><div><div><h2 class="title"><a id="configuring_gns3_for_nx-osv"/>Configuring GNS3 for NX-OSv</h2></div></div></div><p>Start GNS3 and add the NX-OSv virtual machine to your virtual machine library. Select <span class="strong"><strong>Edit</strong></span> ▸ <span class="strong"><strong>Preferences</strong></span> and expand <span class="strong"><strong>VirtualBox</strong></span> to show VirtualBox virtual machines, as shown in <a class="xref" href="ch09.html#adding_the_nx-osv_virtualbox_virtual_mac" title="Figure 9-20. Adding the NX-OSv VirtualBox virtual machine to GNS3">Figure 9-20</a>. From here you can add VirtualBox virtual machines to GNS3, which is the last step before you can use NX-OSv.</p><div class="figure"><a id="adding_the_nx-osv_virtualbox_virtual_mac"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00140"/><img src="httpatomoreillycomsourcenostarchimages2209149.png.jpg" alt="Adding the NX-OSv VirtualBox virtual machine to GNS3"/></div></div><p class="title">Figure 9-20. Adding the NX-OSv VirtualBox virtual machine to GNS3</p></div><p><a id="iddle1336" class="indexterm"/><a id="iddle1899" class="indexterm"/><a id="iddle1992" class="indexterm"/><a id="iddle2088" class="indexterm"/>Click <span class="strong"><strong>New</strong></span> to start the VirtualBox wizard, select your NX-OSv virtual machine from the virtual machine name drop-down menu, and click <span class="strong"><strong>Finish</strong></span>. Now click <span class="strong"><strong>Edit</strong></span> and navigate to the General settings tab. Select the <span class="strong"><strong>Enable remote console</strong></span> and <span class="strong"><strong>Start VM in headless mode</strong></span> boxes and click <span class="strong"><strong>Apply</strong></span>. Under the Network tab, change the number of interfaces from 1 to 6, and click <span class="strong"><strong>Apply</strong></span> to close the window. Then click <span class="strong"><strong>Apply</strong></span> and <span class="strong"><strong>OK</strong></span> to complete the installation. To use a NX-OSv virtual machine in your projects, drag your NX-OSv virtual machine from the End devices toolbar to your workspace.</p></div><div class="sect2" title="NX-OSv in Action"><div class="titlepage"><div><div><h2 class="title"><a id="nx-osv_in_action"/>NX-OSv in Action</h2></div></div></div><p>Now that you have the NX-OSv device added to GNS3, let’s use it in a project. Create a topology that includes one NX-OSv device and one IOS router, as shown in <a class="xref" href="ch09.html#simple_topology_using_nx-osv" title="Figure 9-21. Simple topology using NX-OSv">Figure 9-21</a>. This project will advertise all 172.16.0.0 networks from R1 to NX-OSv using Cisco EIGRP.</p><div class="figure"><a id="simple_topology_using_nx-osv"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00141"/><img src="httpatomoreillycomsourcenostarchimages2209151.png.jpg" alt="Simple topology using NX-OSv"/></div></div><p class="title">Figure 9-21. Simple topology using NX-OSv</p></div><p><a id="iddle1193" class="indexterm"/><a id="iddle1194" class="indexterm"/><a id="iddle2113" class="indexterm"/>After you create the project, start all your devices and open a console connection to NX-OSv. NX-OS running on a PC takes a long time to boot and often hangs for a minute at the <code class="literal">SCSI disk detected</code> message, displayed in <a class="xref" href="ch09.html#booting_nx-osv" title="Figure 9-22. Booting NX-OSv">Figure 9-22</a>. This is normal, so be patient while it starts.</p><div class="figure"><a id="booting_nx-osv"/><div class="figure-contents"><div class="mediaobject"><a id="med_id00142"/><img src="httpatomoreillycomsourcenostarchimages2209153.png.jpg" alt="Booting NX-OSv"/></div></div><p class="title">Figure 9-22. Booting NX-OSv</p></div><p>If you don’t see the boot messages, you may have misconfigured something. Go back and check all your settings in VirtualBox and GNS3. If you continue to have problems, there may be something wrong with your <span class="emphasis"><em>N7K.vmdk</em></span> image file.</p><p>After the system starts, you should be presented with a login prompt, like the one shown here:</p><a id="pro_id00147"/><pre class="programlisting">User Access verification
vNX-OS-01 login:</pre><p>The default login and password should be <code class="literal">admin</code> and <code class="literal">admin</code>. Use these credentials to log on to NX-OSv. This is a good time to enter a few commands. I would start with <code class="literal">show run</code>, <code class="literal">show version</code>, and <code class="literal">show interface brief</code>, <a id="iddle1116" class="indexterm"/><a id="iddle1171" class="indexterm"/><a id="iddle1218" class="indexterm"/><a id="iddle1337" class="indexterm"/><a id="iddle1654" class="indexterm"/><a id="iddle1959" class="indexterm"/>but you can try any IOS commands you’re familiar with. Some will be the same on NX-OS; others will not. You can use the question mark (<code class="literal">?</code>) to display a complete list.</p><p>Now that you’ve taken a peek at NX-OSv, you can configure your project. First, you’ll configure router R1. Open a console on router R1 and enter the following commands to configure all the IP addresses for the project:</p><a id="pro_id00148"/><pre class="programlisting">R1# <span class="strong"><strong>configure terminal</strong></span>
R1(config)# <span class="strong"><strong>interface f0/0</strong></span>
R1(config-if)# <span class="strong"><strong>no shutdown</strong></span>
R1(config-if)# <span class="strong"><strong>ip address 10.1.1.1 255.255.255.0</strong></span>
R1(config-if)# <span class="strong"><strong>interface loopback1</strong></span>
R1(config-if)# <span class="strong"><strong>ip address 172.16.1.1 255.255.255.0</strong></span>
R1(config-if)# <span class="strong"><strong>interface loopback2</strong></span>
R1(config-if)# <span class="strong"><strong>ip address 172.16.2.1 255.255.255.0</strong></span>
R1(config-if)# <span class="strong"><strong>interface loopback3</strong></span>
R1(config-if)# <span class="strong"><strong>ip address 172.16.3.1 255.255.255.0</strong></span></pre><p>Next, enable EIGRP and advertise all the IP networks.</p><a id="pro_id00149"/><pre class="programlisting">R1(config-if)# <span class="strong"><strong>router eigrp 10</strong></span>
R1(config-router)# <span class="strong"><strong>no auto-summary</strong></span>
R1(config-router)# <span class="strong"><strong>network 10.0.0.0</strong></span>
R1(config-router)# <span class="strong"><strong>network 172.16.0.0</strong></span></pre><p>Now log on to NX-OSv and configure an IP address from the same subnet as R1’s interface f0/0.</p><a id="pro_id00150"/><pre class="programlisting">vNX-OS-01# <span class="strong"><strong>configure terminal</strong></span>
vNX-OS-01(config)# <span class="strong"><strong>interface ethernet 2/1</strong></span>
vNX-OS-01(config-if)# <span class="strong"><strong>ip address 10.1.1.2/24</strong></span>
vNX-OS-01(config-if)# <span class="strong"><strong>no shutdown</strong></span></pre><p>The first thing you should notice is that NX-OS only accepts IP addresses using CIDR notation, so here, the subnet mask is entered as <code class="literal">/24</code> and not <code class="literal">255.255.255.0</code> as commonly used in IOS. Now use the <code class="literal">ping</code> command to test connectivity from NX-OSv to router R1 and exit to configuration mode.</p><a id="pro_id00151"/><pre class="programlisting">vNX-OS-01(config-if)# <span class="strong"><strong>do ping 10.1.1.1</strong></span>
PING 192.168.1.1 (110.1.1.1): 56 data bytes
64 bytes from 10.1.1.1: icmp_seq=0 ttl=254 time=19.494 ms
64 bytes from 10.1.1.1: icmp_seq=1 ttl=254 time=7.849 ms
64 bytes from 10.1.1.1: icmp_seq=2 ttl=254 time=7.511 ms
64 bytes from 10.1.1.1: icmp_seq=3 ttl=254 time=20.637 ms
64 bytes from 10.1.1.1: icmp_seq=4 ttl=254 time=8.524 ms

--- 10.1.1.1 ping statistics ---
5 packets transmitted, 5 packets received, 0.00% packet loss
round-trip min/avg/max = 7.511/12.803/20.637 ms
vNX-OS-01(config-if)# <span class="strong"><strong>exit</strong></span></pre><p><a id="iddle1338" class="indexterm"/><a id="iddle1437" class="indexterm"/><a id="iddle1718" class="indexterm"/><a id="iddle1960" class="indexterm"/><a id="iddle2142" class="indexterm"/>Now let’s configure NX-OSv so that it can exchange EIGRP advertised routes with router R1. Note that NX-OS allows you to run EIGRP only for a grace period of 120 days, unless you have a feature license. Enter the <code class="literal">license grace-period</code> command to start the grace period.</p><a id="pro_id00152"/><pre class="programlisting">vNX-OS-01(config)# <span class="strong"><strong>license grace-period</strong></span>
vNX-OS-01(config)# <span class="strong"><strong>feature eigrp</strong></span>
vNX-OS-01(config)# <span class="strong"><strong>router eigrp 10</strong></span>
vNX-OS-01(config)# <span class="strong"><strong>network 10.0.0.0/8</strong></span>
vNX-OS-01(config)# <span class="strong"><strong>exit</strong></span></pre><p>You can verify that routes from R1 are being advertised to NX-OSv using the <code class="literal">show ip route</code> command.</p><a id="pro_id00153"/><pre class="programlisting">vNX-OS-01# <span class="strong"><strong>show ip route</strong></span>
IP Route Table for VRF "default"
'*' denotes best ucast next-hop
'**' denotes best mcast next-hop
'[x/y]' denotes [preference/metric]
'%&lt;string&gt;' in via output denotes VRF &lt;string&gt;

10.1.1.0/24, ubest/mbest: 1/0, attached
    *via 10.1.1.2, Eth2/1, [0/0], 00:49:54, direct
10.1.1.2/32, ubest/mbest: 1/0, attached
    *via 10.1.1.2, Eth2/1, [0/0], 00:49:54, local
172.16.1.0/24, ubest/mbest: 1/0
    *via 10.1.1.1, Eth2/1, [90/130816], 00:32:04, eigrp-10, internal
172.16.2.0/24, ubest/mbest: 1/0
    *via 10.1.1.1, Eth2/1, [90/130816], 00:32:04, eigrp-10, internal
172.16.3.0/24, ubest/mbest: 1/0
    *via 10.1.1.1, Eth2/1, [90/130816], 00:32:04, eigrp-10, internal</pre><p>In the previous lines, notice that the output from this command is different from IOS, but all the pertinent information is there. In this example, all of the 172.16.0.0 routes have been advertised from R1 to NX-OSv via EIGRP, so you should be able to ping any of those addresses. Try that now.</p><a id="pro_id00154"/><pre class="programlisting">NX-OSv-01# <span class="strong"><strong>ping 172.16.2.1</strong></span>
PING 172.16.2.1 (172.16.2.1): 56 data bytes
64 bytes from 172.16.2.1: icmp_seq=0 ttl=254 time=20 ms
64 bytes from 172.16.2.1: icmp_seq=1 ttl=254 time=10 ms
64 bytes from 172.16.2.1: icmp_seq=2 ttl=254 time=20 ms
64 bytes from 172.16.2.1: icmp_seq=3 ttl=254 time=10 ms
64 bytes from 172.16.2.1: icmp_seq=4 ttl=254 time=20 ms

--- 172.16.2.1 ping statistics ---
5 packets transmitted, 5 packets received, 0.00% packet loss
round-trip min/avg/max = 10/16/20 ms</pre><p>Finally, save your configuration. The command itself is the same as IOS, but it provides different output.</p><a id="pro_id00155"/><pre class="programlisting">vNX-OS-01# <span class="strong"><strong>copy running-config startup-config</strong></span>
[########################################] 100%
Copy complete.
vNX-OS-01#</pre><p><a id="iddle2196" class="indexterm"/>Now that you’ve created a simple project, you can begin experimenting with NX-OSv on your own. Keep in mind that some functions will definitely be missing. In my version, for example, none of the L2 switch functionality works, only layer 3 routing. Another item to be aware of is tab completion; it works only on some commands, so don’t assume a command doesn’t work just because NX-OSv doesn’t provide tab completion on the command line.</p><p>In spite of these limitations, I still find it fun to add NX-OS devices to my projects, and I’m sure you will too. To learn more about Cisco Nexus and NX-OS, visit <span class="emphasis"><em><a class="ulink" href="http://www.cisco.com/en/US/products/ps9402/index.html">http://www.cisco.com/en/US/products/ps9402/index.html</a></em></span>.</p></div></div><div class="sect1" title="Final Thoughts"><div class="titlepage"><div><div><h1 class="title"><a id="final_thoughts-id00020"/>Final Thoughts</h1></div></div></div><p>In this chapter, you explored IOS on Unix and learned how to leverage IOU to add nearly full-featured switching capabilities to GNS3 without using physical switches. Although not required for CCNA-level certifications, IOU switching is highly useful for CCNP and CCIE certifications.</p><p>Next, you installed NX-OSv, a virtual machine that simulates a Cisco Nexus switch running NX-OS. NX-OSv can be networked to GNS3 devices using protocols such as OSPF and EIGRP, and it’s fun to play with, but it lacks much of the functionality you’d find using a real Nexus switch.</p><p>In the next chapter, I’ll show you a few fun things you can do with GNS3, such as creating a simulated access server to manage your routers.</p></div></div></body></html>