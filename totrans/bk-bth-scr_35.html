<html><head></head><body>
<div id="sbo-rt-content" class="calibre1"><section aria-labelledby="ch32" epub:type="chapter" role="doc-chapter">
<hgroup>
<h2 class="title" id="ch32">
<span class="cn"><span aria-label=" Page 389. " epub:type="pagebreak" id="pg_389" role="doc-pagebreak" class="calibre2"/><span class="sans_dogma_ot_bold_b_">32</span></span>
<span class="ct1"><span class="sans_dogma_ot_bold_b_">OBJECT-ORIENTED DESIGN</span></span>
</h2>
</hgroup>
<figure class="opener"><img alt="" class="opener1" height="407" src="../images/chapter.jpg" width="408"/>
</figure>
<p class="chapterintro">In preceding chapters, I’ve explored many topics that aren’t typically associated with Batch from booleans to hash tables, with many others in between. In this chapter, I’ll tackle the holy grail of Batch user-built tools: object-oriented design.</p>
<p class="tx">After explaining the difference between procedural and object-oriented coding, I’ll lay out the four pillars of object-oriented programming. Then I’ll present a fully functional model of Batch object-oriented design, complete with bat files representing parent, intermediate, and child objects. After you’ve learned how to invoke the object-oriented code, I’ll share many recommendations and analyze how well this model satisfies the basic tenets of object-oriented design.</p>
<section aria-labelledby="sec1" epub:type="division">
<h3 class="h" id="sec1"><span id="h1-213"/><span aria-label=" Page 390. " epub:type="pagebreak" id="pg_390" role="doc-pagebreak"/><span class="sans_futura_std_bold_b_">Procedural vs. Object-Oriented Coding</span></h3>
<p class="tni">In the very early days of computers, all coding was <i class="calibre6">procedural</i>—that is, all programs consisted of a series of computational steps. The methodology is still very much in existence with possibly more than a trillion lines of such code still in use and many more written every day. By default, variables are accessed globally in procedural code. Sometimes many hundreds of variables are defined in a section near the beginning of a program, and at other times, such as in Batch, they come into being when first referenced. Even when an internal routine or procedure is invoked, the set of active and available variables doesn’t change. Certain measures can often be invoked to limit scope, such as the <span class="sans_thesansmonocd_w5regular_">setlocal</span> discussed in <span class="xref"><a href="chapter3.xhtml" class="calibre3">Chapter 3</a></span>, but in procedural coding, a variable typically can be set or reset anywhere in what is often a very large program file.</p>
<p class="tx">Before long, some smart people came up with the concept of <i class="calibre6">object-oriented programming (OOP)</i>, where the code is broken into small, easy-to-manage <i class="calibre6">objects</i>, each containing data in the form of variables and executable code in the form of methods. A <i class="calibre6">method</i> is similar to an internal routine in Batch; it can be invoked, and when it completes its execution, control is returned to the point of the call, but a method can also be called externally; that is, code inside another program file can call the method directly. Regardless of the source of the call, the method accepts well-defined inputs and returns equally well-defined outputs. However, most of the data inside a method is typically inaccessible from elsewhere in the program file and especially from other program files.</p>
<p class="tx">The compartmentalization of the code into individual objects streamlines the logic and guards against the unintended consequence of some portion of the code adversely affecting another portion. Additionally, if one of these objects is of use in a different context, it can easily be used by both processes without modification or duplication. An equivalently useful portion of a procedural program might end up being copied and pasted into another program.</p>
<p class="tx">If I were to construct a list of great personal irritants—and for the sake of brevity, I’ll limit this to work/coding-related peeves—atop my jeremiad is procedural code disguised as object-oriented code. Certain languages and frameworks are designed to support each coding paradigm. Java and C# are object-oriented languages; COBOL and Batch are procedural languages. But contrary to what many believe, it isn’t that simple; procedural code can easily be written in Java, and with some work, object-oriented principles can be implemented in Batch.</p>
<aside aria-label="box-8" class="box">
<p class="boxtitle" id="box-8"><span class="sans_futura_std_bold_b_">PROCEDURAL VS. OBJECT-ORIENTED MINDSETS</span></p>
<p class="boxbodyfirst"><span class="sans_futura_std_book_">For much of my coding career, I’ve split my time between COBOL, Java, .NET, and of course, Batch. Many years ago, a .NET coder, who knew me only as</span> <span aria-label=" Page 391. " epub:type="pagebreak" id="pg_391" role="doc-pagebreak"/><span class="sans_futura_std_book_">a COBOL coder, pedantically went on at length about the virtues of object-oriented coding with the utmost condescension. When I had the displeasure of opening an example of his work, I found a single program file (or class) running into the thousands of lines predominated by global variables and many gratuitous examples of cut-and-paste code snippets with minor tweaks. He clearly fancied himself an object-oriented coder simply because he managed the modicum of knowledge necessary to achieve a clean compile in a language considered to be object-oriented.</span></p>
<p class="boxbody"><span class="sans_futura_std_book_">Shortly thereafter I abruptly interrupted his next harangue, “You’re no object-oriented programmer. You are the worst type of coder; you’re a procedural coder masquerading as an object-oriented coder, and you don’t even know the difference. If by analogy we were woodworkers, you’ve been provided with only the most modern cutting-edge tools—industrial caliber lathes and miter saws—and yet you produce a rickety chair that would earn a pity D– from a disappointed middle-school shop teacher, while I’ve built a finely crafted mahogany chair with dovetailed joints using nothing more than stone knives and bearskins.”</span></p>
<p class="boxbodylast"><span class="sans_futura_std_book_">To be completely honest, that isn’t exactly how it happened ... or really at all how it happened. I did have to work with this individual, so during a code review I provided some mild constructive criticism while laboring to find more positive comments about his atrocious code than negative remarks so as to soften the blow.</span></p>
</aside>
</section>
<section aria-labelledby="sec2" epub:type="division">
<h3 class="h" id="sec2"><span id="h1-214"/><span class="sans_futura_std_bold_b_">The Four Pillars</span></h3>
<p class="tni">Any coding language that purports to be object-oriented must fully support the four pillars of object-oriented programming. Languages considered to be object-oriented implement these in different ways, but they all have built-in mechanisms to guide the coder into writing code with these four characteristics.</p>
<p class="tx">The first pillar is <i class="calibre6">abstraction</i>, which simplifies the code’s interface with the outside world. It shows only the necessary or relevant features to the user, while shielding the implementation details and any information irrelevant to the functionality’s use.</p>
<p class="tx">This segues into the second pillar, <i class="calibre6">encapsulation</i>, which restricts access to certain methods and variables in an object, wrapping up data and code into multiple small units. Data hiding, or treating some variables and methods as private, is a significant part of this pillar. Another significant part is simply the act of creating compact, readable, and reusable modules.</p>
<p class="tx"><i class="calibre6">Inheritance</i>, the third pillar, allows for the creation of a base or parent object. Then derived objects can use the parent object while extending it to fit the more specific needs of the child. The classic example is a base or parent object of an Animal, defining all that is common throughout the animal <span aria-label=" Page 392. " epub:type="pagebreak" id="pg_392" role="doc-pagebreak"/>kingdom. Then intermediate objects defined as Reptile and Mammal can inherit data and routines from the Animal object and add to it information about their respective zoological classes. Then objects of Cat, Rat, and even Bat can inherit from the Mammal object, which is already inheriting from the Animal object. More than 1,000 child objects, one for each bat species on the planet, can then inherit from the Bat object. Finally, each of the inheriting objects can use the data and code in its parent objects for its own use.</p>
<p class="tx">The fourth pillar, <i class="calibre6">polymorphism</i>, which means the condition of occurring in several different forms, derives literally from the Greek words meaning <i class="calibre6">many forms</i>. This allows a call to a routine to behave differently in different situations. Reusable code is always awesome, but this pillar takes the concept of reuse to its zenith. A method in the parent object might be invoked by multiple child objects, where each invocation is unique to the child.</p>
<p class="tx">In the pages ahead, I’ll attempt to mimic these four pillars of abstraction, encapsulation, inheritance, and polymorphism.</p>
</section>
<section aria-labelledby="sec3" epub:type="division">
<h3 class="h" id="sec3"><span id="h1-215"/><span class="sans_futura_std_bold_b_">Batch Object-Oriented Design</span></h3>
<p class="tni">This chapter is about Batch object-oriented design and not Batch object-oriented programming for two reasons. First, and more trivially, BOOP is a horrible acronym, reminiscent of the noise one might make when affectionately poking a baby’s nose. BOOD isn’t much better, but I do have a Brilliant Acronym Team (or BAT) diligently working on something batter ... sorry, something better.</p>
<p class="tx">Far more important, Batch has none of the built-in features that are intrinsic to more modern languages that implement object-oriented programming. I’ll demonstrate how to mimic each of its four pillars, and the level of success in creating object-oriented bat files may very well surprise many, but I’ll craft some of its functionality more completely than other functionality. True object-oriented programming won’t be possible in Batch, but I encourage you to incorporate these design elements, in whole or in part, in the design of your Batch code.</p>
<p class="tx">In Batch, a variable cannot be defined as public or private; in fact, variables can’t be defined at all. There is no keyword to invoke inheritance found in other languages, such as “extends” or “implements.” In OOP, a child object can override methods in the parent object; you’ll soon see how to perform many of these tasks in Batch, but they won’t be done automatically. Remember that this is a language without booleans, floats, the <span class="sans_thesansmonocd_w5regular_">while</span> and <span class="sans_thesansmonocd_w5regular_">do...while</span> commands, the <span class="sans_thesansmonocd_w5regular_">and</span> and <span class="sans_thesansmonocd_w5regular_">or</span> operators, arrays, and hash tables. I’ve demonstrated how to build all of those things with the tools at hand (and I’ll do the same with stacks and queues in <span class="xref"><a href="chapter33.xhtml" class="calibre3">Chapter 33</a></span>), so it should be of little surprise that Batch has nothing off the shelf for anything like object-oriented programming.</p>
<p class="tx">However, object-oriented principles can be used, and should be used, regardless of the provided toolkit. Someone coding in an “object-oriented <span aria-label=" Page 393. " epub:type="pagebreak" id="pg_393" role="doc-pagebreak"/>language” can easily define excessive class-level variables, make all data items public, and put the lion’s share of the code into a “god object” (a single object that does too much and is too big to be managed efficiently). But regardless of the coding language, this design with large modules and excessive global variables is essentially procedural coding. More modern languages have object-oriented guardrails, but guardrails can be breached.</p>
<p class="tx">Conversely, there’s an expectation among many that Batch coders should create only large uninteresting modules. But while Batch procedural code is the standard, there’s no Batch police requiring it. When object-oriented programming or design is thought of as a technique and not as a characteristic associated with only some languages, scales will fall from your eyes as if on the road to Damascus. Batch doesn’t possess the sturdy guardrails offered elsewhere, but you can craft object-oriented techniques using any coding language, just as it’s more than possible to reach the summit driving up a mountain road with shear drops. The infrastructure or plumbing might not exist in Batch and not everything will be possible, but the elegance of object-oriented design in Batch offers the same benefits realized in other languages.</p>
</section>
<section aria-labelledby="sec4" epub:type="division">
<h3 class="h" id="sec4"><span id="h1-216"/><span class="sans_futura_std_bold_b_">Classes and Objects</span></h3>
<p class="tni">One of the differences between OOP and Batch object-oriented design is that traditionally each module or file is defined as a <i class="calibre6">class</i>, and an <i class="calibre6">object</i> is an instantiation of that class. Instantiating an object is much like defining a variable. Just as a variable can be defined as a string or as an integer in many languages, an object is instantiated to be one specific instance of a class.</p>
<p class="tx">To demonstrate, imagine again a class defined as <i class="calibre6">Bat</i>, representing all flying nocturnal mammals, where each species of bat would have its own class inheriting from <i class="calibre6">Bat</i>. One such species is the Madagascan fruit bat, and its class might be defined as a <i class="calibre6">MadFruitBat</i>. This class represents all bats of this one species, and it can be instantiated many times, each time representing one specific creature. A cave containing 500 Madagascan fruit bats could be populated with 500 objects, each one an instantiation of the <i class="calibre6">MadFruitBat</i> class individually named for a particular bat.</p>
<p class="tx">This is where Batch has its first object-oriented limitation. Remember that this is a language without the ability to define variables as strings and integers. Obviously then, a variable can’t be defined or instantiated as a data type corresponding to a class module. In Batch, the distinction between classes and objects doesn’t exist. A module or bat file is itself an object. It doesn’t have to be instantiated, nor can it be instantiated.</p>
<p class="tx">For this reason, the word <i class="calibre6">class</i> isn’t part of the Batch object-oriented design vernacular. I’ll soon share bat files that are fully constituted objects, each one ready to be invoked, and I’ll be referring to them as <i class="calibre6">objects</i>. The Madagascan fruit bat defined as the <i class="calibre6">MadFruitBat</i> class in OOP would be the <i class="calibre6">MadFruitBat.bat</i> object bat file in Batch. To implement the 500 individual Madagascan fruit bats, you would need to create a small bat file for each, and each would inherit from <i class="calibre6">MadFruitBat.bat</i>.</p>
<p class="tx"><span aria-label=" Page 394. " epub:type="pagebreak" id="pg_394" role="doc-pagebreak"/>Actually, <i class="calibre6">oMadFruitBat.bat</i> is a better name for the object bat file. To distinguish an object bat file from its more pedestrian brethren, I always prepend its name with a lowercase <i class="calibre6">o</i> as a visual cue. The <i class="calibre6">obj</i> text also works.</p>
</section>
<section aria-labelledby="sec5" epub:type="division">
<h3 class="h" id="sec5"><span id="h1-217"/><span class="sans_futura_std_bold_b_">Batch Object-Oriented Design Model</span></h3>
<p class="tni">The best way of describing object-oriented design is with an example or model. I’ll lay out here the broad strokes of the example of Batch object-oriented design that I present in this chapter. Then I’ll show the parent object with examples of intermediate and child objects, all the while explaining the object-oriented concepts implemented in each module. In the next section, “<span class="xref">Executing Object-Oriented Batch</span>,” I’ll discuss exactly how to invoke this model, and in a later section, “<span class="xref">The Four Pillars in Batch</span>,” I’ll explore how closely this model mimics each of the central concepts of object-oriented principles.</p>
<p class="tx">At the top of the pyramid is the base or parent object. Other objects inherit from it, but it’s the one object in this model that doesn’t inherit from another object. Beneath the parent are the intermediate objects that inherit directly from the parent object. Other intermediate objects can inherit from the first level of intermediate objects, culminating in child objects at the bottom of the pyramid. Intermediate and child objects are both called <i class="calibre6">derived objects</i> because they inherit or are derived from another object. (Technically, an intermediate object is also a child object because it is a child of another object, but I use the term <i class="calibre6">child</i> for what might more accurately be called a “childless child object.”)</p>
<p class="tx">In this chapter’s Batch object-oriented design model, <span class="sans_thesansmonocd_w5regular_">Movie</span> is the parent object to dozens of different film genre objects, such as <span class="sans_thesansmonocd_w5regular_">SciFi</span>, <span class="sans_thesansmonocd_w5regular_">RomCom</span>, and <span class="sans_thesansmonocd_w5regular_">Action</span>, although only two are shown: <span class="sans_thesansmonocd_w5regular_">Comedy</span> and <span class="sans_thesansmonocd_w5regular_">Drama</span>. Individual movies are their own specific object, each one inheriting from a particular genre object. More than two million movies have been released, but I’m showing only three here, two of which are the greatest movies ever released, and <i class="calibre6">The Godfather</i> is a great film as well. The objects that I’ll present in this chapter, I’ve marked with an asterisk in <a href="#fig32-1" class="calibre3">Figure 32-1</a>.</p>
<figure class="img"><img alt="" class="img1" height="464" id="fig32-1" src="../images/fig32-1.jpg" width="929"/>
<figcaption><p class="cap"><span class="futura_std_book_oblique_i_">Figure 32-1: Parent, intermediate, and child objects</span></p></figcaption>
</figure>
<p class="tx"><span aria-label=" Page 395. " epub:type="pagebreak" id="pg_395" role="doc-pagebreak"/>The <span class="sans_thesansmonocd_w5regular_">Movie</span> object contains data and methods that are common to all movies, or are at least the defaults for all movies. (Echoing the parlance of OOP, I’ll use the term <i class="calibre6">method</i> in place of <i class="calibre6">routine</i> from this point forward.) The <span class="sans_thesansmonocd_w5regular_">Comedy</span> and <span class="sans_thesansmonocd_w5regular_">Drama</span> objects each inherit from the <span class="sans_thesansmonocd_w5regular_">Movie</span> object and extend it, defining data and methods particular to each genre. The individual movie objects inherit from the genre objects, and thus indirectly from the <span class="sans_thesansmonocd_w5regular_">Movie</span> object, and contain detailed data about their specific flick. (Each arrow extends from the derived object to its parent object.)</p>
<p class="tx">But this isn’t a rigid hierarchy. A movie franchise object such as <span class="sans_thesansmonocd_w5regular_">StarTrek</span> could inherit from the <span class="sans_thesansmonocd_w5regular_">SciFi</span> genre object (neither is shown), and the individual <i class="calibre6">Star Trek</i> movies could be child objects of the movie franchise object.</p>
<p class="tx">More important, all objects are bat files. The <span class="sans_thesansmonocd_w5regular_">Movie</span> object in its most concrete form is the <i class="calibre6">oMovie.bat</i> bat file, and the <span class="sans_thesansmonocd_w5regular_">Comedy</span> object is the <i class="calibre6">oComedy.bat</i> bat file. Likewise, one of the child objects will be <i class="calibre6">oBigLebowski.bat</i>.</p>
<p class="tx">Some object-oriented languages offer multiple inheritance; that is, a derived object can inherit from two or more different objects. For instance, the <span class="sans_thesansmonocd_w5regular_">Dramedy</span> object might inherit from both the <span class="sans_thesansmonocd_w5regular_">Comedy</span> and <span class="sans_thesansmonocd_w5regular_">Drama</span> objects. While that is theoretically possible even in Batch, I’m restricting this model to single inheritance, so the <span class="sans_thesansmonocd_w5regular_">Dramedy</span> object is just another genre object inheriting from the <span class="sans_thesansmonocd_w5regular_">Movie</span> object, and individual dramedies will then inherit from the <span class="sans_thesansmonocd_w5regular_">Dramedy</span> object.</p>
<section aria-labelledby="sec6" epub:type="division">
<h4 class="h1" id="sec6"><span id="h2-112"/><span class="sans_futura_std_heavy_oblique_bi_">The Parent Object</span></h4>
<p class="tni">Once all of this makes sense conceptually, you’ll want to see everything in action. Starting with the base or parent object, <a href="#Lis32-1" class="calibre3">Listing 32-1</a> shows the contents of <i class="calibre6">oMovie.bat</i>. Note that this and the other object bat file don’t start with a <span class="sans_thesansmonocd_w5regular_">setlocal</span> command because they’ll always be called from other bat files that contain the command.</p>
<span id="Lis32-1"/>
<pre class="pre"><code class="calibre11"> set meth=%~1
<span aria-label="annotation1" class="codeannotationhang1">❶</span> for %%m in (Constructor DispInfo Set Get) do (
    if "%%m" equ "%meth%" (
     <span aria-label="annotation2" class="code_codeannotation">❷</span> call :%meth% "%~2" "%~3" "%~4"
     <span aria-label="annotation3" class="code_codeannotation">❸</span> goto :eof
 )  )
<span aria-label="annotation4" class="codeannotationhang">❹</span>  &gt; con echo ABORT - Invalid Method Invoked: %meth%
 pause &amp; exit

<span aria-label="annotation5" class="codeannotationhang">❺</span> :Constructor
 set gauge{%~1}=35mm
 set clrOrBW{%~1}=color
 goto :eof

<span aria-label="annotation6" class="codeannotationhang">❻</span> :Set
 set %~1{%~3}=%~2
 goto :eof

<span aria-label="annotation7" class="codeannotationhang">❼</span> :Get
 set %~2=!%~1{%~3}!
 goto :eof

<span aria-label=" Page 396. " epub:type="pagebreak" id="pg_396" role="doc-pagebreak"/><span aria-label="annotation8" class="codeannotationhang">❽</span> :DispInfo
 &gt; con echo "%~1" is a !year{%~1}! !clrOrBW{%~1}! !gauge{%~1}! film.
 &gt; con echo      Genre: !genre{%~1}!
 &gt; con echo      Plot: !plot{%~1}!
 &gt; con echo   Starring: !star{%~1}!
 &gt; con echo       Cast: !cast{%~1}!
 &gt; con echo    Country: !cntry{%~1}!
 &gt; con echo   Language: !lang{%~1}!
 &gt; con echo.
 goto :eof

<span aria-label="annotation9" class="codeannotationhang">❾</span> :PrivateMeth
 rem - some private method code goes here
 goto :eof
</code></pre>
<p class="listingcaption"><span class="futura_std_book_oblique_i_">Listing 32-1: The base or parent object,</span> <span class="sans_futura_std_book_">oMovie.bat</span></p>
<p class="tx">There are many interesting pieces of this object.</p>
<section aria-labelledby="sec7" epub:type="division">
<h5 class="h2" id="sec7"><span class="sans_futura_std_bold_b_">Hiding Methods</span></h5>
<p class="tni">Encapsulation, one of OOP’s pillars, includes the hiding of methods. By default, all methods of a bat file are hidden because there’s no built-in means of creating multiple entry points into a bat file; when a bat file executes, it starts at the top every time. Hence, the task here isn’t to hide certain methods but to make certain methods publicly accessible, while leaving the others hidden.</p>
<p class="tx">The <span class="sans_thesansmonocd_w5regular_">for</span> command <span aria-label="annotation1" class="codeannotation">❶</span> acts as a “traffic cop”; it contains a list of the bat file’s public methods as its input: <span class="sans_thesansmonocd_w5regular_">Constructor</span>, <span class="sans_thesansmonocd_w5regular_">DispInfo</span>, <span class="sans_thesansmonocd_w5regular_">Set</span>, and <span class="sans_thesansmonocd_w5regular_">Get</span>. The <span class="sans_thesansmonocd_w5regular_">if</span> command inside its code block compares the first parameter received, <span class="sans_thesansmonocd_w5regular_">meth</span>, to this list. If it matches one of the methods listed, the parameter, prepended with a colon, becomes the argument of the <span class="sans_thesansmonocd_w5regular_">call</span> command <span aria-label="annotation2" class="codeannotation">❷</span>, and we pass the remaining parameters as additional arguments.</p>
<p class="tx">Upon its completion of the called method, control immediately returns to the calling bat file via the <span class="sans_thesansmonocd_w5regular_">goto :eof</span> command <span aria-label="annotation3" class="codeannotation">❸</span> at the end of the <span class="sans_thesansmonocd_w5regular_">for</span> loop. Notice that the last method <span aria-label="annotation9" class="codeannotation">❾</span> isn’t on the list. As its name suggests, it’s a private method, callable exclusively from methods inside the object. If a calling bat file tries to invoke any other method not on the list or some text that isn’t even a method, the code writes out an abort message <span aria-label="annotation4" class="codeannotation">❹</span> and exits the entire process after a pause. (More robust error handling would be preferrable, but this works as a demonstration.)</p>
</section>
<section aria-labelledby="sec8" epub:type="division">
<h5 class="h2" id="sec8"><span class="sans_futura_std_bold_b_">Constructor</span></h5>
<p class="tni">When coding in a language with object-oriented guardrails, the act of instantiating an object automatically calls the constructor method belonging to the class. In fact, it isn’t even possible to call the other public methods until you’ve invoked the constructor. The constructor might set some variables or open a file or two, but its general purpose is to set up the object so you can use it going forward. This model mimics this behavior with the <span class="sans_thesansmonocd_w5regular_">:Constructor</span> method <span aria-label="annotation5" class="codeannotation">❺</span> near the top of every Batch object.</p>
<p class="tx"><span aria-label=" Page 397. " epub:type="pagebreak" id="pg_397" role="doc-pagebreak"/>This constructor method of the parent object simply sets two variables to defaults so that the majority of the individual movie objects won’t have to set them. The vast majority of movies released in the past several decades were shot in color and on 35-millimeter gauge film. This particular constructor accepts only one parameter, the movie title, so for one film in particular, the two <span class="sans_thesansmonocd_w5regular_">set</span> commands assign the values of <span class="sans_thesansmonocd_w5regular_">35mm</span> and <span class="sans_thesansmonocd_w5regular_">color</span> to the variables defined as <span class="sans_thesansmonocd_w5regular_">gauge{The Big Lebowski}</span> and <span class="sans_thesansmonocd_w5regular_">clrOrBW{The Big Lebowski}</span>, respectively. The variable names have spaces, and if that’s a problem for any reason, you can remove them with the replacement syntax, as long as you do so consistently.</p>
<p class="tx">We’ll also want variables for the plot, year of release, and other characteristics, but these clearly don’t have defaults, so we’ll set them elsewhere. However, you’ll soon see how the object for a 70-millimeter black-and-white film will be able to override these default values set in the parent object constructor.</p>
</section>
<section aria-labelledby="sec9" epub:type="division">
<h5 class="h2" id="sec9"><span class="sans_futura_std_bold_b_">Setters and Getters</span></h5>
<p class="tni">In strict object-oriented coding, classes typically have many setter and getter methods; that is, for each defined data item one method sets and another method gets its value. For instance, there might be a pair of methods to get and set the gauge and another pair for the plot, and so on. But due to delayed expansion and Batch’s lack of defined data types, we can consolidate all of the setter methods into a single <span class="sans_thesansmonocd_w5regular_">:Set</span> method <span aria-label="annotation6" class="codeannotation">❻</span>, and we can handle all of the getter methods with a solitary <span class="sans_thesansmonocd_w5regular_">:Get</span> method <span aria-label="annotation7" class="codeannotation">❼</span>.</p>
<p class="tx">The <span class="sans_thesansmonocd_w5regular_">:Set</span> method has a single line of interesting code that a calling bat file can use to set any variable for the object. It’s a <span class="sans_thesansmonocd_w5regular_">set</span> command using three parameters: the characteristic being set is <span class="sans_thesansmonocd_w5regular_">%~1</span>, the value being assigned is <span class="sans_thesansmonocd_w5regular_">%~2</span>, and the movie title is <span class="sans_thesansmonocd_w5regular_">%~3</span>. The variable name being set is a combination of the first and last parameters: <span class="sans_thesansmonocd_w5regular_">%~1{%~3}</span>.</p>
<p class="tx">To demonstrate how this works, you can invoke the <span class="sans_thesansmonocd_w5regular_">:Set</span> method with the following <span class="sans_thesansmonocd_w5regular_">call</span> command:</p>
<pre class="pre"><code class="calibre11">call :Set plot "A day repeats ad infinitum" "Groundhog Day"</code></pre>
<p class="tx">The result of this call sets the value of the plot in the second argument to the <span class="sans_thesansmonocd_w5regular_">plot{Groundhog Day}</span> variable, but notice that there’s no explicit call to the <span class="sans_thesansmonocd_w5regular_">:Set</span> method to be found in this bat file. I’ll eventually show how to make this call from outside of this parent bat file.</p>
<p class="tx">The <span class="sans_thesansmonocd_w5regular_">:Get</span> method flips the assignment around, returning the value in lieu of assigning it. The parameters for the setter and getter methods are the same with the notable exception that the second one for the getter is the name of the variable to which we assign the plot, instead of the plot itself. Conveniently, resolving the other two parameters inside of exclamation marks extracts the value of the plot as part of the assignment: <span class="sans_thesansmonocd_w5regular_">!%~1{%~3}!</span>.</p>
<p class="tx">Here’s one possible invocation of the method:</p>
<pre class="pre"><code class="calibre11">call :Get plot plotVar "Groundhog Day"</code></pre>
<p class="tx"><span aria-label=" Page 398. " epub:type="pagebreak" id="pg_398" role="doc-pagebreak"/>This returns the <span class="sans_thesansmonocd_w5regular_">plotVar</span> variable set to the value <span class="sans_thesansmonocd_w5regular_">A day repeats ad infinitum</span> or the same string we passed to the <span class="sans_thesansmonocd_w5regular_">:Set</span> method earlier.</p>
<p class="tx">It’s easy to miss how sublime this really is. Yet again, delayed expansion offers us a useful and elegant solution not available in most languages. Astonishingly, an object with dozens of variables needs only one setter and one getter method. In at least one small facet, Batch offers a better solution than traditional object-oriented languages.</p>
</section>
<section aria-labelledby="sec10" epub:type="division">
<h5 class="h2" id="sec10"><span class="sans_futura_std_bold_b_">App-Specific Public Methods</span></h5>
<p class="tni">In traditional OOP, constructors are a must, and setters and getters are ubiquitous, but there are usually other public methods specific to an application, and I’ve included one example of just such a method in the <i class="calibre6">oMovie.bat</i> object. The <span class="sans_thesansmonocd_w5regular_">:DispInfo</span> method <span aria-label="annotation8" class="codeannotation">❽</span> displays detailed information about a film to the console. A series of <span class="sans_thesansmonocd_w5regular_">echo</span> commands in the method write the movie title and several other pieces of data to the console. For instance, its first line mentions the movie itself and details the year of release, whether it’s color or black and white, and the gauge.</p>
<p class="tx">These last two variables are set in the constructor, but the variable for the year and others aren’t. In fact, their only mention in the parent bat file is here. (I’ll share their origins before long, but it has something to do with inheritance.) Regardless of where this data comes from, this one method displays information for any movie object that is derived directly or indirectly from this object. That’s polymorphism.</p>
<blockquote class="calibre8">
<p class="warning"><span class="sans_dogma_ot_bold_b_1">NOTE</span></p>
</blockquote>
<p class="warning-txt"><i class="calibre6">If variables such as plot{Groundhog Day} remind you of hash table elements, that’s because they are in fact elements of hash tables (<a href="chapter29.xhtml" class="calibre3">Chapter 29</a>). You don’t need to understand the data structure to understand this model, but after executing the logic to build 17 plots for 17 different movies, the plot hash table contains 17 elements.</i></p>
</section>
</section>
<section aria-labelledby="sec11" epub:type="division">
<h4 class="h1" id="sec11"><span id="h2-113"/><span class="sans_futura_std_heavy_oblique_bi_">The Intermediate Object</span></h4>
<p class="tni">In this model, the genre objects are all intermediate objects, with the <i class="calibre6">oComedy.bat</i> object being one example. It’s a child of <i class="calibre6">oMovie.bat</i>, but it also has children of its own, two of which are shown in <a href="#fig32-1" class="calibre3">Figure 32-1</a>.</p>
<p class="tx"><a href="#Lis32-2" class="calibre3">Listing 32-2</a> shows the complete bat file object for <i class="calibre6">oComedy.bat</i>.</p>
<span id="Lis32-2"/>
<pre class="pre"><code class="calibre11"><span aria-label="annotation1" class="codeannotationhang1">❶</span> set extends=C:\Batch\oMovie.bat
 set meth=%~1
<span aria-label="annotation2" class="codeannotationhang1">❷</span> for %%m in (Constructor PublicMeth) do (
    if "%%m" equ "%meth%" (
     <span aria-label="annotation3" class="code_codeannotation">❸</span> call :%meth% "%~2" "%~3"
       goto :eof
 )  )
<span aria-label="annotation4" class="codeannotationhang1">❹</span> call %extends% %*
 goto :eof

<span aria-label="annotation5" class="codeannotationhang">❺</span> :Constructor
 call %extends% %meth% %*
<span aria-label="annotation6" class="codeannotationhang1">❻</span> set genre{%~1}=Comedy
 goto :eof

<span aria-label=" Page 399. " epub:type="pagebreak" id="pg_399" role="doc-pagebreak"/><span aria-label="annotation7" class="codeannotationhang">❼</span> :PublicMeth
 :: some public method code
<span aria-label="annotation8" class="codeannotationhang1">❽</span> call :PrivateMeth
 goto :eof

<span aria-label="annotation9" class="codeannotationhang">❾</span> :PrivateMeth
 :: some private method code
 goto :eof
</code></pre>
<p class="listingcaption"><span class="futura_std_book_oblique_i_">Listing 32-2: The intermediate object,</span> <span class="sans_futura_std_book_">oComedy.bat</span></p>
<p class="tx">At a glance, this looks to be structured much like the parent object, but there are differences. The very first line defines another bat file, and immediately after the traffic cop is a <span class="sans_thesansmonocd_w5regular_">call</span> command instead of an abort. The constructor also calls another bat file, and the setter and getter methods are missing along with the method to display information about a movie.</p>
<p class="tx">Strict object-oriented languages have reserved words and syntax allowing one object to seamlessly inherit from another. Not to be confused with Batch, this is how a child class would use the <span class="sans_thesansmonocd_w5regular_">extends</span> keyword to inherit from a parent in Java:</p>
<pre class="pre"><code class="calibre11">public class oComedy extends oMovie {}</code></pre>
<p class="tx">In Batch, without similar built-in syntax, we do it quite differently. The first statement in the <i class="calibre6">oComedy.bat</i> object defines the parent object bat file from which it inherits, namely, <i class="calibre6">oMovie.bat</i> <span aria-label="annotation1" class="codeannotation">❶</span>, which is also the object it <span class="sans_thesansmonocd_w5regular_">extends</span>. Then the traffic cop, looking much like the one in the parent object, has its own list of public methods maintained in the <span class="sans_thesansmonocd_w5regular_">for</span> command <span aria-label="annotation2" class="codeannotation">❷</span>. If the first parameter matches either of the two public methods in the list, the <span class="sans_thesansmonocd_w5regular_">call</span> command invokes it <span aria-label="annotation3" class="codeannotation">❸</span>. But where the parent class aborts when the method to be invoked isn’t public, the child object instead calls the parent class defined by <span class="sans_thesansmonocd_w5regular_">extends</span>, passing the same arguments along <span aria-label="annotation4" class="codeannotation">❹</span>. That’s inheritance.</p>
<p class="tx">An intermediate (and child) object can define its own methods not already in the parent object. It can also inherit the methods from the parent object by doing nothing more than what I’ve already shown. If the first parameter isn’t in the list of public methods, this bat file becomes a simple pass-through as it makes the identical call to the parent object <span aria-label="annotation4" class="codeannotation">❹</span>. The <span class="sans_thesansmonocd_w5regular_">%*</span> syntax ensures that the same parameter list received by this bat is the argument list passed to the parent.</p>
<p class="tx">We’ll soon be able to call the important methods in the parent object (<span class="sans_thesansmonocd_w5regular_">:DispInfo</span>, <span class="sans_thesansmonocd_w5regular_">:Set</span>, and <span class="sans_thesansmonocd_w5regular_">:Get</span>) with the Batch inheritance just described. Elegantly, all of the genre objects and their children can easily use these methods. Not only does the intermediate object not have to reproduce them, but it doesn’t even need to mention them. And what happens when someone errantly passes this object a method not made public here or by its parent? The intermediate object passes it along, and the parent performs the error handling for all its children in one place.</p>
<p class="tx"><span aria-label=" Page 400. " epub:type="pagebreak" id="pg_400" role="doc-pagebreak"/>This object does more than inherit methods from the parent. The constructor offers an example of <i class="calibre6">extending</i> a method already defined in the parent object. There is a <span class="sans_thesansmonocd_w5regular_">:Constructor</span> method in the parent, but the inheritance set up with the traffic cop doesn’t call it. Instead, the intermediate object’s <span class="sans_thesansmonocd_w5regular_">:Constructor</span> method <span aria-label="annotation5" class="codeannotation">❺</span> supersedes it, but this doesn’t mean that we never invoke the parent constructor logic.</p>
<p class="tx">The very first line of the <span class="sans_thesansmonocd_w5regular_">:Constructor</span> method calls the parent object to invoke its method of the same name, that is, its constructor. This is another built-in feature of traditional object-oriented languages that we must mimic. After calling the parent’s constructor, the derived object’s constructor puts its own spin on the data. Remember that the <i class="calibre6">oMovie.bat</i> object defined the movie as <span class="sans_thesansmonocd_w5regular_">color</span> and <span class="sans_thesansmonocd_w5regular_">35mm</span> in its constructor. Here the <i class="calibre6">oComedy.bat</i> object accepts those two values and also defines the genre as <span class="sans_thesansmonocd_w5regular_">Comedy</span> <span aria-label="annotation6" class="codeannotation">❻</span>. As we’ll soon see, its child objects will extend this even further.</p>
<p class="tx">Finally, notice two aptly named methods, one public <span aria-label="annotation7" class="codeannotation">❼</span> and one private <span aria-label="annotation9" class="codeannotation">❾</span>. The private method isn’t listed in the traffic cop, so we can invoke it explicitly only from somewhere inside this bat file, such as from inside the public method <span aria-label="annotation8" class="codeannotation">❽</span>.</p>
</section>
<section aria-labelledby="sec12" epub:type="division">
<h4 class="h1" id="sec12"><span id="h2-114"/><span class="sans_futura_std_heavy_oblique_bi_">The Child Objects</span></h4>
<p class="tni">Finally, we come to the objects for the individual movies. <a href="#Lis32-3" class="calibre3">Listing 32-3</a> is the entire bat file for one movie object, <i class="calibre6">oBigLebowski.bat</i>.</p>
<span id="Lis32-3"/>
<pre class="pre"><code class="calibre11"><span aria-label="annotation1" class="codeannotationhang1">❶</span> set extends=C:\Batch\oComedy.bat
 set meth=%~1
<span aria-label="annotation2" class="codeannotationhang1">❷</span> set title=The Big Lebowski

<span aria-label="annotation3" class="codeannotationhang1">❸</span> for %%m in (Constructor) do (
    if "%%m" equ "%meth%" (
       call :%meth% "%~2" "%~3"
       goto :eof
 )  )
<span aria-label="annotation4" class="codeannotationhang1">❹</span> call %extends% %* "%title%"
 goto :eof

<span aria-label="annotation5" class="codeannotationhang">❺</span> :Constructor
<span aria-label="annotation6" class="codeannotationhang1">❻</span> call %extends% %meth% "%title%"
<span aria-label="annotation7" class="codeannotationhang1">❼</span> set plot{%title%}=The Dude seeks recompense for a valued rug micturated upon.
 set star{%title%}=Jeff Bridges
 set cast{%title%}=John Goodman, Julianne Moore, Steve Buscemi
 set lang{%title%}=English
 set year{%title%}=1998
 set cntry{%title%}=United States
 goto :eof
</code></pre>
<p class="listingcaption"><span class="futura_std_book_oblique_i_">Listing 32-3: The child object,</span> <span class="sans_futura_std_book_">oBigLebowski.bat</span></p>
<p class="tx">The traffic cop <span aria-label="annotation3" class="codeannotation">❸</span> at the top of this child object looks much like the one from the intermediate object, but it now extends the <i class="calibre6">oComedy.bat</i> object <span aria-label="annotation1" class="codeannotation">❶</span>, <span aria-label=" Page 401. " epub:type="pagebreak" id="pg_401" role="doc-pagebreak"/>and the new <span class="sans_thesansmonocd_w5regular_">title</span> variable <span aria-label="annotation2" class="codeannotation">❷</span> defines the movie. We’re passing the <span class="sans_thesansmonocd_w5regular_">title</span> to its parent object as the final argument <span aria-label="annotation4" class="codeannotation">❹</span>, where it’s used to set variables such as <span class="sans_thesansmonocd_w5regular_">gauge{The Big Lebowski}</span> in <i class="calibre6">oMovie.bat</i> and <span class="sans_thesansmonocd_w5regular_">genre{The Big Lebowski}</span> in <i class="calibre6">oComedy.bat</i>.</p>
<p class="tx">This child object has only one public method and no private methods, but it could easily have multiples of either type. (Since there’s only one entry in the list of public methods, we could remove the <span class="sans_thesansmonocd_w5regular_">for</span> command and leave just an <span class="sans_thesansmonocd_w5regular_">if</span> command.)</p>
<p class="tx">The <span class="sans_thesansmonocd_w5regular_">:Constructor</span> method <span aria-label="annotation5" class="codeannotation">❺</span> is even more interesting than the constructor in the intermediate object. It first calls the constructor of its parent, <i class="calibre6">oComedy.bat</i> <span aria-label="annotation6" class="codeannotation">❻</span>, and we’ve already seen that the constructor in the intermediate object will in turn call the constructor of its parent, <i class="calibre6">oMovie.bat</i>. Both parents set a variable or two before returning control to the constructor of the individual movie object where it sets everything that’s particular to its actual movie, such as the <span class="sans_thesansmonocd_w5regular_">plot</span>, <span class="sans_thesansmonocd_w5regular_">star</span>, and <span class="sans_thesansmonocd_w5regular_">cast</span> <span aria-label="annotation7" class="codeannotation">❼</span>.</p>
<p class="tx">We can now set up similar object bat files for other movies. Notice the differences and similarities between the previous object and the following object, <i class="calibre6">oLifeOfBrian.bat</i>, which contains data and a constructor method for another great film in <a href="#Lis32-4" class="calibre3">Listing 32-4</a>.</p>
<span id="Lis32-4"/>
<pre class="pre"><code class="calibre11"> set extends=C:\Batch\oComedy.bat
 set meth=%~1
 set title=The Life of Brian

 for %%m in (Constructor) do (
    if "%%m" equ "%meth%" (
       call :%meth% "%~2" "%~3"
       goto :eof
 )  )
 call %extends% %* "%title%"
 goto :eof

:Constructor
 call %extends% %meth% "%title%"
 set plot{%title%}=A very naughty boy is taken for the Messiah in old Judea.
 set star{%title%}=Graham Chapman
 set cast{%title%}=John Cleese, Eric Idle, Michael Palin
 set lang{%title%}=English
 set year{%title%}=1979
 set cntry{%title%}=United Kingdom
<span aria-label="annotation1" class="codeannotationhang1">❶</span> set troupe{%title%}=Monty Python
 goto :eof
</code></pre>
<p class="listingcaption"><span class="futura_std_book_oblique_i_">Listing 32-4: The child object,</span> <span class="sans_futura_std_book_">oLifeOfBrian.bat</span></p>
<p class="tx">Both constructors are setting the plot, star, members of the cast, language, year of release, and country, but this one is also setting <span class="sans_thesansmonocd_w5regular_">troupe{%title%}</span> <span aria-label="annotation1" class="codeannotation">❶</span>. <i class="calibre6">The Life of Brian</i> was created by a comedy troupe, but this variable doesn’t apply to most other comedies. Each constructor <span aria-label=" Page 402. " epub:type="pagebreak" id="pg_402" role="doc-pagebreak"/>is unique to a particular move and bat file; while it should define a certain set of variables in this model, it can contain additional logic pertinent to its movie, as the object demonstrates.</p>
<p class="tx">I more than hinted earlier that you can override variables defined in the parent’s constructor in the child, and the child’s constructor is where that happens. For instance, the constructor in <i class="calibre6">oRagingBull.bat</i> would reset the <span class="sans_thesansmonocd_w5regular_">clrOrBW{Raging Bull}</span> variable to <span class="sans_thesansmonocd_w5regular_">Black and White</span>. Likewise, for a movie shot in something other than <span class="sans_thesansmonocd_w5regular_">35mm</span>, such as <span class="sans_thesansmonocd_w5regular_">digital</span>, we can reset the gauge in the child’s constructor.</p>
<p class="tx">Another feature of object-oriented design is the ability of a child object to override methods defined in a parent class. You’ve seen methods inherited and extended. The constructor just discussed is a great example of extending a method. Now imagine that method without the call to its like-named method in its parent. That’s a <i class="calibre6">method override</i>. The child object will never call the public method in its parent object because the child has overridden it with a method of its own.</p>
<p class="tx">To demonstrate, let’s consider one last child object with this as the <span class="sans_thesansmonocd_w5regular_">title</span> variable:</p>
<pre class="pre"><code class="calibre11">set title=Star Wars: Episode I - The Phantom Menace</code></pre>
<p class="tx">If <span class="sans_thesansmonocd_w5regular_">DispInfo</span> is in the list of public methods defined for this particular child object, the coder of this object could add the following method to the bat file:</p>
<pre class="pre"><code class="calibre11">rem – Override Method 
 :DispInfo
  &gt; con echo "%title%" is the worst movie ever released. Members of an
  &gt; con echo accomplished cast are reduced to one-dimensional characters
  &gt; con echo upstaged by the uniquely annoying Jar Jar Binks in a plot so
  &gt; con echo tortured it evokes war crimes. It's little more than a big budget
  &gt; con echo excuse to unveil the technology to meld animated characters into
  &gt; con echo live action. Only the most ardent Star Wars apologists and young 
  &gt; con echo children found it enjoyable, but the racist tropes made it
  &gt; con echo unsuitable for viewing by anyone of any age.
  &gt; con echo.
  goto :eof
</code></pre>
<p class="tni">A comment stating that this method is an override isn’t required, but it’s good form.</p>
<p class="tx">Notice that this method doesn’t invoke a corresponding method in its parent class. It simply writes a few lines of commentary, followed by a blank line, and does nothing more. It has completely superseded or overridden the like-named method in the parent class. Unlike other movies, this title won’t see the plot, cast, and other information written to the console as we’ve seen for other movies using the <span class="sans_thesansmonocd_w5regular_">:DispInfo</span> method in <i class="calibre6">oMovie.bat</i>. The author of this bat file obviously felt that something special was needed for the informational display for such a singular film. (Please, no hate mail; the original trilogy was fine, even better than fine.)</p>
</section>
</section>
<section aria-labelledby="sec13" epub:type="division">
<h3 class="h" id="sec13"><span id="h1-218"/><span aria-label=" Page 403. " epub:type="pagebreak" id="pg_403" role="doc-pagebreak"/><span class="sans_futura_std_bold_b_">Executing Object-Oriented Batch</span></h3>
<p class="tni">We’ve created the <i class="calibre6">oMovie.bat</i> parent object and the <i class="calibre6">oComedy.bat</i> intermediate object that extends or inherits from the parent. In theory, we could create more intermediate (or genre) objects and more than two million child objects for individual movies, but before us we have two child object bat files representing two comedies, each extending the <i class="calibre6">oComedy.bat</i> object. Finally, we can execute this object-oriented code. If nothing else, you can use the <i class="calibre6">Test.bat</i> file mentioned in <span class="xref"><a href="chapter31.xhtml" class="calibre3">Chapter 31</a></span>, but you need to place all calls to this code into a bat file not already in the model.</p>
<p class="tx">The implementing code calls only the child objects; the parent and intermediate objects are called only from their children. Let’s start with these four commands:</p>
<pre class="pre"><code class="calibre11">call C:\Batch\oBigLebowski.bat Constructor
call C:\Batch\oLifeOfBrian.bat Constructor
call C:\Batch\oBigLebowski.bat DispInfo
call C:\Batch\oLifeOfBrian.bat DispInfo
</code></pre>
<p class="tni">Remember that you must call the constructor before you can call any other method in an object. These first two commands are the Batch equivalent of instantiating objects.</p>
<p class="tx">We first call <i class="calibre6">oBigLebowski.bat</i>, and its traffic cop invokes its <span class="sans_thesansmonocd_w5regular_">:Constructor</span> method; as we’ve already seen, that constructor invokes the constructor method in its parent object, <i class="calibre6">oComedy.bat</i>, which invokes the corresponding method in its parent, <i class="calibre6">oMovie.bat</i>. Each of the three bat files contributes to the creation of the nine variables that describe this movie. Immediately after that, we do the same with <i class="calibre6">oLifeOfBrian.bat</i> to create a second set of movie variables.</p>
<p class="tx">The constructors don’t generate any output, but the last two <span class="sans_thesansmonocd_w5regular_">call</span> commands display the information shown in <a href="#Lis32-5" class="calibre3">Listing 32-5</a> to the console.</p>
<span id="Lis32-5"/>
<pre class="pre"><code class="calibre11">"The Big Lebowski" is a 1998 color 35mm film.
     Genre: Comedy
      Plot: The Dude seeks recompense for a valued rug micturated upon.
  Starring: Jeff Bridges
      Cast: John Goodman, Julianne Moore, Steve Buscemi
   Country: United States
  Language: English

"The Life of Brian" is a 1979 color 35mm film.
     Genre: Comedy
      Plot: A very naughty boy is taken for the Messiah in old Judea.
  Starring: Graham Chapman
      Cast: John Cleese, Eric Idle, Michael Palin
   Country: United Kingdom
  Language: English
</code></pre>
<p class="listingcaption"><span class="futura_std_book_oblique_i_">Listing 32-5: Output from two DispInfo calls using two different child objects</span></p>
<p class="tx"><span aria-label=" Page 404. " epub:type="pagebreak" id="pg_404" role="doc-pagebreak"/>The third command calls <i class="calibre6">oBigLebowski.bat</i>, passing <span class="sans_thesansmonocd_w5regular_">DispInfo</span> as its only argument. This child object doesn’t find a public method named <span class="sans_thesansmonocd_w5regular_">:DispInfo</span>, so the inheritance kicks in with a call to its parent, <i class="calibre6">oComedy.bat</i>, where the method also doesn’t exist. Once again because of inheritance, we call the base object, <i class="calibre6">oMovie.bat</i>, where we finally find and execute the public method. It displays a concise summary of information about <i class="calibre6">The Big Lebowski</i> to the console in seven lines of text.</p>
<p class="tx">The final command also shares a wealth of information, but about a different movie, because it calls the <i class="calibre6">oLifeOfBrian.bat</i> object. We are ultimately invoking the exact same method, <span class="sans_thesansmonocd_w5regular_">:DispInfo</span>, in the exact same object, <i class="calibre6">oMovie.bat</i>, but notice the stark differences in the output. The output describes two entirely different movies. That’s polymorphism.</p>
<p class="tx">Batch has one critical and fairly unique characteristic that lends itself to the implementation of polymorphism: delayed expansion. Resolving variables is straightforward in most coding languages, but Batch allows you to resolve one or more variables to create a variable name that can then itself be resolved.</p>
<p class="tx">Both sets of output come from the <span class="sans_thesansmonocd_w5regular_">:DispInfo</span> method in the parent object <i class="calibre6">oMovie.bat</i> (<a href="#Lis32-1" class="calibre3">Listing 32-1</a>). Taking just one variable as an example, delayed expansion first resolves the parameter embedded in <span class="sans_thesansmonocd_w5regular_">!plot{%~1}!</span> to be the movie title. In our first call, this results in <span class="sans_thesansmonocd_w5regular_">!plot{The Big Lebowski}!</span>, which then resolves to the plot of that movie. The second time through, this exact same code results in <span class="sans_thesansmonocd_w5regular_">!plot{The Life of Brian}!</span>, which resolves to a very different plot. This is Batch polymorphism at its finest.</p>
<p class="tx">Whoever wrote the <i class="calibre6">oBigLebowski.bat</i> object left an Academy Award–winning actor off the cast list. The late Philip Seymour Hoffman had a relatively small role as the title character’s smug toady of a personal assistant, Brandt, but he played it with a brilliance and nuance that foretold greater roles. The following two commands add him to the current cast:</p>
<pre class="pre"><code class="calibre11">call C:\Batch\oBigLebowski.bat Get cast lebowCast
call C:\Batch\oBigLebowski.bat Set cast "%lebowCast%, Philip Seymour Hoffman"
</code></pre>
<p class="tx">The first argument of both <span class="sans_thesansmonocd_w5regular_">call</span> commands is the name of the method to be invoked, and the second argument is the type of variable pertinent to the call, which is <span class="sans_thesansmonocd_w5regular_">cast</span> in both instances. The first command will <span class="sans_thesansmonocd_w5regular_">Get</span> the current cast members, returning the value as the contents of the <span class="sans_thesansmonocd_w5regular_">lebowCast</span> variable. The second command will <span class="sans_thesansmonocd_w5regular_">Set</span> (or reset) the list of current cast members to the just-returned value concatenated with Mr. Hoffman’s full name. If you were to invoke the <i class="calibre6">oBigLebowski.bat</i> object again with the <span class="sans_thesansmonocd_w5regular_">DispInfo</span> argument, you’d see all four actors included in the cast as opposed to the three in <a href="#Lis32-5" class="calibre3">Listing 32-5</a>.</p>
</section>
<section aria-labelledby="sec14" epub:type="division">
<h3 class="h" id="sec14"><span id="h1-219"/><span class="sans_futura_std_bold_b_">Recommendations</span></h3>
<p class="tni">To keep this complex example as comprehendible as possible, I’ve resisted the mention of some possible tweaks, up until now.</p>
<p class="tx"><span aria-label=" Page 405. " epub:type="pagebreak" id="pg_405" role="doc-pagebreak"/>I shared that strict OOP dictates that you must invoke the constructor before you can use an object. This model leaves that restriction to the honor system, but you can remedy the issue with an “instantiated” switch. First, the child constructor would set the switch when it executes. Then you could interrogate that switch before any attempt to invoke a public method, throwing an abort if it hasn’t yet been set. This is almost certainly overkill, but it wouldn’t be difficult (or elegant). I prefer the honor system here.</p>
<p class="tx">I never used the comedy troupe variable set for the Monty Python film, but you can define a <span class="sans_thesansmonocd_w5regular_">:DispInfo</span> method in the <i class="calibre6">oLifeOfBrian.bat</i> object to extend the like-name method from <i class="calibre6">oMovie.bat</i>. After the child calls to inherit the display performed by its parent (or parent’s parent), it can append a similar line for the troupe. Even better yet, since a troupe applies only to some comedies, the new method could go into the <i class="calibre6">oComedy.bat</i> object, where you’d display the troupe only if it exists.</p>
<p class="tx">The most significant element of OOP that we haven’t successfully duplicated in Batch is data hiding. When a variable is set, it’s available in the environment until it’s reassigned or the process ceases, and there’s no realistic means of preventing its reassignment by some other code. We can use the <span class="sans_thesansmonocd_w5regular_">setlocal</span> and <span class="sans_thesansmonocd_w5regular_">endlocal</span> commands to hide variables, but after the execution of the <span class="sans_thesansmonocd_w5regular_">endlocal</span> command, the variables will be lost into the ether. As I mentioned in <span class="xref"><a href="chapter16.xhtml" class="calibre3">Chapter 16</a></span>, variables can survive an <span class="sans_thesansmonocd_w5regular_">endlocal</span> command, but doing so would make them available globally, and that doesn’t lend itself to “data hiding.” We could hide the variables in a temporary file and restore them the next time through the code, but this most definitely is overkill.</p>
<p class="tx">Not being able to declare private variables is a limitation that precludes the ability to make a Batch object available to a great number of users, as is the case with other languages. But let’s take a step back to gain some perspective. Making an object generally available for the masses is not part of the design I’m positing; this is Batch, and there’s no realistic infrastructure for something on that type of scale anyway.</p>
<p class="tx">I’m suggesting the building of objects for use by oneself and maybe a small group of friends or co-workers working on the same network. This isn’t something you’d want to make callable from a web service. Thus, the only real ramification of not being able to hide data is that a small cohort of coders must be aware that they shouldn’t step on the variables used in certain objects.</p>
<p class="tx">Batch object-oriented design is a methodology that I highly recommend. You might not implement it as extensively as in the model that I’ve presented here, nor should you. (More on this in the next and final chapter.) Even just portions of this methodology may very well be useful to you. Even without the use of inheritance, you can write a module with polymorphic code that behaves differently based on the caller. A simplified version of inheritance might rely on one central bat file for a few important tasks. Just writing small and reusable modules is redolent of object-oriented design and is an enormous step forward.</p>
</section>
<section aria-labelledby="sec15" epub:type="division">
<h3 class="h" id="sec15"><span id="h1-220"/><span aria-label=" Page 406. " epub:type="pagebreak" id="pg_406" role="doc-pagebreak"/><span class="sans_futura_std_bold_b_">The Four Pillars in Batch</span></h3>
<p class="tni">You’ve already seen that in this Batch model we’ve been able to simulate many of the characteristics of OOP surprisingly well. Let’s step through each of the four pillars one more time, detailing how close we’ve actually come to our goal.</p>
<p class="tx">Abstraction, the first pillar, simplifies the code’s interface, shows only the necessary or relevant features, and shields implementation details. Take another look at the two complete child objects in Listings 32-3 and 32-4. The methods to get and set variables, along with the method to display movie information, have all been abstracted away. Other than the logic at the top of each object listing public methods and handling the inheritance, there’s really just a single method, the constructor, and everything in it is pertinent to the object. Abstraction in Batch object-oriented design gets high marks.</p>
<p class="tx">Smaller, more plentiful modules present a superior design regardless of the language or coding methodology. Each file has a distinct purpose, and the code is more maintainable and extensible. The model I’ve shown in this chapter lends itself to writing short, compact, and reusable code modules, and this is one of three components that define the second pillar, encapsulation, along with data and method hiding. Method hiding is trivial in Batch; in fact, we had to do some work to expose public methods. Data hiding, however, isn’t supported at all in this model. All of the variables set for all of the different movies float around the environment for anyone to modify at any time. Two out of three is a passing grade.</p>
<p class="tx">Examples of inheritance, the third pillar, are strewn throughout the previous pages. Child objects are inheriting constructors from intermediate objects, which in turn inherit the same from parent objects. The method for displaying information to the console and the setter and getter methods are all quality examples of inheritance. We coded them once in the parent object for use by up to two million child objects. I’ve even demonstrated how to override a method in a child object. We need a bit of redundant code at the top of each bat file to make this work, but this model clearly scores near the top of its class when it comes to inheritance.</p>
<p class="tx">The fourth pillar, polymorphism, allows code to behave differently in different situations, with the method displaying movie information being a prime example of this functionality. We use a single method in a single bat file to write the unique information for a couple million movies—and two of those variables displayed were originally set in the parent object’s polymorphic constructor. The setter and getter method take this a step further. Traditional OOP requires a pair of these methods for each and every defined variable. In this model, a single setter and a single getter handle all variables for each and every individual movie object. Batch polymorphism is what many students call a <i class="calibre6">curve buster</i>.</p>
<p class="tx">I’ll leave it to you, the reader, to give this model a final grade. I’ll concede that due to the lack of data hiding, the mark of an A is out of reach, but I hope not too far out of reach.</p>
</section>
<section aria-labelledby="sec16" epub:type="division">
<h3 class="h" id="sec16"><span id="h1-221"/><span aria-label=" Page 407. " epub:type="pagebreak" id="pg_407" role="doc-pagebreak"/><span class="sans_futura_std_bold_b_">Summary</span></h3>
<p class="tni">Was Batch designed as an object-oriented language? Not a chance. Is it possible to build much of object-oriented design—that is, abstraction, encapsulation, inheritance, and polymorphism—in bat files? Absolutely. Can Batch object-oriented design achieve the efficiency and scale of other languages? No. After reading this chapter, how many Batch coders will propose an enterprise-wide object-oriented project to their employer? Not many. If that number is greater than zero, how many will still be employed in three months? Most assuredly none. How many coders will try to incorporate elements of Batch object-oriented design into their code? Hard to say, but I’m hoping for quite a few.</p>
<p class="tx">Object-oriented design is this book’s d<span class="copyright_accent">é</span>nouement, so why is this merely the penultimate chapter of the book? In the next and final chapter, I’ll introduce two data structures: stacks and queues. But I’ll also use these data structures as an opportunity to further demonstrate object-oriented design, because this discussion is far from complete. The model I’ve detailed in this chapter implements every possible object-oriented design principle, but it isn’t how I usually code Batch objects. It’s better to use only what’s needed and not what isn’t. When building stacks and queues in the next chapter, you’ll see real-world objects for each, and I’ll also share some final thoughts about Batch object-oriented design.</p>
</section>
</section>
</div></body></html>