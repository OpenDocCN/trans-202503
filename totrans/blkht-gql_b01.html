<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" epub:prefix="index: http://www.index.com/" lang="en" xml:lang="en">
<head>
<title>Appendix A: GraphQL API Testing Checklist</title>
<link href="NSTemplate_v1.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:c77cce49-9403-4fd1-99ba-33d115574b0c" name="Adept.expected.resource"/>
</head>
<body>
<section><header>
<h1 class="Appendix"><span class="AppendixNumber"><span epub:type="pagebreak" id="Page_269" title="269"/><a class="XrefDestination" id="A"/><span class="XrefDestination" id="xref-502840b01-001"/>A</span><br/>
<span class="AppendixTitle">GraphQL API Testing Checklist</span></h1>
</header>
<h2 id="h1-502840b01-0001"><a class="XrefDestination" id="Reconnaissance"/><span class="XrefDestination" id="xref-502840b01-002"/>Reconnaissance</h2>
<ol class="ListCheck">
<li class="check">Perform a port scan using Nmap to identify open web application ports.</li>
<li class="check">Scan the web server for GraphQL endpoints by using Graphw00f’s detection mode.</li>
<li class="check">Perform server fingerprinting with Graphw00f’s fingerprint mode.</li>
<li class="check">Search for server-level vulnerabilities on MITRE’s CVE database.</li>
<li class="check">Search for server-level security features on GraphQL Threat Matrix.</li>
<li class="check">Search for GraphQL IDEs such as GraphiQL Explorer or GraphQL Playground by using EyeWitness.</li>
<li class="check">Send an introspection query and document all available queries, mutations, and subscriptions.</li>
<li class="check">Visualize the introspection query response with GraphQL Voyager.</li>
</ol>
<h2 id="h1-502840b01-0002"><span epub:type="pagebreak" id="Page_270" title="270"/><a class="XrefDestination" id="DenialofService"/><span class="XrefDestination" id="xref-502840b01-003"/>Denial of Service</h2>
<ol class="ListCheck">
<li class="check">Review the API’s SDL file for bidirectional relationships.</li>
<li class="check">Test for the following:
<ol class="ListCheckSub">
<li class="check">Circular queries or mutations</li>
<li class="check">Circular fragments</li>
<li class="check">Field duplication</li>
<li class="check">Alias overloading</li>
<li class="check">Directive overloading</li>
<li class="check">Array-based or alias-based query batching</li>
<li class="check">Object limit overriding in API pagination arguments such as <code>filter</code>, <code>max</code>, <code>limit</code>, and <code>total</code></li>
</ol>
</li>
</ol>
<h2 id="h1-502840b01-0003"><a class="XrefDestination" id="InformationDisclosure"/><span class="XrefDestination" id="xref-502840b01-004"/>Information Disclosure</h2>
<ol class="ListCheck">
<li class="check">Extract the GraphQL schema by using field stuffing when introspection is disabled.</li>
<li class="check">Identify debug errors in query responses by sending malformed queries.</li>
<li class="check">Identify query tracing in GraphQL responses.</li>
<li class="check">Test for any PII submitted using queries over the GET method.</li>
</ol>
<h2 id="h1-502840b01-0004"><a class="XrefDestination" id="AuthenticationandAuthorization"/><span class="XrefDestination" id="xref-502840b01-005"/>Authentication and Authorization</h2>
<ol class="ListCheck">
<li class="check">Test access to the following:
<ol class="ListCheckSub">
<li class="check">The API without authentication headers</li>
<li class="check">Restricted fields by using alternate paths</li>
<li class="check">The API by using both the GET and POST methods</li>
</ol>
</li>
<li class="check">Test signature validation in JSON Web Token (JWT).</li>
<li class="check">Attempt to brute-force mutations or queries that accept secrets, such as tokens or passwords, using the following:
<ol class="ListCheckSub">
<li class="check">Alias-based query batching</li>
<li class="check">Array-based query batching</li>
<li class="check">CrackQL</li>
<li class="check">Burp Suite</li>
</ol>
</li>
</ol>
<h2 id="h1-502840b01-0005"><span epub:type="pagebreak" id="Page_271" title="271"/><a class="XrefDestination" id="Injection"/><span class="XrefDestination" id="xref-502840b01-006"/>Injection</h2>
<ol class="ListCheck">
<li class="check">Test for injection in the following:
<ol class="ListCheckSub">
<li class="check">Query arguments</li>
<li class="check">Field arguments</li>
<li class="check">Query directive arguments</li>
<li class="check">Operation names</li>
</ol>
</li>
<li class="check">Test for SQLi automatically by using SQLmap.</li>
<li class="check">Test for OS command injection automatically by using Commix.</li>
</ol>
<h2 id="h1-502840b01-0006"><a class="XrefDestination" id="ForgingRequests"/><span class="XrefDestination" id="xref-502840b01-007"/>Forging Requests</h2>
<ol class="ListCheck">
<li class="check">Test for the following:
<ol class="ListCheckSub">
<li class="check">The existence of anti-CSRF tokens in HTTP headers or bodies</li>
<li class="check">Possible anti-CSRF token bypasses</li>
<li class="check">The availability of GET-based queries</li>
<li class="check">Support for GET-based mutations</li>
</ol>
</li>
<li class="check">Perform state-changing mutations over GET.</li>
<li class="check">Perform state-changing mutations over POST.</li>
</ol>
<h2 id="h1-502840b01-0007"><a class="XrefDestination" id="HijackingRequests"/><span class="XrefDestination" id="xref-502840b01-008"/>Hijacking Requests</h2>
<ol class="ListCheck">
<li class="check">Identify whether the GraphQL server does the following:
<ol class="ListCheckSub">
<li class="check">Supports subscriptions</li>
<li class="check">Validates the <code>Origin</code> header during a WebSocket handshake</li>
</ol>
</li>
</ol>
</section>
</body>
</html>