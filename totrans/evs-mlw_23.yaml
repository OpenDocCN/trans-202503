- en: <hgroup>
  id: totrans-0
  prefs: []
  type: TYPE_NORMAL
  zh: <hgroup>
- en: <samp class="SANS_Futura_Std_Bold_Condensed_B_11">B</samp> <samp class="SANS_Dogma_OT_Bold_B_11">WINDOWS
    FUNCTIONS USED FOR EVASION</samp>
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: <samp class="SANS_Futura_Std_Bold_Condensed_B_11">B</samp> <samp class="SANS_Dogma_OT_Bold_B_11">用于规避的
    WINDOWS 函数</samp>
- en: </hgroup>
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: </hgroup>
- en: '![](../images/opener.jpg)'
  id: totrans-3
  prefs: []
  type: TYPE_IMG
  zh: '![](../images/opener.jpg)'
- en: This appendix describes Windows functions that are commonly used for some of
    the evasion techniques discussed in this book. While it’s not a comprehensive
    list of functions that might be abused by threat actors, these are some of the
    ones I believe are the most interesting or important to be familiar with for the
    purposes of malware analysis.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本附录描述了在本书中讨论的某些规避技术中常用的 Windows 函数。虽然这不是威胁行为者可能滥用的函数的全面列表，但这些是我认为在恶意软件分析中最有趣或最重要的函数，值得熟悉。
- en: Note that the functions are written without their *A* and *W* suffixes. For
    example, <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateFileW</samp> is listed
    only as <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateFile</samp>. Also,
    some functions have both an *Nt* and a *Zw* variant, such as <samp class="SANS_TheSansMonoCd_W5Regular_11">NtLoadDriver</samp>
    and <samp class="SANS_TheSansMonoCd_W5Regular_11">ZwLoadDriver</samp>, but only
    the *Nt* variant is listed here. For more information on these variations, see
    [Chapter 1](chapter1.xhtml).
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，这些函数是去掉了它们的 *A* 和 *W* 后缀。例如，<samp class="SANS_TheSansMonoCd_W5Regular_11">CreateFileW</samp>
    只列为 <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateFile</samp>。此外，一些函数有 *Nt*
    和 *Zw* 两个变体，如 <samp class="SANS_TheSansMonoCd_W5Regular_11">NtLoadDriver</samp>
    和 <samp class="SANS_TheSansMonoCd_W5Regular_11">ZwLoadDriver</samp>，但这里只列出了 *Nt*
    变体。有关这些变体的更多信息，请参见 [第1章](chapter1.xhtml)。
- en: You can find a more complete list of commonly abused functions at [*https://<wbr>malapi<wbr>.io*](https://malapi.io).
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在 [*https://<wbr>malapi<wbr>.io*](https://malapi.io) 找到常见滥用函数的更完整列表。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">AddAtom</samp>
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">AddAtom</samp>
- en: Adds a string to the local atom table. Can be used as part of certain process
    injection techniques, such as atom bombing.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 将字符串添加到本地原子表中。可用作某些进程注入技术的一部分，如原子轰炸。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">AddVectoredExceptionHandler</samp>
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">AddVectoredExceptionHandler</samp>
- en: Registers a new vectored exception handler. Can be used to abuse exceptions
    for the purposes of anti-analysis and anti-debugging. An alternative function
    is <samp class="SANS_TheSansMonoCd_W5Regular_11">RtlAddVectoredExceptionHandler</samp>.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 注册一个新的向量化异常处理程序。可用于滥用异常进行反分析和反调试。替代函数是 <samp class="SANS_TheSansMonoCd_W5Regular_11">RtlAddVectoredExceptionHandler</samp>。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">AdjustTokenPrivileges</samp>
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">AdjustTokenPrivileges</samp>
- en: Enables or disables privileges of an access token. Can be abused to elevate
    privileges.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 启用或禁用访问令牌的权限。可以被滥用来提升权限。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">BCrypt*</samp>
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">BCrypt*</samp>
- en: See the <samp class="SANS_TheSansMonoCd_W5Regular_11">Crypt*</samp> functions.
    All functions that begin with <samp class="SANS_TheSansMonoCd_W5Regular_11">BCrypt*</samp>
    (such as <samp class="SANS_TheSansMonoCd_W5Regular_11">BCryptEncrypt</samp> and
    <samp class="SANS_TheSansMonoCd_W5Regular_11">BCryptDestroyKey</samp>) align to
    their equivalent <samp class="SANS_TheSansMonoCd_W5Regular_11">Crypt*</samp> function
    (such as <samp class="SANS_TheSansMonoCd_W5Regular_11">CryptEncrypt</samp> and
    <samp class="SANS_TheSansMonoCd_W5Regular_11">CryptDestroyKey</samp>).
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 请参见 <samp class="SANS_TheSansMonoCd_W5Regular_11">Crypt*</samp> 函数。所有以 <samp
    class="SANS_TheSansMonoCd_W5Regular_11">BCrypt*</samp> 开头的函数（如 <samp class="SANS_TheSansMonoCd_W5Regular_11">BCryptEncrypt</samp>
    和 <samp class="SANS_TheSansMonoCd_W5Regular_11">BCryptDestroyKey</samp>）与它们对应的
    <samp class="SANS_TheSansMonoCd_W5Regular_11">Crypt*</samp> 函数（如 <samp class="SANS_TheSansMonoCd_W5Regular_11">CryptEncrypt</samp>
    和 <samp class="SANS_TheSansMonoCd_W5Regular_11">CryptDestroyKey</samp>）对齐。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">BlockInput</samp>
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">BlockInput</samp>
- en: Blocks input from reaching applications. Can be used as an anti-debugging technique
    to block interaction with the debugger.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 阻止输入到达应用程序。可以作为反调试技术来阻止与调试器的交互。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CallNtPowerInformation</samp>
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CallNtPowerInformation</samp>
- en: Returns information such as the battery state and last sleep time, which can
    be used to infer if the system is a VM.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 返回诸如电池状态和上次睡眠时间等信息，这些信息可用于推断系统是否为虚拟机。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CheckRemoteDebuggerPresent</samp>
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CheckRemoteDebuggerPresent</samp>
- en: Returns a nonzero value if the current process is being debugged; otherwise,
    returns zero. Can be used to detect a debugger in use.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 如果当前进程正在被调试，则返回非零值；否则返回零。可用于检测正在使用的调试器。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CloseHandle</samp>
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CloseHandle</samp>
- en: Closes an open handle. Can be used as an anti-debugging technique to crash certain
    debuggers under specific circumstances. An alternative is the now-deprecated <samp
    class="SANS_TheSansMonoCd_W5Regular_11">NtClose</samp> function.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 关闭一个打开的句柄。可以作为反调试技术，在特定情况下使某些调试器崩溃。替代方法是现已弃用的 <samp class="SANS_TheSansMonoCd_W5Regular_11">NtClose</samp>
    函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateFile</samp>
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateFile</samp>
- en: Gets a handle to a file or creates a new file. Can be used for many purposes,
    including VM and sandbox detection (to search for hypervisor-related files and
    pipes, for example). An alternative is the <samp class="SANS_TheSansMonoCd_W5Regular_11">NtCreateFile</samp>
    function.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 获取文件句柄或创建新文件。可用于多种用途，包括虚拟机和沙盒检测（例如，查找与虚拟机监控器相关的文件和管道）。替代方法是 <samp class="SANS_TheSansMonoCd_W5Regular_11">NtCreateFile</samp>
    函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateFileTransacted</samp>
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateFileTransacted</samp>
- en: Creates or opens a file as an NTFS transacted operation. Can be used for process
    manipulation, such as process doppelganging.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 创建或打开一个文件，作为 NTFS 事务操作。可用于进程操控，例如进程双重化。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateMutex(Ex)</samp>
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateMutex(Ex)</samp>
- en: Opens a mutex object or creates a new mutex. Can be used to enumerate mutexes
    related to hypervisors as a VM and sandbox detection technique.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 打开一个互斥对象或创建一个新的互斥。可用于枚举与虚拟机监控器相关的互斥对象，作为虚拟机和沙盒检测技术的一部分。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateProcess</samp>
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateProcess</samp>
- en: Creates a new process and is often called as part of process injection or during
    unpacking. Alternatives are the <samp class="SANS_TheSansMonoCd_W5Regular_11">NtCreateProcess(Ex)</samp>,
    <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateProcessInternal</samp>, and
    <samp class="SANS_TheSansMonoCd_W5Regular_11">NtCreateUserProcess</samp> functions.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个新进程，通常作为进程注入的一部分或解包过程中调用。替代方法包括 <samp class="SANS_TheSansMonoCd_W5Regular_11">NtCreateProcess(Ex)</samp>、<samp
    class="SANS_TheSansMonoCd_W5Regular_11">CreateProcessInternal</samp> 和 <samp class="SANS_TheSansMonoCd_W5Regular_11">NtCreateUserProcess</samp>
    函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateProcessWithToken</samp>
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateProcessWithToken</samp>
- en: Creates a new process, assigning it the permissions of an existing token. Can
    be abused for privilege elevation and defense evasion.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个新进程，并将现有令牌的权限分配给该进程。可以被滥用用于提升权限和绕过防御。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateRemoteThread</samp>
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateRemoteThread</samp>
- en: Executes a new thread in the address space of another process and is often used
    as part of various process injection techniques. Alternatives include the <samp
    class="SANS_TheSansMonoCd_W5Regular_11">NtCreateThreadEx</samp> and <samp class="SANS_TheSansMonoCd_W5Regular_11">RtlCreateUserThread</samp>
    functions.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在另一个进程的地址空间中执行新线程，通常作为各种进程注入技术的一部分。替代方法包括 <samp class="SANS_TheSansMonoCd_W5Regular_11">NtCreateThreadEx</samp>
    和 <samp class="SANS_TheSansMonoCd_W5Regular_11">RtlCreateUserThread</samp> 函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateService</samp>
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateService</samp>
- en: Creates a service. Can be used for persistence or for loading malicious kernel
    modules.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个服务。可以用于持久化或加载恶意内核模块。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateToolhelp32Snapshot</samp>
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateToolhelp32Snapshot</samp>
- en: Creates a snapshot of the currently running processes on the system. Can be
    used to locate processes on the system for injection or for VM detection. Typically
    called before <samp class="SANS_TheSansMonoCd_W5Regular_11">GetProcess32First</samp>
    and <samp class="SANS_TheSansMonoCd_W5Regular_11">GetProcess32Next</samp>.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 创建当前系统上正在运行的进程的快照。可以用于定位系统中的进程进行注入或虚拟机检测。通常在调用 <samp class="SANS_TheSansMonoCd_W5Regular_11">GetProcess32First</samp>
    和 <samp class="SANS_TheSansMonoCd_W5Regular_11">GetProcess32Next</samp> 之前调用。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateTransaction</samp>
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">CreateTransaction</samp>
- en: Creates a new NTFS transaction object. An alternative is the <samp class="SANS_TheSansMonoCd_W5Regular_11">NtCreateTransaction</samp>
    function. *See also* <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateFileTransacted</samp>.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个新的NTFS事务对象。另一个可选的函数是<samp class="SANS_TheSansMonoCd_W5Regular_11">NtCreateTransaction</samp>函数。*另请参见*
    <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateFileTransacted</samp>。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">Crypt*</samp>
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">Crypt*</samp>
- en: Functions that begin with <samp class="SANS_TheSansMonoCd_W5Regular_11">Crypt</samp>
    (such as <samp class="SANS_TheSansMonoCd_W5Regular_11">CryptEncrypt</samp>, <samp
    class="SANS_TheSansMonoCd_W5Regular_11">CryptDecrypt</samp>, and <samp class="SANS_TheSansMonoCd_W5Regular_11">CryptCreateHash</samp>)
    are used for various cryptographic operations, such as encrypting and hashing
    data, often for the purposes of obfuscation and defense evasion.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 以<samp class="SANS_TheSansMonoCd_W5Regular_11">Crypt</samp>开头的函数（例如<samp class="SANS_TheSansMonoCd_W5Regular_11">CryptEncrypt</samp>、<samp
    class="SANS_TheSansMonoCd_W5Regular_11">CryptDecrypt</samp>、和<samp class="SANS_TheSansMonoCd_W5Regular_11">CryptCreateHash</samp>）用于各种加密操作，如加密和数据哈希，通常用于混淆和规避防御。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">DebugActiveProcess</samp>
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">DebugActiveProcess</samp>
- en: Enables a debugger to attach to an active process. Can be used to detect a debugger.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 使调试器能够附加到一个活动进程。可用于检测调试器。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">DeleteFile</samp>
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">DeleteFile</samp>
- en: Deletes a file or directory. Can be used to hide artifacts on disk by removing
    them. An alternative is the <samp class="SANS_TheSansMonoCd_W5Regular_11">NtDeleteFile</samp>
    function.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 删除文件或目录。可通过删除它们来隐藏磁盘上的痕迹。另一个可选函数是<samp class="SANS_TheSansMonoCd_W5Regular_11">NtDeleteFile</samp>函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">DeviceIOControl</samp>
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">DeviceIOControl</samp>
- en: Allows a process in user space to send a control code to a driver in kernel
    space. Often used by rootkits to send control codes to malicious kernel drivers.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 允许用户空间的进程向内核空间的驱动程序发送控制码。通常被Rootkit用来向恶意内核驱动发送控制码。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">DsGetDcName</samp>
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">DsGetDcName</samp>
- en: Retrieves the name of the system’s domain controller and is often used to detect
    if the system is part of a domain for context awareness, targeting, or sandbox
    detection purposes.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 检索系统域控制器的名称，常用于检测系统是否属于某个域，以便进行上下文感知、定向攻击或沙箱检测。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">DuplicateToken(Ex)</samp>
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">DuplicateToken(Ex)</samp>
- en: Creates a “copy” of a token assigned to another process. Often followed by a
    call to a function such as <samp class="SANS_TheSansMonoCd_W5Regular_11">ImpersonateLoggedOnUser</samp>
    as part of privilege elevation and defense evasion.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个“副本”令牌并分配给另一个进程。通常会跟随一个类似于<samp class="SANS_TheSansMonoCd_W5Regular_11">ImpersonateLoggedOnUser</samp>的函数调用，作为提升权限和规避防御的一部分。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">EnumDisplayMonitors</samp>
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">EnumDisplayMonitors</samp>
- en: Identifies the number of monitors configured on the system to infer if the system
    is a VM or sandbox.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 识别系统中配置的监视器数量，以推断系统是虚拟机还是沙箱。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">EnumServiceStatus(Ex)</samp>
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">EnumServiceStatus(Ex)</samp>
- en: Enumerates services on the system. Can be used to identify hypervisor-related
    services for VM detection.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 枚举系统上的服务。可用于识别与虚拟机相关的服务，以进行虚拟机检测。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">EnumSystemFirmwareTables</samp>
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">EnumSystemFirmwareTables</samp>
- en: Enumerates system firmware tables. Can be used to identify hardware on the system
    and detect a VM.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 枚举系统固件表。可用于识别系统硬件并检测虚拟机。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">EnumWindows</samp>
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">EnumWindows</samp>
- en: Enumerates open windows. Can be used to detect malware analysis tools and debuggers.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 枚举打开的窗口。可用于检测恶意软件分析工具和调试器。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">ExitProcess</samp>
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">ExitProcess</samp>
- en: Ends a process and can be used as an anti-analysis technique.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 结束一个进程，并可作为反分析技术使用。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">ExitWindows(Ex)</samp>
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">ExitWindows(Ex)</samp>
- en: Logs out of the current user account or shuts down the system. Can be used as
    an anti-analysis and anti-sandbox technique.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 注销当前用户账户或关闭系统。可作为反分析和反沙箱技术使用。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">FindFirstFile(Ex)</samp>
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">FindFirstFile(Ex)</samp>
- en: Enumerates files on the filesystem. Can be used to locate hypervisor-related
    files for VM and sandbox detection. Called prior to <samp class="SANS_TheSansMonoCd_W5Regular_11">FindNextFile</samp>,
    which iterates through each file on the system.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 枚举文件系统中的文件。可用于定位与虚拟机和沙箱检测相关的虚拟化程序文件。在调用 <samp class="SANS_TheSansMonoCd_W5Regular_11">FindNextFile</samp>
    之前执行，该函数遍历系统中的每个文件。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">FindFirstUrlCacheEntry(Ex)</samp>
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">FindFirstUrlCacheEntry(Ex)</samp>
- en: Enumerates the browser cache. Lack of browser cache data could indicate a VM
    or sandbox environment. Called prior to <samp class="SANS_TheSansMonoCd_W5Regular_11">FindNextUrlCacheEntry(Ex)</samp>.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 枚举浏览器缓存。缺少浏览器缓存数据可能表示虚拟机或沙箱环境。在调用 <samp class="SANS_TheSansMonoCd_W5Regular_11">FindNextUrlCacheEntry(Ex)</samp>
    之前执行。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">FindWindow(Ex)</samp>
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">FindWindow(Ex)</samp>
- en: Locates a certain window, such as a specific analysis tool or debugger.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 定位某个特定的窗口，例如特定的分析工具或调试器。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">FltEnumerateFilters</samp>
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">FltEnumerateFilters</samp>
- en: Can be used by rootkits to enumerate minifilter drivers in the system, sometimes
    in preparation for installing a hook. Alternatives are the <samp class="SANS_TheSansMonoCd_W5Regular_11">FltEnumerateInstances</samp>
    and <samp class="SANS_TheSansMonoCd_W5Regular_11">FltGetFilterFromName</samp>
    functions.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 可供rootkit用于枚举系统中的迷你过滤器驱动程序，有时在安装钩子之前使用。替代方案是 <samp class="SANS_TheSansMonoCd_W5Regular_11">FltEnumerateInstances</samp>
    和 <samp class="SANS_TheSansMonoCd_W5Regular_11">FltGetFilterFromName</samp> 函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">FltRegisterFilter</samp>
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">FltRegisterFilter</samp>
- en: Registers a new minifilter driver. May be seen in rootkits that attempt to install
    minifilter drivers.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 注册一个新的迷你过滤器驱动程序。可能在尝试安装迷你过滤器驱动程序的rootkit中看到。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetAdaptersAddresses</samp>
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetAdaptersAddresses</samp>
- en: Retrieves the IP and MAC addresses of the host’s network interfaces. Can be
    abused for VM and sandbox detection.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 检索主机网络接口的IP地址和MAC地址。可能被滥用来进行虚拟机和沙箱检测。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetAsyncKeyState</samp>
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetAsyncKeyState</samp>
- en: Retrieves a certain keyboard key state. Can be used for sandbox evasion (for
    example, to wait for a certain keypress).
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 检索某个键盘按键的状态。可用于沙箱规避（例如，等待某个键的按下）。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetComputerName(Ex)</samp>
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetComputerName(Ex)</samp>
- en: Retrieves the computer name of the system and is sometimes used to identify
    sandbox-related computer names.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 检索系统的计算机名称，有时用于识别与沙箱相关的计算机名称。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetCursorPos</samp>
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetCursorPos</samp>
- en: Gets the current mouse cursor position. Can be used for human-interaction detection
    for sandbox evasion purposes.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 获取当前鼠标光标的位置。可用于人机交互检测，以规避沙箱。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetDiskFreeSpace(Ex)</samp>
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetDiskFreeSpace(Ex)</samp>
- en: Returns the free disk space on the system and can be used to detect an analysis
    environment, especially if the VM is configured with a small amount of disk space.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 返回系统上的空闲磁盘空间，可用于检测分析环境，特别是当虚拟机配置有较小的磁盘空间时。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetForegroundWindow</samp>
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetForegroundWindow</samp>
- en: Gets information about the active foreground window and is sometimes used for
    analysis tool detection or sandbox evasion.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 获取活动前景窗口的信息，有时用于分析工具检测或规避沙箱。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetKeyboardLayout</samp>
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetKeyboardLayout</samp>
- en: Returns the active keyboard language of the host and is sometimes used for target
    profiling.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 返回主机的活动键盘语言，有时用于目标分析。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetKeyboardLayoutList</samp>
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetKeyboardLayoutList</samp>
- en: Returns a complete list of all keyboard languages that are installed on the
    host.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 返回主机上安装的所有键盘语言的完整列表。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetLastError</samp>
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetLastError</samp>
- en: Retrieves the calling thread’s last error value. Can be used in combination
    with <samp class="SANS_TheSansMonoCd_W5Regular_11">SetLastError</samp> and <samp
    class="SANS_TheSansMonoCd_W5Regular_11">OutputDebugString</samp> to detect debuggers
    and for other anti-analysis purposes.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 检索调用线程的最后错误值。可以与 <samp class="SANS_TheSansMonoCd_W5Regular_11">SetLastError</samp>
    和 <samp class="SANS_TheSansMonoCd_W5Regular_11">OutputDebugString</samp> 结合使用，用于检测调试器以及其他反分析目的。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetLocalTime</samp>
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetLocalTime</samp>
- en: Gets the current date and time of the system. Can be used to detect debugging
    or for other anti-analysis techniques, such as time bombing.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 获取系统的当前日期和时间。可以用于检测调试或其他反分析技术，如定时炸弹。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetLogicalProcessorInformation(Ex)</samp>
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetLogicalProcessorInformation(Ex)</samp>
- en: Returns information about the system’s processor. Can be used to identify a
    VM or sandbox environment.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 返回关于系统处理器的信息。可以用来识别虚拟机（VM）或沙箱环境。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetModuleFileName(Ex)</samp>
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetModuleFileName(Ex)</samp>
- en: Retrieves the path for the file that contains a specific module, or retrieves
    the path of the executable file of the current process. Can be used to enumerate
    loaded modules, such as anomalous modules injected by analysis tools, or to retrieve
    its own executable’s path.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 检索包含特定模块的文件路径，或者检索当前进程的可执行文件路径。可以用来枚举已加载的模块，如分析工具注入的异常模块，或检索自身可执行文件的路径。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetModuleHandle(Ex)</samp>
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetModuleHandle(Ex)</samp>
- en: Returns a handle to a loaded module.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 返回已加载模块的句柄。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetPhysicallyInstalledSystemMemory</samp>
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetPhysicallyInstalledSystemMemory</samp>
- en: Returns the amount of physical system memory. Can be abused to identify a VM
    or sandbox environment.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 返回系统的物理内存大小。可以被滥用来识别虚拟机（VM）或沙箱环境。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetProcAddress</samp>
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetProcAddress</samp>
- en: Gets the procedure address of a function. Can be combined with <samp class="SANS_TheSansMonoCd_W5Regular_11">LoadLibrary</samp>
    to dynamically load libraries and functions for endpoint defense evasion and anti-analysis.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 获取函数的过程地址。可以与 <samp class="SANS_TheSansMonoCd_W5Regular_11">LoadLibrary</samp>
    结合使用，动态加载库和函数，用于端点防御规避和反分析。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetSystemFirmwareTable</samp>
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetSystemFirmwareTable</samp>
- en: Retrieves various firmware tables from the system. Can be used to search for
    hypervisor-related firmware as a VM and sandbox detection technique. An alternative
    is the <samp class="SANS_TheSansMonoCd_W5Regular_11">EnumSystemFirmwareTables</samp>
    function.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 检索系统中的各种固件表。可以用作虚拟机（VM）和沙箱检测技术，通过搜索与虚拟机监控程序（hypervisor）相关的固件。另一种选择是 <samp class="SANS_TheSansMonoCd_W5Regular_11">EnumSystemFirmwareTables</samp>
    函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetSystemInfo</samp>
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetSystemInfo</samp>
- en: Returns information about the system. Can be used to detect a VM environment.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 返回关于系统的信息。可以用来检测虚拟机（VM）环境。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetSystemMetrics</samp>
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetSystemMetrics</samp>
- en: Returns information about system metrics and configurations.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 返回关于系统指标和配置的信息。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetSystemTime</samp>
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetSystemTime</samp>
- en: '*See* <samp class="SANS_TheSansMonoCd_W5Regular_11">GetLocalTime</samp>.'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: '*见* <samp class="SANS_TheSansMonoCd_W5Regular_11">GetLocalTime</samp>。'
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetTcpTable</samp>
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetTcpTable</samp>
- en: Returns the system’s IPv4 TCP connection table. May be used to detect a VM or
    sandbox that isn’t connected to a network or the internet.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 返回系统的 IPv4 TCP 连接表。可用于检测没有连接网络或互联网的虚拟机（VM）或沙箱。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetThreadContext</samp>
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetThreadContext</samp>
- en: Retrieves the context of the current thread. Can be used for detecting hardware
    breakpoints. An alternative is the <samp class="SANS_TheSansMonoCd_W5Regular_11">Wow64GetThreadContext</samp>
    function.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 检索当前线程的上下文。可以用来检测硬件断点。另一种选择是 <samp class="SANS_TheSansMonoCd_W5Regular_11">Wow64GetThreadContext</samp>
    函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetThreadLocale</samp>
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetThreadLocale</samp>
- en: Returns locale information about a running thread, such as the language in use.
    Can be used for target profiling.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 返回正在运行的线程的区域信息，例如当前使用的语言。可以用于目标分析。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetTickCount</samp>
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetTickCount</samp>
- en: Retrieves the number of milliseconds that have elapsed since the system was
    started. Can be used for many anti-analysis techniques, such as debugger detection.
    An alternative is the <samp class="SANS_TheSansMonoCd_W5Regular_11">GetTickCount64</samp>
    function.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 检索自系统启动以来已过去的毫秒数。可用于多种反分析技术，如调试器检测。替代方法是 <samp class="SANS_TheSansMonoCd_W5Regular_11">GetTickCount64</samp>
    函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetUserDefaultUILanguage</samp>
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetUserDefaultUILanguage</samp>
- en: Returns the currently logged-in user’s interface language. Can be used for the
    same purposes as <samp class="SANS_TheSansMonoCd_W5Regular_11">GetThreadLocale</samp>.
    Alternatives are the <samp class="SANS_TheSansMonoCd_W5Regular_11">GetSystemDefaultUILanguage</samp>,
    <samp class="SANS_TheSansMonoCd_W5Regular_11">GetSystemDefaultLCID</samp>, <samp
    class="SANS_TheSansMonoCd_W5Regular_11">GetUserDefaultLCID,</samp> and <samp class="SANS_TheSansMonoCd_W5Regular_11">GetProcessPreferredUILanguages</samp>
    functions.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 返回当前登录用户的界面语言。可用于与 <samp class="SANS_TheSansMonoCd_W5Regular_11">GetThreadLocale</samp>
    相同的目的。替代方法包括 <samp class="SANS_TheSansMonoCd_W5Regular_11">GetSystemDefaultUILanguage</samp>、<samp
    class="SANS_TheSansMonoCd_W5Regular_11">GetSystemDefaultLCID</samp>、<samp class="SANS_TheSansMonoCd_W5Regular_11">GetUserDefaultLCID</samp>
    和 <samp class="SANS_TheSansMonoCd_W5Regular_11">GetProcessPreferredUILanguages</samp>
    函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetVersion(Ex)</samp>
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetVersion(Ex)</samp>
- en: Retrieves the version information for the operating system. Can be used for
    target profiling.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 检索操作系统的版本信息。可用于目标配置文件分析。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetWindowText</samp>
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GetWindowText</samp>
- en: Obtains the title text of the window. Can be used to detect malware analysis
    tools.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 获取窗口的标题文本。可用于检测恶意软件分析工具。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GlobalAddAtom(Ex)</samp>
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GlobalAddAtom(Ex)</samp>
- en: Adds a string to the global atom table. *See also* <samp class="SANS_TheSansMonoCd_W5Regular_11">AddAtom</samp>.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 将字符串添加到全局原子表中。*另见* <samp class="SANS_TheSansMonoCd_W5Regular_11">AddAtom</samp>。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GlobalGetAtomName</samp>
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">GlobalGetAtomName</samp>
- en: Retrieves the string in the specified global atom. *See also* <samp class="SANS_TheSansMonoCd_W5Regular_11">AddAtom</samp>.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 检索指定全局原子的字符串。*另见* <samp class="SANS_TheSansMonoCd_W5Regular_11">AddAtom</samp>。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">ImpersonateLoggedOnUser</samp>
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">ImpersonateLoggedOnUser</samp>
- en: Allows the calling thread to impersonate the security context of the logged-in
    user. *See also* <samp class="SANS_TheSansMonoCd_W5Regular_11">DuplicateToken(Ex)</samp>.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 允许调用线程模拟登录用户的安全上下文。*另见* <samp class="SANS_TheSansMonoCd_W5Regular_11">DuplicateToken(Ex)</samp>。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">InitiateShutdown</samp>
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">InitiateShutdown</samp>
- en: Shuts down and restarts the system. Can be used as an anti-analysis and anti-sandbox
    technique. An alternative is the <samp class="SANS_TheSansMonoCd_W5Regular_11">InitiateSystemShutdown(Ex)</samp>
    function.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 关闭并重启系统。可用作反分析和反沙箱技术。替代方法是 <samp class="SANS_TheSansMonoCd_W5Regular_11">InitiateSystemShutdown(Ex)</samp>
    函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">InternetConnect</samp>
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">InternetConnect</samp>
- en: Opens an FTP or HTTP internet connection. Can be used for many different evasion
    techniques, such as identifying whether or not a system is connected to the internet
    to detect a sandbox or VM. Often used in combination with <samp class="SANS_TheSansMonoCd_W5Regular_11">InternetOpen</samp>
    and <samp class="SANS_TheSansMonoCd_W5Regular_11">InternetReadFile</samp>.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 打开 FTP 或 HTTP 网络连接。可用于多种规避技术，如判断系统是否连接到互联网，以检测沙箱或虚拟机。常与 <samp class="SANS_TheSansMonoCd_W5Regular_11">InternetOpen</samp>
    和 <samp class="SANS_TheSansMonoCd_W5Regular_11">InternetReadFile</samp> 结合使用。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">IsDebuggerPresent</samp>
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">IsDebuggerPresent</samp>
- en: Checks whether the calling process is being debugged. *See also* <samp class="SANS_TheSansMonoCd_W5Regular_11">CheckRemoteDebuggerPresent</samp>.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 检查调用进程是否正在被调试。*另见* <samp class="SANS_TheSansMonoCd_W5Regular_11">CheckRemoteDebuggerPresent</samp>。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">IsProcessorFeaturePresent</samp>
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">IsProcessorFeaturePresent</samp>
- en: Returns the status of various processor features, which can indicate a VM.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 返回各种处理器功能的状态，这些功能可以指示虚拟机（VM）。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">LoadLibrary</samp>
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">LoadLibrary</samp>
- en: Loads a module into the process address space of the calling process. *See also*
    <samp class="SANS_TheSansMonoCd_W5Regular_11">GetProcAddress</samp>.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 将模块加载到调用进程的地址空间中。*参见* <samp class="SANS_TheSansMonoCd_W5Regular_11">GetProcAddress</samp>。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">Module32First</samp>
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">Module32First</samp>
- en: Gets information about the first module loaded into a process. Can be used in
    combination with <samp class="SANS_TheSansMonoCd_W5Regular_11">Module32Next</samp>
    to enumerate and identify modules associated with analysis tools.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 获取关于进程中加载的第一个模块的信息。可以与 <samp class="SANS_TheSansMonoCd_W5Regular_11">Module32Next</samp>
    一起使用，枚举和识别与分析工具相关的模块。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtCreateTransaction</samp>
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtCreateTransaction</samp>
- en: Creates a new NTFS transaction object. Can be used for process manipulation
    techniques, such as process doppelganging.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个新的 NTFS 事务对象。可用于进程操作技术，如进程伪装（process doppelganging）。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtLoadDriver</samp>
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtLoadDriver</samp>
- en: Loads a driver into the system. Can be invoked to load a malicious kernel module.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 将驱动程序加载到系统中。可以调用该功能来加载恶意的内核模块。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtMapViewOfSection</samp>
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtMapViewOfSection</samp>
- en: Maps a view of a section into the process address space of a target process.
    Can be used to manually map a library or code into memory as part of process injection.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 将一个视图映射到目标进程的地址空间中。可用于手动将库或代码映射到内存中，作为进程注入的一部分。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtOpenDirectoryObject</samp>
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtOpenDirectoryObject</samp>
- en: Can be used to query device and driver objects on the system. Sometimes used
    to locate VM-related artifacts as part of VM detection. An alternative is the
    <samp class="SANS_TheSansMonoCd_W5Regular_11">NtQueryDirectoryObject</samp> function.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 可用于查询系统上的设备和驱动程序对象。有时用来定位虚拟机相关的文物，作为虚拟机检测的一部分。另一个替代方案是 <samp class="SANS_TheSansMonoCd_W5Regular_11">NtQueryDirectoryObject</samp>
    函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtQueryInformationProcess</samp>
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtQueryInformationProcess</samp>
- en: Returns a great deal of information about a target process. Can be used to identify
    attached debuggers.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 返回大量有关目标进程的信息。可以用来识别附加的调试器。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtQueryObject</samp>
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtQueryObject</samp>
- en: Returns information on different operating system objects. Can be used to identify
    debugger objects, indicating to the malware that it is being debugged.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 返回有关不同操作系统对象的信息。可用于识别调试器对象，指示恶意软件正在被调试。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtQuerySystemInformation</samp>
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtQuerySystemInformation</samp>
- en: Returns a lot of different system information. Can be used to enumerate firmware
    tables to identify a VM or sandbox.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 返回许多不同的系统信息。可以用于枚举固件表以识别虚拟机或沙箱。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtQuerySystemTime</samp>
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtQuerySystemTime</samp>
- en: '*See* <samp class="SANS_TheSansMonoCd_W5Regular_11">GetLocalTime</samp>.'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '*参见* <samp class="SANS_TheSansMonoCd_W5Regular_11">GetLocalTime</samp>。'
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtSetInformationThread</samp>
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtSetInformationThread</samp>
- en: Sets the priority of a thread. Can be used to hide code execution from a debugger
    or, in certain circumstances, to crash the debugger.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 设置线程的优先级。可用于隐藏代码执行，避免调试器检测，或者在某些情况下导致调试器崩溃。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtUnmapViewOfSection</samp>
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">NtUnmapViewOfSection</samp>
- en: Unmaps a view of a section from memory. Sometimes used as part of process injection
    techniques.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 从内存中卸载一个视图。有时用作进程注入技术的一部分。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">OpenMutex</samp>
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">OpenMutex</samp>
- en: Opens a mutex object. *See also* <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateMutex</samp>.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 打开一个互斥体对象。*参见* <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateMutex</samp>。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">OpenProcess</samp>
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">OpenProcess</samp>
- en: Opens a process object and is often a precursor to process injection. An alternative
    is the <samp class="SANS_TheSansMonoCd_W5Regular_11">NtOpenProcess</samp> function.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 打开进程对象，通常是进程注入的前兆。另一个替代方案是 <samp class="SANS_TheSansMonoCd_W5Regular_11">NtOpenProcess</samp>
    函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">OpenProcessToken</samp>
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">OpenProcessToken</samp>
- en: Opens the access token of a process and is often a precursor to techniques such
    as privilege elevation. *See also* <samp class="SANS_TheSansMonoCd_W5Regular_11">AdjustTokenPrivileges</samp>.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 打开进程的访问令牌，通常是特权提升技术的前兆。*另见* <samp class="SANS_TheSansMonoCd_W5Regular_11">AdjustTokenPrivileges</samp>。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">OpenService</samp>
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">OpenService</samp>
- en: Opens a service. Can be used to identify services related to sandboxes and hypervisors.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 打开一个服务。可以用来识别与沙箱和虚拟机监控器相关的服务。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">OpenThread</samp>
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">OpenThread</samp>
- en: Opens a thread object. Can be used for process injection techniques, such as
    thread hijacking.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 打开一个线程对象。可以用于进程注入技术，例如线程劫持。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">OutputDebugString</samp>
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">OutputDebugString</samp>
- en: Sends a string to the debugger. Can be used for anti-debugging purposes. *See
    also* <samp class="SANS_TheSansMonoCd_W5Regular_11">GetLastError</samp>.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 将字符串发送到调试器。可以用于反调试目的。*另见* <samp class="SANS_TheSansMonoCd_W5Regular_11">GetLastError</samp>。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">PostMessage</samp>
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">PostMessage</samp>
- en: Closes application windows when the parameter <samp class="SANS_TheSansMonoCd_W5Regular_11">WS_CLOSE</samp>
    is passed to the window’s handle. Can be used as an anti-analysis technique.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 当传递 <samp class="SANS_TheSansMonoCd_W5Regular_11">WS_CLOSE</samp> 参数到窗口句柄时，关闭应用程序窗口。可以作为反分析技术使用。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">Process32First</samp>
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">Process32First</samp>
- en: Gathers information about the first process in a process snapshot. *See also*
    <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateToolhelp32Snapshot</samp>.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 收集进程快照中的第一个进程的信息。*另见* <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateToolhelp32Snapshot</samp>。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">Process32Next</samp>
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">Process32Next</samp>
- en: Gathers information about the next process in a process snapshot. *See also*
    <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateToolhelp32Snapshot</samp>.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 收集进程快照中的下一个进程的信息。*另见* <samp class="SANS_TheSansMonoCd_W5Regular_11">CreateToolhelp32Snapshot</samp>。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">PsLookupProcessByProcessID</samp>
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">PsLookupProcessByProcessID</samp>
- en: Gets a pointer to a process’s <samp class="SANS_TheSansMonoCd_W5Regular_11">EPROCESS</samp>
    structure. Sometimes used by rootkits in preparation for evasion techniques such
    as DKOM.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 获取指向进程 <samp class="SANS_TheSansMonoCd_W5Regular_11">EPROCESS</samp> 结构的指针。有时被
    rootkit 用来为规避技术（如 DKOM）做准备。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">PsSetCreateProcessNotifyRoutine(Ex)</samp>
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">PsSetCreateProcessNotifyRoutine(Ex)</samp>
- en: Registers a driver callback that will be triggered when any new process is created
    or terminated. Sometimes used by rootkits to monitor process creations.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 注册一个驱动程序回调函数，当任何新进程被创建或终止时触发。有时被 rootkit 用来监视进程创建。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">PsSetCreateThreadNotifyRoutine(Ex)</samp>
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">PsSetCreateThreadNotifyRoutine(Ex)</samp>
- en: Similar to <samp class="SANS_TheSansMonoCd_W5Regular_11">PsSetCreateProcessNotifyRoutine(Ex)</samp>,
    but for thread creation.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 与 <samp class="SANS_TheSansMonoCd_W5Regular_11">PsSetCreateProcessNotifyRoutine(Ex)</samp>
    类似，但用于线程创建。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">PsSetLoadImageNotifyRoutine(Ex)</samp>
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">PsSetLoadImageNotifyRoutine(Ex)</samp>
- en: Registers a callback that will be triggered when a process loads an image into
    memory, such as a DLL module, or when a new driver is loaded. Sometimes used by
    rootkits to monitor module loads.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 注册一个回调函数，当进程将图像加载到内存中时触发，例如加载 DLL 模块，或者当加载新驱动程序时触发。有时被 rootkit 用来监视模块加载。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">QueryPerformanceCounter</samp>
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">QueryPerformanceCounter</samp>
- en: Queries the processor’s performance counter and returns the current value. Can
    be used as part of anti-debugging and VM detection techniques.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 查询处理器的性能计数器并返回当前值。可以作为反调试和虚拟机检测技术的一部分使用。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">QueueUserAPC</samp>
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">QueueUserAPC</samp>
- en: Queues a new asynchronous procedure call and is sometimes invoked for process
    injection techniques, such as APC injection. An alternative function is <samp
    class="SANS_TheSansMonoCd_W5Regular_11">NtQueueApcThread</samp>.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 排队一个新的异步过程调用，有时用于进程注入技术，例如 APC 注入。一个替代函数是 <samp class="SANS_TheSansMonoCd_W5Regular_11">NtQueueApcThread</samp>。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">ReadProcessMemory</samp>
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">ReadProcessMemory</samp>
- en: Reads data from a memory region inside a target process. Can be used for many
    reasons, such as inspecting process memory for hooks as part of anti-hooking techniques.
    An alternative is the <samp class="SANS_TheSansMonoCd_W5Regular_11">NtReadVirtualMemory</samp>
    function.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 从目标进程的内存区域读取数据。可用于多种目的，例如检查进程内存中的钩子，作为反钩子技术的一部分。另一种选择是<samp class="SANS_TheSansMonoCd_W5Regular_11">NtReadVirtualMemory</samp>函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">RegEnumKey(Ex)</samp>
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">RegEnumKey(Ex)</samp>
- en: Enumerates a registry key. Can be used for VM detection or to otherwise identify
    registry keys of interest.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 枚举一个注册表键。可用于虚拟机检测或识别感兴趣的注册表键。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">RegEnumValue</samp>
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">RegEnumValue</samp>
- en: Enumerates a registry key value.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 枚举一个注册表键值。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">RegOpenKey(Ex)</samp>
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">RegOpenKey(Ex)</samp>
- en: Opens a registry key for reading or writing.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 打开一个注册表键用于读写操作。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">ResumeThread</samp>
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">ResumeThread</samp>
- en: Resumes execution of a thread and is often used for process injection, such
    as process hollowing. An alternative is the <samp class="SANS_TheSansMonoCd_W5Regular_11">NtResumeThread</samp>
    function.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 恢复线程执行，常用于进程注入，例如进程空洞技术。另一种选择是<samp class="SANS_TheSansMonoCd_W5Regular_11">NtResumeThread</samp>函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">RollbackTransaction</samp>
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">RollbackTransaction</samp>
- en: Rolls back an NTFS transaction and is used for process manipulation, such as
    in the process-doppelganging technique.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 回滚一个NTFS事务，并用于进程操作，例如在进程双重技术中。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">RtlCopyMemory</samp>
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">RtlCopyMemory</samp>
- en: Copies the contents of a source buffer in memory to another memory region. Can
    be invoked to write malicious code into memory, such as injecting a hook.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 将源缓冲区的内容从内存复制到另一个内存区域。可被调用将恶意代码写入内存，如注入钩子。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">RtlQueryProcessHeapInformation</samp>
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">RtlQueryProcessHeapInformation</samp>
- en: Returns information about the current process’s heap. Can be used to detect
    a debugger.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 返回有关当前进程堆的信息。可用于检测调试器。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">RtlZeroMemory</samp>
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">RtlZeroMemory</samp>
- en: Fills a region of memory with zeros. Can be used as an anti-forensics and defense
    evasion technique.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 将一块内存区域填充为零。可作为反取证和防御规避技术的一部分使用。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">SetFileAttributes</samp>
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">SetFileAttributes</samp>
- en: Sets various attributes for a file or directory. Can be used to hide files and
    directories via the <samp class="SANS_TheSansMonoCd_W5Regular_11">hidden</samp>
    attribute.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 为文件或目录设置各种属性。可通过<samp class="SANS_TheSansMonoCd_W5Regular_11">hidden</samp>属性来隐藏文件和目录。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">SetFileTime</samp>
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">SetFileTime</samp>
- en: Sets various timestamps for a file or directory. Can be used to falsify file
    timestamps (timestomping).
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 为文件或目录设置各种时间戳。可用于伪造文件时间戳（时间戳篡改）。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">SetPriorityClass</samp>
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">SetPriorityClass</samp>
- en: Sets the priority of a process. Can be abused to lower the priority of endpoint
    defense processes in an attempt to circumvent them.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 设置进程的优先级。可被滥用，通过降低终端防御进程的优先级来尝试规避它们。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">SetThreadContext</samp>
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">SetThreadContext</samp>
- en: Sets the context of a thread and is sometimes used for process injection techniques,
    specifically process hollowing.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 设置线程的上下文，有时用于进程注入技术，特别是进程空洞技术。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">SetUnhandledExceptionFilter</samp>
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">SetUnhandledExceptionFilter</samp>
- en: Allows the calling program to supersede the top-level exception handler. Can
    be used as part of anti-debugging and covert code execution techniques.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 允许调用程序覆盖顶级异常处理程序。可作为反调试和隐蔽代码执行技术的一部分使用。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">SetWindowsHookEx</samp>
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">SetWindowsHookEx</samp>
- en: Installs an application-defined hook. Can be used for multiple purposes, such
    as hooking keyboard and mouse events and injecting malicious code.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 安装一个应用程序定义的钩子。可用于多种目的，如钩住键盘和鼠标事件及注入恶意代码。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">Sleep(Ex)</samp>
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">Sleep(Ex)</samp>
- en: Suspends the execution of a thread for a specified amount of time. Can be used
    for many malicious purposes, such as sandbox evasion and various anti-debugging
    techniques.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 挂起线程的执行一段指定的时间。可以用于许多恶意目的，如沙箱规避和各种反调试技术。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">StartService</samp>
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">StartService</samp>
- en: Starts a service on the system. Can be used to establish persistence or load
    a malicious module.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 启动系统上的服务。可以用来建立持久性或加载恶意模块。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">SuspendThread</samp>
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">SuspendThread</samp>
- en: Suspends a thread and is used in certain process injection techniques, such
    as thread hijacking. An alternative is the <samp class="SANS_TheSansMonoCd_W5Regular_11">Wow64SuspendThread</samp>
    function.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 挂起一个线程，并在某些进程注入技术中使用，如线程劫持。另一种选择是<samp class="SANS_TheSansMonoCd_W5Regular_11">Wow64SuspendThread</samp>函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">TerminateProcess</samp>
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">TerminateProcess</samp>
- en: Terminates a specified process. Can be used as an anti-analysis technique.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 终止指定的进程。可用作一种反分析技术。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">VirtualAlloc(Ex)</samp>
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">VirtualAlloc(Ex)</samp>
- en: Allocates (reserves or commits) a region of virtual memory and is part of various
    process injection techniques. An alternative is the <samp class="SANS_TheSansMonoCd_W5Regular_11">NtAllocateVirtualMemory</samp>
    function.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 分配（保留或提交）一个虚拟内存区域，并且是各种进程注入技术的一部分。另一种选择是<samp class="SANS_TheSansMonoCd_W5Regular_11">NtAllocateVirtualMemory</samp>函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">VirtualQuery(Ex)</samp>
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">VirtualQuery(Ex)</samp>
- en: Returns information about a region of memory. Can be used to detect hardware
    and memory breakpoints. An alternative is the <samp class="SANS_TheSansMonoCd_W5Regular_11">NtQueryVirtualMemory</samp>
    function.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 返回关于内存区域的信息。可以用来检测硬件和内存断点。另一种选择是<samp class="SANS_TheSansMonoCd_W5Regular_11">NtQueryVirtualMemory</samp>函数。
- en: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">WriteProcessMemory</samp>
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: <samp class="SANS_TheSansMonoCd_W7Bold_B_11">WriteProcessMemory</samp>
- en: Writes data to a region of memory in a process and is used as part of various
    process injection techniques. An alternative is the <samp class="SANS_TheSansMonoCd_W5Regular_11">NtWriteVirtualMemory</samp>
    function.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 向进程中的内存区域写入数据，并作为各种进程注入技术的一部分使用。另一种选择是<samp class="SANS_TheSansMonoCd_W5Regular_11">NtWriteVirtualMemory</samp>函数。
