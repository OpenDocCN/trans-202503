<html><head></head><body>
<div id="sbo-rt-content"><section aria-labelledby="ch15" epub:type="chapter" role="doc-chapter">
<span aria-label="275" epub:type="pagebreak" id="pg_275" role="doc-pagebreak"/>
<hgroup>
<h2 class="CHAPTER" id="ch15">
<span class="CN"><span class="SANS_Futura_Std_Bold_Condensed_B_11">15</span></span>
<span class="CT"><span class="SANS_Dogma_OT_Bold_B_11">IMPLEMENTING A SHOPPING CART</span></span>
</h2>
</hgroup>
<figure class="opener"><img alt="" class="opener" height="380" src="../images/opener.jpg" width="380"/>
</figure>
<p class="INTRO">When browsing an online store, you expect to add items to a shopping cart and for them to be remembered until you’re ready to check out and pay. This is an extremely common requirement, so in this chapter we’ll focus on building an application with a shopping cart. In the process, you’ll learn how to work with sessions in a more sophisticated way, storing and updating whole arrays within the <span class="SANS_TheSansMonoCd_W5Regular_11">$_SESSION</span> superglobal. We’ll also continue our efforts to encapsulate the core logic for user actions into separate functions coordinated by a front-controller script, yielding a well-organized, easy-to-maintain application structure.</p>
<p class="TX"><span aria-label="276" epub:type="pagebreak" id="pg_276" role="doc-pagebreak"/>A <i>shopping cart</i> is basically a way to record which products and what quantities a user has selected. Our website therefore needs to show a list of products as well as enable the user to add items to their shopping cart and view its contents. We should also offer a way to edit the shopping cart, allowing the user to change quantities, remove items, or empty the cart altogether. As an example, <a href="#fig15-1">Figure 15-1</a> shows an Amazon shopping cart with a few items.</p>
<figure class="IMG"><a id="fig15-1"/><img alt="" class="img100" height="1014" src="../images/figure15-1.jpg" width="1503"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 15-1: An e-commerce shopping cart</span></p></figcaption>
</figure>
<p class="TX">Notice that the cart displays the cost of the individual items as well as a total cost of the entire order. The Amazon shopping cart page also offers ways to change the quantity of each item and to delete items from the cart. We’ll emulate all these features in our own shopping cart.</p>
<section aria-labelledby="sec1" epub:type="division">
<h3 class="H1" id="sec1"><span id="toc-link_199"/><span class="SANS_Futura_Std_Bold_B_11">The Shopping Cart File Structure</span></h3>
<p class="TNI1">Our shopping cart web application will span several files, including an <i>index.php</i> front-controller script, a <i>functions.php</i> file declaring various useful functions, a collection of template scripts, and other supporting files. The complete structure for the project will ultimately be as follows:</p>
<span aria-label="277" epub:type="pagebreak" id="pg_277" role="doc-pagebreak"/>
<figure class="IMG"><img alt="" class="img100" height="748" src="../images/pg277.jpg" width="1387"/>
</figure>
<p class="TX">For now, start a new PHP project, create the necessary folders, and copy the image files (<i>banana.png</i>, <i>pineapple.png</i>, and so on) from the book’s provided resource files into the <i>public/images</i> folder. With that, we’re ready to start building the application. The book resource files and exercise solutions can be found at <i><a href="https://github.com/dr-matt-smith/php-crash-course">https://github.com/dr-matt-smith/php-crash-course</a></i>.</p>
</section>
<section aria-labelledby="sec2" epub:type="division">
<h3 class="H1" id="sec2"><span id="toc-link_200"/><span class="SANS_Futura_Std_Bold_B_11">Defining the Product List</span></h3>
<p class="TNI1">Before we create the shopping cart itself, we’ll begin by building a list of products for the user to choose from. We’ll use an array to store the products available in our online shop. (Normally, product information would be stored in a database instead, but we won’t be covering these until <span class="Xref"><a href="part6.xhtml">Part VI</a>.</span>) In addition to the product array, we’ll use a second array stored in the session to keep track of the contents of each user’s shopping cart. You learned to loop through an array of products to automatically generate links featuring the product IDs in <span class="Xref"><a href="chapter11.xhtml">Chapter 11</a></span> (see <span class="Xref">Listing 11-11 on <a href="chapter11.xhtml#pg_214">page 214</a></span>). We’ll do something similar here.</p>
<p class="TX"><a href="#fig15-2">Figure 15-2</a> shows the product list page we’ll create. As usual, we can use a little Bootstrap to help produce a professional-looking page with minimal CSS.</p>
<span aria-label="278" epub:type="pagebreak" id="pg_278" role="doc-pagebreak"/>
<figure class="IMG"><a id="fig15-2"/><img alt="" class="img100" height="623" src="../images/figure15-2.jpg" width="1691"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 15-2: A page showing the list of products</span></p></figcaption>
</figure>
<p class="TX">We’ll have five products on our site. <a href="#tab15-1">Table 15-1</a> lists the data values we need to store for each product.</p>
<p class="TT"><a id="tab15-1"/><span class="Heavy"><span class="SANS_Futura_Std_Heavy_11">Table 15-1:</span></span> <span class="SANS_Futura_Std_Book_11">Product Details</span></p>
<table class="Basic-Table">
<thead>
<tr>
<th class="TCH" scope="col"><p class="TCH1"><span class="SANS_Futura_Std_Heavy_11">Attribute</span></p></th>
<th class="TCH" colspan="5" scope="colgroup"><p class="TCH1"><span class="SANS_Futura_Std_Heavy_11">Value of attribute per product</span></p></th>
</tr>
</thead>
<tbody>
<tr>
<td class="TBF"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">ID</span></p></td>
<td class="TBF"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">010</span></p></td>
<td class="TBF"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">025</span></p></td>
<td class="TBF"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">005</span></p></td>
<td class="TBF"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">021</span></p></td>
<td class="TBF"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">002</span></p></td>
</tr>
<tr>
<td class="TB"><p class="TB1"><span class="SANS_Futura_Std_Book_11">Name</span></p></td>
<td class="TB"><p class="TB1"><span class="SANS_Futura_Std_Book_11">Sandwich</span></p></td>
<td class="TB"><p class="TB1"><span class="SANS_Futura_Std_Book_11">Slice of cheesecake</span></p></td>
<td class="TB"><p class="TB1"><span class="SANS_Futura_Std_Book_11">Pineapple</span></p></td>
<td class="TB"><p class="TB1"><span class="SANS_Futura_Std_Book_11">Jelly donut</span></p></td>
<td class="TB"><p class="TB1"><span class="SANS_Futura_Std_Book_11">Banana</span></p></td>
</tr>
<tr>
<td class="TB"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">Description</span></p></td>
<td class="TB"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">A filling, savory snack of peanut butter and jelly.</span></p></td>
<td class="TB"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">Treat yourself to a chocolate-covered cheesecake slice.</span></p></td>
<td class="TB"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">A piece of exotic fruit.</span></p></td>
<td class="TB"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">The best type of donut — filled with sweet jam.</span></p></td>
<td class="TB"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">The basis for a good smoothie and high in potassium.</span></p></td>
</tr>
<tr>
<td class="TB"><p class="TB1"><span class="SANS_Futura_Std_Book_11">Price</span></p></td>
<td class="TB"><p class="TB1"><span class="SANS_Futura_Std_Book_11">1.00</span></p></td>
<td class="TB"><p class="TB1"><span class="SANS_Futura_Std_Book_11">2.00</span></p></td>
<td class="TB"><p class="TB1"><span class="SANS_Futura_Std_Book_11">3.00</span></p></td>
<td class="TB"><p class="TB1"><span class="SANS_Futura_Std_Book_11">2.50</span></p></td>
<td class="TB"><p class="TB1"><span class="SANS_Futura_Std_Book_11">0.50</span></p></td>
</tr>
<tr>
<td class="TB"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">Stars</span></p></td>
<td class="TB"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">4</span></p></td>
<td class="TB"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">5</span></p></td>
<td class="TB"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">2</span></p></td>
<td class="TB"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">3</span></p></td>
<td class="TB"><p class="TB_Grey"><span class="SANS_Futura_Std_Book_11">5</span></p></td>
</tr>
<tr>
<td class="TBL"><p class="TB1"><span class="SANS_Futura_Std_Book_11">Image</span></p></td>
<td class="TBL"><p class="TB1"><span class="SANS_Futura_Std_Book_Oblique_11">peanut _butter.png</span></p></td>
<td class="TBL"><p class="TB1"><span class="SANS_Futura_Std_Book_Oblique_11">chocolate_cheese _cake.png</span></p></td>
<td class="TBL"><p class="TB1"><span class="SANS_Futura_Std_Book_Oblique_11">pineapple.png</span></p></td>
<td class="TBL"><p class="TB1"><span class="SANS_Futura_Std_Book_Oblique_11">jellydonut.png</span></p></td>
<td class="TBL"><p class="TB1"><span class="SANS_Futura_Std_Book_Oblique_11">banana.png</span></p></td>
</tr>
</tbody>
</table>
<p class="TX">Notice that each product has a unique ID, name, description, price, star rating (from 1 to 5), and associated image filename. To implement all of this, we’ll create a <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> array that contains an element for each product, using the product IDs as keys. Each product in the array is itself an array with keys for each attribute, such as <span class="SANS_TheSansMonoCd_W5Regular_11">'name'</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">'description'</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">'price'</span>, and so on.</p>
<section aria-labelledby="sec3" epub:type="division">
<h4 class="H2" id="sec3"><span id="toc-link_201"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Creating the Products Array</span></h4>
<p class="TNI1">Listing 15-1 shows how to declare each product array element to store its data values, creating elements for the first two products. Enter this code into <i>public/index.php</i>.</p>
<span id="lis15-1"/>
<pre><code>&lt;?php&#13;
$products = [];&#13;
&#13;
$products['010'] = [&#13;
    'name' =&gt; 'Sandwich',&#13;
<span aria-label="279" epub:type="pagebreak" id="pg_279" role="doc-pagebreak"/>    'description' =&gt;&#13;
    'A filling, savory snack of peanut butter and jelly.',&#13;
    'price' =&gt; 1.00,&#13;
    'stars' =&gt; 4,&#13;
    'image' =&gt; 'peanut_butter.png'&#13;
];&#13;
&#13;
$products['025'] = [&#13;
    'name' =&gt; 'Slice of cheesecake',&#13;
    'description' =&gt;&#13;
    'Treat yourself to a chocolate-covered cheesecake slice.',&#13;
    'price' =&gt; 2.00,&#13;
    'stars' =&gt; 5,&#13;
    'image' =&gt; 'chocolate_cheese_cake.png'&#13;
];&#13;
<span class="TheSansMonoCd_W5Regular_Italic_11">--snip--</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-1: Declaring the first two products in</span> <span class="SANS_Futura_Std_Book_11">index.php</span></p>
<p class="TX">First, we create a new, empty array called <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span>. Then we use <span class="SANS_TheSansMonoCd_W5Regular_11">$products['010']</span> to append a new element to the end of <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span>, indexed with the key <span class="SANS_TheSansMonoCd_W5Regular_11">'010'</span>. This new element is set to an array containing the properties for the peanut butter and jelly sandwich. We then append another element to <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> with the key <span class="SANS_TheSansMonoCd_W5Regular_11">'025'</span>, containing an array with the properties for the cheesecake slice.</p>
<p class="TX">Using these first two products as a model, add the code declaring array elements for the remaining three products from <a href="#tab15-1">Table 15-1</a>. Be sure to use strings containing the products’ IDs as array keys.</p>
</section>
<section aria-labelledby="sec4" epub:type="division">
<h4 class="H2" id="sec4"><span id="toc-link_202"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Adding CSS</span></h4>
<p class="TNI1">We’ll need a little CSS to style the product list page, so create the <i>public/css/products.css</i> file containing the contents of <a href="#lis15-2">Listing 15-2</a>.</p>
<span id="lis15-2"/>
<pre><code>.glyphicon-star {&#13;
  <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> color: goldenrod;&#13;
    font-size: 150%;&#13;
}&#13;
&#13;
.glyphicon-star-empty {&#13;
  <span aria-label="annotation2" class="Code_CodeAnnotation">❷</span> color: darkgray;&#13;
    font-size: 150%;&#13;
}&#13;
&#13;
<span aria-label="annotation3" class="codeannotated_CodeAnnotation">❸</span> .product img {&#13;
    width: 100%;&#13;
}&#13;
&#13;
<span aria-label="annotation4" class="codeannotated_CodeAnnotation">❹</span> .price {&#13;
    font-size: 1.5rem;&#13;
    font-weight: bold;&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-2: The CSS to style the product list in</span> <span class="SANS_Futura_Std_Book_11">css/products.css</span></p>
<p class="TX"><span aria-label="280" epub:type="pagebreak" id="pg_280" role="doc-pagebreak"/>We first style the stars that represent the product’s ratings. We use Bootstrap Glyphicon stars. Filled stars will be gold <span aria-label="annotation1" class="CodeAnnotation">❶</span>, and disabled stars will be gray <span aria-label="annotation2" class="CodeAnnotation">❷</span>. Then we set the product images to fill (<span class="SANS_TheSansMonoCd_W5Regular_11">100%</span>) the available horizontal spaces (for dynamically flexed blocks) <span aria-label="annotation3" class="CodeAnnotation">❸</span>. I’ve used an image editor to make all images the same size for a consistent, professional look and feel. We also set the prices to be larger than normal text (<span class="SANS_TheSansMonoCd_W5Regular_11">1.5</span>) and bold <span aria-label="annotation4" class="CodeAnnotation">❹</span>. This will apply to prices both on the product list page and in the shopping cart itself.</p>
</section>
<section aria-labelledby="sec5" epub:type="division">
<h4 class="H2" id="sec5"><span id="toc-link_203"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Displaying the Star Ratings</span></h4>
<p class="TNI1">Next, we’ll write a PHP function that will return a string containing the HTML and CSS classes for a given number of stars. Create and complete the PHP script <i>src/functions.php</i>, based on the contents of <a href="#lis15-3">Listing 15-3</a>.</p>
<span id="lis15-3"/>
<pre><code>&lt;?php&#13;
function starsHtml($stars): string&#13;
{&#13;
    $s = '';&#13;
    switch ($stars) {&#13;
        case 0:&#13;
            $s .= '&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;';&#13;
            $s .= '&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;';&#13;
            $s .= '&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;';&#13;
            $s .= '&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;';&#13;
            $s .= '&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;';&#13;
            break;&#13;
&#13;
        case 1:&#13;
            $s .= '&lt;span class="glyphicon glyphicon-star"&gt;&lt;/span&gt;';&#13;
            $s .= '&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;';&#13;
            $s .= '&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;';&#13;
            $s .= '&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;';&#13;
            $s .= '&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;';&#13;
            break;&#13;
&#13;
        case 2:&#13;
            $s .= '&lt;span class="glyphicon glyphicon-star"&gt;&lt;/span&gt;';&#13;
            $s .= '&lt;span class="glyphicon glyphicon-star"&gt;&lt;/span&gt;';&#13;
            $s .= '&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;';&#13;
            $s .= '&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;';&#13;
            $s .= '&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;';&#13;
            break;&#13;
<span class="TheSansMonoCd_W5Regular_Italic_11">--snip--</span>&#13;
        // Fill in the rest up to case 5.&#13;
    }&#13;
&#13;
    return $s;&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-3: A function to output gold and gray stars</span></p>
<p class="TX">To keep our code simple, we’ve created a reusable function to return the HTML needed to display a given number of filled gold stars (set with <span aria-label="281" epub:type="pagebreak" id="pg_281" role="doc-pagebreak"/>the function’s <span class="SANS_TheSansMonoCd_W5Regular_11">$stars</span> parameter) while displaying the remaining (disabled) stars as gray. We use a <span class="SANS_TheSansMonoCd_W5Regular_11">switch</span> statement to handle each possible star rating from <span class="SANS_TheSansMonoCd_W5Regular_11">0</span> to <span class="SANS_TheSansMonoCd_W5Regular_11">5</span>. (I’ve shown cases <span class="SANS_TheSansMonoCd_W5Regular_11">0</span> through <span class="SANS_TheSansMonoCd_W5Regular_11">2</span>; you can fill in the remaining cases.) We display each Bootstrap Glyphicon star character by using an HTML <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;span&gt;</span> element, with the CSS class <span class="SANS_TheSansMonoCd_W5Regular_11">glyphicon glyphicon-star</span> for a filled gold star or <span class="SANS_TheSansMonoCd_W5Regular_11">glyphicon glyphicon-star-empty</span> for a gray star. We could also implement this <span class="SANS_TheSansMonoCd_W5Regular_11">starsHtml()</span> function by using some kind of loop, but the <span class="SANS_TheSansMonoCd_W5Regular_11">switch</span> statement is more straightforward to follow.</p>
</section>
<section aria-labelledby="sec6" epub:type="division">
<h4 class="H2" id="sec6"><span id="toc-link_204"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Creating the Template Script</span></h4>
<p class="TNI1">We now need to write the template script for the product list page. It will loop through the <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> array, decorating the data for each product with the appropriate HTML. (For this to work, the <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> array must already have been created in the calling script before the template script itself is executed; we’ve done this in <a href="#lis15-1">Listing 15-1</a>.) Create <i>templates/list.php</i> and enter the contents of <a href="#lis15-4">Listing 15-4</a>.</p>
<span id="lis15-4"/>
<pre><code>&lt;!doctype html&gt;&#13;
&lt;html&gt;&#13;
&lt;head&gt;&#13;
    &lt;title&gt;Shopping site: Product List&lt;/title&gt;&#13;
    &lt;link rel="stylesheet" href="/css/products.css"&gt;&#13;
    &lt;link rel="stylesheet"&#13;
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"&gt;&#13;
    &lt;link rel="stylesheet"&#13;
          href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css"&gt;&#13;
&lt;/head&gt;&#13;
&#13;
&lt;body class="container"&gt;&#13;
&#13;
&lt;h1&gt;List of Products&lt;/h1&gt;&#13;
&#13;
&lt;div class="row"&gt;&#13;
&#13;
&lt;?php&#13;
foreach ($products as $id =&gt; $product): <span aria-label="annotation1" class="codewide_CodeAnnotation">❶</span>&#13;
    $price = number_format($product['price'], 2); <span aria-label="annotation2" class="codewide_CodeAnnotation">❷</span>&#13;
?&gt;&#13;
    &lt;div class="product col-md-2 text-center"&gt;&#13;
        &lt;img src="/images/&lt;?= $product['image'] ?&gt;" alt="&lt;?= $product['name'] ?&gt;"&gt; <span aria-label="annotation3" class="codewide_CodeAnnotation">❸</span>&#13;
        &lt;?= starsHtml($product['stars']) ?&gt; <span aria-label="annotation4" class="codewide_CodeAnnotation">❹</span>&#13;
        &lt;h1 class="fs-5"&gt;&lt;?= $product['name'] ?&gt;&lt;/h1&gt;&#13;
        &lt;div class="price"&gt;&#13;
            $ &lt;?= $price ?&gt;&#13;
            &lt;form method="post" action="/?action=addToCart&amp;id=&lt;?= $id ?&gt;"&#13;
                style="display: inline"&gt; <span aria-label="annotation5" class="codewide_CodeAnnotation">❺</span>&#13;
                &lt;button class="btn btn-primary btn-sm"&gt;Add To Cart&lt;/button&gt;&#13;
            &lt;/form&gt;&#13;
        &lt;/div&gt;&#13;
<span aria-label="282" epub:type="pagebreak" id="pg_282" role="doc-pagebreak"/>       &lt;div&gt;&#13;
            &lt;?= $product['description'] ?&gt; <span aria-label="annotation6" class="codewide_CodeAnnotation">❻</span>&#13;
        &lt;/div&gt;&#13;
    &lt;/div&gt;&#13;
&lt;?php endforeach; ?&gt;&#13;
&lt;/div&gt;&#13;
&lt;/body&gt;&#13;
&lt;/html&gt;</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-4: The</span> <span class="SANS_Futura_Std_Book_11">list.php</span> <span class="SANS_Futura_Std_Book_Oblique_11">template</span></p>
<p class="TX">We use three <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;link&gt;</span> elements to load the Bootstrap CSS styles and glyphs, plus our custom <i>products.css</i> stylesheet in the <i>css</i> folder. Then we declare a PHP <span class="SANS_TheSansMonoCd_W5Regular_11">foreach</span> loop to iterate through the <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> array, one product at a time <span aria-label="annotation1" class="CodeAnnotation">❶</span>. On each iteration, the loop extracts the array containing details about the current product (with elements indexed by <span class="SANS_TheSansMonoCd_W5Regular_11">'name'</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">'price'</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">'stars'</span>, and <span class="SANS_TheSansMonoCd_W5Regular_11">'image'</span>), and names that array <span class="SANS_TheSansMonoCd_W5Regular_11">$product</span>. The <span class="SANS_TheSansMonoCd_W5Regular_11">foreach</span> syntax <span class="SANS_TheSansMonoCd_W5Regular_11">$products as $id =&gt; $product</span> also means that the key for the current array element (a string containing the current product ID) will be available in the <span class="SANS_TheSansMonoCd_W5Regular_11">$id</span> variable. This will become important because our shopping cart logic needs to know the ID of each product so it can display and modify the cart contents.</p>
<p class="TX">Inside the loop, we create a <span class="SANS_TheSansMonoCd_W5Regular_11">$price</span> variable containing the value of the <span class="SANS_TheSansMonoCd_W5Regular_11">'price'</span> element of the current product array, formatted to two decimal places with the <span class="SANS_TheSansMonoCd_W5Regular_11">number_format()</span> function <span aria-label="annotation2" class="CodeAnnotation">❷</span>. Next, we create an HTML <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;img&gt;</span> element that uses the image filename stored in <span class="SANS_TheSansMonoCd_W5Regular_11">$product['image']</span> to create the path to the appropriate image file in the public <i>images</i> folder (for example, <i>images/banana.png</i>) <span aria-label="annotation3" class="CodeAnnotation">❸</span>. We then pass the integer number of stars (<span class="SANS_TheSansMonoCd_W5Regular_11">$product['stars']</span>) to the <span class="SANS_TheSansMonoCd_W5Regular_11">starsHtml()</span> function so the appropriate HTML for the five gold and gray stars will be output <span aria-label="annotation4" class="CodeAnnotation">❹</span>.</p>
<p class="TX">Still in the <span class="SANS_TheSansMonoCd_W5Regular_11">foreach</span> loop, we set the name of the product as a level 1 heading styled with the <span class="SANS_TheSansMonoCd_W5Regular_11">fs-5</span> Bootstrap CSS class for smaller text. We then create a <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;div&gt;</span> styled with the <span class="SANS_TheSansMonoCd_W5Regular_11">price</span> CSS class (defined in our <i>css/products.css</i> file). This <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;div&gt;</span> displays the price of the current product, along with a form containing a button labeled <span class="SANS_TheSansMonoCd_W5Regular_11">Add to Cart</span>. Once we’ve added shopping functionality, clicking this button will add the ID of the current product to the shopping cart via a <span class="SANS_TheSansMonoCd_W5Regular_11">POST</span> HTTP request. The form passes two query-string parameters: <span class="SANS_TheSansMonoCd_W5Regular_11">action</span> with a value of <span class="SANS_TheSansMonoCd_W5Regular_11">addToCart</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">id</span> with a value of the current product ID <span aria-label="annotation5" class="CodeAnnotation">❺</span>. Finally, we display the product’s text description in its own <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;div&gt;</span> styled with the <span class="SANS_TheSansMonoCd_W5Regular_11">fs-6</span> Bootstrap CSS class for small text <span aria-label="annotation6" class="CodeAnnotation">❻</span>, before closing the <span class="SANS_TheSansMonoCd_W5Regular_11">foreach</span> loop.</p>
</section>
<section aria-labelledby="sec7" epub:type="division">
<h4 class="H2" id="sec7"><span id="toc-link_205"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Updating the Index Script</span></h4>
<p class="TNI1">To complete our product list, we need to add <span class="SANS_TheSansMonoCd_W5Regular_11">require_once</span> statements to the <i>index.php</i> script so it can access code from other parts of the project. Update <i>public/index.php</i> as shown in <a href="#lis15-5">Listing 15-5</a>.</p>
<span id="lis15-5"/>
<pre><code>&lt;?php&#13;
require_once __DIR__ . '/../src/functions.php';&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">$products = [];</span>&#13;
<span aria-label="283" epub:type="pagebreak" id="pg_283" role="doc-pagebreak"/><span class="TheSansMonoCd_W5Regular_Grey_11">$products['010'] = [</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    'name' =&gt; 'Sandwich',</span>&#13;
<span class="TheSansMonoCd_W5Regular_Italic_11">--snip--</span>&#13;
&#13;
require_once __DIR__ . '/../templates/list.php';</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-5: Reading the function declarations and template script into</span> <span class="SANS_Futura_Std_Book_11">index.php</span></p>
<p class="TX">We use <span class="SANS_TheSansMonoCd_W5Regular_11">require_once</span> to read in the function declaration file, which gives the page template access to the <span class="SANS_TheSansMonoCd_W5Regular_11">starsHtml()</span> function. Then, at the end of the script, we read in the template script to display the product list page. Because we declare the <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> array in between, the template will have access to this too. At this point, if you run the PHP web server (<span class="SANS_TheSansMonoCd_W5Regular_11">php -S localhost:8000 -t public</span>) and visit the home page in a web browser, you should see the list of products, as shown earlier in <a href="#fig15-2">Figure 15-2</a>.</p>
</section>
</section>
<section aria-labelledby="sec8" epub:type="division">
<h3 class="H1" id="sec8"><span id="toc-link_206"/><span class="SANS_Futura_Std_Bold_B_11">Designing the Shopping Cart</span></h3>
<p class="TNI1">Now let’s create a shopping cart display page, so users will have a way to view their cart. In <span class="Xref">“Implementing Cart-Manipulation Functions” on <a href="#pg_293">page 293</a></span>, we’ll implement the logic for adding to, deleting from, and changing the quantities of the shopping cart contents. <a href="#fig15-3">Figure 15-3</a> shows the shopping cart page we’ll create.</p>
<figure class="IMG"><a id="fig15-3"/><img alt="" class="img100" height="703" src="../images/figure15-3.jpg" width="1501"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 15-3: The shopping cart page</span></p></figcaption>
</figure>
<p class="TX">We’ll need to display a row for each product in the cart, along with the unit price, the quantity in the cart, and the subtotal for each product. Each item also needs <span class="SANS_TheSansMonoCd_W5Regular_11">+</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">-</span> buttons to incrementally change the quantity of the product by plus or minus 1, and a red <span class="SANS_TheSansMonoCd_W5Regular_11">Remove</span> button to completely remove that product from the cart. We’ll have a final row beneath the products displaying the total cost of all items in the cart.</p>
<section aria-labelledby="sec9" epub:type="division">
<span aria-label="284" epub:type="pagebreak" id="pg_284" role="doc-pagebreak"/>
<h4 class="H2" id="sec9"><span id="toc-link_207"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Creating the Front Controller</span></h4>
<p class="TNI1">Since the shopping cart will be our second display page, we need to introduce front-controller logic to <i>public/index.php</i> to select the appropriate template to display. We’re going to offer two navigation links at the top of each page: List of Products (<span class="SANS_TheSansMonoCd_W5Regular_11">href="/"</span>) and Shopping Cart (<span class="SANS_TheSansMonoCd_W5Regular_11">href="/?action=cart"</span>). The front controller can therefore check for an <span class="SANS_TheSansMonoCd_W5Regular_11">action</span> query-string variable with a value of <span class="SANS_TheSansMonoCd_W5Regular_11">cart</span> to determine which page the user is requesting. Delete the <span class="SANS_TheSansMonoCd_W5Regular_11">require_once</span> statement currently at the end of <i>public/index.php</i> and replace it with the code in <a href="#lis15-6">Listing 15-6</a>.</p>
<span id="lis15-6"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Italic_11">--snip--</span>&#13;
// Default is product list page&#13;
$page = 'list.php';&#13;
&#13;
// Try to find "action=cart" in query-string variables&#13;
$action = filter_input(INPUT_GET, 'action');&#13;
if ('cart' == $action){&#13;
    // If found, change template file to be displayed&#13;
    $page = 'cart.php';&#13;
}&#13;
&#13;
// Read in and execute the $page template&#13;
<span aria-label="annotation1" class="codeannotated_CodeAnnotation">❶</span> require_once __DIR__ . "/../templates/$page";</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-6: Deciding which template to display at the end of</span> <span class="SANS_Futura_Std_Book_11">index.php</span></p>
<p class="TX">This code creates a <span class="SANS_TheSansMonoCd_W5Regular_11">$page</span> variable whose value is the name of a template file. We incorporate whatever value <span class="SANS_TheSansMonoCd_W5Regular_11">$page</span> has into the <span class="SANS_TheSansMonoCd_W5Regular_11">require_once</span> statement at the end of the script to display the appropriate template <span aria-label="annotation1" class="CodeAnnotation">❶</span>. We have just two templates to choose from: the product list (<i>list.php</i>) and the shopping cart (<i>cart.php</i>, which we’ll write shortly). By default, we first set <span class="SANS_TheSansMonoCd_W5Regular_11">$page</span> to the product list template. Then we retrieve a value for the <span class="SANS_TheSansMonoCd_W5Regular_11">action</span> variable from the query-string parameters, and if it’s found to be <span class="SANS_TheSansMonoCd_W5Regular_11">cart</span>, we change <span class="SANS_TheSansMonoCd_W5Regular_11">$page</span> to the shopping cart template.</p>
<p class="TX">In <span class="Xref">“Writing the</span> <span class="SANS_TheSansMonoCd_W5Regular_11">switch</span> <span class="Xref">Statement” on <a href="#pg_297">page 297</a></span>, we’ll expand on the front- controller logic to account for all the actions users can take on the shopping cart page. For now, though, <a href="#lis15-6">Listing 15-6</a> has all the front-controller logic we need in order to view the cart.</p>
</section>
<section aria-labelledby="sec10" epub:type="division">
<h4 class="H2" id="sec10"><span id="toc-link_208"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Managing the Product and Cart Arrays</span></h4>
<p class="TNI1">We’ll represent the contents of the shopping cart by using a <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> array whose keys are product IDs and whose values are the quantities of those products in the cart. We don’t need to store additional product information, such as prices, in this array, since we can use the product IDs to retrieve the other details from the source of our product data, the <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> array.</p>
<p class="TX">Ultimately, we’ll be reading the contents of the shopping cart array from the session, but for now, we’ll hardcode an array of cart items for testing purposes. This is a common approach when developing a new feature: you hardcode initial data so you can write scripts to work with data for the <span aria-label="285" epub:type="pagebreak" id="pg_285" role="doc-pagebreak"/>new feature, and then once that’s all working, you make the source of the data dynamic (for example, coming from the session or a database).</p>
<p class="TX">To keep our <i>index.php</i> script from getting too complicated, we’ll write a separate function that returns the array of items currently in the shopping cart. Add the <span class="SANS_TheSansMonoCd_W5Regular_11">getShoppingCart()</span> function shown in <a href="#lis15-7">Listing 15-7</a> to the end of the <i>src/functions.php</i> file.</p>
<span id="lis15-7"/>
<pre><code>function getShoppingCart(): array&#13;
{&#13;
    $cartItems = [];&#13;
    $cartItems['010'] = 2; // 2 sandwiches&#13;
    $cartItems['005'] = 4; // 4 pineapples&#13;
&#13;
    return $cartItems;&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-7: The</span> <span class="TheSansMonoCd_W5Regular_Italic_11">getShoppingCart()</span> <span class="SANS_Futura_Std_Book_Oblique_11">function</span></p>
<p class="TX">The <span class="SANS_TheSansMonoCd_W5Regular_11">getShoppingCart()</span> function creates and returns the contents of the <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> array. Each element in the array has a product ID string that acts as its key (in this hardcoded example, <span class="SANS_TheSansMonoCd_W5Regular_11">'010'</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">'005'</span> for the sandwich and pineapple products, respectively). The value of each element is the quantity of that product in the cart (two sandwiches and four pineapples).</p>
<p class="TX">While we’re at it, let’s also move all the code declaring the <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> array from <i>index.php</i> into a <span class="SANS_TheSansMonoCd_W5Regular_11">getAllProducts()</span> function. Again, this will help keep the index script from becoming too complex. Copy the code you created in <a href="#lis15-1">Listing 15-1</a> from <i>public/index.php</i> and paste it at the end of the <i>src/functions.php</i> script, as shown in <a href="#lis15-8">Listing 15-8</a>. To embed the code within a function, you’ll also need to add the lines shown in black.</p>
<span id="lis15-8"/>
<pre><code>function getAllProducts(): array&#13;
{&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    $products = [];</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    $products['010'] = [</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'name' =&gt; 'Sandwich',</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'description' =&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'A filling, savory snack of peanut butter and jelly.',</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'price' =&gt; 1.00,</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'stars' =&gt; 4,</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'image' =&gt; 'peanut_butter.png'];</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    $products['025'] = [</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'name' =&gt; 'Slice of cheesecake',</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'description' =&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'Treat yourself to a chocolate-covered cheesecake slice.',</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'price' =&gt; 2.00,</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'stars' =&gt; 5,</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'image' =&gt; 'chocolate_cheese_cake.png'];</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    $products['005'] = [</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'name' =&gt; 'Pineapple',</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'description' =&gt;</span>&#13;
<span aria-label="286" epub:type="pagebreak" id="pg_286" role="doc-pagebreak"/><span class="TheSansMonoCd_W5Regular_Grey_11">        'A piece of exotic fruit.',</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'price' =&gt; 3.00,</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'stars' =&gt; 2,</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'image' =&gt; 'pineapple.png'];</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    $products['021'] = [</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'name' =&gt; 'Jelly donut',</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'description' =&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'The best type of donut - filled with sweet jam.',</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'price' =&gt; 4.50,</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'stars' =&gt; 3,</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'image' =&gt; 'jellydonut.png'];</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    $products['002'] = [</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'name' =&gt; 'Banana',</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'description' =&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'The basis for a good smoothie and high in potassium.',</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'price' =&gt; 0.50,</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'stars' =&gt; 5,</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">        'image' =&gt; 'banana.png'];</span>&#13;
    return $products;&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-8: The</span> <span class="TheSansMonoCd_W5Regular_Italic_11">getAllProducts()</span> <span class="SANS_Futura_Std_Book_Oblique_11">function</span></p>
<p class="TX">This function builds up the <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> array and then returns it, allowing the array to be used in <i>public/index.php</i>.</p>
</section>
<section aria-labelledby="sec11" epub:type="division">
<h4 class="H2" id="sec11"><span id="toc-link_209"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Streamlining the Index Script</span></h4>
<p class="TNI1">We can now update our <i>index.php</i> script to make use of the new <span class="SANS_TheSansMonoCd_W5Regular_11">getAllProducts()</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">getShoppingCart()</span> functions. If you haven’t already, delete the code building the <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> array from the <i>index.php</i> script. Then update the file by adding the statements shown in <a href="#lis15-9">Listing 15-9</a>.</p>
<span id="lis15-9"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">require_once __DIR__ . '/../src/functions.php';</span>&#13;
&#13;
$products = getAllProducts();&#13;
$cartItems = getShoppingCart();&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">// Choose page to display</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">$page = 'list.php';</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">$action = filter_input(INPUT_GET, 'action');</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">if ('cart' == $action) {</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    // If found, change template file to be displayed</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    $page = 'cart.php';</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">}</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">require_once __DIR__ . "/../templates/$page";</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-9: The simplified</span> <span class="SANS_Futura_Std_Book_11">index.php</span> <span class="SANS_Futura_Std_Book_Oblique_11">script</span></p>
<p class="TX">We now use the <span class="SANS_TheSansMonoCd_W5Regular_11">getAllProducts()</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">getShoppingCart()</span> functions declared in <i>src/functions.php</i> to create the <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> arrays. <span aria-label="287" epub:type="pagebreak" id="pg_287" role="doc-pagebreak"/>The arrays are therefore available to whichever template script is invoked in the final <span class="SANS_TheSansMonoCd_W5Regular_11">require_once</span> statement.</p>
</section>
<section aria-labelledby="sec12" epub:type="division">
<h4 class="H2" id="sec12"><span id="toc-link_210"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Creating a Header Template</span></h4>
<p class="TNI1">When we write a display template for the shopping cart, much of its page header content will be the same as that of the product list page. To simplify both the cart and product display templates, we’ll put all the common HTML content into a separate template file named <i>templates/_header.php</i>.</p>
<p class="TX">This name follows the common convention of using an underscore to prefix the name of a <i>partial template</i> (a file that renders only part of a page and is shared by several other templates). This convention enables you to quickly identify partial templates within a folder, so you can ignore them when you’re looking for a particular full template file.</p>
<p class="TX">Copy the code from <i>templates/list.php</i>, paste it into a new <i>templates/_header.php</i> file, and update the code as shown in <a href="#lis15-10">Listing 15-10</a>.</p>
<span id="lis15-10"/>
<pre><code><span class="TheSansMonoCd_W5Regular_Grey_11">&lt;!doctype HTML&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">&lt;html&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">&lt;head&gt;</span>&#13;
    &lt;title&gt;Shopping site: &lt;?= $pageTitle ?&gt;&lt;/title&gt; <span aria-label="annotation1" class="codewide_CodeAnnotation">❶</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    &lt;link rel="stylesheet" href="/css/products.css"&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    &lt;link rel="stylesheet"</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    &lt;link rel="stylesheet"</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">          href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css"&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">&lt;/head&gt;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">&lt;body class="container "&gt;</span>&#13;
&#13;
    &lt;nav&gt;&#13;
        &lt;ul&gt;&#13;
            &lt;li&gt;&#13;
                &lt;a href="/"&gt;&#13;
                    List of Products&#13;
                &lt;/a&gt;&#13;
            &lt;/li&gt;&#13;
            &lt;li&gt;&#13;
                &lt;a href="/?action=cart"&gt;&#13;
                    Shopping Cart&#13;
                &lt;/a&gt;&#13;
            &lt;/li&gt;&#13;
        &lt;/ul&gt;&#13;
    &lt;/nav&gt;&#13;
&#13;
    &lt;h1&gt;&lt;?= $pageTitle ?&gt;&lt;/h1&gt; <span aria-label="annotation2" class="codewide_CodeAnnotation">❷</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-10: The common page header content in</span> <span class="SANS_Futura_Std_Book_11">_header.php</span></p>
<p class="TX">The header template uses a <span class="SANS_TheSansMonoCd_W5Regular_11">$pageTitle</span> variable, which will need to be defined in each script that requires this header template. The variable <span aria-label="288" epub:type="pagebreak" id="pg_288" role="doc-pagebreak"/>appears twice: in the required HTML title in the <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;head&gt;</span> element <span aria-label="annotation1" class="CodeAnnotation">❶</span> and as a level 1 HTML heading in the body of every page <span aria-label="annotation2" class="CodeAnnotation">❷</span>. In between, we add a simple navigation list with two links, one to show the product list and one to display the shopping cart.</p>
<p class="TX">We can now remove all that common header content from our product list page (<i>templates/list.php</i>). <a href="#lis15-11">Listing 15-11</a> shows the updated, simplified contents of the template.</p>
<span id="lis15-11"/>
<pre><code>&lt;?php&#13;
    $pageTitle = 'List of products';&#13;
&#13;
    require_once '_header.php';&#13;
?&gt;&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">&lt;div class="row"&gt;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">&lt;?php</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">foreach ($products as $id =&gt; $product):</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    $price = number_format($product['price'], 2);</span>&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">?&gt;</span>&#13;
&#13;
<span class="TheSansMonoCd_W5Regular_Grey_11">    &lt;div class="product col text-center"&gt;</span>&#13;
<span class="TheSansMonoCd_W5Regular_Italic_11">--snip--</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-11: The simplified</span> <span class="SANS_Futura_Std_Book_11">list.php</span> <span class="SANS_Futura_Std_Book_Oblique_11">template</span></p>
<p class="TX">We use a PHP code block to set a value for <span class="SANS_TheSansMonoCd_W5Regular_11">$pageTitle</span> and read in the <i>_header.php</i> template to create the page header. The remainder of the file is just as before: a single <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;div&gt;</span> styled as a Bootstrap <span class="SANS_TheSansMonoCd_W5Regular_11">row</span>, and a <span class="SANS_TheSansMonoCd_W5Regular_11">foreach</span> loop to add column <span class="SANS_TheSansMonoCd_W5Regular_11">div</span>s for each product.</p>
</section>
<section aria-labelledby="sec13" epub:type="division">
<h4 class="H2" id="sec13"><span id="toc-link_211"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Creating the Cart Display Template</span></h4>
<p class="TNI1">We’re now ready to write the template for displaying the items in the shopping cart. This script will loop through and display each product in the <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> array, calculate a subtotal for each product, and find the overall total for the complete shopping cart. The script is quite long, so we’ll discuss it in sections.</p>
<p class="TX">The first part of the script accesses the common HTML page header code and sets up headings for each column in the cart display. Create a new <i>templates/cart.php</i> file and enter the code in <a href="#lis15-12">Listing 15-12</a>.</p>
<span id="lis15-12"/>
<pre><code>&lt;?php&#13;
    $total = 0;&#13;
    $pageTitle = 'Shopping Cart';&#13;
&#13;
    require_once '_header.php';&#13;
?&gt;&#13;
&#13;
<span aria-label="annotation1" class="codeannotated_CodeAnnotation">❶</span> &lt;div class="row"&gt;&#13;
    &lt;div class="col-2 fw-bold text-center"&gt;&#13;
        Image&#13;
    &lt;/div&gt;&#13;
&#13;
<span aria-label="289" epub:type="pagebreak" id="pg_289" role="doc-pagebreak"/>    &lt;div class="col-4 fw-bold"&gt;&#13;
        Item&#13;
    &lt;/div&gt;&#13;
&#13;
    &lt;div class="col fw-bold text-right"&gt;&#13;
        Price&#13;
    &lt;/div&gt;&#13;
&#13;
    &lt;div class="col-3 fw-bold text-center"&gt;&#13;
        Quantity&#13;
    &lt;/div&gt;&#13;
&#13;
    &lt;div class="col fw-bold text-right"&gt;&#13;
        Subtotal&#13;
    &lt;/div&gt;&#13;
&#13;
    &lt;div class="col fw-bold"&gt;&#13;
        Action&#13;
    &lt;/div&gt;&#13;
&lt;/div&gt;</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-12: The first part of the</span> <span class="SANS_Futura_Std_Book_11">cart.php</span> <span class="SANS_Futura_Std_Book_Oblique_11">template: setting up the cart display</span></p>
<p class="TX">First, we zero the <span class="SANS_TheSansMonoCd_W5Regular_11">$total</span> variable; this will eventually hold the grand total of all items in the shopping cart. Then we set the <span class="SANS_TheSansMonoCd_W5Regular_11">$pageTitle</span> variable and read in the header template, just as we did on the product list page. We then create a row of column headers <span aria-label="annotation1" class="CodeAnnotation">❶</span> identifying the <span class="SANS_TheSansMonoCd_W5Regular_11">Image</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">Item</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">Price</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">Quantity</span>, <span class="SANS_TheSansMonoCd_W5Regular_11">Subtotal</span>, and <span class="SANS_TheSansMonoCd_W5Regular_11">Action</span> columns. We use the Bootstrap 12-column layout, making the image (<span class="SANS_TheSansMonoCd_W5Regular_11">col-2</span>), item (<span class="SANS_TheSansMonoCd_W5Regular_11">col-4</span>), and quantity (<span class="SANS_TheSansMonoCd_W5Regular_11">col-3</span>) columns wider than the price, subtotal, and action columns (which default to 1/12 page-width columns).</p>
<p class="TX">The workhorse section of the shopping cart display script is a loop through the <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> array. For each product in the array, we’ll display the product’s image, name, description, unit price, quantity, and subtotal. Within the loop, we’ll also create form buttons for changing the quantity and removing the product completely from the shopping cart. <a href="#lis15-13">Listing 15-13</a> shows the main PHP code block at the beginning of the loop.</p>
<span id="lis15-13"/>
<pre><code>&lt;?php&#13;
foreach ($cartItems as $id =&gt; $quantity):&#13;
  <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> $product = $products[$id];&#13;
    $price = $product['price'];&#13;
  <span aria-label="annotation2" class="Code_CodeAnnotation">❷</span> $subtotal = $quantity * $price;&#13;
&#13;
    // Update total&#13;
  <span aria-label="annotation3" class="Code_CodeAnnotation">❸</span> $total += $subtotal;&#13;
&#13;
    // Format prices to 2 d.p.&#13;
    $price = number_format($price, 2);&#13;
    $subtotal = number_format($subtotal, 2);&#13;
?&gt;</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-13: The second part of the</span> <span class="SANS_Futura_Std_Book_11">cart.php</span> <span class="SANS_Futura_Std_Book_Oblique_11">template: the item loop</span></p>
<p class="BodyContinued"><span aria-label="290" epub:type="pagebreak" id="pg_290" role="doc-pagebreak"/>The loop will continue in <a href="#lis15-14">Listing 15-14</a> with all the HTML column <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;div&gt;</span> elements needed to display each cart item.</p>
<p class="TX">Within a PHP code block, we start a <span class="SANS_TheSansMonoCd_W5Regular_11">foreach</span> loop through the <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> array, setting <span class="SANS_TheSansMonoCd_W5Regular_11">$id</span> to equal the current array element key and <span class="SANS_TheSansMonoCd_W5Regular_11">$quantity</span> to equal the current element value. Since <span class="SANS_TheSansMonoCd_W5Regular_11">$id</span> also corresponds to a key in the <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> array, we use it to retrieve all product details for the current shopping cart item, storing them in the <span class="SANS_TheSansMonoCd_W5Regular_11">$product</span> variable <span aria-label="annotation1" class="CodeAnnotation">❶</span>. We then extract the price of the product into <span class="SANS_TheSansMonoCd_W5Regular_11">$price</span> and multiply it by <span class="SANS_TheSansMonoCd_W5Regular_11">$quantity</span> to get the subtotal for the cart item <span aria-label="annotation2" class="CodeAnnotation">❷</span>. Next, we add the subtotal for the current cart item to the grand total (<span class="SANS_TheSansMonoCd_W5Regular_11">$total</span>) <span aria-label="annotation3" class="CodeAnnotation">❸</span>. This grand total will accumulate over the course of the loop. Finally, we format both <span class="SANS_TheSansMonoCd_W5Regular_11">$price</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">$subtotal</span> to be numbers with two decimal places, since they represent currency values.</p>
<p class="TX">Listing 15-14 shows the rest of the <span class="SANS_TheSansMonoCd_W5Regular_11">foreach</span> loop, where we lay out the HTML needed to display each cart item.</p>
<span id="lis15-14"/>
<pre><code>&lt;div class="row border-top"&gt; <span aria-label="annotation1" class="codewide_CodeAnnotation">❶</span>&#13;
&#13;
    &lt;div class="col-2 product text-center"&gt; <span aria-label="annotation2" class="codewide_CodeAnnotation">❷</span>&#13;
        &lt;img src="/images/cart/&lt;?= $product['image'] ?&gt;" alt="&lt;?= $product['name'] ?&gt;"&gt;&#13;
    &lt;/div&gt;&#13;
&#13;
    &lt;div class="col-4"&gt; <span aria-label="annotation3" class="codewide_CodeAnnotation">❸</span>&#13;
        &lt;h1&gt;&lt;?= $product['name'] ?&gt;&lt;/h1&gt;&#13;
        &lt;div&gt;&#13;
            &lt;?= $product['description'] ?&gt;&#13;
        &lt;/div&gt;&#13;
    &lt;/div&gt;&#13;
&#13;
    &lt;div class="col price text-end align-self-center"&gt; <span aria-label="annotation4" class="codewide_CodeAnnotation">❹</span>&#13;
        $ &lt;?= $price ?&gt;&#13;
    &lt;/div&gt;&#13;
&#13;
    &lt;div class="col-3 text-center align-self-center"&gt; <span aria-label="annotation5" class="codewide_CodeAnnotation">❺</span>&#13;
        &lt;form action="/?action=changeCartQuantity&amp;id=&lt;?= $id ?&gt;" method="post"&gt;&#13;
            &lt;button type="submit" name="changeDirection" value="reduce"&#13;
                class="btn btn-primary btn-sm"&gt;&#13;
                &lt;span class="glyphicon glyphicon-minus"&gt;&lt;/span&gt;&#13;
            &lt;/button&gt;&#13;
            &lt;?= $quantity ?&gt;&#13;
            &lt;button type="submit" name="changeDirection" value="increase"&#13;
                class="btn btn-primary btn-sm"&gt;&#13;
                &lt;span class="glyphicon glyphicon-plus"&gt;&lt;/span&gt;&#13;
            &lt;/button&gt;&#13;
        &lt;/form&gt;&#13;
    &lt;/div&gt;&#13;
&#13;
    &lt;div class="col price text-end align-self-center"&gt; <span aria-label="annotation6" class="codewide_CodeAnnotation">❻</span>&#13;
        $ &lt;?= $subtotal ?&gt;&#13;
    &lt;/div&gt;&#13;
&#13;
    &lt;div class="col align-self-center"&gt; <span aria-label="annotation7" class="codewide_CodeAnnotation">❼</span>&#13;
        &lt;form action="/?action=removeFromCart&amp;id=&lt;?= $id ?&gt;" method="post"&gt;&#13;
            &lt;button class="btn btn-danger btn-sm"&gt;&#13;
<span aria-label="291" epub:type="pagebreak" id="pg_291" role="doc-pagebreak"/>                &lt;span class="glyphicon glyphicon-remove"&gt;&lt;/span&gt;&#13;
                Remove&#13;
            &lt;/button&gt;&#13;
        &lt;/form&gt;&#13;
    &lt;/div&gt;&#13;
&#13;
&lt;/div&gt;&#13;
&lt;?php endforeach; ?&gt; <span aria-label="annotation8" class="codewide_CodeAnnotation">❽</span></code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-14: The third part of the</span> <span class="SANS_Futura_Std_Book_11">cart.php</span> <span class="SANS_Futura_Std_Book_Oblique_11">template: the item</span> <span class="TheSansMonoCd_W5Regular_Italic_11">&lt;div&gt;</span> <span class="SANS_Futura_Std_Book_Oblique_11">elements</span></p>
<p class="TX">We start a new <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;div&gt;</span>, which will be a row for the current shopping cart item in the <span class="SANS_TheSansMonoCd_W5Regular_11">foreach</span> loop <span aria-label="annotation1" class="CodeAnnotation">❶</span>. Then we display a <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;div&gt;</span> containing an HTML image tag for the current product’s image, getting the image filename from the value of <span class="SANS_TheSansMonoCd_W5Regular_11">$product['image']</span> <span aria-label="annotation2" class="CodeAnnotation">❷</span>. The image is centered and also styled with the <span class="SANS_TheSansMonoCd_W5Regular_11">product</span> CSS class (from our <i>products.css</i>) so that the image is sized to fit the <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;div&gt;</span> (<span class="SANS_TheSansMonoCd_W5Regular_11">size: 100%</span>). For cart product display, we have a different (smaller) image with the same name, so the URL for the image references the <i>cart</i> subfolder of the <i>images</i> folder: <span class="SANS_TheSansMonoCd_W5Regular_11">/images/cart/&lt;?= $product['image'] ?&gt;</span>.</p>
<p class="TX">We next create a <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;div&gt;</span> displaying the product name (<span class="SANS_TheSansMonoCd_W5Regular_11">$product['name']</span>) as a level 1 heading, along with the text description of the product (<span class="SANS_TheSansMonoCd_W5Regular_11">$product['description']</span>) <span aria-label="annotation3" class="CodeAnnotation">❸</span>. Then we display the two-decimal-place value stored in <span class="SANS_TheSansMonoCd_W5Regular_11">$price</span> in a <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;div&gt;</span> styled with the Bootstrap <span class="SANS_TheSansMonoCd_W5Regular_11">align-self-center</span> class to vertically center the content in the row, with text aligned to the right (<span class="SANS_TheSansMonoCd_W5Regular_11">text-end</span>) and with the <span class="SANS_TheSansMonoCd_W5Regular_11">price</span> CSS class (bold and larger text) from our <i>products.css</i> stylesheet <span aria-label="annotation4" class="CodeAnnotation">❹</span>.</p>
<p class="TX">The next <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;div&gt;</span> displays the quantity for the current cart item <span aria-label="annotation5" class="CodeAnnotation">❺</span>. This is actually an HTML form, with two buttons (a minus and a plus) and the <span class="SANS_TheSansMonoCd_W5Regular_11">$quantity</span> variable displayed. The form uses the <span class="SANS_TheSansMonoCd_W5Regular_11">POST</span> method (since we’re changing content on the server) and passes two query-string parameters: <span class="SANS_TheSansMonoCd_W5Regular_11">action=changeCartQuantity</span> and the ID of the product (<span class="SANS_TheSansMonoCd_W5Regular_11">id=&lt;?= $id ?&gt;</span>). Later in the chapter, we’ll add more logic to our <i>index.php</i> script to recognize this new value of the <span class="SANS_TheSansMonoCd_W5Regular_11">action</span> parameter and process a change of quantity. For the buttons, we use a minus-sign Glyphicon symbol (Bootstrap CSS class <span class="SANS_TheSansMonoCd_W5Regular_11">glyphicon-minus</span>) with the name <span class="SANS_TheSansMonoCd_W5Regular_11">changeDirection</span> and the value <span class="SANS_TheSansMonoCd_W5Regular_11">reduce</span>, and a plus-sign Glyphicon, also with the name <span class="SANS_TheSansMonoCd_W5Regular_11">changeDirection</span> but with the value <span class="SANS_TheSansMonoCd_W5Regular_11">increase</span>.</p>
<p class="TX">Next, we display the value of <span class="SANS_TheSansMonoCd_W5Regular_11">$subtotal</span>. Once again we format its <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;div&gt;</span> with our <span class="SANS_TheSansMonoCd_W5Regular_11">price</span> CSS class because it is a currency value, and we align the text to the right (<span class="SANS_TheSansMonoCd_W5Regular_11">text-end</span>) <span aria-label="annotation6" class="CodeAnnotation">❻</span>. Then we output another vertically centered <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;div&gt;</span> with text aligned to the right (<span class="SANS_TheSansMonoCd_W5Regular_11">text-end</span>) that presents a button for the user to remove the item completely from the shopping cart <span aria-label="annotation7" class="CodeAnnotation">❼</span>. This is another form submitting with the <span class="SANS_TheSansMonoCd_W5Regular_11">POST</span> method. It sends two query-string variables: <span class="SANS_TheSansMonoCd_W5Regular_11">action=removeFromCart</span> and the ID of the current item (<span class="SANS_TheSansMonoCd_W5Regular_11">id=&lt;?= $id ?&gt;</span>). The form offers the user a button consisting of a cross Glyphicon followed by the word <span class="SANS_TheSansMonoCd_W5Regular_11">Remove</span>. Again, later in the chapter, we’ll add more logic to our <i>index.php</i> script to handle removing an item from the shopping cart. And with that, we end our <span class="SANS_TheSansMonoCd_W5Regular_11">foreach</span> loop <span aria-label="annotation8" class="CodeAnnotation">❽</span>.</p>
<p class="TX">Listing 15-15 shows the final part of the <i>templates/cart.php</i> script. This section of the code displays the grand total.</p>
<span id="lis15-15"/>
<pre><code><span aria-label="292" epub:type="pagebreak" id="pg_292" role="doc-pagebreak"/>&lt;div class="row border-top"&gt;&#13;
    &lt;div class="col-11 price text-end"&gt;&#13;
        &lt;?php&#13;
        $total = number_format($total, 2);&#13;
        ?&gt;&#13;
        $ &lt;?= $total ?&gt;&#13;
    &lt;/div&gt;&#13;
&#13;
    &lt;div class="col fw-bold "&gt;&#13;
        Total&#13;
    &lt;/div&gt;&#13;
&lt;/div&gt;&#13;
&lt;/body&gt;&#13;
&lt;/html&gt;</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-15: The final part of the</span> <span class="SANS_Futura_Std_Book_11">cart.php</span> <span class="SANS_Futura_Std_Book_Oblique_11">template: showing the total</span></p>
<p class="TX">This code outputs a final row, displaying two <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;div&gt;</span> elements. One gives the cart total (<span class="SANS_TheSansMonoCd_W5Regular_11">$total</span>), formatted to two decimal places. The other outputs just the word <span class="SANS_TheSansMonoCd_W5Regular_11">Total</span>. The <span class="SANS_TheSansMonoCd_W5Regular_11">div</span> to display the total is made wide enough to cover all the missing columns to its left by using the Bootstrap class <span class="SANS_TheSansMonoCd_W5Regular_11">col-11</span>, and since the value is a currency, it’s again styled with the <span class="SANS_TheSansMonoCd_W5Regular_11">price</span> CSS class defined in the <i>products.css</i> stylesheet file.</p>
<p class="TX">We’ve now achieved a two-page website. One page displays a list of products from data stored in the <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> array. The second page displays the contents of a shopping cart by using the <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> array.</p>
</section>
</section>
<section aria-labelledby="sec14" epub:type="division">
<h3 class="H1" id="sec14"><span id="toc-link_212"/><span class="SANS_Futura_Std_Bold_B_11">Interacting with the Session</span></h3>
<p class="TNI1">Up to this point, we’ve used a hardcoded function to always return the same shopping cart contents. Now we’ll modify the application to work with a dynamic, interactive shopping cart stored in the <span class="SANS_TheSansMonoCd_W5Regular_11">$_SESSION</span> array so that the cart contents can be remembered over the course of the browser session. In the process, we’ll implement functions to modify the contents of the cart.</p>
<section aria-labelledby="sec15" epub:type="division">
<h4 class="H2" id="sec15"><span id="toc-link_213"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Updating the Cart-Retrieval Function</span></h4>
<p class="TNI1">To work with dynamic shopping cart data, we must first update the <span class="SANS_TheSansMonoCd_W5Regular_11">getShoppingCart()</span> function to retrieve the shopping cart contents from the session. As we explored in <span class="Xref"><a href="chapter14.xhtml">Chapter 14</a></span>, before we attempt to retrieve a value from the session, we should set a default value in case nothing is found. Our default case will be an empty shopping cart array.</p>
<p class="TX">Listing 15-16 shows the updated <span class="SANS_TheSansMonoCd_W5Regular_11">getShoppingCart()</span> code. This function replaces the previous one in <i>src/functions.php</i>.</p>
<span id="lis15-16"/>
<pre><code>function getShoppingCart(): array&#13;
{&#13;
    // Default is empty shopping cart array&#13;
    $cartItems = [];&#13;
&#13;
<span aria-label="293" epub:type="pagebreak" id="pg_293" role="doc-pagebreak"/>    if (isset($_SESSION['cart'])) {&#13;
        $cartItems = $_SESSION['cart'];&#13;
    }&#13;
&#13;
    return $cartItems;&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-16: A function to retrieve the cart array from the session</span></p>
<p class="TX">We set <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> to the default value of an empty array. Then we use <span class="SANS_TheSansMonoCd_W5Regular_11">isset()</span> to test whether a value can be found in the <span class="SANS_TheSansMonoCd_W5Regular_11">$_SESSION</span> array for the <span class="SANS_TheSansMonoCd_W5Regular_11">'cart'</span> key. If an element exists for this key, its value is copied into the <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> variable. Finally, the function returns the contents of <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span>.</p>
</section>
<section aria-labelledby="sec16" epub:type="division">
<h4 class="H2" id="sec16"><span id="toc-link_214"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Implementing Cart-Manipulation Functions</span></h4>
<p class="TNI1">Next, we’ll implement functions to manipulate the contents of the cart. First, to add an item to the shopping cart stored in the <span class="SANS_TheSansMonoCd_W5Regular_11">$_SESSION</span> array, we need a function that will add a new element to the array with the product ID as the key and a quantity of <span class="SANS_TheSansMonoCd_W5Regular_11">1</span> as the value. If <span class="SANS_TheSansMonoCd_W5Regular_11">$_SESSION</span> doesn’t contain a current shopping cart array, this same function should create a new one containing one element. We’ll achieve this by adding a new function to <i>src/functions.php</i>, as shown in <a href="#lis15-17">Listing 15-17</a>.</p>
<span id="lis15-17"/>
<pre><code>function addItemToCart($id): void&#13;
{&#13;
    $cartItems = getShoppingCart();&#13;
    $cartItems[$id] = 1;&#13;
&#13;
    $_SESSION['cart'] = $cartItems;&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-17: A function to add a new product to the cart</span></p>
<p class="TX">The function takes an <span class="SANS_TheSansMonoCd_W5Regular_11">$id</span> parameter representing the ID of the item being added to the cart. We first store the current shopping cart array in the <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> variable by calling our <span class="SANS_TheSansMonoCd_W5Regular_11">getShoppingCart()</span> function. Then we add a new element to <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span>, with the key of the <span class="SANS_TheSansMonoCd_W5Regular_11">$id</span> parameter and a value of <span class="SANS_TheSansMonoCd_W5Regular_11">1</span> (the quantity of this product in the cart). Finally, we store the updated <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> array in <span class="SANS_TheSansMonoCd_W5Regular_11">$_SESSION</span>, overwriting the previous <span class="SANS_TheSansMonoCd_W5Regular_11">$_SESSION['cart']</span> array if one existed.</p>
<p class="TX">Removing a product completely from the shopping cart is similar to adding an item. We’ll add a new <span class="SANS_TheSansMonoCd_W5Regular_11">removeItemFromCart()</span> function to <i>src/functions.php</i>, as shown in <a href="#lis15-18">Listing 15-18</a>.</p>
<span id="lis15-18"/>
<pre><code>function removeItemFromCart($id): void&#13;
{&#13;
    $cartItems = getShoppingCart();&#13;
    unset($cartItems[$id]);&#13;
    $_SESSION['cart'] = $cartItems;&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-18: A function to remove a product from the cart</span></p>
<p class="TX"><span aria-label="294" epub:type="pagebreak" id="pg_294" role="doc-pagebreak"/>Once again, the function takes in an <span class="SANS_TheSansMonoCd_W5Regular_11">$id</span> parameter and starts by getting the array of items in the shopping cart. Then we use <span class="SANS_TheSansMonoCd_W5Regular_11">unset()</span> to remove the element with the specified ID from the <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> array. As before, we finish by storing the updated array in the session, overwriting the previous array.</p>
<p class="TX">Next, we’ll write a <span class="SANS_TheSansMonoCd_W5Regular_11">getQuantity()</span> function to look up the current quantity of a given product in the shopping cart array. This function, shown in <a href="#lis15-19">Listing 15-19</a>, will help us write other functions for increasing and decreasing the quantity of a product in the cart.</p>
<span id="lis15-19"/>
<pre><code>function getQuantity($id, $cart): int&#13;
{&#13;
    if (isset($cart[$id])) {&#13;
        return $cart[$id];&#13;
    }&#13;
&#13;
    // If $id not found, then return zero&#13;
    return 0;&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-19: A function to check the quantity of a product</span></p>
<p class="TX">This function takes in the desired product ID and the shopping cart array as parameters. We use <span class="SANS_TheSansMonoCd_W5Regular_11">isset()</span> to test whether an element can be found in the cart for the given ID. If it’s found, we return the value for that array element, representing the current quantity for that item. If no element is found indexed by <span class="SANS_TheSansMonoCd_W5Regular_11">$id</span>, the item isn’t in the cart, so we return a quantity of <span class="SANS_TheSansMonoCd_W5Regular_11">0</span>.</p>
<p class="TX">To increase the quantity of a product in the cart by 1, we need to retrieve the existing quantity, add 1 to it, and save the updated array back to the session. We’ll encode this logic in an <span class="SANS_TheSansMonoCd_W5Regular_11">increaseCartQuantity()</span> function, as shown in <a href="#lis15-20">Listing 15-20</a>.</p>
<span id="lis15-20"/>
<pre><code>function increaseCartQuantity($id): void&#13;
{&#13;
    $cartItems = getShoppingCart();&#13;
    $quantity = getQuantity($id, $cartItems);&#13;
    $newQuantity = $quantity + 1;&#13;
    $cartItems[$id] = $newQuantity;&#13;
&#13;
    $_SESSION['cart'] = $cartItems;&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-20: A function to increase the quantity of a cart item</span></p>
<p class="TX">After retrieving the <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> array, we use our <span class="SANS_TheSansMonoCd_W5Regular_11">getQuantity()</span> function to determine the quantity of the product with the given <span class="SANS_TheSansMonoCd_W5Regular_11">$id</span>. Next, we add <span class="SANS_TheSansMonoCd_W5Regular_11">1</span> to this quantity and assign the new quantity to the <span class="SANS_TheSansMonoCd_W5Regular_11">$id</span> key in the <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> array. Then we store the updated array in <span class="SANS_TheSansMonoCd_W5Regular_11">$_SESSION['cart']</span>, overwriting the previous array.</p>
<p class="TX"><span aria-label="295" epub:type="pagebreak" id="pg_295" role="doc-pagebreak"/>Decreasing the quantity by 1 is a little more complicated than increasing it, since this may reduce the quantity to 0, in which case we should remove the product completely from the shopping cart. We need to retrieve the existing quantity, subtract 1 from it, test whether the quantity is now 0, update the cart array appropriately, and save the updated array back to the session. We’ll encode this logic in a <span class="SANS_TheSansMonoCd_W5Regular_11">reduceCartQuantity()</span> function, as shown in <a href="#lis15-21">Listing 15-21</a>.</p>
<span id="lis15-21"/>
<pre><code>function reduceCartQuantity($id): void&#13;
{&#13;
    $cartItems = getShoppingCart();&#13;
    $quantity = getQuantity($id, $cartItems);&#13;
    $newQuantity = $quantity - 1;&#13;
&#13;
    if ($newQuantity &lt; 1) {&#13;
        unset($cartItems[$id]);&#13;
    } else {&#13;
        $cartItems[$id] = $newQuantity;&#13;
    }&#13;
&#13;
    $_SESSION['cart'] = $cartItems;&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-21: A function to reduce the quantity of a cart item in file</span> <span class="SANS_Futura_Std_Book_11">src/functions.php</span></p>
<p class="TX">We retrieve the shopping cart from the session and look up the quantity of the product with the given <span class="SANS_TheSansMonoCd_W5Regular_11">$id</span>, just as we did in the previous function. Then we subtract <span class="SANS_TheSansMonoCd_W5Regular_11">1</span> from this quantity. Next, we test whether the reduced quantity is less than <span class="SANS_TheSansMonoCd_W5Regular_11">1</span> (that is, <span class="SANS_TheSansMonoCd_W5Regular_11">0</span>), and if so, we remove the entire element from the shopping cart by using <span class="SANS_TheSansMonoCd_W5Regular_11">unset()</span>. Otherwise, we store the reduced quantity in the shopping cart. Finally, we store the updated <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> array in the session, overwriting the previous values.</p>
<blockquote>
<p class="Note"><span class="SANS_Dogma_OT_Bold_B_15">NOTE</span></p>
</blockquote>
<p class="NOTE-TXT"><i>When easy to do so, I always recommend using strong tests, such as less-than or greater-than, as we do for <a href="#lis15-21">Listing 15-21</a>’s</i> <span class="SANS_TheSansMonoCd_W5Regular_Italic_11">if</span> <i>statement, rather than testing for equality with a value like 0.</i></p>
</section>
<section aria-labelledby="sec17" epub:type="division">
<h4 class="H2" id="sec17"><span id="toc-link_215"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Creating the Empty Cart Template</span></h4>
<p class="TNI1">Now that we’re making the shopping cart dynamic, we need to account for the possibility that the user will try to view their cart when it’s empty. We’ll create a separate empty cart template to display when this happens. <a href="#fig15-4">Figure 15-4</a> shows how it should look.</p>
<span aria-label="296" epub:type="pagebreak" id="pg_296" role="doc-pagebreak"/>
<figure class="IMG"><a id="fig15-4"/><img alt="" class="img70" height="675" src="../images/figure15-4.jpg" width="982"/>
<figcaption><p class="CAP"><span class="SANS_Futura_Std_Book_Oblique_11">Figure 15-4: The empty shopping cart page</span></p></figcaption>
</figure>
<p class="TX">Listing 15-22 shows the code for the empty cart template. Enter this code in a new file called <i>templates/emptyCart.php</i>.</p>
<span id="lis15-22"/>
<pre><code>&lt;?php&#13;
$pageTitle = 'Shopping Cart';&#13;
&#13;
require_once '_header.php';&#13;
?&gt;&#13;
&#13;
&lt;div class="row"&gt;&#13;
    (there are no items in your shopping cart)&#13;
&lt;/div&gt;&#13;
&#13;
&lt;/body&gt;&#13;
&lt;/html&gt;</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-22: The</span> <span class="SANS_Futura_Std_Book_11">emptyCart.php</span> <span class="SANS_Futura_Std_Book_Oblique_11">template</span></p>
<p class="TX">This template is very short since, like our other display templates, it uses all the common content in <i>_header.php</i> (after first setting the required <span class="SANS_TheSansMonoCd_W5Regular_11">$pageTitle</span> variable). Besides the header, it contains a single row of text informing the user that the cart is empty.</p>
</section>
</section>
<section aria-labelledby="sec18" epub:type="division">
<h3 class="H1" id="sec18"><span id="toc-link_216"/><span class="SANS_Futura_Std_Bold_B_11">Finalizing the Front Controller</span></h3>
<p class="TNI1">Our website now has three possible pages the user can see: the list of products, the empty cart, and the cart containing items. The application needs to identify and perform a range of actions, such as adding items to the cart and changing quantities. To finalize our shopping cart application, we therefore need to expand the front-controller script in <i>index.php</i> to choose from all these pages and actions.</p>
<section aria-labelledby="sec19" epub:type="division">
<span aria-label="297" epub:type="pagebreak" id="pg_297" role="doc-pagebreak"/>
<h4 class="H2" id="sec19"><span id="toc-link_217"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Adding Display Functions</span></h4>
<p class="TNI1">Although we’ll be expanding the front controller, we still want to keep it as simple and concise as possible. Therefore, we’ll declare two final helper functions: one to display the list of products and one to display the shopping cart (either empty or full). Add the code shown in <a href="#lis15-23">Listing 15-23</a> to the <i>src/functions.php</i> file.</p>
<span id="lis15-23"/>
<pre><code>function displayProducts(): void&#13;
{&#13;
    $products = getAllProducts();&#13;
    require_once __DIR__ . '/../templates/list.php';&#13;
}&#13;
&#13;
function displayCart(): void&#13;
{&#13;
    $products = getAllProducts();&#13;
    $cartItems = getShoppingCart();&#13;
&#13;
  <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> if (!empty($cartItems)) {&#13;
        require_once __DIR__ . '/../templates/cart.php';&#13;
    } else {&#13;
        require_once __DIR__ . '/../templates/emptyCart.php';&#13;
    }&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-23: Functions to display the products and the shopping cart</span></p>
<p class="TX">First, we declare the <span class="SANS_TheSansMonoCd_W5Regular_11">displayProducts()</span> function. It invokes <span class="SANS_TheSansMonoCd_W5Regular_11">getAllProducts()</span> to obtain an array of all the products, then reads in and executes the <i>list.php</i> template. Then we declare the <span class="SANS_TheSansMonoCd_W5Regular_11">displayCart()</span> function. It retrieves the <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> and <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> arrays, then tests whether <span class="SANS_TheSansMonoCd_W5Regular_11">$cartItems</span> is empty <span aria-label="annotation1" class="CodeAnnotation">❶</span>. Depending on the result, the function displays the appropriate template, either <i>cart.php</i> or <i>emptyCart.php</i>.</p>
</section>
<section aria-labelledby="sec20" epub:type="division">
<h4 class="H2" id="sec20"><span id="toc-link_218"/><span class="SANS_Futura_Std_Bold_Condensed_Oblique_11">Writing the switch Statement</span></h4>
<p class="TNI1">We’re ready to bring everything together with updated front-controller code. We’ll follow the pattern we discussed in <span class="Xref"><a href="chapter13.xhtml">Chapter 13</a></span> of using a <span class="SANS_TheSansMonoCd_W5Regular_11">switch</span> statement to detect the required action and respond appropriately. Our front controller needs to handle six queries from the user:</p>
<ul class="ul">
<li class="ListBullet">Display all products</li>
<li class="ListBullet">Display the shopping cart</li>
<li class="ListBullet">Add a product to the shopping cart (given a product ID)</li>
<li class="ListBullet">Remove a product from the shopping cart (given a product ID)</li>
<li class="ListBullet">Increase the quantity of a product by 1 (given a product ID)</li>
<li class="ListBullet">Decrease the quantity of a product by 1 (given a product ID), and remove it if the quantity is now 0</li>
</ul>
<p class="TX"><span aria-label="298" epub:type="pagebreak" id="pg_298" role="doc-pagebreak"/>Replace the existing contents of <i>public/index.php</i> with the code in <a href="#lis15-24">Listing 15-24</a>. This is a well-organized script, since all the complex logic has been relegated to separate functions. The front-controller script simply focuses on retrieving query-string and <span class="SANS_TheSansMonoCd_W5Regular_11">POST</span> values, deciding which function to call, and choosing whether to display the product list or shopping cart after executing the appropriate function.</p>
<span id="lis15-24"/>
<pre><code>&lt;?php&#13;
session_start();&#13;
&#13;
require_once __DIR__ . '/../src/functions.php';&#13;
&#13;
// Try to find "action" in query-string variables&#13;
$action = filter_input(INPUT_GET, 'action');&#13;
switch ($action){&#13;
  <span aria-label="annotation1" class="Code_CodeAnnotation">❶</span> case 'cart':&#13;
        displayCart();&#13;
        break;&#13;
&#13;
  <span aria-label="annotation2" class="Code_CodeAnnotation">❷</span> case 'addToCart':&#13;
        $id = filter_input(INPUT_GET, 'id');&#13;
        addItemToCart($id);&#13;
        displayCart();&#13;
        break;&#13;
&#13;
  <span aria-label="annotation3" class="Code_CodeAnnotation">❸</span> case 'removeFromCart':&#13;
        $id = filter_input(INPUT_GET, 'id');&#13;
        removeItemFromCart($id);&#13;
        displayCart();&#13;
        break;&#13;
&#13;
  <span aria-label="annotation4" class="Code_CodeAnnotation">❹</span> case 'changeCartQuantity':&#13;
        $id = filter_input(INPUT_GET, 'id');&#13;
        $changeDirection = filter_input(INPUT_POST, 'changeDirection');&#13;
&#13;
        if ($changeDirection == 'increase') {&#13;
            increaseCartQuantity($id);&#13;
        } else {&#13;
            reduceCartQuantity($id);&#13;
        }&#13;
&#13;
        displayCart();&#13;
        break;&#13;
&#13;
  <span aria-label="annotation5" class="Code_CodeAnnotation">❺</span> default:&#13;
        displayProducts();&#13;
}</code></pre>
<p class="CodeListingCaption"><span class="SANS_Futura_Std_Book_Oblique_11">Listing 15-24: The final version of the front-controller logic in</span> <span class="SANS_Futura_Std_Book_11">index.php</span></p>
<p class="TX">We use PHP’s <span class="SANS_TheSansMonoCd_W5Regular_11">session_start()</span> function to start a new session if none currently exists or to renew the existing session. Calling this function is one of the first tasks you must do when processing a request to the server involving <span aria-label="299" epub:type="pagebreak" id="pg_299" role="doc-pagebreak"/>data stored in the <span class="SANS_TheSansMonoCd_W5Regular_11">$_SESSION</span> array. Next, after reading in the function declarations from <i>src/functions.php</i>, we try to find a value for the <span class="SANS_TheSansMonoCd_W5Regular_11">$action</span> variable from the query-string parameters and use it to begin a <span class="SANS_TheSansMonoCd_W5Regular_11">switch()</span> statement.</p>
<p class="TX">If the value of <span class="SANS_TheSansMonoCd_W5Regular_11">$action</span> is <span class="SANS_TheSansMonoCd_W5Regular_11">'cart'</span> <span aria-label="annotation1" class="CodeAnnotation">❶</span>, we display the shopping cart by using the <span class="SANS_TheSansMonoCd_W5Regular_11">displayCart()</span> function. If the value is <span class="SANS_TheSansMonoCd_W5Regular_11">'addToCart'</span> <span aria-label="annotation2" class="CodeAnnotation">❷</span> or <span class="SANS_TheSansMonoCd_W5Regular_11">'removeFromCart'</span> <span aria-label="annotation3" class="CodeAnnotation">❸</span>, we retrieve the value of the <span class="SANS_TheSansMonoCd_W5Regular_11">id</span> query-string variable, pass it to the appropriate function to add or remove a cart item, and then display the shopping cart. If <span class="SANS_TheSansMonoCd_W5Regular_11">$action</span> is <span class="SANS_TheSansMonoCd_W5Regular_11">'changeCartQuantity'</span> <span aria-label="annotation4" class="CodeAnnotation">❹</span>, we retrieve the product ID from the query string and get the value of <span class="SANS_TheSansMonoCd_W5Regular_11">changeDirection</span> from the <span class="SANS_TheSansMonoCd_W5Regular_11">POST</span> variables. If the latter is <span class="SANS_TheSansMonoCd_W5Regular_11">'increase'</span>, we call <span class="SANS_TheSansMonoCd_W5Regular_11">increaseCartQuantity()</span>; otherwise, we call <span class="SANS_TheSansMonoCd_W5Regular_11">decreaseCartQuantity()</span>. In either case, we then display the shopping cart. Finally, if no value of the <span class="SANS_TheSansMonoCd_W5Regular_11">action</span> query-string variable is found, we use the default case to display the list of products <span aria-label="annotation5" class="CodeAnnotation">❺</span>.</p>
</section>
</section>
<section aria-labelledby="sec21" epub:type="division">
<h3 class="H1" id="sec21"><span id="toc-link_219"/><span class="SANS_Futura_Std_Bold_B_11">Summary</span></h3>
<p class="TNI1">In this chapter, we explored a real-world application of working with sessions: an interactive shopping cart. Our work with the shopping cart stored in the <span class="SANS_TheSansMonoCd_W5Regular_11">$_SESSION</span> array followed the same approach as in the preceding chapter: we set a default, attempt to read a value from the <span class="SANS_TheSansMonoCd_W5Regular_11">$_SESSION</span> array, do something with the value, then save the updated data back into the session. The core logic for the project in this chapter revolves around two arrays, a product list and a shopping cart, both of which are keyed with product IDs. While in this chapter our list of products is fixed in an array, it would be straightforward to refactor this code to read the list of products from a database, which is how most real-world e-commerce websites operate.</p>
<p class="TX">By identifying the operations we wanted to apply to our shopping cart array and then encoding this logic as individual functions in <i>src/functions.php</i>, our final <i>public/index.php</i> front controller was simple to write. The listings for <i>templates/list.php</i> and <i>templates/cart.php</i> are relatively long, but this is mostly because we incorporated some Bootstrap CSS to make the list of products and shopping cart look more professional. In fact, the display templates would have been even longer had we not used a <i>templates/_header.php</i> file to store information common to all three pages of the site.</p>
<p class="TX">Many software systems are designed around the relationship between <i>data structures</i> (the way information is stored) and <i>algorithms</i> (the programming of the application logic). In this case, we structured both our product details and our shopping cart arrays around unique product IDs. This decision made creating the site logic and display templates straightforward.</p>
<p class="TX">We also saw that not all information about a session needs to be stored to the session. For example, the shopping cart subtotals and grand total can be calculated dynamically each time the cart page is loaded; they don’t need to be stored. Likewise, we don’t store product details within the shopping cart array, just the product ID, since we can retrieve all the other attributes of each product in the cart from the array of product items. To sum up, we created two data structures (the arrays for product details and <span aria-label="300" epub:type="pagebreak" id="pg_300" role="doc-pagebreak"/>shopping cart contents) and then designed algorithms (our front-controller logic and display templates) to efficiently interact with them.</p>
</section>
<section aria-labelledby="sec22" epub:type="division">
<h3 class="H1" id="sec22"><span id="toc-link_220"/><span class="SANS_Futura_Std_Bold_B_11">Exercises</span></h3>
<p class="ListNumber">1.   Add a new <span class="SANS_TheSansMonoCd_W5Regular_11">'category'</span> attribute for the products in the shopping cart application, with possible values <span class="SANS_TheSansMonoCd_W5Regular_11">'savory'</span> (the sandwich), <span class="SANS_TheSansMonoCd_W5Regular_11">'sweet'</span> (the cheesecake and the donut), or <span class="SANS_TheSansMonoCd_W5Regular_11">'fruit'</span> (the pineapple and banana). You’ll need to add this element to each product in the <span class="SANS_TheSansMonoCd_W5Regular_11">getAllProducts()</span> function, and add a new <span class="SANS_TheSansMonoCd_W5Regular_11">&lt;div&gt;</span> in the <i>list.php</i> template to display it.</p>
<p class="ListNumber">2.   Add a button labeled <span class="SANS_TheSansMonoCd_W5Regular_11">Empty Cart</span> to the shopping cart display page that results in a <span class="SANS_TheSansMonoCd_W5Regular_11">POST</span> request sending the query-string parameter <span class="SANS_TheSansMonoCd_W5Regular_11">action=emptyCart</span>. Then add an <span class="SANS_TheSansMonoCd_W5Regular_11">emptyShoppingCart()</span> function to the <i>src/functions.php</i> file and a new case to the front controller’s <span class="SANS_TheSansMonoCd_W5Regular_11">switch</span> statement to invoke this function and clear the shopping cart’s contents.</p>
<p class="ListBody">Hint: Since nothing else is being stored in the session for this project, you could either use the <span class="SANS_TheSansMonoCd_W5Regular_11">killSession()</span> function approach from <span class="Xref"><a href="chapter14.xhtml">Chapter 14</a></span> or simply replace the existing contents of <span class="SANS_TheSansMonoCd_W5Regular_11">$_SESSION['cart']</span> with an empty array.</p>
<p class="ListNumber">3.   Our code doesn’t have any validation checking for missing or invalid data. For example, when the <span class="SANS_TheSansMonoCd_W5Regular_11">action</span> query-string variable is <span class="SANS_TheSansMonoCd_W5Regular_11">addToCart</span>, we would have a problem if the ID is missing or invalid or if no product exists in the <span class="SANS_TheSansMonoCd_W5Regular_11">$products</span> array matching the received ID. Add some simple validation so that if any problem arises with the ID when one is required, the product list page is displayed and no change is made to the shopping cart.</p>
</section>
</section>
</div></body></html>